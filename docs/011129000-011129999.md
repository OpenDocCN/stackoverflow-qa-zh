# StackOverflow 问答 11129000-11129999

# c# - How to get the location of a file located within a Windows application folder

> ID：11129000
> 
> 赞同：3
> 
> 时间：2012-06-20T22:17:51.603
> 
> 标签：c#, windows, filepath

What I am trying to do is read data from a CSV file located within a Windows application folder named "Attachments". In a web application you can get the path of the folder using

```
Server.MapPath(@"Attachments/sample.csv"); 
```

What is the equivalent call from a Windows application?

Below is my code.

```
string[] str = File.ReadAllLines(@"Attachment/sample.csv");

// create new datatable
DataTable dt = new DataTable();

// get the column header means first line
string[] temp = str[0].Split(';');

// creates columns of gridview as per the header name
foreach (string t in temp)
{
    dt.Columns.Add(t, typeof(string));
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T22:23:28.933

路径是相对于可执行文件的吗？如果是这样，您可以使用[Application.StartupPath](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.startuppath.aspx)来确定程序的启动位置，然后将其与相对文件路径结合以获得完整路径：

```
var fullPath = Path.Combine(Application.StartupPath, @"Attachment\sample.csv"); 
```

但是，如果您的应用程序作为服务运行或使用 ClickOnce 部署，这将不起作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T22:21:52.133

此枚举可以识别 Windows 应用程序文件夹

```
Environment.SpecialFolder.ProgramFiles 
```

[MSDN 参考](http://msdn.microsoft.com/en-us/library/system.environment.specialfolder.aspx)

获取包含实际路径和您编写的完整文件名的字符串

```
string pathToFile = Environment.GetFolderPath(Environment.SpecialFolder.ProgramFiles);
string fullFileName = Path.Combine(pathToFile, @"Attachment\sample.csv"); 
```

正如 Cole Johnson 在其评论中所指出的，如果您的主机操作系统是 64 位，则会出现问题。在这种情况下，有两个应用程序文件夹。一个用于 64 位应用程序，一个用于 32 位应用程序。使用 NET4，您可以通过属性发现当前操作系统位数

```
Environment.Is64BitOperatingSystem 
```

并且，如果为 false，则使用不同的枚举

```
Environment.SpecialFolder.ProgramFilesX86 
```

但毕竟这一切，我认为你应该改变你的程序架构中的一些东西。
在 Web 应用程序中，通常不使用 web-root 之外的文件夹。
但是 WinForms 应用程序没有这样的限制，然后您可以将 CSV 文件安装在不同的文件夹中（想到 MyDocuments）并通过配置文件中的选项控制硬盘上的实际位置

请记住：应用程序文件夹需要特定的写入权限（如果您将附件保存在那里，这是选择与应用程序文件夹不同的位置的另一个原因）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T22:27:42.913

你可以这样做

```
Path.Combine(Application.StartupPath, @"Attachment\sample.csv"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-20T22:23:38.363

史蒂夫打败了我，但是是的，请检查 intellisense 以获取您要在下面寻找的任何文件夹：

```
string path = Environment.GetFolderPath(Environment.SpecialFolder. 
```

特性

你会在那里找到各种系统路径。

# opencv - 为什么KeyPoint“检测器”和“提取器”操作不同？

> ID：11129015
> 
> 赞同：3
> 
> 时间：2012-06-20T22:18:53.270
> 
> 标签：opencv, sift, surf

基本上你必须首先做一个：

```
SurfFeatureDetector surf(400);
surf.detect(image1, keypoints1); 
```

然后一个：

```
surfDesc.compute(image1, keypoints1, descriptors1); 
```

为什么检测和计算是两种不同的操作？
检测后进行计算不会产生冗余循环？

我发现自己`.compute`是我的应用程序中最昂贵的。

```
.detect 
```

在**0.2 秒内完成**

```
.compute 
```

需要**~1sec**。有什么办法可以加快速度`.compute`吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-06T12:33:15.110

关键点的检测只是选择图像中被认为是“好的特征”的点的过程。

这些关键点的描述符的提取是一个完全不同的过程，它对该特征的属性进行编码，例如与邻居的对比度等，因此可以将其与来自不同图像、不同尺度和方向的其他关键点进行比较。

您描述关键点的方式可能对成功匹配至关重要，而这确实是关键因素。此外，您描述关键点的方式也是匹配速度的决定因素。例如，您可以将其描述为浮点数或二进制序列。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-20T23:01:52.550

检测图像中的关键点和计算这些关键点的描述符是有区别的。例如，您可以提取 SURF 关键点并计算 SIFT 特征。请注意，在 DescriptorExtractor::compute 方法中，应用了关键点上的过滤器：

```
KeyPointsFilter::runByImageBorder()
KeyPointsFilter::runByKeypointSize(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T18:35:12.820

从 Jay_Rock 离开的地方开始，您可以使用 ORB、Brisk 或 FREAK 等算法提供的二进制描述符来改进这些处理时间。它们不仅占用 32 位而不是 64 位，而且还提供了不同的计算描述符的方法，这些方法与 SURF 一样健壮且速度更快。

如果您最终想要在描述符之间执行匹配操作，可以通过计算两者之间的汉明距离来完成。鉴于它是两个二进制字符串之间的异或运算，运行只需几毫秒。

# php - PHP/CI 将 SQL 查询传递给数组

> ID：11129016
> 
> 赞同：0
> 
> 时间：2012-06-20T22:19:01.370
> 
> 标签：php, sql, arrays, codeigniter

我在 SQL 查询中有一个组列表，并希望将它们输出到一个数组中，以便以后可以引用它。

目前我有以下代码循环遍历组并将它们放入`$test_array`：

```
$test_array = array();
$query = $this->site_model->list_groups();
foreach($query as $r1) :
    $test_array[] = $r1->group_name;
endforeach; 
```

这显示了以下数组：

```
Array
(
    [0] => Group 1
    [1] => Group 2
    [2] => Group 3
    [3] => Group 4
    [4] => Group 5
    [5] => Group 6
    [6] => Group 7
    [7] => Group 8
) 
```

我想要将相同的查询传递给如下所示的数组，以便稍后将其他段添加到数组中：

```
Array
(
    [Round 1] => Array
    (
        [0] => Group 1
        [1] => Group 2
        [2] => Group 3
        [3] => Group 4
        [4] => Group 5
        [5] => Group 6
        [6] => Group 7
        [7] => Group 8
    )
) 
```

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T22:21:08.110

```
$test_array = array('Round 1' => array());
...
$test_array['Round 1'][] = $r1->group_name; 
```

# java - Java - 如何最好地将值循环和存储到 ArrayList

> ID：11129029
> 
> 赞同：2
> 
> 时间：2012-06-20T22:20:18.153
> 
> 标签：java, list, arraylist

我必须能够将数据存储在一个新对象中，这是我从一个复杂对象中获取的，其中每个项目都保存在`List`.

层次结构如下：

```
bookId 
pageId
wordId 
```

*   `bookId`是唯一的，可以有零到多个`pageId's`
*   `pageId`可以有零到多个`wordId's`

我有数据，但我需要循环遍历每个项目并放入一个对象 -`ArrayList`或类似的 - 所以我可以传递给另一个需要`List`. 在下一节课中，数据将以 jsp 表的形式呈现。

有人可以帮助最好的方法来做到这一点。我需要`ArrayList`or `ArrayLists`，还是有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T22:32:49.827

组织此结构的简单方法如下：

```
class Book {
  int bookId;
  ArrayList<Page> pages;
}

class Page {
  int pageId;
  ArrayList<Word> words;
}

class Word {
  int wordId;
} 
```

您的每个实体都是一个对象。例如，您可以使用下一个代码创建简单的书：

```
Book book = new Book(); // create Book object
  ArrayList<Page> pages = new ArrayList<Page>;
  pages.add(new Page()); // add first page
  pages.add(new Page()); // add next page
book.setPages(pages); // set reference to pages for book 
```

请注意，您需要提供适当的构造函数和 setter/getter 来操作该代码。

为了在 jsp 上呈现这些数据，您可以使用 bean 对象 Book，并且使用 jstl 您可以访问所需的 book 中的任何字段（包括每个页面和页面中的每个单词）。

实际上，有很多更复杂的结构，但它的使用取决于您的要求。我认为，这个模型适合简单的情况。

# ruby - 如何在没有主键的数据库中使用 ActiveRecord（没有 Rails）

> ID：11129030
> 
> 赞同：0
> 
> 时间：2012-06-20T22:20:18.800
> 
> 标签：ruby, sql-server, activerecord

我现在为基于 MSSQL Server 的系统编写自动化程序，使用 Ruby 1.9.3 和 ActiveRecord 3.1.6，没有 Rails。

表具有非标准 id（`stk_id`, `urb_id`，而不是`id`），有些表也没有主键。

在我添加列`id`并将其设置为主键之前，我的程序运行非常缓慢。我等了将近 3 分钟，程序在 9000 条记录的表中进行了两次选择操作和一些小处理。但是当我添加列`id`并将其设置为主键时，这些操作在不到 10 秒内完成。

我在删除操作中发现的另一个问题：如果没有表中的主键，它根本不起作用。尝试在没有主键的情况下删除时出错：

> nil:NilClass 的未定义方法“to_sym”

我无法修改生产数据库的表结构。也许有人知道如何在不添加`id`列和设置主键的情况下解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T22:26:24.240

在没有主键的每个表上创建索引视图。可以根据需要应用唯一聚集索引以及其他索引。在视图中包含单个表应该可以防止您违反索引视图要求/禁止的许多条件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T23:26:38.073

我建议考虑使用[Sequel](http://sequel.rubyforge.org/)而不是 ActiveRecord。它对 ActiveRecord 之类的数据库模式并不固执己见，并且可能更容易与您无法修改的数据库模式一起使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T13:15:15.240

备注：没有主键的数据库很糟糕！

[http://www.helium.com/items/1539899-why-a-relational-database-needs-a-primary-key](http://www.helium.com/items/1539899-why-a-relational-database-needs-a-primary-key)

Using nonstandard keys is no problem, just use self.primary_key = "stk_id"

You may also use composite_primary_keys: [https://github.com/drnic/composite_primary_keys](https://github.com/drnic/composite_primary_keys)

# javascript - 异步加载谷歌地图V3时将数据传递给回调

> ID：11129033
> 
> 赞同：12
> 
> 时间：2012-06-20T22:20:49.407
> 
> 标签：javascript, google-maps-api-3

我正在[异步加载谷歌地图 API](https://developers.google.com/maps/documentation/javascript/tutorial#asynch)，它允许您定义一个回调以在 API 加载时执行。有什么办法可以将参数传递给回调？

**编辑：**

这是我正在使用的代码。我有一个名为`master`存储以下函数的全局对象。

```
/**
 * Load the Google Maps API
 * https://developers.google.com/maps/documentation/javascript/tutorial#Loading_the_Maps_API
 */
loadGoogleMaps: function(){
    var googleMaps = document.createElement("script");
    googleMaps.type = "text/javascript";
    googleMaps.src = "http://maps.googleapis.com/maps/api/js?key=[MYAPIKEY]&sensor=false&callback=master.mapInit";
    document.body.appendChild(googleMaps);
} 
```

我希望能够将一组位置传递到`mapInit`其中，以便在地图初始化时向地图添加标记。我还希望能够全局访问对地图的引用，以便在创建地图后对其进行修改。

```
/**
 * Initialize the map
 */
mapInit: function(){

    // Default map options
    var mapOptions = {
        zoom: 4,
        center: new google.maps.LatLng( 40, -95 ),
        mapTypeId: google.maps.MapTypeId.ROADMAP
    }

    // Create map
    var map = new google.maps.Map( document.getElementById("map"), mapOptions );

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T06:36:14.030

我最终解决了将参数传递给回调的需要。

我在对象内部创建了一个`master`对象来保存有关特定地图的信息。每个地图都有自己定义的回调。它还保存对初始化地图的引用以及回调需要引用的任何其他地图特定数据。

```
/**
 * Map listing
 */
mapList: {
    mainMap: {
        map: "",
        callback: function(){

            for( var i = 0, length = this.locations.length; i < length; i++ ){

                master.placeMapMarker( this.locations[i], this );

            }

        },
        prevInfoWindow: "",
        locations: {}
    }
} 
```

我修改了`mapInit`函数以存储对地图的引用并在`master.mapList.mainMap`.

```
/**
 * Initialize the map
 */
mapInit: function(){

    // Default map options
    var mapOptions = {
        zoom: 4,
        center: new google.maps.LatLng( 40, -95 ),
        mapTypeId: google.maps.MapTypeId.ROADMAP
    }

    // Create map
    var mapName = $("#map").data("name");
    var map = this.mapList[mapName].map = new google.maps.Map( document.getElementById("map"), mapOptions );

    this.mapList[mapName].callback();

} 
```

我将地图名称存储在地图`data-name`占位符元素的属性中。

```
<div id="map" data-name="mainMap"></div> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-20T22:25:33.820

如何将您的函数包装成一些传递必要参数的虚拟函数，例如：

```
function wrapper()
{
    myCallback(arg1, arg2);
} 
```

并`wrapper()`作为谷歌地图回调传递

# android - android自定义对话框imageButton onclicklistener

> ID：11129036
> 
> 赞同：0
> 
> 时间：2012-06-20T22:21:37.737
> 
> 标签：android, dialog, imagebutton

这是我的自定义对话框类：

```
package com.WhosAround.Dialogs;

import com.WhosAround.AppVariables;
import com.WhosAround.R;
import com.WhosAround.AsyncTasks.LoadUserStatus;
import com.WhosAround.Facebook.FacebookUser;

import android.app.Dialog;
import android.content.Context;
import android.graphics.drawable.Drawable;
import android.view.MotionEvent;
import android.view.View;
import android.widget.ImageButton;
import android.widget.ImageView;
import android.widget.TextView;

public class MenuFriend extends Dialog{

    private FacebookUser friend;
    private AppVariables app;

    public MenuFriend(Context context, FacebookUser friend) {
        super(context, android.R.style.Theme_Translucent_NoTitleBar);
        this.app = (AppVariables) context.getApplicationContext();
        this.friend = friend;
    }

    public void setDialog(String userName, Drawable userProfilePicture)
    {
        setContentView(R.layout.menu_friend);
        setCancelable(true);
        setCanceledOnTouchOutside(true);        
        TextView name = (TextView) findViewById(R.id.menu_user_name);
        TextView status = (TextView) findViewById(R.id.menu_user_status);
        ImageView profilePicture = (ImageView) findViewById(R.id.menu_profile_picture);
        ImageButton closeButton = (ImageButton) findViewById(R.id.menu_close);
        name.setText(userName);         
        profilePicture.setImageDrawable(userProfilePicture);

        if (friend.getStatus() != null)
            status.setText(friend.getStatus());
        else
            new LoadUserStatus(app, friend, status).execute(0);
        closeButton.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {
                dismiss();

            }
        })

    }

} 
```

出于某种原因，eclipse 在 closeButton imageButton 上告诉我以下错误：

```
The method setOnClickListener(View.OnClickListener) in the type View is not applicable for the arguments (new DialogInterface.OnClickListener(){})

The type new DialogInterface.OnClickListener(){} must implement the inherited abstract method DialogInterface.OnClickListener.onClick(DialogInterface, int)

The method onClick(View) of type new DialogInterface.OnClickListener(){} must override or implement a supertype method 
```

这是为什么 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T22:36:52.740

`OnClickListener`接口来自子类。您可能正在导入`DialogInterface.OnClickListener`，而不是`View.OnClickListener`.

接口的不同子类有不同的 onClick() 实现。

```
public interface View.OnClickListener() {
    // This implementation gives you a reference to the View that was clicked.
    onClick(View v);
}
public interface DialogInterface.OnClickListener() {
    // This implementation gives you references to the dialog in which the click happend
    onClick(DialogInterface dialog, int which);
} 
```

将您更改`setOnClickListener`为：

```
closeButton.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            dismiss();

        }
    }) 
```

# php - 在分页中保持变量

> ID：11129037
> 
> 赞同：0
> 
> 时间：2012-06-20T22:21:43.480
> 
> 标签：php, jquery, ajax, pagination

这个问题对某些人来说是一个简单的问题，但我不明白我需要做什么来解决这个问题。

我有一个显示分页表的网页。表格上方是会话从前一页传递的一些信息，用户从下拉菜单中选择了一个选项。

当用户分页到第二页等时，传递的信息会丢失，可能会刷新页面。

我已经搜索并观看了许多关于 Ajax、jquery 和 php 等的教程（超过 20 个），但我无法理解我在看什么。虽然我遵循教程，但我无法解释可以解决我的问题的教程。

我想一步一步的指南将是解决这个问题的唯一方法，而不是让别人为我做这件事。

我绝对会感谢在这件事上的任何帮助。

我试图传递到分页及以后的第二页的代码是变量 `$brandname`, `$picked`, `$pickchek`。下面列出了代码的 php 部分。

```
echo "<div id=firstpick>";
$brandname = $_GET['brandname'];
$picked = $_GET['picked'];
$pickcheck = $_GET['pickcheck'];

$brands =($brandname);
$_SESSION['$brandname']= $brandname;
$pick =($picked);
$_SESSION['$picked']= $pick;
$picker =($pickcheck);
$_SESSION['$pickcheck']=$picker;
echo "</div>";

$tbl_name="pickme";
$adjacents = 3;

$query = "SELECT COUNT(*) as num FROM tirestock";
$total_pages = mysql_fetch_array(mysql_query($query));
$total_pages = $total_pages["num"];

$targetpage = "connecttest.php";    //your file name  (the name of this file)
$limit = 5;                     //how many items to show per page
$page = (isset($_GET['page'])) ? (int)$_GET['page'] : 1;
$page=mysql_real_escape_string($page);
if($page)
    $start = ($page - 1) * $limit;  //first item to display on this page
else
    $start = 0;

$sql = "SELECT * FROM tirestock LIMIT $start, $limit";
$result = mysql_query($sql);

if ($page == 0) $page = 1;      /if no page var is given, default to 1.
$prev = $page - 1;              //previous    page is page - 1
$next = $page + 1;                  //next page is page + 1
$lastpage = ceil($total_pages/$limit);//lastpage is = total pages / items per                                           

$lpm1 = $lastpage - 1;              //last page minus 1

$pagination = "";
if($lastpage > 1)
{
    $pagination .= "<div class=\"pagination\">";
    //previous button
    if ($page > 1)
        $pagination.= "<a href=\"$targetpage?page=$prev\">« previous</a>";
    else
        $pagination.= "<span class=\"disabled\">« previous</span>";

    //pages
    if ($lastpage < 7 + ($adjacents * 2))//not enough pages to bother breaking  

    {
        for ($counter = 1; $counter <= $lastpage; $counter++)
        {
            if ($counter == $page)
                $pagination.= "<span  
 class=\"current\">$counter</span>";                                
            else
                $pagination.= "<a href=\"$targetpage? 
 page=$counter\">$counter</a>";
        }
    }
    elseif($lastpage > 5 + ($adjacents * 2))    //enough pages to hide some
    {
        //close to beginning; only hide later pages
        if($page < 1 + ($adjacents * 2))
        {
            for ($counter = 1; $counter < 4 + ($adjacents * 2); 
$counter++)
            {
                if ($counter == $page)
                    $pagination.= "<span  
class=\"current\">$counter</span>";
                else
                    $pagination.= "<a href=\"$targetpage?
page=$counter\">$counter</a>";
            }
            $pagination.= "...";
            $pagination.= "<a href=\"$targetpage?
page=$lpm1\">$lpm1</a>";
            $pagination.= "<a href=\"$targetpage?
page=$lastpage\">$lastpage</a>";
        }
        //in middle; hide some front and some back
    elseif($lastpage - ($adjacents * 2) > $page && $page > ($adjacents * 2))
        {
            $pagination.= "<a href=\"$targetpage?page=1\">1</a>";
            $pagination.= "<a href=\"$targetpage?page=2\">2</a>";
            $pagination.= "...";
for ($counter = $page - $adjacents; $counter <= $page + $adjacents; $counter++)
            {
                if ($counter == $page)
            $pagination.= "<span class=\"current\">$counter</span>";
                else
        $pagination.= "<a href=\"$targetpage?page=$counter\">$counter</a>";
            }
            $pagination.= "...";
        $pagination.= "<a href=\"$targetpage?page=$lpm1\">$lpm1</a>";
    $pagination.= "<a href=\"$targetpage?page=$lastpage\">$lastpage</a>";
        }
        //close to end; only hide early pages
        else
        {
            $pagination.= "<a href=\"$targetpage?page=1\">1</a>";
            $pagination.= "<a href=\"$targetpage?page=2\">2</a>";
            $pagination.= "...";
for ($counter = $lastpage - (2 + ($adjacents * 2)); $counter <= $lastpage; $counter++)
            {
                if ($counter == $page)
            $pagination.= "<span class=\"current\">$counter</span>";
                else
        $pagination.= "<a href=\"$targetpage?page=$counter\">$counter</a>";
            }
        }
    }

    //next button
    if ($page < $counter - 1)
        $pagination.= "<a href=\"$targetpage?page=$next\">next »</a>";
    else
        $pagination.= "<span class=\"disabled\">next »</span>";
    $pagination.= "</div>\n";
}

   echo "<div style='font-weight:bold' text-align:center;><font size='5'>You picked Brand:   
         $brandname<br></br></hr></div>";
   echo "<div style='font-weight:bold'><font size='5'>You picked Size: $picked<br></br></hr>
         </div>";
   echo "<div style='font-weight:bold'><font size='5'>You picked Type: $pickcheck<br></br>
         </hr></div>"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T22:48:35.437

将品牌名称、pick 和 pickcheck 附加到分页脚本创建的链接。

```
<a href=\"$targetpage?page=$prev&brandname=$brandname&picked=$picked&pickcheck=$pickcheck\">« previous</a>` 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T22:44:22.517

你知道如何在 Javascript 中使用 localStorage 吗？这是一个关于如何使它在 php 中为您工作的教程。[http://www.devshed.com/c/a/PHP/Create-A-ClientSide-Cache-in-PHP/1/](http://www.devshed.com/c/a/PHP/Create-A-ClientSide-Cache-in-PHP/1/)

您可以使用它来存储页面更改之间的变量。

当然，如果你没有 JS，那么这将不是很有用！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T22:33:08.577

您可以设置[会话](http://php.net/manual/en/features.sessions.php)中页面之间丢失的数据，或者更好的解决方案是使用 ajax 进行分页。这个想法真的很简单，你需要在分页链接上附加一个 javascript 中的点击处理程序，以使用 ajax 加载页面数据。如果您使用的是 jquery，它会为您完成所有艰苦的工作。阅读 jquery .ajax() 或更简单的 .load() 方法，它们会有所帮助。

如果您的 javascript 知识有限，一个快速的解决方案是使用 PHP 会话在页面之间持久化数据，如果您能理解它，那么更好的体验是使用 ajax。理想情况下，您将同时实现这两者，与渐进增强保持一致，以便它在禁用 javascript 的情况下工作。

编辑：

单击处理程序的一个简单的 jquery 示例是：

```
$(".pagination a").click(function(e){ // this line binds the handler to your pagination
  e.preventDefault();  //this prevents the link being loaded as a new page, the default behaviour
  var pageToLoad = $(this).attr("href"); //we get the url of the page to load in by ajax
  $("#page-contents").load(pageToLoad); //replace the contents of the div with the id="page-contents" with the result of the ajax request. 
}); 
```

这将要求您首先包含 jquery 库，并将您的主要内容替换为 ID 为 #page-contents 的元素内的分页。请注意，分页链接中的 href 必须只返回要替换的页面段，而不是整个 html 页面。[您可以通过仅从您调用的 url 返回一个 php 块来执行此操作，或者使用jquery load 方法](http://api.jquery.com/load/#loading-page-fragments)仅在某个 ID 内加载完整的 html 页面块

# java - 有没有办法通过套接字发送带有 DataOutputStream 的 Point 数组？

> ID：11129040
> 
> 赞同：0
> 
> 时间：2012-06-20T22:22:26.320
> 
> 标签：java, arrays, sockets, datainputstream, dataoutputstream

我想通过套接字发送带有 DataOutputStream 的点数组（Point points[] = new point[20]），并能够在另一端使用 DataInputStream 正确读取它。我不能单独发送每个元素，它必须作为整个数组发送并且能够被解释为整个数组。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T22:51:21.513

[请参阅高级套接字编程](http://java.sun.com/developer/technicalArticles/ALT/sockets/)中的“传输自定义对象”部分：

1.  将您的数据放入**Serializable 类**中，例如 MyData。（在您的情况下，您实际上不必这样做，因为数组实现了可序列化，但是稍后您可能希望将其他数据与您的点数组一起发送......）
2.  在**发送**方，创建一个 MyData 对象并用数据填充它。将 socket.getOutputStream() 转换为[ObjectOutputStream](http://docs.oracle.com/javase/7/docs/api/java/io/ObjectOutputStream.html)，并调用其**writeObject**方法发送 MyData 对象。
3.  在**接收** 方，将 socket.getInputStream() 转换为[ObjectInputStream](http://docs.oracle.com/javase/7/docs/api/java/io/ObjectInputStream.html)，并调用其**readObject**方法来接收对象（您必须将其转换为 MyData）。

无论如何，我也会考虑使用[RMI](http://docs.oracle.com/javase/tutorial/rmi/overview.html)。例如，您可以创建一个 PointServer，在 RMI 注册表中注册它，然后通过客户端应用程序中的简单函数调用来访问它。RMI 比套接字更容易使用。例如，您不必设计协议，只需为您的分布式对象定义方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T23:29:58.510

为什么不使用 ObjectInputStream/ObjectOutputStream 呢？

这是我很久以前写的一段代码，它允许您通过线路发送任何类型的对象，只要它是可序列化的，显然：

```
ObjectInputStream input = new ObjectInputStream(communicationSocket.getInputStream());
if (input != null) {
   try {
    Object o = input.readObject();
       if (o != null && o instanceof DataObject) {
      DataObject response = (DataObject) o;
           {
               //Do something cool with DataObject
           }
   }
}//etc... 
```

`DataObject`只是一个“包装器”/自定义类，您可以将其定义为将 Point[] 作为其属性之一；换句话说，您可以将 DataObject 定义为：

```
import java.io.Serializable;

public class DataObject implements Serializable {

   private Point[] points; //etc - define getter setter for points
} 
```

你可以把它写成：

```
output = new ObjectOutputStream(communicationSocket
                    .getOutputStream());
output.writeObject(yourDataObject); 
```

现在，您可以这样阅读：

```
while (listening) {  
    try {
   Object currentObject = input.readObject();
   if (currentObject != null
    && currentObject instanceof DataObject) {
       Point[] points = ((DataObject) currentObject).getPoints();
           //Do something with points
   }
} 
    catch (IOException e) {
   e.printStackTrace();
} 
    catch (ClassNotFoundException e) {
   e.printStackTrace();
} 
    finally {
   listening = false;
}
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T11:04:53.467

嗯，有一些你应该注意的点，例如，32 位或 64 位 int 的大小，发送和接收机器的字节顺序等。另外，应该有一个协议来通信两个套接字，我的意思是，在每个发送的数据包中都应该有一个标头，以便您知道要接收多少数据，我不会处理这个问题，我假设您要发送和接收 20 个点的数组。在本例中，假设两台机器都是 32 位，即 int 大小为 4 字节，并且两台机器都使用 LITTLE_ENDIAN 字节顺序。

```
// To send an array of points use these two methods:    
public byte[] pointsToBytes(Point[] p, int numPts)
{
  // 2 is for x and y and 4 is the size of an int in bytes
  ByteBuffer buff = ByteBuffer.allocateDirect(numPts * 2 * 4);
  buff.order(ByteOrder.LITTLE_ENDIAN);
  for (int i = 0; i < numPts; i++)
  {
     buff.putInt(p[i].x);
     buff.putInt(p[i].y);
  }
  return buff.array();
}

public boolean sendData(Point[] pts, int size)
{
  try
  {
      byte[] buffer = pointsToBytes(pts, size);
      mainSocket.getOutputStream().write(buffer, 0, buffer.length);
      return true;
  }
  catch (Exception e)
  {
     e.printStackTrace();
  }
  return false;
}

// To receive an array of point use these two methods:

public Point[] bytesToPoints(byte[] byteBuff, int numBytes)  
{
   ByteBuffer buff = ByteBuffer.wrap(byteBuff);
   buff.order(ByteOrder.LITTLE_ENDIAN);
   // 2 is for x and y and 4 is the size of an int in bytes
   int ptsInBuffer = numBytes / 2 / 4;
   Point[] pts = new Point[ptsInBuffer];
   for (int i = 0; i < ptsInBuffer; i++)
   {
       pts[i].x=buff.getInt();
       pts[i].y=buff.getInt();
   }
   return pts;
 }

 public Point[] getData(int pointsToRead)
 {
    try
    {
        byte[] buffer = new byte[pointsToRead * 4 * 2]; 
        int bytesRead = mainSocket.getInputStream().read(buffer, 0, pointsToRead*4*2);
        return bytesToPoints(buffer, bytesRead);
    }
    catch (Exception e)
    {
       e.printStackTrace();
    }
    return null;
} 
```

# regex - 将正则表达式规则合并为一个？

> ID：11129043
> 
> 赞同：0
> 
> 时间：2012-06-20T22:22:39.120
> 
> 标签：regex, .htaccess, mod-rewrite

我怎样才能将这些合并成一行？我确信这是可能的。

```
RewriteRule ^forums$                   pages/forum.php [L]
RewriteRule ^forums/([A-z]+)$          pages/forum.php?category=$1 [L]
RewriteRule ^forums/([A-z]+)/([A-z]+)$ pages/forum.php?category=$1&sort=$2 [L] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T01:54:08.690

```
RewriteRule ^forums(/([A-z]+)(/([A-z]+))?)?$ pages/forum.php?category=$2&sort=$4 [L] 
```

请注意，您仍在向 PHP 脚本提供`category`和`sort`，但它们将为空。

我认为您可能会遇到`[A-z]`包含意外字符的问题。（查看您的 ASCII 字符集以了解详细信息）。将其替换为`[A-Za-z]`or`[[:alpha:]]`如果那是您真正想要的。

# ruby - CouchDB：curl 的奇怪 query_parse_error，而不是 Ruby

> ID：11129046
> 
> 赞同：1
> 
> 时间：2012-06-20T22:22:58.423
> 
> 标签：ruby, couchdb, sinatra, couchrest

我在 iriscouch.com 上托管我的 Couch 实例，并使用 CouchRest 模型使用简单的 Sinatra 应用程序进行一些测试。

这是我正在使用的一个简单模型：

```
class User < CouchRest::Model::Base
  property :first_name, String
  property :last_name, String
  timestamps!

  design do
    view :by_first_name
  end
end 
```

我成功地创建了新用户：

```
User.create(:first_name => "Stonewall", :last_name => "Jackson") 
```

执行`User.by_first_name.all`此 HTTP 请求的结果：

```
http://test_admin:pwd@testytest.iriscouch.com:80/blt/_design/User/_view/by_first_name?include_docs=true&reduce=false
"Accept"=>"application/json"
"Accept-Encoding"=>"gzip, deflate"
"Content-Type"=>"application/json" 
```

这是由 RestClient 通过 CouchRest 执行的。那里没有问题。

但是当我尝试访问`curl`这个 URL 时，我收到了 Couch 关于`include_docs`参数的投诉：

```
{"error":"query_parse_error","reason":"Query parameter `include_docs` is invalid for reduce views."} 
```

我想了解这里发生了什么。为什么`include_docs`只有在使用 curl 时才会出现问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T18:54:46.567

一个区别是您的 URL 现在包含一个问号。如果您在 shell 中不保护 URL，它将被解释为特殊字符。

如果您想要一种更简单的方法来测试您的服务，您可以使用[RESTClient](http://restclient.net)而不是`curl`.

# c++ - 是否可以符号化 C++ 代码？

> ID：11129050
> 
> 赞同：6
> 
> 时间：2012-06-20T22:23:30.120
> 
> 标签：c++, objective-c, xcode4, objective-c++, symbolicatecrash

我最近在尝试符号化 iOS 应用程序的崩溃日志时遇到了麻烦。由于某种原因，dSYM 的 UUID 未在 Spotlight 中编制索引。在一些手动搜索和健康剂量的命令行咒语之后，我设法部分表示了崩溃日志。

起初我认为 dSYM 可能是不完整的或类似的东西，但后来我意识到缺少的方法调用是 C++ 代码中发生的那些：这个项目是一个调用 C++ 库的 Objective-C 应用程序（通过 Objective-C++）它回调到 Objective-C 代码（同样，通过 Objective-C++ 代码）。具体来说，我缺少的调用是发生在 C++ 领域的调用。

所以，我的问题是：符号化过程是否有某种方法可以解决 C++ 代码的函数调用？我需要设置哪些特殊选项（如果有）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T18:02:47.563

尝试

dwarfdump --lookup=0xYOUR_ADRESS YOUR_DSYM_FILE

您将不得不手动查找每个地址（或编写脚本来执行此操作），但如果符号正常（您的 dSym 文件大于 20MB），这将完成这项工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-24T16:54:32.637

我不精通Objective-C，但我会确保C++ 代码是用符号编译的。特别是，您是否确保在编译 C++ 代码时包含 -rdynamic 和/或 -g？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-24T16:49:20.313

苹果 sdk 附带的一个有用的程序是`atos`（地址到符号）。基本上，这就是你想要做的：

```
atos -o myExecutable -arch armv7 0x(address here) 
```

它应该打印出该地址的符号名称。

# javascript - Android WebView 数据库存储返回 null

> ID：11129054
> 
> 赞同：1
> 
> 时间：2012-06-20T22:24:22.087
> 
> 标签：javascript, android, html, data-storage

这是我的问题。我正在尝试将我的网络应用程序中的数据本地存储在 HTML5 数据库中。问题是，我尝试用我的 javascript 打开的数据库返回 null。

这是安卓代码：

```
public class NotepadActivity extends Activity {
WebView main_view = null;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        //Get rid of the android title bar
        requestWindowFeature(Window.FEATURE_NO_TITLE);
        setContentView(R.layout.main);

        main_view = (WebView) findViewById(R.id.main_webview);
        WebSettings settings = main_view.getSettings();

        settings.setJavaScriptEnabled(true);
        settings.setDatabasePath("/data/data/"+this.getPackageName()+"/databases/");
        settings.setDomStorageEnabled(true);

        main_view.loadUrl("file:///android_asset/index.html");

        main_view.setWebViewClient(new WebViewClient() {
            @Override
            public boolean shouldOverrideUrlLoading(WebView view, String url) {
                return false;
            }
            @Override
            public void onReceivedError(WebView view, int errorCod,String description,    String failingUrl) {
                Toast.makeText(NotepadActivity.this, "Error: " + description , Toast.LENGTH_LONG).show();
            }   
        });

        main_view.setWebChromeClient(new WebChromeClient() {
               public void onConsoleMessage(String message, int lineNumber, String sourceID) {
                 Log.d("Notepad", message + " -- From line "
                                 + lineNumber + " of "
                                 + sourceID);
              }
        });
     }

     public void onExceededDatabaseQuota(String url, String
            databaseIdentifier, long currentQuota, long estimatedSize, long
            totalUsedQuota, WebStorage.QuotaUpdater quotaUpdater) {
                        quotaUpdater.updateQuota(estimatedSize * 2);
            } 
} 
```

以及相关的 JavaScript：

```
 /* DB and result values */
    DB_name: "NotepadDB",
    DB_version: "1",
    DB_displayName: "Notepad Database",
    DB_sizeEstimate: 5 * 1024 * 1024,
    DB: null,

 ....

    /* Open a connection to the DB (or create if it doesn't exist) */
    openConnection: function() {
        App.log("App > DB > openConnection > Attempting to access database");
        App.val.DB = window.openDatabase(App.val.DB_name, App.val.DB_version, 
                        App.val.DB_displayName, App.val.DB_sizeEstimate, App.DB.initializeDatabase);
    },

    /* Only called when the database is initially created */
    initializeDatabase: function(database) {
        App.val.DB = database;

        //Create the required table
        App.val.DB.transaction(
            function (tx) {tx.executeSql('CREATE TABLE ' + App.schema.tableName + ' (' + App.schema.ID+ ' int unique, ' + App.schema.title + ' text, ' + App.schema.content + ' text, ' + App.schema.date + ' datetime)',
                [],
                function (tx, res) {
                    App.log("App > DB > intializeDatabase > Table Created Successfully");
                    App.DB.loadAllNotes();
                },
                function (tx, err) {
                    App.log("App > DB > intializeDatabase > ERROR - Table creation failed - code: " + err.code + ", message: " + err.message);
                    App.error("Unable to create database. Please try again later.");
                });
            }
        );
    },

    loadAllNotes: function() {
        if(App.val.DB != null) {
            //Do some stuff
        } else {
            App.log("App > DB > loadAllNotes > Database was NULL");
        }
    } 
```

在我的 LogCat 日志中，我看到 App.log("App > DB > loadAllNotes > Database was NULL"); 正在执行。

我在这里缺少什么吗？为什么数据库为空？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T00:39:51.807

解决了。问题是我忽略了以下代码：

```
 public void onExceededDatabaseQuota(String url, String
        databaseIdentifier, long currentQuota, long estimatedSize, long
        totalUsedQuota, WebStorage.QuotaUpdater quotaUpdater) {
                    quotaUpdater.updateQuota(estimatedSize * 2);
        } 
```

这个函数应该在`main_view.setWebChromeClient(new WebChromeClient() {`函数内，因为它需要被覆盖。哦！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T22:57:01.413

创建 SQlite 数据库文件并将其放入 Assets 目录并在应用程序首次运行时将文件加载到 SD 卡上会更容易。您可以为数据库编辑器使用[FireFox 插件。](https://addons.mozilla.org/en-US/firefox/addon/sqlite-manager/)这将在您的应用程序中需要更少的代码。您可以使用我[在 SO 上](https://stackoverflow.com/a/11128097/742030)发布的方法。只需使用 .sql 文件而不是 txt 文件 - 这就是我使用我的应用程序所做的。

# sdk - 从 corona sdk 中的表或组中删除对象 [i]

> ID：11129056
> 
> 赞同：0
> 
> 时间：2012-06-20T22:24:42.247
> 
> 标签：sdk, lua, coronasdk

我有一个问题（显然：P）

我正在创建一个迷你游戏，当我触摸 Object-A 时，会创建一个 Object-B。如果我触摸 N 次，则会创建 N 个 Object-B。

（对象-B 在我的游戏中是泡泡）

所以，当我触摸气泡（对象-B）时，我会尝试，它会消失或执行任何操作。我尝试将 Object-B 添加到 Array

```
local t = {} 
```

. . .

```
bur = display.newImage("burbuja.png")
table.insert(t,bur) 
```

我在哪里有我的 eventListeners 我写道：

```
for i=1, #t do
bur[i]:addEventListener("tap",reventar(i))
end 
```

和我的功能'reventar'

```
local function reventar (event,id)
table.remove(t,id)
end 
```

我迷路了，只有我想要消失的泡泡。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T23:02:48.063

你可能会想做这样的事情：

```
local t = {}

bur = display.newImage("burbuja.png")
table.insert(t,bur)

-- declaring the function first so it can be used later in the for loop
local function reventar(event)
    t[event.target.id] = nil         -- We remove object from table
    event.target:removeSelf()        -- Also remember to remove from display
end

for i=1,#t do
    t[i].id = i
    t[i]:addEventListener("tap", reventar)
end 
```

希望这可以帮助。

**编辑**

我会这样做，因为当你想遍历对象时会更好：

```
local t = {}

-- declaring the function first so it can be used later
local function reventar(event)
    event.target.kill = true     -- Mark the clicked object for later destruction
end

bur = display.newImage("burbuja.png")
bur:addEventListener("tap", reventar)
table.insert(t,bur)

local function loop(event)
    for i = #t, 1, -1 do
        local object = t[i]

        -- Do stuff to object here, such as object.y = object.y + 1

        if object.kill then   -- Check if object is marked for destruction
            local child = table.remove(t, i)    -- Remove from table
            if child ~= nil then
                -- Remove from display and nil it
                child:removeSelf()
                child = nil
            end
        end
    end
end

Runtime:addEventListener("enterFrame", loop) -- Remember to remove this when no longer needed 
```

# matplotlib - 快速高效地更新 Matplotlib 轴（绘图）

> ID：11129057
> 
> 赞同：1
> 
> 时间：2012-06-20T22:25:06.067
> 
> 标签：matplotlib, refresh, axes

我正在使用的 GUI 遇到了一些性能问题。具体来说，我使用 wxPython 作为我嵌入在画布中的几个 matplotlib 图形的后端。我已经使用简单的 self.axes.clear() 和 self.axes.plot() 命令获得了基本功能，但我似乎无法使用这种方法获得任何合理的帧速率。执行搜索后，似乎如果我使用的是 II 可以重置 xdata 和 ydata 的绘图对象，然后重绘图形以获得更快的刷新率。不幸的是，我使用的布局排除了 plot 对象的使用，因此我使用 axes() 对象实现了代码。据我所知，axis() 对象没有任何等效的方法来设置 xdata 和 ydata（请参阅这篇文章：）。这是我正在使用的代码：

```
import sys,os,csv
import numpy as np
import wx
import matplotlib
import pylab
from matplotlib.figure import Figure
from matplotlib.backends.backend_wxagg import \
    FigureCanvasWxAgg as FigCanvas, \
    NavigationToolbar2WxAgg as NavigationToolbar
class UltrasoundDemoGUI(wx.Frame):
    title = ' Ultrasound Demo '
    def __init__(self):
        wx.Frame.__init__(self, None, -1, self.title)
        self.create_menu()
        self.statusbar = self.CreateStatusBar()
        self.create_main_panel()
        self.dataMon = pylab.randn(100,1);
        self.dataBi = pylab.randn(100,1);
        self.dataLoc = pylab.randn(100,1);

        self.redraw_timer = wx.Timer(self)
        self.Bind(wx.EVT_TIMER, self.on_redraw_timer, self.redraw_timer)        
        self.redraw_timer.Start(300)

    def create_menu(self):
        self.menubar = wx.MenuBar()
        menu_file = wx.Menu()
        m_expt = menu_file.Append(-1, "&Save plot\tCtrl-S", "Save plot to file")
        self.Bind(wx.EVT_MENU, self.on_save_plot, m_expt)
        menu_file.AppendSeparator()
        m_exit = menu_file.Append(-1, "E&xit\tCtrl-X", "Exit")
        self.Bind(wx.EVT_MENU, self.on_exit, m_exit)
        self.menubar.Append(menu_file, "&File")
        self.SetMenuBar(self.menubar)
    def create_main_panel(self):
        self.panel = wx.Panel(self)
#        self.init_plot()
        self.dpi = 100
        self.figSignals = Figure((12, 5.0), dpi=self.dpi)
        self.canvas = FigCanvas(self.panel, -1, self.figSignals)

        rectSubplotMono = .1, .55, .4, .4
        self.axesMono = self.figSignals.add_axes(rectSubplotMono)
        rectSubplotBi = .1, .05, .4, .4
        self.axesBi = self.figSignals.add_axes(rectSubplotBi)
        rectSubplotLoc = .55, .05, .4, .9
        self.axesLoc = self.figSignals.add_axes(rectSubplotLoc)

        self.axesMono.set_axis_bgcolor('white')
        self.axesBi.set_axis_bgcolor('white')
        self.axesLoc.set_axis_bgcolor('white')      
        self.axesMono.set_title('Raw Ultrasound Signal', size=12)

        pylab.setp(self.axesMono.get_xticklabels(), fontsize=8)
        pylab.setp(self.axesMono.get_yticklabels(), fontsize=8)

        pylab.setp(self.axesBi.get_xticklabels(), fontsize=8)
        pylab.setp(self.axesBi.get_yticklabels(), fontsize=8)

        pylab.setp(self.axesLoc.get_xticklabels(), fontsize=8)
        pylab.setp(self.axesLoc.get_yticklabels(), fontsize=8)

        # plot the data as a line series, and save the reference 
        # to the plotted line series
        #
        self.dataMono = pylab.randn(100,1)
        self.dataBi = pylab.randn(100,1)
        self.dataLoc = pylab.randn(100,1)
        self.plot_dataMono = self.axesMono.plot(
            self.dataMono, 
            linewidth=1,
            color=(1, 1, 0),
            )[0]
        self.plot_dataBi = self.axesBi.plot(
            self.dataBi, 
            linewidth=1,
            color=(1, 1, 0),
            )[0]
        self.plot_dataLoc = self.axesLoc.plot(
            self.dataLoc, 
            linewidth=1,
            color=(1, 1, 0),
            )[0]

        self.toolbar = NavigationToolbar(self.canvas)
        self.vbox = wx.BoxSizer(wx.VERTICAL)
        self.vbox.Add(self.canvas, 1, wx.LEFT | wx.TOP | wx.GROW)
        self.vbox.AddSpacer(10)
        self.hbox = wx.BoxSizer(wx.HORIZONTAL)
        flags = wx.ALIGN_LEFT | wx.ALL | wx.ALIGN_CENTER_VERTICAL
        self.panel.SetSizer(self.vbox)
        self.vbox.Fit(self)

    def init_plot(self):
        rectSubplotMono = .1, .55, .4, .4
        self.axesMono = self.figSignals.add_axes(rectSubplotMono)
        rectSubplotBi = .1, .05, .4, .4
        self.axesBi = self.figSignals.add_axes(rectSubplotBi)
        rectSubplotLoc = .55, .05, .4, .9
        self.axesLoc = self.figSignals.add_axes(rectSubplotLoc)

        self.axesMono.set_axis_bgcolor('white')
        self.axesBi.set_axis_bgcolor('white')
        self.axesLoc.set_axis_bgcolor('white')      
        self.axesMono.set_title('Raw Ultrasound Signal', size=12)

        pylab.setp(self.axesMono.get_xticklabels(), fontsize=8)
        pylab.setp(self.axesMono.get_yticklabels(), fontsize=8)

        pylab.setp(self.axesBi.get_xticklabels(), fontsize=8)
        pylab.setp(self.axesBi.get_yticklabels(), fontsize=8)

        pylab.setp(self.axesLoc.get_xticklabels(), fontsize=8)
        pylab.setp(self.axesLoc.get_yticklabels(), fontsize=8)

    def on_redraw_timer(self, event):
        self.draw_plot()

    def draw_plot(self):
        self.axesMono.clear()
        self.axesBi.clear()
        self.axesLoc.clear()
        i = np.arange(1,100)
        w = i;
        x = pylab.randn(100,1);
        y = pylab.randn(100, 1);
        z = pylab.randn(100, 1);        

#        self.axesMono.set_xdata(np.arange(len(x)))
#        self.axesMono.set_ydata(np.array(x))

        self.axesMono.plot(x, 'red')
        self.axesBi.plot(x,'yellow')
        self.axesLoc.plot(x, z, 'black')
        self.canvas.draw()

    def on_save_plot(self, event): 
        file_choices = "PNG (*.png)|*.png"
        dlg = wx.FileDialog(
            self, 
            message="Save plot as...",
            defaultDir=os.getcwd(),
            defaultFile="plot.png",
            wildcard=file_choices,
            style=wx.SAVE)

        if dlg.ShowModal() == wx.ID_OK:
            path = dlg.GetPath()
            self.canvas.print_figure(path, dpi=self.dpi)
            self.flash_status_message("Saved to %s" % path)

    def on_exit(self, event):
        self.Destroy()
if __name__ == '__main__':
    app = wx.PySimpleApp()
    app.frame = UltrasoundDemoGUI()
    app.frame.Show()
    app.frame.draw_plot()
    app.MainLoop()
    del app 
```

我似乎被限制在大约 3Hz 的刷新率。理想情况下，我希望以 10Hz 或更高的帧速率可视化数据。有谁知道如何使用轴对象有效（快速）更新绘图？

谢谢你的帮助，-B

# c++ - Eclipse 自动生成 Doxygen 注释配置

> ID：11129061
> 
> 赞同：4
> 
> 时间：2012-06-20T22:25:42.677
> 
> 标签：c++, eclipse, doxygen

似乎 Eclipse 现在有点原生地支持 Doxygen。转到 C/C++ -> 编辑器 -> 文档工具注释：Doxygen。

然而，它似乎只对自动生成的 /** */ 注释起作用。

在我们的项目中，我们使用三斜杠 /// 来生成 doxygen 注释。

似乎没有办法在 Eclipse 中配置 Doxygen 注释生成。有小费吗？有我们可以更改的配置文件吗？某种方式来强制它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-02T18:47:59.047

不幸的是，在发布此答案时，没有解决方案。在 Eclipse Juno 和以前的版本中，doxygen 注释样式显然是硬编码的。您可以在此处查看错误报告：[https ://bugs.eclipse.org/bugs/show_bug.cgi?id=333134](https://bugs.eclipse.org/bugs/show_bug.cgi?id=333134)

有一些变通方法，但没有一个支持仅通过键入'///[enter]' 在 Eclipse 中生成的自动 doxygen 注释。请参阅此处进行一些尝试：[Change doxygen comment style in Eclipse](https://stackoverflow.com/questions/4403192/change-doxygen-comment-style-in-eclipse)

C++ 代码模板是一个很好的尝试，但还有很多不足之处。

在这种情况发生变化之前，这是公认的答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-01-17T06:14:13.740

老问题，但最好添加一个新的答案，目前 eclipse cdt 9.10 in 2019-12 完全支持 /// 和 //! 样式，在 2020-03 中添加了一些选项来自定义 doxygen 行为

# sql - Oracle 10g 中的 CTE - “不支持的列别名”

> ID：11129064
> 
> 赞同：3
> 
> 时间：2012-06-20T22:25:56.983
> 
> 标签：sql, oracle, common-table-expression

当我尝试执行使用 CTE 的 sql 语句时收到以下错误：

```
ORA-32033: unsupported column aliasing
32033\. 00000 -  "unsupported column aliasing"
*Cause:    column aliasing in WITH clause is not supported yet
*Action:   specify aliasing in defintion subquery and retry
Error at Line: 1 Column: 9 
```

我试图执行的代码是：

```
WITH cte1
(
  SELECT *
  FROM test_table
)
SELECT *
FROM cte1; 
```

我知道这是一个简单的语句，不需要使用 CTE，但我只是想开始在 Oracle 中使用 CTE（我来自 T-SQL）。

为什么代码不执行？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-20T22:31:01.570

您缺少 AS：

```
WITH cte1 AS
(
  SELECT *
  FROM test_table
)
SELECT *
FROM cte1; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-20T22:30:42.517

我刚刚想通了——我需要在 CTE 名称后面加上 AS 关键字。所以声明应该是：

```
WITH cte1 AS
(
  SELECT *
  FROM test_table
)
SELECT *
FROM cte1; 
```

# android - 如何检查精灵是否与任何其他对象（Android AndEngine）发生碰撞？

> ID：11129065
> 
> 赞同：-2
> 
> 时间：2012-06-20T22:26:02.243
> 
> 标签：android, sprite, andengine, collision

当用户触摸屏幕时，会创建一个 sprite，并且可以拖动它直到用户抬起手指。在这一点上，一个物理体被附加到精灵上，这样它就会落到屏幕的底部。但是，当精灵与另一个精灵/身体碰撞时，我需要它停止移动。如何检查创建的精灵与任何其他身体/精灵（墙壁和任何其他创建的）之间的碰撞？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T14:40:39.947

您正在寻找有关[碰撞检测](https://en.wikipedia.org/wiki/Collision_detection)的信息。

根据您的情况，实施起来相对简单。最简单的方法是将所有对象保存在一个数组/列表中，每次移动它时，您都需要计算其当前位置 + 面积与其他所有对象。这将是非常低效的，但如果你有少量的对象，你可能没问题。

[这](http://lazyfoo.net/SDL_tutorials/lesson17/index.php)是我做的第一个碰撞检测教程。它适用于 C，但概念正是您要寻找的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-28T12:09:44.407

AndEngine 中实现了一个相当简单的碰撞检测。查看方法`collidesWith(IShape pOtherShape)`有人对其进行了改进，使其适用于透明区域，搜索像素完美碰撞检测。

您还可以使用物理引擎，请参阅[sensor](http://www.box2d.org/manual.html#_Toc258082972)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-01T08:07:42.287

虽然计算面积会起作用，但我正在处理如此多的碰撞，我需要一个更好的方法。花了很多时间，但我终于弄清楚了如何使用 ContactListener （这确实是我所追求的。当有人真正需要做的只是解释一下时，为什么这类问题总是被否决一个新手？？？）无论如何，为了参考可能会看到这个问题的其他人，在您的 ContactListener 中，您可以使用如下代码：

```
public void beginContact(Contact contact) {
            if(fillerNum>-1 && contact.getFixtureA().getBody().getUserData()!=null && contact.getFixtureB().getBody().getUserData()!=null){
                String x1 = (String) contact.getFixtureA().getBody().getUserData();
                String x2 = (String) contact.getFixtureB().getBody().getUserData();
                if((x1.equals("fill")&&!x2.equals("dest"))||(x2.equals("fill"))&&!x1.equals("dest")){ //If a filler hits a stationary
                    //Log.e("Contact",x1 + " " + x2); 
                    createStationaryFiller();
                }
                if((x1.equals("dest")&&x2.equals("fill"))||(x1.equals("fill")&&x2.equals("dest"))){ //If a destroyer hits a filler
                    destroyFiller();
                }
            }
        } 
```

设置成长中的实体让用户数据“填充”，而固定的实体让用户数据“统计”。我还有其他一些用户数据为“dest”的机构。这样，您可以看到哪两个发生碰撞并做出相应的反应。不明白的给我留言。*我*可以帮助那些不熟悉这种事情的人。

# c - 如何遍历这个由多个结构、数组和指针组成的 C 数据结构？

> ID：11129071
> 
> 赞同：0
> 
> 时间：2012-06-20T22:26:25.187
> 
> 标签：c, pointers, memory-management

```
typedef struct trans * Trans;

typedef struct state{
    int f;
    char  label[20];
    trans * TrasitionsArray[10];
}state;

struct trans{
    state * from;
    state * to;
    char  label;
};

void main(){
    state  StatesArray[100];
} 
```

如何为 (state---trasition---to---label) 赋值

我试过这个但失败了：

```
strcpy(StatesArray[i].TrasitionsArray[j]->to->label,"blahblah"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T22:41:40.523

您必须先分配一些内存。所有指向数组的指针都未初始化。

```
int i, j;
struct state states[100];
for (i = 0; i < 100; i++)
{
    states.transitionsArray = (struct trans*)malloc(sizeof(struct trans)*10);
    for (j = 0; j < 10; j++)
    {
        // set 'from' and 'to' pointers here
    }
} 
```

顺便说一句：我以为你的意思是`struct trans * trasitionsArray;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T22:30:10.933

你不能，因为你只分配了一个`state`s 数组。该`state`结构有一个指向数组的指针`trans`，但您从未分配过该数组。

在分配`StatesArray`数组的行之后，您需要遍历该数组并将内存和值分配给`TransitionsArray`each 中的元素`state`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T08:49:57.410

`state StatesArray[100];`只会为状态的结构成员分配内存。它将仅分配 10 * 4 字节（32 位 m/c 中的指针大小）`TrasitionsArray`来保存十个`Transition`结构变量。`transition`但是没有为结构变量的成员分配内存。同样for `from`and`to`结构变量也一样。

使用下面的示例代码分配内部指针变量。

```
int i, j; 
struct state states[100]; 
for (i = 0; i < 100; i++) 
{     
    for (j = 0; j < 10; j++)
    {
        StatesArray[i].TrasitionsArray[j] = (struct trans*)malloc(sizeof(struct trans));   
        StatesArray[i].TrasitionsArray[j]->from = (struct state *)malloc(sizeof(struct state));
        StatesArray[i].TrasitionsArray[j]->to = (struct state *)malloc(sizeof(struct state));
    }
} 
```

注意：注意`NULL`检查返回值`malloc`

# c++ - inplace_merge ：为什么 inplace_merge 不合并字符串？

> ID：11129077
> 
> 赞同：1
> 
> 时间：2012-06-20T22:26:53.790
> 
> 标签：c++

为什么不`inplace_merge`合并下面代码中的字符串？

```
string src = "abc";
string new_str = "def";
src += new_str;
inplace_merge(src.begin(), src.begin()+3, src.end());
cout << src; // abcdef 
```

编辑：我期待“adbecf”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T22:35:42.930

它确实可以正常工作，但是您选择了错误的测试数据。

[`std::inplace_merge`](http://en.cppreference.com/w/cpp/algorithm/inplace_merge)对序列中两个已排序的连续范围进行合并，**就像在合并排序中一样**。

也就是说，如果您传递字符串`adebcf`（假设参数设置为您的问题），它将被合并到`abcdef`. 如果你传递一个字符串`abcdef`，结果与输入相同，因为这个字符串已经是有序的。

# django - 捕获 Django 异常时返回 JSON 错误？

> ID：11129079
> 
> 赞同：6
> 
> 时间：2012-06-20T22:27:12.600
> 
> 标签：django, json, exception-handling

有没有人对让中间件捕获异常的最佳方法有意见，而不是将错误呈现到 HTML 模板中，而是返回一个 JSON 对象？目前我有下面的中间件来捕获异常，如果它可以找到额外的用户错误消息，则将其放入请求中（然后模板会拾取）。

```
类 ExceptionUserErrorMessageMiddleware（对象）：
    def process_exception（自我，请求，异常）：
        """ 如果异常有与用户相关的信息，那么
        将其附加到请求对象上"""

        theFormat = djrequest.get_getvar(request, settings.FORMAT_PARAM, "")
        msg = getMessage（异常）
        如果味精：
            setattr（请求，USER_ERROR_MESSAGE_ATTR，味精）

        如果格式 == “json”：
            打印“做某事”

```

在这里返回 json 对象的最佳方式是什么？我应该设置任何其他标题吗？

对于不通过中间件的特殊情况，有没有办法做同样的事情（我很确定 404 没有，还有其他的吗）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-06T17:00:49.027

我们在我们的项目 MapIt 上所做的 - [https://github.com/mysociety/mapit](https://github.com/mysociety/mapit) - 这样做是为了向中间件引发异常，正如你所说，然后直接返回 HTML 模板或 JSON 对象，具体取决于请求提供的格式。[您可以在https://github.com/mysociety/mapit/blob/master/mapit/middleware/view_error.py](https://github.com/mysociety/mapit/blob/master/mapit/middleware/view_error.py)查看代码

在附加标头方面，我们的 output_json 函数将响应中的 Content-Type 设置为 'application/json; 字符集=utf-8'。

对于 404 情况，我们有自己的 get_object_or_404 函数，它包装了 get_object_or_404 并将 Django Http404 异常转换为我们自己的异常，然后如果适合请求，该异常将正确返回 JSON。

```
from django.shortcuts import get_object_or_404 as orig_get_object_or_404

def get_object_or_404(klass, format='json', *args, **kwargs):
    try:
        return orig_get_object_or_404(klass, *args, **kwargs)
    except http.Http404, e:
        raise ViewException(format, str(e), 404) 
```

# erlang - Tsung 错误：无法在主机上启动 newbeam

> ID：11129080
> 
> 赞同：3
> 
> 时间：2012-06-20T22:27:12.913
> 
> 标签：erlang, tsung

我一直试图让 tsung 连接到我运行 kubuntu 12.04 的盒子

这是我的配置的客户端部分

```
<clients>
    <client host="klaptop" weight="1" maxusers="500"/>
</clients> 
```

我使用以下命令运行 tsung

```
tsung -f /var/tsung/xml/config.xml -l /var/tsung/logs/ start 
```

我在 tsung_controller 日志文件中收到以下错误

```
=INFO REPORT==== 20-Jun-2012::15:06:01 ===
ts_config_server:(0:<0.72.0>) Can't start newbeam on host klaptop (reason: timeout) !     Aborting! 
```

我已经阅读了手册的故障排除并尝试确保涵盖了我的所有基础（相同的 erlang 版本、ssh 连接无需密码、主机名设置正确等）

我已经确认了与他们给出的示例的连接性，这是我的结果。

```
[/var/tsung]$ erl -rsh ssh -sname foo -setcookie mycookie
Erlang R15B01 (erts-5.9.1) [source] [64-bit] [smp:8:8] [async-threads:0] [hipe] [kernel-poll:false]

Eshell V5.9.1  (abort with ^G)
(foo@macbook)1> slave:start(klaptop,bar,"-setcookie mycookie").
{ok,bar@klaptop} 
```

用户手册似乎假设一旦连接在 erlang 中工作，tsung 也会工作，但对我来说并非如此，我仍然遇到同样的超时问题。

我不知道如何进一步调试这个，任何帮助或建议将不胜感激。

更新：根据评论中的要求，我尝试使用 IP。使用以下配置

```
<client host="klaptop" weight="1" maxusers="500">
  <ip value="10.160.1.89"></ip>
</client> 
```

我得到了同样的错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-22T01:45:58.887

我遇到了类似的问题，ssh 密钥检查可能会妨碍我。
尝试这个：

1.  使用 tsung 1.4.3 或更新版本

2.  创建一个脚本文件（比如 some_dir/ssh_no_check）：

    ```
    #!/bin/sh
    /usr/bin/ssh -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no $@ 
    ```

3.  使其可执行。

4.  添加：

    ```
     -r some_dir/ssh_no_check 
    ```

到您的 tsung 命令参数。

这将禁用 tsung 的 ssh 密钥检查。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-12T08:18:21.580

```
Can't start newbeam on host XXXX (reason: timeout) 
```

在我的情况下（Debian 6.0，tsung 1.4.2），这个错误的原因是客户端还必须有 ssh 密钥才能连接到主服务器。文档中没有明确提及它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-21T21:49:34.433

1.  确保禁用 ssh 密钥验证

~/.ssh/config Host * StrictHostKeyChecking no UserKnownHostsFile=/dev/null

2.  **确保所有端口都可以跨控制器和工作节点访问。** *如果它在云中，请确保防火墙或安全组允许所有端口。*

3.Erlang，Tsung必须有相同的版本。

4.确保所有机器都可以互相访问

5.运行erlang测试

erl -rsh ssh -name subbu -setcookie tsung Erlang R16B03-1 (erts-5.10.4) [source] [64-bit] [smp:2:2] [async-threads:10] [hipe] [kernel-poll ：错误的]

Eshell V5.10.4（使用 ^G 中止）(daya@ip-10-0-100-224.ec2.internal)1> slave:start("worker1.com",bar,"-setcookie tsung")。

警告：将“worker1,10.0.100.225”（ECDSA）永久添加到已知主机列表中。{好吧，酒吧@worker1}

从控制器运行此测试到所有工作节点。

您应该能够毫无问题地运行测试。

祝你好运！

副部

# c# - Linq ebay XML 使用查询样式解析 ASP 和 C#？

> ID：11129082
> 
> 赞同：1
> 
> 时间：2012-06-20T22:27:34.613
> 
> 标签：c#, asp.net, linq, xml-parsing

自从我使用 ASP.Net 和 C# 以来已经有一段时间了。我正在尝试使用 C# 解析 XML API，我需要一些帮助。我的问题是我不太确定如何做到这一点。我也不断看到相互矛盾的方法。有些像我在下面做的那样。有些显示非常棒的查询，对我来说看起来更好。

查询示例

```
IEnumerable<string> partNos =
    from item in purchaseOrder.Descendants("Item")
    select (string) item.Attribute("PartNumber"); 
```

哪种方法更好，我现在如何实现将 XML 解析为文本框？

这是 XML 格式：此 XML 文件似乎没有任何与之关联的样式信息。文档树如下所示。

```
<findItemsByKeywordsResponse xmlns="http://www.ebay.com/marketplace/search/v1/services">
<ack>Success</ack>
<version>1.12.0</version>
<timestamp>2012-06-20T22:20:33.539Z</timestamp>
<searchResult count="1">
<item>
<itemId>390432965446</itemId>
<title>
Yamaha RX-V673 7.2 Channel 90 Watt Aventage Receiver {Brand New}
</title>
<globalId>EBAY-US</globalId>
<primaryCategory>
<categoryId>14981</categoryId>
<categoryName>Home Theater Receivers</categoryName>
</primaryCategory>
<galleryURL>
http://thumbs3.ebaystatic.com/pict/3904329654464040_1.jpg
</galleryURL>
<viewItemURL>
http://www.ebay.com/itm/Yamaha-RX-V673-7-2-Channel-90-Watt-Aventage-Receiver-Brand-New-/390432965446?pt=Receivers_Tuners
</viewItemURL>
<productId type="ReferenceID">114468754</productId>
<paymentMethod>PayPal</paymentMethod>
<autoPay>false</autoPay>
<postalCode>54143</postalCode>
<location>Marinette,WI,USA</location>
<country>US</country>
<shippingInfo>
<shippingServiceCost currencyId="USD">0.0</shippingServiceCost>
<shippingType>Free</shippingType>
<shipToLocations>US</shipToLocations>
<expeditedShipping>false</expeditedShipping>
<oneDayShippingAvailable>false</oneDayShippingAvailable>
<handlingTime>2</handlingTime>
</shippingInfo>
<sellingStatus>
<currentPrice currencyId="USD">519.0</currentPrice>
<convertedCurrentPrice currencyId="USD">519.0</convertedCurrentPrice>
<sellingState>Active</sellingState>
<timeLeft>P28DT23H32M35S</timeLeft>
</sellingStatus>
<listingInfo>
<bestOfferEnabled>false</bestOfferEnabled>
<buyItNowAvailable>false</buyItNowAvailable>
<startTime>2012-06-19T21:48:08.000Z</startTime>
<endTime>2012-07-19T21:53:08.000Z</endTime>
<listingType>StoreInventory</listingType>
<gift>false</gift>
</listingInfo>
<returnsAccepted>true</returnsAccepted>
<condition>
<conditionId>1000</conditionId>
<conditionDisplayName>New</conditionDisplayName>
</condition>
<isMultiVariationListing>false</isMultiVariationListing>
</item>
</searchResult>
<paginationOutput>
<pageNumber>1</pageNumber>
<entriesPerPage>1</entriesPerPage>
<totalPages>1121495</totalPages>
<totalEntries>1121495</totalEntries>
</paginationOutput>
<itemSearchURL>
http://www.ebay.com/sch/i.html?_nkw=yamaha&_ddo=1&_ipg=1&_pgn=1
</itemSearchURL>
</findItemsByKeywordsResponse> 
```

我的 C# 代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Xml.Linq;

namespace ebayLinq
{
    public partial class _Default : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            string myAppID = "hidden from stack overflow";
            string ebayUrl = "http://svcs.ebay.com/services/search/FindingService/v1?";
            string operationName = "OPERATION-NAME=getSearchKeywordsRecommendation&";
            string serviceVersion = "SERVICE-VERSION=1.11.0&";
            string securityAppName = "SECURITY-APPNAME="+ myAppID +"&";
            string responseData = "RESPONSE-DATA-FORMAT=XML&";
            string rest = "REST-PAYLOAD&";

            string searchString = "macbook Pro";
            string keywords ="keywords="+searchString+"&";

            var xml = XDocument.Load(ebayUrl + 
                                        operationName + 
                                        serviceVersion + 
                                        securityAppName + 
                                        responseData);

            //XNamespace ns = "http://www.ebay.com/marketplace/search/v1/services";
            //XElement ack = xml.Root.Element(ns + "ack");    
        }
    }
} 
```

好的，我可以让它与上面的代码一起工作，但到目前为止我不知道如何比 ack 更深入。我也宁愿做查询，而不是上面使用的方法。

有输入的朋友吗？

根据您的意见，我想出了这个，但它不起作用？

```
 XElement convertedCurrentPrice = (from x in xml.Root.Descendants("title") select x).FirstOrDefault();
                string item = Convert.ToString(convertedCurrentPrice);
                TextBox1.Text = item; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T22:40:23.023

很难回答哪种语法更好。作为参考，它们被称为**Query Syntax**和**Method Syntax**。这是一篇关于差异的[MSDN 文章](http://msdn.microsoft.com/en-us/library/bb397947.aspx)（由于可读性，文章建议使用查询语法）。它们大致相当，我经常使用它们。

为了进一步参考，这里是一个讨论该主题的[SO 问题。](https://stackoverflow.com/questions/214500/which-linq-syntax-do-you-prefer-fluent-or-query-expression)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T22:43:29.967

我个人对解析 XML 的旧方法并不熟悉，但新的 LINQ to XML 东西是您正在谈论的查询样式，并且在从 XDocument 中提取信息时绝对可以让事情变得快速和简单。

如果您给我一个示例，说明您特别想从中提取数据的一个或多个节点，我可以帮助您解决这个问题，但基本结构将是（例如，如果您想获取 519.0 的当前价格值）

```
XElement convertedCurrentPrice = (from x in xml.Root.Descendants("convertedCurrentPrice") select x).FirstOrDefault(); 
```

这将返回整个 XML 节点（介于两者之间的所有内容）

然后获取值很简单：

```
double price = Convert.ToDecimal(convertedCurrentPrice.Value); 
```

# unit-testing - 如何在 Node.js 中对请求响应周期进行单元测试？

> ID：11129088
> 
> 赞同：2
> 
> 时间：2012-06-20T22:28:43.410
> 
> 标签：unit-testing, node.js, httprequest

例如假设我有以下

```
app.get('/', function(req, res) {
    var ip;
    if(req.headers['x-forwarded-for']){
        ip = req.headers['x-forwarded-for'];
    }
    else {
        ip = req.connection.remoteAddress;
    }
}); 
```

我想进行单元测试以查看是否正确检索了 ip。一种方法如下

```
function getIp(req) {
    var ip;
    if(req.headers['x-forwarded-for']){
        ip = req.headers['x-forwarded-for'];
    }
    else {
        ip = req.connection.remoteAddress;
    }
    return ip;
}

app.get('/', function(req, res) {
    var ip = getIp(req);
}); 
```

现在我有一个函数 getIp 可以进行单元测试。但是我仍然卡住了。如何将模拟的 req 对象输入 getIp？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T05:31:30.003

我会为此编写[集成](http://en.wikipedia.org/wiki/Integration_testing)测试。Node.js 足够快。尤其是当您使用类似[Mocha 的](https://github.com/visionmedia/mocha)手表模式时。您可以使用[superagent](https://github.com/visionmedia/superagent)或 request 之类的东西来执行 http 请求。

还有类似[nock](https://github.com/flatiron/nock)的东西来[模拟](http://en.wikipedia.org/wiki/Mock_object)你的 http 请求。尽管我从未使用过它，因为集成测试测试的是真实的东西并且速度足够快，可以满足我的口味。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T20:26:55.567

我建议使用[mocha](https://github.com/visionmedia/mocha)编写单元测试，在这种情况下，您将使用“请求”作为您的 http 客户端。但最简单的入门方法是使用以下内容：

```
var http = require('http');
//Change to the ip:port of your server
var client = http.createClient(3000, 'localhost'); 

var request = client.request('GET', '/',
  {'host': 'localhost'});
request.end();
request.on('response', function (response) {
  console.log('STATUS: ' + response.statusCode);
  console.log('HEADERS: ' + JSON.stringify(response.headers));
  response.setEncoding('utf8');
  response.on('data', function (chunk) {
    console.log('BODY: ' + chunk);
  });
}); 
```

# php - 如果不存在则插入到表中并返回结果

> ID：11129092
> 
> 赞同：1
> 
> 时间：2012-06-20T22:29:05.327
> 
> 标签：php, mysql, insert

我有一个像这样的“用户”SQL 表结构（由于某些原因，ID 是随机生成的，它不是自动递增的）：

```
ID    name     deleted    lastActive
3242  Joe      0          20-6-2012 23:14
2234  Dave     0          20-6-2012 23:13
2342  Simon    1          20-6-2012 23:02
9432  Joe      1          20-6-2012 22:58 
```

在一个查询中（为了避免并发查询添加两次相同的名称），如果还没有具有该名称的记录并且已删除 = 0，我需要向表中添加一个新用户。然后我需要知道查询的结果（如果添加了用户）以便我可以报告用户是否已添加。这可能使用PHP吗？

我可以这样做（当然，作为准备好的声明！）：

```
INSERT INTO users (ID, name) VALUES ($id, $name) 
    WHERE NOT EXISTS (SELECT 1 FROM users WHERE name = $name AND deleted = 0) 
```

但是我怎么知道用户是否被添加呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T22:31:37.340

如果您使用的是 mysqli，则可以使用该[`mysqli_stmt_affected_rows()`](http://us2.php.net/manual/en/mysqli-stmt.affected-rows.php)函数来确定插入了多少行。

同样，您可以使用该[`PDOStatement::rowCount()`](http://us2.php.net/manual/en/pdostatement.rowcount.php)方法确定为 PDO 插入了多少行。

这两个函数都会告诉您作为查询结果插入的行数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T22:32:33.800

*   [您可以使用mysql_affected_rows](http://php.net/manual/en/function.mysql-affected-rows.php)在 mysql 中了解受查询影响的行数 。
*   如果您使用 PDO，则 [PDOStatement::rowCount](http://www.php.net/manual/en/pdostatement.rowcount.php)。
*   如果是 MYSQLi，[mysqli_affected_rows](http://www.php.net/manual/en/mysqli.affected-rows.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T22:48:33.943

这是一个返回 ID 的不错的插入方法：

```
/**
 * Execute an insert or update in the database.
 * @param $table - Table name.
 * @param $key_name - Primary key to update. NULL to a insert
 * @param $data - Column data array
 * @param $call_on_error function name that should called in case of an exception during the
 * execution of the statment, the function is expected to take one argument, the exception object
 * @return mixed An array containing the key inserted or updated on success, false on failure.
 */
function INSERT($table, $key_name, &$data, $call_on_error = null) {
    list($min_cols, $prefix, $suffix, $key_value) = isset($data[$key_name]) ?
        array(2, 'UPDATE', " WHERE `$key_name`=:$key_name", $data[$key_name]) :
        array(1, 'INSERT', '', null);
    if (count($data) < $min_cols) {
        return false;
    }
    $set_clause = '';
    foreach ($data as $k => $v) {
        if ($k !== $key_name) {
            if (($flag_name = strstr($k, "__", true))) {
                if (strcmp($k, "{$flag_name}__mask") && isset($data["{$flag_name}__value"]))
                    $set_clause .= ",`$flag_name`=:{$flag_name}__value | (`$flag_name` & :{$flag_name}__mask)";
            } else {
                $set_clause .= ",`$k`=:$k";
            }
        }
    }
    global $dbo_error_duplicated;
    $dbo_error_duplicated = false;
    $dbh = DBH();
    try {
        $sth = $dbh->prepare("$prefix $table SET " . substr($set_clause, 1) . $suffix);
        $res = $sth->execute($data);
    } catch (PDOException $e) {
        $dbo_error_duplicated = $sth->errorCode() === '23000';
        echo $e;
        if(isset($call_on_error)){
            call_user_func($call_on_error, $e);
        }
        $res = false;
    }
    if ($res) {
        if ($key_value === null && is_numeric($id = $dbh->lastInsertId())) {
            $key_value = $id;
        }
        $res = $key_value === null ? false : array($key_name => $key_value);
    }
    return $res;
} 
```

还有…… DBH 配置：

```
/**
 * Get Data Base Handler.
 * Manual @ http://www.php.net/manual/en/pdostatement.fetch.php
 * More info @ http://net.tutsplus.com/tutorials/php/why-you-should-be-using-phps-pdo-for-database-access/
 *
 * @return PDO Data Base Handler
 */
function DBH() {
    global $DBH;
    global $db_config;

    if ($DBH === null) {
        // throws PDOException on connection error
        $DBH = new PDO("mysql:host=$db_config[host];dbname=$db_config[dbname]", $db_config['user'], $db_config['pass'],
                        array(PDO::ATTR_PERSISTENT => $db_config['persistent'], PDO::MYSQL_ATTR_INIT_COMMAND => "SET NAMES '$db_config[encoding]'"));
        // ask PDO to throw exceptions for any error
        $DBH->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    }
    return $DBH;
} 
```

使用这个 .ini 文件：

```
[db_config]
persistent  = true
host        = "localhost"
user        = "root"
pass        = ""
dbname      = "theDbName"
# host      = "db.production_host.com"
# user      = "prod_root"
# pass      = "big4nd5tr0ngp4s5word"
# dbname    = "theDbName"
encoding    = "UTF8" 
```

# python - Python：简化嵌套的 FOR 循环？

> ID：11129093
> 
> 赞同：5
> 
> 时间：2012-06-20T22:29:14.757
> 
> 标签：python, loops, for-loop, nested

我想知道是否有办法简化下面的嵌套循环。困难在于每个循环的迭代器都依赖于前一个循环中的东西。这是代码：

```
# Find the number of combinations summing to 200 using the given list of coin

coin=[200,100,50,20,10,5,2,1]

total=[200,0,0,0,0,0,0,0]
# total[j] is the remaining sum after using the first (j-1) types of coin
# as specified by i below

count=0
# count the number of combinations

for i in range(int(total[0]/coin[0])+1):
    total[1]=total[0]-i*coin[0]
    for i in range(int(total[1]/coin[1])+1):
      total[2]=total[1]-i*coin[1]
      for i in range(int(total[2]/coin[2])+1):
          total[3]=total[2]-i*coin[2]
          for i in range(int(total[3]/coin[3])+1):
              total[4]=total[3]-i*coin[3]
              for i in range(int(total[4]/coin[4])+1):
                  total[5]=total[4]-i*coin[4]
                  for i in range(int(total[5]/coin[5])+1):
                      total[6]=total[5]-i*coin[5]
                      for i in range(int(total[6]/coin[6])+1):
                          total[7]=total[6]-i*coin[6]
                          count+=1

print count 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T22:35:19.333

我建议查看[http://labix.org/python-constraint](http://labix.org/python-constraint)，它是一个 Python 约束库。它的示例文件之一实际上是达到特定数量的硬币排列，一旦您指定规则，它就会为您处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T23:43:51.567

1.  您可以摆脱所有的 int 强制转换。int/int 在 python 中仍然是 int，即整数除法。

2.  看起来递归会很好地清理这个

    ```
    count  = 0
    coin=[200,100,50,20,10,5,2,1]
    total=[200,0,0,0,0,0,0,0]

    def func(i):
        global count,total,coin
        for x in range(total[i-1]/coin[i-1]+1):
            total[i]=total[i-1]-x*coin[i-1]
            if (i == 7):
                count += 1
            else:
                func(i+1) 
    ```

    func(1) 打印计数

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T22:41:10.697

```
combinations = set()
for i in range(len(coins)):
  combinations = combinations | set(for x in itertools.combinations(coins, i) if sum(x) == 200)
print len(combinations) 
```

这有点慢，但它应该工作。

# css - 使用 HTML 属性作为 CSS 属性值

> ID：11129094
> 
> 赞同：8
> 
> 时间：2012-06-20T22:29:29.950
> 
> 标签：css

规范说：

> attr() 函数返回**元素上的属性值，以用作属性中的值**。如果在伪元素上使用，它返回伪元素的原始元素上的属性值。

[http://www.w3.org/TR/css3-values/#attr](http://www.w3.org/TR/css3-values/#attr)

但是，这似乎不起作用。当我使用时，`background-image: url(attr(href));`我得到字符串“attr(href)”作为属性值，而不是值本身。

[http://jsfiddle.net/x2Rpt/1/](http://jsfiddle.net/x2Rpt/1/)

任何想法为什么这被打破了？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-20T22:33:55.363

它没有坏；只是没有浏览器实现[了 CSS3 版本的`attr()`](http://www.w3.org/TR/css3-values/#attr). 目前，实现只存在[于 CSS2.1 中引入的](http://www.w3.org/TR/CSS21/generate.html#x18)那个，它仅限`content`于生成和替换内容的属性。

否则，您的语法似乎是正确的，除非对规范进行更改。

# xcode - Cocos2D-X XCode下fopen64编译报错

> ID：11129095
> 
> 赞同：1
> 
> 时间：2012-06-20T22:29:38.043
> 
> 标签：xcode, cocos2d-x

我尝试自己为 Cocos2D-x 设置一个新的 XCode 项目，但我在文件 cocos2dx/support/zip_support/ioapi.cpp 中得到一个奇怪的编译错误，并且 XCode 抱怨使用 fopen64、ftello64 等的代码。我的问题是为了使 XCode 使用这些 64 位函数编译，我需要设置什么设置吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-11T22:56:02.733

您可以`#define USE_FILE32API`，最好在您的项目设置中。这是由支持 64 位的新版[minizip引起的。](http://www.winimage.com/zLibDll/minizip.html)

# eclipse - 显示和表达式视图给出错误

> ID：11129098
> 
> 赞同：3
> 
> 时间：2012-06-20T22:29:49.107
> 
> 标签：eclipse, grails, sts-springsourcetoolsuite

我正在使用 SpringSource Tool Suite 2.9.2 和 Grails 2.0.3。我正在尝试使用表达式和显示窗口，但两者都给了我错误。

表达式窗口说：

> org.eclipse.debug.core.DebugException: com.sun.jdi.ObjectCollectedException 发生检索类型

这条消息有时会有所不同，并说它无法获得正确的类型，就好像我没有包含包一样。

显示窗口说：

> “评估失败。原因：评估期间发生异常。”

有人知道发生了什么吗？

*编辑：安德鲁，除了“在所有*项目（不仅仅是 Groovy 项目）上启用额外的 Groovy 调试支持”之外，检查了首选项中的所有这些项目。我检查了。

我仍然收到错误消息，由于某种原因，日志中没有显示任何内容，但表达式会打开一个子窗口，上面写着：

> 查看错误日志：启动失败： *_* _Eval.groovy：7：无法解析类 mydomain.User @ 第 7 行，第 23 列。导入 mydomain.User；^
> 
> 1 个错误

可能相关的内容：此导入是页面上的第三个域导入。另外两个看起来正在运行的位于我的“grails-app”文件夹中的“域”文件夹中，但由于项目正在使用 Hibernate.xml 文件，因此无法运行的位于“src/groovy”中。我希望表达式适用于任何一个，但也许这就是问题所在？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T15:54:43.297

在调试评估可以在 Groovy 中工作之前，您需要做几件事。大多数时候，这些东西是自动配置的，但有时你需要手动做一两件事。

1.  转到 Preferences -> JDT Weaving，确保它已启用
2.  转到首选项 -> Groovy -> 调试器 -> 扩展调试。确保选中所有复选框。

如果您仍然收到此异常，那么这可能是一个错误。请使用错误日志中的完整堆栈跟踪更新您的问题（窗口 -> 显示视图 -> 其他 -> 错误日志）。此外，包括您正在评估的代码片段。

# javascript - 计算相邻圆段

> ID：11129100
> 
> 赞同：0
> 
> 时间：2012-06-20T22:29:53.880
> 
> 标签：javascript, math, geometry, raphael, computational-geometry

我正在尝试开发一个看起来[有点像这样的组件](https://dl.dropbox.com/u/32242922/photo.GIF)

我正在使用 RaphaelJS 来绘制这个并且效果很好。我有一个角度数组，用于计算各个段的路径。我将这些路径存储在一个简单的数组中，因此内圈位于段[0] 处，以此类推向外螺旋。

我的问题是我需要每个段都知道它是顺时针、逆时针、向内和向外的相邻段，我很难弄清楚如何计算这些段的位置是我的段数组。因此，例如，在上图的情况下，第 2 级的红色段（其中 0 是最内圈）有红色、亮绿色、柿子、浅紫色和深紫色邻居。

也许我需要一个不同的坐标系。如果每个级别具有相同数量和角度分布的段，则使用模数就像索引圆形数组一样简单，但事实并非如此。

任何帮助将非常感激。

非常感谢，

安东尼

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T11:22:25.427

我会改变你如何将一个排序数组中的段存储到每个级别一个排序数组中。

找到给定段 (S) 的邻居就相当容易了：左右邻居是该级别数组的前一个和下一个元素。

相邻级别的邻居是通过在这些数组中的几个二分搜索找到的：找到与 S 的开始和结束角度重合的线段，邻居是这两者之间的线段序列。

# database - 并行打开数据库连接

> ID：11129102
> 
> 赞同：1
> 
> 时间：2012-06-20T22:30:03.057
> 
> 标签：database, database-connection

如果`MySQL`数据库连接已经从脚本打开（比如说`PHP`），是否建议另一个脚本（比如说`python`）同时访问同一个数据库表？如果不是，应该有什么替代方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T22:34:30.427

MySQL 等数据库系统旨在适应这种多用户访问。他们通过使用锁定机制来做到这一点，其中大部分都在后台工作。锁定机制防止一个用户在其他人正在写入记录时尝试读取记录，或者两个用户同时写入相同的记录。

见[http://dev.mysql.com/doc/refman/5.0/en/internal-locking.html](http://dev.mysql.com/doc/refman/5.0/en/internal-locking.html)

# oracle - 从 Oracle 的 SYSTEM 表空间中删除用户创建的数据文件

> ID：11129104
> 
> 赞同：1
> 
> 时间：2012-06-20T22:30:10.620
> 
> 标签：oracle, tablespace

在尝试为 USER 创建替换表空间时，我不小心在 SYSTEM 中创建了一个数据文件

太多的应用程序正在使用数据库来关闭整个数据库，如果这些应用程序不运行，人们会受到伤害。

有没有办法让我从 SYSTEM 表空间中删除数据文件而不将其关闭？

我试过了：

```
ALTER TABLESPACE SYSTEM DROP DATAFILE 'path_here.dbf' 
```

但得到这个错误：

```
Error starting at line 1 in command:
alter tablespace system drop datafile 'path_here.dbf'
Error report:
SQL Error: ORA-01541: system tablespace cannot be brought offline; shut down if necessary
01541\. 00000 -  "system tablespace cannot be brought offline; shut down if necessary"
*Cause:    Tried to bring system tablespace offline
*Action:   Shutdown if necessary to do recovery 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T05:27:18.163

来自 Oracle [11.1 文档](http://docs.oracle.com/cd/B28359_01/server.111/b28310/dfiles006.htm)

> 您不能在 SYSTEM 表空间中删除数据文件。

但是，您可以调整数据文件的大小。

# json - 对 Google 表格的 API 请求的 JSON 响应过于臃肿

> ID：11129106
> 
> 赞同：1
> 
> 时间：2012-06-20T22:30:26.877
> 
> 标签：json, google-spreadsheet-api

我在公共只读文档上使用电子表格 JSON api。有没有办法不接收单个单元格的链接和所有额外的膨胀？我只想要数据。

我的请求构造为

> `http://spreadsheets.google.com/feeds/list/DOCKEY/public/values?alt=json-in-script&callback=callback`

消除类别和链接对象将大大缩小响应..

我可以使用基本而不是值，但是我必须解析内容。$t。获取值....

还有另一种我找不到的方法吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T18:14:43.963

您可以考虑以 csv 格式下载电子表格。似乎没有 API，但也许您可以自己构建 URL。

另请参阅[使用 google drive API 下载 csv 格式的电子表格](https://stackoverflow.com/questions/11619805/using-the-google-drive-api-to-download-a-spreadsheet-in-csv-format)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T00:58:49.153

您可以考虑使用 Apps 脚本，它会为您提供检索您指定的单元格范围值的方法：

[https://developers.google.com/apps-script/class_range#getValues](https://developers.google.com/apps-script/class_range#getValues)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-04-23T21:05:46.483

与 Apps 脚本类似的[`SpreadsheetApp#Range#getValues()`](https://developers.google.com/apps-script/reference/spreadsheet/range#getValues)是 Sheets REST API 的[`spreadsheets.values()`](https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets.values)端点。这样做的好处是您可以从您选择的位置部署它，而不仅限于在 Apps Script 版本的 Javascript 中工作。Google 提供多种语言版本的客户端库，可简化授权访问的实施。

此外，当向 Google REST API 发出请求时，[标准参数](https://developers.google.com/sheets/api/query-parameters)之一是`fields`规范，它允许将应返回的数据限制为仅您请求发送的数据。

引用他们的部分响应片段：

> 电子表格很大，而且您通常不需要电子表格的每个部分。您可以使用 fields URL 参数限制在 Google Sheets API 响应中返回的内容。这在电子表格.get 方法中特别有用。为获得最佳性能，请在回复中明确列出您需要的字段。fields 参数的格式与 FieldMask 的 JSON 编码相同。简而言之，多个不同的字段用逗号分隔，子字段用点分隔。为方便起见，可以在括号内列出来自同一类型的多个子字段。
> 
> 例如，要检索电子表格的标题、工作表的属性以及范围 A1:C10 的值和格式。您可以使用以下请求：
> 
> `GET https://sheets.googleapis.com/v4/spreadsheets/YOURSHEETID?ranges=A1:C10&fields=properties.title,sheets(sheetProperties,data.rowData.values(effectiveValue,effectiveFormat))`

# r - 从R中的有序对象集合（列表）中删除非字母数字字符

> ID：11129107
> 
> 赞同：0
> 
> 时间：2012-06-20T22:30:31.683
> 
> 标签：r, list, data-cleaning, non-alphanumeric

我有一个关于从 R 中的列表中删除非字母数字字符的问题。我有一个列表将包含各种奇数字符、空格等，并希望删除它们。我通常可以使用 r 中的 tm 包删除我想要的内容。我摆弄它，但无处可去，所以认为回到列表可能是开始的地方。

名单：

```
 list("\n    \n", "\n\n  ", "\n        ", "               ", "\n    ", 
 "\n            \n      ", "\n        ", "Home", "\n", "Expertise", 
 "Question & Research Design", "\n", "Survey Development & Validation", 
 "\n", "Data Processing", "\n", "Statistical Analysis", "\n", 
 "Publications & Grants", "\n", "Evaluation", "\n", "\n", 
 "Consulting Areas", "Business", "\n", "Education", "K-12", 
 "\n", "Â ", " Â Â  Â  Â", " | ") 
```

预期输出

```
[1] ""                               ""                         ""
[4] ""                               ""                         ""
[7] ""                               "Home"                     ""
[10] "Expertise"                     "Question Research Design" ""
[13] "Survey Development Validation" ""                         "Data Processing"
[16] ""                              "Statistical Analysis"     ""
[19] "Publications Grants"           ""                         "Evaluation"
[22] ""                              ""                         "Consulting Areas"
[25] "Business"                      ""                         "Education"
[28] "K12"                           ""                         ""
[31] ""                              "" 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T01:50:55.537

强烈建议您简单地使用

```
gsub("[^a-zA-Z0-9]","",x) 
```

其中 x 是列表的名称。

您可能在列表末尾包含了外来字符，因为您也希望这些外来字符 - 好吧，上面的命令实现了这一点。简单解释一下，命令中的方括号定义了一个符号集合，而 ^ 符号表示“不是”，所以不在指定的 62 个字符集中的所有内容（小写 a 到 z，大写 A 到 Z，和数字 0 到 9) 将被空字符串 "" 替换（即销毁）。

这是输出...

```
 [1] ""                             ""                        ""
 [4] ""                             ""                        ""
 [7] ""                             "Home"                    ""
[10] "Expertise"                    "QuestionResearchDesign"  ""
[13] "SurveyDevelopmentValidation"  ""                        "DataProcessing"
[16] ""                             "StatisticalAnalysis"     ""
[19] "PublicationsGrants"           ""                        "Evaluation"
[22] ""                             ""                        "ConsultingAreas"
[25] "Business"                     ""                        "Education"
[28] "K12"                          ""                        ""
[31] ""                             "" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T22:37:49.883

我不确定这是否会消除您想要删除的所有内容......但`?regexp`描述了您可以使用的各种有趣的广泛类。对于您所描述的，我认为您想要：

```
 gsub('[[:space:]|[:punct:]]+', '', yourlist) 
```

这使：

```
 [1] ""                            ""                            ""                            ""                           
 [5] ""                            ""                            ""                            "Home"                       
 [9] ""                            "Expertise"                   "QuestionResearchDesign"      ""                           
[13] "SurveyDevelopmentValidation" ""                            "DataProcessing"              ""                           
[17] "StatisticalAnalysis"         ""                            "PublicationsGrants"          ""                           
[21] "Evaluation"                  ""                            ""                            "ConsultingAreas"            
[25] "Business"                    ""                            "Education"                   "K12"                        
[29] ""                            "Â"                           "ÂÂÂÂ"                        "" 
```

# java - 将 EDT 时区转换为 GMT 在 java 中无法正常工作

> ID：11129108
> 
> 赞同：5
> 
> 时间：2012-06-20T22:30:41.430
> 
> 标签：java, timezone

我正在使用此代码来解析此日期。它必须将新日期显示为**“2012-06-20 03:09:38”**，因为 EDT 是 -4GMT 而我当前的位置是 GMT+5。但它没有显示它现在显示它是

```
private static void convertEDT_TO_GMT() {
    try {
        String s = "2012-06-20 18:09:38";
        SimpleDateFormat df = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
        df.setTimeZone(TimeZone.getTimeZone("EDT"));
        Date timestamp = null;

        timestamp = df.parse(s);
        df.setTimeZone(TimeZone.getTimeZone("GMT+05:00"));
        System.out.println("Old = " + s);
        String parsed = df.format(timestamp);
        System.out.println("New = " + parsed);

    } catch (Exception e) {
        e.printStackTrace();
    }
    } 
```

它显示

> 旧 = 2012-06-20 18:09:38
> 
> 新 = 2012-06-20 23:09:38

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-20T23:13:27.493

时区“EDT”不存在。执行`System.out.println()``TimeZone.getTimeZone("EDT") 表明它正在回退到 GMT，因为 Java 不知道 'EDT' 作为时区。

从 更改`"EDT"`为`"GMT-04:00"`给出正确的结果：

```
try {
    String s = "2012-06-20 18:09:38";
    SimpleDateFormat df = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
    //df.setTimeZone(TimeZone.getTimeZone("EDT"));
    df.setTimeZone(TimeZone.getTimeZone("GMT-04:00"));
    Date timestamp = null;

    timestamp = df.parse(s);
    df.setTimeZone(TimeZone.getTimeZone("GMT+05:00"));
    System.out.println("Old = " + s);
    String parsed = df.format(timestamp);
    System.out.println("New = " + parsed);

    } catch (Exception e) {
    e.printStackTrace();
} 
```

结果：

```
Old = 2012-06-20 18:09:38
New = 2012-06-21 03:09:38 
```

根据[这篇文章](https://stackoverflow.com/questions/964894/how-to-convert-time-between-timezones-utc-to-edt)：

> 东部夏令时间不是“完整”时区的名称 - 它是“半”时区，实际上总是比 UTC 晚 4 小时。

所以使用`"GMT-04:00"`可能是正确的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-07-27T07:23:11.883

```
TimeZone.setDefault(TimeZone.getTimeZone("GMT-04:00"));
Date date = new Date();
System.out.println("Current EDT Time is : "+date); 
```

# android - android：从视图开始活动的安全方式

> ID：11129110
> 
> 赞同：1
> 
> 时间：2012-06-20T22:30:43.130
> 
> 标签：android, android-activity, android-view

我已经构建了一个简单的自定义视图并在构造函数中注册了 onClickListener()。要在单击视图实例时启动一个新的 Activity，我只是使用了这样的东西：

```
setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            Intent i = new Intent(getContext(), com.test.myClass.class);
            Context context = getContext();
            i.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);

            context.startActivity(i);
        }
    }); 
```

由于我的知识水平仍然很差，如果这是从 View 开始活动的好方法，我一直在徘徊，如果有一个更好的方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T22:46:52.807

这个实现是非常有效的，但可以通过两件小事来改进：

```
YourView extends View{

  private boolean clicked = false;

  private final View.OnClickListener myOnClickListener = 
  new View.OnClickListener(){
    public void onClick(View v) {
        if (!clicked){
            clicked = true;
            Context context = getContext();
            Intent i = new Intent(context, com.test.myClass.class);
            i.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);

            context.startActivity(i);   
        }
    }
  }

  public View(Context ctx){
    super(ctx);
    setOnClickListener(myOnClickListener);
  }
} 
```

改进如下：如果用户在您的视图上疯狂点击，则可能会`OnClickListener`触发多次，因此会启动多个 Activity。布尔值修复它。你`OnClickListener`也总是一样的，尽管你可以在你的视图中声明一次并且不要多次实例化它们。

注意：您可能需要`clicked`在某个时候设置回 false （`onPause()`持有您的 View 的 Activity 似乎是一个合理的地方）

# ruby - Ubuntu 12.04 中的 Ruby 1.9 SVN 绑定

> ID：11129119
> 
> 赞同：1
> 
> 时间：2012-06-20T22:31:26.487
> 
> 标签：ruby, svn, binding

我需要一些帮助才能让 Ruby SVN 绑定在 Ubuntu 12.04 下工作

我们正在使用：

*   红宝石 1.9.3
*   Ubuntu 12.04
*   SVN 1.6.17

我们没有使用 rvm。

我尝试了一个`apt-get install libsvn-ruby`，但它实际上似乎并没有安装绑定。当我尝试要求 svn/core 时，Ruby 抱怨它不存在。查看包的描述，它说它是一个虚拟包。

我花了很多时间尝试通过查看[http://svn.apache.org/repos/asf/subversion/tags/1.6.17](http://svn.apache.org/repos/asf/subversion/tags/1.6.17)并按照 subversion/bindings/swig/INSTALL 中的说明手动创建绑定，但是当我尝试运行时，我总是会遇到错误`make swig-rb`

我的谷歌搜索都没有返回关于错误的有用信息，或者关于我应该如何让绑定工作的信息。谁能给我一些步骤让 Ruby 1.9 与 SVN 对话？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T15:26:17.057

这是因为 ruby​​ 1.9 没有 ruby​​ 绑定 - 只有 ruby​​ 1.8 的 ruby​​ 绑定。

# asp.net - Facebook Streampublish 和用户详细信息

> ID：11129122
> 
> 赞同：0
> 
> 时间：2012-06-20T22:31:37.793
> 
> 标签：asp.net, facebook

我们有一个网站，用户可以在其中将信息从我们的网站发布到他们的 Facebook 墙上。我正在使用 Facebook graph api 的 streampublish 来完成这项任务。

因此，流程是这样工作的
：用户单击“将此链接发布到 Facebook”按钮
b。如果用户未登录 facebook，则会自动显示登录弹出框。
C。成功登录后，用户会看到“发布到墙上”弹出框。
d。用户将消息发布到墙上。

以上所有工作正常。但是我的要求是，在发布流数据后，我需要根据他们的 facebook 登录来获取用户的电子邮件、名字和姓氏，并将其保存到我们的数据库中。有人对如何获取这些信息有任何建议吗？

该网站使用 Javascript、ASP.Net 和 C# 构建

**编辑：** 感谢您的回复。
我目前正在使用以下语法发布到墙上

FB.ui( { method: 'stream.publish',
message: userMessage1,
attachment: attachment1,
action_links: actionLinks1,
user_message_prompt: messagePrompt1,
target_id: targetId1,
actor_id: actorId1 }, FB响应）；

我可以通过 FBresponse 回调函数获取用户对象的详细信息吗？在我使用 Firebug 的那一刻，响应对象只包含 post_id 属性

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T00:39:37.677

如果您已获得在用户墙上发布的权限，则您应该有一个有效的访问令牌用于该用途。您只需查询 Facebook Graph API`/me`对象即可获取该信息。

# javascript - DIV中的相对鼠标坐标 - javascript

> ID：11129125
> 
> 赞同：0
> 
> 时间：2012-06-20T22:31:51.320
> 
> 标签：javascript

我将鼠标移动到一个 div 上，我想知道鼠标相对于 div 原点的坐标。（左上角）

我希望 mousemove 事件包含鼠标的相对（客户端？）坐标，但显然它没有。

例如，在 Firefox 中，所有事件属性*都不包含相对坐标

我错过了什么吗？

*clientX,Y - pageX,Y - screenX, y

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T22:41:00.053

你没有遗漏任何东西，但你需要自己计算相对坐标。

沿着这些思路应该做的事情（用你想用来获取位置的 w/e 代码替换 jquery）：

```
var pos = $('div').position();
var relX = event.pageX - pos.left;
var relY = event.pageY - pos.top; 
```

另请参阅：[JS：鼠标相对于元素的坐标，](https://stackoverflow.com/questions/1815103/js-mouse-coordinates-relative-to-an-element)其中涵盖了有关支持其他浏览器的一些细节（尽管如果您使用的是可能不需要的 jquery）。

# itextsharp - iTextSharp 签名图像未显示在 PDF 签名字段中

> ID：11129128
> 
> 赞同：0
> 
> 时间：2012-06-20T22:32:09.827
> 
> 标签：itextsharp, itext

一天中的大部分时间我都在研究这个问题。我有一个使用 iTextSharp 签署 PDF 文档的现有应用程序。数字签名存在并且文本表示显示在 PDF 的签名字段中，但签名的图像不显示。

以下是有问题的代码。感谢您提供的任何帮助/建议。

```
if (signatureBitmap != null)
{
    if (reader == null) reader = new PdfReader(PDFByteArray);

    pdfStamper = PdfStamper.CreateSignature(reader, outputStream, PDFVersion, null, true);

    PdfSignatureAppearance signatureAppearance = pdfStamper.SignatureAppearance;

    //Add digital certificate to field
    signatureAppearance.SetCrypto(Key, Certificate, null, PdfSignatureAppearance.SELF_SIGNED);
    signatureAppearance.Reason = Reason;
    signatureAppearance.Location = Location;

    signatureAppearance.Render = PdfSignatureAppearance.SignatureRender.GraphicAndDescription;

    if (signatureBitmap != null)
    {
        iTextSharp.text.Image signatureFieldImage = iTextSharp.text.Image.GetInstance(signatureBitmap, System.Drawing.Imaging.ImageFormat.Bmp);
        signatureAppearance.SignatureGraphic = signatureFieldImage;
    }

    signatureAppearance.Acro6Layers = acroLayer;
    signatureAppearance.SetVisibleSignature(acrobatSignatureFieldName);
    pdfStamper.Close();
    reader.Close();
    reader = null;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-13T19:24:20.997

you need the position about your signature, try with this:

```
Rectangle rSignature= new Rectangle(100,100);
signatureAppearance.setVisibleSignature(rSignature, 1, "a name"); 
```

# entity-framework - 管理 EntityFramework 和 EnterpriseLibrary 的 DatabaseFactory 之间的事务

> ID：11129134
> 
> 赞同：0
> 
> 时间：2012-06-20T22:32:29.090
> 
> 标签：entity-framework, transactions, enterprise-library, transactionscope

我正在使用一组现有的代码来管理单个事务中的多个数据库更新。这是一个简化的示例：

```
Database db = DatabaseFactory.CreateDatabase();
using (DbConnection dbConnection = db.CreateConnection())
{
    dbConnection.Open();
    DbTransaction dbTransaction = dbConnection.BeginTransaction();
    try
    {
        //do work
        dbTransaction.Commit();
    }
    catch (Exception ex)
    {
        dbTransaction.Rollback();
    }
} 
```

我也在同一个项目中使用 EntityFramework 进行新开发。下面是使用我的存储库类的简化示例：

```
List<ThingViewModel> things = new List<ThingViewModel>();
// populate list of things
IObjectRepository thingRepository = new ThingRepository();
thingRepository.AddThings(things);
thingRepository.Save(); 
```

**我希望在“AddThings”中完成的工作作为第一个代码块中事务的一部分发生。**

是否有一些干净的方法可以将我的存储库模式混合到现有代码中，反之亦然？我还没有到可以将现有代码重写为完全在 EntityFramework 中的地步，所以我正在寻找一些临时方法。

我尝试将事务从旧代码传递到存储库，从而传递到 EntityFramework，但这似乎不起作用。我还尝试将 ObjectContext 传递回旧代码，以便将其加入事务中。这两种方法都不起作用。

我不敢相信我是第一个在将现有代码迁移到 EntityFramework 时遇到这个障碍的人......一定有一些我没有考虑的事情。

我将在下面列出我尝试过的事情：

```
using (TransactionScope transactionScope = new TransactionScope())
{   
    Database db = DatabaseFactory.CreateDatabase();
    using (DbConnection dbConnection = db.CreateConnection())
    {
        dbConnection.Open();
        DbTransaction dbTransaction = dbConnection.BeginTransaction();
        try
        {
            //do work
            dbTransaction.Commit();
        }
        catch (Exception ex)
        {
            dbTransaction.Rollback();
        }
    }

    Thing thing = new Thing(){
        Prop1 = Val1,
        Prop2 = Val2
    };
    ThingObjectContext context = new ThingObjectContext();
    context.Things.AddObject(thing);
    context.SaveChanges();
    transactionScope.Complete();
} 
```

最后一个示例“有效”，它不能用作事务。当 EF 插入失败时，TransactionScope 不会回滚 EL 命令。如果我不对 .Commit() 和 .SaveChanges() 进行这些显式调用，则什么也不会发生。如果可能的话，我真的希望它能够共享相同的连接。我目前正在使用的另外两个变体是尝试在 EF 和 EL 之间使用相同的连接，以及在一侧或另一侧使用 EnlistTransaction。绝对试图阻止它成为 MSDTC - 不希望与此相关的额外开销。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:36:40.437

使用 TransactionScope 而不是显式事务管理。您将简化整个代码，并且您所做的一切都应该自动检测和使用相同的事务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T00:00:07.390

有什么方法可以调用`Database.GetOpenConnection()`而不是`CreateConnection()`在你的 EL 代码中调用，并传入`things.Connection`你在块内创建的`TransactionScope`？我没有对此进行测试，但这是我首先要尝试的。

# authentication - 针对 keystone 的正确身份验证方法 (openstack)

> ID：11129137
> 
> 赞同：0
> 
> 时间：2012-06-20T22:32:43.987
> 
> 标签：authentication, openstack

我应该直接查询 API 还是依赖从 keystone 客户端导入方法？

想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T17:40:59.543

这取决于您对如何与 keystone 交互的要求。

如果您直接查询 API，那么您可能在 bash 脚本或命令行中使用 curl。如果您正在使用来自主干的前沿 keystone API 代码，而该代码甚至在 keystone 客户端中还没有方法，这将特别有用。

如果您从 keystone 客户端导入方法，您可能正在编写 Python 脚本或应用程序。如果您正在使用来自稳定分支或包的稳定 keystone 代码，这是更好的选择。与原始 HTTP 请求相比，keystone 客户端更易于使用。

高温高压

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T13:13:50.753

使用 keystone 客户端方法更容易。python-keystoneclient 包在 doc 目录中有关于如何执行此操作的文档。例如，请参阅[客户端 API](https://github.com/openstack/python-keystoneclient/blob/master/doc/source/using-api.rst)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T23:37:56.517

我最终使用 python-keystoneclient 绑定进行初始身份验证，但对于 keystoneclient API 范围之外的任何查询，我只是引用了 auth_token 并调用了针对 keystone ec2 url 的直接 API 查询请求，其中带有标头中的令牌。

这工作得很好。Keystone 需要工作。

# c - 在c中读/写bmp文件

> ID：11129138
> 
> 赞同：9
> 
> 时间：2012-06-20T22:32:47.703
> 
> 标签：c, bitmap

我正在尝试处理 bmp 文件。首先，我尝试从 bmp 文件中读取标题和数据并将其写入新文件：

```
#pragma pack(push,1)
/* Windows 3.x bitmap file header */
typedef struct {
    char         filetype[2];   /* magic - always 'B' 'M' */
    unsigned int filesize;
    short        reserved1;
    short        reserved2;
    unsigned int dataoffset;    /* offset in bytes to actual bitmap data */
} file_header;

/* Windows 3.x bitmap full header, including file header */
typedef struct {
    file_header  fileheader;
    unsigned int headersize;
    int          width;
    int          height;
    short        planes;
    short        bitsperpixel;  /* we only support the value 24 here */
    unsigned int compression;   /* we do not support compression */
    unsigned int bitmapsize;
    int          horizontalres;
    int          verticalres;
    unsigned int numcolors;
    unsigned int importantcolors;
} bitmap_header;
#pragma pack(pop)

int foo(char* input, char *output) {

    //variable dec:
    FILE *fp,*out;
    bitmap_header* hp;
    int n;
    char *data;

    //Open input file:
    fp = fopen(input, "r");
    if(fp==NULL){
        //cleanup
    }

    //Read the input file headers:
    hp=(bitmap_header*)malloc(sizeof(bitmap_header));
    if(hp==NULL)
        return 3;

    n=fread(hp, sizeof(bitmap_header), 1, fp);
    if(n<1){
        //cleanup
    }

    //Read the data of the image:
    data = (char*)malloc(sizeof(char)*hp->bitmapsize);
    if(data==NULL){
        //cleanup
    }

    fseek(fp,sizeof(char)*hp->fileheader.dataoffset,SEEK_SET);
    n=fread(data,sizeof(char),hp->bitmapsize, fp);
    if(n<1){
        //cleanup
    }

        //Open output file:
    out = fopen(output, "w");
    if(out==NULL){
        //cleanup
    }

    n=fwrite(hp,sizeof(char),sizeof(bitmap_header),out);
    if(n<1){
        //cleanup
    }
    fseek(out,sizeof(char)*hp->fileheader.dataoffset,SEEK_SET);
    n=fwrite(data,sizeof(char),hp->bitmapsize,out);
    if(n<1){
        //cleanup
    }

    fclose(fp);
    fclose(out);
    free(hp);
    free(data);
    return 0;
} 
```

这是输入文件： ![在此处输入图像描述](../Images/cc6a5451ca80d5ee1e22482ca84f5095.png)

这是输出： ![在此处输入图像描述](../Images/a830a71a907d8ba881ce5a82a0dc9093.png)

它们的大小相同，并且似乎具有相同的标题。有什么问题？谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-20T22:39:52.903

我猜你应该以二进制模式打开文件。

# c++ - 在非 pod 结构上使用 operator new + Initializer 列表

> ID：11129145
> 
> 赞同：1
> 
> 时间：2012-06-20T22:33:15.720
> 
> 标签：c++, c++11, new-operator, initializer-list

我正在尝试在堆上分配包含非 pod 成员的结构并使用初始化列表初始化它们。但是，编译器在我的代码中遇到了错误。这个片段重现了它：

```
#include <vector>

struct A {
    int a;
};

struct B {
    int a;
    std::vector<int> b;
};

int main() {
    std::vector<int> some_vec;
    A a = {1}; // OK
    A b = A{1}; // OK
    A *c = new A{1}; // OK(leaks, NP)
    B d = {1, some_vec}; // OK
    B e = B{1, some_vec}; // OK

    B *f = new B{1, some_vec}; // Fails to compile

    B *g = new B({1, some_vec}); // OK
} 
```

（我知道泄漏，我知道，这只是一个测试片段）

指出的行在 GCC 4.6.3 上无法编译，出现以下错误：

```
test.cpp: In function ‘int main()’:
test.cpp:19:29: error: no matching function for call to ‘B::B(<brace-enclosed initializer list>)’
test.cpp:19:29: note: candidates are:
test.cpp:7:8: note: B::B()
test.cpp:7:8: note:   candidate expects 0 arguments, 2 provided
test.cpp:7:8: note: B::B(const B&)
test.cpp:7:8: note:   candidate expects 1 argument, 2 provided
test.cpp:7:8: note: B::B(B&&)
test.cpp:7:8: note:   candidate expects 1 argument, 2 provided 
```

显然编译器无法使用提供的初始化列表初始化我的结构。奇怪的是，产生错误的那一行之后的下一行（据我所知）只是`B`从使用相同初始化列表构造的另一行复制（可能移动）a，不会产生任何错误。

我做错了什么吗？我的意思是，我可以使用提供的代码段中的最后一行，但是有什么理由不能只使用 operator new 和初始化列表来创建结构吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T23:13:33.917

代码应该可以编译和工作。我用 gcc 4.7.0 对其进行了测试，它工作正常，所以似乎已经修复了这个错误。如果您阅读标准中的 8.5.4 列表初始化，他们会说`List intialization can be used as the initializer in a new expression (5.3.4)`.

# javascript - 如何使用 jquery 只选择一个复选框？

> ID：11129146
> 
> 赞同：1
> 
> 时间：2012-06-20T22:33:16.743
> 
> 标签：javascript, jquery, asp.net, webforms

我在 asp.net gridview 中使用复选框。我想一次只选择一个复选框。如果我选择一个复选框，则应取消选择其他复选框。

我有 html 视图源

```
<input id="ctl00_MainContent_mGrid_ob_mGridBodyContainer_ctl02_ctl02_ctl00_ChkID" type="checkbox" 
<input id="ctl00_MainContent_mGrid_ob_mGridBodyContainer_ctl03_ctl02_ctl00_ChkID" type="checkbox" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T22:36:10.527

使用单选按钮而不是复选框。

```
<form>
    <input type="radio" name="parents" value="Mom" /> Mom<br />
    <input type="radio" name="parents" value="Dad" /> Dad
</form> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-20T22:40:23.117

通常单选按钮用于独占功能，其中仅选择组中的一个项目，并且浏览器将使用正确的 HTML 自动为您执行此操作。

对于复选框，您可以使用 jQuery 对其进行编码，如下所示：

```
<div class="checkboxContainer">
    <input id="ctl00_MainContent_mGrid_ob_mGridBodyContainer_ctl02_ctl02_ctl00_ChkID" type="checkbox"> Item 1<br>
    <input id="ctl00_MainContent_mGrid_ob_mGridBodyContainer_ctl03_ctl02_ctl00_ChkID" type="checkbox"> Item 2<br>
    <input id="ctl00_MainContent_mGrid_ob_mGridBodyContainer_ctl04_ctl02_ctl00_ChkID" type="checkbox"> Item 3
</div>​

$("input[type='checkbox']").change(function() {
    $(this).closest(".checkboxContainer").find("input[type='checkbox']").not(this).prop("checked", false);
    $(this).prop("checked", true);
}); 
```

​ 工作演示：http: [//jsfiddle.net/jfriend00/hWEXx/](http://jsfiddle.net/jfriend00/hWEXx/)

这是执行专有单选按钮的纯 HTML 方式（也在同一个演示中）：

```
<div class="radioGroup">
    <input type="radio" name="group1">Item A<br>
    <input type="radio" name="group1">Item B<br>
    <input type="radio" name="group1">Item C<br>
</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T08:51:05.443

在 asp.net 中，您应该使用单选按钮而不是复选框（在这种情况下）

```
<div class="group">
   <asp:RadioButton Id="radio1" runat="server" GroupName="radioGroup" />
   <asp:RadioButton Id="radio2" runat="server" GroupName="radioGroup" />
</div> 
```

`GroupName`属性使您需要此功能。（如果radio1是`Checked`radio2自动取消选中。希望这有帮助：）

# c++ - OpenScenegraph 示例代码问题

> ID：11129148
> 
> 赞同：2
> 
> 时间：2012-06-20T22:33:24.543
> 
> 标签：c++, visual-studio, 3d, openscenegraph

下面的代码来自一本书。当我尝试运行它时，它失败了

osg::ref_ptr geom = new osg::Geometry();

而且，输出窗口似乎没有包含太多关于它为什么崩溃的信息，只是告诉我它确实发生了。知道我在下面的代码中可能做错了什么吗？提前致谢。

这是我尝试在 Visual Studio 2010（windows 7 64）中运行时出现的 windows 错误弹出窗口

**Windows 已在 OSGPracticeLab.exe 中触发断点。这可能是由于堆损坏，这表明 OSGPracticeLab.exe 或其已加载的任何 DLL 中存在错误。这也可能是由于用户在 OSGPracticeLab.exe 获得焦点时按 F12。输出窗口可能有更多诊断信息。**

在尝试调试代码时，我能够将问题追溯到新的函数调用。在下面的代码中，似乎跳过了 while 循环，并且为 p(没有分配内存，因此我的 Geometry 对象在下面的代码中返回了一个空值，没有实例化。

```
void *__CRTDECL operator new(size_t size) _THROW1(_STD bad_alloc)
        {       // try to allocate size bytes
        void *p;
        while ((p = malloc(size)) == 0)
                if (_callnewh(size) == 0)
                {       // report no memory
                static const std::bad_alloc nomem;
                _RAISE(nomem);
                }

        return (p);
        } 
```

下面是我绘制一些形状和显示的程序。

```
#include <osg/ShapeDrawable>
#include <osg/Geode>
#include <osgViewer/Viewer> 

int main()
{
    //An octahedron is a polyhedron having eight triangle faces. 
    //It is really a nice example to show why primitive indexing is important
    // we will sketch the octahedron structure now 

    osg::ref_ptr<osg::Vec3Array> vertices = new osg::Vec3Array(6);
    //octahedron has six vertices, each shaed by four triangles.  
    //withe the help of an index array and the osg::DrawElementsUInt class, we can allocate
    //a vertex array with only six elements
    (*vertices)[0].set( 0.0f, 0.0f, 1.0f);
    (*vertices)[1].set(-0.5f,-0.5f, 0.0f);
    (*vertices)[2].set( 0.5f,-0.5f, 0.0f);
    (*vertices)[3].set( 0.5f, 0.5f, 0.0f);
    (*vertices)[4].set(-0.5f, 0.5f, 0.0f);
    (*vertices)[5].set( 0.0f, 0.0f,-1.0f);
    //The osg::DrawElementsUInt accepts a size parameter besides the drawing mode parameter, too. 
    //After that, we will specify the indices of vertices to describe all eight triangle faces.
    osg::ref_ptr<osg::DrawElementsUInt> indices = new osg::DrawElementsUInt(GL_TRIANGLES, 24);
    (*indices)[0] = 0; (*indices)[1] = 1; (*indices)[2] = 2;
    (*indices)[3] = 0; (*indices)[4] = 2; (*indices)[5] = 3;
    (*indices)[6] = 0; (*indices)[7] = 3; (*indices)[8] = 4;
    (*indices)[9] = 0; (*indices)[10]= 4; (*indices)[11]= 1;
    (*indices)[12]= 5; (*indices)[13]= 2; (*indices)[14]= 1;
    (*indices)[15]= 5; (*indices)[16]= 3; (*indices)[17]= 2;
    (*indices)[18]= 5; (*indices)[19]= 4; (*indices)[20]= 3;
    (*indices)[21]= 5; (*indices)[22]= 1; (*indices)[23]= 4;

    //To create a geometry with a default white color, we only set the vertex array 
    //and the osg::DrawElementsUInt primitive set. The normal array is also required but is not easy
    //to compute manually. We will use a smoothed normal calculator to automatically obtain it. This calculator
    //will be described in the next section, Using polygonal techniques.
    osg::ref_ptr<osg::Geometry> geom = new osg::Geometry();
    geom->setVertexArray( vertices.get() );
    geom->addPrimitiveSet( indices.get() );
    //osgUtil::SmoothingVisitor::smooth( *geom );
    //Add the geometry to an osg::Geode object and make it the scene root
    osg::ref_ptr<osg::Geode> root = new osg::Geode;
    root->addDrawable( geom.get() );
    osgViewer::Viewer viewer;
    viewer.setSceneData( root.get() );
    return viewer.run();
}

int drawShapeUsingVertices()
{
    //Create the vertex array and push the four corner points to the back of the array by using vector like operations:
    osg::ref_ptr<osg::Vec3Array> vertices = new osg::Vec3Array;
    vertices->push_back( osg::Vec3(0.0f, 0.0f, 0.0f) );
    vertices->push_back( osg::Vec3(1.0f, 0.0f, 0.0f) );
    vertices->push_back( osg::Vec3(1.0f, 0.0f, 1.0f) );
    vertices->push_back( osg::Vec3(0.0f, 0.0f, 1.0f) );
    //We have to indicate the normal of each vertex; otherwise OpenGL will use a default (0, 0, 1) normal vector
    //and the lighting equation calculation may be incorrect. The four vertices actually face the same direction,
    //so a single normal vector is enough. We will also set the setNormalBinding() method to BIND_OVERALL later.
    osg::ref_ptr<osg::Vec3Array> normals = new osg::Vec3Array; 
    normals->push_back( osg::Vec3(0.0f,-1.0f, 0.0f) );
    osg::ref_ptr<osg::Vec4Array> colors = new osg::Vec4Array;
    //here We will indicate a unique color value to each vertex and make them colored. By default, 
    //OpenGL will use smooth coloring and blend colors at each vertex together:
    colors->push_back( osg::Vec4(1.0f, 0.0f, 0.0f, 1.0f) );
    colors->push_back( osg::Vec4(0.0f, 1.0f, 0.0f, 1.0f) );
    colors->push_back( osg::Vec4(0.0f, 0.0f, 1.0f, 1.0f) );
    colors->push_back( osg::Vec4(1.0f, 1.0f, 1.0f, 1.0f) );
    //Next, we create the osg::Geometry object and set the prepared vertex, normal, and color arrays to it. 
    //We also indicate that the single normal should be bound to the entire geometry and that the colors
    //should be bound per vertex:
    osg::ref_ptr<osg::Geometry> quad = new osg::Geometry;
    quad->setVertexArray( vertices.get() );
    quad->setNormalArray( normals.get() );
    quad->setNormalBinding( osg::Geometry::BIND_OVERALL );
    quad->setColorArray( colors.get() );
    quad->setColorBinding( osg::Geometry::BIND_PER_VERTEX );

    //The last step required to finish a geometry and add it to the scene graph is to specify the primitive set.
    //A newly allocated osg::DrawArrays instance with the drawing mode set to GL_QUADS is used here, in order to
    //render the four vertices as quad corners in a counter-clockwise order:
    quad->addPrimitiveSet( new osg::DrawArrays(GL_QUADS, 0, 4) );
    //Add the geometry to an osg::Geode object and render it in the scene viewer:
    osg::ref_ptr<osg::Geode> root = new osg::Geode;
    root->addDrawable( quad.get() );
    osgViewer::Viewer viewer;
    viewer.setSceneData( root.get() );
    return viewer.run();
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T05:47:36.987

我的代码没有任何问题。从初学者指南中获取它，它工作正常：

```
#include <osg/Geometry>
#include <osg/Geode>
#include <osgViewer/Viewer>

int main()
{
    osg::ref_ptr<osg::Vec3Array> vertices = new osg::Vec3Array;
    vertices->push_back( osg::Vec3(0.0f, 0.0f, 0.0f) );
    vertices->push_back( osg::Vec3(1.0f, 0.0f, 0.0f) );
    vertices->push_back( osg::Vec3(1.0f, 0.0f, 1.0f) );
    vertices->push_back( osg::Vec3(0.0f, 0.0f, 1.0f) );

    osg::ref_ptr<osg::Vec3Array> normals = new osg::Vec3Array;
    normals->push_back( osg::Vec3(0.0f,-1.0f, 0.0f) );

    osg::ref_ptr<osg::Vec4Array> colors = new osg::Vec4Array;
    colors->push_back( osg::Vec4(1.0f, 0.0f, 0.0f, 1.0f) );
    colors->push_back( osg::Vec4(0.0f, 1.0f, 0.0f, 1.0f) );
    colors->push_back( osg::Vec4(0.0f, 0.0f, 1.0f, 1.0f) );
    colors->push_back( osg::Vec4(1.0f, 1.0f, 1.0f, 1.0f) );

    osg::ref_ptr<osg::Geometry> quad = new osg::Geometry;
    quad->setVertexArray( vertices.get() );
    quad->setNormalArray( normals.get() );
    quad->setNormalBinding( osg::Geometry::BIND_OVERALL );
    quad->setColorArray( colors.get() );
    quad->setColorBinding( osg::Geometry::BIND_PER_VERTEX );

    quad->addPrimitiveSet( new osg::DrawArrays(GL_QUADS, 0, 4) );

    osg::ref_ptr<osg::Geode> root = new osg::Geode;
    root->addDrawable( quad.get() );
    osgViewer::Viewer viewer;
    viewer.setSceneData( root.get() );
    return viewer.run();
} 
```

我建议您检查您的项目属性。

你是否包含了额外的包含目录：`$(OSG_ROOT)\include;$(OSG_SOURCE)\include;$(OSG_ROOT)\include\osg;`
如果你处于调试模式，你的预处理器定义中有这个吗？`_DEBUG;WIN32;`
您是否指定了链接器附加目录：`$(OSG_ROOT)\lib`
您是否指定了链接器附加依赖项？：`osgWidgetd.lib;osgVolumed.lib;osgViewerd.lib;osgUtild.lib;osgTextd.lib;osgTerraind.lib;osgSimd.lib;osgShadowd.lib;osgPresentationd.lib;osgParticled.lib;osgManipulatord.lib;osgGAd.lib;osgFXd.lib;osgDBd.lib;osgd.lib;osgAnimationd.lib;OpenThreadsd.lib;;;;;;kernel32.lib;user32.lib;gdi32.lib;winspool.lib;comdlg32.lib;advapi32.lib;shell32.lib;ole32.lib;oleaut32.lib;uuid.lib;odbc32.lib;odbccp32.lib;%(AdditionalDependencies)`
您是否将配置属性>调试>工作目录指定为：`$(OSG_ROOT)\bin`

如果是极端情况，可能是因为您的 Visual Studio 安装已损坏。尝试重新安装 Visual Studio，如果 OSG 安装已损坏，则重新安装 OSG（从源代码构建）。提到这一点是因为我的一个朋友在运行 OSG 时遇到了问题，因为他的 Visual Studio 已损坏。重新安装修复它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T17:16:38.760

osg 是否构建？您是否从 OSG 中运行“安装”项目？即使你这样做了，权限也可能在 Win7 中被破坏——你可能必须手动安装到 Program Files。

您在上面发布的示例在 Win7 / VS 2008 / Win32-Release 构建配置上为我完美编译，针对 OSG 版本 3.1.0 构建。我刚刚用您在上面粘贴的代码替换了 OSG 解决方案中的示例项目之一的 main，它构建和运行时没有您列出的错误。

我正在使用主干中的 OSG - 可能至少是任何预构建之前的次要版本，但如果您的路径等设置正确，它应该可以从预构建中工作。当然，您也可以尝试从作者下载的示例开始：[http](http://www.skew-matrix.com/OSGQSG/) ://www.skew-matrix.com/OSGQSG/ - 他们已经正确设置了项目文件等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T22:37:05.097

您没有`osg::Geometry`在代码中定义类，因此最可能的问题是您没有正确链接到定义它的对象或*库*。

# javascript - GPL 许可证如何限制商业 Web 应用程序？

> ID：11129153
> 
> 赞同：2
> 
> 时间：2012-06-20T22:33:50.480
> 
> 标签：javascript, html, css, client-side, gpl

我注意到 ExtJS 将其许可证从 LGPL 更改为 GPLv3 的决定引起了很多[争议](http://hostilefork.com/2009/06/15/extjs-licensing-fiasco/)。我的问题不是关于 ExtJS，而是关于 GPL 许可证如何影响 Web 应用程序。

为什么人们如此关注保持客户端源代码的关闭？不是所有的客户端 Web 应用程序都是开源的吗？我的意思是，如果您使用 HTML/CSS/JS，您将发布客户端的源代码。**这难道不是 ExtJS 的 GPL 要求你做的吗？**最后我检查了一下，无论如何都没有办法关闭源代码 HTML/CSS/JS。

看看像 GWT 这样的代码生成技术，我假设您必须开源由 GWT 生成的 HTML/CSS/JS，而不是用于生成它的原始 Java 代码。那是对的吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-20T22:38:05.220

您将源代码可用性和开源混为一谈。是的，每个站点都必须使其 HTML 和 JavaScript 可供下载。然而，开源远不止于此。它需要授予自由的特定许可证，包括：

1.  修改权
2.  重新分配的权利
3.  出售权

请参阅[开源定义](http://www.opensource.org/osd.html)。

GPL 就是这样一种许可证。重要的是，它也是一个强大的[copyleft](http://en.wikipedia.org/wiki/Copyleft)。并非所有的开源许可证都是 copyleft。通常，如果您的代码源自强大的 Copyleft 代码，并且您分发它，您必须在相同的许可下分发您自己的源代码。

LGPL 许可证是一个弱版权。这通常意味着您只需要将更改分发到库，而不是您的应用程序代码。

特别是对于 ExtJS，他们做出改变的原因是他们追求的是[双重许可](http://en.wikipedia.org/wiki/Dual_licensing)商业模式。请注意，对于开源项目，它们也有[某些例外](http://www.sencha.com/products/extjs/license/)（这是因为并非所有开源许可证都与 GPL 兼容）。基本上，开源应用程序可以免费免费使用它，没有太多问题。

但是，专有应用程序必须购买 ExtJS 专有许可证之一。

顺便说一句，Ext JS 显然在此之前就有一段混乱的[许可历史](http://en.wikipedia.org/wiki/Extjs#License_history)（例如 LGPL 与自定义附加程序）。

伊纳尔。廷拉。

# git - 如何在 Git 中设置 3 级分支？

> ID：11129158
> 
> 赞同：0
> 
> 时间：2012-06-20T22:34:10.603
> 
> 标签：git, version-control, branch

我对 Git 有点陌生。所以我在我的远程服务器上有了 origin/master 和 origin/upbranch。我的本地机器上也有一个主分支。我该如何设置它以便我可以从本地机器推送到原点/上分支？另外，我将如何设置从 origin/upbranch 拉入 origin/master？我可以通过静态地址访问远程服务器，但没有从远程访问本地的地址。

此外，您会为学习 Git 的人推荐任何参考资料吗？

**编辑：**将 origin/upstream 重命名为 origin/upbranch，因为我可能误解了它的含义。

master（本地）-> origin/upbranch（远程）-> origin/master（远程）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T22:58:26.333

如果您正在创建一个新分支，请跟踪它，它将自动设置。

```
git branch --track branch1 origin/branch1 
```

如果要更改现有分支的跟踪，则需要修改 .git/config 文件

例子

```
[remote "origin"]
        fetch = +refs/heads/*:refs/remotes/origin/*
        url = git://github.com/canuckistani/dotjs-addon.git
[branch "master"]
        remote = origin
        merge = refs/heads/master 
```

如果您不习惯编辑配置文件，您可以按照下面评论中的建议尝试，即

```
git branch --set-upstream branch_name your_new_remote/branch_name 
```

同样，您可以设置其他遥控器，例如上游等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T01:02:26.303

在这种情况下，上游是一个分支吗？它确实看起来像。我相信分支名称真的会让人感到困惑。

但要回答一些问题：

假设你有`master -> origin/master`和`upstream -> origin/upstream`。看起来您已经让本地分支机构跟踪远程分支机构。

> **我该如何设置它以便我可以从本地机器推送到源/上游？**

*切换到上游分支*

```
 > git checkout upstream 
 ... awesome changes 
 > git commit -a -m "Did something awesome." 
 > git push origin upstream 
```

您使用结帐切换到本地跟踪的上游分支。做一些改变。提交它们，它们将它们推回原点。

> **另外，我将如何设置从源/上游拉入源/主？**

你不直接这样做。您必须在本地合并然后推送。

```
> git checkout upstream
> git pull origin upstream
> git checkout master
> git merge --no-ff upstream
> git commit -a -m "Merged upstream into master."
> git push origin master 
```

将本地分支更改为上游。从远程分支中提取任何更改。如果存在合并问题，您必须先修复 + 提交，然后再切换回 master。切换到 master 分支并将上游的更改合并到 master 中。我关闭了快速转发，以便它创建一个新的合并提交，而不是仅仅移动 master 的指针。

提交合并，然后将其推送回远程服务器。

*困惑*

如果上游应该是另一个远程位置，例如起源，那么我不确切知道您要做什么，因为您将上游列为起源/上游。

据我所知，上游的名称将用于命名另一个远程位置。在这种情况下，来源将类似于上游。不掌握上游。但我仍然假设您创建了 2 个分支，一个称为 master（默认创建），一个称为 upstream，您希望在它们中工作并将上游合并到 master。

# llvm - llvm 中的自动矢量化

> ID：11129159
> 
> 赞同：6
> 
> 时间：2012-06-20T22:34:14.830
> 
> 标签：llvm, clang

我正在尝试使用 clang-3.2 创建自动矢量化代码

从这里的幻灯片 - [http://llvm.org/devmtg/2012-04-12/Slides/Hal_Finkel.pdf](http://llvm.org/devmtg/2012-04-12/Slides/Hal_Finkel.pdf)

我应该能够使用此命令行生成矢量化代码。

```
bin/clang++ -c -O3 -mllvm -vectorize -bb-vectorize-aligned-only clang-auto-vec.cpp 
```

但它会抛出一个错误错误：`unsupported option '-b b-vectorize-aligned-only'`

如果我只删除`-bb-vectorize-aligned-only`，它不会创建任何矢量化代码。

这里出了什么问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-21T15:26:02.057

预先`-mllvm`添加到每个标志。例如`-mllvm -vectorize -mllvm -bb-vectorize-aligned-only`

# internationalization - 组织 i18n 资源键的最佳方式是什么？

> ID：11129163
> 
> 赞同：4
> 
> 时间：2012-06-20T22:34:31.877
> 
> 标签：internationalization

哪个最好，按组件组织 i18n 资源键？

```
FILE_TAB_TITLE:    'Files'
FILE_FIELD_TITLE:  'File'
GROUP_TAB_TITLE:   'Group'
GROUP_FIELD_TITLE: 'Group'
SAVE_MENU_ITEM:    'Save'
SAVE_AS_MENU_ITEM: 'Save as...'
SAVE_BUTTON:       'Save' 
```

或者他们的意思是什么？

```
FILE:    'File'
FILES:   'Files'
GROUP:   'Group'
SAVE:    'Save'
SAVE_AS: 'Save as...' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-24T13:58:27.497

我使用英文短语的简洁大写版本。例如（JavaScript）：

```
SAVE: "Save",
LOAD: "Load",
PLEASE_SELECT_ITEM: "Please select an item.",
PRESS_NEXT_TO_PROCEED: "Please press the Next button to proceed." 
```

这样，开发人员不必查找令牌的内容来理解它的实际含义。

对于出现在不同位置的项目（例如，菜单中出现的“保存”与按钮上的“保存”等），我没有多余的条目，除非它们出现在可能单独翻译的不同模块中。

此外，标题/说明、提示和错误消息标记被组织到不同的文件中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-24T13:50:32.260

我认为这是一个约定而不是规则，所以答案可能是“任何看起来更合乎逻辑的东西”。

我已经开始创建我的 i18n 资源密钥，并且我采用了以下约定：

1.  带有“标题部分”的标题，以 # 开头
2.  点分隔的层次符号
3.  按键按字母顺序排列，便于访问

例子：

```
#File access
file.field.title = File
file.field.subtitle = Click here
file.tab.title = Files

#User
user.name = First and last name
user.password = Password
user.username = Username 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-19T22:47:37.883

我在层次结构中按功能排列我的，例如

```
ui:
  choose: choose...
  save: save
  cancel: cancel
  preview: preview

season:
  summer: summer
  autumn: autumn
  winter: winter
  spring: spring

people: !!pl
  0: no people
  1: one person
  n: "%1 people"

is_are_people: !!pl
  0: are no people
  1: is one person
  n: "are %1 people" 
```

然后在我的助手、路线或 haml 文件（我主要使用 Sinatra）中，我可以`Unicode::capitalize(t.ui.save)`在我的“保存”按钮和`"There #{t.is_are_people some_people.count}."`标题等中引用。

# ruby-on-rails - 如何显示下拉列表选项/选择菜单

> ID：11129166
> 
> 赞同：0
> 
> 时间：2012-06-20T22:34:42.530
> 
> 标签：ruby-on-rails, ruby-on-rails-3, forms

我已经为此工作了几个小时并且卡住了，那么如何使用数据库获得菜单选择，使用模型的数据库`ZigZagRotation`？

```
<%= form_for([@user, @user.calories_journals.build]) do |f| %>
  <%= render 'shared/error_messages', object: f.object %>
  <%= f.label :cj_date, "Date Begins:" %>
  <%= f.text_field :cj_date %>
  <%= f.label :no_of_cycles, "Number of Cycles:" %>
  <%= f.text_field :no_of_cycles %>      
  <%= f.label :zig_zag_type, "Zig Zag Rotation Type:" %>
  <%= f.select :zig_zag_type, ZigZagRotation.all.collect {|z| [z.title, z.id ] } %> 
  <%= f.submit "Generate Calories Journals", class: "btn btn-large btn-primary" %>
<% end %> 
```

下面的行在菜单选择框中显示了空的详细信息，而不是填充列表。

```
<%= f.select :zig_zag_type, ZigZagRotation.all.collect {|z| [z.title, z.id ] } %> 
```

`:zig_zag_type`在模型`attr_accessible`下`ZigZagRotation`，一旦被选中，我希望将值存储在`:id`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T22:40:13.683

我假设您正在使用两个不同且相关的模型（`ZigZagRotation`例如`AnotherModel`）。

如果要显示`zig_zag_type`属性并将其保存`id`在外`AnotherModel`键中（`zig_zag_id`例如），创建它们之间的关系，您可以执行以下操作：

```
<%= f.collection_select(:zig_zag_id, ZigZagRotation.all, :id, :zig_zag_type , {:include_blank => 'Select Type'} ) %> 
```

[您可以在此处](http://api.rubyonrails.org/classes/ActionView/Helpers/FormOptionsHelper.html#method-i-collection_select)找到更多信息。
我希望它有帮助...

# c++ - 为什么类 .setTexure() 方法的行为不同？

> ID：11129167
> 
> 赞同：2
> 
> 时间：2012-06-20T22:35:13.100
> 
> 标签：c++, iterator, sprite, textures, sfml

sfml sprite 类 .setTexure() 方法在迭代器的构造函数中不起作用，但在迭代器已经生成时起作用

我们正在尝试为正在绘制到窗口上的框架构建结构。我们正在使用 sfml 库，以及它们的精灵和纹理类。在 frameData 结构的构造函数中，我们从文件加载纹理，然后使用 .setTexture() 方法将其应用于精灵。当我们编译和运行我们的程序时，我们会得到白块或程序崩溃，具体取决于机器。

如果我们在 frameData 的构造函数之外使用 .setTexture() 创建对纹理的指针引用，它就可以工作！

如果这是一个迭代器结构，它遍历不同的帧。这是相关代码，首先这是在 FrameData 结构的标头中：

```
private:
    struct FrameData
    {
        FrameData(const std::string& fileName, int frameDelay);

        sf::Texture texture;
        sf::Sprite sprite;
        unsigned int frameDelay;
    }; 
```

其次，这是实际的构造函数，不起作用：

```
const sf::Sprite& SpriteAnimator::currentFrame() const
{
    return currentFrame_->sprite;
}

SpriteAnimator::FrameData::FrameData(const std::string& fileName, int frameDelay)
: frameDelay(frameDelay)
{
    texture.loadFromFile(fileName);
    sprite.setTexture(texture);
} 
```

第三，这是有效的：

```
const sf::Sprite& SpriteAnimator::currentFrame() const
{
    currentFrame_->sprite.setTexture(currentFrame_->texture);
    return currentFrame_->sprite;
}

SpriteAnimator::FrameData::FrameData(const std::string& fileName, int frameDelay)
: frameDelay(frameDelay)
{
    texture.loadFromFile(fileName);
    sprite.setTexture(texture);
} 
```

关于为什么会发生这种情况的任何想法，我们是否遗漏了什么？我们想让构造函数正常工作，当前帧的返回频率要比纹理变化的频率高很多，所以我们不需要每次返回当前帧时都更新纹理。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T17:11:26.247

我有一个类似的问题。我的解决方案是将所有纹理存储在类外部的容器中，并使用指向纹理的指针而不是纹理本身。这会用一块石头杀死 2 只鸟，因为如果要从该类中创建另一个对象，则不必存储超过 1 个相同的纹理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T16:34:42.213

**解决了**！阅读 sf::sprite 类文档的最后一段：

> 重要的是要注意 sf::Sprite 实例不会复制它使用的纹理，它只保留对它的引用。因此，当 sf::Sprite 使用 sf::Texture 时，它​​不能被销毁（即永远不要编写使用本地 sf::Texture 实例来创建精灵的函数）。

因此，为此类范围之外的纹理创建一个存储库，然后传递引用就可以了，就像 strongdrink 推荐的一样！

# - QtScript

> ID：11129169
> 
> 赞同：0
> 
> 时间：2012-06-20T22:35:14.907
> 
> 标签：

QtScript 是与 ECMA262 兼容的 JavaScript 实现。它是 QSA（Qt Script For Applications）的继承者，但在最近的 Qt 版本中被逐步淘汰，以支持 Google 的 V8 引擎。

# android - Android同步了两个项目高度不同的listview

> ID：11129174
> 
> 赞同：2
> 
> 时间：2012-06-20T22:35:53.357
> 
> 标签：android, listview, android-layout

我有两个并排的列表视图来模拟电视节目时间表。其中一个列表视图只有几个小时，每个项目（小时）都有固定的高度。另一个列表视图的显示可以持续超过一个小时，因此某些行的高度可能是小时的两倍，这意味着它是 2 小时。

我的问题是，如何同步两个列表视图，以便它们滚动相同数量的 y 位置？

# iphone - NSObject 和 TableView 调用

> ID：11129180
> 
> 赞同：0
> 
> 时间：2012-06-20T22:36:21.883
> 
> 标签：iphone, uitableview, nsobject

在 viewDidLoad 中，我有以下代码：

```
ProvRec *provRec = [[ProvRec alloc]init];
provRec.status = [NSString stringWithUTF8String:(char *)sqlite3_column_text(statement,3)
                            ];
provRec.desc = [NSString stringWithUTF8String:(char *)sqlite3_column_text(statement,4)
                            ];
[listOfItems addObject:provRec]; 
```

我应该如何调用在 cellForRowAtIndexPath:(NSIndexPath *)indexPath 的 TableView 中显示这些记录

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T23:39:08.873

实现它的方法是实现[表视图数据源协议](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITableViewDataSource_Protocol/Reference/Reference.html)。最关键的方法如下：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    ProvRec *provRec = [listOfItems objectAtIndex:indexPath.row];
    cell.textLabel.text = provRec.status;
    cell.detailTextLabel.text = provRec.desc;
    return cell;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {

    return [listOfItems count];
} 
```

如果表格中有多个部分，或者视图中有多个表格，则会有变化。但这是基本思想。

# .htaccess - .htaccess 一个漂亮的 url 的引荐来源网址重写规则

> ID：11129181
> 
> 赞同：0
> 
> 时间：2012-06-20T22:36:39.497
> 
> 标签：.htaccess, drupal, drupal-6, xss

我需要确保当引用者来自远程域时，无法登录 Drupal 的用户登录表单。这是一个影响企业接受度的安全漏洞。

路径是：[https ://domain.com/user](https://domain.com/user)

当前在 .htaccess 末尾有一条规则要求 https 访问

```
RewriteEngine On
RewriteCond %{HTTPS} off
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} 
```

我查看了这个以了解该规则如何识别 url，但不知道我将如何采用它并使用引用者实现它，而不影响 https 的其他规则

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T12:15:41.513

```
# if referer not empty
RewriteCond %{HTTP_REFERER} !^$
# and referer doesn't contain domain.com
RewriteCond %{HTTP_REFERER} !domain\.com
# and it is a POST request
RewriteCond %{REQUEST_METHOD} POST [NC]
# than redirect to current url to remove the POST data and show the default login screen
RewriteRule ^(user)$ /$1 [R=302,L] 
```

# objective-c - UIKeyboard 没有数字

> ID：11129186
> 
> 赞同：0
> 
> 时间：2012-06-20T22:37:09.727
> 
> 标签：objective-c, cocoa, uikeyboard

我需要一个 UIKeyboard 来显示没有数字 0-9 的默认 UIKeyboardType。我只需要隐藏那些按钮。

有没有办法访问键盘的不同按钮，以便我可以设置然后隐藏？如果不是，我可以检测何时按下“.?123”按钮并添加一个子视图来覆盖第一行吗？或者任何指向更好方法的指针？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T22:53:54.763

没有用于禁止访问数字键和标点键的公共 API。您可以挖掘键盘的视图层次结构以尝试隐藏数字切换键，但这可能会在未来中断（键盘视图层次结构在过去发生了变化）。

在文本控件的委托中过滤掉您不喜欢的字符会简单得多。例如，假设您只想允许用户输入字母。如果您有`UITextField`，请将其委托设置为您的视图控制器并在您的视图控制器中实现此方法：

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {
    NSRange all = NSMakeRange(0, string.length);
    if (all.length == 0) {
        // deletion
        return YES;
    }

    NSRange letters = [string rangeOfCharactersFromSet:[NSCharacterSet letterCharacterSet]];
    return NSEqualRanges(all, letters);
} 
```

如果您有`UITextView`，则调用该方法`textView:shouldChangeTextInRange:replacementText:`。

# python - django admin中的嵌套显示（多个外键）

> ID：11129187
> 
> 赞同：2
> 
> 时间：2012-06-20T22:37:14.620
> 
> 标签：python, django, django-models, django-admin

假设我有 3 个模型、一家公司、其部门和部门的员工。部门有一个公司的外键，员工有一个部门的外键。有没有办法让它工作，以便公司的 django 管理员中显示的列表执行以下操作：

```
General Electric
    Finance
            Tom Brown
            Bill Black
            John Green
    Technology
            Deer Rabbit
    Marketing
Target
    ... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T05:54:54.897

完全是的，要做到这一点，您必须自定义您的管理视图，这里是文档： http: [//www.djangobook.com/en/1.0/chapter17/](http://www.djangobook.com/en/1.0/chapter17/)

文档中有非常相似的示例，因此应该很容易理解:)

# javascript - 无休止地旋转图像/div（跨浏览器）

> ID：11129191
> 
> 赞同：7
> 
> 时间：2012-06-20T22:37:39.433
> 
> 标签：javascript, css

我正在尝试为这种效果找到一个跨浏览器的解决方案，但这是我能找到的最好的：

[http://jsfiddle.net/fE58b/19/](http://jsfiddle.net/fE58b/19/)

它对 CPU 也非常友好。

一些非跨浏览器 javascript 解决方案使用几乎 50% 的 CPU。在我看来，这不是网络使用的解决方案。

提供的示例适用于 Chrome 17、Firefox 11 和 Safari 5.1.7。

所以我的问题是：有没有办法创建这种效果（当然没有 flash 或 java）所以它也可以在 Opera 和 IE 中工作？

**编辑：**

HTML

```
<div id="starholder">
  <div id="star"></div>
</div>​ 
```

CSS

```
@-webkit-keyframes spin {
    from { -webkit-transform: rotate(0deg); }
    to { -webkit-transform: rotate(360deg); }
}

@-moz-keyframes spin {
    from { -moz-transform: rotate(0deg); }
    to { -moz-transform: rotate(360deg); }
}

@-ms-keyframes spin {
    from { -ms-transform: rotate(0deg); }
    to { -ms-transform: rotate(360deg); }
}

#starholder    { 
    position: relative; 
    width: 400px; 
    height: 400px; 
    margin: 100px 0 0 100px; 
}

#star    {
    background: url(http://3.bp.blogspot.com/__RwzDZn-SJM/RoEJcKxDs6I/AAAAAAAAAAQ/XYAyhQG2kcw/s320/hypnosis.gif) 0 0 no-repeat; 
    position: absolute; 
    top: -100px; 
    left: -100px; 
    width: 320px; 
    height: 320px; 
    -webkit-animation-name: spin; 
    -webkit-animation-duration: 12000ms;
    -webkit-animation-iteration-count: infinite; 
    -webkit-animation-timing-function: linear;
    -moz-animation-name: spin; 
    -moz-animation-duration: 12000ms;
    -moz-animation-iteration-count: infinite; 
    -moz-animation-timing-function: linear;
    -ms-animation-name: spin; 
    -ms-animation-duration: 12000ms;
    -ms-animation-iteration-count: infinite; 
    -ms-animation-timing-function: linear;
} 
```

​</p>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-11-17T16:14:06.483

这就是我实施它的方式。它适用于 chrome、safari、firefox 和 ie 11。我已经测试了 chrome、safari 和 firefox 的几个版本，但很抱歉我没有可靠的版本列表。

根据这个[http://css-tricks.com/snippets/css/keyframe-animation-syntax/](http://css-tricks.com/snippets/css/keyframe-animation-syntax/)支持的版本是 Firefox 5+、IE 10+、Chrome、Safari 4+、Opera 12+。

```
.rotate {
    display: inline-block;
    -webkit-animation-name: rotate; 
    -webkit-animation-duration: 2s; 
    -webkit-animation-iteration-count: infinite;
    -webkit-animation-timing-function: linear;
    -moz-animation-name: rotate; 
    -moz-animation-duration: 2s; 
    -moz-animation-iteration-count: infinite;
    -moz-animation-timing-function: linear;
    -o-animation-name: rotate; 
    -o-animation-duration: 2s; 
    -o-animation-iteration-count: infinite;
    -o-animation-timing-function: linear;
    animation-name: rotate; 
    animation-duration: 2s; 
    animation-iteration-count: infinite;
    animation-timing-function: linear;
}
@-webkit-keyframes rotate {
    from {-webkit-transform: rotate(0deg);}
    to {-webkit-transform: rotate(360deg);}
}

@-moz-keyframes rotate {
    from {-moz-transform: rotate(0deg);}
    to {-moz-transform: rotate(360deg);}
}

@-o-keyframes rotate {
    from {-moz-transform: rotate(0deg);}
    to {-moz-transform: rotate(360deg);}
}

@keyframes rotate {
  from {transform: rotate(0deg);}
  to {transform: rotate(360deg);}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T22:40:31.740

你可能想看到这个

[http://fgnass.github.com/spin.js/](http://fgnass.github.com/spin.js/)

这与您正在寻找的效果并不完全相同，但您可以从可用链接中找到提示和示例代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T22:51:07.230

这也是一个可以尝试的解决方案。 [http://neteye.github.com/activity-indicator.html](http://neteye.github.com/activity-indicator.html)

# wordpress - 需要为在线商店提供平台/插件建议，作为许多卖家的基础

> ID：11129204
> 
> 赞同：0
> 
> 时间：2012-06-20T22:38:36.577
> 
> 标签：wordpress, drupal, e-commerce, store

我建立一个网站来充当在线商店，但我不卖任何东西。我想给卖家注册的可能性（手动过程），然后将他们的商品放在商店目录上（全部混在一起）。我有使用 Drupal 和 Wordpress 的经验，我知道它们都有几个电子商务插件，但是我有点迷失了阅读这么多不同的插件，不知道他们是否可以做到这一点。任何人都可以给我一个提示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T22:53:38.493

我不推荐那些 CMS/博客。试试 Magento，它也是免费的 - Magento 的高级功能之一允许在一次安装中管理多个网站和商店。

# asana - 如何通过他们的 API 查询 Asana 中的存档任务

> ID：11129207
> 
> 赞同：6
> 
> 时间：2012-06-20T22:38:52.677
> 
> 标签：asana

我有兴趣从 Asana 导出数据，以便我们可以从中运行报告。为此，我需要获取所有任务的列表，包括已归档的任务。我对列出任务的API的理解是，如果任务被归档，那么在为一个项目获取任务时它不会被检索到。有没有办法查询所有任务，无论它们是否已存档？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T22:49:06.523

[已经](https://stackoverflow.com/questions/11093862/archived-tasks)有这样的疑问了。根据[Asana API](http://developer.asana.com/documentation/)，没有这样的机会。要问为什么，您应该询问 Asana 支持团队。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-01T00:54:13.313

归档任务可以通过在按项目查询任务的请求中包含参数 ?include_archived=true 来访问。

[Asana 文档中的任务部分](https://asana.com/developers/api-reference/tasks)

# android - Android 应用程序如何在未启动的情况下获得通知？

> ID：11129208
> 
> 赞同：2
> 
> 时间：2012-06-20T22:39:02.863
> 
> 标签：android

考虑大型博客拥有的应用程序（它们的工作方式非常类似于 RSS 提要，但适用于您的手机）。每当博客发布新帖子时，应用程序都会在用户手机上创建有关新帖子的通知。

以下是我想了解的一些事情：

1.  该通知是由我手机上的应用程序拉出还是由博客推送给它？
2.  即使我没有启动应用程序，这怎么能工作？
3.  Android 平台的哪些类和服务用于创建此类应用程序？

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T22:42:07.403

您可以通过以下方式轻松执行以下操作：

1.  您是否使用 AlarmManager 设置了闹钟
2.  让警报接收器启动检查更新的服务
3.  使用 NotificationManager 向用户显示通知

这是一个轮询解决方案，在您描述的大多数情况下，它应该很好并且可能更好。

但是，如果您想要一个推送解决方案，您可以查看 Android C2DM，它允许您的服务器将推送通知发送到已注册的 Android 设备。

编辑

应用程序如何“不启动”运行？

嗯，有几种方法。一是任何应用程序都可以注册不同的设备事件；其中之一是启动完成事件。

第二种方法是使用AlarmManager。如果应用程序设置了警报，然后用户离开该应用程序，然后操作系统决定关闭该应用程序，则仍然可以注册警报以在特定时间运行。触发此警报时，将运行应用程序开发人员喜欢的任何代码，包括启动服务。当然，在不通知用户的情况下这样做可能是一个问题，尤其是在服务耗尽电池等情况下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T22:43:00.523

当然，有很多方法可以做到，但在一般情况下，我会想象：

1.  是被手机拉的
2.  即使您没有看到该应用程序，它也可以在后台运行服务
3.  这真的取决于应用程序的功能，您想了解的任何特定方面？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T22:48:01.097

## 单程：

1.  应用程序可以在启动后启动一个`Sercvice`via `Broadcast`。请参阅此处：[如何自动启动 Android 应用程序？](https://stackoverflow.com/questions/1056570/how-to-autostart-an-android-application)
2.  该应用程序`Service`在启动时启动，服务就像一个活动，除了没有 UI 并且它在后台运行
3.  `Service`不时寻找新帖子，例如`Runnable`在`ScheduledThreadPoolExecutor`
4.  找到一个新`Runnable`帖子并发出通知

注意：这也是一个投票解决方案。而不是`ScheduledThreadPoolExecutor`你可以使用一个`Handler`总是调用自己的线程，或者只是一个不时休眠和醒来的线程。恕我直言 ScheduledThreadPoolExecutor 是“不错”的方式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-20T23:38:45.380

> 该通知是由我手机上的应用程序拉出还是由博客推送给它？

也可以是。

> 即使我没有启动应用程序，这怎么能工作？

好吧，在 Android 3.1+ 上，您需要至少运行一次该应用程序才能使这些东西正常工作。

除此之外，他们正在使用`AlarmManager`（用于拉取）或 C2DM（用于推送）之类的东西，它们都不需要您“启动应用程序”，就像您需要保持 Gmail 活动打开才能获得新电子邮件一样消息。

# javascript - （非常简单的递归）我错过了什么？

> ID：11129209
> 
> 赞同：1
> 
> 时间：2012-06-20T22:39:14.200
> 
> 标签：javascript, recursion

我看不到在这个递归调用中我缺少什么......

```
var power = function(b, e)
{
    if (e===0)
    {
       return 1;
    }
    else
    {
       return b*power(b, e-1);
    }
}; 
```

第一个 if 语句用于捕获数字的零次方（始终等于 1）。但这也是基本情况，所以当 e (exponent) 达到 0 时，函数退出并给我留下正确的答案。

这如何返回正确的数字而不是数字 1？每次，e都下降到0，但它返回正确答案而不是1。对不起，我是菜鸟，但我很困惑......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T22:41:16.340

您有一个*递归*函数，当它“返回 1”时，它会返回堆栈帧并将 1 乘以它堆积的所有其他 b 变量。1*b*b*b...等

1*anything 是身份函数。它返回自己，而不是 1。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T22:46:53.827

假设您这样做`power(2,4)`，它将进入`else`并返回`2 * power(2, 3)`。在它可以返回之前，它必须评估它返回的表达式，所以它会`power(2, 3)`.

`else`这又进入了`return 2 * power(2,2)`。同样的交易，它必须评估表达式。你继续这样做，直到你到达你的基本情况，它只是返回 1。现在你进入从底部开始的第二个级别，它可以返回，因为它只是`2*1`，所以它进入下一个更高的级别，这将是`2*2*1`依此类推，直到它到达最高级别并为您提供答案。

有关更多解释，请参阅[此 SO](https://stackoverflow.com/questions/6773914/how-exactly-does-this-recursive-function-work-in-javascript)（相同问题）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T22:48:43.000

这是一个执行示例：

> 功率 = 函数 (2, 2)
> 
> 2 与 0 不同，则返回 2*function(2, 1)
> 
> ```
>  -> 1 is different of 0, then return 2*function(2, 0)
> 
>            -> 0 equal 0 return 1
> 
>    -> return 2*1 
> ```
> 
> 返回 2*2*1
> 
> 功率 = 4

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-20T22:41:49.517

在堆栈上，您将有 1*b*b*b*b... e 次。当基本情况发生时，堆栈展开并且您得到正确的答案。

# sockets - TCP：两个不同的套接字可以共享一个端口吗？

> ID：11129212
> 
> 赞同：174
> 
> 时间：2012-06-20T22:39:39.493
> 
> 标签：sockets, tcp, network-programming, port

这可能是一个非常基本的问题，但它让我感到困惑。

两个不同的连接套接字可以共享一个端口吗？我正在编写一个应该能够处理超过 100k 并发连接的应用程序服务器，并且我们知道系统上可用的端口数约为 60k（16 位）。一个已连接的套接字被分配给一个新的（专用）端口，因此这意味着并发连接数受端口数的限制，除非多个套接字可以共享同一个端口。所以这个问题。

* * *

## 回答 #1

> 赞同：265
> 
> 时间：2014-11-28T05:45:31.677

# TCP/HTTP 监听端口：多个用户如何共享同一个端口

那么，当服务器侦听 TCP 端口上的传入连接时会发生什么？例如，假设您在端口 80 上有一个 Web 服务器。假设您的计算机的公共 IP 地址为 24.14.181.229，而尝试连接到您的人的 IP 地址为 10.1.2.3。此人可以通过打开到 24.14.181.229:80 的 TCP 套接字来连接到您。很简单。

直觉上（并且错误地），大多数人认为它看起来像这样：

```
 Local Computer    | Remote Computer
    --------------------------------
    <local_ip>:80     | <foreign_ip>:80

    ^^ not actually what happens, but this is the conceptual model a lot of people have in mind. 
```

这很直观，因为从客户端的角度来看，他有一个 IP 地址，并通过 IP:PORT 连接到服务器。既然客户端连接到80端口，那么他的端口也必须是80？这是一个明智的想法，但实际上并非如此。如果这是正确的，我们只能为每个外国 IP 地址服务一个用户。一旦远程计算机连接，那么他将占用端口 80 到端口 80 的连接，其他人无法连​​接。

必须明白三点：

1.) 在服务器上，一个进程正在*监听*一个端口。一旦它得到一个连接，它就会把它交给另一个线程。通信永远不会占用监听端口。

2.) 连接由操作系统通过以下 5 元组唯一标识：（本地 IP、本地端口、远程 IP、远程端口、协议）。如果元组中的任何元素不同，那么这是一个完全独立的连接。

3.) 当客户端连接到服务器时，它会选择一个*随机的、未使用的高阶源端口*。这样，单个客户端最多可以有约 64k 到服务器的相同目标端口的连接。

因此，这实际上是客户端连接到服务器时创建的内容：

```
 Local Computer   | Remote Computer           | Role
    -----------------------------------------------------------
    0.0.0.0:80       | <none>                    | LISTENING
    127.0.0.1:80     | 10.1.2.3:<random_port>    | ESTABLISHED 
```

## 看看实际发生的事情

首先，让我们使用 netstat 来查看这台计算机上发生了什么。我们将使用端口 500 而不是 80（因为端口 80 上发生了很多事情，因为它是一个通用端口，但在功能上它并没有什么区别）。

```
 netstat -atnp | grep -i ":500 " 
```

正如预期的那样，输出为空白。现在让我们启动一个 Web 服务器：

```
 sudo python3 -m http.server 500 
```

现在，这里是再次运行 netstat 的输出：

```
 Proto Recv-Q Send-Q Local Address           Foreign Address         State  
    tcp        0      0 0.0.0.0:500             0.0.0.0:*               LISTEN      - 
```

所以现在有一个进程正在500端口上主动监听（状态：LISTEN）。本地地址是0.0.0.0，这是“监听所有IP地址”的代码。一个容易犯的错误是只监听端口 127.0.0.1，它只接受来自当前计算机的连接。所以这不是一个连接，这只是意味着一个进程请求绑定（）到端口 IP，并且该进程负责处理与该端口的所有连接。这暗示了每台计算机只能有一个进程监听端口的限制（有一些方法可以使用多路复用来解决这个问题，但这是一个更复杂的话题）。如果 Web 服务器正在侦听端口 80，则它无法与其他 Web 服务器共享该端口。

所以现在，让我们将用户连接到我们的机器：

```
 quicknet -m tcp -t localhost:500 -p Test payload. 
```

这是一个简单的脚本 ( [https://github.com/grokit/quickweb](https://github.com/grokit/quickweb) )，它打开一个 TCP 套接字，发送有效负载（在本例中为“测试有效负载”），等待几秒钟并断开连接。发生这种情况时再次执行 netstat 会显示以下内容：

```
 Proto Recv-Q Send-Q Local Address           Foreign Address         State  
    tcp        0      0 0.0.0.0:500             0.0.0.0:*               LISTEN      -
    tcp        0      0 192.168.1.10:500        192.168.1.13:54240      ESTABLISHED - 
```

如果您连接另一个客户端并再次执行 netstat，您将看到以下内容：

```
 Proto Recv-Q Send-Q Local Address           Foreign Address         State  
    tcp        0      0 0.0.0.0:500             0.0.0.0:*               LISTEN      -
    tcp        0      0 192.168.1.10:500        192.168.1.13:26813      ESTABLISHED - 
```

...也就是说，客户端使用另一个随机端口进行连接。因此，IP 地址之间永远不会混淆。

* * *

## 回答 #2

> 赞同：240
> 
> 时间：2012-06-20T23:32:23.850

**服务器**套接字侦听单个端口。**该服务器上所有已建立的客户端连接都与连接的服务器端**的同一侦听端口相关联。已建立的连接由客户端和服务器端 IP/端口对的组合唯一标识。同一服务器上的多个连接可以共享同一**服务器端**IP/端口对，只要它们与不同**的客户端**IP/端口对相关联，并且**服务器**将能够处理可用系统资源允许的尽可能多的客户端到。

在**客户端**，新的出站连接通常使用随机**客户端**端口，在这种情况下，如果您在短时间内建立大量连接，则可能会用完可用端口。

* * *

## 回答 #3

> 赞同：51
> 
> 时间：2012-06-20T23:28:19.537

> 已连接的套接字分配给新的（专用）端口

这是一种普遍的直觉，但它是不正确的。连接的套接字未分配给新的/专用端口。TCP 堆栈必须满足的唯一实际约束是 (local_address, local_port, remote_address, remote_port) 的元组对于每个套接字连接必须是唯一的。因此，服务器可以有许多 TCP 套接字使用相同的本地端口，只要端口上的每个套接字都连接到不同的远程位置。

请参阅“套接字对”段落： http: [//books.google.com/books ?id=ptSC4LpwGA0C&lpg=PA52&dq=socket%20pair%20tuple&pg=PA52#v=onepage&q=socket%20pair%20tuple&f=false](http://books.google.com/books?id=ptSC4LpwGA0C&lpg=PA52&dq=socket%20pair%20tuple&pg=PA52#v=onepage&q=socket%20pair%20tuple&f=false)

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2013-11-07T09:00:30.667

理论上，是的。练习，不是。大多数内核（包括 linux）不允许您`bind()`使用已分配的端口。允许这样做并不是一个很大的补丁。

从概念上讲，我们应该区分*socket*和*port*。套接字是双向通信端点，即我们可以发送和接收字节的“事物”。这是一个概念性的东西，在名为“socket”的数据包头中没有这样的字段。

端口是能够识别套接字的标识符。在 TCP 的情况下，端口是一个 16 位整数，但也有其他协议（例如，在 unix 套接字上，“端口”本质上是一个字符串）。

主要问题如下：如果传入的数据包到达，内核可以通过其目标端口号识别其套接字。这是一种最常见的方式，但不是唯一的可能性：

*   套接字可以通过传入数据包的目标 IP 来识别。例如，如果我们有一台服务器同时使用两个 IP，就是这种情况。然后，我们可以在相同的端口上运行不同的网络服务器，但在不同的 IP 上。
*   套接字也可以通过它们的*源*端口和 ip 来识别。在许多负载平衡配置中就是这种情况。

因为您正在使用应用程序服务器，所以它将能够做到这一点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-01-09T15:20:56.413

不，不可能在特定时刻共享同一个端口。但是你可以让你的应用程序在不同的时刻进行端口访问。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-05-17T15:36:45.373

我想没有一个答案能说明这个过程的每一个细节，所以这里是：

考虑一个 HTTP 服务器：

1.  它要求操作系统将端口 80 绑定到一个或多个 IP 地址（如果选择 127.0.0.1，则只接受本地连接。您可以选择 0.0.0.0 绑定到所有 IP 地址（本地主机、本地网络、广域网） ，两个 IP 版本））。

2.  当客户端连接到该端口时，它将锁定一段时间（这就是套接字有积压的原因：它将许多连接尝试排队，因为它们不是即时的）。

3.  操作系统然后选择一个随机端口并将该连接传输到该端口（将其视为从现在开始处理所有流量的临时端口）。

4.  然后释放端口 80 用于下一个连接（首先，它将接受积压中的第一个连接）。

5.  当客户端或服务器断开连接时，随机端口会保持打开一段时间（远程端为 CLOSE_WAIT，本地端为 TIME_WAIT）。这允许沿路径刷新一些丢失的数据包。该状态的默认时间是 2 * MSL 秒（它会在等待时消耗内存）。

6.  等待之后，该随机端口再次空闲以接收其他连接。

所以，TCP 甚至不能在两个 IP 之间共享一个端口！

# ruby-on-rails-3 - Phusion 乘客 + NGinx 与 Rails 3

> ID：11129214
> 
> 赞同：1
> 
> 时间：2012-06-20T22:39:53.620
> 
> 标签：ruby-on-rails-3, ubuntu, nginx, rvm, passenger

index我正在尝试在带有 Ubuntu 12.04 64 位 AMI 的 AWS EC2 上部署一个简单的 Rails 3 应用程序。我按照 Phusion Passenger NGinx 安装页面中的步骤进行操作。我还使用了安装成功的 RVM。

我的步骤：

1.  安装和配置 RVM
2.  安装 Ruby 1.9.3
3.  安装 Rails 3.2.3
4.  安装乘客
5.  运行passenger-install-nginx-module（必须使用rvmsudo）
6.  创建了一个新的 Rails 应用程序（rails new Passenger_test）
7.  将以下配置部分添加到 nginx.conf

    ```
    server {
     listen       80;
     server_name  localhost;
     root /home/ubuntu/passenger_test/public;
     passenger_enabled on
    } 
    ```

我重新启动了 nginx，并且显示了 rails default public/index.html default rails 页面，但是 rails.png 没有呈现并且“查看您的应用程序的环境”链接不起作用。我在四台全新的服务器上尝试了四次不同的时间，并且总是得到相同的结果。请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T06:55:15.577

行。刚刚尝试了 Ubuntu 11.10 t1.micro 并得到了同样的错误。还在 m1.small 上尝试了 Ubuntu 11.10，这有点成功。这次在 rails.png 上得到了 404，我认为这在生产环境中是正常的。尝试在我的 nginx.conf 文件中更改我的 rack/rails 环境，如下所述：[http](http://www.modrails.com/documentation/Users%20guide%20Nginx.html#deploying_a_rack_app) ://www.modrails.com/documentation/Users%20guide%20Nginx.html#deploying_a_rack_app但出现 500 个服务器错误。尝试了许多其他改变环境的组合，但仍然是 500。发现如果你设置 bot 的 rack_env 和 rails_env 配置选项，它会抱怨重复的 rails_env 节点。所以回到生产环境，明天将尝试使用真正的 Rails 应用程序。

ps 我在 m1.small 上做的唯一其他步骤是在运行乘客安装 nginx 模块后只安装了导轨。一旦安装了NGinx和Passenger，在我安装Rails之前，我测试了一个简单的Rack应用程序，如下所述：[http](http://www.modrails.com/documentation/Users%20guide%20Nginx.html#deploying_a_rack_app) ://www.modrails.com/documentation/Users%20guide%20Nginx.html#deploying_a_rack_app并且它有效！

# python - Python IRC Bot 不会加入某些服务器上的频道，我不知道如何让它响应用户输入

> ID：11129216
> 
> 赞同：1
> 
> 时间：2012-06-20T22:40:09.220
> 
> 标签：python, irc, bots

我有一个 Python IRC 机器人，我开始着手练习我的 Python。但是，对于某些服务器，它不会加入频道，但它可以成功登录。我还希望它对像 !test 这样的用户命令做出反应，但我不知道该怎么做。在它工作的服务器上，它成功地ping回来了。

```
from socket import socket, AF_INET, SOCK_STREAM
network = raw_input("Server: ")
port = 6667
chan = raw_input("Channel: ")
nick = raw_input("Nick: ")
irc=socket(AF_INET,SOCK_STREAM)
irc.connect((network, port))
a=irc.recv (4096)
print a
irc.send('NICK ' + nick + '\r\n')
irc.send('USER john_bot john_bot bla :john_bot\r\n')
irc.send('JOIN :' + chan + '\r\n')
irc.send('PRIVMSG ' + chan + ' :Hello.\r\n')

def ircSend(msg):
     print(msg)
     irc.send(msg)

while True:
    data = irc.recv(4096)
    print data
    if data.find('PING') != -1:
       ircSend('PONG ' + data.split()[1] + '\r\n') 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T16:20:13.103

在某些服务器上，您必须先用 PONG 响应 PING，然后才能实际执行任何操作。

```
ircSend('NICK ' + nick + '\r\n')
ircSend('USER john_bot john_bot bla :john_bot\r\n')

data = ircRecv() # explained later
if data.find('PING') != -1:
    ircSend('PONG ' + data.split()[1] + '\r\n')

ircSend('JOIN :' + chan + '\r\n')
ircSend('PRIVMSG ' + chan + ' :Hello.\r\n') 
```

你真的不需要这个

```
a=irc.recv (4096)
print a 
```

有时 IRC 服务器会同时发送多条线路（例如 MOTD 或 NAMES）。只要总字节数不超过 4096，这将处理得很好（有些行会分成两行）

```
data = irc.recv(4096)
for line in data.split('\r\n'):
    # process the line 
```

如果一行会被切成两半是一个问题（这种情况很少发生，比如 PING 恰好在那里），我们可以一次接收一行并将其余字符留给套接字的缓冲区。但是，这可能效率较低（我还没有测试过，所以也许根本不重要）

```
def ircRecv():
    line = ''
    while 1: # same as while True:
        character = irc.recv(1)
        if character == '\n':
            break # exit the loop
        elif character != '\r':
            line += character
    print line
    return line 
```

从 IRC RFC 的第 8 页：

```
<message>  ::= [':' <prefix> <SPACE> ] <command> <params> <crlf>
<prefix>   ::= <servername> | <nick> [ '!' <user> ] [ '@' <host> ]
<command>  ::= <letter> { <letter> } | <number> <number> <number>
<SPACE>    ::= ' ' { ' ' }
<params>   ::= <SPACE> [ ':' <trailing> | <middle> <params> ]
<middle>   ::= <Any *non-empty* sequence of octets not including SPACE
           or NUL or CR or LF, the first of which may not be ':'>
<trailing> ::= <Any, possibly *empty*, sequence of octets not including
             NUL or CR or LF>
<crlf>     ::= CR LF 
```

这意味着您始终可以轻松地获得消息的发件人，并且肯定是这样的：

```
# put this inside the main loop
# this will throw an IndexError when the connection is closed,
# an empty line does not contain any spaces
line = ircRecv()
if line.split()[0].find('!') != -1:
    # the first character must be a colon because <command> can't include
    # an exclamation mark
    someOneElsesNick = line[1:line.find('!')]
    command = line.split()[1] 
```

有人打招呼时回答！

```
 if command == 'PRIVMSG':
        destination = line.split()[2] # channel or bot's nick
        # <trailing>, in this case, the message
        message = line[line[1:].find(':')+2 : ] # everything after the 2nd colon

        # we add one since we don't want include the <trailing> colon in
        # the message and an other one because line[1:].find() is one smaller 
        # number than line.find() would be

        # if we receive a private message, we have to respond to the sender,
        # not to ourself
        if destination == nick:
            destination = someOneElsesNick

        if message.startswith('hi!'):
            ircSend('PRIVMSG ' + destination + ' :Hi, '
            + someOneElsesNick + '!\r\n') 
```

有关更多信息，请查看 IRC RFC：[http](http://www.ietf.org/rfc/rfc1459.txt) ://www.ietf.org/rfc/rfc1459.txt （尤其是第 2.3.1 和 4 节）。如果您不想处理 IRC 协议，请使用 Twisted :) [http://twistedmatrix.com/trac/](http://twistedmatrix.com/trac/)

# forms - Spring MVC - 处理表单最佳实践 - 编写特定的表单类或使用实体类？

> ID：11129217
> 
> 赞同：0
> 
> 时间：2012-06-20T22:40:11.857
> 
> 标签：forms, spring, spring-mvc

学习 Spring (3.1.0) 和 Hibernate (4.1.1)。只是想知道大多数开发人员在处理表单数据时会做什么。在编写包含用于提交数据的表单的 JSP 时，您通常是编写一个特定于该表单上的输入字段的类并处理该服务器端，还是只使用您的实体类并将它们绑定到表单上的 elemtns ?

假设我有一个具有 3 个实体类的应用程序：Location、StoreType 和 Store（一个 Store 有一个 StoreType 和一个 Location）。在 /CreateStore JSP 页面上的表单上，我有一个包含所有位置的下拉选择框，另一个包含所有 StoreTypes 的下拉选择框和其他带有商店名称、商店经理等的文本输入字段。

您是否使用 List locationNames、List storeTypes、String storeName 等创建一个 CreateStoreForm 类并将其放在模型上？或者你只是将所有不同的实体类分别放在模型上？我一直在使用后一种方法，但我认为前者可能更好，特别是当用户对同一屏幕发出连续请求时重新填充屏幕。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T05:02:58.833

您提到的两种方法都很好。但是选择它们是基于您的要求。在您在问题中提到的情况下，第二种方法更好，因为您传递的两个列表 locationNames 和 storeTypes 只是参考字段。并且在您的实际模型类（具有 storeName 和 storeManager 字段）中必须包含 location 和 storeType 的 id。

因此，当您提交表单时，只有具有存储属性的模型类将存储在数据库中。其他列表字段只是参考数据，您不会将其与其他字段一起存储在数据库中。

希望这对您有所帮助。干杯。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T07:29:25.183

拥有一个映射表单的类总是好的，然后编写一个 util 方法将表单类转换为 Hibernate 将用于执行操作的实际模型类。

对于下拉列表，您可以`@ModelAttribute`单独使用返回列表并且可以在表单中使用的方法。而且您不需要将它添加到您的表单类或实体类中。

```
@Controller
public class MyController {
    @ModelAttribute("productsList")
    public Collection<Product> populateProducts() {
        return this.productsService.getProducts();
    }
    // @RequestMapping etc omitted for brevity
} 
```

# javascript - 检测远程网站是否可框架

> ID：11129228
> 
> 赞同：0
> 
> 时间：2012-06-20T22:40:56.897
> 
> 标签：javascript, iframe

我想检测远程网站是否允许站在 iframe 下。例如，如果网站不想在 iframe（amazon.com 项目详细信息页面）下显示内容，或者如果他们有框架破坏代码（walmart.com），我不想打扰这些网站。我只想打开新窗口，对于其他人（如 wikipedia.com），我想在 iframe 下显示内容。

我的问题是，有什么方法可以检测网站是否会接受 iframe 下？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T22:47:08.350

我认为没有这种方法。您无法检查从另一个域加载的 iframe 内容 - 即使可以，它仍然取决于网站所有者决定放入的确切内容。如果有人会以与原始内容完全相同的方式设计他们的“iframed”内容 - 例如，所有页面的文本都以 ROT13 编码，该怎么办？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T22:48:37.857

以下是用于阻止页面在 iframe 中显示的 Javascript 代码之一。

```
if (top.location.href != self.location.href)
  top.location.href = self.location.href; 
```

如果是包含文件，就不容易检测到了。。

# c++ - 复制语义和比较

> ID：11129234
> 
> 赞同：3
> 
> 时间：2012-06-20T22:41:17.807
> 
> 标签：c++, yaml-cpp

有没有办法将 YAML::Node 对象中所有值的副本复制到新对象（即克隆）中？还有一种方法可以通过节点中的值来测试两个 YAML::Node 对象之间的相等性（即 .equals() 函数而不是 .is() 函数）？

考虑以下示例：

```
YAML::Node a;
a["x"][1]["y"][2]["z"][3] = 1;
std::cout << "A_____\n" << a << "\n\n\n\n";

std::cout << "Test 1\n";
YAML::Node z = a["x"][1]["y"][2]["z"];
z[3] = 2;
std::cout << "Z_____\n" <<  z << "\n";
std::cout << "A_____\n" <<  a << "\n\n\n\n";

std::cout << "Test 2\n";
YAML::Node b = a;
b["x"][1]["y"][2]["z"][3] = 3;
std::cout << "B_____\n" <<  b << "\n";
std::cout << "Z_____\n" <<  z << "\n";
std::cout << "A_____\n" <<  a << "\n\n\n\n";

std::cout << "Test 3\n";
YAML::Node c;
c["x"][1]["y"][2]["z"][3] = 3;
std::cout << "C_____\n" <<  c << "\n";
std::cout << "A_____\n" <<  a << "\n";
std::cout << "a == c: " <<  bool(a==c) << "\n";
std::cout << "z == a[\"x\"][1][\"y\"][2][\"z\"]: "
            <<  bool(z == a["x"][1]["y"][2]["z"]) << "\n\n"; 
```

运行时输出以下内容：

```
A_____
x:
  1:
    y:
      2:
        z:
          3: 1

Test 1
Z_____
3: 2
A_____
x:
  1:
    y:
      2:
        z:
          3: 2

Test 2
B_____
x:
  1:
    y:
      2:
        z:
          3: 3
Z_____
3: 3
A_____
x:
  1:
    y:
      2:
        z:
          3: 3

Test 3
C_____
x:
  1:
    y:
      2:
        z:
          3: 3
A_____
x:
  1:
    y:
      2:
        z:
          3: 3
a == c: 0
z == a["x"][1]["y"][2]["z"]: 1 
```

在测试 1 中，修改`z`也会修改 的值`a["x"][1]["y"][2]["z"]`，同样在测试 2 中，修改`b`等价于修改`a`。这些复制语义是否被认为是 API 的一部分（即它们将来可能会改变）？我希望能够编写诸如`z = getZ()`, 之类的代码并`getZ()`返回`a["x"][1]["y"][2]["z"]`（“x”、“y”和“z”的名称将来可能会更改）。然后修改`z`将修改`a`，如示例中所示。

另外，有没有办法将克隆复制`a`到新对象`b`中，这样修改`b`也不会修改`a`？

在 test3 中， 中的值与`c`中的值相同`a`。是否有一些方法可以`a.equals(c)`为 YAML::Node 对象做一般测试来测试两个节点中的值是否都相同？在示例中，`a.equals(c)`将是正确的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T01:11:26.853

深拷贝节点：

```
YAML::Node node = /* ... */;
YAML::Node other = Clone(node); 
```

（现在已实现；您可以查看旧的[错误报告](http://code.google.com/p/yaml-cpp/issues/detail?id=162)。）

当前行为是有意的（换句话说，典型的“复制”只是设置身份），并且不会改变。

至于平等，一般来说，对于 YAML 来说，这是一个非常困难的问题。在 yaml-cpp 项目页面上有一些关于[这个问题的讨论。](http://code.google.com/p/yaml-cpp/issues/detail?id=60)

# asp.net-mvc - 存储/访问 ASP.NET MVC 表单的配置数据

> ID：11129236
> 
> 赞同：0
> 
> 时间：2012-06-20T22:41:27.143
> 
> 标签：asp.net-mvc, metadata

我正在处理需要可配置的 ASP.NET MVC 商业企业应用程序中的大型表单。该表单有大约 100 个可能的字段，但由于每个企业客户只需要其中的一小部分，我需要能够配置每个表单字段的可见性。配置很简单——我将在数据库中存储一个可见字段列表——但我不太确定我应该如何控制前端视图中每个字段的可见性。

我已经构建了一些自定义 HTML 助手来在视图中呈现表单。我有一个助手来渲染表单，它只会遍历数据模型属性并渲染已配置为可见的字段的输入。我想不通的是我在哪里存储可见性配置？它似乎更像元数据而不是模型数据，但我不确定我将在哪里/如何存储/访问它。

我将表单配置数据放在哪里，我应该如何从我的 html 助手访问它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T08:49:12.640

如何创建一个 ViewModel，其中包含您当前的模型作为属性和需要显示的项目的附加新属性（可能是通用列表）。

默认情况下，确保表单字段不可见，然后在视图中循环遍历通用列表，触发适当的方法/扩展/帮助程序以打开列表中的字段。

# knockout.js - 淘汰赛：添加到嵌套视图模型中的可观察数组

> ID：11129242
> 
> 赞同：2
> 
> 时间：2012-06-20T22:42:04.770
> 
> 标签：knockout.js, ko.observablearray

我有一些带有可观察数组的嵌套视图模型，并且无法成功添加到任何嵌套数组中。在顶层添加工作正常。我做了很多阅读和摆弄，试图解决我做错的事情，但无济于事。

层次结构如下：Queue-->Files-->Claims-->Lines

我可以将新文件添加到队列中，但无法添加新声明（通过文件和队列尝试）

任何想法我做错了什么？ [http://jsfiddle.net/bxfXd/254/](http://jsfiddle.net/bxfXd/254/)

**更新**：下面的所有答案都指向我的核心问题——在我的可观察数组中使用原始数据而不是实例化模型。使用工作代码更新小提琴：http: [//jsfiddle.net/7cDmg/1/](http://jsfiddle.net/7cDmg/1/)

**HTML**：

```
<h2>
    <span data-bind="text: name"></span>        
    <a href='javascript:' data-bind="click: addFile">AddFile</a>
</h2>
<div data-bind="foreach: files">
    <h3>File: <span data-bind="text: name"></span> (<span data-bind="text: id"></span>)
    <a href='javascript:' data-bind="click: $data.addClaim">AddClaimViaFile</a>
    <a href='javascript:' data-bind="click: $root.addClaim">AddClaimViaQueue</a></h3> 

    <div data-bind='foreach: claims'>
        <h3 data-bind="text: ud"></h3> 
        <table border=1>
            <thead>
                <td>id</td>    <td>procedure</td>    <td>charge</td>
            </thead>
            <tbody  data-bind='foreach: lines'>
                <tr>
                    <td data-bind="text: id"></td> 
                    <td data-bind="text: procedure"></td> 
                    <td data-bind="text: charge"></td>
                </tr>
            </tbody>
        </table>
    </div>
</div>​ 
```

**JavaScript**：

```
var line1 = { id: 1, procedure: "Amputate", charge: 50 };
var line2 = { id: 2, procedure: "Bandage", charge: 10};
var claim1 = { ud: '1234E123', charge: 123.50, lines: [line1,line2] };
var claim2 = { ud: '1234E222', charge: 333.51, lines: [line2,line2] };
var file1 = { id: 1, name: "Test1.txt", claims: [claim2] };
var file2 = { id: 2, name: "Test2.txt", claims: [] };
var queue = { id: 1, name: "JoesQueue", files: [file1,file2] }; 

function Line(data) {
    this.id = ko.observable(data.id);
    this.procedure = ko.observable(data.procedure);
    this.charge = ko.observable(data.charge);
}

function Claim(data) {
    this.ud = ko.observable(data.ud);
    this.charge = ko.observable(data.charge);
    this.lines = ko.observableArray(data.lines);
}

function File(data) {
    var self=this;
    self.id = ko.observable(data.id);
    self.name = ko.observable(data.name);
    self.claims = ko.observableArray(data.claims);
    self.addClaim = function(file) {  //this never gets called.. Why?
        alert("File.addClaims");
       self.claims.push(claim1);
    }          
}

function Queue(data) {
    this.id = ko.observable(data.id);
    this.name = ko.observable(data.name);
    this.files = ko.observableArray(data.files);
    this.addClaim = function(file) {
        alert("Queue.addClaim");
        console.log(file);
       file.claims.push(claim1); //This line gets hit, but no claims get added..Why?
    };     
    this.addFile = function() {
        alert("Queue.addFile");
        this.files.push(file2); //Works - adding seems to only work at the top level :(
    }
}

$(function () {
    ko.applyBindings(new Queue(queue));
}); 
```

​</p>

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T23:03:12.117

我快速检查了您的 jsfiddle，发现存在一些问题，例如：

*   您传递给`Queue()`构造函数的初始数据不是由 observables 组成的。换句话说，初始的`queue.files`observable 数组包含原始的 JS 对象，而不是你的`File`viewmodel 的实例。

*   `data-bind="click: File.addClaim"`不做你想让它做的事情。应该是`data-bind="click: addClaim"`，但首先您的`queue.files`数组必须由`File`实例组成。

我在这个 jsfiddle 中解决了这些问题：http: [//jsfiddle.net/ntXJJ/2/](http://jsfiddle.net/ntXJJ/2/)（从你的分叉而来）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T23:04:41.067

你的问题很简单。您的 File、Claim 等构造函数非常棒，只是您从未使用过它们。例如，您将原始 json 推送到您的收藏中。

```
this.files.push(file2); 
```

真的应该

```
this.files.push(new File(file2)); 
```

您也没有正确初始化对象。这是一个演示如何使用映射插件的小提琴。

[http://jsfiddle.net/madcapnmckay/a8mZY/1/](http://jsfiddle.net/madcapnmckay/a8mZY/1/)

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T23:24:17.793

此外，通过手动映射数据模型对代码进行另一次清理

[http://jsfiddle.net/keith_nicholas/d64TN/](http://jsfiddle.net/keith_nicholas/d64TN/)

# regex - 如何为时间和数字构建正则表达式

> ID：11129248
> 
> 赞同：0
> 
> 时间：2012-06-20T22:43:16.840
> 
> 标签：regex

我需要一个可以处理 1 - 999 之间的整数或时间 MM:SS 从 00:00 到 59:59 的正则表达式。这是我的尝试`^?((\d{1,3})|((([0-9])|([0-5][0-9])):(([0-9])|([0-5][0-9]))))$`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T22:57:31.477

试试看：

```
(([0-5][0-9]:[0-5][0-9])|\d{1,3}) 
```

（或者如果您还需要匹配 0:17 或 17:2 或 3:8 之类的内容）：

```
((([0-5][0-9]|[0-9]):([0-5][0-9])|[0-9])|\d{1,3}) 
```

您需要注意，当您匹配正则表达式时，您正在创建一个非常“简单”的解析器，它使用***从左到右的****字符***。**

# android - Android异步编程不开启新进程？

> ID：11129251
> 
> 赞同：0
> 
> 时间：2012-06-20T22:43:50.850
> 
> 标签：android, asynchronous, httprequest

是否可以在不分叉线程的情况下执行异步操作，例如执行 HTTP 请求？在 Windows 或 Linux 中，我通常看不到任何应用程序为每个 HTTP 请求创建一个子进程，所以我想对 Android 做同样的事情。否则对我来说，这似乎是矫枉过正，并为我的应用程序增加了不必要的高优先级。

如果有人熟悉 JavaScript，我想做类似的异步工作。有一种要做什么的队列，所有东西实际上都在一个线程中，即使它们是异步的。它使用某种排队机制。

当然我可能不正确地知道这一点，并且使用 Threads 或 AsyncTask 可能实际上并没有打开一个新进程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T22:49:03.883

所有[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)实例都使用已经存在的共享线程池运行（当然，除非您指定自己的执行程序），从而避免始终产生新线程的开销。使用那些。

# python - 是否有用于实时视频输入的 Python 库？

> ID：11129252
> 
> 赞同：4
> 
> 时间：2012-06-20T22:43:51.510
> 
> 标签：python, video

我想用 Python 编写一个程序，可以从网络摄像头获取视频输入并显示它。而且我还希望程序能够识别颜色。所以程序可以识别所有红色的位置。这可以用 Python 实现吗？

我可以为此使用什么库？如果不可能，是否有更好的语言可以用于此？

我正在为 Linux 制作这个程序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T22:51:55.713

然后 OpenCV 是要走的路，[http://opencv.willowgarage.com/wiki/InstallGuide](http://opencv.willowgarage.com/wiki/InstallGuide)，这也可能有助于您 [使用 OpenCV 和 Python 显示网络摄像头提要](https://stackoverflow.com/questions/2601194/displaying-webcam-feed-using-opencv-and-python)

`And I also want the program to be able to identify colors.`我不建议在 python 中本地进行图像处理，因为它可能非常密集，`numpy`这对于一般数字运算或`PIL`专注于图像非常有用。

在大多数情况下，屏幕截图将被视为 3d 矩阵`image[xloc][yloc][rgbcolor]`，具体取决于 opencv 返回的格式。如果您想检查红色，那么只需检查`image[xloc][yloc][red]`255 或接近该值的值，以查看您正在寻找哪种强度，而其他两种颜色为零或低，即红色，但尝试使用矩阵运算符执行此操作`numpy`python中的标准for循环将花费相当长的时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T22:52:17.147

[OpenCV](http://en.wikipedia.org/wiki/OpenCV)有一个 Python 接口。

有关捕获网络摄像头数据并将其显示在窗口中的入门程序，请参阅 Stack Overflow 问题*[Displaying a webcam feed using OpenCV and Python 。](https://stackoverflow.com/questions/2601194)*

# sql-server - SQL Server 2008：批量插入是否有更好的（服务器端）替代品？

> ID：11129253
> 
> 赞同：0
> 
> 时间：2012-06-20T22:43:55.270
> 
> 标签：sql-server, sql-server-2008, bulkinsert

TLDR 版本：批量插入将告诉您它影响了多少行。它不会告诉你它试图影响多少行，或者有多少行失败。这个问题很明显，我想知道是否有更可靠的方式从文本文件上传，将代码保存在服务器中。

完整版：我有一个应用程序需要定期将文本数据文件上传到 SQL Server 表中。出于某种疯狂和疯狂的原因，我想把它放在一个存储过程中，使其成为抽象层的一部分，而不是让前端应用程序直接写入表。

与大多数 SQL Server 脚本一样，我通常会花费大量时间将头撞在砖墙上以使其完全正常工作。（通过搜索本网站和其他网站上的过去帖子获得了不小的帮助。）

批量插入是否会读取标题行以确定要写入哪些字段？不，我必须使用格式文件（并希望表结构/顺序永远不会改变）或使用仅包含数据文件中的列的临时表。暂存表在将数据复制到实际表之前接收数据。

如果您省略了目标表中的单个列（即使是具有默认值的列）并且不使用格式文件怎么办？您会收到不言自明的错误消息“无法从链接服务器“（null）”的 OLE DB 提供程序“BULK”中获取一行。” 使用上述临时表，省略任何不在数据源中的列，可以解决这个问题。

没关系，我可以忍受。这不是可怕的部分。这是。

如果暂存表仍有任何定义为 NOT NULL 的字段，但该列的数据源行为 null，则不会出现错误。根据我的测试，如果您有（比如说）5 行数据并且第 3 行在 NOT NULL 字段中缺少数据，那么您不会收到错误消息，但会收到“4 行已更新”消息。如果您期望 5 行并交叉检查受影响的行数以确保存在预期的行数，这一切都很好，但这些文件的长度会有所不同，批量插入不会告诉您它实际读取了多少行。更糟糕的是，在某些情况下，一行中缺少的字段也会阻止下一个（有效）行的上传。

明显的解决方案？从暂存表中删除 NOT NULL 约束并处理暂存表和真实表之间的接口中的任何空异常。但是...我担心的是，在我还没有遇到的其他情况下，这段 cro...ode 可能会做同样的事情。也就是说，读取一行，未能将其写入暂存表，并且不抛出异常，因此没有人知道数据丢失，直到他们去寻找它并发现它不存在。甚至 Access 也有比这更好的文本导入选项。

那么，我的问题是......是否有更好（更可靠）的方式来处理将可变行长度文本文件上传到 SQL Server 而不必依赖前端应用程序来完成它？

提前感谢您的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T23:16:16.120

.NET`SqlBulkCopy`将在将数据传输到临时表时为您提供更多控制，并且仍然提供出色的性能。

现在，考虑到您想要服务器本身的所有逻辑，也许以下策略可能对您有用：

保持暂存表没有任何可能使您的流程失败的限制。在其上创建其他列，例如`IsValid`, 加一`ErrorMessage`列。

然后编写一个存储过程来验证每一行的数据，检查条件、缺失值、文本长度以及您可能想要强制执行的任何自定义业务规则。

例如，每个验证都可以是登台表的单个`UPDATE`语句，设置`IsValid`或`ErrorCode`加号`ErrorMessage`，在其`WHERE`子句上具有条件。

运行所有验证`UPDATE`语句后，您应该有一个对导入有效的行子集（标记为 IsValid 的行）和其他行，您可以在这些行上清楚地确定问题的原因并逐行记录或通知用户.

在频繁导入无效数据的情况下，该策略被证明是非常有效的。

现在，如果您要并行运行多个导入进程，那么您可能需要根据一些“进程标识符”划分暂存表中的导入数据并可能对其进行索引，以避免在运行质量时在进程之间锁定对数据的验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T22:47:13.227

System.Data.Client 中的[SqlBulkCopy](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy.aspx)类应该为您提供更多控制和反馈。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T23:52:36.823

即使处理不完整的文件仍然很困难，我仍然会为此使用 SSIS。它为您提供了很多控制和良好的性能。

# firefox - Firefox 快速版本更改

> ID：11129254
> 
> 赞同：0
> 
> 时间：2012-06-20T22:43:58.593
> 
> 标签：firefox, version

为什么 Firefox 主要版本在 2011 年 4 月（FF4）之后开始增长如此之快？它现在是第 13 版，并且正在快速增长。

我阅读了有关它的 Wikipedia 文章，其中说他们希望用户始终拥有最新版本的 Firefox。但是为什么次要版本不合适呢？如 4.1、4.14 等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T22:46:14.820

这是为了跟上 chromes 的更新命名方案，本质上是自然地认为更大的变化是通过重大修订更改而不是次要更改进行的。

# javascript - Can't get Rails return value in jQuery

> ID：11129261
> 
> 赞同：1
> 
> 时间：2012-06-20T22:44:32.403
> 
> 标签：javascript, jquery, ruby-on-rails, ruby-on-rails-3.1

I have a Rails method that just returns a string, and for some reason, I can't seem to get the `success` return value in the JavaScript.

```
def count
  render :nothing => true
  return "success"
end

$.post("/home/count",
  function(data) {
    document.getElementById("test_call_button").value = 'Calling...' + count;
  }); 
```

The object that is returned by `$.post("/home/count");` has a `responseText` of `" "`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T22:48:15.287

The return value of a controller action is not sent back to the requester; what you render is, and in this case you're specifically rendering `:nothing`.

If you want to see the result in your javascript, change your render line to

```
render :text => 'success' 
```

I would urge you to render a json object as your response though, which makes it trivial to add other fields in the future should they be necessary.

Also make sure to check out the [Rails rendering guide](http://guides.rubyonrails.org/layouts_and_rendering.html).

# java - 在 Robotium 中使用资源 ID

> ID：11129262
> 
> 赞同：0
> 
> 时间：2012-06-20T22:44:37.207
> 
> 标签：java, android, testing, automation, robotium

我正在使用 Robotium 对 OEM 应用程序进行一些自动化测试，但在使用资源 ID 时遇到了问题。据我了解，要使用资源 ID，您需要执行以下操作：

```
ImageView imageView = (ImageView) solo.getView(R.id.appicon); 
```

我的问题是：我是否必须将 AUT 资源文件夹导入我的测试项目才能在测试时使用资源 ID？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T05:32:17.950

您可以在不导入 AUT 资源文件夹的情况下使用它，如下所示：

```
Activity act=solo.getCurrentActivity();
ImageView imageView = (ImageView) solo.getView(act.getResources().getIdentifier("appicon", "id", act.getPackageName())); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T19:57:35.030

为了在 Robotium 中使用资源 ID，您需要确保将 AUT 添加到测试项目构建路径中。

# android - 无法选择电话号码与 IN 子句匹配的所有联系人

> ID：11129264
> 
> 赞同：3
> 
> 时间：2012-06-20T22:45:05.270
> 
> 标签：android, android-contacts, android-contentprovider, android-sqlite

我试图弄清楚如何使用电话号码列表查询 Android 联系人内容提供程序，以检索电话号码与该列表中的项目匹配的联系人。在直接的 SQL 中，我会使用类似的东西：

> `SELECT * FROM PHONES WHERE NUMBER IN ('1234','1235')`

我不能，因为我使用的是 CP API，而且我似乎遗漏了一些东西。这是`onCreateLoader()`查询的一个片段。此查询的结果中没有返回任何记录，但我知道数据库中的联系人存在这些电话号码。我认为没有找到记录，因为电话号码存储在数据库中，格式如下：

> `+1 425-555-1212`

我不知道是否有办法查询 CP 并让它`IN()`根据未格式化的数据评估我的查询列表。这是`onCreateLoader()`查询：

```
public Loader<Cursor> onCreateLoader(int id, Bundle args) {
    String[] projection = new String[] {    
            ContactsContract.CommonDataKinds.Phone._ID,
            ContactsContract.CommonDataKinds.Phone.CONTACT_ID,
            ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME,
            ContactsContract.CommonDataKinds.Phone.LABEL,
            ContactsContract.CommonDataKinds.Phone.LOOKUP_KEY,
            ContactsContract.CommonDataKinds.Phone.NUMBER};
    return new CursorLoader(
            getActivity().getApplicationContext(), 
            ContactsContract.CommonDataKinds.Phone.CONTENT_URI,
            projection,
            ContactsContract.CommonDataKinds.Phone.NUMBER+" IN ('4255551212','4255551213')",
            null,
            null);
} 
```

使用`PhoneLookup`（如下所示）与上一个查询中的一个电话号码实际上会产生正确的联系人匹配，所以我认为必须有一种方法可以做到这一点。不幸的是，`PhoneLookup`似乎无法处理电话号码列表，而只能处理一个电话号码：

```
public Loader<Cursor> onCreateLoader(int id, Bundle args) {
    String[] projection = new String[] {
            ContactsContract.PhoneLookup._ID,
            ContactsContract.PhoneLookup.DISPLAY_NAME,
            ContactsContract.PhoneLookup.LABEL,
            ContactsContract.PhoneLookup.LOOKUP_KEY,
            ContactsContract.PhoneLookup.NUMBER};
    return new CursorLoader(
            getActivity().getApplicationContext(),
            Uri.withAppendedPath(ContactsContract.PhoneLookup.CONTENT_FILTER_URI, Uri.encode("4255551212")),
            projection,
            null,
            null,
            null);
} 
```

有没有办法做到这一点，或者是否有另一种方法可以产生相同的结果？结果是：

*   **给定电话号码列表，选择列表中具有电话号码的所有联系人**

有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T21:08:41.883

首先，我认为没有办法在`ContactsContract.PhoneLookup`.

其次，正如您所说，存储的数字`ContactsContract.CommonDataKinds.Phone`通常是格式化的。它确定两个电话号码是否相等的方式是基于[PhoneNumberUtils.compare(String num1, String num2)](http://developer.android.com/reference/android/telephony/PhoneNumberUtils.html#compare%28java.lang.String,%20java.lang.String%29)。[通过阅读这里](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/2.1_r2/android/telephony/PhoneNumberUtils.java#PhoneNumberUtils.compareStrictly%28java.lang.String,java.lang.String,boolean%29)的源代码，您可能会想出一些想法，如何生成一个数字的变体列表并将它们全部包含在`IN ('num1', 'num2', ...)`

如果您有很多数字要查找（即几乎与整个联系人大小相同），我建议查询所有 NUMBER 和您想要的数据`ContactsContract.CommonDataKinds.Phone`并将它们存储在`HashMap<NumberString, TheDataYouWant>`. （在此之前，您需要创建一个`NumberString`包含字符串的类并覆盖`compareTo()`要返回的方法`PhoneNumberUtils.compare(this.string, anotherNumber.string);)`。然后您可以在`HashMap`.

# ios - 如何在 iOS 和合适的框架中为 Json 框架添加 project.pbxproj 文件

> ID：11129265
> 
> 赞同：0
> 
> 时间：2012-06-20T22:45:05.427
> 
> 标签：ios, json, frameworks, pbxproj

我正在使用 xcode 4，编译器版本 LLVM GCC 4.2。

我一直在尝试不同版本的 Json 框架，希望它们中的任何一个都可以被包含在内而不会出错。首先我尝试了 SBJson 3.1，但它给了我近 170 个警告和一些错误，我找不到成功的解决方案。然后我尝试了 Json 2.3.1(iphone) 、 2.3.2 和最后的 SBJson 3.0 ... 对于所有这 3 个版本，Xcode 因缺少 project.pbxproj 文件而引发错误：

`Project/Users/<username>/Desktop/<project name>/SBJson_v3.0/__MACOSX/SBJson_v3.0/SBJson.xcodeproj cannot be opened because it is missing its project.pbxproj file.`

我通过以下步骤找到了这个： [Missing project.pbxproj file](https://stackoverflow.com/questions/3054063/missing-project-pbxproj-file)

*我的问题是我将如何以及在哪个文件夹中添加此文件*？我只是试图将它复制到 SBJson_v3.0 文件夹中并将其添加到项目中，但它仍然没有检测到这个文件。

它也在 SBJson 3.0`DisplayPretty.xcodeproj`和中引发相同的错误`TweetStream.xcodeproj`

请任何人都可以提供适当的步骤来消除此错误...？并且请告诉我哪个框架最适合我的 xcode 及其编译器？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T23:38:51.797

您的错误听起来与您有关，包括您下载的内容过多。这些错误可能与演示相关，并且包含在 SBJson 包中，您不应该在项目中使用这些错误。如果您只想要 SBJson 功能，我建议您直接将 SBJson 文件添加到您的项目中。您可以复制 /Classes 文件夹下的所有内容并构建。

# php - PHP mySQL 获取表的所有标题和值

> ID：11129266
> 
> 赞同：0
> 
> 时间：2012-06-20T22:45:10.980
> 
> 标签：php, mysql, function

我已经连接到数据库的一个表，并通过使用唯一的列标题“名称”找到了一行；

我现在想要一个函数，它允许我获取每个标题的值。然后每个例如一个回声。`$post->header1; $post->header2; post->header3;`

ETC...

我们如何做到这一点

编辑

这返回一个字段。为每个人做这件事似乎过于昂贵。我们能不能把它们全部放在一个数组或类似的东西里……怎么办？

```
function get($table,$name,$field){
    $the_page = mysql_query("SELECT * FROM $table WHERE name = '$name'"); while($row = mysql_fetch_array($the_page)) { return $row[$field]; }
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T23:06:54.110

获取 mySQL 数组作为变量，然后在变量中返回结果，其中表名作为相关列。

```
$find = mysql_query("SELECT * FROM $table WHERE name = '$post'"); 
    $find = mysql_fetch_array($find);

<?php echo $find['title'];?> 
```

# .net - 以编程方式从现有程序集中删除自定义属性

> ID：11129267
> 
> 赞同：3
> 
> 时间：2012-06-20T22:45:13.427
> 
> 标签：.net, clr, .net-assembly

我正在使用 System.Reflection.Emit 创建一个新程序集 A，它从现有程序集 B 调用方法。

B 中的方法用一些自定义属性注释，我想以编程方式删除它们。我无权访问生成 B 的源代码。

我在 .NET 框架中找不到记录的方式来执行此操作。任何指针？

万分感谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T22:49:35.843

我不相信这是可能的。属性被编译成 IL。以编程方式删除它们就像尝试以编程方式删除方法或属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-04T08:57:25.083

您可以查看[PowerShellArsenal](https://github.com/mattifestation/PowerShellArsenal/blob/master/README.md)。
它有一个用于删除 SuppressIldasmAttribute 的脚本。

我没有看过它，但我猜你可以使用用于删除任何属性的代码。

> Remove-AssemblySuppressIldasmAttribute
> 
> 从 .NET 程序集中去除 SuppressIldasmAttribute 属性。

它使用[dnlib](https://github.com/0xd4d/dnlib)删除[属性](https://github.com/mattifestation/PowerShellArsenal/blob/fa095cd1fe01a4850943d67bc250e70dffae8602/MalwareAnalysis/dotNetMalwareAnalysis.ps1#L499)。

# mysql - 使用 Zend 服务器从命令行执行 MySQL

> ID：11129268
> 
> 赞同：0
> 
> 时间：2012-06-20T22:45:28.783
> 
> 标签：mysql, zend-server

编辑：仅供参考-这些查询将发送到不同服务器上的 MySQL 数据库。我没有在我的 Mac 上查询 MySQL 数据库。但是，它使用的是 Zend 服务器安装的 LOCAL mysql 客户端。

更新：这似乎与 Zend Server 的 MySQL 配置有关。我受够了并为 Mac 安装了 MySQL 5.5.25 DMG。如果我在 Mac 上使用 mysql 客户端的新路径，查询将正常运行。

我的 Mac 上有 Zend Server Community Edition。

我需要从终端命令行（不是 mysql 命令行）执行 MySQL 查询。在我所有带有传统 LAMP 堆栈的服务器（不是 Zend 服务器）上，我可以执行如下查询：

```
$ mysql -u USER_NAME -p PASSWORD -hSERVER_NAME -PTHE_PORT -e "SELECT NOW();" 
```

在我所有的其他服务器上，我得到这个响应：

```
+---------------------+
| NOW() |
+---------------------+
| 2012-06-20 18:34:21 | 
+---------------------+
$ 
```

在带有 Zend 服务器的 Mac 上，我得到：

```
ERROR 1049 (42000): Unknown database 'NOW();' 
```

如果我在非 Zend 服务器上使用任何其他命令，例如这个命令，我会得到一个有效的响应：

```
mysql -u USER_NAME -p PASSWORD -hSERVER_NAME -PTHE_PORT -e"use stp_downloads; select * from downloads limit 2;"
+--------------+-------------+---------------------+-----------------+ | downloads_id | statuses_id | download_stamp | order_number |
+--------------+-------------+---------------------+-----------------+ | 10001 | 5 | 2011-04-04 22:17:29 | DOWN00000004753 |  | 10002 | 5 | 2011-04-04 22:29:06 | DOWN00000004754 | 
+--------------+-------------+---------------------+-----------------+ 
```

如果我在带有 Zend 服务器的 Mac 上运行该命令，我会得到：

```
/usr/local/zend/mysql/bin/mysql.client Ver 14.14 Distrib 5.1.54, for apple-darwin9.8.0 (i386) using readline 5.1
Copyright (c) 2000, 2010, Oracle and/or its affiliates. All rights reserved.
This software comes with ABSOLUTELY NO WARRANTY. This is free software,
and you are welcome to modify and redistribute it under the GPL v2 license
Usage: /usr/local/zend/mysql/bin/mysql.client [OPTIONS] [database]
....... 
```

其次是所有使用信息。

为什么 Zend Server 上的 MySQL 不能使用 -e 或 --execute 正确处理 SQL 语句？

我究竟做错了什么？？

谢谢，贾斯汀

# php - Mongo/PHP 中的 IF OR 语句

> ID：11129270
> 
> 赞同：1
> 
> 时间：2012-06-20T22:45:39.707
> 
> 标签：php, parsing, mongodb, sorting

我有一个关于网站访问者信息的集合，每个访问者都有关于他们的各种信息，包括销售人员是否“锁定”了他们。目前我有以下代码：

```
$db = $conn->Surreal;
$collection = $db->visitors;
$criteria = array(
    'locked_by' => $_REQUEST['ownerkey'],
);
$criteriat = array(
    'locked_by' => null,
);
$cursor = $collection->find($criteria);
$cursort = $collection->find($criteriat);
//echo $doc->count() . ' document(s) found. <br/>';
foreach ($cursor as $doc) {
    //List all  
    if($doc['locked_by'] ==null) $doc['locked_by'] = " ";
    $pieces = explode("&&", $doc['location']);
    echo('Surreal - '.$doc['name'].'//'.$doc['uuid'].'//'.$doc['uuid'].'//'.$doc['locked_by'].'//'.$doc['location'].'*');       
}
foreach ($cursort as $doc) {
    //List all  
    if($doc['locked_by'] ==null) $doc['locked_by'] = " ";
    $pieces = explode("&&", $doc['location']);
    echo('Surreal - '.$doc['name'].'//'.$doc['uuid'].'//'.$doc['uuid'].'//'.$doc['locked_by'].'//'.$doc['location'].'*');       
} 
```

基本上使用两个 foreach 语句来回显信息。我可以以某种方式改为使用查询来基本说

```
if(locked_by == "RANDOM" || locked_by == null) 
```

?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T22:55:11.683

嗯，MongoDB在查询中支持OR条件，从1.5.3版本开始：

```
db.foo.find( { $or : [ { a : 1 } , { b : 2 } ] } ) 
```

...所以它应该通过这样的方式实现：

```
$criteria = array(
    '$or' => array(array('locked_by' => 'RANDOM'), array('locked_by' => null))
); 
```

问题是您使用的驱动程序是否支持此类查询。我在使用这种特殊类型时遇到了一些困难，但那是一年前的事了。我想事情可能会变得最好。)

更新：至少[在评论中](http://www.php.net/manual/en/mongocollection.find.php)有一个类似的查询，所以我猜事情确实改变了最好的。)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-29T12:09:02.690

raina77ow 的回答应该足够了，但我总是发现以下页面对于确定 or 语句和大于等所需的内容很有用。

[MongoDB 运算符](http://docs.mongodb.org/manual/reference/operator/)

出于 PHP 的目的，您需要将其更改为数组形式，但语法相似并且是一个很好的参考。

# spring - 无法在 web 应用程序（tomcat、Spring MVC）中找到 witten 文件

> ID：11129278
> 
> 赞同：0
> 
> 时间：2012-06-20T22:47:03.817
> 
> 标签：spring, tomcat, spring-mvc, io, jfreechart

我正在使用 JFreeChart 在我的 Web 应用程序中生成一些报告，我使用 JFreechart 构建图表并将其保存为图像，但我从未在我的 Tomcat 目录中找到该图像。

我试图打印工作目录，它给了我 Tomcat 根目录，所以我想知道为什么图像从未写入该目录。

这是我的服务方法：

```
public DefaultPieDataset generateChartEquipementsByDepartementDataset(){
    DefaultPieDataset pieDataset ;
    pieDataset = convertMapToDataset(reportsDao.getEquipementsByDepartementDataset()) ;
    JFreeChart chart = ChartFactory.createPieChart(
            "% Equipements par departement",
            pieDataset,
            true,
            true,
            false
            ) ;
    try{
    ChartUtilities.saveChartAsJPEG(new File("/chart.jpeg"), chart, 400, 400) ;
    }catch(Exception ex){}

    return pieDataset ;
} 
```

当我测试它时，它会在我的应用程序的根目录中写入图像，但从不在 tomcat 中。这里是控制器。

```
@RequestMapping(value="/reports")
public String reportsHandler( Model model ) {
    reportingService.generateChartEquipementsByDepartementDataset() ;
    String curSession = System.getProperty("user.dir") ;
    model.addAttribute("curSession", curSession) ;
    return "home" ;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T22:58:12.147

Root ( `/`) 不指向 Web 应用程序的根路径，您需要使用[ServletContext.getRealPath()](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletContext.html#getRealPath%28java.lang.String%29)获取“翻译路径” ，例如

```
... new File(request.getServletContext().getRealPath("/chart.jpeg")) .... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T23:44:31.890

你扔掉你的例外。将其更改为不捕获它，或者至少记录它以查看发生了什么。

我怀疑您在尝试写入该目录时遇到权限问题。

# c - 从 Linux 中的 Bio 结构散列数据

> ID：11129282
> 
> 赞同：1
> 
> 时间：2012-06-20T22:47:15.910
> 
> 标签：c, linux, encryption, io

我的目标是读取存储在 bio 中的数据（假设它用于写操作）并计算其 md5 指纹。数据可以是任何东西。我做了几次尝试。这是我最近的尝试：

```
void fingerprint(struct bio * bio, unsigned char * result)
{
char * place;
char * cpy;
int total;
struct buffer_head * bh;
struct scatterlist sg;
struct hash_desc desc = {
    .tfm = crypto_alloc_hash("md5", 0, CRYPTO_ALG_ASYNC),
    .flags = CRYPTO_TFM_REQ_MAY_SLEEP
};
total = 0;

cpy = kmalloc(sizeof(char) * bio->bi_io_vec[i].bv_len, GFP_KERNEL);
bh = (struct buffer_head *)bio->bi_io_vec[i].bv_page->private;
    place = bh->b_data + bio->bi_io_vec[i].bv_offset;

DPRINTK("%u", bio->bi_io_vec[i].bv_offset);
DPRINTK("%u", place);

memcpy(cpy, place, bio->bi_io_vec[i].bv_len);
DPRINTK("%x", place);
DPRINTK("%x", cpy);

sg_init_one(&sg, (u8 *)cpy, bio->bi_io_vec[i].bv_len);
crypto_hash_init(&desc);
crypto_hash_update(&desc, &sg, bio->bi_io_vec[i].bv_len);
total += bio->bi_io_vec[i].bv_len;
DPRINTK("%u", bio->bi_vcnt);
DPRINTK("%u", total);

crypto_hash_final(&desc, result);
kfree(cpy);
} 
```

哈希的结果非常相似，如果不完全相同的话，它们总是偶数。我将结果打印为 long long 和十六进制。为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T16:43:08.480

你需要测试你的代码。将您的代码减少到 MD5 最小值，并尝试一些测试向量。

"" -> d41d8cd98f00b204e9800998ecf8427e

“敏捷的棕狐跳过懒惰的狗”-> 9e107d9d372bb6826bd81d3542a419d6

“敏捷的棕色狐狸跳过了懒狗。” -> e4d909c290d0fb1ca068ffaddf22cbd0

（请注意第三个示例中的额外句号。）

一旦确定 MD5 工作正常，然后逐渐重新引入代码的其他部分并定期重新检查。

# php - 下拉列表在 Firefox 上消失

> ID：11129285
> 
> 赞同：0
> 
> 时间：2012-06-20T22:47:41.340
> 
> 标签：php, css, firefox

我只有在 Windows 上的 Firefox（在 Mac 上的 FF 上工作正常）、Chrome、IE、Opera、Safari 上的下拉列表有问题。

当我单击下拉列表并移动鼠标进行选择时，菜单突然关闭。

我不能选择任何东西。

这是我的代码的一部分。

CSS：

```
.table {
   background:#ffffff;
}
.table ul {
   display: block;
   float:left;
   margin:0;
   padding:0;
   border:1px solid #C9C9C9;
}
.table ul.categ {
   width: 157px;
}
.table ul li {
   height:24px;
   list-style:none;
   padding:5px 10px;
}
.table ul li.title {
   font-weight:bold;
   background:#333;
   color:#fff;
}
.table ul li.even {
   background:#fff;
}
.table ul li.odd{
   background:#FFFFE6;
} 
```

这是我的 PHP 代码：

```
<form>
    <div class="table">
        <ul>
            <li class="title">Titles</li>
            <li class="even">
                <select name="titles[]">
                    <option value=""></option>
                    <option value="title1">Title 1</option>
                    <option value="title2">Title 2</option>
                </select>
            </li>
        </ul>
    </div>
</form> 
```

演示：[jsFiddle](http://jsfiddle.net/GASsx/)

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T22:50:41.830

你在`<`你的第一个选项面前失踪了。不确定这是否会导致您的问题。另外，你要结束你的`<form>`标签吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T22:51:48.930

您可能需要在 Windows 上为 FF 破解 CSS。这里有一篇关于[使用 CSS 仅针对 Firefox的精彩帖子](https://stackoverflow.com/questions/952861/targeting-only-firefox-with-css)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T06:49:29.853

发现了问题，这里是我的修复代码部分。希望它可以帮助其他人。

```
.table ul li.even {
    background:#fff; 
    position:relative; /* this fix the unclickable dropdown list */
} 
```

# java - 从 HttpResponse 获取 json

> ID：11129286
> 
> 赞同：32
> 
> 时间：2012-06-20T22:47:51.570
> 
> 标签：java, android, json

```
HttpClient httpclient = new DefaultHttpClient();
HttpPost httppost = new HttpPost("http://my.server:8080/android/service.php");

List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);
nameValuePairs.add(new BasicNameValuePair("action", "getjson"));
httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

HttpResponse response = httpclient.execute(httppost); 
```

`service.php`生成一个 json 字符串。我将如何从我的`response`? 顺便提一句; 我已经包含了`GSON`图书馆，我可以使用其中的任何方法吗？

类似于这个的解决方案看起来很丑陋，imo: [best way to handle json from httpresponse android](https://stackoverflow.com/questions/11081275/best-way-to-handle-json-from-httpresponse-android)

有很多更好的方法，对吧？

任何帮助表示赞赏，谢谢

* * *

**更新：**

```
String json = EntityUtils.toString(response.getEntity()); 
```

似乎可以解决问题。只有一个小问题：字符串用括号括起来`[]`。我应该手动删除它们吗？它们由 php:s 生成`json_encode()`

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2014-03-25T03:16:03.877

我认为您遇到的问题与我刚刚遇到的问题相似。如果你运行：

```
字符串 json_string = EntityUtils.toString(response.getEntity());
JSONObject temp1 = new JSONObject(json_string);

```

上面的代码会抛出异常，看起来 JSON 数组括号是罪魁祸首。但是可以将 JSON 数组作为顶级元素！您只需要使用 JSONArray() 而不是 JSONObject：

```
字符串 json_string = EntityUtils.toString(response.getEntity());
JSONArray temp1 = new JSONArray(json_string);

```

因此，您必须知道在您的 JSON 代码中获取的是 JSONArray 还是作为 JSONObject 的单个字典。

如果您习惯于 iOS/Objective-C JSON 解析库，它们使用相同的顶级元素来处理 json 字典和 json 数组，因此迁移到 JAVA/Android 世界让我感到困惑，因为有两种类型来处理 JSON，具体取决于顶层返回。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T23:09:08.443

使用此类，您可以从服务器或资产文件夹中获取 JSON 数据。它可以很容易地更改为只有一个或另一个。如果您需要适配器，请使用在[getHub 上创建的 jgilfelt](https://github.com/jgilfelt/android-jsonarrayadapter)。

```
@Override
    public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);

        Bundle getArgs = this.getArguments();
        String URI = getArgs.getString(KEY_URI);//OR YOU CAN HARD CODE THIS OR GET THE STRING ANYWAY YOU LIKE.

        new GetJSONTask().execute(URI);
    }

    class GetJSONTask extends AsyncTask<String, Integer, String> {

        protected String doInBackground(String... arg0) {

            String uri = arg0[0];

            InputStream is = null;

            if (uri.contains("http") == true) {// Get JSON from URL
                try {
                    DefaultHttpClient httpClient = new DefaultHttpClient();
                    HttpPost httpPost = new HttpPost(uri);
                    HttpResponse httpResponse = httpClient.execute(httpPost);
                    HttpEntity httpEntity = httpResponse.getEntity();
                    is = httpEntity.getContent();

                    BufferedReader rd = new BufferedReader(new InputStreamReader(is, "UTF-8"));
                    while ((line = rd.readLine()) != null) {
                        json += line;
                    }
                    rd.close();
                    return json;
                } catch (Exception e) {
                    e.printStackTrace();
                    return null;
                }
            } else {// Get JSON from Assets

                Writer writer = new StringWriter();
                char[] buffer = new char[1024];

                try {
                    InputStream jsonFile = getActivity().getAssets().open(uri);
                    Reader reader = new BufferedReader(new InputStreamReader(jsonFile, "UTF-8"));
                    int n;
                    while ((n = reader.read(buffer)) != -1) {
                        writer.write(buffer, 0, n);
                    }
                    jsonFile.close();
                } catch (IOException e) {
                    e.printStackTrace();
                }
                json = writer.toString();
                // return JSON String
                return json;
            }
        }

        @Override
        protected void onPostExecute(String result) {
            try {
                showData(result);
            } catch (JSONException e) {
                e.printStackTrace();
                Toast.makeText(getActivity(), "something went wrong", Toast.LENGTH_SHORT).show();
            }
        }
    }

    private void showData(String json) throws JSONException {
        JSONObject o = new JSONObject(json);
        JSONArray data = o.getJSONArray("results");
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T23:16:36.390

问题出在我的 php 文件中。从 json 编码对象中删除容器数组使我的 java 代码工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-20T23:02:17.010

如果我从我的 Web 服务返回一个 JSON 字符串，我通常希望将它返回到一个 JSON 对象，如下所示：

```
String response = client.getResponse();

    if (responseCode == 200)
    {                   
         JSONObject obj = new JSONObject(response);                                                             
    } 
```

# java - 课间互动

> ID：11129289
> 
> 赞同：0
> 
> 时间：2012-06-20T22:48:01.260
> 
> 标签：java

我不确定标题是否准确。我有几个像电视这样的课程，我想在一个课程中使用所有这些课程。是否可以在另一个类中调用 Tv 中的方法？如果是这样，我是否需要修改 Tv 类中的构造函数？（TS是一个接口）。

```
class Tv implements TS{

    private String v;

    public Tv(String v){
            this.v = v;
    }

    public void open(){
            System.out.println("open");
    }

        public void volume(String v){
        ...
        }

}

public class TvSet{
    public static void main(String args[]){
        Tv t = new Tv("+");
    }
} 
```

我试过这个：

```
public class RunTv {
    Remote r = new Remote("+");
    Tv t = new Tv("+");
    t.open();
} 
```

IDE 提醒我“ `identifier expected after this token`.” 我应该修改`Tv`还是`RunTv`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T22:50:09.630

是的，如果其中包含方法定义`public`，则意味着您可以`Tv`在其他类中创建对象后调用这些方法。

`public`是一个访问修饰符，但是公共方法只能在创建该特定类的对象后调用。像这样，

```
Tv tv = new Tv("A", "B");
tv.open(); 
```

阅读[文档](http://docs.oracle.com/javase/tutorial/java/javaOO/usingobject.html)也很棒，它将指导您如何逐步编写 Java 程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T23:20:03.623

第一个问题已经由冷冻豌豆的猫头鹰和罗迪回答了，但总结一下：是的，您可以调用另一个类中的方法，只要它们是公共的并且您有一个包含该方法的类的实例。

对于“ `identifier expected...`”错误的其他问题，您应该更改`RunTv`.

您不能`t.open()`在方法块之外调用。如果你把它改成这样：

```
public class RunTv {
    public void openNewTv()
    {
       Remote r = new Remote("+");
       Tv t = new Tv("+");
       t.open();
    }
} 
```

然后，每当您调用该`openNewTv`方法时，它将创建一个新的实例，`Remote`然后`Tv`它将调用实例`open`中的方法`Tv`。要调用，您可以在您的方法中`openNewTv`创建一个实例，如下所示：`RunTv``main`

```
public class TvSet{
    public static void main(String args[]){
        Tv t = new Tv("+");
        RunTv runTv = new RunTv();
        runTv.openNewTv();
    }
} 
```

如果您不想每次必须打开一个新实例时都创建一个新实例，`Tv`您可以将方法设为静态，这意味着它不属于任何实例，而是属于类本身（为了更好地理解这些事情，您应该阅读[此](http://docs.oracle.com/javase/tutorial/java/javaOO/classvars.html)) 你可以像这样使方法静态：

```
public class RunTv {
    public static void openNewTv()
    {
       Remote r = new Remote("+");
       Tv t = new Tv("+");
       t.open();
    }
} 
```

现在您可以调用`openNewTv`而无需创建这样的实例`RunTv`：

```
public class TvSet{
    public static void main(String args[]){
        Tv t = new Tv("+");
        runTv.openNewTv();
    }
} 
```

希望这可以帮助。:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T22:54:09.683

如果您的方法被定义为`public`- 就像在您的示例中一样`public void open()`，您可以从另一个类中调用电视对象上的这些方法。

所以在你的`TvSet`课堂上，在你的主要方法中：

```
public class TvSet {
    public static void main(String[] args) {
        Tv t = new Tv("+", "+");
        t.open(); // this is valid
    }
 } 
```

此外，如果两者`TvSet`和`Tv`都在同一个包中，您可以在您的方法上使用默认访问修饰符而不是`public`-- 例如。`void open()`而不是`public void open()`.

如果`Tv`有这样的方法：

```
private void close() { 
    System.out.println("CLOSED"); 
} 
```

然后你*不能*这样做：

```
public class TvSet {
    public static void main(String[] args) {
        Tv t = new Tv("+", "+");
        t.close(); // this WILL NOT work
    }
 } 
```

这是因为方法是`private`，而私有方法只能在该类中调用。

# c# - 解析具有重复根元素的 XML

> ID：11129291
> 
> 赞同：-1
> 
> 时间：2012-06-20T22:48:15.517
> 
> 标签：c#, xml, regex

我正在尝试以编程方式清除 C# .NET 4.0 中具有重复根元素的无效 XML。我想要做的是将所有内部元素合并到一个根元素中并删除重复的根，这样

```
<a>
    <b></b>
</a>
<a>
    <c></c>
</a> 
```

变成

```
<a>
    <b></b>
    <c></c>
</a> 
```

但是，重复的根元素也可能出现在内部 XML 中。在这种情况下，我们不想替换它，所以

```
<a>
    <a></a>
    <b></b>
</a>
<a>
    <c></c>
    <a></a>
</a> 
```

变成

```
<a>
    <a></a>
    <b></b>
    <c></c>
    <a></a>
</a> 
```

此外，不保证重复的根元素始终为`<a>`; 它可以有任何名称。

到目前为止，我一直在尝试考虑某种优雅的正则表达式来完成此任务，例如`/<((.|\n|\r)*?)>(.|\n|\r)*<\/\1>/`，但这样做的问题是内部 XML 上的贪婪匹配匹配太多，而内部 XML 上的非贪婪匹配匹配太少。

我希望我不必求助于创建堆栈来计算打开和关闭标签，以确定我何时回到文档的根目录。我正在寻找一种简单而优雅的方法来解决这个问题。

如果其中一个处理这种情况，开源第三方库可能是可接受的解决方案，但我宁愿避免使用它们。

有没有人有任何想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-20T23:07:32.553

将 XML 实际读取为 XML 可能会更好......您应该能够创建[ConformanceLevel](http://msdn.microsoft.com/en-us/library/6bts1x50.aspx)设置为 Fragment 的阅读器，并将所有片段作为普通 XML 读取。而不是使用普通的 XML 处理来选择/复制 Xml 节点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T22:56:11.570

有人有一个很好的答案，他们刚刚删除了。获取根节点的名称，然后删除所有这些节点。无论第一个节点是什么，都应该很容易获得第一个节点的名称。

这将使文档基本上按照您想要的方式保留，然后将整个内容重新包装在其中一个节点中。完毕。

# c - 在 fork() 之后使用 setuid()

> ID：11129296
> 
> 赞同：2
> 
> 时间：2012-06-20T22:48:35.437
> 
> 标签：c, connection, fork, setuid

我有一个服务器正在处理不同用户的请求。连接到客户端后，我分叉了一个子进程并用于`setuid()`切换到客户端用户。看起来它还设置了父级的 uid。

如何仅为子进程设置 uid？

* * *

**[编辑]**我把所有东西放在一个小例子中，它工作正常。感谢您的提示`fork()`；

```
#include <stdio.h>
#include <unistd.h>

int main() {
  int uid[] = { 11942, 11943 };
  char *file[] = { "user1", "user2" };

  int i = 0;
  for (i = 0; i < 2; i++) {
    printf("parent, i = %i\n", i);
    pid_t child = fork();
    if (child == 0) {
      printf("child, uid = %d\n", uid[i]);
      if (setuid(uid[i]) == -1) {
        perror("setuid(11942)\n");
      }

      FILE *f = fopen(file[i], "w");
      fclose(f);

      return 0;
    }
  }

  return 0;
} 
```

# sql - 查询中的 SQL 动态

> ID：11129306
> 
> 赞同：2
> 
> 时间：2012-06-20T22:49:29.943
> 
> 标签：sql

假设我们有两个表 Foo 和 Bar。我有一个关联表 Foo_Bar 用于 Foos 和 Bars 之间的多对多关系。

现在我基本上想要一个查询来选择与动态数量的 Bar 约束匹配的 Foos。我可以通过使用适当数量的连接动态生成查询来做到这一点：

```
SELECT *
FROM Foo F INNER JOIN
     Foo_Bar FB1 ON FB1.FooId = F.Id AND FB1.BarId= Y INNER JOIN
     Foo_Bar FB2 ON FB2.FooId = F.Id AND FB2.BarId= Z INNER JOIN
     --one inner join for each constraint 
```

我想知道是否有更简单的方法。我基本上想要这样的查询：

```
SELECT *
FROM Foo F
WHERE (Y, Z, ...) IN (SELECT BarId FROM Foo_Bar WHERE FooId = F.Id) 
```

当然，这不是有效的 SQL，但我想知道动态查询是否是实现所需结果的唯一合理可移植的方式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T22:54:50.440

根据您提供的信息，以下查询将获取您需要的数据：

```
SELECT *
FROM Foo F INNER JOIN
     Foo_Bar FB ON FB1.FooId = F.Id
WHERE FB.BarId IN (Y, Z, ...) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T23:25:46.583

我假设您想要一个关系除法查询。看到这个问题有很多方法可以做到这一点：[How to filter SQL results in a has-many-through relationship](https://stackoverflow.com/questions/7364969/how-to-filter-sql-results-in-a-has-many-through-relation)

@Erwin 的答案（针对 Postrgres）中还有性能测试，您会注意到动态方式（使用许多联接或许多`EXISTS`子查询或许多`IN`子查询）比仅使用变量表或列表的静态查询执行得更快。

在您的服务器中进行测试，但要确定您的数据。例如，MySQL 在子查询方面存在一些性能问题`IN`，所以我希望它在`JOIN`不同版本中执行得更快。

这是在您的表格中翻译的*“Erwin 1”*查询：

```
SELECT f.*
FROM   Foo f
JOIN   (
   SELECT FooId 
   FROM   Foo_Bar
   WHERE  BarId IN (Y, Z, ...)               --- your list or table here
   GROUP  BY FooId
   HAVING COUNT(*) = @N                      --- the size of this list or table
   ) fb ON fb.FooId = f.Id; 
```

# php - 用户通过身份验证后使用 jplayer 流式传输音频

> ID：11129307
> 
> 赞同：0
> 
> 时间：2012-06-20T22:49:32.770
> 
> 标签：php, javascript, jquery, cakephp, jplayer

我正在运行一个 cakePHP 应用程序。用户上传 mp3 录音，这些录音存储在我们的服务器上。然后他们可以稍后下载 .mp3 文件。

在允许用户下载文件之前，我使用 CakePHP MediaViews 对用户进行身份验证。

```
$this->check_authorization($timeslot);
$this->viewClass = 'Media';
$params = array(
  'id' => $id . '.mp3',
  'extension' => 'mp3',
  'path' => $_SERVER["DOCUMENT_ROOT"]."/../uploads" . DS,
        'download' => true,
        'cache' =>true
    );
$this->set($params); 
```

我还希望能够让他们从他们的帐户流式传输音频，并且正在尝试使用 jplayer 来做到这一点。有没有办法让 jplayer 访问未公开存储的音频文件？

目前我正在尝试让 jplayer 尝试通过 mediaView 访问音频，但它不起作用。代码在这里：

```
//Javascript
var myCirclePlayer = new CirclePlayer("#jquery_jplayer_1", {
  mp3: "/audio/stream/test.mp3",    
    }, {
    cssSelectorAncestor: "#cp_container_1"
});

//Cakephp /audio/stream
function stream($name) {
  $this->viewClass = 'Media';
  $params = array(
    'id' => $name,
    'extension' => 'mp3',
    'path' => $_SERVER["DOCUMENT_ROOT"]."/../uploads" . DS,
    'download' => false,
    'cache' =>true
  );
  $this->set($params);
} 
```

是否可以在使用 jplayer 流式传输之前对用户进行身份验证？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T00:42:38.953

书中有[一整章](http://book.cakephp.org/2.0/en/core-libraries/components/authentication.html)是关于身份验证的。

您使用 check_authorization() 之类的东西看起来您甚至还没有在 CakePHP 中发现授权和身份验证。

# mysql - 如何在带有 MySql 后端的 Django 中为 TextField 指定索引？

> ID：11129309
> 
> 赞同：6
> 
> 时间：2012-06-20T22:49:50.103
> 
> 标签：mysql, django, django-models

我在 Django 中定义了一个模型，看起来（部分）如下所示：

```
class Info(models.Model):
    information = models.TextField(max_length = 32, null = True, db_index = True) 
```

但是，当我尝试`syncdb`使用 MySql 后端时，我得到了`Failed to install index for app.Info model: (1170, "BLOB/TEXT column 'information' used in key specification without a key length")`

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-21T13:26:48.577

答案是将字段指定为 a `CharField`，而不是 a `TextField`。

```
class Info(models.Model):
    information = models.CharField(max_length = 32, null = True, db_index = True) 
```

# ruby-on-rails - Rails 测试哈希类型

> ID：11129310
> 
> 赞同：8
> 
> 时间：2012-06-20T22:49:56.420
> 
> 标签：ruby-on-rails, hash

在 Sinatra 中，我可以测试 some_object.class.name == "Hash"。现在，在提交之后，我必须对此进行测试，加上 == "ActiveSupport::HashWithIndifferentAccess"，我的代码才能正常工作。为什么会这样，我是否必须更新发生这种比较的所有地方，还是有更简单的方法？谢谢

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-06-20T22:56:15.677

来自[ActiveSupport::HashWithIndifferentAccess](http://as.rubyonrails.org/classes/HashWithIndifferentAccess.html)上的文档：

> 这个类有可疑的语义，我们只有这样才能让人们写 params[:key] 而不是 params['key'] 并且他们为两个键获得相同的值。

因此，它是一个继承自 Hash 的类，允许您将符号或字符串作为键传递并返回相同的值。

要修复（和清理）您的测试，您可以使用以下内容：

```
some_object.is_a? Hash 
```

如果它是 Hash 或 Hash 的后代，这将返回 true。

# iphone - UIView backgroundColor 与图像

> ID：11129316
> 
> 赞同：1
> 
> 时间：2012-06-20T22:50:31.697
> 
> 标签：iphone, ios, uiview, scrollview

我想知道如何将 UIView 的 backgroundColor 设置为**滚动视图纹理背景颜色**。

这是我计划实现它的方式，但我只是不确定 patternImage 叫什么。

```
jumpBarContainer.backgroundColor = [UIColor colorWithPatternImage:????] 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-20T22:59:11.417

```
jumpBarContainer.backgroundColor = [UIColor scrollViewTexturedBackgroundColor]; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-20T22:58:56.287

```
[UIColor scrollViewTexturedBackgroundColor] 
```

是你需要使用的。

# javascript - 编辑 jQuery 插件以匹配不同的 jQuery 版本

> ID：11129317
> 
> 赞同：0
> 
> 时间：2012-06-20T22:50:40.460
> 
> 标签：javascript, jquery

我已分配`jQuery.noConflict()`给`$jq`：

```
var $jq = jQuery.noConflict(); 
```

现在我想编辑一个 jquery 插件来使用 $jq。有很多代码采用以下样式：

```
(function($) { /* some code that uses $ */ })(jQuery) 
```

改成不能解决问题`$`。`$jq`我应该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T22:52:07.117

你不需要做任何事情。`$`是包装插件的函数的局部变量；它立即分配给`jQuery`，正如您在函数文字之后看到的那样：

```
})(jQuery) // Immediately calls the wrapper function with jQuery being passed
           // as the $ argument. 
```

# matlab - MatLab：整数输入的错误处理

> ID：11129319
> 
> 赞同：1
> 
> 时间：2012-06-20T22:50:48.113
> 
> 标签：matlab, error-handling, try-catch, user-input, validation

如何在 MatLab 中捕获用户在输入中输入字母和其他不是数字的内容时发生的错误：

```
width = input('Enter a width: '); 
```

我已经玩了一段时间的`try/catch`命令：

```
width = 0;
message = '';

% Prompting.
while strcmp(message,'Invalid.') || width < 1 || width ~= int32(width)

  try
     disp(message)
     width = input('Frame width: ');
  catch error
     message = 'Invalid.';
  end

end 
```

但是没有运气（以上不起作用）。如图所示，我想要一个简单的消息，例如“框架宽度：”，以便用户第一次输入他的选择。但是，如果发现错误，我希望他的消息是“无效的。再试一次：”每次发生错误时 fx。

我也尝试过，`error()`但我不知道如何正确放置。由于`error()`不接受`input`错误发生的命令作为参数，它必须以另一种方式检测它，我无法理解。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T23:13:48.307

```
width = input('Frame width: ');
while(~isInt(width))
    width = input('Invalid. Try again: ');
end 
```

并且您必须在某处具有以下功能（或它的另一个实现）

```
function retval = isInt(val)
    retval = isscalar(val) && isnumeric(val) && isreal(val) && isfinite(val) && (val == fix(val));
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T23:16:23.657

```
answer = input('Frame width: ', 's');
[width, status] = str2num(answer);
while ~status || ~isscalar(width) || width ~= floor(width)
  answer = input('Invalid. Try again: ', 's');
  [width, status] = str2num(answer);
end
disp(width); 
```

（`status`如果转换失败，则为 0。如果没有`isscalar`测试，也将接受类似 [1 2; 3 4] 的输入。最后一个测试确保宽度必须是整数。）

# installation - 安装 Visual Studio 11 Ultimate beta 后，我找不到 devenv.exe 文件

> ID：11129320
> 
> 赞同：1
> 
> 时间：2012-06-20T22:50:56.133
> 
> 标签：installation, visual-studio-2012

我试图搜索我的问题，但没有找到任何问题的答案。

所以，这是我的问题：

我已经安装了一次 Visual Studio 11 Beta，它运行良好。然后我卸载了 Visual Studio 2010。

我不记得为什么，但我不得不重新安装 VS11。卸载并再次安装后，我找不到 devenv.exe 可执行文件。

所以我尝试运行 Microsoft Blend，然后创建一个项目，但我做不到，因为没有可用的模板，也没有创建项目的语言。

当我尝试在开始菜单中搜索 Visual Studio 时，我找不到它。

我的英语不好，如果你能听懂，恭喜:D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T08:30:19.403

此时您不应再安装 VS11。

您应该下载 VS2012，因为它是为 win8 RP 开发所必需的

# ruby-on-rails - 规划 Rails 应用程序关联

> ID：11129321
> 
> 赞同：0
> 
> 时间：2012-06-20T22:50:56.830
> 
> 标签：ruby-on-rails, associations, rails-activerecord

我正在尝试开发我的第一个 Rails 应用程序，在我开始实际实施我的想法之前，我希望能在我的关联规划方面获得一些帮助。

我的应用程序将成为一个教育工具，并且我有一些需要实现的基本功能。我希望有可以注册和创建课程的学生。在这些课程中，将有一个用户是老师，其余的是学生。课程中将包含教师创建的作业，用户需要提交作业。这些是基础。最终我想添加更多功能，但现在我只需要设置基础。

到目前为止，这是我对关联应该是什么样子的想法：

```
class User < ActiveRecord::Base
    has_many :enrollments
    has_many :courses, :through => :enrollments
end

class Course < ActiveRecord::Base
    has_many :enrollments
    has_many :users, :through => :enrollments
end

class Enrollment < ActiveRecord::Base
    belongs_to :user     # foreign key - user_id
    belongs_to :course   # foreign key - course_id
end 
```

但是，目前我遇到了如何正确处理其余关联的经验不足的问题。我可能会破解一些东西，但我更愿意在第一次时尽可能做到最好。

我如何处理与作业和提交相关的关联？据推测，学生的提交应该属于他们，但它也与班级内的作业特别相关。作业源自课程，但也与用户密切相关。

最后，处理用户和他们创建的类之间关系的最佳方式是什么？用户创建课程。那门课属于他们吗？我是否应该在课程表中添加一列来存储创建者的 ID？等等。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T23:14:24.680

建议：您可能希望将 Teacher 和 Student 模型分开，因为您很可能有与每个相关的不同操作（虽然它们共享一些属性，但它们在您的模型中确实是不同的实体，例如，您可能想要一门课程中只有一名教师教学。）您可以从具有共享属性和身份验证的用户模型中派生教师模型和学生模型。

现在回答你的问题：

如果您想让创建课程的学生保持关联，那么 creator_id 就是我要走的路。（如果教师也可以创建课程，则从共享用户模型中派生学生和教师会有所帮助）

作业和提交：您几乎已经用文字定义了它。这是代码。[如果一个课程内的不同学生可以得到不同的作业，那么你才想在学生和作业之间建立直接关联，否则，使用直通关联]

```
class User < ActiveRecord::Base
    has_many :enrollments
    has_many :courses, :through => :enrollments
    has_many :assignments, :through => :courses
    has_many :submissions
end

class Course < ActiveRecord::Base
    has_many :enrollments
    has_many :users, :through => :enrollments
    has_many :assignments
end

class Enrollment < ActiveRecord::Base
    belongs_to :user     # foreign key - user_id
    belongs_to :course   # foreign key - course_id
end

class Assignment < ActiveRecord::Base
    belongs_to :course
    has_many :submissions
end

class Submission < ActiveRecord::Base
    belongs_to :assignment
    belongs_to :user
end 
```

# eclipse-plugin - 在 Eclipse 中以编程方式打开进度对话框的详细信息部分

> ID：11129327
> 
> 赞同：0
> 
> 时间：2012-06-20T22:51:24.250
> 
> 标签：eclipse-plugin, progressdialog

在进度对话框 (IPProgressMonitor) 中，有一个详细信息按钮，用于展开进度对话框以显示详细信息部分。如何在我的 Eclipse 插件中以**编程方式打开详细信息部分？**

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T06:04:41.683

你没有。

进度报告的 UI 绝对**不是**进度 API 的一部分，只有任务、子任务及其运行状态的概念是该 API 的一部分。因此，在另一个版本的 Eclipse 中，进度可能会通过播放声音而不是显示对话框来显示。

即使您假设有该对话也是错误的。当您激活工作区首选项“始终在后台”时，用户将根本看不到该对话框。

最后一件事：即使您觉得您的插件非常重要，以至于它的行为应该与 Eclipse 中的其他插件不同（因此希望以某种方式访问​​该进度对话框），您的用户也不会有同样的感觉。当您将插件与其他插件一起安装时，它们会感到困惑，因为它们的行为不同，尽管它们是一个安装的一部分。

# mysql - 在 MySQL 中添加 DISTINCT 运算符的 SQL MIN 和 MAX 结果

> ID：11129331
> 
> 赞同：2
> 
> 时间：2012-06-20T22:52:06.310
> 
> 标签：mysql, sql

我在获得我想要的结果集时遇到了一些困难（多年来没有写过查询）。我的表 itemdata 如下所示：

```
year make model
1972 foo  bar
1973 foo  bar
1975 foo  bar
1971 bar  foo
1972 bar  foo
1973 bar  foo
1974 bar  foo
1975 bar  foo
1976 bar  foo 
```

我的目标是返回一个结果集，该结果集由具有开始年份和结束年份的不同品牌模型对组成，如下所示：

```
startyear endyear make model
1972      1975    foo  bar
1971      1976    bar  foo 
```

出于某种原因（最有可能缺乏 SQL 知识）我没有得到我想要的结果集。我尝试了许多查询，我认为我会成功：

```
SELECT MIN(year) as startyear , MAX(year) as endyear, make, model 
FROM itemdata 
WHERE model = (SELECT DISTINCT model FROM itemdata) 
```

...但是我的子查询返回多行错误的查询。

我将不胜感激任何帮助或建议！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T23:09:07.683

改为在品牌和型号上使用 GROUP BY，这应该可以满足您的需求。

```
SELECT MIN(year) AS startyear, MAX(year) as endyear, make, model
FROM itemdata GROUP BY make, model; 
```

# php - bcrypt的功能说明

> ID：11129333
> 
> 赞同：2
> 
> 时间：2012-06-20T22:52:14.963
> 
> 标签：php, hash, cryptography, salt, bcrypt

我正在研究在 PHP 中使用 bcrypt 的哈希和加盐密码。有人可以向我解释*为什么*brcypt 使用“工作”/“回合”来防止攻击吗？

我已经阅读了“[如何使用 bcrypt 在 PHP 中对密码进行哈希处理？](https://stackoverflow.com/questions/4795385/how-do-you-use-bcrypt-for-hashing-passwords-in-php) ”，但我很难理解如果有人掌握了您的数据库并可以离线破解它，是什么让它如此特别？

是否可能由盐和哈希共同保护数据库免受彩虹表的影响？或者 bcrypt 是否做了一些特别的事情来帮助防止这样的攻击？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T23:08:25.687

简而言之，`bcrypt`它比其他一些哈希算法（如`sha`家庭）“更好”，因为它故意变慢并且可以通过使用高迭代次数故意变慢。此外，它需要使用防止使用预先计算的哈希值（彩虹表）的盐。盐值应该与 bcrypt 的每个输出一起生成/存储，以禁止不同用户的值之间的比较（如果他们使用相同的密码）。

即使攻击者获得了您的密码哈希和盐，只要您使用的`bcrypt`是大量迭代，就无法快速找到匹配的密码。这是一个单向函数，因此您需要为每个尝试的密码执行一次 bcrypt 计算。当然，这对防止密码错误的保护作用不大。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T07:10:00.653

简而言之，bcrypt 和其他密码拉伸算法都是关于工作放大的。攻击者必须做比您更多的工作来破解密码（因为您通常只会收到有效的登录请求或错误的密码，而且比率要低得多）；因此，您每增加一毫秒的密码哈希时间，您的攻击者就必须支付一百万或十亿倍的费用。Bcrypt 和其他算法只是故意放慢速度，使攻击者花费更多时间尝试破解密码。

# php - 自动加载每个类是否明智

> ID：11129337
> 
> 赞同：2
> 
> 时间：2012-06-20T22:52:59.597
> 
> 标签：php, model-view-controller, oop

我正在编写 MVC，我需要一个建议，使用 spl_autoload_register 自动加载每个类（包括控制器、模型、核心类）是否明智，否则可能会出现问题或性能下降。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T22:58:19.360

这可能取决于许多因素，但我使用了自动加载每个类的框架（来自一个相对较大的 autload 函数，该函数看起来很宽泛）以及*许多*嵌套包含。我从来没有注意到像这样的自动加载的性能问题。它使事情变得更加简单，因为您不必担心包含冲突。

不过，正如我所说，这可能取决于。您可以通过基准测试来测试哪种方法更快。如果您在实现方面有一个较慢的首选方法，您将不得不决定速度差异是否足以使用劣质但更快的实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T22:59:05.833

在大多数情况下 - 是的。如您所料，手动加载类会提高性能，但仅在您拥有一个由大量文件组成的库（例如 PHPExcel）的情况下会提高一点性能，但即使在这种情况下，使用它也更可取自动加载。

总而言之：在大多数情况下（尤其是对于传统站点），手动加载是微优化。

处理此功能的最佳方法 - 如果性能似乎出现问题，则启动基准测试。基准测试是最好的方法，因为一切都取决于架构框架

# ember.js - Ember 命名/大写约定

> ID：11129338
> 
> 赞同：2
> 
> 时间：2012-06-20T22:53:00.460
> 
> 标签：ember.js

根据我的理解，我们鼓励将 Ember 实例命名为小写：

```
App.mailtruck = Em.Object.create({...}); 
```

...和大写的类：

```
App.Mailtruck = Em.Object.extend({...}); 
```

说 Ember.Namespace 的实例是这条规则的唯一例外是否正确？此外，除了命名空间之外，还有没有这种约定非常重要的情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T05:16:45.727

是的，命名空间是这条规则的例外。正如你所说，它是`lowerCase`实例和`UpperCase`类。也`Mixins`应该命名`UpperCase`，所以它是：（`App.LoggerMixin = Ember.Mixin.create({});`感谢@ **sly7_7**的捕获）

更多详细信息可以在 Emberist 的精彩博客文章中阅读：[http](http://www.emberist.com/2012/04/09/naming-conventions.html) ://www.emberist.com/2012/04/09/naming-conventions.html 。

# objective-c - 从其他类中的按钮将视图推送到导航控制器

> ID：11129339
> 
> 赞同：2
> 
> 时间：2012-06-20T22:53:01.223
> 
> 标签：objective-c, uiviewcontroller, uinavigationcontroller, uibutton, pushviewcontroller

我在我的子类 ViewController 中创建了一个 UIButton，并将其添加到我的 MainViewController。

现在，我向这个按钮添加了一个目标方法，该方法应该将另一个视图控制器推送到我的导航控制器（在 MainViewController 中的那个）。

我知道当我按下按钮时该方法确实调用了，但视图没有推送到导航控制器。

我扫描了这张图 - 这是这张图（我还添加了部分代码）：

![问题绘图](../Images/9bcd6beee3e7bc6a1ba330d972db8662.png)

这是我在按钮中使用的代码：（ **记住它在不同的 ViewController 中）。**

```
- (void)buttonPressed:(UIButton *)sender
{
    Photo_ScreenGlobalView *photo = [[Photo_ScreenGlobalView alloc] init];
    [self.navigationController pushViewController:photo animated:YES];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T23:02:05.233

通常我会通过委托来解决这些情况。如果有一个视图控制器从属于另一个视图控制器（即“子”视图控制器），但应该能够触发导航更改等......那么它应该有一个指向它的“父”的弱指针。然后父 VC 应该实现一个适当命名的协议，并带有一个回调供孩子使用。这些事物的名称可以是通用的，例如`@property navigationDelegate`and，`requestNavigationToViewController:`或者它们可以更具语义性，例如`@property userFormDelegate`and`userFormDoneButtonPressed:`

一般来说，从属视图控制器不应该能够直接修改其父级的导航；但它可以通过像这些更松散耦合的接口来触发它。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-06-26T23:50:05.647

我回来让你们知道我是怎么做到的。在谷歌上搜索了很多之后，发现这个很好的快速指南如何制作**DELEGATE** 并与代表一起工作解决了我所有的问题。如果您需要任何帮助，请随时给我发送 PM。

这是指南： [http ://css.dzone.com/articles/do-not-publishcreating-your](http://css.dzone.com/articles/do-not-publishcreating-your)

# python - Flask-Sijax 回调“在请求上下文之外工作”

> ID：11129341
> 
> 赞同：2
> 
> 时间：2012-06-20T22:53:23.317
> 
> 标签：python, flask, sijax

在回调函数中，我无法访问 flask.session、flask.g 或 url_for() 等函数。他们都抛出一个错误，说我“在请求上下文之外工作”。

```
Debugging middleware caught exception in streamed response at a point where response headers were already sent.
Traceback (most recent call last):
  File "C:\Python27\site-packages\sijax\response\streaming.py", line 136, in _process_call_chain
    for string in generator:
  File "C:\Python27\site-packages\sijax\response\streaming.py", line 109, in _process_callback
    response = self._perform_handler_call(callback, args)
  File "C:\Python27\site-packages\sijax\response\base.py", line 258, in _perform_handler_call
    return callback(self, *args)
  File "C:\Dropbox\Code\Python 2.7\FlaskTesting\testpage.py", line 18, in myformhandler
    sql_session = flask.g.sql_session
  File "C:\Python27\lib\site-packages\werkzeug\local.py", line 336, in __getattr__
    return getattr(self._get_current_object(), name)
  File "C:\Python27\lib\site-packages\werkzeug\local.py", line 295, in _get_current_object
    return self.__local()
  File "C:\Python27\lib\site-packages\flask\globals.py", line 19, in _lookup_object
    raise RuntimeError('working outside of request context')
RuntimeError: working outside of request context
192.168.1.141 - - [20/Jun/2012 16:33:04] "POST /testpage HTTP/1.1" 200 - 
```

我一直无法找出如何解决这个问题。任何帮助，将不胜感激。

*   Python v2.7
*   烧瓶 v0.8
*   烧瓶-Sijax v0.3

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-11-05T05:24:34.980

您可以尝试使用 stream_with_context。[从http://flask.pocoo.org/docs/0.12/patterns/streaming/#streaming-with-context](http://flask.pocoo.org/docs/0.12/patterns/streaming/#streaming-with-context)复制的代码示例

```
from flask import stream_with_context, request, Response

@app.route('/stream')
def streamed_response():
    def generate():
        yield 'Hello '
        yield request.args['name']
        yield '!'
    return Response(stream_with_context(generate())) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-24T14:23:05.070

如果您发布代码会很有帮助，但请尝试像这样包装您的代码：

```
with app.app_context():
    # do stuff... 
```

或者这个：

```
with app.test_request_context():
    # do stuff... 
```

# java - 整数数组的时间和复杂度

> ID：11129343
> 
> 赞同：1
> 
> 时间：2012-06-20T22:53:33.720
> 
> 标签：java, math

我正在处理一项任务，但有些问题没有得到答案。

我被问到：

输入：一个长度为 N 的数组 A，它只能包含从 1 到 N 的整数

输出：TRUE - A 包含重复，FALSE - 否则。

我创建了一个通过我的测试用例的类。

```
public class ArrayOfIntegers {

public boolean isArrayContainsDuplicates(int [] intArray){

    int arraySize = intArray.length;

    long expectedOutPut = arraySize*(arraySize+1)/2;

    long actualOutput = 0;

    for(int i =0 ; i< arraySize; i++){

        actualOutput =  actualOutput + intArray[i];

    }

    if(expectedOutPut == actualOutput)
        return false;

    return true;
}   

} 
```

现在对此有进一步的问题

1.  是否可以提供答案而不破坏输入数组 A？

    我还没有销毁数组。那么我所做的是否正确？

2.  分析算法的时间和空间复杂度？

    所以我需要写一些关于 for 循环的东西，一旦我找到重复的元素，我就应该打破循环。坦率地说，我对时间和空间复杂度的概念不是很清楚。

3.  时间和空间都可能是 O(n) 吗？

    这应该是否，因为 n 可以是任何数字。同样，我对 O(n) 不是很清楚。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T23:05:13.803

> 是否可以提供答案而不破坏输入数组 A？

是的。例如，如果您不关心它所花费的时间，您可以为每个可能的数字循环一次数组，并检查您是否只看到一次（如果没有，则必须有重复）。那将是O（N ^ 2）。

通常，您会使用额外的数组（或其他数据结构）作为临时列表（这也不会破坏输入数组，请参见下面的第三个问题）。

> 分析算法的时间和空间复杂度？

您的算法在 O(n) 中运行，只对输入数组进行一次传递，并且不需要额外的空间。但是，它不起作用。

> 时间和空间都可能是 O(n) 吗？

是的。

有另一个相同大小的数组（大小= N），在那里计算你看到每个数字的频率（单次通过输入），然后检查计数（单次通过输出，或者当你有错误时短路）。

> 所以我需要写一些关于 for 循环的东西，一旦我找到重复的元素，我就应该打破循环。

不。复杂性考虑总是关于最坏的情况（或者有时是平均情况）。在最坏的情况下，您无法跳出循环。在一般情况下，你可以在循环的一半后突破。无论哪种方式，虽然对于等待实际实现以完成计算的人来说很重要，但这对可伸缩性没有影响（复杂性随着 N 无限增长）。不考虑恒定的偏移量和乘数（例如早期突破的 50%）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T23:05:11.777

作为提示：

1.  是的，可以提供答案而不破坏阵列。您的代码^*提供了一个示例。

2.  时间复杂度可以看作是“这个算法做了多少有意义的操作？” 由于您的循环从 0 到 N，至少，您正在做 O(N) 的工作。

    空间复杂度可以看作是“在这个算法中我使用了多少空间？” 您无需制作任何额外的数组，因此您的空间复杂度约为 O(N)。

3.  你真的应该重新审视你的算法如何比较重复的数字。但我把它作为练习留给你。

^(*：您的代码也没有找到数组中的所有重复项。你可能想重新审视它。)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T23:13:54.080

```
public boolean hasDuplicates(int[] arr) {
    boolean found = false;
    for (int i = 1 ; i <= arr.length ; i++) {
        for (int a : arr) 
            if (a == i) found = true;
        if (! found) return true;
    }
    return false;
} 
```

我相信这种方法会奏效（因为你目前没有）。它是 O(n^2)。

我很确定不可能在时间和空间上都达到 O(n)，因为需要两个嵌套的 for 循环，从而增加了方法的复杂性。

**编辑**

我错了（有时承认这一点很好），这是 O(n)：

```
public boolean hasDuplicates(int[] arr) {
    int[] newarr = new int[arr.length];
    for (int a : arr) newarr[a - 1]++;
    for (int a : newarr) if (a != 1) return true;
    return false;
} 
```

1.  是的，输入数组没有被破坏。
2.  上面的方法是 O(n) （我的意思是它的运行时间和空间需求将随着参数数组长度线性增长）。
3.  是的，见上文。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T22:37:31.617

可以通过将所有元素添加到哈希集 = O(n)，然后将哈希集中的值的数量与数组的大小进行比较 = O(1)。如果它们不相等，则存在重复项。

与创建一个整数数组来计算每个元素相比，创建哈希集平均占用的空间也更少。这也是从 2n 到 n 的改进，尽管这对 big-O 没有影响。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-06-20T23:13:43.067

1）这不需要太多的努力，并且保持阵列完好无损：

```
 public boolean isArrayContainsDuplicates(int [] intArray){
  int expectedOutPut = (intArray.length*(intArray.length+1))/2;
  int actualOutput = 0;
  for(int i =0 ; i < intArray.length; i++){
   if(intArray[i]>intArray.length)return true;
   actualOutput += intArray[i];
  }
  return expectedOutPut == actualOutput ? false: true;
 } 
```

2）这将需要接触数组中不同数量的元素。最好的情况是，它命中第一个元素 O(1)，平均情况是它命中中间 O(log n)，更糟糕的情况是它一直通过并返回 false O(n)。

O(1) 指的是一些与项目总数无关的操作。在这种情况下，第一个元素将是唯一具有这种情况的元素。

O(log n) - log 是一个限制因素，可以是从 0 到 1 的实数。因此，乘以 log 将导致较小的数字。因此，O(log n) 是指所需的操作数量少于项目的数量。

O(n) - 这是当它需要的操作数等于项目数时。

这些都是所需时间的大符号。

该算法使用的内存将随着 n 的增加而增加。然而，它不会线性增长，而是大小 n 的一小部分，因此它的空间 Big-O 为 O(log n)。

3) 是的，这是可能的——但是，只有在最好的情况下才有可能。

# android - 位图回收过程是异步的吗？

> ID：11129345
> 
> 赞同：1
> 
> 时间：2012-06-20T22:53:42.100
> 
> 标签：android

我有返回的方法，`Drawable`如果它的`Bitmap`对象被回收，那么它会重新加载。

```
public Drawable getLogo() {
    if(logo == null || Util.isRecycled(logo)) //Util.isRecycled checks - is Drawable's bitmap recycled, if it had so
        logo = CacheController.getInstance().getLogo(this);

    return logo;
} 
```

但看起来就像在调用`bitmap.recycle()`它之后`bitmap.isRecycled()`仍然返回`false`。我是对的，位图回收过程是异步进行的，还是只是我的代码中的错误？如果是这样，我如何确保`Bitmap`现在没有回收？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T02:04:22.970

如果您尝试为位图实现一些缓存机制，则不必检查它是否被回收。只需从缓存中检索它，如果它的数据结构中没有对它的引用，缓存将再次创建它。请参阅本教程了解如何缓存位图[http://developer.android.com/training/displaying-bitmaps/cache-bitmap.html](http://developer.android.com/training/displaying-bitmaps/cache-bitmap.html)

# installation - 尽管存在不当的 ERROR_NON_WINDOWS_NT_DRIVER，但仍强制安装驱动程序

> ID：11129347
> 
> 赞同：0
> 
> 时间：2012-06-20T22:53:50.440
> 
> 标签：installation, driver, windows-8, device-driver

在 Windows 8 上安装设备驱动程序失败并出现以下错误：

```
0xe000022d -536870355 ERROR_NON_WINDOWS_NT_DRIVER 
```

十进制数是我在错误日志 ( `C:\Intel\Logs\IntelGFX.log`) 中找到的，网络搜索发现了错误符号名称。

当我[直接从英特尔（适用于 Windows* XP 的英特尔® 图形媒体加速器驱动程序）](http://downloadcenter.intel.com/Detail_Desc.aspx?DwnldId=12536)下载驱动程序时，我相信它是一个 NT 驱动程序。只是不适用于 Win7 或 Win8，而是适用于 XP 并且可能适用于 Vista。

有问题的设备不做 Aero，但我不需要 Aero，所以把它关了。但是，我希望拥有原生分辨率和硬件加速。这就是为什么我希望这个安装能够成功。

我的假设是驱动程序安装例程（英特尔驱动程序安装程序）以某种方式与操作系统交互以确定如何准确地安装驱动程序，并且出于谨慎考虑，它在第一眼看到错误时就会失败；因此，理论上认为自己更了解的用户应该能够强制安装。（它只是一个预览系统，目前没有真实数据或功能，所以为什么不玩一点。）

*   (1) 知道这个错误的真正含义是什么吗？
*   (2) 有什么方法可以绕过常规的驱动程序安装？强制安装驱动程序的排序？
*   (3) 作为对#1 和#2 的后备，也欢迎像“每个程序员需要了解的关于设备驱动程序的内容”这样的指针。

[我在请求页面](http://msdn.microsoft.com/en-us/library/windows/hardware/ff543663.aspx)[的 SetupAPI 中`DIF_ALLOW_INSTALL`](http://msdn.microsoft.com/en-us/library/windows/hardware/ff543663.aspx)发现了这个错误代码，但我对这个 API 几乎一无所知。

* * *

好的，Ken 认为这不是一个编程问题，他可能有道理。麻烦的是：由于我在驱动部门缺乏知识，我很难做出编程点。我知道的很多：Win32 API 允许您注册代码以在调用 API 例程时运行。这在程序员术语中称为“钩子”，这是我熟悉的概念。这个想法是您可以以某种方式在操作系统和驱动程序设置例程之间插入一些代码以返回“一切都好，继续”而不是`ERROR_NON_WINDOWS_NT_DRIVER`. 但我从未在系统/驱动程序级别这样做过。

确实，这不是一个具体的编程问题。我要去那里的路。

我在 stackoverflow 上发布了这个，因为我认为对于超级用户来说太难了，而对于 serverfault 来说，离题太难了。如果您可以建议一个更好的论坛，那也会有所帮助。

* * *

硬件背景： 有问题的驱动程序适用于具有 Intel 915GM/GMS、910GML 芯片组的 2005 年老式硬件（三星 X20 笔记本电脑）。不享受硬件支持而依赖某些 VGA 驱动程序显然对整体用户体验有些不利。

（我为这篇文章中的过度大写辩解 - 这是由于[IE10 中的新拼写检查器，我还没有设法禁用它](https://superuser.com/q/439517/69392)。）

# playframework - playframework 1.2.4 如何将 jar 与已经存在的 JPA 实体一起使用

> ID：11129351
> 
> 赞同：0
> 
> 时间：2012-06-20T22:54:16.890
> 
> 标签：playframework

我有一个带有 JPA 实体的 jar，来自另一个带有 persistence.xml 文件的应用程序。有没有办法调整播放所以

1.  它用属性值填充persistence.xml
2.  它仍然设置内存数据库并允许我们保存/查询等。

目前，我收到一个错误“发生 JPA 错误（未初始化 JPA 上下文。当在应用程序中找到一个或多个使用 @javax.persistence.Entity 注释注释的类时，JPA 实体管理器会自动启动。）”

附言。我在 lib 目录中有我的实体 jar，当然还有 persistence.xml 文件，它可以工作，直到我将所有实体从我的模型中拉出（如果模型中没有实体，它似乎不起作用）。

谢谢，院长

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:00:46.833

我目前处于类似情况，但使用的是 Play 2.0.1，所以我不确定我能否回答您的两个问题，但我相信我可能会帮助您解决收到的错误。

我为 Hibernate 和内存数据库设置的 persistence.xml 文件：

```
 <persistence-unit name="testUnit">
    <provider>org.hibernate.ejb.HibernatePersistence</provider>
    <jar-file>path/to/jar-file.jar/jar-file>
    <properties>
        <property name="hibernate.dialect" value="org.hibernate.dialect.H2Dialect"/>
        <property name="hibernate.hbm2ddl.auto" value="update"/>
        <property name="hibernate.connection.url" value="jdbc:h2:mem:events"/>
    </properties>
</persistence-unit> 
```

我想象的是你没有包含你的 jar 文件，所以虽然你的构建路径中有 jar，但你的 JPA 实体管理器无法识别它。

此外，您应该检查以确保不需要将 persistence.xml 文件放在 /conf/META-INF 文件夹中，尽管这可能是 Play 2.0.1 特定的，但这是我在工作时遇到的其他问题.

# javascript - JSON 处理 - 将 JSON 文本字符串发送到 JSP，如何在 JSP 中处理

> ID：11129352
> 
> 赞同：0
> 
> 时间：2012-06-20T22:54:37.263
> 
> 标签：javascript, jquery, json, jsp, post

将 json 数据发送到另一个 jsp 页面 - 真正用于测试。

您在我的 jsp 上的文本字段中输入 JSON 格式的字符串。我通过一个表单请求提交这个，由 jquery 处理处理。它被发送到接收者 JSP。我正在使用以下代码来执行此操作。

```
 $.ajax({ 
    type:       "POST", 
    url:        "receiver.jsp", 
    data:       term, // This is a formatted JSON string
    success:    function(data, textStatus, jqXHR) { 
                        alert('Success : ' + data); 
                        alert('textStatus : ' + textStatus); 
                        alert('jqXHR : ' + jqXHR); 
                        var jsonJqXHR = JSON.stringify(jqXHR);
                        alert('jsonJqXHR : ' + jsonJqXHR); 
        }, 
    error:function (xhr, ajaxOptions, thrownError){ 
        alert('Error xhr : ' + xhr.status); 
        alert('Error thrown error: ' + thrownError); 
    },
    //complete: alert('complete'),
    dataType:   "text" // xml, json, script, text, html                        
}); 
```

我的问题是，我如何在接收者 JSP 中选择这个 POST 并用它做些什么？我见过 getParameter 等的东西，但我不确定。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T08:28:30.503

我认为将其作为参数发送会很容易：

```
data: "jsonData=" + term, 
```

您也可以使用 name="jsonData" 将其放入表单输入并序列化您的表单：

```
data: jQuery("form").serialize(), 
```

然后你可以在receiver.jsp中读取它：

```
<%
    String jsonData = request.getParameter("jsonData");
%> 
```

# text - IE8 在使用 Raphael text() 时抛出未指定的错误

> ID：11129359
> 
> 赞同：0
> 
> 时间：2012-06-20T22:55:27.020
> 
> 标签：text, internet-explorer-8, raphael

我正在使用 Raphaël 2.1.0。我画了几条路径、圆形和矩形，在 IE9 (SVG) 和 IE8 (VML) 上似乎一切正常。[但是，当我尝试使用text](http://raphaeljs.com/reference.html#Paper.text)函数向画布添加文本时，IE8 总是抛出 Unspecified 错误，而且错误似乎在这一行，raphael.js, line 5179 character 13，即

```
var brect = span.getBoundingClientRect(); 
```

我在 IE7 上没有看到任何错误。有谁知道可能是什么问题？

谢谢！

# backbone.js - 更新 Marionette.ItemView 中的封闭标记类

> ID：11129360
> 
> 赞同：1
> 
> 时间：2012-06-20T22:55:30.727
> 
> 标签：backbone.js, marionette

我有一个 Marionette.ItemView ，它使用 CSS 类以不同的方式设置新项目的样式：

```
class Happenator.Views.Option extends Backbone.Marionette.ItemView
  tagName: 'li'
  className: =>
    return 'new' if @model.isNew()
  initialize: ->
    @bindTo @model, "change", -> @render() 
```

保存和更新模型后，一切都会刷新，但“新”类仍保留在“li”上。有没有一种好方法可以在更新时更新封闭标签的类？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T01:01:41.133

是的，“新”类保留在“li”上，因为实际上 Backbone`className`仅在初始化方法调用之前使用该属性。看看[这个答案](https://stackoverflow.com/a/10804763/1248256)以获得更多解释。

但为什么不使用 jQuery`.toggleClass`或`.removeClass`? 就像是

```
render: =>
    @$el.html(@template(@model.toJSON()))
    unless @model.isNew()
        @$el.removeClass('new') 
```

[http://jsfiddle.net/GX8WJ/21/](http://jsfiddle.net/GX8WJ/21/)

# ios - 证书问题：Apple WWDRCA 证书“由未知权威签名”

> ID：11129362
> 
> 赞同：1
> 
> 时间：2012-06-20T22:55:33.637
> 
> 标签：ios, xcode4.2, certificate

我一直无法重新建立我的构建环境。过去它工作得很好，但是在运行归档进程的过程中，我设法让自己倒退了几天。

我已经耐心地做了TN2250。

一切都很顺利——除了我做什么，Apple WWDRCA.cer 在我的钥匙串访问中的登录（默认）钥匙串中显示为“此证书由未知机构签名”。我已经尝试从 Apple 的 iOS 配置文件的链接以及硬链接中获取证书——这并不重要，但我现在很绝望。

我的开发者证书和发行证书似乎很好——他们在 Keychain Access 中的视图旁边没有错误，并且它们包含我的私钥，据我所知（单击箭头，向下，这是我的密钥。）

我什至在添加证书之前就注意到了这一点。我的意思是——它来自苹果？这是一个文件。为什么不能正确签名？

错误因我尝试的各种事情而异。但反复出现的是

```
CSSMERR_TP_NOT_TRUSTED codesign failed with exit code 1 
```

我试过并提到：

[CSSMERR_TP_NOT_TRUSTED 错误](https://stackoverflow.com/questions/1747857/cssmerr-tp-not-trusted-error)

以及此处TN2250中的具体点：

[https://developer.apple.com/legacy/library/technotes/tn2250/_index.html#//apple_ref/doc/uid/DTS40009933-CH1-TNTAG19](https://developer.apple.com/legacy/library/technotes/tn2250/_index.html#//apple_ref/doc/uid/DTS40009933-CH1-TNTAG19)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T12:49:22.393

似乎已经弄清楚了这一点。我在任何地方都没有看到这个答案，所以我会回答我自己的问题。好像我的钥匙串缺少有效的“Apple Computer, Inc. Root Certificate”和“Apple Inc. Root Certificate”。一旦我安装了这些，我的证书就变成了“绿色”并且有效。

我从这里获得了这些证书：http: [//www.apple.com/certificateauthority/](http://www.apple.com/certificateauthority/)

# ruby - 连续运行一个程序，内存泄漏

> ID：11129366
> 
> 赞同：0
> 
> 时间：2012-06-20T22:56:59.530
> 
> 标签：ruby, memory-leaks

我想无限期地运行一个脚本。如下所示，看起来我当前的脚本会导致内存泄漏。此外，我想保留 @time_value 数组，因为我需要循环遍历每次新运行的值。

```
 class Data

    def initialize
      first_method
      @time_value = [30, 60, 90]
    end

    def first_method

      # get some data; takes about 1 hour
      second_method
    end

    def second_method
      #process the data
      first_method
    end
  end

  d = Data.new 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T23:08:03.910

永久递归可能不仅会继续消耗内存，而且最终会因堆栈溢出而失败。将您的无限期处理更改为一个简单的循环。

```
class Data
  def initialize
    @time_value = [30, 60, 90]
  end

  def run_forever
    while true
      first_method
      second_method
    end
  end

  def first_method
    # get some data; takes about 1 hour
  end

  def second_method
    #process the data
  end
end

Data.new.run_forever 
```

# c - 奇怪的C整数不等式比较结果

> ID：11129368
> 
> 赞同：15
> 
> 时间：2012-06-20T22:57:02.263
> 
> 标签：c, arm

```
#include <limits.h>
#include <stdio.h>
int main() {
    long ival = 0;
    printf("ival: %li, min: %i, max: %i, too big: %i, too small: %i\n",
           ival, INT_MIN, INT_MAX, ival > INT_MAX, ival < INT_MIN);
} 
```

这给出了输出：

```
ival: 0, min: -2147483648, max: 2147483647, too big: 0, too small: 1 
```

这怎么可能？

（实际上，我在 CPython 2.7.3 中遇到了这个问题/错误`getargs.c`：`convertsimple`。如果您在 中查找代码，`case 'i'`则检查`ival < INT_MIN`对我来说始终是正确的。另请参阅[测试用例源和进一步的参考资料](https://github.com/albertz/playground/blob/master/test-int-cmp.c)。）

* * *

好吧，我现在测试了几个不同的编译器。为 x86 编译的 GCC/Clang 都返回预期值（太小：0）。为 armv7 编译时，意外输出来自 Xcode 工具链中的 Clang。

* * *

如果你想重现：

这是确切的编译命令：`/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang -arch armv7 -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS5.1.sdk test-int.c`

这是 Xcode 4.3.2。

我将结果复制`a.out`到我的 iPhone 并执行它。

如果有人对此生成的汇编代码感兴趣：

```
 .section    __TEXT,__text,regular,pure_instructions
    .section    __TEXT,__textcoal_nt,coalesced,pure_instructions
    .section    __TEXT,__const_coal,coalesced
    .section    __TEXT,__picsymbolstub4,symbol_stubs,none,16
    .section    __TEXT,__StaticInit,regular,pure_instructions
    .syntax unified
    .section    __TEXT,__text,regular,pure_instructions
    .globl  _main
    .align  2
    .code   16
    .thumb_func _main
_main:
    push    {r7, lr}
    mov r7, sp
    sub sp, #20
    movw    r0, #65535
    movt    r0, #32767
    movs    r1, #0
    movt    r1, #0
    str r1, [sp, #16]
    str r1, [sp, #12]
    ldr r1, [sp, #12]
    ldr r2, [sp, #12]
    cmp r2, r0
    movw    r0, #0
    it  gt
    movgt   r0, #1
    and r0, r0, #1
    ldr r2, [sp, #12]
    cmn.w   r2, #-2147483648
    movw    r2, #0
    it  lt
    movlt   r2, #1
    and r2, r2, #1
    mov r3, sp
    str r2, [r3, #4]
    str r0, [r3]
    mov.w   r2, #-2147483648
    mvn r3, #-2147483648
    movw    r0, :lower16:(L_.str-(LPC0_0+4))
    movt    r0, :upper16:(L_.str-(LPC0_0+4))
LPC0_0:
    add r0, pc
    blx _printf
    ldr r1, [sp, #16]
    str r0, [sp, #8]
    mov r0, r1
    add sp, #20
    pop {r7, pc}

    .section    __TEXT,__cstring,cstring_literals
L_.str:
    .asciz   "ival: %li, min: %i, max: %i, too big: %i, too small: %i\n"

.subsections_via_symbols 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-20T23:22:36.790

这是一个错误。在 C 标准中`too small`，除了 0 之外没有任何空间。这是它的工作原理：

1.  由于`INT_MIN`是`int`，它`long`在“通常的算术转换”期间被转换为。发生这种情况是因为`long`排名高于`int`（并且都是有符号类型）。没有提升发生，因为所有操作数都至少有`int`等级。不调用未定义或实现指定的行为。

2.  在转换期间，`INT_MIN`保留 的值。由于它正在从 转换`int`为`long`，并且保证`long`至少具有 的范围，因此在转换过程中必须保留`int`的值。`INT_MIN`不调用未定义或实现指定的行为。不允许进行模块化转换，仅适用于无符号类型。

3.  比较的结果应该是`0`。

标志扩展或其他此类事情没有回旋余地。此外，由于调用`printf`是正确的，所以那里没有问题。

如果您可以在另一个系统上重现它，或者将它发送给可以重现它的其他人，您应该直接将错误报告给您的工具链供应商。

**尝试重现错误：**我无法重现以下任何组合的行为，所有组合都开启和关闭优化：

*   GCC 4.0，PPC + PPC64
*   GCC 4.2，PPC + PPC64
*   GCC 4.3，x64
*   GCC 4.4，x64
*   铿锵 3.0，x64

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T23:10:11.050

这个打印什么？

```
#include <limits.h>

printf("%016ld\n", LONG_MAX);

long l_int_min = (long)INT_MIN;
printf("%016lx\n", l_int_min); 
```

我想知道是否在没有符号扩展的情况下被`INT_MIN`强制执行。`long`这将使 0 小于结果值。

编辑：好的，第一个的结果`printf()`是`0000002147483647`，这意味着`long`在那个平台上是 32 位的，就像`int`. 因此，将 an`int`转换为 a`long`实际上不应该改变任何东西。

我试图保留“这是一个编译器错误”作为最后的手段，但这对我来说看起来像是一个编译器错误。

# c# - 如何为 2D 设置世界、视图和投影？

> ID：11129369
> 
> 赞同：1
> 
> 时间：2012-06-20T22:57:29.580
> 
> 标签：c#, xna, shader

如何为 2D 设置世界、视图和投影？[XNA 3.1,C#]

我正在尝试使用需要的着色器

```
float4x4 World;
float4x4 View;
float4x4 Projection; 
```

但我不知道如何使用 2D 引擎设置它们。我的意思是我真的不知道应该为使用 2D 计算的正确顶点着色器传递什么值。

代码：

```
efs[ObjShaders[i].ShaderID].effect.Parameters["World"].SetValue(Matrix.Identity);

efs[ObjShaders[i].ShaderID].effect.Parameters["View"].SetValue(Matrix.CreateLookAt(new Vector3(0, 0, 0), new Vector3(0, 0, 0), new Vector3(0, 0, 0)));

efs[ObjShaders[i].ShaderID].effect.Parameters["Projection"].SetValue(Matrix.CreatePerspectiveFieldOfView(MathHelper.ToRadians(45.0f),aspectRatio,1.0f, 10.0f));

efs[ObjShaders[i].ShaderID].effect.Parameters["EyePos"].SetValue(new Vector3(0,0,0)); 
```

着色器部分：

```
VertexShaderOutput VertexShaderFunction(VertexShaderInput input)
{
VertexShaderOutput output;

float4 worldPosition = mul(float4(input.Position), World);
float4 viewPosition = mul(worldPosition, View);
output.Position = mul(viewPosition, Projection);

output.texCoord = input.texCoord*100;
output.worldPos = worldPosition.xyz;

return output;
} 
```

问题：当我尝试使用 VertexShader = compile vs_2_0 VertexShaderFunction(); 它只是没有显示任何东西。但如果我只使用 PixelShader 绘制纹理，但感觉有点错误和错位。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T06:40:24.313

首先找到有关世界观投影矩阵的任何文档并阅读它。您将了解此矩阵并修复您的代码：

1.  Matrix.CreateLookAt 通过 3 个向量创建一个视图矩阵：位置、目标和向上。如果您将所有这些都作为零向量传递 - 矩阵也将为零。尝试使用 (0, 0, 0) 表示位置，(0, 0, 1) 表示目标， (0, 1, 0) 表示向上。

2.  对于 2D，您不能使用透视投影。使用 Matrix.CreateOrthographic 或 Matrix.CreatePerspectiveOffCenter（阅读文档中的差异）。您可以在参数中传递您的分辨率，然后您的像素将等于您的世界空间中的一个单位（Matrix.CreateOrthographic(800, 600, -1, 1)。

# python - Python：使用 Tkinter 时使用 for 循环将命令分配给按钮

> ID：11129371
> 
> 赞同：1
> 
> 时间：2012-06-20T22:57:32.087
> 
> 标签：python, button, tkinter

我正在使用 Tkinter，我想知道是否有一种方法可以为一堆按钮命令定义一个回调函数，其中命令的名称类似于“callback1”、“callback2”等。

我正在创建这样的按钮（它是日历的一部分）：

```
buttonlist = ['c1', 'c2', 'c3', 'c4', 'c5', 'c6', 'c7']
daylist = ['mo', 'tu', 'we', 'th', 'fr', 'sa', 'su']
counter = 0
daycount = -1

for item in buttonlist:
    counter = counter + 1
    daycount = daycount + 1
    item = Tkinter.Button(label1, width=5, bg = 'white', 
                                text = daylist[daycount])
    item.grid(row=0, column = counter, padx=5, pady=5) 
```

我可以手动为每个按钮添加一个命令，并为每个按钮定义一个函数，但我宁愿只定义一个函数，并在 for 循环中为命令提供唯一名称，因为我每天都有一个按钮在当月。

有没有办法做到这一点？我正在使用 Python 2.7.2

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T23:15:22.920

很久没用 Tkinter

首先，您可以将循环修改为（根据需要进行调整）：

```
for idx, (bl, dl) in enumerate(zip(buttonlist, daylist)):
    TKinter.Button(text=dl, command=lambda: button_pressed(bl)) 
```

然后在适当的地方：

```
def button_pressed(which):
    print 'I am button {}'.format(b1) 
```

lambda 函数创建一个匿名函数，其工作是使用按下的按钮调用 button_pressed 函数（如果有意义的话！）

# javascript - 监听元素的创建并在它出现在 Chrome 扩展的页面上时触发事件

> ID：11129373
> 
> 赞同：10
> 
> 时间：2012-06-20T22:57:44.377
> 
> 标签：javascript, google-chrome, google-chrome-extension

是否可以让 Chrome 扩展程序监听尚未创建的元素的外观？

假设用户单击一个按钮并且单击事件创建一个元素`<div id='myDiv'>My Div</div>`并将其添加到页面/DOM。是否可以设置一个在该元素出现时自动触发事件的侦听器？

或者我是否必须每隔 X 毫秒轮询一次页面并检查这个元素？

顺便说一句，jQuery 和其他库不是我的选择。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-21T15:47:15.363

新的[DOM4 MutationObserver](http://updates.html5rocks.com/2012/02/Detect-DOM-changes-with-Mutation-Observers)可以做到这一点。我认为它尚未得到广泛支持，但幸运的是，Chrome 支持它，如`WebKitMutationObserver`.

从链接的教程页面修改，这会在页面上的任何地方监听突变：

```
var observer = new WebKitMutationObserver(function(mutations) {
    mutations.forEach(function(mutation) {
        for (var i = 0; i < mutation.addedNodes.length; i++) {
            if(mutation.addedNodes[i].id == "myDiv") {
                // target node added, respond now...
            }
        }
    });
});
observer.observe(document, { subtree: true }); 
```

如果您可以将收听范围缩小`observer.observe`到比 更具体的元素`document`，那将为您带来一些性能提升。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-04-01T17:43:05.623

您可以使用[到达.js](https://github.com/uzairfarooq/arrive/)，它包装了[Mutation Observers](https://developer.mozilla.org/en/docs/Web/API/MutationObserver) api。用法：

```
document.arrive(".test-elem", function() {
    // 'this' refers to the newly created element
    var newElem = this;
}); 
```

# android - 如何通过 Intent 发送任意字符串？

> ID：11129374
> 
> 赞同：1
> 
> 时间：2012-06-20T22:57:50.610
> 
> 标签：android, android-intent, ipc

我想在我公司的两个 Android 应用程序之间发送任意字符串（不是路径或 URL），但 Intent 数据是一个 URI。目前我关心的是启动一个 Activity，但在某些情况下，能够在不启动 Activity 的情况下发送查询并接收响应会很好。所以：

*   当 Intent 需要 URI 时，我应该如何发送任意字符串？
*   我还可以使用哪些其他通信机制？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-20T23:02:47.297

对于`Intent intent = new Intent();`，您可以使用`intent.putExtra(String name, String value);`来存储一个`String` `value`被键入的`name`。在您调用的活动中，用于`intent.getStringExtra(name);`检索值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T23:12:15.810

您可以通过在意图上使用附加项来将任意字符串添加到意图。

```
Intent intent = new Intent(Intent.ACTION_VIEW);
intent.putExtra(SOME_STATIC_NAME_VALUE, "your_arbitrary_string"); 
```

额外的选项有很多，请参阅[http://developer.android.com/reference/android/content/Intent.html](http://developer.android.com/reference/android/content/Intent.html)

要在接收活动中检索字符串，请使用

```
intent.getExtras().getString(SOME_STATIC_NAME_VALUE) 
```

或者为您在额外设置上设置的任何值使用适当的吸气剂。

# c++ - gdb 继续而不是步进

> ID：11129379
> 
> 赞同：1
> 
> 时间：2012-06-20T22:58:21.667
> 
> 标签：c++, gdb

我正在 LLVM 和 KLEE 中进行一些开发，但我在使用 gdb 时遇到了一些问题。我已经用`-O0`和`-ggdb`args 编译了所有内容，以摆脱优化并添加调试符号。我已经多次使用 gdb 来调试 c 代码，但这是我第一次在 c++ 上使用它。

当我尝试使用 gdb 进行调试时，一切正常，除了“下一个”命令有时会“继续”而不是转到下一个源代码行。调试器总是在断点处停止，但它似乎决定跳过比下一个应该跳过的多行......例如我可能有类似的东西：

```
int foo::bar(list_class<int> &list, int num){

    int i;
    num = num + 3;

    for(i = 0; i < 5; i++){
        list.add(num + i);
    }

    num = num + 42;
    return num;
} 
```

如果我断线：

```
num = num + 42; 
```

我从线上“下一个”

```
num = num + 3; 
```

它将完全跳过 for 循环并在断点处停止。如果我没有在该行上设置中断，则该函数将返回。如果我在线设置断点：

```
list.add(num + i); 
```

程序将始终在断点处停止。有没有人有什么建议？提前致谢。

编辑：

这是 gdb 向我抛出的一些错误。我不确定它们是否与问题有关。

```
warning: can't find linker symbol for virtual table for `std::basic_string<char, std::char_traits<char>, std::allocator<char> >' value
warning: can't find linker symbol for virtual table for `std::basic_string<char, std::char_traits<char>, std::allocator<char> >::_Alloc_hider' value
warning: can't find linker symbol for virtual table for `std::_Rb_tree_node_base' value
warning:   found `klee::PTree::PTree(klee::ExecutionState* const&)' instead
warning: can't find linker symbol for virtual table for `klee::KInstIterator' value
warning:   found `klee::Executor::runFunctionAsMain(llvm::Function*, int, char**, char**)' instead
warning: can't find linker symbol for virtual table for `klee::TreeOStream' value
warning:   found `std::string::compare(char const*) const' instead
warning: can't find linker symbol for virtual table for `klee::ImmutableMap<klee::MemoryObject const*, klee::ObjectHolder, klee::MemoryObjectLT>' value
warning:   found `bool std::operator==<char, std::char_traits<char>, std::allocator<char> >(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, char const*)' instead
warning: can't find linker symbol for virtual table for `klee::ImmutableTree<klee::MemoryObject const*, std::pair<klee::MemoryObject const*, klee::ObjectHolder>, klee::_Select1st<std::pair<klee::MemoryObject const*, klee::ObjectHolder>, klee::MemoryObject const*>, klee::MemoryObjectLT>' value
warning:   found `bool std::operator==<char, std::char_traits<char>, std::allocator<char> >(std::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, char const*)' instead 
```

编辑#2（已解决）

我通过升级到最新版本的 gdb (7.4) 解决了我的问题。我使用的是 7.1-ubuntu 版本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T16:39:05.757

我通过升级到最新版本的 gdb (7.4) 解决了我的问题。我使用的是 7.1-ubuntu 版本。

# php - 用 PHP 脚本中的嵌套引号将 JavaScript 回显到 HTML 页面上？

> ID：11129382
> 
> 赞同：0
> 
> 时间：2012-06-20T22:58:53.573
> 
> 标签：php, javascript, html, ckeditor

我已经尝试了大约两个小时来将以下代码存储在 PHP 字符串中，然后`echo`在网页上作为 JavaScript 输出：

```
<div id="reply-box" style="display: block; width:100%;float:right;">
    <script type="text/javascript" src="http://example.com/public/js/3rd_party/ckeditor/ckeditor.js"></script>

    <script type="text/javascript">
        /* Dynamic items */
        CKEDITOR.config.IPS_BBCODE          = {"acronym":{"id":"8","title":"Acronym","desc":"Allows you to make an acronym that will display a description when moused over","tag":"acronym","useoption":"1","example":"[acronym='Laugh Out Loud']lol[/acronym]","switch_option":"0","menu_option_text":"Enter the description for this acronym (EG: Laugh Out Loud)","menu_content_text":"Enter the acronym (EG: lol)","single_tag":"0","optional_option":"0","image":""},"ads1":{"id":"46","title":"ads1","desc":"","tag":"ads1","useoption":"0","example":"","switch_option":"0","menu_option_text":"","menu_content_text":"","single_tag":"1","optional_option":"0","image":""},"background":{"id":"27","title":"Background-color","desc":"Adds a background color behind the text","tag":"background","useoption":"1","example":"[background=red]Red background behind this text[/background]","switch_option":"0","menu_option_text":"","menu_content_text":"","single_tag":"0","optional_option":"0","image":""},"entry":{"id":"35","title":"Blog Entry Link","desc":"This tag provides an easy way to link to a blog entry.","tag":"entry","useoption":"1","example":"[entry=100]Click me![/entry]","switch_option":"0","menu_option_text":"Entry ID","menu_content_text":"Text to display","single_tag":"0","optional_option":"0","image":""},"blog":{"id":"34","title":"Blog Link","desc":"This tag provides an easy way to link to a blog.","tag":"blog","useoption":"1","example":"[blog=100]Click me![/blog]","switch_option":"0","menu_option_text":"Blog ID","menu_content_text":"Text to display","single_tag":"0","optional_option":"0","image":""},"code":{"id":"13","title":"Code","desc":"Allows you to enter general code","tag":"code","useoption":"0","example":"[code]$text = 'Some long code here';[/code]","switch_option":"0","menu_option_text":"","menu_content_text":"Code","single_tag":"0","optional_option":"0","image":""},"extract":{"id":"33","title":"Extract Blog Entry","desc":"This will allow users to define an extract for an entry. Only this piece of the entry will be displayed on the main blog page and will show up in the RSS feed.","tag":"extract","useoption":"0","example":"[extract]This is an example![/extract]","switch_option":"0","menu_option_text":"","menu_content_text":"Blog entry extract","single_tag":"0","optional_option":"0","image":""},"hr":{"id":"12","title":"Horizontal Rule","desc":"Adds a horizontal rule to separate text","tag":"hr","useoption":"0","example":"[hr]","switch_option":"0","menu_option_text":"","menu_content_text":"","single_tag":"1","optional_option":"0","image":""},"html":{"id":"15","title":"HTML Code","desc":"Allows you to enter formatted/syntax-highlighted HTML code","tag":"html","useoption":"0","example":"[html]<div class='outer'>\n  <p>Hello World</p>\n </div>[/html]","switch_option":"0","menu_option_text":"","menu_content_text":"HTML Code","single_tag":"0","optional_option":"0","image":""},"imgr":{"id":"39","title":"Image","desc":"Displays linked images, floating to the right","tag":"imgr","useoption":"0","example":"[imgr]http://www.google.com/intl/en_ALL/images/logo.gif[/imgr]","switch_option":"0","menu_option_text":"","menu_content_text":"","single_tag":"0","optional_option":"0","image":""},"jump":{"id":"45","title":"jump","desc":"","tag":"jump","useoption":"0","example":"","switch_option":"0","menu_option_text":"","menu_content_text":"","single_tag":"0","optional_option":"0","image":""},"media":{"id":"32","title":"Media","desc":"Allows a user to post media content from certain common media sites","tag":"media","useoption":"1","example":"[media]http://www.youtube.com/watch?v=YqqLx-2vUr0[/media]","switch_option":"0","menu_option_text":"Dimensions (Flash Only)","menu_content_text":"Media URL","single_tag":"0","optional_option":"1","image":""},"member":{"id":"31","title":"Member","desc":"Given a member name, a link is automatically generated to the member's profile","tag":"member","useoption":"1","example":"[member=admin] runs this site.","switch_option":"0","menu_option_text":"Member Name","menu_content_text":"","single_tag":"1","optional_option":"0","image":""},"page":{"id":"38","title":"Multi-Page Articles","desc":"This tag can be used to create multi-page articles.  Page links are automatically added based on the number of times this tag is used, and the content is hidden until you reach the specified \"page\".","tag":"page","useoption":"0","example":"Content 1\n[page]\nContent 2\n[page]\nContent 3","switch_option":"0","menu_option_text":"","menu_content_text":"","single_tag":"1","optional_option":"0","image":""},"overline":{"id":"42","title":"Overlined Text","desc":"Makes the text overlined","tag":"overline","useoption":"0","example":"[overline]This text is underlined[/overline]","switch_option":"0","menu_option_text":"","menu_content_text":"","single_tag":"0","optional_option":"0","image":""},"php":{"id":"14","title":"PHP Code","desc":"Allows you to enter PHP code into a formatted/highlighted syntax box","tag":"php","useoption":"0","example":"[php]$variable = true;\n\nprint_r($variable);[/php]","switch_option":"0","menu_option_text":"","menu_content_text":"PHP Code","single_tag":"0","optional_option":"0","image":""},"post":{"id":"6","title":"Post Link","desc":"This tag provides an easy way to link to a post.","tag":"post","useoption":"1","example":"[post=1]Click me![/post]","switch_option":"0","menu_option_text":"Enter the Post ID","menu_content_text":"Enter the title for this link","single_tag":"0","optional_option":"0","image":""},"pre":{"id":"43","title":"pre","desc":"","tag":"pre","useoption":"0","example":"","switch_option":"0","menu_option_text":"","menu_content_text":"","single_tag":"0","optional_option":"0","image":""},"spoiler":{"id":"7","title":"Spoiler","desc":"Spoiler tag","tag":"spoiler","useoption":"0","example":"[spoiler]Some hidden text[/spoiler]","switch_option":"0","menu_option_text":"","menu_content_text":"Enter the text to be masked","single_tag":"0","optional_option":"0","image":""},"sql":{"id":"16","title":"SQL Code","desc":"Allows you to enter formatted/syntax-highlighted SQL code","tag":"sql","useoption":"0","example":"[sql]SELECT p.*, t.* FROM posts p LEFT JOIN topics t ON t.tid=p.topic_id WHERE t.tid=7[/sql]","switch_option":"0","menu_option_text":"","menu_content_text":"SQL Commands","single_tag":"0","optional_option":"0","image":""},"tab":{"id":"48","title":"tab","desc":"adds a tab (twelve spaces)","tag":"tab","useoption":"0","example":"[tab]","switch_option":"0","menu_option_text":"","menu_content_text":"","single_tag":"1","optional_option":"0","image":""},"tex":{"id":"41","title":"tex","desc":"LaTeX","tag":"tex","useoption":"0","example":"","switch_option":"0","menu_option_text":"","menu_content_text":"","single_tag":"0","optional_option":"0","image":""},"topic":{"id":"5","title":"Topic Link","desc":"This tag provides an easy way to link to a topic","tag":"topic","useoption":"1","example":"[topic=1]Click me![/topic]","switch_option":"0","menu_option_text":"Enter the topic ID","menu_content_text":"Enter the title for this link","single_tag":"0","optional_option":"0","image":""},"twitter":{"id":"36","title":"Twitter","desc":"A tag to link to a user's twitter account","tag":"twitter","useoption":"0","example":"[twitter]userName[/twitter]","switch_option":"0","menu_option_text":"","menu_content_text":"Twitter Username","single_tag":"0","optional_option":"0","image":"twitter.png"},"xml":{"id":"17","title":"XML Code","desc":"Allows you to enter formatted/syntax-highlighted XML code","tag":"xml","useoption":"0","example":"[xml]<outer>\n <inner>\n  <tag param='1'>Test</tag>\n </inner>\n</outer>[/xml]","switch_option":"0","menu_option_text":"","menu_content_text":"XML Code","single_tag":"0","optional_option":"0","image":""}};
        CKEDITOR.config.IPS_BBCODE_IMG_URL  = "http://example.com/public/style_extra/bbcode_icons";
        CKEDITOR.config.IPS_BBCODE_BUTTONS  = [];

        /* Has to go before config load */
        var IPS_smiley_path         = "http://example.com/public/style_emoticons/default/";
        var IPS_smiles              = {"total":20,"count":20,"emoticons":[{"src":"mellow.png","text":":mellow:"},{"src":"dry.png","text":"&lt;_&lt;"},{"src":"smile.png","text":":)"},{"src":"wub.png","text":":wub:"},{"src":"angry.png","text":":angry:"},{"src":"sad.png","text":":("},{"src":"unsure.png","text":":unsure:"},{"src":"wacko.png","text":":wacko:"},{"src":"blink.png","text":":blink:"},{"src":"sleep.png","text":"-_-"},{"src":"rolleyes.gif","text":":rolleyes:"},{"src":"huh.png","text":":huh:"},{"src":"happy.png","text":"^_^"},{"src":"ohmy.png","text":":o"},{"src":"wink.png","text":";)"},{"src":"tongue.png","text":":P"},{"src":"biggrin.png","text":":D"},{"src":"laugh.png","text":":lol:"},{"src":"cool.png","text":"B)"},{"src":"ph34r.png","text":":ph34r:"}]};
        var IPS_remove_plugins      = [];
        var IPS_hide_contextMenu    = 0;
        var IPS_rclick_contextMenu  = 0;

        /* Has to go after */

        /* Load our configuration */
        CKEDITOR.config.customConfig  = 'http://example.com/public/js/3rd_party/ckeditor/ips_config.js';
    </script>

    <input type='hidden' name='isRte' id='isRte_editor_4fe2476d708e8' value='1' />
    <textarea id="ipb_editor" name="Post" class='ipsEditor_textarea input_text'></textarea>
    <p class='desc ipsPad' style='display: none' id='editor_html_message_editor_4fe2476d708e8'></p>
    <script type="text/javascript">
        ipb.textEditor.initialize('editor_4fe2476d708e8', { type: 'full',
                                                                height: 200,
                                                                minimize: 0,
                                                                bypassCKEditor: 0,
                                                                delayInit: 0,
                                                                isHtml: 0,
                                                                isRte: 1,
                                                                isTypingCallBack: '',
                                                                ips_AutoSaveKey: '',
                                                                ips_AutoSaveData: [] } );
    </script>
</div> 
```

我尝试使用几种不同的 JavaScript 和 PHP 方法转义引号，但无论我尝试什么，我都无法在不破坏页面或编辑器不工作的情况下将其回显。

有谁知道以某种方式将此代码存储在字符串中的方法，然后可以将其作为工作 JavaScript 回显到页面上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T23:49:19.563

尝试：

```
<?php  ob_start(); ?>
<div id="reply-box" style="display: block; width:100%;float:right;">
<script type="text/javascript" src="http://example.com/public/js/3rd_party/ckeditor/ckeditor.js"></script>

<script type="text/javascript">

.... your HTML/Javascript
</script>
</div>
<?php
      $string = ob_get_contents();
      ob_end_clean();
?> 
```

我没有你的 javascript 库，但是当我回显 $string 时它似乎显示得很好。PHP 基本上是将所有显示内容复制到缓冲区，而不是渲染页面，我们将其复制到变量中。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-20T23:08:01.227

```
$variable = <<<END
xxx
xxx
xxx
END;

echo $variable; 
```

确保你有 END；在它自己的行上，前面没有空格。

希望有所帮助！

# node.js - 每个客户端心跳都会触发 Socket.io“连接”事件？

> ID：11129391
> 
> 赞同：2
> 
> 时间：2012-06-20T23:00:14.803
> 
> 标签：node.js, socket.io

我有一个基本的 Socket.io 服务器设置，如下所示：

```
var server = express.createServer().listen(port);
    this.io = socketIO.listen(server);

this.io.sockets.on('connection', function(socket){
        initSocket(socket);
    }); 
```

我也将 socket.io 配置为使用 XHR 轮询，如下所示：

```
io.set("transports", ["xhr-polling"]);
io.set("close timeout", 3);
io.set("heartbeat interval", 2); 
```

问题是每次客户端发送心跳（每 2 秒）时，都会触发“连接”事件。是否有一个不同的事件可以在每次套接字最初连接时触发一次？

我会使用“授权”事件，但这只会传递握手对象而不是实际的套接字。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T14:40:28.607

发现了问题。我将我的 xhr“轮询持续时间”设置为 heroku 建议的 10 秒，如下所示：

```
io.set("polling duration", 10); 
```

这意味着客户端仅每 10 秒发出一个新的 xhr 请求（只要前一个请求返回）。同时我将“关闭超时”设置为 3 秒：

```
io.set("close timeout", 3); 
```

这意味着如果服务器在上次请求后 3 秒内没有收到客户端的消息，它会关闭连接，因此会触发连续的“断开/连接”事件。

解决方案是将关闭超时设置为高于轮询持续时间。似乎“心跳间隔”与 xhr 连接无关。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T03:51:05.003

您是否将 closetimeout 和心跳间隔的值设置得太低。这些默认值为 60 秒和 25 秒。典型的网络延迟约为 5 秒。因此，使用您设置的值，客户端不会在指定的时间内响应，因此连接已关闭。当客户端再次连接时，会触发连接事件。

# jquery - jquery获取元素的id

> ID：11129398
> 
> 赞同：-2
> 
> 时间：2012-06-20T23:01:06.137
> 
> 标签：jquery, search

我有这个代码：

```
var deEdit = $("#opsEdit a, h1");

deEdit.live("click", function(){
 $.ajax({ url: "codigo/file.php?v1=" + this.id + "&v2=" + HOW DO I GET THE H1 ELEMENT'S ID???,
 cache: false,
     success: function(respuesta){
    $("#showData").html(respuesta); 
 }
   });
}) 
```

就是这样......我如何获得 H1 元素的 ID？我知道 A 的 ID，但是 H1 的 ID 呢？我试过 this.next().id 但没有用，非常感谢这里的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T21:57:29.407

```
var elId = $('#opsEdit h1').attr('id'); 
```

# wpf - 将 TabControl 绑定到枚举

> ID：11129400
> 
> 赞同：2
> 
> 时间：2012-06-20T23:01:11.417
> 
> 标签：wpf, c#-4.0

我需要将所有枚举值显示为 TabControl 上的选项卡项，除了一个枚举成员（无）

```
enum MyEnum { Value1, Value2, Value3, None } 
```

TabControl 应显示三个选项卡（Value1、Value2 和 Value3）。我需要能够通过绑定到 SelectedItem 属性来获取/设置 ViewModel 中的当前选项卡。每个选项卡的标题使用本地化枚举值，目前我使用转换器。

这可能吗？我已经尝试了很多东西，但无法让它发挥作用。手动添加每个 TabItem 没有问题，但我不确定如何使 SelectedItem (tab) 成为枚举类型。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T00:16:06.217

我找到了解决方案。通常你会这样做以获得枚举成员的列表：

```
<ObjectDataProvider x:Key="SomeEnumValues"
                    MethodName="GetValues" 
                    ObjectType="{x:Type sys:Enum}">
    <ObjectDataProvider.MethodParameters>
        <x:Type TypeName="vm:SomeEnum" />
    </ObjectDataProvider.MethodParameters>
</ObjectDataProvider> 
```

这将获得所有成员，所以它不是一条路要走。我创建了一个自定义转换器，它将接受枚举值，并从类型中提取所有成员

```
// in the convert method
Type type = value.GetType();

List<object> enumValues = new List<object>();

// add each member, except None (has value of 0)
foreach (var field in type.GetFields())
{
    if (field.IsLiteral)
    {
        var x = field.GetValue(null);

        // add new value
        if ((int)x != 0)
            enumValues.Add(field.GetValue(null));
    }
} 
```

本地化在 ItemTemplate 中完成。在那里，我还使用了转换器（不同的转换器），在那里我得到了本地化的值。

```
<DataTemplate x:Key="EnumItemTemplate">
    <TextBlock Text="{Binding Mode=OneWay, Converter={StaticResource enumConverter}}"/>
</DataTemplate> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T23:29:30.940

副手，我不认为有办法做你想做的事。SelectedItem 将是一个 TabItem 对象，我认为没有办法在这里使用绑定转换器来欺骗它使用枚举。即使你能做到，也没有简单的方法让它神奇地识别枚举值之一是你不想绑定的值（即“无”）。

你最好的办法是把每个TabItem的Tag属性绑定到你想要的枚举上，用代码实现你想要的选择效果。

# debugging - 使用 IntelliJ 调试 Gradle 插件

> ID：11129401
> 
> 赞同：42
> 
> 时间：2012-06-20T23:01:34.990
> 
> 标签：debugging, intellij-idea, gradle

## 问题

**我想将交互式调试器与 IntelliJ 一起使用。** ~~不幸的是，我无法说服 IntelliJ 加载和编译插件。但是，~~我可以做到`gradle clean build`，并且插件按预期构建并运行其测试。

具体来说，我正在尝试调试对[gradle-js-plugin 的本地更改，](https://github.com/eriwen/gradle-js-plugin.git) ~~而~~~~IntelliJ 说它找不到. （我在想也许这与它们的加载方式有关，但这是一个猜测。）`com.google.javascript.jscomp.CompilerOptions``spock.lang.Specification`~~

## 我尝试过的事情

*注意：*我没有在步骤之间恢复任何流程。

### 0\. 我的第一个猜测

我在[docs.codehaus.org上注意到](http://docs.codehaus.org/)[了一个 howto](http://docs.codehaus.org/display/GRADLE/How+to+run+the+Gradle+project+in+IntelliJ+against+any+Gradle+build)。IntelliJ 找不到，因此我对其进行了调整以与以下内容一起使用：`org.gradle.launcher.GradleMain``GradleLauncher`

```
import org.gradle.GradleLauncher

class GradleScriptRunner {
    public static void main(String[] args) {
        GradleLauncher.newInstance(
            "-p", 
            "/path/to/gradle-js-plugin/src/test/resources/build.gradle", 
            "clean assemble"
        )
    }
} 
```

根据[GradleLauncher 的文档](http://gradle.org/docs/current/javadoc/org/gradle/GradleLauncher.html)。

**结果：** IntelliJ 不会编译该项目。

* * *

### 1\. Per [Peter Niederwieser 的回答](https://stackoverflow.com/a/11129708/455581)Fix idea project & debug via plugin

### 脚步

1.  `~# cd /path/to/gradle-js-plugin && gradle cleanIdea idea`
2.  打开新创建的项目并尝试使用第 0 步中的 ScriptRunner 进行调试。

**结果：**项目编译（*耶！*），但我只能在`GradleScriptRunner.groovy`.

* * *

### 2\. Per [Peter Niederwieser 的回答](https://stackoverflow.com/a/11129708/455581)run gradle CLI w/special options

1 & 2\. 为清晰起见合并：

```
~# export GRADLE_OPTS="-Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=y,address=5005"
~# gradle clean assemble
Listening for transport dt_socket at address: 5005 
```

3.  配置 IntelliJ 以连接到此端口并开始调试（见图）： ![我如何配置调试器](../Images/f7b5836fee3960e3349e7708feab87f9.png)

**对于这一步，我尝试了以下 .gradle 文件配置：**

*1\. 只使用 build.gradle*

--build.gradle--

```
apply plugin: 'groovy'
apply plugin: 'java'
apply plugin: 'idea'
apply plugin: 'maven'
apply plugin: 'js'

buildscript {
    repositories {
        mavenLocal()
        mavenCentral()
    }

    dependencies {
        compile findProject "/path/to/gradle-js-plugin"
    }
}

repositories {
    mavenLocal()
    mavenCentral()
} 
```

**结果：**

```
FAILURE: Build failed with an exception.

* Where:
Build file '/path/to/gradle-js-plugin/src/test/resources/build.gradle' line: 13

* What went wrong:
A problem occurred evaluating root project 'resources'.
> No such property: findProject for class: org.gradle.api.internal.artifacts.dsl.dependencies.DefaultDependencyHandler

* Try:
Run with --stacktrace option to get the stack trace. Run with --info or --debug option to get more log output.

BUILD FAILED

Total time: 8 mins 50.498 secs 
```

*2\. 同时使用 build.gradle 和 settings.gradle*

--settings.gradle--

```
include "/path/to/gradle-js-plugin" 
```

--build.gradle--

```
apply plugin: 'groovy'
apply plugin: 'java'
apply plugin: 'idea'
apply plugin: 'maven'
apply plugin: 'js'

buildscript {
    repositories {
        mavenLocal()
        mavenCentral()
    }
}

repositories {
    mavenLocal()
    mavenCentral()
} 
```

**结果：**

```
FAILURE: Build failed with an exception.

* Where:
Build file '/path/to/gradle-js-plugin/src/test/resources/build.gradle' line: 5

* What went wrong:
A problem occurred evaluating root project 'resources'.
> Plugin with id 'js' not found.

* Try:
Run with --stacktrace option to get the stack trace. Run with --info or --debug option to get more log output.

BUILD FAILED

Total time: 13.553 secs 
```

* * *

## 我的设置

### 摇篮

```
~# gradle -v
------------------------------------------------------------
Gradle 1.0
------------------------------------------------------------

Gradle build time: Tuesday, June 12, 2012 12:56:21 AM UTC
Groovy: 1.8.6
Ant: Apache Ant(TM) version 1.8.2 compiled on December 20 2010
Ivy: 2.2.0
JVM: 1.7.0_04 (Oracle Corporation 23.0-b21)
OS: Linux 3.2.0-2-amd64 amd64 
```

### 爪哇

```
~# java -version
java version "1.7.0_04"
Java(TM) SE Runtime Environment (build 1.7.0_04-b20)
Java HotSpot(TM) 64-Bit Server VM (build 23.0-b21, mixed mode) 
```

### 智能

```
IntelliJ IDEA Ultimate 117.499 w/ Bundled Gradle plugin 
```

# 希望

任何能让我在插件中进入调试模式的提示。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2014-06-11T15:14:20.797

我能够使用`-Dorg.gradle.debug=true`（[在 gradle forum 上](http://forums.gradle.org/gradle/topics/recommended_plugin_debugging_technique)找到）调试 gradle 源（包括插件）：

1.  停止守护进程（如果有）：

    `./gradlew --stop`

2.  跑

    `./gradlew <task> --no-daemon -Dorg.gradle.debug=true`

3.  远程连接到 gradle 进程（端口 5005） - 如果使用 IntelliJ IDEA，请参见上面的 OP 图像

它现在应该在断点处停止。

* * *

顺便说一句，我为 gradle 源创建了一个单独的 IntelliJ IDEA 项目。由于我使用 gradle 包装器，我已经从

`~/.gradle/wrapper/dists/gradle-1.11-all/7qd8qq8te5j4f5q9aaei3gh3lj/gradle-1.11/src`

在 IDEA 中我做了`File->Import Project`，然后选择了上面的路径，然后 - “从现有来源创建项目”。点击 Next 几次（确保我没有包含`lib/plugins`目录中的任何 jar，因为 IDEA 会抱怨大多数项目文件已经存在）。

然后，我在该 IDEA 项目中创建了一个远程调试配置，并将其用于调试 gradle。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2012-06-20T23:42:03.723

首先，听起来您的 IDEA Gradle 项目有问题。如果您运行`gradlew cleanIdea idea`然后从 IDEA 打开生成的项目（而不是使用 JetGradle 插件），一切都应该没问题。

其次，如果您仍然无法让 GradleMain/GradleLauncher（前一个类*确实*存在）方法工作，另一种方法是将 Gradle 构建作为外部应用程序进行调试。为此，您需要添加`-Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=y,address=5005`到`GRADLE_OPTS`环境变量，从命令行运行构建，等到它挂起，然后从 IDEA 启动“远程”运行配置（具有相应的设置）。此时调试器应连接到 Gradle 进程，您应该已启动并运行。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2013-03-28T08:54:28.833

IntelliJ IDEA 12.1 提供开箱即用调试 gradle 任务的能力 - 右键单击​​ JetGradle 工具窗口任务列表中的目标任务并选择“调试”

# android - 从我的应用程序保存图片

> ID：11129406
> 
> 赞同：-1
> 
> 时间：2012-06-20T23:02:22.427
> 
> 标签：android

我的应用程序的想法是从相机捕获图像，然后从中裁剪指定区域。

问题：当我第一次将裁剪的图像保存在我的 sd 卡中以启动应用程序时，它正确保存。但是当再次运行我的应用程序并拍摄图像然后裁剪它时。保存时，第一次拍摄和裁剪的第一张图像出现在 SD 卡中，而不是当前的一张。

这是我保存图像的代码：

```
public static void save(Activity activity, Bitmap bm, String name) {
    OutputStream outStream = null;

    File externalFilesDir = activity.getExternalFilesDir(Environment.DIRECTORY_PICTURES);
    File outFile = new File(externalFilesDir, "IDOCR" + File.separator + "Numbers");

    if (!outFile.exists())
        outFile.mkdirs();

    File number = new File(outFile, name + ".PNG");
    //if (number.exists())
    //  number.delete();
    try {
        //outStream = new FileOutputStream(new File(path));
        outStream = new FileOutputStream(number);
        bm.compress(Bitmap.CompressFormat.PNG, 100, outStream);
        outStream.flush();
        outStream.close();

        bm.recycle();
        System.gc();

    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T23:06:59.617

也许如果你试图覆盖文件的以前版本，你应该先删除以前的......

你可以加：

```
if (!outFile.exists())
    outFile.mkdirs();
else {
    outFile.delete();
    outFile.createNewFile();
} 
```

# python - 将进程从多处理重定向到单独的 wx.TextCtrl

> ID：11129414
> 
> 赞同：0
> 
> 时间：2012-06-20T23:04:15.490
> 
> 标签：python, wxpython, multiprocessing

我有四个文本框和最多四个进程，我将开始使用多处理模块。我可以让进程正确执行，但我真的很想将每个进程的所有输出重定向到不同的 wx.TextCtrl，这样我就可以看到整个解决方案过程中发生了什么。我已经用一个线程和 sys.stdout 重定向成功地做到了这一点，如

[http://www.velocityreviews.com/forums/t515815-wxpython-redirect-the-stdout-to-a-textctrl.html](http://www.velocityreviews.com/forums/t515815-wxpython-redirect-the-stdout-to-a-textctrl.html)

但是类似的想法不适用于流程。有人可以为我破解这个问题的简单解决方案吗？我无法想象我是唯一遇到过这个问题的人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-30T15:24:35.143

对于那些感兴趣的人，这里是一个工作代码片段，它可以满足我最初的问题。这是一种享受。

此代码创建一个包装进程的线程。在进程的 run() 函数中，stderr 和 stdout 使用重定向类重定向到管道。可以腌制管道，这是在流程的 run() 函数中使用它们的先决条件。

只要有输出等待，线程就会坐下来从管道中提取输出。使用 wx.CallAfter 函数将从管道中提取的文本写入 wx.TextCtrl。请注意，这是一个非阻塞调用，实际上这里的所有代码都是非阻塞的，这使得 GUI 具有响应性。请注意重定向类中的 flush() 函数也可以重定向 stderr。

注意：需要注意的一件事是，如果您尝试使用管道以过高的吞吐量进行读写，则 GUI 将锁定。但只要你的输出速度相当慢，就没有问题

```
import wx
import sys
import time
from multiprocessing import Pipe, Process
from threading import Thread

class RedirectText2Pipe(object):
    def __init__(self, pipe_inlet):
        self.pipe_inlet = pipe_inlet
    def write(self, string):
        self.pipe_inlet.send(string)
    def flush(self):
        return None

class Run1(Process):
    def __init__(self, pipe_inlet):
        Process.__init__(self)
        self.pipe_std = pipe_inlet

    def run(self):
        redir = RedirectText2Pipe(self.pipe_std)
        sys.stdout = redir
        sys.stderr = redir

        for i in range(100):
            time.sleep(0.01)
            print i,'Hi'

class RedirectedWorkerThread(Thread):
    """Worker Thread Class."""
    def __init__(self, stdout_target):
        """Init Worker Thread Class."""
        Thread.__init__(self)
        self.stdout_target_ = stdout_target

    def run(self):
        """
        In this function, actually run the process and pull any output from the 
        pipes while the process runs
        """
        pipe_outlet, pipe_inlet = Pipe(duplex = False)
        p = Run1(pipe_inlet)
        p.daemon = True
        p.start()

        while p.is_alive():
            #Collect all display output from process
            while pipe_outlet.poll():
                wx.CallAfter(self.stdout_target_.WriteText, pipe_outlet.recv())

class MainFrame(wx.Frame):
    def __init__(self):
        wx.Frame.__init__(self,None)

        self.txt1 = wx.TextCtrl(self, style = wx.TE_MULTILINE|wx.TE_READONLY)
        self.txt2 = wx.TextCtrl(self, style = wx.TE_MULTILINE|wx.TE_READONLY)
        self.txt3 = wx.TextCtrl(self, style = wx.TE_MULTILINE|wx.TE_READONLY)
        self.btn = wx.Button(self, label='Run')
        self.btn.Bind(wx.EVT_BUTTON, self.OnStart)

        sizer = wx.BoxSizer(wx.VERTICAL)
        sizer.AddMany([(self.txt1,1,wx.EXPAND),(self.txt2,1,wx.EXPAND),(self.txt3,1,wx.EXPAND),self.btn])
        self.SetSizer(sizer)

    def OnStart(self, event):
        t1 = RedirectedWorkerThread(self.txt1)
        t1.daemon = True
        t1.start()

        t2 = RedirectedWorkerThread(self.txt2)
        t2.daemon = True
        t2.start()

        t3 = RedirectedWorkerThread(self.txt3)
        t3.daemon = True
        t3.start()

if __name__ == '__main__':
    app = wx.App(False)
    frame = MainFrame() 
    frame.Show(True) 
    app.MainLoop() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T13:40:26.600

据我了解，在 wxPython 领域，您通常希望从线程运行进程。因此，您从进程到线程以及从线程返回到 wxPython 进行通信。我会使用某种命名方案将每个潜在进程与文本控件（可能是 1-4？）相关联，并将其传递回将使用 wx.CallAfter 或 wx.PostEvent 告诉 wx 更新的线程。

您也可以使用简单的 Python 套接字服务器来完成此操作。向服务器发布一条带有标头的消息，该标头说明它属于哪个文本控件。在 wx 部分，您可以让 wx.Timer 检查套接字服务器是否有新消息并根据需要进行更新。

# xcode - 在 Xcode 中链接 OpenCV 静态库

> ID：11129418
> 
> 赞同：1
> 
> 时间：2012-06-20T23:04:47.810
> 
> 标签：xcode, opencv, build, static-libraries

（我在这里讨论的几乎所有内容都是新手......如果问题非常基本，我很抱歉） - 我使用 Xcode 使用 OpenCV（动态库）编写了一些 C++ 代码。该算法运行平稳，我创建了一个也可以运行的可执行文件。但是，它只适用于我的电脑。

我知道我需要使用静态库而不是动态库。我做了一些研究，发现如何在这里做到这一点：http: [//www.shiffman.net/2011/01/23/how-to-build-opencv-static-libraries-mac-os-x/](http://www.shiffman.net/2011/01/23/how-to-build-opencv-static-libraries-mac-os-x/)和这里：[http://www.randomsequence.com/articles/opencv-snow-leopard/](http://www.randomsequence.com/articles/opencv-snow-leopard/)。

我已经按照这些步骤进行了操作，尽管我必须进行一些更改，但我还是能够构建“.a”文件，例如“libopencv_highgui.a”。

但是，当我替换库时，我的代码不再起作用。我收到 200 多个错误。这是其中之一：

> 架构 x86_64 的未定义符号：“_gzputs”，引用自：libopencv_core.a(persistence.o) 中的 __ZL7icvPutsP13CvFileStoragePKc

我在这里搜索过这个问题，但这是我能找到的最接近的：[Linking OpenCV library in Xcode](https://stackoverflow.com/questions/10805202/linking-opencv-libraries-in-xcode)（不完全相同的问题）。

谢谢大家！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T00:11:53.553

您需要`.a`来自`$OPENCV_BUILD_PATH/3rdparty/lib/`.

你的`_gzputs`问题属于`libzlib.a`

* * *

要与 OpenCV 静态库链接，您还需要将所有 OpenCV 的依赖项添加到您的应用程序中。这些依赖项大部分来自 opencv_highui 模块，依赖项列表取决于您的构建配置，因此我无法告诉您完整列表。但是您可以自己找到它：`CMakeCache.txt`使用任何文本编辑器从您的 OpenCV 构建目录中打开并搜索`opencv_highgui_LIB_DEPENDS`line。您需要该行中的所有项目，但 word 除外`general`。

# c# - SQLite 不保存记录

> ID：11129422
> 
> 赞同：2
> 
> 时间：2012-06-20T23:05:33.770
> 
> 标签：c#, sqlite

我有一个名为 ID 的文本框和一个保存按钮。单击保存按钮后，我想简单地将我在文本框中写入的任何内容存储在 SQLite 数据库文件中。

代码正在编译，程序运行没有任何错误，但我没有看到我在同一应用程序下创建的数据库文件 (file1.db) 中保存的任何记录。

```
namespace WindowsFormsApplication1
{
public partial class Form1 : Form
{
    private SQLiteConnection sqlcon;
    private SQLiteCommand sqlcmd;
    private SQLiteDataAdapter dataBase;
    private DataSet dataSet = new DataSet();
    private DataTable dataTable = new DataTable();

    public Form1()
    {
        InitializeComponent();
    }

    private void createDataBase()
    {
       dataBase = new SQLiteDataAdapter();
    }

    private void ExecuteQuery(string txtQuery)
    {            
     using (SQLiteConnection sqlcon = new SQLiteConnection("Data Source=file1.db"))
     {
            using (SQLiteCommand sqlcmd = sqlcon.CreateCommand())
            {
                sqlcon.Open();
                sqlcmd.CommandText = txtQuery;
                sqlcmd.ExecuteNonQuery();
            }
        }
    }

    private void createDataTable()
    {
        dataTable = new DataTable();
        string txtQuery1 = "CREATE TABLE RECORDS ( ID varchar(255))";
        ExecuteQuery(txtQuery1);
    }

    private void button1_Click(object sender, EventArgs e)
    {
        string txtQuery2 = "INSERT INTO RECORDS (ID) VALUES ('" + textBox1.Text + "')";
        ExecuteQuery(txtQuery2);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T23:12:52.690

几件事。

首先，我看不到您实际上将查询传递给您的`ExecuteQuery`方法的位置。您需要修改您的按钮单击方法，如下所示：

```
protected void button1_Click(object sender, EventArgs e)
{
  string txtQuery = "INSERT INTO RECORDS ID VALUES  ('" + textBox1.Text + "')";
  ExecuteQuery(txtQuery);
} 
```

其次，查询本身看起来很奇怪。通常结构类似于

```
INSERT INTO RECORDS(ID) VALUES('myvalue') 
```

您是否尝试过直接执行它？

最后，我强烈建议你重写它并摆脱你的全局连接和命令变量。除了不好的做法之外，您所拥有的可能会泄漏内存并通常会导致其他问题。任何实现 IDisposable 的东西，例如 SQLiteConnection 和 SQLiteCommand 都应该包含在 using 子句中。例如：

```
using (SQLiteConnection conn = new SQLiteConnection("conn string")) {
  using (SQLiteCommand cmd = conn.CreateCommand()) {
    sqlcmd.CommandText = txtQuery;
    sqlcmd.ExecuteNonQuery();    
  }
} 
```

这将在每个查询运行后自动清理。此外，由于连接池，它就像您使用全局变量来缓存它们一样快。最后，如果发生错误，您不必担心内存泄漏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T23:13:20.143

您没有执行查询。尝试这个：

```
private void button1_Click(object sender, EventArgs e)
{
  string txtQuery = "INSERT INTO RECORDS ID VALUES    ('" + textBox1.Text + "')";  
  ExecuteQuery(txtQuery);
} 
```

# html - CSS3 Columns - 添加第二个元素后的额外宽度

> ID：11129426
> 
> 赞同：2
> 
> 时间：2012-06-20T23:06:10.073
> 
> 标签：html, css, markup

我有一个应用了 CSS3 列的元素。元素 ( `div.parent`) 具有 a`min-width`和 a `max-width`。子元素 ( `article.space`) 将附加到父元素，填充左列，然后填充右列。

这是带有一个子元素的标记：

```
<div class="parent" style="height: 888px;">
    <article class="space">
        <header>
            <h3>Header3</h3>
            <h4>Header4</h4>
            <h5>Header5</h5>
        </header>
        <section>
            <img src="" alt="img">
            <p>3:06</p>
        </section>
    </article>
</div> 
```

```
.parent {
    -webkit-column-width: 190px;
    -webkit-column-gap: 5px;
    min-width: 190px;
    max-width: 410px;
}

.space {
     width: 190px;
     height: 50px;
     display: inline-block;
} 
```

所以基本上，div 是矩形的，它们需要填充第一列，然后是第二列，然后如果我将`.parent`'s设置`max-width`为更大的数字，第三列等等。

除了一件事，这一切都有效。如果我附加超过 2 `article.space`，`.parent`则扩展到它的`max-width`. 当只有一个`article.space`时，`.parent`的宽度很好，但如果有两个或更多，它会自动将其扩展为`max-width`集合。

这是一些图片：（我为所有的白盒子道歉，我不能分享这是为了什么）

![](../Images/48772645420cfa8c62b9800d25436b17.png)

![](../Images/993c91131953d75f4cc09867a117d04e.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T19:03:15.407

看看这个。有什么问题？ [http://jsfiddle.net/zMGyp/](http://jsfiddle.net/zMGyp/)

# html - HTML5 Web SQL 数据库可以跨页面使用吗？

> ID：11129427
> 
> 赞同：0
> 
> 时间：2012-06-20T23:06:16.527
> 
> 标签：html, dns, web-sql

这可能是一个非常简单的问题，所以请原谅我的无知，但是 Web SQL 数据库可以跨同一域的页面读取吗？

例如，如果我在 mydomain.com/createdata 页面上插入数据，是否可以在 mydomain.com/readdata 上查询相同的数据？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T23:09:42.113

它是本地浏览器存储，因此在同一域的任何页面中读取此表单都没有问题。它是专门为它设计的。当您需要跨域共享Web SQL数据库时出现问题，这种情况下您应该处理[同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T23:13:36.390

是的。在同一个域内是没有问题的。我相信每个域的存储容量有 5MB 的限制。

有关示例和参考代码，请查看[html5Rocks - 存储](http://www.html5rocks.com/en/features/storage)

# css - 如何使用 codeigniter 从数据库加载 css

> ID：11129428
> 
> 赞同：1
> 
> 时间：2012-06-20T23:06:30.153
> 
> 标签：css, codeigniter

我正在开发一个 CMS，所以我需要将每个站点的全局 css 文件存储在数据库中并加载。我有一个名为 util 的控制器，该方法称为 sitecss。所以我的主要包装视图如下所示：

```
<link rel="stylesheet" type="text/css" href="/util/sitecss"> 
```

css 加载，但没有效果。如果我在页面上查看源代码，然后单击链接，我可以看到 css 就好了。所以我知道它正在加载。它不是来自文件吗？或者也许浏览器假设它没有被缓存？

如果我制作一个静态文件并更改为上面

```
<link rel="stylesheet" type="text/css" href="/css/site.css"> 
```

一切正常。如果我在 .NET 中使用处理程序 ashx 文件执行此操作，则它可以正常工作。我遇到问题是在带有 Codeigniter 的 php 中。我知道有人会问“为什么不直接制作静态文件？” 答案是，这对于这个应用程序是不实用的。这适用于部署速度非常快的数千个站点。

提前致谢！

编辑：

我的控制器方法如下所示：

```
function sitecss() {
    $cssdata = $this->cmsutils->loadCss($this->session->userdata('sitecss'));
    echo $cssdata;
} 
```

那么我可以先回显一个哑剧类型吗？这似乎不起作用，因为我在

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T23:16:04.497

您是否可以通过将 css 从控制器传递给视图来加载 css，然后在标题中的某个地方或视图中的其他地方回显它，如下所示：

控制器：

```
$data['css_rules'] = $this->yourcssmodel->get_css_rules_function();
$this->load->view('yadayadayada, $data); 
```

视图：（可能在标题中）

```
?>
<style>
<?echo $css_rules;?>
</style> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T03:31:20.090

编写一个缓存库以从数据库中提取并在缓存文件夹中创建一个 css 文件。

## 你会需要：

### 图书馆类

*   与 css 交互并创建一个表单来执行 CRUD
*   处理缓存文件监控 CRUD（每小时，甚至在表单的每个 C、U、D 上）
*   将样式表缓存文件注入 DOM 视图

### 模型

*   与数据库交互并执行 CRUD 操作
*   将数据返回给Controller以创建缓存文件

### 看法

*   将值解析为 css 样式表文件格式

另一种选择是使用控制器定义一个 mime 类型，然后只加载一个样式表格式正确的视图。不写入文件系统或任何东西。在 URI 的末尾添加一个 .css 扩展名并称之为好...

* * *

我对刚刚发布的应用程序做同样的事情。我在具有指定文本字段的应用程序的管理部分的视图中有一个表单。用户输入十六进制颜色代码，然后保存/更新数据库中的数据。然后，该库会创建一个在标题视图中引用的缓存 css 文件。`.gitignore`当我们将应用程序部署到多个客户端时，我们这样做是为了消除我们在特殊目录中添加文件的需要。

# python - 在 HDF5 (PyTables) 中存储 numpy 稀疏矩阵

> ID：11129429
> 
> 赞同：21
> 
> 时间：2012-06-20T23:06:32.960
> 
> 标签：python, numpy, scipy, hdf5, pytables

我在使用 PyTables 存储 numpy csr_matrix 时遇到问题。我收到此错误：

```
TypeError: objects of type ``csr_matrix`` are not supported in this context, sorry; supported objects are: NumPy array, record or scalar; homogeneous list or tuple, integer, float, complex or string 
```

我的代码：

```
f = tables.openFile(path,'w')

atom = tables.Atom.from_dtype(self.count_vector.dtype)
ds = f.createCArray(f.root, 'count', atom, self.count_vector.shape)
ds[:] = self.count_vector
f.close() 
```

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2014-03-23T09:23:46.667

DaveP 的答案*几乎*是正确的......但可能会导致非常稀疏的矩阵出现问题：如果最后一列或最后一行是空的，它们就会被删除。因此，为了确保一切正常，“形状”属性也必须存储。

这是我经常使用的代码：

```
import tables as tb
from numpy import array
from scipy import sparse

def store_sparse_mat(m, name, store='store.h5'):
    msg = "This code only works for csr matrices"
    assert(m.__class__ == sparse.csr.csr_matrix), msg
    with tb.openFile(store,'a') as f:
        for par in ('data', 'indices', 'indptr', 'shape'):
            full_name = '%s_%s' % (name, par)
            try:
                n = getattr(f.root, full_name)
                n._f_remove()
            except AttributeError:
                pass

            arr = array(getattr(m, par))
            atom = tb.Atom.from_dtype(arr.dtype)
            ds = f.createCArray(f.root, full_name, atom, arr.shape)
            ds[:] = arr

def load_sparse_mat(name, store='store.h5'):
    with tb.openFile(store) as f:
        pars = []
        for par in ('data', 'indices', 'indptr', 'shape'):
            pars.append(getattr(f.root, '%s_%s' % (name, par)).read())
    m = sparse.csr_matrix(tuple(pars[:3]), shape=pars[3])
    return m 
```

使其适应 csc 矩阵是微不足道的。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-06-21T00:56:23.053

一个 CSR 矩阵可以从它的`data`,`indices`和`indptr`属性中完全重构。这些只是常规的 numpy 数组，因此将它们作为 3 个单独的数组存储在 pytables 中应该没有问题，然后将它们传递回`csr_matrix`. 请参阅[scipy 文档](http://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_matrix.html)。

**编辑：** Pietro 的回答指出该`shape`成员也应该被存储

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-05-31T10:46:34.943

我已经更新了[Pietro Battiston](http://stackoverflow.com/users/2858145/)对 Python 3.6 和[PyTables](http://www.pytables.org/) 3.x 的出色回答，因为一些 PyTables 函数名称在从 2.x 升级时发生了变化。

```
import numpy as np
from scipy import sparse
import tables

def store_sparse_mat(M, name, filename='store.h5'):
    """
    Store a csr matrix in HDF5

    Parameters
    ----------
    M : scipy.sparse.csr.csr_matrix
        sparse matrix to be stored

    name: str
        node prefix in HDF5 hierarchy

    filename: str
        HDF5 filename
    """
    assert(M.__class__ == sparse.csr.csr_matrix), 'M must be a csr matrix'
    with tables.open_file(filename, 'a') as f:
        for attribute in ('data', 'indices', 'indptr', 'shape'):
            full_name = f'{name}_{attribute}'

            # remove existing nodes
            try:  
                n = getattr(f.root, full_name)
                n._f_remove()
            except AttributeError:
                pass

            # add nodes
            arr = np.array(getattr(M, attribute))
            atom = tables.Atom.from_dtype(arr.dtype)
            ds = f.create_carray(f.root, full_name, atom, arr.shape)
            ds[:] = arr

def load_sparse_mat(name, filename='store.h5'):
    """
    Load a csr matrix from HDF5

    Parameters
    ----------
    name: str
        node prefix in HDF5 hierarchy

    filename: str
        HDF5 filename

    Returns
    ----------
    M : scipy.sparse.csr.csr_matrix
        loaded sparse matrix
    """
    with tables.open_file(filename) as f:

        # get nodes
        attributes = []
        for attribute in ('data', 'indices', 'indptr', 'shape'):
            attributes.append(getattr(f.root, f'{name}_{attribute}').read())

    # construct sparse matrix
    M = sparse.csr_matrix(tuple(attributes[:3]), shape=attributes[3])
    return M 
```

# java - 如何在 Android 中更改按钮大小？

> ID：11129430
> 
> 赞同：1
> 
> 时间：2012-06-20T23:06:41.400
> 
> 标签：java, android, button, resize

我正在尝试动态更改按钮大小，但使用后`setWidth()`并`setHeight()`没有任何反应。

这是我的代码...

```
GridLayout grid = (GridLayout)findViewById(R.id.grid);
grid.setColumnCount(10);
grid.setRowCount(10);
cells = new Button[100];
for (int i = 0; i < cells.length; i++) { 
    cells[i] = new Button(this);
    cells[i].setWidth(grid.getWidth()/10);
    cells[i].setHeight(grid.getHeight()/10);
    grid.addView(cells[i]);
} 
```

有什么想法/解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T23:13:51.020

LayoutParams 应该解决这个问题：

这是从另一个stackOverflow帖子中获取的如何工作的示例：

```
ViewGroup.LayoutParams params = myButton.getLayoutParams(); 
params.width = 400;    
myButton.setLayoutParams(params); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T15:14:50.090

这是我自己想出来的，很简单，忽略它我觉得很愚蠢。

```
grid.addView(cells[i], display.getWidth()/grid.getColumnCount(), display.getWidth()/grid.getColumnCount()); 
```

在这行代码中，我使用“cells[i]”将按钮添加到布局中，而后面的两个参数告诉视图我想要按钮的大小。

另一个例子：

```
addView(myButton, 100, 200); 
```

在 addView 上方添加了宽度为 100 像素、高度为 200 像素的 myButton。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T23:15:29.477

也许尝试调用`invalidate`方法。如果视图可见，`onDraw(android.graphics.Canvas)`将在将来的某个时间点调用。这必须从 UI 线程调用。要从非 UI 线程调用，请调用`postInvalidate()`.

来源：http: [//developer.android.com/reference/android/view/View.html#invalidate%28%29](http://developer.android.com/reference/android/view/View.html#invalidate%28%29)

# r - 给定 25,50,75 个百分位数以及最小值和最大值，在 R 中绘制 bloxplots

> ID：11129432
> 
> 赞同：3
> 
> 时间：2012-06-20T23:06:52.180
> 
> 标签：r, boxplot

> **可能重复：**
> [geom_boxplot 与预先计算的值](https://stackoverflow.com/questions/10628847/geom-boxplot-with-precomputed-values)

我有一个表，其中每一行是一个不同的样本，每一列分别是名称、最小值、最大值、平均值、第 25 个百分位、第 50 个百分位、第 75 个百分位。这是一个示例。

```
sample1   1   38   10   8    10   13
sample2   1   39   10   9    11   14
sample3   2   36   11   10   10   13 
```

我想知道如何使用这种格式的数据来绘制箱线图，因为那是实际绘制的数据。上面的格式是一个制表符分隔的表格。谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-21T01:08:13.483

[这篇文章](https://stats.stackexchange.com/questions/27690/is-it-possible-to-plot-a-boxplot-from-previously-calculated-statistics-easily-i)展示了如何使用使用`bxp`的函数来执行此操作`boxplot`，但是您需要以正确的顺序放置数据，第一行是最小值，最后一行是最大值。

一、读入数据

```
dat <- read.table(text="sample1   1   38   10   8    10   13
sample2   1   39   10   9    11   14
sample3   2   36   11   10   10   13", row.names=1, header=FALSE) 
```

然后，整理并`t`整理

```
dat2 <- t(dat[, c(1, 4, 5, 6, 2)]) #Min, 25pct, 50pct, 75pct, Max 
```

和情节

```
bxp(list(stats=dat2, n=rep(10, ncol(dat2)))) #n is the number of observations in each group 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T23:13:33.050

这是重复的，但是为了后代，因为我已经开始写作了......

```
dat <- data.frame(name=paste0('sample',1:3), min=c(1,1,2), max=c(38,39,36), mean=c(10,10,11), q25=c(8,9,10), q50=c(10,11,10), q75=c(13,14,13))

ggplot(dat, aes(x=name, ymin=min, ymax=max, lower=q25, middle=q50, upper=q75))+geom_boxplot(stat='identity') 
```

# postgresql - 从 PostgreSQL 函数发出通知

> ID：11129438
> 
> 赞同：-1
> 
> 时间：2012-06-20T23:07:22.490
> 
> 标签：postgresql, plpgsql

我有一个更新几个表的功能。例如，假设它做了类似的事情：

```
UPDATE foo SET bar = some_value;
UPDATE boo SET far = another_value; 
```

我希望能够查看每个表中更新了多少条记录。我知道我可以使用 Raise Notice 显示信息，但不知道如何获取每个语句更新的记录数。

我正在使用 PostgreSQL 9.1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T07:44:53.780

你需要使用：

[得到诊断](http://www.postgresql.org/docs/9.1/static/plpgsql-statements.html#PLPGSQL-STATEMENTS-DIAGNOSTICS)

例如（在您的函数中）：

```
...
sql := 'UPDATE foo SET bar = some_value';
EXECUTE sql;
GET DIAGNOSTICS rowsAffected = ROW_COUNT;
... 
```

我希望这有帮助。

# copy - DOS复制文件到多个目录

> ID：11129443
> 
> 赞同：1
> 
> 时间：2012-06-20T23:08:02.193
> 
> 标签：copy, dos

我不知道如何在 Windows Dos 中复制多个目录中的文件。基本上我想为windows复制这个linux命令

cp ../../../Dir/Item.o Item.o

基本上我需要从一个名为“Dir”的文件夹中将一个包含 3 个文件夹的项目复制到我的当前目录中。我使用它（在 linux 中）作为构建步骤的一部分，并希望对 windows 做同样的事情。我试过改变“..”但没有用。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T23:18:29.680

在 Windows 上几乎是一样的。您需要正确的命令，并且需要使用反斜杠而不是正斜杠

```
copy ..\..\..\Dir\Item.o Item.o 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T23:12:32.287

```
copy ..\..\Dir\Item.o . 
```

您需要使用反斜杠作为目录分隔符。 `.`表示当前目录

# php - 隐藏生成的 HTML 表中的第一列

> ID：11129445
> 
> 赞同：0
> 
> 时间：2012-06-20T23:08:17.310
> 
> 标签：php, mysql, html

我有这个脚本可以生成一个基于 MySql 表的 HTML 表。我想让它隐藏第一列。

```
for($i=0; $i<$fields_num; $i++)
{
    $field = mysql_fetch_field($result);

    echo "<th id = 'tableheader'>{$field->name}</th>";
}
echo "</tr>\n";
echo "<tr><td id = 'line'></td id = 'line'><td id = 'line' ></td><td id = 'line' ></td><td id = 'line' ></td><td id = 'line' ></td></tr>";
// printing table rows

while($row = mysql_fetch_row($result))
{
    echo "<tr>";

    // $row is array... foreach( .. ) puts every element
    // of $row to $cell variable
    foreach($row as $cell)
        echo "<td id = 'tabledata'>$cell</td>";
    echo "<td><form method='post' action='delete.php'><input type='hidden' name='id' value='{$row['0']}'/><input type='submit' value='Delete'/></form></td>";
    echo "</tr>\n";
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T23:16:53.030

你可以用 CSS 做到这一点：

```
th:first-child, td:first-child {
    display: none;
} 
```

**现场演示：http:** [//jsfiddle.net/Pzf9Y/2/](http://jsfiddle.net/Pzf9Y/2/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T04:48:56.807

您可能需要了解[array_shift](http://php.net/manual/en/function.array-shift.php)

**例子**

```
$array = array(
    'one',
    'two',
    'three',
    'four',
    'five',
);
array_shift($array); // Remove the first element of array

foreach($array as $data){
    echo 'I\'m number '.$data.'<br/>';
} 
```

输出 ：

*   我是二号
*   我是第三
*   我是第四
*   我是五号

# sencha-touch - 如何在 Sencha Architect 2 中为多个项目添加“Ext.require”？

> ID：11129446
> 
> 赞同：0
> 
> 时间：2012-06-20T23:08:20.083
> 
> 标签：sencha-touch, sencha-architect

如何在 Sencha Architect 2 中为多个项目添加“Ext.require”？

在应用程序节点中，我有一个必填字段，但它只允许我包含一项，例如 Ext.data.proxy.JsonP

我应该怎么做才能添加多个项目？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T14:13:48.397

一旦您直接在其下方输入一个要求，就会有一个空白区域，其中包含文本“（添加另一个）”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-01T08:10:36.673

您也可以始终传入一个对象或值数组。这对于在没有复制和粘贴导入的情况下将某些扩展程序或代码转码/集成到您的应用程序时特别方便。

# javascript - 如何制作一个计算器但有两个以上的输入？

> ID：11129460
> 
> 赞同：-1
> 
> 时间：2012-06-20T23:09:20.130
> 
> 标签：javascript, calculator

这是我基于我的代码的链接....但是如果有意义的话，我希望有两个以上的区域可以输入数字...所以数字 1，数字 2，然后数字 3... ETC

[关联](http://kalyan-city.blogspot.com/2009/11/simple-javascript-calculator-code.html)

我试图将所有内容复制下来，然后添加

```
c=Number(document.calculator.number3.value); 
d=Number(document.calculator.number4.value);

<!-- Here user will enter 3rd number. -->   
Number 3: <input type="text" name="number3">  
<!-- Here user will enter 4th number. -->   
Number 4: <input type="text" name="number4"> 
```

并将结果更改为 e=a+b+c+d 但随后计算器停止运行

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T23:16:52.817

试试 - [http://jsfiddle.net/GmDuE/](http://jsfiddle.net/GmDuE/)

HTML

```
Number 1: <input type="text" name="number1">
Number 2: <input type="text" name="number2">
Number 3: <input type="text" name="number3">
Number 4: <input type="text" name="number4"> 
```

JS

```
<script language="javascript" type="text/javascript">
function multiply(){
a=Number(document.calculator.number1.value);
b=Number(document.calculator.number2.value);
c=Number(document.calculator.number3.value);
d=Number(document.calculator.number4.value);
m=a*b*c*d;
document.calculator.total.value=m;
}

function addition(){
a=Number(document.calculator.number1.value);
b=Number(document.calculator.number2.value);
c=Number(document.calculator.number3.value);
d=Number(document.calculator.number4.value);
m=a+b+c+d;
document.calculator.total.value=m;
}
</script>

etc. 
```

# php - 修改一个 php 限制文本函数，为其添加某种偏移量

> ID：11129461
> 
> 赞同：5
> 
> 时间：2012-06-20T23:09:25.417
> 
> 标签：php

也许你们可以帮忙：

我有一个名为 $bio 的变量，其中包含生物数据。

```
$bio = "Hello, I am John, I'm 25, I like fast cars and boats. I work as a blogger and I'm way cooler then the author of the question"; 
```

我使用一组函数搜索 $bio 来搜索某个单词，比如说**“作者”**，它**在该单词周围添加了一个 span 类**，我得到：

```
$bio = "Hello, I am John, I'm 25, I like fast cars and boats. I work as a blogger and I'm way cooler then the <span class=\"highlight\">author</span> of the question"; 
```

我使用一个函数将文本限制为 85 个字符：

```
$bio = limit_text($bio,85); 
```

**问题是当****$bio**中的**“作者”**一词之前有超过 80 个字符时。应用时，我不会看到突出显示的词作者。**`limit_text()`**

 ****我需要让 limit_text() 函数正常工作，在最后添加包含 span 类突出显示的所有单词。像这样的东西：**

```
*"This is the limited text to 85 chars, but there are no words with the span class highlight so I am putting to be continued ... **author**, **author2** (and all the other words that have a span class highlight around them separate by comma "* 
```

希望您理解我的意思，如果没有，请发表评论，我会尽力解释得更好。

这是我的`limit_text()`功能：

```
function limit_text($text, $length){ // Limit Text
        if(strlen($text) > $length) {
        $stringCut = substr($text, 0, $length);
        $text = substr($stringCut, 0, strrpos($stringCut, ' '));
        }
        return $text;
    } 
```

**更新**：

```
$xturnons = str_replace(",", ", ", $xturnons);
$xbio = str_replace(",", ", ", $xbio);

$xbio = customHighlights($xbio,$toHighlight); 
$xturnons = customHighlights($xturnons,$toHighlight);

$xbio = limit_text($xbio,85);
$xturnons = limit_text($xturnons,85); 
```

添加 span 类的`customHighlights`函数突出显示：

```
function addRegEx($word){ // Highlight Words
        return "/" . $word . '[^ ,\,,.,?,\.]*/i';
    }
    function highlight($word){
        return "<span class='highlighted'>".$word[0]."</span>";
    }
    function customHighlights($searchString,$toHighlight){
        $searchFor = array_map('addRegEx',$toHighlight);
        $result = preg_replace_callback($searchFor,'highlight',$searchString);
        return $result;
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-28T01:15:25.003

对函数的这种更改`limit_text`将采用文本，如果它比给定的`$length`. 如果您将 a 传递`$needle`给它，它将搜索它的第一次出现，并以它结束您的句子。

此外，如果文本在实际长度之前被剪切，它将添加`$addition`到它，同时仍然保留`$length`字符的限制。

根据您在下面给出的，我已经包含了一个用法和一个示例输出：

```
<?php
/**
*   $text - The text to cut from
*   $length - The amount of characters that should be returned
*   $needle - If needle is given and found in the text, and it is 
*             at least $length far from the start of the string - it will end the sentence with it.
*   $addition - If the sentence was cut in the middle, will add it to the end of it.
**/
function limit_text($text, $length, $needle="", $addition="...") { 
    if(strlen($text) > $length) {
        $length -= strlen($addition);

        $start = 0;
        $trimLast = true;
        if (!empty($needle)) {
            $needleStart = strpos($text, $needle);

            if ($needleStart > $length) {
                $length -= strlen($needle);
                $start = $needleStart + strlen($needle) - $length;
                $trimLast = false;
            }
        }

        $stringCut = substr($text, max(0, $start), $length);
        if ($start > 0) {
            $stringCut = substr($stringCut, strpos($stringCut, ' ')+1);
        }
        if ($trimLast) {
            $lastWhitespace = strrpos($stringCut, ' ');
            $stringCut = substr($stringCut, 0, $lastWhitespace);
        }

        // split into words (so we won't replace words that contain it in the middle)
        // and wrap $needle with <span class="highlighted"></span>
        if (!empty($needle)) {
            $words = explode(" ", $stringCut);
            $needles = array_keys($words, $needle);
            foreach ($needles as $needleKey) {
                $words[$needleKey] = "<span class=\"highlighted\">$needle</span>";
            }

            $stringCut = implode(" ", $words);
        }
        $text = $stringCut.$addition;
    }
    return $text;
}

$bio = "Hello, I am John, I'm 25, I like fast cars and boats. I work as a blogger and I'm way cooler then the author of the question";
$text = limit_text($bio, 85, "author");
var_dump($text); 
```

**输出**：

```
string (111) "fast cars and boats. I work as a blogger and I'm way cooler then the <span class="highlighted">author</span>..." 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-28T01:29:32.657

首先，您需要确保不会通过缩短字符串来拆分单词。然后，您需要将所有`<span class="highlight">`标记附加到缩短字符串的末尾。这是我想出的（大约**8**行！）：

```
function limit_text($text, $length){
    if( strlen( $text) < $length) {
        return $text;
    }

    // Truncate the string without breaking words
    list( $wrapped) = explode("\n", wordwrap( $text, $length));

    // Get the span of text occurring after the wrapped string
    $remainder = substr( $text, strlen( $wrapped));

    // Add the "to be continued" to $wrapped
    $wrapped .= ' to be continued ... ';

    // Now, grab all of the <span class="highlight"></span> tags in the $remainder
    preg_match_all( '#<span class="highlight">[^<]+</span>#i', $remainder, $matches);

    // Add the <span> tags to the end of the string, separated by a comma, if present
    $wrapped .= implode( ', ', $matches[0]);

    return $wrapped;
} 
```

现在，使用您的原始测试：

```
$bio = "Hello, I am John, I'm 25, I like fast cars and boats. I work as a blogger and I'm way cooler then the <span class=\"highlight\">author</span> of the question";
$bio = limit_text( $bio,85);
var_dump( htmlentities( $bio)); 
```

这[输出](http://codepad.viper-7.com/vxBE7X)：

```
string(165) "Hello, I am John, I'm 25, I like fast cars and boats. I work as a blogger and I'm way to be continued ... <span class="highlight">author</span>" 
```

现在，另一个带有多个`<span>`标签的测试：

这[输出](http://codepad.viper-7.com/c7R54g)：

```
$bio = 'Hello, what about a <span class="highlight">span tag</span> before the limit? Or what if I have many <span class="highlight">span tags</span> <span class="highlight">after</span> <span class="highlight">the</span> limit?';
$bio = limit_text( $bio,85);
var_dump( htmlentities( $bio));

string(308) "Hello, what about a <span class="highlight">span tag</span> before the limit? Or what to be continued ... <span class="highlight">span tags</span>, <span class="highlight">after</span>, <span class="highlight">the</span>" 
```

如果你有更多的测试用例，或者对上面的函数有修改，请告诉我，我可以修复它！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-28T06:11:31.967

从您的要求来看，这应该可以满足您的要求：

```
function get_highlighted_string($s)
{
    return '<span class="highlight">' . htmlspecialchars($s) . '</span>';
}

function limit_text($text, $max_length, array $keywords = array(), $continued = '...')
{
    // highlights to put after the cut string
    $extra = array();

    // highlight keywords
    if ($keywords) {
        $re = '~\b(' . join('|', array_map('preg_quote', $keywords, array('~'))) . ')\b~i';
        // get all matches and capture their positions as well
        if (preg_match_all($re, $text, $matches, PREG_OFFSET_CAPTURE)) {
            // we reverse the matches by position to make replacement easier
            foreach (array_reverse($matches[1]) as $match) {
                // $match[0] = match
                // $match[1] = start position
                $match_len = strlen($match[0]);
                if ($match[1] + $match_len <= $max_length) {
                    // still fits in cut string
                    $match_replacement = get_highlighted_string($match[0]);
                    $text = substr_replace($text, $match_replacement, $match[1], $match_len);
                    // update max length
                    $max_length = $max_length - $match_len + strlen($match_replacement);
                } else {
                    // will not fit in the cut string, so we place it outside
                    array_unshift($extra, get_highlighted_string($match[0]));
                }
            }
        }
        // use wordwrap and strcspn to cut the string by word boundaries
        if (strlen($text) > $max_length) {
            $text = substr($text, 0, strcspn(wordwrap($text, $max_length, "\0"), "\0")) . " $continued";
        }
    }

    if ($extra) {
        // append what we couldn't fit in the cut string
        $text .= ' ' . join(', ', $extra);
    }

    return $text;
} 
```

例子：

```
echo limit_text("Hello, I like fast cars and boats. I work as a blogger I'm way cooler then the author of the question", 85, array('author', 'question'));

Hello, I like fast cars and boats. I work as a blogger I'm way cooler then the <span class="highlight">author</span> ... <span class="highlight">question</span> 
```

在这个例子中，截止点正好在，`author`所以高亮出现在`...`关键字`question`被放在后面时。

另一个例子：

```
echo limit_text("Hello, I am John, I'm 25, I like fast cars and boats. I work as a blogger and I'm way cooler then the author of the question", 85, array('author', 'question'));

Hello, I am John, I'm 25, I like fast cars and boats. I work as a blogger and I'm way ... <span class="highlight">author</span>, <span class="highlight">question</span> 
```

这两个关键字都超出了 85 个字符标记，因此它们附加在后面，以逗号分隔。

让我知道这是否适合你:)**

# php - 获取缩略图 ID Wordpress wp_generate_attachment_metadata

> ID：11129463
> 
> 赞同：0
> 
> 时间：2012-06-20T23:09:32.270
> 
> 标签：php, wordpress

我正在寻找可以解释我如何获得由函数“wp_generate_attachment_metadata”生成的缩略图 ID 的人。而且我真的不想使用插件，我会用它来修改 custom_post_type 的缩略图。

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T23:15:33.870

通常会是

```
$post_thumbnail_id = get_post_thumbnail_id( $post_id ); 
```

当然，为此你必须有帖子的 ID。如果您不这样做，请详细说明确切的场景。

# mysql - 如何从其他查询构建查询

> ID：11129466
> 
> 赞同：0
> 
> 时间：2012-06-20T23:09:49.027
> 
> 标签：mysql, drupal, join, subquery

我想创建一个查询来列出所有用户及其个人资料信息，但是必须使用相当复杂的过程来获取个人资料信息。

```
SELECT options.`value` FROM users
RIGHT JOIN profile on(profile.uid = users.uid)
RIGHT JOIN field_data_field_ethnicity on(field_data_field_ethnicity.entity_id = profile.pid)
RIGHT JOIN options on(field_data_field_city.field_ethnicity_value = bdc_options.`index` AND bdc_options.`key` = "ethnicity")
WHERE users.uid = 1 #needs to go through all users in table
ORDER BY field_data_field_ethnicity.revision_id DESC
LIMIT 1

SELECT options.`value` FROM users
RIGHT JOIN profile on(profile.uid = users.uid)
RIGHT JOIN field_data_field_city on(field_data_field_city.entity_id = profile.pid)
RIGHT JOIN options on(field_data_field_city.field_city_value = bdc_options.`index` AND bdc_options.`key` = "city")
WHERE users.uid = 1
ORDER BY field_data_field_ethnicity.revision_id DESC
LIMIT 1 
```

只是从这两个领域，我将如何通过用户表并得到类似

```
USER  |  CITY   |  ETHNICITY  
  1   |  London |   Koalabear         
  2   |  Paris  |   Fiddle 
```

以下是有问题的表格：http: [//pastebin.com/feNvzMZw](http://pastebin.com/feNvzMZw)

字段表包含所有条目，其中 entity_id 引用配置文件表，修订 id 引用修订号。我总是需要最高的更新

# ruby-on-rails - 如何为“编辑”路径创建 Cucumber 步骤定义？

> ID：11129472
> 
> 赞同：4
> 
> 时间：2012-06-20T23:10:48.537
> 
> 标签：ruby-on-rails, ruby, cucumber, bdd

我正在尝试学习如何使用 Cucumber 并使用以下场景创建步骤（我有一个名为“Vegetable”的模型，并且我添加了一个名为“color”的新属性）：

```
Scenario: add color to existing vegetable
  When I go to the edit page for "Potato"
  And I fill in "Color" with "Brown"
  And I press "Update Vegetable Info"
  Then the color of "Potato" should be "Brown" 
```

我目前正在使用“训练轮”，所以我有一个网络步骤（web_steps.rb）：

```
When /^(?:|I )go to (.+)?/ do |page_name|
  visit path_to(page_name)
end 
```

现在我明白了它是如何与简单的页面导航一起工作的，例如“当我转到蔬菜主页时”。我所要做的就是添加paths.rb的路径：

```
When /^the vegetable home page/
  '/vegetables' 
```

但是，对于上面的示例，我需要使用特定的蔬菜“/vegetables/1”（Potato url）进入特定路径。

我不知道该怎么做，所以我尝试创建自己的步骤：

```
When /I go to the edit page for "(.*)"/ do |vegetable_name|
  flunk "Unimplemented"
end 
```

但我得到了错误：

```
Ambiguous match of "I go to the edit page for "Potato"":

features/step_definitions/vegetable_steps.rb:15:in `/go to the edit page for "(.*)"/'
features/step_definitions/web_steps.rb:48:in `/^(?:|I )go to (.+)$/'

You can run again with --guess to make Cucumber be more smart about it
   (Cucumber::Ambiguous) 
```

这是我应该这样做的吗？还是我只是使用 web_steps “转到”步骤并以某种方式在 paths.rb 文件中提供 id？在阅读了各种 Cucumber 教程数小时后，我只是想弄清楚如何开始这个。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-21T16:49:45.373

正如 DVG 所说，这是因为我在两个地方都有匹配步骤，所以我收到了错误。要回答我自己的问题，我可以依靠已经提供的“web_step”：

```
When /^(?:|I )go to (.+)?/ do |page_name|
  visit path_to(page_name)
end 
```

一旦我将以下代码添加到paths.rb：

```
def path_to(page_name)
  case page_name

  when /^the edit page for "(.*)"$/
    edit_vegetable_path(Vegetable.find_by_name($1)) 
```

我能够让它正常工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-21T02:46:56.307

问题是您正在匹配步骤两个位置。步骤定义是全局的。因此，您必须更改功能以使用您没有写过两个地方的步骤或删除多余的步骤。

此外，您的功能是以非常低级别的 has-ui-details 方式编写的。这使您的功能难以应对变化，除非您的业务需求发生变化，否则您的黄瓜规格永远不会改变。考虑尝试

```
Given a vegetable named "Potato"
When I mark the vegetables color as "Brown"
Then the Potato should be "Brown" 
```

通过这种方式，您可以在不更改规范的情况下自由地试验您的表单，这就是重点。

# php - $_FILES[..]['tmp_name'] 不存在

> ID：11129473
> 
> 赞同：-1
> 
> 时间：2012-06-20T23:10:56.077
> 
> 标签：php, upload

我正在尝试使用 PHP 制作文件上传表单。`$_FILES['main_image']`打印为：

```
Array
(
 [name] => kitten11.jpg
 [type] => image/jpeg
 [tmp_name] => /tmp/phplyPTRW
 [error] => 0
 [size] => 29872
 ) 
```

`file_exists($_FILES['main_image']['tmp_name'])`是`false`，并且`/tmp`是可写的。

可能会发生什么？

我在愚蠢的共享主机上，所以就配置而言，我无法改变太多。

**编辑**

我的其中一个包含做了不应该做的事情，所以问题解决了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-29T15:01:36.603

您可能需要编辑**`php.ini`**文件并增加此行的值：

> **上传最大文件大小**

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-20T23:30:35.157

在那种情况下`file_exists()`可能不相关。很多时候，函数的错误**$destination**路径`move_uploaded_file($filename, $destination)`是问题所在。

请问，你能检查一下这个值，你是否正在使用那个上传功能？

# android - 计算滚动了多少

> ID：11129477
> 
> 赞同：0
> 
> 时间：2012-06-20T23:11:32.830
> 
> 标签：android, android-layout, scrollview

有没有办法找出滚动视图已经滚动了多少？有点像随机访问文件中的指针？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T23:17:31.503

结帐 scrollView.getScrollY()

[http://developer.android.com/reference/android/view/View.html#getScrollY](http://developer.android.com/reference/android/view/View.html#getScrollY) ()

# python - 大熊猫中的有向图

> ID：11129478
> 
> 赞同：0
> 
> 时间：2012-06-20T23:11:41.223
> 
> 标签：python, pandas

我试图找出图中的哪些边是双向的。每一行都是一条边。对于每个起始节点 A，如果它们以节点 A 作为结束点，我将搜索每个相应的结束节点 B：

```
for ending_point_B in nodeA:
    nodeA in ending_points_of_B 
```

现在忽略 df['S'] 中的重复条目。如何优化此搜索？我怀疑类似于 groupby 的东西。这种方式对于我的真实图表来说需要太多时间。

谢谢

```
from pandas import *

def missing_node(node):
    set1 = set(df[df.E == node].S.values)
    set2 = set(df.E[df.S == node].values)
    return list(set1.difference(set2))

x = [1,1,2,2,3]
y = [2,3,1,3,1]

df = DataFrame([x,y]).T
df.columns = ['S','E'] #Start & End

df['Missing'] = df.S.apply(missing_node)

df:

   S  E Missing
0  1  2      []
1  1  3      []
2  2  1      []
3  2  3      []
4  3  1     [2] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T03:57:18.193

如果我正确理解您的问题，您需要找到所有非双向的节点对。在上面的示例中，唯一这样的一对节点是 2 和 3。鉴于此，您可以执行以下操作：

```
In [1]: df['is_bi'] = df.index.map(lambda x: np.any(map(lambda y: np.all(y), df.ix[x][['E', 'S']].values == df.values)))
In [2]: df
Out[2]:
   S  E  is_bi
0  1  2   True
1  1  3   True
2  2  1   True
3  2  3  False
4  3  1   True 
```

所以`df[-df.is_bi]`会给你所有非双向的节点对：

```
In [3]: df[-df.is_bi][['S', 'E']]
Out[3]: 
   S  E
3  2  3 
```

我觉得我过于复杂了，必须有一种方法可以使用 pandas-native 函数来做到这一点，但上面的解决方案可以解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T12:22:08.997

Pandas 很棒，但不确定你是否需要它。类似以下内容应该为您提供非双向链接：

```
x = [1,1,2,2,3]
y = [2,3,1,3,1]

fwd = set( zip(x,y) )
rev = set( zip(y,x) )
print ' not bi: ', fwd.difference(rev) 
```

这将返回：

> > > 不是双：set([(2, 3)])

# mysql - mysql行格式压缩有什么弊端？

> ID：11129483
> 
> 赞同：2
> 
> 时间：2012-06-20T23:12:20.283
> 
> 标签：mysql

mysql手册都是用于压缩的，`ROW_FORMAT=COMPRESSED`但我注意到我也可以设置一个关键块大小值。

不考虑文件大小的实际压缩，这有什么不同的影响。

例子

```
KEY_BLOCK_SIZE = 2 
```

和

```
KEY_BLOCK_SIZE = 4 
```

以上两种压缩都以不同的尺寸压缩，但使用 on 或其他有什么缺点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-16T18:33:16.883

有一个明显的问题：更小的块大小 = 更低的性能，尤其是在 OLTP 应用程序中。

有趣的是，对于带有 InnoDB 的表，较小的块大小并不**意味着**较小的压缩表。

您应该阅读它是如何工作的： http: [//dev.mysql.com/doc/refman/5.5/en/innodb-compression-internals.html](http://dev.mysql.com/doc/refman/5.5/en/innodb-compression-internals.html) 或检查从 1 到 16 的每个可能值 :)

# android - 如何在 Android 中刷新 ListView

> ID：11129488
> 
> 赞同：2
> 
> 时间：2012-06-20T23:12:57.353
> 
> 标签：android, listview, android-listview, listactivity

我知道你可以调用 notifyDataSetChanged(); 在这种情况下你会怎么做——这甚至可能吗？

```
 ListView listView = getListView();
        listView.setTextFilterEnabled(true);
        setListAdapter(new ArrayAdapter<String>(Items.this, R.layout.list, items)); 
```

编辑：我已更改为以下建议之一。这是我正在做的事情：

```
 protected void onPostExecute(Void v) {

        adapter = new ArrayAdapter<String>(Items.this, R.layout.list, items);
        setListAdapter(adapter);

        adapter.notifyDataSetChanged();

    } 
```

在这里，我在 AsyncTask 方法中刷新。这是在一个对话框中调用的，在 ListLiew 顶部有一个提交按钮。对话框将新数据插入数据库，我希望刷新列表以反映这一点。我已经在对话框中的按钮的 onClick 和上面尝试了这段代码。就在对话框关闭之前。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T23:17:40.723

您需要`ArrayAdapter`自行初始化：

```
ArrayAdapter<String> adapter = new ArrayAdapter<String>(Items.this, R.layout.list, items);
setListAdapter(adapter); 
```

...然后调用`notifyDataSetChanged()`它：

```
adapter.notifyDataSetChanged(); 
```

注意，只有在数据实际发生变化时才需要调用该方法；鉴于此，您可能需要将其作为成员变量存储在类中，以便以后可以访问它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T23:20:38.803

您应该能够在 ArrayAdapter 上调用 notifyDataSetChanged()，因为 ArrayAdapter 扩展了 BaseAdapter

[http://developer.android.com/reference/android/widget/ArrayAdapter.html](http://developer.android.com/reference/android/widget/ArrayAdapter.html)

在您的示例中，您将执行类似的操作，假设您打算调用 listView.setListAdapter()

```
(ArrayAdapter)listView.getAdapter()).notifyDataSetChanged(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T23:54:10.870

在您的示例中，您不应该在`AsyncTask`. 一般来说，这样做是个好主意，`onCreate()`因为否则每次`AsyncTask`调用时你都要设置它。如果您使您的适配器成为成员变量，那么您应该能够`<adapter>.notifyDataSetChanged()`从`AsyncTask`.

# facebook - Facebook Ads API：什么是覆盖率估算调用中的“位置”参数

> ID：11129489
> 
> 赞同：1
> 
> 时间：2012-06-20T23:13:16.093
> 
> 标签：facebook, location

我正在尝试使用在[http://developers.facebook.com/docs/reference/ads-api/reachestimate/](http://developers.facebook.com/docs/reference/ads-api/reachestimate/)中定义的到达时间对象。

作为覆盖面估算的一部分的出价估算和印象估算都包含一个`location`以简单整数给出的条目。

我搜索了整个文档，但找不到这些数字对应的任何列表。

有谁知道我在哪里可以找到这些信息和/或不同的价值是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-24T12:40:47.850

您可以使用[adgeolocation](https://developers.facebook.com/docs/marketing-api/targeting-search/v2.3#geo)端点搜索位置名称和整数之间的映射。这是卷曲示例：

```
curl -G \
  -d "type=adgeolocation" \
  -d "q=Washington" \
  -d "location_types=['city']" \
  -d "access_token=XYZ" \
https://graph.facebook.com/v2.3/search 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T16:38:12.873

如果它们没有记录在案，那么依赖它们可能是个坏主意，但它指的是 Facebook 上将展示广告的不同位置。

我不知道哪些值对应于哪些位置，但大概一个是指新闻提要，一个是指正常的右侧广告栏

# javascript - 如何清空变量/将变量转回未定义？

> ID：11129493
> 
> 赞同：2
> 
> 时间：2012-06-20T23:13:31.300
> 
> 标签：javascript

我有一个案例，我检查变量是否未定义。在某些情况下，我想再次将变量变为未定义，以便它以未定义的形式返回？这会被认为是不好的做法吗？

:D/ 代码示例！

```
if (loc1 == undefined){
    loc1 = loc.title
    }
else if(loc2 == undefined){
    loc2 = loc.title
}
else{
//here I want loc1 and loc2 to turn undefined again!
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T23:18:49.907

你可以这样做：

```
var test = 1;
test = undefined; 
```

# c++ - 在 Excel 模板中使用 OleFunction“查找”查找标头变量并从 C++ 中替换它们

> ID：11129497
> 
> 赞同：1
> 
> 时间：2012-06-20T23:13:37.600
> 
> 标签：c++, excel, vba, interface, ole

我的问题如下：

我打开一个 Excel - 文件，但我不知道我的客户在模板文件中使用了哪些可能的标头变量。这些可以是：#DATE、#TIME、#NAME 等等。所以我需要寻找这些变量，如果已经使用：替换它们。

```
vCell = findCell("DATE");
tempStr = DateToStr(Date()) ;   // Date
if (vCell.VType != VT_EMPTY )
    vWorksheet.OlePropertyGet("Cells", vCell.OlePropertyGet("Address")).OlePropertySet("Value",StringToOleStr(tempStr)); 
```

findCell 看起来像这样：

```
Variant __fastcall TClassExcel::findCell(AnsiString Cell,String Range){
    // Range is set to A1:Z100 as default in the header file 
    vRange = vWorksheet.OlePropertyGet("Range",StringToOleStr(Range));
    return vRange.OleFunction("Find", StringToOleStr("#"+Cell));
} 
```

该行`if (vCell.VType != VT_EMPTY)`不检测标题内是否没有这样的单元格。我也尝试过`vCell.Empty()`，但没有成功。`Vtype`= 9 如果我看值。所以，我正在寻找VBA对应的“ ***If Not cell Is Nothing Then ”***

此参考是查找方法的 MSDN 库：[MSDN Find Method](http://msdn.microsoft.com/en-us/library/aa195730%28v=office.11%29.aspx)以确保不要尝试将某些变量写入不存在的单元格。

# google-apps-script - Google Apps 脚本关闭（）

> ID：11129498
> 
> 赞同：3
> 
> 时间：2012-06-20T23:13:40.517
> 
> 标签：google-apps-script

是否可以关闭在 Apps 脚本中打开的 UI 窗口？

我认为答案是否定的：http://code.google.com/p/google-apps-script-issues/issues/detail?id=474&can=1&q=.close%28%29&colspec=Stars%20Opened% [20ID %20Type%20Status%20Summary%20Component%20Owner](http://code.google.com/p/google-apps-script-issues/issues/detail?id=474&can=1&q=.close%28%29&colspec=Stars%20Opened%20ID%20Type%20Status%20Summary%20Component%20Owner)

但我想看看是否有其他意见。

我有一个弹出的“等待窗口”，我想在活动完成后关闭它。

* * *

```
var app = UiApp.getActiveApplication();

var ss = SpreadsheetApp.getActiveSpreadsheet();

var sheet = getSheetWithSubmissions(ss);

// create UI app, this works fine

app = createWaitPleaseUI(sheet);

ss.show(app);

//simulated activity

Utilities.sleep(5000);

//this doesn't work despite being in the documentation

app.close(); 
```

* * *

认为这是不可能的，但如果无法做到，希望谷歌将其从他们的文档中删除。

作为一种解决方法，我可以调出第二个 GUI，说“工作完成，单击确定”，然后它就可以正常工作了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-21T00:51:16.757

您必须返回`app`对象才能对其进行更新，甚至关闭。

将您的最后一行更改为`return app.close()`。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-14T08:46:30.240

您应该更彻底地阅读文档，它清楚地解释了电子表格中的 UI 需要通过返回来结束才能实际关闭。另外，我建议您可以相信来自顶级贡献者的答案，而不是相信您总是对文档和其他所有人都是正确的……没有冒犯，但总是欢迎谦虚:-)

[这是从文档](https://developers.google.com/apps-script/uiapp#DisplayingSpreadsheet)中提取的一段代码以证实：

```
// Close everything return when the close button is clicked
function close() {
  var app = UiApp.getActiveApplication();
  app.close();
  // The following line is REQUIRED for the widget to actually close.
  return app;
} 
```

# php - 制作活动日志的最有效方法

> ID：11129503
> 
> 赞同：6
> 
> 时间：2012-06-20T23:14:16.773
> 
> 标签：php, mysql, sql

我正在为我的网站上的个人资料制作一个“最近的活动”选项卡，我还将为版主创建一个日志，以查看网站上发生的所有事情。这将需要制作某种活动日志。

我只是不知道什么会更好。我有两个选择：

1.  制作一个名为“活动”的表，然后每次有人做某事时，添加一条记录，其中包含操作类型、用户 ID、时间戳等。
    *   **问题：**桌子可能会变得很长。
2.  加入所有 3 个表（问题、答案、answer_comments），然后以某种方式在页面上按照执行操作的顺序显示所有这些表。
    *   **问题：**这将非常困难，因为我不知道如何通过仅加入 3 个表格来使其说出*“John 在此处对问题标题的答案发表评论” 。*

有谁知道在这种情况下制作活动日志的更好方法？我正在使用 PHP 和 MySQL。如果这太低效或太难，我可能会忘记配置文件上的“最近活动”选项卡，但我仍然需要版主的活动日志。

这是我开始为选项 2 编写的一些 SQL，但这不起作用，因为当我在`while`循环中回显信息时，无法检测该操作是评论、问题还是答案：

```
SELECT q.*, a.*, ac.* 
    FROM questions q JOIN answers a ON a.questionid = q.qid
        JOIN answer_comments ac ON c.answerid = a.ans_id
WHERE q.user = $userid 
AND a.userid = $userid 
AND ac.userid = $userid
    ORDER BY q.created DESC, a.created DESC, ac.created DESC 
```

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T23:27:36.577

我喜欢“选项 2”，你基本上会复制你的数据，并且它会因额外的读/写而减慢速度。也许不是做一个

```
SELECT q.*, a.*, ac.* 
```

您可以只从每个表中获取您需要的数据，或者更简洁的方法可能是在将查询限制为仅选定用户的那些帖子之后，对三个表进行[联合](http://www.mysqltutorial.org/sql-union-mysql.aspx)，并按发布日期排序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T02:33:07.887

为什么你有`q.user`and `q.userid`？

对于选项 2（更好的选项 IMO - 只要您已正确索引），我认为 a`UNION`更符合您的要求。像这样的东西：

```
SELECT 'question' AS action, id, created 
    FROM questions WHERE userid = {$userid}
    UNION
SELECT 'answer' AS action, id, created
    FROM answers WHERE userid = {$userid}
    UNION
SELECT 'comment' AS action, id, created
    FROM answer_comments WHERE userid = {$userid}
ORDER BY created DESC LIMIT 20 
```

`'question' / 'answer' / 'comment'`告诉您采取了哪些操作。您可能遇到的可能问题：作为 a `UNION`，每个`SELECT`语句必须具有相同数量的列，所以如果一个很短，您可以添加一个`NULL`eg：

```
SELECT 'comment', id, created, NULL FROM ac 
```

此外，如果其中一`created`列具有不同的名称，您可以只使用别名

```
SELECT 'comment', id, comment_date AS created FROM ac 
```

# ruby - 无法理解以下代码的作用

> ID：11129505
> 
> 赞同：3
> 
> 时间：2012-06-20T23:14:27.933
> 
> 标签：ruby, ruby-on-rails-3, paper-trail-gem

有人可以向我解释下面的代码在做什么。 `before`并且`after`是哈希。

```
def differences(before, after)
    before.diff(after).keys.sort.inject([]) do |diffs, k|
        diff = { :attribute => k, :before => before[k], :after => after[k] }
        diffs << diff; diffs
    end
end 
```

它是从纸迹不同的宝石。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T00:42:19.893

这是密集的代码，毫无疑问。因此，正如您所说`before`，并且`after`是作为参数传递给方法的哈希（-like？）对象。调用`before.diff(after)`返回另一个哈希，然后立即`.keys`调用它。这将返回返回的哈希中的所有键`diff`。键作为数组返回，然后立即排序。

然后我们得到最复杂/最密集的位。使用`inject`该排序的键数组，该方法构建一个数组（`diffs`在`inject`块内调用），该数组将作为该`inject`方法的返回值。

该数组由差异记录组成。`before.diff(after)`每条记录都是一个散列 - 通过从返回值的排序键数组中获取一个键来构建。这些散列存储了被区分的属性，它在前散列中的样子以及在后散列中的样子。

因此，简而言之，该方法获取两个散列之间的一堆差异，并将它们收集到一个散列数组中。该哈希数组是该方法的最终返回值。

**注意**：`inject`可以而且经常比这简单得多。通常它用于简单地将一组值简化为一个结果，方法是一遍又一遍地应用一个操作并将结果存储在累加器中。您可能知道`inject`其他`reduce`语言；`reduce`是`inject`Ruby 中的别名。这是一个更简单的示例`inject`：

```
[1,2,3,4].inject(0) do |sum, number|
  sum + number
end
# => 10 
```

0 是累加器 - 初始值。在 pair`|sum, number|`中，`sum`将是累加器，并且`number`将是数组中的每个数字，一个接一个。什么`inject`是加 1 到 0，将结果存储到`sum`下一轮，将 2 加到`sum`，`sum`再次存储结果等等。累加器的单个最终值`sum`将是返回值。这里 10\. 在您的示例中增加的复杂性是累加器与块内的值在类型上不同。这不太常见，但还不错或不习惯。（**编辑**：Andrew Marshall 提出了一个很好的观点，也许这很糟糕。请参阅他对原始问题的评论。@tokland 指出，`inject`这里只是地图的一个非常复杂的替代方案。它*不好。）有关更多示例，*请参阅我在对您的问题的评论中链接到的文章`inject`。

**编辑**：正如@tokland 在一些评论中指出的那样，代码似乎只需要一个简单的`map`. 那时它会更容易阅读。

```
def differences(before, after)
  before.diff(after).keys.sort.map do |k|
    { :attribute => k, :before => before[k], :after => after[k] }
  end
end 
```

我太专注于解释代码在做什么。我什至没有想到如何简化它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T23:31:11.350

它根据底层对象查找前后不同的条目，然后以更方便的格式构建这些差异的列表。

`before.diff(after)`查找不同的条目。

`keys.sort`按排序顺序为您提供（差异地图的）键

`inject([])`就像`map`，但从初始化为空数组的差异开始。

该块为这些差异中的每一个创建`diff`一行（哈希），然后将其附加到`diffs`.

# c# - MSMQ：为什么我不能从远程专用队列中检索队列详细信息？

> ID：11129508
> 
> 赞同：2
> 
> 时间：2012-06-20T23:14:51.553
> 
> 标签：c#, msmq

我正在尝试检索有关远程专用队列中消息的详细信息，但我继续收到 MessageQueueException“无效的队列路径名”。我可以使用 MessageQueue.GetPrivateQueuesByMachine 检索私有队列列表，但是，当我尝试查看返回的队列的任何详细信息时，我得到了异常。

```
var msmqQueues = MessageQueue.GetPrivateQueuesByMachine(serverName);
msmqQueues[0].CreateCursor();  // Throws MessageQueueException "Invalid queue path name"
msmqQueues[0].Label; // also Throws MessageQueueException "Invalid queue path name" 
```

奇怪的是，GetPrivateQueuesByMachine 调用似乎可以正常工作，因为 msmqQueues 中有正确数量的项目，我可以访问它们的 .Path 属性（它看起来像一个典型的 FormatName 路径 - “FormatName:DIRECT=OS:SERVERNAME\private$\队列名”）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T23:24:27.267

工作组模式下私有队列的许多功能和属性无法远程使用，这只是野兽的本性。大多数方法和属性应该在其 msdn 页面上有一个矩阵，概述可用性，例如[http://msdn.microsoft.com/en-us/library/system.messaging.messagequeue.label.aspx](http://msdn.microsoft.com/en-us/library/system.messaging.messagequeue.label.aspx)

# joomla - 将旧网址映射到新的 joomla 2.5 网站 SEF 网址？

> ID：11129510
> 
> 赞同：1
> 
> 时间：2012-06-20T23:15:12.083
> 
> 标签：joomla, url-rewriting, sef

我有一个奇怪的情况。我的一个客户有一个具有这种 URL 的网站：

**旧网址：** website.com/products/the+product_1.php

现在我们开发的新网站有 joomla 2.5，里面有所有的内容......所以我们在那里启用了 Joomla SEF。现在的问题是如何将旧网址映射到新网址。

新的 Joomla 2.5 URL 看起来像这样：

**新网址：** website.com/products/digi/category/the_product_1

现在的问题是搜索引擎已将旧 URL 编入索引，而客户不想失去页面排名，因为您知道这很重要......他们有大约 18k 个 URL。

**如何最好地将旧 URL 映射到新 URL？**

请帮忙？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T18:23:57.967

嗯，你为什么不使用 Joomla 内置重定向管理器？ [http://docs.joomla.org/Help17:Components_Redirect_Manager](http://docs.joomla.org/Help17:Components_Redirect_Manager)

当然，在其中建立链接需要一些时间，但从我的角度来看，这将是最好的方法。那么就不需要开发一些东西，一切都可以在joomla中进行管理。

如果此组件需要，您还可以编写一个脚本来添加到 SQL DB 的链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T01:07:50.097

最简单的方法是[创建一个系统插件](http://docs.joomla.org/Plugin)来查找旧产品 URL 模式并触发到新 URL 的重定向。您还应该查看这个[新的和重命名的事件列表，](http://docs.joomla.org/What%27s_new_in_Joomla_1.6#Events)因为其中一些在编写插件文档后发生了变化。

# ruby-on-rails - 在rails中使用form_for中的select方法

> ID：11129515
> 
> 赞同：0
> 
> 时间：2012-06-20T23:15:54.477
> 
> 标签：ruby-on-rails, select, form-for

我想在rails的form_for中使用一种方法来创建一个带有选项的选择标签，其中选项的值来自一个数组，而选项标签所包含的选项来自另一个数组。

例如，第一个选项是：

```
<option value = Array1[0]> Array2[0] </option> 
```

我该怎么做呢？我可以使用“选择”，例如：

```
= form_for @activity do |f|
  = f.select(Array1, Array2, {:selected => nil, :prompt => 'Select Stage'}) 
```

尽管这种格式似乎与 api.rubyonrails.org 的 rails API 中描述的 options_for_select 一致，但我无法得到这样的工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T23:37:57.187

尝试这个：

```
= f.select(:method, Array2.zip(Array1), { :selected => nil, :prompt => 'Select Stage' }) 
```

[zip](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-zip)方法会将两个数组组合成一个二维数组。

因此，例如，`[1,2,3].zip([4,5,6])`将返回`[[1,4], [2,5], [3,6]]`.

`select`然后可以将其解释为选项文本和选项值的列表。

给定`[['Male', 'm'], ['Female', 'f']]`，选择将返回

```
<option value="m">Male</option>
<option value="f">Female</option> 
```

# javascript - 如何自动检测键盘输入和自动对焦输入并使用js或jquery将其输入到输入中？

> ID：11129519
> 
> 赞同：1
> 
> 时间：2012-06-20T23:16:05.217
> 
> 标签：javascript, jquery, html, javascript-events

好的，我知道如何检测键盘输入。我知道如何专注于键盘输入。

但我想知道检测键盘输入的最佳做法是什么=> 专注于 textarea 或 textfield => 并将该键输入该字段。

它是这样工作的：我在一个页面上。我输入“A”。然后我的文本字段获得焦点，并在字段中输入“A”。这听起来微不足道，但实际上我还没有找到一种简单的方法来做到这一点。原因是初始键盘输入事件不指向文本字段，我需要将该事件传播到新聚焦的文本字段。

有没有一种传统的方法来做这样的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T23:43:17.357

示例 html：

```
<form>
<input type="text" />
<input type="text" id="thisguy" />
<input type="text" />
<input type="text" />
</form>​​​ 
```

上面 html 的 jQuery

```
$(document).live('keypress', function (e) {

$('#thisguy').val($('#thisguy').val() + String.fromCharCode(e.which));
});​ 
```

需要清理。也许设置焦点而不是更改文本值。

# javascript - 恢复覆盖的 window.JSON 对象

> ID：11129521
> 
> 赞同：7
> 
> 时间：2012-06-20T23:16:17.957
> 
> 标签：javascript, json, cross-browser

我无法控制的一些代码覆盖了全局 JSON 对象，而不检查它是否已经实现：

```
var JSON = {
  org: "http://www.JSON.org",
  copyright: "(c)2005 JSON.org",
  license: "http://www.crockford.com/JSON/license.html",
  stringify: function(a, g) {
     ... 
```

问题是这个版本的 JSON 解析器非常旧并且有一个错误，这妨碍了我对序列化的尝试。（其他人对此实现也有[类似的问题](https://stackoverflow.com/a/7571913/89218)。）

我可以了解浏览器的本机实现吗？我认为[删除会起作用](https://stackoverflow.com/questions/10319174/bringing-back-an-overridden-window-method)，但事实并非如此。我怀疑这是因为 JSON 是一个*对象*，而不是[原型中的方法](https://stackoverflow.com/a/10319688/89218)。有没有其他方法可以解决它？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-20T23:25:19.033

您可以创建一个`iframe`元素（它将加载`about:blank`并因此创建一个新上下文）并从那里获取一个 JSON 对象。

```
function restoreJSON() {
  var f = document.createElement("iframe");
  f.style.display = "none";
  document.documentElement.appendChild(f);
  window.JSON = f.contentWindow.JSON;
  document.documentElement.removeChild(f);
} 
```

`about:blank`同步加载，因此无需等待`load`事件。虽然这不会恢复原始 JSON 对象，但它会得到一个与其相同的黑盒。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T23:19:15.700

由于您无法控制的代码在您进入页面之前会覆盖原始代码，因此您有两种选择：

注入一个 iframe 并从 contextWindow 中获取 JSON（如本次编辑时关于此问题的其他答案所示），或者，只需使用[https://github.com/douglascrockford/JSON-js](https://github.com/douglascrockford/JSON-js) JSON 库作为您自己的插入。请注意，使用 Crockford 确实提供了跨浏览器的一致性保证，但本机实现通常更快。

如果您将来有能力在有问题的代码之前出现在页面上，另一种方法是在有问题的“有助于获取 JSON 对象的代码”*之前注入一些东西：*

```
<html>
  <head>
    <script>
      window.myJson = window.JSON;
    </script>
 .... 
```

# oop - 在理想的 OO 设计中，继承的对象是否应该在他的每个方法上隐式调用 super()？

> ID：11129529
> 
> 赞同：1
> 
> 时间：2012-06-20T23:17:13.103
> 
> 标签：oop, inheritance, methods, superclass

也就是说，当调用 child.update() 时，派生类的实例是否应该先隐式调用其所有超类的 update() ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T09:32:05.110

您不是将一个类**包装**到另一个类中，而是从超类**继承。**

`super.method()`仅在需要扩展 parent 的行为时才应调用覆盖超类方法`method()`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T19:24:32.323

没有好的答案（用我知道的语言）。有时你想替换 super 方法。有时你想在它执行*之前*加入一些东西，有时*在*. 看起来扩展类需要比它应该知道的更多地了解它所覆盖的类的细节。（这对于闭源系统来说很尴尬。）此外，基类有时确实想控制调用类的行为，以强制调用超级方法，这也是不对的。我认为最好的办法是让超类尽可能地*记录*其可覆盖的方法，以便覆盖的程序员可以猜测要做什么。

我最接近正确和正确地处理这个问题是使目标方法不能被覆盖，然后让它调用一个或多个除了*可以*被覆盖之外什么都不做的方法。然后覆盖类可以覆盖它感兴趣的任何方法，而不会破坏超类。

最终的编程语言将对这个问题有一个万无一失的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T23:19:13.720

这实际上取决于超类/基类函数的作用。有时我先调用它，有时我最后调用它。有时我有条件地调用它，有时我根本不调用它。

很多时候（这来自 C# 背景），基类函数只是引发一个事件，而子类重写该方法以获得类似事件的功能。在某些情况下，孩子不希望引发该事件：

```
class Base {
   public event EventHandler UnhandledError;
   protected virtual void OnUnhandledError(Error error) {
       if (UnhandledError != null)
          UnhandledError(this, EventArgs.Empty);
   }
}

class Derived : Base {
    protected override void OnUnhandledError(Error error) {
       if (HandleError(error))
          return;                 // We took care of it. Don't raise the event.

       // We couldn't handle it. Let the base class raise the event.
       base.OnUnhandledError(error);
   }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-20T23:20:42.810

不，有人可能需要重写 update() 并希望完全阻止来自父母的任何呼叫。在那种情况下，隐式调用不仅会损害性能，还可能会做你不想做的事情。

# php - Yii 有很多通过 ajax 验证

> ID：11129535
> 
> 赞同：1
> 
> 时间：2012-06-20T23:18:07.957
> 
> 标签：php, yii

```
public function actionEquipmentLoanRequestCreate()
{

    if(isset($_POST['EquipmentRequest']))
    {
        $ids = $_POST['EquipmentRequest']['equipID'];
        $equipment = Equipment::model()->findAllByPk($ids);
        $requests = self::instantiateEquipmentRequests($equipment);
        //echo "<pre>";
        //die(count($requests)." ".CActiveForm::validate($requests));

        $booking = new EquipmentBooking;

        if(isset($_POST['EquipmentRequest']) && $_POST['EquipmentBooking'])
        {
            $booking->attributes = $_POST['EquipmentBooking'];
            $requestPostedVars = $_POST['EquipmentRequest'];
            //have posted collection of equipment
            //need to take count
            //request below not really useful???
            $equipmentRequests = array();
            foreach($requestPostedVars as $request)
            {
                if(isset($request))
                {
                    $equipmentRequest = new EquipmentRequest('loanRequest');
                    $equipmentRequest->attributes = $request;
                    array_push($equipmentRequests,$equipmentRequest);

                }

            }
            $models = $equipmentRequests;
            $models[]=$booking;
            $this->performAjaxValidation($models);
            $booking->equipment = $equipmentRequests;
            if ($booking->save()){
                self::assignBookingIds($equipmentRequests,$booking);
                $this->redirect('index');
            }

        }
        //displays view to create loan request
        $this->render('equipment-loan-request',array('requests' => $requests,'booking' => $booking));  

    } else {
            Yii::app()->user->setFlash('error', "You need to select equipment first!");
            $this->redirect(array('simulation/equipment'), true);
    }

}

public function instantiateEquipmentRequests($equipment)
{
    $equipmentRequests = array();
    foreach($equipment as $item)
    {
        $request = new EquipmentRequest('loanRequest');
        $request->equipment = $item;
        $request->qty = 1;

        array_push($equipmentRequests,$request);
    }
    return $equipmentRequests;
} 
```

**表单视图**稍后会忽略多余的按钮替换-我直接尝试调用请求，而不是仅调用以下预订或两者都无济于事。

```
<?php $form=$this->beginWidget('CActiveFormExtended', array(
        'id' => 'equipment-booking-form',
        'enableAjaxValidation' => true,
        'clientOptions' => array(
          'validateOnSubmit' => true,
          'validateOnChange'=>true,

          ),

  )); ?>
  <div class="content-bg">        

  <?php 
  echo  $form->errorSummary($requests); 

   if(isset($requests) && count($requests) > 0) {
          foreach($requests as $i => $request) { 
            $this->renderPartial('_requestedEquipment', array("index" => $i, "request" => $request, "form"=> $form)); 
          }
        }?>
  </div>
  <br />

  <hr class="brown"/>

    <h2>Request Details</h2>
    <div class="content-bg">
      <h3>Step 1</h3>
      <?php echo $form->label($booking,'organisation'); ?>
      <?php echo $form->dropDownList($booking, 'organisation', $booking::$organisations,array('id' => 'organisation', 'class' => "selectfield",'empty' => 'Select')); ?>
    </div>
    <br />
    <div class="content-bg">
      <h3>Step 2</h3>
      <?php echo $form->label($booking,'name'); ?>
      <?php echo $form->textField($booking,'name',array('size'=>60,'maxlength'=>255)); ?>
      <?php echo $form->error($booking,'name'); ?>

      <?php echo $form->label($booking,'email'); ?>
      <?php echo $form->textField($booking,'email',array('size'=>60,'maxlength'=>255)); ?>
      <?php echo $form->error($booking,'email'); ?>

      <?php echo $form->label($booking,'phone'); ?>
      <?php echo $form->textField($booking,'phone',array('size'=>60,'maxlength'=>255)); ?>
      <?php echo $form->error($booking,'phone'); ?>

    </div>
    <br />
    <div class="content-bg">
      <h3>Step 3</h3>
      <?php echo $form->label($booking,'address'); ?>
      <?php echo $form->textField($booking,'address',array('size'=>60,'maxlength'=>255)); ?>
      <?php echo $form->error($booking,'address'); ?>

      <?php echo $form->label($booking,'suburb'); ?>
      <?php echo $form->textField($booking,'suburb',array('size'=>60,'maxlength'=>255)); ?>
      <?php echo $form->error($booking,'suburb'); ?>

      <?php echo $form->label($booking,'postcode'); ?>
      <?php echo $form->textField($booking,'postcode',array('size'=>60,'maxlength'=>255)); ?>
      <?php echo $form->error($booking,'postcode'); ?>

    </div>

    <br />
    <div class="content-bg">
      <h3>Step 4</h3>
      <div class="five columns alpha">
      <?php echo $form->label($booking,'pickupDate'); ?>
      <?php echo $form->dropDownDayList($booking, 'pickupDate',array('class' => 'date-day pickup_select','id' => 'pickup')); ?>
      <?php echo $form->dropDownYearList($booking,1, 'pickupDate',array('class' => 'date-monthyear pickup_select','id' => 'pickup-month')); ?>
      <?php echo $form->hiddenField($booking, 'pickupDate',array('id' => 'pickupData')); ?>
      <?php echo $form->error($booking,'pickupDate'); ?>

      </div>
      <div class="five columns alpha">
      <?php echo $form->label($booking,'returnDate'); ?>
      <?php echo $form->dropDownDayList($booking, 'returnDate',array('class' => 'date-day return_select','id' => 'return')); ?>
      <?php echo $form->dropDownYearList($booking,1, 'returnDate',array('class' => 'date-monthyear return_select','id' => 'return-month')); ?>
      <?php echo $form->hiddenField($booking, 'returnDate',array('id' => 'returnData')); ?>
      <?php echo $form->error($booking,'returnDate'); ?>

      </div>
      <br class="clear"/>
    </div>

    <br />
    <div class="content-bg">
      <h2>Terms &amp; Conditions</h2>
      <p>By submitting this loan enquiry you agree to and acknowledge our <a href="equiploanterms">Equipment Loan Terms and Conditions</a>.</p>
    </div>
    <?php echo CHtml::submitButton('Submit'); ?>
    <br />
<input class="orange-btn right" type="submit" value="Submit Loan Request">

<?php $this->endWidget(); ?>
    </div> 
```

**设备请求部分**

```
<div class="selected-equipment" id="request_<?php echo $request->equipment->equipName; ?>">
<div class="equipment-selected"><a href="#"><?php echo $request->equipment->equipName; ?></a></div>
    <div class="equipment-qty"><?php echo $form->textField($request, "[$index]qty", array('value' => 1,'class' => 'requestQuantity')); ?></div>
    <?php echo $form->error($request,"[$index]qty"); ?>

    <div class="equipment-update"><a href="#" class="brown-btn small"><span>Remove</span></a></div>
    <?php echo $form->hiddenField($request, "[$index]equipID",array('value' => $request->equipment->equipID)); ?>
     <?php echo $form->error($request,"[$index]equipID"); ?>

    <br class="clear">
</div> 
```

**编辑** 请注意我已经纠正了上述问题。主要是由于 performAjaxValidate 的使用不正确造成的，我现在已将其设置为同时调用预订和设备请求集合。

这现在让我得到 2 个验证错误消息对象，两个模型都有 1 个。但是只有预订模型被传递给错误摘要 div。

@bool.dev 到目前为止感谢您的帮助，以上任何想法，已尝试将设备请求对象和预订对象的集合合并到 errorSummary 中的一个参数调用

我已经编辑了上面的内容以显示更新的控制器操作和视图

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T07:09:46.590

当您想要[`errorSummary()`](http://www.yiiframework.com/doc/api/1.1/CActiveForm#errorSummary-detail "http://www.yiiframework.com/doc/api/1.1/CActiveForm#errorSummary-detail")多个模型时，请使用：

```
$form->errorSummary(array($model1,$model2,$model3)); 
```

# php - 无法找出 mySQL 语法错误的来源

> ID：11129536
> 
> 赞同：1
> 
> 时间：2012-06-20T23:18:10.680
> 
> 标签：php, mysql, sql

我正在我网站上的用户之间开发一个私人消息系统。这是我的查询：

```
$query = "INSERT INTO messages (to, `from`, message) VALUES ('{$user}', '{$username}', '{$message}')"; 
```

但是，我收到此错误：

```
您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 'to, `from`, message) VALUES ('Cheezey', 'Cheezey', 'Enter your message here')' 附近使用正确的语法

```

我有一种唠叨的感觉，这对我来说是一个非常愚蠢的错误，但我似乎无法弄清楚。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T23:19:55.340

那是因为`to`是 MYSQL 中的[保留字](http://dev.mysql.com/doc/refman/5.1/en/reserved-words.html)，你必须把 ` 放在它周围，像这样：

```
 INSERT INTO(`to`, ...). 
```

# r - 实现多个位置闪避

> ID：11129539
> 
> 赞同：2
> 
> 时间：2012-06-20T23:18:26.013
> 
> 标签：r, plot, ggplot2

在 ggplot2 中，我想控制条形图或横线图中的变量和因子内的多个位置闪避。例如：

```
data = data.frame(Var=c("a","a","a","a","b","b","b","b"),
                Val=c(0.5,0.4,0.1,0.0,-0.1,-0.3,-0.0,0.1),
                g1=c(1,2,3,4,5,6,7,8),
                g2=c(1,2,3,4,1,2,3,4),
                g3=c(1,2,1,2,1,2,1,2))

q = ggplot(data,aes(Var,Val,ymin = Val-0.15,
                    ymax=Val+0.15,
                    group=g1,
                    colour=factor(g2),
                    fill=factor(g2),
                    linetype=factor(g3),))
q + geom_crossbar(width=0.5,fatten=2,size=0.5,position=position_dodge(width=0.51)) + 
    coord_flip() +  
    theme_bw() + 
    scale_fill_manual(values=c("#00000090","#00000090","#00000050","#00000050")) + 
    scale_colour_manual(values=c("#000000","#00000070","#000000","#00000070")) 
```

在上面的示例中，我希望能够将较暗的条与较亮的条稍微分开，同时将每个条设置在一起。我可以实施多个位置闪避来实现这一点吗？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T00:35:50.840

我建议使用`facet_grid`来模拟您想要的嵌套闪避。为此，我创建了一个新因子`g4`，将浅灰色和深灰色条分组。

```
library(ggplot2)

dat = data.frame(Var=c("a","a","a","a","b","b","b","b"),
                Val=c(0.5,0.4,0.1,0.0,-0.1,-0.3,-0.0,0.1),
                g1=c(1,2,3,4,5,6,7,8),
                g2=c(1,2,3,4,1,2,3,4),
                g3=c(1,2,1,2,1,2,1,2))

dat$g4 = c(1, 1, 2, 2, 1, 1, 2, 2) # New grouping factor

fill_values   = c("#00000090","#00000090","#00000050","#00000050")
colour_values = c("#000000","#00000070","#000000","#00000070")

#---------------------------------------------------------------------------
fig1 = ggplot(dat, aes(x=Var, y=Val, ymin=Val - 0.15, ymax=Val + 0.15, 
              colour=factor(g2), fill=factor(g2), linetype=factor(g3))) +
    geom_crossbar(width=0.5, fatten=2, size=0.5,
                  position=position_dodge(width=0.51)) +
    coord_flip() + 
    theme_bw() +
    scale_fill_manual(values=fill_values) +
    scale_colour_manual(values=colour_values) +
    opts(title="Figure 1: Original Version")

png("fig1.png", height=600, width=600)
print(fig1)
dev.off()

#---------------------------------------------------------------------------
fig2 = ggplot(dat, aes(x=factor(g4), y=Val, ymin=Val - 0.15,ymax=Val + 0.15, 
              colour=factor(g2), fill=factor(g2), linetype=factor(g3))) +
    geom_crossbar(width=0.7, fatten=2, size=0.5,
                  position=position_dodge()) +
    coord_flip() + 
    theme_bw() +
    scale_fill_manual(values=fill_values) +
    scale_colour_manual(values=colour_values) +
    facet_grid(Var ~ .) +
    opts(title="Figure 2: Proposed Solution")

png("fig2.png", height=600, width=600)
print(fig2)
dev.off() 
```

![图1](../Images/315109502bd074336884139d1fbf2220.png) ![图 2](../Images/3f2f73f0dbc725b89d244f1104a273cf.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-21T21:26:59.440

**更新的代码**和情节

这是一种在一个面板中将浅灰色与深灰色分开的方法。它涉及对数据进行子集化，以便在对 的两次调用中`geom_crossbar`，浅灰色的横线位于第一次调用中，然后深灰色的横线位于第二次调用中。我在数据框中添加了另一个分组变量，以允许对数据进行子集化。

```
library(ggplot2)
data = data.frame(Var=c("a","a","a","a","b","b","b","b"),
                Val=c(0.5,0.4,0.1,0.0,-0.1,-0.3,-0.0,0.1),
                g1=c(1,2,3,4,5,6,7,8),
                g2=c(1,2,3,4,1,2,3,4),
                g3=c(1,2,1,2,1,2,1,2))
data$g4 = c(1,1,2,2,1,1,2,2)

q = ggplot(data, aes(Var,Val,ymin = Val-0.15,
    ymax=Val+0.15, group=g1, colour=factor(g2),
    fill=factor(g2), linetype=factor(g3)))

# Position the light grey crossbars
q = q + geom_crossbar(data = subset(data, data$g4 == 1), 
        aes(as.numeric(Var) - .12, Val, ymin = Val-0.15, ymax = Val + 0.15), 
        width = 0.2, fatten = 1.25, size = 0.65, position = position_dodge(width = 0.2))

library(grid)
# position the dark grey crossbars, and tidy up
q + geom_crossbar(data = subset(data, data$g4 == 2), 
        aes(as.numeric(Var) + .12, Val, ymin = Val-0.15, ymax = Val + 0.15), 
        width = 0.2, fatten = 1.25, size = 0.65, position = position_dodge(width = 0.2)) + 
    scale_x_continuous(breaks = c(1, 2), labels = c("a", "b"), expand = c(.2, 0)) +
    scale_fill_manual(values = c("#00000057", "#00000057", "#00000020", "#00000020")) + 
    scale_colour_manual(values = c("#000000", "#00000070", "#000000", "#00000070")) +
    coord_flip() +  theme_bw() +
   theme(legend.key.size = unit(1.5, "cm")) 
```

![在此处输入图像描述](../Images/bc66c391da7647ffcff980fe5ef75725.png)

# php - 有没有办法让 Netbean 生成的 PHP 单元测试符合 CodeSniffer Zend 标准？

> ID：11129541
> 
> 赞同：0
> 
> 时间：2012-06-20T23:18:31.940
> 
> 标签：php, zend-framework, phpunit, netbeans-7, codesniffer

我正在使用 Netbeans 生成 PHP 单元测试，而 CodeSniffer 不喜欢生成的模板，因为它不是 Zend 标准。如何让 PHP 单元测试模板生成 Zend 标准模板，这样它就不会引发所有这些违规行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T23:23:18.230

骨架生成是 PHPUnit 源代码的一部分。我认为您需要对项目进行 fork，然后根据需要修改骨架生成，然后使用您的 fork。

# android - 了解 Android 中的操作栏

> ID：11129542
> 
> 赞同：0
> 
> 时间：2012-06-20T23:18:33.510
> 
> 标签：android, android-layout, android-actionbar

所以我有几个关于实现Android操作栏的问题。到目前为止，我还没有真正制作出任何（在我看来）足以投放市场的应用程序。这似乎真的是我无法理解布局和操作栏将如何在不同版本的 Android 中工作。

当然，谷歌似乎是最好的选择，但我遇到了一些可能有人可以清理的灰色区域。我可以看到操作栏是在[API 级别 11](http://developer.android.com/guide/topics/ui/actionbar.html)中实现的，但是当我尝试在低于 3.0 的设备上运行它时会发生什么？此外，在了解如何以及在何处使用操作栏时，[这](http://developer.android.com/design/patterns/actionbar.html)似乎是最有帮助的，但这是否意味着操作栏全部以编程方式完成，而不是在布局中？我想可以肯定地说使用操作栏让我有点“害怕”，因为我会在不同的设备中获得不同的布局......所以有没有办法让它“看起来”像我有一个操作栏，即使它纯粹是通过布局完成的？或者这是一个坏习惯？

我听说[兼容性库](http://developer.android.com/sdk/compatibility-library.html)可能运行良好，但我真的不知道它的作用，而且我还不够聪明，无法理解 android 文档“真正”的作用。如果它确实对支持旧设备很有帮助，为什么它不在 SDK 中构建/成为标准？

我知道这是一个非常广泛的问题，但归根结底，我只是想知道是否真的有一种方法可以让我的所有布局看起来和工作起来都一样，或者它是否值得我花时间并且只是拥有旧设备的操作栏自动降级。

还有一个问题，我有一个 Galaxy Nexus，所有核心 Google Apps 的操作栏看起来都很棒，但是有没有办法看到这些更新的应用程序在 API 11 或更低版本上运行？

最后，如果有人偶然发现了一个很棒的教程，请列出它。我真的很想了解 Android 布局如何在所有 API 级别中工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T23:34:32.433

> 我可以看到操作栏是在 API 级别 11 中实现的，但是当我尝试在低于 3.0 的设备上运行它时会发生什么？

默认情况下，用户将像以前一样获得选项菜单。或者，正如 Weening 先生所指出的，使用 ActionBarSherlock 让操作栏回到 Android 2.1。

> 但这是否意味着操作栏全部以编程方式完成，而不是在布局中？

它与选项菜单相同，主要使用菜单资源和 Java 代码。

> 如果它确实对支持旧设备很有帮助，为什么它不在 SDK 中构建/成为标准？

欢迎您创建一台时间机器并及时返回，将该代码添加到可追溯到 2009 年的 Android 设备。您可能可以在 eBay 上找到一个很少使用的磁通电容器，但可能要找到一个 Mr. Fusion 设备麻烦一些。或者，如果您在英国，请查看是否可以找到二手 TARDIS 经销商。

与此同时，我们其他人将部分使用 Android Support 包来支持其片段的反向移植`GridLayout`等，因此我们可以使用旧设备非原生的新功能，同时保持 API 与原生实现的保真度较新的设备。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-20T23:26:20.080

要支持具有相同外观操作栏的旧版本的 android，您可以查看 Action Bar Sherlock

[http://actionbarsherlock.com/](http://actionbarsherlock.com/)

从他们的网站：

该库将在适当时自动使用本机操作栏，或者会自动围绕您的布局包装自定义实现。这使您可以轻松地为 2.x 及更高版本的每个版本的 Android 开发带有操作栏的应用程序

这工作得很好。

如果您更喜欢冒险并且想要更多地控制它的布局、外观和感觉，您总是可以尝试自己实现它。这不是一件容易的事，但操作栏更像是一个用户体验设计，而不是一个实际的组件。兼容性库的代码是一个很好的起点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T23:38:45.533

如果您只需要一个菜单​​、一个标题和一个图标，那么简单的方法是：

1.  选择带有 ActionBar 的主题，例如“Theme.Holo”
2.  创建一个新菜单，即`actionbar.xml`
3.  在你的活动中实现它

    ```
    @Override
    public boolean onCreateOptionsMenu(Menu menu){
        MenuInflater inflater = getMenuInflater(); 
        inflater.inflate(R.menu.actionbar, menu);
        return true;
    } 
    ```

由于这与旧版本中的菜单大致相同，因此旧版本只是缺少 ActionBar，而是使用旧菜单。

## 或者

如果您希望在所有版本（包括 API 11 之前）中使用相同的 ActionBar，正如 Geert 已经建议的那样：

[http://actionbarsherlock.com/](http://actionbarsherlock.com/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-20T23:43:08.553

如果您尝试在不受支持的 Android 版本上使用 ActionBar，那么它只会使您的应用程序崩溃。为了解决这个问题，您可以实现库 ActionBarSherlock，如果可用，它使用本机 ActionBar，否则它会创建自己的具有相同功能的库。您也可以在运行时检查Android版本并自行处理。我会检查这个链接，因为它实际上有一个 ActionBar 示例：

[http://developer.android.com/training/basics/supporting-devices/platforms.html#version-codes](http://developer.android.com/training/basics/supporting-devices/platforms.html#version-codes)

# django - 在 Django Admin 中隐藏内联模型

> ID：11129544
> 
> 赞同：2
> 
> 时间：2012-06-20T23:18:51.830
> 
> 标签：django, django-admin

如果内联中不存在要显示的对象，有没有办法禁止显示内联模板？我宁愿完全隐藏内联而不是显示带有空白/空值的内联。

我尝试了两种方法，第一种是使用条件逻辑将`model`属性设置`InlineModelAdmin`为`None`对象本身为`None`. 这不起作用，因为我正在处理内联定义中的类对象，而不是类本身的实例。

我的第二种方法是用类似的方法修改 ModelAdmin。同样的问题。

我没有尝试修改模板，但似乎这可能是最好的方法。

修改查询集似乎不起作用，因为查询集已经返回一个空集。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-03-24T20:17:29.487

感谢[@okm](https://stackoverflow.com/users/165603/okm)

```
class MyInline(admin.TabularInline):
    model = MyModel
    extra = 0 
```

# python - 谷歌应用引擎模板和样式表

> ID：11129545
> 
> 赞同：-1
> 
> 时间：2012-06-20T23:18:51.903
> 
> 标签：python, html, css, google-app-engine, templates

因此，我在 jsfiddle [http://jsfiddle.net/8FNZE/2/](http://jsfiddle.net/8FNZE/2/)中提出了以下样式表，我想将其用作一系列以下网页的基础。我的问题是我可以使用包含样式表的那个页面，它只影响那里的 HTML，然后对于子模板，我可以有一个不同的 CSS 文档，它只影响孩子的 HTML。我正在使用 Jinja2 并使用 python 对应用程序进行编码。

如果这不起作用，我应该只制作一个包含所有页面信息的大样式表，或者最好的方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T23:23:14.850

我会看[这篇](https://stackoverflow.com/questions/2336302/single-huge-css-file-vs-multiple-smaller-specific-css-files)文章，其中详细介绍了使用单个样式表与多个样式表的优缺点。

# python - 从列表/字典中删除项目后，Python“sys.getsizeof”报告相同大小？

> ID：11129546
> 
> 赞同：4
> 
> 时间：2012-06-20T23:18:57.400
> 
> 标签：python, list, memory, dictionary

我注意到当使用 sys.getsizeof() 检查列表和字典的大小时，会发生一些有趣的事情。

我有：

```
a = [1,2,3,4,5] 
```

大小为 56 字节（空列表的大小为 36，因此有意义，因为 20/5 = 4）

但是，在我删除列表中的所有项目后（使用 .remove 或 del），大小仍然是 56。这对我来说很奇怪。尺寸不应该回到36吗？

有什么解释吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-20T23:22:34.553

该列表不承诺在您删除元素时释放内存。列表被过度分配，这就是它们如何为附加元素摊销 O(1) 性能。

数据结构的时间性能细节：[http ://wiki.python.org/moin/TimeComplexity](http://wiki.python.org/moin/TimeComplexity)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-20T23:27:29.777

增加容器的大小可能是一项昂贵的操作，因为它可能需要在内存中移动很多东西。因此，Python 分配的内存几乎总是比列表的当前内容所需的更多，从而允许对列表的任何单独添加都非常有可能在不需要移动内存的情况下执行。出于类似的原因，列表可能不会立即或永远不会释放已删除元素的内存。

但是，如果您使用切片分配一次删除所有元素：

```
a[:] = [] 
```

*这*似乎重置它。然而，这是一个实现细节。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T23:25:38.337

当您将项目附加到 Python 列表时，如果已为列表分配的内存已满，它将分配给定数量的内存。当您从列表中删除项目时，它会为您下次将项目附加到列表时分配内存。有关示例，请参阅[此相关帖子。](https://stackoverflow.com/questions/311775/python-create-a-list-with-initial-capacity)

# windows-phone-7 - 在 Windows Phone 中的页面之间共享数据

> ID：11129550
> 
> 赞同：0
> 
> 时间：2012-06-20T23:19:15.560
> 
> 标签：windows-phone-7

我有一个非常基本的课程，其中包含用户 Twitter 令牌信息。每次我调用 API 时，我都需要这个类，所以我想知道在页面之间共享它的最佳方式是什么。当从 twitter 请求令牌时，该类第一次被序列化。

因此，如果我还没有它，我能做的就是在每个页面中反序列化它。但这是一个好方法吗？有没有比经常需要反序列化类更好的方法？（可能是更快的方法，或者根本没有性能问题？）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T05:54:33.437

您可以在项目中定义 TwitterSettings.cs 类，并将成员定义为静态。这样您就可以在主页中设置它们的值，然后在整个应用程序中访问它们，如下所示，

```
oauthToken = TwitterSettings.AccessToken; 
```

实现此目的的另一种方法是使用 App.xaml.cs 页面中的 Application 资源检查此链接以获取[Application Properties](http://msdn.microsoft.com/en-us/library/aa348545)。

# android - android sqlite 表名

> ID：11129552
> 
> 赞同：0
> 
> 时间：2012-06-20T23:19:26.450
> 
> 标签：android, sqlite

我的应用程序在同一部手机上可能有多个用户，我希望每个用户都有自己的“ApplicationFriends”mysqlite 表。当表的名称只有“ApplicationFriends”时，一切正常。但是当我尝试设置像这样的“ApplicationFriends2345”表名时，当 2345 是唯一的用户编号时，我在尝试运行选择查询时总是收到错误，说该表不存在。

这是我的表创建代码：

```
public DatabaseManager(Context context, String id) {
    super(context, DATABASE_NAME, null, DATABASE_VERSION);
    DatabaseManager.TABLE_APPLICATION_FRIENDS = TABLE_APPLICATION_FRIENDS_BASE + id;
}

@Override
public void onCreate(SQLiteDatabase db) {
    String CREATE_APPLICATIN_FRIENDS_TABLE = "CREATE TABLE IF NOT EXISTS "
            + TABLE_APPLICATION_FRIENDS + " (" + APPLICATION_FRIENDS_KEY_ID
            + " INTEGER PRIMARY KEY," + APPLICATION_FRIENDS_KEY_NAME
            + " TEXT" + ")";
    String CREATE_CHAT_TABLE = "CREATE TABLE IF NOT EXISTS " + TABLE_Chat
            + " (" + CHAT_KEY_SENDER_ID + " INTEGER," + CHAT_KEY_MESSAGE
            + " TEXT," + CHAT_KEY_TIME + " DateTime" + ")";

    db.execSQL(CREATE_APPLICATIN_FRIENDS_TABLE);
    db.execSQL(CREATE_CHAT_TABLE);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T23:40:03.687

SQLiteOpenHelper.onCreate(SQLiteDatabase) 仅在创建数据库时调用一次。请参阅[http://developer.android.com/reference/android/database/sqlite/SQLiteOpenHelper.html](http://developer.android.com/reference/android/database/sqlite/SQLiteOpenHelper.html)。

更好的方法是只有一个“应用程序朋友”表。在表中添加一个名为 UserId 的列，用于存储 Id。然后，当您在表上编写查询时，您将包含 UserId = '2345'。例如： db.rawQuery("Select * from ApplicationFriends where userID = '2345'",null) 。这将返回 id = "2345" 的用户的所有数据

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T00:37:47.667

您可以按照您尝试的方式进行操作（每个用户都有一个表格）。您只需将表创建代码移动到 dbhelkper 类中的方法以外的方法`onCreate`中，然后根据需要调用它（当您添加新用户时）。

```
public void createFriendTable(String friendID) { 
    String CREATE_FRIEND_TABLE = "CREATE TABLE IF NOT EXISTS " 
            + friendID + " (" + APPLICATION_FRIENDS_KEY_ID 
            + " INTEGER PRIMARY KEY," + APPLICATION_FRIENDS_KEY_NAME 
            + " TEXT" + ")"; 
     db.execSQL(CREATE_FRIEND_TABLE); 
} 
```

然后在任何你需要的地方：

```
mDbHelper.createFriendTable(friendID); 
```

这就是我要做的，因为它会使删除用户变得更加容易。你只会放下他们的桌子。

# salesforce - 案例：如果案例是 Outlook 的电子邮件到案例，我如何包含电子邮件的标题

> ID：11129553
> 
> 赞同：2
> 
> 时间：2012-06-20T23:19:34.620
> 
> 标签：salesforce, apex-code

**设置：**

当用户执行电子邮件转个案时，created by 字段是自动个案用户。

**问题：**

1.  我如何检测它是否是通过前景？
2.  我需要找到原始发件人。我正在尝试获取电子邮件的标题，但我无法为 Outlook 获取它...关于如何获取原始发件人的电子邮件或如何获取标题的任何想法？

谢谢-El Noobre

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-13T08:14:01.457

使用电子邮件以防万一，您的能力非常有限，并且无法直接访问标题。但是，如果您创建自己的[入站电子邮件处理程序](http://www.salesforce.com/us/developer/docs/apexcode/index_Left.htm#CSHID=apex_classes_email_inbound.htm%7CStartTopic=Content/apex_classes_email_inbound.htm%7CSkinName=webhelp)，您可以解决此问题，该处理程序具有访问标头的方法。如果你谷歌一下，你可以找到一些[很好的教程](http://blog.jeffdouglas.com/2010/03/12/writing-an-inbound-email-service-for-salesforce-com/)。

# templates - 骨干（下划线）模板问题

> ID：11129554
> 
> 赞同：0
> 
> 时间：2012-06-20T23:19:36.153
> 
> 标签：templates, backbone.js, underscore.js

我对主干模板有一点奇怪的问题。

我有以下模板

```
 <div class='content'>
        <img src="assets/images/room/temp-img.jpg" class='room-image'/>
        <div class="room-content-right">
            <h2 class='room-name'><%= title %> </h2>
            <p class="room-description"><%= shortDescription %></p>     

            <a class='btn-view-detail'><%= dictionary.viewDetail %></a>     

            <div class='float-right'>
                <div class='text-startingAt'><%= dictionary.startingAt %> $xxx / <%= dictionary.night %></div>
                <a class="btn-select-room"><%= dictionary.selectThisRoom %></a>
            </div>

        </div>

        <div class="clear-both"></div>

    </div>

    <ul class='packages'>

    </ul> 
```

当我渲染它时，我得到以下 HTML

![在此处输入图像描述](../Images/dd432bb514d0801abd3ecb50f5c9aefc.png)

如您所见，VIEW DETAIL 锚点与 div.float-right 不同。

我做错了什么还是来自主干的这个错误？

# r - 如何使用 R 按列计算每周数据的平均值？

> ID：11129562
> 
> 赞同：1
> 
> 时间：2012-06-20T23:21:00.240
> 
> 标签：r, xts

我有一个每日数据的数据框： df 有四列：`Date, A, B, C` 并且我试图按列获取每周数据的平均值。我试过：

```
library(xts)
xdf <- xts(df[ ,-1],as.Date(df$Date))

apply.weekly(xdf,mean) 
```

但这给了我所有列的平均值。我需要每列的每周平均值。

感谢您的帮助

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-20T23:29:21.840

首先获取一些数据（我将使用 a`data.frame`因为这就是您正在使用的，但我真的建议您对时间序列对象使用时间序列类）

```
getSymbols("SPY", src='yahoo', from='2012-05-01', to='2012-06-15',
           return.class='data.frame')
#"SPY" 
```

`apply.weekly`将按周拆分数据并每周应用一个函数。`apply.weekly(SPY, mean)`将计算该周所有数据的平均值，但您希望它计算每周*每列*的平均值。所以，你必须`apply` `mean`对每一列

```
apply.weekly(SPY, function(x) apply(x, 2, mean))
#           SPY.Open SPY.High SPY.Low SPY.Close SPY.Volume SPY.Adjusted
#2012-05-04 139.6425 140.4675 138.750  139.3275  149400050     138.6075
#2012-05-11 135.9480 136.9320 135.338  136.2040  173105700     135.5020
#2012-05-18 133.3000 133.9180 132.036  132.1760  229282720     131.4960
#2012-05-25 131.7660 132.6800 130.896  132.2140  176634780     131.5340
#2012-06-01 131.7100 132.8925 130.290  131.2725  191170200     130.5950
#2012-06-08 130.2780 131.3380 129.584  130.8580  175917220     130.1820
#2012-06-15 132.8420 133.7760 131.828  132.8020  184751180     132.2540 
```

作为参考，`apply.weekly`是一个包装器，`period.apply`因此您也可以使用

```
period.apply(SPY, endpoints(SPY, "weeks"), FUN=function(x) apply(x, 2, mean)) 
```

# php - PHP - 重置 $_SESSION["SESSION_PASSWORD"] 不起作用

> ID：11129564
> 
> 赞同：1
> 
> 时间：2012-06-20T23:21:41.667
> 
> 标签：php, session, variables, passwords

我正在尝试在我的网站上创建更改密码选项。我正在使用会话变量来跟踪用户用户名/密码 .. 我将其传递给每个页面上的 authcheck 函数。

我遇到的问题是这个。当我更改用户密码时，将不再加载页面，因为存储在会话变量中的密码与数据库中的密码不再相同。

如何更改会话变量以反映新通行证？目前我正在尝试：

`$_SESSION["SESSION_PASSWORD"] = $newPass;`

我认为这会将`SESSION_PASSWORD`新通行证中的内容重新分配。不过似乎不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T23:37:07.620

首先，您如何/在代码中的何处设置会话变量？

也许 start_session() 还没有被调用？

# php - PHP当数据库中不存在记录时该怎么办

> ID：11129566
> 
> 赞同：0
> 
> 时间：2012-06-20T23:21:59.617
> 
> 标签：php, mysql, codeigniter, http-status-code-404

我正在数据库中查询与 url 段中传递的 id 匹配的单个记录`www.site.com/post/24`。

假设帖子`24`不存在。处理未找到的数据库请求的安全且*符合 seo的方法是什么？*

以下是我当前使用 Codeigniter 模型的解决方案：

```
 function read_post($post_id) //argument is the value of the url segment
    {
        $user_id = $this->tank_auth->get_user_id();

        $this->db->where('user_id', $user_id);
        $this->db->where('post_id', $post_id);
        $this->db->limit(1);
        $query = $this->db->get('posts');

        //check if record exists
        if ($query->num_rows() > 0) //row is returned
        {
            return $query->row(); //passed to controller and view
        }
        else
        {
            show_404(); //generate 404 message
            return FALSE; //------------------------or exit()?
        }
    } 
```

请分享您自己的最佳方法/意见。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-20T23:24:32.680

显示 404 页面（带有 404 HTTP 状态代码）。这才是正确的做法。否则，您将假装您有无数页没有内容。

在 404 页面上简短地描述内容不再存在。然后，您可以在您的网页上添加指向其他热门内容的链接。为了用户着想，我们鼓励尝试将他们*从*404 页面引导*到*有趣的内容，但要使用链接进行此操作，以便用户可以阅读 404 消息并选择下一步做什么。

如果您有有意义的带有单词的 URL，您也可以提取单词并在您的数据库中进行某种搜索。在 404 页面上也列出搜索结果，在“您可能对...感兴趣”之类的标题下。如果您正在销售产品或服务，请不要犹豫，将 404 页面变成一个很好的销售页面！

我坚信最好的搜索引擎优化是最适合您的访问者的搜索引擎优化。这一切都是*为了将​​它们保留*在您的网站上，而不是吓跑它们。使您的网站尽可能用户友好，并让您轻松找到所有有趣的内容。我上面的回答直接源于这种信念。根据标准（在本例中为 HTTP 标准）做正确的事，同时尝试以优质的内容和服务吸引用户。这当然也是对贵公司在销售方面最有利的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-20T23:27:15.923

SEO与您的数据库无关。

SEO 与关键字、标题、描述、词频、指向与最终呈现的 HTML 文档上的文章在同一区域内的页面的传出链接有关。

此外，您需要 SEO 友好的链接，例如`/beach-party-on-sunday/`，`/post/24`不会削减它。

答：根据 SEO 理智和 HTTP 服务器的一般工作原理，如果您的网站上不存在 URL，**最好以 404 HTTP 状态响应**，而不是 200 成功。但是，如果您有一个希望重定向用户的 URL，请使用永久或临时重定向，具体取决于该 URL 是否会恢复活力。

只需简单并遵守规则，您就会对 SEO 友好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T23:24:32.530

我重定向到主页。在这种特定情况下，我会重定向到 www.site.com/post。

# java - Hibernate 类级别验证

> ID：11129567
> 
> 赞同：0
> 
> 时间：2012-06-20T23:22:10.367
> 
> 标签：java, hibernate, jsf

好吧，我阅读了几个关于使用 hibernate 进行类级别验证的问题（这里和其他站点），我创建了注释和验证类，但是当验证返回 false 时，我得到一个异常（当验证返回 true 时它可以），该类不是有效（显然是因为验证返回错误），我的疑问是：它不是也返回验证消息吗？为什么返回异常，代码：

有效块.java

```
@Target({ElementType.TYPE, ElementType.ANNOTATION_TYPE})
@Retention(RetentionPolicy.RUNTIME)
@Constraint(validatedBy = ValidBlockValidator.class)
public @interface ValidBlock {
    String message() default "{app.ValidBlock.message}";
    Class<?>[] groups() default {};
    Class<? extends Payload>[] payload() default {};
} 
```

ValidBlockValidator.java

```
public class ValidBlockValidator implements ConstraintValidator<ValidBlock, Block> {

   @Override
   public void initialize(ValidBlock aBlock) {}

   @Override
   public boolean isValid(Block value, ConstraintValidatorContext context) {
      return false;
    }
} 
```

我进行了测试，我很确定我收到了 Block 对象，因为当验证返回 true 很好时，我只是返回 false 进行测试。

块.java

```
@ValidBlock
public class Block{
   ...
} 
```

和错误：

> 严重：javax.validation.ConstraintViolationException：在组 [javax.validation.groups.Default,] 的持续时间内对类 [com.labsys.model.Block] 的验证失败，] 约束违规列表：[ ConstraintViolationImpl{interpolatedMessage='{app. ValidBlock.message}', propertyPath=, rootBeanClass=class com.labsys.model.Block, messageTemplate='{app.ValidBlock.message}'}] 在 org.hibernate.cfg.beanvalidation.BeanValidationEventListener.validate(BeanValidationEventListener.java: 159) 在 org.hibernate.action.internal.EntityInsertAction.preInsert(EntityInsertAction.java:185) 在 org.hibernate.action.internal.EntityInsertAction 的 org.hibernate.cfg.beanvalidation.BeanValidationEventListener.onPreInsert(BeanValidationEventListener.java:94) .execute(EntityInsertAction.java:81) 在组织。hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:362) 在 org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:354) 在 org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue. java:275) 在 org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:52) 在 org.hibernate.internal.SessionImpl 的 org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:326) .flush(SessionImpl.java:1214) 在 org.hibernate.ejb.AbstractEntityManagerImpl.flush(AbstractEntityManagerImpl.java:981)275) 在 org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:52) 在 org.hibernate.internal.SessionImpl.flush 的 org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:326) (SessionImpl.java:1214) 在 org.hibernate.ejb.AbstractEntityManagerImpl.flush(AbstractEntityManagerImpl.java:981)275) 在 org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:52) 在 org.hibernate.internal.SessionImpl.flush 的 org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:326) (SessionImpl.java:1214) 在 org.hibernate.ejb.AbstractEntityManagerImpl.flush(AbstractEntityManagerImpl.java:981)
> 
> 严重：JSF1073：javax.faces.event.AbortProcessingException obtido durante o processamento de INVOKE_APPLICATION 5：UIComponent-ClientId=blockForm:j_idt14，Message=javax.validation.ConstraintViolationException：在持久化期间对类 [com.labsys.model.Block] 的验证失败组的时间 [javax.validation.groups.Default, ] 约束违规列表：[ ConstraintViolationImpl{interpolatedMessage='{app.ValidBlock.message}', propertyPath=, rootBeanClass=class com.labsys.model.Block, messageTemplate=' {app.ValidBlock.message}'}] 严重：javax.validation.ConstraintViolationException：在组 [javax.validation.groups.Default，] 约束违规列表的持续时间内，类 [com.labsys.model.Block] 的验证失败：[ConstraintViolationImpl{interpolatedMessage='{app.ValidBlock。message}', propertyPath=, rootBeanClass=class com.labsys.model.Block, messageTemplate='{app.ValidBlock.message}'} ]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T23:29:19.390

您需要创建一个`ValidationMessages.properties`文件并使其在类路径的根目录中可用，以便验证框架推断您的自定义消息。

# html - 如何让 Netbeans 识别自定义 HTML 属性？

> ID：11129570
> 
> 赞同：2
> 
> 时间：2012-06-20T23:22:34.543
> 
> 标签：html, netbeans, netbeans-7

在 netbeans (7.1.2) 中，当向 HTML 元素添加自定义属性时，例如 data-dismiss="modal 我收到警告'data-dismiss not allowed on element...'。是否可以添加自定义 HTML 属性到 Netbeans，让它知道这些属性而不给出警告？

我已经彻底查看了所有菜单选项和配置。我希望像“向字典中添加属性”这样的东西

# android - 带有 HTML 5 的 deviceready 事件上的 PhoneGap 错误

> ID：11129578
> 
> 赞同：0
> 
> 时间：2012-06-20T23:23:42.097
> 
> 标签：android, html, cordova, simulator

我有一个可以想象的最简单的 PhoneGap 应用程序！

我要做的就是在 deviceready 事件上显示一条警报消息。

**代码**

```
<!DOCTYPE HTML>
<html>
<head>
    <title>PhoneGap</title>
    <script type="text/javascript" charset="utf-8" src="phonegap.js"></script>
    <script type="text/javascript" charset="utf-8" src="common.js"></script>
</head>
<body>
    <div data-role="page" id="index-page">
        <h1>Hello World!</h1>
</body>
</html> 
```

**common.js 代码**

```
var isPhoneGapReady = false;
function init() {

        document.addEventListener("deviceready", 
            onDeviceReady, false);

        // Older versions of Blackberry < 5.0 don't support 
        // PhoneGap's custom events, so instead we need to 
        // perform an interval check every 500 milliseconds 
        // to see if PhoneGap is ready.  Once done, the 
        // interval will be cleared and normal processing
        // can begin
        var intervalID = window.setInterval(function() {
              if (PhoneGap.available) {
                  onDeviceReady();
              }
          }, 500);
  }

function onDeviceReady() {
    window.clearInterval(intervalID);

    // set to true
    isPhoneGapReady = true;
alert("The device is now ready");
}

// Set an onload handler to call the init function
window.onload = init; 
```

我正在使用云服务来获取 APK 文件，并在 Android 模拟器 4.0.3 版中运行它。

**控制台上的错误：**

```
init
Ignote this event
W/webcore(6387): java.lang.Throwable: EventHub.removeMessages(int what = 107) is not supported before the WebViewCore is set up.
at android.webkit.WebViewCore$EventHub.removeMessages(WebViewCore.java:1683) 
```

如果有人能指出需要做什么来纠正错误，我将不胜感激。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T23:32:54.243

我认为您遇到的问题是您`intervalID`的 ' 范围没有达到您的`onDeviceReady()`功能。您需要在函数中创建该`init()`函数，如下所示 -

```
var isPhoneGapReady = false;

function init() {

    document.addEventListener("deviceready", onDeviceReady, false);

    // Older versions of Blackberry < 5.0 don't support 
    // PhoneGap's custom events, so instead we need to 
    // perform an interval check every 500 milliseconds 
    // to see if PhoneGap is ready.  Once done, the 
    // interval will be cleared and normal processing
    // can begin

    var intervalID = window.setInterval(function() {
          if (PhoneGap.available) {
              onDeviceReady();
          }
      }, 500);

        // REMOVE THIS
        // }

    function onDeviceReady() {
        window.clearInterval(intervalID);

        // set to true
        isPhoneGapReady = true;
    alert("The device is now ready");
    }

// PUT THIS HERE
}

// Set an onload handler to call the init function
window.onload = init; 
```

# c# - XNA 的 Vector2 类，属性在尝试更改其值时返回错误

> ID：11129581
> 
> 赞同：2
> 
> 时间：2012-06-20T23:24:22.703
> 
> 标签：c#, properties, xna, accessor

我将首先用一些代码来说明我的问题：

```
class ExampleClass
{
    private Vector2 _myVector;

    public Vector2 MyVectorProperty { get { return _myVector; } set { _myVector = value; } }

    private void MyMethod()
    {
        _myVector = Vector2.Zero; // Setting to zero

        MyVectorProperty.X = 5; //Cannot modify the expression because it is not a variable (returns an error)

        _myVector.X = 5; //Works fine!
    }
} 
```

如您所见，当尝试使用该属性更改向量上 X 和 Y 的值时，我收到错误“无法修改表达式，因为它不是变量”。我不确定为什么会发生这种情况并且在网上没有任何运气，我想知道为什么会这样以及如何（如果）我可以解决它？

另一个子问题，在它们所属的类中工作时使用公共属性或私有/受保护字段是一种好的编程习惯吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T23:45:48.637

你应该很高兴编译器不允许你这样做，否则你会对操作结果丢失感到非常惊讶。

*   `MyVectorProperty`是属性 - 这意味着获取值是调用返回值的函数（类似于`this.get_MyVectorProperty()`）。
*   由于类型`MyVectorProperty`是 Vector2 结构，这意味着函数返回的值`get_...`是值的副本，而不是像普通类那样的引用。
*   更改`X`上述副本的字段只会更改值副本内部的 X，并且由于该值的副本未分配给任何内容，因此它将丢失。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T23:34:31.270

`Vector2`是一个结构（值类型），所以你的属性返回的值`_myVector`（即一个副本），你不能改变它。

# visual-studio-2010 - 无法添加 Ado .Net 实体数据模型

> ID：11129592
> 
> 赞同：0
> 
> 时间：2012-06-20T23:25:53.713
> 
> 标签：visual-studio-2010, ado.net, ado.net-entity-data-model

我正在执行以下步骤：

1.  创建新的 vs2010 C# 控制台应用程序
2.  项目菜单 -> 添加新项目
3.  选择 Ado.NET 实体数据模型 -> 单击添加
4.  实体数据模型向导窗口打开。
5.  选择从数据库生成 -> 单击下一步
6.  下一个窗口出现不到 1 秒，然后自动关闭。

我尝试重置vs2010设置但没有好消息，问题仍然存在。

我还尝试使用 ASP.NET 网站。

问题是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T00:15:07.243

我有一个类似的问题，最后通过删除修复它

`c:\users\myusername\appdata\roaming\microsoft\visualstudio\10.0\SeverExplorer\DefaultView.SEView`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-15T19:51:25.573

我可以解决此修复：

1.  在路线 C:\Users\username\AppData\Roaming\Microsoft\VisualStudio\11.0\ServerExplorer
2.  删除文件“DefaultView.SEView”
3.  按键 window + R-> 并写入 devenv.exe /ResetSettings
4.  并打开 Visual Studio

# hadoop - 一个显示每个映射器和减速器的完成时间和源机器名称细分的工具？

> ID：11129595
> 
> 赞同：0
> 
> 时间：2012-06-20T23:26:35.057
> 
> 标签：hadoop, mapreduce

我知道作业任务页面（在 JobTracker UI 中）已经显示了 mapper 和 reducer 中每个任务的开始时间和结束时间，但我希望看到更像源机器名称、溢出次数等的内容。我想我可以尝试使用 JobTracker 类编写这样的工具？但在开始之前，我想看看是否已经有这样的工具。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T02:27:36.333

该命令是否`hadoop job -history all output-dir`为您提供了足够的信息来解析/处理？

*   [http://hadoop.apache.org/common/docs/r1.0.3/cluster_setup.html](http://hadoop.apache.org/common/docs/r1.0.3/cluster_setup.html) - 搜索上述命令

# mapreduce - 在 MapReduce 映射器之间共享计数器值

> ID：11129598
> 
> 赞同：0
> 
> 时间：2012-06-20T23:26:42.483
> 
> 标签：mapreduce, synchronization

我有一个读取输入并写入数据库的映射器。我想限制实际转换并写入该数据库的输入数量，并且所有映射器都必须对限制做出贡献，然后在达到该限制后停止（大约；一两个额外的没什么大不了的。）

我在我们的映射器上实现了一个限制器功能，它询问其他任务“您导入了多少条记录？” 一旦达到给定的限制，它将停止导入这些记录（尽管它将继续处理它们以用于其他目的。）

有问题的地图代码如下所示：

```
public void map(ImmutableBytesWritable key, Result row, Context context) {
  // prepare the input
  // ...

  if (context.getCounter(Metrics.IMPORTED).getValue()<IMPORT_LIMIT){
    importRecord();
    context.getCounter(Metrics.IMPORTED).increment(1l);
  }

  // do other things
  // ...
} 
```

因此，每个映射器都会检查是否还有更多空间可以导入，并且只有在未达到限制时才会执行任何导入。但是，每个映射器本身都导入了限制，因此对于 16 个映射器，我们导入了 16*IMPORT_LIMIT 记录。它肯定在做一些限制（计数远低于导入记录的正常数量。）

何时将计数器值推送到其他映射器，或者它们甚至可供每个映射器使用？我实际上可以从计数器获得一些实时值，还是它们仅在映射器完成时更新？有没有更好的方法在映射器之间共享值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T15:08:08.803

好的：据我所见，MapReduce 在工作完成之前不会在映射器之间共享计数器（即根本没有。）我不确定中途提交的映射器是否会允许以后的映射器看到他们的计数器，但它不够可靠，无法实时完成。

相反，我将运行一个简单的 java 应用程序，它自己迭代行并写入列，现有的 MapReduce 作业将使用该列来确定它是否应该导入行。

# c++ - 为什么 WinAPI 对 BOOL 类型使用 int（32 位）？

> ID：11129601
> 
> 赞同：6
> 
> 时间：2012-06-20T23:27:26.263
> 
> 标签：c++, windows, winapi, boolean, int

```
// <windef.h>

typedef int                 BOOL; 
```

由于 int 是 32 位，这不是浪费内存吗？

以防万一我错了，我尝试将法线发送`bool*`到需要的函数，`BOOL*`直到我使用 typedef int 才起作用。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-20T23:30:32.527

哇，那里慢一点。首先，我很确定`int`自从开始在 x86 上编程以来，程序员一直在使用 4 字节的布尔变量。（过去没有`bool`数据类型之类的东西）。我敢猜测 Windows 3.1 中也有同样的 typedef `<Windows.h>`。

其次，您需要更多地了解架构。您有一台 32 位机器，这意味着所有 CPU 寄存器都是 4 字节或 32 位宽。因此，对于大多数内存访问，存储和访问 4 字节值比存储和访问 1 字节值*更有效。*

如果您将四个 1 字节的布尔变量打包到一个 4 字节的内存块中，则其中三个不是 DWORD（4 字节）对齐的。这意味着 CPU / 内存控制器实际上必须做*更多*的工作才能获得价值。

在你因为制作那个“浪费”的 typedef 而对 MS 大发雷霆之前。考虑一下：在底层，大多数编译器（可能）*仍然*将数据类型实现`bool`为 4 字节`int`，原因与我刚才提到的相同。在 gcc 中尝试，并查看映射文件。我打赌我是对的。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-06-20T23:38:24.070

首先，系统 API 中使用的类型必须尽可能与语言无关，因为该 API 将被多种编程语言使用。出于这个原因，任何在某些语言中可能不存在或可能在其他语言中以不同方式实现的“概念”类型都是毫无疑问的。例如，`bool`适合该类别。最重要的是，在系统 API 中，将接口类型的数量保持在最低限度是一个非常好的主意。任何可以用 表示的东西都`int`应该用 表示`int`。

其次，您关于这是“浪费内存”的断言毫无意义。为了成为“内存浪费”，必须构建一个包含大量`BOOL`元素的聚合数据类型。Windows API 不使用此类数据类型。如果您在程序中构建了这种浪费的数据类型，那实际上是您的错。同时，Windows API 不会以任何方式强制您将布尔值存储在`BOOL`类型中。为此，您可以使用字节甚至位。换句话说，`BOOL`是一个纯粹的*接口*类型。如果您正确使用它，类型的对象`BOOL`通常根本不会占用任何长期记忆。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-21T13:35:20.893

历史上`BOOL`被用作*anything-not-0* = TRUE 类型。例如，一个对话过程返回一个`BOOL`，它可以携带很多信息。下面的签名来自[微软自己的文档](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644995%28v=vs.85%29.aspx)：

```
BOOL CALLBACK DlgProc(HWND hwndDlg, UINT message, WPARAM wParam, LPARAM lParam) 
```

签名和函数结果混淆了几个问题，所以[在现代 API 中](http://msdn.microsoft.com/en-us/library/windows/desktop/ms645469%28v=vs.85%29.aspx)它是

```
INT_PTR CALLBACK DialogProc(
    _In_  HWND hwndDlg,
    _In_  UINT uMsg,
    _In_  WPARAM wParam,
    _In_  LPARAM lParam
); 
```

这种新奇的声明必须与旧的声明保持兼容。这意味着`INT_PTR`并且`BOOL`必须是相同的大小。这意味着在 32 位编程中，`BOOL`是 32 位。

通常，由于`BOOL`可以是任何值，而不仅仅是 0 和 1，因此将 a 与 进行比较是一个非常不好的`BOOL`主意`TRUE`。即使将其与 进行比较`FALSE`，这通常也是不好的做法，因为它很容易给人一种印象，即进行比较`TRUE`是可以的。另外，因为它完全没有必要。

顺便说一句，Windows API 中有更多布尔类型，特别[`VARIANT_BOOL`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms221627%28v=vs.85%29.aspx)是 16 位，其中逻辑 TRUE 表示为全 1 位模式，即`-1`作为有符号值......

这就是为什么直接与逻辑 FALSE 或 TRUE 比较不是一个好主意的另一个原因。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-20T23:35:25.747

处理器是 32 位的，当它在零整数上运行时有一个特殊的标志，使得对 32 位布尔值的测试非常、非常、非常快。

测试 1 位或一个字节的布尔值会慢很多倍。

如果您担心内存空间，那么您可能会担心 4 字节布尔变量。

然而，大多数程序员更担心性能，因此默认使用更快的 32 位 bool。

如果这让您感到困扰，您也许可以让您的编译器优化内存使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-01-10T07:38:17.783

这里的大多数答案似乎都是错误的。对布尔值使用 4 个字节并不比使用 1 个字节快。x86 架构读取 1 个字节的速度与读取 4 个字节的速度一样快，但 1 个字节的内存更少。对性能的最大威胁之一是内存使用。使用过多的内存，您将有更多的缓存未命中，并且您的程序会变慢。如果您只处理少数（数百个！）布尔值，这些东西并不重要，但如果您有大量的布尔值，使用更少的内存是提高性能的关键。在大型数组的情况下，我建议使用 1 位而不是 1 字节，因为如果可以节省 87% 的内存，那么屏蔽该位的额外逻辑是无关紧要的。您可以在标志位域中看到很多这种做法。

这个问题的答案绝对只是“遗留原因”。也就是“不要碰没坏的东西”。更改一行代码（例如进行次要优化）可能会引入数百个没人愿意处理的其他问题。

# javascript - YUI：使用 ajax 将内容加载到可滚动的 div 中而不移动 div 内容

> ID：11129604
> 
> 赞同：0
> 
> 时间：2012-06-20T23:27:49.943
> 
> 标签：javascript, yui, scroller

我正在尝试像 facebook 一样处理消息传递。首先，滚动放置在页面底部而不是顶部（默认行为）。当您滚动到 div 顶部时，会加载新消息，但不会更改 div 内容的位置。Facebook 只会重新计算滚动位置。因此，当我在可滚动 div 的顶部加载新消息时，我需要停止滚动以自动移动页面顶部的滚动条。

我正在使用 YUI JS 库....有什么线索吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-22T13:30:10.197

Did you try to make a

```
 scroll(0,0); 
```

when the page finished loading new message content.

You also have to make a

```
 Y.one("scrollzone").syncUI(); 
```

to make YUI recalculate the height of the scrollable div.

# objective-c - 标签栏控制器和 Facebook Connect 问题 Xcode 4.3 IOS 5.1

> ID：11129606
> 
> 赞同：1
> 
> 时间：2012-06-20T23:28:06.043
> 
> 标签：objective-c, ios, uitabbarcontroller

我正在尝试连接到 facebook 并获取用户名和图片，到目前为止我可以连接并获取用户名。我有一个工作代码可以从这里下载[（单视图应用程序）](http://gtiapps.com/misc/FBTestApp.zip)

但是，如果我将标签栏控制器放入代码中，它就无法收到来自 facebook 的响应。

我在 app.m 中以编程方式添加了一个标签栏控制器，如下面的代码

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    // Regular Code 
    /*self.viewController = [[[ViewController alloc] initWithNibName:@"ViewController" bundle:nil] autorelease];

    self.window.rootViewController = self.viewController;
    */
   //Tab bar controller code
    self.window = [[[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]] autorelease];    
    UIViewController *viewController1 = [[[ViewController alloc] initWithNibName:@"ViewController" bundle:nil] autorelease];
    self.rootController = [[[UITabBarController alloc] init] autorelease];
    self.rootController.viewControllers = [NSArray arrayWithObjects:viewController1, nil];
    self.window.rootViewController = self.rootController;
    [self.window makeKeyAndVisible];
    return YES;
}

// This method will be used for iOS versions greater than 4.2.
- (BOOL)application:(UIApplication *)application openURL:(NSURL *)url sourceApplication:(NSString *)sourceApplication annotation:(id)annotation {
    return [[_viewController facebook] handleOpenURL:url];
} 
```

如果我在 NSUrl 中的 handleOpenurl 行设置一个断点，这里有 this=`fbAPPID://authorize/#access_token=BABABSbbsabsbabb` 我猜 access_token 意味着我已经成功登录。所以标签栏不会阻止我登录将我的 Facebook 方法放在 Viewcontroller.m 中

如果没有标签栏，当我添加标签栏和断点时，Viewcontroller.m 中的所有方法都很好，下面的 facebook 方法都不起作用。我没有收到任何错误。

```
-(void)request:(FBRequest *)request didLoad:(id)result
-(void)fbDidLogin 
```

视图控制器.m

```
#import "ViewController.h"
#import "FBConnect.h"
#import "Facebook.h"

@implementation ViewController
@synthesize btnLogin;
@synthesize btnPublish;
@synthesize lblUser;
@synthesize actView;
@synthesize facebook;
@synthesize permissions;
@synthesize isConnected;
@synthesize imageView;

// The alert view that will be shown while the game will upload to facebook.
UIAlertView *msgAlert;

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Release any cached data, images, etc that aren't in use.
}

-(void)checkForPreviouslySavedAccessTokenInfo{
    // Initially set the isConnected value to NO.
    isConnected = NO;

    // Check if there is a previous access token key in the user defaults file.
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    if ([defaults objectForKey:@"FBAccessTokenKey"] &&
        [defaults objectForKey:@"FBExpirationDateKey"]) {
        facebook.accessToken = [defaults objectForKey:@"FBAccessTokenKey"];
        facebook.expirationDate = [defaults objectForKey:@"FBExpirationDateKey"];

        // Check if the facebook session is valid.
        // If it’s not valid clear any authorization and mark the status as not connected.
        if (![facebook isSessionValid]) {
            [facebook authorize:nil];
            isConnected = NO;
        }
        else {
            isConnected = YES;
        }
    }
}

-(void)setLoginButtonImage{
    UIImage *imgNormal;
    UIImage *imgHighlighted;
    UIImageView *tempImage;

    // Check if the user is connected or not.
    if (!isConnected) {
        // In case the user is not connected (logged in) show the appropriate
        // images for both normal and highlighted states.
        imgNormal = [UIImage imageNamed:@"LoginNormal.png"];
        imgHighlighted = [UIImage imageNamed:@"LoginPressed.png"];
    }
    else {
        imgNormal = [UIImage imageNamed:@"LogoutNormal.png"];
        imgHighlighted = [UIImage imageNamed:@"LogoutPressed.png"];
    }

    // Get the screen width to use it to center the login/logout button.
    // We’ll use a temporary image view to get the appopriate width and height.
    float screenWidth = [UIScreen mainScreen].bounds.size.width;    
    tempImage = [[UIImageView alloc] initWithImage:imgNormal];
    [btnLogin setFrame:CGRectMake(screenWidth / 2 - tempImage.frame.size.width / 2, btnLogin.frame.origin.y, tempImage.frame.size.width, tempImage.frame.size.height)];

    // Set the button’s images.
    [btnLogin setBackgroundImage:imgNormal forState:UIControlStateNormal];
    [btnLogin setBackgroundImage:imgHighlighted forState:UIControlStateHighlighted];

    // Release the temporary image view.
    [tempImage  release];
}

-(void)showActivityView{
    // Show an alert with a message without the buttons.
    msgAlert = [[UIAlertView alloc] initWithTitle:@"My test app" message:@"Please wait..." delegate:self cancelButtonTitle:nil otherButtonTitles:nil];
    [msgAlert show];

    // Show the activity view indicator.
    actView = [[UIActivityIndicatorView alloc] initWithFrame:CGRectMake(0.0, 0.0, 40.0, 40.0)];
    [actView setCenter:CGPointMake(160.0, 350.0)];
    [actView setActivityIndicatorViewStyle:UIActivityIndicatorViewStyleGray];
    [self.view addSubview:actView];
    [actView startAnimating];
}

-(void)stopShowingActivity{
    [actView stopAnimating];
    [msgAlert dismissWithClickedButtonIndex:0 animated:YES];
}

-(void)saveAccessTokenKeyInfo{
    // Save the access token key info into the user defaults.
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    [defaults setObject:[facebook accessToken] forKey:@"FBAccessTokenKey"];
    [defaults setObject:[facebook expirationDate] forKey:@"FBExpirationDateKey"];
    [defaults synchronize];
}

#pragma mark - View lifecycle

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.

    // Set the permissions.
    // Without specifying permissions the access to Facebook is imposibble.
    permissions = [[NSArray arrayWithObjects:@"read_stream", @"publish_stream", nil] retain];

    // Set the Facebook object we declared. We’ll use the declared object from the application
    // delegate.
    facebook = [[Facebook alloc] initWithAppId:@"331327710279153" andDelegate:self];

    // Check if there is a stored access token.
    [self checkForPreviouslySavedAccessTokenInfo];

    // Depending on the access token existence set the appropriate image to the login button.
    [self setLoginButtonImage];

    // Specify the lblUser label's message depending on the isConnected value.
    // If the access token not found and the user is not connected then prompt him/her to login.
    if (!isConnected) {
        [lblUser setText:@"Tap on the Login to connect to Facebook"];
    }
    else {
        // Get the user's name from the Facebook account.
        [facebook requestWithGraphPath:@"me" andDelegate:self];

    }

    // Initially hide the publish button.
    [btnPublish setHidden:YES];
}

- (void)viewDidUnload
{
    [self setBtnLogin:nil];
    [self setLblUser:nil];
    [self setBtnPublish:nil];
    [super viewDidUnload];
    // Release any retained subviews of the main view.
    // e.g. self.myOutlet = nil;
}

-(void)request:(FBRequest *)request didReceiveResponse:(NSURLResponse *)response {
    // Keep this just for testing purposes.
    NSLog(@"received response");
}

-(void)request:(FBRequest *)request didLoad:(id)result{
    // With this method we’ll get any Facebook response in the form of an array.
    // In this example the method will be used twice. Once to get the user’s name to
    // when showing the welcome message and next to get the ID of the published post.
    // Inside the result array there the data is stored as a NSDictionary.    
    if ([result isKindOfClass:[NSArray class]]) {
        // The first object in the result is the data dictionary.
        result = [result objectAtIndex:0];
    }

    // Check it the “first_name” is contained into the returned data.
    if ([result objectForKey:@"first_name"]) {
        // If the current result contains the "first_name" key then it's the user's data that have been returned.
        // Change the lblUser label's text.
        [lblUser setText:[NSString stringWithFormat:@"Welcome %@!", [result objectForKey:@"first_name"]]];
        // Show the publish button.
        [btnPublish setHidden:NO];
    }
    else if ([result objectForKey:@"id"]) {
        // Stop showing the activity view.
        [self stopShowingActivity];

        // If the result contains the "id" key then the data have been posted and the id of the published post have been returned.
        UIAlertView *al = [[UIAlertView alloc] initWithTitle:@"My test app" message:@"Your message has been posted on your wall!" delegate:self cancelButtonTitle:nil otherButtonTitles:@"OK", nil];
        [al show];
        [al release];
    }
}

-(void)request:(FBRequest *)request didFailWithError:(NSError *)error{
    NSLog(@"%@", [error localizedDescription]);

    // Stop the activity just in case there is a failure and the activity view is animating.
    if ([actView isAnimating]) {
        [self stopShowingActivity];
    }
}

-(void)fbDidLogin{
    // Save the access token key info.
    [self saveAccessTokenKeyInfo];

    // Get the user's info.
    [facebook requestWithGraphPath:@"me" andDelegate:self];
}

-(void)fbDidNotLogin:(BOOL)cancelled{
    // Keep this for testing purposes.
    //NSLog(@"Did not login");

    UIAlertView *al = [[UIAlertView alloc] initWithTitle:@"My test app" message:@"Login cancelled." delegate:self cancelButtonTitle:nil otherButtonTitles:@"OK", nil];
    [al show];
}

-(void)fbDidLogout{
    // Keep this for testing purposes.
    //NSLog(@"Logged out");

    // Hide the publish button.
    [btnPublish setHidden:YES];
}

- (IBAction)LoginOrLogout {
    // If the user is not connected (logged in) then connect.
    // Otherwise logout.
    if (!isConnected) {
        [facebook authorize:permissions];

        // Change the lblUser label's message.
        [lblUser setText:@"Please wait..."];
    }
    else {
        [facebook logout:self];
        [lblUser setText:@"Tap on the Login to connect to Facebook"];
    }

    isConnected = !isConnected;
    [self setLoginButtonImage];
}

- (IBAction)Publish {
    // Show the activity indicator.
    [self showActivityView];

    // Create the parameters dictionary that will keep the data that will be posted.
    NSMutableDictionary *params = [NSMutableDictionary dictionaryWithObjectsAndKeys:
                                   @"My test app", @"name",
                                   @"http://www.google.com", @"link",
                                   @"FBTestApp app for iPhone!", @"caption",
                                   @"This is a description of my app", @"description",
                                   @"Hello!\n\nThis is a test message\nfrom my test iPhone app!", @"message",              
                                   nil];

    // Publish.
    // This is the most important method that you call. It does the actual job, the message posting.
    [facebook requestWithGraphPath:@"me/feed" andParams:params andHttpMethod:@"POST" andDelegate:self];
}

- (void)viewWillAppear:(BOOL)animated
{

    [super viewWillAppear:animated];
}

- (void)viewDidAppear:(BOOL)animated
{

    [super viewDidAppear:animated];
}

- (void)viewWillDisappear:(BOOL)animated
{
    [super viewWillDisappear:animated];
}

- (void)viewDidDisappear:(BOOL)animated
{
    [super viewDidDisappear:animated];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    // Return YES for supported orientations
    return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
}

- (void)dealloc {
    [btnLogin release];
    [lblUser release];
    [btnPublish release];
    [actView release];
    [facebook release];
    [permissions release];
    [super dealloc];
}

@end 
```

我很困惑如何使这个标签栏控制工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-27T19:43:58.133

我改变了设计

现在登录视图首先显示，然后它继续到具有标签栏控制器的真实应用程序。

问题是 _viewcontroller facebook，当 _viewcontroller 被调用时它没有返回任何东西

```
- (BOOL)application:(UIApplication *)application openURL:(NSURL *)url sourceApplication:(NSString *)sourceApplication annotation:(id)annotation {
    return [[_viewController facebook] handleOpenURL:url];
} 
```

所以我将我的代码（尤其是 _viewcontroller 行）更改为以下代码

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]] autorelease];

    UIViewController * viewController1 = [[[VoteMe alloc] initWithNibName:@"VoteMe" bundle:nil] autorelease];
    UIViewController *viewController2 = [[[PostController alloc] initWithNibName:@"PostController" bundle:nil] autorelease];
    UIViewController *viewController3 = [[[FriendsController alloc] initWithNibName:@"FriendsController" bundle:nil] autorelease];
    UIViewController *viewController4 = [[[Responses alloc] initWithNibName:@"Responses" bundle:nil] autorelease];
    UIViewController *viewController5 = [[[User alloc] initWithNibName:@"User" bundle:nil] autorelease];

    self.rootController = [[[UITabBarController alloc] init] autorelease];
    self.rootController.viewControllers = [NSArray arrayWithObjects:viewController1,viewController2,viewController3,viewController4,viewController5, nil];
    self.window.rootViewController = self.rootController;

    [self.window makeKeyAndVisible];

    loginView=[[ViewController alloc] initWithNibName:@"ViewController" bundle:nil];
    [self.window addSubview:loginView.view];

    return YES;

}

// This method will be used for iOS versions greater than 4.2.
- (BOOL)application:(UIApplication *)application openURL:(NSURL *)url sourceApplication:(NSString *)sourceApplication annotation:(id)annotation {
    return [[loginView facebook] handleOpenURL:url];
} 
```

它工作正常

# java - 使用带有 actionPerformed 的 repaint() 方法

> ID：11129608
> 
> 赞同：5
> 
> 时间：2012-06-20T23:28:34.990
> 
> 标签：java, swing, repaint, graphics2d, japplet

当按下按钮并且 Graphics p 必须从头开始重新绘制所有内容时，如何使用 repaint() 方法？

谢谢。

```
 import javax.swing.Box;
  import javax.swing.JButton;
  import javax.swing.JTextField;
  import java.awt.*;
  import java.awt.event.*;
  import javax.swing.*;

  class fares extends JPanel{

    private static final long serialVersionUID = 1L;
    public static int xaxis1,xaxis2,yaxis3,yaxis4;

public ControlsB(square) {

    final JButton btn1 = new JButton("Resize");

    final Box b = Box.createHorizontalBox();
    b.add(new JLabel("Please enter range:  "));
    Box b0 = Box.createVerticalBox();//create a vertical box to stack the controls

    Box b1 = Box.createHorizontalBox(); // create a horizontal box for the x-axis

    //x-axis
    b1.add(new JLabel("mark "));
    b1.add(new JLabel("for"));

    f1.setMaximumSize(new Dimension(100,30));

    b1.add(f1);
    b1.add(new JLabel("till"));

    f2.setMaximumSize(new Dimension(100,30));
    b1.add(f2);

    //y-axis
    //this code is not in use at the moment

    f4.setMaximumSize(new Dimension(100,30));
    b2.add(f4);

    b0.add(b1);

    add(b);

    btn1.addActionListener(new ActionListener(){

        public void actionPerformed(ActionEvent event){

            f = Integer.parseInt(f1.getText());

            invalidate();
            validate();
            paint(p);//this is not working...
        }
    });
 b.add(btn1);
  }
} 
```

这是必须调用和重新绘制的代码：

```
import java.awt.*;

import javax.swing.*;

class Graph extends JPanel {

public static Graphics p;
private static final long serialVersionUID = 1L;
public static int f;
public static int g;

@Override
public Dimension getPreferredSize()
{   
    return (new Dimension(560,560));
}

public void paintComponent(Graphics p) {

    super.paintComponent(p);

    Graphics2D graph = (Graphics2D)p;

    Dimension appletSize = this.getSize();
    int appletHeight = (int)(appletSize.height);
    int appletWidth = appletSize.width;

    //change -ve num to +ve
    int g3 = Math.abs(g);

    int a1 = g3 + f;
    int b1 = a1;

    int d = (appletWidth / a1);
    int e = (appletHeight / b1);

    //draw y-axis numbers 
    //(+ve)
    while(f != 0){
        String s = String.valueOf(f);

        m = m + b;
        f = f - 1;
    }
    //(-ve)
    m2 = y;
    while(f2 != g-1)
        m2 = m2 + b;
        f2 = f2 - 1;
    }
    //draw x-axis numbers.
    //(-ve)
    while(g != 0){
        String hy = String.valueOf(g);

        n = n + a;
        g = g + 1;
    }
    //(+ve)
    n2 = x + a;
    while(g2 != g3+1){
        String w = String.valueOf(g2);
        n2 = n2 + a;
        g2 = g2 + 1;
    }

    BasicStroke aLine2 = new BasicStroke(1.0F,
                                         BasicStroke.CAP_ROUND,BasicStroke.JOIN_ROUND);
    graph.setStroke(aLine2);

    //notch on numbers and grid lines
    //left to right, top to bottom notches
    int v2 = -5;
    int v5 = 0;
    while(i <= a1-1){
        p.setColor(Color.lightGray);//lightgray line
        a = a + d;
        b = b + e;
        i = i + 1;
    }

  }
} 
```

目前调整大小按钮有效，但我需要调整窗口大小以使图形响应给定的输入。基本上在调整图形大小时正在重新绘制/重新绘制......现在我需要自动完成。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-21T02:18:19.457

根据代码片段很难判断出了什么问题，但似乎您的图形是在名为 graph 的 Graph 对象上绘制的（如果我错了，请纠正我），并且您似乎正在尝试重新绘制（或绘制 - - 永远不要直接调用它！）你的 ControlsB 面板。如果是这样，那么您可能在错误的对象上调用方法。也许您需要执行以下操作：

```
// graph is final so it may be used in an inner class
public ControlsB(Box box2, final Graph graph) {

     // .....

      btn1.addActionListener(new ActionListener(){

        public void actionPerformed(ActionEvent event){

            f = Integer.parseInt(f1.getText());
            g = Integer.parseInt(f2.getText());
            System.out.println(f + "  " + g);

            // invalidate();
            // validate();
            //  paint(p); ***** NEVER do this

            graph.repaint();
        }
    });
} 
```

还：

*   `paint(...)`除非在非常特殊的情况下（不是这样），否则永远不要直接调用组件。
*   永远不要试图抓住一个组件 Graphics 对象并使用它进行绘制，因为这通常会导致 NullPointerException 发生，而且它肯定不会起作用。
*   请阅读标准 Swing 教程中的如何在 Swing 中绘图。你可能会从这样做中学到很多东西。
*   同样，如果您没有很快得到一个像样的答案，请考虑创建并发布一个[sscce](http://sscce.org)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-21T03:51:38.963

![帮助图](../Images/8a9cf7cfb7feb6f77b47efb97d44430a.png)

所做的更改：

## - 在`GraphApplet`课堂内，这两行已更改

```
Box box2 = new Box(BoxLayout.Y_AXIS); // Changed
// Added one more argument, while making Object.
ControlsB b = new ControlsB(box2, graph);//horizontal 
```

*   **在 Graph Class 内部，`setValues(...)`添加了方法。**

-

```
public void setValues(int x, int y)
{
    xstart = x;
    ystart = y;
    repaint();
} 
```

*   **在`Graph`类内部，变量的范围`xstart`已`ystart`更改为`Instance/Class`**

## - 内部 ControlB 类

```
refineButton = new JButton("Refine");
buttonBox.add(refineButton);
refineButton.addActionListener(new ActionListener()
{
    public void actionPerformed(ActionEvent ae)
    {
        int x = Integer.parseInt(f1.getText());
        int y = Integer.parseInt(f3.getText());
        /*
         * Calling a method of Graph Class (setValues)
         * and passing the values that we had got from
         * the respective JTextFields.
         */
        graph.setValues(x, y);          }
    });
} 
```

在这里观看此代码示例，稍微修改您之前的示例，让您了解如何使其工作。看一下附图，只用这三个东西，在尖`JTextField`的 s 中输入一些整数值，然后点击`Refine JButton`，你会看到如何重绘。由于我真的不知道逻辑是如何工作的，因此无法说出如何优化代码，尽管给你一个想法，这里是：

```
import java.awt.*;
import java.awt.event.*;
import java.awt.geom.*;
import javax.swing.*;

public class GraphApplet extends JApplet
{
    private static final long serialVersionUID = 1L;

    public void init(){

        SwingUtilities.invokeLater(new Runnable()
        {
            public void run()
            {
                Container conn = getContentPane();
                conn.setLayout(new BorderLayout());

                Graph graph = new Graph();//graph
                conn.add(graph,BorderLayout.CENTER);

                Box box1 = new Box(BoxLayout.X_AXIS);
                ControlsA a = new ControlsA(box1);//vertical
                conn.add(a,BorderLayout.EAST);

                Box box2 = new Box(BoxLayout.Y_AXIS); // Changed
                // Added one more argument, while making Object.
                ControlsB b = new ControlsB(box2, graph);//horizontal
                conn.add(b,BorderLayout.SOUTH);
            }
        });
    }
}

class Graph extends JPanel {

    private static final long serialVersionUID = 1L;
    private int xstart;
    private int ystart;

    public Graph(){
        this.setBackground(Color.yellow);
    }

    @Override
    public Dimension getPreferredSize()
    {   
        return (new Dimension(460,560));
    }

    /*
     * Added this method, which will call
     * repaint(), everytime it is been
     * called from anywhere. Moreover
     * the variables used inside 
     * paintComponent(...) method xstart
     * and ystart, have been changed to 
     * instance variables of the Graph Class.
     */
    public void setValues(int x, int y)
    {
        xstart = x;
        ystart = y;
        repaint();
    }

    @Override
    public void paintComponent(Graphics p) 
    {

        super.paintComponent(p);

        Graphics2D graph = (Graphics2D)p;

        Dimension appletSize = this.getSize();
        int appletHeight = (int)(appletSize.height);
        int appletWidth = appletSize.width;

        this.setBackground(Color.yellow);//set background color.

        int x,y,y1,x1,a,b,p1x,p1y,p2x,p2y;

        //line co-ordinates
        //the numbers represent the number of boxes on the graph
        // Made these two variables as Instance Variables
        //int xstart = 10;
        //int ystart = 5;

        int xfinish = 2;
        int yfinish = 8;

        //other variables
        int i = 0;
        int i2 = 0;
        int m = 0;
        int n = 0;
        int m2 = 0;
        int n2 = 0;
        int f2 = 0;
        int g2 = 1;

        //ranges
        int f = 5;
        int g = -5;

        //change -ve num to +ve
        int g3 = Math.abs(g);

        int a1 = g3 + f;
        int b1 = a1;

        y1 = (appletHeight);
        x1 = (appletWidth);
        y = (appletHeight / 2);
        x = (appletWidth / 2);
        a = (appletWidth / a1);
        b = (appletHeight / b1);

        int d = (appletWidth / a1);
        int e = (appletHeight / b1);

        /**
        to determine the
        ammount of pixles there
        is in each box of the
        graph, both y-axis and 
        x-axis
        */
        int xbox = x1 / 10;
        int ybox = y1 / 10;

        //line variables
        //the xstart, ystart, etc represent the number of boxes

        //top point of the line on the graph
        p1x = xbox * xstart;//start x
        p1y = ybox * ystart;//start y

        //lowwer point of the line on the graph
        p2x = xbox * xfinish;//finish x
        p2y = ybox * yfinish;//finish y

        //draw y-axis numbers 
        //(+ve)
        while(f != 0){
            String s = String.valueOf(f);
            p.drawString(s,(x + 5),m + 13);
            m = m + b;
            f = f - 1;
        }
        //(-ve)
        m2 = y;
        while(f2 != g-1){
            String u = String.valueOf(f2);
            p.drawString(u,(x + 5),m2 - 3);
            m2 = m2 + b;
            f2 = f2 - 1;
        }
        //draw x-axis numbers.
        //(-ve)
        while(g != 0){
            String t = String.valueOf(g);
            p.drawString(t,n,y - 5);
            n = n + a;
            g = g + 1;
        }
        //(+ve)
        n2 = x + a;
        while(g2 != g3+1){
            String vw = String.valueOf(g2);
            p.drawString(vw,n2 -10,y - 5);
            n2 = n2 + a;
            g2 = g2 + 1;
        }

        BasicStroke aLine2 = new BasicStroke(1.0F,
                 BasicStroke.CAP_ROUND,BasicStroke.JOIN_ROUND);
        graph.setStroke(aLine2);

        //notch on numbers and grid lines
        //left to right, top to bottom notches
        int v2 = -5;
        int v5 = 0;
        while(i <= a1-1){
            p.setColor(Color.lightGray);//lightgray line
            p.drawLine(a,0,a,y1);//vertical lightgray
            p.drawLine(0,b,x1,b);//horizontal lightgray
            a = a + d;
            b = b + e;
            i = i + 1;
        }
        //notches
        while(i2 <= a1){
            p.setColor(Color.blue);//notch color
            p.drawString("x",v2+2,y+3);//xaxis
                p.drawString("x",x-4,v5+4);//yaxis
            v5 = v5 + e;
            v2 = v2 + d;
            i2 = i2 + 1;
        }

        //draws the border of the graph
        p.setColor(Color.black);
        Rectangle2D.Float rect = new Rectangle2D.Float(0,0,x1,y1);
        BasicStroke aLine = new BasicStroke(2.5F, 
                BasicStroke.CAP_ROUND, BasicStroke.JOIN_ROUND);
        graph.setStroke(aLine);
        graph.draw(rect);

        //draw cross
        BasicStroke aLine3 = new BasicStroke(2.5F,
                BasicStroke.CAP_ROUND, BasicStroke.JOIN_ROUND);
        graph.setStroke(aLine3);
        p.drawLine(x,0,x,y1); //vertical line
        p.drawLine(0,y,x1,y); //horizontal line

        //display the value of graph width and graph height
        String aw = String.valueOf(x1);
        p.drawString("Graph Width = ", 50,90);
        p.drawString(aw,150,90);
        p.drawString("Graph Height = ", 50,110);
        String ah = String.valueOf(y1);
        p.drawString(ah,156,110);

        //draw line on graph

        BasicStroke aLine4 = new BasicStroke(1.5F,
            BasicStroke.CAP_ROUND, BasicStroke.JOIN_ROUND);
        graph.setStroke(aLine4);
        p.setColor(Color.red);

        if(p1x <= x1 && p2x <= x1 && p1y <= y1 && p2y <= y1){
            p.drawLine(p1x,p1y,p2x,p2y);
            Color c = new Color(0,0,0);
            p.setColor(c);
            p.drawString("X", p1x-4,p1y+4);
            p.drawString("X", p2x-4,p2y+4);
        }           
        else{
            p.setColor(Color.black);
            p.drawRect(48,34,223,35);
            p.setColor(Color.white);
            p.fillRect(49,35,222,34);
            p.setColor(Color.red);
            p.drawString("Wrong co-ordinates!!!", 50,50);
            p.drawString("Values exceede applet dimensions.", 50,65);
        }
    }
}

class ControlsA extends JPanel
{

    private static final long serialVersionUID = 1L;

    public ControlsA (Box a) 
    {

        a = Box.createVerticalBox();
        a.add(new JLabel("Please enter the values below:"));
        a.add(new JLabel("a"));
        JTextField g1 = new JTextField("0.0");
        g1.setMaximumSize(new Dimension(100,30));
        a.add(g1);
        a.add(new JLabel("b"));
        JTextField g2 = new JTextField("0.0");
        g2.setMaximumSize(new Dimension(100,30));
        a.add(g2);
        a.add(new JLabel("c"));
        JTextField g3 = new JTextField("0.0");
        g3.setMaximumSize(new Dimension(100,30));
        a.add(g3);
        a.add(new JLabel("d"));
        JTextField g4 = new JTextField("0.0");
        g4.setMaximumSize(new Dimension(100,30));
        a.add(g4);
        a.add(new JButton("Plot"));
        a.add(new JButton("Refine"));
        add(a);
    }

    @Override
    public Dimension getPreferredSize()
    {   
        return (new Dimension(200,100));
    }
}

class ControlsB extends JPanel
{

    private static final long serialVersionUID = 1L;
    private Graph graph;
    private JButton refineButton;

    public ControlsB (Box b, Graph g) {

        graph = g;
        b = Box.createVerticalBox();
        Box boxUpper = new Box(BoxLayout.X_AXIS);
        boxUpper.add(new JLabel("Please enter range:  "));
        b.add(boxUpper);
        Box boxX = new Box(BoxLayout.X_AXIS);
        boxX.add(new JLabel(" x-axis "));
        boxX.add(new JLabel("from"));
        // Added final keyword.
        final JTextField f1 = new JTextField("-5");
        f1.setMaximumSize(new Dimension(100,30));
        boxX.add(f1);
        boxX.add(new JLabel(" to "));
        JTextField f2 = new JTextField("5");
        f2.setMaximumSize(new Dimension(100,30));
        boxX.add(f2);
        b.add(boxX);
        //b.add(new JLabel(".   "));
        Box boxY = new Box(BoxLayout.X_AXIS);
        boxY.add(new JLabel("y-axis "));
        boxY.add(new JLabel("from"));
        // Added final keyword.
        final JTextField f3 = new JTextField("5");
        f3.setMaximumSize(new Dimension(100,30));
        boxY.add(f3);
        boxY.add(new JLabel("to"));
        JTextField f4 = new JTextField("-5");
        f4.setMaximumSize(new Dimension(100,30));
        boxY.add(f4);
        b.add(boxY);
        Box buttonBox = new Box(BoxLayout.X_AXIS);
        buttonBox.add(new JButton("Plot"));
        /* 
         * Made this an instance variable,
         * and added ActionListener to it.
         */
        refineButton = new JButton("Refine");
        buttonBox.add(refineButton);
        refineButton.addActionListener(new ActionListener()
        {
            public void actionPerformed(ActionEvent ae)
            {
                int x = Integer.parseInt(f1.getText());
                int y = Integer.parseInt(f3.getText());
                /*
                 * Calling a method of Graph Class (setValues)
                 * and passing the values that we had got from
                 * the respective JTextFields.
                 */
                graph.setValues(x, y);
            }
        });
        b.add(buttonBox);       
        add(b);
    }

    @Override
    public Dimension getPreferredSize()
    {   
        return (new Dimension(200,100));
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-21T02:39:24.237

[恭喜，您刚刚偶然发现了重绘的微妙之处 :) http://www.oracle.com/technetwork/java/painting-140037.html#paint_process](http://www.oracle.com/technetwork/java/painting-140037.html#paint_process)有一个很好的解释。这是摘要：

*   如果您在 JFrame 或 JApplet 等重量级组件上调用 repaint()，它将立即重新绘制。
*   如果您在 JComponent 上调用 repaint()，它将“安排”重绘在未来某个时间点发生，由重绘管理器决定（这意味着，您无法控制它）。

因此，在 JApplet 中调用 repaint() 方法，您应该会在单击按钮后立即看到更改。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-20T23:55:34.857

你试过而不是`paint(p)`使用`p.repaint()`or`p.update(p.getGraphics())`吗？

我已经很久没有做过 Swing 了，我也记不清它的具体表现了。一件确定的事情是，您必须知道何时是调用的好时机`paint`，`update`或者`validate`以及如何正确使用 EventDispatcherThread (EDT)。否则，您的应用程序将看起来像很多 java swing 应用程序：充满 UI 错误的废话......

我不是说 Swing 是垃圾，我是说如果你不知道它是如何工作的，那么你的 UI 就是垃圾。

# jquery - jQuery - 在列表中查找带有虚线边框的 img 元素

> ID：11129610
> 
> 赞同：0
> 
> 时间：2012-06-20T23:28:39.617
> 
> 标签：jquery

我在表格中有一个图像列表，如下所示：

```
<div id="scroll-uploader-photos">
<table>
<tr>
    <td><img class="uploader_thumbs" style="border:solid 3px grey;"></td>
    <td><img class="uploader_thumbs" style="border:solid 3px grey;"></td>
    <td><img class="uploader_thumbs" style="border:solid 3px grey;"></td>
    <td><img class="uploader_thumbs" style="border:solid 3px grey;"></td>
    <td><img class="uploader_thumbs" style="border:dashed 3px red;"></td>
</tr>
</table>
</div> 
```

使用 jQuery 1.7.1，如何选择具有虚线边框的图像元素？

我是否正确地说我需要使用 .find() 或类似方法遍历元素并测试循环中的每个项目的 CSS 属性“border:dashed 3px red”？这是正确的方法还是有更简单的方法？

总是感激地收到帮助和建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T23:33:12.760

好吧，您不需要显式循环 - 使用[.filter](http://api.jquery.com/filter/)：

```
$('table').find('img').filter(function() { 
   return $(this).css('borderStyle') === 'dashed';
}); 
```

这是一个可以玩的[小提琴。](http://jsfiddle.net/qAht3/)

但从技术上讲，它仍然是一个循环，所以你可能是对的。)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T23:33:03.310

您可以遍历图像并检查 css。

```
$(".uploader_thumbs").each(function() {
    if($(this).css('border') == '3px dashed rgb(255, 0, 0)')
        console.log(this)
}) 
```

[演示](http://jsfiddle.net/twMSG/4/)

不过老实说，我会为每个元素应用一个类，而不是内联，然后选择具有该类的项目。[演示](http://jsfiddle.net/twMSG/5/)

# objective-c - 如何将多个值传递给 UIButton 的 @selector()？

> ID：11129611
> 
> 赞同：1
> 
> 时间：2012-06-20T23:28:47.177
> 
> 标签：objective-c, cocoa-touch

换句话说：我有一个带有两个事件的按钮，如何捕获`UIControlEventTouchDown`并`UIControlEventTouchUpInside`在回调函数中`setRedPos`？

```
[btnRedPos addTarget:self action:@selector(setRedPos:) forControlEvents:UIControlEventTouchDown];// I want to pass in a value of 0
[btnRedPos addTarget:self action:@selector(setRedPos:) forControlEvents:UIControlEventTouchUpInside];// I want to pass in a value of 1 
```

...

```
- (void) setRedPos:(UIButton*)btn
{

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T02:04:14.223

您不能通过目标/动作传递任意参数。第一个参数是发送者，第二个（如果你这样设置的话）是事件。您可以使用该事件来判断触发它的事件类型，如下所示：

```
[btnRedPos addTarget:self action:@selector(setRedPos:forEvent:) 
    forControlEvents:UIControlEventTouchDown];
[btnRedPos addTarget:self action:@selector(setRedPos:forEvent:) 
    forControlEvents:UIControlEventTouchUpInside];

- (void) setRedPos:(id)sender forEvent:(UIEvent*)event
{
    UITouch* aTouch = [[event allTouches] anyObject];
    if( aTouch.phase == UITouchPhaseBegan ) {
        NSLog( @"touch began" );
    }
    else if( aTouch.phase == UITouchPhaseEnded ) {
        NSLog( @"touch ended" );
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T23:33:36.030

使用两个单独的选择器。

```
- (void)setRedPosDown:(UIButton *)button {
    [self setRedPos:button state:0];
}
- (void)setRedPosUp:(UIButton *)button {
    [self setRedPos:button state:1];
}

[btnRedPos addTarget:self action:@selector(setRedPosDown:) forControlEvents:UIControlEventTouchDown];
[btnRedPos addTarget:self action:@selector(setRedPosUp:) forControlEvents:UIControlEventTouchUpInside]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T08:35:22.707

我知道在一种方法中实现这一点的唯一两种方法是：1）zpasternack 描述的方法 2）使用两个单独的按钮，一个用于触摸，一个用于触摸并测试发送者。

第一种方法在您的情况下更好，因为它只有一个按钮对象。如果您正在寻找一种方法来实现不同按钮的操作，则第二种方法会很有用。

尽量贴近物理表示。一个按钮，两个不同的动作？该代码只有一个按钮并测试操作。

# knockout.js - 是否可以在淘汰赛中缓存计算出的 observable？

> ID：11129622
> 
> 赞同：0
> 
> 时间：2012-06-20T23:29:49.870
> 
> 标签：knockout.js

我想将计算出的可观察值缓存一段时间（1-2 秒）。是否可以使用扩展器做一些类似的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T23:55:39.343

您可以通过包装它并替换一些函数来创建计算的 observable 对象的自定义版本。

有关该方法的示例，[请参阅本文。](http://www.knockmeout.net/2011/03/guard-your-model-accept-or-cancel-edits.html)它不习惯完全按照您的要求进行，但总体思路应该可行。只需将文章中展示的功能替换为将数据缓存到具有时间戳变量的变量中的东西。

尽管我认为应该注意的是，除非您正在执行非常繁重的计算或其他一些要求很高的任务，否则我认为您无法从缓存值中获得巨大的好处。

# php - PHP 表单验证：正则表达式问题

> ID：11129623
> 
> 赞同：1
> 
> 时间：2012-06-20T23:29:55.700
> 
> 标签：php, validation

我有一个简单的 php 验证表单，它正在工作中。如果您将该字段留空并单击提交，它会显示正确的错误消息。问题在于正则表达式。例如，如果货币字段无效，则不会显示正确的错误消息。单击提交时，它会重新加载页面并删除文本框中的所有值。为什么它不会显示正确的错误信息？

**HTML 表单**

```
<form action="" method="post" id="form">

                <label for="tile">Title: <em>*</em></label>
                <input type="text" name="title" id="title" value="<?php echo $form['title']; ?>"> <?php echo $error['title'] ?>

                <label for="currency">Currency: <em>*</em></label>
                <input type="text" name="currency" id="currency" value="<?php echo $form['currency']; ?>"> <?php echo $error['currency'] ?>

                <input type="submit" name="submit" id="submit">

        </form> 
```

**PHP 验证器**

```
 //variables
    $error_open = "<label class='error'>";
    $error_close = "</label>";
    $valid_form = TRUE;
    $redirect = "success.php";

    $form_elements = array('title', 'currency');
    $required = array('title', 'currency');

    foreach ($required as $require)
    {
        $error[$require] = '';
    }

    if (isset($_POST['submit']))
    {
        //process form

        //get form data
        foreach ($form_elements as $element)
        {
            $form[$element] = htmlspecialchars($_POST[$element]);
        }

        //check form elements
            //check required fields
            if ($form['title'] == '')
            {
                $error['title'] =  $error_open . "* This field is required" . $error_close;
                $valid_form = FALSE;
            }
            if ($form['currency'] == '')
            {
                $error['currency'] = $error_open . "* This field is required" . $error_close;
                $valid_form = FALSE;
            }

            //check formatting
            if ($error['title'] == '' && !preg_match('/^([A-Za-z0-9_-]+)/', $form['title']))
            {

                $error['title'] = $error_open . "* Enter a valid descriptive title" . $error_close;
                $valid_form = FALSE;

            }

            if ($error['currency'] == '' && !preg_match('/^\s*[+-]?(\d*\.\d\d)\s*$/', $form['currency']))
            {

                $error['currency'] = $error_open . " Enter a valid decimal number <br> * Do not include Dollar($) sign <br> * Example: (1.00)" . $error_close;
                $valid_form = FALSE;

            }

        //check for bad data
            if (contains_bad_str($form['title']) ||
            contains_bad_str($form['currency']))
            {
                $valid_form = FALSE;

            }

            if (contains_bad_str($form['title']) ||
            contains_bad_str($form['currency']))
            {
                $valid_form = FALSE;

            }

        //check if form is valid
        if ($valid_form)
        {

            //redirect
            header("Location: " . $redirect);

        }
        else
        {
            include('form.php');

        }

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T23:54:24.820

这对我有用。

```
function contains_bad_str($s) {
    $r = preg_match ( "/cheese|rice|beans/i" , $s);
    return $r;
}

// variables
$error_open = "<label class='error'>";
$error_close = "</label>";
$valid_form = TRUE;
$redirect = "success.php";

$form_elements = array('title', 'currency');
$metadata = array('title'=> array('/^([A-Za-z0-9_-]+)/',
                                  "* Enter a valid descriptive title"),
                  'currency' => array('/^\s*[+-]?(\d*\.\d\d)\s*$/',
                                      "* Enter a valid decimal number <br/>" .
                                      "* Do not include Dollar($) sign <br/>" .
                                      "* Example: (1.00)" ));

foreach ($form_elements as $element) {
    $error[$element] = '';
}

if (isset($_POST['submit'])) {
    // get form data
    foreach ($form_elements as $element) {
        $form[$element] = htmlspecialchars($_POST[$element]);
        // check presence
        if ($form[$element] == '') {
            $error[$element] =  $error_open . "* required" . $error_close;
            $valid_form = FALSE;
        }
        // check formatting
        elseif (!preg_match($metadata[$element][0], $form[$element])) {
            $error[$element] = $error_open . $metadata[$element][1] . $error_close;
            $valid_form = FALSE;
        }
        // sanitize
        elseif (contains_bad_str($form[$element])) {
            $error[$element] =  $error_open . "* bad string" . $error_close;
            $valid_form = FALSE;
        }
    }

    if ($valid_form) {
        header("Location: " . $redirect);
    }
    else {
        include('form.php');
    }
}
else {
    // blank form
    $form = array('title'=>'', 'currency'=>'');
    $error = array('title'=>'', 'currency'=>'');
    include('form.php');
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T00:31:17.910

你看过[PHP 的输入过滤器](http://www.php.net/filter)吗？特别是，看看[`FILTER_VALIDATE_FLOAT`](http://us2.php.net/manual/en/filter.filters.validate.php)货币。

# iphone - NSTimers 和 NSRunLoops 的不稳定行为

> ID：11129632
> 
> 赞同：0
> 
> 时间：2012-06-20T23:30:44.580
> 
> 标签：iphone, objective-c, ios

我正在尝试`UIImageView`使用`CGAffineTransformMakeTranslation()`. 此动画将重复，直到用户执行滑动，在教程中移动用户。所有这些都已经在正常运行，如下所示：

```
[UIView animateWithDuration:1.0 animations:^ {
    self.finger.alpha = 1.0; 
}completion:^(BOOL finished) {
    CGAffineTransform originalTransform = self.finger.transform;
    [UIView animateWithDuration:1.0 delay:0.0 options:UIViewAnimationCurveEaseInOut animations:^ {

        self.finger.transform = CGAffineTransformMakeTranslation(-200, 0);
        self.finger.alpha = 0.0;

        }completion:^(BOOL finished) {

            self.finger.transform = originalTransform;
            NSTimer *timer = [NSTimer timerWithTimeInterval:1.0 target:self selector:@selector(repeatSwipeAnimation1) userInfo:nil repeats:YES];
            self.swipeTimerForFinger1 = timer;
            NSRunLoop *runLoop = [NSRunLoop currentRunLoop];
            [runLoop addTimer:self.swipeTimerForFinger1 forMode:NSDefaultRunLoopMode];
            [self.swipeTimerForFinger1 fire];

            }];

        }]; 
```

和选择器：

```
-(void)repeatSwipeAnimation1 {
    [UIView animateWithDuration:1.0 delay:0.0 options:UIViewAnimationCurveEaseIn animations:^ {
    self.finger.alpha = 1.0;
}completion:^(BOOL finished) {
    CGAffineTransform originalTransform = self.finger.transform;
    [UIView animateWithDuration:1.0 delay:0.0 options:UIViewAnimationCurveEaseInOut animations:^ {
        self.finger.transform = CGAffineTransformMakeTranslation(-200, 0);
        self.finger.alpha = 0.0;
    }completion:^(BOOL finished) {
        self.finger.transform = originalTransform;

    }];
}];
} 
```

手指动画和翻译精美。

当我想用*不同*的手指和*不同*的计时器来做这件事时，问题就来了。我有相同*的确切*代码，但它是不同的手指和不同的计时器选择器。

发生的事情是计时器的选择器*不会*翻译 UIImageView，并且（更可怕的）当我调用该方法无效时，计时器不会无效。调试后，我看到第二个计时器正在调用第二个选择器，但只是没有表现（例如，没有翻译，第二个手指淡入太快）。

我假设我第一次调用 NSRunLoop 时需要以某种方式关闭它？这是第一次使用 NSRunLoop，所以我为我的无知道歉。任何帮助都非常有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T01:15:22.870

好吧，你肯定有一个块保留周期正在进行。您需要使用 __block 或 __weak 说明符。请参阅[块和变量](http://developer.apple.com/library/ios/#documentation/cocoa/Conceptual/Blocks/Articles/bxVariables.html)。您的问题可能与内存问题有关。

确保在完成后使第一个计时器无效。

为了安全起见，您可能还想在尝试转换之前重置 UIImageView 上的转换。你可以这样做：

```
finger.transform = CGAffineTransformIdentity; 
```

# sql-server - SQL-Server 日期时间不可为空，未设置默认值

> ID：11129636
> 
> 赞同：0
> 
> 时间：2012-06-20T23:31:23.863
> 
> 标签：sql-server

如果字段的数据类型是日期时间，并且不允许空值并且没有设置默认值，那么数据库是否输入当前时间戳？我在这里和 MSDN 都进行了查询，但找不到答案。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T23:33:15.043

不可以。您需要为该列提供一个值，除非您为该列指定一个默认值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T23:35:43.000

不，通常会`INSERT`失败。您需要提供默认值，或在`INSERT`语句中包含该列的值。

# css - 跨浏览器的 CSS 定位不一致

> ID：11129638
> 
> 赞同：0
> 
> 时间：2012-06-20T23:31:59.863
> 
> 标签：css, positioning

我在浏览器之间遇到了一些定位不一致的问题。我正在尝试放置一个提交按钮，使其悬停在文本区域的下角。

在 Chrome、Safari 和其他浏览器中，这就像它应该的那样工作：

![铬截图](../Images/1715be7d00e38af5322c00def178ec9f.png)

但是，在 Firefox 中，我得到了这个：

![火狐截图](../Images/e3c990cf380c6b4e1fdaedd474ecf46f.png)

是否有不同的方法来定位该元素，或者我在 CSS 中遗漏了一些东西？

这是 HTMl 和 CSS 的链接：[http ://www.tylonius.com/clients/X10/GalleryDisplay.html](http://www.tylonius.com/clients/X10/GalleryDisplay.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T01:58:22.847

**绝对提交按钮的位置。**

```
position: absolute;
bottom: 0;
right: 0; 
```

确保它的父元素的位置设置为`relative`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T23:45:20.270

我最近一直在处理很多这样的问题，我要做的第一件事就是检查填充、边距和边框。我敢打赌，Firefox 设置的一些默认属性与其他浏览器不同，您需要覆盖它。检查器中的“计算样式”选项卡应该足以确定是否是这种情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T00:23:10.537

我刚刚将该屏幕截图放入 Photoshop 并测量了包含元素的底部填充。在顶部图像中，它`11px`很高。在底部图像中是`13px`。我猜那是你的问题，但如果没有看到你的代码，就不可能肯定地说。尝试查看周围元素的 CSS。我不认为`<input>`元素是你的问题。

**编辑**

现在我可以看到您的代码，我确定这个答案是正确的。问题是周围盒子的长度。您需要做的是从中获取样式`#gallery-commentform`并将其应用于包含表单的 div。然后绝对定位`textarea`adn`submit`相对于左下角。这样，无论浏览器如何呈现高度/填充/yaddayadda，它与表单底部的距离始终相同。

# php - mysql OR 请求只返回前半部分而不是后半部分

> ID：11129640
> 
> 赞同：0
> 
> 时间：2012-06-20T23:32:08.537
> 
> 标签：php, mysql

我很确定以前已经回答过这个问题，但我似乎找不到。

我有一个 mysql 请求，它只返回前半部分的结果，而不是作为数组返回所有结果。

```
sql= "SELECT filename, name, keywords FROM `pics` WHERE (keywords LIKE '%chair%' OR '%jeff%') ORDER BY date ASC";

$rows = $db->fetch_all_array($sql);
foreach($rows as $i => $record){ 
```

因此，如果我要运行上面的代码，我会得到所有条目，`chair`但不是`jeff`......`'%jeff%' OR '%chair%'``jeff``chair`

我确定我错过了所需的东西，`OR`但我无法弄清楚

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T23:37:48.930

`keywords LIKE '%chair%' OR keywords LIKE '%jeff%'`

您需要 OR 整个条件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T23:37:57.467

你应该在 '%jeff%' 之前加上 'keywords LIKE'

因此，“关键字 LIKE '%chair%' 或关键字 LIKE '%jeff%'”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T23:39:07.187

您需要为要查找的每个项目输入列名。因此，在您的示例中，这应该有效：

```
$sql= "SELECT filename, name, keywords 
       FROM `pics` 
       WHERE (`keywords` LIKE '%chair%' OR `keyword`s LIKE '%jeff%') 
       ORDER BY date ASC"; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-20T23:39:59.663

利用：

```
WHERE (keywords LIKE '%chair%' OR keywords LIKE '%jeff%') 
```

# javascript - 有没有办法使用点语法按名称调用方法？

> ID：11129642
> 
> 赞同：1
> 
> 时间：2012-06-20T23:32:38.110
> 
> 标签：javascript

可以使用“点语法”而不使用“eval”（邪恶）来做到这一点吗？（我知道我可以做到`this[methodtocall]()`）

```
 var myObj = {

      method1 : function(){
         return 1;
      },
      method2 : function(){
         return 1;
      },
      callMethod : function(methodtocall){
           this.+methodtocall+()
      },
      init : function(){
          this.callMethod("method1");
      }
   }
   myObj.init(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T23:42:48.333

不，除了`eval`或等效项之外，使用点符号成员运算符是不可能的。

如果要保持语法一致，请始终使用成员运算符的方括号表示法。

```
 callMethod : function(methodtocall){
       this[methodtocall]()
  },
  init : function(){
      this["callMethod"]("method1");
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-20T23:45:57.193

尝试这样做：

```
var myObj = {
  method1 : function(){ return 1; },
  method2 : function(){ return 2; },
  callMethod : function(methodtocall){
       if(typeof methodtocall=== 'function') {
           methodtocall();
       }
  },
  init : function(){ this.callMethod(this.method1); }
}
myObj.init(); 
```

# java - Java，如何在 main 之外创建哈希映射，但在 main 或其他方法中引用它

> ID：11129643
> 
> 赞同：2
> 
> 时间：2012-06-20T23:32:41.453
> 
> 标签：java

> Java，如何在 main 之外创建哈希映射，但在 main 或其他方法中引用它 import java.util.*;

```
import java.util.Map.Entry;

// Create a hash map 

        HashMap<String, Double> hm = new HashMap<String, Double>();

// Put elements into the map

        hm.put("John Doe", new Double(3434.34)); 
        hm.put("Tom Smith", new Double(123.22)); 
        hm.put("Jane Baker", new Double(1378.00)); 
        hm.put("Todd Hall", new Double(99.22)); 
        hm.put("Ralph Smith", new Double(-19.08));

class HashMapDemo 
{ 

    public static void main(String args[])
    { 
        // Get a set of the entries

        Set<Entry< String, Double> > set = hm.entrySet();

        // Get an iterator

        Iterator<Entry< String, Double> > i = set.iterator();

        // Display elements

        while(i.hasNext())
        { 
            Entry< String, Double > me = i.next(); 
            System.out.print( me.getKey() + ": " ); 
            System.out.println( me.getValue() ); 
        }

        System.out.println();

        // Deposit 1000 into John Doe's account

        double balance = hm.get( "John Doe" ).doubleValue(); 
        hm.put( "John Doe", new Double(balance + 1000) ); 
        System.out.println( "John Doe's new balance: " + hm.get("John Doe"));

    } 
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-20T23:35:48.167

问题是您试图从静态主目录访问实例值。要解决此问题，只需将您的 HashMap 设为静态即可。

```
static HashMap<String, Double> hm = new HashMap<String, Double>();

static {
    hm.put("John Doe", new Double(3434.34)); 
    hm.put("Tom Smith", new Double(123.22)); 
    hm.put("Jane Baker", new Double(1378.00)); 
    hm.put("Todd Hall", new Double(99.22)); 
    hm.put("Ralph Smith", new Double(-19.08));
} 
```

现在这条线将可以访问`hm`

```
Set<Entry< String, Double> > set = hm.entrySet(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T00:01:19.270

我同意 Glitch 的观点，但是您也可以创建一个类来设置您的哈希映射，并拥有一个`getHM()`返回它的函数。然后在您的主体中，您只需要创建：

*   该类的对象，例如

    `Test test = new Test();`

*   一个新的 HashMap 并为其分配 getHM() 的值，例如

    `HashMap<String, Double> hm = test.getHM();`

这将是你的班级测试

```
public class Test {
    HashMap<String, Double> hm;

    public Test() {
        hm = new HashMap<String, Double>();
        hm.put("John Doe", new Double(3434.34)); 
        hm.put("Tom Smith", new Double(123.22)); 
        hm.put("Jane Baker", new Double(1378.00)); 
        hm.put("Todd Hall", new Double(99.22)); 
        hm.put("Ralph Smith", new Double(-19.08));
    }

    public HashMap<String, Double> getHM() {
        return hm;
    }
} 
```

我会说解决方案的选择取决于您的要求，但如果这是您唯一的问题，那么 glitch 给出的解决方案可能是最简单/最好的。

使用 static 关键字允许您检索 HashMap 而无需创建任何对象的实例。我相信这在内存使用方面更好（但我不是优化专家......）。

# php - 在 html 文件中插入 php 输出

> ID：11129653
> 
> 赞同：1
> 
> 时间：2012-06-20T23:33:30.407
> 
> 标签：php

我看到一些 html 通过添加 {#name} 来显示 PHP 代码的结果

```
<html>
  <body>
     {#name}
  </body>
</html> 
```

我怎样才能做到这一点？

我一直在环顾四周，找不到任何能告诉我如何做到这一点的东西。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T23:37:24.270

你看到的可能是某种模板系统。如果是这种情况，PHP 脚本会读取模板，然后将 的所有实例替换`{#name}`为变量的内容`$name`。

[Smarty](http://www.smarty.net/crash_course)就是这样一个模板系统的一个例子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T23:35:04.403

```
<?=$name?> 
```

其中 name 是您的 php 变量

# jquery - 移动框 jquery 插件可变宽度

> ID：11129660
> 
> 赞同：0
> 
> 时间：2012-06-20T23:35:02.547
> 
> 标签：jquery, slider

我正在考虑使用[http://css-tricks.com/moving-boxes/](http://css-tricks.com/moving-boxes/) jquery 插件。有人可以告诉我是否可以让它处理可变宽度的面板？

我需要一个图像滑块/轮播，将当前图像居中并显示一半的上一张和下一张图像。移动框很棒，几乎符合要求，只需要仍然滑动到中心的可变宽度图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T01:29:50.337

是的，这是可能的，调整 HTML 中 div .inside 和 .img 的宽度以适应图像的实际大小，并删除 CSS 中将在幻灯片期间重新分配宽度的行。您可以通过在查看演示时检查元素并在浏览器中编辑它们来做到这一点。

编辑 CSS 和 HTML，另外 img 大小和容器大小在 jQuery 中设置，这是在 slider.js 的顶部

```
 var totalPanels         = $(".scrollContainer").children().size();

var regWidth            = $(".panel").css("width");
var regImgWidth         = $(".panel img").css("width");
var regTitleSize        = $(".panel h2").css("font-size");
var regParSize          = $(".panel p").css("font-size");

var movingDistance      = 300;

var curWidth            = 350;
var curImgWidth         = 326;
var curTitleSize        = "20px";
var curParSize          = "15px"; 
```

尝试根据需要删除/编辑这些值

# iphone - 在 UIWebView 中按域名阻止图片

> ID：11129661
> 
> 赞同：3
> 
> 时间：2012-06-20T23:35:02.797
> 
> 标签：iphone, ios, xcode, uiwebview

我想阻止 a`UIWebView`加载特定的图像。问题是，尽管图像发生了变化，但域名保持不变；例如，`adsmarket.com`。

```
<a target="_blank" href="http://network.adsmarket.com/click/imVtnmGcqZWQaWmcX8p8mItoasReyoCYj2JylV_Kf5qMYnLEYaB6lomQbJdknnqV">
    <img width="728" height="90" border="0" src="http://network.adsmarket.com/stc/35021/6471901/ctv.png">
</a> 
```

我希望这被阻止在 中`UIWebView`，不，我不能编辑页面的 HTML。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T00:09:38.940

您应该尝试查看此答案。 [Rob 的建议](https://stackoverflow.com/questions/586930/iphone-sdk-uiwebview-to-stop-images-from-loading-downloading)（以及对其进行扩展的后续答案）实施起来并非易事，而是可行的。

或者，查看[另一个问题的另一个答案](https://stackoverflow.com/a/2602906/119114)。在这篇文章中，yonel 建议实现你自己的`NSURLCache`. 当请求来自 adsmarket.com 的图像之一时，您将从缓存中返回一张图像（可能是虚拟图像......可能是清晰的或 1x1 像素），而不是让请求转到真正的 adsmarket.com 服务器. 缓存的图像只是本地的，捆绑在您的应用程序中，而不是远程图像。

# django - 如何为内置表单自定义 Django 表单验证错误？

> ID：11129663
> 
> 赞同：0
> 
> 时间：2012-06-20T23:35:08.413
> 
> 标签：django, django-forms

我正在利用这些内置的 Django 表单，但遇到了一个小问题。

*   类 AdminPasswordChangeForm
*   类 AuthenticationForm
*   类 PasswordChangeForm
*   类 PasswordResetForm
*   类 SetPasswordForm
*   类 UserChangeForm
*   类 UserCreationForm

例如，`UserCreationForm`生成几个验证错误，我可以使用标签在我的模板中显示，`{{ form.errors }}`甚至是与特定字段相关的标签，例如`{{ form.username.errors }}`.

我知道如何自定义这些错误消息的样式，但是如何自定义文本呢？我已经能够简单地检查条件语句是否存在错误，例如`{% if form.password.errors %}`并将我自己的自定义文本放在该块中。但是，这让我对引发的错误类型视而不见。

例如，我希望能够确定触发的错误是 a`duplicate_username`还是 a `password_mismatch`，以便我可以在模板中编写自己的错误。

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T01:48:43.057

一般来说，您可以自定义 clean 方法，如下所示：

```
class EventDetailsForm(form.ModelForm):
    class Meta:
        model = Event
        fields = ('name',)
        layout = (
                Fieldset('',
                'name',),
                )

    def clean_name(self):
        event_name = self.cleaned_data['name']
        if Event.objects.filter(name=event_name, status='Live').\
                exclude(id=self.instance.id).exists():
            raise forms.ValidationError('This Name is already in use')
        else:
            return event_name 
```

因此，要重用 django 的表单，只需将其子类化，添加额外的验证逻辑并在您的视图函数中调用该表单。

# c++ - 在并行数组上编写随机访问迭代器

> ID：11129667
> 
> 赞同：0
> 
> 时间：2012-06-20T23:35:28.467
> 
> 标签：c++, boost, refactoring, c++11, boost-iterators

**背景**
带有一堆代码的大型应用程序，我无法更改存储机制。

我想在存储在并行数组中的一组多维数据上创建一个迭代器，这样我们就可以开始使用标准算法和容器。

关于如何使其正常工作的任何想法？

```
#include <boost/iterator/iterator_facade.hpp>

#include <iostream>
#include <algorithm>

class curve_point_iterator;

const int curve_size = 10;

class curve
{
public:
  curve()
  {
    std::fill( x, &x[curve_size], 0.0 );
    std::fill( y, &y[curve_size], 0.0 );
  }

  double x[curve_size];
  double y[curve_size];

  curve_point_iterator begin();
  curve_point_iterator end();
};

class point_reference
{
public:
  point_reference( double& x_, double& y_ )
    : x( x_ )
    , y( y_ )
  {
  }

  point_reference& operator = ( point_reference& other )
  {
    x = other.x;
    y = other.y;

    return *this;
  }

  double & x;
  double & y;
};

class curve_point_iterator 
  : public boost::iterator_facade< 
          curve_point_iterator
        , point_reference
        , boost::random_access_traversal_tag >
{
public:
  curve_point_iterator()
    : index(0)
    , curve_(nullptr)
  {}

  explicit curve_point_iterator( curve* curve_in, size_t index_ = 0 )
    : index( index_ )
    , curve_( curve_in )
  {}

private:
  friend class boost::iterator_core_access;

  void increment()
  {
    ++index;
  }

  void decrement()
  {
    --index;
  }

  void advance( size_t n )
  {
    index += n;
  }

  difference_type distance_to( curve_point_iterator const& other ) const
  {
    return other.index - this->index;
  }

  bool equal(curve_point_iterator const& other) const
  {
      return this->index == other.index && this->curve_ == other.curve_;
  }

  point_reference& dereference() const
  {
    auto pt_ref = new( point_reference_buffer ) point_reference(  curve_->x[index]
                                                                , curve_->y[index] );
    return *pt_ref;
  }

  size_t index;
  mutable char point_reference_buffer[sizeof(point_reference)];
  curve* curve_;
};

curve_point_iterator curve::begin()
{
  return curve_point_iterator( this );
}

curve_point_iterator curve::end()
{
  return curve_point_iterator( this, curve_size+1 );
}

int main(int argc, char* argv[])
{
  curve crv;

  crv.x[1] = 20;
  crv.x[2] = 10;

  std::sort( crv.begin(), crv.end(), []( point_reference const& a, point_reference const& b )
  {
    return a.x < b.x;
  });

  for( auto i = 0; i < curve_size; ++i )
  {
    std::cout << crv.x[i] << std::endl;
  }

  return 0;
} 
```

**输出**
0
20
20
20
20
20
20
20
20
20

改成之后

```
class point_reference
{
  ... ( all the other stuff )
  double x; // no longer reference
  double y; // no longer reference
}; 
```

**输出**
0
20
10
0
0
0
0
0
0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T12:01:24.533

好的，您需要做的是在point_reference之外引入一个点类型（具有值语义），它具有您正在寻找的引用语义。您需要值语义，以便交换等操作符合标准的预期。您可以使用第四个参数`iterator_facade`来允许这样做。此外，这种方式不需要使用可变缓冲区，因为 point_reference 本身是按值返回的。

此外，您`curve::end()`使用了错误的索引，应该使用`curve_size`它作为它的索引。

```
#include <boost/iterator/iterator_facade.hpp>

#include <iostream>
#include <algorithm>

class curve_point_iterator;

const int curve_size = 10;

class curve
{
public:
  curve()
  {
    std::fill( x, &x[curve_size], 0.0 );
    std::fill( y, &y[curve_size], 0.0 );
  }

  double x[curve_size];
  double y[curve_size];

  curve_point_iterator begin();
  curve_point_iterator end();
};

class point
{
public:
  point( const double& x_, const double& y_ )
    : x( x_ )
    , y( y_ )
  {
  }

  double x;
  double y;
};

class point_reference
{
public:
  point_reference( double& x_, double& y_ )
    : x( x_ ),
      y( y_ )
  {
  }

  point_reference& operator = ( const point& other )
  {
    x = other.x;
    y = other.y;

    return *this;
  }

  operator point() const
  {
    return point(x, y);
  }

  double & x;
  double & y;

  point_reference& operator=(const point_reference& other)
  {
    x = other.x;
    y = other.y;
  }

  point_reference* operator->()
  {
     return this;
  }

  point_reference* operator->() const
  {
     return this;
  }

};

class curve_point_iterator 
  : public boost::iterator_facade< 
          curve_point_iterator
  , point
  , boost::random_access_traversal_tag
  , point_reference>
{
public:
  curve_point_iterator()
    : index(0)
    , curve_(nullptr)
  {}

  explicit curve_point_iterator( curve* curve_in, size_t index_ = 0 )
    : index( index_ )
    , curve_( curve_in )
  {}

  point_reference operator->() const
  {
     return dereference();
  }

private:
  friend class boost::iterator_core_access;

  void increment()
  {
    ++index;
  }

  void decrement()
  {
    --index;
  }

  void advance( size_t n )
  {
    index += n;
  }

  difference_type distance_to( curve_point_iterator const& other ) const
  {
    return other.index - this->index;
  }

  bool equal(curve_point_iterator const& other) const
  {
    return this->index == other.index && this->curve_ == other.curve_;
  }

  point_reference dereference() const
  {
    //    auto pt_ref = new( point_reference_buffer ) point_reference(  curve_->x[index]
    //                                , curve_->y[index] );
    //    return *pt_ref;
    return point_reference(curve_->x[index], curve_->y[index]);
  }

  size_t index;
  curve* curve_;
};

curve_point_iterator curve::begin()
{
  return curve_point_iterator( this );
}

curve_point_iterator curve::end()
{
  return curve_point_iterator( this, curve_size );
}

int main(int argc, char* argv[])
{
  curve crv;

  crv.x[1] = 20;
  crv.x[2] = 10;

  std::sort( crv.begin(), crv.end(), []( point const& a, point const& b )
         {
           return a.x < b.x;
         });

  for( auto i = 0; i < curve_size; ++i )
    {
      std::cout << crv.x[i] << std::endl;
    }

  return 0;
} 
```

输出：

```
0
0
0
0
0
0
0
0
10
20 
```

# svn - SVN如何处理文件访问模式的变化？

> ID：11129674
> 
> 赞同：1
> 
> 时间：2012-06-20T23:36:15.607
> 
> 标签：svn

SVN如何处理文件访问模式的变化？

例如：

我有一个文件 foo.txt，它的访问模式是 644。现在我把它改成 755 并使用`svn diff`，我什么也没得到。看起来 SVN 认为该文件没有任何变化。那么我该如何为这种情况生成补丁呢？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-03T21:09:32.573

svn 使用属性来维护可执行位。做这个：

```
svn propset svn:executable '*' <file> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-09T12:55:19.193

好吧，它确实关注他们，而不是他们的变化。我刚遇到一个案例，我首先提交了一个模式为 644 的文件。在“chmod 755 ...”之后，svn 没有接受更改。所以我从 svn 中删除了文件，然后用 755 模式重新添加了它。该文件的后续签出正确复制了新模式。因此，删除和重新添加作品。您确实会丢失文件提交历史记录和时间线。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-20T23:40:46.697

SVN 并不真正关注文件权限。在这方面您唯一能做的就是`svn:executable`在文件上设置属性；见[http://svnbook.red-bean.com/en/1.0/ch07s02.html](http://svnbook.red-bean.com/en/1.0/ch07s02.html)。

# javascript - 使用 .find() 定位多个类以将当前类存储为变量

> ID：11129675
> 
> 赞同：0
> 
> 时间：2012-06-20T23:36:28.657
> 
> 标签：javascript, jquery, html

更新：如何找到可能的 4 个类中的 1 个并将该活动类存储到变量中

逻辑上我在想

`var current = $('.footerUl').find('.blue .white .pink .green');`

一次只有一个类会处于活动状态（认为 jquery 会丢弃其余的类），但这不起作用。如何查找 muli-classes 以测试哪个当前处于活动状态并将其存储到变量中以供将来使用。

```
 <footer id="footer">
  <nav>
    <ul class="footerUl">
      <li id="worksFooterNavi" class="navi"><a href="#">works</a></li>
      <li id="aboutFooterNavi" class="navi"><a href="#">about</a></li>
      <li class="homeFooterNavi navi currentFooterNav white"><a href="#" title="logo">
        <div class="logo activeFooter">

        </div>
        </a> ​
      </li>
      <li id="contactFooterNavi"  class="navi"><a href="#">contact</a></li>
      <li id="followFooterNavi"  class="navi"><a href="#">follow</a></li>
    </ul>
  </nav>
</footer>
</div> 
```

这不仅限于`.find()`这只是我做 jquery 的可怕的 hack 和斜线方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T23:44:11.770

我不确定我是否理解你的意思，但这一行的语法不正确

```
var current = $('.footerUl').find('.blue .white .pink .green'); 
```

将其替换为

```
var current = $('.footerUl').find('.blue, .white, .pink, .green'); 
```

而这 2 行将帮助您获得实际的课程

```
regex = /blue|white|pink|green/;
var cssClass = current.prop('class').match(regex); 
```

# ruby - 如何在使用门禁的 oauth 提供商上为我的用户预授权客户端应用程序？

> ID：11129676
> 
> 赞同：15
> 
> 时间：2012-06-20T23:36:30.450
> 
> 标签：ruby, ruby-on-rails-3, oauth-2.0

我编写了一个 oauth 提供程序，旨在与我公司的几个 Web 应用程序一起工作。我正在使用门卫 gem，到目前为止效果很好。

典型的行为是用户访问客户端应用程序，重定向到提供程序以登录，确认客户端应用程序有权访问该用户的信息，然后重定向回客户端应用程序。但是，我想跳过用户确认客户端应用程序的步骤。我想为他们做，所以没有提示。

我试图模仿我[在这里找到](https://github.com/applicake/doorkeeper/blob/master/app/controllers/doorkeeper/authorizations_controller.rb)的代码，例如：

```
Doorkeeper::Application.all.each do |application|
  auth_params = {response_type: 'code', client_id: application.uid, redirect_uri: application.redirect_uri}
  client = Doorkeeper::OAuth::Client.find(application.uid)
  authorization = Doorkeeper::OAuth::AuthorizationRequest.new(client, user, auth_params)
  authorization.authorize
end 
```

但这不起作用，它仍然为用户提供客户端应用程序的授权/拒绝提示。建议？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-07-31T13:45:45.820

OAuth 对此有[资源所有者凭证授予](https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2-30#section-4.4)流程，Doorkeeper 支持该流程。基本上，您使用用户凭据（用户名和密码）请求访问令牌。这样您就可以跳过用户确认，也不需要回调 URL。

要配置门卫：

```
Doorkeeper.configure do
  resource_owner_from_credentials do |routes|
    User.authenticate!(params[:username], params[:password]) # change this if needed
  end
end 
```

令牌请求示例：

```
curl -i https://example.com/oauth/token \
     -F grant_type=password \
     -F client_id=<client_id> \
     -F client_secret=<client_secret> \
     -F username=user@example.com \
     -F password=password 
```

如果您的 OAuth 客户端应用程序是 Rails 应用程序，您可以为此使用[oauth2 gem：](https://github.com/intridea/oauth2/)

```
client = OAuth2::Client.new('client_id', 'client_secret', :site => "https://example.com")
access_token = client.password.get_token('user@example.com', 'password') 
```

另见门卫维基：

[https://github.com/applicake/doorkeeper/wiki/Using-Resource-Owner-Password-Credentials-flow](https://github.com/applicake/doorkeeper/wiki/Using-Resource-Owner-Password-Credentials-flow)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-02-22T17:05:31.780

### Doorkeeper 0.6.7 提供了配置选项来执行此操作。

要配置门卫：

```
Doorkeeper.configure do
  skip_authorization do
    true
  end  
end 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2013-10-08T23:57:47.193

您可以通过添加让您的应用程序对*所有客户端应用程序进行预授权*

```
skip_authorization do
  true
 end 
```

到门卫初始化程序，或者在每个应用程序的基础上通过向`preauthorized`门卫`oauth_applications`表添加一个布尔值。然后在初始化程序中添加类似这样的内容：

```
skip_authorization do |resource_owner, client|
  client.application.preauthorized?
 end 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-22T19:45:27.490

您可以为您的应用程序获取令牌以绕过该确认屏幕，将帖子发送到 /oauth/token。根据您的喜好调整它。

在您的客户端应用程序中：

```
require 'rest-client'
require 'json'

client_id = '4ea1b...'
client_secret = 'a2982...'

response = RestClient.post 'http://localhost:3000/oauth/token', {
  grant_type: 'client_credentials',
  client_id: client_id,
  client_secret: client_secret
}
token = JSON.parse(response)["access_token"] 
```

现在您可以请求访问不需要资源所有者的受保护资源：

```
RestClient.get 'http://localhost:3000/api/v1/profiles.json', { 'Authorization' => "Bearer #{token}" } 
```

来源：[https ://github.com/applicake/doorkeeper/wiki/Client-Credentials-flow](https://github.com/applicake/doorkeeper/wiki/Client-Credentials-flow)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-09-27T17:25:19.140

从您的问题看来，您的公司有很多应用程序，您希望为所有这些应用程序使用一个身份验证平台。

现在，我假设您希望将登录屏幕放在一个地方（大概在身份验证器应用程序上）。如果是这种情况，您将无法为此使用[资源所有者凭据授予](https://github.com/doorkeeper-gem/doorkeeper/wiki/Using-Resource-Owner-Password-Credentials-flow)流程。

最好的方法是有一个值得信赖的客户列表并有条件地跳过授权，如下所示：

```
# config/initializers/doorkeeper.rb

Doorkeeper.configure do
  skip_authorization do |resource_owner, client|
    client.uid == "client application id of the trusted app goes here"
  end
end 
```

如果您想让客户端拥有自己的登录屏幕，资源所有者凭据授予流程就足够了。

# android - 如何将 android 应用程序中的 SQLite 数据实时填充到另一台计算机的 windows 应用程序中？

> ID：11129678
> 
> 赞同：0
> 
> 时间：2012-06-20T23:37:23.080
> 
> 标签：android, sqlite

我正在尝试制作一个与 PC 连接的 android 应用程序。

例如，如果从 android 应用程序打开秒表，它会在 SQLite 数据库上写入测量的时间。测量的时间实时填充到另一台计算机的应用程序中。

你能建议一些方法来做到这一点吗？提前谢谢大家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T23:45:04.080

您应该为此使用服务，存在许多教程来将 JSON 或 XML 服务连接到您的应用程序。该服务有效地调用接收器或侦听器并执行您的意图。从 eclipse 或 mono 和[http://www.android.com/developers/](http://www.android.com/developers/)开始。这里有一个服务连接的例子 [http://www.java2s.com/Open-Source/Android/Music-Sound/simplemusicplayer/com/app/liviu/simpleMusciPlayer/musicPlayer/MusicPlayer.java.htm](http://www.java2s.com/Open-Source/Android/Music-Sound/simplemusicplayer/com/app/liviu/simpleMusciPlayer/musicPlayer/MusicPlayer.java.htm) 你也可以只使用wifi如果该应用程序将在您的专用网络上。

# sql - 总和直到达到值 - Teradata

> ID：11129687
> 
> 赞同：0
> 
> 时间：2012-06-20T23:38:46.157
> 
> 标签：sql, teradata

在 Teradata 中，我需要一个查询来首先确定`MEM TABLE`当前余额为负的所有成员，我们称之为`CUR_BAL`. 然后，仅对于所有这些成员，`TRAN TABLE`按日期对所有交易进行求和，直到这些交易的总和等于`CUR_BAL`。

编辑以添加包含 的第三个`ADJ`表`MEM_NBR`，`ADJ_DT`并且`ADJ_AMT`需要将其包含在运行总计中以捕获所有记录。

我希望结果包括`MEM.MEM_NBR`, `MEM.CUR_BAL`, `TRAN.TRAN_DATE`OR `ADJ.ADJ_DT`（与导致运行总计等于的交易相关的日期`CUR_BAL`）, `MEM.LST_UPD_DT`. 我不需要知道余额是否由于交易或调整而为负，只需知道它变为负数的日期即可。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T03:32:21.900

```
select
    mem_nbr,
    cur_bal,
    tran_date,
    tran_type
from (
    select
        a.mem_nbr,
        a.cur_bal,
        b.tran_date,
        b.tran_type,
        a.lst_upd_dt,
        sum(b.tran_amt) over (partition by b.mem_nbr order by b.tran_date rows between unbounded preceding and current row) as cumulative_bal
    from mem a
    inner join (
        select
            mem_nbr,
            tran_date,
            tran_amt,
            'Tran' as tran_type
        from tran
        union all
        select
            mem_nbr,
            adj_date,
            adj_amt,
            'Adj' as tran_type
        from adj
    ) b
    on a.mem_nbr = b.mem_nbr
    where a.cur_bal < 0
    qualify cumulative_bal < 0
) z
qualify rank() over (partition by mem_nbr order by tran_date) = 1 
```

子查询选取累积余额为负数的所有实例，然后外部查询选取最早的实例。如果您想要最新的，请在最后一行`desc`的 tran_date 之后添加。`qualify`

# css - 将句子的第一个字母大写 CSS

> ID：11129696
> 
> 赞同：63
> 
> 时间：2012-06-20T23:40:10.673
> 
> 标签：css, capitalization

我想将句子的第一个字母大写，如果可能的话，还要将逗号后的第一个字母大写。我想在这里添加代码：

```
.qcont {
    width: 550px;
    height: auto;
    float: right;
    overflow: hidden;
    position: relative;
} 
```

* * *

## 回答 #1

> 赞同：189
> 
> 时间：2012-06-21T11:19:19.813

`.qcont`您可以使用伪元素将元素的第一个字母大写`:first-letter`。

```
.qcont:first-letter{
  text-transform: capitalize
} 
```

这是您将仅使用 css 的最接近的方法。您可以使用 javascript（与 jQuery 结合）将句点（或逗号，如您所愿）之后的每个字母包装在`span`. 您可以将与上面相同的 css 添加到`span`. 或者一起用javascript来做。

这是 css 方法的一个片段：

```
.qcont:first-letter {
  text-transform: capitalize
}
```

```
<p class="qcont">word, another word</p>
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-21T05:27:45.260

这不能在 CSS 中完成。该`text-transform`属性不根据单词在内容中的位置进行区分，并且没有用于选择句子的第一个单词的伪元素。您需要在标记中为每个句子提供真实的元素。但如果你能做到这一点，那么你也可以将内容中的首字母改为大写。

句子开头的大写是正字法的问题，应该在生成内容时完成，而不是使用可选的样式建议 (CSS) 或客户端脚本。识别句子边界的过程远非微不足道，通常不能在没有复杂的句法和语义分析的情况下自动执行（例如，以句点结尾的缩写可能出现在句子内部或句子末尾）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-02-19T12:11:29.280

如果您需要将 contenteditable 容器中的第一个字母大写，则不能使用 css 属性

```
#myContentEditableDiv:first-letter {
    text-transform: capitalize;
} 
```

因为当您尝试自动删除一封信时，您将删除 contenteditable 中包含的所有文本。

请尝试使用 sakhunzai 在[https://stackoverflow.com/a/7242079/6411398](https://stackoverflow.com/a/7242079/6411398) 中提供的示例以获得可行的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T00:19:33.050

`text-transform:capitalize;` ~~将大写句子的第一个字母~~，但如果你也想为逗号做它，你将不得不编写一些 javascript。不过，我同意@BoltClock。为什么你要在逗号后大写？

**编辑：**为了读者：`text-transform:capitalize;`将**大写句子的每个单词**，而不仅仅是第一个单词。您必须将`:first-letter`CSS 选择器与上述内容一起使用。

# objective-c - 无效参数不满足：日期

> ID：11129698
> 
> 赞同：2
> 
> 时间：2012-06-20T23:40:18.803
> 
> 标签：objective-c, nsdate, nsdateformatter

我遇到了来自 Crashlytics 的问题。我有调试参数，所以我看到有什么参数。

```
datePicker = [[UIDatePicker alloc] initWithFrame:CGRectMake(0, 40, 0, 0)];
    NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
    NSString *startTimeString = [MathFunctions minutesToTimeString:[appointment.start_time integerValue]];
    NSLog(@"Time: %@",startTimeString);
    NSLog(@"Date: %@", appointment.date);
    [dateFormatter setDateFormat:@"yyyyMMdd h:mm a"];
    [Crashlytics setObjectValue:[NSString stringWithFormat:@"%@ %@", appointment.date, startTimeString] forKey:@"ResAddDate"];
    NSString *dateTimeString = [NSString stringWithFormat:@"%@ %@", appointment.date, startTimeString];
    NSLog(@"Date String: %@", dateTimeString);
    datePicker.date = [dateFormatter dateFromString:dateTimeString]; 
```

来自 crashlytics 的崩溃日志显示日期格式正确

`RESADDDATE: 20120621 12:00 AM`

崩溃发生在`datePicker.date = [dateFormatter dateFromString:dateTimeString];`

如果日期格式存在且正确，为什么会崩溃？

崩溃分析日志：

```
CoreFoundation  
__exceptionPreprocess + 162
1    libobjc.A.dylib    
objc_exception_throw + 32
2    CoreFoundation 
+[NSException raise:format:]
3    Foundation 
-[NSAssertionHandler handleFailureInMethod:object:file:lineNumber:description:] + 90
4    UIKit  
-[UIDatePickerView _updateBitsForDate:forced:andReload:animateIfNeeded:] + 146
5    UIKit  
-[UIDatePickerView _setDate:animated:forced:] + 348
6    UIKit  
-[UIDatePickerView setDate:animated:] + 30
7    UIKit  
-[UIDatePicker setDate:] + 36
8    MyApp   ReserveAddController.m line 283
-[ReserveAddController showDatePicker] + 283
9    MyApp   ReserveAddController.m line 179
-[ReserveAddController tableView:didSelectRowAtIndexPath:] + 179
10   UIKit  
-[UITableView _selectRowAtIndexPath:animated:scrollPosition:notifyDelegate:] + 944
11   UIKit  
-[UITableView _userSelectRowAtPendingSelectionIndexPath:] + 158
12
Foundation  
__NSFireDelayedPerform + 414
13   CoreFoundation 
__CFRUNLOOP_IS_CALLING_OUT_TO_A_TIMER_CALLBACK_FUNCTION__ + 14
14   CoreFoundation 
__CFRunLoopDoTimer + 364
15   CoreFoundation 
__CFRunLoopRun + 1206
16   CoreFoundation 
CFRunLoopRunSpecific + 300
17   CoreFoundation 
CFRunLoopRunInMode + 104
18   GraphicsServices   
GSEventRunModal + 136
19   UIKit  
UIApplicationMain + 1080
20   Appointment-Plus    main.m line 16
main + 16
21   Appointment-Plus 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-21T21:25:11.123

请注意，您可能会被区域设置“ [feechure](https://stackoverflow.com/q/6613110/581994) ”所吸引。你需要设置你的 NSDateFormatter 的语言环境。

设置具有美国区域设置的电话，然后将 12/24 设置设置为 24。还设置具有欧洲区域设置的电话，然后将 12/24 设置设置为 12。可能其中一个或另一个或两者都会失败。

# multithreading - OpenCV 并行计算描述符？

> ID：11129700
> 
> 赞同：0
> 
> 时间：2012-06-20T23:40:31.533
> 
> 标签：multithreading, opencv, sift, surf

我正在开发一个对象识别系统。我发现我的算法的关键部分是

```
extractor.compute(); 
```

（有`detector.detect()`关键点之后）

有没有办法让计算具有更多核心的特征向量？我最多可以使用8个核心。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T23:45:27.397

Opencv 已经为此实现了多线程框架。检查您是否使用线程选项'ON'编译了opencv。你应该去阅读 opencv 文档，`gpu::SURF_GPU`你可能会感兴趣。

您可以再次运行 cmake 以查看您使用的编译选项。

# jquery - jQuery .append() 和换行符

> ID：11129704
> 
> 赞同：0
> 
> 时间：2012-06-20T23:41:12.360
> 
> 标签：jquery

我正在使用 jQuery`.append()`构建网站的一部分，其中包含从 JSON 字符串中获取的数据。我试图在 2 条单独的行上获取一些内容，但我似乎无法让它工作。

这是我尝试过的：

```
$('<p/>', { text: 'text before break <br /> text after break' }).appendTo(target);
//output: text before break <br /> text after break

$('<p/>', { text: 'text before break \n text after break' }).appendTo(target);
//output: text before break  text after break 
```

有没有办法让`br`标签在其中工作`.append()`？或者我应该先扫描字符串并在`br`标签处切片，以便我可以逐个附加它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T23:47:35.730

您需要使用`html`：

```
$('<p/>', { html: 'text before break <br /> text after break' }).appendTo(target); 
```

jsFiddle 示例：http: [//jsfiddle.net/gJqjT/](http://jsfiddle.net/gJqjT/)

当您使用`text`它时，它基本上会转义字符`<`，`>`因此它最终会输出`&lt;br /&gt;`，但是当您使用`html`它时不会这样做。

希望有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T23:47:44.017

使用`html`而不是`text`- 它允许您在那里使用任何 HTML

# php - Zend_Controller_Router_Route 导致 404 错误

> ID：11129706
> 
> 赞同：0
> 
> 时间：2012-06-20T23:41:43.910
> 
> 标签：php, apache, zend-framework

可能已经很晚了，我已经错过了这个机会。

我正在尝试创建一个更干净的 url 结构；所以而不是拥有

/索引/关于
/索引/新闻

我有

/关于
/新闻

我在这个网站上看到了一个帖子，它使用了以下内容：

```
public function _initCustomRoute()
{
    $router = Zend_Controller_Front::getInstance()->getRouter();
    $route = new Zend_Controller_Router_Route(':action', array(
        'module'     => 'default',
        'controller' => 'index',
        'action'     => 'index'
    ));
    $router->addRoute('default', $route);
} 
```

它重写了我导航中的 url。因此，我创建了相关的操作和视图（在没有自定义路由的情况下进行了测试），但我得到了：

> 未找到
> 在此服务器上未找到请求的 URL /path/to/public/index.php。

我认为这是 apache 通过不添加驱动器号在 Windows 文件系统上所做的事情。

我还没有碰过 .htaccess 文件。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T12:14:07.800

找出原因！您必须使用虚拟主机而不是我使用的别名。

完整指南：http: [//blog.ryantan.net/2010/03/setting-up-wamp-for-zend-framework-projects/](http://blog.ryantan.net/2010/03/setting-up-wamp-for-zend-framework-projects/)

# php - PHP 中的百分号有什么作用？

> ID：11129709
> 
> 赞同：2
> 
> 时间：2012-06-20T23:42:07.617
> 
> 标签：php, sql

除了作为模数运算符之外，百分号在 PHP 中还有什么作用？

例如，我正在查看一些 PHP 代码，并查看以下内容：

```
define('TABLE_PREFIX','%CONFIG-PREFIX'); 
```

在其他地方，在 SQL 文件中，我看到以下内容。我希望 PHP 正在解析 SQL 脚本。

```
DROP TABLE IF EXISTS `%TABLE_PREFIX%api_key`; 
```

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-20T23:43:25.533

PHP 本质上并没有在字符串中对其进行特殊处理。它必须是解析字符串并决定`%`指示某种变量值的应用程序。

事实上，看起来您正在查看一个名为[osTicket](http://www.osticket.com)的项目的源代码。在其安装程序中，我找到了与您给定定义相对应的这一行：

```
$configfile= str_replace('%CONFIG-PREFIX',$_POST['prefix'],$configfile); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-20T23:43:58.743

在 PHP 中，什么都没有。在您使用的任何数据库驱动程序中的某处，驱动程序正在解析该字符串以放入前缀，很可能类似于：

```
$sql = str_replace( '%TABLE_PREFIX%', TABLE_PREFIX, $sql); 
```

# android - 雪碧与圆圈碰撞（Android AndEngine）？

> ID：11129710
> 
> 赞同：0
> 
> 时间：2012-06-20T23:42:12.910
> 
> 标签：android, sprite, andengine, collision, geometry

我有圆形精灵，我需要检查它们是否与任何其他圆圈碰撞。我试过了：

```
public boolean collision(){
    boolean collide=false;

    if(spriteNum>0)
        for(int x=0;x<spriteNum;x++)
            if(yourSprite[spriteNum].collidesWith(yourSprite[x]))
                collide=true;
    return collide;
} 
```

但这会在它周围创建一个矩形，从而将其扔掉。我可以使用距离公式手动计算两个精灵是否接触，但这似乎很费力，每个精灵都附有一个圆形物理体，这意味着中心不断移动（我不知道如何找到中心） . 有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T14:40:58.200

正如 Alexandru 所指出的，到目前为止，AndEngine 不支持圆形碰撞检测。最好的方法是自己实现它。他的解决方案运行良好（快速），但以防万一您需要更高的精度，我将发布另一个近似值：

```
// There is no need to use Sprites, we will use the superclass Entity
boolean collidesWith(Entity circle){
    final float x1 = this.getX();
    final float y1 = this.getY();
    final float x2 = circle.getX();
    final float y2 = circle.getY();
    final float xDifference = x2 - x1;
    final float yDifference = y2 - y1;

    // The ideal would be to provide a radius, but as
    // we assume they are perfect circles, half the
    // width will be just as good
    final float radius1 = this.getWidth()/2;
    final float radius2 = circle.getWidth()/2;

    // Note we are using inverseSqrt but not normal sqrt,
    // please look below to see a fast implementation of it.
    // Using normal sqrt would not need "1.0f/", is more precise
    // but less efficient
    final float euclideanDistance = 1.0f/inverseSqrt(
                                            xDifference*xDifference +
                                            yDifference*yDifference);
    return euclideanDistance < (radius1+radius2);
}

/**
* Gets an aproximation of the inverse square root with float precision.
* @param x float to be square-rooted
* @return an aproximation to sqrt(x)
*/
public static float inverseSqrt(float x) {
    float xhalf = 0.5f*x;
    int i = Float.floatToIntBits(x);
    i = 0x5f3759df - (i>>1);
    x = Float.intBitsToFloat(i);
    x = x*(1.5f - xhalf*x*x);
    return x;
} 
```

注意我不是快速 inverseSqrt 方法的作者，因为它的浮点表示（参见[IEEE 754 浮点表示](http://en.wikipedia.org/wiki/IEEE_754)和[Java 浮点到字节表示](http://docs.oracle.com/javase/6/docs/api/java/lang/Float.html#floatToIntBits%28float%29)），它在 Java（更准确地说是在 Android）中工作。

如需进一步研究，请参阅：

*   [Quake3 快速逆 Sqrt 起源](http://www.beyond3d.com/content/articles/8/)
*   [Java中的快速逆Sqrt实现](https://stackoverflow.com/questions/11513344/how-to-implement-the-fast-inverse-square-root-in-java)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T08:54:48.220

因为Andengine中没有圆碰撞检测，唯一的办法就是计算它们之间的距离

```
boolean collidesWithCircle(Sprite circle) {
    float x1 = this.getX();
    float y1 = this.getY();
    float x2 = circle.getX();
    float y2 = circle.getY();
    double a = x1 - x2;
    double b = y1 - y2;
    double c = (a * a) + (b * b);

    if (c <= this.getWidth()*this.getWidth())
        return true;
    else return false;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-16T16:08:28.950

如果您使用物理世界，则可以使用 PhysicsFactory.createCircularBody() 方法创建圆形物体。

# asp.net-mvc - 如何测试未调用服务方法

> ID：11129711
> 
> 赞同：0
> 
> 时间：2012-06-20T23:42:19.823
> 
> 标签：asp.net-mvc, unit-testing, moq, mstest, data-annotations

我和我的同事正在讨论编写单元测试的正确方法，以确保用户在我们的 ASP.NET MVC 2 应用程序的表单中输入错误数据时收到错误。这是我们过去所做的，从模型开始：

```
public class LoginModel
{
    public string Username { get; set; }
} 
```

这是控制器动作：

```
[HttpPost]
public ActionResult Login( LoginModel loginModel )
{
    if ( loginModel.Username == null )
    {
        ModelState.AddModelError( "Username", "Username is required!" );

        return View( loginModel );
    }

    LoginService.Login( loginModel );
} 
```

最后，这是测试方法：

```
[TestMethod]
public void Login_Post_Blank_Username_Displays_Error()
{
    var controller = GetHomeController();

    var loginModel = new LoginModel
    {
        Username = null
    };

    var result = controller.Login( loginModel );

    Assert.IsInstanceOfType( result, typeof( ViewResult ) );

    var view = (ViewResult)result;

    Assert.IsNotNull( view.ViewData.ModelState["Username"].Errors.First().ErrorMessage );
} 
```

他向我指出，这确实不是针对这种情况编写测试的正确方法。出于一个原因，它非常脆弱 - 将 Username 属性更改为其他任何东西都会破坏测试。其次，最好依靠 DataAnnotations 并针对控制器正在做的事情进行测试。因此，我们的新模型如下所示：

```
public class LoginModel
{
    [Required( ErrorMessage = "Username is required!" )]
    public string Username { get; set; }
} 
```

我们的控制器动作会变成这样：

```
[HttpPost]
public ActionResult Login( LoginModel loginModel )
{
    if ( !Model.IsValid() )
    {
        return View( loginModel );
    }

    LoginService.Login( loginModel );
} 
```

问题来自单元测试，它完全没有注意到 DataAnnotations，因此测试失败。我的同事说，我们真正应该测试的是没有调用 LoginService，但我不确定如何测试。他建议像这样使用起订量：

```
[TestMethod]
public void Login_Post_Blank_Username_Displays_Error()
{
    var controller = GetHomeController();

    var loginModel = new LoginModel
    {
        Username = null
    };

    loginServiceMock.Setup( x => x.Login( It.IsAny<LoginModel>() ) )
        .Callback( () => Assert.Fail( "Should not call LoginService if Username is blank!" ) );

    var result = controller.Login( loginModel );

    loginServiceMock.Verify();
} 
```

您对此有何看法？测试未调用服务方法的正确方法是什么？在用户表单中测试不良数据的正确方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T23:56:45.213

验证时：

```
loginServiceMock.Verify( x => x.Login( It.IsAny<LoginModel>() ), Times.Never() ); 
```

您应该删除模拟中的设置。为了使代码在您的操作中输入 if 语句，您可以在调用控制器中的操作之前在 ModelState 中添加模型错误。

您的代码应如下所示：

```
[TestMethod]
public void Login_Post_Blank_Username_Displays_Error()
{
    var controller = GetHomeController();

    var loginModel = new LoginModel
    {
        Username = null
    };

    controller.ModelState.AddModelError("a key", "a value");

    var result = controller.Login( loginModel );

    loginServiceMock.Verify( x => x.Login( It.IsAny<LoginModel>() ), Times.Never() );
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T05:51:10.670

假设您的 Mocked LoginService 已通过属性注入设置，您可以编写如下测试..

```
 [TestMethod]
    public void LoginPost_WhenUserNameIsNull_VerifyLoginMethodHasNotBeenCalled()
    {
        //Arrange
        var loginServiceMock = new Mock<ILoginService>();
        var sut = new HomeController { LoginService = loginServiceMock .Object};

        var loginModel = new LoginModel {
            Username = null
        };
        sut.ModelState.AddModelError("fakeKey", "fakeValue");

        //Act
        sut.Login(loginModel);

        //Verify
        loginServiceMock.Verify(x => x.Login(loginModel), Times.Never(), "Login method has been called.");
    } 
```

# linux - 如何在 SSH 连接上编辑 root 拥有的文件

> ID：11129712
> 
> 赞同：0
> 
> 时间：2012-06-20T23:42:44.903
> 
> 标签：linux, ssh, file-permissions

嗨，我确定有某种方法可以做我想做的事，但也许我只是以错误的方式攻击它。希望有人可以提供帮助。

我有一个开发盒，我可以从其他几台机器上通过 SSH 连接。为了远程调试，我需要使用客户端机器的 IP 配置调试器，当我从不同的机器登录时，它会发生变化。我厌倦了一直手动执行此操作，所以我想尝试将其自动化。

我正在创建一个在 SSH 连接时自动运行的脚本，它将修改 PHP ini 文件中的配置设置。问题是 PHP ini 文件都归 root 所有，所以如果我只是以普通用户身份登录，我不确定如何修改这些文件。

我的开发盒并没有真正的安全问题，所以我可以更改 ini 文件的所有者，但我希望它比这更自动化。

我当前的尝试是位于我的主目录中的 python 脚本，当我通过 SSH 连接时，它从 .bashrc 调用。我不知道如何从那里获得 root 权限，不过我对 linux 还是很陌生。我想也许会有其他我不知道的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T03:43:00.713

您有一个由 root 拥有的文件。您显然需要找到一种方法将文件标记为您可以修改；或一种让您提升权限的方法，以便您可以修改它。

这导致了两种传统的 Unix 方法来执行此操作。他们是：

1.  创建一个用来标记文件的组，即。初始化调试；chgrp/chmod 文件，使其具有 initdebug 组并且是组可写的；并且，将自己添加到 initdebug 组，以便您可以使用组写入权限来修改文件。

2.  要创建一个非常小的、经过审计的二进制可执行文件（这不适用于脚本），它将执行您想要的特定修改（为简单起见，我建议将选择的 root 拥有的 PHP ini 文件之一复制到正确的位置）。然后 chown'ing 文件，使其归 root 所有，并在可执行文件上设置 suid 位，使其以 root 身份执行。

您还可以结合使用这两种方法：

1.  不要让自己成为可执行文件的 initdebug 组或 suid 的成员，而是将可执行文件的组设置为 initdebug 并设置其 sgid 位；或者，

2.  保留可执行的 suid 根目录，但使其只能由 initdebug 执行，因此只能由添加到该组的用户执行。

如果有人入侵您的帐户，则安全权衡在于特权升级的便利性/风险。如果可执行文件中存在堆栈/堆溢出或类似漏洞并且它以 root 身份执行，那么你就走了。如果可以修改 PHP ini 文件以打开远程漏洞，那么如果他们可以直接访问 ini 文件，那么你就走了。

正如我怀疑后者是可能的，你可能最好使用一个小的可执行文件。

注意：正如我在上面提到的，unix 不承认脚本上的 s[ug]id 位（定义为使用 #!... 解释器语法的任何内容）。因此，您将不得不使用可以编译成二进制文件的东西。所以这可能意味着 C、C++、Java（使用 gcj）、ML、Scheme（mit）、Haskell（ghc）。

如果您之前没有进行过任何 C 或 C++ 编程，我会推荐其中一个，因为 suid 二进制文件不是学习 C/C++ 的项目。如果您不了解任何其他语言，我会推荐 ML 或 Java，因为它们是最容易编写小而简单的东西的。

（顺便说一句，[http](http://en.wikipedia.org/wiki/List_of_compilers) ://en.wikipedia.org/wiki/List_of_compilers包括您可以使用的替代编译器列表。只要确保它编译为本机，而不是字节码。就操作系统而言，字节码 vm 只是另一个口译员）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T03:29:46.347

您可以将您的用户插入到您想要远程的机器上的 sudoers 文件中，例如您可以查看我的博客。这是网址： http: [//nanamo3lyana.blogspot.com/2012/06/give-priviledge-normal-user-as-root.html](http://nanamo3lyana.blogspot.com/2012/06/give-priviledge-normal-user-as-root.html)

然后在您的自动脚本上添加 sudo 您的命令。

对不起，我的英语不好。

# android - android：在循环viewpager中使用时列表框闪烁

> ID：11129718
> 
> 赞同：3
> 
> 时间：2012-06-20T23:43:18.057
> 
> 标签：android, adapter, android-viewpager

我的日历应用程序有这个问题，这是可以理解的，但我不知道如何解决它！

我有一个用作无限寻呼机的视图寻呼机（页数设置为 3，当我向左或向右滑动时，我会移动页面的内容）。我使用 3 个相同的视图（当天事件的视图）。每个视图/天由事件列表视图表示。listview 有一个用于自定义显示事件的适配器。

我在 viewpager 上实现了 onPageScrollStateChanged。向左（前一天）时，当 onPageScrollStateChanged 设置好时，我将数据从中心一天移到右侧，将左侧的数据移到中心并生成前一天的视图设置到左侧，最后我使用 SetCurrentItem 返回中心（允许无限滚动）。我的问题是列表视图的内容闪烁！我清楚地看到我正在从左侧的页面传递到中心的页面，它们是相同的，但中心页面还没有调用 listview 适配器，所以当我将位置强制为一个时，我的印象是列表在第一次加载时重新加载......（因为它由适配器填充）。我该如何解决这个问题？

有些代码可能更容易理解：

## 活动类：

```
DayPagerAdapter dayAdapter;
ViewPager myViewPager;
int focusedPage;

 @Override 
public void onCreate(Bundle savedInstanceState) { 
    super.OnCreate(savedInstanceState);
    setContentView(R.layout.main);

    dayAdapter = new DayAdapter(this);
    myViewPager = (ViewPager) findViewyId(R.id.mypager);
    myViewPager.setAdapter(dayAdapter);

    myViewPager.setOnPageChangeListener(new onPageChangeListener(){
   ....
 @Override
public void onPageScrollStateChanged(int state) { 
if (state == ViewPager.SCROLL_STATE_IDLE) {
if (mFocusedPage == 0) 
{
   View dayBefore = (View) myViewPager.getChildAt(0);
   View dayCurrent = (View) myViewPager.getChildAt(1);
   View dayNext = (View) myViewPager.getChildAt(2);
   View newView = (View) dayAdapter.istantiateItem(myViewPager,0);
  //move data
  ListView lvBef = (ListView) dayBefore.findViewById(R.id.lvDay);
  ListView lCur = (ListView) dayCurrent.findViewById(R.id.lvDay);
  ListView lvNext = (ListView) dayNext.findViewById(R.id.lvDay);
  ListView lvNew = (ListView) newView.findViewById(R.id.lvDay);

  lvNext.setAdapter(lvCur.getAdapter());
  lvCur.setAdapter(lvBef.getAdapter());
  lvBefore.setAdapter(lvNew.getAdapter());

  dayAdapter.notifyDataSetChanged();
}                                    
else if (mFocusedPage == 2)  
{
  ..........
}    
// go back to the center allowing to scroll indefinitely
mDayPager.setCurrentItem(1, false); 
```

## ViewPager 适配器类

```
class DayAdapterextends PagerAdapter  {

ViewPager container;
Context theContext;
LayoutInflater inflater;

public DayAdapter(Context activityContext)
{
theContext = activityContext;
inflater = (LayoutInflater)theContext.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
}

@Override
public void destroyItem(View container, int position, Object object) {
((ViewPager) container).removeViewAt(position);
}

@Override
public void finishUpdate(View container) {

}

@Override
public int getCount() {
return 3;
}

 @Override
public Object instantiateItem(View container, int position) {

    View newview = infater.inflate(R.layout.dayLayout, null);
    ListView lvListViewDay = (ListView) newview.findViewById(R.id.lvDay);
    ArrayList events = getSomeEvents();
    DayEventAdapter dayAdap = new DayEventAdapter(newview.getContext(), events);
    lvListViewDay.setAdapter(adapSat);
    container.addView(newview,position);
    return newview;
}

@Override
public boolean isViewFromObject(View view, Object object) {
 return view == object;
}

@Override
public void restoreState(Parcelable state, ClassLoader loader) {

}   

@Override
public Parcelable saveState() {
  return null;
}

@Override
public void startUpdate(View container) {

} 
```

## ListView 适配器类

```
public class DayEventAdapter extends BaseAdapter 
....
public View getView(int position, View convertView, ViewGroup parent) {

if(convertView == null)
  {
   convertView = layoutInflater.inflate(R.layout.event_cell, null);
  }

  //get the event
  CalendarEvent event = (CalendarEvent) getItem(position);
  if(event != null)
  {
    ((TextView) convertView.findViewById(R.id.tvEventCellEventHour)).setText(event.getEvDate());
    ((TextView) convertView.findViewById (R.id.tvEventCellEventDesc)).setText(event.getEvDesc());
  }
  return convertView;
} 
```

请给我一个帮助，或者如果我的问题不清楚，请不要犹豫！干杯

# mysql - MySQL 合并相关表中的数据并导出为 .csv

> ID：11129719
> 
> 赞同：0
> 
> 时间：2012-06-20T23:43:22.440
> 
> 标签：mysql, csv

我不太了解 MySQL，所以我需要一些帮助来完成这项任务。我希望可以问。

我有一个需要导出的表，我使用以下代码进行了导出：

```
SELECT *
FROM `members`
WHERE `active` =1
AND `level` = 'full'
LIMIT 0 , 30000 
```

这很完美，并为我提供了我需要的大部分内容，包括名为的列中的用户 ID，`id`但我还需要获取每个成员的相关图像并将其添加到我导出的 .csv 中。

图像（文件名）存储在另一个名为的表中，`images`但这仅包含`galleryid`,`filename`和`defaultimg`（注意我只对数据感兴趣`defaultimg = 1`）

`id`这里的问题是此表中没有对成员 ( ) 的引用。

为此，我必须引用一个名为： 的不同表`imagelinks`，其中包含 2 列：

1）`id`这与我`galleryid`的`images`表有关。

和

2)与表`memberid`中的用户 ID相关。`id``members`

我知道这是多么糟糕的设置。

所以..我需要做的并且不能为我的生活工作的是导出一个.csv，其中包含`members`表中的所有用户数据（如我上面的代码中所述），并添加表中的`filename`数据`images`对应于引用的用户（其中`defaultimg = 1`​​ ）。

最后，我还需要在数据前面添加一个 URL `filename`。

例如：表格有`my-image.jpg`，但在导出的 .csv 中我需要它`http://www.domain.com/images/my-image.jpg`

我正在尝试在 PhpMyAdmin 中完成所有这些工作。

对此的任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T23:58:17.127

我的语法可能有点偏离，但这应该很接近......

SELECT members.*, CONCAT('http://www.domain.com/images/', images.filename) AS thefilename FROM members INNER JOIN imagelinks ON members.id=imagelinks.memberid INNER JOIN images ON images.galleryid=imagelinks .id WHERE members.active=1 AND members.level='full' AND images.defaultimg=1

# php - php foreach 提供的参数无效

> ID：11129721
> 
> 赞同：0
> 
> 时间：2012-06-20T23:43:28.683
> 
> 标签：php, javascript, mysql, foreach

我从 mysql 表中获取结果并将每个单元格放入一个数组中，如下所示：

```
$sqlArray = mysql_query("SELECT id,firstName FROM members WHERE id='$id'");
while ($arrayRow = mysql_fetch_array($sqlArray)) {
    $friendArray[] = array(
    'id' => $arrayRow['id'],
    'firstName' => $arrayRow['firstName'],
    );          
} 
```

然后我搜索一个特定的朋友。例如，如果我想搜索一个名叫*Osman*的朋友，我会键入，`o`它会返回以该字母开头的所有结果`o`。这是我的代码：

```
function array_multi_search($array, $index, $pattern, $invert = FALSE) {
    $output = array();
    if (is_array($array)) {
        foreach($array as $i => $arr) {
            // The index must exist and match the pattern
            if (isset($arr[$index]) && (bool) $invert !== (bool) preg_match($pattern, $arr[$index])) {
                $output[$i] = $arr;
            }
        }
    }
    return $output;
}
$filtered = array_multi_search($friendArray, 'firstName', '/^o/i'); 
```

然后它将打印出所有结果。我的问题是它返回了一个错误`"Invalid argument supplied to foreach()"`，这就是我添加`if(is_array))`条件的原因。如果我将此代码留在`index.php`页面中，它工作正常，但我将它移动到一个名为的子文件夹`phpScripts`，它在那里不起作用。有什么帮助吗？

`$output`没有返回任何值，因为显然`$friendArray`不是数组。但我验证了它是通过使用`print_r($friendArray)`它返回所有成员的`id`and `firstName`。

PS我使用JavaScript来调用使用AJAX。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T01:15:17.407

改变这个：

```
foreach($array as $i => $arr) { 
```

对此：

```
foreach((array)$array as $i => $arr) { 
```

你确定那**不是**`$array`空的？

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T00:23:16.853

如果您的数组结构是这样的：

```
$friendArray[] = array(
    'id' => $arrayRow['id'],
    'firstName' => $arrayRow['firstName'],
); 
```

这意味着您的数组被索引和两个级别。

所以正确的走法是：

```
foreach($array as $cur_element) {
    $id = $cur_element['id'];
    $firstName = $cur_element['firstName'];
} 
```**

# android - 当alertdialog被关闭时如何触发UI更新

> ID：11129722
> 
> 赞同：0
> 
> 时间：2012-06-20T23:43:32.297
> 
> 标签：android, android-alertdialog

我有一个由 BroadcastReceiver 发起的 AlertDialog - 所以 AlertDialog 可能出现在我的任何活动之上，而不知道它实际上是哪个活动。

```
private void showAlert(Context context, String s) {
final AlertDialog alertDialog = new AlertDialog.Builder(context)
    .create();
alertDialog.setTitle(context.getString(R.string.SMS_Alert_title));
alertDialog.setMessage(s);
alertDialog.setButton(context.getString(R.string.alert_OK),
    new AlertDialog.OnClickListener() {
        public void onClick(DialogInterface dialog, int which) {
        return; //can't call the underlying activity's ui update method bec I don't know which activity is actually underlying
        }
    });
alertDialog.setIcon(R.drawable.icon);
alertDialog.show();
} 
```

当我现在按下 AlertDialog 上的“确定”按钮将其关闭时，我在基础活动中的所有按钮的按下状态都变为未按下状态。我需要它们保持按下状态只是因为我的按钮在按下状态下显示不同的 png - 我也用它来显示它们在按下时保持“打开”状态。（在这种情况下我不能使用切换按钮）

理想情况下，我只需要更新底层活动的 UI，但`onResume`不会在 AlertDialog 被解除时调用。

此外，当按下 ALertDialog OK 按钮时，我无法调用任何 UI 更新方法，因为我不知道哪个活动实际上在 AlertDialog 下（因为 ALertDialog 可能出现在任何活动之上）

（我希望我能很好地解释这个问题）

ps 虽然我可以将未按下按钮的背景更改为按下的 png，而不仅仅是说`btn.setPressed(true)`我想避免它。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T05:03:19.323

我不太确定你想要达到什么目的。但是请尝试跟随。

有一个名为...的接口说“PressableActivity”？它有一种方法。'按下所有按钮'

在您想要解释功能的所有活动上实现此功能，并实现在调用时按下所有按钮的方法。

在你的上下文中有一个“PressableActivity”类型的变量（或者甚至一个静态类和一个静态变量都可以。）

当调用 onResume 时，将此变量分配给正在显示的活动。

创建对话框时，为其设置一个 onDismissListener，它会调用上下文中静态变量指向的对象的“pressAllButtons”方法。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T02:00:46.653

您需要以一种或另一种方式“知道”在解除 AlertDialog 后正在显示哪个活动。您可以在 Activity 内的 AlertDialog 上设置 onDismissListener，然后做出相应的响应。为什么您希望您的按钮在未按下后保持按下状态，这超出了我的理解，但如果这是您真正想要的，那么只需将状态设置为按下，因为这本质上就是您想要的：即使用户处于强制按下状态没有再次按下它。

# fullcalendar - 2 方式将 Google 日历与 Fullcalendar 同步

> ID：11129723
> 
> 赞同：4
> 
> 时间：2012-06-20T23:43:38.540
> 
> 标签：fullcalendar, google-calendar-api

我已经能够使用 php 和 javascript 以编程方式在我的 Fullcalendar 和我的 Google 日历之间开发 2 路同步。我的完整日历显示来自 Mysql 数据库的事件以及来自 Google 日历的事件。我遇到的问题是，当我的 mysql fullcalendar 事件加载到我的 Google 日历中时，我会在我的 fullcalendar 上看到 mysql 事件 2x ......一个来自 mysql，然后一个来自 Google。我需要继续显示由 mysql 创建的事件并停止显示 google 事件....但只显示源自 mysql 的 google 事件。

本质上，我需要过滤掉源自我的数据库的谷歌日历事件，但显示手动输入谷歌日历的谷歌日历事件。

当我将 mysql 事件发送到 google 时，我当前将返回的 google 日历 ID $gcal_id = $createdEvent->getId() 存储到 mysql 中。我的意图是读取 google api 回调并过滤掉与我存储在 mysql 中的 id 匹配的 gCal$uid。

我无法弄清楚如何访问在 google api 回调中找到的 gCal$uid 值，然后将它们与从数据库中提取的 id 数组进行比较。

任何想法或代码片段将不胜感激。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T19:41:56.830

我从不同的角度解决了这个问题，并且能够解决我的完整日历上出现重复条目​​的问题。当日历加载每个事件时，我将事件 id（减去@google）与我存储在 FullCalendar 的“eventAfterRender”中的数据库中的 gcal id 进行比较。如果我找到匹配项，我会使用 FullCalendar 的“removeEvents”从日历中删除重复的事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-28T15:34:55.137

我的结果不一致。该过程将连续工作几次，然后突然停止工作。尽管由于缺少 PHP 文档而很困难，但我仍在进行故障排除。

无论如何，与从谷歌日历传出相比，从谷歌日历传入 FullCalendar 是轻而易举的事。

对于传入，您需要向用户提供有关如何获取其公共或私有 XML 提要的说明。此处详细介绍了获取公共 XML 的步骤 [http://arshaw.com/fullcalendar/docs/google_calendar/](http://arshaw.com/fullcalendar/docs/google_calendar/)

要获取私有 XML，请不要公开您的日历，然后单击私有部分中的 XML 按钮。

还有一些其他步骤，但它们都在提供的链接中进行了详细说明。

一旦我完成所有工作，我将向谷歌提供关于传出同步的更详细信息

顺便说一句-你为什么不能给我发私信。我的stackoverflow设置有什么需要改变的吗？

# css - 在 CSS 中为边距添加颜色

> ID：11129724
> 
> 赞同：0
> 
> 时间：2012-06-20T23:43:49.523
> 
> 标签：css

我正在使用此代码将固定宽度的图像居中/定位为我的背景。我需要在填充浏览器窗口边缘的图像周围添加颜色。我试过背景颜色，边框颜色......

因此，图像的宽度为 1050px。如果浏览器窗口是 1500 像素，我想让剩余的区域变黑（例如）。我怎样才能做到这一点？

```
#content {
    text-align: left;
    width: 1050px;
    height: 825px;
    margin: 0 auto;
    padding: 0px;
    background-image: url(file:///X|/CarFingers/tabback1_hor.png);
    background-repeat: no-repeat;
} 

body {
    font-family: Helvetica, Arial, sans-serif;
    font-size: 14px;
    color: #333333;
    text-align: center;
} 
```

```
<div id="content">
<body>

</body>
</div> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-20T23:49:34.867

第一：把`div`INSIDE 你的`body`. 然后你可以像这样编辑你的身体背景：

```
body{
    background-color: black;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-20T23:48:02.503

您的 HTML 无效，您不应该有一个`div`包含标签的`body`标签。如果你把 放在`div`里面，`body`你应该可以简单地设置 的背景颜色`body`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T23:56:48.083

```
#content {
    text-align: left;
    width: 1050px;
    height: 825px;
    margin: 0 auto;
    padding: 0px;
    background-image: url('file:///X|/CarFingers/tabback1_hor.png');
    background-repeat: no-repeat;
} 

body {
    font-family: Helvetica, Arial, sans-serif;
    font-size: 14px;
    color: #333333;
    text-align: center;
    background-color: #000;      /* Add this to your code */
} 
```

在您的 html 中，您应该执行以下操作：

```
<body>
   <div id="content">
   </div>
</body> 
```

你永远不应该将 BODY 包含在 DIV 中

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-20T23:54:36.943

如果您想知道如何在 CSS 中为边框着色，那就是

```
border: 10x solid #000; 
```

或者

```
border-width: 10px;
border-color: #000;
border-style: solid; 
```

# iphone - sqlite3_prepare_v2 语句不是 SQLITE_OK 我不知道为什么

> ID：11129727
> 
> 赞同：0
> 
> 时间：2012-06-20T23:43:58.677
> 
> 标签：iphone, objective-c, if-statement, sqlite

我的 viewWillAppear 方法中有这段代码：

```
 sqlite3 *database;
if (sqlite3_open([[self dataFilePath] UTF8String], &database)
    != SQLITE_OK) { 

    sqlite3_close(database);
    NSAssert(0, @"Failed to open database");
}
sqlite3_stmt *statement;

//why is this if statement failing?
if (sqlite3_prepare_v2(database, [sqlStatement UTF8String],
                       -1, &statement, nil) == SQLITE_OK) { 
```

它通过第一个 if 语句而不进入（这很好）。第二个 if 语句是问题所在。

sqlStatement 的形式是 SELECT * FROM food WHERE foodType = 'fruit' 我不明白为什么它没有进入 if 语句。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T17:55:28.233

问题最终不在代码中，而在于我导出 sqlite 文件的方式。这是一个关于 INSERT 语句的系列，而不是一个实际的表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T05:30:32.200

并根据您的要求进行更改...

```
-(void) readDataFromDatabase
{
    chapterAry = [[NSMutableArray alloc] init];

    NSArray *documentPaths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,NSUserDomainMask, YES);

    NSString *documentsDir = [documentPaths objectAtIndex:0];

    databasePath = [documentsDir stringByAppendingPathComponent:@"QuotesApp.sqlite"];

    if(sqlite3_open([databasePath UTF8String], &database) == SQLITE_OK)
    {
        const char *sqlStatement ="select * from MsExcelTutorial";

        sqlite3_stmt *compiledStatement;

        if(sqlite3_prepare_v2(database, sqlStatement, -1, &compiledStatement, NULL) == SQLITE_OK)
        {
            while(sqlite3_step(compiledStatement)==SQLITE_ROW)
            {
                NSNumber *chapterId = [NSNumber numberWithInt:(int)sqlite3_column_int(compiledStatement, 0)];

                NSString *chapter = [NSString stringWithUTF8String:(char *)sqlite3_column_text(compiledStatement, 1)];

                NSString *link = [NSString stringWithUTF8String:(char *)sqlite3_column_text(compiledStatement, 2)];

                NSString *bookmark = [NSString stringWithUTF8String:(char *)sqlite3_column_text(compiledStatement, 3)];

                NSMutableDictionary *dic = [[NSMutableDictionary alloc]initWithObjectsAndKeys:chapterId,@"chapterId",chapter,@"chapter",link,@"link",bookmark,@"bookmark", nil];

                [chapterAry addObject:dic];
            }
        }
        sqlite3_finalize(compiledStatement);
    }
    sqlite3_close(database);
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-21T05:59:15.900

```
NSString *DBPath = [ClsCommonFunctions GetDatabasePath];
if ([self OpenDBWithPath:DBPath])//Method to open database connection
{
//filesDB is database object 
    // Setup the SQL Statement and compile it for faster access
    const char *sqlStatement = "select fileID,filePath from tblFiles where  isUploadPending =1";
    sqlite3_stmt *compiledStatement;
    if(sqlite3_prepare_v2(filesDB, sqlStatement, -1, &compiledStatement, NULL) == SQLITE_OK) {

        while(sqlite3_step(compiledStatement) == SQLITE_ROW) 
        {
            // u Need to get data from database...                

        }
    }
    // Release the compiled statement from memory
    sqlite3_finalize(compiledStatement);
    sqlite3_close(filesDB);
} 
```

通过它它会工作

# ios - 如何检查两个对象（UIButtons）是否相同

> ID：11129729
> 
> 赞同：3
> 
> 时间：2012-06-20T23:44:05.523
> 
> 标签：ios, uitableview, tags, uibutton

首先关闭标签不起作用。我这样说是因为我为特定单元格创建了 4 个按钮，它们都具有相同的标签，即 indexPath.row = 标签。

在我的 TableViewCellForRowAtIndexpath 里面

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{
static NSString *CellIdentifier = @"courseCell";

//Step 1: Check to se if we can reuse a cell from a row that has just rolled off the screen
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

//step 2: If there are no cell to reuse, create a new one
if (cell == nil){
    cell = [[[UITableViewCell alloc]initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier] autorelease];
    cell.selectionStyle = UITableViewCellSelectionStyleGray;
}
...

    //-------------Creation of Custom Buttons-------------// 

    //-----img = "radioOn.png"-----//
    //----img2 = "radioOff.png"----//

    //----RadioButtonA----//
    ...

    radioButtonA = [UIButton buttonWithType:UIButtonTypeCustom];

    [radioButtonA addTarget:self action:@selector(radioButtonClicked:) forControlEvents:UIControlEventTouchUpInside];
    radioButtonA.tag=indexPath.row;

    //----End RadioButtonA----//

    //----RadioButtonB----//

    radioButtonB = [UIButton buttonWithType:UIButtonTypeCustom];
    [radioButtonB addTarget:self action:@selector(radioButtonClicked:)forControlEvents:UIControlEventTouchUpInside];
   radioButtonB.tag =indexPath.row;
...

    //----End RadioButtonB----//

    //----RadioButtonC----//

    radioButtonC = [UIButton buttonWithType:UIButtonTypeCustom];
    [radioButtonC addTarget:self action:@selector(radioButtonClicked:)forControlEvents:UIControlEventTouchUpInside];
    radioButtonC.tag = indexPath.row;
...

    //----End RadioButtonC----//

    //----RadioButtonNA----//

    radioButtonNA = [UIButton buttonWithType:UIButtonTypeCustom];
    radioButtonNA.tag = indexPath.row;
    [radioButtonNA addTarget:self action:@selector(radioButtonClicked:)forControlEvents:UIControlEventTouchUpInside];

    ...

    //----End RadioButtonC----//

    //---------End of Radio Button Creations---------//

    //---------UIStepper & StepperLabel Creation-----//

    [cell.contentView addSubview:radioButtonA];
    [cell.contentView addSubview:radioButtonB];
    [cell.contentView addSubview:radioButtonC];
    [cell.contentView addSubview:radioButtonNA];

//Step4: Return the cell
return cell;
}

#pragma mark - Buttons

- (void)radioButtonClicked:(UIButton *)sender
 {

UIButton *myButton = sender;

// This Method and all the ones similar to this method is created to handle the UITouchUpInsideEvent that the user sends when pressing the radioButtons A-NA.

[radioButtons addObject:sender];

// Create an instance(object) of class NSIndexPath called indexPath and set its value the indexPath of the cell the user is currently in.
UITableViewCell *cell = (UITableViewCell *)[[sender superview] superview];
NSIndexPath *indexPath = [myTableView indexPathForCell:cell];

// Initialize two unique variables in order to check if the buttons being clicked are being referenced in the correct index. 
int row = indexPath.row;
NSLog(@"Button is in row %d", row);

...

}

-(IBAction)button:(UIButton*)sender{
  ...
@try {
    for (i=0; i<8; i++) {

        if ([credits count ] ==0) {
            break; 
        } 
```

这里是我试图访问我在单元格中创建的单选按钮的地方。我想做的是这个

if([credits objectAtIndex:i]) == radioButtonA{

做东西。我不说 == [radioButtonA 标签] 的原因是因为我还有其他三个按钮都具有相同的标签。如果您阅读了代码，您就会明白为什么以这种方式设置标签。}

我要的是1帮助，2是否有另一种方法来检查两个按钮，即对象是否相等，而不必依赖它们的标签。

不要担心 Try catch finally 我用它来捕获抛出的异常。

```
 if ([[[[credits objectAtIndex:i]titleLabel]text] isEqualToString:@"A"])  {
            NSLog(@"radioA is in array");
            creditHours+=[[valueArray objectAtIndex:i]doubleValue];
            gradeEarned+=(GradeA.doubleValue *[[valueArray objectAtIndex:i]doubleValue]);
            NSLog(@"%f",gradeEarned);
            continue;
        }

        if ([[[[credits objectAtIndex:i]titleLabel]text] isEqualToString:@"B"]) {
            NSLog(@"radioB is in array");
            creditHours+=[[valueArray objectAtIndex:i]doubleValue];
            gradeEarned+=(GradeB.doubleValue *[[valueArray objectAtIndex:i]doubleValue]);
            continue;
        }

        if ([[[[credits objectAtIndex:i]titleLabel]text] isEqualToString:@"C"]){
            NSLog(@"radioC is in array");
            creditHours+=[[valueArray objectAtIndex:i]doubleValue];
            gradeEarned+=(GradeC.doubleValue *[[valueArray objectAtIndex:i]doubleValue]);
            continue;
        }

        if([credits objectAtIndex:i]== radioButtonNA){
            NSLog(@"boboboobbobob");
            continue;
        }
    }
}
@catch (NSException *exception) {
    NSLog(@"NSException Caught");
    NSLog(@"Name: %@",exception.name);
    NSLog(@"Reason: %@", exception.reason);
}
@finally {
    NSLog(@"in finally block");
}

//        if ([credits objectAtIndex: i] == defaulter) {
//                        UIAlertView *alert = [[UIAlertView alloc]initWithTitle:@"Failed to select all grades" message:[NSString stringWithFormat:@"Your grade selections have been reset"] delegate:self cancelButtonTitle:@"great"otherButtonTitles:nil];
//                        [alert show];
//                        [alert release];
//            [self refreshArray];
//        }

NSLog(@"%f",gradeEarned);

if (gradeEarned == 0) {
    textLabel.text= [NSString stringWithFormat:@"%f",gradeEarned];
}else {
    NSLog( @"boob");
    sum= (gradeEarned)/(creditHours);
    NSLog(@"%f",sum);
    textLabel.text= [NSString stringWithFormat:@"%f",sum];
    //[self refreshArray];
}

} 
```

更多信息这里是日志...
NSLog(@"%@",[credits objectAtIndex:i]); NSLog(@"%@",radioButtonA);

```
 THE First output is the log of the [credits object atIndex:i] 
```

UIButton：0x6c91430；帧 = (86 110; 32 30); 不透明=否；层=CALayer：0x6c914f0

2012-06-20 20:24:01.568 TableView [12557:f803] UIButton: 0x6ea8ad0; 帧 = (86 110; 32 30); 不透明=否；标签 = 6; 层=CALayer：0x6e746e0

如您所见，UIBUttons 是不同的，因此 == 运算符不起作用

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T00:13:55.267

当检查两个对象时，你不能使用 ==，你必须使用`[objectA isEqual:objectB]`，如果这两个对象相同，则答案将为 YES，否则为 NO

要阅读更多内容，请访问：[https ://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Protocols/NSObject_Protocol/Reference/NSObject.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Protocols/NSObject_Protocol/Reference/NSObject.html)

并检查为 isEqual 写的内容：

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T02:32:22.617

我不确定，在方法中， `- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath;` 你应该只在单元格为 nil 时添加按钮。就像这样

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"courseCell";

    //Step 1: Check to se if we can reuse a cell from a row that has just rolled off the screen
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    //step 2: If there are no cell to reuse, create a new one
    if (cell == nil)
    {
         cell = [[[UITableViewCell alloc]initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier] autorelease];
         cell.selectionStyle = UITableViewCellSelectionStyleGray;
         //-------------Creation of Custom Buttons-------------// 

         //-----img = "radioOn.png"-----//
         //----img2 = "radioOff.png"----//

         //----RadioButtonA----//
          ...

         radioButtonA = [UIButton buttonWithType:UIButtonTypeCustom];

         [radioButtonA addTarget:self action:@selector(radioButtonClicked:) forControlEvents:UIControlEventTouchUpInside];
         radioButtonA.tag=indexPath.row;

         //----End RadioButtonA----//

         //----RadioButtonB----//

         radioButtonB = [UIButton buttonWithType:UIButtonTypeCustom];
         [radioButtonB addTarget:self action:@selector(radioButtonClicked:)forControlEvents:UIControlEventTouchUpInside];
         radioButtonB.tag =indexPath.row;
         ...

//----End RadioButtonB----//

//----RadioButtonC----//

         radioButtonC = [UIButton buttonWithType:UIButtonTypeCustom];
         [radioButtonC addTarget:self action:@selector(radioButtonClicked:)forControlEvents:UIControlEventTouchUpInside];
         radioButtonC.tag = indexPath.row;
         ...

//----End RadioButtonC----//

//----RadioButtonNA----//

           radioButtonNA = [UIButton buttonWithType:UIButtonTypeCustom];
           radioButtonNA.tag = indexPath.row;
         [radioButtonNA addTarget:self action:@selector(radioButtonClicked:)forControlEvents:UIControlEventTouchUpInside];

...

//----End RadioButtonC----//

//---------End of Radio Button Creations---------//

//---------UIStepper & StepperLabel Creation-----//

       [cell.contentView addSubview:radioButtonA];
       [cell.contentView addSubview:radioButtonB];
       [cell.contentView addSubview:radioButtonC];
       [cell.contentView addSubview:radioButtonNA];
 }
     ...

    //Step4: Return the cell
    return cell;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T23:03:54.520

我已经知道这一点，但是，这篇文章的目的是看看他们是否还有其他方式。我还使用了 isMemberOfClass:[UIButton class] 来进一步缩小范围。最好和最有效的方法是使用对象的标签进行比较。

# python - 我可以在使用 Matplotlib 的每个循环期间生成并显示不同的图像吗？

> ID：11129731
> 
> 赞同：6
> 
> 时间：2012-06-20T23:44:20.477
> 
> 标签：python, matlab, matplotlib

我是 Matplotlib 和 Python 的新手。我主要使用Matlab。目前，我正在使用要运行循环的 Python 代码。在每个循环中，我都会做一些数据处理，然后根据处理后的数据显示一个图像。当我进入下一个循环时，我希望关闭之前存储的图像并根据最新数据生成新图像。

换句话说，我想要一个等效于以下 Matlab 代码的 python 代码：

```
x = [1 2 3];

for loop = 1:3

    close all;

    y = loop * x;

    figure(1);

    plot(x,y)

    pause(2)

end 
```

我尝试了以下 python 代码来实现我的目标：

```
import numpy as np
import matplotlib
import matplotlib.lib as plt

from array import array
from time import sleep

if __name__ == '__main__':

    x = [1, 2, 3]

    for loop in range(0,3):

        y = numpy.dot(x,loop)

        plt.plot(x,y)

       plt.waitforbuttonpress

    plt.show() 
```

此代码将所有图叠加在同一个图中。如果我将`plt.show()`命令放在 for 循环中，则只显示第一张图像。因此，我无法在 Python 中复制我的 Matlab 代码。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-21T00:04:10.327

试试这个：

```
import numpy
from matplotlib import pyplot as plt

if __name__ == '__main__':
    x = [1, 2, 3]
    plt.ion() # turn on interactive mode
    for loop in range(0,3):
        y = numpy.dot(x, loop)
        plt.figure()
        plt.plot(x,y)
        plt.show()
        _ = input("Press [enter] to continue.") 
```

如果你想关闭上一个情节，在显示下一个之前：

```
import numpy
from matplotlib import pyplot as plt
if __name__ == '__main__':
    x = [1, 2, 3]
    plt.ion() # turn on interactive mode, non-blocking `show`
    for loop in range(0,3):
        y = numpy.dot(x, loop)
        plt.figure()   # create a new figure
        plt.plot(x,y)  # plot the figure
        plt.show()     # show the figure, non-blocking
        _ = input("Press [enter] to continue.") # wait for input from the user
        plt.close()    # close the figure to show the next one. 
```

`plt.ion()`打开交互模式，使`plt.show`非阻塞。

继承人是您的 matlab 代码的副本：

```
import numpy
import time
from matplotlib import pyplot as plt

if __name__ == '__main__':
    x = [1, 2, 3]
    plt.ion()
    for loop in xrange(1, 4):
        y = numpy.dot(loop, x)
        plt.close()
        plt.figure()
        plt.plot(x,y)
        plt.draw()
        time.sleep(2) 
```

# asp.net - IIS7/ASP.net MVC3 中的权限

> ID：11129734
> 
> 赞同：1
> 
> 时间：2012-06-20T23:44:30.007
> 
> 标签：asp.net, asp.net-mvc-3, iis-7

希望有人能帮忙解决这个问题，我正准备拔掉我剩下的小头发。。

无论如何，我有一个使用 Windows 身份验证运行的 ASP.net WebForms/MVC3 Intranet 站点，但是我有一个用户在尝试查看其中一个 MVC 页面时被提示输入他的用户名/密码。

页面 URL 是`/FM`，它路由到区域 (FM)，并呈现默认路由 ( `/FM/Home/Index`)。如果用户使用 /FM url，即使输入正确，它也会提示输入密码并返回 403，但如果他使用 ( `/FM/Home/Index`) 路径，它会毫无问题地返回页面。

这只是这个用户帐户的问题，我让他在不同的浏览器、不同的机器等上尝试过，没有任何变化。奇怪的是，这只是他的帐户，并且对于具有与他完全相同的 AD 权限的其他用户来说，它工作得很好。

我能够在事件日志中找到的一个错误是：

```
Event code: 4008 
Event message: File authorization failed for the request. 
Event time: 6/18/2012 3:19:33 PM 
Event time (UTC): 6/18/2012 7:19:33 PM 
Event ID: 65994829b06b4aa4a92d71b8e985ec24 
Event sequence: 4217 
Event occurrence: 1 
Event detail code: 0 

Application information: 
    Application domain: /LM/W3SVC/4/ROOT-3-129845173218765349 
    Trust level: Full 
    Application Virtual Path: / 
    Application Path: [Root application path] 
    Machine name: [WebserverName] 

Process information: 
    Process ID: 9776 
    Process name: w3wp.exe 
    Account name: [IIS APPPOOL\WebsiteName]

Request information: 
    Request URL: http://mydomain/FM/ 
    Request path: /FM/ 
    User host address: [User Host Address]
    User: [Domain\Username]
    Is authenticated: True 
    Authentication Type: Negotiate 
    Thread account name: [IIS APPPOOL\WebsiteName] 
```

有人有想法么？

# prism - 条件操作的事件聚合器

> ID：11129736
> 
> 赞同：0
> 
> 时间：2012-06-20T23:44:36.510
> 
> 标签：prism, toast, eventaggregator

我参与了 WPF Prism 应用程序的开发，该应用程序使用事件聚合器发送全局类型消息，然后由 shell 接收。例如，一个视图模型可能希望显示一条 toast 消息，但并不真正关心它是如何显示的。在这种情况下，shell 将被设置为处理这些事件并在应用程序范围内对它们进行操作。

我的问题是，如果一个特定的视图想要以不同的方式显示 toast 消息，你该怎么做。我喜欢全局方法，因为它非常简单，但是如何针对特殊情况进行自定义呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T11:19:39.323

为此目的使用 Eventaggregator 不是我认为的正确方式，因为事件被广播到整个应用程序。

处理这种情况的一种可能方法是您的视图模型可以在构造函数中注入 IMessenger 接口。IMessenger 有一个应用程序实现（默认注入），您可以根据需要自定义 IMessenger 的实现。您的视图模型只是调用一个接口函数（比如 DisplayMessage()），但根据注入它的 Messenger，行为是不同的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T14:50:37.550

我认为这实际上取决于您的应用程序的设置方式以及您使用的标准/模式。在 MVVM 中，我看到了两种方法。

**View-First**
如果您的 View-Model 被注入到您的视图中，则将消息发送到您的视图，并让视图决定如何处理它。如果它想自己显示它们，它可以做到这一点。如果它想将它们发送到您的 shell，它可以通过事件聚合器或注入 Toast 服务接口来实现。这使您的视图可以控制视觉效果。

**View-Model-First**
如果您的 View 被注入到您的 View-Model 中，那么您的 View Model 应该要求一个不同的 View，该 View 应该绑定到它自己的 View Model。如果它想向另一个视图模型发送消息，它可以通过事件聚合器或注入 Toast 视图模型/服务接口来实现。这使您的 View-Model 可以控制视图之间的导航。

我更喜欢 View-First 方法，因为它可以让您的 View 控制模型的可视化。但我对其他 MVVM 开发人员如何解决这个问题非常感兴趣。这似乎与如何在 MVVM View-First 方法中呈现对话框的问题非常一致。

# java - 如何将 java protobuf jar 发布到我的 nexus 存储库？

> ID：11129743
> 
> 赞同：0
> 
> 时间：2012-06-20T23:45:24.627
> 
> 标签：java, protocol-buffers, nexus

在我的构建服务器上，我计划从我的原型规范生成一个 JAR 文件。理想情况下，我想将该 jar 发布到我的 nexus 服务器，以便我的 Java 项目可以像任何其他依赖项一样拉下该依赖项。我应该如何在构建服务器端构建它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T19:39:55.870

您尚未指定您使用的构建工具。

一种选择是使用 Maven 命令行上传文件：

*   [将工件上传到 Nexus，无需 Maven](https://stackoverflow.com/questions/4029532/upload-artifacts-to-nexus-without-maven/4036706#4036706)

第二种选择是使用 Nexus 存储库上传 UI。

（在这两种情况下，都会为您生成 Maven 模块 POM）。

# opencv - OpenCV 2.4 VideoCapture 独立启动时没有来自网络摄像头的输入

> ID：11129750
> 
> 赞同：0
> 
> 时间：2012-06-20T23:46:48.443
> 
> 标签：opencv, webcam

我在我的项目中使用 OpenCV 2.4 来处理来自网络摄像头的图像。在 Visual Studio 2010 中一切正常（发布和调试版本），但是当我尝试直接从资源管理器启动 exes 时，应用程序没有获取输入。然而，相机已启动 - 它的控制 LED 亮起。

有人知道如何让它独立工作吗？

我在这里找到了一些相关的东西： [http ://rafaelbarreto.com/2011/06/05/opencv-2-2-webcam-windows-not-working/](http://rafaelbarreto.com/2011/06/05/opencv-2-2-webcam-windows-not-working/)

在这里： [无法使用 OpenCV 访问网络摄像头](https://stackoverflow.com/questions/4749498/cant-access-webcam-with-opencv/)

我尝试按照这些步骤，使用这些前处理器定义构建 OpenCV 2.4，但它并没有解决我的问题。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T08:47:36.360

解决了。问题是，Visual Studio 从其他地方链接着色器源，而不是在通过 IDE 执行期间。

如果您也遇到同样的情况，请务必检查至少四次（我检查了 3 次）。

# android - 尝试在 iOS 和 Android 的 PhoneGap 中使用 SVG/Canvas/Flash

> ID：11129751
> 
> 赞同：0
> 
> 时间：2012-06-20T23:47:03.357
> 
> 标签：android, iphone, ios, html, cordova

我在 PhoneGap 中启动了应用程序（首先用于 Android，然后我将制作 iPhone 应用程序）。我不确定这个问题用什么更好。我需要在两个点之间绘制对角线的动画。我不确定我是否可以为此使用 SVG，或者 Flash，或者 Canvas。你能给我一些建议吗？非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-18T10:39:23.657

我在 Android 上使用了 Flash，在 iOS 上使用了内置核心动画。

# c# - 向 customBinding 添加传输安全性

> ID：11129752
> 
> 赞同：0
> 
> 时间：2012-06-20T23:47:19.710
> 
> 标签：c#, wcf

我有一个自定义绑定，我在 CreateBindingElemens 方法中添加各种绑定。如果我有 HttpTransportBindingElement，一切都很好，但下一步我想向它添加传输安全性 (ssl)，所以我修改了这样的代码

```
 BindingElementCollection collection = new BindingElementCollection();
        collection.Add(httpPollingElement);
        if (session == SessionType.HttpSession)
        {
            collection.Add(httpSessionElement);
        }
        else
        {
            collection.Add(reliableSessionElement);
        }

        collection.Add(encodingElement);

        var securityBindingElement = new TransportSecurityBindingElement();
        collection.Add(securityBindingElement);
        collection.Add(httpTransportElement);
        return collection; 
```

但我收到一条错误消息，说*绑定“System.ServiceModel.Channels.CustomBinding”的安全功能与生成的运行时对象的安全功能不匹配。这很可能意味着绑定包含 StreamSecurityBindingElement，但缺少支持 Stream Security（例如 TCP 或命名管道）的 TransportBindingElement。删除未使用的 StreamSecurityBindingElement 或使用支持此元素的传输。*

我可以确认我的配置中没有 StramSecurityBindingElement。为了使这项工作，我应该添加哪些安全绑定？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T13:00:02.400

要使用 ssl，只需添加：

```
new HttpsTransportBindingElement() 
```

而不是 http 元素。仅使用传输安全时无需添加安全元素。

# asp.net-mvc - 如何将动态对象列表绑定到模型

> ID：11129755
> 
> 赞同：0
> 
> 时间：2012-06-20T23:47:53.903
> 
> 标签：asp.net-mvc, data-binding

我有一个强类型视图，其中传入的模型属性之一是对象列表。我正在使用工作正常的 BeginCollectionItem 助手处理输入到此列表的动态绑定。但是，我还希望最初在视图上显示一组输入，这些输入将绑定到列表中的“第一个”对象。

我试过只复制 BeginCollectionItem 生成的输入，但这似乎不起作用。

它生成具有名称属性的输入，例如

```
invoiceItems[ef43a8f2-c6b7-4791-bf7f-6764c8e3fc9b].Description
invoiceItems[ef43a8f2-c6b7-4791-bf7f-6764c8e3fc9b].Cost 
```

所以我手动将 2 个输入放在具有名称属性的视图上

```
invoiceItems[firstOne].Description 
invoiceItems[firstOne].Cost 
```

但是在提交表单后它没有出现在控制器上的模型中。

我不能只在视图加载时插入一个 BeginCollectionItem 方式，因为必须以不同方式显示初始项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T03:08:06.643

不完全回答你的**问题**，但我希望它能解决你的**问题**。

您可以尝试更改模型，而不是更改视图中的名称。添加一个`boolean`属性`IsFirst`。我相信您知道`controller`（或实例化模型的任何地方）哪个是第一个。将第一项设置`IsFirst`为 true。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T16:38:22.377

我想到了。我在手动输入 BeginCollectionItem 所做的事情时走在了正确的轨道上，我只是错过了一部分。您需要另一个隐藏输入来告诉绑定您正在使用的索引是什么。

所以以下工作完美

```
<input type="hidden" name="invoiceItems.index" autocomplete="off" value="firstOne" />
<input type="text" placeholder = "ex. Labour" id="invoiceItems_firstOne__Description" name="invoiceItems[firstOne].Description" />
<input type="text" placeholder = "ex. $15" id="invoiceItems_firstOne__Cost" name="invoiceItems[firstOne].Cost" /> 
```

我刚刚将顶部隐藏的输入添加到我之前拥有的内容中，一切都很好。

# c# - 无法从 Azure 获取队列长度/消息计数

> ID：11129761
> 
> 赞同：14
> 
> 时间：2012-06-20T23:49:02.597
> 
> 标签：c#, azure, azure-storage, azure-queues

我有一个用例，当当前队列长度低于指定值时，我需要将选定数量的消息排队。由于我在 Azure 中运行，我正在尝试使用该`RetrieveApproximateMessageCount()`方法来获取当前消息计数。每次我打电话给这个我都会得到一个例外说明`StorageClientException: The specified queue does not exist.`。这是对我所做工作的回顾：

1.  在门户中创建了队列并已成功将消息排队。

2.  在门户中创建了存储帐户，它处于已创建/在线状态

3.  将查询编码如下（*使用 http 和 https 选项*）：

    ```
    var storageAccount = new CloudStorageAccount(
            new StorageCredentialsAccountAndKey(_messagingConfiguration.StorageName.ToLower(),
            _messagingConfiguration.StorageKey), false);

    var queueClient = storageAccount.CreateCloudQueueClient();
    var queue = queueClient.GetQueueReference(queueName.ToLower());
    int messageCount;

    try
    {
        messageCount = queue.RetrieveApproximateMessageCount();
    }
    catch (Exception)
    {
        //Booom!!!!! in every case
    }

    // ApproximateMessageCount is always null

    messageCount = queue.ApproximateMessageCount == null ? 0 : queue.ApproximateMessageCount.Value; 
    ```

4.  我已经确认名称的大小写正确，没有特殊字符、数字或空格，并且生成的`queue`Url 看起来好像它是根据 API 文档正确形成的（*例如[http://myaccount.queue.core.windows.net/myqueue](http://myaccount.queue.core.windows.net/myqueue)* )

任何人都可以帮助阐明我做错了什么。

* * *

**编辑**

我已经确认使用`MessageFactory`我可以成功创建一个`QueueClient`然后入队/出队消息。当我使用`CloudStorageAccount`队列时，队列永远不会出现，因此计数和 GetMessage 例程永远不会起作用。我猜这些不是一回事？？？假设我是对的，我需要测量服务总线队列的长度。那可能吗？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2014-04-25T07:37:49.180

`RetrieveApproximateMessageCount()`已弃用

如果你想使用 ApproximateMessageCount 来获得结果试试这个

```
CloudQueue q = queueClient.GetQueueReference(QUEUE_NAME);
q.FetchAttributes();
qCnt = q.ApproximateMessageCount; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2020-12-03T06:32:26.233

CloudQueue 方法已被弃用（连同 v11 SDK）。

以下代码段是当前替换（来自[Azure Docs](https://docs.microsoft.com/en-us/azure/storage/queues/storage-dotnet-how-to-use-queues?tabs=dotnet#get-the-queue-length)）

```
//-----------------------------------------------------
// Get the approximate number of messages in the queue
//-----------------------------------------------------
public void GetQueueLength(string queueName)
{
    // Get the connection string from app settings
    string connectionString = ConfigurationManager.AppSettings["StorageConnectionString"];

    // Instantiate a QueueClient which will be used to manipulate the queue
    QueueClient queueClient = new QueueClient(connectionString, queueName);

    if (queueClient.Exists())
    {
        QueueProperties properties = queueClient.GetProperties();

        // Retrieve the cached approximate message count.
        int cachedMessagesCount = properties.ApproximateMessagesCount;

        // Display number of messages.
        Console.WriteLine($"Number of messages in queue: {cachedMessagesCount}");
    }
} 
```

[https://docs.microsoft.com/en-us/azure/storage/queues/storage-dotnet-how-to-use-queues?tabs=dotnet#get-the-queue-length](https://docs.microsoft.com/en-us/azure/storage/queues/storage-dotnet-how-to-use-queues?tabs=dotnet#get-the-queue-length)

# vb.net - 如何在 GridView 中实现 Rowspan（适用于 .NET 3.5）

> ID：11129762
> 
> 赞同：1
> 
> 时间：2012-06-20T23:49:08.317
> 
> 标签：vb.net, gridview, dataview, sorted, html-table

我创建了一个自定义`GridView`（实际上是 a `RadGrid`），它大致执行以下操作。

1.  初始化 GridView 格式
2.  设置列（取决于要显示的数据类型）
3.  填充行

实例化 this`GridView`并将其添加到我的页面时，我希望第一列在第一行重复但相似的数据上包含“rowspan”属性。“rowspan”值应该等于它后面的相似行数。通过这种方式，我希望使最终视图更清晰。

我认为，这个逻辑应该在填充行时发生。最初我将行添加到 a`DataTable`然后将其绑定到`GridView`作为最后一步。

这是我尝试的一般逻辑，但它对我不起作用。我究竟做错了什么？

```
Dim dt As New DataTable() 'Has three default columns
For Each d In Documents 'MAIN ITEM (First Column Data)
    Dim rowspan As Integer
    rowspan = 0
    For Each f In Files
        If rowspan = 0 Then
            Me.dt.Rows.Add(New Object() {d.Title, f.Language, f.FileSize})
            'THIS DOESN'T WORK!
            Me.dt.Columns(0).ExtendedProperties.Item("rowspan") = rowspan.ToString()
        Else
            Me.dt.Rows.Add(New Object() {Nothing, f.Language, f.FileSize})
        End If
        rowspan += 1
    Next
Next 
```

还要记住，这被转储到`DataView`按第一列排序的 a 中，所以我想它实际上必须先排序，然后以某种方式计算每个“like”第一列的行数，然后设置“rowspan”值该列的第一行等于属于它的行数。

这有意义吗？这是我想在布局中完成的[理想示例：](http://www.htmlcssdeveloper.com/tutorial/html/html-table/rowspan-attribute-for-td-and-th.html)

![在此处输入图像描述](../Images/8bca91bfbe0cc0096030215ddb9603fa.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-01T15:18:44.333

试试这个。

```
Protected Sub DemoGrid_PreRender(sender As Object, e As System.EventArgs) Handles DemoGrid.PreRender
    MergeRowsWithSameContent(sender)
End Sub

Public Sub MergeRowsWithSameContent(gvw As GridView)
    For rowIndex As Integer = gvw.Rows.Count - 2 To 0 Step -1
        Dim row As GridViewRow = gvw.Rows(rowIndex)
        Dim previousRow As GridViewRow = gvw.Rows(rowIndex + 1)

        For i As Integer = 0 To row.Cells.Count - 1
            If row.Cells(i).Text = previousRow.Cells(i).Text Then
                row.Cells(i).RowSpan = If(previousRow.Cells(i).RowSpan < 2, 2, previousRow.Cells(i).RowSpan + 1)
                previousRow.Cells(i).Visible = False
            End If
        Next
    Next
End Sub 
```

PS：我多年来一直使用的[这个精彩代码](http://marss.co.ua/MergingCellsInGridView.aspx)的无耻端口。

# matlab - 使用颜色图命令时会打开一个新窗口

> ID：11129764
> 
> 赞同：1
> 
> 时间：2012-06-20T23:49:27.493
> 
> 标签：matlab, colors, matlab-figure

当我将 MatLab 环境中的颜色图更改为带有线条的灰度时

```
colormap gray(256); 
```

一个新的空白窗口打开。行尾的分号没有区别。
我怎样才能避免这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-20T23:58:30.033

`colormap`适用于图形。如果不指定图形，则默认使用当前图形。如果没有当前图形，则创建一个（这与许多命令的行为相同，例如`xlim`）。

# asp.net - Active Directory Web 服务和 AutoCompleteExtender

> ID：11129769
> 
> 赞同：0
> 
> 时间：2012-06-20T23:50:39.317
> 
> 标签：asp.net, active-directory, ajaxcontroltoolkit

这是我第一次使用 Active Directory 以及 Ajax Control Toolkit。我想要做的是当用户开始在文本框中输入他们的名字时，它会尝试自动完成他们在 AD 中列出的名字。我在使用 AutoCompleteExtender 时可以找到的每个示例，它都引用了 ServicePath 中的一个 ASMX 文件。

我已经设法弄清楚如何将我们的 AD Web 服务作为服务引用添加到我的项目中。谁能提供有关如何让 AutoCompleteExtender 识别和使用我的 AD 服务参考的任何指导或示例？甚至可能吗？

感谢您提供任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T17:13:04.150

经过我们系统管理员的大量研究和帮助以获取正确的 LDAP 路径，我终于得到了这个工作。我正在发布代码，以便其他人可以从中受益。（请注意，我首先为 .NET 4.0 安装了 AJAX 控制工具包。）

**默认.aspx：**

```
<ajaxToolkit:ToolkitScriptManager ID="ScriptManager1" runat="server" EnablePageMethods="True"></ajaxToolkit:ToolkitScriptManager>
<asp:TextBox ID="txtSearchAD" runat="server"></asp:TextBox>
<ajaxToolkit:AutoCompleteExtender ServiceMethod="findEmp"
MinimumPrefixLength="3"
CompletionInterval="100"
EnableCaching="true"
CompletionSetCount="10"
TargetControlID="txtSearchAD"
ID="ace1"
runat="server"
FirstRowSelected="false" ServicePath="ADS.asmx">
</ajaxToolkit:AutoCompleteExtender> 
```

**ADS.asmx.cs：**

```
namespace EventTracking
{
    /// <summary>
    /// Summary description for ADS
    /// </summary>
    [WebService(Namespace = "http://tempuri.org/")]
    [WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
    // To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line. 
    [System.Web.Script.Services.ScriptService]

    public class ADS : System.Web.Services.WebService
    {

        [WebMethod]
        public string[] findEmp(string prefixText, int count)
        {            
            DirectoryEntry directory = new DirectoryEntry();
            directory.Path = "LDAP://DC=yourdomain,DC=com";  //CHANGE to your LDAP path
            string filter = "(&(cn=" + prefixText + "*))";
            string[] strCats = { "cn" };
            List<string> items = new List<string>();
            DirectorySearcher dirComp = new DirectorySearcher(directory, filter, strCats, SearchScope.Subtree);
            SearchResultCollection results = dirComp.FindAll();
            foreach (SearchResult result in results)
            {
                foreach (DictionaryEntry prop in result.Properties)
                {
                    if (prop.Key.Equals("cn"))
                    {
                        System.Collections.IEnumerable propsEnum = prop.Value as System.Collections.IEnumerable;
                        foreach (object individualValue in propsEnum)
                        {
                            if (individualValue.ToString().IndexOf(prefixText) != 0)
                            {
                                items.Add(individualValue.ToString());
                            }
                        }
                    }
                }
            }
            return items.ToArray();
        }
    }
} 
```

享受！

# 64-bit - 如何在给定基地址和内存的情况下计算目标物理地址

> ID：11129771
> 
> 赞同：1
> 
> 时间：2012-06-20T23:50:59.533
> 
> 标签：64-bit, hex, offset, memory-address, base-address

因此，鉴于我有一台 64 位机器。我知道我的程序加载的地址的内存是）

```
0x8000:0000 and 
```

我需要找到目标内存地址，以便从 0x8000:0000 开始，我之间至少有 512 MB。

那么我如何找出这个目标内存是什么？

我所做的计算是 8000:0000 + 0x20000000 = 结果是目的地。但我不完全确定它是否正确。所以我在这里需要一些帮助。谁可以帮我这个事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-20T23:57:43.840

[当与分段内存架构](http://en.wikipedia.org/wiki/X86_memory_segmentation)一起使用时，类似的东西`0x8000:0000`通常用于表示段中的地址：偏移量表示法。这就是你在这里处理的吗？如果是这样，0x8000:0000 = 0x80000。0x80000 + 0x20000000 = 0x20080000。

# uiimage - UIProgressView 用 UIImage 自定义进度条

> ID：11129777
> 
> 赞同：2
> 
> 时间：2012-06-20T23:52:13.170
> 
> 标签：uiimage, resize, progress-bar, uiprogressview

我正在使用 iOS 5，我一直在搜索，但没有找到是否可以使用 UIProgressView 和 UIImage 制作粗进度条。如何使用一个小的 .png 文件并基本上使用 UIProgressView 将其拉伸，使其看起来像一个进度条，或者是否有可能？是否有可能使那个 .png 高，或者它会被限制在 UIProgressView 有多高？在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-11T03:51:31.940

我已经找到了如何做到这一点。首先在 iPhone 屏幕上放一个 UIProgressView。我把我的放在 x:86 y:272。我将它连接到视图控制器的 .h 文件，将其命名为 progView，并在 .m 文件中@synthesized。我将以下代码放在 ViewDidLoad 方法中：

```
// Select the images to use
UIImage *track = [[UIImage imageNamed:@"trackBar"] resizableImageWithCapInsets:UIEdgeInsetsMake(1, 1, 1, 1)];
UIImage *progress = [[UIImage imageNamed:@"progBar"] resizableImageWithCapInsets:UIEdgeInsetsMake(1, 1, 1, 1)];
// Set the track and progress images
[self.progView setTrackImage:track];
[self.progView setProgressImage:progress];
[self.progView setProgressViewStyle:UIProgressViewStyleDefault]; // we don't need anything fancy
// Create a bound where you want your image. This places the attached .png bars so that the bar drains downward. I was using this as a countdown bar on the iPhone.
self.progView.frame = CGRectMake(-70, 70, self.view.bounds.size.height/1.00, 100);
// A normal progress bar fills up from left to right. I rotate it so that the bar drains down.
self.progView.transform = CGAffineTransformMakeRotation((90) * M_PI / 180.0); 
```

这将获取图像并从中间拉伸它，保留每一侧的像素。但是，必须使用图像编辑器更改图像的宽度。我认为不可能拉伸宽度。

程序栏.png： ![进度条.png](../Images/72e056b2082845ff32cc843c93933cce.png) 轨道栏.png： ![轨迹栏.png](../Images/43c6e4dae5d4b8fc0998e5667d1c597a.png)

# iphone - 为什么我收到警告“找到多个名为 'center' 的方法”

> ID：11129778
> 
> 赞同：0
> 
> 时间：2012-06-20T23:52:20.733
> 
> 标签：iphone, xcode, ipad, compiler-warnings

如果我导入我的助手类（#import“JLHelper.h”），我只会收到此警告。

发生警告的示例...

```
[[subViews objectAtIndex:i] center].y+translation.y)]; 
```

我知道它告诉我编译器看到不止一个名为 center 的方法，但是 center 是在 CLRegion.h 的框架中声明的。

在这种情况下，为什么编译器会看到不止一种方法？这是一个需要关注的问题，如果是，我该如何追踪和解决它。

谢谢，

约翰

**问题已解决，感谢 Eric！这是修复后对我的代码的更广泛的了解**

```
NSArray *subViews = [self subviews];
UIImageView *bottomResizer;
int count = [subViews count];
for (int i =count-1; i>=0; i--) {
    if([[subViews objectAtIndex:i] tag] == 301) {
        bottomResizer = (UIImageView*)[subViews objectAtIndex:i];
        [bottomResizer setCenter:CGPointMake([bottomResizer center].x, [bottomResizer center].y+translation.y)];

    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-20T23:57:59.933

看起来你需要投射物体，所以它知道你的意思是什么中心......

```
[((OBJECT_TYPE*)[subViews objectAtIndex:i]) center].y+translation.y)]; 
```

其中 OBJECT_TYPE 是一个 CLRegion 对象

# java - Eclipse 插件 - 使用表创建视图

> ID：11129779
> 
> 赞同：0
> 
> 时间：2012-06-20T23:52:30.677
> 
> 标签：java, eclipse, plugins, eclipse-plugin

我目前正在学习 eclipse 插件是如何工作的。我想将表格放入视图中，并且我一直在弄乱示例视图插件一段时间，但我仍然无法让它工作。以下是示例视图插件的代码片段：

```
package com.example.helloworld2.views;

import org.eclipse.swt.widgets.Composite;
import org.eclipse.ui.part.*;
import org.eclipse.jface.viewers.*;
import org.eclipse.swt.graphics.Image;
import org.eclipse.swt.layout.GridData;
import org.eclipse.jface.action.*;
import org.eclipse.jface.dialogs.MessageDialog;
import org.eclipse.ui.*;
import org.eclipse.swt.widgets.Menu;
import org.eclipse.swt.SWT;

public class SampleView extends ViewPart {

    /**
     * The ID of the view as specified by the extension.
     */
    public static final String ID = "com.example.helloworld2.views.SampleView";

    private TableViewer viewer;
    private Action action1;
    private Action action2;
    private Action doubleClickAction;

    /*
     * The content provider class is responsible for
     * providing objects to the view. It can wrap
     * existing objects in adapters or simply return
     * objects as-is. These objects may be sensitive
     * to the current input of the view, or ignore
     * it and always show the same content 
     * (like Task List, for example).
     */

    class ViewContentProvider implements IStructuredContentProvider {
        public void inputChanged(Viewer v, Object oldInput, Object newInput) {
        }
        public void dispose() {
        }
        public Object[] getElements(Object parent) {
            return new String[] { "Onsdfsde", "Twosdfsd", "Threesdf" };
        }
    }
    class ViewLabelProvider extends LabelProvider implements ITableLabelProvider {
        public String getColumnText(Object obj, int index) {
            return getText(obj);
        }
        public Image getColumnImage(Object obj, int index) {
            return getImage(obj);
        }
        public Image getImage(Object obj) {
            return PlatformUI.getWorkbench().
                    getSharedImages().getImage(ISharedImages.IMG_OBJ_ELEMENT);
        }
    }
    class NameSorter extends ViewerSorter {
    }

    /**
     * The constructor.
     */
    public SampleView() {
    }

    /**
     * This is a callback that will allow us
     * to create the viewer and initialize it.
     */
    public void createPartControl(Composite parent) {
        viewer = new TableViewer(parent, SWT.MULTI | SWT.H_SCROLL | SWT.V_SCROLL);
        viewer.setContentProvider(new ViewContentProvider());
        viewer.setLabelProvider(new ViewLabelProvider());
        viewer.setSorter(new NameSorter());
        viewer.setInput(getViewSite());

        // Create the help context id for the viewer's control
        PlatformUI.getWorkbench().getHelpSystem().setHelp(viewer.getControl(), "com.example.helloworld2.viewer");

    }

...
} 
```

看起来视图内容提供者负责将内容放入视图中，但是我将如何插入表格呢？理想情况下，我最终想插入一个复杂的树表：

[http://www.java2s.com/Tutorial/Java/0280__SWT/CreateaTreeTable.htm](http://www.java2s.com/Tutorial/Java/0280__SWT/CreateaTreeTable.htm)

但是，如果有人能用类似的东西甚至是我可以阅读的一些资源直接向我指出正确的方向，那就太好了。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T00:44:12.530

作为“new TableViewer()”调用的一部分，您已经在 createPartControl() 中插入了一个表。要插入不同的小部件，您可以更改 createPartControl() 以执行不同的操作，例如改用 TreeTableViewer。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T10:11:04.503

`Table table = viewer.getTable();`

从我从你的问题中推断出来，我认为上面的代码应该做你想做的事。

# java - 如何对数学方程的答案进行四舍五入

> ID：11129784
> 
> 赞同：1
> 
> 时间：2012-06-20T23:52:54.577
> 
> 标签：java, android

全部——我有一个应用程序，用户可以在其中输入数据，例如晚餐账单的成本、小费百分比和人数。然后，该应用程序会获取数字并输出总账单成本和每个人必须支付的金额。我快到了，但是当用户输入的数字不好用时，我会得到 23.576 美元或 34.999999999 美元的输出。我的问题是如何使应用程序将两个输出答案舍入到小数点后两位（55.349 美元变为 55.35 美元）？提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T23:58:03.607

```
String roundTwoDecimals(double d) {
        DecimalFormat formatter = new DecimalFormat("#.##");
        return formatter.format(d);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-20T23:56:57.383

你可以`Math.round`这样使用：

```
 double data = 55.349; // Your data value of whatever

    int decimalPlaces = 2;
    double roundBase = Math.pow(10, decimalPlaces);
    data = (double)(Math.round(data * roundBase)) / roundBase;
    System.out.println(data); // Prints "55.35" 
```

但是请记住：在金融应用程序中，您不应该使用 double。由于您的似乎是小规模的，您应该没问题，但是，[`BigDecimal`](http://docs.oracle.com/javase/6/docs/api/java/math/BigDecimal.html)更容易用于这些目的。

如何使用 BigDecimal: [clicky](http://www.javaworld.com/javaworld/jw-06-2001/jw-0601-cents.html)。

# c# - 在设置文件中保存标志属性枚举

> ID：11129792
> 
> 赞同：1
> 
> 时间：2012-06-20T23:53:43.513
> 
> 标签：c#, dictionary, enums, settings

我正在尝试将一系列布尔值保存在 settings.cs 文件中。这是我目前的保存方法。

```
 private void SaveConfiguration()
    {
        VisibilitySwitchesFlags VisibilitySwitchesSaves = 0;

        if (_menu.TreeItemDictionary[VisibilityItems.ReferenceLines].Checked)
        VisibilitySwitchesSaves = VisibilitySwitchesFlags.ReferenceLinesChecked;

        if (_menu.TreeItemDictionary[VisibilityItems.ShowProfilePoints].Checked)
        VisibilitySwitchesSaves = VisibilitySwitchesFlags.ShowProfilePointsChecked;

        Settings.Default.VisibilityViewStates = (int)VisibilitySwitchesSaves;//convert to int
        Settings.Default.Save();
     } 
```

这是我的加载方法：

```
 private void LoadConfiguration()
  {
    VisibilitySwitchesFlags flags =(VisibilitySwitchesFlags)Settings.Default.VisibilityViewStates;

    _menu.TreeItemDictionary[VisibilityItems.ReferenceLines].Checked = flags.HasFlag(VisibilitySwitchesFlags.ReferenceLinesChecked);
    _menu.TreeItemDictionary[VisibilityItems.ShowProfilePoints].Checked = flags.HasFlag(VisibilitySwitchesFlags.ShowProfilePointsChecked);
  } 
```

加载后，我的保存似乎不成功。我的方法有错误吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T00:05:04.727

如果它是一个标志枚举，你需要以不同的方式设置它。

例如：

```
VisibilitySwitchesSaves |= VisibilitySwitchesFlags.ReferenceLinesChecked; 
```

# mysql - Mysql：无法从查询中的选择查询中获取值

> ID：11129793
> 
> 赞同：1
> 
> 时间：2012-06-20T23:53:47.880
> 
> 标签：mysql

我有以下查询。如果我运行它，我会收到此错误[消息](http://i48.tinypic.com/28bz5m0.png)。

询问-

```
SELECT account_name,ABC,date FROM entries
    LEFT JOIN accounts ON accounts.id = entries.accounts_id
    LEFT JOIN voucher ON voucher.id = entries.trans_id 
    WHERE trans_id IN ( SELECT trans_id, amount AS ABC FROM entries 
                         WHERE accounts_id='$accounts_id' AND side='C') 
    AND accounts_id!='$accounts_id' AND side='D'
    AND voucher.date between '$dateragne1' AND '$dateragne2' 
```

我认为问题在于 value `ABC`。它无法从第二个查询中获取值。

你能告诉我如何解决这个查询吗？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-20T23:55:26.257

尝试这个：

```
SELECT account_name, _inner.ABC, date 
  FROM 
  (
     SELECT amount AS ABC FROM entries 
       WHERE accounts_id='$accounts_id' AND side='C'
  ) AS _inner, entries
  LEFT JOIN accounts ON accounts.id = entries.accounts_id
  LEFT JOIN voucher ON voucher.id = entries.trans_id
    WHERE trans_id IN 
    ( 
      SELECT trans_id FROM entries WHERE accounts_id='$accounts_id' AND side='C'
    ) 
AND accounts_id!='$accounts_id' AND side='D'
AND voucher.date between '$dateragne1' AND '$dateragne2'` 
```

**笔记：**

*   像这样使用子查询不允许您从中请求字段。
*   此外，`IN`语句仅使用来自列的数据，而不是两个。

# c# - Unity IoC 容器名称和解析

> ID：11129794
> 
> 赞同：0
> 
> 时间：2012-06-20T23:54:01.297
> 
> 标签：c#, .net, dependency-injection, unity-container

这些语句是否等效（我得到相同的对象）？

```
unity.Resolve<ITest>(); 
```

和

```
unity.Resolve<ITest>(name : null); 
```

如果不是，我注册时没有传入名称参数的默认名称是什么？

例如。当我这样做时：

```
unity.RegisterType<ITest,Test>(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T01:22:31.683

它们是等效的，您将获得相同的类型。泛型`RegisterType`方法实际上是扩展方法，它们都在`UnityContainer`.

```
IUnityContainer RegisterType(Type from, Type to, string name, LifetimeManager lifetimeManager, params InjectionMember[] injectionMembers) 
```

# wpf - 为什么人们在 XAML 样式元素中指定 BasedOn="{x:Null}"？

> ID：11129796
> 
> 赞同：3
> 
> 时间：2012-06-20T23:54:20.580
> 
> 标签：wpf, xaml

我看到这样的 XAML 标记：

```
<Style x:Key="SmallSquareButton" BasedOn="{x:Null}" TargetType="{x:Type Button}"> 
```

我想知道为什么有必要将 BasedOn 属性设置为 null。从文档中， Style.BasedOn 的默认值为 null。我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T01:11:14.350

也许他们只是想表达清楚？还是他们认为它更完整？我认识很多人对代码这类事情有强迫症。就个人而言，我想不出任何理由为什么需要它。如果这是我过去看到的任何东西，那么可能是一个人无缘无故地做了，团队中的其他人只是复制粘贴。

# java - 无法比较 xml 标记中的属性

> ID：11129799
> 
> 赞同：0
> 
> 时间：2012-06-20T23:54:52.500
> 
> 标签：java, android, xml-parsing, sax

所以，我正在尝试解析一些看起来像这样的 xml：

```
<image size="extralarge">
http://...
</image> 
```

但我无法将 attr 的值与字符串进行比较。这是我的代码：

```
 albumImage.setTextElementListener(new TextElementListener() {
        boolean imageGoodSize=true;
        @Override
        public void start(Attributes attributes) {
            Log.v(TAG_LASTFM, "Image #" + attributes.getValue("size") + "#");
            if(attributes.getValue("size")+"" == "extralarge" || attributes.getValue("size")+"" == "mega") {
                imageGoodSize=false;
                Log.w(TAG_LASTFM, "(imageGoodSize set to false");
            }
            else {
                imageGoodSize=true;
            }
        } 
```

在日志中，它显示大小设置为“extralarge”，但是当我尝试将其与字符串“extralarge”进行比较时，imageGoodSize 未设置为 false。我究竟做错了什么 ？

这是日志：

```
06-21 01:52:30.463: V/ParseMusic_LastFM(32610): Image #extralarge# 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T23:58:26.773

您不应该将 Java 中的字符串与`==`运算符进行比较。你需要使用`.equals("extralarge")`

`==`比较对字符串的引用，而`.equals`比较内容。

# makefile - 发现 Makefile 或 cmake 的 MPI api 版本

> ID：11129800
> 
> 赞同：2
> 
> 时间：2012-06-20T23:54:59.100
> 
> 标签：makefile, cmake, mpi, dependency-management

我有一个代码，其中包含一些依赖于 mpi api 的位：

```
#if MPIVERSION==1
...
#elif MPIVERSION==2
...
#endif 
```

在假设 MPI-1 和 MPI-2 之间切换。

有没有一种很好的方法来推断一个好的版本——尤其是可能会进入构建系统的版本？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T07:55:08.957

做`configure`脚本通常做的事情——尝试编译和运行一个非常简单的测试 MPI 代码，它包括：

```
#include <stdio.h>
#include <mpi.h>

int main (void)
{
    int version, subversion;
    MPI_Get_version(&version, &subversion);
    printf("%d.%d\n", version, subversion);
    return 0;
} 
```

使用（或指定的任何编译器）编译此代码并在代码配置期间`mpicc`（直接而不是通过）运行它，您将：`mpirun`

*   知道 MPI 编译器包装器确实有效
*   获取支持的 MPI 标准主要和次要版本

您可以对 Fortran 项目执行相同的操作。

您也可以尝试`mpi.h`直接解析和搜索`MPI_VERSION`，`MPI_SUBVERSION`但您可能会遇到一些不可移植性问题。此外，这些宏旨在用于 C/C++ 代码中的条件编译。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T00:04:51.613

`MPI_VERSION`如果需要，请与 with 一起使用（`MPI_SUBVERSION`即 MPI 1.2 是`MPI_VERSION = 1`and `MPI_SUBVERSION = 2`）。文档[在这里](http://www.mpi-forum.org/docs/mpi-20-html/node29.htm#Node29)

# python - 如何将 django-evolution 目录添加到我的 Python 路径 - Ubuntu

> ID：11129801
> 
> 赞同：0
> 
> 时间：2012-06-20T23:55:08.580
> 
> 标签：python, linux, ubuntu, django-evolution

我想安装 Django-Evolution，但是关于如何安装的文档很少。我的主要绊脚石（我仍在 Linux 中学习东西）是以下行：

> 查看 Django Evolution 源代码，并将 checkout 目录放入您的 Python 路径中。

我怎么做？我想我在安装 Django 之前做过一次，但当时我只是按照一系列指令进行操作（[http://www.webmonkey.com/2010/02/install_django_and_build_your_first_app/](http://www.webmonkey.com/2010/02/install_django_and_build_your_first_app/)）。以下是他们关于 Evolution 的常见问题解答文件中的完整引用：

> ## 如何安装 Django Evolution？
> 
> Django Evolution 还没有任何官方版本。如果你想使用 Django Evolution，你需要使用 subversion checkout。
> 
> 查看 Django Evolution 源代码，并将 checkout 目录放入您的 Python 路径中。
> 
> 然后将“django_evolution”添加到您要在其中使用 Django Evolution 的项目的已安装应用程序列表中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T00:04:26.170

要将目录放在 Python 路径上，请将其添加到 PYTHONPATH 环境变量，或创建指向结帐目录的变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-02T20:15:31.560

要将目录添加到您的 PYTHONPATH 中，您需要将此行添加到或`~/.profile`中：`~/.bashrc``~/.bash_profile`

```
export PYTHONPATH=$PYTHONPATH:/path/to/Django/Evolution/directory 
```

替换`/path/to/Django/Evolution/directory`为包含 Django-Evolution 的目录的绝对路径

# android - 在 Android 上使用 FragmentActivity.getIntent().getExtras() 时出现 NullPointerException

> ID：11129806
> 
> 赞同：1
> 
> 时间：2012-06-20T23:55:28.897
> 
> 标签：android, nullpointerexception, arguments, bundle, fragment

我开始尝试使用 Android 片段，尤其是在水平 PagerAdapter 中显示活动。

在全球范围内它工作正常，但我无法将参数传递给我的 framgents 并将它们返回到 onCreateView() 方法中。

基本上，我像这样创建我的片段：

```
Bundle args = new Bundle();
args.putInt(ActionCodes.GAME_INDEX, game.getIndex());
fragments.add(Fragment.instantiate(this, GameReadActivityFragment.class.getName(), args)); 
```

请注意，我将`Bundle`参数传递给 Fragment.instantiate() 方法。

然后，在 GameReadActivityFragment.onCreateView() 中，我执行以下操作：

```
int gameIndex = this.fragmentActivity.getIntent().getExtras().getInt(ActionCodes.GAME_INDEX); 
```

但我得到一个 NullPointerException 因为`getExtras()`返回 null :(

我寻找答案，但无法找到答案。我倾向于认为我必须使用不同的东西`getExtras()`来访问这个 Bundle，但我不知道是什么。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T01:55:14.483

像这样做：

```
public static MyFragment newInstance(String bar) {
        MyFragment frag = new MyFragment();
        Bundle args = new Bundle();
        args.putString("foo", bar);
        frag.setArguments(args);
        return frag;
    } 
```

然后在 中`onCreateView`，您可以执行以下操作：

```
String text = getArguments().getString("foo"); 
```

# asp.net - ASP.NET MVC 3 MembershipProvider

> ID：11129807
> 
> 赞同：3
> 
> 时间：2012-06-20T23:55:32.077
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, asp.net-membership

我目前正在使用 ASP.NET MVC 3 开发一个站点，我正在使用 Nhibernate。我创建了一个自定义 MembershipProvider ，如下所述。

我的问题是时间在 ValidateUser 方法的会话中记录用户身份验证并在 GetUser 中检索它。

从我注意到你不能在 ValidateUser 中使用 Session，但使用 Cache 是不正确的，因为存储不是每个用户会话。

我该怎么办？

```
class MyMembershipProvider : MembershipProvider
{
    public override MembershipUser GetUser(string username, bool userIsOnline)
    {
        var membershipUser = MyMembershipUser)HttpContext.Current.Cache.Get(username);

        // Is not possible
        // var membershipUser = (MyMembershipUser) HttpContext.Current.Session[username];

        return membershipUser;
    }

    public override bool ValidateUser(string username, string password)
    {
        var usuario = UsuarioRepository.GetUsuarioAuthentication(username, password);

        if (usuario != null)
        {
            HttpContext.Current.Cache.Add(username, new MyMembershipUser(usuario.Id, usuario.Email), null,
                                          Cache.NoAbsoluteExpiration, FormsAuthentication.Timeout,
                                          CacheItemPriority.Default, null);

            // Is not possible 
            // HttpContext.Current.Session.Add(username, new MyMembershipUser(usuario.Id, usuario.Email));

            return true;
        }

        return false;
    } 
```

}

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T00:46:26.743

当您使用带有表单身份验证的 ASP.NET 成员身份时，根本不涉及会话。

用户成功通过身份验证后，只需调用

```
FormsAuthentication.SetAuthCookie() 
```

并且会自动为您创建一个身份验证 cookie。不要在 ValidateUser() 中调用它，而是从调用 ValidateUser() 的客户端代码中调用它。

身份验证 cookie 完全独立于会话 cookie。

有关详细信息，请参阅MSDN 上的[表单身份验证。](http://msdn.microsoft.com/en-us/library/ff647070.aspx)

如果您想缓存经过身份验证的用户的用户详细信息，这应该在调用 Membership.ValidateUser() 的客户端代码中完成，而不是在成员资格提供程序本身中完成。**成员资格提供者 GetUser() 和 ValidateUser() 应该按照他们的名字所暗示的那样做，并且没有任何其他副作用。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T00:36:22.683

您不想从会话中获取用户。GetUser 用于从数据库中检索用户 - 返回填充的 MembershipUser 对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T01:17:44.167

这两种方法的实现应该只查询您的数据库并返回`MembershipUser`或验证用户名密码 - 不用担心`HttpContext`。

我不知道你的`UsuarioRepository`实现的细节，所以我只是做了一些方法，但你应该大致像这样对你的提供者进行编码：

```
class MyMembershipProvider : MembershipProvider
{
    public override MembershipUser GetUser(string username, bool userIsOnline)
    {
        var usuario = UsuarioRepository.GetUserByUserName(username);
        return new MyMembershipUser(usuario.Id, usuario.Email);
    }

    public override bool ValidateUser(string username, string password)
    {
        return UsuarioRepository.ValidateUser(username, password);              
    }
} 
```

该`UsuarioRepository.GetUserByUserName(username)`方法将只返回具有给定用户名的用户，而`UsuarioRepository.ValidateUser(username, password)`如果给定用户名的密码正确，则应返回 true。存储库将处理获取会话并进行查询。

`UsuarioRepository`然后，为了提高您的提供者的性能，您可以使用 NHibernate 的一些内置缓存功能，通过修改您的方法以使用缓存来确保它缓存这些查询的结果。然后对这些方法的多次调用不会对性能造成影响。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-21T01:26:24.473

您是否关心查找有关用户的存储信息？

使用 MVC，您可以随时调用

```
 User.Identity.Name 
```

这将为您提供用户的当前用户名。

正如上面提到的@Saille，在创建自己的自定义成员资格提供程序时，您只需要关注创建`MembershipUser`和验证的基础知识。`MembershipUser`

完成基础知识并创建提供程序后，您可以将信息存储到`Session`成功用户登录时。

# python - 在 Python 中拟合分段函数

> ID：11129812
> 
> 赞同：5
> 
> 时间：2012-06-20T23:55:41.930
> 
> 标签：python, numpy, scipy, curve-fitting, piecewise

我正在尝试将分段定义的函数拟合到 Python 中的数据集。我已经搜索了很长时间，但无论是否可能，我都没有找到答案。

要了解我正在尝试做的事情，请查看以下示例（这对我不起作用）。在这里，我试图将偏移的绝对值函数 (f(x) = |xp|) 拟合到以 p 作为拟合参数的数据集。

```
import scipy.optimize as so
import numpy as np

def fitfunc(x,p):
   if x>p:
      return x-p
   else:
      return -(x-p)

fitfunc = np.vectorize(fitfunc) #vectorize so you can use func with array

x=np.arange(1,10)
y=fitfunc(x,6)+0.1*np.random.randn(len(x))

popt, pcov = so.curve_fit(fitfunc, x, y) #fitting routine that gives error 
```

有没有办法在 Python 中实现这一点？

在 R 中这样做的一种方法是：

```
# Fit of a absolute value function f(x)=|x-p|

f.lr <- function(x,p) {
    ifelse(x>p, x-p,-(x-p))
}
x <- seq(0,10)  #
y <- f.lr(x,6) + rnorm (length(x),0,2)
plot(y ~ x)
fit.lr <- nls(y ~ f.lr(x,p), start = list(p = 0), trace = T, control = list(warnOnly = T,minFactor = 1/2048))
summary(fit.lr)
coefficients(fit.lr)
p.fit <- coefficients(fit.lr)["p"]
x_fine <- seq(0,10,length.out=1000)
lines(x_fine,f.lr(x_fine,p.fit),type='l',col='red')
lines(x,f.lr(x,6),type='l',col='blue') 
```

经过更多的研究，我找到了一种方法。在这个解决方案中，我不喜欢我必须自己定义错误函数的事实。此外，我不确定为什么它必须采用这种 lambda 样式。因此，非常欢迎任何类型的建议或更复杂的解决方案。

```
import scipy.optimize as so
import numpy as np
import matplotlib.pyplot as plt

def fitfunc(p,x): return x - p if x > p else p - x 

def array_fitfunc(p,x):
    y = np.zeros(x.shape)
    for i in range(len(y)):
        y[i]=fitfunc(x[i],p)
    return y

errfunc = lambda p, x, y: array_fitfunc(p, x) - y # Distance to the target function

x=np.arange(1,10)
x_fine=np.arange(1,10,0.1)
y=array_fitfunc(6,x)+1*np.random.randn(len(x)) #data with noise

p1, success = so.leastsq(errfunc, -100, args=(x, y), epsfcn=1.) # -100 is the initial value for p; epsfcn sets the step width

plt.plot(x,y,'o') # fit data
plt.plot(x_fine,array_fitfunc(6,x_fine),'r-') #original function
plt.plot(x_fine,array_fitfunc(p1[0],x_fine),'b-') #fitted version
plt.show() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-08-09T14:41:59.727

为了在这里完成这个，我将分享我自己对这个问题的最终解决方案。为了接近我原来的问题，您只需要自己定义矢量化函数，而不是使用`np.vectorize`.

```
import scipy.optimize as so
import numpy as np

def fitfunc(x,p):
   if x>p:
      return x-p
   else:
      return -(x-p)

fitfunc_vec = np.vectorize(fitfunc) #vectorize so you can use func with array

def fitfunc_vec_self(x,p):
  y = np.zeros(x.shape)
  for i in range(len(y)):
    y[i]=fitfunc(x[i],p)
  return y

x=np.arange(1,10)
y=fitfunc_vec_self(x,6)+0.1*np.random.randn(len(x))

popt, pcov = so.curve_fit(fitfunc_vec_self, x, y) #fitting routine that gives error
print popt
print pcov 
```

输出：

```
[ 6.03608994]
[[ 0.00124934]] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T02:50:30.003

您不能简单地将 fitfunc 替换为

```
def fitfunc2(x, p):
    return np.abs(x-p) 
```

然后产生类似的东西

```
>>> x = np.arange(1,10)
>>> y = fitfunc2(x,6) + 0.1*np.random.randn(len(x))
>>> 
>>> so.curve_fit(fitfunc2, x, y) 
(array([ 5.98273313]), array([[ 0.00101859]])) 
```

使用 switch 函数和/或像`where`替换分支这样的构建块，这应该可以扩展到更复杂的表达式，而无需调用`vectorize`.

[PS：`errfunc`在您的最小二乘示例中不需要是 lambda。你可以写

```
def errfunc(p, x, y):
    return array_fitfunc(p, x) - y 
```

相反，如果你喜欢的话。]

# android - 适用于 Android 2.2 的可用 VideoView 源代码

> ID：11129814
> 
> 赞同：1
> 
> 时间：2012-06-20T23:55:52.930
> 
> 标签：android, android-videoview, android-source, android-2.2-froyo

我正在构建自己的视图来显示视频，并且我想将自定义视图基于内置的 Android VideoView。因此，我正在寻找 VideoView 的源代码。我在 Stackoverflow 和其他地方找到的大多数帖子都指向 grepcode。不幸的是，grepcode 上的代码似乎不是[developer.android.com](http://developer.android.com/index.html)上记录的代码，而且不是很有用。例如，grepcode 上的 VideoView.java 引用了一个从 View 继承的 mContext 对象，但在[developer.android.com](http://developer.android.com/index.html) sdk 的 View 中不可用。此外，VideoView 调用 MediaPlayer 的 resume 方法，该方法在标准 MediaPlayer 类中也不可用。我在哪里可以获得 developer.android.com 上记录的源代码？

谢谢，万斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T02:12:51.880

[首先，Android 基础框架是开源的， grepcode](http://grepcode.com/snapshot/repository.grepcode.com/java/ext/com.google.android/android/2.2_r1.1/)的源代码和[github](https://github.com/android/platform_frameworks_base/tree/master/core/java/)的源代码没有区别。它们都有优点和缺点，grepcode 中的源代码由 API 级别标记，因此易于导航特定版本的 API 类，其中 github 中的源代码对每次提交都有完整的更改历史记录，但查找/检索早期版本有点复杂特定的 API 类。

> grepcode 上的 VideoView.java 引用了一个从 View 继承的 mContext 对象，但在 developer.android.com sdk 的 View 中不可用

mContext`@hide`在 android.view.View 中被标记，见[github 中的 head 版本](https://github.com/android/platform_frameworks_base/blob/master/core/java/android/view/View.java#L2375)。

> VideoView 调用 MediaPlayer 的 resume 方法，该方法在标准 MediaPlayer 类中也不可用。

resume()`@hide`在 android.media.MediaPlayer 中被标记，请参阅[github 中的早期版本](https://github.com/android/platform_frameworks_base/blob/d09af7d5518d0a5b3c8070784c13a1070f46f460/media/java/android/media/MediaPlayer.java#L1112)或[grepcode 中的标记 2.2_r1.1](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/2.2_r1.1/android/media/MediaPlayer.java#1089)。

一般来说，谷歌提供给消费者开发者的开发API（android.jar）已经剥离了`com.android.internal`和API。`@hide`但是，安装在实际设备上的运行时 API (framework.jar) 应有尽有。

如果您想在自己的代码中使用这些内部和隐藏 API，解决方案是使用 java 反射或 inazaruk 在他的博客中解释的解决[方法](http://devmaze.wordpress.com/2011/01/18/using-com-android-internal-part-1-introduction/)。

希望这是有道理的。

# grails - 如何使 Groovy / Grails 返回对象列表而不是对象列表列表？

> ID：11129815
> 
> 赞同：6
> 
> 时间：2012-06-20T23:56:05.300
> 
> 标签：grails, collections, groovy, closures, collect

我有这样的课：

```
class Foo {
    static hasMany = [bars: Bar]
} 
```

当我写：

```
Foo.getAll() 
```

我得到这样的`Foo`对象列表：

```
[ Foo1, Foo2, Foo3 ] 
```

当我写：

```
Foo.getAll().bars 
```

我得到这样的对象列表列表`Bar`：

```
[ [ Bar1, Bar2 ], [ Bar2, Bar3 ], [ Bar1, Bar4 ] ] 
```

但我想要的是一个独特的`Bar`对象列表，如下所示：

```
[ Bar1, Bar2, Bar3, Bar4 ] 
```

我的最终目标是在上面的列表中拥有一个唯一的`Bar`对象 id 列表，如下所示：

```
[ 1, 2, 3, 4 ] 
```

我尝试了[收集](http://groovy.codehaus.org/groovy-jdk/java/util/Collection.html#collect%28groovy.lang.Closure%29)方法的变体，也尝试了[传播运算符](http://groovy.codehaus.org/Operators#Operators-SpreadOperator)，但我没有任何运气。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-21T02:15:46.073

对于通用的 groovy 类（即非 GORM 类），David 是正确的，`flatten`并且`unique`是最好的方法。

但是，在您的示例中，您似乎在多对多关系中使用 GORM 域对象（否则您将不需要唯一性约束）。

对于域类，您最好使用 HQL 或标准一步完成。另一个优点是为它生成的 SQL 效率更高。

这是用于获取与多对多关系中的`Bar`任何相关的唯一 ID的 HQL：`Foo`

```
Bar.executeQuery("select distinct b.id from Foo f join f.bars b") 
```

标准如下：

```
Foo.withCriteria {
    bars {
        projections {
          distinct("id")
        }
    }
} 
```

使用这种方法的一个“问题”是 HQL 在单元测试中不受支持（并且可能永远不会支持），并且[带有连接表投影的 Criteria 查询在 2.0.4 单元测试中被破坏](http://jira.grails.org/browse/GRAILS-9161)。因此，围绕此代码的任何测试都需要模拟或使用集成测试。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-21T00:14:10.383

可能有更好的方法，但您可以使用[flatten](http://groovy.codehaus.org/groovy-jdk/java/util/Collection.html#flatten%28%29)和[unique](http://groovy.codehaus.org/groovy-jdk/java/util/Collection.html#unique%28%29)。

就像是：

`def allBars = Foo.getAll().bars.flatten().unique()`

编辑：
我刚刚重新阅读并看到你最终是在一个 ID 列表之后，而不是 Bars。正如您所建议的，您将使用它`collect{ it.id }`来获取 ID。出于性能原因，我会在使列表独一无二之前这样做。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-21T00:26:49.563

有一种方法与调用then[`Collection#collectMany`](http://groovy.codehaus.org/groovy-jdk/java/util/Collection.html#collectMany%28groovy.lang.Closure%29)的工作方式相同。要获取 Bar ID 列表，您可以执行以下操作：`collect``flatten`

```
def barIds = Foo.getAll().collectMany { it.bars*.id } 
```

闭包返回一个带有 Foo 的 Bars 的 ID的`{ it.bars*.id }`列表（我喜欢这些占位符名称，呵呵），然后`collectMany`将这些列表连接成一个列表。如果您需要 ID 是唯一的（也许一个 Bar 可以属于多个 Foo），您可以在[`.unique()`](http://groovy.codehaus.org/groovy-jdk/java/util/Collection.html#unique%28%29)该表达式中添加一个 :)

# python - Python：Json 使用命名元组、日期对嵌套数据结构进行编码

> ID：11129816
> 
> 赞同：2
> 
> 时间：2012-06-20T23:56:09.643
> 
> 标签：python, datetime, json, namedtuple

我有一个嵌套的 Python 数据结构，其中包含 datetime.datetime 对象和 namedtuples，如下所示：

```
from datetime import datetime as dt
from datetime import timedelta
from collections import namedtuple
nt = namedtuple('n', 'name, contact')
f1 = nt('jules', '1234')
f2 = nt('dan', '5678')
x = [
    [dt.now() + timedelta(minutes=1), f1],
    [dt.now() + timedelta(hours=1), f2],
    ] 
```

和一个这样的编码器：

```
import json
class TestEncoder(json.JSONEncoder):
    def default(self, obj):
        if hasattr(obj, 'isoformat'):
            return obj.isoformat()
        else:
            return json.JSONEncoder.default(self, obj) 
```

`print json.dumps(x, cls=TestEncoder)`输出：

```
[["2012-06-21T00:48:03.296381", ["jules", "1234"]],
 ["2012-06-21T01:47:03.296423", ["dan", "5678"]]] 
```

我想将 namedtuple 转换为 dicts（大概使用 namedtuple`._asdict()`方法），以获得以下输出：

```
[["2012-06-21T00:48:03.296381", {"name":"jules", "contact":"1234"}],
 ["2012-06-21T01:47:03.296423", {"name":"dan", "contact":"5678"}]] 
```

如何保留一般数据结构，但 json 将命名元组转储为 dicts？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T00:41:56.347

重新阅读文档后，使用内置`json`lib 似乎是不可能的，因为唯一的覆盖机制 ( `default`) 仅在已知类型（包括元组）之后调用

`simplejson`通过给你一个`namedtuple_as_object`标志来使这变得微不足道`simplejson.dump`

```
simplejson.dumps(x, cls=TestEncoder, namedtuple_as_object=True) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-09-19T21:28:48.427

我为此编写了一个 python 模块。它被称为`typedload`

有趣的是它是双向的，所以从你的 json 中你可以通过传递 json 和类型返回到 python 对象。

```
import typedload
typedload.dump(data) 
```

# android - ADB 通过蓝牙 Android

> ID：11129817
> 
> 赞同：39
> 
> 时间：2012-06-20T23:56:20.613
> 
> 标签：android, bluetooth, adb, tethering

我没有WIFI，我没有可用的电缆连接。

我有希望将我的设备连接到 ADB 吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-06-20T23:56:21.237

随着最新版本的 Cyanogenmod（7.2 和 9）以及可能的其他一些 rom，*adb over network*的选项已经到来。

类似于*[ADB over WIFI](https://play.google.com/store/apps/details?id=com.ryosoftware.adbw&hl=en)*已经有一段时间了，它几乎是一样的。

*   在您的笔记本电脑和设备上启用蓝牙
*   将它们配对
*   通过蓝牙 PAN（个人局域网）从您的笔记本电脑连接到您的设备
*   启用*ADB over Network*设置（设置/应用程序/开发）
*   从终端找出您的 IP 地址（`busybox ifconfig`应该这样做）
    *   非root：检查`default gateway`你的电脑，它应该是你设备的IP
*   通过计算机连接您的设备`adb connect xxx.xxx.xxx.xxx`
*   享受。

确保在完成后禁用 ADB over Network 设置以避免移动互联网 ADB 的东西。完成后禁用蓝牙，应该没问题。

奖励部分是，当您为此配对和开发时，您也可以使用这些设备移动互联网。（如果你有保险，当然）

这只是一个部分解决方案，因为它需要设备既能获得 root 权限，又需要运行提供该特定设置的 rom。我只能假设它可以从终端以其他方式完成，但我不够精明来管理它。

# debugging - 使用 -g 在 Linux 上构建 OpenSSL 以进行调试

> ID：11129826
> 
> 赞同：9
> 
> 时间：2012-06-20T23:57:22.257
> 
> 标签：debugging, build, compilation, makefile, openssl

我有一个来自 OpenSSL（特别是`SSL_read`）的段错误，我想调试它。我认为在这里采取的最佳步骤是使用调试符号自己构建库，这样我就可以进入函数并查看它正在执行的命令。我不清楚如何 a) 自己构建库和 b) 破解 makefile 给我调试符号。有没有人有使用这个特定库的经验，或者对这种构建和修改方法有一般指导？

得到这个错误：

```
./config -d
Operating system: x86_64-whatever-linux2
This system (debug-linux-x86_64) is not supported. See file INSTALL for details. 
```

不知道在这里做什么。操作系统信息：

```
$ cat /proc/version
Linux version 3.2.0-24-virtual (buildd@yellow) (gcc version 4.6.3 (Ubuntu/Linaro 4.6.31ubuntu5) ) #37-Ubuntu SMP Wed Apr 25 10:17:19 UTC 2012
$ uname -srvio
Linux 3.2.0-24-virtual #37-Ubuntu SMP Wed Apr 25 10:17:19 UTC 2012 x86_64 GNU/Linux 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-21T00:22:29.047

[您可以按照此处](http://www.devside.net/guides/linux/openssl)提到的简单说明来构建 OpenSSL。要进行调试构建，`-d`请在运行时添加标志`./config`，即`./config -d [other options]`. [此处](http://www.cgicentral.net/400CS/Docs/openssl/INSTALL.openssl.html)详细介绍了构建 OpenSSL 。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-08-17T16:24:11.037

在新版本的 OpenSSL 上，看起来传递给 ./Configure 的标志在编译时被直接注入 gcc 行。我刚刚做了`./Configure -g linux-x86_64`并成功地在我的构建中获得了调试符号。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-11-26T00:51:52.897

运行常规配置步骤后，从 shell 执行以下操作：

```
$ find . -name Makefile | xargs sed -i -e 's#-O3#-g#g' 
```

它修改生成的makefile；而不是优化选项`-O3`，它放在`-g`选项中（生成调试符号）。

# unix - 按列过滤文件

> ID：11129827
> 
> 赞同：2
> 
> 时间：2012-06-20T23:57:24.027
> 
> 标签：unix, awk

我有一个unix问题。我有一个看起来像这样的文件：

```
AAAA    0   1   2   2   0

BBBBB   2   2   2   2   2

CCCCC   1   1   0   1   1

DDDD    0   0   0   0   0

EEEEE   2   2   0   2   2 
```

该文件有数千行这样的（并且也是制表符分隔的）。文件的第一列是名称，第 2 到第 6 列是数据。重要的是第 2-6 列中的信息。我需要输出第 2-6 列不超过 1 0（零）的所有行。例如，我希望输出如下所示：

```
BBBBB   2   2   2   2   2

CCCCC   1   1   0   1   1

EEEEE   2   2   0   2   2 
```

我一直在尝试以尽可能简单的方法执行此操作，并尝试了以下 awk 命令：

```
awk 'BEGIN{out!=0;}{if($2!=0)out++;if($3!=0)out++;if($4!=0)out++;if($5!=0)out++;if($6!=0)out++;if (out>=4)print;}' 
```

但是，当我尝试这个时，它只是给了我原始输入文件。我不确定出了什么问题，或者我是否采取了正确的方法。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T00:04:24.117

您正在做的错误不是为每条记录重置 out 变量，而是在 BEGIN 块中只初始化一次。（您也错误地使用“不等于”进行初始化。）

```
awk '{out = 0; if($2!=0) out++; if($3!=0) out++; if($4!=0) out++; if($5!=0) out++; if($6!=0) out++; if(out>=4) print}' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T00:36:26.003

一种使用方式`perl`：

```
perl -ne 'print if(tr/0/0/ <= 1)' file.txt 
```

我假设每行上的名称不包含数字（特别是`0`），并且它们的长度不超过一位。此外，如果添加`-i`标志，则可以在文件中进行更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T14:37:32.923

假设列符合特定格式可能很危险。以下是使用布尔变量的 0,1 属性的简单解决方案：

```
awk '($2==0) + ($3==0) + ($4==0) + ($5==0) + ($6==0) <2' file.txt 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T05:20:06.793

更简单的方法是：

```
awk '{count=0;for(i=2;i<=NF;i++){if($i~/0/)++count;}if(count <=1)print}' file1 
```

测试如下：

```
> cat file1
AAAA    0       1       2       2       0
BBBBB   2       2       2       2       2
CCCCC   1       1       0       1       1
DDDD    0       0       0       0       0
EEEEE   2       2       0       2       2
sEEEE   2       0       0       0       2
> awk '{count=0;for(i=2;i<=NF;i++){if($i~/0/)++count;}if(count <=1)print}' file
BBBBB  2 2 2 2 2
CCCCC  1 1 0 1 1
EEEEE  2 2 0 2 2
> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-21T01:05:35.070

```
awk '
  {
    nzero=0
    for (fld = 2; nzero <= 1 && fld <= 6; fld++) {
      if ($fld == 0) nzero++
    }
    if (nzero <= 1) print
  }
' filename 
```

# monodevelop - MonoDevelop“找不到类型或命名空间‘Android’”

> ID：11129828
> 
> 赞同：2
> 
> 时间：2012-06-20T23:57:33.817
> 
> 标签：monodevelop, xamarin.android

我主要通过 Visual Studio 使用 Mono for Android，但已经切换到 OS X 并想使用 MonoDevelop。从 MonoDevelop 主菜单中，单击 File => New => Solution。我选择 Mono For Android Application，给它一个名字，并默认将位置留在 Users/myname/Projects。它使用带有基本按钮的 Activity1.cs 创建 shell 项目。如果我尝试构建或调试项目，所有使用指令都会出错，说明找不到类型或命名空间“Android”。我用谷歌搜索了那个确切的消息，没有找到匹配项。我昨天刚刚在我的 Mac 上下载了 MonoDevelop，所有必需的 SDK 和 Mono for Android。到底他妈发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T02:31:57.490

所以下载说明说在安装 MonoDevelop 之前下载 Runtime OR SDK。所以我只下载了SDK。一旦我安装了运行时，这个错误就消失了。仍然无法调试到我的设备，但这是一个单独的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T19:14:35.277

当我使用 Xamarin 安装程序安装所有内容时，我没有遇到任何这些问题。您可能能够修复它去引用并检查 Mono.Android.dll 是否为红色。在这种情况下，请编辑参考并尝试找到它。

它应该在 /Developer/usr/lib/mandroid/platforms

# java - Java 从文本文件中读取前 2 行

> ID：11129834
> 
> 赞同：0
> 
> 时间：2012-06-20T23:58:19.283
> 
> 标签：java, text-files

假设我有一个这样的文本文件。有谁知道我如何区分标题和评论，以使我能够将其存储在数据库中？谢谢！

（**编辑：长示例被截断）**

> 丢失的
> 
> Danielo2k12：我同意 SimmsMolly 的观点，当他在锯木厂之后跳进去时，我就像在寻找 jin，然后没有他的迹象，主要是关于舱口会议的更多细节，更多关于木筏的信息仍然值得一看：D
> 
> 小队
> 
> balverio：是的，嗯，这是对“敌人”的抄袭，但那部电影更好。6/10
> 
> 家庭电影
> 
> SmittShow : 不要浪费你的时间 1/5
> 
> 丝绸
> 
> Tlcprn : 这是一个很好的系列！期待玛莎会尽其所能。当她发现布伦登发生了什么事时，她会对结果感到非常不安。迫不及待地想看看她为法尔家族准备了什么！爱，爱玛莎！！
> 
> 奇谋妙计吴福星
> 
> 快速大师：最好的电影！！！
> 
> 我看见了太阳 - (Günesi gördüm)
> 
> RuruLover : 这里没有链接....
> 
> 渴望改变
> 
> joanofjamaica ：我非常想看到这个，但我看不到这些链接中的任何一个
> 
> 牢不可破
> 
> ventu_rabbit ：这是一部有趣的电影，为了悬念而长期积累，但我不认为这是一部像所有评论所说的那样聪明、发人深省的电影。我想如果你在字里行间寻找足够长的东西，你会找到的。这是一部普通的惊悚片，没什么令人兴奋的……等等……

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T02:22:17.237

您可能可以从这样的事情开始。只需逐行阅读。标题、空行、作者和评论、空行。拆分作者和评论。

```
public static void main(String[] args) throws Exception {
    BufferedReader br = new BufferedReader(new FileReader(new File("C:\\Users\\wattsj\\workspace\\youtube\\src\\main\\resources\\cc")));
    while (readReview(br));
}

private static boolean readReview(BufferedReader br) throws IOException {
    String title = getNextLine(br);
    if (title == null) {
        return false;
    }
    String commentWithAuthor = getNextLine(br);
    if (commentWithAuthor == null) {
        throw new RuntimeException("Title but end of file before author");
    }
    String[] commentAndAuthor = commentWithAuthor.split(" : ", 2);
    if (commentWithAuthor.length() < 2) {
        throw new RuntimeException("Author but no comment found on the same line");
    }
    String comment = commentAndAuthor[0];
    String author = commentAndAuthor[1];
    System.out.println(title);
    System.out.println(comment);
    System.out.println(author);
    return true;
}

private static String getNextLine(BufferedReader br) throws IOException {
    String line;
    if ((line = br.readLine()) == null) {
        return null;
    }
    if (!"".equals(br.readLine())) {
        throw new RuntimeException("Expected a blank line");
    }
    return line;
} 
```

# ios - 使用 StoryBoard 和 ARC 进行模态转场后被遗弃的记忆

> ID：11129835
> 
> 赞同：2
> 
> 时间：2012-06-20T23:58:25.847
> 
> 标签：ios, memory-management, storyboard, segue, abandoned-memory

我在使用 StoryBoard 增加内存时遇到问题。
我使用模态序列来进入下一个或上一个。视图控制器。

[示例 UIStoryBoard](https://dl.dropbox.com/u/955031/segue1.png)
当我运行 Instruments 时，我可以看到 Viewcontrollers 永远不会超出内存。
所以他们被添加并添加每个segue。

[工具分配](https://dl.dropbox.com/u/955031/segue2.png)

我怎样才能把这个 Viewcontroller 从内存中取出？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T22:20:03.263

我认为您正在使用模态转场回到上一个场景。然后，当每个 segue 都在执行时，就会有新的分配......

只需使用此方法返回上一个场景：

```
[self dismissViewControllerAnimated:YES completion:nil]; 
```

并删除您用于 go backing 的第二个模态序列。

# wpf - 如何使 gui 和 class 字符串相同？

> ID：11129839
> 
> 赞同：1
> 
> 时间：2012-06-20T23:59:11.623
> 
> 标签：wpf

我写了一个简单的类，一开始它只是每 2 秒增加一些 int 的值我还添加了一些 TextBlock 并使类计数器和 TextBlock.Text 通过 Binding 连接。

但是 TextBlock 没有增加 - 只显示数字“1”如何增加 TextBlock 上显示的值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T00:06:02.287

> 我写了一个简单的类，一开始它只是每 2 秒增加一些 int 的值

确保类 implements `INotifyPropertyChanged`，并且您在绑定中使用的 int 属性`PropertyChanged`正确提升。

此外，如果您的代码“每 2 秒增加一次值”是在主 (UI) 线程的循环中发生的，那么您将永远不会给用户界面刷新的机会。在这种情况下，将代码移动到计时器或后台线程中以增加值。

# php - PHP按id对stdClass对象的数组进行排序

> ID：11129840
> 
> 赞同：6
> 
> 时间：2012-06-20T23:59:12.653
> 
> 标签：php, arrays, sorting

我有一个相当大的数组，看起来像

```
Array(
   [0] => stdClass Object
        (
            [id] => 8585320
            [title] => the title
            [type] => page
            [url] => link.com
            [excerpt] => brief description
        )

    [1] => stdClass Object
        (
            [id] => 8585320
            [title] => the title
            [type] => page
            [url] => link.com
            [excerpt] => brief description
        )
 ) 
```

我对数组的形成方式以及它的输出方式没有明显的控制权，似乎它几乎没有任何逻辑。但我坚持下去。所以我需要做的基本上是按每个 stdClass 对象对数组进行数字排序，然后确保 id 是从最大到最小而不是从最小到最大。一直保持数组对象组合的当前结构

我现在什至无法开始思考我需要如何按照我需要的方式对其进行排序。因为它已经足够长的一天了。

***更新***

```
public function updateRet($a, $b) {
        return $b->id - $a->id;
    }
usort($ret, 'updateRet'); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-21T00:01:41.640

只需使用[`usort`](http://php.net/usort)：

```
function compare_some_objects($a, $b) { // Make sure to give this a more meaningful name!
    return $b->id - $a->id;
}

// ...

usort($array, 'compare_some_objects'); 
```

如果你有 PHP 5.3 或更高版本，你也可以使用匿名函数：

```
usort($array, function($a, $b) { return $b->id - $a->id; }); 
```

# sql - SQL Server：如何检查字段是否存在“NULL”或“NOT NULL”约束？

> ID：11129842
> 
> 赞同：4
> 
> 时间：2012-06-20T23:59:37.360
> 
> 标签：sql, sql-server, database, constraints

谁能告诉我是否有办法以编程方式确定 Micorosft SQL Server 数据库表字段是否存在 NULL 或 NOT NULL 约束？我需要这个，以便我可以部署一个可以安全地重新运行的补丁。所以我追求这样的东西（概念/伪代码）：

`IF (my_table COLUMN end_date HAS CONSTRAINT OF 'NOT NULL') ALTER TABLE my_table ALTER COLUMN end_date DATETIME NULL`

因此，如果 my_table.end_date 尚未更改，我想将其从“NOT NULL”更改为“NULL”。我只是不确定括号中的部分应该是什么。

我知道如何询问 dbo.sysobjects 以获取现有字段、现有外键约束等（已经有几个线程），但我只是不确定如何专门检查 NULL/NOT NULL 字段约束。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T00:14:32.540

你可以看看`INFORMATION_SCHEMA.COLUMNS`：

```
if (select IS_NULLABLE from INFORMATION_SCHEMA.COLUMNS 
    where TABLE_NAME='my_table' and COLUMN_NAME='end_date') = 'NO' 
begin
    ALTER TABLE my_table ALTER COLUMN end_date DATETIME NULL
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T00:21:37.303

如果您使用的是 SQL Server 2005+，如果存在 NOT NULL 约束，则返回“NO”：

```
SELECT IS_NULLABLE
FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_NAME = 'tblName'
AND COLUMN_NAME = 'colName' 
```

# c - 检查定义 GNU C

> ID：11129843
> 
> 赞同：1
> 
> 时间：2012-06-20T23:59:47.233
> 
> 标签：c, linux, gcc, c-preprocessor, shared

我试图更多地了解预处理器如何与 GCC 在 GNU/Linux 上生成的共享对象库相关。

我一直无法找到一个清晰，简洁的答案。

如果我使用预处理器语句，例如：

```
#ifndef __OPTI_MY_VARIABLE
#define __OPTI_MY_VARIABLE 1
#endif 
```

我用这个编译了一个共享对象文件，并用另一个我声明的程序链接到它：

```
#define __OPTI_MY_VARIABLE 2 
```

在编译使用共享对象库的主程序后，我的程序会使用值 1 还是 2？

如果它使用值 1，是否有办法构造代码以使其使用值 2，例如不使用预处理器语句？换句话说，有没有办法让我声明默认值，除非另一个同名的全局变量覆盖它，或者必须将此信息传递给共享对象中的函数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T00:02:16.087

`#define`s 只有预处理器才能看到。预处理器在编译器之前完全运行。编译器在链接之前运行。

如果您希望能够覆盖共享对象“内部”的默认值，那么我建议使用 setter 函数和静态全局变量，例如：

```
#define OPTI_MY_VARIABLE_DEFAULT   1

static int opti_my_variable = OPTI_MY_VARIABLE_DEFAULT;

...

void set_opti_my_variable(int i) { opti_my_variable = i; } 
```

显然，这使用了一个全局变量，许多人对此不屑一顾……

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T10:23:26.593

问题是错误的。

这些定义意味着在源代码中，所有出现的定义名称都*在编译之前*被给定的值替换。

因此，在一个共享库中，无论您在哪里使用该名称，您的值都是 1。在另一个共享库中，值是 2。共享库中不存在该名称。如果您将两个共享库与一个程序一起使用，那么第一个库中设置定义名称的任何变量都将具有值 1，而在第二个库中，值 2。

# python - python中简单数据存储的最佳格式

> ID：11129844
> 
> 赞同：5
> 
> 时间：2012-06-20T23:59:54.870
> 
> 标签：python

作为一个相对较新的程序员，我曾多次遇到这样的情况，即从外部源读取和组装程序数据而不是将其写入代码对我来说是有益的。当有大量相同类型的对象时，通常会出现这种情况。在这种情况下，对象定义会很快占用代码中的大量空间，并为可读性添加不必要的障碍。

例如，我一直在研究基于文本的 RPG，它有大量的房间和项目需要跟踪。即使是一些物品和房间也会导致大量的对象创建代码块。

我认为在这种情况下使用某种格式的外部数据存储，从文件中读取会更容易。在这样的文件中，物品和房间将按名称和属性存储，以便它们可以相对容易地解析为对象。

什么格式最适合这个？我觉得像 SQL 这样的成熟数据库会给相当轻量级的脚本添加不必要的膨胀。另一方面，通过外部应用程序或其他 python 脚本编辑这些数据的简单方法很重要。在较轻的方面，我听到最常提到的几个是 XML、JSON 和 YAML。

从我所见，XML 似乎不是最佳选择，因为许多人似乎发现它复杂且难以有效使用。

JSON 和 YAML 似乎都可以工作，但我不知道在外部进行编辑会有多容易。在这种情况下，速度不是主要问题。虽然更快的实现当然是可取的，但这并不是我可以使用的限制因素。

我已经在这里和通过谷歌环顾四周，虽然我已经看到了很多关于这个主题的内容，但我找不到任何对我特别有帮助的东西。JSON 或 YAML 之类的格式是否足以满足此要求，或者我是否可以更好地使用成熟的数据库？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T00:20:43.263

尽管这里已经有很好的答案，但我只是出于您的目的推荐 JSON，唯一的原因是，由于您是新程序员，因此它将是最直接的阅读和翻译，因为它具有与本机 Python 数据类型的最直接映射（列表`[]`和字典`{}`）。可读性有很长的路要走，是 Python 编程的原则之一。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-21T00:36:46.100

我非常喜欢使用[Python Pickles](http://docs.python.org/library/pickle.html)将数据存储在文件中。

Pickle 可以正确地序列化任何类型的 Python 对象，尤其是“复杂”的东西——任何类型的 Python 类、函数——任何类型的对象！

它不限于 JSON 等数据格式中可用的相对简单的结构，如“列表”、“字典”、“字符串”和“数字”。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-21T00:15:06.563

好吧，这取决于您的用例。

如果您的文件相对较小且几乎是静态的，则 YAML 或 JSON 都可以达到目的。查看[YAML 和 JSON 有什么区别？何时更喜欢其中一个以](https://stackoverflow.com/questions/1726802/what-is-the-difference-between-yaml-and-json-when-prefer-one-than-another)获取更多信息

如果你的文件很大，或者是动态的，或者会涉及到一些并发控制，那么你最好让数据库来处理它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-21T01:10:30.940

我对几个应用程序有类似的需求，并使用 jsonpickle 选择了 JSON。

为了使 json 输出更具人类可读性/可编辑性，我使用以下格式设置：

```
jsonpickle.set_encoder_options('simplejson', sort_keys=True, indent=4) 
```

然后对数据进行编码/解码：

```
text = jsonpickle.encode(data)
...
data = jsonpickle.decode(text) 
```

jsonpickle 的好处在于它可以让您存储类对象，而无需手动将所有内容转换为 dicts（就像使用纯 JSON 一样）。jsonpickle 还包含挂钩，让您可以定义自己的转换器，如果您需要更多地控制事物的转换方式。

关系数据库当然有自己的位置，特别是对于大型多人游戏。如果您的许多游戏逻辑涉及对大量对象的频繁小更新，那么数据库方法将会获胜。

[更新] 进一步说明，如果您要大量手动编辑 json 文件，请为自己制作一个小 json-checker 脚本，您可以在编辑后的文件上运行以查找语法错误，它会为您节省很多的时间。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-21T00:14:33.383

XML、JSON 或 YAML 是比关系数据库提供给您的更“松散”的格式。关系数据库是面向表的，并且会对您存储数据的方式施加一些限制。

根据您的描述，我会坚持使用 JSON 或 YAML。使用它们，您可以表达相当复杂的对象图（如果您需要更“正式”的类型或模式，我可以选择 XML）。

对于读取或写入操作，您通常会考虑对对象进行序列化/反序列化（如[http://docs.python.org/library/json.html](http://docs.python.org/library/json.html)所做的）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-21T00:01:31.023

如果您想要可编辑性，YAML 是您命名的最佳选择，因为它没有 <> 或 {} 必需的分隔符。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-21T00:37:02.833

我很想研究一些可以输出带有注释的graphviz（DOT格式）的GUI，因此您可以创建房间和它们之间的链接（一种图形）。稍后，您可能需要另一种格式来支持更重要的信息。

但是应该可以很容易地创建地图，房间之间的链接（包含物品或陷阱等），并且您可以使用公共库以 png 或其他方式生成地图图形。

只是我脑海中的一个随机想法-随意忽略！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-08-22T12:12:22.397

对于小型且封闭的回声系统，[pickle](https://docs.python.org/3/library/pickle.html)是一个很好的解决方案。根据我的经验和 Ilia Zaitsev 的[文章](https://towardsdatascience.com/the-best-format-to-save-pandas-data-414dca023e0d)，一个更健壮、更快、更轻的文件，我建议将 pandas DataFrame 用于关系数据结构和[pyarrow.feather](https://arrow.apache.org/docs/python/feather.html)用于读/写。

例如：

```
import pandas as pd
from dataclasses import make_dataclass
import pyarrow.feather as feather

Point = make_dataclass("Point", [('tag', str), ('x', float), ('y', float)])
df = pd.DataFrame([Point('tl', 1.0, 1.0), Point('br', 3.0, 4.0)])
feather.write_feather(df, '/tmp/point_data.arrow) 
```

# ruby-on-rails - 在 Ruby 和 Rails 中阅读 PDF、DJVU 格式

> ID：11129847
> 
> 赞同：1
> 
> 时间：2012-06-21T00:00:23.287
> 
> 标签：ruby-on-rails, ruby, pdf, djvu

在 Ruby/Ruby On Rails 中使用 PDF 和 DJVU 格式的最佳方法是什么？我需要的是获取页数并获取特定页面的图片。未来还会有更多的案例。

现在，我为此使用命令提示符（DJVU 为 djvulibre，PDF 为 gs）。它工作正常，但如果有更可取的工具？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T00:09:11.893

**[Prawn](http://prawn.majesticseacreature.com/)** Ruby gem 应该可以满足您的需求，而Djvu **[-tools](https://rubygems.org/gems/djvu-tools)**是我听说过的唯一用于`djvu`文件的工具。

此外，其他一些有趣的 pdf 选项包括[rails-latex](https://github.com/jacott/rails-latex)一个漂亮的小框架，用于 Rails 服务器中的乳胶文件。Latex 包括一些非常有趣的库，例如[TikZ/Pgf](http://www.texample.net/tikz/examples/all/)，它们可以生成漂亮的文档，在`html`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T06:47:50.913

ruby-poppler 绑定可以将 PDF 渲染为 JPG。有关一些示例代码，请参阅我在 [1] 中的回答。

[1][在Ruby Search PDF中，突出显示找到的文本，导出页面的JPG](https://stackoverflow.com/questions/7000785/in-ruby-search-pdf-highlight-text-found-export-jpg-of-the-page/7019828#7019828)

# html - 字体 css 在字体样式正常的地方显示粗体，但仅在某些页面上

> ID：11129849
> 
> 赞同：-2
> 
> 时间：2012-06-21T00:00:46.233
> 
> 标签：html, css, wordpress

我已经建立了一个 wordpress 网站，客户报告说除联系页面外，所有页面上的主导航字体都是粗体。

我无法复制这种行为，但她向我发送了屏幕截图以显示正在发生的事情。她正在使用 Safari 版本 5.1.5。

所以我想我正在寻找关于我忽略的代码中的任何错误的反馈，以及她看到这个是否有合理的原因。

这是网址：[http ://www.elevatevitality.com.au](http://www.elevatevitality.com.au)

感谢任何反馈或帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T00:15:31.523

我检查了 Safari 5.1.5 并没有看到任何粗体副本。这可能是她特定机器上的设置，但您始终可以尝试设置全局`font-weight: normal;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T00:19:55.537

```
#mainNav {
    margin-top: 125px;
}

nav#menu ul {
    display: block;
    position: absolute;
    top: 53px;
}

nav#menu ul li {
    margin: 0px;
    padding: 0px;
    list-style: none;
    border-bottom: solid 1px #386c65;
    position: relative;
    font-weight: 300;       /* try this */
}

nav#menu ul li a {
    font-size: 19px;
    line-height: 14px;
    color: #DCB215;
    text-decoration: none;
    margin-bottom: 10px;
    padding: 12px 0 0 0;
    display: inline-block;
    font-weight: 300;       /* try this */
} 
```

# phpstorm - 如何从 PHPStorm 的代码检查中排除文件/文件夹？

> ID：11129857
> 
> 赞同：81
> 
> 时间：2012-06-21T00:02:04.897
> 
> 标签：phpstorm

我在 PHPStorm 中有一个项目，其中包含分组在一个`library`文件夹下的几个库（Zend、Doctrine、...）。

运行代码检查时，我*确实*希望分析这些文件夹中的 PHP 代码（`Zend_Form`例如，以便 PHPStorm 知道如何声明）。

但是，我*不*希望报告在这些文件夹中发现的问题，因为它们超出了我的控制范围。

到目前为止，我发现的唯一解决方法是将目录标记为“测试源”，并取消选中代码检查窗口中的“包含测试源”框。不用说，这不是最好的解决方案！

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2015-01-21T21:42:25.877

如果您只需要禁用对一两个文件的检查，您可以轻松地在文件级别禁用它：

1.  打开有问题的文件
2.  单击“代码”->“配置当前文件分析”
3.  将违规语言的滑块设置为“无”

（使用 PHPStorm 8.0.2）

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2012-06-21T10:33:14.600

请参阅[范围功能](http://www.jetbrains.com/phpstorm/webhelp/scope.html)。您可以只为您的代码定义自定义范围，而无需库文件夹，然后仅在此范围上运行检查。

在[检查设置中](http://www.jetbrains.com/phpstorm/help/inspections.html)，还可以添加范围并启用/禁用每个范围的每个检查。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2015-04-08T12:30:57.677

如果您需要从任何分析中完全排除少数文件（例如编译的 php 文件），甚至不存在，您可以右键单击源树中的文件并选择“标记为纯文本”。此操作完全删除对此文件的任何检查。有了这个，我在 Laravel 5 中删除了很多关于“源重复”的通知。

如果您需要再次激活它 - 再次右键单击并“标记为 PHP”。

这适用于一些文件。如果您需要排除包含所有内容的整个目录，请使用设置中的目录标记或右键单击目录并“将目录标记为 -> 已排除”。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-11-19T13:44:36.427

有替代解决方案。`Include path`您可以在部分中添加«只读»库`Settings » PHP`。

它与 php.ini选项不同，只是将一些目录作为外部引用，不受您的控制**。**`include_path`正是你需要的。

结果

*   范围定义没有问题，如果需要，只需检查整个项目
*   库中没有无用的版本控制开销

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-08-02T00:05:26.013

如果您想从完成和代码帮助中完全排除文件或文件夹：
右键单击文件浏览器中的文件夹或文件（左手）选择“标记”->“排除”

这就是我想要的，我在这里添加了这个答案，因为我在寻找答案时在谷歌中发现了这个问题。

# solr - 自定义 Solr FunctionQueries：任何好的教程

> ID：11129860
> 
> 赞同：2
> 
> 时间：2012-06-21T00:02:39.753
> 
> 标签：solr, lucene, solrj

我正在寻找实现自定义 Solr FunctionQueries。

是否有任何好的教程或分步说明，我发现的唯一一个是[http://www.solrtutorial.com/custom-solr-functionquery.html](http://www.solrtutorial.com/custom-solr-functionquery.html)，它没有很好地解释细节。

我确实知道我需要实现`org.apache.solr.search.ValueSourceParser`and `org.apache.solr.search.ValueSource`，但是它是如何`public DocValues getValues(Map context, IndexReader reader)`工作的？我如何知道此方法中文档的字段值以及如何将其与查询进行比较？

我也尝试了几本书，但都没有实现 FunctionQueries 的示例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-05-14T13:29:08.287

非常老的问题，但对我来说很新。我找到了一个示例项目，而不是分步手册。但对其他人有用。

[siterank 售出自定义查询功能](https://github.com/healthonnet/hon-lucene-siterank)

此示例中有一个 Solr 的自定义函数，它使用外部工具/服务来提供值。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-12-09T01:13:27.963

本教程很简短，但给出了一个很好的主意： http: [//www.solrtutorial.com/custom-solr-functionquery.html](http://www.solrtutorial.com/custom-solr-functionquery.html)

# asp.net-mvc - returnUrl 未传递给 AccountController 中的 LogOn 操作方法

> ID：11129863
> 
> 赞同：1
> 
> 时间：2012-06-21T00:03:11.910
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-mvc-routing

我有一个从 Internet 模板创建的 MVC 应用程序以使用表单身份验证，当用户登录时，我想将他们定向到主页|关于页面。

LogOn 方法是由项目模板创建的，无需修改；

```
 [HttpPost]
    public ActionResult LogOn(LogOnModel model, string returnUrl)
    {
        if (ModelState.IsValid)
        {
           // etc, etc
        }

        return View(model);
    } 
```

我在 Web.config 中设置了 defaultUrl，如下所示；

```
<authentication mode="Forms">
  <forms loginUrl="~/Account/LogOn" timeout="2880" defaultUrl="~/Home/About"/>
</authentication> 
```

但是，当调用 HomeController.LogOn 时，returnUrl 参数始终为空。注意 LogOn 方法上的 HttpPost 属性，因此不能在查询字符串中传递 url。

如何配置返回 url，以便将其传递给 LogOn 操作方法，并在登录后将用户定向到 url 的位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T00:12:04.820

最简单的方法是将 Global.asax 中的默认路由更改为指向`/Home/About`而不是`/Home/Index`

```
public static void RegisterRoutes(RouteCollection routes) {
    routes.IgnoreRoute("{resource}.axd/{*pathInfo}");
    routes.IgnoreRoute("{*favicon}", new { favicon = @"(.*/)?favicon.ico(/.*)?" });

    routes.MapRoute(
        "Default", // Route name
        "{controller}/{action}/{id}", // URL with parameters
        new { controller = "Home", action = "About", id = UrlParameter.Optional } // Parameter defaults
    );
} 
```

# wpf - XAML 如何将其转换为资源而不是长按钮模板

> ID：11129870
> 
> 赞同：0
> 
> 时间：2012-06-21T00:04:16.727
> 
> 标签：wpf, xaml

我在这里有我的按钮，它有一些动画自定义样式，但我有 6 个，我讨厌看整个 xaml，每个按钮有 41 行

```
<Button Width="250" Height="120" HorizontalAlignment="Left" VerticalAlignment="Top" x:Name="btnShutdown" IsDefault="False" BorderThickness="2">
    <Grid VerticalAlignment="Top" HorizontalAlignment="Left" Height="120" Width="250" Background="Red">
        <Image Grid.ColumnSpan="2" Grid.RowSpan="2" Height="120" VerticalAlignment="Center" HorizontalAlignment="Center" Stretch="Fill" Width="120" Source="/SystemPowerShortcuts;component/image_res/shutdown.png" />
        <TextBlock Height="19" HorizontalAlignment="Left" Margin="14,95,0,6" Text="Shutdown" VerticalAlignment="Center" FontSize="12" Width="66" Foreground="White" FontWeight="Normal" />
    </Grid>
    <Button.RenderTransform>
        <RotateTransform x:Name="btnShutdown_Transform" Angle="0" />
    </Button.RenderTransform>
    <Button.Triggers>
        <EventTrigger RoutedEvent="Button.MouseEnter">
            <BeginStoryboard>
                <Storyboard>
                    <DoubleAnimation
                        Storyboard.TargetName="btnShutdown_Transform"
                        Storyboard.TargetProperty="Angle"
                        To="-1" Duration="0:0:0.1" FillBehavior="HoldEnd" />
                </Storyboard>
            </BeginStoryboard>
        </EventTrigger>
        <EventTrigger RoutedEvent="Button.Click">
            <BeginStoryboard>
                <Storyboard>
                    <DoubleAnimation
                        Storyboard.TargetName="btnShutdown_Transform"
                        Storyboard.TargetProperty="Angle"
                        To="-5" Duration="0:0:0.1" FillBehavior="HoldEnd" />
                </Storyboard>
            </BeginStoryboard>
        </EventTrigger>
        <EventTrigger RoutedEvent="Button.MouseLeave">
            <BeginStoryboard>
                <Storyboard>
                    <DoubleAnimation
                        Storyboard.TargetName="btnShutdown_Transform"
                        Storyboard.TargetProperty="Angle"
                        To="0" Duration="0:0:0.3" FillBehavior="HoldEnd" />
                </Storyboard>
            </BeginStoryboard>
        </EventTrigger>
    </Button.Triggers>
</Button> 
```

你如何将它转换为资源，所以我没有很长的 xaml 代码？

按钮具有自定义图像和文本，但具有相同的动画

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T00:22:24.120

创建一个资源字典（添加新项目 -> 资源字典），然后为您的按钮制作样式和模板，如下所示：

```
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Style x:Key="ButtonStyle" TargetType="Button">
        <Setter Property="Height" Value="120" />
        <Setter Property="Width" Value="250" />
        <Setter Property="RenderTransform">
            <Setter.Value>
                <RotateTransform x:Name="btnTransform" Angle="0" />
            </Setter.Value>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border BorderThickness="2" BorderBrush="Black" Background="Red">
                        <Grid VerticalAlignment="Top" HorizontalAlignment="Left"
                              Height="120" Width="250">
                            <Image Grid.ColumnSpan="2" Grid.RowSpan="2" Height="120"
                                   VerticalAlignment="Center"
                                   HorizontalAlignment="Center" Stretch="Fill"
                                   Width="120"
                                   Source="/SystemPowerShortcuts;component/image_res/shutdown.png" />
                            <TextBlock Height="19" HorizontalAlignment="Left"
                                       Margin="14,95,0,6" Text="Shutdown"
                                       VerticalAlignment="Center" FontSize="12"
                                       Width="66" Foreground="White"
                                       FontWeight="Normal" />
                        </Grid>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <EventTrigger RoutedEvent="Button.MouseEnter">
                <BeginStoryboard>
                    <Storyboard>
                        <DoubleAnimation
                            Storyboard.TargetName="btnTransform"
                            Storyboard.TargetProperty="Angle"
                            To="-1" Duration="0:0:0.1" FillBehavior="HoldEnd" />
                    </Storyboard>
                </BeginStoryboard>
            </EventTrigger>
            <EventTrigger RoutedEvent="Button.Click">
                <BeginStoryboard>
                    <Storyboard>
                        <DoubleAnimation
                            Storyboard.TargetName="btnTransform"
                            Storyboard.TargetProperty="Angle"
                            To="-5" Duration="0:0:0.1" FillBehavior="HoldEnd" />
                    </Storyboard>
                </BeginStoryboard>
             </EventTrigger>
            <EventTrigger RoutedEvent="Button.MouseLeave">
                <BeginStoryboard>
                    <Storyboard>
                        <DoubleAnimation
                            Storyboard.TargetName="btnShutdown_Transform"
                            Storyboard.TargetProperty="Angle"
                            To="0" Duration="0:0:0.3" FillBehavior="HoldEnd" />
                    </Storyboard>
                </BeginStoryboard>
            </EventTrigger>
        </Style.Triggers>
    </Style>
</ResourceDictionary> 
```

然后将您的资源字典添加到您的 App.xaml 文件中：

```
<Application ...>
    <Application.Resources>
        <ResourceDictionary Source="FileNameHere.xaml"/>
    </Application.Resources>
</Application> 
```

然后为每个按钮放置

```
<Button Style="{DynamicResource ButtonStyle}" ... /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T01:21:43.040

你最好创建一个自定义控件。通过这种方式，您可以设置依赖属性来控制图像的来源等。如果您只是将其设置为资源字典中的样式，那么您会使用相同的图像等。请参阅这篇[文章](http://msdn.microsoft.com/en-us/library/cc295235.aspx)以了解如何做到这一点。

# matlab - 将 matlab 向量中的行移动到新维度

> ID：11129872
> 
> 赞同：1
> 
> 时间：2012-06-21T00:04:24.990
> 
> 标签：matlab, vector, multidimensional-array, matrix, reshape

我有矢量图

```
output = PV_out(:); 
```

我试图将其分解为某种形式，例如 - output(K) 其中 output(1) 是前 8760 行，输出 (2) 是接下来的 8760 行等

上面的向量是一个 236520x1 向量，所以我试图获得 27 个“组”矩阵有谁知道该怎么做？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T00:26:35.677

这是[重塑](http://www.mathworks.com/help/techdoc/ref/reshape.html)的工作：

```
%# old_output is 236520x1
%# desired is 8760 x 1 x 27 matrix 
new_output = reshape(old_output,8760,1,[]);
size(new_output) %# [8760 1 27]
   ans = [8760 1 27] 
```

这将创建一个 8760x1x27 矩阵，其中每一行都是从给定的向量中按顺序获取的。*请注意，如果您给它一个矩阵*作为第一个输入参数（而不是一个*向量*） ，您应该小心：您应该确保您知道取值的顺序。（留空`[]`意味着它将自动为该维度选择正确的大小。如果`numel`输入的 不能被您指定的维度整除，您仍然会遇到错误。）

编辑：根据下面的评论更改尺寸。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T00:12:36.960

长度 = 8760;

out = zeros(len,27);

对于 i=1:27 out(:,i) = output((i-1)*len + 1 : i*len); 结尾

# facebook - C# 中的 Facebook 登录

> ID：11129874
> 
> 赞同：0
> 
> 时间：2012-06-21T00:04:34.943
> 
> 标签：facebook, login

我的问题对其他人来说可能很简单。我只需要一个登录，就像 Stack Overflow 一样。

我在谷歌搜索我找不到至少接近我的查询。我在这里使用 Facebook 的示例：http: [//developers.facebook.com/docs/guides/web/#plugins](http://developers.facebook.com/docs/guides/web/#plugins)

但我无法继续下一个显示个人资料图片附加信息等的内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T00:07:38.120

看看 Facebook 图表：[https ://developers.facebook.com/docs/reference/api/](https://developers.facebook.com/docs/reference/api/)

# python - 如何使用 Python 更改文件的权限/属性以使其在 Windows 中不可读

> ID：11129879
> 
> 赞同：0
> 
> 时间：2012-06-21T00:05:08.253
> 
> 标签：python, windows, permissions, attributes

我正在尝试测试一些代码，为了测试它，我需要在特定位置获取异常：

```
def makeThisFunctionReturnTrue(filename):
    if os.path.exists(input) and os.path.isfile(filename):
        try: 
            open(filename, "r")
        except IOError, err:
            return True
    return False 
```

我需要弄清楚什么输入文件名会导致上述函数返回 True。我认为解决方案在于更改文件中的权限或属性。我可以通过 Windows 资源管理器进入文件的属性，然后进入安全性，然后拒绝权限，手动强制错误。但是，我需要能够在 Python 中动态创建文件，然后通过 Python 更改权限以强制出错。

我的第一个想法是使用 os.chmod(); 但是，此功能在 Windows 环境中似乎受到限制。

我的一位同事建议我使用 win32file.SetFileAttributes()，但我找不到关于此函数的任何好的文档。

谢谢您的帮助。

迦勒·鲁洛

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T00:42:02.457

自己提出异常

```
raise IOError('SUITABLE INFO HERE') 
```

# java - Java Swing：有标准的衰落率吗？

> ID：11129881
> 
> 赞同：3
> 
> 时间：2012-06-21T00:05:21.940
> 
> 标签：java, swing, animation, fading

目前，我正在以`0.1 alpha/second`. 我在网上阅读了一些使用`0.03 alpha/second`. 是否有组件应该淡入/淡出的标准速率？有标准的过渡动画率吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T00:26:28.113

我不相信这样的标准存在并且将永远存在，原因如下：

*   这主要是主观的
*   这取决于应用程序的速度。如果您的应用程序很慢，您宁愿放一个缓慢的效果以符合其余的要求或掩盖缓慢
*   这取决于组件内部的内容。例如，当您单击“确定”时，咆哮通知会慢慢消失，而警报框会迅速消失，这是有道理的
*   褪色只是一种效果，只要它不影响功能体验，它就不会对您的用户产生太大影响（例如，在它发生时避免您使用其他功能的 looong 褪色）。

# objective-c - 基于选项卡的应用程序的默认登陆 uiview

> ID：11129883
> 
> 赞同：0
> 
> 时间：2012-06-21T00:05:44.767
> 
> 标签：objective-c, ios, xcode, cocoa-touch

我有一个带有 2 个标签的应用程序。

在第一个选项卡中，uiview1 有两个按钮。每次按下按钮 1 时，都会将一个项目添加到数组中的对象中。按钮 2 是一个连接到 uiview2 的按钮。uiview2 有 uitableview，其中包含数组中的对象数量，以及一个连接到 uiview3 的按钮。

我注意到应用程序工作的默认方式是在导航到不同的选项卡后，选项卡的当前视图仍然存在。我想创建一个默认登陆uiview。

我想这样做，如果我从 tab1 导航并返回，则根据数组中的对象数量，加载的视图是 uiview1（您必须在其中创建对象）或 uiview2（其中

伪代码

```
if (moving from tab2 to tab1)
{
    if(number of objects > 0)
    {
        load uiview2;
    }
    else 
    { 
        load uiview1; 
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T01:00:25.380

我建议不要破坏 UITabBarController 的默认行为，但如果你真的想这样做，你可以实现[UITabBarDelegate](http://developer.apple.com/library/ios/DOCUMENTATION/UIKit/Reference/UITabBarDelegate_Protocol/)方法。

```
- (void)tabBar:(UITabBar *)tabBar didSelectItem:(UITabBarItem *)item {
    // logic here

    // this is how you could "pop" to one of the two view controllers
    [self.navigationController popToViewController:uiviewcontroller1 animated:NO];
    [self.navigationController popToViewController:uiviewcontroller2 animated:NO];
} 
```

# python - 检查字典中键的存在是否比在 Python 中捕获 KeyError 更好？

> ID：11129885
> 
> 赞同：3
> 
> 时间：2012-06-21T00:06:00.047
> 
> 标签：python, hash, hashmap, hashtable

我在 Python 方面有一些经验，但我正在参加 Udacity 计算机科学课程来填补我所学知识的空白并补充我已经知道的知识。本课程讨论了一个哈希表查找函数，如果键不在哈希表中，则该函数返回 None 作为键的值。当键不存在时，Python 的字典类型会抛出 KeyError，因此课程说`key in mydict`在获取其值之前使用。

我想知道是否这样做更好：

```
mydefaultval = 75
key = ..
mydict = ..
if key in mydict:
    val = mydict[key]
else:
    val = mydefaultval 
```

.. 或者

```
mydefaultval = 75
key = ..
mydict = ..
try:
    val = mydict[key]
except KeyError:
    val = mydefaultval 
```

我想Python要检查密钥是否存在，它必须在字典中找到它。如果我然后抓住那个键的值，它必须做同样的事情两次。我的想法是正确的，还是 Python 会做其他事情？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-21T00:07:10.367

最好的办法是使用 dict.get：

```
val = my_dict.get(key, mydefaultval) 
```

如果没有像这样很棒的方法，我建议使用异常。Python 文化是不禁止异常，而且通常显式检查实际上会捕获异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T01:31:55.550

如果每次使用特定 dict 时默认值都相同，则另一种选择是使用`collections.defaultdict`. 声明字典比`dict.get()`解决方案更冗长，但使用更简洁：

```
>>> from collections import defaultdict
>>> mydict = defaultdict( lambda: 75 )
>>> mydict[3]
75 
```

# iphone - 更改页面时停止显示 iphone safari 地址栏

> ID：11129887
> 
> 赞同：2
> 
> 时间：2012-06-21T00:06:26.723
> 
> 标签：iphone, css, mobile, safari

我有一个移动网站，当用户在移动 Safari 中点击我网站中的链接时，我想停止弹出地址栏，例如

在：example.org/foo

单击链接，转到：example.org/bar

注意：URL 地址是使用历史推送状态 API 更新的，因此不会加载新页面，只会更新 URL。

当前地址栏随着页面的变化而弹出。在移动 Twitter 应用程序中，当您单击并更改页面时，地址栏不会弹出，即使他们也在更新 URL。

在页面更改期间如何阻止地址显示的任何想法（不是在页面加载后，这是我找到的所有其他链接所指的）。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-21T00:15:41.447

虽然这不是解决您的问题的方法，但我可以解释移动 Twitter 是如何实现这一点的，因为我必须针对我构建的响应式网站对其进行研究。

移动 Twitter 根本不使用链接。相反，它们将事件绑定到其他元素（在本例中`<li>`为元素），这些元素会更改显示的内容并使用[HTML5 推送状态](http://diveintohtml5.info/history.html)来更新 URL 栏。

因此，我能看到的唯一解决方案是尽可能为移动设备构建一个单独的版本。

* * *

PS 此外，在移动特定网站上检查代码的最简单方法是使用 Safari 并在“开发”菜单下更改用户代理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T06:02:14.650

此链接准确显示了您正在寻找的内容：http: [//jmperezperez.com/prevent-iphone-navigation-bar-ajax-link-click/](http://jmperezperez.com/prevent-iphone-navigation-bar-ajax-link-click/)。

[演示（下面的代码）](http://josemanuelperez.es/links.html)的唯一问题是它`#`为每个链接添加了一个哈希，从而破坏了导航。如果有人知道解决方法，我将不胜感激。

HTML：

```
<ul>
  <li>
      <a class="prevent" href="/">
           This link is ignored. However, it shows the bar
      </a>
  </li>
  <li>
      <a class="facebook" href="/blog">
           This link is ignored. It does not show the bar, 
           and modifies the hash tag.
      </a>
  </li>
</ul> 
```

JS：

```
//hide bar on page load
setTimeout(function () {  window.scrollTo(0, 1);}, 500);

//attach event touchend
    document.addEventListener('touchend',
        function(e) {
        var target = e.target;
        while(target.nodeName !== 'A' && target.nodeName !== 'BODY') {
        target = target.parentNode;
    }
    if (target.nodeName === 'A' &&
        target.className === 'facebook') {
            target.href = '#!' + target.getAttribute('href');
        }
    },
        false
    );

    //attach event click
    document.addEventListener('click',
        function(e) {
        if (e.target.nodeName === 'A') {
            if (e.target.className === 'prevent') {
                e.preventDefault();
            } else if (e.target.className === 'facebook') {
                      var href = e.target.getAttribute('href');
                if (href.indexOf('#!') === 0) {
                    var newHref = href.substr(2);
                    e.target.href = newHref;
                    location.hash = newHref;
                    e.preventDefault();
                }
            }                       
        }
    },
        false
); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T22:14:41.050

尝试在您的网址末尾添加井号 (#)。我遇到了相反的问题，即页面加载后地址栏向上滑动。当我尝试计算我得到的数字低于预期的客户端高度时，这导致了一个问题。该数字恰好是地址栏高度的大小。我花了几个小时才弄清楚我偶然通过的网址最后有一个#。当ii删除它时，地址栏保持在原位而不是向上滑动。所以尝试在你的 url 末尾添加一个 # 并看看会发生什么。

如果您想保持地址栏可见。这也意味着您不应该将页面锚点用于页面导航。相反，您将不得不使用 onclick 事件和 scrollTo(0,height)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T02:08:35.250

看到您对更新 url 的评论只是*没有*导航到新页面，您应该能够摆脱这个 JS 捎带链接点击/历史更新处理程序：

```
window.scrollTo(0, 1); 
```

如果 URL 更新有效地代表一个全新的页面（而不是将新的分页内容加载到表格等中），这将是合适的

[javascript 方法](http://davidwalsh.name/hide-address-bar)与设备无关，不依赖最终用户的任何进一步操作（与[元标记解决方案](https://stackoverflow.com/q/6011223/1081234)不同）

# ruby-on-rails-3 - 是否有基于环境过滤代码的资产管道兼容引擎？

> ID：11129892
> 
> 赞同：0
> 
> 时间：2012-06-21T00:07:42.113
> 
> 标签：ruby-on-rails-3, asset-pipeline, sprockets

我想看到这样的东西：

1.  适用于 Haml、Sass、CoffeeScript、JavaScript。
2.  我可以用类似`@development@`.
3.  在开发中，这些行将正常输出（`@development@`删除前缀和后面的一个空格）
4.  在生产中，这些生产线根本不会输出。

我想象我的文件名会从`foo.html.haml`to`foo.html.haml.envtoggle`或类似的东西改变，以支持此功能。

有这样的东西存在吗？我不想重新发明轮子。如果没有，构建它的一些指针是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T06:15:25.633

您可以编写一个自定义处理器来执行此操作，从[Tilt](https://github.com/rtomayko/tilt)开始。Tilt 是 Sprockets 使用的模板处理器。Sprockets 是管道的核心。

唯一棘手的一点是整理事物的环境处理方面。

您是否考虑过仅将管道文件用于仅包含在开发布局中的仅开发代码？

# asp-classic - excel电子表格的正确格式

> ID：11129893
> 
> 赞同：0
> 
> 时间：2012-06-21T00:07:52.323
> 
> 标签：asp-classic, vbscript, excel, vba

> **可能重复：**
> [创建 excel 电子表格](https://stackoverflow.com/questions/10921277/create-excel-spreadsheet)

文档的正确格式是什么，以便在 excel 中被识别？如果您手动创建它，什么字符表示列的结尾和/或创建新行？

我正在手动创建一个 .xls 文件，使用文件系统并用数据填充它。但是，我不知道 excel 期望什么。不，我不想创建 .csv 文件，因为我不希望用户在打开它时被要求对其进行格式化。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T07:26:36.760

Xls（以及其他类型的 Excel 2007/2010 是二进制文件，您无法像那样轻松创建，您需要使用 Com 对象来创建和操作它们。这里是脚本[专家 http://blogs.technet 的示例。 com/b/heyscriptingguy/archive/2005/01/31/how-can-i-make-changes-to-and-then-re-save-an-existing-excel-spreadsheet.aspx](http://blogs.technet.com/b/heyscriptingguy/archive/2005/01/31/how-can-i-make-changes-to-and-then-re-save-an-existing-excel-spreadsheet.aspx)

```
Set objExcel = CreateObject("Excel.Application")
objExcel.Visible = True
objExcel.DisplayAlerts = FALSE

Set objWorkbook = objExcel.Workbooks.Add
Set objWorksheet = objWorkbook.Worksheets(1)

objWorksheet.Cells(1, 1).Value = Now
objWorkbook.SaveAs("C:\Scripts\Test.xls")
objExcel.Quit 
```

有关您可以使用的 vba 函数列表，请参阅[http://msdn.microsoft.com/en-us/library/aa223697(v=office.11 ​​).aspx](http://msdn.microsoft.com/en-us/library/aa223697(v=office.11).aspx)

例如自动格式化所有列是这样的

```
objWorksheet.columns.autofit; 
```

# java - Hazelcast 计划作业（Quartz 支持？）

> ID：11129896
> 
> 赞同：8
> 
> 时间：2012-06-21T00:08:15.867
> 
> 标签：java, spring, quartz-scheduler, terracotta, hazelcast

我知道这对兵马俑是不公平的，但是有没有人尝试使用 Hazelcast 来在集群环境中使用预定的作业？

我可以想象的最简单的实现是以下架构：

1.  全局 Hazelcast 锁，用于确保**只有一台服务器**启动 Quartz 配置。
2.  将实际任务作为 DistributedTask 运行。（这可以稍后完成，目前繁重的计划任务需要处理触发 DistributedTask）
3.  一旦持有锁的服务器关闭，另一台服务器就会获得锁。

我相信这对于已经拥有 Hazelcast 的人来说将是一个很大的优势，因为他们不需要通过一直打开兵马俑的东西来解决整个开发环境的麻烦。

目前，我编写了最简单的解决方案，即只让一个节点负责执行 Quartz 触发器。由于我只使用类似 Cron 的触发器，因此如果我负责为繁重的触发器任务创建 DistributedTasks，它可能是一个可接受的解决方案。

这是实现它的我的 org.springframework.scheduling.quartz.SchedulerFactoryBean 扩展：

```
@Override
public void start() throws SchedulingException {
    new Thread(new Runnable() {
        @Override
        public void run() {
            final Lock lock = getLock();
            lock.lock();
            log.warn("This node is the master Quartz");
            SchedulerFactoryBean.super.start();
        }
    }).start();
    log.info("Starting..");
}

@Override
public void destroy() throws SchedulerException {
    super.destroy();
    getLock().unlock();
} 
```

请让我知道我是否遗漏了一些重要的东西，如果可以做到这一点。

我已将这两个文件添加到 github。这是 RAMJobStore 扩展：

[https://github.com/mufumbo/quartz-hazelcast/blob/master/src/main/java/com/mufumbo/server/scheduler/hazelcast/HazelcastRAMJobStore.java](https://github.com/mufumbo/quartz-hazelcast/blob/master/src/main/java/com/mufumbo/server/scheduler/hazelcast/HazelcastRAMJobStore.java)

这是 Spring SchedulerFactoryBean 扩展：

[https://github.com/mufumbo/quartz-hazelcast/blob/master/src/main/java/com/mufumbo/server/scheduler/hazelcast/SchedulerFactoryBean.java](https://github.com/mufumbo/quartz-hazelcast/blob/master/src/main/java/com/mufumbo/server/scheduler/hazelcast/SchedulerFactoryBean.java)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-21T15:50:56.983

前段时间我也在考虑同样的概念。您实际上可以通过实现SPI 接口轻松`Hazelcast`集成。查看有关如何基于内存数据结构和集群、数据库支持的存储实现作业存储的参考资料。`quartz-scheduler``JobStore`[`RAMJobStore`](http://quartz-scheduler.org/api/2.1.5/org/quartz/simpl/RAMJobStore.html)[`JobStoreTX`](http://quartz-scheduler.org/api/2.1.5/org/quartz/impl/jdbcjobstore/JobStoreTX.html)

这个界面相当大，但它应该是从 RAM 或 Terracotta 切换到 Hazelcast 所需的唯一地方。后一个库已经提供了分布式存储和锁，所以它应该相当简单。

如果你能分享你的实现（GitHub？），那就太棒了，猜猜对于许多人来说，这将是一个可行的 Terracotta 集群替代方案。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-03-26T17:10:30.797

从版本开始，`3.8`您可以简单地使用分布式`Scheduled Executor Service`：

*   `scheduleOnMember()`
*   `scheduleOnKeyOwner()`
*   `scheduleOnAllMembers()`
*   `scheduleOnAllMembers()`

请参阅[计划执行服务](http://docs.hazelcast.org/docs/3.8/manual/html-single/index.html#scheduled-executor-service)和[`IScheduledExecutorService`](http://docs.hazelcast.org/docs/3.8/javadoc/com/hazelcast/scheduledexecutor/IScheduledExecutorService.html)更多详细信息。

# iphone - 如何从另一个控制器获取 bounds.size 值

> ID：11129898
> 
> 赞同：0
> 
> 时间：2012-06-21T00:08:27.660
> 
> 标签：iphone, objective-c

我正在学习objective-C，但我陷入了特定的境地。弄清楚以下情况：

> **控制器A**

*   它有 ControllerA.h、ControllerA.m 和 ControllerA.xib 文件。

*   ControllerA.xib 的类与另一个控制器相关联。让我们说ControllerB。因此，如果您选择 ControllerA.xib 文件，请单击“身份检查器”并转到“自定义类”，该类是“ControllerB”而不是 UIView。

*   从 ControllerA.m 我无法访问视图的任何参数，例如 self.bounds.size.height。但是我可以从这个 xib 文件中创建的对象访问任何参数，例如 UILabel

> **控制器B**

*   它有 ControllerB.h、ControllerB.m 和无 ControllerB.xib 文件。

*   从 ControllerB.m 我可以访问 self.bounds.origin.x、self.bounds.size.width、self.bounds.origin.y、self.bounds.size.height，但我无法访问在 ControllerA 中创建的任何对象。西布。

我曾尝试使用 Delegate 解决此问题，但未能将信息从一侧传递到另一侧。我想将 UIView 类保留为 ControllerB。拜托，我需要一些帮助，有人可以帮助我吗？

谢谢，

佩德罗。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T00:23:11.950

如果您想将一些数据从控制器 A 传递到控制器 B，反之亦然，请执行以下操作：

```
//Controller1 Header (.h) File
@property (nonatomic, strong) SomeClass *anObject;

//Controller1 Implementation (.m) File
@synthesize anObject;

//Controller2 Header (.h) File
#import "Controller1.h"
 -(id)getController1Object;

//Controller2 Implementation (.m) File
-(id)getController1Object{
    return Controller1.anObject;
} 
```

希望这可以帮助！

# grails - 如果登录尝试中我的应用程序的浏览器中没有以前的 JSESSIONID cookie，则 springSecurityService.reauthenticate 不起作用

> ID：11129899
> 
> 赞同：0
> 
> 时间：2012-06-21T00:08:45.037
> 
> 标签：grails, spring-security

这是一个奇怪的问题，但我可以 100% 地重现它。

根据[使用 Grails Spring Security 自动登录](https://stackoverflow.com/questions/7114195/login-automatically-with-grails-spring-security)，推荐的以编程方式登录用户的方法是使用 springSecurityService.reauthenticate(username)，这在注册确认后在 Spring-Security-UI 插件中使用。

但是我的应用程序有这种非常奇怪的行为，它似乎没有立即生效（我尝试立即重定向到经过身份验证的页面），但前提是之前没有从该浏览器在我的域上进行过登录尝试。注意我在我的代码和 spring-security-ui '验证注册'中都看到了这种行为，它使用这种方法来登录用户。

为了澄清，如果我：

1.  清除 my.domain.com 的 JSESSIONID cookie（我的 grails 应用程序在这里运行，但我也可以在 localhost 上重现）
2.  点击控制器输入用户ID，提交时应自动登录用户，然后将他们重定向到他们需要登录的页面
3.  我最终不是在页面上，而是被踢到登录屏幕（如果您尝试在没有身份验证的情况下访问该页面，就会发生这种情况）。请注意 URL 上的 jsessionid（当然它每次都会更改），我没有把它放在那里。[https://my.domain.com/login/auth;jsessionid=B1C9A849E222476A9C9987923D439D13](https://my.domain.com/login/auth;jsessionid=B1C9A849E222476A9C9987923D439D13)
4.  *请注意，这似乎*不是我在登录生效之前重定向的竞争条件，就好像我尝试手动进入经过身份验证的页面一样，它仍然失败。我只是没有登录。

*注意*在步骤 2 中点击控制器，或任何其他控制器实际上确实会立即给我一个 JSESSIONID，其值与 URL 上的值不同。

但是，如果我：

1.  确保我有一个***来自先前登录尝试的 JSESSIONID cookie，无论成功与否***。确保我已注销。
2.  从上面重复步骤 2（对于任何用户，而不是第一次尝试的用户）
3.  一切都按预期工作！我已成功登录并在需要身份验证的页面上。在我再次清除该 cookie 之前，它将继续为任何未来的尝试工作。

我很困惑。不知何故，我得到了冲突的 JSESSIONID 值。在调用 springSecurityService.reauthenticate(username) 之后但在调用 redirect(...securepage...) 之前是否需要做其他事情。请注意，我确实使用了通道安全性，它在整个重定向过程中在 http 和 https 之间反弹 - 但我不确定这与仅在之前进行过一次身份验证尝试时才工作的奇怪行为有何关系。

***请注意***，通过登录屏幕使用用户名和密码进行的正常登录首次使用干净的 cookie。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T21:55:55.183

对于遇到此问题的任何人，问题与此问题[Tomcat 直接相关，从 HTTPS 移动到 HTTP 时保持会话](https://stackoverflow.com/questions/4635425/tomcat-keep-session-when-moving-from-https-to-http)，而不是 springSecurityService.reauthenticate。我的登陆页面是 https，这导致了一个“安全”的 JSESSIONID cookie，但是在重新认证后，我引导用户访问的安全页面是 http，并且会话不再存在。通过通过通道安全强制 https 到所有用户“登录”的目标页面来解决。

# drupal - 防止通过 .install 文件启用/禁用模块

> ID：11129903
> 
> 赞同：1
> 
> 时间：2012-06-21T00:09:14.103
> 
> 标签：drupal, drupal-6, drupal-hooks

我编写了一个模块，该模块依赖于 settings.php 中 $conf 中的覆盖值。具体来说，它是在 $conf[session_inc] 中设置的自定义会话处理程序

此覆盖需要存在才能使模块工作，并且在禁用/卸载模块时绝对不需要存在。

有没有办法从 .install 文件中停止启用/禁用过程？我需要强制用户在这些操作之前正确配置 settings.php。启用/禁用挂钩的返回值显然被忽略了。

我需要防止用户锯掉他们坐在的树枝:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-20T12:05:56.630

这是一些基于设置文件中的某些变量来防止启用模块的示例：

```
/**
 * Implements requirements().
 */
function hook_devel_requirements($phase) {
  $requirements = array();
  // Ensure translations don't break at install time
  $t = get_t();

  if ($phase == 'install') {
    global $conf;
    if ($conf["my_environment"] == 'live') {
      $requirements['mymodule'] = array(
        'title' => $t('Custom Devel'),
        'value' => $t('This module should not be enabled on Production, sorry!'),
        'severity' => REQUIREMENT_ERROR,
      );
    }
  }
  return $requirements;
} 
```

它正在寻找`$conf['my_environment']`设置文件中定义的全局变量。如果它设置为“live”，它会阻止模块被启用。

请记住更改`hook`并更改`mymodule`为您适当的模块名称。该代码应在`.install`文件中使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-29T20:05:03.847

您可以在初始安装之前 ( ) 和状态检查期间( ) 实施`hook_requirements()`要求设置。`install``runtime`

在 .install 文件中似乎无法防止您的模块被禁用。也许，相反，`module_exists()`如果您的模块被禁用，您可以在会话处理程序中检查并路由回默认处理程序？

# java - 哪个更快：创建一个新数组或遍历现有数组？

> ID：11129911
> 
> 赞同：2
> 
> 时间：2012-06-21T00:11:36.597
> 
> 标签：java, c++, arrays, initialization

我有一个数组，例如（在 Java 中）

```
int[] a = new int[N]; 
```

我已经使用它，现在想要有零数组。什么会花费更少的时间：创建一个新数组（它将被初始化为零）或遍历现有数组并用零填充？

我想无论答案是什么，在 C++ 中都是一样的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T00:16:35.813

与创建新数组相比，填充现有数组可能会更好。相对而言，内存分配可能非常昂贵。实际上，如果您最喜欢的语言为您提供了保证清零的新数组，那么它可能会在幕后为您填充它们。

也就是说，这种类型的选择是一种微优化。在大多数情况下，它不会产生任何明显的差异。而且，如果您发现自己处于认为它可能会产生重要影响的特定情况下，那么您最好询问分析器而不是询问 StackOverflow。

**编辑**我将再添加一个警告：特别是在像 Java 这样的垃圾收集语言中，如果可以干净地完成重用，则最好重用现有对象而不是创建新对象。作为一般经验法则。

**重新编辑**...除非所讨论的对象预计寿命很短。可能还有一些额外的警告。所以回到“询问分析器”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T00:17:05.027

当创建一个新数组并用零实例化它时，它应该更慢。在这种情况下，初始化和迭代完成。在使用现有数组的情况下，只完成迭代位。因此，使用现有数组并对其进行迭代应该更快。当然，我们这里说的是ms，一个新Array的初始化一般不会花很长时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T00:24:33.090

这是一个以 Java 为中心的答案，因为我没有 C++ 经验。

它可能会有所不同，具体取决于您选择的方法。根据 Joshua Bloch 的*Effective Java*：

最好“ **......更喜欢原语而不是装箱的原语，并注意无意的自动装箱**”。

这意味着一个数组分配为

```
int[] array = new int[1000]; 
```

将具有更小的内存占用并且创建速度比

```
Integer[] array = new Integer[1000]; 
```

由于不需要对对象`int`内的值进行自动装箱。`Integer`

另外，请记住，**构造函数很少做显式工作的小对象的创建和回收成本很低，尤其是在现代 JVM 实现上**。

简而言之，这真的没关系。如果您对测试进行基准测试，如果差异超过几微秒，我会感到惊讶。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T00:34:32.607

我已经测试过了。

```
public class Test{
  public static void main(String[] args)
 {
    int[] b = new int[1000000];
    for(int i = 0; i < b.length; i++)
        b[i] = i;

    long t1 = System.currentTimeMillis();
    int[] a = new int[1000000];
    long t2 = System.currentTimeMillis();
    System.out.println("Time to alloc: " + (double) (t2 - t1) / 1000);

    long t3 = System.currentTimeMillis();
    for(int i = 0; i < b.length; i++)
        b[i] = 0;
    long t4 = System.currentTimeMillis();
    System.out.println("Time to iterate: " + (double) (t4 - t3) / 1000);

 }
}
/*output
Time to alloc: 0.004
Time to iterate: 0.001
*/ 
```

所以我们的迭代速度比分配新快大约 4 倍。

# git - Git Extensions + Git For Windows：获取本地不存在的分支不会创建新的本地分支

> ID：11129913
> 
> 赞同：5
> 
> 时间：2012-06-21T00:11:43.030
> 
> 标签：git, git-extensions

我在 Git For Windows（以前称为 msysgit）1.7.10.msysgit.1 上运行 Git Extensions 2.32。

另一个用户创建了一个新分支并将其推送到远程存储库。我想将该新分支提取到我的本地存储库。

[这张图片](http://i.imgur.com/AFZUs.png)显示了我正在尝试做的事情。主当前已签出，另一个用户添加了一个新分支“brentfo”，他已将其推送到远程存储库。我现在想将该新分支提取到我的本地存储库。

我打开 Git Extensions Pull 对话框，如图所示。我使用合并选项“不合并，仅获取远程更改”从源中提取，选择新的远程分支“brentfo”。当我单击 Pull 按钮时，我会看到一个进度对话框：

```
c:\Program Files (x86)\Git\bin\git.exe fetch --progress "origin" +refs/heads/brentfo
Done
From //dnzchfile1/git-chch$/mRouteDotNET
 * branch            brentfo    -> FETCH_HEAD 
```

进度对话框不显示任何错误。该过程似乎正常完成。

FETCH_HEAD 文件显示以下内容：

```
eea033921fea43acf34a5baa380d1666181b56aa        branch 'master' of //server/gitrepo/mRouteDotNET
5e0640e42d04a744aae2e95663a13c0747cacaf1    not-for-merge   branch 'brentfo' of //server/gitrepo/mRouteDotNET
934e6034c526b703ac69b26497e0131f9bb71c2c    not-for-merge   branch 'mRoutePCLib' of //server/gitrepo/mRouteDotNET 
```

然而，当我之后查看提交日志时，似乎什么都没有发生（提交日志出现在上图拉对话框图像的背景中）。新分支 brentfo 尚未在我的本地存储库中创建。当我拉下分支的下拉列表时，仍然只有两个：master 和 mRoutePCLib。

如果在“拉”对话框中我没有选择任何远程分支（即留空），我会得到相同的结果。在这种情况下，进度对话框显示：

```
c:\Program Files (x86)\Git\bin\git.exe fetch --progress "origin" 
Done 
```

在早期版本的 Git Extensions 中，似乎曾经存在与从远程分支创建本地分支有关的错误。但是，查看 Git Extensions 项目[更改日志](https://github.com/spdr870/gitextensions/blob/master/GitUI/Resources/ChangeLog.txt)，问题似乎早在 1.55 版中就已解决。所以我猜我做错了什么。

我知道我可以使用 Git Bash 控制台来获取远程分支并从中创建一个新的本地分支。但是，似乎我应该能够通过 GUI 做到这一点。

我希望得到以下任一方面的答案：

a) 是的，你做错了，你应该这样做（通过 GUI）；或者

b) 这是一个已知问题，您必须从命令行界面 (Git Bash) 执行此操作，直到错误得到修复。

干杯西蒙

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T00:18:21.067

获取只会引入当前分支（以及本地跟踪的分支？有人帮我解决这个问题）中的所有更改以及所有远程分支的*知识*。您真的不希望 fetch 取消您尚未签出的所有分支的所有提交。如果有数千个分支，那就太糟糕了。要签出您还看不到的远程分支，请先获取然后签出分支。

您已经获取了远程分支的存在。

现在你想做

Git 扩展 -> 结帐分支

将其从本地更改为远程。在下拉列表中选择远程分支。说好，它会询问您是否要创建本地分支然后跟踪它。确保单击是。

我建议想办法购买 Smart Git 3。它比所有其他 Windows Git 产品都要好得多。他们有一个免费的开源许可证版本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T03:34:21.303

继 Andrew Finnell 的回答之后：

选择**Git Extensions > Checkout 分支**（从 Windows 资源管理器上下文菜单中）后，将打开**Checkout Branch 对话框**。

选择**Remote branch**和要下拉的远程分支的名称，然后单击**Checkout**。**Checkout Remote Branch 对话框**将打开。

在 Checkout Remote Branch 对话框中，选择**Reset local branch with name '{branch name}'**并确保**Merge**被选中，然后单击**Checkout**：

![签出远程分支对话框](../Images/e657762c0321fdf50f3025d1570454c3.png)

这将创建一个新的本地分支，使用远程分支的更改对其进行更新，并在本地分支和远程分支之间创建映射，以便可以在它们之间推送和拉取更改。

**注意：** 不要选择“使用名称'{remote name}_{branch name}'创建本地分支”。这将创建一个本地分支，但它将以远程存储库的名称为前缀（在上面的示例中，本地分支将被命名为“origin_DSIChanges”而不是“DSIChanges”）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-28T05:35:42.403

是的，你做错了，你应该这样做（通过 GUI）；您正在获取远程分支提交到本地分支，但您还需要将远程分支与本地分支合并。请选择“将远程分支合并到当前分支”选项永远不要选择“仅获取不合并”。

# php - 如何有效地将伪查询存储到他们自己的表中的数据库中，以及如何正确存储具有不同属性的项目？

> ID：11129923
> 
> 赞同：1
> 
> 时间：2012-06-21T00:13:26.807
> 
> 标签：php, mysql

首先，如果标题含糊不清，我想道歉，这个问题很难概括 - 请随时进行适当的编辑。

在我正在构建的网站中，我的类别中的产品（并且类别正在不断扩展）具有属性（我想不出更好的词，我很抱歉这与数据库术语交叉，但我的意思是属性，如颜色、大小、重量，而不是数据库表的字段）。这些属性可能会或可能不会根据类别定义，有时具体取决于产品。

现在，使用该网站的个人将希望创建一个查询来搜索与特定属性匹配的项目（认为“是绿色的，重量小于 4 磅，评级为 3 星或更高”），并将该查询作为元组保存在数据库中他们可以参考的表格。请注意，这些将是最终用户，因此他们将无法自己实际编写查询。另请注意，某些类型的查询可能存在大量冗余，并且这些查询的数量将比项目数量多得多。

* * *

我的第一个想法：

将所有项目存储在一个表 ( `items`) 中，并带有`id`, `category id`, `name`。`attribute_types`用`id`, `name`,存储属性类型`type`（可以是 int、string、enum 等）。`item_id`使用、`attribute_type_id`和将属性存储在单独的表中`value`。

然后，根据 HTML 选择创建查询，就好像我实际上是在查询数据库一样，保存确切的查询，并将其作为字符串存储在带有`id`and的表中`query`。在存储之前检查查询是否存在。

* * *

这似乎可行，但我无法想象这是最好的方法。有没有更有效，或者坦率地说不那么丑陋的解决方案？我什至是否以适当的方式存储这些物品？

谢谢你，詹姆斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T00:23:11.963

如果特定属性和类别的数量足够少，这通常可以使用[具体表继承](http://martinfowler.com/eaaCatalog/concreteTableInheritance.html)（或它的[其他](http://martinfowler.com/eaaCatalog/singleTableInheritance.html) [派生](http://martinfowler.com/eaaCatalog/classTableInheritance.html)）来解决，如果不是，您需要一个[实体-属性-值](http://en.wikipedia.org/wiki/Entity-attribute-value_model)模型——这很难用和进行复杂的查询，从长远来看，可以很快导致[GIGO 。](http://en.wikipedia.org/wiki/Garbage_in,_garbage_out)

![Magento 数据库架构](../Images/651753b441fa6cb7449c64838c78aa8a.png)

另一种替代方法是使用无模式数据存储，[例如 MongoDB](http://kylebanker.com/blog/2010/04/30/mongodb-and-ecommerce/)或序列化 blob。

# android - onLocationChanged 回调是在哪个线程上进行的？主 UI 线程？

> ID：11129925
> 
> 赞同：8
> 
> 时间：2012-06-21T00:13:38.863
> 
> 标签：android, locationlistener

在我的应用程序中进行此回调时，我有很多工作要做（通过 ORM 库和一些基于距离的计算读取和写入 SQL db）。当然，我担心不会阻塞主 UI 线程，所以我一直在尝试（不成功）找出这是否是进行回调的线程。如果是，我打算对回调时触发的 AsyncTask 执行上述所有工作。同样的 AsyncTask 也将接收来自 2 个独立活动类的事件。（响应用户输入等。）

我发现的很多关于这个回调的讨论似乎都是基于人们试图改变实际接收回调的线程。这对我来说毫无意义。当然，平台会确定此回调的上下文，并且在接收到它时要做的明智的事情是将任何严肃的工作转移到另一个线程上，这对于 AsyncTask 似乎是合适的。

如果有人可以概述他们在这里使用的成功模式，那将非常有用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-21T00:29:08.177

根据 Android 参考文档[`LocationManager`](http://developer.android.com/reference/android/location/LocationManager.html#requestLocationUpdates%28java.lang.String,%20long,%20float,%20android.location.LocationListener%29)：

> 调用线程必须是Looper线程，例如调用Activity的主线程。

这意味着初始化回调的线程必须是主线程或`Looper`线程。

我发现处理这个问题的最好方法是`OnLocationChanged`在主线程上注册一个接收器。然后，在我的回调中，我将创建一个 Runnable 以发送到后台线程，在那里我将执行任何长时间运行的任务（例如写入数据库）。

```
ExecutorService mThreadPool = Executors.newSingleThreadExecutor();

@Override
public void onLocationChanged(Location location) {
    mThreadPool.execute(new Runnable() {
        @Override
        public void run() {
            // Perform your long-running tasks here.
            //...
        }
    });
} 
```

# r - R 代码：为什么我的函数没有产生错误和结果？

> ID：11129928
> 
> 赞同：0
> 
> 时间：2012-06-21T00:14:08.237
> 
> 标签：r, function

我正在编写一个函数并且遇到了一些问题。我的函数没有创建新变量，运行后没有错误，也没有变化，就好像我从未运行过它一样。函数之前的代码工作得很好，如果我直接通过代码传递参数（绕过代码的函数方面），它运行完美。

你觉得我有什么遗漏吗？我已经看了两天了，已经没有想法可以尝试了。任何建议将不胜感激！

```
path <- "C:/Documents/Data"
readFile <- paste(path,"/opps.csv",sep="")
oppsQty <- read.csv(file=readFile,sep=",")

oppsQty$Line.Created.date <- as.Date(as.character(oppsQty$Line.Created),
                                     "%m/%d/%Y")

opQty002.0084.01 <- oppsQty[oppsQty$Part=="002-0084-01",]

 productNumberData <- function(nameNum,prodNum){
    # CREATING YEAR VARIABLE #
    year2009 <- ifelse((nameNum$Line.Created.date <= 
                        as.Date("12/30/2009","%m/%d/%Y")),"2009","0")
    year2010 <- ifelse((nameNum$Line.Created.date > 
                        as.Date("12/30/2009","%m/%d/%Y")&
                        nameNum$Line.Created.date <= 
                        as.Date("12/30/2010","%m/%d/%Y")),"2010",year2009)
    year2011 <- ifelse((nameNum$Line.Created.date > 
                        as.Date("12/30/2010","%m/%d/%Y")&
                        nameNum$Line.Created.date <= 
                        as.Date("12/30/2011","%m/%d/%Y")),"2011",year2010)
    nameNum$line.YEAR <- ifelse((nameNum$Line.Created.date > 
                                as.Date("12/30/2011","%m/%d/%Y")&
                                nameNum$Line.Created.date <= 
                                as.Date("12/30/2012","%m/%d/%Y")),"2012",year2011)
 }
 productNumberData(opQty002.0084.01,"002-0084-01")
 #opQty002.0084.01$line.YEAR does not exist 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T21:02:15.417

您在这里看到的是所谓的范围界定的结果。在任何体面的编程语言（包括 R）中，变量在全局范围内都无效。相反，变量存在于某个范围内。您正在创建的变量是函数范围的一部分。因此，在您尝试使用它的函数之外找不到它，这会导致错误。R 中的范围规则确实允许引用函数外部的变量，其中仅当函数范围内没有具有该名称的变量时才使用函数外部的变量。

作用域减少了较大 R 脚本中代码片段之间的依赖关系。通过这种方式，函数中的代码不太可能在其他函数中引起不希望的副作用。

我将使用的解决方案是将您创建的所有对象放在一个更大的数据结构中，可能是一个`list`. 代码看起来像：

```
spam = function(object_in) {
  A = f(object_in)
  B = g(object_in)
  list(A, B)
 }
result = spam(obj)
result[["A"]] 
```

# excel - Excel 宏或函数清除单元格内容（如果不是日期）

> ID：11129934
> 
> 赞同：0
> 
> 时间：2012-06-21T00:14:49.577
> 
> 标签：excel, vba

**问题**

垃圾被错误地输入到日期字段并搞砸了计算。

**目标**

使用宏或函数检查单元格范围内的内容，确定它们是否是日期，如果不是，则删除非日期内容。

**我试过的**

使用搜索和替换功能来定位和删除违规项目。需要永远，但仍然没有清除所有内容。

任何想法，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T00:56:02.087

你可以试试这个

```
Sub DeleteNonDates()
    Dim r As Range, a As Range, cl As Range
    Set r = ActiveSheet.UsedRange.SpecialCells(xlCellTypeConstants)
    For Each cl In r.Cells
        If TypeName(cl.Value) <> "Date" Then
            cl.ClearContents
        End If
    Next
End Sub 
```

# gradle - 如何将 gradle 文件放在一边（可能与如何导入相同）？

> ID：11129935
> 
> 赞同：2
> 
> 时间：2012-06-21T00:14:57.040
> 
> 标签：gradle

我们有一个包含 3 个子项目的项目，其中一个称为 bldfiles。每个都有一个 .project 文件，因此我们可以告诉 eclipse 导入项目并导入所有 3 个子项目。当然，项目中的任何文件都不会直接显示在 eclipse 中。我认为虽然使用 gradle，我们必须在项目目录中有一个文件，所以我们想在其中放置一个我们“永远不会”更改的文件，因为它不会出现在 eclipse 中。我们希望该文件从 bldfiles/build.gradle 导入（或者称为其他名称）“真正的” gradle 构建文件。

这该怎么做？

它还会像顶级 gradle 文件中的所有代码一样工作吗？（即，从子项目等构建时，它会找到顶层等）

谢谢，院长

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T00:50:35.153

您不一定必须将主`build.gradle`文件放在项目目录中。虽然在[手册](http://gradle.org/docs/current/userguide/build_lifecycle.html)中不是很清楚，但是您可以将您的项目`build.gradle`放在名为`master`.

所以代替（通常的分层设置）：

```
- project/
  + build.gradle  <-- not visible in eclipse
  + gradle.settings (content: include 'bldfiles')
  +- bldfiles/
     + .project
     + build.gradle 
```

您可以使用它来实现与上述相同的行为（平面层次结构设置）：

```
- project/
  +- master/   <-- can be an Eclipse project now
    + .project
    + build.gradle 
    + gradle.settings (content: includeFlat 'bldfiles')
  +- bldfiles/
     + .project
     + build.gradle 
```

*注意：*确保`includeFlat`在文件中使用指令`master/gradle.settings`，而不是通常的`include`.

# c++ - 在 OpenCV 中转换矩阵的类型

> ID：11129939
> 
> 赞同：0
> 
> 时间：2012-06-21T00:15:16.517
> 
> 标签：c++, image-processing, opencv

我有以下代码使用**OpenCV API中的****cv::Mat.convertTo()**函数转换矩阵的“类型” 。

 **但是当我使用**imshow()**显示它时，图像完全不同。

转换后的图像是完全灰色的。

但是，这些图像（**cv::Mat**）中的值是相同的。

我想我在这里遗漏了一些非常微不足道的东西。

```
Mat x = imread("/home/jason/Desktop/1.png",0);
Mat y = Mat(x.rows,x.cols,CV_16S,Scalar(0));

x.convertTo(y,CV_16SC1, 1,0);

imshow("x",x);
imshow("y",y);
waitKey(0);

cout<<x.type()<<endl;
cout<<y.type()<<endl;

//verifying the values in the image.

cout<<"rows 10"<<x.row(10)<<endl;
cout<<"rows 10"<<y.row(10)<<endl; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T00:26:02.297

当您将`CV_16S`图像传递给`imshow`（或其 C 等效项）时，像素值会在可视化之前通过公式 v[显示]= 128 + v[图像]/256隐式重新计算

因此，您可能需要将图像乘以某个常数（256？）或在调用`CV_8U`之前将其转换为`imshow`。**

# c# - 为远程管理工具选择项目模板

> ID：11129941
> 
> 赞同：0
> 
> 时间：2012-06-21T00:15:39.707
> 
> 标签：c#, wpf, asp.net-mvc, winforms

我即将开始一个新项目。

该项目的目的是在远程 PC 上安装一个小型应用程序，该应用程序可以执行两 (2) 项任务：

*   读取目录内容，以及
*   重命名和/或移动文件和文件夹

对于那些好奇的人，我可以在我们的 HTPC 上组织数百个媒体文件。每当我在他们试图观看时开始管理文件时，家人都会非常沮丧，HTPC 管理起来非常麻烦，并且从我的桌面通过网络进行管理非常耗时（例如：将 1.57 GB 电影文件`\\HTPC\Ripped`从`\\HTPC\Movies`涉及将流字节从`\\HTPC\Ripped`我的 PC 复制到我的 PC，然后将其复制到`\\HTPC\Movies`)。

所以，我在**Visual Studio 2010**中查看**Visual C#**下的已安装模板。通常情况下，我所做的只是*Windows 窗体*的东西，偶尔会有*ASP.NET*页面，所以这可能是我接触一些新技术的好机会。

**这是我在.NET Framework 4**下安装的模板列表：

*   Windows 窗体应用程序
*   WPF 应用程序
*   控制台应用程序
*   ASP.NET 网络应用程序
*   类库
*   ASP.NET MVC 2 Web 应用程序
*   Silverlight 应用程序
*   Silverlight 类库
*   WCF 服务应用程序
*   ASP.NET 动态数据实体 Web 应用程序
*   启用 Windows Azure 工具（这可能不是模板，而是安装程序）
*   Excel 2010 工作簿（不！）
*   Outlook 2010 加载项（否！）
*   Word 2010 文档（不！）
*   活动库
*   WCF 工作流服务应用程序
*   Crystal Reports 应用程序（不！）

其中一些显然不是正确的项目类型，但我真的没有使用 Silverlight、WCF/WPF 或 MVC 的经验。

我可以轻松地创建两 (2) 个 Windows 窗体应用程序，它们通过 TCP 发送消息来相互通信，但是有没有更现代的东西会让我想，“*男孩，这很简单，而且效果很好！* ”

如果其中一个非常适合这个类似*远程桌面*的工具，那么可以为我提供好的教程来获得我想要完成的东西。

注意：要运行*远程桌面*，HTPC 需要从 Win7 Premium 升级到 Win7 Pro，并且只要*远程桌面*会话开始，Windows Media Center 就会关闭。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T13:58:18.983

您可以在 HTPC 上创建一个在 IIS 中运行的 ASP.NET 页面，该页面将具有所需的功能（目录浏览、文件复制等？）。然后你可以只使用网页来管理你的东西而不会打扰你的家人。

然后，您还必须为 IIS 进程提供一些额外的权限，以允许它对计算机进行修改。此外，您必须在 IIS 计算机上安装一些防火墙，以确保无法从 Internet 访问它，这样其他人也无法使用该网页。

# ruby-on-rails - 添加/删除模型关系的最简单方法

> ID：11129944
> 
> 赞同：0
> 
> 时间：2012-06-21T00:15:55.083
> 
> 标签：ruby-on-rails, activerecord, form-for

我想知道对我的模型进行小更新的最佳方法是什么。我的意思是我想要一个按钮，通过 has_many :through 关系创建或破坏我的两个模型之间的关系。所以我有用户、Dvds、队列和 DvdQueues。

我想在很多页面上添加一个简单的按钮，当点击这些按钮时，会在用户队列中添加一个 DVD。实现这一目标的最佳方法是什么？我应该在每个页面上加载一个简单的表单吗？我应该将按钮链接到处理它的控制器操作吗？如果我确实使用表单，我需要嵌套属性吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T01:28:01.927

最简单的方法是对 DvdQueues 使用单独的控制器，仅使用创建/销毁操作，然后在视图中使用带有[Rails javascript-helper :method 的](http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-link_to)link_to （在这种情况下为:post|:delete）

例如：

```
class DvdQueuesController < ApplicationController
  def create
    # params[:dvd_queue] = {"dvd_id": x, "queue_id": y}
    @user.dvd_queues.create params[:dvd_queue]
    redirect_to dvds_path
  end

  def destroy
    dvd_que = @user.dvd_queues.find_by_id params[:id]
    dvd_que.destroy
    redirect_to dvds_path
  end
end 
```

```
module DvdQueuesHelper
  def link_to_add_or_remove_from_queue(dvd, text)
    if @user.dvd_queues.exists? :dvd_id => dvd.id
      link_to text, dvd_queues_path(dvd.id), :method => :delete
    else
      link_to text, dvd_queues_path, :method => :post
    end
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T17:41:09.203

您可以`add_dvd`向必要的控制器添加操作并使用`button_to`( [doc](http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-button_to) ) 助手。你也可以使用ajax。只需`remote: true`向按钮添加选项并使用`add_dvd`和处理您的响应:)

# php - 一个 CakePHP 查询无缘无故地调用 COUNT() 两次

> ID：11129947
> 
> 赞同：3
> 
> 时间：2012-06-21T00:16:10.893
> 
> 标签：php, mysql, cakephp, cakephp-model

*注意：我最初在一小时前问了这个问题，但直到最近才意识到我犯了一个重大的复制和粘贴错误。一个如此重要，以至于删除旧帖子并重新开始更容易。对于那个很抱歉。*

在 CakePHP 框架中，更新模型后，我转储了 SQL 查询。`COUNT(*)`被调用了两次，没有明显的原因。

所以我有两个模型，`$Foo`和`$Bar`. 为简单起见，我*没有*定义它们之间的任何`$belongsTo`关系`$hasMany`。问题只涉及 $Foo，但以防万一我也包含了 $Bar 的代码。

```
$data = array(
    'something' => 12,
    'something_else' => $this->Bar->field('id', $conditions),
);

$this->Foo->id = $this->Foo->field($data);
$this->Foo->save($data); 
```

我`$Bar.id`根据一组条件（这里不相关）获得该字段。我使用该 id 来确定`$data`应该 INSERT 或 UPDATE 到`$Foo`. 如果`$Foo`有一个满足`$data`的要求的 id 将返回该值；如果不是*false*将被返回。根据 CakePHP 的架构，`save()`如果有有效的 id 就会更新；否则它将插入。我很确定我没有做任何不寻常的事情。

这是我在 SQL 转储中看到的内容：

```
SELECT `Foo`.`id` FROM `foos` AS `Foo` WHERE `something` = 12 AND `something_else` = 1 LIMIT 1
SELECT COUNT(*) AS `count` FROM `foos` AS `Foo` WHERE `Foo`.`id` = 1
SELECT COUNT(*) AS `count` FROM `foos` AS `Foo` WHERE `Foo`.`id` = 1
UPDATE `foos` SET `something` = 12, something_else` = 1 WHERE `foos`.`id` = 1' 
```

对于我的生活，我根本无法弄清楚为什么`COUNT()`需要它，更不用说为什么它被调用两次了。有人知道发生了什么吗？谢谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T02:32:41.033

我没有使用过 CakePHP，但是查看[这里](https://github.com/cakephp/cakephp/blob/5270721adee6aa4b2d07a61f589f729092ab9632/lib/Cake/Model/Model.php)的源代码，您会在字段函数中看到它调用了 find 方法。

因此，这个调用

```
$data = array(
    'something' => 12,
    'something_else' => $this->Bar->field('id', $conditions),
); 
```

生成：

```
SELECT `Foo`.`id` FROM `foos` AS `Foo` WHERE `something` = 12 AND `something_else` = 1     LIMIT 1 
```

然后设置字段调用

```
$this->Foo->id = $this->Foo->field($data); 
```

通过内部 find 函数调用生成它：

```
SELECT COUNT(*) AS `count` FROM `foos` AS `Foo` WHERE `Foo`.`id` = 1 
```

Save 函数还会调用 find 来查看保存前记录是否存在，从而生成第二个调用：

```
SELECT COUNT(*) AS `count` FROM `foos` AS `Foo` WHERE `Foo`.`id` = 1 
```

最后的查询是明显的保存本身。

请自行确认我是否正确阅读了它，但这似乎就是这样做的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T00:53:21.200

无法告诉您发生了什么（因为我认为没有足够的代码），但可以为您提供解决方法。

使用“INSERT INTO table(id, field, field2) VALUES(id, value, value2) ON DUPLICATE KEY UPDATE field=value, field2=value2" 语法进行查询。

这使 SQL 可以检查重复项，并且还将消除您检查行是否存在和尝试插入之间的那几秒钟（以防万一另一个进程在您检查后插入）。为此，字段“id”必须是主键或“唯一”索引，以便它知道触发更新。

# codeigniter - 本地项目的 Codeigniter 基本 URL？

> ID：11129948
> 
> 赞同：1
> 
> 时间：2012-06-21T00:16:29.890
> 
> 标签：codeigniter

抱歉这个愚蠢的问题，但我的网站位于目录中：C:/XAMPP/htdocs/

我通过在浏览器中访问 127.0.0.1/ 来访问它。那么如果 CodeIgniter.js 我应该在配置中设置我的 baseURL 吗？

只需将其设置为`127.0.0.1/site`?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T02:24:34.397

你可以使用`127.0.0.1`或者`localhost/site`

您还可以编辑主机文件并使其指向不同的 URL

[http://www.howtogeek.com/howto/27350/beginner-geek-how-to-edit-your-hosts-file/](http://www.howtogeek.com/howto/27350/beginner-geek-how-to-edit-your-hosts-file/)

[查看使用 XAMPP http://sawmac.com/xampp/virtualhosts/](http://sawmac.com/xampp/virtualhosts/)设置虚拟主机

# asp.net - Web 管理工具：无法连接到另一台计算机上的 SQL Server 数据库

> ID：11129950
> 
> 赞同：2
> 
> 时间：2012-06-21T00:16:39.150
> 
> 标签：asp.net, database

我目前正在使用 MS Visual Web developer 2010 Express 来构建一个网站作为学校项目。我使用了网站管理工具并设置了我的登录和注册表单以及所有内容。当我运行网站时，一切都在家里完美运行，我可以登录，我可以使用注册表单创建一个新用户。今天我用我的闪存驱动器把它带到学校给我的老师看。使用她的笔记本电脑，我使用 MS Visual Web developer 2010 Express 打开了我的网站。现在，当我尝试注册新用户或使用在家中创建的用户登录时，我会收到一个错误页面，其中包含一长串代码。所以，我立即去网站管理工具检查发生了什么。我点击了安全选项卡，我收到了这条消息：

> 您选择的数据存储存在问题。这可能是由无效的 >server 名称或凭据或权限不足引起的。它也可能是由未启用 >role manager 功能引起的。单击下面的按钮将被重定向到一个页面>您可以在其中选择一个新的数据存储。
> 
> 以下消息可能有助于诊断问题：无法连接到 SQL Server 数据库。

我现在很困惑。为什么它不能在另一台计算机上运行？此功能是否仅适用于您创建它的计算机？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T00:36:53.363

我认为您需要将 mdf 文件部署到远程服务器。步骤如下：[将 ASPNETDB.MDF 部署到远程 SQL Server 数据库](http://weblogs.asp.net/nannettethacker/archive/2008/11/04/deploying-the-aspnetdb-mdf-to-a-production-server.aspx)

# java - JTextField 的闪烁颜色

> ID：11129951
> 
> 赞同：0
> 
> 时间：2012-06-21T00:16:49.817
> 
> 标签：java, swing, colors, jtextfield

我有一个 JTextField，如果它有无效的内容，它就会被清除。我希望背景以红色闪烁一两次，以向用户表明这已经发生。我努力了：

```
field.setBackground(Color.RED);
field.setBackground(Color.WHITE); 
```

但它在如此短暂的时间内是红色的，以至于不可能被看到。有小费吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-21T02:38:27.810

几乎由 eric 提出的正确解决方案是使用 Swing Timer，因为 Timer 的 ActionListener 中的所有代码都将在 Swing 事件线程上调用，这可以防止发生间歇性和令人沮丧的错误。例如：

```
public void flashMyField(final JTextField field, Color flashColor, 
     final int timerDelay, int totalTime) {
  final int totalCount = totalTime / timerDelay;
  javax.swing.Timer timer = new javax.swing.Timer(timerDelay, new ActionListener(){
    int count = 0;

    public void actionPerformed(ActionEvent evt) {
      if (count % 2 == 0) {
        field.setBackground(flashColor);
      } else {
        field.setBackground(null);
        if (count >= totalCount) { 
          ((Timer)evt.getSource()).stop();
        }
      }
      count++;
    }
  });
  timer.start();
} 
```

它会通过调用`flashMyField(someTextField, Color.RED, 500, 2000);`

警告：代码既没有经过编译也没有经过测试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T00:27:25.430

您需要扩展公共类[Timer](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Timer.html) 这样做：

```
private class FlashTask extends TimerTask{
    public void run(){
       // set colors here
    }
} 
```

您可以设置`Timer`以您喜欢的任何间隔执行以创建闪烁效果

从文档：

`public void scheduleAtFixedRate(TimerTask task, long delay, long period)`

安排指定任务以重复固定速率执行，在指定延迟后开始。

# ruby-on-rails - 如何从 ruby mine 内部初始化 gem (guard-rspec)？

> ID：11129952
> 
> 赞同：0
> 
> 时间：2012-06-21T00:17:03.200
> 
> 标签：ruby-on-rails, rspec, gem, rubymine, guard

我在rails上是n00b，所以我可能会遗漏一些非常明显的东西:)

我刚刚使用 bundle install 安装了 guard-rspec gem，但我需要在 RubyMine 中对其进行初始化。

IE

捆绑执行保护初始化 rspec

在我的一生中，如果不打开命令提示符（我知道该怎么做），我无法弄清楚如何做到这一点，这使得使用 RubyMine 的部分原因失效。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T01:41:19.730

我发现：

[https://github.com/guard/guard/wiki/Run-guard-with-Rubymine](https://github.com/guard/guard/wiki/Run-guard-with-Rubymine)

其中指出：

编辑：事实证明，运行

```
exec "guard" 
```

将在 ruby​​mine 中初始化自身，并按照定义运行测试。

下面的命令（现在编辑为正确的命令）只会初始化保护文件。

> Rubymine 3.2.4 可以使用 guard，但运行它的唯一方法是在项目 > 根目录中使用 run_guard.rb 和 1 行：
> 
> ```
> exec "guard init rspec" 
> ```
> 
> 然后运行 ​​Cmd + ALt + F8 从 Rubymine 运行这个文件。

虽然对于 Windows，我只是右键单击 run_guard.rb 并点击运行，这似乎可以正常工作。

# java - Java - 将选项卡添加到 JTabbedPane 导致 StackOverflowError（禁用触发 ChangeEvent？）

> ID：11129956
> 
> 赞同：0
> 
> 时间：2012-06-21T00:17:14.873
> 
> 标签：java, swing, stack-overflow, jtabbedpane

嘿 StackOverflow 社区，我遇到了 StackOverflow 问题。

I'm having difficulty adding a new tab to my GUI's JTabbedPane container, when the [+] tab is selected. 到目前为止，每当我单击 [+] 选项卡时，都会添加新选项卡，直到发生 StackOverflowError 为止。

当以下条件为真时，新选项卡将添加到 JTabbedPane。

```
if(songPanel.getSelectedIndex()==songPanel.getTabCount()-1){
...
} 
```

我试图恢复到先前选择的选项卡以避免选项卡被重复添加到 JTabbedPane，但无济于事。当 ChangeEvent 执行器被触发时，它是否会无限期地保持打开状态？我在 SE7 API 中没有遇到任何有用的东西。

> 相关代码（不可编译，摘自较大程序。可能缺少括号，只是因为我复制粘贴了代码的摘录，容易出错）

```
@Override
    public void init(){
        setLayout(new GridLayout(MAIN_LAYOUT_ROWS, MAIN_LAYOUT_COLUMNS));
        add(renderPanel = new JScrollPane());
        add(controlPanel = new JPanel());
        add(colourPanel = new JPanel());
        add(songPanel = new JTabbedPane());

        //songPanel options
        songPanel = new JTabbedPane();
        songPanel.setTabLayoutPolicy(JTabbedPane.SCROLL_TAB_LAYOUT);
        songPanel.addTab("#1", new JTextArea());
        songPanel.addTab("+", null, new JLabel(), "+");

        Container cp = getContentPane();
        cp.add(BorderLayout.SOUTH, songPanel);

        //integrate songPanel changeListener 
        songPanel.addChangeListener(new ChangeListener(){

            @Override //Method called when selected tab changes
            public void stateChanged(ChangeEvent e){
                try {          
                    if(songPanel.getSelectedIndex()==songPanel.getTabCount()-1){
                        addTab("songPanel");
                    }
                } catch (StackOverflowError soe){soe.printStackTrace();}
            }
        });
//*************************************************************************
    @Override
    public void start(){

    }
//*************************************************************************
    private void addTab(String panelName){
        System.out.println("ADDING TAB");
        if(panelName.equals("songPanel")){
            String tabName = ("#" + Integer.toString(songPanel.getTabCount()-1));
            songPanel.insertTab(tabName, null, new JTextField(), tabName,           songPanel.getTabCount()-2);
        }
    }
}
//**************************************************************************
} 
```

我试过了：

*   在 addTab() 方法中设置恢复索引，因此选择了最新的选项卡（仍然导致 StackOverflowError）

注意这一行：

```
songPanel.getSelectedIndex()==songPanel.getTabCount()-1) 
```

> "songPanel.getSelectedIndex()" 和 "songPanel.getTabCount()-1)" 总是相等的，所以条件总是为真（**导致 StackOverflowError**）
> 
> 错误信息：

```
java.lang.StackOverflowError
at javax.swing.text.StyleContext$SmallAttributeSet.getAttributeNames(StyleContext.java:947)
at javax.swing.text.StyleContext$SmallAttributeSet.containsAttributes(StyleContext.java:973)
at javax.swing.text.StyleContext$SmallAttributeSet.equals(StyleContext.java:852)
at java.util.WeakHashMap.eq(WeakHashMap.java:282)
at java.util.WeakHashMap.get(WeakHashMap.java:379)
at java.util.Collections$SynchronizedMap.get(Collections.java:2031)
at javax.swing.text.StyleContext.getImmutableUniqueSet(StyleContext.java:520)
at javax.swing.text.StyleContext.addAttributes(StyleContext.java:340)
at javax.swing.text.AbstractDocument$AbstractElement.addAttributes(AbstractDocument.java:1985)
at javax.swing.text.AbstractDocument$AbstractElement.<init>(AbstractDocument.java:1777)
at javax.swing.text.AbstractDocument$LeafElement.<init>(AbstractDocument.java:2502)
at javax.swing.text.AbstractDocument$BidiElement.<init>(AbstractDocument.java:2674)
at javax.swing.text.AbstractDocument.<init>(AbstractDocument.java:149)
at javax.swing.text.AbstractDocument.<init>(AbstractDocument.java:109)
at javax.swing.text.PlainDocument.<init>(PlainDocument.java:90)
at javax.swing.text.PlainDocument.<init>(PlainDocument.java:80)
at javax.swing.text.DefaultEditorKit.createDefaultDocument(DefaultEditorKit.java:130)
at javax.swing.plaf.basic.BasicTextUI.installUI(BasicTextUI.java:799)
at javax.swing.JComponent.setUI(JComponent.java:655)
at javax.swing.text.JTextComponent.setUI(JTextComponent.java:338)
at javax.swing.text.JTextComponent.updateUI(JTextComponent.java:348)
at javax.swing.text.JTextComponent.<init>(JTextComponent.java:322)
at javax.swing.JTextField.<init>(JTextField.java:231)
at javax.swing.JTextField.<init>(JTextField.java:172)
at application.Analyzer.addTab(Analyzer.java:133)
at application.Analyzer.access$100(Analyzer.java:24)
at application.Analyzer$1.stateChanged(Analyzer.java:101)
at javax.swing.JTabbedPane.fireStateChanged(JTabbedPane.java:416)
at javax.swing.JTabbedPane$ModelListener.stateChanged(JTabbedPane.java:270)
at javax.swing.DefaultSingleSelectionModel.fireStateChanged(DefaultSingleSelectionModel.java:132)
at javax.swing.DefaultSingleSelectionModel.setSelectedIndex(DefaultSingleSelectionModel.java:67)
at javax.swing.JTabbedPane.setSelectedIndexImpl(JTabbedPane.java:616)
at javax.swing.JTabbedPane.insertTab(JTabbedPane.java:735)
at application.Analyzer.addTab(Analyzer.java:133)
at application.Analyzer.access$100(Analyzer.java:24)
.
.
. 
```

你有什么建议吗？我知道这有点模糊，但我真的不确定出了什么问题。

有什么建议么？谢谢。泰勒

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T06:14:31.320

StackOverflow 标识了一个无限递归。所以首先要做的是找到那个递归。在您的情况下，这些是标识该递归的堆栈跟踪行：

> 在 application.Analyzer.addTab(Analyzer.java:133) 在 application.Analyzer.access$100(Analyzer.java:24) 在 application.Analyzer$1.stateChanged(Analyzer.java:101) 在 javax.swing.JTabbedPane.fireStateChanged( JTabbedPane.java:416) 在 javax.swing.JTabbedPane$ModelListener.stateChanged(JTabbedPane.java:270) 在 javax.swing.DefaultSingleSelectionModel.fireStateChanged(DefaultSingleSelectionModel.java:132) 在 javax.swing.DefaultSingleSelectionModel.setSelectedIndex(DefaultSingleSelectionModel.java :67) 在 javax.swing.JTabbedPane.setSelectedIndexImpl(JTabbedPane.java:616) 在 javax.swing.JTabbedPane.insertTab(JTabbedPane.java:735) 在 application.Analyzer.addTab(Analyzer.java:133)

因此，当您插入选项卡时，它会自动触发所选选项卡的更改，该选项卡又会调用您的 ChangeEventListener，这将触发选项卡的插入等...

所以你有两个简单的解决方案：

1.  使用在添加新选项卡之前设置为的标志 (a `boolean`)，并在完成后设置回该标志。在您测试是否需要添加选项卡的条件下，您还要检查此标志是否为.`true``false``true`
2.  在插入选项卡之前从 JTabbedPane 中删除更改侦听器，然后将其放回原处。

在这两种情况下，使用 try/finally 块来确保返回到一致的状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T02:06:46.993

**更新的解决方案** 对不起，以前的解决方案没有按预期工作。这是我更新的一个：

```
public class TabbedPaneTest {

    private final static JButton ADD_NEW_TAB_BUTTON = new JButton();
    private JFrame mainFrame;
    private JTabbedPane tabbedPane;

    public void run() {
        mainFrame = new JFrame("Test JTabbedPane");
        mainFrame.setSize(300, 400);
        mainFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        tabbedPane = new JTabbedPane();
        tabbedPane.addTab("default new tab", new JLabel("this is a default tab"));

        addNewTabButton();
        tabbedPane.addChangeListener(new ChangeListener() {

            @Override
            public void stateChanged(ChangeEvent e) {
                if (tabbedPane.getSelectedComponent() == ADD_NEW_TAB_BUTTON) {
                    tabbedPane.addTab("new tab", new JLabel("new tab label"));
                    addNewTabButton();
                }
            }
        });

        mainFrame.getContentPane().add(tabbedPane);
        mainFrame.setVisible(true);
    }

    private void addNewTabButton() {
        tabbedPane.remove(ADD_NEW_TAB_BUTTON);
        tabbedPane.addTab("[+]", ADD_NEW_TAB_BUTTON);
    }

    public static void main(String[] params) {
        TabbedPaneTest test = new TabbedPaneTest();
        test.run();
    }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T08:51:02.500

问题是 changeListener 在添加后再次调用 + 选项卡作为选定选项卡，导致创建新选项卡，依此类推。

正如 Guillaume Polet 所说，一个非常简单的解决方案可能只是添加一个 bool 标志：

```
 songPanel.addChangeListener(new ChangeListener(){

        @Override //Method called when selected tab changes
        public void stateChanged(ChangeEvent e){
            try {   
                if(songPanel.getSelectedIndex()==songPanel.getTabCount()-1 && !adding){
                    adding = true;
                    addTab("songPanel");
                    adding = false;
                }
            } catch (StackOverflowError soe){soe.printStackTrace();}
        }
    }); 
```

添加标志是初始化为假的类字段，并指示您是否正在添加选项卡。对 addTab 进行细微更改以使一切正常：

```
private void addTab(String panelName){
    System.out.println("ADDING TAB");
    if(panelName.equals("songPanel")){
        String tabName = ("#" + Integer.toString(songPanel.getTabCount()));
        int index = songPanel.getTabCount()-1;
        songPanel.insertTab(tabName, null, new JTextField(), tabName, index);
        songPanel.setSelectedIndex(index);
    }
} 
```

我对代码做了一点改动，使活动选项卡成为新创建的选项卡，并且索引有点偏离。

希望这可以帮助 ：）

# java - Java method().method() 调用

> ID：11129957
> 
> 赞同：1
> 
> 时间：2012-06-21T00:17:26.663
> 
> 标签：java, arraylist, compiler-errors

如果可能的话，如何`method`从另一个方法调用 a `return`？

例如...

```
class Example {
    public static void main(String[] args) {
        Point t1 = new Point(0,0);
        Point t2 = new Point(0,1);
        ArrayList pointContainer = new ArrayList();
        pointContainer.add(0,t1);
        pointContainer.add(0,t2);    // We now have an ArrayList containing t1 & t2
        System.out.println(pointContainer.get(1).getLocation()); // The problem area
    }
} 
```

在写得不好的例子中，我试图在 的索引项 1 上调用`getLocation()`方法（的一部分） 。`java.swing.awt``pointContainer`

尝试编译程序时，出现以下错误...

```
HW.java:20: error: cannot find symbol
        System.out.println(test.get(1).getLocation());
                                  ^
  symbol:   method getLocation()
  location: class Object 
```

有人可以帮我解决这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T00:19:33.800

首先，键入您的 ArrayList，以便 Java 可以知道从中产生了哪些对象。

```
List<Point> pointContainer = new ArrayList<Point>(); 
```

然后，您从该 ArrayList 检索的任何对象都将是 type `Point`，因此您可以对它们执行操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T00:26:06.413

在您的情况下，您需要对 the 进行显式转换`Point`，然后调用预期的方法。否则，您需要使用@Makoto 提到的 java 泛型方式定义数组列表。

铸造方式是

`((Point)pointContainer.get(1)).getLocation()`

# python - 使用 NumPy/SciPy 的向量值函数插值

> ID：11129958
> 
> 赞同：8
> 
> 时间：2012-06-21T00:17:42.513
> 
> 标签：python, numpy, scipy, interpolation

[有没有办法使用NumPy](http://en.wikipedia.org/wiki/NumPy) / [SciPy](http://en.wikipedia.org/wiki/SciPy)插值向量值函数？

有很多产品适用于标量值函数，我想我可以使用其中一个来分别估计向量的每个分量，但是有没有办法更有效地做到这一点？

详细地说，我有一个函数`f(x) = V`，其中`x`是标量，`V`是向量。我也有一个`xs`和它们对应的集合`Vs`。我想用它来插值和估计`V`任意的`x`.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-21T06:52:30.773

插值函数`scipy.interpolate.interp1d`也适用于插值的向量值数据（但不适用于向量值参数数据）。因此，只要`x`是标量，就可以直接使用。

以下代码是[scipy 文档](http://docs.scipy.org/doc/scipy/reference/tutorial/interpolate.html#id3)中给出的示例的轻微扩展：

```
>>> from scipy.interpolate import interp1d
>>> x = np.linspace(0, 10, 10)
>>> y = np.array([np.exp(-x/3.0), 2*x])
>>> f = interp1d(x, y)
>>> f(2)
array([ 0.51950421,  4\.        ])
>>> np.array([np.exp(-2/3.0), 2*2])
array([ 0.51341712,  4\.        ]) 
```

请注意， 2 不在参数向量中，因此在此示例`x`中，第一个分量的插值误差。`y`

# java - 读取 WSDL 时实现 importDocument false 的库

> ID：11129961
> 
> 赞同：0
> 
> 时间：2012-06-21T00:18:17.030
> 
> 标签：java, wsdl

我需要解析一个 wsdl 文件，但导入文件可能不可用。有谁知道实际实现功能 importDocuments 的 java wsdl 阅读器？

API 可以在这里找到： [http](http://www.extreme.indiana.edu/apis/wsdl4j/javax/wsdl/xml/WSDLReader.html#setFeature%28java.lang.String,%20boolean%29) ://www.extreme.indiana.edu/apis/wsdl4j/javax/wsdl/xml/WSDLReader.html#setFeature%28java.lang.String,%20boolean%29 。

所以我需要：reader.setFeature("javax.wsdl.importDocuments", false)。

我尝试过easyWSDL和WSDL4J，无论导入文档是否设置为true或false，它们都尝试导入文档。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T03:10:55.923

我认为 java Sax Parser 会让你忽略导入。

不确定您到底想做什么，但也许您可以将其解析为没有导入的新 xml 文件，然后将其提供给 wsdl 解析器。

# amazon-web-services - 是否有在 AWS ec2 上使用 SQS 的命令行工具？

> ID：11129964
> 
> 赞同：4
> 
> 时间：2012-06-21T00:18:45.930
> 
> 标签：amazon-web-services, amazon-sqs

如何通过命令行与 ec2 上的 SQS 交互？我在 AWS 开发人员工具中找不到 SQS 工具。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T19:43:44.780

这是处理[SQS](http://aws.amazon.com/code/developertools/739)的命令行工具。但是我发现最好的交互方式是使用 SDK。[Ruby sdk](http://docs.amazonwebservices.com/AWSRubySDK/latest/frames.html)允许您使用几乎所有的 AWS 工具集。您只需编写一个一次性的 ruby​​ 脚本，即可使用 AWS 服务执行您需要的任何操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-19T21:20:09.657

签出我制作的这个脚本。它只允许与 Amazon SQS 的基本交互（接收、发送和删除消息）。您将需要在您正在运行的环境中使用 Go 来构建它（这很简单。只需运行 go build）。如果您有任何问题（在 github 问题页面上）或在您的服务器/开发机器上安装脚本时遇到问题，请告诉我！我在 Heroku 上广泛使用这个脚本。

[https://github.com/lancecarlson/sqslite](https://github.com/lancecarlson/sqslite)

发送消息：

```
export AWS_ACCESS_KEY_ID=whatever
export AWS_SECRET_ACCESS_KEY=whatever
echo "message" | sqslite -q queue-name -c s 
```

接收消息：

```
sqslite -q queue-name 
```

删除消息：

```
echo "ReceiptHandlerId" | sqslite -q queue-name -c d 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-21T16:32:31.603

[https://github.com/aws/aws-cli](https://github.com/aws/aws-cli)支持 SQS。来自`aws sqs help`：

```
AVAILABLE COMMANDS
   o add-permission

   o change-message-visibility

   o change-message-visibility-batch

   o create-queue

   o delete-message

   o delete-message-batch

   o delete-queue

   o get-queue-attributes

   o get-queue-url

   o list-queues

   o receive-message

   o remove-permission

   o send-message

   o send-message-batch

   o set-queue-attributes

   o help 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-07T18:50:15.363

如果您使用的是 Python，[boto](http://boto.s3.amazonaws.com/sqs_tut.html)是使用 AWS 服务的绝佳工具。

# python - SQLAlchemy 中的验证

> ID：11129965
> 
> 赞同：1
> 
> 时间：2012-06-21T00:18:46.913
> 
> 标签：python, sqlalchemy

我正在使用 Flask 和 flask-SQLAlchemy 扩展来制作一个 webapp，并且我`unique=True`在模型声明中添加了类似的字段。

```
class Coupon(db.Model):
    username = db.Column(db.String(80), primary_key=True)
    value = db.Column(db.String(80), unique=True)
    is_valid = db.Column(db.Boolean)

    def __init__(self, value, username):
        self.value = value
        self.username = username
        self.is_valid = True 
```

验证失败后恢复的最佳（pythonic）方法是什么。例如 -

```
c1 = Coupon("same_value", "foo")
db.session.add(c1)
c2 = Coupon("same_value", "bar")
db.session.add(c2)
db.session.commit() #gives an IntegrityError 
```

我应该尝试一下，除了块来处理这个吗？或者有没有更好的方法来处理没有成功的交易。关于事务的一个附加查询 - 只要继续将对象添加到会话而不执行，`session.commit`这是否都是一个事务的一部分？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T08:08:24.827

我不确定`try-catch`这个`commit()`电话是否有意义。即使你这样做了，你如何进一步进行？您如何进一步定位问题并解决问题？您可能已经有几十个重复项。

这里的座右铭是：***尽早发现错误***。
因此，我可能会做的是：我会`session.flush()`在`session.add(c?)`. 这将足够早地表明问题，以便我正确处理。`add/flush`因此，将 包装在`try-catch`块中并根据需要进行处理可能更有意义：

```
def _add_coupon(c):
    """ @param c: instance of Coupon.  
        @return: True if success, False on failure.
    """
    try:
        session.add(c)
        session.flush()
        return True
    except sqlalchemy.exc.IntegrityError as err:
        # @todo: handle as appropriate: return existing instance [session.query(Coupon).filter(Coupon.value==c.value).one()] or re-raise
        logger.error("Tried to add a duplicate entry for the Coupon value [%s]. Aborting", c.value)
        return False 
```

# python - OSX 的语音识别库？

> ID：11129971
> 
> 赞同：3
> 
> 时间：2012-06-21T00:19:57.857
> 
> 标签：python, osx-lion, speech-recognition, speech-to-text

所以我一直在网上寻找 Python 语音识别，我发现了 pyspeech。但这仅适用于 Windows。我想要一个适用于 Mac aswel 的语音识别库。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T20:35:21.417

[http://andrewbrobinson.com/2012/02/29/speech-recognition-using-sphinx-dont-try-this-at-home/](http://andrewbrobinson.com/2012/02/29/speech-recognition-using-sphinx-dont-try-this-at-home/)建议 Pocket Sphinx 包含 Python 绑定并且易于使用。

另一个有用的资源可能是[http://www.youtube.com/watch?v=3VA2Th121zQ上的视频](http://www.youtube.com/watch?v=3VA2Th121zQ)

此外，来自[http://cmusphinx.sourceforge.net/sphinx4/](http://cmusphinx.sourceforge.net/sphinx4/)

> Sphinx-4 已在 Solaris TM 操作环境、Mac OS X、Linux 和 Win32 操作系统上构建和测试。运行、构建和测试 Sphinx-4 需要额外的软件。在开始之前，您需要在您的机器上安装以下软件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-12-02T09:57:32.890

Mozilla 开源了他们的 DeepSpeech 项目，这是百度 DeepSpeech 架构的 tensorflow 实现：

*   [https://blog.mozilla.org/blog/2017/11/29/announcing-the-initial-release-of-mozillas-open-source-speech-recognition-model-and-voice-dataset/](https://blog.mozilla.org/blog/2017/11/29/announcing-the-initial-release-of-mozillas-open-source-speech-recognition-model-and-voice-dataset/)
*   [https://github.com/mozilla/DeepSpeech](https://github.com/mozilla/DeepSpeech)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-02-07T13:38:39.293

这是一个比较表，其中包含您可能要考虑的许多库。（由阿尔贝托·佩塔林撰写）

[https://github.com/pettarin/forced-alignment-tools](https://github.com/pettarin/forced-alignment-tools)

# javascript - 如何双向扩展元素宽度？

> ID：11129973
> 
> 赞同：1
> 
> 时间：2012-06-21T00:20:25.010
> 
> 标签：javascript, jquery, position, width, drag

这个标题听起来是不是很混乱？反正我觉得可能还好。

当我点击页面时，我希望他们能够对我进行更短和更长的一行。

你可以在这里看到我的意思：

[http://jsfiddle.net/shawn31313/HKLhE/9/show/](http://jsfiddle.net/shawn31313/HKLhE/9/show/)

做一个 Mousedown，他们将你的移动向右移动。它工作正常。但是现在，将鼠标移到左边。看到问题了吗？它的方向与您向右拖动时的方向相同。我知道这是因为我正在使用宽度，显然宽度是一种方式。

到目前为止，这是我的代码：

```
$(document).ready(function() {
    var dragStatus = 0,
        getPos, giveRandomID;
    $(document).mousedown(function(event) {
        dragStatus = 0;
        getPos = {
            top: event.clientY,
            left: event.clientX
        };
        giveRandomID = Math.floor(Math.random() * 99999);
    });
    $(document).mousemove(function() {
        var line = $('#line' + giveRandomID);
        if (dragStatus == 0) {
            $('body').append("<div id='line" + giveRandomID + "' class='line' style='position:absolute;top:" + getPos.top + "px;left:" + getPos.left + "px;background:black;width:2px;height:5px'></div>");
            dragStatus = 1;
        }
        if (dragStatus == 1) {
            if (event.clientX > line.offset().left) {
                line.css({
                    width: event.clientX - line.offset().left
                });
            } else {
                line.css({
                    width: line.offset().left - event.clientX
                });
            }
            //for DEG  "-" Top-Math.abs(DEG*2) for Deg "+" Top+(DEG*2)
        }
    });
    $(document).mouseup(function() {
        dragStatus = 2;
    });
});​ 
```

我希望有人可以帮助我解决这个问题。也许是一种完全不同的设置方式。只是为了解决这个问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T00:29:48.160

要使线向左延伸，您必须更新`left`属性：

```
 if (event.clientX > getPos.left) {
            line.css({
                left: getPos.left,
                width: event.clientX - getPos.left
            });
        } else {
            line.css({
                left: event.clientX,
                width: getPos.left - event.clientX
            });
        } 
```

jsFiddle：http: [//jsfiddle.net/HKLhE/16/](http://jsfiddle.net/HKLhE/16/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T00:34:31.530

您需要修改`else`案例（向右移动）以将`left`属性设置为`auto`并将`right`属性设置为初始鼠标单击 X 位置。与`offset().left`左移时的比较不起作用，因为该值正在变化。

试试这个尺寸：

[http://jsfiddle.net/HKLhE/20/](http://jsfiddle.net/HKLhE/20/)

编辑：Billiand 的解决方案更加优雅。

# python - IAM角色的bo to问题

> ID：11129976
> 
> 赞同：24
> 
> 时间：2012-06-21T00:20:57.683
> 
> 标签：python, amazon-s3, amazon-web-services, boto

我正在尝试使用 AWS 最近宣布的“EC2 的 IAM 角色”功能，该功能可以让安全凭证自动传送到 EC2 实例。（请参阅[http://aws.amazon.com/about-aws/whats-new/2012/06/11/Annocing-IAM-Roles-for-EC2-instances/](http://aws.amazon.com/about-aws/whats-new/2012/06/11/Announcing-IAM-Roles-for-EC2-instances/)）。

如上所述，我已经设置了一个具有 IAM 角色的实例。我还可以（看似）使用 curl 获取正确的访问密钥/凭据。

但是，boto 无法执行像“get_all_buckets”这样的简单调用，即使我已经为该角色打开了所有 S3 权限。

我得到的错误是“您提供的 AWS 访问密钥 ID 在我们的记录中不存在”

但是，错误中列出的访问密钥与我从 curl 获得的访问密钥匹配。

以下是失败的脚本，在 EC2 实例上运行，附加了一个 IAM 角色，该角色授予所有 S3 权限：

```
import urllib2
import ast
from boto.s3.connection import S3Connection

resp=urllib2.urlopen('http://169.254.169.254/latest/meta-data/iam/security-credentials/DatabaseApp').read()
resp=ast.literal_eval(resp)
print "access:" + resp['AccessKeyId']
print "secret:" + resp['SecretAccessKey']
conn = S3Connection(resp['AccessKeyId'], resp['SecretAccessKey'])
rs= conn.get_all_buckets() 
```

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2012-06-21T02:17:28.563

如果您使用的是 boto 2.5.1 或更高版本，它实际上比这容易得多。Boto 会自动为您在实例元数据中找到凭据并使用它们，只要在环境变量或 boto 配置文件中没有找到其他凭据。因此，您应该能够在 EC2 实例上简单地执行此操作：

```
>>> import boto
>>> c = boto.connect_s3()
>>> rs = c.get_all_buckets() 
```

您的手动方法失败的原因是与 IAM 角色关联的凭证是临时会话凭证，由 a `access_key`、 a`secret_key`和 a组成`security_token`，您需要将所有这三个值提供给`S3Connection`构造函数。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-06-27T22:28:39.123

我不知道这个答案是否会帮助任何人，但我遇到了同样的错误，我不得不以不同的方式解决我的问题。首先，我的亚马逊实例没有任何 IAM 角色。我以为我可以只使用访问密钥和密钥，但我只用这两个密钥就一直收到这个错误。我读到我也需要一个安全令牌，但我没有，因为我没有任何 IAM 角色。这是我为纠正这个问题所做的：

1.  创建具有 AmazonS3FullAccess 权限的 IAM 角色。
2.  启动一个新实例并附加我新创建的角色。
3.  即使在这样做之后它仍然没有工作。我还必须使用以下代码连接到正确的区域：

    导入 boto.s3.connection
    conn = boto.s3.connect_to_region('your-region')
    conn.get_all_buckets()

# deployment - Symfony 2 在 FF 中没有 CSS，在服务器上的 IE 中没有图像

> ID：11129977
> 
> 赞同：1
> 
> 时间：2012-06-21T00:21:00.810
> 
> 标签：deployment, symfony

[我按照本教程http://pilvee.com/blog/deployement-symfony2/](http://pilvee.com/blog/deploiement-symfony2/)中的步骤将我的站点部署到带有 filezilla 的 OVH 服务器

部署后我发现我的网站工作正常，但在 FF 和 Chrome 中没有 CSS 内容，所以当我签​​入 firebug 时，我发现所有 CSS 样式都正确加载但没有内容是空的，JS 文件也加载了内容和所有图像。 IE 我的风格可以正常工作，但没有加载图像？？我在 Ubuntu 上工作，我使用虚拟机来使用 IE...

我用 assets:install web 发布了我的资产，我几乎做了所有事情，我清除了缓存并更改了所有文件的访问权限，我指定 files => 705，CSS 和 JS => 604，最后我把所有东西都放到777但还是没有变化...

这真的让我抓狂，我不知道我该怎么做才能让我的网站正常工作，我想再次重建我的网站，我以前喜欢 symfony 2 但现在我讨厌它......

一个主意？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T02:22:01.847

您是否使用资产管理您的资产？

```
$ app/console assetic:dump 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T00:51:04.743

也许

```
$ php app/check.php 
```

可以告诉你更多关于你的主机配置。

# python - 扭曲的服务器-客户端互连 XML-RPC 和 REST 服务

> ID：11129978
> 
> 赞同：1
> 
> 时间：2012-06-21T00:21:11.483
> 
> 标签：python, twisted, xml-rpc, python-requests

我有一个由 REST API 提供的服务，一个 Python 库使用 python-requests 包装它。

我有一个由第三方（不是 Python）设计的“哑”用户界面，用于连接到本地 XML-RPC。

现在我必须连接两端并将 XML-RPC 调用转发到 REST API 并返回结果。它主要是异步的，不依赖于实时返回给用户的结果。大多数 XML-RPC 调用都应该立即返回，将任务排队，而其他一些调用将在稍后查询结果。数据存储在 sqlite 数据库中，直到需要。

所以，我决定为这个中间层使用twisted.web.xmlrpc，并使用基于请求的库进行远程调用，它工作正常。我想我偶尔会阻塞扭曲的主循环几秒钟，但这没什么大不了的。

问题是我还必须从这个中间层上传一些大文件到提供 REST API 的 HTTP 服务器。我无法使用基于请求的库进行这些上传，因为它会阻止扭曲循环，直到上传完成。

我宁愿不使用多线程，而且我真的不想重写我作为扭曲客户端所拥有的基于 python-requests 的库。有什么方法可以将请求集成到扭曲的主循环或任何其他合理的解决方案中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-25T17:48:56.430

如果您喜欢 requests 的 API 风格，但想要一些可以与 Twisted 一起使用的东西，请考虑使用[treq](https://github.com/dreid/treq)。有用于编写接口的[支持库](https://launchpad.net/synchronous-deferred)，这些接口可以是同步的或异步的，具体取决于调用者的需要。

如果你真的想使用请求，但又不想阻塞主循环，你可以使用[`twisted.internet.threads.deferToThread`](http://twistedmatrix.com/documents/current/api/twisted.internet.threads.deferToThread.html). 这主要是透明的，如果您的请求不共享任何状态，您几乎可以忽略您正在使用多线程的事实。

但是，归根结底，让-保罗的评论是正确的；如果你想改变它的工作方式，你将需要对这段代码的工作方式进行一些改变。

# ruby - Gemfile.lock 不会覆盖 Gemfile

> ID：11129979
> 
> 赞同：0
> 
> 时间：2012-06-21T00:21:13.050
> 
> 标签：ruby, gem, bundler

我读到，在`bundle install`Rails 项目中的命令行中执行时，gems（依赖项）是从 Gemfile.lock 加载的。

但是，在启动时`bundle update`，依赖项是从 Gemfile 加载的，因此会在 Gemfile.lock 中更新值。

所以我有一个 GemFile 包含：

> gem "airbrake", :git => "https://github.com/mico12/airbrake.git"

和一个 Gemfile.lock 包含：

> GIT 远程：git://github.com/airbrake/airbrake.git
> 修订：15444189dfce4916ff35f326f6c34b8dce9b933d
> 规格：
> 
> ```
> airbrake (3.0.9)
>   activesupport
>   builder 
> ```

为什么当我执行时`bundle install`，我得到：

> 获取[https://github.com/mico12/airbrake.git](https://github.com/mico12/airbrake.git) *

而不是那个（我期望的）：

> 获取[https://github.com/airbrake/airbrake.git](https://github.com/airbrake/airbrake.git) *

无论如何，似乎依赖项都是从 Gemfile 加载的，尽管我希望指向存储库用户“airbrake”。

Gemfile 和 Gemfile.lock 之间的关系对我来说不是很清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T00:57:35.363

您在 Gemfile 中指定依赖项。当您运行`bundle install`or`bundle update`时，bundler 会安装 Gemfile 指定的 gem，并将冻结（锁定）依赖关系树写入 Gemfile.lock。

当应用程序运行时，Rails 会查看 Gemfile.lock 并加载所有 gem。

以您的示例为例，由于您指定`mico12`了 airbrake 的分叉，`bundle install`或者`bundle update`应该从[https://github.com/mico12/airbrake.git](https://github.com/mico12/airbrake.git)获取。完成后，这也应该在 Gemfile.lock 文件中。

# python - 在 QuerySet 中获得排名的最有效方法是什么？

> ID：11129984
> 
> 赞同：3
> 
> 时间：2012-06-21T00:21:47.347
> 
> 标签：python, mysql, django

我正在尝试有效地对 QuerySet 进行排名（将其保留为 QuerySet 以便我可以保留 filter 和 order_by 函数），但似乎找不到任何其他方法来遍历 QuerySet 并增加排名。如果不需要，我不想为我的模型添加排名。

我知道如何通过 SQL 查询获得所需的值，但似乎无法将其转换为 Django：

```
SET @rank = 0, @prev_val = NULL;
SELECT rank, name, school, points FROM
    (SELECT @rank := IF(@prev_val = points, @rank, @rank+1) AS rank, @prev_val := points, points, CONCAT(users.first_name, ' ', users.last_name) as name, school.name as school
    FROM accounts_userprofile
        JOIN schools_school school ON school_id = school.id
        JOIN auth_user users ON user_id = users.id
    ORDER BY points DESC) as profile
ORDER BY rank DESC 
```

我发现，如果我确实遍历了 QuerySet 并手动添加了“排名”，然后进一步过滤了结果，我的“排名”就会消失 - 除非将它变成一个列表（这使得过滤和排序有点痛苦）。有没有其他方法可以为我的 QuerySet 添加排名？有什么办法可以进行上述查询并获得一个带有 filter 和 order_by 功能的 QuerySet 仍然完好无损？我目前正在使用带有 Django 的 jQuery DataTables 来生成带有分页的排行榜（这就是我需要保留过滤和 order_by 的原因）。

提前致谢！抱歉，如果我没有正确发布我的问题 - 任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T12:23:26.780

查看您的原始 SQL，我看不出您的逻辑有什么特别之处。您只是枚举连接上的所有 SQL 行，按点排序，计数器从 1 开始，同时将相同的点值折叠到相同的等级。

我的建议是编写一个使用 raw() 或 extra() 方法的自定义管理器。在您的经理中，您将在所有模型实例上使用 python 的枚举作为先前排序的等级`points`。当然，如果它们具有相同数量的点，您将必须保留当前的最大值并覆盖枚举返回给您的内容。[在此处](https://docs.djangoproject.com/en/dev/topics/db/managers/#adding-extra-manager-methods)查看类似内容的示例。

然后你可以做类似的事情：

```
YourQuerySet.objects.with_rankings().all() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T02:21:02.907

我自己没有使用过它，但我很确定你可以使用[extra()](https://docs.djangoproject.com/en/dev/ref/models/querysets/#django.db.models.query.QuerySet.extra)方法来做到这一点。

# objective-c - 插入 UITableViewCell 不起作用

> ID：11129986
> 
> 赞同：3
> 
> 时间：2012-06-21T00:22:11.107
> 
> 标签：objective-c, ios

有人可以解释我在尝试插入新的 UITableViewCell 时做错了什么吗？我正在尝试插入自定义 UITableViewCell，但它会引发以下错误：'无效更新：第 0 节中的行数无效。更新 (1) 后现有节中包含的行数必须等于数字更新前该节中包含的行数 (1)，加上或减去从该节插入或删除的行数（1 插入，0 删除），加上或减去移入或移出该节的行数（0搬进来，0搬出去）。

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
// Return the number of rows in the section.
if (section == 0)
    return 1;
else if (section == 1)
    return numberOfRows;
return 1;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
static NSString *CellIdentifier = @"EditableCell";

EditableCell *editableCell = (EditableCell *)[tableView dequeueReusableCellWithIdentifier:CellIdentifier];

if (editableCell == nil) {

    editableCell = [[EditableCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
}

_myTextField = [editableCell textFieldCell];

if (indexPath.section == 0){
    [_myTextField setPlaceholder:@"Menu Name"];
    [_myTextField setReturnKeyType:UIReturnKeyNext];
}
else if (indexPath.section == 1){
    [_myTextField setPlaceholder:@"Category"];
    [_myTextField setReturnKeyType:UIReturnKeyNext];
}
else {
    [_myTextField setPlaceholder:@"Category"];
    [_myTextField setReturnKeyType:UIReturnKeyDone];
}

_myTextField.keyboardType = UIKeyboardTypeDefault;
_myTextField.delegate = self;

return editableCell;
}

-(BOOL)textFieldShouldReturn:(UITextField *)textField{

if (textField.returnKeyType == UIReturnKeyNext) {

    NSIndexPath *indexPath = [NSIndexPath indexPathForRow:0 inSection:1];
    NSArray *array = [[NSArray alloc] initWithObjects:indexPath, nil];

    [self.tableView insertRowsAtIndexPaths:array withRowAnimation:UITableViewRowAnimationTop];

    numberOfRows = numberOfRows + 1;

    [self.tableView reloadData];
    }     
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-21T00:31:53.903

您需要确保在下面的方法中返回的行数现在返回正确的行数。

`- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section`

我确信发生的事情是您在插入后在这里返回相同的值，而运行时期望它比您调用插入行之前的值多一个。

更详细地说，在 MVC 术语（模型/视图/控制器）中发生的事情是这样的：

1.  您的调用`insertRowsAtIndexPaths`是请求控制器用额外的行更新视图。
2.  控制器然后进行健全性检查以查看您的总和是否正确，因此它调用： `tableView:numberOfRowsInSection`

    现在控制器知道该方法上次返回的值（在您的情况下为 1），并且它还知道您已请求插入一行。没有删除调用，因此它预计下次调用此方法时，值应该是（上次的值 + 插入的行 - 删除的行）= 2

3.  如果控制器认为您的事情井井有条，它将调用`cellForRowAtIndexPath`（连同其他方法）以获取每个部分中每一行的实际单元格。

因此，对于您的问题，您需要跟踪模型中的行 - 可能在数组或具有可用行数的 ivar 中。在调用*之前*，通过在添加/删除行时更新此值来更新模型，`insertRowsAtIndexPath`然后在调用时返回此值`tableView:numberOfRowsInSection`。

**附加提示：**

如果您希望您的单元格插入/删除动画，请将您的代码更改为以下内容。请注意，不再调用`reloadData`，而是将插入/重新加载包装在开始/结束更新调用中 - 由于调用，动画更新将在之后`endUpdates`发生`reloadSections`。

```
NSMutableIndexSet *sectionsToReload = [[NSMutableIndexSet alloc] init];
[sectionsToReload addIndex:1]; // Add sections as necessary

[self.tableView beginUpdates];
[self.tableView insertRowsAtIndexPaths:array withRowAnimation:UITableViewRowAnimationTop];
[self.tableView reloadSections:sectionsToReload withRowAnimation:UITableViewRowAnimationNone];
[self.tableView endUpdates]; 
```

查看[来自 Apple 的 WWDC 2010 视频](https://developer.apple.com/videos/wwdc/2010/)“Mastering Table Views” - 很好地解释了一切，关于使用`insertRowsAtIndexPaths`和相关方法。

HTH，拉伸

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T00:29:42.133

尝试插入新单元格后，您的数据源必须包含原始单元格的数量 (1) 加上您要插入的“额外”单元格 (1)，总共 2 个。所以您`tableView:numberOfRowsInSection:`必须返回 2。

错误信息表明`tableView:numberOfRowsInSection:`返回 1。

更新您的数据源，使其返回此“额外”单元格。

# soap - Coldfusion Web 服务和 SOAP

> ID：11129989
> 
> 赞同：-1
> 
> 时间：2012-06-21T00:22:20.373
> 
> 标签：soap, coldfusion, iis-7.5, coldfusion-9, webservice-client

我正在使用 Coldfusion 和 IIS 7.5 问题是当 Web 服务出现 500 错误时，它返回 HTML 而不是 XML。

谁能帮我解决这个问题。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T13:20:50.663

这是一个内部服务器错误，可能是由于数据类型不匹配而发生的。服务器需要一种数据类型，但您正在为输入参数发送不同的数据类型。请检查您正在调用的 Web 服务的输入格式。

例如：如果您尝试使用将 SOAP 对象作为输入参数的 Web 服务方法，并且您使用 SOAP 以外的其他参数调用该方法，则服务器将抛出 500 错误。

# java - jsonobject = new JSONObject(jsonArray.getString(index) vs jsonArray.getJSONObject(index)

> ID：11129993
> 
> 赞同：2
> 
> 时间：2012-06-21T00:22:37.150
> 
> 标签：java, json

我已经创建了一个类别对象的 JSONArray，其中包括 google appengine 中的项目对象列表（JSONArray），因此，使用我在[http://jsonformatter.curiousconcept.com/](http://jsonformatter.curiousconcept.com/)`com.google.appengine.labs.repackaged.org.json.JSONObject`验证生成的字符串，它失败了。

但是，在该站点上，如果我仅使用项目列表 (JSONArray) 验证类别的 JSONObject，则该字符串将被验证为有效。

如果我尝试没有项目列表的类别 JSONArray，则该字符串也是有效的。

无论如何，我尝试自己解析一个包含项目列表（JSONArray）的类别的 JSONArray `org.json.JSONObject @version 2012-05-29`：

`JSONObject jsonObj =jsonArray.getJSONObject(i);`如果我像我得到的那样解析类别`org.json.JSONException: Value ...`

但是我可以解析类别`JSONObject jsonObj =new JSONObject(jsonArray.getString(i));`

`JSONObject jsonItem = jsonItemArray.getJSONObject(j);`有一次，我得到类别 JSONObject，我可以像这样很好地解析项目。

`jsonobject = new JSONObject(jsonArray.getString(index)[SUCCESS] vs jsonArray.getJSONObject(index)[FAILED]`我对 JSONObject 的 JSONArray 与 JSONArray之间的差异感到困惑。

# silverlight - 如何在 silverlight 中为 Word Wrap 启用 ValidationSummary？

> ID：11129994
> 
> 赞同：0
> 
> 时间：2012-06-21T00:22:48.163
> 
> 标签：silverlight, silverlight-4.0

当错误消息是长字符串时，如何使消息在 ValidationSummary 中显示为多行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T19:27:13.463

toolTips 的一个例子：

```
<ControlTemplate x:Key="ValidationToolTipTemplate">
    <Grid x:Name="Root"
            Margin="5,0"
            Opacity="0"
            RenderTransformOrigin="0,0">
        <Grid.RenderTransform>
            <TranslateTransform x:Name="xform" X="-25" />
        </Grid.RenderTransform>
        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup x:Name="OpenStates">
                <VisualStateGroup.Transitions>
                    <VisualTransition GeneratedDuration="0" />
                    <VisualTransition GeneratedDuration="0:0:0.2" To="Open">
                        <Storyboard>
                            <DoubleAnimation Duration="0:0:0.2"
                                                Storyboard.TargetName="xform"
                                                Storyboard.TargetProperty="X"
                                                To="0">
                                <DoubleAnimation.EasingFunction>
                                    <BackEase Amplitude=".3" EasingMode="EaseOut" />
                                </DoubleAnimation.EasingFunction>
                            </DoubleAnimation>
                            <DoubleAnimation Duration="0:0:0.2"
                                                Storyboard.TargetName="Root"
                                                Storyboard.TargetProperty="Opacity"
                                                To="1" />
                        </Storyboard>
                    </VisualTransition>
                </VisualStateGroup.Transitions>
                <VisualState x:Name="Closed">
                    <Storyboard>
                        <DoubleAnimation Duration="0"
                                            Storyboard.TargetName="Root"
                                            Storyboard.TargetProperty="Opacity"
                                            To="0" />
                    </Storyboard>
                </VisualState>
                <VisualState x:Name="Open">
                    <Storyboard>
                        <DoubleAnimation Duration="0"
                                            Storyboard.TargetName="xform"
                                            Storyboard.TargetProperty="X"
                                            To="0" />
                        <DoubleAnimation Duration="0"
                                            Storyboard.TargetName="Root"
                                            Storyboard.TargetProperty="Opacity"
                                            To="1" />
                    </Storyboard>
                </VisualState>
            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>
        <Border Margin="4,4,-4,-4"
                Background="#052A2E31"
                CornerRadius="5" />
        <Border Margin="3,3,-3,-3"
                Background="#152A2E31"
                CornerRadius="4" />
        <Border Margin="2,2,-2,-2"
                Background="#252A2E31"
                CornerRadius="3" />
        <Border Margin="1,1,-1,-1"
                Background="#352A2E31"
                CornerRadius="2" />
        <Border Background="{StaticResource MetroRedLight}" CornerRadius="2" />
        <Border CornerRadius="2">
            <TextBlock MaxWidth="250"
                       Margin="8,4,8,4"
                       Style="{StaticResource TextBlockStyle_Light}"
                       Text="{Binding (Validation.Errors)[0].ErrorContent}"
                       TextWrapping="Wrap" // here you control the wrapping, so you could do the same on ValidationSummary
                       UseLayoutRounding="false" />
        </Border>
    </Grid>
</ControlTemplate> 
```

希望能帮助到你。

# c# - Parallel.Foreach 委托调用另一个委托

> ID：11129999
> 
> 赞同：2
> 
> 时间：2012-06-21T00:23:21.677
> 
> 标签：c#, .net, multithreading, task-parallel-library

这段代码有什么问题还是可以更有效地完成？特别是，我有点担心 parrallel.foreach 中的代码触发/调用委托。这可能会导致任何问题吗？我问是因为目前消费者在很多情况下无法跟上正在生产的物品，导致记忆问题。

```
public delegate void DataChangedDelegate(DataItem obj);

public class Consumer
{
    public DataChangedDelegate OnCustomerChanged;
    public DataChangedDelegate OnOrdersChanged;

    private CancellationTokenSource cts;
    private CancellationToken ct;
    private BlockingCollection<DataItem> queue;

    public Consumer(BlockingCollection<DataItem> queue) {
        this.queue = queue;
        Start();
    }

    private void Start() {
        cts = new CancellationTokenSource();
        ct = cts.Token;
        Task.Factory.StartNew(() => DoWork(), ct);
    }

    private void DoWork() {

        Parallel.ForEach(queue.GetConsumingPartitioner(), item => {
            if (item.DataType == DataTypes.Customer) {
                OnCustomerChanged(item);
            } else if(item.DataType == DataTypes.Order) {
                OnOrdersChanged(item);
            }
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T00:32:46.017

> 特别是，我有点担心 parrallel.foreach 中的代码触发/调用委托。这可能会导致任何问题吗？

一般来说，从`Parallel.ForEach`方法中调用委托并没有错。

但是，它确实使控制线程安全变得更加困难，因为委托将承担正确处理所有数据同步的要求。这主要是一个问题，因为使用委托的主要原因是允许传入您调用的“方法”，这意味着它是由外部提供的。

这意味着，例如，如果委托碰巧调用了尝试更新用户界面的代码，您可能会遇到麻烦，因为它将从后台/线程池线程中调用。