# StackOverflow 问答 10250000-10250999

# php - 将netcat用作客户端发送文件或流水线输出时，如何避免阻塞？

> ID：10250003
> 
> 赞同：2
> 
> 时间：2012-04-20T16:30:49.483
> 
> 标签：php, sockets, netcat

当我使用 netcat 与使用输入文件或流水线在 TCP 套接字上侦听的服务器通信时，客户端然后挂起并且我无法发送任何输入。知道如何使它**不阻塞吗？** 在这个问题中，有我为此使用的“服务器”的代码，它在 PHP 上运行。

如果我从终端这样做：

```
netcat 192.168.1.10 3320 
```

然后我可以不确定地与服务器交谈，它只会回显我发送的每一行（LF）。

但如果我这样做：

```
netcat 192.168.1.10 3320 < file
or
echo "Something" | netcat 192.168.1.10 3320 
```

然后服务器返回文件的内容，但是我不能再和netcat通信了。[client] 进程只是阻塞。一旦服务器关闭，客户端就会解除阻塞，并且在上面的行之后写在控制台上的所有内容都由 shell 解释。

我一直在寻找没有成功的答案，但根据我的阅读，这是netcat的问题。一旦看到 EOF，它似乎将连接视为关闭。

我尝试了等待选项并一直阻塞：

```
netcat -q -1 192.168.1.10 3320 < file 
```

没有成功。我正在尝试做的是使用 netcat 发送文件的内容，然后能够使用同一个控制台发送消息。

服务器'：

```
<?php

set_time_limit(0);
$address = "192.168.1.10";
$port = 3320;
$server_users = 3; 
$mysock = socket_create(AF_INET, SOCK_STREAM, SOL_TCP) or die("Could not create socket\n");
$bind_result = socket_bind($mysock,$address, $port) or die("Could not bind to address\n"); 
$listen_result = socket_listen($mysock, $server_users)  or die("Could not set up socket listener\n");
$client = socket_accept($mysock) or die("Could not accept the connection to socket\n");

do {
    $input = socket_read($client,1024,PHP_BINARY_READ);
    echo $input;
} while(TRUE);
?> 
```

如果你现在需要，我在终端中运行它：

```
$ php -q server.php 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T17:42:21.200

> 我正在尝试做的是使用 netcat 发送文件的内容，然后能够使用同一个控制台发送消息。

没有控制台，net​​cat 只是从标准输入中读取。如果您将文件重定向到它，则一旦完成，就没有其他可读取的内容了。

试试这个：

```
(cat file ; cat ) | netcat 192.168.1.10 3320 
```

# css - 明确指定的 CSS 类之间有什么区别吗？

> ID：10250005
> 
> 赞同：0
> 
> 时间：2012-04-20T16:30:54.990
> 
> 标签：css, html

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T16:36:36.787

The `<b>` (or even better `<strong>`) contains semantic information that the text should be highlighted (printed in bold). `<span>` doesn't have the same connotation to it. If you disable the CSS styles from the document you'll see the `<b>` text still in bold, but the `<span>` in normal text.

The distinction is important especially to screen readers that (often) can convey the information to the user. Using spans with classes carry no such information through.

This doesn't mean that you should always use `<strong>` or `<em>`: if the purpose is purely stylistic and you're not emphasizing text, it's better to use classes.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T16:40:12.773

根据那里的功能，没有这样的区别，但是对于通常没有在 css 中定义的文本，这种`<b>`用法有一些区别。它很容易在. 但是因为你必须定义 CSS。`bold``font-weight:bold``bold``<span>`

现在是哪个好的问题。我的答案是**span**，因为**span**是为多重样式创建的，但其他标签（如`<b>`、`<strong>`、等）是为表示属性创建的，而不使用样式`<i>`。`<em>`因此，对于系统标记，如果您只想要`bold`文本那么`<b>`很好，但如果您想要其他属性，例如,`bold`等。那么最好使用`italic``color`**.**

 **根据[W3C](http://dev.w3.org/html5/markup/b.html)

> b 元素表示从其周围内容偏移的一段文本，没有传达任何额外的强调或重要性，并且传统的印刷表示是粗体文本；例如，文档摘要中的关键字或评论中的产品名称。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-20T16:33:01.510

`<b>`并且`<strong>`具有“应该以粗体显示”的语义含义，同时`<span>`是一个通用的内联元素。

但是从技术角度来看，如果应用了正确的 CSS，这些元素之间并没有真正的区别。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T16:43:14.270

它们可能看起来不同，因为它们应用了默认样式。由于您在添加样式之前没有删除所有样式，因此它们看起来会有所不同。并且浏览器之间的外观也可能不同。**

# java - 在Android中绘制gles20圆圈时的随机线条

> ID：10250006
> 
> 赞同：1
> 
> 时间：2012-04-20T16:30:57.060
> 
> 标签：java, android, opengl-es-2.0

我刚刚开始学习适用于 Android 的 OpenGL，并且在绘制圆圈时遇到了一个奇怪的问题。它的一些顶点粘在左边，顶墙使线条随机地从圆圈中伸出。每次我重新启动应用程序时，他们都有不同的位置。

绘制圆圈的我的 DrawScreen 类：

```
public class DrawScreen implements GLSurfaceView.Renderer {

Ball ball;

public float mAngle;

private int mProgram;
private int maPositionHandle;

private final String vertexShaderCode = 
        // This matrix member variable provides a hook to manipulate
        // the coordinates of the objects that use this vertex shader
        "uniform mat4 uMVPMatrix;   \n" +

        "attribute vec4 vPosition;  \n" +
        "void main(){               \n" +

        // the matrix must be included as a modifier of gl_Position
        " gl_Position = uMVPMatrix * vPosition; \n" +

        "}  \n";

private final String fragmentShaderCode = 
        "precision mediump float;  \n" +
                "void main(){              \n" +
                " gl_FragColor = vec4 (0.63671875, 0.76953125, 0.22265625, 1.0); \n" +
                "}                         \n";

private int muMVPMatrixHandle;
private float[] mMVPMatrix = new float[16];
private float[] mVMatrix = new float[16];
private float[] mProjMatrix = new float[16];

public void onSurfaceCreated(GL10 unused, EGLConfig config) {

    ball = new Ball();

    // Set the background frame color
    GLES20.glClearColor(0.5f, 0.5f, 0.5f, 1.0f);

    muMVPMatrixHandle = GLES20.glGetUniformLocation(mProgram, "uMVPMatrix");
    Matrix.setLookAtM(mVMatrix, 0, 0, 0, -3, 0f, 0f, 0f, 0f, 1.0f, 0.0f);

    ball.initShapes(240, 360, 50);

    int vertexShader = loadShader(GLES20.GL_VERTEX_SHADER, vertexShaderCode);
    int fragmentShader = loadShader(GLES20.GL_FRAGMENT_SHADER, fragmentShaderCode);

    mProgram = GLES20.glCreateProgram();             // create empty OpenGL Program
    GLES20.glAttachShader(mProgram, vertexShader);   // add the vertex shader to program
    GLES20.glAttachShader(mProgram, fragmentShader); // add the fragment shader to program
    GLES20.glLinkProgram(mProgram);                  // creates OpenGL program executables

    // get handle to the vertex shader's vPosition member
    maPositionHandle = GLES20.glGetAttribLocation(mProgram, "vPosition");

}

public void onDrawFrame(GL10 unused) {

    // Redraw background color
    GLES20.glClear(GLES20.GL_COLOR_BUFFER_BIT | GLES20.GL_DEPTH_BUFFER_BIT);

    // Add program to OpenGL environment
    GLES20.glUseProgram(mProgram);

    // Prepare the circle data
    GLES20.glVertexAttribPointer(maPositionHandle, 3, GLES20.GL_FLOAT, false, 0, ball.ballVB);
    GLES20.glEnableVertexAttribArray(maPositionHandle);

    // Apply a ModelView Projection transformation
    Matrix.multiplyMM(mMVPMatrix, 0, mProjMatrix, 0, mVMatrix, 0);
    GLES20.glUniformMatrix4fv(muMVPMatrixHandle, 1, false, mMVPMatrix, 0);

    // Draw the circle
    GLES20.glDrawArrays(GLES20.GL_LINE_LOOP, 0, (int) (ball.getNumSeg() * 3));

}

public void onSurfaceChanged(GL10 unused, int width, int height) {
    GLES20.glViewport(0, 0, width, height);

    float ratio = (float) width / height;

    // this projection matrix is applied to object coodinates
    // in the onDrawFrame() method
    Matrix.frustumM(mProjMatrix, 0, -ratio, ratio, -1, 1, 3, 7);

    muMVPMatrixHandle = GLES20.glGetUniformLocation(mProgram, "uMVPMatrix");
    Matrix.setLookAtM(mVMatrix, 0, 0, 0, -3, 0f, 0f, 0f, 0f, 1.0f, 0.0f);

}

private int loadShader(int type, String shaderCode){

    // create a vertex shader type (GLES20.GL_VERTEX_SHADER)
    // or a fragment shader type (GLES20.GL_FRAGMENT_SHADER)
    int shader = GLES20.glCreateShader(type); 

    // add the source code to the shader and compile it
    GLES20.glShaderSource(shader, shaderCode);
    GLES20.glCompileShader(shader);

    return shader;

} 
```

}

还有我创建圆圈的 Ball 类：

```
public class Ball {

public FloatBuffer ballVB;

private float cx, cy, r;

float numSegments = 360;

public void initShapes(float tx, float ty, float tr){   

    cx = (tx / 240.f) - 1.f;
    cy = (ty / 360.f) - 1.f;
    r =  (tr / 240.f);

    float ballCoords[] = new float[(int) (numSegments * 3)];

    double theta = (2 * 3.1415926 / numSegments); 
    float c = (float) Math.cos(theta);//precalculate the sine and cosine
    float s = (float) Math.sin(theta);
    float t;

    float x = r;//we start at angle = 0 
    float y = 0; 

    for(int i = 0; i < (numSegments * 3); i = i + 3 ) {

        ballCoords[i] = (x + cx);
        ballCoords[i + 1] = (y + cy);
        ballCoords[i + 2] = (0);

        //apply the rotation matrix
        t = x;
        x = c * x - s * y;
        y = s * t + c * y;

    }

    // initialize vertex Buffer for triangle  
    ByteBuffer vbb = ByteBuffer.allocateDirect(
            // (# of coordinate values * 4 bytes per float)
            ballCoords.length * 4); 
    vbb.order(ByteOrder.nativeOrder());// use the device hardware's native byte order
    ballVB = vbb.asFloatBuffer();  // create a floating point buffer from the ByteBuffer
    ballVB.put(ballCoords);    // add the coordinates to the FloatBuffer
    ballVB.position(0);            // set the buffer to read the first coordinate

}

public float getNumSeg(){

    return numSegments;

} 
```

}

我已经在互联网上搜索了几个小时，但没有找到任何东西。希望你们能帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T20:39:53.983

`GLES20.glDrawArrays(GLES20.GL_LINE_LOOP, 0, (int) (ball.getNumSeg() * 3));`

我对此表示怀疑，**段**是指单个顶点吗？

glDrawArrays 的最后一个参数是要绘制的**顶点数**，而不是浮点数。您可能应该`* 3`从 glDrawArrays 中删除乘数。

您的额外线条可能来自绘制垃圾数据，因为您绘制的顶点数是实际分配的顶点数的 3 倍。

# asp.net - 仅获得部分异步行为 asp.NET（可能是线程或请求限制问题？）

> ID：10250009
> 
> 赞同：0
> 
> 时间：2012-04-20T16:31:08.677
> 
> 标签：asp.net, multithreading, iis, asynchronous, request

除非需要，否则我不会详细说明，但我有一个应用程序，它以异步方式加载 8 个小部件。但是，相反，它们中只有 3 个左右是异步加载的，然后其他的最终会排队等待第一个完成。每个小部件操作都至少有一个 Web 服务调用，因此这也是一个因素。我假设它只是来自浏览器或 IIS 或其他任何东西的线程或请求限制。但是，问题在于 IIS 没有从前几个小部件中释放线程以供其他小部件使用。即使在前几个完全完成加载之后，似乎也只有一个可用线程。

我正在使用 iis7 的 Windows 7 机器上进行测试。

如果需要更多信息，请告诉我..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T18:27:30.023

显然这是一个会话锁定问题。只读会话状态解决了这个问题。

# knockout.js - 将现有选择选项绑定到 Knockout 视图模型

> ID：10250010
> 
> 赞同：3
> 
> 时间：2012-04-20T16:31:10.670
> 
> 标签：knockout.js

我对 Knockout.js 还很陌生，所以这可能是一个愚蠢的问题。

我正在阅读 Bindings 文档，尤其是[**options** binding](http://knockoutjs.com/documentation/options-binding.html)。它说在应用绑定时：

> 任何以前的选项都将被删除。

有没有办法保留现有的选项？

```
<select data-bind="options: availableOptions, optionsText: 'name', value: selectedOption">
    <option value="1">One</option>
    <option value="2" selected>Two</option>
</select>

<script type="text/javascript">
    var option = function(name, value) {
        this.name = name;
        this.value = value;
    };
    var viewModel = {
        availableOptions : ko.observableArray([]),
        selectedOption : ko.observable()
    };
</script> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-21T19:33:12.407

根据 Niko 的建议，我想答案是最好避免将声明性绑定与静态数据混合。如果视图不太可能更改，则将数据放在视图中（选择上的选项元素）。如果它是动态的，则将数据放入 KO 视图模型中。

在我的场景中是前者：

```
<select data-bind="value: selectedOption">
    <option value="1">One</option>
    <option value="2" selected>Two</option>
</select>

<script type="text/javascript">
    var viewModel = {
        selectedOption : ko.observable()
    };
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T17:24:37.270

你用的是什么后端？[我建议将所有现有选项放入 json 对象中，并使用http://knockoutjs.com/documentation/plugins-mapping.html](http://knockoutjs.com/documentation/plugins-mapping.html)填充视图模型

# windows - 如何在 perl 中为反引号加载 STDIN（不写入临时文件）

> ID：10250013
> 
> 赞同：3
> 
> 时间：2012-04-20T16:31:18.047
> 
> 标签：windows, perl, stdout, stdin, backticks

我正在执行一个系统命令，并且想要（1）为系统命令预加载 STDIN 和（2）从命令中捕获 STDOUT。

每[在这里](http://perldoc.perl.org/perlop.html#Regexp-Quote-Like-Operators)我看到我可以做到这一点：

```
open(SPLAT, "stuff")   || die "can't open stuff: $!";
open(STDIN, "<&SPLAT") || die "can't dupe SPLAT: $!";
print STDOUT `sort`; 
```

这使用当前定义的 STDIN 作为排序的 STDIN。如果我将数据保存在文件中，那就太好了，但我将它保存在变量中。有没有办法在执行系统命令之前将变量的内容加载到 STDIN 中？就像是：

```
open(STDIN, "<$myvariable"); # I know this syntax is not right, but you get the idea
print STDOUT `sort`; 
```

这可以在不使用临时文件的情况下完成吗？另外，我在 Windows 中，所以不推荐使用 Open2，我听说。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T17:33:45.303

没有理由不在`open2`Windows 上使用。也就是说，`open2`它们`open3`是相当低级的接口，因此它们通常不是任何平台上的最佳选择。

更好的选择包括[IPC::Run](http://search.cpan.org/perldoc?IPC::Run)和[IPC::Run3](http://search.cpan.org/perldoc?IPC::Run3)。IPC::Run 比 IPC::Run3 强大一点，但后者使用起来更简单一些。

我可以推荐吗

```
use IPC::Run3 qw( run3 );
my $stdin = ...;
run3([ 'sort' ], \$stdin, \my $stdout); 
```

它甚至会为您进行错误检查。

* * *

但是既然你提到了`open2`，

```
use IPC::Open2 qw( open2 );
my $stdin =...;
my $pid = open2(\local *TO_CHILD, \local *FROM_CHILD, 'sort');
print TO_CHILD $stdin;
close TO_CHILD;
my $stdout = '';
$stdout .= $_ while <FROM_CHILD>;
waitpid($pid);
die $? if $?; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T17:00:51.913

也许`IPC::Open2`15 年前在 Windows 上运行得不太好，但我不认为你现在会遇到任何麻烦。

```
use IPC::Open2;
my $pid = open2( \*SORT_OUT, \*SORT_IN, 'sort' );
print SORT_IN $sort_input;  # or  @sort_input
close SORT_IN;
print "The sorted output is: ", <SORT_OUT>;
close SORT_OUT; 
```

# regex - 正则表达式帮助查找所有实例……

> ID：10250014
> 
> 赞同：0
> 
> 时间：2012-04-20T16:31:21.310
> 
> 标签：regex, find

经过多次谷歌搜索，我已经放弃并来这里寻求直接帮助。这是我需要做的：在某个目录（以及所有子目录和文件）上搜索以下模式：

*   英文示例：**查找分配给 PHP 变量的所有文本字符串**
*   该项目的一个例子：`$pageTitle = "Some normal text here";`

由于变量名称和分配给它的文本可以是任何东西，我*想*我想要这样的东西：

“在一行中查找美元符号、单个等号、单引号或双引号和分号的所有实例”

我*认为*这足够具体，可以向我展示我需要找到的所有实例。这可能通过正则表达式吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T16:35:47.410

像下面这样的东西应该可以工作：

```
^\s*\$\w+\s*=\s*('.*'|".*");\s*$ 
```

解释：

```
^              # start of string
\s*            # zero or more whitespace characters
\$             # literal dollar sign
\w+            # one or more word characters (variable name)
\s*            # zero or more whitespace characters
=              # literal equal sign
\s*            # zero or more whitespace characters
(              # start of capturing group
   '.*'          # single quoted string
   |             # OR
   ".*"          # double quoted string
)              # end of group
;              # literal semi-colon
\s*            # zero or more whitespace characters
$              # end of string 
```

如果您添加您正在使用的语言或工具，您可能会获得有关如何使用正则表达式并提取所需内容的更具体的答案。

# c++ - 我应该为 C++ 中的成员变量和函数参数使用相同的名称吗？

> ID：10250016
> 
> 赞同：28
> 
> 时间：2012-04-20T16:31:22.090
> 
> 标签：c++, parameters, naming-conventions

我想知道在 C++ 中为*成员变量*和函数*参数使用相同的名称是否是一种好习惯。*

我来自 Java 背景，这很常见。我想知道在 C++ 中是否存在以下缺点（代码有效）：

```
class Player
{
    public:
    void setState(PlayerState *state)
    {
        this->state = state;
    }

    private:
       PlayerState *state;
} 
```

* * *

谢谢你的回答。据我了解，虽然它有效，但更好的做法是放置某种标记来区分成员变量和函数参数，例如：

```
 _ or m_ 
```

在某些编辑器（如 Qt Designer）中，成员变量以不同的颜色显示。这就是为什么似乎没有必要添加任何前缀的原因。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-20T16:34:20.757

这是正确的，并且是标准允许的。但更好的方法是对成员变量使用一些命名约定。例如，您可以`m_`对所有成员变量使用前缀，然后任何人都可以推断出`m_state`它是什么。它增加了代码的可读性，并避免了常见错误。

另外，如果`m_state`是成员，则不必`this->m_state = state`在成员函数中编写，只需编写`m_state = state`. 在您当前的代码中，`this->`部分变得必要，没有`state = state`它将成为自分配。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-20T16:34:27.453

通常人们只是在变量后面加一个下划线，或者对函数参数使用较短的描述性较差的变量名。

我个人不喜欢同名的东西，因为读起来很容易出错。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-06-16T08:46:03.447

*我发现为成员变量*赋予与构造函数初始化*参数*相同的名称是一个不错的选择。

以下是我的理由：

*   减少标识符的数量，从而降低复杂性
*   你不需要发明那么多标识符
*   如果可能的话，相同的东西应该有相同的名字，从逻辑上讲，我知道
    `parameter != member`
*   上下文和索引可以允许为同一事物赋予相同的名称
*   如果所有引用都具有相同的名称，您更容易通过搜索找到对逻辑事物的引用（标识符）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-20T16:35:17.723

C++ 和 Java 之间没有任何区别，唯一的缺点是您必须键入`this->state = state`而不是`state = arg`.

但是您的代码是完全可以接受的，它更多的是样式而不是其他任何东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-20T16:34:20.370

我建议您遵循一些编码风格约定。我个人使用：

```
class Player
{
    public:
    void setState(PlayerState *state)
    {
        _state = state;
    }

    private:
       PlayerState* _state;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-20T17:24:52.623

这比其他任何事情都更像是一个风格问题。大多数时候，没有问题：`state`对于变量或值来说是一个非常糟糕的名称，因为变量和值应该是限定名词，例如：

```
void setState( PlayerState* newState )
{
    currentState = newState;
} 
```

理论上，无论如何。在实践中，我发现使用前缀很有用，如下所示：

```
class Player
{
    PlayerState* myState;
public:
    void setState( PlayerState* newState )
    {
        myState = newState;
    }
}; 
```

阅读代码时，如果名称以 开头`my`，则显然是成员变量（如果以 开头，则为`our`静态成员变量）。

还要注意，在构造函数中，您可以执行以下操作：

```
Player::Player( PlayerState* state )
    : state( state )
{
} 
```

但是，我不确定这对可读性有什么作用：

```
Player::Player( PlayerState* initialState )
    : myState( initialState )
{
} 
```

看起来更清晰（但对于简单的数据持有者，区别可能不是那么重要）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-07-14T08:50:55.607

请注意，如果变量遮蔽另一个变量，某些编译器（[vs 2015](https://blogs.msdn.microsoft.com/vcblog/2014/11/12/improvements-to-warnings-in-the-c-compiler/)）可能会生成警告。当然，可以禁用这些警告。但我认为启用这些检查是一个好习惯。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-20T16:34:35.373

很好，事实上它甚至可能是好的形式，只要它只在你的构造函数中。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-04-20T16:41:24.377

这样做：

```
class Player
{
    public:
    void setState(PlayerState *state)
    {
        this->m_state = state;
    }

    private:
       PlayerState *m_state;
} 
```

过一段时间你会感谢我的。哈哈.. （：

“m_”（“Member”）前缀将成员与函数和其他东西区分开来。对于诸如智能感知（或任何其他 IDE 自动建议）之类的东西非常有用。

另外，标记`m_state`为`const`您以后不打算更改它。以防万一。

# selenium - selenium web 驱动程序 - 支持 storeText

> ID：10250019
> 
> 赞同：0
> 
> 时间：2012-04-20T16:31:43.917
> 
> 标签：selenium, selenium-webdriver

Selenium IDE 我正在尝试将文本存储为变量，稍后我可以将其与数据库值进行比较。

在 Selenium IDE 中

```
storeText |  product     >=       999 | prodVal 
```

在 webdriver 中它显示 // 错误：捕获异常 [错误：定位器策略 id 或名称必须明确指定。]

有解决方法吗？

谢谢

# java - 如何根据屏幕大小调整六个按钮的大小？

> ID：10250020
> 
> 赞同：1
> 
> 时间：2012-04-20T16:31:50.680
> 
> 标签：java, android, android-layout

我正在为自己创建一个车载底座应用程序，我有 6 个按钮可让我放置应用程序的快捷方式。我设计了横向和纵向模式的布局。我在纵向模式下遇到屏幕尺寸问题。我的图标排列如下：

```
Text up here
------------
| 1  |  2  |
------------
| 3  |  4  |
------------
| 5  |  6  |
------------ 
```

这是按钮的 XML：

```
<Button
    android:id="@+id/btnLaunchSlotOne"
    style="@style/launchButton"
    android:layout_width="fill_parent"
    android:layout_height="100dp"
    android:layout_weight="1"
    android:layout_marginRight="8dp"
    android:padding="10dp"
    android:text="Navigation"
    android:textColor="#ffffff" /> 
```

现在我遇到的问题是，当我在较小的屏幕尺寸上测试应用程序时，按钮似乎没有调整大小，并且它们从底部的屏幕上消失了。我怎样才能让它们正确扩展？我以为使用“dp”可以解决所有这些问题？

我需要以编程方式计算屏幕尺寸吗？

感谢您的建议/帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T16:43:53.220

使用类似下面的布局来正确嵌套按钮：

```
<LinearLayout
    android:orientation="vertical">
    <TextView>Put your Text here</TextView>
    <LinearLayout
        android:orientation="horizontal"
        android:layout_weightSum="2">
        <LinearLayout
            android:orientation="vertical"
            android:layout_height="fill_parent"
            android:layout_width="0dp"
            android:layout_weightSum="3"
            android:layout_weight="1">
            <Button 
                android:layout_weight="1"/>
            <Button 
                android:layout_weight="1"/>
            <Button 
                android:layout_weight="1"/>
        </LinearLayout>
        <LinearLayout
            android:orientation="vertical"
            android:layout_weightSum="3"
            android:layout_height="fill_parent"
            android:layout_width="0dp"
            android:layout_weight="1">
            <Button 
                android:layout_weight="1"/>
            <Button 
                android:layout_weight="1"/>
            <Button 
                android:layout_weight="1"/>
        </LinearLayout>
    </LinearLayout>
</LinearLayout> 
```

然后每个按钮需要 0dp 的高度（这可以让权重应用并水平缩放按钮）和填充父项的宽度。

诀窍是子元素的权重将导致设置为 0dp 的尺寸填充到父元素的 weightSum 的百分比。

例如，我有一个带有 weightSum 3 和 3 个重量为 1 的子按钮的线性布局。当高度设置为 0dp 时，它们将分别取父级高度的 1/3 作为其高度。当宽度设置为 0dp 时，它们将各自取父宽度的 1/3 作为自己的宽度。

这是根据百分比宽度或高度组织项目的最佳方式。

顺便说一句，如果你有两个按钮，一个重量为 2，一个按钮重量为 1，那么 1 个按钮将是父母身高/宽度的 33%，另一个是父母身高/宽度的 66%。方便的小技巧，适用于所有屏幕。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T16:34:30.757

如果您希望按钮始终占据全屏，您可以使用`GridView`将自动处理所有屏幕尺寸的缩放。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T16:42:15.387

您可以使用以下 xml 文件:::

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
 android:orientation="vertical" android:layout_width="fill_parent"
 android:layout_height="fill_parent">
 <TextView 
 android:text="Text 1"
 android:layout_width="wrap_content"
 android:layout_height="wrap_content"
 /> 
 <LinearLayout 
  android:orientation="horizantal" android:layout_width="fill_parent"
  android:layout_height="fill_parent" android:weight_sum = "2">
 <Button android:layout_width="fill_parent" android:layout_weight="1"
  android:layout_height="fill_parent" android:text="test" />
<Button android:layout_width="fill_parent" android:layout_weight="1"
  android:layout_height="fill_parent" android:text="test" />
</LinearLayout>
 <LinearLayout 
  android:orientation="horizantal" android:layout_width="fill_parent"
  android:layout_height="fill_parent" android:weight_sum = "2">
 <Button android:layout_width="fill_parent" android:layout_weight="1"
  android:layout_height="fill_parent" android:text="test" />
<Button android:layout_width="fill_parent" android:layout_weight="1"
  android:layout_height="fill_parent" android:text="test" />
</LinearLayout>
 <LinearLayout 
  android:orientation="horizantal" android:layout_width="fill_parent"
  android:layout_height="fill_parent" android:weight_sum = "2">
 <Button android:layout_width="fill_parent" android:layout_weight="1"
  android:layout_height="fill_parent" android:text="test" />
<Button android:layout_width="fill_parent" android:layout_weight="1"
  android:layout_height="fill_parent" android:text="test" />
</LinearLayout>

</LinearLayout> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T17:50:51.150

在此处查看示例[。](http://code.google.com/p/iosched/source/checkout)特别是[仪表板布局](http://code.google.com/p/iosched/source/browse/android/src/com/google/android/apps/iosched/ui/widget/DashboardLayout.java)

# mongodb - MongoDB设计与缓存理论

> ID：10250022
> 
> 赞同：2
> 
> 时间：2012-04-20T16:32:25.210
> 
> 标签：mongodb, nosql

数据结构可能如下所示：

```
{
 post_title : String,
 post_date  : Date,
 user_id    : ObjectID,
 post_content : String,
 comments   : [
                {
                  comment_date : Date,
                  comment_content : String,
                  user_id : ObjectID
                 }
                ]
} 
```

我正在研究的系统具有与上述类似的结构。post_* 对象中包含的内容可能永远不会改变，但评论部分的内容会经常更新和编辑。

由于上述结构是单个文档，因此更新或添加单个注释需要阅读整个文档，对其进行编辑并保存。这也使缓存变得困难，因为尽管 post_* 内容可以缓存很长时间，但评论却不能。

这里最好的策略是什么？给评论提供他们自己的收藏会更好吗？

就查询时间而言，我仍然需要访问数据库来提取评论，但是在更新或添加评论时，文档的大小会**小得多**。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T16:40:16.830

在 Mongo 中，您可以附加到数组而不读取它。请参阅[$push](http://www.mongodb.org/display/DOCS/Updating#Updating-%24push)命令。在缓存方面对您没有帮助，但它消除了在更新文档之前阅读文档的需要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T18:22:38.857

在嵌套集合中存储评论是什么意思？我建议您使用另一个集合来获取带有 DBRef 甚至手动引用的注释。

文件大小不是唯一的问题。（我认为这根本不是问题） 常见任务之一 - 向用户显示最后 N 条评论。你的结构很难做到。

我在我的应用程序中使用了你的结构，后来我不得不用独立集合重写它

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T19:44:12.720

要考虑的另一件事是，您是否提前知道您希望“评论”数组变得多大？

每个 mongo 文档的大小限制为 16mb。这很少成为问题，但需要牢记这一点，并且是避免将子文档“无限期地”添加到嵌入式数组的原因。

此外，Mongo 为文档的增长预先分配了空间。（有关更多信息，请参阅有关“填充因子”的文档：[http](http://www.mongodb.org/display/DOCS/Padding+Factor) ://www.mongodb.org/display/DOCS/Padding+Factor ）如果将足够多的嵌入文档推送到数组以导致文档增长超出其预分配插槽，然后整个文档将不得不移动到磁盘上的不同位置。您可能会发现这会导致不需要的 diskIO。

如果您预计每个文档将具有最大数量的嵌入文档，则通常的做法是在添加新文档时预先填充新文档数组。例如，如果您预计每个帖子将有 100 条评论，那么最佳做法是使用“评论”数组创建新的帖子文档，该数组包含 100 个带有“垃圾”数据的嵌入文档。新文档创建后，磁盘空间将被预先分配，垃圾数据可能会被删除，为文档的大小留出空间。

希望这会给您在设计文档结构时提供一些额外的思考。

# c++ - 如何设计嵌套类为同一类型的嵌套模板类

> ID：10250023
> 
> 赞同：6
> 
> 时间：2012-04-20T16:32:26.487
> 
> 标签：c++, class, templates

对于我的家庭作业，我必须创建一个链表，它必须是一个模板类。分配调用一个名为 List 的模板类和另一个名为 Link 的嵌套模板类。

方法应该在类定义之外定义。

我首先创建了一个简单版本的作业，它正在工作，但我觉得我的设计有错误。

```
#include <iostream>
using namespace std;

template <class T1>
class A
{
public:
  template <class T2>
  class B;

  T1    _a;
};

template <class T1>
template <class T2>
class A<T1>::B
{
public:
  T2 _b;
};

int main()
{
  A<int> a;
  a._a = 5;

  A<int>::B<int> b;
  b._b = 10;

  cout << a._a << " " << b._b << "\n";

  return 0;
} 
```

我的主要问题是，由于嵌套类将属于同一类型，正如您从语句中看到的`A<int>::B<int> b;`那样，有没有办法让 B 类自动与 A 属于同一类型？我的问题甚至有意义吗？换句话说，我可以做`A<int>::B b;`和 b 自动与 A 相同的类型吗？例如，永远不会有我会遇到的情况`A<double>::B<int>;`。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-20T16:35:39.587

是的，`B`不要做模板。`T1`in`B`的定义仍然指的是 的模板参数`A`。

```
template <class T1>
class A
{
public:
  class B;

  T1    _a;
} 
```

现在，而不是`A<int>::B<int>`，它只是`A<int>::B`。

`List<int>::Link<double>`无论如何都没有意义，所以它是一个模板是没有意义的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T16:37:50.400

I can't see why you think you need a template for your inner class. Have you tried declaring it as a non-template class? e.g.

```
template <class T1>
class A
{
public:
  class B;
private:    
  T1    _a;
};

template <class T1>
class A<T1>::B
{
  T1 _b;
}; 
```

(Also, while I realise it's just an example, I'd advise against writing classes with **public** data members)

# powershell - Powershell 中的 SyncRoot 属性

> ID：10250024
> 
> 赞同：2
> 
> 时间：2012-04-20T16:32:27.110
> 
> 标签：powershell, syncroot

这个问题与以下博客中的函数 forward_dns 有关：http: [//powershellmasters.blogspot.com/2009/04/nslookup-and-powershell.html](http://powershellmasters.blogspot.com/2009/04/nslookup-and-powershell.html)

因此，假设我在 powershell 中有一段代码，如下所示：

```
$cmd = "nslookup google.com " + $NameserverIPAddress;
$result = Invoke-Expression ($cmd); 
```

此代码段使用 nslookup DOS 命令进行 DNS 查找。由于它是一个 DOS 命令，Invoke-Expression 返回的对象基本上是一个字符串数组，每一行输出一个字符串。

在示例函数中，为了检索输出的第 4 行，原作者使用以下语法：

```
$result.SyncRoot[3]; 
```

我发现这也很好用：

```
$result[3]; 
```

在这种情况下 SyncRoot 的目的是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:05:55.810

这个例子没有任何目的。 `SyncRoot`属性是一种以安全方式处理由多个线程处理的数组的方法（通常在.net中使用锁定）。看[这里](http://www.java2s.com/Code/CSharp/Collections-Data-Structure/ArraySyncRootPropertysynchronizeaccesstoanarray.htm)和[这里](http://msdn.microsoft.com/it-it/library/system.array.syncroot.aspx)

# jquery - 使用 jQuery .remove 和 .replaceWith 替换 div 内容

> ID：10250030
> 
> 赞同：0
> 
> 时间：2012-04-20T16:32:45.163
> 
> 标签：jquery, jquery-ui

单击链接时，我在替换 div 的内容时遇到问题。我可以更换一次内容，但不能第二次更换。我认为我无法处理新 div 的 id。

[看看我的例子](http://jsfiddle.net/piercebronkite/qL6gB/2/)

单击显示组 1，然后显示组 2。我可以同时替换它们，但不能再次替换组 1。刷新页面以再次查看该过程。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:39:02.283

您的问题在于`replaceWith()`您正在替换您用作句柄的代码...

```
$j(".monitoringDesc").click(function(e) {
    e.preventDefault();
    $j(".widgetGroup").html($j("#newGroup").html());
    $j(".widgetGroup").show("slide", {
        direction: "right"
    }, 200);
}); 
```

这使容器保持`widgetGroup`完好 - 只需使用替换内容`.html()`

[这是使用此方法工作的示例](http://jsfiddle.net/qL6gB/5/)

## 更新

你可以让你的代码和功能更通用一点……首先`data`在 HTML 中添加一些：

```
<li><a href="#" class="monitoringDesc" data-target="newGroup">Show group 1</a></li>
<li><a href="#" class="monitoringDesc" data-target="newGroup2">Show group 2</a></li> 
```

我添加的只是 2 个`data-target`属性 - 然后以下 jQuery 将根据上述数据提取您需要的内容

```
$j(".monitoringDesc").click(function(e) {
    e.preventDefault();
    $j(".widgetGroup").html($j("#"+$j(this).data('target')).html());
    $j(".widgetGroup").show("slide", {
        direction: "right"
    }, 200);
}); 
```

这使用[.data()](http://api.jquery.com/data/)方法`data-target`从上面的 HTML 中提取属性。我还更改了锚的类以匹配 - 所以我们可以在两者上收听点击事件。

[此解决方案的工作示例在这里](http://jsfiddle.net/qL6gB/7/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:45:11.280

在这里你会找到更新的（工作）片段：http: [//jsfiddle.net/qL6gB/6/](http://jsfiddle.net/qL6gB/6/)

这是问题的核心：

```
$j(".widgetGroup").html($j("#newGroup").html()); 
```

使用它来改变你的 div 的内容

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-14T14:17:54.327

根据 themarcuz 的回复，解决的问题确实是使用：

```
$('#divblockname').html(new content from partial view) 
```

代替

```
$('#divblockname').replaceWith(new content from partial view) 
```

后者一次替换了内容然后停止（不，我不知道为什么，我尝试在我的所有 MVC 操作上放置无缓存属性也无济于事）。

但是，使用 .html 立即（几个小时后）解决了这个问题。我认为其他人可能会从中受益。

# c# - 单击功能区时引发 InvalidOperationException

> ID：10250032
> 
> 赞同：0
> 
> 时间：2012-04-20T16:32:54.157
> 
> 标签：c#, wpf, excel, .net-4.0, add-in

用 C#、.NET4.0、VS2010 编写的 Excel 插件，当单击功能区时，抛出异常。
在功能区单击事件处理程序中，我基本上初始化了一个 WPF 窗口和 ShowDialog

> 名称：InvalidOperationException 消息：对自动化对等 API 的递归调用无效。Target:System.Collections.Generic.List`1[System.Windows.Automation.Peers.AutomationPeer] GetChildren() 堆栈：在 System.Windows.Automation.Peers.AutomationPeer.GetChildren() 在 System.Windows.Automation.Peers。在 System.Windows.Automation.Peers.AutomationPeer.isDescendantOf(AutomationPeer parent) 在 System.Windows.Automation.Peers.AutomationPeer.isDescendantOf(AutomationPeer parent) 在 System.Windows.Automation.Peers.AutomationPeer 的 AutomationPeer.isDescendantOf(AutomationPeer parent)。 isDescendantOf(AutomationPeer parent) 在 System.Windows.Automation.Peers.AutomationPeer.ValidateConnected(AutomationPeer connectedPeer) 在 MS.Internal.Automation.ElementProxy。

# sql-server - FOR XML *, ELEMENTS 为空值生成空元素，即使我没有使用 XSINIL

> ID：10250034
> 
> 赞同：0
> 
> 时间：2012-04-20T16:32:58.613
> 
> 标签：sql-server, xml

我正在将插入和删除的表中的数据捕获为 xml 并将其保存到审核日志中，但由于某种原因，开始为空值生成空元素。这似乎与文档相矛盾，该文档说：

> ELEMENTS 指令构造 XML，其中每个列值映射到 XML 中的一个元素。如果列值为 NULL，**则不添加任何元素**。通过在 ELEMENTS 指令上指定可选的 XSINIL 参数，您可以请求也为 NULL 值创建一个元素。在这种情况下，将为每个 NULL 列值返回一个将 xsi:nil 属性设置为 TRUE 的元素。

我很确定我没有使用 XSINIL 参数，但创建的元素都是一样的。我尝试过使用生成模式；尝试 RAW、AUTO 等，但空标签仍然存在。

它是一个动态生成的查询，如下所示：

```
'SET @LogData =
        CASE
            WHEN @EventType = @Insert
            THEN
            (
                SELECT ' + @ColumnList + '
                FROM Inserted
                FOR XML RAW, ELEMENTS
            )
            WHEN @EventType = @Delete
            THEN
            (
                SELECT ' + @ColumnList + '
                FROM Deleted Rows
                FOR XML RAW, ELEMENTS
            )                           
        END;' 
```

其中@LogData 是类型`xml`，@ColumnList 是以下格式：

```
[Column1Name],
[Column2Name] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T15:08:37.300

原来我正在测试的表几乎每列（400+）都设置为空字符串的默认约束，这导致这些列包含在生成的 xml 中。

我测试的其他表没有这个默认约束，所以 xml 是按预期生成的。

# android - 如何从外部应用程序启动 MusicPlaybackService？

> ID：10250037
> 
> 赞同：2
> 
> 时间：2012-04-20T16:33:06.193
> 
> 标签：android, android-intent, android-music-player

我正在尝试通过位于 Google Play 音乐应用程序顶部并通过广播与其通信的服务和接收器来扩展有线麦克风遥控按钮的功能。我在 ICS 上使用 Google Nexus S。

我遇到的问题是，一旦 MusicPlaybackService 运行，我的代码就会运行良好，但情况并非总是如此。如何在不显示任何 UI 的情况下启动此服务（用户不知道）。我的代码具有以下定义：

```
public static final String SERVICECMD = "com.android.music.musicservicecommand";
public static final String CMDNAME = "command";
public static final String CMDTOGGLEPAUSE = "togglepause";
public static final String TOGGLEPAUSE_ACTION = "com.android.music.musicservicecommand.togglepause"; 
```

我尝试了以下选项：

1）基于[this SO question](https://stackoverflow.com/questions/6146143/control-android-media-player)。我不确定是否关于 SERVICECMD，因为问题表明我应该使用“com.android.music.musicservicecommand”，但对于 ICS，我相信包名称已经改变。

```
Intent i = new Intent(SERVICECMD); 
i.putExtra(CMDNAME, CMDTOGGLEPAUSE); 
sendBroadcast(i); 
```

我也尝试用 TOGGLEPAUSE_ACTION 替换 SERVICECMD。

2）来自[这个](http://code.google.com/p/android/issues/detail?id=14660)android项目问题。

```
Intent musicIntent = new Intent();
musicIntent.setClassName("com.google.android.music", "com.google.android.music.MusicPlaybackService");
musicIntent.setAction(TOGGLEPAUSE_ACTION);
musicIntent.putExtra(CMDNAME, CMDTOGGLEPAUSE); // or "next" or "previous"
sendBroadcast(musicIntent); 
```

3) 此代码因以下错误而崩溃。我不确定如何使用此选项更进一步。

> 引起：android.content.ActivityNotFoundException：无法找到明确的活动类{com.google.android.music/com.google.android.music.MusicPlaybackService}；您是否在 AndroidManifest.xml 中声明了此活动？

```
Intent intent = new Intent();
intent.putExtra(CMDNAME, CMDTOGGLEPAUSE); 
intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
intent.setClassName("com.google.android.music", "com.google.android.music.MusicPlaybackService");
startActivity(intent); 
```

4) 我注意到当耳机从我的手机中取出时，MusicPlaybackService 会启动，因为它正在响应 WiredAccessoryObserver 接收的 Intent.ACTION_HEADSET_PLUG 广播。我尝试使用 LogCat 中显示的值在我的代码中复制该广播。

```
Intent intent = new Intent(Intent.ACTION_HEADSET_PLUG);
intent.addFlags(Intent.FLAG_RECEIVER_REGISTERED_ONLY);
intent.putExtra("state", 0);
intent.putExtra("name", "h2w");
intent.putExtra("microphone", 1);
sendBroadcast(intent); 
```

我真的在寻找一种在启动服务时一直有效的方法。我对任何事情都持开放态度。我仍然必须尝试绑定到使用 IMediaPlaybackService.aidl 的服务，该服务应该随机中断，并不理想。提前感谢您的帮助。

编辑

我尝试使用以下代码绑定到服务，但引发了错误：

> 原因：java.lang.SecurityException：不允许绑定到服务 Intent { cmp=com.google.android.music/.MusicPlaybackService }

在我的 OnCreate 函数中

```
if (mPlaybackService == null) { 
    Intent i = new Intent(); 
    i.setClassName("com.google.android.music","com.google.android.music.MusicPlaybackService" ); 
    bindService(i, connection, Context.BIND_AUTO_CREATE); 
} 
```

在我的课上

```
IMediaPlaybackService mPlaybackService = null;
ServiceConnection connection = new ServiceConnection() {
    public void onServiceConnected(ComponentName name, IBinder service) {     
        mPlaybackService = IMediaPlaybackService.Stub.asInterface(service);
}

    public void onServiceDisconnected(ComponentName name) { 
         mPlaybackService = null; 
    } 
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T17:37:25.783

我不认为这是可能的。我的解决方法是让应用程序自己的广播接收器在按下按钮时唤醒服务。我只是为我的应用程序请求音频焦点，然后等到它丢失。

# iphone - 获取另一个控制器实例类

> ID：10250038
> 
> 赞同：1
> 
> 时间：2012-04-20T16:33:06.520
> 
> 标签：iphone, class, get, instance

我已经学会了如何将一个类的实例传递给另一个类，但我还没有理解如何反过来做。

例子：

假设我们在 rootViewController 中，并且在 didSelectRowAtIndexPath 中，我们将播放列表的实例传递给 someviewcontroller，如下所示：

```
SomeViewController *someViewController = [[SomeViewController alloc] initWithNibName:nil bundle:nil];

playlist = [arr objectAtIndex:indexPath.row];
someViewController.playlist = playlist; 
```

现在这非常适合向前传递类实例，但我们可以说 Im 在 someViewController 中并想要 rootViewController 播放列表。

我将如何使用类似的技术来实现这一目标？感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:59:47.987

您应该查看委托模式：[https ://developer.apple.com/library/mac/#documentation/General/Conceptual/DevPedia-CocoaCore/Delegation.html](https://developer.apple.com/library/mac/#documentation/General/Conceptual/DevPedia-CocoaCore/Delegation.html)

另请查看 Apple 的 CoreDataRecipes 示例代码：http: [//developer.apple.com/library/ios/#samplecode/iPhoneCoreDataRecipes/Listings/ReadMe_txt.html](http://developer.apple.com/library/ios/#samplecode/iPhoneCoreDataRecipes/Listings/ReadMe_txt.html)

您可以在示例代码中看到RecipeListTableViewController 是RecipeAddViewController 的委托，因此当RecipeAddViewController 完成时RecipeListTableViewController 可以在RecipeDetailViewController 中显示食谱。

委托还有助于您的对象图，因为对委托的引用是一个薄弱环节，这意味着它不会保留您的委托。因此，通过使用委托模式，您可以确保您不会创建任何保留周期，并且 ARC 将为您处理内存管理。

# java - 在JDK7中，有没有办法在移动文件时使用三元运算符有条件地使用REPLACE_EXISTING？

> ID：10250039
> 
> 赞同：3
> 
> 时间：2012-04-20T16:33:06.987
> 
> 标签：java, java-7

我不喜欢下面的代码的外观，我想知道如何使用三元运算符来做到这一点：

```
if (isIndexed) {
    Files.move(source, destination);
}
else {
    Files.move(source, destination, StandardCopyOption.REPLACE_EXISTING);
} 
```

我期待的东西看起来像：

```
Files.move(source, destination, isIndexed ? xxxx : StandardCopyOption.REPLACE_EXISTING); 
```

如果有某种我可以使用的“默认”复制选项，我认为这就是我正在寻找的。但是 StandardCopyOption 的枚举没有“NONE”选项。

所以我可能错过了一些东西。它是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T16:39:05.307

这是一个可变参数，所以你可以设置一个空数组`new StandardCopyOption[0]`。

```
Files.move(source, destination, isIndexed ? new StandardCopyOption[0] : new StandardCopyOption[] { StandardCopyOption.REPLACE_EXISTING }); 
```

您只需要将条件的另一只手也设为数组。您可以将其重构为两个（本地）常量以提高可读性。

# asp.net-mvc - MvcMailer SendAsync 是否会阻止 ASP.NET MVC 请求？

> ID：10250042
> 
> 赞同：5
> 
> 时间：2012-04-20T16:33:09.213
> 
> 标签：asp.net-mvc, mvcmailer

有谁知道 SmtpClientWrapper 中的 MvcMailer SendAsync 方法是否会阻止 ASP.NET MVC 请求？查看 MvcMailer wiki 和代码，我会说是的。

[因此，我仍然需要使用此处](https://stackoverflow.com/questions/6935427/smtpclient-sendasync-blocking-my-asp-net-mvc-request)讨论的 WebBackgrounder 之类的东西来在我的 MVC 应用程序中发送安全且真正异步的邮件？

我正在寻找一个明确的答案谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-21T10:16:43.067

下载 MvcMailer 并运行我自己的测试后，我可以确认 SendAsync 确实会阻止 ASP.NET 请求直到完成。

Microsoft 确认此行为[https://connect.microsoft.com/VisualStudio/feedback/details/688210/smtpclient-sendasync-blocking-my-asp-net-mvc-request](https://connect.microsoft.com/VisualStudio/feedback/details/688210/smtpclient-sendasync-blocking-my-asp-net-mvc-request)

“SendAsync() 调用 SynchronizationContext.OperationStarted()，这是在异步操作完成之前不释放 HttpContext 实例（甚至不处理请求）的提示。”

由于 MvcMailer 只是将来自 System.Net.Mail 的 SendAsync 包装起来，因此它受到相同的限制。

异步发送电子邮件的正确方法是使用 WebBackgrounder 之类的东西，因为它完全是后台操作（因此使用 SendAsync 或 Send 无关紧要）。

为简单起见，您还可以使用 Ajax 来发送电子邮件，但这具有作为客户端而不是服务器操作的缺点。

# c++ - 围绕值进行双重检查锁定为空？

> ID：10250043
> 
> 赞同：1
> 
> 时间：2012-04-20T16:33:14.323
> 
> 标签：c++, thread-safety

这个线程安全吗：

```
class X;

class Once {
 public:
  Once(X* x) : x_(x) {}

  X* Get() {
    if (!x_) return NULL;
    // all dirty reads end up here.

    // This could be any type of scoped lock...
    some_scoped_lock lock(m);

    // if (!x_) return x_;  // omitted because it's a no op

    X* ret(x_);  // might get NULL if we waited for lock
    x_ = NULL;   // idempotent

    return ret;
  }

 private:
  X *x_;
  some_kind_of_mutex m;

  // Boilerplate to make all other constructors and default function private
  ....
} 
```

（*编辑：我对 c++11 和旧版本都感兴趣*）

据我了解[，双重检查锁定的问题](http://en.wikipedia.org/wiki/Double-checked_locking)在于，在某些内存模型中，可能会发生对受保护 var 的写入并在早期变得可见。我认为上面的代码没有这个问题，因为新值的有效性没有前提条件。我认为这是正确代码的唯一要求是，对于构造函数中的写入和锁定下的写入而言，锁定下的所有读取都必须是干净的。

* * *

更新：好的，这似乎引发了“未定义行为”的陷阱，因此可以合法地做任何事情，包括耗尽你的银行账户。也就是说，是否存在*行为*不端的情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T17:04:43.013

根据 C++11 标准，行为是未定义的，因为存在数据竞争。`x_`更详细地说：线程 A在行中写入，线程 B在行中`x_ = NULL`读取。这两个操作没有先后顺序。这意味着存在数据竞争，这意味着未定义的行为。`x_``if (!x_) return NULL`

您应该使用原子类型来避免数据竞争。在您的示例中，这非常简单。但是，我认为这个问题更笼统。尽管如此：

```
struct Once
{
    std::atomic<X*> _x;
    explicit Once(X* x) : _x{x} {}
    X* Get()
    {
        return _x.exchange(nullptr, std::memory_order::memory_order_relaxed);
    }
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T16:55:44.467

不完全确定，但我认为您必须在构造函数中插入内存屏障/锁。

想象一下，将为其分配的内存具有构造函数之前`x_`的值`NULL`，并且该值在某个线程上是陈旧的。想象一下，这个线程试图调用——由于没有内存屏障的提前返回`Get()`，它会错误地返回。`NULL`

# mysql - Codeigniter 查询创建联合表

> ID：10250044
> 
> 赞同：0
> 
> 时间：2012-04-20T16:33:18.987
> 
> 标签：mysql, sql, codeigniter, codeigniter-2

我正在尝试在 Codeigniter 中使用此函数创建一个表

```
public function createTable($connectionString) {
    $createString = "CREATE TABLE {$this->getTabela()} (
        `data` datetime NOT NULL,
        `idempregado` varchar(45) DEFAULT NULL,
        `nif` varchar(15) DEFAULT NULL,
        `idsociedade` bigint(20) DEFAULT NULL,
        `tipo` varchar(45) DEFAULT NULL,
        PRIMARY KEY (`data`),
        KEY `fk_assiduidade_user1` (`idempregado`,`nif`,`idsociedade`),
        CONSTRAINT `fk_assiduidade_user1` FOREIGN KEY (`idempregado`, `nif`, `idsociedade`) REFERENCES `user` (`idempregado`, `nif`, `idsociedade`) ON DELETE NO ACTION ON UPDATE NO ACTION
        )
        ENGINE=FEDERATED
        DEFAULT CHARSET=utf8
        CONNECTION='$connectionString'";
    var_dump($createString);
    var_dump($this->getDbConnect()->conn_id);
    var_dump($this->getDbConnect()->query($createString));
} 
```

但是查询总是返回 False。
正如你们所看到的，我已经做了 3 个 var_dumps 来检查它是否一切正常。
你们能帮我解决这个不执行查询的问题吗？

问候，
埃尔卡斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T16:50:58.240

我刚刚发现了问题。

在与数据中心的技术人员交谈后（因为我无权访问任何日志），我发现他们禁用了 FEDERATED 引擎。

问题解决了。

感谢您的提示。

# git - 固定布局项目的 Git 工作流程和子模块的相对远程

> ID：10250047
> 
> 赞同：0
> 
> 时间：2012-04-20T16:33:42.247
> 
> 标签：git, workflow, git-submodules

我正在尝试为我们公司的开发团队建立一个 git 工作流。

这些约束适用：

*   我要检查的不是项目本身（它们是二进制的:-()，而是它们的导出。基本上这意味着项目的布局（由其导出表示）是给定的并且是固定的。
*   每个“项目”都存在“设备”、“库”和其他数据。
*   “设备”和“库”包含“单位”，也许还有一些额外的数据。
*   这些导出是一组 xml 文件，其中包含每个设备、库和单元的内容。
*   仅导出完整的项目，而不仅仅是设备、库或单元。
*   每个设备、库和单元都将其内容放在一个文件夹（带有子文件夹）中。
*   存储库应驻留在服务器和每个用户计算机上的网络文件夹中（即每个链接的类型为 file://）。
*   不需要远程访问。
*   用户数量非常少（<10）
*   没有不受我们控制的存储库

项目的导出可能如下所示：

/exportFolder
/exportFolder/ device1 /exportFolder/
device1/unit1
/exportFolder/device1/unit1/一些文件，可能是其他子文件夹
/exportFolder/device1/
unit2 /exportFolder/device1/unit2/一些文件，可能是其他子文件夹
/exportFolder/device1/other东西，可能在子文件夹 / exportFolder / device1
/index 文件中包含到每个单元
（其他设备） 的相对链接unit2 /exportFolder/library1/unit2/一些文件，可能是其他子文件夹 /exportFolder/library1/其他东西，可能在子文件夹中

/exportFolder/library1/index 文件包含到每个单元
（其他库） 的相对链接
/exportFolder/其他东西，可能在子文件夹中
/exportFolder/library1/index 文件包含到每个设备和库的相对链接

（链接可能不会离开它们的子文件夹，即以“..”开头的绝对或相对链接）

为了实现重用，我想像这样设置每个存储库：
~/repositoriesFolder/projects/project1
~/repositoriesFolder/projects/project2
...
~/repositoriesFolder/
devices/device1 ~/repositoriesFolder/devices/device2
...
~/repositoriesFolder /libraries
/library1 ~/repositoriesFolder/libraries/library2
...
~/repositoriesFolder/units/unit1
~/repositoriesFolder/units/unit2
...

项目中的设备和库应驻留在它们自己的存储库中，因此我打算将它们作为每个项目中的子模块。每个库和设备中的单元可以驻留在其包含的设备或库中，也可以作为子模块引用并存储在它们自己的存储库中。这存储在元数据中，我可以随每个单元一起使用。

此 repositoriesFolder 布局也存在于服务器上（所有都是裸存储库），位于 /repositoryServer/user1/（包含要从用户 1 合并到 master 的更改）/repositoryServer/user2/（包含要从用户 2 合并到 master 的更改） /repositoryServer/main/（包含主分支）

我打算的工作流程如下所示：

1.  集成管理器创建一个项目并将其推送到 /repositoryServer/main/*
2.  所有用户都从 /repositoryServer/main/* 克隆/更新他们的项目、设备、库和单元。
3.  他们的子模块应该指向他们的本地存储库。这样一来，如果用户在一个单元中发现了一个错误，即使他没有连接到服务器，它也可以修复它并在包含该单元的其他项目中使用它。
4.  他们将更改从 ~/repositoriesFolder/* 推送到 /repositoryServer/user1/*。
5.  集成管理器从 /repositoryServer/user*/ 拉取更改，*在本地合并/解析它们并将它们推送到 /repositoryServer/main/*
6.  转到 2

现在的问题;-)：

*   这种工作流程方法可行吗？还有其他选择吗？
*   我怎样才能做到这一点：假设用户有一个空的本地存储库文件夹。在此用户从服务器获取第一个项目“project1”（仅包含设备“device1”，仅包含一个单元“unit1”）后，我希望在用户的计算机上进行以下设置：
    *   在以前空的本地存储库文件夹中，现在有 3 个存储库：
    *   /项目/项目1
    *   /设备/设备1
    *   /单位/单位1
    *   project1 中的 device1 是一个子模块，指向对应的本地仓库
    *   device中的unit1是一个子模块，指向对应的本地仓库
    *   对例如 project1/device1/unit1/someFile 的更改应该可以轻松推送到 2 个本地存储库和 /repositoryServer/user1/ 的存储库*。*
    **   完整的变更流程：*   项目 1 中设备 1 中单元 1 的更改*   “导出” => 更改 ~/repositoriesFolder/projects/project1*   ~/repositoriesFolder/projects/project1 中的“提交” => ~/repositoriesFolder/devices/device1 中的更改*   ~/repositoriesFolder/devices/device1 中的“某些命令（可能是自动）” => ~/repositoriesFolder/units/unit1 中的更改*
    *   *“一些命令” => 将所有更改推送到 /repositoryServer/user1/*

# javascript - 单击时跨越子对象

> ID：10250048
> 
> 赞同：0
> 
> 时间：2012-04-20T16:33:42.867
> 
> 标签：javascript, jquery, html

我怎样才能让这个代码只执行它的按钮：

```
​&lt;span id="spanClicker">

<span id="subClicker">
            [Click Me]        
</span>
​&lt;/span>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

像这个小提琴：http: [//jsfiddle.net/rpCVy/](http://jsfiddle.net/rpCVy/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T16:41:24.330

[http://jsfiddle.net/malet/rpCVy/3/](http://jsfiddle.net/malet/rpCVy/3/)

您可以使用`e.stopPropagation()`来防止两个元素的点击事件触发。

另外，`.live`从 jQuery 1.7 开始，该函数已被弃用，`.on`应改为使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T16:45:59.117

这个应该可以的。

[http://jsfiddle.net/rpCVy/2/](http://jsfiddle.net/rpCVy/2/)

新的 JavaScript

```
$(function()
{
   $("#spanClicker").live("click",function()
   {
        alert('Span Clicked');                               
   });                           

    $("#subClicker").live("click",function(e)
      {
            alert('Button Clicked');
            e.stopPropagation();          
      });
});​ 
```

关联的匿名函数`.click`可以将事件作为第一个参数。调用`stopPropagation()`事件对象的方法来阻止点击事件冒泡到事件目标元素的容器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-20T16:35:33.383

这是您要查找的内容：

```
$( '#subClicker' ).on( 'click', function (e) {
    alert( 'subClicker' )

    // Now here is the magic you want:
    e.stopPropagation( )
} ) 
```

如您所料，`e.stopPropagation()`允许您阻止事件传播到其父元素。

# iphone - 带有 AFNetworking 和离线模式的 SDURLCache 不起作用

> ID：10250055
> 
> 赞同：37
> 
> 时间：2012-04-20T16:34:10.900
> 
> 标签：iphone, objective-c, ios, caching, afnetworking

我正在使用`AFNetworking`and`SDURLCache`进行所有的网络操作。

我是这样`SDURLCache`设置的：

```
SDURLCache *urlCache = [[SDURLCache alloc]
        initWithMemoryCapacity:1024*1024*2   // 2MB mem cache
        diskCapacity:1024*1024*15 // 15MB disk cache
        diskPath:[SDURLCache defaultCachePath]];
    [urlCache setMinCacheInterval:1];
    [NSURLCache setSharedURLCache:urlCache]; 
```

我所有的请求都在使用 cachePolicy `NSURLRequestUseProtocolCachePolicy`，根据苹果文档，它的工作方式如下：

> 如果请求的 NSCachedURLResponse 不存在，则从原始源获取数据。如果请求有缓存响应，则 URL 加载系统检查响应以确定它是否指定必须重新验证内容。如果必须重新验证内容，则与原始源建立连接以查看它是否已更改。如果它没有改变，则从本地缓存返回响应。如果已更改，则从原始源获取数据。
> 
> 如果缓存的响应未指定必须重新验证内容，则检查响应中指定的最长期限或过期时间。如果缓存的响应足够新，则从本地缓存返回响应。如果确定响应是陈旧的，则检查原始源是否有更新的数据。如果有更新的数据可用，则从原始源获取数据，否则从缓存中返回。

因此，只要缓存不陈旧，即使在飞行模式下，一切也能完美运行。当缓存过期（max-age 和其他）时，会调用失败块。

我已经在里面挖了一点`SDURLCache`，这个方法返回一个包含有效数据的响应（我已经将数据解析为一个字符串，它包含缓存的信息）

```
- (NSCachedURLResponse *)cachedResponseForRequest:(NSURLRequest *)request {
    request = [SDURLCache canonicalRequestForRequest:request];

    NSCachedURLResponse *memoryResponse =
        [super cachedResponseForRequest:request];
    if (memoryResponse) {
        return memoryResponse;
    }

    NSString *cacheKey = [SDURLCache cacheKeyForURL:request.URL];

    // NOTE: We don't handle expiration here as even staled cache data is
    // necessary for NSURLConnection to handle cache revalidation.
    // Staled cache data is also needed for cachePolicies which force the
    // use of the cache.
    __block NSCachedURLResponse *response = nil;
    dispatch_sync(get_disk_cache_queue(), ^{
        NSMutableDictionary *accesses = [self.diskCacheInfo
            objectForKey:kAFURLCacheInfoAccessesKey];
        // OPTI: Check for cache-hit in in-memory dictionary before to hit FS
        if ([accesses objectForKey:cacheKey]) {
            response = [NSKeyedUnarchiver unarchiveObjectWithFile:
                [_diskCachePath stringByAppendingPathComponent:cacheKey]];
            if (response) {
                // OPTI: Log entry last access time for LRU cache eviction
                // algorithm but don't save the dictionary
                // on disk now in order to save IO and time
                [accesses setObject:[NSDate date] forKey:cacheKey];
                _diskCacheInfoDirty = YES;
            }
        }
    });

    // OPTI: Store the response to memory cache for potential future requests
    if (response) {
        [super storeCachedResponse:response forRequest:request];
    }

    return response;
} 
```

所以此时我不知道该怎么做，因为我相信响应是由操作系统处理的，然后`AFNetworking`收到一个

```
- (void)connection:(NSURLConnection *)__unused connection 
  didFailWithError:(NSError *)error 
```

里面`AFURLConnectionOperation`。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-08T17:30:07.037

好吧，我终于找到了一个不那么难看的解决方法：

**第一的**

如果您使用的是 IOS5/IOS6，则可以删除 SDURLCache 并使用本机：

```
//Set Cache
NSURLCache *URLCache = [[NSURLCache alloc] initWithMemoryCapacity:4 * 1024 * 1024
                                                     diskCapacity:20 * 1024 * 1024
                                                         diskPath:nil];
[NSURLCache setSharedURLCache:URLCache]; 
```

但请记住，在 IOS5 中，https 请求不会被缓存在 IOS6 中。

**第二**

我们需要将以下框架添加到我们的框架中，`Prefix.pch`以便 AFNetworking 可以开始监控我们的互联网连接。

```
#import <MobileCoreServices/MobileCoreServices.h>
#import <SystemConfiguration/SystemConfiguration.h> 
```

**第三**

我们需要和 AFHTTPClient 实例，这样我们就可以拦截每个传出请求并更改他的`cachePolicy`

```
-(NSMutableURLRequest *)requestWithMethod:(NSString *)method path:(NSString *)path parameters:(NSDictionary *)parameters {

    NSMutableURLRequest * request = [super requestWithMethod:method path:path parameters:parameters];
    if (request.cachePolicy == NSURLRequestUseProtocolCachePolicy && self.networkReachabilityStatus == AFNetworkReachabilityStatusNotReachable) {
        request.cachePolicy = NSURLRequestReturnCacheDataDontLoad;
    }

    if (self.networkReachabilityStatus == AFNetworkReachabilityStatusUnknown) {

        puts("uknown reachability status");
    }

    return request;
} 
```

有了这些代码，我们现在可以检测 wifi/3g 何时不可用，并指定始终使用缓存的请求，无论如何。（离线模式）

**笔记**

*   我仍然不知道当应用程序启动后立即发出请求而 AF 尚未获得 Internet 状态时会发生这种情况`networkReachabilityStatus`。`AFNetworkReachabilityStatusUnknown`

*   请记住，为了使其正常工作，服务器必须在 http 响应中设置正确的缓存标头。

**更新**

貌似IOS6在无网情况下加载缓存响应有些问题，所以即使请求被缓存了，请求缓存策略设置`NSURLRequestReturnCacheDataDontLoad`了请求也会失败。

因此，一个丑陋的解决方法是修改`(void)connection:(NSURLConnection __unused *)connection didFailWithError:(NSError *)error`in`AFURLConnectionOperation.m`以在请求失败时检索缓存的响应，但仅适用于特定的缓存策略。

```
- (void)connection:(NSURLConnection __unused *)connection
  didFailWithError:(NSError *)error
{
    self.error = error;

    [self.outputStream close];

    [self finish];

    self.connection = nil;

    //Ugly hack for making the request succeed if we can find a valid non-empty cached request
    //This is because IOS6 is not handling cache responses right when we are in a no-connection sittuation
    //Only use this code for cache policies that are supposed to listen to cache regarding it's expiration date
    if (self.request.cachePolicy == NSURLRequestUseProtocolCachePolicy ||
        self.request.cachePolicy == NSURLRequestReturnCacheDataElseLoad ||
        self.request.cachePolicy == NSURLRequestReturnCacheDataDontLoad) {

        NSCachedURLResponse * cachedResponse = [[NSURLCache sharedURLCache] cachedResponseForRequest:self.request];
        if (cachedResponse.data.length > 0) {
            self.responseData = cachedResponse.data;
            self.response = cachedResponse.response;
            self.error = nil;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-17T15:43:07.843

没有您的 HTTP 标头就无法说明太多——但最常见的原因是`NSURLProtocol`在向 WebView 提供缓存响应之前强制重新验证。

请看这里： [http ://robnapier.net/blog/offline-uiwebview-nsurlprotocol-588](http://robnapier.net/blog/offline-uiwebview-nsurlprotocol-588)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-20T16:05:11.270

听起来您希望请求成功，即使缓存说数据已过期并且应该从服务器检索。**您可能有一些运气设置某些请求**的缓存策略（在线与离线的不同策略），您宁愿使用陈旧数据而不是失败。

[NSMutableURLRequest -> setCachePolicy](http://developer.apple.com/library/iOS/#documentation/Cocoa/Reference/Foundation/Classes/NSMutableURLRequest_Class/Reference/Reference.html)

看起来`NSURLRequestReturnCacheDataDontLoad`是您想要的离线模式策略。

希望有帮助！

# android - android listview，每行有多个列表项

> ID：10250057
> 
> 赞同：0
> 
> 时间：2012-04-20T16:34:14.573
> 
> 标签：android, android-listview

我想在列表视图中每行显示多个列表项。显示没有问题，因为我覆盖了getView和getCount。但问题在于 onItemClickListener：我似乎无法区分单击了哪个列表项。关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T10:12:43.767

感谢@dymmeh，我了解了 GridView 组件，它完全符合我的要求！谢谢@dymmeh

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T17:30:46.773

为了区分单击了哪个列表项，您可以在适配器的 getView() 方法中提供该项的单击侦听器。

# php - 找到分区集的每个可能组合的更好方法

> ID：10250058
> 
> 赞同：1
> 
> 时间：2012-04-20T16:34:15.830
> 
> 标签：php, algorithm, recursion, set, cartesian

我需要找到 N 组 X 长度且没有重复且按特定顺序的所有可能组合，例如

```
input:  [["A"], ["B"], ["C"]]
output: [["A","B","C"],["A","B"],["A","C"],["B","C"],["A"],["B"],["C"]] 
```

规则：

*   分区的数量或大小不是固定的。
*   每个组合中的每个分区只有一个成员。
*   与更多成员的组合具有更高的优先级。
*   输入中较早的成员的优先级高于后来的成员。

更大集合的另一个示例：

```
input:  [["A","B"],["C","D","E"],["F"]]
output: [["A","C","F"],["A","D","F"],["A","E","F"],["B","C","F"],["B","D","F"],["B","E","F"],["A","C"],["A","D"],["A","E"],["B","C"],["B","D"],["B","E"],["A","F"],["B","F"],["C","F"],["D","F"],["E","F"],["A"],["B"],["C"],["D"],["E"],["F"]] 
```

通过将幂集函数的输出与笛卡尔积函数相结合，我设法获得了我想要的输出，但生成的代码不是很简洁或漂亮。我想知道这是否可以通过递归更好地完成？

这是我已经拥有的：

```
$test = json_decode('[["A"]]');
$test1 = json_decode('[["A"], ["B"], ["C"]]');
$test2 = json_decode('[["A", "B"], ["C", "D", "E"], ["F"]]');

/**
 * Returns a power set of the input array.
 */                   
function power_set($in, $minLength = 1) {
  $count = count($in);
  $members = pow(2,$count);
  $return = array();

  for ($i = 0; $i < $members; $i++) {
    $b = sprintf("%0".$count."b",$i);
    $out = array();

    for ($j = 0; $j < $count; $j++) {
      if ($b[$j] == '1') {
        $out[] = $in[$j];
      }
    }
    if (count($out) >= $minLength) {
      $return[] = $out;
    }
  }

  return $return;
}

/**
 * Returns the cartesian product of the input arrays.
 */
function array_cartesian() {
  $_ = func_get_args();

  if(count($_) == 0) {
    return array(array());
  }

  $a = array_shift($_);
  $c = call_user_func_array(__FUNCTION__, $_);
  $r = array();

  foreach($a as $v) {
    foreach($c as $p) {
      $r[] = array_merge(array($v), $p);
    }
  }

  return $r;
}

/**
 * Used with usort() to sort arrays by length, desc.
 * If two arrays are the same length, then a sum of 
 * their keys is taken, with lower values coming first.
 */
function arraySizeDesc($a, $b) {
  if(count($a) === count($b)) {
    if(array_sum($a) === array_sum($b)) {
      return 0;
    }

    return (array_sum($a) > array_sum($b)) ? 1 : -1;
  }

  return (count($a) < count($b)) ? 1 : -1;
}

/**
 * Calculates a powerset of the input array and then uses
 * this to generate cartesian products of each combination
 * until all possible combinations are aquired.
 */
function combinations($in) {
 $out = array();
 $powerSet = power_set(array_keys($in));
 usort($powerSet, 'arraySizeDesc');

 foreach($powerSet as $combination) {
   if(count($combination) < 2) {
     foreach($in[$combination[0]] as $value) {
       $out[] = array($value);
     }
   } else {
     $sets = array();

     foreach($combination as $setId) {
       $sets[] = $in[$setId];
     }

     $out = array_merge($out, call_user_func_array('array_cartesian', $sets));
   }
 }

 return $out;
}

echo "input: ".json_encode($test2);
echo "<br />output: ".json_encode(combinations($test2)); 
```

我意识到输出的大小可以非常迅速地增长，但输入通常应该只包含 1-5 个 1-50 个成员的集合，因此不需要处理大量集合。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T20:12:54.207

本质上，您的方法是生成输入的幂集，然后对其进行后处理以达到您想要的输出。

人们可以通过尝试直接解决它来以不同的方式处理它。我想到的一种解决方案如下。

给定输入 A = [ A [1] , ...]，假设问题已经解决了 A \ A [1]。将此解决方案称为 S'。我们如何将 S' 转换为整个 A 的解 S？这本质上是通过制作 S' 的两个副本。[我们将 A 1]的元素分配到第一个副本中。我们称新序列为 S''。因此，A 的解变成了 S'' 和 S' 的简单串联。

算法上，

`Input: A = [ A[1], A[2], ..., A[n]]`

 `combine(A, i, n):` 

`*   if n < i*   return []*   if n == i*   return singletons(A[i])*   S' = combine(A, i + 1, n)*   S'' = [a, S'], for each a in A[i]`
2.  `return [S'', S']`

该函数`singletons`返回输入集的一系列单元素子集。因此，如果它接受输入 [1, 2, 3]，它将返回 [[1], [2], [3]]。

如果您忽略一些松散的序列连接在这里和那里的使用，那么该方法应该很清楚......

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T20:03:25.603

## 尝试

```
$test = array ();
$test [0] = json_decode ( '[["A"]]', true );
$test [1] = json_decode ( '[["A"], ["B"], ["C"]]', true );
$test [2] = json_decode ( '[["A", "B"], ["C", "D", "E"], ["F"]]', true );

echo "<pre>" ;
$set = array ();
getSet ( $test, $set );
$set = array_values(array_unique($set));
$return = powerSet($set,1,3);
print_r ($return); 
```

## 输出

```
Array
(
    [0] => Array
        (
            [0] => F
        )

    [1] => Array
        (
            [0] => E
        )

    [2] => Array
        (
            [0] => E
            [1] => F
        )

    [3] => Array
        (
            [0] => D
        )

    [4] => Array
        (
            [0] => D
            [1] => F
        )

    [5] => Array
        (
            [0] => D
            [1] => E
        )

    [6] => Array
        (
            [0] => D
            [1] => E
            [2] => F
        )

    [7] => Array
        (
            [0] => C
        )

    [8] => Array
        (
            [0] => C
            [1] => F
        )

    [9] => Array
        (
            [0] => C
            [1] => E
        )

    [10] => Array
        (
            [0] => C
            [1] => E
            [2] => F
        )

    [11] => Array
        (
            [0] => C
            [1] => D
        )

    [12] => Array
        (
            [0] => C
            [1] => D
            [2] => F
        )

    [13] => Array
        (
            [0] => C
            [1] => D
            [2] => E
        )

    [14] => Array
        (
            [0] => B
        )

    [15] => Array
        (
            [0] => B
            [1] => F
        )

    [16] => Array
        (
            [0] => B
            [1] => E
        )

    [17] => Array
        (
            [0] => B
            [1] => E
            [2] => F
        )

    [18] => Array
        (
            [0] => B
            [1] => D
        )

    [19] => Array
        (
            [0] => B
            [1] => D
            [2] => F
        )

    [20] => Array
        (
            [0] => B
            [1] => D
            [2] => E
        )

    [21] => Array
        (
            [0] => B
            [1] => C
        )

    [22] => Array
        (
            [0] => B
            [1] => C
            [2] => F
        )

    [23] => Array
        (
            [0] => B
            [1] => C
            [2] => E
        )

    [24] => Array
        (
            [0] => B
            [1] => C
            [2] => D
        )

    [25] => Array
        (
            [0] => A
        )

    [26] => Array
        (
            [0] => A
            [1] => F
        )

    [27] => Array
        (
            [0] => A
            [1] => E
        )

    [28] => Array
        (
            [0] => A
            [1] => E
            [2] => F
        )

    [29] => Array
        (
            [0] => A
            [1] => D
        )

    [30] => Array
        (
            [0] => A
            [1] => D
            [2] => F
        )

    [31] => Array
        (
            [0] => A
            [1] => D
            [2] => E
        )

    [32] => Array
        (
            [0] => A
            [1] => C
        )

    [33] => Array
        (
            [0] => A
            [1] => C
            [2] => F
        )

    [34] => Array
        (
            [0] => A
            [1] => C
            [2] => E
        )

    [35] => Array
        (
            [0] => A
            [1] => C
            [2] => D
        )

    [36] => Array
        (
            [0] => A
            [1] => B
        )

    [37] => Array
        (
            [0] => A
            [1] => B
            [2] => F
        )

    [38] => Array
        (
            [0] => A
            [1] => B
            [2] => E
        )

    [39] => Array
        (
            [0] => A
            [1] => B
            [2] => D
        )

    [40] => Array
        (
            [0] => A
            [1] => B
            [2] => C
        )

) 
```

## 使用的功能

```
function powerSet($in, $minLength = 1, $max = 10) {
    $count = count ( $in );
    $members = pow ( 2, $count );
    $return = array ();
    for($i = 0; $i < $members; $i ++) {
        $b = sprintf ( "%0" . $count . "b", $i );
        $out = array ();
        for($j = 0; $j < $count; $j ++) {
            if ($b {$j} == '1')
                $out [] = $in [$j];
        }
        if (count ( $out ) >= $minLength && count ( $out ) <= $max) {
            $return [] = $out;
        }

    }
    return $return;
}

function getSet($array, &$vals) {
    foreach ( $array as $key => $value ) {

        if (is_array ( $value )) {

            getSet ( $value, $vals );

        } else {

            $vals [] = $value;
        }
    }

    return $vals;
} 
```

# ios - 什么时候继承 UITableView？

> ID：10250060
> 
> 赞同：2
> 
> 时间：2012-04-20T16:34:19.087
> 
> 标签：ios, objective-c, iphone, uitableview

我有一个 MainViewController，我想向它添加两个 UITableView，每个都有不同的单元格。但是我不想通过检查表委托方法来阻塞我的 MainViewController 代码，然后再对其进行操作。它变得太乱了。

所以我想我会继承 UITableView 并让它自己处理 cellForRow 和其他表格方法，这样当我想向 MainViewController 添加表格时，我所要做的就是

```
CustomTable *customTable = [[CustomTable alloc] init];
[self.view addSubview:customTable]; 
```

并且所有委托方法都将在该类中处理，从而使我的 MainViewController 变得杂乱无章。

我接近这个错误吗？我应该继承 UITableViewController 吗？有什么不同？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-20T16:55:28.087

何时进行子类化`UITableView`？现在不要。

创建两个类，它们是视图控制器的成员变量。将表视图委托指向两个新类中的每一个。

在 Cocoa 中，您倾向于组合类，而不是像在 Java 和 C# 中那样从它们继承。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-20T18:39:05.413

在作为 Objective-c 程序员的 3 年专业工作中，我不需要将 UITableView 子类化一次，可可依赖的模式[——MVC](https://developer.apple.com/library/ios/#documentation/General/Conceptual/DevPedia-CocoaCore/MVC.html)和[委托](https://developer.apple.com/library/ios/#documentation/General/Conceptual/DevPedia-CocoaCore/Delegation.html)（使用[协议](https://developer.apple.com/library/ios/#documentation/General/Conceptual/DevPedia-CocoaCore/Protocol.html)）既简单又足够强大。[填充一个 tableview 只是最好的例子](https://developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/TableView_iPhone/AboutTableViewsiPhone/AboutTableViewsiPhone.html)之一 。

确保您了解所有这些主题，否则您会发现自己不断地与框架作斗争。

# directshow - gdcl 多路复用器使用原始视频而不是 h264 创建文件

> ID：10250066
> 
> 赞同：0
> 
> 时间：2012-04-20T16:34:28.097
> 
> 标签：directshow, h.264, mpeg-4

我创建了一个如下图（我使用 osprey 卡输入直播流）

（图形编辑工具）

Osprey 中的模拟视频----> GDCL MPEG-4 多路复用器----> 文件编写器（.mp4 文件）

文件大小很大；即使是 5 秒的文件也有 80 mb 大小。文件无法播放。

当我使用 ffmpeg -i 在 ffmpeg 中查看文件详细信息时，

它会给出像流 0、缺少强制原子、损坏的标头这样的错误

以下是 ffmpeg 响应。

> ffmpeg.exe -i "C:\Documents and Setti ngs\Administrator\Desktop\mp4file\mp4file.mp4" ffmpeg 版本 N-38938-ge01f478 版权所有 (c) 2000-2012 FFmpeg 开发人员于 2012 年 3 月 19 日 23:18 构建： 25 与 gcc 4.6.2 配置：--disable-static --enable-shared --enable-gpl --enable-version3 --disable-w32threads --enable-runtime-cpudetect --enable-avisynth --enable-bzli b --enable-frei0r --enable-libopencore-amrnb --enable-libopencore-amrwb --enable -libfreetype --enable-libgsm --enable-libmp3lame --enable-libopenjpeg --enable-l ibrtmp --enable- libschroedinger --enable-libspeex --enable-libtheora --enable-li bvo-aacenc --enable-libvo-amrwbenc --enable-libvorbis --enable-libvpx --enable-l ibx264 --enable-libxavs --enable -libxvid --enable-zlib libavutil 51\. 42.100 / 51\. 42.100 libavcodec 54\. 12.100 / 54.12.100了libavformat 54\. 2.100 / 2.100 54 53 libavdevice 4.100 / 4.100 53 2 libavfilter 65.101 / 2 65.101 libswscale 2\. 1.100 / 1.100 2 0 libswresample 7.100 / 0 7.100 libpostproc 52 0.100 / 52 0.100 [ mov,mp4,m4a,3gp,3g2,mj2 @ 003E28E0] 流 0，缺少强制原子，损坏的标头输入 #0，mov,mp4,m4a,3gp,3g2,mj2，来自 'C:\Documents and Settings\Administrator \Desktop\mp4file\mp4file.mp4'：元数据：major_brand：mp42 minor_version：0 compatible_brands：mp42isom 持续时间：00:00:00.00，比特率：-2147483 kb/s 流 #0:0（eng）：视频：rawvideo (YUY2 /0x32595559), yuyv422, 640x480, 90k tbr, 90k tbn, 90k tbc 元数据: handler_name : 必须至少指定一个输出文件2.100 / 54\. 2.100 libavdevice 53\. 4.100 / 53\. 4.100 libavfilter 2\. 65.101 / 2\. 65.101 libswscale 2\. 1.100 / 2\. 1.100 libswresample 0\. 7.100 / 0\. 7.100 libpostproc 52\. 0.100 / mp4, 010.0.52 m4a,3gp,3g2,mj2 @ 003E28E0] 流 0，缺少强制原子，损坏的标头输入 #0，mov,mp4,m4a,3gp,3g2,mj2，来自 'C:\Documents and Settings\Administrator\Desktop\mp4file \mp4file.mp4'：元数据：major_brand：mp42 minor_version：0 compatible_brands：mp42isom 持续时间：00:00:00.00，比特率：-2147483 kb/s 流 #0:0(eng)：视频：rawvideo (YUY2 / 0x32595559)， yuyv422, 640x480, 90k tbr, 90k tbn, 90k tbc 元数据: handler_name : 必须至少指定一个输出文件2.100 / 54\. 2.100 libavdevice 53\. 4.100 / 53\. 4.100 libavfilter 2\. 65.101 / 2\. 65.101 libswscale 2\. 1.100 / 2\. 1.100 libswresample 0\. 7.100 / 0\. 7.100 libpostproc 52\. 0.100 / mp4, 010.0.52 m4a,3gp,3g2,mj2 @ 003E28E0] 流 0，缺少强制原子，损坏的标头输入 #0，mov,mp4,m4a,3gp,3g2,mj2，来自 'C:\Documents and Settings\Administrator\Desktop\mp4file \mp4file.mp4'：元数据：major_brand：mp42 minor_version：0 compatible_brands：mp42isom 持续时间：00:00:00.00，比特率：-2147483 kb/s 流 #0:0(eng)：视频：rawvideo (YUY2 / 0x32595559)， yuyv422, 640x480, 90k tbr, 90k tbn, 90k tbc 元数据: handler_name : 必须至少指定一个输出文件100 libavfilter 2\. 65.101 / 2\. 65.101 libswscale 2\. 1.100 / 2\. 1.100 libswresample 0\. 7.100 / 0\. 7.100 libpostproc 52\. 0.100 / 52\. 0.100 [mov,mp4,m4a,3gp,3g2,mj2 @ 003E28E ，缺少强制性原子，损坏的标头输入＃0，mov，mp4，m4a，3gp，3g2，mj2，来自'C：\ Documents and Settings\Administrator \Desktop\mp4file\mp4file.mp4'：元数据：major_brand：mp42 minor_version : 0 compatible_brands: mp42isom 持续时间: 00:00:00.00, 比特率: -2147483 kb/s Stream #0:0(eng): Video: rawvideo (YUY2 / 0x32595559), yuyv422, 640x480, 90k tbr, 90k tbn, 90k tbc元数据：handler_name：必须至少指定一个输出文件100 libavfilter 2\. 65.101 / 2\. 65.101 libswscale 2\. 1.100 / 2\. 1.100 libswresample 0\. 7.100 / 0\. 7.100 libpostproc 52\. 0.100 / 52\. 0.100 [mov,mp4,m4a,3gp,3g2,mj2 @ 003E28E ，缺少强制性原子，损坏的标头输入＃0，mov，mp4，m4a，3gp，3g2，mj2，来自'C：\ Documents and Settings\Administrator \Desktop\mp4file\mp4file.mp4'：元数据：major_brand：mp42 minor_version : 0 compatible_brands: mp42isom 持续时间: 00:00:00.00, 比特率: -2147483 kb/s Stream #0:0(eng): Video: rawvideo (YUY2 / 0x32595559), yuyv422, 640x480, 90k tbr, 90k tbn, 90k tbc元数据：handler_name：必须至少指定一个输出文件7.100 libpostproc 52\. 0.100 / 52\. 0.100 [mov,mp4,m4a,3gp,3g2,mj2 @ 003E28E0] 流 0，缺少强制原子，损坏的标头输入 #0，mov，mp4，m4a，3gp，3g2，mj2，来自“C:\Documents and Settings\Administrator\Desktop\mp4file\mp4file.mp4”：元数据：major_brand：mp42 minor_version：0 compatible_brands：mp42isom 持续时间：00:00:00.00，比特率：-2147483 kb/s 流#0： 0(eng): Video: rawvideo (YUY2 / 0x32595559), yuyv422, 640x480, 90k tbr, 90k tbn, 90k tbc 元数据: handler_name : 必须指定至少一个输出文件7.100 libpostproc 52\. 0.100 / 52\. 0.100 [mov,mp4,m4a,3gp,3g2,mj2 @ 003E28E0] 流 0，缺少强制原子，损坏的标头输入 #0，mov，mp4，m4a，3gp，3g2，mj2，来自“C:\Documents and Settings\Administrator\Desktop\mp4file\mp4file.mp4”：元数据：major_brand：mp42 minor_version：0 compatible_brands：mp42isom 持续时间：00:00:00.00，比特率：-2147483 kb/s 流#0： 0(eng): Video: rawvideo (YUY2 / 0x32595559), yuyv422, 640x480, 90k tbr, 90k tbn, 90k tbc 元数据: handler_name : 必须指定至少一个输出文件\Documents and Settings\Administrator \Desktop\mp4file\mp4file.mp4'：元数据：major_brand：mp42 minor_version：0 compatible_brands：mp42isom 持续时间：00:00:00.00，比特率：-2147483 kb/s Stream #0:0(eng) : 视频: rawvideo (YUY2 / 0x32595559), yuyv422, 640x480, 90k tbr, 90k tbn, 90k tbc 元数据: handler_name : 必须至少指定一个输出文件\Documents and Settings\Administrator \Desktop\mp4file\mp4file.mp4'：元数据：major_brand：mp42 minor_version：0 compatible_brands：mp42isom 持续时间：00:00:00.00，比特率：-2147483 kb/s Stream #0:0(eng) : 视频: rawvideo (YUY2 / 0x32595559), yuyv422, 640x480, 90k tbr, 90k tbn, 90k tbc 元数据: handler_name : 必须至少指定一个输出文件

我需要进行任何 gdcl 过滤器设置吗？请帮我解决问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T17:47:49.980

多路复用器用于将不同的流多路复用到一个文件中。大多数情况下，这将是音频和视频流。但是多路复用器不编码音频或视频。如果需要 h.264 视频，则需要将 h264 编码器添加到图形中。例如，您可以为此使用[ffdshow](http://ffdshow-tryout.sourceforge.net/)。

[有关mp4 文件格式](http://en.wikipedia.org/wiki/MPEG-4_Part_14)、[H.264 视频压缩格式](http://en.wikipedia.org/wiki/Advanced_Video_Coding)和[mpeg4 的其他部分，](http://en.wikipedia.org/wiki/MPEG-4#MPEG-4_parts)另请参阅 wikipedia 。

如果您真的想创建一个未压缩的 .mp4 文件，请查看[官方支持](http://en.wikipedia.org/wiki/MPEG-4_Part_14#Data_streams)的 .mp4 格式。未压缩的视频可能不受官方支持。但即使是这样，你也需要多路复用器作为播放器的支持。在他的网站上，Geraint Davies 添加了以下[注释](http://www.gdcl.co.uk/mpeg4/)：

> 注意：mux 和 demux 过滤器都需要为每种要支持的媒体类型添加少量代码。到目前为止，我只添加了一组有限的类型。如果需要其他类型接受，请直接联系。 可能只需要几行代码。

对未压缩的视频使用[MXF可能会更好。](http://en.wikipedia.org/wiki/Material_Exchange_Format)

# c# - 处理 Alpha 透明度的高斯模糊

> ID：10250068
> 
> 赞同：2
> 
> 时间：2012-04-20T16:34:30.313
> 
> 标签：c#, image-processing, graphics, filter, gaussian

我一直在尝试在 C# 中实现一种算法，用于处理透明度的高斯模糊。我尝试了以下两种实现，每一种似乎都给了我不同类型的结果。但两者都没有考虑到 alpha 通道。

[http://code.google.com/p/imagelibrary/downloads/detail?name=ImageLibrary-source-1_2_4.zip&can=2&q=](http://code.google.com/p/imagelibrary/downloads/detail?name=ImageLibrary-source-1_2_4.zip&can=2&q=) http://www.smokycogs.com/blog/image-processing-in-c-使用卷积进行锐利平滑/

我的测试图像在透明背景 PNG 上有一个简单的圆圈。

有人可以指出我正确的方向以使高斯模糊与具有透明度的图像一起使用吗？我能找到的唯一链接是框模糊。 [http://www.codeproject.com/Articles/6162/Gausian-and-Alpha-Blurring](http://www.codeproject.com/Articles/6162/Gausian-and-Alpha-Blurring)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T20:19:09.100

如果您使用[预乘 Alpha](http://blogs.msdn.com/b/shawnhar/archive/2009/11/06/premultiplied-alpha.aspx)透明度，您可以像 RGB 通道一样模糊 Alpha 通道。

如果你的 alpha 没有预乘，你会得到奇怪的边缘伪影。为避免这种情况，您可以尝试将图像转换为预乘图像，对其进行过滤，然后再将其转换回来。这个过程有一些陷阱，但结果可能比天真地平滑未乘法的 alpha 图像要好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-22T19:02:19.107

您必须将每个 RGB 值乘以 alpha 值，然后将结果除以可能的最大 alpha。

假设您只想平均三个像素：

```
newBlue = (
  src[-1].Blue * src[-1].Alpha + 
  src[0].Blue * src[0].Alpha + 
  src[1].Blue * src[1].Alpha ) / (255*3); 
```

如您所见：如果所有三个像素都是实心的（alpha=255），那么与忽略 alpha 通道（这确实是我们想要的）相比，这个计算不会改变任何东西。

*这是一个没有*alpha的 3x3 卷积：

```
 for (var i = nWidth - 2; i > 0; i--)
            {
                n = ((((pT[-sourcePixelSize]*m.TL) + (pT[0]*m.TM) + (pT[sourcePixelSize]*m.TR) +
                       (pM[-sourcePixelSize]*m.ML) + (pM[0]*m.MM) + (pM[sourcePixelSize]*m.MR) +
                       (pB[-sourcePixelSize]*m.BL) + (pB[0]*m.BM) + (pB[sourcePixelSize]*m.BR) + 5)/m.Factor) + m.Offset);
                *pD = (byte) (n <= 0 ? 0 : n >= 255 ? 255 : n);
                pT += sourcePixelSize;
                pM += sourcePixelSize;
                pB += sourcePixelSize;
                pD += 4;
            } 
```

这是*与*alpha 的等价物：

```
 for (var i = nWidth - 2; i > 0; i--)
            {
                alphaSum = (pT[-4 + ao] + pT[ao] + pT[4 + ao] +
                            pM[-4 + ao] + pM[ao] + pM[4 + ao] +
                            pB[-4 + ao] + pB[ao] + pB[4 + ao] + 5)/9;
                n = alphaSum != 0
                        ? ((((pT[-4]*pT[-4 + ao]*m.TL) + (pT[0]*pT[ao]*m.TM) + (pT[4]*pT[4 + ao]*m.TR) +
                             (pM[-4]*pM[-4 + ao]*m.ML) + (pM[0]*pM[ao]*m.MM) + (pM[4]*pM[4 + ao]*m.MR) +
                             (pB[-4]*pB[-4 + ao]*m.BL) + (pB[0]*pB[ao]*m.BM) + (pB[4]*pB[4 + ao]*m.BR) + 5)/
                            (m.Factor*alphaSum)) + m.Offset)
                        : 0;
                *pD = (byte) (n <= 0 ? 0 : n >= 255 ? 255 : n);
                pT += 4;
                pM += 4;
                pB += 4;
                pD += 4;
             } 
```

# jquery - .appendTo 和 HTML 文字

> ID：10250071
> 
> 赞同：0
> 
> 时间：2012-04-20T16:34:50.507
> 
> 标签：jquery, appendto

```
element.appendTo('<td>').appendTo('<tr>').appendTo('#ordersList') 
```

这是否应该将元素放在新的 td 元素中，在 #ordersList 元素（是表）内的新 tr 元素中？

因为我只是在#ordersList 中获取了没有包装tr/td 的裸元素。

我试图排除故障的这个旧站点似乎正在使用 jQuery 1.4.1——以防这是一个已知的错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T16:38:36.303

`appendTo()`返回您正在操作的元素，因此[您*实际上*在做](http://jsfiddle.net/pzwgZ/)的是；

1.  将您的元素添加到新创建的`td`.
2.  从 中分离元素`td`并将其添加到新创建的`tr`.
3.  将其`tr`与`#ordersList`

什么会起作用，就像这样；

```
$('<td></td>').appendTo($('<tr></tr>')​​​​​​​​​.appendTo('#ordersList')).append(element); 
```

...这很不利于可读性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T16:45:37.310

您始终可以将本机 API 用于此类简单的事情，尽管减少代码的助手很好......

```
function create(type) { return document.createElement(type); }
function byId(id) { return document.getElementById(id); } 
```

* * *

```
byId('ordersList')
    .appendChild(create('tr'))
    .appendChild(create('td'))
    .appendChild(element); 
```

本机`.appendChild()`返回附加的元素，因此您可以链接调用嵌套元素。

# css - 将 div 中的 img 垂直对齐，高度为 100%

> ID：10250081
> 
> 赞同：0
> 
> 时间：2012-04-20T16:35:12.177
> 
> 标签：css, image, dynamic, vertical-alignment

我正在尝试找到一种解决方案，如何在具有 100% 高度的 div 中垂直对齐图像（我不知道它的高度）。

我有这个 HTML。除了添加更多包装器之外，我对 HTML 无能为力：

```
<div id="wrapper">
    <img src="http://www.lovecpokladu.cz/nalezy/9687/5.jpg" alt="" />
</div>​ 
```

而这个相当固定的 CSS - 主要我需要完成图像不会在所有浏览器中溢出浏览器窗口：

```
#wrapper {
  position: absolute;
  width: 100%;
  height: 100%;
  background: #ddd;        
}
img {
  max-width: 100%;
  max-height: 100%;
} 
```

[http://jsfiddle.net/2nkVm/](http://jsfiddle.net/2nkVm/)

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:38:53.000

试试这个：

```
img { 
     display:block; 
     position:absolute; 
     top:50%; 
     margin-top:"negative margin based on half of image height"; 
} 
```

更新了你的小提琴：

[http://jsfiddle.net/2nkVm/3/](http://jsfiddle.net/2nkVm/3/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-20T16:45:45.010

```
$(document).ready( function() {
    positionImage();
    $(window).resize( function() {
        positionImage();
    });
});
function positionImage() {
    var wrapperHeightOffset = $('#wrapper').height() - $('#wrapper img').height();
    var wrapperHeightOffset = wrapperHeightOffset/2;
    $('#wrapper').css('paddingTop', wrapperHeightOffset + 'px');
} 
```

# java - Netbeans 7.0.1 和 7.1 之间 JVM 堆大小分配的差异？

> ID：10250083
> 
> 赞同：3
> 
> 时间：2012-04-20T16:35:25.323
> 
> 标签：java, jvm, heap-memory, netbeans-7.1

我有一个使用 Netbeans 7.0.1 开发的 java 程序来解析和保存大型 CSV 文件。由于 CSV 文件的大小，我需要增加 JVM 的堆大小。在 7.0.1 中，我使用 Netbeans 中 Project ->Properties -> VM Options 下的 -Xmx4096m 规范将堆大小设置为在我的系统上使用 8GB 中的 4GB。它在 7.0.1 中运行良好。

现在我正在尝试在 Netbeans 7.1 中运行它，并且我从 Netbeans 获得以下输出

```
Could not create the Java virtual machine.
Invalid maximum heap size: -Xmx4096m
The specified size exceeds the maximum representable size.
Java Result: 1 
```

当我收到此错误时，我没有更改 Netbeans 中的默认设置。

我想也许在 7.1 中他们已经“锁定”了 netbeans.config 文件中的堆大小，所以我去了那里。

首先我尝试了这个：

```
netbeans_default_options="-J-client -J-Xss2m -J-Xms32m -J-Xmx4906m -J-XX:PermSize=32m -J-Dapple.laf.useScreenMenuBar=true -J-Dapple.awt.graphics.UseQuartz=true -J-Dsun.java2d.noddraw=true -J-Dsun.zip.disableMemoryMapping=true" 
```

这让我在 Netbeans 初始屏幕上创建 JVM 弹出窗口失败。

然后我尝试了这个：

```
netbeans_default_options="-J-client -J-Xss2m -J-Xms32m -J-XX:PermSize=32m -J-XX:MaxPermSize=4096m -J-Dapple.laf.useScreenMenuBar=true -J-Dapple.awt.graphics.UseQuartz=true -J-Dsun.java2d.noddraw=true -J-Dsun.zip.disableMemoryMapping=true" 
```

Netbeans 似乎更喜欢这样，因为加载栏会一直到“完成加载模块”。但它只是挂在启动画面上。在杀死它之前，我让它挂在那里 5 分钟。

这对我来说不是一个阻碍，因为我仍然可以在 7.0.1 下正常运行它，但想知道是否有人对此有解决方案。似乎它应该是一个简单的修复，但我只是忽略了一些东西？

谢谢你的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T18:10:54.290

看起来您使用 32 位 java.exe 安装了 NetBeans，在 C:\Program Files (x86)\NetBeans 7.1\etc\ 或 C:\Program Files\NetBeans 7.1\etc\ 中编辑 netbeans.conf 并制作确定它说（将 jdk1.7.0_03 替换为您实际打算使用的版本）：

```
...
# Default location of JDK, can be overridden by using --jdkhome <dir>:
netbeans_jdkhome="C:\Program Files\Java\jdk1.7.0_03"
... 
```

并不是

```
...
# Default location of JDK, can be overridden by using --jdkhome <dir>:
netbeans_jdkhome="C:\Program Files (x86)\Java\jdk1.7.0_03"
... 
```

请注意，Windows 中的“(x86)”表示 32 位，或者只是编辑您的项目并选择 64 位 JVM。您可能必须将 64 位 JVM 添加到 Tools->Java Platforms。当然，如果您不使用 Windows，具体情况会有所不同，但这仍然是 32 位与 64 位的问题。

当有人想要使用更新的 JVM 但他们不小心安装了 32 位版本而不是 64 位版本时，通常会出现这种情况。另请注意：您可以将项目配置为在 64 位 JVM 中运行/调试，而 NetBeans 本身在 32 位 JVM 中运行，因此您实际上不必修改 netbeans.conf 以使您的项目能够分配 4GB .

总之：

1.  确保您已安装 64 位 JDK
2.  确保您的 64 位 JDK 列在 NetBeans 的 Java 平台中
3.  确保您的 Project->Properties->Libraries->Java Platform 设置为您要使用的 64 位 JDK。

# java - 通用方法 - 不能应用于给定类型

> ID：10250085
> 
> 赞同：0
> 
> 时间：2012-04-20T16:35:34.113
> 
> 标签：java, generics

我正在开发我的第一个使用通用方法的程序。我认为我通过将参数设置为正确地做到了这一点，`selectionSort(T[] a)`因此该方法可以接收任何对象的数组。

```
public class SelectionSort {
protected int[] arrayOne = {1,2,3,4,5,6,7,8};
protected double[] arrayTwo = {1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0};
public static <T extends Comparable<T>> void selectionSort(T[] a)
{
for (int index =0; index < a.length; index++)
{
    int minElementIndex = index;
    T minElementValue = a[index];
    for (int i = index + 1; i < a.length; i++) 
    {
        if (a[i].compareTo(minElementValue) < 0)
        {
            minElementIndex = i;
            minElementValue = a[i];
        }
    }//end of inner for loop
    a[minElementIndex] = a[index];
    a[index] = minElementValue;
}//end of outer for loop
for(int indexb = 0; indexb<a.length; indexb++)
{
    System.out.printf("%d ", a[indexb]);
    if(indexb == a.length)
        System.out.println("");
}
}
public static void main(String[] args)
{
selectionSort(arrayOne);
selectionSort(arrayTwo);

}}//end of main and SelectionSort 
```

也许你能帮帮我。如果是这样，我将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T16:37:22.387

泛型不能与`int`or等​​原始类型一起使用`double`，它们不是对象或类。您将不得不使用盒装版本`Integer[]`和`Double[]`.

特别是，如果您想支持接受原语`int[]`和`double[]`数组，您将不得不编写两次代码。=（（我可以想到一种半解决方法，但不能不使用外部库......）

# wcf - 如何将正确的 schemaLocation 放入我的 WCF 服务的 WSDL？

> ID：10250086
> 
> 赞同：0
> 
> 时间：2012-04-20T16:35:37.923
> 
> 标签：wcf, web-services, wcf-binding

我编写了一个简单的 WCF Web 服务，我试图通过网站公开它。

我将网站（在 web.config 中有服务引用和绑定）上传到服务器，我可以使用[https://domain/ServiceRoute?wsdl 浏览到 wsdl](https://domain/ServiceRoute?wsdl)。

WSDL 显示的`schemaLocation`.

然后我尝试使用 WCF 测试客户端来测试服务。WCF 测试客户端给我以下错误：

> 错误：无法从[https://domain/ServiceRoute?wsdl](https://domain/ServiceRoute?wsdl)获取元数据如果这是您有权访问的 Windows (R) Communication Foundation 服务，请检查您是否已在指定地址启用元数据发布。有关启用元数据发布的帮助，请参阅位于[http://go.microsoft.com/fwlink/?LinkId=65455.WS-Metadata](http://go.microsoft.com/fwlink/?LinkId=65455.WS-Metadata) Exchange Error URI: [https://domain/ServiceRoute?wsdl](https://domain/ServiceRoute?wsdl) Metadata contains a reference的 MSDN 文档无法解决的问题：'https://domain/ServiceRoute?wsdl'。 `Sendera:ActionNotSupported`由于 EndpointDispatcher 的 ContractFilter 不匹配，接收方无法处理带有 Action 'http://schemas.xmlsoap.org/ws/2004/09/transfer/Get' 的消息。这可能是因为合约不匹配（发送方和接收方之间的操作不匹配）或发送方和接收方之间的绑定/安全不匹配。检查发送方和接收方是否具有相同的合同和相同的绑定（包括安全要求，例如消息、传输、无）。HTTP GET 错误 URI：[https://domain/ServiceRoute?wsdl](https://domain/ServiceRoute?wsdl) 该文件已被理解，但无法处理。- WSDL 文档包含无法解析的链接。- 下载“https://incorrectSchemaLocation/ServiceRoute?xsd=xsd0”时出错。- 无法解析远程名称：'IncorrectSchemaLocation'

我不知道该怎么办。我需要更改服务器设置吗？或者我可以更新我的绑定以明确使用`schemaLocation`of`https://domain/ServiceRoute`吗？

另外，请注意，当我浏览到 wsdl 时，我没有收到 ssl 证书错误。我不知道这是否有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T18:53:55.567

我可以通过使用命令行实用程序更改 Web 服务器的配置来解决此错误：

```
cscript.exe adsutil.vbs set /w3svc/<site identifier>/SecureBindings ":443:<host header>" 
```

`<site identifier>`IIS 站点标识符在哪里`<host header>`，是用于从外部访问服务的 URL（即：subdomain.domain.com。）

# objective-c - 在 switch 语句中使用（动画）块时崩溃

> ID：10250088
> 
> 赞同：4
> 
> 时间：2012-04-20T16:35:40.357
> 
> 标签：objective-c, animation, objective-c-blocks

此代码有效（带有动画的 if 语句）：

```
// works
if (_camOrientation == UIDeviceOrientationPortrait) {
    [UIView animateWithDuration:0.5f animations:^(void){
        [_distanceView setTransform:CGAffineTransformMakeRotation(degreesToRadian(0.0))];
    }];
} else if (_camOrientation == UIDeviceOrientationLandscapeLeft) {
    [UIView animateWithDuration:0.5f animations:^(void){
        [_distanceView setTransform:CGAffineTransformMakeRotation(degreesToRadian(90.0))];
    }];
} 
```

这也有效（没有动画的 switch 语句）：

```
// works
switch (_camOrientation) {
    case UIDeviceOrientationPortrait:
        [_distanceView setTransform:CGAffineTransformMakeRotation(degreesToRadian(0.0))];
        break;

    case UIDeviceOrientationLandscapeLeft:
        [_distanceView setTransform:CGAffineTransformMakeRotation(degreesToRadian(90.0))];
        break;

    default:
        break;
} 
```

这个崩溃（带有动画的开关语句）：

```
// crashes
switch (_camOrientation) {
    case UIDeviceOrientationPortrait:
        [UIView animateWithDuration:0.5f animations:^(void){
            [_distanceView setTransform:CGAffineTransformMakeRotation(degreesToRadian(0.0))];
        }];
        break;

    case UIDeviceOrientationLandscapeLeft:
        [UIView animateWithDuration:0.5f animations:^(void){
            [_distanceView setTransform:CGAffineTransformMakeRotation(degreesToRadian(90.0))];
        }];
        break;

    default:
        break;
} 
```

为什么我不能在 switch 语句中使用动画块？！？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T16:38:45.193

你应该能够 ：）

尝试`{ }`像这样添加您的案例：

```
case UIDeviceOrientationPortrait: {
    [UIView animateWithDuration:0.5f animations:^void{
        [_distanceView setTransform:CGAffineTransformMakeRotation(0.0)];
    }];
    break;
} 
```

# wpf - 如何在WPF中实现CSS Position Absolute - Position Relative 组合？

> ID：10250091
> 
> 赞同：0
> 
> 时间：2012-04-20T16:35:45.327
> 
> 标签：wpf, layout

我需要在 WPF/XAML 中重现这个 CSS：

```
<div style="position: relative;">
    <div style="position: absolute; top: 0; left: 0;">Foo bar</div>
    <div style="position: absolute; top: 0; left: 0;">Foo bar</div>
</div> 
```

本质上，我需要在它们的容器中将两个元素放置在彼此之上。

到目前为止，我有：

```
<StackPanel>
    <TextBlock Text="Foo bar">
    <TextBlock Margin="0,-16,0,0" Text="Foo bar">
</StackPanel> 
```

上面的问题是它不能扩展。我不想硬编码任何保证金数字。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:46:58.317

然后放置在网格的同一单元格上：

```
<Grid>
    <TextBlock Text="Foo bar">
    <TextBlock Text="Bar foo">
</Grid> 
```

**注意：**由于没有`RowDefinitions`或`ColumnDefinitions`指定，网格有一个默认的 1 行 / 1 列。由于元素没有属性`Grid.Row`或`Grid.Column`集合，它们被放置在 0,0 单元格上

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:51:25.873

当我需要进行非像素定位时，我通常将我的项目放在一个网格中，其中的行或列在两侧带有百分比或“星形”值用于填充。这确实可以扩展。

所以像：

```
<Grid>
    <Grid.ColumnDefinitions>
        <ColumnDefinition Height="10*"/>
        <ColumnDefinition Height="80*"/>
        <ColumnDefinition Height="10*"/>
    </Grid.ColumnDefinitions>
    <TextBlock Text="FooBar" Grid.Column="1"/>
</Grid> 
```

无论缩放如何，都会渲染一个左边缘距左侧 10% 的文本框。

# c# - 通用属性中的属性更改通知

> ID：10250094
> 
> 赞同：0
> 
> 时间：2012-04-20T16:35:51.630
> 
> 标签：c#, reflection

**改写了问题。向下滚动查看原文**

好吧，也许我应该给你全貌。我有很多类看起来像这样：

```
public class Movement : Component
{
    private Vector3 linearVelocity;
    public Vector3 LinearVelocity
    {
        get
        {
            return linearVelocity;
        }
        set
        {
            if (value != linearVelocity)
            {
                linearVelocity = value;
                ComponentChangedEvent<Movement>.Invoke(this, "LinearVelocity");
            }
        }
    }

    // other properties (e.g. AngularVelocity), which are declared exactly
    // the same way as above
} 
```

还有一些名为 Transform、Mesh、Collider、Appearance 等的类，它们都派生自`Component`并且除了属性之外什么都没有，这些属性都是如上所述声明的。这里重要的是调用`ComponentChangedEvent`. 一切都很完美，但我一直在寻找一种方法，我不必一次又一次地为每个属性重写相同的逻辑。

我看了一下[here](https://stackoverflow.com/a/2587293/782862)，并喜欢使用泛型属性的想法。我想出的看起来像这样：

```
public class ComponentProperty<TValue, TOwner>
{
    private TValue _value;

    public TValue Value
    {
        get
        {
            return _value;
        }
        set
        {
            if (!EqualityComparer<TValue>.Default.Equals(_value, value))
            {
                _value = value;
                ComponentChangedEvent<TOwner>.Invoke(
                    /*get instance of the class which declares value (e.g. Movement instance)*/,
                    /*get name of property where value comes from (e.g. "LinearVelocity") */);
            }
        }
    }

    public static implicit operator TValue(ComponentProperty<TValue, TOwner> value)
    {
        return value.Value;
    }

    public static implicit operator ComponentProperty<TValue, TOwner>(TValue value)
    {
        return new ComponentProperty<TValue, TOwner> { Value = value };
    }
} 
```

然后我会这样使用它：

```
public class Movement : Component
{
    public ComponentProperty<Vector3, Movement> LinearVelocity { get; set; }
    public ComponentProperty<Vector3, Movement> AngularVelocity { get; set; }
} 
```

但我无法获得 LinearVelocity 来自的实例，也无法将其命名为字符串。所以我的问题是，如果这一切都是可能的......

但似乎我别无选择，只能像以前一样继续这样做，手动为每个属性编写此逻辑。

**原始问题：**

**从属性中获取声明类的实例**

我有一个带有属性的类：

```
public class Foo
{
    public int Bar { get; set; }
} 
```

在另一种情况下，我有这样的事情：

```
Foo fooInstance = new Foo();
DoSomething(fooInstance.Bar); 
```

然后，`DoSomething`我需要`fooInstance`从一无所有中得到`parameter`。从上下文来看，可以假设没有任何整数被传递到`DoSomething`中，而只是 int 的公共属性。

```
public void DoSomething(int parameter)
{
    // need to use fooInstance here as well,
    // and no, it is not possible to just pass it in as another parameter
} 
```

这有可能吗？使用反射，或者可能是属性上的自定义属性`Bar`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T16:40:33.477

为什么你只想向 DoSomething 发送一个属性，将整个对象发送给它:)，所以它会变成，

```
DoSomething(fooInstance); 
```

然后，您的函数将接受对象而不是参数。您可以使用此函数的重载来确保旧代码不会中断。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T17:22:21.927

有几种方法可以处理实施`INotifyPropertyChanged`。您正在做几乎相同的事情，只是您没有实现接口并以不同的方式引发事件。但所有解决方案也适用于您。

1.  像您一样，使用字符串参数调用方法：`OnPropertyChanged("Property")`。
2.  使用使用以下属性的 lambda 调用方法：`OnPropertyChanged(() => Property)`。这样做的好处是它在编译时检查拼写错误和重构友好。
3.  使用[调用者信息](http://msdn.microsoft.com/en-us/library/hh534540%28v=vs.110%29.aspx)注入属性的名称：`OnPropertyChanged()`. 这将在 C# 5 中工作。
4.  使用 Castle DynamicProxy 之类的东西在运行时创建一个派生类，它将为您调用该方法。这意味着您需要创建您的属性`virtual`，并且您只需要通过 Castle 创建类的实例。
5.  使用 AOP 框架在编译后修改属性的代码以调用该方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T16:40:31.410

没有办法`fooInstance`从`parameter`. `parameter`是按值传递的，只是 的值的副本，`fooInstance.Bar`不再与`fooInstance`

话虽这么说，显而易见的解决方案是这样`DoSomething`写

```
public void DoSomething(Foo parameter)
{
    // need to use fooInstance here as well,
    // and no, it is not possible to just pass it in as another parameter
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T16:41:13.067

属性只是一个字段，它返回对堆上某个对象的引用（即它的地址）。如果属性不是引用类型，则返回对象的值。

所以，当你做类似的事情时

```
DoSomething(fooInstance.Bar); 
```

您只需将对象 Bar 的地址传递给方法。

**如果 Bar 是引用类型（即类）。**想象一下 Mr.Foo 的地址是 Mr.Bar（*462 代表印第安纳州马里恩县*）。Mrs.CLR 向 Mr.Foo 询问 Mr.Bar 的地址。然后把这个地址告诉需要Mr.Bar地址的人。怎么会有人知道，CLR 向 Foo 询问了 Bar 的地址？他只收到了*印第安纳州马里恩县的地址 462*。

**对于值对象**（int、double、structs 等），Mr.Foo 有一个很酷的 mp3 曲目，名为 Bar。CLR 夫人创建了该 mp3 曲目的副本并将其发送给某人。怎么会有人知道，他的 mp3 曲目 Bar 是 Mr.Foo 曲目的副本？

所以，如果你想让某人知道 Mr.Foo，你需要将 Mr.Foo 的地址传递给他：

```
DoSomething(fooInstance); 
```

有了这个地址，有人可以拜访 Mr.Foo 并询问他关于 Mr.Bar 的地址，或者创建他的 mp3 曲目的副本 :)

# vhdl - 了解这个 T 触发器示例？

> ID：10250095
> 
> 赞同：2
> 
> 时间：2012-04-20T16:35:51.560
> 
> 标签：vhdl

我正在阅读一本 VHDL 书籍并且无法理解他们给出的示例。

给出的代码：

```
-------------------------------------------------------------------
-- RET T Flip-flop model with active-low asynchronous set input. --
-------------------------------------------------------------------
-- library declaration
library IEEE;
use IEEE.std_logic_1164.all;
-- entity
entity t_ff_s is
  port ( T,S,CLK : in std_logic;
  Q : out std_logic);
end t_ff_s;
-- entity
architecture my_t_ff_s of t_ff_s is
  signal t_tmp : std_logic; -- intermediate signal declaration
begin
  tff: process (S,CLK)
  begin
    if (S = '0') then
      Q <= '1';
    elsif (rising_edge(CLK)) then
      t_tmp <= T XOR t_tmp; -- temp output assignment
    end if;
  end process tff;
  Q <= t_tmp; -- final output assignment
end my_t_ff_s; 
```

我不明白的是他们如何将多个信号分配给 Q。在流程语句之外，它`Q <= t_tmp`在流程内部 if `S='0'`then `Q <= '1'`。这究竟是如何工作的？我对 VHDL 的理解有限，这对我来说是错误的。基本上，这对我来说就像写一样：

```
Q <= '0';
Q <= '1'; 
```

谁能帮助我更好地理解这个例子？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T16:48:58.087

你对这个例子提出质疑是对的。它坏了。

```
Q <= '1'; 
```

应该

```
t_tmp <= '1'; 
```

有人意识到他们无法读取输出，引入了 t_tmp 并且只更改了一半的代码。

# php - 在 foreach 中保存模型 - 一个 id 保存两次

> ID：10250096
> 
> 赞同：0
> 
> 时间：2012-04-20T16:35:54.227
> 
> 标签：php, magento, model

我写了一个自定义模块，包括一些模型。

在后端编辑条目时，它们会发布到控制器中的 saveAction。在那里我选择元素（数组）并在 foreach 中使用它们。在这个 foreach 中，我创建了一个新模型 (Mage::getModel('my/model') ) 设置特定数据，例如 $model->setName(); 在每个循环之后我保存模型，并确保它没有被使用两次，我做了一个 unset($model);

但是现在问题来了：

每第 5 个循环，id 从第 4 个模型中获取。有谁知道如何解决这个问题？

# android - Android - NullPointer exception in Dialog with RadioButtons

> ID：10250097
> 
> 赞同：0
> 
> 时间：2012-04-20T16:35:58.860
> 
> 标签：android

Can anyone help me with this and tell me where I do the mistake... When I try to do anything with the radiobutton Eclipse throws me this exception

```
threadid=1: thread exiting with uncaught exception (group=0x40015560)
FATAL EXCEPTION: main
java.lang.NullPointerException
cz.nasdaq.RbtnActivity$1.onClick(RbtnActivity.java:36)
android.view.View.performClick(View.java:2485)
android.view.View$PerformClick.run(View.java:9080)
android.os.Handler.handleCallback(Handler.java:587)
android.os.Handler.dispatchMessage(Handler.java:92)
android.os.Looper.loop(Looper.java:123)
.
.
. 
```

with this code

```
public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        Button btn = (Button)findViewById(R.id.btn1);        
        btn.setOnClickListener(new OnClickListener() {

            public void onClick(View arg0) {
                final Dialog dialog = new Dialog(RbtnActivity.this);
                dialog.setContentView(R.layout.dlg);
                dialog.show();

                RadioButton drb0=(RadioButton)findViewById(R.id.DialogRb0);
                drb0.setChecked(true); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T16:41:32.797

```
RadioButton drb0=(RadioButton)findViewById(R.id.DialogRb0);
drb0.setChecked(true); 
```

应该

```
RadioButton drb0=(RadioButton)dialog.findViewById(R.id.DialogRb0);
drb0.setChecked(true); 
```

注意**对话框**.findViewById(R.id.DialogRb0);

当您应该在对话框的布局中搜索时，您正在主布局中搜索对话框 RadioButton。当您搜索它时，您的变量 drb0 为空，并且当您对其调用 setChecked(true) 时将导致空指针异常。

# asp.net-mvc-4 - 在 ASP.NET MVC Web API 中禁用 JSON 支持

> ID：10250098
> 
> 赞同：0
> 
> 时间：2012-04-20T16:35:59.383
> 
> 标签：asp.net-mvc-4, asp.net-web-api

在创建新的基于 MVC Web API 的服务时，我们希望从一开始就关注 XML，然后使用具有原生 JSON.NET 支持的完整版本添加 JSON 功能作为增强功能。为此，我们希望阻止服务接受请求或以 JSON 格式提供响应，以避免建立我们期望破坏的任何功能。

有没有办法在 ASP.NET MVC API 中禁用 JSON 支持？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T16:48:18.617

您所要做的就是删除 JSON 媒体格式化程序。

```
// Identify JSON formatters in global config.
var jsonMediaTypeFormatters = GlobalConfiguration.Configuration.Formatters
    .Where(x => x.SupportedMediaTypes
    .Any(y => y.MediaType.Equals("application/json", StringComparison.InvariantCultureIgnoreCase)))
    .ToList();

// Remove formatters from global config.
foreach (var formatter in jsonMediaTypeFormatters)
{
    GlobalConfiguration.Configuration.Formatters.Remove(formatter);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-24T12:47:19.100

还有一个更短的选项，因为只能有一个 Json 格式化程序，并且 MediaTypeFormatterCollection 将其作为属性公开。从 Web API 2 开始可用（可能也在 v1 中，不确定）。

`GlobalConfiguration.Configuration.Formatters.Remove(controllerSettings.Formatters.JsonFormatter)`

# java - 使用状态模式进行字符串解析

> ID：10250100
> 
> 赞同：0
> 
> 时间：2012-04-20T16:36:08.487
> 
> 标签：java, design-patterns, state-pattern

我的编程任务的一部分需要使用状态模式解析字符串。明确要求使用状态模式，因此不允许其他选项。

示例字符串是：“***更新****用户**过滤器**userId=user3 **set** name=xxx* ”。（粗体是关键字）。

请求如下：

> 在解析查询时，您应该使用状态模式。有四种状态：OPERATOR、OBJECT、FILTER 和 VALUES。

我查看了有关状态模式的示例，我想我明白了，但我无法弄清楚如何将它应用于字符串解析。

如果有人给我一些提示，我会很高兴。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T15:04:53.033

首先创建你的状态接口。也许用一种方法：`parse`

创建你的 4 个具体状态。实现每个以仅解析字符串的一部分，您的上下文将负责拆分字符串并更改状态。

在您的上下文类中，您执行以下操作：

*   你知道`OperatorState`总是第一个，所以初始化
*   你上下文的状态。阅读字符串，直到到达下一个
*   关键字（“过滤器”）将您已阅读的字符串移动到当前状态（操作员）
*   将当前状态更改为下一个 ( `FilterState`)

等等...

如果您了解状态模式，那么这应该足以构建解决方案。

注意：您可以拥有一个包含关键字和状态的字典，以便您可以自动化它，但在您的情况下，我认为一个简单的解决方案就足够了。

祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:55:34.023

我可能误解了您所说的状态模式是什么意思，所以如果我弄错了，请忽略我，

假设您正在寻找字符串`"abac"`

您从空状态开始`""`并向下迭代字符串的字符。如果你得到一个`'a'`你去状态`"a"`得到一个`'b'`，去状态`"ab"`，得到`'a'`，你回到状态`"a"`，任何其他的空状态，等等

一旦你说`"abac"`你找到了你的字符串。查找正则表达式是一个简单的 DFA。

# c# - 实体框架 - 通过同一列中的多个条件选择 - 引用表

> ID：10250102
> 
> 赞同：3
> 
> 时间：2012-04-20T16:36:09.313
> 
> 标签：c#, linq, entity-framework, linq-to-entities

示例场景：
两个表：**order**和**orderItem**，关系一对多。
我想选择至少有一个价格为 100 的 orderItem 和至少一个价格为 200 的 orderItem 的所有订单。我可以这样做：

```
var orders = (from o in kontextdbs.orders
              join oi in kontextdbs.order_item on o.id equals oi.order_id
              join oi2 in kontextdbs.order_item on o.id equals oi2.order_id
              where oi.price == 100 && oi2.price  == 200
              select o).Distinct(); 
```

但是如果这些条件是用户生成的呢？所以我不知道会有多少条件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:47:06.370

`Where`您需要使用这样的and`Any`方法遍历所有值：

```
List<int> values= new List() { 100, 200 };

var orders = from o in kontextdbs.orders
             select o;
foreach(int value in values)
{    
      int tmpValue = value;
      orders = orders.Where(x => kontextdbs.order_item.Where(oi => x.id == oi.order_id)
                                                      .Any(oi => oi.price == tmpValue));    
}

orders = orders.Distinct(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:42:32.133

```
List<int> orderValues = new List() { 100, 200 };

ObjectQuery<Order> orders = kontextdbs.Orders;
foreach(int value in orderValues) {
    orders = (ObjectQuery<Order>)(from o in orders
                                  join oi in kontextdbs.order_item
                                    on o.id equals oi.order_id
                                  where oi.price == value
                                  select o);
}
orders = orders.Distinct(); 
```

应该可以工作，或者至少这是一般模式 - 您可以在每个阶段对 IObjectQueryables 应用额外的查询。

请注意，根据我的经验，使用 EF 生成这样的动态查询会带来糟糕的性能，不幸的是 - 它会在第一次获得特定模式时花费几秒钟将每个查询编译成 SQL。如果订单值的数量相当稳定，那么这个特定的查询应该可以正常工作。

# xml - Need assistance in creating an xsd

> ID：10250104
> 
> 赞同：-1
> 
> 时间：2012-04-20T16:36:22.387
> 
> 标签：xml, xsd, excel-2010

I'm new to xsd. I'm trying to create a xsd so that my xml should be in the following way..

```
<Info>
            <Val name="n_1">A</Val>
            <Val name="n_2">123</Val>
            <Val name="n_3">2012-05-05T00:00:00</Val>          
</Info> 
```

The xsd which I created is in this way..

```
<xs:element name="Info">
    <xs:complexType>
        <xs:sequence>
             <xs:element name="n_1" type="xs:string"/>
            <xs:element name="n_2" type="xs:integer"/>
            <xs:element name="n_3" type="xs:dateTime"/>
        </xs:sequence>
    </xs:complexType>
</xs:element> 
```

This obviously did not help in meeting my requirements.. But at this point of time I'm struck about one thing .. how to create 3 elements "val" whose attribute value is different... Even if I make it somehow then i will get list of lists error.. how can I manage that?

I'm actually writing this xsd so that my data in excel can be converted to xml.. To add something about my excel, one row is a set in which one column is Info (worst thing comes here :| as I have 3 Val's for one Info) ...

I initially thought this xml is wrong but I was wrong.. it is a standard output/input xml..

Any help in achieving this would be appreciable.

Thanks in advance.. :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T19:08:02.593

Try this XSD.This enforces uniqueness of "**name**" attribute of Val nodes.

```
<?xml version="1.0" encoding="utf-8"?> <xs:schema   xmlns:xs="http://www.w3.org/2001/XMLSchema">
<xs:element name="Info" >
    <xs:complexType>
        <xs:sequence>
            <xs:element name="Val" maxOccurs="unbounded">
                <xs:complexType>
                            <xs:simpleContent >
                                <xs:extension base="xs:anySimpleType">
                                    <xs:attribute name="name" use="required" />
                                </xs:extension>
                            </xs:simpleContent>
                </xs:complexType>
            </xs:element>
        </xs:sequence>
    </xs:complexType>
    <xs:unique name="uniqueNameForValList">
        <xs:selector xpath="Val" />
        <xs:field xpath="@name" />
    </xs:unique>
</xs:element> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T16:56:20.980

XSD 应该是这样的：

```
<xs:schema elementFormDefault="qualified" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="Info">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="Val" maxOccurs="unbounded">
          <xs:complexType>
            <xs:simpleContent>
              <xs:extension base="xs:string">
                <xs:attribute name="name">
                  <xs:simpleType>
                    <xs:restriction base="xs:string">
                      <xs:enumeration value="n_1"/>
                      <xs:enumeration value="n_2"/>
                      <xs:enumeration value="n_3"/>
                    </xs:restriction>
                  </xs:simpleType>
                </xs:attribute>
              </xs:extension>
            </xs:simpleContent>
          </xs:complexType>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
</xs:schema> 
```

它声明了一个`Info`包含子元素列表的元素`Val`。每个元素都`Val`包含一个字符串值（`<xs:simpleContent>`和`<xs:extension base="xs:string">`），以及一个`name`只有三个可能值的属性`n_1`，`n_2`和`n_3`。

根据您的确切要求，您可以使用`Val`内容的类型 - 例如，指定它是一个具有特定最大长度的字符串。同样，您可以更改对`name`属性值的限制（或没有限制）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T16:54:20.053

试试这个 XSD

```
<?xml version="1.0"?>
<xs:schema id="Info" xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">
<xs:element name="Info" msdata:IsDataSet="true" msdata:UseCurrentLocale="true">
<xs:complexType>
  <xs:choice minOccurs="0" maxOccurs="unbounded">
    <xs:element name="Val" nillable="true">
      <xs:complexType>
        <xs:simpleContent msdata:ColumnName="Val_Text" msdata:Ordinal="1">
          <xs:extension base="xs:string">
            <xs:attribute name="name" type="xs:string" />
          </xs:extension>
        </xs:simpleContent>
      </xs:complexType>
    </xs:element>
  </xs:choice>
</xs:complexType> 
```

# php - 帖子分页 [next] 值最终返回应填充的空数组

> ID：10250107
> 
> 赞同：2
> 
> 时间：2012-04-20T16:36:37.847
> 
> 标签：php, facebook, facebook-graph-api

让我们看一个像多米诺骨牌这样的简单页面。当我运行 https://graph.facebook.com/dominos/posts?limit=200&access_token=[ANY OLD ACCESS TOKEN] 之类的查询时，它给了我发布数据的第一页。然后我走到底部并得到下一个，在下一个值的第 5 页或第 6 页之后，我得到一个空数组。但是当我进入多米诺骨牌 Facebook 页面时，他们在包含数据的最后一页上的最后一篇帖子的最后日期之后有更多数据。

我知道要访问私人数据，您需要一个特定的访问令牌，但这些数据都是公开的，我知道这是因为我不必登录即可查看它。

要重新创建这个：

1.  在浏览器中[https://graph.facebook.com/dominos/posts?limit=200](https://graph.facebook.com/dominos/posts?limit=200)

2.  转到页面底部并获取下一个网址

3.  继续执行 #2 直到您到达第 5 或第 6 页，您将获得一个空数据数组，阻止您进一步分页。

任何帮助或见解都会很棒。

[编辑 04-20-2012] 好的，更多信息：

我认为这仅与帖子有关。当我这样做时： https://graph.facebook.com/dominos/tagged?access_token=[anaccesstoken]&until=1262412000 我会返回一页结果。

当我这样做时： https://graph.facebook.com/dominos/posts?access_token=[anaccesstoken]&until=1262412000 我没有。但他们显然是那里的帖子。

我还检查了提要：https://graph.facebook.com/dominos/feed?access_token=[anaccesstoken]&until=1262412000。

那里有很多用户标记，但没有 Domino 的页面帖子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T23:03:46.843

请阅读[文章](http://developers.facebook.com/blog/post/478/)

`the maximum number of results we will fetch before running the visibility checks is 5,000`

`1262412000`是`Jan 2010`, 2 年前的一天。最有可能的是你在过去2年有超过5000个帖子，所以你不能获取超过5000个帖子。

我也试过`https://graph.facebook.com/dominos/posts?limit=200&access_token=[anaccesstoken]&until=1322400000`了，我可以得到数据。所以`until parameter`效果很好。

# java - Am I going it right?

> ID：10250110
> 
> 赞同：-1
> 
> 时间：2012-04-20T16:36:52.307
> 
> 标签：java, jsp, optimization

I am new to programming, but I have a need to group by elements, if they are selected by user; therefore, I am not exactly sure how many elements my group by will contain. Therefore I did this to count amount of selected elements and then, created another statement that creates correct Group by statement that represents the amount of elements needed.

It works, but it looks bulky and I would like to see if there are better ways of doing this?

```
int totalOutPuts = 0;
totalOutPuts = endbox == true ? totalOutPuts + 1 : totalOutPuts;
totalOutPuts = coursebox == true ? totalOutPuts + 1 : totalOutPuts;
totalOutPuts = departmentbox == true ? totalOutPuts + 1 : totalOutPuts;
totalOutPuts = callbox == true ? totalOutPuts + 1 : totalOutPuts;
totalOutPuts = daybox == true ? totalOutPuts + 1 : totalOutPuts;
totalOutPuts = startbox == true ? totalOutPuts + 1 : totalOutPuts;
totalOutPuts = instructorbox == true ? totalOutPuts + 1 : totalOutPuts;
totalOutPuts = roombox == true ? totalOutPuts + 1 : totalOutPuts;
totalOutPuts = buildingbox == true ? totalOutPuts + 1 : totalOutPuts;
totalOutPuts = numberenrolled == true ? totalOutPuts + 1 : totalOutPuts;
int missingElements = 10 - totalOutPuts;

String groupBy = " Group by 1, 2, 3, 4, 5, 6, 7, 8, 9, 10";
if (missingElements == 9) {
    groupBy = " Group by 1";
} else if (missingElements == 8) {
    groupBy = " Group by 1, 2";
} else if (missingElements == 7) {
    groupBy = " Group by 1, 2, 3";
} else if (missingElements == 6) {
    groupBy = " Group by 1, 2, 3, 4";
} else if (missingElements == 5) {
    groupBy = " Group by 1, 2, 3, 4, 5";
} else if (missingElements == 4) {
    groupBy = " Group by 1, 2, 3, 4, 5, 6";
} else if (missingElements == 3) {
    groupBy = " Group by 1, 2, 3, 4, 5, 6, 7";
} else if (missingElements == 2) {
    groupBy = " Group by 1, 2, 3, 4, 5, 6, 7, 8";
} else if (missingElements == 1) {
    groupBy = " Group by 1, 2, 3, 4, 5, 6, 7, 8, 9";
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T16:47:19.677

循环！这是一个实施建议：

```
// adding all the vars to an array might improve readability
boolean checks[] = new boolean[] { endbox, coursebox, departmentbox, callbox,
                                   daybox, startbox, instructorbox, roombox,
                                   buildingbox, numberenrolled };

for (boolean check : checks) {
    if (check) {
        totalOutPuts++;
    }
}

String groupBy = " Group by ";

// this isn't the best way of appending strings in Java,
// you'd be better using StringBuilder. this is for the sake of simplicity
for (int i = 1; i < totalOutPuts; i++) {
    groupBy += i + ", ";
}

// append the last number
groupBy += totalOutPuts + ""; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-20T16:38:56.850

First thing that stands out:

```
totalOutPuts = endbox == true ? totalOutPuts + 1 : totalOutPuts; 
```

Comparing a boolean to `true` is pointless, since it's already a boolean, just do this:

```
totalOutPuts = endbox ? totalOutPuts + 1 : totalOutPuts; 
```

Beyond that, you could simplify further to:

```
totalOutPuts += endbox ? 1 : 0; // same as totalOutPuts = totalOutPuts + (endbox ? 1 : 0); 
```

Or, more readable:

```
if(endbox) {
    totalOutPuts += 1; // or ++totalOutPuts if you're into that sort of thing
} 
```

Then at the bottom, you do this:

```
int missingElements = 10 - totalOutPuts; 
```

So why not just do that in the first place?

```
int missingElements = 10;
if(endbox) {
    missingElements -= 1; // this means missingElements = missingElements - 1;
}
// etc 
```

# extjs - Carousel issue in Sencha Touch

> ID：10250113
> 
> 赞同：0
> 
> 时间：2012-04-20T16:37:02.667
> 
> 标签：extjs, carousel

I have put this code into app/view/ViewCarousel.js

The code is copy-paste from here: [http://docs.sencha.com/touch/2-0/#!/guide/carousel](http://docs.sencha.com/touch/2-0/#!/guide/carousel)

But nothing happens. There's no Carousel in the browser.

What could be happening?

Thank you very much.

```
var carousel = Ext.define('abril16.view.ViewCarousel', {
    extend: 'Ext.Carousel',
    fullscreen: true,

    items: [
        {
            xtype: 'list',

            items: {
                xtype: 'toolbar',
                dock: 'top',
                title: 'Sencha Touch Team'
            },

            store: {
                fields: ['name'],
                data: [
                    {name: 'Rob'},
                    {name: 'Ed'},
                    {name: 'Jacky'},
                    {name: 'Jamie'},
                    {name: 'Tommy'},
                    {name: 'Abe'}
                ]
            },

            itemTpl: '{name}'
        },
        {
            xtype: 'fieldset',
            items: [
                {
                    xtype: 'toolbar',
                    dock: 'top',
                    title: 'Login'
                },
                {
                    xtype: 'textfield',
                    label: 'Name'
                },
                {
                    xtype: 'passwordfield',
                    label: 'Password'
                }
            ]
        }
    ]
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T18:48:56.390

您需要将轮播项目放在配置对象中

```
var carousel = Ext.define('abril16.view.ViewCarousel', {
    extend: 'Ext.Carousel',
    fullscreen: true,
    config:{
    items: []
    }
}); 
```

# .net - 与程序集计数相关的性能和内存影响

> ID：10250114
> 
> 赞同：0
> 
> 时间：2012-04-20T16:37:08.103
> 
> 标签：.net, performance, memory, build, assemblies

我们当前的产品由数百个项目组成，这些项目导致数百个组件。我们正在调查修改我们的构建过程以将这些项目构建成少数几个程序集是否有意义，我正在寻找有关性能影响的信息。此外，我们的应用程序分配的大量内存由程序集图像组成。这种内存占用会减少，还是保持相对不变？

您可以提供的任何信息将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T18:47:22.780

经过一些研究，似乎合并程序集不会对吞吐量性能产生不利影响，并且应该会减少工作集内存。

参考：

[微软提高 .NET 应用程序性能和可扩展性的模式和实践第 5 章](http://msdn.microsoft.com/en-us/library/ms998530.aspx)

# c# - 是否可以将 Socket.Handle 从 C# 应用程序传递到在同一服务器上运行的 ASP.NET Web 应用程序？

> ID：10250116
> 
> 赞同：0
> 
> 时间：2012-04-20T16:37:17.100
> 
> 标签：c#, asp.net, sockets

是否可以将 Socket.Handle 从 C# 应用程序传递到在同一服务器上运行的 ASP.NET Web 应用程序？

我环顾四周，发现了将 C# 套接字传递给非托管代码的示例，但这还不够。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T16:45:25.440

我很好奇你为什么要这么做。

至于答案，不，我有 99% 的把握这是不可能的，因为除非我非常错误，否则套接字句柄的范围仅限于操作系统级别的进程。

编辑：

根据评论，听起来您想让服务器进程在 IPC 传输上运行 WCF 服务，ASP.NET 应用程序可以使用该服务将命令传递给硬件。

一个额外的好处是，如果您使用 WCF 并最终需要将 ASP.NET 站点移动到另一个盒子，您可以切换到 TCP 传输而不用大惊小怪。

# c++ - 在基类中调用同名方法

> ID：10250117
> 
> 赞同：5
> 
> 时间：2012-04-20T16:37:19.133
> 
> 标签：c++, methods, virtual, subclass, base-class

基类`A`有子类`B`，`B`也有子类`C`。`A`实现了一个虚方法`doStuff()`，`B`没有，也`C`确实。从`C`，我想调用`A`的实现`doStuff()`（我在`C`的实现中这样做，`doStuff()`但这并不重要。）我应该调用

```
A::doStuff(); 
```

或者：

```
B::doStuff(); 
```

第一个似乎更清楚，因为它指的是实际的实现。另一方面，如果我后来决定`B`需要`doStuff()`不同于`A`. 哪个更标准？哪个更危险？

我有点惊讶`B::doStuff()`没有触发任何警告，但我想根据定义`B`，即使它来自基类，它也有一个实现。基类和实现的链可以任意长和复杂吗？例如，如果我有`A`through `Z`，每个都是前一个的子类，我是否可以在链中的任何地方都有实现，并且调用任何类的方法是否只是“向上链”直到找到实现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T16:56:28.267

首先，关于最后一段，是的，你是绝对正确的。

接下来，对于主要问题：

这是一个逻辑问题，应该根据具体情况进行处理。您是唯一可以决定是从`B`还是从调用逻辑的人`A`，即使`B::doStuff()`尚未实现。没有正确的答案。

但是，您应该查看**模板方法**模式。我的猜测是，如果你想`C`调用一些东西，`A`然后你决定你想要`D`（的兄弟`C`）做同样的事情，你就是在复制代码。所以我会采取不同的方法：

```
class A
{
private:
   void doAStuff(); //doesn't have to be here
public:
   virtual void doStuff()
   {
      doAStuff();
   }
   void doAStuffAndStuff();
   {
      doAStuff();
      doStuff();
   }
}

class B : A
{
public:
   virtual void doStuff(); //or not
}

class C : B
{
public:
   virtual void doStuff();
} 
```

IMO 这更直观。假设我有一个`A* a`，我不知道的动态类型`a`：

*   如果我想`doStuff()`用最派生类中的逻辑调用，我调用`doStuff()`.
*   如果我想`doStuff()`用最派生类中的逻辑调用，但我也想要来自 的逻辑`A`，我调用`doAStuffAndStuff()`.

我将这种方法作为一种替代方法。我并不是说它一定适用于你的情况，但它可能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:59:34.923

打电话`B::doStuff`。更好的是，如果可以的话，不要使用需要显式调用基类方法的设计。如果必须，请`base.doStuff`通过某些宏或别名构造进行模拟，以防止出现此类错误。您可以在类中定义别名（并确保其在编译时存在）`BaseType`并使用`BaseType::doStuff`语法。

> 我有点惊讶 B::doStuff() 没有触发任何警告，但我想根据定义 B 有一个实现，即使它来自基类

没有什么可警告的。在您的情况下，这是一个法律场景。

> 基类和实现的链可以任意长和复杂吗

是的，它可以，但它不应该。需要长继承链并包含某种隐藏规则的设计通常会破坏应该调用哪些基类的哪些方法。

# android - Build fingerprint: 'samsung/GT-P7500/GT-P7500:3.2/HTJ85B/XWKL1:user/release-keys' error in Android

> ID：10250126
> 
> 赞同：5
> 
> 时间：2012-04-20T16:38:32.390
> 
> 标签：android

I am developing a baseball application. It works fine on Htc Incredible, Samsung 7 inch, but getting crash after playing 3 times only on Samsung 10 inch device. I got the error as:

```
04-18 11:22:34.610: I/DEBUG(237): Build fingerprint: 'samsung/GT-P7500/GT-P7500:3.2/HTJ85B/XWKL1:user/release-keys'
04-18 11:22:34.610: I/DEBUG(237): pid: 4695, tid: 5082  >>> com.sttl.em <<<
04-18 11:22:34.610: I/DEBUG(237): signal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr fff61dcc
04-18 11:22:34.610: I/DEBUG(237):  r0 fff61dcc  r1 00000000  r2 002e1cf0  r3 00000000
04-18 11:22:34.610: I/DEBUG(237):  r4 00000de1  r5 81d1a1ac  r6 002e1cf0  r7 00000000
04-18 11:22:34.610: I/DEBUG(237):  r8 5e9bfb78  r9 40093f0c  10 40093ef4  fp 4023c078
04-18 11:22:34.610: I/DEBUG(237):  ip 00000000  sp 5e9bfb58  lr aff10cb4  pc 81d0e810  cpsr a0000030
04-18 11:22:34.610: I/DEBUG(237): dump around R0:
04-18 11:22:34.610: I/DEBUG(237): fff61dcc: ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff 
04-18 11:22:34.610: I/DEBUG(237): fff61dec: ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff 
04-18 11:22:34.610: I/DEBUG(237): fff61e0c: ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff 
04-18 11:22:34.610: I/DEBUG(237): fff61e2c: ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff 
04-18 11:22:34.610: I/DEBUG(237): fff61e4c: ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff 
04-18 11:22:34.610: I/DEBUG(237): dump around R2:
04-18 11:22:34.610: I/DEBUG(237): 002e1cf0: 00000505 002de030 00000001 00000010 002d05a8 00000000 00000002 002df088 
04-18 11:22:34.610: I/DEBUG(237): 002e1d10: 00000000 00000002 002df110 00000000 00000002 00327918 00000000 00000001 
04-18 11:22:34.610: I/DEBUG(237): 002e1d30: 002d04a8 00000000 00000001 00111f60 00000000 00000001 002b9740 00000000 
04-18 11:22:34.610: I/DEBUG(237): 002e1d50: 00000001 002b9788 00000000 00000001 002b97d0 00000000 00000001 00274118 
04-18 11:22:34.610: I/DEBUG(237): 002e1d70: 00000000 00000001 00274160 00000000 00000001 002741a8 00000000 00000001 
04-18 11:22:34.610: I/DEBUG(237): dump around R5:
04-18 11:22:34.610: I/DEBUG(237): 81d1a1ac: 00000000 00000000 00000000 80c03744 80c02d90 80c02d98 80c03784 80c05934 
04-18 11:22:34.610: I/DEBUG(237): 81d1a1cc: 80c05948 aff188c5 80c0698c aff0cdc8 aff19f95 aff184a1 aff180c1 80c06668 
04-18 11:22:34.610: I/DEBUG(237): 81d1a1ec: 80c05a98 80c05940 aff0c8fc 80c05944 80c0665c 80c037a4 aff289a9 80c03764 
04-18 11:22:34.610: I/DEBUG(237): 81d1a20c: aff0cc28 aff0d090 aff0cfb4 80c064d4 80c064d8 80c02d94 80c02f10 aff0cef0 
04-18 11:22:34.610: I/DEBUG(237): 81d1a22c: aff0cf9c aff1cead 80d04611 80d045d5 80d04631 80d045fd 80d04621 80d045e9 
04-18 11:22:34.610: I/DEBUG(237): dump around R6:
04-18 11:22:34.610: I/DEBUG(237): 002e1cf0: 00000505 002de030 00000001 00000010 002d05a8 00000000 00000002 002df088 
04-18 11:22:34.610: I/DEBUG(237): 002e1d10: 00000000 00000002 002df110 00000000 00000002 00327918 00000000 00000001 
04-18 11:22:34.610: I/DEBUG(237): 002e1d30: 002d04a8 00000000 00000001 00111f60 00000000 00000001 002b9740 00000000 
04-18 11:22:34.620: I/DEBUG(237): 002e1d50: 00000001 002b9788 00000000 00000001 002b97d0 00000000 00000001 00274118 
04-18 11:22:34.620: I/DEBUG(237): 002e1d70: 00000000 00000001 00274160 00000000 00000001 002741a8 00000000 00000001 
04-18 11:22:34.620: I/DEBUG(237): dump around R8:
04-18 11:22:34.620: I/DEBUG(237): 5e9bfb78: 002fc3a8 00000001 5e9bfc18 40093f08 59110008 002fc3a8 5e9bfb98 aca4120b 
04-18 11:22:34.620: I/DEBUG(237): 5e9bfb98: 40093f08 5aae2cd7 ad32c368 5e9bfc18 ad32c368 40093f24 5e9bfc10 00000002 
04-18 11:22:34.620: I/DEBUG(237): 5e9bfbb8: 00000000 5c8e871c 00000000 5e9bfc10 00000001 001b35f8 002fc3b0 0001dbc0 
04-18 11:22:34.620: I/DEBUG(237): 5e9bfbd8: 00002000 acaa11b8 fffffe90 aca1be20 5e9bfc10 002fc3a8 aca1bd90 592db5c0 
04-18 11:22:34.620: I/DEBUG(237): 5e9bfbf8: fffffe78 aca1aed4 00000000 00000000 5e9bfed8 aca16bdc 59a87df4 40093ec8 
04-18 11:22:34.620: I/DEBUG(237): dump around R9:
04-18 11:22:34.620: I/DEBUG(237): 40093f0c: 00000de1 40093f40 59014b98 592d9224 5900bd10 5c8f27d9 00000de1 40936d10 
04-18 11:22:34.620: I/DEBUG(237): 40093f2c: 40093f64 59014e4c 592d78ac 59014b98 5c8f33c1 00000000 3e828f5d 40852b50 
04-18 11:22:34.620: I/DEBUG(237): 40093f4c: 40936d10 40093f88 59022ec4 592d7c54 59014e4c 5c8f2ff5 40b2da68 00000001 
04-18 11:22:34.620: I/DEBUG(237): 40093f6c: 40852b50 40936d10 40093fdc 59023338 592db3b0 59022ec4 00000000 40936d10 
04-18 11:22:34.620: I/DEBUG(237): 40093f8c: 00000000 00000000 00000000 0002dc1a 40936d10 000002f0 00000000 00000500 
04-18 11:22:34.620: I/DEBUG(237): dump around R10:
04-18 11:22:34.620: I/DEBUG(237): 40093ef4: 40093f24 5900bd10 59110008 001c53b0 5c8efa45 40936d10 00000de1 40093f40 
04-18 11:22:34.620: I/DEBUG(237): 40093f14: 59014b98 592d9224 5900bd10 5c8f27d9 00000de1 40936d10 40093f64 59014e4c 
04-18 11:22:34.620: I/DEBUG(237): 40093f34: 592d78ac 59014b98 5c8f33c1 00000000 3e828f5d 40852b50 40936d10 40093f88 
04-18 11:22:34.620: I/DEBUG(237): 40093f54: 59022ec4 592d7c54 59014e4c 5c8f2ff5 40b2da68 00000001 40852b50 40936d10 
04-18 11:22:34.620: I/DEBUG(237): 40093f74: 40093fdc 59023338 592db3b0 59022ec4 00000000 40936d10 00000000 00000000 
04-18 11:22:34.620: I/DEBUG(237):  d0  42253333c4228b9f  d1  bf800aed4422675a
04-18 11:22:34.620: I/DEBUG(237):  d2  00000000bf8015da  d3  00000000c3b56ead
04-18 11:22:34.620: I/DEBUG(237):  d4  0000000000000000  d5  c351800000000000
04-18 11:22:34.620: I/DEBUG(237):  d6  00000000bf800000  d7  44228b9f3f800000
04-18 11:22:34.620: I/DEBUG(237):  d8  0000000000000000  d9  4420000043bc0000
04-18 11:22:34.620: I/DEBUG(237):  d10 0000000040b00000  d11 0000000040c00000
04-18 11:22:34.620: I/DEBUG(237):  d12 4200000040b00000  d13 000000003e980000
04-18 11:22:34.620: I/DEBUG(237):  d14 404fc0003e880000  d15 00000000427e0000
04-18 11:22:34.620: I/DEBUG(237):  scr 60000012
04-18 11:22:34.790: D/HierarchicalStateMachine(302): handleMessage: E msg.what=65619
04-18 11:22:34.790: D/HierarchicalStateMachine(302): processMsg: ConnectedState
04-18 11:22:34.790: D/WifiStateMachine(302): ConnectedState{ what=65619 when=-2ms arg1=6 }
04-18 11:22:34.790: D/HierarchicalStateMachine(302): handleMessage: X
04-18 11:22:34.820: I/DEBUG(237):          #00  pc 0000e810  /system/lib/egl/libGLESv1_CM_tegra.so
04-18 11:22:34.820: I/DEBUG(237):          #01  pc 0000e988  /system/lib/egl/libGLESv1_CM_tegra.so (glDisable)
04-18 11:22:34.820: I/DEBUG(237):          #02  pc 00011d34  /system/lib/libdvm.so
04-18 11:22:34.820: I/DEBUG(237):          #03  pc 00041208  /system/lib/libdvm.so (dvmCallJNIMethod_virtualNoRef)
04-18 11:22:34.820: I/DEBUG(237): libc base address: aff00000
04-18 11:22:34.820: I/DEBUG(237): code around pc:
04-18 11:22:34.820: I/DEBUG(237): 81d0e7f0 d803d042 429c3b21 e043d174 5360f648 
04-18 11:22:34.820: I/DEBUG(237): 81d0e800 d019429c 428c1d59 e007d16c ff52f7fa 
04-18 11:22:34.820: I/DEBUG(237): 81d0e810 eb066803 f88c0c03 e0aa785e ff4af7fa 
04-18 11:22:34.820: I/DEBUG(237): 81d0e820 18726801 7860f882 f7fae0a3 6803ff43 
04-18 11:22:34.820: I/DEBUG(237): 81d0e830 f88018f0 e09c7862 ff3cf7fa eb066802 
04-18 11:22:34.820: I/DEBUG(237): code around lr:
04-18 11:22:34.820: I/DEBUG(237): aff10c94 08bd87f0 e5964000 e5967000 e2144903 
04-18 11:22:34.820: I/DEBUG(237): aff10ca4 1a00000f f57ff05f e5965000 ebffed97 
04-18 11:22:34.820: I/DEBUG(237): aff10cb4 e2055a02 e3853001 e1500003 0a000006 
04-18 11:22:34.820: I/DEBUG(237): aff10cc4 e5865000 e1a00006 e1a01005 e3a02001 
04-18 11:22:34.820: I/DEBUG(237): aff10cd4 ebfffede e1a00004 e8bd87f0 e3a00000 
04-18 11:22:34.820: I/DEBUG(237): stack:
04-18 11:22:34.820: I/DEBUG(237):     5e9bfb18  00000000  
04-18 11:22:34.820: I/DEBUG(237):     5e9bfb1c  002df998  
04-18 11:22:34.820: I/DEBUG(237):     5e9bfb20  00000505  
04-18 11:22:34.820: I/DEBUG(237):     5e9bfb24  002e1cf0  
04-18 11:22:34.820: I/DEBUG(237):     5e9bfb28  40093e50  
04-18 11:22:34.820: I/DEBUG(237):     5e9bfb2c  5e9bfb78  
04-18 11:22:34.820: I/DEBUG(237):     5e9bfb30  40093e48  
04-18 11:22:34.820: I/DEBUG(237):     5e9bfb34  40093e30  
04-18 11:22:34.820: I/DEBUG(237):     5e9bfb38  002e1cf0  
04-18 11:22:34.820: I/DEBUG(237):     5e9bfb3c  81d1a1ac  
04-18 11:22:34.820: I/DEBUG(237):     5e9bfb40  002e1cf0  
04-18 11:22:34.820: I/DEBUG(237):     5e9bfb44  81d096cb  /system/lib/egl/libGLESv1_CM_tegra.so
04-18 11:22:34.820: I/DEBUG(237):     5e9bfb48  002e1cf0  
04-18 11:22:34.820: I/DEBUG(237):     5e9bfb4c  00000000  
04-18 11:22:34.820: I/DEBUG(237):     5e9bfb50  df002777  
04-18 11:22:34.820: I/DEBUG(237):     5e9bfb54  e3a070ad  
04-18 11:22:34.820: I/DEBUG(237): #00 5e9bfb58  5e9bfb98  
04-18 11:22:34.820: I/DEBUG(237):     5e9bfb5c  00000000  
04-18 11:22:34.820: I/DEBUG(237):     5e9bfb60  5e9bfc18  
04-18 11:22:34.820: I/DEBUG(237):     5e9bfb64  40093f14  
04-18 11:22:34.820: I/DEBUG(237):     5e9bfb68  5e9bfb78  
04-18 11:22:34.820: I/DEBUG(237):     5e9bfb6c  81d0e98d  /system/lib/egl/libGLESv1_CM_tegra.so
04-18 11:22:34.820: I/DEBUG(237): #01 5e9bfb70  5e9bfb98  
04-18 11:22:34.820: I/DEBUG(237):     5e9bfb74  aca11d38  /system/lib/libdvm.so
04-18 11:22:35.000: I/InputReader(302): dispatchTouch::touch event's action is 0, pending(waiting finished signal)=0
04-18 11:22:35.000: I/InputDispatcher(302): Delivering touch to current input target: action: 0, channel '40e02698 com.sttl.em/com.sttl.em.mainActivity (server)'
04-18 11:22:35.000: I/InputDispatcher(302): Delivering touch to current input target: action: 0, channel 'TouchIntercepter (server)'
04-18 11:22:35.110: I/InputReader(302): dispatchTouch::touch event's action is 1, pending(waiting finished signal)=0
04-18 11:22:35.110: I/InputDispatcher(302): Delivering touch to current input target: action: 1, channel '40e02698 com.sttl.em/com.sttl.em.mainActivity (server)'
04-18 11:22:35.110: I/InputDispatcher(302): Delivering touch to current input target: action: 1, channel 'TouchIntercepter (server)'
04-18 11:22:35.550: D/BatteryService(302): update start
04-18 11:22:36.550: I/DEBUG(237): dumpstate /data/log/dumpstate_app_native.txt
04-18 11:22:36.550: I/BootReceiver(302): Copying /data/tombstones/tombstone_06 to DropBox (SYSTEM_TOMBSTONE)
04-18 11:22:36.560: I/dumpstate(7256): begin
04-18 11:22:36.650: D/dalvikvm(302): GC_CONCURRENT freed 1714K, 59% free 17668K/42375K, paused 3ms+6ms
04-18 11:22:36.670: I/InputReader(302): dispatchTouch::touch event's action is 0, pending(waiting finished signal)=0
04-18 11:22:36.670: I/InputDispatcher(302): Delivering touch to current input target: action: 0, channel '40e02698 com.sttl.em/com.sttl.em.mainActivity (server)'
04-18 11:22:36.670: I/InputDispatcher(302): Delivering touch to current input target: action: 0, channel 'TouchIntercepter (server)'
04-18 11:22:36.800: I/InputReader(302): dispatchTouch::touch event's action is 1, pending(waiting finished signal)=0
04-18 11:22:36.800: I/InputDispatcher(302): Delivering touch to current input target: action: 1, channel '40e02698 com.sttl.em/com.sttl.em.mainActivity (server)'
04-18 11:22:36.800: I/InputDispatcher(302): Delivering touch to current input target: action: 1, channel 'TouchIntercepter (server)'
04-18 11:22:37.560: I/Gmail(817): MainSyncRequestProto: lowestBkwdConvoId: 0, highestHandledServerOp: 8731, normalSync: true 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-23T05:54:38.723

实际错误是**信号 11**，这意味着本机代码崩溃。

如果您将其开发为本机应用程序，则您的应用程序崩溃了。否则它可能已经在 Android 的原生库中崩溃了，这种可能性较小。

在调试日志中有堆栈跟踪，您可以通过 gcc 实用程序将其反向映射到源代码行数

```
arm-none-linux-gnueabi-addr2line -f -C -e libapp.so <address> 
```

**细节：**

您的日志中有趣的行是：

```
I/DEBUG(237):          #00  pc 0000e810  /system/lib/egl/libGLESv1_CM_tegra.so
I/DEBUG(237):          #01  pc 0000e988  /system/lib/egl/libGLESv1_CM_tegra.so (glDisable)
I/DEBUG(237):          #02  pc 00011d34  /system/lib/libdvm.so
I/DEBUG(237):          #03  pc 00041208  /system/lib/libdvm.so (dvmCallJNIMethod_virtualNoRef) 
```

这些是导致崩溃的函数的指针，最上面的一个是实际崩溃的函数。在您的情况下，您可以看到它在 OpenGL 库中。

此外，这取决于您的应用程序是否具有本机代码，或者只是 Java 代码。由于它在系统库中崩溃，并且您可能只在 Java 中工作，这可能表明系统/设备错误，您可能无法修复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T07:30:46.607

我在 Galaxy Tab 10.1/Acer Iconia 500 上的 onAnimationFinished() 中/之后遇到了该错误。在那里我调用了 runOnUiThread(Runnable)。我通过用 handler.post(Runnable) 替换 runOnUiThread 来修复它

# vb.net - TCP Client in VB.NET error while reading data from socket server

> ID：10250134
> 
> 赞同：0
> 
> 时间：2012-04-20T16:38:47.650
> 
> 标签：vb.net, sockets, tcp

I have a TCP Socket Client (using the Socket Class) that is connected to a simple TCP socket server (just for testing) I have this code snippet :

```
Dim aSocket as Socket
While aSocket.Connected = True
                     byteRead = aSocket.Receive(dataByte) 'number of bytes
                    'checking the number of bytes
                    If byteRead > 0 Then
                        data = System.Text.Encoding.ASCII.GetString(dataByte, 0, byteRead)
                     End if

Do Processing
                data Nothing
                byteRead = Nothing
end while 
```

I have also a procedure that is checking the connection state and try to reconnect and do the working stuff...After try to reconnect on a new socket and reading data i receive a message error on this line : byteRead = aSocket.Receive(dataByte) 'number of bytes "An existing connection was forcibly closed by the remote host“

I have perform some searches on the internet but i did not find anything. Could be related of the way of reading data?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T13:14:06.983

我发现了问题...一些`TcpSocket.Close()`在某些功能中调用...

# javascript - 浏览器如何读取JavaScripts，应该先出现（置顶）：event？功能？或子功能

> ID：10250142
> 
> 赞同：1
> 
> 时间：2012-04-20T16:39:13.147
> 
> 标签：javascript, jquery

一个简单的问题。

我有一个包含多个 JavaScript 的 Web 项目。

JS：

```
// (1） Event

$('.input').keyup(function()
{
    keyUpFunction();    
});

// (2) Function

function keyUpFunction(){ ... } 
```

(1),(2) 哪个应该在一个 javascript 文件中排在第一位？如果浏览器先读取函数，它是否将函数存储在内存中并在扫描事件时调用它。

在某些情况下，在 multi javascript 中定义了相同的函数。例如

```
prm.add_endRequest(function() {
    fn1();
    fn2();
});

$(document).ready(.......) 
```

我是否应该复制函数名称并在每个 js 文件中定义每个组件。还是将函数声明在一个文件中并调用复合函数的子函数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T16:49:37.403

函数定义如下：

```
function fooBar(){} 
```

被“提升”到当前范围的顶部。这意味着它们在当前范围内将始终可用，即使它们是在文件末尾定义的。

如果你定义了这样的函数，这不*成立：*

```
 var fooBar = function(){}; 
```

这些函数不会被提升，必须先定义才能使用。

应该注意的是，在您的具体示例中，`keyUpFunction`只有在触发 keyup 事件后才会调用。这也意味着您页面上的所有 javascript 都将被评估，因此无论如何都会定义（解析）keyUpFunction。

编辑：更明确地说，这第一个例子是好的：

```
doSomething('hello world');
function doSomething(str){ 
   console.log(str);
} 
```

但是，这会给您带来问题：

```
doSomething('hello world');
var doSomething = function(str){ 
   console.log(str);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T16:53:34.257

@Matt 的回答很好地涵盖了提升功能的东西。

为避免多个文件中的函数名称冲突，请将您的内容包装在*立即调用的函数表达式*中，例如：

```
(function() {
     // put your variables functions here
     ...

     // register event handlers
})(); 
```

其中声明的任何变量或函数都将被限制在该范围内。

# django - 扩展镜像存储模型

> ID：10250145
> 
> 赞同：1
> 
> 时间：2012-04-20T16:39:25.963
> 
> 标签：django, django-models, django-apps, django-inheritance

我正在尝试在我的项目中安装 imagestore 应用程序。默认模型创建成功，所有其他部分正常工作。

但是，它具有扩展基本（抽象）模型并通过一些复杂机制创建自己的功能的功能。这是我的模型：

```
from django.db import models 
from imagestore.models.bases.album import BaseAlbum 
class Newalbum(BaseAlbum): 
    title = models.CharField("title", max_length=128) 
    class Meta(BaseAlbum.Meta): 
        app_label = "imagestore" 
        abstract = False 
```

我的设置中还有一个字符串`IMAGESTORE_ALBUM_MODEL = 'art.models.Newalbum'`。当我运行 syncdb 时，它告诉我后端模块“art.models”没有定义“Newalbum”类。（“模块”对象没有属性“新专辑”）。但当然它定义了。

而陌生感才刚刚开始。当我将调试语句放在 imagestore 试图获取我的模型的地方时，它会打印正确的模块（已经导入）和正确的类名（字符串）。但！`dir(mod)`仅打印出现在“from imagestore.models.bases.album import BaseAlbum”之前的变量。在上面的示例中，仅显示“models”和默认下划线属性。为什么？关于导入模块我不知道什么？

我已经尝试在设置属性、django 版本（和所需应用程序）、app_label 等的许多尴尬组合中安装它。当我没有在我的设置中添加 IMAGESTORE_ALBUM_MODEL 时，它会创建表，但是这个模型没有任何 BaseClass 的行为。那么，我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T03:03:04.690

解决了！在逐步完成导入过程时（我在 imagestore.utils.load_class 中添加了以下内容）

```
import pdb
pdb.set_trace() 
```

我发现有一个循环导入。这是事情的顺序（稍微简化）：

1.  加载类（IMAGESTORE_ALBUM_MODEL）
2.  从 imagestore.models.bases.album 导入 BaseAlbum
3.  BaseAlbum 对 IMAGESTORE_IMAGE_MODEL (head) 有一个 FK，因此它使用 load_class 导入
4.  load_class(IMAGESTORE_IMAGE_MODEL)
5.  从 imagestore.models.bases.image 导入 BaseImage
6.  BaseImage 具有 IMAGESTORE_ALBUM_MODEL（专辑）的 FK，因此它使用 load_class 导入
7.  当此调用时 __import__ IMAGESTORE_ALBUM_MODEL 已经在 sys.modules 中，虽然不完整，因为它仍在构建中。因此该模块还没有“专辑”属性。

快速的解决方案是将 head 字段移动到 models.album.Album 并将其从 BaseAlbum 中删除。完成此操作后，我能够让网站再次运行。您必须在新应用程序中使用模型包（不是简单的 models.py），图像和相册位于单独的文件中。

如果这还不够清楚，请给我留言，我会努力做得更好。

# c# - 找不到数据绑定属性，为什么？

> ID：10250148
> 
> 赞同：2
> 
> 时间：2012-04-20T16:39:31.357
> 
> 标签：c#, wpf, silverlight, windows-phone-7, xaml

请帮助我，为什么这个绑定不起作用，我想从数据上下文为 PlayerBarPresenter 的 PlayerBar.xaml 绑定到 PlayerBarPresenter.Card1.ImgCard 像这样 Source = Binding{Source Card1, Path = ImgCard} 比我得到这个异常

> 在 mscorlib.dll System.Windows.Data 错误中发生了“System.IO.FileNotFoundException”类型的第一次机会异常：BindingExpression 路径错误：在“Card1”“System.String”上找不到“ImgCard”属性（HashCode=949723141）。BindingExpression: Path='ImgCard' DataItem='Card1' (HashCode=949723141); 目标元素是'System.Windows.Controls.Image'（名称=''）；目标属性是“源”（类型“System.Windows.Media.ImageSource”）..

找到文件如果只是在 TablePresenter 中的同一个属性中，但我想在 TablePresenter.Card1.ImgCard 中进行绑定

UserControl x:Class="poki.View.PlayerBar" 数据上下文是 TablePresenter

```
 <Image Width="50" Height="80" Source="{Binding Source=Card1, Path=ImgCard}" RenderTransformOrigin="0.5,0.5" Canvas.Left="108.358"
Canvas.Top="-8.349"> 
```

TablePresenter.cs

```
using System;
using System.Net;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Documents;
using System.Windows.Ink;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Shapes;
using poki.View;
using System.Windows.Media.Imaging;
using poki.Model;

namespace poki.Presenters
{
    public class PlayerBarPresenter : PresenterBase<PlayerBar>
    {

        private BitmapImage playerImage;
        public BitmapImage PlayerImage
        {
            get { return playerImage; }
            set
            {
                playerImage = value;
                OnPropertyChanged("PlayerImage");
            }
        }

        private Card card1;
        public Card Card1
        {
            get { return card1; }
            set
            {
                card1 = value;
                OnPropertyChanged("Card1");
            }
        }

#endregion

        public PlayerBarPresenter(PlayerBar pb) : base(pb)
        {
            Card1 = new Card(22);

            Card1.S = "fasyom";           
        }
    }
} 
```

表格.cs

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Net;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Shapes;
using Microsoft.Phone.Controls;
using poki.Presenters;
using System.Windows.Media.Imaging;
using poki.Model;

namespace poki.View
{
    public partial class Table : PhoneApplicationPage
    {
        public TablePresenter Presenter { get { return this.DataContext as TablePresenter; } }

        public Table()
        {
            this.Loaded += new RoutedEventHandler(Table_Loaded);
            InitializeComponent();
        }

        void Table_Loaded(object sender, RoutedEventArgs e)
        {
            DataContext = new TablePresenter(this); 

            PlayerBarPresenter a = new PlayerBarPresenter(new PlayerBar());

            //a.Card1.ImgCard = new BitmapImage(new Uri("/Datas/Images/1/7.png", UriKind.Relative));
            //a.Card2 = new BitmapImage(new Uri("/Datas/Images/1/7.png",UriKind.Relative));
            gridTable.Children.Add(a.View);
        }

    }
} 
```

卡片.cs

```
using System;
using System.Net;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Documents;
using System.Windows.Ink;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Animation;
using System.Windows.Shapes;
using System.Windows.Media.Imaging;

namespace poki.Model
{
    public class Card : Notifier
    {
        public int card { get; set; }

        public Card(int Card1)
        {
            card = Card1;
            ImgCard = new BitmapImage(new Uri("/Datas/Images/1/7.png", UriKind.Relative)); //new BitmapImage(new Uri("/Datas/Images/Cards/" + Suit + "/" + Rank + ".png",UriKind.Relative)); 

        }        

        public int Suit
        {
            get { return card / 13; }
        }

        public int Rank
        {
            get { return card % 13; }
        }

        private BitmapImage imgCard;
        public BitmapImage ImgCard
        {
            get { return imgCard; }
            set
            {
                imgCard = value;
                OnPropertyChanged("ImgCard");
            }
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T16:44:00.023

认为你的绑定表达式是错误的，请尝试这样：

```
<Image Width="50" Height="80" Source="{Binding Card1.ImgCard}" RenderTransformOrigin="0.5,0.5" Canvas.Left="108.358" Canvas.Top="-8.349"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:42:34.203

您将 设置`Source`为 string `"Card1"`，当然它没有您期望的任何属性。由于卡在 中，因此`DataContext`您将希望扩展`Path`( )，因此在绑定到将用于代替 的 or`Path=Card1.ImgCard`时，切勿设置任何源。`DataContext``DataContext`

# jquery - OS X 仪表板小部件中的 AJAX 会话 Cookie

> ID：10250154
> 
> 赞同：1
> 
> 时间：2012-04-20T16:39:49.460
> 
> 标签：jquery, ajax, macos, widget, dashboard

我正在为 OS X 开发仪表板小部件。使用 AJAX 我正在与远程 API 交互。我正在使用 jQuery 来简化 ajax 实现。我正在使用的 API 需要登录并使用正常的会话 cookie。我已成功登录，但由于未登录，后续的 AJAX 调用失败。看来小部件/jQuery/ajax 没有存储/使用会话 cookie。我错过了什么？

```
function login(e,p) {
    $.ajax({
        url: url + "sessions.json",
        type: "POST",
        data: {
            login: e,
            password: p
        },
        success: function(res) {
            getProjects();
        },
        dataType: 'json',
        xhrFields: {
            withCredentials: true
        }
    });
}

function getProjects() {
    $.ajax({
        url: url + "projects.json",
        type: "GET",
        data: {
        },
        success: function(res) {

            console.log(res);
        },
        dataType: 'json',
        xhrFields: {
            withCredentials: true
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T18:40:50.553

我在研究其他东西时遇到了这个问题的解决方案。

[Phonegap App 使用身份验证与 Rails 3 App 通信](https://stackoverflow.com/questions/11905976/phonegap-app-communicate-with-rails-3-app-using-authentication)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-02T04:26:58.113

感谢您分享您的答案：

```
xhrFields: {
  withCredentials: true
} 
```

然而，对我来说，在 Dashcode 中起作用的是设置 Widget Attributes > Network/Disk Access > **Allow External File Access** to *checked*。我一直在寻找某种方法来存储浏览器 cookie，并且通过系统地切换这个和“withCredentials”，最后，似乎 withCreds 对我没有任何帮助，而允许外部文件访问是关键。

希望这可以帮助。

# regex - 正则表达式在两个已知单词之间选择文本

> ID：10250155
> 
> 赞同：0
> 
> 时间：2012-04-20T16:39:54.827
> 
> 标签：regex, variables

我有模式 TABLE *some_table* LARGE READ_ONLY LOTS_OF_OTHER_WORDS {

我想选择 LARGE READ_ONLY LOTS_OF_OTHER_WORDS

我想去掉 some_table 之后的所有单词，其中 some_table 每次都是不同的表名。我试过 (?<=TABLE\s(. *?)\s)。*但是 (.*?) 似乎不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T20:05:33.240

*   在要删除的单词之后总是有一个大括号吗？
*   some_table 名称总是一个单词名称吗？

如果是这样，我会使用：

```
TABLE\s?(\s*[^{]*?){ 
```

然后您需要替换第一组中的匹配项。

编辑：我忘记了不应该成为匹配部分的表名 - 更新的正则表达式：

```
TABLE\s*?\w+\s?([^{]*?){ 
```

说明：
- 查找字符串 TABLE
- 匹配第一个单词（并允许其前后有空格）`\s*?\w+\s?`
- 组：匹配所有不是大括号的内容`([^{]*?)`
- 匹配括号

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:45:51.423

是这个吗？

```
TABLE \w+ (.*) 
```

[http://regexr.com?30ncp](http://regexr.com?30ncp)

# javascript - 为什么我的 Javascript 不能在 IE 中运行

> ID：10250157
> 
> 赞同：0
> 
> 时间：2012-04-20T16:40:00.537
> 
> 标签：javascript, internet-explorer, filter

下面是我的代码。它应该过滤一个表。它在除 IE 之外的所有应用中都运行良好。你能帮我吗？

也许缺少标签或其他东西。我已经经历过很多次了，真的可以请人帮忙！

```
<script type="text/javascript">
function hasPath(element, cls) {
    return (' ' + element.getAttribute('pathway')).indexOf(cls) > -1;
}

function hasLevel(element, cls) {
    return (' ' + element.getAttribute('level')).indexOf(cls) > -1;
}

function hasBody(element, cls) {
    return (' ' + element.getAttribute('body')).indexOf(cls) > -1;
}

function QualificationSearch() {
    var imgdiv = document.getElementById("Chosen_Pathway_img");
    var p = document.getElementById("PathwaySelect");
    var pathway = p.options[p.selectedIndex].value;
    if (pathway == "ALLPATHS") {
        pathway = "";
        imgdiv.src = "/templates/superb/images/QualChecker/pic_0.png"
    }
    if (pathway == "ES") {
        imgdiv.src = "/templates/superb/images/QualChecker/pic_1.png"
    }
    if (pathway == "HOUSING") {
        imgdiv.src = "/templates/superb/images/QualChecker/pic_2.png"
    }
    if (pathway == "PLAYWORK") {
        imgdiv.src = "/templates/superb/images/QualChecker/pic_3.png"
    }
    if (pathway == "SC") {
        imgdiv.src = "/templates/superb/images/QualChecker/pic_4.png"
    }
    if (pathway == "YW") {
        imgdiv.src = "/templates/superb/images/QualChecker/pic_5.png"
    }
    var a = document.getElementById("AwardingBodySelect");
    var awardingBody = a.options[a.selectedIndex].value;
    if (awardingBody == "ALLBODIES") {
        awardingBody = "";
    }
    var levelGroup = document.getElementsByName("LevelGroup");
    var chosenLevel = ""
    for (var g = 0; g < levelGroup.length; g++) {
        if (levelGroup[g].checked) {
            chosenLevel += levelGroup[g].value + " ";
        }
    }
    if (chosenLevel == undefined) {
        var chosenLevel = "";
    } else {
        var splitLevel = chosenLevel.split(" ");
        var levelA = splitLevel[0];
        var levelB = splitLevel[1];
        var levelC = splitLevel[2];
        var levelD = splitLevel[3];
        if (levelA == "") {
            levelA = "NOLVL"
        }
        if (levelB == "") {
            levelB = "NOLVL"
        }
        if (levelC == "") {
            levelC = "NOLVL"
        }
        if (levelD == "") {
            levelD = "NOLVL"
        }
    }
    var fil = document.getElementsByName("QList");
    for (var i = 0; i < fil.length; i++) {
        fil.item(i).style.display = "none";
        if ((hasBody(fil.item(i), awardingBody) == true || awardingBody == "") && (hasPath(fil.item(i), pathway) == true || pathway == "") && ((hasLevel(fil.item(i), levelA) == true || hasLevel(fil.item(i), levelB) == true || hasLevel(fil.item(i), levelC) == true || hasLevel(fil.item(i), levelD) == true) || chosenLevel == "")) {
            fil.item(i).style.display = "block";
        }
    }
}
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T17:02:34.060

检查你的分号。IE 在这类东西上比 FF 严格得多。

# c++ - C ++中的矩阵类？

> ID：10250158
> 
> 赞同：1
> 
> 时间：2012-04-20T16:40:06.830
> 
> 标签：c++, matrix

我一直在尝试编写一个 Matrix 类，并且正在使用 main 方法对其进行测试。它不工作......根本。

我不明白为什么大小（allRowValues 的大小除以 double 的大小）为零！

我一直在写一些调试打印，但它没有帮助......我真的，真的是 C++ 的新手，所以任何和所有的帮助/建议都将不胜感激。

```
 1 #include "matrix.h"
 2 #include <iostream>
 3 #include <sstream>
 4 
 5 Matrix::Matrix(){
 6 };
 7 
 8 Matrix::Matrix(int rows, int columns, double allRowValues [] ){
 9     this->rows = rows;
10     this->columns = columns;
11     this->matrixValues = new double[rows*columns];
13     std::cout <<"ALL ROW VALUES" <<std::endl;
14     std::cout<<"*****" <<std::endl;
15     std::cout << sizeof (allRowValues) << std::endl;
16     std::cout<<"*****" <<std::endl;
17     std::cout << sizeof(allRowValues[0]) << std::endl;
18     std::cout<<"*****" <<std::endl;
19     int size = sizeof(allRowValues)/sizeof(double);
20     int numberOfValues = rows * columns;
21     int currentIndex = 0;
22     for (int i = 0; i < numberOfValues; i++){
23             std::cout<< "MATRIX CONSTRUCTOR\n";
24             std::cout<<allRowValues <<std::endl;
25             std::cout<<"-----"<<std::endl;
26             std::cout<<index << std::endl;
27             std::cout<<"-----"<<std::endl;
28             std::cout<<size << std::endl;
29             std::cout<<"-----"<<std::endl;
30             if ((allRowValues) && (currentIndex < size)){
31                 std::cout << "ARV " <<std::endl;
32                 std::cout << allRowValues[currentIndex] << std::endl;
33                 this->matrixValues[i]= allRowValues[currentIndex];
34                 std::cout << "MAT " << allRowValues[currentIndex++] << std::endl;
35             }else{
36                 std::cout << "Else\n";
37             }
38         }
39         int index=0;
40         for (int j = 0; j < rows; j++){
41             for (int i = 0; i < columns; i++){
42                 std::cout << this->matrixValues[index++];
43             }
44             std::cout<<std::endl;
45         }
46     };
47 
48     Matrix::Matrix(double* rowValues){
49         int sizeRows = sizeof(rowValues)/sizeof(double);
50         //TODO: throw error for all rows must be the same length
51         this->rows = sizeRows;
52         int sizeColumns = sizeof(rowValues[0])/sizeof(double);
53         this->columns = sizeColumns;
54         this->matrixValues = rowValues;
55     };
56 
57     double Matrix::width(){
58         std::cout << "Width\n";
59         return this->columns;
60     };
61 
62     double Matrix::height(){
63         std::cout << "Height\n";
64         return this->rows;
65     };
66 
67     std::string Matrix::toString(){
68         int numberOfValues = 0;
69         std::cout<<matrixValues[numberOfValues];
70         std::string build_output;
71         std::cout<<matrixValues;
72         for (int i = 0; i < rows; i++){
73             build_output = "[";
74             std::cout << "\n";
75             for (int j = 0; j < columns; j++){
76                 std::cout << "VALUE: " <<matrixValues[numberOfValues];
77                 build_output = matrixValues[numberOfValues];
78                 numberOfValues++;
79             }
80             build_output = " ]";
81         }
82         return build_output;
83     }
84 
85     int main (){
86         double values[6] = {1, 2, 3, 4, 5, 6};
87         std::cout <<"Values: \n";
88         Matrix a = Matrix(2, 3, values);
89         std::cout << a.width() << std::endl;
90         std::cout << a.height() << std::endl;
91         std::cout << a.toString();
92         return 1;
93 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T16:42:51.283

`double allRowValues[]`声明一个指针，而不是一个数组。然后，该表达式`sizeof(allRowValues)/sizeof(double)`计算指针大小与 a 大小之间的比率`double`。如果双打更大，结果显然为零。

出于某种原因，同样的错误也发生在另一个构造函数中（`sizeof(rowValues)/sizeof(double)`），但这次参数显然是一个指针。然后`sizeof(rowValues[0])/sizeof(double)`是双精度数组的一个元素的大小（即双精度数）与双精度数的大小（显然是一）之间的比率。

似乎有这样一种信念，即在`sizeof`给定指向第一个元素的指针的情况下，运算符可以神奇地知道数组的大小。它不能。或者数组和指针之间可能存在混淆。他们[不一样](https://stackoverflow.com/questions/1641957/is-array-name-a-pointer-in-c)。

大多数情况下，数组（即类型`T[N]`为 like的对象`double[100]`）只是衰减为指向其第一个元素（即`T*`like `double*`）的指针，在此过程中会丢失大小信息。这就是为什么如果你打算“传递一个数组”，你永远不能只传递一个指针。您需要以某种方式传递尺寸信息。

您可以将大小作为额外参数显式传递，或者传递另一个标记缓冲区结束的指针（迭代器样式）。您还可以传递对数组的引用（这可以防止衰减为指针，从而保留大小信息）并使用模板来获取大小信息。

```
template <std::size_t N, std::size_t M>
void pass_a_2d_array_by_reference(double(&the_array)[N][M]) { // N and M are the sizes
    // do stuff
} 
```

* * *

既然您了解了这些问题，那么如果您使用现成的解决方案，就根本无法拥有它们：

*   `std::vector<std::vector<double>>`: 如果您不需要连续存储，这是一个非常好的解决方案。如果您想要锯齿状阵列，这也是您的最佳选择。
*   `boost::multiarray<double, 2>`：另一个非常好的解决方案，它同样适用于更多维度的数组；
*   还有许多其他现有的解决方案，以满足各种需求。只是环顾四周。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T17:07:19.333

如果您坚持使用 c 样式数组（我不推荐），您还可以使用模板化解决方案：

```
template<int size>
Matrix::Matrix(int rows, int columns, double (&allRowValues) [size] ){
...
} 
```

总的来说，我推荐一个现成的、宽松的开源矩阵库，例如[eigen](http://eigen.tuxfamily.org/index.php?title=Main_Page)。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-20T16:46:55.590

您应该使用`std::vector<double>&`(或 std::array) 而不是 c-style array `double allRowValues[]`。因此，您可以轻松地使用`allRowValues.size()`.

c++ faq-lite：[为什么我应该使用容器类而不是简单的数组？](http://www.parashift.com/c++-faq-lite/containers.html#faq-34.1)

参考： http:
[//en.cppreference.com/w/cpp/container/vector](http://en.cppreference.com/w/cpp/container/vector)
[http://en.cppreference.com/w/cpp/container/array](http://en.cppreference.com/w/cpp/container/array)

# c# - Windsor 中用于 MVC3 框架中共享 REST 资源的自定义范围？

> ID：10250165
> 
> 赞同：0
> 
> 时间：2012-04-20T16:40:20.123
> 
> 标签：c#, asp.net-mvc-3, inversion-of-control, castle-windsor

现在我的 ThingController 的方法都带有一个标识资源的 id 参数，即 URL 是 /{controller}/{action}/{id}。所以当然*每个*方法做的第一件事就是 var thing = thingFactory.Get(id)。现在，Thing 是一个实时的、线程安全的运行时对象，可在多个用户和会话之间共享。

所以我想要做的是让 DI 框架使用 id 从自定义范围（“生活方式？”）中获取事物并将其注入到每个请求的控制器中。如果该 id 尚不存在任何事物，它还应该创建一个新事物。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T23:21:35.973

如果您尝试将事物注入控制器以删除所有方法中的“var thing = thingFactory.Get(id)”行，则可以使用 ASP.NET MVC 自定义模型绑定器在开始之前执行检索你的方法代码。

如果您的路线看起来像： /{controller}/{action}/{id} ，那么您将让 id 查找您的值。

模型绑定将允许您的方法签名如下所示：

```
public ActionResult SomeDetails(int id, Thing thing)
{ 
```

模型绑定和验证在方法代码执行*之前触发。*DefaultModelBinder 只会从 FormCollection 或其他非持久源填充您的类。

我推荐的技巧是为执行查找的 Thing 类提供自定义模型绑定器 (IModelBinder)。从 DefaultModelBinder 派生，注入您的 IThingFactory，并覆盖 BindModel() 以按照您的方式进行查找。

```
public class ThingModelBinder : DefaultModelBinder
{
    IThingFactory ThingFactory;

    public ThingModelBinder(IThingFactory thingFactory)
    {
        this.IThingFactory = thingFactory;
    }

    protected override object CreateModel(ControllerContext controllerContext, ModelBindingContext bindingContext, Type modelType)
    {
        Thing thing = new Thing();

        string id_string = controllerContext.RouteData.Values["id"].ToString();
        int id = 0;
        Int32.TryParse(id_string, out id);
        var thing = thingFactory.Get(id);

        return thing;
    }

    public override object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)
    {
        if (bindingContext == null)
        {
            throw new ArgumentNullException("bindingContext");
        }

        // custom section
        object model = this.CreateModel(controllerContext, bindingContext, typeof(Thing));

        // set back to ModelBindingContext
        bindingContext.ModelMetadata.Model = model;

        // call base class version
        // this will use the overridden version of CreateModel() which calls the Repository
        // object model = BindComplexModel(controllerContext, bindingContext);

        return base.BindModel(controllerContext, bindingContext);

    } 
```

然后，您将在 global.asax Application_Start() 中配置模型绑定器，您已经在其中创建了容器：

```
 // Custom Model Binders
    System.Web.Mvc.ModelBinders.Binders.Add(
        typeof(MyCompany.Thing)
        , new MyMvcApplication.ModelBinders.ThingModelBinder(
            WindsorContainer.Resolve<IThingFactory>()
            )
        ); 
```

这将导致您的自定义模型绑定器被调用。

您以正常方式解决 Windsor 依赖项。

这是基于[我做的一个帖子](http://enehana.nohea.com/general/asp-net-mvc-custom-model-binder-safe-updates-for-unspecified-fields/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-23T17:48:39.610

如果我对你的理解正确，你有一些固定数量`Things`的容器注册了，你想要一个工厂返回给定 ID 的东西，这样如果你说两次你每次`Get(1)`都会得到相同的东西，如果你说你会得到不一样的东西。`Thing``Get(2)`

实现这一目标的一种方法是使用[Typed Factory Facility](http://docs.castleproject.org/Windsor.Typed-Factory-Facility-interface-based-factories.ashx)，如下所示：

```
// This is the thing factory - it will create the thing if it has not already 
// been created with the given ID - if it is already created it will return 
// that instance
public interface IThingFactory
{
    Thing Get(int id);
}

// This is the thing - it has an ID and a method that you
// can call that keeps track of how many times it has been
// called (so you can be sure it is the same instance)
public class Thing
{
    private int _count;

    public Thing(int id)
    {
        Id = id;
    }

    public int Id { get; private set; }

    public int HowManyCalls()
    {
        return Interlocked.Increment(ref _count);
    }
}

// This is a typed factory selector to manage selecting the component from
// the container by using the name ("Thing" followed by the ID)
public class GetThingComponentSelector : ITypedFactoryComponentSelector
{
    public TypedFactoryComponent SelectComponent(MethodInfo method, 
                                                 Type type, 
                                                 object[] arguments)
    {
        return new TypedFactoryComponent("Thing" + arguments[0],
                                         typeof(Thing),
                                         new Arguments(arguments));
    }
}

// .... In the installer ....

// Register each thing with a different name that matches the ID
// and register a custom component selector and the thing factory
container
    .AddFacility<TypedFactoryFacility>()
    .Register(
        Component
            .For<Thing>()
            .Named("Thing1"),
        Component
            .For<Thing>()
            .Named("Thing2"),
        Component
            .For<GetThingComponentSelector>(),
        Component
            .For<IThingFactory>()
            .AsFactory(c => c.SelectedWith<GetThingComponentSelector>()));

// ... Some demo code (you do not need to resolve the factory directly)

// Now resolve the same thing twice and then a different thing and make sure
// Windsor has handled the lifestyle
var thing = container.Resolve<IThingFactory>().Get(1);
Console.WriteLine("ID should be 1 and is " + thing.Id 
    + ". Calls should be 1 and is " + thing.HowManyCalls());

thing = container.Resolve<IThingFactory>().Get(1);
Console.WriteLine("ID should be 1 and is " + thing.Id 
    + ". Calls should be 2 and is " + thing.HowManyCalls());

thing = container.Resolve<IThingFactory>().Get(2);
Console.WriteLine("ID should be 2 and is " + thing.Id 
    + ". Calls should be 1 and is " + thing.HowManyCalls()); 
```

在那里，您会看到我使用 ID 作为容器中的“名称”，然后使用自定义选择器查找名称。可能还有其他方法可以做到这一点，但我认为，根据你的问题，这至少应该让你开始。

# asp.net-mvc - MVC4 - 一个表单 2 提交按钮

> ID：10250167
> 
> 赞同：10
> 
> 时间：2012-04-20T16:40:25.193
> 
> 标签：asp.net-mvc, forms, submit

我按照这篇文章的说明进行操作： [Asp.net mvc3 razor with multiple submit buttons](https://stackoverflow.com/questions/5702549/asp-net-mvc3-razor-with-multiple-submit-buttons) ，这是我的模型：

```
public class AdminModel
{
  public string Command { get; set; }
} 
```

我的控制器

```
[HttpPost]
public ActionResult Admin(List<AdminModel> model)
{
   string s = model.Command;
} 
```

我的观点

```
@using (Html.BeginForm("Admin", "Account"))
{
  <input type="submit" name="Command" value="Deactivate"/>
  <input type="submit" name="Command" value="Delete"/>
} 
```

当我回帖时，字符串“s”始终为空。

我还在这个论坛帖子中尝试了第二个答案（获得 146 票的那个）：[How do you handle multiple submit buttons in ASP.NET MVC Framework？](https://stackoverflow.com/questions/442704/how-do-you-handle-multiple-submit-buttons-in-asp-net-mvc-framework)那也是空的。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-04-20T16:48:35.010

您需要通过按钮名称从他们的服务器端获取值，

```
public ActionResult Admin(List<AdminModel> model,string Command)
{
   string s = Command;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:46:45.023

从我在发布的代码中可以看到，您不会将模型列表发送到控制器，而只是发送一个模型实例。尝试将控制器修改为：

```
[HttpPost]
public ActionResult Admin(AdminModel model)
{
   string s = model.Command;
} 
```

# ruby-on-rails - 我如何找出在 Rails 中呈现某个文件扩展名的人？

> ID：10250175
> 
> 赞同：0
> 
> 时间：2012-04-20T16:40:44.637
> 
> 标签：ruby-on-rails, activeadmin

我想覆盖一些 activeadmin 视图，我偶然发现了一些带有`.arb`扩展名的文件，我不知道要在其中编写什么样的代码（看起来像普通的 Ruby，但我不确定）。我怎样才能找出是什么呈现了某种扩展？

我试图搜索这个，但不幸的是我找不到任何相关的结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T02:09:52.723

文件扩展名转到嵌入在 Active Admin 中的 Arbre。唯一的文档是代码。作者已表示他打算将其变成宝石。他已经启动了一个 gem（版本 0.0.1），但那里也没有文档。

[https://github.com/gregbell/active_admin/tree/master/lib/active_admin/arbre/html](https://github.com/gregbell/active_admin/tree/master/lib/active_admin/arbre/html)

[http://rubydoc.info/gems/arbre/0.0.1/frames](http://rubydoc.info/gems/arbre/0.0.1/frames)

请注意，“令牌”被定义为 AUTO_BUILD_ELEMENTS。

```
:a, :abbr, :address, :area, :article, :aside, :audio, :b, :base,
:bdo, :blockquote, :body, :br, :button, :canvas, :caption, :cite,
:code, :col, :colgroup, :command, :datalist, :dd, :del, :details,
:dfn, :div, :dl, :dt, :em, :embed, :fieldset, :figcaption, :figure,
:footer, :form, :h1, :h2, :h3, :h4, :h5, :h6, :head, :header, :hgroup, 
:hr, :html, :i, :iframe, :img, :input, :ins, :keygen, :kbd, :label, 
:legend, :li, :link, :map, :mark, :menu, :meta, :meter, :nav, :noscript, 
:object, :ol, :optgroup, :option, :output, :pre, :progress, :q,
:s, :samp, :script, :section, :select, :small, :source, :span,
:strong, :style, :sub, :summary, :sup, :table, :tbody, :td,
:textarea, :tfoot, :th, :thead, :time, :title, :tr, :ul, :var, :video 
```

# spring - SimpleMappingExceptionResolver 与 ExceptionFilter

> ID：10250177
> 
> 赞同：0
> 
> 时间：2012-04-20T16:40:53.047
> 
> 标签：spring, exception-handling, servlet-filters

目前我正在开发一个使用自定义 Servlet 过滤器来捕获所有异常的应用程序：

```
 <filter-mapping>
    <filter-name>ExceptionFilter</filter-name>
    <url-pattern>/*</url-pattern>
  </filter-mapping> 
```

和

```
public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {

try {
    chain.doFilter(request, response);
} catch (Throwable t) {
        if (request instanceof HttpServletRequest) {
            log.error(((HttpServletRequest) request).getRequestURL());
        }
        log.error("Exception:", t);
        String path = "/error.do";
        request.getRequestDispatcher(path).forward(request, response);
}
} 
```

在调查了一段时间后，我发现 SimpleMappingExceptionResolver 是一种处理异常和视图映射的简单方法，并且正如我所见，我不能同时使用这两种方法，但我看不出有任何理由比另一种方法更喜欢一种方法。

我知道使用解析器将不同的错误映射到不同的视图更容易，但我们只使用一个错误视图，所以我更关心这两种解决方案的性能，如果其中一个能够处理更广泛的异常和这样的事情。

在此先感谢各位 Spring 专家

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T19:06:54.247

老实说：在 Java 中可以做的最昂贵（就性能而言）的事情之一中抛出异常。（*不要误会我的意思，这不是反对使用异常的声明。*）。但是，如果您因为需要使用其中一个过滤器处理大量异常而严重遇到性能问题，那么您肯定会遇到另一个非常严重的问题。

因此，您不应该过多考虑过滤器或解析器的运行时性能。在更少的代码、更易理解的代码、更少的错误等方面多考虑哪一个更适合您的项目。

# ruby - capybara - 使用 xPath 查找正在离开范围内

> ID：10250181
> 
> 赞同：14
> 
> 时间：2012-04-20T16:41:01.063
> 
> 标签：ruby, ruby-on-rails-3, cucumber, capybara, ruby-1.9.2

我正在尝试使用默认的 Rails 日期、时间和日期时间字段使用 Capybara 构建日期选择器。我正在使用该`within`方法来查找字段的选择框，但是当我使用 xPath 查找正确的框时，它会离开`within`范围并在元素页面上找到第一个匹配项。

这是我正在使用的代码。我正在测试的页面有 2 个日期时间字段，但由于此错误，我只能更改第一个字段。目前我有一个带有 id 的 div 容器，它包含了 datetime 字段，但我确实计划切换代码以按标签查找。

```
module  Marketron
  module DateTime

    def select_date(field, options = {})
      date_parse = Date.parse(options[:with])

      year = date_parse.year.to_s
      month = date_parse.strftime('%B')
      day = date_parse.day.to_s

      within("div##{field}") do
        find(:xpath, "//select[contains(@id, \"_#{FIELDS[:year]}\")]").select(year)
        find(:xpath, "//select[contains(@id, \"_#{FIELDS[:month]}\")]").select(month)
        find(:xpath, "//select[contains(@id, \"_#{FIELDS[:day]}\")]").select(day)
      end

    end

    def select_time(field, options = {})
      require "time"
      time_parse = Time.parse(options[:with])

      hour = time_parse.hour.to_s.rjust(2, '0')
      minute = time_parse.min.to_s.rjust(2, '0')

      within("div##{field}") do
        find(:xpath, "//select[contains(@id, \"_#{FIELDS[:hour]}\")]").find(:xpath, "option[contains(@value, '#{hour}')]").select_option
        find(:xpath, "//select[contains(@id, \"_#{FIELDS[:minute]}\")]").find(:xpath, "option[contains(@value, '#{minute}')]").select_option

      end

    end

    def select_datetime(field, options = {})
      select_date(field, options)
      select_time(field, options)
    end

    private

      FIELDS = {year: "1i", month: "2i", day: "3i", hour: "4i", minute: "5i"}

  end
end

World(Marketron::DateTime) 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-04-21T12:22:56.243

您应该在 xpath 中通过在开头添加 a`.`来指定要从当前节点开始：

```
find(:xpath, ".//select[contains(@id, \"_#{FIELDS[:year]}\")]") 
```

**例子：**

我测试了一个 HTML 页面（希望不要过度简化你的页面）：

```
<html>
    <div id='div1'>
        <span class='container'>    
            <span id='field_01'>field 1</span>
        </span>
    </div>
    <div id='div2'>
        <span class='container'>
            <span id='field_02'>field 2</span>
        </span>
    </div>  
</html> 
```

使用 inside 方法，您可以在执行此操作时看到您的问题：

```
within("div#div1"){ puts find(:xpath, "//span[contains(@id, \"field\")]").text }
#=> field 1
within("div#div2"){ puts find(:xpath, "//span[contains(@id, \"field\")]").text }
#=> field 1 
```

但是您可以看到，但是指定要在当前节点内查看的 xpath（即使用`.`），您会得到所需的结果：

```
within("div#div1"){ puts find(:xpath, ".//span[contains(@id, \"field\")]").text }
#=> field 1
within("div#div2"){ puts find(:xpath, ".//span[contains(@id, \"field\")]").text }
#=> field 2 
```

# c++ - Boost heap 设置用户定义的比较函数

> ID：10250184
> 
> 赞同：2
> 
> 时间：2012-04-20T16:41:20.347
> 
> 标签：c++, boost, heap

最近，我发现 Boost.Heap 在我的项目中非常有用。但是我找不到任何示例代码来显示如何设置任意比较功能。

```
#include "boost/heap/fibonacci_heap.hpp"

using boost::heap::fibonacci_heap;
int main(){
    fibonacci_heap<int> pq; //default compare function std::less<int>
} 
```

例如，如何设置 std::greater< int >？

boost.heap 文档说可以通过设置一个选项来设置。但我不知道这意味着什么。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T20:41:15.837

试试这个：

```
typedef boost::heap::fibonacci_heap<
        int,
        boost::heap::compare<std::greater<int> > > MyHeap; 
```

该文档没有显示如何指定选项。我不得不深入研究单元测试源代码以找出正确的使用语法。

# java - 如何找出另一个线程是否正在等待（）？

> ID：10250193
> 
> 赞同：1
> 
> 时间：2012-04-20T16:41:53.440
> 
> 标签：java

我注意到没有 isWaiting() 方法。是否可以测试是否有任何线程在特定对象上被阻塞 wait() ？给定一个 Thread 对象，是否有可能找到该 Thread 正在等待（）的对象（如果有）？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-20T16:44:30.333

好吧，对于等待状态试试`thread.getState() == Thread.State.WAITING || thread.getState() == TIMED_WAITING`。

至于线程等待的对象，我不确定，但我怀疑您是否可以在没有本机代码的情况下获得线程正在等待的对象。反过来，也就是获取持有给定对象锁的线程，对于纯 Java 似乎也是不可能的（参见此处：以[编程方式确定哪个 Java 线程持有锁](https://stackoverflow.com/questions/50561/programmatically-determine-which-java-thread-holds-a-lock)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T17:10:39.250

基本的并发方法可能无法满足您的需求。您可能想尝试 java.util.concurrent 包。可以解决您的问题的示例类之一是[ReentrantLock](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/locks/ReentrantLock.html)。这是关于线程的完整[教程。](http://docs.oracle.com/javase/tutorial/essential/concurrency/)

# emacs - CEDET：手动存储标签

> ID：10250195
> 
> 赞同：5
> 
> 时间：2012-04-20T16:42:24.313
> 
> 标签：emacs, cedet, emacs-ecb

我将 ECB 与 Cedet 一起使用 - 语义搜索引擎将有关我访问的文件的标签存储在其缓存文件中。

我也在使用 ECB 的`left-symboldef`布局——它显示了光标所在标签的定义。为了做到这一点，语义打开了定义标签的文件。

问题是 - 语义几乎一直打开我所有的 python 脚本 - 因为我已经`parser`在所有这些脚本中定义 - 当我解析命令行参数时`argparse`......所以我宁愿自动停止语义缓存我的文件，然后去做`C-c , ,`仅在我的库上手动使用。

所以我的问题是——如何防止语义存储缓存？我应该仍然可以使用现有的数据库（我将手动收集）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-24T23:12:05.840

为了防止在空闲时间自动解析其他文件，可以设置：

```
(setq semantic-idle-work-parse-neighboring-files-flag nil) 
```

如果它通过包含将它们拉入，你可以这样做：

```
(setq semantic-idle-work-update-headers-flag nil) 
```

这实际上是默认设置，如果您使用常规或花哨的代码助手的固定配置选项之一，它会设置为 true。

为了不解析所有文件，但仍让 ECB 查找标签定义，您可能需要使用 GNU Global 数据库。查看`semanticdb-enable-gnu-global-databases`更多。

# algorithm - 求 N^2 个元素的中位数（大尺度）

> ID：10250202
> 
> 赞同：-2
> 
> 时间：2012-04-20T16:43:06.923
> 
> 标签：algorithm, median, large-scale

问题是这样的：假设我们有 N 台机器，并且每台机器存储并可以操作它的 N 个元素，那么，我们如何以最低的成本找到所有 N^2 个元素的中位数？

真的很困扰，希望得到大家的解答，谢谢！

对不起，我写得太简单了。每台机器中存储的元素是随机的，没有顺序。而成本包含I/O成本，以及机器之间的通信、RAM、时间等一切都应该考虑在内。我只想找到获得中位数的最有效方法。

这些是我提出的一些解决方案：

1.  使用外部排序，如合并排序或其他方法，并找到中位数。
2.  使用桶排序，将所有元素按照其值分成X个连续的桶，这样我们就可以决定中位数在哪个桶中。扫描桶，我们将得到中位数。
3.  我认为在“算法简介”中的 O(N) 算法中找到第 k 个数应该在这里工作吗？

但是，所有这些解决方案仍然需要一台额外的机器来完成这项工作。我想知道是否有一种方法可以只使用这 N 台机器来获得中位数？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T18:33:25.167

Can you estimate it rather than get it exactly?

If so, pick a constant K and fit a K-coefficient polynomial to the data on each machine, send the coefficients to a central machine that adds them and then finds the median by

1.  Integrating the curve over the range to find the area under the curve
2.  Doing a root-finding algorithm to find the point that splits the area in half.

The bigger K is, the less error there will be. The smaller K is, the more efficient it will be.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:49:20.600

您需要有一个计算所有值（所有商店的总数）的过程。选择中间索引。将索引调整为与相应机器上项目开头的偏移量。要求该机器对项目进行排序并返回该索引的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T17:13:24.723

```
Step 1: Sort the numbers at each machine individually
Step 2: Send the median at each machine to a central place
Step 3: Sort the medians and send it to each machine
Step 4: For each element in the sorted medians calculate the rank at machine level
Step 5: Calculate the rank of each element over all machines (just sum the rank)
Step 6: Find two elements in the sorted medians between which the global median exists
Step 7: For the next iteration consider only elements between those two medians 
        and repeat the whole thing again 
```

在最坏的情况下，第二次迭代中的所有剩余元素都将位于一台机器上。

复杂性：很确定它是 O(nlogn) （即包括颚化它可以是 O(n^2logn)

# php - strtotime（'上个月的第一天'）的版本差异？

> ID：10250208
> 
> 赞同：9
> 
> 时间：2012-04-20T16:43:32.677
> 
> 标签：php, date

在包含

```
date('Y-m-d', strtotime('first day of last month')) 
```

在版本 5.3.10 (localhost) 中，例如，我得到“2012-03-01”。

在 5.2.17 版（远程主机）中，我得到“1969-12-31”。

是否有一个表达式将返回两个版本的预期结果（例如，'2012-03-01'）？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-20T16:49:16.163

您应该使用[mktime()](http://us3.php.net/manual/en/function.mktime.php)函数：

```
<?php 
echo date('Y-m-d', mktime(0,0,0,date('n')-1,1,date('Y'))); //2012-03-01
?> 
```

`**[See In Action](http://codepad.org/wSrLhb2N)**`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-03-20T16:42:00.087

```
date('Y-m-d', strtotime('first day of -1 month')) 
```

在 PHP 7.0 上运行良好

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T16:45:47.273

这是PHP 5.2.17 中的一个[已知错误](https://bugs.php.net/bug.php?id=53778)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-02-28T17:57:59.100

很简单：

```
date('Y-m-01') 
```

任何一个月的第一天总是 1。

# android - ListView上的Android查询where子句

> ID：10250211
> 
> 赞同：1
> 
> 时间：2012-04-20T16:43:36.977
> 
> 标签：android, cursor, android-listview, contextmenu

我创建了`ListView`a `CursorAdapter`，由我的数据库表填充。在我`ContextMenu`通过长按`ListView`我的表中所需的选择信息行添加了一个之后。

问题是：我无法收集那一行的信息`ListView`，每一行都给我相同的结果。我想我在查询中做错了什么。

`onCreate`：

```
private void createTabRegistry(SQLiteDatabase db)
    {
        String sql = "CREATE TABLE {0} ({1} INTEGER PRIMARY KEY AUTOINCREMENT, {2} TEXT,{3} INTEGER,{4} TEXT,{5} TEXT,{6} TEXT, {7} TEXT);";
            db.execSQL(MessageFormat.format(sql, TabRegistry.TABLE_NAME, TabRegistry._ID,TabRegistry.TYPE, TabRegistry.DATE, TabRegistry.STATUS, TabRegistry.NUMBER, TabRegistry.MESSAGE, TabRegistry.OTHER));
    } 
```

我在 db 类中的查询：

```
public Cursor getRegistry2(long id) {
        return (getReadableDatabase().query(
            TabRegistry.TABLE_NAME, 
            TabRegistry.COLUMNS,
            TabRegistry._ID + " = " + id,
            null,
            null,
            null, 
            null, 
            null));
    } 
```

`ContextMenu`在我的活动中的id ：

```
 AdapterView.AdapterContextMenuInfo info= (AdapterView.AdapterContextMenuInfo) item.getMenuInfo();
 id = getListAdapter().getItemId(info.position); 
```

我在活动课上的光标：

```
Cursor c3 = databaseHelper.getRegistry2(id);
if (c3 != null) {
        c3.moveToFirst();
    }                     

dbnumber = (c3.getString(c3.getColumnIndex(TabRegistry.NUMBER))); 
```

如何将那个奇迹`dbnumber`线的值分配给字符串？`ListView`

编辑有效的代码，但重置列表视图的视图....

```
Cursor c3 = (Cursor) getListAdapter().getItem(info.position);
                        startManagingCursor(c3);
                          aaaaa = c3.getString(c3.getColumnIndex(TabRegistry.NUMBER));
                         c3.close(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T16:52:01.097

`AdapterView.AdapterContextMenuInfo`有一个名为的字段`id`，表示该选定行的数据库中的行 ID。您需要查询该 id 而不是`position`表示列表中位置的字段：

```
rowId = info.id; 
```

然后查询您的数据库`rowId`以获取该项目的数据。

**编辑：**

您可能不想使用您添加的解决方案。您关闭游标，因此没有更多数据（这就是您必须重新启动活动的原因，因为您可能仅在`onCreate`方法中查询数据库）。

`info.id`我告诉过您，当您使用长按（显示）列表中的不同行时，检查是否返回不同的值`ContextMenu`，这意味着`ContextMenu`（可能）为不同的行选择不同的行 ID）。

我不知道是什么导致了你的问题（如果删除有效，我会说活动中有一些东西），所以我做了一个小例子来说明你正在尝试做什么，这样你就可以看到这种类型的代码：

[http://pastebin.com/Yri03S0T](http://pastebin.com/Yri03S0T)

# java - 如何打印到文件？

> ID：10250214
> 
> 赞同：2
> 
> 时间：2012-04-20T16:43:59.707
> 
> 标签：java

我正在完成一项任务并且遇到了一些障碍。

我的程序将输出打印到屏幕上，（不是我需要的），但只打印文件的第一个条目。下面是代码片段。该文件似乎正在从输入文件中读取数据，但循环不会在第一个条目之后输出到文件。

```
Scanner in = new Scanner(System.in);    //Scanner object to read input from the file
System.out.println("Enter filename to read ");  //file name prompt  
String inputFileName = in.nextLine();                //line input reads next line

/*
 * TODO 2) Use an unbuffered file input stream to open listings.txt file
 * and read in property listings.
 */
Scanner reader = null;
try {
    reader = new Scanner(new File(inputFileName));
} catch (FileNotFoundException e) {

    System.out.println("Try Again");   //error window if name is null
    JOptionPane.showMessageDialog(null, "You must enter a filename", "File input error", JOptionPane.ERROR_MESSAGE);
    return;

}

PrintWriter out = new PrintWriter("agentreport.txt"); //This method prints out the file readfile.txt a word at a time
while (reader.hasNextLine()) {                      //It needs to output to the text file. Currently a file is created, but it is empty?
    Scanner s2 = new Scanner(reader.next());

    @SuppressWarnings("unused")
    boolean b;
    while (b = s2.hasNext()) {
        String output = s2.next();
        String output2 = output.toUpperCase(); //converts output to upper case
        System.out.println(output2);
        out.print(output2);  //only printing the first entry to the agentsreport.txt file. Not stepping thru the file for some reason? 
   } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T16:48:56.857

即使您正在使用自动刷新（在这种情况下不是这样）， PrintWriter 对象也会在其内部缓冲区中输出任何内容，除非您执行以下两项操作之一：

1) 使用`println()`, `printf()`, 或`format()`to 方法

`flush()`2）每次打印时调用该方法，这样内部缓冲区中的所有数据都会被写出。

注意：该`print()`方法不会*导致*PrintWriter 对象到`flush()`它的缓冲区。

`flush()`在你打电话后尝试添加一个电话`print()`

**split() 示例**

```
PrintWriter out = new PrintWriter("agentreport.txt"); 
while (reader.hasNextLine()) {                    
    String words = reader.nextLine().split();

    @SuppressWarnings("unused")
    boolean b;
    for(String word : words) {
        String output = word ;
        String output2 = output.toUpperCase(); //converts output to upper case
        System.out.println(output2);
        out.print(output2);  
   } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:49:09.740

尝试

```
out.println(output2); 
```

[http://docs.oracle.com/javase/6/docs/api/java/io/PrintWriter.html](http://docs.oracle.com/javase/6/docs/api/java/io/PrintWriter.html)

当导入 system.out 以使用简码“out.println()”时，我也会使用“out”以外的 var，这可能会导致变量混淆

编辑：好点@Hunter McMillen，更改为 println，因为 append 用于 CharSequence。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T16:56:40.413

立即跳出来的一件事是您没有正确处理您的资源。

任何时候你使用一个 IO 资源，比如读卡器/数据库连接等，你应该总是使用 finally 块关闭它，使用这种模式：

```
Reader reader = /* construct it however */
try {
    /* do something with the reader */
}
finally {
    reader.close();
} 
```

如果您不这样做，则无法保证阅读器实际上会被关闭，并且您的应用程序将泄漏文件描述符/连接池连接/等，直到最终它无法再获取任何内容并且您的应用程序崩溃。（这并不*总是*会产生致命的后果，但这是一个非常简单的模式，您应该每次都使用它，直到它变成自动的）。

在这种情况下，您根本没有关闭您的编写器**，**这意味着它不能保证它实际上会将其输出*刷新*到文件中。完全按照`Writer`接口写任何东西或什么都不写 - 没有刷新，你无法保证。请注意，关闭编写器将自动调用刷新，因此这是您完成后最好的选择。

所以你的代码的后半部分应该是这样的：

```
PrintWriter out = new PrintWriter("agentreport.txt");
try {
    // Existing code here
}
finally {
    // This closes the file and frees the descriptor, but also flushes the buffers
    out.close();
} 
```

另外，你是如何处理`IOException`读写可能抛出的 s 的？您是否在某个地方抓住它们并吞下它们？如果是这样，你的代码可能会抛出一个异常，告诉你它为什么不能写，而你只是忽略它，然后看起来很困惑。

不要说得太细，错误处理可能是好的软件开发中最重要的部分。在一切正常的情况下编写可以运行的软件并不难。最具挑战性的部分是在硬盘空间不足或网络暂时中断等情况下处理好事情。

在这种情况下，最实用的方法是让异常从`main`方法的顶部抛出。在这种情况下，您的应用程序将“崩溃”，并且您将在控制台上收到一条堆栈跟踪 + 错误消息，这将立即表明出现了问题，并让您很好地了解它是什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T16:57:33.257

```
try ( 
   Scanner reader = new Scanner(new File(inputFileName));
   PrintWriter writer = new PrintWriter(new FileOutputStream("agentreport.txt"), true);
) {

   while (reader.hasNextLine()) {                     
      String output = reader.nextLine().toUpperCase();
      System.out.println(output);
      writer.println(output); 
   }
} catch (FileNotFoundException e) {

   System.out.println("Try Again");   //error window if name is null
   JOptionPane.showMessageDialog(null, "You must enter a filename", "File input error", JOptionPane.ERROR_MESSAGE);

} 
```

# sse2 - 通过 Accelerate 框架添加两个 __m128 类型

> ID：10250216
> 
> 赞同：0
> 
> 时间：2012-04-20T16:44:01.680
> 
> 标签：sse2, accelerate-framework

我需要`__m128`使用 Accelerate 框架添加/mul/sub 两个（浮点）变量。但是，我找不到这样做的功能。所有 Accelerate 框架函数都采用`int__vector__`类型而不是`float__vector__`类型。我找到了除法的功能`'vdivf'`，但我也需要添加/mul/sub。

谁能告诉我，如何`__m128`使用 Accelerate 框架添加/mul/sub 两个（浮点）变量？像这样的东西：`_mm_add_ps`, `_mm_sub_ps`，`_mm_mul_ps`但使用 Accelerate 框架 API。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T07:49:35.987

问题是 Accelerate 是比使用 SSE2 内在函数更高级别的 API。SSE 内在函数映射到一次对一个向量进行操作的单个*指令。*Accelerate 提供了更高级别的函数 API，这些函数以更大的粒度运行，通常具有合理大小的数组。要移植现有代码，您应该坚持使用 SSE 内在函数，如果您确实需要 PowerPC 支持，那么您需要 #idef SSE 代码并为 ppc 构建编写等效的 AltiVec 实现。不过，我怀疑这是否值得付出努力——Apple 大约在 7 年前停止销售 PowerPC Mac，所以现在 PowerPC 应用程序的市场一定非常小。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-22T04:13:49.683

您不需要用于基本算术的 API：

```
__m128 x, y;
__m128 z = x + y;
__m128 w = x - y;
__m128 t = x * y; 
```

这些操作完全不需要 API，因此 Accelerate 没有。

也就是说，如果您有使用 SSE 内在函数（`_mm_add_ps`等）的现有代码，并且您确实在尝试进行“最少的代码更改”，那么您为什么要更改任何内容？SSE 内在函数在 OS X 上也能正常工作。

# mongodb - 在 mongodb 中计算对象数组中的值

> ID：10250217
> 
> 赞同：0
> 
> 时间：2012-04-20T16:44:26.197
> 
> 标签：mongodb, mongodb-java

我正在尝试收集我在 mongodb 的推文集合中拥有的所有主题标签，我想计算每个主题标签在推文中出现的次数。hcoll 是使用此代码创建的主题标签的集合。

```
BasicDBObject key = new BasicDBObject("hashtag",hashtagobj.get("hashtag"));
BasicDBObject update = new BasicDBObject("$addtoSet", new BasicDBObject("tweetsid",hashtagobj.get("_id")));
update.put("$inc",new BasicDBObject("count", 1));
hcoll.update(key,update,true,false); 
```

但是如果对相同的推文第二次执行此代码，那么即使没有第二次将 tweetid 添加到数组中，计数器“count”也会增加。

我正在寻找一种仅在 tweetid 不在数组“tweetsid”中时才增加“count”值的方法。但是我想要一个查询，因为我了解如何使用两个或更多查询来完成它。如果这是不可能的，请告诉我，所以我只需要两个或更多查询就可以了！感谢：D

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T18:52:33.597

一种可能的解决方案是修改查询文档以断言所讨论的 tweetid 尚未在“tweetsid”数组中。如果是，则查询将不匹配，并且不会执行更新。

这是一个使用 JS shell 的示例。没有示例文档很难给出准确的答案，所以我猜测了您的文档结构。希望它足够接近，因此该示例与您相关。

```
> db.hcoll.save({_id:1, hashtag:"myHashTag", count:0, tweetsid:[]})
> db.hcoll.find()
{ "_id" : 1, "hashtag" : "myHashTag", "count" : 0, "tweetsid" : [ ] } 
```

以下更新会将“id1”添加到“tweetsid”数组中，并将“count by 1”的值递增

```
> db.hcoll.update({hashtag:"myHashTag", tweetsid:{$ne:"id1"}}, {$addToSet:{"tweetsid":"id1"}, $inc:{"count":1}})
> db.hcoll.find()
{ "_id" : 1, "count" : 1, "hashtag" : "myHashTag", "tweetsid" : [ "id1" ] } 
```

如果再次执行更新，“count”将不会增加，因为`{tweetsid:{$ne:"id1"}}`查询的部分不匹配。

```
> db.hcoll.update({hashtag:"myHashTag", tweetsid:{$ne:"id1"}}, {$addToSet:{"tweetsid":"id1"}, $inc:{"count":1}})
> db.hcoll.update({hashtag:"myHashTag", tweetsid:{$ne:"id1"}}, {$addToSet:{"tweetsid":"id1"}, $inc:{"count":1}})
> db.hcoll.update({hashtag:"myHashTag", tweetsid:{$ne:"id1"}}, {$addToSet:{"tweetsid":"id1"}, $inc:{"count":1}})
> db.hcoll.find()
{ "_id" : 1, "count" : 1, "hashtag" : "myHashTag", "tweetsid" : [ "id1" ] }
> 
```

我从您的帖子中看到您正在使用 upsert=true 执行更新，这表明如果文档不存在，您希望创建该文档。不幸的是，我提供的更新不适用于 upsert，因为如果新的“tweetsid”值在“tweetsid”数组中，则查询将不匹配，并且 upsert 将创建一个新文档。

```
> db.hcoll.update({hashtag:"myHashTag", tweetsid:{$ne:"id1"}}, {$addToSet:{"tweetsid":"id1"}, $inc:{"count":1}}, true, false)
> db.hcoll.find()
{ "_id" : 1, "count" : 1, "hashtag" : "myHashTag", "tweetsid" : [ "id1" ] }
{ "_id" : ObjectId("4f91ae48f48744310eab90d2"), "count" : 1, "hashtag" : "myHashTag", "tweetsid" : [ "id1" ] }
> 
```

希望以上内容能为您提供一些想法并帮助您找到解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T18:33:19.930

> 但是我想要一个查询，因为我了解如何使用两个或更多查询来完成它。如果这不可能，请告诉我......

这是不可能的。

其实我会更进一步，[这里是 JIRA 票](https://jira.mongodb.org/browse/SERVER-2769)。你可以在 JIRA 那里投票。

# ruby-on-rails - 在视图中构建模板

> ID：10250223
> 
> 赞同：0
> 
> 时间：2012-04-20T16:44:39.507
> 
> 标签：ruby-on-rails, ruby-on-rails-3, erb

在 grails 中，我这样做：

```
<form:windowEntrada domain="serverPool">
    <form:entrada domain="serverLocation" bean="${serverPoolInstance}">
        <form:textField label="serverPool.name" name="name" />
        <form:select label="serverPool.server" name="server" list="${Servers.list()}"/>
    </form:entrada>
</form:windowEntrada> 
```

标签“form:textField”呈现如下内容：

```
<div class='field-name'>
    <div class="title"><label for="name">Name</label>(* required)</div>
    <div class="fieldcontent"><input type="text" name="name" value="smtg"></div>
    <div class="error">If thereis an error on this field, the message appears here</div>
</div> 
```

标签“form:windowEntrada”呈现如下内容：

```
<div class='container'>
    <h1>My title here</h1>
    <div class="content">${body()}</div>
</div> 
```

标签“form:entrada”呈现如下内容：

```
<form action ... >
    <....> --> messages stuff
    ${body()}
    <div class="action-buttons">
        <input type="submit" name="lala">
        <input type="submit" name="lala2">
    </div>
</div> 
```

我如何使用 erb 作为我的视图技术来做 i rails？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T04:34:32.923

我在这里找到了答案：pathfindersoftware.com/2008/07/pretty-blocks-in-rails-views

这是应用本教程的示例：

在 ERB 中：

```
<%= widget("mytitle", {:class => "widget-table"}) do %>
    test test test
<% end %> 
```

在助手中：

```
def widget(title, options = {}, &block)
    options[:params] = params
    options[:controller_name] = controller.controller_name

    body = capture &block

    html = render "shared/form/widget",  :body => body,
                                         :title => title,
                                         :options => options

    return html 
end 
```

和模板_widget.html.erb：

```
<div class="widget <%= options[:class] unless options[:class].blank? %>">
    <% unless title.blank? %>
    <div class="widget-header">
        <span class="icon-layers"></span>
        <h3><%= title %></h3>
    </div>
    <% end %>
    <div class="widget-content">
        <%= body%>
    </div>
</div> 
```

tks

# mysql - 使用脚本将 .csv 文件加载到 MySQL 数据库中

> ID：10250225
> 
> 赞同：2
> 
> 时间：2012-04-20T16:44:40.400
> 
> 标签：mysql, linux, ubuntu, csv

我正在使用 Ubuntu 10.04 LTS 命令行运行 mySQL 5.1.61 脚本，该脚本应该采用 .csv 文件并使用其内容来填充我之前在脚本中创建的表。

这是脚本中的内容（csv 包含三列，名字、姓氏和俱乐部）：

```
-- Import club roster from csv.
-- Create a table to store club data.
CREATE TABLE club_roster (
    first_name VARCHAR(32),
    last_name VARCHAR(32),
    club VARCHAR(32)
) 
```

其次是：

```
-- Put information from csv into table.
LOAD DATA LOCAL INFILE '/complete/path/to/file.csv'
    INTO TABLE club_roster
    FIELDS TERMINATED BY ','
    ENCLOSED BY '"'
    LINES TERMINATED BY '\n'
    IGNORE 1 LINES; 
```

当我尝试运行它时，我收到此错误：

> 第 17 行的 ERROR 1064 (42000)：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 8 行的 'LOAD DATA LOCAL INFILE'/complete/path/to/file.csv' INTO TABL' 附近使用正确的语法

我的语法不正确怎么办？我已经尝试了文件路径的每种组合，包括单引号、不带单引号、整个路径、只有文件、文件结尾、没有文件结尾以及这些组合。

有任何想法吗？感谢您的帮助！

编辑：我正在使用命令

```
mysql < 'scriptFileName' -u root -p 
```

然后输入我的密码来运行脚本。命令重要吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-06-12T16:40:42.377

您应该使用分号终止您的创建表命令。像这样：

```
CREATE TABLE club_roster (
first_name VARCHAR(32),
last_name VARCHAR(32),
club VARCHAR(32)
); 
```

# c# - 使用其他线程创建的对象

> ID：10250227
> 
> 赞同：1
> 
> 时间：2012-04-20T16:45:02.067
> 
> 标签：c#, wpf, multithreading, share, dependencyobject

我只想在另一个线程中更改窗口的背景。有两个程序，一个是正常工作，另一个抛出 InvalidOperationException。

正确的代码：

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();
        Thread t = new Thread(new ParameterizedThreadStart(threadTest));
        t.Start(@"C:\Users\Public\Pictures\Sample Pictures\Chrysanthemum.jpg");
    }

    void threadTest(object obj)
    {
        string path = obj as string;
        this.Dispatcher.Invoke(new Func<object>(() => this.Background = new 
    }
} 
```

错误代码：

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();
        Thread t = new Thread(new ParameterizedThreadStart(threadTest));
        t.Start(@"C:\Users\Public\Pictures\Sample Pictures\Chrysanthemum.jpg");
    }

    void threadTest(object obj)
    {
        string path = obj as string;
        //this.Dispatcher.Invoke(new Func<object>(() => this.Background = new ImageBrush(new BitmapImage(new Uri(path)))));
        ImageBrush background = new ImageBrush(new BitmapImage(new Uri(path)));
        this.Dispatcher.Invoke(new Func<object>(() => this.Background = background));
    }
} 
```

这些代码的不同之处在于，错误代码在子线程中创建了 ImageBrush 对象。所以我的问题是：在wpf程序中，线程是否只能使用自己线程创建的对象？感谢您的回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T16:47:26.060

是的你是对的。只有 UI 线程可以使用它创建的对象。因此，您可以使用 Dispatcher 将 UI 操作“排队”到它的正确线程上。

回答你的第二个问题，当然，有一种方法可以将对象“传递”到 UI 线程。如果您看到 BeginInvoke 结构（Dispatcher 的），它是：

```
public DispatcherOperation BeginInvoke(
    Delegate d,
    params Object[] args
) 
```

args 是 params 对象数组，那里是你放置 params 的地方。

现在，如果您正在使用某些`Freezable`对象（例如某些图像、画笔、变换或几何图形），那么您需要`object.Freeze();`在将其发送到 UI 线程之前。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:59:40.467

是的，正确的，它不仅是关于`WPF`，而且在一般情况下，关于`Windows programming`。

您不能从不同于它自己的其他线程更新 UI 对象。

这样做的原因很简单，因为必须保证消息泵送，尤其是传递到 OS 的目标控制。这对于使用 的通信自然有效`SendMesage`，但`PostMessage`也适用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T17:27:52.530

如果您在单独的线程上创建一个对象，如果您先冻结它，您可能会在 gui 线程上使用它。请参阅[可冻结对象](http://msdn.microsoft.com/en-us/library/ms750509.aspx)。

# c# - 在 c# 中处理关联数组的最简单方法是什么？

> ID：10250232
> 
> 赞同：62
> 
> 时间：2012-04-20T16:45:26.367
> 
> 标签：c#, associative-array

我在 C# 方面没有太多经验，但我习惯于在 PHP 中使用关联数组。

我看到在 C# 中 List 类和 Array 可用，但我想关联一些字符串键。

处理这个问题的最简单方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：102
> 
> 时间：2012-04-20T16:46:07.123

使用 Dictionary 类。它应该做你需要的。参考在[这里](http://msdn.microsoft.com/en-us/library/xfhwa508.aspx)。

所以你可以做这样的事情：

```
IDictionary<string, int> dict = new Dictionary<string, int>();
dict["red"] = 10;
dict["blue"] = 20; 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2016-03-21T17:05:03.177

字典可以工作，但 .NET 具有内置的关联数组。一个实例是[NameValueCollection](https://msdn.microsoft.com/en-us/library/system.collections.specialized.namevaluecollection(v=vs.110).aspx)类 (System.Collections.Specialized.NameValueCollection)。

与字典相比的一个轻微优势是，如果您尝试读取不存在的键，它会返回 null 而不是抛出异常。以下是设置值的两种方法。

```
NameValueCollection list = new NameValueCollection();
list["key1"] = "value1";

NameValueCollection list2 = new NameValueCollection()
{
    { "key1", "value1" },
    { "key2", "value2" }
}; 
```

# ruby-on-rails - 如何在不同的子域上从 Backbone 应用程序到 Rails 应用程序进行 POST、PUT 和 DELETE？

> ID：10250233
> 
> 赞同：1
> 
> 时间：2012-04-20T16:45:31.313
> 
> 标签：ruby-on-rails, backbone.js, options, put

Whick 是在不同子域上从 Backbone 应用程序到 Rails 应用程序 POST、PUT 和 DELETE 的最佳方式？

我试图从 Rails 应用程序中使用 Backbone 获取一些数据并且它可以工作。我尝试使用 Backbone to Rails 应用程序保存新内容。

我对 PUT 有真正的问题（更新数据库中创建的模型）。我不知道为什么，但是当我在我的主干应用程序中执行以下操作时： book.save()

这本书是一个已经存在于数据库中的模型，而不是向 Rails APP 发送 PUT 请愿书，而是发送 OPTIONS 请愿书，并且没有数据。

理想情况下，我想从 Backbone 应用程序向 Rails 应用程序发送一个 PUT 请求，这样我就可以在我的 Rails 应用程序中执行以下操作：

Book.update_attributes 参数[:book]

Rails 应用程序和 Backbone 应用程序位于同一顶级域的不同子域上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:13:33.997

对于不是 post 或 get 的方法，客户端将发送一个 OPTIONS 请求以确定允许跨域的内容。你需要两件事。您需要一种方法来使用正确的响应标头进行响应，以告诉客户端跨域是可以的。我在 ApplicationController 中创建了一个 after_filter，因为我的跨域需求是系统范围的。

```
after_filter :allow_cross_domain

def allow_cross_domain
  headers["Access-Control-Allow-Origin"] = request.env['HTTP_ORIGIN']
  headers["Access-Control-Request-Method"] = "*"
  headers["Access-Control-Allow-Methods"] = "PUT, OPTIONS, GET, DELETE, POST"
  headers['Access-Control-Allow-Headers'] = '*,x-requested-with,Content-Type'
  headers["Access-Control-Max-Age"] = 1728000
end 
```

接下来，您需要在您的 routes.rb 中处理选项请求

```
match "*options", controller: "application", action: "options", constraints: { method: "OPTIONS" } 
```

并在将处理请求的控制器中（对我来说是 ApplicationController）

```
def options
  allow_cross_domain
  render :text => "", :layout => false
end 
```

# c# - 可以找到类型或命名空间 - 即使我声明了变量

> ID：10250234
> 
> 赞同：-1
> 
> 时间：2012-04-20T16:45:34.563
> 
> 标签：c#, .net

我收到此错误：

> 找不到类型或命名空间名称“myObject”

在这条线上：

```
if (typeof(myObject) != typeof(String)) 
```

这是周围的代码：

```
 for (int rCnt = 1; rCnt <= EmailList.Rows.Count; rCnt++)
            {
                object myObject = (EmailList.Cells[rCnt, 1] as Excel.Range).Value2;
                if (typeof(myObject) != typeof(String))
                    continue;
                cell = (string)(EmailList.Cells[ rCnt,1] as Excel.Range).Value2;
                if (cell!=null)
                    emails.Add(cell.ToString());
            } 
```

我究竟做错了什么？我显然是在声明 myObject. 非常感谢您的指导。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-20T16:46:44.513

[`typeof`运算符](http://msdn.microsoft.com/en-us/library/58918ffs%28v=vs.71%29.aspx)将类型标识符而不是实例标识符作为参数。

您想`myObject.GetType()`获取对象的类型：

```
if (myObject.GetType() != typeof(String)) 
```

甚至改用`is`运算符：

```
if (!(myObject is String)) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-20T16:47:19.323

`typeof`仅适用于类型名称。

你要：

```
if (myObject.GetType() != typeof(String)) 
```

您还可以使用`is`运算符：

```
if (!(myObject is String)) 
```

只有在处理继承时才会出现差异。

```
DerivedInstance.GetType() == typeof(BaseType) // false
DerivedInstance is BaseType // true 
```

正如评论中提到的，`null`是一个问题。如果`DerivedInstance`实际上为空：

```
DerivedInstance.GetType() == typeof(BaseType) // NullReferenceException
DerivedInstance is BaseType // false 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-20T16:47:11.050

你需要 myObject.GetType() 或者你可以使用

```
if ((myObject as string)==null) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-20T16:50:33.190

正如 BoltClock 提到的独角兽，在这种情况下你需要`GetType()`. 此外，您编写的整个代码都是不必要的。

```
 object myObject = (EmailList.Cells[rCnt, 1] as Excel.Range).Value2;
            if (typeof(myObject) != typeof(String)) // !(myObject is String) is enough. Plus, this won't work, if myObject is null.
                continue;
            cell = (string)(EmailList.Cells[ rCnt,1] as Excel.Range).Value2; // you can operate with myObject here as well
            if (cell!=null) // in case of object having type, this is unnecessary.
                emails.Add(cell.ToString()); // why calling ToString() on string? 
```

你唯一需要的是

```
string str = (EmailList.Cells[rCnt, 1] as Excel.Range).Value2 as string;
if (str != null)
    emails.add(str); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-20T16:47:14.547

typeof 用于**类型**而不是**实例**，将其更改为

```
myObject.GetType() 
```

以下是不同的解决方案：

```
if (myObject.GetType() != typeof(String))

if (!(myObject is String))

if ((myObject as String)==null) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-20T16:47:57.633

typeof 将类型作为参数。你已经给它传递了一个对象。你可能想要做的是：

```
if (myObject.GetType() != typeof(string)) 
```

# sqlite - Heroku 正在捆绑安装 Sqlite，尽管 Gemfile 指定仅用于开发

> ID：10250247
> 
> 赞同：2
> 
> 时间：2012-04-20T16:46:05.560
> 
> 标签：sqlite, heroku, bundle, gemfile

当我尝试推送到 heroku 时，`git push heroku master`我收到错误：

```
Counting objects: 55, done.
Delta compression using up to 8 threads.
Compressing objects: 100% (43/43), done.
Writing objects: 100% (43/43), 4.01 KiB, done.
Total 43 (delta 33), reused 0 (delta 0)

-----> Heroku receiving push
-----> Removing .DS_Store files
-----> Ruby/Rails app detected
-----> Installing dependencies using Bundler version 1.1.2
       Running: bundle install --without development:test --path vendor/bundle --binstubs bin/ --deployment
       Fetching gem metadata from https://rubygems.org/.......
       Using rake (0.9.2.2)
       Using i18n (0.6.0)
       Using multi_json (1.1.0)
       Using activesupport (3.2.1)
       Using builder (3.0.0)
       Using activemodel (3.2.1)
       Using erubis (2.7.0)
       Using journey (1.0.3)
       Using rack (1.4.1)
       Using rack-cache (1.2)
       Using rack-test (0.6.1)
       Using hike (1.2.1)
       Using tilt (1.3.3)
       Using sprockets (2.1.2)
       Using actionpack (3.2.1)
       Using mime-types (1.17.2)
       Using polyglot (0.3.3)
       Using treetop (1.4.10)
       Using mail (2.4.3)
       Using actionmailer (3.2.1)
       Using arel (3.0.2)
       Using tzinfo (0.3.32)
       Using activerecord (3.2.1)
       Using activeresource (3.2.1)
       Using bcrypt-ruby (3.0.1)
       Using bootstrap-sass (2.0.0)
       Using will_paginate (3.0.3)
       Using bootstrap-will_paginate (0.0.5)
       Using coffee-script-source (1.2.0)
       Using execjs (1.3.0)
       Using coffee-script (2.2.0)
       Using rack-ssl (1.3.2)
       Using json (1.6.5)
       Using rdoc (3.12)
       Using thor (0.14.6)
       Using railties (3.2.1)
       Using coffee-rails (3.2.2)
       Using faker (1.0.1)
       Using geocoder (1.1.1)
       Using jquery-rails (2.0.0)
       Using pg (0.12.2)
       Using bundler (1.1.2)
       Using rails (3.2.1)
       Installing rest-client (1.6.7)
       Using sass (3.1.15)
       Using sass-rails (3.2.4)
       Installing sequel (3.20.0)
       Installing sinatra (1.0)
       Installing sqlite3 (1.3.5) with native extensions
       Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.
       /usr/local/bin/ruby extconf.rb
       checking for sqlite3.h... no
       sqlite3.h is missing. Try 'port install sqlite3 +universal'
       or 'yum install sqlite-devel' and check your shared library search path (the
       location where your sqlite3 shared library is located).
       *** extconf.rb failed ***
       Could not create Makefile due to some reason, probably lack of
       necessary libraries and/or headers.  Check the mkmf.log file for more
       details.  You may need configuration options.
       Provided configuration options:
       --with-opt-dir
       --without-opt-dir
       --with-opt-include
       --without-opt-include=${opt-dir}/include
       --with-opt-lib
       --without-opt-lib=${opt-dir}/lib
       --with-make-prog
       --without-make-prog
       --srcdir=.
       --curdir
       --ruby=/usr/local/bin/ruby
       --with-sqlite3-dir
       --without-sqlite3-dir
       --with-sqlite3-include
       --without-sqlite3-include=${sqlite3-dir}/include
       --with-sqlite3-lib
       --without-sqlite3-lib=${sqlite3-dir}/lib
       --enable-local
       --disable-local
       Gem files will remain installed in /tmp/build_1t9khulyu1uqj/vendor/bundle/ruby/1.9.1/gems/sqlite3-1.3.5 for inspection.
       Results logged to /tmp/build_1t9khulyu1uqj/vendor/bundle/ruby/1.9.1/gems/sqlite3-1.3.5/ext/sqlite3/gem_make.out
       An error occured while installing sqlite3 (1.3.5), and Bundler cannot continue.
       Make sure that `gem install sqlite3 -v '1.3.5'` succeeds before bundling.
 !
 !     Failed to install gems via Bundler.
 !
 !     Heroku push rejected, failed to compile Ruby/rails app 
```

如您所见，捆绑安装不包括开发和测试（或者它显示在顶部），以及我的 gemfile：

```
 source 'https://rubygems.org'

gem 'rails', '3.2.1'
gem 'bootstrap-sass', '2.0.0'
gem 'bcrypt-ruby', '3.0.1'
gem 'faker', '1.0.1'
gem 'will_paginate', '3.0.3'
gem 'bootstrap-will_paginate', '0.0.5'
gem 'taps'

group :production do
  gem 'pg', '0.12.2'
end

group :development do
  gem 'sqlite3', '1.3.5'
  gem 'annotate', '~> 2.4.1.beta'
end

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '3.2.4'
  gem 'coffee-rails', '3.2.2'
  gem 'uglifier', '1.2.3'
end

gem 'jquery-rails', '2.0.0'

group :test, :development do
  gem 'rspec-rails', '~> 2.8.rc'
  gem 'guard-rspec', '0.5.5'
  gem 'guard-spork', '0.3.2'
  gem 'spork', '0.9.0'
end

group :test do
  gem 'capybara', '1.1.2'
  gem 'factory_girl_rails', '1.4.0'
  gem 'cucumber-rails', '1.2.1'
  gem 'database_cleaner', '0.7.0'
end

#Nifty Scaffold

gem 'nifty-generators', :group => :development

# Location - Geocoder

gem 'geocoder'

gem "mocha", :group => :test 
```

但是您仍然可以看到该捆绑包正在尝试安装 sqlite，因此失败了。知道可能出了什么问题吗？非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T18:40:27.897

我有这个问题。经过一番摸索后，我意识到在对 Gemfile 进行更改后，我忘记了运行 git commit，然后才推送到 heroku。

# c - 了解用户何时按下向上/向下箭头

> ID：10250249
> 
> 赞同：2
> 
> 时间：2012-04-20T16:46:17.407
> 
> 标签：c, windows

此代码在按下输入按钮后打印出用户键入的内容。

```
main()
{

HANDLE         stdinInput = 0;
DWORD          numEvents = 0;
DWORD          numEventsRead = 0;
DWORD          numReceivedRecords = 0;
DWORD          fdwSaveOldMode;
DWORD          fdwMode;

char   dataBuffer[100];
int    bufferLen = 0;

stdinInput = GetStdHandle(STD_INPUT_HANDLE);

if (stdinInput == INVALID_HANDLE_VALUE) 
        perror("GetStdHandle");

if (! GetConsoleMode(stdinInput, &fdwSaveOldMode) ) 
        perror("GetConsoleMode");

fdwMode = ENABLE_LINE_INPUT | ENABLE_ECHO_INPUT;
if (! SetConsoleMode(stdinInput, fdwMode) ) 
        perror("SetConsoleMode"); 

for(; ; )
{

   GetNumberOfConsoleInputEvents(stdinInput, &numEvents);

   if (numEvents != 0) {

       INPUT_RECORD eventBuffer;

      ReadConsoleInputA(stdinInput, &eventBuffer, 1, &numEventsRead);

        if (eventBuffer.EventType == KEY_EVENT) {

            if(eventBuffer.Event.KeyEvent.bKeyDown)
            {
                if(eventBuffer.Event.KeyEvent.uChar.UnicodeChar != 0)
                {
                    printf("%c",eventBuffer.Event.KeyEvent.uChar.UnicodeChar);
                    dataBuffer[bufferLen++] = eventBuffer.Event.KeyEvent.uChar.UnicodeChar;
                    dataBuffer[bufferLen]  = '\0';            

                    if ( dataBuffer[bufferLen] == 99 || eventBuffer.Event.KeyEvent.uChar.UnicodeChar == '\r' ) {
                    printf("User Wrote: %s\n",dataBuffer);

                    memset(dataBuffer,0,sizeof(dataBuffer));
                    bufferLen = 0;
                    }
                }

            }
        }

    }
}

} 
```

现在我想让它检测用户何时按下向上/向下箭头并打印出“按下向上/向下箭头”而无需按 Enter。

考虑使用带有 GetKeyState() 的虚拟键码，但无法完成。

关于如何实现这样的事情的任何想法。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T20:25:47.723

注意虚拟键码。像这样：

```
 if (eventBuffer.EventType == KEY_EVENT) {
        if(eventBuffer.Event.KeyEvent.bKeyDown) {
            switch (eventBuffer.Event.KeyEvent.wVirtualKeyCode) {
                case VK_DOWN: printf("Down arrow pressed\n"); break;
                case VK_UP:   printf("Up arrow pressed\n"); break;
                default: {
                    // Rest of your code...
                } 
```

# java - 如何检查表单是否存在并打印表单的所有属性，HTMLUNIT JAVA

> ID：10250252
> 
> 赞同：0
> 
> 时间：2012-04-20T16:46:21.130
> 
> 标签：java, forms, htmlunit

//在java中编码 //使用htmlunit

如何检查表单是否存在以及是否存在如何打印所有属性，以便稍后将其设置为某个值。

我要自动化的页面有一个表单，每次刷新时，特定字段的输入 ID 都会不同

getelementbyid("/*每次刷新页面时不同*/")

并且元素只能通过它的 id 来识别。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T18:31:14.183

HtmlUnit 支持 xpath:[`getFirstByXPath()`](http://htmlunit.sourceforge.net/apidocs/com/gargoylesoftware/htmlunit/html/DomNode.html#getFirstByXPath%28java.lang.String%29)这为您在 XML 或 HTML 中查找元素提供了很大的灵活性。

[你可以在这里](http://www.w3schools.com/xpath/)学习 xpath 。

例如，如果您想要页面`<input>`上第一个`<form>`中的第二个，您可以使用`//form[1]/input[2]`

# javascript - 调整内容大小时调整饼图大小

> ID：10250255
> 
> 赞同：1
> 
> 时间：2012-04-20T16:46:23.283
> 
> 标签：javascript, html, css

我使用了 javascript 饼图，如果我设置了固定的宽度或高度，它工作正常，但如果我设置 100% 的宽度和高度，它不会显示饼图。当内容调整大小（ 100% ）时，我需要更改宽度和高度。

JS：

```
 $(function () {
          var data = [];
          data[0] = { label: "word", data: 25};
          data[1] = { label: "withdrawn", data: 75 };
          data[2] = { label: "in progress", data: 50 };

          $.plot($("#graph-1"), data, {
              series: {
                  pie: {
                      show: true,
                      radius: 1,
                      label: {
                          show: true,
                          radius: 2/3,
                          formatter: function(label, series){
                  return '<div style="font-size:8pt;text-align:center;padding:2px;color:white;">'+label+'<br/></div>';
              },
                          threshold: 0.1
                      },
                      combine: {color: '#666', threshold: 0.1}
                  }
              },
              legend: {show: false}
          });
}); 
```

HTML：

```
<td class="graph-td">
               <div id="graph-1" class="graph-1"></div>
            </td> 
```

CSS：

```
 /* In this case pie chart working norm */
.graph-1 {  width:250px; height: 250px; margin: 0 auto;}

/* In this case pie chart is not displaying */
.graph-1 {  width:100%; height: 100%; margin: 0 auto;} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T18:51:05.310

```
$(window).on('resize', function(){

   // get container width & height
   // destroy your chart
   // redraw your chart with new dimensions
   // or refresh your chart view, or change the width/height, depending upon how your plugin works

}); 
```

# java - 包接口在哪里定义？

> ID：10250261
> 
> 赞同：0
> 
> 时间：2012-04-20T16:46:49.023
> 
> 标签：java, api, audio, interface, package

我认为这是一个非常愚蠢的问题，但我终其一生都无法理解 API（例如 Java Sound API）和包（例如 Sound 中的 javax.sound.sampled）这一事实。 API）包含接口，这些接口中的方法可以方便地调用。

如果接口没有方法定义，调用什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T16:53:52.807

您不能实例化接口，只能实例化实现接口的类。

```
private Clip m_clip; 
```

这不会实例化或调用任何东西。`Clip`它只是声明了一个变量，您可以在其中存储对实现接口（或`null`）的对象的引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T16:54:44.140

对象可以用接口类型*声明*，但只能用具体类型初始化。所以

```
private Clip m_clip; 
```

很好，因为它只是一个声明。在使用之前`m_clip`，需要对其进行*初始化*，即使其指向一个有效的对象。

```
m_clip = new Clip(); 
```

会产生编译错误，因为作为`Clip`接口，无法实例化。然而，

```
class MyClip implements Clip { ... }
...
m_clip = new MyClip(); 
```

可以：`MyClip`是实现接口的*具体*（非抽象）类`Clip`，因此可以在需要时实例化和使用它`Clip`。在此语句之后， is 的静态类型*（*这是编译器在编译时知道的类型，也是客户端知道的类型），但它的*动态或运行时类型*是. 这不是由编译器跟踪的，也不一定是客户端知道的。`m_clip``Clip``m_clip`*`MyClip``m_clip`. 根据这个简单的例子，这可能看起来很奇怪，但考虑到实际的对象可能是从一个方法返回的，该方法可以在另一个类中，不是你写的，所以没有人知道里面发生了什么。使用的具体类型甚至可能对外界不可见。*

 *一旦你初始化`m_clip`，它的客户就可以使用它（例如调用它的方法）。但是他们只看到它的公共接口，即在. 中声明的方法`Clip`。这一切听起来可能很复杂，但它有一个了不起的优势：**可以随时更改****实际（运行时）类型，而不会影响其客户端。`m_clip`**例如，通过将上面的行更改为

```
m_clip = new SomeOtherClip(); 
```

它的实现发生了变化，但它的客户仍然可以使用它，而无需更改其代码中的任何内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T20:04:53.047

您应该阅读有关 Java Sound API 及其服务提供者接口的文档。[Java Sound API Guide 的第 1 章](http://docs.oracle.com/javase/1.5.0/docs/guide/sound/programmer_guide/chapter1.html)解释了 API 的设计、实现以及实现服务提供者接口的不同提供者可以扩展实现的方式。

简而言之，接口的实现存在，但应用程序开发人员无法直接访问这些类。

在 Java 6（在 Windows 中）中，默认的 Java Sound 实现由 rt.jar 中包含的 com.sun.media.sound 包和名为 jsound*.dll 的 DLL 实现。SPI 模型允许其他服务提供者替换或扩展实现。我找到[了](https://stackoverflow.com/questions/2954372/difference-between-spi-and-api)另一个 StackOverflow 答案，它解释了 SPI 模型在 Java 中的工作原理*

# mysql - 如何使用同一行上两列的值更新所有行的单列？

> ID：10250269
> 
> 赞同：2
> 
> 时间：2012-04-20T16:46:58.450
> 
> 标签：mysql

我有一个包含四列的 MySQL 表：

```
col 1  | Col 2  | Col3 | Col4
-----------------------------
 a1       b1        c1    d1
 a2       b2        c2    d2 
```

等等，有很多这样的行。

现在，我想要一个 SQL 更新语句，我可以在其中更改该表 col3 上所有行的值，以便：

*   对于第 1 行，第 3 列中的值变为“a1 b1”
*   对于第 2 行，第 3 列中的值变为“a2 b2”

因此类似地更新整个表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T17:17:03.263

如果您正在寻找连接到第三个字段的前 2 个字段，请尝试以下操作：

```
update table set col3 = CONCAT(col1, ' ', col2); 
```

# python - Web2py 查询遗留数据库

> ID：10250279
> 
> 赞同：1
> 
> 时间：2012-04-20T16:47:25.480
> 
> 标签：python, data-access-layer, web2py, legacy

我有一个名为 my_legacy_db 的遗留数据库，它与普通数据库分开。

## my_legacy_db

用户 - 电子邮件 - 用户名 - 姓名

因此，悬崖，您的第一部分将生成字段名称并将所有内容放入字典中以构建查询。问题是当我执行此查询时：

```
db().select(my_legacy_db.users)

I get this error:
In [20] : db().select(my_legacy_db.users)
Traceback (most recent call last):
  File "/opt/web-apps/web2py/gluon/contrib/shell.py", line 233, in run
    exec compiled in statement_module.__dict__
  File "<string>", line 1, in <module>
  File "/opt/web-apps/web2py/gluon/dal.py", line 7578, in select
    return adapter.select(self.query,fields,attributes)
  File "/opt/web-apps/web2py/gluon/dal.py", line 1307, in select
    sql = self._select(query, fields, attributes)
  File "/opt/web-apps/web2py/gluon/dal.py", line 1196, in _select
    raise SyntaxError, 'Set: no tables selected'
SyntaxError: Set: no tables selected

In [21] : print (flickr_db.users)
users

In [22] : print flickr_db
<DAL {'_migrate_enabled': True, '_lastsql': "SET sql_mode='NO_BACKSLASH_ESCAPES';", '_db_codec': 'UTF-8', '_timings': [('SET FOREIGN_KEY_CHECKS=1;', 0.0002460479736328125), ("SET sql_mode='NO_BACKSLASH_ESCAPES';", 0.00025606155395507812)], '_fake_migrate': False, '_dbname': 'mysql', '_request_tenant': 'request_tenant', '_adapter': <gluon.dal.MySQLAdapter object at 0x91375ac>, '_tables': ['users'], '_pending_references': {}, '_fake_migrate_all': False, 'check_reserved': None, '_uri': 'mysql://CENSORED', 'users': <Table 'username': <gluon.dal.Field object at 0x9137b6c>, '_db': <DAL {...}>, 'cycled': <gluon.dal.Field object at 0x94d0b8c>, 'id': <gluon.dal.Field object at 0x95054ac>, 'ALL': <gluon.dal.SQLALL object at 0x969a7ac>, '_sequence_name': 'users_sequence', 'name': <gluon.dal.Field object at 0x9137ecc>, '_referenced_by': [], '_singular': 'Users', '_common_filter': None, '_id': <gluon.dal.Field object at 0x95054ac>}>, '_referee_name': '%(table)s', '_migrate': True, '_pool_size': 0, '_common_fields': [], '_uri_hash': 'dfb3272fc537e3339819a1549180722e'}> 
```

我在这里做错了吗？遗留数据库不是内置在 /databases 中吗？提前感谢您的帮助。

更新：我尝试了模型外壳中建议的安东尼：

```
In [3] : db(my_legacy_db.users).select()
Traceback (most recent call last):
  File "/opt/web-apps/web2py/gluon/contrib/shell.py", line 233, in run
    exec compiled in statement_module.__dict__
  File "<string>", line 1, in <module>
  File "/opt/web-apps/web2py/gluon/dal.py", line 7577, in select
    fields = adapter.expand_all(fields, adapter.tables(self.query))
  File "/opt/web-apps/web2py/gluon/dal.py", line 1172, in expand_all
    for field in self.db[table]:
  File "/opt/web-apps/web2py/gluon/dal.py", line 6337, in __getitem__
    return dict.__getitem__(self, str(key))
KeyError: 'users' 
```

现在我知道用户是在 my_legacy_db 中定义的，并且所有语法都是正确的。这是因为 db 文件没有正确生成而出现的错误吗？还是我仍然对选择语法做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T18:36:52.430

如果“用户”是表的名称，并且您想选择所有记录和所有字段，您可以：

```
db(my_legacy_db.users).select() 
```

查询进入内部`db()`，而不是内部`select()`（`select()`列出要返回的字段，如果需要所有字段，则将其留空）。请注意，在上面的行中，`my_legacy_db.users`实际上并不是一个查询，而只是一个表——这是告诉 web2py 你想要表中的所有记录的快捷方式。

你也可以这样做：

```
db().select(my_legacy_db.users.ALL) 
```

这表明您需要所有字段，并且通过排除查询，它假定您需要表中的所有记录。

有关详细信息，请参阅[本书。](http://web2py.com/books/default/chapter/29/6#Query,-Set,-Rows)

# mysql - 将非规范化列选择为单独的记录？

> ID：10250280
> 
> 赞同：2
> 
> 时间：2012-04-20T16:47:25.590
> 
> 标签：mysql, sql

我只是在玩弄 SQL，所以如果我在工作面试中被问到，我并不是完全不了解它。我的朋友最近在一次采访中被问到以下问题，他无法得到它，我问了一个工作中的人，他体面地了解 SQL，但他不知道。你们能帮我回答这个问题，然后解释它是如何工作的吗？请？

****问题****

数据库规范化（或缺乏规范化）通常会给开发人员带来挑战。

考虑一个包含三个字段的员工数据库表：

```
EmployeeID
EmployeeName
EmailAddresses 
```

每个员工都由唯一的 EmployeeID 标识，在 EmailAddresses 字段中可能有一个或多个以逗号分隔的 @rockauto.com 电子邮件地址。

数据库表定义如下：

```
CREATE TABLE Employees
(
  EmployeeID int UNSIGNED NOT NULL PRIMARY KEY,
  EmployeeName varchar(50) NOT NULL,
  EmailAddresses varchar(40) NOT NULL ,
  PRIMARY KEY(EmployeeID)
); 
```

出于测试目的，以下是一些示例数据：

```
INSERT INTO Employees (EmployeeID, EmployeeName, EmailAddresses) VALUES
('1', 'Bill', 'bill@companyx.com'),
('2', 'Fred', 'fred@companyx.com,freddie@companyx.com'),
('3', 'Fred', 'fredsmith@companyx.com'),
('4', 'Joe', 'joe@companyx.com,joe_smith@companyx.com'); 
```

您的任务是编写一个 MySQL SELECT 查询，该查询将为上面的示例数据显示以下输出：

```
Employee    EmailAddress
Bill    bill@companyx.com
Fred (2)    fred@companyx.com
Fred (2)    freddie@companyx.com
Fred (3)    fredsmith@companyx.com
Joe     joe@companyx.com
Joe     joe_smith@companyx.com 
```

请注意，由于有多个同名的人（在本例中为“Fred”），因此 EmployeeID 包含在括号中。

您的查询需要使用 MySQL 5.1.41 兼容的语法编写。您应该假设排序是使用标准数据库升序完成的：“ORDER BY EmployeeID ASC”

对于这个问题，您需要提交单个 SQL SELECT 查询。您的查询应该能够在合理的时间内处理包含 1000 条记录的表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T18:03:56.383

仅当您的电子邮件少于 10000 封时....可以接受吗？

```
select 
       if(t1.c > 1, concat(e.employeename, ' (', e.employeeid, ')'), e.employeename) as Employee,
       replace(substring(substring_index(e.EmailAddresses, ',', n.row), length(substring_index(e.EmailAddresses, ',', n.row - 1)) + 1), ',', '') EmailAddress 
from 
       (select employeename, count(*) as c from Employees group by employeename) as t1, 
       (select EmployeeID, length(EmailAddresses) - length(replace(EmailAddresses,',','')) + 1 as emails from Employees) as t2,
       (SELECT @row := @row + 1 as row FROM 
       (select 0 union all select 1 union all select 3 union all select 4 union all select 5 union all select 6 union all select 6 union all select 7 union all select 8 union all select 9) x,
       (select 0 union all select 1 union all select 3 union all select 4 union all select 5 union all select 6 union all select 6 union all select 7 union all select 8 union all select 9) x2, 
       (select 0 union all select 1 union all select 3 union all select 4 union all select 5 union all select 6 union all select 6 union all select 7 union all select 8 union all select 9) x3, 
       (select 0 union all select 1 union all select 3 union all select 4 union all select 5 union all select 6 union all select 6 union all select 7 union all select 8 union all select 9) x4, 
       (SELECT @row:=0) as ff) as n,
       Employees e
where 
      e.employeename = t1.employeename and
      e.employeeid = t2.employeeid and
      n.row <= t2.emails
order by e.employeeid; 
```

**编辑：**

生成更少的无用数字：

```
select 
       if(t1.c > 1, concat(e.EmployeeName, ' (', e.EmployeeID, ')'), e.EmployeeName) as Employee,
       replace(substring(substring_index(e.EmailAddresses, ',', n.row), length(substring_index(e.EmailAddresses, ',', n.row - 1)) + 1), ',', '') as EmailAddress 
from 
       (select EmployeeName, count(*) as c from Employees group by EmployeeName) as t1, 
       (select EmployeeID, length(EmailAddresses) - length(replace(EmailAddresses,',','')) + 1 as emails from Employees) as t2,
       (select `1` as row from (select 1 union all select 2 union all select 3 union all select 4) x) as n,
       Employees e
where 
      e.EmployeeName = t1.EmployeeName and
      e.EmployeeID = t2.EmployeeID and
      n.row <= t2.emails
order by e.EmployeeID; 
```

And what did we learn? Poor database design results awful queries. And you can do stuff with SQL, that are probably supported only because people do poor database designs... :)

# cakephp - 混淆 CakePHP 代码

> ID：10250284
> 
> 赞同：2
> 
> 时间：2012-04-20T16:47:49.840
> 
> 标签：cakephp, obfuscation

我们在 CakePHP 上创建了一个商业应用程序。我即将将它安装在客户端的服务器上，因此我们希望保护我的代码不被修改和/或复制和转售、更改试用期条款等。

我想知道混淆 Cake PHP 代码是否会破坏 Cake 特定的库，或者使应用程序无法使用。

我一直在这个论坛和互联网上搜索，发现了几个混淆 PHP 代码的选项，但没有一个与 CakePHP 相关。（我只是询问了一些商业工具提供商是否支持 Cake 混淆，但尚未收到答复）。

有谁知道这是否可能，或者是否有更好的方法来做到这一点？

我将在本周末尝试使用商业工具的试用版之一，但如果有人对此有建议会很棒

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T16:51:04.140

我建议，你试一试，试试看。通常，混淆器也应该混淆框架。它应该与您使用的 PHP 代码类型无关。

在测试环境中测试它。如果成功，您可以将其注册到您的生产环境。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-29T05:13:30.060

我的公司 Semantic Designs 是商业供应商之一。

使用一个不错的混淆器[（咳咳：）](http://www.semanticdesigns.com/Products/Obfuscators/PHPObfuscator.html)你应该不会有任何麻烦。您需要以某种方式告诉混淆器（对于我们的混淆器，您只需提供符号名称列表）哪些标识符必须保留为明文（例如，对 CakePHP 框架的任何调用），以及您的软件可能提供的任何公共 API。

# wix - WiX - 在安装时提升（或降低）权限

> ID：10250287
> 
> 赞同：0
> 
> 时间：2012-04-20T16:48:13.547
> 
> 标签：wix, windows-installer, vdproj

我正在开发一个项目，该项目一直在使用 2 个 VD 项目来分发安装的管理员和用户版本，现在我需要切换到 WiX。由于缺乏文档和所有内容，这是一个有点痛苦的经历，但我设法做到了。

但是，仍然存在一个问题：我只想制作一个 .msi，它允许用户选择是要以管理员身份安装还是以用户身份安装。如果他选择用户，我不想要求他提升（因为他不需要它），同样如果他选择管理员，我不希望安装崩溃而是要求特权。

如果我设置`InstallPrivileges`为，我当前的解决方案在管理员模式下崩溃，`limited`因为用户没有安装权限，如果我将其设置为`elevated`.

我的观点是，由于与 MSI 的兼容性，**没有办法**解决这个问题，但也许有一些方法可以将我所缺少的权限从提升到安装时间限制。

总之，我想知道这些事情：

*   是否可以在安装时更改权限
*   如果没有办法这样做，这个问题的最佳解决方法是什么（导出 2 个 .msi 文件或其他东西）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:22:56.807

一种解决方案是构建两个单独的安装程序，然后通过自定义 WiX 引导程序（又名 Burn）启动它们。引导程序将负责显示 UI 并启动适当的 .msi。

或者，如果用户选择管理员安装，您可以将“管理员”功能分离到单独的 .msi 中，然后使用自定义引导程序安装这两个 .msis。

# c# - c# 购物车

> ID：10250288
> 
> 赞同：1
> 
> 时间：2012-04-20T16:48:14.923
> 
> 标签：c#, cart, shopping

我一直在查看这段代码来创建一个基本的购物车，但缺点是它使用静态方法，因此购物车项目（当添加到购物车时）在会话之间共享。有人可以指出如何修改 ShoppingCart 方法以消除此限制吗？

[完整的代码参考在这里](http://net.tutsplus.com/tutorials/other/build-a-shopping-cart-in-aspnet/)

但我确定这是有问题的代码

```
// Readonly properties can only be set in initialization or in a constructor
public static readonly ShoppingCart Instance;

// The static constructor is called as soon as the class is loaded into memory
static ShoppingCart() {
    // If the cart is not in the session, create one and put it there
    // Otherwise, get it from the session
    if (HttpContext.Current.Session["ASPNETShoppingCart"] == null) {
        Instance = new ShoppingCart();
        Instance.Items = new List<CartItem>();
        HttpContext.Current.Session["ASPNETShoppingCart"] = Instance;
    } else {
        Instance = (ShoppingCart)HttpContext.Current.Session["ASPNETShoppingCart"];
    }
}

// A protected constructor ensures that an object can't be created from outside
protected ShoppingCart() { }

public void AddItem(int productId) {
    // Create a new item to add to the cart
    CartItem newItem = new CartItem(productId);

    // If this item already exists in our list of items, increase the quantity
    // Otherwise, add the new item to the list
    if (Items.Contains(newItem)) {
        foreach (CartItem item in Items) {
            if (item.Equals(newItem)) {
                item.Quantity++;
                return;
            }
        }
    } else {
        newItem.Quantity = 1;
        Items.Add(newItem);
    }
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-20T16:52:20.490

我使用过几个商业购物车，每个购物车都将购物车存储在数据库中，甚至在结帐之前，并且只在 session.id 中存储了一个会话 ID。该 SessionID 绑定到临时购物车中的字段。

我强烈建议遵循相同的模式。假设您的网站非常受欢迎。在内存中存储太多数据（无论是在会话中还是在应用程序中）你会遇到问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-20T17:14:13.957

如果您使用的是静态变量，那么任何线程（无论是哪个用户）都可以访问该数据。这意味着您基本上在所有用户之间共享一张购物卡，我怀疑您不想要。

相反，您可以有一个受保护的构造函数来防止手动实例化，然后有一个静态方法来读取 Session 对象并获取当前实例。至于填写`Items`列表的静态方法，您应该在构造函数中执行此操作。

```
public static ShoppingCart GetInstance()
{
    ShoppingCart cart = (ShoppingCart)Session["ASPNETShoppingCart"];

    if (cart == null)
    {
        Session["ASPNETShoppingCart"] = cart = new ShoppingCart();
    }

    return cart;
}

protected ShoppingCart()
{
    Items = new List<CartItem>();
} 
```

# scala - Scala Lift - Mongodb 将数据保存为 json 对象

> ID：10250297
> 
> 赞同：2
> 
> 时间：2012-04-20T16:49:08.007
> 
> 标签：scala, mongodb, lift

我有以下型号

```
class Recording private() extends MongoRecord[Recording] with ObjectIdPk[Recording] {

    def meta = Recording

    object data extends StringField(this, 50)

} 
```

我目前将 Json 对象作为字符串保存在“数据”字段中，我之前使用过 JsonObject 字段，但仅使用预定义的对象结构。在这种情况下，要保存的 json 对象可以具有任何结构或数据字段，因此预定义的数据结构不是一个选项。

说我有：

```
{"name" : "James", "value" : "Hai!"} 
```

或者

```
{"result" : 1, "handle" : "lorem_ipsum"} 
```

我需要能够将两者都保存为同一字段“数据”中的 json 对象。

有没有办法我可以做到这一点？

在此先感谢您的帮助，非常感谢:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-31T19:04:47.507

可能对您有用的是将数据存储为 a`JValue`而不是`String`. 您可以使用`JsonObjectField`包装一个包含 a 的案例类`JValue`，这将允许任意结构，但它会在 Mongo 中为您提供额外的嵌套级别。为了解决这个问题，如何创建一个自定义字段来保存一个`JValue`？

一击必杀：

```
abstract class JValueObjectField[OwnerType <: BsonRecord[OwnerType]](rec: OwnerType)
   extends Field[JValue,OwnerType] 
    with MandatoryTypedField[JValue] 
    with MongoFieldFlavor[JValue] {

  def owner = rec

  def defaultValue = JNothing

  def toForm:  Box[NodeSeq] = Empty

  implicit val formats = owner.meta.formats

  def asJValue: JValue = valueBox openOr JNothing

  def setFromJValue(jv: JValue): Box[JValue] = Full(jv)

  def setFromString(in: String): Box[JValue] = tryo(JsonParser.parse(in)) match {
    case Full(jv: JValue) => setFromJValue(jv)
    case f: Failure => setBox(f)
    case other => setBox(Failure("Error parsing String into a JValue: "+in))
  }

  def setFromAny(in: Any): Box[JValue] = in match {
    case dbo: DBObject => setFromDBObject(dbo)
    case value: JValue => setBox(Full(value))
    case Some(value: JValue) => setBox(Full(value))
    case Full(value: JValue) => setBox(Full(value))
    case (value: JValue) :: _ => setBox(Full(value))
    case s: String => setFromString(s)
    case Some(s: String) => setFromString(s)
    case Full(s: String) => setFromString(s)
    case null|None|Empty => setBox(defaultValueBox)
    case f: Failure => setBox(f)
    case o => setFromString(o.toString)
  }

def asDBObject: DBObject = JObjectParser.parse(asJValue.asInstanceOf[JObject])

def setFromDBObject(dbo: DBObject): Box[JValue] =
  setFromJValue(JObjectParser.serialize(dbo))
} 
```

...看起来很多：我所做的只是剪切和粘贴`JValueObjectField`一个参数，删除并固定在`JValue`. 可能有更聪明的方法来做到这一点。

然后，您可以在模型中使用它：

```
 object data extends JValueObjectField(this) 
```

我会使用[lift-json](https://github.com/lift/framework/tree/master/core/json) DSL 填充它：

```
 val json = ("name" -> "Bob") ~ ("result" -> 1)
 Recording.createRecord.data(json).save 
```

这将在 MongoDB 文档中为您提供如下内容：

```
"data" : {
  "name" : "Bob",
  "result" : 1
} 
```

顺便说一句，[电梯邮件列表](http://liftweb.net/forum)是获得更好答案的好方法：这恰好是大多数电梯相关人员似乎聚集的地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-01-30T20:38:34.527

```
class Recording private() extends MongoRecord[Recording] with ObjectIdPk[Recording] {

          def meta = Recording

          object data extends JObjectField(this)
} 
```

# ios - NSURLRequest 缓存策略

> ID：10250309
> 
> 赞同：5
> 
> 时间：2012-04-20T16:49:59.260
> 
> 标签：ios, caching, ios5, nsurlrequest

我正在使用 NSURLRequest 和 CachePolicy 来下载 NSData 中的 plist。当我更改我的 plist 的内容时，我的应用程序会忽略这一点，但仍会显示缓存的内容。缓存会持续多久？如果是这样，是否可以选择说明缓存数据持续多长时间？如果服务器上的数据比缓存更新，是否有办法检查 NSURLRequest 从服务器加载数据，或者它是否等于缓存使用缓存？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T17:01:03.280

[查看URLLoadingSystem 文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/URLLoadingSystem/Tasks/UsingNSURLConnection.html)中的控制响应缓存。

您可以在委托方法中添加自己的日期

```
-(NSCachedURLResponse *)connection:(NSURLConnection *)connection
                 willCacheResponse:(NSCachedURLResponse *)cachedResponse 
```

使用缓存系统更容易的是[ASIHTTPRequest](http://allseeing-i.com/ASIHTTPRequest/How-to-use)。我推荐使用这个 URL 加载系统。

来自苹果文档：

> 清单 6 中的示例防止缓存 https 响应。它还将当前日期添加到缓存响应的用户信息字典中。

```
-(NSCachedURLResponse *)connection:(NSURLConnection *)connection
                 willCacheResponse:(NSCachedURLResponse *)cachedResponse
{
    NSCachedURLResponse *newCachedResponse = cachedResponse;

    if ([[[[cachedResponse response] URL] scheme] isEqual:@"https"]) {
        newCachedResponse = nil;
    } else {
        NSDictionary *newUserInfo;
        newUserInfo = [NSDictionary dictionaryWithObject:[NSCalendarDate date]
                                                 forKey:@"Cached Date"];
        newCachedResponse = [[[NSCachedURLResponse alloc]
                                initWithResponse:[cachedResponse response]
                                    data:[cachedResponse data]
                                    userInfo:newUserInfo
                                    storagePolicy:[cachedResponse storagePolicy]]
                            autorelease];
    }
    return newCachedResponse;
} 
```

# sql - sql 查询帮助 - 试图摆脱临时表

> ID：10250312
> 
> 赞同：0
> 
> 时间：2012-04-20T16:50:10.177
> 
> 标签：sql, sql-server-2008

我有以下表格 -

```
Resource
--------------------
Id, ProjectId, Hours, ApproverId

Project
--------------------
Id, Name 
```

输入是 ApproverId。我需要检索所有匹配 ApproverId 的行（足够简单）。对于我返回的每个资源，我还需要获取他们的小时数（同一张表），其批准者 ID 不是传入的（业务需求，在 UI 中显示为灰色）。我现在正在做的是 - 根据 ApproverId 获取所有资源，将它们存储在临时表中，然后对 Resource.Id 执行不同的操作，将其存储在不同的临时表中，然后对于每个 Resource.Id，获取ApproverId*不是*通过的行。我可以将它们全部组合在一个查询中而不是使用临时表吗？

谢谢！

编辑：我使用的是 SQL Server 2008 R2。

编辑2：这是我的存储过程。阅读评论后，我稍微改变了逻辑。我们可以摆脱所有临时表并使其更快 -

```
ALTER PROCEDURE GetResourceDataByApprover
    @ApproverId UNIQUEIDENTIFIER    
AS 
    CREATE TABLE #Table1
        (
          Id SMALLINT PRIMARY KEY
                      IDENTITY(1, 1) ,
          ResourceId UNIQUEIDENTIFIER
        )        

    CREATE TABLE #Table2
        (
          ResourceId UNIQUEIDENTIFIER ,
          ProjectId UNIQUEIDENTIFIER ,
          ProjectName NVARCHAR(1024)          
        )

    INSERT  INTO #Table1
            SELECT DISTINCT
                    ResourceId
            FROM    dbo.Resource T
            WHERE   T.ApproverId = @ApproverId

    DECLARE @i INT 
    DECLARE @numrows INT
    DECLARE @resourceId UNIQUEIDENTIFIER

    SET @i = 1 
    SET @numrows = ( SELECT COUNT(*)
                     FROM   #Table1
                   )

    IF @numrows > 0 
        WHILE ( @i <= ( SELECT  MAX(Id)
                        FROM    #Table1
                      ) ) 
            BEGIN 
                SET @resourceId = ( SELECT  ResourceId
                                    FROM    #Table1
                                    WHERE   Id = @i
                                  )

                INSERT  INTO #Table2
                        SELECT 
                                T.ResourceId ,
                                T.ProjectId ,
                                P.Name AS ProjectName

                        FROM    dbo.[Resource] T
                                INNER JOIN dbo.Project P ON T.ProjectId = P.ProjectId                                
                        WHERE   T.ResourceId = @resourceId                               

                SET @i = @i + 1 
            END

    SELECT  *
    FROM    #Table1 
    SELECT  *
    FROM    #Table2

    DROP TABLE #Table1  
    DROP TABLE #Table2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:05:17.857

此查询应为每个资源返回两行，一行用于指定的审批者，另一行用于所有其他审批者。

```
SELECT 
  Id, 
  CASE
    WHEN ApproverId=@approverId THEN 'SpecifiedApprover'
    ELSE 'OtherApprover'
  END AS Approver, 
  SUM(Hours) AS Hours
FROM Resource
GROUP BY 
  Id,
  CASE
    WHEN ApproverId=@approverId THEN 'SpecifiedApprover'
    ELSE 'OtherApprover'
   END 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T17:10:12.730

您想知道具体的 Approver 是如何浪费时间的吗？

```
SELECT p.Id, p.Name, SUM(r.Hours) as TotalHours
FROM Resource r
LEFT JOIN Project p
ON r.ProjectId = p.Id
WHERE ApproverId = %ConcreteApproverId%
GROUP BY p.Id, p.Name
HAVING SUM(r.Hours) > 0 
```

此查询将生成此表示例：

```
+-----+----------+-------+
| Id  | Project  | Hours |
+-----+----------+-------+
| 203 | ProjectA | 25    |
| 202 | ProjectB | 34    |
| 200 | ProjectC | 46    |
+-----+----------+-------+ 
```

# iphone - 将 OAuth2 添加到 iOS 项目

> ID：10250314
> 
> 赞同：5
> 
> 时间：2012-04-20T16:50:35.927
> 
> 标签：iphone, objective-c, ios, ipad, oauth

我真的很难将 OAuth2 纳入一个项目。我查看了所有不同的 OAuth 客户端，但文档很少，示例项目已经过时。我想要做的就是使用我的 clientID 和秘密硬编码并使用 ARC/storyboards 获得一个身份验证令牌。

我已经尝试过 nxtbgthng 的 OAuthConsumer、LROAuth2Client、GTM-OAuth2、OAuth2Client。任何教程、基本示例应用程序或您可以指出的任何东西都会很棒。我能找到的唯一示例应用程序是旧的，并且没有使用 ARC 或故事板。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T17:35:04.543

```
 - (id)init{
    self =  [super init];
    self.view.frame = CGRectMake(0, 0, 320, 480);
    [self.view setBackgroundColor:[UIColor whiteColor]];

    /*****OAUTHCLIENT SETUP*****/
    oauthClient = [[SBOAuth2Client alloc] initWithClientID:@"foo" secret:@"foo" redirectURL:[NSURL URLWithString:@"http://foo.com/"]];
    oauthClient.userURL  = [NSURL URLWithString:userUrl];
    oauthClient.tokenURL = [NSURL URLWithString:tokenUrl];
    oauthClient.delegate = self; 

    /*****WEBVIEW SETUP*****/
    webView = [[[UIWebView alloc] initWithFrame:CGRectMake(0, 20, 320, 460)] retain];
    [self.view addSubview:webView];
    return self;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T17:05:36.873

如：

```
 webView = [[[UIWebView alloc] initWithFrame:CGRectMake(0, 20, 320, 460)] retain]; 
```

或者

```
 if(webView==nil){
    //allocate it again
 }
 [oauthClient authorizeUsingWebView:webView]; 
```

# windows - 主机名是否保证是有效的 Windows 目录名？

> ID：10250319
> 
> 赞同：2
> 
> 时间：2012-04-20T16:50:50.500
> 
> 标签：windows, directory, hostname

我已经阅读[了主机名的有效字符？](https://stackoverflow.com/questions/3523028/valid-characters-of-a-hostname)和相关的维基页面。我无法确定的是，如果我在具有扩展主机名的 Windows 机器上，gethostname() 会返回名称的 ToAscii 版本还是 UTF8 字符串？

而且更重要的是可以

```
gethostname(buffer,LEN);
mkdir(buffer, mode); 
```

是否因名称无效而失败？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T18:20:52.637

就 DNS 主机名和 NetBIOS 主机名而言，MSDN上似乎有一些[关于主机名的有用信息。](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724220%28v=vs.85%29.aspx)似乎表明主机名可能确实是 UTF-8，但这不是决定性的。

因此，如果您从 gethostname 获取 UTF-8，您可能必须将其转换为 UTF-16（或系统默认代码页）才能调用任何创建目录的 Windows 函数。另请注意，不同的文件系统对字符集有不同的规则。NTFS 将非常优雅地处理 Unicode，但 FAT 不会。

您可以尝试将本地计算机的名称更改为非 ASCII 字符（甚至可能是系统默认代码页中没有的某些字符）。

# database - 如何从数据库中动态检索数据

> ID：10250322
> 
> 赞同：0
> 
> 时间：2012-04-20T16:51:06.903
> 
> 标签：database, winforms

我正在使用 C# 在 winform 上处理邮件合并的功能。众所周知，它在邮件合并中将一封电子邮件发送到批处理。为此目的，创建数据列表并将其存储在数据库中，当用户按下“插入和合并”选项时，将从数据库中检索数据并替换占位符。使用的查询是；

comm.CommandText="select <> from <> where Sno=1;

其中 Sno 是主键

问题是，我怎样才能动态地做到这一点

诠释REC = 1;

我想用这个变量替换“1”，我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T16:54:00.943

```
comm.Commandtext = "Select <> from <> where Sno=@SNO";
comm.Parameters.Add("@SNO", rec); 
```

# c++ - getProcAddress - 返回 NULL

> ID：10250323
> 
> 赞同：5
> 
> 时间：2012-04-20T16:51:11.770
> 
> 标签：c++, dll, getprocaddress

我有以下代码：

```
 //mydll.cpp
    #include <Windows.h>
    #include <io.h>

    #define STDOUT_FILEDESC 1

    class MYSTDOUT {
        bool shouldClose;
        bool isBuffered;
    public:
        MYSTDOUT(bool buf = true, bool cl = true) 
            : isBuffered(buf),
              shouldClose(cl) 
        {}
        ~MYSTDOUT() {
            if (shouldClose) {
                close(STDOUT_FILEDESC);
            }
        }
    };

    __declspec(dllexport) void* mydll_init_stdout()
    {
        static MYSTDOUT outs;
        return &outs;
    }
//test_dll.cpp
#include <stdio.h>
#include <stdlib.h>
#include <Windows.h>
#include <io.h>

typedef void* (__cdecl *MYPROC)(void);

int main(void)
{
  int fd;
  void *pstdout;

  MYPROC init_stdout;
  HMODULE handle = LoadLibrary(TEXT("mydll.dll")); 

  init_stdout = (MYPROC)GetProcAddress(handle,"mydll_init_stdout");//NULL

  FreeLibrary((HMODULE) handle);
  return 0;
} 
```

我知道 init_stdout 是 NULL。可能是什么问题？句柄是好的（非空）谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-20T16:53:47.470

那是由于名称修饰。

您需要将导出的函数包装`extern "C"`为：

```
extern "C"
{
    __declspec(dllexport) void* mydll_init_stdout()
    {
        static MYSTDOUT outs;
        return &outs;
    }
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-20T16:52:54.220

检查 Dependency Walker，或者`dumpbin /exports`您会看到它`mydll_init_stdout`已以损坏的 C++ 名称导出。这就是`GetProcAddress`呼叫失败的原因。

用于`extern "C"`停止损坏。

```
extern "C" 
{
    __declspec(dllexport) void* mydll_init_stdout()
    {
        static MYSTDOUT outs;
        return &outs;
    }
} 
```

# arrays - CUDA共享内存不比全局快吗？

> ID：10250325
> 
> 赞同：3
> 
> 时间：2012-04-20T16:51:13.923
> 
> 标签：arrays, cuda, find, compare, shared

嗨，我有内核函数，我需要比较字节。我要搜索的区域被划分为块，因此 4k 字节的数组被划分为 4k/256 = 16 个块。块中的每个线程读取 idx 上的数组并将其与另一个数组进行比较，这就是我要搜索的内容。我通过两种方式做到了这一点：

1.比较全局内存中的数据，但经常block中的线程需要读取相同的地址。

2.将全局内存中的数据复制到共享内存中，并按照上述方法比较共享内存中的字节数。读取相同的地址仍然有问题。复制到共享内存如下所示：

```
myArray[idx] = global[someIndex-idx];
whatToSearch[idx] = global[someIndex+idx]; 
```

其余代码相同。只有示例 2 中的数据操作在共享数组中执行。

但是第一个选项比共享内存快 10%，为什么？谢谢你的解释。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-20T18:18:40.330

如果你只使用一次数据并且在一个块中的不同线程之间没有数据重用，那么使用共享内存实际上会更慢。原因是当你将数据从全局内存复制到共享时，它仍然算作一个全局事务。从共享内存读取时读取速度更快，但这没关系，因为您已经必须从全局读取内存一次，而从共享内存读取的第二步只是一个额外的步骤，不会提供任何有价值的东西.

因此，关键点是，只有当您需要多次访问相同的数据（无论是来自同一个线程，还是来自同一个块中的不同线程）时，使用共享内存才有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T18:32:42.223

您正在使用共享内存来节省对全局内存的访问，但每个线程仍在对全局内存进行两次访问，因此不会更快。速度下降可能是因为访问块内全局内存中相同位置的线程试图将其读入共享内存中的相同位置，这需要序列化。

我不确定您在发布的代码中到底在做什么，但是您应该确保`global`在块中的所有线程中汇总的读取和写入次数在使用共享内存时显着降低. 否则你不会看到性能提升。

# xcode - 如何创建自定义矢量图标以在 Xcode 应用程序中使用

> ID：10250330
> 
> 赞同：0
> 
> 时间：2012-04-20T16:52:24.230
> 
> 标签：xcode, macos, vector

我目前正在尝试弄清楚如何使这些字形/矢量图标看起来像使用 Xcode 获得的默认图标（例如 NSActionTemplate）。我研究并看到它们在 Illustrator 中保存为 PDF。

当我做了同样的技巧（我设法找到 Apple 的图标的原始 Illustrator 文件）并将其保存为 PDF 时，将其导入我的项目并将图标拖到一个带纹理的按钮上，它看起来是纯黑色的。然而，它确实清除了白色背景，所以我认为它可能是预览中可见的白色背景导致它不像原件那样设置按钮样式。

![看看它如何不改变按图标的样式，但在默认情况下做得很好。](../Images/5648373f8bf2950092d99f16103886e9.png)

所以基本上我要问的是我如何设法使图标看起来像默认值。我真的不想制作多个文件和/或编码行为，因为将图像拖放到按钮上并应用样式本身应该很容易。

**- 编辑 -**

好的，所以我找到了解决方案——通过将文本“模板”附加到文件名中，它将执行此操作。但我仍然无法弄清楚为什么我的透明 PDF - 从 Illustrator 导出为 AI 和 EPS - 它仍然有 Xcode 使用的白色背景 - 所以它将是一个具有我想要的效果的矩形，而不是圆形。

任何知道如何从 PDF 中删除白色背景以便它可以在 Xcode 中工作的人。它让我觉得它是透明的（当在 PDF 和 Illustrator 中看到透明网格时）并且它仍然具有白色背景。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T19:37:28.267

PDF 中的白色背景（您应该始终使用 PDF 而不是 EPS——它们在 OS X 上“玩得很好”）与最初面向打印内容的 PDF 格式有关。您在 Preview 和 Xcode 中看到的白色背景是“页面”区域。幸运的是，当您将 PDF 加载到 中时，这通常会消失/被忽略`NSImage`，就像您将其放在按钮上时一样。

如果我理解正确，您遇到的问题是您在按钮上放置了一个没有背景的 PDF，并且在 Xcode 的 Interface Builder 中它显示得好像有背景？我能够重现这种行为，但我不确定是什么原因造成的。但是我使用相同的模板文件和错误显示的 NIB 构建并运行了一个测试应用程序。在实际运行的 Cocoa 应用程序中，图形显示正确。

有时 Interface Builder 只是预览错误。我怀疑这个问题仅仅是准备界面的装饰。

# c++ - 如何在 Qt 的默认用户浏览器中打开链接？

> ID：10250332
> 
> 赞同：69
> 
> 时间：2012-04-20T16:52:42.347
> 
> 标签：c++, qt

我想知道如何使用 Qt 在默认用户浏览器中打开链接（这将在所有平台上打开它（Win Mac Lin））？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2012-04-20T16:57:21.030

在文档中：QDesktopServices

[http://doc.qt.io/qt-4.8/qdesktopservices.html#openUrl](http://doc.qt.io/qt-4.8/qdesktopservices.html#openUrl)

```
bool QDesktopServices::openUrl ( const QUrl & url ) [static] 
```

> 在适合用户桌面环境的 Web 浏览器中打开给定的 url，如果成功则返回 true；否则返回假。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2013-07-27T09:03:23.807

你可以试试这段代码

```
QString link = "http://www.google.com";
QDesktopServices::openUrl(QUrl(link)); 
```

阅读[QDesktopServices](http://qt-project.org/doc/qt-4.8/qdesktopservices.html#openUrl)和[QUrl](http://qt-project.org/doc/qt-4.8/qurl.html)以获取更多信息。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-04-20T16:58:26.073

您正在桌面服务类中寻找 openUrl()

[http://qt-project.org/doc/qt-4.8/QDesktopServices.html](http://qt-project.org/doc/qt-4.8/QDesktopServices.html)

# sitecore - 将媒体库存储从文件切换到数据库是否明智？

> ID：10250336
> 
> 赞同：0
> 
> 时间：2012-04-20T16:53:28.307
> 
> 标签：sitecore, sitecore6, webdeploy

我将媒体库存储为物理文件。当 Sitecore 用户发布项目时，文件会使用 WebDeploy 分散到多个 CD 服务器。

由于 WebDeploy 的一些性能问题，我想切换到数据库存储，但我担心可能为时已晚。我有数百个物理媒体库文件已附加到 Sitecore 中的项目。

事后，Sitecore 将如何应对切换存储？它可以同时处理这两种模式，还是我必须将所有文件迁移到数据库中？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T18:42:08.947

当在多服务器环境中运行时，我会进行切换，它减少了数据库中媒体的问题，也减少了需要跟踪的事情。

[在这里](http://firebreaksice.com/storing-sitecore-media-in-the-database-vs-the-file-system/)查看更多优点和缺点

您可以很容易地将所有现有的媒体项目制作成数据库媒体。

我已使用此工具进行迁移： [https ://marketplace.sitecore.net/en/Modules/Media_Conversion_Tool.aspx](https://marketplace.sitecore.net/en/Modules/Media_Conversion_Tool.aspx)

# ruby-on-rails - HAML - 如何创建链接以便它们转到正确的控制器？

> ID：10250337
> 
> 赞同：1
> 
> 时间：2012-04-20T16:53:33.517
> 
> 标签：ruby-on-rails, devise, haml

我有一些我正在尝试在 HAML 中使用的链接

```
 =link_to("My Disclosures", "") << ' |'
  =link_to("Create Disclosure", "#") << ' |'
  =link_to("My Programs", "#") << ' |'
  =link_to("Log Out", "sign_out") 
```

我不知道该怎么做是链接到我拥有的不同控制器操作。

这是我的路线：

```
scope :module => :mobile, :as => :mobile do
    constraints(:subdomain => /m/) do
      devise_for :users, :path => "", :path_names =>
               { :sign_in => "login", :sign_out => "logout",
                 :sign_up => "signup" },
                 :controllers => {:sessions => "mobile/sessions"}

      resources :home

      resources :disclosures # Will have new, get, look up a disclosure
    end
  end 
```

所以我认为我的 log_out 路径会起作用，但它似乎不起作用。

另外，我有这个非常简单的控制器：

```
class Mobile::DisclosuresController < ApplicationController

  def new
    Rails.logger.debug "-"*100
    Rails.logger.debug session.inspect
    Rails.logger.debug "-"*100

    respond_to do |format|

    end
  end

  def create

  end

  def destroy

  end
end 
```

但我不确定如何制作 HAML 链接，以便它们导致我在获取和发布时需要执行的各种控制器操作。任何有关如何正确链接到控制器的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T17:08:44.930

用于`rake routes`获取所有路线的列表，包括它们的名称。使用这些名称并附加“_path”以获取该路由的路径。

您应该能够像这样披露：

```
=link_to "My Disclosures", disclosures_path 
```

# javascript - window.onload 与 jQuery(document).ready

> ID：10250340
> 
> 赞同：4
> 
> 时间：2012-04-20T16:53:34.733
> 
> 标签：javascript, jquery, onload

我想知道从

```
$(document).ready(function() {...}) 
```

到

```
window.onload = function() {...} 
```

原因是我正在制作一个小部件并且不想强制 jQuery 包含以防用户已经将它包含在他们的应用程序中，我也不希望他们必须修改小部件代码 - 所以我动态确定我是否应该包括它。

但是，为了动态包含它，我无法在 jQuery 之前访问 jQuery `window.onload`，这让我产生了怀疑。

**我主要担心的是这会破坏用户应用程序的功能。**所以……会吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T16:56:37.727

您的函数实际上将在页面生命周期的不同点触发。`onload`在必须加载所有页面元素之前在生命周期的早期调用，而 ready 事件稍后触发。如果您想在不使用 jQuery 的情况下附加到事件，您也可以轻松地做到这一点：

```
document.addEventListener('DOMContentReady', function()
{
     // Stuff
}); 
```

# javascript - 使用原型比在构造函数中创建函数的优势？

> ID：10250341
> 
> 赞同：2
> 
> 时间：2012-04-20T16:53:45.837
> 
> 标签：javascript

这是一个动物对象的构造函数。

```
function Animal(name, sound) {
   this.name = name;
   this.sound = sound;
   this.makeSound = function() {
       alert(sound);
   }
} 
```

我发现开发人员可以通过向 Animal 类添加实例方法

```
Animal.prototype.makeSound = function() { alert(this.sound); }; 
```

并从构造函数中排除 makeSound 方法。使用这种原型设计模式有什么好处？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-20T16:58:50.660

原型版本应该只创建一次并存储在内存中，而构造函数版本将在内存中创建一个新函数并将其与对象一起存储。

这更像是一个内存管理的事情。在功能上，它几乎相同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T16:59:48.490

对象实例的原型“存在”。当您创建其中一个对象时，该数据被优化为已经存在，而不是每次实例化时都更改该对象。......以及Tejs刚刚所说的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-22T14:36:34.740

此外，您可以公开访问`Animal.prototype.makeSound`可能有用的原始方法 ( )。

# java - PreferenceActivity，如何制作一个将通过菜单导航回来的 Preference 项？

> ID：10250342
> 
> 赞同：2
> 
> 时间：2012-04-20T16:53:45.997
> 
> 标签：java, android, preferenceactivity

我最重要的问题是：在 Android中，当我浏览定义的菜单`PreferenceActivity`时，如何编写一个与按下 Android 后退按钮具有相同功能的功能？也就是说，我希望我的应用程序的用户明确地看到一个菜单选项“返回”，这将把他们带到上一个菜单，或者如果他们在这个的根目录下，把他们从菜单活动中带到他们以前的活动特定的会话。 `OnClickListener``PreferenceScreen``PreferenceActivity`

[android开发者文档告诉](http://developer.android.com/reference/android/preference/PreferenceActivity.html)我们

> 请注意，此 XML 资源包含一个包含另一个片段的首选项屏幕，即此处实现的 Prefs1FragmentInner。这允许用户遍历偏好层次结构；按下后退会将每个片段从堆栈中弹出以返回到以前的首选项。

他们对此是正确的。`PreferenceScreen`我通过单击项目进入该屏幕并使用 Android 后退按钮返回上一级来愉快地浏览我的菜单。但我不确定普通用户是否真的理解“后退”按钮，我知道直到我在开发者文档中读到它时才知道。所以我希望他们有一个明确`Preference`定义的菜单选项，它可以`OnClickListener`复制 Android 后退按钮的功能。

所以我试图在我的菜单中添加一个可以返回的首选项。在确定`onBackPressed`我的子类中的一个未覆盖后，我`PreferenceActivity`刚刚引用了`Activity.onBackPressed()`它只是调用`finish()`，我尝试了这个`OnClickListener`：

```
private OnPreferenceClickListener clickFinishesSuccessfully = new OnPreferenceClickListener() {
    @Override
    public boolean onPreferenceClick(Preference preference) {
        finish();
        return true;
    }
}; 
```

事实证明，这与按下后退按钮的作用不同！按下这个按钮总是让我`PreferenceActivity`完全脱离，回到`Activity`我调用我的`PreferenceActivity`. 具体来说，无论我单击它时有多深，它都不会在我的菜单中导航回来。

我在这里猜测：当我通过单击屏幕上的首选项（实际上是 ）进入子菜单`PreferenceScreen`时，我不再属于我自己的`PreferenceActivity`。我必须参加其他活动？

所以我的功能问题：我可以在我的“后退”的 OnClickListener 中放入什么`Preference`来获得与通过我的菜单导航的 Android 后退按钮相同的功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T17:10:15.987

我认为普通用户应该知道后退按钮。该按钮无处不在，因此在第一天使用它可能会出现问题，但之后就很自然了。如果不习惯“后退”按钮，我几乎无法想象完成日常任务。

您要添加的首选项只是重复功能，并且不提供与系统其余部分一致的方式。如果 Google 正在考虑重新成为临时用户的不寻常事物，那么会在手机的设置中添加该选项，这也是 PreferenceActivity。

# css - 如何在我的网站底部放置空白，使浮动 div 永远不会重叠

> ID：10250351
> 
> 赞同：5
> 
> 时间：2012-04-20T16:54:52.317
> 
> 标签：css

我发现了很多关于摆脱空白的堆栈溢出问题，但我似乎无法弄清楚如何将其放入。

我的网站上有一个随页面浮动的底部导航，但如果窗口很小，则页面的底部会被覆盖。我想在底部插入一些空白，所以当窗口小于页面长度时，您仍然可以阅读它。

我试过添加：

```
margin-bottom: 50px;
padding-bottom: 50px; 
```

到包含首页内容的 div，但它不起作用。

有什么我想念的吗？这是一个演示：[http ://www.writingprompts.net/name-generator/](http://www.writingprompts.net/name-generator/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T16:58:27.890

```
#left, #right { 
    margin-bottom: 90px; 
} 
```

或者

```
#top_section > div { 
    margin-bottom: 90px; 
} 
```

它不适用于#top_section，因为您使用绝对值，因此内容实际上扩展了 div 本身，但相信我，我给您的这两个 css 中的任何一个都可以工作

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T16:59:24.617

只需添加以下规则：

```
#top_section {
    overflow: hidden;
    padding-bottom: 90px;
} 
```

这将使其`#top_section`与其中的浮动内容一样大。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T17:02:22.733

[http://jsfiddle.net/rlemon/fSYmu/](http://jsfiddle.net/rlemon/fSYmu/)这是一个简化的例子，不知道你的布局是什么样的（我不会假设演示是你的......除非你修改并告诉我它是）我'会告诉你*我会怎么做*

**HTML**

```
<div class="container"> <!-- main page wrapper -->
<div class="content"> <!-- main content wrapper, backgrounds apply here -->
    <div class="inner-content"> <!-- content inner, where your content goes! -->
    content
    </div>
</div>
<div class="footer">footer</div> <!-- footer -->
</div> 
```

**CSS**

```
​html,body,.container {
 height: 100%; margin: 0; padding: 0; // I am important so the page knows what 100% height is.
}

.content {
 height: 100%; // see above... i need to cascade down.
 background-color: green;
}
.content-inner {
 padding-bottom: 100px; // offset for the footer.
}
.footer { 
 width: 100%;
 position: absolute; // stick me to the bottom.
 bottom: 0;
 height: 100px;
 background-color: red;   
} 
```

请享用！​</p>

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T17:05:15.030

您需要在 CSS 中使用固定位置来实现这一点。

HTML：

```
<div id="top-section">
     Insert content here...
</div>
<div id="bottom-nav">
     <div id="content">
       Bottom content...
     </div>
</div> 
```

CSS：

```
#bottom-nav {
  bottom: 0;
  position: fixed;
  width: 100%;
}

#content {
  margin: 0 auto;
  width: 960px;
} 
```

# user-interface - 如何使用 LoadUI 执行数据驱动的负载测试

> ID：10250352
> 
> 赞同：0
> 
> 时间：2012-04-20T16:54:59.107
> 
> 标签：user-interface, loadui

我正在对 Web 服务进行负载测试。

是否可以使用 loadui 执行数据驱动测试？如果是，如何？

我们可以只向网络运行器（给出 url）发出请求，但我无法提供任何数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T08:00:34.503

[loadUI 文档中的这篇](http://loadui.org/Load-Testing-soapUI-Tests/getting-started-with-soapui-integration.html)文章解释了你是如何做到的。基本上，您必须通过soapUI Runner 使用soapUI 数据源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-02T12:14:25.197

您可以使用 SoapUI 和 LoadUI [免费版本 :-) ]

在 SoapUI 中创建一个 TestSuite，然后创建 TestCase。在 TestCase 中定义自定义属性...例如名称为“firstName”的属性

然后在您的请求中，您可以使用像这样的值 ${#TestCase#firstName}

保存项目并打开 LoadUI。

单击 FLOW -> 选择 DataSource 浏览您的输入文件。右键单击 -> 设置，根据需要修改分隔符。检查循环选项为 TRUE。

之后就可以使用一些Runner了，右键->设置->属性

现在您可以看到所有 TestCase 属性（在 SoapUI 中定义）。

现在你只需要从数据源转移到 SoapUIRunner 对于列值，你可以使用这样的东西： ${#Data Source 1#firstName}\

希望这可以帮助。干杯尼古拉

# java - Python：可以将文本发送到已经运行的 java 应用程序的标准输入吗？

> ID：10250353
> 
> 赞同：0
> 
> 时间：2012-04-20T16:55:00.210
> 
> 标签：java, python, windows, stdin

我需要将文本发送到独立于 Python 启动的 java 应用程序的标准输入。到目前为止，我一直在使用 pywin32 sendkeys，但是与输出存在一些不一致之处，这让我寻找其他解决方案。

我知道子进程，但它看起来只能用于与 Python 启动的子进程交互，而不是独立启动的子进程。

Socket 对我来说不是一个选项，因为 Windows 不允许多个连接到同一个端口。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T18:40:49.587

让 java 应用程序从命名管道中读取。命名管道允许多个客户端对其进行写入，并且与语言无关。

# qt - QPrinter 有没有在工作表上写打印源的功能

> ID：10250356
> 
> 赞同：0
> 
> 时间：2012-04-20T16:55:21.660
> 
> 标签：qt

我目前正在制作一个可以打印我的小部件内容的应用程序。就这样完成了。但现在，我希望能够在每一页的底部写下源和/或版权。例如：当您从 Internet 打印页面时，页面底部总是有 url。

所以我想做基本上类似的事情。我查看了文档，但没有看到任何可以快速完成的操作。因为如果什么都没有，我将不得不手动编码，我宁愿避免这种情况

谢谢！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T19:09:28.257

听起来你想要一个[页脚](http://en.wikipedia.org/wiki/Page_footer)。显然没有内置支持，但此链接可能会有所帮助：

[http://qt-project.org/faq/answer/is_it_possible_to_set_a_header_and_footer_when_printing_a_qtextdocument](http://qt-project.org/faq/answer/is_it_possible_to_set_a_header_and_footer_when_printing_a_qtextdocument)

# android - android列表项的定位

> ID：10250360
> 
> 赞同：0
> 
> 时间：2012-04-20T16:55:31.970
> 
> 标签：android, listview

我想让 ListView 带有一些自定义（布局）项目。这些项目的背景在其底部具有透明度。我希望下一个项目（在此自定义之后）定位在顶部（类似于 CSS 中的负边距）。如果在列表项的 LinearLayout 中（这个特殊的列表项）我可以用负值做 android:layout_marginTop 吗？它似乎不起作用，那么更好的解决方案是什么？我需要很少定位下一个列表项。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T17:16:10.810

我不认为 listView 公开了这个功能。然而，作为一个图像技巧，如果你可以修改图像，只需将透明部分（我假设它是一个阴影？）放在你的 listItem 背景图像的顶部，这样它**看起来**就像上面的项目投射了一个阴影，但实际上阴影是您的 listItem 背景的一部分

# php - 如何传递对回调函数的引用以在带有额外参数的 array_filter 中使用？

> ID：10250364
> 
> 赞同：3
> 
> 时间：2012-04-20T16:55:43.907
> 
> 标签：php, reference, pass-by-reference

我的方法的签名如下所示：

```
public function ProgramRuleFilter(&$program, $today=null) { 
```

当我这样调用它时，

```
$programs = array_filter($programs, array($this,'ProgramRuleFilter')); 
```

一切都按预期工作。该`ProgramRuleFilter`方法更新`$program`数组，然后如果成功过滤则返回真/假`$programs`。

但是，现在我想向过滤器传递一个额外的参数，`$today`. 我怎样才能做到这一点？

我试图像这样调用它：

```
$programs = array_filter($programs, new CallbackArgs(array($this,'ProgramRuleFilter'),$today)); 
```

使用这个小类作为包装器：

```
class CallbackArgs {
    private $callback;
    private $args;

    function __construct() {
        $args = func_get_args();
        $this->callback = array_shift($args);
        $this->args = $args;
    }

    function __invoke(&$arg) {
        return call_user_func_array($this->callback, array_merge(array($arg),$this->args));
    }
} 
```

但是程序没有被更新，所以在某处它丢失了对原始对象的引用。我不知道如何解决这个问题。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-20T17:11:27.607

的第二个参数`array_filter`必须是回调；这意味着它`array_filter`本身将调用您的过滤器函数。没有办法告诉`array_filter`以任何其他方式调用该函数，因此您需要找到一种方法以`$today`其他方式将值导入您的函数。

这是何时使用闭包的完美示例，它可以让您将一些数据（在本例中为 的值`$today`）绑定到函数/回调中。假设您使用的是 PHP 5.3 或更高版本：

```
// Assuming $today has already been set

$object = $this; // PHP 5.4 eliminates the need for this
$programs = array_filter( $programs, function( $x ) use ( $today, $object ){
    return $object->ProgramRuleFilter( $x, $today );
}); 
```

这定义了一个闭包内联，使用父作用域的值`$today`和`$object`来自父作用域的值，然后只调用`ProgramRuleFilter`该 $object 上的现有函数。（有点不寻常`$object = $this`的是，否则闭包将无法调用对象实例上的方法。但在 PHP 5.4 中，您可以在闭包内替换为。`$object`）`$this`

现在，这是一种不太优雅的方法，因为这个闭包所做的只是将工作交给`ProgramRuleFilter`函数。更好的方法是使用闭包而不是函数。所以：

```
// Assuming $today has already been set

$filter = function( $x ) use ( $today ){
    // Cut and paste the contents of ProgramRuleFilter() here,
    // and make it operate on $x and $today
};
$programs = array_filter( $programs, $filter ); 
```

哪种变体最适合您将取决于应用程序其余部分的实现。祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T17:11:30.933

我写了一个新方法来处理它：

```
public static function array_filter_args($array, $callback) {
    $args = array_slice(func_get_args(),2);
    foreach($array as $key=>&$value) {
        if(!call_user_func_array($callback, array_merge(array(&$value),$args))) {
            unset($array[$key]);
        }
    }
    return $array;
} 
```

像这样调用：

```
$programs = ArrayHelper::array_filter_args($programs, array($this,'ProgramRuleFilter'), $today); 
```

我不知道你能做到这一点`array(&$value)`，但我想我会尝试一下，它看起来很有效。我猜这`array_merge`是取消引用变量的罪魁祸首。

# c# - Protobuf-net：序列化包含字典的自定义类

> ID：10250365
> 
> 赞同：4
> 
> 时间：2012-04-20T16:55:43.830
> 
> 标签：c#, protobuf-net, datacontractserializer

我正在使用 Marc Gravell 的[ProtoBuf-net](http://code.google.com/p/protobuf-net/ "protobuf-net")库（r480，net20）来序列化/反序列化包含`<object, object>`已知类型字典的自定义类，该字典用于服务器/客户端场景（均为 C#）。
这将取代我们当前使用 BinaryFormatter 的方法。
作为基础，我遵循这里提出的建议： [protobuf-and-listobject-how-to-serialize-](https://stackoverflow.com/questions/923977/protobuf-and-listobject-how-to-serialize-deserialize) deserialize和这里[​​ protobuf-and-listobject-how-to-serialize-deserialize](https://stackoverflow.com/questions/3261310/protobuf-net-instances-of-abstract-classes-cannot-be-created)。

目前的方法有一些缺点，我希望更熟悉 Protobuf-net 的人可以给我一个关于如何改进它的提示。

1.  在 OnSerialising() 调用上将字典复制`<object, object>`到字典。`<ProtoObject, ProtoObject>`
2.  添加新类型的维护开销（每个都需要 ProtoInclude 标记和 ProtoObject.Create(object obj) 中的相应转换逻辑）
3.  ProtoObject 必须知道所有必需的类型。这会导致项目之间的循环引用问题，这只能通过对项目结构进行更大的重构来解决。

理想情况下，我想使用 RuntimeTypeModel 方法，但我不知道如何让客户端知道类型（编译 TypeModel dll 并将其传输到客户端？）。

同样在第一个主题中，Marc Gravell 提到即将推出的“运行时可扩展模式”可能会有所帮助，有谁知道这些是否已经实现以及它们是如何工作的？
无论我得到什么回复，我都非常感谢，如果我能澄清更多，请告诉我。
无论如何，感谢 Marc Gravell 的精彩图书馆 :)。

这是代码：

```
[Serializable]
[ProtoContract]
public class Attributes : IXmlSerializable, IEnumerable, IEquatable<Attributes>, ICloneable
{
    // Non ProtoBuf-net relevant code was removed

    private Dictionary<object, object> attributes = new Dictionary<object, object>();

    [ProtoMember(1)]
    private Dictionary<ProtoObject, ProtoObject> protoDictionary;

    [OnSerializing]
    public void OnSerializing(StreamingContext context)
    {
        this.protoDictionary = new ProtoDictionary();

        foreach (var attribute in attributes)
        {
            this.protoDictionary.Add(ProtoObject.Create(attribute.Key), ProtoObject.Create(attribute.Value));
        }
    }

    [OnDeserialized]
    public void OnDeserialized(StreamingContext context)
    {
        if (this.protoDictionary != null)
        {
            this.attributes = new SerializableHashtable();

            foreach (var o in this.protoDictionary)
            {
                this.attributes.Add(o.Key.Value, o.Value.Value);
            }
        }
    }
}

[ProtoContract]
[ProtoInclude(1, typeof(ProtoObject<bool>))]
[ProtoInclude(2, typeof(ProtoObject<byte>))]
[ProtoInclude(3, typeof(ProtoObject<sbyte>))]
[ProtoInclude(4, typeof(ProtoObject<ushort>))]
[ProtoInclude(5, typeof(ProtoObject<short>))]
[ProtoInclude(6, typeof(ProtoObject<uint>))]
[ProtoInclude(7, typeof(ProtoObject<int>))]
[ProtoInclude(8, typeof(ProtoObject<ulong>))]
[ProtoInclude(9, typeof(ProtoObject<long>))]
[ProtoInclude(10, typeof(ProtoObject<float>))]
[ProtoInclude(11, typeof(ProtoObject<double>))]
[ProtoInclude(12, typeof(ProtoObject<decimal>))]
[ProtoInclude(13, typeof(ProtoObject<string>))]
[ProtoInclude(20, typeof(ProtoObject<Vector2F>))]
[ProtoInclude(21, typeof(ProtoObject<Vector3F>))]
[ProtoInclude(22, typeof(ProtoObject<Shape>))]
[ProtoInclude(23, typeof(ProtoObject<SharedUser>))]
[ProtoInclude(24, typeof(ProtoObject<SharedShip>))]
//[ProtoInclude(25, typeof(ProtoObject<IVehicleConfiguration>))] // Requires Steering dll -> cyclic reference
[ProtoInclude(26, typeof(ProtoObject<DroneState>))]
[ProtoInclude(27, typeof(ProtoObject<BuffCode>))]
[ProtoInclude(28, typeof(ProtoObject<ItemAttribute>))]
[ProtoInclude(40, typeof(ProtoObject<List<int>>))]
public abstract class ProtoObject
{
    protected ProtoObject()
    {
    }

    // Replaces public static ProtoObject<T> Create<T>(T value)
    // in order to use the actual type of the object
    public static ProtoObject Create(object obj)
    {
        if (obj is bool)
        {
            return new ProtoObject<bool>((bool)obj);
        }

        if (obj is byte)
        {
            return new ProtoObject<byte>((byte)obj);
        }

        // etc. for all required types

        return null;
    }

    public static ProtoObject Create(bool obj)
    {
        TypeModel.Add(obj.GetType(), true);

        return new ProtoObject<bool>(obj);
    }

    public static ProtoObject Create(byte obj)
    {
        return new ProtoObject<byte>(obj);
    }

    // ... public static ProtoObject Create(type obj) -> for all required types

    public object Value
    {
        get { return ValueImpl; }
        set { ValueImpl = value; }
    }

    protected abstract object ValueImpl { get; set; }   
}

[ProtoContract]
public sealed class ProtoObject<T> : ProtoObject
{
    public ProtoObject()
    {
    }

    public ProtoObject(T value)
    {
        Value = value;
    }

    [ProtoMember(1)]
    public new T Value { get; set; }

    protected override object ValueImpl
    {
        get { return Value; }
        set { Value = (T)value; }
    }

    public override string ToString()
    {
        return Value.ToString();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T09:27:09.150

简单地序列化 a不是一个受支持的用例......就个人而言，我认为您应该更多地考虑使用特定于使用的 DTO 模型，`Dictionary<object,object>`就像使用.或. protobuf-net 最终仍然是一个合约序列化器，DTO 模型是理想的用例。通常它适用于非 DTO 模型，但这并不能保证它适用于人们可能设计的每个模型。`XmlSerializer``DataContractSerializer``JavascriptSerializer`

# matlab - 如何在 Vim 中模拟 Matlab 的运行命令（F5）？

> ID：10250367
> 
> 赞同：14
> 
> 时间：2012-04-20T16:55:53.283
> 
> 标签：matlab, vim, clipboard

我使用 Linux 和 gVim/Vim 作为 Matlab 的外部编辑器。

在 Matlab 编辑器中，您可以通过按 运行文件 `F5`。我试图在 Vim 中重现这个（从`gvim-gtk`Debian 包安装）。

我知道可以将名称或当前文件或选定文本以“shell 模式”发送到 Matlab，如下所示：

```
execute '!echo "' ."run(\'".expand("%:p")."\')" . '"| matlab -nojvm' 
execute '!matlab -nodisplay < '.expand("%:p") 
noremap <C-CR> :?%%?;/%%/w !matlab -nojvm 
```

但我想使用 Matlab GUI（在我的情况下它已经打开）。

这是我认为可以为我解决的解决方案：

1.  在 vim 中使用键映射：

    *   (a) 在剪贴板中放入类似：`run('path-to-file')`或`cd('folder');run('filename')`。
    *   (b) 调用一个 shell 命令，将焦点转移到 Matlab GUI
2.  此时，我应该在 Matlab 命令窗口中，所以我只需按`Ctrl`- `V`，剪贴板的内容应该被粘贴。（即使我在 Linux 上，我也使用带有 Windows 键绑定的 Matlab。）

**Step 1(a):** 下面将`run('filename')`命令放到剪贴板中，Matlab 会在按下`Ctrl`-时粘贴：`V`

```
let @+="run(\'".expand("%:p")."')" 
```

以下两个命令适用于 Linux 中键粘贴，但这不是我想要的，因为我想在此步骤中避免使用鼠标：

```
let @*="run(\'".expand("%:p")."')" 

execute '!echo "' . "run(\'".expand("%:p")."\')" . '"| xclip' 
```

**步骤 1(b)：**为了将焦点放在 Matlab 窗口，我使用以下命令：

```
wmctrl -a MATLAB & 
```

这很好用，但它也可能会打开一个浏览器窗口，如果它碰巧打开了一个标题中带有 Matlab 一词的页面（就像你现在正在阅读的那个）。

另请参阅更复杂的解决方案：[是否有 linux 命令来确定与给定进程 ID 关联的窗口 ID？](https://stackoverflow.com/questions/2250757/is-there-a-linux-command-to-determine-the-window-ids-associated-with-a-given-pro).

**我的（现在是旧的）选项，但是`Ctrl`-`V`不起作用！只有鼠标粘贴可以：**

```
function! MatRun()
    let @+="run(\'".expand("%:p")."')" 
    let @*="run(\'".expand("%:p")."\')" 
    :call system('xclip', @+)
    !wmctrl -a MAT
endfunction

map <F5> :call MatRun() <cr><cr> 
```

不知何故，`Ctrl`-`V`在这种情况下与结合使用时不起作用`wmctrl`（请参阅下面的编辑）。对我来说，重点是避免使用鼠标进行此操作。

感谢您的帮助。

### 更新：一个工作选项

我的错，我正在使用`xclip`我应该使用的地方`xclip -selection c`。请看我下面的回复。

如果有人找到更好的解决方案，我会很高兴，例如：直接在 Matlab 命令窗口中粘贴，确保您在命令窗口（`Ctrl`- `0`）中，或者避免使用`wmctrl`.

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-21T18:01:16.927

**编辑：** 查看由它制作的插件：[https ://github.com/elmanuelito/vim-matlab-behave](https://github.com/elmanuelito/vim-matlab-behave)

很抱歉回答我自己的问题。这是我的错，我在应该使用 xclip -selection c 的地方使用 xclip 。我在下面列出了对我有用的不同代码：它重现了 F5 和评估单元格的行为，但您必须按 Ctrl-V 或使用鼠标粘贴到 Matlab 命令行窗口中。如果您不在命令窗口上，请使用 matlab 快捷键 Ctrl-0 跳转到它。该脚本会自动从 vim 转到 matlab（除非您有另一个名为“matlab”的窗口）。之后我添加了标记以返回到以前的光标位置。

**运行整个脚本 matlab：**这是“运行/F5”行为（进入正确的目录并执行整个脚本）：

```
function! MatRun()
   normal mm " mark current cursor in mark m"
   let @+="cd('".expand("%:p:h")."\'); run('./".expand("%:f"). "')"
   call system('xclip -selection c ', @+)
   call system('xclip ', @+)
   normal `m "go back to cursor location"
   !wmctrl -a MATLAB 
endfunction
map ,m :call MatRun() <cr><cr> 
```

**要运行，仅评估单元格：**这是 Ctrl+Enter 行为。在与上面相同的行中：(**编辑**：我现在对其进行了扩展，以便它从第一个向上的 %% 或文件的开头 (\%^) 到第一个向下的 %% 或文件的结尾 (\ ^$)**结束编辑**)

```
function! MatRunCell()
    normal mm "remember cursor"
    :?%%\|\%^?;/%%\|\%$/w !xclip -selection c  "pipe the cell to xclip"
    normal `m "go back to cursor location"
    !wmctrl -a MATLAB  "go to matlab window"
endfunction
map ,k :call MatRunCell()  <cr><cr> 
```

但我更喜欢下面的，虽然更复杂（当然可以只做vim）。以下内容确保您在正确的目录中运行单元，并在评估单元后返回 Vim（如果您在 matlab 中正确配置了外部编辑器。我使用：gvim --servername MAT --remote-tab -沉默的）。

```
 function! MatRunCellAdvanced()
     execute "!echo \"cd(\'".expand("%:p:h")."\')\">/tmp/buff"  
     normal mm
     :?%%\|\%^?;/%%\|\%$/w>> /tmp/buff
     execute "!echo \"edit ".expand("%:f")."\">>/tmp/buff"
     !cat /tmp/buff|xclip -selection c
     !cat /tmp/buff|xclip
     normal `m
     !wmctrl -a MATLAB 
 endfunction
map ,n :call MatRunCellAdvanced()  <cr><cr> 
```

**运行当前行：** 将当前行复制到剪贴板并转到 matlab 窗口。（再次 Control+V 将其粘贴到 matlab 中，如果它是您在 matlab 中使用的快捷方式）

```
 function! MatRunLine()
     " write current line and pipe to xclip "
     :.w !xclip -selection c
     !wmctrl -a MATLAB 
 endfunction
 map ,l :call MatRunLine()  <cr><cr> 
```

**运行选择：**模拟 F9 行为。

```
 function! MatRunSelect()
     normal mm
     !rm -f /tmp/buff
     :redir > /tmp/buff
     :echo @*
     :redir END
     execute "!echo \" \">>/tmp/buff"
     execute "!echo \"edit ".expand("%:p")."\">>/tmp/buff"
     !cat /tmp/buff|xclip -selection c
      normal `m
     !wmctrl -a MATLAB 
  endfunction 
```

**粗体单元格标题 单元格标题** 中的粗体字体

```
 highlight MATCELL cterm=bold term=bold gui=bold
 match MATCELL /%%.*$/ 
```

**把这些命令放在哪里** 所有这些命令都在 .vim/after/ftplugin/matlab.vim

**编辑** 而不是使用：

```
 run('./".expand("%:f")."')" 
```

我现在用

```
run('".expand("%:p")."')" 
```

处理 vim 'pwd' 与脚本目录不同的情况。我没有找到仅提取脚本名称的方法，因此我使用了完整路径。有人可能会为此找到更好的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-17T21:28:23.083

对于那些只想能够从 vim 运行 matlab 脚本并且不需要其他花哨的 GUI 东西的人，您可以尝试使用 matlab 的命令行 shell。

`:! matlab -nosplash -nodesktop -r %:r`将启动一个新的 matlab shell 并将当前文件作为脚本（或不带参数的函数）运行，类似于 matlab GUI 中的 F5。您需要输入“exit”以退出 matlab shell，然后返回 vim。当然，这仅在您要运行的文件位于 matlab 路径或终端的工作目录中时才有效。

这可能有点不方便，因为新的 matlab 实例一直在启动，所以运行脚本可能需要一段时间。您可以尝试使用`-nojvm`来避免 java 造成的开销，但我认为最好的解决方案是保持 matlab shell 处于打开状态。

你可以使用一个名为[Conque-Shell](https://github.com/vim-scripts/Conque-Shell)的 Vim 插件来做到这一点。
安装后，您可以启动 matlab shell，`:ConqueTerm matlab -nodesktop`您将获得一个可以像 matlab 控制台一样使用的缓冲区。使用 yank 和 paste 执行代码部分就可以了。或者您可以创建为您执行此操作的 vim 函数。由于我不是很擅长，我只能在这里提供这个丑陋的映射：

`:nmap <f5> :let @"=expand('%:r')<cr>:buffer matlab\ -nodesktop<tab><cr>""p<cr>`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-26T01:41:21.457

我在 Windows 上使用**Autohotkey**执行此操作（我也用它来交换`Esc`和`Caps Lock`键）。Autohotkey 可以在没有管理员权限的情况下安装，在公司机器上很有用。

使用如下所述的设置：

*   在 gvim 中，在正常模式下按下`CTRL-L`将评估 Matlab 中的当前行（然后返回 gvim）。
*   在可视模式下，它将评估 Matlab 中的当前选择（并返回到 Vim）。

单元模式可以通过稍微不同的映射来实现`CTRL-E`（见下文）。（Autohotkey 脚本将在 Matlab 中执行通过`CTRL-E`gvim 中的映射放入剪贴板的任何内容。）然后您可以并排或在不同屏幕上设置 Matlab 和 gvim，这是一种很好的工作方式。

在我的 Autohotkey 文件中，我使用了这个映射：

```
^l::
; execute line or current selection in Matlab
    IfWinActive, ahk_class Vim
    {
        ; CTRL-E is mapped to a Vim shortcut to yank the text you want
        Send, ^e
        WinActivate, ahk_class SunAwtFrame  
        Send, ^0^v{Enter}
        WinActivate, ahk_class ahk_class Vim
    } else if WinActive, ahk_class SunAwtFrame  
    {
        Send, ^0^v{Enter}
    } 
Return 
```

然后，在 vim 中，我使用以下快捷方式：

```
:nnoremap ^E Y
:vnoremap ^R y 
```

`CTRL-E`注意：^E 是在 vim 中按`CTRL-V` `CTRL-E`或输入的文字`CTRL-Q` `CTRL-E`。

注 2：`SunAwtFrame`是 Windows 在我的机器上调用 Matlab 窗口。您可以使用 Windowspy（与 Autohotkey 捆绑在一起）来确认它在您的机器上的名称是否相同。

# python - 通过客户端/服务器之间现有的 ssh 连接从服务器远程登录到设备

> ID：10250371
> 
> 赞同：3
> 
> 时间：2012-04-20T16:56:05.750
> 
> 标签：python, ssh, telnet, paramiko

这是问题所在。我正在使用我的脚本直接通过 telnet 连接（**从我的 Windows 桌面**<=(telnet)=>**到设备**）连接到设备。基本上，我的脚本在[TL1](http://en.wikipedia.org/wiki/Transaction_Language_1)中运行一些命令，捕获输出并根据参数值进行操作......非常简单。

该设备将安装在另一个网络上，我无法再通过 telnet 直接访问该网络。现在，我必须在特定服务器上启动 ssh 连接，然后从那里启动 telnet 会话。（**从我的 Windows 桌面**<=(ssh)=>**服务器**<=(telnet)=>**到设备**）

我了解 paramiko 的基本知识...我在[jessenoler](http://jessenoller.com/2009/02/05/ssh-programming-with-paramiko-completely-different/)网站上找到了该代码：

```
import paramiko
ssh.connect('127.0.0.1', username='jesse', password='lol')
stdin, stdout, stderr = ssh.exec_command("uptime")
type(stdin)
stdout.readlines()
# output:
# ['13:35  up 11 days,  3:13, 4 users, load averages: 0.14 0.18 0.16\n'] 
```

我不知道如何从服务器启动 telnet ......我应该使用：

```
ssh.exec_command("telnet 10.10.10.10 10001") 
```

我知道解决我的问题的最简单方法是在服务器上安装 python，但我不能。以前有人遇到过这种问题吗？感谢您的输入！:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T21:51:02.563

您应该设置 SSH 隧道而不是打开正常连接。这可以通过客户端的命令行`-L localport:server:remoteport`来完成，也可以通过 python 来完成`paramiko`。

查看[这个答案](https://stackoverflow.com/a/8292891/164277)和[链接的要点](https://gist.github.com/1399529)，了解如何使用 Python 进行操作的详细信息。

设置完成后，您应该使用 telnet 连接到`localhost`指定为 localport 的端口。

# java - 在 Android 中使用线程时出错

> ID：10250372
> 
> 赞同：0
> 
> 时间：2012-04-20T16:56:12.390
> 
> 标签：java, android, multithreading

```
I create a simple Project to load all images in drawable 
```

这是我的代码

```
public void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    list = (ImageView)findViewById(R.id.tung);
    ct = getApplicationContext();
    try
    {
        IDs = getAllResourceIDs(R.drawable.class);
        n= IDs.length;
        dem=0;
        list.setOnClickListener(new View.OnClickListener()
         {
            public void onClick(View v)
            {
                ++dem;
                list.setImageResource(IDs[dem]);
                if(dem==n-1)
                    dem=0;
            }
        });

        Thread x = new Thread(
                new Runnable ()
                {
                    public void run()
                    {
                        while(true)
                        {
                            try
                            {
                                ++dem;
                                //Toast.makeText(ct, ""+dem, 20).show();
                                list.setImageResource(IDs[dem]);
                                if(dem==n-1)
                                    dem=0;
                            }
                            catch(Exception e)
                            {
                                //Toast.makeText(ct,e.toString(), 200).show();
                            }
                        }
                    }
                }
                );
        x.start();
    }
    catch(Exception e)
    {
        Toast.makeText(this,e.toString(), 200).show();
    }
} 
```

anh 这里是获取所有 ID 的 getAllResourceIDs 函数

```
private int[] getAllResourceIDs(Class<?> aClass) throws IllegalArgumentException{
    /* Get all Fields from the class passed. */
    Field[] IDFields = aClass.getFields();

    /* int-Array capable of storing all ids. */
    int[] IDs = new int[IDFields.length];

    try {
            /* Loop through all Fields and store id to array. */
            for(int i = 0; i < IDFields.length; i++){
                    /* All fields within the subclasses of R
                     * are Integers, so we need no type-check here. */

                    // pass 'null' because class is static
                    IDs[i] = IDFields[i].getInt(null);
            }
    } catch (Exception e) {
            /* Exception will only occur on bad class submitted. */
            throw new IllegalArgumentException();
    }
    return IDs; 
```

文件 main.xml 只有一个 id = "tung" 的 ImageView 我尝试使用名为 x 的 Thead 加载所有图像，方法是使用代码 list.setImageResource(IDs[dem]); 正如您在我的代码中看到的那样，但没有发生任何事情您能为我解释一下吗！非常感谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:02:56.250

对于初学者来说`catch (Exception e)`，这几乎不是一个好主意，因为它隐藏了发生错误时可以获得的所有有意义的信息。

您的错误尤其是在后台线程中的这一行：

```
list.setImageResource(IDs[dem]); 
```

不允许后台线程操作 UI 对象。相反，您需要使用[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)（更简单）或[Handler](http://developer.android.com/reference/android/os/Handler.html)（高级）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T02:29:30.247

杰雷蒙德！非常感谢我创建了一个 Xthead 类，像这样扩展 Thread

```
class XThread extends Thread
{
    public int ids[];
    public ImageView icon;
    public int dem,n;
    XThread(int[] ids ,ImageView icon)
    {
        this.ids = ids;
        this.icon= icon;
        dem=0;
        n = ids.length;
    }

    public void run()
    {
        while(true)
        {
            try
            {
                Thread.sleep(500);
            handle.post(new Runnable()
            {
                public void run()
                {
                    ++dem;
                    icon.setImageResource(ids[dem]);
                    if(dem==n-1)
                        dem=0;
                }
            });
            }
            catch(Exception e)
            {

            }
        }
    }
} 
```

在 onCreate() 函数中

```
XThread x = new XThread(IDs,list);
        x.start(); 
```

# ruby-on-rails - 如何消除来自 Rails 插件的某些弃用警告？

> ID：10250378
> 
> 赞同：1
> 
> 时间：2012-04-20T16:56:30.120
> 
> 标签：ruby-on-rails, ruby-on-rails-2

有没有办法逐行抑制弃用警告？我正在开发一个旧应用程序，该应用程序有一个导致弃用警告的插件。我宁愿不手动更改该插件的代码。但我可以将其更改为不显示警告。

我的测试看起来像垃圾，带有所有这些警告。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T19:15:51.477

讨厌回答我自己的问题，但这似乎可以解决问题：

```
ActiveSupport::Deprecation.silence do
  # no warnings for any use of deprecated methods here
end 
```

# php - 使用正则表达式从 XML 中提取

> ID：10250381
> 
> 赞同：0
> 
> 时间：2012-04-20T16:56:39.040
> 
> 标签：php, regex

需要一个正则表达式来捕获嵌套在目标标记中的所有内容。

```
<?xml version="1.0" encoding="utf-8"?>
<data>
<target>
"<x id="c400c8394f0a"  pid="NLCaption" name="NLCaption" />Caption"
</target>

<target />

<target><x id="a1e6b03cb682"  pid="NLSheets" name="NLSheets" />Sheets"</target>

</data> 
```

感谢 Brettz，他帮助我编写了以下正则表达式

```
$pattern = "@<target(?:\s.*?)?>(.*?)</target\s*>@s"; 
```

这个正则表达式可以完成工作并帮助我获取所有内容。但唯一的问题是它也会捕获 `<target />`标签。

我想修改不捕获未配对标签的正则表达式。IE`<target />`

请帮我

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T17:05:28.200

使用[SimpleXML](http://www.php.net/manual/en/simplexml.examples-basic.php)

```
$data = new SimpleXMLElement($xmlstr);
echo $data->target[0]; 
```

[这是将 SimpleXML 与您的 XML 一起使用的示例](http://codepad.org/AorEi4iJ)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-21T06:51:36.583

```
$tagname = 'target';
$pattern = "@<$tagname(?:\s.*?!/)?>(.*?)</$tagname\s*>@s"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T17:01:11.570

```
$pattern = "(?<=<target>).+(?=</target>)"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T17:22:23.043

您可以将第一部分的结尾更改为仅允许空格而不允许其他字符：

`<target\s*>(.*?)</target\s*>`

xml 解析器几乎可以肯定仍然是正确的长期解决方案，但这是让您的代码工作的快速方法。

# node.js - Nodejs 中的 Couchdb

> ID：10250383
> 
> 赞同：7
> 
> 时间：2012-04-20T16:56:44.313
> 
> 标签：node.js, couchdb

我刚刚开始使用 nodejs 中的 couchdb。我正在寻找可以帮助我入门或至少一些代码行的教程或文章。我不想使用任何模块进行数据库抽象，因为这会破坏学习的目的。我正在寻找与 Couch 一起使用的自己的模块，据我了解，这可以通过请求模块[https://github.com/mikeal/request](https://github.com/mikeal/request)轻松完成，但我还没有找到任何相关信息。谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T19:18:33.380

我写了一篇关于这个的博客文章，希望对你有帮助：

[http://writings.nunojob.com/2011/09/getting-started-with-nodejs-and-couchdb.html](http://writings.nunojob.com/2011/09/getting-started-with-nodejs-and-couchdb.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-07T14:13:14.037

查看 Nano：[https ://github.com/dscape/nano](https://github.com/dscape/nano)

这正是你想要做的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-25T21:29:51.823

查看此模块：[https](https://github.com/cloudhead/cradle) ://github.com/cloudhead/cradle这对于在 nodejs 上开始使用 couchdb 非常有帮助。只需看一下github上的主要自述文件

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-02-13T17:05:01.693

Nano 是与 CouchDB 交互的最简单方法。 [http://www.tutorialindustry.com/node-js-couchdb-tutorial-for-beginners](http://www.tutorialindustry.com/node-js-couchdb-tutorial-for-beginners)

您也可以选择 Cradle（Node.js 的高级缓存 CouchDB 客户端）- [https://github.com/cloudhead/cradle](https://github.com/cloudhead/cradle)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-09T06:52:58.437

对于开始使用 CouchDB 时没有很好的中间像`cradle`，我推荐[*CouchDB: The Definitive Guide*](http://guide.couchdb.org/editions/1/en/index.html)。在开发[CouchQueue](https://github.com/jdotjdot/couchQueue)时，它​​给了我极大的帮助，这是一个用于从 CouchDB 数据库中创建队列的 Node.js 模块。

# asp.net - 如何更新使用 MD5 加密并存储到 sql server 2005 数据库中的密码

> ID：10250384
> 
> 赞同：-4
> 
> 时间：2012-04-20T16:57:01.040
> 
> 标签：asp.net, c#-4.0

我创建了一个用户帐户表。其中有两个字段 Login 存储用户 ID 和 Password 以加密格式存储密码。密码在注册时使用 MD5 散列加密。如果用户想更改他的密码，他将如何将其更改到数据库中。我尝试使用简单的更新语句更新密码，但没有成功。

我的代码是：

```
//Code

public int Changep(string strLogin, string strPassword, string newpass)
    {
        //Create a connection
        string cs = "data source=DELL-PC;initial catalog=project;user id=sa;password=pass";
        SqlConnection objConn = new SqlConnection(cs);

        // Create a command object for the query
        string strSQL = "UPDATE tblLogins SET Password= @Password WHERE Login=@Username AND Password = @Password2";

        SqlCommand objCmd = new SqlCommand(strSQL, objConn);

        //Create parameters
        SqlParameter paramUsername;
        paramUsername = new SqlParameter("@Username", SqlDbType.VarChar, 25);
        paramUsername.Value = strLogin;
        objCmd.Parameters.Add(paramUsername);

        //Encrypt the password
        MD5CryptoServiceProvider md5Hasher = new MD5CryptoServiceProvider();
        byte[] hashedBytes;
        UTF8Encoding encoder = new UTF8Encoding();
        hashedBytes = md5Hasher.ComputeHash(encoder.GetBytes(strPassword));
        SqlParameter paramPwd;
        paramPwd = new SqlParameter("@Password", SqlDbType.Binary, 16);
        paramPwd.Value = hashedBytes;
        objCmd.Parameters.Add(paramPwd);

        //Encrypt the old password
        MD5CryptoServiceProvider md5Hasher2 = new MD5CryptoServiceProvider();
        byte[] hashedBytes2;
        UTF8Encoding encoder2 = new UTF8Encoding();
        hashedBytes2 = md5Hasher2.ComputeHash(encoder2.GetBytes(strPassword));
        SqlParameter paramPwd2;
        paramPwd2 = new SqlParameter("@Password2", SqlDbType.Binary, 16);
        paramPwd2.Value = hashedBytes;
        objCmd.Parameters.Add(paramPwd2);
        int iResults;
        //Insert the record into the database
        try
        {
            objConn.Open();
            //We use execute scalar, since we only need one cell
            iResults = Convert.ToInt32(objCmd.ExecuteScalar().ToString());
            if(iResults==1)
                return PassUpdated;
            else
                return Updatefailed;
        }
        catch
        {
            return Updatefailed;
        }
        finally
        {
            objConn.Close();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T17:08:58.560

您正在哈希`strPassword`旧密码和新密码。我认为您需要提示输入旧密码和新密码，然后将旧密码散列到您的`WHERE`子句中。

# jquery - 像手风琴一样的 jQuery 子菜单

> ID：10250387
> 
> 赞同：0
> 
> 时间：2012-04-20T16:57:22.857
> 
> 标签：jquery, menu, toggle, accordion

在网页[oshadi-yoga.ch](http://oshadi-yoga.ch)上，我想获得一个带有如下列表的导航菜单：

```
<ul>
    <li class="section-title">Yoga
        <ul style="display: none;">
            <li><a href="/">Approach</a></li>
            <li><a href="/">Asanas</a></li>
            <li><a href="/">Yoga</a></li>
            <li><a href="/">Kirtan</a></li>
        </ul>
    </li>
</ul> 
```

我写了一些 jquery 来获得手风琴效果。如果您单击第一级，则第二个列表将以切换效果打开：

```
 $(function() {
        $("#lbar li.section-title ul").hide();
        $("#lbar li.section-title").click(function() {
            $(this).find("ul").toggle();
        });
    });

    $(function() {
        $("#lbar li.section-titleact ul").show();
        $("#lbar li.section-titleact").click(function() {
            $(this).find("ul").toggle();
        });
    });

    $(function() {
        $("#lbar li.section-titleact ul li a").click(function() {
            $("#lbar li.section-titleact ul").css("display", "block");
        });
    }); 
```

现在，当您打开页面时，子菜单会被隐藏。这是对的。您单击一个菜单项并显示子菜单。这是对的。第一级没有指向页面的链接。然后您单击页面打开的第二级中的链接，但第二级`<ul>`隐藏了几秒钟。这是错误。

不幸的是，我无法更正 jquery 脚本。有人可以帮助我或有我需要的菜单示例吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T17:25:47.160

我应该稍微重写一下代码

```
<ul>
    <li class="section-title"><span>Yoga</span>
        <ul style="display: none;">
            <li><a href="/">Approach</a></li>
            <li><a href="/">Asanas</a></li>
            <li><a href="/">Yoga</a></li>
            <li><a href="/">Kirtan</a></li>
        </ul>
    </li>
</ul> 
```

添加了一个跨度。

jQuery：

```
$('.section-title > span').on('click', function()
{
    $(this).siblings('ul').slidetoggle();
}); 
```

我希望这会有所帮助（或者我有点误解了这个问题？）

# android - 是否可以在没有用户交互的情况下访问 android [enable() 或 disable()] 中的蓝牙？

> ID：10250390
> 
> 赞同：5
> 
> 时间：2012-04-20T16:57:41.030
> 
> 标签：android, bluetooth

我正在开发一个 Android 应用程序，它将访问蓝牙以启用和禁用它，而无需任何用户交互。有人可以帮我怎么做吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-20T17:05:24.587

您可以使用蓝牙适配器来做到这一点：

```
 BluetoothAdapter.getDefaultAdapter().disable();
    BluetoothAdapter.getDefaultAdapter().enable(); 
```

并将此权限添加到清单：

```
 <uses-permission android:name="android.permission.BLUETOOTH_ADMIN" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-05T04:51:30.773

是的。

```
private static BluetoothAdapter getBA(){
    return BluetoothAdapter.getDefaultAdapter();
}

/*Methode startet das Bluetooth Modul
 */
public static void BT_ON(){
    BA = getBA();
    BA.enable();
}

public static void BT_STATUS(){
    BA = getBA();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T17:02:46.540

AFAIU，你需要[BluetoothAdapter.enable()](http://developer.android.com/reference/android/bluetooth/BluetoothAdapter.html#enable%28%29) & [BluetoothAdapter.disable()](http://developer.android.com/reference/android/bluetooth/BluetoothAdapter.html#disable%28%29)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T17:06:41.063

要在没有用户交互的情况下以编程方式启用/禁用蓝牙，请使用以下代码：

```
BluetoothAdapter mBluetoothAdapter = BluetoothAdapter.getDefaultAdapter();    
if (!mBluetoothAdapter.isEnabled()) { //Disable it if enabled
    Intent localIntent;
    localIntent = new Intent();
    localIntent.setClassName("com.android.settings", "com.android.settings.widget.SettingsAppWidgetProvider");
    localIntent.addCategory("android.intent.category.ALTERNATIVE");
    localIntent.setData(Uri.parse("4"));
    getBroadcast(paramContext, 0, localIntent, 0).send();
} else { //Enable if disabled
    Intent localIntent;
    localIntent = new Intent();
    localIntent.setClassName("com.android.settings", "com.android.settings.widget.SettingsAppWidgetProvider");
    localIntent.addCategory("android.intent.category.ALTERNATIVE");
    localIntent.setData(Uri.parse("4"));
    getBroadcast(paramContext, 0, localIntent, 0).send();
} 
```

在您的*Manifest.xml*文件中：

```
<uses-permission android:name="android.permission.WRITE_SETTINGS"/>
<uses-permission android:name="android.permission.WRITE_SECURE_SETTINGS"/> 
```

# javascript - jquery使用按钮上下切换div

> ID：10250392
> 
> 赞同：0
> 
> 时间：2012-04-20T16:58:01.847
> 
> 标签：javascript, jquery

希望你一切都好......这是我目前的jquery代码 - 只将div向上（而不是向下）：

```
$("#thedacbutton").click(function(){ 
    $(".thedacALLCONTENT").animate({"top":"-=558px"}, 400, 'linear');
    }); 
```

我希望“thedacALLCONTENT”在单击“thedacbutton”时向上移动，并在再次单击（向下）后移回其原始位置。就像一个切换...非常感谢任何帮助，谢谢-汤姆

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T17:02:17.560

我不是 100% 确定.. 你在用这个非常少的细节做什么。但你可以尝试类似

```
var flag = true;
$("#thedacbutton").click(function(){ 
    if(flag){
     $(".thedacALLCONTENT").animate({"top":"-=558px"}, 400, 'linear');
     flag = false;
    }else{
     $(".thedacALLCONTENT").animate({"top":"+=558px"}, 400, 'linear');
     flag = true;
    }
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T17:05:37.833

使用[slideToggle()](http://api.jquery.com/slideToggle/)怎么样？

```
$("#thedacbutton").click(function(){ 
    $(".thedacALLCONTENT").slideToggle();
}); 
```

快速**[jsFiddle 示例](http://jsfiddle.net/j08691/xwqQ8/)**。

# c# - 将文本框值添加到会话

> ID：10250393
> 
> 赞同：1
> 
> 时间：2012-04-20T16:58:09.260
> 
> 标签：c#, asp.net, session

我正在动态创建文本框。我想获取这些文本框值并将它们存储在会话中，这样我就可以将它们存储在数据库中。我怎样才能做到这一点？

所以，我存储动态创建的文本框值的方式就是这种方式。

```
List<Control> _controlsList;
controlsList = new List<Control>();     // object holds the controls 
```

现在，在我的函数中，我以这种方式添加它们。请记住，我有 3 个以上的文本框

```
if (i < _applicant.Fields.Count)
                _applicant.AddAnswer((_controlsList[i] as TextBox).Text);
            else
                _application.AddAnswer((_controlsList[i] as TextBox).Text);
            _sessions.ApplicationSession = ((_controlsList[i] as TextBox).Text);
           // Session["TextboxValue"] = ((_controlsList[i] as TextBox).Text); 
```

我有一个会话类

```
 public class JobApplicantSession
 {

   // public JobApplication ApplicationSession
    public string ApplicationSession
    {

      get {if (HttpContext.Current.Session["Application"] != null)
              // return (JobApplication)HttpContext.Current.Session["Application"];
                 return (string)HttpContext.Current.Session["Application"];
           return null; }

      set{ HttpContext.Current.Session["Application"] = value; }
    }

} 
```

然后我可以添加，但是当我从另一个类中检索它们时，我只会得到最后添加的文本框。我需要能够循环，所以我可以将这些文本框值添加到数据库中，但我不能循环通过一个对象

```
var value = HttpContext.Current.Session["Application"]; //will get last textbox value 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T17:04:45.650

您需要在存储`Session`桶中存储一个可以添加和删除的复杂对象。在您的情况下，理论上您可以只存储`List<Control>`in 会话，然后在您想从中添加/删除时将其转换回 List 。

但是，我要指出，可能有更好的方法来做你似乎想要做的事情。会话在整个应用程序的页面之间进行；这似乎是一个更加本地化的数据持久性问题，这意味着您应该使用数据库来跟踪临时状态，或者您应该使用 ViewState。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T17:06:18.280

您需要以某种列表结构将它们存储在会话中。

```
var values = new List<string>();
// add each text box value to the list.

HttpContext.Current.Session["Application"] = values;

//To get them back
var retrieved = HttpContext.Current.Session["Application"] as List<string>; 
```

您可能需要稍微使用一下您使用的数据类型，有些不能很好地序列化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T17:07:54.913

更改您的会话课程，例如

```
public class JobApplicantSession
 {

   // public JobApplication ApplicationSession
    public string ApplicationSession
    {

      get {   if (HttpContext.Current.Session["Application"] == null)
              HttpContext.Current.Session["Application"] = new List<string>();
           return (List<string>)HttpContext.Current.Session["Application"];
      }

    }

} 
```

并将答案添加到列表

```
 _sessions.ApplicationSession.Add((_controlsList[i] as TextBox).Text); 
```

你现在可以循环了..

```
foreach(string answer in _sessions.ApplicationSession )
{
...
} 
```

# wcf - 调用托管 wcf 服务方法时出错（服务脱机或无法访问）

> ID：10250401
> 
> 赞同：0
> 
> 时间：2012-04-20T16:58:34.670
> 
> 标签：wcf, iis, localhost

我的 WCF 服务托管在 IIS 上。它工作正常，但是当我通过 WCFTestClient 对其进行测试时，它突然开始出现以下错误。

**"调用服务失败。可能原因：服务下线或无法访问；客户端配置与代理不匹配；现有代理无效。详细请参考堆栈跟踪。您可以尝试通过启动来恢复一个新的代理，恢复到默认配置，或刷新服务。”**

我会感谢一百万次的解决方案。这对我来说已经成为脖子上的痛苦。

谢谢， 里兹万法鲁克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T15:38:55.650

我找到了答案，伙计们。实际上我最近在 iis 6.0 中安装了 URL 重写模块。在该错误开始传播之后。我在 iis 中卸载了 URL 重写模块，一切都开始像魅力一样工作。我使用的是 iis 6.0。

# php - FancyBox 中未显示 Facebook 赞按钮？

> ID：10250402
> 
> 赞同：1
> 
> 时间：2012-04-20T16:58:43.627
> 
> 标签：php, facebook, wordpress, facebook-like

我在一个页面上应用了 Facebook [like 按钮](http://en.wikipedia.org/wiki/Like_button)，我在该页面上显示了来自我的 WordPress 管理员的所有帖子。我应用了 Facebook *like 按钮*代码，它在这里工作正常，但是当用户点击帖子时，该帖子在[FancyBox](http://fancybox.net/)中打开，我正在应用 Facebook *like button*，但 Facebook *like 按钮*没有在那里创建。我怎样才能做到这一点？

这是我用来在两个地方创建 Facebook *like 按钮的代码：*

```
<div id="fb-root"></div>
<script>
    (function(d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id))
            return;
        js = d.createElement(s);
        js.id = id;
        js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=145332828885141";
        fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));
</script>

<div class="fb-like"
     data-href="https://www.facebook.com/pages/PHPsyms/130379690383205"
     data-send="false"
     data-layout="button_count"
     data-width="450"
     data-show-faces="false"></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:38:51.707

它将在 FancyBox 中工作：

```
<iframe
    src="http://www.facebook.com/plugins/like.php?href=URL_HERE%2F&amp;layout=button_count&amp;show-faces=false&amp;width=450&amp;action=like&amp;font=arial&amp;colorscheme=light"
    scrolling="no"
    frameborder="0"
    allowTransparency="true"
    style="border:none;
    overflow:hidden;
    width:110px;
    height:px">
</iframe> 
```

# jquery - jQuery Chosen Plugin - 隐藏已经选择的值

> ID：10250403
> 
> 赞同：1
> 
> 时间：2012-04-20T16:58:45.953
> 
> 标签：jquery, jquery-chosen

希望有人可以提供帮助。我目前有一个用 PHP 组成的选择下拉列表。我正在使用 Chosen 插件将其转换为具有多种选择的漂亮标签云类型设置。

一些选项条目具有“隐藏”类。这些应设置为 display:none

然后当我加载选择时，任何具有隐藏类的选项条目确实不可见，除非它们被选中，此时它们会显示出来。

有谁知道如何让选择不显示已选择的某些元素？

[http://jsfiddle.net/Hgfub/1/](http://jsfiddle.net/Hgfub/1/)

谢谢

*更新*以更详细地解释我的要求：在 select 元素中隐藏某些选定选项只是为了向用户隐藏该选项，即使我们希望在 php post 值中传递回选定的值。这不是一个安全设置，因为他们仍然会在源代码中看到它，它只是一个视觉上的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-31T13:37:27.170

答案在 GitHub 上提供。

解决方案在这里[GitHub 响应](https://github.com/harvesthq/chosen/issues/637#issuecomment-5943882)

具体来说，修改 SelectParser 对象以测试添加的参数。你可以做这样的事情。

```
<option selected data-hidden="true">Some Option</option> 
```

然后在选择中包含此选项之前测试是否存在：

```
if (option.text !== "" && option.getAttribute("data-hidden") !== "true") { 
```

您可以在 SelectParser.prototype.add_option 函数中找到该测试。

# scala - scala cake pattern - 我可以有多层蛋糕吗？

> ID：10250404
> 
> 赞同：5
> 
> 时间：2012-04-20T16:58:46.027
> 
> 标签：scala

假设我的应用程序中有两个依赖项，一个连接到某个 pub 子系统，一个连接到数据库。我可以做类似的事情

```
trait DB {
    def lookup(query:String):String
}

trait PubSub {
    def subscribe(key:String, callback:String => Any)
} 
```

然后我可以像这样写我的逻辑

```
trait Functionality { this:DB with PubSub => 
    def doSomething() {
        val key = lookup("get key")
        subscribe(key, data => println(data))
    }
} 
```

然后我的应用程序可以像

```
object Awesome extends App {

    object repository extends Functionality with DB with PubSub {
        def lookup(query:String) = "some key"
        def subscribe(key:String, callback:String => Any) {
            scala.concurrent.ops.spawn { while(true) { callback(key) ; Thread.Sleep(1000) } } 
        }
    }
    repository.doSomething()
} 
```

世界上一切都很好。

但是，如果我想要连接到在同一个应用程序中共享相同数据库实现的两个 pub 子系统怎么办？

我想做类似的事情

```
object Awesome2 extends App {
    object repository extends DB {
        def lookup(query: String): String = "some other key"

        object connection1 extends Functionality with PubSub with DB {
            def subscribe(key: String, callback: (String) => Any) {
                scala.concurrent.ops.spawn { while(true) { callback(key.toUpperCase) ; Thread.sleep(1000) } }
            }
        }

        object connection2 extends Functionality with PubSub with DB {
            def subscribe(key: String, callback: (String) => Any) {
                scala.concurrent.ops.spawn { while(true) { callback(key.toLowerCase) ; Thread.sleep(1000) } }
            }
        }
    }
} 
```

第二层蛋糕中的对象（隐含地？）在父级别的数据库实现中啜饮。

但是scala编译器告诉我

```
error: object creation impossible, since method lookup in trait DB of type (query:String) String is not defined
object connection2 extends Functionality with PubSub with DB { 
```

如果我执行以下操作，那么它会执行我想要的操作

```
object Awesome3 extends App {
    object repository extends DB {
        override def lookup(query: String): String = "some other key"

        object connection1 extends Functionality with PubSub with DB {
            def subscribe(key: String, callback: (String) => Any) {
                scala.concurrent.ops.spawn { while(true) { callback(key.toUpperCase) ; Thread.sleep(1000) } }
            }

            def lookup(query: String): String = repository.lookup(query)
        }

        object connection2 extends Functionality with PubSub with DB {
            def subscribe(key: String, callback: (String) => Any) {
                scala.concurrent.ops.spawn { while(true) { callback(key.toLowerCase) ; Thread.sleep(1000) } }
            }

            def lookup(query: String): String = repository.lookup(query)
        }
    }
    repository.connection1.doSomething()
    repository.connection2.doSomething()
} 
```

但这有点乱

我可以添加这个特征

```
trait DB_Base extends DB {

    private val db:DB = this

    trait DB_Layer extends DB {
        def lookup(query:String):String = db.lookup(query)
    }
} 
```

然后下面的作品

```
object Awesome4 extends App {
    object repository extends DB_Base {
        override def lookup(query: String): String = "some other key"

        object connection1 extends Functionality with PubSub with DB_Layer {
            def subscribe(key: String, callback: (String) => Any) {
                scala.concurrent.ops.spawn { while(true) { callback(key.toUpperCase) ; Thread.sleep(1000) } }
            }
        }

        object connection2 extends Functionality with PubSub with DB_Layer {
            def subscribe(key: String, callback: (String) => Any) {
                scala.concurrent.ops.spawn { while(true) { callback(key.toLowerCase) ; Thread.sleep(1000) } }
            }
        }
    }    
    repository.connection1.doSomething()
    repository.connection2.doSomething()
} 
```

所以现在我有两层。如何获得三个？我觉得我正在失去剧情。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T19:29:41.950

评论不足以解释它，所以这里的答案基本上是说：“不要那样做！” 并提出替代方案。

您遇到的关键问题是您希望拥有某些功能的多个副本，但您没有任何方法可以按名称（仅按类型）引用它。解决方案是：给它一个名字。

让我们来看看你的双层蛋糕图案。

```
trait Foo { def foo(s: String): String }
trait Bar { def bar(s: String, f: String => Any): Any }
trait Bippy { this: Foo with Bar =>
  def bip(s: String) = bar(foo(s),println)
} 
```

好的，太好了，我们可以混入`Bippy`任何实现的东西，`Foo with Bar`我们将能够`bip`。但是，如果`Foo`并且`Bar`在不同的层次上实施呢？如果我们改为

```
trait Bippy {
  def myFoo: Foo
  def myBar: Bar
  def bip(s: String) = myBar.bar(myFoo.foo(s), println)
} 
```

这最初看起来更尴尬。（确实如此。）但它现在可以让你混搭，而不是被迫以越来越尴尬的方式结块。例如：

```
object Foozle extends Foo { theFoo =>
  def foo(s: String) = s.toUpperCase
  trait BippyImpl extends Bippy { this: Bar =>
    def myFoo = theFoo
    def myBar = this
  }
  object Woozle1 extends BippyImpl with Bar {
    def bar(s: String, f: String => Any) = f(s)
  }
  object Woozle2 extends BippyImpl with Bar {
    def bar(s: String, f: String => Any) = f(s.reverse)
  }
} 
```

现在，您可以在任何地方混合和匹配任何功能；唯一的缺点是你必须命名它。（这里我们创建了一个嵌套的 trait BippyImpl 来拆分 Woozles 的公共部分，但我们可以直接这样做。）

此外，您不会混入原始方法名称；您必须编写代理或引用成员变量。

它错过了蛋糕图案的一些不错的方面，但根据我的经验，它最终比一大堆蛋糕层要清晰得多。现在您可以看到，您可以随意嵌套它，并在任何需要的地方填写您想要的详细信息。

# java - 跟随路径算法

> ID：10250409
> 
> 赞同：-1
> 
> 时间：2012-04-20T16:58:56.010
> 
> 标签：java, algorithm

你能给我一个关于快速跟随路径算法的初学者教程的链接吗？

路径应包括曲线，并将在应用程序中进行硬编码。我不想让曲线完全随机。它们可以是直径不同的半圆或四分之一圆。

实体应在给定距离内遵循此路径（在与路径正交的线上）

实体在这个世界中被表示为盒子。每次更新时，他们都会得到乘以速度的时间增量参数。

**这就是我想要实现的。**

![在此处输入图像描述](../Images/536df3b7a0ea6b92e8e3fd820f8015be.png)

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T17:11:42.667

你可以在 Google 上搜索 A*、Dijkstra 算法、Bellman-Ford 算法、Floyd 和 Warshall……有很多教程——简单游戏中最常用的大概是 A*。 [关于寻路的维基百科](http://en.wikipedia.org/wiki/Pathfinding)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T17:35:29.207

你知道在你链接的塔防游戏中，爬行路径总是基于地图是静态的。我愿意打赌它在地图本身中被硬编码为一系列曲线，您可以根据需要对其进行插值。

# javascript - 优化显示简单项目列表的模型/视图

> ID：10250412
> 
> 赞同：0
> 
> 时间：2012-04-20T16:59:13.020
> 
> 标签：javascript, backbone.js

我几乎完成了一个backbone.js 应用程序，我想知道我选择的用于显示项目表的方法是否是正确的方法。

我有显示一些项目的代码如下：

```
var items = new Items();

items.fetch({
    success: function(){
        var itemsView = new ItemsView(items);
        itemsView.$el.appendTo('#content-wrapper');
        // Here I run some functions that
        // remove all elements of the prev page
    }
});

window.Item = Backbone.Model.extend({});

window.Items = Backbone.Collection.extend({
    model: Items,
    url: 'items'
});

window.ItemsView = Backbone.View.extend({
    tagName: 'table',
    id: 'items',
    initialize: function(items) {
        _.bindAll(this, 'render');
        this.items = items;
        this.items.bind('reset', this.render);
        this.render();
    },
    render: function () {
        var self = this;
        this.items.each(function (item) {
            self.addItem(item);
        });
        return this;
    },
    addItem: function(item) {
        var itemView = new window.ItemView(item);
        this.$el.append(itemView.el);
    }
});

window.ItemView = Backbone.View.extend({
    tagName: 'tr',
    initialize: function (item) {
        _.bindAll(this, 'render', 'serverChange');
        this.item = item;
        // Note that I am using Backbone.IO, it has a slightly 
        // different sync functions to support Socket.IO
        this.item.ioBind('update', this.serverChange, this);
        this.render();
    },
    serverChange: function(data){
        this.item.set(data);
        this.render();
    },
    render: function () {
        this.$el.html(_.template('<td><%=name%></td>', this.item.toJSON()));
        return this;
    }
}); 
```

## 问题

我面临的问题如下。这段代码生成的 HTML 非常丑陋。

它为我的模型中的每个变量创建了一个 HTML 属性。它看起来像这样：

```
<table id="items">
    <tr name="Awesome Product" id="75483920743829930" _id="75483920743829930" type="gel" price="200.00" stock="5">
        <td>Awesome Product</td>
    </tr>
</table> 
```

这不是我想要的。

## 为什么我选择这种方法

我使用这种方法是因为每个项目 ( `tr`) 都有它自己的视图。所以当一个模型改变时，它不需要重新渲染整个表格，只需要重新渲染一个视图。

有没有更优雅的方法来解决这个问题，而不会创建混乱的 HTML。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T00:35:20.060

您获得所有这些额外属性的原因是因为您将模型直接传递给构造函数，而不是将其作为模型传递。Backbone 正在读取模型的属性并将它们作为 html 属性添加到视图中。

通常你会像这样传入模型（[直接来自 Backbone 文档](http://documentcloud.github.com/backbone/#View-constructor)）

```
var doc = Documents.first();

new DocumentRow({
  model: doc,
  id: "document-row-" + doc.id
}); 
```

看看这个[jsFiddle](http://jsfiddle.net/hqK9d/2/)。我稍微修改了您的视图以使用模型，现在它在没有那些额外的 html 属性的情况下呈现。

# php - 如何导出带有特殊字符的 CSV？

> ID：10250414
> 
> 赞同：2
> 
> 时间：2012-04-20T16:59:15.517
> 
> 标签：php, sql, fwrite, export-to-csv

我正在尝试从数据库中导出一些信息，但是当创建 CSV 文件时，特殊字符看起来像这样`CategorÃ­a`

这是我用来导出的代码

```
function exportemail() {
global $wpdb;
    $content = "No.,Nombre,Empresa,Categoría,Estado de Prospecto,Correo,Teléfono,Dirección,Referido por,País,Sitio web,Contacto Alternativo,Trabajo de Contacto Alternativo,Correo de Contacto Alternativo,Teléfono de Contacto Alternativo,Dirección de Contacto Alternativo,País de Contacto Alternativo,Sitio Web de Contacto Alternativo,Notas,Rung";

    if(trim($_GET['tab']) != "")
    {
        $sql = "SELECT * FROM ".$wpdb->prefix."crm WHERE
              category LIKE '%".$wpdb->escape($_GET['tab'])."%'
              ORDER BY name";
    }
   elseif (trim($searcharea) != '') {
        $sql = "SELECT * FROM ".$wpdb->prefix."crm WHERE
            name LIKE '%".$wpdb->escape($_GET['q'])."%'
            OR last_name LIKE '%".$wpdb->escape($_GET['q'])."%'
            OR category LIKE '%".$wpdb->escape($_GET['q'])."%'
            OR business LIKE '%".$wpdb->escape($_GET['q'])."%'
            OR email LIKE '%".$wpdb->escape($_GET['q'])."%'
            OR phone LIKE '%".$wpdb->escape($_GET['q'])."%'
            OR notes LIKE '%".$wpdb->escape($_GET['q'])."%'
            OR rung LIKE '%".$wpdb->escape($_GET['q'])."%'
            ORDER BY name";
    } else {
        $sql = "SELECT * FROM ".$wpdb->prefix."crm ORDER BY name";
    }

    $results = $wpdb->get_results($sql);
        $c = 1;
        foreach ($results as $row) {

        $content .= "\n".$c.",".str_replace(","," -",
        $row->name." ".
        $row->last_name).",".str_replace(","," -",
        $row->business).",".str_replace(","," -",
        $row->category).",".str_replace(","," -",
        $row->rank).",".str_replace(","," -",
        $row->email).",".str_replace(","," -",
        $row->phone).",".str_replace(","," -",
        $row->address).",".str_replace(","," -",
        $row->referral).",".str_replace(","," -",
        $row->country).",".str_replace(","," -",
        $row->website).",".str_replace(","," -",
        $row->altern_last_name." ".
        $row->altern_last_name).",".str_replace(","," -",
        $row->altern_business).",".str_replace(","," -",
        $row->altern_email).",".str_replace(","," -",
        $row->altern_phone).",".str_replace(","," -",
        $row->altern_address)." ".str_replace(","," -",
        $row->altern_country).",".str_replace(","," -",
        $row->altern_website).",".str_replace(","," -",
        $row->notes).",".str_replace(","," -",
        $row->rung);

        $c++;
    }

    $file = "../wp-content/plugins/email.csv";
    chmod($file,0777);
    $fp = fopen($file,'w');
    fwrite($fp,$content);
    fclose($fp);
    if (file_exists($file)) {
        header('Content-Description: File Transfer');
        header('Content-Encoding: UTF-8');
        header('Content-type: text/csv; charset=UTF-8');
        header('Content-Disposition: attachment; filename='.basename($file));
        echo "\xEF\xBB\xBF"; // UTF-8 BOM
        header('Content-Transfer-Encoding: binary');
        header('Expires: 0');
        header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
        header('Pragma: public');
        header('Content-Length: ' . filesize($file));
        ob_clean();
        flush();
        readfile($file);
        unlink($file);
        exit;
    } 
```

}

我一直在尝试使用 htmlspecialchars 来解决这个问题，但它不起作用，我不确定问题是我放置不正确还是其他问题......因为我不是专家我'我还是一样，有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-20T17:44:48.587

我可以看到您已经包含了魔术字节顺序标记（BOM）。不幸的是，它不是内容的一部分。

走线

```
echo "\xEF\xBB\xBF"; // UTF-8 BOM 
```

并将其放在您的 readfile() 前面

```
...
echo "\xEF\xBB\xBF"; // UTF-8 BOM
readfile($file);
... 
```

# c# - 当一组特定情况为真时，我如何将事件定义为发生？

> ID：10250416
> 
> 赞同：0
> 
> 时间：2012-04-20T16:59:18.653
> 
> 标签：c#, events, delegates

长话短说，我有两个布尔变量，分别称为 FirstBool 和 SecondBool。我有一个程序，它使用两个委托来异步运行两种方法。我`Console.ReadLine()`用来在子线程运行时使父线程保持活动状态。

当第一个方法完成时，FirstBool 设置为 true。当第二个方法完成时，SecondBool 设置为 true。

长话短说，我想将我的事件定义为“`FirstBool`并且`SecondBool`都是真的”，并在此时关闭我的程序。我能看到的唯一选择是轮询两个布尔值，直到它们都为真，然后关闭程序，轮询很糟糕。

我的代码如下：

```
class Program
{
    private delegate void MyDelegate();

    private static bool FirstBool { get; set; }
    private static bool SecondBool { get; set; } 

    static void Main(string[] args)
    {
        FirstBool = false;
        SecondBool = false;

        MyDelegate firstDelegate = new MyDelegate(FirstMethod);
        MyDelegate secondDelegate = new MyDelegate(SecondMethod);

        AsyncCallback myCallback = new AsyncCallback(CallbackMethod);

        firstDelegate.BeginInvoke(myCallback, "Zip");
        secondDelegate.BeginInvoke(myCallback, "Line");

        Console.ReadLine();
    }

    private static void CallbackMethod(IAsyncResult result)
    {
        switch (result.AsyncState.ToString())
        {
            case "Zip":
                FirstBool = true;
                break;
            case "Line":
                SecondBool = true;
                break;
        }

        Console.WriteLine("Callback Method");
    }

    private static void FirstMethod()
    {
        Console.WriteLine("First Method");
    }

    private static void SecondMethod()
    {
        Console.WriteLine("Second Method");
    }
} 
```

所以，长话短说，我如何创建一个定义为“`FirstBool`是真的并且`SecondBool`是真的”的事件并在这个事件发生时运行一个方法？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T17:09:40.810

如果您可以访问 .NET 4，那么您可以使用 Task Parallel Library 轻松完成此任务：

```
var taskOne = Task.Factory.StartNew(() =>
   {
       // Do Stuff
   });

var taskTwo = Task.Factory.StartNew(() =>
   {
       // Do Other Stuff
   });

Task.WaitAll(taskOne, taskTwo);

// Quit 
```

如果您使用的是旧版本的 .NET，则只需调用该`EndInvoke`方法即可等待异步调用完成：

```
 SomeDelegate x = SomeMethod;
 SomeDelegate y = SomeOtherMethod;

 var iar1 = x.BeginInvoke(null, null);
 var iar2 = y.BeginInvoke(null, null);

 // Program would still be executing here...

 x.EndInvoke(iar1);
 y.EndInvoke(iar2);

 // Quit 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T17:02:48.607

在每个布尔值的设置器中，检查它们是否都为真。如果是，您可以运行您的方法。

这是一个如何做到这一点的示例：

```
public static object syncLock = new object();

private static bool myFirstBool;
private static bool mySecondBool;
private static bool FirstBool {
    get { return myFirstBool; }
    set {
        lock (syncLock) {
            if (value && mySecondBool) {
                CallbackMethod(null);
            }
            myFirstBool = value;
        }
    }
}
private static bool SecondBool {
    get { return mySecondBool; }
    set {
        lock (syncLock) {
            if (value && myFirstBool) {
                CallbackMethod(null);
            }
            mySecondBool = value;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T17:04:04.410

这是实现目标的一种非常困难且容易出错的方法。

看看这篇文章，它将帮助你以更安全、更好的方式完成你想做的事情

[http://msdn.microsoft.com/en-us/library/system.threading.eventwaithandle.aspx](http://msdn.microsoft.com/en-us/library/system.threading.eventwaithandle.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T17:12:47.797

For the specific application, I would stronly recommend using a synchronisation primitive like a `System.Threading.ManualResetEvent` or - as you wait for two events - a `System.Threading.Semaphore`. You would create a semaphore variable with an initial count of zero and a maximum count of two. Instead of setting a `bool`, you call `Release()` and in the main thread you wait for the semaphore being signaled twice.

# session - 如何获取已连接 Windows RDP 用户的 IP 或主机名？

> ID：10250417
> 
> 赞同：1
> 
> 时间：2012-04-20T16:59:20.423
> 
> 标签：session, wmi, rdp, wsh

我有一个 vbs 脚本来监视远程登录到服务器的用户它使用“qwinsta”来获取用户名，我可以简单地循环等待断开连接。

但 qwinsta 不返回远程用户的主机名或 IP 地址。我已经搜索了一上午，找不到任何 cmd 命令或 wmi 命令来根据用户名或会话 ID 获取已连接用户的 ip/host。

有没有人有任何其他想法来获取此信息？我找到了这个提供 IP 地址的外部实用程序：http: [//home.fnal.gov/~jklemenc/tslistusers.html](http://home.fnal.gov/~jklemenc/tslistusers.html)但我宁愿不使用外部程序。我假设它正在使用某种 wmi 或其他方法来获取我可以在我自己的脚本中以某种方式执行的 ipaddress。

我知道我可以使用 netstat 和过滤端口 3389 来仅获取 RDP 会话并以这种方式获取 IP，但是从那时起我无法知道哪个 IP 属于哪个用户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T13:17:47.853

此信息通过（大部分）未记录的 API WinStationQueryInformationW 公开。据我所知，它没有通过 WMI 或任何命令行实用程序或 COM 对象公开。

如果您可以使用 .NET 语言，则可以使用[Cassia 库](http://code.google.com/p/cassia/)来处理 Win32 API 调用——请参阅 ITerminalServicesSession.RemoteEndPoint（通过以访客身份登录在[此处](http://teamcity.codebetter.com/project.html?projectId=project51)下载最新的主干构建）。应该可以[使用 tlbexp 和 regasm](http://msdn.microsoft.com/en-us/library/ms973802.aspx)从 VBScript 使用 Cassia ，但我还没有尝试过。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-22T08:38:49.303

您可以在批处理文件中使用下面的代码将主机名的文本文件传递到数组中并查询每个 rdp 会话信息...（只需确保 Server_List.txt 文件位于您创建的批处理文件旁边）

```
@echo off
setlocal EnableDelayedExpansion
echo RDPSessionINFO > ./results.txt
echo ============== >> ./results.txt

set i=0
for /F %%a in (Server_List.txt) do (
   set /A i+=1
   set array[!i!]=%%a
)
set n=%i%

for /L %%i in (1,1,%n%) do echo !array[%%i]! >> ./results.txt && qwinsta /server:!array[%%i]!>> ./results.txt && echo =================== >> ./results.txt

start notepad.exe ./results.txt 
```

# c - 为什么 GCC 会为几乎相同的 C 代码生成如此完全不同的程序集？

> ID：10250419
> 
> 赞同：186
> 
> 时间：2012-04-20T16:59:24.940
> 
> 标签：c, gcc, assembly, x86, compiler-optimization

在编写优化`ftol`函数时，我发现`GCC 4.6.1`. 让我先向您展示代码（为清楚起见，我标记了差异）：

快速截断，C：

```
int fast_trunc_one(int i) {
    int mantissa, exponent, sign, r;

    mantissa = (i & 0x07fffff) | 0x800000;
    exponent = 150 - ((i >> 23) & 0xff);
    sign = i & 0x80000000;

    if (exponent < 0) {
        r = mantissa << -exponent;                       /* diff */
    } else {
        r = mantissa >> exponent;                        /* diff */
    }

    return (r ^ -sign) + sign;                           /* diff */
} 
```

fast_trunc_two，C：

```
int fast_trunc_two(int i) {
    int mantissa, exponent, sign, r;

    mantissa = (i & 0x07fffff) | 0x800000;
    exponent = 150 - ((i >> 23) & 0xff);
    sign = i & 0x80000000;

    if (exponent < 0) {
        r = (mantissa << -exponent) ^ -sign;             /* diff */
    } else {
        r = (mantissa >> exponent) ^ -sign;              /* diff */
    }

    return r + sign;                                     /* diff */
} 
```

好像一样吧？那么GCC不同意。编译后`gcc -O3 -S -Wall -o test.s test.c`是汇编输出：

fast_trunc_one，生成：

```
_fast_trunc_one:
LFB0:
    .cfi_startproc
    movl    4(%esp), %eax
    movl    $150, %ecx
    movl    %eax, %edx
    andl    $8388607, %edx
    sarl    $23, %eax
    orl $8388608, %edx
    andl    $255, %eax
    subl    %eax, %ecx
    movl    %edx, %eax
    sarl    %cl, %eax
    testl   %ecx, %ecx
    js  L5
    rep
    ret
    .p2align 4,,7
L5:
    negl    %ecx
    movl    %edx, %eax
    sall    %cl, %eax
    ret
    .cfi_endproc 
```

fast_trunc_two，生成：

```
_fast_trunc_two:
LFB1:
    .cfi_startproc
    pushl   %ebx
    .cfi_def_cfa_offset 8
    .cfi_offset 3, -8
    movl    8(%esp), %eax
    movl    $150, %ecx
    movl    %eax, %ebx
    movl    %eax, %edx
    sarl    $23, %ebx
    andl    $8388607, %edx
    andl    $255, %ebx
    orl $8388608, %edx
    andl    $-2147483648, %eax
    subl    %ebx, %ecx
    js  L9
    sarl    %cl, %edx
    movl    %eax, %ecx
    negl    %ecx
    xorl    %ecx, %edx
    addl    %edx, %eax
    popl    %ebx
    .cfi_remember_state
    .cfi_def_cfa_offset 4
    .cfi_restore 3
    ret
    .p2align 4,,7
L9:
    .cfi_restore_state
    negl    %ecx
    sall    %cl, %edx
    movl    %eax, %ecx
    negl    %ecx
    xorl    %ecx, %edx
    addl    %edx, %eax
    popl    %ebx
    .cfi_restore 3
    .cfi_def_cfa_offset 4
    ret
    .cfi_endproc 
```

这是一个**极端**的区别。这实际上也显示在配置文件上，`fast_trunc_one`比`fast_trunc_two`. 现在我的问题是：是什么原因造成的？

* * *

## 回答 #1

> 赞同：261
> 
> 时间：2012-04-20T17:52:51.157

**更新以与 OP 的编辑同步**

通过修改代码，我设法了解 GCC 如何优化第一种情况。

**在我们了解它们为何如此不同之前，首先我们必须了解 GCC 是如何优化`fast_trunc_one()`.**

信不信由你，`fast_trunc_one()`正在对此进行优化：

```
int fast_trunc_one(int i) {
    int mantissa, exponent;

    mantissa = (i & 0x07fffff) | 0x800000;
    exponent = 150 - ((i >> 23) & 0xff);

    if (exponent < 0) {
        return (mantissa << -exponent);             /* diff */
    } else {
        return (mantissa >> exponent);              /* diff */
    }
} 
```

这会产生与原始程序完全相同的程序集`fast_trunc_one()`- 注册名称和所有内容。

请注意，在程序集中没有`xor`s for `fast_trunc_one()`。这就是给我的。

* * *

# 怎么会这样？

* * *

**第1步：** `sign = -sign`

首先，让我们看一下`sign`变量。由于`sign = i & 0x80000000;`，只有两个可能的值`sign`可以取：

*   `sign = 0`
*   `sign = 0x80000000`

现在认识到，在这两种情况下，`sign == -sign`. 因此，当我将原始代码更改为：

```
int fast_trunc_one(int i) {
    int mantissa, exponent, sign, r;

    mantissa = (i & 0x07fffff) | 0x800000;
    exponent = 150 - ((i >> 23) & 0xff);
    sign = i & 0x80000000;

    if (exponent < 0) {
        r = mantissa << -exponent;
    } else {
        r = mantissa >> exponent;
    }

    return (r ^ sign) + sign;
} 
```

它产生与原始的完全相同的程序集`fast_trunc_one()`。我会省去你的程序集，但它是相同的 - 注册名称和所有。

* * *

**第 2 步：**数学简化：`x + (y ^ x) = y`

`sign`只能取两个值之一，`0`或`0x80000000`。

*   当`x = 0`，`x + (y ^ x) = y`则微不足道成立。
*   添加和异或是`0x80000000`相同的。它翻转符号位。因此`x + (y ^ x) = y`也成立时`x = 0x80000000`。

因此，`x + (y ^ x)`减少到`y`。代码简化为：

```
int fast_trunc_one(int i) {
    int mantissa, exponent, sign, r;

    mantissa = (i & 0x07fffff) | 0x800000;
    exponent = 150 - ((i >> 23) & 0xff);
    sign = i & 0x80000000;

    if (exponent < 0) {
        r = (mantissa << -exponent);
    } else {
        r = (mantissa >> exponent);
    }

    return r;
} 
```

同样，这将编译为完全相同的程序集 - 注册名称和所有。

* * *

上述版本最终简化为：

```
int fast_trunc_one(int i) {
    int mantissa, exponent;

    mantissa = (i & 0x07fffff) | 0x800000;
    exponent = 150 - ((i >> 23) & 0xff);

    if (exponent < 0) {
        return (mantissa << -exponent);             /* diff */
    } else {
        return (mantissa >> exponent);              /* diff */
    }
} 
```

这几乎正​​是 GCC 在程序集中生成的。

* * *

那么为什么编译器不优化`fast_trunc_two()`相同的东西呢？

其中的关键部分`fast_trunc_one()`是`x + (y ^ x) = y`优化。在表达式`fast_trunc_two()`中`x + (y ^ x)`被拆分跨分支。

我怀疑这可能足以让 GCC 不进行这种优化。（它需要将`^ -sign`分支吊出并将其合并到`r + sign`最后。）

例如，这会产生与以下相同的程序集`fast_trunc_one()`：

```
int fast_trunc_two(int i) {
    int mantissa, exponent, sign, r;

    mantissa = (i & 0x07fffff) | 0x800000;
    exponent = 150 - ((i >> 23) & 0xff);
    sign = i & 0x80000000;

    if (exponent < 0) {
        r = ((mantissa << -exponent) ^ -sign) + sign;             /* diff */
    } else {
        r = ((mantissa >> exponent) ^ -sign) + sign;              /* diff */
    }

    return r;                                     /* diff */
} 
```

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2012-04-20T20:48:14.467

这是编译器的本质。假设他们将采取最快或最好的路径，这是完全错误的。任何暗示您不需要对代码做任何事情来优化的人，因为“现代编译器”填补了空白，做最好的工作，制作最快的代码等等。实际上我看到 gcc 从 3.x 到4.x 至少在手臂上。此时，4.x 可能已经赶上了 3.x，但在早期它产生的代码较慢。通过练习，您可以学习如何编写代码，这样编译器就不必费力工作，从而产生更一致和预期的结果。

这里的错误是您对将要生产的东西的期望，而不是实际生产的东西。如果您希望编译器生成相同的输出，请为其提供相同的输入。数学上不一样，有点不一样，但实际上是一样的，没有不同的路径，没有从一个版本到另一个版本的共享或分发操作。这是一个很好的练习，可以帮助您了解如何编写代码并了解编译器如何处理它。不要错误地假设，因为某个处理器目标的一个版本的 gcc 有一天会产生某种结果，那就是所有编译器和所有代码的规则。您必须使用许多编译器和许多目标才能了解正在发生的事情。

gcc 很讨厌，我邀请你看看幕后，看看 gcc 的胆量，尝试添加一个目标或自己修改一些东西。它几乎没有被管道胶带和钢丝绳固定在一起。在关键位置添加或删除的额外代码行会崩溃。它产生了可用的代码这一事实是值得高兴的，而不是担心为什么它没有达到其他期望。

你看过哪些不同版本的 gcc 产生了吗？3.x 和 4.x 尤其是 4.5 vs 4.6 vs 4.7 等？对于不同的目标处理器、x86、arm、mips 等或不同风格的 x86，如果这是您使用的本机编译器、32 位与 64 位等？然后 llvm (clang) 用于不同的目标？

Mystical 在解决分析/优化代码问题所需的思考过程中做得非常出色，期望编译器能够提出任何“现代编译器”所不期望的任何问题。

无需进入数学属性，这种形式的代码

```
if (exponent < 0) {
  r = mantissa << -exponent;                       /* diff */
} else {
  r = mantissa >> exponent;                        /* diff */
}
return (r ^ -sign) + sign;                           /* diff */ 
```

将引导编译器 A：以那种形式实现它，执行 if-then-else 然后收敛于通用代码以完成并返回。或 B：保存一个分支，因为这是函数的结尾。也不用担心使用或保存 r。

```
if (exponent < 0) {
  return((mantissa << -exponent)^-sign)+sign;
} else {
  return((mantissa << -exponent)^-sign)+sign;
} 
```

然后你可以进入 Mystical 指出的符号变量一起消失的代码所写的代码。我不希望编译器看到符号变量消失，所以你应该自己做，而不是强迫编译器试图弄清楚。

这是深入研究 gcc 源代码的绝佳机会。您似乎发现了一种情况，优化器在一种情况下看到一件事，然后在另一种情况下看到另一件事。然后进行下一步，看看能不能让gcc看到那个case。每个优化都在那里，因为一些个人或团体认识到优化并故意将其放在那里。每次有人必须将它放在那里（然后对其进行测试，然后将其维护到未来）时，这种优化就在那里并起作用。

绝对不要假设代码越少越快，代码越多越慢，很容易创建和找到不正确的示例。通常情况下，更少的代码比更多的代码更快。正如我从一开始就展示的那样，尽管您可以创建更多代码以在这种情况下保存分支或循环等，并让最终结果是更快的代码。

底线是您为编译器提供了不同的源并期望得到相同的结果。问题不在于编译器输出，而在于用户的期望。为特定的编译器和处理器演示是相当容易的，添加一行代码会使整个函数显着变慢。例如为什么改变 a = b + 2; 到 a = b + c + 2; 导致_fill_in_the_blank_compiler_name_ 生成完全不同且速度较慢的代码？答案当然是编译器在输入上输入了不同的代码，因此编译器生成不同的输出是完全有效的。（更好的是当您交换两行不相关的代码并导致输出发生巨大变化时）输入的复杂性和大小与输出的复杂性和大小之间没有预期的关系。

```
for(ra=0;ra<20;ra++) dummy(ra); 
```

它产生了 60-100 行汇编程序。它展开了循环。我没有数行数，你想想，它必须添加，复制结果到输入到函数调用，进行函数调用，最少三个操作。所以取决于目标，可能至少有 60 条指令，如果每个循环有 4 条指令，则为 80 条，如果每个循环有 5 条，则为 100 条，等等。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2012-04-30T05:40:17.557

Mysticial 已经给出了很好的解释，但我想我要补充一点，FWIW，关于为什么编译器会针对其中一个而不是另一个进行优化，实际上并没有什么基本原理。

例如， LLVM 的`clang`编译器为两个函数提供相同的代码（函数名称除外），给出：

```
_fast_trunc_two:                        ## @fast_trunc_one
        movl    %edi, %edx
        andl    $-2147483648, %edx      ## imm = 0xFFFFFFFF80000000
        movl    %edi, %esi
        andl    $8388607, %esi          ## imm = 0x7FFFFF
        orl     $8388608, %esi          ## imm = 0x800000
        shrl    $23, %edi
        movzbl  %dil, %eax
        movl    $150, %ecx
        subl    %eax, %ecx
        js      LBB0_1
        shrl    %cl, %esi
        jmp     LBB0_3
LBB0_1:                                 ## %if.then
        negl    %ecx
        shll    %cl, %esi
LBB0_3:                                 ## %if.end
        movl    %edx, %eax
        negl    %eax
        xorl    %esi, %eax
        addl    %edx, %eax
        ret 
```

这段代码不像 OP 的第一个 gcc 版本那么短，但没有第二个那么长。

来自另一个编译器（我不会命名）的代码，为 x86_64 编译，为这两个函数生成：

```
fast_trunc_one:
        movl      %edi, %ecx        
        shrl      $23, %ecx         
        movl      %edi, %eax        
        movzbl    %cl, %edx         
        andl      $8388607, %eax    
        negl      %edx              
        orl       $8388608, %eax    
        addl      $150, %edx        
        movl      %eax, %esi        
        movl      %edx, %ecx        
        andl      $-2147483648, %edi
        negl      %ecx              
        movl      %edi, %r8d        
        shll      %cl, %esi         
        negl      %r8d              
        movl      %edx, %ecx        
        shrl      %cl, %eax         
        testl     %edx, %edx        
        cmovl     %esi, %eax        
        xorl      %r8d, %eax        
        addl      %edi, %eax        
        ret 
```

这很有趣，因为它计算两边，`if`然后在最后使用条件移动来选择正确的。

Open64 编译器生成以下内容：

```
fast_trunc_one: 
    movl %edi,%r9d                  
    sarl $23,%r9d                   
    movzbl %r9b,%r9d                
    addl $-150,%r9d                 
    movl %edi,%eax                  
    movl %r9d,%r8d                  
    andl $8388607,%eax              
    negl %r8d                       
    orl $8388608,%eax               
    testl %r8d,%r8d                 
    jl .LBB2_fast_trunc_one         
    movl %r8d,%ecx                  
    movl %eax,%edx                  
    sarl %cl,%edx                   
.Lt_0_1538:
    andl $-2147483648,%edi          
    movl %edi,%eax                  
    negl %eax                       
    xorl %edx,%eax                  
    addl %edi,%eax                  
    ret                             
    .p2align 5,,31
.LBB2_fast_trunc_one:
    movl %r9d,%ecx                  
    movl %eax,%edx                  
    shll %cl,%edx                   
    jmp .Lt_0_1538 
```

和类似但不相同的代码`fast_trunc_two`。

无论如何，当谈到优化时，它就像一个彩票——它就是这样......要知道为什么你的代码会以任何特定的方式编译并不总是那么容易。

# wcf - 用于视频播放的 WCF REST 流式处理

> ID：10250428
> 
> 赞同：4
> 
> 时间：2012-04-20T16:59:56.370
> 
> 标签：wcf, flash, html, video, streaming

我需要在 ASP MVC 4 网站上使用 HTML5 视频标签（如果支持）或 JW Player 播放视频。现在我使用 WCF REST 方法通过以下方式访问视频文件：

```
 [OperationContract]
    [WebInvoke(ResponseFormat = WebMessageFormat.Json, Method = "GET")]
    public Stream Download(string id, bool isTemp)
    {
        //File.OpenRead(path) works inside FileBlo.Fownload 
        Stream download = FileInfoBlo.Download(id, isTemp);
        if (WebOperationContext.Current != null)
        {
            //Specifing any other mime type doesn't help
            WebOperationContext.Current.OutgoingResponse.ContentType = "video/*";
        }
        return download;
    } 
```

所以文件的链接就像

> > [http://localhost/app-api/Apiservice.svc/download?id=8&isTemp=false](http://localhost/app-api/Apiservice.svc/download?id=8&isTemp=false)

问题是：
1\. HTML5 播放 - 只有 Chrome 可以播放视频，但不能做任何其他事情 - 停止、再次播放、搜索等。其他浏览器根本不播放。仅使用指向文件的链接访问文件时，例如

> > “http://localhost/app/file.mp4”

它可以播放。

2\. JW 播放器播放 - 发生错误 -

> > 错误询问队列在第 5 步失败：无法加载播放列表：播放列表文件不包含有效的播放列表

访问带有链接的文件时（如上所示） - 它至少可以播放。

据我了解，这种“wcf 流”不适合视频播放。可能WCF在这里根本不是一个选择吗？因此，任何有关 IIS（7+ / Server 2008）的正确视频流的帮助和建议\示例都将受到极大的欢迎。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-03T11:42:55.703

您需要设置响应标头。具体来说：Content-Range X-Content-Duration Content-Length

# ruby-on-rails-3 - Gmaps4Rails 和自定义/嵌套点模型

> ID：10250429
> 
> 赞同：0
> 
> 时间：2012-04-20T17:00:11.960
> 
> 标签：ruby-on-rails-3, google-maps-api-3, gmaps4rails

我一直在使用 gmaps4 rails 来构建一个站点，而 gem 是我项目的超级补充。但是，对于嵌套模型和多边形，我遇到了一些麻烦。

我也想做这样的事情： [Gmaps4rails custom info window with javascript content](https://stackoverflow.com/questions/10170883/polygon-infowindows-in-gmaps4rails)

楷模：

```
 class Zone < ActiveRecord::Base
    acts_as_gmappable

    has_many :points, :as => :pointable
    accepts_nested_attributes_for :points

    def self.create_with_points(name, points)
      zone = Zone.create(:name => name)
      points.map { |point| zone.points.create(:latitude => point[0],
                                              :longitude => point[1]) }
      zone
    end

    def as_polygon_data
      points.collect { |point| { "lat" => point.latitude.to_f,
                                 "lng" => point.longitude.to_f,
                                 "strokeColor" => "#EBAC2A",
                                 "strokeOpacity" => 0.65,
                                 "strokeWeight" => 2,
                                 "fillColor" => "#606F81",
                                 "fillOpacity" => 0.4
                               } }
    end

    def self.all_as_polygon_data
      Zone.all.collect { |zone| zone.as_polygon_data }
    end
  end

  class Point < ActiveRecord::Base
    belongs_to :pointable, :polymorphic => :true
    acts_as_gmappable
  end 
```

要调用控制器中的区域，我必须使用 to_json 而不是 to_gmaps4rails 调用它：

```
@polygon_json = Zone.all_as_polygon_data.to_json 
```

多边形完美地呈现在地图上，但我无法向它们添加信息窗口。我在上述帖子中尝试了点击事件回调，但它对我不起作用。

我还想知道如何获取这些多边形的句柄，以便使用复选框隐藏它们。

感谢您的时间。希望我提供了足够的信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T17:51:06.307

`but it did not work for me`不是一个非常有用的语句。

我不知道你的问题是什么：你有任何 js 错误吗？

您可以使用整个 google js api，gem 不是刹车，它只是一个包装器。

如果要与多边形交互：

*   您在视图中传递的数据存储在对象数组中：`Gmaps.map.polygons`

*   在页面加载时，谷歌的多边形被创建并存储在我调用的对象中`serviceObject`。

总而言之，`Gmaps.map.polygons[0].serviceObject`是一个可以自由交互的谷歌多边形对象。

为确保创建了 google 的对象，请将您的自定义方法插入 gmaps4rails js 回调中。

# facebook - Facebook“提要”对话框“名称”链接不起作用

> ID：10250432
> 
> 赞同：0
> 
> 时间：2012-04-20T17:00:19.777
> 
> 标签：facebook

这是我在新窗口中成功显示 Facebook 'Feed' 对话框的工作代码：

```
 <a class="fbShareToWall" 
        onClick='window.open("https://www.facebook.com/dialog/feed?app_id=103528099783xxx" 
        + "&link=http://www.thesite.com"
        + "&name=Please%20respond%20to%20the%20link"
        + "&caption=Just%20work"
        + "&description=Comeon%20work"
        + "&redirect_uri=http://www.thesite.com");'">Share on Facebook</a> 
```

这成功地在新窗口中显示了 Feed 对话框。

注意上面代码中的 '&name' 参数——在 Feed 对话框中它显示为： **Please respond to the link**。

但是如果你点击它——它什么也不做，就好像它不是一个链接一样。但它实际上是一个链接。

“**请回复链接**”看起来像一个链接——它是粗体字体，字母是蓝色的，而其他参数——在 Feed 对话框中显示为“Just Work”的*“标题”*参数，以及显示为“Comeon work”的*“description”*参数——它们既不是粗体也不是蓝色。只是常规文本，这两个参数。

因此，在我的提要对话框打开的情况下，我右键单击**请回复链接** 并选择“在新窗口中打开链接”，Firefox 会打开一个新浏览器，并且 URL 栏有*http://www.thesite.com*正如您所注意到的，这就是我在上面的代码中设置 &link 参数的方式。换句话说——Firefox 使用连接到我的 &name 参数的 URL 导航没有问题。

接下来，我检查并确保 Firefox 没有阻止弹出窗口。不是。

我不明白为什么我的“**请回复链接**”提要对话框 *&name*参数：

*   看起来像 Feed 对话框上的可点击链接

*   右键单击后，可以在新浏览器中打开它——并成功导航到*&link*参数

*   **如果您单击“请回复**Feed”对话框中的链接，则不会执行任何操作。

我在上面的 Feed 对话框代码中是否遗漏了某些内容？

该 Feed 对话框中*&name*参数的用途是什么？

或者，让**&link**和**&name**参数看起来是 Feed 对话框上的链接，但点击后不起作用有什么意义？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:38:13.727

使用 javascript sdk 发布时存在这种保存行为，我认为这是 facebook 的意图。

What you see in that dialog is only a preview of how it will look like when posted, and as a preview it's probably not supposed to act as the real thing. This is probably the behavior so that the user will finish the publishing process with out being redirect to another page (same or different window/tab) by clicking on the items in the preview.

# java - 无论如何，谁关闭了那个套接字？

> ID：10250435
> 
> 赞同：1
> 
> 时间：2012-04-20T17:00:23.967
> 
> 标签：java, tcp, cxf

我们有一个使用 Apache CXF 2.5.x 构建的系统，它在响应中使用带有 MTOM 附件的 SOAP 消息。

每隔一段时间，客户端就会遇到一个异常，抱怨 CXF 正在读取的套接字已关闭，同时读取带有这些附件之一的 HTTP 响应。

服务器显示没有任何有趣的事情发生。

我们想知道：我们如何判断套接字是否因为服务器端暴力关闭而不是客户端中的一些恶意代码调用`close()`它而关闭？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T17:06:58.337

您可以从[WireShark](http://www.wireshark.org/)开始。它将显示网络中的所有流量。从那里您可以看到哪一方为套接字发送了 FIN 或 RST。

捕获时使用过滤器，例如，如果在客户端运行，则按服务器的 IP 地址进行过滤。从命令行：

> tethereal -iany -R"ip.addr == " -w mycapturefile.pcap

# java - 在没有 API-Possibilities 的情况下创建与软件的接口

> ID：10250437
> 
> 赞同：0
> 
> 时间：2012-04-20T17:00:37.123
> 
> 标签：java, python

我的办公室有一个专有软件用于数据库访问和报告，在我的办公室里没有人喜欢它。我正在考虑用一个简单的接口构建一个 python/Java 应用程序，它可以完成与专有软件通信的任务。我的问题是：由于该软件是专有的，因此我知道没有任何已知的 API 可以接口。有没有办法解决这个问题，还是必须要有 API 才能访问软件？我在 Windows XP 平台上这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T18:17:46.583

1.  询问制作软件的公司是否有关于其 API 的 SDK 或文档。即使他们有一个，如果您已经不喜欢该应用程序，这对您来说可能没有多大用处。

2.  如果应用程序的主要目的是报告数据库的内容，那么 python 中有很多用于读取/写入数据库的库。SQLAlchemy/Storm 和 PyQt 可能会做你想做的事。

# c++ - 将 std::vector 与 Igraph 一起使用

> ID：10250438
> 
> 赞同：0
> 
> 时间：2012-04-20T17:00:44.243
> 
> 标签：c++, igraph

我一直在尝试找到一个真正的函数，让我从向量的 std::vector 转换为 igraph_vector_ptr_t 和相反的方式。

原因是，有不同的类，如 std::sort、std::unique 和其他类，可以让我们操作向量，这个函数在 Igraph 库中不存在。

下面的代码只显示了从 std::vector 转换为 igraph_vector_ptr_t 的代码，问题是它不起作用，请帮助我帮助我改进它。

```
#include <igraph.h>
#include <fstream>
#include <iostream>
#include <stdlib.h>
#include <vector>
#include <algorithm>

using namespace std;

void print_vector(igraph_vector_t *v, FILE *f) {
  long int i;
  long int l=igraph_vector_size(v);
  for (i=0; i<l; i++) {
    fprintf(f, " %li", (long int) VECTOR(*v)[i]);
  }
  fprintf(f, "\n");
}

void Stl_To_Igraph_vector_ptr_t(std::vector< std::vector< long int > > & vectR, igraph_vector_ptr_t * vl) {
      long int i,j,n;

      igraph_vector_t vt;
      igraph_vector_init(&vt,4);
      for (i = 0; i< 2; i++) {
            for (j = 0; j< 4; j++) {
                //cout << vectR.at(i).at(j) << " ";
                VECTOR(vt)[j]=vectR.at(i).at(j);
            }
            //cout<<endl;
            igraph_vector_ptr_set(vl, i,&vt);
      }
}

int main() {

  // Set STL Vectors
  std::vector< std::vector< long int > > vectR;
  std::vector<long int> vectRi1,vectRi2;
  long int myarray1 [] = { 1,2,3,4 };
  long int myarray2 [] = { 5,6,7,8 };

  vectRi1.insert(vectRi1.begin(), myarray1,  myarray1+4);
  vectRi2.insert(vectRi2.begin(), myarray2,  myarray2+4);

  vectR.push_back(vectRi1);
  vectR.push_back(vectRi2);

  // Convert From Stl vector to Igraph_vector_ptr_t
  igraph_vector_ptr_t vIgraph;

  igraph_vector_ptr_init(&vIgraph, 2);
  Stl_To_Igraph_vector_ptr_t(vectR, &vIgraph);

  // Print and distroyed
  long int i;
  for (i=0; i<igraph_vector_ptr_size(&vIgraph); i++) {
    print_vector((igraph_vector_t *)VECTOR(vIgraph)[i],stdout);
    igraph_vector_destroy((igraph_vector_t *)VECTOR(vIgraph)[i]);
    free((igraph_vector_t *)VECTOR(vIgraph)[i]);
  }

  return 0;
} 
```

* * *

好的，这是解决方案的一部分，但我在 valgrind 中遇到问题，

```
#include <igraph.h>

#include <stdlib.h>

int print_vector(igraph_vector_t *v) {
  long int i, l=igraph_vector_size(v);
  for (i=0; i<l; i++) {
    printf(" %li", (long int) VECTOR(*v)[i]);
  }
  printf("\n");
}

void convert(igraph_vector_ptr_t * vecs){
    long int i,j;
    igraph_vector_t *v;
    v = (igraph_vector_t*)calloc(igraph_vector_ptr_size(vecs), sizeof(igraph_vector_t));
    for(i=0; i<igraph_vector_ptr_size(vecs); i++)
    {
      igraph_vector_init(v + i,10);
      for(j=0; j<igraph_vector_size(v); j++){
          VECTOR(*(v+i))[j]=i+j;
      }
      igraph_vector_ptr_set(vecs,i,(v + i));
    }

}

int main() {
  igraph_vector_ptr_t vecs;
  long int i;

  igraph_vector_ptr_init(&vecs, 3);
  for (i=0; i<igraph_vector_ptr_size(&vecs); i++) {
    VECTOR(vecs)[i] = malloc(sizeof(igraph_vector_t));
    igraph_vector_init( (igraph_vector_t*)VECTOR(vecs)[i], 3);
  }

  convert(&vecs);

  for (i=0; i<igraph_vector_ptr_size(&vecs); i++) {
    print_vector( (igraph_vector_t*)VECTOR(vecs)[i]);
    igraph_vector_destroy( (igraph_vector_t*)VECTOR(vecs)[i]);
    //free(VECTOR(vecs)[i]);
  }

  igraph_vector_ptr_destroy(&vecs);
  return 0;

} 
```

valgrind 的输出是：

```
user@pc:~/workSpalceIgraphCpp/proyIgraph$ valgrind --leak-check=full  -v --track-origins=yes --show-reachable=yes  ./example
==12439== Memcheck, a memory error detector
==12439== Copyright (C) 2002-2009, and GNU GPL'd, by Julian Seward et al.
==12439== Using Valgrind-3.6.0.SVN-Debian and LibVEX; rerun with -h for copyright info
==12439== Command: ./example
==12439== 
--12439-- Valgrind options:
--12439--    --suppressions=/usr/lib/valgrind/debian-libc6-dbg.supp
--12439--    --leak-check=full
--12439--    -v
--12439--    --track-origins=yes
--12439--    --show-reachable=yes
--12439-- Contents of /proc/version:
--12439--   Linux version 2.6.32-35-generic-pae (buildd@vernadsky) (gcc version 4.4.3 (Ubuntu 4.4.3-4ubuntu5) ) #78-Ubuntu SMP Tue Oct 11 17:01:12 UTC 2011
--12439-- Arch and hwcaps: X86, x86-sse1-sse2
--12439-- Page sizes: currently 4096, max supported 4096
--12439-- Valgrind library directory: /usr/lib/valgrind
--12439-- Reading syms from /lib/ld-2.11.1.so (0x4000000)
--12439-- Reading debug info from /lib/ld-2.11.1.so ..
--12439-- .. CRC mismatch (computed 45f50ae1 wanted 137bc614)
--12439-- Reading debug info from /usr/lib/debug/lib/ld-2.11.1.so ..
--12439-- Reading syms from /home/rvaca/workSpalceIgraphCpp/proyIgraph/example (0x8048000)
--12439-- Reading syms from /usr/lib/valgrind/memcheck-x86-linux (0x38000000)
--12439--    object doesn't have a dynamic symbol table
--12439-- Reading suppressions file: /usr/lib/valgrind/debian-libc6-dbg.supp
--12439-- Reading suppressions file: /usr/lib/valgrind/default.supp
--12439-- REDIR: 0x40160b0 (index) redirected to 0x3803e9b3 (vgPlain_x86_linux_REDIR_FOR_index)
--12439-- Reading syms from /usr/lib/valgrind/vgpreload_core-x86-linux.so (0x401f000)
--12439-- Reading syms from /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so (0x4022000)
==12439== WARNING: new redirection conflicts with existing -- ignoring it
--12439--     new: 0x040160b0 (index               ) R-> 0x04025c30 index
--12439-- REDIR: 0x4016290 (strlen) redirected to 0x4026070 (strlen)
--12439-- Reading syms from /usr/local/lib/libigraph.so.0.0.0 (0x402b000)
--12439-- Reading syms from /usr/lib/libstdc++.so.6.0.13 (0x4213000)
--12439--    object doesn't have a symbol table
--12439-- Reading syms from /lib/tls/i686/cmov/libm-2.11.1.so (0x4308000)
--12439-- Reading debug info from /lib/tls/i686/cmov/libm-2.11.1.so ..
--12439-- .. CRC mismatch (computed a765a73c wanted 8d13be57)
--12439-- Reading debug info from /usr/lib/debug/lib/tls/i686/cmov/libm-2.11.1.so ..
--12439-- Reading syms from /lib/libgcc_s.so.1 (0x432e000)
--12439-- Reading debug info from /lib/libgcc_s.so.1 ..
--12439-- .. CRC mismatch (computed 338494ad wanted b1d69d39)
--12439--    object doesn't have a symbol table
--12439-- Reading syms from /lib/tls/i686/cmov/libc-2.11.1.so (0x434d000)
--12439-- Reading debug info from /lib/tls/i686/cmov/libc-2.11.1.so ..
--12439-- .. CRC mismatch (computed 2236eb0a wanted a071c0c3)
--12439-- Reading debug info from /usr/lib/debug/lib/tls/i686/cmov/libc-2.11.1.so ..
--12439-- Reading syms from /usr/lib/libxml2.so.2.7.6 (0x44a8000)
--12439-- Reading debug info from /usr/lib/libxml2.so.2.7.6 ..
--12439-- .. CRC mismatch (computed 8c0a5cb7 wanted d9f96831)
--12439--    object doesn't have a symbol table
--12439-- Reading syms from /usr/lib/libgmp.so.3.5.2 (0x45d3000)
--12439-- Reading debug info from /usr/lib/libgmp.so.3.5.2 ..
--12439-- .. CRC mismatch (computed b9cf7786 wanted 4db0a849)
--12439--    object doesn't have a symbol table
--12439-- Reading syms from /lib/tls/i686/cmov/libdl-2.11.1.so (0x4634000)
--12439-- Reading debug info from /lib/tls/i686/cmov/libdl-2.11.1.so ..
--12439-- .. CRC mismatch (computed 10f03463 wanted f15a6db6)
--12439-- Reading debug info from /usr/lib/debug/lib/tls/i686/cmov/libdl-2.11.1.so ..
--12439-- Reading syms from /lib/libz.so.1.2.3.3 (0x4638000)
--12439-- Reading debug info from /lib/libz.so.1.2.3.3 ..
--12439-- .. CRC mismatch (computed 53909dc3 wanted dc0e37c9)
--12439--    object doesn't have a symbol table
--12439-- REDIR: 0x43c0b10 (rindex) redirected to 0x4025ae0 (rindex)
--12439-- REDIR: 0x43c07f0 (__GI_strlen) redirected to 0x4026050 (__GI_strlen)
--12439-- REDIR: 0x43bc660 (calloc) redirected to 0x402417f (calloc)
--12439-- REDIR: 0x43bcf40 (malloc) redirected to 0x4024e9b (malloc)
--12439-- REDIR: 0x43c32b0 (strchrnul) redirected to 0x4027510 (strchrnul)
 0 1 2 3 4 5 6 7 8 9
--12439-- REDIR: 0x43bce60 (free) redirected to 0x4024ab5 (free)
 1 2 3 4 5 6 7 8 9 10
 2 3 4 5 6 7 8 9 10 11
==12439== 
==12439== HEAP SUMMARY:
==12439==     in use at exit: 144 bytes in 7 blocks
==12439==   total heap usage: 11 allocs, 4 frees, 396 bytes allocated
==12439== 
==12439== Searching for pointers to 7 not-freed blocks
==12439== Checked 425,428 bytes
==12439== 
==12439== 36 bytes in 1 blocks are definitely lost in loss record 1 of 3
==12439==    at 0x402425F: calloc (vg_replace_malloc.c:467)
==12439==    by 0x80488C8: convert(s_vector_ptr*) (pregunta3.cpp:223)
==12439==    by 0x8048A11: main (pregunta3.cpp:246)
==12439== 
==12439== 72 bytes in 3 blocks are indirectly lost in loss record 2 of 3
==12439==    at 0x402425F: calloc (vg_replace_malloc.c:467)
==12439==    by 0x40C9A78: igraph_vector_init (vector.pmt:123)
==12439==    by 0x80489E9: main (pregunta3.cpp:243)
==12439== 
==12439== 108 (36 direct, 72 indirect) bytes in 3 blocks are definitely lost in loss record 3 of 3
==12439==    at 0x4024F20: malloc (vg_replace_malloc.c:236)
==12439==    by 0x80489C8: main (pregunta3.cpp:242)
==12439== 
==12439== LEAK SUMMARY:
==12439==    definitely lost: 72 bytes in 4 blocks
==12439==    indirectly lost: 72 bytes in 3 blocks
==12439==      possibly lost: 0 bytes in 0 blocks
==12439==    still reachable: 0 bytes in 0 blocks
==12439==         suppressed: 0 bytes in 0 blocks
==12439== 
==12439== ERROR SUMMARY: 2 errors from 2 contexts (suppressed: 27 from 6)
--12439-- 
--12439-- used_suppression:     27 dl-hack3-cond-1
==12439== 
==12439== ERROR SUMMARY: 2 errors from 2 contexts (suppressed: 27 from 6) 
```

有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T09:44:31.693

首先，igraph 是一个 C 库，*而不是*C++ 库。C 没有任何类似 STL 的东西，所以这就是为什么在 an`igraph_vector_t`和 an之间没有转换函数的原因`std::vector`。您必须自己编写转换函数。

其次，由于`vt`是一个在堆栈内分配的向量`Stl_To_Igraph_vector_ptr_t`（即您只是将其声明为局部变量而没有使用 分配它`malloc`），因此一旦函数返回，它将不复存在。`vt`您在 中存储了一个指针`igraph_vector_ptr_t`，但是当您退出函数时该指针变得无效，这就是您稍后收到错误的原因。如果您希望它比转换功能更有效，您必须制作`vt`一个`igraph_vector_ptr_t`, 并使用来分配它。`malloc`

**编辑**：这应该是这样做的——虽然我还没有测试过它（没有 C 编译器），但它应该可以工作。这些针对可读性而非性能进行了优化（例如，您可以`Stl_To_Igraph_vector_T`使用`std::copy`）：

```
void Stl_To_Igraph_vector_t(std::vector<long int>& vectR, igraph_vector_t* v) {
    size_t n = vectR.size();

    /* Make sure that there is enough space for the items in v */
    igraph_vector_resize(v, n);

    /* Copy all the items */
    for (size_t i = 0; i < n; i++) {
        VECTOR(*v)[i] = vectR[i];
    }
}

void Stl_To_Igraph_vector_ptr_t(std::vector< std::vector<long int> >& vectR, igraph_vector_ptr_t* vl) {
    size_t n = vectR.size();

    /* Make sure that there is enough space for the items in vl */
    igraph_vector_ptr_resize(vl, n);

    /* Copy all the items */
    for (size_t i = 0; i < n; i++) {
         VECTOR(*vl)[i] = (igraph_vector_t*)malloc(sizeof(igraph_vector_t));
         igraph_vector_init(VECTOR(*vl)[i]);
         Stl_To_Igraph_vector_t(vectR[i], VECTOR(*vl)[i]);
    }
} 
```

`vl`在调用之前必须将大小初始化为零`Stl_To_Igraph_vector_ptr_t`。完成 using`vl`后，您必须在其所有元素上调用`igraph_vector_destroy` *and* `free`。

# css - css 在他们的父亲中发出浮动框

> ID：10250439
> 
> 赞同：0
> 
> 时间：2012-04-20T17:00:46.687
> 
> 标签：css, html

我想在内容框内有小新闻框，我希望它们制作行和列，它们有多少......我不知道这取决于屏幕大小看多少。

我已经创建了盒子，它是父亲，但问题是，尽管它们按照我的意愿向左浮动（实际上这个想法已经完成......）但是父亲并没有随着它们形成行而增长。列已准备就绪...但不幸的是 css 中的垂直内容对我来说总是很困难...

看看这是要为“N”个新闻框实现的：

[布局 http://img689.imageshack.us/img689/8058/derpqr.jpg](http://img689.imageshack.us/img689/8058/derpqr.jpg)

这是我现在得到的代码，红色边框仅用于包装识别...

[http://jsbin.com/orojik/3](http://jsbin.com/orojik/3)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T17:02:46.873

给 id='cuerpo' 的 div 溢出：隐藏；

[http://gtwebdev.com/workshop/floats/enclosure-floats.php](http://gtwebdev.com/workshop/floats/enclosing-floats.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T17:09:31.187

假设您试图让容器随着内容的增长而增长......

`<div style="clear:both;"></div>`应该在内部内容之后但在容器中添加`#cuerpo`

[看到这里](http://jsfiddle.net/rlemon/8xhMg/1/)请告诉我，如果我不同意这个答案......我会修改。（我想这是你的问题？？）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T17:05:03.590

你需要清除你的 div

```
.clearfix:before, .clearfix:after { content:"\0020"; display:block; height:0; visibility:hidden; } .clearfix:after { clear:both; } 
```

添加该CSS并更改html

```
<div id="cuerpo" class="ui-widget-content clearfix"> 
```

如果您无法更改 html，请执行此操作

在浮动末尾添加一个类

```
<div style="clear: both;"></div> 
```

# java - 您可以重复使用子布局吗？

> ID：10250442
> 
> 赞同：0
> 
> 时间：2012-04-20T17:00:53.140
> 
> 标签：java, android

假设我有一个（以编程方式创建的）父 LinearLayout parent1，然后我添加了一个（以编程方式创建的）childA 布局，`parent1.addView(childA);`然后我以某种复杂的方式设置 childA - 也许它在其中有自己的孩子。现在我可以随后以某种方式取消它与 parent1 的链接，而不会损坏 childA 中的任何信息，以便我可以使用 parent2.addView(childA) 重新使用它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T17:05:01.930

是的你可以！

您只需要保证在将其从前一个父视图中删除之前不会将其添加到另一个视图中。

**编辑**：

```
// assuming a previously defined childA view
View childA;

parent1.removeView(childA);
parent2.addView(childA); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T17:07:02.570

如果在添加视图时提供了索引，则可以稍后取回：

```
int index = // whatever
parent1.addView(childA, index);
...
View child = parent1.getViewAt(index);
parent1.removeViewAt(index);
...
parent2.addView(child, index2); 
```

另请注意，两个父视图必须是相同类型的视图组，或者您需要将子视图的 layoutParams 更改为新父视图的适当类型

# python - 使用 scipy.optimize.curve_fit 传递其他参数？

> ID：10250461
> 
> 赞同：17
> 
> 时间：2012-04-20T17:02:42.817
> 
> 标签：python, scipy

我正在用 Python 编写一个程序，它将高斯和洛伦兹形状拟合到一些给定的共振数据。我最初开始使用，但在从协方差矩阵中检索优化参数中的错误时遇到困难后`scipy.optimize.leastsq`改为使用。`optimize.curve_fit`

我已经定义了一个函数来拟合高斯和洛伦兹的总和：

```
def mix(x,*p):
    ng = numg
    p1 = p[:3*ng]
    p2 = p[3*ng:]
    a = sumarray(gaussian(x,p1),lorentzian(x,p2))
    return a 
```

其中`p`是拟合参数的初始猜测数组。这是使用 调用它的实例`curve_fit`：

```
leastsq,covar = opt.curve_fit(mix,energy,intensity,inputtot) 
```

目前`numg`（高斯形状的数量）是一个全局变量。有没有什么方法可以将它作为一个额外的参数纳入`curve_fit`，就像可以用`leastsq`?

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-20T17:14:18.230

python的好处在于你可以定义返回其他函数的函数，试试currying：

```
def make_mix(numg): 
    def mix(x, *p): 
        ng = numg
        p1 = p[:3*ng]
        p2 = p[3*ng:]
        a = sumarray(gaussian(x,p1),lorentzian(x,p2))
        return a
    return mix 
```

进而

```
leastsq, covar = opt.curve_fit(make_mix(numg),energy,intensity,inputtot) 
```

# pyqt - 如何使用 QAbstractItemModel？

> ID：10250466
> 
> 赞同：2
> 
> 时间：2012-04-20T17:02:58.580
> 
> 标签：pyqt, qtreeview, qabstractitemmodel

我需要在 PyQt 中使用 QAbstractItemModel 和 QTreeView。

在 dropMimeData 方法中，我想删除源行（如果它是某个 MIME_TYPE。）如何获取源的行和 parentIndex？还是我需要通过其他方法做到这一点。

`def dropMimeData(self, mimedata, action, row, column, parentIndex):`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-23T18:04:36.573

*我的评论太长了，所以我想我现在就用这些信息开始回答。*

QAbstractItemModel 是一个基类，当您需要一种定制的数据建模方式时，它不适合现有的数据，例如从哪里获取数据以及如何将它们表示为项目。它还没有准备好开箱即用，因为它需要实现许多方法。除非您有令人信服的理由，否则您可能不应该从这门课开始，因为它需要更多的工作才能启动和运行。

对于只需要拖放和使用基本项目，QStandardItemModel 应该准备好供您使用。您只需创建 QStandardItems 并填充模型。对于拖放，您可以对模型进行子类化，并且只需实现适当的 drag*Event 和 drop*Event 方法以满足您的需求。

使用 QStandardItemModel + QTreeView 可以让您拥有多个视图，它们都使用相同的模型并同时将其可视化。但是鉴于您说要保留两组不同的独立数据，并且您是 Qt 的新手，我强烈建议您只使用两个 QTreeWidget。QTreeWidget 是视图和模型的包罗万象的包。这对你来说现在使用起来会容易得多。

使用 QTreeWidget，您可以对它们进行子类化并实现必要的拖放事件，就像您对 QTreeView 所做的那样，但您不再需要单独担心模型。

这是一个关于使用 QTreeWidget 拖放的帖子的链接：[http](http://www.qtcentre.org/threads/5910-QTreeWidget-Drag-and-drop)
://www.qtcentre.org/threads/5910-QTreeWidget-Drag-and-drop 他们提到了推荐的实现方法，以及你应该做什么QTreeWidgetItem 的子类来定义 mimeData。

# ruby-on-rails - 对于 Rails 视图 *.html.erb ：我可以在哪里放置样式表？

> ID：10250468
> 
> 赞同：10
> 
> 时间：2012-04-20T17:03:08.060
> 
> 标签：ruby-on-rails, css

我有这个文件：

```
app/views/listings/list.html.erb 
```

在我的 Rails 项目中。以下是该文件的内容：

```
<h1>This file is:"list.html.erb"</h1>  

<!DOCTYPE html>  
<html>  
  <head>  
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />  
    <style type="text/css">  
      html { height: 100% }  
      body { height: 100%; margin: 0; padding: 0 }  
      #map_canvas { height: 100% }  
    </style>  
    <script type="text/javascript"  
      src="http://maps.googleapis.com/maps/api/js?key=key&sensor=false">  
    </script>  

    <%=javascript_include_tag 'application'%>  
  </head>  
  <body onload="initialize()">  
    <div id="map_canvas" style="width:80%; height:80%"</div>    
    <input type="button" onclick="getlistings();" value="Add Markers">   
    <input type="button" onclick="clearMarkers();" value="Remove Markers">   
  </body>  
</html> 
```

我想对其应用样式表。我应该把样式表放在哪里？我尝试将代码放在此文件中：

```
app/assets/stylesheets/listings.css.scss 
```

但是该样式并未应用于 html 文件。我还需要更改我的 html 视图文件中的任何内容以包含样式表吗？

这是驻留在以下位置的样式表：“app/assets/stylesheets/listings.css.scss”

```
// Place all the styles related to the Listings controller here.  
// They will automatically be included in application.css.  
// You can use Sass (SCSS) here: http://sass-lang.com/  
.listings  
{  
  table tr td  
  {  
    padding: 5px;  
    vertical-align: top;  
  }  

dt  
{  
  color: #232;  
  font-weight: bold;  
  font-size: larger;  
}  

dd  
{  
  margin: 0;  
}  
}  
#map_canvas  
{  
  width: 80%;  
  height: 80%;  
} 
```

所以想知道是否有人可以帮我一把？

谢谢
编辑
所以application.html.erb文件很好，application.css也很好。阅读下面发布的答案后，我更改了 list.html.erb 文件。新的 list.html.erb 文件如下：

```
<h1>Filename = list.html.erb</h1>  

<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />  
<style type="text/css">  
  html { height: 100% }  
  body { height: 100%; margin: 0; padding: 0 }  
  #map_canvas { height: 100% }   
</style>  
<script type="text/javascript"
  src="http://maps.googleapis.com/maps/api/js?key=AIz&sensor=false">  
</script>  
<%= stylesheet_link_tag 'application' %>  
<%=javascript_include_tag 'application'%> 
```

<%= stylesheet_link_tag 'listings' %>

唯一的问题是现在，我想采取

```
<style type="text/css">  
  html { height: 100% }  
  body { height: 100%; margin: 0; padding: 0 }  
  #map_canvas { height: 100% }  
</style> 
```

这部分从 list.html.erb 中取出并放入 list.css.scss 文件中。但是当我这样做时 map_canvas 从页面上消失了，它没有显示。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-20T17:11:41.450

你把样式表放在哪里很好。您需要确保您的应用程序布局 ( `app/views/layouts/application.html.erb`) 在标题中包含样式表：

```
stylesheet_link_tag 'application' 
```

然后您需要确保它包含在您的应用程序清单中：`app/assets/stylesheets/application.css`

在顶部，您应该会看到一个如下所示的块：

```
/* ...
*= require_self
*= require_tree .
*/ 
```

如果它没有说`*= require_tree .`，那么它不会直接在你的样式表中自动加载 scss 文件。有关更多信息，请参阅[导轨指南](http://guides.rubyonrails.org/asset_pipeline.html#manifest-files-and-directives)。

如果您的应用程序布局和清单是正确的并且您仍然遇到问题，请将这些文件的文本添加到问题中，我会看一下。

* * *

更新：另外，您似乎没有正确理解布局。

当任何视图呈现时，您希望最终输出看起来像这样：

```
<!DOCTYPE HTML>
<html>
  <head>
    ...header stuff goes here...
  </head>
  <body>
    ... body stuff goes here...
  </body>
</html> 
```

您的标题等几乎是一直重复的标准内容，只有页面主要部分的内容因页面而异。所以为了避免你不得不一遍又一遍地复制这些东西，Rails 使用了布局。

您的布局文件`app/views/layouts/application.html.erb`应该如下所示（至少）

```
<!DOCTYPE html>
<html>
  <head>
    <title>The name of your site</title>
    <%= stylesheet_link_tag 'application' %>
    <%= javascript_include_tag 'application' %> 
    <%= csrf_meta_tags %>
  <head>
  <body>
    <%= yield %>
  </body>
</html> 
```

当您加载给定的视图时，rails 将填充该视图中的内容，其中*yield*命令在布局中。

请注意，您的视图命名错误。如果您正在显示一个列表，它应该是`app/views/listings/show.html.erb`，或者如果您正在显示它应该是所有列表的索引`app/views/listings/index.html.erb`。

然后在那个文件中你应该有：

```
<h1>This file is:"index.html.erb"</h1> 
```

[有关布局和渲染](http://guides.rubyonrails.org/layouts_and_rendering.html)的更多信息，请参阅 rails 指南。

但是，看起来您正试图潜入轨道，却不知道系统中发生了什么。欢迎来到 Rails，我想你会发现它真的很棒，但你会帮自己一个巨大的忙，从一个好的教程开始。您可以尝试[入门指南](http://guides.rubyonrails.org/getting_started.html)。我还推荐 Michael Hartl 的书“Rails 3 Tutorial”。这是一个很好的资源。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-07-04T10:56:42.673

我已经知道同样的问题但已解决，请按照以下说明进行操作

1.  将您的 xxxx.css 文件放在 assets/stylesheets 例如**app/assets/stylesheets/xxxx.css**

2.  编辑**/config/initializers/assets.rb**并粘贴此代码

`Rails.application.config.assets.precompile += %w( xxxx.css )` 并保存它。

**3-在您的list.html.erb**的头部标签部分添加

```
<%= stylesheet_link_tag 'xxxx' %> 
```

例如

```
<head>
<%= stylesheet_link_tag 'xxxx' %>
<head> 
```

4.重启rails服务器查看效果

寒意！！！！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T17:19:02.697

你应该有一个 stylesheet_link_tag 在`<head>`：

```
<%= stylesheet_link_tag 'application' %>
<%= javascript_include_tag 'application' %> 
```

如果您没有 application.css 清单，您可以直接链接到样式表：

```
<%= stylesheet_link_tag 'listings' %> 
```

# sql - 在 SQL 中计算棒球统计的比赛号码

> ID：10250469
> 
> 赞同：1
> 
> 时间：2012-04-20T17:03:09.087
> 
> 标签：sql, sql-server

我正在尝试分析一些棒球统计数据，但在实现看起来应该是一项简单的任务时遇到了一些麻烦。看一下以下结果集：

```
GAME_PK  REC_SEQ  BatterId  PlayNumber  EventType
287576   6        462101    1           single
287576   14       519048    2           single
287576   25       435079    3           strikeout
287576   26       435079    4           stolen_base_home
287576   28       435079    5           stolen_base_2b 
```

PlayNumber 列是由我使用 ROW_NUMBER() OVER (ORDER BY GAME_PK, REC_SEQ) 生成的。其余的直接来自 MLB 统计数据库。REC_SEQ 是游戏内事件的序号。EventType 本质上是 at-bat 的结果。

我希望 PlayNumber 仅在 BatterId 更改时才增加。但它必须尊重 REC_SEQ 的顺序。所以我认为我不能使用 RANK 或 DENSE_RANK，但这些似乎非常接近我的需要。

我希望我的结果集如下所示：

```
GAME_PK  REC_SEQ  BatterId  PlayNumber  EventType
287576   6        462101    1           single
287576   14       519048    2           single
287576   25       435079    3           strikeout
287576   26       435079    3           stolen_base_home
287576   28       435079    3           stolen_base_2b 
```

任何帮助表示赞赏。

谢谢！

编辑：在一场比赛中，击球手可以出现不止一次。每次出场都应该为他分配一个新的 PlayNumber。基本上，每个新的击球手都需要一个新的 PlayNumber。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:13:17.423

**编辑**：似乎可以完成的唯一方法是通过确定哪些顺序记录共享一个batterId来确定每个组的开始和结束位置。这是通过将记录与自身偏移 1 rownum 来确定每个组的开始位置来完成的。一旦我们收集了每个组的开头 ( `GroupSets`)，我们就可以确定每个单独的记录属于哪个组以生成正确的编号：

```
with GroupSets as (
select
    row_number() over (order by s1.rec_seq) as rownum,
    s1.game_pk, s1.rec_seq, s1.batterid, s2.batterid as nextbatterid,
    s1.eventtype
from (select *, row_number() over (order by rec_seq) as rownum from stats) s1
left join (select rec_seq, batterid,
           row_number() over (order by rec_seq) as rownum from stats) s2
    on s1.rownum = s2.rownum + 1
where s1.batterid != s2.batterid or s2.batterid is null
)
select
    game_pk,
    rec_seq,
    batterid,
    (select max(rownum) from GroupSets gs where gs.Rec_Seq <= s1.rec_seq) as PlayNumber,
    eventtype
from
    stats s1; 
```

演示：[http ://www.sqlfiddle.com/#!3/a5e68/50](http://www.sqlfiddle.com/#!3/a5e68/50)

* * *

不处理交错的旧代码：

实际上该`DENSE_RANK()`功能应该做到这一点。但是，我们需要对`MIN(REC_SEQ)`每个 BatterId 组的值进行排名，以便用于`REC_SEQ`控制顺序。这样的事情应该这样做：

```
select
    s1.game_pk,
    s1.rec_seq,
    s1.batterID,
    dense_rank() over (order by s2.rec_seq) as PlayNumber,
    s1.EventType
from
    stats s1
join
    (select batterid, min(rec_seq) rec_seq
     from stats group by batterid) s2 on s1.batterid = s2.batterid
order by
    rec_seq 
```

演示：[http ://www.sqlfiddle.com/#!3/0682e/4](http://www.sqlfiddle.com/#!3/0682e/4)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T18:22:27.787

这很难，但在 SQL Server 中是可能的。我会注意到 Oracle 的分析功能使这变得更加容易。

思路如下：

*   添加严格的序列号，以便您可以在每场比赛中获得上一场比赛
*   使用它在给定序列中第一次击球时添加一个标志
*   在游戏中枚举这些以获取游戏编号
*   通过适当的组将其加入统计数据以分配正确的播放号码

我认为以下代码可以解决问题：

```
with s_enum as 
(
   select s.*, ROW_NUMBER() over (partition by game_pk order by rec_seq) as Seq
   from stats
) s_cp as 
(
   select s.*, ROW_NUMBER() over (partition by game_pk, FirstInSeq) as BattingSeq
   from 
   (
     select s.*,
        (case when prev.BatterId = curr.BatterId then 1 else 0 end) as FirstInSeq
     from s_enum curr 
     left outer join s_enum prev
        on curr.game_pk = prev.game_pk 
        and curr.Seq = prev.Seq + 1
   )
)
select s.game_pk, s.batterid, s.rec_seq, MAX(bs.req_sec) as PlayNumber       
from stats s 
join
(
   select s.*
   from s_cp s
   where FirstInSeq = 1
) bs
  on s.game_pk = bs.game_pk 
  and s.batterid = bs.batterid 
  and s.rec_seq >= bs.req_sec
group by s.game_pk, s.batterid, s.rec_seq 
```

# css - 如何在移动 Safari 上禁用 iframe 边框？

> ID：10250471
> 
> 赞同：1
> 
> 时间：2012-04-20T17:03:10.110
> 
> 标签：css

似乎其他一些人也遇到了同样的问题。

在底部的联系表上：[http](http://ntcc.johnmbjerke.com) : //ntcc.johnmbjerke.com 通过 wufoo 加载的 iframe 有一个灰色的小边框（仅在 iOS safari 上），无论我在 css 中尝试过什么，它都不会消失. 想法？

截图在这里：[http ://d.pr/i/udQa](http://d.pr/i/udQa)

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-15T22:01:09.870

尝试添加一个 CSS 规则 -`overflow: hidden;` 至少对我有用。

# visual-studio-2010 - Excel 插件单击一次部署问题

> ID：10250475
> 
> 赞同：4
> 
> 时间：2012-04-20T17:03:40.263
> 
> 标签：visual-studio-2010, vsto, office-interop, excel-addins

当我在 Visual Studio 2010 中创建 Excel 2010 加载项项目并配置我的先决条件发布选项以单击一次部署时，'Microsoft Visual Studio 2010 Tools for Office Runtime (x86 and x64) 选项项在图标，屏幕提示显示“无法找到引导的先决条件”。一旦我尝试发布，它就可以正常发布，但是，我收到警告：

```
"Item 'Microsoft.VSTORuntime.4.0' could not be located in 'C:\Program Files\Microsoft SDKs\Windows\v8.0A\Bootstrapper\'." 
```

我尝试重新安装 VSTO 4.0 运行时来解决这个问题，但没有成功。任何想法如何解决此警告？

![新项目](../Images/487f9eece2d2c84e5aed45e23e2908be.png)

![先决条件](../Images/28a85fecd201ca7ac3d59c16ac6de009.png)

![警告](../Images/f71f75e365ff64459c255613580e2dd1.png) **更新** 卸载VS11，修复VS2010，然后卸载VS2010，重新安装后，我现在有这些问题：

![在此处输入图像描述](../Images/3f4b68650b3ca88602df7a287c20c4df.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T23:45:38.440

你有没有安装 Visual Studio 11，引导程序应该在这里 C:\Program Files\Microsoft SDKs\Windows\v7.0A\Bootstrapper

我得到了带有 Windows 7 Ultimate 的 VS2010。

# android - Robotium - setDatePicker() 不适用于 Android 4.0.4

> ID：10250478
> 
> 赞同：0
> 
> 时间：2012-04-20T17:04:01.950
> 
> 标签：android, robotium, testcase

大约 2 个月前，我使用 Robotium 创建了一个 TestCase，它在 Android 2.1、2.3.3 和 2.3.6 上运行良好。但是昨天我将手机更新到 4.0.4，现在我无法在`DatePickerDialog`.

在我最近的问题之前，这是我用来正确设置日期的行：

```
solo.setDatePicker(0, YEAR, MONTH, DAY_OF_MONTH); 
```

我也试过这个，但它不起作用：

```
solo.getCurrentDatePickers().get(0).updateDate(YEAR, MONTH, DAY_OF_MONTH); 
```

那么有没有人能够在 Android 4.0 和 Robotium 中设置 DatePicker ？我即将提交错误报告。

# arrays - 循环遍历数组并设置实例的可见属性 - ActionScript3

> ID：10250482
> 
> 赞同：1
> 
> 时间：2012-04-20T17:04:22.213
> 
> 标签：arrays, actionscript-3, variables

我将变量名存储在一个数组中，我想遍历数组并将该实例的可见属性设置为 false。但是，我遇到了错误；

> 错误 #1056：无法创建 String 上可见的属性。

这是我的代码：

```
package  {
    import flash.events.TouchEvent;
    import flash.ui.Multitouch;
    import flash.ui.MultitouchInputMode;
    import flash.display.MovieClip;
    import flash.events.MouseEvent;

    public class touch extends MovieClip
    {
        public function touch()
        {
            var menuitems:Array = new Array("menu_One", "menu_Two", "menu_Three", "menu_Three", "menu_Four", "menu_Five");//array with instance names
            for(var i:int=0;i<6;i++){
                var tempName = menuitems[i];
                bsF_txt.text = tempName;
                trace(tempName);
                tempName.visible = false;
                //menu_One.visible = false;
            }

         }
      }
} 
```

是。我想在 AS3 中做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T17:17:36.630

首先是的，这是可能的！

问题是您循环遍历字符串数组，而不是变量或引用 DisplayObject 的任何内容（在您的情况下可能是 MovieClip？）

假设这些字符串是您舞台上的 MovieClip 的实例名称或引用它们的变量，您可以尝试这样的操作：

```
public function touch()
    {
        var menuitems:Array = new Array(menu_One, menu_Two, menu_Three, menu_Three, "menu_Four", menu_Five);//if this gives you an error please paste some more code because these are not instance names or vars
        for(var i:int=0; i<menuitems.length ;i++){ //you don't need to explicitly use 6 here you can check the menuitems arrays length 
            var tempName = menuitems[i]; //note, this is not needed
            bsF_txt.text = tempName.name; //I think you're looking for this?
            trace(tempName);
            tempName.visible = false;
            //menu_One.visible = false;
        }

     }
  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T17:12:37.563

尝试使用以下代码（我刚刚注意到您说这些是实例名称......）

```
package  { 
import flash.events.TouchEvent; 
import flash.ui.Multitouch; 
import flash.ui.MultitouchInputMode; 
import flash.display.MovieClip; 
import flash.events.MouseEvent; 

public class touch extends MovieClip 
{ 
    public function touch() 
    { 
        var menuitems:Array = new Array("menu_One", "menu_Two", "menu_Three", "menu_Three", "menu_Four", "menu_Five");//array with instance names 
        for(var i:int=0;i<6;i++){ 
            var tempName = menuitems[i]; 
            bsF_txt.text = tempName; 
            trace(tempName); 
            getChildByName(tempName).visible = false; 
            //menu_One.visible = false; 
        } 

     } 
  } 
} 
```

主要的变化是你需要告诉 flash 你数组中的字符串是一个实例名称。所以使用`getChildByName`假设它们被添加到舞台。

当前代码失败的原因是因为您试图访问字符串上的可见属性，但`String`没有`visible`属性。但该字符串名称的实际实例可能。

# javascript - Extjs MVC文件夹结构无法加载文件

> ID：10250490
> 
> 赞同：2
> 
> 时间：2012-04-20T17:04:54.713
> 
> 标签：javascript, model-view-controller, extjs, extjs4, extjs-mvc

我想使用 extjs 4 框架来开发一个 Web 应用程序。这是我第一次接触这个框架，所以我从 Sencha 的教程开始。但是 mvc tut 有一个问题，我找不到我的错。

首先，我必须创建以下文件夹结构：

```
-account_manger
--app
--index.html
--app.js
--controller
---Users.js 
```

但是，当我启动网页时，来自 google chrome 的开发人员工具会创建此异常：

[http://localhost/account_manager/app/app/controller/Users.js?_dc=1334940930898](http://localhost/account_manager/app/app/controller/Users.js?_dc=1334940930898) 404（未找到）

似乎他正在寻找另一个文件夹“app”。但我现在不知道如何改变这一点。这是我在 app.js 中的代码：

`Ext.application({
name: 'AM', appFolder: 'app', controllers: [ 'Users'], ....launch function etc.. });`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T17:44:13.570

您应该创建以下结构：

```
AccountManager
├── index.html
├── app.js
└── app/
    ├── controller/
    │   └── Users.js
    ├── view/
    │   └── Users.js
    ├── model/
    │   ...
    └── store/
        ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T12:57:57.507

AccountManager 在这里工作演示[http://ext4all.com/post/extjs-4-mvc-application-architecture](http://ext4all.com/post/extjs-4-mvc-application-architecture)

# sql - 可以使用可选聚合和组的 SQL 查询？

> ID：10250491
> 
> 赞同：2
> 
> 时间：2012-04-20T17:04:58.873
> 
> 标签：sql, sql-server-2008

我需要使用汇总一列的选项运行一个巨大的查询。我想知道是否可以执行以下操作：

```
declare @sumIt bit
set @sumIt = 1

select ID, Name, CASE WHEN @sumIt=1 THEN sum(Time) ELSE Time END [timeCol]     
from Visits
where ID = 123
Group by ID, Name, CASE WHEN @sumIt=1 THEN '' ELSE Time END 
```

现在我收到一个错误：Msg 8120, Level 16, State 1, Line 4 列 'Visits.Time' 在选择列表中无效，因为它不包含在聚合函数或 GROUP BY 子句中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T18:56:23.553

我认为您可以执行以下操作：

```
declare @sumIt bit
set @sumIt = 1

select ID, Name,
       (CASE WHEN @sumIt=1 THEN sum(Time) ELSE min(Time) END) [timeCol]
from Visits
where ID = 123
Group by ID, Name, (CASE WHEN @sumIt=1 THEN '' ELSE Time END) 
```

您可以将聚合函数应用于按变量分组。这通常不这样做，但它可以解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T17:20:37.427

我还没有测试过，但这应该可以正常工作：

```
select ID, Name, sum([Time]) [timeCol]
from Visits
where ID = 123
AND @sumint = 1
Group by ID, Name
UNION ALL
select ID, Name, [Time] [timeCol]
from Visits
where ID = 123
AND @sumint = 0
Group by ID, Name, [Time] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T17:34:35.540

我想你可以采用动态 sql 方法。我自己对此并不疯狂，我只是使用 IF

```
declare @sumIt bit, @sql VARCHAR(1000)
set @sumIt = 0

SET @sql = 'select ID, Name, ' + CASE WHEN @sumIt=1 THEN 'sum(Time)' ELSE 'Time' END  + ' [timeCol]
from Visits
where ID = 123
Group by ID, Name' + CASE WHEN @sumIt=1 THEN '' ELSE ',Time' END

EXEC @sql 
```

# django - Django 管理员自定义与非相关模型

> ID：10250492
> 
> 赞同：2
> 
> 时间：2012-04-20T17:05:01.280
> 
> 标签：django

我是一个 django 菜鸟，我试图弄清楚如何让管理模块做一些与单个模型上的正常操作略有不同的事情。基本上我需要的是运行查询并将查询结果显示为视图页面，然后允许编辑页面的链接将用户带到现有模型的编辑视图。我的查询中的 3 个表中有 2 个是相关的，但不是全部 3 个。

例子：

```
select a.foo, a.second_field, b.bar, c.unrelated_field
from a, b, c
where a.primary_key = b.foreign_key
and a.some_value = c.some_value 
```

请注意，a 和 c 未定义为相关表。

我想查看此查询输出，并在选择时链接到整个 b 模型的编辑视图。

我在数据库中为此查询创建了一个视图，并简单地创建了一个新模型，可以轻松获取视图，但我不确定这是否是正确的开始方法......但从那里我可以'似乎不知道如何将此链接链接到 B 表的编辑页面。

任何关于如何最好地用 django admin 完成这样的事情的指示或建议将不胜感激！

顺便说一下，使用 Django 1.3.1。

干杯!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T04:24:05.800

您可以覆盖`change_view`您的`ModelAdmin`，因此它将构建一个包含所有您需要的数据的字典列表。然后覆盖`change_list.html`模板以正确显示此数据并将其与`change_form`正确模型的视图链接。所以它将完美地集成到 Django 的管理站点中。

而且我不喜欢数据库视图，只要没有它就可以解决问题。如果数据可以在 Python 中构建而没有巨大的性能差距和大量的魔术代码，那么它应该在 Python 中处理。

# visual-studio-2010 - Azure - 在没有 Azure 模拟器的情况下调试 Web 应用程序

> ID：10250495
> 
> 赞同：1
> 
> 时间：2012-04-20T17:05:06.143
> 
> 标签：visual-studio-2010, azure, azure-worker-roles

我有一个由我们自己托管的 Web 应用程序。

我们计划很快在 Azure 中托管，所以我添加了 Azure 项目。

现在，每当我调试时，都会加载 Azure 模拟器。在模拟器中调试非常慢。

我在**Configuration Manager**中取消选中 Azure 项目的**Debug 选项**，但它仍然使用 Azure Emulator 进行调试。

 *****无论如何我可以在没有 Azure Emulator 的情况下调试（比如我的旧的单个 Web 应用程序）吗？***我可以在调试时删除 Azure 项目，并在准备发布到 Azure 时再次创建它；但是，这并不方便。

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T18:36:00.460

如果您将 Web 角色项目（不是 azure/cloud 之一）设置为启动项目，您应该能够正常调试 Web（asp.net？）项目（在开发网络服务器、IIS 或 IIS express 上）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T18:41:01.023

要在不启动模拟器的情况下调试您的 Web 应用程序，您只需右键单击**Web 项目**，选择“**调试**” ，然后选择“**启动新实例**” ：

![在此处输入图像描述](../Images/9a98e1aa9e21260952d6994e1a745069.png)

现在，您必须注意一件事。默认情况下，您的 Web 应用程序的 web.config 中将包含以下内容：

```
<system.diagnostics>
  <trace>
    <listeners>
      <add type="Microsoft.WindowsAzure.Diagnostics.DiagnosticMonitorTraceListener, Microsoft.WindowsAzure.Diagnostics, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" name="AzureDiagnostics">
        <filter type="" />
      </add>
    </listeners>
  </trace>
</system.diagnostics> 
```

现在，如果您在应用程序中使用**Trace**和**Debug** ，则需要注释掉这一行。如果你不这样做，你最终会在使用 Trace 或 Debug 进行日志记录时出错：

*无法创建 Microsoft.WindowsAzure.Diagnostics.DiagnosticMonitorTraceListener、Microsoft.WindowsAzure.Diagnostics、Version=1.0.0.0、Culture=neutral、PublicKeyToken=31bf3856ad364e35。***

# php - 根据关键字提取数组中的特定 PHP 字符串

> ID：10250496
> 
> 赞同：1
> 
> 时间：2012-04-20T17:05:09.540
> 
> 标签：php, arrays, string, foreach, strpos

我有如下文本的注册表数据：

```
/Classes/CLSID/AppID,SZ,{0010890e-8789-413c-adbc-48f5b511b3af},
/Classes/CLSID/InProcServer32,KEY,,2011-10-14 00:00:33
/Classes/CLSID/InProcServer32/,EXPAND_SZ,%SystemRoot%\x5Csystem32\x5CSHELL32.dll,
/Classes/CLSID/InProcServer32/ThreadingModel,SZ,Apartment,
/Classes/CLSID/,KEY,,2011-10-14 00:00:36
/Classes/CLSID/,SZ,,
/Classes/CLSID/InprocServer32,KEY,,2011-10-14 00:00:36
/Classes/CLSID/InprocServer32/,C:\x5CWINDOWS\x5Csystem32\x5Cmstime.dll, 
```

然后我做 $registry = explode "\n" 并在下面创建数组列表：

```
var_dump($registry);

[1]=> string(121) "/Classes/CLSID/AppID,SZ,{0010890e-8789-413c-adbc-48f5b511b3af}," 
[2]=> string(139) "/Classes/CLSID/InProcServer32,KEY,,2011-10-14 00:00:33" 
[3]=> string(89) "/Classes/CLSID/InProcServer32/,EXPAND_SZ,%SystemRoot%\x5Csystem32\x5CSHELL32.dll," 
[4]=> string(103) "/Classes/CLSID/InProcServer32/ThreadingModel,SZ,Apartment," 
[5]=> string(103) "/Classes/CLSID/,KEY,,2011-10-14 00:00:36"
[6]=> string(121) "/Classes/CLSID/,SZ,," 
[7]=> string(139) "/Classes/CLSID/InprocServer32,KEY,,2011-10-14 00:00:36" 
[8]=> string(89) "/Classes/CLSID/InprocServer32/,C:\x5CWINDOWS\x5Csystem32\x5Cmstime.dll," 
```

我也有数组形式的关键字

```
var_dump($keywords);

[1]=> string(12) "Math.dll"
[2]=> string(12) "System.dll"
[3]=> string(12) "inetc.dll"
[4]=> string(12) "time.dll" 
```

我想在 $registry 中显示包含 $keywords 中的字符串的行，所以我在下面创建了 1 个函数：

```
 function separate($line) {
      global $keywords;
      foreach ($keywords as $data_filter) {
          if (strpos($line, $data_filter) !== false) {
        return true;
          }
      }
      return false;
    }

$separate = array_filter($registry, 'separate'); 
```

因为在 $keywords 中包含“time.dll”，所以代码产生的结果如下：

```
var_dump($seperate);

[1]=> string(89) "/Classes/CLSID/InprocServer32/,C:\x5CWINDOWS\x5Csystem32\x5Cmstime.dll," 
```

就我而言，结果不正确，因为 mstime.dll != time.dll 并且信息不正确。

输出应该是空的。

假设我将“\x5C”替换为空格，有什么功能可以完成这项工作吗？先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T17:12:21.963

有[preg_match](http://us3.php.net/manual/en/function.preg-match.php)。

要使用 array_filter 方式，您必须执行以下操作：

```
function separate($line) {
    global $keywords;
    foreach ($keywords as $data_filter) {
        // '.' means any character in regex, while '\.' means literal period
        $data_filter = str_replace('.', '\.', $data_filter);
        if (preg_match("/\\x5C{$data_filter}/", $line)) {
            return true;
        }
    }
    return false;
} 
```

这将返回 false

```
/Classes/CLSID/InprocServer32/,C:\x5CWINDOWS\x5Csystem32\x5Cmstime.dll, 
```

但对于

```
/Classes/CLSID/InprocServer32/,C:\x5CWINDOWS\x5Csystem32\x5Ctime.dll, 
```

如果您不熟悉[正则表达式](http://www.regular-expressions.info/)，它们非常棒且功能强大。您可以根据需要自定义我的以适应您的情况。

# ruby - Ruby on Rails 到 Visual Studio

> ID：10250497
> 
> 赞同：0
> 
> 时间：2012-04-20T17:05:14.263
> 
> 标签：ruby

我有一个用 Ruby on Rails 编写的软件。是否可以将数据/代码迁移/转换为 Visual Basic 或 C#？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T17:08:55.817

为什么要转换？[铁红宝石是你的朋友](http://accidentaltechnologist.com/ruby/running-rails-2-3-x-on-ironruby/)。

# php - 如何使用数组 php 中的变量调用类？

> ID：10250505
> 
> 赞同：2
> 
> 时间：2012-04-20T17:05:32.857
> 
> 标签：php, arrays, class

我想要这样的东西，但动态地从这样的数组中获取：

```
$array = array("first","second","third"); 
```

所以类会这样调用：

```
$class = new class("first","second","third"); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T17:07:35.190

您可以为此使用反射：

```
$refClass = new ReflectionClass('SomeClass');
$instance = $refClass->newInstanceArgs($args); 
```

# javascript - 如何让 rails rails_xss 停止在模板 Javascript 中转义？

> ID：10250508
> 
> 赞同：1
> 
> 时间：2012-04-20T17:05:42.307
> 
> 标签：javascript, ruby-on-rails, escaping

我正在开发一个带有大量 javascript 模板的 Rails 2.3 项目，我们刚刚安装了 rails_xss。但是，我们注意到模板中的原始 javascript 现在正在转义 HTML。

示例：_partial.html.erb

```
<script type="text/javascript">
    if (true == true)  && (1 == 1) {
    }
</script> 
```

正在呈现为 _partial.html.erb

```
<script type="text/javascript">
    if (true == true)  &amp;&amp; (1 == 1) {
    }
</script> 
```

是什么导致了这种情况，我们如何才能让它正确渲染？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T17:16:07.383

使用`raw`助手：

```
<%= raw "if (true == true)  && (1 == 1) {" %> 
```

或`html_safe`：

```
<%= "if (true == true)  && (1 == 1) {".html_safe %> 
```

# macos - mac osx Lion中的glutMainLoop冻结应用程序

> ID：10250510
> 
> 赞同：0
> 
> 时间：2012-04-20T17:05:48.807
> 
> 标签：macos, glut

我正在尝试运行一个示例 GLUT 程序，但它只创建一个白色窗口，然后冻结应用程序。我发现它在调用 glutMainLoop 时冻结（如果我在循环中调用 glutCheckLoop 也是如此）。我可能遗漏了什么？

这是我找到的示例代码：

```
#include <stdlib.h>

#ifdef __APPLE__
#include <GLUT/glut.h>
#else
#include <GL/glut.h>
#endif

// Question 1: In a GLUT program, how is control passed
// back to the programmer?  How is this set up during
// initialization?

int win_width = 512;
int win_height = 512;

void display( void )
{
  glClear( GL_COLOR_BUFFER_BIT );

  glutSwapBuffers();
}

void reshape( int w, int h )
{
  glMatrixMode( GL_PROJECTION );
  glLoadIdentity();

  // Question 3: What do the calls to glOrtho()
  // and glViewport() accomplish?
  glOrtho( 0., 1., 0., 1., -1., 1\. );
  glViewport( 0, 0, w, h );

  win_width = w;
  win_height = h;

  glutPostRedisplay();
}

void keyboard( unsigned char key, int x, int y ) {
  switch(key) {
  case 27: // Escape key
    exit(0);
    break;
  }
}

int main (int argc, char *argv[]) {

  glutInit( &argc, argv );
  // Question 2: What does the parameter to glutInitDisplayMode()
  // specify?
  glutInitDisplayMode( GLUT_RGBA | GLUT_DOUBLE );
  glutInitWindowSize( win_width, win_height );

  glutCreateWindow( "Intro Graphics Assignment 1" );

  glutDisplayFunc( display );
  glutReshapeFunc( reshape );
  glutKeyboardFunc( keyboard );

  glutMainLoop();
  return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:14:58.700

int main 不是你想要 glutMainLoop() 的地方，伙计。

你应该在你的 init 方法中拥有它，即 initGlutDisplay()。

```
#include <stdlib.h>

#ifdef __APPLE__
#include <GLUT/glut.h>
#else
#include <GL/glut.h>
#endif

// Question 1: In a GLUT program, how is control passed
// back to the programmer?  How is this set up during
// initialization?

int win_width = 512;
int win_height = 512;

void display( void )
{
  glClear( GL_COLOR_BUFFER_BIT );

  glutSwapBuffers();
}

void reshape( int w, int h )
{
  glMatrixMode( GL_PROJECTION );
  glLoadIdentity();

  // Question 3: What do the calls to glOrtho()
  // and glViewport() accomplish?
  glOrtho( 0., 1., 0., 1., -1., 1\. );
  glViewport( 0, 0, w, h );

  win_width = w;
  win_height = h;

  glutPostRedisplay();
}

void keyboard( unsigned char key, int x, int y ) {
  switch(key) {
  case 27: // Escape key
    exit(0);
    break;
  }
}
int initGlutDisplay(int argc, char* argv[]){
  glutInit( &argc, argv );
  // Question 2: What does the parameter to glutInitDisplayMode()
  // specify?
  glutInitDisplayMode( GLUT_RGBA | GLUT_DOUBLE );
  glutInitWindowSize( win_width, win_height );

  glutCreateWindow( "Intro Graphics Assignment 1" );

  glutDisplayFunc( display );
  glutReshapeFunc( reshape );
  glutKeyboardFunc( keyboard );

  glutMainLoop();
  return 0;
}
int main (int argc, char *argv[]) {
  int win_width = 512;
  int win_height = 512;
  initGlutDisplay(argc, argv);

} 
```

上面的代码应该可以完美运行。

**编辑**

根据[opengl](http://www.opengl.org/wiki/Programming_OpenGL_on_Mac_OS_X)

> AGL 是带有 C 绑定的旧的基于 Carbon 的 API。窗口和事件处理所需的 Carbon 部分不是线程安全的。此 API 没有 64 位版本。

我想知道这是不是你的问题。我会查看苹果的[opengl 编程指南](http://developer.apple.com/library/mac/#documentation/GraphicsImaging/Conceptual/OpenGL-MacProgGuide/opengl_intro/opengl_intro.html)，看看你是否错过了任何可能解决问题的步骤。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T10:26:21.283

这是编译器中的一个错误（现在可以与 gcc 一起使用）

# node.js - 如何将其转换为 JADE 模板引擎？

> ID：10250511
> 
> 赞同：0
> 
> 时间：2012-04-20T17:05:49.310
> 
> 标签：node.js, pug

我不知道如何转换此代码：

```
<!--[if IE 9]>
    <style>
        .spread{
            font-size: 12px;
        }
    </style>    
<![endif]--> 
```

在玉。有人可以帮助我吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-21T01:43:47.813

```
//if IE 9
  style
    .spread{font-size: 12px;} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-21T02:03:12.577

教人钓鱼...

[http://html2jade.aaron-powell.com/](http://html2jade.aaron-powell.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T17:40:54.660

您可能应该保持原样，因为翡翠支持内联 html。

# vb.net - 在 vb.net 中转换或解析文本

> ID：10250514
> 
> 赞同：1
> 
> 时间：2012-04-20T17:05:58.603
> 
> 标签：vb.net, parsing, casting

在 vb 中，您可以使用文本框中的文本而不是数字表达式。我的意思是，如果我在 textbox1 中写 50 并且我也可以这样写：

```
 Dim result As Double = TextBox1.Text + 0.4 
```

如您所见，我没有转换任何类型，但它可以在 vb.net 中使用

但我想了解这种使用的缺点是什么？

（我只是在谈论算术运算）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T18:43:11.273

在引擎盖下 VB.net 正在对`TextBox1.Text`(ie `CType(TextBox1.Text, Double)`) 进行隐式缩小转换以使其工作。这意味着你已经`Option Strict`**关闭**。**这样做的最大**缺点可能是您将违背 Option Strict On 的最佳实践。

通过关闭 Option Strict，您可以防止编译器强制执行类型检查。这允许您以更 VB6 的方式编写代码。因此，允许缩小范围的隐式转换。如果您已将其打开，则只允许扩大转化（没有潜在的负面影响）。

虽然在这种特定情况下，这似乎没什么大不了的，但是将其留给整个代码库可能会导致细微的错误蔓延。

我建议[在 MSDN 上阅读有关 Widening and Narrowing Conversions (Visual Basic) 的内容](http://msdn.microsoft.com/en-us/library/k1e94s7e%28v=vs.100%29.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T18:44:29.763

在 VB.NET 中，只有关闭 OPTION STRICT 才能摆脱这种情况 - 否则，您将产生错误。

在编程中，您应该始终尝试尽可能精确地使用您的数据类型。因此，您可以将代码行编写为：

```
Dim result as Double = Convert.ToDouble(TextBox1.Text) + 0.4 
```

或者，您可以进行一些错误捕获：

```
Dim Result as Double
Try
Result = Convert.ToDouble(TextBox1.Text) + 0.4
Catch
Result = 0
End Try 
```

您可以使用很多其他的东西，包括 TryParse。你甚至可以使用像 CDbl 这样的 VBA 函数。

如果您依赖于所谓的隐式类型转换，VB.NET 将尝试为您转换数据类型。这种方法的缺点是它会导致惰性编程。在这种情况下，您希望 VB.NET 具有容错性，但如果您不这样做呢？如果您允许它纠正您的错误，您最终会遇到产生错误的情况，因为您的代码没有强制执行正确的数据类型。

对 - 派对结束了。就个人而言，我非常喜欢 VBA 在幕后为我转换数据类型的方式！

# tfs - TFS2010 构建队列有时有多个 InProgress 构建，有时没有 - 逻辑是什么？

> ID：10250518
> 
> 赞同：2
> 
> 时间：2012-04-20T17:06:34.177
> 
> 标签：tfs, tfsbuild

我相当大的项目使用封闭式构建，并带有高度定制的流程模板 (XAML)。由于超出此问题范围的原因，我们的流程只有一个 SharedResourceScope，因此多个构建不会并行运行（我知道您应该使用代理范围来执行此操作，但我们在中间切换代理，所以包装SharedResourceScope 的所有内容）。

现在，如果队列中有多个签入，则所有签入都进入“进行中”状态，并且除了一个之外，所有签入都在 SharedResourceScope 上等待。这意味着：

*   人们无法知道实际运行的是哪个构建
*   即使我将一个新的排队签到设置为高优先级，它也无法超过所有正在进行和等待 SharedResourceScope 的人，因此整个优先级设置没有什么意义。

我已经尝试使用 DefaultProcessTemplate.XAML，并且我发现通常只有一个构建正在进行中（尽管偶尔我会看到 2 个构建）。

问题：

1.  构建究竟什么时候开始，因此进入“进行中”模式？是什么阻止了所有构建立即启动并阻止 AgentScope / SharedResourceScope？

2.  我可以在我的 XAML 中创作一些东西来阻止所有构建进行吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T11:05:48.280

当构建控制器有能力开始一个新的构建时，构建就开始了。由于构建可以使用 0 到 n 个代理，因此控制器不会在构建开始之前等待获取代理。控制器根据控制器属性上的“最大并发构建数”设置确定其容量（在代码中：）`MaxConcurrentBuilds`。默认设置：“默认为代理数量”。

XAML 中无法控制此行为。

此外，TFS2010 中有一个关于此的错误，修补程序：[KB2567437](http://support.microsoft.com/kb/2567437)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T12:10:27.127

使用[TFS Build Extensions](http://tfsbuildextensions.codeplex.com/)，您可以获得许多活动，您可以通过这些活动管理代理控制：`QueryBuildAgentStatus`，`IsBuildRunning`，`SetBuildAgentStatus`仅举几例对您有用的。到目前为止，它们还没有被记录在案，所以你必须尝试让它们运行。但是软件包中包含一个有用的帮助文件。

至于“进行中”模式，我注意到这是即使构建正在等待自由代理的状态；检查此类构建的日志，您会看到。这很令人困惑，我希望MS将添加一个“排队（但未启动）”模式。

# c++ - 在 std::for_each 中调用 std::function

> ID：10250519
> 
> 赞同：6
> 
> 时间：2012-04-20T17:06:40.687
> 
> 标签：c++, c++11, std

我本质上有以下代码：

```
typedef std::function<void ()> fnGlobalChangeEvent;
typedef std::vector<fnGlobalChangeEvent> GlobalTriggers;

inline void ExecuteGlobal(fnGlobalChangeEvent ev)
{
    ev();
}

GlobalTriggers triggers;
std::for_each(triggers.begin(), triggers.end(), std::bind(&ExecuteGlobal, _1)); 
```

在这里使用 ExecuteGlobal 感觉完全多余，但我找不到正确的语法来退出调用。

```
std::for_each(triggers.begin(), triggers.end(), ExecuteGlobal(_1));
std::for_each(triggers.begin(), triggers.end(), std::bind(_1)); 
```

两者都无法编译。

还有一个更复杂的情况：

```
typedef std::function<void (Zot&)> fnChangeEvent;
typedef std::vector<fnChangeEvent> Triggers;

inline void Execute(fnChangeEvent ev, Zot& zot)
{
    ev(zot);
}

Triggers triggers;
std::for_each(triggers.begin(), triggers.end(), std::bind(&Execute, _1, zot)); 
```

在这些情况下是否可以不使用辅助功能？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-20T17:13:24.873

当然，一个 lambda：

```
std::for_each(
    triggers.begin(), triggers.end(),
    [](fnChangeEvent ev) { ev(); }
);
std::for_each(
     triggers.begin(), triggers.end(),
     [&zot](fnChangeEvent ev) { ev(zot); }
); 
```

甚至更好，范围为：

```
for (auto ev : triggers) {
    ev();
}

// well, I think you can figure out the second one 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-20T17:15:31.470

为什么不使用 lambda 作为：

```
std::for_each(triggers.begin(), 
              triggers.end(), 
              [&](fnChangeEvent & e) 
              {
                   e(zot);
              }); 
```

或使用基于范围的 for 循环：

```
for (auto& e : triggers)  { e(zot); } 
```

看起来更简洁，更干净。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T17:41:06.110

这是我刚刚想到的东西，告诉我它是否像您正在寻找的东西：

```
template<typename IT, typename ...Args>
void call_each(IT begin_, IT end_, Args&&... args)
{
    for (auto i = begin_; i!=end_; ++i)
        (*i)(std::forward<Args>(args)...);
} 
```

然后你可以像这样使用它：

```
call_each(triggers.begin(), triggers.end()); 
```

对于带参数的函数：

```
call_each(triggers.begin(), triggers.end(), zot); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-29T14:36:00.053

只是，所以我不会忘记那个选项：

```
typedef std::function<void ()> fnGlobalChangeEvent;
typedef std::vector<fnGlobalChangeEvent> GlobalTriggers;

GlobalTriggers triggers;
using namespace std::placeholders;
std::for_each(triggers.begin(), triggers.end(), std::bind(&fnGlobalChangeEvent::operator(), _1)); 
```

# android - 将 DIP（依赖反转）应用于 Android 活动类

> ID：10250524
> 
> 赞同：1
> 
> 时间：2012-04-20T17:07:02.770
> 
> 标签：android

是否可以将 DIP 应用于 Android 活动？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T20:22:51.400

您可以使用[RoboGuice](http://code.google.com/p/roboguice/)在 Android 上进行依赖注入。它使用 Google 的 Guice 框架。

# android - 快速阅读联系人android

> ID：10250530
> 
> 赞同：1
> 
> 时间：2012-04-20T17:07:51.373
> 
> 标签：android, android-contacts

有没有更快的方法来读取 android 中的联系人？例如，我使用光标的方法需要 3-5 秒才能读取 30-50 个联系人。它很长。

```
 Cursor cursor =  managedQuery(ContactsContract.Contacts.CONTENT_URI, null, null, null, null);      
           while (cursor.moveToNext()) 
           {           
               String contactId = cursor.getString(cursor.getColumnIndex(ContactsContract.Contacts._ID));

               String hasPhone = cursor.getString(cursor.getColumnIndex(ContactsContract.Contacts.HAS_PHONE_NUMBER));

               if ( hasPhone.equalsIgnoreCase("1"))
                   hasPhone = "true";
               else
                   hasPhone = "false" ;

               if (Boolean.parseBoolean(hasPhone)) 
               {
                Cursor phones = getContentResolver().query(ContactsContract.CommonDataKinds.Phone.CONTENT_URI, null,ContactsContract.CommonDataKinds.Phone.CONTACT_ID +" = "+ contactId,null, null);
                while (phones.moveToNext()) 
                {
                  names.add(cursor.getString(cursor.getColumnIndexOrThrow(ContactsContract.Contacts.DISPLAY_NAME))); 
                  numbers.add(phones.getString(phones.getColumnIndex(ContactsContract.CommonDataKinds.Phone.NUMBER)));
                }
                phones.close();
               }
          } 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-24T14:01:04.013

对不起，我的英语不好。我使用 HashMap 创建了类似但风格不同的东西。我将粘贴我的方法。

```
 //Create a hashMap, Key => Raw Contact ID and value => Object of customClass

            HashMap<Long, ContactStructure> mFinalHashMap = new HashMap<Long, ContactStructure>();

            //Run IN query in data table. example

             select mimetype_id, raw_contact_id, data1 to data14 from data where raw_contact_id IN (select _id from raw_contacts where deleted <> 1 and account_type = "phone" and account_name = "bla bla") and mimetype_id = (select _id from mimetypes where mimetype = "vnd.something.phone"); 
```

现在创建一个包含所有联系人数据的类。

在访问游标时。

```
 while (cursor.moveToNext()) {
                ContactStructure contactStructure = mFinalHashMap.get(rawContactID);
        //It will return the previous instance of object, If we already put
                    if(rawContactStructure == null) {
                        contactStructure = ContactStructure.provideInstance();
                    }

    //Now check for your required mimeType
                           case MIMETYPE_PHONE:
                    contactStructure.hasPhoneNo = true;
                    contactStructure.phoneNumbers.add(addDetail); //add the data1 .. to data14
                break;

            }

    /*Demo class for saving the details*/
    public class ContactMetaData {
        static classContactStructure {
                   boolean          hasPhoneNo;
            List<List<String>>  phoneNumbers; 
    public static ContactStructure provideInstance() {
contact.phoneNumbers = new ArrayList<List<String>>();
            ContactStructure contact = new RawContactStructure();
return contact
    }

    } 
```

使用这种方法，我尝试了 3000 个联系人的所有数据，速度很快。因为在几秒钟内获取所有联系人及其所有数据并不容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T17:19:32.713

你的问题很有趣....

读取快速联系人，因为从 ContactsContract 读取联系人数据需要时间。

我不知道您使用的另一种方式，但是您仍然可以通过向 managedQuery 提供 String [] 投影参数来提高性能...

仅从联系人合同中获取您需要的那些数据，因为通过提供空值，它会获取记录的所有列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-18T14:30:13.590

为了更快地阅读联系人，您需要使用投影的概念，您只需指定需要获取的列。

```
 cursor.moveToFirst();
    while (cursor.isAfterLast() == false) {

        String contactNumber = cursor.getString(cursor.getColumnIndex(ContactsContract.CommonDataKinds.Phone.NUMBER));
        String contactName = cursor.getString(cursor.getColumnIndex(ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME));
        int phoneContactID = cursor.getInt(cursor.getColumnIndex(ContactsContract.CommonDataKinds.Phone._ID));
        int contactID = cursor.getInt(cursor.getColumnIndex(ContactsContract.Contacts._ID));
        Log.d("con ", "name " + contactName + " " + " PhoeContactID " + phoneContactID + "  ContactID " + contactID)

        cursor.moveToNext();
    } 
```

这将帮助您将完整教程的时间减少 90% 我使用了这个网站[http://www.blatin.in/2016/02/loading-contacts-fast-from-android.html](http://www.blazin.in/2016/02/loading-contacts-fast-from-android.html)

# c++ - 在 QTextEdit 中设置行距

> ID：10250533
> 
> 赞同：12
> 
> 时间：2012-04-20T17:08:03.597
> 
> 标签：c++, qt

我想设置 QTextEdit 的行距。

获取这些信息没有问题

```
QFontMetrics::lineSpacing(); 
```

**但是如何设置呢？**

我尝试使用 StyleSheets，但没有奏效：

```
this->setStyleSheet("QTextEdit{ height: 200%; }"); 
```

或者

```
this->setStyleSheet("QTextEdit{ line-height: 200%; }"); 
```

**部分解决方案：**

好吧，我找到了一个解决方案——不是我想要的方式，但至少它很简单，而且它几乎给出了我想要的行为，足以证明我的概念。

在每条新行上都有一些行距。但是，如果您只是键入直到文本自动换行到新行，则这两行之间不会有行距。此 hack 仅适用于文本块，请参阅代码。

请记住，这是蛮力和丑陋的黑客攻击。但它为您漂亮的 QTextEdit 提供了某种行距。每次文本更改时调用它。

```
void setLineSpacing(int lineSpacing) {
    int lineCount = 0;
    for (QTextBlock block = this->document()->begin(); block.isValid();
            block = block.next(), ++lineCount) {
        QTextCursor tc = QTextCursor(block);
        QTextBlockFormat fmt = block.blockFormat();
        if (fmt.topMargin() != lineSpacing
                || fmt.bottomMargin() != lineSpacing) {
            fmt.setTopMargin(lineSpacing);
            //fmt.setBottomMargin(lineSpacing);
            tc.setBlockFormat(fmt);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T17:26:35.400

QFontMetrics 包含（按名称）来自字体文件的静态属性。大写字母“C”的宽度等为 `lineSpacing()`您提供了设计字体的人编码到字体本身的单间距的自然距离。如果你真的想改变*它*（你不想）......这里讲述的有点复杂的故事：

[http://fontforge.sourceforge.net/faq.html#linespace](http://fontforge.sourceforge.net/faq.html#linespace)

至于 QTextEdit 中的行间距......它看起来（对我来说）被视为属于 Qt 用于指定文本“布局”的可扩展性模型的事情之一：

[http://doc.qt.io/qt-4.8/richtext-layouts.html](http://doc.qt.io/qt-4.8/richtext-layouts.html)

您将向 QTextDocument 提供您自己的布局类，而不是使用默认值。有人在这里尝试过，但没有发布他们完成的代码：

[http://www.qtcentre.org/threads/4198-QTextEdit-with-custom-space-between-lines](http://www.qtcentre.org/threads/4198-QTextEdit-with-custom-space-between-lines)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-02-07T18:19:08.337

我知道这是一个老问题，但我今天花了很多时间试图为 PyQt5 5.15.2 解决这个问题。我发布我的解决方案以防它对其他人有用。该解决方案适用于 Python，但应该易于移植。

以下代码将一次性将填充的 QTextEdit 小部件的行高更改为 150%。进一步的编辑将选择当前的块格式，并继续应用它。我发现它对于大型文档来说非常慢。

```
textEdit = QTextEdit()

# ... load text into widget here ...

blockFmt = QTextBlockFormat()
blockFmt.setLineHeight(150, QTextBlockFormat.ProportionalHeight)

theCursor = textEdit.textCursor()
theCursor.clearSelection()
theCursor.select(QTextCursor.Document)
theCursor.mergeBlockFormat(blockFmt) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-04-30T06:03:47.797

将块格式应用于整个文档而不是每一行都有效。

```
QTextBlockFormat bf = this->textCursor().blockFormat();
bf.setLineHeight(lineSpacing, QTextBlockFormat::LineDistanceHeight) ;
this->textCursor().setBlockFormat(bf); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-08-15T08:41:33.500

我已将[Jadzia626](https://stackoverflow.com/users/5825851/jadzia626)的代码翻译成 C++ 并且可以正常工作。以下是有关信息[`setLineHeight()`](https://doc.qt.io/qt-5/qtextblockformat.html#setLineHeight)

```
qreal lineSpacing = 35;
QTextCursor textCursor = ui->textBrowser->textCursor();

QTextBlockFormat * newFormat = new QTextBlockFormat();
textCursor.clearSelection();
textCursor.select(QTextCursor::Document);
newFormat->setLineHeight(lineSpacing, QTextBlockFormat::ProportionalHeight);
textCursor.setBlockFormat(*newFormat); 
```

# tcl - 显示给定开始和结束日期的所有日期

> ID：10250536
> 
> 赞同：1
> 
> 时间：2012-04-20T17:08:23.960
> 
> 标签：tcl

我的以下代码获取 2 个日期

```
foreach records $get_times {
        lassign $records start_date stop_date
        puts [clock format [clock scan $start_date] \
            -format {%d %b}]
        puts [clock format [clock scan $stop_date] \
            -format {%d %b}]
} 
```

有没有办法可以显示 start_tdate 和 stop_date 之间的所有日期。就像是：

```
puts "<tr><td>the $start_date</td>the next Date</td><td>....</td><td>the $stop_date</td>" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T17:28:25.260

假设您的意思是要在 start_date 和 stop_date 之间打印每一天，我会在 while 循环中使用**时钟添加。**

```
set start_date [clock scan {2012-04-20 00:00:00} -format {%Y-%m-%d %H:%M:%S}]
set stop_date [clock scan {2012-04-24 00:00:00}  -format {%Y-%m-%d %H:%M:%S}]
while {$start_date<$stop_date} {
  set start_date [clock add $start_date 1 day]
  puts $start_date
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T17:19:02.693

您可以使用`clock scan`' 使用“英语”时间框架的能力来获得您正在寻找的内容。例如：

```
set start_ts [clock scan $start_date]
set end_ts [clock scan $stop_date]
for {set current $start_ts} {$current < $end_ts} {set current [clock scan "+1 day" -base $current} {
    puts [clock format $current -format {%d %b}]
} 
```

# lightbox - 在灯箱中打开 div 中的所有链接

> ID：10250538
> 
> 赞同：0
> 
> 时间：2012-04-20T17:08:27.767
> 
> 标签：lightbox

我试图弄清楚如何在灯箱中打开 div 中的所有图像。该 div 正在从 picasa 相册中提取图像，因此我无法单独编辑每个链接。

对我也有用的是能够在灯箱中打开某种文件类型的所有链接。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-08T15:40:46.090

您可以使用灯箱： http: [//lokeshdhakar.com/projects/lightbox2/](http://lokeshdhakar.com/projects/lightbox2/)

例如（头部的前三行 - 确保在 imgs 文件夹中有关闭按钮之类的图像）：

```
<script src="jquery-1.11.0.min.js"></script>
<script src="lightbox.min.js"></script>
<link href="css/lightbox.css" rel="stylesheet" />    

<a href="img/image-2.jpg" data-lightbox="roadtrip">Image #2</a>
<a href="img/image-3.jpg" data-lightbox="roadtrip">Image #3</a>
<a href="img/image-4.jpg" data-lightbox="roadtrip">Image #4</a> 
```

由于您使用的是 picasa，请将 href 更改为图像的适当链接。如果您使用的是 php，则使用带有 echo 的 for 循环等...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-19T08:09:55.133

尝试符合您要求的漂亮画廊。[照片库演示](http://www.no-margin-for-errors.com/projects/prettyphoto-jquery-lightbox-clone/#prettyPhoto)。

我通过单击在灯箱中显示画廊的按钮在 pikaChoose 的照片库上创建了一个放大按钮。pikaChoose 的显示代码是

```
 jQuery(".pika-stage #enlarge a").live('click',function(){ 
            jQuery.fn.prettyPhoto();            
            jQuery.prettyPhoto.open(api_gallery,api_titles,api_descriptions);
            return false;
             }); 
```

我希望这对你有用

# php - 从 xpath 查询中排除节点

> ID：10250540
> 
> 赞同：4
> 
> 时间：2012-04-20T17:08:33.947
> 
> 标签：php, xpath, simplexml

这是我目前正在使用的一些代码。我需要帮助的地方是`$bn_name_search`和`$bn_id_search`

```
$xpath_base='/ItemSearchResponse/Items/Item[';
for ($i = 1; $i<=10; $i++)
  {
    $curr_item_base=$xpath_base.$i.']';
    $bn_name_search=$curr_item_base.'/BrowseNodes//BrowseNode/Name/text()';
    $bn_id_search=$curr_item_base.'/BrowseNodes//BrowseNode/BrowseNodeId/text()';
    $bn_names=$parsed->xpath($bn_name_search);
    $bn_ids=$parsed->xpath($bn_id_search);
  } 
```

这给了我所有 browsnode 名称和所有 broswnode id。我现在想做的是只找到`BrowseNode/Name/`不是“所有产品”的浏览节点名称“”，并且只有浏览节点 ID“`BrowseNode/BrowseNodeId/`共享一个” `BrowseNode/`，名称不是“所有产品”我不必测试的存在`BrowseNode/Name`。如果有 ID，则不会为空。如果我能放两个否定的表达就更好了。我会省略那些名字是“所有产品”和名字是“部门”的人

**编辑：** 这是 XML 的一个块：在它说“ `&lt;Name&gt;Departments&lt;/Name&gt;`”的地方，我想排除那个名字和它的 ID。如果我有一个类似的人说“ `&lt;Name&gt;All Products&lt;/Name&gt;`”，我也想排除那个名字和它的 ID。（通过ID，我的意思是`&lt;BrowseNodeId&gt;`）

```
<BrowseNodes>
  <BrowseNode>
    <BrowseNodeId>2346727011</BrowseNodeId>
    <Name>Casual</Name>
    <Ancestors>
      <BrowseNode>
        <BrowseNodeId>1045024</BrowseNodeId>
        <Name>Dresses</Name>
        <Ancestors>
          <BrowseNode>
            <BrowseNodeId>1040660</BrowseNodeId>
            <Name>Women</Name>
            <Ancestors>
              <BrowseNode>
                <BrowseNodeId>1036682</BrowseNodeId>
                <Name>Departments</Name>
                <IsCategoryRoot>1</IsCategoryRoot>
                <Ancestors>
                  <BrowseNode>
                    <BrowseNodeId>1036592</BrowseNodeId>
                    <Name>Clothing &amp; Accessories</Name>
                  </BrowseNode>
                </Ancestors>
              </BrowseNode>
            </Ancestors>
          </BrowseNode>
        </Ancestors>
      </BrowseNode>
    </Ancestors>
  </BrowseNode>
</BrowseNodes> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T18:35:28.447

在没有看到您的 xml 结构的情况下，我想出了 xpath 来实现我认为您正在尝试做的事情。我也不太确定`BrowseNodeId`“共享”浏览节点名称，我认为这意味着`BrowseNodeId`为所有`BrowseNode`名称设置为此的 s 提供 s。

我在 php 之外结合了您的 xpath 以更好地可视化它：

```
/ItemSearchResponse/Items/Item[i]/BrowseNodes//BrowseNode/Name/text()
/ItemSearchResponse/Items/Item[i]/BrowseNodes//BrowseNode/ 
```

组合解决方案：

```
/ItemSearchResponse/Items/Item[i]/BrowseNodes//BrowseNode/Name[text()!='All Products']/text()
/ItemSearchResponse/Items/Item[i]/BrowseNodes//BrowseNode[Name/text()!='All Departments']/BrowseNodeId/text() 
```

php解决方案：

```
$xpath_base='/ItemSearchResponse/Items/Item[';
for ($i = 1; $i<=10; $i++)
  {
    $curr_item_base=$xpath_base.$i.']';
    $bn_name_search=$curr_item_base.'/BrowseNodes//BrowseNode/Name[text()!='All Products']';
    $bn_id_search=$curr_item_base.'/BrowseNodes//BrowseNode[Name/text()!='All Departments']/BrowseNodeId/text()';
    $bn_names=$parsed->xpath($bn_name_search);
    $bn_ids=$parsed->xpath($bn_id_search);
  } 
```

**更新** 要结合 xpath，您可以使用 concatenate `|`：

```
/ItemSearchResponse/Items/Item[i]/BrowseNodes//BrowseNode[Name/text()!=\'Departments\' and Name/text()!=\'All Products\']/BrowseNodeId/text() | 
/ItemSearchResponse/Items/Item[i]/BrowseNodes//BrowseNode/Name[text()!=\'All Products\' and text()!=\'Departments\'] 
```

php：（ **更新）**

```
$bn_combined_search=$curr_item_base.'/BrowseNodes//BrowseNode[Name/text()!=\'Departments\' and Name/text()!=\'All Products\']/BrowseNodeId/text() |'.$curr_item_base.'/BrowseNodes//BrowseNode/Name[text()!=\'All Products\' and text()!=\'Departments\']'; 
```

如果我做出了错误的假设，请发布您的一些 xml 并详细说明您正在寻找的解决方案。希望这可以帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T22:48:48.233

你去：

```
$nodes = $parsed->xpath("//BrowseNode[Name!='Departments' and Name!='All Products']");
foreach ($nodes as $node) {
    echo "Id: {$node->BrowseNodeId}, name: {$node->Name}\n";
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-21T04:03:36.280

**使用**：

```
//BrowseNode
      [not(contains('|Departments|All Products|',
                    concat('|', Name, '|')
                    )
          )
      ]/Name 
```

此表达式选择`Name`作为元素的子`BrowseNode`元素且其字符串值不是字符串之一的`"Departments"`任何元素`"All Products"`。

**使用**：

```
//BrowseNode
      [not(contains('|Departments|All Products|',
                    concat('|', Name, '|')
                    )
          )
      ]
       /BrowseNodeId 
```

这将选择`BrowseNodeId`作为元素的子`BrowseNode`元素并且具有`Name`其字符串值不是字符串之一的兄弟元素的`"Departments"`任何元素`"All Products"`。

**基于 XSLT 的验证**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="/">
  <xsl:copy-of select=
   "//BrowseNode
      [not(contains('|Departments|All Products|',
                    concat('|', Name, '|')
                    )
          )
      ]/Name
      "/>
=================

  <xsl:copy-of select=
   "//BrowseNode
      [not(contains('|Departments|All Products|',
                    concat('|', Name, '|')
                    )
          )
      ]
       /BrowseNodeId
      "/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<BrowseNodes>
    <BrowseNode>
        <BrowseNodeId>2346727011</BrowseNodeId>
        <Name>Casual</Name>
        <Ancestors>
            <BrowseNode>
                <BrowseNodeId>1045024</BrowseNodeId>
                <Name>Dresses</Name>
                <Ancestors>
                    <BrowseNode>
                        <BrowseNodeId>1040660</BrowseNodeId>
                        <Name>Women</Name>
                        <Ancestors>
                            <BrowseNode>
                                <BrowseNodeId>1036682</BrowseNodeId>
                                <Name>Departments</Name>
                                <IsCategoryRoot>1</IsCategoryRoot>
                                <Ancestors>
                                    <BrowseNode>
                                        <BrowseNodeId>1036592</BrowseNodeId>
                                        <Name>Clothing &amp; Accessories</Name>
                                    </BrowseNode>
                                </Ancestors>
                            </BrowseNode>
                        </Ancestors>
                    </BrowseNode>
                </Ancestors>
            </BrowseNode>
        </Ancestors>
    </BrowseNode>
</BrowseNodes> 
```

**计算两个 XPath 表达式，并将它们的结果（由`"========"`字符串分隔）复制到输出**。

因此，我们可以从转换结果中验证是否准确地选择了想要的元素`Name`和`BrowseNodeId`元素：

```
<Name>Casual</Name>
<Name>Dresses</Name>
<Name>Women</Name>
<Name>Clothing &amp; Accessories</Name>
=================

<BrowseNodeId>2346727011</BrowseNodeId>
<BrowseNodeId>1045024</BrowseNodeId>
<BrowseNodeId>1040660</BrowseNodeId>
<BrowseNodeId>1036592</BrowseNodeId> 
```

# node.js - 适用于 www.500px.com 的 Connect-auth 的 Oauth

> ID：10250547
> 
> 赞同：0
> 
> 时间：2012-04-20T17:09:09.293
> 
> 标签：node.js, oauth

我正在尝试扩展 connect-auth (https://github.com/ciaranj/connect-auth) 以连接到[http://www.500px.com](http://www.500px.com) oauth，但是遇到了问题并且找不到方法除了 console.log 之外的调试。

1.  我添加了一个策略 Five00px.js（不能命名变量 500px），如下所示，它是 twitter.js 策略的副本，带有一些字符串替换。

2.  我不断收到无效的 OAuth 请求

    检索 OAuth 请求令牌时出错：{"statusCode":401,"data":"Invalid OAuth Request"}

3.  我真的看不到 OAUTH 请求，因为它在 HTTP 中。

任何想法 ？

```
 // five00px.js
    /*!
 * Copyright(c) 2010 Ciaran Jessup <ciaranj@gmail.com>
 * MIT Licensed
 */
var OAuth= require("oauth").OAuth,
    url = require("url"),
    http = require('http');

module.exports= function(options, server) {
  options= options || {}
  var that= {};
  var my= {};

  // Construct the internal OAuth client
  my._oAuth= new OAuth("https://api.500px.com/v1/oauth/request_token",
                         "https://api.500px.com/v1/oauth/access_token", 
                         options.consumerKey,  options.consumerSecret, 
                         "1.0A", options.callback || null, "HMAC-SHA1");
  console.log('1');
  // Give the strategy a name
  that.name  = "five00px";

  // Build the authentication routes required 
  that.setupRoutes= function(app) {console.log('2setupRoutes');
    app.use('/auth/five00px_callback', function(req, res){console.log('3five00px_callback');
      req.authenticate([that.name], function(error, authenticated) {console.log('4authenticate');
        res.writeHead(303, { 'Location': req.session.five00px_redirect_url });
        res.end('');
      });
    });
  }

  // Declare the method that actually does the authentication
  that.authenticate= function(request, response, callback) {console.log('5authenticate');
    //todo: if multiple connect middlewares were doing this, it would be more efficient to do it in the stack??
    var parsedUrl= url.parse(request.originalUrl, true);
    this.trace('parsedUrl=' + request.originalUrl);

    //todo: makw the call timeout ....
    var self= this;
    if( request.getAuthDetails()['500px_login_attempt_failed'] === true ) {
      // Because we bounce through authentication calls across multiple requests
      // we use this to keep track of the fact we *Really* have failed to authenticate
      // so that we don't keep re-trying to authenticate forever.
      delete request.getAuthDetails()['500px_login_attempt_failed'];
      self.fail( callback );
    }
    else {
      if( parsedUrl.query && parsedUrl.query.denied ) {
        self.trace( 'User denied OAuth Access' );
        request.getAuthDetails()['500px_login_attempt_failed'] = true;
        this.fail(callback);
      }
      else if( parsedUrl.query && parsedUrl.query.oauth_token && request.session.auth["500px_oauth_token_secret"] ) {
          self.trace( 'Phase 2/2 : Requesting an OAuth access token.' );
          my._oAuth.getOAuthAccessToken(parsedUrl.query.oauth_token, request.session.auth["500px_oauth_token_secret"],
                                function( error, oauth_token, oauth_token_secret, additionalParameters ) {
                                  if( error ) {
                                    self.trace( 'Error retrieving the OAuth Access Token: ' + error );
                                    request.getAuthDetails()['500px_login_attempt_failed'] = true;
                                    this.fail(callback);
                                  }
                                  else {
                                    self.trace( 'Successfully retrieved the OAuth Access Token' );
                                    request.session.auth["500px_oauth_token_secret"]= oauth_token_secret;
                                    request.session.auth["500px_oauth_token"]= oauth_token;
                                    var user= { user_id: additionalParameters.user_id,
                                               username: additionalParameters.screen_name }
                                    self.executionResult.user= user; 
                                    self.success(user, callback)
                                  }
                                });
      }
      else {

        my._oAuth.getOAuthRequestToken(function(error, oauth_token, oauth_token_secret, oauth_authorize_url, additionalParameters ) {
          if(error) {
            self.trace( 'Error retrieving the OAuth Request Token: ' + JSON.stringify(error) );
            callback(null); // Ignore the error upstream, treat as validation failure.
          } else {
            self.trace( 'Successfully retrieved the OAuth Request Token' );
            request.session['500px_redirect_url']= request.originalUrl;
            request.session.auth["500px_oauth_token_secret"]= oauth_token_secret;
            request.session.auth["500px_oauth_token"]= oauth_token;
            self.redirect(response, "https://api.500px.com/oauth/authenticate?oauth_token=" + oauth_token, callback);
          }
        });
      }
    }
  }
  return that;
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T19:11:45.153

必须使用 OAuth 1.0（而不是 1.0A）

```
 my._oAuth= new OAuth("https://api.500px.com/v1/oauth/request_token",
                     "https://api.500px.com/v1/oauth/access_token", 
                     options.consumerKey,  options.consumerSecret, 

                     "1.0", 

                      options.callback || null, "HMAC-SHA1"); 
```

# c# - 如何仅从 List 中的偶数位置获取条目

> ID：10250552
> 
> 赞同：5
> 
> 时间：2012-04-20T17:09:44.243
> 
> 标签：c#, .net, linq

如何从列表中的偶数位置选择仅使用 Linq 的条目？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-20T17:13:45.583

您可以使用 Enumerable.Where 的[重载](http://msdn.microsoft.com/en-us/library/bb549418.aspx)，其中谓词包含项目的索引。

```
var myList = new List<int>{ 1, 2, 3, 4, 5, 6 };
var evenIndexes = myList.Where( (num, index) => index % 2 == 0); 
```

# database - Oracle SQL 开发人员中的 DB2 数据库

> ID：10250557
> 
> 赞同：20
> 
> 时间：2012-04-20T17:09:55.617
> 
> 标签：database, oracle, db2, mainframe, oracle-sqldeveloper

我听说可以使用 Oracle SQL developer 之类的客户端连接到大型机 DB2 数据库。我在网上查看过，似乎无法在 SQL 开发人员中找到执行此操作所需的连接器文件。谁能指导我到一个链接来完成这项工作？或者告诉我我是否只是在寻找错误的东西。我已经让连接器在 Oracle 中与 MySQL 数据库一起使用，所以我认为它与 DB2 数据库类似。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2016-02-18T22:14:50.570

要在 SQL Developer 中启用 DB2，您需要拉出 db2jcc.jar

转到“Oracle SQL Developer”-“工具”-“首选项”-> 第三方 JDBC 驱动程序

[![在此处输入图像描述](../Images/4a4bdfa72bc88954aad3872705b35760.png)](https://i.stack.imgur.com/8MGdv.png)

我的 ORACLE SQL Developer 版本是 4.1.1.19（它主要适用于许多版本）

将该 jar 添加到第三方 JDBC 驱动程序后。点击“新建连接”。

您应该能够找到 DB2 Option。

[![在此处输入图像描述](../Images/7a0db58c5ef091969afc448a617e8ea0.png)](https://i.stack.imgur.com/gKPWh.png)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-04-20T21:44:17.383

连接到 Db2 的最简单方法是通过其 JDBC Type 4 JCC 驱动程序。此驱动程序使用两个 JAR：

1.  db2jcc4.jar，它是 JDBC 4 驱动程序（db2jcc.jar JDBC 3 驱动程序已被弃用。）
2.  db2jcc_license_cisuz.jar，它允许驱动程序连接到所有 Db2 服务器平台，包括 z/OS

您的大型机 DBA 应该能够为您提供这两个 JAR，并帮助您使用正确的 JDBC 驱动程序选项构建连接字符串。

可以在此处找到有关 Db2 的 JDBC 驱动程序的更多信息：[https ://www.ibm.com/support/pages/db2-jdbc-driver-versions-and-downloads](https://www.ibm.com/support/pages/db2-jdbc-driver-versions-and-downloads)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-11-08T07:07:48.660

**SQL Developer 支持以下 JDBC 驱动程序。**

***IBM DB2：***您需要二进制驱动程序 jar 文件 db2jcc.jar 和 db2jcc_license_cu.jar。搜索 DB2 通用 JDBC 驱动程序。[https://www.ibm.com/support/pages/location-db2jcclicensecisuzjar-file](https://www.ibm.com/support/pages/location-db2jcclicensecisuzjar-file)

**Microsoft Access：**不需要额外的驱动程序。Access 使用 JDBC/ODBC 桥接器

**Microsoft SQL Server 和 Sybase：** jTDS 驱动程序 1.2 版。在这里下载。二进制驱动程序位于 jtds-1.2-dist.zip 中。此 jar 文件称为 jtds-1.2.jar。

**MySQL：** MySQL JDBC 驱动程序，版本 5.04。在这里下载。二进制驱动程序位于 mysql-connector-java-5.0.4.tar.gz（或 .zip）中。jar 文件名为 mysql-connector-java-5.0.4-bin.jar。

**Teradata：**使用 Teradata JDBC Driver 12.0 或更高版本。Teradata JDBC Driver 12.0 和 13.0 都使用 jar 文件 terajdbc4.jar 和 tdgssconfig.jar。 [https://www.teradata.com/downloadcenter/](https://www.teradata.com/downloadcenter/)

# oracle - 编写 Oracle 存储过程

> ID：10250558
> 
> 赞同：-1
> 
> 时间：2012-04-20T17:10:09.560
> 
> 标签：oracle, oracle10g

我没有用oracle写过很多存储过程。我通读了一些教程（例如：http://plsql-tutorial.com/plsql-procedures.htm [）](http://plsql-tutorial.com/plsql-procedures.htm)并尝试根据我所看到的对我的 sp 进行建模，但我仍然遇到错误。这是一个小示例程序和错误：

```
create or replace
PROCEDURE TEST_SP()
  BEGIN

insert into tablespace.tablename
select * from testtable;

END TEST_SP;

PLS-00103: Encountered the symbol ")" when expecting one of the following:

   <an identifier> <a double-quoted delimited-identifier> 
```

我的印象是我错过了声明部分，但我不明白我应该声明什么：-/

任何帮助，将不胜感激。

* * *

从第一反应遵循贾斯汀的建议，现在得到不同的错误：

```
create or replace
PROCEDURE TEST_SP
 AS
  BEGIN

insert into tablespace.tablename (col1, col2)
select (col1, col2) from testtable;

END TEST_SP;

PLS-00103: Encountered the symbol "AS" when expecting one of the following: 
. , @ in <an identifier> <a double-quoted delimited-identifier> partition subpartition 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T17:15:04.293

听起来你在追求这样的东西。如果您不声明任何参数，您不希望在过程名称后加上括号。即使您不打算声明任何局部变量，您也需要在您之前使用关键字`AS`（或`IS`） 。`BEGIN`

```
create or replace PROCEDURE TEST_SP
AS
BEGIN
  insert into tablespace.tablename
    select * from testtable;
END TEST_SP; 
```

然而，一般来说，编写这样的代码来省略列列表是个坏主意。假设这两个表具有完全相同的列以完全相同的顺序定义，因此如果有人决定向其中一个表添加另一列，您的代码将中断。它还可能导致您无意中从错误的列中复制数据。编写类似的东西通常更健壮

```
create or replace PROCEDURE TEST_SP
AS
BEGIN
  insert into tablespace.tablename( <<list of columns>> )
    select <<list of columns>>
      from testtable;
END TEST_SP; 
```

举个例子

```
SQL> create table foo( col1 number );

Table created.

SQL> create table foo_cpy( col1 number );

Table created.

SQL> ed
Wrote file afiedt.buf

  1  create or replace procedure test_sp
  2  as
  3  begin
  4    insert into foo( col1 )
  5      select col1
  6        from foo_cpy;
  7* end test_sp;
SQL> /

Procedure created. 
```

# javascript - 影响某些元素的 jQuery 函数是否必须存在于代码中的元素之后？

> ID：10250562
> 
> 赞同：-2
> 
> 时间：2012-04-20T17:10:19.080
> 
> 标签：javascript, jquery, html

我遇到了一个问题，我的 jQuery 函数只有在它们存在于页面的最底部，在结束 body 和 html 标记之前才能正常工作。这个影响某些元素的功能的标准是否必须在这些元素之后？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T17:12:15.470

是的，否则元素还没有在 DOM 中。

常见的解决方案是通过 DOM 就绪事件执行您的代码：

```
$(document).ready(function() {
    // your code
}); 
```

它还有一个快捷语法（虽然不太清楚，但我不会使用它）：

```
$(function() {
    // your code
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-20T17:12:19.780

您需要等待文档加载后才能开始操作 DOM。

```
$(document).ready(function() { /* ... */ }); 
```

或者更简洁地说：

```
$(function() { /* ... */ }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T17:22:57.133

实际上，如果你的函数依赖于被加载元素的样式和属性，你将不得不使用

```
window.onload = function () { /* actions to do after page elements loaded */ }; 
```

例如，HTML5 画布就是这种情况——画布和其中的 svg 元素（连同它们的属性）必须先加载，然后 javascript 才能对其进行操作。

在 jQuery 中，

```
$(document).load(function() { /* actions to do after page elements loaded */ }); 
```

也应该这样做。

当然，如果您的 javascript 只需要准备好 DOM（并且不依赖于要加载的页面元素的属性），那么您可以只使用

```
$(function() { /* actions to do after DOM is ready */ }); 
```

# algorithm - 合适的树数据结构

> ID：10250564
> 
> 赞同：1
> 
> 时间：2012-04-20T17:10:39.180
> 
> 标签：algorithm, data-structures, tree

我一直在阅读有关树数据结构来建模问题的信息。我需要构建与文件系统中的文件夹/文件表示非常相似的数据的内存表示（我不是暗示存储在磁盘中的实际文件，而是像资源管理器一样的结构）。树可能最大 10 深 中间节点可能只有中等数量的子节点（比如 10 ），但可能有数千个叶节点。[就像文件夹中的数千个文件，文件是叶节点]

一些想法

*   二叉树不能工作，因为一个节点最多只能有两个孩子。（假设我们可以有 3 个子文件夹）
*   一个非常通用的树实现可能效率低下，因为我的数据可以排序。就像左边的兄弟姐妹比右边的兄弟姐妹更小/更小。我希望这可以进行有效的遍历。
*   B树听起来很接近，但它是否坚持平衡要求。就我而言，深度不会超过 10，但不一定所有分支都那么深。（比如 c:/windows ，C:/MyDoc../A/B/C）

请帮助您的经验。我是否应该自定义创建树或任何合适的数据结构（并不意味着特定于编程语言）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T19:01:06.513

您有两种不同类型的节点：文件和文件夹。

文件夹节点包含一组子节点（或映射），其中子节点本身可能是文件或文件夹。

或者，您可能希望文件夹节点包含一组文件和一组文件夹。

对于集合，只需使用您最喜欢的有序集合表示（可能是您使用的任何语言附带的表示）。根据您的具体情况，您可能更喜欢使用地图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T20:38:38.837

在典型的文件系统中，“目录树”和搜索树不是一回事，通常是分开维护的。“目录树”告诉你一个文件夹有哪些文件/子文件夹，或者一个特定文件的路径，它只是反映了用户如何组织文件并且只对用户有用。另一方面，搜索树维护了所有文件的全局索引，以便于快速搜索。

例如，您可以实现类似 Linux 的文件系统，其中文件夹是记录其包含的其他文件/文件夹的指针的文件。同时你维护一个 B+ 树，它把每个文件指针作为一个叶子。B+树的平衡状况与用户如何组织文件夹无关。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T20:18:17.827

使用两个独立的数据结构：

1.  用于搜索的二叉搜索树
2.  以及用于表示的通用二叉树

并将这两者联系在一起。

笔记：

*   一般来说，树将文件夹按顺序放在首位，然后将所有文件放在 BST 中作为最后一个节点。

或使用：

```
Node:
    Node* Left_Most_Child_Folder;
    Node* Right_Sibling_Folder;
    BST_Node* Files_Root; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T17:32:30.800

一种方法是使用二叉树的二叉树。例如：

```
Node
  Node* Children;
  Node* Left;
  Note* Right; 
```

你的树的根是`Node*`.

这使得节点的遍历和快速插入和删除变得容易。当然，前提是您知道要插入节点的级别的路径，或者要删除的节点的路径。但是由于您表示您想要一个类似于 Explorer 的模型，我假设找到特定级别不会造成问题。

在特定级别搜索节点就像搜索二叉树一样简单。

如果没有关于您要建模的内容的更多信息，那是我能做的最好的事情。

# objective-c - Objective-C 中的计算

> ID：10250566
> 
> 赞同：1
> 
> 时间：2012-04-20T17:10:40.517
> 
> 标签：objective-c, cocoa, math, operators

谁能向我解释为什么当它应该返回 42 时它一直返回 0？它在纸上有效，所以我知道数学是正确的我只是想知道为什么它没有翻译过来？

```
 int a = 60;
    int b = 120;
    int c = 85;
    int progress;

    progress = ((c-a)/(b-a))*100;

    NSLog(@"Progess = %d %%",progress); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-20T17:13:55.807

这是因为您的数学都使用整数。

特别是，您的内部表达式正在计算 25 / 60，在整数数学中为零。

实际上，您对表达式进行*了过度括号化*，并且由此产生的评估顺序导致整数舍入问题。

如果您刚刚编写公式，它会很好用：

```
progress = 100 * (c - a) / (b - a); 
```

因为 100 * (c - a) 将首先计算为 2500，然后除以 60 得到 41。

或者，如果您的变量中的任何一个（或多个）`a`、`b`或`c`是`float`（或强制转换），则该等式也将起作用。

这是因为其中一个操作数是 a 的表达式*也会*导致`float`另一个（整数）操作数也被提升为 a `float`，此时表达式的结果也将是 a `float`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-20T17:21:04.290

`c - a`会给你25

`b - a`会给你60

因为`a`,`b`和`c`都是整数，这意味着它们不能是小数。因此，通过这样做`(c-a)/(b-a)`，您将得到 0，而不是 0.41666666，因为在整数除法中，小数点后的任何内容都将被截断，留下小数点前的数字。

为了让它按照你想要的方式工作，你应该尝试强制转换`(c-a)`并`(b-a)`加倍或浮动：

`progress = ((float)(c-a) / (float)(b-a)) * 100;`

或者

`progress = ((double)(c-a) / (double)(b-a)) * 100;`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T17:13:58.573

`a`，`b`并且`c`是`int`s。当你计算`((c-a)/(b-a))`时，结果也是一个`int`；实际值是小数（0.42），但`int`不能取小数，所以四舍五入为`0`，乘以`100`得到`0`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-20T17:14:14.693

因为`(c - a) / (b - a)`是使用 计算的`integer math`。

要修复，请在除法之前转换为浮点数：

```
progress = (int)((((float)(c - a)) / ((float)(b - a))) * 100); 
```

# google-maps-api-3 - Google Maps API：未捕获的类型错误：无法读取未定义的属性“__e3_”

> ID：10250568
> 
> 赞同：5
> 
> 时间：2012-04-20T17:10:47.457
> 
> 标签：google-maps-api-3, typeerror

我目前正在为我的天气网站使用新系统，但出现以下错误：

```
Uncaught TypeError: Cannot read property '__e3_' of undefined

Xe%7Bmain,places,weather%7D.js:18
Ve%7Bmain,places,weather%7D.js:21
P.addListener%7Bmain,places,weather%7D.js:18
T.(anonymous function).bindTo%7Bmain,places,weather%7D.js:27
initializejavascript.js:109
(anonymous function)javascript.js:4
f.Callbacks.ojquery.min.js:2
f.Callbacks.p.fireWithjquery.min.js:2
e.extend.readyjquery.min.js:2
c.addEventListener.B 
```

这是我的`javascript.js`文件中的内容，我包含在我的`header.php`( `<script src="javascript.js" type="text/javascript"></script>`) 中：

```
$(document).ready(function() {
    initialize();
});

var elevator;
var geocoder;
var map;

function initialize() {

    // KONFIGURATION: Geocoding
    geocoder = new google.maps.Geocoder();

    // KONFIGURATION: Filnamn
    var weatherdata = 'fetch-information/fetch-weatherdata.php';

    // KONFIGURATION: Datum
    var date = new Date();
    var datetime = date.getFullYear() + '-' + 
                  (date.getMonth() < '10' ? '0' + date.getMonth() : date.getMonth()) + '-' +
                  (date.getDay() < '10' ? '0' + date.getDay() : date.getDay()) + ', ' +
                  (date.getHours() < '10' ? '0' + date.getHours() : date.getHours()) + ':' +
                  (date.getMinutes() < '10' ? '0' + date.getMinutes() : date.getMinutes()) + ':' +
                  (date.getSeconds() < '10' ? '0' + date.getSeconds() : date.getSeconds());

    // KONFIGURATION: Hämta adress
    var address = 'Karlstad, Sverige';

    // KONFIGURATION: Inställningar för kartan
    var myOptions = {
        streetViewControl: false,
        overviewMapControl: true,
        zoom: 14,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };

    // MOLNAKTIVITET
    var cloudLayer = new google.maps.weather.CloudLayer();
    cloudLayer.setMap(map);

    /**********************************************
    **    THE CODE BELOW IS CAUSING THE ERROR    **
    **********************************************/

    // HÖJD ÖVER / UNDER HAVSYTAN
    elevator = new google.maps.ElevationService();
    google.maps.event.addListener(map, 'click', getElevation);

    /* ** ** ** ** ** */

    // GOOGLE PLACES API
    var input = document.getElementById('googlemaps-search');
    var autocomplete = new google.maps.places.Autocomplete(input);

    autocomplete.bindTo('bounds', map);
    google.maps.event.addListener(autocomplete, 'place_changed', function() {
        var place = autocomplete.getPlace();
        alert(place.geometry.location);
    });

    /**********************************************
    **    THE CODE ABOVE IS CAUSING THE ERROR    **
    **********************************************/

    /* ** ** ** ** ** */

    // GEOCODING
    geocoder.geocode({'address' : address}, function(results, status) {

        // KONTROLL
        if(status == google.maps.GeocoderStatus.OK) {

            // KONFIGURATION: Ta bort ( och ) före och efter koordinaterna
            var old_latlong = '' + results[0].geometry.location + '';
            var new_latlong = old_latlong.substring(1, old_latlong.length - 1).replace(' ', '');

            // CENTERRING
            map.setCenter(results[0].geometry.location);

            // MARKERING: Adress
            var marker = new google.maps.Marker({
                map: map,
                position: results[0].geometry.location
            });

            // AJAX: Hämta den angivna filen
            $.ajax({
                    url: weatherdata + '?coordinates=' + new_latlong,

                    success: function() {
                                         console.log(datetime + ': Hämtningen av väderprognosen och den övriga informationen lyckades');
                                         $('.content-search').show();
                                         $('#load-weather').load(weatherdata + '?coordinates=' + new_latlong);
                                        },

                    error: function() {
                                       console.error(datetime + ': Hämtningen av väderprognosen och den övriga informationen misslyckades');
                                       $('#load-weather').hide();
                                       $('.content-search').hide();
                                       $('#message-error').show();
                                      }
                   });

        // KONTROLL
        } else {

            // FELMEDDELANDE
            alert('Kunde inte hämta data på grund av följande fel: ' + status);
        }

    });

    /* ** ** ** ** ** */

    // KARTA
    var map = new google.maps.Map(document.getElementById('weather-map'), myOptions);

}

/** ** ** ** ** ** ** ** ** ** ** ** **/

function getElevation(event) {
    var locations = [];
    var clickedLocation = event.latLng;
    locations.push(clickedLocation);

    var positionalRequest = {
        'locations': locations
    }

    elevator.getElevationForLocations(positionalRequest, function(results, status) {
        if(status == google.maps.ElevationStatus.OK) {
            var s = results[0].elevation;

            if(results[0]) {
                if(('' + parseInt(s)).charAt(0) == '-') {
                    $('#elevation').html('Cirka ' + number_format(('' + parseInt(s)).substring(1)) + ' meter under havsytan');
                } else {
                    $('#elevation').html('Cirka ' + number_format(parseInt(s)) + ' meter över havsytan');
                }
            } else {
                alert('Inget resultat hittades');
            }
        } else {
            alert('Det gick inte att hitta höjdskillnaden på grund av följande: ' + status);
        }
    });
} 
```

问题是该系统与我以前的系统完全相同，并且我在它们上都有相同的“代码结构”，但我仍然在新系统上收到此错误消息。我不知道为什么我会得到它，所以我问你知道：我该如何解决我的问题？

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-20T17:37:37.513

当我将地图定义移动到标记的错误代码之前的某个点时，它起作用了。我`var map = new google.map.Map`在地图选项之后添加了 to。

```
 var myOptions = {
     streetViewControl: false,
     overviewMapControl: true,
    zoom: 14,
    mapTypeId: google.maps.MapTypeId.ROADMAP
};

var map = new google.maps.Map(document.getElementById('weather-map'), myOptions);

// MOLNAKTIVITET
var cloudLayer = new google.maps.weather.CloudLayer();
cloudLayer.setMap(map);

/**********************************************
**    THE CODE BELOW IS CAUSING THE ERROR    **
**********************************************/

// HÖJD ÖVER / UNDER HAVSYTAN
elevator = new google.maps.ElevationService();
google.maps.event.addListener(map, 'click', getElevation); 
```

# jndi - 通过 JNDI 连接 Websphere MQ SSL 通道失败

> ID：10250569
> 
> 赞同：2
> 
> 时间：2012-04-20T17:11:02.200
> 
> 标签：jndi, ibm-mq, ssl, channel

我的 JMS 客户端通过 JNDI 连接到 WMQ。使用的初始上下文工厂是`com.ibm.mq.jms.context.WMQInitialContextFactory`.

目前，在 WMQ 端，有一个名为`TestMgr`. 在这个队列管理器下，我创建了两个通道。一种是`PLAIN.CHL`没有指定 SSL Cipher Spec，另一种是`SSL.CHL`配置 SSL Cipher Spec`RC4_MD5_US`和 SSL Authentication with `Optional`。

我使用 IBM Key Management 工具为队列管理器创建了一个密钥库。密钥 db 的路径是`[wmq_home]\qmgrs\TestMgr\ssl\key`.

对于 channel `PLAIN.CHL`，我定义了一个队列连接工厂，例如：

```
DEF QCF(PlainQCF) QMANAGER(TestMgr) CHANNEL(PLAIN.CHL) HOST(192.168.66.23) PORT(1414)   TRANSPORT(client) 
```

在 SSL 通道下`SSL.CHL`，我定义了一个队列连接工厂，如：

```
DEF QCF(SSLQCF) QMANAGER(TestMgr) CHANNEL(SSL.CHL) HOST(192.168.66.23) PORT(1414) TRANSPORT(client) SSLCIPHERSUITE(SSL_RSA_WITH_RC4_128_MD5) 
```

现在我只能使用`PlainQCF`. 但未能查找 SSL 队列连接工厂。我的代码如下所示：

```
 Hashtable environment = new Hashtable();
    environment.put(Context.INITIAL_CONTEXT_FACTORY, "com.ibm.mq.jms.context.WMQInitialContextFactory");
    environment.put(Context.PROVIDER_URL, "192.168.66.23:1414/SSL.CHL");
    Context ctx = new InitialContext( environment );
    QueueConnectionFactory qcf = (QueueConnectionFactory) ctx.lookup("SSLQCF");
    qcf.createConnection();
    .... 
```

查找 SSL 工厂时是否缺少一些上下文属性？连接然后我发现代码在网上挂`new InitialContext( environment )`了很长时间，快5分钟了，我得到了`CC=2;RC=2009;AMQ9208...`错误。

任何建议将不胜感激。JNDI无法连接SSL通道是真的吗？

* * *

@T.Rob，非常感谢您的回复。但是我们仍然想使用`WMQInitialContextFactory`，所以恐怕我仍然需要为此找到解决方案。

我刚刚定义了一次连接工厂。SSL 队列连接工厂的显示信息如下：

```
InitCtx> DISPLAY QCF(SSLQCF)
ASYNCEXCEPTION(ALL)
CCSID(819)
CHANNEL(SSL.CHL)
CLIENTRECONNECTOPTIONS(ASDEF)
CLIENTRECONNECTTIMEOUT(1800)
COMPHDR(NONE )
COMPMSG(NONE )
CONNECTIONNAMELIST(192.168.66.23(1414))
CONNOPT(STANDARD)
FAILIFQUIESCE(YES)
HOSTNAME(192.168.66.23)
LOCALADDRESS()
MAPNAMESTYLE(STANDARD)
MSGBATCHSZ(10)
MSGRETENTION(YES)
POLLINGINT(5000)
PORT(1414)
PROVIDERVERSION(UNSPECIFIED)
QMANAGER(TestMgr)
RESCANINT(5000)
SENDCHECKCOUNT(0)
SHARECONVALLOWED(YES)
SSLCIPHERSUITE(SSL_RSA_WITH_RC4_128_MD5)
SSLFIPSREQUIRED(NO)
SSLRESETCOUNT(0)
SYNCPOINTALLGETS(NO)
TARGCLIENTMATCHING(YES)
TEMPMODEL(SYSTEM.DEFAULT.MODEL.QUEUE)
TEMPQPREFIX()
TRANSPORT(CLIENT)
USECONNPOOLING(YES)
VERSION(7)
WILDCARDFORMAT(TOPIC_ONLY) 
```

JNDI Provider 应该没问题，因为我可以成功查找普通连接工厂。此外，对于我的客户端应用程序，我从为 MQ 服务器创建的密钥库中提取了证书，并将其导入到我的 JRE 的信任库（cacerts）中，别名为`ibmwebspheremqtestmgr`。

你是对的，有 2009 错误有一些日志条目：

```
=================================================================

4/20/2012 20:24:27 - Process(13768.3) User(MUSR_MQADMIN) Program(amqzmur0.exe)
                      Host(xxxx_host of my MQ) Installation(mqenv)
                      VRMF(7.1.0.0) QMgr(TestMgr)                
AMQ6287: WebSphere MQ V7.1.0.0 (p000-L111019).
EXPLANATION:
WebSphere MQ system information: 
Host Info         :- Windows Server 2003, Build 3790: SP2 (MQ Windows 32-bit) 
Installation      :- C:\IBM\WebSphereMQ (mqenv) 
Version           :- 7.1.0.0 (p000-L111019)
ACTION:
None. 

-------------------------------------------------------------------------------
4/20/2012 20:24:27 - Process(7348.116) User(MUSR_MQADMIN) Program(amqrmppa.exe)
                      Host(xxxx_host of my MQ) Installation(mqenv)
                      VRMF(7.1.0.0) QMgr(TestMgr)
AMQ9639: Remote channel 'SSL.CHL' did not specify a CipherSpec.

EXPLANATION:
Remote channel 'SSL.CHL' did not specify a CipherSpec when the local channel
expected one to be specified. 

The remote host is 'xxx_host of my app (192.168.66.25)'. 
The channel did not start.

ACTION:
Change the remote channel 'SSL.CHL' on host 'xxx_host of my app (192.168.66.25)' to
specify a CipherSpec so that both ends of the channel have matching
CipherSpecs.

----- amqcccxa.c : 3817 -------------------------------------------------------
4/20/2012 20:24:27 - Process(7348.116) User(MUSR_MQADMIN) Program(amqrmppa.exe)
                      Host(my app host) Installation(mqenv)
                    VRMF(7.1.0.0) QMgr(TestMgr)                    
AMQ9999: Channel 'SSL.CHL' to host 'xxx_host of my app (192.168.66.25)' ended
abnormally.

==================================================================== 
```

我也对错误日志有些困惑。我的应用程序在与我的 MQ 不同的机器上运行。但是日志显示`Change the remote channel 'SSL.CHL' on host 'xxx_host of my app (192.168.66.25)' to specify a CipherSpec so that both ends of the channel have matching CipherSpecs.`如何更改我的应用程序主机上的通道密码规范？

* * *

### MQEnvironment 的更新...

回复评论。

的值为`MQEnvironment.sslCipherSuite`空，因此当我将它放入 env 哈希表时它会抛出 NullPointerExcetpion。但是我尝试了另一个`environment.put(MQC.SSL_CIPHER_SUITE_PROPERTY, "SSL_RSA_WITH_RC4_128_MD5")`，但它仍然失败并`2009`出现错误。

对于`JMSAdmin`工具，我已将配置更改为使用`WMQInitialContextFactory`. 像（`JMSAdmin.config`）这样的配置：

```
INITIAL_CONTEXT_FACTORY=com.ibm.mq.jms.context.WMQInitialContextFactory
PROVIDER_URL=192.168.66.23:1414/SYSTEM.DEF.SVRCONN 
```

其余配置保留为默认值。

请注意，这里我使用默认频道`SYSTEM.DEF.SVRCONN`，以便我可以登录到管理控制台。如果我将频道更改为 SSL one `SSL.CHL`，我也无法登录到管理控制台。这里发生的错误就像我的客户端应用程序中的错误一样。

`TestMgr`另一个澄清，在我的客户端中，我使用跟随代码可以通过 channel 成功连接 qmgr( ) `SSL.CHL`。

```
 MQConnectionFactory factory = new MQConnectionFactory();
    factory.setTransportType(JMSC.MQJMS_TP_CLIENT_MQ_TCPIP);
    factory.setQueueManager("TestMgr");
    factory.setSSLCipherSuite("SSL_RSA_WITH_RC4_128_MD5");
    factory.setPort(1414);
    factory.setHostName("192.168.66.23");
    factory.setChannel("SSL.CHL");

    MQConnection connection = (MQConnection) factory.createConnection(); 
```

现在问题就像你说的那样，那是初始上下文无法通过 SSL 通道连接到 qmgr。您提供的 option( `use plain channel for initial context and ssl channel for connection factory`) 也有效。但我仍然想知道如何通过 ssl 通道工作获得初始上下文。非常感谢您的耐心。您的更新将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T20:17:43.923

我从来没有真正喜欢`com.ibm.mq.jms.context.WMQInitialContextFactory`过。它将托管对象存储在队列中。因此，为了查找`connectionFactory`告诉 JMS 如何连接到 QMgr 的 ，首先需要*连接到 QMgr*以进行 JNDI 调用。因此，在调试 SSL 连接之前，您需要知道底层 JNDI 提供程序是否正常工作。

如果您想跳过基于 MQ 的 JNDI 提供程序而只使用文件系统，请在[此处查看](http://www.ibm.com/developerworks/websphere/techjournal/0610_woolf/0610_woolf.html)Bobby Woolf 文章的更新版本。如果您想继续`com.ibm.mq.jms.context.WMQInitialContextFactory`阅读，请继续阅读，但请准备好提供更多配置信息。

运行 JMSAdmin 工具时，是否在创建对象后显示它们？例如，这是我的`JMSAdmin.bat`脚本之一：

```
# Connection Factory for Client mode
# Delete the Connection Factory if it exists
DELETE  CF(JMSDEMOCF)

# Define the Connection Factory
DEFINE  CF(JMSDEMOCF) +
        SYNCPOINTALLGETS(YES) +
        SSLCIPHERSUITE(NULL_SHA) +
        TRAN(client) +
        HOST(127.0.0.1) CHAN(SSL.SVRCONN) PORT(1414) +
        QMGR( )

# Display the resulting definition
DISPLAY CF(JMSDEMOCF) 
```

这将删除对象（因为 JMSAdmin 没有使用替换选项定义）然后定义对象，然后显示它。您实际上看到两个对象都定义了吗？您可以连接并交互显示它们吗？你能用显示的内容更新你的问题吗？

如果是这样，那么每个示例程序的 JNDI 提供程序配置是什么样的？2009 表明至少存在与正在建立的 QMgr 的连接，因此确定遭受断开连接的事物是您的应用程序还是 JNDI 提供程序非常重要。要诊断这需要您用于 JNDI 提供程序的配置信息，以及在工作和失败情况下是否相同。如果不是，它们有何不同？

一旦您知道是应用程序还是 JNDI 提供程序导致了问题（或切换到另一个不需要 MQ 连接的 JNDI 提供程序，例如文件系统初始上下文），那么就可以确定接下来的步骤。

上面链接的[文章](http://www.ibm.com/developerworks/websphere/techjournal/0610_woolf/0610_woolf.html)包含使用文件系统 JNDI 提供程序的代码示例和托管对象脚本。您可能会注意到我粘贴在上面的脚本使用相同的 QMgr 名称。那是因为我写了文章的那一部分。当我想使用这些相同的示例切换到 SSL 时，我只需将 更新`connectionFactory`为指向 SSL 通道，它就可以工作了。

以下是我修改过的示例中的其他位：

```
java -Djavax.net.debug=ssl  ^
     -Djavax.net.ssl.trustStore=key2.jks  ^
     -Djavax.net.ssl.keyStore=key2.jks ^
     -Djavax.net.ssl.keyStorePassword=????????  ^
     -Djavax.net.ssl.trustStorePassword=???????? ^
     -cp "%CLASSPATH%"  ^
      com.ibm.examples.JMSDemo -pub -topic JMSDEMOPubTopic %* 
```

*注意：这`^`是 Windows 版本的续行。*

然后如果有问题，我会按照我在[这个 SO answer](https://stackoverflow.com/questions/4400171/c-sharp-ssl-with-websphere-mq-version-7-0-1/4409455#4409455)中描述的调试场景进行操作。请注意，即使`SSLCAUTH(OPTIONAL)`您的频道上有该应用程序，该应用程序也需要信任库。这是因为应用程序必须始终验证 QMgr 的证书，即使应用程序没有提供自己的证书。就我而言，我正在使用`SSLCAUTH(REQUIRED)`，所以我的应用程序需要一个密钥库和一个信任库。您的问题提到 QMgr 有一个密钥库，但没有说明您为应用程序做了什么。

最后，2009 通常会在 QMgr 错误日志中生成一个条目。如果您仍然遇到问题，请使用这些日志条目更新您的问题。

* * *

**更新：**
回应评论，*JMSAdmin 工具*是 WMQ 包的一部分。但是，WMQ 它带有用于文件系统上下文和 LDAP 上下文的 jar。这`WMQInitialContextFactory`是可选的，作为[SupportPac ME01](http://ibm.co/SupptPacME01)提供。与 JMSAdmin 工具（或 JMSAdmin GUI 或 WMQ Explorer）一起使用`WMQInitialContextFactory`时，需要使用主机、端口和通道配置 PROVIDER_URL。例如：

```
PROVIDER_URL: <Hostname>:<port>/<SVRCONN Channel Name>
192.168.66.23:1414/SSL.SVRCONN 
```

因此，在再次查看您的帖子后，我意识到您*确实*提供了`WMQInitialContextFactory`. 我正在寻找一个 JMSADmin.config 文件，但您在环境哈希表中有它。这就是问题所在。您正在尝试将 SSL 通道用于连接工厂`WMQInitialContextFactory` *和*连接工厂。这就是导致查找失败的原因。第`WMQInitialContextFactory`一个与 QMgre 建立 Java 连接，以便在队列中查找被管理的对象，例如 QCF。为了做到这一点，它需要知道为协商握手而设置通道的密码套件。现在，记录密码套件的*唯一*位置在 QCF 定义中。

尝试添加以下行：

```
environment.put(MQEnvironment.sslCipherSuite, "SSL_RSA_WITH_RC4_128_MD5"); 
```

根据[这个信息中心页面](http://publib.boulder.ibm.com/infocenter/wmqv7/v7r1/topic/com.ibm.mq.doc/ja11330_.htm)，这应该告诉上下文工厂类使用什么密码套件。当然，他们还需要知道信任库在哪里（如果通道已`SSLCAUTH(RQUIRED)`设置，可能还有密钥库），因此您仍然需要在环境中获取这些值。您可以使用命令行变量或尝试使用代码将它们加载到环境中。您将同时需要`-Djavax.net.ssl.trustStore=key2.jks`和`-Djavax.net.ssl.trustStorePassword=????????`。

另一种选择是继续为`WMQInitialContextFactory`应用程序使用明文通道和 SSL 通道。如果明文通道具有非特权用户 ID 的 MCAUSER，则可以将其限制为仅连接到 QMgr 并访问包含受管理对象的队列。有了这些限制，任何人都可以使用该通道读取管理对象，但不能读取应用程序队列或管理队列。

# android - Android：将旧应用程序用作库项目

> ID：10250570
> 
> 赞同：0
> 
> 时间：2012-04-20T17:11:19.610
> 
> 标签：android, shared-libraries, shared, android-library

我正在尝试将旧应用程序用作新应用程序的库项目。但是，当它们同时安装在设备上时会出现一些问题，我不确定发布后是否存在。

假设我的旧应用是 A，新应用是 B。

如果我只安装 A，A 工作正常。

然后，当我安装使用 A 作为库项目的 B 时（在将项目 A 勾选为“isLibrary”之后），原来的 A 停止在设备上工作，但 B 工作正常。

但是，如果我先安装 B，然后安装 A，两者都可以正常工作。

似乎当A作为“库项目”包含到另一个应用程序中，并在原来的“A”之后安装时，原来的“A”不知何故失效了！！！（但反之则不存在问题）

发布后这个问题会消失，还是我必须为 A 和 B 创建一个库项目 C，这会阻止这种情况？还是在所描述的情况下根本不存在这个问题（这意味着我完全做错了其他事情）？

我没有创建库项目 C 的原因是因为涉及到所有重构，而 Eclipse 在我的案例中没有很好地重新命名所有内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T02:53:35.003

查看官方开发指南[管理项目 - 图书馆项目](http://developer.android.com/guide/developing/projects/index.html#LibraryProjects)：

> 但是，库项目与标准 Android 应用程序项目的不同之处在于，您不能将其直接编译为自己的 .apk 并在 Android 设备上运行。同样，您不能将库项目导出到自包含的 JAR 文件，就像对真正的库所做的那样。相反，您必须通过在依赖应用程序中引用库并构建该应用程序来间接编译库。

* * *

回到你的问题：

> 如果我只安装 A，A 工作正常。

因为 A 是一个应用程序项目（isLibrary 设置未勾选），所以 A.apk 被编译、安装和工作。

> 然后，当我安装使用 A 作为库项目的 B 时（在将项目 A 勾选为“isLibrary”之后），原来的 A 停止在设备上工作，但 B 工作正常。

A现在改为Library Project（isLibrary设置勾选），此时不再有A.apk，只有B.apk（与A编译并在构建B.apk时合并）被编译、安装和工作。

> 但是，如果我先安装 B，然后安装 A，两者都可以正常工作。

如果 A 是库项目，像 Eclipse 这样的 IDE 不允许您直接在 Emulator 或真机上编译、安装和运行它。我想你把 A 改回应用程序项目（isLibrary 设置未勾选），所以 A.apk 再次被编译、安装和工作。

> 似乎当 A 作为“库项目”包含到另一个应用程序中，并在原来的“A”之后安装时，原来的“A”不知何故失效了！！！（但反之则不存在问题）

基本正确，查看官方开发指南了解详细信息。

> 发布后这个问题会消失，还是我必须为 A 和 B 创建一个库项目 C，这会阻止这种情况？还是在所描述的情况下根本不存在这个问题（这意味着我完全做错了其他事情）？

否和是，如果您想将项目 A 和 B 作为应用程序项目，则需要库项目 C（以便您可以在仿真器或真实设备上编译、安装和运行它们）。

# c - 对用 C 编写的 Linux Shell 使用 Makefile 时出错

> ID：10250578
> 
> 赞同：-1
> 
> 时间：2012-04-20T17:11:50.870
> 
> 标签：c, linux, unix, makefile

我为我用 C 编写的一个类创建了一个 Linux shell。该 shell 可以完美地运行诸如 ls、pwd、ps、top、cd 等命令。

但是，使用 MakeFile（因为这是提交过程的一部分），当您在终端中使用命令“make test”时，我`tcsetpgrp: Inappropriate ioctl for device"`在程序的所有正确输出中都会出现错误。在 Makefile 中`test: test.txt | .project4.c`，test.txt 是命令，ls、pwd、ps、top、cd 用换行符而不是逗号分隔。这是什么错误，我该如何摆脱它？

这是我的生成文件：

```
PAWPRINT=myname

project4:

clean:
    rm -f *.o

nuke:
    rm -f *.o project4 *.gz

test: project4
    cat test.txt | ./project4   

submit.sh:
    wget -O submit.sh http://somewebsite.com/submit.sh
    chmod +x submit.sh

project4.tar.gz: project4.c test.txt Makefile
    mkdir -p dist
    cp $^ dist
    tar -cvzf $@ dist

 submit: submit.sh project4.tar.gz
    PAWPRINT=$(PAWPRINT) sh submit.sh project4.tar.gz 
```

这是我的 test.txt 文件：

```
sleep 1000 &
jobs
pwd
ls
echo hello > a.txt
echo world > b.txt
cat a.txt b.txt > c.txt
cat c.txt 
```

我的程序可以在 makefile 之外单独运行这些命令。我设计了程序来处理这些命令，因为这就是分配的目的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T22:15:08.983

所以你说，有道理，tcsetpgrp 来自你的程序输出，对吗？好吧，这与您的 MakeFile 有关，但由于在提交过程中运行程序。您的程序正试图成为一个进程组，因此正试图告诉它的控制终端它是前台进程。但是没有终端，因为你在提交过程中，所以 tcsetpgrp() 抱怨（man tcsetpgrp(3) 获取更多信息）。通常这是无害的，虽然很烦人。

# c# - 为什么这个文本块只显示“TextBlock”作为它的文本？

> ID：10250580
> 
> 赞同：0
> 
> 时间：2012-04-20T17:12:11.127
> 
> 标签：c#, wpf

真的很新，正在学习 C#，并跟随 PluralSight 的一些培训视频。很棒的视频，当然，除了你不能问问题，我不明白为什么我看到的内容与他的屏幕显示的内容不同，即使我输入了他所拥有的内容。

文本框被命名为“输出”。最初，这些操作直接在 MainWindow 构造函数中（他解释说这不是好的做法，所以我们移动了它。最初，这可以正常工作：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;

namespace WpfApplication1
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();

            Employee e1 = new Employee();
            e1.Name = "Mike";

            Employee e2 = new Employee();
            e2.Name = "Miller";

            Output.Text = e1.Name + " " + e2.Name;

        }
    }
} 
```

这将在 TextBlock 中显示“Mike Miller”。

但是，当我们将其移至此处时，它对文本的所有内容都是“TextBlock”

```
namespace WpfApplication1
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();

        }

        void MainWindow_Loaded(object sender, RoutedEventArgs e)
        {

            Employee e1 = new Employee();
            e1.Name = "Mike";

            Employee e2 = new Employee();
            e2.Name = "Miller";

            Output.Text = e1.Name.Length + " " + e2.Name.Length;

        }

    }
} 
```

我在这里错过了一些简单的东西吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T17:16:03.427

如果您将 .Length 从两个字符串中取出，它应该可以工作。您正在使用“+”将整数与字符串连接起来，但效果并不好。

```
Output.Text = e1.Name + " " + e2.Name; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T17:24:33.937

正如 Nico Schertler 所说，验证您是否订阅了 Window 的 Loaded 事件：

```
<Window ... Loaded="MainWindow_Loaded">
    ...
</Window> 
```

在第一种情况下，您的代码会运行，因为在创建 Window 时会调用 Window 的构造函数。在第二种情况下，默认情况下不调用事件处理程序。您应该订阅此活动。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T17:43:38.257

您的问题的答案非常肯定：首先，如果您希望输出为“Mike Miler”，请将您的代码更改为 Bravan 发布的代码。其次，您需要将 Loaded 事件添加到 XAML 中的 MainWindow 声明中。除此之外没有什么问题......!!!

快乐编码...！:)

# c - hello world prog in C with Xcode 构建失败

> ID：10250582
> 
> 赞同：0
> 
> 时间：2012-04-20T17:12:15.640
> 
> 标签：c, xcode4.3

我正在尝试学习 C，我刚刚在我的 Mac 上安装了 Xcode。我想运行第一个已经写好的程序

```
#include <stdio.h> 

int main(int argc, const char * argv[])
{

    // insert code here...
    printf("Hello, World!\n");
    return 0;
} 
```

构建失败。我用 C 创建了一个程序。库已经下载。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T17:16:27.703

你想学习 C 还是 Objective-C？据我所知，XCode 只适用于 Objective C。

另外，您能否发布您的编译器错误，这将有很大帮助。

# magento - Magento：按类别过滤报告/product_collection 似乎不起作用

> ID：10250589
> 
> 赞同：0
> 
> 时间：2012-04-20T17:12:41.073
> 
> 标签：magento, report

我认为对于稍微熟悉 Magento 的人来说，这应该是一个简单的问题，但我对它很陌生，还没有找到解决方案。

我正在尝试过滤一个报告/product_collection，我需要使用它来获取按类别按订单数量排序的产品，示例代码：

```
$store = Mage::app()->getStore();
$category = 42; // just an example
$products = Mage::getResourceModel('reports/product_collection')
                ->addAttributeToSelect('*')
                ->addAttributeToFilter("status", Mage_Catalog_Model_Product_Status::STATUS_ENABLED)     
                ->setPageSize(9)
                ->setCurPage(1) 
                ->addOrderedQty()
                ->setOrder("ordered_qty", "desc")
                ->setStore($store)
                ->addStoreFilter($store)
                ->addCategoryFilter(Mage::getModel('catalog/category')->load($category)); 
```

在 catalog/product_collection 上使用 addCategoryFilter() 方法可以正常工作，但在报告/product_collection 上它似乎没有做任何事情，它仍然查询所有类别的产品。顺便说一句， addAttributeToFilter() 方法似乎也不起作用。

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T18:12:47.673

虽然只是漫无边际，但它不应该更像这样吗？我认为您的过滤器分级不正确。恕我直言

```
$store = Mage::app()->getStore();

$category = 42; // just an example

$products = Mage::getResourceModel('reports/product_collection')
            ->addAttributeToSelect('*')
            ->addAttributeToFilter("status", Mage_Catalog_Model_Product_Status::STATUS_ENABLED)     
            ->setPageSize(9)
            ->setCurPage(1) 
            ->addOrderedQty()
            ->setOrder("ordered_qty", "desc")
            ->setStore($store)
            ->addStoreFilter($store)
            ->addAttributeToFilter('category_id', array('in' => $category)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-17T05:59:27.617

您要查询的类别是否设置为锚？我认为这会导致它也包括所有 subcat 的产品。

# java - 如何延迟 textview 输出？

> ID：10250590
> 
> 赞同：0
> 
> 时间：2012-04-20T17:12:41.783
> 
> 标签：java, android

我正在使用下面的代码连接到 wifi 网络。有没有办法可以延迟 textview 文本的输出，使其在连接到 wifi 之前不显示？消息在实际连接之前出现。

```
import java.util.List;
import android.app.Activity;
import android.os.Bundle;
import android.content.Context;
import android.net.ConnectivityManager;
import android.net.NetworkInfo;
import android.net.wifi.WifiConfiguration;
import android.net.wifi.WifiManager;
import android.util.Log;
import android.view.View;
import android.view.View.OnClickListener;

import android.widget.Button;
import android.widget.TextView;

public class TestActivity extends Activity {
/** Called when the activity is first created. 
 * @return */

@Override
public void onCreate(Bundle savedInstanceState) {    
    super.onCreate(savedInstanceState);          

    setContentView(R.layout.main);
    Button OffWifi = (Button)findViewById(R.id.offwifi);
    OffWifi.setOnClickListener(new OnClickListener() { 
      public void onClick(View v) {   

          WifiManager wifiManager = (WifiManager)getBaseContext().getSystemService(Context.WIFI_SERVICE);
            wifiManager.setWifiEnabled(false);          
          }        
      });

    TextView tv= (TextView) findViewById(R.id.tv); 

    WifiManager wifi = (WifiManager) getSystemService(Context.WIFI_SERVICE); 
    WifiConfiguration wc = new WifiConfiguration();  
    wc.SSID = "\"Test\""; //IMP! This should be in Quotes!! 

    wc.hiddenSSID = true; 
    wc.status = WifiConfiguration.Status.ENABLED;      
    wc.priority = 10; 
    wc.allowedKeyManagement.set(WifiConfiguration.KeyMgmt.WPA_PSK); 
    wc.allowedProtocols.set(WifiConfiguration.Protocol.RSN);  
    wc.allowedProtocols.set(WifiConfiguration.Protocol.WPA); 
    wc.allowedAuthAlgorithms.set(WifiConfiguration.AuthAlgorithm.OPEN); 
    wc.allowedAuthAlgorithms.set(WifiConfiguration.AuthAlgorithm.SHARED); 
    wc.allowedPairwiseCiphers.set(WifiConfiguration.PairwiseCipher.CCMP); 
    wc.allowedPairwiseCiphers.set(WifiConfiguration.PairwiseCipher.TKIP); 
    wc.preSharedKey = "\"Password\""; 
    WifiManager  wifiManag = (WifiManager) this.getSystemService(WIFI_SERVICE); 
    boolean res1 = wifiManag.setWifiEnabled(true); 
    int res = wifi.addNetwork(checkPreviousConfiguration(wc)); 
    Log.d("WifiPreference", "add Network returned " + res ); 
    boolean es = wifi.saveConfiguration(); 
    Log.d("WifiPreference", "saveConfiguration returned " + es ); 
    boolean b = wifi.enableNetwork(res, true);    
    Log.d("WifiPreference", "enableNetwork returned " + b );   

         ConnectivityManager connec = (ConnectivityManager)getSystemService(Context.CONNECTIVITY_SERVICE); 

         if (connec != null && (connec.getNetworkInfo(1).getState() == NetworkInfo.State.CONNECTED) ||(connec.getNetworkInfo(0).getState() == NetworkInfo.State.CONNECTED)){  

             tv.setText("You are now connected!  " +  "Version 1.1"); 
            }else if (connec.getNetworkInfo(0).getState() == NetworkInfo.State.DISCONNECTED ||  connec.getNetworkInfo(1).getState() == NetworkInfo.State.DISCONNECTED ) {              

                tv.setText("The was an error connecting, please try again."); 
            }  

    }     

 public WifiConfiguration checkPreviousConfiguration(WifiConfiguration wc) {
WifiManager wifi = (WifiManager) getSystemService(Context.WIFI_SERVICE); 
 List<WifiConfiguration> configs = wifi.getConfiguredNetworks();     
    for(WifiConfiguration config : configs) {         
        if(config.SSID.equals(wc.SSID)) return config;     
        }     
    return wc; 
    } 

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:28:37.377

使用`AsyncTask`并放入连接中`doInBackground`，`setText`放入`onPostExecute`

```
public class Connect extends AsyncTask<String, Void, Boolean> {

private Activity activity;
private Context context;

public LoadContacts(Activity activity){
    this.activity=activity;
    context = activity;
}

@Override
protected void onPreExecute() {
    // TODO Auto-generated method stub
    super.onPreExecute();

}

@Override
protected void onPostExecute(Boolean result) {
    TextView tv= (TextView) activity.findViewById(R.id.tv); 
    if (connec != null && (connec.getNetworkInfo(1).getState() == NetworkInfo.State.CONNECTED) ||(connec.getNetworkInfo(0).getState() == NetworkInfo.State.CONNECTED)){  

         tv.setText("You are now connected!  " +  "Version 1.1"); 
        }else if (connec.getNetworkInfo(0).getState() == NetworkInfo.State.DISCONNECTED ||  connec.getNetworkInfo(1).getState() == NetworkInfo.State.DISCONNECTED ) {              

            tv.setText("The was an error connecting, please try again."); 
        }
    super.onPostExecute();
}

@Override
protected Boolean doInBackground(String... params) {
    WifiManager wifi = (WifiManager) activity.getSystemService(Context.WIFI_SERVICE); 
WifiConfiguration wc = new WifiConfiguration();  
wc.SSID = "\"Test\""; //IMP! This should be in Quotes!! 

wc.hiddenSSID = true; 
wc.status = WifiConfiguration.Status.ENABLED;      
wc.priority = 10; 
wc.allowedKeyManagement.set(WifiConfiguration.KeyMgmt.WPA_PSK); 
wc.allowedProtocols.set(WifiConfiguration.Protocol.RSN);  
wc.allowedProtocols.set(WifiConfiguration.Protocol.WPA); 
wc.allowedAuthAlgorithms.set(WifiConfiguration.AuthAlgorithm.OPEN); 
wc.allowedAuthAlgorithms.set(WifiConfiguration.AuthAlgorithm.SHARED); 
wc.allowedPairwiseCiphers.set(WifiConfiguration.PairwiseCipher.CCMP); 
wc.allowedPairwiseCiphers.set(WifiConfiguration.PairwiseCipher.TKIP); 
wc.preSharedKey = "\"Password\""; 
WifiManager  wifiManag = (WifiManager) context.getSystemService(WIFI_SERVICE); 
boolean res1 = wifiManag.setWifiEnabled(true); 
int res = wifi.addNetwork(checkPreviousConfiguration(wc)); 
Log.d("WifiPreference", "add Network returned " + res ); 
boolean es = wifi.saveConfiguration(); 
Log.d("WifiPreference", "saveConfiguration returned " + es ); 
boolean b = wifi.enableNetwork(res, true);    
Log.d("WifiPreference", "enableNetwork returned " + b );   

     ConnectivityManager connec = (ConnectivityManager) activity.getSystemService(Context.CONNECTIVITY_SERVICE); 

    return true;
}

} 
```

TestActivity 应该如下所示：

```
public class TestActivity extends Activity {
/** Called when the activity is first created. 
 * @return */

@Override
public void onCreate(Bundle savedInstanceState) {    
super.onCreate(savedInstanceState);          

setContentView(R.layout.main);

new Connect(this).execute();
} 
```

代码未经测试，可能有一些错误，但我希望你明白这一点......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T17:21:54.663

在我看来，您需要一个[BoadcastReceiver 来](http://developer.android.com/reference/android/content/BroadcastReceiver.html)监听[NETWORK_STATE_CHANGED](http://developer.android.com/reference/android/net/wifi/WifiManager.html#NETWORK_STATE_CHANGED_ACTION)意图广播。

# c++ - 解决“剧院行”脑筋急转弯的代码

> ID：10250591
> 
> 赞同：1
> 
> 时间：2012-04-20T17:12:42.760
> 
> 标签：c++, simulation, probability, approximation

我在读一本书，叫《概率中的 50 个具有挑战性的问题》，里面有很多与概率相关的脑筋急转弯。我无法解决其中的一个问题，也无法理解解决方案。所以，我正在编写代码以获得更好的感觉。这是原始问题。

> *The Theatre Row：八位优秀的单身汉和七位漂亮的模特随机购买了同一排 15 座剧院的单人座位。平均而言，有多少对相邻的座位是为结婚的夫妇买票的？*

这是我的代码，从 100 个随机抽样中获取相邻对的平均数量：

```
#include <iostream>
#include <vector>
#include <cstdlib>
#include <algorithm>
#include <numeric>

using namespace std;

//  computes the probability for the "theater row" problem 
//  in the book fifty challenging probabilty problems.

vector<int> reduce(vector<int>& seats);    //  This function reduces a sequence to a form 
                                           //  in which there is no adjacent 0's or 1's.
                                           //  *example: reduce(111001)=101*

int main()
{
    srand(time(0));
    int total=15;
    int Num=100;
    int count0=0;   //  number of women
    int count1=0;   //  number of men
    vector<int> seats; //   vector representing a seat assignment, 
                       //   seats.size()=total
    vector<int> vpair; //   vector that has number of adjacent pairs 
                       //   as its element, size.vpair()=Num

    for (int i=0; i<Num; ++i) {
        count0=count1=0;        
        while ((count1-count0)!=1) {
                    count0=count1=0;
            seats.clear();
            for (int j=0; j<total; ++j) {
                int r=rand()%2;
                if (r==0)
                    ++count0;
                else
                    ++count1;
                seats.push_back(r);
            }
        }

        for (int k=0;k<seats.size();++k)
            cout<<seats[k];

        reduce(seats);

        for (int k=0;k<seats.size();++k)
            cout<<" "<<seats[k];

        vpair.push_back(seats.size()-1);   // seats.size()-1 is the number 
                                               // of adj pairs.
        cout<<endl;
    }

    double avg=static_cast<double>(accumulate(vpair.begin(),vpair.end(),0))/vpair.size();

    cout<<"average pairs: "<<avg<<endl;

    return 0;
}

vector<int> reduce(vector<int>& seats)  
{
    vector<int>::iterator iter = seats.begin();
    while (iter!=seats.end()) {
        if (iter+1==seats.end())
            ++iter;
        else if (*iter==*(iter+1))
            iter=seats.erase(iter);
        else
            ++iter;
    }
    return seats;
} 
```

该代码生成随机系列的 0（代表女性）和 1（男性）。然后它“减少”随机序列，以便没有重复的 0 或 1。例如，如果代码生成一个随机序列 011100110010011（有 7 个相邻对），则将序列缩减为 01010101。在缩减格式中，要计算出相邻对的数量，只需获取“大小- 1"。

这是我的问题。

1.  这个问题的答案（根据本书）是 7.47，而我从代码中得到的平均约为 7 左右。有人看到差异的来源吗？

2.  我的代码有时似乎效率很低。是因为我生成随机序列的方式吗？（如您所见，为了生成 8 名男性和 7 名女性的随机序列，我一直要求一个大小为 15 的随机序列，直到它恰好有 8 名男性（或“1”）和 7 名女性（或“0”） .当有这样的约束时，有没有更好的方法来产生随机序列？

在编程方面我不是很熟练。我会很感激任何评论。谢谢你的帮助！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-23T16:24:34.900

这个问题很搞笑。

有 1307674368000 种可能的组合。

有 203212800 种组合，其中一对情侣聚在一起。

但是有 3048192000 个组合，其中 2 对情侣聚在一起。

认为这个问题的关键是先做一个小规模的问题，然后使用这些信息来创建你的答案。这只是一个期望值问题。

编辑：而不是运行模拟，您可以使用预期值获得确切的答案，必须更加努力地思考，但您也将是准确的。我会花一点时间看看我是否能想出确切的答案并发布它。

重要编辑（阅读）：

如果您获得超过 8 个 0 或 8 个 1，您的代码是否考虑在内。感觉你最多只能有 8 个男人和 7 个女人，那么它应该会自动感觉到剩下的符号。

# jquery - jQuery 两个“分页”导航栏

> ID：10250592
> 
> 赞同：0
> 
> 时间：2012-04-20T17:12:46.690
> 
> 标签：jquery, html, css, nav, navbar

这是一个很长的镜头，但我会尽力解释。

我目前有一个有导航栏的网站。

导航栏如下所示： http: [//grab.by/dcDK](http://grab.by/dcDK)。

我的问题是，当我创建太多导航栏链接时，它只会溢出： http: [//grab.by/dcDO](http://grab.by/dcDO)

有没有办法做到这一点，如果导航链接太多，那么导航栏（ > ）的末尾会出现一个小按钮，当用户单击此按钮时，导航栏会滑动到有更多导航的下一页链接（溢出的链接）。

我知道这是一个很长的镜头，但我到处搜索，找不到任何解决方案或提示。下面是我的导航栏的简化代码：

```
<div id="navcontainer">
                        <div id="bottom-bar">
                            <div class="navigation"><li><div class="shadow"><a class="category" id="link_413" style="" href="#!/Shows">Our Shows</a><ul style="margin-left: -88px; display: none; "><li><a class="subnav" id="link_414" style="" href="#!/TheVault">The Vault</a></li></ul></div></li></div>
                            <div id="nav-arrow" style="left: 25px; "></div>
                        </div>
                        <div id="subnav"></div>
                        <div id="subnavlinks"></div>
                    </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T17:16:23.443

您可以为此创建一个自定义滚动条，但涉及大量 HTML/CSS 经验：

[http://manos.malihu.gr/jquery-custom-content-scroller](http://manos.malihu.gr/jquery-custom-content-scroller)

# python - 基于现有属性值的Django默认模型属性？

> ID：10250599
> 
> 赞同：0
> 
> 时间：2012-04-20T17:13:11.527
> 
> 标签：python, django

我在 Django 中有一个简单的数据模型，其中包含类`Department`和`Role`. （例如清酒。）

A`Department`与 具有一对多关系`Role`，并且`Role`该类包含一个用于标识特定实例的 ID。例如：

```
> Department: Sales
>> Role (1): Accounts
>> Role (3): Closing

> Department: Maintenance
>> Role (2): IT
>> Role (4): Equipment 
```

这样做的缺点是每个角色都使用自己的*全局*ID。因此，如果您要创建大量销售角色，然后再创建一个额外的维护角色，那么新的维护角色的 ID 将非常大，并且看起来“不同步”。

因此，我还想**为每个角色创建一个特定于部门的 ID**，如下所示：

```
class Role(models.Model):
    department_id = models.IntegerField() 
```

缺点是我找不到任何方法：

1) 让现有角色将其现有 ID 转移到新`department_id`字段，留下空白但防止未来出现空白：

```
> Department: Sales
>> Role (1): Accounts
>> Role (3): Closing
>> Role (4): *New Sales Role*

> Department: Maintenance
>> Role (2): IT
>> Role (4): Equipment
>> Role (5): *New Maintenance Role* 
```

2) 或者，动态地将`default`值分配给一个方法，该方法扫描表以查找每个部门的所有角色，并为它们分配新的 ID：

```
> Department: Sales
>> Role (1): Accounts
>> Role (2): Closing
>> Role (3): *New Sales Role*

> Department: Maintenance
>> Role (1): IT
>> Role (2): Equipment
>> Role (3): *New Maintenance Role* 
```

我正在使用 South 来处理模式迁移。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T18:25:38.510

您将需要三个迁移（采用方法二）：

1.  向 Roles 添加一个新字段（我将其称为 user_id，因为它是我假设的用户可见 ID……）——这是通过模式迁移完成的
2.  创建一个循环遍历所有部门的数据迁移，获取每个部门的角色并将它们重新编号到新的 user_id 字段中（内部循环中的一个简单计数器就足够了，可能按当前主键对角色进行排序）
3.  添加另一个模式迁移，它为部门 ID、用户 ID 添加了一个 unique_together 约束——您不希望在一个部门中有重复的用户 ID。

向 user_id 字段添加一个新的默认方法，根据需要获取数据（注意不要遇到丑陋的边缘情况——我会使用带有角色名称而不是整数 id 的 SlugField）

您显然不会摆脱现有的 pk，因为 Django 不支持复合主键（例如在 department_id、user_id 上），但您不必在任何地方显示它。

那就是说；如果只是为了获得“好”的身份，我会选择蛞蝓而不是数字。

# c# - 在 C# 中使用 Windows 登录的 SSO

> ID：10250605
> 
> 赞同：0
> 
> 时间：2012-04-20T17:13:27.563
> 
> 标签：c#, windows, active-directory, single-sign-on, kerberos

我有一个 Linux 服务的 Web 应用程序和一个 C# Windows 客户端。Web 应用程序当前允许 AD 凭据，它对其进行身份验证。

并非所有用户都是基于 Windows 的。我正在尝试为 Windows 用户实施单点登录解决方案。如果用户在 Windows 登录时已经通过 AD 验证，我想允许访问我的应用程序。

我知道如何针对 AD 验证凭据：

```
DirectoryEntry entry = new DirectoryEntry("LDAP://" + domain,
                userName, password); 
```

但我不会有用户名或密码。我知道 AD 正在使用 Kerberos 来存储 Windows 凭据，但我不知道如何访问票证。

我的问题类似于[“如何确定登录的 Windows 帐户是否已在域上通过身份验证”](https://stackoverflow.com/questions/7663439/how-to-determine-if-logged-on-windows-account-has-been-authenticated-on-domain)或[“在客户端-服务器应用程序中使用 Active Directory 对用户进行身份验证”](http://Authenticating%20users%20using%20Active%20Directory%20in%20Client-Server%20Application)，C# 除外。

我正在使用 LightTpd。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T20:50:26.530

查看[通过 Apache 中的 Kerberos 协议提供 Active Directory 身份验证](http://support.microsoft.com/kb/555092)。如果您在 Windows 应用程序中使用 WebClient 或 WebRequest 类，请确保将`UseDefaultCredentials`属性设置为 true。

注意：微软杀死了原版，但内容仍然可以在[Wayback Machine](https://web.archive.org/web/20150110225440/http://support.microsoft.com/kb/555092)中找到。

# java - 使用 ITextRenderer 从带有非拉丁字符的 HTML 生成 PDF 不起作用

> ID：10250606
> 
> 赞同：13
> 
> 时间：2012-04-20T17:13:30.040
> 
> 标签：java, pdf, encoding, itext, flying-saucer

这是我调查的第二天没有结果。至少现在，我可以问一些非常具体的问题。

我正在尝试使用[iText](http://itextpdf.com/)编写一个有效的 HTML 代码，该代码在 PDF 文件中包含一些非拉丁字符，更具体地说，使用来自[Flying Saucer的](http://code.google.com/p/flying-saucer/)**ITextRenderer**。

我的简短示例/代码首先使用此值初始化字符串变量 doc：

```
String doc = "<?xml version=\"1.0\" encoding=\"UTF-8\"?><html xmlns=\"http://www.w3.org/1999/xhtml\" lang=\"en\">"
            + "<body>Some greek characters: Καλημέρα Some greek characters"
            + "</body></html>"; 
```

这是我用于调试目的的代码。我将此字符串保存到 HTML 文件，然后通过浏览器打开它，以仔细检查 HTML 内容是否有效，并且我仍然可以读取希腊字符：

```
//write for debugging purposes in an html file
File newTextFile = new File("C:/work/test.html");
FileWriter fw = new FileWriter(newTextFile);
fw.write(doc);
fw.close(); 
```

下一步是尝试将此值写入 PDF 文件。这是我的代码：

```
ITextRenderer renderer = new ITextRenderer();
    //add some fonts - if paths are not right, an exception will be thrown
    renderer.getFontResolver().addFont("c:/work/fonts/TIMES.TTF", BaseFont.IDENTITY_H, BaseFont.EMBEDDED);
    renderer.getFontResolver().addFont("c:/work/fonts/TIMESBD.TTF", BaseFont.IDENTITY_H, BaseFont.EMBEDDED);
    renderer.getFontResolver().addFont("c:/work/fonts/TIMESBI.TTF", BaseFont.IDENTITY_H, BaseFont.EMBEDDED);
    renderer.getFontResolver().addFont("c:/work/fonts/TIMESI.TTF", BaseFont.IDENTITY_H, BaseFont.EMBEDDED);

    final DocumentBuilderFactory documentBuilderFactory = DocumentBuilderFactory
            .newInstance();
    documentBuilderFactory.setValidating(false);
    DocumentBuilder builder = documentBuilderFactory.newDocumentBuilder();
    builder.setEntityResolver(FSEntityResolver.instance());
    org.w3c.dom.Document document = builder.parse(new ByteArrayInputStream(
            doc.toString().getBytes("UTF-8")));

    renderer.setDocument(document, null);
    renderer.layout();
    renderer.createPDF(os); 
```

我的代码的最终结果是：

**在 HTML 文件中**我得到：*一些希腊字符：Καλημέρα 一些希腊字符*（预期）

**在 PDF 文件中**，我得到：*一些希腊字符：一些希腊字符*（**意外**- 希腊字符被忽略！！）

依赖项：

*   java版本“1.6.0_27”

*   itext-2.0.8.jar

*   de.huxhorn.lilith.3rdparty.flyingsaucer.core-renderer-8Pre2.jar

我也尝试过更多的字体，但我想我的问题与使用错误的字体无关。任何帮助都非常受欢迎。

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-09T16:20:17.657

我来自捷克共和国，对我们的国家标志也有同样的问题！经过一番搜索，我设法用[这个解决方案](https://forums.oracle.com/forums/thread.jspa?threadID=2043079)解决了它。

特别是（您已经拥有）：

```
renderer
    .getFontResolver()
    .addFont(fonts.get(i).getFile().getPath(), 
             BaseFont.IDENTITY_H, 
             BaseFont.NOT_EMBEDDED); 
```

然后是 CSS 中的**重要部分：**

```
* {
  font-family: Verdana;
/*  font-family: Times New Roman; - alternative. Without ""! */
} 
```

在我看来，没有那个 css，你的字体就不会被使用。当我从 CSS 中删除这些行时，编码再次被破坏。

希望这会有所帮助！

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-12-02T10:01:55.917

在您的 HTML 中添加如下内容：

```
<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv='Content-Type' content='text/html; charset=UTF-8'/>
        <style type='text/css'> 
            * { font-family: 'Arial Unicode MS'; }
        </style>
    </head>
    <body>
        <span>Some text with šđčćž characters</span>
    </body>
</html> 
```

然后在java代码中将FontResolver添加到ITextRenderer：

```
ITextRenderer renderer = new ITextRenderer();
renderer.getFontResolver().addFont("fonts/ARIALUNI.TTF", BaseFont.IDENTITY_H, BaseFont.NOT_EMBEDDED); 
```

非常适合克罗地亚语角色

用于生成 PDF 的 jar 是：

```
core-renderer.jar
iText-2.0.8.jar 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T19:29:50.453

让`iText`从包含`utf-8`内容的 html 内容中读取标题信息。在带有编码的 html 代码中
添加`meta`标签，然后运行以生成 PDF 并检查结果。 `content-type``utf-8` `charset``iText`

```
<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
 </head>
 <body>
  Some greek characters: Καλημέρα Some greek characters
 </body>
</html> 
```

**更新**：
如果上述方法不起作用，请参阅[http://www.manning.com/lowagie2/iText2E_MEAP_CH02.pdf](http://www.manning.com/lowagie2/iText2E_MEAP_CH02.pdf)`ENCODING VERSUS THE DEFAULT CHARSET USED BY THE JVM`上发布的文档

# .net - CSS中的Base64编码图像

> ID：10250613
> 
> 赞同：0
> 
> 时间：2012-04-20T17:13:59.577
> 
> 标签：.net, css, vb.net, base64

我正在编写一个小项目来解析 CSS 文件，并对所有背景图像进行 base64 编码。

虽然我能够正确解析 CSS，但似乎每次我尝试将图像文件转换为 base64Encoded 字符串时，返回的字符串总是完全相同的。

我究竟做错了什么？

这是编码器。请假设所有图像路径都正确传递给该方法。在这种情况下，所有图像都是完全限定的 url，因此该方法的第一部分是进行转换的内容。

```
Public Sub EncodeImage(ByVal _File As String)
    If _File.StartsWith("http") OrElse _File.StartsWith("https") Then
        Using _wc As New WebClient()
            Common.SetAllowUnsafeHeaderParsing20()
            _wc.Headers.Add("User-Agent", "Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.2.13) Gecko/20101203 Firefox/3.6.13")
            _wc.DownloadFile(_File, "c:\temp.png")
            Dim _d As Byte() = _wc.DownloadData(_File)
            ImageStrings.Add(New ImageTyping() With {
                             .SourceFile = _File,
                             .Base64String = Convert.ToBase64String(_d)
                         })
            _d = Nothing
        End Using
    Else
        Using _fs As New FileStream(_File, IO.FileMode.Open)
            Using _br As New BinaryReader(_fs)
                Dim _i As Byte() = _br.ReadBytes(_fs.Length)
                ImageStrings.Add(New ImageTyping() With {
                             .SourceFile = _File,
                             .Base64String = Convert.ToBase64String(_i)
                             })
                _i = Nothing
                _br.Close()
            End Using
            _fs.Close()
        End Using
    End If
End Sub 
```

从这里返回的每个字符串都是：

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T17:22:34.357

您发布的 base64 字符串是有效的 24x24 像素全透明 PNG 文件。您的 base64 代码似乎可以工作，但您转换的文件可能不是您想要转换的文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T12:18:29.100

我删除了 User-Agent 标头字符串，问题就消失了。

# python - pyqt QTreeWidget setColumnWidth 不起作用

> ID：10250615
> 
> 赞同：0
> 
> 时间：2012-04-20T17:14:01.023
> 
> 标签：python, qt, pyqt, qtreewidget

所以我看到了一些类似的问题，但也许我不够聪明，无法将其应用于我的情况。在以下示例中，似乎受 setColumnWidth 影响的唯一列是第 0 列。

```
''' A custom widget to set up the tree column widths '''

from PyQt4 import QtGui

class PCLTreeWidget(QtGui.QTreeWidget):
    def __init__(self,parent):
        QtGui.QTreeWidget.__init__(self,parent)

        ## set the sizes
        self.setColumnWidth(0,250)
        print self.columnWidth(0)
        self.setColumnWidth(1,250)
        print self.columnWidth(1)
        self.setColumnWidth(2,100)
        print self.columnWidth(2)
        self.setColumnWidth(3,1)
        print self.columnWidth(3)
        self.setColumnWidth(4,1)
        print self.columnWidth(4)
        self.setColumnWidth(5,3)
        print self.columnWidth(5)
        self.setColumnWidth(6,1)
        print self.columnWidth(6)
        self.setColumnWidth(7,1)
        print self.columnWidth(7)
        self.setColumnWidth(8,1)
        print self.columnWidth(8)
        self.setColumnWidth(9,1)
        print self.columnWidth(9) 
```

输出：250 0 0 0 0 0 0 0 0 0

我错过了什么？

更新：看起来我需要在 resizeEvent 函数中执行此操作，因为列已在**init**函数中设置：

```
''' A custom widget to set up the tree column widths '''
  2
  3 from PyQt4 import QtGui
  4
  5 class PCLTreeWidget(QtGui.QTreeWidget):
  6     def __init__(self,parent):
  7         QtGui.QTreeWidget.__init__(self,parent)
  8
  9
 10     def resizeEvent(self, resizeEvent):
 11         ## handle resize
 12         self.setColumnWidth(0,250)
 13         self.setColumnWidth(1,250)
 14         self.setColumnWidth(2,30)
 15         self.setColumnWidth(3,60)
 16         self.setColumnWidth(4,50)
 17         self.setColumnWidth(5,250)
 18         self.setColumnWidth(6,35)
 19         self.setColumnWidth(7,45)
 20         self.setColumnWidth(8,60)
 21         self.setColumnWidth(9,35)
 22         self.header().setResizeMode(0,QtGui.QHeaderView.Stretch | QtGui.QHeaderView.Interactive)
 23         self.header().setResizeMode(1,QtGui.QHeaderView.Stretch)
 24         self.header().setResizeMode(2,QtGui.QHeaderView.Fixed)
 25         self.header().setResizeMode(3,QtGui.QHeaderView.Fixed)
 26         self.header().setResizeMode(4,QtGui.QHeaderView.Fixed)
 27         self.header().setResizeMode(5,QtGui.QHeaderView.Stretch)
 28         self.header().setResizeMode(6,QtGui.QHeaderView.Fixed)
 29         self.header().setResizeMode(7,QtGui.QHeaderView.Fixed)
 30         self.header().setResizeMode(8,QtGui.QHeaderView.Fixed)
 31         self.header().setResizeMode(9,QtGui.QHeaderView.Fixed) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T19:04:21.367

在您更新的示例中，每次触发 resizeEvent 时都会执行这一系列列调整，随着小部件随着时间的推移调整大小，这可能非常频繁。这真的是你想要的吗？这也意味着如果用户调整列大小，然后调整树的父级大小，所有内容都会再次弹回这个大小。

您可能希望将列选项移动到 a `showEvent`，以便它们仅在显示小部件时完成一次。或者，不是设置显式大小，也许您可​​以使用标题的最小大小设置。[http://www.riverbankcomputing.co.uk/static/Docs/PyQt4/html/qheaderview.html#setMinimumSectionSize](http://www.riverbankcomputing.co.uk/static/Docs/PyQt4/html/qheaderview.html#setMinimumSectionSize)。这实际上可能会强制执行您的最小尺寸，但仍允许它们随着调整大小而扩展。

# asp.net - 在 ASP.net 上更改数据源

> ID：10250616
> 
> 赞同：0
> 
> 时间：2012-04-20T17:14:02.587
> 
> 标签：asp.net, datasource, dataview

**问题：**我在 .aspx 文件中声明了 2 个数据源，如下所示：

```
<asp:ObjectDataSource ID="ObjectDataSource1" runat="server" DeleteMethod="UsuarioDelete" SelectMethod="SelectMyAllNotME_Data" TypeName="BLLayer.Usuarios" OnInserted="ObjectDataSource_Inserted">
    <DeleteParameters>
        <asp:ControlParameter ControlID="ConfirmDialogBox1" Name="id_usuario" PropertyName="Aceptar_CommandName" Type="Int32" />
    </DeleteParameters>
    <SelectParameters>
        <asp:SessionParameter DefaultValue="1" Name="id_usuario" SessionField="id_usuario" Type="Int32" />
        <asp:SessionParameter DefaultValue="1" Name="id_pais" SessionField="id_pais" Type="Int32" />
    </SelectParameters>
</asp:ObjectDataSource>
<asp:ObjectDataSource ID="ObjectDataSource2" runat="server" DeleteMethod="UsuarioDelete" SelectMethod="SelectMyAllNotME_Data" TypeName="BLLayer.Usuarios" OnInserted="ObjectDataSource_Inserted">
    <DeleteParameters>
        <asp:ControlParameter ControlID="ConfirmDialogBox1" Name="id_usuario" PropertyName="Aceptar_CommandName" Type="Int32" />
    </DeleteParameters>
        <SelectParameters>
            <asp:QueryStringParameter DefaultValue="0" Name="id_emp" QueryStringField="id_emp" Type="Int32" />
        </SelectParameters>
</asp:ObjectDataSource> 
```

方法“SelectMyAllNotME_Data”是一种重载方法，在一个他接收 2 个值而在另一个只接收一个值时，它用于过滤信息。我想做的是在我的 onLoadPage 方法中是这样的：

```
if (Request.QueryString["id_emp"] != null)
    {
        GridViewUsers.DataSource = ObjectDataSource2.SelectMethod;
        GridViewUsers.DataMember = ObjectDataSource2.SelectMethod;
    }
    else
    {
        GridViewUsers.DataSource = ObjectDataSource1.SelectMethod;
        GridViewUsers.DataMember = ObjectDataSource1.SelectMethod;
    }
} 
```

我已经尝试过了，但它不起作用，有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:16:16.250

你应该打电话

```
GridViewUsers.DataBind(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T17:27:44.353

在 aspx 中的数据源上只是做

```
EnablePaging="true" 
```

# java - Java：Apache POI：我可以从 MS Word (.doc) 文件中获取干净的文本吗？

> ID：10250617
> 
> 赞同：11
> 
> 时间：2012-04-20T17:14:10.023
> 
> 标签：java, text, ms-word, apache-poi, extraction

我在使用 Apache POI 时（以编程方式）从 MS Word 文件中获取的字符串与我在使用 MS Word 打开文件时可以看到的文本不同。

使用以下代码时：

```
File someFile = new File("some\\path\\MSWFile.doc");
InputStream inputStrm = new FileInputStream(someFile);
HWPFDocument wordDoc = new HWPFDocument(inputStrm);
System.out.println(wordDoc.getText()); 
```

输出是包含许多“无效”字符（是的，“框”）和许多不需要的字符串的单行，例如“ `FORMTEXT`”、“ `HYPERLINK \l "_Toc##########"`”（“#”是数字）、“ `PAGEREF _Toc########## \h 4`”等。

以下代码“修复”了单行问题，但保留了所有无效字符和不需要的文本：

```
File someFile = new File("some\\path\\MSWFile.doc");
InputStream inputStrm = new FileInputStream(someFile);
WordExtractor wordExtractor = new WordExtractor(inputStrm);
for(String paragraph:wordExtractor.getParagraphText()){
  System.out.println(paragraph);
} 
```

* * *

我不知道我是否使用了错误的方法来提取文本，但这就是我在查看[POI 的快速指南](http://poi.apache.org/hwpf/quick-guide.html)时想到的。如果我是，正确的方法是什么？

如果该输出是正确的，是否有摆脱不需要的文本的标准方法，还是我必须编写自己的过滤器？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-17T08:53:43.927

此类可以读取 Java 中的 .doc 和 .docx 文件。为此，我使用 tika-app-1.2.jar：

```
/*
 * This class is used to read .doc and .docx files
 * 
 * @author Developer
 *
 */

import java.io.ByteArrayOutputStream;
import java.io.File;
import java.io.InputStream;
import java.io.OutputStream;
import java.io.OutputStreamWriter;
import java.net.URL; 
import org.apache.tika.detect.DefaultDetector;
import org.apache.tika.detect.Detector;
import org.apache.tika.io.TikaInputStream;
import org.apache.tika.metadata.Metadata;
import org.apache.tika.parser.AutoDetectParser;
import org.apache.tika.parser.ParseContext;
import org.apache.tika.parser.Parser;
import org.apache.tika.sax.BodyContentHandler;
import org.xml.sax.ContentHandler;

class TextExtractor { 
    private OutputStream outputstream;
    private ParseContext context;
    private Detector detector;
    private Parser parser;
    private Metadata metadata;
    private String extractedText;

    public TextExtractor() {
        context = new ParseContext();
        detector = new DefaultDetector();
        parser = new AutoDetectParser(detector);
        context.set(Parser.class, parser);
        outputstream = new ByteArrayOutputStream();
        metadata = new Metadata();
    }

    public void process(String filename) throws Exception {
        URL url;
        File file = new File(filename);
        if (file.isFile()) {
            url = file.toURI().toURL();
        } else {
            url = new URL(filename);
        }
        InputStream input = TikaInputStream.get(url, metadata);
        ContentHandler handler = new BodyContentHandler(outputstream);
        parser.parse(input, handler, metadata, context); 
        input.close();
    }

    public void getString() {
        //Get the text into a String object
        extractedText = outputstream.toString();
        //Do whatever you want with this String object.
        System.out.println(extractedText);
    }

    public static void main(String args[]) throws Exception {
        if (args.length == 1) {
            TextExtractor textExtractor = new TextExtractor();
            textExtractor.process(args[0]);
            textExtractor.getString();
        } else { 
            throw new Exception();
        }
    }
} 
```

编译：

```
javac -cp ".:tika-app-1.2.jar" TextExtractor.java 
```

跑步：

```
java -cp ".:tika-app-1.2.jar" TextExtractor SomeWordDocument.doc 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-22T18:56:21.247

有两种选择，一种直接在 Apache POI 中提供，另一种通过 Apache Tika（内部使用 Apache POI）提供。

第一个选项是使用`WordExtractor`，但在调用[`stripFields(String)`](http://poi.apache.org/apidocs/org/apache/poi/hwpf/extractor/WordExtractor.html#stripFields%28java.lang.String%29)时将其包装在调用中。这将删除文本中包含的基于文本的字段，例如您看到的 HYPERLINK。您的代码将变为：

```
NPOIFSFileSystem fs = new NPOIFSFileSytem(file);
WordExtractor extractor = new WordExtractor(fs.getRoot());

for(String rawText : extractor.getParagraphText()) {
String text = extractor.stripFields(rawText);
System.out.println(text);
} 
```

另一种选择是使用[Apache Tika](http://tika.apache.org/)。Tika 为各种文件提供文本提取和元数据，因此相同的代码也适用于 .doc、.docx、.pdf 和许多其他文件。要获得干净、纯文本的 word 文档（如果您愿意，也可以使用 XHTML），您可以执行以下操作：

```
TikaConfig tika = TikaConfig.getDefaultConfig();
TikaInputStream stream = TikaInputStream.get(file);
ContentHandler handler = new BodyContentHandler();
Metadata metadata = new Metadata();
tika.getParser().parse(input, handler, metadata, new ParseContext());
String text = handler.toString(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-11-04T10:16:32.730

试试这个，对我有用，纯粹是一个 POI 解决方案。不过，您将不得不寻找 HWPFDocument 对应项。确保您正在阅读的文档早于 Word 97，否则像我一样使用 XWPFDocument。

```
InputStream inputstream = new FileInputStream(m_filepath); 
//read the file 
XWPFDocument adoc= new XWPFDocument(inputstream);
//and place it in a xwpf format

aString = new XWPFWordExtractor(adoc).getText();           
//gets the full text 
```

* * *

现在，如果您想要某些部分，您可以使用 getparagraphtext 但不要使用文本提取器，直接在段落上使用它，如下所示

```
for (XWPFParagraph p : adoc.getParagraphs()) 
{ 
    System.out.println(p.getParagraphText());
} 
```

# java - 无法从分布式缓存 Hadoop 加载库

> ID：10250618
> 
> 赞同：1
> 
> 时间：2012-04-20T17:14:11.840
> 
> 标签：java, hadoop, mapreduce

我正在这样做：

```
DistributedCache.createSymlink(job.getConfiguration()); 
DistributedCache.addCacheFile(new URI   
("hdfs:/user/hadoop/harsh/libnative1.so"),job.getConfiguration()); 
```

在映射器中：

```
System.loadLibrary("libnative1.so"); 
```

（我也试过 System.loadLibrary("libnative1"); System.loadLibrary("native1");

但我收到此错误：

```
java.lang.UnsatisfiedLinkError: no libnative1.so in java.library.path 
```

我完全不知道应该将 java.library.path 设置为什么。我尝试将其设置为 /home 并将每个 .so 从分布式缓存复制到 /home/ 但它仍然不起作用:(

请问有什么建议/解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T20:29:38.877

使用 Hadoop ToolRunner 接口；这将使您能够通过命令行参数将共享库添加到分布式缓存中，并在映射器启动之前在任务节点上正确设置 java 库路径。这就是我设置映射器以使用共享库的方式：

让作业类（包含 main() 方法）实现 org.apache.hadoop.util.Tool 接口。像这样的东西：

```
public class Job extends Configured implements Tool {

  @Override
  public int run(String[] args) throws Exception {
    /* create the Hadoop Job here */
  }

  public static void main(String[] args) {
    int ret;
    try {
      ret = ToolRunner.run(new Job(), args);
    } catch (Exception e) {
      e.printStackTrace();
      ret = -1;
    }
    System.exit(ret);
  }
} 
```

运行 hadoop 作业时，将所有共享库（本地副本）作为命令行参数。确保也列出实际文件（如果这些是符号链接）。Hadoop 将在开始作业之前将 -files 参数中给出的所有文件复制到分布式缓存中。

```
hadoop jar Job.jar -files libnative1.so,libnative1.so.0,libnative1.so.0.1 
```

Mapper 不需要任何特殊调用来设置 java.library.path；它由 hadoop 处理。

# linux - 在 linux 中安装 java 的问题

> ID：10250624
> 
> 赞同：0
> 
> 时间：2012-04-20T17:14:21.900
> 
> 标签：linux

我试图在 install 中安装 Java，但由于某种原因它不起作用。

我尝试了与本网站中提到的相同的方法-http://www.java.com/en/download/help/linux_install.xml#enable

当我尝试这个命令时，我看到我的桌面上安装了 Java，

premvidya@ubuntu:~/Desktop$ ls jre1.6.0_31 jre-6u31-linux-i586(2).bin jre-6u31-linux-i586.bin

但是当我尝试 java - 版本时，我收到以下错误，

premvidya@ubuntu:~/Desktop$ java -version 程序“java”可以在以下包中找到： * gij-4.3 * java-gcj-compat-headless * openjdk-6-jre-headless * cacao * gij-4.2 * jamvm * kaffe 尝试：sudo apt-get install bash: java: command not found

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T17:18:18.017

你为什么要手动安装java？有一个存储库，它都是为你管理的。手动卸载您在系统上放置的任何内容并通过命令行安装它。

apt-get 缓存搜索 java apt-get 缓存搜索 jdk

*或* 启动 Ubuntu 软件中心 -> 搜索 java。

一旦通过 apt-get 安装，新的 java 命令将立即在你的 PATH 中可用，只要你没有删除任何东西......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-17T06:49:32.527

[@user1050619](https://stackoverflow.com/users/1050619/user1050619)

嗨，user1050619，
我遇到了可以在任何版本的 Ubuntu 上运行的解决方案，肯定会保持其他 Java 版本完好无损。

我使用了 Java 的独立安装。

为此，请从 [Oracle 网站下载 Java 的 tar.gz 版本。](http://www.oracle.com/technetwork/java/javase/downloads/index.html)

1.  假设，您的 jdk 安装 tar 文件位于`/home/don/`

2.  不要@ubuntu ~ $`tar zxf jdk-7u45-linux-i586.tar.gz`

3.  不要@ubuntu ~ $`sudo bash`

    [sudo] 唐密码：

4.  ubuntu~#`mv /home/don/jdk1.7.0_45/ /usr/lib/jvm/`

5.  ubuntu~#`cd /usr/lib/jvm/`

6.  ubuntu jvm #`update-alternatives --install /usr/bin/java java /usr/lib/jvm/jdk1.7.0_45/bin/java 3`

7.  ubuntu jvm #`update-alternatives --config java`

> ```
>  Selection    Path                                           Priority   Status  
> ------------------------------------------------------------  
> * 0            /usr/lib/jvm/java-7-openjdk-i386/jre/bin/java   1071      auto mode  
>   1            /usr/lib/jvm/java-7-openjdk-i386/jre/bin/java   1071      manual mode  
>   2            /usr/lib/jvm/jdk1.7.0_45/bin/java               3         manual mode  
> Press enter to keep the current choice[*], or type selection number: 2
> update-alternatives: using /usr/lib/jvm/jdk1.7.0_45/bin/java to provide /usr/bin/java (java) in manual mode 
> ```

8.  ubuntu jvm # `java -version`
    java version "1.7.0_45"
    Java(TM) SE Runtime Environment (build 1.7.0_45-b18)
    Java HotSpot(TM) Server VM (build 24.45-b08, mixed mode)

你在这里完成没有任何麻烦。

快乐编程！！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T19:31:30.337

它应该是“apt-cache search java6”或只是“apt-cache search java”。它会给你一个与java相关的所有包的列表。如果你想安装 sun 的 java，那么你下载 java-**.bin 文件，然后运行 ​​"sudo /bin/sh jre-6u31-linux-i586.bin" 这将从 sun java 运行安装程序您下载并开始安装。回答问题并安装软件包。

# ruby-on-rails - 我如何访问模块中的 Ruby/Rails 核心日期类？

> ID：10250628
> 
> 赞同：2
> 
> 时间：2012-04-20T17:14:57.337
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我用初始化脚本重载了模块的某些类。在模块中有一个类被调用`Date`，因此无法使用`Date.today`或其他日期方法。如何访问 Ruby/Rails 核心日期类？`Rails::Date`不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T17:34:15.070

您可以在 Date 类之前使用“::”。

Rails 只是扩展了 Ruby Core Date 类，所以你可以使用

```
  ::日期.今天

```

# java - Spring MVC @RequestMapping 不起作用

> ID：10250631
> 
> 赞同：9
> 
> 时间：2012-04-20T17:15:01.307
> 
> 标签：java, spring-mvc

我有一个奇怪的场景，除非我将调度程序 servlet 映射到 web.xml 中的 /*，否则不会调用我的控制器。我已经定义了一个带有 RequestMapping 的控制器：

```
@Controller  
public class UserController {

    @RequestMapping(value = "/rest/users", method = RequestMethod.GET)
    public ModelAndView getUsers(HttpServletRequest request) throws RestException {
      ...
    }  
} 
```

和一个应用程序上下文：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:util="http://www.springframework.org/schema/util"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:mvc="http://www.springframework.org/schema/mvc"
       xsi:schemaLocation="
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd
        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
        http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-2.5.xsd
        http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd">

    <context:component-scan base-package="com.test.rest.controller" /> 
```

最后在 web.xml 中映射：

```
<servlet>
    <servlet-name>rest-servlet</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/restContext.xml</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet>

<servlet-mapping>
    <servlet-name>rest-servlet</servlet-name>
    <url-pattern>/*</url-pattern>
</servlet-mapping> 
```

这按预期工作，即我可以向/rest/users 发出请求。但是，如果我将 web.xml 映射更改为：

```
<servlet-mapping>
    <servlet-name>rest-servlet</servlet-name>
    <url-pattern>/rest/*</url-pattern>
</servlet-mapping> 
```

我收到一个 MVC 错误：

> WARN servlet.PageNotFound：在名称为“rest-servlet”的 DispatcherServlet 中找不到具有 URI [/rest/users] 的 HTTP 请求的映射。

这看起来很奇怪，因为错误表明请求被映射到 dispatcher-servlet，但唯一改变的是 servlet 映射。

有人遇到过这种情况么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-20T17:19:43.927

Dispatcher servlet 是 Spring MVC 的主要 servlet。它处理所有请求，到达您的应用程序，并使用自己的路由引擎将其分派给控制器。如果您将其更改为

```
 <url-pattern>/rest/*</url-pattern> 
```

那么你的请求应该是这样的`rest/rest/users`

通用模式 - 允许 dispatch servlet 处理所有传入请求（第一个配置有效）

# regex - 需要帮助正则表达式匹配单引号，但不要在结果中包含引号

> ID：10250635
> 
> 赞同：2
> 
> 时间：2012-04-20T17:15:20.810
> 
> 标签：regex

我正在尝试找到一种匹配以下测试字符串的方法：

```
token = '1866FB352F4DF76BCB92C3482DB7D7B4F562'; 
```

我要返回的数据是...

```
1866FB352F4DF76BCB92C3482DB7D7B4F562 
```

我尝试了以下方法，我的关闭是这样的，但它包括最后的单引号：

```
(?!token = ')(\w+)'; 
```

现在，另一个工作密切，但它包括最后一个单引号：

```
'([^']+)' 
```

有没有人想对这个进行一番尝试？

更新：在查看了我需要解析的内容后，我在 html 中的表单区域中找到了相同的值，看起来可能更容易抓取：

```
name="token" value="482CD1FE037F68D5A36F4C961A6D57D9" 
```

同样，我只需要 value="*" 中的内容

但是，正则表达式必须解析整个 html 源代码，所以我假设我需要搜索 name="toke" value= 但不将其包含在结果集中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:16:50.400

如果您的正则表达式引擎支持[环视](http://www.regular-expressions.info/lookaround.html)，您可以使用

```
(?<=')\w+(?=') 
```

如果字母数字单词被单引号包围，则它匹配一个字母数字单词，而不使这些引号成为实际匹配的一部分。如果您只想匹配十六进制数字，请使用

```
(?i)(?<=')[0-9A-F]+(?=') 
```

**编辑：**

由于您现在添加了您正在使用 JMeter，并且由于我无法理解的原因（因为 Java 本身确实支持它），JMeter 不支持后向断言，您可能会像这样作弊：

```
\b[0-9A-F]+(?=') 
```

只检查一个完整的十六进制数字是否出现在`'`字符之前。它不会检查是否存在开场报价，但很可能这无关紧要。

# apache-flex - IIS7 上的 Flex 应用程序

> ID：10250639
> 
> 赞同：1
> 
> 时间：2012-04-20T17:15:48.530
> 
> 标签：apache-flex, iis-7, windows-server-2008

我将我的 Flex 应用程序部署到 Windows Server 2008 机器上，但它停止工作。它在 Windows Server 2003 和我的本地机器上运行良好。

详细信息：应用程序运行并加载 RSL 库。它显示登录屏幕。我登录它，它开始显示整个界面。突然应用程序屏幕变空，所有界面元素都消失了

任何线索？

# google-docs - 在停机期间访问 Google 电子表格 Feed

> ID：10250649
> 
> 赞同：1
> 
> 时间：2012-04-20T17:16:37.110
> 
> 标签：google-docs, google-docs-api, google-sheets, google-spreadsheet-api

我想知道是否有任何信息说明已发布的电子表格提要如何受到 Google Docs 电子表格服务的临时停机时间的影响。

在此期间或停机期间，Feed 是否仍然可用？是否存在无法提供 Feed 的情况？

我会假设提要被缓存。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T15:25:46.970

There are numerous circumstances here that make this a difficult question to answer, primarily because portions of Google Spreadsheets could be "down", even though the system is still usable.

For the most part, though: If Google Spreadsheets were *completely* down, then yes, the Google Spreadsheets API would also be down. The feeds are not cached.

Applications using the Google Spreadsheets API should implement local caching as a best practice.

# ruby-on-rails - Rspec link_to - 包括确认/数据确认属性导致测试失败

> ID：10250653
> 
> 赞同：3
> 
> 时间：2012-04-20T17:16:51.167
> 
> 标签：ruby-on-rails, rspec2, ruby-1.8.7

我有一个链接如下，我正在尝试测试（请忽略方括号）：

> [%= link_to "删除用户", destroy_user_account_path(@profile.user), :class => "delete", :confirm => "a", :title => "Delete #{@profile.user.name}", :method => :delete %]

下面的测试失败，但如果我注释掉 :confirm => "a" 行，它会通过：

> ```
>  it "should have a link to delete the user's account (using the destroy_user_account action in the registrations controller)" do
>     get :show, :id => @profile
>     response.should have_selector("a",
>                                   :href => destroy_user_account_path(@profile.user),
>                                   :confirm => "a",
>                                   :title => "Delete #{@profile.user.name}",
>                                   :class => "delete", 
>                                   :content => "Delete User")
>   end 
> ```

看我的失败:(

> ```
>  Failure/Error: response.should have_selector("a",
>    expected following output to contain a <a title='Delete Michael Hartl' class='delete' href='/destroy-user-account/159' confirm='a'>Delete User</a> tag: 
> ```

该行的实际 html 输出如下（同样，方括号是我的）。我注意到它在这里输出“数据确认”作为属性，而不是测试所期望的“确认”属性。

> [a href="/destroy-user-account/159" class="delete" data-confirm="a" data-method="delete" rel="nofollow" title="删除 Michael Hartl"]删除用户[/一种]

谁能解释在这种情况下确认和数据确认之间有什么区别，并帮助我弄清楚为什么会出现此错误/如何解决？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:23:35.343

“确认”不是 HTML 属性。`data-whatever`标签是 HTML5 的一项功能，允许您在元素上放置所需的任何自定义属性，主要用于在客户端与 Javascript 之间传递信息。

所以：`<a confirm="foo"></a>`不是有效的 HTML，但是`<a data-confirm="foo"></a>`是。

Rails UJS 会查找`data-confirm`标签并知道在您单击它们时会提示您一条确认消息。它从`data-confirm`值中获取确认消息。

因此，在这种情况下，您的代码应为：

```
response.should have_selector("a",
                              :href => destroy_user_account_path(@profile.user),
                              'data-confirm' => "a",
                              :title => "Delete #{@profile.user.name}",
                              :class => "delete", 
                              :content => "Delete User") 
```

那应该可以解决您的问题，如果没有，请告诉我。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T17:33:07.397

“确认”选项只是 link_to 提供的“数据确认”的别名。

```
link_to anything, :confirm => "Message" # is equivalent to
link_to anything, 'data-confirm' => "Message" 
```

但是您使用的匹配器不知道别名，因此您需要在那里使用“数据确认”：

```
response.should have_selector("a",
                              :href => destroy_user_account_path(@profile.user),
                              'data-confirm' => "a",
                              :title => "Delete #{@profile.user.name}",
                              :class => "delete", 
                              :content => "Delete User") 
```

# ruby-on-rails - 为什么我需要在所有 sass 文件中使用“@import compass”进行预编译？

> ID：10250654
> 
> 赞同：2
> 
> 时间：2012-04-20T17:16:51.557
> 
> 标签：ruby-on-rails, asset-pipeline, compass-sass

我正在使用 Rails 和 Compass。一切都很好，直到我部署到生产时，我点击了：

```
bundle exec rake RAILS_ENV=staging RAILS_GROUPS=assets assets:precompile'
 ** rake aborted!
 ** Undefined mixin 'column'.
 ** (in /....../app/assets/stylesheets/clients.css.sass) 
```

应用程序.css.sass

```
@import compass
@import _blueprint
@import "compass/layout/sticky-footer"
@import "compass/css3/gradient"
@import "partials/_base"
@import "blueprint/reset"
@import "blueprint/colors"
@import "blueprint/grid"
@import "blueprint/fancy-type"
@import "blueprint/scaffolding"
@import "blueprint/form"
@import "clients" 
```

客户.css.sass

```
#clients
  +column(4) 
```

所以你可以看到clients.css.sass 没有导入指南针、蓝图等，b/c 它是由application.css.sass 导入的。但是为什么资产编译器试图自己编译这个文件呢？我可以通过在每个 css.sass 文件中添加“@import compass”来修复它，但似乎我不应该这样做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T17:26:17.090

确保您的应用程序清单不包含`require_tree .`或类似内容。如果 sprockets 需要 sass 导入之外的文件，它总是会引发此错误。起初我为此遇到了很多麻烦。

如果不是这种情况，您使用的是哪个版本的 Rails？在早期的 Rails 3.1.x 中，rake 预编译存在一些问题，这些问题后来得到了修复......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T13:29:27.587

我在 Rails 和 Asset Pipeline 中发现，您需要`@import`使用部分符号来罗盘和蓝图子元素。要使该`column`功能正常工作，您需要：

```
@import "blueprint/_grid" 
```

顺便说一句，您没有在前两行使用引号的任何原因 - 我预计需要以下内容：

```
@import "compass"
@import "blueprint" 
```

虽然在这种情况下不是 100% 确定该`blueprint`行是否需要前导，尽管我在 Rails 3.2.3 下`_`肯定会在没有它的情况下导入`compass`

# grails - 如何调整 Grails UI 插件中 datePicker 的日历显示位置，而不在调整页面大小时更改位置？

> ID：10250656
> 
> 赞同：1
> 
> 时间：2012-04-20T17:16:55.393
> 
> 标签：grails, datepicker, yui, grails-plugin

我想更改 Grails UI 插件的 datePicker 部分的日历显示位置。经过一番挖掘，我在 InputTagLib.groovy 文件中找到了它：

```
 out << """
            YAHOO.util.Event.on("${showButtonId}", "click", function() {
                var buttonRegion = YAHOO.util.Dom.getRegion('${showButtonId}');
                var buttonHeight = buttonRegion.bottom - buttonRegion.top;
                var buttonWidth = buttonRegion.right - buttonRegion.left;
                var xy = YAHOO.util.Dom.getXY('${showButtonId}');
                var newXY = [xy[0] + buttonWidth, xy[1] + buttonHeight];
                YAHOO.util.Dom.setXY('${id}_calContainer_c', newXY);
                GRAILSUI.${jsid}Panel.show();
                if (YAHOO.env.ua.opera && document.documentElement) {
                    // Opera needs to force a repaint
                    document.documentElement.className += "";
                }
            });""" 
```

位置设置在这一行：

```
 YAHOO.util.Dom.setXY('${id}_calContainer_c', newXY); 
```

YAHOO.util.Dom.setXY() 方法有两个参数。

> setXY 方法的第一个参数是 HTMLElement 的 ID，或者是实际的 HTMLElement 对象。第二个参数是一个包含两个值的数组： [x, y] 其中 x 是到文档左边缘的距离，y 是到文档上边缘的距离。

来源：http: [//developer.yahoo.com/yui/examples/dom/setxy.html](http://developer.yahoo.com/yui/examples/dom/setxy.html)

因此，我可以通过更改传递给 setXY 方法的 newXY 变量中的值轻松调整日历的显示位置，并且效果很好。

但是，如果我调整页面大小，日历会将其左上角直接放在 showButton 的左下角下方。调整页面大小时发生重新定位的原因是什么，我该如何解决？

**编辑：**更多信息：

*   这发生在最新版本的 IE、Firefox 和 Chrome 中
*   如果我调整页面大小然后单击按钮以显示日历，日历会显示在预期的位置，但如果我在日历打开后再次调整页面大小，它将重新定位

# android - 我可以使用 AIR 创建 Sony LiveView™ 插件吗？

> ID：10250664
> 
> 赞同：0
> 
> 时间：2012-04-20T17:17:54.570
> 
> 标签：android, plugins, air, flash-builder, sony

我有兴趣创建一个在我的 LiveView™ 上使用的插件，但我不熟悉 Java 在 Android 平台上的开发。但是，我使用 As3 / AIR 没有问题。

所以我的问题是，是否可以使用 AIR sdk 创建 Sony LiveView™ 插件？如果是这样，我从哪里开始？（例如，我需要配置什么来获得我的第一个 Hello World 插件）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T00:00:43.450

不幸的是，无法使用 Air 为 LiveView 进行开发。

如果您想使用 Java，请访问[http://sonymobile.com/developer](http://sonymobile.com/developer)获取更多信息和 SDK 。

/马格纳斯

# c - recv() 接收部分消息的套接字编程问题

> ID：10250666
> 
> 赞同：5
> 
> 时间：2012-04-20T17:18:01.123
> 
> 标签：c, linux

我有一个正在接收流式股票报价数据的套接字。但是，我似乎收到了很多被截断的消息，或者似乎是被截断的消息。这是我接收数据的方式：

```
if((numbytes = recv(sockfd, buf, MAXDATASIZE-1, 0)) == -1) {
    perror("recv()");
    exit(1);
}
else {
    buf[numbytes] = '\0';
    // Process data
} 
```

可以`recv()`只接收所发送内容的部分消息吗？

我的感觉是我可能需要围绕`recv()`接收的呼叫进行另一个循环，直到发送完整的消息。我知道我拥有的 libcurl 实现（我认为这里不可能使用 libcurl）有一个外循环：

```
// Read the response (sum total bytes read in tot_bytes)
for(tot_bytes=0; ; tot_bytes += iolen)
{  
    wait_on_socket(sockfd, 1, 60000L);
    res = curl_easy_recv(curl, buf + tot_bytes, sizeof_buf - tot_bytes, &iolen);

    if(CURLE_OK != res) {
        // printf( "## %d", res );
        break;
    }
} 
```

我是否需要一个`recv()`类似于 libcurl 示例的循环（可验证有效）？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-12-22T20:35:39.597

我们也可以传递标志来`recv`等待所有消息都到达。当您知道要接收的字节数时，它就会起作用。您可以像这样传递命令。

```
numbytes =  recv(sockfd, buf, MAXDATASIZE-1, MSG_WAITALL); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-20T17:20:55.607

你是对的，你需要一个循环。 `recv`只检索当前可用的数据；一旦读取了任何数据，它就不会等待更多数据出现才返回。

[手册页](http://linux.die.net/man/2/recv)说“接收呼叫通常会返回任何可用的*数据，直到请求的数量，而不是等待收到请求的全部数量。”*

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-20T17:20:59.180

TCP 不尊重消息边界。这意味着`recv()`不能保证完全按照您的假设获得整个消息。这就是为什么你需要围绕你的`recv()`. （这也是为什么像 HTTP 这样的上层协议要么关闭套接字，要么在前面添加一个长度指示符，以便接收者准确地知道何时停止从套接字读取。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-20T17:20:17.680

> recv() 可以只接收发送的部分消息吗？

是的，确实，如果您使用 TCP。我认为这可以帮助你。 [在 C 中处理来自 recv() TCP 的部分返回](https://stackoverflow.com/questions/1386142/handling-partial-return-from-recv-tcp-in-c)

# jquery - jquery.validate .valid() 只标记前两个规则

> ID：10250669
> 
> 赞同：0
> 
> 时间：2012-04-20T17:18:41.373
> 
> 标签：jquery, jquery-plugins

除 IE9 以外的大多数主流浏览器：

[http://jsfiddle.net/tdoherty/nxB39/](http://jsfiddle.net/tdoherty/nxB39/)

如果我通过 .valid() 调用中的代码单步执行，所有四个必填字段都会被标记，但如果我让它实时运行，它只会显示前两个。

转载于 Firefox 11.0、Chrome 18.0.1025.162 m、Safari 5.1.5、Opera 11.62

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T16:40:43.643

这是由于 highlight() 调用中的 .focus() 调用反过来触发 onfocusin 回调以取消突出显示() 元素。

# java - 无法从 HTML 中的另一个目录加载 Java 小程序

> ID：10250671
> 
> 赞同：0
> 
> 时间：2012-04-20T17:18:49.727
> 
> 标签：java, html, applet, directory

当我尝试加载一个小程序时：

```
<object type="application/x-java-applet" height="300" width="550">
  <param name="code" value="Sokoban" />
</object> 
```

当 html 文件与 applet 位于同一目录中时，它会按预期加载。

但是当小程序位于另一个目录中时，以下代码将不起作用：

```
<object type="application/x-java-applet" height="300" width="550">
  <param name="code" value="sokoban/Sokoban" />
</object> 
```

（sokoban是小程序所在的目录，Sokoban是小程序=> Sokoban.class）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:38:12.193

1.  用于`deployJava.js`部署小程序（从小[程序信息页面](https://stackoverflow.com/tags/applet/info)链接）。
2.  使用`codebase`属性指向`sokoban`目录。
3.  由于`code`属性需要是完全限定的类名，所以将其返回到 just`Sokoban`

# php - 使用 .htacces 将 .ics 文件作为 .php 文件运行

> ID：10250673
> 
> 赞同：2
> 
> 时间：2012-04-20T17:18:53.410
> 
> 标签：php, .htaccess

我很想使用 .htaccess 将 .ics 文件作为 .php 文件运行，这样我就可以使用 PHP 代码创建日历，然后它会被 iPhone 等设备或 Microsoft Outlook 等程序识别，因为它是文件扩展名是.ics。我一直无法让它工作，所以来这里看看是否有人可以提供帮助。

.htacces 代码：
AddHandler application/x-httpd-php5 .ics

我不确定这是否是 .htaccess 或 PHP 代码中的错误，所以如果我需要发布 PHP 代码，请告诉我。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:21:15.237

如果您尝试访问 .ics 文件，然后在记事本或其他任何工具中打开内容，您还能看到标签吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T17:22:18.553

像这样

```
AddHandler application/x-httpd-php5s .ics 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T17:21:39.523

你需要这样的东西：

```
AddType application/x-httpd-php .ics
AddHandler x-httpd-php5 .ics

<FilesMatch "\.(ics|php)$">
SetHandler application/x-httpd-php
</FilesMatch> 
```

我不知道它是否是多余的，但我过去曾成功地为`.htm`文件使用过类似的东西。

# php - 实时图形浏览器mmo游戏，语言选项？

> ID：10250678
> 
> 赞同：0
> 
> 时间：2012-04-20T17:19:11.103
> 
> 标签：php, jquery, flash, browser

我遇到了一些关于这个的旧话题，但由于有很多用于创建网络内容的新技术，我不得不再次询问。

**我的背景：** 我对 xhtml/css/javascript/php/mysql 有很好的了解。我从头开始建立一个网上商店没有任何问题，包括一个综合数据库和一个 cms 来轻松添加/修改产品。我很喜欢使用 PHP 和 mysql 来存储数据。部落战争克隆的尝试根本不会吓到我。我还用 c#/xna 制作了几款游戏，但我仍然认为自己是新手。我涉足了闪光灯，觉得这可能可以用来获得我想要的结果。

**我的项目：** 2D mmo 战术射击游戏。玩家应该能够在相当大的地图上移动并很快获得其他用户的位置更新。游戏将包含很多地图，大多数地图应该只能处理几个玩家。然而，中心地图和感兴趣的地图应该能够无延迟地处理至少 100 名玩家。

如果战斗可以在地图上实时解决，那就太棒了，但我已经想到了其他方法来解决这个问题，比如打开一个玩家可以进入加入战斗的实例地图。我也在考虑在战斗中采用更具战术性的回合制方法，但这取决于实时战斗的优缺点。

**总结一下：** 我确信我可以管理除图形实现之外的所有内容。Mysql 在几毫秒内查询本地玩家位置应该不会有太大问题。

我发现了一款​​名为 Deeppolis 的游戏，它在图形上非常类似于我想要的。我仍在考虑将其作为可下载的客户端，但我很感兴趣如果我要基于浏览器进行操作，我的选择是什么，因为基于浏览器的游戏往往会吸引更多人。

感谢您阅读这堵文字墙：D。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:46:30.047

如果这是实时的，你不会想要“查询 mysql”来获取玩家位置。您将需要创建一个所有客户端都连接到的套接字服务器。套接字服务器会将所有已连接客户端的订阅者列表保存在内存中。这样，当一个客户端向套接字服务器发送消息时，套接字服务器可以立即将所需的数据推送给需要它的任何客户端。您还希望将游戏状态模型保存在套接字服务器的内存中，以防止作弊等。您只会使用数据库进行长期存储，其他所有内容都应该在内存中。还要记住，共享服务器可能不允许您访问套接字来创建套接字服务器，因此您将需要一个私有服务器。

客户端：javascript & [socket.io](http://socket.io/)（套接字客户端）

服务器端：javascript & [node.js](http://nodejs.org/)（套接字服务器）

# javascript - html5画布中基于路径的动画

> ID：10250681
> 
> 赞同：-1
> 
> 时间：2012-04-20T17:19:47.503
> 
> 标签：javascript, html5-canvas, html5-animation

如何使用 [paper.js](http://paperjs.org/) EG 贝塞尔曲线制作基于路径的动画。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T18:16:57.260

我正在创建一个项目，该项目将允许您绘制画布路径，然后为沿路径绘制的任何其他内容设置动画，然后导出代码以在您自己的项目中使用。路径是通过连接三次贝塞尔曲线构建的。第一个版本可在[http://canvimation.github.com/](http://canvimation.github.com/) 获得，源代码在[https://github.com/canvimation/canvimation.github.com](https://github.com/canvimation/canvimation.github.com)和帮助文件在[https://sites.google.com/site /canvimationhelp/](https://sites.google.com/site/canvimationhelp/)。

我正在重写代码以使其更易于理解和健壮（第一阶段分支），但还没有重写动画部分。如果任何代码对您有用，那么欢迎您。可能有用的文件是 alongpath.js 和 buildmenu.js

# django - 如何在 virtualenv 中为 Celery (django-celery) 编写 Ubuntu Upstart 作业

> ID：10250682
> 
> 赞同：15
> 
> 时间：2012-04-20T17:20:12.887
> 
> 标签：django, ubuntu, celery, django-celery, upstart

我真的很喜欢使用暴发户。我目前有新贵的工作来在许多 virtualenvs 中运行不同的 gunicorn 实例。但是，我在互联网上为 Celery upstart 脚本找到的 2-3 个示例对我不起作用。

因此，使用以下变量，我将如何编写一个 Upstart 作业以在 virtualenv 中运行 django-celery。

Django项目的路径：

```
/srv/projects/django_project 
```

该项目的 virtualenv 的路径：

```
/srv/environments/django_project 
```

celery 设置的路径是 Django 项目设置文件（django-celery）：

```
/srv/projects/django_project/settings.py 
```

此 Celery 实例的日志文件的路径：

```
/srv/logs/celery.log 
```

对于这个虚拟环境，用户：

```
iamtheuser 
```

和小组：

```
www-data 
```

我想用 celerybeat 运行 Celery Daemon，所以，我想传递给 django-admin.py（或 manage.py）的命令是：

```
python manage.py celeryd -B 
```

如果脚本在 gunicorn 作业开始后启动，并在 gunicorn 作业停止时停止，那就更好了。假设该文件是：

```
/etc/init/gunicorn.conf 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-20T17:51:10.433

您可能需要添加更多配置，但这是我为在 virtualenv 中以特定用户身份启动 django-celery 编写的一个新贵脚本：

```
start on started mysql
stop on stopping mysql

exec su -s /bin/sh -c 'exec "$0" "$@"' user -- /home/user/project/venv/bin/python /home/user/project/django_project/manage.py celeryd

respawn 
```

这对我很有效。

我知道它看起来很难看，但它似乎是当前作为非特权用户运行新贵作业的“正确”技术，基于[这个超级用户的回答](https://superuser.com/a/234541)。

我认为我必须做更多工作才能让它在 virtualenv 中工作，但是在 virtualenv 中调用 python 二进制文件就足够了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-03-05T08:46:00.003

这是我使用在 Ubuntu 16.04 LTS 上运行的较新 systemd 的工作配置。芹菜在一个虚拟环境中。应用程序是 Python/Flask。

系统文件：`/etc/systemd/system/celery.service`

您需要更改用户和路径。

```
[Unit]
Description=Celery Service
After=network.target

[Service]
Type=forking
User=nick
Group=nick
EnvironmentFile=-/home/nick/myapp/server_configs/celery_env.conf
WorkingDirectory=/home/nick/myapp
ExecStart=/bin/sh -c '${CELERY_BIN} multi start ${CELERYD_NODES} \
  -A ${CELERY_APP} --pidfile=${CELERYD_PID_FILE} \
  --logfile=${CELERYD_LOG_FILE} --loglevel=${CELERYD_LOG_LEVEL} ${CELERYD_OPTS}'
ExecStop=/bin/sh -c '${CELERY_BIN} multi stopwait ${CELERYD_NODES} \
  --pidfile=${CELERYD_PID_FILE}'
ExecReload=/bin/sh -c '${CELERY_BIN} multi restart ${CELERYD_NODES} \
  -A ${CELERY_APP} --pidfile=${CELERYD_PID_FILE} \
  --logfile=${CELERYD_LOG_FILE} --loglevel=${CELERYD_LOG_LEVEL} ${CELERYD_OPTS}'

[Install]
WantedBy=multi-user.target 
```

环境文件（上面引用）：`/home/nick/myapp/server_configs/celery_env.conf`

```
# Name of nodes to start
# here we have a single node
CELERYD_NODES="w1"
# or we could have three nodes:
#CELERYD_NODES="w1 w2 w3"

# Absolute or relative path to the 'celery' command:
CELERY_BIN="/home/nick/myapp/venv/bin/celery"

# App instance to use
CELERY_APP="myapp.tasks"

# How to call manage.py
CELERYD_MULTI="multi"

# Extra command-line arguments to the worker
CELERYD_OPTS="--time-limit=300 --concurrency=8"

# - %n will be replaced with the first part of the nodename.
# - %I will be replaced with the current child process index
#   and is important when using the prefork pool to avoid race conditions.
CELERYD_PID_FILE="/var/run/celery/%n.pid"
CELERYD_LOG_FILE="/var/log/celery/%n%I.log"
CELERYD_LOG_LEVEL="INFO" 
```

要为您的用户自动创建具有正确权限的日志和运行文件夹，请在`/usr/lib/tmpfiles.d`. 我`/var/run/celery`在重新启动时删除了文件夹，然后 celery 无法正常启动。

我的`/usr/lib/tmpfiles.d/celery.conf`文件：

```
d /var/log/celery 2775 nick nick -
d /var/run/celery 2775 nick nick - 
```

启用：`sudo systemctl enable celery.service`

现在您需要重新启动系统才能创建`/var/log/celery`和文件夹。`/var/run/celery`您可以通过检查登录来检查 celery 是否在重新启动后启动`/var/log/celery`。

要重新启动 celery：`sudo systemctl restart celery.service` 调试：`tail -f /var/log/syslog`并尝试重新启动 celery 以查看错误是什么。它可能与后端或其他事物有关。

希望这可以帮助！

# shell - 这个 cronjob 是做什么的？

> ID：10250685
> 
> 赞同：0
> 
> 时间：2012-04-20T17:20:26.800
> 
> 标签：shell, ssh, cron

我对 cron 有某种学习块，无论我读什么，我都无法理解它。我向我的虚拟主机寻求帮助，以创建一个每两个小时运行一次 python 脚本的 cron 作业。

这是他发回的：

```
0 */2 * * * python /path/to/file.py >> /dev/null 2>&1 
```

我知道第一部分是说每个小时都可以被 2 整除，第二部分是使用 python 执行我的文件，其余的，我真的不知道。

支持人员给我回了一封电子邮件说

> 这意味着 stdout 和 stderr 将无处重定向，以使您清除乱码消息和命令输出（如果有）（在 cron 中有用且常见）。
> 
> 要测试脚本功能，请使用相同的脚本而不进行重定向。

这是有道理的，因为我记得`>>`在命令提示符中被用来将输出写入文件。我仍然没有得到两件事。首先，`2>&1`做什么？其次，通过重定向，他是在谈论将输出发送到`/dev/null`吗？如果它没有去那里，并且我确实想确认它正在工作，它会去哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T17:23:42.520

2 表示`stderr`流，表示将其重定向到流 1 ( `stdout`) 被定向的同一位置，即`/dev/null`（有时称为“位桶”）。

如果您不希望输出转到`/dev/null`，例如，您可以将文件名放在那里，stderr 和 stdout 的输出将放在那里。

前任：

```
0 */2 * * * python /path/to/file.py >> your_filename 2>&1 
```

最后，`>>`（相对于`>`）表示追加，因此在文件名的情况下，输出将被追加而不是覆盖文件。使用`/dev/null`，这并不重要，因为无论如何你都会丢弃输出。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T17:24:36.427

`2>&1`将所有错误输出重定向到与标准输出相同的流（例如，在您的情况下为`/dev/null`= nowhere）

如果您`python /path/to/file.py`在控制台窗口中运行（例如删除以 开头的输出重定向`>>`），则输出将打印在您的控制台上（以便您可以直观地阅读）

注意：默认情况下，cron 作业的输出将作为电子邮件发送给拥有该作业的用户。出于这个原因，总是将标准和错误输出定向到`/dev/null`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T17:27:06.560

*   `>>`那里是不必要的 - /dev/null 不是真正的文件，无论您使用`>`还是`>>`
*   `2>&1`表示将 STDERR 发送到与 STDOUT 相同的位置，即 /dev/null
*   [cron 的手册页](http://unixhelp.ed.ac.uk/CGI/man-cgi?crontab+5)解释了如果你没有重定向它会做什么；通常，它会通过电子邮件向管理员发送输出。
*   如果你想检查它是否正常工作，你可以用一个实际的文件替换'/dev/null'，比如'/tmp/log'，然后检查那个文件。这就是`>>`命令中有 a 的原因：登录到真实文件时，您希望每次都追加而不是覆盖它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T17:25:28.767

将`>>`标准输出附加到`/dev/null`; 将`2>&1`文件描述符 2（标准错误）发送到文件描述符 1（标准输出）所在的位置。

附加是不寻常的，但实际上并不有害；你通常只写`>`. 如果您处理的是真实文件而不是`/dev/null`.append 可能会更好，因此这可以减少当您从`/dev/null`to`/tmp/cron/job.log`或其他更改时遇到问题的机会。

丢弃错误不一定是一个好主意，但如果命令是“健谈”，那么该输出通常会以电子邮件的形式发送给其`cron`工作的用户。

# ios - 使用 ios 5.1 的设备的设置应用程序 URL 方案的解决方法

> ID：10250686
> 
> 赞同：1
> 
> 时间：2012-04-20T17:20:31.227
> 
> 标签：ios, url, schema, preferences, ios5.1

有谁知道为使用 ios 5.1 的设备设置应用程序 URL 方案的解决方法？

例如 ：

> [UIApplication sharedApplication] openURL:[NSURL URWithString:@"prefs:root=NOTIFICATIONS_ID"]];

谢谢

# objective-c - 如何以编程方式在 iOS 中添加 UITabBarItem 的 Identifier 类型？

> ID：10250688
> 
> 赞同：1
> 
> 时间：2012-04-20T17:20:40.930
> 
> 标签：objective-c, ios

我想在 iOS 中以编程方式添加 UITabBarItem。

在界面生成器中，我们可以轻松地选择搜索标识符、收藏夹、最近标签等。

我想知道如何以编程方式添加这些标识符类型？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T17:26:11.310

您将它添加为 UIViewController 的属性？你创建一个`UITabBarItem`

`UITabBarItem *localTabBarItem = [[UITabBarItem alloc]                     initWithTitle:@"Date" image:clockIcon tag:0];`

然后设置 UIViewController 的属性

```
[viewController setTabBarItem:localTabBarItem]; 
```

这是一大包 TabBar 图像[http://www.axis.com/objects/ip_icon_09.shtml](http://www.axialis.com/objects/ip_icon_09.shtml)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-20T17:42:15.747

```
UITabBarItem *barItem = [[UITabBarItem] alloc] initWithTabBarSystemItem:UITabBarSystemItemMore tag:0];
self.tabBarItem = [barItem autorelease]; //of not using ARC 
```

预定义的系统栏项目是：

```
UITabBarSystemItemMore,
UITabBarSystemItemFavorites,
UITabBarSystemItemFeatured,
UITabBarSystemItemTopRated,
UITabBarSystemItemRecents,
UITabBarSystemItemContacts,
UITabBarSystemItemHistory,
UITabBarSystemItemBookmarks,
UITabBarSystemItemSearch,
UITabBarSystemItemDownloads,
UITabBarSystemItemMostRecent,
UITabBarSystemItemMostViewed 
```

# delphi - 如何在 delphi 中为 azure blob 存储生成 MD5？

> ID：10250689
> 
> 赞同：2
> 
> 时间：2012-04-20T17:20:49.990
> 
> 标签：delphi, md5, delphi-xe2, azure-storage

我尝试为要上传到 azure 的文件设置 MD5 哈希。我收到此错误：

> (400, 'HTTP/1.1 400 请求中指定的 MD5 值无效。MD5 值必须为 128 位和 base64 编码。', $7230400)

这就是我为文件执行 md5 的方式：

```
function MD5(const fileName : string) : string;
var
 idmd5 : TIdHashMessageDigest5;
 fs : TFileStream;
begin
 idmd5 := TIdHashMessageDigest5.Create;
 fs := TFileStream.Create(fileName, fmOpenRead OR fmShareDenyWrite) ;
 try
   result := idmd5.HashStreamAsHex(fs) ;
 finally
   fs.Free;
   idmd5.Free;
 end;
end;

......

Headers.Values['Content-MD5'] :=  MD5(LocalFile); 
```

现在，如何根据 delphi xe2 上的 azure 规范执行此操作？

PD：这个答案[如何解决从 Windows Azure Blob 存储服务返回的 InvalidMd5 错误？](https://stackoverflow.com/questions/4089225/how-to-resolve-an-invalidmd5-error-returned-from-the-windows-azure-blob-storage)为.NET解决它：

```
MD5 md5 = new MD5CryptoServiceProvider();
byte[] blockHash = md5.ComputeHash(buff);
string convertedHash = Convert.ToBase64String(blockHash, 0, 16); 
```

但不知道如何翻译到delphi ..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T01:33:38.607

您应该注意 XE2 中的 Azure 代码中的错误（此链接还显示了如何创建和格式化 MD5 哈希值）：

[使用 PutBlock 的 EIPHTTPProtocolExceptionPeer 异常，字节数组全部设置为零](https://stackoverflow.com/questions/9307637/eiphttpprotocolexceptionpeer-exception-using-putblock-with-array-of-bytes-all-se)

编辑：

相关代码：

```
Hasher:=TIdHashMessageDigest5.Create;
MD5:=Data.Cloud.CloudAPI.EncodeBytes64(Hasher.HashBytes(Content));
Hasher.Free; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T21:07:13.443

我不知道 delphi XE2 的 HashStreamAsHex() 函数，但在较旧的 Delphi 版本中，您分两步完成： . [http://delphi.about.com/od/objectpascalide/a/delphi-md5-hash.htm](http://delphi.about.com/od/objectpascalide/a/delphi-md5-hash.htm)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-21T03:59:52.013

我根本不了解 Delphi，但错误消息说您的 MD5 哈希应该是 base64 编码，但看起来您使用的是十六进制编码。

# jquery - 结合jQuery Mosaic与CSS3 box-shadow页面卷曲效果

> ID：10250703
> 
> 赞同：0
> 
> 时间：2012-04-20T17:21:54.563
> 
> 标签：jquery, css, gallery, mosaic

我想结合这两种效果

jQuery Mosaic > [http://buildinternet.com/project/mosaic/](http://buildinternet.com/project/mosaic/) 和Pure CSS3 box-shadow 页面卷曲效果 > [http://matthamm.com/box-shadow-curl.html](http://matthamm.com/box-shadow-curl.html)

有人可以给我一个例子吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T00:12:27.433

这很简单。我只是将“Mosaic Div”（包含马赛克瓷砖的 Div）放在`li`我的卷发盒阴影中`ul`。很直接。

```
<ul class="box">
    <li>
        <div class="mosaic-block circle">
            <a href="http://buildinternet.com/project/mosaic" class="mosaic-overlay">&nbsp;</a>
            <div class="mosaic-backdrop"><img src="http://buildinternet.s3.amazonaws.com/projects/mosaic/mosaic.jpg"/></div>
        </div>
    </li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
</ul> 
```

# php - PHP XML 添加元素

> ID：10250704
> 
> 赞同：0
> 
> 时间：2012-04-20T17:22:15.187
> 
> 标签：php, xml, add

我试图用不同的代码来做，但总是失败。

这是我的 XML：

```
<movies>
  <movie>
    <title>Pav1</title>
    <plot>tekstas1</plot>
    </movie>
  <movie>
    <title>Pav2</title>
    <plot>tekstas2</plot>
  </movie>
</movies> 
```

这是我正在使用的代码：

```
<?php
  $xml = simplexml_load_file ( 'movies.xml' );
  $movies = $xml->addChild("movie");
  $movies->addChild("title", "title1");
  $movies->addChild("plot", "plot1");

  $xml->saveXML();
?> 
```

不幸的是，午餐后什么都没有发生。谢谢，任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T17:46:09.397

您没有在最后一条语句中包含原始文件名。这应该解决它：

```
$xml->saveXML( 'movies.xml' ); 
```

# php - 如何按顶部有个人资料图片的用户进行排序？

> ID：10250706
> 
> 赞同：1
> 
> 时间：2012-04-20T17:22:20.843
> 
> 标签：php, mysql, sorting, sql-order-by, image

所以我现在正在为我们的开发人员填写（请注意我是初学者），但我试图简单地按包含个人资料图片的个人资料对我的搜索结果进行排序（即，我不想要空白的个人资料图片显示在结果的顶部......它们都应该在结果的末尾）......请注意，有几种用户类型，这就是为什么有这么多代码......

我很确定我要去哪里错是两条线......

ORDER BY $order u.picture ISNULL DESC"; （与按个人资料图片排序有关）。非常感谢任何和所有帮助...谢谢！

代码如下：

```
if ($user_type == 1) {
        $sql = "SELECT a.*, u.*,
                (SELECT COUNT(DISTINCT userId) FROM LF_usertype_A WHERE usertype_BId = u.userId AND status = 1) as i_cnt,
                (SELECT COUNT(productId) FROM LF_products WHERE userId = u.userId AND status = 1) as product_cnt,
                (SELECT COUNT(transactionId)
                    FROM LF_Transactions
                    WHERE usertypeBId = u.userId
                        AND (status = 1 OR status = 2)
                        AND type = 9
                        AND userId != usertypeBId
                        AND userId != usertypeAId) AS cnt
                FROM LF_Users u
                JOIN LF_products a ON a.userId = u.userId
                LEFT JOIN LF_Transactions t ON t.productId = a.productId
                WHERE a.status = 1
                    AND u.status = 1
                    AND u.userType = :ut $where
                GROUP BY u.userID
                ORDER BY $order u.name DESC LIMIT 200";
    } elseif ($filter != "recent" && $user_type == 2) {
        $sql = "SELECT u.*,
                (SELECT COUNT(a.productId) FROM LF_usertypeA a INNER JOIN LF_products ON a.productId = m.productId INNER JOIN LF_Users uu ON uu.userId = a.usertypeAId WHERE a.userId = u.userId AND uu.status = 1 AND a.status = 1 AND m.status = 1) as product_cnt,
                (SELECT COUNT(transactionId)
                    FROM LF_Transactions
                    WHERE usertypeBId = u.userId
                        AND (status = 1 OR status = 2)
                        AND type = 9
                        AND userId != usertypeAId
                        AND userId != usertypeBId) AS cnt
                FROM LF_Users u
                LEFT JOIN LF_Transactions t ON t.usertypeBId = u.userId
                WHERE u.status = 1
                    AND u.userId != 1
                    AND u.userType = :ut $where
                GROUP BY u.userID
                ORDER BY $order u.name DESC LIMIT 200
                ORDER BY $order u.picture ISNULL DESC";
    } else {
        $sql = "SELECT u.*,
                (SELECT COUNT(a.productId) FROM LF_usertype_A a INNER JOIN LF_products m ON a.productId = m.productId INNER JOIN LF_Users uu ON uu.userId = a.usertypeAId WHERE a.userId = u.userId AND uu.status = 1 AND a.status = 1 AND m.status = 1) as product_cnt,
                (SELECT COUNT(transactionId)
                    FROM LF_Transactions
                    WHERE usertypeBId = u.userId
                        AND (status = 1 OR status = 2)
                        AND type = 9
                        AND userId != usertypeAId
                        AND userId != usertypeBId) AS cnt
                FROM LF_Users u
                WHERE u.status = 1
                AND u.userId != 1
                AND u.userType = :ut $where
                GROUP BY u.userID
                ORDER BY $order u.name DESC LIMIT 200
        ORDER BY $order u.picture ISNULL DESC";
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:28:20.033

`isnull`如果您希望条件优先，则必须将条件放在常规排序顺序之前：

```
ORDER BY ISNULL(u.picture), $order 
```

# algorithm - 网页更新检测算法

> ID：10250709
> 
> 赞同：2
> 
> 时间：2012-04-20T17:22:27.830
> 
> 标签：algorithm, diff, web-crawler

首先，我不是在寻找代码，只是简单地讨论关于主题所说的方法。

我最近想知道检测（尽可能快）网站页面更改的最佳方法是什么偶尔？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:42:40.393

除非他们有 RSS 提要（您仍然需要拉取它们以查看它们是否已更改），否则实际上没有办法找出站点何时更改，除非访问并检查。但是，您可以做一些聪明的事情来提高效率。在您查看该网站一段时间后，您可以建立一个预测模型，了解它们何时倾向于更新。例如：该新闻站点每 2-3 小时更新一次，但该博客每周仅发布一篇文章。这可以为您节省许多检查，因为大多数页面实际上并不经常更新。谷歌这样做是为了帮助拉动它。一种适用于此的简单算法（取决于您需要新闻的前沿程度）是我自己的基于二进制搜索的设计：

```
Start each site off with a time interval ~ 1 day
Visit the sites when that time hits and check changes
if something has changed
    halve the time for that site
else
    double the time for that site
If after many iterations you find it hovering around 2-3 numbers 
    fix the time on the greater of the numbers 
```

现在这是一个简单的算法，用于查找适合检查的时间，但如果您在实际发布更新时解析文本并查看模式，您可能会做一些更有效的事情。

# css - 当第一个 Div 宽度未知时，一种将 2 个 Div 并排放置的方法？

> ID：10250710
> 
> 赞同：0
> 
> 时间：2012-04-20T17:22:31.437
> 
> 标签：css, html

这是我在这个论坛上的第一篇文章。我以前用这个论坛的语气来寻求帮助，它总是非常有帮助和有用的。直截了当的帮助。

我的问题是我希望 2 个 div 直接相邻放置。我正在为社区舞蹈团制作博客页面。通过利用 CSS 中的 float:left 属性，我让 div 彼此相邻。我在 StackOverflow 上找到了该解决方案，谢谢！！

但我不知道 Div 1 的宽度，因为我希望它位于页面中间。

我的 CSS 代码：

```
.contentsWrapper{
margin-left:100px;
margin-right:100px;
margin-bottom:10px;
overflow:auto;
}
.blogWrapper{
float:left;
}
.archievesWrapper{
width:250px;
float:right;
} 
```

任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T17:24:27.560

你可以试试

```
display: inline-block 
```

在你的两个 div 上。这应该让他们彼此相邻。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T17:26:31.893

可能这就是你想要的。像这样写：

**HTML**

```
<div class="right">right</div>
<div class="left">left</div> 
```

**CSS**

```
.left{
    background:red;
    overflow:hidden;
    height:30px;
}
.right{
    float:right;
    background:green;
    height:30px;
    width:250px;
} 
```

检查这个[http://jsfiddle.net/6EufF/1/](http://jsfiddle.net/6EufF/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T17:28:42.747

您要搜索的是“流体布局”。

有不同的方法可以做到这一点。这种问题已经在不同的网站上多次解决。

这是一个可以帮助您的链接，但您可以找到很多很多。

[http://www.vanseodesign.com/css/fluid-layout-code/](http://www.vanseodesign.com/css/fluid-layout-code/)

# java - Jersey Logging 过滤器吃掉了 POST 的 UserPrincipal

> ID：10250719
> 
> 赞同：0
> 
> 时间：2012-04-20T17:23:12.813
> 
> 标签：java, tomcat, jersey

我为 Jersey 创建了一个 LoggingFilter，并在 web.xml 中正确配置了它。一切正常。当我执行“GET”时，我得到了 userPrincipal (request.getUserPrincipal())，但对于 POST，它返回 null。我已经在 Websphere 上用 java 1.4 编写了几个 REST 服务，并且总是可以访问 userPrincipal，但是在 Tomcat/1.6 上我得到了上述内容。我正在使用基本身份验证。泽西岛是这样做的吗？还是雄猫？

```
<security-constraint>
    <web-resource-collection>
        <web-resource-name>Lookup Resources</web-resource-name>
        <description>A set of secured resources.</description>
        <url-pattern>/rest/lookup/*</url-pattern>
        <http-method>GET</http-method>
    </web-resource-collection>
    <auth-constraint>
        <role-name>DataServ_Lookup</role-name>
        <role-name>DataServ_Admin</role-name>
    </auth-constraint>
    <!-- Comment this out for Dev.  It is a MUST for Prod... 
    <user-data-constraint>
        <transport-guarantee>CONFIDENTIAL</transport-guarantee>
    </user-data-constraint>-->

</security-constraint> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T20:08:32.730

为什么要创建自己的 LoggingFilter？你知道泽西岛包括一个开箱即用的吗？您的过滤器是否以任何方式修改请求？尝试将 HttpServletRequest 注入您的资源并获取主体形式 - 看看它是否已设置。如果没有，请查看您的请求是否确实包含基本身份验证标头。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-23T13:19:29.843

感谢 dma_k 让我陷入自己的疯狂。正如您在上面看到的，POST 没有安全限制！

我需要补充：`<http-method>POST</http-method>`。嗬！

# xcode - 可可拖放代表没有按我期望的方式工作

> ID：10250721
> 
> 赞同：1
> 
> 时间：2012-04-20T17:23:28.190
> 
> 标签：xcode, cocoa, drag-and-drop

我创建了一个非常简单的类，它继承了 NSTextField 的子类，因此我可以更好地控制拖放行为，但我遇到了困惑。根据我认为我在 apple.developer 文档中关于拖动目的地的理解，当我进入或退出文本字段的边界时，我应该能够让代表触发，但我得到的是代表不直到我将某些内容放入 textField 中然后我尝试将其拖出时才会触发。

我有一个 MyController 类，它是一个 NSObject，我有一个 NSTextField 类型的 CustomFields 类；控制器类中没有任何内容。

这是代码：

```
//  CustomFields.h
//  Drags
//

#import <AppKit/AppKit.h>
#import <Foundation/foundation.h>

@interface CustomFields : NSTextField{

    NSString *tempStorage_;
    unsigned long last_;
}
@property(readwrite, retain) NSString *tempStorage;

@end

//
//  CustomFields.m
//  Drags
//

#import "CustomFields.h"

@implementation CustomFields

@synthesize tempStorage = tempStorage_;

- (id)init{

    if (self) {

        self = [super init];

    }

    return self;
}

-(void)dealloc{

    [self.tempStorage release ];
    [super release];
}

-(void)awakeFromNib{

    NSLog(@"Awake from nib called");

    self.tempStorage = @"";
    self->last_ = 0;
    [self setBackgroundColor:[NSColor lightGrayColor]];
    [self registerForDraggedTypes:[NSArray arrayWithObjects: NSPasteboardTypeString ,   NSPasteboardTypeString, nil]];

    [super awakeFromNib];

 }

- (NSDragOperation)draggingEntered:(id <NSDraggingInfo>)sender
{

    NSLog(@"Inside dragging entered");

        return NSDragOperationCopy;
}

- (NSDragOperation)draggingUpdated:(id <NSDraggingInfo>)sender
{
    NSLog(@" draggingUpdated called");
    return NSDragOperationCopy;
}

- (void)draggingExited:(id <NSDraggingInfo>)sender
{

    NSLog(@"Inside dragging exited");

}

@end

//
//  MyController.h
//  Drags
//

#import <Foundation/Foundation.h>

@class CustomFields;

@interface MyController : NSObject{

    IBOutlet NSButton *myButton_;

    IBOutlet CustomFields *field1_;
    IBOutlet CustomFields *field2_;

}

@end

//
//  MyController.m
//  Drags
//

#import "MyController.h"
#import "CustomFields.h"

@implementation MyController

@end 
```

我确保我为 IB 中的字段（CustomFields）分配了正确的类并将它们连接起来。如您所见，目前我很乐意在适当的时间获取日志语句。我还尝试将 MyController 类更改为 NSViewController 和 NSView ，以便我可以在那里尝试 registerForDraggedTypes 。那没有任何帮助，我认为我不应该期望它。我认为我想要的行为应该仅限于 CustomFields 类，这是 MyController 类暂时可以为空的原因之一。

因此，非常感谢任何帮助。

# ios - iPhone - MBProgressHUD、数据控制器和 Sudzc

> ID：10250722
> 
> 赞同：1
> 
> 时间：2012-04-20T17:23:34.387
> 
> 标签：ios, uitableview, uiview, mbprogresshud

我正在为 SOAP Web 服务使用以下包装器：http: [//www.sudzc.com/](http://www.sudzc.com/) 以及用于活动指示符的以下 MBProgressHUD：[https ://github.com/jdg/MBProgressHUD](https://github.com/jdg/MBProgressHUD)

不知道如何在视图调用之前使用 MBProgressHUD。我还使用了调用 SOAP 服务的数据控制器。

这是我的代码。

产品数据控制器.h

```
#import <Foundation/Foundation.h>
@class ProsoftProducto;

@interface ProductoDataController : NSObject

@property (nonatomic, copy) NSMutableArray *listaProductos;

- (NSUInteger)countOfListaProductos;
- (ProsoftProducto *)objectInListaProductosAtIndex:(NSUInteger)index;
- (void) agregarProductoWithNombre:(NSString *)pnombre 
                      descripcion:(NSString *)pdescripcion
                              url:(NSString *)purl;

@end 
```

产品数据控制器.m

```
#import "ProductoDataController.h"
#import "ProsoftProducto.h"

#import "ProsoftWS_PuenteAplicacionesMobiles.h"

@interface ProductoDataController()
- (void)inicializarDefaultLista;
@end

@implementation ProductoDataController

@synthesize listaProductos = _listaProductos;

- (void)inicializarDefaultLista
{
    ProsoftWS_PuenteAplicacionesMobiles* service = [ProsoftWS_PuenteAplicacionesMobiles service];
    service.logging = YES;
    // service.username = @"username";
    // service.password = @"password";

    // Returns NSMutableArray*. 
    [service listaProductosActivos:self action:@selector(listaProductosActivosHandler:) detail: [NSMutableArray array]];
}

// Handle the response from listaProductosActivos.

- (void) listaProductosActivosHandler: (id) value {

    // Handle errors
    if([value isKindOfClass:[NSError class]]) {
        NSLog(@"%@", value);
        return;
    }

    // Handle faults
    if([value isKindOfClass:[SoapFault class]]) {
        NSLog(@"%@", value);
        return;
    }               

    // Do something with the NSMutableArray* result
    self.listaProductos = (NSMutableArray*)value;
    //NSLog(@"----- * LISTA PRODUCTOS ACTIVOS * -----");
}

- (void)setListaProductos:(NSMutableArray *)lista
{
    if(_listaProductos != lista)
        _listaProductos = [lista mutableCopy];
}

- (id)init 
{
    if(self = [super init])
    {
        [self inicializarDefaultLista];
        return self;
    }
    return nil;
}

- (NSUInteger)countOfListaProductos
{
    return [self.listaProductos count];
}

- (ProsoftProducto *)objectInListaProductosAtIndex:(NSUInteger)index
{
    return [self.listaProductos objectAtIndex:index];
}

- (void) agregarProductoWithNombre:(NSString *)pnombre descripcion:(NSString *)pdescripcion
                               url:(NSString *)purl
{
    ProsoftProducto *producto;
    producto = [[ProsoftProducto alloc]initWithNombre:pnombre 
                                   descripcion:pdescripcion 
                                           url:purl];
    [self.listaProductos addObject:producto];
}

@end 
```

ProductoViewController.h

```
#import <UIKit/UIKit.h>
@class ProductoDataController;
@class MBProgressHUD;

@interface ProductoViewController : UITableViewController{
    MBProgressHUD *HUD;
    NSMutableArray *_objects;
}

@property (nonatomic, strong) ProductoDataController *dataControllerProductos;

@end 
```

ProductoViewController.m

```
#import "ProductoViewController.h"
#import "ProductoDetalleViewController.h"
#import "ProductoDataController.h"
#import "ProsoftProducto.h"
/*
@interface ProductoViewController ()
    NSMutableArray *_objects;
@end
*/
@implementation ProductoViewController

@synthesize dataControllerProductos = _dataControllerProductos;

- (id)initWithStyle:(UITableViewStyle)style
{
    self = [super initWithStyle:style];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
}

- (void)viewDidUnload
{
    [super viewDidUnload];
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

#pragma mark - Segue
-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([segue.identifier isEqualToString:@"PushProductoDetalle"]) {
        ProductoDetalleViewController *detalleProductoViewController = [segue destinationViewController];
        detalleProductoViewController.producto = [self.dataControllerProductos objectInListaProductosAtIndex:[self.tableView indexPathForSelectedRow].row];
    }
}

#pragma mark - Table view data source

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return [self.dataControllerProductos countOfListaProductos];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"ProductoCell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    ProsoftProducto *producto = [self.dataControllerProductos objectInListaProductosAtIndex:indexPath.row];
    cell.textLabel.text = producto.nombre;
    return cell;
}

// Override to support conditional editing of the table view.
- (BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Return NO if you do not want the specified item to be editable.
    return NO;
}

#pragma mark - Table view delegate

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Navigation logic may go here. Create and push another view controller.
    /*
     <#DetailViewController#> *detailViewController = [[<#DetailViewController#> alloc] initWithNibName:@"<#Nib name#>" bundle:nil];
     // ...
     // Pass the selected object to the new view controller.
     [self.navigationController pushViewController:detailViewController animated:YES];
     */
}

@end 
```

ProductoDetelleViewController.h

```
#import <UIKit/UIKit.h>
@class ProsoftProducto;

@interface ProductoDetalleViewController : UIViewController

@property (strong, nonatomic) ProsoftProducto *producto;
@property (strong, nonatomic) IBOutlet UIScrollView *scrollView;
@property (weak, nonatomic) IBOutlet UILabel *lblTitulo;
@property (weak, nonatomic) IBOutlet UILabel *lblDescripcion;
@property (weak, nonatomic) IBOutlet UIImageView *imgUrl;

@end 
```

ProductoDetelleViewController.m

```
#import "ProductoDetalleViewController.h"
#import "ProsoftProducto.h"

@interface ProductoDetalleViewController ()

@end

@implementation ProductoDetalleViewController

@synthesize producto = _producto;
@synthesize scrollView = _scrollView;
@synthesize lblTitulo = _lblTitulo;
@synthesize lblDescripcion = _lblDescripcion;
@synthesize imgUrl = _imgUrl;

- (void)setProducto:(ProsoftProducto *)pproducto
{
    if(_producto != pproducto)
    {
        _producto = pproducto;
        [self configurarView];
    }
}

- (void)configurarView
{
    ProsoftProducto *objProducto = self.producto;

    if(objProducto) 
    {
        self.lblTitulo.text = objProducto.nombre;
        self.lblDescripcion.text = objProducto.descripcion;

        CGSize maximumLabelSize = CGSizeMake(310,9999);
        CGSize expectedLabelSize = [objProducto.descripcion sizeWithFont:_lblDescripcion.font 
                                                      constrainedToSize:maximumLabelSize 
                                                          lineBreakMode:_lblDescripcion.lineBreakMode]; 
        CGRect newFrame = _lblDescripcion.frame;
        newFrame.size.height = expectedLabelSize.height;
        _lblDescripcion.frame = newFrame;

        if(objProducto.urlImagen.length > 0){
            self.imgUrl.image = [UIImage imageNamed:@"ic_offline.png"];
            NSURL *url = [NSURL URLWithString:objProducto.urlImagen];
            UIImage *image = [UIImage imageWithData:[NSData dataWithContentsOfURL:url]];
            self.imgUrl.image = image;
        } else {
            _lblDescripcion.frame = CGRectMake(5, 40, 310, expectedLabelSize.height);
        }
    }
}

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [self configurarView];
    NSUInteger height = 0;
    CGSize maximumLabelSize = CGSizeMake(310,9999);
    CGSize expectedLabelSize = [_producto.descripcion sizeWithFont:_lblDescripcion.font 
                                                constrainedToSize:maximumLabelSize 
                                                    lineBreakMode:_lblDescripcion.lineBreakMode];

    if(_producto.urlImagen.length > 0)
        height = expectedLabelSize.height + 260;
    else
        height = expectedLabelSize.height + 40;

    _scrollView.frame = (CGRect){_scrollView.frame.origin, CGSizeMake(320, 420)};
    _scrollView.contentSize = CGSizeMake(320, height);
    _scrollView.backgroundColor = [UIColor whiteColor]; 
    [super viewDidLoad];
}

- (void)viewDidUnload
{
    self.producto = nil;
    [super viewDidUnload];
}

@end 
```

我的应用程序代表的代码

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{   
    UITabBarController *tabBarController = (UITabBarController *)self.window.rootViewController;
    UINavigationController *navigatorController = [[tabBarController viewControllers] objectAtIndex:0];

    // Solicitar Informacion
    // Solicitar Informacion

    // Productos
    navigatorController = [[tabBarController viewControllers] objectAtIndex:1];
    ProductoViewController *productoViewController = [[navigatorController viewControllers] objectAtIndex:0];

    productoViewController.dataControllerProductos = [[ProductoDataController alloc]init];
    // Productos

    // Noticias
    navigatorController = [[tabBarController viewControllers] objectAtIndex:2];
    NoticiaViewController *noticiaViewController = [[navigatorController viewControllers] objectAtIndex:0];

    noticiaViewController.dataControllerNoticias = [[NoticiaDataController alloc]init];
    // Noticias

    // Sucursales
    navigatorController = [[tabBarController viewControllers] objectAtIndex:3];
    SucursalViewController *sucursalViewController = [[navigatorController viewControllers] objectAtIndex:0];

    sucursalViewController.dataControllerSucursal = [[SucursalDataController alloc]init];
    // Sucursales

    // Coopenae Virtual
    navigatorController = [[tabBarController viewControllers]objectAtIndex:5];
    InfoGeneralViewController *infoGeneralViewController = [[navigatorController viewControllers]objectAtIndex:0];
    infoGeneralViewController.dataControllerInfoGeneral = [[InfoGeneralDataController alloc]init];
    // Coopenae Virtual

    // InfoGeneral
    // InfoGeneral

    return YES;

} 
```

任何人都可以帮助我理解MBProgressHUD，我需要知道我是否必须调用它。谢谢

# asp.net - 强类型路由测试

> ID：10250725
> 
> 赞同：0
> 
> 时间：2012-04-20T17:23:40.083
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, unit-testing, moq

如果我正确理解[了该示例](http://mvccontrib.codeplex.com/wikipage?title=TestHelper)，则 MvcContrib TestHelper 对映射到特定控制器的路由进行了强类型测试。不利的一面是，如果我理解了这个例子，被测试的路由不是来自 global.asax 文件；相反，它来自测试设置。

相比之下，“Pro ASP.NET MVC3 Framework”一书共享了路由测试助手，它们实际上利用了 global.asax 文件中的路由。然而，这些助手对于特定控制器来说不是强类型（甚至是松散类型）：

```
 [TestMethod]  //sample from the book...
    public void TestIncomingRoutes() {     
        // check for the URL that we hope to receive     
        TestRouteMatch("~/Admin/Index", "Admin", "Index"); 
    } 
```

我想要两全其美。有没有人链接到帮助代码的链接（1）明确标识特定控制器，（2）使用 global.asax 中的路由进行测试，（3）没有与 Rhino Mocks 结婚 - 因为我更喜欢 MOQ。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T21:02:22.410

您似乎想测试您的 HttpApplication 子类（global.asax.cs 代码）以确保它调用代码来注册路由。我不确定这是否真的有必要，因为如果你不这样做，很明显没有任何效果。OTOH，MvcContrib 允许您测试您想要的 URL 是否实际映射到某些东西，如果您仔细设计您的 url 以使其对 SEO 友好，这将具有很大的价值。这是值得测试的，IMO。

# ms-access - Access 2003/VBA：按表单顺序打开参数/WHERE

> ID：10250728
> 
> 赞同：1
> 
> 时间：2012-04-20T17:24:21.427
> 
> 标签：ms-access

有一系列形式 A -> B -> C 等。

在 A 中，向用户询问参数，这些参数将作为 B 中所示的表子集的 where 条件（使用 DoCmd.OpenForm 和“Detail”方法）。

我还使用 A 中的参数在 B 中制作漂亮的标题。

问题1：如果B中没有任何命中（显示0条记录），则用于标题的参数（即B的表格内容的搜索关键字）丢失，因此出现错误。我试图通过将参数作为“开放参数”发送来解决这个问题 - 这将给出正确的标题，只有没有搜索结果（即，如果没有命中，则为正确的结果）。但是，然后，如果您从任何其他位置打开表单，例如 Access 中的表单菜单，则会出现错误。

问题 2：我想要一个“返回”按钮（A <- B、B <- C 等）。我只是先关闭，但有时我会在意想不到的地方结束。向后使用上述解决方案 - 嗯，首先，它甚至不能向前工作，其次，即使这样做了，它似乎效率很低，因为搜索的那部分已经完成。

我从我的观点和经验描述了这个问题，但不要觉得被“锁定”。如果您知道完全不同的方法，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:58:25.453

如果您将代码修改为仅在传递值时`OpenArgs`尝试使用，也许您可​​以消除该方法中的错误。`OpenArgs`

```
If Not IsNull(Me.OpenArgs) Then
    ' do something with OpenArgs
End If 
```

# android - Android 应用程序下载数据

> ID：10250733
> 
> 赞同：0
> 
> 时间：2012-04-20T17:24:34.267
> 
> 标签：android, eclipse, button, android-linearlayout

我正在开发一个将近 50mb 的大型应用程序。我想知道如何让应用程序本身像 5mb 但是当用户打开应用程序时，它会给出一个对话框来下载应用程序数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:48:18.043

看看[这篇](http://android-developers.blogspot.co.uk/2012/03/android-apps-break-50mb-barrier.html?utm_source=feedburner&utm_medium=feed&utm_campaign=Feed%3a%20blogspot/hsDu%20%28Android%20Developers%20Blog%29)博文，因为它听起来正是你想要的

# .htaccess - 从索引重定向到首页 (.htaccess)

> ID：10250740
> 
> 赞同：0
> 
> 时间：2012-04-20T17:24:58.990
> 
> 标签：.htaccess, drupal, indexing, directory

我在我的网站上安装了 Drupal。它工作得很好，但要到达首页，我会系统地重定向到一个名为“Index of”的页面，我必须单击子文件夹 drupal-7.12/ 才能到达首页。所以，我想我网站的真实网址是 [http://www.mysite.com/drupal-7.12](http://www.mysite.com/drupal-7.12)

在我的 ftp 服务器上是这样组织的：

文件夹 public_html -> 文件夹 drupal-7.12 + 一个文件 .htaccess

文件夹 drupal-7.12 内还有另一个 .htaccess 文件我知道我必须修改其中一个，但我不知道哪个以及我必须修改什么？

我希望有人能理解我的问题并可以帮助我谢谢 ML

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T17:28:01.427

我建议您删除 drupa.7.12 中的文件夹并将所有内容移至一个目录。基本上你被设置为：

Mysite/drupal7.12

将 drupal 7.12 的所有内容上移一个目录到您的 public_html 文件夹

或者您需要编辑 public_html 文件夹中的 htaccess 以将您重定向到该文件夹​​。但从长远来看，这将导致一些问题。

# javascript - jquery加载隐藏内容

> ID：10250744
> 
> 赞同：0
> 
> 时间：2012-04-20T17:25:15.057
> 
> 标签：javascript, jquery

我的网页上有 javascript，但我需要对我的用户隐藏它（我不希望他们能够看到它，因为它包含游戏的一些答案。）

所以我尝试使用 Jquery .load 来隐藏内容（我使用该调用从外部 js 文件加载内容）。但它无法加载。所以我尝试了ajax，它也失败了。

也许问题来自于我试图加载位于我的根目录中的文件，而原始页面位于“root/public_html/main/pages”中：

```
<script type="text/javascript">
$(document).ready(function() {
    $.ajax({
        url : "../../../secret_code.js",
        dataType: "text",
        success : function (data) {
            $("#ajaxcontent").html(data);
        }
    });
});
</script> 
```

1) 为什么我不能使用ajax 或load 方法从根目录加载文件？2）还有其他方法吗？

PS：我将文件放在根目录中，因此人们无法直接从浏览器访问它...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:38:05.940

你的系统设置是什么？你在使用 CMS 吗？

即使您在页面加载后将 javascript 添加到页面，使用 firebug 之类的工具的用户也可以查看它。我不认为你正在做的事情真的会保护它。另一种解决方案是您可以缩小和混淆您在生产环境中使用的 javascript。这将产生几乎不可读但功能正常的 javascript 代码。您可以通过许多工具运行代码来缩小和混淆它。这是您可以使用的一种工具：[http ://www.refresh-sf.com/yui/](http://www.refresh-sf.com/yui/)

如果这还不够，那么也许您可以将游戏的答案放在服务器端并通过 ajax 提取它们。我不知道你的设置，所以我不知道这对你是否可行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T17:27:56.933

1）如果文件不能通过网络浏览器访问，那么它不能通过 ajax 访问（ajax 是网络浏览器的一部分

2）尝试`/secret_code`而不是`../../../secret_code.js`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T17:30:02.870

尝试使用 jQuery 的 $.getScript() 方法加载外部脚本文件，但是，您可以使用 Firebug 或开发人员工具栏轻松查看脚本文件的内容！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T17:30:45.277

**安全第一**

你不能用 JavaScript 访问你的根目录，因为人们会读出你的数据库密码，ftp 密码 aso。如果可能的话。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-20T17:27:49.360

您只能加载可直接从浏览器访问的文件，例如，`http://www.mydomain.com/secret_code.js`

如果浏览器不能直接访问，浏览器也不能通过ajax访问。~~但是，您可以使用 .htaccess 来阻止用户直接打开 js 文件~~，但这并不能阻止他们在 google chrome 或 firebug 控制台中查看它。

如果您想保密，请不要让它进入浏览器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-20T17:27:53.980

导航到 URL，而不是目录。喜欢

```
$.ajax({
        url : "http://domain.com/js/secret_code.js",

.. 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-20T17:28:07.867

即使您动态加载内容，使用 firebug、fiddler 或任何类型的代理也很容易查看文件的内容。我建议你使用[混淆](http://www.javascriptobfuscator.com/)器。用户将更难找到答案

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-20T17:28:23.373

看看这个[`jQuery.getScript()`](http://api.jquery.com/jQuery.getScript/)函数，它是为通过 AJAX 加载 Javascript 文件而设计的，应该可以满足您的需要。

# android - 停止 IntentService 的正确方法

> ID：10250745
> 
> 赞同：20
> 
> 时间：2012-04-20T17:25:15.447
> 
> 标签：android, intentservice

我正在使用 IntentService 将图像上传到服务器。我的问题是我不知道如何/何时停止服务。当我在 onHandleIntent(Intent ..) 中调用 stopself() 时，所有在 IntentService 队列中等待的 Intent 都会被删除。但是我不想从活动中停止服务，因为即使我的应用程序没有运行，我也想完成上传过程。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-04-20T17:37:51.440

> 我的问题是我不知道如何/何时停止服务。

`IntentService``onHandleIntent()`如果在运行时没有向它发送更多命令，它会在结束时自动停止`onHandleIntent()`。因此，您不必`IntentService`自己手动停止。

> 当我在 onHandleIntent(Intent ..) 中调用 stopself() 时，所有在 IntentService 队列中等待的 Intent 都会被删除。

这就是为什么你不这样做。

> 但是我不想从活动中停止服务，因为即使我的应用程序没有运行，我也想完成上传过程。

然后你让`IntentService`停止本身。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-20T17:37:47.243

当`IntentService`没有更多`Intent`s（作业）要处理时，它会自行停止。它`stopSelf(startId)`为每个`Intent`（作业）运行。看看`IntentService`源代码或`Extending the Service Class`从这里[http://developer.android.com/guide/topics/fundamentals/services.html](http://developer.android.com/guide/topics/fundamentals/services.html)

# android - 验证应用关闭 ANDROID

> ID：10250746
> 
> 赞同：1
> 
> 时间：2012-04-20T17:25:16.180
> 
> 标签：android

我正在执行一个后台程序，该程序在 x 秒内从 x 运行以获取新信息。到目前为止，一切都很好。问题是当我完成应用程序线程时始终处于活动状态。

有什么方法可以检查应用程序是否已结束？

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T17:28:13.950

如果您的任务应该在活动停止显示时停止，您不应该*启动*服务，而是将其*绑定*到活动。一旦活动完成，任务将自动停止。如果多个活动应该使用该服务，请将其绑定到每个活动。

[以下是](http://developer.android.com/guide/topics/fundamentals/bound-services.html#Binding)绑定服务的方法：

```
Intent intent = new Intent(this, LocalService.class);
bindService(intent, mConnection, Context.BIND_AUTO_CREATE); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T17:28:52.273

您可以制作一个 Toast 或 AlertDialog 框以及完成活动的代码，让您知道应用程序已结束。

# c - 在绘图区绘制图像

> ID：10250748
> 
> 赞同：4
> 
> 时间：2012-04-20T17:25:27.237
> 
> 标签：c, gtk, drawing

我正在尝试在绘图区域上绘制图像，但没有运气。我看到了几个 python 示例，但我无法将它们实现到我正在使用的 c 中（例如[，将图像绘制到 gtk.DrawingArea？](https://stackoverflow.com/questions/8283788/draw-an-image-to-gtk-drawingarea)）

我已经创建了一个 Pixbuf 变量来存储我想在绘图区域上绘制的图像，但是没有像 gtk_drawing_area_draw_pixbuf 之类的函数或与之相关的东西。感谢任何建议。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-20T19:07:59.053

You need to make use of [`expose-event`](http://developer.gnome.org/gtk/stable/GtkWidget.html#GtkWidget-expose-event) callback (assuming you are working with Gtk+ 2.0) to draw the pixbuf onto drawing area. There is no `gtk_drawing_area_draw_pixbuf` instead you have [`gdk_draw_pixbuf`](http://developer.gnome.org/gdk/stable/gdk-Drawing-Primitives.html#gdk-draw-pixbuf). This has been deprecated in favour of [`gdk_cairo_set_source_pixbuf`](http://developer.gnome.org/gdk/stable/gdk-Cairo-Interaction.html#gdk-cairo-set-source-pixbuf) from version 2.22 onwards. You can call these function in your expose event callback something on these lines (please use them as reference only):
If your Gtk version is < 2.22

```
static gboolean
da_expose (GtkWidget *da, GdkEvent *event, gpointer data)
{
    (void)event; (void)data;
    GdkPixbuf *pix;
    GError *err = NULL;
    /* Create pixbuf */
    pix = gdk_pixbuf_new_from_file("/usr/share/icons/cab_view.png", &err);
    if(err)
    {
        printf("Error : %s\n", err->message);
        g_error_free(err);
        return FALSE;
    }
    GdkDrawable *draw = gtk_widget_get_window(da);
    /* Draw pixbuf */
    gdk_draw_pixbuf(draw, NULL, pix, 0, 0, 0, 0, -1, -1, GDK_RGB_DITHER_NONE, 0, 0);
    return FALSE;
} 
```

Version 2.22 onwards you will have to make use of `cairo` something on these lines:

```
static gboolean
da_expose (GtkWidget *da, GdkEvent *event, gpointer data)
{
    (void)event; (void)data;
    GdkPixbuf *pix;
    GError *err = NULL;
    /* Create pixbuf */
    pix = gdk_pixbuf_new_from_file("/usr/share/icons/cab_view.png", &err);
    if(err)
    {
        printf("Error : %s\n", err->message);
        g_error_free(err);
        return FALSE;
    }
    cairo_t *cr;
    cr = gdk_cairo_create (da->window);
    gdk_cairo_set_source_pixbuf(cr, pix, 0, 0);
    cairo_paint(cr);
    cairo_fill (cr);
    cairo_destroy (cr);
    return FALSE;
} 
```

Of course you would have connected to the callback using `g_signal_connect` (say `g_signal_connect (da, "expose-event", G_CALLBACK (da_expose), NULL);`). If you are using Gtk+ 3.0 then you will be making use of [`draw`](http://developer.gnome.org/gtk3/stable/GtkWidget.html#GtkWidget-draw) instead of `expose-event`. You can always refer to `gtk-demo`/`gtk3-demo` application which are available to see the samples along with the code. This should be available in the package repository of your distro or you can always get it from source.
Hope this helps!
PS: [This link](http://oss.org.cn/man/develop/GTK+/tutorial/x2472.html) might provide you with some pointers

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-09-24T11:03:44.247

现在 GTK 版本是 GTK+3.0。如果您使用的是 GTK+3.0，请按如下方式使用。

```
// gcc expose.c -o expose `pkg-config gtk+-3.0 --cflags --libs`
#include <gtk/gtk.h>
#include <stdlib.h>

static gboolean
on_window_draw (GtkWidget *da, GdkEvent *event, gpointer data)
{
    (void)event; (void)data;
    GdkPixbuf *pix;
    GError *err = NULL;
    /* Create pixbuf */
    pix = gdk_pixbuf_new_from_file("/usr/share/icons/cab_view.png", &err);
    if(err)
    {
        printf("Error : %s\n", err->message);
        g_error_free(err);
        return FALSE;
    }
    cairo_t *cr;
    cr = gdk_cairo_create (gtk_widget_get_window(da));
    //    cr = gdk_cairo_create (da->window);
    gdk_cairo_set_source_pixbuf(cr, pix, 0, 0);
    cairo_paint(cr);
    //    cairo_fill (cr);
    cairo_destroy (cr);
    //    return FALSE;
}

int main ( int argc, char **argv) {
    GtkWidget *window;
    GtkWidget *canvas;
    gtk_init (&argc , &argv);
    window = gtk_window_new (GTK_WINDOW_TOPLEVEL);
    gtk_widget_set_size_request (window,
        50, 50);

    g_signal_connect (window, "destroy",
        G_CALLBACK (gtk_main_quit) , NULL);
    canvas = gtk_drawing_area_new ();
    gtk_container_add (GTK_CONTAINER (window), canvas);
    g_signal_connect (canvas, "draw", (GCallback) on_window_draw, NULL);

    gtk_widget_set_app_paintable(canvas, TRUE);
    gtk_widget_show_all (window);
    gtk_main ();
    return 0;
} 
```

# c# - 是否有更高性能的方法可以从字符串中删除罕见的不需要的字符？

> ID：10250757
> 
> 赞同：0
> 
> 时间：2012-04-20T17:25:51.233
> 
> 标签：c#, arrays, string, char

**编辑**

如果原始未经编辑的问题具有误导性，我们深表歉意。

这个问题不是问如何从 a 中删除 Invalid XML Chars，`string`这个问题的答案最好指向[这里](https://stackoverflow.com/questions/20762/how-do-you-remove-invalid-hexadecimal-characters-from-an-xml-based-data-source-p/10244306#10244306)。

我不是要你检查我的代码。

我在答案中寻找的是带有签名的函数

```
string <YourName>(string input, Func<char, bool> check); 
```

这将具有与 . 相似或更好的性能`RemoveCharsBufferCopyBlackList`。理想情况下，这个函数会更通用，如果可能的话更易于阅读，但这些要求是次要的。

* * *

我最近编写了一个函数来从字符串中去除无效的 XML 字符。在我的应用程序中，字符串可能会很长，并且很少出现无效字符。这个练习让我思考。在安全托管的 c# 中可以通过哪些方式完成此操作，这将为我的场景提供最佳性能。

这是我的测试程序，我用“有效的 XML 谓词”代替了一个省略 char 的程序`'X'`。

```
class Program
{
    static void Main()
    {
        var attempts = new List<Func<string, Func<char, bool>, string>>
            {
                RemoveCharsLinqWhiteList,
                RemoveCharsFindAllWhiteList,
                RemoveCharsBufferCopyBlackList
            }

        const string GoodString = "1234567890abcdefgabcedefg";
        const string BadString = "1234567890abcdefgXabcedefg";
        const int Iterations = 100000;
        var timer = new StopWatch();

        var testSet = new List<string>(Iterations);
        for (var i = 0; i < Iterations; i++)
        {
            if (i % 1000 == 0)
            {
                testSet.Add(BadString);
            }
            else
            {
                testSet.Add(GoodString);
            }
        }

        foreach (var attempt in attempts)
        {
            //Check function works and JIT
            if (attempt.Invoke(BadString, IsNotUpperX) != GoodString)
            {
                throw new ApplicationException("Broken Function");       
            }

            if (attempt.Invoke(GoodString, IsNotUpperX) != GoodString)
            {
                throw new ApplicationException("Broken Function");       
            }

            timer.Reset();
            timer.Start();
            foreach (var t in testSet)
            {
                attempt.Invoke(t, IsNotUpperX);
            }

            timer.Stop();
            Console.WriteLine(
                "{0} iterations of function \"{1}\" performed in {2}ms",
                Iterations,
                attempt.Method,
                timer.ElapsedMilliseconds);
            Console.WriteLine();
        }

        Console.Readkey();
    }

    private static bool IsNotUpperX(char value)
    {
        return value != 'X';
    }

    private static string RemoveCharsLinqWhiteList(string input,
                                                      Func<char, bool> check);
    {
        return new string(input.Where(check).ToArray());
    }

    private static string RemoveCharsFindAllWhiteList(string input,
                                                      Func<char, bool> check);
    {
        return new string(Array.FindAll(input.ToCharArray(), check.Invoke));
    }

    private static string RemoveCharsBufferCopyBlackList(string input,
                                                      Func<char, bool> check);
    {
        char[] inputArray = null;
        char[] outputBuffer = null;

        var blackCount = 0;
        var lastb = -1;
        var whitePos = 0;

        for (var b = 0; b , input.Length; b++)
        {
            if (!check.invoke(input[b]))
            {
                var whites = b - lastb - 1;
                if (whites > 0)
                {
                    if (outputBuffer == null)
                    {
                        outputBuffer = new char[input.Length - blackCount];
                    }

                    if (inputArray == null)
                    {
                        inputArray = input.ToCharArray();
                    }

                    Buffer.BlockCopy(
                                      inputArray,
                                      (lastb + 1) * 2,
                                      outputBuffer,
                                      whitePos * 2,
                                      whites * 2);
                    whitePos += whites; 
                }

                lastb = b;
                blackCount++;
            }
        }

        if (blackCount == 0)
        {
            return input;
        }

        var remaining = inputArray.Length - 1 - lastb;
        if (remaining > 0)
        {
            Buffer.BlockCopy(
                              inputArray,
                              (lastb + 1) * 2,
                              outputBuffer,
                              whitePos * 2,
                              remaining * 2);

        }

        return new string(outputBuffer, 0, inputArray.Length - blackCount);
    }        
} 
```

如果您运行这些尝试，您会注意到随着功能变得更加专业化，性能会提高。是否有更快、更通用的方法来执行此操作？或者，如果没有通用选项，是否有更快的方法？

请注意，我实际上对删除“X”并不感兴趣，实际上谓词更复杂。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T17:37:53.230

如果您需要高性能，您当然不想使用 LINQ to Objects 又名枚举器来执行此操作。另外，不要为每个字符调用一个委托。与您正在执行的实际操作相比，委托调用的成本很高。

RemoveCharsBufferCopyBlackList 看起来不错（每个字符的委托调用除外）。

我建议您内联硬编码的委托内容。尝试不同的方式来编写条件。您可以通过首先检查当前字符与一系列已知的良好字符（例如 0x20-0xFF），如果匹配则让它通过，您可以获得更好的性能。该测试几乎总是会通过，因此您可以节省对 XML 中无效的单个字符的昂贵检查。

编辑：我只记得我不久前解决了这个问题：

```
 static readonly string invalidXmlChars =
        Enumerable.Range(0, 0x20)
        .Where(i => !(i == '\u000A' || i == '\u000D' || i == '\u0009'))
        .Select(i => (char)i)
        .ConcatToString()
        + "\uFFFE\uFFFF";
    public static string RemoveInvalidXmlChars(string str)
    {
        return RemoveInvalidXmlChars(str, false);
    }
    internal static string RemoveInvalidXmlChars(string str, bool forceRemoveSurrogates)
    {
        if (str == null) throw new ArgumentNullException("str");
        if (!ContainsInvalidXmlChars(str, forceRemoveSurrogates))
            return str;

        str = str.RemoveCharset(invalidXmlChars);
        if (forceRemoveSurrogates)
        {
            for (int i = 0; i < str.Length; i++)
            {
                if (IsSurrogate(str[i]))
                {
                    str = str.Where(c => !IsSurrogate(c)).ConcatToString();
                    break;
                }
            }
        }

        return str;
    }
    static bool IsSurrogate(char c)
    {
        return c >= 0xD800 && c < 0xE000;
    }
    internal static bool ContainsInvalidXmlChars(string str)
    {
        return ContainsInvalidXmlChars(str, false);
    }
    public static bool ContainsInvalidXmlChars(string str, bool forceRemoveSurrogates)
    {
        if (str == null) throw new ArgumentNullException("str");
        for (int i = 0; i < str.Length; i++)
        {
            if (str[i] < 0x20 && !(str[i] == '\u000A' || str[i] == '\u000D' || str[i] == '\u0009'))
                return true;
            if (str[i] >= 0xD800)
            {
                if (forceRemoveSurrogates && str[i] < 0xE000)
                    return true;
                if ((str[i] == '\uFFFE' || str[i] == '\uFFFF'))
                    return true;
            }
        }
        return false;
    } 
```

Notice, that RemoveInvalidXmlChars first invokes ContainsInvalidXmlChars to save the string allocation. Most strings do not contain invalid XML chars so we can be optimistic.

# osc - int32s 在 OSC 中是有符号的还是无符号的（或者它是未指定的？）

> ID：10250758
> 
> 赞同：1
> 
> 时间：2012-04-20T17:26:01.147
> 
> 标签：osc

[OSC 规范 1.0 版](http://opensoundcontrol.org/spec-1_0)将“int32”数据类型指定为“32 位大端二进制补码整数”。这意味着它已签名（否则，您为什么要写“二进制补码”......），但它并没有直接说出来。

这在 blob 的编码中最为明显：拥有长度为 #x90000000 的 blob 是否合法？此数字可以编码为无符号 32 位整数，但不能编码为有符号 32 位整数。我承认，这是一个非常大的 blob（超过 2 GB）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T06:49:39.753

该规范没有为您提供更多详细信息。我检查了我使用的 C++ osc 实现的代码，它被定义为：

```
typedef signed long int32; 
```

blob 定义为：

```
struct Blob{
    Blob() {}
    explicit Blob( const void* data_, unsigned long size_ )
            : data( data_ ), size( size_ ) {}
    const void* data;
    unsigned long size;
}; 
```

所以是的，它是“原子”int32 类型的有符号整数。

另一方面，blob 的大小存储为 unsigned long。所以可能它可以更大。你可能要先尝试一下，因为我这里只有osc pack的实现。

# python - Python OOP 初始化参数错误

> ID：10250759
> 
> 赞同：1
> 
> 时间：2012-04-20T17:26:03.217
> 
> 标签：python, oop, initialization

所以这是我的代码：

```
class Board:
    def __init__ (self, boardLength, boardHeight, pieces):
        self.__boardLength = boardLength
        self.__boardHeight = boardHeight
        self.__pieces = pieces
        self.__snapShots = []
        self.__tiles = []
        while len(self.__tiles) < (self.__boardHeight*self.__boardLength):
            self.__tiles.append(0)

board1 = Board(5, 4,
    [u,I_shape(1,'I'),X_shape(3,5,'U'),T_shape(4,5,'U'),L_shape(3,5,'U')]
) 
```

我明白了：

```
TypeError: __init__() takes exactly 4 arguments (3 given) 
```

我知道 init 需要 4 个论点，但其中一个是 self ，而我给了它另外三个。谁能告诉我我做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T17:30:01.333

我想你的问题实际上是`I_shape`，因为你的其他形状都需要 3 个参数。我运行了它，它运行良好，将不存在的类替换为`None`.

此外，值得注意的是，`__variable`在 99.9% 的情况下都不需要使用名称修饰 ( )。如果要指示它是私有的，请使用单个下划线。

# visual-studio-2010 - 如何在 Visual C++ 中的另一个字符串中搜索一个字符串？

> ID：10250760
> 
> 赞同：0
> 
> 时间：2012-04-20T17:26:05.257
> 
> 标签：visual-studio-2010, c++-cli

我想需要找到一个字符串，用另一个字符串替换该字符串。

例如，将以下字符串中的 'apple' 替换为 'orange'。

“我爱苹果”

我应该使用什么功能？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T18:07:05.207

由于这个问题被标记为 C++/CLI，我假设您指的是托管[String](http://msdn.microsoft.com/en-us/library/system.string.aspx)对象。

如果是这样，那么您可以使用 String 类的[Replace方法。](http://msdn.microsoft.com/en-us/library/fk49wtc1.aspx)

```
String^ orig = "I love apple";
String^ modified = orig->Replace("apple", "orange"); 
```

# c - 使用 gcc 的大数组声明及其问题

> ID：10250766
> 
> 赞同：0
> 
> 时间：2012-04-20T17:26:45.280
> 
> 标签：c, memory-management

我正在编写一个代码，它需要**分配一个大的“int”数组（大小为 10^9**）。在这样做的同时，我遇到了几个问题，在谷歌上阅读了一些东西后，我得出了自己的结论。有人可以看到这一点并指出我是否遗漏了一些东西，并建议一种更好的方法来做到这一点。

*（机器配置：VM 机器 Ubuntu 10.4，gcc 4.4.3，32bit，2GB ram（虽然我的主机是 6gigs）*

1.我将数组声明为**'unsigned long int'，大小为1 * 10 ^ 9。**它在编译代码时不起作用，我收到错误*“数组大小太长”*。所以我搜索了这个，最后意识到我不能在堆栈上分配那么多内存，因为我的**物理内存是 2 GB。**（*我已经尝试将数组分配为全局变量，这会将它们分配在全局区域而不是堆栈中，但同样的错误*）

1.  *因此，我尝试使用“malloc”分配相同数量的内存，但这次“无法分配内存”再次出现“malloc”错误*。

**因此，在完成所有这些之后，我的理解/问题如下：**

3-我无法分配那么多内存，无论是堆栈还是堆，因为我的物理内存只有 2Gb *（所以这是实际问题或其他一些因素也控制着这个内存分配？？）*

4-是否有任何可能的解决方法，我可以在 2gig 机器上分配大小为 10^9 的内存（我知道分配这么大的数组或内存区域既不是好的算法设计也不是有效的，但我只想知道限制。）

5-分配这么多内存的任何更好的解决方案（我的意思是我应该使用 2 个小数组/堆内存而不是一个大块） **（注意：第 4 点和第 5 点是两种不同的方法，我希望对这两种方法提出建议）**

非常感谢PS如果我是新手请原谅我..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T17:31:46.210

您正在编译一个 32 位进程，并且根本没有足够的物理地址空间用于您的巨大数据块。一个 32 位指针可以保存 2^32 个不同的值，即 4GB。您不能分配更多，因为您无法引用内存。映射到您的进程的每个内存字节都必须具有唯一的地址。

因此，没有任何东西可以将您的数据放入 4GB 的地址空间。即使您的阵列小于 4GB，您也可能在分配单个连续内存块时遇到问题。

您可以使用 64 位进程，但您需要确保有足够的物理内存以避免在交换阵列时发生磁盘抖动。或者您可以找到一种不需要如此巨大内存块的不同算法。

# java - 在 JTable 之前和之后附加用于打印的文本

> ID：10250772
> 
> 赞同：6
> 
> 时间：2012-04-20T17:27:09.440
> 
> 标签：java, swing, printing, jtable, graphics2d

我正在尝试打印 a`JTable`并且该`print()`方法效果很好，直到我遇到这种情况。假设我想在第一页（不是标题）之前打印文本“报告”，最后打印文本“这是报告的结尾”。我想再次澄清一下，当我打印它们时，我不需要页眉或页脚，仅此文本出现在第一页的顶部和最后一页的底部。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T18:26:56.357

做到这一点的一种方法是将`append()`一系列合适的`Printable`实例添加到 a中，如此[处](http://www.java2s.com/Tutorial/Java/0261__2D-Graphics/PrintBook.htm)[`java.awt.print.Book`](http://docs.oracle.com/javase/6/docs/api/java/awt/print/Book.html)所示。

附录：`JTable`有一个[`getPrintable()`](http://docs.oracle.com/javase/6/docs/api/javax/swing/JTable.html#getPrintable%28javax.swing.JTable.PrintMode,%20java.text.MessageFormat,%20java.text.MessageFormat%29)可以简化事情的方法；这是一个大纲和简单的标题`Printable`：

```
PrinterJob pj = PrinterJob.getPrinterJob();
Book book = new Book();
book.append(new Title(), pj.defaultPage());
book.append(table.getPrintable(...), pj.defaultPage());
book.append(new EndPage(), pj.defaultPage());
pj.setPageable(book);
pj.print();
...
private static class Title implements Printable {

    Font font = new Font("SansSerif", Font.PLAIN, 48);

    @Override
    public int print(Graphics g, PageFormat pf, int pageIndex)
        throws PrinterException {
        Graphics2D g2d = (Graphics2D) g;
        g2d.translate(pf.getImageableX(), pf.getImageableY());
        g2d.setFont(font);
        g2d.setColor(Color.black);
        g2d.drawString("Report", 50, 200);
        return Printable.PAGE_EXISTS;
    }
} 
```

# html - 何时使用 CSS 类，何时不使用？

> ID：10250783
> 
> 赞同：1
> 
> 时间：2012-04-20T17:27:58.143
> 
> 标签：html, css

什么时候应该向元素添加类并使用类选择器设置它们的样式，什么时候应该在父元素上添加类/id 并按原样使用元素？

例子：

```
<div class="warning-dialog">
    <h3>This is the title</h3>
    <p>This is the message</p>
</div>

.warning-dialog {}
.warning-dialog h3 {}
.warning-dialog p {} 
```

对比

```
<div class="warning-dialog">
    <h3 class="warning-title">This is the title</h3>
    <p class="warning-message">This is the message</p>
</div>

.warning-dialog {}
.warning-title {}
.warning-message {} 
```

或者你应该这样做

```
.warning-dialog .warning-dialog {}
.warning-dialog .warning-title {}
.warning-dialog .warning-message {} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-20T17:38:39.893

问自己这个简单的问题：

> `<x>`这个共同祖先下的所有元素是否意味着相同的事情？

如果答案是肯定的，那么您不需要在这些元素上使用类名。以您的代码为例，以下内容就足够了：

```
<div class="warning-dialog">
    <h3>This is the title</h3>
    <p>This is the message</p>
</div> 
```

因为在 a 内部`.warning-dialog`，所有`h3`元素 (1) 和所有`p`元素 (1) 的含义相同，即对话框的标题和内容！这意味着，您不需要在它们上有任何特定的类名，并且可以通过`.warning-dialog h3`or轻松访问它们`.warning-dialog p`。

但是，如果上述问题的答案是“否”，那就完全不同了：

```
<div>Warning</div>
<div>Info</div>
<div>Error</div> 
```

您不能（轻松）用 CSS 指定每个 div，**它们的含义并不相同**，因此您需要使用类名来使其更好！

```
<div class="warning-dialog">Warning</div>
<div class="info-dialog">Info</div>
<div class="error-dialog">Error</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T17:33:48.100

这取决于您想要/需要您的样式有多灵活。将 CSS 附加到父标签意味着父标签下的所有相似标签都将具有相同的样式。如果其中一些应该/可能不同，您将需要一种专门设置它们的方法。

```
<div class="foo">
    <div>stuff</div>
    <div>other stuff</div>
</div> 
```

在这种情况下，“stuff”和“other stuff”必须具有相同的风格（除非我们开始使用`nth-child`and stuff）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T18:00:11.237

从技术上讲，对于这两个示例，您都可以使用 out 类。实际上只有父容器会有所作为。例如....

**如果你要在一个页面上有多个错误容器，你可以做这样的事情。**

```
<div class="warning-dialog">
    <h3>This is the title</h3>
    <p>This is the message</p>
</div>

.warning-dialog {
/*css for container*/
}

.warning-dialog h3 {
/*css for all h3 tags in that container*/
}

.warning-dialog p {
/*css for all p tags in that container */
} 
```

**如果您只打算在页面上使用该容器一次，您可以这样做。**

```
<div id="warning-dialog">
        <h3>This is the title</h3>
        <p>This is the message</p>
    </div>

    #warning-dialog {
    /*css for container*/
    }

    #warning-dialog h3 {
    /*css for all h3 tags in that container*/
    }

    #warning-dialog p {
    /*css for all p tags in that container */
    } 
```

**而且，如果您要使用相同的容器，但在其中一个容器中设置不同的标题标签样式，那么您可能希望在 p 标签上使用一个类..例如...**

```
<div class="warning-dialog">
        <h3 class="option2">This is the title</h3>
        <p>This is the message</p>
    </div>

    .warning-dialog {
    /*css for container*/
    }

    .warning-dialog h3 {
    /*css for all h3 tags in that container*/
    }

    .warning-dialog p {
    /*css for all p tags in that container */
    }

    .warning-dialog .option2 {
    /*css for option 2*/
    } 
```

**然而，这可能并不总是最实用的方法，因为您将在这些之间遇到冲突的 CSS……并且必须使用！important。**

```
.warning-dialog p {
    /*css for all p tags in that container */
    }

    .warning-dialog .option2 {
    /*css for option 2*/
    } 
```

因此，最好为父元素使用不同的 ID。IE(errormsg1 和 errormsg2) ...

但实际上这一切都取决于您项目的背景。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T17:30:23.323

基本概念是，

1.  要样式化的独特元素，使用`id`
2.  要设置样式的相似元素的集合，使用`class`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-20T17:34:16.040

这主要是个人喜好问题。我更喜欢让我的 HTML 尽可能干净，所以我更喜欢这个

```
.warning-dialog {}
.warning-dialog h3 {}
.warning-dialog p {} 
```

此外，如果一个元素需要通过 JavaScript 访问，使用 id 而不是类更容易/更快，但您必须确保在页面中只使用该元素一次。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-20T17:59:31.613

  这取决于您的口味和个人喜好；但是，正如一些人所指出的，如果所有子标签（特定类型，例如 div）都需要相同的样式，则不需要为它们创建类；只需使用标签名称。如果一些需要相同的样式，而另一些不需要，则将类应用于需要（或不需要）它的类，并相应地设置样式。
  如果您觉得内容在不久的将来可能会发生变化，并且新内容需要不同的样式，您可以在创建新标签时将类添加到新标签中。
   关键是没有明确的标准方法，每个人都可以告诉你什么对他们有用。

# curl - cURL 请求通过 HTTPS 超时 - 由于防火墙？

> ID：10250787
> 
> 赞同：0
> 
> 时间：2012-04-20T17:28:02.713
> 
> 标签：curl, amazon-ec2, timeout

我在 Amazon EC2 上运行脚本并尝试向 CloudFront 发出 cURL 请求，这需要 SSL。

超时：操作在 25000 毫秒后超时，收到 552 个字节中的 107 个

该请求确实“起作用”，因为分发已更新等，但响应尚未完全形成，因此我无法使用响应数据。

我的安全组中打开了以下 TCP 端口：

*   20
*   80
*   442
*   10000

任何想法为什么会发生这种情况？该脚本本身可以在其他服务器上完美运行。openssl 已启用，ssl 也已启用。

我已经在使用：

```
curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, false); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T14:28:48.920

虽然这不是最好的答案，但这就是我修复它的方法。

我将我的代码（来自此处的库：[http](http://undesigned.org.za/2007/10/22/amazon-s3-php-class) ://undesign.org.za/2007/10/22/amazon-s3-php-class）移植到官方 AWS SDK。这需要进行相当多的更改，但是，它得到了结果。

# google-maps - 我需要在 Google Places API 中防止重复吗？

> ID：10250790
> 
> 赞同：0
> 
> 时间：2012-04-20T17:28:14.310
> 
> 标签：google-maps, google-places-api

我经营着一个本地商业社区网站，我认为为我网站上的每个企业自动创建一个谷歌位置会很棒。实际的企业主在我的网站上，所以他们的信息是准确的。

我可以看到在 google places API 中，我可以轻松地创建 google places，但是如果他们已经有了呢？为他们自动创建地点是否会是垃圾邮件，或者谷歌是否有一种算法可以接受所有结果并自行排序？

我认为谷歌允许我基本上为他们创建一个我拥有的规范数据库，然后他们可以用它做他们想做的事，这将是明智的。这是它的工作原理还是我需要手动询问我的客户是否已经有谷歌位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T18:15:06.293

Google Places API 并不是向 Google 获取有关营业地点的数据的最佳方式。目前，添加功能不允许您添加您想要添加的所有信息，包括营业时间等。您可以改用[Google Places for Business](http://www.google.com/placesforbusiness)。

为了回答您的主要问题，Google 会通过 Places API 或 Google Places for Business 添加结果并对其进行重复数据删除，但这将有助于 Google 和数据准确性首先搜索一个地点，查看是否匹配以及是否不匹配不要添加它。

# mysql - 通过导致内存不足错误的列表在检票口表中加载数百万个数据库行

> ID：10250794
> 
> 赞同：0
> 
> 时间：2012-04-20T17:28:24.070
> 
> 标签：mysql, query-optimization, wicket, large-data-volumes, large-data

我正在通过 sortabledataprovider 加载数百万行数据。当我将查询发送到启用 Wicket ajax 的表和启用分页的表时，该查询返回一个列表（Arraylist）。所以问题是 - 如果有并发查询 - 应用程序可能会崩溃。我已经收到 Java 堆空间错误，DB 中只有 100,000 行。 **所以我想要实现的是——当用户点击下一页或者可能是第 10 页时——它只会从数据库中加载第 10 页的数据——而不是整个查询中可能有数百万行。**

这是我通过查询加载列表的方式

```
 final SyslogProvider<SyslogParsed> sysLogProviderAjax = new SyslogProvider<SyslogParsed>(new ArrayList<SyslogParsed>());

     *
     *
           daoList = syslogParsedDao.findByDatesAndHostName(utcStartDate, utcEndDate, null);
        sysLogProviderAjax.setList(daoList); 
```

# **

数据库查询返回所有行的大列表

```
 public List<logParsed> findByDatesAndHostName() {
    return getJpaTemplate().execute(new JpaCallback<List<SyslogParsed>>() {

            return query.getResultList();
        }
    });
} 
```

========= 我的数据提供者

```
 public class logProvider<logParsed> extends SortableDataProvider{

/**
 * 
 */
private static final long serialVersionUID = 1L;
@SpringBean(name="logParsedDao")
private logParsedDao logParsedDao;

class SortableDataProviderComparator implements Comparator<logParsed>, Serializable {

    public int compare(logParsed log1, logParsed log2) {
        PropertyModel<Comparable> model1 = new PropertyModel<Comparable>(log1, getSort().getProperty());
        PropertyModel<Comparable> model2 = new PropertyModel<Comparable>(log1, getSort().getProperty());

        int result = model1.getObject().compareTo(model2.getObject());

        if (!getSort().isAscending()) {
            result = -result;
        }

        return result;
    }

}

private List<logParsed> list =  new ArrayList<logParsed>();
private SortableDataProviderComparator comparator = new SortableDataProviderComparator();

public logProvider(List<logParsed> sentModel){

    setSort("numberOfEntries",SortOrder.DESCENDING);
    list = sentModel;
}

public Iterator<logParsed> iterator(int first, int count) {

    //ArrayList<logParsed> newList = (ArrayList<logParsed>) logParsedDao.findAll();
    //Collections.sort(newList, comparator);
    Iterator<logParsed> iterator = null;

    try {
        if(getSort() != null) {
            Collections.sort(list, new Comparator<logParsed>() {
                private static final long serialVersionUID = 1L;

                    public int compare(logParsed sl1, logParsed sl2) {
                     int result=1;
                        PropertyModel<Comparable> model1= new PropertyModel<Comparable>(sl1, getSort().getProperty());
                        PropertyModel<Comparable> model2= new PropertyModel<Comparable>(sl2, getSort().getProperty());

                        if(model1.getObject() == null && model2.getObject() == null) 
                            result = 0;
                        else if(model1.getObject() == null) 
                            result = 1;
                        else if(model2.getObject() == null) 
                            result = -1;
                        else 
                            result = model1.getObject().compareTo(model2.getObject());

                        result = getSort().isAscending() ? result : -result;

                        return result;
                }
            });
        }

        if (list.size() > (first+count))
            iterator = list.subList(first, first+count).iterator();
        else
            iterator = list.iterator();
    } 
    catch (Exception e) {
        e.printStackTrace();
    }

    return iterator;

}

public int size() {
    // TODO Auto-generated method stub
    return list.size();
}

public IModel<logParsed> model(final Object object) {
    return new AbstractReadOnlyModel<logParsed>() {
        @Override
        public logParsed getObject() {
            return (logParsed) object;
        }
    };
}

 public void setList(List<logParsed> newList){

     list = newList;
    } 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T18:55:12.840

问题`query.list()`是它一次返回*所有*行。
而不是`query.list()`你可以使用：

*   [`query.scroll()`](http://docs.jboss.org/hibernate/orm/3.6/javadocs/org/hibernate/Query.html#scroll%28%29)，它将查询结果返回为[`ScrollableResults`](http://docs.jboss.org/hibernate/orm/3.6/javadocs/org/hibernate/ScrollableResults.html)
*   [`query.iterate()`](http://docs.jboss.org/hibernate/orm/3.6/javadocs/org/hibernate/Query.html#iterate%28%29)，它将查询结果作为[`Iterator`](http://docs.oracle.com/javase/6/docs/api/java/util/Iterator.html)

这两个选项一次返回一行，这是您需要的。

请注意，查询在处理期间保持“执行”状态，因此您可能会发现表被锁定等，具体取决于您选择的隔离级别。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T18:38:40.787

您必须使用 JPA 查询来排序并在每次调用`iterator(int first, int count)`您的行时只返回所需的行`IDataProvider`。

与此类似的东西：

```
public Iterator<logParsed> iterator(int first, int count) {

    Query query = entityManager.createQuery("from LogParsed m ORDER BY m.numberOfEntries DESC", LogParsed.class);
    List<LogParsed> output = query.setFirstResult(first).setMaxResults(count).getResultList(); 

    return output.iterator();
} 
```

看看[这个问题](https://stackoverflow.com/questions/5067619/jpa-what-is-the-proper-pattern-for-iterating-over-large-result-sets)。

# java - 关于单例设计模式

> ID：10250799
> 
> 赞同：4
> 
> 时间：2012-04-20T17:28:43.260
> 
> 标签：java, design-patterns, singleton

我正在探索单例设计模式，我开发了一个类......

```
public class SingletonObject {
  private static SingletonObject ref;       
  private SingletonObject () { //private constructor
  }     
  public static synchronized SingletonObject getSingletonObject() {
    if (ref == null)
      ref = new SingletonObject();
    return ref;
  } 

  public Object clone() throws CloneNotSupportedException {
    throw new CloneNotSupportedException ();
  }
} 
```

但是同步非常昂贵，所以我转向热切创建实例的新设计，而不是懒惰创建的实例。

```
public class Singleton {
  private static Singleton uniqueInstance = new Singleton();
  private Singleton() {
  }
  public static Singleton getInstance() {
    return uniqueInstance;
  }
} 
```

但是请告诉我第二种设计比以前的设计有什么优势..!!

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T17:40:33.510

Josh Bloch 建议使用枚举：

```
 public enum Foo {
       INSTANCE;
   } 
```

有关解释，请参阅他在 Google I/O 2008 上的[Effective Java Reloaded](https://sites.google.com/site/io/effective-java-reloaded)演讲。

总之：

> “这种方法在功能上等同于公共字段方法，只是它更简洁，免费提供序列化机制，并且即使面对复杂的序列化或反射攻击，也能提供防止多次实例化的铁定保证。虽然这种方法已经尚未被广泛采用，单元素枚举类型是实现单例的最佳方式。”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T17:36:44.793

正如您所说，第二种解决方案避免了同步成本。它也更简单、更干净，因此更易于阅读和维护。不过它有一个小问题：你错过了 的`final`限定符`private static Singleton uniqueInstance`，这意味着它可能无法保证在并发环境中是线程安全的（尽管在这个具体的情况下，我认为这不会在现实生活中造成任何明显的问题。 ..但最好在线程安全方面保持安全）。幸运的是，这很容易解决。

它的另一个缺点是，一旦`Singleton`引用了类，就会创建单例对象，即使它从未实际使用过。如果创建成本很高，这可能是一个问题。可以使用[*Initialization-on-demand Holder*习惯用法](http://en.wikipedia.org/wiki/Initialization-on-demand_holder_idiom)来避免这种情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T17:35:32.693

您的第二个设计更好，因为它更简洁且更易于阅读。此外，正如您所提到的，它避免了每次您希望使用单例时进行同步的成本。

第二种设计的一个缺点是，即使您从不使用它，也会产生实例化单例的内存和 CPU 成本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-20T17:40:36.333

**急切实例化与延迟初始化**

您的第二个设计使用急切实例化而不是延迟初始化。这不一定是更好或更坏，这取决于哪个适合您的应用程序。

一般来说，如果出现以下情况，最好使用延迟初始化：

*   如果您的应用程序有可能不需要创建您的类的实例
*   如果实例化你的类很昂贵，你宁愿把操作推迟到尽可能晚

**线程安全和性能**

第二个设计的另一个优点是它的性能更高。在多线程环境中，您的第一个设计将要求每个线程在获取实例之前获取锁，即使它已经被实例化。您可以通过使用[双重检查锁定](http://en.wikipedia.org/wiki/Double-checked_locking)或[Bill Pugh 方法来解决](http://en.wikipedia.org/wiki/Singleton_pattern#The_solution_of_Bill_Pugh)此问题。

**枚举方式**

与您的两种设计不同的方法是[Enum 方式](http://en.wikipedia.org/wiki/Singleton_pattern#The_Enum_way)，它使用具有单个值的 Enum。由于枚举可以具有方法和成员变量，因此您可以模仿普通类的行为。这是一种创建单例的好方法，它是由 Joshua Bloch 推荐的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-20T17:38:02.000

您还应该使变量指向您的单例`final`。

```
public class Singleton {
    private static final Singleton uniqueInstance = new Singleton();
    private Singleton() {}
    public static Singleton getInstance() {
        return uniqueInstance;
    }
} 
```

这个实现让 ClassLoader 实例化单例的实例，提供线程安全。另一种模式使用`enum`，但我个人认为该实现是代码异味。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-07-07T10:59:44.573

几点注意事项：

1.  您的第一个示例在多线程场景中无法按预期工作。您的 ref 应该是`volatile`可变的，并且需要使用锁定进行仔细检查。

2.  您的第二个示例没有额外`synchronization`费用。但是你可以`Lazy Singleton`有效地实现而不是急切的 Singleton。

有关详细信息，请参阅以下 SE 问题：

[为什么在这个双重检查锁定示例中使用 volatile](https://stackoverflow.com/questions/7855700/why-is-volatile-used-in-this-example-of-double-checked-locking/36099644#36099644)

# extjs - 在 Sencha Touch 2 中从 Ext.Container 添加/删除项目的推荐方法？

> ID：10250802
> 
> 赞同：4
> 
> 时间：2012-04-20T17:29:00.107
> 
> 标签：extjs, sencha-touch, sencha-touch-2

我正在优化我的应用程序。最初，它是一个，`Ext.TabPanel`但我决定只使用一个`Ext.TabBar`停靠在底部并更改上面的视图，因此它需要从我的 main 中进行大量添加/删除操作`Ext.Container`。

所以我的问题是：我应该以什么方式`Ext.Container`有效地添加/删除项目？我的意思是：快，不会导致内存泄漏，也不会导致像这样的错误：首先添加的带有按钮的视图，所有处理程序（通过控制器定义`refs`）运行`control`良好，但第二次（即它被删除并稍后再次添加），所有处理程序都死了。

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T17:34:41.143

您必须确保您销毁的面板被销毁，否则它将坐在 dom 中。

通常，要从容器中删除组件，您可以使用 Container remove() 函数，该函数将第一个参数作为要删除的项目，第二个参数是一个布尔值，指示它是否被销毁。您应该确保将其设置为 true 以确保您的 DOM 尽可能精简。除非您打算在不久的将来重用该组件并且不想再次渲染它，否则您不需要销毁它。

[http://docs.sencha.com/touch/2-0/#!/api/Ext.Container-method-remove](http://docs.sencha.com/touch/2-0/#!/api/Ext.Container-method-remove)

# css - 当项目出现在其顶部时，Chrome 渐变会改变颜色

> ID：10250803
> 
> 赞同：4
> 
> 时间：2012-04-20T17:29:03.200
> 
> 标签：css, google-chrome, xpath, overlay, gradient

您可以在以下位置查看有问题的代码：[https ://test.fuzebox.com](https://test.fuzebox.com)

问候！今天早上我遇到了一个我以前从未见过的问题。我们的全球导航中有一组下拉菜单。当您将鼠标悬停在它们上时，它们会“落在”大蓝色条上。在 Chrome (Win/Mac) 中，下拉菜单会在蓝色渐变条的颜色上留下“印象”。如果您删除渐变并仅使用纯色背景色，则不会出现此问题。我尝试用 z-indexes 将一些东西“推回”无济于事。我的谷歌搜索没有发现这类问题。下面是之前和之后的图像。

游戏中的 DIV 是：

*   `#fuze-home-blue-bar`
*   `#fuze-home-blue-bar-bkgnd`

导航下拉 XPath 是：

`/html/body[@class='template-document_view portaltype-document site-FuzeBox section-technology icons-on content-id-mobile']/div[@id='wrapper']/div[@id='fuzeportal-top']/div[@id='fuzeportal-header']/ul[@id='portal-globalnav']/li[@id='portaltab-technology']/ul[@class='submenu']/li[1]`

# 前

![前](../Images/1d6558388565203b3439548f59922934.png)

# 后

![后](../Images/e9a3f069f5e61a588e5a33c586878cf4.png)

任何建议表示赞赏。不会出现在任何其他浏览器/操作系统组合中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T17:49:07.823

有时 Chrome 的硬件加速会稍微改变颜色。试试这个修复......这很神奇。

```
#fuze-home-blue-bar {
   -webkit-transform: translateZ(0);
} 
```

# javascript - 有没有办法将 2 个或更多邮政编码边界添加在一起以形成区域？

> ID：10250805
> 
> 赞同：0
> 
> 时间：2012-04-20T17:29:17.977
> 
> 标签：javascript, google-maps, geolocation, geocoding

我想在谷歌地图上创建一个遵循邮政编码边界的地区地图，但我的一些地区包含多个邮政编码。我想知道是否有办法通过列出谷歌预先映射的邮政编码边界来做到这一点（希望谷歌有一个邮政编码边界列表可以从中提取？）我想在每个组中组合。

例如：

```
Territory A:
    84000,
    84001,
    84002,
    etc. 
```

然后有，

```
Territory B:
    84108,
    84101,
    84115,
    etc. 
```

等等覆盖整个美国。

任何提示或建议都会很棒。我希望使用预定义的边界，以便更容易更新，并且将自动考虑全国范围内的任何邮政编码更改。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T18:11:54.847

Google 的邮政编码边界不能通过 API 或下载或任何其他机制获得。这只是 maps.google.com 的一项功能。为此，您必须自己获取数据。有很多公司这样做，只需搜索邮政编码边界下载。美国人口普查提供了一个叫做[邮政编码制表区](http://www.census.gov/geo/ZCTA/zcta.html)的东西，它不一样，但相关且可能有用。

# c++ - C++ get 和 typecasting 的用法有什么区别？我应该使用哪一个？

> ID：10250806
> 
> 赞同：2
> 
> 时间：2012-04-20T17:29:40.517
> 
> 标签：c++, casting

```
#include <iosteam>
using namespace std;

Class A
{
  int k;

public:

  int getK() { return k; }

  operator int() { return k; }

};

int main()
{
  A a;
  cout << a.getK() << " " << int(a) << endl;
} 
```

有什么区别，我应该使用哪一个？我想知道类型转换是否返回引用而 getK 返回一个副本。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T17:33:54.513

唯一的区别是类型转换可以是隐式的。

```
int i = a; 
```

请注意，c++11 允许您强制强制转换运算符被显式调用。

```
explicit operator int() { return k; } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T17:34:19.410

他们都在返回副本。提供强制转换操作符通常是在需要强制转换时使用。例如，您可能会做这样的事情：

```
#include <iosteam>
using namespace std;

Class A
{
  double k;

public:
  A(double v) : k(v) {}
  double getK() { return k; }
  operator int() { return static_cast<int>(k); }
};

int main()
{
  A a(3.14);
  cout << a.getK() << " " << int(a) << endl; // 3.14 3
} 
```

一般来说，我完全避免使用强制转换运算符，因为我更喜欢显式强制转换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T17:36:20.763

它返回返回类型是什么。如果你投射到一个参考，那么这就是你得到的。你两次都在做一个副本。

“差异”是您的方法所做的。您的“演员”可以向其添加 5，然后将其返回。或者你想要的任何东西。

至于适当性，正如克里斯在第一条评论中所说，通常是“你的班级是不是？” 键入问题。运算符应该用于常见的转换，因为您的类作为某种东西运行，而不仅仅是从中提取某些东西。这就是为什么它将字符串转换为整数的单独函数，而不仅仅是对字符串类的强制转换。而复数类型通常可以直接转换为 double 或 int，尽管这会从中剥离信息。转换可能被“滥用”实际上是一些现代语言不允许运算符重载的原因。其他人采取的方法虽然可以被滥用，但也可以很棒。这就是 C++ 在大多数事情上的理念：提供所有工具，让用户用它们做好事或坏事。

我希望这是有道理的。

# javascript - 你如何用 JavaScript 制作一个工作时钟？

> ID：10250814
> 
> 赞同：-7
> 
> 时间：2012-04-20T17:30:29.240
> 
> 标签：javascript, jquery, clock

这是我破碎的意大利面条 JavaScript/jQuery 代码：

```
$(document).ready(function(){
    var d = new Date;
    var hours = Date.getHours();
    var mins = Date.getMinutes();
    if(hours > 12){
        var hour = (hours - 12);
        var ampm = "PM";
    }
    else{
        var hour = hours;
        var ampm = "AM";
    }
    var time = hour + ":" + mins, ampm
    $("h1").html(time);
    });
}); 
```

你能帮我做一个工作时钟吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T17:34:07.180

评论中指出的修复：

```
$(document).ready(function(){
    var d = new Date;
    var hours = d.getHours(); // call methods on your instance d
    var mins = d.getMinutes();
    if (hours > 12) {
        var hour = (hours - 12);
        var ampm = "PM";
    }
    else {
        var hour = hours;
        var ampm = "AM";
    }
    var time = hour + ":" + mins + ampm; // string concatenate ampm
    $("h1").html(time);
});​ // removed extraneous }); 
```

*   [**演示**](http://jsfiddle.net/paislee/CHmbd/)

这将在每个标签中显示*一次*当前时间。`h1`查看[`setInterval`](https://developer.mozilla.org/en/window.setInterval)以了解有关定期更新的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T17:33:01.337

首先，您的 JS 代码看起来有问题。我假设您想要类似的东西

```
var d = new Date();
var hours = d.getHours();
var mins = d.getMinutes();
...
var time = hour + ":" + mins + ", " + ampm; 
```

对于时钟，您需要一个间隔......当前代码仅产生当前时间戳

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T17:34:19.007

您似乎要关闭`ready`两次通话。

```
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-20T17:43:23.683

这将创建一个时钟，在 DOM 准备好后每秒更新一次：

```
$(document).ready(function(){
    updateTime();
    clock = window.setInterval(updateTime, 1000);
});
function updateTime() {
    var d = new Date;
    var hours = d.getHours();
    var mins = d.getMinutes();
    var secs = d.getSeconds();
    if(hours > 12){
        var hour = (hours - 12);
        var ampm = "PM";
    }
    else{
        var hour = hours;
        var ampm = "AM";
    } 
    var time = hour + " : " + mins + ' ; ' + secs + ' ' + ampm;
    $("h1").html(time);
}​ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-20T17:32:28.380

你的代码不正确

```
var d = new Date();
var hours = d.getHours();
var mins = d.getMinutes(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-20T17:42:39.770

**时间会更新**

```
$(document).ready(function(){
    function getTime()
    {
        var d = new Date;
        var hours = d.getHours();
        var mins = d.getMinutes();
       if(hours > 12)
       {
           var hour = (hours - 12);
           var ampm = "PM";
       }
       else
       {
           var hour = hours;
           var ampm = "AM";
       }
       return hour + ":" + mins+ampm;
    }

    setInterval(function(){ // Time will be updated
        $("h1").html(getTime())
    }, 500);

}); 
```

[**一个例子。**](http://jsfiddle.net/heera/uekQa/)

# asp.net - IIS7.X 从 gzip 压缩中删除目录

> ID：10250820
> 
> 赞同：1
> 
> 时间：2012-04-20T17:31:12.057
> 
> 标签：asp.net, asp.net-mvc-3, gzip, iis-7.5, http-compression

我正在尝试从 gzip 中删除一个目录，因为它会导致浏览器出现错误。

这是我的代码。我读过我不能只禁用一个页面，但是有一种方法可以禁用目录路径。我无权访问服务器设置，但也许我可以通过删除或添加到 staticTypes 的路径从 web.config 设置中做到这一点？

```
<httpCompression directory="%SystemDrive%\inetpub\temp\IIS Temporary Compressed Files">
      <scheme name="gzip" dll="%Windir%\system32\inetsrv\gzip.dll" staticCompressionLevel="9" />
      <dynamicTypes>
        <add mimeType="text/*" enabled="true" />
        <add mimeType="message/*" enabled="true" />
        <add mimeType="application/x-javascript" enabled="true" />
        <add mimeType="application/json" enabled="true" />
        <add mimeType="*/*" enabled="false" />
      </dynamicTypes>
      <staticTypes>
        <add mimeType="text/*" enabled="true" />
        <add mimeType="message/*" enabled="true" />
        <add mimeType="application/x-javascript" enabled="true" />
        <add mimeType="application/atom+xml" enabled="true" />
        <add mimeType="application/xaml+xml" enabled="true" />
        <add mimeType="*/*" enabled="false" />
      </staticTypes>
    </httpCompression> 
```

请指教

# wordpress - Wordpress：只有会员才能查看的页面，如果不是会员，则向他们显示注册页面

> ID：10250822
> 
> 赞同：0
> 
> 时间：2012-04-20T17:31:23.710
> 
> 标签：wordpress, plugins, membership, user-registration

我正在尝试创建一个采样过程，用户需要注册或登录才能查看我的示例 pdf 文档，并且一旦他们注册，用户应该被赋予一个采样者的角色。

我不是 wordpress 的专业人士，但正在学习。你们能给我一些关于如何做的插件或想法吗，我正在使用 wordpress WordPress 3.3.1。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T20:21:33.263

[http://codex.wordpress.org/Function_Reference/is_user_logged_in](http://codex.wordpress.org/Function_Reference/is_user_logged_in)

[http://codex.wordpress.org/Function_Reference/wp_login_form](http://codex.wordpress.org/Function_Reference/wp_login_form)

根据您的最新问题，您需要将它们一起使用，并确保在您的参数数组中定义您的重定向，以确保用户被引导回他们登录的页面。

**最终更新：**在您的 functions.php 文件中输入此内容，并根据需要使用。这将允许您根据用户的实际角色输出信息。这也假设您的插件正在创建实际的自定义角色。如果没有，您将不得不使用[Add Role Function](http://codex.wordpress.org/Function_Reference/add_role)：

```
function get_user_role()
{
    global $current_user;

    $user_roles = $current_user->roles;
    $user_role = array_shift($user_roles);

    return $user_role;
} 
```

然后在你想要的页面模板中：

```
<?php
if(is_user_logged_in())
{
    switch(get_user_role())
    {
        case 'customer' :
            //CUSTOMER DISPLAY
        break;
        case 'subscriber' :
            //SUBSCRIBER DISPLAY
        break;
        default :
            //OTHER TYPE OF USER DISPLAY
    }
}
else
{
    //NO LOGGED USER DISPLAY
}
?> 
```

# cordova - 可以自定义PhoneGap子浏览器的外观吗？

> ID：10250824
> 
> 赞同：0
> 
> 时间：2012-04-20T17:31:25.743
> 
> 标签：cordova, phonegap-plugins

PhoneGap 的 ChildBrowser 的默认布局是： - 从底部滑动 - 工具栏在底部

是否可以自定义上述内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T18:54:31.400

是的。查看 childbrowser xib，它是 CB 外观的可视化显示。您可以根据需要添加和删除元素。请注意，如果您要创建需要与之交互的元素，则需要相应的目标 c 来执行此操作。

# php - 将数字转换为视觉评分（星星）？

> ID：10250825
> 
> 赞同：12
> 
> 时间：2012-04-20T17:31:34.690
> 
> 标签：php, rating-system

在我的数据库中我有数字`1`, `2`, `2.5`, `3`, `3.5`, `4`,`4.5`和`5`

我想将这些数字转换为星星。

我有一颗满星和一颗半星。

从数据库中获取信息后我怎么能做到这一点？

我在数据库上有评级标签。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-04-20T17:41:49.583

```
<?php
    for($x=1;$x<=$starNumber;$x++) {
        echo '<img src="path/to/star.png" />';
    }
    if (strpos($starNumber,'.')) {
        echo '<img src="path/to/half/star.png" />';
        $x++;
    }
    while ($x<=5) {
        echo '<img src="path/to/blank/star.png" />';
        $x++;
    }
?> 
```

*假设您使用的是 PHP

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-20T18:29:41.180

当我过去这样做时，我在一张 5 颗实心星星的图像下方使用了一张 5 颗空星星的图像。然后我做了类似的事情

```
filled-stars.width = (empty-stars.width * (rating / 5) 
```

这样您就可以显示诸如 3.2978 等的评级。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-20T17:58:29.180

你可以用 PHP、HTML 和 CSS 做到这一点：

```
<div class="star-<?=$number?>">
    <b></b><b></b><b></b><b></b><b></b>
</div> 
```

然后，您可以使用 CSS 设置样式，以便根据星星显示背景图像。如果您将`<b>`标签转换为标签，`<a>`它可能更具语义。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-20T18:38:42.613

考虑使用[精灵](http://www.thewebsqueeze.com/web-design-articles/an-introduction-to-css-sprites.html)。从包含每个可能评分的一排星的图形开始，然后通过将每个半星图形的高度乘以评分中的半星数来计算背景偏移。

例如：

```
<?php
$offset =
    ($rating / .5)  // number of half-stars in $rating
  * 15;             // height of each sprite in stars.png
?>
<div style="background-image:url("stars.png");background-position:0 <?php echo $offset; ?>px;"></div> 
```

结合一点 Javascript，您可以[实现一个功能齐全的评级小部件](http://www.webdeveloperjuice.com/2010/01/17/star-rating-using-css-sprite-and-jquery-demo/)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-20T18:48:00.380

`echo '*';`在这里，如果需要，这将添加星号和半号`echo '+';`
更改`'*'`，`'+'`例如更改为`<img src="star.gif" />`和`<img src="halfstar.gif" />`

```
// This number of stars:
$number = 2.7;

// Make it integer:
$stars = round( $number * 2, 0, PHP_ROUND_HALF_UP);

// Add full stars:
$i = 1;
while ($i <= $stars - 1) {
    echo '*';
    $i += 2;
}
// Add half star if needed:
if ( $stars & 1 ) echo '+'; 
```

# linux - 有没有办法制作一个自动更正扫描文档的脚本？

> ID：10250829
> 
> 赞同：7
> 
> 时间：2012-04-20T17:31:51.060
> 
> 标签：linux, shell, imagemagick, gimp

我经常扫描手写文件发送给同事，扫描后需要对数字文件进行更正。（例如，我将我在原始文档上犯的错误更改为白色。）

我正在考虑一些可以执行以下操作的脚本：

将彩色扫描图像（例如 tiff）作为输入，并根据图像中的彩色校正自动进行简单校正。

举个最简单的例子：我只写黑底白字。有一个地方我犯了错误，所以我在那个区域周围画了一个红色的封闭圆圈（用笔在实际的纸上）。然后我扫描图像（或通常其中许多）。现在我希望脚本擦除所有图像中的每个区域，以便我的错误在生成的图像中消失。

任何想法如何在 Linux 环境中实现这一点，例如使用 Image Magick？

* * *

看起来带有 script-fu 的 Gimp 可能是要走的路，它应该足够强大。有人可以通过指出上面的示例在 script-fu 中的样子给我一个提示吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-27T20:45:28.350

我正在考虑基于 ImageMagick 的解决方案。我们需要以下步骤：

1.  在扫描的文档中找到用于绘制的颜色（现在称为**目标颜色**）；
2.  在图像中找到它的`x`和`y`坐标；
3.  将此位置作为种子传递给洪水填充算法。

我们可以根据 ImageMagick 的功能使用以下脚本：

1.  输出图片中所有独特的颜色。这将用于找出目标颜色的 RGB 分量（[命令源](http://www.imagemagick.org/discourse-server/viewtopic.php?f=1&t=13493)）。

    ```
    convert <image> -unique-colors -depth 8 txt:- > output.txt 
    ```

2.  输出文本文件中每种颜色的坐标：

    ```
    convert <image> txt:- > coord.txt 
    ```

3.  找到目标颜色的`x`和`y`坐标（[命令源](http://www.imagemagick.org/discourse-server/viewtopic.php?f=1&t=20900)）。假设第一步得到的目标颜色是红色：

    ```
    grep red coord.txt 
    ```

4.  最后，使用`x`和`y`作为种子，`floodfill`将圆形区域替换为您想要的颜色（[命令源](http://www.imagemagick.org/discourse-server/viewtopic.php?f=1&t=17659)）。在这种情况下，我习惯于`white`擦除该区域：

    ```
    convert <image> -fill white -fuzz 13% \
            -draw 'color <x>,<y> floodfill' <image_floodfill_output> 
    ```

该`-fuzz`参数将避免最初`red`因噪声而损坏的颜色也被替换。

本[教程](http://www.imagemagick.org/discourse-server/viewtopic.php?f=1&t=17659)提供了有关`floodfill`函数的更多信息，例如如何替换边缘颜色。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T20:51:58.363

我建议看一个scansnap扫描仪（也许是scansnap 3100）。捆绑软件可以做的几件事可能会有所帮助。

您可能会发现您找到的任何软件/脚本都不会按照您想要的方式运行。听起来许多这些编辑都是需要用肉眼看到的东西。也许您可以聘请私人助理为您进行这些更正。:)

# python - Python将结果写入文件

> ID：10250830
> 
> 赞同：0
> 
> 时间：2012-04-20T17:31:57.150
> 
> 标签：python

我有以下脚本，由于大家的帮助，它几乎完成了，因为它现在将结果打印到屏幕上。我还希望再添加一个步骤，该步骤将采用相同的屏幕输出并将其转储到文本文件中。

我以为这是完成的`file.write()`

但不知道如何让它将结果中的信息写入文件。请帮忙，我对python很陌生，所以我有点迷茫，想从书中弄清楚。

这现在打印出来，但只是查询返回的内容的最后一行。最终它可能只是打印一行然后一次又一次地覆盖它所以我需要它来打印整个 fetch all 或 results

```
import adodbapi

# Connect to the SQL DB    
conn = adodbapi.connect("Provider=SQLOLEDB; SERVER=xx.x.xx.x; Initial Catalog=master_db;User Id=user; Password=pass; ")
curs = conn.cursor()

# Execute SQL procedure things_referencing"    
curs.execute('util.things_procedure', )
results = curs.fetchall()

for row in results:
    print row

f = open('test.txt', 'w')
s = str(row)
f.write(s)
f.close()

conn.close() 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-20T17:39:53.913

“结果”元组中的每个“行”都是一个记录元组。您希望如何格式化此数据取决于您，但在最基本的级别上，您可以将其转换为字符串`str(row)`

现在去阅读关于如何读写文件的python文档：http:
[//docs.python.org/tutorial/inputoutput.html](http://docs.python.org/tutorial/inputoutput.html)

**更新**

参考您的新代码示例，您正在执行 for 循环并打印每一行，然后您正在打开一个文件并仅写入从您的 for 循环分配的行的最后一个值。您打印的 for 循环与您随后执行的写入操作无关。`row`已分配 的每个值`results`，但您只使用了最后一个分配的值一次。

您应该首先打开文件，然后开始循环，写入行的每个值：

```
with open('test.txt', 'w') as f:
    for row in results:
        print row
        f.write("%s\n" % str(row)) 
```

如果您使用`with`上下文，它会在您离开该范围后自动为您关闭文件。`str`您可以使用字符串格式并添加换行符，而不是仅转换为字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T17:40:51.643

它确实是用 file.write 完成的，但你必须先打开文件。因此，您将修改 for 循环，如下所示

```
f = open('/path/to/file', 'w')
for row in results:
    f.write(row)
f.close() 
```

# javascript - 如何在 jquery 对话框中显示第二个 ajax 响应？响应之间的冲突，第一个显示在 div 作品中，第二个仅警报

> ID：10250836
> 
> 赞同：1
> 
> 时间：2012-04-20T17:32:40.190
> 
> 标签：javascript, jquery-ui, jquery, coldfusion

Firebug 和 javascript 警报显示正确的响应并打开对话框，但**jqxhr**未解析。Jquery、jquery ui、javascript 和 css 脚本在页面上，但我将它们留出了空间。我只是在学习这个，需要语法等方面的帮助。谢谢！

**再次更新了其他建议。使用 ajax 完成功能终于得到了在 jquery 对话框中显示的第二个 ajax 响应。现在只需要帮助将 * *jqxhr****数据解析为 html 表单输入。感谢所有提出想法的人。**

```
 $(document).ready(function() {

 $("#StoreForm").dialog({autoOpen:false, width:500, height:500, modal:true});
 $('#content').css('min-height', '610px');
 $('#sidebar').css('min-height', '600px');

 $('a.storeCategories').unbind('click');
 $('a.storeCategories').click(function(e){
  e.preventDefault();
  var stuff = ($(this).attr('href'));
  $.when($.post(stuff, function(response, status, xhr) {
  if(response.ROWCOUNT > 0) {  
  var s = [];  
  s.push("<table border='0'>");  
  for(var i=0; i<response.ROWCOUNT; i++) {  
//push can take multiple comma-separated strings, and it is very fast  
s.push("<tr><td><p>", response.DATA.ICON[i], "</p></td></tr>",  
       "<tr><td>", response.DATA.LABEL[i], "</td></tr>",  
       "<tr><td class=\"sel\">", response.DATA.PRICE[i], "</td>",
 "<td class=\"item\" display:  hidden>", response.DATA.PROD_SUPER_ID[i], "</td></tr>",  
       "<tr></tr>");  

}  
s.push("</table>");      
}      
else {  
s.push("Sorry, nothing matched your selection.");  
}  
//Now assemble the HTML by joining all the array elements together.  

$("#content").html(s.join(""));      

        //alert(s);

    $(".sel").unbind('click');
    $(".sel, #StoreForm").click(function(e){
    e.preventDefault();
    $("#StoreForm").dialog('open');

    var valueSelected = $(this).closest('tr').children('td.item').text();

    //alert(valueSelected);//this alerts correctly

       var jqxhr = $.post('query/categories.cfc?method=getProductInfo&returnformat=json&
queryFormat=column',
    {productID: valueSelected},

    function(data, textStatus, jqXhr) { 

//$("#StoreForm").html("<b>Ray</b>")

//alert works below
jqxhr.always(function() { 

$('#StoreForm').html(data);

 });               
            })

        });    
    },"json"));

});

})    
DATA below: 
   {"ROWCOUNT":1,
"COLUMNS":[
"IMAGE_TYPE_REF_ID",
"ICON",
"PROD_SUPER_ID",
"COLOR_ATTRIB","SIZE_ATTRIB",
"SUPER_DESC","FULL_DESCRIPTION","PRICE","TAXABLE"],
"DATA {"IMAGE_TYPE_REF_ID": "large"],
"ICON"["http:/Apps/Product_Mgmt/large/necklace150.jpg"],
"PROD_SUPER_ID         
":["C-JAY00001"],"COLOR_ATTRIB":[true],"SIZE_ATTRIB":[true],"SUPER_DESC":["3 Stone
 Womens Quartz 23- inch Necklace"],"FULL_DESCRIPTION":
["This dainty three-drop quartz pendant
hangs  on a silver 23 inch chain. Presented in a small black satchel."],
"PRICE": [10.0000],"TAXABLE":  [true]}} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T22:19:38.933

在处理它们之前，您需要设置“h2”的元素存在。尝试手动添加它们，或者将 ajax 调用排队，以便在它的回调中一个接一个地同步发生。

所以基本上把你在这里的 $.post 调用，把它放在另一个帖子或 ajax 的回调中，然后在`this`回调中，保留你所拥有的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T19:47:05.867

我看到一个问题，那就是设置 id=\"item\"。HTML id 必须是唯一的。最好设置一个类而不是 class="\item\"，然后执行以下操作：

```
$(".item").click(function(e) {
    var valueSelected = $(this).html();
    ...rest of your code...
} 
```

此外，作为旁注，通过将字符串片段推送到数组中，然后使用 array.join() 将它们像这样发送到 HTML，您将在第一次调用中将该表字符串组合在一起，从而获得更好的性能：

```
if(response.ROWCOUNT > 0) {
    var s = [];
    s.push("<table border='1'>");
    for(var i=0; i<response.ROWCOUNT; i++) {
        //push can take multiple comma-separated strings, and it is very fast
        s.push("<tr><td>", response.DATA.ICON[i], "</td></tr>",
               "<tr><td>", response.DATA.LABEL[i], "</td></tr>",
               "<tr><td>", response.DATA.PRICE[i], "</td></tr>",
               "<tr><td id=\"item\">", response.DATA.PROD_SUPER_ID[i], "</td></tr>");

    }
    s.push("</table>");    
}    
else {
    s.push("Sorry, nothing matched your selection.");
}
//Now assemble the HTML by joining all the array elements together.
$("#content").html(s.join("")); 
```

在进行字符串连接时，将字符串推入数组然后通过连接它们将它们转储出来比连接要快得多；特别是当你有很多字符串要连接时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T22:37:42.157

对话框中没有显示响应的原因是选择器`$( '#oneitem > h2' )`和`$( '#oneitem > p' )`结果没有元素，因为具有 id 的元素`oneitem`没有子元素。如果你想在对话框中添加`h2`和`p`元素，你需要的代码更像：

```
$('<h2></h2>').html(response.DATA.FULL_DESCRIPTION[i]).appendTo('#oneitem');
$('<p></p>').html(response.DATA.PROD_SUPER_ID[i]).appendTo('#oneitem');
$('<p></p>').html(response.DATA.PRICE[i]).appendTo('#oneitem'); 
```

这是一个在控制台中工作的转义 JSON 示例：

```
{"ROWCOUNT":1,"COLUMNS":["IMAGE_TYPE_REF_ID","ICON","PROD_SUPER_ID","COLOR_ATTRIB","SIZE_ATTRIB","SUPER_DESC","FULL_DESCRIPTION","PRICE","TAXABLE"],"DATA":{"IMAGE_TYPE_REF_ID": "large","ICON":["http:/Apps/Product_Mgmt/large/necklace150.jpg"],"PROD_SUPER_ID":["C-JAY00001"],"COLOR_ATTRIB":[true],"SIZE_ATTRIB":[true],"SUPER_DESC":["3 Stone Women\'s Quartz 23-inch Necklace"],"FULL_DESCRIPTION":["This dainty three-drop quartz pendant hangs on a silver 23 inch chain. Presented in a small black satchel."],"PRICE":[10.0000],"TAXABLE":[true]}} 
```

# c# - WCF Web 服务不工作

> ID：10250839
> 
> 赞同：0
> 
> 时间：2012-04-20T17:32:56.423
> 
> 标签：c#, jquery, asp.net, wcf

我有一个名为“WebMethods”的 WCF 服务。下面是我的代码。

在 IWebMethods.cs 中：

```
[ServiceContract(Name = "WebMethods")]
public interface IWebMethods
{
    [OperationContract]
    [WebInvoke(BodyStyle = WebMessageBodyStyle.Wrapped, Method = "POST", RequestFormat = WebMessageFormat.Json, ResponseFormat = WebMessageFormat.Json)]
    String Test();
} 
```

在 WebMethods.cs 中：

```
public class WebMethods : IWebMethods
{
    public String Test()
    {
        return "This is a test YEAH!!";
    }
} 
```

和调用javascript：

```
 $.ajax({
        url: 'WebMethods.svc/Test',
        type: "POST",
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        data: null,
        async: false,
        success: function (data) {
            alert(data);
        },
        error: function (xhr, textStatus, errorThrown) {
            alert(errorThrown);
        }
    }); 
```

当我执行我的 javascript 时，我收到错误“内部服务器错误”。有人可以告诉我我做错了什么，或者至少我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-17T08:49:36.367

你的 web.config 文件呢？尝试导航到您的服务页面，也许它可以为您提供有关该错误的更多解释。上面的代码似乎没问题。

# binaryfiles - 使用 shebang 执行二进制文件

> ID：10250843
> 
> 赞同：1
> 
> 时间：2012-04-20T17:33:15.860
> 
> 标签：binaryfiles, chmod, ubuntu-11.10, gedit, shebang

我创建了一个简单的程序，它将目录的路径作为输入，创建该目录的存档（将其转换为单个文件），向该文件添加一个 shebang（以便可以轻松提取文件的内容） ，并将文件写入指定路径的基目录。

问题是当我双击该文件时，它不会自行解压。相反，操作系统（我使用的是 Ubuntu 11.10）尝试使用 gedit 打开它。这显然显示了shebang、随机乱码和存档文件的内容。

我使文件可执行，首先使用`chmod +x`; 当它仍然不起作用时，我尝试了`chmod 777`。但是，当我双击它时，它仍然拒绝使用 shebang 执行文件。也许这是因为它不是纯文本文件。

有趣的是，当我尝试直接从命令行执行文件时，它会读取 shebang 并正确提取存档的内容。所以我的文件格式没有问题。当您双击文件时，我不太了解操作系统会做什么，但我很想了解。

如果您仍然需要从命令行手动执行它，那么将 shebang 添加到文件肯定是没有意义的。一个优势可能是您不需要指定打开它的程序，但我相信这几乎不是优势。任何帮助将不胜感激。

**更新1：**

创建存档的程序称为**opm**。可以使用以下命令通过**节点包管理器安装它：**

```
npm install opm 
```

之后，您只需使用**opm**为您打包和解压缩目录。例如，如果我的`test`主目录中有一个名为的目录，那么我可以打开一个终端并执行以下命令来打包它：

```
opm test 
```

这将创建在`test.pack`主目录中调用的目录的存档。该`.pack`文件有 shebang `#!/usr/bin/opm`。`.pack`用**opm**打开一个带有扩展名的文件告诉它它是一个存档，并且**opm**将它解压缩到同一目录中。

**注意：**`test.pack`如果您不希望文件覆盖现有`test`目录，请更改文件名。

我将shebang添加到`.pack`文件中，以便在我打开它时它会自行提取。但是，这似乎不起作用。不过，如果我运行以下命令之一，那么它可以工作：

```
./test.pack 
```

您可以查看我的源代码并根据需要对程序进行任何修改。

**更新 2：**

**好的，我为opm**创建了以下`.desktop`文件并将其存储在目录中：**`$HOME/.local/share/applications/`**

 **```
[Desktop Entry]
Type=Application
Version=1.0
Encoding=UTF-8
Name=OPM
GenericName=Object Packer and Minifier
NoDisplay=true
Comment=JavaScript Package Manager
TryExec=opm
Exec=opm %f
Terminal=false
MimeType=application/opm 
```

现在我可以通过右键单击文件、转到窗口、选项卡并设置为默认应用程序来将`.pack`文件与**opm相关联。**现在我可以通过简单地打开文件来解压缩它。`.pack``Properties``Open With``opm.desktop``.pack`

但是我想知道如何将`.pack`文件与 mime 类型相关联`application/opm`。目前，这些`.pack`文件与`application/x-java-pack200`. 我该怎么做？如果我使用不同的扩展名（例如`.opm`）会更好吗？通过将打包的档案与 mime 类型相关联，操作系统是否会默认使用**opm**`application/opm`打开它们，而无需显式设置默认应用程序？**`Properties > Open With`**

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T18:59:38.787

如果已经有一个与 .pack 关联的 MIME 类型，那么您将需要使用不同的扩展名 (.opm) 来与您的 MIME 类型 (application/opm) 关联。自动关联打开特定 MIME 类型文件的程序的方式是使用[xdg-mime](http://manpages.ubuntu.com/manpages/jaunty/man1/xdg-mime.1.html)。

或者，

*   编辑`~/.local/share/applications/mimeapps.list`并将您的 MIME/应用程序组合放在 [默认应用程序] 下，如下所示：

> ```
> [Default Applications]
> application/opm=opm.desktop; 
> ```

*   将您的`opm.desktop`文件放在`~/.local/share/applications/`文件夹中。（你已经这样做了）****

# c# - 不带开关映射两个字符串数组

> ID：10250844
> 
> 赞同：1
> 
> 时间：2012-04-20T17:33:17.503
> 
> 标签：c#

我有两个需要映射的数组。在代码中

```
var result = "[placeholder2] Hello my name is [placeholder1]";
var placeholder = { "[placeholder1]", "[placeholder2]", "[placeholder3]", "[placeholder4]" };
var placeholderValue = { "placeholderValue3", "placeholderValue2", "placeholderValue3" };

Array.ForEach(placeholder , i => result = result.Replace(i, placeholderValue)); 
```

给定`i`，`placeholderValue`需要以智能方式设置。我可以实现一个 switch 语句。对于 30 个左右的元素，圈复杂度将是不可接受的。什么是好的模式、扩展方法或其他方式来实现我的目标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T17:44:27.987

为了简单起见，我跳过了空检查

```
string result = "[placeholder2] Hello my name is [placeholder1]";
var placeHolders = new Dictionary<string, string>() { 
    { "placeholder1", "placeholderValue1" }, 
    { "placeholder2", "placeholderValue2" } 
};

var newResult =  Regex.Replace(result,@"\[(.+?)\]",m=>placeHolders[m.Groups[1].Value]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T17:38:10.703

最小的代码更改是仅使用 for 循环，而不是 ForEach，或者在您的情况下，是使用 lambda 的 ForEach。使用 for 循环，您将获得`placehoderValue`数组中适当值的索引。

下一个改进是制作一个对象的单个数组，该数组同时包含占位符和它的值，而不是需要保持同步的两个“并行”数组。

比这更好，也更容易实现的是，只需将 a`Dictionary`键作为占位符，将值作为占位符值。这实质上是通过使用 KeyValuePair 类为您完成上述建议（因此您不需要自己制作）。

此时伪代码变为：

`foreach(key in placeholderDictionary) replace key with placeholderDictionary[key]`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T17:41:25.137

我认为您想使用[`Zip`](http://msdn.microsoft.com/en-us/library/dd267698.aspx)将占位符与其值结合起来。

```
var result = "[placeholder2] Hello my name is [placeholder1]";
var placeholder = new[] { "[placeholder1]", "[placeholder2]", "[placeholder3]", "[placeholder4]" };
var placeholderValue = new[] { "placeholderValue1", "placeholderValue2", "placeholderValue3", "placeholderValue4" };
var placeHolderPairs = placeholder.Zip(placeholderValue, Tuple.Create);

foreach (var pair in placeHolderPairs)
{
    result = result.Replace(pair.Item1, pair.Item2);
} 
```

# python - 在文件python的末尾添加字符串

> ID：10250845
> 
> 赞同：0
> 
> 时间：2012-04-20T17:33:23.623
> 
> 标签：python

澄清：所以如果我的文件有 10 行：第一行是标题，所以我想在第一行的末尾附加一些文本

然后我有一个包含 9 个元素的列表..

我想阅读该列表并在每行的末尾附加相应的元素..

所以基本上 list[0] 到第二行， list[1] 到第三行等等..

* * *

我有一个用逗号分隔的文件。像这样的东西：

```
A,B,C
0.123,222,942
...... 
```

现在我想做这样的事情：

```
A,B,C,D #append "D" just once
0.123,222,942,99293
............ 
```

这个“D”实际上保存在一个列表中，所以是的，我有这个“D”，我该怎么做？我的意思是我知道天真的方式。就像遍历每一行并做类似的事情

```
string += str(list[i]) 
```

基本上我如何以pythonic方式在文件末尾附加一些东西:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T17:46:34.680

只需创建一个新文件：

```
data = ['header', 1, 2, 3, 4]

with open("infile", 'r') as inf, open("infile.2", 'w') as outf:
    outf.writelines('%s,%s\n' % (s.strip(), n) for s, n in zip(inf, data)) 
```

如果要“更新”输入文件，只需在之后重命名新文件

```
import os
os.unlink("infile")
os.rename("infile.2", "infile") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T17:48:40.263

简短回答：[使用`csv`模块](http://docs.python.org/library/csv.html?highlight=dic#module-contents)。

长答案：

```
import csv

newvalues = [...]

with open("path/to/input.csv") as file:
    data = list(csv.reader(file))

with open("path/to/input.csv", "w") as file:
    writer = csv.writer(file)
    for row, newvalue in zip(data, newvalues):
        row.append(newvalue)
        writer.writerow(row) 
```

当然，这取决于文件中的行并且`newvalues`长度相同。如果不是这种情况，您可以使用诸如[`zip_longest`](http://docs.python.org/release/3.0.1/library/itertools.html#itertools.zip_longest)用给定值填充多余行之类的方法。

如果您对不同的文件执行此操作，我们可以更轻松地执行此操作：

```
import csv

newvalues = [...]

with open("path/to/input.csv") as from, open("path/to/output.csv", "w") as to:
    reader = csv.reader(from)
    writer = csv.writer(to)
    for row, newvalue in zip(reader, newvalues):
        row.append(newvalue)
        writer.writerow(row) 
```

这还有一个好处是不会将整个文件读入内存，所以对于非常大的文件，这是一个更好的解决方案。

# hadoop - Apache Hive 如何识别哪一列是分区

> ID：10250852
> 
> 赞同：0
> 
> 时间：2012-04-20T17:33:54.320
> 
> 标签：hadoop, hive, hadoop-partitioning

我有一组日志文件，创建了一个 Hive 表，现在我想根据 col 对表进行分区我不明白并且没有看到示例是如何为分区指定列如何指定 col/字段前任。这是日志中的一行

2012-04-11 16:49:10,629 ~ [http-7001-11] ~DE1F6F6667913022AE2620D1228817D6 ~ END ~ /admin/bp/setup/newedit/ok ~ pt ~ 219 ~

table struc 是 CREATE TABLE log (starttime STRING, thread STRING, session STRING, method STRING, targeturl STRING, registry string, ipaddress STRING, details STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '~'; 现在，如果我希望 6the col ie **'registry'**成为日志的分区，我将如何编写分区语句。 **一般来说，如果我有一行（行）与 cols c1,c2,..... c10 如何在分区中指定 col ci？** 谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T06:22:49.220

此外，hive 在分区的外部表方面存在问题。假设您在表单的子目录（例如 dt=21012-04-01 和其他类似目录）中设置数据后，创建了将其声明为外部的表。一切看起来都很好，只是您的数据不会显示在选择中。

Elastic map reduce 添加了一个特性来解决这个问题

```
ALTER TABLE log RECOVER PARTITIONS; 
```

我正在添加此信息，因为我花了一段时间才找出我的数据不存在的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T00:50:50.297

您首先要做的是在创建表时明确告诉您希望哪些列成为分区。要制作`registry`分区：

```
CREATE TABLE log(starttime STRING, thread STRING, session STRING, method STRING, targeturl STRING, ipaddress STRING, details STRING)
PARTITIONED BY (registry STRING)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '~' 
```

您可以添加任意数量的分区，每个分区将是一个嵌套的子文件夹，以及您在`PARTITIONED BY`事务中声明分区的顺序：第一个将是顶级分区，第二个将是 1降级，... 一个例子：

```
|--- mytable
      `---- mypartition1=x
                   `-------- mypartition2=x
                                     `------- ... 
```

我会做的是：

1.  创建一个指向日志目录位置的外部表，根本没有分区（只包含原始日志文件），它将`raw_log`用您的所有数据填充表，没有分区（还）：

    ```
    CREATE EXTERNAL TABLE raw_log(starttime STRING, thread STRING, session STRING, method STRING, targeturl STRING, registry STRING, ipaddress STRING, details STRING)
    ROW FORMAT DELIMITED FIELDS TERMINATED BY '~'
    LOCATION '/path/to/your/log/dir' 
    ```

2.  使用 Hive 的动态分区功能读取`raw_log`和插入`log`：

    ```
    FROM raw_log raw
    INSERT OVERWRITE TABLE log PARTITION(registry)
           SELECT raw.starttime, raw.thread, raw.session, raw.method, raw.targeturl, raw.ipaddress, raw.details 
    ```

[您可以在官方 Apache wiki 上](https://cwiki.apache.org/confluence/display/Hive/Tutorial#Tutorial-DynamicpartitionInsert)阅读有关动态分区的更多信息

# javascript - 在使用 setInterval 调用 x 次后执行函数

> ID：10250860
> 
> 赞同：1
> 
> 时间：2012-04-20T17:34:17.030
> 
> 标签：javascript, jquery

在[本文中](https://stackoverflow.com/a/2956980/1252748)，使用 setInterval() 给出了以下函数来执行*x*次操作

```
setIntervalX(function () {
    animateColor();
    //or something
}, 3000, 4);

function setIntervalX(callback, delay, repetitions) {
    var x = 0;
    var intervalID = window.setInterval(function () {

        callback();

        if (++x === repetitions) {
            window.clearInterval(intervalID);
        }
    }, delay);
} 
```

callback() 在这里做什么？在指定的重复次数完成后，我正在尝试执行一个功能。但是这个

```
setIntervalX(function () {
    animateColor();
}, 3000, 4, function(){

completeFunction();

}); 
```

不起作用。也许这种语法是非常错误的。我的印象是使用 jquery，您可以将这样的函数串在一起..

非常感谢任何见解。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T17:36:41.117

我想你误解了描述。setIntervalX 执行 x 次交互，而您希望在迭代后有一个回调函数。

```
function setIntervalX(interationFunction, delay, repetitions, callbackFunction) {
    var x = 0;
    var intervalID = window.setInterval(function () {

        iterationFunction();

        if (++x === repetitions) {
            callbackFunction();
            window.clearInterval(intervalID);
        }
    }, delay);
}

setIntervalX(
  function() {
    // this executed every time the interval triggers
  },
  1000, // amount of milliseconds to delay before interval triggers
  5, // amount of repetitions before interval is stopped and callback is executed
  function() {
    // this will be executed after the interval triggered 5 times
    // so after round about 5 seconds after setIntervalX was started
  }
); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T17:44:21.433

```
function setIntervalX(func, delay, times, callback) {
    if (times > 0) {
        setTimeout(function() {
            func.apply(arguments.callee);
            setIntervalX(func, delay, --times, callback);
        }, delay);
    } else {
        callback.apply(this);
    }
}

setIntervalX(function() {
    document.write('ping!<br />');
}, 1000, 5, function() {
    document.write('Finished!<br />');
}); 
```

​</p>

我个人更喜欢 setTimeout 方法......但这只是我。试一试，看看它是否有效。[演示](http://jsfiddle.net/rlemon/jd74V/)

啊，看来我误读了你的整个帖子......所以托比亚斯对你的问题的推理是正确的。我的就是你想要的一个例子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T17:47:34.930

哇，[Frame.js](https://github.com/bishopZ/Frame.js)简单多了：

```
for(var i=0; i<4; i++){
    Frame(3000, animateColor);  
}
Frame(completeFunction);
Frame.start(); 
```

这两个函数都需要调用作为第一个参数传递给它们的回调：

```
function animateColor(callback){
    // do stuff
    callback(); // to advance to the next interval
}
function completeFunction(callback){
    // do stuff
    callback(); // to advance to conclude the series of Frames
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T18:09:27.063

`callback`在原始函数中，每个间隔最多运行一次`X`。尝试此修改以允许完整的回调：

```
setIntervalX(function () {
    animateColor();
    //or something
}, 3000, 4, function(){
    alert("all done!");
});

function setIntervalX(callback, delay, repetitions, complete) {
    var x = 0;
    var intervalID = window.setInterval(function () {

        callback();

        if (++x === repetitions) {
            window.clearInterval(intervalID);
            complete();
        }
    }, delay);
} 
```

# eclipse - Eclipse：在我重新启动 Eclipse 之前，Apache Tomcat 不会更新我的项目

> ID：10250861
> 
> 赞同：4
> 
> 时间：2012-04-20T17:34:17.140
> 
> 标签：eclipse, apache, tomcat

我已经测试了我的一个简单的`form.html`. 我在这里更改了一些东西，然后右键单击项目，在服务器上运行。我的服务器（Apache Tomcat）将运行我的项目。

但是，我不知道为什么，它很少更新我的项目。（意味着`form.html`没有改变！！！）直到我重新启动 Eclipse 并再次运行项目。

也许奇怪的是：没有消息框出现问我：“你想重新启动服务器”就像以前一样。但是我在 Eclipse 中将“总是在需要时重新启动服务器”配置为“总是”。但是，在我更改了一些空间后`form.html`，我只看到 Eclipse 保存并运行项目。（不要停止并再次启动服务器）。也许这里的问题！

（在此之前，我点击了不重启服务器，并记住了这个动作），但我不知道如何再次配置这个

谢谢 ：）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-20T20:07:00.070

打开“服务器”视图并双击您的服务器。检查服务器位置和部署路径。打开发布选项卡并确保选中“*资源更改时自动发布*”。静态资源将热部署，无需重启服务器。

您始终可以通过单击服务器视图中的服务器名称，然后单击最右侧（在标题中）的图标`Ctrl`+ `Alt`+来重新发布资源`P`。

“重启服务器”功能可以在这里修改：**window > prefereces > server > launch**。

# algorithm - 使用蛮力计算两个不同数组元素之间的最小绝对值差

> ID：10250868
> 
> 赞同：2
> 
> 时间：2012-04-20T17:35:09.657
> 
> 标签：algorithm, brute-force

*   输入：实数数组 a[1..n]；
*   输出：两个不同数组元素之间的最小绝对值差。

我想要一个同样的蛮力算法。

任何人有任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T17:36:54.647

如果元素已排序，那么您可能只需要按顺序比较每对项目： [1, 3, 6, 7, 28] -> 7-6 给出最小距离

为了强行使用它，我想您可以从每个值中减去每个值（n * n-1）并跟踪哪个对最小。您需要确保不要从自身中减去相同的元素，但具有相同值的元素应该允许作为对。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-20T18:50:15.213

如果你想暴力破解它，只需遍历每一对元素：

```
min = infinity

for i=1 to n-1
    for j = i+1 to n
        if abs(a[i]-a[j]) < min
            min = abs(a[i]-a[j]) 
```

这需要`O(n^2)`时间。您可以`O(n log n)`通过首先对列表进行排序来获得时间：

```
sort(a)
min = infinity

for i = 1 to n-1
    if abs(a[i+1]-a[i]) < min
        min = abs(a[i+1]-a[i]) 
```

# maven - 使用 Eclipse 时项目导入错误

> ID：10250869
> 
> 赞同：4
> 
> 时间：2012-04-20T17:35:22.890
> 
> 标签：maven, maven-2, eclipse-plugin, m2e

尝试导入一些现有项目（几年前的项目）时出现以下错误。

“没有找到处理 maven-antrun-plugin:1.3:run in Eclipse 的市场条目。有关更多信息，请参阅帮助。”

我已尝试阅读有关此错误的信息.. 但找不到任何可以说明问题以及如何解决的信息。

帮助？我有 Eclipse Indigo 和 M2E Eclipse 插件

更新 - 看起来这与具有 Maven 3 的 Eclipse Indigo 有关，并且我的 pom xml 文件很旧（maven2）。我正在恢复到 Eclipse Ganymede ... :(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T13:16:29.037

这可能与 maven-antrun-plugin 的“运行”目标不存在的 M2E 连接器有关。有关详细信息，请参阅[http://objectledge.org/confluence/display/TOOLS/M2E+Connectors](http://objectledge.org/confluence/display/TOOLS/M2E+Connectors)。

Eclipse 只能执行 Maven 构建功能的子集，而 M2E Eclipse 插件使用它的“连接器”帮助扩展 Eclipse 的所有功能，这些连接器可在市场中下载。

# apache - htaccess，一行行不通

> ID：10250872
> 
> 赞同：2
> 
> 时间：2012-04-20T17:35:29.397
> 
> 标签：apache, .htaccess, mod-rewrite

我正在使用这个 htaccess 文件。除了第一个 RewriteRule 之外，一切都运行良好。当我打开 localhost/music/test/ 时，出现 404 not found 错误。当我打开 localhost/music/ 或 localhost/music/a/b/etc/ 时，它会正常工作。

任何人都知道我在这里做错了什么？

```
RewriteEngine On
RewriteBase /

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_URI} !\..+$
RewriteCond %{REQUEST_URI} !/$

RewriteRule ^([^/]*)/$ /music/index.php?id=$1 [NC,L,QSA]
RewriteRule ^([^/]*)/([^/]*)/$ /music/index.php?id=$1&sid=$2 [NC,L,QSA]
RewriteRule ^([^/]*)/([^/]*)/([^/]*)/$ /music/index.php?id=$1&sid=$2&tid=$3 [NC,L,QSA]
RewriteRule ^([^/]*)/([^/]*)/([^/]*)/([^/]*)/$ /music/index.php?id=$1&sid=$2&tid=$3&fid=$4 [NC,L,QSA]
RewriteRule ^([^/]*)/([^/]*)/([^/]*)/([^/]*)/([^/]*)/$ /music/index.php?id=$1&sid=$2&tid=$3&fid=$4&fiid=$5 [NC,L,QSA]
RewriteRule ^([^/]*)/([^/]*)/([^/]*)/([^/]*)/([^/]*)/([^/]*)/$ /music/index.php?id=$1&sid=$2&tid=$3&fid=$4&fiid=$5&siid=$6 [NC,L,QSA]
RewriteRule ^([^/]*)/([^/]*)/([^/]*)/([^/]*)/([^/]*)/([^/]*)/([^/]*)/$ /music/index.php?id=$1&sid=$2&tid=$3&fid=$4&fiid=$5&siid=$6&seid=$7 [NC,L,QSA]
RewriteRule ^([^/]*)/([^/]*)/([^/]*)/([^/]*)/([^/]*)/([^/]*)/([^/]*)/([^/]*)/$ /music/index.php?id=$1&sid=$2&tid=$3&fid=$4&fiid=$5&siid=$6&seid=$7&eiid=$8 [NC,L,QSA] 
```

apache conf 或 virtualhost 能否将 htacces 文件破坏一行？

**apache conf 是默认的 conf (apt-get apache2)**

**虚拟主机文件**

```
<VirtualHost *:80>
    ServerAdmin wouter1994_67@hotmail.com
    ServerName sites
    DocumentRoot /var/www/sites
    <Directory /var/www/sites>
        Options Indexes FollowSymLinks MultiViews
        AllowOverride All
        Order allow,deny
        allow from all
    </Directory>

    ErrorLog ${APACHE_LOG_DIR}/error.log
    LogLevel warn
    CustomLog ${APACHE_LOG_DIR}/access.log combined

</VirtualHost> 
```

注意：音乐目录在网站目录中

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:40:32.563

我看不出 htacess 文件有什么问题，但是您可以让它将所有流向 music/test 的流量重定向到 music/a/b/ect

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T18:04:23.240

`RewriteCond`指令只影响第一个 immediate `RewriteRule`，所以你有 3 个条件：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_URI} !\..+$
RewriteCond %{REQUEST_URI} !/$ 
```

仅适用于第一条规则：

```
RewriteRule ^([^/]*)/$ /music/index.php?id=$1 [NC,L,QSA] 
```

并且所有其他规则都不受这三个条件的约束。第一条规则可能永远不会被应用的原因是因为你有条件：`%{REQUEST_URI} !/$`它表示*URI 是否**不**以斜杠结尾*。但规则本身要求 URI 以斜杠 ( `^([^/]*)/$`) 结尾。我将假设您的条件`^`前面缺少 a 并且您的意思是：

```
RewriteCond %{REQUEST_URI} !^\..+$
RewriteCond %{REQUEST_URI} !^/$ 
```

如中，***不****以.* **并且*不是 /*。如果您希望它们也适用于其他规则，您还需要为您拥有的每个 RewriteRule 条目复制这些条件。**

# javascript - 使用 HighCharts 和 DotNet.HighCharts 来“玩”多个系列

> ID：10250876
> 
> 赞同：5
> 
> 时间：2012-04-20T17:35:39.597
> 
> 标签：javascript, highcharts

我有一组使用 VB.NET 和 DotNet.HighCharts 创建的系列：

```
Dim SeriesList4As New List(Of Series)(stfipsList4.Count) 
```

我想要发生的是类似于[http://jsfiddle.net/8M2fF/](http://jsfiddle.net/8M2fF/)的事情，只是我希望能够在不知道我有多少的情况下传递多个系列。

创建上述示例的 VB 代码如下：

```
 Dim stfipsList4 = (From r In dt4.AsEnumerable() Select r("areaname")).Distinct().ToList()
        Dim SeriesList4 As New List(Of Series)(stfipsList4.Count)
        Dim seriesItem4(stfipsList4.Count) As Series
        Dim xDate4 As DateTime
        Dim fakeDate4 As String
        Dim sX4 As Integer

        sX4 = 1
        For Each state In stfipsList4
            Dim data As New Dictionary(Of DateTime, Decimal)
            Dim stateVal As String = state.ToString
            Dim recCount As Integer = dt4.Rows.Count - 1
            Dim seriesPointCount As Integer = dt4.Compute("Count(population)", "areaname = '" + stateVal + "'")
            Dim chartData As Object(,) = New Object(seriesPointCount - 1, 1) {}
            Dim x As Integer = 0
            For i As Integer = 0 To recCount
                If dt4.Rows(i)("areaname").ToString = stateVal Then
                    fakeDate4 = "1/1/" + dt4.Rows(i)("periodyear").ToString
                    xDate4 = DateTime.Parse(fakeDate4)
                    chartData.SetValue(xDate4.Date, x, 0)
                    chartData.SetValue(dt4.Rows(i)("population"), x, 1)
                    x += 1
                End If

            Next

            seriesItem4(sX4) = New Series With {
                        .Name = state.ToString, _
                        .Data = New Helpers.Data(chartData)
            }

            SeriesList4.Add(seriesItem4(sX4))

            sX4 = sX4 + 1
        Next

        Dim iterateData As String = JsonSerializer.Serialize(seriesItem4(1))

            Dim chart4 As Highcharts = New Highcharts("chart4").SetOptions(New Helpers.GlobalOptions() With { _
                .[Global] = New [Global]() With { _
                        .UseUTC = False _
                    } _
                }).InitChart(New Chart() With { _
                 .DefaultSeriesType = ChartTypes.Column, _
                 .MarginRight = 10, _
                 .Events = New ChartEvents() With { _
                  .Load = "ChartEventsLoad" _
                 } _
                }).SetTitle(New Title() With { _
                 .Text = "Population" _
                }).SetTooltip(New Tooltip() With { _
                    .Formatter = "function() { return '<b>' + this.series.name + '<br/>' + Highcharts.dateFormat('%Y', this.x) +'</b>: '+ Highcharts.numberFormat(this.y, 0, ','); }" _
                }).SetXAxis(New XAxis() With { _
                 .Type = AxisTypes.Datetime, _
                 .TickPixelInterval = 150 _
                }).SetYAxis(New YAxis() With { _
                       .Min = 0, _
                       .Title = New YAxisTitle() With { _
                        .Text = "Population", _
                        .Align = AxisTitleAligns.High _
                        } _
                }).SetSeries(New Series() With { _
                     .Data = New Helpers.Data(New Object() {}) _
                }) _
                .SetOptions(New Helpers.GlobalOptions() With { _
                .Colors = palette_colors _
                }) _
                .AddJavascripVariable("iterated", iterateData.ToString) _
                .AddJavascripFunction("ChartEventsLoad", "// set up the updating of the chart each second" & vbCr & vbLf & _
                                  " var result = iterated.data;" & vbCr & vbLf & _
                                  " var counter = 0;" & vbCr & vbLf & _
                                  " var series = this.series[0];" & vbCr & vbLf & _
                                  " var loopseries = function() {" & vbCr & vbLf & _
                                  " if (counter <= result.length) {" & vbCr & vbLf & _
                                  " var p = String(result[counter]);" & vbCr & vbLf & _
                                  " var splitp = p.split("","");" & vbCr & vbLf & _
                                  " var x = Number(splitp[0]);" & vbCr & vbLf & _
                                  " var y = Number(splitp[1]);" & vbCr & vbLf & _
                                  " series.addPoint([x, y], true, series.points.length > 10, true);" & vbCr & vbLf & _
                                  " counter++;" & vbCr & vbLf & _
                                  " } else {" & vbCr & vbLf & _
                                  " clearInterval(loopseries);" & vbCr & vbLf & _
                                  " }};" & vbCr & vbLf & _
                                  " setInterval(loopseries, 300);")

        ltrChart4.Text = chart4.ToHtmlString() 
```

这仅适用于单个系列。我想传入一个列表（系列）。需要涉及的事情： 创建 n 个系列 为每个系列添加点 命名每个系列

我可以处理那些只是传递到我无法完成的主系列“列表”中的项目。

编辑：我的要求似乎有些混乱。我可以通过 DotNet.HighCharts API 将 N 个系列传递给 HighCharts。我目前无法做的是将同一组系列传递给 javascript 函数以循环并“播放”该系列。请参见：

```
 .AddJavascripVariable("iterated", iterateData.ToString) _
            .AddJavascripFunction("ChartEventsLoad", "// set up the updating of the chart each second" & vbCr & vbLf & _
                              " var result = iterated.data;" & vbCr & vbLf & _
                              " var counter = 0;" & vbCr & vbLf & _
                              " var series = this.series[0];" & vbCr & vbLf & _
                              " var loopseries = function() {" & vbCr & vbLf & _
                              " if (counter <= result.length) {" & vbCr & vbLf & _
                              " var p = String(result[counter]);" & vbCr & vbLf & _
                              " var splitp = p.split("","");" & vbCr & vbLf & _
                              " var x = Number(splitp[0]);" & vbCr & vbLf & _
                              " var y = Number(splitp[1]);" & vbCr & vbLf & _
                              " series.addPoint([x, y], true, series.points.length > 10, true);" & vbCr & vbLf & _
                              " counter++;" & vbCr & vbLf & _
                              " } else {" & vbCr & vbLf & _
                              " clearInterval(loopseries);" & vbCr & vbLf & _
                              " }};" & vbCr & vbLf & _
                              " setInterval(loopseries, 300);") 
```

.AddJavaScriptVariable 需要一个字符串，并且内联代码给了我无效的对象引用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-21T20:27:41.957

我实际上使用 DotNet.Highcharts 创建了一个具有未定义数量系列的图表。为此，我使用 linq 查询需要添加到图表的数据。我使用一个 object[] 列表来创建各个点，然后我将该列表添加到 Series 列表中。我根据需要多次遍历循环以获取所有系列。然后对于 SetSeries，我分配了 Series 列表中包含的内容。代码是用 C# 编写的，但我相信您可以将其更改为 VB.NET。这是我用于创建图表的整个 ActionResult：

```
public ActionResult CombinerBarToday(DateTime? utcStartingDate = null,
                                     DateTime? utcEndingDate = null)
{
    //GET THE GENERATED POWER READINGS FOR THE SPECIFIED DATETIME
    var firstQ = from s in db.PowerCombinerHistorys
                 join u in db.PowerCombiners on s.combiner_id equals u.id
                 where s.recordTime >= utcStartingDate
                 where s.recordTime <= utcEndingDate
                 select new
                 {
                     CombinerID = u.name,
                     Current = s.current,
                     RecordTime = s.recordTime,
                     Voltage = s.voltage,
                     Watts = (s.current * s.voltage)
                 };

    //GET A LIST OF THE COMBINERS CONTAINED IN THE QUERY
    var secondQ = (from s in firstQ
                   select new
                   {
                        Combiner = s.CombinerID
                   }).Distinct();

    /* THIS LIST OF SERIES WILL BE USED TO DYNAMICALLY ADD AS MANY SERIES 
     * TO THE HIGHCHARTS AS NEEDED WITHOUT HAVING TO CREATE EACH SERIES INDIVIUALY */
    List<Series> allSeries = new List<Series>();

    TimeZoneInfo easternZone = TimeZoneInfo.FindSystemTimeZoneById("Eastern Standard Time");

    //LOOP THROUGH EACH COMBINER AND CREATE SERIES
    foreach (var distinctCombiner in secondQ)
    {
        var combinerDetail = from s in db2.PowerCombinerHistorys
                 join u in db2.PowerCombiners on s.combiner_id equals u.id
                 where u.name == distinctCombiner.Combiner
                 where s.recordTime >= utcStartingDate
                 where s.recordTime <= utcEndingDate
                 select new
                 {
                     CombinerID = u.name,
                     Current = s.current,
                     RecordTime = s.recordTime,
                     Voltage = s.voltage,
                     Watts = (s.current * s.voltage) / 1000d
                 };

        var results = new List<object[]>();

        foreach (var detailCombiner in combinerDetail)
        {
            results.Add(new object[] { 
                            TimeZoneInfo.ConvertTimeFromUtc(detailCombiner.RecordTime, easternZone), 
                            detailCombiner.Watts });
        }

        allSeries.Add(new Series
        {
            Name = distinctCombiner.Combiner,
            //Data = new Data(myData)
            Data = new Data(results.ToArray())

        });
    }

    Highcharts chart = new Highcharts("chart")
    .InitChart(new Chart { DefaultSeriesType = ChartTypes.Spline, ZoomType = ZoomTypes.X})
    .SetTitle(new Title { Text = "Combiner History" })
    .SetSubtitle(new Subtitle { Text = "Click and drag in the plot area to zoom in" })
    .SetOptions(new GlobalOptions { Global = new Global { UseUTC = false } })
    .SetPlotOptions(new PlotOptions
    {
        Spline = new PlotOptionsSpline
        {
            LineWidth = 2,
            States = new PlotOptionsSplineStates { Hover = new PlotOptionsSplineStatesHover { LineWidth = 3 } },
            Marker = new PlotOptionsSplineMarker
            {
                Enabled = false,
                States = new PlotOptionsSplineMarkerStates
                {
                    Hover = new PlotOptionsSplineMarkerStatesHover
                    {
                        Enabled = true,
                        Radius = 5,
                        LineWidth = 1
                    }
                }
            }
        }
    })
    .SetXAxis(new XAxis
    {
        Type = AxisTypes.Datetime,
        Labels = new XAxisLabels
        {
            Rotation = -45,
            Align = HorizontalAligns.Right,
            Style = "font: 'normal 10px Verdana, sans-serif'"
        },
        Title = new XAxisTitle { Text = "Time(Hour)" },
    })
    .SetYAxis(new YAxis
    {
        Title = new YAxisTitle { Text = "Kilowatt" }
    })

    .SetSeries(allSeries.Select(s => new Series {Name = s.Name, Data = s.Data }).ToArray());

    return PartialView(chart);
} 
```

# javascript - HTML 5音频元素不在Rails中循环

> ID：10250880
> 
> 赞同：8
> 
> 时间：2012-04-20T17:36:04.253
> 
> 标签：javascript, ruby-on-rails, html, audio

我正在尝试使用此 javascript 循环音频元素：

音乐.js：

```
myAudio = new Audio('/assets/drumloop.mp3');
myAudio.loop = true;
myAudio.play(); 
```

当我将它作为脚本包含在一个普通的 html 文件中并在 Safari 5.1 中打开该 html 文件时，它循环就好了。当我从运行在本地 Rails 服务器上的 Rails 应用程序中包含此 javascript 时，音频会播放，但*不会循环播放*。

我尝试在“结束”事件上使用回调将时间设置为零并再次播放（如此处所建议[，](https://stackoverflow.com/questions/3273552/html-5-audio-looping)但这也不起作用。

Rails 是否有可能没有在 http 标头中发送足够的信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-30T16:13:00.640

你不需要 JS。试试这个 HTML：

```
<audio controls="controls" loop="loop">
  <source src="/assets/drumloop.mp3" type="audio/mpeg" />
</audio> 
```

关键是**loop="loop"**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T20:31:35.087

我经常遇到同样的问题。我还没有找到*真正的*解决方案，但确实有一个“在开发过程中足够好”的解决方案。

**如果我真的需要测试循环或搜索，**我最终会将我的音频文件扔到另一台服务器上，并在开发过程中从我的 Rails 应用程序中引用它们。****

 **在 localhost 上运行的 Apache 对我来说效果很好。您也可以使用网络服务器。只需确保在部署之前更改这些路径即可！

超级沮丧。**

# asp.net-mvc - 跟踪调用 Ajax.ActionLink 的次数

> ID：10250882
> 
> 赞同：1
> 
> 时间：2012-04-20T17:36:34.853
> 
> 标签：asp.net-mvc, jquery, model-binding, actionlink

简而言之：是否可以跟踪调用 Ajax.ActionLink 方法的次数？

现在来看看上下文。我有一个简单的模型：

```
public class Person {
    public string Name { get; set; }
    public List<Address> Addresses { get; set; }
}

public class Address {
    public string City { get; set; }
    public string Country { get; set; }
} 
```

所以，一个人可以有很多地址。在“创建”页面上，我希望用户单击一个按钮，该按钮允许他们动态添加任意数量的地址。

我将此页面用作学习如何动态绑定到列表的参考：http: [//haacked.com/archive/2008/10/23/model-binding-toa-list.aspx](http://haacked.com/archive/2008/10/23/model-binding-toa-list.aspx)，

以此作为参考，这是我的课程：

家庭控制器：

```
 //
    // GET: /Home/
    public ActionResult Index() {
        return View();
    }

    [HttpPost]
    public ActionResult Create(Person p) {
        return View(p);
    }

    [OutputCache(NoStore = true, Duration = 0)]
    public ActionResult AjaxAddAddress() {
        TempData["key"] = DateTime.Now.Ticks.GetHashCode();
        return PartialView("~/Views/Shared/EditorTemplates/Address.cshtml", new Address());
    } 
```

索引视图：

```
@model ModelTest.Models.Person
<div>
    @using (Html.BeginForm("Create", "Home")) {
        <div>Name: @Html.TextBoxFor(m => m.Name)</div>
        <div id="ajaxAddressBox"></div>

        <p>@Ajax.ActionLink("Add Another Address", "AjaxAddAddress", new AjaxOptions {
            UpdateTargetId = "ajaxAddressBox",
            InsertionMode = InsertionMode.InsertAfter,
            HttpMethod = "GET" })</p>

        <input id="btnSubmit" type="submit" value="Create" />
    }
</div> 
```

创建视图（只是为了确认模型绑定好了）：

```
@model ModelTest.Models.Person
<div>
    <p>You entered person: @Model.Name.</p>

    <p>He has @Model.Addresses.Count total addresses.
    @foreach (var c in Model.Addresses) {
        <p>City: @c.City, Country: @c.Country</p>
    }

</div> 
```

地址编辑器模板：

```
@model  ModelTest.Models.Address
<p><input type="hidden" name="Addresses.Index" value="@TempData["key"]" />
City: @Html.TextBoxFor(x => x.City, new { Name = "Addresses[" + TempData["key"] + "].City" } )
Country: @Html.TextBoxFor(x => x.Country, new { Name = "Addresses[" + TempData["key"] + "].Country" })</p> 
```

它似乎工作正常，所以我希望到目前为止我做得对。我是 MVC 的新手，所以如果有什么完全错误的，请告诉我。

但我需要它做更多的事情。理想情况下，我想为每一行添加一个标签，上面写着“地址#（索引）”。但更重要的是，我需要限制用户只能添加，例如 5 个地址。无论哪种方式，我都想跟踪调用 Ajax.ActionLink 或方法 AjaxAddAddress 的次数。另外，将来我需要一个也需要该限制的编辑页面。因此，如果现有人员有 3 个地址，他们只能再添加 2 个。

有什么建议吗？这看起来很简单，但我不确定如何最好地处理它。如果我使用了隐藏字段，你如何在 Ajax.ActionLink 中传递该值并在我的 AjaxAddAddress 方法中读取它？你能以某种方式制作一个本地客户端变量吗？

我想 Session 变量会起作用，但我总是很紧张，不确定它的寿命或可靠性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T12:51:32.343

[在http://blog.stevensanderson.com/2010/01/28/editing-a-variable-length-list-aspnet-mvc-2-style/](http://blog.stevensanderson.com/2010/01/28/editing-a-variable-length-list-aspnet-mvc-2-style/)的帮助下，这是我想出的一种可能的解决方案。

我没有使用 Ajax.ActionLink，而是使用 Html.ActionLink 并自己手动调用 Ajax。这样，我可以让它直接从 Javascript 中获取值。无论我想要什么值，真的：一个expando、jquery.data、一个隐藏字段，任何东西。

所以我的 Ajax.ActionLink 变成：

```
@Html.ActionLink("Add Another Address", "AjaxAddAddress", null, new { id = "addItem" }) 
```

然后，在同一个视图中，我添加了这个脚本：

```
<script type="text/javascript">
    $("#addItem").click(function () {
        $.ajax({
            url: this.href + "?index=" + $("#ajaxAddressBox").children('div').size(),
            cache: false,
            success: function (html) {
                $("#ajaxAddressBox").append(html);
            }
        });
        return false;
    });
</script> 
```

我手动将一个索引值传递给我的 AjaxAddAddresses 方法，并且我将该索引值基于当前在 ajaxAddressBox 中的 div 子项的总数，或者换句话说，当前添加的地址总数。因此，将来当我构建一个编辑视图时，它最初会填充现有地址，这个函数将从一开始就知道有多少地址。

AjaxAddAddresses 变为：

```
 [OutputCache(NoStore = true, Duration = 0)]
    public ActionResult AjaxAddAddress(int? index) {
        if (index >= 5) return null;
        TempData["key"] = DateTime.Now.Ticks.GetHashCode();
        TempData["index"] = index + 1;
        return PartialView("~/Views/Shared/EditorTemplates/Address.cshtml", new Address());
    } 
```

因此，如果索引 >= 5，我返回 null 以便用户无法添加更多。（这也可以在脚本块中完成以保存浪费的 Ajax 调用，但至少在服务器端完成时不能被欺骗。）

地址编辑器模板变为：

```
@model  ModelTest.Models.Address
<div><p><input type="hidden" name="Addresses.Index" value="@TempData["key"]" />
Address #@TempData["index"] --- 
City: @Html.TextBoxFor(x => x.City, new { Name = "Addresses[" + TempData["key"] + "].City" } )
Country: @Html.TextBoxFor(x => x.Country, new { Name = "Addresses[" + TempData["key"] + "].Country" })</p></div> 
```

当然，仍然欢迎其他解决方案。这对我来说仍然感觉不必要的复杂......

-ps，事实证明，在我的 AjaxAddAddress 方法中使用 Session 变量确实有效，但我无法摆脱在某些情况下它可能会失败的感觉。

# c# - 触发器中的附加行为导致构建错误

> ID：10250883
> 
> 赞同：0
> 
> 时间：2012-04-20T17:36:40.223
> 
> 标签：c#, wpf, triggers, attachedbehaviors, build-error

我有一个带有控件模板的样式，但无法编译它。我正在尝试触发附加行为。如果我把它放在控制模板触发器中它工作正常......但是如果我把它放在文本框触发器中，我会收到一个构建错误，上面写着：

> 在“TextBoxBehavior”类型上找不到静态成员“SelectAllProperty”

这是我的代码：

```
 <Style x:Key="RenamingTextBox" TargetType="{x:Type TextBox}">
                <Style.Setters>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="{x:Type TextBox}">
                                <Grid>
                                    <TextBlock x:Name="block" Visibility="Visible" Text="{TemplateBinding Text}" Margin="0"/>
                                    <TextBox x:Name="box" Visibility="Collapsed" Text="{TemplateBinding Text}" Margin="0">
                                        <TextBox.Triggers>
                                            <Trigger Property="Visibility" Value="Visible">
                                                <Trigger.Setters>
                                                    <Setter TargetName="box" Property="FocusManager.FocusedElement" Value="{Binding RelativeSource={RelativeSource Self}}"/>

<!-- This next line gives an error even though it is the same format as the one below -->
                                                    <Setter Property="behaviors:TextBoxBehavior.SelectAll" Value="True"/>
                                                </Trigger.Setters>                                            
                                            </Trigger>
                                        </TextBox.Triggers>
                                    </TextBox>
                                </Grid>
                                <ControlTemplate.Triggers>
                                    <DataTrigger Binding="{Binding IsRenaming}" Value="true">
                                        <DataTrigger.Setters>
                                            <Setter TargetName="block" Property="TextBox.Visibility" Value="Collapsed" />
                                            <Setter TargetName="box" Property="TextBox.Visibility" Value="Visible" />
<!-- Uncommenting below works fine -->
                                            <!--<Setter TargetName="box" Property="behaviors:TextBoxBehavior.SelectAll" Value="True"/>-->
                                        </DataTrigger.Setters>
                                    </DataTrigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style.Setters>
            </Style> 
```

关于为什么一个给出构建错误而另一个没有的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T17:57:51.867

没关系，我需要将文本框的触发器放在一个样式中：

```
<TextBox x:Name="box" Visibility="Collapsed" Text="{TemplateBinding Text}" Margin="0">
                                    <TextBox.Style>
                                        <Style TargetType="{x:Type TextBox}" BasedOn="{StaticResource {x:Type TextBox}}">
                                            <Style.Triggers>
                                                <Trigger Property="Visibility" Value="Visible">
                                                    <Setter Property="FocusManager.FocusedElement" Value="{Binding RelativeSource={RelativeSource Self}}"/>
                                                    <Setter Property="behaviors:TextBoxBehavior.SelectAll" Value="True"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBox.Style>
                                </TextBox> 
```

# java - 如何在 Jesque 中使用 ConfigBuilder 来配置 Heroku redis 连接？

> ID：10250887
> 
> 赞同：2
> 
> 时间：2012-04-20T17:37:02.953
> 
> 标签：java, heroku, redis, resque

我们有一个 Rails 应用程序使用 Resque 将作业推送到队列中。作业的使用者是使用 Jesque 客户端的 Java 应用程序。这两个应用程序都在 Heroku 上运行。我想不通的是如何使用[Jesque 的`ConfigBuilder`](http://www.jarvana.com/jarvana/view/net/greghaines/jesque/0.9.1/jesque-0.9.1-javadoc.jar!/net/greghaines/jesque/ConfigBuilder.html)类从 Heroku 的`REDISTOGO_URL`配置变量中填充 redis 连接参数。源文档非常薄。默认值以外的示例`final Config config = new ConfigBuilder().build();`会很棒。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-21T10:47:31.073

我不知道如何用 Jesque 来做，`ConfigBuilder`但这里是你如何用 a 做的`JedisPool`：

```
URI redisURI = new URI(System.getenv("REDISTOGO_URL"));
JedisPool pool = new JedisPool(new JedisPoolConfig(),
    redisURI.getHost(), 
    redisURI.getPort(),
    Protocol.DEFAULT_TIMEOUT, 
    redisURI.getUserInfo().split(":",2)[1]); 
```

# android - 如何从另一个活动访问一个活动的按钮/视图

> ID：10250889
> 
> 赞同：1
> 
> 时间：2012-04-20T17:37:15.517
> 
> 标签：android

我在 Activity 中有一个按钮，单击此按钮时，将在另一个 Activity 中执行某些操作。而且我应该只在第二个活动中调用 buttonclick 事件。简单地说，我有一个带有按钮的 TabActivity，单击按钮后，应该在底层选项卡中执行一些操作。ButtonClick 事件应该在选项卡中。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:42:27.913

在辅助类中创建一个通用函数并从两个位置调用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T18:17:10.233

您可以从您的第一个活动中广播一个意图，以便您的第二个活动接收。当您的按钮被点击时，它的父活动会广播一个独特的意图，您的 android 清单将路由到您的第二个活动以进行接收。

这里有一个很好的例子：http: [//thinkandroid.wordpress.com/2010/02/02/custom-intents-and-broadcasting-with-receivers/](http://thinkandroid.wordpress.com/2010/02/02/custom-intents-and-broadcasting-with-receivers/)

但是，请查看[android 参考](http://developer.android.com/reference/android/content/BroadcastReceiver.html)并考虑使用[LocalBroadcastManager](http://developer.android.com/reference/android/support/v4/content/LocalBroadcastManager.html)如果您只是在您的进程中进行广播，则更合适。

# ios - 从另一台 Mac 在 iPhone 上安装应用程序时出现代码设计错误

> ID：10250891
> 
> 赞同：0
> 
> 时间：2012-04-20T17:37:22.760
> 
> 标签：ios, installation, codesign

我已经在 App Store 上发布了我的应用程序。现在我想发布这个应用程序的更新，但显然我想在设备上测试它。不幸的是，我的 iPhone 坏了，所以我将 Xcode 项目发送给了拥有 Mac 和 iPhone 的朋友。

他在自己的 Mac 和 iPhone 上安装了该应用程序。此时，如果他从 iPhone 模拟器执行应用程序，一切正常；但如果他尝试在自己的 iPhone 上安装该应用程序，则会收到以下错误：

> CodeSign 错误：SDK“iOS 5.0”中的产品类型“应用程序”需要代码签名

我试图从 Xcode 的构建设置中删除我的代码签名身份，但没有结果。请问有什么想法或建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T17:40:17.667

您需要从旧 Mac 导出您的开发者配置文件，然后将其导入新 Mac。您可以在 Xcode Organizer 窗口中执行此操作。

无论是那个还是你的朋友都需要生成一组新的密钥/证书/mobileprovisions。

# android - Android HoneyComb 注册 Home Activity

> ID：10250893
> 
> 赞同：0
> 
> 时间：2012-04-20T17:37:46.347
> 
> 标签：android, android-intent, default, android-3.0-honeycomb, android-launcher

去年我在运行 Honeycomb 3.0 的 Xoom 上开发了一个应用程序。在该设备上运行时，清单中的以下代码有效。

```
<intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
            <category android:name="android.intent.category.HOME"/>
            <category android:name="android.intent.category.BROWSER"/>
            <category android:name="android.intent.category.DEFAULT"/> 
</intent-filter> 
```

如您所知，这会注册我的应用程序（特别是 Activity）以侦听“Home Intents”。这工作正常，第一次之后我可以将我的应用程序设置为该操作的默认活动。

现在我已经在运行 Honeycomb 3.1 的三星 Galaxy Tab 上安装了相同的应用程序，无论应用程序处于什么状态或打开了多少次，此功能都不再起作用。

这是故意的吗？这是三星唯一的问题吗？最重要的是——我可以恢复以前在 Xoom 上使用的功能吗？

PS 我的应用程序在其意图上是完全合法的，并且有一个完全可以理解的理由想要替换 Home 应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-06T18:20:19.673

我在`ASUS tablet`. 我相信问题是因为启动器被设置为主页按钮的默认应用程序（即，我按下主页按钮，弹出询问我想使用哪个应用程序的弹出窗口，单击“默认情况下用于此操作”复选框弹出窗口的底部，然后选择启动器）。

您可以通过转到`Settings->Applications`，选择启动器，然后单击`Clear Defaults`按钮来解决问题。

我收集示例 Home 应用程序起作用的原因是因为它本身清除了默认值（如何，我不知道，但我知道这不是通过在意图过滤器中设置类别来完成的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T18:00:23.460

摆脱：

```
 <category android:name="android.intent.category.LAUNCHER" />
        <category android:name="android.intent.category.BROWSER"/> 
```

看看是否有帮助。此外，请尝试在您的 SDK 中找到的 Home 示例应用程序。它使用以下内容`<intent-filter>`：

```
 <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.HOME"/>
            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T20:15:05.123

我的解决方案是安装，然后卸载适用于 Android 3.1 的示例 Home 应用程序。

现在按下主页允许在我的应用程序和默认启动器应用程序之间进行选择。

我的应用程序保持不变。

# java - java - 如何强制firefox使用java web start打开页面？

> ID：10250902
> 
> 赞同：0
> 
> 时间：2012-04-20T17:38:07.107
> 
> 标签：java, mime-types, content-type, jnlp

我有一个应该使用 Java Web Start 打开的存储箱管理页面。但是，在我的 MacBook 上的所有浏览器上，这都不会发生，而是我只得到一个保存有内容的 html 页面：“v6.3.1a Web Tools 10.1.18.222”。

查看页面的 javascript 代码，我看到它正在尝试检测是否安装了正确的 Java Web Start：

```
function webstartVersionCheck(versionString) {
        // Mozilla may not recognize new plugins without this refresh
    navigator.plugins.refresh(true);
    // First, determine if Web Start is available
    if **(navigator.mimeTypes['application/x-java-jnlp-file'])** {
        // Next, check for appropriate version family
        for (var i = 0; i < navigator.mimeTypes.length; ++i) {
                pluginType = navigator.mimeTypes[i].type;
            if (pluginType == "application/x-java-applet;version=" + versionString) {
                return true;
            }
        }
    }
    return false;
} 
```

这里称为：

```
function writeMozillaData(page) {
        versionCheck = webstartVersionCheck("1.5");
    if (!versionCheck) {
        var pluginPage = "http://jdl.sun.com/webapps/getjava/BrowserRedirect?locale=en&host=java.com";
        document.write("The version of Java plugin needed to run the application is not installed. The page from where the plugin can be downloaded will be opened in a new window. If not, please click here: <a href=" + pluginPage + ">Download correct Java version.</a>");
        window.open(pluginPage, "needdownload");
    } else {
        window.location = page;
    }
} 
```

我在 mimeTypes 中添加了一个警报，并注意到导航器中没有显示“application/x-java-jnlp-file”的 mimeType。

问题：

1.  这是导致浏览器将内容解释为 text/html 并保存 html 的原因吗？
2.  如何在此处强制启动 Java Web Start？

我确实有 Firefox 设置表明 jnlp 由 Java Web Start 应用程序处理，因此我怀疑浏览器根本没有将页面解释为 jnlp。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T06:48:24.790

> ..在导航器中没有显示 mimeType `application/x-java-jnlp-file`。
> 
> 这是导致浏览器将内容解释为 text/html 并保存 html 的原因吗？

几乎可以肯定是的。修复内容类型。

# elasticsearch - 无法安装弹性搜索插件

> ID：10250904
> 
> 赞同：16
> 
> 时间：2012-04-20T17:38:07.677
> 
> 标签：elasticsearch

我已经从

[https://github.com/downloads/spinscale/elasticsearch-suggest-plugin/elasticsearch-suggest-0.0.3-0.18.6.zip](https://github.com/downloads/spinscale/elasticsearch-suggest-plugin/elasticsearch-suggest-0.0.3-0.18.6.zip)

我已经解压缩了文件夹，我知道我应该将 3 个 jar 文件放在 lib/ 目录中（播放本身或我正在创建的应用程序或弹性搜索的应用程序）。但是我应该把它放在哪个 lib/ 目录中？还有，接下来我该怎么办。我试图了解网站上的文档，但我没有。我非常感谢任何帮助，因为我已经尝试了 2 天来安装这个插件。我正在使用播放 1.2.4

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2016-03-09T16:09:14.813

使用当前的自制软件安装（2016 年 3 月——2.2.0_1 版本）导致插件可执行文件未链接，因此我必须这样做：

`$ ~HOMEBREW_ROOT/Cellar/elasticsearch/2.2.0_1/libexec/bin/plugin install mobz/elasticsearch-head`

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-12-23T16:55:36.307

### MAC OS - 使用 brew elasticsearch base install

使用 brew 安装 elasticsearch 包：

```
brew install elasticsearch 
```

安装 elasticsearch_head 插件以获得简单的浏览器：

```
cd /usr/local/Cellar/elasticsearch/1.4.0/
sudo bin/plugin -install mobz/elasticsearch-head
open "http://127.0.0.1:9200/_plugin/head/" 
```

![在此处输入图像描述](../Images/0c328a570ea96b4b79b95beeda642d70.png)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-07-02T05:37:51.933

在 Mac OS 上使用此命令获取**插件脚本路径**

`brew info elasticsearch`

[![在此处输入图像描述](../Images/82563863facfb2ad93958583cd0c190e.png)](https://i.stack.imgur.com/pY3uo.png)

然后，使用**插件脚本路径**安装：

`/usr/local/Cellar/elasticsearch/2.3.3/libexec/bin/plugin install some/es-plugin`

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-06-07T12:06:10.730

从此链接下载弹性搜索 deb 文件[弹性搜索](https://github.com/elasticsearch/elasticsearch/downloads)

安装后检查弹性搜索状态，如**sudo service elasticsearch status** 要在 GUI 中查看弹性搜索索引，请从 /usr/share 目录运行此命令

**sudo elasticsearch/bin/plugin -install mobz/elasticsearch-head**

**打开“http://localhost:9200/_plugin/head/”**

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-04-24T15:50:09.847

尝试内置`bin/plugin`实用程序：

```
% bin/plugin -url https://github.com/downloads/spinscale/elasticsearch-suggest-plugin/elasticsearch-suggest-0.0.3-0.18.6.zip -install elasticsearch-suggest
-> Installing elasticsearch-suggest...
Trying https://github.com/downloads/spinscale/elasticsearch-suggest-plugin/elasticsearch-suggest-0.0.3-0.18.6.zip...
Downloading ..............................................................................DONE
Installed elasticsearch-suggest
% find plugins/elasticsearch-suggest
plugins/elasticsearch-suggest
plugins/elasticsearch-suggest/elasticsearch-suggest-0.0.3.jar
plugins/elasticsearch-suggest/lucene-misc-3.5.0.jar
plugins/elasticsearch-suggest/lucene-spellchecker-3.5.0.jar
% 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-01-12T15:21:45.590

在一行中：

```
sudo /usr/share/elasticsearch/bin/plugin -install mobz/elasticsearch-head 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-01-28T07:01:11.687

对于 Ubuntu 中的 ElasticSearch 7.10：

`cd /usr/share/elasticsearch`

`sudo bin/elasticsearch-plugin install analysis-phonetic`

# compilation - 可以在虚拟机里面编译代码吗？

> ID：10250913
> 
> 赞同：2
> 
> 时间：2012-04-20T17:38:50.730
> 
> 标签：compilation, virtual-machine

可以在虚拟机里面编译代码吗？或者我会在它之外得到不同的代码编译？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T17:41:28.663

在 VM 中编译代码没有固有的问题。实际上，我们在工作中这样做是为了确保我们正在编译的代码在没有实际开发工作的机器上编译。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T17:43:30.177

取决于你正在编译什么语言，对吧？

例如，您可以在任何机器上编译 Java 应用程序，它将在任何安装了适用 JRE 的计算机上运行。

显然，您将无法直接在 Windows 中运行在 VM 中编译的 Linux 程序。

但是，虚拟化应该对编译过程没有影响，因此只要目标平台与您的虚拟平台相同（或受其支持），您就应该可以安全地在 VM 中编译代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-11T16:28:59.323

在虚拟机中编译是完全安全的。代码的差异仅仅是由于编译器优化。

# c++ - 构造函数在 C++ 和/或 C++11 中是线程安全的吗？

> ID：10250918
> 
> 赞同：22
> 
> 时间：2012-04-20T17:39:29.037
> 
> 标签：c++, thread-safety, c++11

[源自此问题](https://stackoverflow.com/questions/10250043/double-checked-locking-around-value-going-to-null)并[与此问题相关](https://stackoverflow.com/questions/796099/c-new-operator-thread-safety-in-linux-and-gcc-4)：

如果我在一个线程中构造一个对象，*然后*将指向它的引用/指针传递给另一个线程，那么其他线程在没有显式锁定/内存屏障的情况下访问该对象是否是线程不安全的？

```
// thread 1
Obj obj;

anyLeagalTransferDevice.Send(&obj);
while(1); // never let obj go out of scope

// thread 2
anyLeagalTransferDevice.Get()->SomeFn(); 
```

或者：是否有任何合法的方式来在线程之间传递数据，而不强制执行与线程接触的所有*其他内容*有关的内存排序？从硬件的角度来看，我看不出有任何理由不应该这样做。

澄清; 问题是关于缓存一致性、内存排序等等。在线程 2 的内存视图包括构造所涉及的写入之前，线程 2 可以获取并使用指针`obj`吗？错过引用 Alexandrescu(?) **“一个恶意的 CPU 设计者和编译器编写者会合谋建立一个符合标准的系统来打破这种局面吗？”**

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-20T18:55:50.110

关于线程安全的推理可能很困难，而且我不是 C++11 内存模型的专家。但是，幸运的是，您的示例非常简单。我重写了这个例子，因为构造函数是无关紧要的。

### 简化示例

**问题：**下面的代码正确吗？或者执行会导致*未定义的行为*？

```
// Legal transfer of pointer to int without data race.
// The receive function blocks until send is called.
void send(int*);
int* receive();

// --- thread A ---
/* A1 */   int* pointer = receive();
/* A2 */   int answer = *pointer;

// --- thread B ---
           int answer;
/* B1 */   answer = 42;
/* B2 */   send(&answer);
           // wait forever 
```

**答：**的内存位置可能存在*数据竞争*`answer`，因此执行会导致*未定义的行为*。详情见下文。

* * *

### 数据传输的实现

当然，答案取决于函数`send`和`receive`. 我使用以下无数据竞争的实现。请注意，只使用了一个原子变量，所有内存操作都使用`std::memory_order_relaxed`. 基本上这意味着，这些函数不限制内存重新排序。

```
std::atomic<int*> transfer{nullptr};

void send(int* pointer) {
    transfer.store(pointer, std::memory_order_relaxed);
}

int* receive() {
    while (transfer.load(std::memory_order_relaxed) == nullptr) { }
    return transfer.load(std::memory_order_relaxed);
} 
```

* * *

### 内存操作顺序

在多核系统上，一个线程可以看到与其他线程看到的不同顺序的内存变化。此外，编译器和 CPU 都可以在单个线程中重新排序内存操作以提高效率——而且它们一直都在这样做。原子操作`std::memory_order_relaxed`不参与任何同步，也不强加任何顺序。

在上面的例子中，允许编译器重新排序线程 B 的操作，并在 B1 之前执行 B2，因为重新排序对线程本身没有影响。

```
// --- valid execution of operations in thread B ---
           int answer;
/* B2 */   send(&answer);
/* B1 */   answer = 42;
           // wait forever 
```

* * *

### 数据竞赛

C++11 对数据竞争的定义如下（N3290 C++11 草案）：“如果程序的执行包含不同线程中的两个冲突操作，则程序的执行包含*数据竞争*，其中至少一个不是*原子*的，并且两者都不是*发生在*另一个之前。任何此类数据竞争都会导致*未定义的行为*。” 并且该术语*发生在*之前在同一文档中的较早定义。

在上面的例子中，B1 和 A2 是相互冲突的非原子操作，两者都不先发生。这很明显，因为我在上一节中已经表明，两者可以同时发生。

这是 C++11 中唯一重要的事情。相比之下，Java 内存模型还尝试定义存在数据竞争时的行为，并且他们花了将近十年的时间才提出合理的规范。C++11 没有犯同样的错误。

* * *

### 更多的信息

我有点惊讶这些基础知识并不为人所知。确定的信息来源是C++11 标准中的**多线程执行和数据竞争部分。**但是，规范很难理解。

Hans Boehm 的演讲是一个很好的起点——例如在线视频：

*   [C++11 中的线程和共享变量](http://channel9.msdn.com/Events/GoingNative/GoingNative-2012/Threads-and-Shared-Variables-in-C-11)
*   [正确使用 C++ 线程](http://www.youtube.com/watch?v=mrvAqvtWYb4)

还有很多其他好的资源，我在其他地方提到过，例如：

*   [std::memory_order - cppreference.com](http://en.cppreference.com/w/cpp/atomic/memory_order)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-20T17:53:34.423

没有并行访问相同的数据，所以没有问题：

*   线程 1 开始执行`Obj::Obj()`.
*   线程 1 完成`Obj::Obj()`.
*   线程 1 将对线程 2 占用的内存的引用传递`obj`。
*   线程 1 从不对该内存执行任何其他操作（不久之后，它陷入无限循环）。
*   线程 2 获取对 . 占用的内存的引用`obj`。
*   线程 2 大概对它做了一些事情，不受线程 1 的干扰，线程 1 仍然无限循环。

唯一潜在的问题是，如果`Send`不充当内存屏障，那么它就不会真正成为“合法传输设备”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-20T18:01:20.237

正如其他人所暗示的那样，构造函数不是线程安全的唯一方法是在构造函数完成之前以某种方式获取指向它的指针或引用，并且唯一的发生方式是构造函数本身具有的代码注册`this`指向某种类型的容器的指针，该容器在线程之间共享。

现在在您的具体示例中，[Branko Dimitrijevic](https://stackoverflow.com/users/533120/branko-dimitrijevic)很好地完整地解释了您的情况如何。但在一般情况下，我会说在构造函数完成之前不要使用某些东西，尽管我认为在构造函数完成之前不会发生任何“特殊”。当它进入继承链中的（最后一个）构造函数时，该对象几乎完全“可以使用”，其所有成员变量都已初始化，等等。因此并不比任何其他关键部分工作差，但另一个线程首先需要知道它，唯一的方法是如果你`this`以某种方式共享构造函数本身。因此，如果您是，请仅将其作为“最后一件事”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-20T17:47:11.017

如果您编写了两个线程，并且知道第一个线程没有访问它而第二个线程访问它，那么它只是安全的（有点）。例如，如果构造它的线程在传递引用/指针后从不访问它，那你就可以了。否则它是线程不安全的。您可以通过使所有访问数据成员（读或写）的方法锁定内存来改变这一点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-11-12T00:07:06.020

直到现在阅读这个问题......仍然会发表我的评论：

## 静态局部变量

当您在多线程环境中时，有一种可靠的方法来构造对象，即使用静态局部变量（[静态局部变量-CppCoreGuidelines](https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#i3-avoid-singletons)），

从上述参考：“这是与初始化顺序相关的问题的最有效解决方案之一。在多线程环境中，静态对象的初始化不会引入竞争条件（除非您不小心从其内部访问共享对象）构造函数）。”

另请注意，如果 X 的销毁涉及需要同步的操作，您可以在堆上创建对象并同步何时调用析构函数。

下面是我写的一个例子来展示[Construct On First Use Idiom](https://isocpp.org/wiki/faq/ctors#construct-on-first-use-v2)，这基本上就是参考所谈论的内容。

```
#include <iostream>
#include <thread>
#include <vector>

class ThreadConstruct
{
public:
    ThreadConstruct(int a, float b) : _a{a}, _b{b}
    {
        std::cout << "ThreadConstruct construct start" << std::endl;
        std::this_thread::sleep_for(std::chrono::seconds(2));
        std::cout << "ThreadConstruct construct end" << std::endl;
    }

    void get()
    {
        std::cout << _a << " " << _b << std::endl;
    }

private:
    int _a;
    float _b;
};

struct Factory
{
    template<class T, typename ...ARGS>
    static T& get(ARGS... args)
    {
        //thread safe object instantiation
        static T instance(std::forward<ARGS>(args)...);
        return instance;
    }
};

//thread pool
class Threads
{
public:
    Threads() 
    {
        for (size_t num_threads = 0; num_threads < 5; ++num_threads) {
            thread_pool.emplace_back(&Threads::run, this);
        }
    }

    void run()
    {
        //thread safe constructor call
        ThreadConstruct& thread_construct = Factory::get<ThreadConstruct>(5, 10.1);
        thread_construct.get();
    }

    ~Threads() 
    {
        for(auto& x : thread_pool) {
            if(x.joinable()) {
                x.join();
            }
        }
    }

private:
    std::vector<std::thread> thread_pool;
};

int main()
{
    Threads thread;

    return 0;
} 
```

输出：

```
ThreadConstruct construct start
ThreadConstruct construct end
5 10.1
5 10.1
5 10.1
5 10.1
5 10.1 
```

# c++ - 为 C++ 制作头文件的困难

> ID：10250923
> 
> 赞同：-4
> 
> 时间：2012-04-20T17:39:49.140
> 
> 标签：c++

我正在尝试制作一个名为**hippiewh**的头文件。但是，我遇到了一些问题。

这是头文件的代码：

```
#include <iostream>
#include <string>
using namespace std;

#ifndef hippiewh_h
#define hippiewh_h

int askInt(string prompt)
{
    int var_int;
    cout << prompt;
    cin >> var_int;
    return var_int;
}

#endif 
```

每种数据类型都有类似的功能。字符串、浮点数等。

我无法让这个头文件与[Compilr.com上的在线 IDE 和编译器一起使用](http://www.compilr.com)

我得到的错误是：

```
hippiewh.h: No such file or directory 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:59:48.810

安德鲁，我敢打赌你没有这样写包含`#include "hippiewh.h"`。

并且您这样做`#include <hippiewh.h>`对于您自己创建的头文件是错误的。

如果您将所有代码放在这里，我们可以为您提供帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T17:58:56.547

它应该可以毫不费力地工作：/
您必须以这种方式包含文件

```
#include "hippiewh.h" 
```

# wpf - 试图绑定到 DataTrigger 内部的枚举，为什么它不起作用？

> ID：10250925
> 
> 赞同：9
> 
> 时间：2012-04-20T17:39:57.893
> 
> 标签：wpf, xaml, data-binding

我希望我的椭圆现在是红色的。

![在此处输入图像描述](../Images/6e0d3082fb59e9703b7eaccb1baa7204.png)

```
<UserControl x:Class="BenchmarkPlus.PMT.UI.Views.NotificationIndicator"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:Models="clr-namespace:BenchmarkPlus.PMT.UI.Models"
             mc:Ignorable="d"
             d:DesignHeight="300"
             d:DesignWidth="300"
             x:Name="root"
             DataContext="{x:Static Models:NotificationType.Error}">
  <Grid>
    <Ellipse>
      <Ellipse.Style>
        <Style TargetType="Ellipse">
          <Setter Property="Fill"
                  Value="Blue" />
          <Style.Triggers>
            <DataTrigger Binding="{Binding}"
                         Value="{x:Static Models:NotificationType.Info}">
              <Setter Property="Fill"
                      Value="Green" />
            </DataTrigger>
            <DataTrigger Binding="{Binding}"
                         Value="{x:Static Models:NotificationType.Error}">
              <Setter Property="Fill"
                      Value="Red" />
            </DataTrigger>
          </Style.Triggers>
        </Style>
      </Ellipse.Style>
    </Ellipse>
  </Grid>
</UserControl> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T15:38:13.580

这似乎在 VS2010 设计器中不起作用，但在 VS11 中起作用。切换到 VS11 beta 的另一个原因 :)

# mongodb - Mongoid 和集合

> ID：10250927
> 
> 赞同：1
> 
> 时间：2012-04-20T17:40:03.043
> 
> 标签：mongodb, mongoid

我第一次尝试配置和使用 mongoid。我将 mongoid.yml 配置文件设置为：

主机：本地主机

数据库：表

和我的代码：

```
 Mongoid.load!("/mongoid.yml") 
  class Data        
    include Mongoid::Document
    field :study, type: String
    field :nbc_id, type: String
    field :short_title, type: String
    field :source, type: String
    field :start_date, type: Date
  end

  puts Data.study 
```

我不断收到错误消息：

> NoMethodError at / undefined method `study' for Data:Class

我认为这是因为我没有指定集合名称“测试”。但是，我找不到有关如何执行此操作的示例。我是在 .yml 文件中还是在代码中指定它。什么是正确的语法。谁能指出我正确的方向？

德克萨斯州。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T22:00:42.810

根据 Mongoid 文档，“默认情况下，Mongoid 将文档存储在一个集合中，该集合是类名的复数形式。对于下面的 Person 类，存储文档的集合将被命名为 people。” [http://mongoid.org/docs/documents.html](http://mongoid.org/docs/documents.html)

文档继续说明 Mongoid 使用一种称为`ActiveSupport::Inflector#classify`确定集合名称的方法，并提供有关如何自己指定复数的说明。

或者，您可以通过在类定义中包含“store_in”来指定类中的集合名称。

```
class Data        
    include Mongoid::Document
    store_in :test 
```

希望这可以帮助！

# ruby - 从数组中删除元素

> ID：10250928
> 
> 赞同：7
> 
> 时间：2012-04-20T17:40:04.920
> 
> 标签：ruby

我的 Rails 3.1 应用程序中有一个由多个对象组成的数组：

```
[#<Hardware id: 10, brand_id: 5, model: "B4200", description: "Stampante OKI B4200", typology_id: 3, sub_typology_id: 10, created_at: nil, updated_at: nil>, #<Hardware id: 19, brand_id: 9, model: "JetLab", description: "JetLab - 600 ", typology_id: 5, sub_typology_id: nil, created_at: nil, updated_at: nil>] 
```

我想从这个数组中删除一个对象。使用 Rails 控制台，我尝试做一些事情，例如（尝试删除第一个对象）：

```
array.pop=#<Hardware id: 10, brand_id: 5, model: "B4200", description: "Stampante OKI B4200", typology_id: 3, sub_typology_id: 10, created_at: nil, updated_at: nil> 
```

但它不起作用。我怎样才能做到这一点？

更新：我的目标不是弹出数组上的最后一个元素，而是我应该使用 mysql 搜索查询找到的通用对象（数组内的任何地方）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-20T17:43:41.923

```
my_array = [ 1, 2, 3 ]

item = my_array.pop

puts item
# => 3

puts my_array
# => [ 1, 2 ] 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-20T17:54:08.277

您可能想使用**Array#delete**函数

```
an_array = [1,3,4]
an_array.delete(3)
# => 3
puts an_array
# => [1,4] 
```

在 Ruby 文档中查看：

[http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-delete](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-delete)

# java - 为什么标记库测试会抛出 GrailsTagException？

> ID：10250929
> 
> 赞同：0
> 
> 时间：2012-04-20T17:40:08.930
> 
> 标签：java, exception, grails, taglib

假设我有一个 TagLib 使用`FormatTagLib`：

```
class MyTagLib {

  def something = {attrs, body ->
    def format = new FormatTagLib()
    out << format.formatDate(attrs.date, format: 'HH:mm')
  }

} 
```

我为这个标签库写了一个单元测试：

```
class MyTagLibTests extends TagLibUnitTestCase {

  //setUp() and tearDown() ommited

  void testMyTagLib() {
    tagLib = new MyTagLib()
    tagLib.something(date: Date.parse('20/04/2012 08:00','dd/MM/yyyy HH:mm'))
    assertEquals('08:00', out.toString()) //out is mocked...
  }

} 
```

为什么这段代码会抛出异常`formatDate`？

```
org.codehaus.groovy.grails.web.taglib.exceptions.GrailsTagException: Tag [formatDate] does not exist. No corresponding tag library found. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T13:08:46.940

有几件事：

1.  您不需要在新标签库中实例化 FormatTagLib
2.  您的标签库中有一个错误，FormatDate 需要一张地图而不是日期和地图
3.  如果您使用内置功能，Grails 会使测试标记库变得更加简单。

我认为一个工作示例是这样的：

```
class MyTagLib {
    static namespace = "myTags"

    def something = { attrs, body ->
        out << g.formatDate(date: attrs.date, format: 'HH:mm')
    }
} 
```

通过测试：

```
@TestFor(MyTagLib)
class MyTagLibTests  {
    void testMyTagLib() {
        def templateOut = applyTemplate('<myTags:something date="${date}"/>', [date: new Date(12, 3, 20, 8, 0)])
        assertEquals('08:00', templateOut)
    }
} 
```

# iphone - 为什么这个 NSMutableSet 没有泄漏内存

> ID：10250937
> 
> 赞同：1
> 
> 时间：2012-04-20T17:41:00.707
> 
> 标签：iphone, objective-c, ios, ipad, memory-management

所以我有我在一个开源项目上看到的这种方法，它只是让我难以置信，为什么当我尝试运行静态分析器时它不会泄漏内存。我认为它应该泄漏的原因是因为它正在分配内存但从不释放它。每次调用该方法时它都会释放它（因为 =nil）。任何人都可以为我发光吗？

```
- (BOOL)isValid(NSString *)name
{
    // Using a set so access is faster
    static NSMutableSet *exp = nil;

    // Setup the set once with AB testing info
    if (exp == nil) {

            exp = [[NSMutableSet alloc] initWithCapacity:5];

    }

    if (exp != nil) {
        return YES;
    }

    return NO;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T17:46:16.047

分析器识别`static`存储限定符，并理解它不会超出范围（当然，直到终止）。

> 每次调用该方法时它都会释放它（因为 =nil）。

不是这样。第一次调用该方法时会发生这种情况——只有一次，因为它是`static`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T17:47:26.003

分析器没有抱怨，因为 exp 是静态的。尝试在没有静态的情况下再次分析，您会收到投诉。（我刚刚在 Xcode 中验证了这一点——关闭了 ARC。）

想想什么是静电，你就会明白为什么没有抱怨。你告诉编译器这个变量会一直指向对象。如果没有任何东西指向对象并且没有释放内存的机会，这只是一个泄漏。

# c# - Ninject 和 WCF - 初始化控制容器反转的正确方法

> ID：10250939
> 
> 赞同：4
> 
> 时间：2012-04-20T17:41:05.520
> 
> 标签：c#, .net, wcf, inversion-of-control, ninject

使用 WCF 在 Ninject 中连接类型的正确方法是什么。我已经通过 NuGet 将 WCF 扩展和 Ninject 本身添加到 WCF 项目中。但我不知道下一步该做什么。我似乎遇到了一些使用 global.asax 而不是 ServiceHostFactory 的过时示例。ServiceHostFactory 方法是最好的方法吗？

当前使用 WCF 使用 Ninject 的最佳示例在哪里？我不确定如何使用 Ninject WCF 扩展提供的对象进行接线。

更多信息：
我试着走过 - [https://github.com/ninject/ninject.extensions.wcf/tree/Maintenance_2.2/src/Examples/WcfTimeService](https://github.com/ninject/ninject.extensions.wcf/tree/Maintenance_2.2/src/Examples/WcfTimeService)

我的项目无法解析 Global.asax.cs 中的 NinjectWcfApplication
这就是为什么我认为这不再兼容或与最新的 Ninject 不兼容。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T18:19:17.427

如果您正在使用服务激活（磁盘上没有 .svc 文件），请在 web.config 中设置 ninject 托管工厂

```
<serviceHostingEnvironment>
      <serviceActivations>
        <add relativeAddress="MyService.svc" service="MyService" factory="Ninject.Extensions.Wcf.NinjectServiceHostFactory" />
      </serviceActivations>
</serviceHostingEnvironment> 
```

如果您使用的是 .svc 文件，您可以编辑标记并添加`Factory="Ninject.Extensions.Wcf.NinjectServiceHostFactory"`到`<%@ ServiceHost ... %>`声明中。

然后您需要修改 global.asax 以从 NinjectWcfApplication 继承并创建内核

```
public class Global : NinjectWcfApplication
{
    protected override IKernel CreateKernel()
    {
        var kernel = new StandardKernel();
        return kernel;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T19:16:27.217

您提供的链接来自已过时的 2.2。只需将该页面切换到主分支

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T18:04:12.657

我没有使用过 Ninject，但通常我会在 ServiceHost 实现中开始连接过程。就像是：

```
public sealed class MyServiceHost : ServiceHost
{
    public MyServiceHost() : base() 
    {
        MyServiceLocator.SetAsDefaultServiceLocator();
    }
} 
```

# asp.net - 将 Membership Provider 设置为使用特定的 Provider

> ID：10250941
> 
> 赞同：0
> 
> 时间：2012-04-20T17:41:10.827
> 
> 标签：asp.net, asp.net-membership, forms-authentication, membership-provider

我正在使用开箱即用的 Asp.Net Membership 功能来处理我的用户管理和角色管理。

我的应用程序由每个客户端的单个数据库组成，每个数据库都有自己的成员资格提供者和角色提供者。

但是，有些用户为多个客户工作，我想使用一个登录名并让他们选择查看哪个客户。我通过使用存储所有用户名和他们有权访问的客户端的关系的中间数据库来完成所有设置以促进这种“客户端切换”。我还设置了它，因此对一个数据库中的用户的任何更新都会更新其他数据库中的所有相应用户。所有这些逻辑都运行得很好，除了我似乎无法弄清楚如何告诉 ASP.Net 更改为特定的 MembershipProvider 并使用那个。

我认为我应该使用的过程如下（当用户在客户端下拉列表中切换客户端时）：

*   注销当前用户
*   告诉 ASP.Net 使用哪个会员提供程序（根据下拉菜单中选择的客户端选择）
*   使用所选客户的会员提供程序登录当前用户，并刷新/重定向到他们更改下拉列表时正在查看的页面

我知道如何获取对特定成员资格提供程序 (Membership.Providers[MembershipProviderName]) 的引用，但我找不到任何有关如何告诉 ASP.Net 更改其成员资格提供程序的信息。我什至不确定 asp.net 登录控件是如何在后台执行此操作的——这可能会帮助我解决所有这些问题。

我一直在搜索 SO 和网络一段时间，除了一些人们试图修改其 Web.config 中 Providers 元素的 DefaultProvider 属性的线程之外，似乎找不到太多关于这样做的信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T17:44:05.310

这个[MSDN 教程](http://www.asp.net/web-forms/videos/how-do-i/how-do-i-create-a-custom-membership-provider)可能会对您有所帮助。

# apache-flex - 从单独的文件中为 AdvancedDataGrid 设置封闭节点

> ID：10250943
> 
> 赞同：0
> 
> 时间：2012-04-20T17:41:23.190
> 
> 标签：apache-flex, hierarchical-data, advanceddatagrid

我正在尝试在我的 AdvancedDataGrid 中设置特定的封闭节点，我知道您通常会使用带有网格的 expandItem() 属性来执行此操作。但是，我在单独的文件中获取分层数据，因此我很难从我为分层数据创建的适配器文件中访问数据网格。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T13:21:07.500

我找到了答案。显然，AdvancedDataGrid 的 dataProvider 属性实际上使用了 HierarchicalCollection 类，因此可以使用 showItem(); 函数可以访问节点对象，而不必位于分层数据中。

例子：

`AdvancedDataGridName.dataProvider.showItem(object);`

# jquery - 通过 jQuery 动态添加表单元素

> ID：10250949
> 
> 赞同：4
> 
> 时间：2012-04-20T17:41:59.080
> 
> 标签：jquery

我已成功设置表单并使其正常工作。但是我有两个问题：

a) 删除按钮不起作用（它将删除表单元素的最后一行）

b）这是一个小标记问题，当按“添加”添加新的表单元素行时，而不是创建一个新`<ul></ul>`的，它被加载到现有的行中`<ul></ul>`

这是演示链接[http://jsfiddle.net/34rYv/1/](http://jsfiddle.net/34rYv/1/)

下面是我的JS代码

```
$(document).ready(function() {
$('#btnAdd').click(function() {
    var num = $('.clonedSection').length;
    var newNum = new Number(num + 1);

    var newSection = $('#pq_entry_' + num).clone().attr('id', 'pq_entry_' + newNum);

    newSection.children(':first').children(':first').attr('id', 'year_' + newNum).attr('name', 'year_' + newNum);
    newSection.children(':nth-child(2)').children(':first').attr('id', 'qualification_' + newNum).attr('name', 'qualification_' + newNum);
    newSection.children(':nth-child(2)').children(':first').attr('id', 'university_' + newNum).attr('name', 'university_' + newNum);

    $('.clonedSection').last().append(newSection)

    $('#btnDel').attr('disabled', '');

    if (newNum == 5) $('#btnAdd').attr('disabled', 'disabled');
});

$('#btnDel').click(function() {
    var num = $('.clonedSection').length; // how many "duplicatable" input fields we currently have
    $('#pq_entry_' + num).remove(); // remove the last element
    // enable the "add" button
    $('#btnAdd').attr('disabled', '');

    // if only one element remains, disable the "remove" button
    if (num - 1 == 1) $('#btnDel').attr('disabled', 'disabled');
});

$('#btnDel').attr('disabled', 'disabled');
});​ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T20:04:35.943

为了解决您的第一个问题，我创建了一个`del()`函数，该函数将评估剩余的“行”数，如果只有一个将禁用，`#btnDel`或者相反，如果有多个行，则启用它。

然后我也改变了其他一切。

```
var containerClass = '.clonedSection',
    containerElem = $(containerClass),
    a = $('#btnAdd'),
    d = $('#btnDel');

function numRows(elem) {
    return elem.length;
}

function del() {
    var r = numRows($(containerClass));
    if (r>1){
        d.prop('disabled',false);
    }
    else {
        d.prop('disabled',true);
    }
}

del();
a.click(
    function() {
        var rows = numRows($(containerClass)),
            lastRow = rows + 1,
            newRow = containerElem
            .first()
            .clone(true, true)
            .insertAfter($(containerClass).last());
        newRow
            .attr('id',function(i,v){
                return v.replace(/\d/,'')+lastRow;
            })
            .find('input').each(
            function() {
                var that = this;
                that.id = that.id.replace(/\d/, '') + lastRow;
                that.name = that.name.replace(/\d/, '') + lastRow;
            });
        del();
    });

d.click(
    function(){
        $(containerClass)
            .last()
            .remove();
        del();
    });​ 
```

您在将新行添加到现有行时遇到的问题`ul`是因为您查找了最后一个`.clonedSection`元素，然后将新行附加到该元素，而不是使用`insertAfter()`.

我*认为*上述修订版可以满足您的需求，并且希望足够清晰，可以遵循。

参考：

*   [`attr()`](http://api.jquery.com/attr/).
*   [`click()`](http://api.jquery.com/click/).
*   [`clone()`](http://api.jquery.com/clone/).
*   [`each()`](http://api.jquery.com/each/).
*   [`find()`](http://api.jquery.com/find/).
*   [`first()`](http://api.jquery.com/first/).
*   [`insertAfter()`](http://api.jquery.com/insertAfter/).
*   [`last()`](http://api.jquery.com/last/).
*   [`prop()`](http://api.jquery.com/prop/).
*   [`remove()`](http://api.jquery.com/remove/).
*   [JavaScript 正则表达式](https://developer.mozilla.org/en/JavaScript/Guide/Regular_Expressions)。
*   [`replace()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/replace).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T17:49:23.193

你为什么不使用这样的解决方案来做到这一点？[http://jsfiddle.net/rniemeyer/gZC5k/](http://jsfiddle.net/rniemeyer/gZC5k/)

这是一个**mvvm** javascript 库，易于使用和理解。更多信息[在这里](http://knockoutjs.com/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T17:46:39.663

改变：

```
$('#btnDel').attr('disabled', ''); 
```

到：

```
$('#btnDel').prop('disabled', ''); 
```

“禁用”是属性而不是属性。此外，更改任何其他实例。

见：http: [//jsfiddle.net/34rYv/2/](http://jsfiddle.net/34rYv/2/)

要解决插入问题：

```
newSection.insertAfter('#pq_entry_' + num).last(); 
```

[http://jsfiddle.net/34rYv/25/](http://jsfiddle.net/34rYv/25/)

# javascript - 通过自动完成设置隐藏的单选按钮值

> ID：10250950
> 
> 赞同：0
> 
> 时间：2012-04-20T17:42:06.397
> 
> 标签：javascript, jquery, html

当一个用户向另一个用户发送消息时。他们可以选择要发送到的个人资料类型。（普通或经理）...我正在使用“recipient_type”在后端检查要将其发送到哪个配置文件，如何让我的自动完成功能为我选择隐藏的单选按钮？

自动完成看起来像这样：
*To* :`John Doe - Manager` 或 *To:* `John Doe`

模板：

```
<div class="hide">
     <input type="radio" id="id_recipient_type" name="recipient_type" value="0" />
     <input type="radio" id="id_recipient_type" name="recipient_type" value="1" />
</div>
<div class="inline-block">
     <label for="id_omnibox"></label>
     <input type="hidden" name="recipient_username" id="id_recipient_username" />
     <input id="message-to" class="required input-text" style="width: 145%;"name="omnibox" placeholder="Search for user..." autocomplte="on" type="text" />
</div> 
```

脚本：

```
$(document).ready(function(){
    $.get('/autocomplete/message/', function(data) {
        var completions = new Array();
        var dict = JSON.parse(data, function(key, value) {
            completions.push(key);
            return value;
        });
        $('#message-to').autocomplete({
            source: completions,
            minLength: 1,
            select: function(value, data){
                $('#id_recipient_username').val(dict[data.item.value])
                split_string = data.item.value.split("- ");
                $('#id_recipient_type_'+(split_string[1]=="Manager"?"1":"0")).attr('checked', true);
            }     
        });
    });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T17:54:17.707

似乎为了使您的代码正常工作，您需要更改或：

```
<div class="hide">
     <input type="radio" id="id_recipient_type_0" name="recipient_type" value="0" />
     <input type="radio" id="id_recipient_type_1" name="recipient_type" value="1" />
</div> 
```

单选框 ID。或者：

```
$('#id_recipient_type[value="'+(split_string[1]=="Manager"?"1":"0")+'"]').attr('checked', true); 
```

`#id_recipient_type[value="1"]`到or的 jquery 选择器`#id_recipient_type[value="0"]`。

我会使用第一个解决方案，因为在 html 中，id 应该是唯一的。

您需要通过拆分解决[kmfk](https://stackoverflow.com/users/396318/kmfk)指出的问题，当找不到`' - '`字符串时它会引发错误，因此请更改：

```
split_string = data.item.value.split("- "); 
```

到：

```
split_string = 'John Doe - Manage'.match(/ - (Manager)$/)
split_string = split_string != null ? "0" : "1"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T17:56:55.783

查看您的代码示例，这些行似乎是问题所在：

```
split_string = data.item.value.split("- ");
$('#id_recipient_type_'+(split_string[1]=="Manager"?"1":"0")).attr('checked', true); 
```

当不在字符串中时，该拆分将是一个问题`- Manager`- 并且您正在寻找的 ID 不存在。

也许这样做：

```
var valAttr = data.item.value.indexOf("- Manager") > 0 ? 1 : 0;
$('#id_recipient_type [value="'+valAttr+'"]').attr('checked', true); 
```

# asp.net - 按钮控件未触发

> ID：10250956
> 
> 赞同：2
> 
> 时间：2012-04-20T17:42:25.237
> 
> 标签：asp.net, vb.net

我遇到的问题解释起来有点复杂，所以请多多包涵。我有 2 个按钮控件。在页面加载中，我想知道哪个按钮在页面加载时创建了回发。通过研究，我在下面找到了这个片段，它按预期工作。所以这是我点击按钮时发生的事件场景。

```
 1\. Click the button does a postback
   2\. Runs the function below and tell me the id of the button
   3\. Runs the clicked event handlers for that button

     Protected Sub btnCalc_Click(ByVal sender As Object, ByVal e As EventArgs) Handles  btnCalc.Click
          ' Do this
     End Sub 
```

当我单击第二个按钮时，问题就出现了，它执行第 1 步和第 2 步，但从不执行第 3 步。通过测试，我发现它只在单击第一个按钮时执行 1、2 和 3。我不知道为什么会这样？

```
 Function GetPostBackControlName() As String

      Dim control As Control = Nothing
      Dim ctrlname As String = Page.Request.Params("__EVENTTARGET")

    If ctrlname <> Nothing AndAlso ctrlname <> [String].Empty Then
        control = Page.FindControl(ctrlname)
    Else
        Dim ctrlStr As String = [String].Empty
        Dim c As Control = Nothing

        For Each ctl As String In Page.Request.Form

            c = Page.FindControl(ctl) 

           If TypeOf c Is System.Web.UI.WebControls.Button Then
                control = c
                Exit For
           End If

        Next

    End If

    Try
        Return control.ID.ToString
    Catch
        Return ""
    End Try

    End Function 
```

# html - 缩放时菜单元素跳跃

> ID：10250959
> 
> 赞同：4
> 
> 时间：2012-04-20T17:42:31.360
> 
> 标签：html, css

问题如下：我有一个基本的无序列表，我使用 css 将它变成了一个水平菜单。但是，在浏览器中放大或缩小时，菜单项会跳到下一行，如下所示：

未缩放：

|菜单一| |菜单 2| |菜单 3| |菜单 4|

放大：

|菜单一| |菜单 2| |菜单 3|
|菜单 4|

我能做些什么来防止菜单项像那样跳跃？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T17:46:11.550

尝试使用 ul 的固定（最小）尺寸（或者可能是包装 ul 的 div）并给它一个溢出设置。就像是：

```
ul {
    width: 750px;
    overflow:auto;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T17:51:58.963

我同意 SinsitraD - 留一点余地。如果您使用百分比，我通常会尝试留出约 2% 的余量。如果您更喜欢 px 作为您选择的单位，那么估计的 1-2% 余量将涵盖大多数舍入误差。

您可能会发现浏览器之间的缩放行为不一致 - 这是因为大多数浏览器在缩放时使用不同的方法来计算大小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T17:52:55.273

尝试应用`position: relative`in`li`元素

# coldfusion - 使用 ColdFusion 连接到 neo4j

> ID：10250960
> 
> 赞同：5
> 
> 时间：2012-04-20T17:42:33.540
> 
> 标签：coldfusion, neo4j

这里有没有人使用 ColdFusion 成功连接到 neo4j？

我能够使用本指南作为起点连接到 neo4j 1.6.1：http: [//ghostednotes.com/2010/04/29/using-neo4j-graph-databases-with-coldfusion](http://ghostednotes.com/2010/04/29/using-neo4j-graph-databases-with-coldfusion) 。然而，这是一个短暂的成功。我已经卸载了 neo4j 1.6.1 并安装了 1.7。

我现在在 Windows XP 上运行 Apache、CF 9.0.1 作为本地开发盒。我添加`...\neo4j-community-1.7\lib`到我的 CF 类路径中，并且库在 CF Server Java 类路径**中**列出。neo4j 运行良好，因为我可以使用他们的管理员界面：[http://localhost:7474/webadmin/#](http://localhost:7474/webadmin/#)。CF 和 Apache 也运行良好。我每天都使用它们。

虽然下面的代码有效，但我真的很想“看看”使用 neo4j 网络管理员发生了什么。因此，我可以在 CF 应用程序中使用数据的同时协调我的 neo4j 学习。

**代码：（作品）**

```
 dbroot = "/tmp/neo4jtest1/";
    graphDb = createObject('java', 'org.neo4j.kernel.EmbeddedGraphDatabase');
    graphDb.init( dbroot & 'var/myFirstGraphDB'); 
```

所以我尝试连接到 neo4j db graph.db 。但是代码失败了。

**代码：（失败）**

```
 graphDb = createObject('java', 'org.neo4j.kernel.EmbeddedGraphDatabase');
    graphDb.init( dbroot & 'graph.db'); 
```

**错误：**

```
 Object instantiation exception.
    An exception occurred while instantiating a Java object. The class must not be an interface or an abstract class. Error: ''. 
```

如果我删除它`"."`，`graph.db`它**会**在 neo4j 数据文件夹中创建一个“graphdb”，并成功连接到它。但是，他们的管理员无法查看该数据库:(

我是新手，所以请你的答案哑口无言。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T20:56:08.633

好的，我认为您要实现的目标是不可能的。无法在 CF 中访问 Neo4J（通过 Java）*并*让管理界面正常工作（适用警告 1）。

如果您已将 Neo4J 包的所有 jar 放入 Adob​​e CF，那么 Neo4J 管理界面很可能正在查看它自己的 Neo4J 文件系统。当您创建嵌入式服务器时，它没有连接到同一个数据库，因为它根本无法连接。

嵌入式 Neo4J 不像标准数据库连接那样工作。一个嵌入式 Neo4J 读取和写入一个目录位置（关键字：目录，它不会打开单个文件，而是打开一大堆文件）。没有两个 Neo4J 实例可以访问相同的目录位置（适用警告 2）。

好的，注意事项：

1-理论上，可以通过编程手动启动管理界面，以便它使用您通过 Java 创建的嵌入式服务器。Java 代码看起来很简单（取自[Using the server (including web management) with an embedded database](http://docs.neo4j.org/chunked/stable/server-embedded.html#_starting_the_server_from_java)）：

```
// Create your embedded graph db somewhere
src = CreateObject("java", "org.neo4j.server.WrappingNeoServerBootstrapper")
      .init(graphDb);
srv.start();
// The server is now running
// until we stop it:
srv.stop(); 
```

我没有得到这个工作，主要是因为管理服务器有一堆与我的其余设置不兼容的依赖项，所以我无法建议上述工作的效果如何。

2- 可以让 1 个读/写 Neo4J 访问一个位置，然后让多个只读 Neo4J (EmbeddedReadOnlyGraphDatabase) 读取同一位置（但我从未尝试过）。

您确实可以选择使用 REST 接口 - 手动或通过[Neo4J Java REST 绑定](https://github.com/neo4j/java-rest-binding)（虽然有点慢）。

在深入研究之前，可能值得阅读部署场景文档。

那里至少有一个 CF/Neo4J 桥接器，但还很不完整。我有一个我正在研究的，但我需要弄清楚我是否可以开源它！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T22:04:34.580

只是对 otupman 评论的一个小补充。我可以确认他从 CF 连接到管理界面的理论。将以下 jar 添加到 CF 类路径似乎足以让基础知识启动并运行。如果您使用更高级的功能，您可能需要额外的 jar。 *请注意，*我使用的是 Tomcat，因此确切的 jar 可能会因您的环境而略有不同

*   `neo4j-community-1.7/lib/*.*`（整个目录）
*   `neo4j-community-1.7/system/lib`: (只有下面的罐子)

    *   asm-3.1.jar
    *   asm-analysis-3.2.jar
    *   asm-commons-3.2.jar
    *   asm-tree-3.2.jar
    *   asm-util-3.2.jar
    *   commons-configuration-1.6.jar
    *   杰克逊核心asl-1.8.3.jar
    *   杰克逊-jaxrs-1.8.3.jar
    *   jackson-mapper-asl-1.8.3.jar
    *   jersey-core-1.9.jar
    *   jersey-multipart-1.9.jar
    *   jersey-server-1.9.jar
    *   jetty-6.1.25.jar
    *   jetty-util-6.1.25.jar
    *   neo4j-server-1.7-static-web.jar
    *   neo4j-server-1.7.jar
    *   rrd4j-2.0.7.jar

然后在 onApplicationStart 中启动服务器和数据库

```
 factory = createObject("java", "org.neo4j.graphdb.factory.GraphDatabaseFactory");
    dbroot = ExpandPath("/neo4jtest/");
    graphDb = factory.newEmbeddedDatabase(dbroot & 'myFirstGraphDB');

    Bootstrapper = createObject("java", "org.neo4j.server.WrappingNeoServerBootstrapper");
    graphServer = Bootstrapper.init( graphDb );
    graphServer.start();

    application.graphServer = graphServer;
    application.graphDb = graphDB; 
```

并在 onApplicationEnd 中关闭

```
 application.graphDb.shutDown();
    application.graphServer.stop(); 
```

**编辑：**经过进一步测试，我认为最好在 OnServerStart 中加载一次。然后使用关闭挂钩关闭它们。但由于这只是针对本地开发框，所以它不那么重要。

# css - 全宽谷歌地图和 CSS

> ID：10250961
> 
> 赞同：10
> 
> 时间：2012-04-20T17:42:36.290
> 
> 标签：css, maps

`height="100%"`我在使用和的页面上有一个全角谷歌地图`width="100%"`。我想知道*在它上面*放一些 css div的东西。我读到使用负值（例如`margin-top: -500px;`会起作用），它们确实有效，但是当我尝试为 div 的背景分配颜色时，它不会在地图上显示它，而是在地图下显示它，这不是我想要什么。有针对这个的解决方法吗？代码：

```
<iframe width="100%" height="100%" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="http://maps.google.com/maps?hl=en&amp;ie=UTF8&amp;ll=37.0625,-95.677068&amp;spn=56.506174,79.013672&amp;t=m&amp;z=4&amp;output=embed"></iframe>

<div class="content"> I want this text to be in a div box that has a black background. <br /> </div> 
```

风格：

```
.content {
     margin-top: -500px;
     width: 390px;
     background-color: black;
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-20T17:48:51.797

```
html, body {
    width: 100%;
    height: 100%;
}

.map-frame {
    width: 100%;
    height: 100%;
    position: relative;
}

.map-content {
    z-index: 10;
    position: absolute;
    top: 50px;
    left: 50px;
    width: 390px;
    background-color: black;
    color: #FFF;
} 
```

[http://jsfiddle.net/oswaldoacauan/tx67C/](http://jsfiddle.net/oswaldoacauan/tx67C/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T17:49:17.047

将此添加到您的CSS。至少在 chrome 中工作

```
position:absolute;
z-index:9999;
color:#fff; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-09-28T21:41:03.390

您要设置样式的 div 应该绝对定位并给定一个正 z-index 以便它显示在地图上方而不是下方

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-10-04T19:39:59.407

如果可以的话，即使没有 css 的地图，我也会使用以下内容。

只需在 iframe 中输入 width="100%"

```
<iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d1994.873621232488!2d32.58519671879903!3d0.342002233462275!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x177dbbaed45800cb%3A0xfba72049a6cb630c!2sKamwokya%20Market%2C%20Kampala!5e0!3m2!1sen!2sug!4v1633372520333!5m2!1sen!2sug" width="100%" height="500" style="border:0;" allowfullscreen="" loading="lazy"></iframe> 
```

```
<iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d1994.873621232488!2d32.58519671879903!3d0.342002233462275!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x177dbbaed45800cb%3A0xfba72049a6cb630c!2sKamwokya%20Market%2C%20Kampala!5e0!3m2!1sen!2sug!4v1633372520333!5m2!1sen!2sug" width="100%" height="500" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
```

# java - 控制台和受限文件夹中的弹簧安全错误不起作用

> ID：10250966
> 
> 赞同：0
> 
> 时间：2012-04-20T17:42:52.767
> 
> 标签：java, jsf-2, spring-security

问题一：

我已经在我的应用程序中设置了 Spring Security，但现在我遇到了一个奇怪的问题。我从 spring security 中学到的是，`@RolesAllowed({"ROLE_ADMIN"})`如果你设置了这个，你不需要在你的方法上方添加这行代码

```
<sec:http auto-config="true" access-denied-page="/faces/accessDenied.xhtml">
    <sec:form-login login-page="/faces/login.xhtml" />
    <sec:intercept-url pattern="/faces/admin/**" access="ROLE_ADMIN" />
</sec:http> 
```

但显然我可以在没有弹簧安全的情况下转到“/faces/admin”文件夹中的页面，将我重定向到登录页面。

问题2：

当`@RolesAllowed({"ROLE_ADMIN"})`我的方法上面有代码时，它会将我重定向到登录页面并正常工作，但是使用这个，我的控制台中出现访问被拒绝错误，并带有一堆错误代码（尽管应用程序仍然正常运行）。我可以在控制台中收到拒绝访问错误吗？如果不是，最好的处理方法是什么？

我仍然希望拥有受限页面文件夹，并且不必写`@RolesAllowed`在管理文件夹中的所有方法之上。

PS：它是一个 JSF 2.0 项目。

提前谢谢，干杯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T18:09:19.590

问题 1：我认为您的 web.xml 中缺少 DelegatingFilterProxy。像这样配置：

```
<filter>
  <filter-name>springSecurityFilterChain</filter-name>
  <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
</filter>

<filter-mapping>
  <filter-name>springSecurityFilterChain</filter-name>
  <url-pattern>/*</url-pattern>
</filter-mapping> 
```

并配置 http 元素如下：

```
<http auto-config="true" >
   <intercept-url pattern="/faces/login.xhtml*" access="IS_AUTHENTICATED_ANONYMOUSLY"/>
   <intercept-url pattern="/faces/admin/**" access="ROLE_ADMIN" />
   <access-denied-handler error-page="/faces/accessDenied.xhtml" />
   <form-login login-page='/faces/login.xhtml' default-target-url='/faces/index.xhtml'
        always-use-default-target='true'/>
</http> 
```

而不是 access-denied-page 属性，使用 access-denied-handler 因为上述属性已被弃用。[资源](https://jira.springsource.org/browse/SEC-1100)

问题2：是的，如果您将日志级别设置为DEBUG并以匿名用户身份首次访问受保护的资源，这是正常的。请参阅本[常见问题的 1.3](http://static.springsource.org/spring-security/site/faq.html)

# testing - 为业务逻辑层（烟雾、回归等）设计手动测试用例？

> ID：10250974
> 
> 赞同：1
> 
> 时间：2012-04-20T17:43:32.163
> 
> 标签：testing, agile, business-logic

我有兴趣整理一些手动测试用例，以验证特定 Web 应用程序的 BL 是否按预期运行。

不幸的是，UI 和 BL 层之间的耦合度足够高，如果我们想使用 Fitnesse 等工具执行任何自动化测试，我需要花费相当多的时间，而且我不认为这是一种价值支出给定当前期限等的时间。

**我的问题是**，在上述场景中执行手动测试（测试将按照 [此处定义）是否合理，如果是：](http://en.wikipedia.org/wiki/System_testing)

*   BL 层的系统测试应该有多详细？
*   在一般系统测试和冒烟测试的情况下，设计每个测试以覆盖特定需求是否足以覆盖？

**例子：**

```
REQUIREMENT: If a user provides two cost entries for the same type of
       item, the application will take the higher of the two costs, and zero
       the second.
TEST: Add two cost entries, both for vehicle use, submit the ticket. 
      Verify that the invoice for the ticket only shows the higher of the two. 
```

*   在设计手动测试时我还应该考虑什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T18:03:50.067

> BL 层的系统测试应该有多详细？

您的系统需要支持多长时间？在您发货后，是否有人需要再次对其进行回归测试？如果是这样，测试必须足够详细，以便他们能够根据文档运行测试。否则为什么还要费心把它们写下来？

使用正确的工具，即使您的 UI 和 BL 是耦合的，您也可以通过 UI 自动执行黑盒测试。如果您的系统将存在多年并且回归的成本很高，您应该考虑尝试通过 UI 自动化测试。可执行的测试用例比书面测试用例文档更有价值。

> 在一般系统测试和冒烟测试的情况下，设计每个测试以覆盖特定需求是否足以覆盖？

至少您还需要进行探索性测试，并尝试在边缘情况下打破程序，以在手动测试时最大化您的投资回报率。与在边缘情况下尝试打破它相比，测试快乐路径产生的错误要少得多。

还要考虑要求中的任何遗漏。根据您的要求的抽象级别，可能会省略许多场景。

```
Anything else I should take into consideration when designing manual tests? 
```

尽你所能自动设置测试夹具和运行系统。即使您无法在自动化测试中进行额外的步骤，如果您可以立即设置测试夹具，您也可以节省大量时间。

# jquery-mobile - 检测 JQuery Mobile 是否来自选择对话框

> ID：10250980
> 
> 赞同：1
> 
> 时间：2012-04-20T17:44:06.317
> 
> 标签：jquery-mobile

我有一个带有页面的 jquery 移动应用程序。此页面包含三个 DIV，我根据各种变量以编程方式选择其中一个 DIV。无论如何，一个 DIV 包含一个选择元素。该元素中有 20 个项目。由于剪切量，选择框在其自己的对话框中打开。我对此很好，但是，在用户做出选择后，我的托管页面的 pagebeforeshow 事件会再次被触发。我的问题是，我似乎无法弄清楚如何检测到由于用户选择选项或关闭选择对话框而触发了此事件。

有没有办法在 pagebeforeshow 事件中检测我们是如何到达这里的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T17:52:42.990

jQuery mobile 将元数据传递给大多数事件的回调函数。从上的[文档](http://jquerymobile.com/test/docs/api/events.html)`pagebeforehow`：

> 在实际过渡动画开始之前，在我们过渡到的“toPage”上触发。此事件的回调将接收一个数据对象作为其第二个参数。此数据对象具有以下属性：
> 
> *   prevPage (object) - 一个 jQuery 集合对象，其中包含我们要转换的页面 DOM 元素。请注意，在应用程序启动期间转换第一页时，此集合为空。

您应该能够在您的回调函数中使用它来发挥您的优势，即检测是否`prevPage`是当前页面。这可能看起来像：

```
$('#yourPage').live('pagebeforeshow', function(event, data) {
    var from = data.prevPage;
    // do some inspection of `from` and branch accordingly
    // might require some experimental console.logging first
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T21:42:06.097

我也没有验证上述评论中提出的问题，但 data.prevPage 有整个前一页 HTML 的副本，可通过`data.prevPage[0].innerHTML`. 我敢肯定你可以做一些事情，比如绑定到选择对话框上的点击事件，并告诉它在用户选择任何条目的 DOM 中添加一个类或任何东西，然后将其从 HTML 中刮掉？只是在那里抛出一个想法。

# ruby-on-rails - 使用 Ruby Mechanize 进行解析

> ID：10250991
> 
> 赞同：0
> 
> 时间：2012-04-20T17:44:56.770
> 
> 标签：ruby-on-rails, ruby-on-rails-3, mechanize, mechanize-ruby

我正在尝试使用 Mechanize Gem 解析网站。到目前为止，这就是我所拥有的：

```
page = agent.get("http://www.greatgiftsformen.com/price-range-under-c-131_142.html?page=all")
page.parser.xpath('//tr[(((count(preceding-sibling::*) + 1) = 2) and parent::*)]//*[contains(concat( " ", @class, " " ), concat( " ", "productListing-data", " " ))]')[5] 
```

我得到了这个产品的元素：

```
=> #<Nokogiri::XML::Element:0x81c175ec name="td" attributes=[#<Nokogiri::XML::Attr:0x81c17d58 name="valign" value="top">, #<Nokogiri::XML::Attr:0x81c17eac name="align" value="center">, #<Nokogiri::XML::Attr:0x81c17ec0 name="class" value="productListing-data">] children=[#<Nokogiri::XML::Element:0x805fa174 name="a" attributes=[#<Nokogiri::XML::Attr:0x81c13794 name="href" value="http://www.greatgiftsformen.com/gas-pump-retro-liquor-dispenser-p-249.html?osCsid=05f5dbb816874ece6db883c2c48d7ae1">] children=[#<Nokogiri::XML::Element:0x8068e270 name="img" attributes=[#<Nokogiri::XML::Attr:0x81c115ac name="src" value="product_thumb.php?img=images/prod/liquordisp-gas.jpg&w=160&h=160">, #<Nokogiri::XML::Attr:0x81c115c0 name="width" value="160">, #<Nokogiri::XML::Attr:0x81c115d4 name="height" value="160">, #<Nokogiri::XML::Attr:0x81c11714 name="border" value="0">, #<Nokogiri::XML::Attr:0x81c11728 name="alt" value="Gas Pump Retro Liquor Dispenser">, #<Nokogiri::XML::Attr:0x81c11750 name="title" value="Gas Pump Retro Liquor Dispenser">, #<Nokogiri::XML::Attr:0x81c11764 name="class" value="fotgal">]>]>]> 
```

但是，当我尝试获取 href 时，我返回 nil：

```
url = item.attributes['href']
 => nil 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T19:53:58.783

需要添加子节点：

```
url = item.children[0].attributes['href'].to_s 
```

# session - ASP 问题：是否可以将会话变量作为参数传递给 Global.asa 文件中的函数？

> ID：10250992
> 
> 赞同：1
> 
> 时间：2012-04-20T17:44:57.917
> 
> 标签：session, variables, asp-classic, global.asa

我打算用 JavaScript 编写 Global.asa 文件。当会话或应用程序结束时，我需要在数据库中进行更改。具体来说，我需要分解一个字符串并在 Global.asa 函数的查询中使用它。那部分根本不让我困惑。只是关于将会话变量作为参数传递的部分。我想象我的 Global.asa 看起来像这样：

（假设两个变量“variable1”和“variable2”是会话变量）

```
<script language="JScript" runat="Server">
function Application_OnStart() {
}

function Application_OnEnd(variable1) {
}

function Session_OnStart() {
}

function Session_OnEnd(variable2) {
}
</script> 
```

所以，我不确定我所问的是否可行。如果是这样，有什么提示吗？请记住，我正在使用 ASP，而不是 ASP.NET。另外，我对使用服务器端代码有点陌生，所以请原谅我的无知。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T20:46:59.493

不，你的建议是不可行的。

global.asa 文件中的函数是事件的回调。函数*被*调用，都没有参数。

您可以利用该[`Session`](http://www.w3schools.com/asp/asp_ref_session.asp)对象来做您想做的事。

在您的代码中，您可以像这样设置会话变量：

```
session("userid") = 856 
```

在您的 global.asa 中，您可以使用：

```
variable1 = session("userid") 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-20T18:39:58.537

您是否考虑过为您的 Global.asa 使用 VBScript？我从未在 javascript 中编写过 Global.asa，但您*可以*在 VB 中对其进行编码并使用会话或应用程序级别的变量：

```
<脚本语言=VBScript RUNAT=服务器>

子应用程序_OnStart()
    '初始化应用级变量
    Application("ConnectionString") = "Driver={Microsoft Access Driver (*.mdb)};DBQ=" & Server.mappath("access_db/mydb.mdb")
结束子

子应用程序_OnEnd()
    应用程序（“连接字符串”）=“”
结束子

子会话_OnStart()
    '初始化会话级变量
    会话("UserIP") = Request.ServerVariables("REMOTE_ADDR")
结束子

子会话_OnEnd()
    会话（“用户IP”）=“”
结束子

```

不确定您是否可以将变量传递给预定义函数，但您可以在网站上的任何地方使用会话或应用程序变量，包括在这些函数中。