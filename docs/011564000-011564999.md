# StackOverflow 问答 11564000-11564999

# java - JAVA：MySql：连接太多

> ID：11564000
> 
> 赞同：1
> 
> 时间：2012-07-19T15:20:50.940
> 
> 标签：java, mysql, jdbc, connection

我认为我的应用程序被诅咒了，调试去了它想要的地方，我不知道为什么。逐行调试似乎也分析了注释行。我认为问题出在我的 Connection 方法上，我发现性能显着下降，并且在第三个（或第四个 nvm）连接处出现此错误：

```
com.mysql.jdbc.exceptions.jdbc4.MySQLNonTransientConnectionException: Too many connections 
```

我确定每次访问数据库时都会关闭连接（在实现中的 try catch 中使用 finally 语句）。

这是我的连接类：

```
package Connection;

import java.io.FileInputStream; import java.io.FileNotFoundException; import java.io.IOException; import java.rmi.RemoteException; import java.sql.*; import java.util.Properties;

public class ConnectionDB {         
    public static ResultSet rs = null;  
    public static Statement stat = null;    
    public static Connection cn = null;

    public static void connect() throws RemoteException     {
            String dbHost="",dbUser="",dbPassword="";
            Properties prop=new Properties();
            try
            {
                //carico il file:
                prop.load(new FileInputStream("***/config.properties"));
                //Leggo le proprietà del file:
                dbHost=prop.getProperty("host");
                dbUser=prop.getProperty("user");
                dbPassword=prop.getProperty("password");
            }catch(FileNotFoundException fe){
                System.out.println("config file not found");
            }catch(IOException ex){
                System.out.println("Error reading config file");
            }
            try 
            {
                String driver = "com.mysql.jdbc.Driver";
                Class.forName(driver);
                dbHost = "jdbc:mysql://"+dbHost;
                cn = DriverManager.getConnection(dbHost,dbUser,dbPassword);
                stat = cn.createStatement();
            }catch(SQLException e){
                System.out.println("Can't connect to the DB");
            }
            catch(ClassNotFoundException cln){
                System.out.println("Error using JDBC driver");
            }   
    }   

    public static void disconnect() throws RemoteException  {
            try{
                if(rs != null) rs.close();
                if(stat != null) stat.close();
                if(cn != null) cn.close();
            }
            catch(SQLException sqlEx){
                System.out.println("Error: disconnect");
            }   
      }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T18:56:39.250

断开方法可能需要以下增强。在这一个中，我们分别关闭 ResultSet、Statement 和 Connection。这将避免个别异常不会导致不关闭连接对象的情况。

```
public static void disconnect() throws RemoteException {
        try{
            if(rs != null) rs.close();
        }
        catch(SQLException sqlEx){
            System.out.println("Error: disconnect");
        }   

        try{
           if(stat != null) stat.close();
        }
        catch(SQLException sqlEx){
            System.out.println("Error: disconnect");
        }   

        try{
            if(cn != null) cn.close();
        }
        catch(SQLException sqlEx){
            System.out.println("Error: disconnect");
        }   
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T15:39:04.270

我认为您可以尝试以下几种选择：

*   如提供的评论中所示，您可以[增加允许的最大连接数](https://stackoverflow.com/a/1392333/1168372)。

*   你谈到了性能下降。如果这与打开的连接数有关，我建议您考虑重用您的连接。在这种情况下，使用连接池可能会有所帮助。[在这种情况下，这可能会有所帮助](https://stackoverflow.com/a/11376881/1168372)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T15:57:34.737

如果您使用的是数据库的开发人员版本，它可能对可以建立的连接数有限制。所以你需要更好地管理它们，这意味着你应该确保它们在完成后关闭。（**编辑**：刚刚意识到你正在使用 mysql，所以这应该不是问题）

此外，您提到您的调试器正在查看注释 - 这通常是您的代码与您的构建不同步的情况。清理你的构建（在 Eclipse 中它会是 Project > clean ... > clean all projects），这个问题应该会消失。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T16:58:26.460

通常，可供用户使用的连接数量有限。此外，建立连接是一项昂贵的操作。因此，如果您遇到性能问题，您应该开始使用连接池， [关于连接池的讨论](https://stackoverflow.com/questions/520585/connection-pooling-options-with-jdbc-dbcp-vs-c3p0)

关于您的代码，请确保您始终在 finally 块中释放连接。此外，我们不知道您运行什么样的查询。打印您的查询并尝试在 mysql 中手动运行它们，看看问题是否出在您的 SQL 上，而不是 Java 上。此外，您永远不会关闭 FileInputStream，这意味着您可能会用完文件处理程序。

如果您在循环中运行相同的语句，请考虑使用 PreparedStatements 以及批量更新和事务。如果您使用事务，请确保您没有太多处于未提交状态的数据。

如果要分析查询的性能，可以使用[JAMon (Java Application Monitor)](http://jamonapi.sourceforge.net/)

增加连接数的建议类似于建议腹泻患者多吃食物。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-05-13T12:01:47.153

试试这个

```
if(cn == null){
    String driver = "com.mysql.jdbc.Driver";
    Class.forName(driver);
    dbHost = "jdbc:mysql://"+dbHost;
    cn = DriverManager.getConnection(dbHost,dbUser,dbPassword);
} 
```

# php - 我可以使用 PHP 和 Apache 打印到我的打印机吗？

> ID：11564002
> 
> 赞同：0
> 
> 时间：2012-07-19T15:20:56.957
> 
> 标签：php, windows-7, printing

是否可以使用点阵打印机（EPSON FX-2175）以连续形式（纸张）打印？

例如，如果我有一个来自我的 mysql 数据库的表，我将如何在每页具有相同标题的连续表格纸上打印它？

我已经搜索了很多，但找不到答案。

如果这是不可能的，你能建议一些方法来做到这一点吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:53:31.100

如果您需要从网络应用程序打印某些内容（尽管我不完全确定您正在做什么），我建议您生成 PDF。查看[FPDF](http://www.fpdf.org/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T15:45:37.633

老实说，我会说你最好完全避免使用 PHP。

为什么不使用 MS Excel 之类的 ODBC 驱动程序。这拥有您所需要的所有打印支持。

# ruby - Ruby 的捆绑器版本不兼容

> ID：11564003
> 
> 赞同：1
> 
> 时间：2012-07-19T15:21:08.940
> 
> 标签：ruby, bundler

我什至对红宝石都不陌生。我必须让一个现有的应用程序运行，它用作 Java 应用程序的接口（我理解）。当我尝试获取所有依赖项（在 Linux Mint 上）时，我收到以下内容：

```
$ bundle install
Fetching gem metadata from http://rubygems.org/......
Fetching gem metadata from http://rubygems.org/..
Bundler could not find compatible versions for gem "bundler":
  In Gemfile:
    bundler (~> 1.0.0) ruby

  Current Bundler version:
    bundler (1.1.5)

This Gemfile requires a different version of Bundler.
Perhaps you need to update Bundler by running `gem install bundler`? 
```

我尝试了“gem install bundler”，但这没有用。我尝试安装bundler 1.0.0，使用：

```
$ sudo gem install bundler -v 1.0.0
Successfully installed bundler-1.0.0
1 gem installed
Installing ri documentation for bundler-1.0.0...
Installing RDoc documentation for bundler-1.0.0... 
```

这似乎奏效了，但我无法“切换”到它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T20:16:49.357

您可以通过在命令后指定用下划线 ( ) 括起来的版本来指定要使用的 Gem 可执行文件的版本`_`，例如

```
a_gem_executable _1.2.3_ other args 
```

所以为了专门运行 1.0.0 版的 bundler，试试这个：

```
bundle _1.0.0_ install 
```

当我尝试使用 1.0.0 时，bundler 抛出异常，因此您可能想尝试使用仍然与说明符兼容的更新版本`~> 1.0.0`：

```
gem install bundler -v 1.0.18
bundle _1.0.18_ install 
```

在 Gemfile 中指定 bundler 本身确实让我觉得有点不寻常，您也许可以删除该行作为更简单的替代方案。

# asp.net-mvc-3 - 自动回发时保存表单

> ID：11564005
> 
> 赞同：0
> 
> 时间：2012-07-19T15:21:30.153
> 
> 标签：asp.net-mvc-3, asp.net-mvc-3-areas

我对 MVC3 很陌生。在我的视图页面中，我有一个下拉列表和一些字段数据，方式如下。

看法：-

```
 //dropdownlist data
 @Html.DropDownList("Category", new SelectList(categoriesList, selectedCategory), "Select One", new { onchange = "this.form.submit();" })

  @Html.EditorFor(model => model.Name)
  @Html.ValidationMessageFor(model => model.Name)

  <input type="submit" name="Create" value="Create" /> 
```

这里提交按钮和下拉控件都提交表单我想知道控制器如何识别调用是通过提交按钮而不是从下拉列表中发生的。非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:24:28.410

中没有`AutoPostback`概念`ASP.NET MVC`。自动回发是`WebForms`.

ASP.NET MVC 使用普通表单发布。因此，当通过单击提交按钮发布表单时，您的控制器操作将获取值。

您总是可以编写一些 javascript 代码来监听`change`下拉事件和表单提交。所以在你的情况下，它是`onchange`调用`form.submit`方法的事件

# php - 在 Wordpress 页面中使用 reCaptcha

> ID：11564006
> 
> 赞同：0
> 
> 时间：2012-07-19T15:21:30.843
> 
> 标签：php

总而言之，我在 Wordpress 中创建了一个页面，以允许某些人向我提交一些反馈。在我的页面上，我有以下代码来包含 reCaptcha：

```
<?php
require_once('http://localhost/website/recaptchalib.php');
$publickey = "12345"; // you got this from the signup page
?> 
```

然后我想要显示 reCaptcha 的地方有以下代码：

```
 <?php echo recaptcha_get_html($publickey); ?><div id="captchaStatus"></div> 
```

但是，当我尝试显示此页面时，我从 Wordpress 收到以下错误消息：

```
致命错误：调用未定义函数 recaptcha_get_html()
```

有没有更好的方法在 Wordpress 页面上包含 reCaptcha？我知道有一个 reCaptcha 插件，但我相信这仅适用于带有评论的页面，这不是我需要的。

我是否需要不将其作为链接包含在内，而是将其包含为 recaptcha 页面的路径？如果是这样，我该如何从 Wordpress 中的页面到我的基本文件夹执行此操作？

任何意见是极大的赞赏。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:28:54.353

不确定您是否出于示例目的以这种方式编写了它，但是您的`require_once`调用正在使用 http 请求来尝试包含 from，因此我认为您的 lib 不会被正确包含。

`.php`尝试使用您要包含的文件的正确文件路径，即`local/path/to/file.php`.

包含路径将在磁盘上查找本地文件——而不是与文件建立 http 连接。

供参考：[http ://www.php.net/manual/en/ini.core.php#ini.include-path](http://www.php.net/manual/en/ini.core.php#ini.include-path)

我相信 Wordpress 指定了一个`ABSPATH`常量`wp-config.php`，您可以使用它来获取 WP 安装的根路径。

# c# - DataFormatString 仅在需要时用于带小数的百分比？

> ID：11564008
> 
> 赞同：2
> 
> 时间：2012-07-19T15:21:44.217
> 
> 标签：c#, asp.net-mvc, formatting, string-formatting

我正在尝试在带有 MVC 的 EF 代码优先属性上使用这些：http: [//msdn.microsoft.com/en-us/library/0c899ak8.aspx](http://msdn.microsoft.com/en-us/library/0c899ak8.aspx)

具体来说：

```
[DisplayFormat(DataFormatString="##.##%")]
public double? PercentOfSomething {get;set;} 
```

**如何让 .2345 显示为 23.45% 和 .2 显示为 20%** 换句话说，只显示小数点，最多两位，如果有的话。

就像现在一样，它只显示格式字符串“##.##%”。我猜可能 DisplayFormat 属性不支持这些类型的格式字符串。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-19T15:26:49.863

我认为你应该使用 "{0:##.##%}" 而不仅仅是 ##.##%

# c# - 将文本框值传递给 sql 语句

> ID：11564011
> 
> 赞同：0
> 
> 时间：2012-07-19T15:21:52.703
> 
> 标签：c#, sql

我需要根据从一个表单到方法表单的两个文本框的值来显示数据。

下面是我提取我的两个值的代码，它们工作正常：

```
txtfrom.Text = dtResults.Rows[0]["asset_open_per"].ToString();

this.txtto.Text = DateTime.Today.ToString("yyyyMM"); 
```

现在我有我的两个值，我将需要这些作为 sql 语句中的 where 子句，sql 语句如下：

```
public static DataTable GetPostings2(string AssetNumberV, string PeriodFromV, string PeriodToV)

        {

       DataTable dtGetPostings2;

        try

          {

           dtGetPostings2 = new DataTable("GetPostings");

   SqlParameter AssetNumber = new SqlParameter("@AssetNumber", SqlDbType.VarChar, 6);
   AssetNumber.Value = AssetNumberV;

   SqlParameter PeriodFrom = new SqlParameter("@PeriodFrom", SqlDbType.VarChar, 6);
   PeriodFrom.Value = txtfrom; 

   SqlParameter PeriodTo = new SqlParameter("@PeriodTo", SqlDbType.VarChar, 6);
   PeriodTo.Value = frmAsset.txtto; 

 SqlCommand scGetPostings2 = new SqlCommand("SELECT * FROM [POSTING] WHERE [ASSET_NO] = @AssetNumber And PERIOD >= @PeriodFrom AND PERIOD <= @PeriodTo ORDER by PERIOD, JOUR_REF, JOUR_LINE", DataAccess.AssetConnection);

               scGetPostings2.Parameters.Add(AssetNumber);
               scGetPostings2.Parameters.Add(PeriodFrom);
               scGetPostings2.Parameters.Add(PeriodTo); 

               SqlDataAdapter sdaGetPostings2 = new SqlDataAdapter();
               sdaGetPostings2.SelectCommand = scGetPostings2;
               sdaGetPostings2.Fill(dtGetPostings2);

               return dtGetPostings2;
        } 
```

我得到的错误是：

> 非静态字段、方法或属性“Assets.frmAssetPostings.txtto”需要对象引用

其他 texbox 也一样..

我已将文本框的属性更改为公共等，是否有另一种解决方案可以实现这一点。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:32:05.710

您是否尝试过先在表单中执行 SQL，然后尝试从 app.cofig 执行

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T15:32:18.123

好吧，您已经在 GetPostings2 中传递了参数的值，为什么不使用它们而不是 frmAsset 的文本框呢？

```
 scGetPostings2.Parameters.AddWithValue("@AssetNumber", AssetNumberV); 
           scGetPostings2.Parameters.AddWithValue("@PeriodFrom", PeriodFromV); 
           scGetPostings2.Parameters.AddWithValue("@PeriodTo", PeriodToV); 
```

顺便说一句，您会收到错误消息，因为 GetPostings2 是一个静态方法，在此方法中您不能像 frmAsset 表单那样引用实例外部对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T15:26:56.660

`this.txtto.Text`我假设是一个 Texbox，但您 `PeriodTo.Value = frmAsset.txtto;` 在 GetPostings2 方法中使用它

您将需要以这种方式使用它`frmAsset.txtto.Text; and frmAsset.txtfrom.Text;`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T15:25:17.213

您需要使用 TextBoxes 的 Text 属性，而不是尝试将 TextBox 对象分配给我们的 Sql 参数。

```
SqlParameter AssetNumber = new SqlParameter("@AssetNumber", SqlDbType.VarChar, 6);     
AssetNumber.Value = AssetNumberV.Text; 
```

对您从中读取值的其余文本框执行相同操作。

# drupal - 致命错误：调用未定义函数 lock_acquire()

> ID：11564017
> 
> 赞同：1
> 
> 时间：2012-07-19T15:22:08.563
> 
> 标签：drupal, drupal-6, drupal-modules

我正在使用 Drupal 6.25 版。

我复制了一个现有的 drupal 页面并尝试在我的系统上本地安装它。
在我输入数据库信息的步骤之后，我收到了这个致命错误：

> 致命错误：调用未定义函数 lock_acquire()

它似乎位于：

> 第 810 行的 modules/system/system.module

但不幸的是，我不知道如何解决它。

希望你们中的某个人知道如何解决它，因为我不能再进一步了，我需要在本地进行此复制。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-20T16:48:18.333

在 PHP 的顶部`system.module`添加：

```
include_once './includes/lock.inc'; 
```

然后运行`update.php`并清除缓存。

# c# - 母版页中的表单未提交

> ID：11564018
> 
> 赞同：0
> 
> 时间：2012-07-19T15:22:10.083
> 
> 标签：c#, asp.net

我正在研究 asp.net 应用程序。在我的应用程序的母版页中，我有一个侧边栏 div。我在其中插入了一个订阅表格，如下所示：

```
<form method="post" action="https://app.icontact.com/icp/signup.php" name="icpsignup" id="icpsignup3297" accept-charset="UTF-8" onsubmit="return verifyRequired3297();" >
   ...
   <input type="submit" name="Submit" value="Get Deals">
<form> 
```

在按钮单击时调用的 javascript 函数如下所示：

```
<script type="text/javascript">

    var icpForm3297 = document.getElementById('icpsignup3297');

    if (document.location.protocol === "https:")
        icpForm3297.action = "https://app.icontact.com/icp/signup.php";

    function verifyRequired3297() {  
        alert('testing');     
        if (icpForm3297["fields_email"].value == "") {
            icpForm3297["fields_email"].focus();
            alert("The Email field is required.");
            return false;
        }
        return true;
    }
</script> 
```

当我点击提交按钮时，页面重新加载但表单未重定向到其他页面（重定向 url）是因为代码在母版页中吗？甚至没有显示测试警报。

如果我在没有母版页的新 asp.net 页面中使用此代码，它会完美运行

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T08:04:42.413

根据OP的问题评论...

具有嵌套`<form>`标签（无论它们是否标记为`runat="server"`）都是无效的 HTML。例如，这是不允许的，并且会失败......

```
<form>
  ...
  <form>
    ...
  </form>
  ...
</form> 
```

我唯一能想到的就是下面的事情......

*   `<form>`在主要问题之外，根据您的问题创建一个新的`<form runat="server">`
*   使用您需要传递`<form>`的所有字段填充新字段`<input type="hidden">`
*   从原始位置移除`<form>`标签，留下用户将要使用的控件/布局
*   `onclick="submitMyForm();return false;"`在原始按钮上设置一个处理程序`<input type="submit">`（或将其替换为普通按钮 - 基于 HTML 或 ASP.NET - 并将处理程序设置为该按钮）
*   创建要调用的 JavaScript 函数

javascript函数可能看起来像这样......

```
function submitMyForm(){
  document.getElementById("myNewFormCtrl1").value = 
    document.getElementById("<%=myOldFormCtrl1.ClientId%>").value;
  ...
  document.getElementById("myNewForm").submit();
} 
```

请记住，`<input type="hidden">`必须给定一个`name`属性，该属性将传递给接收表单的页面。您还必须给它一个`id`属性，该属性将由`getElementById`函数中使用。这些不必*相同*，因此我建议您将其设置`id`为明显且独特的内容。

如果有人有更好、更简单、更清洁的解决方案 - 我真的很想看到它，因为我认为上述内容不是很好，但应该可以。

# c# - 网格视图中的“自动对比”文本颜色？

> ID：11564021
> 
> 赞同：0
> 
> 时间：2012-07-19T15:22:13.653
> 
> 标签：c#, c#-4.0, devexpress

我有一个（DevExpress）GridView，我使用它根据某些标准以编程方式设置背景和文本颜色。在某些情况下，背景和文本颜色非常相似，导致文本难以阅读。确保两种颜色之间始终存在对比的最佳方法是什么？有没有办法使用 DevExpress 控件自动执行此操作？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T20:15:44.863

也许像这样

```
 private Color GetContrastedColor(Color colorToContrast) {

        var yiq = ((colorToContrast.R * 299) + (
            colorToContrast.G * 587) + (
            colorToContrast.B * 114)) / 1000;

        return (yiq >= 128) ? Color.FromArgb(40, 40, 40) : Color.WhiteSmoke;
    } 
```

# java - 当油漆设置为填充时，canvas.drawPath 什么都不画？

> ID：11564025
> 
> 赞同：0
> 
> 时间：2012-07-19T15:22:22.813
> 
> 标签：java, android, android-canvas

我正在尝试使用在画布上绘制三角形，`drawPath()`但在填充三角形时遇到问题。如果我将油漆设置为，则以下代码将绘制一个三角形，`STROKE`但当它设置为时，`FILL`它不会绘制任何东西。我在这里做错了什么吗？

```
 labelArrowBox.reset();

    labelArrowBox.moveTo(labelPosition.x, labelPosition.y);

    float x = labelPosition.x + LABEL_BOX_ARROW_WIDTH / 2;
    float y = labelPosition.y - LABEL_BOX_ARROW_HEIGHT;
    labelArrowBox.lineTo(x, y);
    labelArrowBox.moveTo(x, y);

    x = labelPosition.x - LABEL_BOX_ARROW_WIDTH / 2;
    labelArrowBox.lineTo(x, y);
    labelArrowBox.moveTo(x, y);

    labelArrowBox.lineTo(labelPosition.x, labelPosition.y);
    labelArrowBox.moveTo(labelPosition.x, labelPosition.y);

    labelArrowBox.close();

    Paint arrowBorderPaint = new Paint();
    arrowBorderPaint.setAntiAlias(true);
    arrowBorderPaint.setDither(true);
    arrowBorderPaint.setColor(getContext().getResources().getColor(R.color.leaf_thin_ring));
    arrowBorderPaint.setStyle(Paint.Style.FILL);

    canvas.drawPath(labelArrowBox, arrowBorderPaint); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-16T15:37:41.067

我找到了解决方案。删除`moveTo()`你只`lineTo()` 需要你不需要这些行：`labelArrowBox.moveTo(x, y);`

# visual-studio-2010 - 开始调试和附加到进程有什么区别

> ID：11564026
> 
> 赞同：4
> 
> 时间：2012-07-19T15:22:25.123
> 
> 标签：visual-studio-2010, debugging, iis-7, worker-process

当我将项目附加到我的 w3wp.exe IIS 工作进程时，我的项目加载速度比“开始调试”时快得多。

但是，无论我“开始调试”还是“附加到进程”，同一个工作进程似乎正在处理相同数量的模块/DLL (w3wp.exe)。

为什么附加到流程的速度如此之快？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T15:30:25.307

“开始调试”启动可执行文件的新实例，并从一开始就附加调试器，因此所有需要的调试器调用的开销都是从启动时产生的，而“附加到进程”附加到已经运行的进程，所以在那之前您的进程正在运行，没有任何由调试引起的额外开销。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T15:29:24.783

没有调试的代码执行得更快。当您附加应用程序已经启动的进程时，池会启动，因此您不会在调试模式下执行一些繁重的操作，例如 Application_OnStart 事件和其他一些。

# sql - 奇怪的动态 SQL 错误

> ID：11564038
> 
> 赞同：1
> 
> 时间：2012-07-19T15:23:15.503
> 
> 标签：sql, sql-server-2008, dynamic-sql

全部，我有以下动态 SQL 查询

```
DECLARE @TableName NVARCHAR(255);
SET @TableName = 'BadCodesErrSumm';
DECLARE @DropSql NVARCHAR(MAX);
SET @DropSql = 
    'IF EXISTS (SELECT *  
                FROM Report.sys.objects 
                WHERE name = ''' + @TableName + ''' AND type = ''U'') 
     DROP TABLE [IPAReport]..[' + @TableName + '];'
PRINT @DropSql;
EXEC @DropSql; 
```

这会产生以下错误

```
Msg 203, Level 16, State 2, Line 11
The name 'IF EXISTS (SELECT *  
                FROM Report.sys.objects 
                WHERE name = 'BadCodesErrSumm' AND type = 'U') 
          DROP TABLE [Report]..[BadCodesErrSumm];' is not a valid identifier. 
```

但是，打印输出

```
IF EXISTS (SELECT *  
           FROM Report.sys.objects 
           WHERE name = 'BadCodesErrSumm' AND type = 'U') 
DROP TABLE [Report]..[BadCodesErrSumm]; 
```

执行良好。**我错过了什么？**

谢谢你的时间。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T15:25:22.480

采用

```
EXEC sp_executesql @DropSql; 
```

或者

```
EXEC(@DropSql); 
```

也就是说，有几个建议：

```
DECLARE @TableName NVARCHAR(255);

SET @TableName = N'BadCodesErrSumm';      -- always use N prefix on Unicode strings

DECLARE @DropSql NVARCHAR(MAX);

SET @DropSql = N'IF EXISTS (SELECT 1      -- again, N prefix
                FROM IPAReport.sys.tables -- use sys.tables to avoid 'U' check
                WHERE name = @TableName)  -- use a proper parameter
     DROP TABLE [IPAReport]..' 
       + QUOTENAME(@TableName) + ';'      -- QUOTENAME is safer as @GSerg pointed out

PRINT @DropSql;

EXEC sp_executesql @DropSql, N'@TableName NVARCHAR(255)', @TableName; 
```

# java - 我在 java 中连接到 Postgres 数据库时出错

> ID：11564039
> 
> 赞同：1
> 
> 时间：2012-07-19T15:23:17.900
> 
> 标签：java, postgresql

我尝试在 Netbeans 7.0 中连接 Postgres postgresql-9.1-902.jdbc4 数据库，但在 Java 中出现此错误：

```
jul 19, 2012 9:35:02 AM databasedesktop.DatabaseDesktopApp startup
Grave: null
org.postgresql.util.PSQLException: El intento de conexión falló.
    at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:150)
    at org.postgresql.core.ConnectionFactory.openConnection(ConnectionFactory.java:64)
    at org.postgresql.jdbc2.AbstractJdbc2Connection.<init>(AbstractJdbc2Connection.java:123)
    at org.postgresql.jdbc3.AbstractJdbc3Connection.<init>(AbstractJdbc3Connection.java:28)
    at org.postgresql.jdbc3g.AbstractJdbc3gConnection.<init>(AbstractJdbc3gConnection.java:20)
    at org.postgresql.jdbc4.AbstractJdbc4Connection.<init>(AbstractJdbc4Connection.java:30)
    at org.postgresql.jdbc4.Jdbc4Connection.<init>(Jdbc4Connection.java:22)
    at org.postgresql.Driver.makeConnection(Driver.java:391)
    at org.postgresql.Driver.connect(Driver.java:265)
    at java.sql.DriverManager.getConnection(DriverManager.java:579)
    at java.sql.DriverManager.getConnection(DriverManager.java:221)
    at databasedesktop.DatabaseDesktop.initDatabasePostgre(DatabaseDesktop.java:45)
    at databasedesktop.DatabaseDesktop.<init>(DatabaseDesktop.java:56)
    at databasedesktop.DatabaseDesktopApp.startup(DatabaseDesktopApp.java:22)
    at org.jdesktop.application.Application$1.run(Application.java:171)
    at java.awt.event.InvocationEvent.dispatch(InvocationEvent.java:251)
    at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:705)
    at java.awt.EventQueue.access$000(EventQueue.java:101)
    at java.awt.EventQueue$3.run(EventQueue.java:666)
    at java.awt.EventQueue$3.run(EventQueue.java:664)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
    at java.awt.EventQueue.dispatchEvent(EventQueue.java:675)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:211)
    at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:128)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:117)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:113)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:105)
    at java.awt.EventDispatchThread.run(EventDispatchThread.java:90)
Caused by: java.net.SocketException: Can't connect to SOCKS proxy:No route to host: connect
    at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:427)
    at java.net.Socket.connect(Socket.java:578)
    at java.net.Socket.connect(Socket.java:527)
    at java.net.Socket.<init>(Socket.java:424)
    at java.net.Socket.<init>(Socket.java:207)
    at org.postgresql.core.PGStream.<init>(PGStream.java:60)
    at org.postgresql.core.v3.ConnectionFactoryImpl.openConnectionImpl(ConnectionFactoryImpl.java:74)
    ... 28 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T02:26:22.567

您似乎正在尝试使用`SOCKS`未运行或无法访问的代理。

```
Caused by: java.net.SocketException: Can't connect to SOCKS proxy:No route to host: connect 
```

确保代理实际正在运行，并且可以访问 PostgreSQL 服务器。尝试使用`psql`通过您的 SOCKS 代理连接到 PostgreSQL 服务器以验证是否有效 - 假设您打算通过代理连接。

您是否设置了`socksProxyHost`和`socksProxyPort`系统属性，也许是通过 java 命令行？请参阅[有关代理的 Java 文档](http://docs.oracle.com/javase/6/docs/technotes/guides/net/proxies.html)。

您是否为 JDBC 连接指定代理？

# jquery - 如何将两个选择框设置为与默认值相同的选项值

> ID：11564041
> 
> 赞同：0
> 
> 时间：2012-07-19T15:23:22.803
> 
> 标签：jquery, html

我在同一个字段集中有 2 个选择框。我正在使用 jquery 添加一个选项，我希望它们都具有相同的默认值。

```
$(function(){
    var selectbox = $('.selectbox select');
    selectbox.prepend('<option value="Select a question" selected="selected">Select a question</option>');
    selectbox.children('option').each(function() {
        var option = $(this);
        option.removeAttr('disabled');
    });
}); 
```

我什至尝试删除它设置的禁用属性，但我似乎无法弄清楚为什么它将第二个选择框设置为禁用该选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:24:34.783

您必须`prepend`选择每个`select`using`.each()`循环，如下所示：

```
var selectbox = $('.selectbox select');
selectbox.each(function() {
    $(this).prepend('<option value="Select a question" selected="selected">Select a question</option>');
}); 
```

您的代码添加`option`到一个`select`. 而且你不需要`disable`他们的`prepend`目的。

***[演示](http://jsfiddle.net/QStkd/643/)***

### 笔记

如果你`option`有`disabled`属性，我认为这对上面的代码不会有任何问题。**[看这里](http://jsfiddle.net/QStkd/644/)**。

并从您可以做的所有事情中删除`disabled`属性：`option`

```
var selectbox = $('.selectbox select');
selectbox.each(function() {
    $(this).find('option').removeAttr('disabled'); // remove disabled attr
    $(this).prepend('<option value="Select a question" selected="selected">Select a question</option>');
}); 
```

***[演示](http://jsfiddle.net/QStkd/646/)***

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T15:28:40.613

这可以通过找到选择菜单，然后添加选项元素，然后找到第一个选项并将其设置为选中来完成：

```
$('.selectbox select')
  .prepend('<option value="Select a question" selected="selected">Select a question</option>')
  .find('option:first-child').attr('selected', 'selected');​ 
```

# android - 带有按钮的 Android XML 布局

> ID：11564048
> 
> 赞同：0
> 
> 时间：2012-07-19T15:23:35.393
> 
> 标签：android, xml, android-layout

我以为我理解 XML。

```
<?xml version="1.0" encoding="utf-8"?> 
```

```
<Button
    android:id="@+id/button1"
    android:layout_width="109dp"
    android:layout_height="wrap_content"
    android:layout_gravity="left"
    android:clickable="true"
    android:onClick="closelog"
    android:text="@string/close"
     />

 <Button
    android:id="@+id/sendLogButton"
    android:layout_width="109dp"
    android:layout_height="wrap_content"
    android:layout_gravity="right"
    android:clickable="true"
    android:onClick="sendLog"
    android:text="@string/sendLog" />

<ListView
    android:id="@+id/loglist"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" >
</ListView> 
```

我的按钮在布局上的位置不正确。有人可以向我解释为什么当我的两个按钮都是相同相对布局的孩子时，它们不能占据相同的水平行。 ![在此处输入图像描述](../Images/c059603c8de8ebe79bb2d6860d0c16a1.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T15:27:02.967

您需要将按钮包装在相对布局中，然后使用属性 like`android:layout_toRightOf="@id/anid`和`android:layout_toLeftOf="@id/anid`将按钮对齐到您的喜好。您还需要删除`layout_gravity`.

有关在 XML 中对齐元素的更多详细信息，请参阅这篇[文章](https://stackoverflow.com/questions/4305564/android-layout-right-align)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T15:28:44.260

因为

```
android:layout_gravity="left" 
```

和

```
android:layout_gravity="right" 
```

您必须以线性布局或相对布局包装 2 个按钮

# c++ - C++ 从全局静态函数中引用对象

> ID：11564053
> 
> 赞同：0
> 
> 时间：2012-07-19T15:23:45.023
> 
> 标签：c++

我有一个全局声明的静态函数需要引用一个对象，但是当我这样做时，我得到一个“未声明的标识符”错误。

这是我的代码示例

```
#pragma once

#include "stdafx.h"
#include <vector>
#include "Trigger.h"

using namespace std;

namespace Gamma_Globals
{
    static vector<void*> gvTriggers;
}

static LPARAM CALLBACK ProgramWndProc(HWND, UINT, WPARAM, LPARAM);

static LPARAM CALLBACK ProgramWndProc(HWND hWnd, UINT uMsg, WPARAM wParam, LPARAM lParam)
{
    switch (uMsg)
    {
    case WM_KEYUP:
        {
            for (int i = 0; i < Gamma_Globals::gvTriggers.size(); i++)
            {
                Trigger t = Gamma_Globals::gvTriggers[i];
            }
        }
    default: return DefWindowProc(hWnd, uMsg, wParam, lParam); break;
    }

    return 0;
} 
```

问题出现在 WM_KEYUP 案例中，当我尝试设置“触发器 t”时，我收到错误“'触发器'：未声明的标识符。” 如何从 ProgramWndProc 引用 Trigger 对象？

谢谢！

* * *

根据要求，这是 Trigger.h 的副本

```
#pragma once

#include "Noun.h"
#include "TermFactory.h"
#include "Globals.h"

using namespace std;

class Trigger
{
public:
    enum   TRIGGER_TYPE {NONE, ONKEYPRESS, ONMOUSEPRESS};

    Trigger(void*);
    Trigger(LPTSTR trigger, LPTSTR action, Gamma_Globals::TRIGGER_TIME);
    ~Trigger(void);

    VOID Perform();

    TRIGGER_TYPE GetType();

private:
    LPTSTR        lpCondition;
    LPTSTR        lpAction;
    Gamma_Globals::TRIGGER_TIME triggerTime;
    vector<Noun*> vNouns;
    TRIGGER_TYPE  triggerType;

    VOID LoadAction(LPTSTR Action);
    HRESULT LoadCondition(LPTSTR Condition);
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:15:49.203

您的 trigger.h 包括 globals.h。globals.h 又包括 trigger.h。所以在编译 globals.h 时，编译器并没有看到 Class Trigger。

理想情况下，您的代码中不应存在任何循环依赖。任一 trigger.h 将取决于 globals.h 或相反而不是两者。

要编译它，您可以创建 global.cpp 并将函数定义放在那里。请注意，这不会破坏循环依赖。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T16:15:43.397

您尝试将 void* 分配给触发器类型的 t。

因为 Trigger 的 ctor 接受 void* 尝试：

```
for (int i = 0; i < Gamma_Globals::gvTriggers.size(); i++)
{
    Trigger t( Gamma_Globals::gvTriggers[i] );
} 
```

# vb.net - 为什么我的输出中会出现额外的“-”字符？

> ID：11564057
> 
> 赞同：1
> 
> 时间：2012-07-19T15:24:03.380
> 
> 标签：vb.net, winforms

我正在尝试创建一个 yahoo messenger 自动回复应用程序。如果我使用按钮来检索它，我可以检索新消息，但是如果我使用计时器来获取新消息，它会向我显示带有额外标记的新消息。这是错误。

![错误](../Images/3dd5137a6f7b39db53a141de319b132e.png)

这是代码：

```
Private Sub Pause(ByVal seconds As Integer)
    Dim current As Date

    current = DateTime.Now
    Do While (DateTime.Now - current).TotalSeconds < seconds
        Application.DoEvents()
        Threading.Thread.Sleep(1000)
    Loop
End Sub

Private Sub Timer1_Tick(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Timer1.Tick
    Dim keyword As String = ""
    Dim arrKeyword() As String
    Dim param As String = ""

    ymVersion = getYMVersion()
    Select Case ymVersion
        Case "8"
        hwndYMMainClass = FindWindow("YSearchMenuWndClass", vbNullString)
        Case "9"
            hwndYMMainClass = FindWindow("ATL:007C07F0", vbNullString)
        Case "10"
            hwndYMMainClass = FindWindow("CConvWndBase", vbNullString)
    End Select

    If hwndYMMainClass <> 0 Then
        pause(1)
        ymid = getYMID(hwndYMMainClass)
        msg = getYMMessage(hwndYMMainClass)
        lstBox.Items.Add(ymid + "-" + msg)
        ymChatSend(hwndYMMainClass, "Telah terima")
        closeYM(hwndYMMainClass)
    End If
End Sub 
```

顺便说一句，我使用了一个间隔为 500 的计时器。哪里是显示额外的错误 - 不是应该的？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T16:22:09.000

问题是你的 Pauses()。任何使用 DoEvents() 总是值得怀疑的，但在这里你是在计时器滴答事件期间这样做的，这尤其成问题——你很幸运没有看到 StackOverflow 异常。

这是发生了什么：当您调用 Pause() 时，程序进入一个循环以交替休眠和处理其他事件。如果还有其他事件要处理，就像直接在当前执行路径上调用该方法一样。由于您有一个定期将新事件放入消息队列的计时器，因此您的计时器滴答处理程序可以间接地以递归函数的形式结束并调用自身。如果您不小心，您会发现这比事件完成的速度更快：tick 处理程序运行，它调用 Pause()，Pause() 调用 DoEvents()，DoEvents() 再次调用 tick 处理程序，然后超过。关闭 Yahoo 的代码永远不会到达，并且您最终会添加到调用堆栈中，直到它已满（溢出）并且程序崩溃。

值得庆幸的是，这并没有发生在这里。这些症状表明您的 tick 方法确实会自行递归，但它只会重复一次。事件触发，它到达对 DoEvents() 的调用，该调用在同一执行路径中再次运行滴答事件。这次事件一直处理（Pause() 在引发另一个滴答事件之前完成）并完成它应该做的一切。现在原始事件可以完成处理，只是没有消息可以读取了。剩下的就是用“-”字符连接两个空字符串，**这就是你的额外输出。**

就个人而言，我会重写以避免使用 DoEvents()，但*为了快速修复，请尝试在滴答事件的第一行禁用计时器并在滴答事件的最后一行重新启用它。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T15:55:51.597

> 我意识到太晚了！;-) ，问题是由于 listbox.items.add() 由于“System.DoEvents()”而执行了两次

我建议您对代码进行以下更改，请告知他们是否解决了您的问题。

**由此：**

```
 ymid = getYMID(hwndYMMainClass)
 msg = getYMMessage(hwndYMMainClass)
 lstBox.Items.Add(ymid + "-" + msg) 
```

**对此：**

```
 ymid = getYMID(hwndYMMainClass)
 msg = getYMMessage(hwndYMMainClass)
 lstBox.Items.Add(cstr(ymid) & "-" & cstr(msg)) 
```

如果这不能解决您的问题，我很确定作为消息出现的任何内容末尾都有一个尾随“-”，如果您获得的每个列表条目都以额外的“-”行结束，那么请尝试使用如果确实找到“-”，则删除最后一个字符。

**从 msg 中删除尾随的“-”：**

```
Dim holdMsg as String = vbnullstring 'I'm not sure if msg is of type String...

     ymid = getYMID(hwndYMMainClass)
     msg = getYMMessage(hwndYMMainClass)
     holdMsg = cstr(msg)

        If holdMsg.Last = "-" Then
            'Remove that char from the string
            holdMsg = holdMsg.Substring(0, holdMsg.Length - 1)
            lstBox.Items.Add(cstr(ymid) & "-" & holdMsg)
        End If 
```

# php - imagejpeg 保存文件不起作用

> ID：11564058
> 
> 赞同：4
> 
> 时间：2012-07-19T15:24:04.643
> 
> 标签：php, jpeg

我设法在浏览器上显示图像，但我无法使用 imagejpeg 保存它（我没有看到任何保存在服务器中的图像）。我已经尝试了几个小时，并且还使用 is_writable 测试了该文件夹，正如其他人询问的这篇文章中提到的那样[PHP imagejpeg 保存文件不起作用](https://stackoverflow.com/questions/6672965/php-imagejpeg-save-file-doesnt-work)。但它仍然不起作用，在 chrome 上，除了损坏的图像图标外，我没有看到任何错误，但在 IE 上，它显示如下错误“**警告**：imagejpeg() [function.imagejpeg]：无法打开”文件是不可写

这是我的代码。

```
header('Content-type: image/jpeg');
$filename = 'little.jpg';
 $im = imagecreatefromjpeg($filename); 
imagefilter($im, IMG_FILTER_CONTRAST,$_POST["amount"]);

imagejpeg($im,"test.jpg");   

imagedestroy($im); 

if (is_writable('test.jpg')) {
    echo 'The file is writable';
} else {
    echo 'The file is not writable';
} 
```

任何人都可以帮忙，好吗？谢谢你。PS：我也想在浏览器上显示图片，同时保存图片。imagejpeg 能做到吗？如果没有，有更好的方法吗？谢谢你。

编辑：当我检查我的文件夹是否可写时，它回显“文件可写”，但是当我检查 test.jpg 是否可写时，它回显“文件不可写”。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T15:31:09.410

该错误表明您的 PHP 脚本无权写入服务器上的该位置。使用您的 FTP 软件进行 CHMOD（更改权限）以允许写入您尝试存储这些内容的目录。除非您的网络主机完全禁止 PHP 在本地写入文件（在这种情况下，您应该与他们交谈）并查看可用的选项）。

# database - Postgres声称驱动器空间不足，可用空间充足

> ID：11564060
> 
> 赞同：3
> 
> 时间：2012-07-19T15:24:15.820
> 
> 标签：database, postgresql, amazon-ec2, hard-drive

我对 Postgres 比较陌生，但是我遇到了一个奇怪的错误，而且谷歌搜索没有发现任何东西。

我创建了两个（相对较大的）表，每个表大约有 2 亿行。第一个有 4 行，第二个有 3 行。他们每个人都在每一列中存储varchars。

我试图通过连接两个表并选择三个结果列来创建第三个表。查询是：

```
create table table_C as 
(select table_A.id as id, table_A.predicate, table_B.object as type 
from table_A join table_B on 
table_A.subject = table_B.subject); 
```

查询运行了大约 10 个小时，然后中止说

```
ERROR:  could not extend file "base/446695/504075.302": No space left on device
HINT:  Check free disk space. 
```

我在一个具有 64GB 内存的 Amazon EC2 实例上运行它，我的数据库存储在一个有大约 500GB 空闲空间的卷上。我意识到生成的表应该很大，但原来的两个表只占用不到 100GB，所以如果一个有两列的表占用了 5 倍以上的空间，那就太奇怪了。我已经尝试了大约 4 次，并尝试重新启动实例。

我仔细检查了数据目录和 pg_stats_tmp 文件是否都指向了正确的卷。（postgres.conf 中的“data_dir”和“pg_stat_tmp”设置）。

有什么想法吗？是否有其他一些临时文件可能在某处膨胀（根卷有超过 150GB 的可用空间）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:26:29.133

如果主题重复，则连接将重复行组合。

例如

表格1

1.  主题1
2.  主题1
3.  主题1
4.  主题2

表2

1.  主题1
2.  主题1
3.  主题2
4.  主题2

结果将是 Subject1 的 6 小时和 Subject2 的 2 行（总共 8 行）

在最极端的情况下——主题完全一样——你会得到 2 亿 * 2 亿行。

我觉得是这个原因...

# objective-c - Objective-C Box 2.0 文件上传 - 问题

> ID：11564069
> 
> 赞同：3
> 
> 时间：2012-07-19T15:24:39.937
> 
> 标签：objective-c, box-api

在过去的几天里，我一直在尝试使用 Box 进行文件上传。我知道我做错了什么，但就是看不到它是什么。

我已经尽可能地减少了我的代码，就这样：

```
// Configure the request
NSMutableURLRequest *request = [[NSMutableURLRequest alloc] init];
[request setURL:[NSURL URLWithString:@"https://api.box.com/2.0/files/data"]];
[request setHTTPMethod:@"POST"];

[request setValue:boxAuthString forHTTPHeaderField:@"Authorization"];

// Setu up the request
NSString *boundary = [NSString stringWithString:@"--PLEASEHELPMEGETTHISWORKING"];
NSString *contentType = [NSString stringWithFormat:@"multipart/form-data; boundary=%@\r\n",boundary];
[request addValue:contentType forHTTPHeaderField: @"Content-Type"];

NSMutableData *body = [NSMutableData data];

// Add the info and data for the file.
[body appendData:[[NSString stringWithFormat:@"--%@\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[[NSString stringWithString:@"Content-Disposition:form-data;name=\"filename\";filename=\"testfile.txt\"\r\n"]
                      dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[[NSString stringWithString:@"Content-Type:text/plain\r\n\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[[NSString stringWithString:@"Hello"] dataUsingEncoding:NSUTF8StringEncoding]];

// Add the info and data for the target folder. 
[body appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[[NSString stringWithString:@"Content-Disposition:form-data;name=\"folder_id\"\r\n\r\n"]
                  dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[[NSString stringWithString:@"0"] dataUsingEncoding:NSASCIIStringEncoding]];  

// Close the body and set to the request
[body appendData:[[NSString stringWithFormat:@"\r\n--%@--\r\n", boundary] dataUsingEncoding: NSUTF8StringEncoding]];
[request setHTTPBody:body];    

// now lets make the connection to the web
NSData *returnData = [NSURLConnection sendSynchronousRequest:request returningResponse:nil error:nil];
NSString *returnString = [[NSString alloc] initWithData:returnData encoding:NSUTF8StringEncoding];

NSLog(@"%@", returnString); 
```

但是，我仍然得到返回： {"type":"error","status":404,"code":"not_found","help_url":"http://developers.box.com/docs/#错误","消息":"未找到","re​​quest_id":"10130600215xxxxxxxxxxx"}

请有人帮我指出正确的方向，因为当我使用 POSTMAN 或 cURL 时，我可以让它工作 - 所以这显然是我的代码的问题。我怀疑这与“folder_id”有关，但似乎无法诊断出真正的原因。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T19:37:02.633

解决它。问题出在我的“边界”构造代码中。我得到了：

> ```
> NSString *contentType = [NSString stringWithFormat:@"multipart/form-data; boundary=%@\r\n",boundary]; 
> ```

并且应该有：

> ```
> NSString *contentType = [NSString stringWithFormat:@"multipart/form-data; boundary=%@",boundary]; 
> ```

找出不正确的终止“\r\n”。那好吧。只浪费了大约4个小时。:-)

# css - 并排渲染项目

> ID：11564070
> 
> 赞同：0
> 
> 时间：2012-07-19T15:24:43.090
> 
> 标签：css, asp.net-mvc, razor

我正在尝试显示一个页面，该页面包含一个带有 3 个列表项的标题、一个带有左侧链接的侧边栏和实际正文。我希望侧边栏和正文在标题下并排呈现。但是，它们在页面上一个接一个地呈现。关于如何做到这一点的任何建议？

我已经使用以下代码和样式来实现这一点，但它似乎不起作用。

```
<div>  
    <h1 class="control-label admin-header" style="vertical-align:top;padding-left:20px">Administration</h1>
    <ul class="nav nav-pills admin-header" style="float:right">
        <li class="active admin-header"><a href="http://localhost:10004/test">test</a></li>
        <li class="admin-header"><a href="http://localhost:10004/xyz">xyz</a></li>
        <li class="admin-header"><a href="https://localhost:10004/abc">abc</a></li>
    </ul>
    </div>
    <div>
    <div class="span3 admin-header">
        <div class="well sidebar-nav admin-header">@RenderSection("Sidebar", false)</div>
    </div>
    <div class="content span12 admin-header">@RenderBody()
    </div>
    </div>

.admin-header
{
    display: inline;
}​ 
```

[小提琴](http://jsfiddle.net/v7acM/2/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T16:15:22.560

不确定我是否理解，但对于并排显示，您可以使用

```
<table>
<tr>
<td class="active admin-header"><a href="http://localhost:10004/test">test</a></td>
<td class="admin-header"><a href="http://localhost:10004/xyz">xyz</a></td>
<td class="admin-header"><a href="http://localhost:10004/xyz">abc</a></td>
</tr>
</table> 
```

# c# - 如何在不加粗整个文档的情况下以编程方式将粗体文本写入 Word 文档？

> ID：11564073
> 
> 赞同：12
> 
> 时间：2012-07-19T15:24:51.430
> 
> 标签：c#, ms-word

我的程序需要以 Office`.doc`格式（非 XML）生成高度简单的报告，并且文档的某些部分需要加粗。我一直在查看[定义范围](http://msdn.microsoft.com/en-us/library/2a9dt54a.aspx)的文档，这部分是我的代码目前派生出来的。[这](http://msdn.microsoft.com/en-us/library/aa224034%28v=office.11%29.aspx)部分文档并没有真正给我足够的细节来在我的文档中实现这一点。到目前为止，这是我的代码：

```
object miss = System.Reflection.Missing.Value;
object Visible = true;
object start = 0;

Microsoft.Office.Interop.Word.Application WordApp = new Microsoft.Office.Interop.Word.Application();
Document report = WordApp.Documents.Add(ref miss, ref miss, ref miss, ref miss);

String header = "Bold Header: ";
Range headerRange = report.Range(ref start, ref miss);
headerRange.Text = header;
headerRange.Font.Bold = -1;

String data = "Information underneath the header";
Range dataRange = report.Range();
dataRange.Text = data;
dataRange.Font.Bold = 1;

object filename = "test.doc";

report.SaveAs(ref filename, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss, ref miss);
object saveChanges = Microsoft.Office.Interop.Word.WdSaveOptions.wdPromptToSaveChanges;
object originalFormat = Microsoft.Office.Interop.Word.WdOriginalFormat.wdWordDocument;
object routeDocument = true;
WordApp.Visible = true; 
```

这将生成一个仅包含文本的 word 文档`**Information underneath the header**`。这是一个简单的例子。

我的文档不会比这更复杂，但我希望生成基于可变数据量的 Word 文档，粗体文本和非粗体文本分散在各处。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-19T16:49:33.423

[这](https://stackoverflow.com/questions/5628473/different-format-into-one-single-line-interop-word/10076425#10076425)是我想出的一个答案，它将允许您在同一字符串中使用粗体和常规字符串的一部分。

我所做的是自动化的，但如果你知道自己在做什么，这同样适用。还要记住，粗体只是一个 int，没有布尔值 true/false（出于某种原因）。

根据里卡多的观点，我也会在这里发布代码：

```
private void InsertMultiFormatParagraph(string psText, int piSize, int piSpaceAfter = 10) {
    Word.Paragraph para = mdocWord.Content.Paragraphs.Add(ref mobjMissing);

    para.Range.Text = psText;
    // Explicitly set this to "not bold"
    para.Range.Font.Bold = 0;
    para.Range.Font.Size = piSize;
    para.Format.SpaceAfter = piSpaceAfter;

    object objStart = para.Range.Start;
    object objEnd = para.Range.Start + psText.IndexOf(":");

    Word.Range rngBold = mdocWord.Range(ref objStart, ref objEnd);
    rngBold.Bold = 1;

    para.Range.InsertParagraphAfter();
} 
```

显然，如果您想进一步抽象它，您可以为`char`or添加一个参数，`string`这样您就可以更改用于设置粗体开始/停止的内容。

在另一个线程的评论中讨论的一件事是，由于某种原因，Bold 只是一个 int。没有用于设置的布尔值。这很奇怪，我知道。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T16:43:53.827

您可以简单地使用段落对象来自定义不同文本块的格式。示例代码如下：

```
object DocumentEndIndex = "\\endofdoc";
object endDocument = wordDocument.Bookmarks.get_Item(ref DocumentEndIndex).Range;
Paragraph para = wordDocument.Content.Paragraphs.Add(ref endDocument);
para.Range.Text = text;
para.Range.set_Style(ref headingLevel);
// do format the text with para.Range object as you want
para.Range.InsertParagraphAfter(); 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-02-20T11:44:04.353

这是一个老问题，但是当我遇到同样的问题时，这并没有帮助我修改页眉或页脚，而是帮助我弄清楚如何去做，这是我的解决方案：

```
Word.Paragraph p = c2.Range.Paragraphs.Add(ref missing);
p.Range.Text = "your trip at " + sejour.Location;
SetTextColor(p.Range, Word.WdColor.wdColorWhite,0, p.Range.Text.Length - 1);
SetTextSize(p.Range, (float)14, 0, p.Range.Text.Length - 1);
SetTextSize(p.Range, (float)16, p.Range.Text.Length - 2 - sejour.Location.Length, sejour.Location.Length);

public void SetTextColor( Word.Range range, Microsoft.Office.Interop.Word.WdColor color, int start, int length)
{
    Word.Range rng = range;
    rng.Start = range.Start + start;
    rng.End = range.Start + start + length;
    rng.Font.Color = color;
}

public void SetTextSize(Word.Range range, float size, int start, int length)
{
    Word.Range rng = range;
    rng.Start = range.Start + start;
    rng.End = range.Start + start + length;
    rng.Font.Size = size;
} 
```

# visual-c++ - 为什么我不能在设备代码中使用全局浮点常量？

> ID：11564081
> 
> 赞同：1
> 
> 时间：2012-07-19T15:25:12.263
> 
> 标签：visual-c++, cuda

当我尝试在 VS 2010 中编译以下 C++ 代码时：

```
float const x = 1.0;

__global__ void kernel()
{
    int a = x;
}

int main()
{
    kernel<<<1,1>>>();
} 
```

我收到以下错误：

> 设备代码中未定义标识符“x”

当我在 GCC 中编译代码时，一切都很好。

有没有办法在 VS 的设备代码中使用浮点常量而不求助于`#define`？

# jsf - ADF、jsf 组件不显示在 Eclipse 的 Palette 中

> ID：11564085
> 
> 赞同：0
> 
> 时间：2012-07-19T15:25:16.937
> 
> 标签：jsf, oracle-adf, palette

我刚刚创建了一个`test.xhtml`在 Eclipse 中调用的文件，但 Palette 只显示 HTML4.0，没有 JSF 或 ADF 组件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T07:13:20.913

似乎您创建了一个 Web 应用程序项目。从菜单中选择文件 --> 新建 --> ADF 应用程序。这将为 JSF 和 ADF Faces 设置您的项目

# mysql - Rails/MySQL CURDATE 查询，创建和更新都在

> ID：11564086
> 
> 赞同：0
> 
> 时间：2012-07-19T15:25:21.060
> 
> 标签：mysql, ruby-on-rails

嗨，伙计们，我真的是 sql 新手，所以请对我温柔一点。我正在尝试运行一个查询，它将提取过去两周内 created_at 或 updated_at 的所有记录。

我做了一些阅读，这是我到目前为止所拥有的

```
SELECT * FROM sms_development.scores WHERE DATE(created_at) = CURDATE() - INTERVAL 14 DAY AND CURDATE() OR DATE(updated_at) = CURDATE() - INTERVAL 14 DAY AND CURDATE(); 
```

这看起来真的很大，而且一点也不干。并且由于某种原因它不起作用。如果我将它输入 MySQL 工作台，它会给我一个绿灯，但我不知道我是否犯了语法错误或其他什么。但没有记录被提取。

非常感谢任何有用的建议或技术

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:36:12.890

你应该尽可能多地通过 Rails finder 来做这件事；它们至少可以部分移植到其他数据存储引擎，所以如果你从 SQLite 切换到 Postgres，你就不必重写（尽可能多的）代码。

我会这样做：

```
Score.where('created_at > ? OR updated_at > ?', DateTime.now - 2.weeks, DateTime.now - 2.weeks).all 
```

# c# - 使属性反序列化但不使用 json.net 序列化

> ID：11564091
> 
> 赞同：158
> 
> 时间：2012-07-19T15:25:29.333
> 
> 标签：c#, json.net

我们有一些配置文件是通过使用 Json.net 序列化 C# 对象生成的。

我们希望将序列化类的一个属性从简单的枚举属性迁移到类属性中。

一种简单的方法是在类中保留旧的枚举属性，并安排 Json.net 在加载配置时读取此属性，但在下一次序列化对象时不再保存它。我们将分别处理从旧枚举生成新类。

是否有任何简单的方法来标记（例如使用属性）C# 对象的属性，以便 Json.net 仅在序列化时忽略它，但在反序列化时关注它？

* * *

## 回答 #1

> 赞同：165
> 
> 时间：2014-06-14T21:28:48.780

实际上，您可以使用几种相当简单的方法来实现您想要的结果。

例如，假设您的类当前定义如下：

```
class Config
{
    public Fizz ObsoleteSetting { get; set; }
    public Bang ReplacementSetting { get; set; }
}

enum Fizz { Alpha, Beta, Gamma }

class Bang
{
    public string Value { get; set; }
} 
```

你想这样做：

```
string json = @"{ ""ObsoleteSetting"" : ""Gamma"" }";

// deserialize
Config config = JsonConvert.DeserializeObject<Config>(json);

// migrate
config.ReplacementSetting = 
    new Bang { Value = config.ObsoleteSetting.ToString() };

// serialize
json = JsonConvert.SerializeObject(config);
Console.WriteLine(json); 
```

要得到这个：

```
{"ReplacementSetting":{"Value":"Gamma"}} 
```

## 方法一：添加一个 ShouldSerialize 方法

Json.NET 具有通过`ShouldSerialize`在类中查找相应方法来有条件地序列化属性的能力。

要使用此功能，请向您的类添加一个布尔`ShouldSerializeBlah()`方法，其中`Blah`替换为您不想序列化的属性的名称。使这个方法的实现总是返回`false`。

```
class Config
{
    public Fizz ObsoleteSetting { get; set; }

    public Bang ReplacementSetting { get; set; }

    public bool ShouldSerializeObsoleteSetting()
    {
        return false;
    }
} 
```

注意：如果您喜欢这种方法，但又不想通过引入`ShouldSerialize`方法来混淆类的公共接口，则可以使用 an`IContractResolver`以编程方式执行相同的操作。请参阅文档中的[条件属性序列化](http://james.newtonking.com/json/help/?topic=html/ConditionalProperties.htm)。

## 方法 2：使用 JObjects 操作 JSON

无需使用`JsonConvert.SerializeObject`来进行序列化，而是将配置对象加载到 a`JObject`中，然后在将其写出之前简单地从 JSON 中删除不需要的属性。这只是几行额外的代码。

```
JObject jo = JObject.FromObject(config);

// remove the "ObsoleteSetting" JProperty from its parent
jo["ObsoleteSetting"].Parent.Remove();

json = jo.ToString(); 
```

## 方法 3：巧妙（ab）使用属性

1.  将`[JsonIgnore]`属性应用于您不想被序列化的属性。
2.  将备用的*私有*属性设置器添加到与原始属性具有相同类型的类。使该属性的实现设置原始属性。
3.  将`[JsonProperty]`属性应用到备用设置器，为其指定与原始属性相同的 JSON 名称。

这是修改后的`Config`课程：

```
class Config
{
    [JsonIgnore]
    public Fizz ObsoleteSetting { get; set; }

    [JsonProperty("ObsoleteSetting")]
    private Fizz ObsoleteSettingAlternateSetter
    {
        // get is intentionally omitted here
        set { ObsoleteSetting = value; }
    }

    public Bang ReplacementSetting { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2018-02-27T18:29:04.023

对于任何可以将仅反序列化的属性标记为内部的情况，有一个非常简单的解决方案，它根本不依赖于属性。只需将属性标记为内部获取，但公共设置：

```
public class JsonTest {

    public string SomeProperty { internal get; set; }

} 
```

这会导致使用默认设置/解析器/等进行正确的反序列化，但该属性会从序列化输出中剥离。

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2016-02-05T22:50:41.910

我喜欢在这个属性上坚持，这是我需要反序列化属性但不序列化它时使用的方法，反之亦然。

**第 1 步 - 创建自定义属性**

```
public class JsonIgnoreSerializationAttribute : Attribute { } 
```

**第 2 步 - 创建一个自定义的 Contract Reslover**

```
class JsonPropertiesResolver : DefaultContractResolver
{
    protected override List<MemberInfo> GetSerializableMembers(Type objectType)
    {
        //Return properties that do NOT have the JsonIgnoreSerializationAttribute
        return objectType.GetProperties()
                         .Where(pi => !Attribute.IsDefined(pi, typeof(JsonIgnoreSerializationAttribute)))
                         .ToList<MemberInfo>();
    }
} 
```

**第 3 步 - 添加不需要序列化但需要反序列化的属性**

```
 [JsonIgnoreSerialization]
    public string Prop1 { get; set; } //Will be skipped when serialized

    [JsonIgnoreSerialization]
    public string Prop2 { get; set; } //Also will be skipped when serialized

    public string Prop3 { get; set; } //Will not be skipped when serialized 
```

**第 4 步 - 使用它**

```
var sweet = JsonConvert.SerializeObject(myObj, new JsonSerializerSettings { ContractResolver = new JsonPropertiesResolver() }); 
```

希望这可以帮助！另外值得注意的是，当反序列化发生时，这也会忽略属性，当我反序列化时，我只是以传统方式使用转换器。

```
JsonConvert.DeserializeObject<MyType>(myString); 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-06-13T10:10:20.523

使用 setter 属性：

```
[JsonProperty(nameof(IgnoreOnSerializing))]
public string IgnoreOnSerializingSetter { set { _ignoreOnSerializing = value; } }

[JsonIgnore]
private string _ignoreOnSerializing;

[JsonIgnore]
public string IgnoreOnSerializing
{
    get { return this._ignoreOnSerializing; }
    set { this._ignoreOnSerializing = value; }
} 
```

希望这有帮助。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-04-02T18:58:51.957

在我花了很长时间搜索如何将类属性标记为可反序列化和不可序列化之后，我发现根本没有这样的事情可以做到；所以我想出了一个结合两个不同库或序列化技术（System.Runtime.Serialization.Json & Newtonsoft.Json）的解决方案，它对我有用，如下所示：

*   将所有类和子类标记为“DataContract”。
*   将您的类和子类的所有属性标记为“DataMember”。
*   将您的类和子类的所有属性标记为“JsonProperty”，除了那些您不希望它们被序列化的属性。
*   现在将您不希望将其序列化为“JsonIgnore”的属性标记。
*   然后使用“Newtonsoft.Json.JsonConvert.SerializeObject”进行序列化，并使用“System.Runtime.Serialization.Json.DataContractJsonSerializer”进行反序列化。

    ```
    using System;
    using System.Collections.Generic;
    using Newtonsoft.Json;
    using System.Runtime.Serialization;
    using System.IO;
    using System.Runtime.Serialization.Json;
    using System.Text;

    namespace LUM_Win.model
    {
        [DataContract]
        public class User
        {
            public User() { }
            public User(String JSONObject)
            {
                MemoryStream stream = new MemoryStream(Encoding.Unicode.GetBytes(JSONObject));
                DataContractJsonSerializer dataContractJsonSerializer = new DataContractJsonSerializer(typeof(User));

                User user = (User)dataContractJsonSerializer.ReadObject(stream);
                this.ID = user.ID;
                this.Country = user.Country;
                this.FirstName = user.FirstName;
                this.LastName = user.LastName;
                this.Nickname = user.Nickname;
                this.PhoneNumber = user.PhoneNumber;
                this.DisplayPicture = user.DisplayPicture;
                this.IsRegistred = user.IsRegistred;
                this.IsConfirmed = user.IsConfirmed;
                this.VerificationCode = user.VerificationCode;
                this.Meetings = user.Meetings;
            }

            [DataMember(Name = "_id")]
            [JsonProperty(PropertyName = "_id")]
            public String ID { get; set; }

            [DataMember(Name = "country")]
            [JsonProperty(PropertyName = "country")]
            public String Country { get; set; }

            [DataMember(Name = "firstname")]
            [JsonProperty(PropertyName = "firstname")]
            public String FirstName { get; set; }

            [DataMember(Name = "lastname")]
            [JsonProperty(PropertyName = "lastname")]
            public String LastName { get; set; }

            [DataMember(Name = "nickname")]
            [JsonProperty(PropertyName = "nickname")]
            public String Nickname { get; set; }

            [DataMember(Name = "number")]
            [JsonProperty(PropertyName = "number")]
            public String PhoneNumber { get; set; }

            [DataMember(Name = "thumbnail")]
            [JsonProperty(PropertyName = "thumbnail")]
            public String DisplayPicture { get; set; }

            [DataMember(Name = "registered")]
            [JsonProperty(PropertyName = "registered")]
            public bool IsRegistred { get; set; }

            [DataMember(Name = "confirmed")]
            [JsonProperty(PropertyName = "confirmed")]
            public bool IsConfirmed { get; set; }

            [JsonIgnore]
            [DataMember(Name = "verification_code")]
            public String VerificationCode { get; set; }

            [JsonIgnore]
            [DataMember(Name = "meeting_ids")]
            public List<Meeting> Meetings { get; set; }

            public String toJSONString()
            {
                return JsonConvert.SerializeObject(this, new JsonSerializerSettings() { NullValueHandling = NullValueHandling.Ignore });
            }
        }
    } 
    ```

希望有帮助...

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-05-31T17:06:00.960

根据应用程序中发生这种情况的位置以及如果它只是一个属性，您可以*手动*执行此操作的一种方法是将属性值设置为 null，然后在模型上您可以指定如果值为 null，则忽略该属性：

```
[JsonProperty(NullValueHandling = NullValue.Ignore)]
public string MyProperty { get; set; } 
```

如果您正在使用 ASP.NET Core Web 应用程序，则可以通过在 Startup.cs 文件中设置它来为所有模型中的所有属性全局设置它：

```
public void ConfigureServices(IServiceCollection services) {
    // other configuration here
    services.AddMvc()
        .AddJsonOptions(options => options.SerializerSettings.NullValueHandling = NullValueHandling.Ignore);
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-11-21T03:39:43.857

参考@ThoHo 的解决方案，实际上只需要使用setter，不需要额外的标签。

对我来说，我以前有一个引用 ID，我想加载并添加到新的引用 ID 集合中。通过将引用 Id 的定义更改为仅包含一个 setter 方法，该方法将值添加到新集合中。如果 Property 没有**get，则 Json 无法将值写回；**方法。

```
// Old property that I want to read from Json, but never write again. No getter.
public Guid RefId { set { RefIds.Add(value); } }

// New property that will be in use from now on. Both setter and getter.
public ICollection<Guid> RefIds { get; set; } 
```

这个类现在向后兼容以前的版本，并且只保存新版本的**RefId**。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-10-26T09:20:03.717

为了建立在 Tho Ho 的答案之上，这也可以用于字段。

```
[JsonProperty(nameof(IgnoreOnSerializing))]
public string IgnoreOnSerializingSetter { set { IgnoreOnSerializing = value; } }

[JsonIgnore]
public string IgnoreOnSerializing; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-12-26T05:14:28.397

如果你使用 JsonConvert，[IgnoreDataMemberAttribute](https://docs.microsoft.com/en-us/dotnet/api/system.runtime.serialization.ignoredatamemberattribute?view=netframework-4.7.2)是可以的。我的标准库不引用 Newton.Json，我使用 [IgnoreDataMember] 来控制对象序列化。

来自[Newton.net](https://www.newtonsoft.com/json/help/html/DataContractAndDataMember.htm)帮助文档。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-06-29T04:37:21.723

> 是否有任何简单的方法来标记（例如使用属性）C# 对象的属性，以便 Json.net 仅在序列化时忽略它，但在反序列化时关注它？

在撰写本文时，我发现的最简单的方法是将此逻辑包含在您的[IContractResolver](https://www.newtonsoft.com/json/help/html/ConditionalProperties.htm)中。

上述链接中的示例代码复制到此处以供后代使用：

```
public class Employee
{
    public string Name { get; set; }
    public Employee Manager { get; set; }

    public bool ShouldSerializeManager()
    {
        // don't serialize the Manager property if an employee is their own manager
        return (Manager != this);
    }
}

public class ShouldSerializeContractResolver : DefaultContractResolver
{
    public new static readonly ShouldSerializeContractResolver Instance = new ShouldSerializeContractResolver();

    protected override JsonProperty CreateProperty(MemberInfo member, MemberSerialization memberSerialization)
    {
        JsonProperty property = base.CreateProperty(member, memberSerialization);

        if (property.DeclaringType == typeof(Employee) && property.PropertyName == "Manager")
        {
            property.ShouldSerialize =
                instance =>
                {
                    Employee e = (Employee)instance;
                    return e.Manager != e;
                };
        }

        return property;
    }
} 
```

所有的答案都很好，但这种方法似乎是最干净的方法。实际上，我通过在属性上查找 SkipSerialize 和 SkipDeserialize 的属性来实现这一点，这样您就可以标记您控制的任何类。好问题！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-02-03T08:23:21.253

Jraco11 的回答非常简洁。如果您想对序列化和反序列化使用相同的 IContractResolver，则可以使用以下命令：

```
public class JsonPropertiesResolver : DefaultContractResolver
{
    protected override JsonProperty CreateProperty(MemberInfo member, MemberSerialization memberSerialization)
    {
        JsonProperty property = base.CreateProperty(member, memberSerialization);

        if (member.IsDefined(typeof(JsonIgnoreSerializationAttribute)))
        {
            property.ShouldSerialize = instance => false;
        }

        return property;
    }
} 
```

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2021-06-23T11:51:36.223

在模型类的**公共**属性中使用`[JsonIgnore]`属性。

# android - java.lang.NoClassDefFoundError，在我自己的一堂课上

> ID：11564100
> 
> 赞同：3
> 
> 时间：2012-07-19T15:25:50.010
> 
> 标签：android, android-intent

在我的家庭活动中，我在一个线程中使用，并且 Intent 到我自己的班级之一：

```
public class AppHome extends Activity {

@Override
protected void onCreate(Bundle savedInstanceState) {
        /* some initialisations */
        Thread initThread = new Thread() {

            @Override
    public void run() {
        try {
            super.run();
            /* some treatment */
            lanchNextActivity(nextActivity);
        }
    };
    initThread.start();
     }

private void lanchNextActivity(String activity){

    Intent intent = new Intent(context, ZonesActivity.class);
    startActivity(intent);
}
} 
```

`ZonesActivity.class`它因以下消息而崩溃

```
threadid=12: thread exiting with uncaught exception (group=0x40a13300)
FATAL EXCEPTION: Thread-120
java.lang.NoClassDefFoundError: com.dombox.app.activity.ZonesActivity
    at com.dombox.app.activity.DomboxHome.lanchNextActivity(DomboxHome.java:309)
    at com.dombox.app.activity.DomboxHome.access$1(DomboxHome.java:291)
    at com.dombox.app.activity.DomboxHome$1.run(DomboxHome.java:276) 
```

AppHome.java:309 是Intent的创建。

我的班级 ZonesActivity 是我的佣人：

```
package com.dombox.app.activity;

public class ZonesActivity extends FragmentActivity { /* ... */ } 
```

我认为我的班级路径有问题，但对我来说似乎很正常：

![这是我的类路径](../Images/e1098c24d1f8801851bd0733cdaf17c4.png)

我的清单：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest package="com.myapp.app"
    android:versionCode="13"
    android:versionName="2.1.1" xmlns:android="http://schemas.android.com/apk/res/android">

    <uses-sdk android:minSdkVersion="8" android:targetSdkVersion="8"/>

    <supports-screens android:largeScreens="true"
        android:normalScreens="true" android:smallScreens="true"
        android:anyDensity="true" />

    <permission android:name="com.myapp.app.permission.C2D_MESSAGE"
        android:protectionLevel="signature" />

    <uses-permission android:name="android.permission.INTERNET" />

    <application
        <uses-library android:name="android.test.runner" />

        <activity android:name=".activity.ZonesActivity"                    
            android:label="@string/app_name"></activity>

        <instrumentation
            android:name="android.test.InstrumentationTestRunner"
            android:label="Tests for Android MyApp"
            android:targetPackage="com.application.androidmyapp" >
        </instrumentation>
    </application>
</manifest> 
```

对不起，清单很大！

有人知道吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-06T03:44:45.420

如果您使用了当前平台上不可用的任何 API。（例如在旧手机上调用 ICS API）。系统将抛出这个相当具有误导性的异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-06-20T08:53:00.420

就我而言，问题是我的类继承自一个仅在 API 24+ 中可用的类。

我继承自[`SensorEventCallback`](https://developer.android.com/reference/android/hardware/SensorEventCallback)，而是通过实现[`SensorEventListener`](https://developer.android.com/reference/android/hardware/SensorEventListener)来修复它。

# mysql - 可以在 mysql 插件中使用节俭吗？

> ID：11564105
> 
> 赞同：2
> 
> 时间：2012-07-19T15:25:54.823
> 
> 标签：mysql, plugins, thrift

我正在使用 Mysql 5.5，插件需要查询一个节俭的接口服务器以获取一些信息。我创建了 thrift 客户端，它基本上打开与服务器的连接，获取状态，然后关闭连接：

```
#include "../../xxxx/gen-cpp/Xxxx.h"
#include <transport/TSocket.h>
#include <transport/TBufferTransports.h>
#include <protocol/TBinaryProtocol.h>

using namespace apache::thrift;
using namespace apache::thrift::protocol;
using namespace apache::thrift::transport;

using namespace ::za::co::xxxx;

int main(int argc, char **argv) {
  boost::shared_ptr<TSocket> socket(new TSocket("localhost", 9090));
  boost::shared_ptr<TTransport> transport(new TBufferedTransport(socket));
  boost::shared_ptr<TProtocol> protocol(new TBinaryProtocol(transport));

  XxxxServiceClient client(protocol);
  transport->open();
  client.getStatus();
  transport->close();

  return 0;
} 
```

然后我将 main() 更改为函数名称并将其添加到插件代码文件中并从 main 函数中调用它。插件代码构建良好，但地图现在包含大量节俭引用，并且在尝试加载插件时，我收到此错误：

`ERROR 1126 (HY000): Can't open shared library '/usr/lib/mysql/plugin/libxxxx.so' (errno: 13 undefined symbol: _ZTVN6apache6thrift9transport18TBufferedTransportE)`

有没有办法在安装插件时解决这些新的节俭参考？没有上面的代码，它可以正常安装和运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-30T10:30:13.613

使用 Thrift cpp 教程代码，我能够创建一个简单的 hello world MySQL 守护程序插件，它使客户端调用 CppServer 进程：

```
#include <mysql/plugin.h>
#include <mysql_version.h>

#include <protocol/TBinaryProtocol.h>
#include <transport/TSocket.h>
#include <transport/TTransportUtils.h>

#include "gen-cpp/Calculator.h"

using namespace apache::thrift;
using namespace apache::thrift::protocol;
using namespace apache::thrift::transport;

using namespace tutorial;
using namespace shared;

using namespace boost;

static int hello_world_plugin_init(void *p) {

  shared_ptr<TTransport> socket(new TSocket("localhost", 9090));
  shared_ptr<TTransport> transport(new TBufferedTransport(socket));
  shared_ptr<TProtocol> protocol(new TBinaryProtocol(transport));

  CalculatorClient client(protocol);

  transport->open();
  client.ping();
  transport->close();

  return 0;
} 
```

这个Makefile：

```
BOOST_DIR = /usr/include/boost
MYSQL_DIR = /usr/include/mysql
THRIFT_DIR = /usr/local/include/thrift
LIB_DIR = /usr/local/lib

GEN_SRC = gen-cpp/SharedService.cpp gen-cpp/shared_types.cpp gen-cpp/tutorial_types.cpp gen-cpp/Calculator.cpp
DEFS = -DMYSQL_DYNAMIC_PLUGIN -DHAVE_NETINET_IN_H

default: hello_thrift.cc
    g++ ${DEFS} -fPIC -shared -o libhellothrift.so -I${MYSQL_DIR} -I${THRIFT_DIR} -I${BOOST_DIR} -Igen-cpp -L${LIB_DIR} hello_thrift.cc ${GEN_SRC} -lthrift 
```

这只是示例代码，如果 Thrift CppServer 未运行，将会使您的 MySQL 服务器崩溃。

我使用 gcc 4.6.3、MySQL 5.5.24、Thrift 0.8.0、Boost 1.46 在 Ubuntu 12.04 LTS 上对此进行了测试

# iphone - 如何检查 Iphone 中的字典是否存在？

> ID：11564107
> 
> 赞同：0
> 
> 时间：2012-07-19T15:26:01.233
> 
> 标签：iphone, ios, ipad

我有一个 Iphone 应用程序，我在其中从字典向数组添加值。谁能告诉我在迭代字典之前如何检查字典是否存在？

```
NSDictionary *news=[dict objectForKey:@"news"];
NSDictionary *deals=[dict objectForKey:@"deals"];
NSLog(@"%@",[news classForCoder]);
NSLog(@"%@",news);
NSLog(@"%@",deals);

for(NSDictionary *key in news)
{
    if([key isKindOfClass:[NSDictionary class]])
    {        
        [dataArray addObject:key]; 
    }
    // NSLog(@"%@",rewardsId);
    //[dataArray addObject:dictrewards];
}

for(NSDictionary *key in deals)
{      
    if([key isKindOfClass:[NSDictionary class]])
    {  
        [dataArray1 addObject:key];       
    }

    // NSLog(@"%@",rewardsId);
    //[dataArray addObject:dictrewards];
}

self.newsseperatearray=dataArray;
self.dealsseperatearray=dataArray1;

self.newssarray = [[dataArray arrayByAddingObjectsFromArray:dataArray1] mutableCopy];

NSLog(@"%@",self.newssarray);
//self.newssarray=dataArray;
[self.mTableView reloadData]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:30:35.590

你应该检查它不是 nil 并且它实际上是一个 NSDictionary

```
if(news && [news isKindOfClass:[NSDictionary class]]) {
    do stuff
} 
```

# c++ - 二维数据点集的加权线性最小二乘

> ID：11564108
> 
> 赞同：3
> 
> 时间：2012-07-19T15:26:05.530
> 
> 标签：c++, algorithm, matlab, statistics, mathematical-optimization

我的问题是讨论[How to fit the 2D scatter data with a line with C++](https://stackoverflow.com/questions/11449617/how-to-fit-the-2d-scatter-data-with-a-line-with-c)的延伸。现在我想进一步扩展我的问题：在估计适合 2D 散射数据的线时，如果我们可以不同地处理每个 2D 散射数据会更好。也就是说，如果散点远离直线，我们可以给点低权重，反之亦然。因此，问题就变成了：给定一个二维散点数组以及它们的权重因子，我们如何估计通过它们的线性线？这种方法的一个很好的实现可以在这篇文章中找到（[加权最小回归](http://www.codeproject.com/Articles/25335/An-Algorithm-for-Weighted-Linear-Regression)）。但是，那篇文章中的算法的实现太复杂了，因为它涉及到矩阵计算。因此，我试图找到一种无需矩阵计算的方法。该算法是[简单线性回归](http://en.wikipedia.org/wiki/Simple_linear_regression#cite_note-0)的扩展，为了说明该算法，我编写了以下 MATLAB 代码：

```
function line = weighted_least_squre_for_line(x,y,weighting);

part1 = sum(weighting.*x.*y)*sum(weighting(:));

part2 = sum((weighting.*x))*sum((weighting.*y));

part3 = sum( x.^2.*weighting)*sum(weighting(:));

part4 = sum(weighting.*x).^2; 

beta = (part1-part2)/(part3-part4);

alpha = (sum(weighting.*y)-beta*sum(weighting.*x))/sum(weighting);

a = beta;
c = alpha;
b = -1;
line = [a b c]; 
```

在上述代码中，`x,y,weighting`分别表示x坐标、y坐标和权重因子。我用几个例子测试了算法，但仍然不确定它是否正确，因为这种方法使用[Polyfit](http://www.mathworks.de/matlabcentral/fileexchange/13520-polyfitweighted)得到了不同的结果，它依赖于矩阵计算。我现在在这里发布实现并征求您的意见。你认为这是一个正确的实施吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T19:04:48.423

如果您认为降低远离线的点是一个好主意，您可能会被[http://en.wikipedia.org/wiki/Least_absolute_deviations](http://en.wikipedia.org/wiki/Least_absolute_deviations)所吸引，因为计算这一点的一种方法是通过[http://en .wikipedia.org/wiki/Iteratively_re-weighted_least_squares](http://en.wikipedia.org/wiki/Iteratively_re-weighted_least_squares)，这将减少远离线的点的权重。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T18:50:21.770

如果您认为您的所有点都是“好数据”，那么根据它们与初始拟合的距离来天真地加权它们是错误的。但是，丢弃“异常值”是一种相当普遍的做法：如果一些数据点与拟合相去甚远，并且您有理由相信存在可能生成一小部分“坏”数据点的错误机制，您可以只需从数据集中删除不合理的点以获得更好的拟合。

就数学而言，我建议硬着头皮尝试找出矩阵数学。也许你可以找到一篇不同的文章，或者一本书有更好的介绍。我不会评论您的 Matlab 代码，只是说看起来您在从 减去时会遇到一些精度问题`part4`，`part3`并且可能还会`part2`从`part1`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-20T22:35:46.317

不完全符合您的要求，但您应该研究[稳健回归](http://en.wikipedia.org/wiki/Robust_regression)。MATLAB 具有该功能[`robustfit`](http://www.mathworks.com/help/toolbox/stats/robustfit.html)（需要统计工具箱）。

甚至还有一个交互式演示，您可以使用它来比较常规线性回归与稳健回归：

```
>> robustdemo 
```

这表明在存在异常值的情况下，稳健回归往往会给出更好的结果。

![截屏](../Images/093141173c51707e23333c2c3a71671b.png)

# c# - 如何从其他线程（.net compact framework）正确创建控件，而不参考其他控件？

> ID：11564109
> 
> 赞同：1
> 
> 时间：2012-07-19T15:26:06.943
> 
> 标签：c#, .net, winforms, compact-framework

我的代码在不同于 UI 的线程中运行，它必须创建一个控件（Windows 窗体）。但是，我没有从 UI 中引用任何控件（这样，我可以使用`myControl.Invoke( methodThatAddsControlToUI )`）。有没有办法在 .net**紧凑框架**中做到这一点？

如果可能的话，我会对不使用对其他控件的引用的解决方案感兴趣（例如，跟踪所有创建的表单不是一个好的解决方法，因为我的代码将在库中）。在完整的框架版本中，有该`Application.OpenForms`属性，但这不会在 CF 中退出。

编辑：

这样做的主要目的是在 UI 线程上调用一个方法：

```
class Worker
{
    public MyMethod()
    {
        // I need to call a method on the UI (this code doesn't run in the UI thread), 
        // but I don't have any field  in this object holding an UI control
        // value. So, I can't write myControlField.Invoke(...),
        // but I still need to call a method on the UI thread
    }
} 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T16:30:46.993

从库中确实无法保证您的线程上下文，因此您最安全的选择是让消费者提供调用者并将其留给他们以确保它是在正确的上下文中创建的。像这样的模式：

```
class Foo
{
    private Control m_invoker;

    public Foo()
        : this(null)
    {
    }

    public Foo(Control invoker)
    {
        if (invoker == null)
        {
            // assume we are created on the UI thread, 
            // if not bad things will ensue
            m_invoker = new Control();
        }
        else
        {
            m_invoker = invoker;
        }
    }

    public void Bar()
    {
        m_invoker.Invoke(new Action(delegate
        {
            // do my UI-context stuff here
        }));
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T17:11:56.257

**如果这不是一个真正的**答案，我很抱歉，但我认为它可能会有所帮助：

WinForms 采用这种方法的原因——使用 Control 或 Form 引用来访问使您能够在 UI 线程上运行代码的 Invoke 方法——是您必须在 UI 线程中运行代码的唯一原因是，如果您将编写/更改 UI 组件的状态。

当然，如果你要这样做，你必须有一个 UI 组件的引用。所以你可以访问它的 Invoke 方法。除了修改视觉元素之外，我想不出您必须从组件访问 UI 线程的任何其他原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-31T00:49:23.293

它必须被调用......但是调用必须等待主线程我的意思是你不会这样得到错误但是如果你想同时进行多个进程，这不是完全并行工作只需创建一个以上的线程

```
Thread thread = new Thread(new delegate_method(method));
thread.start ();
Thread thread2 = new Thread(new delegate_method(method2));
thread.start (); 
```

同时处理两个进程

```
 void method ()
{
//do something here -- working background Remember can not control any UI control from here
finish_thread()
}

void method2 ()
{
//do something here -- working background Remember can not control any UI control from here
finish_thread()
}

void finish_thread()
{
if(invoke.Required)
{
//Here you have to call delegate method here with UI
BeginInvoke(new delegate_method(finish_thread));
}
else
{
//Now you can control UI thread from here and also you finished background work
//Do something working with UI thread
textBox.Text = "";
}
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-21T09:31:03.497

```
//Declare this in class
public delegate void delege();

//Write this lines when you want to background thread start
    Thread thread = new Thread(new ThreadStart(() => {
    //Do what you what with backgorund threading , can not use any interface comand here
         BeginInvoke(new delege(() => { 
           //Do here any main thread thread job,this can do interface and control jobs without any error 
         }));
    }));
    thread.Start(); 
```

# ruby-on-rails - 我将如何重构此代码以使用 procs？

> ID：11564110
> 
> 赞同：0
> 
> 时间：2012-07-19T15:26:20.577
> 
> 标签：ruby-on-rails, ruby

原代码：

```
 def self.user_admin_links
    ADMIN_PAGES.inject([]) do |result, page|
      result << Page.new(controller: page[:name]) if page[:menu] && (page[:group_admin] || page[:company_admin])
      result
    end
  end

  def self.super_admin_links
    ADMIN_PAGES.inject([]) do |result, page|
      result << Page.new(controller: page[:name]) if page[:super_admin]
      result
    end
  end 
```

我试图像这样重构：

```
array_builder = Proc.new do |conditional|
    ADMIN_PAGES.inject([]) do |result, page|
      result << Page.new(controller: page[:name]) if conditional
      result
    end
  end

  def self.user_admin_links
    array_builder.call(page[:menu] && (page[:group_admin] || page[:company_admin]))
  end

  def self.super_admin_links
    array_builder.call(page[:super_admin])
  end 
```

但我得到这个错误：

```
Error: undefined local variable or method `array_builder' for Page:Class. 
```

当我把 array_builder 变成一个类方法时，像这样：

```
 def self.array_builder 
    Proc.new do |conditional|
      ADMIN_PAGES.inject([]) do |result, hsh|
        result << Page.new(controller: hsh[:name]) if conditional
        result
      end
    end
  end 
```

我在 self.user_admin_links 方法中收到一个错误，即“页面”无法识别。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:22:18.750

在 Ruby 中，方法不是闭包。即，它们不能使用周围范围内的局部变量，例如`array_builder`.

而且，如果您想`page`对 的每个元素进行评估`ADMIN_PAGES`，则应该使用块参数（这基本上只是将 procs 作为参数传递的一些语法）。否则，它只在`links`方法中评估一次，其中`page`未定义。

```
def array_builder &conditional
  ADMIN_PAGES.inject([]) do |result, page|
    result << Page.new(controller: page[:name]) if conditional[page]
    result
  end
end 
```

此外，这里有一个更好的 Ruby 习惯用法。而不是手动推送到数组并使用注入，使用`Enumerable#select`和`Enumerable#map`：

```
def array_builder &conditional
  ADMIN_PAGES.select(&conditional).map {|page| Page.new(controller: page[:name])}
end 
```

然后其他方法传递一个块：

```
def self.user_admin_links
  array_builder {|page| page[:menu] && (page[:group_admin] || page[:company_admin])}
end

def self.super_admin_links
  array_builder {|page| page[:super_admin]}
end 
```

# tomcat - Tomcat 将 CRLF 附加到响应字符串

> ID：11564114
> 
> 赞同：0
> 
> 时间：2012-07-19T15:26:32.637
> 
> 标签：tomcat, servlets

在我的 servlet 中，我将一个字符串作为附件发送到浏览器。当我将附件保存到磁盘并打开它时，该字符串附加了一个 CRLF（Catrig 回车，换行符）。Tomcat 会这样做还是浏览器会这样做？如何不附加此 CRLF？

编码：

```
response.setHeader("Content-Disposition", "attachemnt; file=.........");  
PrintWriter out = response.getWriter();  
out.println("abcd"); 
```

从浏览器保存的文件中有3行：（使用notepad ++时可以看到CRLF并打开“查看所有字符”）

1个ABCD

2 CRLF

3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T15:33:11.517

可能是您缺少 UTF-8 编码。

尝试添加：

```
request.setCharacterEncoding( "UTF-8" );
response.setContentType("UTF-8"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-05-05T22:03:11.763

CRLF 似乎是`println`ServletOutputStream 功能规范的一部分，请参阅[Tomcat 手册](https://tomcat.apache.org/tomcat-7.0-doc/servletapi/javax/servlet/ServletOutputStream.html)。

您可以使用`out.print`而不是`out.println`.

# asp.net - 从视图模型更新数据库，但也添加新记录

> ID：11564116
> 
> 赞同：0
> 
> 时间：2012-07-19T15:26:33.043
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3

我有一个包含项目列表的视图（可以通过 jQuery 动态添加）。

当我将视图模型 POST 回控制器时，如果代码找不到 ID，我该如何插入新项目并将它们保存到数据库中。

我的初始代码如下 - 更新已保存，但新项目未保存：

```
 //
    // POST: /Objective/Edit/model
    [HttpPost]
    public ActionResult Edit(ObjectivesEdit model)
    {
        if (model.Objectives != null)
        {
             foreach (var item in model.Objectives)
            {
                // find the database row
                Objective objective = db.objectives.Find(item.ID);
                if (objective != null) 
                {
                    // Set the database row to the posted values

                    objective.objective = item.objective;
                    objective.score = item.score;
                    objective.possscore = item.possscore;
                }
                else  // database item not found, so add a new item
                {
                    // add a new objective 
                    // This doesn't seem to add/save a new record
                    Objective obj = new Objective();
                    obj.objective = item.objective;
                    obj.score = item.score;
                    obj.possscore = item.possscore;
                }
             }
            // Save the changes to the database
            db.SaveChanges();
        }
        return View(model);
    } 
```

谢谢你的帮助，

标记

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:29:09.897

您不会将新创建的目标添加到您的上下文中。

```
else  // database item not found, so add a new item
{
    // add a new objective 
    // This doesn't seem to add/save a new record
    Objective obj = new Objective();
    obj.objective = item.objective;
    obj.score = item.score;
    obj.possscore = item.possscore;

    // Missing line.
    db.objectives.Add(obj);
 } 
```

如果您使用的是 EF 4.0（即`db`类型为`ObjectContext`），则应使用`db.AddObject(obj)`.

根据您的评论进行更新：
一种方法是在保存更改后检索所有添加的项目。另一种方法是在创建新目标时修改模型。更改部分标有*：

```
foreach (var item in model.Objectives.ToList()) // *:Notice the ToList()
{
    // find the database row
    Objective objective = db.objectives.Find(item.ID);
    if (objective != null) 
    {
        // Set the database row to the posted values

        objective.objective = item.objective;
        objective.score = item.score;
        objective.possscore = item.possscore;
    }
    else  // database item not found, so add a new item
    {
          // add a new objective 
          // This doesn't seem to add/save a new record
          Objective obj = new Objective();
          obj.objective = item.objective;
          obj.score = item.score;
          obj.possscore = item.possscore;

         db.AddObject(obj)
         // Save the changes to the database
        db.SaveChanges(); // *: save in loop to get thee ID.

        item.ID = obj.ID; // *: assign the ID to the model.
     }
}

 return View(model); 
```

# ruby-on-rails - 在 Rails 中将编辑值 contenteditable 字段从视图传递到控制器

> ID：11564120
> 
> 赞同：3
> 
> 时间：2012-07-19T15:26:41.817
> 
> 标签：ruby-on-rails, ruby, html, contenteditable

我正在使用 Rails 3.1 构建一个 Web 表单，该表单在其他字段中包含一个可以编辑其单元格的表格。我需要将已编辑单元格的文本保存在数据库中。

我正在考虑使用 HTML5 属性“contenteditable”。我可以使用单元格的 innerHTML 的值。如何将此值传递给 Rails 控制器（从视图中）？是否可以使用参数来传递数据？有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:30:30.427

标记为的 HTML 容器`contenteditable`不会通过表单提交自动传递到服务器，因此您可能必须使用 javascript 从这些容器中提取内容并以某种方式传递它们。

一种策略是向表单添加一个处理程序，该处理程序在提交之前触发，它遍历 contenteditable 容器并注入隐藏的表单元素。下面的示例使用 jQuery，但您可能可以不使用 jQuery 来复制思维过程。

```
var form = $('#my_form');
var element;
$('[contenteditable=true]').each(function(){
  element = $(this);
  form.append($('<input/>', {
    type:'hidden',
    name:element.attr('id'),
    value:element.html()
  }));
}); 
```

# ruby-on-rails - Rails 3：表单集合无法识别类？

> ID：11564121
> 
> 赞同：-1
> 
> 时间：2012-07-19T15:26:45.360
> 
> 标签：ruby-on-rails, ruby-on-rails-3, forms

我有一个包含以下字段的嵌套表单：

```
<%= f.label :size %><br />
<%= f.collection_select :size, Video::SIZE, :to_s, :to_s, :include_blank => true, :class => "sizefield" %> 
```

如您所见，我已将“sizefield”类分配给该字段，但由于某种原因，我的应用程序无法识别它。我在这里做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:45:49.023

如果您没有准确指定这些哈希的边界，则允许两个终端哈希的 Rails 函数会混淆。例如：

```
collection_select(object, method, collection, value_method, text_method, options = {}, html_options = {}) 
```

您没有将 与`options`分开`html_options`。尝试这个：

```
<%= f.collection_select :size, Video::SIZE, :to_s, :to_s, {:include_blank => true}, {:class => "sizefield"} %> 
```

# jsf-2 - 换出 Facelets 模板会破坏阶段侦听器

> ID：11564122
> 
> 赞同：1
> 
> 时间：2012-07-19T15:26:45.433
> 
> 标签：jsf-2, primefaces

标题真的很烂，但我找不到更简洁的标题。

我的应用程序实际上包含一个使用 Primefaces 和 JSF 2.x 的 JSF 页面。我正在使用 Primefaces 布局标签来构造页眉、页脚、导航和内容。很简单的东西。导航使用 PF Tree 组件，当我单击一个节点时，会显示该节点的内容。我对所有可能的内容使用 render=。目前，每个内容都包含在内，因此我可以使主页更易于阅读。内容是显示从数据库返回的记录的数据表，选择每个记录会显示该选择的值。将其视为布局内的布局。内部布局包含一个数据表，然后是用于查看所选数据的面板网格。我可以毫无问题地添加、更新和删除。

我的问题是我尝试使用 Facelets 来动态包含内容，而不是设置 render=。这样做的代码是：

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="inc-templates/main-template.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html">
    <ui:define name="centerContent">
        <ui:include src="/#{UtilBean.contentPage}.xhtml"/>
    </ui:define>
</ui:composition> 
```

当单击树中的节点时，UtilBean 设置 contentPage。我现在有 2 个节点 - 图形消息和电子邮件模板。

图形消息.xhtml

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:pe="http://primefaces.org/ui/extensions"
      xmlns:ui="http://java.sun.com/jsf/facelets">
    <h:head>
        <title>Facelet Title</title>
    </h:head>
    <h:body>
        <ui:composition>
                <p:layout id="graphicMessageLayout"
                          style="height: 100%;width: 100%;">
                    <p:layoutUnit id="gmDataTableLU" position="west" size="270"
                                  header="Graphic Messages" closable="false" collapsible="true"
                                  resizable="true">
                        <h:form id="dataTableForm">
                            <p:dataTable id="gmDataTable" var="graphicMessage"
                                         value="#{GraphicMessageBean.graphicMessages}"
                                         paginatorPosition="bottom" widgetVar="gmDataTableVar"
                                         rowKey="#{graphicMessage.graphicMessageUID}"
                                         selection="#{GraphicMessageBean.selectedGraphicMessage}"
                                         selectionMode="single"
                                         style="background: #5d8bba !important; color: white !important;">
                                <pe:paginator
                                        paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
                                        pageLinks="3"
                                        rows="20"/>
                                <p:ajax event="rowSelect" update=":centerForm:ogrid"/>
                                <p:column id="messageId" sortBy="#{graphicMessage.messageId}"
                                          style="width: 25%; text-align: left; white-space: nowrap; padding-left: 5px; padding-right: 5px;"
                                          headerText="Message Id">
                                    <h:outputText value="#{graphicMessage.messageId}" style="white-space: nowrap;"/>
                                </p:column>
                            </p:dataTable>
                        </h:form>
                    </p:layoutUnit>
                    <p:layoutUnit position="center">
                        <h:form id="centerForm" prependId="false">
                            <div id="outerpanel"
                                 style="margin-left: auto; margin-right: auto; margin-top: 50px; width: 470px">
                                <p:panelGrid id="ogrid" styleClass="gmGrid">
                                    <f:facet name="header">
                                        <p:row>
                                            <p:column colspan="2">Graphic Message Properties</p:column>
                                        </p:row>
                                    </f:facet>
                                    <p:row>
                                        <p:column>
                                            <h:outputText value="Message Id:"/>
                                        </p:column>
                                        <p:column>
                                            <p:inputText
                                                    disabled="#{GraphicMessageBean.disabled or GraphicMessageBean.update}"
                                                    value="#{GraphicMessageBean.messageId}"/>
                                        </p:column>
                                    </p:row>
                                    <p:row>
                                        <p:column>
                                            <h:outputText value="Description:"/>
                                        </p:column>
                                        <p:column>
                                            <p:inputText disabled="#{GraphicMessageBean.disabled}"
                                                         value="#{GraphicMessageBean.description}"/>
                                        </p:column>
                                    </p:row>
                                    <p:row>
                                        <p:column>
                                            <h:outputText value="URL:"/>
                                        </p:column>
                                        <p:column>
                                            <p:inputText disabled="#{GraphicMessageBean.disabled}"
                                                         value="#{GraphicMessageBean.graphicURL}"/>
                                        </p:column>
                                    </p:row>
                                    <p:row>
                                        <p:column>
                                            <h:outputText value="Image Source:"/>
                                        </p:column>
                                        <p:column>
                                            <p:selectOneMenu id="selectMenu" value="#{GraphicMessageBean.imageSrc}"
                                                             effect="fade"
                                                             valueChangeListener="#{GraphicMessageBean.viewImageSrc}"
                                                             disabled="#{GraphicMessageBean.disabled}">
                                                <f:selectItem itemLabel="Select One" itemValue=""/>
                                                <f:selectItems value="#{GraphicMessageBean.imageSrcItems}"/>
                                                <p:ajax update="imagesrc"/>
                                            </p:selectOneMenu>
                                        </p:column>
                                    </p:row>
                                    <p:row>
                                        <p:column id="imageSrcColumn" colspan="2">
                                            <div class="imgWrap">
                                                <h:panelGroup id="imagesrc">
                                                    <h:graphicImage

                                                            value="http://localhost/media/ep2demo/banners/#{GraphicMessageBean.imageSrc}"
                                                            height="150px"/>
                                                </h:panelGroup>
                                            </div>
                                        </p:column>
                                    </p:row>
                                    <f:facet name="footer">
                                        <p:row id="buttonRow">
                                            <p:column colspan="2" style="text-align: center;">
                                                <p:commandButton value="Add" rendered="#{GraphicMessageBean.add}"
                                                                 actionListener="#{GraphicMessageBean.addGraphicMessage}"
                                                                 update="ogrid"/>
                                                <p:commandButton value="Edit" rendered="#{GraphicMessageBean.edit}"
                                                                 actionListener="#{GraphicMessageBean.editGraphicMessage}"
                                                                 update="ogrid"/>
                                                <p:commandButton value="Delete" rendered="#{GraphicMessageBean.delete}" onstart="alert('Are you sure?');"
                                                                 actionListener="#{GraphicMessageBean.deleteGraphicMessage}"
                                                                 update="ogrid :dataTableForm:gmDataTable"/>
                                                <p:commandButton value="Update" rendered="#{GraphicMessageBean.update}"
                                                                 actionListener="#{GraphicMessageBean.updateGraphicMessage}"
                                                                 update="ogrid gmMessages"/>
                                                <p:commandButton value="Save" rendered="#{GraphicMessageBean.save}" 
                                                                 actionListener="#{GraphicMessageBean.saveGraphicMessage}"
                                                                 update="ogrid :dataTableForm:gmDataTable"/>
                                                <p:commandButton value="Cancel" rendered="#{GraphicMessageBean.cancel}"
                                                                 actionListener="#{GraphicMessageBean.cancelGraphicMessage}"
                                                                 update="ogrid"/>
                                            </p:column>
                                        </p:row>
                                    </f:facet>
                                </p:panelGrid>
                                <p:messages id="gmMessages"/>
                            </div>
                        </h:form>
                    </p:layoutUnit>
                </p:layout>
        </ui:composition>
    </h:body>
</html> 
```

现在客户端代码可以工作了，因为如果我只用一个 Hello 标头替换 graphicsMessage.xhtml 的代码，我就可以毫无问题地交换内容。emailTemplate 与graphicMessage.xhtml 几乎相同。为简单起见，我将每个页面都替换为一个通用的 Hello！文本（一次一个，所以一页有完整的内容，另一页有一个简单的 Hello 文本），它不起作用。如果我只用纯文本交换两者，它就可以工作。所以问题在于所有 JSF 组件的主要内容。我调试了生命周期，它永远不会超过第一阶段。

注意：我做的最后一件事是逐个撕下内容，直到它起作用，然后我将问题缩小到 p:ajax 标签。在布局中使用它们会导致生命周期中断。我需要该标签，以便可以根据数据表中选择的行填充属性。我还需要它来显示在选择一个菜单中选择的图像。有任何想法吗？我没有看到太多关于 PF ajax 标签的使用，我也看不到我做错了什么。如果我包含它并设置渲染属性，则此代码有效。

# wxpython - wxPython 内存泄漏与 setValue

> ID：11564123
> 
> 赞同：2
> 
> 时间：2012-07-19T15:26:46.507
> 
> 标签：wxpython

我在 Mac OS X 10.6.8、wxPython 2.9.3.1 和 64 位 Python v2.7.2 下运行以下代码：

```
import wx

class MyFrame(wx.Frame):
    def __init__(self):
        super(MyFrame,self).__init__(None, title="Frame", size=(100, 100))
        self.field = wx.TextCtrl(self, -1, "Text", (30, 7))
    def startLoop(self):
        counter = 0
        while True:
            counter += 1
            self.field.SetValue(str(counter))
            wx.Yield()
class Main(wx.App):
    def __init__(self):
        self.counter = 0
        super(Main,self).__init__(0)

    def OnInit(self):
        self.frame = MyFrame()
        self.frame.Show()
        self.frame.startLoop()
        self.MainLoop()
        return True
Main() 
```

它只会消耗更多的内存。我是在做一些非常错误的事情还是 wxPython 被严重破坏了？最重要的是有一个解决方法，因为我已经编写了一个基于 wxPython 的巨大 GUI。

非常感谢！

wx.StaticText 在上面的代码中泄漏完全相同。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T16:44:37.340

Mike 的回答至少部分正确，如果可以的话，避免使用 wx.Yield 总是一个好主意。切换到使用 EVT_IDLE 事件后，仍然存在明显的内存泄漏，尽管它比以前小得多且速度慢得多。切换到 wx.StaticText 而不是 wx.TextCtrl 显示完全没有泄漏，因此似乎确实存在与 wx.TextCtrl.SetValue 相关的问题。请在 trac.wxwidgets.org 上制作一张票，并将组件设置为 wxOSX-cocoa，并包含指向此页面的链接。

```
import wx

class MyFrame(wx.Frame):
    def __init__(self):
        super(MyFrame,self).__init__(None, title="Frame", size=(100, 100))
        ##self.field = wx.TextCtrl(self, -1, "Text", (30, 7))
        self.field = wx.StaticText(self)

    def startIdle(self):
        self.counter = 0
        self.Bind(wx.EVT_IDLE, self.onIdle)

    def onIdle(self, evt):
        self.counter += 1
        ##self.field.SetValue(str(self.counter))
        self.field.SetLabel(str(self.counter))
        evt.RequestMore()

class Main(wx.App):
    def OnInit(self):
        self.frame = MyFrame()
        self.frame.Show()
        self.frame.startIdle()
        self.MainLoop()
        return True
Main() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T15:48:29.557

我怀疑您调用 wx.Yield 过于频繁，并且事件正在堆积。我怀疑你的 GUI 也反应灵敏。更好的方法是只使用 wx.Timer 并让它定期更新标签。您必须在 wxPython 邮件列表上询问才能获得真正的技术性答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-20T19:27:44.187

OSX 具有自动释放池的概念，即许多操作系统“临时”对象仅在通过事件循环迭代后才被清除，您的紧密循环永远不会让操作系统有机会清除任何东西，调用 yield 在这里没有帮助。

The reason for the memory consumption in Robin's idle implementation when using the textctrl is the fact that - as long as the textfield has the focus - it stores everything in its undo-stack, this memory is only reclaimed when the focus changes. I'll see whether I can turn this off automatically.

Thanks for bringing this up.

# .net - 确定哪些表单在 WinForms 中以模态方式覆盖父表单

> ID：11564133
> 
> 赞同：0
> 
> 时间：2012-07-19T15:27:06.310
> 
> 标签：.net, vb.net, winforms

我正在尝试找出哪些表单阻止了父模式。

我的环境有点复杂。我有一个 AppToolBar（如任务栏），它是应用程序的主要形式。因此，我自己的工具栏打开的所有表单都是

```
ShowInTaskbar = False 
```

因为有显示在我自己的工具栏中。此外，应用程序直接（通过 AppToolBar）打开的所有表单都存储在列表中。假设我有 Form1、Form2 和 Form3。Form1和Form2由AppToolBar直接打开，Form3由Form1创建然后显示

```
Form3.ShowDialog(Form1) 
```

在某些时候，用户最小化我的整个应用程序，然后调用

```
Form1.Hide
Form2.Hide 
```

我无法将 Form1 的状态设置为最小化，因为它不会显示在任务栏中，因为它会在任务栏上方显示为最小化窗口。现在 Form1 应该调用 Form3.Hide。那么我怎样才能发现，从 Form1 的角度来看，Form3 阻止了 Form1？

干杯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-18T09:15:41.300

只是为了让这个问题被标记为已回答并且汉斯没有发布他的解决方案，我会的。

您将通过调用获得所有打开的表格

```
Application.OpenForms 
```

这将使您返回所有表格。要找出哪些表单阻止了 Form1，您只需在所有打开的表单中搜索*所有者属性并返回**所有者*为 Form1的那些表单。

# java - 使用 Jackson 序列化根原始对象

> ID：11564135
> 
> 赞同：6
> 
> 时间：2012-07-19T15:27:11.797
> 
> 标签：java, json, serialization, jackson

我面临以下问题。当杰克逊序列化器被传递一个包装原语进行序列化时，这个原语被序列化，例如：

```
objectMapper = new ObjectMapper();

StringWriter w = new StringWriter();
objectMapper.writeValue(w, Integer.valueOf(10));
System.out.println(w.toString()); 
```

`10`作为输出产生。然而`10`，它不是一个有效的 JSON（根据[jsonlint](http://jsonlint.com/)），应该用方括号（`[10]`，因此它将是一个单元素数组）或花括号（`{value:10}`，因此它将是一个具有虚拟属性的对象）。该问题影响数字，, `java.lang.String`, `java.util.Date`...

我的问题是：如何让杰克逊执行包装？杰克逊不应该总是产生一个有效的 JSON 吗？

我已经分析了`SerializationConfig.Feature.WRAP_ROOT_VALUE`启用启用的杰克逊行为：它没有按我预期的那样工作。原语现在被序列化为有效的 JSON ( `{"Integer":10}`)，但“普通”Java bean 也被包装，这是不受欢迎的（`{"MyBean":{"field":value, ...}}`而不是`{"field":value, ...}`）。

如果有人可以建议如何自定义杰克逊，也许使用自定义序列化程序。困难在于必须区分根原始包装器（需要包装）和 bean 原始属性（不需要包装）。

为了使故事更完整：Jackson 序列化器用作 Spring MVC 的消息转换器，我怀疑编写一个挂钩来拦截原语的序列化是否相当容易（它不会调用 Jackson，但会`"[" + String.toString(obj) + "]"`在必要时简单地返回）。所以我更喜欢调谐杰克逊的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-28T12:28:59.740

Finally the custom serializer

```
import java.io.IOException;

import org.codehaus.jackson.JsonGenerationException;
import org.codehaus.jackson.JsonGenerator;
import org.codehaus.jackson.map.SerializerProvider;
import org.codehaus.jackson.map.ser.std.ScalarSerializerBase;

public class NumberSerializer extends ScalarSerializerBase<Number> {

    protected NumberSerializer() {
        super(Number.class);
    }

    @Override
    public void serialize(Number value, JsonGenerator jgen, SerializerProvider provider) throws IOException,
                JsonGenerationException {
        if (jgen.getOutputContext().inRoot()) {
            jgen.writeStartArray();
            jgen.writeNumber(value.longValue());
            jgen.writeEndArray();
        }
        else {
            jgen.writeNumber(value.longValue());
        }
    }
} 
```

did a job for me. Serializer can be registered as module (see [here](http://wiki.fasterxml.com/JacksonHowToCustomSerializers)).

Note when using this seriazlier: As it turns all primitive into primitive arrays with only one element, is breaks the reflection principle in a sense that `A != desrialize(serialize(A))` where `A` is some primitive.

# java - 符合垃圾回收条件的对象

> ID：11564137
> 
> 赞同：6
> 
> 时间：2012-07-19T15:27:18.800
> 
> 标签：java, scjp

这个问题取自[Kathy Sierra](https://en.wikipedia.org/wiki/Kathy_Sierra) [SCJP 1.6](https://rads.stackoverflow.com/amzn/click/com/0071591060)。有多少对象符合垃圾回收条件？

根据 Kathy Sierra 的回答，它是`C`. 这意味着两个对象有资格进行垃圾回收。我已经给出了答案的解释。*但是为什么`c3`不符合[垃圾回收](http://en.wikipedia.org/wiki/Garbage_collection_%28computer_science%29)（GC）的条件呢？*

```
class CardBoard {
    Short story = 200;
    CardBoard go(CardBoard cb) {
    cb = null;
    return cb;
}

public static void main(String[] args) {
    CardBoard c1 = new CardBoard();
    CardBoard c2 = new CardBoard();
    CardBoard c3 = c1.go(c2);
    c1 = null;
    // Do stuff
} } 
```

何时`// Do stuff`达到，有多少对象符合 GC 条件？

*   答：0
*   乙：1
*   C: 2
*   D：编译失败
*   E：不可能知道
*   F：运行时抛出异常

回答：

*   C 是正确的。只有一个 CardBoard 对象 (c1) 符合条件，但它有一个关联的`Short`包装对象也符合条件。
*   A、B、D、E、F 根据以上判断是不正确的。（目标 7.4）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-19T15:42:50.320

让我们逐行分解：

```
CardBoard c1 = new CardBoard(); 
```

我们现在有两个对象，`CardBoard` `c1`点 和`Short` `c1.story`。GC 中的`c1`点`CardBoard`和点的变量`story`都不能用于...`CardBoard``Short`

```
CardBoard c2 = new CardBoard(); 
```

与上面类似，我们现在有四个对象，没有一个可用于 GC。

```
CardBoard c3 = c1.go(c2); 
```

我们在 指向的 CardBoard 上调用 go 方法`c1`，传递其值是对Object`c2`的引用。`CardBoard`我们将参数设为空，但 Java 是按值传递的，这意味着`c2`变量本身不受影响。然后我们返回空参数。`c3`是`null`，`c1`并且`c2`不受影响。我们还有 4 个对象，没有一个可以被 GC 处理。

```
c1 = null; 
```

我们为空`c1`。之前指向的`CardBoard`对象`c1`现在没有任何指向它，它可以被 GC'd。因为该对象`story`内的变量`CardBoard`是唯一指向 的东西`Short`，并且因为该`CardBoard`对象有资格进行 GC，所以`Short`也有资格进行 GC。这给了我们 4 个对象，其中 2 个可以被 GC 处理。符合 GC 条件的对象是以前由`c1`和引用的对象`c1.story`。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-19T15:36:30.123

从来没有存在过`c3`指向的对象。`c1`构造函数只被调用了两次，两个对象，一个由and指向`c2`。 `c3`只是一个引用，除了空指针之外从未分配过任何东西。

当前指向 null的引用`c3`不会超出范围并从堆栈中删除，直到跨过 main 方法末尾的右大括号。

最初分配给它的对象`c1`是不可达的，因为`c1`引用被设置为null，但是`c2`引用并没有改变，所以分配给它的对象仍然可以通过`c2`引用从这个范围内到达。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-19T15:29:33.650

`c3`是`null`，所以显然没有符合垃圾收集条件的对象。

请注意，仅`CardBoard`创建了两个对象，这两个对象位于以下行：

```
CardBoard c1 = new CardBoard();
CardBoard c2 = new CardBoard(); 
```

在引用杂耍之后，只有其中一个是没有引用的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-03-18T12:59:05.847

正式正确的答案是我们不知道。而我们不知道的原因是这一行：

```
Short story = 200; 
```

这编译为以下字节码：

```
CardBoard();
Code:
   0: aload_0
   1: invokespecial #1                  // Method java/lang/Object."<init>":()V
   4: aload_0
   5: sipush        200
   8: invokestatic  #2                  // Method java/lang/Short.valueOf:(S)Ljava/lang/Short;
  11: putfield      #3                  // Field story:Ljava/lang/Short;
  14: return 
```

第 8 行是这里的关键`Short.valueOf()`，它返回一个盒装的原语等价物`200`。让我们看一下Javadoc `Short.valueOf()`：

> 此方法将始终缓存 -128 到 127（含）范围内的值，并且可能缓存此范围之外的其他值。

200 超出了“必须缓存”范围，因此属于“可能缓存”。如果它被缓存，那么当它的包含实例是时，它的值`story`将不符合 GC 的条件。`CardBoard`如果它没有被缓存，`story`将无法访问并因此被 GC。

为了使问题明确（并且建议的答案正确），代码应修改如下：

```
Short story = new Short(200); 
```

**更新：**[Javadoc](http://docs.oracle.com/javase/6/docs/api/java/lang/Short.html#valueOf%28short%29)的1.6 版本比我引用的`Short.valueOf()`1.8 版本更神秘，但同样的逻辑适用：仅通过查看代码无法判断是否`Short`将返回新的或缓存的实例。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-07-19T15:38:45.793

如果您注意到代码中只创建了两个对象。c3 从未初始化为对象，它是一个空引用。因此，只有一个“对象”有资格进行垃圾收集。

# ios - iOS将子视图添加到滚动视图

> ID：11564139
> 
> 赞同：1
> 
> 时间：2012-07-19T15:27:25.227
> 
> 标签：ios, xcode

我正在使用双 for 循环以网格格式将 UIButtons 添加到 UIScrollView。这些 UIButtons 需要一些时间来加载，因为它们具有 UIImageViews 的子视图，这些子视图通过从 Internet 下载数据来获取它们的 UIImages。

现在，直到方法完全执行完成后，子视图才会显示。如果我错了，请纠正我，但我猜 xcode 在方法执行完成之前不会显示添加的子视图。

但是，我确实想显示每个子视图一次添加一个，作为一种很酷的加载效果。我将如何实现这一点？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T15:38:51.517

你应该使用多个线程来加载你的图片，这样你的主线程就不会变得迟缓。`viewWillAppear`我最近写了类似的东西......从我的方法中看一下我的代码：

```
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
    self.myImages = [self.myModel retrieveAttachments]; //Suppose this takes a long time
    for (UIImage *image in self.myImages) 
    {
        dispatch_async(dispatch_get_main_queue(), ^{
            [self addImageToScrollView:image animated:YES]; });
    }
}
}); 
```

addImageToScrollView 方法是这样的：

```
-(void) addImageToScrollView: (UIImage *) image animated: (BOOL) animated
{
    //Create image view
    UIImageView *imageView = [[UIImageView alloc] initWithImage:image];
    imageView.image = image;

    if(animated)
    {
        imageView.alpha = 0;
        [self.myScrollView addSubview:imageView];
        [UIView animateWithDuration:ADD_IMAGE_APPEARING_ANIMATION_SPEED animations:^{
            imageView.alpha = 1;
        }];
    }
    else
    {
        [self.myScrollView addSubview:imageView];
    }
} 
```

# php - WordPress - 仅当 LT IE 9 时才将脚本排入队列

> ID：11564142
> 
> 赞同：29
> 
> 时间：2012-07-19T15:27:33.450
> 
> 标签：php, javascript, wordpress, internet-explorer, polyfills

在 WordPress 主题中，如何有条件地包含 ie8 及以下版本的脚本？这主要是为各种 html5/css3 功能应用 polyfill。我看到 wp 有 $is_IE 变量，它可以用作仅包含 IE 脚本的条件。有没有办法只为某些版本的 IE 而不是所有版本添加脚本？这对于一些 HTML 即条件注释很简单，但我想将脚本全部包含在我的函数文件中的相同位置。

HTML 中特定版本的条件：

`<!--[if lt IE 9]> <script src="iepolyfill.min.js"></script> <![endif]-->`

WP 中所有 IE 的条件：

```
 global $is_IE;

    if ( $is_IE ) {
        wp_enqueue_script( 'iepolyfill', bloginfo('stylesheet_directory').'/js/iepolyfill.min.js' );
    } 
```

我环顾四周，主要找到有关 wp 后端条件脚本的详细信息。

有什么建议么？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2013-04-25T17:31:53.493

**对于 WordPress 4.2+**

用于[`wp_script_add_data`](https://developer.wordpress.org/reference/functions/wp_script_add_data/)将脚本包装在条件注释中：

```
wp_enqueue_script( 'html5shiv', '//cdn.jsdelivr.net/html5shiv/3.7.2/html5shiv.js' );
wp_script_add_data( 'html5shiv', 'conditional', 'lt IE 9' );

wp_enqueue_script( 'respond', get_template_directory_uri() . '/js/respond.min.js' );
wp_script_add_data( 'respond', 'conditional', 'lt IE 9' ); 
```

只需确保在调用之前注册脚本`wp_script_add_data`（注册由`wp_enqueue_script`上面处理），并且您传递给`wp_script_add_data`的第一个参数与您在注册​​脚本时传递的第一个参数匹配。

* * *

**对于 WordPress 4.1**

您现在可以使用[`script_loader_tag`过滤器](https://developer.wordpress.org/reference/hooks/script_loader_tag/)将包含在条件注释中的脚本排入队列。这是一个示例实现：

```
wp_enqueue_script( 'html5shiv', '//cdn.jsdelivr.net/html5shiv/3.7.2/html5shiv.js', array(), '3.7.2', false );
add_filter( 'script_loader_tag', function( $tag, $handle ) {
    if ( $handle === 'html5shiv' ) {
        $tag = "<!--[if lt IE 9]>$tag<![endif]-->";
    }
    return $tag;
}, 10, 2 ); 
```

如果你想以同样的方式包含多个脚本，你可以使用类似的东西：

```
// Conditional polyfills
$conditional_scripts = array(
    'html5shiv'           => '//cdn.jsdelivr.net/html5shiv/3.7.2/html5shiv.js',
    'html5shiv-printshiv' => '//cdn.jsdelivr.net/html5shiv/3.7.2/html5shiv-printshiv.js',
    'respond'             => '//cdn.jsdelivr.net/respond/1.4.2/respond.min.js'
);
foreach ( $conditional_scripts as $handle => $src ) {
    wp_enqueue_script( $handle, $src, array(), '', false );
}
add_filter( 'script_loader_tag', function( $tag, $handle ) use ( $conditional_scripts ) {
    if ( array_key_exists( $handle, $conditional_scripts ) ) {
        $tag = "<!--[if lt IE 9]>$tag<![endif]-->";
    }
    return $tag;
}, 10, 2 ); 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2013-01-16T18:00:27.793

*   `wp_register_script()`每当您将脚本添加到您的 WP 主题或插件时，您都应该使用它。
*   服务器端嗅探通常是个坏主意，因为它不确定。
*   通常您希望针对缺乏某些功能的浏览器，不一定只针对 IE 浏览器。[Modernzr](http://modernizr.com/)是一个很好的脚本来做到这一点。

对于 IE，条件标签效果很好。以下是如何将条件标签添加到脚本中，例如[HTML5shiv](https://github.com/aFarkas/html5shiv)：

```
global $wp_scripts;
wp_register_script( 
    'html5shiv', 
    get_bloginfo('template_url').'/assets/js/html5shiv.js', 
    array(), 
    '3.6.2'
    );
$wp_scripts->add_data( 'html5shiv', 'conditional', 'lt IE 9' ); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-06-11T12:20:57.783

**WordPress 4.2 及以上版本的解决方案**

正确的方法是应用 wp_enqueue_script，因为它在这里是 JavaScript，而不是 css 样式。此外，最好使用 get_bloginfo('stylesheet_url') 来确保这也适用于子主题。

```
/**
 * IE Fallbacks
 */

function load_IE_fallback() {
    wp_register_script( 'ie_html5shiv', get_bloginfo('stylesheet_url'). '/js/html5shiv.min.js', __FILE__, false, '3.7.2' );
    wp_enqueue_script( 'ie_html5shiv');
    wp_script_add_data( 'ie_html5shiv', 'conditional', 'lt IE 9' );

    wp_register_script( 'ie_respond', get_bloginfo('stylesheet_url'). '/js/respond.min.js', __FILE__, false, '1.4.2' );
    wp_enqueue_script( 'ie_respond');
    wp_script_add_data( 'ie_respond', 'conditional', 'lt IE 9' );
}
add_action( 'wp_enqueue_scripts', 'load_IE_fallback' ); 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2017-03-26T17:50:47.607

使用从 CDN 加载的脚本更新 WordPress 4.7.3：

```
 add_action( 'wp_enqueue_scripts', 'load_IE_fallback' );
function load_IE_fallback() {
    wp_register_script( 'ie_html5shiv', 'https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js', '', '3.7.3', false );
    wp_register_script( 'ie_respond', 'https://oss.maxcdn.com/respond/1.4.2/respond.min.js', '', '1.4.2', false );

    wp_enqueue_script( 'ie_html5shiv');
    wp_enqueue_script( 'ie_respond');

    wp_script_add_data( 'ie_html5shiv', 'conditional', 'lt IE 9' );    
    wp_script_add_data( 'ie_respond', 'conditional', 'lt IE 9' );
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-02-27T13:20:44.897

最好的方法是将脚本排入队列，然后使用 wp_style_add_data() 放置条件。这种方法被官方主题使用，比如[二十三](https://core.trac.wordpress.org/browser/tags/3.9.2/src/wp-content/themes/twentythirteen/functions.php#L185)

有一个与此类似的答案，但如果条件错误，他会添加额外的内容。

```
wp_register_style( 'ie_html5shiv', get_template_directory_uri() . '/js/html5shiv.js' );
    wp_enqueue_style( 'ie_html5shiv');
    wp_style_add_data( 'ie_html5shiv', 'conditional', 'lt IE 9' );

    wp_register_style( 'ie_respond', get_template_directory_uri() . '/js/respond.min.js' );
    wp_enqueue_style( 'ie_respond');
    wp_style_add_data( 'ie_respond', 'conditional', 'lt IE 9' ); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-19T15:51:24.050

由于 wordpress 是一个 PHP 脚本，它可以通过 $_SERVER 访问服务器变量

然后你可以搜索检测浏览器 PHP, [PHP: If internet explorer 6, 7, 8 , or 9](https://stackoverflow.com/questions/5302302/php-if-internet-explorer-6-7-8-or-9)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-08-11T07:02:00.840

尝试使用`wp_style_add_data()`功能（官方在[二十三](https://core.trac.wordpress.org/browser/tags/3.9.2/src/wp-content/themes/twentythirteen/functions.php#L185)和[二十四](https://core.trac.wordpress.org/browser/tags/3.9.2/src/wp-content/themes/twentyfourteen/functions.php#L236)主题中使用：

```
wp_enqueue_style( 'iepolyfill', bloginfo( 'stylesheet_directory' ) . '/js/iepolyfill.min.js' );
wp_style_add_data( 'iepolyfill', 'conditional', 'if lt IE 9' ); 
```

**更新：**由于 WordPress >= 4.2.0 有一个以相同方式使用的函数。它被称为：

```
wp_script_add_data() 
```

# java - 分析 Java 应用程序：递归方法的累积时间

> ID：11564143
> 
> 赞同：0
> 
> 时间：2012-07-19T15:27:33.830
> 
> 标签：java, profiling, visualvm

考虑这个使用 a 的生产者-消费者代码`ArrayBlockingQueue`：我想找出 a。`put()`/总共消耗了多少总时间`take()`？湾。`put()`和`take()`调用等待的总时间是多少？封锁？

在 VisualVM 中拍摄快照仅显示 run() 的深度，但不显示`put()`/`take()`调用。知道如何获得这些时间吗？

一般来说，如何从 ? 递归地获得所有方法的累积运行时间`main()`？

```
final BlockingQueue<Integer> queue = new ArrayBlockingQueue<Integer>(QUEUE_SIZE);
    ExecutorService exec = Executors.newFixedThreadPool(2);
    exec.submit(new Runnable() {
        int i =0;
        @Override
        public void run() {
            while(i++<NUM)
                try {
                    queue.put(i);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }

        }
    });

    exec.submit(new Runnable() {
        int i =0;
        @Override
        public void run() {
            while(i++<NUM)
                try {
                    queue.take();
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            consumerFinished.countDown();
        }
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:38:13.670

您需要更改过滤掉所有属于`java.*`包的代码的“CPU 设置”。检查“采样器”选项卡上的“设置”并在新预设中编辑“CPU 设置”。预设在 CPU 设置选项卡的底部进行管理。

# c# - 我可以使用 Html.Raw 为卡片套装设置一个字母代码吗？

> ID：11564145
> 
> 赞同：2
> 
> 时间：2012-07-19T15:27:34.150
> 
> 标签：c#, razor, webmatrix

这是我在 WebMatrix 中的 cshtml 文件（Razor 语法）。有没有办法使用像@S 这样非常短的东西来输出西装符号？也就是说，我想将@Html.Raw(S) 减少为@S。可以以某种方式完成吗？我尝试了我认为的俱乐部套装的外观，但没有奏效。

```
@{
    var S = "&spades;";
    var C = @"Html.Raw(""&clubs;"")";    
}

@Html.Raw(S)  <br />
@C 

<!-- output is 
♠ 
Html.Raw("&clubs;") 
--> 
```

===============================================

感谢@GSerg，我得到了♣ ♦ ♥ ♠ 与您的代码：

```
@{
    var C = Html.Raw("&clubs;");  
    var D = Html.Raw("&diams;"); 
    var H = Html.Raw("&hearts;"); 
    var S = Html.Raw("&spades;"); 
}

@C  @D  @H  @S 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T15:31:50.497

```
var C = new MvcHtmlString("&clubs;"); 
```

另一方面，

```
var C = Html.Raw("&clubs;"); 
```

完全一样。

# haskell - 禁用窗体/消化函子中的字段？

> ID：11564147
> 
> 赞同：4
> 
> 时间：2012-07-19T15:27:36.070
> 
> 标签：haskell, webforms, applicative, digestive-functors

使用 formlets/digestive-functors，我试图弄清楚如何在运行时选择性地禁用字段。禁用字段将禁用该字段的显示和验证。

人为的示例：假设我们的基本表单数据类型如下所示：

```
data Info =
  Info {
     favcolor :: String,
     deptId   :: Int,
     company  :: String,
     agree    :: Boolean
  } 
```

但`deptId`仅当用户是员工时才应显示该`company`字段，否则应显示该字段。`agree`如果用户尚未单击“同意”框，则应显示该字段。

我不想为每个可能的变体创建不同的表单类型：（favcolor，deptId，agree），（favcolor，deptId），（favcolor，company，agree），（favcolor，company）。我还可以做些什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T19:41:49.793

我认为这打破了消化函子模型并且无法完成。不过，这将是一个很好的功能请求！

# c++ - 如何在 C++ 中获取进程的起始地址/基地址？

> ID：11564148
> 
> 赞同：7
> 
> 时间：2012-07-19T15:27:36.840
> 
> 标签：c++, windows, memory, process, base-address

我正在通过在 Microsoft 的 Spider Solitaire 上使用它来测试整个基本/静态指针。所以我得到了玩家使用的“移动”数量的基本指针，作弊引擎告诉我它是“SpiderSolitaire.exe+B5F78”。所以现在我被困在如何弄清楚 SpiderSolitaire.exe 的起始地址是什么（当然每次程序启动时都会改变）。如何找到 SpiderSolitaire.exe 的起始地址，以便我可以添加偏移量并获取“移动”值的真实地址（当然是在 c++ 中）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2016-07-20T04:12:19.947

这是另一种方式，用 Visual Studio 2015 编写，但应该向后兼容。

```
#define PSAPI_VERSION 1
#include <windows.h>
#include <tchar.h>
#include <stdio.h>
#include <psapi.h>

// To ensure correct resolution of symbols, add Psapi.lib to TARGETLIBS
#pragma comment(lib, "psapi.lib")

void GetBaseAddressByName(DWORD processId, TCHAR *processName)
{
    TCHAR szProcessName[MAX_PATH] = TEXT("<unknown>");

    HANDLE hProcess = OpenProcess(PROCESS_QUERY_INFORMATION |
        PROCESS_VM_READ,
        FALSE, processId);

    if (NULL != hProcess)
    {
        HMODULE hMod;
        DWORD cbNeeded;

        if (EnumProcessModulesEx(hProcess, &hMod, sizeof(hMod),
            &cbNeeded, LIST_MODULES_32BIT | LIST_MODULES_64BIT))
        {
            GetModuleBaseName(hProcess, hMod, szProcessName,
                sizeof(szProcessName) / sizeof(TCHAR));
            if (!_tcsicmp(processName, szProcessName)) {
                _tprintf(TEXT("0x%p\n"), hMod);
            }
        }
    }

    CloseHandle(hProcess);
}

int main(void)
{
    DWORD aProcesses[1024];
    DWORD cbNeeded;
    DWORD cProcesses;

    // Get the list of process identifiers.
    if (!EnumProcesses(aProcesses, sizeof(aProcesses), &cbNeeded))
        return 1;

    // Calculate how many process identifiers were returned.
    cProcesses = cbNeeded / sizeof(DWORD);

    // Check the names of all the processess (Case insensitive)
    for (int i = 0; i < cProcesses; i++) {
        GetBaseAddressByName(aProcesses[i], TEXT("SpiderSolitaire.exe"));
    }

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-08-18T02:48:51.680

这是一些用于查找给定进程的基地址的代码。

请注意，此代码使用多字节字符集；在 VS2012 中，这是从 Properties > Configuration Properties > Project Defaults > Character Set > Use Multi-Byte Character Set 设置的。

```
#define _CRT_SECURE_NO_WARNINGS
#define UNINITIALIZED 0xFFFFFFFF

#include <iostream>
#include <iomanip>
#include <Windows.h>
#include <TlHelp32.h> //PROCESSENTRY

/* The name of the process */
const char* processName_ = "REPLACETHIS.exe" ; 

void main(void)
{
DWORD  processID_     = NULL ;
DWORD  processBaseAddress_   = UNINITIALIZED;

/* Get the process ID  */
{
    PROCESSENTRY32 processEntry_ ; // Entry into process you wish to inject to
    HANDLE hProcSnapshot_ = NULL ; 
    /* Takes a snapshot of the system's processes */
    hProcSnapshot_ = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0) ; //?

    /* While process has not been found, keep looking for it */
    while(!processID_)
    {
        /* If a process on the system exists */
        if(Process32First(hProcSnapshot_, &processEntry_)) //?
        {
            /* Check all processes in the system's processes snapshot */
            do
            {
                /* Compare the name of the process to the one we want */
                if( !strcmp(processEntry_.szExeFile, processName_) ) //?
                {
                    /* Save the processID and break out */
                    processID_ = processEntry_.th32ProcessID ;
                    break ;
                }
            } 
            while(Process32Next(hProcSnapshot_, &processEntry_)) ;
        }

        /* Didnt find process, sleep for a bit */
        if( !processID_ )
        {
            system("CLS") ;
            std::cout << "Make sure " << processName_ << " is running." << std::endl ;
            Sleep(200) ;
        }
    }

    /* Process found */
    std::cout << "Found Process: " << processName_ << std::endl ;
}

/* Find Base Address of process */
{
    HANDLE moduleSnapshotHandle_ = INVALID_HANDLE_VALUE;
    MODULEENTRY32 moduleEntry_;

    /* Take snapshot of all the modules in the process */
    moduleSnapshotHandle_ = CreateToolhelp32Snapshot( TH32CS_SNAPMODULE, processID_ );

    /* Snapshot failed */
    if( moduleSnapshotHandle_ == INVALID_HANDLE_VALUE )
    {
        std::cout << "Module Snapshot error" << std::endl ;
        return ;
    }

    /* Size the structure before usage */
    moduleEntry_.dwSize = sizeof( MODULEENTRY32 );

    /* Retrieve information about the first module */
    if( !Module32First( moduleSnapshotHandle_, &moduleEntry_ ) )
    {
        std::cout << "First module not found" << std::endl ;  
        CloseHandle( moduleSnapshotHandle_ );    
        return ;
    }

    /* Find base address */
    while(processBaseAddress_ == UNINITIALIZED)
    {
        /* Find module of the executable */
        do
        {

            /* Compare the name of the process to the one we want */
            if( !strcmp(moduleEntry_.szModule, processName_) ) //?
            {
                /* Save the processID and break out */
                processBaseAddress_ = (unsigned int)moduleEntry_.modBaseAddr ;
                break ;
            }

        } while( Module32Next( moduleSnapshotHandle_, &moduleEntry_ ) );

        if( processBaseAddress_ == UNINITIALIZED )
        {
            system("CLS") ;
            std::cout << "Failed to find module" << processName_ << std::endl ;
            Sleep(200) ;
        }
    }

    /* Found module and base address successfully */
    std::cout << "Base Address: " << std::hex << processBaseAddress_ << std::dec << std::endl ;
    CloseHandle( moduleSnapshotHandle_ );
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T15:39:14.477

您应该查看可执行文件中的结构 IMAGE_OPTIONAL_HEADER。我还建议您阅读这份出色的指南：http: [//msdn.microsoft.com/en-us/library/ms809762.aspx](http://msdn.microsoft.com/en-us/library/ms809762.aspx)

# html - 运行 Construct 2 for Mac

> ID：11564149
> 
> 赞同：1
> 
> 时间：2012-07-19T15:27:39.677
> 
> 标签：html, construct-2

我想在 Mac 上运行构造 2。似乎构造 2 只能在 Windows 上运行。Mac有什么解决方案吗？在这方面需要一些指导......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-04T18:15:29.003

来自Scirra的汤姆！

恐怕我们目前还没有正式支持 Mac，尽管一些用户报告通过 Parallels 等虚拟机 (VM) 在 Mac 上使用 Construct 2 成功。

如果您有虚拟机，请尝试[下载 Construct 2 的免费版本](http://www.scirra.com/construct2/releases/r95)并运行它，看看它是否适合您。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-22T20:11:22.053

想使用构造 2，但不得不使用 gamesalad，因为它更稳定或对 osx 可用！

# ios - 当 UIPopoverController 处于活动状态时，UIWebView 未检测到点击

> ID：11564157
> 
> 赞同：1
> 
> 时间：2012-07-19T15:28:16.523
> 
> 标签：ios, ios5, uiwebview, uipopovercontroller, tap

我在`UIPopoverController`上面展示一个`UIWebView`，为用户展示几个选择选项。但是我发现在弹出框外点击会按预期关闭弹出框，但在 webview 上**未检测到点击。**我必须再次点击 webview 中的相同位置（例如触发下一个弹出框控制器）。

有没有办法让 webview 检测到弹出关闭水龙头？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:34:14.383

您需要查看UIPopoverController的[passthroughViews 属性](http://developer.apple.com/library/ios/documentation/uikit/reference/UIPopoverController_class/Reference/Reference.html#//apple_ref/doc/uid/TP40009306-CH1-SW8)

例子：

```
//if you have these somewhere
//UIPopoverController *popoverController.passthroughViews;
//UIWebView *webView

popoverController.passthroughViews = [NSArray arrayWithObject:webView]; 
```

# android - 如何让应用程序在屏幕上始终处于活动状态

> ID：11564158
> 
> 赞同：-1
> 
> 时间：2012-07-19T15:28:23.690
> 
> 标签：android, android-activity, permissions, controls

我正在开发一个特殊的应用程序，它需要防止用户退出应用程序活动，除了我在应用程序内部建立的方式。例如平板电脑状态栏中的时钟允许进入Android设置，我想阻止它......因为我只需要一些“设备管理员”可以访问android设置和其他应用程序，其他人必须只能使用这个应用程序.

有SDK解决方案吗？

PS 我只需要将功能限制为设备所有者，以防止意外损坏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T15:32:09.190

不，公共 API 中的任何内容都不允许您执行此操作。我知道它有合法的用例，但在所有设备上都有可能会产生重大的安全问题。（即恶意应用程序可以将用户“锁定”在他们自己的设备上。）

您可以获得的最接近的方法是创建一个替换主屏幕，该主屏幕不让用户能够（轻松）去任何地方，除了您想要的地方。

但是，正如您在通知栏中的设置中注意到的那样，这仍然存在漏洞。另一个这样的漏洞是许多 android 键盘包含一个按钮，可以带您进入设置。

此外，用户仍然可以在“安全模式”下启动他们的设备，这会禁用您的应用程序。

如果您希望实现这一点并使其 100% 有效，则必须修改操作系统以允许它。

# java - 带有地理空间查询的 MongoDb $and 运算符

> ID：11564159
> 
> 赞同：4
> 
> 时间：2012-07-19T15:28:25.940
> 
> 标签：java, mongodb

我正在开发一个 Java 系统，其中一部分将表达式从内部表示形式呈现为 MongoDb 查询。我渲染“AND”表达式的方式与渲染“OR”表达式的方式相同。因此，如果我有一个像“category='GIBBLY' AND active=true”这样的表达式，它将呈现为：

`{$and:[{"category":"GIBBLY"},{"active":true}]}`

我知道在这种情况下这不是绝对必要的。*我不*知道是否存在需要 $and 的情况（在我的系统中，通常会有嵌套的 AND 和 OR，如果这有什么不同的话）。

这对我来说是个问题的原因是 $and 运算符似乎无法用于地理空间查询。像这样的查询：

`{"$and":[{"loc":{"$nearSphere":[-79.75 , 43.5], "$maxDistance":0.00156787}}, {"active":true}]}`

失败并出现“找不到特殊索引：2d”错误。如果我将查询重新执行为：

`{"loc":{"$nearSphere":[-79.75 , 43.5], "$maxDistance":0.00156787}, "active":true}`

它工作正常。

我试图做一些研究，并[在 mongodb-user 组上](https://groups.google.com/forum/?fromgroups#!topic/mongodb-user/RBew-fCz3hI)找到了关于该问题的讨论，其中提到了对[地理空间查询中的复合索引](http://www.mongodb.org/display/DOCS/Geospatial+Indexing#GeospatialIndexing-CompoundIndexes)的讨论。

我发现的所有信息都没有真正解释为什么 $and 不能与地理空间查询一起使用。我的数据库中根本没有定义复合索引，并且非 $and 查询有效，所以我不确定 $and 在索引方面的工作方式有何不同。

总而言之，我的问题是：

1.  $and 是否有必要，如果有，在什么情况下？

2.  $and 与索引的隐式表示有什么根本区别吗？

3.  为什么 $and 不能用于地理空间查询？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T17:09:31.953

> $and 是否有必要，如果有，在什么情况下？

这是经典的SQL

```
SELECT * FROM Table
WHERE (x = 1 OR y = 0)
AND   (w = 1 OR z = 0) 
```

在`$and`运营商之前，这很难做到。您不能执行以下操作：

```
db.Table.find({$or: [{x:1},{y:0}] , $or: [{w:1},{z:0}]}) 
```

查询“看起来”正确，但它是无效的 JSON。你会注意到我有两个顶级`$or`键。该逗号应该代表“和”，但在这种情况下它不起作用。

`$and`运营商就是为了解决这个问题而设计的。

> $and 与索引的隐式表示有什么根本区别吗？

它应该编译为相同的基本查询并使用相同的索引。如果没有，这绝对是一个错误。

> 为什么 $and 不能用于地理空间查询？

您看到的行为可能是一个错误，应该报告：http: [//jira.mongodb.org/](http://jira.mongodb.org/)

另外，请注意 MongoDB 对地理空间索引有特殊限制。您的查询可能没有以理想的方式使用索引。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T16:41:21.210

正如您所指出的，在回答您的第一个问题时，在查询中使用逗号是隐含的“和”：

```
db.collection.find({name: "Jenna", number: 1}) 
```

当您需要在单个字段上放置多个过滤器时，$and 运算符是必需的，而这使用逗号语法是不可能的。**例如，要查找包含数字 2和**数字 10的数组的所有文档，您需要 $and 运算符：

文件：

```
{_id: 1, array: [1, 10]}
{_id: 2, array: [2, 10]} 
```

询问：

```
> db.collection.find({$and: [{array: 2}, {array: 10}]})
{_id: 2, array: [2, 10]} 
```

而没有 $and 运算符的查询仅使用“array: 10”并返回两个文档：

```
> db.collection.find({array: 2, array: 10})
{_id: 1, array: [1, 10]}
{_id: 2, array: [2, 10]} 
```

使用 $and 运算符对索引应该没有影响。将使用单个索引来满足查询。

如果它影响您的查询，请随时对与 $and 和地理空间查询相关的 JIRA 票进行投票。

# ios - 如果您使用的是 UIStoryboard，UIViewController 会调用 awakeFromNib 吗？

> ID：11564162
> 
> 赞同：2
> 
> 时间：2012-07-19T15:28:38.690
> 
> 标签：ios, uiviewcontroller, uistoryboard

简单的问题，

如果您使用的是 UIStoryboard，UIViewController 会调用 awakeFromNib 吗？

如果不是，我们应该使用的替代方法是什么？

干杯!

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T16:06:01.907

是的，`awakeFromNib`在使用`UIStoryboard`.

虽然 .storyboard 文件是一个 XML 文档，但当您编译/打包您的应用程序时，它将被转换为一组传统的 .nib 文件，因此解码这些文件将与基于 xib 的项目中的相同。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-19T15:32:31.717

是的，`awakeFromNib`正在被调用。

根据[文档](http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/ViewLoadingandUnloading/ViewLoadingandUnloading.html)：

> 初始化从情节提要加载的视图控制器 当您在情节提要中创建视图控制器时，您在 Interface Builder 中配置的属性存储在存档中。稍后，当视图控制器被实例化时，这个存档被加载到内存中并被处理。结果是一组对象，其属性与您在 Interface Builder 中设置的属性相匹配。以下是该存档的加载方式：
> 
> 如果您的视图控制器实现了一个 initWithCoder: 方法，则调用该方法来处理存档中的信息。如果您的视图控制器没有实现 initWithCoder: 方法，则会调用您的视图控制器的 init 方法。
> 
> 加载存档中的对象后，iOS 会在任何实现此类方法的对象上调用 awakeFromNib 方法。您可以使用此方法执行任何需要已实例化其他对象的配置步骤。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-19T15:34:33.030

`awakeFromNib`使用 UIStoryboard 时会调用 Yes 。

# windows - 检测匿名管道是否可写 - 检测何时结束进程

> ID：11564166
> 
> 赞同：3
> 
> 时间：2012-07-19T15:28:53.310
> 
> 标签：windows, process, pipe

所以继承人的情况（在Windows）：

*   父进程启动了一个子进程，它只打开了一个管道，stdout。
*   为了让父进程结束进程，它调用 pclose
*   我们不能在管道上调用 read 来检测它是否损坏以结束进程（因为它是只写管道，read 总是会立即返回并出现错误）

当读取端（在父级）关闭时，有没有办法从管道中获取事件？如果不是，我们必须不断地向管道写入垃圾，以检测管道何时关闭，这是一种次优且浪费的解决方案。

# c - 从 C 中的一个二进制文本中读取字符串和整数

> ID：11564169
> 
> 赞同：1
> 
> 时间：2012-07-19T15:29:00.517
> 
> 标签：c, file, binary

我正在使用 C，我想从 binaryFile 中读取。

我知道它以以下方式包含字符串：字符串的长度，字符串本身，字符串的长度，字符串本身，等等......

我想计算字符串 Str 在二进制文件中出现的次数。

所以我想做这样的事情：

```
int N;
while (!feof(file)){
    if (fread(&N, sizeof(int), 1, file)==1)
        ... 
```

现在我需要获取字符串本身。我知道它的长度。我应该做一个'for'循环并用fgetc char by char吗？我知道我不允许使用 fscanf，因为它不是文本文件，但我可以使用 fgetc 吗？我会得到我对我的字符串的期望吗？（要对 char* 使用长度大小的动态分配并使用 strcpy 将其添加到当前字符串？）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T15:37:56.670

您可以将一些内存分配`malloc`到`fread`该缓冲区中：

```
char *str;

/* ... */
if (fread(&N, sizeof(int), 1, file)==1)
{
    /* check that N > 0 */
    str = malloc(N+1);
    if (fread(str, sizeof(char), N, file) == N)
    {
        str[N] = '\0'; /* terminate str */
        printf("Read %d chars: %s\n", N, str);
    }

    free(str);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-19T15:38:57.543

你可能应该循环：

```
while (fread(&N, sizeof(int), 1, file) == 1)
{
    // Check N for sanity
    char *buffer = malloc(N+1);
    // Check malloc succeeded
    if (fread(buffer, N, 1, file) != 1)
        ...process error...
    buffer[N] = '\0';  // Null terminate for sanity's sake
    ...store buffer (the pointer) for later processing so you aren't leaking...
    ...or free it if you won't need it later...
} 
```

您可以在循环中使用`getc()`or ；`fgetc()`那行得通。然而，直接`fread()`更简单（并且被编码*为好像*它`getc()`在循环中使用）。

在`N`盲目地将它与`malloc()`. 特别是，消极的价值观可能会导致很多不快乐。

所编写的文件格式与一类机器相关联 - 大端或小端，并且具有固定大小`int`（可能是 32 位）。编写更便携的数据稍微复杂一些，但非常可行——但可能与你目前不相关。

使用`feof()`很少是测试是否继续循环的正确方法。实际上，通常不需要`feof()`在代码中使用。使用它时，这是因为 I/O 操作“失败”，您需要区分“这不是错误 - 只是 EOF”和“设备上出现某种错误”。

# zend-framework - Zend Framework 项目的类似系统的扩展

> ID：11564170
> 
> 赞同：-1
> 
> 时间：2012-07-19T15:29:07.447
> 
> 标签：zend-framework

我正在做一个个人项目，我正在构建我自己的 CMS，主要是为了学习目的，但试图提出一个可以持续扩展的可靠系统。所以为此我喜欢有一个像系统这样的扩展，所以可以创建和管理新的扩展，每个扩展都有自定义设置等等。

使用 Zend 框架，使用 Zend 插件系统来完成这样的事情的最佳方法是什么？资源？我刚刚开始使用 zend 框架，所以一些想法会对我有很大帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:51:43.097

这取决于你想怎么做。Zend 的插件系统，并不是真正的插件系统。您可以将内容添加到库中并以各种方式访问​​它们，但没有什么比 Wordpress 为插件或扩展提供的功能。

我认为（如果您真的想重新发明轮子），最好在应用程序中创建自己的 API（使用函数调用和可扩展的辅助类）。否则，每个插件都将类似于操作或视图助手。

另一种选择是跳上 ZF 2 船，看看 ZF 2 模块。

# asp.net - 如何将提要凭据传递给允许 Linq to XML 工作的 XDocument

> ID：11564172
> 
> 赞同：0
> 
> 时间：2012-07-19T15:29:09.463
> 
> 标签：asp.net, linq-to-xml

我可以获取变量 xmlDoc 的结果并将其保存到 xml 文档（在磁盘上），然后查询返回结果；但是，当我实时运行它（使用下面的代码）时，查询结果为空。

为什么我的查询不适用于 xmlDoc？有关调试输出“xmlDoc.Root”，请参见下面的屏幕截图。

必须有一种更简洁的方法来创建 XDocument??

```
System.Net.WebClient wc = new System.Net.WebClient();

wc.Credentials = new System.Net.NetworkCredential("bagee18@gmail.com", "my_password");

XDocument xmlDoc = XDocument.Parse(wc.DownloadString(new Uri("https://mail.google.com/mail/feed/atom")), LoadOptions.None);

var q = (from c in xmlDoc.Descendants("entry")

        select new
        {
            name = c.Element("title").Value,
            url = c.Element("link").Attribute("href").Value,
            email = c.Element("author").Element("email").Value
        }).ToList();

q.Dump(); 
```

xmlDoc.Root：

![XML 的屏幕截图](../Images/00543f9fa3a81c28403e59b69edf1546.png).

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T16:36:00.107

考虑命名空间：

```
XNamespace df = xmlDoc.Root.Name.Namespace;

var q = (from c in xmlDoc.Descendants(df + "entry")

        select new
        {
            name = c.Element(df + "title").Value,
            url = c.Element(df + "link").Attribute("href").Value,
            email = c.Element(df + "author").Element(df + "email").Value
        }).ToList(); 
```

# c# - 如何将多个网页转换为一个 pdf 文档？

> ID：11564173
> 
> 赞同：-1
> 
> 时间：2012-07-19T15:29:15.370
> 
> 标签：c#, asp.net

```
public FileResult Download() 
{ 

    var doc = new EO.Pdf.PdfDocument(); 
    EO.Pdf.HtmlToPdf.ConvertUrl("http://www.google.com/", doc); 

    var ms = new MemoryStream();     
    doc.Save(ms); 

    ms.Position = 0; 

    return new FileStreamResult(ms, "application/pdf") 
               { 
                   FileDownloadName = "download.pdf"
               }; 
} 
```

如果可能的话，您能否展示一下如何扩展上面的代码以便能够将多个网页转换为一个 pdf 文档？

棘手的部分是我们不知道用户可能会尝试转换哪些页面。

因此，如上面的代码所示对网页进行硬编码对我们没有帮助。

任何帮助是极大的赞赏。

```
//Create a new PdfDocument object
var doc = new EO.Pdf.PdfDocument();

//Convert two ore more different pages into the same PdfDocument

EO.Pdf.HtmlToPdf.ConvertUrl("c:\\1.html", doc);

EO.Pdf.HtmlToPdf.ConvertUrl("c:\\2.html", doc); 
```

最新代码：

```
public FileResult Download() 
{ 
    var doc = new EO.Pdf.PdfDocument(); 

foreach(var url in passedUrls)  
{ 
EO.Pdf.HtmlToPdf.ConvertUrl(url, doc);   
doc.Save(ms);   
}

    ms.Position = 0; 

    return new FileStreamResult(ms, "application/pdf") 
               { 
                   FileDownloadName = "download.pdf"
               }; 
} 
```

亚当的最新消息（谢谢先生）

```
public FileResult Download() 
{ 

var documents = new List<EO.Pdf.PdfDocument>(); 
foreach(var url in passedUrls) 
{ 
    var doc = new EO.Pdf.PdfDocument(); 
    EO.Pdf.HtmlToPdf.ConvertUrl(url, doc); 
    documents.Add(doc); 
} 

EO.Pdf.PdfDocument mergedDocument = EO.Pdf.PdfDocument.Merge(documents.ToArray()); 
} 
```

希望其他人发现这些代码很有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T15:56:09.057

根据[帮助文档](http://www.essentialobjects.com/doc/4/eo.pdf.pdfdocument.merge_overloads.aspx)，我建议以下内容：

```
public FileResult Download()
{
    var urls = new List<string>
    { // Populate list with urls
        "C:\\1.html",
        "C:\\2.html"
    };

    var documents = new List<EO.Pdf.PdfDocument>();
    foreach(var url in urls)
    {
        var doc = new EO.Pdf.PdfDocument();
        EO.Pdf.HtmlToPdf.ConvertUrl(url, doc);
        documents.Add(doc);
    }

    EO.Pdf.PdfDocument mergedDocument = EO.Pdf.PdfDocument.Merge(documents.ToArray());

    var ms = new MemoryStream();
    mergedDocument.Save(ms);
    ms.Position = 0;

    return new FileStreamResult(ms, "application/pdf") { FileDownloadName = "download.pdf" };
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T15:32:55.603

将一组 url 字符串传递给函数

然后

```
foreach(var url in passedUrls) 
{
EO.Pdf.HtmlToPdf.ConvertUrl(url, doc);  
doc.Save(ms);  
} 
```

# mysql - Mysql 在存储过程中使用 LAST_INSERT_ID

> ID：11564174
> 
> 赞同：1
> 
> 时间：2012-07-19T15:29:21.863
> 
> 标签：mysql, stored-procedures, last-insert-id

我需要根据插入另一个主表的最后一个 id 创建一个表，为此我创建了以下存储过程：

```
CREATE PROCEDURE `sp_create_campaign`
(
        IN  p_vName         VARCHAR(70),
        IN  p_iIdOper       INT(11),
        IN  p_iIdCount      INT(11),
        IN  p_iIdMoney      INT(11),
        IN  p_cPrefix       CHAR(2),
        IN  p_tComment      TINYTEXT,
        IN  p_iIdUser       VARCHAR(32),
        OUT p_return_code   TINYINT UNSIGNED
)
BEGIN

    DECLARE p_campaign INT(11);

    DECLARE exit handler for sqlexception
    BEGIN
        -- ERROR
            set p_return_code = 1;
            rollback;
    END;

    DECLARE exit handler for sqlwarning
    BEGIN
            -- WARNING
            set p_return_code = 2;
            rollback;
    END;

    START TRANSACTION;

        -- Campaign
        INSERT INTO `db_campaign` 
            (`vName`, `iIdOper`, `iIdCount`, `iIdMoney`, `cPrefix`, `tComment`, `iIdUser`, `dRegister`)
            VALUES
            (p_vName, p_iIdOper, p_iIdCount, p_iIdMoney, p_cPrefix, p_tComment, p_iIdUser, NOW());

        SET p_campaign := LAST_INSERT_ID();

        -- Sales
        SET @s = CONCAT('DROP TABLE IF EXISTS ', 'db_sale_', p_campaign);
        PREPARE stm FROM @s;
        EXECUTE stm;

        SET @x = CONCAT(
                'CREATE TABLE ',
                'db_sale_', p_campaign,
                "(
                `iIdSale`           INT(11) UNSIGNED NOT NULL AUTO_INCREMENT,
                `dDate`             DATETIME NOT NULL DEFAULT '0000-00-00 00:00:00',
                `dSubtotal`         DECIMAL(7,2) UNSIGNED NOT NULL DEFAULT '00.00',
                `dTax`              DECIMAL(7,2) UNSIGNED NOT NULL DEFAULT '00.00',
                `dTotal`            DECIMAL(7,2) UNSIGNED NOT NULL DEFAULT '00.00',
                `iIdMoney`          INT(11) UNSIGNED NOT NULL,
                `iIdOper`           INT(11) UNSIGNED NOT NULL,
                `iIdBankCount`      INT(11) UNSIGNED NOT NULL,
                `iIdGroup`          INT(11) UNSIGNED NOT NULL,
                `iIdUser`           INT(11) UNSIGNED NOT NULL,
                `iIdUserReg`        VARCHAR(32) NOT NULL,
                `dRegister`         DATETIME NOT NULL DEFAULT '0000-00-00 00:00:00',
                PRIMARY KEY (`iIdSale`)
                ) ENGINE=MyISAM DEFAULT CHARSET=utf8;");        

        PREPARE stm FROM @x;
        EXECUTE stm;

    COMMIT;

    -- SUCCESS
    set p_return_code = 0;

END 
```

但问题是只插入第一条记录，建表失败。我哪里失败了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-04-10T10:56:11.163

替换这一行：`SET p_campaign := LAST_INSERT_ID();`

有了这个：`SELECT LAST_INSERT_ID() INTO p_campaign ;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T15:36:41.357

两件事情：

1.  执行`DROP`将隐含`COMMIT`您的交易。

2.  尝试添加

    `DEALLOCATE PREPARE stm;`

在每个`EXECUTE`语句之后。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T15:33:34.590

如果你使用`SET`你需要`=`而不是`:=`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-06-18T13:55:26.033

根据[last_insert_id()的 MySQL 文档](https://dev.mysql.com/doc/refman/5.5/en/information-functions.html#function_last-insert-id)

> 如果存储过程执行更改 LAST_INSERT_ID() 值的语句，则更改后的值会被过程调用之后的语句看到。

使用类似的东西：

`SELECT id INTO p_campaign FROM db_campaign ORDER BY id DESC LIMIT 1;`

或者：

`SELECT max(id) INTO p_campaign FROM db_campaign;`

# ruby-on-rails - 在生产中使用 Sunspot 时设置独立 solr 服务器的原因？

> ID：11564182
> 
> 赞同：3
> 
> 时间：2012-07-19T15:29:48.570
> 
> 标签：ruby-on-rails, linux, solr, sunspot

我想弄清楚为什么我们不应该在生产环境中单独使用太阳黑子宝石？

大多数人建议设置独立的**solr**服务，例如**jetty+solr**或**tomcat+solr**。

任何人都可以解释作为嵌入式服务运行的缺点是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T19:37:22.570

这个链接有一些信息： http: [//outoftime.github.com/pivotal-sunspot-presentation.html](http://outoftime.github.com/pivotal-sunspot-presentation.html)它还说它应该在自己的机器上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T16:24:15.680

Sunspot 在生产中完全可用。不过，您必须设置自己的 Solr 服务器，我认为这就是您所说的。为此，有一个[已经回答的 StackOverflow 问题](https://stackoverflow.com/questions/4937314/setup-sunspot-solr-with-rails-in-production-environment)，我认为它可以帮助您入门。

# javascript - 创建自定义 jquery 选择器（不是过滤器/伪选择器）

> ID：11564186
> 
> 赞同：0
> 
> 时间：2012-07-19T15:29:56.770
> 
> 标签：javascript, jquery, jquery-selectors

我想创建一个类似于[Basic CSS Selectors](http://api.jquery.com/category/selectors/basic-css-selectors/)的自定义选择器，而不像那些以冒号开头的伪选择器（使用创建`$.expr[':']`）。
这是将[`document.elementFromPoint`](http://dev.w3.org/csswg/cssom-view/#dom-document-elementfrompoint)方法合并到 jquery 中。
我为此编写了如下代码：

```
$._find = $.find;
$.find = function(query, context, extra, seed ){
    var start,end,expr,_ref,top,left;
    if(typeof query === 'string'){
        start = query.indexOf("(");
        end = query.indexOf(")",start);
        if(start !== -1 && end !== -1){
            expr = "["+query.slice(start+1,end)+"]";
            _ref = $.parseJSON(expr);top=_ref[0];left=_ref[1];
            console.log(document.elementFromPoint(top,left));
            return $([document.elementFromPoint(top,left)]);
        }
    }
    return $._find.apply(null,[query, context, extra, seed]);
}; 
```

它适用于普通查询。但是当`$('(10,20)')`执行代码时，会返回一个空的 jquery 结果。
问题发生在这一行`return $([document.elementFromPoint(top,left)]);`，因为前一行恰好给出了一个有效的 DOM 元素。

欢迎任何评论。

PS：我不是在寻找伪选择器，在此先感谢

# c - 修改 printf

> ID：11564187
> 
> 赞同：0
> 
> 时间：2012-07-19T15:29:58.143
> 
> 标签：c

我想将该函数修改`printf`为一个新函数，该函数`printf2`只是在要打印的消息前面加上`Hello`.

我可以做

```
void printf2(char message[]) {
    printf("Hello ");
    printf(message);
} 
```

问题是我不能为`message`has `%d`,`%c`等情况传递额外的参数。

我怎样才能`printf2`接受尽可能多的参数`printf`，并将它们传递给`printf`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T15:52:11.553

上面的评论为您指明了正确的方向，但这里有一个示例，说明如何添加标签 (Hello)。

注意：我使用了*s*和*n*版本的*printf*来格式化一个不应该溢出我的临时缓冲区的新字符串，并且假设 *MAX_MSG_SIZE* 已在其他地方适当地定义。

```
void printf2(const char *format, ...)
{

    char buffer[MAX_MSG_SIZE] = "";  

    va_list args;

    va_start(args,format);
    vsnprintf(buffer, MAX_MSG_SIZE, format, args);
    va_end(args);   

    printf("Hello: %s\n", buffer);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T15:50:58.697

1.  您应该使用以下函数来控制可变参数。

    ```
    void va_start( va_list arg_ptr, prev_param );   
    type va_arg( va_list arg_ptr, type );   
    void va_end( va_list arg_ptr ); 
    ```

2.  判断格式字符串。使用switch()语句判断`%d`、、`%c`等`%s`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T19:51:31.453

```
void print_message(char *format, ...)
{
    printf("%s", "Hello: ")
    va_list ptr;
    va_start(ptr, format);
    vprintf(format, ptr);
    va_end(ptr);
} 
```

笔记：

1.  printf("%s", "Hello: ") 比 printf("Hello: ") 快一点（通过跳过格式字符串阶段的扫描）
2.  printf（消息）；真是个坏主意。当消息包含“%s”之类的内容时，它会崩溃。

# php - 反向推进 ORM 导致“构建文件：/build.xml 不存在”

> ID：11564188
> 
> 赞同：0
> 
> 时间：2012-07-19T15:29:58.337
> 
> 标签：php, propel

从包含 build.properties 文件的文件夹中调用以下命令时

```
# ../propel/generator/bin/propel-gen . reverse 
```

我明白了

> 构建文件：/build.xml 不存在！

这是因为我错误地调用了 propel-gen 文件，因为它应该在我的 PATH 中？

还是另有原因？

我不认为使用反向甚至需要一个 build.xml 文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T12:22:27.640

一切都需要一个`build.xml`文件，因为这就是 Phing 的工作方式。但是，它应该在`.../propel/generator`. 这个问题是已知的，并已在 1.6.7 之后的 Propel 中得到修复。

# android - 另一个 ANR keyDispatchingTimedOut 错误。但我不知道为什么

> ID：11564189
> 
> 赞同：1
> 
> 时间：2012-07-19T15:29:59.690
> 
> 标签：android

我从 google play 获得了下面的堆栈，但我不明白为什么：

来自 PlayerCardsEventsListner.select 的来源：

```
void select(Card card) {
    card.select(!card.isSelected());
    if (card.isSelected()) card.setPosition(card.getPosition().x, card.getPosition().y-10);
    else card.setPosition(card.getPosition().x, card.getPosition().y+10);           
    SoundManager.playSound(SoundManager.SOUND_DROP, 1);
} 
```

声音管理器：[声音管理器](http://www.droidnova.com/creating-sound-effects-in-android-part-2,695.html)

```
DALVIK THREADS:
(mutexes: tll=0 tsl=0 tscl=0 ghl=0 hwl=0 hwll=0)
"main" prio=5 tid=1 NATIVE
  | group="main" sCount=1 dsCount=0 obj=0x400281b8 self=0xcec0
  | sysTid=5424 nice=0 sched=0/0 cgrp=default handle=-1345006496
  | schedstat=( 895401208047 31823023961 248727 )
  at android.media.SoundPool.play(Native Method)
  at com.burraco.sound.SoundManager.playSound(SoundManager.java:66)
  at com.burraco.actions.PlayerCardsEventsListner.select(PlayerCardsEventsListner.java:157)
  at com.burraco.actions.PlayerCardsEventsListner.actionDown(PlayerCardsEventsListner.java:79)
  at com.burraco.actions.PlayerCardsEventsListner.onTouch(PlayerCardsEventsListner.java:38)
  at android.view.View.dispatchTouchEvent(View.java:3934)
  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:869)
  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:869)
  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:869)
  at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:869)
  at com.android.internal.policy.impl.PhoneWindow$DecorView.superDispatchTouchEvent(PhoneWindow.java:1730)
  at com.android.internal.policy.impl.PhoneWindow.superDispatchTouchEvent(PhoneWindow.java:1142)
  at android.app.Activity.dispatchTouchEvent(Activity.java:2102)
  at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchTouchEvent(PhoneWindow.java:1714)
  at android.view.ViewRoot.deliverPointerEvent(ViewRoot.java:2218)
  at android.view.ViewRoot.handleMessage(ViewRoot.java:1889)
  at android.os.Handler.dispatchMessage(Handler.java:99)
  at android.os.Looper.loop(Looper.java:123)
  at android.app.ActivityThread.main(ActivityThread.java:3691)
  at java.lang.reflect.Method.invokeNative(Native Method)
  at java.lang.reflect.Method.invoke(Method.java:507)
  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:847)
  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:605)
  at dalvik.system.NativeStart.main(Native Method)

"Binder Thread #3" prio=5 tid=9 NATIVE
  | group="main" sCount=1 dsCount=0 obj=0x40652e20 self=0x28d378
  | sysTid=5620 nice=0 sched=0/0 cgrp=default handle=5810464
  | schedstat=( 3221792 16373336 20 )
  at dalvik.system.NativeStart.run(Native Method)

"Thread-14" prio=5 tid=8 TIMED_WAIT
  | group="main" sCount=1 dsCount=0 obj=0x40556c80 self=0x142b90
  | sysTid=5520 nice=0 sched=0/0 cgrp=default handle=1618728
  | schedstat=( 174148198 257597779 1253 )
  at java.lang.VMThread.sleep(Native Method)
  at java.lang.Thread.sleep(Thread.java:1213)
  at java.lang.Thread.sleep(Thread.java:1195)
  at com.burraco.ai.AiThread.run(AiThread.java:77)
  at java.lang.Thread.run(Thread.java:1019)

"SoundPoolThread" prio=5 tid=12 NATIVE
  | group="main" sCount=1 dsCount=0 obj=0x4053c8b0 self=0x145530
  | sysTid=5472 nice=0 sched=0/0 cgrp=default handle=1250072
  | schedstat=( 3314498 173708645 36 )
  at dalvik.system.NativeStart.run(Native Method)

"SoundPool" prio=5 tid=11 NATIVE
  | group="main" sCount=1 dsCount=0 obj=0x405352d8 self=0x1429a0
  | sysTid=5471 nice=0 sched=0/0 cgrp=default handle=1249960
  | schedstat=( 3432419 260185822 78 )
  at dalvik.system.NativeStart.run(Native Method)

"android.hardware.SensorManager$SensorThread" prio=5 tid=10 NATIVE
  | group="main" sCount=1 dsCount=0 obj=0x4052ff48 self=0x150148
  | sysTid=5441 nice=-8 sched=0/0 cgrp=default handle=1376896
  | schedstat=( 2404922708 1733708167 21400 )
  at android.hardware.SensorManager.sensors_data_poll(Native Method)
  at android.hardware.SensorManager$SensorThread$SensorThreadRunnable.run(SensorManager.java:454)
  at java.lang.Thread.run(Thread.java:1019)

"Binder Thread #2" prio=5 tid=7 NATIVE
  | group="main" sCount=1 dsCount=0 obj=0x4051c5b0 self=0x8b2c8
  | sysTid=5430 nice=0 sched=0/0 cgrp=default handle=569024
  | schedstat=( 5665377 70979176 41 )
  at dalvik.system.NativeStart.run(Native Method)

"Binder Thread #1" prio=5 tid=6 NATIVE
  | group="main" sCount=1 dsCount=0 obj=0x4051b2f0 self=0x899a8
  | sysTid=5429 nice=0 sched=0/0 cgrp=default handle=1010768
  | schedstat=( 8561334 52181668 45 )
  at dalvik.system.NativeStart.run(Native Method)

"Compiler" daemon prio=5 tid=5 VMWAIT
  | group="system" sCount=1 dsCount=0 obj=0x40517300 self=0xf65b0
  | sysTid=5428 nice=0 sched=0/0 cgrp=default handle=1007392
  | schedstat=( 672164310 233385368 5749 )
  at dalvik.system.NativeStart.run(Native Method)

"Signal Catcher" daemon prio=5 tid=4 RUNNABLE
  | group="system" sCount=0 dsCount=0 obj=0x40517240 self=0xf6398
  | sysTid=5427 nice=0 sched=0/0 cgrp=default handle=479464
  | schedstat=( 1154248 170503189 8 )
  at dalvik.system.NativeStart.run(Native Method)

"GC" daemon prio=5 tid=3 VMWAIT
  | group="system" sCount=1 dsCount=0 obj=0x40517198 self=0xf61a0
  | sysTid=5426 nice=0 sched=0/0 cgrp=default handle=1002744
  | schedstat=( 8751048544 2309042697 2446 )
  at dalvik.system.NativeStart.run(Native Method)

"HeapWorker" daemon prio=5 tid=2 VMWAIT
  | group="system" sCount=1 dsCount=0 obj=0x405170e0 self=0xf5fb0
  | sysTid=5425 nice=0 sched=0/0 cgrp=default handle=1007176
  | schedstat=( 10792780877 2156866454 3466 )
  at dalvik.system.NativeStart.run(Native Method) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:52:27.647

~~首先，select(Card card)在哪里调用？~~. 这对于避免主 UI 线程中的日志操作（在活动中执行的标准操作，例如 onCreate()）非常重要。如果你不小心运行了一些循环，或者死锁发生的 UI 将冻结并且 ANR 会被注意到。尝试使用 AsyncTask 播放声音并检查方法执行的时间。请记住，较慢的设备需要更多时间来执行操作。好的，现在看看它在哪里被调用。

# transformation - Acceleo 将 BPEL 文件转换为 Java 类的第一步

> ID：11564191
> 
> 赞同：1
> 
> 时间：2012-07-19T15:30:02.467
> 
> 标签：transformation, bpel, acceleo

我正在尝试使用 Acceleo 从 BPEL 到 Java 的转换。我做了 2 或 3 个教程，都涉及到 UML 输入模型的使用，尽管我认为我理解我应该如何处理 bpel 模型及其 bpel.ecore 元模型。

不过，我在运行一个非常简单的转换时遇到了问题，它应该只生成一个带有我的 BPEL 流程文件名称的 java 文件。

这是我的 Acceleo generate.mtl 文件：

```
[comment encoding = UTF-8 /]
[module generate('http:///org/eclipse/bpel/model/bpel.ecore')]

[template public generateElement(aProcess : Process)]
[comment @main /]
[file (aProcess.name, false, 'UTF-8')]
[/file]
[/template] 
```

这里是输入 .bpel 文件（只是其中的一部分）：

```
<!-- BPEL_sayHelloProcess BPEL Process [Generated by the Eclipse BPEL Designer] -->
<!-- Date: Wed Jul 18 11:00:50 CEST 2012 -->
<bpel:process name="BPEL_sayHelloProcess"
         targetNamespace="http://bpeltojava.uni"
         suppressJoinFailure="yes"
....
....
</bpel:process> 
```

这是我得到的错误：

> 该生成未能生成任何文件，因为没有至少与您的一个主模板的第一个参数的类型匹配的模型元素。该问题可能是由于您的元模型注册有问题，请参阅生成器的 Java 启动器中名为“registerPackages”的方法。它也可能来自用作生成入口点的模板中缺少的 [comment @main/]。

我正在使用 Eclipse Modeling Juno 4.2 和 Acceleo 3.3.0 谢谢 :-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-23T07:27:11.127

当您在模型没有任何实例的目标类型上定义“主”模板时，通常会出现此错误。在此示例中，您的主模板：

```
[template public generateElement(aProcess : Process)]
[comment @main /] 
```

被定义为将“过程”元素作为输入。您需要确保您的输入模型确实包含这种类型的元素。

还请确保正确注册您的包和资源工厂（可选，BPEL 文件可能没有）。这是在主模块旁边生成的 Java 类中完成的：查看“registerPackage”和“registerFactories”的示例实现。您的 BPEL 注册应该与我们提供的示例相近。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T12:44:38.053

看来我发现了问题。

我下载并安装了 Eclipse Indigo Modeling 3.7.2，从更新站点添加了 Acceleo 3.3 插件，BPEL 插件版本 1.0 和 Acceleo 转换立即工作，没有什么特别的事情要做，我只是不再收到错误.

我认为问题在于，正如我已经在[http://www.eclipse.org/forums/index.php/m/895663/#msg_895663](http://www.eclipse.org/forums/index.php/m/895663/#msg_895663) 在 Eclipse Juno 和 BPEL 插件中做一些关于 BPEL 的教程时所经历的那样。

希望这会帮助遇到同样麻烦的其他人

# ruby-on-rails - 如何在 Rails 中创建图表？

> ID：11564192
> 
> 赞同：5
> 
> 时间：2012-07-19T15:30:02.780
> 
> 标签：ruby-on-rails, graph, statistics

有谁知道如何在 Rails 中创建图表。这是因为我需要在 rails 中阅读和呈现统计数据，而呈现统计数据的最佳方式是在图表中。那么谁能告诉我我该怎么做？谢谢！:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T15:45:39.213

这里有很多选择。要尝试将内容保留在 Ruby 中，我建议您查看[ruport](http://ruport.github.io/) gem。请注意，Ruport 的最后一个版本是在 2007 年。

正如 Calvin 提到的，其他选项涉及 Javascript 解决方案。有两个我喜欢的库。第一个是 D3.js，可以在这里找到：

[http://d3js.org/](http://d3js.org/)

D3 非常灵活，并且有一些强大的数据操作工具来处理您的数据，但是它往往需要更多的开发时间来获得一些好的东西。

我推荐的另一个选项是 highcharts：

[http://www.highcharts.com/](http://www.highcharts.com/)

这个库不像 D3 那样灵活，但它更容易获得一个非常漂亮的图表并快速运行。另一件事是它实际上没有 D3 拥有的数据操作工具。不过，如果您正在寻找简单的东西，我建议您先尝试 Highcharts。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T15:41:13.150

我一直在使用一个名为[jqPLot](http://www.jqplot.com/)的 JavaScript 库。这很容易上手——基本上，你通过 JS 初始化图表。但是，在那个 JS 中，您可以使用 rails 脚本标签 <% %> 来构建必要的数据数组来提供购物车。显然还有其他方法可以加载数据。

作为一个简单的示例，这将是您的 html 页面（称为 graph.html.erb）。渲染这个页面的控制器需要设置@user_stats 变量，所以它可以用来为jqPlot 构建数据集。

```
 <html>
        <head>
        <script type="text/javascript">
            $(document).ready(function() {
              var plot2 = $.jqplot('chartdiv',
                  <% 
                     last_one = @user_stats.pop
                  %>
                  [[
                  <% @user_stats.each { |user_stat| %>
                    [<%= user_stat[1] %>, '<%= user_stat[0].first_name %>'],
                  <% } %>
                    [<%= last_one[1] %>, '<%= last_one[0].first_name %>']
                  ]],
                  {
                seriesDefaults: {
                  renderer:$.jqplot.BarRenderer,
                  // Show point labels to the right ('e'ast) of each bar.
                  // edgeTolerance of -15 allows labels flow outside the grid
                  // up to 15 pixels.  If they flow out more than that, they
                  // will be hidden.
                  pointLabels: { show: true, location: 'e', edgeTolerance: -15 },
                  // Rotate the bar shadow as if bar is lit from top right.
                  shadowAngle: 135,
                  // Here's where we tell the chart it is oriented horizontally.
                  rendererOptions: {
                    barDirection: 'horizontal'
                  }
                },
                axes: {
                  yaxis: {
                    renderer: $.jqplot.CategoryAxisRenderer
                  }
                }
              });
    </script>
</head>
<body>

    <div id="chartdiv" style="height:400px;width:300px;"></div>

</body>
</html> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-19T15:40:53.890

完成此操作的最佳方法是使用[Google Chart Tool](https://developers.google.com/chart/)。他们有很多常用的图表类型可供使用，所以我先看一下。

这是您的代码可能是什么样子的快速示例

```
// Load the Visualization API and the piechart package.
google.load('visualization', '1.0', {'packages':['corechart']});

// Set a callback to run when the Google Visualization API is loaded.
google.setOnLoadCallback(drawChartRepublican);

function drawChartRepublican() {

    // Create the data table.
  var data = new google.visualization.DataTable();
  data.addColumn('string', 'Topping');
  data.addColumn('number', 'Slices');
  data.addRows([
    ['Newt Gingrich', <%= @gingrich_today %>],
    ['Mitt Romney', <%= @romney_today %>], 
    ['Ron Paul', <%= @paul_today %>],
    ['Rick Perry', <%= @perry_today %>],
    ['Michelle Bachmann', <%= @bachmann_today %>],
    ['Rick Santorum', <%= @santorum_today %>],
    ['John Huntsman', <%= @huntsman_today %>], 
    ['Buddy Roemer', <%= @roemer_today %>]
  ]);

  // Set chart options
  var options = {'title':'Scoreboard (<%= DateTime.now %>)', 'width':680, 'height':480};

  // Instantiate and draw our chart, passing in some options.
  var chart = new google.visualization.PieChart(document.getElementById('chart_div_republican'));
    chart.draw(data, options);
} 
```

在视图中，您可以通过这种方式添加图表。

```
<div id="chart_div_republican"></div> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-08-29T21:18:58.797

我在寻找在我自己的 Rails 应用程序中做一些图表时遇到了你的问题。

我建议看看 Chartkick，在这里：[http ://ankane.github.io/chartkick/](http://ankane.github.io/chartkick/)

它相对较新，因此在您提出原始问题时不可用。它将 Google 图表 API 包装在一个简单的 Rails gem 中（如果您愿意，您也可以将其指向使用 Highcharts 核心）。我能够在几个小时内整理出一些基本图表......一个巨大的优势是我不必编写任何 JavaScript 来让它工作。我确实必须编写一些 SQL 才能正确显示数据标签，因为我要提取的数据分布在多个表中。

祝你好运！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-19T15:36:10.780

您可能应该为图表使用 Javascript。从技术上讲，您可以使用 Rails 和一些 HTML/CSS 创建它们，但您的视图会有点复杂。

我认为最好的方法是使用 Rails 渲染 JSON 数据，然后将该 JSON 数据导入到[Flot](http://code.google.com/p/flot/)等 JS 库中以渲染实际图形。

# html - 检测早于 8 的 IE 版本

> ID：11564194
> 
> 赞同：2
> 
> 时间：2012-07-19T15:30:13.683
> 
> 标签：html, internet-explorer

我的 HTML 中有这段代码：

```
<!--[if lt IE 8]>
<script language="javascript">
alert("This page does not display properly in versions of Internet Explorer earlier than 8.\nPlease upgrade to IE8 (or later).");
</script>
<![endif]--> 
```

但是，即使使用 IE8 访问页面，无论 IE8 是否处于兼容性视图中，都会触发警报。

任何建议表示赞赏。

问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:35:15.510

您可以在 CSS 中放置一些特定于版本的样式，然后使用 JavaScript 检测它们。

```
.test {
  margin-left: 8px;  --> for all browsers
  _margin-left: 6px; --> for ie6
  #margin-left: 7px; --> for ie7 and below
} 
```

查询出margin-left的值，就可以轻松检测IE7和6了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T15:32:44.403

AFAIK，Comp View（Quirksmode）不足以测试 IE 的东西。您需要 IE F12（开发人员）工具 - 默认情况下应该包含它们。在那里，您可以为您的页面选择要使用的 IE 版本（浏览器模式）。它一直对我有用。当然，它不是 100% 准确的，但它最接近于 IE 早期版本的实际副本

# selenium - 是否可以在 excel 中使用输入数据运行 selenium 测试？

> ID：11564202
> 
> 赞同：0
> 
> 时间：2012-07-19T15:30:32.850
> 
> 标签：selenium, webdriver

我在 Eclipse 中使用 Selenium Web Driver 和 JUnit。我编写了我的主要测试 - 对所有其他测试都是通用的，一开始我设置了我的输入数据（每个测试都不同）：

```
String update_f="//*[@id='columnTitle2']/input";
String update_u="dscr";
String name_p="Test";
String[] link=new String [] {"001","01"};
String[] lov_name= new String [] {"Work","Machine"}; 
```

如果我想执行特定的测试（实际上是设置特定的数据），是否可以在 excel 文件中设置这些数据，而不仅仅是更改这个文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T12:29:04.913

我的朋友有可能在一些外部罐子的帮助下处理 Excel 电子表格。

你可以选择一个。JXL Jar（易于使用，足以满足读写等正常功能）- [http://www.andykhan.com/jexcelapi/tutorial.html](http://www.andykhan.com/jexcelapi/tutorial.html) b。Apache poi jar - [http://onjava.com/pub/a/onjava/2003/04/16/poi_excel.html](http://onjava.com/pub/a/onjava/2003/04/16/poi_excel.html)

*   将这些外部 jar 添加到 eclipse 中。
*   创建具有不同输入值的 excel 文件。
*   通过罐子从excel中读取并传递这些值。

目前我正在使用 JXL，这很好。

# sql - 插入失败，但标识值增长，这是否违反了原子性规则？

> ID：11564204
> 
> 赞同：4
> 
> 时间：2012-07-19T15:30:39.507
> 
> 标签：sql, sql-server, postgresql, acid

当我从大型 Excel 将数据导入新表时，如果一条记录失败，则不会导入任何内容。我认为这没关系，因为它符合原子性规则。但是，当我修复源数据错误并再次导入时，标识列不是从 1 开始，而是从一个大值开始。

例如

```
create table #test (id int identity(1,1), name varchar(4) default '')

insert into #test (name) values('1 insert will failed');
select ident_current('#test') as ident_current
insert into #test (name) values('2 insert will failed');
select ident_current('#test') as ident_current

insert into #test (name) values('3 OK');
select ident_current('#test') as ident_current

select * from #test

drop table #test 
```

结果

```
id          name 
----------- ---- 
3           3 OK 
```

维基百科将[ACID](http://en.wikipedia.org/wiki/ACID)描述为如下

> ## 原子性
> 
> 原子性要求每个事务都是“全有或全无”：如果事务的一部分失败，则整个事务失败，***数据库状态保持不变***。原子系统必须保证每种情况下的原子性，包括电源故障、错误和崩溃。

因此，如果插入失败，SQL Server 似乎不会让数据库状态（标识值）保持不变，那么，这是否违反了 ACID 规则？

顺便说一句，当插入失败时，PostgreSQL 不会让身份（序列）值增长。（更新：仅有时，请参阅评论。**不要**依赖于此。）。

```
test=# create table AutoIncrementTest (id serial not null, name varchar(4));
NOTICE:  CREATE TABLE will create implicit sequence "autoincrementtest_id_seq" for serial column "autoincrementtest.id"
CREATE TABLE
test=# insert into autoincrementtest(name) values('12345');
ERROR:  value too long for type character varying(4)
test=# insert into autoincrementtest(name) values('12345');
ERROR:  value too long for type character varying(4)
test=# insert into autoincrementtest(name) values('1234');
INSERT 0 1
test=# select * from autoincrementtest;
 id | name
----+------
  1 | 1234 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T15:39:31.610

由于身份值不是物理存储在您可以访问的数据库的任何部分中的东西，我不同意这会破坏原子性。如果您不想“破坏原子性”，或者如果您关心间隙（您不应该），还有其他方法可以做到这一点（例如，使用可序列化事务并将 MAX(col)+1 用于新行）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T15:32:37.507

是的，所以不要依赖 MSSQL Server 的连续值。

我建议依靠任何引擎本身的连续身份值本身是一种脆弱而幼稚的方法。这可能总是由于后续删除而发生。

我想这种与纯粹的 ACID 合规性的偏差允许在 MS SQL Server 中进行性能优化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T15:58:17.783

根据这个公式，原子性保证数据库状态保持不变。问题是我们所说的数据库状态是什么意思。

只要您了解“身份插入”的 SQL 概念，既不声明也不保证身份列是连续的，就没有问题。当您考虑身份插入时，确实需要重新考虑 SQL 保证的内容，但由于我们知道在上述情况下这可能会失败，因此不能真正保证它是 NEXT 值。

在插入之前，标识列的“下一个”值只保证大于当前值——而不是下一个值。这仍然是之后的状态。

# ruby-on-rails-3 - 日期未使用 Rails 3.2 和 formtastic 写入数据库

> ID：11564216
> 
> 赞同：0
> 
> 时间：2012-07-19T15:31:16.987
> 
> 标签：ruby-on-rails-3, activerecord, formtastic

在我忘记之前，这是我正在运行的：Rails 3.2.4.rc1 Ruby 1.9.3 Formtastic 2.1（稳定）

我正在尝试使用 formtastic 来做用户信息表单。日期字段似乎无法正常工作。所有其他数据正在正确更新。看起来 PUT 请求没问题，但是当我查询我的数据库（mysql）时，它说日期 = NULL。

代码示例：

在我看来：

```
<%= semantic_form_for @author do |f| %>
  <%= f.inputs do %>
    <%= f.input :first_name %>
    <%= f.input :last_name %>
    <%= f.input :date_of_birth, :start_year => Time.now.year-500 %>
    <%= f.input :nationality %>
    <%= f.input :bio %>
  <% end %>
  <%= f.actions %>
<% end %> 
```

PUT 请求：

```
 Started PUT "/authors/4" for 127.0.0.1 at 2012-07-19 11:08:02 -0400
    Processing by AuthorsController#update as HTML
      Parameters: {"utf8"=>"✓", "authenticity_token"=>"UARYU7S0FTOLYU1Z04lZp/2Gn94DXiKuX/FN/DgYk/c=", "author"=>{"first_name"=>"Sheila", "last_name"=>"Wedigo", "date_of_birth(1i)"=>"1514", "date_of_birth(2i)"=>"3", "date_of_birth(3i)"=>"5", "nationality"=>"American", "bio"=>"Sheila is an awesome Great American Playwright"}, "commit"=>"Update Author", "id"=>"4"} 
```

ETA：这是控制台中的 MYSQL：

```
Processing by AuthorsController#create as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"gjSXdsSWPBzL65fOHX/pe3XTFRau4NYzZSYsyp1aPAs=", "author"=>{"first_name"=>"Stinky ", "last_name"=>"mggee", "date_of_birth(1i)"=>"2010", "date_of_birth(2i)"=>"4", "date_of_birth(3i)"=>"4", "nationality"=>"Finnish", "bio"=>"TEST"}, "commit"=>"Create Author"}
  SQL (0.2ms)  BEGIN
  SQL (154.1ms)  INSERT INTO `authors` (`bio`, `created_at`, `date_of_birth`, `date_of_death`, `first_name`, `last_name`, `nationality`, `updated_at`) VALUES (?, ?, ?, ?, ?, ?, ?, ?)  [["bio", "TEST"], ["created_at", Tue, 24 Jul 2012 13:30:23 EDT -04:00], ["date_of_birth", nil], ["date_of_death", nil], ["first_name", "Stinky "], ["last_name", "mggee"], ["nationality", "Finnish"], ["updated_at", Tue, 24 Jul 2012 13:30:23 EDT -04:00]] 
```

当我询问 mysql 时的输出：

```
mysql> select date_of_birth from authors where id = 4;
+---------------+
| date_of_birth |
+---------------+
| NULL          |
+---------------+
1 row in set (0.00 sec) 
```

我怀疑这可能与[RoR Guides](http://guides.rubyonrails.org/form_helpers.html)中的以下信息有关：“select_date 不适用于更新或创建 Active Record 对象的表单，因为 Active Record 期望 params 散列的每个元素对应一个属性。模型对象日期和时间的助手提交具有特殊名称的参数，当 Active Record 看到具有此类名称的参数时，它知道它们必须与其他参数组合并提供给适合列类型的构造函数。”

也就是说，我在互联网上没有看到其他人遇到这个问题，而且这似乎是 Formtastic 会处理的那种事情。在我最近从 Rails 2 升级到 Rails 3 之前，这可以正常工作。

# css - 如何使用 CSS 对齐多个 div

> ID：11564217
> 
> 赞同：0
> 
> 时间：2012-07-19T15:31:18.317
> 
> 标签：css, layout, html

我有一个我想要对齐的数字容器。这是我到目前为止的代码：[jsfiddle](http://jsfiddle.net/DphXz/64/)

首先，当我从我的机器上运行这段代码时，“day-label”是它在 jsfiddle 上显示的大小的两倍。接下来的两个（“max-points”和“close-points”）堆叠在一起，是“day-label”的正确文本，这就是我想要的。

现在接下来的三个容器我似乎无法将它们排成一行，“点总数”容器我想像“日标签”一样，但在最大和关闭点的右侧。然后接下来的两个“三十点”和“五十点”我想要在总数旁边。

它们应该都在同一条线上，但它们的形状并不完全相同。

有谁知道我在说什么或者我混淆了情况？

我想我可以使用“top:X”和“left:X”，但我想知道是否有更简单的方法让它们彼此内联？就像前三个容器一样。

谢谢您的帮助。

这是我希望它看起来如何的模型 -

![在此处输入图像描述](../Images/38bd1adb7cb489b17963c3a286c61a79.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:52:26.070

这个**[jsFiddle 例子](http://jsfiddle.net/j08691/DphXz/73/)**怎么样？

**HTML**

```
<div class="day-point-container">                
    <div class="result-headers">Title</div>
    <div class="day-label"><h1>1<small>st</small></h1></div>
    <div class="max-points">Max</div>
    <div class="close-points">Close</div>
    <div class="points-totals">Total</div>
    <div class="thirty-points">30 points</div>
    <div class="fifty-points">50</div>
</div>​ 
```

**CSS**

```
.day-point-container
{
    width: 100%;
    background-color: pink;
}

.result-headers
{
    background-color: green;
}

.day-label
{
    background-color: lime;
    width: 10%;
    height: 10%;
    text-align: center;
    float: left;
}

.max-points
{
    background-color: blue;
    width: 50%;
    height: 5%;
}

.close-points
{
    background-color: purple;
    width: 50%;
    height: 5%;
}

.points-totals
{
    background-color: orange;
    width: 20%;
    height:10%;
    float:right;
}

.thirty-points
{
    background-color: red;
    width: 10%;
    float:right;
}

.fifty-points
{
    background-color: gold;
    width: 10%;
    clear:right;
    float:right;
}​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T15:55:09.220

我不是 100% 确定你想要实现什么，但你可以尝试`float`在 CSS 中使用该功能，例如这里是[http://www.w3schools.com/cssref/pr_class_float.asp](http://www.w3schools.com/cssref/pr_class_float.asp)`float:left`上 W3schools 页面的链接，或者如果你只是想让他们居中你总是可以尝试`float` `<center>`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T18:35:27.977

[更新更漂亮的代码](http://codepen.io/andrew-luhring/pen/jeGIl)

另外，伙计，您看起来正在尝试做的是显示[表格数据](http://www.w3.org/TR/html5/tabular-data.html)

如果是这样的话，使用一个实际的表并没有错——事实上，不这样做是错误的。

# html

```
<section class="container">
  <header>
    <h1 class="title">Title</h1>
  </header>
  <ul class="point-container">
    <li class="day"><h1>1<span>st</span></h1></li>
    <div class="points">
      <li class="max">Max</li>
      <li class="close">Close</li>
    </div>
    <div class="results">
      <li class="totals">Total</li>
      <li class="thirty-points">30 points</li>
      <li class="fifty-points">50</li>
    </div>
  </div>
</section> 
```

# css

```
//  ==================
//  base
//
//
html{ font-size: 62.5%; }
body{
font-size: 1.6rem;
  font: normal normal 100 1.6rem "Helvetica Neue", sans serif;
  background-color: black;
}
.container{
  width: 90%;
  color: white;
  margin: auto;
}

//  ==================
//  layout
//
//

body,
.container, 
.points, 
.results, 
.point-container{
  display: flex; 
}
.points,
.container{
  flex-flow: column; 
}
.results{ flex-flow: row;}
.day,
.results li{ 
  flex: 1; 
}
.points, 
.results{ 
  flex:3; 
}

.results li{
  text-align: center;
}

//  ==================
//  colors
//
//
.title{ background-color: #008001; }
.day{ background-color: #00ff00; }
.max{ background-color: blue; }
.close{ background-color: purple; }  
.totals{ background-color: orange; }
.thirty-points{ background-color: red; }
.fifty-points{ background-color: gold; } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T15:51:11.053

使用这个：[***小提琴***](http://jsfiddle.net/NvM82/)

```
.day-point-container
{
    width: 100%;
    background-color: pink;
}

.result-headers
{
    background-color: green;

}

.day-label
{
    background-color: lime;
    width: 10%;
    height: 10%;
    text-align: center;
    float: left;
}

.max-points
{
    background-color: blue;
    width: 50%;
    height: 5%;
}

.close-points
{
    background-color: purple;
    width: 50%;
    height: 5%;
}

.points-totals
{
    background-color: orange;
    width: 20%;
    height:10%;
    float: left;
}

.thirty-points
{
    background-color: red;
    width: 10%;
    float: left;
}

.fifty-points
{
    background-color: gold;
        width: 10%;
        float: left;
        display:inline;
        float: left;
    }

.clearfix {
    clear: both;
    }

<div class="day-point-container">                
    <div class="result-headers">Title</div>
    <div class="day-label"><h1>1<small>st</small></h1></div>
    <div class="max-points">Max</div>
    <div class="close-points">Close</div>
    <div class="points-totals">Total</div>
    <div class="thirty-points">30 points</div>
    <div class="fifty-points">50</div>
    <div class="clearfix"></div>
</div> 
```

# javascript - 隐藏，然后展开或显示 HTML 中的列

> ID：11564218
> 
> 赞同：-2
> 
> 时间：2012-07-19T15:31:20.777
> 
> 标签：javascript, html-table

我想要一个表格，让我们说总共 10 列，但是当表格第一次呈现时，我希望它只显示 10 列中的 7 列，或者从中间隐藏 3 列让我们说（不是结尾 3 或第一个）。然后，有一个按钮或其他东西，如果他们单击，它将展开表格并将这些列插入到正确的位置。

这可能吗？我正在使用 jQuery。我知道 jQuery 中有一个显示和隐藏功能，但这似乎仅适用于对象，例如整个段落或表格，而不是特定元素。

目前我有这个：

```
<table id="tableone" border="1">
    <tr class="del">
        <td>Row 0 Column 0</td>
        <td >Row 0 Column 1</td>
        <td >Row 0 Column 2</td>
    </tr>
    <tr class="del">
        <td>Row 1 Column 0</td>
        <td>Row 1 Column 1</td>
        <td>Row 1 Column 2</td>
    </tr>
    <tr class="del">
        <td>Row 2 Column 0</td>
        <td>Row 2 Column 1</td>
        <td>Row 2 Column 2</td>
    </tr>
    <tr class="del">
        <td>Row 3 Column 0</td>
        <td>Row 3 Column 1</td>
        <td>Row 3 Column 2</td>
    </tr>
     <tr class="del">
        <td>Row 4 Column 0</td>
        <td>Row 4 Column 1</td>
        <td>Row 4 Column 2</td>
    </tr>
     <tr class="del">
        <td>Row 5 Column 0</td>
        <td>Row 5 Column 1</td>
        <td>Row 5 Column 2</td>
    </tr>
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:37:03.607

您可以使用 jquery 来实现这一点，为单击后要显示的列提供一些类似的类，如果我理解正确，您可以在下面尝试

```
$("button").on("click", function(){
    $("class_of_the_colums").toggle();
} 
```

您可以查看 jquery 以获取更多信息：[http ://www.jquery.com](http://www.jquery.com)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T16:35:04.360

您可以编写一个执行以下操作的函数：

```
function hssel(cls,from,fr,hs) {
  if ( from < 0 ) {
var chlds = $('tr.'+cls).parent().children().length;
  from = chlds + from;
  }
  for ( var i = from+1,fr = (from+fr)||from+1 ;i <= fr ;i++ ) {
    $('tr.'+cls+':nth-child('+i+')')[(hs=="show"?"show":"hide")]();
  }
}

//hssel("del",0) //would hide the first row with the class del
//hssel("del",0,3) //would hide the first three rows
//hssel("del",-3,3) //would hide the last three rows
//hssel("del",-3,3,"show"); //would show the last three rows
hssel("del",-3,3); 
```

这是一个[JSBin](http://jsbin.com/ujozob/edit#javascript,html)示例
这里是列的相同功能^^

```
function hssel(cls,from,fr,hs) {
  if ( from < 0 ) {
    var chlds = $('tr.'+cls+':first-child').children().length;
    console.log(chlds);
  from = chlds + from;
  }
  for ( var i = from+1,fr = (from+fr)||from+1 ;i <= fr ;i++ ) {
    $('tr.'+cls+' td:nth-child('+i+')')[(hs=="show"?"show":"hide")]();
  }
} 
```

而[JSBin](http://jsbin.com/ujozob/2/edit#javascript,html)示例
的用法与行的用法相同

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T15:45:13.130

您可以使用 CSS 选择器仅选择所有 TR 中的特定 TD，如下所示：（计数从 1 开始，而不是零！）

```
​$('tr td:nth-child(2)').hide()​​​​​​​​​​​​​​​​​​​​​​​​; 
```

当您希望再次显示该列时，您可以执行以下操作：

```
​$('tr td:nth-child(2)').show()​​​​​​​​​​​​​​​​​​​​​​​​; 
```

如果您打算更改要隐藏的列数或它们的位置，最好为这些列分配一个类并使用`$('.className').hide()`，但在与上述示例相同的波长上，您会这样做：

```
 $(document).ready( function() {
        // Creates a reference to columns 2 and 3;
        var $columnsToHide = $('tr td:nth-child(2), tr td:nth-child(3)');
        // Hides them
        $columnsToHide.toggle();
        // if element with id buttonID is clicked
        $('#buttonID').on('click', function() {
            // show the columns
            $columnsToHide.toggle();
        });
    }​); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T15:47:53.173

也许如果您对想要隐藏的任何和所有元素使用唯一 ID，例如：

```
<table id="tableone" border="1"> 
<tr id="del1"> 
<td>Row 0 Column 0</td> 
<td >Row 0 Column 1</td> 
<td >Row 0 Column 2</td> 
</tr> 
<tr id="del2"> 
<td>Row 1 Column 0</td> 
<td>Row 1 Column 1</td> 
<td>Row 1 Column 2</td> 
</tr> 
<tr id="del3"> 
<td>Row 2 Column 0</td> 
<td>Row 2 Column 1</td> 
<td>Row 2 Column 2</td> 
</tr> 
<tr id="del4"> 
<td>Row 3 Column 0</td> 
<td>Row 3 Column 1</td> 
<td>Row 3 Column 2</td> 
</tr> 
<tr id="del5"> 
<td>Row 4 Column 0</td> 
<td>Row 4 Column 1</td> 
<td>Row 4 Column 2</td> 
</tr> 
<tr id="del6"> 
<td>Row 5 Column 0</td> 
<td>Row 5 Column 1</td> 
<td>Row 5 Column 2</td> 
</tr> 
```

然后，在您的 css 样式中，您将在 .del 的位置替换为：

```
#del1,
#del2,
#del3,
#del4,
#del5,
#del6{
properties
} 
```

然后你可以使用 jQuery：

```
$(document).ready(function(){
$("#del3").hide();
$("#del4").hide();
}); 
```

和：

```
$("#id_of_button_that_will_show_the_hidden_elements").click(function(){
$("#del3").show();
$("#del4").show();
}); 
```

这不适用于所有与 $(".del").hide(); 属于同一类的元素；只会隐藏该类的所有元素。

希望我有所帮助=)

# sql - 使用 Management Studio 生成 CREATE TABLE 脚本

> ID：11564219
> 
> 赞同：9
> 
> 时间：2012-07-19T15:31:24.217
> 
> 标签：sql, sql-server-2008, ssms

我正在寻找一种为我的表生成脚本的方法。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-07-19T15:36:00.440

右键单击对象资源管理器中的表，然后选择脚本表为 > 创建到 > 新查询编辑器窗口。

![在此处输入图像描述](../Images/e3c6cefdb8d6f217aae5e7b4c5ccb423.png)

您还可以使用对象资源管理器详细信息 (F7) 对多个表执行此操作：

![在此处输入图像描述](../Images/3769982cd1900718331d4c9d0cccabc3.png)

或者右键单击数据库并使用任务 > 生成脚本向导：

![在此处输入图像描述](../Images/98b46468eca4ca4e2d31812eafb7f724.png)

# joomla - 无法从管理中添加或编辑 Joomla 联系人

> ID：11564224
> 
> 赞同：0
> 
> 时间：2012-07-19T15:31:41.640
> 
> 标签：joomla, joomla2.5

在管理方面、我的组件和联系人页面上，我无法编辑联系人（添加、保存或关闭）。页面被击中 - 我所要做的就是关闭选项卡。
我也尝试更改权限级别，但问题仍然存在。请给我一些想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-12T14:17:05.693

可能为时已晚，但无论如何......
我遇到了同样的问题 - 每次我尝试保存或关闭联系页面时页面都会冻结。在我的情况下，问题是由**osolcaptcha**插件引起的，该插件拦截了任何提交到表单的`id="contact-form"`. 所以我的解决方案是为管理区域和我的网站的**联系我们**页面制作不同的 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-17T09:11:35.703

不同的解决方案：只需在编辑联系人时禁用 osolcaptcha 插件。很可能，联系人不必经常更新。

# ruby - Ruby 文件在 Windows 中写入返回错误的文件大小？

> ID：11564226
> 
> 赞同：1
> 
> 时间：2012-07-19T15:31:43.860
> 
> 标签：ruby, windows, file-io

我还在学习 ruby​​，所以我确定我在这里做错了，但是在 Windows 上使用 ruby​​ 1.9.3，我在将随机 ascii 垃圾的文件写入特定大小时遇到​​问题。我需要能够编写这些文件以在我正在 QAing 的应用程序上进行测试。在 Mac 和 *nix 上，每次都正确写入文件大小。但在 Windows 上，它会生成随机大小的文件，一般在 1,024 字节到 1,031 字节之间。

我确定问题是 rstr 生成的字符之一被计为两个字符，但是......这似乎不应该发生。

这是我的代码：

```
num = 10
k = 1
for i in 1..num
  fname = "f#{i}.txt"
  f = File.new(fname, "w")
  for k in 1..size
    rstr = "#{(1..1024).map{rand(255).chr}.join}"
    f.write rstr
    print " #{rstr.size} "  # this returns 1024 every time.
    rstr = ""
  end
  f.close
end 
```

也试过：

```
 opts = {}  
  opts[:encoding] = "UTF-8"
  fname = "f#{i}.txt"
  f = File.new(fname, "w", opts) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T15:54:04.963

默认情况下，在 Windows 中打开的文件以**文本模式**打开，这意味着调整了行尾和其他细节。

如果您希望文件完全按照您的意愿逐字节写入，则需要以**二进制模式**打开文件：

```
File.new("foo", "wb") do |f|
  # ...
end 
```

在`b`POSIX 操作系统上是一个被忽略的，所以你的脚本现在是跨平台兼容的。

注意：我使用块语法来管理文件，以便在执行块后正确关闭并处理文件处理程序。您不再需要担心关闭文件 ;-)

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T15:38:09.497

没有任何 255 ASCII。值从 0 到 254。如果您尝试 printf `255.chr`，您将得到一个多字节字符。由于 Windows 没有标准的 utf-8，因此您会得到不正确的值。因此，您面临的问题！

尝试`#coding: utf-8`在文件顶部添加。它应该让事情正常进行。

# drupal - Drupal 7 node_save 在 cron 期间不保存计算字段

> ID：11564230
> 
> 赞同：0
> 
> 时间：2012-07-19T15:32:00.060
> 
> 标签：drupal, cron, drupal-7, drupal-computed-field

我有一个 Drupal 内容类型，其中包含许多计算字段。一些（但不是全部）项目正在通过 cron 触发的 RSS 提要导入器添加到此内容类型。我正在尝试为 hook_cron 中的新项目触发计算字段生成。以下代码抓取所有未标记为“已提交”的项目，加载并重新保存节点，然后将节点标记为“已提交”。

```
$query = db_select('node', 'n');
$query->fields('n', array('nid'));
$table_alias = $query->join('field_data_field_submitted', 'r', 'n.nid = r.entity_id AND r.field_submitted_value = 0');
$result = $query->execute();
foreach ($result as $record){
    $q = $record->nid;
    $n = node_load($q);
    node_save($n);
    $query = db_update('field_data_field_submitted')
        ->fields(array('field_submitted_value' => 1))
        ->condition('entity_id', $q)
        ->execute();
} 
```

如果我从模块生成的页面（使用带有页面回调函数的 hook_menu 创建）调用此代码，则此代码的工作方式与我期望的一样。重新提交节点，并生成计算域数据。当我将此代码放在我的 hook_cron 函数中时，查询工作，它遍历记录并更新“提交”值，但不计算计算字段。我很困惑为什么这不会在 cron 中触发。有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T16:42:43.537

嗬！终于意识到这完全是我自己做的。由于这种内容类型的性质，我们允许匿名用户创建新内容，但在创建内容时明确不触发计算字段（长话短说，但简短的形式是经过身份验证的用户然后验证并增强此内容，这是计算字段的来源）。因此，当我设置初始内容时，我禁用了匿名用户的计算字段（如果 $user->uid > 0），并且完全忘记了这一点。一旦我调整了该逻辑以允许在导入时处理计算字段（使用具有导入内容值的字段来触发它，但不用于其他内容），问题就解决了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T17:27:43.700

cron 运行可以访问完整的引导程序，因此没有合乎逻辑的理由说明您的代码在该上下文中会产生不同的结果。

也就是说，您仅`field_data_field_submitted`在还需要更新表时才更新`field_revision_field_submitted`表，因此这可能会以某种方式解释差异。

Drupal 为现场系统提供了一个 API，这样就可以完全避免这类问题。您使用的相同代码，以“Drupal”方式重写，将是：

```
$query = new EntityFieldQuery;
$query->entityCondition('entity_type', 'node')
  ->fieldCondition('field_submitted', 'value', 0);

$results = $query->execute();

if (!empty($results['node'])) {
  $nodes = node_load_multiple(array_keys($results['node']));

  foreach ($nodes as $node) {
    $node->field_submitted[$node->language][0]['value'] = 1;
    node_save($node);
  }
} 
```

我想不出为什么上面的代码会在 cron 上失败的充分理由，所以可能值得试一试。

# oracle - 在 powershell 中处理空值

> ID：11564240
> 
> 赞同：2
> 
> 时间：2012-07-19T15:32:27.670
> 
> 标签：oracle, powershell

我确定以前有人问过这个问题，但我在这里或互联网上找不到任何东西。我正在尝试使用 powershell 查询一个似乎可以正常运行的 oracle 数据库，直到它达到空值然后它就崩溃了。

这是我的代码。

```
# Create a datareader for a SQL statement 
$sql="select * from legacydb.ebt_invoice_dtl where premnum = 397743"
$command = New-Object Oracle.DataAccess.Client.OracleCommand( $sql,$conn)
$reader=$command.ExecuteReader()

# Write out the result set structure 
for ($i=0;$i -lt $reader.FieldCount;$i++) {
Write-Host  $reader.GetName($i) $reader.GetDataTypeName($i) 
}

# Write out the results 
while ($reader.read()) {
$dtl_id=$reader.GetDecimal(0)  
$invoice_id=$reader.GetDecimal(1)
$debtor=$reader.GetInt64(2)
$premise=$reader.GetInt64(3)
$license=$reader.GetString(4)
$invoice_num=$reader.GetInt64(5)
$deb_cred=$reader.GetString(6)
$inv_ref=$reader.GetString(7)
$rate=$reader.GetDecimal(8)
$charge=$reader.GetDouble(9)
$usage=$reader.GetInt64(10)
$tax=$reader.GetDouble(11)
$rate_code=$reader.GetString(12)
$inv_date=$reader.GetDateTime(13)
$missed=$reader.GetString(14)
$change_date=$reader.GetDateTime(15)
$dnp=$reader.GetString(16)

Write-Host "$dtl_id $invoice_id $debtor $premise $license $invoice_num $deb_cred        $inv_ref $rate $charge $usage $tax $rate_code $inv_date $missed $change_date $dnp "
} 
```

错误信息：

> 使用“1”参数调用“GetString”的异常：“列包含 NULL 数据”在 C:\users\klynch\test.ps1:34 char:27 + $dnp=$reader.GetString <<<< (16 ) + CategoryInfo : NotSpecified: (:) [], MethodInvocationException + FullyQualifiedErrorId : DotNetMethodException

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:45:39.300

我会摆脱“SELECT *”并明确命名您的字段。然后你可以使用 NVL/COALESCE 将你的 NULL 值转换成你可以处理的东西。它更多的是预先输入，但它会记录您正在选择的内容，并且如果表结构发生变化，可能会帮助您避免以后出现错误。

> 选择 *

对于除临时类型查询之外的任何内容，IMO 都是不好的做法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T16:47:27.513

您可以检查当前行对于给定列是否为空

```
if ($reader.IsDBNUll(column)) {
  # Handle null
} else {
  # Get the value
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-02T11:06:24.633

另一种解决方案是使用该`reader.GetOracleValue`方法，该方法将返回一个[Oracle Data Provider](http://docs.oracle.com/cd/B19306_01/win.102/b14307/oratypes.htm)对象。这些对象可以存储空值，因此每个对象都有一个`IsNull`属性来检查空值和一个`Value`属性，还可能还有转换方法，例如`ToInt32`，以获取普通 .NET 类型的值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-06-24T09:21:56.310

我认为解决此问题的最佳方法是使用:`GetOracleDecimal()`和`GetOracleString()`. 在这种情况下`null`，将显示为一个值，并且您不会有任何空错误。

# ruby-on-rails-3 - 如何在炼油厂cms 中插入破折号、® 或™ 等符号

> ID：11564246
> 
> 赞同：0
> 
> 时间：2012-07-19T15:32:43.490
> 
> 标签：ruby-on-rails-3, refinerycms, wymeditor

我正在尝试弄清楚如何在refinerycms 的wymeditor 中添加诸如破折号、® 或™ 之类的符号的功能。查看 boot_wym.js.erb 似乎没有在菜单中启用它的选项。有谁知道这是否可能以及您将如何做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T17:06:49.363

丑陋的黑客： [https ://groups.google.com/forum/?fromgroups#!topic/refinery-cms/xiQfYNuWLOs](https://groups.google.com/forum/?fromgroups#!topic/refinery-cms/xiQfYNuWLOs)

# asp.net - Asp.net：如何让页面看起来像弹出窗口（小屏幕）？

> ID：11564249
> 
> 赞同：0
> 
> 时间：2012-07-19T15:32:56.690
> 
> 标签：asp.net

A 在页面上放置一个 ancor 标签。当我单击它时，我希望目标页面在原始页面的顶部显得更小（即 200 像素 x 300 像素）。

```
<a href="Destination.aspx">Destination</a> 
```

回帖后，我希望目标页面消失。

感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:35:14.773

> 当我点击它时，我希望目标页面在原始页面的顶部显得更小（即 200 像素 x 300 像素）

你可以打开它`window.open`

```
<a onclick="openPopup();">Destination</a>

function openPopup()
{
    window.open("Destination.aspx","mywindow","menubar=1,resizable=1,width=350,height=250");
} 
```

> 回帖后，我希望目标页面消失。

1.  在 Destination.aspx 中定义一个隐藏字段。

    ```
    <input type="hidden" runat="server" id="hdnHidePopup" value="" /> 
    ```

2.  在您希望弹出窗口消失之后的 Destination.aspx 的回发中，将隐藏字段的值设置为“true”或您喜欢的值

    ```
     hdnHidePopup.Value = "true"; 
    ```

3.  在加载弹出窗口时添加这个 javascript，可能就在 body 的结束标记之前。

    ```
     <script type="text/javascript">
           hdnHidePopup = document.getElementByID('<%= hdnHidePopup.ClientID %>');
           if(hdnHidePopup .value == "true")
           {
                hdnHidePopup.value = "";
                window.close();       
           }
        </script> 
    ```

# android - 为什么我的列表视图中有重复的项目？

> ID：11564259
> 
> 赞同：2
> 
> 时间：2012-07-19T15:33:39.817
> 
> 标签：android, listview

我检查了数组 menuItems 看起来不错，但是下面的代码有问题。当我开始时它似乎还可以，但是当我开始滚动时它会搞砸并将项目放在列表顶部并重复项目......这很奇怪

```
public class ScoresAdapter extends BaseAdapter {

private MainActivity activity;
private ScoreItem[] menuItems;
private static LayoutInflater inflater=null;
ImageDownloader downloader;

public ScoresAdapter(MainActivity a, ScoreItem[] scoreItems) {
    activity = a;
    menuItems = scoreItems;
    inflater = (LayoutInflater)activity.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    downloader = new ImageDownloader();
}

public int getCount() {
    int teller = 0;

    for(int i = 0 ; menuItems.length > i ; i++){
        if(menuItems[i] != null){
            teller++;
        }
    }

    return teller;
}

public Object getItem(int position) {
    return position;
}

public long getItemId(int position) {
    return position;
}

public View getView(final int position, View convertView, ViewGroup parent) {        
    View vi=convertView;
    if(convertView==null){    
        if(menuItems[position].getId() == 888){
            //fav header
            vi = inflater.inflate(R.layout.scoresheaderfavoriet, null);

        }else if(menuItems[position].getId() == 999){
            //overige header
            vi = inflater.inflate(R.layout.scoresheaderoverig, null);

        }else{

            if(menuItems[position].getIsFav()){
                vi = inflater.inflate(R.layout.scoresfavitem, null);
            }else{
                vi = inflater.inflate(R.layout.scoresitem, null);
            }

            TextView text2=(TextView)vi.findViewById(R.id.position);
            text2.setText(""+ menuItems[position].getPosition());

            TextView text=(TextView)vi.findViewById(R.id.name);
            text.setText(menuItems[position].getFirstName() + " " + menuItems[position].getLastName().toUpperCase());

            TextView text5=(TextView)vi.findViewById(R.id.country);
            text5.setText(""+ menuItems[position].getCountry());

            TextView text3=(TextView)vi.findViewById(R.id.score);
            text3.setText(""+ menuItems[position].getScore());

            TextView text8=(TextView)vi.findViewById(R.id.hole);
            text8.setText(""+ menuItems[position].getHole());

            vi.setOnClickListener(new OnClickListener() {
                public void onClick(View v) {
                    Intent intent = new Intent(v.getContext(), SpelerView.class);
                    intent.putExtra("id", menuItems[position].getId());
                    v.getContext().startActivity(intent);

                    activity.sluitAlleMenus();
                }
            });
        }

    }

    return vi;
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T14:39:44.997

我有同样的问题

```
 public View getView(int position, View convertView, ViewGroup parent) {
    ViewHolder holder;
    CalendarsData c = (CalendarsData) this.getItem(position);

    if (convertView == null) {
        holder=new ViewHolder();
        convertView = l_Inflater.inflate(R.layout.preference_list_element, null);

        holder.text=(CheckBox)convertView.findViewById(R.id.checkTextView);         
        //holder.tv =(TextView)convertView.findViewById(R.id.textview);

        holder.text.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                CheckBox cb = (CheckBox) v;
                CalendarsData ssi = (CalendarsData) cb.getTag();
                ssi.setChecked(cb.isChecked());
            }
        });             

        convertView.setTag(holder);
    } else {
        holder = (ViewHolder) convertView.getTag();
    }   

holder.text.setText("c.anyvalue");
return convertView;
} 
```

就像上面的人说你需要其他：

```
} else {
        holder = (ViewHolder) convertView.getTag(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T15:43:12.657

我曾经遇到过同样的问题。我认为这是因为适配器的“缓存”......你应该实现这样的 else ：

```
 if(convertView==null){
     holder = new NodeViewHolder();
     //Your stuff
     convertView.setTag(holder);
 }else{
     holder = (NodeViewHolder) convertView.getTag();
 }

 public static class NodeViewHolder {
    TextView text;
    TextView text2;
    TextView text3;
    //So on...
 } 
```

缓存视图时执行（非空）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T15:47:00.083

当您的 convertView 不正确为空时，您没有处理这种情况。像这样更改您的代码：

```
public View getView(final int position, View convertView, ViewGroup parent) {        
    View vi=convertView;
    if(convertView==null){    
        if(menuItems[position].getId() == 888){
            //fav header
            vi = inflater.inflate(R.layout.scoresheaderfavoriet, null);

        }else if(menuItems[position].getId() == 999){
            //overige header
            vi = inflater.inflate(R.layout.scoresheaderoverig, null);

        }else{

            if(menuItems[position].getIsFav()){
                vi = inflater.inflate(R.layout.scoresfavitem, null);
            }else{
                vi = inflater.inflate(R.layout.scoresitem, null);
            }

        }

    }
            TextView text2=(TextView)vi.findViewById(R.id.position);
            text2.setText(""+ menuItems[position].getPosition());

            TextView text=(TextView)vi.findViewById(R.id.name);
            text.setText(menuItems[position].getFirstName() + " " + menuItems[position].getLastName().toUpperCase());

            TextView text5=(TextView)vi.findViewById(R.id.country);
            text5.setText(""+ menuItems[position].getCountry());

            TextView text3=(TextView)vi.findViewById(R.id.score);
            text3.setText(""+ menuItems[position].getScore());

            TextView text8=(TextView)vi.findViewById(R.id.hole);
            text8.setText(""+ menuItems[position].getHole());

            vi.setOnClickListener(new OnClickListener() {
                public void onClick(View v) {
                    Intent intent = new Intent(v.getContext(), SpelerView.class);
                    intent.putExtra("id", menuItems[position].getId());
                    v.getContext().startActivity(intent);

                    activity.sluitAlleMenus();
                }
            });

    return vi;
} 
```

这将使您最容易到达那里。您可能还必须将一些您的收藏夹和/或页眉页脚逻辑移出`if(convertView ==null)`。不过，我不能确切地说出你在做什么，所以我不确定它需要如何。

# java - 是否可以在 Java 中获取 for-each 循环的索引

> ID：11564262
> 
> 赞同：17
> 
> 时间：2012-07-19T15:33:50.303
> 
> 标签：java

鉴于下面的代码，是否可以`p`在 Java 中使用这种 for 循环样式从属性列表中删除索引？

```
List<Properties> propertiesList = new ArrayList<Properties>();
String keyToDelete = "blah";

for(Properties p : propertiesList) {
    if(p.getKey().equals(keyToDelete)) {
        propertiesList.remove(index) //How to remove the element at index 'p'
    }
} 
```

这就是我如何用另一个`for`循环来完成这个

```
List<Properties> propertiesList = new ArrayList<Properties>();
String keyToDelete = "blah";

for(int i = 0; i < propertiesList.size(); i++) {
        if(p.getKey().equals(keyToDelete)) {
                propertiesList.remove(i);
        }
} 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-07-19T15:40:29.740

做到这一点的方法是明确的[`Iterator`](http://docs.oracle.com/javase/6/docs/api/java/util/Iterator.html#remove%28%29)（没有像老派那样的学校！）。

```
Iterator<Properties> it = propertiesList.iterator();
while (it.hasNext()) {
    if (it.next().getKey().equals(keyToDelete)) {
        it.remove();
    }
} 
```

与列表上的 remove 方法不同，[`remove`迭代器上](http://docs.oracle.com/javase/6/docs/api/java/util/Iterator.html#remove%28%29)的方法不会导致并发修改。这是从您正在迭代的集合中删除元素的唯一安全方法。正如该方法的 javadoc 所说：

> 如果在迭代过程中以除调用此方法之外的任何方式修改了底层集合，则迭代器的行为是未指定的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-19T15:35:25.487

不，您需要使用老式的 for 循环来获取索引。

您当然可以自己将其添加到 for-each 循环中，但是使用旧变体可能会更好。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-07-19T15:40:51.910

如何使用正确[`Iterator`](http://docs.oracle.com/javase/6/docs/api/java/util/Iterator.html)的`remove`方法？

```
List<Properties> propertiesList = new ArrayList<Properties>();
String keyToDelete = "blah";

for (
    Iterator<Properties> iter = propertiesList.iterator( );
    iter.hasNext( );
)
{
    Properties p = iter.next( );

    if(p.getKey().equals(keyToDelete)) {
        iter.remove( );
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-19T15:45:29.240

正如蒂姆安德森建议的那样，您还可以在循环外修改列表

```
List<Properties> propertiesList = new ArrayList<Properties>();
String keyToDelete = "blah";
List<Properties> propertiesToRemove = new ArrayList<Properties>();

for(Properties p : propertiesList) {
    if(p.getKey().equals(keyToDelete)) {
        propertiesToRemove.add(p) ;
    }
}

propertiesList.removeAll(propertiesToRemove); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-19T15:40:22.580

据我所知，foreach 循环不保证它枚举的元素的顺序，

因此，如果您尝试 Collection[i]，您可以获得另一个元素，而不是当前迭代

在一些多线程的情况下可以清楚的看到

# ios - 如何使用 IB 显示精确大小的按钮？

> ID：11564263
> 
> 赞同：0
> 
> 时间：2012-07-19T15:33:54.397
> 
> 标签：ios

我在 Photoshop 中创建了一个按钮，它已经是用于显示的确切大小。

在 IB 中，我创建了一个 RRB 并将背景图像设置为按钮 .png。但是，这不能正确显示 - 在我的 .png 按钮和 IB 提供的按钮之间有一个白边，尤其是在必须具有不同半径的角落处。我尝试过使用 IB 中的所有各种设置，但无法让它消失。

但是，如果不是将 .png 设置为背景图像，而是将其设置为图像，那么它看起来很完美（图像和背景图像之间有什么区别？）。但是，当 .png 设置为图像而不是背景时，我根本无法显示按钮文本，尽管当 .png 设置为背景图像时它会出现。我再次尝试在 IB 中设置所有各种设置，但无法显示文本。

我做错了什么，我应该怎么做才能让它工作？

我知道我可以以编程方式创建按钮和文本，但我想了解为什么我可以使用 IB 让它工作。

编辑：我已将类型更改为自定义，但仍无法正确显示。查看我发布的图像，没有文字的图像是它应该如何显示以及如果我将 .png 设置为图像而不是背景会是什么样子。第二个是如果我将背景图像设置为 .png 并将按钮类型设置为自定义时的样子。第三个是设置为 .png 的背景图像，类型为圆角矩形。![在此处输入图像描述](../Images/171332c46ad8ca65594bc67902ea931e.png) ![在此处输入图像描述](../Images/e502c0eaa36b9c985b91393743c6a38a.png) ![在此处输入图像描述](../Images/d75b22723c209777063ba3e6ce52fde9.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T15:37:37.487

使用按钮类型 = UIButtonTypeCustom

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T15:38:04.837

不要使用圆角矩形按钮类型，而是将按钮类型设置为 UIButtonTypeCustom。这将按照您的意愿进行，因为它会将按钮包裹在您提供的图像周围。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T16:18:00.767

看起来您的按钮背景图像与您的`UIButton`.

iOS 支持所谓的“可拉伸图像”，允许您定义应该拉伸图像的哪个部分。不幸的是，这不能在 Interface Builder 中完成。在代码中，您可以这样做：

```
-(void)viewDidLoad
{
    [super viewDidLoad];
    UIImage *stretchableImage = [[someButton backgroundImageForState:UIControlStateNormal] stretchableImageWithLeftCapWidth:5 topCapHeight:5];
    [someButton setBackgroundImage:stretchableImage forState:UIControlStateNormal];
} 
```

**重要提示**：`stretchableImageWithLeftCapWidth:topCapHeight:`在 iOS 5 中已弃用，但如果您还需要支持 iOS 4，这是唯一的解决方案。如果您只能使用 iOS 5，请使用`resizableImageWithCapInsets:`.

# ruby - Ruby 空白环境执行范围

> ID：11564265
> 
> 赞同：1
> 
> 时间：2012-07-19T15:34:09.287
> 
> 标签：ruby, scope, require, execution

我目前正在开发一个基本上执行另一个应用程序的框架，例如在另一个 ruby​​ 程序的上下文中的 rails。我最初的尝试只是像这样启动应用程序：

```
def load_app!

  # Load the rails application
  require './config/application'

  # Initialize the rails application
  @app = App::Application.initialize!

end 
```

这里的问题是框架的需求与加载的应用程序发生冲突，因此`initialize!`调用永远不会起作用，尽管它会在普通的 ruby​​ 程序中起作用。

所以我的问题是，如果有人知道一种方法，可以基本上将此调用范围限定为一个行为类似于空白 RVM 环境的单元。所以基本上是这样的行为：

```
require 'json'
puts JSON.generate({:name => "test"})

blank_environment do
  puts JSON.generate({:name => "test"})
  #=> uninitialized constant JSON

  require 'json'
  puts JSON.generate({:name => "test"})
end 
```

取消定义或卸载当前加载的常量并没有完成，因为我不知道所有这些常量，因为我再次使用具有其他依赖项的 gem。

那么有没有很酷的方法？或者任何其他方式来处理这个？

更新：

刚想到一个主意。为什么 ruby​​ 的`require`方法总是需要全局范围？将加载的模块实际限定在当前模块下不是一个非常好的功能吗？

```
module ScopeA
  require 'json' #> adds support for ScopeA::JSON  

  # due to normal ruby scoping everything can be called like normal in here
  JSON.parse("something")
end

# JSON should not be available here

module ScopeB
  require 'yaml'

  YAML.parse("something") # but no JSON, of course
end 
```

不存在这样的东西吗？`include`已经必须知道常数...

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-22T22:23:09.860

好吧，经过更多的研究，它似乎真的不像我需要的那样。

我现在使用分布式 ruby​​ 实现了一个基本版本，这对我不太满意：

```
require 'drb/drb'

URI = "druby://localhost:8787"

# Blank environment
pid = fork do
  Signal.trap("INT") { puts "Stopping Server.."; exit }

  class Application
    def call(env)
      [200,{},""]
    end
  end

  DRb.start_service(URI, Application.new)
  DRb.thread.join
end

# Working environment
DRb.start_service

app = DRbObject.new_with_uri(URI)
puts app.call({})

Process.kill("INT", pid)
Process.wait 
```

如果有人提出更好的方法，非常感谢！

# visual-studio-2010 - 为什么调试模式比 VS 中的发布慢？

> ID：11564267
> 
> 赞同：7
> 
> 时间：2012-07-19T15:34:27.637
> 
> 标签：visual-studio-2010

我已经用谷歌搜索过了，通常反应相当复杂，我不太了解所有的行话。为什么调试模式这么慢有一个简单的解释吗？为什么不总是在 Release 中运行？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-19T15:38:32.417

调试模式已关闭所有优化，以确保连接的调试器按预期工作。一个版本将开启许多优化。

比这更简单，我无法说明。

# java - 如何将 IEEE-11073 16 位 SFLOAT 转换为 Java 中的简单浮点数？

> ID：11564270
> 
> 赞同：6
> 
> 时间：2012-07-19T15:34:43.777
> 
> 标签：java, types, floating-point

标题不言自明：如何将 IEEE-11073 16 位 SFLOAT 转换为 Java 中的简单浮点数？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-05T12:32:51.383

IEEE-11073 不在公共领域，但您可以在蓝牙个人健康档案中找到足够的信息。谷歌完整规范#11073-2060。以下是蓝牙个人健康转码纸的复制粘贴：

> 以下信息在 ISO/IEEE 标准中定义。11073-2060™1-2008 [1]。SFLOAT-Type 数据类型被定义为表示非整数类型的数值。SFLOAT-Type 定义为具有 12 位尾数和 4 位指数的 16 位值。有关 SFLOAT 类型的详细定义，请参见 [1] 的附录 F.8。该数据类型定义如下： 指数尾数大小 4 位 12 位
> 
> 16位浮点型；整数类型只是占位符
> 
> SFLOAT-Type ::= INT-U16 16 位值包含以 10 为底的 4 位指数，后跟 12 位尾数。每个都是二进制补码形式。分配特殊值以表示以下内容： NaN [指数 0，尾数 +(2^11 –1) → 0x07FF] NRes [指数 0，尾数 –(2^11) → 0x0800] + INFINITY [指数 0，尾数 +( 2^11 –2) → 0x07FE] – INFINITY [指数 0，尾数 –(2^11 –2) → 0x0802] 保留供将来使用 [指数 0，尾数 –(2^11 –1) → 0x0801]

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-05-10T03:57:05.590

这个 11073 库具有执行此操作的 C 代码：

[https://github.com/signove/antidote/blob/master/src/util/bytelib.c](https://github.com/signove/antidote/blob/master/src/util/bytelib.c)

转换成 Java 应该不难。

```
double read_sfloat(ByteStreamReader *stream, int *error)
{
    intu16 int_data = read_intu16(stream, error);
    if (*error)
        return 0;

    intu16 mantissa = int_data & 0x0FFF;
    int8 expoent = int_data >> 12;

    if (expoent >= 0x0008) {
        expoent = -((0x000F + 1) - expoent);
    }

    float output = 0;

    if (mantissa >= FIRST_S_RESERVED_VALUE && mantissa
        <= MDER_S_NEGATIVE_INFINITY) {
        output = reserved_float_values[mantissa
                           - FIRST_S_RESERVED_VALUE];
    } else {
        if (mantissa >= 0x0800) {
            mantissa = -((0x0FFF + 1) - mantissa);
        }
        double magnitude = pow(10.0f, expoent);
        output = (mantissa * magnitude);
    }

    return output;
} 
```

样板代码：

```
typedef enum {
    MDER_S_POSITIVE_INFINITY = 0x07FE,
    MDER_S_NaN = 0x07FF,
    MDER_S_NRes = 0x0800,
    MDER_S_RESERVED_VALUE = 0x0801,
    MDER_S_NEGATIVE_INFINITY = 0x0802
} ReservedSFloatValues;

static const intu32 FIRST_S_RESERVED_VALUE = MDER_S_POSITIVE_INFINITY;

intu16 read_intu16(ByteStreamReader *stream, int *error)
{
    intu16 ret = 0;

    if (stream && stream->unread_bytes > 1) {
        ret = ntohs(*((uint16_t *) stream->buffer_cur));

        stream->buffer_cur += 2;
        stream->unread_bytes -= 2;
    } else {
        if (error) {
            *error = 1;
        }

        ERROR("read_intu16");
    }

    return ret;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-19T15:45:47.223

您可以使用位移。提取符号、指数和尾数并将它们移位，使它们为浮点格式。您可能需要更正 Infinity 和 NaN。

正如@PretiP 的回答所指出的那样，指数以 10 为底，因此您需要乘以或除以 10 的幂才能得到最终值。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-09-04T15:03:24.007

尝试搜索“Personal Health Devices Transcoding_WP_V11”，它将引导您找到来自蓝牙特别兴趣小组的文档。在 2011 年 10 月 25 日/V11r00 版本的文档中，第 2.2 节“将蓝牙特性转码为 11073 属性”给出了如何处理 11073-20601 FLOAT（32 位）和 SFLOAT（16 位）数字的详细说明和示例。

本文档的当前 URL 为 [https://www.bluetooth.org/docman/handlers/downloaddoc.ashx?doc_id=242961](https://www.bluetooth.org/docman/handlers/downloaddoc.ashx?doc_id=242961)

请注意，这可能与 Petri P. 上面引用的文件相同。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-01-20T17:17:16.107

即使这篇文章有点旧，我只想发布我的解决方案，基于[这个](http://dev.arcsmed.at/homer.core/trac/export/518/trunk/isoagent/src/main/java/org/openhealthtools/stepstone/phd/core/asn1/base/ASN_SFloatType.java)java 文件。

```
public short getExponent(short value)
{
    if (value < 0)
    { // if exponent should be negative
        return (byte) (((value >> 12) & 0x0F) | 0xF0);
    }
    return (short) ((value >> 12) & 0x0F);
}

public short getMantissa(short value)
{
    if ((value & 0x0800) != 0)
    { // if mantissa should be negative
        return (short) ((value & 0x0FFF) | 0xF000);
    }
    return (short) (value & 0x0FFF);
}

public double parseSFLOATtoDouble(short value)
{
    // NaN
    if (value == 0x07FF)
    {
        return Double.NaN;
    }
    // NRes (not at this resolution)
    else if (value == 0x0800)
    {
        return Double.NaN;
    }
    // +INF
    else if (value == 0x07FE)
    {
        return Double.POSITIVE_INFINITY;
    }
    // -INF
    else if (value == 0x0802)
    {
        return Double.NEGATIVE_INFINITY;
    }
    // Reserved
    else if (value == 0x0801)
    {
        return Double.NaN;
    }
    else
    {
        return ((double) getMantissa(value)) * Math.pow(10, getExponent(value));
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-03-03T17:09:03.613

对于那些希望在使用 Javascript 时转换 SFLOAT 的人来说，这里有一个简洁的库，可以做到这一点，等等。 [https://github.com/bluetoother/ble-packet](https://github.com/bluetoother/ble-packet)

如果你想添加自己的特性，只需使用 addMeta 函数，defs/charMeta.js 有很多例子！

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2012-07-19T16:14:16.987

我找不到任何与 IEEE 11073 相关的浮点规范，您*可能*是指[半精度浮点](http://en.wikipedia.org/wiki/Half-precision_floating-point_format)（有时也称为 Minifloat）。

该格式在 Wikipedia 中有充分的描述，可以轻松地将其转换为普通浮点数。基本上，您将其分为 3 个字段（符号、指数、尾数）。标志不需要转换，只需要移动到正确的位置。然后检查指数是否为 MIN 或 MAX 值，处理特殊情况（Inf、NaN、次正规/非正规化）。否则，只需纠正指数的偏差并转移到正确的位置。对于尾数，根据需要在右侧添加尽可能多的零。最后将所有内容放在一个 int 中，并使用 Float.intBitsToFloat(bits) 将这些位转换为普通的 java 浮点数。

从浮点数转换的工作方式几乎相同，只是存在舍入、上溢和下溢的额外陷阱。

# perl - 无法运行 perl 程序：使用 perl5.8.4 无法在 @INC 中找到 Time/Piece.pm，使用 perl 5.12.3 无法在 @INC 中找到 DBI.pm

> ID：11564272
> 
> 赞同：2
> 
> 时间：2012-07-19T15:34:50.247
> 
> 标签：perl, solaris, perl-module, solaris-10

我有 Solaris 10，我正在尝试运行 Perl 程序。

我安装了两个 perl 版本：

`/usr/bin/perl`版本 5.8.4

和

`/usr/local/bin/perl`版本 5.12.3

我已经安装了 DBI 包（它安装在这里，`/usr/perl5/site_perl/5.8.4/sun4-solaris-64int/auto/DBI/.packlist`），我通过执行不同`perl`版本的 Perl 程序得到的问题是（在 ubuntu 中它工作正常）。

```
bash-3.00# perl temp.pl
在@INC 中找不到 Time/Piece.pm（@INC 包含：/usr/perl5/5.8.4/lib/sun4-   
solaris-64int /usr/perl5/5.8.4/lib /usr/perl5/site_perl/5.8.4/sun4-solaris-64int
/usr/perl5/site_perl/5.8.4 /usr/perl5/site_perl /usr/perl5/vendor_perl/5.8.4/sun4-
solaris-64int /usr/perl5/vendor_perl/5.8.4 /usr/perl5/vendor_perl .) 在    
temp.pl 第 4 行。
BEGIN failed——编译在 temp.pl 第 4 行中止。

bash-3.00# /usr/local/bin/perl temp.pl
无法在 @INC 中找到 DBI.pm（@INC 包含：/usr/local/lib/perl5/site_perl/5.12.3
/sun4-solaris /usr/local/lib/perl5/site_perl/5.12.3 /usr/local/lib/perl5/5.12.3/sun4-
solaris /usr/local/lib/perl5/5.12.3 /usr/local/lib/perl5/site_perl .) 在 temp.pl 第 5 行。
BEGIN failed——编译在 temp.pl 第 5 行中止。
```

我已经尝试了很多方法，但没有得到如何在 solaris 上运行我的 Perl 程序。有人可以帮忙吗。

下面是我的程序。事实上它是由@Borodin 重新定义的。非常感谢他。

```
use strict;
use warnings;

use Time::Piece;
use DBI;

open my $log, '<', '/opt/testlogs/test.log' or die "Unable to open log file: $!";

my ( $count_start, $count_interim, $count_stop ) = ( 0, 0, 0 );

while (<$log>) {

    if (/server start/) {
        $count_start++;
    }
    elsif (/server interim-update/) {
        $count_interim++;
    }
    elsif (/server stop/) {
        $count_stop++;
    }
}

print <<END;
Start:   $count_start
Interim: $count_interim
Stop:    $count_stop
END

print localtime->strftime("%b %e %H:%M:%S"), "\n";

my $dbh = DBI->connect( "DBI:Pg:dbname=postgres;host=localhost", "postgres", "postgres", { 'RaiseError' => 1 } );

my $rows = $dbh->do(
    "insert into radius (server_start, server_stop, server_interim)
       Values ($count_start, $count_stop, $count_interim)"
);

printf "%d %s affected\n", $rows, $rows == 1 ? 'row' : 'rows'; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-19T15:43:43.553

你没有为 /usr/bin/perl 安装 Time::Piece，所以安装它。

```
/usr/bin/perl -MCPAN -e install Time::Piece 
```

你没有为 /usr/local/bin/perl 安装 DBI，所以安装它。

```
/usr/local/bin/perl -MCPAN -e install DBI 
```

# python - matplotlib：两行之间的连续颜色图填充

> ID：11564273
> 
> 赞同：11
> 
> 时间：2012-07-19T15:34:51.997
> 
> 标签：python, matplotlib

可以在线条之间填充颜色：

[http://matplotlib.sourceforge.net/examples/pylab_examples/fill_between_demo.html](http://matplotlib.sourceforge.net/examples/pylab_examples/fill_between_demo.html)

也可以对一条线使用连续的颜色图：

[http://matplotlib.sourceforge.net/examples/pylab_examples/multicolored_line.html](http://matplotlib.sourceforge.net/examples/pylab_examples/multicolored_line.html)

是否可以（并且相当容易）为两行之间的彩色填充使用连续的颜色图？例如，颜色填充可以基于 x 处两条线之间的差异（或基于另一组数据）沿 x 变化。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2015-04-15T17:19:51.907

我找到了解决这个问题的方法。它建立在@Hooked的出色但老套的[解决方案之上。](https://stackoverflow.com/questions/18215276/how-to-fill-rainbow-color-under-a-curve-in-python-matplotlib?lq=1)您从许多小盒子中创建了一个 2D 网格。这不是最快的解决方案，但它应该非常灵活（比将 imshow 应用于补丁的解决方案更灵活）。

```
import numpy as np
import pylab as plt

#Plot a rectangle
def rect(ax, x, y, w, h, c,**kwargs):
    #Varying only in x
    if len(c.shape) is 1:
        rect = plt.Rectangle((x, y), w, h, color=c, ec=c,**kwargs)
        ax.add_patch(rect)
    #Varying in x and y
    else:
        #Split into a number of bins
        N = c.shape[0]
        hb = h/float(N); yl = y
        for i in range(N):
            yl += hb
            rect = plt.Rectangle((x, yl), w, hb, 
                                 color=c[i,:], ec=c[i,:],**kwargs)
            ax.add_patch(rect)

#Fill a contour between two lines
def rainbow_fill_between(ax, X, Y1, Y2, colors=None, 
                         cmap=plt.get_cmap("Reds"),**kwargs):
    plt.plot(X,Y1,lw=0)  # Plot so the axes scale correctly

    dx = X[1]-X[0]
    N  = X.size

    #Pad a float or int to same size as x
    if (type(Y2) is float or type(Y2) is int):
        Y2 = np.array([Y2]*N)

    #No colors -- specify linear
    if colors is None:
        colors = []
        for n in range(N):
            colors.append(cmap(n/float(N)))
    #Varying only in x
    elif len(colors.shape) is 1:
        colors = cmap((colors-colors.min())
                      /(colors.max()-colors.min()))
    #Varying only in x and y
    else:
        cnp = np.array(colors)
        colors = np.empty([colors.shape[0],colors.shape[1],4])
        for i in range(colors.shape[0]):
            for j in range(colors.shape[1]):
                colors[i,j,:] = cmap((cnp[i,j]-cnp[:,:].min())
                                    /(cnp[:,:].max()-cnp[:,:].min()))

    colors = np.array(colors)

    #Create the patch objects
    for (color,x,y1,y2) in zip(colors,X,Y1,Y2):
        rect(ax,x,y2,dx,y1-y2,color,**kwargs)

# Some Test data    
X = np.linspace(0,10,100)
Y1 = .25*X**2 - X
Y2 = X
g = np.exp(-.3*(X-5)**2)

#Plot fill and curves changing in x only
fig, axs =plt.subplots(1,2)
colors = g
rainbow_fill_between(axs[0],X,Y1,Y2,colors=colors)
axs[0].plot(X,Y1,'k-',lw=4)
axs[0].plot(X,Y2,'k-',lw=4)

#Plot fill and curves changing in x and y
colors = np.outer(g,g)
rainbow_fill_between(axs[1],X,Y1,Y2,colors=colors)
axs[1].plot(X,Y1,'k-',lw=4)
axs[1].plot(X,Y2,'k-',lw=4)
plt.show() 
```

结果是， ![在此处输入图像描述](../Images/afa9a345c49503ebb6101d1809f5be75.png)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-08-31T13:09:40.880

您的解决方案很棒而且很灵活！特别是 2D 案例非常好。`fill_between`如果函数的颜色 kwargs 可以接受 x 和 y 长度相同的数组，则可以添加这样的功能？

`fill_between`这是使用该函数的一维案例的更简单案例。它的作用相同，但由于它使用梯形而不是矩形，因此结果更平滑。

```
import matplotlib as mpl
import matplotlib.pyplot as plt

import numpy as np
from scipy.stats import norm

# Select a color map
cmap = mpl.cm.bwr

# Some Test data
npts = 100
x = np.linspace(-4, 4, npts)
y = norm.pdf(x)
z = np.sin(2 * x)
normalize = mpl.colors.Normalize(vmin=z.min(), vmax=z.max())

# The plot
fig = plt.figure()
ax = fig.add_axes([0.12, 0.12, 0.68, 0.78])
plt.plot(x, y, color="gray")
for i in range(npts - 1):
    plt.fill_between([x[i], x[i+1]], [y[i], y[i+1]], color=cmap(normalize(z[i])))

cbax = fig.add_axes([0.85, 0.12, 0.05, 0.78])
cb = mpl.colorbar.ColorbarBase(cbax, cmap=cmap, norm=normalize, orientation='vertical')
cb.set_label("Sin function", rotation=270, labelpad=15)
plt.show() 
```

[![在此处输入图像描述](../Images/b10c281aa6f6df0ce38005e707bd2203.png)](https://i.stack.imgur.com/iV6EI.png)

# java - Java中的日期，如何操作年份？

> ID：11564281
> 
> 赞同：0
> 
> 时间：2012-07-19T15:35:14.713
> 
> 标签：java, date

我在 Java 中有一个 Date 对象。有时日期的年份设置为 17。当我使用 SimpleDateFormat 输出它时，它被打印为 0017。我所有的年份都将在 2000 年代。有没有办法检查年份是否低于某个值，如果是，则添加 2000？那么一旦你这样做了，你如何重新创建 Date 对象以使用新年？似乎 Date 对象中的所有内容都已弃用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T15:42:52.720

我会使用日历：

```
Date myDate = new Date();
Calendar cal = Calendar.getInstance();
cal.setTime(myDate);
int year = cal.get(Calendar.YEAR);
if(year < 2000)
    cal.add(Calendar.YEAR, 2000); // add two thousand years 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T15:40:08.073

如果您使用日历或 Joda Time（更好的选择），您可以获取和设置年份（或其他字段）

首先，您的年份不应该是 17 岁。我会尝试从源头上纠正问题，而不是稍后修补它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T15:43:51.047

首先，Date.getYear 返回 CurrentYear - 1900，而不是 2000，看起来您每次都希望进行增量。

但是由于它已被弃用，如果可能的话，你不应该首先使用它。API 建议您改用日历类：http: [//docs.oracle.com/javase/1.4.2/docs/api/java/util/Calendar.html](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Calendar.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-11-23T01:30:02.210

# php - 使用参数'status'退出

> ID：11564282
> 
> 赞同：2
> 
> 时间：2012-07-19T15:35:19.030
> 
> 标签：php

根据[文档](http://php.net/manual/en/function.exit.php)退出：

> 如果 status 是一个整数，则该值将用作退出状态而不打印。

这让我很困惑。a`exit();`和 a 和有什么不一样`exit(1);`？有哪些用例？我应该如何选择？在什么场合？php如何管理这种状态？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T15:37:18.097

操作系统/外壳程序/调用您的 PHP 脚本的进程可以读取一个数字返回码。见：[http ://en.wikipedia.org/wiki/Exit_status](http://en.wikipedia.org/wiki/Exit_status)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T15:37:04.747

我相信只有在从命令行执行脚本或另一个程序正在执行它时才有用，通过网络服务器它是没有意义的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T22:09:37.950

`exit();`和之间的区别在于`exit(1);`，前者将执行 PHP 脚本的进程的[退出状态](http://en.wikipedia.org/wiki/Exit_status)`0`设置为，而后者将其设置为`1`.

退出状态`0`通常意味着进程成功完成。没有发生错误。

An exit status of `1` to `254` usually is used to signal that the process was aborted because some kind of error occurred. What error a specific exit status means is up to your PHP script.

Parent processes can use the exit statuses returned by child processes to decide how to continue, e.g. whether they should exit too, or retry, or execute another child process, or whatever.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T15:40:06.127

它就像 C++ 中的返回代码一样，通常程序在一切成功完成时返回 0，在发生某些错误时返回负数，正数取决于可以使用该代码的位置。

但总的来说，正如之前的答案中已经说过的那样，如果脚本不会从另一个脚本或程序中调用，那么返回什么没有多大意义

# actionscript-3 - Flex/mxml：如何在 TextInput 框中以科学计数法显示数字？

> ID：11564283
> 
> 赞同：2
> 
> 时间：2012-07-19T15:35:20.517
> 
> 标签：actionscript-3, apache-flex, mxml

在我的 Flex 应用程序中，我有一个 TextInput 框，用户可以输入一个数字。它以字符串形式出现，然后通过 NumberFormatter。然后结果会显示在 TextInput 框中。这适用于小数字。

大数有问题。例如，如果用户输入 100e30（这是 1x10^32 的科学记数法），TextInput 将显示：

```
100000000000000000000000000000000 
```

当我真正想要展示的是

```
1.0E32 
```

这就是它在 Flash Builder 内部的显示（和存储）方式，例如，使用调试器查看的方式。

AS3/mxml 中是否有任何简单的例程可以将科学计数法输出到 TextInput 控件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T15:52:51.413

```
var n:Number = 10000000000;
trace(n.toExponential(1)); 
```

输出 ：

```
1.0e+10 
```

要将其设置为文本输入：

```
textInput.text = n.toExponential(1); 
```

# php - 从当前目录中的 php 文件执行 git commit

> ID：11564289
> 
> 赞同：1
> 
> 时间：2012-07-19T15:35:51.690
> 
> 标签：php, linux, git, apache, shell

我尝试执行这段代码，但它什么也没做。但是当在 shell_exec 中放入“git show --summary”时，它会返回 git 状态。

```
if($_GET['action']=='add'){
    $output = shell_exec('git add *');
    echo "Add:<pre>$output</pre>";
}
if($_GET['action']=='commit'){
    $output = shell_exec('git commit -m "'.$_POST["txt"].'" ');
    echo "Commit:<pre>$output</pre>";

} 
```

是否可以从 php 提交 git，以及如何提交？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T15:50:59.290

`shell_exec``NULL`如果命令失败，将返回。这几乎肯定会发生……问题是为什么。您将无法使用`shell_exec`.

我建议改为使用 exec，这样您至少可以弄清楚调用的状态以及出了什么问题。

[http://www.php.net/manual/en/function.exec.php](http://www.php.net/manual/en/function.exec.php)

这将允许您设置一些变量，这些变量将填充系统内部操作系统调用的返回值。

```
$shell_output = array();
$status = NULL;

if($_GET['action']=='add'){
    $output = shell_exec('git add *',$shell_output,$status);
    print_r($shell_output)
    print_r($status);
}
if($_GET['action']=='commit'){
    $output = shell_exec('git commit -m "'.$_POST["txt"].'" ',$shell_output,$status);
    print_r($shell_output)
    print_r($status);
} 
```

我的猜测是您的权限有问题。git 中的 A`commit`需要对该目录的“.git”文件夹的写权限。

另外，请确保您在正确的目录中操作！运行 PHP 实例的 apache 用户可能已经或可能尚未`cd`编辑到 repo 所在的正确文件夹。您可能需要在`cd path_to_repo && git commit`命令中添加一个以首先移动到正确的目录。我首先使用绝对路径进行调试。

只是一个忠告......如果你试图建立一个基于 PHP 的 git 客户端，你将不得不处理大量的失败案例，其中一个在这段代码中很明显......当没有新文件被修改时提交。如果您需要关注这些情况，我鼓励您查看社区解决方案：

[有没有支持 http 的好 php git 客户端？](https://stackoverflow.com/questions/9284283/is-there-a-good-php-git-client-with-http-support)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-25T17:38:46.477

我建议您在 git 提交中添加姓名和电子邮件：

```
$output = shell_exec('git -c user.name="www-data" -c user.email="no-replay@example.org" commit -m "'.$_POST["txt"].'" ', $shell_output, $status); 
```

这些错误可以在服务器错误文件中找到，例如：/var/log/apache2/error.log

```
cat /var/log/apache2/error.log 
```

# python - 当我不知道需要多长时间时，如何让我的 QProgressDialog 出现？

> ID：11564293
> 
> 赞同：2
> 
> 时间：2012-07-19T15:36:00.283
> 
> 标签：python, qt, qt4, pyqt, pyqt4

我正在使用`subprocess.call`运行需要一段时间（> 5 分钟）才能运行的命令提示符命令：

```
subprocess.call([command, param1, param2], cwd=cwdDir) 
```

我想使用 QProgressDialog 来显示该命令正在运行。我这样做了：

```
 progressDialog = QProgressDialog("Executing...", "", 0, 0)
        progressDialog.setCancelButton(None)
        progressBar = QProgressBar(progressDialog)
        progressBar.setMinimum(0)
        progressBar.setMaximum(0)
        progressDialog.setBar(progressBar)
        progressDialog.show()
        subprocess.call([command, param1, param2], cwd=cwdDir)
        progressDialog.close() 
```

当我运行我的程序时，会出现以下内容：

![在此处输入图像描述](../Images/6e09d7021ce2aac1013fe96acc1fed42.png)

过了一会儿，我的命令完成执行，窗口关闭。我如何获得它以便您可以`QProgressBar`在窗口中看到？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T20:44:35.337

您可以使用 Qthread，这样程序的事件循环就不会被阻塞。并通过计时器或从 subprocess.call 读取信息或仅在进程栏中显示忙碌图标来增加进度条的值。

# jquery - jQuery - 边缘顶部未在 chrome 中更新

> ID：11564296
> 
> 赞同：0
> 
> 时间：2012-07-19T15:36:12.823
> 
> 标签：jquery, google-chrome

我试图通过一些简单的数学更新顶部边距来为一些 IMG 元素设置动画。

它是这样的：

```
$('.spd2').css('margin-top', - offsetPC * 12 + '%'); 
```

它适用于这样的 IMG：

```
<img src="img/pgDadosImportantes_i001.png" class="spd1" 
    style="right: 30%; top: 45%; z-index:10;" /> 
```

在 css doc 中设置此样式：

```
.ilustras {
    width: 960px;
    height: 100%;
    position: absolute;
    z-index: 0;
}

.ilustras img {
    position: absolute;
    float: right;
    width: auto; 
    height: auto;
    display: inline-block;
} 
```

它在 Firefox 和 IE 中运行良好。问题是在 chrome 中，margin-top 的值没有被更新。

我尝试了对所有相关元素的一些更改，将属性更改为位置、浮动、宽度、高度、显示......并在 jQuery 中更改了一些命名 marginLeft、margin-left 的方法。

没有任何东西可以与 Chrome 一起使用。如果我应用一个静态数字，它就可以工作。

我这里有一个样本：

[http://unitfour.com.br/HotsiteCluster/](http://unitfour.com.br/HotsiteCluster/)

感谢任何帮助！

*对不起我的英语和我的代码......我是一名巴西设计师，两者都在工作！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T10:46:13.917

尝试类似：

```
$('.spd2').css('margin-top', ((parseInt($('.spd2').css('margin-top')) - offsetPC) * 12) + '%'); 
```

并告诉我们是否可以。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T15:07:40.417

它没有在 Webkit（Chrome / Safari）中显示，因为 - 以一种奇怪的方式 - 他们没有得到`scrollTop();`价值。我已经解决了`window.pageYOffset`用于编写我的变量的问题。希望对其他人有所帮助！谢谢大家的帮助！

# javascript - 在 ASP.NET MVC3 中将多个视图组合在一起

> ID：11564298
> 
> 赞同：0
> 
> 时间：2012-07-19T15:36:38.903
> 
> 标签：javascript, jquery, asp.net-mvc-3, razor

我现在在 ASP.NET MVC3 中设置了一个站点，但是所有内容的布局都针对移动设备进行了优化。

我现在想将一些现有视图组合在一起，以利用桌面浏览器或平板电脑中的额外屏幕空间。

我现在有两个视图，一个显示链接列表，第二个显示每个链接生成的一些内容；这两个视图都由单独的控制器处理。这是列表视图（简化）。它使用一个布局页面，所以这是`@RenderBody()`在布局中调用时会显示的内容（我的第二个视图也可以这样工作，使用相同的布局文件）。

```
@model IEnumerable<CommandCenterEntity>
@{
    if (Request.Browser.IsMobileDevice) {
        Layout = "~/Views/Shared/_LayoutMobileContent.cshtml";
    }
    else {
        Layout = "~/Views/Shared/_LayoutDesktop.cshtml";
    }
}
<ul data-role="listview" id="commandcenterlist" data-filter="true" data-inset="true" data-theme="b">
    @foreach (var entity in Model)
    {
    <li>
        @Html.CommandCenterLinks(@entity, x => Url.Action("Index", "Worksheet", new { ParentId = @entity.ID_Item }))
    </li>
    }
</ul> 
```

CommandCenterLinks 帮助器仅根据实体的某些属性生成包含不同图标的“a”标记。

我想以这样一种方式组合我的视图，当我单击列表中的链接时，该链接将位于屏幕左侧的 div 标签中，生成的内容将显示在右侧的单独 div 标签中。

我希望我可以重用在我的移动布局中使用的相同动作/控制器，所以我尝试使用 jQuery 来拦截列表上的点击事件并捕获从动作返回的数据，并将其注入到 div 中：

```
$(document).on("click", "#commandcenterlist a", function (e) {
    $.mobile.showPageLoadingMsg();        
    $.ajax({
        url: this.href,
        success: function (data) {
            $.mobile.hidePageLoadingMsg();
            $("#desktopContentPane").html(data);
        }
    });
    return false;
}); 
```

但是，我在 ajax 成功处理程序中返回的数据包含完整的 html 页面，

```
<!DOCTYPE html> 
<html> 
    <head>...</head>
    <body>...</body>
</html> 
```

...当我想要的只是布局`@RenderBody()`调用中生成的内容时。我尝试将控制器方法更改为 have `return PartialView("Index");`，但它给出了相同的结果。有没有办法让我只取回那部分视图？还是有一些更清洁、更“MVC”的方式来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:05:17.197

最好的选择实际上是从单独的控制器操作中返回您的部分视图。所以，我会改变一些事情来让它工作：

1.  获取您要共享的内容（无论您想在桌面的 div 中显示什么）并将其放在局部视图中。
2.  创建一个仅返回此局部视图的控制器操作（使用[PartialView](http://msdn.microsoft.com/en-us/library/dd470145.aspx)方法并传入您的局部视图名称），并在桌面版本中从您的 javascript 调用它。
3.  在移动版本的视图中，您可以使用[RenderPartial](http://msdn.microsoft.com/en-us/library/system.web.mvc.html.renderpartialextensions.renderpartial.aspx)方法将部分视图中的内容包含在移动页面中。

# sql - 如何使用 group by 而不是使用循环将其重写为 select 语句

> ID：11564307
> 
> 赞同：1
> 
> 时间：2012-07-19T15:37:01.980
> 
> 标签：sql, sql-server

当我对 SQL (MSSQL) 还很陌生时，我正在重新审视我为报告编写的一些旧代码。它做了它应该做的事情，但它不是最漂亮或最有效的。

下面的虚拟代码模仿了我目前所拥有的。在这里，我试图计算过去 5 周内未平仓合约的数量。对于此示例，如果合同的开始日期发生在给定周之前或之后，并且结束日期发生在给定周期间或之后，则合同被认为是未结的。

dbo.GetWeekStart(@Date DATETIME, @NumOfWeeks INT, @FirstDayOfWeek CHAR(3)) 是一个函数，它将根据为指定周数提供的日期返回每周的第一天。即 SELECT * FROM dbo.GetWeekStart('20120719', -2, 'MON') 将返回 2012 年 7 月 19 日之前的 2 个星期一。

我怎样才能简化这个？我认为有人可以在没有循环的情况下执行此操作，但我无法弄清楚。

```
DECLARE @RunDate DATETIME,
    @Index INT,
    @RowCount INT,
    @WeekStart DATETIME,
    @WeekEnd DATETIME

DECLARE @Weeks TABLE
(
    WeekNum INT IDENTITY(0,1),
    WeekStart DATETIME,
    WeekEnd DATETIME
)

DECLARE @Output TABLE
(
    WeekStart DATETIME,
    OpenContractCount INT
)

SET @RunDate = GETDATE()

INSERT INTO @Weeks (WeekStart, WeekEnd)
SELECT WeekStart,
DATEADD(ss,-1,DATEADD(ww,1,WeekStart))
FROM dbo.[GetWeekStart](@RunDate, -5, 'MON') 

SET @RowCount = (SELECT COUNT(*) FROM @Weeks)
SET @Index = 0

WHILE @Index < @RowCount
BEGIN
    SET @WeekStart = (SELECT WeekStart FROM @Weeks WHERE WeekNum = @Idx)
    SET @WeekEnd = (SELECT WeekEnd FROM @Weeks WHERE WeekNum = @Idx)

    INSERT INTO @Output (WeekStart, OpenContractCount)
    SELECT @WeekStart,
    COUNT(*)
    FROM Contracts c
    WHERE c.StartDate <= @WeekEnd
    AND ISNULL(c.EndDate, GETDATE()) >= @WeekStart

    SET @Index = @Index + 1
END
SELECT * FROM @Output 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:59:30.433

这样做很快，但它应该工作

```
/*CTE generates Start & End Dates for 5 weeks
Start Date = Sunday of week @ midnight
End Date = Sunday of next week @ midnight
*/
WITH    weeks
      AS ( SELECT   DATEADD(ww, -4,
                            CAST(FLOOR(CAST(GETDATE() - ( DATEPART(dw,
                                                          GETDATE()) - 1 ) AS FLOAT)) AS DATETIME)) AS StartDate
           UNION ALL
           SELECT   DATEADD(wk, 1, StartDate)
           FROM     weeks
           WHERE    DATEADD(wk, 1, StartDate) <= GETDATE()
         )
SELECT  w.StartDate ,
        COUNT(*) AS OpenContracts
FROM    dbo.Contracts c
        LEFT   JOIN weeks w ON c.StartDate < DATEADD(d, 7, w.StartDate)
                               AND ISNULL(c.EndDate, GETDATE()) >= w.StartDate
GROUP BY w.StartDate 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T16:58:23.540

我看不出为什么这不起作用：

```
DECLARE @RunDate DATETIME = GETDATE()

SELECT  WeekStart, COUNT(*)
FROM    Contracts c
        INNER JOIN dbo.[GetWeekStart](@RunDate, -5, 'MON') 
            ON c.StartDate < DATEADD(WEEK, 1, WeekStart)
            AND (c.EndDate IS NULL OR c.EndDate >= @WeekStart)
GROUP BY WeekStart 
```

我不确定您是如何在函数中生成日期的，以防万一您使用循环/递归 CTE，我将包含一个不使用循环/游标等的查询。

```
DECLARE @RunDate DATETIME = GETDATE()

-- SET DATEFIRST AS 1 TO ENSURE MONDAY IS THE FIRST DAY OF THE WEEK
-- CHANGE THIS TO SIMULATE CHANGING YOUR WEEKDAY INPUT TO db
SET DATEFIRST 1 

-- SET RUN DATE TO BE THE START OF THE WEEK
SET @RunDate = CAST(DATEADD(DAY, 1 - DATEPART(WEEKDAY, @RunDate), @RunDate) AS DATE)

;WITH Weeks AS
(   SELECT  TOP 5 -- CHANGE THIS TO CHANGE THE WEEKS TO RUN
            DATEADD(WEEK, 1 - ROW_NUMBER() OVER(ORDER BY Object_ID), @RunDate) [WeekStart]
    FROM    sys.All_Objects
)
SELECT  WeekStart, COUNT(*)
FROM    Contracts c
        INNER JOIN Weeks
            ON c.StartDate < DATEADD(WEEK, 1, WeekStart)
            AND (c.EndDate IS NULL OR c.EndDate >= @WeekStart)
GROUP BY WeekStart 
```

# algorithm - 递增计算图中的桥梁

> ID：11564309
> 
> 赞同：1
> 
> 时间：2012-07-19T15:37:03.837
> 
> 标签：algorithm, graph

我试图解决在线法官的问题。给定一个有 n 个顶点（<=50000）的无向图，最初没有边，然后给定 m 个边（<100000），并且我们被要求在每次添加后输出[桥的数量。](http://en.wikipedia.org/wiki/Bridge_%28graph_theory%29)时间限制为2s。我知道在 O(N + M) 中运行的桥梁查找算法，并且我的直接 O(M*(N+M)) 可以预见地超时。有人可以帮我一个合适的算法吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:55:23.730

岛屿是节点的集合，因此您可以从一个节点穿越到另一个节点而无需跨越任何桥梁。未连接到任何其他节点的单个节点是一个孤岛。

岛链是由桥梁连接的一系列岛屿。岛链是无环的；如果您通过一座桥离开岛屿，则只能通过同一座桥返回该岛。请注意，这与说组成岛链的节点集合是非循环的不同；个别岛屿可能包含循环。

在向图添加边时，请遵循以下规则来跟踪您的链、岛和桥：

1.  如果添加了一条新边将一个岛连接到自身，则该边不是桥。桥梁总数保持不变。

2.  如果两个岛不是同一个岛链的一部分，并且添加了一条连接它们的新边，那么这条边就变成了一座桥，两个岛链合并成一个岛链。

3.  如果两个岛是岛链的一部分，并且添加了一条连接它们的新边，则必须合并一些岛以维护无环属性。找到通过连接两个岛屿的岛链的路径。以这种方式穿越的所有岛屿，包括两端的两个岛屿，将它们全部合并为一个岛屿。你以这种方式穿越的任何桥梁都不再成为桥梁。

通过这些步骤，您可以在向图中添加边时计算图中的桥梁数量。从未连接节点的图表开始。每个节点是一个岛链，其中包含一个岛，其中包含一个节点。添加边时，请参考上述三个规则，根据需要合并岛和岛链。

一个岛可以表示为一组节点，一个岛链可以表示为一个无向无环岛图。该算法最昂贵的部分是找到两个现有岛屿之间的路径；直观地说，我猜一个链中的岛屿数量相对于 将保持较小`n`，因此总复杂度将保持接近 O(m) 时间。

# sql - SQL to Entity Framework Count Group-By

> ID：11564311
> 
> 赞同：110
> 
> 时间：2012-07-19T15:37:07.940
> 
> 标签：sql, entity-framework, linq-to-entities, count, group-by

我需要将此`SQL`语句转换为`Linq-Entity`查询...

```
SELECT name, count(name) FROM people
GROUP by name 
```

* * *

## 回答 #1

> 赞同：208
> 
> 时间：2012-07-19T15:43:31.103

**查询语法**

```
var query = from p in context.People
            group p by p.name into g
            select new
            {
              name = g.Key,
              count = g.Count()
            }; 
```

**方法语法**

```
var query = context.People
                   .GroupBy(p => p.name)
                   .Select(g => new { name = g.Key, count = g.Count() }); 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2016-05-25T19:36:06.417

### 编辑：EF Core 2.1 终于支持[GroupBy](https://docs.microsoft.com/en-us/ef/core/what-is-new/ef-core-2.1#linq-groupby-translation)

但始终在控制台/日志中查找消息。如果您看到一条通知，说明您的查询无法转换为 SQL 并将在本地进行评估，那么您可能需要重写它。

* * *

**Entity Framework 7**（现在重命名为**Entity Framework Core 1.0 / 2.0**）尚不支持在生成的 SQL 中`GroupBy()`的转换`GROUP BY`（即使在最终的 1.0 版本中也不支持）。任何分组逻辑都将在客户端运行，这可能会导致加载大量数据。

最终，像这样编写的代码将自动开始使用 GROUP BY，但现在您需要非常小心，如果将整个未分组的数据集加载到内存中会导致性能问题。

对于破坏交易的场景，您将不得不手动编写 SQL 并通过 EF 执行它。

如果有疑问，请启动 Sql Profiler 并查看生成的内容 - 无论如何您可能都应该这样做。

[https://blogs.msdn.microsoft.com/dotnet/2016/05/16/announcing-entity-framework-core-rc2](https://blogs.msdn.microsoft.com/dotnet/2016/05/16/announcing-entity-framework-core-rc2)

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2014-07-15T16:06:51.573

一个有用的扩展是收集结果以`Dictionary`进行快速查找（例如在循环中）：

```
var resultDict = _dbContext.Projects
    .Where(p => p.Status == ProjectStatus.Active)
    .GroupBy(f => f.Country)
    .Select(g => new { country = g.Key, count = g.Count() })
    .ToDictionary(k => k.country, i => i.count); 
```

最初在这里找到： [http ://www.snippetsource.net/Snippet/140/groupby-and-count-with-ef-in-c](http://www.snippetsource.net/Snippet/140/groupby-and-count-with-ef-in-c)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-01-26T13:06:28.147

这是 .net core 2.1 中 group by 的一个简单示例

```
var query = this.DbContext.Notifications.
            Where(n=> n.Sent == false).
            GroupBy(n => new { n.AppUserId })
            .Select(g => new { AppUserId = g.Key, Count =  g.Count() });

var query2 = from n in this.DbContext.Notifications
            where n.Sent == false
            group n by n.AppUserId into g
            select new { id = g.Key,  Count = g.Count()}; 
```

翻译为：

```
SELECT [n].[AppUserId], COUNT(*) AS [Count]
FROM [Notifications] AS [n]
WHERE [n].[Sent] = 0
GROUP BY [n].[AppUserId] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-04-27T05:19:59.497

使用 EF 6.2 它对我有用

```
 var query = context.People
               .GroupBy(p => new {p.name})
               .Select(g => new { name = g.Key.name, count = g.Count() }); 
```

# android - 使用 PowerManager.ON_AFTER_RELEASE wakeLock 自动唤醒屏幕

> ID：11564314
> 
> 赞同：0
> 
> 时间：2012-07-19T15:37:10.640
> 
> 标签：android

在以下示例活动中，屏幕会在用户关闭屏幕后立即自动唤醒（使用电源按钮），但前提是我使用了`PowerManager.ON_AFTER_RELEASE`标志。如果我不使用这个标志，它就不会发生。

```
public class TestActivity extends Activity {

    private WakeLock wakeLock;

    @Override
    protected void onResume() {
        super.onResume();

        wakeLock = ((PowerManager) getSystemService(Context.POWER_SERVICE)).newWakeLock(PowerManager.SCREEN_DIM_WAKE_LOCK | PowerManager.ON_AFTER_RELEASE, "test");
        wakeLock.acquire();
    }

    @Override
    protected void onPause() {
        wakeLock.release();
        super.onPause();
    }

} 
```

有没有办法在仍然使用`PowerManager.ON_AFTER_RELEASE`标志的同时避免这种行为？

使用 MediaPlayer 的方法时我遇到了同样的问题`setWakeMode()`（我检查了源代码，它也使用了这个`PowerManager.ON_AFTER_RELEASE`标志）

或者，也许我只是误解了这面旗帜的用途……那它是做什么用的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:57:32.540

[WindowManager.LayoutParams](http://developer.android.com/reference/android/view/WindowManager.LayoutParams.html#FLAG_TURN_SCREEN_ON)类有一个标志`FLAG_TURN_SCREEN_ON`. 它记录如下：

> 窗口标志：当设置为窗口正在添加或可见时，一旦窗口显示，系统将戳电源管理器的用户活动（就像用户已唤醒设备）以打开屏幕。

尝试清除你的这个标志`onResume`：

```
getWindow().clearFlags( WindowManager.LayoutParams.FLAG_TURN_SCREEN_ON ); 
```

并查看按下电源按钮后是否会使屏幕保持黑暗。您也可以尝试使用该标志`onPause`。只是一个猜测。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T07:32:53.453

好的，经过多次实验，使用 this 时似乎没有办法避免这种自动屏幕唤醒`PowerManager.ON_AFTER_RELEASE`。

因此，`MediaPlayer.setWakeMode()`如果没有这个问题，就无法使用。

# mysql - 无法启动 mysql 守护程序：缺少 mysql.sock

> ID：11564315
> 
> 赞同：0
> 
> 时间：2012-07-19T15:37:13.947
> 
> 标签：mysql, mysql.sock

```
service mysqld start 
```

> mysql ERROR 2002 (HY000): Can't connect to local MySQL server through socket '/var/lib/mysql/mysql.sock' (2)

任何人都可以帮我解决这个错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:46:05.943

检查 my.cnf 文件（对于 MySQL - /etc/my.cnf 或 /etc/mysql/my.cnf） - 使用主题标签 (#basedir=/var/lib) 注释掉 basedir 标志并重新启动服务器。

# iis - 其他 exe 运行时应用程序池卡住

> ID：11564316
> 
> 赞同：0
> 
> 时间：2012-07-19T15:37:15.313
> 
> 标签：iis, asp-classic, wkhtmltopdf

我在带有隔离应用程序池 (ApplicationPoolIdentity) 的经典 ASP 中使用 IIS 7.5 运行网站。在这个网站内，我还通过“WScript.Shell”对象运行方法运行非托管代码（wkhtmltopdf.exe）。之后，我将结果文件流式传输为 pdf

```
set wshell = CreateObject("WScript.Shell") 
wshell.run wkhtmltopdf.exe  http://www.mypagehanging.com c:\myfile.pdf", 0, TRUE 
set wshell = nothing 
```

一切正常，但有时我的网站挂起。它完全卡住了。以应用程序池 (iis apppool\myapp) 身份运行的 wktmltopdf.exe 挂起。

这会导致我的所有网站挂起，因为我使用选项 bWaitOnReturn 运行程序为 true。

我无法将此选项设置为 false，因为在流式传输 pdf 之前，我必须等待脚本完全执行。

找不到任何可提供给 wkhtmltopdf 的超时选项。无法理解为什么 wkhtmltopdf 挂起。但这可能是由我尝试渲染的网站而不是 wkhtmltopdf 引起的。

有什么建议么 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T09:43:55.000

如果运行时间异常长，我已经通过终止进程来解决这个问题。

这是我的代码应该对某人有帮助。

在asp文件中

```
'Run this programm that will kill pdf generation if it hangs-execute for more than 10seconds
wshell.run "KillProcess.exe -p wkhtmltopdf -t 10000",0,FALSE 
'Launch pdf generation with bwaitonreturn true 
wshell.run wkhtmltopdf.exe  http://www.mypagehanging.com  c:\inetpub\wwwroot\myfile.pdf", 0, TRUE 

'Stream the pdf ... 
```

KillProcess.exe 的代码源

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading;
using System.Diagnostics;
using CommandLine; //http://commandline.codeplex.com
using CommandLine.Text; //http://commandline.codeplex.com

namespace KillProcess
{
    class Program
    {
        static void Main(string[] args)
        {
            var options = new Options();
            ICommandLineParser parser = new CommandLineParser();

            if (parser.ParseArguments(args, options))
            {
                double maxWaitTime = options.time; //ms
                string processName = options.process;
                bool exit;
                do
                {
                    exit = true;
                    foreach (Process p in GetProcesses(processName))
                    {
                        exit = false;
                        try
                        {
                            if (p.StartTime.AddMilliseconds(maxWaitTime) < DateTime.Now)
                            {
                                p.Kill();
                                Console.WriteLine("Killed Process: {0} ID: {1} started at {2} after {3}ms of execution time", p.ProcessName, p.Id, p.StartTime, options.time);
                            }
                        }
                        catch (Exception e)
                        {
                            Console.WriteLine(e.Message);
                        }
                    }
                    Thread.Sleep(100);
                } while (!exit);
                return;
            }
            else
            {
                Console.WriteLine(options.GetUsage());
                return;
            }
        }

        static IEnumerable<Process> GetProcesses(string processName)
        {
            var processes = from p in Process.GetProcesses()
                            where p.ProcessName == processName
                            orderby p.ProcessName
                            select p;
            return processes;
        }

        class Options : CommandLineOptionsBase
        {
            [Option("p", "process", Required = true, HelpText = "Name of the process-es to kill after some execution time (Warning ! This will kill all the processes that match the name !)")]
            public string process { get; set; }

            [Option("t", "time", Required = true, HelpText = "Maximum execution time allowed for the process to run. If the process has run for more than this amount of time it will be killed")]
            public int time { get; set; }

            [HelpOption]
            public string GetUsage()
            {
                return HelpText.AutoBuild(this, (HelpText current) => HelpText.DefaultParsingErrorsHandler(this, current));
            }
        }
    }
} 
```

# excel - Excel 2010 打开 SharePoint 文件的行为不同于两台客户端 PC

> ID：11564318
> 
> 赞同：1
> 
> 时间：2012-07-19T15:37:18.440
> 
> 标签：excel, sharepoint

有两台客户端 PC。PC1 仅安装了 Office 2010，PC2 安装了多个 Office，但默认安装的是 Office 2010。

打开 SharePOint Excel 文件时，两台电脑的行为异常。没有从 SharePoint 签出任何文件，也没有人试图同时访问同一个文件。PC1 从 SharePOint 打开 Excel 文件是只读的（文件-> 版本控制下没有签出按钮）。PC2 从 SharePOint 打开 Excel 文件可以编辑（File-> versioning 下确实有 Check out 按钮，可以添加新行并直接保存）。

是什么原因导致不同 PC 上的签出按钮显示不同，即使共享点中的文件处于相同状态？

在此处添加注释：我认为这与第一台 PC 完全相关。第一次（仅第一次/第二次可以编辑）从客户端应用程序端打开 Excel 文件有问题。我检查了 Content.MSO 并确实看到了正确创建和删除的所有文件，因此这不是 Content.MSO 问题。

谢谢，YK

# c++ - 在 Qt 项目中使用 STXXL

> ID：11564320
> 
> 赞同：3
> 
> 时间：2012-07-19T15:37:22.557
> 
> 标签：c++, qt, makefile, qmake, stxxl

如何让 qmake 将 stxxl.mk 文件包含到生成的 makefile 中？

我有一个 Qt 项目，它处理大文件（> RAM），因此想使用 STXXL。STXXL[文档](http://algo2.iti.kit.edu/stxxl/tags/1.3.1/installation_linux_gcc.html)说：

> 构建应用程序
> 
> 编译库后，一些 Makefile 变量将写入您的 STXXL_ROOT 目录中的 stxxl.mk [...]。该文件应包含在您的应用程序的 Makefile 中。

当然，我可以手动编辑 makefile 以添加该行`include /path/to/stxxl.mk`，但是每次 .pro 文件都这样做非常乏味，因此 makefile 发生更改。

我已经在 .pro 文件中使用 qmake 命令搜索了一些解决方案，但无济于事。在一个[论坛](http://www.qtcentre.org/threads/21131-qmake-Generate-Makefile-with-include-(ORACLE_HOME)-precomp-env_precomp-mk?p=103565#post103565)中，他们建议编辑 qmake 源并重新编译它，但如果程序将分发给其他人，他们的 qmake 中没有这个“修复”，这是没有选择的。

也许我想复杂并且有一个简单的解决方案。我希望这里有一些人在使用这种组合（Qt + STXXL）时确实解决了这个问题。

**注意** 这个问题[Prepend/Append Makefile to a Qt generated Makefile](https://stackoverflow.com/questions/1255454/prepend-append-makefile-to-a-qt-generated-makefile)要求完全相同，但解决方案不适合我的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T13:02:38.960

现在我已经解决了以下解决方案：

由于 stxxl.mk 文件包含“有效的 qmake 代码”（它分配给变量），我使用 include(stxxl.mk) 导入这些变量。所以我生成的项目文件包含：

```
include(/path/to/stxxl.mk)
QMAKE_CXXFLAGS += $$STXXL_CPPFLAGS_STXXL
LIBS += $$STXXL_LDLIBS_STXXL 
```

这些是文档中使用的 stxxl.mk 的唯一变量，所以我使用了它们并且它有效。

# wordpress - 自定义帖子类型和模板层次结构

> ID：11564328
> 
> 赞同：0
> 
> 时间：2012-07-19T15:37:46.260
> 
> 标签：wordpress

在以下开发网站上，我为“文章”设置了自定义帖子类型。帖子类型名称是“zu_articles”，而 slug 是“articles”。一切都在仪表板中工作，我能够生成文章列表。但是当您单击文章链接时，它会转到 404。根据我对 WP 模板层次结构的理解，我创建了以下页面：single-zu_articles.php。如果它是基于 slug 的，我也有 single-aricles.php 并且它也不起作用。

[http://zimmernutrition.com.s137737.gridserver.com/](http://zimmernutrition.com.s137737.gridserver.com/)

右侧的内容滑块下方有一个“最新文章”小部件，可以查看所有内容。

我究竟做错了什么？

谢谢

布雷特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T02:12:48.383

好吧，你不会相信这一点......在 StackOverflow 上做了更多的搜索并找到了这篇文章：

[Wordpress——带有自定义帖子类型的永久链接](https://stackoverflow.com/questions/5486560/wordpress-permalink-with-custom-post-types)

我所要做的就是在仪表板中重新保存我现有的永久链接。

谢谢你和我在一起。我明白了为什么必须这样做以及为什么要修复它。

# html - IE8 在锚点的上下文菜单中不显示在新选项卡或窗口中打开

> ID：11564329
> 
> 赞同：2
> 
> 时间：2012-07-19T15:37:52.837
> 
> 标签：html, internet-explorer, internet-explorer-8, contextmenu, openinfowindowhtml

好吧，我有一个菜单，其结构类似于

```
<ul id="principal_menu">
   <li><a href="example.com"> menu 1</a> </li>
   <li><a href="example.com"> menu 2</a> </li>
</ul> 
```

...页面中还有其他链接，例如

```
<a id="works">this link shows the open in new tab or window</a> 
```

#principal_menu 中的链接在右键单击时不会显示在新选项卡或窗口中打开，但 #works 会显示，它们都是

建议？

谢谢

# android - Android 应用程序命名约定 - 这真的很重要吗？

> ID：11564333
> 
> 赞同：0
> 
> 时间：2012-07-19T15:37:58.277
> 
> 标签：android, google-play

Andorid 应用程序可以具有相同的名称 - 公共名称.. 或者他们需要有不同的名称..

我想确保如果我创建一个应用程序并在 google play 上发布......其他人不会复制该应用程序并以相同的名称将其托管在其他地方..

请告知应用程序是否可以具有相同的公共名称..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T13:33:28.837

您的问题是关于具有相同名称的应用程序，但您真正关心的是应用程序被盗。这是两个不同的问题。

如果有人直接复制了您的 APK 并试图将其发布到 Google Play，那么如果您自己已经将相同的 APK 发布到 Google Play，他们将无法这样做。然而，他们将被阻止发布它的原因是它的包名称与现有应用程序相同，而不是因为它的名称。

一个更老练的小偷可能会更改您的包名称，如果他们可以这样做，那么他们也可能（甚至更容易）更改您的应用程序的名称。在这种情况下，他们或许能够将生成的应用程序发布到 Google Play。然后，您可能会决定向 Google 投诉并要求删除侵权应用程序。此类投诉有一个表格：

[http://support.google.com/googleplay/bin/request.py?contact_type=takedown](http://support.google.com/googleplay/bin/request.py?contact_type=takedown)

我不知道你会从这样的投诉中得到什么样的结果，但谷歌最近更加专注于防止此类侵权应用程序，所以你可能会得到很好的回应。

如果您谈论的是 Google Play*之外*的其他应用商店，那么您必须查看这些商店的政策。但可以肯定的是，只要符合其他商店的政策，已经发布在 Google Play 上的应用程序可以发布到这些其他商店中，这是毫无疑问的。开发人员一直在自己做这件事（在多个应用商店上发布）。当然，它可以具有相同的名称和相同的包。

关于 Google Play 上的两个应用程序是否可以具有相同名称的更普遍的问题：

过去，两个应用程序在 Google Play 上可能具有相同的名称。

但是，在 2012 年 8 月（自从您发布了您的问题），Google 宣布了新的开发者计划政策，其中声明：

“应用程序的名称或图标不得与现有产品或设备随附的应用程序（如相机、图库或消息）相似，容易混淆。”

完整的政策可以在这里找到：

[http://play.google.com/about/developer-content-policy.html](http://play.google.com/about/developer-content-policy.html)

仍然可以发布与现有应用程序同名的应用程序，但如果有人这样做，至少有一些机会谷歌的（在设计上有点难以理解）自动检测过程会出于上述原因标记该应用程序. 这可能会导致来自谷歌的一封信，如果应用程序的名称没有更改，最终会被删除。

这些政策相对较新，可能没有人，甚至是谷歌，确切*地*知道它们将如何发挥作用。例如，Google 将如何解析已经具有相似名称的应用程序？它会与第一个使用该名称的应用程序一起使用，还是与最流行的具有该名称的应用程序一起使用，或者它会要求应用程序所有者协商解决方案，还是只是允许模糊名称被祖传？我当然不知道答案，但对于新的应用程序，诚然，诚实的开发者会避免以与您的应用程序类似的方式命名他们的应用程序，并且使用相同名称的作弊者很可能会从 Google 那里听到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T15:44:29.590

您的软件包名称必须是唯一的（例如`com.example.mail.free`）才能在 Google Play 上发布应用。

我几乎可以肯定这个名字并不重要。您可以在不同的语言上有不同的名称。

# java - 如何定义 swig 类型映射以将 unsigned char* 返回到 java

> ID：11564334
> 
> 赞同：2
> 
> 时间：2012-07-19T15:38:00.247
> 
> 标签：java, java-native-interface, bytearray, swig, unsigned-char

我有一个 Java 应用程序，它调用 ac 库来执行加密功能。这是一个用 c 实现的自定义库，我们需要从一些 Java 程序中使用它。我需要一种方法来定义一个 SWIG 类型映射，它允许我调用一个从 Java 传递 bytearray 的函数，并将其视为 C 函数中的无符号字符指针，其中 c 函数填充数据并将其返回给 java

我目前不满意的接口文件摘录如下

```
%module  CryptoFacade

%pointer_functions(int, intp);
%pointer_functions(unsigned char, unsigned_charp);

int enCrypt(char* clearText, int clearLen,unsigned char* retCipherText, int *retCipherLen); 
```

* * *

我不满意的Java代码摘录如下。在下面的代码中，我预计对 enCrypt 函数的调用会给我一个缓冲区，但根据生成的代码，它会给我一个“短”。（见代码中的注释）

* * *

```
class MainLoader {
static {
     System.loadLibrary("dccasecuJ"); //Load my crypto library
}

 public static void main(String[] args) {

 // Define the parameters to be passed by reference 
 SWIGTYPE_p_int retCipherLen=CryptoFacade.new_intp();
 SWIGTYPE_p_unsigned_char retCipherText =
            CryptoFacade.new_unsigned_charp();

CryptoFacade myFacade=new CryptoFacade();   

// Call crypto library function. First two are value parameters, next two are return
myFacade.enCrypt("STRING-TO-ENCRYPT", 17, retCipherText, retCipherLen);

// The length I get back in fourth parameter is just fine 
int gotLen= CryptoFacade.intp_value(retCipherLen); 

//The value I get for the Ciphertext though is a "short" ... no good 
// I need a byte[] in java that has the ciphertext
short gotText= CryptoFacade.unsigned_charp_value(retCipherText); 
```

我想我应该将我的接口定义更改为如下所示，我将第三个参数设为 jbytearray，然后我必须实现一个类型映射，它将 C 程序中无符号字符指针指向的内容复制到 java bytearray。

如果我必须将内容的长度指定为 256 字节，那我很好，因为处理任意长度可能会很棘手。

有人能指出我可以找到这样一个类型图的地方吗（我是 SWIG 的新手，没有编写类型图的经验）

```
%module  CryptoFacade

%pointer_functions(int, intp);
%pointer_functions(unsigned char, unsigned_charp);

int enCrypt(char* clearText, int clearLen, jbyteArray retCipherText, int *retCipherLen); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T17:47:27.073

在 Java 中处理字节数组的最简单方法是使用`%array_class`(or `%array_functions`)，这类似于`%pointer_functions`但用于整个数组，而不仅仅是单个元素。我为你整理了一个完整的例子，使用这个头文件作为测试：

```
inline void foo(unsigned char *bytearr) {
  bytearr[0] = 1;
  bytearr[1] = 2;
  bytearr[2] = 3;
  bytearr[3] = 100;
} 
```

我们可以用 SWIG 包装它：

```
%module test

%{
#include "test.h"
%}

%include <carrays.i>
%array_class(unsigned char,ByteArr);

%include "test.h"

// Emit Java code to automatically load the shared library
%pragma(java) jniclasscode=%{
  static {
    try {
        System.loadLibrary("test");
    } catch (UnsatisfiedLinkError e) {
      System.err.println("Native code library failed to load. \n" + e);
      System.exit(1);
    }
  }
%} 
```

我还整理了一些 Java 来练习这个功能：

```
public class run {
  public static void main(String[] argv) {
    ByteArr arr = new ByteArr(4); // Initial size 4
    // You could set some values before passing in if you wanted to.
    test.foo(arr.cast());
    System.out.println(arr.getitem(0) + ", " + arr.getitem(1) + ", " + arr.getitem(2) + ", " + arr.getitem(3));
  }
} 
```

编译并运行。请注意，`unsigned char`在 C 或 C++ 中，Java 中表示为`short`- Java 没有任何无符号类型，因此适合 0-255 范围的最小类型是短类型。`byte`默认情况下不覆盖它。`unsigned char`（您可以以其他方式玩游戏重新映射，`byte`但这远非直观，因此默认情况下不这样做）。

如果你愿意，你可以做更高级的事情。例如[，如果您知道可以使用的数组的大小`arrays_java.i`](https://stackoverflow.com/a/8319894/168175)。[此示例](https://stackoverflow.com/questions/9934059/swig-technique-to-wrap-unsigned-binary-data/9979340#9979340)使用 JNI 创建类型映射以返回`unsigned char`. [此示例](https://stackoverflow.com/a/10949956/168175)显示如何使用 JNI 类型映射将数组传递给函数。（它使用`long`而不是`byte`，但它实际上是一个搜索和替换来改变它）。

# c - 指向结构的指针数组

> ID：11564336
> 
> 赞同：4
> 
> 时间：2012-07-19T15:38:06.590
> 
> 标签：c, structure

我试图了解我的代码是否正确。我需要声明一个指向结构的指针数组，创建一个新结构并分配值并打印它们。在我看来，我没有正确声明指针数组。我需要知道我做错了什么。谢谢我得到这个编译错误：错误：'people' undeclared (first use in this function) And I've try to insert struct data *list; 进入 main 但它不起作用

```
 char *book[] = { "x", "y", "z",};
     int number[] = { 1, 2, 3};

     struct data = { char *bookname; int booknumber;};

     function(char *x, int y)
     {
       static int count;

       struct data *list[3];

       //creating a new struct 
       list[count] = (struct data*) malloc( sizeof(struct data) );

       //assigning arguments
       list->bookname = x;
       list->booknumber = y;

       count++;
     }

     int main()
     {
       struct data *list[3];

       int i;
       for(i = 0; i < 3; i++)
       {
         function(book[i], number[i]);

         printf("name: %c number: %d", list[i]->bookname, list[i]->booknumber);
       } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T15:41:16.003

既然你想要数组，你需要*声明*数组：

```
char *book[] = { "x", "y", "z",};
int number[] = { 1, 2, 3}; 
```

* * *

另一个问题是

```
list = (struct data*) malloc( sizeof(struct data) );

//assigning arguments
list[count]->bookname = ... 
```

在这里，`list`总是只有一个元素。因此，如果`count`不是`0`，您将访问一个超出范围的数组！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T15:57:27.870

请更改以下代码

```
 // declaring array of pointers to structs //         
     struct data *list;         
    //not compiling        
    //struct data *list[3]; ---> There is no problem with this statement.        
   //creating a new struct         
   list = (struct data*) malloc( sizeof(struct data) );  ---> //This statement should compilation error due to declaration of struct data *list[3] 
```

到

```
struct data *list[100]; //Declare a array of pointer to structures  
//allocate memory for each element in the array
list[count] = (struct data*) malloc( sizeof(struct data) ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T15:42:04.800

我认为你应该写：

```
char *book[] = { "x", "y", "z"}; 
```

因为在您的情况下，您声明了一个字符数组并用指针填充它，这实际上没有任何意义。

在上面的代码行中，它只是意味着“声明一个指针数组”。

希望它有所帮助...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T15:56:38.117

这些是您的程序中的错误

```
struct data = { char *bookname; int booknumber;}; 
```

“=”不应该在那里

```
list = (struct data*) malloc( sizeof(struct data) );
list[count]->bookname = x;
list[count]->booknumber = y; 
```

在这里你为单个列表创建空间，所以你不能做 list[count]-> bookname，它应该是 list->bookname。与 booknumber 相同，
并且 list 是本地功能，您无法在 main 中访问它。

# jira - 如何链接到 Jira JQL 查询的结果？

> ID：11564340
> 
> 赞同：1
> 
> 时间：2012-07-19T15:38:25.220
> 
> 标签：jira, jql

Jira 的 JQL 中有没有办法直接链接到 jql 查询的结果？我不介意链接是否又长又讨厌（我的一些 jql 查询本身就是），但我希望能够构建如下所示的内容：

```
https://myJiraHost/jira/secure/jqlQuery?query=myEncodedJQLQuery 
```

因此，我可以通过电子邮件发送此链接，让任何可以登录 Jira 的人一键查看此查询的结果。如果这不可用，有谁知道 Attlasian 是否正在做类似的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T19:38:48.950

问题导航器上的永久链接功能会起作用吗？[https://confluence.atlassian.com/display/JIRA/Using+the+Issue+Navigator](https://confluence.atlassian.com/display/JIRA/Using+the+Issue+Navigator)

# matlab - Matlab：向量矩阵的行列式

> ID：11564341
> 
> 赞同：3
> 
> 时间：2012-07-19T15:38:30.323
> 
> 标签：matlab, matrix, determinants

我有一个 2x2 矩阵，它的每个元素都是一个 1x5 向量。像这样的东西：

```
x = 1:5;
A = [ x  x.^2; x.^2 x]; 
```

现在我想找到行列式，但这发生了

```
B = det(A);
Error using det
Matrix must be square. 
```

现在我明白为什么会发生这种情况了，MATLAB 将 A 视为 2x10 的双精度矩阵。我希望能够将 x 视为一个元素，而不是一个向量。我想要的是`det(A) = x^2 - x^4`，然后得到`B = det(A)`一个 1x5 向量。

我如何实现这一目标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T17:00:09.577

While Matlab has symbolic facilities, they aren't great. Instead, you really want to vectorize your operation. This can be done in a loop, or you can use [`ARRAYFUN`](http://www.mathworks.com/help/techdoc/ref/arrayfun.html) for the job. It sounds like `ARRAYFUN` would probably be easier for your problem.

The `ARRAYFUN` approach:

```
x = 1:5;
detFunc = @(x) det([ x x^2 ; x^2 x ]);

xDet = arrayfun(detFunc, x) 
```

Which produces:

```
>> xDet = arrayfun(detFunc, x)
xDet =
     0   -12   -72  -240  -600 
```

For a more complex determinant, like your 4x4 case, I would create a separate M-file for the actual function (instead of an anonymous function as I did above), and pass it to `ARRAYFUN` using a function handle:

```
xDet = arrayfun(@mFileFunc, x); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T15:44:42.147

从数学上讲，[行列式](http://en.wikipedia.org/wiki/Determinant)仅针对方阵定义。因此，除非您可以提供方阵，否则您将无法使用行列式。

*注意*我知道维基百科并不是所有资源。我只是提供它，因为我不能轻易地从我的大学微积分书中提供打印件。

更新：可能的解决方案？

```
x = zeros(2,2,5);
x(1,1,:) = 1:5;
x(1,2,:) = 5:-1:1;
x(2,1,:) = 5:-1:1;
x(2,2,:) = 1:5;

for(n=1:5)
    B(n) = det(x(:,:,n));
end 
```

像这样的东西会起作用吗，或者您是否希望同时考虑每个向量？这种方法将每个“层”视为它自己的，但我有一个偷偷摸摸的怀疑，你想得到一个单一的值作为结果。

# android - DataBaseHelper，是否单例？

> ID：11564348
> 
> 赞同：2
> 
> 时间：2012-07-19T15:38:56.323
> 
> 标签：android, ormlite

关于这个主题有几个问题，但没有给出明确的理由说明为什么应该或不应该有一个或多个 databaseHelper 实例。什么时候拥有多个 DatabaseHelper 实例是个好主意，什么时候不是。较低的复杂性（如果确实如此的话）是否足以成为只有一个实例的充分理由？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T16:08:41.207

你`DatabaseHelper`肯定应该是单身人士。每个助手都维护到数据库的单个连接。如果您有多个助手连接到同一个数据库，则会导致并发问题。Sqlite 在单个连接下进行自己的锁定，以确保对数据库的正确并发访问，因此建议并要求对所有数据库操作使用该单个连接（以及因此该单个帮助程序）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T16:30:07.243

为应用程序中的每个数据库使用一个 DatabaseHelper。SQLite 为您处理文件锁定（多次读取，只有一次写入）和 Android 在 SQLiteDatabase 中使用 Java 锁定。但是，您仍然可能会遇到并发故障（同时写入的同时连接）。这是您要避免的多重连接部分，它由 DatabaseHelper 的一个实例管理。

# java - 从内存分配的角度来看 ArrayList 与 LinkedList

> ID：11564352
> 
> 赞同：36
> 
> 时间：2012-07-19T15:39:05.023
> 
> 标签：java, list, collections, arraylist, linked-list

我需要存储大量信息，例如 java 列表中的“名称”。项目的数量可以改变（或者简而言之我无法预定义大小）。我认为，从内存分配的角度来看，LinkedList 将是比 ArrayList 更好的选择，因为对于 ArrayList，一旦达到最大大小，内存分配会自动加倍，因此总是有可能分配比 ArrayList 更多的内存需要什么。

我从这里的其他帖子中了解到，存储在 LinkedList 中的单个元素比 ArrayList 占用更多空间，因为 LinkedList 还需要存储节点信息，但我仍然猜测我定义的场景 LinkedList 可能是更好的选择。另外，我不想进入性能方面（获取、删除等），因为已经讨论了很多。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-07-19T15:44:34.800

`LinkedList`可能会分配更少的条目，但这些条目比它们的实际成本要高得多-就内存而言`ArrayList`，即使是最坏的情况也会更便宜。`ArrayList`

（仅供参考，我认为你弄错了；`ArrayList`满时增长 1.5 倍，而不是 2 倍。）

参见例如[https://github.com/DimitrisAndreou/memory-measurer/blob/master/ElementCostInDataStructures.txt](https://github.com/DimitrisAndreou/memory-measurer/blob/master/ElementCostInDataStructures.txt)：`LinkedList`每个元素消耗 24 个字节，而`ArrayList`在最好的情况下每个元素消耗 4 个字节，在最坏的情况下每个元素消耗 6 个字节. （结果可能因 32 位与 64 位 JVM 和压缩对象指针选项而异，但在这些比较中，每个`LinkedList`元素至少需要 36 个字节，`ArrayList`最多为 8 个，最差为 12 个。）

更新：

> 我从这里的其他帖子中了解到，存储在 LinkedList 中的单个元素比 ArrayList 占用更多空间，因为 LinkedList 还需要存储节点信息，但我仍然猜测我定义的场景 LinkedList 可能是更好的选择。另外，我不想进入性能方面（获取、删除等），因为已经讨论了很多。

需要明确的是，即使在*最坏的情况下*，`ArrayList`也比`LinkedList`具有相同元素的 a 小 4 倍。唯一可能的`LinkedList`取胜方法是通过调用`ensureCapacity`故意夸大的值来故意修复比较，或者在添加后删除大量值`ArrayList`。

简而言之，`LinkedList`内存比较基本上是不可能取胜的，而且如果你关心空间，那么调用`trimToSize()`将`ArrayList`立即`ArrayList`再次以巨大的优势获胜。严重地。 `ArrayList`获胜。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-19T15:45:52.987

> ...但我仍然猜测我定义的场景 LinkedList 可能是一个更好的选择

你的猜测不正确。

一旦超过了数组列表的初始容量，支持的大小将在 1 到 2 个引用乘以条目数之间。这是由于用于增长后备阵列的策略。

对于链表，每个节点占用的条目数至少是条目数的 3 倍，因为每个节点都有一个`next`和`prev`引用以及条目引用。（事实上​​，它超过了 3 倍，因为节点的对象头和填充使用的空间。根据 JVM 和指针大小，它可能高达 6 倍。）

链表使用的空间比数组列表少的唯一情况是您严重高估了数组列表的初始容量。（对于非常小的列表......）

* * *

当您考虑它时，链表与数组列表相比唯一真正的优势是在插入和删除元素时。即便如此，这也取决于你如何做到这一点。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-19T15:44:04.767

ArrayList 每个对象使用一个引用（或者当它的大小是所需大小的两倍时使用两个）这通常是 4 个字节。

LinkedList 只使用它需要的节点，但每个节点可以是 24 个字节。

所以即使在最坏的情况下，ArrayList 也会比 LinkedList 小 3 倍。

对于获取 AArrayList 支持随机访问 O(1) 但 LinkedList 是 O(n)。对于从末尾删除，两者都是 O(1)，对于从中间 ArrayList 的某处删除是 O(n)

除非您**有数百万**个条目，否则集合的大小不太重要。首先重要的是条目的大小，无论使用何种集合，条目的大小都是相同的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-19T15:43:15.787

[ArrayList.trimToSize()](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html#trimToSize%28%29)可能会让你满意。

> 将此 ArrayList 实例的容量修剪为列表的当前大小。应用程序可以使用此操作来最小化 ArrayList 实例的存储。

顺便说一句，在 ArrayList Java6 中，它不是双倍容量，它大约是达到最大大小的 1.5 倍。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-07-19T15:47:05.017

信封最坏情况的背面：

一个大小为 1,000,000 = 500,000 个已使用的数组中有 500,000 个名称，分配数组的未使用部分中有 500,000 个空指针。

链表中的 500,000 个条目 = 每个条目 3 个指针（Node 对象保存 current、prev 和 next）= 内存中的 1,5000,000 个指针。（然后你必须添加节点本身的大小）

# guice - 我可以禁止在 Guice 中进行注射吗？

> ID：11564353
> 
> 赞同：1
> 
> 时间：2012-07-19T15:39:05.303
> 
> 标签：guice

我正在使用父注入器和子注入器，并且我想确保我不会意外访问父注入器中的一个类，该类旨在绑定在子注入器中。如果父注入器访问该类，它可能会自动绑定（并且不正确，因为范围很重要）。

有没有办法可以强制自动绑定在父注入器中失败，或者至少报告运行时错误？

例如，如果我有一个`Foo`“非法”请求 Bar 的方法：

```
class Bar { @Inject Bar() {} } // Shouldn't be accessible in Foo's injector
class Foo { @Inject Foo(Bar bar) {} } // Binding should fail here 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T20:34:43.783

显然，这样做的唯一方法是为每个被禁止的类编写一个提供程序方法。每个提供程序方法都会引发运行时异常。

我已提交[增强请求](http://code.google.com/p/google-guice/issues/detail?id=716)以支持在绑定时执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T17:46:28.017

看看活页夹文档：

[http://google-guice.googlecode.com/git/javadoc/com/google/inject/Binder.html](http://google-guice.googlecode.com/git/javadoc/com/google/inject/Binder.html)

`requireExplicitBindings()`可能是你需要的。通过在您的模块中使用该语句，自动绑定被禁用，只有通过`bind()`或配置的类`provides`被注入。

# c# - 管理观察者线程 - 引发的异常和加入如何工作？

> ID：11564354
> 
> 赞同：0
> 
> 时间：2012-07-19T15:39:12.100
> 
> 标签：c#, multithreading, watchdog, threadabortexception

我有一个来自我不拥有的 API 的登录过程，该过程偶尔会挂起。如果它花费的时间超过 30 秒，我想杀死它并重试（因为它应该只需要大约 2-3 秒）。

我对中止线程的工作原理以及是否需要在中止后加入感到有些困惑。这是我的问题，然后是我正在尝试做的示例：

**问题：**

1.  Abort 在其调用的线程中引发线程中止异常。这会传播吗？我需要在调用线程中显式处理它还是线程只是死了？

2.  我是否需要加入一个中止的线程以使其不会僵化，或者我只是对 *NIX 编程世界感到困惑？

    ```
    public static Session GetSession()
    {
        Session session = new Session("user", "pass");

        try
        {
            //Create a thread to get the session so we can kill it if it hangs.
            Thread thread = new Thread(() => session.Logon());

            //Create a thread to kill the session thread if it hangs.
            Thread watcher = new Thread(() => HangKill(thread));

            //Start both threads.
            thread.Start();
            watcher.Start();

            //Wait for session thread to finish - abort kill thread if it does.
            thread.Join();
            watcher.Abort();
            watcher.Join();
        }
        catch (Exception ex)
        {            
            status = ex.ToString();
        }

        return session;
    }

    public static void HangKill(Thread t)
    {
        Thread.Sleep(30);

        if (t.IsAlive == true)
        {
            t.Abort();
        }
    } 
    ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:42:19.123

在您自己的进程中中止线程是危险的。（尽管在其他进程中也是如此。）线程可能拥有一些锁，可能正在更新关键结构等。所以这不是要走的路。

我建议将相关服务包含到另一个进程中，这样如果出现问题，您可以终止该进程。使用 IPC（共享内存？WCF？）与该进程进行通信。

# internet-explorer - 为什么 Chrome 和 IE 从不发送 If-None-Match 而其他浏览器会发送？

> ID：11564360
> 
> 赞同：7
> 
> 时间：2012-07-19T15:39:34.653
> 
> 标签：internet-explorer, caching, google-chrome

我目前正在发送以下标头：

```
Cache-Control: max-age=0
Content-Encoding: gzip
Content-Length: 2929
Content-Type: text/html; charset=utf-8
Date: Thu, 19 Jul 2012 15:29:18 GMT
ETag: "3e34180212ee59fee7e8e4cc512552e5" 
```

然后在后续请求中，我希望所有浏览器都发送一个`If-None-Match`包含内容的标头，`ETag`以便我可以在必要时以 304 响应。Firefox、Safari 和 Opera 都会发回 ETag，但 Chrome 和 Internet Explorer 不会。是否有一些标题组合或缺失值导致 Chrome 和 IE 忽略 ETag？

如果我设置`Last-Modified`，那么它们都会发送`If-Modified-Since`，但我需要使用 ETags。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-02T18:05:54.690

根据这个 SO Q&A - [Browser support for eTags](https://stackoverflow.com/questions/6247761/browser-support-for-etags) - Chrome 应该尊重 ETag。

然而，正如作者所说：“但是，还有一些其他标头会阻止这些浏览器尊重 etag ......所以如果它不适合你，我会仔细检查其他标头在他们发送回客户端时请求资源。”

“日期”标头是否可能导致与 ETag 的问题/冲突？

# c# - 在移动连接 c# 上检索 Tcp/IP 使用情况

> ID：11564364
> 
> 赞同：3
> 
> 时间：2012-07-19T15:39:54.327
> 
> 标签：c#, networking, tcp, network-protocols, windows-embedded

我目前正在编写一个系统日志程序，它通过 ftp 发送不同的日志。我面临的问题是我的程序应该在上传之前和上传期间不断检查连接是否正在使用，以便在其他程序想要使用连接时停止发送数据包。

我实际上发现这个[链接](http://asimsajjad.blogspot.de/2009/08/calculating-network-bandwidth-speed-in.html)可以帮助我测量连接的速度，但我认为我只能使用后者来发现某些东西是否已经在流式传输。在阅读 System.Net.NetworkInformation 上的库条目后，检查各种网络统计信息和状态也不是问题。如前所述，我唯一的问题是检查是否有其他程序想要发送一些东西。

正如您可能从问题中看出的那样，我对这个主题非常陌生，并且是一个相当初级的程序员。我一直在阅读 System.Net.NetworkInformation 命名空间库并促进它的各种类、方法和委托。我有一种感觉，我在正确的轨道上，但只是没有到达那里。有人朝正确的方向推动了吗？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T11:02:35.163

我最终使用了 System.Net.NetworkInformation 库及其方法。

GetIsNetworkAvailable()、NetworkChange.NetworkAvailabilityChanged Eventhandler 和 TcpStatistics 方法帮助我收集有关连接的信息。MSDN 和参考资料是使用前面提到的方法的一个很好的指南，我基本上使用了这些示例，稍加修改以满足我的需要。

msdn 网络信息：http: [//msdn.microsoft.com/de-de/library/system.net.networkinformation.aspx](http://msdn.microsoft.com/de-de/library/system.net.networkinformation.aspx)

GetIsNetworkAvailable 非常直接地在连接开启或关闭时返回布尔值。

Networkchange.NetworkAvailabilityChanged 在连接丢失或重新连接时触发事件。请参阅上面的 msdn 链接，以获取有关其用法的出色且非常有用的示例。

TcpStatistics 返回有关已接受、启动、收到错误、失败连接、连接重置等的连接数的信息。这些是我迄今为止用来评估连接的五个。

我意识到您不再需要有效地监控连接。也许 NetworkInterface.GetAllNetworkInterfaces() 方法可以帮助找出哪个 Networkadapter 正在发送数据并且应该被监控。

我现在了解彼得里奇对我的问题的评论。FTP 传输运行得非常好，该协议完美地处理了文件的传输，到目前为止，在流式传输日志文件方面没有出现任何问题。在 4 周的测试中，我不断收到记录数据。

# email - Arduino 自动电子邮件通知

> ID：11564365
> 
> 赞同：5
> 
> 时间：2012-07-19T15:40:06.073
> 
> 标签：email, notifications, arduino, sensors

我想开始一个涉及 arduino 和电子邮件通知的项目。我不确定以前是否有过这样的事情，但我猜它有某种形式。让我解释。基本上，我想用一些压电传感器或 kinect 设置 arduino，以便在执行操作（或感应到压力）时自动发送电子邮件（或推文）。我确信这可以完成，但我不确定从哪里开始，我想知道是否有人有想法？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T18:29:07.370

我没有测试下面的代码，但这是你想要做的最基本的结构。

在 Arduino 上，设置您的代码以在您想发送电子邮件时在串行线路（“arduino_output”）上输出一些东西。然后在计算机上，等待该事件。

Linux 非常简单，因为可以将串行端口视为读取文件。

```
#!/usr/bin/perl
use open ':std';
use MIME::Lite;

#Open the COM port for reading
#just like a file
open FILE, "<", "/dev/usbTTY0" or die $!;

#setup e-mail message
$msg = MIME::Lite->new(
    From        => '"FirstName LastName" <something@gmail.com>',
    To          => "somebody@hotmail.com",
    Subject     => "subject",
    Type        => "text/plain"
);

#loop forever (until closed w/ ctrl+c)
while (1){
    while (<FILE>){
        # if there is output from the arduino (ie: Serial.write(...))
        # then the e-mail will be sent
        if ($_ == "arduino_output"){
            MIME::Lite->send('smtp','mailrelay.corp.advancestores.com',Timeout=>60);
            $msg->send();
        }
    }  
} 
```

祝你的项目好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T14:30:50.027

用arduino查邮件很简单！

我在这里写了一篇文章[http://www.albertopasca.it/whiletrue/arduino-mail-notifier-with-c/](http://www.albertopasca.it/whiletrue/arduino-mail-notifier-with-c/)
在 Windows 上使用 C# 来检查 gmail 邮件。

您可以调整代码以在所需的每个操作系统上使用它。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T10:50:55.197

我建议使用[Pyserial](http://pyserial.sourceforge.net/)

然后从arduino你只需将数据发送到python

```
void setup(){
  Serial.begin(9600);
}
void loop(){
  if (EVENT BECOME TRUE /* sensor value or whatever */){
    Serial.write("Send mail");
  }
} 
```

然后形成 python { 安装后 pyserial }

```
import serial
import smtplib
def sendMail(receiver,message):
    try:
        s=smtplib.SMTP_SSL()
        s.connect("smtp.gmail.com",465)
        s.login("YOUR-SENDER-MAIL@gmail.com", "Password")
        s.sendmail("your.log.result@gmail.com", receiver, message)#write the destination at receiver parameter  
    except Exception,R:
            print R

ser = serial.Serial('/dev/tty.usbserial', 9600)# or in windows you could write port name
while 1:
  receive = ser.readline()
  if receive == "send mail":sendMail("send-me-notification@gmail.com","YOU got mail from arduino!") 
```

好吧，您可以根据您的 MAIL 主机更改 smtp，在我的情况下，我使用了 gmail，祝您的项目好运：D

# asp.net-mvc - jquery - 将多个参数传递给控制器

> ID：11564369
> 
> 赞同：0
> 
> 时间：2012-07-19T15:40:16.753
> 
> 标签：asp.net-mvc, jquery

如何在不使用 JSON 的情况下将多个数组传递给 jquery 中的控制器？

```
var Test1 = {};
Test1.Source = 'String1';
Test2.Type = 'String2';

var Test2 = {};
Test2.Name = 'String3';
Test2.Location = 'String4'; 
```

我的控制器是

```
public Int64 Method1(Class1 cl1, Class2 cl2)
{
} 
```

$.ajax() 的 data 属性的正确语法是什么？有一个论点，我可以有

```
data: Test1 
```

但是，这如何与两个或多个参数一起工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T15:42:27.807

只需像这样包装另一个对象，以便每个数组（实际上是对象）都是一个属性：

```
data: {t1: Test1, t2: Test2 } 
```

[您可以在文档](http://api.jquery.com/jQuery.ajax/)中看到一个示例（尽管使用字符串值代替）。

```
$.ajax({
  type: "POST",
  url: "some.php",
  data: { name: "John", location: "Boston" }
}).done(function( msg ) {
  alert( "Data Saved: " + msg );
}); 
```

# ios - 我的单身可以改善吗？

> ID：11564376
> 
> 赞同：2
> 
> 时间：2012-07-19T15:40:33.617
> 
> 标签：ios, ios5, singleton

我对 iOS 5 单例有点陌生，并且正在使用此处记录的单例：

[iOS 5 单例](http://iosdeveloperforums.com/f9/singletons-ios5-40.html)

像这样的东西：

我的经理.h

```
#import <Foundation/Foundation.h>
@interface MyManager : NSObject

//Data for section 1
@property(nonatomic,copy) NSString * section1a;
@property(nonatomic, assign) NSUInteger section1b;

//Data for section 2
@property(nonatomic,copy) NSString * section2a;
@property(nonatomic, assign) NSUInteger section2b;

+ (id)sharedInstance;
@end 
```

我的经理.m

```
@implementation MyManager
@synthesize section1a, section1b, section2a; , section2b;

+ (id)sharedInstance
{
    static dispatch_once_t pred = 0;
    __strong static id _sharedObject = nil;
    dispatch_once(&pred, ^{
        _sharedObject = [[self alloc] init]; // or some other init method
    });
    return _sharedObject;
}
@end 
```

所以我使用它如下：

```
MyManager * myManager = [MyManager sharedInstance];
myManager.data = self.data 
```

这是您通常使用单例的方式吗？我错过了什么吗？对不起，我只是想确保我做对了一些基本问题。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:45:50.160

这不是单例，因为您可以使用 alloc/init 方法创建此类的多个实例。正确答案[在这里](https://stackoverflow.com/questions/11470112/how-to-implement-singleton-pattern-in-my-iphone-project/11470197#11470197)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T15:55:42.933

你做对了。这是（目前:) 的方式，并且在启用 ARC、多线程等情况下工作正常。

它不是严格意义上的单例，因为您可以分配更多的类实例，但我认为这与您的情况无关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T15:46:34.563

我通常这样制作我的单身人士（假设我们正在为 Manager 制作单身人士）：

```
static (Manager *) instance;

+ (Manager *) getInstance
{
    if(!instance) instance = [[Manager alloc] init];
    return instance;
} 
```

这是一个非常基本的单例（它没有考虑多线程或其他高级特性），但这是基本格式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-31T19:53:37.950

请参考：[iOS 5 中的单例？](https://stackoverflow.com/questions/8796529/singleton-in-ios-5/11564881#11564881)您应该覆盖 allowWithZone 以防止恶意代码创建新实例。

# android - ActionBar/Tabs 中的 Android 自定义主题

> ID：11564378
> 
> 赞同：7
> 
> 时间：2012-07-19T15:40:41.847
> 
> 标签：android, styles, android-actionbar, theming

我有主题 Holo.Light.DarkActionBar

选项卡现在设置为白色背景、浅灰色文本——非常不可读。我只是想将文本更改为更暗的东西。

我已经搜索了样式以查看是否可以覆盖，但我所能做的就是更改背景，而不是文本。

我可以在 styles.xml 中执行此操作还是必须以编程方式执行此操作？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-07-19T19:38:37.820

如果您指的是`ActionBar`'s 选项卡，请查看这是否会改变颜色：

```
<!-- The theme for the activity -->
<style name="TabSpecialTheme" parent="android:Theme.Holo.Light.DarkActionBar">
      <item name="@android:attr/actionBarTabTextStyle">@style/TabStyle</item>
</style>

<!-- Modify the text color -->
<style name="TabStyle" parent="android:Widget.Holo.Light.ActionBar.TabText.Inverse">
      <item name="android:textColor">#F70000</item>
</style> 
```

当然不要忘记`@style/TabSpecialTheme`在清单中设置活动的主题。

# nlp - 如何防止在计算 ngram 时贴现为零？

> ID：11564380
> 
> 赞同：0
> 
> 时间：2012-07-19T15:40:45.173
> 
> 标签：nlp, n-gram

我正在使用 SRILM 的 ngram-count 命令行实用程序来尝试计算古腾堡语料库子集的三元模型。命令行是：

```
 -order 3 -kndiscount -text {$text} -lm {$lm} -gt2min 10 -gt3min 5 -vocab {$vocab} -unk 
```

然而，我的一些台词被打折为 0（或者至少这就是我认为正在发生的原因。

```
-5.018952   roaming
-4.189117   roar    -0.2053203
-4.30369    roared  0    <-- discounted to zero? 
```

如果我使用 -gt1min 0 或任何其他值并且实现了最小阈值，也会发生这种情况。我该如何防止这种情况发生？当我尝试将其转换为基于 n-gram 的 FST 并在输入句子中使用这些单词之一观察输入时，它会导致问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-30T16:37:34.190

根据[本教程（第 17 页）](http://berlin.csie.ntnu.edu.tw/Berlin_Research/Surevy/Lectures/20080512-SRILM%20Tutorial.pdf)，您所指的数字是*退避权重*。有关更多信息，您可以阅读[此](http://www.speech.sri.com/projects/srilm/manpages/ngram-discount.7.html)内容。

# operating-system - 操作系统内存分配

> ID：11564384
> 
> 赞同：0
> 
> 时间：2012-07-19T15:40:58.000
> 
> 标签：operating-system

我知道每个进程都有一块内存，其中包含代码段，数据段，堆和堆栈。而且代码段是只读的。但是当一个进程开始运行时，这个只读内存分配在哪里以及如何操作系统区分每个进程的内存的只读部分？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T16:05:12.953

每个进程都有一个所谓的页表，它将实际物理 RAM 映射到进程的虚拟内存空间。该表将属性分配给内存的每个“页面”，通常为 4kb。其中一些属性包括将页面设置为只读、不可执行、具有特权代码等。操作系统基本上会告诉硬件属性是什么，因此它不必对每个内存访问进行微观管理，因为这将非常低效。

有关低级详细信息，请参阅[此 osdev wikipage 以](http://wiki.osdev.org/Paging) 获取典型 x86 机器中的解释和示例。

# c# - Visual FoxPro OLE DB 性能问题在 DBF 文件上循环

> ID：11564385
> 
> 赞同：0
> 
> 时间：2012-07-19T15:40:59.090
> 
> 标签：c#, .net, foxpro, visual-foxpro

我有一个超过一百万行的 .DBF 文件（嗯，6 个具有相同结构的 DBF 文件）。我还有一个 C# 应用程序，它使用我们制作的 API 将这些数据迁移到 SQL 数据库中。

程序启动很快，每秒可以处理 30 或 40 行，但随着时间的推移逐渐变慢，我不知道为什么。我相信我正在以良好的速度处理物品。

我在 vfpoledb 中使用的连接字符串是

```
"Provider=vfpoledb;Data Source=" + sourceDBFolder + ";Collating Sequence=machine;MVCOUNT=32000;ENGINEBEHAVIOR=90;TABLEVALIDATE=0;REFRESH=0"; 
```

其中 sourceDBFolder 是磁盘上的路径。在开始任务之前，我还执行了以下代码：

```
System.Data.OleDb.OleDbCommand oRefreshCommand = oConn.CreateCommand();
oRefreshCommand.CommandText = "EXECSCRIPT([SET REFRESH TO 0,0])";
oRefreshCommand.ExecuteNonQuery(); 
```

这是相关的代码。select 语句中的 where 子句如果不按下面的顺序排列，就会造成瓶颈。

```
string[] noteTables = new string[] { "note1", "note2", "note3", "note4", "note5", "note6" };
foreach (long lNoteKey in oCaseLookupTable.Keys) {
  for (int y = 0; y <= 5; y++) {
    System.Data.OleDb.OleDbCommand oNotesCmd = oConn.CreateCommand();
    oNotesCmd.CommandText = "SELECT NOTEDATE, NOTEDESC, ENTEREDBY FROM " + noteTables[y] + " WHERE NOTEPOINT = " + lNoteKey.ToString() + " AND NOTEDESC NOT LIKE 'Folder accessed%'";
    DataTable oNotesTable = new DataTable();
    oNotesTable.Load(oNotesCmd.ExecuteReader());
    foreach (DataRow oRow in oNotesTable.Rows) { 
      //Do processing on rows, Note is my created class.
      Note oNote = new Note();
      oNote.NoteValue = oRow["NOTEDESC"].ToString().Trim();
      oNote.ReferenceID = oCaseLookupTable[lNoteKey];
      DateTime createdDate;
      if (DateTime.TryParse(oRow["NOTEDATE"].ToString().Trim(), out createdDate))
        oNote.CreatedDate = createdDate;
      else
        oNote.CreatedDate = DateTime.Now;
      Result oNoteResult = oNote.Insert();
    }
    oNotesTable.Dispose();
    oNotesCmd.Dispose();
  }
} 
```

简而言之，我不明白为什么这会变得越来越慢。PerfMon 没有显示任何随时间增长的托管内存块。我尝试通过连续调用 DBF 文件来保持我的 DataTable 很小。通常，查询将返回的最大行数为 1,000。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T08:38:46.473

您正在执行 Rushmore 的查询是否经过优化，即表上是否有字段 NOTEPOINT 和 NOTEDESC 的索引？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T14:40:51.503

将代码转换为使用`DataReader`代替`DataTable`. 使用`while`循环迭代结果。我相信上的`foreach`循环`DataTable`也在减慢速度。由于您只向前读取值，这将为您带来性能改进：

有关更多信息，请参阅[性能比较：数据访问技术](http://msdn.microsoft.com/en-us/library/ms978388.aspx)，尤其是部分`DataReader vs. DataSet`

> 对于需要优化的只读和只进数据访问的应用程序，DataReader 是更好的选择。越早从 DataReader 加载数据、关闭 DataReader 并关闭数据库连接，获得的性能就越好。由于 DataReader 持有的数据库连接在应用程序读取数据时不能用于任何其他目的，因此如果应用程序持有 DataReader 的时间足够长以至于发生争用，它可能会限制可伸缩性。DataSet 只需要在填充时保持连接。一旦它被填满，连接可能会被关闭并返回到池中。延迟从 DataSet 读取数据不会导致发生争用，因为连接可能已经返回到池中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-25T22:13:58.727

问题是 SQL 端表上的一些数据库触发器。在操作期间禁用它们（在这种情况下不需要它们）解决了这个问题。

# facebook-opengraph - 尝试使用内置跟随时出现错误消息

> ID：11564386
> 
> 赞同：1
> 
> 时间：2012-07-19T15:41:05.893
> 
> 标签：facebook-opengraph, built-in

当尝试针对“个人资料”发布关注时，我们总是会收到以下消息：

{"error":{"message":"(#100) 订阅者必须是用户","type":"OAuthException","code":100}}

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T21:18:15.537

事实证明，这是因为每个用户的每个应用程序的第 3 方 ID 都是唯一的，我们不小心将属于不同应用程序的 ID 放在了我们在页面中使用的 ID 上。

# string - 将字符添加到数据集中的字符串子集

> ID：11564388
> 
> 赞同：2
> 
> 时间：2012-07-19T15:41:07.920
> 
> 标签：string, r, conditional, character, add

假设我有一个数据集：

```
test = data.frame(x=c(1:11), y=as.character(c(1:11))) 
```

其中“y”列由字符/字符串组成。现在，我想更改包含两个字符的字符串（即 test[10,2] & test[11,2]），以便这些字符串以字符“0”开头。结果将是“010”和“011”，而其他字符串（只有一个字符）保持不变。对我来说，合乎逻辑的解决方案是：

```
test[nchar(test[,2])==2,2] = paste(c("0", test[nchar(test[,2])==2,2]), collapse="") 
```

实际上，只有 test[10,2] 和 test[11,2] 受到影响。奇怪的是，结果是 test[10,2] = "01011"，而 test[11,2] = "01011"。这意味着具有两个字符的所有字符串都与前面的“0”一起粘贴。这绝对不是我想看到的。

当满足某些条件（长度）时，我应该怎么做才能将一个字符添加到数据集中的字符串中？您的回答将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T15:49:48.043

利用

```
paste("0", test[nchar(test[,2])==2,2], sep="") 
```

所以例如

```
> test[nchar(test[,2])==2,2] = paste("0", test[nchar(test[,2])==2,2], sep="")
> test
    x   y
1   1   1
2   2   2
3   3   3
4   4   4
5   5   5
6   6   6
7   7   7
8   8   8
9   9   9
10 10 010
11 11 011 
```

`collapse`并且`sep`有不同的属性

```
> paste(1,c(2:3),collapse=',')
[1] "1 2,1 3"
> paste(1,c(2:3),sep=',')
[1] "1,2" "1,3" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T15:57:15.903

也许使用它会更具可读性`ifelse`：

```
transform(test,y=ifelse(nchar(y)==2,paste0("0",y),y))
    x   y
1   1   1
2   2   2
3   3   3
4   4   4
5   5   5
6   6   6
7   7   7
8   8   8
9   9   9
10 10 010
11 11 011 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-19T15:54:51.383

我会像 ttmaccer 建议的那样做同样的事情，除了我会使用 paste0，它会自动连接它们而没有任何空格。它比粘贴更有效，所以如果你有一个大数据集，它可能是值得的。这意味着您也不必记住“sep”参数。

```
test[nchar(test[,2])==2,2] = paste0("0", test[nchar(test[,2])==2,2]) 
```

# sql - Visual Studio 10 DataGridView 和 DatePicker on Where 子句

> ID：11564391
> 
> 赞同：0
> 
> 时间：2012-07-19T15:41:12.727
> 
> 标签：sql, visual-studio-2010, datagridview, dataset, visual-foxpro

我正在将一个 Visual Fox Pro 数据库表加载到 Visual Studio 中的数据网格视图中。在表单上还有一个日期选择器，我需要在我的数据集查询中添加当前选择的日期。有人可以指出我正确的方向吗？

这是我当前的查询：SELECT item.itemnumber、stdetail.stid、stdetail.qty、stdetail.recadded FROM item、stdetail WHERE item.itemid = stdetail.itemid

我猜我会添加类似的内容：

AND DatePick.Value = stdetail.recadded ????????

我的第二个问题是：在数据库中日期存储为 2012-05-20 11:29:37

如何仅比较日期并请假？我正在尝试选择一个日期并查看当天售出的所有商品。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T20:37:27.300

要仅比较日期，可以使用 TTOD() 函数，它将日期时间值转换为日期值：

和 TTOD(stDetail.RecAdded) =

添马舰

# windows - x64下的线程信息块

> ID：11564394
> 
> 赞同：2
> 
> 时间：2012-07-19T15:41:17.580
> 
> 标签：windows, assembly, 64-bit, windows-7-x64

我需要从 x64 平台上的 TIB 获取最大和最小堆栈（我知道我需要用 GS 寄存器替换 FS 寄存器。）在 x86 平台上我可以使用[这个表](http://en.wikipedia.org/wiki/Win32_Thread_Information_Block)并找到正确的偏移量
你知道在哪里吗我可以找到 x64 平台的表吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T17:54:27.407

这是一个适用于 x86 和 x64 的程序。

```
#include <windows.h>
#include <stdio.h>

void main()
{
  PNT_TIB ptib = (PNT_TIB)NtCurrentTeb();
#ifdef _AMD64_
  printf("Stack base: %08I64X, limit: %08I64X\n",
    ptib->StackBase, ptib->StackLimit);
#else
  printf("Stack base: %08X, limit: %08X\n",
    ptib->StackBase, ptib->StackLimit);
#endif
} 
```

# c# - 更改centerX和centerY后如何保持变换？

> ID：11564396
> 
> 赞同：0
> 
> 时间：2012-07-19T15:41:21.677
> 
> 标签：c#, .net, wpf

我正在实现拖动行为，并且遇到以下问题。

我首先缩放一个CenterX 和CenterY 等于0 的矩形。然后，我在运行时将CenterX 和CenterY 更改为矩形的右上角以缩放到左侧。

问题是，当我更改对象的 centerX 和 centerY 时，一切都会重新绘制，就像我从未更改过 CenterX 和 CenterY 一样。

Obs：我正在使用 RenderTransform。

不知道我解释的好不好=x。

请帮忙。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T02:12:45.160

没有代码很难提供帮助。但无论如何我都会尝试。

您可以尝试使用转换矩阵来获得“真实结果”。例子：

```
 Point dragDelta = new Point(e.HorizontalChange, e.VerticalChange);

        Matrix toCalculate = ((visualComponent as FrameworkElement).RenderTransform).Value;
        dragDelta = toCalculate.Transform(dragDelta);

        myData.X += dragDelta.X;
        myData.Y += dragDelta.Y; 
```

有很多方法可以做到这一点。我不是特别喜欢用翻译变换。理想的是使用拇指并使用模板通过样式设置。这应该对您有所帮助：http: [//www.codeproject.com/Articles/148503/Simple-Drag-Selection-in-WPF](http://www.codeproject.com/Articles/148503/Simple-Drag-Selection-in-WPF)

# ruby-on-rails - 为什么我不能在用户实例方法中使用 root_path？（未定义的局部变量或方法）

> ID：11564399
> 
> 赞同：0
> 
> 时间：2012-07-19T15:41:31.770
> 
> 标签：ruby-on-rails, path, actioncontroller

我需要为具有电子邮件参数的用户调用方法。它是在 PayPal 中支付的功能，我正在设置返回 url 和取消 url。

这是我的方法，在 user.rb 中：

```
 def pay email
require 'httpclient'
require 'xmlsimple'
clnt = HTTPClient.new
credentials = {
    'USER' => 'payer_1342623102_biz_api1.gmail.com',
   'PWD' => '1342623141',
   'SIGNATURE' => 'Ay2zwWYEoiRoHTTVv365EK8U1lNzAESedJw09MPnj0SEIENMKd6jvnKL '
 }

header =  {"X-PAYPAL-SECURITY-USERID" => "payer_1342623102_biz_api1.gmail.com",
               "X-PAYPAL-SECURITY-PASSWORD" => "1342623141",
               "X-PAYPAL-SECURITY-SIGNATURE" =>"Ay2zwWYEoiRoHTTVv365EK8U1lNzAESedJw09MPnj0SEIENMKd6jvnKL ",
               "X-PAYPAL-REQUEST-DATA-FORMAT" => "NV",
               "X-PAYPAL-RESPONSE-DATA-FORMAT" => "XML",
               "X-PAYPAL-APPLICATION-ID" =>  "APP-80W284485P519543T"
                }
data = {"actionType" => "PAY",
           "receiverList.receiver(0).email"=> email,
           "receiverList.receiver(0).amount" => "10",
           "currencyCode" => "USD",
           "cancelUrl" => root_path,
           "returnUrl" => root_path,
           "requestEnvelope.errorLanguage" => "en_US"}
uri = "https://svcs.sandbox.paypal.com/AdaptivePayments/Pay"
res = clnt.post(uri, data, header)
@xml = XmlSimple.xml_in(res.content)
payKey = @xml["payKey"].to_s()
payKey = payKey.tr("[]", "")
payKey = payKey[1..20]
redirect_to "https://sandbox.paypal.com/webscr?cmd=_ap-payment&paykey=#{payKey}"
 end 
```

我得到错误：

```
 undefined local variable or method `root_path' 
```

为什么我不能使用这种方法？为什么我不能使用 redirect_to ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T15:54:27.883

我不认为 root_path 或 root_url 在模型类中默认可用。这是设计使然，因为您的模型不应该了解控制器/视图/类似会话的操作。您可以通过在模型中包含它来访问 root_url：

```
include Rails.application.routes.url_helpers 
```

更好的解决方案是将此信息传递给 order.pay 方法。

# jquery - 在提交表单之前验证多个无线电组

> ID：11564401
> 
> 赞同：0
> 
> 时间：2012-07-19T15:41:41.653
> 
> 标签：jquery

所有，我有以下 HTML 代码来显示一个带有一些单选框的表单：

```
<tr id="row1">
    <td align="center">
        <b>Dancefloor</b>
        <input type="hidden" name="question_id[]" value="2">
    </td>
    <td align="center">
        <div style="text-align:center;">
            <input type="radio" name="rating_value_2" id="rating_value_2" value="5"
            required>
        </div>
    </td>
    <td align="center">
        <div style="text-align:center;">
            <input type="radio" name="rating_value_2" id="rating_value_2" value="4">
        </div>
    </td>
    <td align="center">
        <div style="text-align:center;">
            <input type="radio" name="rating_value_2" id="rating_value_2" value="3">
        </div>
    </td>
    <td align="center">
        <div style="text-align:center;">
            <input type="radio" name="rating_value_2" id="rating_value_2" value="2">
        </div>
    </td>
    <td align="center">
        <div style="text-align:center;">
            <input type="radio" name="rating_value_2" id="rating_value_2" value="1">
        </div>
    </td>
</tr>
<tr bgcolor="#FFFFFF" id="row2">
    <td align="center">
        <b>Client Satisfaction</b>
        <input type="hidden" name="question_id[]" value="3">
    </td>
    <td align="center">
        <div style="text-align:center;">
            <input type="radio" name="rating_value_3" id="rating_value_3" value="5"
            required>
        </div>
    </td>
    <td align="center">
        <div style="text-align:center;">
            <input type="radio" name="rating_value_3" id="rating_value_3" value="4">
        </div>
    </td>
    <td align="center">
        <div style="text-align:center;">
            <input type="radio" name="rating_value_3" id="rating_value_3" value="3">
        </div>
    </td>
    <td align="center">
        <div style="text-align:center;">
            <input type="radio" name="rating_value_3" id="rating_value_3" value="2">
        </div>
    </td>
    <td align="center">
        <div style="text-align:center;">
            <input type="radio" name="rating_value_3" id="rating_value_3" value="1">
        </div>
    </td>
</tr>
<tr id="row3">
    <td align="center">
        <b>Overall Gig</b>
        <input type="hidden" name="question_id[]" value="1">
    </td>
    <td align="center">
        <div style="text-align:center;">
            <input type="radio" name="rating_value_1" id="rating_value_1" value="5"
            required>
        </div>
    </td>
    <td align="center">
        <div style="text-align:center;">
            <input type="radio" name="rating_value_1" id="rating_value_1" value="4">
        </div>
    </td>
    <td align="center">
        <div style="text-align:center;">
            <input type="radio" name="rating_value_1" id="rating_value_1" value="3">
        </div>
    </td>
    <td align="center">
        <div style="text-align:center;">
            <input type="radio" name="rating_value_1" id="rating_value_1" value="2">
        </div>
    </td>
    <td align="center">
        <div style="text-align:center;">
            <input type="radio" name="rating_value_1" id="rating_value_1" value="1">
        </div>
    </td>
</tr>
<div id="radio_group_error"></div> 
```

此代码是从一些 PHP 代码生成的，因此可以有一组或多个单选按钮。我想做的是确保为页面上的每个组选择至少一个单选按钮（使用 jQuery 进行此检查）。如果未选择至少一个无线电组，那么我希望在 radio_group_error div 中显示一个错误。

关于如何做到这一点的任何想法，因为可以有一个或多个不同的无线电组？

如果有人可以编辑此代码以使其看起来更好，请随意！（感谢科林）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:58:45.113

你可以这样做：

```
var radios = $("input[type=radio]");
var group  = radios.filter("[name=rating_value_x]");
alert((group.filter(":checked").length)?"checked":"not checked"); 
```

这将检查组 x 的单选按钮是否被选中。现在遍历所有组，你就完成了。

看**[例子](http://jsfiddle.net/poikl/3k5Gm/)**

编辑：

循环可能如下所示：

```
 var name = "rating_value_";
    var i = 1;
    var checked = true;
    // loop as long as there are groups available
    while( radios.filter("[name="+name+i+"]").length ){
       // check if there is a checked radio-button in this group
       if (!radios.filter("[name="+name+i+"]").filter(":checked").length){
          // selfdestruct
          checked = false;
       }
       i++;
    }       
    alert(checked?"check-check checked!":"check-check failed!"); 
```

# scons - 如何告诉 SCons 忽略来自命令操作的隐式依赖关系？

> ID：11564403
> 
> 赞同：3
> 
> 时间：2012-07-19T15:41:43.567
> 
> 标签：scons

默认情况下，SCons 似乎会查看用于构建程序的“配方”并从中提取隐式依赖项。例如假设我的 SConstruct 包含：

```
Command('foo', 'foocreator.py', '/usr/bin/python foocreator.py > foo') 
```

而且我已经构建了“foo”（“foo”是最新的）。现在我更改 SConstruct（或更现实地说，传递不同的选项），以便 'foo' 的命令变为：

```
Command('foo', 'foocreator.py', '/usr/bin/qrsh -V -cwd /usr/bin/python foocreator.py > foo') 
```

（换句话说，通过 SGE 运行 foocreator.py 脚本）现在 SCons 尝试重建 foo，--debug=explain 告诉我这是因为“对 /usr/bin/qrsh 的新依赖”和“已删除的依赖”在 /usr/bin/python")。

我怎样才能防止从配方中推断出这种依赖关系，最好是全局的？到目前为止，我什至无法找到这种行为的规范。我不想说明“foo”并不真正依赖于 python 或 qrsh 的事实，因为我必须对每个目标以及这些程序的每个可能位置都这样做。必须有一个“正确”的方式。

**编辑**：我现在也尝试为每个目标显式添加忽略，如：

```
Ignore('foo', '/usr/bin/python')
Ignore('foo', '/usr/bin/qrsh') 
```

甚至这也行不通！每当我在运行 qrsh 和不运行之间切换时，SCons 仍然希望重建所有内容。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-20T07:46:56.587

问题是 scons 对动作进行一些最小的解析来确定你在调用什么，这样

```
 python $SOURCE > $TARGET 
```

自动将依赖项添加到 python。它还在动作的 md5 中包含动作 TEXT。所以如果你把它改成

```
 anotherprog -cmd python $SOURCE > $TARGET 
```

它将检测到 3 个变化：

1.  删除了对 python 的依赖
2.  添加了对 anotherprog 的依赖
3.  改变了命令行

这是半合理的，因为如果您更改另一个程序，您可能应该进行重建。

您可以通过在“$(”和“$)”中包含不重要的位来停止 scons 检测命令行更改，因此更改

```
 anotherprog $( -date $TIME $) $SOURCE > $TARGET 
```

至

```
 anotherprog $( -time $DATE $) $SOURCE > $TARGET 
```

不会导致重建。

所以我猜如果你有

```
 $( python $) $SOURCE > $TARGET 
```

至

```
 $( anotherprog =cmd python $) $SOURCE > $TARGET 
```

它会做你想要的。但我没有尝试过。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T15:54:54.453

我找到了记录在案的解决方案：有一个构造变量 IMPLICIT_COMMAND_DEPENDENCIES 可以精确控制这种行为。它记录在[http://www.scons.org/doc/HTML/scons-man.html](http://www.scons.org/doc/HTML/scons-man.html)上（但我通过搜索 scons 源代码发现了它！）

所以这给出了基于我原来的例子我想要的行为。

```
env = Environment(IMPLICIT_COMMAND_DEPENDENCIES =0, ... )
Command('foo', 'foocreator.py', '/usr/bin/python foocreator.py > foo') 
```

（或者）

```
env = Environment(IMPLICIT_COMMAND_DEPENDENCIES =0, ... )
Command('foo', 'foocreator.py', '/usr/bin/python foocreator.py > foo') 
```

我可以在目标 'foo' 的两个定义之间切换，并且 scons 不会认为 foo 已过时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T16:02:42.460

我不确定这是否会有所帮助，但最好如下更改您的操作字符串：

```
actionStr = '/usr/bin/qrsh -V -cwd /usr/bin/python $SOURCE > $TARGET'
Command(target = 'foo', source = 'foocreator.py', action = actionStr) 
```

SCons 可能无法从操作字符串中确定源和目标是什么，并且可能会感到困惑。

可能无法像您在上面的评论中建议的那样关闭行为，但是您应该尝试使用[Ignore()](http://www.scons.org/doc/production/HTML/scons-user/x1275.html)和[Depends()](http://www.scons.org/doc/production/HTML/scons-user/x1220.html)函数对其进行微调，而不是创建自己的构建器。绝对最坏的情况是通过调用在内部执行 qrsh 和 python 的 shell 脚本来有效地使操作字符串保持不变。

# scala - 强制 sbt 显示编译器堆栈跟踪

> ID：11564404
> 
> 赞同：0
> 
> 时间：2012-07-19T15:41:50.477
> 
> 标签：scala, sbt

我正在使用 sbt 编译一个项目。并且 scala 编译器在编译时崩溃。Sbt 显示关于断言的微小记录。如何获得完整的编译器堆栈跟踪？

我试图在谷歌搜索这个问题，但只找到你自己的代码或测试用例崩溃的情况，而不是 scala 编译器本身。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T15:57:37.070

重复相同的命令，但以`last`. 例如，如果您尝试过`compile`并且发生了什么事，请键入`last compile`next。

此外，sbt 将来自各种任务的所有日志文件保存在`target/streams`目录下。它位于与执行的范围/任务相对应的目录中。SO，`compile/compile/$out`包含运行编译的日志。

当您看到错误时，它应该告诉您*哪个任务*失败，以便您可以查找日志或运行`last <cmd that failed>`. 如果您`grep -R "MyException" target/streams`在项目目录中执行操作，它应该会找到正确的日志文件。

# html - REST 资源的规范 URL

> ID：11564409
> 
> 赞同：0
> 
> 时间：2012-07-19T15:42:12.583
> 
> 标签：html, web-services, http, rest

对于普通网页，如果您在两个位置有重复的内容，您可以将一个标记为“规范”，以便网络爬虫等知道这只是对资源的另一个引用，并明确定义了“真实”位置的 URL内容。这是通过在`<head>`指向原始页面的非规范页面的 HTML 标记中使用链接标记来完成的。

```
<link rel="canonical" href="http://www.example.com/the-real-url-of-this-content.php> 
```

在 RESTful Web 服务领域：

1.  是否需要、推荐或不建议这样做？
2.  Canonical 是否只是 HTML 的一种构造，用于为搜索引擎标记内容？
3.  如果需要，如何使用 HTTP 标头实现相同的功能？我没有返回 HTML（只是一个 JSON 对象），所以链接标签没有意​​义......
4.  REST 中的唯一资源是否有多个 URL 是否重要

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T17:18:58.603

[RFC 6596](https://www.rfc-editor.org/rfc/rfc6596)可能会回答这个问题。

1.  很难说。
2.  这是一个通用的链接关系，但它是由谷歌“发明”的。
3.  请参阅规范（您也可以使用 HTTP“链接”标头字段）。
4.  不，没关系；但是无论如何，避免为同一件事使用多个 URI 当然是一个好主意。

# load-balancing - 多个openx服务器单个数据库

> ID：11564410
> 
> 赞同：1
> 
> 时间：2012-07-19T15:42:16.127
> 
> 标签：load-balancing, openx

我能否以某种方式在亚马逊云上拥有多个 OpenX 服务器，在亚马逊 RDS 上拥有单个 MySQL。我想知道的主要事情是是否可以基于流量对 OpenX 服务器进行负载平衡？我可以将 MySQL 服务器与 OpenX 服务器分开吗？我不想复制 mysql 服务器，而只想要一个可以从多个 openx 服务器连接的 mysql 服务器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T12:01:35.647

来自 OpenX 文档：

> 分布式统计功能允许 OpenX 通过将部分负载从中央数据库转移到 Web 服务器来进行扩展。如果您将 OpenX 与一台 Web 服务器一起使用，它必须在一台机器上处理所有任务。使用多个 Web 服务器允许您拆分交付和管理/维护。当使用分布式统计时，交付网络服务器将原始数据（印象/点击等）记录到本地 MySQL 数据库中，并定期将其迁移到中央数据库中。MySQL 复制用于将数据从中央数据库复制到交付 Web 服务器。 [来源：OpenX 文档](http://www.openx.com/docs/2.8/adminguide/Distributed%20statistics)

这意味着，每台“交付”机器上都必须有本地 MySQL 数据库。这些主要用于处理插入。

对于问题的负载平衡部分，我问错人了，因为我只是一个产品经理，对我们在这里使用的 OpenX-Servers 有一些技术了解。

有关复制的更多信息，您可能需要[在 MySQL-Documentation 中阅读，该文档](http://dev.mysql.com/doc/refman/5.0/en/replication.html)链接自 OpenX-Docs。

ps.：对不起，如果这个答案不完全符合stackoverflow的标准，因为这是我的第一个答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T23:16:52.840

[OpenX 在http://www.openx.com/docs/2.8/adminguide/Types%20of%20installation](http://www.openx.com/docs/2.8/adminguide/Types%20of%20installation)为单服务器和多服务器（负载平衡）安装提供文档

您还可以在此处阅读有关提示和配置选项的信息[http://www.openxtips.com/tag/setup-configuration/page/2/](http://www.openxtips.com/tag/setup-configuration/page/2/)

注意：如果您使用负载平衡器，则可能不清楚将在哪个服务器上更改设置（设置文件位置）。更改设置以禁用除一台服务器以外的所有服务器上的管理员界面并使用仅指向具有管理员界面的服务器的不同域名时，这是明智的。例如：“ad.OpenX.com (192.168.1.0)”指向将请求转发到“adserver1.OpenX.com (192.168.1.1)”和“adserver2.OpenX.com (192.168.1.2)”的负载均衡器. “ad2.OpenX.com”的管理员界面已禁用，因此您必须使用“adserver1.OpenX.com”来管理库存或更改配置设置。

# jquery - 是否有任何带有折叠行的分页插件动态 html 表可用？

> ID：11564414
> 
> 赞同：1
> 
> 时间：2012-07-19T15:42:24.490
> 
> 标签：jquery, pagination, datatables, tablesorter

我正在使用带有折叠行的 html 表。这意味着每行将有 2 个或更多隐藏行，这些行会在单击按钮时显示。

我需要一个分页插件来仅处理可见行（按类名分页）。有没有一个插件。我看到“Tablesorter mod”和 Datatables 仅适用于静态表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T17:09:25.830

它不一定是“分页”插件。它更像是一个行为插件。您可以使用数据表[站点](http://datatables.net/release-datatables/examples/api/row_details.html)中的此示例，该示例显示如何显示隐藏详细信息。只需用一些 jQuery 为其添加香料，使其按您想要的方式工作。

# c# - 使用带多个点的参数配置映射

> ID：11564415
> 
> 赞同：0
> 
> 时间：2012-07-19T15:42:24.853
> 
> 标签：c#, service, nservicebus

`ConfigureHowToFindSaga()`在实现saga 编排服务类的方法时，我遇到了一个问题。

在这种方法中，我必须指定如何将收到的消息连接到当前的 saga 对话。我必须特别指定包含 saga id 的消息的属性。这个属性是这样的：`message.Sup.SubProperty`我不能这样做，因为 nservicebus 只获得`message`.

我不想更改我的 nservicebus 版本。

我怎么能弄明白？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-22T07:00:05.827

您有 2 个选项：

1.  创建一个消息处理程序，它发送一种新类型的消息，该消息具有您需要在更高级别定义的相关属性。

2.  通过实现 IFindSagas<T>.Using<M> 编写您自己的 saga 查找器。

我认为选项 1 更容易编码。您还可以将处理程序托管在与 saga 相同的端点中，然后执行 Bus.SendLocal ，这样它就不会以任何重大方式影响您的部署。

# java - Java 正则表达式匹配

> ID：11564417
> 
> 赞同：0
> 
> 时间：2012-07-19T15:42:28.493
> 
> 标签：java, regex

我有一种方法可以检查我的用户在评论文本字段中的输入。

```
public boolean isValidComment(String commentString) {
  String expression = "[a-zA-Z0-9_ ]+";
  CharSequence inputStr = commentString;
  Pattern pattern = Pattern.compile(expression, Pattern.CASE_INSENSITIVE);
  Matcher matcher = pattern.matcher(inputStr);
  return matcher.matches();
} 
```

这对我有用，但我需要改变我的模式。用户应该能够键入除以下字符之外的任何字符：`<> {} []`.

如何设置模式以允许除上述之外的所有内容？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T15:45:25.187

`[^characters to disallow]`.

`^`否定字符类，匹配除内部内容之外的任何内容。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-19T15:45:32.220

试试这个：

```
[^\<\>\{\}\[\]]+ 
```

另一方面，您需要使用一个常量`Pattern`来避免每次都重新编译表达式，如下所示：

```
private static final Pattern MY_PATTERN = 
                                     Pattern.compile("^[^\\<\\>\\{\\}\\[\\]]+$"); 
```

并使用常量：

```
return MY_PATTERN.matcher(commentString).matches(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T15:45:48.663

尚未对其进行测试，但格式为：字符串表达式 = `"[^\\\<\\\>\\\{\\\}\\\[\\\]]+"` ^ 符号适用于所有字符，但以下字符除外。

# php - 加密信用卡信息并将其存储在数据库中

> ID：11564422
> 
> 赞同：-1
> 
> 时间：2012-07-19T15:42:42.803
> 
> 标签：php, mysql, encryption, credit-card

> **可能重复：**
> [存储信用卡详细信息](https://stackoverflow.com/questions/206438/storing-credit-card-details)

我正在为具有注册系统的客户创建一个网站，用户将提供我读过的信用卡信息，以便网站管理员对其进行一次审查，然后将其删除，所以我想知道加密信用卡信息的最佳技术是什么

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T15:43:45.517

查看 PCI DSS 和 PA-DSS 要求。您将不得不处理很多密钥管理程序。这不仅仅是加密和存储 PAN。

查看 PCI DSS 所描述的“强加密”。

*   [https://www.pcisecuritystandards.org/pdfs/pci_fs_data_storage.pdf](https://www.pcisecuritystandards.org/pdfs/pci_fs_data_storage.pdf)
*   [https://www.pcisecuritystandards.org/security_standards/glossary.php](https://www.pcisecuritystandards.org/security_standards/glossary.php)

引文： *基于经过行业测试和接受的算法的密码学，以及强大的密钥长度和适当的密钥管理实践。密码学是一种保护数据的方法，包括加密（可逆）和散列（不可逆，或“单向”）。行业测试和接受的加密标准和算法示例包括 AES（128 位和更高）、TDES（最小双长度密钥）、RSA（1024 位和更高）、ECC（160 位和更高）和 ElGamal（1024位及更高）。有关详细信息，请参阅 NIST 特别出版物 800-57 (www.csrc.nist.gov/publications/)。*

# sql - 设计决策：部分日期的表架构以计算时间跨度（SQL Server）

> ID：11564431
> 
> 赞同：0
> 
> 时间：2012-07-19T15:43:15.823
> 
> 标签：sql, sql-server, database, database-design

我有一种情况，时间跨度将根据飞行员的出生日期计算。

飞行员必须在每 6 个月内获得如此多的时间。我很生气他们不都是1-6月和7-12月，但显然他们必须在出生日期之前做这种事情。

这是一个参考表：

![在此处输入图像描述](../Images/f16f852bde9a8d9f5ee219bbc41153e4.png)

现在，我需要能够根据每个飞行员的两个时段计算出每个飞行员的所有飞行小时数。例如，我的生日是 10 月 23 日。这意味着我的前 6 个月期间是 11 月 1 日到 4 月底（明年）。我正在寻找有关如何创建参考表的任何想法，以使我能够轻松（或尽可能轻松地）计算特定时间段的飞行小时数。

这是我到目前为止所得到的：

![在此处输入图像描述](../Images/d3eaa3605a316cdf34df4cba18db5afe.png)

其中birthMonth 和startYear 一起是一个复合主键。startYear 是期间开始的年份。

birthMonth 是 NVARCHAR(50)，startYear 是 Int，其余的是日期。

我的飞行员表将birthDate 作为完整日期，然后飞行经理将能够选择startYear。你怎么看？我应该将出生月份和年份合并到同一个字段中吗？我只是试图制作一个模式，以便轻松汇总特定飞行员半年和年度的飞行小时数。也许我可以将日期分解为不包括年份，然后动态添加？我只是觉得这个设计有我没有想到的缺陷。

编辑：这是我目前正在处理的所有表格： ![在此处输入图像描述](../Images/3897c2e20c914b5e0f2d37b1134f24d6.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T15:55:09.680

你真的需要一张桌子吗？

```
declare @birthday datetime = '2012-01-09'

SELECT  DATEADD(dd,-(DAY(DATEADD(m,1,@birthday))-1),DATEADD(m,1,@birthday)) firstSixMonthStart,
        DATEADD(dd, -DAY(DATEADD(m,1,@birthday)), DATEADD(m,7,@birthday)) firstSixMonthEnd,
        DATEADD(dd,-(DAY(DATEADD(m,1,@birthday))-1),DATEADD(m,7,@birthday)) secondSexMonthStart,
        DATEADD(dd, -DAY(DATEADD(m,1,@birthday)), DATEADD(m,13,@birthday)) secondSixMonthEnd

firstSixMonthStart      firstSixMonthEnd        secondSexMonthStart     secondSixMonthEnd
----------------------- ----------------------- ----------------------- -----------------------
2012-02-01 00:00:00.000 2012-07-31 00:00:00.000 2012-08-01 00:00:00.000 2013-01-31 00:00:00.000` 
```

# xml - 当自定义文件有“&”时，Wordpress RSS 提要不起作用

> ID：11564432
> 
> 赞同：0
> 
> 时间：2012-07-19T15:43:16.387
> 
> 标签：xml, wordpress, rss

当自定义文件有“&”时，WordPress RSS 提要不起作用。我认为这可能是带有字符“&”的 XML 错误。如何在 wp-php 代码或任何工作方式的自定义字段中将 & 更改为“&”？错误 ！！我正在使用以下代码

```
function customFieldFilter($id) {
$meta = get_post_meta($id);
foreach ($meta as $key => $value) {
   update_post_meta($id, $key, esc_attr($value));
} 
```

} add_action('pre_post_update', 'customFieldFilter');

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T08:50:40.690

当您保存自定义字段时，请尝试将其包装在`esc_html`WordPress 函数中。

我不确定您如何保存自定义字段，因为您没有提供任何代码，但对我来说，这将是以下内容：

```
$habitat = esc_html( $_POST["habitat"] );
update_post_meta( $post->ID, "habitat", $_POST["habitat"] ); 
```

**但是**，我真的很想看看您保存自定义字段的方式，因为我认为`esc_html`应该由`update_post_meta`函数运行？

* * *

**编辑**

尝试将此添加到您的主题`functions.php`（位于底部）：

```
function custom_field_filter( $id ) {
    $meta = get_post_custom( $id );
    foreach ( $meta as $key => $value )
        update_post_meta( $id, $key, esc_html( $value ) );
}

add_action('pre_post_update', 'custom_field_filter', 100); 
```

恐怕这纯粹是猜测，我真的找不到很多关于自定义字段的信息。这*应该*在保存时检索附加到帖子的所有自定义字段，并通过一个函数运行它们来编码希望修复您的 RSS 提要的`&`字符。`&amp;`

# php - 控制器中的错误 - Zend

> ID：11564434
> 
> 赞同：0
> 
> 时间：2012-07-19T15:43:21.160
> 
> 标签：php, zend-framework, controller

我正在开发一个小型应用程序，我的`controllers_viewpvcontroller`. 我正在尝试显示报告。用户可以决定年月，提交后，报表将显示在表单下的同一页面中。

这是我的控制器：

```
require_once ('library/Zend/Controller/Action.php');

class controllers_viewpvController extends Zend_Controller_Action {

public function init()
{

}

public function viewpvAction()
{
    require_once 'models/PastPV.php';

    $data = $this->getRequest()->getParams();
    $year = $data['year'];
    $month = $data['month'];
    $pv = new PastPV();
    $return = $pv->viewPV($year, $month); // this function is working fine.
    $this->view->assign('values',$return);

}

public function getpvAction()
{

}

} 
```

这是我的`viewpv.phtml`：

```
<body>

<h1 id="h2"> Review</h1>

<br><div><center><form action="../Viewpv/viewpv" method="post" >

<h3>Payment Vouchers for : <select name="month">
            <option value="null">(Month)</option>
    <option value="01">January</option>
    <option value="02">February</option>
    <option value="03">March</option>
    <option value="04">April</option>
    <option value="05">May</option>
    </select>

<select name="year">
<option value="null">(Year)</option>
<option value="2010">2010</option>
<option value="2011">2011</option>
<option value="2012">2012</option>                                                                              
</select></h3>
<br><br>
<input type="submit" value="View">

</form></center>
</div></body>

<!--the codes to display the form are below-->

<?php 
$return = $this->values;
if(!empty($return))
$tbl = '<table><tr><td>Document No</td></tr>';
while($data = $return->fetchRow()){       //here I think 'fetchRow()' may cause a problem.
                                              //but that is not my question.
$tbl.='<tr><td>'.$data['docNo'].'</td></tr>';
}
$tbl.='</table>';
echo $tbl;
?> 
```

当我尝试加载页面时，它给出了以下 php 错误：

```
Undefined index: year
Undefined index: month 
```

此外，它给出了 Zend_Db_Statement_Exception, `No parameters were bound`。我的感觉是，我还没有找到正确的方法来做到这一点。

请帮我解决一下这个。如果有更好的方法来实现这一点，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T18:12:09.717

如果表单与要显示的报告在同一页面上，则需要检查 POST 数据。您可以通过使用 Zend 中的请求对象来做到这一点。

```
if($this->getRequest()->isPost())
{
  //Process the form and get things you need to display the report
} 
```

目前，如果您像听起来那样直接进入该页面，那么您正在尝试查找尚未提交回操作的索引。

所以这将失败导致您的错误：

```
$year = $data['year'];
$month = $data['month']; 
```

然后您正在对该信息进行数据库查找，从而导致数据库错误。如果您添加我列出的“if”语句，您应该没问题。

您应该阅读[Zend Form](http://framework.zend.com/manual/en/zend.form.html/)和[The Request Object](http://framework.zend.com/manual/en/zend.controller.request.html)的 Zend 文档。Zend Form 可以让您的生活变得如此轻松。仅在视图中“显示”事物也是一种很好的做法。不鼓励在视图中进行数据库查找。

# google-data-api - Google Apps：以管理员身份访问域用户的联系人

> ID：11564437
> 
> 赞同：2
> 
> 时间：2012-07-19T15:43:32.943
> 
> 标签：google-data-api, google-contacts-api

作为 Google Apps 管理员，我想将特定联系人添加到我所有用户的通讯录中。

我应该查看哪个 API？据我了解，联系人 API 要求用户以我要修改的通讯簿的用户身份登录。就我而言，我只能以管理员身份登录。我还可以传递管理员的凭据（就像所有供应 API 的情况一样）。

如果可能的话，我更喜欢使用 .Net 库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T14:31:31.257

如果您想将它们添加到所有域共享，您可以使用此应用程序： [http](http://code.google.com/p/google-shared-contacts-client/) ://code.google.com/p/google-shared-contacts-client/ 它将联系人从 CSV 导入共享联系人（它需要 24 小时）。

或者您可以创建自己的应用程序，我个人制作了 2 个程序并用于 python 和其他 php（虽然谷歌不为 php 提供 gdata 库，但您可以[从 Zend 找到一个](http://framework.zend.com/download/gdata/)）。

如果您想将它们添加到您需要编写自己的代码的特定用户，我知道没有应用程序，并使用 Oauth 2.0 登录代表他们登录（只要您是该谷歌域的管理员）以使用API 以他们的名义。就我个人而言，我没有处理这个问题，[但收到了一个可能的答案](https://groups.google.com/forum/#!topic/google-contacts-api/1_KHoy37dQo%5B1-25%5D)）。使用他们的姓名和密码进行连接只是一种称为 clientlogin 的身份验证类型，但您还可以通过其他方式代表他们进行连接。

# javascript - Rails 结构到 JSON 对象

> ID：11564439
> 
> 赞同：0
> 
> 时间：2012-07-19T15:43:34.643
> 
> 标签：javascript, ruby-on-rails-3, json

我已经创建了一个基于简单结构的自定义类，我需要将它取回 JSON：

```
 class ItemTag <
      Struct.new(:id, :item_id, :type, :subtype, :top, :left, :height, :width, :name, :alternate, :photo_url, :price, :quantity, :comment, :memo)
      def to_map
        map = Hash.new
        self.members.each { |m| map[m] = self[m] }
        map
      end

      def to_json(*a)
        to_map.to_json(*a)
      end
    end 
```

在我的控制器中，我正在收集这些数据，如下所示：

```
@tags = design.item_links.all.map{ |pi| ItemTag.new(pi.id,pi.item_id,pi.item.type,pi.item.subtype,pi.top,pi.left,pi.height,pi.width,pi.item.name,pi.item.alternate_name,pi.item.logo_photo(:thumb),pi.price,pi.quantity,pi.public_note,pi.private_note)} 
```

最后，在我看来，我需要将此数据作为 json 字符串传递给 javascript 函数，所以我这样做：

```
<%= raw(@tags.to_json) %> 
```

我得到的输出看起来像这样：

```
[[\"1b245b45\",\"444dc0e6\",\"plant\",\"cactus\",94,661,110,174,\"Blue mistflower\",\"conoclinium coelestinum\",\" \",56.0,4,\"test\",\"test\"],[\"21e8db0c\",\"3097c392\",\"plant\",\"bamboo\",128,108,161,100,\"Green and gold\",\"chrysogonum virginianum\",\" \",76.0,5,\"this is very green\",\"dont tell them it has gold\"]] 
```

如果我将 to_json 放在控制器的地图操作中，它会为每条记录生成有效的 json，但它不会给我所有对象的数组作为 JSON。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T18:14:56.547

我认为这可能有效：

```
def as_json(*a)
  to_map
end 
```

ruby 中的 as_json 方法类似于 JavaScript 中的 to_json 函数。它返回准备被序列化的数据，而不是序列化的数据。

# java - 如何将列表视图放在android中的片段内？

> ID：11564447
> 
> 赞同：1
> 
> 时间：2012-07-19T15:44:07.620
> 
> 标签：java, android, listview, fragment

我正在尝试在我的片段中放置一个简单的列表视图。当我按原样运行它时出现错误。我没想到它可以与我拥有的当前代码一起使用，但我不确定从这里去哪里。任何帮助将不胜感激！

我的代码：

```
public class Tab1Fragment extends ListFragment {

ListView listView;

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {

    LinearLayout theLayout = (LinearLayout) inflater.inflate(R.layout.tab1, container, false);
    listView = (ListView)theLayout.findViewById(R.id.ListView01);
    return theLayout;
}

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    // Use an existing ListAdapter that will map an array
    // of strings to TextViews
    setListAdapter(new ArrayAdapter<String>(getActivity().getApplicationContext(),
            android.R.layout.simple_list_item_1, mStrings));
    getListView().setTextFilterEnabled(true);
}

private String[] mStrings = {
        "Action", "Adventure", "Animation", "Children", "Comedy", "Documentary", "Drama",
        "Foreign", "History", "Independent", "Romance", "Sci-Fi", "Television", "Thriller"
    }; 
```

}

我的运行时错误：

```
07-19 11:42:45.214: E/AndroidRuntime(19873): FATAL EXCEPTION: main
07-19 11:42:45.214: E/AndroidRuntime(19873): java.lang.RuntimeException: Unable to start activity ComponentInfo{package/package.TabActionBarActivity}: java.lang.IllegalStateException: Content view not yet created
07-19 11:42:45.214: E/AndroidRuntime(19873):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1956)
07-19 11:42:45.214: E/AndroidRuntime(19873):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
07-19 11:42:45.214: E/AndroidRuntime(19873):    at android.app.ActivityThread.access$600(ActivityThread.java:123)
07-19 11:42:45.214: E/AndroidRuntime(19873):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-19T15:51:52.510

您应该尝试调用`setListAdapter()`该`onActivityCreated()`方法。这是因为 Activity 并没有完全由`onCreate()`Fragment 的方法创建，因为它们的生命周期略有不同。

这是一个类似的问题：[Android Fragment onCreateView vs. onActivityCreated](https://stackoverflow.com/questions/8041206/android-fragment-oncreateview-vs-onactivitycreated)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-19T15:52:06.967

您的片段中有几个问题：

1.  如果您使用 ListFragment，那么在您的 XML 布局中，您必须有一个 ID 为“android.R.id.list”的 ListView。
2.  在 onViewCreated() 而不是 onCreate() 中调用 setListAdapter() 方法。这是因为 onCreate() 在 onCreateView() 之前首先被调用。

# html - 从网络协议加载程序

> ID：11564452
> 
> 赞同：0
> 
> 时间：2012-07-19T15:44:33.497
> 
> 标签：html, protocols, href

> **可能重复：**
> [Windows 的 URL 方案（协议处理程序）编程？](https://stackoverflow.com/questions/5287879/url-schemes-protocol-handler-programming-for-windows)

假设我制作了一个程序，我想从网络浏览器中访问它。

假设我有一个网站。在我的网站上，我放了一个

```
<a href="myProgram://someParameter">Click here to open my program using this parameters</a> 
```

我知道这是可能的，因为我看到其他工具在使用它。*这个*有具体的名字吗？

我的程序需要“知道”如何处理这个传入的参数？我该怎么办？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-07-22T01:37:48.423

我相信你在说的是一个磁力链接。许多洪流网站使用它们来开始下载。

# apache - .htaccess 导致 500 个内部服务器错误

> ID：11564458
> 
> 赞同：0
> 
> 时间：2012-07-19T15:44:41.923
> 
> 标签：apache, .htaccess

我想保护`uploads`位于 wordpress 中我的文件夹中的一个目录`http://site.com/wp-content/uploads/assets`，因此我尝试使用以下代码向该文件夹`.htaccess`添加一个目录：`assets`

```
Options All -Indexes
<FilesMatch ".(htaccess|mustache)$">
Order Allow,Deny
Deny from all
</FilesMatch> 
```

我的`assets`文件夹也包含子文件夹，其中包括 css 和图像文件。我试图限制浏览目录和直接访问我的`.mustache`模板文件的访问。

但是，CSS 不会加载，在我的页面上尝试链接到它时会产生 500 错误。

示例结构：

```
/assets
    template.mustache
    image.jpg
    file.php

    media/
        style.css
        script.js 
```

谁能看到我做错了什么？

谢谢！

# oracle - 在删除语句中使用 rowid

> ID：11564459
> 
> 赞同：5
> 
> 时间：2012-07-19T15:44:42.273
> 
> 标签：oracle, sql-delete

使用 rowid 删除是否有任何严重的禁忌症？

```
DELETE FROM NETATEMP.SFAC_TESTATA_CASISTICHE
      WHERE ROWID IN (  SELECT MIN (ROWID)
                          FROM NETATEMP.SFAC_TESTATA_CASISTICHE
                      GROUP BY ID_CASO,
                               DESCRIZIONE_TECNICA,
                               DESCRIZIONE_ANALISI,
                               PDF,
                               SCARTI,
                               DATA_INIZIO_ANALISI,
                               DATA_FINE_ANALISI,
                               DATA_INSTRADAMENTO,
                               DATA_RISOLUZIONE,
                               STRINGA_RICERCA,
                               SETTIMANA,
                               DATA_INIZIO_SETT,
                               DATA_FINE_SETT,
                               FATTURAZIONE,
                               IN_ELABORAZIONE
                        HAVING COUNT (1) > 1); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-19T16:53:28.170

如果您假设`min(rowid)`返回“最早”行，那么是的，您有问题（因为它不会）

如果您`min(rowid)`仅用于获取其中一个重复项（并且您不在乎哪个），那么不，该语句没有任何问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T16:48:53.050

有几点需要注意。似乎您依赖于 rowid 为您的特定分组提供最早的行（选择 min(rowid) ...）。这并不总是正确的。保证您删除最早记录的唯一方法是使用您可以订购的某些列（如时间戳）。 [汤姆凯特比我解释](http://asktom.oracle.com/pls/asktom/f?p=100:11:0%3a%3a%3a%3aP11_QUESTION_ID:912210644860)得更好。

> rowid 意味着除了行的物理位置之外什么都没有。它并不意味着年龄、插入顺序或类似的东西。

此外，根据表的大小，您将生成大量重做/撤消，并且在大型表中使用 pl/sql 以块删除并每 x 行提交一次可能是有益的。

只是我的想法

# xtend - Xtend 提示：如何访问 Java 接口内部类中的静态方法？

> ID：11564467
> 
> 赞同：2
> 
> 时间：2012-07-19T15:45:17.963
> 
> 标签：xtend

```
// java
interface MyInterface { 
    class MyInnerClass {            
        public static final String myInnerStaticMethod() {
            return "myInnerStaticMethod";
        }       
    }
} 
```

如何从 Xtend 方法调用它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T15:45:17.963

```
// xtend
def test() {
    MyInterface$MyInnerClass::myInnerStaticMethod
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-11-06T18:33:11.827

实际上，最新版本的 Xtend (>2.4.1) 使用了更好的语法。

```
// xtend
def test() {
  MyInterface.MyInnerClass.myInnerStaticMethod
} 
```

# c# - 如何在实体框架中仅加载基类型

> ID：11564469
> 
> 赞同：5
> 
> 时间：2012-07-19T15:45:19.307
> 
> 标签：c#, entity-framework, entity-framework-4, entity-framework-4.1

考虑以下情况：

我有另外两个继承的基类。例如，我们将有：

```
class Base
{

}
class DerivedA : Base
{

}
class DerivedB : Base
{

} 
```

当我使用类似代码请求基本实体时

context.Base.Where(q => q.Id == id).First();

实体框架为每个派生实体生成一整套连接，导致查询性能低于可接受的水平。我**想要的是仅加载基本实体**而不将其加入派生实体。

我在这里找到的唯一解决方案[http://blogs.msdn.com/b/alexj/archive/2009/09/17/tip-35-how-to-write-oftypeonly-tentity.aspx](http://blogs.msdn.com/b/alexj/archive/2009/09/17/tip-35-how-to-write-oftypeonly-tentity.aspx)。但这对我不起作用。EF 仍然会生成大量查询。

编写查询，例如：

```
context.Base.Where(q => !(q is DerivedA) && !(q is DerivedB)).First(); 
```

**由于派生类型的数量不断增加，**也不适合我。****

 **除了我提到的之外，还有其他可能的解决方案吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T16:14:22.947

您正在使用 Table-per-type => EF 必须生成这些连接，因为它不知道您的实体到底是什么类型。如果您的记录在表`Base`中有相关​​记录，则**它不能**为该记录创建实体实例-**它必须**创建实例，并且它需要进行连接以获取此知识。`DerivedA`**`Base`**`DerivedA`****

 ****长时间讨论为什么不允许这样做，而只是实体来自对象世界-它是原子数据结构，可以保存到多个表中，但对对象世界不可见。如果您坚持 a `Base`，您将加载回 a `Base`，但如果您坚持`DerivedA`，您将始终加载回来`DerivedA`，而不仅仅是`Base`因为它会破坏实体的原子性。

我没有尝试过，但我认为 ESQL`OFTYPE ONLY`运算符也应该进行连接，以确保它确实加载了基础实体的真实实例，而不是派生实体的损坏实例。

Table-per-type 会产生缓慢的查询。.NET 4.5 应该改进它，但我认为改进不会针对这些情况 - 我认为它们将`OfType`针对派生类型和投影。

如果您只需要`Base`表格中的数据，您最好的选择是：

*   手写 SQL - [.NET 4.0 中的投影仍然会做一些不必要](http://blogs.msdn.com/b/adonet/archive/2010/08/17/performance-considerations-when-using-tpt-table-per-type-inheritance-in-the-entity-framework.aspx)的连接或联合
*   .NET 4.5 和 Linq 中的投影

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-29T15:08:32.593

您可以引入一个没有进一步含义/功能的抽象中间类，所有派生类型都必须从中派生：

```
class Base
{

}
abstract class DerivedBase : Base
{

}
class DerivedA : DerivedBase 
{

}
class DerivedB : DerivedBase 
{

} 
```

然后你可以做一个简单的查询，不管有多少派生类存在：

```
context.Bases
  .Where(b => !(b is DerivedBase))
  ... 
```******

# android - android中的布局设置

> ID：11564481
> 
> 赞同：0
> 
> 时间：2012-07-19T15:45:42.837
> 
> 标签：android, android-layout

我有以下结构：

```
<LinearLayout
    android:id="@+id/linearLayout5"
    android:layout_width="match_parent"
    android:layout_height="0dip"
    android:background="@drawable/framewhite"
    android:orientation="vertical" 
    android:layout_marginLeft="5dp"
    android:layout_marginRight="5dp"
    android:layout_weight="1"
    android:gravity="right"
    >

    <ScrollView
        android:layout_width="match_parent"
        android:layout_height="120dp"
        android:layout_marginTop="20dp"
        android:layout_marginLeft="20dp"
        android:layout_marginRight="20dp"
        >

       <TextView
            android:id="@+id/txtBestPickTrivia"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="@string/testTrivia"
            android:textAppearance="?android:attr/textAppearanceMedium" />

    </ScrollView>

    <TextView
        android:id="@+id/txtEntityName"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginTop="2dp"
        android:layout_marginBottom="10dp"
        android:layout_marginRight="20dp"
        android:text="Cars (2006)" />

</LinearLayout> 
```

问题出现在 ScrollView 的这一行：

**android:layout_height="120dp"**

我希望根据屏幕分辨率调整高度，我使用**3.7 英寸 WVGA（Nexus One）**设计它，它在我的 HTC Desire 中运行良好，但是当我使用 HTC Explorer 测试我的应用程序时，它使用**3.2 HVGA**它没有'不起作用，ScrollView 跨越了屏幕边界，我看不到我的 TextView 即 txtEntityName。

还有一件事，有什么方法可以像在 .NET 中一样停靠任何控件，其中控件可以停靠在顶部、底部、右侧或左侧？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:39:08.373

试试这个代码

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/linearLayout5"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_marginLeft="5dp"
    android:layout_marginRight="5dp"
    android:background="@drawable/framewhite"
    android:orientation="vertical" 
    android:gravity="right">

<ScrollView
        android:layout_width="match_parent"
        android:layout_height="0dip"
        android:layout_marginLeft="20dp"
        android:layout_marginRight="20dp"
        android:layout_marginTop="20dp"
        android:layout_weight="1" >

        <TextView
            android:id="@+id/txtBestPickTrivia"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:background="@drawable/framewhite"
            android:textAppearance="?android:attr/textAppearanceMedium" />
    </ScrollView>

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:gravity="right" >

        <TextView
            android:id="@+id/txtEntityName"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginBottom="10dp"
            android:layout_marginRight="20dp"
            android:layout_marginTop="2dp"
            android:text="Cars (2006)" />
    </LinearLayout>

</LinearLayout> 
```

它必须适用于所有 android 屏幕尺寸

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T15:48:56.717

关于屏幕问题，请查看[http://developer.android.com/guide/practices/screens_support.html](http://developer.android.com/guide/practices/screens_support.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T15:49:34.733

至于“对接”，可以使用`android:gravity`和/或绝对对齐属性（即alignParentTop）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T15:52:15.277

您应该使用 RelativeLayout 而不是 LinearLayout 并将 txtEntityName 与底部对齐，将 ScrollView 与父对象的顶部对齐，并将其底部与 txtEntityName 的顶部对齐。设置 ScrollView 的 layout_height 为 0dp

# entity-framework - 实体框架代码优先的性能

> ID：11564482
> 
> 赞同：3
> 
> 时间：2012-07-19T15:45:44.950
> 
> 标签：entity-framework, c#-4.0, orm, ef-code-first, edmx

EF（实体框架）存在性能问题。调用 EF 的第一个屏幕比第二个屏幕需要更多时间来打开。如果第二个屏幕与第一个屏幕相同或完全不同，则加载时间没有差异；所有其他屏幕都会很快。

我们使用 Code First API 创建 EF 的“数据库优先”版本。为此，我们使用 T4 模板从数据库表中生成实体类。一个类是由表创建的。它们在“OnModelCreating()”中映射我们决定采用这种方式，因为我们需要将我们的实体分成三个不同的层（命名空间和程序集）：

1.  通用框架
2.  项目框架
3.  项目部门

这些层中的每一层的实体都需要链接到前一层中的其他实体。我们尝试使用 edmx 文件，但没有找到如何将实体放在同一个 edmx 中的不同命名空间中。

我们还生成链接到实体类的其他类。目前，通过我们的 T4 模板，我们生成了额外的类，程序员可以使用这些类来扩展实体属性或添加验证。

生成的实体是 T4 模板使用每个表列的属性创建的类。实体是一个扩展生成的类的类，程序员可以在其中添加代码。这是映射到表的类。当修改其他类或将数据保存到数据库时，将调用验证器类。我们需要找到一种方法来先使用代码预先生成我们的视图，或者使用 edmx 让代码先具有相同的灵活性。

例子：

ParameterBase.Generated.cs

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.ComponentModel.DataAnnotations;
using System.Xml.Linq;
using Keops.Common.Data;
using Keops.Common.Validation;
using Keops.Common.Validators.Framework;

namespace Keops.Common.Entities.Framework
{
    public abstract class ParameterBase
        : EntityBase
        , IHaveAValidator
        , IDatabaseOriginAware
    {
        protected ParameterBase()
        {
            ParameterValueList = new HashSet<ParameterValue>();
            Validator = new ParameterValidator((Parameter)this);
        }

        #region Database columns

        public string Code
        {
            get { return _code; }
            set
            {
                if (_code != value)
                {
                    _code = value;
                    RaisePropertyChanged("Code");
                }
            }
        }
        private string _code;

        public bool IsEditable
        {
            get { return _isEditable; }
            set
            {
                if (_isEditable != value)
                {
                    _isEditable = value;
                    RaisePropertyChanged("IsEditable");
                }
            }
        }
        private bool _isEditable;

        public bool IsVisible
        {
            get { return _isVisible; }
            set
            {
                if (_isVisible != value)
                {
                    _isVisible = value;
                    RaisePropertyChanged("IsVisible");
                }
            }
        }
        private bool _isVisible;

        public int ParameterID
        {
            get { return _parameterID; }
            set
            {
                if (_parameterID != value)
                {
                    _parameterID = value;
                    RaisePropertyChanged("ParameterID");
                }
            }
        }
        private int _parameterID;

        public int ValueTypeID
        {
            get { return _valueTypeID; }
            set
            {
                if (_valueTypeID != value)
                {
                    _valueTypeID = value;
                    RaisePropertyChanged("ValueTypeID");
                }
            }
        }
        private int _valueTypeID;

        public string Name
        {
            get { return _name; }
            set
            {
                if (_name!= value)
                {
                    _ name = value;
                    RaisePropertyChanged("Name ");
                }
            }
        }
        private string _ name;

        #endregion Database columns

        #region Navigation parents

        [ForeignKey("ValueTypeID")]
        public ValueType ValueType
        {
            get { return _valueType; }
            set
            {
                if (_valueType != value)
                {
                    _valueType = value;
                    ValueTypeID = value == null
                        ? 0
                        : value.ValueTypeID;
                    RaisePropertyChanged("ValueType");
                }
            }
        }
        private ValueType _valueType;

        #endregion Navigation parents

        #region Navigation children

        public virtual ICollection<ParameterValue> ParameterValueList { get; set; }

        #endregion Navigation children

        #region IHaveAValidator

        public ValidatorBase<Parameter> Validator { get; private set; }

        IValidator IHaveAValidator.Validator
        {
            get { return Validator; }
        }

        #endregion

        #region IDatabaseOriginAware

        public bool IsFromDatabase { get; set; }

        string IDatabaseOriginAware.FullTableName { get { return "Framework.Parameter"; } }       

        #endregion
    }
} 
```

参数.cs

```
namespace Keops.Common.Entities.Framework
{
    public class Parameter : Parameter Base
    {
        //Add custom methods here
    }
} 
```

ParameterValidatorBase.Generated.cs

```
using System;
using System.Data.Entity;
using System.Linq.Expressions;
using Keops.Common.Entities.System;
using Keops.Common.Validation;

namespace Keops.Common.Validators.System
{
    public abstract class ParameterValidatorBase : ValidatorBase<Parameter>
    {
        private readonly Parameter _entity;

        protected ParameterValidatorBase(Parameter entity)
            : base(entity)
        {
            _entity = entity;
        }

        protected ParameterEntity { get { return _entity; } }
    }
} 
```

参数验证器.cs

```
using Keops.Common.Entities.System;

namespace Keops.Common.Validators.System
{
    public class ParameterValidator : ParameterValidatorBase
    {
        internal ParameterValidator(Parameter entity)
            : base(entity)
        {
        }

        //Define custom rules here
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T16:18:15.750

经过更多研究，我们发现了 Pawel Kadluczka 的一篇博文：

[Visual Studio 代码库上的实体框架代码优先视图生成模板](http://blog.3d-logic.com/2012/06/13/entity-framework-codefirst-view-generation-templates-on-visual-studio-code-gallery/)

他创建了一个[T4 模板](http://visualstudiogallery.msdn.microsoft.com/ae7730ce-ddab-470f-8456-1b313cd2c44d)，可用于从 Code First 生成视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T15:50:54.980

解决此问题的最简单方法是在 ApplicationStart 上设置对数据库的调用。

因此，查看的第一个“屏幕”将生成第二个调用。

第一次使用 ORM 需要一些时间来初始化是很正常的。

# silverlight - 如何在 Silverlight 中更改帧源

> ID：11564483
> 
> 赞同：0
> 
> 时间：2012-07-19T15:45:44.920
> 
> 标签：silverlight, silverlight-4.0, navigation, frame, silverlight-5.0

我有一个这样定义的 xaml 文件：

```
<UserControl
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
.....
mc:Ignorable="d"
d:DesignHeight="500" d:DesignWidth="800">

<sdk:Frame x:Name="ContentFrame" Source="/MainPageContent.xaml">

</sdk:Frame>
</UserControl> 
```

页面的全部内容存储在 MainPageContent 中。我制作了另一个文件，例如 PageTwoContent.xaml。我如何将 Frame 的源更改为新的 xaml 文件，例如通过按钮？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T16:22:52.020

xaml 页面应该有一些类似的内容

```
<Button>
 ...
 Click="ClickEvent"
</Button> 
```

在代码隐藏中，您将拥有如下内容：

```
private void ClickEvent(object sender, EventArgs e)
{
    //do any other event stuff here
    this.ContentFrame.Source = new Uri("/PageTwoContent.xaml", UriKind.Relative);
} 
```

我在这个工作中遇到了一些问题，所以有时你也可以在 ContentPane 上调用 Refresh() 来强制它从框架的源刷新内容。

# c# - 如何将 WPF UserControl 挂钩到绑定 ViewModel 对象的事件？

> ID：11564491
> 
> 赞同：0
> 
> 时间：2012-07-19T15:45:52.347
> 
> 标签：c#, wpf, mvvm

假设我有一个`UserControl`与 a`DependencyProperty`绑定到一个`ObservableCollection<Foo>`对象。对象集合`Foo`实际上是发送到某个 Flash ActiveX 对象。因此，我不能“WPF 绑定”到 Foo 对象的属性。

当 Foo 对象的属性由 UserControl 以外的其他对象更新时，我希望通知 UserControl 以便它刷新（即将所有 Foo 对象重新发送到 Flash 对象）。

我不太确定如何处理这个问题。我可以想到两种不太明显的可能性：

1.  UserControl 订阅包含该`ObservableCollection<Foo>`对象的对象的某些事件。每当 Foo 对象的属性发生更改时，该事件就会触发，因此 UserControl 会知道将 Foo 对象重新发送到 Flash 对象。

2.  让 UserControl 订阅`CollectionChanged`ObservableCOllection 对象的事件，以某种方式导致`ObservableCOllection<Foo>`对象引发事件`Action` `NotifyCollectionChangedAction.Reset`。

    ```
    void OnFooCollectionChanged(object sender, NotifyCollectionChangedEventArgs e)
    {
        if (!_flashIsLoaded)
            return;

        if (e.Action == NotifyCollectionChangedAction.Reset) {
            ClearAndSendFoos(this, Foos);
            return;
        }
        .... 
    ```

知道如何完成上述两项工作，或者如何让 UserControl 知道是时候刷新集合了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T16:49:42.360

您应该考虑拥有多个 ViewModel。

如果您对 ViewModel 中的某个项目发生的更改感兴趣，请为这些项目创建一个 ViewModel 并将 ViewModel 集合更改为`ObservableCollection<ItemViewModel>`.

这样，您可以绑定到您真正感兴趣的属性。

让我们举个例子：

```
// the overall viewModel:
public class OverallViewModel : ViewModelBase
{
    public ObservableCollection<ProductViewModel> Products { get; set; };
}

// the item viewmodel:
public class ProductViewModel : ViewModelBase
{
    public string ProductName { get; set; }
    public int CountOfSold { get; set; }
} 
```

所以，你卖了 5 个香蕉。Banana 的销售数量发生了变化。由于您直接绑定到项目，因此不再需要额外的事件，视图（在您的情况下为用户控件）可以更新，而无需监听人工收集事件。

我对 Flash 知之甚少，但也许在您的用户控件中拥有一个托管 Flash 的转换器会有所帮助。至少您不必爬取所有列表，而只需爬取单个项目。

希望这可以帮助你

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T16:26:16.317

这里似乎有些不对劲。你用 MVVM 标记了这篇文章，所以我想你正在使用它。

看，使用 Model、View、ViewModel，您应该在 ViewModel 和 Model 之间完成这项工作。因此 ViewModel 将订阅模型的事件并进行更新。如果 Model 没有这样的事件，那么继承它并添加它。然后因为 ViewModel 实现了 INotifyPropertyChanged 并且因为它使用了 ObservableCollection，所以 View 已经更新了。

获取 ViewModel 的 ObservableCollection 进行更改，您不必让 UserControl 订阅任何事件。

视图应该只显示 ViewModel 更新。

# javascript - 如何检测 jQuery 触发事件完成？

> ID：11564494
> 
> 赞同：9
> 
> 时间：2012-07-19T15:46:15.947
> 
> 标签：javascript, jquery, jquery-events

我正在尝试触发依赖于第一个事件的第二个事件，如下所示：

```
...
$('#productFamilyId').val(data.contents.productfamily);
$('#productFamilyId').trigger('change', function() {
    $('#productId').val(data.contents.product);
    $('#productId').trigger('change');
}); 
```

在尝试触发第二个事件之前，它不会等待第一个触发器完成。是否可以等待第一个触发器完成？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T15:49:00.567

可能你想要这个：

```
$('#productFamilyId').trigger('change', function() {
   $('#productId').val(data.contents.product);
   setTimeout(function(){ 
      $('#productId').trigger('change'); 
   },1);
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T15:50:04.843

您可以使用 javascripts setTimeout() 函数，以便该函数将在一段时间后执行。

```
$('#productFamilyId').val(data.contents.productfamily);
$('#productFamilyId').trigger('change', function() {
setTimeout( function(){       
$('#productId').val(data.contents.product);
    $('#productId').trigger('change');
},100);
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-06-09T14:44:38.140

如果您的事件处理程序**不执行异步调用**，则触发的事件将执行并完成，然后才会转到下一行。[提琴手](https://jsfiddle.net/047ms920/)

```
$('#productFamilyId').val(data.contents.productfamily);
$('#productFamilyId').trigger('change');
// Execute after change complete
$('#productId').val(data.contents.product);
$('#productId').trigger('change'); 
```

**通过事件处理程序中的异步调用**（setTimeOut、Ajax 等），您可以执行以下操作：[JsFiddle](https://jsfiddle.net/y7qtsuoq/)

在事件处理程序中添加回调函数作为参数：

```
$("#productFamilyId").change(function(e, callback) {
    // Simulating ajax
    setTimeout(function() {
        if (typeof callback === "function")
            callback();
    }, 3000);
}); 
```

并像这样触发：

```
$('#productFamilyId').trigger('change', function() {
    $('#productId').val(data.contents.product);
    $('#productId').trigger('change');
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-19T16:02:02.443

触发方法没有回调。额外的参数就是 - 参数。

[http://api.jquery.com/trigger/](http://api.jquery.com/trigger/)

您实际上正在做的是在第二个函数中运行代码，然后将结果作为参数传递给触发器调用的事件处理程序。如果您希望它们按顺序运行，则需要在第一个事件的事件处理程序中触发第二个事件。

# javascript - 冲突的脚本 #selector 标签

> ID：11564501
> 
> 赞同：0
> 
> 时间：2012-07-19T15:46:58.027
> 
> 标签：javascript, jquery

我有两个脚本。一种是使用 滚动到页面的特定部分，`#idname`另一种是交换内容，也使用`#idname`。

所有 id 都是唯一的，它们位于不同的容器 div 中，但是当我单击交换内容之一时，也会触发滚动脚本。

这是两个冲突的脚本：

滚动脚本：

```
(function ($) {
    var l = location.href.replace(/#.*/, '');
    var g = $.localScroll = function (a) {
            $('body').localScroll(a)
        };
    g.defaults = {
        duration: 1e3,
        axis: 'y',
        event: 'click',
        stop: true,
        target: window,
        reset: true
    };
    g.hash = function (a) {
        if (location.hash) {
            a = $.extend({}, g.defaults, a);
            a.hash = false;
            if (a.reset) {
                var e = a.duration;
                delete a.duration;
                $(a.target).scrollTo(0, a);
                a.duration = e
            }
            i(0, location, a)
        }
    };
    $.fn.localScroll = function (b) {
        b = $.extend({}, g.defaults, b);
        return b.lazy ? this.bind(b.event, function (a) {
            var e = $([a.target, a.target.parentNode]).filter(d)[0];
            if (e) i(a, e, b)
        }) : this.find('a,area').filter(d).bind(b.event, function (a) {
            i(a, this, b)
        }).end().end();

        function d() {
            return !!this.href && !! this.hash && this.href.replace(this.hash, '') == l && (!b.filter || $(this).is(b.filter))
        }
    };

    function i(a, e, b) {
        var d = e.hash.slice(1),
            f = document.getElementById(d) || document.getElementsByName(d)[0];
        if (!f) return;
        if (a) a.preventDefault();
        var h = $(b.target);
        if (b.lock && h.is(':animated') || b.onBefore && b.onBefore.call(b, a, f, h) === false) return;
        if (b.stop) h.stop(true);
        if (b.hash) {
            var j = f.id == d ? 'id' : 'name',
                k = $('<a> </a>').attr(j, d).css({
                    position: 'absolute',
                    top: $(window).scrollTop(),
                    left: $(window).scrollLeft()
                });
            f[j] = '';
            $('body').prepend(k);
            location = e.hash;
            k.remove();
            f[j] = d
        }
        h.scrollTo(f, b).trigger('notify.serialScroll', [f])
    }
})(jQuery); 
```

内容衰减：

```
$(window).load(function() {
    (function($) {
        $.fn.Fader = function() {
            this.each(function() {
                $('a').bind('click', function(e) {
                    e.preventDefault();
                    $("#mediaswap div").fadeOut();
                    $("#mediaswap div" + $(this).attr('href')).fadeIn();
                })
            });
        }
    })(jQuery);
    $(function() {
        $('#mediaswap').Fader();
    });
}); 
```

我需要在脚本 2（内容淡化）上进行哪些更改，以免它们发生冲突？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T16:08:11.890

我似乎找到了解决方案，购买更改

```
$(this).attr('href')).fadeIn(); 
```

至

```
$(this).attr('name')).fadeIn(); 
```

# java - Java SWT 从按钮刷新多个外壳

> ID：11564503
> 
> 赞同：1
> 
> 时间：2012-07-19T15:47:00.130
> 
> 标签：java, swt

我正在构建一个访问数据库的应用程序，目前我有一个显示主表的 SWT Shell。用户可以从该表打开单个记录，从记录表单内部，用户可以打开第二个相同类型但包含不同数据的表单。如果任一表单中的记录被更新，则更新将反映在主表单中。我的问题是我无法更新打开的第一个记录表单。有没有办法强制更新或重绘某种类型的所有打开表单，或者有没有办法可以同时更新多个相同类型的 shell。下面的屏幕截图显示了我正在尝试做的事情。

![在此处输入图像描述](../Images/26ead594d004dd123f608d8bbbebd686.png)

截图详情

*   一种

*   主表格
*   当前，当 2 个辅助表单中的任何一个更改数据库中的数据时，此表单会更新。这是通过从辅助表单重新加载表来完成的

*   乙

*   这是数据表单的第一个实例

*   C

*   这是数据表单的第二个实例。
*   通过单击打开按钮从第一个数据表单打开它。我想要做的是在我更改第二个表单中的某些内容时刷新第一个数据表单。
*   例如，我打开了标签 295 White 的记录，当我更新此记录的数据时，我希望更改显示在 26 White 的记录表单中

我知道这是一个难以理解的问题，所以请随时询问更多细节，我正在努力解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T16:38:28.743

在主窗体中，您设置了一个 Java `Stack`.

```
Stack<DataForm> stack = new Stack<DataForm>(); 
```

您将对此的引用传递`Stack`给数据表单。

在数据表单的构造函数中，传递数据表单实例。

```
stack.push(this); 
```

在数据表单的析构函数中（退出时），您删除数据表单实例。

```
int pos = stack.search(this);
stack.remove(pos); 
```

当您想要刷新所有表单时，您将遍历堆栈。

```
for (DataForm dataForm : stack) {
     // do the refresh
} 
```

# matlab - 某些矩阵的重复值

> ID：11564504
> 
> 赞同：0
> 
> 时间：2012-07-19T15:47:01.410
> 
> 标签：matlab, matrix, repeat

我有矩阵

```
A = [ 5 6 7;
      7 5 6 ]

B = [ 1 2 3;
      3 1 2 ]

C = [ 1 0 2;
      0 2 1 ]

Start time A = [ 2 3 7;
                 1 6 8 ]

Start time C = [ 1 0 5;
                 0 4 7 ] 
```

问题：我想使用矩阵 B 重复矩阵 A。我还有矩阵开始时间 A，它是开始的列，我们必须在其中放置矩阵 A 的每个值。然后我必须输入值“0”矩阵 C 的每个值（值“0”由矩阵 C 重复）在列号中，即矩阵“开始时间 C”的值，并且在放置每个矩阵 A 的值之前。

所以我必须在矩阵下面有这样的输出：

```
Result = [ 0 5 6 6 0 0 7 7 7;
           7 7 7 0 0 5 0 6 6 ] 
```

谢谢你们的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T06:41:31.467

一种可能的解决方案如下。请注意，我自由地为您的变量分配有意义的名称，因为`A`和`Start Time A`（甚至不是有效的 Matlab 标识符）之类的名称很容易混淆。您还可以看到您的矩阵 `C`和`Start Time C`是多余的，因为所有信息都已经编码在`A`和 `B`中`Start Time A`。

```
% The values to put in the result matrix.
value = [5 6 7;
         7 5 6];
% Column index where each sequence starts in the result matrix.
start = [2 3 7;
         1 6 8];
% The length of each sequence, i.e. how often to put the value into the result.
count = [1 2 3;
         3 1 2];

% Determine the longest row. Note: At this place you could also check, if all 
% rows are of the same length. The current implementation pads shorter rows with
% zeros.
max_row_length = max(start(:, end) + count(:, end) - 1);

% Allocate an output matrix filled with zeros. This avoids inserting sequences
% of zeros afterwards.
result = zeros(size(start, 1), max_row_length);

% Finally fill the matrix using a double loop.
for row = 1 : size(start, 1)
    for column = 1 : size(start, 2)
        s = start(row, column);
        c = count(row, column);
        v = value(row, column);
        result(row, s : s + c - 1) = v;
    end
end 
```

`result`是_

```
result =

     0     5     6     6     0     0     7     7     7
     7     7     7     0     0     5     0     6     6 
```

按照要求。

# c# - 在 Parallel.ForEach 中嵌套等待

> ID：11564506
> 
> 赞同：223
> 
> 时间：2012-07-19T15:47:16.623
> 
> 标签：c#, wcf, async-await, task-parallel-library, parallel.foreach

在 Metro 应用程序中，我需要执行多个 WCF 调用。需要进行大量调用，因此我需要在并行循环中进行调用。问题是并行循环在 WCF 调用全部完成之前退出。

您将如何重构它以按预期工作？

```
var ids = new List<string>() { "1", "2", "3", "4", "5", "6", "7", "8", "9", "10" };
var customers = new  System.Collections.Concurrent.BlockingCollection<Customer>();

Parallel.ForEach(ids, async i =>
{
    ICustomerRepo repo = new CustomerRepo();
    var cust = await repo.GetCustomer(i);
    customers.Add(cust);
});

foreach ( var customer in customers )
{
    Console.WriteLine(customer.ID);
}

Console.ReadKey(); 
```

* * *

## 回答 #1

> 赞同：196
> 
> 时间：2012-07-19T16:32:41.523

背后的整个想法`Parallel.ForEach()`是你有一组线程，每个线程处理集合的一部分。正如您所注意到的，这不适用于`async`- `await`，您希望在异步调用期间释放线程。

你可以通过阻塞`ForEach()`线程来“修复”这个问题，但这会破坏`async`-的全部意义`await`。

您可以做的是使用[TPL Dataflow](http://msdn.microsoft.com/en-us/library/hh228603.aspx)而不是`Parallel.ForEach()`，它也支持异步`Task`s。

具体来说，您的代码可以使用 a 编写，使用lambda`TransformBlock`将每个 id 转换为 a 。该块可以配置为并行执行。您可以将该块链接到一个将每个块写入控制台的块。设置块网络后，您可以将每个 id 设置为.`Customer``async``ActionBlock``Customer``Post()``TransformBlock`

在代码中：

```
var ids = new List<string> { "1", "2", "3", "4", "5", "6", "7", "8", "9", "10" };

var getCustomerBlock = new TransformBlock<string, Customer>(
    async i =>
    {
        ICustomerRepo repo = new CustomerRepo();
        return await repo.GetCustomer(i);
    }, new ExecutionDataflowBlockOptions
    {
        MaxDegreeOfParallelism = DataflowBlockOptions.Unbounded
    });
var writeCustomerBlock = new ActionBlock<Customer>(c => Console.WriteLine(c.ID));
getCustomerBlock.LinkTo(
    writeCustomerBlock, new DataflowLinkOptions
    {
        PropagateCompletion = true
    });

foreach (var id in ids)
    getCustomerBlock.Post(id);

getCustomerBlock.Complete();
writeCustomerBlock.Completion.Wait(); 
```

尽管您可能希望将 的并行性限制`TransformBlock`为一些小常数。此外，您可以限制 的容量`TransformBlock`并使用异步将项目添加到其中`SendAsync()`，例如如果集合太大。

与您的代码（如果有效）相比，另一个好处是，一旦完成单个项目，就会开始写入，而不是等到所有处理完成。

* * *

## 回答 #2

> 赞同：146
> 
> 时间：2012-07-19T16:47:05.793

[svick 的回答](https://stackoverflow.com/a/11565317/50776)（和往常一样）非常好。

但是，我发现当您实际上有大量数据要传输时，Dataflow 会更有用。或者当你需要一个`async`兼容的队列时。

在您的情况下，一个更简单的解决方案是仅使用`async`-style 并行性：

```
var ids = new List<string>() { "1", "2", "3", "4", "5", "6", "7", "8", "9", "10" };

var customerTasks = ids.Select(i =>
  {
    ICustomerRepo repo = new CustomerRepo();
    return repo.GetCustomer(i);
  });
var customers = await Task.WhenAll(customerTasks);

foreach (var customer in customers)
{
  Console.WriteLine(customer.ID);
}

Console.ReadKey(); 
```

* * *

## 回答 #3

> 赞同：96
> 
> 时间：2014-09-16T19:37:14.860

像 svick 建议的那样使用 DataFlow 可能有点矫枉过正，斯蒂芬的回答没有提供控制操作并发性的方法。然而，这可以相当简单地实现：

```
public static async Task RunWithMaxDegreeOfConcurrency<T>(
     int maxDegreeOfConcurrency, IEnumerable<T> collection, Func<T, Task> taskFactory)
{
    var activeTasks = new List<Task>(maxDegreeOfConcurrency);
    foreach (var task in collection.Select(taskFactory))
    {
        activeTasks.Add(task);
        if (activeTasks.Count == maxDegreeOfConcurrency)
        {
            await Task.WhenAny(activeTasks.ToArray());
            //observe exceptions here
            activeTasks.RemoveAll(t => t.IsCompleted); 
        }
    }
    await Task.WhenAll(activeTasks.ToArray()).ContinueWith(t => 
    {
        //observe exceptions in a manner consistent with the above   
    });
} 
```

`ToArray()`可以通过使用数组而不是列表并替换已完成的任务来优化调用，但我怀疑它在大多数情况下会产生很大的不同。每个 OP 问题的示例用法：

```
RunWithMaxDegreeOfConcurrency(10, ids, async i =>
{
    ICustomerRepo repo = new CustomerRepo();
    var cust = await repo.GetCustomer(i);
    customers.Add(cust);
}); 
```

**EDIT** Fellow SO 用户和 TPL wiz [Eli Arbel](https://stackoverflow.com/users/276083/eli-arbel)向我指出了[Stephen Toub 的一篇相关文章](https://devblogs.microsoft.com/pfxteam/implementing-a-simple-foreachasync-part-2/)。像往常一样，他的实现既优雅又高效：

```
public static Task ForEachAsync<T>(
      this IEnumerable<T> source, int dop, Func<T, Task> body) 
{ 
    return Task.WhenAll( 
        from partition in Partitioner.Create(source).GetPartitions(dop) 
        select Task.Run(async delegate { 
            using (partition) 
                while (partition.MoveNext()) 
                    await body(partition.Current).ContinueWith(t => 
                          {
                              //observe exceptions
                          });

        })); 
} 
```

* * *

## 回答 #4

> 赞同：52
> 
> 时间：2017-06-19T20:28:54.000

[您可以使用新的AsyncEnumerator NuGet 包](https://www.nuget.org/packages/AsyncEnumerator)来节省精力，该包在 4 年前最初发布问题时并不存在。它允许您控制并行度：

```
using System.Collections.Async;
...

await ids.ParallelForEachAsync(async i =>
{
    ICustomerRepo repo = new CustomerRepo();
    var cust = await repo.GetCustomer(i);
    customers.Add(cust);
},
maxDegreeOfParallelism: 10); 
```

免责声明：我是 AsyncEnumerator 库的作者，该库是开源的并在 MIT 下获得许可，我发布此消息只是为了帮助社区。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2014-11-18T11:55:43.480

包装`Parallel.Foreach`成 a `Task.Run()`and 而不是`await`关键字 use`[yourasyncmethod].Result`

（您需要执行 Task.Run 操作才能不阻塞 UI 线程）

像这样的东西：

```
var yourForeachTask = Task.Run(() =>
        {
            Parallel.ForEach(ids, i =>
            {
                ICustomerRepo repo = new CustomerRepo();
                var cust = repo.GetCustomer(i).Result;
                customers.Add(cust);
            });
        });
await yourForeachTask; 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2014-12-05T21:48:55.777

这应该非常有效，并且比让整个 TPL 数据流正常工作更容易：

```
var customers = await ids.SelectAsync(async i =>
{
    ICustomerRepo repo = new CustomerRepo();
    return await repo.GetCustomer(i);
});

...

public static async Task<IList<TResult>> SelectAsync<TSource, TResult>(this IEnumerable<TSource> source, Func<TSource, Task<TResult>> selector, int maxDegreesOfParallelism = 4)
{
    var results = new List<TResult>();

    var activeTasks = new HashSet<Task<TResult>>();
    foreach (var item in source)
    {
        activeTasks.Add(selector(item));
        if (activeTasks.Count >= maxDegreesOfParallelism)
        {
            var completed = await Task.WhenAny(activeTasks);
            activeTasks.Remove(completed);
            results.Add(completed.Result);
        }
    }

    results.AddRange(await Task.WhenAll(activeTasks));
    return results;
} 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2018-05-09T22:46:16.807

一种扩展方法，它利用 SemaphoreSlim 并允许设置最大并行度

```
 /// <summary>
    /// Concurrently Executes async actions for each item of <see cref="IEnumerable<typeparamref name="T"/>
    /// </summary>
    /// <typeparam name="T">Type of IEnumerable</typeparam>
    /// <param name="enumerable">instance of <see cref="IEnumerable<typeparamref name="T"/>"/></param>
    /// <param name="action">an async <see cref="Action" /> to execute</param>
    /// <param name="maxDegreeOfParallelism">Optional, An integer that represents the maximum degree of parallelism,
    /// Must be grater than 0</param>
    /// <returns>A Task representing an async operation</returns>
    /// <exception cref="ArgumentOutOfRangeException">If the maxActionsToRunInParallel is less than 1</exception>
    public static async Task ForEachAsyncConcurrent<T>(
        this IEnumerable<T> enumerable,
        Func<T, Task> action,
        int? maxDegreeOfParallelism = null)
    {
        if (maxDegreeOfParallelism.HasValue)
        {
            using (var semaphoreSlim = new SemaphoreSlim(
                maxDegreeOfParallelism.Value, maxDegreeOfParallelism.Value))
            {
                var tasksWithThrottler = new List<Task>();

                foreach (var item in enumerable)
                {
                    // Increment the number of currently running tasks and wait if they are more than limit.
                    await semaphoreSlim.WaitAsync();

                    tasksWithThrottler.Add(Task.Run(async () =>
                    {
                        await action(item).ContinueWith(res =>
                        {
                            // action is completed, so decrement the number of currently running tasks
                            semaphoreSlim.Release();
                        });
                    }));
                }

                // Wait for all tasks to complete.
                await Task.WhenAll(tasksWithThrottler.ToArray());
            }
        }
        else
        {
            await Task.WhenAll(enumerable.Select(item => action(item)));
        }
    } 
```

样品用法：

```
await enumerable.ForEachAsyncConcurrent(
    async item =>
    {
        await SomeAsyncMethod(item);
    },
    5); 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2016-11-30T16:30:38.583

我参加聚会有点晚了，但您可能想考虑使用 GetAwaiter.GetResult() 在同步上下文中运行您的异步代码，但并行如下；

```
 Parallel.ForEach(ids, i =>
{
    ICustomerRepo repo = new CustomerRepo();
    // Run this in thread which Parallel library occupied.
    var cust = repo.GetCustomer(i).GetAwaiter().GetResult();
    customers.Add(cust);
}); 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2017-11-17T15:38:22.813

在介绍了一堆辅助方法之后，您将能够使用以下简单语法运行并行查询：

```
const int DegreeOfParallelism = 10;
IEnumerable<double> result = await Enumerable.Range(0, 1000000)
    .Split(DegreeOfParallelism)
    .SelectManyAsync(async i => await CalculateAsync(i).ConfigureAwait(false))
    .ConfigureAwait(false); 
```

这里发生的情况是：我们将源集合拆分为 10 个块`.Split(DegreeOfParallelism)`（`.SelectManyAsync(...)`

值得一提的是，还有一种更简单的方法：

```
double[] result2 = await Enumerable.Range(0, 1000000)
    .Select(async i => await CalculateAsync(i).ConfigureAwait(false))
    .WhenAll()
    .ConfigureAwait(false); 
```

但它需要一个**预防措施**：如果你有一个太大的源集合，它会`Task`立即为每个项目安排一个，这可能会导致显着的性能损失。

上面示例中使用的扩展方法如下所示：

```
public static class CollectionExtensions
{
    /// <summary>
    /// Splits collection into number of collections of nearly equal size.
    /// </summary>
    public static IEnumerable<List<T>> Split<T>(this IEnumerable<T> src, int slicesCount)
    {
        if (slicesCount <= 0) throw new ArgumentOutOfRangeException(nameof(slicesCount));

        List<T> source = src.ToList();
        var sourceIndex = 0;
        for (var targetIndex = 0; targetIndex < slicesCount; targetIndex++)
        {
            var list = new List<T>();
            int itemsLeft = source.Count - targetIndex;
            while (slicesCount * list.Count < itemsLeft)
            {
                list.Add(source[sourceIndex++]);
            }

            yield return list;
        }
    }

    /// <summary>
    /// Takes collection of collections, projects those in parallel and merges results.
    /// </summary>
    public static async Task<IEnumerable<TResult>> SelectManyAsync<T, TResult>(
        this IEnumerable<IEnumerable<T>> source,
        Func<T, Task<TResult>> func)
    {
        List<TResult>[] slices = await source
            .Select(async slice => await slice.SelectListAsync(func).ConfigureAwait(false))
            .WhenAll()
            .ConfigureAwait(false);
        return slices.SelectMany(s => s);
    }

    /// <summary>Runs selector and awaits results.</summary>
    public static async Task<List<TResult>> SelectListAsync<TSource, TResult>(this IEnumerable<TSource> source, Func<TSource, Task<TResult>> selector)
    {
        List<TResult> result = new List<TResult>();
        foreach (TSource source1 in source)
        {
            TResult result1 = await selector(source1).ConfigureAwait(false);
            result.Add(result1);
        }
        return result;
    }

    /// <summary>Wraps tasks with Task.WhenAll.</summary>
    public static Task<TResult[]> WhenAll<TResult>(this IEnumerable<Task<TResult>> source)
    {
        return Task.WhenAll<TResult>(source);
    }
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2020-12-11T13:07:35.913

**.NET 6 更新：**[`Parallel.ForEachAsync`](https://docs.microsoft.com/en-us/dotnet/api/system.threading.tasks.parallel.foreachasync)引入API后，以下实现不再相关。它们仅适用于面向 .NET 平台版本早于 .NET 6 的项目。

* * *

`ForEachAsync`这是一个基于[TPL Dataflow](https://docs.microsoft.com/en-us/dotnet/standard/parallel-programming/dataflow-task-parallel-library)[`ActionBlock`](https://docs.microsoft.com/en-us/dotnet/api/system.threading.tasks.dataflow.actionblock-1)库的方法的简单通用实现，现在嵌入在 .NET 5 平台中：

```
public static Task ForEachAsync<T>(this IEnumerable<T> source,
    Func<T, Task> action, int dop)
{
    // Arguments validation omitted
    var block = new ActionBlock<T>(action,
        new ExecutionDataflowBlockOptions() { MaxDegreeOfParallelism = dop });
    try
    {
        foreach (var item in source) block.Post(item);
        block.Complete();
    }
    catch (Exception ex) { ((IDataflowBlock)block).Fault(ex); }
    return block.Completion;
} 
```

此解决方案急切地枚举提供的`IEnumerable`，并立即将其所有元素发送到`ActionBlock`. 所以它不太适合具有大量元素的可枚举。下面是一种更复杂的方法，它懒惰地枚举源，并将其元素`ActionBlock`一个一个发送：

```
public static async Task ForEachAsync<T>(this IEnumerable<T> source,
    Func<T, Task> action, int dop)
{
    // Arguments validation omitted
    var block = new ActionBlock<T>(action, new ExecutionDataflowBlockOptions()
    { MaxDegreeOfParallelism = dop, BoundedCapacity = dop });
    try
    {
        foreach (var item in source)
            if (!await block.SendAsync(item).ConfigureAwait(false)) break;
        block.Complete();
    }
    catch (Exception ex) { ((IDataflowBlock)block).Fault(ex); }
    try { await block.Completion.ConfigureAwait(false); }
    catch { block.Completion.Wait(); } // Propagate AggregateException
} 
```

这两种方法在异常情况下具有不同的行为。`AggregateException`第一个¹直接在其`InnerExceptions`属性中传播包含异常的一个。第二个传播`AggregateException`包含另一个`AggregateException`例外的一个。我个人发现第二种方法的行为在实践中更方便，因为等待它会自动消除一层嵌套，所以我可以简单地`catch (AggregateException aex)`处理块`aex.InnerExceptions`内部`catch`。第一种方法需要`Task`在等待之前存储它，以便我可以访问块`task.Exception.InnerExceptions`内部`catch`。有关从异步方法传播异常的更多信息，请查看[此处](https://stackoverflow.com/questions/18314961/i-want-await-to-throw-aggregateexception-not-just-the-first-exception "我想等待抛出 AggregateException，而不仅仅是第一个异常")或[此处](https://stackoverflow.com/questions/12007781/why-doesnt-await-on-task-whenall-throw-an-aggregateexception "为什么不等待 Task.WhenAll 抛出 AggregateException？")。

两种实现都可以优雅地处理枚举期间可能发生的任何错误`source`。在完成所有挂起的操作之前，该`ForEachAsync`方法不会完成。没有任务被遗漏（以即发即弃的方式）。

¹[第一个实现省略了[async 和 await](https://blog.stephencleary.com/2016/12/eliding-async-await.html)。]

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2021-05-09T21:53:36.160

没有 TPL 的简单原生方式：

```
int totalThreads = 0; int maxThreads = 3;

foreach (var item in YouList)
{
    while (totalThreads >= maxThreads) await Task.Delay(500);
    Interlocked.Increment(ref totalThreads);

    MyAsyncTask(item).ContinueWith((res) => Interlocked.Decrement(ref totalThreads));
} 
```

您可以通过下一个任务检查此解决方案：

```
async static Task MyAsyncTask(string item)
{
    await Task.Delay(2500);
    Console.WriteLine(item);
} 
```

# macos - Jenkins 构建步骤在“npm install”上失败 '

> ID：11564508
> 
> 赞同：3
> 
> 时间：2012-07-19T15:47:35.573
> 
> 标签：macos, node.js, jenkins, npm

Jenkins 新手：我正在 Jenkins 中设置我们的构建。设置构建步骤以运行 nodejs 脚本（使用 Sencha Touch 2 将构建的应用程序带入原生 iOS 应用程序的脚本）。nodejs 脚本需要一个扳手库。

Jenkins 用户似乎在不同的上下文中运行。它看不到我的节点安装或 npm 安装。作为构建步骤的一部分，我必须将路径导出到 node 和 npm。现在我已经完成了，构建会看到 node 和 npm 命令。

但是，我在构建步骤中调用的命令之一是“npm install wrench”，它给了我一个权限错误，并告诉我以管理员身份运行。所以我可以让它工作。

因此，我要么需要能够授予 Jenkins 用户管理员权限，要么需要提前为用户 npm-install 软件包。有谁知道如何做这些选项中的任何一个。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-20T21:06:08.427

我猜你是在 Mac 上运行 Jenkins，你可能已经使用 Jenkins Mac 安装程序安装了它。我会进一步猜测您使用默认设置安装了它，这意味着 Jenkins 被设置为作为启动守护程序运行并在名为*daemon*的帐户下运行。

守护程序用户是特殊的。这是非常安全的。daemon 用户的主目录归 root 所有，daemon 在那里没有写权限，所以它不能在那里安装任何东西。

您可以通过重新运行 Jenkins 安装程序来解决您的问题，但这次单击*自定义*按钮。选中显示 的框`Start at boot as "jenkins"`。取消选中显示 的框`Start at boot as "daemon"`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-03-07T18:00:04.187

在构建配置中添加执行命令并导出路径：

```
export PATH=/sbin:/usr/sbin:/bin:/usr/local/bin
npm install 
```

有关更多[信息，请参阅此链接](https://www.javaer101.com/en/article/13236956.html)

# trigger.io - trigger.io 以编程方式设置方向

> ID：11564509
> 
> 赞同：2
> 
> 时间：2012-07-19T15:47:35.470
> 
> 标签：trigger.io

有没有办法以编程方式设置方向？我遇到的问题是应用程序以横向加载时看起来很可怕的启动图像。iOS 和 Android 都是如此。我的启动图像具有白色背景，并且在横向握持（或模拟）设备时，可以看到黑色背景填充物。

也许我可以在配置中将方向限制为纵向......然后在启动完成后......然后允许（以编程方式设置）横向和纵向？或者也许允许我将launchimage填充颜色设置为黑色以外的颜色（使用默认trigger.io launchimage看起来不错，因为它有黑色背景）？我目前的设置是：

```
 "launchimage": {
    "iphone": "img/320x480.png",
    "iphone-retina": "img/640x960.png",
    "ipad": "img/768x1004.png",
    "ipad-landscape": "img/1024x748.png",
    "android": "img/640x960.png",
    "android-landscape": "img/1024x748.png"
    }, 
```

启动图像（在横向握住设备时）看起来与此图像相似

![在此处输入图像描述](../Images/44f5ba455b38a345d9a612ac2827e201.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T22:02:45.240

目前没有用于以编程方式设置方向的 Forge API，但我们之前被问到过，并且在我们的积压工作中有一张票，我们已经增加了。

当 API 可用时，我会在这里报告。

**更新：这现在在我们的 v1.4.13 平台版本中可用：http: [//docs.trigger.io/en/v1.4/release-notes.html#v1-4-13](http://docs.trigger.io/en/v1.4/release-notes.html#v1-4-13)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T13:20:14.273

其原因似乎是由于设备像素比/像素密度而导致的图像缩小。

示例：三星 Galaxy Nexus 的像素比为 2（[来源](http://en.wikipedia.org/wiki/List_of_displays_by_pixel_density#Samsung)）。如果您想在横向模式（1280 x 720 像素）下获得全宽启动图像，您需要一个宽度至少为 2560 像素的图像。

顺便说一句：从平台版本 v1.4.21 开始，您可以在配置中更改[Android 启动图像的背景颜色](http://docs.trigger.io/en/latest/modules/launchimage.html#modules-launchimage)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T09:53:20.203

它似乎比强制横向作为应用配置中的唯一可用方向与 display.orientation.forceLandscape() 语句冲突，导致纵向应用（即使触发了成功回调）

```
[DEBUG] Native call "display.orientation_forceLandscape" with task.params: {}

[DEBUG] Returning event: {"event":"internal.orientationChange","params":{"orientation":"portrait"}} 
```

如果我省略“display.orientation.forceLandscape()”，一切正常。

希望这可以帮助

# html - ……不起作用

> ID：11564512
> 
> 赞同：2
> 
> 时间：2012-07-19T15:47:36.997
> 
> 标签：html, css

我正在制作一个网站，但我有两个问题`<div position:absolute;left:Xpx;top:Ypx>`（X 和 Y 是数字）代码`<div position:absolute;left:Xpx;top:Ypx>`设置句子或图像或 hr 等的位置...在我的网站上，我设置句子使用，并将其设置在中间，当我恢复浏览器并调整它的大小时，我的句子位置发生变化的问题！另一个问题是，当我转到另一台屏幕更大（或更小）的 PC 或笔记本电脑时，句子位置向左中心改变了！我认为“px”参数的问题是因为当您调整浏览器屏幕的大小时，px 的位置会发生变化，这与具有不同屏幕的不同计算机相同。例如`<div>`：

```
<div style="font-size:80%;position:absolute;l…
<p>Estimated Time Remaining Before launch:</p>
</div> 
```

有什么建议可以解决这些问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T16:04:10.787

您正在设置一个“绝对”位置，无论浏览器的大小如何，元素都将始终位于左侧“X”像素和顶部“Y”像素。如果，正如我从您的描述中了解到的那样，您希望元素始终居中，我发现这样做的最佳方法是使用 css 样式设置其父元素（它包含在其中的元素）：

```
text-align:center; 
```

然后使用 css 样式设置您希望居中的元素：

```
margin:0px auto; 
```

0px 指的是元素上方和下方的边距（Y 轴），自动将边距设置为元素的左侧和右侧。或者，如果这让您感到困惑，您可以这样设置各个边距：

```
margin-top:0px;
margin-left:auto;
margin-right:auto;
margin-bottom:0px; 
```

您可以将顶部和底部边距设置为您想要的任何值，但必须保持左右为自动；如果您希望将元素完美居中，您可能希望将其设置为百分比，尽管它需要进行大量调整才能使其在多种屏幕尺寸上完美运行。

祝你好运，希望我有所帮助。

PS 必须确保元素不再是 position:absolute; 而是给它 :relative; 或留空

# asp.net-mvc - Telerik MVC3 Grid - 是否可以同时使用 Template 和 ClientTemplate？

> ID：11564521
> 
> 赞同：0
> 
> 时间：2012-07-19T15:47:52.707
> 
> 标签：asp.net-mvc, templates, telerik-grid

是否可以同时使用模板和客户端模板？

我想在模板中进行布尔检查，但不知道在没有绑定时如何将其传递给 ClientTemplate 中的复选框。

```
 @(Html.Telerik().Grid(Model.Item)
     .Name("Grid")
     .Columns(column =>
       column.Template(x => x.ItemId.Equals(Model.Id))
             .ClientTemplate("<input type='checkbox' checked='<#=????? #>' disabled />");
    }) 
```

也许还有另一种方法可以实现这一目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:18:05.087

模板用于服务器绑定，而 ClientTemplate 用于 ajax 或 Web 服务绑定。如果您使用服务器绑定，则不使用 ClientTemplate。如果您使用 ajax 绑定，则不使用模板。使用 ClientTemplate，您可以使用 <#= #> 以类似于服务器端模板的方式嵌入数据绑定表达式。

```
.ClientTemplate("<input type='checkbox' checked='<#= (ItemID == Id) #>' disabled />") 
```

您放入条件的内容是有限的。我已经能够成功地使用 bool 和 int 比较，但不能使用字符串比较。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T15:10:09.163

对于这种特殊情况，您不必使用`Template`. 您可以使用 ClientTemplate 的嵌入式数据绑定功能（如 Daniel 所述）来实现您想要的，

```
@(Html.Telerik().Grid(Model.Item)
  .Name("Grid")
  .Columns(column =>
    column.ClientTemplate("<input type='checkbox' checked='<#=ItemId == " + Model.Id + "#>' disabled />");
}) 
```

通过这种方式，您从服务器传递了变量`Model.Id`，而在客户端使用 Javascript 进行了实际比较。

# php - 在逗号分隔的字段上使用 WHERE 子句选择记录

> ID：11564523
> 
> 赞同：0
> 
> 时间：2012-07-19T15:47:55.763
> 
> 标签：php

我有一个带有 2 个字段的表 myTable（4 个示例）：

```
ID   Zip_Codes
===  =========
1    60148,60123,61034,61234
2    60122,61034 
```

我想使用：

```
$zip = 61034;
$qry = "Select ID from myTable Where $zip in Zip_Codes"; 
```

那可能吗？是什么让它快速？其他更好的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T15:55:28.363

你不能`IN`在这里使用。 `x IN (1,2)`是 的简写`x = 1 OR x = 2`，它不允许您在逗号分隔的列表中进行搜索。

您可以使用`FIND_IN_SET`：

```
SELECT ID FROM myTable WHERE FIND_IN_SET(61034, Zip_Codes); 
```

但是，您不应该在一行中有多个值。每个邮政编码应该有一行。

```
RowID   ID   Zip_Code
=====   ===  =========
1       1    60148
2       1    60123
3       1    61034
4       1    61234
5       2    60122
6       2    61034 
```

（`RowID`将主键。您可以添加`INDEX`到`ID`。）

然后你可以简单地做：

```
SELECT ID FROM myTable WHERE Zip_Code = 61034 
```

# python - django：运行“django by example”教程代码时出现“没有 ForeignKey”错误

> ID：11564524
> 
> 赞同：0
> 
> 时间：2012-07-19T15:47:56.467
> 
> 标签：python, django, exception, foreign-keys, foreign-key-relationship

我正在关注“django by example”教程的[这一](http://lightbird.net/dbe/todo_list.html#adding-multiple-items)部分。现在当我去`/admin/todo/datetime/`点击`Add date time`我得到这个错误：

```
Exception Type: Exception at /admin/todo/datetime/add/
Exception Value: <class 'todo.models.Item'> has no ForeignKey to <class 'todo.models.DateTime'> 
```

我的代码几乎相同（除了我包含导入语句）：

```
from django.db import models
from django.contrib import admin

class DateTime(models.Model):
    datetime = models.DateTimeField(auto_now_add = True)
    def __unicode__(self):
       return unicode(self.datetime)

class Item(models.Model):
    name = models.CharField(max_length = 60)
    created = models.DateTimeField(auto_now_add = True)
    priority = models.IntegerField(default = 0)
    difficulty = models.IntegerField(default = 0)
    done = models.BooleanField(default = False)

class ItemAdmin(admin.ModelAdmin):
    list_display = ["name", "priority", "difficulty", "created", "done"]
    search_fields = ["name"]

class ItemInline(admin.TabularInline):
    model = Item

class DateAdmin(admin.ModelAdmin):
    list_display = ["datetime"]
    inlines = [ItemInline]

admin.site.register(Item, ItemAdmin)
admin.site.register(DateTime, DateAdmin) 
```

我查看了类似的 SO 线程，但我无法从那里弄清楚这里出了什么问题。（顺便说一句，我在教程中使用了`django 1.3`while `django 1.2`）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T15:53:13.283

您应该在模型中替换`created = models.DateTimeField(auto_now_add = True)`为。`created = models.ForeignKey(DateTime)``Item`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T15:53:51.123

您的模型与教程中的模型不匹配。你`Item.created`是`DateTimeField`他们的`Item.created`一个模型。`ForeignKey``DateTime`

```
# From http://lightbird.net/dbe/todo_list.html#adding-multiple-items

class DateTime(models.Model):
    datetime = models.DateTimeField(auto_now_add=True)
    def __unicode__(self):
        return unicode(self.datetime)

class Item(models.Model):
    name = models.CharField(max_length=60)
    created = models.ForeignKey(DateTime)
    priority = models.IntegerField(default=0)
    difficulty = models.IntegerField(default=0)
    done = models.BooleanField(default=False) 
```

# mysql - 在试卷中链接相似的总和/问题

> ID：11564527
> 
> 赞同：3
> 
> 时间：2012-07-19T15:48:09.350
> 
> 标签：mysql, algorithm, data-mining, related-content

我正在开发一个应用程序，该应用程序正在从旧试卷中创建一个问题数据库。我想维护一个表格，在插入类似问题时将它们链接在一起。（我想到的表是修改后的预排序遍历树）。

我的要求是：

1.  更改数字的单词问题应该链接在一起
2.  专有名词/名称不同的单词问题应该联系在一起。
3.  XYZ、ABC、PQR、MNO 等价（例如三角形命名法）
4.  忽略标点符号和连词以及“小词”。
5.  标签！我用它的主题标记每个问题。数学问题与历史问题相似的可能性很小。但是化学热力学问题可能类似于物理热力学问题。

任何关于如何在算法方面进行的想法都将非常感激。

此外，我将处理包含数学符号的图像。我应该确保我所有的图像在“ALT”属性中都有 LaTeX，以确保它们可以被这个算法处理，还是有更好的方法呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T06:41:55.400

您*需要*进行特征提取并阅读此内容。

数据挖掘的关键是预处理。您不能只是将硬盘扔给它并期望它找到任何有用的东西，但您需要通过适当地预处理数据来指导搜索。这可能是 90% 的工作。所以请阅读特征提取！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-20T07:18:56.387

听起来你想在两个问题具有相同的句子结构时考虑它们是相似的，在去掉你希望改变的句法模式的洗衣清单之后。因此，这个问题看起来类似于在语料库中检测近乎重复的文档的问题。

一种方法是一种称为“simhashing”的技术。一个人需要一个（预处理的）文档并计算一个simhash指纹。与典型的哈希一样，指纹具有固定大小，看起来像二进制乱码。 *与*典型的散列不同，文本相似的文档也将具有相似的指纹。通过选择指纹可以不同的最大（汉明）距离，您可以定义您认为“相似”的文档（问题）集群。

索引新问题的过程将如下所示：

1.  规范化问题文本。这是一个标准的信息检索任务，它对每个人的意义都略有不同，但是像折叠空格、将所有内容都变成小写和剥离标点符号这样的转换是典型的。您可能还想将所有数字或专有名称的白名单转换为占位符（“NUMBER”、“NAME”等）
2.  将生成的文本输入 simhash 实现以获取指纹。
3.  在您的语料库中搜索足够靠近新指纹的指纹。这实际上比你想象的要有效地做起来要棘手。 [谷歌想出了一个合理的方法](http://infolab.stanford.edu/~manku/papers/07www-duplicates.pdf)，它可以归结为一个排序的指纹表，其中添加了一些人工指纹。
4.  找到插入的问题应该被认为类似于的问题后，您可以随意丢弃重复的问题，坚持下去并做簿记等。

这[本书](http://nlp.stanford.edu/IR-book/)是一般信息检索的优秀入门读物。这是[simhash 论文](http://www.cs.princeton.edu/courses/archive/spr04/cos598B/bib/CharikarEstim.pdf)。这是一个计算[simhashes](http://manpages.ubuntu.com/manpages/natty/man1/simhash.1.html)的简单程序的手册页，如果您不想自己实现该算法，这可能是一个很好的起点。

# fakeiteasy - 如何验证是否使用特定类型的参数调用了方法

> ID：11564528
> 
> 赞同：14
> 
> 时间：2012-07-19T15:48:12.563
> 
> 标签：fakeiteasy

我需要验证是否使用特定类型的对象调用了方法

这是我要测试它被调用的方法的接口：

```
interface IPlayer
{
   void Send(object message);
} 
```

考试：

```
var player1 = A.Fake<IPlayer>();
room.AddPlayer(player1);

room.DoSomething();

A.CallTo(() => player1.Send(A<Type1>.Ignored)).MustHaveHappened(); 
```

因为`player1.Send`我得到了许多不同对象的多次调用`InvalidCastException`

有人知道如何正确地做到这一点吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-23T07:39:03.117

这是设计使然，您实际上要做的是：

```
A.CallTo(() => player1.Send(A<object>.That.IsInstanceOf(typeof(MessageType)))).MustHaveHappened(); 
```

A<?> 中指定的类型应该始终是方法采用的确切参数类型。实际上，我确实考虑过更改它，以便您可以按照建议的方式限制类型，如果我没记错的话，主要原因（但我认为还有其他原因）是在引入重载的情况下它会更加脆弱。

例如，假设您在 IPlayer 接口上引入了以下重载：

```
interface IPlayer
{
   void Send(object message);
   void Send(Type1 message);
} 
```

一旦你引入了这个重载，你的测试就会改变意义。

# sharepoint - 从 SharePoint 2010 富文本编辑器 (RTE) 中删除粘贴上的所有跨度标记

> ID：11564534
> 
> 赞同：1
> 
> 时间：2012-07-19T15:48:36.357
> 
> 标签：sharepoint, sharepoint-2010, richtextbox

我让用户从随机网页复制内容并粘贴到 SharePoint 2010 RTE。他们不知道的是，他们还复制了 RTE 转换为样式化跨度标签的原始网页的样式，并且这些跨度标签覆盖了页面上的默认文本样式。粘贴后，我想自动删除任何/所有跨度标签，但保留任何剩余的标记。我意识到会有其他相关问题，但删除跨度标签将使我更接近我需要的位置。

我在[这里](http://sharepointcustomization.blogspot.ca/2011/09/remove-format-copy-paste-text-editor.html)找到了一个代码片段，它会在粘贴时删除所有标记。

```
//Disable the RTE paste option. Restricts to "Paste Plain Text" 
function disableMarkupPasteForRTE()
{
 Type.registerNamespace("RTE");
 if (RTE)
 {
  if(RTE.RichTextEditor != null)
  {
   RTE.RichTextEditor.paste = function() { RTE.Cursor.paste(true); }
   // Handle Ctrl+V short cut options in rich text editor
   RTE.Cursor.$3C_0 = true;
  }
 }
}

_spBodyOnLoadFunctionNames.push("disableMarkupPasteForRTE"); 
```

是否有人能够修改上述代码以仅删除跨度标签？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T19:07:58.093

SharePoint RTE 只不过是一个经过改进的 ContentEditable div。解决方法是在编辑器上绑定一个onpaste函数，然后直接操作html。

```
$(document).ready(function() {
    $(".ms-rtestate-write").bind('paste', function(e) {
        var text = $(this).html();
        $(this).html(text.replace( /<\s*span.*?>/gi,"").replace( /<\s*\/\s*span\s*.*?>/gi,""));
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T07:59:19.867

您可以使用 Sharepoint 粘贴方法并像这样修改 html：

```
RTE.Cursor.$1u_0--;
RTE.Cursor.$1G_0 = true;
RTE.Cursor.$A2();
RTE.Cursor.$S_0.style.display = '';
var $v_0 = RTE.Cursor.$S_0.contentWindow.document;
var $v_1 = $v_0.body;
var $v_2 = RTE.DomHelper.createRange($v_0);
var $v_3 = new RTE.Range($v_2);
$v_3.moveToElementText($v_1);
$v_3.select();
$v_0.execCommand('paste', false, null);

html = $v_2.htmlText;
//modify the html source

//paste back your new html
$v_2.pasteHTML(newhtml);

RTE.Cursor.updateRangeToCurrentSelectionWithOptions(true);
var $v_4 = RTE.Cursor.get_range();
var $v_5 = $v_4.$1N();
$v_4.deleteContent();
$v_5.select();
RTE.Cursor.$S_0.style.display = 'none';
RTE.Cursor.$2U_0 = true;
RTE.Cursor.$28_0 = true;
RTE.Cursor.$Ei_0();
RTE.Cursor.$59();
RTE.Cursor.$A2();
window.setTimeout(RTE.Cursor.$9w, 0);
if (RTE.Cursor.$1u_0 > 0) {
    window.setTimeout(RTE.Cursor.$5p_0, 10);
} 
```

# java - 如何将字符串拆分为数组然后返回给定元素？

> ID：11564535
> 
> 赞同：1
> 
> 时间：2012-07-19T15:48:36.780
> 
> 标签：java, string

我有一个这样的字符串：“Name foo Modified bar”

我想拆分这个字符串，然后只返回“foo”。我研究了拆分字符串并发现了这一点：

```
String nameString = "Name foo Modified bar";
System.out.println(
    java.util.Arrays.toString(
    nameString.split(" ")
)); 
```

输出：

```
[Name, foo, Modified, bar] 
```

我希望能够自己获得“foo”，作为局部变量。像这样的东西：

```
String name = output.get(1); 
```

如果输出是名称字符串被拆分成的 ArrayList，这将起作用。

我应该如何获得这个结果？我应该使用我找到的字符串拆分方法还是其他方法？有没有办法将字符串拆分为数组列表？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T15:50:38.163

在一行中：

```
String name = nameString.split(" ")[1]; 
```

成两半：

```
String []tokens = nameString.split(" ");
String name = tokens[1]; 
```

要创建一个 ArrayList：

```
ArrayList<String> tokenList = new ArrayList<String>(Arrays.asList(tokens)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T15:54:21.110

最简单的事情是使用方括号表示法从数组中获取元素：

```
String nameString = "Name foo Modified bar";
String name = nameString.split(" ")[1]; 
```

或者，如果您特别希望它作为一个集合：

```
List<String> nameList = Arrays.asList(nameString.split(" "));
String name = nameList.get(1); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T15:51:12.407

[String.split()](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#split%28java.lang.String%29)返回一个数组。

所以

```
String[] elems = nameString.split(" ");
String result = elems[1]; 
```

有关更多信息，请参阅[数组](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/arrays.html)教程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T15:51:44.673

如果你想要 ArrayList -

```
new ArrayList<String>( Arrays.asList(nameString.split(" ") ) ) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-19T15:52:18.323

有没有办法将字符串拆分为数组列表？是的：

```
String toFindString="foo";
String nameString = "Name foo Modified bar";
List<String> nameStringList = Arrays.asList(nameString.split(" ")); 
```

从列表中查找任何字符串。

```
for (String string : nameStringList) {
        if(string.equals(toFindString)){
                return string;
        }
    } 
```

# web-services - 如何在 SSIS 中使用脚本任务调用 Web 服务

> ID：11564537
> 
> 赞同：1
> 
> 时间：2012-07-19T15:48:43.377
> 
> 标签：web-services, ssis

我必须在 2005 年不使用 Web 服务任务的情况下在 SSIS 包中调用带有参数的 Web 服务方法。但是，脚本组件中没有添加 Web 引用。如何检索给定 Web 服务上可用的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-06-18T04:31:03.200

如果您有 WSDL，那么您可以使用向 SSIS 脚本任务项目添加服务引用。否则，您可以使用 svcutil.exe 创建客户端代理类并创建 channelFactory 方法来为您的 Web 服务创建代理并访问您的方法。

# json - 访问 JSON 中的嵌套对象名称

> ID：11564538
> 
> 赞同：0
> 
> 时间：2012-07-19T15:48:44.697
> 
> 标签：json

我从服务器返回了一些 JSON：

```
{
  "outer" : {
    "inner" : "1"
    },

  "outer2" : {
    "inner" : "1"
    },

  "outer3" : {
    "inner" : "1"
    },

} 
```

我想以编程方式访问 ~something~.inner，并且我有一个包含该数据的变量，但如果我说 variable.inner，它就不起作用（显然）。这样做的正确语法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:52:10.127

```
data = JSON.parse(jsonString);
var yourvar = 'outer';
data[yourvar].inner; 
```

假设 javascript

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T15:55:57.263

评估（{“外部”：{“内部”：“1”}，

“外部2”：{“内部”：“1”}，

“外部3”：{“内部”：“1”}，

}).outer.inner

在javascript中

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-06T04:50:59.920

You should use the code below to easily access nested JSON objects.

```
// http://json-simple.googlecode.com/files/json-simple-1.1.1.jar
import org.json.simple.*;
import org.json.simple.parser.*;

/*
 * "Simpler" version of simple JSON.  Easy to use interface for easy parsing of JSON nested objects.
 *
 * Usage:
 *  Json json = new Json("{roster: [{id: 1, name: \"Adam\"}, {id: 2, name: \"Eve\"}]}");
 *  JSONArray arr = json.getArray("roster");
 *  JSONObject obj = json.getObject("roster[0]");
 *  int id = json.getInt("roster[0].id"); 
 *  String name = json.getString("roster[1].name");
 *
 */
public class Json {

    private JSONParser m_parser = new JSONParser();
    private JSONObject m_json = null;
    private String m_strErrMsg = "";    

    public Json(String str) {
        reset();
        m_json = parse(str);
    }

    public Json(JSONObject obj) {
        reset();
        m_json = obj;
    }

    public JSONObject parse(String str) {
        setErrMsg("");
        JSONObject obj = null;
        try {
            if (m_parser != null) {
                obj = (JSONObject)m_parser.parse(str);
            }
        }
        catch (Exception ex) {
            setErrMsg("Exception occurred while parsing json string. Msg: " + ex.toString());
            return obj;
        }
        return obj;
    }

    public String getErrMsg() { return m_strErrMsg; }
    public void setErrMsg(String str) { m_strErrMsg = str; }
    public void clearErrMsg() { m_strErrMsg = ""; }

    public void reset() { 
        m_json = null;
        m_strErrMsg = "";
    }

    public Object get(String path) {
        return get(m_json, path);
    }

    public JSONObject getObject(String path) {
        Object obj = get(path);
        return (obj != null ? (JSONObject)obj : null);        
    }

    public JSONArray getArray(String path) {
        Object obj = get(path);
        return (obj != null ? (JSONArray)obj : null);        
    }

    public String getString(String path) {
        Object obj = get(path);
        return (obj != null ? obj.toString() : "");
    }

    public int getInt(String path) {
        int val = 0;
        try {
            String str = getString(path);
            val = Integer.parseInt(str);
        }
        catch (Exception ex) {
            return 0;
        }
        return val;
    }

    public long getLong(String path) {
        long val = 0L;
        try {
            String str = getString(path);
            val = Long.parseLong(str);
        }
        catch (Exception ex) {
            return 0L;
        }
        return val;
    }

    public double getDouble(String path) {
        double val = 0.0;
        try {
            String str = getString(path);
            val = Double.parseDouble(str);
        }
        catch (Exception ex) {
            return 0.0;
        }
        return val;
    }

    public boolean getBool(String path) {
        boolean val = false;
        try {
            String str = getString(path);
            val = Boolean.parseBoolean(str);
        }
        catch (Exception ex) {
            return false;
        }
        return val;
    }

    // path: "roster[0].name"
    public Object get(JSONObject obj, String path) {
        if (obj == null || path == null) {
            return null;
        }
        path = path.trim();
        if (path.isEmpty()) { return null; }
        int index = path.indexOf('.');
        if (index > 0) {
            String key = path.substring(0, index).trim();
            path = path.substring(index + 1).trim();
            JSONObject inner = (JSONObject)get(obj, key);
            return get(inner, path);
        }
        else if (path.endsWith("]")) {
            int arrayIndex = -1;
            int open = path.indexOf('[');
            int close = path.indexOf(']');
            if (open > 0 && close > 0 && (close - open) > 1 && close == path.length() - 1) {
                try {
                    arrayIndex = Integer.parseInt(path.substring(open + 1,  close));
                }
                catch (Exception ex) {
                    arrayIndex = -1;
                }
            }
            if (arrayIndex >= 0) {
                path = path.substring(0, open).trim();
                JSONArray array = (JSONArray)obj.get(path);
                if (array != null && array.size() > arrayIndex) {
                    return array.get(arrayIndex);
                }
                else {
                    return null;
                }
            }
            else {
                // path is key
                return obj.get(path);                    
            }            
        }
        else {
            // path is key
            return obj.get(path);
        }        
    }
} 
```

# actionscript-3 - ActionScript 3 - 声音文件与。以编程方式创建的声音

> ID：11564540
> 
> 赞同：3
> 
> 时间：2012-07-19T15:48:56.217
> 
> 标签：actionscript-3, audio

对于基本的声音，例如正弦波或白噪声，这被认为是处理器密集度较低的：循环 .mp3 文件或以编程方式创建声音？

我的第一个想法是循环播放 .mp3 必须比编写声音更少涉及，但在阅读了[文档](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/media/Sound.html)并考虑到这些声音的原始性质后，我不太确定。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:26:55.937

在 adobe 网站上有一篇关于声音处理的有据可查的文章：http: [//www.adobe.com/devnet/flash/articles/dynamic_sound_generation.html](http://www.adobe.com/devnet/flash/articles/dynamic_sound_generation.html)

这显然取决于您的需求，但循环播放 mp3 非常容易。即使可行，生成声音并循环播放似乎也有点复杂。

顺便说一句，如果您循环播放 mp3，那么使用适当的软件调整 mp3 会容易得多。只需重新编译，更新的 mp3 就会正确播放。

M。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T17:31:38.123

对于比方波更有趣的大多数声音，每个未压缩声音样本的 CPU 指令数量通常远少于通过算法生成样本的数量，尤其是在涉及动作脚本解释器和浮点数学的情况下。

# jquery - 带有尖角的矩形边框样式

> ID：11564544
> 
> 赞同：0
> 
> 时间：2012-07-19T15:49:03.267
> 
> 标签：jquery, css

小提琴下方的边框在 Firefox 上是弯曲的，如何更新这个 css 使其具有尖角的矩形？我尝试将 css 更新为“border: 1px solid #CCC !important;”

[http://jsfiddle.net/3Uz7S/](http://jsfiddle.net/3Uz7S/)

```
<script type="text/javascript" charset="utf-8" src="http://static.polldaddy.com/p/6343621.js"></script>

.pds-box {
    border: 1px solid #CCC !important; 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:51:37.903

您需要在代码中覆盖边界半径，`border-radius`并`-webkit-border-radius`设置为`12px`：

```
.pds-box {
    border: 1px solid #CCC !important; 
    border-radius:0 !important;
    -webkit-border-radius:0 !important;
}​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T15:52:28.020

将`border-radius`标签添加到 CSS。

```
.pds-box {
    border: 1px solid #CCC !important;
    border-radius: 0px !important;
}​ 
```

# reporting - Salesforce：查找有多少记录具有重复值

> ID：11564546
> 
> 赞同：0
> 
> 时间：2012-07-19T15:49:13.113
> 
> 标签：reporting, salesforce, validation

我正在将一个字段更改为唯一的，但目前某些帐户在该字段中具有相同的值。

如何计算当前有多少字段在该字段中具有非唯一值？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T17:06:50.280

您可以运行 SOQL 聚合查询来查找不唯一的值，例如

```
select name from account group by name having count(name) > 1 
```

[编辑] 您还可以计算每个值，例如，这将显示每个非唯一值有多少行。

```
select name, count(id) num from account group by name having count(name) > 1 
```

# c# - 带有自定义文本块的 PNG 或 JPEG

> ID：11564548
> 
> 赞同：1
> 
> 时间：2012-07-19T15:49:18.167
> 
> 标签：c#, png, jpeg, exif

我通常喜欢问更精确的问题，但在这个问题中我还没有找到任何好的开始。

用 C# 编写，我正在尝试向图像添加一个大的自定义文本块，并使用 JPEG 或 PNG 保存它。我发现了很多关于使用 Comments 或 UserComments 标签的例子，它们在文本相对较短的情况下起作用。在我的情况下，我需要添加潜在的大块文本，假设最多 256K。我找到了对“自定义块”的引用，但我找不到任何关于如何从 C# 编写和读取它们的好指针，而无需编写完整的自定义 JPG 或 PNG 编码器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:12:22.650

我不确定 JPG，但 PNG 具有分块格式，因此应该很容易将自定义块添加到（编写良好的）现有解码器将忽略的文件中。该块可以包含您要放入其中的任何数据。

您也不需要编写完整的 PNG 解码器，只需查找您的自定义块并读/写它。

编辑：[JPEG 使用分段](http://class.ee.iastate.edu/ee528/Reading%20material/JPEG_File_Format.pdf)（参见第 2 页）来分隔文件。根据我的研究，我没有看到任何添加自定义片段的方法 - 但可以使用未使用的片段 ID（将被解码器跳过），如 JPG0、JPG13、DHP、EXP 或其他。您甚至可以将数据拆分到多个块中以增加存储空间（正如@BitBank 所指出的那样）。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-21T03:11:04.487

你也可以试试[这个库](http://code.google.com/p/pngcs/)，它允许读/写所有标准块（包括三个文本块）。[此处](http://code.google.com/p/pngcs/wiki/Overview)的最后一个示例创建了一个文本块。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T16:08:28.773

作为最简单、基本的想法（例如'dirty hack'）：您不必“编写一个完整的自定义 JPG 或 PNG 编码器”。您可以像往常一样保存，然后打开文件，将“自定义块”中的内容放入并保存。

您可能需要解析一些 JPG/PNG 标头信息以了解可以放置块的偏移量，甚至可能需要使用新偏移量更新一些标头，但总而言之，这可能不是像编写一个完整的编码器一样工作。

请注意：我**不**推荐这种方法，但如果所有其他选项工作量太大、太复杂或其他任何选项，那么至少这是一个可以考虑的选项。另外，我不知道这一点，但是这两种格式实际上*可能*甚至不支持如此“大”的“非图像数据”块。

如果您的应用程序是唯一使用图像的应用程序，您可以简单地考虑以您自己的“格式”“包装”原始文件（可以是从包含图像+文本作为单独文件的 zip/gz 流到单个文件的任何内容可以是您自己的自定义文件格式）

# .htaccess - 如何在 .htaccess 中重写此 URL？

> ID：11564552
> 
> 赞同：0
> 
> 时间：2012-07-19T15:49:26.073
> 
> 标签：.htaccess, webserver

如何用 .htaccess 重写原始 URL？

例子 ：

原始 URL = **www.mydomain.com/en/specialroom.php**

重写为 = **www.mydomain.com/en/roomspecial/**

之前谢谢，最好的问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T16:21:53.640

```
RewriteEngine On
RewriteRule ^en/roomspecial/$ /en/specialroom.php [L] 
```

# c# - 如何将一组数字添加到列表中的特定索引 ?

> ID：11564553
> 
> 赞同：-1
> 
> 时间：2012-07-19T15:49:29.677
> 
> 标签：c#

```
int numberofframesX = 0;
int numberofframesY = 0;
string framesX = "";
string framesY = "";
string X = "";
string Y = "";
string t = path + "\\" + fileName;
OptionsFile setting_file = new OptionsFile(t);
string XX = setting_file.GetKey("Number Of Frames X");
string YY = setting_file.GetKey("Number Of Frames Y");
numberofframesX = Convert.ToInt32(XX);
numberofframesY = Convert.ToInt32(YY);    

for (int i = 1; i < numberofframesX ; i++)
{
    X  = string.Format("Frame_X_{0} ", i);
    framesX = setting_file.GetKey(X);
    List<string> floatStrings = new List<string>(framesX.Split(new char[] { ',' }));
    List<float> test = new List<float>(  floatStrings.Select(tempStr => (float)Convert.ToDouble(tempStr)).ToList()); 
    wo1.woc.Point_X = test; 
} 
```

我需要按照我的问题底部下面链接中的两个图像中显示的内容进行操作。woc index [0] 有两个浮点列表我需要在 Point_X 中将每个数字添加到 Point_X 中的索引中，例如第 1 帧是 Frame_X_1 所以右边的数字应该添加到 Point_X 索引然后在 woc[1] Frame_X_2 等等.....

这是文本文件（setting_file）

```
Frame_X_1 =323,332,322,332
Frame_Y_1 =206,212,218,203
Frame_X_2 =323,332,318,332
Frame_Y_2 =206,212,269,203
Frame_X_3 =323,332,318,332
Frame_Y_3 =206,212,269,203
Frame_X_4 =323,332,318,332
Frame_Y_4 =206,212,269,203
Frame_X_5 =323,332,318,332
Frame_Y_5 =206,212,269,203
Frame_X_6 =323,332,318,332
Frame_Y_6 =206,212,269,203
Frame_X_7 =323,332,318,332
Frame_Y_7 =206,212,269,203
Frame_X_8 =323,332,318,332
Frame_Y_8 =206,212,269,203
Number Of Frames X=4
Number Of Frames Y=4 
```

这是 woc WireObjectCoordinates 类的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace AnimationEditor
{
    class WireObjectCoordinates
    {
        public List<float> Point_X = new List<float>();
        public List<float> Point_Y = new List<float>();

        public WireObjectCoordinates()
        {
        }

        public WireObjectCoordinates(WireObjectCoordinates w)
        {
            Point_X.AddRange(w.Point_X);
            Point_Y.AddRange(w.Point_Y);
        }

        public void Set(WireObjectCoordinates w)
        {
            for (int i = 0; i < Point_X.Count; i++)
            {
                Point_X[i] = w.Point_X[i];
                Point_Y[i] = w.Point_Y[i];
            }
        }
    }
} 
```

以及 setting_file(OptionsFile) 类中的 GetKey 函数：

```
/*----------------------------------------------------------
 * Function     : GetKey
 * Description  : gets the value of the key.
 * Parameters   : key
 * Return       : value of the key if key exist, null if not exist
 * --------------------------------------------------------*/
    public string GetKey(string key)
    {

      //  string value_of_each_key;
        string key_of_each_line;
        string line;
        int index;
        string key_value;
        key_value = null;

        sr = new StreamReader(Options_File);
        while (null != (line = sr.ReadLine()))
        {

            index = line.IndexOf("=");

           //    value_of_each_key = line.Substring(index+1);

            if (index >= 1)
            {
                key_of_each_line = line.Substring(0, index);
                if (key_of_each_line == key)
                {
                    key_value = line.Substring(key.Length + 1);
                }

            }
            else
            {
            }

        }
        sr.Close();
        return key_value;
    } 
```

我现在添加了两张关于 WOC 和 Point_X 和 Point_Y 的图像：

[http://imageshack.us/photo/my-images/515/imag0649b.jpg/](http://imageshack.us/photo/my-images/515/imag0649b.jpg/) http://imageshack.us/photo/my-images/23/imag0648me.jpg/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:53:59.197

Sounds like you want to use a `List<List<float>>`. Or if your sets of floats are fixed, you could probably use `List<float[]>`

# macos - 如何克服 Homebrew Git 冲突？

> ID：11564554
> 
> 赞同：3
> 
> 时间：2012-07-19T15:49:28.880
> 
> 标签：macos, git, homebrew

我安装了[Homebrew](https://brew.sh/)。“brew --prefix”是/usr/local。我现在错误地对本地 Brew Git 存储库的主分支做了一些与“brew update”无休止的冲突的事情。我想丢弃或忽略我的本地更改。通常我只是 rm -rf repo 并重新克隆，但我不认为 rm -rf /usr/local 是明智的。

如何让我的本地 Brew Git 存储库满意？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-19T15:54:53.190

`git reset --hard origin/master`应该使所有内容与主 Homebrew Git 存储库同步。它会丢弃您对 repo 中跟踪的文件所做的任何本地更改。

# java - Spring远程服务集成测试。码头与 AbstractTestNGSpringContextTests

> ID：11564556
> 
> 赞同：1
> 
> 时间：2012-07-19T15:49:32.547
> 
> 标签：java, spring, integration-testing, embedded-jetty

我正在通过 HTTPInvoker 进行 Spring 远程服务。我想为此编写集成测试，我想到了两种技术，我不确定哪一种更好，或者我完全误解了这两种技术。

我对这两种技术有点困惑。一种技术是 Spring 已经能够在测试之前加载上下文，所以我可以只指定上下文 xml。另一种技术是让 Embedded Jetty 加载上下文，我们还有另一个测试来命中端点。我不确定哪个更好。

我从这里得到了嵌入式 Jetty 测试的想法。[http://code.google.com/p/jianwikis/wiki/SpringHttpRemotingWithEmbeddedJettyServer](http://code.google.com/p/jianwikis/wiki/SpringHttpRemotingWithEmbeddedJettyServer)

另一种方法是将其包含在测试用例中。例如，

```
 @ContextConfiguration(location = {"/application_context.xml"})
public class SpringIntegrationTest extends AbstractTestNGSpringContextTests {

   @Autowired
   private TheService theService
   ...
} 

```

两者都做的好处和坏处是什么？

非常感谢。

# android - JSON 和 HTTP POST 出现 400 错误

> ID：11564558
> 
> 赞同：2
> 
> 时间：2012-07-19T15:49:40.007
> 
> 标签：android, json, http-post, httpclient

我试图通过 HTTPPost 发送 JSONObject，但是现在我收到 400 错误。

我一直在使用服务器编码器，并使用不太复杂的 JSON 对象进行更小更简洁的调用，但是我仍然收到相同的 400 错误。

我该如何修复它？

```
import java.io.IOException;
import java.io.UnsupportedEncodingException;

import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.entity.ByteArrayEntity;
import org.apache.http.entity.StringEntity;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.message.BasicHeader;
import org.apache.http.params.BasicHttpParams;
import org.apache.http.params.HttpConnectionParams;
import org.apache.http.params.HttpParams;
import org.apache.http.protocol.HTTP;
import org.apache.http.util.EntityUtils;
import org.json.JSONException;
import org.json.JSONObject;

import android.app.Activity;
import android.app.ProgressDialog;
import android.os.AsyncTask;
import android.os.Bundle;
import android.util.Log;
import android.view.Menu;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;
import android.widget.Toast;

public class LoginScreen extends Activity {

    private Button loginButton;
    private TextView resultText;
    private EditText usernameText;
    private EditText passwordText;
    private EditText switchChoice;
    private EditText installText;
    private int i;
    private String accessURL = "URL";
    private String accessNEW = "";
    public final String CONSUMER_KEY = "KEY";
    public final String CONSUMER_SECRET = "SECRET";

    @Override
    public void onCreate(Bundle savedInstanceState) {
        // Create the screen + pull back the saved instance state
        super.onCreate(savedInstanceState);
        setContentView(R.layout.login_screen);

        // initialize the buttons and text view for usability in the later codes
        loginButton = (Button) findViewById(R.id.btn_login);
        resultText = (TextView) findViewById(R.id.lbl_result);
        usernameText = (EditText) findViewById(R.id.txt_username);
        passwordText = (EditText) findViewById(R.id.txt_password);
        installText = (EditText) findViewById(R.id.txt_install);
        switchChoice = (EditText) findViewById(R.id.txt_switch);

        // create the onclick listener for the login button to start the code to
        // login
        loginButton.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                try {
                    // pull data from EditText Boxes and create the JSON object
                    // to send information HTTP
                    String text = switchChoice.getText().toString();
                    i = Integer.parseInt(text);
                    JSONObject jOb = toJSON();
                    Log.d("JSONObjectCreation", jOb.toString());
                    // method to go through
                    processURL(jOb);
                } catch (JSONException e) {
                    e.printStackTrace();
                }
            }
        });
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.login_screen, menu);
        return true;
    }

    public JSONObject toJSON() throws JSONException {
        JSONObject credentials = new JSONObject();
        try {
            credentials.put("ConsumerSecret", CONSUMER_SECRET);
            credentials.put("ConsumerKey", CONSUMER_KEY);
            credentials.put("Password", "Sh0wT1me");
            credentials.put("Username", "sjones");

        } finally {
        }
        return credentials;
    }

    /*
     * Subclass that executes the connection and authentication to the server
     * using HTTPPost - Uses AsyncTask to execute the network connection on a
     * different thread
     * 
     * PARAMS: JSONObject -> input
     */
    private class PostTask extends AsyncTask<JSONObject, Integer, String> {
        // Dialog box to let user know that it is processing
        private ProgressDialog Dialog = new ProgressDialog(LoginScreen.this);

        // Before the execution of the background task, this is executed in the
        // main thread
        @Override
        protected void onPreExecute() {
            Dialog.setMessage("Logging In...");

            // forces the dialog to show in the main thread
            Dialog.show();
        }

        // done in background thread, so that the main thread is not jammed up
        // preventing user interface usage
        @Override
        protected String doInBackground(JSONObject... jObj) {
            int TIMEOUT_MILLISEC = 10000; // create timeout time of 10 seconds
            HttpParams httpParams = new BasicHttpParams();
            HttpConnectionParams.setConnectionTimeout(httpParams,
                    TIMEOUT_MILLISEC);
            HttpConnectionParams.setSoTimeout(httpParams, TIMEOUT_MILLISEC);

            // create a new httpClient with the httpParams of timeout time
            HttpClient client = new DefaultHttpClient(httpParams);
            String responseBody = null;
            try {

                HttpPost request = new HttpPost(accessURL); 

                switch (i) {
                case 1:
                    request.setEntity(new ByteArrayEntity(jObj.toString().getBytes("UTF8")));
                    Log.d("request_entity", request.getEntity().getContent().toString());
                case 2:
                     StringEntity params =new StringEntity("{credentials"+jObj.toString()+"}");
                        Log.i("String_Entity", params.toString());

                     request.addHeader("content-type", "application/json; charset=utf-8");
                     request.setEntity(params);
                case 3:
                    StringEntity se = new StringEntity("{credentials" + jObj.toString()+"}");  
                    Log.i("String_Entity", se.toString());
                    se.setContentEncoding("UTF-8");
                    se.setContentEncoding(new BasicHeader(HTTP.CONTENT_TYPE, "application/json"));
                    request.setEntity(se);
                case 4:

                }

                HttpResponse response = client.execute(request);
                int status = response.getStatusLine().getStatusCode();
                /*
                  switch (status) {
                    case 200:

                    HttpEntity entity = response.getEntity();
                    if (entity != null) {
                         responseBody = EntityUtils.toString(entity);
                    }
                    break;
                case 500:
                    responseBody = "500" + response.getStatusLine().getReasonPhrase();
                    break;
                }
                */
                String statusS = Integer.toString(status);
                Log.d("request_status", statusS);
                return statusS + " " +response.getStatusLine().getReasonPhrase();
                //return responseBody;
            } catch (UnsupportedEncodingException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (ClientProtocolException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                Log.e("log_tag", "Error in http connection " + e.toString());
                e.printStackTrace();
            }
            return null;
        }

        @Override
        protected void onPostExecute(String result) {
            resultText.setText(result);
            Dialog.dismiss();
            Toast.makeText(getApplicationContext(), "Value updated",
                    Toast.LENGTH_SHORT).show();
        }
    }

    public void processURL(JSONObject thing) {
        // execute connection on new thread
        new PostTask().execute(thing);
    }

} 
```

编辑：设置实体的开关部分在那里，因为我不确定错误是否来自我设置实体的方式，所以经过研究，我创建了一个开关，让我通过 JSONObject 可以使用的不同方法被编码到实体。

编辑：今天出现在我的 logcat 中：

```
07-19 11:13:27.812: W/ThrottleService(91): unable to find stats for iface rmnet0
07-19 11:15:18.862: A/NetworkStats(91): problem reading network stats
07-19 11:15:18.862: A/NetworkStats(91): java.lang.IllegalStateException: problem parsing line: null
07-19 11:15:18.862: A/NetworkStats(91):     at com.android.internal.net.NetworkStatsFactory.readNetworkStatsDetail(NetworkStatsFactory.java:313)
07-19 11:15:18.862: A/NetworkStats(91):     at com.android.server.NetworkManagementService.getNetworkStatsUidDetail(NetworkManagementService.java:1271)
07-19 11:15:18.862: A/NetworkStats(91):     at com.android.server.net.NetworkStatsService.performPollLocked(NetworkStatsService.java:810)
07-19 11:15:18.862: A/NetworkStats(91):     at com.android.server.net.NetworkStatsService.performPoll(NetworkStatsService.java:771)
07-19 11:15:18.862: A/NetworkStats(91):     at com.android.server.net.NetworkStatsService.access$100(NetworkStatsService.java:128)
07-19 11:15:18.862: A/NetworkStats(91):     at com.android.server.net.NetworkStatsService$3.onReceive(NetworkStatsService.java:610)
07-19 11:15:18.862: A/NetworkStats(91):     at android.app.LoadedApk$ReceiverDispatcher$Args.run(LoadedApk.java:728)
07-19 11:15:18.862: A/NetworkStats(91):     at android.os.Handler.handleCallback(Handler.java:605)
07-19 11:15:18.862: A/NetworkStats(91):     at android.os.Handler.dispatchMessage(Handler.java:92)
07-19 11:15:18.862: A/NetworkStats(91):     at android.os.Looper.loop(Looper.java:137)
07-19 11:15:18.862: A/NetworkStats(91):     at android.os.HandlerThread.run(HandlerThread.java:60)
07-19 11:15:18.862: A/NetworkStats(91): Caused by: java.io.FileNotFoundException: /proc/net/xt_qtaguid/stats: open failed: ENOENT (No such file or directory)
07-19 11:15:18.862: A/NetworkStats(91):     at libcore.io.IoBridge.open(IoBridge.java:406)
07-19 11:15:18.862: A/NetworkStats(91):     at java.io.FileInputStream.<init>(FileInputStream.java:78)
07-19 11:15:18.862: A/NetworkStats(91):     at java.io.FileReader.<init>(FileReader.java:42)
07-19 11:15:18.862: A/NetworkStats(91):     at com.android.internal.net.NetworkStatsFactory.readNetworkStatsDetail(NetworkStatsFactory.java:272)
07-19 11:15:18.862: A/NetworkStats(91):     ... 10 more
07-19 11:15:18.862: A/NetworkStats(91): Caused by: libcore.io.ErrnoException: open failed: ENOENT (No such file or directory)
07-19 11:15:18.862: A/NetworkStats(91):     at libcore.io.Posix.open(Native Method)
07-19 11:15:18.862: A/NetworkStats(91):     at libcore.io.BlockGuardOs.open(BlockGuardOs.java:98)
07-19 11:15:18.862: A/NetworkStats(91):     at libcore.io.IoBridge.open(IoBridge.java:390)
07-19 11:15:18.862: A/NetworkStats(91):     ... 13 more
: E/(): Device disconnected 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T18:32:44.923

将构造函数添加到 PostTask 类。我不认为你可以将 accessURL 作为全局变量传递给类。

尝试类似：

```
private class PostTask extends AsyncTask<JSONObject, Integer, String> {

    String accessURL;

    public PostTask(Context c, String accessURL) {
        this.accessURL = accessURL;
    }

} 
```

然后在您的 processURL 方法中执行以下操作：

```
new PostTask(this, accessURL).execute(thing); 
```

我希望这对你有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T18:40:49.390

我不太擅长整个 JSON，但应该

`StringEntity se = new StringEntity("{credentials" + jObj.toString()+"}");`

说

`StringEntity se = new StringEntity("{credentials: " + jObj.toString()+"}");`

?

编辑：也许在单词凭据周围引用。再说一次，我不擅长 JSON！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-27T16:43:04.977

一段时间后，我意识到错误来自 doInBackground 方法中的 jObj 变量。我将尽我所能描述错误，并根据我所看到的： protected String doInBackground(JSONObject... jObj) JSONObject 变量实际上不是 JSONObject，因为“... '，所以当我使用它时，`jObj.toString()`它返回了一些奇怪的非 JSONObject 外观的字符串，几乎就像它没有被编码一样。我会返回并跳过此处的字符串，但是我已经对代码进行了很多更改，以至于我不想冒险丢失它。

感谢大家的帮助！

# objective-c - NSOutlineView 中文件夹和子文件夹的对象模型

> ID：11564560
> 
> 赞同：2
> 
> 时间：2012-07-19T15:49:42.097
> 
> 标签：objective-c, cocoa, treeview

我的应用程序中有一个数据结构，其中包含作为**平面**数组结构的文件夹，如下所示

```
/FolderA/folderB
/FolderA
/FolderC/folderD
/FolderC
/FolderF 
```

等等。我想将此数据用作结构化*NSOutlineView的**数据源*。最终树应表示如下：

 *```
/FolderA/
    folderB
/FolderC/
    folderD
/FolderC
/FolderF 
```

经典的结构化树视图。

关于如何建模的任何想法？请记住，我的数据已经在我的应用程序中，并且存储在一个平面数组中。

谢谢你

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T15:51:25.883

查看 NSTreeController，并使用适当的 keyPaths 设置代表节点的模型。核心数据示例：http: [//jonathandann.wordpress.com/2008/05/13/nstreecontroller-and-core-data-sorted/](http://jonathandann.wordpress.com/2008/05/13/nstreecontroller-and-core-data-sorted/)*

# bison - 如何说服 Bison 解析文件的一部分？

> ID：11564563
> 
> 赞同：2
> 
> 时间：2012-07-19T15:49:45.157
> 
> 标签：bison, yacc

如果 a 有以下形式的输入文件：

```
BEGIN
  stuff....
END

BEGIN
  stuff ...
END 
```

我的 .y 文件的形式是

```
%token BEGIN
%token END
%start begin

begin:  BEGIN stuff END 
```

我想要做的是重复调用 yyparse，解析单个 BEGIN/END，直到 eof。

第一次调用 yyparse 报告：

```
syntax error, unexpected BEGIN, expecting $end. 
```

这是有道理的；bison 想要解析整个文件。有没有办法让野牛在 $end 的定义中更加灵活？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T17:41:03.280

最简单的方法是在 .y 文件的顶部添加（一对）产品：

```
input: begin | input begin; 
```

现在 yyparse 将解析多个输入。如果你真的想多次调用 yyparse ，你可能会逃脱：

```
begin: BEGIN stuff END { YYACCEPT; } ; 
```

`YYACCEPT`是一个特殊的内置函数，它会导致 yyparse 立即返回 0（在进行任何需要的内部清理之后）。我说“可能”，因为这只有在野牛`begin`通过默认减少（无前瞻）减少时才有效。如果这是唯一的规则`begin`并且`begin`不用于识别它需要前瞻的上下文中，情况就会如此。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T17:40:29.213

将此添加到您的语法中：

```
all_begins: begins
          ;

begins: begins begin
      | begin
      ; 
```

将 %start 替换为：

```
%start all_begins 
```

只需调用一次 yyparse() 即可。

# sql - Oracle SQL 触发器

> ID：11564566
> 
> 赞同：-1
> 
> 时间：2012-07-19T15:49:58.480
> 
> 标签：sql, oracle, triggers

我是 Oracle 和 SQL 的新手，我正在尝试创建一个触发器，其中 req_ship_date（子订单表）不能在 order_date（customer_order 表）之前。我创建了触发器：

```
create or replace trigger req_ship_date_error
before insert on suborder
for each row
declare
placed_date date;
req_date date;
begin
select order_date into placed_date
from customer_order;
select req_ship_date into req_date
from suborder
where suborder_no = :new.suborder_no;
if placed_date > req_date then
raise_application_error(-20002, ('Order ' || :new.suborder_no || ' required shipping date cannot be before order date'));
end if;
end; 
```

但即使在尝试插入一个好的语句之后，我也会收到以下错误

```
insert into suborder
values  ( 8, 2, '10-jul-2012', '12-jul-2012', 'CVS', 2); 
```

错误

```
 Error starting at line 1 in command:
insert into suborder
    values  ( 8, 2, '10-jul-2012', '12-jul-2012', 'CVS', 2)
Error report:
SQL Error: ORA-01422: exact fetch returns more than requested number of rows
ORA-06512: at "COMPANY.REQ_SHIP_DATE_ERROR", line 5
ORA-04088: error during execution of trigger 'COMPANY.REQ_SHIP_DATE_ERROR'
01422\. 00000 -  "exact fetch returns more than requested number of rows"
*Cause:    The number specified in exact fetch is less than the rows returned.
*Action:   Rewrite the query or change number of rows requested 
```

知道是什么原因造成的吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:55:35.533

您在第一个触发器的 SELECT 查询**中缺少 where 子句：**

```
 select order_date into placed_date
  from customer_order; 
```

将返回许多行，因此 Oracle 不知道从哪一个中选择日期（将其放在`placed_date`变量中）。`INTO`子句总是需要一行。

添加 where 子句以便返回单个结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T16:25:53.753

*   正如@Shine 指出的那样，您需要`WHERE`在查询中添加一个子句`CUSTOMER_ORDER`
*   `SUBORDER`然后无法查询的行级触发器`SUBORDER`。如果你这样做，你最终会得到一个变异表错误。但是，假设这`SUBORDER_NO`是 的主键`SUBORDER`，您不需要查询该表。只需使用`:new.req_ship_date`您手中的价值。

假设主键`customer_order`is`order_no`并且`order_no`存在于`suborder`表中，这样的事情应该可以工作。

```
create or replace trigger req_ship_date_error
  before insert on suborder
  for each row
declare
  l_placed_date date;
begin
  select order_date 
    into l_placed_date
    from customer_order
   where order_no = :new.order_no;
  if l_placed_date > :new.req_ship_date 
  then
    raise_application_error(
      -20002, 
      'Order ' || :new.suborder_no || ' required shipping date cannot be before order date');
  end if;
end; 
```

# c# - 任务 .net4 和 windows 服务停止

> ID：11564572
> 
> 赞同：2
> 
> 时间：2012-07-19T15:50:19.867
> 
> 标签：c#, .net-4.0, task

我有一个具有任务的 Windows 服务，这些任务运行并行 foreach 来处理一些图像。

我现在需要做的是让服务 onstop 方法允许任务完成对已经在进行中的项目的处理，但不允许任何新项目开始。

以下是我的一些代码片段，以显示我所拥有的：

```
if (recordsToProcess != null && recordsToProcess.Any())
        {
            if (!_cancellationTokenSource.Token.IsCancellationRequested)
            {
                Parallel.ForEach(recordsToProcess, new ParallelOptions { MaxDegreeOfParallelism = MaxParallelThreadSetting }, currentRecord => _Processor.Process(currentRecord, _supportedFileTypes));
            }

            Task.WaitAll(); //Recently added not sure if needed
        }

 protected override void OnStop()
    {
        //Sets the cancel flag to stop the processing
        _cancellationTokenSource.Cancel();
        //Allows existing threads to complete
        _logHandler.LogInfoMessage("Waiting On Cancel");
        Task.WaitAll();

        //Stop service and tidy up resources
        _logHandler.LogInfoMessage("Stopping service");
        base.OnStop();
} 
```

如您所见，我正在停止添加要处理的新项目，但我仍然认为服务在一切完成之前停止。

有任何想法吗？？

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:53:52.700

您需要调用[ParallelLoopState.Stop](http://msdn.microsoft.com/en-us/library/system.threading.tasks.parallelloopstate.stop.aspx)来阻止处理任何新记录。有关详细信息，请参阅[如何：从 Parallel.For 循环停止或中断](http://msdn.microsoft.com/en-us/library/dd460721.aspx)。

# iphone - Obj-C - 添加“跳过备份”属性总是失败

> ID：11564573
> 
> 赞同：0
> 
> 时间：2012-07-19T15:50:23.770
> 
> 标签：iphone, objective-c, ios, icloud

我似乎无法从我的代码中获取备份属性参数。无论我似乎在做什么，该方法都会返回 false 并带有“未知错误 -1”。我已经尝试过跳过备份方法的不同迭代，但下面是我正在使用的最新版本，基于我发现的另一篇文章：

```
- (BOOL)addSkipBackupAttributeToItemAtURL:(NSURL *)URL
{
    const char* filePath = [[URL path] fileSystemRepresentation];
    const char* attrName = "com.apple.MobileBackup";
    if (&NSURLIsExcludedFromBackupKey == nil) {
        // iOS 5.0.1 and lower
        u_int8_t attrValue = 1;
        int result = setxattr(filePath, attrName, &attrValue, sizeof(attrValue), 0, 0);
        return result == 0;
    } else {
        // First try and remove the extended attribute if it is present
        int result = getxattr(filePath, attrName, NULL, sizeof(u_int8_t), 0, 0);
        if (result != -1) {
            // The attribute exists, we need to remove it
            int removeResult = removexattr(filePath, attrName, 0);
            if (removeResult == 0) {
                NSLog(@"Removed extended attribute on file %@", URL);
            }
        }

        // Set the new key
        return [URL setResourceValue:[NSNumber numberWithBool:YES] forKey:NSURLIsExcludedFromBackupKey error:nil];
    }
} 
```

我对该方法的调用如下所示（在运行时它总是打印“不成功”）：

```
if ([self addSkipBackupAttributeToItemAtURL:[NSURL fileURLWithPath:filePath]]) {
    NSLog(@"success!");
} else {
    NSLog(@"not successful");
} 
```

filePath 是文档文件夹图像的 NSString 路径。我记录了一个图像路径的示例，如下所示：

/var/mobile/Applications/B3583D06-38BC-45F0-A027-E79997F0EC60/Documents/myImage.png

在我的应用程序中，它循环遍历我推出的所有（大量）文件，并添加了这个属性。它对他们每个人都失败了。由于这些动态驱动的文件对离线功能的严格要求，我需要能够使其正常工作。我没有看到很多其他人遇到这个问题，所以这告诉我我可能在这里遗漏了一些明显的东西，哈哈。

我找到了这篇文章：[使用此代码从 iCloud 备份中排除文件后，为什么我的应用程序仍然被拒绝？](https://stackoverflow.com/questions/10588652/why-was-my-application-still-rejected-after-excluding-files-from-icloud-backup-u)

对于我的问题可能是什么，这看起来很有希望，但实际上并没有任何关于如何具体解决的细节（它只是建议使用 /Library 而不是 docs 文件夹？）。

提前感谢任何可以提供帮助的人！-文森特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T15:48:28.570

为了解决这个问题，我最终只需要在 /Documents 目录中创建一个文件夹，然后我更改了应用程序以将所有文件指向该子文件夹。

因此，在我的 AppDelegate 中，在预先加载任何内容之前，我添加了如下代码：

```
NSString *tempDir = [documentsDirectory stringByAppendingString:@"/tempfiles"];
[[NSFileManager defaultManager] createDirectoryAtPath:tempDir
                      withIntermediateDirectories:NO
                                       attributes:nil
                                            error:nil];
NSURL *tempDirPathURL = [NSURL URLWithString:tempDir];
if ([[MainControl controlSystem] addSkipBackupAttributeToItemAtURL:tempDirPathURL]) {
        NSLog(@"did add attribute!");
} else {
    NSLog(@"adding attribute failed! :(");
} 
```

当我这样做时，它实际上进入了“确实添加属性”日志语句，没有任何问题！我不知道为什么这在单个文件级别不起作用，但至少这是有效的，而且它实际上是一个更好的解决方案，因为现在我不必遍历数百个文件来添加属性，我只必须将其添加到一个地方。

# javascript - 用于 Google Analytics API 的 jQuery AJAX 标头身份验证

> ID：11564580
> 
> 赞同：1
> 
> 时间：2012-07-19T15:50:47.087
> 
> 标签：javascript, jquery, google-analytics, basic-authentication, google-analytics-api

我正在构建一个仪表板，它将从 GA 中提取数据。为此，我需要通过 Google Accounts 获取访问令牌，然后我需要使用包含此经过身份验证的令牌的标头查询 GA。

这是我的代码：

```
$.ajax({
    async: false,
    url: "https://www.google.com/accounts/ClientLogin?accountType=GOOGLE&Email=EMAIL&Passwd=PASSWORD&service=analytics",
    success : function(data) {
        var auth = data.substring(data.indexOf("Auth=") + 5);
        console.log(auth);
        $.ajax({
            type: 'get',
            headers: {
                "Content-type": "application/x-www-form-urlencoded",
                "Authorization": "GoogleLogin Auth=" + auth,
                "GData-Version": "2",
            },
            url: "https://www.google.com/analytics/feeds/data?ids=ga:PROFILE&start-date=2011-08-16&end-date=2012-06-16&max-results=10000",
       });
    }
}); 
```

不幸的是，这种方法不起作用。如果有人能告诉我如何让这个工作或更好的方法来验证这些请求，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-22T00:59:29.430

它不起作用，因为[ClientLogin](https://developers.google.com/accounts/docs/AuthForInstalledApps#Request) 需要一个`post`请求而不是`get`. 它也已被[弃用](https://developers.google.com/accounts/docs/AuthForInstalledApps)。

您似乎也违反了ajax 请求[的同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)。

使用[带有刷新令牌的 OAuth 2 版本](https://developers.google.com/accounts/docs/OAuth2WebServer#offline)。您可以使用站点上的[客户端库](https://developers.google.com/accounts/docs/OAuth2WebServer#libraries)之一并将 ajax 请求发布到您自己的页面。

# php - PHP 中的持久数据库连接

> ID：11564581
> 
> 赞同：1
> 
> 时间：2012-07-19T15:50:52.520
> 
> 标签：php, mysql, pdo, mysqli, persistent-connection

我对 PHP 中的持久数据库连接有一些疑问。

我知道使用持久连接会很有效，因为需要与同一主机/用户建立连接的每个 PHP 进程都可以共享该连接，而无需重新建立连接。

我不明白最新的实现引入了克服未知连接状态问题的功能。

**但！**如果我有 10,000 个进程共享同一个连接，这将降低我的应用程序的性能，因为它们一次只能使用一个连接！这是真的还是我错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:17:52.347

如果您实际上有 10k 个进程查询数据库，则持久连接（特别是在建立连接时）提供的效率优势将是巨大的。

假设您在 Apache 下运行 PHP，第一次建立 SQL 连接时，Apache“子进程”将保持打开状态（即持久连接）。如果连接信息当然相同，则属于该特定“Apache 子进程”的所有 PHP 请求都将重用该连接。Apache 的配置定义了单个子进程在重新启动之前可以处理多少个请求——这应该清除持久连接。

现在，还有一种情况是您正在循环运行查询，甚至——我敢说是无限循环。在这种情况下，即使是非持久连接也是致命的。

令人怀疑的是，使用持久连接的进程数量是否会成为服务器效率的一个因素（除非，正如我所提到的，您有一些使用查询的低效代码）。应该关注的是您应该允许多少个持久连接以及您的数据库/服务器可以处理多少个？

持久连接的 MySQL 手册[http://php.net/manual/en/features.persistent-connections.php](http://php.net/manual/en/features.persistent-connections.php)也涵盖了我刚刚总结的大部分（以及更多）内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T16:13:16.307

在任何情况下，使用持久连接都会更快，因为您节省了建立连接的开销。

使用持久连接不会将您限制为单个连接，您可以拥有一个包含 100 或 1000 个持久连接的连接池。

处理 10000 个并行查询也需要一些负载平衡和数据库集群，但是，如果您尝试同时通过它推送 10k 个查询，单个数据库将因非持久连接和持久连接而过载。

# android - 如何隐藏/加密/混淆我的 Android 应用程序中使用的直接 URL？

> ID：11564583
> 
> 赞同：0
> 
> 时间：2012-07-19T15:50:55.717
> 
> 标签：android

问题是 - 我开发了一个 Android 应用程序，该应用程序将根据不同的用户输入 HTTP 访问我的 Web 服务器。我的问题是 - 无论如何要在我的应用程序中隐藏硬编码的 URL，如果有人对这个代码进行逆向工程会混淆吗？

问题是 - 如果有人对他/她可以作为 URL 向我的其他客户提出问题的代码进行逆向工程，则参数是硬编码的。

这对我来说真的很紧急。寻求有关此主题的帮助。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T16:19:48.807

在您的应用程序中完全混淆字符串资源（例如 URL）是[不可能的。](https://groups.google.com/forum/#!topic/android-developers/quD5gYIZ4Ig/discussion)任何人都可以反编译您的应用程序，只要有足够的时间，就可以在您的应用程序中重建任何硬编码字符串 (URLS)。

与其依赖 URLS 的匿名性，不如将时间花在保护服务器上，以免未经授权的客户端难以与之交互。即使你有完美的字符串混淆保护你的服务器仍然是至关重要的。有多种方法可以发现隐藏的 url。例如，对我来说，设计一个[中间攻击](http://en.wikipedia.org/wiki/Man-in-the-middle_attack)的人来查看我的手机连接到哪些服务器是微不足道的。一个简单的网络爬虫也可以做到这一点。

# css - 如何使 B 相对于 A 固定

> ID：11564586
> 
> 赞同：0
> 
> 时间：2012-07-19T15:51:01.443
> 
> 标签：css

B 与 A 的内容一起滚动。我希望它保持固定，即不与 A 的内容一起滚动。我该怎么做？“A”也是一个块，“B”在“A”内。

![定位问题描述](../Images/f5a204363a4a8919831a19bb83f2d2be.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T15:54:04.800

使用`position:fixed;`CSS 标记。

```
div#b {
    position: fixed;
    top: 0px;
    right: 0px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T15:53:34.090

尝试使用`position:fixed`而不是`position:absolute`

# c# - 需要从空格分隔的字符串中的特定位置删除特定引号，同时保留其他引号

> ID：11564592
> 
> 赞同：3
> 
> 时间：2012-07-19T15:51:17.197
> 
> 标签：c#, windows, string, command-line

我有一个在 C# 中运行的 Windows 命令行程序，它读取服务器上的日志文件。日志文件以空格分隔（我们无法更改）包含类似于以下内容的记录：

```
74.57.205.141 - - [30/Mar/2012:00:03:04 +0000] "GET /7/961/148606/v1/00.akacast.akamaistream.net/00-radio-128" 200 1758815 "-" "iTunes/10.5.3 (Windows; Microsoft Windows 7 x64 "R2" Business Edition Service Pack 1 (Build 7601)) AppleWebKit/534.52.7"  102 
```

该行开始读取“/iTunes 是用户代理字符串的开头。它应该一直到 AppleWebKit/534.52.7 并在那里结束。问题是对于某些用户代理字符串，流氓引用会插入到用户代理字符串中。在示例中，该流氓引号是**"R2"**。

不过，它并不总是 R2，其他一些代理字符串也可以加上一个额外的引号，所以我不能只找到并用 R2 替换“R2”。

我能够在有效字符串中提出的模式是始终有 6 个引号，每个偶数引号后面都有一个空格。

第 1 引号 - 开始字符串 第 2 引号 - 结束字符串，后面有空格 第 3 引号 - 开始字符串 第 4 引号 - 结束字符串，后面有空格 第 5 引号 - 开始字符串 第 6 引号 - 结束字符串，后面有空格

无效字符串将始终遵循此模式。

第 1 引号 - 起始字符串 第 2 引号 - 结束字符串，后面有空格 第 3 引号 - 起始字符串 第 4 引号 - 结束字符串，后面有空格 第 5 引号 - 起始字符串 第 6 引号 - 结束字符串，第 7 引号后面没有空格 - 起始字符串 第 8 引号 - 结束字符串空间跟随

我需要的是搜索字符串以沿着引号位置查找该无效模式并从第 6 和第 7 位置删除引号的方法。我在想一个好的正则表达式可能会起作用，但我对它们不是很好，还没有想出任何可行的方法，更不用说正则表达式不会从第 6 位和第 7 位删除这些引号。

***编辑***

这可能过于简单，但我能够通过一些索引操作来解决我的特定问题。不幸的是，我无法让正则表达式解决方案为我工作:(

工作代码：

```
string str = "74.57.205.141 - - [30/Mar/2012:00:03:04 +0000] \"GET /7/961/148606/v1/00.akacast.akamaistream.net/00-radio-128\" 200 1758815 \"-\" \"iTunes/10.5.3 (Windows; Microsoft Windows 7 x64 \"R2\" Business Edition Service Pack 1 (Build 7601)) AppleWebKit/534.52.7\"  102";

int[] indexes = Enumerable.Range(0, str.Length).Where(x => str[x] == '"').ToArray();

            if (indexes.Length > 6)
            {
                //need to remove extra quotes from the 6th position and 7th position.
                //remove the 7th position first to prevent the index from changing on the quotes we need to remove.
                str = str.Remove(indexes[6], 1).Remove(indexes[5], 1);
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T16:31:59.677

您可以使用正则表达式来检测带有附加引号的字符串：

```
(.+)(\s*".+"\s*)(.+)(\s*".+"\s*)(\s*".+"\s*)(.*)(\s*".+"\s*)(.+) 
```

这将只匹配字符串，如

```
UnquotedStart"QuotedText1" UnquotedText "QuotetText2" "QuotetText3" ROUGETEXT "QuotetText4"   UnquotetEnd 
```

您现在可以从匹配组中重建正确的字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T16:08:53.110

这个怎么样：

```
".*?".*?".*?".*?"(.*)" 
```

基本符合

```
[ignore beginning]
[First Quote Pair]
[AnythingInBetween]
[Second Quote Pair]
[AnythingInBetween]
[Quote]
GROUPS YOUR FINAL STRING HERE until
[LastQuote in the line] 
```

然后，您可以删除任何内部引号。

这是有效的，因为它对前两个引号对使用非贪婪正则表达式，然后对最终引号匹配使用贪婪正则表达式，因此最终匹配将忽略所有引号，直到达到最终引号。

# c++ - C++ 执行 CMD 命令

> ID：11564594
> 
> 赞同：17
> 
> 时间：2012-07-19T15:51:19.167
> 
> 标签：c++, windows, winapi, cmd, windows-console

我这里有一个严重的问题。我需要在不显示控制台窗口的情况下通过 C++ 执行 CMD 命令行。因此我不能使用`system(cmd)`，因为窗口会显示。

我试过了`winExec(cmd, SW_HIDE)`，但这也不起作用。`CreateProcess`是我试过的另一个。但是，这是用于运行程序或批处理文件。

我最终尝试了`ShellExecute`：

```
ShellExecute( NULL, "open",
    "cmd.exe",
    "ipconfig > myfile.txt",
    "c:\projects\b",
    SW_SHOWNORMAL
); 
```

任何人都可以看到上面的代码有什么问题吗？我一直使用`SW_SHOWNORMAL`，直到我知道这是有效的。

我真的需要一些帮助。什么都没有曝光，我已经尝试了很长时间。任何人都可以提供的任何建议都会很棒:)

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-19T17:33:36.710

将输出重定向到您自己的管道是一个更简洁的解决方案，因为它避免了创建输出文件，但这很好用：

```
ShellExecute(0, "open", "cmd.exe", "/C ipconfig > out.txt", 0, SW_HIDE); 
```

您看不到 cmd 窗口，并且输出按预期重定向。

您的代码可能失败（除了`/C`事情），因为您将路径指定为`"c:\projects\b"`而不是`"c:\\projects\\b"`.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-03-11T08:28:05.780

这是我对 DosExec 函数的实现，它允许（静默）执行任何 DOS 命令并将生成的输出检索为 unicode 字符串。

```
// Convert an OEM string (8-bit) to a UTF-16 string (16-bit) 
#define OEMtoUNICODE(str)   CHARtoWCHAR(str, CP_OEMCP)

/* Convert a single/multi-byte string to a UTF-16 string (16-bit).
 We take advantage of the MultiByteToWideChar function that allows to specify the charset of the input string.
*/
LPWSTR CHARtoWCHAR(LPSTR str, UINT codePage) {
    size_t len = strlen(str) + 1;
    int size_needed = MultiByteToWideChar(codePage, 0, str, len, NULL, 0);
    LPWSTR wstr = (LPWSTR) LocalAlloc(LPTR, sizeof(WCHAR) * size_needed);
    MultiByteToWideChar(codePage, 0, str, len, wstr, size_needed);
    return wstr;
}

/* Execute a DOS command.

 If the function succeeds, the return value is a non-NULL pointer to the output of the invoked command. 
 Command will produce a 8-bit characters stream using OEM code-page.

 As charset depends on OS config (ex: CP437 [OEM-US/latin-US], CP850 [OEM 850/latin-1]),
 before being returned, output is converted to a wide-char string with function OEMtoUNICODE.

 Resulting buffer is allocated with LocalAlloc.
 It is the caller's responsibility to free the memory used by the argument list when it is no longer needed. 
 To free the memory, use a single call to LocalFree function.
*/
LPWSTR DosExec(LPWSTR command){
    // Allocate 1Mo to store the output (final buffer will be sized to actual output)
    // If output exceeds that size, it will be truncated
    const SIZE_T RESULT_SIZE = sizeof(char)*1024*1024;
    char* output = (char*) LocalAlloc(LPTR, RESULT_SIZE);

    HANDLE readPipe, writePipe;
    SECURITY_ATTRIBUTES security;
    STARTUPINFOA        start;
    PROCESS_INFORMATION processInfo;

    security.nLength = sizeof(SECURITY_ATTRIBUTES);
    security.bInheritHandle = true;
    security.lpSecurityDescriptor = NULL;

    if ( CreatePipe(
                    &readPipe,  // address of variable for read handle
                    &writePipe, // address of variable for write handle
                    &security,  // pointer to security attributes
                    0           // number of bytes reserved for pipe
                    ) ){

        GetStartupInfoA(&start);
        start.hStdOutput  = writePipe;
        start.hStdError   = writePipe;
        start.hStdInput   = readPipe;
        start.dwFlags     = STARTF_USESTDHANDLES + STARTF_USESHOWWINDOW;
        start.wShowWindow = SW_HIDE;

// We have to start the DOS app the same way cmd.exe does (using the current Win32 ANSI code-page).
// So, we use the "ANSI" version of createProcess, to be able to pass a LPSTR (single/multi-byte character string) 
// instead of a LPWSTR (wide-character string) and we use the UNICODEtoANSI function to convert the given command 
        if (CreateProcessA(NULL,                    // pointer to name of executable module
                           UNICODEtoANSI(command),  // pointer to command line string
                           &security,               // pointer to process security attributes
                           &security,               // pointer to thread security attributes
                           TRUE,                    // handle inheritance flag
                           NORMAL_PRIORITY_CLASS,   // creation flags
                           NULL,                    // pointer to new environment block
                           NULL,                    // pointer to current directory name
                           &start,                  // pointer to STARTUPINFO
                           &processInfo             // pointer to PROCESS_INFORMATION
                         )){

            // wait for the child process to start
            for(UINT state = WAIT_TIMEOUT; state == WAIT_TIMEOUT; state = WaitForSingleObject(processInfo.hProcess, 100) );

            DWORD bytesRead = 0, count = 0;
            const int BUFF_SIZE = 1024;
            char* buffer = (char*) malloc(sizeof(char)*BUFF_SIZE+1);
            strcpy(output, "");
            do {                
                DWORD dwAvail = 0;
                if (!PeekNamedPipe(readPipe, NULL, 0, NULL, &dwAvail, NULL)) {
                    // error, the child process might have ended
                    break;
                }
                if (!dwAvail) {
                    // no data available in the pipe
                    break;
                }
                ReadFile(readPipe, buffer, BUFF_SIZE, &bytesRead, NULL);
                buffer[bytesRead] = '\0';
                if((count+bytesRead) > RESULT_SIZE) break;
                strcat(output, buffer);
                count += bytesRead;
            } while (bytesRead >= BUFF_SIZE);
            free(buffer);
        }

    }

    CloseHandle(processInfo.hThread);
    CloseHandle(processInfo.hProcess);
    CloseHandle(writePipe);
    CloseHandle(readPipe);

    // convert result buffer to a wide-character string
    LPWSTR result = OEMtoUNICODE(output);
    LocalFree(output);
    return result;
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-19T15:59:20.527

您应该使用带有参数的[CreateProcess](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682425%28v=vs.85%29.aspx) on来隧道化 ipconfig 命令。> 在命令行上本身不起作用。您必须以[编程方式重定向 stdout](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682499%28v=vs.85%29.aspx)。`cmd.exe``/C`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-10-30T00:28:05.853

我在 github 上有一个类似的程序 [windows7 和 10 测试]

[https://github.com/vlsireddy/remwin/tree/master/remwin](https://github.com/vlsireddy/remwin/tree/master/remwin)

这是服务器程序

1.  在 Windows 中的“本地连接”命名接口上侦听 UDP 端口（5555）并接收 udp 数据包。
2.  收到的 udp 包内容在 cmd.exe 上执行【请不要在运行命令后关闭 cmd.exe 并且输出字符串【执行命令的输出】通过同一个 udp 端口​​反馈给客户端程序]。
3.  换句话说，在 udp 数据包中接收到的命令 -> 解析的 udp 数据包 -> 在 cmd.exe 上执行 -> 在同一端口上发送回客户端程序的输出

这不显示“控制台窗口”不需要有人在 cmd.exe 上手动执行命令 remwin.exe 可以在后台运行，它是一个瘦服务器程序

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-09-03T12:30:39.763

为了添加到@Cédric Françoys 的答案，我在他的 Windows 构建代码中修复了一些内容：

**缺少函数定义：**

要编译代码，请添加以下函数定义：

```
#define UNICODEtoANSI(str)   WCHARtoCHAR(str, CP_OEMCP)

LPSTR WCHARtoCHAR(LPWSTR wstr, UINT codePage) {
    int len = (int)wcslen(wstr) + 1;    
    int size_needed = WideCharToMultiByte(codePage, 0, wstr, len, NULL, 0, NULL, NULL);
    LPSTR str = (LPSTR)LocalAlloc(LPTR, sizeof(CHAR) * size_needed);
    WideCharToMultiByte(codePage, 0, wstr, len, str, size_needed, NULL, NULL);
    return str;
} 
```

**不安全的 CRT 字符串函数调用：**

要编译代码，请替换`strcpy`并`strcat`使用以下调用

```
strcpy_s(output, sizeof(output), "");

strcat_s(output, RESULT_SIZE, buffer); 
```

**删除多余的空终止：**

在 do-while 循环中删除：

```
buffer[bytesRead] = '\0'; 
```

因为`strcat_s`照顾它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-12-18T17:14:26.873

你可以使用

```
 string command = "start /B cmd /c " + myCommand;
 system(command.c_str()); 
```

希望这对你有用

# java - 如何将 SynthLookAndFeel 与 xml 文件一起使用，其中 xml 文件路径将使用 getResourceAsStream 方法加载文件？

> ID：11564597
> 
> 赞同：2
> 
> 时间：2012-07-19T15:51:31.197
> 
> 标签：java, swing, jslider, synth

我在用

```
SynthLookAndFeel laf = new SynthLookAndFeel();
laf.load(MyJSlider.class.getResourceAsStream("/ui/demo.xml"), MyJSlider.class);      
//laf.load(new URL("file:///var/tmp/demo.xml")); 
```

我的 demo.xml 有以下内容：

```
<style id="SliderTrackStyle">
    <opaque value="TRUE"/>
    <state>
      <imagePainter method="SliderTrackBackground" path="/var/tmp/JavaUnitTest/src/image/menu/bg.jpg" sourceInsets="0 0 0 0" />
    </state>
</style>
<bind style="SliderTrackStyle" type="region" key="SliderTrack" /> 
```

导致错误：

```
run-single:
Uncaught error fetching image:
java.lang.NullPointerException
    at sun.awt.image.URLImageSource.getConnection(URLImageSource.java:115)
    at sun.awt.image.URLImageSource.getDecoder(URLImageSource.java:125)
    at sun.awt.image.InputStreamImageSource.doFetch(InputStreamImageSource.java:263)
    at sun.awt.image.ImageFetcher.fetchloop(ImageFetcher.java:205)
    at sun.awt.image.ImageFetcher.run(ImageFetcher.java:169)
BUILD STOPPED (total time: 9 seconds) 
```

避免和减少风险。

我怎样才能像`path=Menu.class.getResourceAsStream("/image/menu/bg.jpg")` 我想避免使用示例中显示的静态路径一样使用它。

**跟进：**

![在此处输入图像描述](../Images/cff274d0c47c9ceafb6836e65cd97e7f.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T16:09:20.520

[您可以在Advanced Synth](http://www.ibm.com/developerworks/java/library/j-synth/)中找到一个很好的示例。

您可以在示例中看到：

```
SynthLookAndFeel synth = new SynthLookAndFeel();
synth.load(SynthFrame.class.getResourceAsStream("demo.xml"), SynthFrame.class);
UIManager.setLookAndFeel(synth); 
```

并且`demo.xml`生活在 `demo.synth`包中，与`SynthFrame`类相同，该 XML 包含：

```
<imageIcon id="check_off" path="images/checkbox_off.png"/> 
```

住在哪`checkbox_off.png`里`demo.synth.images`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T16:12:53.210

1.  请[检查](https://stackoverflow.com/questions/6992633/painting-the-slider-icon-of-jslider)，特别是通过显示基本内容来回答，`@trashgod`但对 BasicXxxUI 有很好的代码解决方法

2.  我宁愿使用`Nimbus Look and Feel`史前的和朴素`Synth`的，

3.  `Nimbus`与 GUI、aaaa 和一些错误有类似的问题，

4.  `Nimbus`（基于plain `Synt`）可能是最简单的方法，我们周围有一些很棒的黑客

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-29T18:34:30.663

您还可以通过传递文件的整个路径来添加 XML 文件

例如

```
SynthLookAndFeel laf = new SynthLookAndFeel();
laf.load(new URL("file:///D:/Demo/src/example1.xml"));
UIManager.setLookAndFeel(laf); 
```

这个对我有用。试试你的应用程序

# c++ - gluPickMatrix - 出了点问题，一个物体总是在现场

> ID：11564601
> 
> 赞同：1
> 
> 时间：2012-07-19T15:51:42.733
> 
> 标签：c++, qt, opengl, graphics, 3d

我有以下代码来绘制一个openGL场景

```
void QGLDiagramWidget::paintGL()
{

    glClearColor(0.2f, 0.0f, 0.5f, 0.0f);
    glEnable(GL_DEPTH_TEST);
    glDepthFunc(GL_LESS);
    glEnable(GL_MULTISAMPLE);

    ... load shaders...

    ... load buffers...

    ... load textures...

    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    // Set viewport area
    glViewport(0, 0, this->size().width(), this->size().height());

    GLint view[4];
    glGetIntegerv(GL_VIEWPORT, view);
    glLoadIdentity();

    gluPickMatrix(1, 1, 1, 1, view); // THIS IS THE RELEVANT CODE

    // I don't use a fixed pipeline, so let's store this pickmatrix in a variable
    Matrix pickingPerspMatrix;
    glGetFloatv(GL_PROJECTION_MATRIX, pickingPerspMatrix); // This is successful in my code

    // Create the projection matrix
    gl_projection.setToIdentity();
    gl_projection *= pickingPerspMatrix; // APPLY THE PICKING MATRIX
    gl_projection.perspective(45.,((GLfloat)this->size().width())/((GLfloat)this->size().height()),0.1f,100.0f);

    ... now draw the entire scene with shaders, there's a camera matrix (view) and a model matrix (model) ...
} 
```

据我所知，这应该从宽度为 1 和高度为 1 的左下像素 1,1（场景的第一个）的矩形中获取一个选取矩阵，并将其乘以单位矩阵，然后应用透视矩阵它。

目标是：将我的像素区域集中在视口上并渲染那里真正可见的任何内容。

事实证明，无论我在 gluPickMatrix 中输入什么值，我的视口中的对象总是可见的，只是缩小、扭曲或变形，但总是在视口区域内。这是错误的，因为从点 (0;0) 加上宽度 1 和高度 1 请求选取矩阵应该返回一个空白区域。

这是我为帮助您理解问题而获得的图像

![在此处输入图像描述](../Images/6bb687469d545d14504e6fe211741735.png)

为什么会这样？选择矩阵应该做什么？将物体移出场景？由于我在着色器中使用了可编程管道（它们基本上是简单的着色器，用于在对象上加载纹理并使用 phong 照明），什么会导致对象变形及其在场景中的持续存在？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:34:23.733

pickmatrix 用于将渲染限制在视口的一小部分。在此处阅读 gluPickMatrix：[http ://www.opengl.org/sdk/docs/man/xhtml/gluPickMatrix.xml](http://www.opengl.org/sdk/docs/man/xhtml/gluPickMatrix.xml)

拾取不适用于您的可编程管道。拾取通过将每个绘制调用与“名称”（代表可拾取对象的数字）相关联来工作，并且在使用拾取渲染场景时，它返回任何像素/片段。

此处解释了详细信息： [http](http://content.gpwiki.org/index.php/OpenGL:Tutorials:Picking) ://content.gpwiki.org/index.php/OpenGL:Tutorials: Picking 和此处 web.engr.oregonstate.edu/.../Picking/picking.pdf

您最好避免使用过时的功能并使用颜色选择，用唯一的纯色渲染每个对象，然后使用 glReadPixels 找出鼠标下的内容。

在这里很好地解释了颜色选择：[http ://content.gpwiki.org/index.php/OpenGL_Selection_Using_Unique_Color_IDs](http://content.gpwiki.org/index.php/OpenGL_Selection_Using_Unique_Color_IDs)

另一种可能性是使用射线原始测试进行选择。

# php - PHP多上传图片问题

> ID：11564603
> 
> 赞同：0
> 
> 时间：2012-07-19T15:51:45.250
> 
> 标签：php, file-upload

我正在尝试编写一个可以上传多个图像的脚本。这是我正在使用的代码。

```
if(isset($_POST['submit_images'])) {
    $i = 0;
    foreach($_FILES['file'] as $file) {
        $image = new Image();
        $image->member_id = $_POST['id'][$i];
        $image->image_type = "MedlemsBillede";
        $image->attach_file($_FILES['file']);
        if($image->save()) {
            $message = 'Billedet blev uploadet med succes.';
        } else {
            $message  = join("<br />", $image->errors);
        }
        $i++;
    }
} 
```

我的问题在于这个函数调用：

```
$image->attach_file($_FILES['file']); 
```

该函数如下所示：

```
public function attach_file($file) {
    if(!$file || empty($file) || !is_array($file)) {
        $this->errors[] = "Der blev ikke uploadet nogen fil.";
        return false;
    } elseif($file['error'] != 0) {
        $this->errors[] = $this->upload_errors[$file['error']];
        return false;
    } else {
        $this->temp_path    = $file['tmp_name'];
        $this->file_name    = str_replace(' ', '_', basename($file['name']));
        $this->file_type    = $file['type'];
        $this->file_size    = $file['size'];
        $this->ts   = date('Y-m-d H:i:s');
        return true;
    }
} 
```

有人知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T16:04:27.667

我认为问题出在这一行：

```
$image->attach_file($_FILES['file']); 
```

您正在迭代 $_FILES['file'] 而不仅仅是 $_FILES

此外，您正在调用您在循环内迭代的数组

调用应该是这样的

```
$image->attach_file($file); 
```

愿这对你有帮助

# pthreads - 为什么 valgrind drd 认为 pthread_barrier_wait 有问题？

> ID：11564606
> 
> 赞同：1
> 
> 时间：2012-07-19T15:51:52.597
> 
> 标签：pthreads, valgrind

当我运行以下超级简单程序时，我在 valgrind drd 中检测到错误。是谁的错？线程？瓦尔格林？我？

```
#include <pthread.h>
#include <stdio.h>
#include <stdlib.h>

pthread_barrier_t barrier1;    

void * wait_for_barrier(void *args)
{
    pthread_barrier_wait(&barrier1);
    return 0;
}

int main (int argc, char *argv[])
{
    pthread_t t;
    pthread_barrier_init(&barrier1, NULL, 2);
    pthread_create(&t, NULL, wait_for_barrier, 0);
    wait_for_barrier(NULL);
    pthread_join(t, NULL);
    return 0;
} 
```

当我编译和配置文件时：

```
gcc testbar.c -O3 -g -lpthread && valgrind --tool=drd  ./a.out 
```

我懂了

```
...
==28089== 线程 1 在 0x00601088 大小 4 的负载冲突
==28089== 在 0x4E44E9E: pthread_barrier_wait (pthread_barrier_wait.S:40)
==28089== by 0x40079B: main (testbar.c:24)
...

```

我在 Ubuntu 11.10 x86_64 上。使用 valgrind-3.6.1-Debian 和 gcc 4.6.1-9ubuntu3

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T05:08:41.680

它运作良好。我在 Linux Mint 13 上使用 valgrind-3.7.0 和 gcc (Ubuntu/Linaro 4.6.3-1ubuntu5) 4.6.3。

# caching - CUDA - 多处理器、Warp 大小和每个块的最大线程数：确切的关系是什么？

> ID：11564608
> 
> 赞同：24
> 
> 时间：2012-07-19T15:52:04.060
> 
> 标签：caching, memory, cuda, textures

我知道 CUDA GPU 上有多处理器，其中包含 CUDA 内核。在我的工作场所，我正在使用 GTX 590，它包含 512 个 CUDA 内核、16 个多处理器，并且 warp 大小为 32。所以这意味着每个多处理器中有 32 个 CUDA 内核，它们在同一个 warp 中的相同代码上运行. 最后，每个块大小的最大线程数是 1024。

我的问题是块大小和多处理器计数 - 扭曲大小是如何完全相关的。说一下我对这种情况的理解：例如我在 GTX 590 上分配了 N 个最大 threadPerBlock 大小为 1024 的块。据我从 CUDA 编程指南和其他来源了解，这些块首先由硬件枚举. 在这种情况下，N 个块中的 16 个被分配给不同的多处理器。每个块包含 1024 个线程，硬件调度程序将其中的 32 个线程分配给单个多处理器中的 32 个内核。同一多处理器（warp）中的线程处理同一行代码并使用当前多处理器的共享内存。如果当前32个线程遇到内存读写等片外操作，它们被当前块中的另一组 32 个线程替换。所以，实际上在一个块中有 32 个线程，它们是*在任何给定时间在多处理器上完全*并行运行，而不是整个 1024。最后，如果一个块完全由多处理器处理，则将 N 个线程块列表中的一个新线程块插入当前多处理器。最后，在 CUDA 内核执行期间，GPU 中总共有 512 个线程并行运行。（我知道如果一个块使用的寄存器比单个多处理器上可用的寄存器多，那么它会被划分为在两个多处理器上工作，但在我们的例子中假设每个块都可以放入单个多处理器。）

那么，我的 CUDA 并行执行模型是否正确？如果没有，有什么问题或遗漏？我想微调我正在做的当前项目，所以我需要整个事情中最正确的工作模型。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-19T16:52:39.007

> 在我的工作场所，我正在使用 GTX 590，它包含 512 个 CUDA 内核、16 个多处理器，并且 warp 大小为 32。所以这意味着每个多处理器中有 32 个 CUDA 内核，它们在同一个 warp 中的相同代码上运行. 最后，每个块大小的最大线程数是 1024。

GTX590 包含您提到的数字的 2 倍，因为卡上有 2 个 GPU。下面，我重点介绍单芯片。

> 说一下我对这种情况的理解：例如我在 GTX 590 上分配了 N 个最大 threadPerBlock 大小为 1024 的块。据我从 CUDA 编程指南和其他来源了解，这些块首先由硬件枚举. 在这种情况下，N 个块中的 16 个被分配给不同的多处理器。

块不一定均匀分布在多处理器 (SM) 上。如果您恰好安排了 16 个块，则一些 SM 可以获得 2 或 3 个块，而其中一些则空闲。我不知道为什么。

> 每个块包含 1024 个线程，硬件调度程序将其中的 32 个线程分配给单个多处理器中的 32 个内核。

线程和内核之间的关系并不是那么直接。每个 SM 中有 32 个“基本”ALU。处理单精度浮点和大多数 32 位整数和逻辑指令的指令。但是只有16个加载/存储单元，所以如果当前正在处理的warp指令是加载/存储，则必须调度两次。而且只有 4 个特殊功能单元，可以做三角函数之类的事情。所以这些指令必须安排 32 / 4 = 8 次。

> 同一多处理器（warp）中的线程处理同一行代码并使用当前多处理器的共享内存。

不，一个 SM 中可以同时“运行”超过 32 个线程。

> 如果当前的 32 个线程遇到像内存读写这样的片外操作，它们将被当前块中的另一组 32 个线程替换。因此，在一个单独的块中实际上有 32 个线程在任何给定时间在多处理器上完全并行运行，而不是全部 1024。

不，不仅仅是内存操作会导致扭曲被替换。ALU 也是深度流水线的，因此当仍在流水线中的值发生数据依赖关系时，新的扭曲将被交换。因此，如果代码包含两条指令，其中第二条使用第一条的输出，那么当第一条指令的值通过管道时，扭曲将被搁置。

> 最后，如果一个块完全由多处理器处理，则将 N 个线程块列表中的一个新线程块插入当前的多处理器。

一个多处理器一次可以处理多个块，但一个块一旦开始处理就不能移动到另一个 MP。块中当前正在运行的线程数取决于该块使用了多少资源。CUDA 占用计算器将根据您的特定内核的资源使用情况告诉您同时有多少块正在运行。

> 最后，在 CUDA 内核执行期间，GPU 中总共有 512 个线程并行运行。（我知道如果一个块使用的寄存器比单个多处理器上可用的寄存器多，那么它会被划分为在两个多处理器上工作，但在我们的例子中假设每个块都可以放入单个多处理器。）

不，一个块不能被划分为在两个多处理器上工作。整个块总是由单个多处理器处理。如果给定的多处理器没有足够的资源来处理您的内核至少一个块，您将收到内核启动错误并且您的程序将根本无法运行。

这取决于您如何将线程定义为“正在运行”。GPU 通常会有超过 512 个线程同时消耗芯片上的各种资源。

请参阅@harrism 在此问题中的回答：[CUDA：总共有多少并发线程？](https://stackoverflow.com/q/6490572/442006)

# javascript - 使用 knockoutjs 绑定和显示字典

> ID：11564610
> 
> 赞同：2
> 
> 时间：2012-07-19T15:52:06.273
> 
> 标签：javascript, knockout.js

我使用淘汰赛，我的视图模型中有一个 observablearray (mappedCompaignByInterest)，其中包含对象数组，每个对象都像字典，它包含字符串键和对象数组 (Compaign) 的值。请问如何将此对象与knockoutjs上的表绑定。

这是我的视图模型：

```
 function DashboardViewModel() {
    var self = this;        
    self.BuzzCompaignByInterest = ko.observableArray([]); 
```

}

这是用于从服务器加载数据

```
 //    Load initial state from server,
    $.getJSON("/Dashboard", function (Data) {            
        var mappedCompaignByInterest = Data.BuzzCompaignByInterest;            
        self.BuzzCompaignByInterest(mappedCompaignByInterest);                        
       }); 
```

请注意，Data.BuzzCompaignByInterest 希望我从服务器获取它是字典，键是字符串，值是对象数组（Compaign），这是 Compaign 类的属性：

```
 public class BuzzCompaignModel
{
    public long BuzzCompaignId { get; set; }
    public string Name { get; set; }
    public string Description { get; set; }
 } 
```

请问如何显示来自 BuzzComapignByInterest 的数据（viewmodel 中的 observablearray）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T08:19:07.843

我假设您的字典项目看起来像这个类：

```
function DictionaryItem(key, value) {
                this.key = key;
                this.value = value;
            } 
```

值是您的 BuzzCompaignModel，如下所示：

```
function BuzzCompaignModel(id, name, description) {
            this.id = id;
            this.name = name;
            this.description = description;
        } 
```

在使用初始化的 BuzzCompaignModel 分配 DictionaryItem 集合后，您可以使用以下方式绑定此数组：

```
 <table>
        <tbody data-bind="foreach:BuzzCompaignByInterest">

            <tr>
                <td data-bind='text:key'></td>
                <td data-bind='text:value.id'></td>
                <td data-bind='text:value.name'></td>
                <td data-bind='text:value.description'></td>
            </tr>
        </tbody>
    </table> 
```

还有[jsfiddle](http://jsfiddle.net/jaQ8y/)的例子

# python - 扭曲的链接回调在一起不传递数据

> ID：11564620
> 
> 赞同：1
> 
> 时间：2012-07-19T15:52:30.863
> 
> 标签：python, callback, twisted

我将几个 deferred 链接在一起，因为在开始下一个函数之前我需要一个函数的结果。但是，代码在第一次成功回调后中断。

```
class SaveContents(Protocol):
    def __init__(self, finished, filesize, filename):
        self.finished = finished
        self.remaining = filesize
        self.outfile = open(filename, 'wb')

    def dataReceived(self, bytes):
        if self.remaining:
            display = bytes[:self.remaining]
            self.outfile.write(display)
            self.remaining -= len(display)
        else:
            self.outfile.close()

    def connectionLost(self, reason):
        print 'Finished receiving body:', reason.getErrorMessage()
        self.outfile.close()
        self.finished.callback(None)

def cbRequest(response):
    print 'Response version:', response.version
    print 'Response code:', response.code
    print 'Response phrase:', response.phrase
    print 'Response headers:'
    print 'Response length:', response.length
    print pformat(list(response.headers.getAllRawHeaders()))
    finished = Deferred()
    response.deliverBody(SaveContents(finished, response.length, 'test2.pdf'))
    return finished

def cbShutdown(ignored):
    reactor.stop()

def addBarcodeChain(result, infile, outfile, analyze, duplex):
    print "starting Chain with results {0}".format(result)
    d = addBarcode(infile, outfile, lastStatement=result.headers.getHeader('lastStatement'), analyze=analyze, duplex=duplex)
    return d

def addBarcode(infile, outfile, **kwargs):
    """Send the pdf file to the remote server for processing, then save the results."""
    agent = Agent(reactor)
    f = open('70935.pdf', 'rb')
    body = FileBodyProducer(f)
    fstr = 'filename={0}'.format(infile)
    stmnt = 'lastStatement={0}'.format(kwargs['lastStatement'])
    duplex = 'duplex={0}'.format(int(kwargs['duplex']))
    analyze = 'analyze={0}'.format(int(kwargs['analyze']))
    options = '&'.join([fstr, stmnt, duplex, analyze])
    d = agent.request(
        'POST',
        'http://127.0.0.1:7777?{0}'.format(options),
        Headers({'User-Agent': ['Twisted Web Client Example'],
                 'Content-Type': ['multipart/form-data; boundary=1024'.format()]}),
        body)
    return d

#===============================================
# Main methods
#===============================================
def main(infiles, output_path, output_filename, analyze, duplex, debug):
    logger.info("Start of processing {0}".format(infiles))
    if debug:
        logger.setLevel(logging.DEBUG)

    lastStatement = 0
    work = []
    for globFile in infiles:
        for f in glob(globFile):
            outname = '{0}/{1}{2}.pdf'.format(output_path, os.path.splitext(os.path.basename(f))[0], output_filename)
            work.append( (f, outname) )

    d = addBarcode(work[0][0], work[0][1], lastStatement=lastStatement, analyze=analyze, duplex=duplex)
    d.addCallback(cbRequest)
    d.addErrback(cbShutdown)
    for f, outname in work[1:]:
        d.addCallback(addBarcodeChain, f, outname, analyze=analyze, duplex=duplex)
        d.addCallback(cbRequest)
        d.addErrback(cbShutdown)

    d.addCallback(cbShutdown)
    d.addErrback(cbShutdown)

    reactor.run() 
```

据我所知，延迟递归循环`cbRequest`是它正常运行所必需的，但它不会将任何结果传递给未来的回调，这就是`addBarcodeChain`它尝试使用结果内容时失败的原因。

我将如何调整`cbRequest`或`SaveContents`将响应对象转发给未来的回调？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T20:15:36.143

我想到了。正如我所怀疑的，相关位是保存内容类。

```
class SaveContents(Protocol):
    def __init__(self, finished, filesize, filename):
        self.finished = finished
        self.remaining = filesize
        self.outfile = open(filename, 'wb')

    def dataReceived(self, bytes):
        if self.remaining:
            display = bytes[:self.remaining]
            self.outfile.write(display)
            self.remaining -= len(display)
        else:
            self.outfile.close()

    def connectionLost(self, reason):
        print 'Finished receiving body:', reason.getErrorMessage()
        self.outfile.close()
        self.finished.callback(None) 
```

值得注意的是，当连接关闭时，将调用 connectionLost 方法。发生这种情况时，它应该通过设置来“清理”递归回调循环`self.finished.callback(None)`。

通过将其更改为`self.finished.callback(self.response)`并将`init`响应传递给方法，响应将传递给未来的回调。

```
class SaveContents(Protocol):
    def __init__(self, finished, response, filesize, filename):
        self.finished = finished
        self.remaining = filesize
        self.response = response
        self.outfile = open(filename, 'wb')

    def dataReceived(self, bytes):
        if self.remaining:
            display = bytes[:self.remaining]
            self.outfile.write(display)
            self.remaining -= len(display)
        else:
            self.outfile.close()

    def connectionLost(self, reason):
        print 'Finished receiving body:', reason.getErrorMessage()
        self.outfile.close()
        self.finished.callback(self.response) 
```

这解决了后面的回调`None`从他们的前辈那里得到的问题。

# php - 为什么这个预匹配模式在数字输入上返回 true？

> ID：11564621
> 
> 赞同：0
> 
> 时间：2012-07-19T15:52:31.927
> 
> 标签：php, preg-match

我知道这对某些人来说是非常基础的，但这让我很头疼。为什么这个模式

```
/[!@#$%^&*()+|.*-<>\'`]/ 
```

在数字输入上返回 true，即 abcd123。[在此测试仪](http://www.switchplane.com/awesome/preg-match-regular-expression-tester/)上对其进行了测试

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T15:55:41.800

您需要转义破折号，否则将其解释为字符范围`\x2A-\x3E`：

```
/[!@#$%^&*()+|.*\-<>\'`]/ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T15:56:48.783

这是因为`-`您的正则表达式中的符号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T15:58:38.857

你必须反斜杠“-”，像这样：

```
/[!@#$%^&()+|.\-<>\'`]/ 
```

我认为你也应该反斜杠所有特殊字符。

# .net - 是否可以在 .Net Windows 表单中托管 Microsoft Access 表单？

> ID：11564626
> 
> 赞同：10
> 
> 时间：2012-07-19T15:53:04.183
> 
> 标签：.net, winforms, ms-access, interop

我在问是否可以在 .Net 表单中托管 Microsoft Access 表单。

不，我没有发疯，我们正在维护一个完全用 VBA 编写的庞大系统，该系统由不了解很多 VBA 的人试图将 Microsoft Access 用作 IDE。它基本上是数千行意大利面条代码，虽然我们很想废弃它并从头开始，但这不是一个选择。

因此，我们正在尝试改进现有的内容，在这种特殊情况下，如果我们能够以某种方式将 Microsoft Access 表单托管在 .Net Windows 表单中，那将非常有帮助，因为我们可以更有效地与 .Net 中的专有硬件进行交互我们可以从VB6。

我们目前有一个 .Net 应用程序在计算机上与用户随时打开的许多 MS-Access 数据库一起运行，并且 .Net 应用程序使用 MS Access Interop 与这些数据库进行交互，取得了不同程度的成功。这是因为它使用表单标题和文件名/位置来获取数据库的句柄来完成它需要做的事情，并且还依赖于用户不干扰/关闭应用程序/将数据库移动到他们的桌面等。这是一个有点乱。

因此，我问是否有可能以某种方式在 .Net Windows 表单中托管 Microsoft Access 表单，方法是将表单本身添加为控件或子表单，以使我可以直接访问所有控件在.Net 的表格上？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-20T22:24:11.273

简短的回答是“是”，长的回答是“......但它可能不值得麻烦。”

您可以通过 SharePoint 发布 Access 数据库，包括表单和报表。我实际上并没有这样做，但我研究了一个项目的选项，我们朝着另一个方向前进。

此处的详细信息：http: [//office.microsoft.com/en-us/sharepoint-online-enterprise-help/build-and-publish-an-access-database-to-sharepoint-HA102435342.aspx](http://office.microsoft.com/en-us/access-help/introduction-to-integrating-data-between-access-and-a-sharepoint-site-HA010131463.aspx)

和 [http://office.microsoft.com/en-us/access-help/introduction-to-integrating-data-between-access-and-a-sharepoint-site-HA010131463.aspx](http://office.microsoft.com/en-us/access-help/introduction-to-integrating-data-between-access-and-a-sharepoint-site-HA010131463.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-21T01:38:12.417

顺便说一句，在我们开始之前，如果...

*   您在问如何在没有应用程序 chrome 的情况下仅托管一个 Access 表单；和
*   您正在使用 Access 的运行时版本

...您违反了 Access Runtime EULA：

> **2\. 额外的许可要求和/或使用权利。**
> 
> ...
> 
> **ii. 分发要求。**对于您分发的任何可分发代码，您必须...
> 
> *   保持在您的用户界面中显示的包含“Powered by Microsoft Office Access”声明的状态栏供用户随时查看；

阅读 EULA（不是那么长）可能是为了了解您可以和不能使用 Access Runtime 的目的。

> 因此，我问是否有可能以某种方式在 .Net Windows 表单中托管 Microsoft Access 表单，方法是将表单本身添加为控件或子表单，以使我可以直接访问所有控件在.Net 的表格上？

您可能想要反转场景：[在 Access 中运行您的 .NET 代码](http://msdn.microsoft.com/en-us/library/office/aa902693%28v=office.12%29.aspx#OfficeAccess2007CreateManagedAddIns_CreatingSampleForm)。

这基本上需要在 Visual Studio 中创建一个 Access 可以加载和操作的共享加载项。从那里您可以连接控件和事件。

```
public void HookupControls(
   Access.CommandButtonClass button,
   Access.ListBoxClass listBox,
   Access.TextBoxClass textBox1,
   Access.TextBoxClass textBox2)
{
    fillProductsButton = button;
    fillProductsButton.Click += 
        new Access.DispCommandButtonEvents_ClickEventHandler(
        fillProductsButton_Click);
    fillProductsButton.OnClick = "[Event Procedure]";

    unitPriceTextBox = textBox1;
    quantityTextBox = textBox2;
} 
```

它需要您的 Access 应用程序的一些合作：

```
With COMAddIns("SharedAddIn.Connect")
    ''// Make sure the COM add-in is loaded.
    .Connect = True

    ''// Hook up the desired objects.
    .Object.HookupControls Me.fillProductsButton, Me.productsListBox, _
        Me.unitPriceTextBox, Me.quantityTextBox
End With 
```

免责声明：我想尝试一下，但在 Visual Studio 2012 中，似乎缺少创建共享加载项的能力。YMMV。但是，文档中有[对共享加载项的引用](http://msdn.microsoft.com/en-us/library/ms165620%28v=vs.110%29.aspx)，所以也许我遗漏了一些东西，或者该功能不在 VS 2012 RC 中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-04-12T10:26:07.843

我认为你是从错误的方向来的。可以将 .NET 运行时加载到 MS Access 内存空间中。并将您的自定义 .NET DLL 加载到该运行时空间中。

并且通过正确定义的 C 风格 DLL API 层，您可以将调用传播到 .NET 代码中或从 .NET 代码返回。

我知道这一点，因为我已经做到了。

找出必要的参数等是一种痛苦的痛苦，但一旦完成，只要您不希望传递 Unicode 数据，它就相当顺利。

现在，我正在将 150 多个表单和 150 多个报告迁移到 .NET 中。几年后我可能会废弃 Access 端 :)

无论如何，我遇到了这个问题，因为我现在正试图弄清楚如何让 .NET 表单在 Access 中充当适当的 MDI 子级，所以回到狩猎。

# javascript - Jscript - 坚持隐藏/显示 div

> ID：11564631
> 
> 赞同：1
> 
> 时间：2012-07-19T15:53:20.320
> 
> 标签：javascript, web, onclick, show-hide

我目前正在开发一个网站，在我的 mainContent div 中有 5 个 div。1个div默认可见，其他4个隐藏（注意：默认可见div对应首页内容）。我在 sideMenu 中也有 5 个链接，它们对应于每个隐藏/可见的 div。

我试图实现的目标是使用 Jscript 实现以下目标：

*   当单击 sideMenu 中的一个链接时，我希望相应的 div 可见（如果隐藏），其余的 div 隐藏。

任何人都可以提供任何指示吗？

尝试插图：

->>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

默认主页：

链接1 | 链接2 | 链接3

内容分区：

div1 - 可见

div2 - 隐藏

div3 - 隐藏

->>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

Link2被按下：

链接1 | 链接2 | 链接3

内容分区：

div1 - 隐藏

div2 - 可见

div3 - 隐藏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T16:00:59.060

我会使用 jQuery 并做这样的事情

```
function changePage(page){
    $('#contentDiv').children('div').each(function(){
         if($(this).css('display') != 'none')
         {
              $(this).css('display', 'none'))
         }
});

      switch(page){
         case 1:
             //make home visible
         break;
         case 2:
             //make about visible
         break;
         case 3:
             //make contact visible
         break;

       }
} 
```

这些按钮在侧边栏，点击后进入功能，隐藏当前显示的页面，然后使用开关来决定显示什么新页面

```
<button onclick="changePage(1)">Home</button>
<button onclick="changePage(2)">About</button>
<button onclick="changePage(3)">Contact</button> 
```

Ps 我还没有真正检查过这段代码，但我想你明白了

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T16:02:12.797

给所有内容 div 一个通用的类名，例如“contentPanel”，每个都有一个唯一的 ID，如`#home-panel`,等。除了主 div 之外`#page1-panel`，您应该为所有这些设置样式。`display:none`像这样设置你的链接：

```
<a href="#home-panel" class="panel-link">Home</a>
<a href="#page1-panel" class="panel-link>Page1</a>
<!-- etc.. --> 
```

对于脚本，一个建议是使用[jQuery](http://jquery.com)。它可能看起来像

```
$(".panel-link").click(function() {
    var target = $(this).attr("href");
    $(".contentPanel").hide();
    $(target).show();
}); 
```

如果您希望脚本在浏览器历史更改的同时正确运行，请查看 Ben Alman 的 jQuery 哈希更改插件：[http](http://benalman.com/projects/jquery-hashchange-plugin/) ://benalman.com/projects/jquery-hashchange-plugin/ 。我在我的旧网站上使用了这个：http: [//paislee.net/](http://paislee.net/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T16:08:00.347

假设你的 html 是这样的：

```
<ul>
<li><a  class='link' data-linkno='1' href="#">Link 1</a></li>
<li><a class='link' data-linkno='2' href="#">Link 2</a></li>
<li><a class='link' data-linkno='3' href="#">Link 3</a></li>
</ul>
<div class='content' id='div1">blah</div>
<div class='content' id='div2">blah</div>
<div class='content' id='div3">blah</div> 
```

以下 jQuery 或类似的东西应该可以工作

```
 $(function() {
       $(".link").live("click", function(e) {
       $(".content").hide();
       $("#div"+$(this).data("linkno")).show();
        })
    }) 
```

# html - 覆盖父表边框属性

> ID：11564632
> 
> 赞同：0
> 
> 时间：2012-07-19T15:53:21.350
> 
> 标签：html, css

我的html是这样的：

```
<html class="t1">
<tr>
<td></td>
<td><table class="t2 grid"><tr><td></td></tr></table></td>
<td></td>
</tr>
</html> 
```

在我的 CSS 中，我有：

```
.t1
{
 display: table;
 width: auto; /* 885*/
 border-collapse: collapse;
 border: 1px solid #dddddd;
}
.t1 td
{
 border-collapse: collapse;
 border: 1px solid #dddddd;
}

.t2
{
 display: table;
 width: auto; /* 885*/
 border-collapse: collapse;

}
.t2 td
{
 border-collapse: collapse;

}

.t2 grid
{
            border-top:1px solid #eeeeee !important;
            border-bottom:1px solid #eeeeee !important;
            border-left: none !important;
            border-right: none !important;
}
.t2 grid td
{
            border-top:1px solid #eeeeee !important;
            border-bottom:1px solid #eeeeee !important;
            border-left: none !important;
            border-right: none !important;
} 
```

抱歉，我不能发布我的实际 CSS 或 HTML，但这就是它的想法。

现在由于某种原因，父表网格线显示在内表中每一行的右侧/左侧。

我正在查看 chrome，我可以看到计算的样式，并且父样式仍然有效。

我怎样才能解决这个问题？

问题是，内表现在有一个非常强的外边框，因为样式（我认为）被应用了 2 次。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:57:29.960

问题在于您如何命名您的 CSS 样式。应该`.t2.grid td`不是`.t2 grid td`。

# if-statement - if 的额外注册使用

> ID：11564634
> 
> 赞同：1
> 
> 时间：2012-07-19T15:53:24.910
> 
> 标签：if-statement, cuda, gpu, register-allocation, ptxas

我正在研究一个大型 cuda 内核，我注意到内核每个线程使用 43 个寄存器。为了了解发生了什么，我编写了一个较小的程序来计算寄存器的使用情况。我注意到每当我使用 时`if`，寄存器的使用率都会上升。小代码如下：

```
#include <limits.h>
#include <stdio.h>
#include <fstream>
#include <iostream>
#include <cstdlib>
#include <stdint.h>

using namespace std;

__global__ void test_ifs(unsigned int* result){
  unsigned int k = 0;
  for(int j=0;j<MAX_COMP;j++){
    //if(j <= threadIdx.x%MAX_COMP){                                                                                                                                                                                                          
      k += j;
      //}                                                                                                                                                                                                                                     
  }
  result[threadIdx.x] = k;
}

int main(){
  unsigned int* result;
  cudaError_t e1 = cudaMalloc((void**) &result, THREADSPERBLOCK*sizeof(unsigned int));
  if(e1 == cudaSuccess){
    test_ifs<<<1, THREADSPERBLOCK>>>(result);
    cudaError_t e2 = cudaGetLastError();
    if(e2 == cudaSuccess){
    }
    else{
      cout << "kernel failed to launch" << endl;
    }
  }
  else{
    cout << "Failed to allocate results memory" << endl;
  }
} 
```

当我编译这段代码时，每个线程使用 5 个寄存器

```
ptxas info    : Compiling entry function '_Z8test_ifsPj' for 'sm_20'
ptxas info    : Function properties for _Z8test_ifsPj
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 5 registers, 40 bytes cmem[0] 
```

但是，如果我取消注释`if`，每个线程使用 8 个寄存器。谁能向我解释发生了什么事？

```
ptxas info    : Compiling entry function '_Z8test_ifsPj' for 'sm_20'
ptxas info    : Function properties for _Z8test_ifsPj
    0 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas info    : Used 8 registers, 40 bytes cmem[0] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T05:56:21.370

您在此示例中看到的行为是由于编译器优化造成的。在简单循环的情况下，可以在编译时计算循环的结果并将整个循环代码替换为一个常量，而在包含 if 语句的情况下，循环的结果取决于一个变量，其值不是编译器知道，并且循环必须保留。

为了证明确实如此，让我们看一下内核的一个稍微修改过的版本：

```
#define MAX_COMP (32)

template<unsigned int s>
__global__ void test_ifs(unsigned int * result){
    unsigned int k = 0;
    for(int j=0;j<MAX_COMP;j++){
        switch (s) {
            case 1:
                if (j <= threadIdx.x%MAX_COMP){ k += j; }
                break;            

            case 0:
                { k += j; }
        }
    }
    result[threadIdx.x] = k;
}

template __global__ void test_ifs<0>(unsigned int *);
template __global__ void test_ifs<1>(unsigned int *); 
```

以及它发出的 PTX。对于第一种情况：

```
 .entry _Z8test_ifsILj0EEvPj (
        .param .u32 __cudaparm__Z8test_ifsILj0EEvPj_result)
    {
    .reg .u16 %rh<3>;
    .reg .u32 %r<6>;
    .loc    14  4   0
$LDWbegin__Z8test_ifsILj0EEvPj:
    .loc    14  16  0
    mov.u32     %r1, 496;  <--- here the loop has been replaced with 496
    ld.param.u32    %r2, [__cudaparm__Z8test_ifsILj0EEvPj_result];
    mov.u16     %rh1, %tid.x;
    mul.wide.u16    %r3, %rh1, 4;
    add.u32     %r4, %r2, %r3;
    st.global.u32   [%r4+0], %r1;
    .loc    14  17  0
    exit;
$LDWend__Z8test_ifsILj0EEvPj:
    } // _Z8test_ifsILj0EEvPj 
```

第二种情况循环保持不变：

```
 .entry _Z8test_ifsILj1EEvPj (
        .param .u32 __cudaparm__Z8test_ifsILj1EEvPj_result)
    {
    .reg .u32 %r<11>;
    .reg .pred %p<4>;
    .loc    14  4   0
$LDWbegin__Z8test_ifsILj1EEvPj:
    cvt.u32.u16     %r1, %tid.x;
    and.b32     %r2, %r1, 31;
    mov.s32     %r3, 0;
    mov.u32     %r4, 0;
$Lt_1_3842:
 //<loop> Loop body line 4, nesting depth: 1, iterations: 32
    .loc    14  7   0
    add.u32     %r5, %r3, %r4;
    setp.le.u32     %p1, %r3, %r2;
    selp.u32    %r4, %r5, %r4, %p1;
    add.s32     %r3, %r3, 1;
    mov.u32     %r6, 32;
    setp.ne.s32     %p2, %r3, %r6;
    @%p2 bra    $Lt_1_3842;
    .loc    14  16  0
    ld.param.u32    %r7, [__cudaparm__Z8test_ifsILj1EEvPj_result];
    mul24.lo.u32    %r8, %r1, 4;
    add.u32     %r9, %r7, %r8;
    st.global.u32   [%r9+0], %r4;
    .loc    14  17  0
    exit;
$LDWend__Z8test_ifsILj1EEvPj:
    } // _Z8test_ifsILj1EEvPj 
```

您不应断定差异*始终*是由于编译器优化造成的，因为这在很大程度上取决于代码和编译器。但在这种情况下，这就是区别。

# fullcalendar - FullCalendar - 它会在一个糟糕的页面上工作吗？

> ID：11564637
> 
> 赞同：0
> 
> 时间：2012-07-19T15:53:29.153
> 
> 标签：fullcalendar

几个小时以来，我一直在努力寻找解决方案，所以如果这很容易，我真的很抱歉。但我被困住了。我喜欢 FullCalendar，它正是我一直在寻找的，但我无法让它在我们的环境中工作 weebly。

我从 FullCalendar 上传了所有推荐的 css 和 js 文件。当您通过 weebly 上传**文件**时，它会自动将它们存储在此目录中：/files/theme/yourfile.jpg 我将一个示例 html 文件上传到该目录，它运行良好。你可以在这里看到它：http: [//isuencounter.weebly.com/files/theme/gcal.html](http://isuencounter.weebly.com/files/theme/gcal.html)

当您在 weebly 的结构中创建**页面时，它会将页面存储在您的根目录中。**但是，当我将相同的代码（仅更改为指向正确的目录）放入我的一个主页时，我得到了 nada：http: [//isuencounter.weebly.com/calendar-attempt.html](http://isuencounter.weebly.com/calendar-attempt.html)

起初我以为我指向了错误的地方，但我已经检查了很多次，如果你将源代码拉到第二个文件中，你会发现所有的链接都确实显示了代码他们应该这样做。帮助？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T16:35:30.363

我认为 jQuery 与您正在使用的其他一些脚本冲突。jQuery 使用的`$`同义词可能会被其他东西使用。

`jQuery.noConflict()`在第一个标签的开头使用`<script>`并用 jQuery 替换所有出现的 $。例如：

```
jQuery.noConflict();
  jQuery(document).ready(function() {
    jQuery('#calendar').fullCalendar({
      ...
    });
  }); 
```

我通过下载您的第二个链接进行了尝试，并且日历呈现正常。让我知道这是否有帮助！

# heroku - 在 Heroku 上使用嵌入式 Jetty 实施 HTTPS

> ID：11564638
> 
> 赞同：1
> 
> 时间：2012-07-19T15:53:30.793
> 
> 标签：heroku, https, jetty

我们有一个 Java servlet，使用嵌入式 Jetty 运行，使用“SSL Endpoint”插件部署到 Heroku。我要求应用程序中的所有页面都通过 HTTPS 提供，无论用户是使用 http 还是 https 导航到我们的应用程序。

应用程序识别通过 https 发出的请求，但它也接受 http 请求而不进行重定向（它不应该这样做）。此外，如果用户从 https 连接开始，那么每当发布表单并重定向到“GET”请求时，任何 https 连接都会恢复为 http。

我尝试添加一个 URL 过滤器，将“http://”简单地更改为“https://”，并使用以下代码进行重定向（为简洁起见删除了导入）：

```
public class UrlFilter implements Filter
{
  protected FilterConfig filterConfig;

  @Override
  public void destroy(){}

  @Override
  public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException
  {
    HttpServletRequest httpRequest = (HttpServletRequest) request;
    HttpServletResponse httpResponse = (HttpServletResponse) response;

    String incomingUrl = httpRequest.getRequestURL().toString();
    if ( (!httpRequest.isSecure()) && incomingUrl.contains(".webapps.stjude.org")  )
    {
      String newUrl = incomingUrl.replace("http://", "https://");
      httpResponse.sendRedirect(newUrl);
    }
    chain.doFilter(request, response);
  }

  @Override
  public void init(FilterConfig filterConfig) throws ServletException
  {
    this.filterConfig = filterConfig;
  }
} 
```

然后，我将它添加到我的 web.xml 文件中：

```
<filter>
  <filter-name>urlFilter</filter-name>
  <filter-class>org.stjude.radio.ui.filters.UrlFilter</filter-class>
</filter>
<filter-mapping>
  <filter-name>urlFilter</filter-name>
  <url-pattern>/*</url-pattern>
</filter-mapping> 
```

这种方法的问题是应用程序返回“重定向过多”错误（重定向循环）。

我确信这个问题已经得到解决，但我无法终生找到我需要做些什么来完成这项工作。

顺便说一句，我也尝试将以下内容添加到 web.xml 中，但这只会导致请求失败。

```
<security-constraint>
  <web-resource-collection>
    <web-resource-name>SSL Pages</web-resource-name>
    <url-pattern>/*</url-pattern>
    <http-method>GET</http-method>
    <http-method>PUT</http-method>
    <http-method>POST</http-method>
  </web-resource-collection>
  <user-data-constraint>
    <transport-guarantee>CONFIDENTIAL</transport-guarantee>
  </user-data-constraint>
</security-constraint> 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-20T07:11:25.047

您需要检查`x-forwarded-proto`标头以查看请求是否安全：

```
Boolean secure = false;
if (request.headers.get("x-forwarded-proto") != null) {
  secure = request.headers.get("x-forwarded-proto").values.contains("https");
}
System.out.println("secure = " + secure); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-24T15:24:06.110

我已经检查过 Heroku（也许我在这里错过了一个版本，以及 buildpack 等等），但你肯定没有得到这些信息：

*   一个 X-Forwarded-Proto 指向 http
*   一个 HttpServletRequest#scheme 返回一个 http
*   一个 HttpServletRequest#secure 返回 false ....

# wpf - 在 Caliburn.Micro.dll 中发生 NullReferenceException

> ID：11564639
> 
> 赞同：0
> 
> 时间：2012-07-19T15:53:30.720
> 
> 标签：wpf, caliburn.micro

我有一个 WPF Caliburn.Micro 应用程序。这是我的代码的一部分：

```
 protected override void OnViewLoaded( object view )
  {
     base.OnViewLoaded( view );

     var firstDataEntryVM = new FirstDataEntryViewModel();
     ActivateItem(firstDataEntryVM); 
```

这引起

```
A first chance exception of type 'System.NullReferenceException' occurred in Caliburn.Micro.dll 
```

这是调用堆栈：

![在此处输入图像描述](../Images/1d90bfac5e72125c7eae92c531b42028.png)

我下载了 Caliburn.Micro.WPF 的源代码并将其添加到解决方案中。但现在我根本无法运行该应用程序：

![在此处输入图像描述](../Images/020362b9475e069b11d82e5bd602aaf1.png)

你能告诉我如何调试它吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T15:56:57.153

我想到了几种方法：

*   您是否有发生错误的源代码（我没有查看 Caliburn 是否是开源的）？
*   反编译代码并使用反编译器（例如[Just Decompile](http://www.telerik.com/products/decompiler.aspx) ）将其重新编译到项目中。
*   [Intellitrace](http://msdn.microsoft.com/en-us/library/dd264915.aspx)可以为您提供一些附加信息。

**编辑** 该项目的源代码可在[CodePlex](http://caliburnmicro.codeplex.com/)获得。从 Visual Studio 下载代码并进行调试！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-22T01:11:12.633

看起来你正试图`FirstDataEntryViewModel`过早地激活。尝试在`OnInitialize`或`OnActivate`方法中做到这一点。请注意，每次激活视图模型时都会调用后者。

# c# - 源代码的 RichTextBox

> ID：11564642
> 
> 赞同：1
> 
> 时间：2012-07-19T15:53:35.937
> 
> 标签：c#, winforms, richtextbox

我有一些应用程序可以解析编程语言的源代码。我正在`System.Windows.Forms.RichTextBox`用作代码编辑器。我使用以下算法突出显示语言的关键字：

> *   每当文本更改时，回到最后一个单词的开头，调用这个子字符串单词。
> *   如果关键字包含单词，则将单词的颜色设置为蓝色，
>     否则将单词的颜色设置为黑色

我正在使用`RichTextBox.SelectionStarts`,`RichTextBox.Select(int, int)`和`RichTextBox.SelectionColor`. 那工作得很好。

但是，当我按 Enter 键时，光标会回到该行的最开头。作为源代码编辑器，我希望它遵循最后一行乞求。我将前一行中的填充空白字符放在一个字符串`str`中，然后`richTextBox.Text = richTextBox.Text.Insert(richTextBox.SelectionStarts, str)`. 当我这样做时，所有文本突出显示都已损坏，所有文本均为蓝色。

任何人都可以建议如何在不破坏突出显示的情况下附加行填充空间吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T18:12:49.520

不知道您的代码的确切问题是什么。也许您应该查看已建立的解决方案。例如，[Scintilla.NET](http://scintillanet.codeplex.com/)是众所周知的[Scintilla](http://www.scintilla.org/)控件的 .NET 包装器。它可以使用自定义词法分析器进行扩展，因此它可能适合您的需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-10-21T07:20:40.833

啊，我明白了。这是一个好的开始：

将其放在表单的最顶部：

`using System.Text.RegularExpressions;`

然后将其放入`RichTextBox` `TextChanged`：

```
 // getting keywords/functions
            string keywords = @"\b(abstract|as|base|break|case|catch|checked|continue|default|delegate|do|else|event|explicit|extern|false|finally|fixed|for|foreach|goto|if|implicit|in|interface|internal|is|lock|namespace|new|null|object|operator|out|override|params|private|protected|public|readonly|ref|return|sealed|sizeof|stackalloc|switch|this|throw|true|try|typeof|unchecked|unsafe|using|virtual|volatile|while)\b";
            MatchCollection keywordMatches = Regex.Matches(codeRichTextBox.Text, keywords);

            // getting types/classes from the text 
            string types = @"\b(Console)\b";
            MatchCollection typeMatches = Regex.Matches(codeRichTextBox.Text, types);

            // getting comments (inline or multiline)
            string comments = @"(\/\/.+?$|\/\*.+?\*\/)";
            MatchCollection commentMatches = Regex.Matches(codeRichTextBox.Text, comments, RegexOptions.Multiline);

            // getting strings
            string strings = "\".+?\"";
            MatchCollection stringMatches = Regex.Matches(codeRichTextBox.Text, strings);

            string stringz = "bool|byte|char|class|const|decimal|double|enum|float|int|long|sbyte|short|static|string|struct|uint|ulong|ushort|void";
            MatchCollection stringzMatchez = Regex.Matches(codeRichTextBox.Text, stringz);

            // saving the original caret position + forecolor
            int originalIndex = codeRichTextBox.SelectionStart;
            int originalLength = codeRichTextBox.SelectionLength;
            Color originalColor = Color.Black;

            // MANDATORY - focuses a label before highlighting (avoids blinking)
            label1.Focus();

            // removes any previous highlighting (so modified words won't remain highlighted)
            codeRichTextBox.SelectionStart = 0;
            codeRichTextBox.SelectionLength = codeRichTextBox.Text.Length;
            codeRichTextBox.SelectionColor = originalColor;

            // scanning...
            foreach (Match m in keywordMatches)
            {
                codeRichTextBox.SelectionStart = m.Index;
                codeRichTextBox.SelectionLength = m.Length;
                codeRichTextBox.SelectionColor = Color.Blue;
            }

            foreach (Match m in typeMatches)
            {
                codeRichTextBox.SelectionStart = m.Index;
                codeRichTextBox.SelectionLength = m.Length;
                codeRichTextBox.SelectionColor = Color.DarkCyan;
            }

            foreach (Match m in commentMatches)
            {
                codeRichTextBox.SelectionStart = m.Index;
                codeRichTextBox.SelectionLength = m.Length;
                codeRichTextBox.SelectionColor = Color.Green;
            }

            foreach (Match m in stringMatches)
            {
                codeRichTextBox.SelectionStart = m.Index;
                codeRichTextBox.SelectionLength = m.Length;
                codeRichTextBox.SelectionColor = Color.Brown;
            }

            foreach (Match m in stringzMatchez)
            {
                codeRichTextBox.SelectionStart = m.Index;
                codeRichTextBox.SelectionLength = m.Length;
                codeRichTextBox.SelectionColor = Color.Purple;
            }

            // restoring the original colors, for further writing
            codeRichTextBox.SelectionStart = originalIndex;
            codeRichTextBox.SelectionLength = originalLength;
            codeRichTextBox.SelectionColor = originalColor;

            // giving back the focus
            codeRichTextBox.Focus(); 
```

这将为`RichTextBox`C# 提供编码语法

如果您想要另一种语言的编码语法，请将 的内容`keywords` `string`和 , 的内容替换`stringz` `string`为您选择的语言。

要更改`Color`,`keywords`或`stringz`, 然后查看`foreach (Match m in keywordMatches)`, 或`foreach (Match m in stringzMatchez)`

如果您正在使用 C# 以外的任何其他语言，则删除`types`并编辑`strings`和`comments`

我希望这可以帮助你 ：）

# web-services - WebLogic 服务器拒绝某些 Web 服务请求 - 看似基于 SOAP 标头

> ID：11564643
> 
> 赞同：0
> 
> 时间：2012-07-19T15:53:35.993
> 
> 标签：web-services, soap, weblogic, jax-ws, businessworks

我正在开发一个简单的 Web 服务客户端。我在接收来自服务器的响应时遇到问题。由于支持远程服务器的人不合作，我想尽可能多地了解这个问题，并希望为他们指出正确的方向。

鉴于以下细节，是否有可能了解发生了什么？是否应该查看特定的 SOAP 协议设置？

我使用 TcpTrace 捕获出站和入站流量。

当我从soapUI 发送请求时，这是生成的SOAP 标头。此消息**成功**- 我得到一个有效的响应。

```
POST /l2/k2/AddressLookup HTTP/1.1 
Accept-Encoding: gzip,deflate
Content-Type: text/xml;charset=UTF-8
SOAPAction: "http://xmlns.test2.com/k2/addressLookup"
User-Agent: Jakarta Commons-HttpClient/3.1
Host: localhost:7003
Content-Length: 434 
```

当我从 TIBCO BusinessWorks 发送请求时，这是生成的 SOAP 标头。此消息**失败**- 我收到*HTTP 500 内部服务器错误*。

```
POST /l2/k2/AddressLookup HTTP/1.1
content-type: text/xml; charset="utf-8"
SoapAction: "http://xmlns.test2.com/k2/addressLookup"
Connection: close
User-Agent: Jakarta Commons-HttpClient/3.0.1
Host: localhost:7003
Content-Length: 368 
```

当我从一个非常基本的、简洁的 JAX-WS 客户端发送请求时，这是生成的 SOAP 标头。此消息也**失败**- 我收到*HTTP 500 内部服务器错误*。

```
POST /l2/k2/AddressLookup HTTP/1.1
Content-type: text/xml;charset="utf-8"
Soapaction: "http://xmlns.test2.com/k2/addressLookup"
Accept: text/xml, multipart/related, text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2
User-Agent: JAX-WS RI 2.1.6 in JDK 6
Host: localhost:7003
Connection: keep-alive
Content-Length: 389 
```

我应该注意到，Soapaction 属性最初并不存在于 JAX-WS 客户端的 SOAP 标头中。因为我认为这可能与问题有关，所以我通过以下代码添加了该属性：

```
 dispatch.getRequestContext().put(
            BindingProvider.SOAPACTION_USE_PROPERTY, true);

        dispatch.getRequestContext().put(
            BindingProvider.SOAPACTION_URI_PROPERTY,
            "http://xmlns.test2.com/k2/addressLookup"); 
```

最后，这是我从服务器收到的 JAX-WS 和 TIBCO BusinessWorks 请求的错误响应：

```
HTTP/1.1 500 Internal Server Error
Connection: close
Date: Thu, 19 Jul 2012 14:25:07 GMT
Content-Length: 883
Content-Type: text/html
Content-Encoding: identity
X-Compressed-By: com.planetj.servlet.filter.compression.CompressingFilter/1.7
SOAPAction: ""
X-Powered-By: Servlet/2.5 JSP/2.1

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Draft//EN">
<HTML>
<HEAD>
<TITLE>Error 500--Internal Server Error</TITLE>
<META NAME="GENERATOR" CONTENT="WebLogic Server">
</HEAD>
<BODY bgcolor="white">
<FONT FACE=Helvetica><BR CLEAR=all>
<TABLE border=0 cellspacing=5><TR><TD><BR CLEAR=all>
<FONT FACE="Helvetica" COLOR="black" SIZE="3"><H2>Error 500--Internal Server Error</H2>
</FONT></TD></TR>
</TABLE>
<TABLE border=0 width=100% cellpadding=10><TR><TD VALIGN=top WIDTH=100% BGCOLOR=white><FONT FACE="Courier New"><FONT FACE="Helvetica" SIZE="3"><H3>From RFC 2068 <i>Hypertext Transfer Protocol -- HTTP/1.1</i>:</H3>
</FONT><FONT FACE="Helvetica" SIZE="3"><H4>10.5.1 500 Internal Server Error</H4>
</FONT><P><FONT FACE="Courier New">The server encountered an unexpected condition which prevented it from fulfilling the request.</FONT></P>
</FONT></TD></TR>
</TABLE>

</BODY>
</HTML> 
```

非常感谢任何帮助或见解！谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-06T00:09:26.417

您显示的标头是 HTTP 标头，SOAP 标头（如果存在）将位于 SOAP 信封的标头部分。

是什么让您认为问题与标题有关？会不会是 SOAP 内容的制定方式？

我还认为您收到 HTML 错误响应很奇怪……我希望 SOAP 响应包含 FAULT 描述。

# r - 如何选择条件并根据条件分配新值

> ID：11564644
> 
> 赞同：0
> 
> 时间：2012-07-19T15:53:45.233
> 
> 标签：r

假设我有以下包含一系列关键字的数据框，并且我正在尝试为每个关键字创建标签。

```
 keywords = data.frame(keyword=c("aaa auto insurance","cheap car insurance",
"affordable auto insurance","fast insurance quotes","cheap insurance rates",
"Geico insurance","State Farm insurance quote")) 
```

我想生成一个名为 tag 的新列，如下所示。

```
keyword                 Tag
aaa auto insurance      brand | auto
cheap car insurance     cheap | car
Geico insurance         brand 
```

我已经想出了如何在不同的列中创建标签，但想知道如何使用单个轮廓符（“|”）将所有标签添加到一个列中。

所以这就是我为生成单独的标签列所做的事情。我想知道如何更改此代码以生成我之前提到的内容。

```
main <- function(df) {
    brand <- c("aaa","State Farm","Geico","Progressive")
    cheap = c("cheap","cheapest")
    affordable=c("affordable")
    auto=c("auto")
    car=c("car")
    quote=c("quote","quotes")
    rate=c("rate","rates")
    for(i in 1:nrow(df)) {
        words = strsplit(as.character(df[i, 'keyword']), " ")[[1]]
        if(any(brand %in% words)){
              df[i, 'brand'] <- 1 }
        else{
              df[i, 'brand'] <- "NULL" }
        if(any(cheap %in% words)){
              df[i, 'cheap'] <- 2 }
        else{
              df[i, 'cheap'] <- "NULL" }
        if(any(affordable %in% words)){
              df[i, 'affordable'] <- 3 }
        else{
              df[i, 'affordable'] <- "NULL" }
        if(any(auto %in% words)){
              df[i, 'auto'] <- 4 }
        else{
              df[i, 'auto'] <- "NULL" }
        if(any(car %in% words)){
              df[i, 'car'] <- 5 }
        else{
              df[i, 'car'] <- "NULL" }
        if(any(quote %in% words)){
              df[i, 'quote'] <- 6 }
        else{
              df[i, 'quote'] <- "NULL" }
        if(any(rate %in% words)){
              df[i, 'rate'] <- 7 }
        else{
              df[i, 'rate'] <- "NULL" }
   }
  return(df)
}

main(keywords) 
```

如果您想知道为什么标签具有 1:7 的值，那是因为它们对于特定标签是唯一的。

```
tags = data.frame(id=c(1,2,3,4,5,6,7), tag=c("brand","cheap","affordable","auto","car","quote","rate"))
tags 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:59:04.130

您可以使用 paste() 来连接字符串。所以你可以按照以下方式做一些事情

```
df[i, 'tags'] <- paste(df[i, 'tags'], "new-tag", sep="|"); 
```

# android - Eclipse Android 模拟器 - 键盘不工作

> ID：11564649
> 
> 赞同：25
> 
> 时间：2012-07-19T15:53:58.627
> 
> 标签：android, eclipse, keyboard, adt

我刚刚更新到最新的 SDK 版本 16，使用最新版本的 API (16) 创建了一个新版本的 AVD，我的硬件键盘在模拟器上不再工作（甚至我的其他 avd 使用旧版本的 sdk ）。

任何想法如何解决这一问题？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-07-19T16:00:30.923

您是否将 AVD 的“键盘支持”硬件属性设置为“是”？上次我更新 Android SDK 等时，这个过程破坏了我的 adb 配置。所以也许它也影响了你的其他模拟器。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-09-11T22:51:14.010

进入 config.ini 并添加键盘支持行，我必须为我的其他 avd 设备执行此操作，以使它们都能正常工作！

添加：`hw.keyboard=yes`

至：`~/.android/avd/<emulator-device-name>.avd/config.ini`

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-09-19T07:32:38.473

转到 AVD Manager > 选择 AVD > Edit > 在 Hardware 部分按 New > 选择 Keyboard Support > 按 Ok > 将其值更改为 Yes。而已。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-10-07T07:24:35.650

转到eclipse的列表（显示在顶部）选择：

1.  窗户
2.  选择 AVD 管理器
3.  现在从下一个创建的窗口中选择 AVD
4.  转到编辑（从右侧窗口）
5.  现在在硬件选择菜单中
6.  支持键盘
7.  选择确定
8.  现在单击选定的键盘
9.  从列表中选择是

# windows - 如何在 Windows 的 gnuplot 中导出为 eps？

> ID：11564651
> 
> 赞同：1
> 
> 时间：2012-07-19T15:54:02.970
> 
> 标签：windows, gnuplot, eps

我`gnuplot`在 Windows XP 上运行 4.6 版（补丁级别 0）。我已经放置了两个文件，`data.txt`并且`plot.plt`在同一个目录中。

的内容`data.txt`如下（就是从0到2 Pi的sin x）：

```
0\.  0.
0.5 0.479425538604203
1\.  0.8414709848078965
1.5 0.9974949866040544
2\.  0.9092974268256817
2.5 0.5984721441039565
3\.  0.1411200080598672
3.5 -0.35078322768961984
4\.  -0.7568024953079282
4.5 -0.977530117665097
5\.  -0.9589242746631385
5.5 -0.7055403255703919
6\.  -0.27941549819892586 
```

内容`plot.plt`如下：

```
set title 'My Brown'
set xlabel 'my x'
set ylabel 'my y'
plot 'data.txt' lc rgb 'brown'
set term postscript eps enhanced "Arial" 24
set output 'example.eps' 
```

当我打开`plot.plt`时`gnuplot`，确实绘制了数据。此外，在与和`example.eps`相同的文件夹中创建一个文件。但是，似乎是空白/空。当我右键单击然后选择属性时，它说：`data.txt``plot.plt``example.eps``example.eps`

> EPS文件
> 
> 大小：0 字节
> 
> 磁盘大小：0 字节

当我`example.eps`在**Adob​​e Photoshop Elements**中打开时，我只看到一个空白（白色）文件。

你对我做错了什么有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T16:25:13.517

*在指定输出后*指定绘图命令之前，不会写入 eps 文件。可能的解决方案：

*   1）在您的命令之后移动您的绘图`set output`命令
*   2）`replot`在脚本末尾添加一个命令

这两种方法的区别在于*1*只创建一个`eps`文件，而*2*`eps`将在您的默认终端中创建一个绘图，然后在您的文件中重新创建绘图。

如果您不知道，gnuplot 可以绘制没有数据文件的函数。要绘图`sin(x)`，您只需要做： `plot sin(x)`-- 不需要数据文件。

# sorting - Crystal Report 8.5 参数排序

> ID：11564654
> 
> 赞同：1
> 
> 时间：2012-07-19T15:54:11.133
> 
> 标签：sorting, parameters, crystal-reports

我们在大多数程序中使用 8.0 版本的报告，除了我们的传真和电子邮件模块，在报告中必须将其转换为 PDF。我相信 8.0 不支持导出到 PDF。所以我们同时使用 8.0 和 8.5。

我的问题是：

当我通过 8.5 设计器打开使用 8.0 创建的报表时，参数按字母顺序排序。有没有办法在 8.5 中禁用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T15:04:29.637

我遇到了这个问题，而且确实很严重，但是您需要按字母顺序命名参数，以使它们按您想要的顺序显示。您可以为它们提供不同的屏幕提示文本，但实际参数名称需要按字母顺序排列。例如：Param01FirstName、Param02LastName、Param03StartDate、Param04EndDate

# jquery - 适用于我的 CMS 的 Yootheme WidgetKit

> ID：11564658
> 
> 赞同：0
> 
> 时间：2012-07-19T15:54:24.230
> 
> 标签：jquery, cakephp, content-management-system

我使用框架 CakePHP 创建了自己的 CMS

我想安装 Yootheme WidgetKit 插件，但我不知道该怎么做：

[http://www.yootheme.com/widgetkit/](http://www.yootheme.com/widgetkit/)

你能帮我吗 ？

如果不可能，我想在这里找到一个喜欢 SlideSet Deck 的 jquery 插件：http: [//www.yootheme.com/widgetkit/examples/slideset](http://www.yootheme.com/widgetkit/examples/slideset)

先感谢您。

宜兰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T10:59:38.790

Widgetkit 仅与 Wordpress 和 Joomla CMS 兼容。

您应该能够使用 jcycle 来实现相同的功能（[http://jquery.malsup.com/cycle/](http://jquery.malsup.com/cycle/)）

祝你好运戴夫

# javascript - 带有传递 html 标记的 Javascript 键入文本

> ID：11564659
> 
> 赞同：0
> 
> 时间：2012-07-19T15:54:25.933
> 
> 标签：javascript, html

好的，所以我已经走到了这一步，创建了键入文本的 javascript 效果。但这显然不允许我将 html 标记传递为可识别的。这意味着我不能在其中使用链接等。

任何想法如何解决这个问题？:S

```
<div id="Container"></div>
<script type="text/javascript" language="javascript">
    var myString = "This is the text that will be typed...";
    var myArray = myString.split("");
    var loopTimer;
    function textLooper() {
        if(myArray.length > 0) {
            document.getElementById("Container").innerHTML += myArray.shift();
        } else {
            clearTimeout(loopTimer); 
        }
        loopTimer = setTimeout('textLooper()',70);
    }
textLooper();
</script> 
```

它不必只是 js 解决方案，任何有效的东西，所有的想法都是受欢迎的。

谢谢你。

# php - 无距离地理搜索

> ID：11564664
> 
> 赞同：9
> 
> 时间：2012-07-19T15:54:42.690
> 
> 标签：php, geolocation, gis

这是我第一次看地理位置。请原谅我的长问题。我希望很清楚。

我有一个包含 lat & lng 记录的数据库。我正在尝试编写一个 PHP 类，它定义了四个形成边界框的十进制坐标（然后检索框中的所有记录）。

我只需要知道哪些位置在用户位置的*n*公里范围内。我不需要从用户到位置的距离。

我正在建立这个[答案](https://stackoverflow.com/a/5237509/781200)的第一部分。

上述答案的核心是：

> 直线10公里是：
> 
> ```
> on the latitude is equal to ~1'(minute)
> on the longitude is equal to ~6'(minutes) 
> ```
> 
> 以此为基础，做一些快速的数学运算，并在查询中添加到 WHERE 子句中，删除通过添加缓冲区创建的“框”之外的任何位置，并假设 1' lat & 6' long。

嗯，“做一些快速的数学运算”帕特里克说。几天后我没能正确地做数学。

我的班级在那里挂着，似乎工作了 10 公里。但是，我无法使其与任何其他距离一起使用。

首先我移动到秒，所以 10 公里是：

```
on the latitude is equal to 60 seconds
on the longitude is equal to 360 seconds 
```

这工作得很好。

但是，我随后尝试了 5km 是：

```
on the latitude is equal to 30 seconds
on the longitude is equal to 180 seconds 
```

这没有用。

你能解释一下为什么这种方法不适用于 5 公里（以及我尝试过的其他距离）吗？

下面是我的课程代码。显然开关是垃圾。任何帮助表示赞赏。

```
class coords 
{
/*
    Calculate a bounding box from a decimal coordinate and distance.
    The public vars are populated with minimum and maximum longitudes and latitudes which define the boundary.
*/
    public $dec_lat_min;
    public $dec_lat_max;
    public $dec_lng_min;
    public $dec_lng_max;

    function init($dec_lat, $dec_lng, $dist) 
    { 
        // This switch is a terrible way to allow multiple distances.

        // 10km = 1 min lat = 60 sec lat
        // 10km = 6 min lng = 360 sec lng

        // 5km = 30 sec lat
        // 5km = 180 sec lng

        // 1km = 6 sec lat
        // 1km = 36 sec lat

        // 500m = 3 sec lat
        // 500m = 18 sec lat

        switch($dist)
        {
            case 10: // 10km
                $sec_diff_lat = 60;
                $sec_diff_lng = 360;
                break;
            case 5: // 5km
                $sec_diff_lat = 30;
                $sec_diff_lng = 180;
                break;
            case 1: // 1km
                $sec_diff_lat = 6;
                $sec_diff_lng = 36;
                break;
            default: // 500m
                $sec_diff_lat = 3;
                $sec_diff_lng = 18;
                break;  
        }

        // Convert lat to DMS
        $dms_lat = $this->dec2dms($dec_lat);

        // Allow for western hemisphere (ie negative)
        $dms_lat['hem'] == '-' ? $h = -1 : $h = 1;

        // Populate min and max latitudes
        $this->dec_lat_min = $this->dms2dec($dms_lat['deg'],$dms_lat['min'],$dms_lat['sec']+(-1 * $sec_diff_lat * $h),$dms_lat['hem']);
        $this->dec_lat_max = $this->dms2dec($dms_lat['deg'],$dms_lat['min'],$dms_lat['sec']+($sec_diff_lat * $h),$dms_lat['hem']);

        $dms_lng = $this->dec2dms($dec_lng);

        $dms_lng['hem'] == '-' ? $h = -1 : $h = 1;

        $this->dec_lng_min = $this->dms2dec($dms_lng['deg'],$dms_lng['min'],$dms_lng['sec']+(-1 * $sec_diff_lng * $h),$dms_lng['hem']);
        $this->dec_lng_max = $this->dms2dec($dms_lng['deg'],$dms_lng['min'],$dms_lng['sec']+($sec_diff_lng * $h),$dms_lng['hem']);

    }

    function dec2dms($d) 
    {
        $d = (string)$d;

        // got dashes?
        if ($d[0] == "-") {
            $hem = '-';
            $dVal = substr($d,1);
        } else {
            $hem = '';
            $dVal = $d;
        }

        // degrees = degrees
        $dVals = explode('.', $dVal);
        $dmsDeg = $dVals[0];

        // * 60 = mins
        $dRemainder = ('0.'.$dVals[1]) * 60;
        $dmsMinVals = explode('.', $dRemainder);
        $dmsMin = $dmsMinVals[0];

        // * 60 again = secs
        $dMinRemainder = ('0.'.$dmsMinVals[1]) * 60;
        $dmsSec = round($dMinRemainder);

        return array("deg"=>$dmsDeg,"min"=>$dmsMin,"sec"=>$dmsSec, "hem"=>$hem);
    }

    function dms2dec($deg,$min,$sec,$hem) 
    {
        // find decimal latitude
        $d = $deg+((($min*60)+($sec))/3600);
        $d = $hem.$d;

        return $this->round100000($d);
    }

    function round100000($v) 
    {
        return round($v * 100000) / 100000;
    } 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T18:51:04.677

> 直线 10 公里是：在经度上等于 ~6 分钟

距离经度比不是一个常数 - 它取决于用户的纬度。您可以将此函数用于经度差：

```
function distanceToLng($distance,$latDeg) {
    $latRad = $latDeg / 180 * M_PI;
    $R = 6371;
    return atan2(1*sin($distance/$R)*cos($latRad), cos($distance/$R) - sin($latRad)*sin($latRad)) * (180 / M_PI);
} 
```

公式取自[这个](https://stackoverflow.com/questions/7222382/get-lat-long-given-current-point-distance-and-bearing)问题。

您可以使用以下方法计算给定距离的纬度差：

```
$lngDeg = $distanceInKm/6371 * 180 / M_PI 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T19:06:35.507

正如另一个答案指出的那样，您真的想使用考虑到用户纬度的 Haversine 公式。

Haversine 公式：[http ://en.wikipedia.org/wiki/Haversine_formula](http://en.wikipedia.org/wiki/Haversine_formula)

这个另一个答案有大量的资源可以在 PHP 或 SQL 中完成：

[MySQL 大圆距离（Haversine 公式）](https://stackoverflow.com/questions/574691/mysql-great-circle-distance-haversine-formula)

# asp.net - gridview 部分标题

> ID：11564668
> 
> 赞同：2
> 
> 时间：2012-07-19T15:54:51.687
> 
> 标签：asp.net, gridview

有没有办法在 Gridview 中创建节标题？或者用其他一些控制来达到类似的结果？

我现在有几个案例，我希望屏幕看起来像这样......让我看看我是否可以用一些 ASCII 艺术给出这个想法......

```
+-----------------------------------------+
| Office          | Manager   | Sales     |
+-----------------------------------------+
| Eastern Region                          |
+-----------------------------------------+
| New York        | Hamilton  | 1,400,000 |
| Boston          | Adams     | 1,150,000 |
| Philadelphia    | Franklin  |   980,000 |
+-----------------------------------------+
| Southern Region                         |
+-----------------------------------------+
| Atlanta         | Marion    |   840,000 |
| Charlottesville | Jefferson |   920,000 |
+-----------------------------------------+
| Western Region                          |
+-----------------------------------------+
| Dodge City  | Earp          |   450,000 |
| Kansas City | Oakley        |   380,000 |
+-----------------------------------------+ 
```

也就是说，当某些关键字段发生更改时，我希望在新部分上有一个标题行，其格式与详细信息行不同。

有没有办法用 GridView 或其他控件来做到这一点？

到目前为止，我已经通过使用代码生成部分或全部 HTML 标记并构建一个混合标记和数据的大字符串来完成它。这可行，但它很笨拙，难以阅读且难以维护。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T10:39:50.257

您可以使用 ASP.NET 的 Table 控件并根据需要操作数据。

# sql - （本地）SQL Server 运行很慢 vb.net 编程/调试为什么这么慢？Executenonquery 挂起普通办公电脑

> ID：11564671
> 
> 赞同：0
> 
> 时间：2012-07-19T15:55:05.880
> 
> 标签：sql, vb.net, executenonquery

我在我的机器上以（本地）身份运行本地 SQL Sever 实例。我使用的是普通的台式办公电脑（i5-2400 @ 3.1 ghz 2.85 gb ram）。sqlserver.exe 在我的任务管理器中使用了 1.5GB 的内存。我已经开始使用我机器上的 sql server 实例从数据集中上传表格，然后在 sql server 中查询数据以转储到 excel 中。这样做我已经在我的 sql server 表中建立了 8 个表。表 opcosourcingweekly 有大约 400k 行和 26 列......

我认为我的问题可能与 SQL Server 中的索引或终止进程的设置有关。我看不出我的代码在本地 SQL Server 实例上执行简单的删除语句时会如何挂起。

由于某种原因，当我在下面使用 ExecuteNonQuery 时，我的代码挂起......我已将其注释掉并尝试运行程序并在我的本地 Sql Server 实例中进行更新。 **要删除的简单查询在 SQL Management Studeo Express 中运行需要 2-3 分钟...知道为什么我的 sql server 实例的性能如此糟糕吗？**

之前，当我在 button_click 参数中有这些东西时，它并没有花这么长时间......我在我的程序中添加了 datamonthlydump 选项并需要创建私人潜艇......

知道如何使 SQL Server 在本地计算机上运行时更快吗？我已经编写了一些程序，这是我的系统第一次挂起。 **当我在 Visual Basic 中编程时，有时我会在中途停止程序并保持连接打开** 我不知道这是否在我的 sql 服务器上打开了连接，即使在重新启动或如何清除我的 sql 服务器/重新启动它之后也是如此想法如何提高下面代码的性能？谢谢！

```
Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles BtnSQLImport.Click

    If btnMthly.Checked = True Then
        datadumpmthly()
    ElseIf btnWkly.Checked = True Then
        datadumpwkly()
    End If

End Sub

    Private Sub datadumpwkly()
    Dim connectionstring1 As String = "Data Source=(local); Initial Catalog=master;Pooling=False;Integrated Security=True; "
    Dim connection As SqlConnection = New SqlConnection(connectionstring1)
    connection.Open()
    Dim queryString As String = "delete from dbo.OpCoSourcingweekly"
    Dim dbCommand As New SqlCommand(queryString, connection)
    'dbCommand.CommandText = queryString
    'dbCommand.Connection = connection
    'dbCommand.CommandTimeout = 100000
    'dbCommand.ExecuteNonQuery()

    Using bulkcopy As SqlBulkCopy = New SqlBulkCopy(connectionstring1)
        bulkcopy.DestinationTableName = "OpCoSourcingweekly"
        bulkcopy.BulkCopyTimeout = 10000000

        Try
            bulkcopy.WriteToServer(dataset1.Tables(0))
        Catch ex As Exception
            Dim error1 As String
            error1 = ex.Message
            MsgBox("ERROR: " & error1)
        End Try
        bulkcopy.Close()

    End Using
    'dbCommand.CommandTimeout = 100000
    'queryString = "delete from dbo.OpCoSourcingweekly where [Fiscal Year Week] = '201233'"

    'Dim dbCommand1 As New SqlCommand(queryString, connection)
    'dbCommand1.CommandText = queryString
    'dbCommand1.Connection = connection
    'dbCommand.CommandTimeout = 100000
    'dbCommand.ExecuteNonQuery()

    'queryString = "delete from dbo.OpCoSourcingweekly where [Fiscal Year Week] = '201234'"
    'Dim dbCommand2 As New SqlCommand(queryString, connection)
    'dbCommand2.CommandText = queryString
    'dbCommand2.Connection = connection
    'dbCommand.CommandTimeout = 100000
    'dbCommand.ExecuteNonQuery()
    MsgBox("Done with import to SQL")
    connection.Close()
End Sub 
```

**通过以下操作解决感谢您的评论**

```
Private Sub datadumpwkly()
    Dim connectionstring1 As String = "Data Source=(local); Initial Catalog=master; Pooling=False;Integrated Security=True; "
    Using connection As SqlConnection = New SqlConnection(connectionstring1)
        connection.Open()
        Dim queryString As String = "truncate table dbo.OpCoSourcingweekly"
        Using dbCommand As New SqlCommand(queryString, connection)
            dbCommand.CommandText = queryString
            dbCommand.Connection = connection
            dbCommand.CommandTimeout = 100000
            dbCommand.ExecuteNonQuery()

            Using bulkcopy As SqlBulkCopy = New SqlBulkCopy(connectionstring1)
                bulkcopy.DestinationTableName = "OpCoSourcingweekly"
                bulkcopy.BulkCopyTimeout = 10000000

                Try
                    bulkcopy.WriteToServer(dataset1.Tables(0))
                Catch ex As Exception
                    Dim error1 As String
                    error1 = ex.Message
                    MsgBox("ERROR: " & error1)
                End Try
                bulkcopy.Close()

            End Using
            dbCommand.CommandTimeout = 100000
        End Using
        queryString = "delete from dbo.OpCoSourcingweekly where [Fiscal Year Week] = '201233'"

        Using dbCommand1 As New SqlCommand(queryString, connection)
            dbCommand1.CommandText = queryString
            dbCommand1.Connection = connection
            dbCommand1.CommandTimeout = 100000
            dbCommand1.ExecuteNonQuery()
        End Using

        queryString = "delete from dbo.OpCoSourcingweekly where [Fiscal Year Week] = '201234'"
        Using dbCommand2 As New SqlCommand(queryString, connection)
            dbCommand2.CommandText = queryString
            dbCommand2.Connection = connection
            dbCommand2.CommandTimeout = 100000
            dbCommand2.ExecuteNonQuery()
        End Using
        MsgBox("Done with import to SQL")
        connection.Close()
    End Using
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T15:59:03.210

加快删除整个表的一种方法是使用[TRUNCATE TABLE](http://msdn.microsoft.com/en-us/library/aa260621%28v=sql.80%29.aspx)命令。

使用它有限制（与外键有关），但如果你能够使用它，它会非常快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-10T19:39:58.957

5年后......我遇到了同样的问题并通过将表引擎从MyISAN更改为InnoDB解决了这个问题

# iphone - 避免拖动 cocos2d 中透明部分的精灵触摸

> ID：11564672
> 
> 赞同：0
> 
> 时间：2012-07-19T15:55:06.470
> 
> 标签：iphone, cocos2d-iphone, sprite, transparent

我正在制作一个应用程序，您可以在屏幕上拖动对象，但对象不是完美的正方形，所以我试图避免透明像素。我使用 KKPixelMaskSprite 类来做到这一点，但它不能正常工作有人能指出我正确的方向吗？我有一个从该类继承的类，如下所示：

```
 @interface MyClass : KKPixelMaskSprite 
```

然后我正在阅读以下内容：

```
for (CCSprite *sprite in [_myLayer children]) {
        if ([sprite isKindOfClass:[MyClass class]]) {
            MyClass * object = (MyClass *)sprite;
            if (CGRectContainsPoint(object.boundingBox, touchLocation) && ![object pixelMaskContainsPoint:touchLocation]) {
                _selectedObject = object;
            }
        }
    } 
```

他们在屏幕上移动 _selectedObject，

问题是选择并不完美（它不接近那个），有没有人有解决方案？还有其他我可以遵循的路径吗？

先感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T13:28:10.730

在这种情况下，您必须使用像素完美碰撞。测试您触摸的点是精灵的像素..

[http://www.learn-cocos2d.com/2011/12/fast-pixelperfect-collision-detection-cocos2d-code-1of2/](http://www.learn-cocos2d.com/2011/12/fast-pixelperfect-collision-detection-cocos2d-code-1of2/)

# c# - 如何动态填充 CheckedListBox？

> ID：11564676
> 
> 赞同：5
> 
> 时间：2012-07-19T15:55:12.070
> 
> 标签：c#, winforms, dynamic, checkedlistbox

我想根据传递给表单构造函数的项目（在本例中为 List `<int`>）填充 CheckedListBox。

我的骨架代码是：

```
foreach (int platypus in listPlatypi)
{
    userFriendlyPlatypusName = ExpandFromPlatypusID(platypus);
    // I want to store a verbose string in an Item of the CheckedListBox, something like:
    // Item item = new Item(userFriendlyPlatypusName); // what data type should "Item" be?
     CheckedListBox1.Add(item);
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-19T16:41:13.687

你在找[`checkedListBox1.Items.Add(userFriendlyPlatypusName);`](https://msdn.microsoft.com/en-us/library/z38x31c0(v=vs.110).aspx "MSDN 文档")吗？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-19T16:52:52.150

答案取决于您在列出的框架代码之外做什么。重要的是您的代码稍后对列表项进行操作时需要哪些信息。

`CheckedListBox`就像`ListBox`. 显示的文本是每个项目的`.ToString()`.

如果字符串有效，则添加显示名称文本。

如果您需要为每个项目存储更多信息，`ToString()`请为您的类和`.Add()`完整项目添加覆盖。

如果这不是一个选项，请创建一个小型显示包装器：

```
public class PlatypusDisplayWrapper {
   public Platypus {get; set;}
   public override string ToString() { 
       return this.Platypus.Name;
   }
} 
```

# html - 修复滚动按钮问题

> ID：11564677
> 
> 赞同：0
> 
> 时间：2012-07-19T15:55:12.807
> 
> 标签：html, css

我正在尝试开发的网站上有一个固定的滚动到顶部按钮 - [http://harden6615.com/portfolio/index.html](http://harden6615.com/portfolio/index.html)。我有包装器 div 相对位置和滚动 div #hb-gotop 固定，但按钮调整到浏览器而不是包装器。有什么建议么？

还有一个问题是我在 IE 中的标题背景有问题。如果有人看到是什么原因造成的，那就太好了，但不是这个线程中的问题。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T16:03:33.943

您希望它定位在您的容器中吗？

将您的按钮 CSS 更改为：

```
#hb-gotop{
    -moz-border-radius: 3px;
    -webkit-border-radius: 3px;
    border-radius: 5px; 
    width: 100px;
    background-color: #434343;
    text-align:center;
    padding:5px;
    position: absolute;
    bottom:10px;
    right:10px;
    cursor:pointer;
    color: #45FFE0;
    text-decoration:none;
    } 
```

固定将其锁定到窗口屏幕，因此您需要绝对。

如果我对您在这里的要求感到困惑，请告诉我。

谢谢，迈克尔。

# c# - 多维数组中的 IndexOutOfRangeException

> ID：11564678
> 
> 赞同：-2
> 
> 时间：2012-07-19T15:55:13.730
> 
> 标签：c#, multidimensional-array

我附上了下面的代码，我得到 IndexOutOfRangeException 未在 A 部分中处理，然后我尝试了如下所示的 Try-catch 但现在我得到了

**“在 C:\Users\Rahul Taneja\Documents\Visual Studio 2010\Projects\app\app 中 app.Form6.ZMove(String s1, String s2) 的 app.exe 中发生了类型为‘System.IndexOutOfRangeException’的第一次机会异常\Form6.cs：第 136 行"**

在堆栈跟踪中

谁能告诉我为什么会这样，解决办法是什么？

```
public void ZMove(string s1, string s2)
        {
            //Move 2-1-4-3
            int j = Int32.Parse(s1);
            int k = Int32.Parse(s2);
            for (int l = 0; l < k; l++)
            {
                try
                {
                    swap(array[2][j], array[1][j]); ///Part A
                    swap(array[1][j], array[4][j]);
                    swap(array[4][j], array[3][j]);
                    swap(array[3][j], array[2][j]);
                }
                catch (IndexOutOfRangeException e)
                {
                    MessageBox.Show(e.StackTrace);
                    //throw;
                }
            }
        }

        private void swap(char[] p1, char[] p2)
        {
            //throw new NotImplementedException();
            int l = p1.Length;
            for (int i = 0; i < l; i++)
            {
                char temp = p1[i];
                p1[i] = p2[i];
                p2[i] = temp;
            }
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T16:23:35.117

字符串 s1,s2 是否有可能是绝对位置，您实际上应该这样做：

```
int j = Int32.Parse(s1) -1;

int k = Int32.Parse(s2) -1; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T21:39:25.807

您有 12 种不同的数组访问可能是问题所在，并且您没有让我们看到数组是如何创建的。没有合理的人可以帮助您解决您的具体问题，

所以我会尝试回答这个问题

**如何调试`IndexOutOfRangeException`？**

*   在 Visual Studio 中打开异常窗口
*   展开公共语言运行时异常窗口
*   展开系统节点
*   检查 System.IndexOutOfRangeException 的 Throw 复选框

当异常发生时，您的调试器将中断。现在通过监视、工具提示、命令或即时窗口检查变量。我相信您会很快找到问题所在。

![在此处输入图像描述](../Images/a77d3d3dc70b3d1030a37ddd608a459f.png)

注意：您可以通过以下方式访问“例外”窗口

*   菜单项调试 -> 异常
*   键盘快捷键`Ctrl+Alt+E`
*   键盘快捷键`Ctrl+D,E`
*   命令窗口通过`>Debug.Exceptions`

# regex - 在 Powershell 中使用 Regex 获取电子邮件

> ID：11564679
> 
> 赞同：5
> 
> 时间：2012-07-19T15:55:16.060
> 
> 标签：regex, email, powershell

我编写了一个脚本来抓取 HTML 文件中的不同字段并用结果填充变量。我在获取电子邮件的正则表达式方面遇到问题。这是一些示例代码：

```
$txt='<p class=FillText><a name="InternetMail_P3"></a>First.Last@company-name.com</p>'

$re='.*?'+'([\\w-+]+(?:\\.[\\w-+]+)*@(?:[\\w-]+\\.)+[a-zA-Z]{2,7})'

if ($txt -match $re)
{
    $email1=$matches[1]
    write-host "$email1"
} 
```

我收到以下错误：

```
Bad argument to operator '-match': parsing ".*?([\\w-+]+(?:\\.[\\w-+]+)*@(?:[\\w-]+\\
.)+[a-zA-Z]{2,7})([\\w-+]+(?:\\.[\\w-+]+)*@(?:[\\w-]+\\.)+[a-zA-Z]{2,7})" - [x-y] range in reverse order..
At line:7 char:16
+ if ($txt -match <<<<  $re)
    + CategoryInfo          : InvalidOperation: (:) [], RuntimeException
    + FullyQualifiedErrorId : BadOperatorArgument 
```

我在这里想念什么？另外，是否有更好的电子邮件正则表达式？

提前致谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-19T16:11:42.243

**实际上，任何适用于 .Net 或 C# 的正则表达式都适用于 PowerShell**。你可以在 stackoverflow 和 inet 上找到大量的样本。例如：[如何查找或验证电子邮件地址：官方标准：RFC 2822](http://www.regular-expressions.info/email.html)

```
$txt='<p class=FillText><a name="InternetMail_P3"></a>First.Last@company-name.com</p>'
$re="[a-z0-9!#\$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#\$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?"
[regex]::MAtch($txt, $re, "IgnoreCase ") 
```

但是这个答案还有其他部分。**正则表达式本质上不太适合解析 XML/HTML**。您可以在此处找到更多详细信息：[使用正则表达式解析 HTML：为什么不呢？](https://stackoverflow.com/q/590747/443366)

为了提供真正的解决方案，我首先推荐

1.  转换 HTML → XHTML
2.  遍历 XML 树
3.  一个一个地处理单个节点，甚至使用正则表达式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T16:12:34.160

在电子邮件验证方面，我通常选择 RFC 2822 的简短版本：

> [a-z0-9!#$%&'*+/=?^_ `{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:a-z0-9?.)+a-z0-9?

[您可以在此处](http://www.regular-expressions.info/email.html)找到有关电子邮件验证的更多信息

# regex - 1-99 至小数点后 2 位正数的正则表达式

> ID：11564680
> 
> 赞同：1
> 
> 时间：2012-07-19T15:55:19.373
> 
> 标签：regex

我正在尝试编写一个正则表达式来接受 1-99 的正数并接受最多 2 位的小数 我已经写了这个表达式

```
([1-9]|[1-9][0-9])(.[0-9]{1,2})? 
```

但是当我测试表达式时，它接受 100 和最多 3 位的小数，而我只想要最多 2 位的小数，不应该接受 100。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T15:56:57.980

`.`将匹配任何字符的转义为`\.`。您周围没有分隔符，因此请注意这将匹配，例如，字符串 191.234 中的 91.23。

```
([1-9]|[1-9][0-9])(\.[0-9]{1,2})? 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T16:02:18.967

这似乎对我有用：

```
/^[1-9][0-9]?(\.[0-9]{1,2})?$/ 
```

正如大卫所说，您需要转义您的`.`, 或者它匹配任何字符，包括数字。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-19T16:02:44.113

我会选择这个`^(?:\d[1-9]|[1-9]|[1-9][0-9])(?:\.(?:[0-9][1-9]|[1-9]))?$`

```
0 FAIL
0.0 FAIL
0.00 FAIL
0.1 FAIL
0.12 FAIL
1 PASS
12 PASS
135 FAIL
1.00 FAIL?
01.35 PASS
10.35 PASS
12.01 PASS
12.1 PASS
12.23 PASS
12.234 FAIL 
```

在第一次评论后编辑答案。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-19T16:02:52.920

这将匹配 1-99 和最多 2 个小数位。

```
((0?[1-9]|[1-9][0-9])\.[0-9]{1,2}) 
```

# c# - *.StartPageControl.ClioViewModel.Groups' 是一个“属性”，但在尝试将元素添加到 ObservableCollection 时被用作“类型”错误

> ID：11564686
> 
> 赞同：0
> 
> 时间：2012-07-19T15:55:45.983
> 
> 标签：c#, wpf, combobox, observablecollection

我正在尝试将一个组合框添加到一个已经存在的 WPF 表单中。我已经在 XAML 中创建了组合框代码，并在我的 ViewModel 类中添加了适当的代码。但是，当我尝试将我的组合框项目添加到我的 ObservableCollection 时，我收到以下错误：

```
'AECI.Clio.StartPageControl.ClioViewModel.Groups' is a 'property' but is used like a 'type' 
```

这是我的组合框的 XAML 代码：

```
<ComboBox Name="GroupComboBox" ItemsSource="{Binding Groups}" SelectedItem="{Binding MySelectedItem, Mode=TwoWay}" Width="132" Height="22" Grid.Column="0" Grid.Row="3" Margin="0,30" VerticalAlignment="Top" >    </ComboBox> 
```

这是我的 C# 代码：

```
public class ClioViewModel : INotifyPropertyChanged 
{ 
    public event PropertyChangedEventHandler PropertyChanged;

    protected void OnPropertyChanged(string propertyName)  
    {
        PropertyChangedEventHandler handler = PropertyChanged;
        if (handler != null)
        {
            handler(this, new PropertyChangedEventArgs(propertyName));
        }
    } 

    private ObservableCollection<string> _groups = new ObservableCollection<string>();

    public ObservableCollection<string> Groups 
    { 
        get { return _groups; } set { _groups = value; OnPropertyChanged("Groups");   }   
    } 

Groups.Add("Data Warehouse"); <-- Here is where I get the error 
```

我不知道我做错了什么。请指教。

编辑：

根据要求，这是全部。我没有从一开始就发布整个内容，因为它非常大。

```
namespace AECI.Clio.StartPageControl
{
    public class ClioViewModel : INotifyPropertyChanged
    {
        private Timer _timer;

        public ClioViewModel()
        {
            Harvesters = new ObservableCollection<Harvester>();
        _   timer = new Timer((o) => Application.Current.Dispatcher.BeginInvoke(new Action(LoadAllHarvester)), new object(), TimeSpan.FromMilliseconds(1), TimeSpan.FromMinutes(1));           
    }

    private void LoadAllHarvester()
    {
        Harvesters.Clear();
        foreach(var h in HarvesterModel.GetAllHarvesters())
        {
            Harvesters.Add(h);
        }
    }

    public ObservableCollection<Harvester> Harvesters { get; set; }

    private Harvester _selectedHarvester;

    public Harvester SelectedHarvester
    {
        get { return _selectedHarvester; }
        set
        {
            _selectedHarvester = value;
            if (_selectedHarvester != null)
            {
                _selectedHarvester.PropertyChanged += _selectedHarvester_PropertyChanged;
            }
            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs("SelectedHarvester"));
                PropertyChanged(this, new PropertyChangedEventArgs("Selected"));
                PropertyChanged(this, new PropertyChangedEventArgs("SelectedAndNotLoading"));
            }
        }
    }

    private DateTime _harvestDateStart = DateTime.Today;
    public DateTime HarvestDateStart
    {
        get { return _harvestDateStart; }
        set
        {
            _harvestDateStart = value;
            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs("HarvestDateStart"));
            }
        }
    }

    void _selectedHarvester_PropertyChanged(object sender, PropertyChangedEventArgs e)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs("SelectedHarvester"));
        }
    }

    public bool Selected
    {
        get
        {
            return SelectedHarvester != null;
        }
    }

    public bool SelectedAndNotLoading { get { return Selected && !PostOccuring; } }

    public bool HarvesterPostRequested { get { return false; } set { PostSelectedHarvester(); } }
    public bool HarvesterPauseRequested { get { return false; } set { PauseSelectedHarvester(); } }
    public bool HarvesterUnpauseRequested { get { return false; } set { UnpauseSelectedHarvester(); } }

    private bool _postOccuring;

    public bool PostOccuring
    {
        get { return _postOccuring; }
        set
        {
            _postOccuring = value;
            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs("PostOccuring"));
                PropertyChanged(this, new PropertyChangedEventArgs("SelectedAndNotLoading"));
            }
        }
    }

    private void PostSelectedHarvester()
    {
        PostOccuring = true;
        HarvesterModel.UpdateHarvester(SelectedHarvester);
        PostOccuring = false;
    }

    private void UnpauseSelectedHarvester()
    {
        if (SelectedHarvester != null)
        {
            SelectedHarvester.NextRunTimeUTC = DateTime.UtcNow;
            PostSelectedHarvester();
            SelectedHarvester.CanPause = true;
            SelectedHarvester.CanResume = false;
        }
    }

    private void PauseSelectedHarvester()
    {
        if (SelectedHarvester != null)
        {
            SelectedHarvester.NextRunTimeUTC = null;
            PostSelectedHarvester();
            SelectedHarvester.CanPause = false;
            SelectedHarvester.CanResume = true;
        }
    }

    public bool HarvestRequested { get { return false; } set { HarvestDataNow(); } }

    public void HarvestDataNow()
    {
        var t = HarvestDateStart;
        if (t > DateTime.Now || SelectedHarvester == null)
        {
            return;
        }
        PostOccuring = true;
        HarvesterModel.HarvestDataNow(SelectedHarvester, t, DateTime.Now);
        PostOccuring = false;
    }

    #region Implementation of INotifyPropertyChanged

    public event PropertyChangedEventHandler PropertyChanged;

    #endregion

    protected void OnPropertyChanged(string propertyName)  
    {
        PropertyChangedEventHandler handler = PropertyChanged;
      if (handler != null)
      {
          handler(this, new PropertyChangedEventArgs(propertyName));
      }
    }

    private ObservableCollection<string> _groups = new ObservableCollection<string>();

    public ObservableCollection<string> Groups 
    { 
        get 
        { 
            return _groups; 
        }
        set
        {
            _groups = value;
            OnPropertyChanged("Groups"); 
        }            
    }
    Groups.Add("Data Warehouse");        

    private ObservableCollection<string> _selectedGroups = new ObservableCollection<string>();

    public ObservableCollection<string> SelectedGroups 
    { 
        get
        {
            return _selectedGroups;
        }
        set
        {
            _selectedGroups = value;
            OnPropertyChanged("SelectedGroups");            
        }
    }        

    private string _mySelectedItem;
    public string MySelectedItem
    {
        get{return this._mySelectedItem;}
        set{this._mySelectedItem=value; OnPropertyChanged("MySelectedItem");}
    }      

}

public static class HarvesterModel
{
    private static readonly EndpointAddress ENDPOINT = new EndpointAddress(new Uri("http://LocalHost:49350/POWDataWarehouseFeeder/V1/Silverlight"));
    private static readonly BasicHttpBinding BINDING;

    static HarvesterModel()
    {
        BINDING = new BasicHttpBinding(BasicHttpSecurityMode.TransportCredentialOnly);
        BINDING.Security.Transport.ClientCredentialType = HttpClientCredentialType.Ntlm;
        BINDING.SendTimeout = TimeSpan.FromMinutes(5);
        BINDING.ReceiveTimeout = TimeSpan.FromMinutes(5);
    }

    private static Dictionary<Guid, Clio.HarvesterRecord> Harvesters { get; set; }

    public static void HarvestDataNow(Harvester harvey, DateTime stime, DateTime etime)
    {
        var client = new Clio.ClioManagerV1Client(BINDING, ENDPOINT);

        try
        {
            client.HarvestDataImmediate(new DataHarvestTarget[] { new DataHarvestTarget { EndTimeUTC = etime.ToUniversalTime(), StartTimeUTC = stime.ToUniversalTime(), HarvesterGuid = harvey.HarvesterGuid.ToString(), EndTimeUTCSpecified = true, StartTimeUTCSpecified = true } });
        }
        catch {}

    }

    public static ICollection<Harvester> GetAllHarvesters()
    {
        var client = new Clio.ClioManagerV1Client(BINDING, ENDPOINT);
        HarvesterRecord[] harvs;
        try
        {
            harvs = client.GetHarvesters();
        }
        catch(Exception e)
        {
            harvs = new HarvesterRecord[0];
        }
        foreach (var record in harvs)
        {
            record.HarvesterConfigurationXML.Attributes.RemoveAll();
        }
        Harvesters = harvs.ToDictionary(n => new Guid(n.HarvesterGuid), n => n);

        return
                    harvs.Select(
                                n =>
                                new Harvester
                                    {
                                        Configuration = XElement.Parse(n.HarvesterConfigurationXML.OuterXml).ToString(),
                                        HarvesterGuid = new Guid(n.HarvesterGuid),
                                        HarvesterName = n.HarvesterName,
                                        LastRunMessage = n.LastRunMessage,
                                        LastRunSuccess = n.LastRunResult == HarvestResults.Success,
                                        LastRunTimeUTC = n.LastRunTimeUTC,
                                        NextRunTimeUTC = n.NextScheduledRunTimeUTC,
                                        CanPause = n.LastRunTimeUTC != null,
                                        CanResume = n.LastRunTimeUTC == null,
                                        Schedules = new List<HarvesterSchedule>(n.HarvesterRunScheduleList.Select(h => new HarvesterSchedule { Schedule = h.Schedule, Window = System.Xml.XmlConvert.ToTimeSpan(h.WindowLength), Offset = System.Xml.XmlConvert.ToTimeSpan(h.Offset) })),
                                    }).ToList();
    }

    public static void UpdateHarvester(Harvester harvey)
    {
        var old = Harvesters[harvey.HarvesterGuid];
        var oldPost = new Clio.HarvesterPost
                          {
                              GACFullAssemblyName = old.GACFullAssemblyName,
                              HarvesterConfigurationXML = old.HarvesterConfigurationXML,
                              HarvesterGuid = old.HarvesterGuid,
                              HarvesterName = old.HarvesterName,
                              HarvesterRunScheduleList = old.HarvesterRunScheduleList
                          };
        XmlDocument doc = new XmlDocument();
        doc.LoadXml(harvey.Configuration);
        var newPost = new Clio.HarvesterPost
                          {
                              GACFullAssemblyName = old.GACFullAssemblyName,
                              HarvesterConfigurationXML = doc.DocumentElement,
                              HarvesterGuid = old.HarvesterGuid,
                              HarvesterName = harvey.HarvesterName,
                              IsExeucting = harvey.NextRunTimeUTC != null,
                              IsExeuctingSpecified = true,
                              HarvesterRunScheduleList = harvey.Schedules.Select(s => new Clio.HarvesterRunSchedule { Schedule = s.Schedule, Offset = System.Xml.XmlConvert.ToString(s.Offset), WindowLength = System.Xml.XmlConvert.ToString(s.Window) }).ToArray()
                          };

        var client = new Clio.ClioManagerV1Client(BINDING, ENDPOINT);
        var result = client.PostHarvesters(new[] { new HarvesterPostRequest { Current = oldPost, Updated = newPost } });
        return;
    }
}

public class Harvester : INotifyPropertyChanged
{
    public Guid HarvesterGuid { get; set; }
    public string HarvesterName { get; set; }
    public DateTime LastRunTimeUTC { get; set; }
    public DateTime LastRunTimeLocal { get { return LastRunTimeUTC.ToLocalTime(); } }
    public DateTime? NextRunTimeUTC { get; set; }
    public DateTime? NextRunTimeLocal { get { return (NextRunTimeUTC ?? DateTime.MinValue).ToLocalTime(); } }
    public bool LastRunSuccess { get; set; }
    public string LastRunMessage { get; set; }
    public string Configuration { get; set; }
    public ICollection<HarvesterSchedule> Schedules { get; set; }

    private bool _canPause;

    public bool CanPause
    {
        get { return _canPause; }
        set
        {
            _canPause = value;
            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs("CanPause"));
            }
        }
    }
    private bool _canResume;

    public bool CanResume
    {
        get { return _canResume; }
        set
        {
            _canResume = value;
            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs("CanResume"));
            }
        }
    }

    private bool _editXML;

    public bool EditXML
    {
        get { return _editXML; }
        set
        {
            _editXML = value;
            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs("EditXML"));
            }
        }
    }

    #region Implementation of INotifyPropertyChanged

    public event PropertyChangedEventHandler PropertyChanged;

    #endregion
}

public class HarvesterSchedule : INotifyPropertyChanged
{

    private string _schedule;

    public string Schedule
    {
        get { return _schedule; }
        set
        {
            _schedule = value;
            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs("Schedule"));
            }
        }
    }

    private TimeSpan _offset;

    public TimeSpan Offset
    {
        get { return _offset; }
        set
        {
            _offset = value;
            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs("Offset"));
            }
        }
    }

    private TimeSpan _window;

    public TimeSpan Window
    {
        get { return _window; }
        set
        {
            _window = value;
            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs("Window"));
            }
        }
    }

    #region Implementation of INotifyPropertyChanged

    public event PropertyChangedEventHandler PropertyChanged;

    #endregion
}

public class SuccessBoolToColorConverter : IValueConverter
{
    #region Implementation of IValueConverter

    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        if (value is bool && (bool)value)
        {
            return new SolidColorBrush(Colors.AliceBlue);
        }
        return new SolidColorBrush(Colors.Tomato);
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        if (value is Color && (Color)value == Colors.AliceBlue)
        {
            return true;
        }
        return false;
    }

    #endregion
}

public class BoolToVisibilityConverter : IValueConverter
{
    #region Implementation of IValueConverter

    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        if (value is bool && (bool)value)
        {
            return Visibility.Visible;
        }
        return Visibility.Collapsed;
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        if (value is Visibility && (Visibility)value == Visibility.Visible)
        {
            return true;
        }
        return false;
    }

    #endregion
}

public class HarvesterToCheckedConverter : IValueConverter
{
    #region Implementation of IValueConverter

    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        if (value == null)
        {
            return true;
        }
        return false;
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        return null;
    }

    #endregion
}

public class HarvesterLoading : IValueConverter
{
    #region Implementation of IValueConverter

    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        if(value is bool && (bool)value)
        {
            return 0.0;
        }
        return 1.0;
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        throw new NotImplementedException();
    }

    #endregion
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T16:17:03.060

`Groups.Add("Data Warehouse");`

位置不正确（目前在类定义级别）。将其粘贴到某个方法或设置器中，它将开始工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T16:18:43.510

您的 Groups.Add 需要在某个方法的内部。现在，因为它没有包含在任何方法中，所以它被视为一个静态类。将 Groups.Add 行移到您的构造函数中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T16:21:46.973

您应该将 Groups.Add(...) 放在构造函数中。

```
public ClioViewModel()
{
    Harvesters = new ObservableCollection<Harvester>();
    _timer = new Timer((o) => Application.Current.Dispatcher.BeginInvoke(new Action(LoadAllHarvester)), new object(), TimeSpan.FromMilliseconds(1), TimeSpan.FromMinutes(1));
    Groups.Add("Data Warehouse");
} 
```

# java - 这个界面有什么问题？

> ID：11564690
> 
> 赞同：-3
> 
> 时间：2012-07-19T15:55:53.877
> 
> 标签：java

以下界面有什么问题（如果有的话）？

```
public interface WorldsBestInterface {
    void favoriteMethod(int greatValue){
        System.out.println("Thanks for the smile");
    }
} 
```

我在解决这个问题时遇到了问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-19T15:57:03.880

接口中没有任何代码，只有签名。

```
public interface WorldsBestInterface {
    void favoriteMethod(int greatValue);
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-19T15:56:48.007

不应包含实现。接口只包含方法声明，不包含实现。

```
void favoriteMethod(int greatValue){
        System.out.println("Thanks for the smile");
    } 
```

它应该是

```
 public interface WorldsBestInterface {
    void favoriteMethod(int greatValue);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T16:00:20.047

正如其他人所说，接口仅定义类的结构。这是实现它的类的合同，如果您选择使用它，那么您还必须包括此处定义的方法。因此，任何实现它的类都保证具有接口所具有的功能。

如果您需要在方法中包含代码，则可以选择抽象类。然后，您必须对其进行子类化才能使其可用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-19T16:02:34.450

如果是接口，我们只提供方法签名。但是，如果存在某些方法需要具体实现而其他方法只有方法签名的情况，请考虑使用创建抽象类。例如

```
public abstract class WorldsBestAbstractClass{
  public void favoriteMethod(int greatValue){
        System.out.println("Thanks for the smile");
    }

  public abstract void nextFavoriteMethod(int smallValue);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-19T15:58:23.113

你应该有

```
public interface WorldsBestInterface {
   void favoriteMethod(int greatValue);  // no body, just declaration
} 
```

# morphia - 在morphia中保存模型时如何忽略`@PostPersist`？

> ID：11564696
> 
> 赞同：0
> 
> 时间：2012-07-19T15:56:10.857
> 
> 标签：morphia

我有一个模型，它有一个方法注释`@PostPersist`：

```
@Entity
class User extends Model {
    private String name;
    // getter and setter
    @PostPersist
    public void _postPersist() {
        // do something
    }
} 
```

现在，当我保存用户时，`_postPersist()`将自动调用该方法。

但是现在我必须保存一个用户并`_postPersist()`暂时忽略该方法，有什么办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T22:11:45.480

关于什么

```
@Entity
class User extends Model {
    private String name;
    private transient boolean ignorePostPersist = false;
    public User ignorePostPersist() {ignorePostPersist = true; return this;}
    public void ignorePostPersist(boolean b) {ignorePostPersist = b; return this;}
    // getter and setter
    @PostPersist
    public void _postPersist() {
        if (ignorePostPersist) return;
        // do something
    }
    public void saveWithoutPostPersist() {
        ignorePostPersist = true;
        try {
            save();
        } finally {
            ignorePostPersist = false;
        }
    }
}
...
User user = ...
user.saveWithoutPostPersist(); 
```

# c# - 下拉列表不会在 SelectedItemChanged 上触发

> ID：11564697
> 
> 赞同：0
> 
> 时间：2012-07-19T15:56:21.140
> 
> 标签：c#, asp.net, drop-down-menu

我在更新面板中有一个 DDL，当我将数据绑定到它时，我无法触发 SelectedItemChanged 方法。在 Page_Load 我有：

```
ddl.DataSource = GetList();
ddl.DataBind(); 
```

`GetList()`返回一个`List<string>`

这些值都在那里，但是当我选择一个时没有任何反应。

如果我要像这样手动放入它们：

```
ddl.Items.Add("1");
ddl.Items.Add("2");
ddl.Items.Add("3"); 
```

它有效，为什么？

如果我绑定数据，则永远不会进入下面的方法。

```
protected void ddl_SelectedIndexChanged(object sender, EventArgs e)
    {
        string test = ddl.SelectedItem.Text;
    }

<asp:DropDownList runat="server" ID="ddl" Width="150px"
OnSelectedIndexChanged="ddl_SelectedIndexChanged"></asp:DropDownList> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T16:00:27.077

默认情况下，更改 asp:DropDownList 不会像按钮一样执行回发，因为在许多情况下不需要这样做。您必须将其设置为 true 才能获得回发。

**改变**

```
<asp:DropDownList runat="server" ID="ddl" Width="150px"
OnSelectedIndexChanged="ddl_SelectedIndexChanged"></asp:DropDownList> 
```

**至**

```
<asp:DropDownList runat="server" ID="ddl" Width="150px" AutoPostBack="true"
OnSelectedIndexChanged="ddl_SelectedIndexChanged"></asp:DropDownList> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T15:57:59.260

如果没有，请在 DropDownList 上设置属性 AutoPostBack="true"，这将允许下拉列表回发任何 SelectedIndex 更改

# build - Make有现代替代品吗？

> ID：11564699
> 
> 赞同：13
> 
> 时间：2012-07-19T15:56:27.190
> 
> 标签：build, makefile, build-automation

Make 从来都不是我喜欢的工具，多年来我使用 Ant 很多，但 Ant 非常适合 Java，就像其他几个工具（Grunt、Rake 等）都是关于其他语言的和工具栈。

是否有一个现代工具是：

a) 跨平台

b) 漂亮的语言不可知论者

c) 易于使用

适用于开发人员想要执行的所有自动化任务，但具有比 Make 更现代的功能集和易用性。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T15:59:21.697

一段时间以来，我们一直很高兴地将[*Rake*](http://rake.rubyforge.org/)用于非 Ruby 构建，得出的结论是，一个体面的构建工具需要具备编程语言的能力。我们还没有发现任何我们不能用它做的事情，并且已经将它应用到 .NET 和 Java 项目中。这对你来说还不够语言不可知论吗？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-10-24T23:26:07.123

我很惊讶没有人提到scons。

它是用 Python 编写的，但它是跨平台且与语言无关的。我已经开始将它用于个人 C++ 项目。

[http://www.scons.org/](http://www.scons.org/)

此外，SCons 网站与其他产品的比较也相当不错：

[http://www.scons.org/wiki/SconsVsOtherBuildTools](http://www.scons.org/wiki/SconsVsOtherBuildTools)

您可以将 SCons 与您的存储库捆绑在一起，这会增加大约 2Mb 的所有工具：

[https://sourceforge.net/projects/scons/files/scons-local/](https://sourceforge.net/projects/scons/files/scons-local/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-02T02:53:39.747

据我所知，[Waf的设计目标与 Make 相似。](https://code.google.com/p/waf/)我没有广泛使用任何一个，但是[waf wiki 与其他构建系统进行了详细的比较，](https://code.google.com/p/waf/wiki/WafAndOtherBuildSystems)这解释了为什么类似 make 的系统不是很好。这在很大程度上归结为这样一个事实，即类似于 make 的构建系统实现了自己的有限编程语言，这与使用功能齐全的现有编程语言（Waf 是基于 python）相反，不容易扩展。

# android - InAppBilling：有时未收到 PURCHASE_STATE_CHANGED 消息

> ID：11564704
> 
> 赞同：3
> 
> 时间：2012-07-19T15:56:50.973
> 
> 标签：android, in-app-billing

我在我的应用程序中实现了 InAppBilling，在发布后我发现*有时*我的应用程序没有收到 PURCHASE_STATE_CHANGED 消息并且从未调用 onPurchaseStateChange。有时需要几个小时才能收到它。

我知道这是已知问题[https://groups.google.com/forum/?fromgroups#!topic/android-developers/RoAEFI8-NBs](https://groups.google.com/forum/?fromgroups#!topic/android-developers/RoAEFI8-NBs)

另一方面，它总是收到 REQUEST_PURCHASE 消息，其中包含有关购买状态的正确信息（如果用户卡无效）。

问题是：

1.  我可以使用 REQUEST_PURCHASE 消息作为有关购买交易的最终信息并在 onRequestPurchaseResponse 回调中执行所有操作吗？
2.  如果不正确，请告诉我 - 在这种情况下采取行动的最佳方式是什么？可能有人已经找到了一个好的解决方案？

提前谢谢你，蒂娜

# backbone.js - 在单页应用程序中，如何确定何时丢弃呈现的部分而不是隐藏它以降低浏览器内存？

> ID：11564705
> 
> 赞同：1
> 
> 时间：2012-07-19T15:56:52.843
> 
> 标签：backbone.js, single-page-application

我正在将企业 WPF 应用程序迁移到 Web 应用程序。此时倾向于使用 ASP.net mvc3，backbone.js 的单页面应用程序。

真的只是在寻找最佳实践。当前的 WPF 应用程序允许用户在显示大量数据的许多选项卡之间来回切换。我想复制此功能并关注：

1.  DOM 中的数据量是否会变得太大而浏览器无法处理？
2.  如果用户可能会长时间打开应用程序，我该如何处理使这些数据保持最新状态？

任何建议将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T19:21:39.617

我已经使用 Backbone.js 和类似于 Backbone 的专有 MVC JS 引擎构建了几个单页 Web 应用程序。从那次经验中，我可以告诉你，没有硬性规定，但如果你将应用程序视为一个层次结构，它将帮助你定义何时应该销毁对象。例如，在我的一个应用程序中，有几个模块，每个模块都与特定的业务问题或问题域相关。我的常规规则是，每当业务问题发生变化时，我都会销毁当前模块，然后加载下一个模块。模块本地的所有导航都将简单地隐藏和显示。

在我正在开发的当前应用程序中，我们有能力使应用程序完全成为一个单页 Web 应用程序，但决定为模块提供自己的 html 文件，因此导航到不同的模块将重新加载。为了节省对服务器的调用，我们引导最常见的数据，并将其与页面一起呈现为 JS 对象。这是一种混合方法，对我们来说效果很好。

# iphone - 通过临时在 iTunes 连接中创建一些记录来分发 iOS 应用程序？

> ID：11564706
> 
> 赞同：0
> 
> 时间：2012-07-19T15:56:56.677
> 
> 标签：iphone, ios, distribution, adhoc

我需要其他人测试我的应用程序，但我没有开发者 99$ 帐户，所以我让我的朋友用这个帐户制作一个 ipa 文件。我现在需要这个应用程序和开发。注册过程需要一些时间。我的问题是，在通过临时分发创建 ipa 文件的过程中，是否在 iTunes connect 或他的帐户中创建了一些记录？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T16:01:50.633

我认为不，如果您没有任何激活的苹果帐户，则无法创建 .ipa 文件。因为您必须在制作 .ipa 文件之前设置您的代码签名设置，如果没有有效的配置文件，您将无法设置该文件。所以首先你应该有一个付费的激活苹果账户，然后为你的应用创建一个有效的配置文件，设置你的应用的代码签名，..只有当你可以制作 .ipa 文件时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T16:26:23.867

您的应用程序应具有唯一的捆绑包 ID。

您的朋友必须在 iTunes Connect 中为此捆绑包 ID 创建一个 Ad-Hoc 配置文件才能签署该应用程序。如果未签名，该应用程序将无法运行。

创建 .ipa 文件或 Ad-Hoc 分发不会单独在 iTunes Connect 或您的朋友帐户上创建任何条目。

# ruby - Ruby Mouse Over 不够长，可能需要某种延迟

> ID：11564716
> 
> 赞同：0
> 
> 时间：2012-07-19T15:57:11.573
> 
> 标签：ruby, mouse, delay, mouseover

希望你们一切都好。这是我的第一篇文章。

我正在尝试使用 Cucumber 和 Selenium 2 框架在 Ruby 中编写脚本。

我正在尝试找出如何单击基于悬停的组件上的任何给定链接。

sainsbury 的网站[http://www.sainsburys-live-well-for-less.co.uk/](http://www.sainsburys-live-well-for-less.co.uk/)就是一个很好的例子。

如果您选择第一个链接，即Recipes and Insprirations，然后选择Lets get backing，那么您将被重定向到一个新页面。

我想通过脚本来做到这一点。

目前，我在显示将鼠标光标放在“食谱和灵感”按钮上时出现的覆盖组件时遇到问题。

我可以使用 @driver.mouse.move_to ele 函数使悬停在组件上出现。下一步是查看集合，找到元素并单击它，但问题是涉及的步骤太多，当我什至检查隐藏面板中的项目数量时，面板消失了.

我也尝试过使用 Ruby Builder，但没有运气。如果有人可以帮助我并使用 sainsbury 网站作为示例，那将有很大帮助。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T09:47:18.837

好吧，您可以使用 sleep 命令，后跟您希望 selenium 在执行下一步之前等待的秒数。例如..：

```
sleep 2 
```

在移动到脚本的下一行之前将等待 2 秒。

另请检查 [此](https://stackoverflow.com/questions/6777886/selenium2-webdriver-ruby-how-click-on-a-hidden-link) 答案以单击隐藏菜单..

好的。因为我记得你开始的时候是怎样的。你去吧。我已经为你做了这个。。

```
require "selenium-webdriver"          
Selenium::WebDriver::Firefox     
driver = Selenium::WebDriver.for :firefox

driver.navigate.to('http://www.sainsburys-live-well-for-less.co.uk/')   

menu = driver.find_element(:xpath, "//div[@id='recipes-inspiration-menu']")
submenu = driver.find_element(:xpath, "//li[@class='first first-child  children']")

driver.action.move_to(menu).click(submenu).perform

driver.find_element(:xpath, "//a[@title='Let's Get Baking']").click 
```

正如我所说，下载并安装 Firebug 会对您有很大帮助..

# android - 在 Android 上使用带有 256 位密钥的 Rijndael 进行加密/解密

> ID：11564719
> 
> 赞同：0
> 
> 时间：2012-07-19T15:57:19.367
> 
> 标签：android, web-services, encryption, rijndael

我正在开发一个使用 WS 的 Android 应用程序。android应用程序和WebService之间的信息交换，必须使用256位密钥的算法加密/解密Rijndael。

也就是说，从 WS 返回的所有信息都将被加密，因此我使用算法对其进行解密。

同样，我发送给 WS 的所有信息都应该加密。因此，我将使用加密算法。

我还没有找到可以在 android 平台上使用的 Rijndael。但我在 C# 中有相同的算法。

```
public class KeydKey
{
    public KeydKey()
    {

    }

    #region Metodos de Criptografia
    #region key
    public string key(string vstrTextToBeEncrypted, string vstrEncryptionKey)
    {
        byte[] bytValue;
        byte[] bytKey;
        byte[] bytEncoded;
        byte[] bytIV = { 121, 241, 10, 1, 132, 74, 11, 39, 255, 91, 45, 78, 14, 211, 22, 62 };
        int intLength;
        int intRemaining;
        MemoryStream objMemoryStream = new MemoryStream();
        CryptoStream objCryptoStream;
        RijndaelManaged objRijndaelManaged;

        //O valor deve estar dentro da tabela ASCII (i.e., no DBCS chars)  
        bytValue = Encoding.UTF32.GetBytes(vstrTextToBeEncrypted.ToCharArray());
        intLength = vstrEncryptionKey.Length;

        /* 
           ******A chave cifrada será de 256 bits long (32 bytes)                             
           ****** Se for maior que 32 bytes então será truncado.                               
           ****** Se for menor que 32 bytes será alocado.                                        
           ****** Usando upper-case Xs
         */
        if (intLength >= 32)
        {
            vstrEncryptionKey = vstrEncryptionKey.Substring(0, 32);
        }
        else
        {
            intLength = vstrEncryptionKey.Length;
            intRemaining = 32 - intLength;
            string tmp = "";
            vstrEncryptionKey = vstrEncryptionKey + tmp.PadRight(intRemaining, 'X');
        }

        bytKey = Encoding.ASCII.GetBytes(vstrEncryptionKey.ToCharArray());
        objRijndaelManaged = new RijndaelManaged();

        /*  ****** Cria o valor a ser crifrado e depois escreve                                  
            ****** Convertido em uma disposição do byte 
         */
        try
        {
            objCryptoStream = new CryptoStream(objMemoryStream, objRijndaelManaged.CreateEncryptor(bytKey, bytIV), CryptoStreamMode.Write);
            objCryptoStream.Write(bytValue, 0, bytValue.Length);

            objCryptoStream.FlushFinalBlock();

            bytEncoded = objMemoryStream.ToArray();
            objMemoryStream.Close();
            objCryptoStream.Close();
            return Convert.ToBase64String(bytEncoded);
        }
        catch (Exception ex)
        {
            return null;
        }
    }
    #endregion

    #region dkey
    public string dkey(string vstrstringToBeDecrypted, string vstrDecryptionKey)
    {
        byte[] bytDataToBeDecrypted;
        byte[] bytTemp = new byte[0];
        byte[] bytIV = { 121, 241, 10, 1, 132, 74, 11, 39, 255, 91, 45, 78, 14, 211, 22, 62 };
        MemoryStream objMemoryStream = new MemoryStream();
        CryptoStream objCryptoStream;
        RijndaelManaged objRijndaelManaged;
        byte[] bytDecryptionKey;
        int intLength;
        int intRemaining;
        string strReturnstring = string.Empty;

        //Convert base64 cifrada para byte array
        bytDataToBeDecrypted = Convert.FromBase64String(vstrstringToBeDecrypted);
        intLength = vstrDecryptionKey.Length;

        /* 
           ******A chave cifrada será de 256 bits long (32 bytes)                             
           ****** Se for maior que 32 bytes então será truncado.                               
           ****** Se for menor que 32 bytes será alocado.                                        
           ****** Usando upper-case Xs
         */
        if (intLength >= 32)
        {
            vstrDecryptionKey = vstrDecryptionKey.Substring(0, 32);
        }
        else
        {
            intLength = vstrDecryptionKey.Length;
            intRemaining = 32 - intLength;
            string tmp = "";
            vstrDecryptionKey = vstrDecryptionKey + tmp.PadRight(intRemaining, 'X');
        }

        bytDecryptionKey = Encoding.ASCII.GetBytes(vstrDecryptionKey.ToCharArray());
        objRijndaelManaged = new RijndaelManaged();

        Array.Resize(ref bytTemp, bytDataToBeDecrypted.Length);

        objMemoryStream = new MemoryStream(bytDataToBeDecrypted);

        try
        {

            objCryptoStream = new CryptoStream(objMemoryStream, objRijndaelManaged.CreateDecryptor(bytDecryptionKey, bytIV), CryptoStreamMode.Read);
            objCryptoStream.Read(bytTemp, 0, bytTemp.Length);
            //objCryptoStream.FlushFinalBlock();
            objMemoryStream.Close();
            objCryptoStream.Close();
            return Encoding.UTF32.GetString(bytTemp).Replace("\0", "");
        }
        catch (Exception ex)
        {
            return null;
        }
    }

    #endregion

    #endregion

} 
```

有人告诉我在哪里可以获得android的算法？或者帮我翻译一下我有Java的算法？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T18:28:29.243

`Cipher.getInstance("AES/CBC/PKCS5Padding")`应该做的伎俩。您将必须匹配（字符）编码，并且可以`SecretKeySpec(byte[32])`用来创建 256 位 AES 密钥。

# regex - Perl 正则表达式跳过每隔一行

> ID：11564726
> 
> 赞同：3
> 
> 时间：2012-07-19T15:57:47.387
> 
> 标签：regex, perl

我试图从这样的文本文件中提取每一行的第一个完整数字：

```
8 gcaggcaaactgcgataataaaaggctgtttcaacagcggagtggattgt 1.5307684822361e-176
11 tttacccagtgagtttgaagcaaggatcttttagtttaccgaaaaatgag 3.22210306380202e-293
14 agcaatagcgcgaacagacaacctcatcagtctaccgcgcaccctttccc 1.32107737963584e-52
20 agtgacagggaaaggcgatcgcggctttacgatcagagatcggtgtcggt 0.942504155078175
30 tccggagactttcgattgcatgcaattcaccatcataccctcttgccctc 0
45 actgagcccctgacgctggccagtgtagcgctgtgaagtcccctctcagg 9.49147409471272e-307
53 gaaccgagcgatcgctgctgccattgtctcgccttctgccgaggaatgcc 2.15850303270505e-28 
```

在以下代码中使用正则表达式：

```
my $id = undef;
while (my $line = <INFILE>){
  chomp $line;
  if ($line =~ /\A([0-9]+)/){
      $id = $1;
  }
print OUTFILE "$id\n";
$line = <INFILE>;
chomp $line;
} 
```

我得到的输出只包括其他每一行：

```
8
14
30
53 
```

我试过在不匹配的情况下打印出每一行，一切都在那里。一旦我添加了正则表达式，它就会跳过每一行。有什么想法为什么要这样做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T16:01:10.963

您从`INFILE`句柄读取两次，一次在`while`条件中，一次在循环结束时。

删除，最后阅读：

```
my $id = undef;
while (my $line = <INFILE>){
  chomp $line;
  if ($line =~ /\A([0-9]+)/){
      $id = $1;
  }
  print OUTFILE "$id\n";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T16:01:28.463

您正在跳过文件行

```
 while (my $line = <INFILE>) {   # Reading line once
       chomp $line;   
       if ($line =~ /\A([0-9]+)/){       
          $id = $1;   
       } 
       print OUTFILE "$id\n";
       $line = <INFILE>;   # Reading line again!!!!!

   } 
```

因为你在打电话

```
 $line = <INFILE>; 
```

两次。您不需要`$line = <INFILE>`在代码中包含第二个。

# objective-c - 在基于拆分的应用程序中手动更改视图

> ID：11564727
> 
> 赞同：0
> 
> 时间：2012-07-19T15:57:47.277
> 
> 标签：objective-c, uisplitviewcontroller

我试图让我的应用在用户单击“提交”按钮后切换视图。

这是我到目前为止所拥有的：

视图A.h

```
@property (nonatomic, retain) RootViewController *root; 
```

视图A.m

```
-(void)switchToLogView{

NSLog(@"switch to log view");

UIViewController <SubstitutableDetailViewController> *detailViewController = nil;
LogDetailViewController *newDetailViewController = [[LogDetailViewController alloc] initWithNibName:@"LogDetailViewController" bundle:nil];
detailViewController = newDetailViewController;

// Update the split view controller's view controllers array.
NSArray *viewControllers = [[NSArray alloc] initWithObjects:self.navigationController, detailViewController, nil];
root.splitViewController.viewControllers = viewControllers;

// Dismiss the popover if it's present.
if (root.popoverController != nil) {
    [root.popoverController dismissPopoverAnimated:YES];
}

// Configure the new view controller's popover button (after the view has been displayed and its toolbar/navigation bar has been created).
if (root.rootPopoverButtonItem != nil) {
    [detailViewController showRootPopoverButtonItem:self.root.rootPopoverButtonItem];
}

[detailViewController release];

} 
```

、和都在我的类中声明`splitViewController`（我从苹果示例代码开始）。`popoverController``rootPopoverButtonItem``RootViewController`

代码构建得很好，但是当我调用该方法时，什么也没有发生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T16:23:09.680

我最近也不得不学习如何做到这一点。我希望我的屏幕上有一个“关于”按钮，当用户单击该按钮时它会翻转到另一个视图，然后当他们单击“完成”按钮时翻转回我的原始视图。

我认为你过于复杂了。这是我必须调出关于视图的代码。

```
AboutViewController *aboutViewController = [[AboutViewController alloc] initWithNibName:@"AboutViewController" bundle:nil];

aboutViewController.modalTransitionStyle = UIModalTransitionStyleFlipHorizontal;
[self presentModalViewController:aboutViewController animated:YES]; //Show it! 
```

显然，不要忘记在你的标题中导入它：`#import <AboutViewController.h>`

我恢复原始视图的代码（也就是隐藏关于视图）是：`[self.parentViewController dismissModalViewControllerAnimated:YES];`

# asp.net - 根据 ASP.net 计数显示图像

> ID：11564728
> 
> 赞同：0
> 
> 时间：2012-07-19T15:57:52.660
> 
> 标签：asp.net, image, gridview, dynamic

这应该是一个容易的 - 但对于像我这样的新手来说很难。我有一个用户输入的计数`n`- 基于此，应用程序应该`n`在网格中显示图像。用例：通过/失败系统 -`n`给出的测试数量，显示红色/绿色图标以表示`n`测试通过失败，按顺序排列在一行中。

例如：

```
Row 1: Class 1 | Tests given: 4 | * * o *

Row 2: Class 2 | Tests given: 8 | * * * * o o * * 

where * = image 1 (red), and o = image 2 (green) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:30:56.890

创建一个表。在表中为行创建一个重复器，使用类获取数据。在每一行中，创建另一个转发器。在该中继器中，通过类测试结果获取它。将每个 td 的类设置为通过或失败。在您的 CSS 中，将背景图像设置为您想要通过/失败的图像。

如果您需要代码方面的帮助，请尝试构建一些东西（无论它是否类似于上述方法），我很乐意帮助您解决任何绊脚石。

# sql-server - 当排名指标从负变为正时，SSAS MDX 排名巨大跳过

> ID：11564732
> 
> 赞同：1
> 
> 时间：2012-07-19T15:58:10.620
> 
> 标签：sql-server, ssas, mdx

使用此代码，以下代码，产生的排名在 1 和 50 以及 204 和 400 之间完美运行，但在 50 时，当排名指标从负数变为正数时，它会跳过到 204。MDX 创建一个有序集，然后按该集排名。创建排名的计算成员称为 [measures]。[Level5_Rank] （屏蔽的）数据如下所示，请注意排名在排名指标从负数变为正数的精确时刻跳过。

或者它是否可以在查询上下文之外对其他成员进行排名？

Fall joe -1.80E-02 205 Fall john -1.38E-02 204（此处跳过排名！！！） Fall bob 9.12E-03 51 Fall billy 6.13E-02 50

```
with

 member [Measures].[CYTD Cancel Rate] as
 iif([Measures].[FC Actual PC] + [FC Cancelations PC] = 0, null,
 ( [FC Cancelations PC]/([Measures].[FC Actual PC] + [FC Cancelations PC]) ) )
 , FORMAT_STRING = 'Percent'

 member [measures].[CYTD Cancel Rate vs Goal] as
 IIF(KPIGoal("FC Cancels")=null,null,([Measures].[FC Cancel Rate GL] - [measures].[CYTD Cancel Rate]) * 100)

 set [OrderedLevel5Members] as [Performance Rep Team Org].[Reporting Org Hrchy].[Level5].members 

**member [measures].[Level5_Rank] as IIF(KPIGoal("FC Cancels")=null,null,rank([Performance Rep Team Org].[Reporting Org Hrchy].CurrentMember,OrderedLevel5Members,[Measures].[CYTD Cancel Rate vs Goal]) )**

 member [measures].[Level5] as 
 IIf([Performance Rep Team Org].[Reporting Org Hrchy].CurrentMember.level.ordinal > 4
    ,ancestor([Performance Rep Team Org].[Reporting Org Hrchy].CurrentMember,[Performance Rep Team Org].[Reporting Org Hrchy].[Level5]).member_caption
    ,null
    ) 

 SELECT 
    {
      [measures].[Level5]

        ,[measures].[CYTD Cancel Rate vs Goal]
        ,[measures].[Level5_Rank]

   } ON COLUMNS
 ,NON EMPTY 
    nonempty({
    [Season].[Season].[Season].AllMEMBERS *
        [Performance Rep Team Org].[Reporting Org Hrchy].ALLMEMBERS

    }
        ,{[Measures].[FC Actual PC]}     
    ) 

    DIMENSION PROPERTIES 
    MEMBER_CAPTION
   ,MEMBER_UNIQUE_NAME
   ON ROWS 
FROM 
(SELECT
(
{
    [Performance Rep Team Org].[Reporting Org Hrchy].allmembers

}
)ON COLUMNS
  FROM [Book Fairs Sales]
  )

WHERE
( 
{[Fiscal Year].[Fiscal Year].&[124]
},
{[As Of Time].[Fiscl Hrchy].[Date].&[2012-05-31T00:00:00]
} 
, 
{
[Sales Org Hier Time].[Fiscl Hrchy].[Date].&[2012-05-31T00:00:00]} 
) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T17:32:57.213

我需要在排名前在集合中使用非空

```
WITH 
  MEMBER [Measures].[CYTD Cancel Rate] AS 
    IIF
    (
      [Measures].[FC Actual PC] + [FC Cancelations PC] = 0
     ,null
     ,
      [FC Cancelations PC] / ([Measures].[FC Actual PC] + [FC Cancelations PC])
    ) 
   ,FORMAT_STRING = 'Percent'
  MEMBER [measures].[CYTD Cancel Rate vs Goal] AS 
    IIF
    (
        KPIGoal("FC Cancels")
      = NULL
     ,null
     ,
      ([Measures].[FC Cancel Rate GL] - [measures].[CYTD Cancel Rate]) * 100
    ) 
  SET [OrderedLevel5Members] AS 
    NonEmpty
    ([Performance Rep Team Org].[Reporting Org Hrchy].[Level5].MEMBERS 
    ,[Measures].[CYTD Cancel Rate vs Goal])

  MEMBER [measures].[Level5_Rank] AS 
    IIF
    (
        KPIGoal("FC Cancels")
      = NULL
     ,null
     ,Rank
      (
        [Performance Rep Team Org].[Reporting Org Hrchy].CurrentMember
       ,OrderedLevel5Members
       ,[Measures].[CYTD Cancel Rate vs Goal]
      )
    ) 

SELECT 
  {
    [measures].[CYTD Cancel Rate vs Goal]
   ,[measures].[Level5_Rank]
  } ON COLUMNS
,
--NON EMPTY 

    NonEmpty
    (
      {

          [Performance Rep Team Org].[Reporting Org Hrchy].ALLMEMBERS
      }
     ,{[Measures].[FC Actual PC]}
    )

   ON ROWS
FROM 
(
  SELECT 
    {
      [Performance Rep Team Org].[Reporting Org Hrchy].ALLMEMBERS
    } ON COLUMNS
  FROM [Book Fairs Sales]
)
WHERE 
  (
  [Season].[Season].&[Fall]
    ,[Fiscal Year].[Fiscal Year].&[124]
   ,[As Of Time].[Fiscl Hrchy].[Date].&[2012-05-31T00:00:00]
   ,
      [Sales Org Hier Time].[Fiscl Hrchy].[Date].&[2012-05-31T00:00:00]

  ); 
```

[http://social.msdn.microsoft.com/Forums/eu/sqlanalysisservices/thread/1264dbe8-bc6a-46d5-89b1-6d8825929ba0](http://social.msdn.microsoft.com/Forums/eu/sqlanalysisservices/thread/1264dbe8-bc6a-46d5-89b1-6d8825929ba0)

# delphi - 搜索具有恒定开始和结束字符的可变长度字符串

> ID：11564739
> 
> 赞同：0
> 
> 时间：2012-07-19T15:58:37.027
> 
> 标签：delphi, delphi-xe2

> **可能重复：**
> [删除 Delphi 中标签之间的变量子字符串的所有实例](https://stackoverflow.com/questions/11550046/delete-all-instance-of-variable-substring-between-tags-in-delphi)

这可能是一个非常基本的事情，但由于某种原因我无法弄清楚。我需要在富文本编辑中搜索以恒定的第一个和最后一个字符开头的字符串。文件使用：

```
<sometextofvariablelength> 
```

作为动态搜索和替换功能的通配符。在文档打印之前，我需要快速解析文本并删除 <> 中仍然留在文档中的任何内容。

弄清楚我真正需要帮助的地方。我需要知道如何搜索特定字符，在本例中为 '<' 并查找下一个 '>' 并删除整个字符串。

更新：使用以下建议的答案：

```
function ClearWildCards(const s: string): string;
var
    I, J: integer;
begin
    Result := s;
    I := 1;
    repeat
        I := PosEx('<', Result, I);
        if I = 0 then
            Break;
        J := PosEx('>', Result, I + 4);
        if J = 0 then
            Break;
        Delete(Result, I, (J + 3) - I);
    until False;
end; 
```

接着

```
DocPreview.Text := ClearWildCards(DocPreview.Text); 
```

确实根据我的需要清除了通配符，但它产生了另一个问题。该文档将丢失其所有格式。

# imagemagick - ImageMagick 中是否有边界框功能？

> ID：11564743
> 
> 赞同：1
> 
> 时间：2012-07-19T15:58:52.910
> 
> 标签：imagemagick, python-imaging-library, jmagick

ImageMagick 中是否有类似于 PIL 中的边界框功能？具体来说，我可以与 JMagick 一起使用吗？我发现从 PIL 切换到 JMagick 非常困难——那里有什么好的文档吗？我已经查看了 java 文档，但它对我没有帮助。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T12:35:00.600

你的意思是调整大小以适应边界框？如果是这样，您可以使用`-resize WIDTHxHEIGHT`缩放图像以适应 WIDTH 和 HEIGHT，保持原始纵横比。

对于 JMagick，我想这应该转化为一些 resize() 方法。

# objective-c - 在 coredata 和 restkit 本地更新托管对象的属性

> ID：11564744
> 
> 赞同：2
> 
> 时间：2012-07-19T15:58:59.967
> 
> 标签：objective-c, ios, core-data, restkit

自 15 天以来，我一直在与 RestKit 作斗争。一旦我从远程接收到数据，我还希望能够在本地编辑属性并保存。

我尝试了几种不同的方法，但似乎都没有奏效；

```
 user.attribute = @"new valuel";
[[[RKObjectManager sharedManager].objectStore managedObjectContextForCurrentThread] save:&error];

        if(error)       
             NSLog(@"Error saving %@", error); 
```

第二种方法是将值分配给实例本身并保存；

```
user.attribute = @"new valuel";
[user.managedObjectContext save:&error ];
NSlog(@"%@", error) 
```

再试一次，

```
[[RKObjectManager sharedManager].objectStore save:&error]; 
```

看来我无法获得指向上下文的指针。怎么可能得到指针，或者可能是保存对象，还是完全不可能？这些都不会保存到数据库中，也不会引发任何错误。这里有什么问题 ？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-24T08:40:11.517

我也有同样的问题。我也在尝试你的步骤，然后用 Firefox 插件打开数据库，我可以检查 db 没有更新。

如果我找到任何最终解决方案，会告诉你...

**更新：**

我终于让我的代码工作了，添加了方法 refreshObject:mergeChanges。最后我的代码是这样的：

```
 // Make changes in managedObjectYouWantToSave 
   [managedObjectYouWantToSave.managedObjectContext refreshObject:managedObjectYouWantToSave mergeChanges:YES];
   [managedObjectYouWantToSave.managedObjectContext save:&error]; 
```

# javascript - 如何使用 javascript 创建站点地图

> ID：11564748
> 
> 赞同：0
> 
> 时间：2012-07-19T15:59:06.780
> 
> 标签：javascript, web-crawler, web-scraping

我正在寻找有关如何创建 javascript 的文档，该 javascript 将遵循页面或站点上的所有链接，并创建它们的地图或列表。或者，如果有更好的方法来做到这一点，那也很棒。我只是想获得一个包含 3000 多个页面的网站上所有页面的完整列表。我也不知道在这个问题上贴什么标签，所以那个领域的提示会很冷。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:09:11.237

您正在寻找的内容被称为：

1.  网络爬取
2.  屏幕抓取

使用谷歌，您将能够在您喜欢的技术中找到解决方案。

我个人喜欢python包[scrapy](http://scrapy.org/)

**更新：**例如，只需搜索“javascript screen scraping tutorial”即可为您提供：[pjScrape](http://nrabinowitz.github.com/pjscrape/)一个用 javascript 编写的网络抓取框架

# c++ - 使用并行模式库 (ppl.h)

> ID：11564749
> 
> 赞同：2
> 
> 时间：2012-07-19T15:59:10.433
> 
> 标签：c++, concurrency, parallel-processing

我正在尝试学习如何在 c++ 中使用 ppl.h 。但我不确定我应该在 VS2010 中创建什么样的解决方案来使用它。如果我创建了一个没有 CLR'concurrency' 的 Win32 控制台应用程序，并且如果我使用 CLR 创建 Win32 控制台应用程序，我会收到一条错误消息

> 编译 /clr 时不支持并发运行时。

```
#include "stdafx.h"
#include <ppl.h>
using namespace System;
void BubbleSort(int* input, int n)
{
    concurrency::parallel_for(0,n,[=](int y)
    {
        for(int k = 0; k< n - 1 -y; k++)
        {
            if(input[k]> input[k+1])
            {
                auto temp = input[k+1];
                input[k+1] = input[k];
                input[k] = temp;
            }
        }
    }
}
int main(array<System::String ^> ^args)
{
    Console::WriteLine(L"Hello World");

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T16:03:06.947

您可以制作一个 Win32 控制台应用程序（无 CLR）。一旦你`#include <ppl.h>`，`Concurrency`命名空间应该是可用的。请注意，它是[`Concurrency::parallel_for`](http://msdn.microsoft.com/en-us/library/dd492819.aspx)（大写的“C”）。

有关详细信息，请参阅[MSDN 上的 PPL 示例](http://msdn.microsoft.com/en-us/library/dd492418.aspx)。

# javascript - 使用 jquery 解析 json 以构建动态填充的选择

> ID：11564753
> 
> 赞同：3
> 
> 时间：2012-07-19T15:59:19.260
> 
> 标签：javascript, jquery, json

我必须构建一个动态填充的选择，但我对此很陌生，而且我在 json 解析方面遇到了一些困难......

我的代码是

```
cb="";
$('#datepicker').blur(function() {
    cb='<option value="0"></option>';
    if ($('#datepicker').val() != "") {
        $.getJSON("json.php?t=cb&id=" + $("#datepicker").val(), function(data){

            *some magic*

            *for each pair of element in json*
                 cb+='<option value="'+data.id+'">'+data.description+'<option/>';

        });
    }
    $('#select').html(cb);
}); 
```

可悲的是没有魔术:(

我必须解析的json就像

```
[{"id":5423,"description":"sometext1"},
{"id":4132,"description":"sometext2"}
{"id":5534,"description":"sometext3"}
...
] 
```

但我不知道该怎么做......你能帮帮我吗？

对不起我的英语不好 :D

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T16:03:45.567

像这样修改你的代码：

```
$.getJSON("json.php?t=cb&id=" + $("#datepicker").val(), function(jsonData){
     cb = '';
     $.each(jsonData, function(i,data){
         cb+='<option value="'+data.id+'">'+data.description+'</option>';
     });
     $("#select").append(cb);
}); 
```

# mysql - 我应该标准化发票数据库表集吗？

> ID：11564757
> 
> 赞同：1
> 
> 时间：2012-07-19T15:59:27.757
> 
> 标签：mysql, database, database-design

我正在构建一个在线发票平台，但我正在为规范化的概念而苦苦挣扎，因为它与放置在每张发票上的行项目有关。我的表结构如下：

## 雇主

*   ID（PK，自动增量）
*   empID (int)
*   名称（varchar）
*   （其他无关字段）

## 成员

*   ID（PK，自动增量）
*   empID（对雇主的 FK）
*   会员编号（整数）
*   名称（varchar）
*   （其他无关字段）

## 计划

*   平面（PK，自动增量）
*   描述（varchar）
*   价格（十进制）

## member_plans

*   ID（PK，自动增量）
*   memberid (FK 到会员)
*   planid（FK 到计划，int）
*   状态（int，1 表示活动，0 表示非活动）
*   开始（日期时间）
*   结束（日期时间，可以为空）

## 发票

*   invoiceid（PK，自动增量）
*   empID（对雇主的 FK）
*   日期（日期时间）
*   小计（十进制）
*   增值税（十进制）
*   previous_owed（十进制）
*   状态（整数）

## 发票项目

*   ID（PK，自动增量）
*   invoiceid（FK 到发票）
*   memberid（FK 到成员）
*   planid（FK 到计划）
*   价格（十进制）

成员属于雇主团体。雇主代表其成员支付会费。每个成员可以选择多个计划，因此发票将包含行项目（memberid、name）以及每个成员的子项目（planid、描述、价格）。每个成员的所有计划的总和组合在一起，并开具发票给雇主以供在线审查。

我希望能够随时返回并根据所选日期生成发票。目前，我基本上每个月都会导入所有现有 member_plans 的快照，导入 invoice_items 并分配一个 invoiceid。这似乎有很多数据被复制（尽管可能需要一个真正的快照，因为 member_plans 中的开始和结束日期并不能真正指示某些因素，即结束日期可以在任何时间点更改“好像“由于退款或法律问题，会员在特定时间段内从未活跃过）。

是否有适当/有效的方法来规范 invoice_items 表，或者我列出的方法真的是唯一正确的方法吗？无论如何，计划是在 7 个月后归档发票，因此虽然表大小值得关注，但它并不是一个永无止境的增长表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T11:19:45.350

以下是 invoice_items 的一些小设计问题。

```
ID (PK, autoincrement)
invoiceid (FK to invoices)
memberid (FK to members)
planid (FK to plans)
price (decimal) 
```

ID 是不必要的，并且没有任何其他更改，是一个损坏的代理键。它已损坏，因为作为代理，它应该代替自然键，但您还没有创建自然键。*（代孕*这个词本质上的意思是“代替”。例如，*代孕母亲*代替了亲生母亲。）

让我们看一些伪SQL。

```
create table invoice_items (
  invoiceid integer not null,

  -- Traditionally, line items are numbered sequentially starting at 1
  -- for each invoice. Your traditions might be different. "Some sane value"
  -- prevents you from sending someone a 10,000 line invoice by mistake.
  -- See below (way below) for implementing CHECK() constraints in MySQL.
  -- A constraint that says, "Start with 1, no gaps" would be nice. I'll
  -- let you code that one. ;)
  line_item_num integer not null check (line_item_num >= 1 and
                                        line_item_num <= [some sane value]),

  memberid integer not null,
  planid integer not null,

  -- Choose the range to fit your application, and to prevent egregious mistakes.
  price decimal(...) not null check (price between -10000 and 10000),

  -- This constraint implements the traditional idea of invoice line items.
  primary key (invoiceid, line_item_num),

  -- This constraint prevents billing a single member plan twice on one invoice.
  -- It might need to be dropped. For example, if you invoice one line item for
  -- the base price for a member plan, then also invoice one line item for 
  -- a discount to the same member plan, you'd need to drop this constraint.
  unique (invoiceid, memberid, planid),

  foreign key (invoiceid) references invoices (invoiceid),

  -- This foreign key needs to reference the single table member_plans, not the 
  -- two tables members and plans. Referencing the single table prevents you from
  -- invoicing a member for a plan that member hasn't chosen.
  foreign key (memberid, planid) references member_plans (memberid, planid)
); 
```

您在此表中提到了“描述”，但将其排除在列列表之外。我也漏掉了。

**检查 MySQL 中的约束**

MySQL 不支持 CHECK() 约束。在某些情况下，将 CHECK() 约束实现为对另一个表的外键引用是可行的。例如，将我为上面的 line_item_num 编写的 CHECK() 约束实现为对行项目编号表的外键引用是很实用的。

在其他情况下，外键引用可能不实用。例如，价格的范围可能太大，您无法以这种方式实施。-10000.00 到 +10000.00 的范围需要几百万行。一种替代方法是使用触发器。在最坏的情况下，您可能不得不依赖应用程序代码和异常报告。（偶尔会运行异常报告以搜索漏掉的无效值。）

**其他一些东西要看。. .**

发票 ID 号*通常*不是自动递增的整数。自动递增整数可以有间隙。会计师*讨厌*差距。迟早，他们会想知道发票编号 10156 发生了什么，并且他们*不*喜欢听到“这可能只是由于交易失败或其他原因导致 dbms 丢弃的数字”。

如果employees.empID 是唯一的，添加另一个带有ID 号的列并不会使其更加唯一。members.memberid 也是如此。请参阅[货物崇拜编程](http://en.wikipedia.org/wiki/Cargo_cult_programming)。

# php - 为什么我对 Zend Translate 的调用在视图中不起作用？

> ID：11564758
> 
> 赞同：0
> 
> 时间：2012-07-19T15:59:28.997
> 
> 标签：php, zend-framework, zend-translate

在我看来，这个电话`$this->translate('test')`不起作用。

在引导程序中，我有以下代码来启动翻译：

```
protected function _initTranslate() {
    $apc = $this->getOption('enable_apc_cache');
    if ($apc) {
        $cache = Zend_Registry::get('cache');
        Zend_Translate::setCache($cache);
    }

    // Set the correct locale
    $locale = new Zend_Locale('nl');
    Zend_Registry::set('Zend_Locale', $locale);

    // Form error translations
    $translator = new Zend_Translate(
        'array',
        APPLICATION_PATH.'/../resources/languages',
        'auto',
        array('scan' => Zend_Translate::LOCALE_DIRECTORY)
    );
    Zend_Form::setDefaultTranslator($translator);

    // All other translations, including form labels
    $translate = new Zend_Translate(
        'gettext',
        APPLICATION_PATH.'/../resources/languages/',
        'auto',
        array('scan' => Zend_Translate::LOCALE_DIRECTORY));
    Zend_Registry::set('Zend_Translate', $translate);
} 
```

如果我理解正确（已经在 stackoverflow 和 Google 上搜索过），将翻译器放入注册表中，键`Zend_Translate`应该是诀窍。

现在在我看来，当我打电话`<?php echo $this->translate->_('Purchaseorder'); ?>`或`<?php echo $this->translate->('Purchaseorder'); ?>`它给我一个错误。

`Call to a member function _() on a non-object`有下划线调用和`Parse error: syntax error, unexpected '(', expecting identifier (T_STRING) or variable (T_VARIABLE) or '{' or '$'`没有下划线调用。

我在做什么错/错过了什么？根据[http://framework.zend.com/manual/en/zend.view.helpers.html#zend.view.helpers.initial.translate](http://framework.zend.com/manual/en/zend.view.helpers.html#zend.view.helpers.initial.translate)这应该可以解决问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T19:46:44.237

正确的语法应该是：

```
<?php echo $this->translate('Purchaseorder'); ?> 
```

您确实在帖子的顶部使用了这种语法，但从您稍后提到的代码看来，您实际上在那里使用了不同的语法。

# java - Android 上的 Kaltura Java 客户端库

> ID：11564762
> 
> 赞同：0
> 
> 时间：2012-07-19T15:59:34.847
> 
> 标签：java, android, log4j, kaltura

我正在编写一个 Android API 级别 10 应用程序，它捕获视频，然后将它们上传到我们的 Kaltura 站点。这应该是直截了当的，因为 Kaltura 提供了一个 Java 客户端库（[此处](http://www.kaltura.org/kaltura-client-library-java)），并且他们在名为“Kaltura Android SDK 参考应用程序实施指南”的文档中说要使用 Java 客户端库。（[这里](http://cdnknowledge.kaltura.com//sites/default/files/Kaltura_Android_SDK_Reference_Application_Implementation_Guide_Eagle_0.pdf)）

好吧，在编写了与 Java 客户端库示例相同的初步 Kaltura 上传类之后，Kaltura 显示（在第一个链接上）包括我项目的 Java 客户端库“libs”文件夹中包含的所有构建引用，JUnit 除外因为 Android 已经拥有自己的 JUnit（包括它们的 JUnit 导致构建失败），所以应用程序在构建新的 KalturaClient 对象期间抛出 java.lang.VerifyError：

```
W/dalvikvm(8232): VFY: array-length on non-array
W/dalvikvm(8232): VFY:  rejecting opcode 0x21 at 0x000a
W/dalvikvm(8232): VFY:  rejected Lorg/apache/log4j/config/PropertySetter;.getPropertyDescriptor (Ljava/lang/String;)Ljava/beans/PropertyDescriptor;
W/dalvikvm(8232): Verifier rejected class Lorg/apache/log4j/config/PropertySetter;
W/dalvikvm(8232): Exception Ljava/lang/VerifyError; thrown while initializing Lorg/apache/log4j/LogManager;
W/dalvikvm(8232): Exception Ljava/lang/ExceptionInInitializerError; thrown while initializing Lcom/kaltura/client/KalturaClientBase;
D/AndroidRuntime(8232): Shutting down VM
W/dalvikvm(8232): threadid=1: thread exiting with uncaught exception (group=0x40015560)
E/AndroidRuntime(8232): FATAL EXCEPTION: main
E/AndroidRuntime(8232): java.lang.ExceptionInInitializerError
E/AndroidRuntime(8232):     at com.mysite.myapp.kaltura.KalturaUploader.<init>(KalturaUploader.java:32)
E/AndroidRuntime(8232):     at com.mysite.myapp.storage.LoginActivity.invokeKaltura(LoginActivity.java:105)
E/AndroidRuntime(8232):     at com.mysite.myapp.storage.LoginActivity.access$2(LoginActivity.java:102)
E/AndroidRuntime(8232):     at com.mysite.myapp.storage.LoginActivity$3.onClick(LoginActivity.java:81)
E/AndroidRuntime(8232):     at android.view.View.performClick(View.java:2506)
E/AndroidRuntime(8232):     at android.view.View$PerformClick.run(View.java:9112)
E/AndroidRuntime(8232):     at android.os.Handler.handleCallback(Handler.java:587)
E/AndroidRuntime(8232):     at android.os.Handler.dispatchMessage(Handler.java:92)
E/AndroidRuntime(8232):     at android.os.Looper.loop(Looper.java:130)
E/AndroidRuntime(8232):     at android.app.ActivityThread.main(ActivityThread.java:3835)
E/AndroidRuntime(8232):     at java.lang.reflect.Method.invokeNative(Native Method)
E/AndroidRuntime(8232):     at java.lang.reflect.Method.invoke(Method.java:507)
E/AndroidRuntime(8232):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:864)
E/AndroidRuntime(8232):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:622)
E/AndroidRuntime(8232):     at dalvik.system.NativeStart.main(Native Method)
E/AndroidRuntime(8232): Caused by: java.lang.ExceptionInInitializerError
E/AndroidRuntime(8232):     at org.apache.log4j.Logger.getLogger(Logger.java:118)
E/AndroidRuntime(8232):     at com.kaltura.client.KalturaClientBase.<clinit>(KalturaClientBase.java:45)
E/AndroidRuntime(8232):     ... 15 more
E/AndroidRuntime(8232): Caused by: java.lang.VerifyError: org.apache.log4j.config.PropertySetter
E/AndroidRuntime(8232):     at org.apache.log4j.PropertyConfigurator.parseAppender(PropertyConfigurator.java:684)
E/AndroidRuntime(8232):     at org.apache.log4j.PropertyConfigurator.parseCategory(PropertyConfigurator.java:647)
E/AndroidRuntime(8232):     at org.apache.log4j.PropertyConfigurator.configureRootCategory(PropertyConfigurator.java:544)
E/AndroidRuntime(8232):     at org.apache.log4j.PropertyConfigurator.doConfigure(PropertyConfigurator.java:440)
E/AndroidRuntime(8232):     at org.apache.log4j.PropertyConfigurator.doConfigure(PropertyConfigurator.java:476)
E/AndroidRuntime(8232):     at     org.apache.log4j.helpers.OptionConverter.selectAndConfigure(OptionConverter.java:471)
E/AndroidRuntime(8232):     at org.apache.log4j.LogManager.<clinit>(LogManager.java:125)
E/AndroidRuntime(8232):     ... 17 more
I/Process(8232): Sending signal. PID: 8232 SIG: 9 
```

所以我猜发生上述情况是因为如果没有额外的包装类 (code.google.com/p/android-logging-log4j)，Log4J 不能完全在 Android 上运行，那么为什么不直接修改 Kaltura 以使用 Android 的日志记录工具呢？

因为我读过（在 Kaltura 的文档中）Java 客户端不是编写的而是生成的，所以我觉得手动编辑代码以支持 android-logging-log4j 会很天真。此外，当我在 Eclipse 中打开 Kaltura Java Client 源代码时，我的构建路径中缺少一些类。我注意到的第一个是 sun.misc.BASE64Encoder...Android 确实有它自己的 Base64Encoder，它可以兼容吗？

有人对我应该做什么有任何建议吗？有人在 Android 上运行 Kaltura Java 客户端库吗？第二个链接中描述的示例应用程序在哪里？

附带说明一下，当我构建项目时，我还在 Eclipse 控制台中看到了许多这些消息，包括在我的构建路径中提供的 JAR：

```
[2012-07-18 22:44:37 - MyApp] Dx warning: Ignoring InnerClasses attribute for an anonymous inner class
(org.apache.commons.httpclient.protocol.ControllerThreadSocketFactory$1) that doesn't come with an
associated EnclosingMethod attribute. This class was probably produced by a
compiler that did not target the modern .class file format. The recommended
solution is to recompile the class from source, using an up-to-date compiler
and without specifying any "-target" type options. The consequence of ignoring
this warning is that reflective operations on this class will incorrectly
indicate that it is *not* an inner class. 
```

在此先感谢您的帮助！

* * *

编辑：浏览 Kaltura 代码，我发现了一些可怕的东西，这一定是这个生成的库的结果......

```
// ===================================================================================================
//                           _  __     _ _
//                          | |/ /__ _| | |_ _  _ _ _ __ _
//                          | ' </ _` | |  _| || | '_/ _` |
//                          |_|\_\__,_|_|\__|\_,_|_| \__,_| 
//
// This file is part of the Kaltura Collaborative Media Suite which allows users
// to do with audio, video, and animation what Wiki platfroms allow them to do with
// text.
//
// Copyright (C) 2006-2011  Kaltura Inc.
//
// This program is free software: you can redistribute it and/or modify
// it under the terms of the GNU Affero General Public License as
// published by the Free Software Foundation, either version 3 of the
// License, or (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU Affero General Public License for more details.
//
// You should have received a copy of the GNU Affero General Public License
// along with this program.  If not, see <http://www.gnu.org/licenses/>.
//
// @ignore
// ===================================================================================================
package com.kaltura.client.enums;

/**
 * This class was generated using generate.php
 * against an XML schema provided by Kaltura.
 * @date Wed, 18 Jul 12 07:10:33 -0400
 * 
 * MANUAL CHANGES TO THIS CLASS WILL BE OVERWRITTEN.
 */
public enum KalturaFlavorReadyBehaviorType implements KalturaEnumAsInt {
    NO_IMPACT (0),
    REQUIRED (1),
    OPTIONAL (2),
    INHERIT_FLAVOR_PARAMS (0);

    public int hashCode;

    KalturaFlavorReadyBehaviorType(int hashCode) {
         this.hashCode = hashCode;
    }

    public int getHashCode() {
        return this.hashCode;
    }

    public static KalturaFlavorReadyBehaviorType get(int hashCode) {
        switch(hashCode) {
            case 0: return NO_IMPACT;
            case 1: return REQUIRED;
            case 2: return OPTIONAL;
            case 0: return INHERIT_FLAVOR_PARAMS;
            default: return NO_IMPACT;
        }
    }
} 
```

他们是如何编译这段代码的？它甚至不是合法的Java。可能有一百个类，其中大多数在顶部都有“这是自动生成的”通知。其他类也有类似的愚蠢问题（KalturaNullableBoolean）。

现在我将假设 Java 客户端库不存在。存在一个 Ruby 客户端库，过去我在 Android 上使用 JRuby 取得了巨大成功，我们的应用程序只上传大文件，无论如何都需要很长时间，所以开销增加不应该非常明显..如果这一切作品。由于包含的 JRuby JAR，我们只需要接受巨大的 .APK...

更不用说他们把所有东西都塞进了 2 个 Ruby 脚本而不是数百个 Java 类……如果有的话，去掉不兼容的功能就更容易了，至少我的 Eclipse 项目不会是 Kaltura Java 源文件的丛林了。:D

谢谢阅读。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-22T22:55:36.870

客户端确实是自动生成的，随着 Kaltura 的 API 得到更新，服务器每次更新都会生成新的客户端，以提供客户端中的最新功能。您可以在此处阅读有关 Kaltura 客户端库生成器的更多信息：http: [//knowledge.kaltura.com/adding-new-kaltura-api-client-library-generator](http://knowledge.kaltura.com/adding-new-kaltura-api-client-library-generator)

欢迎您认为可以改进客户端库的任何补丁或修改，请随时将其附加到此处或 Kaltura.org 上的问题线程中。

当前的 Java 客户端还不是 Android 友好的，它适合纯 Java 使用。有工作来适应和创建一个 Android 特定版本，非常感谢任何改进的建议或补丁。

# cordova - Phonegap 的连接 API *主动* 扫描无线网络吗？

> ID：11564764
> 
> 赞同：1
> 
> 时间：2012-07-19T15:59:41.990
> 
> 标签：cordova, wifi, wireless

抱歉，如果这是重复的，但我在任何地方都没有找到此信息。

Phonegap 有一个连接 API，详见[此处](http://docs.phonegap.com/en/1.9.0/cordova_connection_connection.md.html#Connection)。这将检查可用网络的信息。我的问题是它是否**主动**检查/扫描无线网络，还是只是使用手机获取的最新无线网络可用性信息？

对于我的项目，我可能需要比平时更频繁地扫描无线网络。如果 Connection API 仅使用手机已有的信息，那么它对我没有用处。但是，如果它启动主动扫描，那么它对我来说将非常有用。

或者，我意识到 Phonegap 上可能有可用的插件来执行此操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-30T05:08:19.237

阅读文档并查看示例后，该 API 不会扫描任何内容。它唯一暴露的属性是`connection.type`根据电话已经拥有的连接返回预定常量的变量。

同样，Javascript 和 HTML 可能不是最适合做你描述的事情。您可能必须为一些低级的事情编写本机代码，例如更改或扫描设备检测到的网络。

# php - 在 fileuploader POST 响应中获取额外的引号

> ID：11564767
> 
> 赞同：0
> 
> 时间：2012-07-19T16:00:25.313
> 
> 标签：php, javascript

我正在使用 Valum 的文件上传器[http://valums.com/ajax-upload/](http://valums.com/ajax-upload/)

下面的 index.html 上传一个文件，而 post.php 返回一些 json。很抱歉没有制作 jsfiddle，但不知道如何实现 ajax 响应。

使用 FF，responseJSON.icon 是

```
<img src="http://www.tapmeister.com/test/doc.png" width="32" height="32" /> 
```

然而，对于 IE8，responseJSON.icon 是

```
<IMG src='"http://www.tapmeister.com/test/doc.png"' width='"32"' height='"32"' > 
```

我对 img 大写没问题，但是，那些额外的引号给我造成了严重破坏。

这是如何解决的？谢谢

索引.html

```
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link href="fileuploader.css" rel="stylesheet" type="text/css"> 
    <style>body {font-size:13px; font-family:arial, sans-serif; width:700px; margin:100px auto;}</style>
    <script src="http://code.jquery.com/jquery-latest.js"></script> 
    <script src="fileuploader.js" type="text/javascript"></script>
    <script>        
    $(function(){
        var uploader = new qq.FileUploader({
            element: document.getElementById('file-uploader-demo1'),
            action: 'post.php',
            onComplete: function(id, fileName, responseJSON){
                $('#icons').append('<li>'+responseJSON.icon+' '+$('<span/>').text(responseJSON.icon).html()+'</li>');
            },
            debug: true
        });
    });
     </script>
</head>

<body>      
    <div id="file-uploader-demo1"></div>
    <ul id="icons"></ul>    
</body>
</html> 
```

post.php

```
<?php
$icon='<img src="http://www.tapmeister.com/test/doc.png" width="32" height="32" />';
$data=array('icon'=>$icon, 'other'=>'other data');
echo(json_encode($data));
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:07:54.280

为什么不直接在 post.php 中发送图像的 URL，然后在 javascript 中构建 IMG-Element？

```
<?php
echo json_encode(array('icon' => 'http://google.de'));
?> 
```

创建图像使用：

```
$('<img>').attr('src', responseJSON.icon); //... 
```

# java - 内部错误; 无法实例化 .

> ID：11564771
> 
> 赞同：0
> 
> 时间：2012-07-19T16:00:31.947
> 
> 标签：java, compiler-errors

所以我正在创建一个程序，它有一个包含大约 20 个变量的类（我们称这个类为 Person）。当我尝试像这样初始化变量时：

```
Person Steph = new Person(SName, SAge, SPhysical, SJob, SEducation, SPastSecret, SSecret1, Secret2, SSecret3, SConnections, SLikes, SHates, SCondtion, SNAME, SAGE, SPHYSICAL, SJOB, SEDUCATION, SPASTSECRET, SSECRET1, SECRET2, SSECRET3, SCONNECTIONS); 
```

我得到错误：

```
internal error; cannot instantiate Person.<init> at Person to 
```

然后列出变量。有谁知道是什么导致了这个错误？

编辑：这是 Person 的完整代码：

```
class Person extends Detect{
public String Name, Age, Physical, Job, Education, PastSecret, Secret1, Secret2, Secret3, Connections, Likes, Hates, Condition;
public boolean NAME, AGE, PHYSICAL, JOB, EDUCATION, PASTSECRET, SECRET1, SECRET2, SECRET3, CONNETCTIONS, LIKES, HATES, CONDITION;

public Person(String Name, String Age, String Physical, String Job, String Education, 
String PastSecret, String Secret1, String Secret2, String Secret3, String Connections, String Likes, 
String Hates, String Condition, boolean NAME, boolean AGE, boolean PHYSICAL, boolean JOB, boolean EDUCATION,
boolean PASTSECRET, boolean SECRET1, boolean SECRET2, boolean SECRET3, boolean CONNECTIONS, 
boolean LIKES, boolean HATES, boolean CONDITION) {

    this.Name = Name;
    this.Age = Age;
    this.Physical = Physical;
    this.Job = Job;
    this.Education = Education;
    this.PastSecret = PastSecret;
    this.Secret1 = Secret1;
    this.Secret2 = Secret2;
    this.Secret3 = Secret3;     
    this.Connections = Connections;
    this.Likes = Likes;
    this.Hates = Hates;
    this.Condition = Condition;
    this.NAME = NAME;
    this.AGE = AGE;
    this.PHYSICAL = PHYSICAL;
    this.JOB = JOB;
    this.EDUCATION = EDUCATION;
    this.PASTSECRET = PASTSECRET;
    this.SECRET1 = SECRET1;
    this.SECRET2 = SECRET2;
    this.SECRET3 = SECRET3;
    this.CONNECTIONS = CONNECTIONS;
    this.LIKES = LIKES;
    this.HATES = HATES;
    this.CONDITION = CONDITION;

}

public void File(){
    System.out.printf("Suspect Name: %s         Age: %s       Appearance: %s\n", Check(NAME, Name), Check(AGE, Age),
        Check(PHYSICAL, Physical));
    System.out.printf("Job: %s          Education: %s           Past Secret: %s\n", Check(JOB, Job), Check(EDUCATION, Education), 
        Check(PASTSECRET, PastSecret));
    System.out.printf("Connections: %s    Secret: %s      Secret: %s    Secret: %s\n", Check(CONNECTIONS, Connections), Check(SECRET1, Secret1),
        Check(SECRET2, Secret2), Check(SECRET3, Secret3));
    System.out.printf("Likes: %s    Hates: %s    Conditions: %s\n\n", Check(LIKES, Likes), Check(HATES, Hates), Check(CONDITIONS, Conditions));
} 
```

}

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T16:09:58.963

您将 23 个参数传递给具有 26 个参数的构造函数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T16:10:18.867

首先，不要让类构造函数传递20个变量。创建一个 POJO 对象并使用它。例如：

```
public class Structure {
   private Object someObj;

   private Object someObj2;

   private Object someObj3;

   private Object someObj4;

   //getters and setters
} 
```

在将其发送到`Person`类构造函数之前，通过 setter 方法设置所需的变量并仅传递此类`Structure`。（这使您的代码更高效，对全球社区和您自己来说更具可读性。）

关于初始化。您确定`Person`该类的构造函数接受所有 20 个变量吗？我很确定您的`Person`类构造函数是错误的。尝试这种方式，这应该工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T16:13:05.303

`Person.<init>`指 Person 类的构造函数。

该错误表明 Person 类的构造函数与您提供的参数不匹配。不幸的是，它没有告诉你为什么不这样做。

您可能希望下载并安装集成开发环境 (IDE)，例如[Eclipse](http://www.eclipse.org/)。它将为您提供有关此类编程问题的更多信息，并使编码变得更加容易。

# wordpress - Wordpress 不插入换行符

> ID：11564772
> 
> 赞同：0
> 
> 时间：2012-07-19T16:00:34.427
> 
> 标签：wordpress, line, wordpress-theming

我有一个 wordpress 网站，我在其中编辑一些页面，但我注意到 wordpress 编辑器没有在我的页面中放置换行符，为什么会这样？

我不会为这开始发生任何改变。这是它的样子：

![在此处输入图像描述](../Images/ed0d2d0a4a3468a6217c1c1f9d7fd54d.png)

但这就是显示方式：

![在此处输入图像描述](../Images/ea79006c1b2f2d30abe6296e88b1f045.png)

我一直在寻找解决此问题的方法，例如放置一些`<br/>`标签，但是我正在处理很多内容，因此这样做会有些烦人，有什么提示吗？

谢谢。

**更新**

Wordpress 生成的 HTML：

```
<div class="container">
    <div class="tagline sixteen columns">
        <h4 style="padding-bottom: 0;" class="page-title">História da cidade de Sorocaba                        
            <p>conheça mais sobre a nossa cidade</p>
        </h4>
    </div>
     <nav class="main sixteen columns">
        <ul id="menu-main" class="clearfix sf-menu"><li id="menu-item-1846" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="http://vitorgusmao.com.br/"><span class="title">Home</span></a></li>
            <li id="menu-item-1797" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="http://vitorgusmao.com.br/compromisso/"><span class="title">Compromisso</span></a></li>
            <li id="menu-item-1821" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="http://vitorgusmao.com.br/blog_/"><span class="title">Blog</span></a></li>
            <li id="menu-item-1796" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="http://vitorgusmao.com.br/sobre/"><span class="title">Sobre</span></a></li>
            <li id="menu-item-1798" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="http://vitorgusmao.com.br/contato/"><span class="title">Contato</span></a></li>
        </ul>
    </nav>
    <!-- Page Content -->
    <div style="float: left;" class="container clearfix page-content">
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed ipsum ante, adipiscing eu pulvinar et, hendrerit eu tellus. Vivamus orci orci, lacinia in mollis eget, rutrum eget purus. Vestibulum luctus lobortis fermentum. Praesent tincidunt velit imperdiet massa tempus in sollicitudin lorem vulputate. Donec nibh urna, scelerisque ut feugiat sit amet, varius a felis. Donec hendrerit condimentum felis sed iaculis. Quisque volutpat, justo ut mattis tincidunt, nulla dolor pharetra nulla, non tincidunt tellus leo dictum nulla. Integer at enim vitae metus ultrices suscipit. Curabitur fringilla tellus id metus tristique ut convallis metus tincidunt. Nullam id eros ut ipsum iaculis tincidunt et in erat.
        Etiam sed iaculis enim. Cras congue bibendum urna nec facilisis. Donec ultrices cursus congue. Suspendisse sed lectus ut nisi malesuada pellentesque ac a lorem. Maecenas eu ipsum arcu. Aliquam ultricies enim ac nulla pulvinar id porta lectus dictum. Fusce semper arcu at nisl blandit accumsan. Vivamus non turpis enim, eu tincidunt odio. Ut sodales molestie interdum. In hendrerit semper dui, eu accumsan odio placerat nec. Mauris ut interdum massa. Pellentesque venenatis, urna ut aliquet convallis, nibh neque faucibus elit, nec aliquet arcu tellus id dolor.
        In mollis erat sed mauris mattis adipiscing. In vitae eros ac augue pulvinar ultricies in et ligula. Nulla vitae nisi nisi, at bibendum justo. Mauris pharetra vulputate sollicitudin. In et nisl mi. Sed eu vehicula massa. Morbi vehicula leo quis velit venenatis luctus. Phasellus rutrum mauris quis nisl fringilla pulvinar. Donec dui ipsum, blandit quis interdum consequat, luctus quis lacus. Nunc ac libero eget velit facilisis tincidunt at ut eros.
        Mauris a dolor et augue interdum sodales. Ut nisl nibh, posuere luctus gravida ac, tristique vitae dolor. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Morbi nibh quam, fermentum id vestibulum id, suscipit quis ipsum. Duis accumsan, dolor in tempor dictum, justo felis pharetra felis, a vehicula orci felis quis orci. Proin auctor dignissim mauris, quis fringilla metus sollicitudin id. Duis aliquam nisl ut tellus ultrices varius.
        Nullam ut dui ut velit vestibulum gravida non nec lectus. Cras id lectus sit amet enim condimentum mattis. Donec eu sagittis dolor. Nam lobortis justo id lorem feugiat a cursus urna scelerisque. Aliquam facilisis ultricies leo non hendrerit. Proin magna diam, mattis vulputate mattis in, gravida vitae elit. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae;<div class="snap_nopreview sharing robots-nocontent"><ul><li class="sharing_label">Compartilhar isto:</li><li class="share-email share-regular"><a rel="nofollow" class="share-email share-icon" href="http://vitorgusmao.com.br/historia-da-cidade-de-sorocaba/?share=email" title="Click to email this to a friend">Email</a></li><li class="share-facebook share-regular"><a rel="nofollow" class="share-facebook share-icon" href="http://vitorgusmao.com.br/historia-da-cidade-de-sorocaba/?share=facebook" title="Share on Facebook">Facebook</a></li><li class="share-twitter share-regular"><div class="twitter_button"><iframe allowtransparency="true" frameborder="0" scrolling="no" src="http://platform.twitter.com/widgets/tweet_button.html?url=http%3A%2F%2Fvitorgusmao.com.br%2Fhistoria-da-cidade-de-sorocaba%2F&amp;counturl=http%3A%2F%2Fvitorgusmao.com.br%2Fhistoria-da-cidade-de-sorocaba%2F&amp;count=horizontal&amp;text=Hist%C3%B3ria%20da%20cidade%20de%20Sorocaba: " style="width:97px; height:20px;"></iframe></div></li><li class="share-google-plus-1 share-regular"><div class="googleplus1_button"><div class="g-plusone" data-size="medium" data-callback="sharing_plusone" data-href="http://vitorgusmao.com.br/historia-da-cidade-de-sorocaba/"></div></div></li><li class="share-custom"><a href="#" class="sharing-anchor">Share</a></li><li class="share-end"></li></ul><div class="sharing-hidden"><div class="inner" style="display: none;"><ul><li class="share-linkedin"><script type="text/javascript" src="http://platform.linkedin.com/in.js"></script><div class="linkedin_button"><script type="in/share" data-url="http://vitorgusmao.com.br/historia-da-cidade-de-sorocaba/" data-counter="right"></script></div></li><li class="share-digg"><a rel="nofollow" class="share-digg share-icon" href="http://vitorgusmao.com.br/historia-da-cidade-de-sorocaba/?share=digg" title="Click to Digg this post">Digg</a></li><li class="share-end"></li><li class="share-reddit"><a rel="nofollow" class="share-reddit share-icon" href="http://vitorgusmao.com.br/historia-da-cidade-de-sorocaba/?share=reddit" title="Click to share on Reddit">Reddit</a></li><li class="share-stumbleupon"><a rel="nofollow" class="share-stumbleupon share-icon" href="http://vitorgusmao.com.br/historia-da-cidade-de-sorocaba/?share=stumbleupon" title="Click to share on StumbleUpon">StumbleUpon</a></li><li class="share-end"></li><li class="share-end"></li></ul></div></div><div class="sharing-clear"></div></div>
     </div>
</div> 
```

CSS代码在[这里](http://pastebin.com/whFii0dd)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:29:23.833

你是说你把主题切换到 211 就解决了这个问题吗？在这种情况下，您的主题中必须有一个禁用 Wordpress 换行符的功能。

在主题的functions.php中查看这个

```
remove_filter ('the_content',  'wpautop'); 
```

# c# - 不知道为什么 C# PowerShell Runspace 不规则关闭

> ID：11564774
> 
> 赞同：2
> 
> 时间：2012-07-19T16:00:43.730
> 
> 标签：c#, asp.net-mvc-3, powershell, office365

我有一个 MVC Web 应用程序，它显示了我们 AD 中用户的一些信息。AD 与 Office 365 同步，因此使用 UPN，我可以使用适用于 Office 365 的[Windows PowerShell cmdlet](http://onlinehelp.microsoft.com/en-us/office365-enterprises/hh125002.aspx)从 Office 365 检索许可证信息。基本上这一切都很好。

由于初始化 cmdlet`Connect-MsolService`需要一些时间才能完成，因此我正在为我的`Office365Connector`班级使用一种单例模式。在我`Global.asax`的 in`Application_Start()`我初始化单例实例，在`Application_End()`我处置它。连接器类只使用了我的类的一个实例`PowerShellInvoker`——顾名思义——封装了 PowerShell 调用。构造函数中的 PowerShell 初始化代码`PowerShellInvoker`如下所示：

```
public PowerShellInvoker(params string[] modules)
{
    var iss = InitialSessionState.CreateDefault();
    iss.ImportPSModule(modules);
    iss.ThrowOnRunspaceOpenError = true;

    _runspace = RunspaceFactory.CreateRunspace(iss);
    _runspace.Open();
    _invoker = new RunspaceInvoke(_runspace);
} 
```

该类使用as 参数`Office365Connector`调用此构造函数。`"MSOnline"`该`MSOnline`模块包含 Office 365 的 cmdlet。我保留`_runspace`和`_invoker`字段以供以后执行命令。这两个字段都将在 的`Dispose`方法中进行处理`PowerShellInvoker`（在处理类时调用该方法`Office365Connector`）。脚本执行由这行代码完成：

```
_invoker.Invoke(scriptText); 
```

介绍就这么多——现在真正的问题来了：

在我的应用程序中，我有一个用户列表。当我单击用户时，会使用 AJAX 请求加载附加信息。在此请求中，我的应用程序使用`Office365Connector`类的单例实例来检索用户的许可证信息。在大多数情况下，这一切都很完美。但有时 AJAX 请求以代码 500 结束。调试我的源代码时，我偶然发现在`PowerShellInvoker`在上面的“调用”行上，告诉我运行空间不再打开，我不知道为什么。我什至无法真正复制它。有时，当我单击第二个用户时会发生错误。有时，错误发生在第 10 位或第 15 位用户身上。我已经想过 MVC 使用的一些奇怪的清理、超时或垃圾收集技术，但我还没有得出结论。恕我直言，运行空间关闭不能基于时间，因为“用户点击”之间的时间只有几秒钟。

该`Connect-MsolService`cmdlet 创建与 Office 365 的连接，但不返回任何内容。因此，如果需要重新创建运行空间不是一种解决方法，因为这将由`PowerShellInvoker`班级完成，并且`Office365Connector`不知道它必须重新连接到 Office 365。（这也*不能解决*问题。）将两者结合起来classes 也不是解决方案，因为在`PowerShellInvoker`其他地方也使用了。

那么谁能告诉我如何防止运行空间关闭或为什么它被关闭？

***编辑：***更多代码

完整的`PowerShellInvoker`课程可以在[这里](http://pastebin.com/Gqd9nMw1)找到。

在`Office365Connector`课堂上，目前有很多开销。以下是一些片段：

**构造函数中的初始化：**

```
var cred = new PSCredential(adminUpn, adminPassword);

_psi = new PowerShellInvoker("MSOnline");
_psi.ExecuteCommand("Connect-MsolService", new { Credential = cred }); 
```

**检索 UPN 许可证的方法：**

```
public IEnumerable<string> GetUserLicenses(string upn)
{
    PSObject[] licenses = _psi.ExecuteScript(string.Format("(Get-MsolUser -UserPrincipalName \"{0}\").Licenses | % {{ $_.AccountSkuId }}", upn)).ToArray();

    // no licenses: a list with one element (which is null) is returned.
    if (licenses.Length == 1 && licenses[0] == null)
    {
        licenses = new PSObject[0];
    }

    return licenses.Select(pso => pso.ToString()).ToList();
} 
```

如您所见，我`ToList`在方法返回值中添加了一些 s（尤其是在 中`PowerShellInvoker`）。我这样做是因为我想防止可枚举的延迟执行，因为我认为这可能是关闭运行空间的原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-15T09:53:48.697

好吧，这是我自己犯的一个愚蠢的错误——虽然我真的不明白 MVC 为什么要这样做：

在我解决问题的众多尝试之一中，我将我的处理代码移到了应用程序`Office365Connector`的`Dispose`方法中（在 中`Global.asax.cs`）。在那之后，我显然修复了原始错误，但由于处置的东西，它没有解决。显然，应用程序实例的处置频率比“结束”的频率高。当我将代码移回`Application_End()`它所属的位置时，一切正常。

这使我原来的问题有点无效，因为我写我的处置代码已经在`Application_End()`. :-\

# r - 超过 R 中的内存限制（即使使用 24GB RAM）

> ID：11564775
> 
> 赞同：18
> 
> 时间：2012-07-19T16:00:44.480
> 
> 标签：r, memory, memory-management, dataframe

我正在尝试合并两个数据框：一个有 33 个变量的 908450 个观察值，另一个有 2 个变量的 908450 个观察值。

```
dataframe2 <-merge(dataframe1, dataframe2, by="id") 
```

我已经从工作内存中清除了所有其他数据帧，并使用以下代码重置了我的内存限制（对于具有 24 GB RAM 的全新桌面）：

```
memory.limit(24576) 
```

但是，我仍然收到错误消息`Cannot allocate vector of size 173.Mb`。

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-07-19T16:15:17.293

要跟进我的评论，请使用`data.table`. 我整理了一个与您的数据相匹配的快速示例来说明：

```
library(data.table)

dt1 <- data.table(id = 1:908450, matrix(rnorm(908450*32), ncol = 32))
dt2 <- data.table(id = 1:908450, rnorm(908450))
#set keys
setkey(dt1, id)
setkey(dt2, id)
#check dims
> dim(dt1)
[1] 908450     33
> dim(dt2)
[1] 908450      2
#merge together and check system time:
> system.time(dt3 <- dt1[dt2])
   user  system elapsed 
   0.43    0.03    0.47 
```

所以合并在一起用了不到 1/2 秒的时间。我拍了一张前后截图，看着我的记忆。在合并之前，我使用的是 3.4 gigs 的 ram。当我合并在一起时，它跃升至 3.7 并趋于平稳。我认为您将很难找到比这更节省内存或时间的东西。

前： ![在此处输入图像描述](../Images/ca116096352f6c062a1e9da6e53bfa60.png)

后：![在此处输入图像描述](../Images/40a6541e4ef24f71e91a4c3f8791163c.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T16:03:41.243

据我所知，解决方案有以下三种：

*   使用数据表
*   使用交换内存（可以在 *nix 机器上调整）
*   使用抽样

# bash - Bash：读取文件时丢失特殊字符

> ID：11564778
> 
> 赞同：20
> 
> 时间：2012-07-19T16:00:56.880
> 
> 标签：bash, escaping

我有一个包含一些 Latex 的文件：

```
\begin{figure}[ht]
 \centering
 \includegraphics[scale=0.15]{logo.pdf}
 \caption{Example of a pdf file inclusion}
 \label{fig:pdfexample}
\end{figure} 
```

我想在 bash 脚本中阅读它：

```
while read line
  do
    echo $line
  done < "my.tex" 
```

输出是

```
begin{figure}[ht]
centering
includegraphics[scale=0.15]{logo.pdf}
caption{Example of a pdf file inclusion}
label{fig:pdfexample} 
```

为什么我丢失了反斜杠和初始空格？

如何保存它们？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-07-19T16:12:18.463

您丢失了反斜杠和空格，因为 bash（通过其 read 内置函数）正在评估文本的值 - 替换变量，寻找转义字符（制表符，换行符）等。有关详细信息，请参阅[手册页](http://linux.die.net/man/1/bash)。此外， echo 将结合空格。

至于保存它们，我不确定你能做到。您可能会通过执行以下操作来获得反斜杠：

```
while read -r line
  do
    echo $line
  done < "my.tex" 
```

这应该修改 read 以不尝试评估反斜杠。不过，它可能仍会吞噬领先的空间。

编辑：将`$IFS`特殊变量设置为空字符串，如下所示：

```
export IFS= 
```

在这种情况下将导致保留空间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T16:19:08.837

您可以`perl`用于部分或全部脚本要求吗？

```
perl -lne 'print;' my.tex 
```

如果您以后必须使用其他工具进行脱壳，您可能仍然会遇到问题，除非您可以在文件中传递所需的数据。

# powershell - 保持 IE 打开

> ID：11564781
> 
> 赞同：0
> 
> 时间：2012-07-19T16:01:04.353
> 
> 标签：powershell, internet-explorer-8

我想创建一个 Powershell 脚本，每次关闭时都会重新打开 IE。

```
Do {
$ie = New-Object -Com InternetExplorer.Application
$ie.Navigate(www.google.com)
$ie.Visible = $true
   }
While (?) 
```

我计划使用 Start-Sleep 让应用程序有时间完全打开，这样它就不会像疯了一样继续产生进程，但我无法找出哪些值链接来确定窗口是否已关闭。也许我正在处理这个错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T16:14:15.323

`for(){Start iexplore www.stackoverflow.com -wait}`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-21T02:27:30.110

我以前为此使用过windows perfmon。您使用 Perfmon 警报来检查正在运行的实例计数，如果它们低于 1，则启动一个。

这是很多年前的事了，我最近没用过。

# iphone - 收到错误 objc_retainAutoreleasedReturnValue

> ID：11564784
> 
> 赞同：0
> 
> 时间：2012-07-19T16:01:11.757
> 
> 标签：iphone, xcode, exc-bad-access

我正在修复我今天的代码中的一些泄漏，因此在我的设备上运行我的代码时我收到了这个错误（模拟器工作正常）。我附上了一张图片来显示我的错误。

我认为我的代码与它无关，因为在模拟器上它工作正常。我试图查找它，但没有发现任何对我有用的东西。我知道这与我正在使用的 ARC 有关。

任何帮助将不胜感激

![在此处输入图像描述](../Images/6f4fb432ba1cc5f18d712d1e3431bd98.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T16:37:18.040

`obj_retain`您已经发布了该函数的汇编代码转储。断点处理程序指示它正在尝试从无效的内存地址加载值。

根据有用的命名`objc_retainAutoreleasedReturnValue`，似乎一个声称返回 Objective-C 对象的函数/方法实际上正在返回一个垃圾值（无效指针），并且运行时在尝试保留它时崩溃。

很奇怪，主线程堆栈只有两层深。

你有开启优化吗？通常它们在调试模式下关闭，在发布模式下打开。在忘记初始化指针变量之前，我遇到过错误；在调试模式下它默认为 0，所以代码工作正常，但在发布模式下它会得到一个垃圾值并导致崩溃。

这就是我所能说的，你的截图中没有太多有用的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-06T19:53:40.753

在调试器中查看崩溃时其他线程正在做什么。您可能正在使用已经或已经在主线程上释放的后台线程上的对象。如果崩溃发生时另一个线程正在做某事，那么这很可能是原因。

我也发生了完全相同的错误，这就是我的原因。

我仍然不清楚为什么错误出现在主线程上，而不是在后台线程上，以及为什么它只在主线程堆栈上显示两个条目。可能 ARC 在主线程 runloop 调用之间做一些内存清理工作。我可以想象它不喜欢被释放的内存被另一个线程覆盖。

# php - 复制元素为正的 PHP 数组

> ID：11564786
> 
> 赞同：1
> 
> 时间：2012-07-19T16:01:27.070
> 
> 标签：php, arrays

试图将一个包含正数和负数组合的数组转移到一个新数组 - 但仅限于元素为正数的地方。

这是我到目前为止所拥有的：

```
$param = array(2, 3, 4, -2, -3, -5);

function positive_function($arr) {
    foreach ($arr as &$value) {
        if($value > 0)
            return $value;
    }
}

$modParam1 = positive_function($param);

var_dump($modParam1); 
```

我认为我的 foreach 语句有问题，这里有什么明智的建议吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-19T16:03:52.800

尝试：

```
$param = array(2, 3, 4, -2, -3, -5);

$positive = array_filter($param, function ($v) {
  return $v > 0;
});

print_r($positive); 
```

[http://codepad.viper-7.com/eKj7pF](http://codepad.viper-7.com/eKj7pF)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T16:10:48.400

您正在寻找的是阵列上的过滤器（[http://www.php.net/manual/en/function.array-filter.php](http://www.php.net/manual/en/function.array-filter.php)）

这将删除数组中不能满足您需求的值。一个基本的例子是：

```
function is_positive($number) {
  return is_numeric($number) && $number >= 0;
}

$values = array(1, 5, -4, 2, -1);
$result = array_filter($values, 'is_positive');
print_r($result); 
```

-- 为什么你的函数不起作用：

您正在返回一个值。在函数内部，返回将停止，因为找到了答案。因此返回它在数组中找到的第一个正数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T16:03:54.777

您的函数刚刚返回第一个正值。

`foreach`在循环遍历*所有*值之后，您必须创建一个新数组来保存所有正值并返回该数组。

```
function positive_function($arr) {
    $result = array();

    foreach ($arr as &$value) {
        if($value > 0) {
          $result[] = value;
        }
    }

    return $result;
} 
```

另一种选择是应用@Yoshi 所示的映射功能。这取决于您是需要保留旧数组还是只想通过删除所有非正值来修改它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T16:06:24.830

```
$param = array(-1,2-,3,1,2,4,-1337);
function positive_function($arr)
{
    $temp = array();
    foreach ($arr as &$value) 
    {
        if($value > 0)
        {
            $temp[] = $value
        }
    }
       return $temp;
} 
```

# jquery - Prepend 不会在 img 标签中添加 HTML

> ID：11564788
> 
> 赞同：0
> 
> 时间：2012-07-19T16:01:28.077
> 
> 标签：jquery, html, forms

这是我的jQuery代码....

```
$("#addinp").click(function() {
    $(this).prepend('<label>Item ' + i + '<span class="small"></label><input type="text" name="middlename[]" />');
}); 
```

这是我的html....

```
<form id="form" name="form" method="post" action="?a=run">
<input type="text" name="firstname" id="firstname" />
<input type="text" name="lastname" id="lastname" />
<input type="text" name="middlename[]" id="middlename[]" />
<img src="add_another_name.png"  id="addinp"/>
<button type="submit">Add</button>
 </form> 
```

这不会在“添加另一个按钮”之前出现另一个输入 - 烦人的是如果我这样做......

```
 $('form').prepend('<lab........ 
```

将它添加到它将起作用的形式......但它不会出现在图像之前......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T16:04:30.820

而不是`prepend()`，尝试[`before()`](http://api.jquery.com/before/)如下，使用有效的 HTML。

`prepend()`在这里不起作用，因为它将传递的元素作为它的子元素插入到目标的开头。

```
$("#addinp").click(function() {
    $(this)
     .before('<label>Item '+i+'<span class="small"></span></label><input type="text" name="middlename[]" />');
}); 
```

您还可以使用[`.insertBefore()`](http://api.jquery.com/insertBefore/)：

```
$("#addinp").click(function() {
   $('<label>Item '+i+'<span class="small"></span></label><input type="text" name="middlename[]" />').insertBefore(this);
}); 
```

***不要忘记更正上面的 HTML。***

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T16:05:37.167

从[手册](http://api.jquery.com/prepend/)：

> .prepend() 方法将指定的内容作为 jQuery 集合中每个元素的第一个子元素插入

您不能将内容作为图像的第一个子项插入，因为该图像不能有子项。

您想[`before()`](http://api.jquery.com/before/)在图像之前插入内容。

# playframework - 播放 Morphia，无法获取（通用）嵌入对象的列表内容

> ID：11564803
> 
> 赞同：0
> 
> 时间：2012-07-19T16:02:37.637
> 
> 标签：playframework, morphia, playframework-1.x

我正在使用 Play Framework 1.2.5 和 morphia-1.2.9a 模块。我最初在我的模型上使用@Reference 注释，但由于 (lazy=true) 不适用于@Reference，我需要使用 ObjectIds 进行切换。为了减少返工和冗余，我创建了以下 MorphiaList：

```
package models.morphia;

import java.util.ArrayList;
import java.util.Collection;
import java.util.Collections;
import java.util.Iterator;
import java.util.List;

import models.Team;

import org.bson.types.ObjectId;

import com.google.code.morphia.annotations.Embedded;
import com.google.code.morphia.annotations.Transient;

import play.modules.morphia.Model;
@Embedded
public class MorphiaList<T extends MorphiaModel> implements Iterable<T>{
    @Embedded("ids") private List<ObjectId> modelIds;
    @Transient List<T> models;
    public void sort()
    {
        this.getAll();
        Collections.sort(models);
        this.modelIds.clear();
        for(T t:this.models){
            this.modelIds.add((ObjectId)t.getId());
        }
    }
    public MorphiaList()
    {
        this.models = new ArrayList<T>();
        this.modelIds = new ArrayList<ObjectId>();
    }
    public int size()
    {
        System.out.println(modelIds.size());
        return modelIds.size();
    }
    public boolean add(T model)
    {
        return (this.models.add(model) && this.modelIds.add((ObjectId) model.getId()));
    }
    public boolean remove(T model)
    {
        return (this.models.remove(model)&&this.modelIds.remove((ObjectId) model.getId()));
    }
    public boolean addAll(Collection<? extends T> models)
    {
        for(T model: models)
        {
            this.models.add(model);
            this.modelIds.add((ObjectId) model.getId());
        }
        return false;
    }
    public List<T> getAll()
    {
        for(ObjectId oi: this.modelIds)
        {
            boolean found=false;
            for(T model: models)
            {
                if(oi==model.getId())
                {
                    found=true;
                    break;
                }
            }
            if(!found)
                models.add(T.<T>findById(oi));
        }
        return models;
    }
    public T get(int index)
    {
        ObjectId id = modelIds.get(index);
        for(T model: models)
        {
            if(id == model.getId())
                return model;
        }
        return T.<T>findById(id);
    }
    @Override
    public Iterator<T> iterator() {
        return this.getModelIterator();
    }
    public Iterator<T> getModelIterator() {
        for(ObjectId oi: modelIds)
        {
            boolean found=false;
            for(T model: models)
            {
                if(oi==model.getId())
                {
                    found=true;
                    break;
                }
            }
            if(!found)
                models.add(T.<T>findById(oi));
        }
        return models.iterator();
    }
    public boolean isEmpty() {
        return this.modelIds.isEmpty();
    }
    public boolean contains(T t) {
        return this.modelIds.contains(t.getId());
    }
} 
```

MorphiaModel 很简单，我只需要它来实现 Comparable 以便我可以对列表进行排序：

```
package models.morphia;
import play.modules.morphia.Model;
public abstract class MorphiaModel<T extends MorphiaModel<T>> extends Model implements Comparable<T>{
} 
```

然后我在课堂上这样使用它：

```
@Entity
public class Organization extends Purchasable { 
@Embedded public MorphiaList<Season> seasons = new MorphiaList<Season>(); 
```

一旦我添加了一个季节，mongo 就会显示预期的：

```
{ 
 "_id" : { "$oid" : "50097c147aa33c43fa8136ee"} ,
 ...other members...
 "seasons" : { "ids" : [ { "$oid" : "50097c147aa33c43fa8136ed"}]} ,
 ...other members...
} 
```

但是，当我去抓取 seasons 对象时，modelIds 是空的！我不知道为什么它不能从 BSON 那里抢到季节，它显然就在那里。任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-25T19:31:30.287

由于多种原因，我无法让它工作：

1.  一旦持久化到 mongoDB 以加载回对象，我就无法获取数据，该对象将始终为空。
2.  在问题 #1 之后，我添加了一个私人列表，该列表将在查找时填充我的 MorphiaList 以绕过它。但是在将 id 放入 MorphiaList 之后，我无法弄清楚如何查找特定的集合。尤其是当您考虑我使用继承时，所以我有一些异构集合。

我的解决方案：对于每个参考列表，我都重写了：

```
@Reference public List<Season> seasons; 
```

对此：

```
@Transient public List<Season> seasons;
private List<ObjectId> _seasons = new ArrayList();
@Transient private List<Season> pSeasons;
public List<Season> getSeasons()
{
    if(pSeasons==null)
    {
        if(_seasons.size()!=0)
            pSeasons = Season.find().<Season>field("_id").in(_seasons).asList();
        else
            pSeasons = new ArrayList();
    }
    return pSeasons;
} 
```

我还必须添加一个**@PrePersist**方法来检查列表访问：

```
@PrePersist void beforeSave()
{
    if(pSeasons!=null)
    {
        _seasons.clear();
        for(Season s: pSeasons)
        {
            _seasons.add((ObjectId)s.getId());
        }
    }
} 
```

这个**beforeSave()**将不得不为您在代码中拥有的每个额外的引用列表进行扩展。故事的道德启示：

*如果您使用 Play 的 morphia 模块，请不要使用 @Reference 表示法。*

# c - 使用 sscanf() 从同一行读取多个参数

> ID：11564804
> 
> 赞同：0
> 
> 时间：2012-07-19T16:02:38.567
> 
> 标签：c, linux, scanf

我在 C 中修改了一些代码。我使用 mingw 和 gnu gcc 编译器和 Codeblocks 作为 IDE。代码在此编译并运行良好。但是，当我尝试在远程 linux 服务器或实际上任何 linux 系统中运行代码时，它不会。它可以编译，但执行是问题。我给出了我认为相关的部分代码：

```
short ReadNumRuns(FILE* File_Ptr)
{
  char buf[STRLEN];
  short n=0;

  FindDataLine(File_Ptr); /* skip file version. */

  strcpy(buf, FindDataLine(File_Ptr));
  if(buf[0]=='\0') nrerror("Reading number of runs\n");
  sscanf(buf, "%hd",&n);
  printf("%s", buf);
   printf("Number of runs: %hd ", n);
  return(n);
}

void ReadFnameFormat(FILE *File_Ptr, InputStruct *In_Ptr)
{
  char buf[STRLEN];

  /** read in file name and format. **/
  strcpy(buf, FindDataLine(File_Ptr));
  printf("%s", buf);
  if(buf[0]=='\0')
    nrerror("Reading file name and format.\n");
  sscanf(buf, "%s %c",In_Ptr->out_fname, &(In_Ptr->out_fformat) );
  printf("%s", In_Ptr->out_fname);
  printf("%c", In_Ptr->out_fformat);
  if(toupper(In_Ptr->out_fformat) != 'B')
    In_Ptr->out_fformat = 'A';
 } 
```

这两个函数是读取运行次数和输出文件名。第一个功能有效，但第二个无效。从这里开始，进一步的输入功能似乎跳过了行。我猜是因为 sscanf 从这个函数的同一行读取两个参数。linux gcc 和 gnu gcc 编译器中的 sscanf 有什么区别吗？提前致谢。

如果您想查看完整代码，请访问[http://omlc.ogi.edu/software/mc/](http://omlc.ogi.edu/software/mc/)和 MCML 部分。

# javascript - 根据选择选项启用/禁用其他输入

> ID：11564807
> 
> 赞同：0
> 
> 时间：2012-07-19T16:02:44.537
> 
> 标签：javascript, jquery, html

我的 HTML

```
<fieldset>
    <label for="tipoPre">Tipo de premio</label>
    <select id="tipoPre"><option value="Devolución de consumo">Devolución de consumo</option>
    <option value="Devolución de consumo de premio acumulado">Devolución de consumo de premio acumulado</option>
    <option value="Entrega individual">Entrega individual</option>
    <option value="Premio monetario">Premio monetario</option>
    </select>
    <label for="monDev">Monto devolucion</label>
    <select id="monDev">
    <option value="Monto acumulado">Monto acumulado</option>
    <option value="Monto del cupón">Monto del cupón</option>
    </select>
    <label for="numGanadores">Numero de ganadores</label>
    <input type="text" class="text ui-widget-content ui-corner-all" id="numGanadores" name="numGanadores">
    <label for="numSuplentes">Numero de suplentes</label>
    <input type="text" class="text ui-widget-content ui-corner-all" id="numSuplentes" name="numSuplentes">
    <label for="monMin">Monto minimo</label>
    <input type="text" class="text ui-widget-content ui-corner-all" id="monMin" name="monMin">
    <label for="monMax">Monto maximo</label>
    <input type="text" class="text ui-widget-content ui-corner-all" id="monMax" name="monMax">
    <label for="monPre">Monto premio</label>
    <input type="text" class="text ui-widget-content ui-corner-all" id="monPre" name="monPre">
    <label for="acumulado">Acumulado a repartir</label>
    <input type="text" class="text ui-widget-content ui-corner-all" id="acumulado" name="acumulado">
</fieldset> 
```

我的jQuery函数：

```
function validateFieldsOnChange() {
    $("#monDev").prop('selectedIndex', -1);
    $("#tipoPre").prop('selectedIndex', -1);

    $("#tipoPre").change(function () {
        switch ($('#tipoPre option:selected').attr('value')) {
            case 'Entrega individual':

                $("#monDev, #monMin, #monMax, #monPre, #acumulado").attr('disabled', 'disabled');
                break;
            case 'Premio monetario':

                $("#monDev, #monMin, #monMax, #acumulado").attr('disabled', 'disabled');
                break;
            case 'Devolución de consumo':

                $("#monPre, #acumulado").attr('disabled', 'disabled');
                break;
            case 'Devolución de consumo de premio acumulado':

                $("#monPre, #numGanadores").attr('disabled', 'disabled');
                break;
            default:

                break;
        }
    });

} 
```

当我在新表单中使用该代码（添加新记录）时工作正常，但是当我加载它以编辑现有记录时它不起作用，因为应该启用/禁用的字段未启用或禁用

**编辑：**问题不是检索要编辑的数据，当我检索数据时，如果 $(#tipoPre).val() = 'Entrega individual' 字段 #monDev、#monMin、#monMax、# monPre, #acumulado 应该**禁用**，**其余**启用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:12:24.270

更改事件将被注册，`document.ready`而不是`validateFieldsOnChange`在更改时产生所需的结果`select`

```
$(function(){

function validateFieldsOnChange() {
    $("#monDev").prop('selectedIndex', -1);
    $("#tipoPre").prop('selectedIndex', -1);
});

$("#tipoPre").change(function () {
    switch ($('#tipoPre option:selected').attr('value')) {
        case 'Entrega individual':
            resetValues();
            $("#monDev, #monMin, #monMax, #monPre, #acumulado").attr('disabled', 'disabled');
            break;
        case 'Premio monetario':
            resetValues();
            $("#monDev, #monMin, #monMax, #acumulado").attr('disabled', 'disabled');
            break;
        case 'Devolución de consumo':
            resetValues();
            $("#monPre, #acumulado").attr('disabled', 'disabled');
            break;
        case 'Devolución de consumo de premio acumulado':
            resetValues();
            $("#monPre, #numGanadores").attr('disabled', 'disabled');
            break;
        default:

            break;
    });
   $("#sorPorFecha").click(function() {
    (typeof $("#sorPorFecha").attr('checked') != 'undefined') ?         $('#unicoPorFecha').removeAttr('disabled') : $('#unicoPorFecha').attr('disabled', 'disabled');
       $('#unicoPorFecha').prop('checked', false);
    });

  }); 
```

# android - Android Play 商店 - 阻止我的应用程序自动更新

> ID：11564813
> 
> 赞同：1
> 
> 时间：2012-07-19T16:03:20.900
> 
> 标签：android, google-play

我在 Android Play Store 上有一个应用程序。我还有一个基于 Windows 的应用程序（服务）。我的用户在他们的 PC 上安装该服务，并在他们的移动设备上安装 Android 应用程序。这些来回发送数据。

我有两个应用程序的更新。如果我只更新一个，它将不起作用。

我的首选方法 - 这可能吗？： - 将新的 APK 上传到市场 - 以某种方式将其标记为关闭自动更新 - 当用户点击安装时，我想要一个巨大的警告“需要 XXXXXXX”，告诉他们更新他们的Windows 服务也是如此。

有没有其他人遇到过这个？你有没有像我想做的那样做？如果没有，你是怎么做的？

我想我可以重命名移动应用程序并告诉用户在安装较新的 Windows 服务期间安装它。但这也会将旧应用程序留在那里，我喜欢更新它的想法；没有安装两个。

所以问题是——这是否可能，如果没有，有什么更好的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T16:06:19.310

我认为不可能阻止更新通知。

您可以选择的一种选择是让 PC 端将其版本传达给 Android 端，并在您的 Android 应用程序内部将其构建为向后兼容，这样如果更新的应用程序发现 PC 客户端是旧的，它将继续使用旧方法用于与 PC 交互。

只有当它看到 PC 客户端也已更新时，它才会开始使用新的交互。

这还允许您通知用户他们的 PC 应用程序版本已过时，并且应该更新它以充分利用 Android 应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T16:10:32.307

您提到的方法似乎不可能。

**备用工作流程：**

*   我见过这个应用程序[Unified Remote](https://play.google.com/store/apps/details?id=com.Relmtech.Remote&hl=en)，它的要求与您的相似。当应用程序第一次打开时，它只是敦促用户在他们的 PC 上安装服务器软件。

*   我认为这是一个优雅的解决方案，而不是**在 ALLCAPS 或粗体中显示警告**，这无助于提供非常好的用户体验。

*   如果用户尝试连接到旧版本的 PC 应用程序，使用新版本的 Android 应用程序，您可以发出一个友好的错误提示用户更新桌面应用程序。

**截屏**

![截屏](../Images/21d9496c784fdd2905cc4a0626fc0d37.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T16:16:15.900

听起来这只会解决问题的症状，而不是问题本身。当更新不同步时，为什么您的应用程序会中断？您要求用户进行大量参与，以使两者始终保持最新状态。

理想情况下，您的网络通信，我假设这是问题所在，应该是向后兼容的。如果您查看诸如 ProtoBuf 之类的协议库，您会发现为了确保应用程序的不同版本能够成功通信，已经考虑了很多。此路线将允许您的应用程序与版本不同步，并允许每个应用程序识别哪个应用程序不同步并相应地通知用户应更新所述软件的新版本以使所有功能正常工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T16:13:01.713

您是使用 Visual Basic 创建 Windows 服务，还是基于 Java（使用不同的 IDE）？无论哪种方式，您都应该能够单独更新它们而不会破坏它们的关系。但是如果它们都需要更新，我相信 Visual Basic 有一种方法可以导出您的应用程序，以便它自动检查特定 URL 处的更新。当您将 APK 上传到市场时，将更新的 windows 项目上传到您指定的位置。然后，Windows 服务应检测到更新并提示用户下载和安装。到目前为止，我还没有遇到点击安装按钮时弹出“大量警告”的应用程序。我猜你需要把它放在全部大写的应用程序描述中。

# perforce - Perforce 在 Stream Depot 中创建新文件夹

> ID：11564814
> 
> 赞同：3
> 
> 时间：2012-07-19T16:03:30.757
> 
> 标签：perforce, perforce-stream

我有一个 Stream Depot - depot

我在我创建的那个仓库中有一个名为 ProductGizmo 的流

所以在 P4V 中，我看到 Gizmo 位于仓库下 - 即仓库/ProductGizmo

我现在想让 ProductGizmo 存在于一个名为 ClientAcme 的文件夹下——这样我就想看到 depot/ClientAcme/ProductGizmo。这严格用于仓库的组织。ClientAcme 不是流。

但是当我去 File > New > Folder - 文件夹是灰色的。

文件夹在 Stream Depot 中没有意义吗？

如何在流库中移动/组织流

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T22:03:57.417

流植根于库层次结构中的 2 级深度。流将具有类似“//depotname/streamname”的根。

创建流根后，您将无法更改它。浅根深度旨在阻止您将流的根路径用作任何类型的智能标签。（问题在于，如果您可以使用仓库路径对流进行分类，那么当流的分类发生变化时，您总是不得不对文件进行分支，这会给您留下复杂的分支历史。）

如果需要实现流命名方案，可以使用流名称字段，例如：

```
Stream:  //depot/ProductGizmo
Name:    ClientAcme-ProductGizmo 
```

流名称*可以*更改。名称显示在 P4V 中，您可以按名称搜索。例如：

```
p4 streams -F "Name=*Acme-*" 
```

但是，您不能在命令中使用该名称来替代软件仓库路径。

您还可以使用命名方案重载流根中的第二条路径。例如：

```
//depot/ClientAcme-ProductGizmo 
```

这很像使用更深的 depot 路径，因为它无法更改，您可以在命令中使用它，例如：

```
p4 changes -m1 //depot/ClientAcme-... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T22:05:22.113

因此，根据我所阅读和听到的 - 这是不可能的 - 呃！

这是关于 perforce 论坛的更多讨论的链接

[http://forums.perforce.com/index.php?/topic/1191-streams-naming-structure-different-levels/](http://forums.perforce.com/index.php?/topic/1191-streams-naming-structure-different-levels/)

# polymorphism - 服务合同中的基类 DTO 或派生类 DTO

> ID：11564817
> 
> 赞同：0
> 
> 时间：2012-07-19T16:03:34.450
> 
> 标签：polymorphism, derived-class, base-class

更好的方法是什么：在服务合同（接口）中使用派生类？还是使用不太具体的类（基类）？假设我有基类`RequestDto`，并且`ResponseDto`所有其他类都继承自其中之一。

让我的所有方法都接收或返回此对象是一种好习惯，然后我进行正确的转换，如下所示：

```
ResponseDto GetInfos(RequestDto resquestDto)
ResponseDto GetInfosById(RequestDto resquestDto) {
  return (ResponseDto)myResponseObject;
} 
```

然后我`ResponseDto`在调用这些方法时将其转换为我期望的正确派生类。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-24T15:12:37.937

您可以在这里查看：http: [//channel9.msdn.com/Blogs/Subscribe/DataContract-Coupling-in-Messaging](http://channel9.msdn.com/Blogs/Subscribe/DataContract-Coupling-in-Messaging)。这个播客是关于服务和服务消费者之间的数据耦合的。得出的结论是，在服务接口中使用多态类型是一件坏事，因为它在服务和它的消费者之间引入了非常紧密的耦合。希望能帮助到你。

# sql - Oracle SQL（触发器）

> ID：11564818
> 
> 赞同：0
> 
> 时间：2012-07-19T16:03:35.937
> 
> 标签：sql, oracle

```
CREATE OR REPLACE TRIGGER Guest_Change_In_WorkingHour
       BEFORE INSERT OR UPDATE OR DELETE ON guest
    BEGIN
       IF  TO_NUMBER(TO_CHAR(SYSDATE,'hh24')) < 8 -- cant do anything before 8:00am
           OR TO_NUMBER(TO_CHAR(SYSDATE,'hh24')) >= 5
              -- changes must be made BEFORE 5:00pm
            OR TO_CHAR(SYSDATE,'dy') in ('sun','sat') THEN -- nothing on weekends
    RAISE_APPLICATION_ERROR (-20000, 'Satff changes only allowed during business hours.');
    END IF;
   END;
   / 
```

此触发器在工作时间（上午 8 点到下午 5 点）可以执行插入、删除和更新数据。对于我的问题是，当时间是凌晨 4 点时，仍然可以插入、删除和更新数据。我发现这个触发器忽略了 AM 和 PM。怎么解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T16:14:31.127

您正在使用时间格式`HH24`，即 24 小时制（我相信在美国是“军用”时间）。因此，您需要这样做：

```
TO_NUMBER(TO_CHAR(SYSDATE,'hh24')) >= 17 
```

...而不是使用`5`.

但事实上，它应该随时引发错误，而不仅仅是在 08:00-17:00 范围之外（因为很少有数字同时 >= 8 和 < 5）。触发器是否真正编译？

此外，您还需要检查用于比较星期几的情况，因为我认为目前不匹配（更正 - 是的，使用`dy`）；但依靠 NLS 敏感值进行比较并不理想。

# maven - 通过命令行选项将子模块排除在 Maven 中执行

> ID：11564822
> 
> 赞同：3
> 
> 时间：2012-07-19T16:03:49.450
> 
> 标签：maven

我有一个有 5 个孩子的 Maven 项目，但是当我运行它时，我希望最后一个不被执行。我可以很容易地从 pom 文件中推荐它，但是我想知道，是否有一个命令行选项可以排除子模块的执行？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-19T16:32:04.870

我正在处理的当前项目中有此配置以排除某些模块。

在您声明模块的 pom 中，只需输入您每次要运行的模块列表：

```
<modules>
    <module>this-is</module>
    <module>always-needed</module>
</modules> 
```

然后，在同一个 pom 中添加一个配置文件部分并移动您不想每次运行的模块：

```
<profiles>
    <profile>
        <id>do-additional-module</id>
        <modules>
            <module>this-is-rarely-needed</module>
        </modules>
    </profile>
</profiles> 
```

现在，当您运行时`mvn package`，仅执行模块`this-is`和。`always-needed`当您指定配置文件时`mvn -P do-additional-module package`，反应器将运行以前的模块和`this-is-rarely-needed`。

M。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T16:29:15.697

**[您可以使用配置文件](http://maven.apache.org/guides/introduction/introduction-to-profiles.html)来实现这一点。** 父 pom.xml 中的 maven 配置文件可以包含其他子模块。

这是一个例子。激活后，此“*包含*”配置文件将包含第二个子模块。

```
<modules>
    <module>child-module-one</module>
</modules>
<profiles>
    <profile>
        <id>include</id>
        <modules>
            <module>child-module-two</module>
        </modules>
    </profile>
</profile> 
```

如果您在父级别触发 Maven 构建阶段（在此示例中编译），并激活此配置文件 - 例如

```
mvn compile -P include 
```

您将包括您的第二个子模块。如果您要避免激活该配置文件，例如只需运行：

```
mvn compile 
```

那么您的第二个子模块不包括在内。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T16:13:13.033

我认为当前的 Maven 实现没有任何这样的选择。

您可以尝试一件事：创建另一个只有前 4 个子项目的项目。因此，当您只需要构建 4 而不是 5 时，请使用那个。

您不必为此创建另一个父项目。有关这方面的更多信息，请参阅[Maven 项目的聚合。](http://maven.apache.org/pom.html#Aggregation)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-19T16:13:55.697

简单的答案没有这样的选择。

避免在发布等期间出现问题的最佳解决方案是使用配置文件，但不要在子模块本身中更好地使用模块级别：

在子模块中，使用配置文件来激活/停用所需的操作。

```
<profiles>
  <profile>
     <id>whatEver</id>
     <build>
      ...
     </build>
  </profile>
</profiles> 
```

# javascript - 具有奇怪圆角块的 SVG 路径

> ID：11564828
> 
> 赞同：2
> 
> 时间：2012-07-19T16:04:00.543
> 
> 标签：javascript, jquery, svg, highcharts

我是 SVG 的新手，所以这可能不是很奇怪，但是任何人都可以在这里帮助我解决 Highcharts 和 SVG 的问题。

我使用了一个在网上找到的 jsfiddle，并尝试对其进行自定义以适应我的使用。这是：http: [//jsfiddle.net/qs7FY/](http://jsfiddle.net/qs7FY/)

我面临的问题是在结果面板中看到的圆角线块。

有人可以帮我解决这个问题吗？

提前致谢！

在下面的屏幕截图中查看问题

在这里查看问题![在此处输入图像描述](../Images/d6ddd019c340fe61911a2b4be4aa5908.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T18:04:22.823

将此添加到代码的末尾

```
 $('svg path ').each(function(index,value) {
    var myd = $(this).attr('d') ; 
    var indexofc = myd.indexOf('C') ; 
    var indexofL = myd.indexOf('L') - 1 ; 
    if(indexofc != -1){
     var final = myd.slice(indexofc ,indexofL) ;
    }
    var end = myd.replace(final ,'') ; 
    $(this).attr('d',end) ;

   }); 
```

修复[jsFiddle后的图表](http://jsfiddle.net/minagabriel/qs7FY/9/)

*更新*

使您的线条弯曲的原因是添加`C = curveto`到您的线条中，因此如果我删除它们，它们将是直的，正如您在更新 jsfiddle 后所看到的那样 - > [http://jsfiddle.net/minagabriel/qs7FY/9/](http://jsfiddle.net/minagabriel/qs7FY/9/)

这就是你的一条路的样子`C`

```
 <path fill="none" d="M 102.29523731301347 84.2399490981872 
   C 107.29523731301347 
   84.2399490981872 113.95649598906613 88.67025753561153 123.11572666863853 
    94.76193163706998 L 132.27495734821093 100.85360573852843"
   stroke-width="1" 
   stroke="#004c67" visibility="visible" zIndex="3" transform="translate(10,40)">
       </path> 
```

所以我循环遍历你的`d`元素，取出所有之间的东西`C`，`L`并最终得到如下内容：

```
 <path fill="none" d="M 102.29523731301347 84.2399490981872 
   L 132.27495734821093 100.85360573852843"
   stroke-width="1" 
   stroke="#004c67" visibility="visible" zIndex="3" transform="translate(10,40)">
       </path> 
```

这应该采取曲线...请考虑查看 jsFiddle

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T08:57:14.967

这已在 svg-developers 邮件列表中进行了讨论，一些解决方案请参见[此处](http://tech.groups.yahoo.com/group/svg-developers/message/65666)。

圆顶线只是一个图案瓷砖问题。您可能会通过自己绘制图案拼贴然后尝试平铺它（切掉溢出图案拼贴的所有内容）来意识到自己做错了什么。对于插图，您可以尝试搜索“无缝瓷砖”。

# c++ - 如何创建一个递归方法来比较两个值？

> ID：11564834
> 
> 赞同：3
> 
> 时间：2012-07-19T16:04:29.777
> 
> 标签：c++, algorithm, recursion, openframeworks

我在for循环中生成随机值，我想测试下一个即将生成的值是否不在任何其他值附近，如果是这样，我想将它定位在公差半径之外，这就是我到目前为止：

```
int spacing = 30;
// create a bunch of random points
for ( int i = 0; i < MAX_NUMBER_OF_DOTS; i++ )
{
    ofVec2f point( ofRandom(spacing, ofGetWidth() - (spacing + spacing)), ofRandom( spacing, ofGetHeight() - (spacing + spacing)) );

    // Loop trough previously create points and check its distance
    for ( int j = 0; j < dots.size(); j++ )
    {
        ofVec2f testPoint = dots[j];
        float minDistance = 20.0f;
        // If the point is too close move it to a random point around it
        if ( point.distance( testPoint ) < minDistance )
        {
            point.x += cos( ofRandom( TWO_PI ) ) + minDistance;
            point.y += sin( ofRandom( TWO_PI ) ) + minDistance;
        }
    }
    dots.push_back( point );
} 
```

where **`dots`**is**`vector<ofVec2f> dots;`** 不完美，因为新计算的点没有考虑到之前创建的点附近，所以我认为递归方法可以帮助我解决问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T17:09:12.083

您可以使用[几何散列](http://en.wikipedia.org/wiki/Geometric_hashing)算法来检查新创建的点是否比“minDistance”更接近任何其他先前创建的点。可以在[此处](http://www.inesc-id.pt/pt/indicadores/Ficheiros/4858.pdf)找到一篇描述此方法应用于蛋白质构象的好文章。

# actionscript-3 - 是否有可能将子 swf 跟踪语句“捕获”到父 swf？

> ID：11564837
> 
> 赞同：3
> 
> 时间：2012-07-19T16:04:35.073
> 
> 标签：actionscript-3, flash, flash-builder

这是一个更一般的问题，而不是“帮助修复代码”问题：

**目标**
父 swf a.swf 加载外部子 b.swf

子 swf 有跟踪语句：[timestamp][log level][class] msg

父 swf 是否有可能“捕获”这些跟踪语句并将它们用作字符串？

**目的：**
父 swf 具有日志记录功能（通过 javascript 输出以获得额外的日志记录功能），我希望能够通过父级推送子跟踪语句。

**旁注：**
是的，我们能够在闪存日志中看到孩子的痕迹（使用像 vizzy 这样的应用程序），但我想知道是否可以将这些孩子的跟踪语句“冒泡”给父母。

我知道调试工具基本上会“包装”您编译的 swf 以进行额外的调试，但如果没有这些工具，这可能吗？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T08:06:47.697

[如果您查看未记录的 Trace 类http://hg.mozilla.org/tamarin-central/file/e774dfe22b39/extensions/Trace.as](http://hg.mozilla.org/tamarin-central/file/e774dfe22b39/extensions/Trace.as)，它曾经在 AS2 中是可能的，并且看起来在 AS3 中可能是可能的。但这是不可靠的，可能会改变。当然，该类仅在调试版本中可用。具体来说，您可以`setListener()`使用您的函数并将日志记录级别更改为首选值，以便它使用该函数而不是写入文件。

但我会建议你，如果你真的想继续使用它 - 查看 fdb 源，它已经知道加载了什么 SWF，方法来自什么源文件等等。如果你只想修改它的输出以打印来源 - 也许这是您正在谈论的一个非常小的补丁。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T18:40:22.897

如果您考虑一下跟踪的作用，您会发现这确实是不可能的。如果您在 mm.cfg 中以这种方式设置它，它会输出到控制台或日志文件。这是播放器运行时内置的功能。它与父母和孩子以及对象层次结构无关。

我认为 Michael E 的评论将是你能做的最好的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T18:26:45.223

我很确定它不能像你问的那样用纯 AS3 来完成。

# syntax-highlighting - 语法突出显示在 nano 中未按预期工作（正则表达式错误）

> ID：11564838
> 
> 赞同：1
> 
> 时间：2012-07-19T16:04:49.497
> 
> 标签：syntax-highlighting, nano

最近我一直在用 nano 做一些简单的 C 编码，语法突出显示的行为很奇怪。我对命令行不是很有经验，所以我可能在不知不觉中做错了什么。希望这里有人可以给我一个建议。

我下载了 nano 2.0.6 附带的示例 C 语法文件（因为这是预装的版本），并在注释掉一行的情况下使用它。其中一些按预期工作，但一些重要部分，如以下行，不：

```
color green "\<(float|double|bool|char|int|short|long|sizeof|enum|void|static|const|struct|union|typedef|extern|(un)?signed|inline)\>" 
```

我确定的是，虽然它不会以绿色突出显示 int，但它会以绿色突出显示。或者 , 等。也就是说，看起来被转义的尖括号（表示单词边界）表现得好像它们没有被转义一样。我通过删除反斜杠并重新启动 nano 来确认这一点。行为没有改变。

任何在正则表达式中使用转义尖括号的语法定义都会给我同样的问题。谷歌搜索这个问题已被证明是徒劳的，所以我很茫然。我将不胜感激任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-06T07:00:04.280

我猜你使用的是 OS X，因为那是 Apple 继续使用的版本。（我认为是许可原因。）Apple 的 libc 似乎不支持`\<`and `\>`，也不支持`\b`. `[[:<:]]`分别用和替换它们`[[:>:]]`应该可以工作。

另见：[http ://www.regular-expressions.info/wordboundaries.html#posix](http://www.regular-expressions.info/wordboundaries.html#posix)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T16:51:28.863

听起来像是您的 libc 正则表达式实现的问题，或者可能是因为您使用的是相当旧的 nano 版本，它可能静态链接到较旧的 libc。如果可能，您可以尝试更新到新版本。

您也可以尝试使用`\b`来替换`\<`和`\>`。*应该*是等价的。

# ruby-on-rails - Ruby on Rails 渲染

> ID：11564840
> 
> 赞同：1
> 
> 时间：2012-07-19T16:04:59.963
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我想知道在以下情况下如何获取我的数据

[我有一个名为 Pages 的资源，它具有所有可能的操作，并且是由 Ryan bate 在http://railscasts.com/episodes/117-semi-static-pages?autoplay=true](http://railscasts.com/episodes/117-semi-static-pages?autoplay=true)在他的 railscast 上提出的。现在我已经使用了布局文件夹

应用程序.html.erb

```
_footer.html.erb
_header.html.erb 
```

该页面有一个永久链接，我希望它们位于 _footer 部分，因此可以是关于我们、条款和条件等...

所以在这里我做了application.html.erb

```
<%= render 'layouts/header' %>
<div class="container">
<% flash.each do |key, value| %>
<div class="alert alert-<%= key %>"><%= value %></div>
<% end %>
<%= yield %>
<%= render 'layouts/footer' %>
<%= debug(params) if Rails.env.development? %>
</div> 
```

在布局文件夹中调用 _footer 这是 _footer.html.erb

```
<footer class="footer">
<small>
Copyright <%= Time.now.year %>
</small>
<nav><%= render "pages/link" %>
<ol class="footer_pages"> 
</ol>
</nav>
</footer> 
```

在Pages/_link.html.erb里面调用了一个文件，就是这个文件

```
<li>
<%= @pages.each do |page| %>
<%= page.name %>
<% end %>
</li> 
```

此时 pages.each 没有初始化并且如果我是正确的也不起作用所以我在控制器 applicationController 中做了他的初始化 @pages = Page.all ，因为它是调用者。这个理论应该可以让我阅读它，但它仍然不起作用！我做错了什么？

更新，因为我不知道如何添加其他评论 applicationController

```
class ApplicationController < ActionController::Base
  protect_from_forgery
  include SessionsHelper
@pages = Page.all
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:15:06.600

您可能需要在 ApplicationController 中使用 before_filter 来设置 @pages 实例变量。然后所有页面都可以访问这些数据。

像这样的东西：

```
class ApplicationController < ActionController::Base
  before_filter :pages

  def pages
    @pages = Page.all
  end

  ...
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T16:21:07.520

问题是当您渲染部分时，控制器中的变量不会传递给部分。换句话说，`@pages`即使您在控制器中对其进行了初始化，partial 也从未听说过。

尝试像这样将变量传递`@pages`给部分：

```
# page the partial is first called from
<%= render 'layouts/footer', :locals => {:pages => @pages} %>

# _footer.html.erb
<%= render "pages/link", :locals => {:pages => pages} %>

# _link.html.erb
<li>
<%= pages.each do |page| %>
<%= page.name %>
<% end %>
</li> 
```

有关详细信息，请参阅[http://guides.rubyonrails.org](http://guides.rubyonrails.org/layouts_and_rendering.html)。（渲染部分大约是页面下方的 80%）

# linux - 通过linux命令向端口发送数据

> ID：11564841
> 
> 赞同：1
> 
> 时间：2012-07-19T16:05:06.030
> 
> 标签：linux, curl, client-server, client-side, sendmessage

我想通过 Linux 命令将简单数据（比如“hello world”）发送到另一个系统（以及特定的端口号）。我正在寻找类似于客户端程序的命令？谁能帮我吗？

我正在尝试使用 CURL，但我没有正确理解它。如果可能在 CUrl 中你能举一些例子吗？

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T16:06:54.267

您要查找的程序称为“nc”。

# ruby-on-rails-3 - application.html.erb 中的 Facebook OG 元标记

> ID：11564850
> 
> 赞同：3
> 
> 时间：2012-07-19T16:05:34.203
> 
> 标签：ruby-on-rails-3, facebook-opengraph

在我的 rails 应用程序中，我想将 FB OG 元标记与用户当前所在的页面动态连接。我觉得这应该很简单，但不能让它正常工作。

例如，我有“创意”页面，上面有创意标题和创意描述。

目前，在我的 Application.html.erb 文件中，我有这个（并且标题为 NoMethodError）：

```
<meta property="og:title" content= <%= "#{@idea.title.titleize}" %>/>
<meta property="og:url" content= <%= "http://myurl.com/ideas/#{@idea.id}" %>/>
<meta property="og:description" content= <%= "#{@idea.short_description}" %>/> 
```

我的语法有问题吗？随着这些实例变量的可用性？我不确定我是否完全理解这是如何工作的。谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-08-11T05:12:18.187

是的，正如 noob 提到的，将内容声明放在引号内。

```
<meta property="og:description" content= "<%= @idea.short_description %>" /> 
```

为了使这些元标记在 Rails 中动态化，人们首先开始使用 Ryan Bates 在[漂亮页面标题 railscast中描述的漂亮页面标题方法](http://railscasts.com/episodes/30-pretty-page-title)

但是，我刚刚遇到了**这个看起来非常有前途的元标签宝石**：[元标签](https://github.com/kpumuk/meta-tags)

使用 gem，管理任何元标记，使它们动态且对 SEO 友好。例子：

```
set_meta_tags :title => 'Member Login'
# <title>Some Page Title</title> 
```

一次轻松设置所有 facebook:og 标签：

```
 set_meta_tags :og => {
                  :title    => 'The Rock',
                  :type     => 'video.movie',
                  :url      => 'http://www.imdb.com/title/tt0117500/',
                  :image    => 'http://ia.media-imdb.com/rock.jpg',
                  :video    => {
                    :director => 'http://www.imdb.com/name/nm0000881/',
                    :writer   => ['http://www.imdb.com/name/nm0918711/', 'http://www.imdb.com/name/nm0177018/']
                  }
                } 
```

上面的代码在您调用时输出以下 html `<%=display_meta_tags%>`：

`<meta property="og:title" content="The Rock"/> <meta property="og:type" content="video.movie"/> <meta property="og:url" content="http://www.imdb.com/title/tt0117500/"/> <meta property="og:image" content="http://ia.media-imdb.com/rock.jpg"/> <meta property="og:video:director" content="http://www.imdb.com/name/nm0000881/"/> <meta property="og:video:writer" content="http://www.imdb.com/name/nm0918711/"/> <meta property="og:video:writer" content="http://www.imdb.com/name/nm0177018/"/>`

源代码和 github repo 中有更多示例。最后一个标签集优先，因此如果您在布局中设置一个，然后在页面中设置另一个，似乎页面中的那个将优先。

如果您使用它，只需确保您`<%= display_meta_tags %>`的布局页面中有`application.html.erb`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-08T20:51:41.620

我相信正确的语法是：

```
<meta property="og:description" content= "<%= @idea.short_description %>" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-20T06:59:51.803

此链接也值得检查 - [http://joshsymonds.com/blog/2012/07/12/rails-concerns-iii-metatags/](http://joshsymonds.com/blog/2012/07/12/rails-concerns-iii-metatags/)

我已经接受了上面的链接帮助，但这不起作用。OG 元标记不起作用。

让我们看看有什么帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-07T05:49:26.093

请阅读我的博客文章，详细解释在整个 Rails 应用程序中实现此功能的简单方法——也许您可以推断将其添加到特定页面。我不确定它是否会解决您的具体问题，但可能有一些有用的调试信息。[http://blog.gingergriffis.com/post/59812374302/rails-app-thumbnail-on-facebook](http://blog.gingergriffis.com/post/59812374302/rails-app-thumbnail-on-facebook)

我的博客文章中可能有用的要点是 facebook 调试器工具：http: [//developers.facebook.com/tools/debug](http://developers.facebook.com/tools/debug)。

以下是我在 application.html.erb 文件中使用的设置：

```
<meta property=”og:title” content=”Ginger Griffis” /> 
<meta property=”og:type” content=”website” /> 
<meta property=”og:url” content=”http://www.gingergriffis.com/” /> 
<meta property=”og:image” content=”http://www.gingergriffis.com/assets/mylogolarge.jpg” /> 
<meta property=”og:description” content=”I am a RoR web dev...” /> 
```

# java - 网络爬虫的堆空间不足

> ID：11564851
> 
> 赞同：2
> 
> 时间：2012-07-19T16:05:34.413
> 
> 标签：java, garbage-collection, out-of-memory

我编写了一个小型爬虫，发现它的堆空间不足（尽管我目前将列表中的 URL 数量限制为 300 个）。

使用 Java 内存分析器，我发现消费者是`char[]`（64MB 中的 45MB，或者如果我增加允许的大小也会更多；它只是不断增长）。

分析器还给了我`char[]`. 它包含爬虫读取的 HTML 页面。

通过对不同设置的更深入分析，`-Xmx[...]m`我发现 Java**几乎使用了所有**可用空间，然后在`out of heap`我想下载 3MB 大小的图像时立即获取。

当我给 Java 16MB 时，它使用 14MB 并且失败，当我给它 64MB 时，它使用 59MB 并且在尝试下载大图像时失败。

阅读页面是用这段代码完成的（编辑和添加`.close()`）：

```
private String readPage(Website url) throws CrawlerException {
    StringBuffer sourceCodeBuffer = new StringBuffer();
    try {
        URLConnection con = url.getUrl().openConnection();
        con.setConnectTimeout(2000);
        con.setReadTimeout(2000);

        BufferedReader br = new BufferedReader(new InputStreamReader(con.getInputStream()));
        String strTemp = "";
        try {
            while(null != (strTemp = br.readLine())) {
                sourceCodeBuffer = sourceCodeBuffer.append(strTemp);
            }
        } finally {
            br.close();
        }
    } catch (IOException e) {
        throw new CrawlerException();
    }

    return sourceCodeBuffer.toString();
} 
```

另一个函数在while循环中使用返回的字符串，但据我所知，一旦字符串被下一页覆盖，就应该释放空间。

```
public void run() {
    boolean stop = false;

    while (stop == false) {
        try {
            Website nextPage = getNextPage();

            String source = visitAndReadPage(nextPage);
            List<Website> links = new LinkExtractor(nextPage).extract(source);
            List<Website> images = new ImageExtractor(nextPage).extract(source);

            // do something with links and images, source is not used anymore
        } catch (CrawlerException e) {
            logger.warning("could not crawl a url");
        }
    }
} 
```

下面是分析器给我的输出示例。当我想查看**哪些地方**还需要这些`char[]`时，分析器无法判断。所以我想它们不再需要了，应该被垃圾收集。由于它总是略低于最大空间，Java 似乎**也**进行了垃圾收集，但只是保持程序运行所需的量（不考虑可能会有大量输入）。

`System.gc()`此外，每 5 秒甚至设置后显式调用一次`source = null;`也不起作用。

只要有可能，网站代码似乎就会以任何方式存储。

我是否使用了[类似于`ObjectOutputStream`](https://stackoverflow.com/questions/7495155/java-heap-space-out-of-memory)强制永久维护读取字符串的东西？或者 Java 怎么可能将这些网站保存`Strings`在一个`char[]`数组中这么久？

```
Class Name                                                                                                                                                                                                                                                                                   | Shallow Heap | Retained Heap | Percentage
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
char[60750] @ 0xb02c3ee0  <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head><title>Wallpaper Kostenlos - 77.777 E-Wallpapers: Widescreen, 3D, Handy, Sexy Frauen</title><link rel="shortcut icon" href="http://img.e-wallp...|      121.512 |       121.512 |      1,06%
char[60716] @ 0xb017c9b8  <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head><title>Wallpaper Kostenlos - 77.777 E-Wallpapers: Widescreen, 3D, Handy, Sexy Frauen</title><link rel="shortcut icon" href="http://img.e-wallp...|      121.448 |       121.448 |      1,06%
char[60686] @ 0xb01f3c88  <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head><title>Wallpaper Kostenlos - 77.777 E-Wallpapers: Widescreen, 3D, Handy, Sexy Frauen</title><link rel="shortcut icon" href="http://img.e-wallp...|      121.384 |       121.384 |      1,06%
char[60670] @ 0xb015ec48  <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head><title>Wallpaper Kostenlos - 77.777 E-Wallpapers: Widescreen, 3D, Handy, Sexy Frauen</title><link rel="shortcut icon" href="http://img.e-wallp...|      121.352 |       121.352 |      1,06%
char[60655] @ 0xb01d5d08  <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head><title>Wallpaper Kostenlos - 77.777 E-Wallpapers: Widescreen, 3D, Handy, Sexy Frauen</title><link rel="shortcut icon" href="http://img.e-wallp...|      121.328 |       121.328 |      1,06%
char[60651] @ 0xb009d9c0  <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head><title>Wallpaper Kostenlos - 77.777 E-Wallpapers: Widescreen, 3D, Handy, Sexy Frauen</title><link rel="shortcut icon" href="http://img.e-wallp...|      121.320 |       121.320 |      1,06%
char[60637] @ 0xb022f418  <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head><title>Wallpaper Kostenlos - 77.777 E-Wallpapers: Widescreen, 3D, Handy, Sexy Frauen</title><link rel="shortcut icon" href="http://img.e-wallp...|      121.288 |       121.288 |      1,06% 
```

## 编辑

用更大的内存测试后，我发现在`dominator tree`

```
Class Name                                                                                                                                                                                                                                                                                              | Shallow Heap | Retained Heap | Percentage

crawling.Website @ 0xa8d28cb0                                                                                                                                                                                                                                                                           |           16 |       759.776 |      0,15%
|- java.net.URL @ 0xa8d289c0  https://www.google.com/recaptcha/api/image?c=03AHJ_VuuT4CmbxjAoKzWEKOqLaTCyhT-89l3WOeVjekKWW81tdZsnCvpIrQ52aLTw92rP-EUP9ThnzwBwHcRLXG6A0Bpwu11cGttRAUtarmWXhdcTVRoUMLNnJNZeuuA7LedgfTou76nl8ULyuIR3tgo7_lQ21tzzBhpaTSqwYHWyuZGfuRK3z9pgmqRqvI7gE4_4lexjYbkpd62kN...       |           56 |       759.736 |      0,15%
|  |- char[379486] @ 0xa8c6f4f8  <!DOCTYPE html><html lang="en">  <head>  <meta charset="utf-8">  <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE9">  <title>Google Accounts</title><style type="text/css">  html, body, div, h1, h2, h3, h4, h5, h6, p, img, dl,  dt, dd, ol, ul, li, t...    |      758.984 |       758.984 |      0,15%
|  |- java.lang.String @ 0xa8d28a40  /recaptcha/api/image?c=03AHJ_VuuT4CmbxjAoKzWEKOqLaTCyhT-89l3WOeVjekKWW81tdZsnCvpIrQ52aLTw92rP-EUP9ThnzwBwHcRLXG6A0Bpwu11cGttRAUtarmWXhdcTVRoUMLNnJNZeuuA7LedgfTou76nl8ULyuIR3tgo7_lQ21tzzBhpaTSqwYHWyuZGfuRK3z9pgmqRqvI7gE4_4lexjYbkpd62kNBZ7UIDccO5bx6TqFpf-7Sl...|           24 |           624 |      0,00%
|  |  '- char[293] @ 0xa8d28a58  /recaptcha/api/image?c=03AHJ_VuuT4CmbxjAoKzWEKOqLaTCyhT-89l3WOeVjekKWW81tdZsnCvpIrQ52aLTw92rP-EUP9ThnzwBwHcRLXG6A0Bpwu11cGttRAUtarmWXhdcTVRoUMLNnJNZeuuA7LedgfTou76nl8ULyuIR3tgo7_lQ21tzzBhpaTSqwYHWyuZGfuRK3z9pgmqRqvI7gE4_4lexjYbkpd62kNBZ7UIDccO5bx6TqFpf-7Sl...    |          600 |           600 |      0,00%
|  |- java.lang.String @ 0xa8d289f8  c=03AHJ_VuuT4CmbxjAoKzWEKOqLaTCyhT-89l3WOeVjekKWW81tdZsnCvpIrQ52aLTw92rP-EUP9ThnzwBwHcRLXG6A0Bpwu11cGttRAUtarmWXhdcTVRoUMLNnJNZeuuA7LedgfTou76nl8ULyuIR3tgo7_lQ21tzzBhpaTSqwYHWyuZGfuRK3z9pgmqRqvI7gE4_4lexjYbkpd62kNBZ7UIDccO5bx6TqFpf-7Sl6YmMgFC77kWZR7vvZIPkS...|           24 |            24 |      0,00%
|  |- java.lang.String @ 0xa8d28a10  www.google.com                                                                                                                                                                                                                                                     |           24 |            24 |      0,00%
|  |- java.lang.String @ 0xa8d28a28  /recaptcha/api/image                                                                                                                                                                                                                                               |           24 |            24 |      0,00% 
```

从我的意图来看，我真的很想知道：为什么 HTML 源代码是`java.net.URL`? 这是否来自我打开的 URLConnection？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T16:14:10.513

我会首先尝试在方法结束时关闭阅读器和 URL 连接`readPage`。最好将此逻辑放在一个`finally`子句中。

保持打开的连接将使用内存，并且根据内部结构，GC 可能无法回收它，即使您不再在代码中引用它

*更新*（基于评论）：连接本身没有`close()`方法，当所有附加到它的阅读器都关闭时，连接将被关闭。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T16:23:35.943

我不确定您的信息是否会得出垃圾收集不起作用的结论。分配更多内存时，您只是内存不足。你说你认为有些对象有资格进行 GC，但 JVM 没有。我很确定我会相信 JVM 而不是猜测！

您的应用程序中某处（其他）存在内存泄漏。您在某个对象的某处保留对网页全部内容的引用。这正在填满你的空闲记忆。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T16:21:36.410

> 当我给 Java 16MB 时，它使用 14MB 并且失败，当我给它 64MB 时，它使用 59MB 并且在尝试下载大图像时失败。

这并不奇怪，因为你已经接近你的极限了。一个 3 MB 的图像在加载（解压缩）时可以解压缩为 60 MB 或更多。您可以将最大值增加到 1 GB 吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T16:26:00.920

很可能引用保存在某处以防止垃圾收集。这总是需要胡乱纠正。我通常从带有堆分析的分析器开始。如果可能，编写一个加载页面的小型测试程序，仅此而已。它可以简单地处理包含一些大图片的 3-4 个 url 列表。如果页面包含一张大图片，比如 10+ MB，那么在分析器中应该很容易找到。最坏的情况是正在使用的库拥有引用。一个小的测试程序将是调试的最佳方式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-19T18:16:54.583

您在任何特定时间运行了多少个线程？您在 pastebin 中发送的 char 数组似乎是线程本地的（意味着没有泄漏）。您可能会看到发生的情况是，如果您同时运行太多，您自然会耗尽内存。尝试使用 2 个线程但相同数量的 URL 运行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-04T17:57:54.563

我发现的另一个可能原因是[子字符串使用了与原始字符串相同的旧大字符数组](https://stackoverflow.com/questions/2514349/lost-string-garbage-collection)。因此，如果您保留子字符串，则会保留完整的字符串。

# php - SimpleXML 返回一个对象而不是一个字符串

> ID：11564856
> 
> 赞同：2
> 
> 时间：2012-07-19T16:05:39.060
> 
> 标签：php, simplexml

我有一些看起来像这样的 XML：

```
<Body>
    <RESULT>
        <SUCCESS>true</SUCCESS>
        <SESSIONID>42</SESSIONID>
        <SESSION_ENCODING>;jsessionid=42</SESSION_ENCODING>
    </RESULT>
</Body> 
```

SimpleXML 以这种方式解析它：

```
$obj = simplexml_load_string($xmlStringAsAbove);
$this->sessionId = $obj->Body->RESULT->SESSIONID; 
```

结果是这样的：

```
[sessionId:protected] => SimpleXMLElement Object
    (
        [0] => 42
    ) 
```

我需要的是这个：

```
[sessionId:protected] => 42 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T16:06:46.027

将其转换为字符串（或 int）以获取`<SESSIONID>`标签的内容：

```
$this->sessionId = (string) $obj->Body->RESULT->SESSIONID; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-08-03T11:25:11.370

根据我的经验，当您需要一个值而不是一个对象时，SimpleXMLElement 可能会很痛苦。

根据上一个答案，您可以转换所需的 XML 部分，或使用以下方法之一：

从 ops 示例中，要获取整数，您可以使用 intval()：

`$this->sessionId = intval($obj->Body->RESULT->SESSIONID);`

从 (PHP 5 >= 5.3.0, PHP 7) 开始，您还可以使用 SimpleXMLElement::__toString 方法获取字符串；

[https://www.php.net/manual/en/simplexmlelement.tostring.php](https://www.php.net/manual/en/simplexmlelement.tostring.php)

```
$this->sessionIdasString = $obj->Body->RESULT->SESSIONID->__toString(); 
```

# vba - 如何使用宏获取不带扩展名或完整路径的 Word 文档的当前文件名？

> ID：11564857
> 
> 赞同：7
> 
> 时间：2012-07-19T16:05:39.883
> 
> 标签：vba, ms-word

我有提取文件完整路径的代码，减去扩展名，我正在尝试修改它以仅存储文件的名称，再次没有扩展名。

```
Sub ShowFilename()

Dim pathName As String
With ActiveDocument
If Len(.Path) = 0 Then
.Save
End If
If Right(.Name, 1) = "x" Then
pathName = Left$(.FullName, (Len(.FullName) - 5))
Else
pathName = Left$(.FullName, (Len(.FullName) - 4))
End If
End With
MsgBox pathName

End Sub 
```

这将显示`C:\Users\test`，并且文档的名称是`test.docm`。如何修改它以仅显示文件名？我是否需要将字符串拆分`\`并提取最后一部分？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-19T16:43:47.413

FSO 有一套处理这类事情的方法，其中一个是“getBaseName”

```
Msgbox CreateObject("scripting.filesystemobject").getbasename(o.Name) 
```

[http://msdn.microsoft.com/en-us/library/xhxzwwe1(v=vs.84).aspx](http://msdn.microsoft.com/en-us/library/xhxzwwe1(v=vs.84).aspx)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-19T16:15:36.387

```
Sub ShowFilename()
Dim pathName As String
Dim o As Document
Set o = ActiveDocument
If InStrRev(o.Name, ".") <> 0 Then
    MsgBox Left(o.Name, InStrRev(o.Name, ".") - 1)
Else
    MsgBox o.Name
End If
End Sub 
```

我最初发布此内容时没有添加 if，如果文件从未保存或没有扩展名，则会出错。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-21T23:02:26.533

由于我无法使用 FSO 编写代码（不只是用于 VB，是吗？），我写了这个，非常不言自明:)

```
Dim oldFilename As String

oldFilename = ActiveDocument.Name
If Right(oldFilename, 5) = ".docx" Then
    MsgBox ("subtract .docx")
    oldFilename = Left(oldFilename, Len(oldFilename) - 5)
ElseIf Right(oldFilename, 4) = ".doc" Then
    MsgBox ("subtract .doc")
    oldFilename = Left(oldFilename, Len(oldFilename) - 4)
Else
    MsgBox ("no extension yet")
End If 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-28T10:00:21.063

是的，我不会那样做的！

假设你有一个完整的文件夹，你不需要扩展名，你只需要名字。您要做的是浏览文档一词并通过此函数使用您希望从文件名中删除的扩展名类型来解析它们

```
Function removeExtension(myDoc as Document, extension as String)
Dim documentWithoutExtension as String

documentWithoutExtension = replace(myDoc.Name, extension, "")

removeExtension = documentWithoutExtension

End Function 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-10-04T23:56:19.123

这个对我有用。

```
Sub ShowFilename()
MsgBox ActiveWindow.Parent
End Sub 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-04-26T16:41:47.493

一个简单的方法是：

```
Sub Test1()
Dim DocName As Document
Set DocName = ActiveDocument
end sub 
```

# java - iText 对 PDF 进行数字签名，无需输入两次 PIN

> ID：11564862
> 
> 赞同：0
> 
> 时间：2012-07-19T16:06:16.923
> 
> 标签：java, itext, pkcs#11

我正在尝试使用智能卡和 iText 对 PDF 进行数字签名。我通读了有关如何使用 iText 签署文档的文档，并尝试自己使用他们的一些代码[。](http://itextpdf.sourceforge.net/howtosign.html#howtosign)下面是我正在使用的代码：

```
String pkcs11ConfigSettings =
  "name = SmartCard\nlibrary = C:\\Program Files\\ActivIdentity\\ActivClient\\acpkcs201-ns.dll";
AuthProvider p =
  new SunPKCS11(new ByteArrayInputStream(pkcs11ConfigSettings.getBytes()));
Security.addProvider(p);
KeyStore.PasswordProtection pp =
  new KeyStore.PasswordProtection("012345".toCharArray());
KeyStore.Builder builder =
  KeyStore.Builder.newInstance("PKCS11",p ,pp);
KeyStore ks = builder.getKeyStore();
Certificate[] cc = ks.getCertificateChain("Digital Signature Key");
PrivateKey pk = (PrivateKey)ks.getKey("Digital Signature Key", null);
OutputStream fos = new FileOutputStream("c:\\2.pdf");
PdfReader reader = new PdfReader(new FileInputStream(new File("C:\\1.pdf")));
PdfStamper stamper = PdfStamper.createSignature(reader, fos, '\0');
PdfSignatureAppearance appearance = stamper.getSignatureAppearance();
appearance.setCrypto(pk, cc, null,PdfSignatureAppearance.SELF_SIGNED);
appearance.setVisibleSignature(new Rectangle(0, 0, 100, 100), 1,null);
stamper.close(); 
```

这种方法的问题是当 iText 关闭时，`PDFStamper`它会[`C_Sign()`](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/sun/security/pkcs11/wrapper/PKCS11.java#PKCS11.C_Sign%28long%2Cbyte%5B%5D%29)调用驱动程序的 PIN 提示。

因此，如果这是一个应用程序，它将要求我在签名之前输入我的 PIN，以便获得`KeyStore`and `PrivateKey`，以及在出现驱动程序的 PIN 输入提示时。反正有两次要求输入密码吗？我对这些东西有点陌生，我是不是走错了路？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T17:04:52.813

似乎如果我按照带有经过[身份验证的属性](http://itextpdf.sourceforge.net/howtosign.html#signextdicattrib)的示例进行操作，我可以让 PIN 对话框在每次签署文档时只弹出一次。这是我最终使用的最终代码，希望对其他人有所帮助。

```
for(int i=0;i<2;i++) {
    String pkcs11ConfigSettings =
                "name = AuthProvider\nlibrary = C:\\Program Files\\ActivIdentity\\ActivClient\\acpkcs201-ns.dll";
    AuthProvider p = (SunPKCS11)Security.getProvider("SunPKCS11-AuthProvider");
    if(p==null) {
        p = new SunPKCS11(new ByteArrayInputStream(pkcs11ConfigSettings.getBytes()));
        p.setCallbackHandler(new CallbackHandler() {    
            @Override
            public void handle(Callback[] callbacks) throws IOException,
                    UnsupportedCallbackException {
                for(Callback c : callbacks)
                    if(c instanceof PasswordCallback) {
                        //HACK. if we set password to null it will bring up the drivers PIN dialog.
                        ((PasswordCallback) c).setPassword(null);
                    }
            }
        });
        Security.addProvider(p);
    }
    KeyStore ks = KeyStore.getInstance("PKCS11",p); 
    ks.load(null, null);
    Certificate[] cc = ks.getCertificateChain("Digital Signature Key");
    PrivateKey pk = (PrivateKey)ks.getKey("Digital Signature Key", null);
    OutputStream fos = new FileOutputStream("c:\\doc" + i + ".pdf"); ;
    PdfReader reader = new PdfReader(new FileInputStream(new File("C:\\1.pdf")));
    PdfStamper stamper = PdfStamper.createSignature(reader, fos, '\0');
    PdfSignatureAppearance sap = stamper.getSignatureAppearance();
    sap.setVisibleSignature(new Rectangle(100, 100, 200, 200), 1, null);
    Calendar cal = Calendar.getInstance();
    PdfSignature dic = new PdfSignature(PdfName.ADOBE_PPKLITE, PdfName.ADBE_PKCS7_DETACHED);
    dic.setDate(new PdfDate(cal));
    dic.setName(PdfPKCS7.getSubjectFields((X509Certificate)cc[0]).getField("CN"));
    sap.setCryptoDictionary(dic);
    sap.setLayer2Text("Digitally signed by "+ dic.get(PdfName.NAME) +"\n\nDate: " + cal.getTime().toString());
    HashMap<PdfName,Object> exc = new HashMap<PdfName,Object>();
    exc.put(PdfName.CONTENTS, new Integer(0x2502));
    sap.preClose(exc);
    PdfPKCS7 pk7 = new PdfPKCS7(pk, cc, null, "SHA1", "SunPKCS11-AuthProvider", false);
    MessageDigest messageDigest = MessageDigest.getInstance("SHA1");
    byte buf[] = new byte[8192];
    int n;
    InputStream inp = sap.getRangeStream();
    while ((n = inp.read(buf)) > 0) {
        messageDigest.update(buf, 0, n);
    }
    byte hash[] = messageDigest.digest();
    byte sh[] = pk7.getAuthenticatedAttributeBytes(hash, cal, null);
    pk7.update(sh, 0, sh.length);
    PdfDictionary dic2 = new PdfDictionary();
    byte sg[] = pk7.getEncodedPKCS7(hash, cal);
    byte out[] = new byte[0x2500 / 2];
    System.arraycopy(sg, 0, out, 0, sg.length);
    dic2.put(PdfName.CONTENTS, new PdfString(out).setHexWriting(true));
    sap.close(dic2);
} 
```

# sql-server - 将两条记录合二为一

> ID：11564867
> 
> 赞同：1
> 
> 时间：2012-07-19T16:06:19.047
> 
> 标签：sql-server

我看过这里，有很多问题涉及将两条记录合二为一，但我认为我的问题是一个独特的问题。我有一个软件，它使用 sql 查询为我们的票务软件创建桌面小工具。我想跟踪每个技术人员有多少帮助台票，并且我有工作代码。它会生成一个效果很好的条形图，但是，有时多个技术人员或一名技术人员和一名经理被分配到一张工单，我无法提取该数据。代码是：

```
SELECT TECHNICIAN, COUNT(TECHNICIAN) AS TICKETS
FROM TABLE 
```

（内部连接有一点额外的复杂性，所以我可以通过将员工的 ID 链接到带有实际姓名的表来在条形图上获取员工的姓名，但这是简化版本）

这是我当前的结果集：

```
TECHNICIAN    TICKETS
Bob           5
Bob, Harry    1
Joe           6
Mark          3
Jeff          2 
```

我想要的结果集是：

```
TECHNICIAN    TICKETS
Bob           6
Joe           6
Mark          3
Jeff          2 
```

如果上面的结果集进入小工具，它会为每条记录创建一个条形图。所以会有一个“鲍勃”酒吧和一个“鲍勃，哈利”酒吧。另外，我知道我只想要技术人员，所以我不需要它来制作单独的 'harry' 记录，只需将两个 'bob' 加在一起。此外，我对数据库具有只读访问权限，因此创建新表来保存数据已被淘汰。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:16:20.623

假设该`TECHNICIAN`列是 255 个字符：

```
SELECT Tech, Tickets = COUNT(*)
FROM (
  SELECT 
    Tech = SUBSTRING
           (
              TECHNICIAN, 1, 
              COALESCE(NULLIF(CHARINDEX(',', TECHNICIAN)-1, -1), 255)
           )
  FROM dbo.[TABLE]
) AS x
GROUP BY Tech; 
```

# php - xml使用php解析xpath错误

> ID：11564869
> 
> 赞同：0
> 
> 时间：2012-07-19T16:06:26.263
> 
> 标签：php, xml, xpath, xml-parsing

我正在尝试使用 xpath 来运行程序并解析出 xml 数据以重新定价书籍。但是，当我运行程序时，出现以下错误：

```
PHP Warning:  SimpleXMLElement::xpath() [<a href='simplexmlelement.xpath'>simplexmlelement.xpath</a>]: Invalid expression 
```

和

```
PHP Warning:  SimpleXMLElement::xpath() [<a href='simplexmlelement.xpath'>simplexmlelement.xpath</a>]: xmlXPathEval: evaluation failed 
```

都在第 242 行，这是 $result 的行...：

```
//function to check if child nodes exist for pricing
function xml_child_exists($xml, $childpath)
 {
$result = $xml->xpath($childpath);
 if (isset($result)) {
    return true;
} else {
    return false;
} 
```

}

这个函数在这里运行：

```
// check to see if there are values
        if(xml_child_exists($parsed_xml, $current->AttributeSets->children('ns2', true)->ItemAttributes->ListPrice->Amount))
           { 
            $listPrice = $current->AttributeSets->children('ns2', true)->ItemAttributes->ListPrice->Amount;
          } else {
            $listPrice = 0;
          } 
```

然后我终于结束了：

```
PHP Fatal error:  Call to a member function children() on a non-object in repricemws.php on line 67 
```

第 67 行是调用函数的位置。

这段代码有什么问题，我该如何让它正确运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:12:28.883

是否`$current->AttributeSets->children('ns2', true)->ItemAttributes->ListPrice->Amount`包含有效的 XPath 表达式？

从该调用链的外观来看，您正在提取一个值，例如 '5.00' 并将其直接传递给 xpath 查询执行器。那是行不通的，并且会产生错误消息。

* * *

跟进：

好的，`Amount`价格也是如此，所以大概是 5.00 美元或 5.00 美元，对吧？这意味着您使用该确切的字符串作为您的 xpath 查询，基本上是在执行以下操作：

```
$result = $xml->xpath('$5.00'); 
```

这**不是**一个有效的 xpath 表达式。所以 $result 不是文档中匹配节点的列表，它实际上是一个布尔值 FALSE。

然后，您对该值执行 isset() 。变量**IS**设置（设置为布尔值 false），因此您的函数返回**TRUE**。

# java - 如何修复给出 NetworkError: 400 Unsupported draft specification: 13 的 websocket

> ID：11564870
> 
> 赞同：1
> 
> 时间：2012-07-19T16:06:26.213
> 
> 标签：java, websocket, jetty, maven-3

我正在尝试使用[本网站](http://webtide.intalio.com/2011/08/websocket-example-server-client-and-loadtest/)的示例来学习如何在码头中使用 web-socket。我正在使用 Maven 来收集依赖项。

当我在 localhost:8082 中打开页面时，页面出现（它是一个聊天客户端），但是如果我尝试登录（这是首先使用 web-sockets 的时候），什么也没有发生。使用 Firebug，我确定我收到的错误消息如下：

```
"NetworkError: 400 Unsupported draft specification: 13 - http://localhost:8082/chat" 
```

并且

```
Firefox can't establish a connection to the server at ws://localhost:8082/chat 
```

我检查了 Web 套接字的 jar（版本 7.5.0.RC1），结果发现 WebSocketFactory 不支持 Sec-WebSocket-Draft 13。

我将 jar 更新到最新版本（8.0.3.v20111011），它支持版本 13：

```
 switch (draft)
    {
        case -1:
        case 0:
            extensions=Collections.emptyList();
            connection = new WebSocketConnectionD00(websocket, endp, _buffers, http.getTimeStamp(), _maxIdleTime, protocol);
            break;
        case 1:
        case 2:
        case 3:
        case 4:
        case 5:
        case 6: 
            extensions=Collections.emptyList();
            connection = new WebSocketConnectionD06(websocket, endp, _buffers, http.getTimeStamp(), _maxIdleTime, protocol);
            break;
        case 7:
        case 8:
            extensions= initExtensions(extensions_requested,8-WebSocketConnectionD08.OP_EXT_DATA, 16-WebSocketConnectionD08.OP_EXT_CTRL,3);
            connection = new WebSocketConnectionD08(websocket, endp, _buffers, http.getTimeStamp(), _maxIdleTime, protocol,extensions,draft);
            break;
        case 13:
            extensions= initExtensions(extensions_requested,8-WebSocketConnectionD13.OP_EXT_DATA, 16-WebSocketConnectionD13.OP_EXT_CTRL,3);
            connection = new WebSocketConnectionD13(websocket, endp, _buffers, http.getTimeStamp(), _maxIdleTime, protocol,extensions,draft);
            break;
        default:
            LOG.warn("Unsupported Websocket version: "+draft);
            response.setHeader("Sec-WebSocket-Version","0,6,8,13");
            throw new HttpException(400, "Unsupported draft specification: " + draft);
    } 
```

...但我仍然得到同样的错误。最重要的是，我现在在代码中遇到错误，说构造函数 WebSocketClient() 已弃用，并且我使用的许多方法在 WebSocketClient 中不存在。

所以我想我的问题是：

1) 是什么导致它运行版本 13，我怎样才能让它使用版本 8？
2) 有没有其他人尝试使用本教程并遇到了麻烦？
3）有没有更简单的方法来学习 websockets（也许这个例子已经过时了）？

谢谢你的帮助。

# c# - 动态的asp.net中的网站代码

> ID：11564871
> 
> 赞同：0
> 
> 时间：2012-07-19T16:06:34.090
> 
> 标签：c#, asp.net, html, sql

我被分配了一个看起来很有挑战性的项目。![在此处输入图像描述](../Images/48b3efe6e13f6109f285d4fc7623da31.png)在此网页上，我希望在单击“计算机请求”时在模块*下添加一个新部分。该部分将被称为“成本中心”，旁边有一个文本框用于输入信息。我希望它看起来像带有文本框的主题 * 行，但我想要模块下的新行而不是主题。

所有数据都是动态使用的。谁能指出我从哪里开始的正确方向？显然我需要使用客户端代码..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:10:09.317

您可能想研究一下[UpdatePanel 控件](http://msdn.microsoft.com/en-us/library/bb399001.aspx)。这可能会帮助您做您需要的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T16:30:45.360

为什么不在页面上以及选择“计算机请求”时创建项目？您可以通过将下拉列表上的 autopostback 属性设置为 true 来执行此操作，并且可以在您的代码中对其进行测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T16:30:55.227

如果您想完全在客户端代码中执行此操作，只需创建“成本中心”行并将可见性设置为`false`. 然后`onchange`将下拉列表的事件连接到一个 javascript 函数，该函数检查是否选择了“计算机请求”项。如果是，请将可见性更改为`true`。（您也可以使用 jQuery[来执行此操作](https://stackoverflow.com/questions/6746752/selectedindexchanged-event-of-dropdownlist-is-not-working-with-jquery)）。

**编辑**

```
$(document).ready(function () {
    $('#yourSelectId').change(function() {
        var selectedVal = $('#yourSelectId option:selected').attr('value');
        if(selectedVal == computerRequestItemValue)
            $('#costCenterRow').show();
        else
            $('#costCenterRow').hide();
    });
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T16:26:35.830

占位符是您的方案的一个非常好的选择。当任何用户想要绑定动态控件并且我们也可以固定它的位置时，它很有用。非常简单的演示：[http ://www.java2s.com/Code/ASP/Asp-Control/DealwithaspplaceholdercontrolfromcodebehindC.htm](http://www.java2s.com/Code/ASP/Asp-Control/DealwithaspplaceholdercontrolfromcodebehindC.htm)

# objective-c - 如何在uitableview中显示从avplayer播放的ipodLibrary中选择的歌曲

> ID：11564879
> 
> 赞同：3
> 
> 时间：2012-07-19T16:07:04.747
> 
> 标签：objective-c, ios, xcode, avplayer

我正在使用 AVPlayer 播放歌曲。我也可以在后台播放它。有一个`UIButton`叫`showPlaylist`. 当我点击它时，我需要显示我从中选择的歌曲列表，`ipodLibrary`并且`UITableView`我应该能够显示艺术品、歌曲中剩余的分钟数以及艺术家的姓名（如果歌曲中可用）。

我有播放和暂停按钮：当我单击暂停按钮时，歌曲会暂停，但当我再次点击播放按钮时，它会转到 ipodLibrary。当我点击播放按钮时如何恢复播放？

当其中有多首歌曲时`UITableView`，我希望它在第一首曲目完成后立即继续下一首曲目。我想知道该怎么做。

```
-(IBAction)playButtonPressed:(UIButton *)sender {
  // Create picker view
  MPMediaPickerController* picker = [[MPMediaPickerController alloc] init];
  picker.delegate = self;
  if (userMediaItemCollection) {
    MusicTableViewController *controller = [[MusicTableViewController alloc]
     initWithNibName: @"MusicTableView" bundle: nil];
    controller.delegate = self;
    controller.modalTransitionStyle = UIModalTransitionStyleCoverVertical;
    [self presentModalViewController: controller animated: YES];
  } else {
    MPMediaPickerController *picker = [[MPMediaPickerController alloc]
      initWithMediaTypes: MPMediaTypeMusic];
    picker.delegate  = self;
    picker.allowsPickingMultipleItems = YES;
    picker.prompt = NSLocalizedString
      (@"Add songs to play", "Prompt in media item picker");
    [[UIApplication sharedApplication] setStatusBarStyle:
      UIStatusBarStyleDefault animated: YES];
    [self presentModalViewController: picker animated: YES];
  }
}

-(IBAction)pauseButtonPressed:(UIButton *)sender {
  [myPlayer pause];
}

-(void) mediaPickerDidCancel:(MPMediaPickerController *)mediaPicker {
  [self dismissViewControllerAnimated:YES completion:nil];
}

-(void) mediaPicker:(MPMediaPickerController *)mediaPicker didPickMediaItems:
  (MPMediaItemCollection *)mediaItemCollection {
  [self dismissViewControllerAnimated:YES completion:nil];
  NSURL* assetUrl = [mediaItemCollection.representativeItem
    valueForProperty:MPMediaItemPropertyAssetURL];
  AVURLAsset* asset = [AVURLAsset URLAssetWithURL:assetUrl options:nil];
  AVPlayerItem* playerItem = [AVPlayerItem playerItemWithAsset:asset];
  myPlayer = [AVPlayer playerWithPlayerItem:playerItem];
  [myPlayer play];
}

- (void)viewDidAppear:(BOOL)animated {
  [super viewDidAppear:animated];
  [[UIApplication sharedApplication] beginReceivingRemoteControlEvents];
  [self becomeFirstResponder];
}

- (BOOL)canBecomeFirstResponder {
  return YES;
}

- (void)viewWillDisappear:(BOOL)animated {
  [super viewWillDisappear:animated];
  [[UIApplication sharedApplication] endReceivingRemoteControlEvents];
  [self resignFirstResponder];
}

-(void)remoteControlReceivedWithEvent:(UIEvent *)event {
  switch (event.subtype) {
    case UIEventSubtypeRemoteControlTogglePlayPause:
      if (myPlayer.rate == 0.0) {
        [myPlayer play];
      } else {
        [myPlayer pause];
      }
      break;
    case UIEventSubtypeRemoteControlPlay:
      [myPlayer play];
      break;
    case UIEventSubtypeRemoteControlPause:
      [myPlayer pause];
      break;
    default:
      break;
  }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T16:48:49.503

我会查看 Apple 的示例代码[“添加音乐”](http://developer.apple.com/library/ios/#samplecode/AddMusic/Introduction/Intro.html)，它清楚地展示了如何执行您所描述的所有操作。

这个示例应用程序将向您介绍如何使用`UITableView`从 iPod 库中保存到`MPMediaItemCollection`. 它还显示了如何使用`MPMediaItems`以及`MPMediaItemCollections`您可以将轨道特定属性显示为单元格标题标签等。

1.  为了填充表格视图，您可以进行如下设置：

    `MPMediaItem *mediaItem = (MPMediaItem *)[collectionMutableCopy objectAtIndex:row];`

    `MPMediaItemArtwork *artwork = [mediaItem valueForProperty:MPMediaItemPropertyArtwork];`

    ```
    if (mediaItem) {
        cell.textLabel.text = [mediaItem valueForProperty:MPMediaItemPropertyTitle];
        cell.detailTextLabel.text = [mediaItem valueForProperty:MPMediaItemPropertyArtist];
        if (artwork != nil) {
            cell.imageView.image = [artwork imageWithSize:CGSizeMake (40, 40)];
        }else{
            cell.imageView.image = [UIImage imageNamed:@"no_artwork.png"];
        }
    } 
    ```

2.  将链接到播放按钮的按钮重命名为“选择音乐”，并创建一个名为“播放”的新按钮，并将其操作设置为：

    `- (IBAction)playMusic { [myPlayer play]; }`

**编辑：**从以下内容创建数组`MPMediaItemCollection`：

```
NSMutableArray *collectionMutableCopy = [[NSMutableArray alloc] initWithArray:myMediaItemCollection.items]; 
```

**编辑 2：**取消注释项目中的以下行：

在`- (void) registerForMediaPlayerNotifications`

```
/*
 // This sample doesn't use libray change notifications; this code is here to show how
 //     it's done if you need it.
 [[NSNotificationCenter defaultCenter] removeObserver: self
 name: MPMediaLibraryDidChangeNotification
 object: musicPlayer];

 [[MPMediaLibrary defaultMediaLibrary] endGeneratingLibraryChangeNotifications];

 */ 
```

在`- (void)dealloc`

```
/*
 // This sample doesn't use libray change notifications; this code is here to show how
 //     it's done if you need it.
 [notificationCenter addObserver: self
 selector: @selector (handle_iPodLibraryChanged:)
 name: MPMediaLibraryDidChangeNotification
 object: musicPlayer];

 [[MPMediaLibrary defaultMediaLibrary] beginGeneratingLibraryChangeNotifications];
 */ 
```

替换这一行：

```
[[AVAudioSession sharedInstance] setCategory: AVAudioSessionCategoryAmbient error: nil]; 
```

有了这个

```
 [[AVAudioSession sharedInstance] setCategory: AVAudioSessionCategoryPlayback error: nil];

 UInt32 doSetProperty = 0;
 AudioSessionSetProperty (
 kAudioSessionProperty_OverrideCategoryMixWithOthers,
 sizeof (doSetProperty),
 &doSetProperty
 ); 
```

然后将以下内容添加到您的项目 info.plist 文件中

![在此处输入图像描述](../Images/a1e5ef94954c30c289279960eb52671f.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T16:22:14.733

您的问题是您的播放按钮正在做的不仅仅是告诉音乐播放器播放。您需要一个只调用`[myPlayer play]`; 在播放按钮以外的地方进行所有设置。

让你的播放按钮也选择歌曲并不是一个很好的编码实践（最好保持一个按钮 -> 一个功能的想法）。所以有一个按钮可以立即执行播放按钮中的操作，然后让播放按钮调用`[myPlayer play]`

至于你的其他问题，你应该看看这个：[Play multiple audio files using AVAudioPlayer](https://stackoverflow.com/q/2586284/1487063)

只是让你知道，你真的不应该在同一个帖子中问多个问题。这使得给出简洁、有用的答案变得更加困难，并且会使网站更难找到内容。

我不确定您是否在询问如何显示歌曲信息，但我想它在您的标题中。对于这一点，[iPhone sdk - 通过应用程序访问当前歌曲信息](https://stackoverflow.com/q/741847/1487063)。

# iphone - 如何使用 iOS5 中的单个 API 请求获取 Twitter 上所有朋友的详细信息？

> ID：11564882
> 
> 赞同：0
> 
> 时间：2012-07-19T16:07:12.000
> 
> 标签：iphone, api, ios5, twitter, limit

我正在尝试从 iOS5 中的应用程序获取我在 Twitter 上关注的所有用户的用户 ID、屏幕名称和个人资料图片链接的列表。为此，最初我发布以下链接以获取我所有朋友的 user_id-

“https://api.twitter.com/1/friends/ids.json”

一旦我收到上述 URL 的响应，即我在 Twitter 上关注的所有朋友的 user_id 列表，我将所有用户 id 连接到单个字符串中，然后使用以下 URL 获取 JSON，其中将包含所需的我关注的所有用户的详细信息——

“https://api.twitter.com/1/users/lookup.json?user_id=420107765,383684745,312790865,85462891,164199168,140856038&include_entities=screen_name”

在这里，我面临的问题是，如果我关注的朋友数量更多，我会收到 API 限制超出错误，尽管我只进行了 2 次 API 调用。

令人震惊的是，我仍然可以进行其他 twitter API 调用，但是当我进行查找/用户调用以获取仅 5 到 10 个用户的信息时，它仍然给我以下错误 ---

结果的打印描述：{错误=“超出速率限制。客户端每小时不得超过150个请求。”；request = "/1/users/lookup.json?user_id=50851703,86254626,88856792,6253282,18839785,145125358,135421739,170416270&include_entities=True&application_id=uk.co.vipul.twt"; }

有人可以给我这个问题的解决方案。提前致谢 ！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:48:58.330

首先，有 100 个 UID/屏幕名称的上限。实际的 API 文档页面（https://dev.twitter.com/docs/api/1/get/users/lookup）并没有说明您是否可以包含 100 个屏幕名称，然后是 100 个 UID，并获得 200 个结果每次通话？可能有人在论坛/博客中讨论过这个问题，但不是文档页面。为了安全起见，请确保在每次调用中将请求限制为 <= 100 个 UID。

我不确定的另一项是，include_entities 应该是真/假吗？如果您包含实体，您将返回实体信息。我不确定以这种方式使用时它是否有效，但即使它确实有效，期望结果只是来自推文实体的屏幕名称（与用户中的屏幕名称不同）似乎是合乎逻辑的.

我相信如果您限制 UID 的数量，并将 include_entities 设置为有效（适当的）值，您将获得一个 JSON 对象，其中包含有关所有 UID 的大量信息。然后，您可以按计划从该对象中提取信息。

# java - Android - 动态微调器

> ID：11564891
> 
> 赞同：8
> 
> 时间：2012-07-19T16:08:20.963
> 
> 标签：java, android, layout, dynamic, spinner

我有一个触发 1 个对话框的游戏视图，从这里触发了第二个对话框。

在第二个对话框中，我有 2 个按钮和 1 个微调器。我遇到的问题是让微调器出现在我的视图中，并带有动态数据。

本质上，我需要在单击按钮时弹出并列出所有相关数据。我有 3 个不同的 ArrayList（1 个字符串和 2 个整数），它们包含需要动态添加到每个微调器选择的单独信息，例如

```
pt1 -   ArrayLists1
        ArrayLists2
        ArrayLists3
pt2 -   ArrayLists1
        ArrayLists2
        ArrayLists3 
```

微调器 XML 布局代码：

```
<LinearLayout
  xmlns:android="http://schemas.android.com/apk/res/android"
  android:orientation="vertical"
  android:layout_width="wrap_content"
  android:layout_height="wrap_content"
  android:layout_gravity="center_horizontal">
    <Button android:text="@string/attack" 
            android:id="@+id/Attack" 
            android:layout_width="fill_parent" 
            android:layout_height="wrap_content" />
    <Button android:text="@string/useitem" 
            android:id="@+id/UseItemBtn" 
            android:layout_width="fill_parent" 
            android:layout_height="wrap_content" />
    <Spinner android:text="@string/useitem"
            android:id="@+id/UseItemSpin"
            android:layout_width="fill_parent" 
            android:layout_height="wrap_content"
            android:visibility="gone" />
    <Button android:text="@string/equipweapon" 
            android:id="@+id/EquipWeapon" 
            android:layout_width="fill_parent" 
            android:layout_height="wrap_content"/>
</LinearLayout> 
```

这是我目前用来触发微调器点击的代码（这里的日志被触发）：

```
import android.widget.AdapterView.OnItemSelectedListener;

@Override
public void onClick(View clicked)
{
    if(clicked.getId() == R.id.UseItemBtn)
    {
        Spinner spinner = (Spinner) findViewById(R.id.UseItemSpin);

        ArrayList<String> arrayList1 = new ArrayList<String>();
        arrayList1.add("test item the first one");
        arrayList1.add("really long list item - section 2 goes here - finally section 3");

        ArrayAdapter<String> adp = new ArrayAdapter<String> (context,android.R.layout.simple_spinner_dropdown_item,arrayList1);
        // APP CURRENTLY CRASHING HERE
        spinner.setAdapter(adp);
       //Set listener Called when the item is selected in spinner
       spinner.setOnItemSelectedListener(new OnItemSelectedListener() 
       {
            public void onItemSelected(AdapterView<?> parent, View view, int position, long arg3) 
            {
                String city = "The city is " + parent.getItemAtPosition(position).toString();
                Toast.makeText(parent.getContext(), city, Toast.LENGTH_LONG).show();
            }

            public void onNothingSelected(AdapterView<?> arg0) 
            {
                // TODO Auto-generated method stub
            }
        });
    }
    BattleRun.show();
} 
```

如何在此单击上添加动态微调器。最重要的是，当单击微调器时，理想情况下，我希望在实际微调器中有一个提交按钮，这样他们就可以在选择之前浏览选项（应该始终可见）。

最后，当在微调器中选择项目并提交时，上一个对话框将自动刷新新数据（这很容易做到）。

如果您需要更多代码片段，请告诉我，任何帮助或指导将不胜感激。

谢谢， L & L 合作伙伴

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-20T09:10:11.230

您可以使用此代码用字符串数组列表填充微调器 -

```
 public void onClick(View clicked){
    if(clicked.getId() == R.id.Attack){
        Spinner spinner = (Spinner) findViewById(R.id.UseItem);

      //Sample String ArrayList
        ArrayList<String> arrayList1 = new ArrayList<String>();

        arrayList1.add("Bangalore");
        arrayList1.add("Delhi");
        arrayList1.add("Mumbai");
        ArrayAdapter<String> adp = new ArrayAdapter<String> (this,android.R.layout.simple_spinner_dropdown_item,arrayList1);
        spinner.setAdapter(adp);

        spinner.setVisibility(View.VISIBLE);
       //Set listener Called when the item is selected in spinner
       spinner.setOnItemSelectedListener(new OnItemSelectedListener() 
       {
            public void onItemSelected(AdapterView<?> parent, View view,
                    int position, long arg3) 
            {
                String city = "The city is " + parent.getItemAtPosition(position).toString();
                Toast.makeText(parent.getContext(), city, Toast.LENGTH_LONG).show();

            }

            public void onNothingSelected(AdapterView<?> arg0) 
            {
                // TODO Auto-generated method stub
            }
        });

        //BattleRun.dismiss();
        Log.d("Item","Clicked");

    }
} 
```

此代码将进入您的布局 xml 文件 -

```
<!-- Add onClick attribute on this button -->
<Button android:text="@string/attack" 
        android:id="@+id/Attack" 
        android:layout_width="fill_parent" 
        android:layout_height="wrap_content"
        android:onClick="onClick" />
<Spinner android:text="@string/useitem" 
        android:id="@+id/UseItem" 
        android:layout_width="fill_parent" 
        android:layout_height="wrap_content"
        android:visibility="gone" />
<Button android:text="@string/equipweapon" 
        android:id="@+id/EquipWeapon" 
        android:layout_width="fill_parent" 
        android:layout_height="wrap_content"/> 
```

请注意，您没有在 xml 文件中添加 onClick。这就是你的 onClick 函数没有被调用的原因。您还可以使用 strings.xml 文件中的字符串数组来使用静态列表。

# error-handling - InDesign CS5 脚本：打开文档没有响应，并且没有抛出错误？

> ID：11564893
> 
> 赞同：0
> 
> 时间：2012-07-19T16:08:29.847
> 
> 标签：error-handling, execute, adobe-indesign, extendscript

我正在使用该方法  `myFile.execute()`  以编程方式打开一个 InDesign 文档（在这种情况下，它是一个应用了样式的空白文档）。

* * *

有时会打开文档，有时则***不会***打开文件……似乎脚本在完成之前没有足够的时间打开文件。

* * *

这发生在我身上，因为在使用它进行测试  `alert(template.name)`  时*确实*显示了我正在寻找的文件名，并且脚本在应用时***不会***引发错误  `File(template).execute()`  （变量  `template`  本身已经是一个  `File`  对象，但也根本  `template.execute()`  不起作用）。

* * *

以下是相关代码：

```
function openStylesTemplate()
{
    var templateFolder = getScriptFolder(); // with the function below
    var fileArray = templateFolder.getFiles("*.indd"); // an array of all InDesign documents in this script's same folder

    try
    {
        var template = fileArray[0]; // the ONLY InDesign document in the folder
        File(template).execute(); // open the InDesign template document
    }
    catch(e)
    {
        alert("Error: " + e.message + "\n\n" +
                 "Make sure the InDesign styles document is in the same folder as this script,\n" +
                  "and that it is the ONLY InDesign document in this folder, and try again.\n\n" +
                 "This script is in this folder: " + templateFolder + ".");

        exit();
     }
} // end of function openStylesTemplate 
```

那么，脚本可能没有足够的时间来加载文档吗？如果是这样，我应该在调用此函数之前创建一个计时器吗？或者有没有更好的方式以编程方式打开 InDesign 文档？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T09:13:54.787

打开一个indesign文档并不重要，`File.execute()`它只是从操作系统的角度打开一个文件而不参考文件本身。您确实通过调用打开文件`app.open ( file );`。

# jquery - 动态添加的元素上的jQuery事件未触发

> ID：11564894
> 
> 赞同：1
> 
> 时间：2012-07-19T16:08:31.007
> 
> 标签：jquery

我一直在寻找如何做到这一点，我已经看到了很多选项（其中大部分已被弃用），但我尝试过的任何方法都没有奏效。

我有一个动态添加表格行的文件上传脚本，其中一个`<td>`有一些`<button>`元素，我需要在点击时做一些 Ajax 工作，但我似乎无法让它做任何事情。

这`<td>`是包含添加到 DOM 的按钮的 :

```
<td class="filedelete">
    <button class="btn btn-danger delete">
        <i class="icon-trash icon-white"></i> Delete
    </button>
</td> 
```

这是我现在正在尝试的 jQuery：

```
$(".delete").on("click", function(event){
    console.log("clicked");
}); 
```

我`.on`应该使用什么？我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T16:09:46.493

修改您的代码，以便事件处理程序绑定到包含元素（可能是父`<table>`元素或另一个静态的包含元素），如下所示：

```
$("#containing_element").on("click", ".delete", function(event){
    console.log("clicked");
}); 
```

然后触发的点击事件`.delete`将冒泡并被包含元素捕获。

# jquery - 使用 MVC3 创建仅选择不同记录的视图

> ID：11564896
> 
> 赞同：1
> 
> 时间：2012-07-19T16:08:35.370
> 
> 标签：jquery, asp.net-mvc-3

所以，这就是我有一个包含超过 100,000 条记录的数据库的问题。我需要使用 MVC 3 创建一个网站，该网站将显示我需要的 4 个重要字段，类似于使用切片器或数据透视表时 excel 所做的方式，因此我工作中的老员工将在网站上看到他们习惯的相同格式. 当前的工具是一个 excel 数据透视表，它允许用户根据用户需要查看的细节来扩大或缩小区域。

现在数据透视表看起来像这样

**区域**

+++ 程序

+++++子程序

+++++++++++++项目

如果我的滑块扩展图不好，我很抱歉**

我使用的数据库和编码系统是 MS SQL SERVER 2008 R2 和带有 MVC 3 的 ASP.net。所以我需要做的是从区域开始找到包含尚未列出的区域的不同记录并列出它们按降序排列。

**例子**

1区

区域 2

3区等...

然后在找到所有不同的区域后，我需要为每个部分显示所有不同的程序、子程序和项目。我是 MVC 新手，我现在只知道如何使用 html 帮助器 displayFor 来显示一个包含数据库中每条记录的列表。

像这样的前任。

```
@foreach (var item in Model) {
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.AREA)
        </td> 
```

我只是对如何解决这个问题感到困惑，我应该使用 lambda 或 SQL 语句来缩小结果范围，还是他们获得所需结果的另一种方式。任何有关解决此类问题的方法的建议或教程将不亚于对这个问题的回答。我可以发布任何有帮助的代码，请询问。感谢您的时间和帮助！

**现实模型**

```
using System;
using System.Collections.Generic;

namespace DBFirstMVC.Models
{
    public partial class realistic
    {
        public string CAF_ID { get; set; }
        public Nullable<int> CC { get; set; }
        public string INVESTMENT_AREA { get; set; }
        public string MAJOR_PROGRAM { get; set; }
        public string DIVISION { get; set; }
        public string CLARITY_ID { get; set; }
        public string SPA { get; set; }
        public string PA { get; set; }
        public string PROJECT_NAME_ORIG { get; set; }
        public string PROJECT_NAME { get; set; }
        public string HIA { get; set; }
        public string HMP { get; set; }
        public string RESOURCE_MGR { get; set; }
        public string RESOURCE_TYPE { get; set; }
        public string RESOURCE { get; set; }
        public string PRIMARY_VENDOR { get; set; }
        public string DESCRIPTION { get; set; }
        public Nullable<int> CONFIDENCE_1Q { get; set; }
        public Nullable<int> CONFIDENCE_2Q { get; set; }
        public Nullable<int> CONFIDENCE_3Q { get; set; }
        public Nullable<int> CONFIDENCE_4Q { get; set; }
        public Nullable<System.DateTime> ACCOUNTING_PERIOD { get; set; }
        public Nullable<decimal> VALUE { get; set; }
        public int REALISTIC_PK { get; set; }
    }

} 
```

**索引视图**

```
@model PagedList.IPagedList<DBFirstMVC.Models.realistic>

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Index</h2>

<p>
    @Html.ActionLink("Create New", "Create")
</p>
<table>
    <tr>

        <th>
            INVESTMENT AREA
        </th>

        <th></th>
    </tr>
@foreach (var item in Model.Distinct()) {
    <tr>
        <td>

            @Model.Select(c => c.INVESTMENT_AREA).Distinct()

        </td>
        <td>
            @Html.ActionLink("Edit", "Edit", new { id=item.REALISTIC_PK }) |
            @Html.ActionLink("Details", "Details", new { id=item.REALISTIC_PK}) |
            @Html.ActionLink("Delete", "Delete", new { id=item.REALISTIC_PK })
        </td>
    </tr>
}

</table> 
```

# processing - 处理，controlp5 - 使用 saveFrame() 记录 controlp5 ControlWindow

> ID：11564898
> 
> 赞同：0
> 
> 时间：2012-07-19T16:08:44.667
> 
> 标签：processing

我想`saveFrame()`用来记录使用 controlp5 创建的 controlWindow 中的帧。默认情况下`saveFrame()`只记录草图的主窗口。有没有办法指定`saveFrame()`从哪个窗口拉出？

有没有其他方法可以提取每帧绘制到 controlWindow 的缓冲区？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T15:54:11.537

Java 中的 Windows 通常是[JFrames](http://docs.oracle.com/javase/1.4.2/docs/api/javax/swing/JFrame.html)。我还没有测试过，但你应该能够做这样的事情：

```
import java.awt.Component;
import java.awt.image.BufferedImage;
//get to the java.awt.Component
Component window = yourP5ControlWindow.component();
//make a BufferedImage to store pixels into
BufferedImage snapshot = new BufferedImage(window.getWidth(),window.getHeight(),BufferedImage.TYPE_INT_RGB);
//take a snapshot
window.paint( snapshot.getGraphics() );
//create a PImage out of the BufferedImage
PImage image = new PImage(snapshot);
//save,etc.
image.save("yourComponent.png"); 
```

高温高压

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-27T00:40:24.363

`PApplet.saveImage()`本质上是一个包装器`PImage.save()`。如果您只想捕获屏幕的一部分，则应将其渲染为 a`PImage()`然后调用`PImage.save()`. `PImage.save()`但是，它要求您指定自己的文件名——它不会像您一样自动递增`PApplet.saveImage()`。

将 ControlP5 内容绘制到单独的缓冲区 (PImage) 中似乎并不简单，但您可以从主图形上下文中获取任意矩形并将其保存。

```
PImage screengrab = createImage(controlWindow.width, controlWindow.height, RGB);
screengrab.loadPixels();
loadPixels();
for (int i=0; i<screengrab.width*screengrab.height; i++) {
    // loop thru pixels and copy into screengrab.pixels...
    // i'll leave the math here as a fun exercise for you.
}
screengrab.updatePixels();
updatePixels();
screengrab.save("screengrab.png"); 
```

# java - Spring WS with Axiom：JAXB 内联 MTOM 附件

> ID：11564899
> 
> 赞同：4
> 
> 时间：2012-07-19T16:08:45.500
> 
> 标签：java, spring, jaxb, spring-ws, mtom

我有 web 服务来接收和发送附件，我想使用 JAXB 作为编组器，但到目前为止它不能正常工作，因为 JAXB 将消息正文中传入或传出的任何附件作为 base64 字符串内联，消耗了很多内存不足并经常导致 OutOfMemoryError。我正在概述我的设置和修复尝试，希望有人能帮助我把它做好。

Axiom 是我选择 SAAJ 作为消息工厂的选择，因为我必须处理大附件。我可以成功地将 JAXB 用作端点方法的参数和返回类型的编组器，除非涉及附件（内联问题）。这是我的设置：

网络服务配置 XML：

```
<beans xmlns=...>

    <context:component-scan base-package="com.example.webservice" />

    <sws:annotation-driven />

    <bean id="jaxb2Marshaller" class="org.springframework.oxm.jaxb.Jaxb2Marshaller">
        <property name="classesToBeBound">
            <list>
                <value>com.example.webservice.oxm.FileTestResponse</value>
                <value>com.example.webservice.oxm.FileTestRequest</value>
            </list>
        </property>
        <property name="mtomEnabled" value="true"/>
    </bean>

    <bean id="messageFactory" class="org.springframework.ws.soap.axiom.AxiomSoapMessageFactory">
        <property name="payloadCaching" value="true"/>
        <property name="attachmentCaching" value="true"/>
    </bean>

    <sws:dynamic-wsdl id="fileTest" portTypeName="fileTest" locationUri="/webservice/fileTest/" targetNamespace="http://example.com/webservice/definitions" >
        <sws:xsd location="/WEB-INF/fileTest.xsd" />
    </sws:dynamic-wsdl>

</beans> 
```

我的 XSD 的一部分：

```
<!-- I generate the marshalling classes with XJB, and using
    xmime:expectedContentTypes it correctly creates mtomData field
    with DataHandler type instead of byte[] -->
<xs:element name="fileTestRequest">
    <xs:complexType>
        <xs:sequence>
            <xs:element name="mtomData" type="xs:base64Binary"
                xmime:expectedContentTypes="application/octet-stream"/>
        </xs:sequence>
    </xs:complexType>
</xs:element> 
```

我的端点类：

```
package com.example.webservice;

import ...

@Endpoint
@Namespace(prefix = "s", uri = FileTestEndpoint.NAMESPACE)
public class FileTestEndpoint {

    public static final String NAMESPACE = "http://example.com/webservice/schemas";

    @PayloadRoot(localPart = "fileTestRequest", namespace = NAMESPACE)
    @ResponsePayload
    public FileTestResponse fileTest(@RequestPayload FileTestRequest req) throws IOException {
        // req.getMtomData() and do something with it
        FileTestResponse resp = new FileTestResponse();
        DataHandler dataHandler = new DataHandler(new ByteArrayDataSource("my file download data".getBytes(), "text/plain"));
        resp.setData(dataHandler);
        return resp;
    }
} 
```

因此，此代码有效，但与附件不同。我正在寻找一些工作解决方案：

*   [Spring 论坛：正确的 MTOM 处理？](http://forum.springsource.org/showthread.php?48343-correct-MTOM-handling): 建议扩展一些 Axiom 类，但自（2008 年）以来代码发生了很大变化，我无法让它工作；
*   [Spring 论坛：Response-Attachment/Saaj/Jaxb](http://forum.springsource.org/showthread.php?105928-Response-Attachment-Saaj-Jaxb)：可能是由 1.6u14 中修复的 JVM 错误引起的，这是我的 Weblogic 版本使用的错误（另外它不适用于主题创建者）；
*   [Spring 论坛：使用 Spring-WS 客户端发送大型附件](http://forum.springsource.org/showthread.php?67669-sending-large-attachments-with-Spring-WS-client)：有人使用 Axis2 解决了直接绕过 Spring WS，这不是重点；
*   [Stackoverflow：带有 MTOM 附件的 Spring-WS webservice - Hello world 测试](https://stackoverflow.com/questions/11316023/spring-ws-webservice-with-mtom-attachement-hello-world-test)：与我的问题相同，2 周前，没有答案；

显然，最好的帮助来自我发布的关于 WSS4J 发生的这个内联问题的[另一个 SO question 。](https://stackoverflow.com/questions/11543255/spring-ws-wss4jsecurityinterceptor-mtom-memory-issues)Blaise Doughan 说我需要`AttachmentMarshaller`并`AttachmentUnmarshaller`设置（un）marshaller 来正确处理它，[就像他在他的博客中发布的那样](http://blog.bdoughan.com/2011/03/jaxb-web-services-and-binary-data.html)。

* * *

所以，我假设附件编组器是解决这个问题的关键。

要将它们设置在（un）marshaller 上，我没有其他办法，只能在给定的（un）marshaller 上设置附件 marshaller（我为它们复制了 Doughan 的代码`Jaxb2Marshaller`）`initJaxbMarshaller`。`initJaxbUnmarshaller`

但是我自己`Jaxb2Marshaller`的没有被使用，即使手动设置为`sws:annotation-driven`：

```
<sws:annotation-driven marshaller="jaxb2Marshaller" unmarshaller="jaxb2Marshaller"/>

<bean id="jaxb2Marshaller" class="com.example.webservice.MyJaxb2Marshaller">
    <property name="classesToBeBound">
        <list>
            <value>com.example.webservice.oxm.FileTestResponse</value>
            <value>com.example.webservice.oxm.FileTestRequest</value>
        </list>
    </property>
    <property name="mtomEnabled" value="true"/>
</bean> 
```

这个 marshaller 类是创建但从未使用过，我不知道为什么，所以我仍然无法测试`AttachmentMarshaller`s 是否可以解决问题。

这就是我现在能说的。有很多方法可以尝试：

*   找出`MyJaxb2Marshaller`被忽略的原因，这可能是最简单的；
*   `AttachmentMarshaller`如果s 不能解决它，则修复 JAXB 附件内联其他方式，我不知道那会是什么；
*   用其他编组器替换 JAXB，效果一样好（主要是 Axiom 支持，可能是 WSS4J）。

我在这个问题上待了很长时间，我一定错过了明显的解决方案。任何帮助都是最受欢迎的。

谢谢！

* * *

库版本：

*   Spring 3.1.0 (core, beans, oxm 等)
*   Spring WS 2.1.0（核心和 Spring XML）
*   StAX2 2.1
*   WoodSToX 3.2.9 (wstx)
*   JAXB 2.2.5-2 (API+impl)
*   Apache Axiom 1.2.13 (API+impl+c14n+dom)
*   Apache Mime4j 0.7.2（核心）

应用服务器是带有 Java 1.6.0u14 的 Oracle 11g R1 Patchset 1。

# c# - 如何在 Metro 应用程序中调试 Share 合约？

> ID：11564903
> 
> 赞同：2
> 
> 时间：2012-07-19T16:09:03.780
> 
> 标签：c#, debugging, microsoft-metro, windows-runtime, visual-studio-2012

如何在 Metro 应用程序中调试 Share 合约？我在本地和模拟器都试过了。单击我的应用程序的共享目标按钮后，弹出窗口打开然后消失。目前，如果我从 Metro 开始屏幕启动应用程序，而无需调试，我只能让弹出菜单保持打开状态。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T17:54:43.413

在 Visual Studio 中更改调试选项以不启动应用程序。

1.  右键单击项目
2.  特性
3.  调试
4.  启动应用程序 = 否
5.  好的
6.  F5**你的应用**
7.  从*其他应用分享给它*

VS 应该在您的进程开始时自动附加。

# ios - 如何序列化一个函数？

> ID：11564908
> 
> 赞同：0
> 
> 时间：2012-07-19T16:09:31.347
> 
> 标签：ios, serialization, interpreter

有一种方法可以序列化/反序列化 obj-c 应用程序中的函数吗？

在不久的将来，我需要在不更新可执行文件的情况下更改函数的实现。

我知道没有办法序列化函数指针/nsoperation/块，所以我正在寻找另一种方法......也许我可以在我的应用程序中包含一个 python 解释器并从 websever 下载一个脚本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T16:13:17.753

根据 SDK 许可协议，您不得下载任何代码——与 Apple 审查所有应用程序的愿望相比，这是一个薄弱环节。

用技术术语来说，您需要包含 Python 或 LUA 或类似的东西。JavaScript 包含在内，但只能通过与 Web 视图交互的非常尴尬的过程来访问。

# mysql - SQL MIN() 选择数据。ORDER 表正确

> ID：11564909
> 
> 赞同：1
> 
> 时间：2012-07-19T16:09:33.800
> 
> 标签：mysql, sql, database

我有 2 个问题。首先，我有一个*MySQL*数据库，其中包含以下行：**id(AUTO_INCREMENT PRIMARY KEY)**、**name**和**time**。该数据库代表比赛的时间。我想选择时间最短的名称和时间。

```
SELECT name, MIN(time) as time FROM race GROUP BY TIME; 
```

只要名称中没有重复项，此查询就会为我提供所有时间和名称。但是，我只想要最快的时间和该行中的名称。

然后当我提交我的时间时，我想知道我在什么地方。将`ORDER BY TIME`保持每行的每个 ID 相同，或者我可以按时间排序表，然后选择 ID = 1 的行吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T16:22:15.147

如果有可能同时有多个条目，我会使用这样的嵌套查询，因为将结果集限制为 1 可能会排除一个名称。

```
select name, time from race where time = (select min(time) from race) 
```

如果您想知道给定时间在什么地方，只需计算时间小于该时间的条目数即可。

```
select count(*) + 1 as place from race where time < [your time] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T16:13:18.660

对于您的第一个问题，您想要的是选择“最少”时间。

这是我认为最清晰的方法，它使用 LIMIT 函数只返回 1 行。

MySQL：

```
SELECT name, time 
FROM race 
ORDER BY time asc
LIMIT 1; 
```

微软 SQL：

```
SELECT TOP 1 name, time
FROM race
ORDER BY time asc 
```

# javascript - 将用户数据解析为mailto form的&body属性

> ID：11564910
> 
> 赞同：0
> 
> 时间：2012-07-19T16:09:36.293
> 
> 标签：javascript, forms, innerhtml, mailto

我有这个脚本：

```
function calculate(){

passworda = document.password1.user1.value.toLowerCase()
passwordb = document.password1.pass1.value.toLowerCase()

var user = 1
var pass = 1

for(d=0;d<passwordb.length;d++) {
pass*= passwordb.charCodeAt(d);
}
for(e=0;e< passworda.length; e++) {
user *= passworda.charCodeAt(e);
    }
      document.password1.outputuser1.value = user;
      document.password1.outputpass1.value = pass;
} 
```

这种形式：

```
<form name="password1" enctype="text/plain" method="get" action="mailto:myemail@mydomain.com?subject=Register&body=A new user has registered with your form. Their username is ' +outputuser1+ ' and their password is ' +outputpass1+ '">
Username:<input type="text" name="user1" />
Password:<input type="password" name="pass1" />
<input type="submit" value="Register" onclick="calculate()" />
<input type="reset" value="Reset" />
</form> 
```

我想要做的是当用户填写此表单并点击提交时，它会通过电子邮件向我发送加密的用户名和密码，替换

`&body=A new user has registered with your form. Their username is ' +outputuser1+ ' and their password is ' +outputpass1+ '"`

和

`&body=A new user has registered with your form. Their user name is JOHNSMITH and their password is 123456"`

当表单被提交时。我没有收到任何 javascript 错误，但是当电子邮件窗口打开时，正文和主题为空白。

任何人都可以帮助这个工作吗？提前谢谢了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:12:55.253

`mailto:`带有uris 的表单在 WWW 上的[支持太差了。](http://isolani.co.uk/articles/mailto.html)

如果您想通过表单收集数据，那么您**需要**使用 HTTP(S) URI 作为操作，并在服务器上处理提交的数据。

# hyperlink - 向 CRM 2011 注释添加超链接

> ID：11564912
> 
> 赞同：0
> 
> 时间：2012-07-19T16:09:46.513
> 
> 标签：hyperlink, dynamics-crm-2011

我正在研究如何通过 C# 在 CRM 2011 中的注释正文上创建指向网页的超链接。我尝试将代码添加到文本中，例如。`<a href=\"" + destination + "\">SharePoint</ID></a>`但这只是简单地输入它。有什么办法可以做到这一点吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T16:25:17.840

好吧，在浏览器中检查 Note 的文本字段会发现它是一个 TextArea DOM 元素。由于这些只能显示纯文本，因此我建议您可能不走运。对于那个很抱歉 ：）

如果有帮助，您可以编辑表单以添加 URL 类型的新字段？

# c# - Protobuf-net Error: Type is not expected, and no contract can be inferred: BlockHeader

> ID：11564914
> 
> 赞同：13
> 
> 时间：2012-07-19T16:09:48.407
> 
> 标签：c#, protobuf-net, openstreetmap

尝试通过以下来自此线程以及其他来源的信息来使 openstreetmap pbf 文件的反序列​​化正常工作：

[Protobuf-net 反序列化开放街道地图](https://stackoverflow.com/questions/4663298/protobuf-net-deserialize-open-street-maps)

我目前正在使用来自 r480 的 protobug dll。我使用 protogen 从 osm proto 创建 csharp 类文件，但是当我在尝试从流中读取的代码中达到这一点时：

```
BlockHeader header;
using (var tmp = new LimitedStream(file, length))
{
    header = Serializer.Deserialize<BlockHeader>(tmp); // exception occurs here
} 
```

它抛出以下异常：

```
InnerException: System.InvalidOperationException
Message=Type is not expected, and no contract can be inferred: BlockHeader
Source=protobuf-net
StackTrace:
  at ProtoBuf.Meta.TypeModel.ThrowUnexpectedType(Type type) in C:\Dev\protobuf-net\protobuf-net\Meta\TypeModel.cs:line 1115
  at ProtoBuf.Meta.TypeModel.TryDeserializeAuxiliaryType(ProtoReader reader, DataFormat format, Int32 tag, Type type, Object& value, Boolean skipOtherFields, Boolean asListItem, Boolean autoCreate, Boolean insideList) in C:\Dev\protobuf-net\protobuf-net\Meta\TypeModel.cs:line 848
  at ProtoBuf.Meta.TypeModel.DeserializeCore(ProtoReader reader, Type type, Object value, Boolean noAutoCreate) in C:\Dev\protobuf-net\protobuf-net\Meta\TypeModel.cs:line 582
  at ProtoBuf.Meta.TypeModel.Deserialize(Stream source, Object value, Type type, SerializationContext context) in C:\Dev\protobuf-net\protobuf-net\Meta\TypeModel.cs:line 506
  at ProtoBuf.Meta.TypeModel.Deserialize(Stream source, Object value, Type type) in C:\Dev\protobuf-net\protobuf-net\Meta\TypeModel.cs:line 488
  at ProtoBuf.Serializer.Deserialize[T](Stream source) in C:\Dev\protobuf-net\protobuf-net\Serializer.cs:line 69
  at OsmParserDemo.MainWindow.OsmParse() in C:\Users\crussell\Documents\Visual Studio 2010\Projects\OsmParseMadness\OsmParserDemo\MainWindow.xaml.cs:line 57
  at OsmParserDemo.MainWindow..ctor() in C:\Users\crussell\Documents\Visual Studio 2010\Projects\OsmParseMadness\OsmParserDemo\MainWindow.xaml.cs:line 28 
```

因此，在将代码结构与 protobuf-net 示例的代码结构进行比较时，我得到的印象是，在识别每个成员方面我可能遗漏了一些东西。这是正确的，还是我在这个空间上的出路？非常感谢任何帮助或提示！

编辑：这是生成的 FileFormat.cs 类的 BlockHeader 片段：

[块头](http://pastebin.com/SDPAFp77)

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-19T19:54:09.420

添加代码文件后，一切都变得清晰起来。根据堆栈跟踪，您正在使用的库是 protobuf-net；但是那个 .cs 文件与 protobuf-net*无关。*嗯，很少。

您看，（至少）有 2 个 c#/.net protobuf 实现，我认为您将它们混合在一起：

*   [protobuf-csharp-port](http://code.google.com/p/protobuf-csharp-port/)由 Jon Skeet 开发，是 Java 版本的直接端口，意思是：它遵循相同的设计原则和 API。如果您同时使用 C# 和 Java 工作，这很诱人。
*   [protobuf-net](http://code.google.com/p/protobuf-net/)是由我设计的，它是一个从第一原则开始的实现，旨在成为惯用的 .NET，这意味着：它可以针对您现有的类型（基本上，像 , 等可以）以代码优先工作`XmlSerializer`，`DataContractSerializer`但也支持如果需要，可以使用 .proto

令人困惑的是，它们都具有名为“protogen”的代码生成工具。AFAIK，这种命名巧合只是自然的融合/巧合，而不是计划（好的或坏的）。

从 protobuf-csharp-port 的 protogen 生成的 c# 文件将与 protobuf-csharp-port 库一起使用

从 protobuf-net 的 protogen 生成的 c# 文件将与 protobuf-net 库一起使用

这是 protobuf-net 生成的版本，包括`BlockHeader`：

```
//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

// Generated from: Foo.proto
namespace ConsoleApplication9
{
  [global::System.Serializable, global::ProtoBuf.ProtoContract(Name=@"Blob")]
  public partial class Blob : global::ProtoBuf.IExtensible
  {
    public Blob() {}

    private byte[] _raw = null;
    [global::ProtoBuf.ProtoMember(1, IsRequired = false, Name=@"raw", DataFormat = global::ProtoBuf.DataFormat.Default)]
    [global::System.ComponentModel.DefaultValue(null)]
    public byte[] raw
    {
      get { return _raw; }
      set { _raw = value; }
    }

    private int _raw_size = default(int);
    [global::ProtoBuf.ProtoMember(2, IsRequired = false, Name=@"raw_size", DataFormat = global::ProtoBuf.DataFormat.TwosComplement)]
    [global::System.ComponentModel.DefaultValue(default(int))]
    public int raw_size
    {
      get { return _raw_size; }
      set { _raw_size = value; }
    }

    private byte[] _zlib_data = null;
    [global::ProtoBuf.ProtoMember(3, IsRequired = false, Name=@"zlib_data", DataFormat = global::ProtoBuf.DataFormat.Default)]
    [global::System.ComponentModel.DefaultValue(null)]
    public byte[] zlib_data
    {
      get { return _zlib_data; }
      set { _zlib_data = value; }
    }

    private byte[] _lzma_data = null;
    [global::ProtoBuf.ProtoMember(4, IsRequired = false, Name=@"lzma_data", DataFormat = global::ProtoBuf.DataFormat.Default)]
    [global::System.ComponentModel.DefaultValue(null)]
    public byte[] lzma_data
    {
      get { return _lzma_data; }
      set { _lzma_data = value; }
    }

    private byte[] _bzip2_data = null;
    [global::ProtoBuf.ProtoMember(5, IsRequired = false, Name=@"bzip2_data", DataFormat = global::ProtoBuf.DataFormat.Default)]
    [global::System.ComponentModel.DefaultValue(null)]
    public byte[] bzip2_data
    {
      get { return _bzip2_data; }
      set { _bzip2_data = value; }
    }
    private global::ProtoBuf.IExtension extensionObject;
    global::ProtoBuf.IExtension global::ProtoBuf.IExtensible.GetExtensionObject(bool createIfMissing)
      { return global::ProtoBuf.Extensible.GetExtensionObject(ref extensionObject, createIfMissing); }
  }

  [global::System.Serializable, global::ProtoBuf.ProtoContract(Name=@"BlockHeader")]
  public partial class BlockHeader : global::ProtoBuf.IExtensible
  {
    public BlockHeader() {}

    private string _type;
    [global::ProtoBuf.ProtoMember(1, IsRequired = true, Name=@"type", DataFormat = global::ProtoBuf.DataFormat.Default)]
    public string type
    {
      get { return _type; }
      set { _type = value; }
    }

    private byte[] _indexdata = null;
    [global::ProtoBuf.ProtoMember(2, IsRequired = false, Name=@"indexdata", DataFormat = global::ProtoBuf.DataFormat.Default)]
    [global::System.ComponentModel.DefaultValue(null)]
    public byte[] indexdata
    {
      get { return _indexdata; }
      set { _indexdata = value; }
    }
    private int _datasize;
    [global::ProtoBuf.ProtoMember(3, IsRequired = true, Name=@"datasize", DataFormat = global::ProtoBuf.DataFormat.TwosComplement)]
    public int datasize
    {
      get { return _datasize; }
      set { _datasize = value; }
    }
    private global::ProtoBuf.IExtension extensionObject;
    global::ProtoBuf.IExtension global::ProtoBuf.IExtensible.GetExtensionObject(bool createIfMissing)
      { return global::ProtoBuf.Extensible.GetExtensionObject(ref extensionObject, createIfMissing); }
  }

} 
```

结论：

要么使用 protobuf-net protogen，要么使用 protobuf-csharp-port 库。没有混搭。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-09T16:19:58.213

运行此代码时出现这种错误：

```
public IEnumerable<T> Deserialize<T>(string path)
{
    using (var stream = File.Open(path, FileMode.Open, FileAccess.Read))
    {
        var item = Serializer.Deserialize<IEnumerable<T>>(stream);
        return item;
    }
} 
```

当我更改`IEnumerable<T>`为`List<T>`问题消失了。我猜 ProtoBuff 对接口一无所知，您应该指定要反序列化的非抽象/接口类型。

**UPD：**总结：你应该反序列化成被序列化的类型对象。没有基本类型。

# python - 读取 2 个文件并将一个文件的某些值替换为另一个文件的脚本

> ID：11564916
> 
> 赞同：0
> 
> 时间：2012-07-19T16:09:57.927
> 
> 标签：python, perl

这是我想要实现的目标：

文件 1 的内容如下：

```
.

.

.

get_time file 10 -max 5 -min 0 abcde

get_time file 9 -max 5 -min 0 abfdf

get_time file 9 -max 5 -avg 3 -min 0 xyyxx

get_time file 10 -max 5 -min 0 abcxx

.

.

. 
```

同时文件 2 只包含：

```
abcde 8

abfdf 8.5

xyyxx 7.5

abcxx 9

.

.

. 
```

我需要的是一个文件 3，它准确地打印出文件 1 中的内容，除了相应地替换第 3 列中的值。

所以输出应该是这样的：

```
.

.

.

get_time file 8 -max 5 -min 0 abcde

get_time file 8.5 -max 5 -min 0 abfdf

get_time file 7.5 -max 5 -avg 3 -min 0 xyyxx

get_time file 9 -max 5 -min 0 abcxx

.

.

. 
```

注意：文件 1 包含许多其他内容，其前后不以“get_time”开头。在上面的示例中，它们被标记为点。

谢谢你的帮助！

编辑：谢谢！快速跟进。另一个类似的文件有这样的东西：

```
get_time file123 tmp 10 -max 5 -min 0 abcde 

get_time file foo 9 -max 5 -min 0 abfdf 

get_time file43 bar 9 -max 5 -avg 3 -min 0 xyyxx 
```

你会如何修改你的脚本？再次感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:13:07.833

将文件 2 读入散列或字典，其中键是 5 个字母的标签。

一次读取文件 1 一行，将第三列中的值替换为根据行尾出现的标记在散列或字典中找到的值。

* * *

## Perl

```
#!/usr/bin/env perl
use strict;
use warnings;
use English qw( -no_match_vars );

my %times;

$OFS = " ";

open my $file, "<", "file2" or die "Failed to open file2 ($!)";
while (<$file>)
{
    my($key,$value) = split;
    $times{$key} = $value;
}
close $file;

while (<>)
{
    if (/^get_time file/)
    {
        my(@words) = split;
        my($keycol) = $words[$#words];
        $words[2] = $times{$keycol} if defined $times{$keycol};
        print @words, "\n";
        next;
    }
    print;
} 
```

我没有声称它是最高级的 Perl。考虑到它似乎确实有效：

### 文件 1

```
.X1X.
.X2X.
.X3X.
get_time file 10 -max 5 -min 0 abcde
get_time file 9 -max 5 -min 0 abfdf
get_time file 9 -max 5 -avg 3 -min 0 xyyxx
get_time file 10 -max 5 -min 0 abcxx
.X4X.
.X5X.
.X6X. 
```

### 文件2

```
abcde 8
abfdf 8.5
xyyxx 7.5
abcxx 9 
```

### 输出

```
.X1X.
.X2X.
.X3X.
get_time file 8 -max 5 -min 0 abcde 
get_time file 8.5 -max 5 -min 0 abfdf 
get_time file 7.5 -max 5 -avg 3 -min 0 xyyxx 
get_time file 9 -max 5 -min 0 abcxx 
.X4X.
.X5X.
.X6X. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T17:06:48.090

我想我会发布一个*最高级的 Perl*解决方案。;-)

```
#!/usr/bin/perl
use strict;
use warnings;
use Inline::Files;

my %data = map split, <FILE2>;

while (<FILE1>) {
    if (my ($key) = /^get_time file .+ (\w+)$/) {
        s/\d+/$data{$key}/ if exists $data{$key};
    }
    print;
}

__FILE2__
abcde 8
abfdf 8.5
xyyxx 7.5
abcxx 9
__FILE1__
.X1X.
.X2X.
.X3X.
get_time file 10 -max 5 -min 0 abcde
get_time file 9 -max 5 -min 0 abfdf
get_time file 9 -max 5 -avg 3 -min 0 xyyxx
get_time file 10 -max 5 -min 0 abcxx
.X4X.
.X5X.
.X6X. 
```

结果与乔纳森的解决方案相同。

**更新：** user1497417 询问如何解析一些与他在第一篇文章中想要更改的格式不同的格式。这 3 行是：

```
get_time file123 tmp 10 -max 5 -min 0 abcde
get_time file foo 9 -max 5 -min 0 abfdf
get_time file43 bar 9 -max 5 -avg 3 -min 0 xyyxx 
```

如果这些行中的任何一行需要执行替换，则脚本必须知道如何找到需要替换（或不替换）的数字。也许将替换行更改为：

```
s/\d+(?= -max)/$data{$key}/ if exists $data{$key}; 
```

这仍然没有考虑分数，但海报没有说明它们是否发生，如果是，是否也应该更换它们。所以，我暂时先不管它

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T19:01:09.737

为了完整起见，这里有一个 Python 3 中的解决方案：

```
with open("file2") as f:
    times = dict(line.split() for line in f)

with open("file1") as in_f, open("file3", "w") as out_f:
    for line in in_f:
        fields = line.split(" ")
        if fields[0] == "get_time":
            fields[2] = times.get(fields[7], fields[2])
            line = " ".join(fields)

        out_f.write(line) 
```

# facebook - 将 Facebook 应用程序集成到 Facebook 墙

> ID：11564920
> 
> 赞同：1
> 
> 时间：2012-07-19T16:10:07.773
> 
> 标签：facebook, facebook-apps

我计划开发一个免费的 facebook 应用程序。我需要知道是否可以将我的应用程序放在用户的墙上？

也许像一个图标或其他东西。当这个用户（我的应用程序的用户）的访问者点击他墙上的这个图标时，这个应用程序应该生成一个 jQuery 弹出窗口并显示一些信息。

你认为有可能吗？facebook 是否允许将第三方应用程序直接集成到用户墙上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:13:01.360

`og:image`唯一可行的方法是在用户的墙上发布指向您网站的链接（假设您已定义元标记）并让他们宣传您的应用程序。但是，这可能被认为是侵入性的，因此如果您希望留住用户，请远离这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T10:59:54.647

简短的回答是否定的。Facebook 删除了所有基于应用的个人资料页面定制。如果您的应用程序是画布应用程序，您的用户可以在他们的主页上为您的应用程序添加书签。

您可以在用户的​​ Facebook 墙上放置的最类似于应用程序的输出是一个 Flash 对象，它可以显示您想要的任何内容，并且在第一次单击后可以进行交互（想想在时间轴上播放的 youtube 视频）。如果您的用户将其固定在他们的时间线上，它将在两周内保持领先。要将 Flash 内容发布到提要，请使用`source`Post[对象](http://developers.facebook.com/docs/reference/api/post/)的属性。

# asp.net - 我可以同时拥有一个控制器和一个 ApiController 吗？

> ID：11564922
> 
> 赞同：16
> 
> 时间：2012-07-19T16:10:10.127
> 
> 标签：asp.net, .net, asp.net-mvc, wcf-web-api

我刚刚开始使用 VS 2012 RC，我正在创建一个 ASP.NET MVC 4 Web 应用程序，我计划在其中提供一个基于 HTML 的用户界面和一个基于 WebApi 的编程界面。

对于我的 HTML 网站，我的每个模型（MVC！）都有一个控制器和视图，并且路由“按约定”工作，例如，URL`/client`连接到我的`ClientController`. 我`ClientController`的派生自`Controller`.

对于我的 API，我将创建从`ApiController`. 我自然希望我的 API URL 类似于我的 HTML URL，所以我希望客户端信息可以在`/api/client`. 但是，使用约定俗成的路由，这表明我需要一个名为`ClientController`. 而且我已经`ClientController`上课了。

我该如何处理？我需要自定义路由吗？我是否将 API 类放在不同的命名空间中以便给它们起相同的名称？

**更新：**这个问题似乎表明我的 API 控制器需要一个不同的命名空间：[Mix web api controllers and site controllers](https://stackoverflow.com/questions/9353427/mix-web-api-controllers-and-site-controllers)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-01T22:28:20.497

它所需要的只是控制器类位于不同的命名空间中，一切都很好。

使用 MVC 区域也可以（正如 gordonml 的评论中所建议的那样），但这有效地将控制器置于不同的命名空间中，因此这是实现相同结果的更正式的方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T16:17:40.627

您可以查看[以下博客文章](http://weblogs.asp.net/fredriknormen/archive/2012/06/28/using-razor-together-with-asp-net-web-api.aspx)，该文章说明了 Api 控制器如何也可以为 Razor 视图提供服务。基本上他使用[RazorEngine](http://razorengine.codeplex.com/)来解析 Razor 视图并为其服务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-12-13T21:19:42.853

对于正在寻找有关如何在 WebApi 项目上执行此操作的分步指导的任何人：

1.  创建两个文件夹/命名空间，即：`ControllersApi`和`ControllersWeb`
2.  右键单击`ControllersWeb`并`Add -> Controller`选择`MVC 5 Controller - Empty`。如果您的 WebApi 项目中没有它们，这将添加所有其他依赖项。
3.  您`RouteConfig`现在将注册那些从`Controller`基类继承的类。您可能需要通过编辑默认值来添加指向默认控制器的链接：`defaults: new { action = "Index", controller = "Home", id = UrlParameter.Optional }`

就是这样，您现在可以运行站点并使用 API 和 Web 控制器。

# java - 在 Spring 上重新注册单例 bean

> ID：11564926
> 
> 赞同：5
> 
> 时间：2012-07-19T16:10:32.217
> 
> 标签：java, spring, unit-testing, mocking

我有一个多模块项目，其中每个模块都有自己的单元测试，并为该模块的类提供模拟。

我正在尝试构建一个应用程序上下文，其中每个模块都可以定义自己的模拟，但以后的单元测试将能够覆盖这些模拟，例如：

```
public class Test {

    private static final class StupidMock {
    }

    @org.junit.Test
    public void test() {
        StaticApplicationContext applicationContext = new StaticApplicationContext();
        final ConfigurableListableBeanFactory beanFactory = applicationContext.getBeanFactory();
        StupidMock stupidMock = new StupidMock();  // original mock
        beanFactory.registerSingleton(StupidMock.class.getName(), stupidMock);

        StupidMock f1 = applicationContext.getBean(StupidMock.class);
        if (f1 == null || f1 != stupidMock) {  // ensuring mock is retrievable
            fail("Could not get bean");
        }

        for (String names2Remove : beanFactory.getBeanNamesForType(StupidMock.class)) {
            applicationContext.removeBeanDefinition(names2Remove);  // <-- fails here 
        }

        StupidMock stupidMock2 = new StupidMock();     // replacement mock
        beanFactory.registerSingleton(StupidMock.class.getName(), stupidMock2);
    }
} 
```

问题是这个简单的片段在尝试删除第一个模拟时失败，声称没有这样的 bean（尽管 Spring 刚刚成功地为我提供了一个名称）。

如果我只是尝试在第一个模拟之上注册另一个模拟，Spring 会抱怨说已经有对象绑定。

`DefaultSingletonBeanRegistry`有一个`removeSingleton`受保护的方法，但我无法控制`StaticApplicationContext`. 无论如何，我都可以使用反射并调用这个受保护的方法，但是对于这样一个简单的任务来说这样做是错误的。

我究竟做错了什么？我怎样才能实现单例替换`StaticApplicationContext`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T17:59:26.570

这里的问题是 registerSingleton 方法实际上并没有创建相应的[BeanDefinition](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/beans/factory/config/BeanDefinition.html)，它只是注册实例化的单例，将其与您提供的名称相关联，并稍后通过应用程序上下文检索它 - 虽然它没有 BeanDefinition 底层。

因此，当您调用时，`applicationContext.removeBeanDefinition(names2Remove);`它会失败，因为没有[bean 定义](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/beans/factory/config/BeanDefinition.html)，只有注册的完全实例化的 bean。

解决方法是不使用 registerSingleton，而是使用一种使用 BeanDefinition 的 registerSingleton 形式：

```
Map<String, String> map = new HashMap<String, String>();
map.put("i", "10"); // set all the properties for the mock..
MutablePropertyValues propertyValues = new MutablePropertyValues(map);

beanFactory.registerSingleton(StupidMock.class.getName(), StupidMock.class, propertyValues); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-02T18:04:45.350

[您可以使用spring-reinject](https://github.com/sgri/spring-reinject)重新定义 bean 。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T16:37:04.957

如果您使用的是 Spring 框架，为什么不使用[Spring 测试框架](http://static.springsource.org/spring/docs/3.0.x/reference/testing.html)

您可以使用以下注释在每个单元测试的基础上进行特定的模拟

```
@ContextConfiguration
@RunWith(SpringJUnit4ClassRunner.class) 
```

# powershell - Copy-Item / Remove-Item 仅没有根文件夹的子内容？

> ID：11564933
> 
> 赞同：8
> 
> 时间：2012-07-19T16:11:16.533
> 
> 标签：powershell, powershell-2.0, powershell-ise

嗨，我正在努力解决以下问题 - 假设我有以下目录结构 C:\Temp\Test1 和 C:\Temp\Test2

我想做的是递归地将 C:\Temp\Test1 的子内容复制到 C:\Temp\Test2 而不复制实际文件夹 C:\Temp\Test1 ..如果我现在使用命令

```
Copy-Item C:\Temp\Test1 C:\Temp\Test2 -Recurse 
```

将导致 C:\Temp\Test2\Test1 并且没有参数组合似乎可以缓解问题

同样，当我希望删除 C:\Temp\Test2 中的所有子内容时，我希望只删除子内容而不是实际文件夹，例如

```
Remove-Item C:\Temp\Test2\ -Recurse 
```

正在删除 \Test2 文件夹。我已经尝试了这么多的参数变化 - 我怎样才能完成我想要做的事情？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-19T16:38:35.170

看一下[get-childitem](http://technet.microsoft.com/en-us/library/ee176841.aspx)命令。您可以在管道中使用它来复制或删除根文件夹下的所有项目：

```
# recursively copy everything under C:\Temp\Test1 to C:\Temp\Test2
get-childitem "C:\Temp\Test1" | % { 
    copy-item $_.FullName -destination "C:\Temp\Test2\$_" -recurse 
}

# recursively remove everything under C:\Temp\Test1
get-childitem "C:\Temp\Test1" -recurse | % { 
    remove-item $_.FullName -recurse 
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-07-19T10:32:35.090

```
 Copy-Item C:\Temp\Test1\* C:\Temp\Test2
    Remove-Item "C:\Temp\Test2\*" -recurse 
```

也有效:)

# django - 从管理页面（Django）更新模型后发送电子邮件

> ID：11564935
> 
> 赞同：2
> 
> 时间：2012-07-19T16:11:27.210
> 
> 标签：django, email, django-admin, django-views

您好，我想知道是否有办法在有人更新 Django 管理页面中的某些字段时向用户发送电子邮件。有没有办法做到这一点？我已经在表单完成后发送了一封电子邮件，但是一旦其中一个用户通过管理页面更新，我需要发送更多电子邮件。

我查看了 post_save、model_save 和 save_formset 方法，但我觉得它们不是我要找的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T16:19:07.443

尝试覆盖该[`ModelAdmin.save_model`](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#django.contrib.admin.ModelAdmin.save_model)方法。我认为它有你需要的所有信息的钩子。

该`change`变量使您可以区分用户添加或更改模型实例。

`form.changed_data`为您提供已更改字段名称的列表，让您确定是否发送电子邮件。

最后`request.user`确定进行更改的用户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T16:23:52.790

你需要`django.db.models.signals.post_save`信号。模型保存后正在打磨。

```
def my_callback(sender, **kwargs):
    # Your specific logic here
    pass

post_syncdb.connect(my_callback, sender=yourapp.models.TheModel) 
```

使用此信号发送的参数：

*   **发件人**：模型类。
*   **instance**：正在保存的实际实例。
*   **创建了** 一个布尔值；如果创建了新记录，则为真。
*   **raw** : 一个布尔值；如果模型完全按照呈现方式保存（即加载夹具时），则为真。不应查询/修改数据库中的其他记录，因为数据库可能尚未处于一致状态。

所以你只需要回调和发送者。

# css - @font-face 仅影响某些字符

> ID：11564940
> 
> 赞同：0
> 
> 时间：2012-07-19T16:11:46.380
> 
> 标签：css, fonts, font-face

使用自定义字体构建网站。从设计师那里得到 .ttf 文件。

CSS看起来像这样：

```
@font-face{
font-family:MenuFont;
src: url("http://www.website.com/assets/fontfile.ttf"); 
}

.divClass{font-family:MenuFont;} 
```

我试过他给我的几个不同的字体文件。其中一个根本没有出现。更奇怪的是，其中一些只影响某些字母。例如，插入一个文件只会使 O、R 的 C 和 P 使用正确的字体。我查了一下，跨浏览器的字母相同。

在萤火虫中，我可以看到整个字体，当我滚动字体文件 url 时，我的 Url 很好，浏览器正在获取字体。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:14:52.073

`font-face`使用 FontSquirrel生成正确的代码和所有需要的字体。见：[http ://www.fontsquirrel.com/fontface/generator](http://www.fontsquirrel.com/fontface/generator)

您将获得更扩展和兼容的`font-face`声明。像这样：

```
@font-face {
    font-family: 'Meran';
    src: url('../fonts/meran-normal-webfont.eot');
    src: url('../fonts/meran-normal-webfont.eot?#iefix') format('embedded-opentype'),
    url('../fonts/meran-normal-webfont.woff') format('woff'),
    url('../fonts/meran-normal-webfont.ttf') format('truetype'),
    url('../fonts/meran-normal-webfont.svg#Meran') format('svg');
    font-weight: normal;
    font-style: normal;
} 
```

# sas - 在 SAS 中清理地址的最佳方法

> ID：11564941
> 
> 赞同：2
> 
> 时间：2012-07-19T16:11:49.247
> 
> 标签：sas

我正在尝试清理位于 DB2 数据库中的大约 2000 万个地址（使用 ODBC、SAS EG 4.3 进行连接）。下面是一些示例代码。此代码运行了很长时间。有没有办法优化它？是否应该在 sql 步骤而不是数据步骤中尝试这样做（我不知道这是否会更快）？

```
%macro addy(orig_addy,edited_addy);
*scrub original address field;
addr=upcase(&orig_addy.);

addr=(left(tranwrd(cat(' ',addr,' '),' SO. ',' S ')));

addr=compress(addr,".,()'");
addr=translate(addr, ' ', '_/-#;');

&edited_addy.=left(prxchange('s/ NORTH / N /',-1,cat(' ',addr,' ')));
&edited_addy.=left(prxchange('s/ SOUTH / S /',-1,cat(' ',upcase(&edited_addy.),' ')));
&edited_addy.=left(prxchange('s/ EAST / E /',-1,cat(' ',upcase(&edited_addy.),' ')));
&edited_addy.=left(prxchange('s/ WEST / W /',-1,cat(' ',upcase(&edited_addy.),' ')));
&edited_addy.=left(prxchange('s/ NORTHWEST / NW /',-1,cat(' ',upcase(&edited_addy.),' ')));
&edited_addy.=left(prxchange('s/ SOUTHWEST / SW /',-1,cat(' ',upcase(&edited_addy.),' ')));
&edited_addy.=left(prxchange('s/ NORTHEAST / NE /',-1,cat(' ',upcase(&edited_addy.),' ')));
&edited_addy.=left(prxchange('s/ SOUTHEAST / SE /',-1,cat(' ',upcase(&edited_addy.),' ')));

&edited_addy.=left(prxchange('s/ SAINT / ST /',-1,cat(' ',upcase(&edited_addy.),' ')));
&edited_addy.=left(prxchange('s/   / /',-1,cat(' ',upcase(&edited_addy.),' '))); *tripple spaces;
&edited_addy.=left(prxchange('s/  / /',-1,cat(' ',upcase(&edited_addy.),' '))); *double spaces;
&edited_addy.=left(prxchange('s/ & / AND /',-1,cat(' ',upcase(&edited_addy.),' ')));
&edited_addy.=left(prxchange('s/ @ / AT /',-1,cat(' ',upcase(&edited_addy.),' ')));
&edited_addy.=left(prxchange('s/ INTERNATIONAL / INTL /',-1,cat(' ',upcase(&edited_addy.),' ')));
&edited_addy.=left(prxchange('s/ SUITE / STE /',-1,cat(' ',upcase(&edited_addy.),' ')));
&edited_addy.=left(prxchange('s/ SUITES / STES /',-1,cat(' ',upcase(&edited_addy.),' ')));
&edited_addy.=left(prxchange('s/ FLOOR | FLR / FL /',-1,cat(' ',upcase(&edited_addy.),' ')));
&edited_addy.=left(prxchange('s/ BUILDING / BLDG /',-1,cat(' ',upcase(&edited_addy.),' ')));
...
...
... 
```

现在，这运行了 20 小时，只进行了 200 万次观测。prxchange 条件比这里看到的要多得多。这只是一个示例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T09:46:34.380

您还可以尝试其他几件事。

*   以 /o 结尾的正则表达式告诉 SAS 只编译一次字符串，因此它不应该为每次观察处理它。
*   如果您确定某些/所有搜索只有 1 次匹配，那么将 -1 更改为 1 应该会加快速度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T14:47:59.560

将原始数据拉入 SAS（不运行任何正则表达式）需要多长时间？

如果上述操作很快，那么问题可能是正在发生的从 SAS 代码到 mySQL 代码的转换。我认为在 200 万个观察值上运行大量正则表达式根本不会花费太多时间，因为我之前已经经历过类似的过程，并且有更多的数据。

你可以把它分成2个步骤。

1.  将未修改的数据带入 SAS。
2.  让 sas 应用清洁程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T16:26:41.083

在 DATA 步骤中执行此操作应该没问题。它缓慢的原因是您要为每次观察处理数百次地址行的每个字符。（我认为如果正则表达式是常量，SAS 会预先解析它们，但如果不是，使用`PRXPARSE`可能会有所帮助。）

如果您所有的正则表达式都是 (word) -> (normalized word) 形式，那么您可以逐字执行并完全跳过正则表达式处理：

*   创建一个包含所有规范化的[哈希对象](http://support.sas.com/rnd/base/datastep/dot/hash-getting-started.pdf)（或[字符格式](http://www2.sas.com/proceedings/sugi27/p011-27.pdf)，如果你是老派）
*   将地址行拆分为单词
*   使用哈希对象规范化每个单词
*   重新加入地址

# zeromq - zmq 交换和 HWM

> ID：11564942
> 
> 赞同：0
> 
> 时间：2012-07-19T16:11:51.263
> 
> 标签：zeromq

来自文档

> ØMQ 提供了一种叫做“swap”的东西，它是一个磁盘文件，保存着我们无法存储到队列中的消息

在 HWM 达到的情况下溢出到交换的消息是否会在接收器返回 [with the identity] 或开始表现良好时发送到接收器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T11:36:30.437

来自[文档](http://api.zeromq.org/2-1%3azmq-setsockopt)

ZMQ_SWAP 选项应设置指定套接字的磁盘卸载（交换）大小。将 ZMQ_SWAP 设置为非零值的套接字可能会超过其高水位线；在这种情况下，未完成的消息应卸载到磁盘上的存储而不是保存在内存中

因此，消息将发送给接收方。我用它测试过

**PUSH 插座**

```
$sender = new ZMQSocket($context, ZMQ::SOCKET_PUSH);
$sender->setSockOpt(ZMQ::SOCKOPT_HWM, 1);
$sender->setSockOpt(ZMQ::SOCKOPT_SWAP, 1000);
$sender->connect("tcp://127.0.0.1:9090");

for ($i = 0; $i < 1000; $i++) {
     $sender->send($i);
    echo "message sent";
    usleep(100);
} 
```

和

**拉式插座**

```
<?php
$context = new ZMQContext();

$receiver = new ZMQSocket($context, ZMQ::SOCKET_PULL);
$receiver->setSockOpt(ZMQ::SOCKOPT_HWM, 25000);
$receiver->setSockOpt(ZMQ::SOCKOPT_SWAP, 25000);
$receiver->bind("tcp://127.0.0.1:9090");
$i = 0;
while (1) {
     $msg = $receiver->recv();
     echo "$i $msg \n";
     $i++;
} 
```

通过先启动 PUSH 套接字而不使用 PULLer

# javascript - 将包裹的元素保持在一起

> ID：11564943
> 
> 赞同：19
> 
> 时间：2012-07-19T16:11:56.553
> 
> 标签：javascript, html, css

我在 HTML 中有几个元素，我想在它们换行时保持分组。我认为答案在于一些 CSS（甚至可能是 JavaScript），但我不确定。例如，我有几个元素布局如下：

```
<label A><input A><label B><input B><label C><input C> 
```

发生的情况是用户有时会调整浏览器窗口的大小，我们最终会得到这样的结果：

```
<label A><input A><label B>
<input B><label C><input C> 
```

在上面的示例中，输入 B 不在其输入元素旁边。有没有办法将标签和输入分组以便它们包装在一起？我已经尝试过 div 并将元素放在一个带有“nowrap”的表中，结果好坏参半。我不介意换行，我只需要将标签和输入元素放在一起。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-19T16:17:10.343

尝试这样的事情：

```
<label>First Name:
    <input type="text">
</label>
<label>Last Name:
    <input type="text">
</label> 
```

并设置

```
label {
    display: inline-block;
} 
```

演示[http://dabblet.com/gist/3145028](http://dabblet.com/gist/3145028)

替代方案：将两者都包装`<label>`起来`<input>``<div>``display: inline-block`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-04-25T15:39:46.070

简单的答案是将元素包装到另一个具有 display: inline-block 样式的元素中。所以...

```
<span class='wrapper'>
  <span class='left-side'></span>
  <span class='right-side'></span>
</span> 
```

和

```
.wrapper {
  display: inline-block;
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-07-19T16:17:25.087

将所有这些元素放在一个 div 中，如下所示：

```
<div style="white-space: nowrap">
  ...
</div> 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-07-19T16:17:57.073

可能还值得考虑在您希望保持在一起的每一对周围设置父 div - 我知道您说过您尝试过这个，但也给它们一个固定的宽度和 display:inline; 它应该可以工作

还包括浮动：左/右；（仅选择一个）这样，如果浏览器窗口太小而无法并排显示它们，它将取而代之的是末端对并将其放到下一行，但应保留所有元素并排在一起。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-19T16:15:25.363

您可以将每个标签/输入组放在 a 中`<span>`，然后将 css 设置为`display:inline`. 我很确定这会使它保持分组。根据您的站点布局和以前的 CSS，您可能需要调整 span css。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-19T16:17:49.767

既然你说这是在一张桌子上，这可能就是你要找的东西：http: [//jsfiddle.net/DX9G7/](http://jsfiddle.net/DX9G7/)

HTML：

```
<table border="0" cellspacing="0" cellpadding="0">
    <colgroup>
        <col width="30%" />
        <col width="30%" />
        <col width="40%" />
    </colgroup>
    <tr>
        <td>
            <div class="form-row">
                <label>A</label>
                <input type="text" />
            </div>
            <div class="form-row">
                <label>B</label>
                <input type="text" />
            </div>
            <div class="form-row">
                <label>C</label>
                <input type="text" />
            </div>
        </td>
    </tr>
</table>​ 
```

您现在可以按照您想要的方式修改您的 css。

# c# - 有谁知道以恒定帧速率捕获网络摄像头视频的方法？

> ID：11564946
> 
> 赞同：1
> 
> 时间：2012-07-19T16:11:59.703
> 
> 标签：c#, webcam, video-capture, recording, frame-rate

好的，所以我在网络摄像头捕捉方面遇到了一些困难，我需要帮助来找到一种以一致的帧速率捕捉视频的方法。

我一直在使用 Aforge.AVIWriter 和 Aforge.VideoFileWriter，但无济于事，并且还在 Google 中输入了我能想到的任何相关短语。

我看过 DirectShowLib，但还没有发现它更准确。

视频必须具有至少 25fps 的帧速率，它还应与同时收集的其他数据同步显示。

我也尝试过无限循环：

```
 for (; ; )
        {
            if (recvid == false)
            {
                break;
            }
            if (writer.IsOpen)
            {
                Bitmap image = (Bitmap)videoSourcePlayer1.GetCurrentVideoFrame();
                if (image != null)
                {
                    writer.WriteVideoFrame(image);
                }
                Thread.Sleep(40);
            }

        } 
```

尽管这对于计时更准确，但用户可以看到 fps 在他们同时观看视频和查看数据时发生变化。

任何指示或提示将不胜感激，因为我想不出从这里出发的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:17:58.213

我可以看到的两个主要问题：

writer.write() 是否发生在单独的线程中？如果不是，则需要时间，因此时间可能不准确。

第二个 thread.sleep() 表示睡眠**至少**40 毫秒而不是**40**毫秒 .. 获得更好的结果将等待时间减少到 5 毫秒并循环执行.. 使用系统时间来实际计算多长时间您已经睡了，然后进行了帧捕获。

希望这可以帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T16:58:33.480

对于大多数网络摄像头（除了极少数例外和可以为您提供对捕获过程的精细控制的高端摄像头），您对摄像头帧速率没有足够的控制权。对于给定的操作模式，相机将以最大帧速率捕获帧流，尤其是。受限于分辨率和数据带宽，在低电平条件下可能会降低速率。

不可以`Thread.Sleep`帮助你，因为它太慢而且反应迟钝——为了捕捉 25 fps，硬件需要平稳运行，没有任何中断和明确的指令来“立即捕捉下一帧”，在一端推送新数据与您在另一端弹出捕获的帧一起排队。即使硬件不错，您通常也会延迟几个视频帧。

# linux - HeadlessException 在 RedHat 服务器上使用 docx4j xhtmlrenderer

> ID：11564950
> 
> 赞同：1
> 
> 时间：2012-07-19T16:12:10.070
> 
> 标签：linux, redhat, headless, docx4j, xhtmlrenderer

在 RedHat 服务器上`java.awt.HeadlessException`使用 a 时，我得到了a。`Docx4jReplacedElementFactory`有谁知道这个的解决方法？（除了运行 Xvfb）

我已经深入研究了堆栈跟踪，问题的根源是`java.awt.GraphicsEnvironment.getDefaultScreenDevice()`在无头环境中运行时会引发异常。*这是记录在案的：* “抛出：HeadlessException - 如果 isHeadless() 返回 true”（请参阅​​对[从 HeadlessGraphicsEnvironment.getDefaultScreenDevice 抛出的 java.awt.HeadlessException 的](https://stackoverflow.com/questions/4534400/java-awt-headlessexception-thrown-from-headlessgraphicsenvironment-getdefaultscr)评论）。

鉴于`getDefaultScreenDevice`按规定工作，使用 docx4j 时是否有另一种方法可以避免去那里？

查看 的来源`org.docx4j.org.xhtmlrenderer.util.ImageUtil.getGraphicsConfiguration`，我们看到：

```
private static GraphicsConfiguration getGraphicsConfiguration() {
    GraphicsEnvironment ge = GraphicsEnvironment.getLocalGraphicsEnvironment();
  -> GraphicsDevice gs = ge.getDefaultScreenDevice();
    GraphicsConfiguration gc = gs.getDefaultConfiguration();
    return gc;
} 
```

堆栈跟踪：

```
Cause details:
java.awt.HeadlessException
    at sun.java2d.HeadlessGraphicsEnvironment.getDefaultScreenDevice(HeadlessGraphicsEnvironment.java:82)
    at org.docx4j.org.xhtmlrenderer.util.ImageUtil.getGraphicsConfiguration(ImageUtil.java:119)
    at org.docx4j.org.xhtmlrenderer.util.ImageUtil.makeCompatible(ImageUtil.java:70)
    at org.docx4j.org.xhtmlrenderer.swing.AWTFSImage.createImage(AWTFSImage.java:38)
    at org.docx4j.org.xhtmlrenderer.swing.NaiveUserAgent.createImageResource(NaiveUserAgent.java:197)
    at org.docx4j.org.xhtmlrenderer.swing.NaiveUserAgent.getImageResource(NaiveUserAgent.java:167)
    at org.docx4j.org.xhtmlrenderer.docx.Docx4jReplacedElementFactory.createReplacedElement(Docx4jReplacedElementFactory.java:57)
[snip] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-23T22:50:37.503

你可以应用[这个最近的上游补丁](https://github.com/flyingsaucerproject/flyingsaucer/commit/25a28383cb8fdedd727cd260362d0aff3af2c457#flying-saucer-core/src/main/java/org/xhtmlrenderer/util/ImageUtil.java)

# segmentation-fault - Fortran 中 MPI_FINALIZE() 期间的分段错误

> ID：11564951
> 
> 赞同：1
> 
> 时间：2012-07-19T16:12:13.140
> 
> 标签：segmentation-fault, fortran, mpi, fortran90, memory-management

我在调用`MPI_FINALIZE()`Fortran 90 程序时遇到分段错误。虽然代码相当广泛，但我将发布伪代码并查看它是否引发任何标志。我有一种预感（但还没有尝试过）这*可能*是由于没有释放数组引起的？但是我不确定 - 在 Fortran 90 中未能解除分配数组会导致调用期间出现分段错误`MPI_FINALIZE`吗？

```
if(<rank 0>) then
  do iat = 1,natoms
    do il = 0, LMAX
      do im = -il,il
        <mpi_recv "rank_rdy"> ! find out which rank is ready for (at,l,m)
        <mpi_send "(iat,il,im)"> ! send (at,l,m) to the rank asking for it
      enddo
    enddo
  enddo
else ! other ranks send a 'ready' signal and recieve the (at,l,m) to optimize
  if(<rank 0 is not finished processing (at,l,m)'s>)
    <mpi_send "my_rank"> ! tell rank 0 that i am ready to receive
    <mpi_recv "(iat,il,im)"> ! recieve (at,l,m) from rank 0
    call optimize(iat,il,im) ! do work on (at,l,m)
  endif
endif

if(<rank 0>)
  <read temp files created by other ranks>
  <write temp files to one master file>
endif

print*, 'calling finalize'

call MPI_BARRIER(MPI_COMM_WORLD, ierr)
call MPI_FINALIZE() 
```

现在在输出中，除了与此问题无关的其他信息外，我还得到以下信息：

```
 calling finalize
 calling finalize
 calling finalize
 calling finalize
 calling finalize
 calling finalize

=====================================================================================
=   BAD TERMINATION OF ONE OF YOUR APPLICATION PROCESSES
=   EXIT CODE: 11
=   CLEANING UP REMAINING PROCESSES
=   YOU CAN IGNORE THE BELOW CLEANUP MESSAGES
=====================================================================================
APPLICATION TERMINATED WITH THE EXIT STRING: Segmentation fault (signal 11) 
```

即使我不打电话，我也会遇到同样的问题，`MPI_BARRIER`但我认为这可能会有所帮助。请注意，每个等级中都使用了一些数组，我不会费心解除分配，因为我在整个程序中都使用它们，所以我不担心内存泄漏或任何事情。`MPI_FINALIZE()`是否有可能由于在没有释放内存的情况下被调用而发生此段错误？

我将自己探索更多，但我想发布这个问题有几个原因：

1.  想知道这是否是调用时的已知问题`MPI_FINALIZE()`

2.  想*知道*调用`MPI_FINALIZE()`. 在内部，导致此段错误的原因是什么？

3.  我在网上搜索了高低，没有发现任何关于这个问题的信息，所以对于后人来说，这可能是一个在网上回答的好问题。

**编辑**：我忘了提到这一点，但是在串行运行时我无法复制这个问题。显然，我不做`(at,l,m)`串行分配。唯一的过程只是简单地遍历所有组合并逐一优化它们。我**没有**，但是解除分配我认为可能导致 MPI 问题的数组，并且我仍然没有遇到段错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T19:31:58.117

如果可用，应始终使用 Fortran 90 MPI 接口，而不是旧的 FORTRAN 77 接口。那就是你应该永远

```
USE mpi 
```

代替

```
INCLUDE 'mpif.h' 
```

两者的区别在于 Fortran 90 接口将所有 MPI 子例程放在一个模块中，因此会生成显式接口。这允许编译器在调用中进行参数检查，并在您省略参数时发出错误信号。

在 Fortran 的调用约定中，所有参数都按地址传递，而与它们的类型无关。这允许编译器生成对函数和子例程的正确调用，而无需像在 C 中那样需要原型。但这也意味着人们可以自由地将参数传递给预期`INTEGER`的数组，并且几乎所有 FORTRAN 77 编译器都会愉快地编译这样的代码或一个`REAL`可以传递比预期更少/更多的参数。有一些外部工具，通常以 C 工具的名称称为*linter*`lint`，可以解析整个源代码树，并可以查明此类错误以及编译器不关心的许多其他错误。为 Fortran 进行此类静态代码分析的工具之一是`flint`. Fortran 90 添加了接口以弥补 Fortran 容易出错的特性。

使用比预期更少的参数调用 Fortran 子例程可能会产生许多不同的不良影响，具体取决于架构，但在大多数情况下会导致崩溃，特别是如果省略的参数是输出参数。被调用的函数不知道传递的参数更少——它只是查看它的地址*应该在*哪里，并获取它在那里找到的任何地址。作为`ierr`是一个输出参数，将发生对该地址的写入。该地址很有可能不会指向与映射内存相对应的虚拟地址，并且操作系统将提供严重的分段错误。即使地址指向用户分配的内存中的某个位置，结果也可能是某些控制结构中的重要值被覆盖。如果这没有发生，那么有调用约定，其中被调用者清理堆栈帧 - 在这种情况下，堆栈指针将不正确地递增并且返回地址将与正确的完全不同，这几乎肯定会导致跳转到不可执行（甚至非映射）内存并再次导致分段错误。

# xcode - 带有默认日志颜色的 Xcode 调试控制台

> ID：11564952
> 
> 赞同：1
> 
> 时间：2012-07-19T16:12:13.263
> 
> 标签：xcode, debugging, colors, console

有没有办法在 Xcode 中为调试控制台的默认输出着色？我使用的是 SenTestCase，日志很难阅读。

我知道有像[LumberJack](https://github.com/robbiehanson/CocoaLumberjack)和[XcodeColors](https://github.com/robbiehanson/XcodeColors)这样的项目，但它们允许您将颜色添加到自己的输出中，而不是默认值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T16:45:26.263

Xcode 4 允许您更改不同类型控制台输出的颜色。只需转到首选项的字体和颜色部分，然后单击“控制台”选项卡：

![Xcode 颜色首选项](../Images/a4d42428b4ecb7ff06489ff263f00513.png)

这可能是也可能不是您正在寻找的...例如，您可以更改调试器输出的颜色以便于阅读，但您不能为特定类别的输出消息分配不同的颜色。

# javascript - 努力弄清楚为什么附加原始 HTML 会产生与使用 jQuery 创建 HTML 不同的结果

> ID：11564953
> 
> 赞同：1
> 
> 时间：2012-07-19T16:12:15.203
> 
> 标签：javascript, jquery, css

我有两个 jsFiddles：

*   [http://jsfiddle.net/kRyhw/3/](http://jsfiddle.net/kRyhw/3/)
*   [http://jsfiddle.net/kBMSa/1/](http://jsfiddle.net/kBMSa/1/)

第一个 jsFiddle 显示了采用 HTML 并将其附加到我的 ul 元素的代码。请注意，会出现 svg 的“X”图标。

我尝试使用 jQuery 的元素创建技术重写此代码，但路径从未出现。如果我用 .text("Hello") 替换附加的 iconPath 代码，我会看到 Hello 出现。不过，我没有看到两个版本之间的任何 CSS 差异。

有人可以阐明发生了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T16:25:06.000

使用浏览器的 innerHTML 属性将其解析为 HTML。innerHTML 无法解析 SVG 或其他非 HTML 内容...

我想这篇文章会给你的问题一些阴影。它有一个你正在寻找的例子。 [jquery 的追加不适用于 svg 元素？](https://stackoverflow.com/questions/3642035/jquerys-append-not-working-with-svg-element)

# c# - 尝试在会话 0 中显示 GUI

> ID：11564958
> 
> 赞同：4
> 
> 时间：2012-07-19T16:12:32.443
> 
> 标签：c#, windows

我到处搜索并尝试了几乎所有东西，我开始认为这是不可能的。我有一个在会话 0 (win7) 中作为 SYSTEM 运行的服务。我需要启动一个外部应用程序。如果我只是以 SYSTEM 身份启动外部应用程序，应用程序就会启动并且我可以看到 GUI（如果我使用 UI0Detect 单击会话 0）。除了我能够看到它之外，我启动应用程序的服务实际上可以截取 GUI 的屏幕截图并将其发送回我的服务器。- 在这一点上一切都很好。

问题 - 在某些情况下，不允许外部应用程序在 SYSTEM 上下文下运行。在这些情况下，我必须以其他用户身份启动。我在会话 0 中以实际用户身份运行另一个服务。然后我以该其他用户身份启动外部应用程序。外部应用程序在会话 0 中启动，我指定 WinSta0\Default 以确保应用程序 GUI 在我的 SYSTEM 服务可以看到的同一桌面上启动。当发生这种情况时，UI0Detect 会弹出给我的印象是我会点击并查看我的窗口。当我进入会话 0 或当我的服务尝试截屏时，只有一个小黑匣子。几乎就像只有 SYSTEM 帐户可以在会话 0 中呈现窗口 - 这是真的吗？有人知道在会话 0 中运行的用户帐户是否能够呈现 GUI？

我不是在寻找有关如何将应用程序从会话 0 启动到活动用户桌面的代码。这是有据可查的。我需要知道的是如何实现反向（有点）。我需要从 SYSTEM 以外的帐户在会话 0 中启动 GUI。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T19:46:45.343

来自[MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682450%28v=vs.85%29.aspx)：“如果服务类型指定 SERVICE_INTERACTIVE_PROCESS，则服务必须在 LocalSystem 帐户中运行。”

所以没有支持的方式来做你想做的事情。但是，可以通过让以 SYSTEM 身份运行的服务来更改相关桌面（可能还有窗口站）上的权限来使其工作。请记住，以这种方式共享桌面意味着如果有问题的应用程序或用户帐户遭到入侵，它可能会破坏系统帐户。

或者，您可以尝试在会话 0 中创建一个新桌面（具有适当的权限）并在那里启动应用程序。我不确定交互式用户是否能够看到此桌面，但您可以通过在同一桌面（最好在同一用户上下文中）启动另一个应用程序来代表您截取屏幕截图。

# .htaccess - htaccess 摘要认证

> ID：11564961
> 
> 赞同：4
> 
> 时间：2012-07-19T16:12:43.057
> 
> 标签：.htaccess, password-protection, digest-authentication, .htpasswd

我想通过.htaccess 保护一个文件夹。以下不起作用。它在浏览器中显示登录对话框，但看起来用户名和密码不匹配。当我将方法更改为基本时，它工作正常。

```
AuthUserFile /home/pass/.htpasswd
AuthName "Login"
AuthType Digest
Require valid-user 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-19T16:26:12.050

摘要式身份验证方法使用不同类型的密码文件。您不能使用为 BASIC 生成的密码文件与 DIGEST 一起使用。您需要使用[`htdigest`命令](http://httpd.apache.org/docs/2.2/programs/htdigest.html)（或一些等效的在线摘要文件生成器）来创建密码文件。

# c# - Twitter 访问令牌存储

> ID：11564976
> 
> 赞同：0
> 
> 时间：2012-07-19T16:13:18.110
> 
> 标签：c#, security, twitter, oauth

这个问题已经被问过很多次了，但我没有找到任何明确的答案。
我正在构建一个具有 twitter 访问权限的应用程序。
当然，我得到了这两个令牌，但因为我不想每次都要求用户授权我需要存储它们的应用程序。
**但是哪里 ？Cookie、会话、数据库 ??**
有人可以帮助我并告诉我这些方法的利弊。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T17:35:24.633

您希望将访问权限保留多长时间？如果它只是一个单一的交互，那么将它保持在一个会话中应该没问题。如果您想在较长时间内通过多次交互使用 cookie，那么将其存储在数据库中可能会更好。

我建议不要将它们存储在 cookie 中。如果用户从另一个浏览器或另一台机器登录，他们将被提示再次授权。然后存储在原始浏览器中的 cookie 中的令牌将不起作用。因此，对于用户来说，这将是一个令人困惑的体验。

# asp.net - 是否可以在 ASP.NET 中禁用 Firefox 的离线缓存（在服务器级别）？

> ID：11564979
> 
> 赞同：3
> 
> 时间：2012-07-19T16:13:31.123
> 
> 标签：asp.net, firefox, offline-caching

如何在 ASP.NET 或 IIS 中禁用 Firefox 的脱机缓存？我找到了这篇文章：

[从 ASP.NET 禁用所有浏览器的浏览器缓存](https://stackoverflow.com/questions/914027/disabling-browser-caching-for-all-browsers-from-asp-net)

这并不能完全解决问题。它只是禁用后退按钮的缓存（不在离线模式下）。

这是一个简单的场景：

如果用户 A 登录到他的银行。用户 A 正在做交易，他甚至去更新一些个人数据。最后，用户 A 完成并从他的银行网站注销。用户 A 让浏览器保持打开状态，因为他打开了另一个选项卡，正在下载一个需要几场演出的文件。用户 B 想继续使用他的电子邮件发送一些电子邮件，因此用户 A 没有关闭浏览器。他知道安全风险，因为他已经阅读了您注销站点后必须执行的操作，但他不想停止下载。对于用户 A，必须重新下载对他来说是太多时间了，而且他只是您的典型用户，并且不认为用户 B（作为他的好朋友）会做任何恶意的事情。因此，用户 B 使用浏览器。用户 B 做的第一件事是“离线工作”。用户 B 现在拥有用户 A 的所有数据。该页面有一个离线缓存供用户 B 查看。用户 B 现在可以打开历史记录来查看那些缓存的页面，或者如果页面保持打开状态，只需单击返回（无论哪种方式都有效）。用户 B 现在拥有用户 A 浏览过的所有页面。所以任何敏感数据现在都是他的。

有谁知道这是否可以在服务器级别进行控制。我知道在 Firefox 中您可以访问 about:config，但这不是服务器调整的选项。即便如此，这也可以告诉用户，但并不是每个用户都能做到这一点（对某些用户来说太复杂了），或者有些用户会因为懒惰而忽略警告，或者只是不阅读页面上的内容。我知道会有一个人会说，“哦，那是他们自己的错，他们应得的”。老实说，我认为这种意义上的无知不是用户的错。考虑一个 80 多岁的老人，他不以技术为中心（就像我父亲一样，我经常给他做和不做关于在线的事情，但他仍然没有真正完全理解风险）。

所以我再次重申，是否可以在服务器级别禁用这种离线缓存？我还发现了这个帖子：

[http://forums.asp.net/post/1386380.aspx](http://forums.asp.net/post/1386380.aspx)

这会有帮助吗？请提供任何帮助。请保持建设性，不要开始辩论。我想我已经很清楚了，我对此做了很多研究，没有运气。请注意，只有在 firefox 上的离线缓存才是问题所在，在其他所有浏览器（或 firefox onlinle）上，缓存已按预期被禁用。

**更新：**

我实际上已经有了最后一个链接的建议（[http://forums.asp.net/post/1386380.aspx](http://forums.asp.net/post/1386380.aspx)），但它仍然不能阻止问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-21T12:25:16.383

从服务器端禁用缓存是不可能的，因为服务器只能请求浏览器不存储在缓存中。休息取决于浏览器是否跟随它。

最好的选择是不要将数据发送到浏览器，因此它永远不会被缓存，而是使用 json/Xml 或任何你喜欢的东西按需获取它。

对我有用的唯一技巧是通过常规页面方法从加载中删除所有敏感信息，并在 window.ready 事件上通过 ajax/jquery 加载它。一旦我实现了回调和 ajax，后退按钮和“脱机工作”问题就得到了解决，但是通过 ajax 回调推出它确实是一项艰巨的任务。

# ios - 不确定如何在 ios 应用中管理数据

> ID：11564980
> 
> 赞同：0
> 
> 时间：2012-07-19T16:13:47.957
> 
> 标签：ios, oop, model-view-controller

我希望这个问题不是太笼统/模棱两可......

我正在编写一个 iphone 问答游戏应用程序，但无法找出处理数据的最佳方式。目前我正在考虑拥有一个模型类，该类包含一组“用户”类，每个类都有一组特定于用户的“问题”类。我希望能够从我的任何视图控制器访问总体模型，但这意味着我可能必须将模型对象传递给任何新的视图控制器、使用单例或做其他事情。从其他类访问我的模型对象的最佳方法是什么？我不确定的另一个因素是能否保存数据——我是否必须使用 Core Data/SQLite 来保存我的单个模型对象，还是有更简单的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T16:18:04.803

检查此链接，这将对您有很大帮助

链接：http: [//mobile.tutsplus.com/tutorials/iphone/iphone-sdk_store-data/](http://mobile.tutsplus.com/tutorials/iphone/iphone-sdk_store-data/)

这涵盖了在 iPhone 中存储数据的 4 种主要方法以及示例代码。

1)`NSUserDeafult`

2) 物业清单

3）SQLLite

4) 核心数据

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T16:32:44.090

我将从使用 CoreData 设计模式开始。IMO，最好从使用 CoreData 开始，因为如果您的应用程序扩展到一两个简单对象之外，您将永远不必将数据层转换为 CoreData。

另一种方法是创建一个返回数据的 Web 服务......所以你只需调用该服务，它就会返回一个用户对象的集合。您可以发送带有问题的整个对象图，或者创建另一个服务来返回特定用户的问题集合。如果您有一个方便的 Web 服务器，则此方法的扩展性最好，因为您不必依赖应用程序更新来将新问题输入您的系统。我仍然会使用 CoreData 来缓存结果......这样你就不会一直下​​载相同的信息。

因此，在访问 CoreData 对象时，我使用了一个单例的存储库类。这使得任何视图控制器都可以轻松获取存储库的实例并获取一些数据。类似的东西可能是这样的；

```
[[Repository defaultRepository] findFirst:[User class] 
                                           where:@"name == 'John'"] 
```

获取数据有很多冗余代码，因此将它们包装在一个对象中将有助于从视图控制器中获取所有讨厌的代码，例如谓词和排序。您可以看到我在 where 子句中利用 va_list 的位置，这样我就可以将该字符串直接注入到我的谓词中。以下是您可以实现的其他一些方法：

```
- (NSArray *) findAll:(Class)entity 
            sortByKey:(NSString *)key
            ascending:(BOOL)ascending;

- (NSArray *) findAll:(Class)entity 
            sortByKey:(NSString *)key 
            ascending:(BOOL)ascending
                where:(NSString *)format, ...;

- (id) findFirst:(Class)entity 
           where:(NSString *)format, ...; 
```

我不确定这是否是首选方式，但我已经用这种方法取得了很大的成功。希望这可以帮助！

# jquery - 在jquery中按值选择选项

> ID：11564986
> 
> 赞同：2
> 
> 时间：2012-07-19T16:14:12.333
> 
> 标签：jquery

我有 4 个选项：

```
<input type="radio" name="tag" value="1"/>
<input type="radio" name="tag" value="2"/>
<input type="radio" name="tag" value="3"/>
<input type="radio" name="tag" value="4"/> 
```

我在 jquery 中编写了一个上一页函数，它返回已选择的选项：

```
var option_selected = could be 1,2,3 or 4;

$('#previous').click(function (){

}); 
```

请告诉我，当我单击上一个按钮时，应该选择已选择的选项。我应该在这个函数中添加什么来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T16:23:37.760

尝试这个：

```
$('input:radio[name="tag"][value="' + option_selected + '"]').prop('checked', true); 
```

阅读**[`.prop()`](http://api.jquery.com/prop)**

### 一点解释：

`$('input:radio[name="tag"][value="' + option_selected + '"]')`选择`input[type=radio]`和等于。`name=tag` _`value``option_selected`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T10:13:23.693

**你可以试试！** 

```
$('input:[name="tag"],[name="radio"],[value="' + option_selected + '"]').prop('checked', true); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T16:15:40.670

```
$('input:radio[name="tag"][value="' + option_selected + '"]').prop('checked', true); 
```

# cakephp-2.0 - Ajax 分页追加元素而不是更新 id

> ID：11564995
> 
> 赞同：2
> 
> 时间：2012-07-19T16:14:59.017
> 
> 标签：cakephp-2.0

我正在开发 Cakephp 应用程序。我在这里想要的是创建 facebook 风格的分页。我仍然在简单排序上完成了 Ajax 分页。现在我的逻辑是我将创建下一个按钮。和渲染元素。Cakephp 将自己管理分页。但我的问题是将我的视图呈现到它在“更新”期间询问我的特定 div(ID)。我的dom风格是...

```
<div class="fb_style" id='1'></div>
<div class="fb_style" id='2'></div>
<div class="fb_style" id='3'></div>
<div class="fb_style" id='4'></div>
<div class="fb_style" id='5'></div>
<div class="fb_style" id='6'></div>
<div id='more button'>MORE BUTTON(ACTUALLY PAGINATOR NEXT LINK)</div> 
```

我想在 id=6 旁边渲染 div 或者我可以在 .fb_style:last 旁边说 我的分页示例代码...我只是希望附加到特定的 dom 元素。

```
$this->Paginator->_ajaxHelperClass = "Ajax";
$this->Paginator->Ajax = $this->Ajax;
$this->Paginator->options(array('update' => 'listID',
    'url' => array('controller' => 'poets', 'action' => 'index', $separator),
    'indicator' => 'loaderID')); 
```

如果我使用 Jquery 执行此操作意味着编写函数而不是其相当笨拙意味着我必须发送总记录，而不是手动验证限制，查看检查总记录是否相等或更多所以我使用上述逻辑移动让我知道它是否正确...或任何其他解决方案或指南。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T07:30:10.583

我使用了[无限滚动 JQuery 插件](http://www.infinite-scroll.com/infinite-scroll-jquery-plugin/)，它工作正常。这个 jquery 插件将为您提供自定义的内置事件，您可以使用这些事件将 Ajax 请求发送到控制器的方法。此外，如果它可以工作，那么您可以将它的 css 更改为看起来像 facebook 无限滚动功能。

这是[另一篇文章](http://www.netboy.pl/2010/06/infinite-scroll-cakephp/)，它将帮助您如何将它与 CakePHP 一起使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-31T09:47:37.723

使用 twitter 样式的分页，虽然你排序 ASC，而 facebook 和 twitter 排序 DESC，它仍然适用。

将第一个结果的 min_id 作为参数发送，并在 index() 中的条件中使用它，以便下一个请求将获得下一个结果块。

这比获取第 2 页更安全，因为可能同时添加了新记录，因此您会丢失记录或有重复记录（仅当您更改为 DESC 时适用，对于 ASC 订购，使用第 2 页是安全的）

```
'update' => 'listID' 
```

应该

```
'update' => '#listID' 
```

# sql-server - sqlite 和 sqlserver 与 dapper

> ID：11564998
> 
> 赞同：2
> 
> 时间：2012-07-19T16:15:13.923
> 
> 标签：sql-server, unit-testing, dapper, system.data.sqlite

我在 SQL Server 中使用 dapper，但在我的单元测试中使用 Sqlite 进行一些内存测试。

我有一堂课如下

```
public class Test
{
  public int ID {get;set;}
  public string Name 
} 
```

如果我使用带有 SQL Server 连接的 dapper 进行查询，它工作正常。

如果我使用带有 SQLite 连接的 dapper 进行查询，则会收到类型转换错误。基本上我需要将 ID 的类型更改为 long，而不是 int。

我不想在 SQL Server 中更改我的架构，所以我想知道该场景是否有解决方法。我尝试使用隐式强制转换为 long/int 创建和 ID 类，但这也失败了，而且我没有想法！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T15:24:52.663

This revolves around the fact that Dapper uses the GetValue method on the IDataRecord interface. The concrete class in the System.Data.SqlLite namespace probably map values differently than that of System.Data.SqlClient.

As @FelicePollano pointed out try changing the structure of the SQLLite table and see if that causes the concrete class in System.Data.SqlLite to map it differently.

Another option is to roll your own mapping using the FastExpando object Dapper returns and force it to convert the value to a Int.

```
IEnumerable<dynamic> results = Conn.Query("Select ID from SomeTable");

var testValue = new Test
{
    ID = Convert.ToInt32(Results[0].ID.ToString())
}; 
```

Not really a big fan of it because it could require a lot of code changes, but it can work.

Please note: That example code can throw a exception if the ID column is not an integer. You can use TryParse, but for the sake of brevity I didn't include it.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T16:21:06.460

尝试创建将 INTEGER 的长度指定为 4 个字节的 sqlite 表。也许这个问题也会有所帮助：[SQLite 整数数据类型（如 int、integer、bigint 等）有什么区别？](https://stackoverflow.com/questions/7337882/sqlite-and-integer-types-int-integer-bigint)