# StackOverflow 问答 000896000-000896999

# jquery - 当其中一个更改时，我如何获得所有其他下拉列表的值

> ID：896009
> 
> 赞同：1
> 
> 时间：2009-05-22T01:09:53.587
> 
> 标签：jquery

我正在尝试根据一组下拉列表中的值填充文本框。一旦用户更改下拉列表的值，我想获取包含在同一 div 中的所有其他下拉列表的值。在下面的示例中，我试图通过对话框在 gien div 中显示所有“选择”的值。当我运行下面的代码时，对话框根本不会被击中。

HTML：

```
<div id="cat1">
    <select id="sel1" >
      <option  value="abc" > abc </option>
      <option  value="def" > def </option>
    </select>

    <select id="sel2">
      <option  value="rst" > rst </option>
      <option  value="uvw" > uvw </option>
    </select>
</div>

<div id="additional">
<!-- more selects -->
</div> 
```

jQuery：

```
$(document).ready(function() {
    $("#sel1").change(function() {
        $(this).siblings('select').each(function() { 
                alert ('hi');  // does not even iterate
                alert($(this).val());
        });
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T01:17:39.140

您可以为 div 中的每个选择添加一个类吗？像这样：

```
<div id="cat1">
<select id="sel1" class="div1">
  <option  value="abc" > abc </option>
  <option  value="def" > def </option>
</select>

<select id="sel2" class="div1">
  <option  value="rst" > rst </option>
  <option  value="uvw" > uvw </option>
</select>
</div> 
```

然后jQuery可以这样做：

```
 $('.div1').each(function() { 
            alert ('hi');  // does not even iterate
            alert($(this).val());
    }); 
```

# jquery - 是否可以使用 jQuery.Support 检查 PNG 支持？

> ID：896014
> 
> 赞同：2
> 
> 时间：2009-05-22T01:13:56.030
> 
> 标签：jquery, css, cross-browser, png, transparency

我的问题是关于[jQuery 支持](http://docs.jquery.com/Utilities/jQuery.support)系统。

我想知道是否可以使用此方法判断浏览器是否支持半透明背景 PNG 图像。

编辑：我对特定问题的 CSS 解决方案不感兴趣。**我想知道 jQuery 支持检查系统是否可以检查这个**。我很欣赏这些建议，但我正在尝试找出有关`support`jQuery 功能的特定信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T01:19:43.037

我不使用Js来做这种事情......

我用

```
.png24 {
  background-image: url(png24.png);
}

/* ie6 */
* html .png24 {
 background-image: url(non-png24.png);

} 
```

jQuery 已弃用 jQuery 1.3 中的浏览器检查。我不确定他们什么时候会完全删除它。

我强烈建议将此检查留给 CSS 和/或[条件样式表](http://www.elated.com/articles/internet-explorer-conditional-comments/)。

在 JS 中没有办法在不检查浏览器的情况下检查支持 alpha 透明度的能力。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T03:39:20.263

我认为这根本不可能，毕竟即使IE6显示透明png，它只是不显示透明度；所有浏览器都“支持”png，因此您无法检查。

如果您可以获取页面上特定像素的颜色，当然可以，但似乎不可能做到。

另请参阅[Javascript - 从画布元素下的图像中获取像素数据？](https://stackoverflow.com/questions/680912/javascript-get-pixel-data-from-image-under-canvas-element)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T01:26:11.277

也许你可以只使用[jQuery pngFix](http://jquery.andreaseberhard.de/pngFix/)或[jQuery ifixpng](http://jquery.khurshid.com/ifixpng.php)？

如果这些都不行，我建议改为查看条件注释，如[MSDN](http://msdn.microsoft.com/en-us/library/ms537509.aspx#UsingCCs)中所述。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-02-07T13:05:10.133

我想我理解你在 TM 之后的意思，因为我正在尝试做类似的事情：如果支持 alpha PNG，请使用 jQuery 插入一个 PNG。否则，什么也不做。

我能想到的唯一解决方案是使用 jQuery 插入 DIV。然后，在 CSS 中，您将 DIV 的 background-iamge 设置为您想要使用的 PNG，然后使用条件注释来为 IE6 提供透明 gif。

我还没有尝试过，但它应该可以解决问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T01:48:59.220

用 javascript 修复 png 是不好的做法。你最终会得到一闪而过的无样式内容。CSS 和条件注释会是更好的选择。

你可以使用alex的方法。

# iphone - 通过 iPhone 提交链接 -> Facebook Connect

> ID：896027
> 
> 赞同：2
> 
> 时间：2009-05-22T01:20:04.177
> 
> 标签：iphone, objective-c, facebook

我正在尝试通过 iPhone facebook connect 发布链接，而不使用提要控件。我想模拟如何在 facebooks 网站上发布故事，我在其中传递一个链接，然后它返回一个图像、故事标题和一个链接。现在我只知道如何使用提要控件，但我认为必须有一种方法来使用可能的 stream.Publish 或 showDialog，只是不确定哪个..

有人对此有经验吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T03:12:08.537

使用 facebook 演示应用程序。

在 SessionViewController 中，添加此以获得扩展权限：

```
- (void)askPermission:(id)target {
  FBPermissionDialog* dialog = [[[FBPermissionDialog alloc] init] autorelease];
  dialog.delegate = self;
  dialog.permission = @"publish_stream";
  [dialog show];
} 
```

然后你需要一个方法来发布流。他们没有确切说明要发送什么数据。但是不管它是什么，您都将它打包在字典中。因为它是一个 URL，所以一个很好的猜测是一个 NSString。您可以从[API 页面获得更多信息](http://wiki.developers.facebook.com/index.php/Category:API_functions)

我发现了 5 个可能有效的方法：

Feed.publishActionOfUser Feed.publishStoryToUser Feed.publishTemplatizedAction Feed.publishUserAction

还有：

链接.post

但是你必须弄清楚，这取决于你想做什么。你还需要知道钥匙。我选了网址

```
- (IBAction)sendURL:(id)target{

    NSMutableDictionary *args = [[[NSMutableDictionary alloc] init] autorelease];
    [args setObject:urlString forKey:@"url"];  
    FBRequest *uploadPhotoRequest = [FBRequest requestWithDelegate:self];
    [uploadPhotoRequest call:@"Links.post" params:args];
} 
```

我遗漏了一些参数，但你明白了。我不确定你到底想要什么，所以你必须研究方法调用。

希望这可以帮助。

# silverlight - Silverlight 和语音 sdk

> ID：896029
> 
> 赞同：2
> 
> 时间：2009-05-22T01:21:34.953
> 
> 标签：silverlight, sdk, speech

我想让 Silverlight 阅读文本。我已经看到使用语音 SDK 完成了这项工作，有人知道 Silverlight 是否支持吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T01:43:24.410

我在 Silverlight 论坛上发现的这两个链接表明 Silverlight 不直接支持语音 SDK。建议的解决方案是创建一个执行 TTS（使用语音 SDK）的 ActiveX 对象，并让 Silverlight 与该 ActiveX 对象进行交互。

[http://silverlight.net/forums/t/5650.aspx](http://silverlight.net/forums/t/5650.aspx)
[http://silverlight.net/forums/t/51571.aspx](http://silverlight.net/forums/t/51571.aspx)

看起来微软可能已经有一个 ActiveX 对象。我对 ActiveX 编程不太熟悉，但看起来 Speech SDK 包含一个 ActiveX COM 对象。

[http://msdn.microsoft.com/en-us/library/ms997568.aspx](http://msdn.microsoft.com/en-us/library/ms997568.aspx)

# linux - 什么是在 linux 上进行 IO 测量和发现瓶颈的好工具？

> ID：896030
> 
> 赞同：3
> 
> 时间：2009-05-22T01:21:35.500
> 
> 标签：linux, io, performance, san

我正在尝试在基于 SAN 的基础架构上的 Linux 机器上对 Oracle 进行一些调整。我正在专门寻找可以让我们分析每个进程的 IO（或者每个进程树会更好）的工具。我的问题是？

*   为此类任务推荐哪些工具？
*   在基于 SAN 的基础架构上，我应该寻求衡量哪些其他有用的指标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T12:33:11.047

我使用“iotop”取得了很好的效果。它通过 IO 使用获取每个进程的特定信息。

它像“顶部”一样工作

[http://guichaz.free.fr/iotop/](http://guichaz.free.fr/iotop/)

我不确定从安装了 SAN 的 Linux 机器上使用是否合理，或者您是否想要一个可以在 SAN 内运行的工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T01:32:20.517

一旦你开始专业化，我发现最简单的事情是编写一些自定义脚本，从 /proc 下的文件中提取信息。

如果您正在进行分析，但您还没有工具可以为您提供所需的准确报告，那么您可能最终还是要编写一些脚本，而您在 Linux 下使用的大多数工具只是无论如何都要去 /proc 获取他们的信息，然后为您重新格式化。

如果您更关注数据库方面的事情，那么定期从 /proc 中提取信息、添加时间戳并以可以导入 RDBMS 的方式记录它会非常有用。如果您将所有服务器和进程性能信息放入单个 RDBMS 中，这会特别好，因为这样您就可以比较任意事物，例如不同服务器上相同应用程序的性能。

请记住，如果您进一步了解这一点，您将开始添加来自不同来源的信息，例如主机的 IPMI 监控，所以不要做您在使用超过 /proc 时必须撤消的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-25T13:56:44.087

您可以使用 sysstat 实用程序，它是 Linux 性能监控工具的集合。

来自网站 (perso.orange.fr/sebastien.godard/)

```
 * Can monitor a huge number of different metrics:

     1\. Input / Output and transfer rate statistics (global, per device, per partition, per network filesystem and per Linux task / PID)
     2\. CPU statistics (global, per CPU and per Linux task / PID), including support for virtualization architectures
     3\. Memory and swap space utilization statistics
     4\. Virtual memory, paging and fault statistics
     5\. Per-task (per-PID) memory and page fault statistics
     6\. Global CPU and page fault statistics for tasks and all their children
     7\. Process creation activity
     8\. Interrupt statistics (global, per CPU and per interrupt, including potential APIC interrupt sources)
     9\. Extensive network statistics: network interface activity (number of packets and kB received and transmitted per second, etc.) including failures from network devices; network traffic statistics for IP, TCP, ICMP and UDP protocols based on SNMPv2 standards; support for IPv6-related protocols.
    10\. NFS server and client activity
    11\. Socket statistics
    12\. Run queue and system load statistics
    13\. Kernel internal tables utilization statistics
    14\. System and per Linux task switching activity
    15\. Swapping statistics
    16\. TTY device activity
    17\. Power management statistics 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-04T15:13:30.173

我通常使用[atop](http://www.atcomputing.nl/Tools/atop/)来监控我的系统上的负载。某些功能需要您修补内核，但它会提供有关 I/O 以及其他信息的精确信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-12-04T15:20:20.330

> 在基于 SAN 的基础架构上，我应该寻求衡量哪些其他有用的指标？

CPU 负载。它是 oracle 数据库的主要指标。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-12-04T15:25:04.570

根据您想要获得的低级别，[System Tap](http://sourceware.org/systemtap/)可能对您非常有用。它类似于 Solaris 上的 DTrace。

# python - 如何从 python 启动交互式程序（如 gdb）？

> ID：896031
> 
> 赞同：1
> 
> 时间：2009-05-22T01:21:59.973
> 
> 标签：python, gdb

我要从 python 启动 gdb。

例如：

```
prog.shell.py:
    #do lots of things
    #
    #
    p.subprocess.Popen("gdb --args myprog", shell=True, stdin=sys.stdin, stdout=sys.stdout) 
```

但是 gdb 没有像我预期的那样被调用，与 gdb 的交互被破坏了。我也试过 os.system()，但还是不行。我可能做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T01:27:21.900

我想你的意思是

```
p = subprocess.Popen(...) 
```

您可能需要等待 p 完成：

```
p.wait() 
```

# ruby - 我如何说服 Rubygems (1.3.3) 我真的希望它安装依赖项？

> ID：896035
> 
> 赞同：2
> 
> 时间：2009-05-22T01:26:03.163
> 
> 标签：ruby, rubygems, gem

对于任何具有依赖关系的 gem，我都会得到以下信息（名称根据需要进行了更改）：

尝试1：

```
sudo gem install mojombo-jekyll -s http://gems.github.com/
ERROR:  Error installing mojombo-jekyll:
        mojombo-jekyll requires RedCloth (= 4.1.0, runtime) 
```

尝试2：

```
sudo gem install mojombo-jekyll -s http://gems.github.com/ -y
INFO:  `gem install -y` is now default and will be removed
INFO:  use --ignore-dependencies to install only the gems you list
ERROR:  Error installing mojombo-jekyll:
        mojombo-jekyll requires RedCloth (= 4.1.0, runtime) 
```

尝试 3：

```
sudo gem install mojombo-jekyll -s http://gems.github.com/ --include-dependencies
INFO:  `gem install -y` is now default and will be removed
INFO:  use --ignore-dependencies to install only the gems you list
ERROR:  Error installing mojombo-jekyll:
        mojombo-jekyll requires RedCloth (= 4.1.0, runtime) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T20:14:44.117

首先尝试安装 4.1.0 版本的 RedCloth gem。

```
sudo gem install RedCloth -v 4.1.0 
```

然后安装 mojombo-jekyll gem。

```
sudo gem install mojombo-jekyll -s http://gems.github.com/ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-13T01:28:31.230

问题与依赖无关，而是与源有关。如果您指定 '-s' 选项，rubygems 将仅使用该源或源。

> sudo gem install mojombo-jekyll -s [http://gems.github.com/](http://gems.github.com/) -s [http://gems.rubyforge.org](http://gems.rubyforge.org)

这将告诉 ruby​​gems 同时使用 ruby​​forge 和 github。大多数人倾向于采用将 gem 源添加到他们的环境中的方法，而不是每次都手动进行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T02:53:45.267

我相信它与[这个错误](http://rubyforge.org/tracker/index.php?func=detail&aid=21056&group_id=126&atid=575)有关。特别：

> 经过一些测试，我认为我在发生这种情况时缩小了范围：
> 
> 如果 gem foo 依赖于 gem bar（任何版本），那么安装 foo 也会安装它的依赖栏。
> 
> 如果 gem foo 依赖于 bar 1.0，并且 bar 1.0 是最新版本，那么安装 foo 也会安装 bar 1.0。
> 
> 如果 gem foo 依赖于 bar 1.0，但远程存储库中也存在 bar 1.1，gem install 会找到 bar 1.1 并抱怨缺少 bar 1.0。

RedCloth 4.1.0 是一个旧版本。似乎您的 gem 对 4.1.0 有**固定**的依赖关系，但 4.19 是最新版本，因此发生了不匹配。

# javascript - 如何合并 2 个 javascript 对象，如果属性不存在于另一个对象中，则将其填充到一个对象中？

> ID：896043
> 
> 赞同：20
> 
> 时间：2009-05-22T01:32:11.360
> 
> 标签：javascript, arrays, merge

如果我有一个 javascript 对象/关联。数组定义如下：

```
function somefunction(options) {

    var defaults = {
        prop1: 'foo',
        prop2: 'bar'
    };

    //Do stuff here

} 
```

我想用它作为函数的默认值。因此，当函数被调用时，我想`options`用 中的值填充变量`defaults`，但前提是它们不存在于`options`.

所以可以说这被称为

```
somefunction({ prop1: 'fish' }); 
```

我怎样才能让它与这样我得到这个`options`合并`defaults`

```
{
    prop1: 'fish',
    prop2: 'bar'
} 
```

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-05-22T01:34:46.110

重新阅读问题后，我意识到您可能正在寻找更像这样的东西：

```
var a = { 'foo': 'bar', 'baz': 'bat' };
var b = { 'foo': 'quux' };
for (var prop in a) {
    if (prop in b) { continue; }
    b[prop] = a[prop];
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-22T01:36:55.687

您可以查看 jQuery 或 Prototypes[扩展](http://docs.jquery.com/Utilities/jQuery.extend)功能。

它看起来像这样：（直接取自 jQuery）

```
jQuery.extend = jQuery.fn.extend = function() {
    // copy reference to target object
    var target = arguments[0] || {}, i = 1, length = arguments.length, deep = false, options;

    // Handle a deep copy situation
    if ( typeof target === "boolean" ) {
        deep = target;
        target = arguments[1] || {};
        // skip the boolean and the target
        i = 2;
    }

    // Handle case when target is a string or something (possible in deep copy)
    if ( typeof target !== "object" && !jQuery.isFunction(target) )
        target = {};

    // extend jQuery itself if only one argument is passed
    if ( length == i ) {
        target = this;
        --i;
    }

    for ( ; i < length; i++ )
        // Only deal with non-null/undefined values
        if ( (options = arguments[ i ]) != null )
            // Extend the base object
            for ( var name in options ) {
                var src = target[ name ], copy = options[ name ];

                // Prevent never-ending loop
                if ( target === copy )
                    continue;

                // Recurse if we're merging object values
                if ( deep && copy && typeof copy === "object" && !copy.nodeType )
                    target[ name ] = jQuery.extend( deep, 
                        // Never move original objects, clone them
                        src || ( copy.length != null ? [ ] : { } )
                    , copy );

                // Don't bring in undefined values
                else if ( copy !== undefined )
                    target[ name ] = copy;

            }

    // Return the modified object
    return target;
}; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-08-17T14:19:26.807

我是 PrototypeJS 的坚持者。我们的 Java 类型比 jQuery 更喜欢 PrototypeJS 的 OO 设计。以下是如何将两个 Object/Hash/Map 与 Proto 合并：

```
$H(obj1).merge(obj2).toObject() 
```

输入 obj1 和 obj2 不受影响。obj2 映射条目具有优先级（即 obj1 和 obj2 都具有相同的键，obj2 中该键的值将被覆盖）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T04:30:12.760

```
<html>
<head> 
<title>Testing</title>

<script type="text/JavaScript">
// The method is simpler than its demonstration:

function merge(obj1, obj2, force){
    for(var p in obj2){
        if(force || obj1[p]=== undefined) obj1[p]= obj2[p];
    }
    return obj1;
}

// demo:
var merge_demo= function(){
    // set up a to string method, just for the demo
    var restring= function(){
        var s= [];
        for(var p in this){
            s[s.length]= p+': '+this[p];
        }
        return '{ '+s.join(', ')+' }';
    }
    // define two objects
    var O1={
        a: 1, b: 2, c: 3
    }
    var O2={
        a: 10, b: 11, d: 4
    }
    // Begin demo, write the object contents to a string:
    var str= 'Object1='+restring.call(O1)+'\nObject2='+restring.call(O2)+'\n\n';

    //merge the two objects without overwriting values: 
    merge(O1, O2);

    // Update object contents in string:
    str+= 'merge(Object1,Object2)='+restring.call(O1)+'\n\n';

    //merge and replace existing values:
    merge(O1, O2, true);

    // Update and return string: 
    str+= 'merge(Object1,Object2,true)='+restring.call(O1);
    return str;
}
alert(merge_demo());
</script>
</head>

<body>
</body>
</html> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-19T21:29:02.483

使用 Google Closure Library 可以这样做：

```
goog.require('goog.object');
function somefunction(options) {
  var defaults = {
    prop1: 'foo',
    prop2: 'bar'
  };
  goog.object.extend(defaults, options);
  // if the property is defined in options it will overwrite value.
} 
```

# cocoa - 在 openfire 中注册新用户？

> ID：896054
> 
> 赞同：3
> 
> 时间：2009-05-22T01:37:32.753
> 
> 标签：cocoa, ldap, xmpp, messaging, openfire

无论如何通过 OpenFire 中的 HTTP 请求注册新用户。我希望用户能够从一个用可可编写的应用程序中注册我的消息服务。这个可以吗？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T01:41:37.673

查看 Web 管理控制台的创建用户页面 ( `http://<openfire-server>:<port>/user-create.php`)。它使用一个简单的 HTTP GET 表单来创建一个新用户。我想您可以从该页面的源中提取提交 URL 和各种必填字段，并从您的 Cocoa 应用程序构建您自己的 GET 请求。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-22T13:27:38.373

在 Openfire 中注册新用户的最简单方法是 UserService 插件。看看[http://www.igniterealtime.org/projects/openfire/plugins/userservice/readme.html](http://www.igniterealtime.org/projects/openfire/plugins/userservice/readme.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-29T06:05:02.933

您可以使用 openfire 管理控制台中提供的可用用户服务插件，选择插件选项卡，选择可用插件并单击绿色 + 按钮安装用户服务插件；其次，转到服务器选项卡->服务器设置页面，并确保启用用户服务插件![在此处输入图像描述](https://i.stack.imgur.com/FuePD.png)

希望这可以帮助其他人~~~~~~~~~~

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-03-16T18:04:11.310

您可以在 openfire 中使用 rest API 插件

转到插件然后转到可用插件然后添加rest API插件然后转到帮助页面或

[https://www.igniterealtime.org/projects/openfire/plugins/restapi/readme.html](https://www.igniterealtime.org/projects/openfire/plugins/restapi/readme.html)

您将获得所有其余 API 以在 openfire 中执行操作

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-23T00:44:38.470

[您可以使用XEP-77](http://xmpp.org/extensions/xep-0077.html)中指定的带内注册从您需要的 XMPP 连接添加帐户。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-02-11T04:00:40.087

在你的 openfire 服务器中查找 http-bind

[http://localhost:9090/http-bind.jsp](http://localhost:9090/http-bind.jsp)

我使用 strope js 客户端库很好地与我的 rails web 项目一起工作，所以我想你也可以使用自己的 xmpp 库在你的可可项目中实现它

# php - 在同一页面上显示 mysql 结果

> ID：896056
> 
> 赞同：0
> 
> 时间：2009-05-22T01:38:32.110
> 
> 标签：php, mysql, database

我习惯于使用 C# 和 ASP.NET，它们自动允许人们在请求它们的同一页面上立即显示数据库结果。

但是，我现在使用的是多年未编写过的 PHP。我在一个单独的页面中弹出了结果，因为表单标签的“操作”选项设置为该特定的 PHP 页面。不过，我需要在单击按钮的同一页面中显示这些结果。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T01:42:10.573

将“action”标签设置为当前页面，并将 POST 请求处理逻辑移动到该当前页面。

# jquery - 如何根据 HtmlHelper DropDownList 的选定值更改页面上的内容？

> ID：896058
> 
> 赞同：2
> 
> 时间：2009-05-22T01:39:13.870
> 
> 标签：jquery, asp.net-mvc, ajax, linq-to-sql, drop-down-menu

我正在使用 ASP.NET MVC，并希望根据所选的`HtmlHelper.DropDownList`. 我有一个管理页面，我想在该页面上显示给定学期的雇用员工列表，而无需重定向到另一个控制器。也许可以生成一个表或一个列表框填充这些用户。

在我的数据库中，我有一个包含学期列表的表，一个包含用户列表的表，以及另一个包含两个与 FK 相关的字段的表，这些字段将每个学期与为其雇用的所有用户联系起来。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T02:40:33.047

有一个返回包含标记的 PartialViewResult 显示的操作。您的下拉列表将以学期作为文本，将关联的数据库键作为值。将更改处理程序添加到下拉列表中，该处理程序执行 AJAX 获取呈现部分视图的操作并将学期键值作为 url 的一部分传递给方法。用 AJAX 查询的结果替换应该保存部分视图的容器。

**看法**

```
$(function() {
  $('#SemesterSelect').change( function() {
      $.get( '<%= Url.Action('ListEmployees') %>/' + $(this).val(), function(data) {
         $('#EmployeeList').html(data);
      },
      'html');
  });
});

<%= Html.DropDownList("SemesterSelect",
                        (IEnumerable<SelectListItem>)ViewData["Semesters"]) %>

<div id="EmployeeList"></div> 
```

**PartialView** （示例——IEnumerable 类型）

```
<ul>
<% foreach (var employee in Model)
   { %>
       <li> <%= employee.Name %> </li>
<% } %>
</ul> 
```

**控制器**

```
public ActionResult ListEmployees( int semesterID )
{
     var employees = db.... // query to get employees
     return PartialView("EmployeeList", employees)
} 
```

# c# - 如何在不提及派生类名称的情况下返回接口类型？

> ID：896061
> 
> 赞同：1
> 
> 时间：2009-05-22T01:41:38.233
> 
> 标签：c#, inheritance, interface, types

我正在寻找一种*不*引用类名但仍能达到预期效果的方法。我不能做 ITypedList.GetType() 因为它是一个接口。

```
public class DerivedList : ITypedList  
...  
public PropertyDescriptorCollection GetItemProperties()  
{  
    return TypeDescriptor.GetProperties(typeof(DerivedList));  
}  
... 
```

我想知道这是否可能。

干杯，
编辑：试图用没有提到它自己的类名的东西来替换它

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T02:08:19.757

绝对地 ...

```
 public PropertyDescriptorCollection GetItemProperties()
    {
        return TypeDescriptor.GetProperties(this);  
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T03:09:27.760

只需调用`GetType`当前实例：

```
return TypeDescriptor.GetProperties(this.GetType()); 
```

# python - 无法使用 pygame 创建游戏

> ID：896062
> 
> 赞同：0
> 
> 时间：2009-05-22T01:42:01.713
> 
> 标签：python, fonts, pygame

我用 python 2.5 和 pygame 制作了一个游戏。

但是，我无法完成制作。因为发生了这个错误。

```
C:\Python26\TypeType\src\dist\Main.exe:8: RuntimeWarning: use font: MemoryLoadLibrary failed loading pygame\font.pyd
Traceback (most recent call last):
  File "Main.py", line 8, in <module>
  File "pygame\__init__.pyo", line 70, in __getattr__
NotImplementedError: font module not available
Traceback (most recent call last):
  File "Main.py", line 8, in <module>
  File "pygame\sysfont.pyo", line 253, in SysFont
RuntimeError: default font not found 'freesansbold.ttf' 
```

也许我认为原因是因为它使用了一个名为 sysfont 的对象。（因为我的程序没有在执行文件上使用 sysfont 并且能够从没有安装 Python 的 PC 启动）出了什么问题。对不起，我是初学者。

**编辑** 我可以找到 Python2.5\Lib\site-packages\pygame\freesansbold.ttf

但是发生了同样的错误..我可以在哪里复制freesansbold.ttf

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-09T05:17:25.583

一个简单的解决方案是直接加载字体而不是使用 sysfont。只需使用 pygame.font.Font 类并直接加载一个 ttf 文件。这也将使 py2exe 的使用变得更容易，并且您可以准确地选择您想要的字体。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T01:49:52.353

您的计算机上的可访问字体文件夹中似乎没有该`freesansbold.ttf`文件。这个字体应该在 Pygame 的`lib`目录中。

检查您的 Pygame 副本的安装文件夹，如果存在，请修改 Python 安装的字体路径以包含该目录。如果没有，您需要找到一个副本或下载更新版本的 Pygame。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-19T13:20:55.190

您可能找到了解决方案，但我想给其他解决方案。用 pygame 创建你的游戏。然后，解压缩库文件。去

> PythonX.X\Lib\site-packages\pygame 并复制 freesansbold.ttf

返回您解压缩并转到的库文件

> 库\pygame

将 freesansbold.ttf 放入并压缩库。

现在，它的工作！:)

# objective-c - 我可以让 Textmate 完成忽略大写吗？

> ID：896065
> 
> 赞同：1
> 
> 时间：2009-05-22T01:42:58.903
> 
> 标签：objective-c, xcode, keyboard-shortcuts, textmate, textmatebundles

我已经使用`Textmate`了几年，但对于 Objective-C，我发现 Xcode 更容易。我喜欢 Xcode 的原因之一是我可以输入“nsui”，它会为我推荐 NSUInteger。如果我想在 Textmate 中做同样的事情，我必须输入“NSUI”，因为我想要的建议的开头都是大写的。如果大写不同，Textmate 将不匹配我想要的完成的开始。我喜欢 Textmate，但我的小指已经厌倦了一直按住 shift 键。

我猜 Textmate 中的补全来自捆绑包中的“Completions: Cocoa”。有没有办法关闭 Textmate 中的大小写敏感性，以便我可以输入“nsui”或“NSUI”并获得“NSUInteger”建议？

* * *

**编辑：**

看起来这是不可能的。我昨天通过了补全支持，可以从脚本中获取补全列表（我编写了一个脚本来从 dict/words 文件中提取可能的补全），但 textmate 似乎总是比较案例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T09:10:59.817

我不认为TextMate 是那么复杂。在包编辑器中，您可以创建一个插入 NSUInteger 并具有选项卡触发器“nsui”的片段。如果您希望它也适用于“NSUI”，请复制该片段。

# php - 我在哪里可以找到大型 php5 最佳实践项目？

> ID：896068
> 
> 赞同：2
> 
> 时间：2009-05-22T01:44:28.650
> 
> 标签：php, unit-testing, design-patterns, dependency-injection

我试图找到一个包含几乎所有语言每天都在讨论和辩论的“最佳实践”的项目，但我试图专注于 php5。

有没有我可以梳理的 php5 开源项目，以查看示例单元测试、依赖注入和其他最佳实践的项目的工作示例

我基本上是在研究一个新的大型项目，并希望看到一个辉煌的示例项目，而不是无休止地争论的代码片段。由于这个项目不会继承一大堆遗留代码，我真的想从一开始就做好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T09:26:56.233

看来您正在寻找[Zend Framework 之](http://framework.zend.com/)类的东西！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-27T23:29:09.160

也可以查看[Kohana 框架](http://kohanaphp.com)。事实上，大多数流行的框架都有很棒的 PHP 代码。对于 Wordpress、osCommerce 等，我不能说同样的话。 Magento 似乎还可以，也许有点过度设计。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-14T05:40:04.173

以下是一些具有良好 php 标准的库的列表

```
Laravel - PHP Framework with tons of goodies
Guzzle - CURL library
PHPUnit - PHP Testing Framework
Carbon - DateTime handling library
Faker - For generating fake data 
```

还有更多，以下链接将为您提供更多帮助

[https://github.com/uhub/awesome-php](https://github.com/uhub/awesome-php)

# delphi - 如何使用 Delphi 5 创建 Telnet 客户端

> ID：896069
> 
> 赞同：3
> 
> 时间：2009-05-22T01:44:34.780
> 
> 标签：delphi, client, telnet, delphi-5

如何在 Delphi 5 应用程序中创建 Telnet 客户端？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-22T03:16:06.750

**Francois Piette 的ICS**（Internet Component Suite）有一些有用的组件：

[http://www.overbyte.be/eng/products/ics.html](http://www.overbyte.be/eng/products/ics.html)

它将为您提供 telnet 协议支持、终端仿真器和一些帮助您编写脚本的东西。它易于使用，而且全部免费。

从网站：

*   **TTnCnx** - TELNET 客户端协议支持。

*   **TEmulVT** - ANSI 终端仿真（类似于 TMemo，但具有 ANSI 转义序列解释）。

*   **TTnEmulVT** - TELNET 和 ANSI 终端仿真组合成一个组件。只需几行代码，您就可以构建一个完整的 telnet 客户端程序。

*   **TTnScript** - TELNET 脚本组件。用于自动处理 telnet 会话（例如自动登录和密码）。

还有一些示例应用程序来展示如何使用它：

*   **TnClient** - 具有 ANSI 终端仿真的全功能 TELNET 客户端程序。

*   **TnDemo** - 使用 TMemo 显示传入数据的 TELNET 客户端。

*   **TnSrv** - 一个基本的事件驱动服务器。可以支持任意数量的并发客户端。任何现实世界服务器的基础。另请参阅 TcpSrv、MtSrv（多线程）和 MidWare 以获得完整的客户端/服务器框架。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-22T10:54:16.800

Internet Direct (Indy) 和 Synapse 包括 Telnet 类。

两者都可以在 Delphi 到 2009 版（以及 Free Pascal）上正常工作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-22T09:30:54.173

看看 SourceForge 上的 AsyncPro（之前来自 Turbopower）。它具有出色的传真、调制解调器和通信支持，但请注意，它仅适用于 D2009 之前的所有 Delphi（它不是 unicode）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-22T22:36:16.373

另一个效果很好的选项是[Synapse](http://www.ararat.cz/synapse/doku.php) ，它包含易于扩展和修改的完整源代码。作者网站上的 SVN 链接提供的最新版本已更新并支持 Delphi 2009，以及免费的 pascal/Lazarus。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T03:12:21.530

加上 tcp/socket 编程，你必须了解 telnet 协议是如何工作的，你可以参考 RFC(request for comment) 文档

这是 telnet 规范 [telnet 规范](http://www.faqs.org/rfcs/rfc854.html) 和[旧的 telnep 协议 rfc](http://www.faqs.org/rfcs/rfc318.html)

对于非常纯的 delphi telnet 客户端/守护程序代码，请检查[此包](http://www.torry.net/samples/samples/soft/kolsocket.zip)（基于 KOL）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T02:24:50.707

telnet 应用程序可以通过简单地通过套接字发送字符串来完成。使用 Delphi 的 TSocket**** API。

# ruby - RubyVM 中的 putspecialobject 操作码是如何工作的？

> ID：896078
> 
> 赞同：0
> 
> 时间：2009-05-22T01:49:36.813
> 
> 标签：ruby, opcode, vm-implementation

我正在研究 RubyVM 的实现，并且我到处搜索有关操作码的一些文档，但无济于事。

如果有人具体知道`putspecialobject`操作码是如何工作的，或者只是一个指向一些完整文档的链接，我将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-08-30T07:23:21.160

来自 insns.def：

```
DEFINE_INSN putspecialobject (rb_num_t value_type) () (VALUE val)
{
  开关（值类型）{
    案例 VM_SPECIAL_OBJECT_VMCORE：
      val = rb_mRubyVMFrozenCore;
      休息;
    案例 VM_SPECIAL_OBJECT_CBASE：
      val = vm_get_cbase(GET_ISEQ(), GET_LFP(), GET_DFP());
      休息;
    默认：
      rb_bug("putspecialobject insn: 未知 value_type");
  }
}

```

在哪里：

```
VM_SPECIAL_OBJECT_VMCORE = 1
VM_SPECIAL_OBJECT_CBASE = 2

```

换句话说，如果参数为 1，`rb_mRubyVMFrozenCore`则被压入堆栈，这是一个在 VM 启动早期创建的对象，它实现了一些语言特性作为方法：

```
set_method_alias(klass,:new,:old) 别名 new old
set_variable_alias(:$new,:$old) 别名 $new $old
undef_method(klass,:foo) undef foo
define_method(klass,:foo,&block) def foo ... end
define_singleton_method(obj,:foo,&block) def obj.foo ... end
set_postexe(&block) END { ... }

```

如果参数为 2，则当前*类上下文*的类/模块被压入堆栈。那是常量被解析并生效的词法`def`范围`alias`。它也是作为“klass”传递给上述方法的类。

所以

```
定义富
  ...
结尾

```

编译为：

```
[:putspecialobject, 1],
[:putspecialobject, 2],
[:putobject, :foo],
[:putiseq, [...]],
[:send, :"core#define_method", 3, nil, 0, nil]

```

这就是我可以逆向工程的能力，这对这段代码来说并不容易。

# javascript - 如何判断 $(window).load()/window.onload 事件是否已经触发？

> ID：896083
> 
> 赞同：12
> 
> 时间：2009-05-22T01:51:54.610
> 
> 标签：javascript, jquery, onload

我有一个通过另一个脚本动态插入的脚本。该脚本中的代码包含在`$(window).load()`事件中，因为它要求页面上的图像已全部加载。在某些浏览器中它可以正常工作，但在其他浏览器中它似乎不会触发，因为在代码运行时页面已经完成加载。

有什么方法可以检查页面是否已经完成加载 - 通过 jQuery 或 JavaScript？（包括图片）

在这种情况下，我无法访问`onload`原始文档的事件（除了通过加载的脚本更改它 - 但这似乎会出现同样的问题）。

任何想法/解决方案/建议将不胜感激！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-22T03:05:37.393

您可以尝试设置一个通过超时调用的处理程序，该处理程序将检查图像以查看它们的属性是否可用。清除`load`事件处理程序中的计时器，这样如果加载事件首先发生，计时器将不会触发。如果属性不可用，则 load 事件尚未触发，您知道您的处理程序最终将被调用。如果是，那么您知道加载事件发生在您的处理程序设置之前，您可以简单地继续。

伪代码

```
 var timer = null;
 $(function() {
    $(window).load( function() {
        if (timer) {
           clearTimeout(timer);
           timer = null;
        }
        process();
    });
    timer = setTimeout( function() {
        if (checkAvailable())
           process();
        }
    }, 10*1000 ); // waits 10 seconds before checking
 });

 function checkAvailable()
 {
     var available = true;
     $('img').each( function() {
         try {
             if (this.height == 0) {
                available = false;
                return false;
             }
         }
         catch (e) {
             available = false;
             return false;
         }
      });
      return available;
  }

  function process() {
      ... do the real work here
  } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-10-16T15:57:57.700

我写了一个可能有用的插件：http: [//plugins.jquery.com/project/window-loaded](http://plugins.jquery.com/project/window-loaded)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T01:58:24.240

我认为如果您使用 $(document).ready 而不是 $(window).load，您的问题会自行解决 - 请参阅[jquery 文档](http://docs.jquery.com/Events/ready)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-07-29T14:41:35.213

你们应该阅读以下内容：

[http://web.enavu.com/daily-tip/daily-tip-difference-between-document-ready-and-window-load-in-jquery/](http://web.enavu.com/daily-tip/daily-tip-difference-between-document-ready-and-window-load-in-jquery/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T01:59:44.580

不知道这是否是您所追求的，但您是否尝试过（？）：

```
$(document).ready(function(){
    ...
}); 
```

[http://docs.jquery.com/Events/ready#fn](http://docs.jquery.com/Events/ready#fn)

# asp.net-mvc - 如何在 URL 路由中划分 URL 参数？

> ID：896087
> 
> 赞同：1
> 
> 时间：2009-05-22T01:54:36.663
> 
> 标签：asp.net-mvc, url-routing

我将如何为这样的场景设置 URL 路由：

www.website.com/[项目名称]/News/Submit/[可能的额外参数]

[项目名称] = 操作将需要的变量来指定哪个项目新闻 = 控制器提交 = 操作 [可能的额外参数] = id

我还没有遇到任何关于如何做到这一点的例子。任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T04:36:52.470

```
routes.MapRoute("myroute", "{projectname}/{controller}/{action}/{id}", new { id = "" }); 
```

然后您的操作方法将有一个项目名称和一个 id 参数。

如果您的问题是如何使用多个实际的 Web 应用程序进行路由，那么您就处于另一个世界 :)

# api - Magento API：将预先存在的简单产品分配给可配置产品

> ID：896089
> 
> 赞同：10
> 
> 时间：2009-05-22T01:56:33.323
> 
> 标签：api, magento, product, stock, catalog

我有一个包含大量库存商品的客户数据库，这些商品作为简单产品上传到 Magento。

现在我需要将它们分组并将它们分配给可配置的产品，它们的尺寸和颜色是它们的可配置属性。

Magento API 有一个 Product_Link 类，它有一个看起来很有前途的方法：catalogue-product-link.assign ( [link](http://www.magentocommerce.com/wiki/doc/webservices-api/api/catalog_product_link#catalog_product_link.assign) )，但我一生都无法弄清楚我需要什么参数才能使它与可配置产品一起工作，提供这就是 assign 的用途。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-08-17T09:41:57.820

好吧，这里的笔记帮助我完成了这项工作。因此，我想与您分享将简单产品添加到现有可配置产品的代码。

这段代码假设简单的产品是一个有效的添加，我不确定如果不是会发生什么。

```
private function _attachProductToConfigurable( $_childProduct, $_configurableProduct ) {
   $loader = Mage::getResourceModel( 'catalog/product_type_configurable' )->load( $_configurableProduct );

   $ids = $_configurableProduct->getTypeInstance()->getUsedProductIds(); 
   $newids = array();
   foreach ( $ids as $id ) {
      $newids[$id] = 1;
   }

   $newids[$_childProduct->getId()] = 1;

   $loader->saveProducts( $_configurableProduct->getId(), array_keys( $newids ) );                
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-22T14:51:10.220

Scimon 接受的答案中的代码在最近版本的 magento 中不再起作用（至少在 1.7 中）。但幸运的是，您只需要一个小修复就可以让它再次工作：

```
private function _attachProductToConfigurable( $_childProduct, $_configurableProduct ) {
   $loader = Mage::getResourceModel( 'catalog/product_type_configurable' )->load( $_configurableProduct, $_configurableProduct->getId() );

   $ids = $_configurableProduct->getTypeInstance()->getUsedProductIds(); 
   $newids = array();
   foreach ( $ids as $id ) {
      $newids[$id] = 1;
   }

   $newids[$_childProduct->getId()] = 1;

   //$loader->saveProducts( $_configurableProduct->getid(), array_keys( $newids ) );                
   $loader->saveProducts( $_configurableProduct, array_keys( $newids ) );                
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-18T23:59:43.657

我现在正在做这件事。

到目前为止，我发现这些项目作为参考很有帮助：

*   [http://snippi.net/magento-programmatically-add-configurable-product-color-api](http://snippi.net/magento-programmatically-add-configurable-product-color-api)
*   [http://www.omnisubsole.com/blog/2009/07/01/configurable-products-in-magento.html](http://www.omnisubsole.com/blog/2009/07/01/configurable-products-in-magento.html)
*   [http://www.magentocommerce.com/boards/viewthread/6941/P30/](http://www.magentocommerce.com/boards/viewthread/6941/P30/)

到目前为止，我将发布我的代码，并希望在它工作后对其进行更新..

```
// Set 'item_size' as the super attribute  # choose your own attribute!
// this is the 'choose-able' field that differenciates products
$super_attributes=array( Mage::getModel('eav/entity_attribute')
  ->loadByCode('catalog_product','item_size')
  ->getData('attribute_id')
  );  
$product_collection=Mage::getModel('catalog/product')->getCollection();

// Fetch configurable orders
$product_collection->addFieldToFilter('type_id',Array('eq'=>"configurable"));
#$product_collection->addFieldToFilter('sku',Array('eq'=>"ASMCL000002"));  

$product_collection->addAttributeToSelect('*');

$count=0;
foreach($product_collection as $product) {
  $sku = $product->getSku();
  echo "SKU: $sku\n";

  $simple_children_collection = Mage::getModel('catalog/product')->getCollection();
  $simple_children_collection->addAttributeToSelect('*');
  $simple_children_collection->addFieldToFilter('sku',Array('like'=>$sku . "-%"));
  echo "children: ";
  foreach($simple_children_collection as $child) {
      $child_sku = $child->getSku();
      echo "$child_sku ";
      #visiblity should be 'nowhere'
  }
  echo "\n";

if (!$product->getTypeInstance()->getUsedProductAttributeIds()) {
  # This is a new product without the Configurable Attribue Ids set
  $product->getTypeInstance()
    ->setUsedProductAttributeIds( $super_attributes );

  //$product->setConfigurableAttributesData(array($_attributeData));
  $product->setCanSaveConfigurableAttributes(true); # Not sure if this is needed.

  $product->setConfigurableProductsData(''); # Use this to add child products.

}

  $count++;

  try {
      $product->save();
      $productId = $product->getId();
      echo $product->getId() . ", $sku updated\n";
  }
  catch (Exception $e){
      echo "$sku not added\n";
      echo "exception:$e";
  }

}
echo "\nCount is $count\n"; 
```

好的，这使用“item_size”作为区分“简单”产品的属性。此外，这假定“可配置”父 SKU 是子 SKU 的根。例如，ABC001 是父级，而 ABC001-SMALL 和 ABC001-LARGE 是简单的子级。

希望对某人有所帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-15T15:54:40.160

我这是一个没有受过教育的猜测，但我认为你的要求不能用现有的 API 完成。您必须自己编写或直接访问数据库。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-11-14T00:31:54.903

这是我直接用 PHP 做的 hack-y 方式。有三个相关的表。我使用颜色和大小作为我的属性。我的父产品（可配置）实际上并不存在于我的目录中。它们本质上是模型级别，然后产品是 SKU 级别。所以 LIKE 'parentproductsku%' 适合孩子们。

```
$query1 = "SELECT * FROM mage_catalog_product_entity WHERE type_id= 'configurable'";
    //Find the parent id
    $statusMessage = "Ok, found a product with a confgurable attribute";
    $result1 = $this->runQuery($query1, "query1", $statusMessage);
    while ($row1 = mysql_fetch_assoc($result1)) { //entering the first loop where products are configurable
        $this->parentId = $row1['entity_id'];
        $this->parentSku = $row1['sku'];

        echo "The SKU was $this->parentSku" . "<br />";

    //insert these into the link table for association
    $query2 = "SELECT * FROM mage_catalog_product_entity WHERE type_id= 'simple' AND sku LIKE '" . $this->parentSku . "%';";
    // find the child ids that belong to the parent
    $statusMessage = "Found some children for $this->parentSku";
    $result2 = $this->runQuery($query2, "query2", $statusMessage);
    while ($row2 = mysql_fetch_assoc($result2)) {//entering the second loop where SKU is like model sku
        $this->childId = $row2['entity_id'];
        $this->childSku = $row2['sku'];

        echo "Now we're working with a child SKU $this->childSku" . "<br />";

        //"REPLACE INTO catalog_product_super_attribute SET product_id='".$product->entity_id."', attribute_id='".$attribute->attribute_id."', position='".$position."'";
        $query3 = "REPLACE INTO mage_catalog_product_super_attribute  (product_id, attribute_id, position) VALUES ('" . $this->childId . "', '76', '0');";
        $message3 = "Inserted attribute for color for ID $this->childId SKU $this->childSku";
        $result3 = $this->runQuery($query3, "query3", $message3);

        $query4 = "REPLACE  INTO mage_catalog_product_super_attribute_label (product_super_attribute_id, store_id, use_default, value) VALUES (LAST_REPLACE_ID(), '0', '0', 'Color');";
        $message4 = "Inserted attribute for Color  SKU $this->childSku ID was $this->db->insert_id";
        $result4 = $this->runQuery($query4, "query4", $message4);

        $query5 = "REPLACE  INTO mage_catalog_product_super_attribute  (product_id, attribute_id, position) VALUES ('" . $this->childId . "', '529', '0');";
        $message5 = "Inserted attribute for Product Size SKU $this->childSku";
        $result5= $this->runQuery($query5, "query5", $message5);

        $query6 = "REPLACE  INTO mage_catalog_product_super_attribute_label (product_super_attribute_id, store_id, use_default, value) VALUES (LAST_REPLACE_ID(), '0', '0', 'Size');";
        $message6 = "Inserted attribute for Size SKU $this->childSku ID was $this->db->insert_id";
        $result6 = $this->runQuery($query6, "query6", $message6);

        $query7 = "REPLACE INTO mage_catalog_product_super_link (product_id, parent_id) VALUES ('" . $this->childId . "', '" . $this->parentId . "');";
        $message7 = "Inserted $this->childId and $this->parentId into the link table";
        $result7 = $this->runQuery($query7, "query7", $message7);

        $query8 = "REPLACE INTO mage_catalog_product_relation (parent_id, child_id) VALUES ('" . $this->parentId . "', '" . $this->childId . "');";
        $message8 = "Inserted $this->childId and $this->parentId into the link table";
        $result8 = $this->runQuery($query8, "query8", $message8);

        } //end while row 2 the child ID

            } //end while row 1 the parent id 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-06-07T04:07:05.793

令人惊讶的是，如果您所有的简单产品价格相同，这很有效：

```
 $childProducts = $configurable->getTypeInstance(true)->getUsedProductIds($configurable);

        // Don't add this product if it's already there
        if(!in_array($child->getId(), $childProducts)) {    
            $childProducts[] = $child->getId();
        }

        $existingIds = $configurable->getTypeInstance(true)->getUsedProductAttributeIds($configurable);
        $newAttributes = array();

        foreach($configurable->getTypeInstance(true)->getSetAttributes($configurable) as $attribute) {

        if(!in_array($attribute->getId(), $existingIds) && $configurable->getTypeInstance(true)->canUseAttribute($attribute)
            && $child->getAttributeText($attribute->getAttributeCode())) {

            // Init configurable attribute
            $configurableAtt = Mage::getModel('catalog/product_type_configurable_attribute')
                ->setProductAttribute($attribute);

            // Add new attribute to array
            $newAttributes[] = array(
               'id'             => $configurableAtt->getId(),
               'label'          => $configurableAtt->getLabel(),
               'position'       => $attribute->getPosition(),
               'values'         => $configurableAtt->getPrices() ? $configurable->getPrices() : array(),
               'attribute_id'   => $attribute->getId(),
               'attribute_code' => $attribute->getAttributeCode(),
               'frontend_label' => $attribute->getFrontend()->getLabel(),
            );
        }
    }

    if(!empty($newAttributes)) {

        $configurable->setCanSaveConfigurableAttributes(true);
        $configurable->setConfigurableAttributesData($newAttributes);
    }
        $configurable->setConfigurableProductsData(array_flip($childProducts));
        $configurable->save(); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-05-03T13:49:28.480

@aeno 的解决方案对我不起作用，所以我对其进行了一些改进。这已经使用通过该 `Mage::getModel( 'catalog/product' )->load()`方法实例化的产品进行了测试。

```
private function _attachProductToConfigurable( $childProduct, $configurableProduct )
{
    $childIds   = $configurableProduct->getTypeInstance()->getUsedProductIds();
    $childIds[] = $childProduct->getId();
    $childIds   = array_unique( $childIds );

    Mage::getResourceModel( 'catalog/product_type_configurable' )
        ->saveProducts( $configurableProduct, $childIds );
} 
```

# visual-studio - 如何在 SVN+Visual Studio 环境中本地使用 Git

> ID：896092
> 
> 赞同：4
> 
> 时间：2009-05-22T01:58:40.853
> 
> 标签：visual-studio, svn, git, git-svn

我一直在家里玩 git，我真的很喜欢本地提交的想法。能够提交较小的更改而不将我可能损坏的代码传播给每个人都很好，并且由于更频繁的提交而能够恢复较小的更改。

我一直在阅读 git-svn 命令，但我不确定我是否完全理解它是如何工作的。我们处理 Visual Studio 2008 项目，并运行 VisualSVN，它在 IDE 中为我们处理文件重命名、移动以及所有这些。

我想知道的是：我是否可以提交到本地 git 存储库，但也可以提交到远程 SVN 存储库？我想在 IDE 中保持 VisualSVN 更改跟踪和提交，但也能够使用 git 临时存储更改。他们有可能互相妨碍吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T02:34:56.490

它工作得很好。大胆试试吧。只是不要将您的 .git 文件夹检查到 svn 中。

编辑：呃，当我这样做的时候，我不打扰 git-svn。我只是将 svn 的本地工作目录视为任何其他目录，并且我倾向于不太关心以前的 SVN 历史。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T02:39:08.120

我已经使用 git-svn 从远程存储库中保持“更新”，但没有使用它来提交到 svn 存储库，所以我无法帮助你解决这部分问题。

您所做的很简单，所有设置都是默认设置：

```
>git svn init <url......>
>git svn fetch 
```

当你这样做时，它会将它提取到一个名为“git-svn”的“远程”分支。要将其与您当前的分支合并：

```
>git merge git-svn 
```

如果您*事后*使用 git-svn，您可能会遇到一些问题。我的意思是：您已经使用 svn 签出项目，然后您还在本地工作 svn 目录中创建了一个 git 存储库。然后你在上面使用 git-svn。

我必须处理的两个问题：

1.  行尾。`svn`可能会将行尾转换为窗口，同时`git-svn`会将它们保留为 unix 样式。因此，由于行尾差异，您可能会遇到大量冲突。

    所以可以肯定的是，使用工具将所有文件的行尾转换为 unix（或 windows，取决于 svn repo 中使用的行尾）。

2.  svn 关键字扩展。例如`$Id$`

    `git-svn`不会扩展这些关键字，而`svn`会。所以你也会在那里发生冲突。同样，使用工具（或编写脚本）将所有实例转换`$Id .......crap.....$`为 $Id$`

# java - 设计：Java 中的电子邮件系统

> ID：896093
> 
> 赞同：0
> 
> 时间：2009-05-22T01:58:42.023
> 
> 标签：java, design-patterns, email, decorator

我正在为我正在开发的框架构建一个电子邮件系统。到目前为止，我已经有了一个通用的 MailMessage 接口，每种不同类型的电子邮件都将实现它，类似于

```
public interface MailMessage {
    public String[] getTo();
    public void setTo(String[] to);
    public String getFrom();
    public void setFrom(String from);
    ...
    // you can guess the setters/getters here
    ...
} 
```

然后，我得到了一个 SimpleMailMessage，这正是您所期望的接口的简单实现（没有加密或编码，只是纯文本）。

我创建了一个用作抽象工厂的 MailMessageFactory 接口。我有一个 SimpleMailMessageFactory，它实现了工厂来生成 SimpleMailMessage 的实例。

我希望框架发送的一种电子邮件类型是警报邮件，它本质上是一封常规邮件，除了主题行前缀为“[Alert]”（另一种可能是包含“列表”的电子邮件）订购物品，但我不确定将列表转换为电子邮件的字符串的责任在哪里）。我可以将 SimpleMailMessage 子类化并将 setSubject(String subject) 方法覆盖为类似

```
public class AlertMailMessage {
    ...
    public void setSuject(String subject) {
        this.to = "[Alert]" + to;
    }
    ...
} 
```

或者我可以创建一个装饰器：

```
public abstract class EmailDecorator implements MailMessage {
    protected MailMessage email;
    ...
    // delegate all implemented methods to email
    ...
}

public class AlertEmailDecorator extends EmailDecorator {
    public void setSubject(String subject) {
        email.setSubject("[Alert]" + subject);
    }
} 
```

或者我可以委托在 SimpleMailMessageFactory 中添加“[Alert]”字符串。

对我有什么想法？我认为问题在于我可能过于周到和前瞻性，但我想要完美的设计。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T02:04:03.290

装饰器似乎是更好的选择。但是，您为什么要为 Java 编写自己的电子邮件框架？为什么不直接使用 JavaMail API？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T03:33:28.867

对我来说，装饰师似乎是一个更好的选择。我在想，您可能需要附加您的主题行，`Fwd:`或者`Re:`您可能需要支持签名，您将在电子邮件正文中添加签名。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T06:22:34.323

听起来就像 Spring 对 JavaMail 的支持一样。不要重新发明轮子，使用已经存在的、经过验证的解决方案，并在此基础上进行构建。

# jsp - 将标签等放在属性文件中是否是一种反模式（与 JSP 和 Web 开发有关）

> ID：896095
> 
> 赞同：5
> 
> 时间：2009-05-22T01:58:59.713
> 
> 标签：jsp, jakarta-ee, anti-patterns

我看到很多 J2EE 开发人员将标签放在属性文件中，但不使用不同的语言环境。所以，你会得到很多缺失的属性异常。最主要的是它使调试和读取 JSP 页面变得困难。因此，随着时间的推移，您将拥有数千行可能与 JSP 文件一起使用或不使用的属性文件。

对我来说，这似乎是一个糟糕的设计，特别是如果您不打算使用具有不同语言的属性文件并根据区域设置更改为英语或法语。

我只是想知道您是否有同感，是否有 J2EE/JSP 反模式的列表或 URL。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-02-09T13:54:06.763

将内容与模板分离始终是一种很好的做法。这样，您就不需要为每个愚蠢的上下文更改/错字/打嗝重建、重新部署和/或重新启动整个事情。[API（在 JSTL 的taglib](http://java.sun.com/products/jsp/jstl/1.1/docs/tlddocs/fmt/tld-summary.html)和其他 i18n/l10n taglibs[`ResourceBundle`](http://java.sun.com/javase/6/docs/api/java/util/ResourceBundle.html)后面使用的标准）足够[智能](http://java.sun.com/javase/6/docs/api/java/util/ResourceBundle.Control.html#needsReload%28java.lang.String,%20java.util.Locale,%20java.lang.String,%20java.lang.ClassLoader,%20java.util.ResourceBundle,%20long%29)，可以在每次更改时动态地重新加载资源文件（至少，如果您使用的是 JDK 1.6 或更新版本，它[内置了这些增强功能](http://java.sun.com/developer/technicalArticles/javase/i18n_enhance)）。[`fmt`](http://java.sun.com/products/jsp/jstl/1.1/docs/tlddocs/fmt/tld-summary.html)

此外，每当您想使用 i18n 或想要从属性文件更改为数据库表或其他内容时，您无需更改模板即可从中提取内容——如果您这样做，您会更加痛苦之后。

将模板中的内容和位置相互关联只是一点工作，我可以想象这是开发人员/维护人员的主要恐惧。我自己编写键，以便它们大致匹配`pagename.parentid.elementtype.elementname.contenttype`（大致；并非所有键都是必需的，但它给出了一个想法），因此它已经立即清楚它属于哪里。

例如`home.login.label.username.tooltip`，指向 a 的键`home.jsp`：

```
<form id="login">
    <label for="username" title="${text['home.login.label.username.tooltip']}"> 
```

始终如一地保持这个约定，你会发现维护这一切变得更加容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T06:35:10.263

将标签放在属性文件中绝对是一个好习惯。即使你现在不打算国际化，这也可能在未来发生。它还可以帮助您在页面中使用一致的命名。

我不知道您为什么会遇到财产异常。在大多数框架中，如果未找到用户区域设置的属性文件，系统将读取默认（英语）文件。

您需要习惯于使用从外部属性文件读取的字段来读取 JSP 页面。这并不难，而且好处远远超过了麻烦。

# wcf - 使用 WCF 在运行时确定 wsHttpBinding

> ID：896098
> 
> 赞同：0
> 
> 时间：2009-05-22T02:02:42.653
> 
> 标签：wcf, wcf-binding, wcf-client

我有一个使用 WCF 和 wsHttpBindings 公开 Web 服务的 Web 应用程序。可以在不同的机器和不同的 url 上安装应用程序。这意味着每个 WCF 服务位置都不同。

我正在构建一个 Windows 服务，它将引用每个应用程序并执行一项任务。每个任务都需要调用 Web 应用程序上的服务。我知道绑定都是在 app.config 中设置的，但是有没有更简单的方法来动态调用服务，或者我将如何构建 app.config？

```
<webApplication WebServiceUrl="http://location1.com/LunarChartRestService.svc" />
<webApplication WebServiceUrl="http://location2.com/LunarChartRestService.svc"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T05:10:09.620

您的客户端的配置文件可能如下所示：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <system.serviceModel>
    <client>
      <endpoint name="Endpoint1"
                address="http://location1.com/LunarChartRestService.svc"
                binding="wsHttpBinding"
                contract="(whatever-your-contract-is)" />
      <endpoint name="Endpoint2"
                address="http://location2.com/LunarChartRestService.svc"
                binding="wsHttpBinding"
                contract="(whatever-your-contract-is)" />
      <endpoint name="Endpoint3"
                address="http://location3.com/LunarChartRestService.svc"
                binding="wsHttpBinding"
                contract="(whatever-your-contract-is)" />
    </client>
  </system.serviceModel>
</configuration> 
```

然后在代码中，您可以根据其名称创建这样的端点（客户端代理），因此您可以选择您需要的任何位置。也没有什么能阻止您创建多个客户端代理！因此，您可以使用多个客户端代理连接到多个服务器端点，没问题。

Alternatively, you can of course also create an instance of "WsHttpBinding" and "EndpointAddress" in code, and set the necessary properties (if any), and then call the constructor for the client proxy with this ready made objects, thus overriding the whole app.config circus and creating whatever you feel is needed:

```
EndpointAddress epa = 
    new EndpointAddress(new Uri("http://location1.com/LunarChartRestService.svc"));
WSHttpBinding binding = new WSHttpBinding(); 
```

Marc

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T02:07:45.297

根据您的描述，听起来好像所有服务器都公开了相同的服务合同。如果是这样，您可以在 web.config 中声明多个[端点](http://msdn.microsoft.com/en-us/library/ms731762.aspx)，并在运行时根据端点名称选择一个。

当然，您可能不想处理 WCF 配置的那部分，而宁愿只拥有一个更简单的 URL 列表并完成它。这也是完全可能的；您只需要在代码端做更多的工作来实例化客户端代理/通道对象。

# c++ - 将 char 数组缓冲区转换为字符串的好方法？

> ID：896103
> 
> 赞同：12
> 
> 时间：2009-05-22T02:04:41.653
> 
> 标签：c++

我对 C++ 比较陌生。最近的任务要求我将大量字符缓冲区（从结构/套接字等）转换为字符串。我一直在使用以下变体，但它们看起来很尴尬。有没有更好的方法来做这种事情？

```
#include <iostream>
#include <string>

using std::string;
using std::cout;
using std::endl;

char* bufferToCString(char *buff, int buffSize, char *str)
{
    memset(str, '\0', buffSize + 1);
    return(strncpy(str, buff, buffSize));
}

string& bufferToString(char* buffer, int bufflen, string& str)
{
    char temp[bufflen];

    memset(temp, '\0', bufflen + 1);
    strncpy(temp, buffer, bufflen);

    return(str.assign(temp));
}

int main(int argc, char *argv[])
{
   char buff[4] = {'a', 'b', 'c', 'd'};

   char str[5];
   string str2;

   cout << bufferToCString(buff, sizeof(buff), str) << endl;

   cout << bufferToString(buff, sizeof(buff), str2) << endl;

} 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-22T02:26:54.993

鉴于您的输入字符串不是以空值结尾的，您不应该使用 str... 函数。您也不能使用常用的[`std::string`构造函数](http://en.cppreference.com/w/cpp/string/basic_string/basic_string)。但是，您可以使用此构造函数：

`std::string str(buffer, buflen)`: 它需要一个`char*`和一个长度。（实际`const char*`和长度）

我会避免使用 C 字符串版本。这将给出：

```
std::string bufferToString(char* buffer, int bufflen)
{
    std::string ret(buffer, bufflen);

    return ret;
} 
```

如果您确实必须使用该`C-string`版本，请`0`在该`bufflen`位置（如果可以）放置 a 或创建一个缓冲区`bufflen+1`，然后`memcpy`将缓冲区放入其中，并`0`在末尾（`bufflen`位置）放置 a。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-22T02:48:56.367

如果数据缓冲区中可能包含 null ('\0') 字符，则您不想使用以 null 结尾的操作。

您可以使用采用 char*、length 的构造函数。

```
char buff[4] = {'a', 'b', 'c', 'd'};
cout << std::string(&buff[0], 4); 
```

或者您可以使用采用范围的构造函数：

```
cout << std::string(&buff[0], &buff[4]); // end is last plus one 
```

不要将 std::string(buff) 构造函数与上面的 buff[] 数组一起使用，因为它不是以空值结尾的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T02:10:02.733

std::string 到 const char*：

```
 my_str.c_str(); 
```

char* 到 std::string:

```
 string my_str1 ("test");
  char test[] = "test";
  string my_str2 (test); 
```

甚至

```
 string my_str3 = "test"; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T03:36:07.090

该方法需要知道字符串的大小。您必须：

1.  在 char* 的情况下，将长度传递给方法
2.  如果 char* 指向以空字符结尾的字符数组，您可以使用最多为空字符的所有内容
3.  对于 char[]，您可以使用模板来计算 char[] 的大小

1) 示例 - 对于您传递 bufflen 的情况：

```
std::string bufferToString(char* buffer, int bufflen)
{
    return std::string(buffer, bufflen);
} 
```

2) 示例 - 对于缓冲区指向以空字符结尾的字符数组的情况：

```
std::string bufferToString(char* buffer)
{
    return std::string(buffer);
} 
```

3) 示例 - 对于传递 char[] 的情况：

```
template <typename T, size_t N>
std::string tostr(T (&array)[N])
{
    return std::string(array, N);
}

Usage:
char tstr[] = "Test String";
std::string res = tostr(tstr);
std::cout << res << std::endl; 
```

对于前两种情况，您实际上不必创建新方法：

```
 std::string(buffer, bufflen);
 std::string(buffer); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T02:10:42.013

```
std::string buf2str(const char* buffer)
{
    return std::string(buffer);
} 
```

要不就

```
std::string mystring(buffer); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T02:49:30.470

使用采用大小的字符串构造函数：

> ```
> string ( const char * s, size_t n ); 
> ```
> 
> 内容被初始化为由 s 指向的字符数组中的前 n 个字符组成的字符串的副本。

```
cout << std::string(buff, sizeof(buff)) << endl; 
```

[http://www.cplusplus.com/reference/string/string/string/](http://www.cplusplus.com/reference/string/string/string/)

C 字符串的非空终止缓冲区：

```
memcpy(str, buff, buffSize);
str[bufSize] = 0; // not buffSize+1, because C indexes are 0-based. 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2016-04-14T11:32:18.087

字符串值（reinterpret_cast（缓冲区），长度）；

# .net - 是否允许在开始和结束 XML 标记之间出现的内容中出现未编码的撇号？

> ID：896105
> 
> 赞同：1
> 
> 时间：2009-05-22T02:06:24.223
> 
> 标签：.net, xml, rss

在尝试编写 RSS 阅读器时，如果 RSS 提要中的开始和结束标记之间出现未编码的撇号，我遇到了 .NET XML 阅读器引发异常的问题。

我想知道，.NET 2.0 中的 XMLReader 是否不完全符合标准？还是我遇到了某人错误地实现了提要生成器？

为了澄清起见，我正在研究 RSS 版本 2.0，这也是我在提要中找到的版本号。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T02:16:56.213

确保提要通过[W3C 验证器](http://validator.w3.org/feed/)。这应该可以让您快速回答谁在规则之外。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T04:19:02.660

根据 W3C 标记验证器，未编码的撇号 (') 允许出现在 XML 中开始和结束标记之间的内容中。

我报告的问题中出现的问题似乎是由旧版本的 Microsoft XML 解析器中的错误引起的。

# python - 在 Python 中正确导入模块

> ID：896112
> 
> 赞同：11
> 
> 时间：2009-05-22T02:09:07.290
> 
> 标签：python, python-import

如何设置模块导入，以便每个模块都可以访问所有其他模块的对象？

我有一个中等大小的 Python 应用程序，模块文件位于各个子目录中。我创建了将这些子目录附加到`sys.path`并导入一组模块的模块，使用`import thisModule as tm`. 模块对象以该限定条件引用。然后我将该模块导入到其他模块中`from moduleImports import *`。代码现在很草率，其中有一些东西，通常是重复的。

首先，应用程序失败，因为未分配一些模块引用。相同的代码在单元测试时会运行。

其次，我担心我会导致递归模块导入出现问题。导入 moduleImports 会导入 thisModule，后者会导入 moduleImports。. . .

这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-22T10:05:51.857

**“我有一个中等大小的 Python 应用程序，其模块文件位于各种子目录中。”**

好的。确保每个目录都包含一个`__init__.py`文件，以便它是一个包。

**“我创建了将这些子目录附加到`sys.path`”的模块**

坏的。使用`PYTHONPATH`或安装整个结构`Lib/site-packages`。不要`sys.path`动态更新。这是一件坏事。难以管理和维护。

**“导入一组模块，使用`import thisModule as tm`.”**

没有意义。也许您`import thisModule as tm`的结构中的每个模块都有一个。这是典型的标准做法：只导入您需要的模块，不导入其他模块。

**“然后我将该模块导入到其他模块中`from moduleImports import *`”**

坏的。不要一揽子导入一堆随机的东西。

每个模块都应该有一个长长的列表，列出它需要的具体内容。

```
import this
import that
import package.module 
```

显式列表。没有魔法。没有动态变化`sys.path`。

我目前的项目有 100 多个模块，十几个包。每个模块只导入它需要的东西。没有魔法。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-22T02:20:43.087

几个指针

1.  您可能已经在各个模块中拆分了功能。如果在大多数情况下正确完成，您将不会陷入循环导入问题（例如，如果模块 a 依赖于 b 并且 b 依赖于 a，您可以制作第三个模块 c 来消除这种循环依赖）。作为最后的手段，在 a import b 但在 b import a 在需要 a 的地方，例如在函数内部。

2.  一旦模块中的功能正确，将它们分组到子目录下的包中，并向其中添加`__init__.py`文件，以便您可以导入包。将这些包保存在一个文件夹中，例如 lib，然后添加到 sys.path 或设置 PYTHONPATH 环境变量

3.  from module import * 可能不是一个好主意。相反，导入任何需要的东西。它可能是完全合格的。冗长并没有什么坏处。例如从 pakageA.moduleB 导入 CoolClass。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-22T09:10:17.553

做到这一点的方法是避免魔法。换句话说，如果你的模块需要来自另一个模块的东西，它应该显式地导入它。你不应该依赖自动导入的东西。

正如 Python 之禅 ( `import this`) 所言，显式优于隐式。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-22T02:17:58.037

您不会在导入时得到递归，因为 Python 会缓存每个模块并且不会重新加载它已经拥有的模块。

# wpf - WPF 拖放不会触发 CommanBinding.CanExecute

> ID：896114
> 
> 赞同：3
> 
> 时间：2009-05-22T02:10:23.387
> 
> 标签：wpf, drag-and-drop

是的，我知道这听起来很奇怪，但事实并非如此，问题是为什么，以及是否有解决方法。它适用于所有内容，即使您按下 PrintScreen 或 Pause 键，CanExecute 也会触发。因此，在拖放之后，为了让它触发，你必须做一些“其他事情”，比如鼠标点击、聚焦、按键等等。这将使事件触发，并允许执行发生。无论如何，这是我的代码，我知道它很长，但它会帮助你帮助我。

我在我们的大型主项目中发现了这个错误，所以我将其简化为这个小应用程序以隔离问题。

XAML：

```
<Window x:Class="DragNDropCommands.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="485" SizeToContent="Width" Loaded="Window_Loaded">
    <Window.CommandBindings>
        <CommandBinding Command="ApplicationCommands.New" CanExecute="NewCanExecute" Executed="NewExecuted" />
        <CommandBinding Command="ApplicationCommands.Save" CanExecute="SaveCanExecute" Executed="SaveExecuted" />
        <CommandBinding Command="ApplicationCommands.Undo" CanExecute="UndoCanExecute" Executed="UndoExecuted" />
        <CommandBinding Command="ApplicationCommands.Redo" CanExecute="RedoCanExecute" Executed="RedoExecuted" />
    </Window.CommandBindings>
    <Grid Margin="8">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>

        <Button Command="ApplicationCommands.New" Grid.Row="0" Grid.Column="0" FontWeight="Bold" Content="New" Width="80" Margin="8"></Button>
        <Button Command="ApplicationCommands.Save" Grid.Row="0" Grid.Column="1" FontWeight="Bold" Content="Save" Width="80" Margin="8"></Button>
        <Button Command="ApplicationCommands.Undo" Grid.Row="0" Grid.Column="2" FontWeight="Bold" Content="Undo" Width="80" Margin="8"></Button>
        <Button Command="ApplicationCommands.Redo" Grid.Row="0" Grid.Column="3" FontWeight="Bold" Content="Redo" Width="80" Margin="8"></Button>

        <CheckBox Grid.Row="1" Grid.Column="0" Margin="8" IsChecked="{Binding Path=AllowNew, Mode=TwoWay}">Allow New</CheckBox>
        <CheckBox Grid.Row="1" Grid.Column="1" Margin="8" IsChecked="{Binding Path=AllowSave}">Allow Save</CheckBox>
        <CheckBox Grid.Row="1" Grid.Column="2" Margin="8" IsChecked="{Binding Path=AllowUndo}">Allow Undo</CheckBox>
        <CheckBox Grid.Row="1" Grid.Column="3" Margin="8" IsChecked="{Binding Path=AllowRedo}">Allow Redo</CheckBox>

        <Label x:Name="labelDrag" Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="2" BorderBrush="Black" BorderThickness="1" MouseDown="Label_MouseDown"
               Background="LightBlue" HorizontalContentAlignment="Center" Margin="8">Drag this label...</Label>
        <Label x:Name="labelDropNew" Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="2" BorderBrush="Black" BorderThickness="1" Drop="labelDropNew_Drop"
               Background="LightGray" HorizontalContentAlignment="Center" Margin="8" AllowDrop="True">...here to toggle AllowNew</Label>
        <Label x:Name="labelDropSave" Grid.Row="3" Grid.Column="2" Grid.ColumnSpan="2" BorderBrush="Black" BorderThickness="1" Drop="labelDropSave_Drop"
               Background="LightGray" HorizontalContentAlignment="Center" Margin="8" AllowDrop="True">...here to toggle AllowSave</Label>

        <ListBox x:Name="listViewLog" Grid.Row="4" Grid.ColumnSpan="4" Margin="8" Width="500">
        </ListBox>

        <Button Grid.Row="5" Grid.Column="1" Grid.ColumnSpan="2" Margin="8" Click="Button_Click">Clear list</Button>
    </Grid>
</Window> 
```

C＃：

```
using System;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Input;

namespace DragNDropCommands
{
    /// <summary>
    /// Interaction logic for Window1.xaml
    /// </summary>
    public partial class Window1 : Window
    {
        private CommandControl commandControl = new CommandControl();
        private int canExecuteCount = 1;

        public Window1()
        {
            InitializeComponent();
        }

        private void Window_Loaded(object sender, RoutedEventArgs e)
        {
            this.DataContext = commandControl;
        }

        private void NewCanExecute(object sender, CanExecuteRoutedEventArgs e)
        {
            if (this.commandControl == null || listViewLog == null)
                return;

            e.CanExecute = this.commandControl.AllowNew;

            listViewLog.Items.Add
            (
                String.Format
                (
                    "{0} - NewCanExecute: {1} - commandControl.AllowNew: {2}",
                    canExecuteCount++, e.CanExecute, commandControl.AllowNew
                )
            );
        }

        private void NewExecuted(object sender, ExecutedRoutedEventArgs e)
        {
            MessageBox.Show("New executed");
        }

        private void SaveCanExecute(object sender, CanExecuteRoutedEventArgs e)
        {
            if (this.commandControl == null || listViewLog == null)
                return;

            e.CanExecute = this.commandControl.AllowSave;

            listViewLog.Items.Add
            (
                String.Format
                (
                    "{0} - SaveCanExecute: {1} - commandControl.AllowSave: {2}",
                    canExecuteCount++, e.CanExecute, commandControl.AllowSave
                )
            );
        }

        private void SaveExecuted(object sender, ExecutedRoutedEventArgs e)
        {
            MessageBox.Show("Save executed");
        }

        private void UndoCanExecute(object sender, CanExecuteRoutedEventArgs e)
        {
            if (this.commandControl == null || listViewLog == null)
                return;

            e.CanExecute = this.commandControl.AllowUndo;

            listViewLog.Items.Add
            (
                String.Format
                (
                    "{0} - UndoCanExecute: {1} - commandControl.AllowUndo: {2}",
                    canExecuteCount++, e.CanExecute, commandControl.AllowUndo
                )
            );
        }

        private void UndoExecuted(object sender, ExecutedRoutedEventArgs e)
        {
            MessageBox.Show("Undo executed");
        }

        private void RedoCanExecute(object sender, CanExecuteRoutedEventArgs e)
        {
            if (this.commandControl == null || listViewLog == null)
                return;

            e.CanExecute = this.commandControl.AllowRedo;

            listViewLog.Items.Add
            (
                String.Format
                (
                    "{0} - RedoCanExecute: {1} - commandControl.AllowRedo: {2}",
                    canExecuteCount++, e.CanExecute, commandControl.AllowRedo
                )
            );
        }

        private void RedoExecuted(object sender, ExecutedRoutedEventArgs e)
        {
            MessageBox.Show("Redo executed");
        }

        private void Button_Click(object sender, RoutedEventArgs e)
        {
            listViewLog.Items.Clear();
        }

        private void Label_MouseDown(object sender, MouseButtonEventArgs e)
        {
            Label label = (Label)sender;

            if(e.LeftButton == MouseButtonState.Pressed)
                DragDrop.DoDragDrop(label, label, DragDropEffects.Move);
        }

        private void labelDropNew_Drop(object sender, DragEventArgs e)
        {
            this.commandControl.AllowNew = !this.commandControl.AllowNew;
        }

        private void labelDropSave_Drop(object sender, DragEventArgs e)
        {
            this.commandControl.AllowSave = !this.commandControl.AllowSave;
        }
    }

    public class CommandControl : DependencyObject
    {
        public bool AllowNew
        {
            get { return (bool)GetValue(AllowNewProperty); }
            set { SetValue(AllowNewProperty, value); }
        }

        // Using a DependencyProperty as the backing store for AllowNew.  This enables animation, styling, binding, etc...
        public static readonly DependencyProperty AllowNewProperty =
            DependencyProperty.Register("AllowNew", typeof(bool), typeof(CommandControl), new UIPropertyMetadata(false));

        public bool AllowSave
        {
            get { return (bool)GetValue(AllowSaveProperty); }
            set { SetValue(AllowSaveProperty, value); }
        }

        // Using a DependencyProperty as the backing store for AllowSave.  This enables animation, styling, binding, etc...
        public static readonly DependencyProperty AllowSaveProperty =
            DependencyProperty.Register("AllowSave", typeof(bool), typeof(CommandControl), new UIPropertyMetadata(false));

        public bool AllowUndo
        {
            get { return (bool)GetValue(AllowUndoProperty); }
            set { SetValue(AllowUndoProperty, value); }
        }

        // Using a DependencyProperty as the backing store for AllowUndo.  This enables animation, styling, binding, etc...
        public static readonly DependencyProperty AllowUndoProperty =
            DependencyProperty.Register("AllowUndo", typeof(bool), typeof(CommandControl), new UIPropertyMetadata(false));

        public bool AllowRedo
        {
            get { return (bool)GetValue(AllowRedoProperty); }
            set { SetValue(AllowRedoProperty, value); }
        }

        // Using a DependencyProperty as the backing store for AllowRedo.  This enables animation, styling, binding, etc...
        public static readonly DependencyProperty AllowRedoProperty =
            DependencyProperty.Register("AllowRedo", typeof(bool), typeof(CommandControl), new UIPropertyMetadata(false));
    }
} 
```

您应该能够只复制粘贴并进行一些名称更改（文件、命名空间）以使其运行。我真的很喜欢你的帮助，因为这一直让我发疯，现在我终于找到了这个错误的原因，我不知道该怎么办。

任何建议都非常感谢。

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-22T07:57:10.573

只是一个快速的建议：

您可以`CommandManager.InvalidateRequerySuggested()`在拖放事件处理程序中使用以强制重新执行`CanExecute()`. （[链接](http://robburke.net/2008/04/23/wpf-command-pattern-when-does-it-query-canexecute/)）

# javascript - 如何将 JSON 用于错误类

> ID：896117
> 
> 赞同：1
> 
> 时间：2009-05-22T02:11:24.930
> 
> 标签：javascript, jquery

大家好。我很幸运让 Paolo 帮助我编写一段 jquery 代码，如果数据已保存或未保存到数据库，它将向最终用户显示错误消息。我正在查看代码，我的想象力很疯狂，因为我想知道是否可以只使用那一段代码并将选择器类型导入其中，然后将整个 json 脚本包含到我的文档中。这将使我不必将 json 脚本包含到 10 个不同的文档中。希望我在这里有意义。

```
$('#add_customer_form').submit(function() { // handle form submit 
```

“add_customer_form” id 是我想在每页基础上更改的。如果我能成功地做到这一点，那么我可以创建一个类，只使用这个 json 脚本的其余部分并将它包含在我需要的地方。我敢肯定有人已经想到了这一点，所以我想知道是否有人可以给我一些指示。

谢谢！

* * *

好吧，可以这么说，我碰壁了。下面的代码是我的表单中已经存在的代码。它使用数据字符串数据类型，但我需要 json。我该怎么办？我想用漂亮的 100% 宽的绿色 div 替换愚蠢的警报框，我的服务器说一切正常。

```
$.ajax({
  type: "POST",
  url: "body.php?action=admCustomer",
  data: dataString,
  success: function(){
    $('#contact input[type=text]').val('');
    alert( "Success! Data Saved");
  }
 }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T02:23:55.060

这是我在上[一个问题](https://stackoverflow.com/questions/891488/how-can-i-get-a-jquery-css-container-to-pop-up-letting-the-user-know-data-was-suc)中使用的代码，减去注释：

```
$(function() {
    $('#add_customer_form').submit(function() {
        var data = $(this).serialize();
        var url = $(this).attr('action');
        var method = $(this).attr('method');
        $.ajax({
            url: url,
            type: method,
            data: data,
            dataType: 'json',
            success: function(data) {
                var $div = $('<div>').attr('id', 'message').html(data.message);
                if(data.success == 0) {
                    $div.addClass('error');
                } else {
                    $div.addClass('success');
                }
                $('body').append($div);
            }
        });
        return false;
    });
}); 
```

如果我是对的，那么您实质上要问的是如何使这段代码适用于多种表单，而无需编辑选择器。这很容易。只要您在带有表单的每个页面中都包含上述代码，您就可以将`$('#add_customer_form')`部分更改为`$('form.json_response')`. 使用这个选择器，我们基本上是在告诉 jQuery“任何带有类的表单都`json_response`应该通过这个提交函数来处理”——我使用的特定类在这里不相关，关键是你使用一个类并将它提供给所有表单应该有这个功能。请记住，jQuery 适用于*集合*的对象。我最初拥有它的方式恰好是 1 个元素，但是每个 jQuery 函数都旨在对匹配的尽可能多的元素进行操作。这样，每当您创建要通过 AJAX 处理的表单（并且您知道服务器将返回带有成功指示符的 JSON 响应）时，您可以简单地添加您选择的任何类，然后 jQuery 代码将接管并处理它你。

还有一个[更清洁的插件](http://malsup.com/jquery/form/)可以做到这一点，但上面也很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T02:26:31.903

根据您的问题，我认为您想要的是一个 jQuery 选择器，它将在您的每个页面上选择正确的表单。如果你给他们一个一致的类，你可以在每一页上使用相同的代码：

HTML

```
<form id="some_form_name" class="AJAX_form"> ... </form> 
```

选择器：

```
$('form.AJAX_form") 
```

# sql - Linq 版本的 SQL "IN" 语句

> ID：896123
> 
> 赞同：26
> 
> 时间：2009-05-22T02:14:04.223
> 
> 标签：sql, linq, linq-to-sql

我有以下 3 个表作为简单的“项目标记”模式的一部分：

==项目==

*   项目 ID int
*   品牌 varchar
*   名称 varchar
*   价格钱
*   条件 varchar
*   说明 varchar
*   有源位

==标签==

*   标签ID int
*   名称 varchar
*   有源位

==标签映射==

*   TagMapId int
*   TagId int (fk)
*   ItemId int (fk)
*   有源位

我想编写一个 LINQ 查询来带回与标签列表匹配的项目（例如 TagId = 2、3、4、7）。在我的应用程序上下文中，项目示例是“计算机监视器”、“礼服衬衫”、“吉他”等，标签示例是“电子产品”、“服装”等。我通常会使用 SQL 完成此操作IN 语句。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-05-22T02:31:24.873

就像是

```
var TagIds = new int[] {12, 32, 42};

var q = from map in Context.TagMaps 
        where TagIds.Contains(map.TagId)
        select map.Items; 
```

应该做你需要的。这将生成一个 In ( 12, 32, 42 ) 子句（如果我没记错的话，更具体地说是一个参数化的 IN 子句）。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-22T02:18:34.540

给定的项目数组：

```
var list = new int[] {2,3,4} 
```

采用：

```
where list.Contains(tm.TagId) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T03:52:38.797

```
List<int> tagIds = new List<int>() {2, 3, 4, 7};
int tagIdCount = tagIds.Count;
    //
// Items that have any of the tags
//  (any item may have any of the tags, not necessarily all of them
    //
var ItemsAnyTags = db.Items
  .Where(item => item.TagMaps
    .Any(tm => tagIds.Contains(tm.TagId))
  );

    //
// Items that have ALL of the tags
//  (any item may have extra tags that are not mentioned).
    //
var ItemIdsForAllTags = db.TagMap
  .Where(tm => tagIds.Contains(tm.TagId))
  .GroupBy(tm => tm.ItemId)
  .Where(g => g.Count() == tagIdCount)
  .Select(g => g.Key);
    //
var ItemsWithAllTags = db.Items
  .Where(item => ItemsIdsForAllTags.Contains(item.ItemId));

//runs just one query against the database
List<Item> result = ItemsWithAllTags.ToList(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-15T06:49:06.957

你可以简单地使用，

```
var TagIds = {12, 32, 42}
var prod =entities.TagMaps.Where(tagmaps=> TagIds .Contains(tagmaps.TagId)); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-12-28T18:43:04.560

```
string[] names = {"John", "Cassandra", "Sarah"};

var results = (from n in db.Names
               where names.Contains(n.Name)
               select n).ToList(); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-04-30T10:15:51.693

您可以创建一个扩展方法“IN()”

```
public static class Extension
{
    public static bool IN(this object anyObject, params object[] list)
    { return list.Contains(anyObject); }
} 
```

像这样使用

```
var q = from map in Context.TagMaps 
        where map.TagId.IN(2, 3, 4, 7)
        select map.Items; 
```

或者只使用内联 array.Contains() 表示法：

```
var q = from map in Context.TagMaps 
        where new[]{2, 3, 4, 7}.Contains(map.TagId)
        select map.Items; 
```

# ruby-on-rails - Ruby on Rails 是否有 Beast 的替代品

> ID：896131
> 
> 赞同：0
> 
> 时间：2009-05-22T02:19:07.910
> 
> 标签：ruby-on-rails, beast

一个名为 Beast 的开源项目用大约 500 行 Ruby on Rails 代码实现了一个论坛。该项目似乎陷入了沉默（[http://beast.caboo.se/](http://beast.caboo.se/)）。是否有一个开源项目可以替代 beast 并且兼容为 Beast 定义的数据库模式？我使用 Beast 赞助了一个论坛，并希望在更新版本的 Ruby on Rails 上将部署从 Ubuntu 升级并迁移到 OS X。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T10:32:41.383

你看过altered_beast吗？[对 Beast 的彻底重写](http://github.com/technoweenie/altered_beast/tree/master)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T03:24:45.827

如果你只是想获得 Beast 的源代码，试试[这个 SVN 树](http://svn.techno-weenie.net/projects/beast/)。

# ruby-on-rails - Rails：如何在 lib 的单独类中使用帮助程序

> ID：896134
> 
> 赞同：6
> 
> 时间：2009-05-22T02:19:50.967
> 
> 标签：ruby-on-rails

我碰巧在 lib 文件夹中创建了一个文件，我想在该文件中使用 TextHelper。如何使 Texthelper 可用？

建议赞赏，谢谢，

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-22T20:58:54.840

其实一点也不难。您可以只包含`TextHelper`您班级中的模块。

```
class MyLib
  include ActionView::Helpers::TextHelper

  def five_things(x)
    pluralize 5, x
  end
end

>> MyLib.new.five_things "dog"
=> "5 dogs" 
```

那来自我在 中定义的一个类`lib`，以及一个`script/console`会话的输出，以确保一切正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-12-19T11:46:13.467

对于那些`self`方法似乎没有从助手继承函数的人，这将起作用：

```
class MyLib

  class << self

    include Path::To::YourHelper

    def test_func(x)
      method_in_helper 5, x
    end

  end

end 
```

# php - php 和 WordPress 中的 array_slice() 警告

> ID：896135
> 
> 赞同：0
> 
> 时间：2009-05-22T02:19:53.680
> 
> 标签：php, wordpress

我写了这段代码：

```
function get_feed(){

 // Get RSS Feed(s)
include_once(ABSPATH . WPINC . '/rss.php');
$rss = fetch_rss('http://dorar.shamekh.ws/?feed=rss2');
$maxitems = 1;
$items = array_slice($rss->items, 0, $maxitems,false);
return $items;

} 
```

作为 WordPress 插件的一部分，它在我的本地服务器上运行良好，但是当我将它上传到我的博客时，我收到以下消息：

> 警告：array_slice() [function.array-slice]：第一个参数应该是一个数组

我本地主机上的 php 版本：`5.2.6`

我网站上的 php 版本：`5.2.5`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T02:30:26.967

从文档看来`$rss->items`应该已经是一个数组。我猜 RSS 获取失败了。尝试：

```
if (is_array($rss->items)) {
   $items = array_slice($rss->items, 0, $maxitems,false);
} else { var_dump($rss->items); } 
```

MagpieRSS 与 dorar.shamekh.ws'（使用/配置）Apache 1.3.41 相结合导致了一种非常奇怪的行为：

一个“正常”的 HTTP 请求：

```
GET /feed/ HTTP/1.0
Host: dorar.shamekh.ws 
```

MagpieRSS 的请求：

```
GET /feed/ HTTP/1.0
User-Agent: MagpieRSS/0.72 (+http://magpierss.sf.net)
Host: dorar.shamekh.ws:80
Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, */* 
```

请注意不同的“主机”标头。当附加端口号时，如在 MagpieRSS 中，站点返回 301：

```
HTTP/1.1 301 Moved Permanently
Date: Fri, 22 May 2009 02:45:03 GMT
Server: Apache/1.3.41 (Unix) PHP/5.2.5 mod_auth_passthrough/1.8 mod_log_bytes/1.2 mod_bwlimited/1.4 FrontPage/5.0.2.2635 mod_ssl/2.8.31 OpenSSL/0.9.7a
X-Powered-By: PHP/5.2.5
X-Pingback: http://dorar.shamekh.ws/xmlrpc.php
Last-Modified: Wed, 20 May 2009 22:03:05 GMT
ETag: "e591693fdf2d27ee7dae19e256db2f46"
Location: http://dorar.shamekh.ws/feed/
Connection: close
Content-Type: text/html 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-05T15:35:24.433

`fetch_rss()`它已被弃用。请参阅：[http ://codex.wordpress.org/Function_Reference/fetch_rss](http://codex.wordpress.org/Function_Reference/fetch_rss)

你必须使用`fetch_feed()`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T02:22:46.450

首先将 $rss->items 转换为数组怎么样：

```
function get_feed(){

 // Get RSS Feed(s)
include_once(ABSPATH . WPINC . '/rss.php');
$rss = fetch_rss('http://dorar.shamekh.ws/?feed=rss2');
$maxitems = 1;
$rss->items = (array) $rss->items;
$items = array_slice($rss->items, 0, $maxitems,false);
return $items;

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T02:32:13.173

在我看来，当它试图获取 RSS 时它失败了。也许`fetch_rss`使用已为 URL 禁用的 file_get_contents。

或者由于某种原因，属性 $rss->items 由于某种原因不是数组。

# java - Java：List 的 ArrayList、Map 的 HashMap 和 Set 的 HashSet？

> ID：896139
> 
> 赞同：5
> 
> 时间：2009-05-22T02:22:45.390
> 
> 标签：java

我通常总是发现使用标题中列出的接口的具体类就足够了。通常当我使用其他类型（如 LinkedList 或 TreeSet）时，原因是功能而非性能 - 例如，队列的 LinkedList。

我有时会构造一个初始容量大于默认值 10 的 ArrayList 和一个大于默认存储桶 16 的 HashMap，但我通常（尤其是对于业务 CRUD）从来没有看到自己在想“嗯……我应该使用 LinkedList如果我只是要插入并遍历整个列表，而不是 ArrayList？”

我只是想知道这里的其他人使用什么（以及为什么）以及他们开发什么类型的应用程序。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-22T02:52:16.313

这些绝对是我的默认设置，尽管 LinkedList 实际上通常是列表的更好选择，因为绝大多数列表似乎只是按顺序迭代，或者无论如何都通过 Arrays.asList 转换为数组。

但就保持一致的可维护代码而言，将这些代码标准化并使用替代方案是有意义的，这样当有人阅读代码并看到替代方案时，他们会立即开始认为代码正在做一些特别的事情。

除非我有特殊原因要引用子类型，否则我总是将参数和变量键入为 Collection、Map 和 List，这样在需要时切换是一行代码。

如果您需要随机访问，我有时会看到明确需要 ArrayList，但实际上这并没有发生。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T06:36:52.210

对于某种列表（例如侦听器），使用[CopyOnWriteArrayList](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/CopyOnWriteArrayList.html)而不是普通的[ArrayList](http://java.sun.com/j2se/1.5.0/docs/api/java/util/ArrayList.html)是有意义的。对于几乎所有其他事情，您提到的基本实现就足够了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T04:13:04.653

是的，我使用这些作为默认值。我通常有一条规则，在公共类方法上，我总是返回接口类型（即 Map、Set、List 等），因为其他类（通常）不需要知道具体的具体类是什么。在类方法中，只有当我需要访问它可能具有的任何额外方法时（或者如果它使理解代码更容易），我才会使用具体类型，否则使用接口。

不过，对您使用的任何规则都非常灵活是很好的，因为对具体类可见性的依赖会随着时间的推移而改变（尤其是当您的代码变得更加复杂时）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-22T12:47:30.220

事实上，总是使用基本接口 Collection、List、Map 来代替它们的实现。为了让thinkgs更加灵活，你可以将你的实现隐藏在静态工厂方法后面，这样你就可以切换到不同的实现，以防你发现更好的东西（我怀疑这个领域会有很大的变化，但你永远不知道）。另一个好处是由于泛型，语法更短。

```
Map<String, LongObjectClasName> map = CollectionUtils.newMap();

instead of 

Map<String, LongObjectClasName> map = new HashMap<String, LongObjectClasName>();

public class CollectionUtils {
.....

public <T> List<T> newList() {
        return new ArrayList<T>();
    }

    public <T> List<T> newList(int initialCapacity) {
        return new ArrayList<T>(initialCapacity);
    }

    public <T> List<T> newSynchronizedList() {
        return new Vector<T>();
    }

    public <T> List<T> newConcurrentList() {
        return new CopyOnWriteArrayList<T>();
    }

    public <T> List<T> newSynchronizedList(int initialCapacity) {
        return new Vector<T>(initialCapacity);
    }

...
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T02:40:37.103

刚上完有关数据结构性能的课程后，我通常会在选择实现之前查看我正在开发的算法类型或结构的目的。

例如，如果我正在构建一个包含大量随机访问的列表，我将使用 ArrayList，因为它的随机访问性能很好，但如果我要向列表中插入很多东西，我可能会选择一个 LinkedList 代替。（我知道现代实现消除了很多性能障碍，但这是我想到的第一个例子。）

您可能想查看一些数据结构的 Wikipedia 页面（尤其是那些处理[排序算法](http://en.wikipedia.org/wiki/Sorting_algorithm)的页面，其中性能尤为重要）以获取有关性能的更多信息，以及有关[Big O 表示法](http://en.wikipedia.org/wiki/Big_O_notation)的文章以获取有关测量性能的一般讨论数据结构的各种功能。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-22T14:22:11.637

我并没有真正的“默认”，尽管我想我经常使用问题中列出的实现。我考虑什么适合我正在处理的任何特定问题，并使用它。我不只是盲目地默认使用`ArrayList`，我花了 30 秒的时间思考“好吧，我将在这个列表中间进行大量迭代和删除元素，所以我应该使用`LinkedList`” .

而且我几乎总是使用接口类型作为参考，而不是实现。请记住，这`List`不是唯一`LinkedList`实现的接口。我经常看到这个：

```
LinkedList<Item> queue = new LinkedList<Item>(); 
```

当程序员的**意思**是：

```
Queue<Item> queue = new LinkedList<Item>(); 
```

我也`Iterable`大量使用该界面。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-22T18:55:55.680

如果您将 LinkedList 用于队列，则可以考虑改用 Deque 接口和 ArrayDeque 实现类（在 Java 6 中引入）。引用 ArrayDeque 的 Javadoc：

> 这个类在作为栈使用时可能比 Stack 快，作为队列使用时比 LinkedList 快。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-22T06:06:12.283

我倾向于将 *Queue 类之一用于队列。但是，如果您不需要线程安全，LinkedList 是一个不错的选择。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-22T06:46:52.740

使用接口类型`List, Map`（`ArrayList, HashMap`

当一个方法接受一个`ArrayList`作为参数，而你有别的东西时，你就完蛋了，不得不毫无意义地复制你的数据。如果参数类型是`List`，调用者会更加灵活，例如可以使用`Collections.EMPTY_LIST`or `Collections.singletonList()`。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-04T15:12:17.450

我也通常使用 ArrayList，但我会根据情况使用 TreeSet 或 HashSet。然而，在编写测试时，也经常使用 Arrays.asList 和 Collections.singletonList。我大部分时间都在编写线程本地代码，但我也可以看到使用各种并发类。

此外，有时我使用 ArrayList，而我真正想要的是 LinkedHashSet（在它可用之前）。

# python - 在 vim 中编辑 python 文件的更高效的动作

> ID：896145
> 
> 赞同：64
> 
> 时间：2009-05-22T02:25:37.210
> 
> 标签：python, vim, editing

给定一个不断重复以下内容的 python 文件：

```
def myFunction(a, b, c):
    if a:
        print b
    elif c:
        print 'hello' 
```

我想四处走动并使用熟悉的 vim 动作编辑此文件。例如，使用 (, ), [[, ]], {, } 或使用 di} 之类的命令删除/拉取/更改文本。

在其他语言（如 C++、Java、C# 等）中，花括号比比皆是，因此使用 di} 之类的动作可以轻松找到匹配的花括号并作用于该块。事实上，如果我在上述文本的 'b' 字符上并在 vim 中执行 di)，它会成功删除两个括号之间的文本。

我认为问题在于python对代码块的检测。使用 (, ), [[, ]], {, or } 作为动作几乎都做同样的事情，带你到开始（在 def 行之上或之上）或结束（在函数的最后一行之后）功能。据我所知，没有办法轻松地告诉 vim“选择这个缩进块的所有内容”。在上面的示例中，我想在 if 行的“i”中打开，输入 di} 并让它删除整个 if 块（到此特定函数的末尾）。

我确信应该可以告诉 vim 在缩进的基础上进行这样的动作（好吧，也许不是那个特定的动作，而是一些用户定义的动作）。关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2015-02-02T18:44:46.663

### 方括号映射`[[`, `]]`, `[m`,`]m`和类似的

[`$VIMRUNTIME/ftplugin/python.vim`](https://github.com/vim/vim/blob/master/runtime/ftplugin/python.vim)now (2018) 重新映射记录在python 语言下`:h ]]`的所有内置映射。`:h ]m`映射是：

```
]] Jump forward to begin of next toplevel
[[ Jump backwards to begin of current toplevel (if already there, previous toplevel)
]m Jump forward to begin of next method/scope
[m Jump backwords to begin of previous method/scope

][ Jump forward to end of current toplevel
[] Jump backward to end of previous of toplevel
]M Jump forward to end of current method/scope
[M Jump backward to end of previous method/scope 
```

以下带有注释的示例源代码说明了不同的映射

```
class Mapping:                              # [[[[
    def __init__(self, iterable):
        pass

    def update(self, iterable):
        pass

    __update = update                       # []

class Reverse:                              # [[ or [m[m
    def __init__(self, data):               # [m
        self.data = data
        self.index = len(data)              # [M

    def __iter__(self):                     # <--- CURSOR
        return self                         # ]M

    def __next__(self):                     # ]m
        if self.index == 0:
            raise StopIteration
        self.index = self.index - 1
        return self.data[self.index]        # ][

class MappingSubclass(Mapping):             # ]] or ]m]m

    def update(self, keys, values):
        pass 
```

[在提交abd468ed0](https://github.com/vim/vim/blob/abd468ed0fbcba391e7833feeaa7de3ced841455/runtime/ftplugin/python.vim) (2016-09-08)、[01164a6546b4](https://github.com/vim/vim/blob/01164a6546b4c635daf96a1f17d1cb2d07f32a66/runtime/ftplugin/python.vim) (2017-11-02) 和 [7f2e9d7c9cd](https://github.com/vim/vim/blob/7f2e9d7c9cdfc5201a899b7b610edf64bf80c45f/runtime/ftplugin/python.vim) (2017-11-11)中添加和改进了映射。

如果您还没有此文件的新版本，您可以下载并将其放入`~/.vim/ftplugin/python.vim`. 此文件夹优先于`$VIMRUNTIME/ftplugin`.

在将这些映射添加到 之前，已经有提供、、和`$VIMRUNTIME`的插件。此外还定义了文本对象、、和：`python-mode``[[``]]``[M``]M``python-mode``aC``iC``aM``iM`

### 插件[python 模式](https://github.com/klen/python-mode)

这个 vim 插件提供类似于内置的动作：

```
2.4 Vim motion ~
                                                                *pymode-motion*

Support Vim motion (See |operator|) for python objects (such as functions,
class and methods).

`C` — means class
`M` — means method or function
                                                            *pymode-motion-keys*

==========  ============================
Key         Command (modes)
==========  ============================
[[          Jump to previous class or function (normal, visual, operator)
]]          Jump to next class or function  (normal, visual, operator)
[M          Jump to previous class or method (normal, visual, operator)
]M          Jump to next class or method (normal, visual, operator)
aC          Select a class. Ex: vaC, daC, yaC, caC (normal, operator)
iC          Select inner class. Ex: viC, diC, yiC, ciC (normal, operator)
aM          Select a function or method. Ex: vaM, daM, yaM, caM (normal, operator)
iM          Select inner func. or method. Ex: viM, diM, yiM, ciM (normal, operator)
==========  ============================ 
```

### 插件[Pythonsense](https://github.com/jeetsukumaran/vim-pythonsense)

这个插件提供了类似的动作，但稍作修改：

> 常用的 Vim 8.0“类”运动（“]]”、“[[”等），查找从第一列开始的块，无论这些是类还是功能块，而它的方法/功能运动（“[m”、“]m”等）在任何缩进处查找所有块，无论这些块是类块还是功能块。相比之下，“Pythonsense”类运动致力于查找所有且仅类定义，而不管其缩进级别如何，而其方法/函数运动则致力于查找所有且仅方法/函数定义，而与它们的缩进级别无关。

所有详细信息和示例都在[https://github.com/jeetsukumaran/vim-pythonsense#stock-vim-vs-pythonsense-motions](https://github.com/jeetsukumaran/vim-pythonsense#stock-vim-vs-pythonsense-motions)中给出。此外，该插件还定义了文本对象`ic/ac`（类）、`if/af`（函数）、`id/ad`（文档字符串）。

有关 python 文本对象的讨论，请参阅[通过 VIM 选择 Python 函数的最快方法是什么？](https://stackoverflow.com/questions/6579723/whats-the-fastest-way-to-select-a-function-of-python-via-vim).

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-09-08T13:56:12.580

# [蟒蛇.vim](https://vim.sourceforge.io/scripts/script.php?script_id=30)

使浏览 python 代码块变得更加容易。

捷径：

*   `]t` -- 跳转到块的开头
*   `]e` -- 跳转到块尾
*   `]v` -- 选择（视觉线模式）块
*   `]<` -- 向左移动方块
*   `]>` -- 向右移动方块
*   `]#` -- 评论选择
*   `]u` -- 取消注释选择
*   `]c` -- 选择当前/上一课
*   `]d` -- 选择当前/上一个功能
*   `]<up>` -- 跳转到具有相同/更低缩进的上一行
*   `]<down>`-- 跳到具有相同/更低缩进的下一行

# [python_match.vim](https://vim.sourceforge.io/scripts/script.php?script_id=386)

扩展`%`：

*   `%` - 循环通过 if/elif/else、try/except/catch、for/continue/break
*   `g%`- 移动对面`%`
*   `[%`- 移动到当前代码块的开头
*   `]%`- 移动到当前代码块的末尾

上述所有动作都适用于正常、视觉和操作员挂起模式，因此：

*   `d]%` - 删除直到当前块结束
*   `v]%d`- 应该做同样的事情，通过可视模式，以便您可以看到正在删除的内容
*   `V]%d`- 上面，但有行选择

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-22T15:45:11.193

移动缩进块非常容易`set foldmethod=indent`。例如，如果您在`def main():`以下代码段中的行：

```
def main():
+-- 35 lines: gps.init()-----------------------------------------------------

if __name__ == "__main__": main() 
```

然后`dj`获取整个主要功能，可以将其粘贴到其他地方。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-18T12:32:14.940

为了解决您的最后一段，以下脚本定义了一个新的“缩进”文本对象，您可以对其执行操作。例如，`d``i``i`删除与光标所在行同级缩进的所有内容。

有关更多信息，请参阅插件的文档：http: [//www.vim.org/scripts/script.php? script_id=3037](http://www.vim.org/scripts/script.php?script_id=3037)

# python - 如何在 django formset 中显示隐藏的自动字段

> ID：896153
> 
> 赞同：2
> 
> 时间：2009-05-22T02:29:31.477
> 
> 标签：python, django, formset

默认情况下，使用表单集显示的 Django 自动字段是隐藏的。展示它的最佳方式是什么？

目前，模型被声明为，

```
class MyModel:
   locid = models.AutoField(primary_key=True)
   ... 
```

当使用 Django 表单集呈现时，

```
class MyModelForm(ModelForm):
  class Meta:
    model = MyModel
    fields = ('locid', 'name') 
```

它在页面上显示为，

```
<input id="id_form-0-locid" type="hidden" value="707" name="form-0-locid"/> 
```

谢谢。

* * *

**编辑**

我像这样创建表单集 -

```
LocFormSet = modelformset_factory(MyModel) 
pformset = LocFormSet(request.POST, request.FILES, queryset=MyModel.objects.order_by('name')) 
```

* * *

**第二次编辑**

看起来我没有使用我在那里定义的自定义表单类，所以这个问题需要稍微修改..

*如何从自定义表单（将显示隐藏字段）创建表单集，以及使用自定义查询集？*

目前，我可以从 BaseModelFormSet 类继承并使用自定义查询集，也可以使用 ModelForm 类向**表单**添加自定义字段。有没有办法同时使用表单集？

* * *

**第三次编辑**

我现在用，

```
class MyModelForm(ModelForm):
  def __init__(self, *args, **kwargs):
    super(MyModelForm, self).__init__(*args, **kwargs)
    locid = forms.IntegerField(min_value = 1, required=True)
    self.fields['locid'].widget.attrs["type"] = 'visible'
    self.queryset = MyModel.objects.order_by('name')
  class Meta:
    model = MyModel
    fields = ('locid', 'name')

LocFormSet = modelformset_factory(MyModel, form = MyModelForm)
pformset = LocFormSet() 
```

但这仍然没有

*   显示 locid
*   使用指定的自定义查询。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T02:34:17.333

尝试更改默认字段类型：

```
from django import forms
class MyModelForm(ModelForm):
  locid = forms.IntegerField(min_value=1, required=True)
  class Meta:
    model = MyModel
    fields = ('locid', 'name') 
```

**编辑：**经过测试和工作......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T08:59:29.277

正如您所说，您没有使用您定义的自定义表单。这是因为你没有在任何地方传递它，所以 Django 无法知道它。

解决方案很简单 - 只需将自定义表单类传递给 modelformset_factory：

```
LocFormSet = modelformset_factory(MyModel, form=MyModelForm) 
```

**编辑**以响应更新 3：

首先，你在错误的地方重新定义了 locid - 它需要在类级别，而不是在`__init__`.

其次，将查询集放在*表单*中根本不会做任何事情——表单不知道查询集。您应该回到之前所做的事情，在实例化表单集时将其作为参数传递。（或者，您可以定义一个自定义*formset*，但这似乎有点矫枉过正。）

```
class MyModelForm(ModelForm):
    locid = forms.IntegerField(min_value=1, required=True)

    def __init__(self, *args, **kwargs):
        super(MyModelForm, self).__init__(*args, **kwargs)
        self.fields['locid'].widget.attrs["type"] = 'visible'
    class Meta:
        model = MyModel
        fields = ('locid', 'name')

LocFormSet = modelformset_factory(MyModel, form = MyModelForm)
pformset = LocFormSet(request.POST, request.FILES,
                      queryset=MyModel.objects.order_by('name'))) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T01:25:51.293

好的，以上方法都不适合我。最后，我从模板方面解决了这个问题。

*   有一个工单（[http://code.djangoproject.com/ticket/10427](http://code.djangoproject.com/ticket/10427)），它为表单的模板变量添加了一个“值”选项。例如，它允许，

    {{form.locid.value}}

要显示。这是一个补丁，可以使用“patch -p0 file.patch”安装在 django 的 SVN 版本中

*   请记住，{{form.locid.value}} 变量将与不可见的表单**一起**使用 - 否则，表单集的提交和保存操作将崩溃。

*   这与 {{ *form.locid.data* }} 不同 - 正如上面提到的票证中所解释的那样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-12T14:51:02.770

隐藏自动字段的原因是 BaseModelFormSet 和 BaseInlineFormSet 都覆盖了 add_field 中的该字段。修复它的方法是创建自己的表单集并覆盖 add_field 而不调用 super。此外，您不必显式定义主键。

您必须将表单集传递给 modelformset_factory：

```
 LocFormSet = modelformset_factory(MyModel, 
           formset=VisiblePrimaryKeyFormSet) 
```

这是在表单集类中：

```
from django.forms.models import BaseInlineFormSet, BaseModelFormSet, IntegerField
from django.forms.formsets import BaseFormSet

class VisiblePrimaryKeyFormset(BaseModelFormSet):
    def add_fields(self, form, index):
        self._pk_field = pk = self.model._meta.pk
        if form.is_bound:
            pk_value = form.instance.pk
        else:
            try:
                pk_value = self.get_queryset()[index].pk
            except IndexError:
                pk_value = None
        form.fields[self._pk_field.name] = IntegerField( initial=pk_value,
                 required=True) #or any other field you would like to display the pk in
        BaseFormSet.add_fields(self, form, index) # call baseformset which does not modify your primary key field 
```

# c++ - tr1::unordered_set 联合和交集

> ID：896155
> 
> 赞同：23
> 
> 时间：2009-05-22T02:31:07.247
> 
> 标签：c++, set, tr1

如何在 c++ 中对类型为 tr1::unordered_set 的集合进行交集和并集？我找不到太多关于它的参考。

任何参考和代码将不胜感激。非常感谢你。

更新：我只是猜想 tr1::unordered_set 应该提供交集、并集、差集的功能。因为这是集合的基本操作。当然我可以自己写一个函数，但我只是想知道是否有来自 tr1 的内置函数。非常感谢你。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-22T05:08:10.650

我看到了`set_intersection()`等。from `algorithm`header 将不起作用，因为它们明确要求对输入进行排序——猜你已经排除了它们。

在我看来，遍历散列 A 并查找散列 B 中的每个元素的“天真”方法实际上应该为您提供接近最佳的性能，因为散列 B 中的连续查找将转到同一个散列桶（假设两者哈希使用相同的哈希函数）。这应该会给你不错的内存局部性，即使这些桶几乎肯定是作为链表实现的。

这是 的一些代码`unordered_set_difference()`，您可以对其进行调整以制作 set union 和 set difference 的版本：

```
template <typename InIt1, typename InIt2, typename OutIt>
OutIt unordered_set_intersection(InIt1 b1, InIt1 e1, InIt2 b2, InIt2 e2, OutIt out) {
    while (!(b1 == e1)) {
        if (!(std::find(b2, e2, *b1) == e2)) {
            *out = *b1;
            ++out;
        }

        ++b1;
    }

    return out;
} 
```

假设您有两个`unordered_set`s`x`和`y`，您可以使用它们的交集`z`：

```
unordered_set_intersection(
    x.begin(), x.end(),
    y.begin(), y.end(),
    inserter(z, z.begin())
); 
```

与[bdonlan 的答案](https://stackoverflow.com/questions/896155/c-tr1unorderedset-union-and-intersection/896398#896398)不同，**这实际上适用于任何键类型和容器类型的任何组合**（尽管`set_intersection()`如果对源容器进行排序，使用当然会更快）。

注意：如果存储桶占用率很高，将每个散列复制到 a`vector`中，然后将它们排序并`set_intersection()`在那里排序可能会更快，因为在包含 n 个元素的存储桶中搜索是 O(n)。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-22T04:49:40.317

没什么大不了的 - 对于相交，只需遍历一个元素的每个元素并确保它在另一个元素中。对于联合，添加两个输入集中的所有项目。

例如：

```
void us_isect(std::tr1::unordered_set<int> &out,
        const std::tr1::unordered_set<int> &in1,
        const std::tr1::unordered_set<int> &in2)
{
    out.clear();
    if (in2.size() < in1.size()) {
        us_isect(out, in2, in1);
        return;
    }
    for (std::tr1::unordered_set<int>::const_iterator it = in1.begin(); it != in1.end(); it++)
    {
        if (in2.find(*it) != in2.end())
            out.insert(*it);
    }
}

void us_union(std::tr1::unordered_set<int> &out,
        const std::tr1::unordered_set<int> &in1,
        const std::tr1::unordered_set<int> &in2)
{
    out.clear();
    out.insert(in1.begin(), in1.end());
    out.insert(in2.begin(), in2.end());
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-08-03T16:50:41.593

基于上一个答案：C++11 版本，如果集合支持快速查找功能`find()` （返回值被有效移动）

```
/** Intersection and union function for unordered containers which support a fast lookup function find()
 *  Return values are moved by move-semantics, for c++11/c++14 this is efficient, otherwise it results in a copy
 */

namespace unorderedHelpers {

    template<typename UnorderedIn1, typename UnorderedIn2,
             typename UnorderedOut = UnorderedIn1>
    UnorderedOut makeIntersection(const  UnorderedIn1 &in1, const  UnorderedIn2 &in2)
    {
        if (in2.size() < in1.size()) {
            return makeIntersection<UnorderedIn2,UnorderedIn1,UnorderedOut>(in2, in1);
        }

        UnorderedOut out;
        auto e = in2.end();
        for(auto & v : in1)
        {
            if (in2.find(v) != e){
                out.insert(v);
            }
        }
        return out;
    }

    template<typename UnorderedIn1, typename UnorderedIn2,
             typename UnorderedOut = UnorderedIn1>
    UnorderedOut makeUnion(const UnorderedIn1 &in1, const UnorderedIn2 &in2)
    {
        UnorderedOut out;
        out.insert(in1.begin(), in1.end());
        out.insert(in2.begin(), in2.end());
        return out;
    }
} 
```

# python - Django——如何使用带有多个参数的模板标签过滤器

> ID：896166
> 
> 赞同：2
> 
> 时间：2009-05-22T02:37:17.780
> 
> 标签：python, django, filter, django-templates, tags

我有一些值想传递给过滤器并从中获取 URL。

在我的模板中，我有：

```
{% if names %}
  {% for name in names %}
    <a href='{{name|slugify|add_args:"custid=name.id, sortid=2"}}'>{{name}}</a>
    {%if not forloop.last %} | {% endif %}
  {% endfor %}
{% endif %} 
```

在我的模板标签中，我有：

```
@register.filter
def add_args(value, args):
    argz = value.strip() + '-' + 'ARGS'
    arglist = args.split(',')
    for arg in arglist:
        keyval = arg.split('=')
        argz.join(keyval[0] + 'ZZ' + keyval[1])
        argz.join('QQ')

    return argz 
```

输出 URL 应如下所示：

```
http://foo.org/john-smith-ARGScustidZZ11QQsortidZZ2 
```

其中 ARGS 是参数的开始，ZZ 是 '=' 而 QQ 是一个 '&' 等价物。

首先：这会起作用，但是我在 add_args() 中得到了 custid=name.id，我想让 custid=11 进入。如何将 id 作为 id 而不是文本传入。

另外，有没有办法像在 PHP 中一样只发送一个 key=>value 数组。在 PHP 中，我会构建一个数组，比如说：

```
arglist = array('custid' => $nameid, 'sortid' => $sortid ); 
```

然后我会将 arglist 作为参数传递给`add_args()`并且`add_args()`我会这样做

```
foreach( arglist as $key => $value)
  $argstr .= $key . 'ZZ' . $value . 'QQ'. 
```

有没有人有更好的方法来完成这项工作？

注意：如果我必须将所有参数作为字符串传递并在过滤器中拆分它们，我不介意。我只是不知道如何将 name.id 作为其值传递...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-26T17:08:24.873

这种“聪明”的东西逻辑不应该在模板中。在您的视图中构建您的 URL 结尾，然后将它们传递给模板：

```
def the_view(request):
  url_stuff = "custid=%s, sortid, ...." % (name.id, 2 ...)

  return render_to_response('template.html',
    {'url_stuff':url_stuff,},
    context_instance = RequestContext(request)) 
```

在 template.html 中：

```
 ....

    <a href='{{url_stuff}}'>{{name}}</a>

 .... 
```

如果您需要一大堆对象的 url，请考虑在模型上使用[get_absolute_url 。](http://docs.djangoproject.com/en/dev/ref/models/instances/#get-absolute-url)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-22T07:47:51.870

你不能传递`name.id`给你的过滤器。过滤器参数可以是单个值或单个文字。Python/Django 不会像 PHP 那样尝试任何“智能”变量替换。

我建议您为此任务创建一个标签：

```
<a href='{% add_args "custid" name.id "sortid" "2" %}{{name|slugify}}{% end_add_args %}'>{{name}}</a> 
```

通过这种方式，您可以知道哪个参数是文字值，哪个应该从上下文中获取等...文档对此非常清楚，请查看[示例](http://docs.djangoproject.com/en/dev/howto/custom-template-tags/#passing-template-variables-to-the-tag)。

此外，如果这`name`与模型相关，比如我们想要访问永久链接，添加一个返回带有正确参数的 URL 的方法可能是最简洁的解决方案。

总的来说，我会避免在模板中加入过多的逻辑。Django 不是 PHP。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-22T04:08:59.220

您调用`argz.join`了几次并且从未将结果分配给任何东西：也许您误以为`join`字符串的方法具有一些神秘的副作用，但事实并非如此-它只是返回一个新字符串，并且如果你不对那个新字符串*poof*做任何事情，它就消失了。这至少是你问题的一部分吗......？

# iphone - 使用标头搜索路径时是否需要包含 .h？

> ID：896169
> 
> 赞同：3
> 
> 时间：2009-05-22T02:38:59.850
> 
> 标签：iphone, xcode

*   我正在引用一个**静态库**。

*   我已经将库项目拖到我的应用程序项目中并**相对**引用它。

*   库中的`.a`文件链接到我的应用程序目标。

*   我在应用程序项目中添加了对库`.h`文件文件夹的引用。`Header Search Paths`

*   然后我将我的应用程序`.pch`文件中的导入添加到库中的特定`.h`文件。

我构建并收到此错误：

```
some.h: No such file or directory 
```

该项目提供了有关在哪里可以找到该库的 .h 文件的信息。为什么它看不到他们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-15T00:36:21.217

尝试

```
#import <some.h> 
```

代替

```
#import "some.h" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T03:17:58.370

我不这么认为。我今天刚刚设置了一个，从下面的链接中拼凑起来。我没有在搜索路径中包含任何 .h 文件。事实上，一个教程告诉我删除任何现有的搜索路径（但我必须将它们添加回另一个库）。希望这能让你走上正轨。

[http://www.clintharris.net/2009/iphone-app-shared-libraries/](http://www.clintharris.net/2009/iphone-app-shared-libraries/)

[http://blog.stormyprods.com/2008/11/using-static-libraries-with-iphone-sdk.html](http://blog.stormyprods.com/2008/11/using-static-libraries-with-iphone-sdk.html)

[http://blog.costan.us/2009/02/iphone-development-and-code-sharing.html](http://blog.costan.us/2009/02/iphone-development-and-code-sharing.html)

# css - 抑制 Firefox 错误控制台中的“过滤器”错误？

> ID：896176
> 
> 赞同：2
> 
> 时间：2009-05-22T02:43:57.953
> 
> 标签：css, debugging, firefox

除了标准方式之外，我目前在我的网站上使用非标准“过滤器”方法呈现不透明度，因为 IE 似乎仍然不支持它，除非我弄错了，否则不透明度是 CSS3 的一部分，而不是反正最后。

我想这更令人烦恼，但 Firefox 正确地指出了解析“过滤器”值的错误，因为它不在标准中。这很棒，除了我在我的 CSS 表中的大约 10 个地方使用它，所以当我调试我的 JavaScript 时，每次刷新时，在我看到任何与我相关的东西之前，我必须游过一大堆无用的“过滤器”警告正在做。

如果我知道它是非标准的并且是特定于浏览器的，有没有办法让 Firefox 专门忽略一些 CSS 代码而不抛出有关它的错误？那将是最干净的解决方案。我不能使用传统的服务器端方法，即不输出 CSS 文件中的代码，因为我正在离线进行大部分测试。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T03:18:28.943

我建议查看条件注释，如[MSDN](http://msdn.microsoft.com/en-us/library/ms537509.aspx#UsingCCs)中所述。

# php - PHP 输出带有标题的文件附件

> ID：896178
> 
> 赞同：5
> 
> 时间：2009-05-22T02:45:02.710
> 
> 标签：php, file, header

在这里阅读了几篇文章后，我制定了这个函数，它是一堆其他函数的混搭：

```
function outputFile( $filePath, $fileName, $mimeType = '' ) {
    // Setup
    $mimeTypes = array(
        'pdf' => 'application/pdf',
        'txt' => 'text/plain',
        'html' => 'text/html',
        'exe' => 'application/octet-stream',
        'zip' => 'application/zip',
        'doc' => 'application/msword',
        'xls' => 'application/vnd.ms-excel',
        'ppt' => 'application/vnd.ms-powerpoint',
        'gif' => 'image/gif',
        'png' => 'image/png',
        'jpeg' => 'image/jpg',
        'jpg' => 'image/jpg',
        'php' => 'text/plain'
    );

    // Send Headers
    //-- next line fixed as per suggestion --
    header('Content-Type: ' . $mimeTypes[$mimeType]); 
    header('Content-Disposition: attachment; filename="' . $fileName . '"');
    header('Content-Transfer-Encoding: binary');
    header('Accept-Ranges: bytes');
    header('Cache-Control: private');
    header('Pragma: private');
    header('Expires: Mon, 26 Jul 1997 05:00:00 GMT');
    readfile($filePath);

} 
```

我有一个 php 页面（file.php），它做这样的事情（很多其他代码被剥离）：

```
 // I run this thru a safe function not shown here
$safe_filename = $_GET['filename']; 
outputFile ( "/the/file/path/{$safe_filename}", 
             $safe_filename, 
             substr($safe_filename, -3) ); 
```

似乎它应该可以工作，而且几乎可以工作，但我遇到了以下问题：

1.  当它是一个文本文件时，我得到一个奇怪的符号作为文本文档中的第一个字母

2.  当它是一个单词文档时，它是损坏的（大概是相同的第一位或字节扔掉了东西）。

3.  我认为所有其他文件类型都会损坏 - 甚至没有尝试过

关于我做错了什么的任何想法？

谢谢 -

**更新：**按照建议更改了代码行 - 仍然是同样的问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T03:41:58.023

好的，我想通了。

上面的脚本确实有效。

发生的事情是我有一系列 include_once 文件，其中一个文件有一个导致问题的空行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T02:57:43.713

不确定这是否是真正的答案，但我认为您是有意的

```
header('Content-Type: ' . $mimeType); 
```

成为

```
header('Content-Type: ' . $mimeTypes[$mimeType]); 
```

# nhibernate - 在持久化之前使用 NHibernate 确定哪些字段已更新（用于验证目的）

> ID：896179
> 
> 赞同：1
> 
> 时间：2009-05-22T02:46:44.937
> 
> 标签：nhibernate, change-tracking

在对我的业务实体进行持久更新之前，我需要执行验证检查以确定哪些属性已更改。例如，某些字段只能在“状态”属性具有特定值时更新。例如，当 Order 实体的 Status 为 finalized 时，只能更新 notes（字符串）字段。这种事情是否可以使用 NHibernate，或者我应该自己跟踪业务实体中的更改？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T12:10:35.443

如果我了解您要做什么，那么加布里埃尔的解决方案并不是您所需要的。如果不是，您可以尝试使用[事件侦听](http://www.codinginstinct.com/2008/04/nhibernate-20-events-and-listeners.html)器。这些允许您在 NHibernate 完成保存/插入/更新/删除之前挂钩到一个常见事件（如保存）并进行一些处理。或者，您可以通过实现 IInterceptor 接口来研究使用拦截器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T02:50:11.763

这种事情确实是可能的。Coding Instinct 有一篇很棒的文章[介绍了 NHibernate.Validator](http://www.codinginstinct.com/2008/05/nhibernate-validator.html)。

# c++ - C++ 线程问题

> ID：896182
> 
> 赞同：3
> 
> 时间：2009-05-22T02:49:03.793
> 
> 标签：c++, multithreading

我有一个对象 Foo 它有一个全局变量 Time currentTime

Foo 有两种从不同线程调用的方法。

```
update()
{
    currentTime = currentTime + timeDelay;
}

restart(Time newTime)
{
    currentTime = newTime;
} 
```

我看到重新启动时的行为，时间正确更改以及 currentTime 似乎没有重置的其他时间（或者它确实重置但随后更新以某种方式将其设置回来。

方法更新大约每秒调用一次，而重新启动仅在用户启动重新启动事件（按下按钮）时发生。我认为这是线程时间问题，欢迎对正在发生的事情提出任何建议或意见。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-22T02:55:22.080

你肯定在这里有一个竞争条件。最严格的解决方案是`currentTime`通过使用锁来保护共享变量的使用。我在这里使用 Boost.Threads 互斥类：

```
class Foo
{
  boost::mutex _access;
  update()
  {
    boost::mutex::scoped_lock lock(_access);
    currentTime = currentTime + timeDelay;
  }

  restart(Time newTime)
  {
    boost::mutex::scoped_lock lock(_access);
    currentTime = newTime;
  }
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T02:59:47.517

线程 1 调用更新，获取 currentTime 的副本并将其保存在其线程本地内存中。线程 2 调用重新启动，将 currentTime 设置为 newTime。线程 2 结束。线程 1 继续，将 currentTime 重新分配给其线程本地内存中的 currentTime（这是您重新启动调用之前 currentTime 的旧值）+ timeDelay。线程 1 现在完成。

因此，您的重新启动将失败。还有许多其他情况可能会导致意外行为。始终同步在不同线程之间共享的变量，以避免此类问题。

您应该使用其他人建议的互斥锁。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T02:56:09.927

在每个函数中添加一些 printfs 以创建正在发生的事情的日志。

例如，如果 update() 在 "currentTime=newTime;" 之后立即在另一个线程中执行，您期望会发生什么？- 甚至更糟 -**在**该行的分配期间。

完成后，请查看： [http ://en.wikipedia.org/wiki/Mutual_exclusion](http://en.wikipedia.org/wiki/Mutual_exclusion)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T02:58:56.317

从两个线程访问相同的变量（正如您所做的那样）需要某种同步。使用互斥锁来保证一次只有一个线程访问该变量，即：

```
update()
{
    // Lock mutex
    currentTime = currentTime + timeDelay;
    // unlock mutex
}
// Same idea for restart() 
```

问题是在没有诸如互斥锁之类的同步原语的情况下访问同一个变量对线程来说是有问题的。假设 update() 读取 currentTime，进行加法，但在它可以存储结果之前，我们切换线程，restart() 就可以了。现在我们切换回update()，它将加法的（现在无效的）结果写回currentTime，覆盖restart()的工作。互斥锁通过允许您保证操作是原子的来防止这种情况发生。谷歌一些教程 - 你需要知道很多其他的东西，比如死锁。

您创建/锁定互斥锁的具体方式取决于您的操作系统/您要使用的库。本机解决方案是 *nix 系统上的 pthreads，Win32 上的关键部分。（Win32 存在 pthreads 实现）Boost 库也有一个线程部分。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T03:20:56.163

在这种情况下，使用互斥锁对我来说感觉太重了。我会改用 InterlockedExchange 和 InterlockedAdd。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T03:21:56.987

您有一个竞争条件，因为在进入关键区域时没有锁定，并且每个都在更新 current_time。每个线程都有一个内存，当一个线程需要从共享内存中获取某些东西时，它会将其复制到它的本地内存中。第一步是先获得一个锁，然后清除它的内存，以保证变量将从共享内存中加载。现在在临界区中操作，一旦完成解锁临界区，保证局部变量将被写出到共享内存。由于您没有锁，因此您无法预测会发生什么。

您需要使用互斥锁，因为 current_time 变量只有一个键。另一种类型的锁定是允许多个键的信号量。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-22T08:56:35.397

如果 currentTime 真的像您说的那样是一个**全局变量，那么您将需要一个****全局互斥锁**来保护该变量。（ PTHREAD_MUTEX_INITIALIZER 或 BOOST.call_once 构造）

在这种情况下，BOOST.Threads 示例是不正确的，因为 Foo 类的两个实例存在于不同的线程中将具有不同的 _access 互斥体实例（我真的不喜欢 _ 前缀！）并且将锁定它们自己的实例并且不保护当前时间变量。

如果 currentTime 是实例变量，则 BOOST.Threads 示例是正确的。

# .net - 哪个 CRT 版本与 .NET 3.5 捆绑在一起？

> ID：896185
> 
> 赞同：1
> 
> 时间：2009-05-22T02:49:48.393
> 
> 标签：.net, deployment, msvcrt

为了最小化部署包，我想知道 .NET redists 中已经包含的 CRT 版本。我已经收集的信息是：

.NET 2.0 -> CRT 8.0.50727.42

.NET 2.0 SP1 -> CRT 8.0.50727.762

但是，我找不到 .NET 3.5 的 CRT 版本。我大致记得我曾经遇到过一个博客页面列出所有版本。但是，我只是无法再次谷歌它......

编辑：所以它是这样的？

.NET 3.5 -> CRT 9.0.21022.8

.NET 3.5 SP1 -> CRT 9.0.30729.1

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T03:17:39.257

9.0.21022.8 我相信。

# random - 在 Fortran 77 中生成给定范围内的随机数

> ID：896187
> 
> 赞同：2
> 
> 时间：2009-05-22T02:51:35.113
> 
> 标签：random, fortran, text-files, fortran77

我是一名初学者，尝试使用 fortran 77 进行一些工程实验。我正在使用 Force 2.0 编译器和编辑器。我有以下查询：

1.  如何在指定范围内生成随机数，例如，如果我需要在 3.0 和 10.0 之间生成单个随机数，我该怎么做？
2.  如何使用文本文件中的数据在程序的计算中调用。例如，我有温度、压力和湿度值（一天的每小时值，因此每个文本文件中总共有 24 个值）。
3.  我是否还需要在程序中定义文本文件中有多少个值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T04:39:15.420

Knuth 已将C 和 FORTRAN中的伪随机数生成器的[源代码发布到公共领域，该生成器在](http://www-cs-faculty.stanford.edu/~knuth/news02.html#rng)*计算机编程的艺术*第 3.6 节中描述。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T03:29:25.863

第二个问题：

例如，如果您的文件如下所示：

```
hour temperature pressure humidity
00   15          101325   60
01   15          101325   60
... 24 of them, for each hour one 
```

这个简单的程序将读取它：

```
implicit none
integer hour, temp, hum
real p
character(80) junkline
open(unit=1, file='name_of_file.dat', status='old')
rewind(1)
read(1,*)junkline
do 10 i=1,24
read(1,*)hour,temp,p,hum
 C   do something here ...
 10  end
close(1)
end 
```

（缩进有点搞砸了，但我不知道如何在这种奇怪的环境中正确设置它）

我的建议：阅读数据类型（INTEGER、REAL、CHARACTER）、数组（DIMENSION）、输入/输出（READ、WRITE、OPEN、CLOSE、REWIND）和循环（DO、FOR），然后你会做有用的东西很快。

我从来没有对随机数做过任何事情，所以我无法帮助你，但我认为 fortran 中有一些内在的功能。我去看看，明天汇报。至于第三个问题，我不确定你的意思（你不知道文件中有多少行数据？或？）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T04:24:31.807

您需要查看编译器手册以了解特定的随机数生成器函数，但它可能会生成 0 到 1 之间的随机数。这很容易处理 - 您只需将间隔缩放为适当的宽度，然后将其转换为匹配正确的起点：即映射到`r`in ，use ，其中是您从随机数生成器获得的值，并且是您想要的范围内的随机值。`[0, 1]``s``[a, b]``s = r*(b-a) + a``r``s`

[Idigas 的回答](https://stackoverflow.com/questions/896187/generating-random-number-in-a-given-range-in-fortran-77/896244#896244)很好地涵盖了您的第二个问题 - 使用格式化输入读取数据，然后像使用任何其他变量一样使用它们。

对于您的第三个问题，您需要定义文本文件中有多少行，只有当您想对所有这些行执行某些操作时 - 如果您正在查看该行，处理它，然后继续，您可以在不知道行数的情况下过活。但是，如果您希望将所有值存储在文件中（例如，具有温度、湿度和压力数组，以便计算蒸汽压统计数据），则需要以某种方式设置存储。通常在 FORTRAN 77 中，这是通过预先分配一个比您认为需要的更大的数组来完成的，但这很快就会成为问题。有没有机会切换到 Fortran 90？更新版本在处理标准化动态内存分配方面有更好的设施，更不用说许多其他优点了。我会*如果可能的话，强烈*建议使用 F90 - 你会让你的生活更轻松。

根据您正在执行的处理类型，另一种选择是研究仅使用单次遍历数据的算法，因此您不需要存储所有内容来计算诸如平均值和标准偏差之类的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-04-07T17:20:56.487

该子例程在 fortran 77 中生成一个介于 0 和 ifin 之间的随机数，其中 i 是种子；一些很棒的数字，例如 746397923

```
 subroutine rnd001(xi,i,ifin)
    integer*4 i,ifin
    real*8 xi
    i=i*54891
    xi=i*2.328306e-10+0.5D00
    xi=xi*ifin
    return
    end 
```

您可以修改以获取一定的范围。

# .net - 在 .NET 中学习 WMI 的好资源？

> ID：896188
> 
> 赞同：0
> 
> 时间：2009-05-22T02:51:50.230
> 
> 标签：.net, resources, wmi

我正在寻找有关学习 WMI 的良好资源的建议。对所有类型感兴趣；书籍、在线、网络广播等。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T03:18:46.977

好吧，当然还有 Windows Management Instrumentation (WMI) 的[MSDN 库文档](http://msdn.microsoft.com/en-us/library/aa394582(VS.85).aspx)。

根据上面链接中发布的社区内容，显然可以使用 Get-WMIObject cmdlet 从 PowerShell 访问 WMI。

请注意，WMI 在历史上是通过 vbscript、COM 和其他“旧”技术访问的。如果您在 .NET 中进行开发，那么使用这些命名空间可能会更好：

```
System.Management 
System.Management.Instrumentation 
```

有关这些命名空间的更多信息，请访问[http://msdn.microsoft.com/en-us/library/ms257340(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms257340(VS.80).aspx)。

亚马逊上有几本关于 WMI 的书；最好的似乎是 Addison Wesley 出版的“开发 WMI 解决方案：Windows 管理规范指南”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T15:24:16.930

其他漂亮的工具是 WMI Code Creator。AAARRGH 我还不能发布链接。去谷歌，搜索

“wmi 代码创建者”站点：www.microsoft.com

这是第一个链接。您可以探索命名空间和类，并且该工具会为您创建代码以在 VB、VBScript 或 C# 中执行方法或进行查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T03:33:04.937

从 PowerShell 专家那里查看“WMI Explorer”。用于交互式探索 WMI 命名空间的好工具。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-10-26T16:41:04.800

链接：

*   [WMI .NET 概述 (MSDN)](http://msdn.microsoft.com/en-us/library/bb404655%28v=vs.90%29.aspx)
*   [WMI 和 .NET：System.Management 让您在托管代码中利用 WMI API（MSDN 杂志）](http://msdn.microsoft.com/en-us/magazine/cc302051.aspx)
*   [.NET 的 WMI 快速介绍 (O'Reilly)](http://ondotnet.com/pub/a/dotnet/2003/04/07/wmi.html)
*   [使用 C#.NET 进行 WMI 编程（MSDN 博客）](http://blogs.msdn.com/b/securitytools/archive/2009/07/29/wmi-programming-using-c-net.aspx)
*   [在托管代码中使用 WMI（开发人员融合）](http://www.developerfusion.com/article/5450/using-wmi-from-managed-code/)

样书章节：

*   [编程 Windows Management Instrumentation (WMI) .NET 示例（第一部分）](http://dotnetprofessional.com/blog/post/2007/09/10/Programming-Windows-Management-Instrumentation-%28WMI%29-NET-Sample-Chapter-Part-I.aspx)
*   [编程 Windows Management Instrumentation (WMI) .NET 示例（第二部分）](http://dotnetprofessional.com/blog/post/2007/09/17/Programming-Windows-Management-Instrumentation-%28WMI%29-NET-Sample-Chapter-Part-II.aspx)

# python - 任何 python 库来访问快速书？

> ID：896193
> 
> 赞同：5
> 
> 时间：2009-05-22T02:53:52.020
> 
> 标签：python, api, quickbooks

我想将我的移动 POS 系统与 quickbooks 集成。我需要客户、卖家、库存和过帐订单和发票。

我一直无法为此找到 python 库。有没有可用的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-12-19T12:58:53.277

我认为这可能对某人有用

首先，您必须自动化 POS

[用 Python 编写的 Orthosie 销售点系统](https://github.com/maxolasersquad/orthosie)

[Wxpos Python 跨平台销售点软件](https://code.google.com/p/wxpos/)（不幸的是，它现在已关闭，但有只读访问权限，也适合研究目的）

其次，您必须将 POS 收集的数据与 quickbooks 集成

[用于访问 Quickbooks API 的 Python 库](https://github.com/sidecars/python-quickbooks)

> 用于访问 Quickbooks API 的 Python 库。quickbooks-python 的完全返工。

# iphone - 在 iphone 上渲染波形

> ID：896194
> 
> 赞同：16
> 
> 时间：2009-05-22T02:53:53.237
> 
> 标签：iphone, audio, waveform

我想知道是否有人对如何渲染音频文件的波形有任何建议。我希望让用户能够设置音轨的入点和出点，并且我需要有一个波形，以便您可以看到放置点的位置。

是否有任何可用的库，或者它是否需要完全定制的解决方案？

它甚至被称为波形吗？也许有一个更好的词，所以我可以做更多的搜索。

蒂亚！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-22T03:19:31.923

我从[这个问题](https://stackoverflow.com/questions/41188/waveform-visualization-in-ruby)重新发布我的答案，因为它也适用于这里：

显示音频波形时，您需要对原始数据进行某种数据缩减，因为音频文件中的可用数据通常比屏幕上的像素多。大多数音频编辑器构建一个单独的文件（称为峰值文件或概览文件），该文件存储音频数据的子集（通常是波形的峰值和谷值）以用于不同的缩放级别。然后，当您放大某个点时，您开始引用原始音频数据本身。

这里有一些关于这方面的好文章：

[波形显示](http://www.xowave.com/doc/ref/waveforms.shtml)

就源代码而言，我建议您查看[Audacity](http://audacity.sourceforge.net/)源代码。Audacity 的波形显示非常好，并且在渲染波形时很可能会进行类似的数据缩减。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T06:25:20.293

CorePlot 是您正在寻找的库。[它托管](http://code.google.com/p/core-plot/)在 Google 代码上。

请参阅这个相关的[SO 问题](https://stackoverflow.com/questions/769749/is-there-a-good-charting-library-for-iphone)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-09-12T20:13:35.593

我意识到这是一篇旧帖子，但是我最近搜索了这个，并决定根据我在 SO 和其他一些网站上找到的一些片段推出我自己的解决方案。

查看我对[这个问题的回答](https://stackoverflow.com/questions/5032775/drawing-waveform-with-avassetreader/7388332#7388332)

# .net - 从 GroupWise 中的电子邮件文件附件拖放到 .NET 应用程序

> ID：896197
> 
> 赞同：4
> 
> 时间：2009-05-22T02:55:39.897
> 
> 标签：.net, winforms, drag-and-drop, groupwise

我正在尝试允许将 Novell GroupWise 中打开的电子邮件中的附件放入我的 C# WinForms 应用程序中。标准的 .NET 功能不起作用。

在控件的 DragDrop 事件中，e.Data.GetFormats() 返回以下内容。

```
FileGroupDescriptorW
FileGroupDescriptor
FileContents
attachment format 
```

我可以使用 e.Data.GetData("FileGroupDescriptor") 获取文件名并转到位置 76。

不幸的是， e.Data.GetData("FileContents") 在 System.Windows.Forms.dll 中导致第一次机会 System.NotImplementedException 并返回 null。附件格式也返回 null。

我的搜索告诉我，拖放比我想象的要复杂得多:) 看起来 GroupWise 可能使用了一种名为 CFSTR_FILECONTENTS 的格式，但这只是一个猜测。附件可以成功拖放到 Windows 桌面或其他文件夹中。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T23:59:00.820

我也没有运气找到这个。这是我想出的（Groupwise 7）：

```
private void control_DragDrop(object sender, DragEventArgs e)
{
   string strFilename = null;

   //something about the act of reading this stream creates the file in your temp folder(?)
   using (MemoryStream stream = (MemoryStream)e.Data.GetData("attachment format", true))
   {
       byte[] b = new byte[stream.Length];
       stream.Read(b, 0, (int)stream.Length);
       strFilename = Encoding.Unicode.GetString(b);
       //The path/filename is at position 10.
       strFilename = strFilename.Substring(10, strFilename.IndexOf('\0', 10) - 10);
       stream.Close();
   }

   if (strFilename != null && File.Exists(strFilename))
   {
      //From here on out, you're just reading another file from the disk...
      using(FileStream fileIn = File.Open(strFilename, FileMode.Open))
      {
          //Do your thing
          fileIn.Close();
      }
   }

   File.Delete(strFilename);
} 
```

# linq - 如何实现外连接表达式树？

> ID：896204
> 
> 赞同：0
> 
> 时间：2009-05-22T03:00:56.953
> 
> 标签：linq, join, lambda, expression, outer-join

我需要使用表达式语法来实现查询（因为我不知道编译时的类型）。例如这样的查询：

```
from customer in Customers
join purchase in Purchases
    on customer.ID equals purchase.CustomerID
into outerJoin
from range in outerJoin.DefaultIfEmpty()
where 
    customer.Name == "SomeName" && 
    range.Description.Contains("SomeString") &&
    customer.ID == range.CustomerID
select 
    new { Customer = customer, Purchase = range } 
```

我找到了实现组加入部分的方法，如下所示：

```
ITable p = _dataContext.GetTable(typeof(Purchases));
ITable c = _dataContext.GetTable(typeof(Customers));

LambdaExpression outerSelectorLambda    = DynamicExpression.ParseLambda(typeof(Customers), null, "ID");
LambdaExpression innerSelectorLambda    = DynamicExpression.ParseLambda(typeof(Purchases), null, "CustomerID");

ParameterExpression param1 = Expression.Parameter(typeof(Customers), "customer");
ParameterExpression param2 = Expression.Parameter(typeof(IEnumerable<Purchases>), "purchases");

ParameterExpression[] parameters = new ParameterExpression[] { param1, param2 };

LambdaExpression resultsSelectorLambda = DynamicExpression.ParseLambda(parameters, null, "New(customers as customers, purchases as purchases)");

MethodCallExpression joinCall = 
 Expression.Call(
   typeof(Queryable),
   "GroupJoin",
   new Type[] { 
      typeof(Customers), 
      typeof(Purchases), 
      outerSelectorLambda.Body.Type, 
      resultsSelectorLambda.Body.Type 
   },
   c.Expression,
   p.Expression,
   Expression.Quote(outerSelectorLambda),
   Expression.Quote(innerSelectorLambda),
   Expression.Quote(resultsSelectorLambda)
); 
```

但我不知道如何使用这种语法编写查询的其余部分。有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-06-11T14:16:12.710

我只是在 dynamic.cs 中复制 + 粘贴了“join”实现，并进行了一些更改以使“GroupJoin”正常工作。

```
public static IQueryable GroupJoin(this IQueryable outer, IEnumerable inner, string outerSelector, string innerSelector, string resultsSelector, params object[] values)
{
    if (inner == null) throw new ArgumentNullException("inner");
    if (outerSelector == null) throw new ArgumentNullException("outerSelector");
    if (innerSelector == null) throw new ArgumentNullException("innerSelector");
    if (resultsSelector == null) throw new ArgumentNullException("resultsSelctor");

    LambdaExpression outerSelectorLambda = DynamicExpression.ParseLambda(outer.ElementType, null, outerSelector, values);
    LambdaExpression innerSelectorLambda = DynamicExpression.ParseLambda(inner.AsQueryable().ElementType, null, innerSelector, values);

    Type resultType = typeof(IEnumerable<>).MakeGenericType(inner.AsQueryable().ElementType);

    ParameterExpression[] parameters = new ParameterExpression[]
    {
        Expression.Parameter(outer.ElementType, "outer"), Expression.Parameter(resultType, "inner")
    };
    LambdaExpression resultsSelectorLambda = DynamicExpression.ParseLambda(parameters, null, resultsSelector, values);

    return outer.Provider.CreateQuery(
               Expression.Call(
                   typeof(Queryable), "GroupJoin",
                   new Type[] { outer.ElementType, inner.AsQueryable().ElementType, outerSelectorLambda.Body.Type, resultsSelectorLambda.Body.Type },
                   outer.Expression, inner.AsQueryable().Expression, Expression.Quote(outerSelectorLambda), Expression.Quote(innerSelectorLambda), Expression.Quote(resultsSelectorLambda)));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-01-24T14:26:56.287

我将遵循一种方法来实现这一目标：

1.  获取与 LINQ 查询等效的表达式。

2.  获取从 LINQ 查询中提取的表达式的 ToString()。

3.  研究表达式，了解输入参数、类型参数、表达式参数等...

如果提到的方法不清楚，请回复我。

# c# - C# 去掉 WebClient 中的 Connection 标头

> ID：896207
> 
> 赞同：13
> 
> 时间：2009-05-22T03:04:57.660
> 
> 标签：c#, webclient

我正在使用 C# 使用 WebClient()。

我正在测试发送了哪些标头，我注意到自动添加了以下标头。

```
Connection : Keep-Alive 
```

有什么办法可以去掉这个吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2010-03-02T08:48:35.407

今天早上我遇到了同样的问题。按照 Jon Skeet 的提示，它可以通过继承`HttpWebRequest`来实现：`WebClient`

```
class MyWebClient : WebClient
{
    protected override WebRequest GetWebRequest(Uri address)
    {
        WebRequest request = base.GetWebRequest(address);
        if (request is HttpWebRequest)
        {
            (request as HttpWebRequest).KeepAlive = false;
        }
        return request;
    }
} 
```

现在发送的标头将包括`Connection : close`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-22T05:30:39.590

使用`HttpWebRequest`代替`WebClient`（它*稍微*不太方便，但不是很方便）并将[`KeepAlive`](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.keepalive.aspx)属性设置为`false`.

我没有对此进行测试——它*可能*只是更改 Connection 标头的值而不是删除它——但值得一试。该[`Connection`](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.connection.aspx)属性的文档至少*表明*它只添加了 Keep-Alive。

# c++ - DLL 互操作/有趣的错误

> ID：896209
> 
> 赞同：0
> 
> 时间：2009-05-22T03:05:35.070
> 
> 标签：c++, c, pointers, interop

```
char ARRAY[1024]; // <-- global 
```

* * *

## 下面的代码有效

```
myFunctionInDll("some string"); // everything ok 
```

* * *

## 下面的代码不起作用

```
myFunctionInDll(ARRAY); // after compilation the entry point of DLL cannot be found 
```

因此，总而言之，如果我将“静态字符串”传递给我的 dll 中的函数，则 dll 可以完美地编译和加载。但是，如果我填充全局数组（字符），然后尝试将其传递给我的函数，它会再次编译，但是当我尝试从我的 C# 应用程序调用函数时，我得到“找不到入口点”。这真的很奇怪，我找不到原因......

谢谢鲁。

有谁知道为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T04:16:15.123

您是编写互操作还是仅使用 .NET 生成的互操作类？如果以后尝试

```
string myStr = "some string";
myFunctionInDll(myStr); 
```

希望有帮助。

# css - Flex 在应用程序下方附加历史跟踪元素

> ID：896215
> 
> 赞同：0
> 
> 时间：2009-05-22T03:11:48.007
> 
> 标签：css, apache-flex, actionscript-3, flex3, history

我有一个使用链接按钮的 Flex 应用程序。一旦我合并了链接按钮（我假设），Flex 框架就开始将历史跟踪元素放在 DOM 中的应用程序下方。例如 IE6-8 得到一个 id 为 的 iframe 元素`ie_historyFrame`，chrome/safari 得到一个`safari_rememberDiv`FF 得到一个`firefox_anchorDiv`。

现在，如果这些元素被框架隐藏了就没有问题了，但事实并非如此。位于 Flex 应用程序下方（在视觉上和在 DOM 中）并拥有一堆序列化的历史数据。

我想知道，有没有办法通过配置或代码隐藏它们？我知道我可以通过 CSS 隐藏它们，但我不得不将 CSS 用于 Flex 应该管理的东西似乎很讨厌。我希望应用程序独立于站点。

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T16:36:43.620

假设您使用的是 Flex Builder，请进入“Flex 编译器”选项下的项目属性并取消选中“启用与浏览器导航的集成”复选框。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-10T19:54:31.823

贴上标签`historyManagementEnabled="false"`。`<mx:Application>`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-24T15:11:40.257

brd6644 的答案对我有用。您必须重新创建文件，然后导出应用程序。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-22T04:59:55.477

您使用的是 SWFAddress 还是其他类似的东西？Flex 没有这个功能，而且 LinkBut​​tons 不会进行任何 ExternalInterface 调用。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-24T21:57:55.143

似乎 flex 创建了一个包含 history.js 和 history.css 文件的历史文件夹。History.js 控制历史数据，history.css - 你猜对了 - 隐藏了历史元素。所以解决方案是在 flex 应用程序的页面上使用 history.css 文件。

为什么开发人员没有使这个可配置，我不知道....

# c# - 用于屏幕文本的 OCR（光学字符识别）

> ID：896224
> 
> 赞同：4
> 
> 时间：2009-05-22T03:18:46.090
> 
> 标签：c#, automation, automated-tests, ocr

我正在尝试创建一个软件，通过捕获屏幕截图来自动化 PC，然后 OCR（光学字符识别）它寻找一个特定的按钮来点击（例如）。我有鼠标和键盘控制部分，但现在，我需要一个 OCR 来处理屏幕截图。我发现 Tesseract OCR 似乎不能很好地处理屏幕上的文本。文本太小，或者某些文本似乎是连接的，例如 K 和 X。我应该怎么做？

p/s：这是一个自动化测试程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-24T11:50:43.267

我不确定这是否真的适合你，但我在自动化中看到的一些更好的 OCR 是由 Tevron 的[CitraTest](http://www.tevron.com/default.asp)完成的。它包含一个字体库，如果不存在字体集，他们将根据您提交的内容创建一个新字体集。此工具的不利因素是成本以及与可变屏幕分辨率相关的常见问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T03:24:03.863

也许在 OCR 之前看看[这个](https://stackoverflow.com/questions/142743/what-software-would-you-recommend-for-image-enhancement-prior-to-ocr-optical-cha)关于图像增强的问题。[否则，这个问题与"OCR for .NET"](https://stackoverflow.com/questions/870280/ocr-for-net)非常相似。

如果您感觉非常大胆，您可以随时提出一个简单的基于感知器或神经网络的方法 :-)

# windows - 什么是工作集？

> ID：896226
> 
> 赞同：17
> 
> 时间：2009-05-22T03:19:12.983
> 
> 标签：windows, memory, process, operating-system

在阅读 Windows Research Kernel 的内存管理代码时，我对工作集的概念感到困惑。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-22T04:05:18.620

“工作集”是“当前算法正在使用的内存部分”的简写，由 CPU 恰好访问的内存部分决定。这对你来说是完全自动的。如果您正在处理数组并将结果存储在表中，则数组和表是您的工作集。

这是因为 CPU 会自动将访问的内存存储在靠近处理器的高速缓存中。工作集是描述您要存储的内存的好方法。如果它足够小，它可以全部放入缓存中，并且您的算法将运行得非常快。在操作系统级别，每次访问新页面（通常大小为 4k）时，内核都必须告诉 CPU 在哪里找到应用程序正在使用的物理内存（解析虚拟地址），因此您也希望尽可能避免这种命中尽可能。

请参阅[What Every Programmer Should Know About Memory - PDF](http://people.redhat.com/drepper/cpumemory.pdf)了解算法性能与工作集大小的关系图（大约第 23 页）以及许多其他有趣的信息。

基本上 - 编写代码以访问尽可能少的内存（即类很小，而不是太多），并尝试确保紧密循环在该内存的非常小的子集上运行。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-22T09:47:11.397

“工作集”是一个非正式术语，表示一个应用程序或一组应用程序“频繁”（对于频繁的定义）访问的内存。应用程序也可能分配它们不经常访问的内存（不超过每几十秒一次，甚至可能不超过一小时一次）；这将在工作集之外。

例如，如果您有两个 Firefox Windows，一个是您几个小时未查看的最小化窗口，另一个是您现在正在浏览的打开的窗口。用于存储与打开的窗口相关的数据的内存将在工作集中；用于存储与未打开的窗口相关联的数据的内存以及您几个小时未查看的数据不在工作集中。

这主要用于讨论您的系统中是否有足够的 RAM。如果您的工作集小于 RAM，您可以轻松地工作，因为您的程序或程序经常访问的数据始终在内存中。如果您的工作集大于 RAM，则操作系统将不断将页面换出到磁盘，以腾出空间来换入应用程序想要访问的页面；这些换出的页面在工作集中，几乎会立即再次被需要，这意味着您必须获取其他页面并将它们写入磁盘，并且它会像这样继续下去。这被称为“抖动”。

如果你没有读取或写入很多文件，你的磁盘灯一直亮着，你的系统感觉很慢，这是一个很好的迹象，表明你正在颠簸。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-22T03:24:58.977

粗略地说，工作集是活跃使用的内存区域。[http://en.wikipedia.org/wiki/Working_set](http://en.wikipedia.org/wiki/Working_set)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T13:53:15.720

工作集是在任何时候物理上在内存中的一组页面。尽管如果引用并以千字节为单位显示工作集，但您可以拥有的最小工作集是 4k（在 Itanium 上为 8K），因为这就是 Windows 中页面的大小。

要查看进程的工作集，请查看任务管理器“进程”选项卡中的“内存使用”列。

如果您正在运行 .NET 应用程序，则可以通过查看任务管理器进程选项卡中的进程来观察工作集的减少情况，然后最小化应用程序。当 Windows 将其换出到页面文件时，它的工作集会大大减少（因为假定该过程不是“工作”那么多）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T04:10:09.567

您的程序正在使用的所有*不在*“工作集”中的内存都被标记为交换到磁盘。当操作系统需要更多内存用于其他工作时，它会尝试将每个程序的工作集保留在内存中，但其他一切都可以获取。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-02-21T20:56:35.803

[术语“工作集”与工作集页面替换算法有关（该算法在Andrew Tanenbaum](https://www.informit.com/articles/article.aspx?p=25260&seqNum=9)的这篇文章中得到了很好的解释）。

因此，工作集是进程在执行期间需要从内存中加载的页数。工作集由最近加载的页面和`k`之前加载的页面组成。当为新的请求页面腾出框架时，只有不在工作集中的页面可以被交换。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-04-15T06:25:03.107

工作集是驻留在物理内存中的虚拟页面的子集。

# c# - 使用 XPath 实现 IXmlSerializable ReadXml() 的最佳方法

> ID：896229
> 
> 赞同：2
> 
> 时间：2009-05-22T03:20:44.680
> 
> 标签：c#, .net, xml, xml-serialization

我正在实现 IXmlSerializable 的 ReadXml() 方法，我认为使用 XPath 可能是最好的方法。

但是，ReadXml() 需要正确处理阅读器位置。

因此，鉴于我的 WriteXml() 会产生如下内容：

```
<ObjectName>
  <SubNode>2</SubNode>
  <SubNode>2</SubNode>
</ObjectName> 
```

有没有比下面的（这种可怕的方式）更好的方法来确保阅读器之后正确定位？

```
public override void ReadXml(System.Xml.XmlReader reader)
{
        reader.Read(); /* Read Opening tag */
        /* Using reader.ReadStartElement("ObjectName") reads forward a node,
           i.e. current node becomes the first <SubNode>
           whereas Read() doesn't even when the documentation says they both do 
        */
        XPathNavigator n = MakeXPathNavigator(reader.ReadSubtree());
        XPathNodeIterator nodes = n.Select(".//SubNode");
        while (nodes.MoveNext())
        {
            /* Do stuff with nodes */
            _values.Add(nodes.Current.ValueAsInt);
        }
        reader.Skip(); /* Skip reader forward */
}

public static XPathNavigator MakeXPathNavigator(XmlReader reader)
{
    try
    {
        return new XPathDocument(reader).CreateNavigator();
    }
    catch(XmlException e)
    {
        throw e; /* Maybe hide/deal with exception */
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T04:44:57.543

我怀疑如果经常使用这种方法，您可能会遇到一些性能问题。由于您的 xml 相对简单，我强烈怀疑您直接使用会做得更好`XmlReader`......

...但这样做并不容易；IMO，最好尽量避免需要实现`IXmlSerializable`（使用常规集合属性等） - 这是错误和挫折的常见原因。

# c# - 如何使用 Linq to SQL 投影到具有自定义类型的字典？

> ID：896231
> 
> 赞同：2
> 
> 时间：2009-05-22T03:21:13.837
> 
> 标签：c#, .net, sql, linq

我正在尝试使用 Linq 将数据库查询中的每一行投影到具有自定义类型作为其值的字典中。我不确定执行此操作的 LINQ 语法？

这是我目前的尝试（它不会编译，但应该展示我正在尝试做的事情）。我在“选择新...”部分遇到问题。

```
public class MyClass
{     
   public Dictionary<int, CustomType> dict;
}

public class MyType{        
   string Name;
   decimal Value;
}

var result = (from t in table
              select new {
                 t.Id,
                 new MyType(t.Name,t.Value)
              }).AsEnumerable().ToDictionary(); 
```

回答：

谢谢杰森。我只是使用属性和自动初始化程序而不是构造函数。工作代码与此类似（欢迎对此进行任何改进）：

```
public class MyType {        
    public string Name {get;set;}
    public decimal Value { get; set;}
}

Dictionary<int, CustomType> dict;

dict = (from t in table
        select new {
           id = av.Account.Id,
           mt = new MyType { Name = t.Name, Value = t.Value }
        }).ToDictionary(item => item.id, item => item.mt); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T03:33:56.527

`MyType`没有带有两个参数的构造函数。

将以下内容添加到 的定义中`MyType`：

```
public MyType(string name, decimal value) {
    Name = name; 
    Value = value;
} 
```

此外，您没有给出由定义的匿名类型成员

```
new MyType(t.Name, t.Value) 
```

一个名字; 尝试将该行更改为：

```
MyType = new MyType(t.Name, t.Value) 
```

编译器会告诉你它无法识别这个匿名成员的名字。

`ToDictionary`最后，没有没有参数的重载。假设您将上述匿名成员命名为 be `MyType`，将调用更改`ToDictionary`为

```
....ToDictionary(item => item.Id, item => item.MyType); 
```

# .net - 如何在没有消息泵送的情况下等待 WaitHandle？

> ID：896233
> 
> 赞同：11
> 
> 时间：2009-05-22T03:21:58.827
> 
> 标签：.net, multithreading, com

我想调用`WaitHandle.WaitOne(TimeSpan)`.NET，但我在 STA 线程上，它在等待时会发送消息。由于超出此问题范围的原因，我需要等待*而不*抽水。如何在不发送消息的情况下等待 WaitHandle 发出信号？

在某些情况下`WaitHandle.WaitOne`似乎不会发送消息。但有时它确实适用于某些消息。有关这方面的更多信息，请参阅这些链接：

1.  [Microsoft Windows 中的托管和非托管线程](http://msdn.microsoft.com/en-us/library/74169f59.aspx)
2.  [有管理的屏蔽](http://blogs.msdn.com/cbrumme/archive/2003/04/17/51361.aspx)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-22T03:38:11.087

WaitForSingleObject 或 WaitForMultipleObjects 是非泵送等待；使用 p/invoke。

```
[DllImport("kernel32", SetLastError=true, ExactSpelling=true)]
public static extern Int32 WaitForSingleObject(SafeWaitHandle handle, Int32 milliseconds); 
```

-Oisin

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-10T23:41:42.140

显然这是[在 Microsoft Vista 中引入的一个变化](http://blogs.msdn.com/b/yvesdolc/archive/2009/08/06/do-you-receive-wm-paint-when-waiting-for-a-com-call-to-return.aspx)： `CoWaitForMultipleHandles`现在发送`WM_PAINT`消息。

[Vista 错误报告](http://connect.microsoft.com/VisualStudio/feedback/details/330906/vista-bug-iterating-a-com-collection-with-foreach-causes-your-thread-to-be-reentered-during-the-iteration-via-a-message-pump-this-happens-with-free-threaded-com-objects-that-do-not-cross-apartments)。

一种解决方法是使用 Microsoft 的应用程序兼容性工具包为您的应用程序设置 DisableNewWMPAINTDispatchInOLE 标志。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-23T13:34:10.893

如果您在 WPF 应用程序中，其中 Dispatcher 是在托管等待期间运行消息泵的人，那么在等待期间禁用消息泵的最简单方法是通过[Dispatcher.DisableProcessing](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcher.disableprocessing.aspx)：

```
// The Dispose() method is called at the end of the using statement. 
// Calling Dispose on the DispatcherProcessingDisabled structure,  
// which is returned from the call to DisableProcessing, will 
// re-enable Dispatcher processing. 
using (Dispatcher.CurrentDispatcher.DisableProcessing())
{
    // Do work while the dispatcher processing is disabled.
    Thread.Sleep(2000);
} 
```

# javascript - 从 iPhone 原生应用访问 Google API

> ID：896234
> 
> 赞同：4
> 
> 时间：2009-05-22T03:23:22.587
> 
> 标签：javascript, iphone, objective-c, gdata

我想从 iPhone 原生应用程序中访问一些 Google API。我不是网络程序员，也从未使用过 AJAX，但我猜我需要在 Objective-C 和 Javascript 之间架起某种桥梁。理想情况下，我会在 Google 上触发 XML 并处理结果。

我真的不知道要开始。

有没有人成功地做到了这一点，或者知道任何好的资源？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T03:27:15.573

请参阅 gdata-objectivec-client：Google 数据 API 的官方 Objective-C 客户端库（它也适用于 iPhone。）请参阅[http://code.google.com/p/gdata-objectivec-client/](http://code.google.com/p/gdata-objectivec-client/)。
除非您指的是 AJAX 搜索 API - 请参阅[http://code.google.com/apis/ajaxsearch/documentation/#fonje](http://code.google.com/apis/ajaxsearch/documentation/#fonje) - 这将提供 JSON 响应。

# c# - 数据表与 IEnumerable

> ID：896238
> 
> 赞同：25
> 
> 时间：2009-05-22T03:25:58.663
> 
> 标签：c#, list, datatable, ienumerable

我正在与另一位与我一起工作的程序员进行辩论。

对于数据库返回类型，是否存在任何显着的内存使用或性能差异，或其他应使某人避免使用 DataSets 和 DataTables 并偏爱实现`IEnumerable<T>`...的类型或反之亦然的缺点

我更喜欢返回实现`IEnumerable<T>`( `List<T>, T[] etc`) 的类型，因为它更轻量级，在访问属性时对对象进行强类型化，允许有关底层类型的更丰富的信息等。尽管手动使用数据读取器时，它们确实需要更多时间来设置。

这些天使用 DataTables 的唯一原因仅仅是懒惰吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-22T03:33:40.007

DataTables 肯定比 Lists 重得多，无论是在内存需求方面，还是在创建/填充它们所花费的处理器时间方面。
使用 DataReader 比使用 DataTables 快得多（虽然更冗长）（我假设您正在使用 DataAdapter 来填充它们）。

也就是说......除非这是在某个**真正**重要的地方，否则你可能会很好，两种方法都足够快，所以在每种情况下都选择更舒服的方法。（有时你想用很少的代码来填充它们，有时你想用很少的代码来阅读它们）

我自己倾向于只在绑定到 GridView 时使用 DataTables，或者当我需要同时激活多个结果集时。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-22T11:11:44.470

使用 System.Collections 类的另一个优点是您可以获得更好的排序和搜索选项。我不知道有任何合理的方法可以改变 DataTable 的排序或搜索方式；使用集合类，您只需让您的类实现 IComparable 或 IEquatable，您就可以完全自定义 List.Sort 和 List.Contains 的工作方式。

此外，对于列表，您不必担心 DBNull，它不止一次让我绊倒，因为我期待 null 并得到了 DBNull。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-09-21T04:53:32.027

我还喜欢这样一个事实，`IEnumerable<T>`即您可以使用方法和属性来增强集合的底层类型，这使得实现更加优雅，代码更易于维护。例如 FullName 属性。如果您无法控制，您还可以向该类添加扩展方法。

```
public class SomeUser
{
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public string FullName { get { return String.Format("{0} {1}", FirstName, LastName); } }
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-22T03:42:39.867

直接使用 DataTables 意味着将自己绑定到底层数据源及其布局方式。从可维护性的角度来看，这并不好。如果您的视图需要的只是一些对象的列表，那么您应该提供的就是这些。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2017-04-25T15:55:29.330

我发现通过 sql 使用大表，数据表比 IEnumerable 快得多。我在一个 HTML 页面中转储了一个包含 26k 行和 25 列的表。数据表用了 3 秒，IEnumerable 用了 9 秒。我投票给数据表。除类型外，所有代码相同。

# .net - 如何将 CLR 加载到进程中

> ID：896252
> 
> 赞同：3
> 
> 时间：2009-05-22T03:35:50.990
> 
> 标签：.net, clr

我有个问题困扰了我很久。

1.  CLR与OS创建的一个进程有什么关系？
2.  当我们双击“控制台应用程序”或“Windows 窗体应用程序”时，加载 CLR 的步骤是什么？
3.  我找到了两种方法：_CorExeMain() 和 _CorBindToRuntimeEx()。他们的作用是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T06:32:02.607

请参阅[托管公共语言运行时、将公共语言运行时](http://msdn.microsoft.com/en-us/library/9x0wh2z3.aspx)加载[到进程](http://msdn.microsoft.com/en-us/library/01918c6x.aspx)中、[_CoreExeMain 函数](http://msdn.microsoft.com/en-us/library/xh0859k0.aspx)、[CorBindToRuntimeEx 函数](http://msdn.microsoft.com/en-us/library/99sz37yh.aspx)。

我认为基本答案是，CLR 必须在进程（主机）中运行。如果您“双击”，则会创建一个进程（最初纯粹是非托管的），然后将 CLR 加载到该进程中（例如，使用 CorBindToRuntimeEx）。

# c# - C# HttpWebRequest 与 WebRequest

> ID：896253
> 
> 赞同：114
> 
> 时间：2009-05-22T03:35:59.523
> 
> 标签：c#, httpwebrequest

我看到了这段代码：

```
var request = (HttpWebRequest) WebRequest.Create("http://www.google.com"); 
```

为什么需要投`(HttpWebRequest)`？为什么不直接使用`HttpWebRequest.Create`？为什么`HttpWebRequest.Create`make a `WebRequest`，而不是 a `HttpWebRequest`？

* * *

## 回答 #1

> 赞同：134
> 
> 时间：2009-05-22T03:38:36.173

该`Create`方法是静态的，并且仅存在于`WebRequest`. 调用它`HttpWebRequest.Create`可能看起来不同，但它实际上编译为调用`WebRequest.Create`。它似乎只是`HttpWebRequest`因为继承而开启。

该`Create`方法在内部使用工厂模式根据`Uri`您传递给它的实际创建对象。您实际上可以取回其他对象，例如 a`FtpWebRequest`或`FileWebRequest`，具体取决于`Uri`.

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-10-08T10:07:24.047

`WebRequest`是一个抽象类，它有一个工厂方法`Create`，根据传入的 URL，创建一个具体子类的实例。您是否需要或想要 `HttpWebRequest httpreq = (HttpWebRequest)WebRequest.Create(strUrl);`而不是 `WebRequest req = WebRequest.Create(strUrl);`取决于您的需求，以及您传入的 URL 类型。

如果您只传入 HTTP: URL，那么前面的代码允许您访问`HttpWebRequest`除了在基类上定义的属性和方法之外的子类实现的属性和方法`WebRequest`。但是如果你传入了一个 FTP: URL，那么转换到的尝试`HttpWebRequest`就会失败。

后者是通用的，不会在任何受支持的 URL 类型上失败，但当然，如果不强制转换为任何子类，您只能访问基类定义的属性和方法。

*——通过马丁·霍南*

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-05-02T23:04:35.607

仅当您需要访问 HttpWebRequest 独有的成员时才需要强制转换。这个想法是，如果 WebRequest 支持的属性/方法足够，那么您可以编写一个适用于多种类型的请求/响应协议的应用程序。在这种情况下，URI 可以是用户使用可插入协议支持的任何协议给出的东西。甚至可以在不改变原始软件的情况下支持新协议。

如果您的应用程序需要更多地控制特定于特定协议的功能，那么您可以将 requestUri 限制为您支持的方案并将 WebRequest 转换为适当的特定于协议的子类。这限制了您的应用程序支持的协议，但使您能够调整协议特定的功能。

# java - Java 类加载运行速度极慢？

> ID：896255
> 
> 赞同：7
> 
> 时间：2009-05-22T03:36:22.487
> 
> 标签：java, performance, reflection

我正在尝试动态加载 java .class 文件并通过反射调用它。

我有一个名为 Foo 的课程；它有一个空的构造函数和一个名为 doit() 的方法，它接受一个字符串参数并返回一个字符串。它还反转字符串。

这是我的代码：

```
 URL url = new URL("file://C:/jtest/");
    URLClassLoader loader = new URLClassLoader(new URL[]{url});
    Class<?> cl = loader.loadClass("Foo");
    Constructor<?> cons = cl.getConstructor((Class[])null);
    Object ins = cons.newInstance(new Object[]{});
    Method meth = cl.getDeclaredMethod("doit", String.class);
    Object ret = meth.invoke(ins, new Object[]{"!dlroW olleH"});
    System.out.println((String)ret); 
```

正如预期的那样，这将打印“Hello World！”。但是，大约需要**30 秒**才能完成。我知道反射很慢，但我希望它是 10 毫秒或其他东西。

我正在使用带有 JRE 1.6.0_13 的 Eclipse，并且正在运行 Windows Vista。

我在这里做错了什么？

谢谢。

**编辑：**我已经分析了代码，它的所有时间都用于第三行（loadClass（））。其他一切都会立即发生。

**编辑：**我把代码放在一个循环中；慢速功能以某种方式得到优化，仅在第一个循环上需要 30 秒。

**编辑：**我找到了解决方案。

代替：

`URL url = new URL("file://C:/jtest/");`

我将其更改为：

`URL url = new URL("file:/C:/jtest/");`

现在它完美地工作了。我不知道它为什么起作用，但我不明白我（和其他 5 人）怎么会错过它。现在觉得很傻。。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-09-30T09:09:52.153

供您参考：对您来说可能有点晚了，但我偶然发现了同样的问题并找到了这篇文章。

看起来 // 正在强制进行远程搜索，如果您使用 -verbose:class 运行，则会加载一个 UnknownHostException ，因此必须在类加载期间在内部抛出该异常。

我尝试了以下方法：

URL url = new URL("file://localhost/C:/jtest/");

这（几乎）与您的单斜杠解决方案一样快。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-22T03:43:27.683

检查您的默认类路径。也许它指的是不可用的网络共享或类似的东西。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-22T03:46:37.613

在 30 秒时，您应该能够“分析”您的代码并准确查看问题所在（加载类？创建实例？查找方法？等等？）

由于它需要 30 秒（而不是更小的东西，大约 10 毫秒左右），您可以`System.out.println(new Date());`在代码的每一行之间使用。

我怀疑你会发现 loader.loadClass(String) 花了这么长时间 - 我怀疑你会发现你有一个很长的类路径，或者一个包含某种网络资源的类路径。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-22T03:52:54.257

当您创建实例时，它可能会导致许多其他类加载，其中一些具有静态初始化程序，这些初始化程序会执行需要很长时间的操作。将此代码放入循环中，然后查看后续对象创建的成本。

**编辑**：很酷，根据您的分析，这听起来像是您接近根本原因。要考虑的另一件事是，如果您使用的库启动成本很高。我使用 iBatis 来管理我们与 Oracle 的交互，当它第一次启动时，它会读取一堆 XML 文件并处理其中的查询模式。有明显的滞后。听听您的发现会很有趣，但您可能会认为一次性成本是可以忍受的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-22T03:45:36.690

您的代码没有任何问题...我能够在不到一秒钟的时间内编译您的程序。我在 Vista Business 上运行 java 1.6.11。

也许你的`public string doit(string arg)`方法需要这么长时间。您可以尝试在不使用反射的情况下调用它，看看是否需要很长时间？尝试`doit()`简单地返回您传入的参数（而不是反转字符），看看您的反转算法是否会减慢它的速度。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-22T03:57:25.560

您是否可以将 Foo 放在默认的 CLASSPATH 中，以便您可以使用以下内容：

```
ClassLoaderTest.class.getClassLoader() 
```

，其中 ClassLoaderTest 是您正在运行的类。或者，如果您没有在静态上下文中运行，则提供：

```
this.getClass().getClassLoader()` 
```

这些中的任何一个都可以帮助您实例化一个新的类加载器。

但是我不知道这是否会帮助您（您必须进行分析），并且反射总是会明显变慢。没有办法解决这个问题。当然，出于这个和其他原因，它应该在生产中最少使用。

编辑：由于 loadClass 花费了大部分时间，可能是 C:\jtest 杂乱无章。您可以尝试将 Foo.class 单独放在一个目录中并将其用作 URL。当然，第二次更快的原因是 Foo 已经加载了。

# objective-c - 选择器关键字

> ID：896256
> 
> 赞同：-4
> 
> 时间：2009-05-22T03:36:53.130
> 
> 标签：objective-c, uibutton

```
-(void)clicketbutton{ 
    UIButton *mybutton = [UIButton buttonWithType:UIButtonTypeCustom];
    [mybutton setTitle:@"Click here" forState:UIControlStateNormal];
    [mybutton addTarget:self action:@selector(displayvalue:)forControlEvents:UIControlEventTouchUpInside];
}

-(void)displayvalue:(id)sender{
UIButton *resultebutton= [UIButton buttonWithType:UIButtonTypeCustom];

resultebutton=sender;// pls clear here.. my question here , it it possible or not. if possible how ? NSLog(@" The buttontitile is %@ ", [resultebutton.Title] // here also. } 
```

在上面的代码中，我创建了一个按钮并将标题设置为`Click here`. 当我按下那个按钮时，我想打印`Click here`，我的意思是它的标题。为此，我的代码在这里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T03:47:58.927

iid 是发送者，一个指向调用你的 displayvalue 方法的控件的指针。您将指针转换为整数，并打印整数结果。我不确定您要完成什么，但是从按钮获取整数到按钮操作方法的最快方法是将其存储在`tag`属性中。

如果你更详细地了解你正在做什么，我可能能够描述在 Cocoa 应用程序中建模的最佳方法。另外，一个提示——在试图找出为什么某些东西不起作用之前，一定要修复代码中的任何警告！例如，那个 id -> int 赋值会让编译器抱怨。

# sql - Postgres 中的正则表达式 - 不做我想做的事情（新手问题）

> ID：896259
> 
> 赞同：1
> 
> 时间：2009-05-22T03:38:08.513
> 
> 标签：sql, regex, postgresql

我在 postgres 的查询中有这个正则表达式，但我无法弄清楚为什么它在正则表达式中指定的文本之后不匹配任何内容；

这个想法是删除最后一部分，包括之间的分隔符。

我有这样的记录要匹配：

```
Villa hermosa, Pilar, PCIA. BS. AS.    
Esmeralda - Pilar - BUENOS AIRES.    
San Martin, BUENOS AIRES.- 
```

我正在使用这个表达式：

```
 regexp_replace(location,
 '([,\s\.-]*PCIA. BS. AS[,\s\.-]*|
   [,\s\.-]*BUENOS. AIRES[,\s\.-]*$|
   [,\s\.-]*BS. AS[,\s\.-]*$|
   [,\s\.-]*P.B.A[,\s\.-]*$)', '' ) 
```

这在 PCIA, BUENOS 文本中运行良好，但它没有使用 ',' '。'-' 也不是单词后的空格。我需要帮助找出问题所在。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T03:43:56.780

将反斜杠加倍。`\ => \\`

Postgres 认为您正在对字符串本身进行转义。

在默认情况下打开的较新 PostgreSQL 版本中，`standard_conforming_strings`不再需要双反斜杠，除非您使用`E'string'`或已明确设置`standard_conforming_strings`为`off`.

# sql-server - MS Access（前端）和使用 SQL Server（后端）的第一条记录中缺少数据

> ID：896265
> 
> 赞同：0
> 
> 时间：2009-05-22T03:42:30.270
> 
> 标签：sql-server, database, ms-access

我有一个数据库，我刚刚使用 SSMA 将后端转换为 SQL Server。我将前端留在了 MS Access 中。我只转换了表格而不是查询。它已经有一些数据，并且移动得很好。

直到最近，一切都很顺利。打开数据库并加载主窗体事件兴趣时，它开始遇到子窗体的第一条记录（称为名称）的问题。第一个记录中的第一个字段有时包含数据，而其他字段则没有。这是一个文本字段。当数据在字段中时，它会放入随机数。我相信它们可能与 SQL 有关。当没有数据/缺失时，您可以选择该字段并点击退格按钮，数据将显示减去您刚刚擦除的一个字符。我不知道发生了什么。

您能提供的任何帮助我将不胜感激。先感谢您。

我是 SQL Server 的新手，我已经使用旧版本的 MS Access 几年了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T16:41:10.713

我不确定问题可能是什么，但这些是我想到的一些考虑因素：

1.  尝试删除并重新创建您的链接表。也许对表结构（或视图，如果您链​​接到视图）的更新使存储在前端表链接中的一些元数据无效。

2.  你的表有主键吗？如果没有，你真的需要一个。在没有 PK 的关系数据库中，确实没有设计得当的数据表。

3.  你的表有时间戳吗？如果没有，请添加一个，因为这有助于 Access 跟踪服务器上的数据是否已更改。

但是，让我补充一点，这些问题都没有完全体现在您所描述的症状中，因此它们可能无济于事。

# sql-server - 在 SQL Server 2008 中连接了哪个数据库以进行睡眠连接？

> ID：896271
> 
> 赞同：0
> 
> 时间：2009-05-22T03:44:37.903
> 
> 标签：sql-server

我正在.NET Framework 3.5 上开发一个 Web 应用程序。数据库服务器为SQL Server 2008。在web.config的connectionStrings中，数据库名称设置为“mydatabase”。最小池大小设置为 50。当我使用 sp_who 检查数据库连接时，我发现大多数睡眠连接的 dbname 是 master，而不是“mydatabase”。我的问题是：是掌握所有睡眠连接的数据库，还是我的配置有问题？

谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T06:47:29.137

> > 对于大多数睡眠连接，dbname 是 master，而不是“mydatabase”。

在 SQL Server 中，用户会话（spid 或 session_id）从 51 开始，50 之前的任何会话都是系统后台进程。主数据库保存了大多数这些后台进程的关键信息，您所看到的无需担心。

# postgresql - 从 PostgreSQL 序列中选择多个 id

> ID：896274
> 
> 赞同：26
> 
> 时间：2009-05-22T03:47:32.683
> 
> 标签：postgresql, select, nextval

是否有一种简洁的方法可以在 1 个查询中多次选择 PostgreSQL 序列的 nextval？这将是唯一返回的值。

例如，我想做一些非常简短和甜蜜的事情，比如：

```
SELECT NEXTVAL('mytable_seq', 3) AS id; 
```

并得到：

```
 id  
-----
 118
 119
 120
(3 rows) 
```

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-05-22T05:09:22.103

```
select nextval('mytable_seq') from generate_series(1,3); 
```

generate_series 是一个函数，它返回许多带有序列号的行，由它的参数配置。

在上面的例子中，我们不关心每一行的值，我们只是使用 generate_series 作为行生成器。对于每一行，我们都可以调用 nextval。在这种情况下，它返回 3 个数字（nextvals）。

您可以将其包装到函数中，但考虑到查询有多短，我不确定它是否真的很明智。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-25T20:33:09.020

关于这个确切问题有一篇很棒的文章：“[从序列中获取多个值](http://www.depesz.com/index.php/2008/03/20/getting-multiple-values-from-sequences/)”。

如果性能不是问题，例如当使用序列值使获取它们的时间相形见绌或*n*很小时，则*SELECT nextval('seq') FROM generate_series(1,n)*方法是最简单和最合适的。

但是在为批量加载准备数据时，文章中的最后一种方法是从锁中将序列增加*n*是合适的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T04:16:28.027

```
 CREATE OR REPLACE FUNCTION foo() RETURNS SETOF INT AS $$
DECLARE
    seqval int; x int;
BEGIN
x := 0;

WHILE x < 100 LOOP
    SELECT into seqval nextval('f_id_seq');
    RETURN NEXT seqval;
    x := x+1;
END LOOP;
RETURN;
END;
$$ LANGUAGE plpgsql STRICT; 
```

当然，如果您要做的只是推进序列，则可以[使用 setval()](http://www.postgresql.org/docs/8.3/static/functions-sequence.html)。

您还可以让函数获取循环次数的参数：

```
CREATE OR REPLACE FUNCTION foo(loopcnt int) RETURNS SETOF INT AS $$
DECLARE
    seqval int;       
    x int;
BEGIN
x := 0;
WHILE x < loopcnt LOOP
    SELECT into seqval nextval('f_id_seq');
    RETURN NEXT seqval;x := x+1;
END LOOP;
RETURN;
END;
$$ LANGUAGE plpgsql STRICT; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-23T21:16:08.847

除非您真的想要返回三行，否则我会将每个选择的序列设置为“INCREMENT BY 3”。然后你可以简单地将 1 和 2 添加到结果中，得到你的三个序列号。

我试图添加一个指向 postgresql 文档的链接，但显然我不允许发布链接。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T03:49:16.463

我目前最好的解决方案是：

```
SELECT NEXTVAL('mytable_seq') AS id
UNION ALL
SELECT NEXTVAL('mytable_seq') AS id
UNION ALL
SELECT NEXTVAL('mytable_seq') AS id; 
```

这将正确返回 3 行......但我想要一些最小的 SQL，即使是 100 或更多的 NEXTVAL 调用。

# jquery - 如何使用 JQuery 在图像上显示框？

> ID：896283
> 
> 赞同：1
> 
> 时间：2009-05-22T03:57:11.643
> 
> 标签：jquery, image

我目前有一个图像，我希望人们的注释显示在该图像上，其中注释实际上具有相对于图像的 x、y 坐标以及宽度和高度。假设现在注释中实际上没有文本——它们只是空框。

我想知道在图像上显示一个空框的最佳方法是什么，以便用户可以单击它。我知道要提高注释框的 z-index，但我不确定在哪里调用 JQuery 插入函数，因为标记只能包含图像。我应该将图像包装在 a 中并调用 Jquery 将注释 div 插入图像的父 div 吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T04:16:11.160

那这个呢

XHTML

```
<div class="img-container">
   <img src="image.jpg" alt="" />
</div> 
```

CSS

```
.img-container {
    display: block;
    width: 300px;
    height: 300px;
    position: relative;
}

.img-container img {
    display: block;
    width: 100%;
    height: 100%;
}

.img-container span {
    display: block;
    width: 50px;
    height: 30px;
    position: absolute;
    top: 0;
    left: 0;
} 
```

查询

```
$(document).ready(function() {
    // calculate the annotation text here
    $('.img-container').append('<span>' + annotationText  + '</span>')

}); 
```

那应该滚动... :)

# xml - 如何通过 html 将 QueryString 参数传递给 Flash swf movie parameter? I have a html for render Flash swf files and this has its parameter "movie" and this "movie" value is the url of the swf. And in my swf, I have a method loadXml("m 问问题 问问题 2009-05-22T03:58:54.660 6330 次 This question shows research effort; it is useful and clear 2 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. I have a html for render Flash swf files and this has its parameter "movie" and this "movie" value is the url of the swf. And in my swf, I have a method loadXml("myXMLFile.xml") that reads a xml, get its attributes and show them in swf. So far so good... But, what I'm looking for is to pass a QueryString in the movie value, such as "myMovie.swf?myFile=anotherXMLFile.xml" and makes the swf loads this querystring parameter and loads the "anotherXMLFile.xml" instead of the "myXMLFile.xml". That is... I want to dynamically send to swf the XML File I want to load... Is there a way to do that?? You can check out this post: Flash: Passing Variables to Flash from HTML via Query String If that doesn't take care of what you're looking for, you can also check out: SwfObject SwfObject gives you a way to load up a SWF and pass parameters to the SWF via javascript. You could access your page query string variables and pass them to the SWF that way. xmlflashquery-string 4 1 回答 1 This answer is useful 2 你可以看看这个帖子： Flash：通过查询字符串将变量从 HTML 传递到 Flash 如果这不能满足您的需求，您还可以查看： 对象 SwfObject 为您提供了一种加载 SWF 并通过 javascript 将参数传递给 SWF 的方法。您可以访问您的页面查询字符串变量并以这种方式将它们传递给 SWF。 于 2009-05-22T04:09:20.407 回答 Related 0 android - 通过类加载器使用 com.android.phone 类 3 java - 隐藏所有子组件时隐藏的 Wicket 容器 1 c# - 如何填写 IEnumerable 在 HttpPost 请求 mvc 3 之后？ 1 extjs - 加载不正确的商店 1 android - 为什么它不是立方体？ 1 php - Dojo 数据网格到 Excel 文件 1 php - 如果子类别在 wordpress 中有多个父类别，我们如何管理？ 1 ios - 通过“www.google.com/glm/mmap”获取经度和纬度 2 android - ViewPager 不使用 FragmentPagerAdapter 滑动 3 android - android缺少什么来显示我的弹出窗口 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：896286
> 
> 赞同：2
> 
> 时间：
> 
> 标签：xml, flash, query-string

I have a html for render Flash swf files and this has its parameter "movie" and this "movie" value is the url of the swf.

And in my swf, I have a method loadXml("myXMLFile.xml") that reads a xml, get its attributes and show them in swf. So far so good...

But, what I'm looking for is to pass a QueryString in the movie value, such as "myMovie.swf?myFile=anotherXMLFile.xml" and makes the swf loads this querystring parameter and loads the "anotherXMLFile.xml" instead of the "myXMLFile.xml".

**That is... I want to dynamically send to swf the XML File I want to load...**

Is there a way to do that??

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T04:09:20.407

你可以看看这个帖子：

[Flash：通过查询字符串将变量从 HTML 传递到 Flash](http://www.permadi.com/tutorial/flashQueryString/)

如果这不能满足您的需求，您还可以查看：

[对象](http://code.google.com/p/swfobject/)

SwfObject 为您提供了一种加载 SWF 并通过 javascript 将参数传递给 SWF 的方法。您可以访问您的页面查询字符串变量并以这种方式将它们传递给 SWF。

# c++ - 从有序的字符序列递归生成有序子字符串？

> ID：896290
> 
> 赞同：3
> 
> 时间：2009-05-22T04:03:56.760
> 
> 标签：c++, algorithm, recursion, substring, sequences

***得到答案后编辑***

这里有一些很好的答案。我喜欢 Josh 的，因为它非常聪明并且使用 C++。但是，我决定接受 Dave 的回答，因为它简单且具有递归性。我对它们都进行了测试，它们都产生了相同的正确结果（尽管顺序不同）。所以再次感谢大家。

* * *

假设我有一个字符串 s 的字符 s[0]:s[N] 并且每个字符 s[i] <= s[i+1] 例如字符串

```
aaacdddghzz 
```

我想生成子字符串的所有组合，同时保持字符之间的相同关系。

所以例如我会得到

```
a
aa
aaa
ad
aad
aaad
add
aadd
aaadd
addd
aaddd
aaaddd
d
dd
ddd
.
.
.
ac
aac
.
.
.
acdddghzz
aacdddghzz
aaacdddghzz 
```

但不是

```
ca
hdz
...etc 
```

现在我知道如何计算出有多少种组合。您创建字符串中字母频率的直方图。所以在上面的例子中，那将是

对于字符串 aaacdddghzz

```
a=3
d=3
c=1
g=1
h=1
z=2 
```

公式是`(a+1)(c+1)(d+1)(g+1)(h+1)(z+1) = 4*4*2*2*2*3 = 384`。有 384 个子字符串保持 s[i] <=s [i+1] 关系。

所以问题是如何递归地生成这 384 个子字符串？实际上，迭代方法同样好，也许更好，因为具有许多唯一字符的大字符串可能会导致堆栈溢出。这听起来像是家庭作业，但事实并非如此。我只是想出这样的算法没用。我使用 C++，但伪代码会很好。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T04:28:14.053

对 Ryan Shaw 上述回答的修正：

不是以二进制计数，而是根据每个字母的数量计算基数中的每个数字。例如：

```
a d c g h z
3 3 1 1 1 2 
```

所以算了：

```
0 0 0 0 0 0
0 0 0 0 0 1
0 0 0 0 0 2
0 0 0 0 1 0
0 0 0 0 1 1 
0 0 0 0 1 2
0 0 0 1 0 0
...
0 0 0 1 1 2
0 0 1 0 0 0
...
0 0 1 1 1 2
0 1 0 0 0 0 
...
0 3 1 1 1 2
1 0 0 0 0 0
...
3 3 1 1 1 2 
```

而且您已经枚举了所有可能的子集，没有重复。对于其中任何一个，输出字符串只是循环数字并输出指定数量的每个字母的问题。

```
1 2 0 0 1 1 => addhz
3 0 0 0 1 2 => aaahzz 
```

和代码：

```
void GetCounts(const string &source, vector<char> &characters, vector<int> &counts)
{
    characters.clear();
    counts.clear();

    char currentChar = 0;
    for (string::const_iterator iSource = source.begin(); iSource != source.end(); ++iSource)
    {
        if (*iSource == currentChar)
            counts.back()++;
        else
        {
            characters.push_back(*iSource);
            counts.push_back(1);
            currentChar = *iSource;
        }
    }
}

bool Advance(vector<int> &current, const vector<int> &max)
{
    if (current.size() == 0)
        return false;

    current[0]++;
    for (size_t index = 0; index < current.size() - 1 && current[index] > max[index]; ++index)
    {
        current[index] = 0;
        current[index + 1]++;
    }
    if (current.back() > max.back())
        return false;
    return true;
}

string ToString(const vector<int> &current, const vector<char> &characters)
{
    string result;
    for (size_t index = 0; index < characters.size(); ++index)
        for (int i = 0; i < current[index]; ++i)
            result += characters[index];
    return result;
}

int main() { 
    vector<int> max;
    vector<char> characters;

    GetCounts("aaadddcghzz", characters, max);

    vector<int> current(characters.size(), 0);
    int index = 1;
    while (Advance(current, max))
    {
        cout << index++ << ":" << ToString(current, characters) << endl;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T04:20:32.957

以下是生成所有子序列的递归算法。

```
/* in C -- I hope it will be intelligible */

#include <stdio.h>

static char input[] = "aaabbbccc";
static char output[sizeof input];

/* i is the current index in the input string
 * j is the current index in the output string
 */
static void printsubs(int i, int j) {
    /* print the current output string */
    output[j] = '\0';
    printf("%s\n", output);
    /* extend the output by each character from each remaining group and call ourselves recursively */
    while(input[i] != '\0') {
        output[j] = input[i];
        printsubs(i + 1, j + 1);
        /* find the next group of characters */
        do ++i;
        while(input[i] == input[i - 1]);
    }
}

int main(void) {
    printsubs(0, 0);
    return 0;
} 
```

如果您的兴趣只是计算有多少子序列，您可以更有效地完成它。只需计算每个字母的数量，将每个值加 1，然后将它们相乘。在上面的示例中，有 3 个 a、3 个 b、3 个 c 和 2 个 d，对于 (3 + 1) * (3 + 1) * (3 + 1) * (2 + 1) = 192 个子序列。这样做的原因是您可以在 0 和 3 a、0 和 3 b、0 和 3 c、0 和 2 d 之间进行选择，*所有这些选择都是独立的*。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T04:14:39.723

实际上，您的问题是列出给定集合中的所有子集。

考虑集合 {a,a,a,d,d,d,c,g,h,z,z}，您的目标是按顺序列出其所有唯一子集，除了空集： {a} {a, a} {a,a,a} {a,a,a,d}

有一种快速列出给定集合中所有子集的方法。

我们以 {ABC} 为例：

```
{}     = 000
{C}    = 001
{B}    = 010
{BC}   = 011
{A}    = 100
{AC}   = 101
{AB}   = 110
{ABC}  = 111 
```

看到图案了吗？只需使用从 0 增长到 2^n - 1 的整数。如果整数的第 i 个数字是 1，则从集合中获取第 i 个元素。

注意：由于在您的示例中，字符串中有重复项；因此，在生成之后，您可能需要删除重复项。

希望这可以帮到你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T04:17:16.170

好吧，在我看来，一种与您的解决方案类似但与您的输出不匹配的解决方案（不过，请参阅我对问题的评论），就是简单地遍历原始字符串的尾部列表（例如，对于“abc”，遍历“abc”，“bc”和“c”），并为每个生成前缀列表（“abc”，“ab”，“a”，然后是“bc”，“b” ，然后是“c”）。这与您想要的相比如何？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T05:06:00.857

我使用了这个 java 代码（[http://www.merriampark.com/comb.htm](http://www.merriampark.com/comb.htm)），只得到了 383 个。代码生成了太多的重复项，所以我不得不扔掉很多。我最终只得到了 383 个（请参见下文）。您可能想查看 stl 中 next-combinatiom 的 c++ 代码（但我在任何地方都找不到源代码）。电源组可能是最好的方法（但你也可能有重复）。

```
a
aa
aaa
aaac
aaacg
aaacgh
aaacghz
aaacghzz
aaacgz
aaacgzz
aaach
aaachz
aaachzz
aaacz
aaaczz
aaad
aaadc
aaadcg
aaadcgh
aaadcghz
aaadcghzz
aaadcgz
aaadcgzz
aaadch
aaadchz
aaadchzz
aaadcz
aaadczz
aaadd
aaaddc
aaaddcg
aaaddcgh
aaaddcghz
aaaddcghzz
aaaddcgz
aaaddcgzz
aaaddch
aaaddchz
aaaddchzz
aaaddcz
aaaddczz
aaaddd
aaadddc
aaadddcg
aaadddcgh
aaadddcghz
aaadddcghzz
aaadddcgz
aaadddcgzz
aaadddch
aaadddchz
aaadddchzz
aaadddcz
aaadddczz
aaadddg
aaadddgh
aaadddghz
aaadddghzz
aaadddgz
aaadddgzz
aaadddh
aaadddhz
aaadddhzz
aaadddz
aaadddzz
aaaddg
aaaddgh
aaaddghz
aaaddghzz
aaaddgz
aaaddgzz
aaaddh
aaaddhz
aaaddhzz
aaaddz
aaaddzz
aaadg
aaadgh
aaadghz
aaadghzz
aaadgz
aaadgzz
aaadh
aaadhz
aaadhzz
aaadz
aaadzz
aaag
aaagh
aaaghz
aaaghzz
aaagz
aaagzz
aaah
aaahz
aaahzz
aaaz
aaazz
aac
aacg
aacgh
aacghz
aacghzz
aacgz
aacgzz
aach
aachz
aachzz
aacz
aaczz
aad
aadc
aadcg
aadcgh
aadcghz
aadcghzz
aadcgz
aadcgzz
aadch
aadchz
aadchzz
aadcz
aadczz
aadd
aaddc
aaddcg
aaddcgh
aaddcghz
aaddcghzz
aaddcgz
aaddcgzz
aaddch
aaddchz
aaddchzz
aaddcz
aaddczz
aaddd
aadddc
aadddcg
aadddcgh
aadddcghz
aadddcghzz
aadddcgz
aadddcgzz
aadddch
aadddchz
aadddchzz
aadddcz
aadddczz
aadddg
aadddgh
aadddghz
aadddghzz
aadddgz
aadddgzz
aadddh
aadddhz
aadddhzz
aadddz
aadddzz
aaddg
aaddgh
aaddghz
aaddghzz
aaddgz
aaddgzz
aaddh
aaddhz
aaddhzz
aaddz
aaddzz
aadg
aadgh
aadghz
aadghzz
aadgz
aadgzz
aadh
aadhz
aadhzz
aadz
aadzz
aag
aagh
aaghz
aaghzz
aagz
aagzz
aah
aahz
aahzz
aaz
aazz
ac
acg
acgh
acghz
acghzz
acgz
acgzz
ach
achz
achzz
acz
aczz
ad
adc
adcg
adcgh
adcghz
adcghzz
adcgz
adcgzz
adch
adchz
adchzz
adcz
adczz
add
addc
addcg
addcgh
addcghz
addcghzz
addcgz
addcgzz
addch
addchz
addchzz
addcz
addczz
addd
adddc
adddcg
adddcgh
adddcghz
adddcghzz
adddcgz
adddcgzz
adddch
adddchz
adddchzz
adddcz
adddczz
adddg
adddgh
adddghz
adddghzz
adddgz
adddgzz
adddh
adddhz
adddhzz
adddz
adddzz
addg
addgh
addghz
addghzz
addgz
addgzz
addh
addhz
addhzz
addz
addzz
adg
adgh
adghz
adghzz
adgz
adgzz
adh
adhz
adhzz
adz
adzz
ag
agh
aghz
aghzz
agz
agzz
ah
ahz
ahzz
az
azz
c
cg
cgh
cghz
cghzz
cgz
cgzz
ch
chz
chzz
cz
czz
d
dc
dcg
dcgh
dcghz
dcghzz
dcgz
dcgzz
dch
dchz
dchzz
dcz
dczz
dd
ddc
ddcg
ddcgh
ddcghz
ddcghzz
ddcgz
ddcgzz
ddch
ddchz
ddchzz
ddcz
ddczz
ddd
dddc
dddcg
dddcgh
dddcghz
dddcghzz
dddcgz
dddcgzz
dddch
dddchz
dddchzz
dddcz
dddczz
dddg
dddgh
dddghz
dddghzz
dddgz
dddgzz
dddh
dddhz
dddhzz
dddz
dddzz
ddg
ddgh
ddghz
ddghzz
ddgz
ddgzz
ddh
ddhz
ddhzz
ddz
ddzz
dg
dgh
dghz
dghzz
dgz
dgzz
dh
dhz
dhzz
dz
dzz
g
gh
ghz
ghzz
gz
gzz
h
hz
hzz
z
zz 
```

# wpf - 获取 WPF 列表视图的 HeaderClick 事件

> ID：896294
> 
> 赞同：3
> 
> 时间：2009-05-22T04:04:43.300
> 
> 标签：wpf, events, listview, wpf-controls

如何获取 WPF Listview 的 headerclick 事件？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-22T04:12:47.227

您可以使用 GridViewColumnHeader.Click 附加事件。例如，请参阅 MSDN 页面上[单击标题时对 GridView 进行排序](http://msdn.microsoft.com/en-us/library/ms745786.aspx)。

```
<ListView x:Name='lv' 
          Height="150" 
          HorizontalAlignment="Center" 
          VerticalAlignment="Center" 
          GridViewColumnHeader.Click="GridViewColumnHeaderClickedHandler"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-08-05T12:15:21.723

只是为了扩展上一个答案，如何知道点击了哪个标题：

XAML：

```
<ListView GridViewColumnHeader.Click="GridViewColumnHeaderClickedHandler"> 
```

CS：

```
private void SortHeaderClick(object sender, RoutedEventArgs e)
{
    MessageBox.Show(((GridViewColumnHeader)e.OriginalSource).Column.Header.ToString());
} 
```

# php - 是否有等效于 PHP 的`date_default_timezone_set()` 在 MySQL 中工作？

> ID：896305
> 
> 赞同：1
> 
> 时间：2009-05-22T04:10:16.850
> 
> 标签：php, mysql

这在 PHP 中效果很好

```
date_default_timezone_set('my/timezone');

$actualDate = date('Y-m-d'); 
```

现在做查询时，我喜欢做

```
INSERT INTO articles (title, insert_date) VALUES ('My Title', now()) 
```

问题`now()`在于 MySQL 与在 PHP 中计算的结果不同（因此与设置的时区相反）。

有没有办法，比如 SQL 查询，为 MySQL 设置默认时区？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T04:12:26.493

[http://dev.mysql.com/doc/refman/5.1/en/time-zone-support.html](http://dev.mysql.com/doc/refman/5.1/en/time-zone-support.html)

> 如果您有 SUPER 权限，您可以使用以下语句在运行时设置全局服务器时区值：
> 
> `mysql> SET GLOBAL time_zone = timezone;`
> 
> 每个连接时区。每个连接的客户端都有自己的时区设置，由会话 time_zone 变量给出。最初，会话变量从全局 time_zone 变量中获取其值，但客户端可以使用以下语句更改自己的时区：
> 
> `mysql> SET time_zone = timezone;`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T17:06:10.277

您可以尝试将所有日期/时间存储在 UTC 中。所以，你会使用

```
date_default_timezone_set('UTC');
$actualDate = date('Y-m-d'); 
```

和

```
INSERT INTO articles (title, insert_date) VALUES ('My Title', UTC_TIMESTAMP()) 
```

然后，您将在显示之前将 UTC 日期/时间转换为用户的时区。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T17:26:18.240

我通常将 MySQL 服务器设置为格林威治标准时间，然后在 PHP 中使用 gmdate 代替 date。将所有内容保存在 GM Time 中，因此如果您移动到另一台服务器，或者在不同时区拥有 2 台服务器，事情不会一团糟。

# c# - 从 .NET 调用 Powershell 时设置启动目录？

> ID：896306
> 
> 赞同：18
> 
> 时间：2009-05-22T04:10:21.563
> 
> 标签：c#, powershell

我正在使用 System.Management.Automation API 将 PowerShell 脚本称为 C# WPF 应用程序。在以下示例中，您将如何更改起始目录 ($PWD)，使其从 C:\scripts\ 执行 foo.ps1，而不是调用它的 .exe 位置？

```
using (Runspace runspace = RunspaceFactory.CreateRunspace())
{
    runspace.Open();
    using (Pipeline pipeline = runspace.CreatePipeline())
    {
        pipeline.Commands.Add(@"C:\scripts\foo.ps1");
        pipeline.Invoke();
    }
    runspace.Close();
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-09-18T15:10:50.100

您无需更改`System.Environment.CurrentDirectory`即可更改 PowerShell 脚本的工作路径。这样做可能非常危险，因为如果您正在运行对当前目录敏感的其他代码，这可能会产生无意的副作用。

由于您提供的是`Runspace`，您需要做的就是在`Path`上设置属性`SessionStateProxy`：

```
using (Runspace runspace = RunspaceFactory.CreateRunspace())
{
    runspace.Open();
    runspace.SessionStateProxy.Path.SetLocation(directory);
    using (Pipeline pipeline = runspace.CreatePipeline())
    {
        pipeline.Commands.Add(@"C:\scripts\foo.ps1");
        pipeline.Invoke();
    }
    runspace.Close();
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-27T17:45:20.497

`System.Environment.CurrentDirectory`提前设置会做你想做的事。

*您应该在打开运行空间****之前****设置任何时间*，而不是添加`Set-Location`到您的脚本中。它将继承当前目录打开时的任何内容：`System.Environment.CurrentDirectory`

 **```
using (Runspace runspace = RunspaceFactory.CreateRunspace())
{
    System.Environment.CurrentDirectory = "C:\\scripts";
    runspace.Open();
    using (Pipeline pipeline = runspace.CreatePipeline())
    {
        pipeline.Commands.Add(@".\foo.ps1");
        pipeline.Invoke();
    }
    runspace.Close();
} 
```

请记住，`Set-Location`不设置 .net 框架`CurrentDirectory`，因此如果您调用在“当前”位置工作的 .Net 方法，您需要自己设置。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-22T04:36:15.590

做错了什么：

```
pipeline.Commands.AddScript(@"set-location c:\scripts;.\foo.ps1") 
```

?

-Oisin

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T04:41:47.060

您可以使用以下命令在 powershell 中设置工作目录

```
set-location c:\mydirectory 
```

您还可以尝试使用 PowerShell 启动脚本 ($profile)。C:....\MyDocs\WindowsPowerShell\Microsoft.PowerShell_profile.ps1 但前提是这个目录是固定不变的

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-09-18T10:38:36.080

您可以在脚本的开头包含它，而不是让应用程序处理它，

```
Set-Location $PSScriptRoot 
```

它将在其安装目录中执行脚本的其余部分。

但请注意，PowerShell 的“当前位置”与您的应用程序的工作目录不同，它们只是在您启动 powershell 时初始化相同。

如果您启动依赖于当前目录的可执行文件，或者如果您的脚本包含框架 API 调用，例如以下示例，则 Set-Location 可能会欺骗您：

```
PS C:\Users\luc> Set-Location C:\
PS C:\> [System.IO.Directory]::GetCurrentDirectory()
C:\Users\luc 
```

话虽如此，我通常更喜欢迈克贝利的回答。如果脚本并不总是安装在同一目录中（开发机器上的路径与生产机器上的路径不同，通常情况下），我只是想提供一个具有其优点的解决方案。

# css - CSS 背景图片位置问题

> ID：896307
> 
> 赞同：1
> 
> 时间：2009-05-22T04:11:04.073
> 
> 标签：css, background, alignment

在[http://www.goodshow.tv](http://www.goodshow.tv)我遇到了导航问题。我有一个放置箭头图像的类，它应该与白色边框的右边缘对齐。问题是，它基于文本左侧的位置。有没有更绝对的定位方式？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T04:20:32.037

我不确定您的意思，但是如果您将背景从 <a> 和 .currentpage 中取出，并将以下内容放在 <li> 上，您可能会得到更接近您想要的东西。如果不是，请重述您想要的内容:-)

```
background: transparent url(http://www.goodshow.tv/images/nav_arrow.png) no-repeat scroll 95% 50% 
```

不过，我可能会在 <li> 上这样做：

```
background: transparent url(http://www.goodshow.tv/images/nav_arrow.png) no-repeat scroll 100% 50%
padding:8px 20px 7px 0; 
```

即将背景固定到右边缘并调整右填充。

您可能希望使用箭头的大小或文本的行高来进行垂直对齐。在我看来，55% 看起来比垂直 50% 好，我认为这可能只是调整这个数字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T04:53:23.997

我会选择像 Graphain 推荐的选项。看起来您有一个用于导航项目的列表，以及另一个用于箭头的列表。您可以将这些结合起来，让您的生活更轻松。:) 这个想法是你的 li 元素它们的宽度足以显示箭头。然后，您将在其中一个 li 上设置背景以使用箭头并将其定位在当前页面的右侧。这是可以在风格方面进行更改以执行此类操作的内容...

```
#nav { width:240px; } /* should go all the way to that vertical area where there arrows are) */
#nav li.currentpage { background:url(images/nav_arrow.png) no-repeat right center; } /* add the error */
#nav ul li { margin-right:30px; } /* will add a bit of spacing after each lit between the text and the arrow */ 
```

此外，您还必须将当前页面从 a 元素更改为 li 元素（并更改 a.currentpage 以使用更像

```
#nav ul li.currentpage a {} /* your current a.currentpage style */ 
```

之后，您应该能够一起删除箭头 div。

# javascript - 测试 JavaScript 对象是否存在属性的正确方法是什么？

> ID：896308
> 
> 赞同：25
> 
> 时间：2009-05-22T04:11:50.737
> 
> 标签：javascript, object, properties

我有一个使用 创建的自定义 Javascript 对象`new`，并根据创建参数分配属性：

```
function MyObject(argument) {
    if (argument) {
        this.prop = "foo";
    }
}
var objWithProp = new MyObject(true); // objWithProp.prop exists
var objWithoutProp = new MyObject(false); // objWithoutProp.prop does not exist 
```

`prop`测试对象属性是否存在的正确方法是什么？我见过使用以下方法，但我不确定这些方法是否是最好的方法：

*   `if (obj.prop) {}`
*   `if (obj.hasOwnProperty("prop")) {}`
*   `if ("prop" in obj) {}`

具体来说，我只对测试是否为该对象显式定义了属性感兴趣，而不是在原型链中。此外，该值永远不会设置为`null`or `undefined`，但它可能是一个空对象或数组。但是，如果您想包含正确的方法（如果可能的话），请随意。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-05-22T04:14:38.663

`hasOwnProperty`正是您要查找*的*内容，因为您指定“是否为该对象显式定义了该属性，而不是在原型链中”。根据[https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Object/hasOwnProperty](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Object/hasOwnProperty)，“此方法可用于确定对象是否具有指定属性作为该对象的直接属性；与 in 运算符不同，此方法不会检查对象的原型链。” - 似乎完全符合您的要求！

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-22T06:01:42.260

如果要查找对象中定义的属性，可以使用对象的 hasOwnProperty 方法。像这样：

```
myObject = new MyObject();
// some code
if ( myObject.hasOwnProperty('prop') ) {
    // prop exists
} 
```

但这只是为了知道这样的属性是否在对象本身中定义，而不是在其父对象中定义。所以如果这样的属性被对象继承，你不能像这样测试它的存在。

另一种方法是针对未定义的值测试属性。像这样：

```
if ( myObject.prop !== undefined ) {
    // prop exists
} 
```

请记住使用 !== 运算符而不是 != 因为 != 在 null 和 undefined 之间没有区别，但 !== 可以。因此，如果您的对象具有属性但值为 null，则 != 将无济于事。所以这个测试：

```
if ( myObject.prop ) {
} 
```

如果“prop”的值为 false 或 null，则可能会产生错误的结果。但是通过使用 !== 运算符与 undefined 进行比较，您可以确定 null/false 值不会让您感到困惑。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-04-04T12:14:03.577

您可以检查 a 的存在，`variable`如下所示：

```
if ( typeof variable === 'undefined' || variable === null ) {
    // Do stuff
} 
```

它也可以用于`properties`.

# oracle - Oracle 游标在最后一项中运行两次

> ID：896319
> 
> 赞同：11
> 
> 时间：2009-05-22T04:14:16.807
> 
> 标签：oracle, plsql

我有一个游标循环，它通过将表的内容连接在一起来构建一个字符串，使用以下代码：

```
OPEN cur_t;
LOOP
    FETCH cur_t INTO v_texttoadd;

    v_string := v_string || v_texttoadd;
EXIT WHEN cur_t%notfound;
END LOOP; 
```

当然，问题是最后一个项目被添加了两次，因为系统在意识到没有更多东西可以找到之前再次运行它。

我试着玩弄类似的东西

```
OPEN cur_t;
WHILE cur_t%found;
LOOP
    FETCH cur_t INTO v_texttoadd;

    v_string := v_string || v_texttoadd;
END LOOP; 
```

但这似乎并没有带来任何回报。

我应该使用什么样的语法，以便每一行只出现在结果字符串中一次？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-05-22T04:19:06.640

你可以试试这个：

```
OPEN cur_t;
LOOP
  FETCH cur_t INTO v_texttoadd;
  EXIT WHEN cur_t%notfound;
  v_string := v_string || v_texttoadd;
END LOOP; 
```

这是因为在执行 FETCH 时设置了 %notfound 并且没有更多的行要获取。在您的示例中，您在连接后检查了 %notfound ，结果，您最终得到了重复项。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-22T06:59:18.913

已经给出了正确的答案，但只是详细说明了一点。

模拟您当前的情况：

```
SQL> declare
  2    cursor cur_t
  3    is
  4    select ename
  5      from emp
  6     where deptno = 10
  7    ;
  8    v_texttoadd emp.ename%type;
  9    v_string    varchar2(100);
 10  begin
 11    open cur_t;
 12    loop
 13      fetch cur_t into v_texttoadd;
 14      v_string := v_string || v_texttoadd;
 15      exit when cur_t%notfound;
 16    end loop
 17    ;
 18    dbms_output.put_line(v_string);
 19  end;
 20  /
CLARKKINGMILLERMILLER

PL/SQL-procedure is geslaagd. 
```

这里 MILLER 被打印了两次。只需切换 EXIT 语句和 v_string 赋值，就可以得到想要的结果：

```
SQL> declare
  2    cursor cur_t
  3    is
  4    select ename
  5      from emp
  6     where deptno = 10
  7    ;
  8    v_texttoadd emp.ename%type;
  9    v_string    varchar2(100);
 10  begin
 11    open cur_t;
 12    loop
 13      fetch cur_t into v_texttoadd;
 14      exit when cur_t%notfound;
 15      v_string := v_string || v_texttoadd;
 16    end loop
 17    ;
 18    dbms_output.put_line(v_string);
 19  end;
 20  /
CLARKKINGMILLER

PL/SQL-procedure is geslaagd. 
```

但是，当使用 cursor-for-loop 时，您的 PL/SQL 代码会变得更容易。然后，您可以跳过 v_texttoadd 变量，循环中的行数减少：

```
SQL> declare
  2    cursor cur_t
  3    is
  4    select ename
  5      from emp
  6     where deptno = 10
  7    ;
  8    v_string    varchar2(100);
  9  begin
 10    for r in cur_t
 11    loop
 12      v_string := v_string || r.ename;
 13    end loop
 14    ;
 15    dbms_output.put_line(v_string);
 16  end;
 17  /
CLARKKINGMILLER

PL/SQL-procedure is geslaagd. 
```

您也可以使用直接 SQL 来完成这项工作。如果您使用的是 10g 或更高版本，则使用 SQL 模型子句的示例：

```
SQL> select string
  2    from ( select string
  3                , rn
  4             from emp
  5            where deptno = 10
  6            model
  7                  dimension by (rownum rn)
  8                  measures (ename, cast(null as varchar2(100)) string)
  9                  ( string[any] order by rn desc = ename[cv()] || string[cv()+1]
 10                  )
 11         )
 12   where rn = 1
 13  /

STRING
-----------------------------------------------------------------------------------
CLARKKINGMILLER

1 rij is geselecteerd. 
```

问候，罗布。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T04:28:24.740

当 fetch 未能检索到新行时设置 %notfound。

另一种可能的方式（这个避免了“if”和“exit when”）：

```
OPEN cur_t;
FETCH cur_t INTO v_texttoadd;
WHILE cur_t%found LOOP
    v_string := v_string || v_texttoadd;
    FETCH cur_t INTO v_texttoadd;
END LOOP; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T04:27:21.730

简单的答案，虽然可能不是最好的：

```
OPEN cur_t;
LOOP
    FETCH cur_t INTO v_texttoadd;
    IF cur_t%found THEN
        v_string := v_string || v_texttoadd;
    END IF;
EXIT WHEN cur_t%notfound;
END LOOP; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-26T20:30:38.240

我在 Microsoft SQL 中制作了许多基于游标的解决方案，它们总是运行良好（过去好！我非常希望我的 SQL Server 回来！）但是这个问题的所有答案对我来说都是错误的，最后一行游标总是执行两次，无论我多么密切地遵循他们建议的方法。

忘记 non-while`loop`并忘记`exit`，这是你必须做的以避免双重执行（几乎你在 T-SQL 中所做的事情！）。

```
 cursor c_mm is select a, b, c, d from mytable;

  begin
    open c_mm;
    fetch c_mm into a, b, c, d;
    while (not c_mm%notfound) loop 
        -- do what you have to do here

        fetch c_mm into a, b, c, d;
    end loop;
    close c_mm;
  end; 
```

我真的不明白为什么所有 Oracle 知识库文章和论坛帖子（以及 stackoverflow）都提倡这种明显错误的退出循环解决方案！

# java - 与其他 Java Web 框架相比，Grails 有哪些优势？

> ID：896320
> 
> 赞同：12
> 
> 时间：2009-05-22T04:14:25.777
> 
> 标签：java, grails, jakarta-ee

我使用过 JSF、Spring MVC 和 Struts，并且我认为我在这些框架上获得了很好的水平。最近我听说与我合作过的很多优秀的开发人员都在学习 Grails 并在他们的项目中使用它。

与其他框架相比，Grails 的实际优势是什么？除了我知道其他框架之外还值得学习吗？什么是围绕 Grails 的所有嗡嗡声，仅仅是因为 Groovy 吗？

注意：我在 SO 中进行了研究，我发现的唯一相关问题是[这个](https://stackoverflow.com/questions/24596/what-web-application-framework-for-java-is-recommended)并且没有提到 Grails

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-22T04:53:49.880

正如您所说，Grails 是基于 Groovy 构建的，它带来了提高生产力的直接好处。Groovy 语法比 Java 更简洁，在一行 Groovy 代码中做一些事情要容易得多，而这需要你在 Java 中使用几个。

Grails 特别为您提供了许多优于其他 Web 框架的优势（不过，我只能谈论 Struts 1.x、2.x 和 SpringMVC）——顺便说一下，Grails 实际上构建在 SpringMVC 之上，您可以使用集成其他组件春天。

*   数据库迁移和版本控制 - 不再有与数据库模式综合症不同步的应用程序。大多数 Java Web 应用程序都受此影响。

*   Artefacts - 这使得创建新的控制器和组件更容易。无需再创建控制器、配置控制器并将其填充到 Web 应用程序的正确位置。哦！Scaffolding 还为您提供了所有一些初始组件，以允许您开始构建页面和自定义

*   更简单的验证（def 比 Struts 1.x 更简单），例如`username(size:6..10, blank:false)`为用户名字段指定两个验证规则，使其具有特定长度且非空白。在其他 Java Web 应用程序框架中，这有点困难。

*   内置 Webflow（通过 Spring webflow），这使得创建复杂的工作流变得更加简单。Struts 2 可以支持 Webflow，但是通过一个插件，如果我记得的话，这有点奇怪。春天也可以。

*   拦截器——SpringMVC 也有这些。

*   Flash 范围，请参阅[http://grails.org/doc/docs/1.1/ref/Controllers/flash.html](http://grails.org/doc/docs/1.1/ref/Controllers/flash.html)

*   更好的数据绑定——Struts 2 相当不错，比 Struts 1 好很多。SpringMVC 也不错。

还有更多，请查看文档了解更多详细信息：http: [//grails.org/doc/1.1.1/](http://grails.org/doc/1.1.1/)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-22T04:31:34.400

顺便说一句，Grails 不被视为 Java 框架，它适用于 Groovy。Groovy 有能力与 Java 无缝协作，但那是另一回事。

是的，它是关于 Groovy 的，就像 Java 一样，它非常好。Groovy 遵循“少写代码，多做事”的概念，而 Java 类似于“多写代码，多做事”。无意冒犯 Java 人，我是你们中的一员。

您可能想阅读以下内容：

*   [Grails 的成功案例](http://grails.org/Success+Stories)
*   [Groovy 1.6 中的新功能](http://www.infoq.com/articles/groovy-1-6)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-22T08:30:53.063

Grails 为现有的 Java 框架添加了 Groovy 的优点，并提供了易于使用的工具：

*   Grails（Web 部件）= Groovyfied [Spring MVC](http://www.grails.org/Developer+-+Spring+MVC+Integration)（就像@Jon 指出的那样）
*   [GORM](http://www.grails.org/GORM) = Groovyfied 休眠
*   GroovyTestCase = Groovyfied JUnit TestCase

@Jon 已经提到了一些具体的实际优势。我想指出 Grails 方法中的两个基本概念：

1.  **约定优于配置**。如果您遵守 Grails 制定的约定（顺便说一句，这是非常明智的），您可以很快变得高效。
2.  **不要重复自己 (DRY)** Grails 使您能够编写 DRY 代码，并且它本身就是如何做到 DRY 的一个很好的例子。如果您有任何现有的 Java 代码，在 Grails 中重用它应该没有问题。

所以，

> 值得学习吗？

我认为对你来说是的。由于您已经了解 Java 和一些可用的框架（尤其是 Spring MVC），因此学习曲线应该不会太陡峭。

> 什么是围绕 Grails 的所有嗡嗡声，仅仅是因为 Groovy 吗？

之所以引起轰动，是因为 Grails 证明可以利用 Groovy 创建一个非常有用的“产品”。

# php - 重载的 __get 是否需要管理所有成员变量？

> ID：896323
> 
> 赞同：1
> 
> 时间：2009-05-22T04:15:49.430
> 
> 标签：php, variables, methods, overloading, member

我正在为一个类创建一个 __get() 函数来控制对我的私有成员变量的访问。我是否需要设计函数来处理所有可能的成员值读取，或者我不能为公共成员编写它？另外，我假设继承这个类的类将使用我的 __get() 函数来访问私有成员。

```
class ClassA{
  private $collection = array();
  public $value;

  function __get($item){
    return $collection[$item];
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T04:29:08.127

不，你没有。

```
 class A {
   public $foo = 'bar';
   private $private = array();

   public function __get($key) {
      echo 'Called __get() at line #' ,__LINE__, ' with key {', $key ,'}',"\n";
      return $this->private[$key];
   }

   public function __set($key, $val) {
      $this->private[$key] = $val;
   }
}

$a = new A();

var_dump($a->foo);
$a->bar = 'baz';
var_dump($a->bar); 
```

是的，它将：

```
 class B extends A { private $private = array(); }
$b = new B();
var_dump($b->bar); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T04:32:34.433

好吧，您的代码将在您的数组中未设置的私人项目上失败。但是话又说回来，您可以使用它来处理数组内外的内容，例如；

```
 function __get($item){
    if ( isset ( $collection[$item] ) )
       return $collection[$item];
    else {
       try {
          return $this->$item ;  // Dynamically try public values
       } catch (Exception $e) {
          $collection[$item] = 0 ; // Make it exist
       }
    }
  } 
```

继承你的调用的类将使用这个 __get()，但可以被覆盖，所以使用 parent::__construct() 来明确。另请注意，这些不能是静态的。[进一步阅读](http://ca.php.net/manual/en/language.oop5.overloading.php#language.oop5.overloading.members)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T09:59:49.840

首先，PHP 在类定义中搜索属性名称并尝试返回其值。如果没有属性 - PHP 会尝试调用 __get($var) ，在这里你可以返回任何你想要的东西。对于那些知道类似 Java 的 getter/setter 的人来说，这有点令人困惑，您必须为要访问的每个类成员定义它们。

当使用类似 Java 的 getter/setter 很舒服时，您可以编写如下内容：

```
public function __set($var, $value)
{
    if (method_exists($this, $method = "_set_" . $var))
    {
        call_user_func(array($this, $method), $value);
    }
}
public function __get($var)
{
    if (method_exists($this, $method = "_get_" . $var))
    {
        return call_user_func(array($this, $method), $value);
    }
} 
```

然后通过定义自定义 getter/setter 来使用此代码

```
protected function _get_myValue() 
     {
         return $this->_myValue; 
     }
protected function _set_myValue($value)
{
    $this->_myValue = $value;
} 
```

并以这种方式访问​​定义的方法：

```
$obj->myValue = 'Hello world!'; 
```

# oracle - 从 Oracle 9i 到 Oracle 10g 的归档日志传输

> ID：896330
> 
> 赞同：1
> 
> 时间：2009-05-22T04:20:09.463
> 
> 标签：oracle, archive, data-transfer

我有一种情况，我需要将 Oracle 9i 归档日志传输到 Oracle 10g 数据库，从那里它们将由日志挖掘器挖掘，然后由 Oracle 流捕获/应用进程使用。

（Oracle 9 归档日志可以被 Oracle 10 logminer 读取 - 我可以手动复制归档日志，手动注册它们并对其进行挖掘、捕获然后应用）。

困难在于 Oracle 归档日志传输的方式在 9i 和 10g 之间发生了很大变化，并且设置 9i 数据库以传输到远程机器，如下所示：

```
log_archive_dest_state_2 = enable
log_archive_dest_2 = "service=OTHERMACHINE arch optional" 
```

不再工作。

我在 9i 日志中得到了这个：

```
*** 2009-05-22 04:03:44.149
RFS network connection lost at host 'OTHERMACHINE'
Error 3113 attaching RFS server to standby instance at host 'OTHERMACHINE'
Error 3113 attaching to destination LOG_ARCHIVE_DEST_2 standby host 'OTHERMACHINE'
Heartbeat failed to connect to standby 'OTHERMACHINE'. Error is 3113.
*** 2009-05-22 04:03:44.150
kcrrfail: dest:2 err:3113 force:0
ORA-03113: end-of-file on communication channel 
```

在 10g 日志中我得到：

```
Fri May 22 04:07:42 2009
WARNING: inbound connection timed out (ORA-3136) 
```

我的问题是：

有谁知道我如何配置我的 9i 或 10g 服务器，以便 10g 服务器将接受 9i 连接，以便我可以将 9i 存档日志传输到 10g 服务器。如果存档日志会自动注册到 10g 服务器中，那将是一个额外的好处。

注意我没有在这里设置完整的 DataGuard 配置，并且 10g 数据库不是辅助服务器。

感谢您的任何建议。

**编辑**

注意，我可以通过sqlplus从9i服务器登录到10g服务器，所以连接不是问题

**编辑 2**

经过大量时间寻找解决方案后，我最终决定这种机制不起作用，需要使用非 Oracle 方法将归档日志从 9i 传输到 10g（例如 rsync）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T15:32:52.273

您的数据库是否有最新的补丁？

此外，您的连接通常需要一段时间来进行身份验证吗？在 V10.1 之后，默认 SQLNET.INBOUND_CONNECT_TIMEOUT 设置为 60 秒。在该版本之前，它默认为无限期。

参考 Metalink 345197.1：以前在 Oracle 10.1 中工作的连接现在在 10.2 中出现 ORA-3113、ORA-3106 或 ORA-3136 时断时续

# iphone - 在 iPhone 应用程序中播放声音剪辑的最简单方法是什么？

> ID：896331
> 
> 赞同：3
> 
> 时间：2009-05-22T04:20:28.043
> 
> 标签：iphone, audio, avfoundation, nssound

我希望能够在 iPhone OS 应用程序中播放声音片段。我已经看到有关**NSSound**和**AVFoundation**的信息作为在 iPhone OS 设备上播放声音剪辑的手段，但我仍然不清楚这个主题，可以使用一些帮助。无需在实际代码中一步一步地为我拼写出来，但如果有人能给我一个关于我应该开始移动的大致方向（即我应该关注哪些类）的提示，我会填写我自己在空白处。那么，在 iPhone 应用程序中播放声音剪辑的最简单方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-22T05:30:43.647

Apple 有一篇关于此主题的文章，请参阅：[此链接](http://developer.apple.com/iPhone/library/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/AudioandVideoTechnologies/AudioandVideoTechnologies.html#//apple_ref/doc/uid/TP40007072-CH19-SW1)

AVAudioPlayer 是播放任意长度声音的最简单方法，无论是否循环播放，但它需要 iPhone OS 2.2 或更高版本。一个简单的例子：

```
NSString *soundFilePath =
                [[NSBundle mainBundle] pathForResource: @"sound"
                                                ofType: @"wav"];

NSURL *fileURL = [[NSURL alloc] initFileURLWithPath: soundFilePath];

AVAudioPlayer *newPlayer =
                [[AVAudioPlayer alloc] initWithContentsOfURL: fileURL
                                                       error: nil];
[fileURL release];

[newPlayer play];

[newPlayer release]; 
```

它几乎可以播放任何文件格式（aiff、wav、mp3、aac） 请记住，您一次只能播放一个 mp3/aac 文件。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-22T04:39:55.060

这是我所知道的最简单的方法：

1.  将您的声音文件转换为 caf（使用 afconvert 命令行工具）并添加到您的项目中。

    caf 代表核心音频格式（我认为......）

2.  在 Apple 的示例代码中查找 SoundEffect.h 和 .m。我相信 Metronome 和 BubbleLevel 都有。

3.  复制到您的项目
4.  编写如下代码：

    ```
    SoundEffect *SimpleSound = [[SoundEffect alloc] initWithContentsOfFile:[mainBundle pathForResource:@"soundfile" ofType:@"caf"]];
    [SimpleSound play];
    [SimpleSound release]; 
    ```

研究 SoundEffect.m 以了解简单的声音处理。

# flash - 在 Actionscript 2 中立即引用影片剪辑类实例

> ID：896335
> 
> 赞同：3
> 
> 时间：2009-05-22T04:21:27.437
> 
> 标签：flash, actionscript, actionscript-2

这是一个非常令人沮丧的 Actionscript 2 问题，我遇到的影片剪辑与在时间轴上创建的类相关联，需要立即在代码中引用：

-- 我的库中有一个与类“C”关联的影片剪辑“C”。

-- "C" 类扩展了 MovieClip。

-- 我在舞台上有一个带有帧标签“关闭”和“打开”的电影剪辑。此影片剪辑的实例名称为“mc”。

-- 在“on”框架上有一个“C”类的实例，实例名称为“inst”。

-- 类“C”的构造函数包括一个跟踪语句以输出“C构造函数！” 让我知道舞台上的实例何时创建。

现在假设我运行这段代码：

```
mc.gotoAndPlay("on");
var inst_mc:MovieClip = mc.inst;

if (inst_mc){
    trace("inst_mc found!");
}else{
    trace("inst_mc NOT FOUND!");
}

var inst_c:C = C(mc.inst);

if (inst_c){
    trace("inst_c found!");
}else{
    trace("inst_c NOT FOUND!");
} 
```

似乎在当前帧的所有代码执行完毕之前，不会在诸如 C 之类的类下创建任何对象，因为输出将是这样的：

```
inst_mc found!
inst_c NOT FOUND!
C constructor! 
```

这到底是怎么回事？我已经明确告诉 Flash 创作环境，影片剪辑 C 与 C 类相关联，而 C 类是 MovieClip 派生的。因此，在我的代码中，gotoAndPlay("on") 将创建位于“on”帧上的影片剪辑“inst”。它能够很好地找到实例，但是当我将其视为 C 类时，它会失败。然后构造函数发生在所有这些之后。我该如何解决？我希望一旦您在时间线上更改了某些内容，将立即创建相应的对象——它们确实是，但不是作为它们的显式类类型。我可以引用我的实例，但只能作为 MovieClip。我该怎么解决这个问题？它应该输出：

```
C constructor!
inst_mc found!
inst_c found! 
```

谢谢你的帮助！

*** 更新 *** 感谢您的回复！不幸的是，我的项目没有简单的修复方法，它现在很大并且不能轻易重组（它也太大而无法转换为 AS3）。我曾考虑将 MC 保留在第 1 帧并隐藏它们，但我认为这会不必要地增加开销。即使 _visible 设置为 false ，是不是还是会消耗资源？（这是一个不同但相关的问题——如果你有一个不可见的复杂、固定的 MC 与根本没有它，性能有什么不同吗？）

我目前的策略是这样的：

```
mc.gotoAndPlay("on");
var inst_mc:MovieClip = mc.inst;
var inst_c:C = C(mc.inst);

if (inst_c){
    // Even though I moved to the "on" frame,
    // the object was already initialized/existed already
    // so i can use its class code now
    inst_c.do_something_now();
}else{
    // The class is not accessible, so set a boolean flag
    // which will get dynamically assigned to the *movie clip*.
    // The constructor in class C will look to see if the flag
    // has already been set.  If so, it calls do_something_now()
    // within C's constructor.
    // In class C, trigger_do_something_now is a defined as a 
    // Boolean with no default value.
    // It is not set in the constructor.
    inst_mc.trigger_do_something_now = true;
} 
```

这种方法让我很困扰。这是混乱和混乱的。但是，我认为这是一个合理的解决方法。你们有什么感想？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-23T12:24:35.693

不幸的是，这就是 AS2 中“面向对象”代码的工作方式。这就是你应该如何可视化它：当时间线播放头在帧 A 上时，并且你`gotoAndStop(B)`调用仍在完成帧 A 的执行。直到 Flash 内部循环的下一次迭代才处理帧 B。

自从上课只是众所周知的送奶工眼中的闪光的日子以来，事情就是这样。正如你可以猜到的，对于附加类剪辑，一切都一样——当你将播放头移动到帧 B 时，Flash 会在帧 B 上创建所有内容，但它不运行驻留在帧 B 上的任何脚本——这包括构造函数刚刚创建的剪辑 - 直到下一帧。

最简单的解决方法是重新设计您的时间线，以便在第 1 帧中创建有问题的 MC，但在 gotoAndStop 命令之前保持隐藏（或不活动、关闭等）。您可以通过在给定帧上的 IDE 中更改其 alpha（等）来做到这一点，或者在执行 gotoAndStop 的同时调用一个 init 方法。如果可以的话，*最好*的解决方法是使用 AS3。还有其他方法可以走，但我推荐这两种方法中的一种。

**更新以进行编辑：** 是的，“您可以采用的其他方法”之一是将参数放入剪辑或其父级中，并让剪辑在初始化时查找它们，但最终维护您的代码的任何人都不会谢谢你。但我确实做到了。;)

在回答您的附带问题时，如果剪辑在舞台范围内，则 _visible=false 会产生非常小的开销。它没有被渲染，但是有一个非常小的命中，我认为这与 Flash 计算它的边界或类似的东西有关。（我曾经进行过一次测试，你真的需要成千上万的测试才能对其进行测量。）即使这是性能损失也是一个问题，解决方法是将不可见的剪辑移到舞台边界之外。然后，我发现它们不会对处理器造成任何影响，它们只使用脚本内存（如果您延迟它们的初始化直到它们准备好使用，那么内存就很少了）。

请记住，无论剪辑是否可见，事件处理程序都会触发，因此在初始化之前不要让剪辑注册事件。我要做的是使用构造函数中的所有内容创建一个 init() 方法，并在您本来构造剪辑的地方调用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T00:48:46.113

首先，让我为只关注这个问题的一个方面而道歉（在我对 fenomas 回答的评论中）；虽然我已经表达了我的观点，而且我什至同意将面向对象，或者至少，一个正式的类语法作为事后的想法添加到 AS1，称为 AS2——在某些时候，它表明——，我忽略了回答你的实际问题.

重新阅读这个帖子，我认为这一切都归结为“等待一帧”。这是我不得不在 AS2 中多次使用的一种解决方法，所以我忽略了这里的真正问题似乎很奇怪。

无论如何，您的解决方法可能会奏效，但正如您所说，它很快就会成为维护的噩梦。Feomas 的选项是另一种有效的解决方法。在这种情况下，如果我可以避免它，我不会那样做，但不是因为性能；相反，因为当你已经布置好很多东西时重新安排很多东西可能是很多工作。

所以，也许你可以尝试一些非常简单的事情，比如：

```
mc.gotoAndPlay("on");
this.onEnterFrame = function():Void {
    trace(mc.inst instanceof C);
    delete this.onEnterFrame;
}; 
```

我认为它应该工作。enterFrame 事件将在您注册后一帧被您的处理程序捕获。此时，您现在移动到的框架已准备就绪，因此您只需清理处理程序并执行您在发出 gotoAndPlay 后通常会执行的操作。

我记得我曾经不得不做一些非常相似的事情（不是完全相同的场景，但归结为等待一帧），所以当时我写了一个非常简单的类来集中这段代码。大致是这样的：

```
class FrameDelay {

    function FrameDelay(scope:Object,callback:Function,args:Array) {
            // get a reference to the current enterFrame handler
            // (if any), so we can restore it back when we're done   
        var oldEnterFrameHandler:Function = _root.onEnterFrame;

    _root.onEnterFrame = function():Void {
        oldEnterFrameHandler();
        callback.apply(scope,args);
        _root.onEnterFrame = oldEnterFrameHandler;
    }
    }

} 
```

你会像这样使用它：

```
mc.gotoAndPlay("on");

new FrameDelay(this,onFrameReady,["a","1"]);

function onFrameReady():Void {
    //  arguments (if any), will be available in the arguments array 
    trace(arguments.length);
    trace(mc.inst instanceof C);
    trace(this); 

} 
```

你传递一个作用域、一个函数和一个可选的参数数组。最有可能的是，您不需要它们，也可以只让类构造函数进行回调。但在某些情况下，您的回调中可能存在范围问题（这是一个 AS2 问题），因此显式传递范围更安全。

另外，请注意我正在使用 _root.onEnterFrame。虽然我正在对原始处理程序进行“备份”并在完成后将其恢复，但这并不一定意味着代码的其他部分是礼貌的（！）。因此，处理程序可能会被覆盖。如果您认为这可能是一个问题，也许您可​​以动态地在根目录中创建一个movieClip，在您知道它没有被使用的某个深度，并将_root.onEnterFrame 替换为_root.dummy_mc.onEnterFrame。

无论如何，请记住，一个简单的内联 onEnterFrame 就可以完成这项工作，所以也许你甚至不需要为此使用一个类。

# c# - 需要 Castle.Windsor 作为 Asp.Net MVC ControllerFactory 的帮助

> ID：896337
> 
> 赞同：1
> 
> 时间：2009-05-22T04:22:44.643
> 
> 标签：c#, asp.net-mvc, castle-windsor

我正在尝试从他的专业 Asp.Net MVC 框架书籍（好书，顺便说一句）中实现 Steven Sanderson 的 WinsorControllerFactory，但我遇到了一个问题。我不确定您还需要知道什么才能做出回应，但我非常感谢您在这方面的任何帮助。谢谢！

这是代码：

**温莎控制器工厂**

```
public class WindsorControllerFactory : DefaultControllerFactory
{
    private WindsorContainer _container;

    public WindsorControllerFactory()
    {
        _container= new WindsorContainer(new XmlInterpreter(new ConfigResource("castle")));
        var controllerTypes = from t in Assembly.GetExecutingAssembly().GetTypes()
                              where typeof (IController).IsAssignableFrom(t)
                              select t;
        foreach(Type t in controllerTypes)
        {
            _container.AddComponentLifeStyle(t.FullName, t, LifestyleType.Transient);
        }
    }
    protected override IController GetControllerInstance(Type controllerType)
    {
        return (IController)_container.Resolve(controllerType);
    }
} 
```

**网络配置**

```
 <castle>
    <components>
      <component id="MenuRepository"
                 service="****.IMenuRepository, ****.Model"
                 type="****.FakeMenuRepository, ****.Model">
      </component>
      <component id="NewsRepository"
                 service="****.INewsRepository, ****.Model"
                 type="****.FakeNewsRepository, ****.Model">
      </component>
    </components>
  </castle> 
```

**新闻文章Controller**

```
public class NewsArticleController : Controller
{
    private INewsRepository _repository { get; set; }
    public NewsArticleController(INewsRepository repository)
    {
        _repository = repository;
    } 
```

**全球.asax**

```
 protected void Application_Start()
    {
        RegisterRoutes(RouteTable.Routes);
        ControllerBuilder.Current.SetControllerFactory((new WindsorControllerFactory()));
    } 
```

**ERROR MESSAGE** No component for support the service ****.NewsArticleController was found 描述：在执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。

```
Exception Details: Castle.MicroKernel.ComponentNotFoundException: No component for supporting the service ****.NewsArticleController was found

Source Error:

Line 29:         protected override IController GetControllerInstance(Type controllerType)
Line 30:         {
Line 31:             return (IController)_container.Resolve(controllerType);
Line 32:         }
Line 33:     } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T06:35:41.290

S#arpArchitecture 项目很好地实现了使用 Windsor 作为 DI 框架（用于控制器或其他任何东西），几乎不需要添加 web.config 部分 - [http://code.google.com/p/sharp-建筑学/](http://code.google.com/p/sharp-architecture/)

代码示例：

CastleWindsor/ComponentRegistrar.cs：

```
public class ComponentRegistrar
{
    public static void AddComponentsTo(IWindsorContainer container) {
        AddGenericRepositoriesTo(container);
        AddCustomRepositoriesTo(container);

        container.AddComponent("validator",
            typeof(IValidator), typeof(Validator));
    }

    private static void AddCustomRepositoriesTo(IWindsorContainer container) {
        container.Register(
            AllTypes.Pick()
            .FromAssemblyNamed("Northwind.Data")
            .WithService.FirstNonGenericCoreInterface("Northwind.Core"));
    }

    private static void AddGenericRepositoriesTo(IWindsorContainer container) {
        container.AddComponent("entityDuplicateChecker",
            typeof(IEntityDuplicateChecker), typeof(EntityDuplicateChecker));
        container.AddComponent("repositoryType",
            typeof(IRepository<>), typeof(Repository<>));
        container.AddComponent("nhibernateRepositoryType",
            typeof(INHibernateRepository<>), typeof(NHibernateRepository<>));
        container.AddComponent("repositoryWithTypedId",
            typeof(IRepositoryWithTypedId<,>), typeof(RepositoryWithTypedId<,>));
        container.AddComponent("nhibernateRepositoryWithTypedId",
            typeof(INHibernateRepositoryWithTypedId<,>), typeof(NHibernateRepositoryWithTypedId<,>));
    }
} 
```

Global.asax（di 的主要初始化方法）：

```
protected virtual void InitializeServiceLocator() {
        IWindsorContainer container = new WindsorContainer();
        ControllerBuilder.Current.SetControllerFactory(new WindsorControllerFactory(container));

        container.RegisterControllers(typeof(HomeController).Assembly);
        ComponentRegistrar.AddComponentsTo(container);

        ServiceLocator.SetLocatorProvider(() => new WindsorServiceLocator(container));
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-09T08:26:13.933

MvcContrib 提供了一些在 Windsor 中注册控制器的扩展方法，例如：

```
windsorContainer.RegisterControllers(Assembly.GetExecutingAssembly()); 
```

Mannish 的代码使用相同的扩展方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-09-29T16:43:30.600

不要忘记 WindsorControllerFactory 的 ReleaseController 函数，否则你的工作进程将耗尽内存，因为控制器没有被释放。

# c# - 资源 (.resx) 文件密钥命名约定？

> ID：896342
> 
> 赞同：31
> 
> 时间：2009-05-22T04:26:25.363
> 
> 标签：c#, resources, naming-conventions, translation

我正在构建一个 C# 应用程序，它可能包含几个资源文件来存储用于语言翻译的字符串。我正在尝试为我的资源文件中的键提出一个命名约定。有人在我之前解决过这个问题吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-04T18:30:24.253

只需使用 Pascal 命名约定。不要将密钥归因于模块或类。泛化它以便它可以被重用。

例如：ReadWriteWarningMessage

点分隔约定适用于菜单项。但是动态生成的字符串或用户消息呢？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-28T18:36:52.327

您是否考虑过像 Menu_File_Open 或 Place_StringDescription 这样的下划线？我目前采用一种方案，其中常见的东西去 Common_ 像 Common_PressHereTo 和查看具体去他们各自的地方像 MainMenu_FileOpen。通常，在下划线之前输入资源出现的位置，在下划线之后输入描述性文本。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-28T18:40:04.490

我尝试将其组织为类似于我用来布局程序结构的命名空间。因此，如果您有 MyCompany.MyProduct.MyModule，那么该模块中的字符串将是 MyModule_Blah_Blah。这样它们在整个产品中是独一无二的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-06-16T17:01:02.180

请参阅[https://docs.microsoft.com/en-us/dotnet/standard/design-guidelines/naming-resources](https://docs.microsoft.com/en-us/dotnet/standard/design-guidelines/naming-resources)。正如@bobbyalex 所说，这包括使用PascalCasing，因为生成的资源设计器文件确实将资源实现为属性。

> ✔️ 务必在资源键中使用 PascalCasing。
> 
> ✔️ 请务必提供描述性而非简短的标识符。
> 
> ❌ 不要使用主要 CLR 语言的语言特定关键字。
> 
> ✔️ 请务必在命名资源时仅使用字母数字字符和下划线。
> 
> ✔️ 请务必对异常消息资源使用以下命名约定。
> 
> 资源标识符应该是异常类型名称加上异常的简短标识符：
> 
> `ArgumentExceptionIllegalCharacters` `ArgumentExceptionInvalidName` `ArgumentExceptionFileNameIsMalformed`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T04:59:09.517

如果您在资源中有一个名称值对，例如

CloseConfirmation - 是否要关闭窗口而不保存？

添加一个名为 Messages 的新类。

```
 public static class Messages
{
    public const String CloseConfirmation = "CloseConfirmation";
    public static String GetMessage( String messageId )
    {
        return //your namespace//.Properties.Resources.ResourceManager.GetString( messageId );
    }} 
```

并访问它使用

```
MessageBox.Show( Messages.GetMessage(Messages.CloseConfirmation)); 
```

希望这会有所帮助。

# history - 为什么向导对话框称为“向导”？

> ID：896344
> 
> 赞同：10
> 
> 时间：2009-05-22T04:27:33.150
> 
> 标签：history, terminology

今晚我正在和我的非技术妻子谈话。她在谈论她如何培训员工使用一些新软件。该软件大量使用向导来完成任务。她问我的问题是“为什么巫师被称为‘巫师’？它们是由对龙与地下城感兴趣的书呆子制作的吗？”

我意识到，虽然“书呆子”和“龙与地下城”在我的情况下是真实的，但我不知道“向导”一词的起源，因为它与引导用户通过某些应用程序的一部分有关艰难的过程。

我很想知道这里的其他人对这个伟大而重要的问题有什么想法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-22T04:35:23.827

我的印象是它与类似于“专家”的向导的含义有关。UI 向导就像一个（*非常*简单的）[专家系统](http://en.wikipedia.org/wiki/Expert_system)。向导/“专家”会问您一系列问题以找出您想要什么，然后他们使用他们的“专业知识”来生成结果。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-22T04:45:45.997

原始向导界面之一是使用 Microsoft Publisher 2.0。

向导部分出现在最后一个对话框页面之后，它将“神奇地”执行完成向导中请求的任务所需的操作，并实际*向*您展示如何执行此操作。例如，运行贺卡向导，将向您展示如何设置纵横比、纸张大小等。

我猜用户界面测试表明没有足够的人遵循向导教程，只是跳过它以获得所需的结果，因为此功能在更高版本的 Publisher 中被删除。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T04:35:38.037

因为他们*神奇地*引导用户完成整个过程以实现用户目标。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T04:33:18.833

我相信微软发明并引入了这个词，毫无疑问是出于营销相关的原因。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T04:32:55.430

我猜是因为用户界面配置了以前手动完成的事情，这对用户来说一定是魔法。如果你仔细想想，这是一个很好的类比——这个小配置应用程序可以用一个“挥动魔杖”来做很多事情。

# android - Android - 查找当前是否正在播放音频并停止它

> ID：896354
> 
> 赞同：8
> 
> 时间：2009-05-22T04:31:47.613
> 
> 标签：android

我正在使用 MediaPlayer 实例来从 Internet 位置流式传输音频文件。音频播放器处于单独的活动中。用户可以从音频文件列表中选择并来到这个活动来播放音频。

现在用户可能会回到之前的活动（使用列表）并选择另一个音频文件。在这种情况下，我想停止正在播放的任何其他音频并开始播放选择的新音频。

有什么方法可以知道音频文件是否正在播放，而无需保留 MediaPlayer 对象？

谢谢。

**编辑**

我确实找到了如何知道音频是否正在播放。我们可以通过使用 AudioManager 的对象并调用 isAudioPlaying() 来实现。如果正在播放任何音频，这将返回 true。

现在另一个问题是，**如何停止当前播放的音频？**我没有为启动音频而创建的 MediaPlayer 对象的实例（因为用户已经离开过一次活动，并且返回了活动的新对象，因此是 MediaPlayer 的新实例）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-23T23:06:08.000

您需要调用[`stop()`](http://developer.android.com/reference/android/media/MediaPlayer.html#stop())实例`MediaPlayer`。要在您的应用程序中使用此功能，您需要：

*   `stop()`在音频播放活动中调用（在 中`onDestroy()`），例如
*   创建一个[服务](http://developer.android.com/reference/android/app/Service.html)来播放音频，并从两个活动中与之通信

使用 a`Service`将允许您的代码在 Activity 生命周期之外继续运行，并且是`MediaPlayer`在这种情况下像您需要的那样持久化对象的唯一方法。

或者，您可以创建自定义子类[`Application`](http://developer.android.com/reference/android/app/Application.html)并将其存储在`MediaPlayer`那里，但使用 a`Service`被认为是更好的做法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-02-19T09:19:06.973

我找到了检查音频流（AudioManager.STREAM_RING、AudioManager.STREAM_NOTIFICATION 等）当前是否正忙于使用反射的方法：

```
/**
 * Unhide android api: check is stream is active now (AudioManager.STREAM_RING, AudioManager.STREAM_NOTIFICATION...),
 * uses reflection
 * @param audioStream
 * @return
 */
public static boolean isStreamActive(int audioStream) {
    Class<?> audioSystemClazz = null;
    Boolean res = false;
    try {
        audioSystemClazz = Class.forName("android.media.AudioSystem");
        if (null != audioSystemClazz) {
            // isStreamActive
            Method method = audioSystemClazz.getDeclaredMethod("isStreamActive", new Class<?>[] { int.class,
                    int.class });
            if (null != method) {
                res = (Boolean) method.invoke(null, audioStream, 0);
            }
        }
    } catch (ClassNotFoundException e) {
        e.printStackTrace();
    } catch (NoSuchMethodException e) {
        e.printStackTrace();
    } catch (IllegalAccessException e) {
        e.printStackTrace();
    } catch (IllegalArgumentException e) {
        e.printStackTrace();
    } catch (InvocationTargetException e) {
        e.printStackTrace();
    }

    return res;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-16T00:26:34.523

这是一些方便的代码，可以在音频播放完毕之前休眠：

```
 AudioManager manager = (AudioManager)this.getSystemService(Context.AUDIO_SERVICE);
   while(manager.isMusicActive())
    {
        Log.d("music", "music is active");
        try
        {
            Thread.sleep(500);
        }
        catch (InterruptedException e)
        {
            Log.e("music", "interrupted waiting for music to stop");
        }
        Log.d("music", "done playing music");
    } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-12-22T17:39:06.613

@lostintransit “使用服务、静态变量还是单例类会更好吗？更好的设计选项是什么？”

我认为服务就是你想要的。内置媒体播放器和 Pandora 的应用程序都使用服务来确保音乐不与 Activity 生命周期相关联。

如果我理解您为什么要使用单例或静态，我认为它不会完成您想要的。单例/静态将仅在 Linux 的单个进程中强制执行。如果您启动 Activity，然后关闭它，然后再次启动它，它们将在不同的进程中运行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-07T05:47:41.257

试试这个...

```
if (mp1 != null && mp1.isPlaying()) {
               mp1.stop();
           } 
```

其中 mp1 是`MediaPlayer`

# oracle10g - Oracle 错误 ORA-22905: 无法访问非嵌套表项中的行

> ID：896356
> 
> 赞同：9
> 
> 时间：2009-05-22T04:32:39.830
> 
> 标签：oracle10g

这是我编写的存储过程。在这个过程中，“p_subjectid”是一个从前端传递的数字数组。

```
PROCEDURE getsubjects(p_subjectid subjectid_tab,p_subjects out refCursor) 
       as

       BEGIN

            open p_subjects for select * from empsubject where subject_id in
            (select column_value from table(p_subjectid));
            --select * from table(cast(p_subjectid as packg.subjectid_tab))
      END getsubjects; 
```

这是我得到的错误。

```
Oracle error ORA-22905: cannot access rows from a non-nested table item OR 
```

正如我在不同的帖子中看到的那样，我尝试在下面的评论中给出的表函数中转换“cast（p_subjectid as packg.subjectid_tab）”。但我收到另一个错误：`ORA-00902: invalid datatype`。

这就是“subjectid_tab”的定义。

```
type subjectid_tab is table of number index by binary_integer; 
```

谁能告诉我错误是什么。我的程序有什么问题吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-09-10T10:55:23.340

您必须按照 ammoQ 的建议在“数据库级别”声明类型：

```
CREATE TYPE subjectid_tab AS TABLE OF NUMBER INDEX BY binary_integer; 
```

而不是在 PL/SQL 中声明类型。如果只在 PL/SQL 块中声明类型，SQL“引擎”将无法使用它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-04-30T08:43:35.547

Oracle 有两个执行范围：SQL 和 PL/SQL。当您使用`SELECT`// `INSERT`( `UPDATE`etc) 语句时，您正在 SQL 范围内工作，并且在 Oracle 11g 及更低版本中，您不能引用在 PL/SQL 范围内定义的类型。（*注意：Oracle 12 对此进行了更改，因此您可以引用 PL/SQL 类型。）*

```
TYPE subjectid_tab IS TABLE OF NUMBER INDEX BY BINARY_INTEGER; 
```

是一个关联数组，只能在 PL/SQL 范围内定义，因此不能在 SQL 语句中使用。

您想要的是使用以下方法在 SQL 范围内定义一个集合（不是关联数组）：

```
CREATE TYPE subjectid_tab IS TABLE OF NUMBER; 
```

（*注意：您不需要`INDEX BY`集合的子句。*）

然后你可以这样做：

```
OPEN p_subjects FOR
  SELECT *
  FROM   empsubject
  WHERE  subject_id MEMBER OF p_subjectid; 
```

或者

```
OPEN p_subjects FOR
  SELECT *
  FROM   empsubject
  WHERE  subject_id IN ( SELECT COLUMN_VALUE FROM TABLE( p_subjectid ) ); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T19:10:05.973

我昨天刚遇到这个问题。

```
宣布
  类型 number_table 是数字表；
  result_ids number_table := number_table();
开始
  /* .. 一堆成功使用我的类型的代码 */

  打开 ？作为
  选择 *
  FROM TABLE(CAST(result_ids AS number_table)); /* 轰！*/
结尾;

```

当从 java 例程调用时，这两种方式都失败了。我发现这是因为 number_table 类型没有以可导出的方式定义，不能从数据库中运出。该类型在例程内部工作得很好。但是，一旦您尝试执行以任何方式引用它的可返回记录集（包括 IN 子句？！？），您就会得到一个未定义的数据类型。

所以解决方案真的是`CREATE TYPE myschema.number_table IS TABLE OF NUMBER;`然后从你的块中删除类型声明并使用模式级别声明。使用模式限定符来引用类型，以确保您使用的是正确的类型。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-02-18T16:08:53.727

这是一个很好的解决方案。如果您转换的类型在 pl/sql 块的 DECLARE 部分中，则不能使用 table(cast())。你真的需要使用 CREATE TYPE my_type [...]。否则，它会抛出“cannot fetch row[...]”异常。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-26T11:39:57.110

您必须转换管道查询的结果，以便：

如果您的流水线函数返回 varchar2 的行类型，则定义一个类型（例如）

```
CREATE OR REPLACE TYPE char_array_t is VARRAY(32) of varchar2(255);
select * from table(cast(fn(x) as user_type_t ) ); 
```

现在可以工作了。

# asp.net - 如何在sql server08中检查区分大小写的密码

> ID：896367
> 
> 赞同：1
> 
> 时间：2009-05-22T04:36:54.107
> 
> 标签：asp.net, sql-server

在我的应用程序中，我正在向数据库发送密码，假设我的密码是 PasswordD123。现在这给了我正确的价值，但是当我使用密码 123 时……它也给了我正确的价值。那么如何在 SQL Server 中检查区分大小写的数据。任何演示代码都会有所帮助。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T04:43:06.717

为什么不使用加密将密码存储在 md5 等数据库中，因为它们将返回不同的哈希版本，例如

密码123的md5 = 482c811da5d5b4bc6d497ffa98491e38

密码 D123 的 Md5 = bbac8ba35cdef1b1e6c40f82ff8002ea

当你比较它们 2 时，它们显然是不同的。

我认为您使用的是 ASP，因此我不知道它是否具有内置的 md5() 函数，但 php 确实有。您应该知道的另一件事是，如果您将密码存储在数据库中，最好使用某种无法逆转的加密来存储它们

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T04:43:45.373

您的查询的直接答案在这里： [http ://web.archive.org/web/20080811231016/http://sqlserver2000.databases.aspfaq.com:80/how-can-i-make-my-sql-queries -case-sensitive.html](http://web.archive.org/web/20080811231016/http://sqlserver2000.databases.aspfaq.com:80/how-can-i-make-my-sql-queries-case-sensitive.html)

但是我认为您存储/比较密码的方法有点错误。您不应该将密码直接存储在数据库中。至少 MD5 它什么的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T04:43:52.643

好吧，简短的回答是使用区分大小写的排序规则 - 较长的答案是[不要在数据库中存储明文密码](http://www.matasano.com/log/958/enough-with-the-rainbow-tables-what-you-need-to-know-about-secure-password-schemes/)！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-22T04:45:49.697

您可以在 T-SQL 语句中使用 COLLATE 子句。

前任。

```
SELECT * FROM dbo.TableName WHERE Password = @ password COLLATE SQL_Latin1_General_CP1_CS_AS 
```

# c++ - 在 .vcproj RelativePath 中使用“用户宏”

> ID：896371
> 
> 赞同：2
> 
> 时间：2009-05-22T04:39:15.810
> 
> 标签：c++, include, visual-c++

在[.vcproj 文件](http://msdn.microsoft.com/en-us/library/2208a1f2.aspx)中有一个项目中所有源文件的列表。

我们如何使用宏来指定源文件的路径？如果我们这样做：

```
<File
   RelativePath="$(Lib3rdParty)\Qt\qtwinmigrate-2.5-commercial\src\qmfcapp.cpp">
</File> 
```

编译器找不到文件夹：

```
qmfcapp.cpp
c1xx : fatal error C1083: Cannot open source file: '.\$(lib3rdparty)\qt\qtwinmigrate- 2.5-commercial\src\qmfcapp.cpp': No such file or directory 
```

如您所见，我们的项目编译成来自 QT 的几个源文件。QT 位于外部库的文件夹中，我们不希望硬编码从项目到该文件夹​​的路径（我们有一个非常大的解决方案）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T07:12:51.560

正常的解决方案是使用您自己的源代码在源代码控制中包含第 3 方包含、库和源代码，这样您就可以使用您的源代码跟踪对第 3 方依赖项的更改。

如果是这种情况，您应该能够使用从每个项目到第 3 方源文件的相对路径。

但是，如果您的解决方案很大，并且它具有复杂的项目设置，您应该查看[CMake](http://www.cmake.org)，即使您只是在 Windows 上构建。CMake 使您能够使用仅在一处指定的通用设置来描述您的构建环境。更复杂的情况可以用变量和宏来处理。然后它会根据该描述生成您的 Visual Studio 项目或生成文件。我们引入它是为了支持 unix 端口，现在我也将它用于 Windows 开发。

VS 项目使用起来真的很笨拙，打开和关闭对话框，设置调试和发布。每个项目都有自己的设置副本，但与所有其他项目基本相同。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-05-24T02:57:59.480

如果您从不同的驱动器添加现有文件，您会注意到使用了绝对路径。

至少对于 v8.00，宏似乎没有被扩展。我尝试了 VC、Ant 和 OS 宏形式——没有一个奏效。

总是有 sysinternals 的 junction 选项、映射的网络路径或带有宏规范设置到项目/全局源、包含和 lib 路径中的 .lib。即使使用 lib 包，您也应该能够进入源代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-15T21:15:29.013

尝试将“Lib3rdParty”的环境变量设置为适当的相对路径片段。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-24T18:14:56.380

..应该提到的是，虽然使用属性表可以消除很多笨拙

# gridview - 如何将过滤器应用于网格视图（例如将过滤器应用于 Excel 工作表）

> ID：896372
> 
> 赞同：0
> 
> 时间：2009-05-22T04:39:42.223
> 
> 标签：gridview, c#-2.0

您好我正在做一个应用程序，我通过将不同的参数传递给存储过程并将数据获取到数据表并将其绑定到网格视图来从数据库填充网格。现在我需要将过滤器应用于网格以便它应该就像应用于 Excel 工作表的过滤器一样工作。

我可以有一些代码在不改变网格设计的情况下将过滤器应用于网格视图吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T05:14:41.117

由于您使用的是 DataTables，请查看 DataViews，可通过设置 DataTable.DefaultView

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-05T18:14:20.177

只是我的两分钱，但您可以指定一个过滤器表达式作为 DataTable.Select() 的第一个参数。

我不知道这对你有什么影响，但它可以解决。

# .net - 西班牙语单词的正则表达式是什么？

> ID：896374
> 
> 赞同：6
> 
> 时间：2009-05-22T04:40:43.500
> 
> 标签：.net, regex, word

正则表达式语言使用 \B 来包含 A..Z、a..z、0..9 和 _，而 \b 定义为单词边界。

如何编写一个匹配所有有效西班牙语单词的正则表达式，包括：á、í、ó、é、ñ 等字符？

我正在使用.NET。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-22T04:45:19.680

使用西班牙语语言环境并使您的正则表达式语言环境敏感。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T04:45:36.107

您的正则表达式系统应该具有与 Python `re.L`（又名`re.LOCALE`）等效的东西，以使正则表达式依赖于语言环境，以便什么是单词字符，什么不随语言环境而变化，就像“单词边界”等一样。您是否要求一个补偿某些*不*支持语言环境的给定正则表达式系统的方法，无论如何都试图强制解决问题...？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T04:51:48.117

这在很大程度上取决于您使用的语言（和正则表达式引擎）。

在 Perl 中，`\w`匹配所有单词字符，无论语言或字母如何，并且`/\b(\w+)\b/`（可能）匹配西班牙语单词以及英语单词或俄语单词。

在使用 PCRE 的语言中，`\w`（因此可能`\b`）不匹配 Unicode 字符。您可能需要构建自己的集合。我建议类似`[\wáéíóúñ]`（匹配所有单词字符，加上你想要的重音字符），并且 PCRE 库必须预先构建支持 Unicode，然后才能工作。

如果你正在使用其他东西，祝你好运。一些正则表达式引擎甚至不支持 Unicode。

# post - 如何确定 TCP/IP 中的总数据上传+下载

> ID：896376
> 
> 赞同：2
> 
> 时间：2009-05-22T04:41:49.680
> 
> 标签：post, get, tcp

我需要在 TCP/IP 中将固定大小的数据从客户端传输到服务器时计算总数据传输。包括连接服务器、发送请求、请求头、接收响应、接收数据等。

更准确地说，如何在使用 POST 和 GET 方法时获得总数据传输？

有什么公式吗？即使是理论上的也可以（不考虑丢包或连接重试等）

仅供参考，我尝试了 RFC2616 和 RFC1180。但这些都超出了我的想象。

有什么建议吗？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T05:17:25.420

即使忽略重传，您也无法提前知道总传输大小。有几件事会阻止你：

*   建立连接时，主机之间会协商 TCP 选项。一些选项（例如时间戳）将附加数据添加到 TCP 标头
*   “总数据传输大小”不清楚。例如，以太网在使用的任何 IP 之上添加了相当多的位。802.11（无线）将增加更多。HDLC 或 PPP 通过 T1 也是如此。甚至不要考虑帧中继。一些链接可能会使用压缩（这将减少总大小）。总大小取决于您测量它的位置，即使是单个数据包也是如此。
*   假设您只对第 2 层的总八位字节大小感兴趣，并且您知道将提前协商的 TCP 选项，您仍然无法知道路径 MTU。即使在连接过程中，这也可能会发生变化。或者，如果您没有进行路径 MTU 发现（这会很奇怪），那么数据包可能会在某处碎片化，并且远程端将看到与您不同的数据传输量。

我不确定您为什么需要知道这一点，但我建议：

*   如果您只是想要一个估计，请观看 Wireshark 中的典型连接。计算开销百分比（相对于您提供给 TCP 和从 TCP 接收的数据大小）。使用该数字进行估计：它将足够接近，除非在病理情况下。
*   如果您需要确定您的终端看到传输和接收了多少数据，请使用 libpcap 捕获数据包流并检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T04:59:42.653

我平均来说，请求和响应每行大约有 8 行标题，每行大约有 30 个字符。然后允许将任何上传的二进制文件转换为 Base64 的大小增加。

您没有说是否还想计算 TCP 数据包标头，在这种情况下，您可以假设 MTU 约为 1500，因此每 1500 个数据字节添加 16 个字节（tcp 标头）

最后，您始终可以设置数据包嗅探器并计算数据样本的实际字节数。

哦，是的，您可能还需要允许放气/gzip 编码。

# asp.net - DataTable 中当前 DataRow 的索引

> ID：896378
> 
> 赞同：0
> 
> 时间：2009-05-22T04:42:34.360
> 
> 标签：asp.net

```
For Each dr As myDAL.UsersRow In data
   str.AppendLine(dr.UserName)
Next 
```

在上面的代码中，我还需要包含行索引，以便它类似于

```
str.AppendLine(dr.IndexNumber & " " & dr.UserName) 
```

我怎样才能做到这一点？

PS`data`不是`DataTable`一个通用列表`myDAL.UsersRow`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T04:50:09.723

如果数据是`List<myDAL.UsersRow>`您建议的，您可以使用“for”循环而不是“for each”循环：

```
for i = 0 to data.Count - 1
    str.AppendLine(i & " " & data[i].UserName)
next 
```

但是，如果您暗示您的“数据”列表与原始 DataTable 的行的顺序不同，则可以使用[DataRowCollection.IndexOf](http://msdn.microsoft.com/en-us/library/system.data.datarowcollection.indexof.aspx)方法来定位原始表中的行：

```
for each dr as myDAL.UsersRow in data
    str.AppendLine(dr.Table.Rows.IndexOf(dr) & " " & dr.UserName)
next 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T04:51:53.530

在 ForEach 循环之前声明一个计数器变量，并在其中递增它。

```
 Dim counter As Integer = 0
    For Each dr As myDAL.UsersRow In data
        counter = counter + 1
        str.AppendLine(counter.ToString() & " " & dr.UserName)
    Next 
```

# c - C char 数组中的奇数

> ID：896379
> 
> 赞同：4
> 
> 时间：2009-05-22T04:42:46.827
> 
> 标签：c, arrays, pointers

当我在搞乱 C 数组时，我偶然发现了这个奇怪的结果：

```
char s[100] = "hello";
if(s == &s[0]) printf("true. ");
if(s == &s) printf("true.");
// output: true. true. 
```

我知道它`s`保存了第一个元素的内存位置，但是有没有办法找到`s`（指向第一个元素的指针的地址）的地址？为什么`&s`等于`s`？并不是说这很有用，但我想知道引擎盖下发生了什么。

我不确定不同的编译器是否以不同的方式实现它，但我使用的是 gcc。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-22T04:47:29.787

如果我让你把手指放在内存中字符数组 s 所在的位置，然后数组中第一个字符所在的位置，它们不都是一样的吗？

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-22T04:46:41.363

那是因为 s 不是指针，而是数组。数组在必要时会自动转换为指针（如 strcpy 等），但没有“指向第一个元素的指针的地址”之类的东西。s 在堆栈上只有 100 个字节；每当需要指针时，编译器就会将这 100 个字节的地址传递给函数调用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-22T04:47:57.900

该数组`s`不保存内存地址（即指针），它实际上保存了所有字符。

C 将自由地将数组转换为指向该数组的指针。

指向数组的指针与指向其第一个元素的指针相同。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-22T05:31:28.403

&s[0] 表示数组 s 的第一个元素的地址。&s[0] 的类型是 char *。

&s 表示数组 s 的地址。&s 的类型是 char (*)[100]。

&s[0] + 1 是下一个字节的地址。但是 &s + 1 是下一个 1*100=100 字节的地址。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T04:54:50.657

另一方面，您也可以执行以下操作：

```
char (*t)[100] = s;
if(t == &t[0]) printf("true 3\. ");
if(t == &t) printf("true 4."); 
```

在这种情况下，`t`确实是一个指向具有自己的存储和地址的字符数组的指针。案例 3 为真，案例 4 为*假*。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T05:11:07.297

```
Value of &s, s and &s[0] are same, but their types are not same.
type of &s is char (*)[100], but type of s and &s[0] is char*.
&s is a pointer to the entire array but s and &s[0] points to
the first element of the array.
sizeof(&s) and sizeof(s) is 100, but sizeof(&s[0]) is 4.
Similarly if s = 1000, then &s+1 returns 1100 but s+1 and &s[0]+1 returns 1001. 
```

# jquery - 如何组合两个 JQuery 函数

> ID：896390
> 
> 赞同：1
> 
> 时间：2009-05-22T04:45:51.177
> 
> 标签：jquery

有人可以帮我看看这个脚本有什么问题吗？发布的答案无效。当我使用该代码时，我得到的是提交的整个 html 页面。这是我可以从控制台看到的。有人可以帮我吗？谢谢。

* * *

```
$(function() {
    $('#add_customer_form').submit(function() {
        var data = $(this).serialize();
        var url = $(this).attr('action');
        var method = $(this).attr('method');
        $.ajax({
            url: url,
            type: method,
            data: data,
            dataType: 'json',
            success: function(data) {
                var $div = $('<div>').attr('id', 'message').html(data.message);
                if(data.success == 0) {
                    $div.addClass('error');
                } else {
                    // START CHANGE
                    // you need to get `datastring` from somewhere
                    $.ajax({
                       type: "POST",
                       url: "body.php?action=admCustomer",
                       data: dataString,
                       success: function(){
                           $('#contact input[type=text]').val('');
                           $div.addClass('success');
                       }
                    });
                    // END CHANGE
                }
                $('body').append($div);
            }
        });
        return false;
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-25T10:24:42.177

也许改变

```
var $div = $('<div>').attr('id', 'message').html(data.message); 
```

至

```
var $div = $('<div/>').attr('id', 'message').html(data.message); 
```

会成功吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T04:54:33.467

```
$(function() {
    $('#add_customer_form').submit(function() {
        var data = $(this).serialize();
        var url = $(this).attr('action');
        var method = $(this).attr('method');
        $.ajax({
            url: url,
            type: method,
            data: data,
            dataType: 'json',
            success: function(data) {
                var $div = $('<div>').attr('id', 'message').html(data.message);
                if(data.success == 0) {
                    $div.addClass('error');
                } else {
                    // START CHANGE
                    // you need to get `datastring` from somewhere
                    $.ajax({
                       type: "POST",
                       url: "body.php?action=admCustomer",
                       data: dataString,
                       success: function(){
                           $('#contact input[type=text]').val('');
                           $div.addClass('success');
                       }
                    });
                    // END CHANGE
                }
                $('body').append($div);
            }
        });
        return false;
    });
}); 
```

# c# - 将额外参数传递给 EventHandler

> ID：896393
> 
> 赞同：3
> 
> 时间：2009-05-22T04:47:06.513
> 
> 标签：c#, wcf, silverlight

您好我正在尝试遍历我创建的自定义按钮列表。它调用 WCF 服务以从数据库中获取一些信息。

```
foreach (LevelButton l in ls)
{
    WayFinderDBService.WayFinderDBServiceClient client = new    SilverlightNav.WayFinderDBService.WayFinderDBServiceClient();
    client.GetLevelDescriptionCompleted += new    EventHandler<SilverlightNav.WayFinderDBService.GetLevelDescriptionCompletedEventArgs>(client_GetLevelDescriptionCompleted);
    client.GetLevelDescriptionAsync(l.Name);                    
} 
```

我想获取从 client.GetLevelDescriptionAsync(l.Name); 返回的任何内容 然后将其传递给按钮 eglText = result;

我的问题是将按钮的引用作为额外参数传递给 EventHandler。实现我想做的事情的正确方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T05:03:40.280

您可以考虑两种方法：

*   用额外的数据声明你自己的委托类型/事件参数类型
*   在公开此数据的提升类上有一个公共属性

如果`GetLevelDescriptionCompletedEventArgs`是你的类型，那么你已经在做第一个了——所以只需在 event-args 类型中公开这个值；您可以在匿名方法中使用它：

```
foreach (LevelButton l in ls)
{
    LevelButton tmp = l;
    var client=new SilverlightNav.WayFinderDBService.WayFinderDBServiceClient();
    client.GetLevelDescriptionCompleted += delegate (object sender, GetLevelDescriptionCompletedEventArgs args) {
       tmp.Text = args.SomeProperty; // **must** be tmp.Text, not l.Text
    }
    client.GetLevelDescriptionAsync(tmp.Name); // or l.Name; same here
} 
```

但是有一个问题 - 请注意`tmp`以上内容；这是臭名昭著的`foreach`/`capture`问题。

# c# - 组织执行测试的方法 - C#

> ID：896396
> 
> 赞同：0
> 
> 时间：2009-05-22T04:47:58.057
> 
> 标签：c#, unit-testing, testing, class-design

我现在有一个类，在这个类中它有 15 个左右的私有方法，这些方法在计时器运行的循环中执行某些任务。其中一些方法调用数据库，而另一些则不调用。

问题是......我该如何安排这些以便我可以设置课程以便我可以伪造一个回购或执行过程？

这是我现在拥有的简化版本。

```
public class Manager : IManager
{
    System.Timers.Timer tm;
    private bool runningAsService;
    private List<Database> Databases = new List<Database>();
    private LogClass Log;

    public Manager(bool RunningAsService, LogClass log)
    {
        runningAsService = RunningAsService;
        Log = log;

        tm = new System.Timers.Timer(Settings.idle_time * 1000);
        tm.Elapsed += new System.Timers.ElapsedEventHandler(delegate { PerformDuties(); });
    }

    public void Start()
    {
        tm.Start();
        PerformDuties();
    }

    private PerformDuties()
    {
        //Call the other 10-15 private methods to perform all the tasks needed.
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T05:10:32.133

每个 Db 操作都会以任何一个 CRUD 操作结束。因此，您可以从 Database 类中提取 IDatabase，换句话说，将您的数据访问层抽象为*如下*所示：

```
public interface IDatabase<T> 
{
     T CreateItem();
     T ReadItem(Id id);
     bool UpdateItem(T item);
     bool DeleteItem(T item)
} 
```

并使用依赖注入使用 DI 框架（如[Castle Windsor](http://www.castleproject.org/container/index.html)、[Spring.NET](http://springframework.net/)等）通过 Setter 或 Ctor 向您的`Manager`类注入数据库列表

希望这是有道理的.. :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T04:51:06.183

如果我正确理解您的问题，那么这听起来需要[依赖注入](http://en.wikipedia.org/wiki/Dependency_injection)，您可以在其中提供对象管理器依赖于完成其工作。它们可能是真实的对象（一个实际的数据库连接），也可能是一个假的，就像它一样。

我是否正确理解您的问题？

# cocoa - 是否可以有一个结合了多个关键路径的绑定？

> ID：896411
> 
> 赞同：0
> 
> 时间：2009-05-22T04:54:57.367
> 
> 标签：cocoa, cocoa-bindings, nsarraycontroller, key-value-coding

假设我有一个具有数量值的对象。

另外，我有一个数组控制器，其中包含这些对象的数组。

此外，我有一个表，它具有总列的百分比（即给定行的数量占所有行数量总和的百分比），需要通过绑定填充适当的值。

然后看起来这样做的想法是将此列绑定到 arrayController.arrangedObjects.@sum.quantity 除以 arrayController.arrangedObjects.quantity。

是否有可能做到这一点？

如果没有，您能否提出实现同样目的的替代方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T05:39:20.520

一种方法是实现自定义数字格式化程序，为除数自定义绑定，以编程方式绑定到`arrayController.arrangedObjects.quantity`. 在格式化程序的`setObjectValue:`方法中，您将执行除法并将结果传递给`super`.

# ruby-on-rails - Authlogic - Logout not working on production but working in dev?

> ID：896415
> 
> 赞同：0
> 
> 时间：2009-05-22T04:57:55.557
> 
> 标签：ruby-on-rails, session, authlogic

I have only just started to investigate... but thought I would throw this to the community as well.

I am building an app using Authlogic for authentication. The auth part is basically straight off the authlogic tutorials...

My logoff button works in dev, destroying the session and giving the flash on the root_url. However, on production the link spins, take me to the root_url, but no flash and the session data is still there.

Everything else works on production... like I said, I am just beginning to investigate. Hopefully someone has an idea...

Setup info: Rails 2.3.2 Dev - standard script/server mongrel Prod - apache/passenger/mysql

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T05:11:57.687

Well. Turns out there are some session issues with authlogic and versions of Passenger before 2.2.2.

I upgraded to 2.2.2 and the problem has been resolved.

So a quick upgrade and everything runs perfect.

# python - 如何更改默认 django 用户模型以满足我的需求？

> ID：896421
> 
> 赞同：14
> 
> 时间：2009-05-22T05:01:09.610
> 
> 标签：python, django, django-models

默认的 Django`User`模型有一些我并不真正需要的字段和验证规则。我想让注册尽可能简单，即需要电子邮件或用户名或电话号码——所有这些都是唯一的，因此可以作为用户标识符。

我也不喜欢在 Django 用户模型中验证的用户名的默认字符集。我想允许任何角色出现 - 为什么不呢？

我之前使用用户配置文件 django 应用程序向用户添加配置文件 - 但这次我宁愿让类最小化。但是我仍然想使用`User`该类，因为它为我提供了一种简单的方法来限制站点的某些部分，只允许登录的用户使用。

我该怎么做？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-22T14:59:04.217

除了直接修改 User 类或进行子类化之外，您还可以重新调整现有字段的用途。

对于一个站点，我使用“first_name”字段作为用户的“公开显示的名称”，并将该名称的 slugified 版本填充到“用户名”字段中（用于 URL）。我编写了一个自定义身份验证后端，以允许人们使用他们的“公共名称”或他们的电子邮件地址登录，并且我在注册时强制这两者的唯一性。这与其他可重用的应用程序很好地配合，并且不会引入额外的表或查询。

对于另一个站点，我根本不需要用户名，只需要独特的电子邮件。为了满足 Django 对唯一用户名的需求，我只是对电子邮件地址进行了哈希处理并将其用作用户名（您必须对哈希进行 base64 编码以将其压缩到 30 个字符以下）。自定义身份验证后端以允许使用电子邮件登录。

如果向后兼容性不是问题，我希望看到对 django.contrib.auth 和 User 模型进行很多改进，以使它们更加灵活。但是在当前的限制条件下，只要有一点创造力，你就可以做很多事情。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-22T07:59:39.023

Django 用户模型的结构非常合理。例如，您真的不想在用户名中允许任意字符，并且有一些方法可以实现[电子邮件地址登录](http://www.djangosnippets.org/snippets/74/)，而无需对基本模型进行黑客更改。

为了简单地存储用户帐户周围的附加信息，Django 支持用户配置文件的概念。虽然您不需要依赖内置支持来处理这个问题，但这是一个通常遵循的约定，它可以让您很好地使用漂浮在以太中的可重用 Django 应用程序。有关详细信息，请参阅[此处](https://docs.djangoproject.com/en/dev/topics/auth/customizing/#extending-the-existing-user-model)。

如果您想实际修改核心用户模型，但也想“玩得好”依赖于它的可重用应用程序，那么您打开了一个潘多拉魔盒。开发人员对核心库的结构做出基本假设，因此任何更改都可能导致意外损坏。尽管如此，您可以对基本模型的更改进行猴子补丁，或在本地分支 Django 的副本。我不鼓励后者，只有在您知道自己在做什么的情况下才推荐前者。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-22T13:47:00.897

**我误读了这个问题。希望这篇文章对其他人有帮助。**

```
#in models.py
from django.db.models.signals import post_save  

class UserProfile(models.Model):  
    user = models.ForeignKey(User)  
    #other fields here

    def __str__(self):  
          return "%s's profile" % self.user  

     def create_user_profile(sender, instance, created, **kwargs):  
        if created:  
           profile, created = UserProfile.objects.get_or_create(user=instance)  

post_save.connect(create_user_profile, sender=User) 

#in settings.py
AUTH_PROFILE_MODULE = 'YOURAPP.UserProfile' 
```

如果创建了用户，这将在每次保存用户时创建一个用户配置文件。然后你可以使用

```
 user.get_profile().whatever 
```

这是来自文档的更多信息

[http://docs.djangoproject.com/en/dev/topics/auth/#storing-additional-information-about-users](http://docs.djangoproject.com/en/dev/topics/auth/#storing-additional-information-about-users)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T14:09:53.300

如果您致力于避免已经指出的基于配置文件的定制，您将面临一些困境，实际上有两种解决方案。

1.  根据 Daniel 的建议更改`User`模型本身
2.  编写一个`CustomUser`类，继承`User`或复制它的功能。

后一个建议意味着您必须`User`手动实现一些自动执行的操作，但我想知道这是否像听起来那样糟糕，特别是如果您正处于项目的开始阶段。您所要做的就是重写一个中间件类和一些装饰器。

当然，我认为这不会给你带来任何 1 不会让你得到的东西，除非你的项目不应该因为你`svn update`的 django. 它可以避免与其他应用程序的一些兼容性问题，但我猜大多数问题都会存在。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-11T00:58:28.640

有很多方法可以做到这一点，但这是我要做的：我允许用户输入电子邮件、用户名（必须包含至少一个字母且没有`@`符号）或手机号码。然后，当我验证它时：

1.  检查是否存在`@`. 如果是这样，请将其设置为用户的电子邮件，对其进行适当的哈希处理并将其设置为用户名。
2.  检查它是否只有数字、破折号和`+`. 然后，剥离适当的字符并将其存储为手机号码和用户名（如果您将手机号码存储在另一个模型中以用于 SMS 目的或其他用途）。
3.  如果不是，只需将其设置为用户名。

我还会在登录时类似地验证用户/电话/电子邮件字段并查看适当的位置，这样如果用户使用他们的手机号码注册然后更改他们的用户名（出于其他目的），他们仍然可以使用他们的手机号码登录。

# php - 将结果与 PHP/MySQL 中的另一个表进行比较

> ID：896423
> 
> 赞同：0
> 
> 时间：2009-05-22T05:02:38.953
> 
> 标签：php, mysql

我有2张桌子...

```
表格1：
身份证、姓名、国家
表2：
ID、accountID、父级

table1.id = table2.acountID

```

我的脚本会搜索具有特定父级的所有记录。我想将这些结果与 table1 进行比较并返回所有不在搜索中的条目。

例如。表格1：

```
1，比尔，澳大利亚
2、查尔斯，美国
3，加利福尼亚州克莱尔

```

表2：

```
1, 1, 玛丽
2, 1, 威廉
3、2、亨利

```

搜索 (select * from table2 WHERE accountID='1') 返回：

```
1, 1, 玛丽
2, 1, 威廉

```

我想得到这个结果（来自table1）：

```
2、查尔斯，美国
3，加利福尼亚州克莱尔
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T05:05:17.190

```
SELECT * FROM table1 WHERE ID NOT IN
  (SELECT * FROM table2 WHERE accountID = '1') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T05:12:54.660

您的搜索返回 Table2 中 accountID = 1 的所有行

要返回搜索中未返回的所有行，您将在 Table1 中找到 ID 不是 1 的所有行，或者在 Table2 中没有任何匹配的行。

```
SELECT
  ID
FROM
  Table1
WHERE
  ID <> 1
  OR NOT EXIST (SELECT * FROM Table2 WHERE accountID = 1) 
```

看起来很简单？

# zigbee - ZigBee 堆栈建议

> ID：896428
> 
> 赞同：11
> 
> 时间：2009-05-22T05:03:51.777
> 
> 标签：zigbee

我已经离开 ZigBee 一段时间了。谁拥有最成熟的 Zigbee 堆栈？是 Microchip、Chipcon 还是 Atmel？

是否有价格低于 10 美元的射频模块？

我记得前一段时间某些堆栈存在一些许可问题......

[（这个问题最初是在 2009 年提出的。截至 2012 年，我认为 Ember 不再是领先的堆栈了。似乎[德州仪器](http://en.wikipedia.org/wiki/Texas_Instruments)已成为主导的芯片组/堆栈......虽然，他们的堆栈似乎确实被锁定使用 IAR 糟糕的 IDE，这会让我在使用它时三思而后行。）]

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-24T18:21:13.213

我们使用 Ember Corporation SoC 芯片已有一段时间了。他们的芯片、工具和实用程序给我留下了深刻的印象。一些公司将它们用于插件模块，Digi 的 XBee 和 Telegesis 是我们合作过的两个。

Ember 还实现了 ZCL 以及 HA 和 SA 配置文件，可供您使用。

www.ember.com

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-02-16T20:06:46.277

我已经对 TI 堆栈做了一些工作。这……*好吧*，我猜。IDE 的限制使它非常糟糕，并且有一些粗糙的边缘。文档并不是那么好，当你达到某个级别时，你会遇到一个闭源驱动程序模块（这可能是供应商之间的一个常见限制，他们还没有做足够的事情来临时知道。）不过，在使用 TI 堆栈构建了概念验证演示后，我仍在寻找替代方案。

在 ESC 和 CES 上看到了很多。作为参考，一些选项（没有特别的认可，按字母顺序）

*   Anaren - 他们的模块使用 TI 堆栈：[http ://anaren.com/air](http://anaren.com/air)
*   爱特梅尔 - [http://www.atmel.com/products/microcontrollers/Wireless/software.aspx](http://www.atmel.com/products/microcontrollers/Wireless/software.aspx)
*   余烬 - [http://ember.com/products_zigbee_chips.html](http://ember.com/products_zigbee_chips.html)
*   Marvell - 例如 88MZ100 部分 - [http://www.marvell.com/wireless/](http://www.marvell.com/wireless/)
*   NXP - 似乎有一个“JenNet”堆栈 - [http://www.nxp.com/products/rf/wireless_microcontrollers/](http://www.nxp.com/products/rf/wireless_microcontrollers/)
*   TI - [http://www.ti.com/z-stack](http://www.ti.com/z-stack)

欢迎任何其他建议/替代方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-07T17:23:54.030

两年后的 2011 年，Ember 的[ZigBee](http://en.wikipedia.org/wiki/ZigBee)堆栈无疑是赢家。Ember 拥有足以成为有效标准的 ZigBee 市场，并且大多数插件模块，包括 Digi 的[Xbee](http://en.wikipedia.org/wiki/XBee)和 Telegesis 都建立在 Ember 的 SoC 之上。

Chipcom/Texas Instruments 对 Ember 的协议有一些不同的解释，通常他们的堆栈不太灵活。如果您不想扫描网络并按照他们推荐的方式加入，那么您基本上就不走运了。

我没有使用任何其他堆栈。

# spring - 带有弹簧依赖注入的 GWT

> ID：896429
> 
> 赞同：9
> 
> 时间：2009-05-22T05:04:21.933
> 
> 标签：spring, gwt

我用谷歌搜索但找不到任何答案。

我打算使用 GWT。我想知道我是否可以在我的 GWT 代码中使用 spring 来使用依赖注入框架？我不是在谈论 GWT gui 与后端 spring 应用程序的交互。

我问的原因是 GWT 代码被编译为 JavaScript，这就是在浏览器中执行的。如果我在其中使用弹簧代码，那么它会起作用吗？或者其他任何库，如 log4j 等？

还是 GUI 代码必须是纯 GWT API？

例如，

```
公共类我的表{
   私人按钮 myButton;
   @自动连线
   公共MyTable（按钮aMyButton）{
      我的按钮 = 一个我的按钮；
   }
}

```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-22T23:34:16.367

[使用GIN](http://code.google.com/p/google-gin/)在 GWT 上支持 Guice 。对于带有 GWT 的类似 Spring 的 DI，请查看[GWT Toolbox](http://code.google.com/p/gwtoolbox/)或[Rocket GWT](http://code.google.com/p/rocket-gwt/)。

我相信 GIN 是 GWT 更自然的选择。不是因为它也是由 Google 制作的，而是因为使用 XML 进行 GWT 配置完全没有意义。一切都被静态编译成 JavaScript，因此不需要外部化配置。让你的重构工具满意；去买杜松子酒。

要回答您的其他问题，您将找不到许多适用于 GWT 的 SE 框架。首先，它不支持反射或字节码操作（一切都是 JavaScript），这立即排除了许多框架。另一方面，Log4j 没有意义，因为在客户端没有可访问的文件系统，但是有可用的[库](http://code.google.com/p/gwt-log/)以不同的方式做事。

上面提到的用于 GWT 的 Spring 库基本上是对 Spring for GWT 的重写。他们不与 Spring 共享任何代码仅仅是因为他们不能。这些框架通过生成代码（“工厂”）来连接您的组件，就像您手动执行 DI 一样。

这也是 GIN 的工作方式，它为您的类生成 Java 工厂，然后 GWT 将其编译成优化的 JavaScript（意味着很少的性能开销）。GIN 确实在幕后使用 Guice，在编译时验证配置并检查模块。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T11:22:30.143

不，你不能那样做。DI 逻辑在运行时应用在服务器端，而 GWT 代码完全在客户端。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-08-03T05:59:24.420

我认为只创建一个调用 GWT RemoteServlet 的 doPost 方法的 Spring 控制器会更简单。[此处](http://kiranpratap-techmusings.blogspot.com/2009/01/thoughts-on-gwt-spring.html)提供了一个示例。我知道这有点绕。但这可以保护您免受对 GWT 实现的更改（如果有的话）。希望它有所帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T23:00:36.810

我想知道 GWT 是否支持 Guice（Google DI 框架）？

这可能是一个替代方案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-07-22T04:22:14.257

您可以在服务器端实现一个 Servlet 服务，该服务从 Spring ApplicationContext 检索对象，呈现为 JSON 对象（我使用[http://json-lib.sourceforge.net/apidocs/net/sf/json/JSONSerializer.html](http://json-lib.sourceforge.net/apidocs/net/sf/json/JSONSerializer.html) ) 举例。然后你可以有一个单例外观服务，它从 GWT 客户端向我们的 Servlet 服务发出请求。

通过这种方式，您可以在 GWT 客户端中获得运行时依赖注入。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-26T21:20:38.427

[Spring ME](http://springframework.me/)能够在这里为您提供帮助。尽管我部分同意前面的一些回应，但在您的客户端和服务器代码中拥有相同的编程（和管道）范例是很好的。

# uibutton - 按钮事件

> ID：896431
> 
> 赞同：-2
> 
> 时间：2009-05-22T05:05:02.370
> 
> 标签：uibutton

`// starting my code`

 ````
int col=10;

UIButton*mbybutton = [UIButton buttonWithType:UIButtonTypeCustom];
[mbybutton setTitle:@"Click Here"  forState:UIControlStateNormal];

//-------------------    
[self performSelector:@selector(fullscreen:) 
  withObject:[NSNumber numberWithInt:col]
       afterDelay:0.2];
//----------------------------

-(void) displayvalue:(id)iid{

    int c=[iid intValue];

    printf("\n\n ======= %d========",c);
}
// end of code 
````  `在这段代码中，我的问题是这些代码将 afterDelay:0.2 替换为 forControlEvents:UIControlEventTouchUpInside （在 mybutton 的偶数上），并在 touchupinside 时在 displayvalue 方法中获取 col 的值，请纠正这些错误..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-05T11:55:35.500

你想去你的头文件，首先声明一个IBAction。然后在 IB 中，将按钮绑定到该 IBAction。

然后，在您的 .m 文件中，您执行此操作

```
- (IBAction)yourActionName:(id)sender {

     [okbutton disabled:TRUE];

} 
```

# wcf - 使用 ISAPI 过滤器来跟踪和计时 WCF 调用？

> ID：896434
> 
> 赞同：1
> 
> 时间：2009-05-22T05:05:31.543
> 
> 标签：wcf, iis, trace, isapi

我正在使用 WCF 构建一个 Web 应用程序，该应用程序将被其他应用程序作为服务使用。我们的应用程序将安装在 Web 服务场上，并出于可扩展性目的进行负载平衡。有时我们会遇到特定于一台 Web 服务器的问题，我们希望能够从响应中确定请求由哪个 Web 服务器处理，以及可能的时间信息。例如，此请求由 WebServer01 处理，请求需要 200 毫秒才能完成。

想到的第一个解决方案是构建一个 ISAPI 过滤器来添加一个 HTTP 标头，该标头将这些信息存储在响应中。这让我觉得以前一定有人做过这种事情。有没有更好的方法来做到这一点，或者我可以使用现成的 ISAPI 过滤器？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T05:18:16.060

WCF 提供了比 ISAPI 过滤器更好的扩展点。例如，您可以创建一个客户端消息检查器，该检查器在消息发送到服务器之前被调用，然后在响应返回时也被调用，因此您可以相当容易地测量来自客户端的服务调用所需的时间看法。

查看`IClientMessageInspector`界面 - 这可能是您正在寻找的。另请参阅有关如何使用此界面的出色[博客条目。](http://weblogs.asp.net/paolopia/archive/2007/08/23/writing-a-wcf-message-inspector.aspx)

马克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T05:22:28.850

我没有现成的解决方案给你，但我可以将你指向[IHttpModule](http://msdn.microsoft.com/en-us/library/zec9k340%28VS.85%29.aspx)。例如，请参阅[Instrument and Monitor Your ASP.NET Apps Using WMI and MOM 2005](http://msdn.microsoft.com/en-us/magazine/cc188704.aspx)中的代码。

```
 private DateTime startTime;

    private void context_BeginRequest(object sender, EventArgs e)
    {
        startTime = DateTime.Now;
    }

    private void context_EndRequest(object sender, EventArgs e)
    {
        // Increment corresponding counter
        string ipAddress = HttpContext.Current.Request.
            ServerVariables["REMOTE_ADDR"];
        if (HttpContext.Current.Request.IsAuthenticated)
            authenticatedUsers.Add(ipAddress);
        else
            anonymousUsers.Add(ipAddress);
        // Fire excessively long request event if necessary
        int duration = (int) DateTime.Now.Subtract(
            startTime).TotalMilliseconds;
        if (duration > excessivelyLongRequestThreshold)
        {
            string requestPath=HttpContext.Current.Request.Path;
            new AspNetExcessivelyLongRequestEvent(applicationName,
                duration,requestPath).Fire();
        }
    } 
```

# java - 如何确保只创建具有特定状态的表行？

> ID：896437
> 
> 赞同：1
> 
> 时间：2009-05-22T05:06:43.053
> 
> 标签：java, mysql, multithreading, concurrency, transactions

我有一个看起来像这样的域对象：

```
class UserStuff 
{
    String userid;
    boolean primordial;
} 
```

在表中，*primordial*是*TINYINT*。一个**User**可能有很多**UserStuff**。我要确保只有一行（创建的第一行）将具有原始 == 1。所有后续行将具有原始 == 0。乍一看，没有什么可担心的。假设**UserStuff**的多个创建请求可能同时发生，我如何保证这个约束？

我最初的想法是在字符串上同步（在域服务中）

```
class DomainService
{
    public void create( UserStuff stuff )
    {
        synchronized( stuff.userid + "/userstuff/lock" )
        {
            ...

        }
    }
} 
```

我很想听听有关此方法和替代方法的评论。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T05:17:29.117

一般来说，SQL 方法是创建`(userid, primordial)`一个唯一的复合键，并使用`INSERT`带有`ON DUPLICATE KEY UPDATE`-- 子句的语句，否则会设置`primordial`（但我承认我不确定如果`UPDATE`也命中重复项会发生什么，因为它当你插入*第二个*non-primordial时会这样`UserStuff`）。

或者，使用适当隔离的事务，您可以首先`SELECT`检查它`userid`是否已经存在，然后在`INSERT`具有适当值的同一事务中`primordial`。

如果您曾经有来自多个进程的更新（可能在不同的客户端节点上），SQL 方法会更加可靠，但如果您 100% 确定这永远不会发生，您基于 Java 同步的想法可能会获得更好的性能......我不会猜测一种或另一种方式，但建议您以两种方式衡量事物（*如果*您愿意打赌永远**不会**从多个客户端节点获取更新，那就是;-)。

`

# unix - dcop可以做哪些有趣的事情？

> ID：896438
> 
> 赞同：1
> 
> 时间：2009-05-22T05:06:46.113
> 
> 标签：unix, dcop

我已经使用 UNIX 多年了，最近才注意到 dcop 命令。它的主要目的是什么？在任何过程中使用它是设计不佳的标志吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T05:38:11.223

我怀疑它的存在主要是因为 UNIX 中的所有内容都*应该*可以从命令行访问。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T06:42:55.930

维基[百科](http://en.wikipedia.org/wiki/DCOP)关于 dcop 的文章值得一读。
它非常适合用于控制进程的任何脚本，还有关于通过 dcop[控制 Amarok的好信息。](http://docs.kde.org/kde3/en/extragear-multimedia/amarok/the-dcop-interface.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T06:58:15.577

> 在任何过程中使用它是设计不佳的标志吗？

可能不会，只要您使用 DCOP 执行一些通常通过鼠标单击或热键完成的任务。这肯定比试图控制鼠标来做你想做的程序更好的设计！

但是，如果您使用 DCOP 来做一些非常简单的事情，可以通过 shell 命令或几行 C 代码直接完成，而根本不调用 KDE 应用程序，那么直接执行可能会更好。（例如，不要使用 DCOP 告诉 Konqueror 删除目录树，只需运行`rm -rf`）

# regex - RegExp：货币格式

> ID：896439
> 
> 赞同：1
> 
> 时间：2009-05-22T05:07:57.437
> 
> 标签：regex

我需要格式化数字，以便数千人不被任何东西分隔，数百人用点分隔。例如

1234.56 12.34 123

我写了以下 ReqExp

```
amountValue.replace(/^(\d+)[,.](\d{3})[.,](\d{2})$/,'$1' + '$2' +'.'+'$3').replace(/^(\d+),(\d{2})$/,'$1' +'.'+'$2'); 
```

如果有办法让它更短？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T08:50:38.827

我*认为*这可能有效：

```
amountValue.replace(/^(\d*)[,.]?(\d{0,3})[.,](\d{2})$/,'$1' + '$2' +'.'+'$3'); 
```

针对您的数据进行尝试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T09:02:14.950

我会删除任何不是小数点的非数字字符：

```
amountValue.replace(/[^0-9](?!\d{2}$)/, '').replace(/,(?=\d{2}$)/, '.'); 
```

# actionscript-3 - 检查动作脚本中是否存在项目

> ID：896448
> 
> 赞同：2
> 
> 时间：2009-05-22T05:10:36.157
> 
> 标签：actionscript-3

抱歉，我以前从未做过 AS，所以我为这个基本问题道歉。我正在尝试修改此文件中的一行：

var media:Namespace = rssXML.channel.item[i].namespace("media");

我只是想检查它是否存在以及它是否有价值？

我知道在 PHP 中它会是

if(isset(rssXML.channel.item[i].namespace("media") && !empty(rssXML.channel.item[i].namespace("media")) {

//做一点事

}

什么是 AS 等价物？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T06:00:48.733

```
if (variablename) { // it's there } else { // it's not } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T07:57:57.810

所有 AS 类都扩展了 Object ，它有一个`hasOwnProperty`() 测试，如果具有名称的属性存在，则返回一个布尔值。然后您可以测试 if (property) 或 if (property == null)。

[http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/Object.html#hasOwnProperty()](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/Object.html#hasOwnProperty())

# javascript - 在 Javascript 中使用长字符串文字的最佳方法是什么？

> ID：896449
> 
> 赞同：9
> 
> 时间：2009-05-22T05:10:37.453
> 
> 标签：javascript, ruby-on-rails, ruby, heredoc

> **可能重复：**
> [Javascript 中的多行字符串](https://stackoverflow.com/questions/805107/multiline-strings-in-javascript)

在 Ruby 中，您可以执行以下操作：

```
temp = <<-SQLCODE
  select * from users
SQLCODE 
```

这样，您的代码中就有很长的字符串文字，而不必转义很多字符。JavaScript中有类似的东西吗？

目前我有这样的 JavaScript 代码，它让我发疯......

```
 new Element.update(lightbox_id, " \
    <div id='overlay' class='overlay' > \
    </div> \
    <div id='lightbox' class='lightbox'> \
      <div class='lightbox_title'> \
        <div class='corner_image' onclick=\"close_lightbox();return false;\"><a href='#'>" + corner_image + "</a></div> \
        <div class='lightboxname' id='lightboxname'>" + title + "</div> \
        <div class='close_image'> \
          <a href='#' onclick=\"close_lightbox();return false;\">Close</a> or Escape key\
        </div> \
      </div> \
      <div id='" + lightbox_content_id + "' class='lightbox_content'>    \
      </div> \
      <script>  \
        watch_for_escape(); \
      </script> \
    </div> \
"); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-22T05:15:56.513

您所指的语法通常称为[here-document（或 HEREDOC）](http://en.wikipedia.org/wiki/Heredoc)，不，它在 Javascript 中不可用。

像您一直在做的那样添加反斜杠是在 JavaScript 中跨越多行字符串的适当方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T05:18:06.183

像这样使用 html 内联是不好的做法，但如果你真的想更干净地处理它，试试这个：

用你想要的 html 在你的页面上放置一个隐藏的 div，然后用 {title} 之类的东西替换自定义参数。调用更新时，传递 yourdiv.innerHTML.replace(...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T09:35:24.260

如果您使用的是 Rails，那么使用 rjs 用一些多行 HTML 更新 div 会变得更加简洁：

```
page.replace__html 'lightbox_id', :partial => 'overlay' 
```

然后`overlay.html.erb`将包含上面的原始 html 而不会转义。

额外的好处是片段“覆盖”也可以在初始页面加载中使用，这在很多情况下是您想要的。

# php - PHP & SQL Server - 字段名称被截断

> ID：896454
> 
> 赞同：1
> 
> 时间：2009-05-22T05:13:11.023
> 
> 标签：php, sql-server-2005

我发现来自我的 SQL Server 的结果被截断了字段名称：

```
$query = "SELECT some_really_really_long_field_name FROM ..."
...
print_r($row);

array(
    'some_really_really_long_field_n' => 'value'
) 
```

有谁知道如何避免这种行为？

我认为数据库驱动程序是 ADODB。

所以您不必计算：字段名称被截断为 31 个字符。

SQL Server 本身似乎并不介意长字段名称，因此我只能假设 ADODB 驱动程序中某处不能包含长名称的 char[32] 字符串缓冲区。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T05:21:52.390

您可能正在使用十年前已弃用的捆绑 MSSQL 客户端。使用[Microsoft 提供的用于 PHP 的新 MSSQL 驱动程序，](http://www.microsoft.com/sqlserver/2005/en/us/PHP-Driver.aspx)或从您的 MSSQL 服务器 CD 安装 MSSQL 客户端工具。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T05:55:31.767

您可以为长字段名称使用别名，如下所示：

```
$query = "SELECT some_really_really_long_field_name AS short_alias FROM ..." 
```

这将适用于您当前的问题。但我建议使用[PDO](http://ir.php.net/manual/en/book.pdo.php) MSSQL 驱动程序连接到数据库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T05:15:52.787

避免截断字段名称的最简单方法是使用较短的字段名称....

抱歉，这听起来像是一个糟糕的答案，但它更干净，更容易阅读和维护，而且只是更好的练习。

# iphone - 如何在 XCode 中构建一个框架类？

> ID：896458
> 
> 赞同：5
> 
> 时间：2009-05-22T05:15:25.000
> 
> 标签：iphone, xcode, frameworks

我想针对 xcode 中使用的一些常见方面构建一个框架，例如 UIKit、Foundation 等。我们是否可以创建自己的框架，以后可以重用？如果是这样，你能告诉我们如何一步一步地做吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-05-26T23:10:52.777

这现在是可能的，请参阅：

[https://github.com/kstenerud/iOS-Universal-Framework](https://github.com/kstenerud/iOS-Universal-Framework)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-22T05:21:36.867

目前无法使用 iPhone SDK 创建框架。最接近的方法是将要共享的逻辑捆绑到静态库中。

这是一篇关于如何为 iPhone SDK 做这件事的好文章：

[http://blog.stormyprods.com/2008/11/using-static-libraries-with-iphone-sdk.html](http://blog.stormyprods.com/2008/11/using-static-libraries-with-iphone-sdk.html)

# dll - POCO、DTO、DLL 和贫血域模型

> ID：896473
> 
> 赞同：22
> 
> 时间：2009-05-22T05:22:18.660
> 
> 标签：dll, poco, data-access-layer, dto, bll

我正在查看[POCO 和 DTO 之间的区别](https://stackoverflow.com/questions/725348/poco-vs-dto)（看起来 POCO 是具有行为（方法？）的 dto），并遇到了 Martin Fowler 关于贫血域模型的[这篇文章](http://www.martinfowler.com/bliki/AnemicDomainModel.html)。

由于缺乏理解，我想我已经创建了这些贫血的领域模型之一。

在我的一个应用程序中，我在“dto”dll 中定义了我的业务域实体。它们有很多与 getter 和 setter 相关的属性，其他的不多。我的业务逻辑代码（填充、计算）在另一个“bll”dll 中，而我的数据访问代码在一个“dal”dll 中。“最佳实践”我想。

所以通常我会像这样创建一个 dto：

```
dto.BusinessObject bo = new dto.BusinessObject(...) 
```

并将其传递给 bll 层，如下所示：

```
bll.BusinessObject.Populate(bo); 
```

反过来，它执行一些逻辑并将其传递给 dal 层，如下所示：

```
dal.BusinessObject.Populate(bo); 
```

据我了解，要使我的 dto 成为 POCO，我需要使业务逻辑和行为（方法）成为对象的一部分。因此，而不是上面的代码，它更像是：

```
poco.BusinessObject bo = new poco.BusinessObject(...)
bo.Populate(); 
```

IE。我在对象上调用方法，而不是将对象传递给方法。

我的问题是 - 我怎样才能做到这一点，并且仍然保留关注点的“最佳实践”分层（单独的 dll 等......）。在对象上调用方法不就意味着必须在对象中定义方法吗？

请帮助我的困惑。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-05-26T17:44:14.350

通常，您不想在域对象中引入持久性，因为它不是该业务模型的一部分（飞机不会自行构建，它会将乘客/货物从一个位置运送到另一个位置）。您应该使用[存储库模式](http://www.martinfowler.com/eaaCatalog/repository.html)、[ORM 框架或其他一些数据访问模式来管理对象](http://en.wikipedia.org/wiki/Object-relational_mapping)*状态*的持久存储和检索。

当你在做这样的事情时，贫血的领域模型就会发挥作用：

```
IAirplaneService service = ...;
Airplane plane = ...;
service.FlyAirplaneToAirport(plane, "IAD"); 
```

在这种情况下，飞机状态的管理（是否正在飞行、在哪里、起飞时间/机场是什么、到达时间/机场是什么、飞行计划是什么等）被委派给飞机外部的东西。 . AirplaneService 实例。

POCO 的实现方式是这样设计你的界面：

```
Airplane plane = ...;
plane.FlyToAirport("IAD"); 
```

这更容易被发现，因为开发人员知道在哪里可以让飞机飞行（只需告诉飞机去做）。它还允许您确保*仅*在内部管理状态。然后，您可以将当前位置等内容设为只读，并确保仅在一处更改。对于贫血的域对象，由于状态是在外部设置的，随着域规模的增加，发现状态更改的位置变得越来越困难。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-12-02T11:24:50.030

我认为澄清这一点的最好方法是根据定义：

**DTO：数据传输对象：**

它们通常仅用于表示层和服务层之间的数据传输。不多也不少。通常它被实现为带有gets和sets的类。

```
public class ClientDTO
{
    public long Id {get;set;}
    public string Name {get;set;}
} 
```

**BO：业务对象：**

业务对象代表业务元素，自然最佳实践表明它们也应该包含业务逻辑。正如 Michael Meadows 所说，将数据访问与这些对象隔离开来也是一种很好的做法。

```
public class Client
{
    private long _id;
    public long Id 
    { 
        get { return _id; }
        protected set { _id = value; } 
    }
    protected Client() { }
    public Client(string name)
    {
        this.Name = name;    
    }
    private string _name;
    public string Name
    {
        get { return _name; }
        set 
        {   // Notice that there is business logic inside (name existence checking)
            // Persistence is isolated through the IClientDAO interface and a factory
            IClientDAO clientDAO = DAOFactory.Instance.Get<IClientDAO>();
            if (clientDAO.ExistsClientByName(value))
            {
                throw new ApplicationException("Another client with same name exists.");
            }
            _name = value;
        }
    }
    public void CheckIfCanBeRemoved()
    {
        // Check if there are sales associated to client
        if ( DAOFactory.Instance.GetDAO<ISaleDAO>().ExistsSalesFor(this) )
        {
            string msg = "Client can not be removed, there are sales associated to him/her.";
            throw new ApplicationException(msg);
        }
    }
} 
```

**服务或应用程序类** 这些类代表用户和系统之间的交互，它们将同时使用 ClientDTO 和 Client。

```
public class ClientRegistration
{
    public void Insert(ClientDTO dto)
    {
        Client client = new Client(dto.Id,dto.Name); /// <-- Business logic inside the constructor
        DAOFactory.Instance.Save(client);        
    }
    public void Modify(ClientDTO dto)
    {
        Client client = DAOFactory.Instance.Get<Client>(dto.Id);
        client.Name = dto.Name;  // <--- Business logic inside the Name property
        DAOFactory.Instance.Save(client);
    }
    public void Remove(ClientDTO dto)
    {
        Client client = DAOFactory.Instance.Get<Client>(dto.Id);
        client.CheckIfCanBeRemoved() // <--- Business logic here
        DAOFactory.Instance.Remove(client);
    }
    public ClientDTO Retrieve(string name)
    {
        Client client = DAOFactory.Instance.Get<IClientDAO>().FindByName(name);
        if (client == null) { throw new ApplicationException("Client not found."); }
        ClientDTO dto = new ClientDTO()
        {
            Id = client.Id,
            Name = client.Name
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-22T05:54:39.070

就我个人而言，我不觉得那些贫血的领域模型那么糟糕。我真的很喜欢让域对象只代表数据而不是行为的想法。我认为这种方法的主要缺点是代码的可发现性。您需要知道可以使用哪些操作。解决这个问题并仍然保持行为代码与模型分离的一种方法是为行为引入接口：

```
interface ISomeDomainObjectBehaviour
{
    SomeDomainObject Get(int Id);
    void Save(SomeDomainObject data);
    void Delete(int Id);
}

class SomeDomainObjectSqlBehaviour : ISomeDomainObjectBehaviour
{
    SomeDomainObject ISomeDomainObjectBehaviour.Get(int Id)
    {
        // code to get object from database
    }

    void ISomeDomainObjectBehaviour.Save(SomeDomainObject data)
    {
        // code to store object in database
    }

    void ISomeDomainObjectBehaviour.Delete(int Id)
    {
        // code to remove object from database
    }
}
class SomeDomainObject
{
    private ISomeDomainObjectBehaviour _behaviour = null;
    public SomeDomainObject(ISomeDomainObjectBehaviour behaviour)
    {

    }

    public int Id { get; set; }
    public string Name { get; set; }
    public int Size { get; set; }

    public void Save()
    {
        if (_behaviour != null)
        {
            _behaviour.Save(this);
        }
    }

    // add methods for getting, deleting, ...

} 
```

这样，您可以将行为实现与模型分开。使用注入模型的接口实现也使代码相当容易测试，因为您可以轻松地模拟行为。

# vb6 - 在 VB6.0 中禁用 MSHFlexGrid 中的列

> ID：896476
> 
> 赞同：0
> 
> 时间：2009-05-22T05:25:38.923
> 
> 标签：vb6, activex

如何`MSHFlexgrid`在 VB6.0 中禁用特定列？我不希望我的用户编辑特定列中的值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T08:27:52.587

我不认为 MSHFlexGrid 控件首先允许用户编辑其数据。因此，实际上，所有列都被禁用。任务完成 ：）

实际上，您必须添加自定义代码以启用更新，例如添加允许编辑的适当控件（文本框、组合、日期选择器等），*在*设计时将其隐藏，然后在运行时检测哪个网格单元应具有焦点，移动控件并调整其大小以适合单元格，然后使其可见，然后处理事件以验证输入，然后将内容写回记录集...

...或者您可以购买开箱即用的第三方控件。VB6 附带的 MSHFlexGrid 本质上是[VSFlexGrid Pro的精简版](http://www.componentsource.com/products/componentone-vsflexgrid-pro/index.html)，我用过，觉得还不错。它通过创建组（而不是带）来处理分层数据的不同方式，这是 IMO 的优势。关于 MSHFlexGrid 可以说的最好的一点是，它很容易绑定到分层 ADO 记录集以简单地显示结果，但如果您想进行良好的格式化或使网格可编辑，那就不好了。VSFlexGrid Pro，如果你能负担得起的话，它有更多的功能，例如你可以创建数据源类来处理自定义数据结构的绑定（附带 VB6 示例，包括 ADO 记录集绑定），如果你打算让你的分层网格可编辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-16T04:41:13.117

'这里有一条捷径......不是正确的方式。但是你可以试试

'如果您需要锁定前 3 列，请使用以下代码：

```
msf2=name of MSFlexGrid
Private Sub msF2_EnterCell()
With msF2
    If msF2.Col = 0 Or msF2.Col = 1 Or msF2.Col = 2 Then
        msF2.Col = 3
    End If
End With
End Sub 
```

# ruby-on-rails - 导轨设计/编码

> ID：896477
> 
> 赞同：2
> 
> 时间：2009-05-22T05:27:03.400
> 
> 标签：ruby-on-rails

我们有一个提供典型社交内容（博客/论坛/流等）的网络应用程序。

所有内容都可选地标有城市。即，如果一篇博客文章是针对纽约的，它会被标记为这样。

如果用户设置了城市视图首选项，则任务是仅显示城市特定信息（整个站点）并向所有其他人显示所有内容。

所以如果city_specifc_view，我必须添加'and city == current_city'？对于我所有模型类中的所有发现者，这是维护的噩梦（特别是因为这种逻辑存在改变的风险）。

我想知道应用这个逻辑的正确方法是什么。我可以在一个中心位置（比如覆盖默认查找）而不是 if/else 整个模型。猴子修补 ActiveRecord 是一种选择吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T05:40:38.677

在 ActiveRecord::Base 中有一个称为范围的功能。在某个范围内发出的查询将与该范围的查找选项组合，即：

```
 class Person < ActiveRecord::Base
    default_scope :order => 'last_name, first_name'
  end 
```

也许这是您想要研究的功能？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T07:32:39.093

不知道修改 AR.find 是否是您的最佳选择，但它对我有用：

```
class Content < AR::base
  def self.find(*args)
    if logged_user.preferred_city
      choose_city(super(*args))
    else
      super(*args)
    end
  end
protected #to be inherited by content subtypes (post, pic, stream...)
  def self.choose_city(target) 
    case target
      when Array target.select{|t| choose_city(t)}
      when Person (target.city == logged_user.preferred_city ? target : nil)
      else target
    end
  end
end 
```

希望这可以帮助你

# ruby - 在Ruby中有没有相关的语法应用：class << self ... end

> ID：896480
> 
> 赞同：11
> 
> 时间：2009-05-22T05:30:01.870
> 
> 标签：ruby, class-variables, class-method, instance-methods, class-instance-variables

```
class << self
attr_accessor :n, :totalX, :totalY
end 
```

上面的语法用于定义类实例变量。但是当我考虑语法意味着什么时，它对我来说没有任何意义，所以我想知道这种语法是否用于任何其他类型的定义。我在这里的困惑点是：

```
class << self 
```

附加运算符通常意味着“将右侧的内容添加到左侧的对象”。但是在这个块的上下文中，这怎么加起来就是“把这个块的内容放入类实例而不是实例的定义中”？

出于同样的原因，我很困惑为什么在一个上下文中 class << self 可以定义类实例变量，而在另一个上下文中它似乎创建了类变量，例如：

```
class Point
  # Instance methods go here
  class << self
    # Class methods go here
  end
end 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-22T10:19:05.840

在 Ruby 中，您可以重新打开现有的类并添加方法。也就是说，你可以说：

```
class Foo
  def bob
    return "hello from bob"
  end
end 
```

这些方法存储在 -class 的内部字典（可能是实例变量）的某个位置`Foo`（这只是 -class 的一个实例，`Class`因此*具有*实例变量）

但令人惊讶的是，您还可以向现有对象的*实例添加方法*

```
foo = Foo.new
foo2 = Foo.new

def foo.fred
  return "I am fred"
end

foo.fred  #=> "I am fred"
foo2.fred #=> NoMethodError 
```

但是**这种方法实际存储在哪里**？

原来 Ruby 在幕后创建了一个新类（有时称为*单例类*、*元类*或*特征*类），它被插入到-class 及其实例*之间*的继承层次结构中。`Foo`

所以继承关系是这样的：

```
foo < (eigenclass of foo) < Foo < Class 
```

（如果你说 foo.superclass 你不会看到单例类）

`class << X`-syntax 是一种进入这个特殊类的方法，这样你就可以直接操作它。以下代码块完全相同：

```
def foo.bar
  return "xy"
end

# is exactly the same as

class << foo
  def bar
    return "xy"
  end
end 
```

所以 和 之间的相似性`class Foo < Bar`并不是`class << Foo`偶然的，两者都有继承。

认为`class << X`是“打开 X 的元类”

在 Ruby 中要记住的是，类本身就是对象。（类的实例`Class`）所以如果你说：

```
class Foo
  class << self
    def k
      return "x"
    end
  end
end 
```

（在此代码块`self`中绑定到）也是的 eigenclass 的*实例方法*，这使其成为 的类方法`Foo``k`*`Foo``Foo`*

 *[所有这一切都在关于 Pickaxe 类的章节](http://www.ruby-doc.org/docs/ProgrammingRuby/html/classes.html)中更清楚地解释（不幸的是，Web 版本不包含图表）和 _whys [Seeing Metaclasses Clearly](http://ruby-metaprogramming.heroku.com/html/seeingMetaclassesClearly.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T05:35:02.927

将类视为包含成员字典，包括所有访问器和实例变量。当您告诉班级“附加”到“自身”时，您是在说“将这些添加到班级成员的字典中”。

不过，我承认这个符号有点古怪。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T06:33:44.650

从“附加”运算符的角度来考虑它实际上是令人困惑的。一个更好的看待它的方法是，就像`class Foo`打开类 Foo 一样，也就是说，它将 'self' 设置为类对象 Foo，并在必要时创建它，因此`class << self`打开当前 'self' 对象的 eigenclass。请注意，它不限于 self - 对于任何对象 bar，您可以说 class << bar 来打开该对象的 eigenclass。

```
class A
  def hello
    print "hello world"
  end
end

a = A.new
b = A.new

class << a
  def goodbye
    print "goodbye cruel world"
  end
end

a.hello
b.hello
a.goodbye
b.goodbye 
```

# php - MySQL中的数组

> ID：896485
> 
> 赞同：4
> 
> 时间：2009-05-22T05:32:56.077
> 
> 标签：php, mysql

我想在记录中存储一个数组。

表格1：

```
ID, Name, Friends (friends 应该是一个数组)
1，比尔，2&3
2，查尔斯，1&3
3、克莱尔、1

```

我希望能够进行这样的搜索：

```
SELECT * FROM Table1 WHERE Friends='3'

```

找到所有将 Clare 列为好友的人

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-22T05:38:29.817

除非您有充分的理由这样做，否则您应该保持数据规范化并将关系存储在不同的表中。我想也许你正在寻找的是这个：

```
CREATE TABLE people (
    id int not null auto_increment,
    name varchar(250) not null,
    primary key(id)
);

CREATE TABLE friendships (
    id int not null auto_increment,
    user_id int not null,
    friend_id int not null,
    primary key(id)
);

INSERT INTO people (name) VALUES ('Bill'),('Charles'),('Clare');

INSERT INTO friendships (user_id, friend_id) VALUES (1,3), (2,3);

SELECT *
  FROM people p
    INNER JOIN friendships f
      ON f.user_id = p.id
  WHERE f.friend_id = 3; 
```

> ```
> +----+---------+----+---------+------------+
> | 编号 | 姓名 | 编号 | 用户 ID | 朋友ID |
> +----+---------+----+---------+------------+
> | 1 | 比尔 | 1 | 1 | 3 |
> | 2 | 查尔斯 | 2 | 2 | 3 |
> +----+---------+----+---------+------------+
> 2 行（0.00 秒）
> 
> ```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T05:37:46.497

您可能需要一个逗号分隔值，但不建议这样做。为什么不使用另一个表格来显示关系？

```
Table2
----------------------
PARENT_ID | FRIEND_ID
----------------------
1         | 2
1         | 3
2         | 1
2         | 3
---------------------- 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T05:39:06.837

这看起来像是一个关系表的完美位置：表 1：

```
ID, Name
1,  Bill
2,  Charles
3, Clare 
```

表2（关系表）

```
ID, FriendID
1,  2
1,  3
2,  1
2,  3
3,  1 
```

第二个表通过连接来自 Table1 的 ID 来跟踪朋友关系。

# iphone - 有没有办法使用 xcode/iphone sim 模拟多个 iphone？

> ID：896487
> 
> 赞同：42
> 
> 时间：2009-05-22T05:36:19.587
> 
> 标签：iphone, xcode, simulator

我正在计划一个需要多个用户的游戏，我想知道是否有办法启动 iPhone Simulator 的多个实例。我没有在菜单或 Google 搜索结果中看到任何内容，但我只是想确保我没有遗漏任何内容。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2010-09-15T11:09:55.137

这是可能的，但仅限于多个用户。

阅读： http: [//www.coderebel.com/2010/08/31/iphone_simulator](http://www.coderebel.com/2010/08/31/iphone_simulator)

假设您有两个要同时调试的项目（P1、P2），请执行以下操作。

设置步骤：

1.  在 Mac 上创建新用户 (U2)
2.  授予它对 P2 的 R/W 访问权限，尤其是对其构建文件夹的访问权限。
3.  从上面的站点下载启动器应用程序并将其复制到应用程序。

调试步骤：

1.  如果正在运行，请关闭 Xcode 和模拟器
2.  使用 U1 启动 iPhone Launcher.app。
3.  用U1启动Xcode，加载P1，开始调试。
4.  使用 U2 启动 iPhone Launcher.app。
5.  用U2启动Xcode，加载P2，开始调试。

不幸的是，PITA 不得不时不时地更换用户，但到目前为止我还没有找到更好的解决方案。希望这可以帮助。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2015-06-02T22:00:02.853

有一种方法可以轻松地做到这一点，而无需使用多个用户。请记住，您不会连接到调试器。请记住，下面的解释是针对**XCode 6+**的。您可以跳过此说明，只需向下滚动到下面的总结部分。

[从这里](https://stackoverflow.com/questions/26031601/xcode-6-launch-simulator-from-command-line/26053018#26053018)的答案中，我们可以看到您可以从命令行启动任何模拟器：

> open -a "iOS 模拟器" --args -CurrentDeviceUDID

`xcrun simctl list`您可以通过在控制台上运行命令来找到 deviceID（以及所有模拟器） 。它将生成一个这样的列表。设备 ID 是大括号中的代码：

```
== Runtimes ==
iOS 8.3 (8.3 - 12F69) (com.apple.CoreSimulator.SimRuntime.iOS-8-3)
== Devices ==
-- iOS 8.3 --
    iPhone 4s (99Z06AC6-A2D6-46E7-B4F7-BA4F5F3F39C8) (Shutdown)
    iPhone 5 (K262AF11-ADD2-4FDA-ACBA-8C80DD9D4AA1) (Shutdown)
    iPhone 5s (337KDC51-0A4B-47DB-8966-83562FD92C93) (Shutdown)
    iPhone 6 Plus (9GK714E2-F713-4F98-A96E-C72ACD6571A8) (Shutdown)
-- iOS 8.2 --
    etc continued.... 
```

因此，要使用上面的示例运行模拟器，请在控制台上运行以下命令：

```
open -n /Applications/Xcode.app/Contents/Developer/Applications/iOS\ Simulator.app/ --args -CurrentDeviceUDID '99Z06AC6-A2D6-46E7-B4F7-BA4F5F3F39C8' 
```

我们使用`-n`标志代替，因为`-a`标志指定用于打开文件的应用程序，而`-n`标志打开应用程序的新实例，即使一个已经在运行。使用`man open`命令了解所有这些内容。

还要确保您的模拟器具有正确的路径。

还有一点需要注意，如果你像这样运行模拟器，你的模拟器很可能是有限的。而且由于它的限制，您可能希望在不中断屏幕上已经存在的情况下启动它。[我们可以从这里](https://stackoverflow.com/questions/1567798/iphone-simulator-location/25758954#25758954)的答案中解决这个问题，他向您展示如何`create a new simulator and delete one.`

## **所以总结一下，这就是你要启动它们的方法。**

A）首先创建一个模拟器，然后再启动它。

用法：simctl create "name" "device type id" "runtime id"

```
xcrun simctl create "mynewsimulator" "iPhone 6" "com.apple.CoreSimulator.SimRuntime.iOS-8-3" 
```

您将从`xcrun simctl list`我上面运行的命令命令中找到运行时 ID。运行上述命令后，设备 ID 将打印在控制台屏幕上。请注意它，因为您需要将其作为启动模拟器的最后一个参数，如下所示。假设这个 ID 是`99Z06AC6-A2D6-46E7-B4F7-BA4F5F3F39C8`

B）启动它

```
open -n /Applications/Xcode.app/Contents/Developer/Applications/Simulator.app/ --args -CurrentDeviceUDID '99Z06AC6-A2D6-46E7-B4F7-BA4F5F3F39C8' 
```

C）一旦你用完你的模拟器就删除它

```
xcrun simctl delete 99Z06AC6-A2D6-46E7-B4F7-BA4F5F3F39C8 
```

所有这些都可以放在一个 .sh 文件中以便于运行。如果您决定将所有这些都放入 sh 文件中，请注意在每个命令之后放置`wait`或命令。`sleep`

**[EDIT 2017]** 我看到 XCode 9 现在将支持多个模拟器。等待看看这一切将如何运作。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-22T14:50:54.543

据我所知，您不仅不能运行多个模拟器实例，而且当需要进行实际设备测试时，您也不能运行多个调试器实例。

这意味着要执行多设备应用程序，您需要将一台 Mac 分配给每个运行您的应用程序的单个 iPhone/触摸设备（或模拟器实例）。

我已经开始研究是否可以以某种方式将 VMWare 或 Parallels 引入其中，但是如果不破解操作系统，就没有什么可以做的了。

[我建议向http://bugreporter.apple.com](http://bugreporter.apple.com)提交功能请求。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-03T04:29:21.440

如果您拥有 Mac OS X 服务器许可证，另一个选择（尽管可能有点过分）是虚拟化 Mac OS X 服务器实例，并在 VM 中运行第二个模拟器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T05:42:52.980

嗯...我认为您在这里没有遗漏任何东西。据我所知，SDK 中没有能够模拟多个设备的技术——尽管这将是一个有用的功能。我认为您唯一的选择是获得第二台 iPhone OS 设备，或者找一个也拥有 iPhone OS 设备的朋友让您使用它进行测试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-10-22T13:11:11.510

请按照以下步骤测试您的应用。

您必须首先为整个过程做一件事：转到项目 - > 编辑项目设置 - > 勾选选项 - 并行构建独立目标。

1.  调试将在模拟器中创建您的应用程序的代码 例如，您的应用程序名称是 - 实例
2.  关闭模拟器
3.  转到 Project->New Target -> Instance2 在 Instance2.info.plist 文件中添加“Bundle display name：Instance2”设置可执行文件名称：Instance2 选择 Instance2 Target -> Go to Project -> Set Active Target -> Instance2 Build with Instance2

注意：请谨慎操作，否则您必须重置模拟器 For Reset Simulator -> Run Simulator -> iPhone Simulator -> Reset Content & Settings...

现在您在模拟器中有两个应用程序，您可以在所有实例上测试应用程序。

希望它会帮助你:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-03-06T17:00:35.493

在 XCode 4 中，您可以运行多个实例，同时让它们都处于调试模式。

我所做的是创建我的目标的副本并运行原始和副本。如果您使用的是输出窗口，您可以切换您正在查看的输出。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-10-25T09:10:33.587

我设法让它将[Ivsty](https://stackoverflow.com/a/3717027/1984131)的答案与[这个](https://serverfault.com/a/9686)结合起来工作。

基本上，您所做的是创建两个用户（A 和 B），在每个用户中运行模拟器，在用户 B 上运行 VNC 服务器，然后从用户 A 连接到访问屏幕 B，而无需切换用户。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-06-09T11:18:38.883

从 Xcode 9 开始支持。

（来源：WWDC 2017）

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2016-04-15T13:02:30.667

是的，现在这是可能的，也很容易。您唯一需要的是`xctool`来自 Facebook 的构建工具和一个 ruby​​ gem。ruby gem 有助于创建/销毁测试期间所需的模拟器。

您可以阅读此链接上的完整文档：

[https://github.com/plu/parallel_ios_tests](https://github.com/plu/parallel_ios_tests)

我正在使用这种方法，同时在 4 个 iOS 模拟器上运行我的测试。

# java - 日期时间在 JodaTime 的区间内？

> ID：896491
> 
> 赞同：8
> 
> 时间：2009-05-22T05:37:30.223
> 
> 标签：java, jodatime

JodaTime 中是否有 API 方法可以查看 DateTime 是否在 [start, end] 内，即包含边界？

我发现的唯一一件事是 new Interval(start, end).contains(dateTime) 但如果 dateTime 等于 end，这似乎是错误的。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-22T05:44:57.690

如果您需要经常这样做，最简单的方法是创建一个新的间隔，将旧的间隔延长一毫秒：

```
Interval inclusiveInterval = interval.withEndMillis(interval.getEndMillis() + 1); 
```

或者只是使用

```
if (interval.contains(dateTime) || interval.getEnd().isEqual(dateTime)) 
```

（该`isEqual`方法忽略了年表和时区。）

# xml - 如何在 ActionScript 2.0 中获取 FlashVars 值？

> ID：896501
> 
> 赞同：0
> 
> 时间：2009-05-22T05:39:44.747
> 
> 标签：xml, flash, query-string, flashvars

我必须从 动态发送 flashvars 值`<object>/<embed>`，例如`"<object name="flashvars" value="test=myxml.xml">`发送到我的 swf 文件。

在我的 AS 中，我有这个：

```
var xmlPath:String = _level0.test;
doc.load(xmlPath); 
```

所以，这样我想读取几个xml文件（至少这是我的意图！）。但我所做的没有任何工作......

我也试过

```
doc.load(_root.test) 
```

但它也没有用。

如果我做：

```
doc.load("someXML.xml") 
```

它工作得很好！

我试图解决这个问题很多小时，但仍然没有找到任何解决方案！

提前致谢！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T05:54:23.250

我认为问题在于您的 HTML 标记：

对于`<object>`标签，您需要在其中使用 param 标签，例如

```
<object ...>
<param name="FlashVars" value="test=myxml.xml">
</object> 
```

对于`<embed>`标签，它是标签的一个属性

```
<embed FlashVars="test=myxml.xml" ...> 
```

这是[有关使用 FlashVars 的 Adob​​e 技术说明，](http://kb2.adobe.com/cps/164/tn_16417.html)它也可能对您有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-03T19:09:09.887

xhtml/html5:

```
<param name="FlashVars" value="flvurl=coolmovie" /> 
```

AS2：

```
myFLV.source = "http://www.dom.tld/flv/"+root.loaderInfo.parameters.flvurl+".flv"; 
```

# html - div的方向

> ID：896506
> 
> 赞同：1
> 
> 时间：2009-05-22T05:43:46.973
> 
> 标签：html, css, orientation

有没有办法***使用 css 更改 div 的方向***。

即我需要在倾斜的位置显示一个div。

有没有一种方法可以定义 div 的四个角

**(x1,y1)** , **(x2,y2)** , **(x3,y3)** 和**(x4,y4)**

***编辑***

有没有办法使用**javascript 或 C#**来做到这一点？

有没有办法改变**图像**的方向而不是 div？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T05:46:32.807

这是不可能的。

您将需要使用图像或 VML/SVG

请注意，IE 本身并不支持 SVG，并且没有其他浏览器支持 VML，但是有一个 SVG 到 VML 的包装器。检查谷歌

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T05:47:15.443

使用纯 css 是不可能的，您需要使用 svg、flash 或 silverlight 之类的其他东西。Svg 还可以让您将任意 div 嵌入其中，因此它们会像您想要的那样旋转，但是 IE 尚不支持 svg，并且当我上次测试它时，这个特殊功能非常慢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T06:03:21.103

您总是可以使用[边框倾斜](http://www.infimum.dk/HTML/slantinfo.html)吗？

倾斜允许您在角度上绘制框，但它们不会让您将文本放在角度上。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T10:29:28.067

我只需要在 IE 中做，我确实使用了***矩阵过滤器***并设置了**M11**、**M12**、**M21**和**M22**的值。

```
<style>
      .SlantingDiv { padding: 2px; filter: progid:DXImageTransform.Microsoft.Matrix(sizingMethod='auto expand',M11=1.0,M12=0.4,M21=-0.2,M22=1.0); width: 60; height: 60; padding: 6px; border: #a9a9a9 1px solid }
</style>

<div class="SlantingDiv">
       Slanting Text or Image
</div> 
```

# ruby-on-rails - Rails - 片段缓存不会过期

> ID：896509
> 
> 赞同：1
> 
> 时间：2009-05-22T05:45:15.570
> 
> 标签：ruby-on-rails, ruby, caching, fragment

这个让我难住了。

我有一个缓存片段的视图：

```
 - cache :key=>"news" do    
   %h2 News
   - etc 
```

我有一台扫地机，它使用：

```
def expire_home_cache
  puts "expire_home_cache"
  expire_fragment(:key => "news") 
end 
```

清扫器被称为，因为我可以在控制台输出中看到“expire_home_cache”。

但是片段没有更新......

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-29T00:00:56.213

尝试替换`expire_fragment(:key => "news")`为`ActionController::Base.new.expire_fragment(:key => "news")`

没有时间解释，但它对我有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T14:44:40.047

你可以试试这个：

```
 cache("news") do    
     %h2 News
     - etc
   end 
```

和...

```
def expire_home_cache
  puts "expire_home_cache"
  expire_fragment("news") 
end 
```

...或者试试这个...

```
 - cache({:key=>"news"}) do    
   %h2 News
   - etc 
```

我认为问题可能是 ruby​​ 或 rails 很难确定密钥到底是什么，因此缓存方法和 expire_fragment 正在生成两个不同的缓存密钥。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-27T15:25:42.053

正确的方法是：

```
cache :news do

  ...
end 
```

然后在你的扫地机中：

```
expire_fragment :news 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-17T23:49:25.580

这并不能直接回答您的问题，但是您是否尝试过 timed_fragment_cache 插件作为替代方案？

[http://github.com/tricycle/timed_fragment_cache/tree/master](http://github.com/tricycle/timed_fragment_cache/tree/master)

我发现这是在我的项目中使片段过期的一种更简单的方法。

# sql-server - 我可以将 SourceSafe / VSS 与 SQL Server 2005 集成吗？

> ID：896513
> 
> 赞同：0
> 
> 时间：2009-05-22T05:47:21.183
> 
> 标签：sql-server, visual-sourcesafe, database-versioning

如何使用 VSS 管理 SQL 对象？

我可以将 SourceSafe / VSS 与 SQL Server 2005 集成吗？

我想在我的 SQL 模式中进行版本控制。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-04-15T15:55:46.703

利用 Red Gate 的 SQL Compare 等工具，您可以创建模式、每个文件的对象，然后使用 VSS 维护文件的状态。我目前正试图在我的组织中推动这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T06:19:24.967

除了 VSS 是一个彻底的火车残骸之外，如果您想将架构存储在源代码管理中，一种可能的方法是将每个数据库对象的对象创建脚本作为单独的文件存储在源代码管理中。这样，您可以轻松地更新架构的各个部分。因此，您为每个表、触发器、索引、过程等都有一个脚本。作为构建过程的一部分，可以将它们合并到一个脚本中，以便于应用到目标数据库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-26T15:23:55.710

我们刚刚向 SQL 源代码控制添加了 Visual Source Safe 支持，提供集成到 SQL Server Management Studio 中的源代码控制。目前处于抢先体验阶段，因此请注册抢先体验版本并告诉我们您的想法。

此处提供更多详细信息： [http ://www.red-gate.com/MessageBoard/viewtopic.php?t=12265](http://www.red-gate.com/MessageBoard/viewtopic.php?t=12265)

# iphone - 从服务器获取数据的问题

> ID：896516
> 
> 赞同：1
> 
> 时间：2009-05-22T05:49:38.200
> 
> 标签：iphone, http, redirect

我在获取数据时遇到问题。它的给予`CFHTTPMessageGetResponseStatusCode(response) as 302`。谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T05:53:42.690

直接从马的嘴里（[RFC2616，sec.10.3.3](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)）：

> 302 找到
> 
> 请求的资源临时驻留在不同的 URI 下。由于重定向有时可能会改变，客户端应该继续使用 Request-URI 来处理未来的请求。

换句话说，这是一个重定向：“你要找的东西现在就在那里。” 检查**Location:**响应标头 - 这是您需要检索的新 URL。

# c# - ASP.NET AJAX 控件工具包：显示 ModalPopup 然后执行 PostBack

> ID：896519
> 
> 赞同：2
> 
> 时间：2009-05-22T05:51:14.363
> 
> 标签：c#, asp.net-ajax, ajaxcontroltoolkit, modal-popup

当用户单击 asp 按钮时，我想显示一个模式弹出窗口。用户必须选择面板的选项。所选选项的值必须保存到隐藏的输入，然后 asp.net 按钮**必须**执行**PostBack**。

我可以这样做吗？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-22T14:22:33.040

可以使用回发显示 ModalPopupExtender。您将需要一个不可见的目标控件。扩展器附加到此隐藏控件。

```
<asp:Button runat="server" ID="btnShowModal" Text="Show" 
     OnClick="btnShowModal_Click" /> 
<asp:Button runat="server" ID="HiddenForModal" style="display: none" />
<ajaxToolKit:ModalPopupExtender ID="Modal1" runat="server" 
     TargetControlID="HiddenForModal" PopupControlID="PopupPanel" /> 
```

在代码隐藏的消息处理程序中，您将显示 ModalPopupExtender：

```
Modal1.Show(); 
```

在您用来关闭 Modal 的代码中，调用 ModalPopupExtender 的 Hide 函数：

```
Modal1.Hide(); 
```

我使用此方法显示一个模式，该模式显示我根据在 GridView 中选择的内容从数据库中检索到的详细数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T06:34:36.253

添加您的按钮或链接按钮

```
<asp:Button ID="MyButton" Text="Click Here" runat="server" /> 
```

添加一个面板以使用 DropDownList 保存您的选项

```
<asp:Panel ID="MyPanel" runat="server">
  <asp:DropDownList ID="MyDropDown" runat="server">
    <asp:ListItem Value="1" Text="Option 1" />
  </asp:DropDownList>
  <asp:Button ID="SaveBtn" Text="Save" OnClick="Save_Click" runat="server" />
  <asp:Button ID="CancelBtn" Text="Cancel" runat="server" />
</asp:Panel> 
```

添加您的 ModelPopupExtender

```
<act:ModalPopupExtender ID="Mpe1" TargetControlID="MyButton"  
    CancelControlID="CancelBtn" PopupControlID="MyPanel" runat="server" /> 
```

然后将您的代码添加到 SaveBtn 按钮

```
public void SaveBtn_Click(object sender, EventArgs e) {
  string selectedOption = MyDropDown.SelectedValue;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-02-25T20:18:44.203

最后，我决定使用 jQuery 来显示 ModalPopUp。下面的问题有这个问题的答案：

[jQuery UI 的对话框在 ASP.NET 上不起作用](https://stackoverflow.com/questions/2325431/jquery-uis-dialog-doesnt-work-on-asp-net)

如果您不同意，请告诉我。

# javascript - 在 onClick 事件中更改 Javascript 焦点？

> ID：896521
> 
> 赞同：6
> 
> 时间：2009-05-22T05:52:46.077
> 
> 标签：javascript, prototypejs, firebug, dom-events

注意：一个可能的解决方案只需要在 Firefox 3.0 中工作，我的应用程序不允许从 IE 访问！=)

我有一个链接，点击后会向用户显示一个灯箱：

```
<a href="#" onclick="show_lightbox();return false;">show lightbox</a> 
```

我的问题是，当显示灯箱时，焦点仍然在链接上。因此，如果用户按下向上或向下键，他们最终会滚动主文档，而不是显示的灯箱！

我尝试使用这样的代码将焦点设置到灯箱元素

```
function focus_on_lightbox() {
  document.getElementById('lightbox_content').focus(); 
} 
```

如果我在萤火虫控制台中键入它，这很好用，但如果我将它包含在 onclick 片段的末尾，它将不起作用。似乎我无法将焦点从 onclick 事件中执行的代码中的链接移开？

* * *

-- 更新 1 我以前尝试过这样的事情

```
<a href="#" onclick="show_lightbox();focus_on_lightbox();return false;">show lightbox</a> 
```

我修改了函数以添加一些调试输出，如下

```
function focus_on_lightbox() {
  console.log('hihi');
  console.log(document.activeElement);
  document.getElementById('lightbox_content').focus(); 
  console.log(document.activeElement);
} 
```

输出如下

```
hihi
<a onclick="closePopup();lightbox('apartment_detail','11619');focus_on_lightbox();return false;" href="#">
<a onclick="closePopup();lightbox('apartment_detail','11619');focus_on_lightbox();return false;" href="#"> 
```

所以在我做任何事情之前的焦点在链接上，在我尝试改变焦点之后它仍然留在链接上？

不确定是否重要，但我使用ajax加载灯箱，如下

```
 new Ajax.Updater(lightbox_content_id, url, {asynchronous:true, evalScripts:true, onLoading:show_lightbox_loading(), onComplete:focus_on_lightbox() }); 
```

我试图在ajax完成后设置焦点，但也没有运气。

我错过了什么？

* * *

我一直在尝试通过尝试设置焦点来完成下面建议的解决方案，看看我是否通过检查 document.activeElement 成功，如果没有，请等待 100 毫秒，然后重试。如果我使用以下功能，它将起作用

```
function focus_on_lightbox() {
  var seconds_waited = 0
  pause(100);
  var current_focus = document.activeElement
  while (document.getElementById(lightbox_content_id) != current_focus && seconds_waited < 2000)
  {
    document.getElementById(lightbox_content_id).focus(); 
    console.log(document.activeElement);
    pause(100);
    current_focus = document.activeElement
    seconds_waited += 100;
  }
} 
```

但是，如果我删除 firebug 调试语句 console.log，该功能将停止工作！！我不知道为什么会这样？？为什么将变量输出到萤火虫控制台会影响天气焦点是否移动到元素？console.log 语句会影响焦点吗？也许通过将焦点带到控制台调试窗口？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T07:53:52.543

这是最终起作用的功能

```
function focus_on_lightbox(seconds) {
  var seconds_waited
  seconds_waited = seconds
  document.getElementById(lightbox_content_id).focus(); 
  seconds_waited += 100;

  if (document.getElementById(lightbox_content_id) != document.activeElement && seconds_waited < 2000)
    setTimeout("focus_on_lightbox(" + seconds_waited + ");", 100);
  {
  }
} 
```

那么为什么 console.log 似乎会影响设置焦点呢？在我使用此功能在尝试更改焦点之间暂停之前。

```
function pause(milliseconds) {
    var dt = new Date();
    while ((new Date()) - dt <= milliseconds) { /* Do nothing */ }
} 
```

这会导致 javascript 不断地做某事，我认为它没有给文档时间来呈现或更新或其他东西。console.log 似乎打破了这个锁，让页面有机会改变它的焦点。

当我更改使用超时暂停尝试之间的方法时，不再需要 console.log ！

感谢 bmoeskau 为我指明了正确的方向。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-22T05:56:09.677

我认为您的问题是在返回 false 后调用您的焦点方法。你的代码应该是这样的：

```
<a href="#" 
    onclick="show_lightbox();focus_on_lightbox();return false;">
    show lightbox
</a> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T06:26:40.463

根据我的经验，焦点问题有时可能与时间相关（例如，在元素完全准备好聚焦之前执行 focus()）。我假设在调用 show_lightbox 函数时动态创建灯箱标记？如果是这种情况，您可以尝试在尝试集中精力查看是否是问题之前添加一点延迟，例如：

```
setTimeout("focus_on_lightbox();", 10); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T07:26:44.157

使元素本身成为焦点。在元素的加载事件上，设置几毫秒的超时，然后调用 this.focus();

否则尝试 jQuery。

# log4j - 在 DailyRollingFileAppender -log4j 中使用 MaxBackupIndex

> ID：896530
> 
> 赞同：27
> 
> 时间：2009-05-22T05:56:37.820
> 
> 标签：log4j

有人可以告诉我如何在 DailyRollingFileAppender 中使用 MaxBackupIndex。我知道 RollingFileAppender 支持 maxBackupIndex 属性，但是在 DailyRollingFileAppender 中使用 MaxBackupIndex 有什么解决方法吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-22T06:50:42.547

目前的 Log4j 稳定版本 (1.2) 中不提供此功能。

无论如何，您可以探索以下内容： [http ://wiki.apache.org/logging-log4j/DailyRollingFileAppender](http://wiki.apache.org/logging-log4j/DailyRollingFileAppender)

# python - 将变量传递给 Django 注释视图

> ID：896532
> 
> 赞同：-3
> 
> 时间：2009-05-22T05:57:04.120
> 
> 标签：python, django, django-comments

好吧，我知道我已经问过类似的问题，但我觉得这希望有点不同。我正在将 django.comments 集成到我的应用程序中，我玩得越多，我就越意识到它甚至可能不值得我在一天结束时花时间。除此之外，我已经设法将验证码添加到我的评论中，并且我了解到自定义表单是一个糟糕的主意（隐藏蜜罐非常困难，据我所知需要 JS 隐藏。可惜。）。不过没关系，我已经设法使用它。但是，评论模板（预览和发布）令人沮丧。

当用户被发送到预览或发布的模板时，我希望具有动态数据的侧边栏仍然有效，但它们不是。我是否必须覆盖/重写评论视图才能将数据推送到这些视图？在那一点上，无论如何我似乎都在重写评论系统的大部分内容，在这种情况下我自己写几乎是有益的。我非常愿意这样做，并且完全理解我无权从 Django 获得完美的评论系统。我只是想确保我的想法是正确的，如果我想要的不仅仅是我从评论视图中得到的东西，那么重写它们是我唯一的途径。

不过肯定有人找到了更健康的方法，所以我想我会调查观众。有什么想法吗？如果您需要更多信息，请告诉我！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T09:02:29.160

侧边栏中的动态数据是模板标签的用途。

完全没有必要使用内置视图 - 只需定义标签将它们添加到您的模板中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T00:13:38.627

我也使用模板标签。Django 中的模板确实仅用于显示数据。我认为 Django 相信设计师和开发人员之间的分离。因此，他们强制执行模板的想法应该足够简单，以便网页设计师使用。（Photoshop的家伙）

因此，只要您不需要复杂的功能，只需将信息传递给过滤器并让它进行数据操作并返回您需要的最终字符串。

# c# - 如何使用c#将表值与文本框值匹配

> ID：896533
> 
> 赞同：0
> 
> 时间：2009-05-22T05:57:47.537
> 
> 标签：c#, database, oledb

这是选择用户密码的代码，其中 id = 1 ；我想将此值与文本框匹配。如果该值匹配，则将打开第二个窗口窗体。但它不工作......

```
OleDbConnection con = new OleDbConnection(database2.conn);
con.Open();
OleDbCommand OCom = new OleDbCommand("select user_pasword from tblpasword where id = 1", con);
OleDbDataReader Dreader = OCom.ExecuteReader();

while (Dreader.Read())
{
  MessageBox.Show(Dreader + "");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T06:05:11.100

如果我没有错，我认为您可以使用

```
while(Dreader.Read())
{
    if(Dreader["_password"].ToString()==txtbox.text)
    {
    objectofform.show()
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T06:48:56.433

将您的对象包装在 using 语句中......这样它们就会在完成后关闭并丢弃。返回您要查找的字符串...如果 GetPassword() == null，则未找到，否则返回字符串。

```
public string GetPassword()
{

using (OleDbConnection con = new OleDbConnection(database2.conn))
{

using (OleDbCommand OCom = new OleDbCommand("select user_pasword from tblpasword where id = 1", con))
{
    con.Open();

    using (IDataReader Dreader = OCom.ExecuteReader())
    {
        if (Dreader.Read())
        {
            return Dreader.GetString(0);
        } else return null;
    }
}

}

} 
```

# sql - SQL Server 2005 - Select 语句中的表函数

> ID：896534
> 
> 赞同：2
> 
> 时间：2009-05-22T05:58:44.540
> 
> 标签：sql, sql-server-2005

我有一个名为 PurchaseOrderDetail 的表。

```
TABLE PurchaseOrderDetail
 PurchaseOrderDetail int,
 Comments nvarchar(500) 
```

在每个项目的评论字段中，我都有一个';' 存储合同名称、合同编号、许可证名称、许可证版本的单独列表。

IE

```
PurchaseOrderDetail     Comments 
1                      'Microsoft Office Standard 2007;12%;;'
2                      'Microsoft Visio 2007;9%;;' 
```

我还有一个名为 Split 的函数，它接受一个分隔符和一个字符串并返回一个表，

所以调用这个 select * from Split(';', 'Microsoft Office Standard 2007;12%;;')

返回这个

```
pn           s [ column names]
1            Microsoft Office Standard 2007
2            12% 
```

我需要为每个 PurchaseOrderDetail 分解此信息并在报告中显示它们

所以像这样

```
select PurchaseOrderDetailID, cn.s as ContractName, cno.s as ContractNo
from dbo.PurchaseOrderDetail as pod
join dbo.Split(';', pod.Comments) as cn on cn.pn = 1
join dbo.Split(';', pod.Comments) as cno on cno.pn = 2 
```

虽然这没有运行，但我希望它表明意图。

我希望我的结果是：

```
PurchaseOrderDetailID   ContractName                    ContractNo
1                       Microsoft Office Standard 2007  12% 
```

有可能吗，还是我以错误的方式解决这个问题

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T06:03:08.653

[您使用apply](http://msdn.microsoft.com/en-us/library/ms175156.aspx)关键字“加入”到表值函数。只需将您的字段传递给函数，而不是使用“ON”链接表达式。来自 MSDN 的示例：

```
SELECT D.deptid, D.deptname, D.deptmgrid, ST.empid, ST.empname, ST.mgrid
FROM Departments AS D
    CROSS APPLY fn_getsubtree(D.deptmgrid) AS ST; 
```

OUTER APPLY 相当于 LEFT JOIN。

**编辑**

在您的示例中，您可以在应用函数后将“cn = 1”和“cn = 2”标准添加为 WHERE 子句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T18:50:56.220

表可以有超过 1 列是有原因的。但是总是将值从公共列中拆分出来是一件痛苦的事情！

*   改变你的桌子
*   为您的数据添加专用列
*   UPDATE FROM 并加入 CROSS APPLY 以拆分每一行并填充新列
*   删除包含多个数据元素的旧列
*   升级您的保存和加载例程以使用新列
*   再也不用担心拆分数据了！

# c# - 在 C# 中显示/查找打开的文件路径

> ID：896547
> 
> 赞同：0
> 
> 时间：2009-05-22T06:07:14.607
> 
> 标签：c#

当我打开文件并查看 e:\test\test.doc 中的文件时，我想编写一个程序，然后我想在单独的文件 filetracing.txt 中显示路径。

如果我在 f:\doc.pdf 打开文件，输出应该是：

```
the file in "e:\test.doc" is opened on 2.30 am
the file in "f:\doc.pdf" is opened on 8.30 am  like wise 
```

如何在 C# 中为此编写程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T06:27:04.380

很快......你可以使用 opendialog modalbox 并且可以将路径保存为 opendialogObject.path 和 DateTime.Now() 的当前时间部分并可以将其显示。抱歉，如果这没有帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T11:47:15.227

您的意思是**当访问 c:\ 上的任何文件时**，您希望应用程序写入日志文件？

如果是这样，那么有一个可能的解决方案涉及 System.IO.FileSystemWatcher 类。（我会链接到 MSDN Docs，但由于我是新来的，我不能）

FileSystemWatcher 类更多地用于监视文件系统的*更改*，而不是任何直接的文件系统*访问*。因此，使用此解决方案，您仅限于观察 LastAccessed 的更改 - 这并不总是更新，因此出于严格的审计原因应该依赖它。

下面是一段简短的代码，用于演示使用 FileSystemWatcher 监视 LastAccessed 更改：

```
 using (var w = new System.IO.FileSystemWatcher("c:\\"))
        {
            w.IncludeSubdirectories = true;
            w.NotifyFilter = NotifyFilters.LastAccess;
            w.Changed += (object sender, FileSystemEventArgs e) =>
                        {
                            Console.WriteLine("{0} {1} at {2}", Path.Combine(e.FullPath, e.Name), e.ChangeType, DateTime.Now);
                        };

            w.EnableRaisingEvents = true;   
            Console.WriteLine("Press Enter to exit");
            Console.Read();
        } 
```

笔记：

*   这会在任何文件的 LastAccessed 属性更新时获取事件 - 包括文件创建和修改。

*   如果您在监控时登录到同一个驱动器，您将获得自己的写入事件 - 所以不要忘记过滤它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T13:08:43.237

您可以制作一个只能使用通知图标 UI 运行的小型监控应用程序，并实现[FileSystemWatcher](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher(VS.80).aspx)类来监视文件并在必要时引发日志事件

FileSystemWatcher 的使用示例如下

[http://www.c-sharpcorner.com/UploadFile/mokhtarb2005/FSWatcherDesMA12052005072341AM/FSWatcherDesMA.aspx](http://www.c-sharpcorner.com/UploadFile/mokhtarb2005/FSWatcherDesMA12052005072341AM/FSWatcherDesMA.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T06:31:10.940

使用 System.IO；

字符串路径="e:\test\test.txt"

// 将路径保存在字符串中

FileStream file = new FileStream(path, FileMode, FileAccess); //打开test.doc文件

// 执行文件操作

文件。关闭（）；

//打开路径文件

FileStream pathfile = new FileStream("filetracing.txt",FileMode,FileAccess);

StreamWriter sw = new StreamWriter(pathfile);

sw.Write(路径); // 路径字符串将写入您的 filetracing.txt

sw.Close(); pathfile.Close();

# python - 如何将 Pyglet 图像转换为 PIL 图像？

> ID：896548
> 
> 赞同：2
> 
> 时间：2009-05-22T06:07:26.247
> 
> 标签：python, image, python-imaging-library, pyglet

我想将 Pyglet.AbstractImage 对象转换为 PIL 图像以进行进一步操作这里是我的代码

```
from pyglet import image
from PIL import Image
pic = image.load('pic.jpg')
data = pic.get_data('RGB', pic.pitch)
im = Image.fromstring('RGB', (pic.width, pic.height), data)
im.show() 
```

但显示的图像出错了。那么如何正确地将图像从 pyglet 转换为 PIL 呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T07:47:56.940

我想我找到了解决方案

Pyglet.AbstractImage 实例中的音调与 PIL 不兼容我在 pyglet 1.1 中发现有一个编解码器函数可以将 Pyglet 图像编码为 PIL 这里是源的[链接](http://pyglet.googlecode.com/svn/trunk/pyglet/image/codecs/pil.py)

所以上面的代码应该修改成这个

```
from pyglet import image
from PIL import Image
pic = image.load('pic.jpg')
pitch = -(pic.width * len('RGB'))
data = pic.get_data('RGB', pitch) # using the new pitch
im = Image.fromstring('RGB', (pic.width, pic.height), data)
im.show() 
```

在这种情况下，我使用的是 461x288 图像，发现 pic.pitch 是 -1384

但新的音高是-1383

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T06:10:05.743

这是一个打开的[愿望清单](http://code.google.com/p/pyglet/wiki/ReleaseSchedule)项目：

> AbstractImage 到/从 PIL 图像。

# c# - 如何使用接口、基础和具体实现存储库模式

> ID：896550
> 
> 赞同：1
> 
> 时间：2009-05-22T06:07:36.680
> 
> 标签：c#, design-patterns, repository, repository-pattern, abstraction

`IRepository<T>`通过拥有一个接口、一个`NewsRepository`类和一个`News`实体，我几乎已经完成了我的存储库模式的实现。我遇到的问题是试图将常用方法抽象为基础 Repository 类。

我找不到一种方法来抽象 Get 方法，`NewsRepository`因为它包含特定的 Linq 表达式。

**我的问题是**：

**1）**请问如何将`public T Get(int id)`方法抽象为基类？到目前为止，我完成它的唯一方法是传入`Expression<Func<T,bool>>`而不是 int，但是这并没有真正抽象出常见的行为，因为每个子类仍然需要传入一个在每种情况下几乎相同的表达式，即`n => n.id == id`.

**2)**如何将子类 GetViolations 和 map 方法传递到 Update 方法的基类中？我想解决方案可能是使用委托，但我无法获得编译的语法

这是一组简化的代码——实际上我有一个 Save 方法，它执行 Update 和 Insert 而不仅仅是这里显示的 Update。

```
public interface IRepository<T>
{
    T Get(int id);
    void Update(T item);
}

public class NewsRepository : IRepository<News>
{
    private Table<News> _newsTable;
    public NewsRepository(string connectionString)
    {
        _newsTable = new DataContext(connectionString).GetTable<News>();
    }

    public News Get(int id)
    {
        return _newsTable.SingleOrDefault(n => n.NewsId == id);
    }

    public void Update(News item)
    {
        var errors = item.GetRuleViolations();
        if (errors.Count > 0)
            throw new RuleException(errors);

        News dbNews = _newsTable.SingleOrDefault(n => n.NewsId == item.NewsId);
        map(dbNews, item);

        _newsTable.Context.SubmitChanges();
    }

    private void map(News dbNews, News news)
    {
        dbNews.Title = news.Title;
        dbNews.Article = news.Article;
    }
}

public class Repository<T> where T : class
{
    protected Table<T> _table;

    public Repository(Table<T> t)
    {
        _table = t;
    }

    //How do i do this??! - This doesn't compile due to T no having a NewsId
    public T Get(int id)
    {
    return _table.SingleOrDefault(n => n.NewsId == id);
    }

    //This seems to be a solution, but it's not really abstracting common behaviour as each
    //sub-class will still need to pass in the same linq expression...
    public T Get(Expression<Func<T,bool>> ex)
    {
        return _table.SingleOrDefault(ex);
    }

    public void Update(T item)
    {
        //How is it possible to pass in the GetRuleViolations and map functions to this method?
        var errors = item.GetRuleViolations();
        if (errors.Count > 0)
            throw new RuleException(errors);

        T dbNews = _table.SingleOrDefault(n => n.NewsId == item.NewsId);
        map(dbNews, item);

        _table.Context.SubmitChanges();
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-25T20:57:23.043

1.  L2S 既不支持层超类型也不支持在查询中使用接口成员，这使得重用非常困难。一种选择是动态构建表达式树。这有点乱，但如果你把它隔离到你的基类存储库中，那还不错。

这是一个例子：

```
public interface IEntity
{
    int Id { get; }
}

public partial class News : IEntity
{
}

public class Repository<T> where T : class, IEntity
{

    private readonly DataContext _db;

    public Repository(DataContext db)
    {
        _db = db;
    }

    public T Get(int id)
    {
        Expression<Func<T, bool>> hasId = HasId(id);
        return _db.GetTable<T>().Single(hasId);
    }

    // entity => entity.Id == id;   
    private Expression<Func<T, bool>> HasId(int id)
    {
        ParameterExpression entityParameter = Expression.Parameter(typeof (T), "entity");
        return Expression.Lambda<Func<T, bool>>(
            Expression.Equal(
                Expression.Property(entityParameter, "Id"),
                Expression.Constant(id)
                ),
            new[] {entityParameter}
            );
    }
} 
```

另请参阅[http://msdn.microsoft.com/en-us/library/bb397951.aspx](http://msdn.microsoft.com/en-us/library/bb397951.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T11:58:34.110

1.  拥有[实体的层超类型](http://code.google.com/p/sharp-architecture/source/browse/trunk/src/SharpArch/SharpArch.Core/DomainModel/Entity.cs)确实很有帮助。他们将共享一个 Id 属性。您不必处理表示 id 属性的表达式，您只需知道它是什么。

2.  [模板方法](http://www.dofactory.com/Patterns/PatternTemplate.aspx)模式。在这种模式中，您的基础 Update 会按顺序调用辅助方法，而您的派生类实现这些受保护的抽象辅助方法。

# .net - 将 dll 注册到 GAC 还是从 ASP.NET 的 bin 文件夹中引用它们会更好吗

> ID：896551
> 
> 赞同：3
> 
> 时间：2009-05-22T06:08:14.513
> 
> 标签：.net, compilation, gac

如果答案是“视情况而定”，您能否简要解释一下原因？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-28T16:41:18.797

冒着投反对票的风险，我将不顾大众的意见，说 GAC 只能作为最后的手段（我能想到的一个例子是，当你使用 biztalk 时，它不会给你每个应用程序的 bin 文件夹）。

GAC 最初似乎是在多个应用程序之间共享文件的好方法。但是当您想要更新这些应用程序之一时会发生什么？您要么不得不冒险破坏服务器上使用它的所有应用程序，要么最终在 GAC 中获得多个版本。GAC 中的多个版本并不比与单个应用程序打包的不同版本更好，事实上我会说它更令人困惑。

当您运行 Web 场时，每台服务器最终都会有一个 GAC，因此如果使用 GAC，将应用程序部署到添加到场的新服务器会变得更加复杂。您也失去了在服务器上拥有单个程序集副本的优势。

但是暂时忘记多服务器问题，假设您有一个服务器，其中有 10 个应用程序都使用相同的程序集。您发现此程序集存在仅影响两个应用程序的问题。您是否更新了所有 10 个程序集，这意味着您必须测试所有 10 个程序，并且您可能会破坏几个其他工作的应用程序？还是您只是为损坏的应用程序更新程序集并在下一个开发周期中为其他应用程序更新它？如果您更喜欢后一种方法，那么我会说应该避免使用 GAC。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T06:19:27.027

GAC 旨在包含**跨多个应用程序共享的程序**集。如果是这种情况，您应该对程序集进行强命名并将其注册到 GAC。
如果没有，请将程序集保留为私有程序集并将其作为项目/dll 引用进行引用。

PS：并没有真正从您问题的 bin 文件夹部分获得参考 - 这是哪个 bin 文件夹？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T12:13:30.307

值得记住的是，默认情况下，.Net 将从 GAC 加载匹配的程序集，而不是从本地应用程序文件夹中加载匹配程序集。

此外，如果程序集是强名称签名的，则从 GAC 加载它的性能更高。这是因为为了首先进入 GAC，检查了强名称，这意味着您的应用在加载时不需要再次执行此操作。如果您从本地文件夹加载强命名程序集，则每次都会检查其强名称（不会花费很长时间，但所有这些都会加起来）。您只能将强名称签名的程序集安装到 GAC 中，并且您需要管理员权限才能执行此操作。

# asp.net - Dundas vs ComponentArt 哪个更好

> ID：896553
> 
> 赞同：0
> 
> 时间：2009-05-22T06:09:51.780
> 
> 标签：asp.net, .net-2.0, charts, dundas, componentart

计划购买图表解决方案（用于 ASP.NET），范围缩小到 Dundas 和 componentArt。

是否有功能比较表，比较这两个组件？

有没有人使用这两种方法并发现其中任何一种比另一种更好？

我之前在一个项目中使用过 ComponentArt，它的 3d 色彩设置给我留下了深刻的印象，相比之下，dundas 看起来平淡无奇......

[编辑]
想在 .net Framework 2.0 上使用它
作为两者的任何比较表，**令人惊讶的是，我们没有此类买家指南或可用于商业组件的比较评论。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T22:04:30.010

比诺伊，

你见过[微软的图表控件](http://weblogs.asp.net/scottgu/archive/2008/11/24/new-asp-net-charting-control-lt-asp-chart-runat-quot-server-quot-gt.aspx)吗？他们是免费的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T09:43:06.007

在经历了一些令人沮丧的开发后，我最终拒绝了他们两个：www.simplechart.net/ 支持更好，企业许可证便宜得多，更重要的是它可以毫不费力地工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-26T09:56:17.913

当我在 .NET 2.0 中为 Windows 应用程序使用 Dundas Chart 时，我可以说他们在图表显示方面拥有最先进的技术......你可以用图表做任何事情。我曾经使用 winforms 并忽略了每个图表的“Dundas 试用版”图像。

它们在市场上已经上市了好几年，是首选之一，但是当我们有时需要简单的东西时，许可证的价值就很大了。

例如，对于一个**金融应用程序**，我会毫不犹豫地去**Dundas Charts**，但对于一个给出**简单结果**的简单图表（即使有几个系列），我会考虑看看那里的免费产品，如**Microsoft Chart Control**或任何其他.. .

两种产品（Dundas 和 ComponentArt）都有试用版，请自行尝试，查看两者的**论坛**并查看他们回答社区问题的方式和**速度，查看****Wiki** / **Tutorials**，这是您选择组件后最常使用的，不不管它是什么。

希望它可以帮助您做出决定。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-09-24T07:29:32.983

Nevron Chart has at least as many features as Dundas Chart and the image quality of ComponentArt - but is much faster. The pricing is just right and is suitable for both simple and advanced charting (financial, scientific etc.) - see the demos - [http://chartexamples.nevron.com/](http://chartexamples.nevron.com/).

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2010-07-12T00:39:06.467

我在与 Dundas 的合作中拥有丰富的经验。它们相当容易使用，有据可查并且有很好的支持。我已经打电话给他们并通过电子邮件向他们提出问题，他们非常有帮助。此外，这些图表看起来比我见过的任何其他图表都要好。我搜索并找到了大约 10 个控件，其中 Dundas 是最好的。

它唯一缺少的是 3D 图表……但我想他们很快就会添加它！

# iphone - 具有大量视图的下一个上一个

> ID：896555
> 
> 赞同：1
> 
> 时间：2009-05-22T06:10:32.217
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch, user-interface

我正在尝试管理 18 个不同的视图。如何使用这么多视图以有效的方式处理每个视图的下一个前一个功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T17:35:20.833

管理这一切的最简单方法是创建一个派生自 UIViewController 的类，并让它实现`show`一个`hide`委托方法。然后让您的所有视图控制器都从此类派生并覆盖任何类型的自定义行为。

这样，每个屏幕都有一致的方式进入下一个视图，以及一致的方式将结果返回给调用者。

您在视图之间导航的方式取决于您正在执行的操作。NavController 是一种很好的方式来遍历层次结构或引导用户逐步进行过程。当您需要用户输入某些内容才能继续时，模式对话框会起作用。

但是使用标准的显示/隐藏界面应该可以更轻松地管理屏幕之间的流程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T07:49:45.813

您是否发现以标准方式管理这些视图有任何问题？

我假设您从 nib 或务实地创建每个视图。您使用 UINavigatorController 和/或 UITabBarController 并添加视图，对于标签栏控制器作为导航器控制器的数组，您会弹出第一个视图并设置回调方法。

其他视图在用户导航 UI 时被推送/弹出。我相信如果没有足够的内存， UINavigationController 将卸载视图并在需要时将其加载回来。

如果您将所有艰苦的工作推迟到需要数据时，那么您应该没问题-除非您遇到一些限制，但我无法确定，因为这些视图中没有足够的详细信息-复杂的数据，图像...

# ruby-on-rails - 你曾经在 Rails 中使用受保护的可见性吗？

> ID：896556
> 
> 赞同：14
> 
> 时间：2009-05-22T06:11:44.570
> 
> 标签：ruby-on-rails, private, public, protected

忏悔：我的方法只使用**私有**和**公共**可见性！

我有一种感觉，这是一件坏事。但在 Rails 中，这似乎不是一个问题。

有没有人在 Rails 中有一个例子，不使用**受保护**的可见性是一个大错误？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-22T20:46:45.877

**更新**- 请参阅下面的评论，该评论链接到[/](http://weblog.jamisbuck.org/2007/2/23/method-visibility-in-ruby)[在 Ruby中的](http://weblog.jamisbuck.org/2007/2/23/method-visibility-in-ruby)[真实解释`protected``private`](http://weblog.jamisbuck.org/2007/2/23/method-visibility-in-ruby)。这确实是我在 Java 时代留下的根深蒂固的偏见。我的答案剩下的唯一重要部分是，不是动作的控制器方法不应该是`public`（或者至少你的路由应该保护它们）。

单表继承是`protected`模型层何时有用的完美示例，因为它是那里最常见的继承用途之一。

在控制器层中，定义的辅助方法`ApplicationController`应该被标记为`protected`——如果它们是`private`其他控制器将无法访问它们，但如果它们是`public`Rails 将它们视为操作。

就我个人而言，我发现我比我的许多朋友和同事更多地使用类继承，即使在 Rails 应用程序中也是如此。因为我经常使用它（并且从我的 Java 时代出来），所以我赞成`protected`所有帮助方法为任何想要扩展类的人（通常是我自己）提供自由——除非我真的对一个类感到尴尬，然后我标记它`private`。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T07:24:16.440

我有 SingleTableInheritance

class Person < AR::base class Teacher < Person cals Student < Person

我使用受保护的方法来实现学生和教师通用的私有方法：

```
class Person < AR::base
  def self.find(*args)
    reject_leaves(super(*args))
  end
protected
  def self.reject_leaves(target) #like a private in Teacher and Student
    case target
      when Array target.select{|t| reject_leaves(t)}
      when Person (target.leave_date < Date.today ? target : nil)
      else target
    end
  end
end 
```

免责声明：有一些插件，如 act-as-paranoid 和其他插件来实现我在这里使用的功能来向您展示案例，但我有一个更复杂的环境，我在此处进行了简化以达到您的目的。

# mysql - SQL：在一对多关系中为每个父级显示 1 个子记录的语句

> ID：896561
> 
> 赞同：2
> 
> 时间：2009-05-22T06:19:34.203
> 
> 标签：mysql, one-to-many

我有 2 个表，一个产品表和一个图像表。产品每条记录可以有超过 1 个图像。我需要一个 SQL 语句，它将列出每个产品的 1 个图像，而不是每个产品的所有图像。

我目前努力的一个按比例缩小的例子是：

```
SELECT Product.RefCode, Img.ImgPath
FROM Product INNER JOIN (
    SELECT ProductImg.ImgPath, ProductImg.PrdFK
    FROM ProductImg 
    LIMIT 0,1) AS Img ON Product.PrdID = Img.PrdFK; 
```

上面的示例返回 0 个结果，但是，如果我从 Sub SELECT 中删除 LIMIT 0,1，我将获得所有产品和所有图像的完整列表。

我只想返回每个产品记录的 1 个图像记录。

* * *

我已经将“程序员”代码修改为 MySQL，它工作正常。

```
SELECT Product.RefCode, 
        (Select ProductImg.ImgPath
         From ProductImg
         Where Product.PrdID = Img.PrdFK LIMIT 0,1) AS ImgPath
FROM Products 
```

出于某种原因，在尝试“Bill Karwin”的解决方案时，它让服务器加载了很长时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T06:28:03.910

这应该有效：

```
SELECT Product.RefCode,
       (Select Img.ImgPath
        From ProductImg
        Where Product.PrdID = Img.PrdFK LIMIT 0,1) As ImgPath
FROM Product 
```

如果您有办法确定选择应该返回哪个图像，那么您可以在子选择中添加一个位置，也许还有一个排序依据。

在以下示例中，我们将仅获取最新的活动图像。

```
SELECT Product.RefCode,
       (Select Img.ImgPath
        From ProductImg
        Where Product.PrdID = Img.PrdFK
          And IsActive = 1
        Order By EntryDate Desc LIMIT 0,1) As ImgPath
FROM Product 
```

将“Top 1”编辑并更正为“Limit 0,1”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T06:28:17.373

MySQL 在这里有一些灵活性。您可以使用 GROUP BY 将结果限制为每个产品一行，然后 MySQL 将任意选择哪个图像。在实践中，它往往是首先物理存储在数据库中的图像，但您无法控制它。

```
SELECT p.RefCode, i.ImgPath
FROM Product p INNER JOIN ProductImg i 
  ON (p.PrdID = i.PrdFK)
GROUP BY p.PrdID; 
```

如果您希望每个产品有 1 个*特定*图像，也有办法做到这一点。您需要将其包含在您的要求中。:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T07:06:57.107

如果您在 Image 表上有一个 ID 列，这应该可以工作（无论 SQL 产品或版本是什么）--

> > ```
> >  SELECT
> >             p.RefCode,
> >             i1.ImgPath
> >     FROM
> >             Product p
> >     INNER JOIN
> >             ProductImg i1 ON p.PrdId = i1.PrdFk
> >     LEFT JOIN
> >             ProductImg i2 ON i1.PrdId = i2.PrdId
> >             AND i1.ImgId < i2.ImgId
> >     WHERE
> >             i2.ImgId IS NULL 
> > ```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T07:10:01.297

您需要的是 Image 表上的一个标志，以指定它是否是要显示的主图像。有多种方法可以拉取任意图像，但我认为最好确保拉取正确的图像。

# java - 序列化一个稍后可能会更改的 java 对象

> ID：896562
> 
> 赞同：4
> 
> 时间：2009-05-22T06:20:20.957
> 
> 标签：java, serialization

我需要序列化一个稍后可能会更改的 java 对象，例如可以添加或删除一些变量。这种方法的坑是什么，如果这仍然是唯一的出路，我应该采取什么预防措施。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-22T06:39:08.040

*   您肯定需要从一开始就添加一个[serialVersionUID](http://www.javapractices.com/topic/TopicAction.do?Id=45)字段。
*   更改可能会使序列化对象[不兼容](http://java.sun.com/javase/6/docs/platform/serialization/spec/version.html#6678)。添加和删​​除字段可能会导致违反类合同（直到抛出异常），当反序列化该字段不存在于期望它的类版本中的实例时 - 该字段设置为类型的默认值那案子；最可能的问题是`NullPointerException`s。这可以通过实现[readObject() 和 writeObject()](http://java.sun.com/javase/6/docs/api/java/io/Serializable.html)来避免。其他更改（例如更改字段的类型）可能会导致反序列化完全失败。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T08:47:53.247

正如 Michael 指出的那样，Java 为 java.io.Serializable 的序列化提供了一些支持。Java 支持的主要问题是版本控制很笨重，需要用户处理。

相反，我会推荐 Googles Protocol Buffers 或 Apache Thrift 之类的东西。对于两者，您都用一种非常简单的语言定义对象，然后它们将为您生成序列化代码。两者还为您处理所有版本控制，这样您就不必担心您正在阅读对象的旧版本还是新版本。

例如，如果你有一个 foo() 类型，它有一个 bar 字段，并且你将一堆 foo 对象写入磁盘。然后一段时间后，您将一个字段 baz 添加到 foo 并将更多的 foo 对象写入磁盘。当你读回它们时，它们都将是 foo 对象，看起来好像所有原始 foo 对象根本就没有设置它们的 baz 字段。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T06:34:24.303

我想简短的回答是您将必须实现某种自定义反序列化过程，该过程将知道更改并以正确的方式反序列化对象的旧版本。您还应该包括 serialVersionUID 字段，该字段将跟踪您的版本并帮助您确定序列化对象是否是旧版本。[您可以在此处](http://java.sun.com/developer/technicalArticles/Programming/serialization/)阅读有关此内容的更多信息

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T06:49:17.290

当您现在您的序列化对象将在未来发生变化时，您应该使用另一个命名空间创建一个新的序列化对象，而不是更改现有的。

并且像 Michael 描述的那样添加一个 serialVersionUID 也是一个 ToDo。

# php - 要求社交网络分析（SNA）算法

> ID：896566
> 
> 赞同：1
> 
> 时间：2009-05-22T06:24:43.713
> 
> 标签：php, algorithm, graph, social-networking

我收到了制作[社交图](http://en.wikipedia.org/wiki/Social_network)的任务，其中一个用户位于[中心](http://en.wikipedia.org/wiki/Centrality)，它显示了他拥有的连接。

但在实现这一目标之前，我们的重点是如何确定2 个用户之间的[最短路径。](http://en.wikipedia.org/wiki/Shortest_path_problem)

我找到了一些算法来做到这一点，但它似乎需要很多时间，而且因为它是关于社交链接的，我们正在寻找一个最快的，因为我们需要定期运行它以跟上朋友的更新。

那么，您知道哪种方法是确定两个用户之间最短路径的最快方法吗？

PS：如果你知道 PHP & MySQL 的例子，我会给你一个虚拟啤酒（或可乐）。:D

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-22T06:31:00.440

[Dijkstra 算法](http://en.wikipedia.org/wiki/Dijkstra%27s_algorithm)找到图上两个节点之间的最短路径。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T11:55:30.233

你想要的是一个[全对最短路径](http://en.wikipedia.org/wiki/All_pairs_shortest_path)算法；如果您必须为图形全局生成对，则它比为每一对运行最短路径算法要快。保持更新是另一个问题 - 请注意，每次向图表添加连接时都必须这样做，而不仅仅是每次添加人员时。如果这是用于生产站点，则可能值得将图形生成维护为以比 php 更快的语言编写的离线任务，并将其结果写回数据库。您可能会在那里找到现有的 c++ 实现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T06:28:55.547

在我看来，如果你要绘制整个图表，最简单的方法是跟踪每个人的路径，因为他们被添加到图表中。所以对于人的朋友来说，路径就是“主要人->朋友”。然后，当您将他们的每个朋友添加到图表时，存储路径“主要人物 -> 朋友 1 -> 朋友 2”等。

如果我脑海中的画面是准确的，那似乎是最简单的方法，但我可能会有些误解。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-08-07T07:26:40.590

Dijsktra 的算法在加权图上效果很好。在社交图中，所有边都具有相同的权重。所以 Dijkstra 的算法变成了 BFS。然而，在密集图上，每个级别检查的节点列表将是巨大的。您可以做的一项优化是从两端（A 和 B）开始搜索。

# emacs - Emacs Lisp：如何避免插入重复的列表项？

> ID：896570
> 
> 赞同：15
> 
> 时间：2009-05-22T06:25:58.203
> 
> 标签：emacs, elisp

如何检查字符串是否已经在 Emacs Lisp 的列表中？我需要检查某个路径字符串是否已经存在`exec-path`，如果不是，则将其添加到该列表中。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-22T06:29:20.897

该功能[`add-to-list`](https://www.gnu.org/software/emacs/manual/html_node/elisp/List-Variables.html#index-add_002dto_002dlist-391)将在添加前自动检查

```
(setq a '(1 2 3))
(add-to-list 'a 4)
(add-to-list 'a 3) 
```

将导致`a`等于 (4 1 2 3)

从 Emacs 26 开始`C-h` `f` `add-to-list`：

```
（添加到列表 LIST-VAR ELEMENT &optional APPEND COMPARE-FN）

将 ELEMENT 添加到 LIST-VAR 的值（如果它尚不存在）。
ELEMENT 是否存在的测试使用“equal”或
COMPARE-FN 如果那不是零。
如果添加了 ELEMENT，则添加在列表的开头，
除非可选参数 APPEND 不为零，在这种情况下
最后添加 ELEMENT。

返回值是 LIST-VAR 的新值。

这很方便将一些元素添加到配置变量中，
但请不要在 Elisp 代码中滥用它，你通常在哪里
最好使用“push”或“cl-pushnew”。

如果你想在一个不是
定义直到某个包被加载，你应该把
将“添加到列表”调用到仅运行的钩子函数中
加载包后。'eval-after-load' 提供了一种方法
做这个。在某些情况下，其他钩子，例如主要模式钩子，
可以完成这项工作。

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-05-22T06:30:37.553

除了[cobbal](https://stackoverflow.com/users/73681/cobbal) 关于的[回答](https://stackoverflow.com/questions/896570/emacs-lisp-how-to-avoid-inserting-a-duplicate-list-item/896582#896582)[`add-to-list`](https://www.gnu.org/software/emacs/manual/html_node/elisp/List-Variables.html#index-add_002dto_002dlist-391)之外，还有[`cl-pushnew`](https://www.gnu.org/software/emacs/manual/html_mono/cl.html#index-cl_002dpushnew-21)：

```
(require 'cl-lib)

(setq list-of-strings '("one" "two" "three"))
(cl-pushnew "two" list-of-strings :test #'string=)
    ⇒ ("one" "two" "three")
(cl-pushnew "zero" list-of-strings :test #'string=)
    ⇒ ("zero" "one" "two" "three") 
```

在您的情况下需要该参数，因为默认情况下用于比较，并且它不会将具有相同内容的两个字符串视为相等。( ) 也可以。[`:test`](https://www.gnu.org/software/emacs/manual/html_mono/cl.html#Sequence-Basics) [`#'string=`](https://www.gnu.org/software/emacs/manual/html_node/elisp/Text-Comparison.html#Text-Comparison)`cl-pushnew`[`eql`](https://www.gnu.org/software/emacs/manual/html_node/elisp/Comparison-of-Numbers.html#index-eql-172)[`equal`](https://www.gnu.org/software/emacs/manual/html_node/elisp/Equality-Predicates.html#Equality-Predicates)

```
(eql "some-string" "some-string")
    ⇒ nil
(string= "some-string" "some-string")
    ⇒ t
(equal "some-string" "some-string")
    ⇒ t 
```

从 Emacs 26 开始`C-h` `f` `cl-pushnew`：

```
cl-pushnew 是 'cl-lib.el' 中的一个 Lisp 宏。

（cl-pushnew X PLACE [关键字值] ...）

(cl-pushnew X PLACE)：如果 X 还没有，则在列表的开头插入 X。
与 (push X PLACE) 类似，但如果 X 为 'eql' 则列表未修改
已在列表中的元素。

支持的关键字: :test :test-not :key

```

# c# - 如果路径包含“#”，System.Uri 无法提供正确的 AbsolutePath 和 LocalPath

> ID：896572
> 
> 赞同：4
> 
> 时间：2009-05-22T06:27:01.150
> 
> 标签：c#, .net

我有 C# 代码试图`LocalPath`使用以下代码行获取正在执行的程序集：

`Uri uri = new Uri(Assembly.GetExecutingAssembly().CodeBase).LocalPath;`

这段代码适用于各种路径。它开始无法授予权限`AbsolutePath`，`Localpath`因为执行的程序集路径中包含 # 。

`Assembly.GetExecutingAssembly().CodeBase`给`"C:\c#\ExcelAddin1.1.0\GSRExcelPlugin\bin\Debug\Common.dll"`

但是 new Uri(Assembly.GetExecutingAssembly().CodeBase).LocalPath 给出了“C:\c”，而它应该给出了“C:\c#\ExcelAddin1.1.0\GSRExcelPlugin\bin\Debug\”。

有什么我需要处理的，或者 Uri 类的使用方式有什么问题吗？

如果这是一个 .net 框架问题，我应该如何将此问题报告给 Microsoft？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-08-11T12:57:57.187

```
System.IO.FileInfo logger = new System.IO.FileInfo(Path.Combine(Path.GetDirectoryName(new Uri(Assembly.GetExecutingAssembly().EscapedCodeBase).LocalPath), "settings.config")); 
```

使用 EscapedCodeBase 而不是 CodeBase 解决了这个问题。我没有意识到这已经被处理了，直到我偶然发现它。:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-10T23:33:22.197

该类`Uri`的行为符合预期。`#`不是 url 的有效部分。海事组织这是`CodeBase`财产问题。它返回一个字符串，不转义特殊字符，使其非常不可靠。您的选择是：

1）始终使用`EscapedCodeBase`属性。

```
var uri = new Uri(Assembly.GetExecutingAssembly().EscapedCodeBase).LocalPath; 
```

2）或者如果你真的必须处理`CodeBase`财产（如果这是唯一的选择），你自己得到转义的部分。

```
var x = new Uri(Assembly.GetExecutingAssembly().CodeBase);
var uri = x.LocalPath + Uri.UnescapeDataString(x.Fragment).Replace('/', '\\'); 
```

3）对于加载程序集的文件位置，最简单的方法是使用`Location`属性。

```
var uri = Assembly.GetExecutingAssembly().Location; 
```

该问题已被多次报告，但 MS 坚持认为这是`CodeBase`此处[、](https://connect.microsoft.com/VisualStudio/feedback/details/748220/codebase-does-not-correctly-escape-character)此处[、](http://connect.microsoft.com/VisualStudio/feedback/details/750678/codebase-does-not-correctly-escape-character)此处[和](http://connect.microsoft.com/VisualStudio/feedback/details/333763/assembly-codebase-returns-invalid-uris-for-paths-containing-hashes)此处[的](https://connect.microsoft.com/VisualStudio/feedback/details/798785/system-reflection-assembly-codebase-property-and-getting-local-path-from-it-available-apis-are-insufficient)设计方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T07:07:56.263

# c# - 强制 WPF 工具提示留在屏幕上

> ID：896574
> 
> 赞同：128
> 
> 时间：2009-05-22T06:27:22.413
> 
> 标签：c#, wpf, xaml, tooltip

我有一个标签的工具提示，我希望它保持打开状态，直到用户将鼠标移动到另一个控件。

我在工具提示上尝试了以下属性：

```
StaysOpen="True" 
```

和

```
ToolTipService.ShowDuration = "60000" 
```

但在这两种情况下，工具提示仅显示 5 秒。

为什么这些值会被忽略？

* * *

## 回答 #1

> 赞同：213
> 
> 时间：2009-07-20T08:56:39.417

如果您只想为一个工具提示设置此项，请在具有工具提示的对象上设置持续时间，如下所示：

```
<Label ToolTipService.ShowDuration="12000" Name="lblShowTooltip" Content="Shows tooltip">
    <Label.ToolTip>
        <ToolTip>
            <TextBlock>Hello world!</TextBlock>
        </ToolTip>
    </Label.ToolTip>
</Label> 
```

我会说选择这种设计是因为它允许在不同控件上具有不同超时的相同工具提示。

如果您希望整个应用程序全局使用此功能，请参阅接受的答案。

* * *

## 回答 #2

> 赞同：123
> 
> 时间：2011-11-29T09:13:19.430

只需将此代码放在初始化部分。

```
ToolTipService.ShowDurationProperty.OverrideMetadata(
    typeof(DependencyObject), new FrameworkPropertyMetadata(Int32.MaxValue)); 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2012-10-19T18:23:16.900

这也让我今晚发疯了。我创建了一个`ToolTip`子类来处理这个问题。对我来说，在 .NET 4.0 上，该`ToolTip.StaysOpen`属性并非“真正”保持打开状态。

在下面的类中，使用新的属性`ToolTipEx.IsReallyOpen`，而不是属性`ToolTip.IsOpen`。你会得到你想要的控制。通过`Debug.Print()`调用，您可以在调试器输出窗口中查看调用了多少次`this.IsOpen = false`！这么多`StaysOpen`，还是我应该说`"StaysOpen"`？享受。

```
public class ToolTipEx : ToolTip
{
    static ToolTipEx()
    {
        IsReallyOpenProperty =
            DependencyProperty.Register(
                "IsReallyOpen",
                typeof(bool),
                typeof(ToolTipEx),
                new FrameworkPropertyMetadata(
                    defaultValue: false,
                    flags: FrameworkPropertyMetadataOptions.None,
                    propertyChangedCallback: StaticOnIsReallyOpenedChanged));
    }

    public static readonly DependencyProperty IsReallyOpenProperty;

    protected static void StaticOnIsReallyOpenedChanged(
        DependencyObject o, DependencyPropertyChangedEventArgs e)
    {
        ToolTipEx self = (ToolTipEx)o;
        self.OnIsReallyOpenedChanged((bool)e.OldValue, (bool)e.NewValue);
    }

    protected void OnIsReallyOpenedChanged(bool oldValue, bool newValue)
    {
        this.IsOpen = newValue;
    }

    public bool IsReallyOpen
    {
        get
        {
            bool b = (bool)this.GetValue(IsReallyOpenProperty);
            return b;
        }
        set { this.SetValue(IsReallyOpenProperty, value); }
    }

    protected override void OnClosed(RoutedEventArgs e)
    {
        System.Diagnostics.Debug.Print(String.Format(
            "OnClosed: IsReallyOpen: {0}, StaysOpen: {1}", this.IsReallyOpen, this.StaysOpen));
        if (this.IsReallyOpen && this.StaysOpen)
        {
            e.Handled = true;
            // We cannot set this.IsOpen directly here.  Instead, send an event asynchronously.
            // DispatcherPriority.Send is the highest priority possible.
            Dispatcher.CurrentDispatcher.BeginInvoke(
                (Action)(() => this.IsOpen = true),
                DispatcherPriority.Send);
        }
        else
        {
            base.OnClosed(e);
        }
    }
} 
```

小吐槽：为什么微软不将`DependencyProperty`属性（getter/setter）虚拟化，这样我们就可以接受/拒绝/调整子类中的更改？还是`virtual OnXYZPropertyChanged`为每个人做一个`DependencyProperty`？啊。

- -编辑 - -

我上面的解决方案在 XAML 编辑器中看起来很奇怪——工具提示总是显示，在 Visual Studio 中阻止了一些文本！

这是解决此问题的更好方法：

一些 XAML：

```
<!-- Need to add this at top of your XAML file:
     xmlns:System="clr-namespace:System;assembly=mscorlib"
-->
<ToolTip StaysOpen="True" Placement="Bottom" HorizontalOffset="10"
        ToolTipService.InitialShowDelay="0" ToolTipService.BetweenShowDelay="0"
        ToolTipService.ShowDuration="{x:Static Member=System:Int32.MaxValue}"
>This is my tooltip text.</ToolTip> 
```

一些代码：

```
// Alternatively, you can attach an event listener to FrameworkElement.Loaded
public override void OnApplyTemplate()
{
    base.OnApplyTemplate();

    // Be gentle here: If someone creates a (future) subclass or changes your control template,
    // you might not have tooltip anymore.
    ToolTip toolTip = this.ToolTip as ToolTip;
    if (null != toolTip)
    {
        // If I don't set this explicitly, placement is strange.
        toolTip.PlacementTarget = this;
        toolTip.Closed += new RoutedEventHandler(OnToolTipClosed);
    }
}

protected void OnToolTipClosed(object sender, RoutedEventArgs e)
{
    // You may want to add additional focus-related tests here.
    if (this.IsKeyboardFocusWithin)
    {
        // We cannot set this.IsOpen directly here.  Instead, send an event asynchronously.
        // DispatcherPriority.Send is the highest priority possible.
        Dispatcher.CurrentDispatcher.BeginInvoke(
            (Action)delegate
                {
                    // Again: Be gentle when using this.ToolTip.
                    ToolTip toolTip = this.ToolTip as ToolTip;
                    if (null != toolTip)
                    {
                        toolTip.IsOpen = true;
                    }
                },
            DispatcherPriority.Send);
    }
} 
```

结论：类`ToolTip`和`ContextMenu`. 两者都有管理某些属性的“服务”类，例如`ToolTipService`和`ContextMenuService`，并且`Popup`在显示期间都用作“秘密”父控件。最后，我注意到Web 上的**所有**XAML ToolTip 示例都没有`ToolTip`直接使用类。相反，他们嵌入了 a `StackPanel`with `TextBlock`s。让你说：“嗯……”

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-22T08:06:31.317

您可能希望使用 Popup 而不是 Tooltip，因为 Tooltip 假定您以预定义的 UI 标准方式使用它。

我不确定为什么 StaysOpen 不起作用，但 ShowDuration 的工作原理与 MSDN 中的记录一样——它是显示工具提示时显示的时间量。将其设置为少量（例如 500 毫秒）以查看差异。

在您的情况下，诀窍是保持“最后一个悬停控件”状态，但是一旦您拥有它，如果您使用的是一个弹出窗口，动态更改放置目标和内容（手动或通过绑定）应该是相当简单的，或者如果您使用多个，则隐藏最后一个可见的弹出窗口。

就窗口大小调整和移动而言，弹出窗口存在一些问题（弹出窗口不会随容器移动），因此您在调整行为时可能还需要牢记这一点。看[此链接](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/f0502813-9c4f-4b45-bab8-91f98971e407)。

HTH。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-05-02T10:15:39.210

如果您想指定只有您的某些元素`Window`具有有效的无限期，您可以在您的这些元素`ToolTip`中定义一个。这是一个for有这样一个：`Style``Window.Resources``Style``Button``ToolTip`

```
<Window
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:sys="clr-namespace:System;assembly=mscorlib"
    ...>
    ...
    <Window.Resources>
        <Style x:Key="ButtonToolTipIndefinate" TargetType="{x:Type Button}">
            <Setter Property="ToolTipService.ShowDuration"
                    Value="{x:Static Member=sys:Int32.MaxValue}"/>
        </Style>
        ...
    </Window.Resources>
    ...
    <Button Style="{DynamicResource ButtonToolTipIndefinate}"
            ToolTip="This should stay open"/>
    <Button ToolTip="This Should disappear after the default time.">
    ... 
```

还可以添加`Style.Resources`到`Style`更改`ToolTip`它显示的外观，例如：

```
<Style x:Key="ButtonToolTipTransparentIndefinate" TargetType="{x:Type Button}">
    <Style.Resources>
        <Style x:Key="{x:Type ToolTip}" TargetType="{x:Type ToolTip}">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="HasDropShadow" Value="False"/>
        </Style>
    </Style.Resources>
    <Setter Property="ToolTipService.ShowDuration"
            Value="{x:Static Member=sys:Int32.MaxValue}"/>
</Style> 
```

注意：当我这样做时，我还使用`BasedOn`了`Style`为我的自定义控件版本定义的所有其他内容，`ToolTip`并将应用正常。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-05-22T06:41:45.620

前几天我还在与 WPF 工具提示搏斗。似乎无法阻止它自己出现和消失，所以最后我求助于处理`Opened`事件。例如，我想阻止它打开，除非它有一些内容，所以我处理了这个`Opened`事件，然后这样做：

```
tooltip.IsOpen = (tooltip.Content != null); 
```

这是一个黑客，但它的工作。

大概您可以类似地处理该`Closed`事件并告诉它再次打开，从而使其保持可见。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-07-16T07:33:46.313

Just for the sake of completeness: In code it looks like this:

```
ToolTipService.SetShowDuration(element, 60000); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-22T15:57:14.687

此外，如果您想在 ToolTip 中放置任何其他控件，则它不会成为焦点，因为 ToolTip 本身可以获得焦点。所以就像 micahtan 说的，你最好的镜头是弹出窗口。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-04-03T06:46:32.720

用相同的代码解决了我的问题。

ToolTipService.ShowDurationProperty.OverrideMetadata(typeof(DependencyObject), new FrameworkPropertyMetadata(Int32.MaxValue));

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2012-04-02T11:10:52.750

```
ToolTipService.ShowDurationProperty.OverrideMetadata(
    typeof(DependencyObject), new FrameworkPropertyMetadata(Int32.MaxValue)); 
```

它对我有用。将此行复制到您的类构造函数中。

# programming-languages - 哪个是首选： (var==null) 或 (null==var)

> ID：896578
> 
> 赞同：4
> 
> 时间：2009-05-22T06:28:27.950
> 
> 标签：programming-languages

> **可能重复：**
> [条件样式：if (0 == resultIndex) vs if (resultIndex ==0)](https://stackoverflow.com/questions/892284/conditional-styles-if-0-resultindex-vs-if-resultindex-0)

我在代码中都看到过，我不知道为什么一个比另一个更好，但是你更喜欢使用哪个，为什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-22T06:31:40.660

这种`if(null == var)`做法来自 C，您可能会不小心在其中编写`if(var = null)`（注意赋值运算符），它会编译（因为在 C 中，所有内容都不是 0 为真）但将是语义错误。`if(null == var)`防御性实践也是如此，因为`null`它是左值（同样是 C/C++ 术语），并且不能分配左值。

在现代语言中（特别是在 C# 中），如果您在`if`语句中进行赋值，编译器会警告您。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-22T06:31:03.407

我会说 var==null 因为它更像你实际要说的。“如果我的变量为空……”比“如果我的变量为空……”或“如果我的变量没有……”等任何变体都更有意义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T06:32:21.423

我更喜欢自己使用 (var==null)。这对我来说更有意义，因为我正在检查“如果 var 为空”。当我将它读作“如果 null 是 var”时，就会遇到另一个顺序，这从来没有意义。我也喜欢 VB.NET 如何使它变得非常可读，并使用“如果 var 什么都没有”来检查与其他比较不同的 null。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T06:33:56.240

它们都具有相同的功能并产生相同的结果。选择纯粹是个人的选择。

我个人更喜欢第一个，因为“var is null”或“var equals null”比“null is var”或“var is null”读起来更好。

有些人更喜欢第二种，并声称它减少了由拼写错误引起的错误，因为在编译`null = var`时会导致错误。`var = null`然而，这些天来，编译器对此发出警告，所以我认为这是一个有争议的问题。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-22T06:32:41.327

通常，当我比较两个值时，我倾向于使用未知值然后是已知值。这样我首先知道我在看什么，为测试提供上下文。大多数语言不在乎，但我认为有些可能。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-05-22T06:33:35.773

与语言无关？

在 Scheme 中，没有歧义：

```
(null? var) 
```

# sql-server-2005 - 如何在查询结果显示之前显示执行时间

> ID：896579
> 
> 赞同：0
> 
> 时间：2009-05-22T06:28:52.287
> 
> 标签：sql-server-2005

如何在查询结果显示之前显示执行时间

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T08:04:39.230

异步运行查询。使用 ADO，它是[这样](http://support.microsoft.com/kb/190988)的。对于 ADO.NET，请参阅[此](http://msdn.microsoft.com/en-us/library/zw97wx20.aspx).

然后，显示计时器，直到获得 Complete 事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-08-01T20:54:51.433

```
long inicioBusquedaLong=Calendar.getInstance().getTimeInMillis();
this.setListaTramite(this.buscarCriterio());

long finBusquedaLong=Calendar.getInstance().getTimeInMillis();
this.tiempoBusqueda=finBusquedaLong-inicioBusquedaLong; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T06:37:58.090

如果您从代码中调用查询，则可以使用秒表来计时查询。在执行之前启动它，然后立即停止它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T06:54:14.570

您的意思是让您的程序显示“查询完成前的剩余时间”计数器或进度条，例如当您在 Windows 资源管理器中删除大量文件时？

这通常是不可能的。如果不进行大量工作，就无法“提前”估计许多查询，因此在查询几乎完成之前，估计的完成时间是不可用的。

通过表进行简单的线性搜索将是一个简单的情况，但添加其他约束或使用索引会导致头痛。

（即使是 Windows 中删除大目录的示例也充满了问题 - 他们必须扫描整个目录以在开始删除文件之前对文件进行计数，以便他们可以向您显示进度条；这就是我倾向于破坏的原因来自命令行的大型目录以节省时间）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T07:31:26.723

> > 如何在查询结果显示之前显示执行时间

您可以使用“sys.dm_exec_requests”，但它只支持下面列出的少数操作。显然它不能支持正常的 DML/select 查询。 [sys.dm_exec_requests (Transact-SQL)](http://msdn.microsoft.com/en-us/library/ms177648.aspx)

```
ALTER INDEX REORGANIZE

AUTO_SHRINK option with ALTER DATABASE

BACKUP DATABASE

CREATE INDEX

DBCC CHECKDB

DBCC CHECKFILEGROUP

DBCC CHECKTABLE

DBCC INDEXDEFRAG

DBCC SHRINKDATABASE

DBCC SHRINKFILE

KILL (Transact-SQL)

RESTORE DATABASE, 

UPDATE STATISTICS. 
```

# tfs - TFS 2010 Beta 1 会升级到最终产品吗？

> ID：896581
> 
> 赞同：-1
> 
> 时间：2009-05-22T06:28:56.513
> 
> 标签：tfs

TFS 2010 Beta 1 会升级到最终产品吗？

我知道会有一些问题，甚至可能重新安装，但它与 TFS 2008 的安装戏剧相比如何？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T07:42:45.687

TFS 2010 Beta 1 是一个早期的 Beta，专为在测试产品时独立使用而设计。您不应使用它来运行生产项目并将 Beta 1 服务器升级到更高版本的 Beta 或 Microsoft 不支持的最终版本。

这与 TFS 2005 和 TFS 2008 的早期测试版所发生的情况相同。当 Microsoft 提供带有“上线”许可证的 TFS 测试版时，这通常表明将从已发布产品的测试版。

关于安装体验，玩了一段时间的TFS 2010，很明显微软在安装上花了很多功夫，比以前的版本更流畅、更灵活。也就是说，您仍然需要确保以正确的方式安装了先决条件（即 IIS 和 SQL Server 2008）。与 TFS 一样，请务必仔细遵循安装指南。

就个人而言，我建议现在在虚拟机中测试 TFS 2010 Beta 1。您可能还想在虚拟机中安装客户端 Visual Studio Team Suite，除非您准备重建安装 Beta 1 的机器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T06:44:49.467

Brian Harry 表示，从 Beta 1 迁移到 Beta 2 可能会遇到一些问题：

[http://blogs.msdn.com/bharry/archive/2009/05/18/vs-vsts-2010-and-net-4-0-beta-1-is-available.aspx](http://blogs.msdn.com/bharry/archive/2009/05/18/vs-vsts-2010-and-net-4-0-beta-1-is-available.aspx)

如果从 Beta 1 到 Beta 2 会很困难，那么从 Beta 1 到 Release 也可能会遇到问题。

我打赌它会比 CTP 有更好的支持，但 MS Beta 经常有“升级蓝调”。

我建议现在安装在临时虚拟机上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T06:38:30.693

我猜想不会有无缝升级过程。在 VS2008 发布周期中没有，在 Win7 周期中也没有（我知道它们是两个独立的部门，我只是指出微软的大型公开预发布似乎并不好无缝升级体验）。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-22T06:31:08.100

所有 beta 版本都会升级最终产品，否则他们会称为最终版本 :)

# flash - 用于打印图形的 flash 组件

> ID：896583
> 
> 赞同：0
> 
> 时间：2009-05-22T06:29:48.290
> 
> 标签：flash, charts, graph, graph-theory

是否有用于在 Flash 中绘制图形的类/组件/库？而且我不是在谈论条形图，而是实际的图表，例如神经图或路线图等。此外，如果有人对此有经验，可以绘制出多大的图表，直到它变得很大并且加载非常困难（如何很多节点，路线）。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T06:41:35.307

[http://flare.prefuse.org/](http://flare.prefuse.org/)

Flare 非常可爱，可以处理大量数据。

# c# - WPF：将集合与集合绑定到具有组的列表框

> ID：896587
> 
> 赞同：8
> 
> 时间：2009-05-22T06:31:10.083
> 
> 标签：c#, wpf, listbox, grouping, collections

有时 WPF 对我来说太复杂了。我的“Window1”拥有一组“Group”。“Group”是一个包含“Person”集合的类。最后，这应该是一个联系人列表。我只想在 ListBox 中显示组及其人员，其中列表组的组名称等于我的类“组”的名称属性。

我已经尝试将 CollectionViewSource 绑定到“集合”。组显示正确，但列表中的项目与组名称相同。所以每个组只有一个项目：它的组名。

这里的许多示例显示了只有一个集合的项目分组。我可以做的是将组名设置为“Person”的属性。但是我无法计算（这确实是必要的）： - 每组中有多少人 - 其中有多少人具有“状态”“在线”。

我在“组”类中使用 linq 来计算它。感谢您提供任何帮助我入门的建议。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-22T07:25:41.087

好吧，我不确定这是否是您想要实现的目标，但您可以尝试以下方法：

假设你的课程是这样的：

```
public class Group
{
    public string Name { get; set; }
    public List<Contact> Contacts { get; set; }
}

public class Contact
{
    public string Name { get; set; }
    public bool IsOnline { get; set; }
} 
```

您可以将`ListBox.ItemTemplate`另一个 ListBox 设置为绑定到 Contacts 属性，例如：

```
<CollectionViewSource x:Key="groups" Source="{Binding}" >
    <CollectionViewSource.GroupDescriptions>
        <PropertyGroupDescription PropertyName="Name" />
    </CollectionViewSource.GroupDescriptions>
</CollectionViewSource>

<DataTemplate x:Key="groupTemplate" DataType="Group">
    <StackPanel Orientation="Horizontal">
        <TextBlock Text="{Binding Name}" />
    </StackPanel>
</DataTemplate>

<ListBox ItemsSource="{Binding Source={StaticResource groups}}">
    <ListBox.GroupStyle>
        <GroupStyle HeaderTemplate="{StaticResource groupTemplate}" />
    </ListBox.GroupStyle>
    <ListBox.ItemTemplate>
        <DataTemplate DataType="Contact">
            <ListBox ItemsSource="{Binding Contacts}">
                <ListBox.ItemTemplate>
                    <DataTemplate DataType="Contact">
                        <TextBlock Text="{Binding Name}" />
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

您必须稍微设置内部列表框的样式。

**编辑**：使用的另一种解决方案`TreeView`

```
<DataTemplate DataType="Contact">
   <TextBlock Text="{Binding Name}" />
</DataTemplate>

<TreeView ItemsSource="{Binding Source={StaticResource groups}}">
    <TreeView.ItemTemplate>
        <HierarchicalDataTemplate DataType="Group" ItemsSource="{Binding Contacts}">
            <TextBlock Text="{Binding Name}" />
        </HierarchicalDataTemplate>
    </TreeView.ItemTemplate>
</TreeView> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-22T06:52:23.480

如果您有[Programming WPF](https://rads.stackoverflow.com/amzn/click/com/0596510373)的副本，请跳到第 221 页。如果没有，我会总结一下（以我无能的方式）

首先，您不需要手动对 Person 对象进行分组。

如果每个 Person 对象都有一个 Group 属性，

```
People people = // retrieve the List<Person> somehow
ICollectionView view = CollectionViewSource.GetDefaultView(people);
view.GroupDescriptions.Add( new PropertyGroupDescription("Group") ); 
```

从 ItemsControl 派生的所有控件都可以显示分组项，因此

```
// the XAML
<ListBox ... ItemsSource={Binding}>
  <ListBox.GroupStyle>
    <x:Static Member="GroupStyle.Default" />
  </ListBox.GroupStyle>
</ListBox> 
```

您还可以定义自定义 GroupStyle 并指定 GroupStyle.HeaderTemplate 来定义一个新的 DataTemplate，该 DataTemplate 显示自定义属性，如“一些 PropertyValue (Count)” - 将一个 TextBlock 绑定到`{Binding SomeProperty}`，另一个绑定到`{Binding ItemCount}`

高温高压

# python - 显示特定文件夹中的所有文件名

> ID：896595
> 
> 赞同：0
> 
> 时间：2009-05-22T06:32:42.000
> 
> 标签：python, directory, ls

就像有一个文件夹说 XYZ ，其中包含不同格式的文件，比如说 .txt 文件、excel 文件、.py 文件等。我想使用 Python 编程在输出中显示所有文件名

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T06:37:44.563

```
import glob
glob.glob('XYZ/*') 
```

[有关更多信息，请参阅文档](http://docs.python.org/library/glob.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T08:05:53.987

这是一个示例，它也可能有助于展示一些方便的 Python 基础知识——dicts `{}`、lists `[]`、小字符串技术（`split`）、类似的模块`os`等：

```
bvm@bvm:~/example$ ls
deal.xls    five.xls  france.py  guido.py    make.py      thing.mp3  work2.doc
example.py  four.xls  fun.mp3    letter.doc  thing2.xlsx  what.docx  work45.doc
bvm@bvm:~/example$ python
>>> import os
>>> files = {}
>>> for item in os.listdir('.'):
...     try:
...             files[item.split('.')[1]].append(item)
...     except KeyError:
...             files[item.split('.')[1]] = [item]
... 
>>> files
{'xlsx': ['thing2.xlsx'], 'docx': ['what.docx'], 'doc': ['letter.doc', 
'work45.doc', 'work2.doc'], 'py': ['example.py', 'guido.py', 'make.py', 
'france.py'], 'mp3': ['thing.mp3', 'fun.mp3'], 'xls': ['five.xls',
'deal.xls', 'four.xls']}
>>> files['doc']
['letter.doc', 'work45.doc', 'work2.doc']
>>> files['py']
['example.py', 'guido.py', 'make.py', 'france.py'] 
```

对于您的更新问题，您可以尝试以下操作：

```
>>> for item in enumerate(os.listdir('.')):
...     print item
... 
(0, 'thing.mp3')
(1, 'fun.mp3')
(2, 'example.py')
(3, 'letter.doc')
(4, 'five.xls')
(5, 'guido.py')
(6, 'what.docx')
(7, 'work45.doc')
(8, 'deal.xls')
(9, 'four.xls')
(10, 'make.py')
(11, 'thing2.xlsx')
(12, 'france.py')
(13, 'work2.doc')
>>> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T09:17:06.073

```
import os

XYZ = '.'

for item in enumerate(sorted(os.listdir(XYZ))):
    print item 
```

# c++ - COM 错误 0x80004003（无效指针）访问 MS Outlook 联系人

> ID：896602
> 
> 赞同：3
> 
> 时间：2009-05-22T06:34:17.347
> 
> 标签：c++, com, outlook, atl

我是一些 ATL 代码，它使用智能 COM 指针遍历 MS Outlook 联系人，在某些 PC 上，我收到每个联系人的 COM 错误 0x80004003（“无效指针”）。相同的代码在其他 PC 上运行良好。代码如下所示：

```
_ApplicationPtr ptr;
ptr.CreateInstance(CLSID_Application);

_NameSpacePtr ns = ptr->GetNamespace(_T("MAPI"));
MAPIFolderPtr folder = ns->GetDefaultFolder(olFolderContacts);

_ItemsPtr items = folder->Items;
const long count = items->GetCount();

for (long i = 1; i <= count; i++)
{
    try
    {
        _ContactItemPtr contactitem = items->Item(i);
        // The following line throws a 0x80004003 exception on some machines
        ATLTRACE(_T("\tContact name: %s\n"), static_cast<LPCTSTR>(contactitem->FullName));
    }
    catch (const _com_error& e)
    {
        ATLTRACE(_T("%s\n"), e.ErrorMessage());
    }
} 
```

我想知道是否有任何其他应用程序/加载项可能导致这种情况？欢迎任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T20:32:33.683

FullName 是一个属性，您执行 GET 操作（在 IDL 中可能是这样的：get_FullName([out,retval] BSTR *o_sResult)）。这种操作适用于空值。

我的假设是`contactItem`智能指针指向任何有效的 COM 对象。在这种情况下，执行的格式化操作`ATLTRACE`可能会导致问题。在内部，它的行为可能类似于标准`sprintf("",args...)`函数。

为避免此类问题，只需执行以下操作：

```
ATLTRACE(_T("\tContact name: %s\n"),
_bstr_t(contactitem->FullName)?static_cast<LPCTSTR>(contactitem->FullName):"(Empty)") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-15T21:57:40.450

在我的示例中，您将 NULL 值格式化为正确的文本值。

如果问题是关于 FullName（作为属性）和 GetFullName（）（作为方法）之间的区别，那么答案是否定的。属性和方法应该给出相同的结果。有时属性可以映射到不同的方法，然后是 setXXX 和 getXXX。它可以通过在 IDL 中使用一些特定的语法来实现（实际上是在将 IDL 编译为 TLB 之后的 TLB 中）。如果属性 FullName 未映射到方法 GetFullName，那么您将获得不同的结果。

因此，请在将某些类型库导入您的项目后检查文件 *.tlh...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-11T21:43:12.683

这有什么区别吗？

```
ATLTRACE(_T("\tContact name: %s\n"), static_cast<LPCTSTR>(contactitem->GetFullName())); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T07:22:21.543

只是猜测：也许通讯录中的“FullName”字段为空，这就是指针无效的原因？

很难说，因为您的代码没有指明您正在使用哪些 COM 接口。

# ruby - Ruby 方法 instance_eval() 和 send() 不会否定私有可见性的好处吗？

> ID：896606
> 
> 赞同：2
> 
> 时间：2009-05-22T06:35:01.933
> 
> 标签：ruby, visibility, access-specifier

```
w = Widget.new # Create a Widget
w.send :utility_method # Invoke private method!
w.instance_eval { utility_method } # Another way to invoke it
w.instance_eval { @x } # Read instance variable of w 
```

查看上面与 Widget 类相关的示例（如下）， send 和 instance_eval 方法违反了私有和受保护可见性提供的所有保护。如果是这样，为什么还要在 Ruby 中使用私有和受保护的访问，因为不能保证您的定义会被尊重？

```
class Widget
  def x # Accessor method for @x
   @x
  end
  protected :x # Make it protected
  def utility_method # Define a method
   nil
  end
  private :utility_method # And make it private
end 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-22T06:44:59.327

ruby 相信赋予你做你想做的事的能力。它只是不会让你*不经意间*把你的脚踢掉——如果你想颠覆私有声明，你必须使用清楚地表明你正在这样做的语法。请注意，最终决定代码应该做什么或不应该做什么的人是使用库的人，而不是编写它的人。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-22T12:19:50.743

我不能评论，因为低代表：/。

重新定义send是没有用的，因为send只是**__send__**的通用名称（即下划线，下划线，“send”，下划线，下划线），这是实际实现消息发送的方法。不建议重新定义任何**__method__ 。**此外，其他人也可以重新打开课程并恢复定义：

```
class Widget
  def send(method, *args, &block)
    super
  end
  #and so on
end 
```

在 Ruby 1.9 中，行为略有不同：#send 实际上尊重可见性，**而 __send__**则不然。

Ruby 中的 private 更多的是声明性目的：声明为 private 的方法是实现细节而不是 API 细节。不允许您意外地从外部发送消息。但是，如果他们认为合适的话，任何人仍然可以强行规避这一限制——以他们自己的名义。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-22T11:55:51.793

如果你*真的*想保护 的实例`Widget`，你可以这样做（和一堆其他的东西；这里的代码*不是*一个完整的安全解决方案，只是指示性的）：

```
class Widget

  def some_public_method
    ...
  end

  private

  def utility_method
    ...
  end

  def send(method, *args, &block)
    raise NotImplementedError.new('Widget is secure. Stop trying to hack me.')
  end

  def instance_eval(&block)
    raise NotImplementedError.new('Widget is secure. Stop trying to hack me.')
  end

  class <<self
    private
    def class_eval(&block)
      raise NotImplementedError.new('Widget is secure. Stop trying to hack me.')
    end
  end
end

Widget.freeze 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T06:41:02.843

至少你表达了 Widget 类的公共 API 是什么。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-12-06T00:12:51.900

带回家的信息是：不要打扰。

Ruby 和 Python 一样，在沙盒方面绝对烂透了。如果您尝试锁定某些东西，那么总会有一些方法可以绕过它。在 Ruby 中获取私有属性的多种方法证明了我的观点。

为什么？因为它们被设计成那样。这两种语言的设计都是为了在运行时可以随意使用它们——这就是赋予它们强大功能的原因。通过封闭你的类，你剥夺了其他人使用 Ruby 元编程提供的能力。

Java有反射。C++ 有指针。甚至 Haskell 也有 unsafePerformIO。如果你想保护你的程序，你需要在操作系统级别上保护它，而不是使用语言。

# c# - IDictionary 接口的用途

> ID：896611
> 
> 赞同：4
> 
> 时间：2009-05-22T06:36:52.990
> 
> 标签：c#, idictionary

IDictionary 接口需要什么。如何初始化 IDictionary 接口。毕竟它只是一个界面。以下代码片段来自 msdn。我无法理解。

```
IDictionary<string, string> openWith = new Dictionary<string, string>(); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-22T06:42:08.287

它定义了 Dictionary 应该实现的重要[功能。](http://msdn.microsoft.com/en-us/library/s4ys34ea.aspx)

MSDN 中的这行表示您正在创建一个对象*openWith ，该对象实现了***IDictionary**接口中定义的功能（方法） 。

当您使用 Dictionary 声明变量时，例如：

```
Dictionary<string,string> openWith=.....; 
```

您与对象的具体类型绑定。但是当你使用

```
IDictionary<string,string> openWith=....; 
```

您可以将它与任何实现**IDictionary** *接口*的对象一起使用，也许是您自己的自定义类:)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-22T06:44:11.700

接口的全部意义在于提供......好吧，任何模块的接口（我在这里使用广义上的“模块”），以便调用代码不必担心这个特定接口是如何实现的。

至于“如何`IDictionary`初始化接口”，这在技术上是不正确的。可以初始化的是一个变量，它的类型是`IDictionary<T, V>`. 确实需要初始化变量，但这通常对“客户端代码”是隐藏的。

`IDictionary`不过也不是很有代表性。相反，考虑一个`IDataReader`接口。您肯定已经处理过 ADO.NET，所以这看起来应该很熟悉：

```
public Foo PopulateFromDataReader(SqlDataReader dataReader) 
```

这种特殊的方法与 紧密耦合`SqlDataReader`，因此您必须对其进行重写以支持例如 Access 或 Oracle 或 MySQL 或 Firebird 或其他任何东西。换句话说，你依赖于实现。

现在考虑：

```
public Foo PopulateFromDataReader(IDataReader dataReader) 
```

此方法可用于任何实现 的类`IDataReader`，这意味着基本上任何与 ADO.NET 兼容的数据提供程序。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-22T06:46:32.227

它与任何其他界面没有什么不同。尝试考虑一个更简单的示例：

```
interface IThermometer
{
    double CurrentTemperature { get; }
} 
```

现在我们有了获得温度的方法，尽管我们并不关心它是如何测量的。我们可以创建各种实现：

```
class MercuryThermometer : IThermometer
{
    public double CurrentTemperature
    {
        get { return ... /* gets the temperature somehow */ }
    }
} 
```

程序的其余部分不需要知道它使用的是哪个温度计。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T07:46:48.237

我怀疑您只是忽略了类型为`IDictionary<,>`（接口）的变量与初始化为 a 的值（引用）之间的区别`Dictionary<,>`（注意 no `I`；具体类型）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T09:41:03.123

它对于单元测试也很有用。您可以为接受 IDictionary 而不是 Dictionary 并传递模拟的方法编写单元测试。如果它要接受一个类实例（也可以是密封的），你会有点搞砸了（你必须使用适配器模式等等）。

# client - Bugzilla 服务器如何工作？

> ID：896616
> 
> 赞同：1
> 
> 时间：2009-05-22T06:38:16.793
> 
> 标签：client, bugzilla

我们在想要充当服务器的计算机上安装了 Bugzilla。我还没有在我的电脑客户端上安装 Bugzilla。您能否指出一些描述 Bugzilla 如何作为服务器工作的参考资料？我想做的是从客户端计算机提交错误，这将反映到 Bugzilla 服务器。我们如何访问 Bugzilla 服务器？是否要求所有客户端都拥有 Bugzilla 软件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-22T06:41:24.293

Bugzilla 是一个基于 Web 的应用程序。您不需要在客户端上安装任何东西。有关使用 Bugzilla 的说明，请参见[此处](http://www.bugzilla.org/docs/tip/en/html/using.html)。

# iis-7 - 在 IIS7 中获取会话状态错误

> ID：896619
> 
> 赞同：4
> 
> 时间：2009-05-22T06:40:39.537
> 
> 标签：iis-7

我在网页上收到以下错误。我们最近将一个网站从 IIS6 迁移到 IIS7，这是我第一次接触 IIS7。我们还没有关闭其他域，并且站点运行良好（因此我们可以比较直到迁移完全完成。）

会话状态只能在 enableSessionState 设置为 true 时使用，无论是在配置文件中还是在 Page 指令中。还请确保 System.Web.SessionStateModule 或自定义会话状态模块包含在应用程序配置的 \ 部分中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-06-09T12:01:47.763

解决方案非常好奇。虽然错误描述中的 IIS7 说要将 SessionStateModule 添加到**system.web**部分，但它应该添加到**system.webServer**部分。

```
<system.webServer>
    <modules>
        <remove name="Session" />
        <add name="Session" type="System.Web.SessionState.SessionStateModule, System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"/>
    </modules>
</system.webServer> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-03T10:46:05.743

```
<system.web>
  <httpModules>
     <remove name="Session" />
       <add name="Session" type="System.Web.SessionState.SessionStateModule" />
  </httpModules>
</system.web> 
```

上面的代码工作正常！！！

如果使用 in ，则此代码没有任何效果。

# .net - 如何将 CLR 2 应用程序作为 CLR 4 应用程序运行

> ID：896629
> 
> 赞同：8
> 
> 时间：2009-05-22T06:43:29.237
> 
> 标签：.net, clr

假设我有一个旧应用程序将尝试加载外部程序集。

*   旧应用程序编译为 CLR 2。
*   新程序集编译为 CLR 4。

我希望能够在 CLR 4 中运行那个旧应用程序。我记得其中涉及到一些[xml 清单魔术。](http://msdn.microsoft.com/en-us/library/7wd6ex19(vs.71).aspx)

如何创建该清单 xml 文件来告诉 oldapplication.exe 应在 CLR 4 下运行？

我找到了一些建议，但它们似乎对我不起作用。

*   [http://www.mibuso.com/forum/viewtopic.php?f=23&t=33840&view=next](http://geekswithblogs.net/technetbytes/archive/2007/06/01/112928.aspx)
*   [http://geekswithblogs.net/technetbytes/archive/2007/06/01/112928.aspx](http://geekswithblogs.net/technetbytes/archive/2007/06/01/112928.aspx)
*   [http://msdn.microsoft.com/en-us/library/a5dzwzc9.aspx](http://msdn.microsoft.com/en-us/library/a5dzwzc9.aspx)

oldapplication.exe.config：

```
<?xml version ="1.0"?>
<configuration>
 <startup>
      <!--set the appropriate .net version-->
      <requiredRuntime version="4.0.0.0"/>
 </startup>
</configuration> 
```

* * *

在再次拍摄时，我发现此文件可用作我的模板：

> C:\Windows\Microsoft.NET\Framework\v4.0.20506\Aspnet_regsql.exe.config

```
<?xml version ="1.0"?>
<configuration>
    <startup>
        <supportedRuntime version="v4.0.20506"/>
        <requiredRuntime version="v4.0.20506" safemode="true"/>
    </startup>
</configuration> 
```

我还更新了代码以报告当前的 CLR：

```
Console.WriteLine(typeof(object).Assembly.ImageRuntimeVersion); 
```

现在可以了！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-22T07:27:32.830

您需要提供正确的版本号。请注意，这是 beta 1 版本，它会在 RTM 解决之前发生变化：

```
<configuration>
 <startup>
      <supportRuntime version="4.0.20506"/>
 </startup>
</configuration> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T07:09:35.590

我相信你想使用supportedRuntime，而不是requiredRuntime。

“<supportedRuntime> 元素应该由使用 1.1 版或更高版本的运行时构建的所有应用程序使用。” （[http://msdn.microsoft.com/en-us/library/a5dzwzc9.aspx](http://msdn.microsoft.com/en-us/library/a5dzwzc9.aspx)）。请确保版本字符串与所需版本的“安装文件夹名称”完全匹配。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T01:06:56.263

对于 2013 年以上通过 Google 找到此页面的人

**配置文件要点**
[https://gist.github.com/1223509](https://gist.github.com/1223509)

**博客文章**
[http://yzorgsoft.blogspot.com/2011/09/greenshot-on-windows-8-net-45.html](http://yzorgsoft.blogspot.com/2011/09/greenshot-on-windows-8-net-45.html)

```
<?xml version ="1.0"?>
<configuration>
  <startup useLegacyV2RuntimeActivationPolicy="true">
    <supportedRuntime version="v4.0.30319" />
    <requiredRuntime version="v4.0.30319" safemode="true"/>
  </startup>
  <runtime>
    <relativeBindForResources enabled="true" />
    <UseSmallInternalThreadStacks enabled="true" />
    <DisableMSIPeek enabled="true"/>
  </runtime>
</configuration> 
```

此配置文件是从 Visual Studio 2012 中提取的，因此它有一些额外的 COM 兼容性和性能调整。对于运行托管代码的环境，您可能应该删除该`<runtime>`部分。

# python - 使用python检查文件夹/文件ntfs权限

> ID：896638
> 
> 赞同：11
> 
> 时间：2009-05-22T06:48:03.970
> 
> 标签：python, winapi, permissions, acl, ntfs

正如问题标题可能暗示的那样，我非常想知道检查给定文件或文件夹的 ntfs 权限的方法（提示：这些是您在“安全”选项卡中看到的那些）。基本上，我需要的是获取文件或目录的路径（在本地机器上，或者最好在远程机器上的共享上）并获取用户/组列表以及此文件/文件夹的相应权限. 最终，应用程序将遍历目录树，读取每个对象的权限并相应地处理它们。

现在，我可以想到多种方法来做到这一点：

*   解析 cacls.exe 输出 - 很容易完成，但是，除非我遗漏了什么，否则 cacls.exe 仅以 R|W|C|F（读/写/更改/完整）的形式提供权限，这是不够的（我需要获得“列出文件夹内容”等权限，也需要扩展权限）
*   xcacls.exe 或 xcacls.vbs 输出——是的，它们给了我所需的所有权限，但它们的工作速度非常慢，xcacls.vbs 大约需要一秒钟才能获得本地系统文件的权限。这样的速度是不能接受的
*   win32security（它围绕着winapi，对吗？）——我确信它可以像这样处理，但我宁愿不重新发明轮子

还有什么我在这里想念的吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-22T13:56:50.003

除非您喜欢自己动手，否则 win32security 是您的最佳选择。这里有一个例子的开头：

[http://timgolden.me.uk/python/win32_how_do_i/get-the-owner-of-a-file.html](http://timgolden.me.uk/python/win32_how_do_i/get-the-owner-of-a-file.html)

如果您想稍微危险地生活（！），我正在进行的 winsys 软件包旨在完全满足您的需求。您可以在此处获取开发版本的 MSI：

[http://timgolden.me.uk/python/downloads/WinSys-0.4.win32-py2.6.msi](http://timgolden.me.uk/python/downloads/WinSys-0.4.win32-py2.6.msi)

或者你可以检查 svn 主干：

svn co [http://winsys.googlecode.com/svn/trunk](http://winsys.googlecode.com/svn/trunk) winsys

要按照您的描述进行（稍微猜测确切的要求），您可以这样做：

```
import codecs
from winsys import fs

base = "c:/temp"
with codecs.open ("permissions.log", "wb", encoding="utf8") as log:
  for f in fs.flat (base):
  log.write ("\n" + f.filepath.relative_to (base) + "\n")
  for ace in f.security ().dacl:
    access_flags = fs.FILE_ACCESS.names_from_value (ace.access)
    log.write (u"  %s => %s\n" % (ace.trustee, ", ".join (access_flags))) 
```

TJG

# iphone - 关于高分持久性的建议（iPhone、Cocoa Touch）

> ID：896644
> 
> 赞同：2
> 
> 时间：2009-05-22T06:50:18.320
> 
> 标签：iphone, cocoa-touch, persistence

我很好奇什么被认为是管理高分 plist 文件读写的更好方法。我的高分班是：

```
@interface HighScore : NSObject <NSCoding> {
    NSString        *name;
    int             score;
    int             level;
    int             round;
    NSDate          *date;
} 
```

现在，我可以做方法 A，添加 NSCoding 方法：

```
- (void) encodeWithCoder: (NSCoder *) coder {
    [coder encodeObject: name
                 forKey: kHighScoreNameKey];
    [coder encodeInt: score
              forKey: kHighScoreScoreKey];
    [coder encodeInt: level
              forKey: kHighScoreLevelKey];
    [coder encodeInt: round
              forKey: kHighScoreRoundKey];
    [coder encodeObject: date
                 forKey: kHighScoreDateKey];
} // encodeWithCoder

- (id) initWithCoder: (NSCoder *) decoder {
    if (self = [super init]) {
        self.name = [decoder decodeObjectForKey: kHighScoreNameKey];
        self.score = [decoder decodeIntForKey: kHighScoreScoreKey];
        self.level = [decoder decodeIntForKey: kHighScoreLevelKey];
        self.round = [decoder decodeIntForKey: kHighScoreRoundKey];
        self.date = [decoder decodeObjectForKey: kHighScoreDateKey];
    }
    return (self);
} // initWithCoder 
```

并将其全部写出来：

```
if (![NSKeyedArchiver archiveRootObject:highScoresList toFile:path]) ... 
```

重新阅读它会非常简单。然而 plist 文件，恕我直言，看起来像废话。

或者我可以采用方法 B：

```
NSMutableArray *array = [NSMutableArray arrayWithCapacity:20];;
for (HighScore *hs in highScoresList) {
    NSDictionary *dict = [[NSDictionary alloc] initWithObjectsAndKeys:
                          hs.name, kHighScoreNameKey,
                          [NSNumber numberWithInteger:hs.score], kHighScoreScoreKey,
                          [NSNumber numberWithInteger:hs.level], kHighScoreLevelKey,
                          [NSNumber numberWithInteger:hs.round], kHighScoreRoundKey,
                          hs.date, kHighScoreDateKey,
                          nil];
    [array addObject:dict];
    [dict release];
} 
```

并将其全部写出来：

```
if (![array writeToFile:path atomically:YES]) ... 
```

读回来有点困难。但是 plist 文件看起来更干净（更小更紧凑）。

有什么想法吗？我错过了一些更简单的东西吗？（我想将高分与 NSUserDefaults 分开，所以我不使用它）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-12T12:11:27.153

在我看来，你的两种方式都很好。3.0 OS 中还有 Core Data，但如果您只想保存一个高分值，这可能有点过头了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-12T12:29:02.273

我不确定我是否理解您的反对意见！两者都应该工作得很好。

我个人更喜欢方法 A。我认为对象知道如何编码自己是有道理的。它使维护更容易，任何更改都更加本地化。另外，它可能使用更少的内存。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T07:15:32.833

看看[这个](https://stackoverflow.com/questions/367198/iphone-high-scores-framework)问题，也许它对你的应用有用

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-02T19:23:46.453

我选择了方法 B，因为： 1\. plist 文件更具可读性 2\. 我可以轻松地将一些文件和类版本编号保存到此方法中：

在我的 HighScore 课程中：

```
- (id)initFromDictionary: (NSDictionary *)dict;
{
    if (self = [super init]) {
        self.name = [dict objectForKey:kHighScoreNameKey];
        self.score = [[dict objectForKey:kHighScoreScoreKey] integerValue];
        self.game = [[dict objectForKey:kHighScoreGameKey] integerValue];
        self.level = [[dict objectForKey:kHighScoreLevelKey] integerValue];
        self.date = [dict objectForKey:kHighScoreDateKey];
    }
    return (self);
}
- (NSDictionary *)putIntoDictionary;
{
    NSDictionary *dict = [[NSDictionary alloc] initWithObjectsAndKeys:
                          name, kHighScoreNameKey,
                          [NSNumber numberWithInt:score], kHighScoreScoreKey,
                          [NSNumber numberWithInt:game], kHighScoreGameKey,
                          [NSNumber numberWithInt:level], kHighScoreLevelKey,
                          date, kHighScoreDateKey,
                          nil];
    return dict;
}

And in my HighScoreTable class:
- (id) load
{
    NSString *path = [self getFilePath];

//  [self clear];
    NSDictionary *rootLevelPlistDict = [NSDictionary dictionaryWithContentsOfFile:path];
    int versNum = [[rootLevelPlistDict objectForKey:kHighScoreVersKey] integerValue];

    if (versNum == kHighScoreVersNum) {
        NSArray *insideArray = [rootLevelPlistDict objectForKey:kHighScoresKey];

        NSDictionary *dict;
        for (dict in insideArray) {
            HighScore *hs = [[HighScore alloc] initFromDictionary:dict];
            [highScoresList addObject:hs];
            [hs release];
        }
    }
    return sharedHighScoresSingleton;
}

- (void) save
{   
    if (!changed)
        return;
    NSString *path = [self getFilePath];
    NSMutableArray *array = [NSMutableArray arrayWithCapacity:kNumberOfHighScores];
    for (HighScore *hs in highScoresList) {
        NSDictionary *dict = [hs putIntoDictionary];
        [array addObject:dict];
        [dict release];
    }
    NSDictionary *rootLevelPlistDict = [[NSDictionary alloc] initWithObjectsAndKeys: 
            [[[NSBundle mainBundle] infoDictionary]
                objectForKey:(NSString*)kCFBundleNameKey], kHighScoreAppNameKey,
                [NSNumber numberWithInt:kHighScoreHeaderVersNum], kHighScoreHeaderVersKey,
                [NSNumber numberWithInt:kHighScoreVersNum], kHighScoreVersKey,
                [NSDate date], kHighScoreCreationKey,
             array, kHighScoresKey,
             nil];

    if (![rootLevelPlistDict writeToFile:path atomically:YES])
        NSLog(@"not successful in writing the high scores");
    [rootLevelPlistDict release];
} 
```

# c# - 如何检查机器上安装的 MS Office 版本

> ID：896645
> 
> 赞同：4
> 
> 时间：2009-05-22T06:50:41.487
> 
> 标签：c#, ms-office

我正在开发一个控制台应用程序，它对注册表执行一些操作。我没有在办公室使用任何互操作程序集，但我需要知道办公室版本。如何使用 C# 确定机器上安装了哪个版本的 MS Office。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-22T06:54:06.723

搜索（使用[Registry](http://msdn.microsoft.com/en-us/library/microsoft.win32.registry.aspx)类）

> HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\App 路径

或者

> HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\App 路径

版本号是

*   7.0 -97
*   8.0 - 98
*   9.0 -2000
*   10.0 -2002
*   11.0 -2003
*   12.0 -2007
*   14.0 -2010

[这是ac#实现](http://www.codeproject.com/KB/office/getting_office_version.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-13T11:01:17.920

我有同样的要求，但我还必须找出安装的 office 是 32 位还是 64 位。我在这里记录了我的解决方案：

[http://cyrilbeschi.blogspot.com/2014/03/how-to-find-microsoft-office-version.html](http://cyrilbeschi.blogspot.com/2014/03/how-to-find-microsoft-office-version.html)

# c++ - C ++结构成员，在iPhone上保持日历时间的类型是什么？

> ID：896647
> 
> 赞同：1
> 
> 时间：2009-05-22T06:51:56.880
> 
> 标签：c++, objective-c, iphone, cocoa-touch, sqlite

我需要将日期时间保存在 iPhone 应用程序的 C++ 结构中。时间将被保存并恢复到 sqlite db。最好的数据类型和相应的 API 是什么？我的候选人是：

1.  `time_t`和结构`tm`从`<ctime>`和`<time.h>`
2.  `NSTimeInterval`从`<NSDate.h>`
3.  `TimeValue`来自 QuickTime API

我的直觉是使用来自`<time.h>`. 路上有什么缺点吗？我想念的任何其他时间类型是 iPhone SDK 的宠儿？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T12:57:01.747

`NSTimeInterval`及其对应的 CoreFoundation`CFAbsoluteTime`是最好使用的值，因为它们包括亚毫秒精度（它们是双精度浮点值）。`time_t`并且`struct tm`仅在某些 BSD API 中真正使用（并且`struct timeval`或者`struct timespec`在那里更常见）。`TimeValue`仅用于表示媒体文件中的值和间隔，通常基于可配置的时基。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-23T07:20:13.267

这完全取决于您使用时间的目的。

*   你需要什么精度？
*   将存储多少？（平均/最坏情况）

根据需要存储尽可能多的精度，但仅此而已。（但也要考虑未来的需求）。您不会将约会时间保存到最接近的纳秒 - 这没有意义。但是，如果您正在记录某些类型的数据，其中非常小的间隔很重要，那么您可以将其保存到系统时钟的精度（通常为 100 纳秒的块），或者甚至比这更精细一些，以允许具有更好时钟的未来版本.

如果您只存储少量（比如少于几千个），那么存储大小和访问速度可能并不重要。如果您要存储许多记录，那么记录的大小可能会变得很重要。

除了上述考虑之外，这并不重要；只要有明确的记录。

我不熟悉sqlite db。它有任何本地日期/时间类型吗？如果是这样，那可能是最简单的——只要它满足您的要求。

# emacs - 学习 Emacs 的资源

> ID：896648
> 
> 赞同：6
> 
> 时间：2009-05-22T06:52:12.607
> 
> 标签：emacs, elisp

我想学习 Emacs，想知道是否有人可以推荐任何好的资源（免费或其他）。我最感兴趣的是编程 Emacs，从基础开始，还有很多“练习”。我使用过 Emacs 和它的大部分编辑功能，虽然我有点生疏，所以快速复习一下也会很有用。

谢谢

编辑：感谢您的建议。我会看看并更新我喜欢的东西......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-22T07:48:48.217

1.  [GNU Emacs 手册](http://www.gnu.org/software/emacs/manual/emacs.html)
2.  [GNU Emacs lisp 参考](http://www.gnu.org/software/emacs/manual/elisp.html)
3.  [emacswiki](http://www.emacswiki.org/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-22T07:07:08.027

[用 Emacs Lisp 编程（第二版）](http://www.gnu.org/software/emacs/emacs-lisp-intro/emacs-lisp-intro.html) - 免费在线书籍

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-22T07:12:22.917

要记住的一件事是所有 emacs 配置都是编程。

[PlanetEmacsen](http://planet.emacsen.org/atom.xml)是一个很好的 RSS 提要，有很多技巧。

[Xah Lee](http://xahlee.org/emacs/emacs.html)虽然显然被认为是一个坏巨魔，但他有一些很棒的 emacs 编程东西。

此外，每当您不确定某个功能或键盘快捷键时，请分别尝试 Ch f 和 Ch k，然后点击指向该命令源代码的链接。

对于练习，[DustBunny 的 Lair](http://dustbunnylair.blogspot.com/2008/07/creating-python-mode-for-emacs-from.html)做了一个很长的系列，从头开始重写 python 模式。

您也可以尝试编写[PLEAC](http://pleac.sourceforge.net/) elisp 部分。这是将 elisp 与您最喜欢的语言进行比较的好方法。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-22T07:07:09.413

Emacs 本身包含一个带有练习的教程，指导您完成基本功能和编辑命令。您可以在“Help”下的菜单中找到它或按Ch t（即同时按Control 和“h”，然后单独按“t”）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T07:52:25.153

上周我购买了这个 Peepcode 截屏视频并且非常喜欢它。它引导您了解基本功能（编辑、加载保存、缓冲区），还深入探讨了一些高级主题，例如编程 emacs lisp：

[http://peepcode.com/products/meet-emacs](http://peepcode.com/products/meet-emacs)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-08-24T14:45:57.237

关于 Emacs 最好的书绝对是[Bob Glickstein 的“Writing GNU Emacs Extensions”。](http://www.emacs.uniyar.ac.ru/doc/O%27Reilly_Emacs/Writing%20GNU%20Emacs%20Extensions.PDF)

真的很翔实。真的很好的例子。而且，对于一本技术书籍来说，阅读是一种乐趣。这是我拥有的最好的计算机书籍之一。（下面有我1982年的《VIC-20技术手册》这样的宝藏:-)

一些 PDF 可以在线获得，但为了获得更多乐趣，我建议购买硬拷贝。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-09-05T05:04:50.197

Emacs 自己的帮助系统是你的朋友 ---***问 Emacs***。学习主`C-h`键和`apropos`。

这些也可以提供帮助：

*   [http://www.emacswiki.org/emacs/HelpPlus](http://www.emacswiki.org/emacs/HelpPlus)

*   [http://www.emacswiki.org/emacs/EmacsNewbieWithIcicles](http://www.emacswiki.org/emacs/EmacsNewbieWithIcicles)

# sql - 从 Oracle JDBC TIMEZONETZ 对象中提取时区

> ID：896653
> 
> 赞同：0
> 
> 时间：2009-05-22T06:54:41.010
> 
> 标签：sql, oracle, datetime, jdbc, timezone

有没有办法直接从`oracle.sql.TIMESTAMPTZ`对象（从`TIMESTAMP WITH TIME ZONE`列中选择）中提取时区信息？

理想情况下，我希望能够直接从对象中提取时区信息，而无需跳过潜在的昂贵或脆弱的箍（例如将事物转换为字符串并解析它们）。

你会认为有一种简单的方法可以做到这一点，但我还没有找到。Oracle 的文档不是很有帮助。它声称`TIMESTAMPTZ#toBytes()`编码时区信息返回的最后两个字节，但没有描述我们实际解码此信息。

有没有人有处理这些东西的经验？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T07:18:13.517

Oracle 为这些提供了特定的日期格式元素：TZD、TZH、TZM 和 TZR。

一个例子：

```
SQL> create table t (col timestamp with time zone)
  2  /

Tabel is aangemaakt.

SQL> insert into t values (sysdate)
  2  /

1 rij is aangemaakt.

SQL> select col
  2       , to_char(col,'TZD') time_zone_daylight_info
  3       , to_char(col,'TZH') time_zone_hour
  4       , to_char(col,'TZM') time_zone_minute
  5       , to_char(col,'TZR') time_zone_region
  6    from t
  7  /

COL                             TIME_Z TIM TI TIME_ZONE_REGION
------------------------------- ------ --- -- --------------------------------
22-05-09 09:12:33,000000 +02:00        +02 00 +02:00    

1 rij is geselecteerd. 
```

或者使用 EXTRACT 函数：

```
SQL> select col
  2       , extract(timezone_abbr from col)   time_zone_abbr
  3       , extract(timezone_hour from col)   time_zone_hour
  4       , extract(timezone_minute from col) time_zone_minute
  5       , extract(timezone_region from col) time_zone_region
  6    from t
  7  /

COL                             TIME_ZONE_                         TIME_ZONE_HOUR                       TIME_ZONE_MINUTE
------------------------------- ---------- -------------------------------------- --------------------------------------
TIME_ZONE_REGION
----------------------------------------------------------------
22-05-09 09:15:24,000000 +02:00 UNK                                             2                                      0
UNKNOWN

1 rij is geselecteerd. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-24T06:11:41.887

TIMESTAMPTZ 的格式有[据可查](https://docs.oracle.com/database/122/JAJDB/oracle/sql/TIMESTAMPTZ.html)。我们目前使用[以下代码](https://github.com/marschall/threeten-jpa/blob/master/threeten-jpa-oracle-impl/src/main/java/com/github/marschall/threeten/jpa/oracle/impl/TimestamptzConverter.java)来提取时区信息。

如果您使用的是 Java SE 8，则可以使用`getObject(int, OffsetDateTime.class)`，如果使用，`getObject(int, ZonedDateTime.class)`您可能会受到[错误 25792016](https://support.oracle.com/epmos/faces/BugDisplay?id=25792016)的影响。

# c++ - cout 或 printf 两者中哪一个具有更快的 C++ 执行速度？

> ID：896654
> 
> 赞同：34
> 
> 时间：2009-05-22T06:55:24.270
> 
> 标签：c++, io, cout

我已经用 C++ 编码很长时间了。我一直想知道哪个执行速度更快`printf`？`cout`

情况：我正在用 C++ 设计一个应用程序，我有一些限制，例如执行时间限制。我的应用程序在控制台上加载了打印命令。那么哪一个更可取`printf`？`cout`

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-05-22T07:00:33.530

每个都有自己的开销。根据您打印的内容，任何一个都可能更快。

想到这里有两点——

printf() 必须解析“格式”字符串并对其进行操作，这会增加成本。
cout 具有更复杂的继承层次结构并传递对象。

在实践中，除了最奇怪的情况外，差异对所有情况都不重要。如果您认为这真的很重要 - 测量！

**编辑**-
哦，见鬼，我不相信我正在这样做，但为了记录，在我非常具体的测试用例中，使用我非常具体的机器及其非常具体的负载，使用 MSVC 在 Release 中编译 -

打印 150,000 个“Hello, World!”（不使用 endl）大约需要 -
printf() 需要 90 毫秒，cout 需要 79 毫秒。

打印 150,000 个随机双打大约需要 -
printf() 3450ms，cout 3420ms。

（平均超过 10 次运行）。

差异如此之小，这可能没有任何意义......

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-05-22T07:03:16.550

你真的需要关心哪个执行速度更快吗？它们都仅用于将文本打印到控制台/标准输出，这通常不是需要超高效率的任务。就此而言，无论如何我都不会想象速度会有很大差异（尽管人们*可能会*期望速度`printf`会稍微快一些，因为它缺少面向对象的次要复杂性）。然而，鉴于我们在这里处理的是 I/O 操作，即使是很小的差异也可能会被 I/O 开销所淹没。当然，如果您比较写入文件的等效方法，情况就是如此。

`printf`只是在 C 中将文本输出到标准输出的标准方法。
“cout”管道只是在 C++ 中将文本输出到标准输出的标准方法。

说了这么多，[comp.lang.cc](http://groups.google.com/group/comp.lang.c++.moderated/browse_thread/thread/77637c6bf362a01c)群里有个帖子在讨论同样的问题。然而，共识似乎是您应该出于性能以外的原因选择一个而不是另一个。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2011-09-28T07:23:05.870

C++ cout 速度慢的原因是与 stdio 的默认同步。

尝试执行以下操作以停用此问题。

`ios_base::sync_with_stdio(false)`

[http://www.cplusplus.com/reference/iostream/ios_base/sync_with_stdio/](http://www.cplusplus.com/reference/iostream/ios_base/sync_with_stdio/)

[http://msdn.microsoft.com/es-es/library/7yxhba01.aspx](http://msdn.microsoft.com/es-es/library/7yxhba01.aspx)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-22T07:08:06.997

至少在 Windows 上，向控制台写入是一个巨大的瓶颈，因此“嘈杂”的控制台模式程序将远慢于无声的程序。因此，在该平台上，用于处理控制台的库函数的细微差别在实践中可能不会产生显着差异。

在其他平台上可能会有所不同。此外，它还取决于您正在执行多少控制台输出，相对于其他有用的工作。

最后，它取决于您的平台对 C 和 C++ I/O 库的实现。

所以这个问题没有一般的答案。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-22T07:08:50.723

性能不是比较问题；想不出任何真正重要的东西（开发控制台程序）。但是，您应该考虑以下几点：

*   Iostreams 使用运算符链接而不是 va_args。这意味着您的程序不会因为您传递了错误数量的参数而崩溃。这可能发生在 printf 中。

*   Iostreams 使用运算符重载而不是 va_args ——这意味着您的程序不会崩溃，因为您传递了一个 int 并且它期待一个字符串。这可能发生在 printf 中。

*   Iostreams 没有对格式字符串的原生支持（这是#1 和#2 的主要原因）。这通常是一件好事，但有时它们很有用。Boost 格式库将此功能带到了 Iostreams 中，供那些需要具有已定义行为（抛出异常）而不是未定义行为（如 printf 的情况）的人使用。这目前不在标准范围内。

*   Iostreams 与它们的 printf 等价物不同，它可以自己直接处理可变长度缓冲区，而不是被迫处理硬编码的垃圾。

去cout。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2011-06-17T15:49:56.400

我最近在 Windows 上开发一个 C++ 控制台应用程序，该应用程序使用 CopyFileEx 复制文件，并将每个副本的“to”和“from”路径回显到控制台，然后在操作结束时显示平均吞吐量。

当我使用 printf 运行控制台应用程序来回显字符串时，我得到了 4mb/sec，当用 std::cout 替换 printf 时，吞吐量下降到 800kb/sec。

我想知道为什么 std::cout 调用要贵得多，甚至会在每个副本上回显相同的字符串，以便更好地比较调用。我进行了多次运行以平衡比较，但 4 倍的差异仍然存在。

然后我在stackoverflow上找到[了这个答案..](https://stackoverflow.com/questions/1832489/printf-slows-down-my-program/1832622#1832622)

打开 stdout 的缓冲就可以了，现在我的 printf 和 std::cout 的吞吐量数字几乎相同。

我还没有深入研究 printf 和 cout 在控制台输出缓冲方面的不同之处，但是在我开始写入控制台之前设置输出缓冲区解决了我的问题。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-22T07:41:52.227

另一个 Stack Overflow 问题解决了 C 样式格式化 I/O 与 C++ iostream 的相对速度：

*   [为什么 snprintf 比 ostringstream 快，还是这样？](https://stackoverflow.com/questions/445315/why-is-snprintf-faster-than-ostringstream-or-is-it)

*   [http://www.fastformat.org/performance.html](http://www.fastformat.org/performance.html)

但是请注意，所讨论的基准是针对内存缓冲区的格式化。我猜如果您实际上是在对控制台或文件执行 I/O，那么由于 I/O 占用更多的总时间，相对速度差异会小得多。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-05-22T07:43:48.417

如果您使用的是 C++，则应使用`cout`as`printf`属于 C 系列函数。有许多改进`cout`，您可能会从中受益。至于速度，这不是问题，因为控制台 I/O 无论如何都会很慢。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-22T07:08:44.733

实际上，我一直发现 printf 比 cout 快。但话又说回来，cout 在类型安全方面为您做的更多。还要记住 printf 是一个简单的函数，而 cout 是一个基于复杂流层次结构的对象，因此比较执行时间并不公平。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-22T08:20:09.450

要解决这个问题：

```
#include <iostream>
#include <cstdio>
#include <ctime>
using namespace std;

int main( int argc, char * argcv[] ) {
    const char * const s1 = "some text";
    const char * const s2 = "some more text";
    int x = 1, y = 2, z = 3;
    const int BIG = 2000;
    time_t now = time(0);
    for ( int i = 0; i < BIG; i++ ) {
        if ( argc == 1 ) {
            cout  << i << s1 << s2 << x << y << z << "\n";
        }
        else {
            printf( "%d%s%s%d%d%d\n", i, s1, s2, x, y, z );
        }
    }
    cout << (argc == 1 ? "cout " : "printf " ) << time(0) - now << endl;
} 
```

为 cout 和 printf 生成相同的时序。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-03-07T20:17:56.640

你为什么不做一个实验？平均而言，打印字符串 helloperson;\n 使用 printf 平均需要 2 个时钟滴答，而 cout 使用 endl 需要大量时间 - 1248996720685 个时钟滴答。使用带有 "\n" 的 cout 作为换行符只需要 41981 个时钟滴答。我的代码的短网址如下：

cpp.sh/94qoj

链接可能已过期。

要回答您的问题， printf 更快。

```
#include <iostream>
#include <string>
#include <ctime>
#include <stdio.h>
using namespace std;
int main()
{
  clock_t one;
  clock_t two;
  clock_t averagePrintf;
  clock_t averageCout;
  clock_t averagedumbHybrid;
  for (int j = 0; j < 100; j++) {
    one = clock();
    for (int d = 0; d < 20; d++) {
      printf("helloperson;");
      printf("\n");
    }
    two = clock();
    averagePrintf += two-one;

    one = clock();
    for (int d = 0; d < 20; d++) {
      cout << "helloperson;";
      cout << endl;
    }
    two = clock();
    averageCout += two-one;

    one = clock();
    for (int d = 0; d < 20; d++) {
      cout << "helloperson;";
      cout << "\n";
    }
    two = clock();
    averagedumbHybrid += two-one;
  }
  averagePrintf /= 100;
  averageCout /= 100;
  averagedumbHybrid /= 100;
  cout << "printf took " << averagePrintf << endl;
  cout << "cout took " << averageCout << endl;
  cout << "hybrid took " << averagedumbHybrid << endl;
} 
```

是的，我确实使用了愚蠢这个词。我首先为自己制作，认为结果很疯狂，所以我搜索了它，最后我发布了我的代码。

希望它有帮助，Ndrewffght

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-23T09:21:45.843

在引擎盖下，它们都将使用相同的代码，因此速度差异无关紧要。

如果你只在 Windows 上运行，非标准的 cprintf() 可能会更快，因为它绕过了很多流的​​东西。

然而，这是一个奇怪的要求。没有人能读得那么快。为什么不将输出写入文件，然后用户可以在闲暇时浏览文件？

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-22T07:22:21.777

如果您出于性能原因需要找出原因，则说明您的应用程序存在根本性问题 - 考虑使用其他一些日志记录工具或 UI ;)

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2009-05-22T08:46:02.190

轶事证据：
我曾经设计了一个日志类来使用 ostream 运算符——实现速度非常慢（对于大量数据）。

我没有对此进行过多分析，所以它也可能是由于没有正确使用 ostreams 造成的，或者仅仅是由于记录到磁盘的数据量很大。（由于性能问题，该课程已被废弃，并且在实践中首选 printf / fmtmsg 样式。）

我同意其他回答，在大多数情况下，这并不重要。如果输出确实是一个问题，您应该考虑避免/延迟它的方法，因为实际的显示更新通常比正确实施的字符串构建成本更高。无论如何，在几毫秒内滚动的数千行信息并不是很丰富。

* * *

## 回答 #15

> 赞同：-6
> 
> 时间：2009-05-22T07:43:03.953

你**永远**不需要问这个问题，因为用户只能比他们两个都读得慢。

如果您需要快速执行，请不要使用任何一种。

正如其他人所提到的，如果您需要操作记录，请使用某种日志记录。

# iphone - iPhone sdk 3.0 问题

> ID：896659
> 
> 赞同：0
> 
> 时间：2009-05-22T06:58:12.143
> 
> 标签：iphone, objective-c

我将 maxlength 设置为我的 textField，当我在 textField 中输入最大字符时，退格键不起作用。因此，我无法更改 textFields 内容。当我在 iPhone sdk 3.0 上测试我的应用程序时会发生这种情况，但它在 iPhone sdk 2.2 中可以正常工作。

这是我的代码，

```
- (BOOL)textField:(UITextField *)txtField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string
{
    if (txtField.text.length >= 15 && range.length == 0)
    {
        return NO; 
    }
    else
    {
        return YES;
    }
} 
```

为什么它发生在 iPhone sdk 3.0 中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T16:31:39.317

在我的脑海中，退格字符将返回 true，因此当用户在全文字段上点击退格时`range.length == 0`，您将明确返回。`NO`我建议将第一个条件更改为：

```
if ( txtField.text.length + range.length > 15 )
    return ( NO ); 
```

...这样您就可以测试*修改后*的字符串是否太大而无法容纳（而不是仅检查现有值和添加的各个大小），并且您不会与 OS 3.0 中的新粘贴代码发生冲突一次可以向文本字段添加多个字符。

# asp.net - 将 XMLDataSource 绑定到 HTTP 处理程序

> ID：896662
> 
> 赞同：1
> 
> 时间：2009-05-22T07:00:17.990
> 
> 标签：asp.net, httphandler, ihttphandler, ashx, xmldatasource

我有一些动态生成的 XML 数据将被少数消费者使用（一个 ASPX 页面、一个 flash 文件，也许还有另一个）。

我已将其实现为自定义处理程序。我在处理程序中构造 XML 并使用 response.write 将其输出。

现在，如果我将 XMLDataSource 的 DataFile 属性设置为处理程序，它会尝试逐字读取 ashx 文件，而不是通过 HTTP 调用它。

有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T07:22:43.943

将您的 XML 生成代码放在一个单独的类中。让处理程序使用该类来创建 XML 并将结果发送到客户端（顺便说一句，不要使用 Response.Write 你首先使用什么 XML 文档技术来构建 XML？）。

确保该类可以将完整的 XML 公开为字符串。

在您的 ASPX 页面中，使用相同的类并将 XML 字符串分配给 XmlDataSource 控件的数据属性。

**编辑**：

由于您使用的是 XmlTextWriter 并且从您的评论来看，上面显然有点令人困惑，我将添加这些详细信息。

您需要获取当前生成 XML 的代码并将其放在 App_Code 文件夹中的一个类中（或者可能在一个 dll 项目中）。此类将有一个将 XmlTextWriter 作为参数的方法。

```
public class XmlCreator
{
    public void GenerateXml(XmlTextWriter writer)
    {
         //All your code that writes the XML
    }
} 
```

在您的处理程序中，您将拥有以下代码：-

```
XmlTextWriter writer = new XmlTextWriter(Response.OutputStream, Encoding.UTF8);
XmlCreator creator = new XmlCreator();
XmlCreator.GenerateXml(writer); 
```

注意不需要 Response.Write ，这样可以正确完成编码。

在您使用的 ASP.NET 页面中：-

```
StringWriter source = new StringWriter();
XmlTextWriter writer = new XmlTextWriter(source, Encoding.Unicode);
XmlCreator creator = new XmlCreator();
XmlCreator.GenerateXml(writer);

yourXmlDataSource.Data = source.ToString(); 
```

XmlCreator 可能不需要实例化，在这种情况下您可以使用静态类，这取决于需要哪些其他数据来提供 XM 生成。

# resize - 在 Xul 中调整窗口大小

> ID：896663
> 
> 赞同：1
> 
> 时间：2009-05-22T07:00:27.647
> 
> 标签：resize, window, xul

谁能告诉我如何在 XUL 中调整窗口大小。我尝试调整大小但它不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T15:11:14.597

要使窗口手动调整大小，您可以使用您尝试过的 - 'resizable'

```
var myWin = window.openDialog('chrome://myapp/content/mywindow.xul','mywindow','centerscreen,chrome,resizable,dialog=no',{}); 
```

要以编程方式调整其大小，请尝试使用[ResizeTo](https://developer.mozilla.org/En/DOM/Window.resizeTo)或[ResizeBy函数](https://developer.mozilla.org/en/Window.resizeBy)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T07:13:50.123

[调整大小（宽度，高度）](http://xul-app.hp.infoseek.co.jp/xultu-janit/elemref/ref_XULWindow.html)

# asp.net - Visual Studio 重构 - 将类移至程序集

> ID：896669
> 
> 赞同：2
> 
> 时间：2009-05-22T07:01:37.863
> 
> 标签：asp.net, visual-studio, class, refactoring, rename

我正在寻找最简单（也是最完整）的机制来将一个类从一个具有引用（依赖性）修复能力的程序集移动到另一个程序集。我知道一些手动方法可以做到这一点： - 使用内置的移动重命名，然后剪切粘贴, 多次保存... - 使用 resharper 重命名命名空间, cutpaste , 同上

但问题与那些相同：在 Web 环境（即 ASP.Net）中，几乎所有引用（例如，对于用户控件，让我们假设在虚拟路径提供程序场景的路径中使用程序集名称）都被编码为字符串引用（更不用说配置文件和其他外部引用源） - 不幸的是，即使 resharper 也没有找到全部。其他问题是设计器文件 - 您知道它们是根据控制规范至少在保存操作时生成的，有时它们会以某种方式与重命名操作混合在一起，我的意思是这是旧的，有新的程序集名称等。

在此先感谢，尼古拉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-26T00:03:26.960

如果您使用 Resharper，请尝试[测试驱动开发](http://code.google.com/p/resharper-tdd-productivity-plugin/)

它允许许多这样的重构。

# grails - 具有 1:N 关系的 Grails GORM MissingMethodException

> ID：896683
> 
> 赞同：1
> 
> 时间：2009-05-22T07:09:46.057
> 
> 标签：grails, groovy, grails-orm

我有这样的域类：

```
class ServicesGroup {
    Long id
    String name
    String description

    String toString(){
        return name
    }

    static mapping = {
        version false
        table 'root.services_groups'

        id column:'group_id' 
        name column:'group_name'
        description column:'group_desc'
    }
} 
```

和

```
class Step {
    Long id
    ServicesGroup service
    String stepType
    Integer stepFrom
    Integer stepTo

    static constraints = {
        stepType(inList:['operator', 'client'])
    }

    static mapping = {
        version false
        table 'bill.steps'
        service column:'service_group_id'
    }
} 
```

关系是 - 一个 ServicesGroup 条目可以有多个 Step 实例。

但是，当在我的控制器中时，我尝试

```
Step.findByService(3) 
```

我得到：

```
"org.codehaus.groovy.runtime.InvokerInvocationException: groovy.lang.MissingMethodException: No signature of method: Step.findByService() is applicable for argument types: (java.lang.Integer) values: {3}" 
```

但是，当我更改 Step 域类字段时

```
ServicesGroup service 
```

简单地

```
Long service 
```

有用。

这里发生了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T12:00:31.767

试试这样：

```
Step.findByService(ServicesGroup.get(3)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T10:22:35.553

尝试

```
grails clean
grails run-app 
```

然后再试一次。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T14:01:19.603

Step.findByService([id: 3]) 之类的东西可能会起作用。无论如何，出于 SQL 生成的目的，它只关心 ID。在很多这样的情况下，您可以将假地图扔到那里而不是真实的地图，并为自己节省一些性能。

另一方面，当你这样做时，抽象会有点崩溃。

# language-agnostic - 对应的正确 OO 建模

> ID：896685
> 
> 赞同：3
> 
> 时间：2009-05-22T07:10:58.910
> 
> 标签：language-agnostic, oop, smalltalk

在我的编程中不断出现一些东西，那就是从某些角度来看，两件事是相同的，但从另一个角度来看是不同的。就像，假设您构建了一个由火车连接的火车站图，那么 Vertex 和 RailStation 类有时是相同的，有时则不是。

所以，想象一下我有一个非常代表火车站和火车的图表。然后我将此图交给另一个对象，该对象删除了一些顶点，然后我希望相应的火车站消失。

我不想让火车站成为顶点的“属性”，他们不是。此外，问题是对称的：如果我删除一个火车站，我希望相应的顶点消失。什么是建模或对应的正确OO方式。如果最终整体使用简单易行，我愿意通过编写一些支持方法或类来多走几英里。

我目前正在使用 Smalltalk 编程语言，但我认为这个问题并不是 smalltalk 特定的。我之所以提到它，是因为在 Smalltalk 中，您可以做一些很酷的技巧，例如检查调用堆栈，这在这种情况下可能会有所帮助。

**更新**：嗯，RailStations 不是顶点！他们是吗？

好的，让我们按照答案的要求考虑真实的代码。让我模拟一个有孩子的人。这是最简单的事情，对吧？孩子也应该知道他们的父母，所以我们就像一棵双环树。为了更容易从孩子中解散父母，我将父母和孩子之间的联系建模为关系，具有父母和孩子的属性。

所以，我可以实现 parent>>removeChild: 也许像这样

```
removeChild: aChild
    (parent relationshipWith: aChild) disband. 
```

因此，父母有一系列关系，而不是孩子。但每一种关系都*对应*一个孩子。现在我想做这样的事情：

```
parent children removeAllSuchThat: [:e | e age < 12] 
```

这应该删除关系*和*孩子。

在这里，关系和孩子在某种意义上是对应的。那么，我现在该怎么办？不要误会我的意思，我完全知道我可以在不引入关系类的情况下解决问题。但事实上，父母和孩子确实有共同的关系，那么为什么不建模并使用它来帮助解散双链接呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T07:24:54.363

在您的问题域中，站不是一种顶点吗？在这种情况下，为什么不从 Vertex 派生 Station？

请注意“在您的问题域中”这个短语的使用。您的问题似乎与图表中出现的火车站有关。所以是的，在那个领域，站是顶点。如果它是一个不同的问题域，比如火车站架构的数据库，它们很可能不是。大多数现代语言都支持命名空间的一些概念，以允许您在不同的域中拥有具有相同名称的不同类型的实体。

关于您的父母/孩子问题，您再次过于笼统。如果我正在对数学表达式和子表达式进行建模，如果我删除一个父项，我会想要删除并删除/释放所有子表达式。OTOH，ff我在英国人口中模拟法律责任关系，然后当责任解除（比如因为离婚）时，我只想删除这种关系，而不是删除/释放有自己独立存在的孩子.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T08:14:00.490

根据您对问题的描述，您有站点与顶点的一一对应关系，删除站点应自动删除相应的顶点（反之亦然）。您还提到了构建“由火车连接的火车站图”，您显然是指一个图，其中车站是顶点，火车是边。

那么，车站在什么方面*不*顶点呢？如果站只作为一个顶点不存在，并且如果一个顶点只作为一个站不存在，那么你认为将它们保持为两个不同但链接的实体有什么好处？

据我了解您的情况，station-isa-vertex 和继承是建模的方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T07:25:03.037

似乎您只是希望 RailStation 从 Vertex 继承（是关系）。请参阅这个关于继承的[smalltalk 教程。](http://www.inf.ufsc.br/poo/smalltalk/ibm/tutorial/chap6.html)这样，如果您有 RailStations 图，则用于（通常）处理顶点图的对象将自然地处理事情。

如果这种方法不起作用，请更具体（最好使用真实代码）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T08:40:14.057

拥有一个关系对象是个好主意。

我认为这里的适当问题是“应该使用它？”。

可能 Parent 和 Child 类正在扩展同一个 Person 超类，因此它们将具有一些共同的属性，例如年龄。

在我的想法中，我可以看到以下内容：父对象和子对象必须相互了解，因此两个类都必须保持到同一个关系的链接。关系对象在单个父对象和一定数量的子对象之间保持一对多的关系，并且它会保持对每个 Person 对象的引用。

通过这种方式，您可以在 Relationshp 对象中实现整个解散逻辑，或多或少如您所愿。您可以查询关系对象以了解哪些家庭成员符合您做某事的要求。您可以使关系安全地解散（和销毁），因为它会知道所有成员并要求他们破坏引用，然后它会准备好销毁，或要求某些成员离开家庭，保留关系对象活。

但这还不是全部。关系应该是真正的超类，由 HierarchicalRelationship 和 PeerRelationship（或 FriendRelationship）扩展。

这种专业化使您可以让 Parent(s) 和 Child(ren) 以完全遍历的方式链接其他层次结构。

这背后的真正概念是，您的关系对象是以可扩展和结构化的方式查询和组织整个 Person 对象（或 Vertex 对象）的关键，因此您最终获得的整个数据域在任何意义上都是可用的比如，你是想解散团体还是在他们之间走一条特定的路径（或铁路）。

很抱歉有大量的隐喻。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-03T11:54:20.297

看看名望，见[http://www.squeaksource.com/Fame.html](http://www.squeaksource.com/Fame.html)

当您添加或删除元素时，我们使用一个专门的子类`Collection`来更新另一端。此外，您可以使用 pragma 注释您的类以注释关系。Fame 框架使用这些 pragma 来做各种好事。

# html - 通过继承的css对齐复选框？

> ID：896689
> 
> 赞同：0
> 
> 时间：2009-05-22T07:12:52.667
> 
> 标签：html, css

我有一个 php 页面，它启动一个弹出窗口，其中包含一个带有复选框的表单。原始窗口包括一个外部样式表。

弹出窗口的 html 表单是：

```
<form name="statusForm" action="post.php=" method="post" enctype="multipart/form-data">
<label for="Test">Test:</label>
<input name="checkboxes[]" value="Test" type="checkbox">
<br>
<label for="Test">TestTest:</label>
<input name="checkboxes[]" value="Test" type="checkbox">
<br>
<label for="Test">TestTestTest:</label>
<input name="checkboxes[]" value="Test" type="checkbox">
<br>
<input name="Submit" value="submit" type="submit">
</form> 
```

表单已被修剪，并重命名字段以测试发布..

在外部样式表中，我有：

```
label {
    min-width: 5em;
} 
```

复选框仍未对齐。我是否必须在弹出窗口的 html 中明确包含样式表，还是其他？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T07:18:16.153

新窗口不会从其父窗口继承任何样式表规则。

此外，如果您使用的是 Firefox，我强烈建议您安装[Firebug](http://getfirebug.com/)扩展，这将允许您“检查”HTML 元素以查看（甚至修改）活动的 CSS 规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T07:17:11.503

是的，弹出窗口需要是它自己的完整 HTML 页面。

* * *

编辑

除非它是一个 AJAX 弹出窗口，在这种情况下它不需要是一个完整的 HTML 页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T12:04:05.660

请记住，Internet Explorer 6 不支持 min-width。此外，我会使用一些分隔元素，例如`<div>`or `<li>`（在 an 内`<ul>`）而不是 a `<br />`。

富有的

# php - 新手问题——将多个.sql脚本调用到PHP文件中

> ID：896698
> 
> 赞同：1
> 
> 时间：2009-05-22T07:17:51.520
> 
> 标签：php, mysql

我有一个执行多个 sql 脚本的 PHP 文件。我发现前两个脚本执行，但后两个似乎从未完成。我在他们自己的 PHP 文件中分别测试了最后两个脚本并且脚本工作，所以我想知道这是否是因为我在我的 PHP 脚本中进行的 exec() 调用的数量。有什么建议么？这是原始脚本：

```
<?php
session_start();

$host = "localhost"; 
$user = "user"; 
$pass = "pass"; 
$database = "database"; 

$linkID = mysql_connect($host, $user, $pass) or die("Could not connect to host."); 
mysql_select_db($database, $linkID) or die("Could not find database."); 

$query = sprintf("SELECT dbName FROM users where userName='%s'",
   $_SESSION['MM_Username']); 
$resultID = mysql_query($query) or die("Data not found."); 

list($dbName)= mysql_fetch_row($resultID);

exec("mysql -u user -ppassword ".$dbName." < ../scripts/makeTblFinalAnalysis.sql"); 
exec("mysql -u user -ppassword ".$dbName." < ../scripts/tblFinalDetailed.sql");
exec("mysql -u user -ppassword ".$dbName." < ../scripts/TblGridViews.sql");
exec("mysql -u user -ppassword ".$dbName." < ../scripts/makeTblGeo.sql");
header( 'Location: dashboards/dashboard.html' ) ;
exit;
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T07:24:01.540

您可能会用完执行时间吗？脚本运行需要多长时间？

在 PHP 文档中查找`set_time_limit()`；如果它们需要一段时间才能运行，您将需要提高 PHP 执行超时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T07:24:16.343

“但最后两个似乎永远不会完成。” 也许是因为前两个脚本上的一些锁，第三个脚本死锁了？您可以尝试在您的 sql server 上同时执行这 4 个脚本，以检查它是否成功执行并提交更改。还发布 sql 查询可能会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T09:03:14.760

尝试将所有 exec 加入 shell 脚本并运行它。然后尝试在后台运行它。但是 PHP 不会等待脚本返回。

```
exec("nohup sqlRoutines.sh > /dev/null 2>&1 &"); 
```

这会将脚本从调用进程中分离出来，并将 stdout 和 stderr 重定向到无处（或者如果你想要的话，也可以重定向到日志文件......）。

# c# - 如何更新 CDATA 中的文本

> ID：896701
> 
> 赞同：1
> 
> 时间：2009-05-22T07:19:35.993
> 
> 标签：c#, .net, cdata, xmlnode

我想替换 cdata 部分中的文本，但是当我只是尝试向其中添加文本时，我丢失了 CDATA 定义。

我有一个这样的 XML：

```
<title><![CDATA[string]]></title> 
```

当我尝试使用新值更新此字段时：

```
myXmlNode.SelectSingleNode("title").InnerText = TextBoxName.Text; 
```

输出是

```
<title>string</title> 
```

如何将其保留为 CDATA？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T07:26:57.980

标题元素将有一个 CData 子元素，需要像这样进行转换：-

```
 ((XmlCDataSection)myXmlNode.SelectSingleNode("title").FirstChild).Value = TextBoxName.Text 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T07:41:20.073

我会做：

```
myXmlNode.SelectSingleNode("title").FirstChild.InnerText = TextBoxName.Text; 
```

这样您就不必在代码中处理 CDATA 格式（编辑：硬编码 <![CDATA[ 无论如何都不起作用，正如 Anthony 所指出的那样）

# resharper - 如何最简单地重命名|为我的班级中的所有成员应用命名样式|命名空间

> ID：896704
> 
> 赞同：1
> 
> 时间：2009-05-22T07:22:00.733
> 
> 标签：resharper

我们已经开始使用 Resharper 4.5 和它附带的命名风格功能。应用命名样式有一些繁琐的工作。

我想要的是应用我的命名样式或它的一部分作为我的代码清理配置文件的一部分。

Any1知道怎么做，或者至少比垃圾邮件+ PgDown，++更乏味？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T05:56:40.947

遗留代码不值得花时间。我建议您开始为新代码使用新样式并慢慢迁移现有代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T07:55:37.347

VisualAssist 可能会极大地帮助您重命名/重构（试用版可以从[http://www.wholetomato.com](http://www.wholetomato.com)下载）。但这并不是强制执行您的编码准则的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T07:51:10.333

宏是我的建议，你应该能够用宏来处理这个问题。

# ruby - 扩展红宝石对象；extend_object 回调防止实例方法被扩展

> ID：896714
> 
> 赞同：2
> 
> 时间：2009-05-22T07:24:57.047
> 
> 标签：ruby, object, module, extend

使用模块扩展对象实例时遇到一些麻烦，特别是当我在 Module 类中定义 extend_object 回调时。我的理解是，当您执行以下操作时：

(s = String.new).extend SomeModule

调用 SomeModule extend_object 回调。情况似乎是这样，但是当我包含回调时， SomeModule 中定义的实例方法在对象中都不可见。一些代码应该更好地解释这一点：

```
module M1
  def self.extend_object(o)
  end

  def test_method
    true
  end
end

module M2
  def test_method
    true
  end
end

(x = String.new).extend(M1)
(y = String.new).extend(M2) 
```

然后，

```
x.methods.include?("test_method")
=> false
y.methods.include?("test_method")
=> true 
```

进一步来说，

```
x.singleton_methods
=> []
y.singleton_methods
=> ["test_method"] 
```

有任何想法吗？

参考：

```
http://www.ruby-doc.org/core/classes/Module.html#M001660
http://www.ruby-doc.org/core/classes/Object.html#M000337 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-22T10:05:22.827

您应该使用`extended`回调而不是覆盖`extend_object`. 第一个在您的模块扩展对象时调用。调用后者来实际扩展对象。`included`这就像和之间的区别`append_features`。

这是一个例子：

```
module M1
  def self.extended(base)
    puts "extended object #{base.inspect}"
  end

  def test_method
    true
  end
end 
```

然后：

```
>> (x = String.new).extend(M1)
extended object ""
=> ""

>> x.methods.include?("test_method")
=> true 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T07:37:37.383

从同事那里得到了一些帮助，并意识到我需要打电话给`super`其他人，这是一个问题。谢谢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-29T14:50:39.073

您还需要使用符号，因为方法名称是符号

```
module M1
  def self.extend_object(o)
    super
  end

  def test_method
    true
  end
end

(x = String.new).extend(M1)

x.methods.include?(:test_method)  #=> true 
```

# java - java (Android) 中的 URLEncoder 编码 / URLDecoder 解码

> ID：896721
> 
> 赞同：16
> 
> 时间：2009-05-22T07:27:18.120
> 
> 标签：java, android

我想在应用程序中使用 URLEncoder/URLDecoder 类 (java.net.URLEncoder/URLDecoder) 和方法：encode(String s, String enc)/decode(String s, String enc)，但我不知道是什么可以是字符串参数 enc 的值吗？我想在“x-www-form-urlencoded”MIME 内容类型中编码/解码。感谢您的帮助。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-22T07:34:19.650

encoding 参数是您正在使用的字符编码。`For example "UTF-8"`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-22T08:38:51.860

首先，您需要将内容类型设置为“x-www-form-urlencoded”。然后，无论您想编码什么内容，都使用“UTF-8”对其进行编码。

例如：

**将内容设置为“x-www-form-urlencoded”：**

```
URL url = new URL("http://www.xyz.com/SomeContext/SomeAction"); <br>
URLConnection urlConnection = url.openConnection();<br>
....<br>
....<br>
urlConnection.setRequestProperty("Content-type","application/x-www-form-urlencoded"); 
```

或者，如果您正在使用一些 JSP，那么您可以在其上编写以下内容。

```
<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %><br>
< META http-equiv="Content-Type" content="text/html; charset=UTF-8">

< FORM action="someaction.jsp" enctype="application/x-www-form-urlencoded" name="InputForm" method="POST"> 
```

**并使用 URLEncoder：**

```
String encodedString = URLEncoder.encode("hello","UTF-8"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T07:36:57.803

[JavaDoc](http://java.sun.com/j2se/1.4.2/docs/api/java/net/URLEncoder.html#encode(java.lang.String,%20java.lang.String))包含所有详细信息

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-09T16:12:12.177

`URLEncoder`两者`URLDecoder`都是例外`Throwable`，因此必须至少被 try/catch 块包围。然而，有一个更简单的方法使用`android.net.Uri`：

```
Uri.decode(string);
Uri.encode(string); 
```

这些是静态方法，使用 utf-8，从 API-1 开始可用并且不抛出异常。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-01-29T09:20:02.677

我个人最喜欢的：

```
static String baseNameFromURL(URL url) {
    String shortName;
    String path = url.getPath();
    String escaped = path.substring(path.lastIndexOf('/') + 1);
    try {
        shortName = URLDecoder.decode(escaped, "UTF-8");
    } catch (UnsupportedEncodingException e) {
        throw new Error(e.getMessage(), e);
    }
    int period = shortName.lastIndexOf('.');
    return period > -1 ? shortName.substring(0, period) : shortName;
} 
```

如果 URL 没有文件名部分，例如`https://stackoverflow.com/`or ，则返回一个空字符串`https://stackoverflow.com/questions/`。如果文件名部分有反斜杠，则保留。

如果您需要带有扩展名的短名称，则可以去掉最后两行。

# forms - 如何在表单提交时打开一个新窗口

> ID：896724
> 
> 赞同：153
> 
> 时间：2009-05-22T07:30:19.423
> 
> 标签：forms, submit

我有一个提交表单，并希望它在用户提交表单时打开一个新窗口，以便我可以在分析中对其进行跟踪。

这是我正在使用的代码：

```
<form action="http://URL at mailchimp subscriber URL.com" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" onclick=window.open(google.html,'','scrollbars=no,menubar=no,height=600,width=800,resizable=yes,toolbar=no,status=no');>
    <label for="name">Your Name</label><input type="text" value="" name="FNAME" class="required" id="mce-FNAME">
    <br/>
    <br/>
    <label for="email">Your Email </label><input type="text" value="" name="EMAIL" class="required email" id="mce-EMAIL">
    <br/>
    <br/>
    <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="submit">
</form>
</div> 
```

* * *

## 回答 #1

> 赞同：314
> 
> 时间：2009-05-22T07:34:11.103

不需要 Javascript，您只需`target="_blank"`在表单标签中添加一个属性。

```
<form target="_blank" action="http://example.com"
      method="post" id="mc-embedded-subscribe-form"
      name="mc-embedded-subscribe-form" class="validate"
> 
```

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2016-02-15T23:54:04.083

在一个基于 Web 的数据库应用程序中，它使用弹出窗口来显示数据库数据的打印输出，这足以满足我们的需求（在 Chrome 48 中测试）：

```
<form method="post" 
      target="print_popup" 
      action="/myFormProcessorInNewWindow.aspx"
      onsubmit="window.open('about:blank','print_popup','width=1000,height=800');"> 
```

诀窍是将标记`target`上的属性与处理程序调用中`<form>`的第二个参数相匹配。`window.open``onsubmit`

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2016-03-18T16:37:32.903

为了与表单的`target`属性类似的效果，您还可以使用or的`formtarget`属性。`input[type="submit]"``button[type="submit"]`

来自[MDN](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input)：

> ...此属性是一个名称或关键字，指示在哪里显示提交表单后收到的响应。这是浏览上下文（例如，选项卡、窗口或内联框架）的名称或关键字。如果指定了此属性，它将覆盖元素表单所有者的目标属性。以下关键字具有特殊含义：
> 
> *   _self：将响应加载到与当前响应相同的浏览上下文中。如果未指定该属性，则此值为默认值。
> *   _blank：将响应加载到新的未命名浏览上下文中。
> *   _parent：将响应加载到当前浏览器的父浏览上下文中。如果没有父级，则此选项的行为方式与 _self 相同。
> *   _top：将响应加载到顶级浏览上下文（即当前浏览上下文的祖先，并且没有父浏览上下文）。如果没有父级，则此选项的行为方式与 _self 相同。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-05-22T14:37:40.250

`onclick`可能不是将该操作附加到的最佳事件。任何时候任何人点击表格中的任何地方，它都会打开窗口。

```
<form action="..." ...
    onsubmit="window.open('google.html', '_blank', 'scrollbars=no,menubar=no,height=600,width=800,resizable=yes,toolbar=no,status=no');return true;"> 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-22T07:43:43.063

您提供的代码需要更正。在表单标记中，您必须将 onClick 属性值括在双引号中：

`"window.open('google.htm','','scrollbars=no,menubar=no,height=600,width=800,resizable=yes,toolbar=no,status=no');"`

您还需要注意第一个参数 of`window.open`也应该用引号括起来。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-11-27T16:20:22.520

我通常在全局范围内使用一个小的 jQuery 代码片段在新选项卡/窗口中打开任何外部链接。我已经为我自己的网站添加了一个表单的选择器，到目前为止它工作正常：

```
// URL target
    $('a[href*="//"]:not([href*="'+ location.hostname +'"]),form[action*="//"]:not([href*="'+ location.hostname +'"]').attr('target','_blank'); 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2019-08-28T07:10:06.127

我相信这个 jquery 很适合你，请检查下面的代码。

这将使您的提交操作有效并在新选项卡中打开一个链接，无论您是想再次打开操作网址还是新链接

```
jQuery('form').on('submit',function(e){
setTimeout(function () { window.open('https://www.google.com','_blank');}, 1000);});}) 
```

这段代码对我来说完美..

* * *

## 回答 #8

> 赞同：-4
> 
> 时间：2009-05-22T07:34:11.587

`window.open`不适用于所有浏览器，谷歌它，你会找到一种检测正确对话框类型的方法。

此外，将 onclick 调用移动到输入按钮，使其仅在用户提交时触发。

* * *

## 回答 #9

> 赞同：-12
> 
> 时间：2013-09-12T04:29:09.947

我也找到了解决方案。这个页面今天帮助了我，所以我也在这里重新发布。

```
/** This is the script that will redraw current screen and submit to paypal. */
echo '<script>'."\n" ;
echo 'function serverNotifySelected()'."\n" ;
echo '{'."\n" ;
echo '    window.open(\'\', \'PayPalPayment\');'."\n" ;
echo '    document.forms[\'paypal_form\'].submit();'."\n" ;
echo '    document.forms[\'server_responder\'].submit();'."\n" ;
echo '}'."\n" ;
echo '</script>'."\n" ;

/** This form will be opened in a new window called PayPalPayment. */
echo '<form action="https://www.sandbox.paypal.com/cgi-bin/webscr" name="paypal_form" method="post" target="PayPalPayment">'."\n" ;
echo '<input type="hidden" name="cmd" value="_s-xclick">'."\n" ;
echo '<input type="hidden" name="custom" value="'.$transaction_start.'">'."\n" ;
echo '<input type="hidden" name="hosted_button_id" value="'.$single_product->hosted_button_id.'">'."\n" ;
echo '<table>'."\n" ;
echo '    <tr>'."\n";
echo '        <td><input type="hidden" name="'.$single_product->hide_name_a.'" value="'.$single_product->hide_value_a.'">Local</td>'."\n" ;
echo '    </tr>'."\n" ;
echo '    <tr>'."\n" ;
echo '        <td>'."\n" ;
echo '        <input type="hidden" name="'.$single_product->hide_name_b.'" value="'.$single_product->hide_value_b.'" />'.$single_product->short_desc.' $'.$adj_price.' USD'."\n" ;
                // <select name="os0">
                //     <option value="1 Day">1 Day $1.55 USD</option>
                //     <option value="All Day">All Day $7.50 USD</option>
                //     <option value="3 Day">3 Day $23.00 USD</option>
                //     <option value="31 Day">31 Day $107.00 USD</option>
                // </select>
echo '        </td>'."\n" ;
echo '    </tr>'."\n" ;
echo '</table>'."\n" ;
echo '<input type="hidden" name="currency_code" value="USD">'."\n" ;
echo '</form>'."\n" ;

/** This form will redraw the current page for approval. */
echo '<form action="ProductApprove.php" name="server_responder" method="post" target="_top">'."\n" ;
echo '<input type="hidden" name="trans" value="'.$transaction_start.'">'."\n" ;
echo '<input type="hidden" name="prod_id" value="'.$this->product_id.'">'."\n" ;
echo '</form>'."\n" ;

/** No form here just an input and a button.  onClick will handle all the forms */
echo '<input type="image" src="https://www.sandbox.paypal.com/en_US/i/btn/btn_buynowCC_LG.gif" border="0" alt="PayPal - The safer, easier way to pay online!" onclick="serverNotifySelected()">'."\n" ;
echo '<img alt="" border="0" src="https://www.sandbox.paypal.com/en_US/i/scr/pixel.gif" width="1" height="1">'."\n" ; 
```

上面的代码是一个按钮的代码。您按下按钮，它将重新绘制从购买到预先批准的当前屏幕。同时，它会打开一个新窗口并将新窗口交给 PayPal。

# php - 如何将 twitter api 与“http 基本身份验证”一起使用？

> ID：896728
> 
> 赞同：2
> 
> 时间：2009-05-22T07:32:03.570
> 
> 标签：php, api, authentication, twitter

如何将 twitter api 与“http 基本身份验证”一起使用？

我想我应该使用“消费者密钥”！因为 twitter 给了你每小时请求的限制率，如果我不使用我的消费者密钥，他们如何计算我的请求？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T08:04:35.767

每当您想对任何东西使用 HTTP 基本身份验证时，如果您想忽略实际的实现和 HTTP 标头，只需使用[cURL](http://us.php.net/curl)。这是 PHP 中的一个简单示例，cURL 也可以在其他语言中使用：

```
<?php
$ch = curl_init();
// Sets the URL cURL will open
curl_setopt($ch, CURLOPT_URL, 'http://twitter.com/statuses/user_timeline.xml?screen_name=al3x');
// Here's the HTTP auth
// The 3rd argument is your Twitter username and password joined with a colon
curl_setopt($ch, CURLOPT_USERPWD, 'username:password');
// Makes curl_exec() return server response
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
// Lately the Twitter API expects an Expect header. It's a mystery
curl_setopt($ch, CURLOPT_HTTPHEADER, array('Expect:'));
// And here's the result XML
$twitter_xml = curl_exec($ch);
curl_close($ch);
?> 
```

然后`$twitter_xml`将包含 al3x 的公共时间线的 XML。就速率限制而言，ceejayoz 已经很好地回答了这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T08:38:35.590

```
$twitter = file_get_content("http://user:password@twitter.com/blabla"); 
```

[更多关于 PHP 中的原生 HTTP Wrapper 支持](http://php.net/manual/en/wrappers.http.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T07:37:28.490

我认为他们会计算来自同一个 IP 的请求 - 但我没有仔细检查。

即使是动态 IP 地址对于会话来说也是静态的，并且在没有任何其他识别信息的情况下，唯一可以将您与其他用户区分开来的东西。

正如其他海报所说 - 如果你有钥匙，有更好的方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T07:44:51.377

经过身份验证的 API GET 请求将计入​​您的用户帐户的计数中。

未经身份验证的 API GET 请求（某些方法允许）计入您的 IP 地址计数。

POST 请求不受速率限制。

[Twitter 文档中提供了更多详细信息。](http://apiwiki.twitter.com/Rate-limiting)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T07:47:59.017

我最近写了一些 PHP 来发布到 Twitter 这是它的工作部分：

```
$message = 'A new revision (#' . $data['revision'] . ') was commited by ' . $data['author'] . ': ' . $data['message'] . "";

$message = substr($message, 0, 140);

$content = 'status=' . urlencode($message);
$packetString = "POST /statuses/update.xml HTTP/1.1\r\n";
$packetString .= "Authorization: Basic " . base64_encode($username . ":" . $password) . "\r\n";
$packetString .= "Content-Length:" . strlen($content) . "\r\n";
$packetString .= "HOST: twitter.com\r\n";
$packetString .= "\r\n" . $content . "\r\n";

$sock = fsockopen('twitter.com', 80);
fwrite($sock, $packetString);
//This is some logging, to a local file so I can monitor local what's going on
$response = fread($sock, 10240);
fwrite($fh, $packetString . "\r\n\r\n\r\n" . trim($response) . "\r\n\r\n\r\nD:\r\n" . $d);
fclose($fh); 
```

您可以在此处看到它的实际效果：http: [//twitter.com/fmsvn](http://twitter.com/fmsvn) 使用来自我们 SVN 服务器的回调 我将 SVN 消息发布到项目 Twitter 提要。

# javascript - 在页面导航中传播开瓶器变量的最佳方式？

> ID：896743
> 
> 赞同：1
> 
> 时间：2009-05-22T07:42:06.203
> 
> 标签：javascript

我正在处理的应用程序有多个模块。有两个值得关注 - 主模块和我编写的模块。而且我必须在包含主模块的窗口上调用一个函数，问题是我必须不是从父 web 模块打开的页面调用该函数，而是从用户从该页面导航到的页面调用该函数。

基本上第一页只显示一些查询表单，让用户进行一些查询，第二页保存查询结果，我应该根据这些结果更新父页面的内容。

导航是这样的

*   主模块
*   我的模块的第一页（我将主模块页面作为`window.opener`变量。
*   我的模块的第二页（我希望能够在打开第一页的同一浏览器窗口中打开此页面）

而且我希望尽可能自由地导航——比如在新选项卡中打开查询结果、返回更改查询参数、进行新查询等。我还想在显示结果的页面上展示用户查询表单并让他们细化这个查询，仍然可以更新主模块。

我正在考虑以下解决方案：

1.  使用 AJAX 将查询结果加载到第一个窗口，但我希望这个应用程序尽可能简单，而 AJAX 并不简单；）
2.  在每个请求上生成新窗口并执行类似`var mainModule = opener.mainModule`. 这是邪恶的。
3.  将查询结果嵌入框架或 iframe，但我对如何将主模块窗口 javascript 变量注入框架或 iframe 有一点想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T10:34:22.563

如果能够在选项卡中导航是一项要求，我认为您必须放弃使用 JavaScript 打开的窗口系统的想法。因为在 Firefox、Safari 和大多数浏览器中，当您导航到不同的窗口时， opener 属性肯定会丢失。一个新标签扰乱了整洁的沙箱。

不是要求，根据您的评论，我认为您可以使用以下 3 种方法中的任何一种：

*   ***亲子***窗口交流——我接下来要讲的；
*   ***XMLHTTP 请求***（又名 AJAX）；或者
*   ***iFrames***（远程到服务器的旧方法:)

在这里，我将采用***Parent child 交流***的角度，因为您似乎最喜欢它。

1.  “子”窗口中的相互导航很容易。
    *   页面上的任何链接都加载到孩子中并共享相同的“开启者”。
    *   父母可以重新加载不同的页面，并共享同一个开启者。
2.  child 中会有一个**parent-listener 功能**；
3.  孩子将有一个单独的功能与父母**交谈。**
4.  父级将有一个或多**个子级侦听器**，具体取决于您的通用或具体需求。

我已经更新（不完全）我几年前写的一篇文章，让你玩转 windows 并实际进行最小的表单提交。通信警报相当冗长；但是您将毫无疑问地知道谁在向谁传达什么。第一个孩子很烦人地打开onload。但是页面上有一个链接可以将孩子更改为服务器生成的表单。

[JavaScript：超越父子窗口](http://bigeuniverse.com/tests/jsopener/JS-Beyond-Parent-Child-Windows.html)

* * *

示例代码片段：

一个***链接***：

```
<a href="page1.html" id="newwinlink">open a window from link</a> 
```

***链接监听器***：

事件侦听器和目标属性设置在文档的头部，在执行 onload 的 JavaScript 中：

```
var mywin; //global variable for best results

//XDOM - normalizes browser differences:
var openingLink = XDOM.getElementById('newwinlink');
openingLink.target = "newWin"; //important!

XDOM.addListener(openingLink, 'click', function(e){mywin=window.open('','newWin','width=400,height=400,resizable,scrollbars');if (!mywin.opener){mywin.opener = self;}return true}, false); 
```

***子文档 - 父监听器***：

```
function parentListener(pmsg) 
{
    alert("I'm the child, and I just received the following message from my parent:\n\n" + pmsg); 
} 
```

***子文档 - 与家长交谈***：

```
function talktoParent() 
{
    if (self.opener!=null) {
        opener.childListener("Hi from child window!");
    } else {
        alert("no opener... sorry, can't talk now");
    }
} 
```

***父文档 - 子监听器***：

```
function childListener(cmsg) 
{
    alert("I'm the parent. Just received the following message from my child:\n\n" + cmsg);
    //send back a message to the child, mywin...
    mywin.parentListener("Hi, back, from parent window!");
} 
```

这些很简单。但是您可以在上面提供的链接中看到服务器端回发与父级之间的开启者连续性、导航和通信。

不利的一面是，在另一个选项卡中打开其中任何一个都将失去与父级的连接。在我发送给您的页面上试一试。我相信孩子会提醒您它已与“***开启者***”断开连接。

随时提问，jb。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-23T02:52:35.983

iirc，即使您在 window.open 打开的窗口中离开原始文档，window.opener 仍然可用。

# sql - 想要使用 mysql 由于它们在表中的状态而选择记录

> ID：896747
> 
> 赞同：0
> 
> 时间：2009-05-22T07:43:41.770
> 
> 标签：sql, mysql, ruby-on-rails

早上好伙计们，我在选择数据库中所有非活动或活动记录时遇到问题，但如果我选择所有庄园和所有状态，它会返回所有庄园及其不同状态（活动或非活动），但如果我选择所有庄园和活动状态它返回所有庄园并显示它们都处于活动状态，不活动也是如此，但是当我选择所有庄园并且不活动时，我希望它显示所有不活动的庄园与活动相同。

我的代码是：

```
if estate_id == ''
  if current_user.is_admin?
    filter_estates = "e.id IS NOT NULL"
  elsif current_user.has_managing_agent?
    estates = current_user.business.approved_estates.collect{|e| e.id }
    filter_estates = "e.id IN (#{estates})"
  elsif current_user.estate_manager? || current_user.board_member?
    filter_estates = "e.id = #{current_user.estate_id}"
  end
else
  filter_estates = "e.id = #{estate_id}"
end   

if status == 'All status'
  filters_status = "select e.active"
elsif status == 'Inactive' 
  filters_status = "select * from estates e where e.active = false limit 1"
else
  filters_status = "select * from estates e where e.active = true limit 1" 
end
# Query the Database.
if estate_id == ''                            
@query = Estate.find_by_sql"SELECT (e.name) as estate_name, g.name as governing_body,"+
                           "(select count(*) from stands s where s.estate_id = e.id AND #{filter_estates}) as total_stands, "+
                           "(#{filters_status}) as estate_status, "+
                           "(select count(*) from services sp where sp.estate_id = e.id AND #{filter_estates}) as service_providers,"+
                           "(select count(*) from approved_vendors av where av.estate_id = e.id  AND #{filter_estates})as vendors"+
                           " FROM estates e LEFT JOIN governing_bodies g on e.governing_body_id = g.id AND #{filter_estates} " 
else
@query = Estate.find_by_sql"SELECT (e.name) as estate_name, "+
                           "(select g.name from governing_bodies g where e.governing_body_id = g.id AND #{filter_estates}) as governing_body ,"+
                           "(select count(*) from stands s where s.estate_id = e.id AND #{filter_estates}) as total_stands, "+
                           "(select e.active from estates e where e.active = true and e.id = #{estate_id}) as estate_status,"+
                           "(select count(*) from services sp where sp.estate_id = e.id AND #{filter_estates}) as service_providers,"+
                           "(select count(*) from approved_vendors av where av.estate_id = e.id  AND #{filter_estates})as vendors"+
                           " FROM estates e WHERE e.id = #{estate_id} group by e.name" 
```

我在 Rails 上使用 ruby​​，所以这段代码在模型中。

提前感谢您的帮助..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T15:09:12.743

礼貌地说，该代码非常“不好”。我认为您不了解 SQL 是如何工作的，这对于这种情况是一个重大障碍 - 抱歉，但没有必要粉饰 :-(

您需要将一些条件应用于整个查询，而不是仅错误地填充总体查询列的子查询。我还看到您试图将三个维度的数据塞进二维表的迹象。

无需为您重写代码，而是将其回归基础并生成最简单的查询，为您返回最简单的完整结果。例如，一个返回所有庄园的查询，一个返回所有活动庄园的查询，等等。您的 LEFT JOIN 似乎没问题，但是您需要在该主查询上添加一个额外的 WHERE 来选择活动/非活动行，而不是在子查询中进行。您还需要查看访问“支架”等的其他方法，因为您不能将它们塞入单个列中。就个人而言，我最初可能会在 WHERE 中加入，因为懒惰。

考虑这个不工作但伪 SQL 至少作为一种提示：

`select e.*, g.name FROM estates e, governing_bodies g WHERE g.id = e.governing_body_id AND e.active = true;`

这将只为您提供活跃的庄园和相关的Governing_body 名称。

# postgresql - Postgresql：如何使全文搜索忽略某些标记？

> ID：896752
> 
> 赞同：5
> 
> 时间：2009-05-22T07:46:26.787
> 
> 标签：postgresql, full-text-search

是否有一个魔术函数或运算符可以忽略某些标记？

```
select to_tsvector('the quick. brown fox') @@ 'brown' -- returns true

select to_tsvector('the quick,brown fox') @@ 'brown' -- returns true

select to_tsvector('the quick.brown fox') @@ 'brown' -- returns false, should return true

select to_tsvector('the quick/brown fox') @@ 'brown' -- returns false, should return true 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-22T15:00:25.290

恐怕你可能被卡住了。如果您通过 ts_debug 运行您的条款，您将看到“quick.brown”被解析为主机名，“quick/brown”被解析为文件系统路径。可悲的是，解析器真的没有那么聪明。

我唯一的建议是您预处理文本以将这些标记转换为空格。您可以轻松地在 plpgsql 中创建一个函数来执行此操作。

```
nicg=# select ts_debug('the quick.brown fox');
                              ts_debug
---------------------------------------------------------------------
 (asciiword,"Word, all ASCII",the,{english_stem},english_stem,{})
 (blank,"Space symbols"," ",{},,)
 (host,Host,quick.brown,{simple},simple,{quick.brown})
 (blank,"Space symbols"," ",{},,)
 (asciiword,"Word, all ASCII",fox,{english_stem},english_stem,{fox})
(5 rows) 
```

正如你从上面看到的，你没有得到快速和棕色的代币

# c# - C# 和正则表达式：如何提取引号之间的字符串

> ID：896770
> 
> 赞同：2
> 
> 时间：2009-05-22T07:52:23.267
> 
> 标签：c#, regex, parsing

假设我有以下字符串：

```
<脚本语言="javascript">
        var 联赛 = 新数组（
            "足球","德国 - 2\. 德甲","38542195","102","2009 年 5 月 24 日 14:00","2009 年 5 月 24 日 14:00","1X2","1","0"
        );
        var 匹配 = 新数组（
            "125","1.FC 纽伦堡 - TSV 1860 慕尼黑","2009 年 5 月 24 日 14:00","Sun, 24.05.09 14:00","1|1.40|4.10|6.40|-","|| ||","1|1.90|3.50|2.20|0:1","1|1.05|2.20|1.18|-","1|2.00||1.60|2.5","1|3.40|3.20|1.60| 2","1|1.70|2.50|5.50|-","||||-","1",
            "126","FC Ingolstadt 04 - TuS Koblenz","2009 年 5 月 24 日 14:00","Sun, 24.05.09 14:00","1|3.60|2.80|2.00|-","|||| ","||||:","1|1.68|1.25|1.26|-","1|1.90||1.70|2.5","1|3.10|3.10|1.70|2","1|3.60| 2.10|2.45|-","||||-","1",
            "127","FC St.Pauli 1910 - FSV 法兰克福","2009 年 5 月 24 日 14:00","周日 24.05.09 14:00","1|2.50|2.95|2.60|-","|| ||","||||:","1|1.41|1.44|1.28|-","1|2.00||1.60|2.5","1|3.40|3.20|1.60|2","1| 2.95|2.00|3.05|-","||||-","1",
            "128","MSV Duisburg - VfL Osnabruck","2009 年 5 月 24 日 14:00","周日 24.05.09 14:00","1|2.30|3.60|2.40|-","||||" ,"||||:","1|1.35|1.51|1.27|-","1|2.10||1.55|2.5","1|3.60|3.20|1.55|2","||||- ","||||-","1",
            "129","FSV 美因茨 05 - SC Rot-Weiss Oberhausen","2009 年 5 月 24 日 14:00","Sun, 24.05.09 14:00","1|1.40|3.80|7.00|-","| |||","1|1.95|3.50|2.50|0:1","1|1.05|2.50|1.18|-","1|2.00||1.60|2.5","1|3.40|3.20|1.60 |2","1|1.70|2.30|5.50|-","||||-","1",
            "130","Rot-Weiss Ahlen - SpVgg Greuther Furth","2009 年 5 月 24 日 14:00","Sun, 24.05.09 14:00","1|2.55|3.20|2.55|-","|| ||","||||:","1|1.42|1.42|1.28|-","1|2.10||1.55|2.5","1|3.60|3.20|1.55|2","1| 3.00|2.00|3.00|-","||||-","1",
            "131","SC Freiburg - 1.FC Kaiserslautern","2009 年 5 月 24 日 14:00","Sun, 24.05.09 14:00","1|1.75|3.25|4.20|-","||| |","||||:","1|1.17|1.91|1.24|-","1|2.10||1.55|2.5","1|3.60|3.20|1.55|2","1|2.30 |2.10|3.80|-","||||-","1",
            "132","SV Wehen Wiesbaden - FC Hansa Rostock","2009 年 5 月 24 日 14:00","Sun, 24.05.09 14:00","1|5.00|3.70|1.55|-","||| |","||||:","1|2.23|1.09|1.23|-","1|1.90||1.70|2.5","1|3.10|3.10|1.70|2","1|4.50 |2.25|2.00|-","||||-","1",
            "133","TSV Alemannia Aachen - FC Augsburg","2009 年 5 月 24 日 14:00","Sun, 24.05.09 14:00","1|1.60|3.45|5.10|-","|||| ","||||:","1|1.11|2.13|1.23|-","1|2.10||1.55|2.5","1|3.60|3.20|1.55|2","1|2.10| 2.20|4.30|-","||||-","1"
        );
        var events = showLeague（联赛，比赛）；
        hasEvents = hasEvents + 事件；
</脚本>

```

我想要做的是解析它读取“var 匹配”的部分并提取两个引号之间包含的任何内容。因此，所需的结果应该是一个包含以下内容的数组：

```
(0): 125
(1): 1.FC 纽伦堡 - TSV 1860 慕尼黑
(2)：2009年5月24日14:00
等等

```

**注意：我看到有人回答了类似的问题，但经过一段时间后，我无法让它发挥作用。谢谢！**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T08:25:55.443

请不要为此使用正则表达式，CSV 应由解析器处理。使用正则表达式执行此操作是最慢且最容易出错的方法。

这是一个现成的解析器：[codeproject.com: A Fast CSV Reader](http://www.codeproject.com/KB/database/CsvReader.aspx)。其他示例很容易找到，因为实现 CSV 解析器是一种流行的练习。

您还可以使用 OLEDB 内置解析器：[C# 教程 - 使用内置 OLEDB CSV 解析器](http://www.switchonthecode.com/tutorials/csharp-tutorial-using-the-built-in-oledb-csv-parser)。

在您的示例中，我将使用`IndexOf()`剪切和之间的字符串`"var matches = new Array("`，`");"`并将结果视为 CSV 字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T08:21:12.677

尝试以下操作：

```
using System.Text.RegularExpressions;

public static MatchCollection getMatches(String input, String pattern) {
   Regex re = new Regex(pattern);
   return re.Matches(input);
}

public static void Example() {
   String pattern1 = "var matches = new Array\\(([^\\)]+)\\)";

   MatchCollection results = getMatches(RandomTest, pattern1);
   String marray = results[0].Groups[1].Value;

   String pattern2 = "\"([^\"]+)\"";
   List<String> values = new List<String>();
   foreach (Match value in getMatches(marray,pattern2)) {
      //Your values are in the Groups property
      values.Add(value.Groups[1].Value);
      Console.WriteLine(value.Groups[1].Value);
   }
} 
```

第一个模式提取匹配数组，第二个模式获取该数组中的所有引用值

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T08:26:14.883

我将使用以下正则表达式模式来匹配整个数组内容：

```
"var matches = new Array\(\s+(.*?)\s+\)" 
```

...然后在逗号分隔符上执行 String.Split。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T08:06:23.907

我认为您需要删除开头和结尾的 " 并用 "," 分隔

```
string [] test=Regex.Split(s.SubString(1,s.length-2), "\",\""); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T10:32:51.677

如果您需要所有行的单个列表一起使用：

```
/// <returns>Returns all values inside matches array in a single list</returns>
        public static List<string> GetMatchesArray(String inputString)
        {
            // Matches var matches = new Array( ... );
            Regex r = new Regex("(var matches = new Array\\([^\\)]*\\);)",
                RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.Multiline);

            string arrayString = r.Match(inputString).Groups[0].Value;

            List<string> quotedList = new List<string>();

            // Matches all the data between the quotes inside var matches
            r = new Regex("\"([^\"]+)\"", RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.Multiline);
            for (Match m = r.Match(arrayString); m.Success; m = m.NextMatch())
            {
                quotedList.Add(m.Groups[1].Value);
            }

            return quotedList;
        } 
```

如果你想每行有一个单独的列表，你应该有一个行列表，并且在每个列表中你应该有一个引用文本的列表。下面的代码将做到这一点：

```
/// This will help you store the data in a list in a more meaningful way, 
/// so that you are able to organize the data per line
/// Returns all the quoted text per line in a list of lines
public static List<List<string>> GetMatchesArrayPerLine(String inputString)
{
    // Matches var matches = new Array( ... )
    Regex r = new Regex("(var matches = new Array\\([^\\)]*\\);)",
        RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.Multiline);

    string arrayString = r.Match(inputString).Groups[0].Value;

    List<string> lineList = new List<string>();

    // Matches all the lines and stores them in lineList one line per item. For e.g.
    // "125","1.FC Nurnberg - TSV 1860 Munich", ...
    // "126","FC Ingolstadt 04 - TuS Koblenz", ...
    r = new Regex("\n(.*)", RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.Multiline);
    for (Match m = r.Match(arrayString); m.Success; m = m.NextMatch())
    {
        lineList.Add(m.Groups[1].Value);
    }

    List<List<string>> quotedListPerLine = new List<List<string>>();

    // Matches the quoted text per line. 
    // This will help you store data in an organised way rather than just a list of values
    // Similar to a 2D array
    // quotedListPerLine[0] = List<string> containing { "125", "1.FC Nurnberg - TSV 1860 Munich", ... }
    // quotedListPerLine[1] = List<string> containing { "126","FC Ingolstadt 04 - TuS Koblenz", ... }
    r = new Regex("\"([^\"]+)\"", RegexOptions.IgnoreCase | RegexOptions.Compiled);
    foreach (string line in lineList)
    {
        List<string> quotedList = new List<string>();
        for (Match m = r.Match(line); m.Success; m = m.NextMatch())
        {
            quotedList.Add(m.Groups[1].Value);
        }
        quotedListPerLine.Add(quotedList);
    }

    return quotedListPerLine;
} 
```

为了您的方便，调用代码：

```
List<List<string>> quotedListLines = MyRegEx.GetMatchesArrayPerLine(a);
foreach (List<string> line in quotedListLines)
{
    Console.WriteLine("----LINE---");
    foreach (string quotedText in line)
        Console.WriteLine(quotedText);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T08:56:42.807

如果您真的想使用正则表达式，请尝试以下操作：

```
var matches = new Array\(\s*("(?:[^\\"]*|\\.)*"\s*(?:,\s*"(?:[^\\"]*|\\.)*")*)\s*\); 
```

那应该为您提供数组值列表。然后另一个正则表达式可以为您提供单个值：

```
"(?:[^\\"]*|\\.)*" 
```

但同样：在这种情况下使用正则表达式并不是那么有效。一个简单的 CSV 解析器会更好。

# jquery - 多表单验证

> ID：896775
> 
> 赞同：0
> 
> 时间：2009-05-22T07:54:06.523
> 
> 标签：jquery

如果所有 asp.net 控件都需要在一个表单中才能生成，那么如何在同一页面上使用带有多个表单的 jquery 验证插件？

我的意思是，我怎样才能让两个表单都包含可以通过 jquery 验证独立验证的 asp 控件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T12:32:23.123

验证所有这些：

```
$("form").validate(); 
```

...或仅具有特定类别的形式：

```
$("form.validateMe").validate(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-29T00:01:12.640

这里的问题是您首先需要两种形式。据我所知，ASP.NET 强制您将所有控件放在一个表单中。

所以根本不用在意验证。jQuery 验证会很容易（参见 Craig 的回答）。ASP.NET 中的两种形式是一个不同的故事。

您可能可以使用 iframe 或其他东西破解它，但我建议不要这样做。

# jquery - 如何删除 jQuery UI 对话框上的关闭按钮？

> ID：896777
> 
> 赞同：800
> 
> 时间：2009-05-22T07:55:41.027
> 
> 标签：jquery, html, css, jquery-ui, jquery-ui-dialog

如何删除由 jQuery UI 创建的对话框上的关闭按钮（右上角的**X ）？**

* * *

## 回答 #1

> 赞同：721
> 
> 时间：2009-05-22T11:20:08.167

我发现这最终奏效了（注意第三行覆盖了找到按钮并将其隐藏的打开函数）：

```
$("#div2").dialog({
    closeOnEscape: false,
    open: function(event, ui) {
        $(".ui-dialog-titlebar-close", ui.dialog || ui).hide();
    }
}); 
```

要隐藏所有对话框上的关闭按钮，您也可以使用以下 CSS：

```
.ui-dialog-titlebar-close {
    visibility: hidden;
} 
```

* * *

## 回答 #2

> 赞同：367
> 
> 时间：2011-03-14T16:10:46.413

这是另一个仅使用 CSS 的选项，它不会覆盖页面上的每个对话框。

CSS

```
.no-close .ui-dialog-titlebar-close {display: none } 
```

的HTML

```
<div class="selector" title="No close button">
    This is a test without a close button
</div> 
```

Javascript。

```
$( ".selector" ).dialog({ dialogClass: 'no-close' }); 
```

[工作示例](http://jsfiddle.net/djquery/AGZKF/)

* * *

## 回答 #3

> 赞同：126
> 
> 时间：2009-11-26T10:38:21.720

“最佳”答案不适用于多个对话。这是一个更好的解决方案。

```
open: function(event, ui) { 
    //hide close button.
    $(this).parent().children().children('.ui-dialog-titlebar-close').hide();
}, 
```

* * *

## 回答 #4

> 赞同：89
> 
> 时间：2009-05-22T07:58:52.143

您可以使用 CSS 而不是 JavaScript 来隐藏关闭按钮：

```
.ui-dialog-titlebar-close{
    display: none;
} 
```

如果您不想影响所有模式，您可以使用类似的规则

```
.hide-close-btn .ui-dialog-titlebar-close{
    display: none;
} 
```

并应用于`.hide-close-btn`对话框的顶部节点

* * *

## 回答 #5

> 赞同：51
> 
> 时间：2013-03-19T12:26:42.760

如官方[页面](http://api.jqueryui.com/dialog/)所示并由大卫建议：

创建样式：

```
.no-close .ui-dialog-titlebar-close {
    display: none;
} 
```

然后，您可以简单地将 no-close 类添加到任何对话框中以隐藏它的关闭按钮：

```
$( "#dialog" ).dialog({
    dialogClass: "no-close",
    buttons: [{
        text: "OK",
        click: function() {
            $( this ).dialog( "close" );
        }
    }]
}); 
```

* * *

## 回答 #6

> 赞同：42
> 
> 时间：2010-11-26T19:04:30.877

我认为这更好。

```
open: function(event, ui) {
  $(this).closest('.ui-dialog').find('.ui-dialog-titlebar-close').hide();
} 
```

* * *

## 回答 #7

> 赞同：36
> 
> 时间：2012-04-08T12:23:37.247

一旦你调用`.dialog()`了一个元素，你可以在任何方便的时候找到关闭按钮（和其他对话框标记），而无需使用事件处理程序：

```
$("#div2").dialog({                    // call .dialog method to create the dialog markup
    autoOpen: false
});
$("#div2").dialog("widget")            // get the dialog widget element
    .find(".ui-dialog-titlebar-close") // find the close button for this dialog
    .hide();                           // hide it 
```

替代方法：

在对话框事件处理程序内部，`this`指的是被“对话”的元素并`$(this).parent()`指的是对话框标记容器，因此：

```
$("#div3").dialog({
    open: function() {                         // open event handler
        $(this)                                // the element being dialogged
            .parent()                          // get the dialog widget element
            .find(".ui-dialog-titlebar-close") // find the close button for this dialog
            .hide();                           // hide it
    }
}); 
```

仅供参考，对话框标记如下所示：

```
<div class="ui-dialog ui-widget ui-widget-content ui-corner-all ui-draggable ui-resizable">
    <!-- ^--- this is the dialog widget -->
    <div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix">
        <span class="ui-dialog-title" id="ui-dialog-title-dialog">Dialog title</span>
        <a class="ui-dialog-titlebar-close ui-corner-all" href="#"><span class="ui-icon ui-icon-closethick">close</span></a>
    </div>
    <div id="div2" style="height: 200px; min-height: 200px; width: auto;" class="ui-dialog-content ui-widget-content">
        <!-- ^--- this is the element upon which .dialog() was called -->
    </div>
</div> 
```

[**演示在这里**](http://jsfiddle.net/salman/3r8fC/)

* * *

## 回答 #8

> 赞同：27
> 
> 时间：2012-04-12T08:17:45.677

Robert MacLean 的回答对我不起作用。

然而，这对我有用：

```
$("#div").dialog({
   open: function() { $(".ui-dialog-titlebar-close").hide(); }
}); 
```

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2010-05-13T11:26:14.600

```
$("#div2").dialog({
   closeOnEscape: false,
   open: function(event, ui) { $('#div2').parent().find('a.ui-dialog-titlebar-close').hide();}
}); 
```

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2012-02-20T01:40:54.370

以上都不起作用。真正有效的解决方案是：

```
$(function(){
  //this is your dialog:
  $('#mydiv').dialog({
    // Step 1\. Add an extra class to our dialog to address the dialog directly. Make sure that this class is not used anywhere else:
    dialogClass: 'my-extra-class' 
  })
  // Step 2\. Hide the close 'X' button on the dialog that you marked with your extra class
  $('.my-extra-class').find('.ui-dialog-titlebar-close').css('display','none');
  // Step 3\. Enjoy your dialog without the 'X' link
}) 
```

请检查它是否适合您。

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2011-02-02T16:45:12.647

隐藏按钮的最佳方法是使用它的 data-icon 属性对其进行过滤：

```
$('#dialog-id [data-icon="delete"]').hide(); 
```

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2009-12-10T09:59:57.707

我捕捉到对话框的关闭事件。然后，此代码删除`<div>`( `#dhx_combo_list`)：

```
open: function(event, ui) { 
  //hide close button.
  $(this).parent().children().children('.ui-dialog-titlebar-close').click(function(){
    $("#dhx_combo_list").remove();
  });
}, 
```

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2011-03-15T01:15:28.587

[http://jsfiddle.net/marcosfromero/aWyNn/](http://jsfiddle.net/marcosfromero/aWyNn/)

```
$('#yourdiv').                 // Get your box ...
  dialog().                    // ... and turn it into dialog (autoOpen: false also works)
  prev('.ui-dialog-titlebar'). // Get title bar,...
  find('a').                   // ... then get the X close button ...
  hide();                      // ... and hide it 
```

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2011-10-19T12:46:47.893

对于停用课程，短代码：

```
$(".ui-dialog-titlebar-close").hide(); 
```

可能用过了。

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2012-12-14T12:09:25.103

Dialog 小部件添加的关闭按钮具有类 'ui-dialog-titlebar-close'，因此在您初次调用 .dialog() 之后，您可以使用这样的语句再次删除关闭按钮：它可以工作..

```
$( 'a.ui-dialog-titlebar-close' ).remove(); 
```

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2013-05-23T12:23:05.767

```
$(".ui-button-icon-only").hide(); 
```

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2012-11-21T05:18:51.490

您还可以删除标题行：

`<div data-role="header">...</div>`

删除关闭按钮。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2018-06-13T11:28:55.790

实现的简单方法：（在您的 中执行此操作`Javascript`）

```
$("selector").dialog({
    autoOpen: false,
    open: function(event, ui) {   // It'll hide Close button
        $(".ui-dialog-titlebar-close", ui.dialog | ui).hide();
    },
    closeOnEscape: false,        // Do not close dialog on press Esc button
    show: {
        effect: "clip",
        duration: 500
    },
    hide: {
        effect: "blind",
        duration: 200
    },
    ....
}); 
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2014-10-22T06:37:29.597

```
document.querySelector('.ui-dialog-titlebar-close').style.display = 'none' 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2017-09-21T02:29:31.517

因为我发现我在我的应用程序的几个地方都这样做了，所以我将它包装在一个插件中：

```
(function ($) {
   $.fn.dialogNoClose = function () {
      return this.each(function () {
         // hide the close button and prevent ESC key from closing
         $(this).closest(".ui-dialog").find(".ui-dialog-titlebar-close").hide();
         $(this).dialog("option", "closeOnEscape", false);
      });
   };
})(jQuery) 
```

使用示例：

```
$("#dialog").dialog({ /* lots of options */ }).dialogNoClose(); 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2018-09-15T16:28:44.077

我是单线的粉丝（他们工作的地方！）。这对我有用：

```
$("#dialog").siblings(".ui-dialog-titlebar").find(".ui-dialog-titlebar-close").hide(); 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2019-04-12T08:39:10.513

使用这个纯 CSS 行怎么样？对于具有给定 ID 的对话框，我发现这是最干净的解决方案：

```
.ui-dialog[aria-describedby="IdValueOfDialog"] .ui-dialog-titlebar-close { display: none; } 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2020-12-08T20:23:13.943

这适用于 jQuery UI 1.12。我为“类”选项添加了以下配置设置

```
 classes: {
            'ui-dialog-titlebar-close': 'hidden',
        }, 
```

整个对话框初始化如下所示：

```
ConfirmarSiNo(titulo, texto, idPadre, fnCerrar) {
    const DATA_RETORNO = 'retval';
    $('confirmar-si-no').dialog({
        title: titulo,
        modal: true,
        classes: {
            'ui-dialog-titlebar-close': 'hidden',
        },
        appendTo: `#${idPadre}`,
        open: function fnOpen() { $(this).text(texto); },
        close: function fnClose() {
            let eligioSi = $(this).data(DATA_RETORNO) == true;
            setTimeout(function () { fnCerrar(eligioSi); }, 30);
        },
        buttons: {
            'Si, por favor': function si() { $(this).data(DATA_RETORNO, true); $(this).dialog("close"); },
            'No, gracias': function no() { $(this).data(DATA_RETORNO, false); $(this).dialog("close"); }
        }
    });
} 
```

我使用以下脚本调用来显示它：

```
ConfirmarSiNo('Titulo',
              '¿Desea actualizar?',
              idModalPadre,
              (eligioSi) => {
                            if (eligioSi) {
                                this.$tarifa.val(tarifa.tarifa);
                                this.__ActualizarTarifa(tarifa);
                            }
                        }); 
```

在 Html 正文中，我有以下包含对话框的 div：

```
<div class="modal" id="confirmar-si-no" title="" aria-labelledby="confirmacion-label">
    mensaje
</div> 
```

最终结果是：

[![在此处输入图像描述](https://i.stack.imgur.com/Rq3Rc.png)](https://i.stack.imgur.com/Rq3Rc.png)

功能“ConfirmarSiNo”基于帖子上的“ [Whome](https://stackoverflow.com/users/185565/whome) ”答案[如何在 Jquery UI 对话框中实现“确认”对话框？](https://stackoverflow.com/questions/887029/how-to-implement-confirmation-dialog-in-jquery-ui-dialog)

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2021-07-11T20:57:11.510

对于使用[DialogExtend](https://plugins.jquery.com/dialogextend/) `jQuery Extension`的用户，您可以使用该`closable`选项来管理此功能以及此不错的扩展提供的许多其他调整。

请注意，如果您已经在使用`DialogExtend`，则任何上述 Dialog CSS hack`DialogExtend`在初始化时都会被破坏。

* * *

## 回答 #25

> 赞同：-1
> 
> 时间：2017-03-27T07:49:07.793

您可以使用以下代码删除关闭按钮。还有其他选项可能对您有用。

```
$('#dialog-modal').dialog({
    //To hide the Close 'X' button
    "closeX": false,
    //To disable closing the pop up on escape
    "closeOnEscape": false,
    //To allow background scrolling
    "allowScrolling": true
    })
//To remove the whole title bar
.siblings('.ui-dialog-titlebar').remove(); 
```

# c# - 您使用什么规则来描述 MVP 方法和成员

> ID：896779
> 
> 赞同：0
> 
> 时间：2009-05-22T07:56:58.170
> 
> 标签：c#, java, design-patterns, mvp

在使用 MVP 模式时，我经常遇到方法和成员似乎不太适合 View 或 Presenter 类...我的问题是：您使用什么规则来决定哪些类的功能是什么？我对 MVP 比较陌生，所以请幽默。

TIA。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T14:15:12.383

我倾向于支持 MVP 的被动视图变体，所以这对我来说不是问题。在被动视图模式中，视图几乎将任何比简单分配更复杂的事情委托给演示者。

你最终得到一个看起来像这样的模式：

```
public class MyView: IView
{
    private MyPresenter Presenter;

    private OnEvent()
    {
        Presenter.DoSomething();
    }

    public string MyProperty
    {
        get{ return UIControl.Property;}
        set{ UIControl.Property = value}
    }
}

public interface IView
{
    public string MyProperty{ get; set;}
}

public class MyPresenter
{
    private IView view;

    public void DoSomething()
    {
        ...
        view.MyProperty = something;   
    }
} 
```

唯一的技巧部分是如果您的表单上有一个数据网格。这些需要大量工作才能适应被动视图模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T12:27:55.923

它归结为对 UI 进行了多少操作。如果该方法包含对单个控件的大量直接访问，那么它很可能属于演示者。否则它属于视图。目标是将视图和当前之间的交互减少到实现软件设计所需的最低限度。

例如

```
Presenter.SetListTitle MyList.Name
For I = View.MyListStart to View.MyListEnd
   Presenter.AddListItem MyList(I)
Next I
Presenter.ShowListAddBUtton
Presenter.ShowListDelButton 
```

应放置在演示者中，如下所示

```
Public Sub UpdateWithList(MyList as AList, View as AView)
  Me.SetListTitle MyList.Name
  For I = View.MyListStart to View.MyListEnd
     Me.AddListItem MyList(I)
  Next I
  Me.ShowListAddBUtton
  Me.ShowListDelButton
End Sub 
```

稍后，如果您决定更改 UI，您只需担心实现 UpdateWithList 而不是 SetListTitle、AddListItem 等。

# asp.net-mvc - ASP.NET MVC 向视图提供数据的最佳方法

> ID：896784
> 
> 赞同：0
> 
> 时间：2009-05-22T07:58:12.240
> 
> 标签：asp.net-mvc

我想向视图中的表提供数据。数据不仅来自数据库，还来自 csv 文件。

我应该将数据存储在 ViewData 中，还是应该将其存储在对象中并将其传递给视图？什么是最好的方法，或者我可以使用的任何其他方法？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T08:22:13.377

使用强类型视图并将对象直接传递给视图：

```
// Model (PersonRepository class)
public static Person Get(Int32 id) {
  using (MyContext context = new MyContext()) {
    Person p = context.Person.First(p => Person.id == id);
    return p;
  }
}

...

// Controller
public ActionResult Show(Int32 id) {
  return View(PersonsRepository.Get(id);
}

...

// View
<%@ Page Inherits="System.Web.Mvc.ViewPage<Models.Person>" Title="" Language="C#" %>

<asp:Content ID="Content1" ContentPlaceHolderID="TitleContent" runat="server">

  <%= Model.Id %> <br />
  <%= Model.Name %> <br />

</asp:Content> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T08:00:18.240

您应该创建一个模型对象，将来自异构源的数据填充到控制器中，然后将该模型传递给视图。

# disaster-recovery - 当出现问题时：良好的应急计划？

> ID：896785
> 
> 赞同：0
> 
> 时间：2009-05-22T07:58:14.347
> 
> 标签：disaster-recovery, contingency

我在一家技术技能/知识很少的小公司工作。

一位同事的硬盘在没有任何备份的情况下死机，而我们最近感染了我们的测试服务器（gumblar.cn），我们可能已将其转移到客户的服务器上，也可能没有。

在这两个事件之后，管理层围绕着宣传良好做法以避免未来再次发生，持续了大约一周的时间。

改变公司文化以更认真地对待这一点是我将尝试处理的一个问题，但我的问题是......

**应该计划哪些活动？**

我想有自然灾害，硬件故障，人们退出（公共汽车因素？）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T08:02:05.150

想一想您使用了哪些设备和服务，以及它们出现故障或暂时不可用的可能性有多大。建立一个列表。评估每个问题发生的可能性、您的成本以及备份解决方案的成本。然后你决定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T08:10:30.920

以下是一些常见的事情：

1.  容错服务器上的共享目录用作用户文件和数据的策略（具有适当的安全性）。事件=数据丢失​​限制
2.  服务器的计划备份。事件=数据丢失​​限制
3.  具有日志记录和入侵检测功能的防火墙代理。事件=数据损坏和盗窃
4.  部署在服务器和客户端上的企业病毒软件。事件=病毒感染、数据被盗、系统损坏
5.  自动化 IT 资产跟踪软件，报告服务器和客户端上发生的硬件和软件更改。事件=数据和硬件盗窃，未经授权的修改
6.  异地存储数据。事件=数据丢失​​限制
7.  消防设备和自动消防机制。事件=火灾
8.  Internet 过滤代理，例如 WebMarshall。事件=防止“偷渡”感染和风险。

等等等等。你应该可以在互联网上找到更全面的策略、措施等。

# c++ - 最准确的线交点坐标计算与浮点数？

> ID：896786
> 
> 赞同：5
> 
> 时间：2009-05-22T07:58:22.333
> 
> 标签：c++, c, optimization, math, numerical

我正在计算给定横坐标 x 线上的点的纵坐标 y。该线由其两个端点坐标 (x0,y0)(x1,y1) 定义。端点坐标是浮点数，必须以浮点精度进行计算才能在 GPU 中使用。

数学以及因此幼稚的实现是微不足道的。

让 t = (x - x0)/(x1 - x0)，然后 y = (1 - t) * y0 + t * y1 = y0 + t * (y1 - y0)。

问题是当 x1 - x0 很小时。结果将引入取消错误。当与 x - x0 之一结合时，在除法中，我预计 t 会出现重大错误。

问题是是否存在另一种更准确地确定 y 的方法？

即我应该先计算 (x - x0)*(y1 - y0)，然后除以 (x1 - x0) 吗？

y1 - y0 的差异总是很大。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T08:52:57.653

To a large degree, your underlying problem is fundamental. When (x1-x0) is small, it means there are only a few bits in the mantissa of x1 and x0 which differ. And by extension, there are only a limted number of floats between x0 and x1\. E.g. if only the lower 4 bits of the mantissa differ, there are at most 14 values between them.

In your best algorithm, the `t` term represents these lower bits. And to continue or example, if x0 and x1 differ by 4 bits, then t can take on only 16 values either. The calculation of these possible values is fairly robust. Whether you're calculating 3E0/14E0 or 3E-12/14E-12, the result is going to be close to the mathematical value of 3/14.

Your formula has the additional advantage of having y0 <= y <= y1, since 0 <= t <= 1

(I'm assuming that you know enough about float representations, and therefore "(x1-x0) is small" really means "small, relative to the values of x1 and x0 themselves". A difference of 1E-1 is small when x0=1E3 but large if x0=1E-6 )

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T10:11:08.260

You may have a look at Qt's "QLine" (if I remember it right) sources; they have implemented an intersection determination algorithm taken from one the "Graphics Gems" books (the reference must be in the code comments, the book was on EDonkey a couple of years ago), which, in turn, has some guarantees on applicability for a given screen resolution when calculations are performed with given bit-width (they use fixed-point arithmetics if I'm not wrong).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T08:10:02.980

如果您有可能这样做，您可以在计算中引入两种情况，具体取决于 abs(x1-x0) < abs(y1-y0)。在垂直情况下 abs(x1-x0) < abs(y1-y0)，从 y 计算 x 而不是从 x 计算 y。

编辑。另一种可能性是使用二分搜索的变体逐位获得结果。这会更慢，但在极端情况下可能会改善结果。

```
// Input is X
xmin = min(x0,x1);
xmax = max(x0,x1);
ymin = min(y0,y1);
ymax = max(y0,y1);
for (int i=0;i<20;i++) // get 20 bits in result
{
  xmid = (xmin+xmax)*0.5;
  ymid = (ymin+ymax)*0.5;
  if ( x < xmid ) { xmax = xmid; ymax = ymid; } // first half
  else { xmin = xmid; ymin = ymid; } // second half
}
// Output is some value in [ymin,ymax]
Y = ymin; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T09:35:35.740

I have implemented a benchmark program to compare the effect of the different expression.

I computed y using double precision and then compute y using single precision with different expressions.

Here are the expression tested:

```
inline double getYDbl( double x, double x0, double y0, double x1, double y1 )
{
    double const t = (x - x0)/(x1 - x0);
    return y0 + t*(y1 - y0);
} 

inline float getYFlt1( float x, float x0, float y0, float x1, float y1 )
{
    double const t = (x - x0)/(x1 - x0);
    return y0 + t*(y1 - y0);
} 

inline float getYFlt2( float x, float x0, float y0, float x1, float y1 )
{
    double const t = (x - x0)*(y1 - y0);
    return y0 + t/(x1 - x0);
} 

inline float getYFlt3( float x, float x0, float y0, float x1, float y1 )
{
    double const t = (y1 - y0)/(x1 - x0);
    return y0 + t*(x - x0);
} 

inline float getYFlt4( float x, float x0, float y0, float x1, float y1 )
{
    double const t = (x1 - x0)/(y1 - y0);
    return y0 + (x - x0)/t;
} 
```

I computed the average and stdDev of the difference between the double precision result and single precision result.

The result is that there is none on the average over 1000 and 10K random value sets. I used icc compiler with and without optimization as well as g++.

Note that I had to use the isnan() function to filter out bogus values. I suspect these result from underflow in the difference or division.

I don't know if the compilers rearrange the expression.

Anyway, the conclusion from this test is that the above rearrangements of the expression have no effect on the computation precision. The error remains the same (on average).

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T08:13:19.837

如果您的源数据已经是浮点数，那么您已经存在根本的不准确性。

为了进一步解释，想象一下您是否以图形方式执行此操作。您有一张 2D 方格纸，并标记了 2 个点。

案例1：这些点非常准确，并且已经用非常锋利的铅笔做了标记。很容易画出连接它们的线，然后很容易在给定 x 的情况下得到 y（反之亦然）。

Case 2: These point have been marked with a big fat felt tip pen, like a bingo marker. Clearly the line you draw will be less accurate. Do you go through the centre of the spots? The top edge? The bottom edge? Top of one, bottom of the other? Clearly there are many different options. If the two dots are close to each other then the variation will be even greater.

Floats have a certain level of inaccuracy inherent in them, due to the way they represent numbers, ergo they correspond more to case 2 than case 1 (which one could suggest is the equivalent of using an arbitrary precision librray). No algorithm in the world can compensate for that. Imprecise data in, Imprecise data out

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T08:20:30.213

Check if the distance between x0 and x1 is small, i.e. fabs(x1 - x0) < eps. Then the line is parallell to the y axis of the coordinate system, i.e. you can't calculuate the y values of that line **depending** on x. You have infinite many y values and therefore you have to treat this case differently.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-22T09:22:49.370

How about computing something like:

```
t = sign * power2 ( sqrt (abs(x - x0))/ sqrt (abs(x1 - x0))) 
```

The idea is to use a mathematical equivalent formula in which low (x1-x0) has less effect. (not sure if the one I wrote matches this criteria)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-22T11:22:51.267

As MSalters said, the problem is already in the original data.

Interpolation / extrapolation requires the slope, which already has low accuracy in the given conditions (worst for very short line segments far away from the origin).

Choice of algorithm canot regain this accuracy loss. My gut feeling is that the different evaluation order will not change things, as the error is introduced by the subtractions, not the devision.

* * *

**Idea:**
If you have more accurate data when the lines are generated, you can change the representation from ((x0, y0), (x1, y1)) to (x0,y0, angle, length). You could store angle or slope, slope has a pole, but angle requires trig functions... ugly.

Of course that won't work if you need the end point frequently, and you have so many lines that you can't store additional data, I have no idea. But maybe there is another representation that works well for your needs.

doubles have enough resolution in most situations, but that would double the working set too.

# java - Java：ServerSocket.accept 是线程安全的吗？

> ID：896789
> 
> 赞同：12
> 
> 时间：2009-05-22T07:59:54.483
> 
> 标签：java, multithreading, thread-safety

对于学校的一个项目，我们正在用 Java 5.0 制作一个多线程服务器。该项目以服务器的并发方面为中心。

我们有一些线程专门用于处理请求。为此，他们调用 ServerSocket.accept() 来接受新连接。我们的选择是启动一堆它们，让它们以两个线程不能同时接受（）同一个连接的假设来处理传入的连接。

但现在主要的问题是我们在 API 中找不到任何东西来保证我们的这种行为（或者我们看起来不正确），除了“它有效”的证明之外，我们什么也没有。

有没有人在java方法上寻找这种信息的来源？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-05-22T14:44:39.597

**简短**的回答：如果文档没有指定某些东西是线程安全的，那么您必须假设它不是。您需要自己进行线程之间的协调，以确保没有两个线程同时使用服务器套接字。

这一点尤其重要，因为其他一些代码可能已经使用[`ServerSocket.setSocketFactory`](http://java.sun.com/j2se/1.4.2/docs/api/java/net/ServerSocket.html#setSocketFactory(java.net.SocketImplFactory)). 即使默认套接字实现是线程安全的，自定义实现也不必如此。文档中没有任何内容这么说。

**长答案：默认 Windows 实现**

您可以下载并检查[java SE 1.6 源代码](http://download.java.net/jdk6/source/)。

我从那里开始，`\j2se\src\share\classes\java\net\ServerSocket.java`从那里开始通往`PlainSocketImpl.java`. 该`PlainSocketImpl.Accept`方法标记为`native`。

Windows 的本机 C++ 代码位于`\j2se\src\windows\native\java\net\PlainSocketImpl.c`. 它使用[winsock 接受](http://msdn.microsoft.com/en-us/library/ms737526(VS.85).aspx)函数。来自[关于 WinSock 的 MSDN 文章](http://msdn.microsoft.com/en-us/library/09dd1ycd(VS.80).aspx)（重点是我的）：

> 在 Windows NT 和 Windows 2000 下，对 16 位应用程序的 Windows 套接字支持基于 WINSOCK.DLL。对于 32 位应用程序，支持在 WSOCK32.DLL 中。提供的 API 是相同的，只是 32 位版本的参数扩展为 32 位。**在 Win32 下，提供了线程安全。**

所以至少在 Windows 上，`Socket.Accept`是线程安全的，因为它不会让两个线程接受相同的连接。实现中还有基础设施`ServerSocket`（例如 Close() 方法使用锁），这表明它是线程安全的。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-22T08:06:04.673

这并不能完全回答您的问题，但是在多个线程上运行 accept() 听起来服务器的设计有问题。

通常不需要从多个线程运行 accept() 。

您的代码应如下所示：

```
while (serverIsUpAndRunning())
{
    // Wait for an incoming connection.
    Socket s = serverSocket.accept();
    // Spawn a thread to handle the socket,
    // so that we don't block new connections.
    SocketHandlerThread t = new SocketHandlerThread(s);
    t.start();
} 
```

# ruby-on-rails - 最喜欢的 ruby /rails ide for linux

> ID：896795
> 
> 赞同：0
> 
> 时间：2009-05-22T08:04:23.147
> 
> 标签：ruby-on-rails, ruby, linux, ide, editor

> **可能重复：**
> [Linux 上的 Ruby 使用什么 IDE/编辑器？](https://stackoverflow.com/questions/265601/what-ide-editor-do-you-use-for-ruby-on-linux)

您认为在 linux 上开发 ruby​​ 和 rails 的最佳 ide 是什么？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T08:09:31.607

我想这次我会成为回答“ [Emacs](http://www.gnu.org/software/emacs/) ”的人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T08:13:59.867

试试[Arachnoruby](http://www.ruby-ide.com)或 Eclipse

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T08:18:13.807

我知道它不适用于 Linux，但无论如何我都会说 Textmate，这足以让你获得 Mac :)

更严肃地说，我会推荐**vi**，或者更准确地说是[Vim](http://biodegradablegeek.com/2007/12/using-vim-as-a-complete-ruby-on-rails-ide/)。它比其他任何东西都更轻巧，并且仍然可以正确完成工作，因此对于 Linux，我认为没有其他选择，对于 Ubuntu（可能还有 Debian 和其他），甚至还有一个包 vim-rails ，其中包含大量脚本以简化开发。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T08:21:39.353

我认为您不需要IDE。Rails 并不复杂，它只需要一个文本编辑器和一个终端。

因此，我建议您使用诸如 emacs、vim、gedit 之类的文本编辑器。KDE/Gnome 终端已经足够好了。您可能想考虑使用 ZSH 而不是 bash。

# eclipse - Google App Engine 的 Java 运行时环境不支持 eclipse javax.jws.WebMethod 中的 GWT

> ID：896796
> 
> 赞同：0
> 
> 时间：2009-05-22T08:04:33.507
> 
> 标签：eclipse, gwt

我使用 GWT eclipse 插件在 eclipse 中创建了一个 GWT 应用程序。默认情况下，它在客户端包中创建 GreetingServiceAsync.java 和 GreetingService.java。服务器包中的 GreetingServiceImpl.java。

现在我想从 GreetingServiceImpl.java 调用一个 CXF 网络服务。我使用 wsdl2java 为我的 wsdl 生成 java 类。我在eclipse的GWT项目中导入了这些生成的类，包是“服务”。但它抱怨“Google App Engine 的 Java 运行时环境不支持 javax.jws.WebMethod”，还有更多错误。

我该如何摆脱这个？

只有错误是问题，否则应用程序运行良好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-24T12:36:31.670

是否`javax.jws.WebMethod`在 GAE[白名单](http://code.google.com/appengine/docs/java/jrewhitelist.html)中？如果您确定 App Engine 确实支持此类，请在 Eclipse 中尝试：

*   在 Project Explorer 中右键单击您的项目。
*   `Google -> App Engine Settings`
*   确保选中**使用 Google App Engine**
*   如果对话框显示多个，请尝试将 App Engine SDK 更改为最新版本

我在进行软件更新后遇到了这个问题；安装了一个新的 GAE SDK，由于某种原因它混淆了插件。它告诉我这`java.lang.String`是不受支持的。:-)

# asp.net - 使用 Enterprise Library 为异常处理添加更多细节

> ID：896806
> 
> 赞同：1
> 
> 时间：2009-05-22T08:06:55.903
> 
> 标签：asp.net, exception-handling, enterprise-library

我正在使用 Enterprise Library 4.x 进行异常处理日志记录（ASP.NET 应用程序）。

这是我正在调用的 EntLib 方法：

```
ExceptionPolicy.HandleException(ex, exceptionPolicy.ToString()); 
```

如何向异常添加更多详细信息，例如当前请求 url、当前用户名等？

我知道我可以将它包装在我的异常中并将原始异常设置为内部异常，但这似乎并不正确。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-21T12:57:50.007

回答我自己的问题：:)

这是不可能的，解决方案实际上很简单：实现您自己的发布者！

这就是我所做的。这很简单，但由于 EntLib 架构，我必须实现的不仅仅是发布者，但这并不困难或耗时，因为所有内容都在 EntLib 4.x 附带的文档中进行了解释。

# linux - 查找 -exec cmd {} + vs | xargs

> ID：896808
> 
> 赞同：123
> 
> 时间：2009-05-22T08:08:03.093
> 
> 标签：linux, unix, command-line, find

哪一个对非常大的文件集更有效并且应该使用？

```
find . -exec cmd {} + 
```

或者

```
find . | xargs cmd 
```

（假设文件名中没有有趣的字符）

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2009-05-22T09:22:36.657

速度差异将是微不足道的。

但您必须确保：

1.  您的脚本不会假设文件名中没有空格、制表符等；第一个版本是安全的，第二个不是。

2.  您的脚本不会将以“ `-`”开头的文件视为选项。

所以你的代码应该是这样的：

```
find . -exec cmd -option1 -option2 -- {} + 
```

或者

```
find . -print0 | xargs -0 cmd -option1 -option2 -- 
```

第一个版本更短更容易编写，因为你可以忽略 1，但第二个版本更便携和安全，因为 " `-exec cmd {} +`" 是 GNU findutils 中相对较新的选项（自 2005 年以来，许多正在运行的系统还没有它）[最近](http://savannah.gnu.org/bugs/?func=detailitem&item_id=16738)有车。`-exec cmd {} +`正如您从其他答案中看到的那样，很多人也不知道这个“ ”。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-22T08:23:36.633

```
find . | xargs cmd 
```

效率更高（它运行`cmd`的次数越少越好，不像`exec`，每场比赛运行`cmd`一次）。但是，如果文件名包含空格或时髦字符，您将遇到麻烦。

建议使用以下方法：

```
find . -print0 | xargs -0 cmd 
```

即使文件名包含时髦的字符，这也会起作用（`-print0`使`find`打印以 NUL 结尾的匹配，`-0`使`xargs`期望这种格式。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-04-24T02:30:17.853

Modern`xargs`的版本通常支持并行管道执行。

显然，在选择 `find … -exec` 和 `… | xargs`

# sql - SQL 批量删除

> ID：896810
> 
> 赞同：11
> 
> 时间：2009-05-22T08:08:42.327
> 
> 标签：sql, sql-server, tsql, sql-server-administration

我在 SQL Server 2005 中有一个表，其中有大约 40 亿行。我需要删除大约 20 亿行。如果我尝试在单个事务中执行此操作，则事务日志会填满并且失败。我没有任何额外的空间来使事务日志变大。我认为最好的前进方式是批量删除语句（批量〜10,000？）。

我可能可以使用光标来做到这一点，但这是一种标准/简单/聪明的方法吗？

PS 这个表没有作为 PK 的标识列。PK 由整数外键和日期组成。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-22T12:06:18.103

您可以“蚕食”删除，这也意味着您不会对数据库造成大量负载。如果您的 t-log 备份每 10 分钟运行一次，那么您应该可以在相同的时间间隔内运行一次或两次。您可以将其安排为 SQL 代理作业

尝试这样的事情：

```
DECLARE @count int
SET @count = 10000

    DELETE  FROM table1 
    WHERE table1id IN (
        SELECT TOP (@count) tableid
        FROM table1
        WHERE x='y'
    ) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-22T08:25:30.810

您要删除的行与要保留的行有什么区别？这对你有用吗：

```
while exists (select 1 from your_table where <your_condition>)
delete top(10000) from your_table
where <your_condition> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-22T12:15:45.713

除了将它放在一个带有语句以截断日志的批处理中之外，您可能还想尝试这些技巧：

*   除了其他条件之外，添加与聚集索引中的第一列匹配的条件
*   从表中删除任何索引，然后在删除完成后将它们放回（如果可能）并且不会干扰数据库中发生的任何其他事情，但保留聚集索引

例如，对于上面的第一点，如果您的 PK 是集群的，则找到一个与您要删除每个批次的行数大致匹配的范围并使用它：

```
DECLARE @max_id INT, @start_id INT, @end_id INT, @interval INT
SELECT @start_id = MIN(id), @max_id = MAX(id) FROM My_Table
SET @interval = 100000  -- You need to determine the right number here
SET @end_id = @start_id + @interval

WHILE (@start_id <= @max_id)
BEGIN
     DELETE FROM My_Table WHERE id BETWEEN @start_id AND @end_id AND <your criteria>

     SET @start_id = @end_id + 1
     SET @end_id = @end_id + @interval
END 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-22T08:18:10.967

听起来这是一次性操作（我希望是你），你不需要回到批量删除中途的状态——如果是这种情况，你为什么不在运行前切换到简单事务模式和然后在你完成后回到 FULL ？

这样事务日志就不会增长太多。在大多数情况下，这可能并不理想，但我在这里没有发现任何问题（假设如上所述，您不需要返回到删除之间的状态）。

您可以使用 smt 在脚本中执行此操作，例如：

```
ALTER DATABASE myDB SET RECOVERY FULL/SIMPLE 
```

**或者**，您可以设置一个作业以在每个给定的时间间隔收缩事务日志 - 当您的删除正在运行时。这有点糟糕，但我认为它可以解决问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-22T08:11:44.507

好吧，如果您使用 SQL Server 分区，比如基于日期列，您可能会切换出不再需要的分区。可能是对未来实施的考虑。

我认为最好的选择可能是如您所说，以较小的批次删除数据，而不是一次性删除，以避免任何潜在的阻塞问题。

您还可以考虑以下方法：

1.  复制数据以保存到临时表中
2.  截断原始表以清除所有数据
3.  将临时表中的所有内容移回原始表

随着数据被添加回原始表，您的索引也将被重建。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-22T10:32:54.487

我会做一些类似于临时表建议的事情，但我会在一个新的永久表中选择你想要保留的行，删除原始表，然后重命名新表。这应该具有相对较低的传输日志影响。显然，请记住在重命名新表后重新创建新表所需的任何索引。

只是我的两个便士。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-22T08:41:29.750

简短的回答是，你不能删除 20 亿行而不导致某种主要的数据库停机时间。

您最好的选择可能是将数据复制到临时表并截断原始表，但这会填满您的 tempDB，并且使用的日志记录不会比删除数据少。

在事务日志填满之前，您需要尽可能多地删除行，然后每次都将其截断。Stanislav Kniazev 提供的答案可以通过增加批量大小和添加截断日志文件的调用来修改。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-22T14:01:29.493

我同意那些希望您遍历一组较小记录的人的观点，这比尝试一步完成整个操作要快。您可能会体验到应该包含在循环中的记录数。一次大约 2000 个似乎是大多数表中的最佳位置一些实验来找到你需要的东西。这也取决于桌子的使用量。频繁访问的表将需要循环的每次迭代来运行更短的时间。如果您可以在非工作时间运行，或者最好在单用户模式下运行，那么您可以在一个循环中删除更多记录。

如果您认为自己不会在一个晚上的非工作时间执行此操作，那么最好设计一个带有计数器的循环，并且每晚只执行一定数量的迭代，直到完成为止。

此外，如果您使用隐式事务而不是显式事务，则可以随时终止循环查询，并且已删除的记录将保持删除状态，但当前循环中的记录除外。比尝试回滚 50 万条记录要快得多，因为您已经使系统停止运行。

在进行这种性质的操作之前立即备份数据库通常是一个好主意。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-09-04T01:46:49.063

这是我的例子：

```
-- configure script
-- Script limits - transaction per commit (default 10,000)
-- And time to allow script to run (in seconds, default 2 hours)
--
DECLARE @MAX INT
DECLARE @MAXT INT
--
-- These 4 variables are substituted by shell script.
--
SET @MAX = $MAX
SET @MAXT = $MAXT
SET @TABLE = $TABLE
SET @WHERE = $WHERE

-- step 1 - Main loop
DECLARE @continue INT
-- deleted in one transaction
DECLARE @deleted INT
-- deleted total in script
DECLARE @total INT
SET @total = 0
DECLARE @max_id INT, @start_id INT, @end_id INT, @interval INT
SET @interval = @MAX
SELECT @start_id = MIN(id), @max_id = MAX(id) from @TABLE
SET @end_id = @start_id + @interval

-- timing
DECLARE @start DATETIME
DECLARE @now DATETIME
DECLARE @timee INT
SET @start = GETDATE()
-- 
SET @continue = 1
IF OBJECT_ID (N'EntryID', 'U') IS NULL 
BEGIN
    CREATE TABLE EntryID (startid INT)
    INSERT INTO EntryID(startid) VALUES(@start_id)
END
    ELSE
BEGIN
    SELECT @start_id = startid FROM EntryID
END

WHILE (@continue = 1 AND @start_id <= @max_id)
BEGIN

    PRINT 'Start issued:   ' + CONVERT(varchar(19), GETDATE(), 120)
    BEGIN TRANSACTION
        DELETE 
        FROM @TABLE
        WHERE id BETWEEN @start_id AND @end_id AND @WHERE
        SET @deleted = @@ROWCOUNT
    UPDATE EntryID SET EntryID.startid = @end_id + 1
    COMMIT
    PRINT 'Deleted issued: ' + STR(@deleted) + ' records. ' + CONVERT(varchar(19), GETDATE(), 120) 
    SET @total = @total + @deleted
    SET @start_id = @end_id + 1
    SET @end_id = @end_id + @interval
    IF @end_id > @max_id
        SET @end_id = @max_id

    SET @now = GETDATE()
    SET @timee = DATEDIFF (second, @start, @now)
    if @timee > @MAXT
    BEGIN
    PRINT 'Time limit exceeded for the script, exiting'
    SET @continue = 0
    END
--    ELSE
--    BEGIN
--      SELECT @total 'Removed now', @timee 'Total time, seconds'   
--    END
END

SELECT @total 'Removed records', @timee 'Total time sec' , @start_id 'Next id', @max_id 'Max id', @continue 'COMPLETED? '
SELECT * from EntryID next_start_id

GO 
```

# inheritance - MS Workflow Foundation 继承和 while 活动

> ID：896812
> 
> 赞同：0
> 
> 时间：2009-05-22T08:09:23.870
> 
> 标签：inheritance, workflow, while-loop

我有两个问题。1\. 为什么工作流类是“SEALED”类？继承工作流程是一种不好的做法吗？2\. while 活动缓慢。IE.：我按此顺序将 3 个活动放在一个连续的 wf 上... Code_activity1 While_activity Code_activity2（在 while 活动中）

* * *

Code_activity1 - 将 int 计数器设置为 33320。 While_activity - 循环直到计数器 > 0。 Code_activity2 - 将计数器减 1（计数器--）；

现在的问题是执行整个工作流程的时间太长（大约 20 分钟）！！！

如果我在代码上手动做同样的事情：，

```
int counter = 33320;
while(counter>0)
    counter--; 
```

大约需要 1 毫秒。

为什么while活动这么慢？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-12T17:35:52.863

1）即使生成的类是密封的

```
public sealed partial class Workflow1: SequentialWorkflowActivity 
```

没有什么能真正阻止您删除sealed 关键字并从中继承。我猜你通常不想继承你设计和密封的工作流程，据说会给你一些性能优势

2) [http://msdn.microsoft.com/en-us/library/ms735819.aspx](http://msdn.microsoft.com/en-us/library/ms735819.aspx)稍微解释一下活动是如何工作的。您添加提到的子活动创建 33320 次，所有在活动执行/初始化等时触发的事件以及工作流运行时需要处理的所有额外工作，您将获得 20 分钟。

# iphone - 帮助新表格项的模式文本输入

> ID：896814
> 
> 赞同：3
> 
> 时间：2009-05-22T08:09:48.970
> 
> 标签：iphone, uitableview, uinavigationcontroller, modal-dialog

首先让我先说我对 iPhone 很陌生，所以我为我的无知道歉。

我有一个要添加新项目的 UITableView。当按下添加按钮时，我想要一个模式屏幕向上滑动，用户输入新项目的文本。

我一直在阅读 Apple 的[Table View Programming Guide for iPhone](http://developer.apple.com/iPhone/library/documentation/UserExperience/Conceptual/TableView_iPhone/ManageInsertDeleteRow/ManageInsertDeleteRow.html#//apple_ref/doc/uid/TP40007451-CH10-SW5)，他们有一个示例可以满足我的要求：

```
- (void)addItem:sender {
// To add an item, display a modal view with a text field.
if (itemInputController == nil) {
    itemInputController = [[ItemInputController alloc] init];
}
// Use a navigation controller to provide a customizable navigation bar with Cancel and Done buttons.
UINavigationController *navigationController = [[UINavigationController alloc] initWithRootViewController:itemInputController];
[[self navigationController] presentModalViewController:navigationController animated:YES];
[navigationController release]; 
```

}

但是他们没有在任何地方解释 itemInputController 是什么。据我所知，它应该给我一个带有单个文本字段的模式视图，以及一个带有取消和保存的导航栏。我应该在 Interface Builder 中自己创建这个视图吗？还是我需要以某种方式导入的标准东西？谁能帮我破译这个，或者告诉我另一种方法来让它工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T09:00:22.333

ItemInputController 将是您需要添加到项目中的 UIViewController 的派生类。

您需要创建一个新的 UIViewController 子类，然后在 IB 中构建接口 -[请参阅此处](http://www.iphonedevsdk.com/forum/iphone-sdk-development/6206-how-create-uiview-uiviewcontroller-programatically-without-using-nib.html)了解有关构建 UIViewControllers 的讨论。

# css - CSS： dt/dd 对之间的间距/边距

> ID：896815
> 
> 赞同：16
> 
> 时间：2009-05-22T08:09:59.440
> 
> 标签：css

我有以下html：

```
<dl>
        <dt>Item 1</dt>
        <dd>
            <ul>
                <li>Value 1</li>
            </ul>
        </dd>
        <dt>Item 2</dt>
        <dd>
            <!-- this item is missing a value -->
        </dd>
        <dt>Item 3</dt>
        <dd>
            <ul>
                <li>Value 1</li>
                <li>Value 2</li>
                <li>Value 3</li>
            </ul>
        </dd>
    </dl> 
```

我想把它排成这样（而不是普通的 dl 将术语和定义放在一起）：

```
Item 1    Value 1
Item 2    
Item 3    Value 1
          Value 2
          Value 3 
```

这不是问题。问题是我想在每个术语/定义对之间添加一个边距。问题是定义的高度不同（它们的范围在 0 到 5 个列表项之间），所以我不能在 dd 标签上应用相同的边距。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-22T08:19:29.140

这个怎么样？

```
dt, dd { display: block; float: left; margin-top: 20px; }
dt { clear: both; } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-22T08:27:58.343

你的意思是这样的：

```
Item 1    Value 1

Item 2    

Item 3    Value 1
          Value 2
          Value 3 
```

因为那时我不明白为什么不能在 dd 元素上应用边距。我做了一个快速的实验，使用下面的 CSS：

```
ul { 
  margin: -1.2em 0 0 100px; 
  padding: 0; 
}

dd { 
  margin-bottom: 10px;
} 
```

这似乎有你需要的效果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T12:07:17.743

您的“第 2 项”dd 真的是空的还是里面有一个`&nbsp;`？如果它为空，则很难让 dt/dd 正确排列，因为其他 dd 的高度为 20px（例如），而空 dd 的高度为 0。

小心margin-top，您必须将它应用于dt 和dd。

我更喜欢在 dd 的底部使用填充。它给出了更一致的结果。

```
dt {
    float: left;
    clear: left;
    width: 8em;
    }
 dd {
    margin: 0 0 0 9em;
     padding: 0 0 2.5em 0;
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-11-18T09:12:38.747

我认为正确使用`dl`,并不是在 a 中使用 's `dt`，而是使用不同的 's。在我看来，您在一个元素中使用了一个列表，该元素本身就是用于列出的。`dd``ul` `li``dd``dd`

```
<dl>
    <dt>Item 1</dt>
    <dd>Value 1</dd>
    <dt>Item 2</dt>
    <dd>
       &nbsp;
    </dd>
    <dt>Item 3</dt>
    <dd>Value 1</dd>
    <dd>Value 2</dd>
    <dd>Value 3</dd>
</dl> 
```

对于 CSS，你可以使用这个：

```
DL {
PADDING: 0; MARGIN: 0; }
DT {
POSITION: relative; PADDING: 0; MARGIN: 0; TOP: 1.2em; LEFT: 0px; }
DD {
PADDING: 0; MARGIN: 0 0 0 5em; } 
```

# asp.net - 网络浏览器锁定：如何？

> ID：896820
> 
> 赞同：2
> 
> 时间：2009-05-22T08:10:58.563
> 
> 标签：asp.net, browser

我有一个 ASP.NET Web 应用程序，其中一部分需要在 Web 浏览器中作为面向公众的终端运行。

本质上，它用于在商店等商业场所捕获匿名用户反馈（.aspx 上的向导控件）。

管理员将登录并为“终端”模式准备应用程序。

终端是带有键盘和/或鼠标类设备的普通 PC。

我想阻止用户：查看浏览器菜单、按下返回按钮和/或在 URL 中输入不同的 URI，并且还禁止键盘快捷键绕过正在运行的应用程序的预期循环功能？

哪种浏览器最适合其禁用上述功能的能力？该应用程序在 IE/FF/Chrome/Opera/Safari 上运行。

如何配置机器和/或浏览器以将其锁定以防止未经授权/意外使用？

附带说明一下，我猜 Web 应用程序会话需要无限超时？

感谢您的输入！

已编辑：我暂时没有回答这个问题......我希望看到能够突出显示其他浏览器的可能选项的响应。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T08:31:47.773

您可以在 Kiosk 模式下运行 Internet Explorer。请参阅此[MS 知识库文章](http://support.microsoft.com/kb/154780)。

简单地说，[使用 -k 参数启动 Internet Explorer](http://samanathon.com/internet-explorer-7s-kiosk-mode/)

似乎也有一些商业产品可用，[像这样](http://simpliciti.biz/index.php)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T08:33:16.007

尝试如何[在 Microsoft Internet Explorer 中使用 Kiosk 模式](http://support.microsoft.com/kb/154780)

此外，还有许多 Kiosk 工具可帮助锁定机器。示例：[http ://www.thekioskstore.com/index.php/software/kiosk-lock-down](http://www.thekioskstore.com/index.php/software/kiosk-lock-down)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T09:16:12.113

Firefox 至少有两个插件（可能还有更多）：

*   [https://addons.mozilla.org/en-US/firefox/addon/1659](https://addons.mozilla.org/en-US/firefox/addon/1659)
*   [https://addons.mozilla.org/en-US/firefox/addon/509](https://addons.mozilla.org/en-US/firefox/addon/509)

也可以锁定 KDE 和 GNOME（GNOME 至少有一个内置工具），您也可以使用它来锁定系统的其余部分。如果 Web 应用程序在另一个系统上运行，我建议安装 Ubuntu。

如果您必须使用 MS Windows，请查看： http: [//www.microsoft.com/windows/products/winfamily/sharedaccess/seeit/internetcafe.mspx](http://www.microsoft.com/windows/products/winfamily/sharedaccess/seeit/internetcafe.mspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-04T14:35:51.937

您可以使用专门为此目的设计的开源 Linux 发行版，[http://webconverger.com/](http://webconverger.com/)

# sql-server-2005 - SignByCert 和符号的最大尺寸

> ID：896821
> 
> 赞同：0
> 
> 时间：2009-05-22T08:11:04.290
> 
> 标签：sql-server-2005, encryption

我有下表

```
CREATE TABLE User (
    email sysname NOT NULL,
    sign varbinary(256) NULL
); 
```

SQL Server 2005/2008 中的 sysname 与 nvarchar(128) 的大小相同——我假设它是 256 字节。

我正在使用 SignByCert(..., email, ...) 函数来生成“电子邮件”列的签名。

我可以对 [sign] 列的最大大小做出任何假设吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T09:05:57.440

找到了。

根据书“Accelerated SQL Server 2008”第160页 - 签名的大小取决于证书中私钥的大小。

如果大小为 2048 位，则签名大小将为 256 字节。如果大小为 1024 位，则签名大小将为 128 字节。

就我而言，我正在使用 CREATE CERTIFICATE TSQL 语句创建证书，并且 - 根据 SQL Server 联机丛书：

> SQL Server 生成的私钥长度为 1024 位

所以我的符号列的最大大小是 128 字节。

# perl - -G 在 Perl 中有什么作用？

> ID：896822
> 
> 赞同：-2
> 
> 时间：2009-05-22T08:11:21.463
> 
> 标签：perl

我搜索了 Internet 和 Perl 文档，但似乎找不到答案。

帮助将不胜感激。

编辑：：他问我关于-G的问题，把它写在一张纸上，当我看起来很难过时，让我去阅读基础知识。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-22T08:24:33.090

我同意 JesperE，请给我们看一些代码。但是，据我所知，这就是正在发生的事情：

```
if(-G) { 
```

Perl 看到这一点，不识别`-G`，因此将其视为字符串。它成为了：

```
if('-G') { 
```

这相当于：

```
if(1) { 
```

据我所知，`if(-G)`什么都不做。我试过使用它，它似乎总是返回 true，这支持了我的假设。进一步的支持来自以下代码（在 OS X 上使用 Perl 5.10.0 测试）：

```
use strict;
use warnings;

my $var = -G;
print "$var\n"; 
```

不显示任何警告，编译并运行，并且只打印“-G”。

编辑：做一个我应该早点做的搜索提供了 Perldoc 的[perlop](http://perldoc.perl.org/perlop.html#Symbolic-Unary-Operators)页面中的以下内容：

> 如果操作数是数字，一元“-”执行算术否定。如果操作数是标识符，则返回由与标识符连接的减号组成的字符串。否则，如果字符串以加号或减号开头，则返回以相反符号开头的字符串。这些规则的一个效果是 -bareword 等价于字符串“-bareword”。但是，如果字符串以非字母字符（不包括“+”或“-”）开头，Perl 将尝试将字符串转换为数字并执行算术否定。如果字符串不能干净地转换为数字，Perl 将给出警告**Argument "the string" is not numeric in negation (-) at ...。**

如评论中所述，`B::Deparse`似乎表明 Perl 转换`if(-G)`为`if(-'G')`. 但是，文档（以及带有 的行为`print()`）与文档一致，文档说它应该转换`if(-G)`为`if('-G')`. 这不会改变程序的结果。

然而，99% 的人只会在数字上使用的一元运算符行为中的细微打字差异并不是我所说的“基本”。我认为任何人都不应该（或永远需要）在任何实际情况下使用`-bareword`to转换。`'bareword'`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T08:18:38.517

perl 中没有开关 -G 。

perl -G 无法识别的开关：-G（-h 将显示有效选项）。

编辑：好的，-G也没有-只有-g。

-g 文件设置了 setgid 位。

[http://perldoc.perl.org/perlfunc.html](http://perldoc.perl.org/perlfunc.html)

否则，这是无稽之谈，问题措辞错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T08:25:18.863

我不知道 -G 但 -g 在[这里](http://perldoc.perl.org/functions/-X.html)被描述为

```
-g  File has setgid bit set. 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T15:31:19.907

这显然混淆了 [ (test) 选项和 Perl -X 文件测试。-G 是前者（在我的 BSD 系统上），但不是后者。-G 是一个非posix 扩展，我猜Perl 没有包含所有的扩展，只是一些。所以要么，他的意思是 -g 要么他的意思是 [ -G $file ]; （对于一些 POSIX [）的超集。它也在我的默认 shell (pdksh) 和 bash（大部分是 linux 默认 shell）中

-G 在测试中或作为 shell 内置：

-G file 如果文件存在且其组与此进程的有效组 ID 匹配，则为真。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-24T18:44:10.833

一个答案是：“我认为任何人都不应该（或永远需要）在任何实际情况下使用 -bareword 到 -'bareword' 的转换。”

这广泛用于一种命名参数样式。请参阅古老的[CGI](http://search.cpan.org/perldoc/CGI)之一：

```
$cookie1 = $q->cookie(-name=>'riddle_name', -value=>"The Sphynx's Question");
$cookie2 = $q->cookie(-name=>'answers', -value=>\%answers);
print $q->header(
    -type    => 'image/gif',
    -expires => '+3d',
    -cookie  => [$cookie1,$cookie2]
); 
```

# jquery - ASP.NET MVC return JSON() 确实显示了一个保存文件对话框

> ID：896824
> 
> 赞同：1
> 
> 时间：2009-05-22T08:11:49.280
> 
> 标签：jquery, asp.net-mvc, json

我是 .NET MVC 模式的新手，并尝试使用`AJAX.BeginForm`在我的控制器中使用 Helper 类调用 Action 我使用 return JSON(); 返回序列化 JSON；

在我看来，我添加了一个 Scrip 女巫应该使用返回的 JSON。

```
 function ResultSet(request) {

   var json = content.get_response().get_object();
   var result = eval(json);

   if (result.Successfull) {
       alert("Success!");
   }
   else {
       alert("else");
       }
   } 
```

但是，如果我返回浏览器，则会显示一个保存对话框来保存 JSON 文件。

这是为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T10:02:18.153

我遇到了类似的问题，请尝试确保您添加了对 microsoft ajax 库的引用：

```
<script src="/Scripts/MicrosoftAjax.debug.js" type="text/javascript"></script>
<script src="/Scripts/MicrosoftMvcAjax.debug.js" type="text/javascript"></script> 
```

还。你的 ResultSet() 方法将一个名为“request”的变量作为参数，我认为它应该被称为“content”，像这样？

```
<script type="text/javascript">
    function ResultSet(content) {
        var json = content.get_response().get_object();

        var result = eval(json);
        if (result.Successfull) {
            alert("Success!");
        }
        else {
            alert("else");
        }
    }    
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-05-07T04:06:43.807

您忘记引用 jQuery。把它放在你的 html 的头部：

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T08:17:50.953

尝试将响应的*内容类型设置为***application/json**如下：

```
Response.ContentType = "application/json"; 
```

# windows - 是使用 Perl DBI 模块还是设置系统 DSN 并使用 ODBC 更好？

> ID：896825
> 
> 赞同：1
> 
> 时间：2009-05-22T08:12:20.043
> 
> 标签：windows, perl, oracle, odbc, dbi

我正在使用 Perl 从多个日志文件中收集数据并将其存储到我正在运行脚本的同一 Windows 2003 主机上的 Oracle 数据库中。是使用 Perl DBI 模块还是设置系统 DSN 并使用 ODBC 更好？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T09:27:57.457

DBI，或者至少基于 DBI 的东西是在 Perl 中与数据库交互的标准方式。然后在 DBI 下，您可以使用直接 oracle 驱动程序 (DBD::Oracle) 或 ODBC 驱动程序（恰当地命名为 DBD::ODBC）。所以实际上，您使用哪一个似乎并不重要，至少对于您的代码而言不是。

至于DBI*之上*的一层，我喜欢[DBIx::Simple](http://search.cpan.org/dist/DBIx-Simple)，但还有其他的。

# git - 在 gitk 中，为什么我的黄色按钮在 master 上方？

> ID：896832
> 
> 赞同：19
> 
> 时间：2009-05-22T08:16:43.700
> 
> 标签：git, version-control, gitk

我在 gitk 上找不到任何关于颜色含义的文档，但我认为这里的问题是我的黄色按钮已经通过了我的主人。现在，当我尝试这样做时：

`git push origin master`

它不起作用。我的黄色按钮是如何超越主人的，我如何让它们重新组合在一起，以便我可以推送原点主人？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-05-22T08:54:28.757

看起来您需要将该提交放回`master`分支（如果它属于那里）。此外，您似乎已经分离了 HEAD，因为该提交不是分支头。如果这一切都是真的，请尝试以下操作：

```
# git log -1 
```

记住提交 ID。

```
# git checkout master
# git reset --hard <commit-id> 
```

现在将在标记`gitk`旁边显示黄色提交，并将再次工作。`master``git push`

至于你是如何进入这种情况的，我唯一能想象的是你曾经`git reset`将`master`分支重置为以前的提交，但没有更改当前签出的提交。

# php - 更改 Magento 中货币选择器的位置

> ID：896842
> 
> 赞同：1
> 
> 时间：2009-05-22T08:20:23.287
> 
> 标签：php, html, xml, magento

目前，货币选择器位于顶部，这是我的开发站点：

[http://nordschleife.metaforix.net/118/118/index.php/kyocera.html](http://nordschleife.metaforix.net/118/118/index.php/kyocera.html)

但是，我想将货币选择器切换到表格“价格”标题下方。

我试过

```
echo $this->getCurrency(); 
```

但什么都没有。我想我需要一些类似的方法`getCurrencyHtml()`，但似乎没有这样的方法。

或者我必须编辑布局文件，我应该怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T10:57:45.293

我可以向您展示一种方法来做到这一点，但为了了解发生了什么，您至少需要对 Magento 的布局文件如何工作有一个基本的了解。为此，您应该在此处阅读设计师指南，并[在此处阅读有关其工作原理](http://www.magentocommerce.com/design_guide)[的](http://www.magentocommerce.com/boards/viewthread/40756/)基本说明。

现在有几种处理方法，但我认为最简单的方法是简单地使用现有的货币块。看到你将把它放在那个小单元格中，我假设你不需要“选择你的货币”标题。所以我们需要一个新模板。

Magento 中的块由两个文件组成，一个块类完成生成动态内容的所有工作，一个模板文件使用块类的方法以及一些 html 来创建最终结果。获取货币选项的繁重工作已经由块类完成，所以如果我们可以将它与新的模板文件配对使用，我们将被设置。

布局文件中的现有声明，特别是 directory.xml 是

```
<block type="directory/currency" name="currency" before="catalog.leftnav" template="directory/currency.phtml"/> 
```

所以模板文件是app\design\frontend[interface][theme]\template\directory\currency.phtml

将其复制到 currency2.phtml 并在其中删除标题。

现在创建一个名为“currency2”的新块，由旧块类和我们编写的新模板文件组成

```
<block type="directory/currency" name="currency2" as="currency2" template="directory/currency2.phtml"/> 
```

我们将在 /template/catalog/product/list.phtml 中使用它，因此打开 catalog.xml 并将新的块声明放在

```
<block type="catalog/product_list" name="product_list" template="catalog/product/list.phtml"> 
```

在适当的部分（我假设 catalog_category_default）。

最后打开 /template/catalog/product/list.phtml 并添加

```
<?php echo $this->getChildHtml('currency2'); ?> 
```

您希望块出现的位置。

# python - 从模型表单创建模型表单集

> ID：896848
> 
> 赞同：0
> 
> 时间：2009-05-22T08:22:12.940
> 
> 标签：python, django, formset, modelform

我有一个模型 MyModel，它包含一个 PK - locid，即一个 AutoField。

我想从中构建一个模型表单集，但有一些注意事项：

*   表单集的查询集应该是自定义的（比如 order_by('field')）而不是 all()
*   由于 MyModel 的 locid 是一个 AutoField，因此默认情况下是隐藏的，因此我希望能够将其显示给用户。

我不知道该怎么做。我尝试了多种方法，

```
MyModelFormSet = modelformset_factory(MyModel, fields=('locid', 'name', 'dupof')) 
```

上面给了我 3 个字段，但是 locid 是隐藏的。

```
class MyModelForm(ModelForm):

  def __init__(self, *args, **kwargs):
    super(MyModelForm, self).__init__(*args, **kwargs)
    self.fields['locid'].widget.attrs["type"] = 'visible'
    locid = forms.IntegerField(min_value = 1, required=True)

  class Meta:
    model = MyModel
    fields = ('locid', 'name', 'dupof') 
```

以上给了我一个ManyToMany错误。

有没有人做过这样的事情？

* * *

编辑**2**

我现在可以在实例化表单集时使用自定义查询 - 但我仍然需要向用户显示 locid 字段，因为 id 对于应用程序的使用很重要。我该怎么做？*如果它是自动字段，有没有办法覆盖隐藏 PK 的默认行为？*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T11:16:38.687

向用户显示自动字段是没有意义的，因为它是一个自动递增的主键——用户无法更改它，并且在将记录保存到数据库之前它将不可用（DBMS 选择下一个可用的 id）。

这是为表单集设置自定义查询集的方式：

```
from django.forms.models import BaseModelFormSet

class OrderedFormSet(BaseModelFormSet):
    def __init__(self, *args, **kwargs):
        self.queryset = MyModel.objects.order_by("field")
        super(OrderedFormSet, self).__init__(*args, **kwargs) 
```

然后在工厂函数中使用该表单集：

```
MyModelFormSet = modelformset_factory(MyModel, formset=OrderedFormSet) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-26T21:35:34.087

正如我在这里提到的，我最终使用了模板端变量来执行此操作：

[如何在 django formset 中显示隐藏的自动字段](https://stackoverflow.com/questions/896153/how-to-show-hidden-autofield-in-django-formset)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-24T01:38:21.063

如果您喜欢便宜的解决方法，为什么不将其`locid`融入该`__unicode__`方法呢？保证用户可以看到，不需要 django-admin 的特殊知识。

但是，公平地说，我对 django-admin 相关问题的所有回答都倾向于“不要费力地使 django-admin 成为一个通用的 CRUD 界面”。

# jquery-ui - 带有经典 ASP 的 JQuery 滑块示例？

> ID：896850
> 
> 赞同：2
> 
> 时间：2009-05-22T08:23:25.823
> 
> 标签：jquery-ui, asp-classic, slider

我将尝试在旧的 Classic ASP 商店中实现 JQuery 滑块，滑块将控制价格范围。所以价格在 40 美元到 80 美元之间，您可以使用滑块在 50 美元到 60 美元之间移动……

任何人都知道以这种方式在 ASP 中使用滑块的任何示例吗？我猜我将值存储在隐藏值中，然后让页面将值异步发布回自身？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-22T08:42:25.473

滑块让您有机会添加最小值、最大值以及步骤...

试试下面的代码并在你的 ASP 代码中实现它

```
<!DOCTYPE html> 
<html> 
 <head>
  <script class="jsbin" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
  <script class="jsbin" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.0/jquery-ui.min.js"></script>
  <link class="jsbin" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1/themes/base/jquery-ui.css" rel="stylesheet" type="text/css" />

  <style type="text/css"> 
    #slider { margin: 10px; width: 300px; }
    body { font-size: 20px; }
  </style>

  <script type="text/javascript">
  $(document).ready(function(){

    $("pre a").bind("click", function() {   // show current hidden value
        alert($("#prdRange").val());
    });

    $("#slider").slider({ 
            min: 40,            // minimum amount
            max: 80,            // maximum amount
            step: ((80 - 40) / 10),     // steps ... 
            slide: function(event, ui) {    // fire this when change
                $("#lbl").text(ui.value + ",00 €");
                $("#prdRange").val(ui.value);
            }
        });
  });
  </script>
</head>
<body style="font-size:62.5%;">

<div id="slider"></div>
<span id="lbl">40,00 €&lt;/span>
<input type="hidden" id="prdRange" value="40" />

<pre>min: 40 Euros, max: 80 Euros, <a href="#">range chosen</a></pre>

</body>
</html> 
```

您所要做的就是在加载页面时使用 asp 值更改值

```
$("#slider").slider({ 
        min: <%= ProductMinValue %>,                    // minimum amount
        max: <%= ProductMaxValue %>,                    // maximum amount
        step: <%= ProductStepValue %>,     // steps ... 
        slide: function(event, ui) {    // fire this when change
            $("#lbl").text(ui.value + ",00 €");
            $("#prdRange").val(ui.value);
        }
    }); 
```

* * *

[在JSBin](http://jsbin.com/ivomo/16)中查看此代码（您可以通过在 URL 中添加**/edit来编辑它...）**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T09:45:30.713

这个答案适用于 Ajaxing 基本代码......

***程序：***

1.  滑块的输出发生了变化。它现在加载一个 productList.asp，传递来自滑块的值。
2.  productList.asp 是一个简单的 ASP 页面，它获取查询字符串“值”并使用该值构建产品表。
3.  现在它只获取 QueryString 并使用该值填充 4 个产品。

***代码：***

**滑块.html**

```
<!DOCTYPE html>
<html>
<head>
  <link type="text/css" href="http://jqueryui.com/latest/themes/base/ui.all.css" rel="stylesheet" />
  <script type="text/javascript" src="http://jqueryui.com/latest/jquery-1.3.2.js"></script>
  <script type="text/javascript" src="http://jqueryui.com/latest/ui/ui.core.js"></script>
  <script type="text/javascript" src="http://jqueryui.com/latest/ui/ui.slider.js"></script>
  <style type="text/css">
    #slider { margin: 10px; width: 300px; }
    #lbl { font-size: 22px; }
  </style>
  <script type="text/javascript">
  $(document).ready(function(){

    $("pre a").bind("click", function() {   // show current hidden value
        alert($("#prdRange").val());
    });

    $("#slider").slider({ 
            min: 40,                    // minimum amount
            max: 80,                    // maximum amount
            step: ((80 - 40) / 10),     // steps ... 
            slide: function(event, ui) {    // fire this when change
                var newValue = ui.value;
                $("#lbl").text(newValue + ",00 €");
                $("#prdRange").val(newValue);

                $("#prdList").load("productList.asp #prdTableList", { 'value' : newValue }, function(){
                   //alert("products in range of " + newValue + ",00 € loaded");
                 });
            }
        });
  });
  </script>
</head>
<body style="font-size:62.5%;">

<div id="slider"></div>
<span id="lbl">40,00 €&lt;/span>
<input type="hidden" id="prdRange" value="40" />

<pre>min: 40 Euros, max: 80 Euros, <a href="#">range chosen</a></pre>

<div id="prdList"></div>

</body>
</html> 
```

**产品列表.asp**

```
<%
    Dim newValue    
    newValue = Request("value") & ",00 &euro;"
%>
<!DOCTYPE html>
<html>
<head>
</head>
<body>
  <div id="prdTableList">
    <table style="width:100%;">
        <tr>
            <td style="width:50%;">Product</td>
            <td>Price</td>
        </tr>
        <tr>
            <td><a href="#">PRD 001<a></td>
            <td><%= newValue%></td>
        </tr>
        <tr style="background-color:#ccc;">
            <td><a href="#">PRD 002<a></td>
            <td><%= newValue%></td>
        </tr>
        <tr>
            <td><a href="#">PRD 003<a></td>
            <td><%= newValue%></td>
        </tr>
        <tr style="background-color:#ccc;">
            <td><a href="#">PRD 004<a></td>
            <td><%= newValue%></td>
        </tr>
    </table>
  </div>
</body>
</html> 
```

> 注意：我只加载#prdTableList输出（load("productList.asp #prdTableList"...)，而不是整个productList.asp页面，所以有HTML标签是没有问题的，是一个好方法进行调试，因为我们在该页面中需要做的就是使用值查询字符串调用它，例如：

```
productList.asp?value=47 
```

**输出：**

[替代文字 http://www.balexandre.com/temp/2009-05-22_1311.png](http://www.balexandre.com/temp/2009-05-22_1311.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T08:28:50.167

当然，只需使用 jQuery 滑块：[http](http://docs.jquery.com/UI/Slider) ://docs.jquery.com/UI/Slider或 Google 提供的任何滑块。[http://www.keepthewebweird.com/demo/slider/](http://www.keepthewebweird.com/demo/slider/)

# user-interface - 使用 MDS Studio 和 Plazmic CDK

> ID：896854
> 
> 赞同：1
> 
> 时间：2009-05-22T08:23:56.760
> 
> 标签：user-interface, blackberry

我想知道使用 MDS studio 和 Plazmic CDK 开发基于 UI 的丰富应用程序的可行性/灵活性如何？

或者任何其他适用于黑莓的优秀 GUI 开发工具？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-19T08:04:45.330

谈论 Plazmic CDK - 您可以使用它来创建黑莓主题或媒体内容（动画、图像等）。
[黑莓主题生成器 http://img269.imageshack.us/img269/1456/bbthemebuilder.gif](http://img269.imageshack.us/img269/1456/bbthemebuilder.gif)

> 你可以用主题生成器做什么？它的一些主要功能允许您：
> 
> *   自定义 BlackBerry 应用程序图标
> *   更改主屏幕横幅图像和图标/指示器颜色
> *   创建自己的按钮
> *   自定义对话框和弹出屏幕的外观
> *   自定义空闲屏幕
> *   自定义菜单和列表的外观
> *   自定义电话应用程序屏幕
> *   自定义 BlackBerry 设备上使用的字体

[bb 开发日志 - 只是主题吧！](http://img269.imageshack.us/img269/1456/bbthemebuilder.gif)
[黑莓主题和动画图形](http://na.blackberry.com/eng/devjournals/resources/journals/sep_2006/theme.jsp)
[如何创建您自己的个人黑莓主题 by BrileyKenney](http://na.blackberry.com/eng/developers/themes/)

# java - 将java转换为c#代码的工具

> ID：896867
> 
> 赞同：65
> 
> 时间：2009-05-22T08:27:07.923
> 
> 标签：java, c#, code-translation

目前将 java 转换为 c# 的最佳工具是什么？除了

*   j2c 翻译器
*   j#

我目前使用 IKVM。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2010-01-06T16:55:52.113

供你参考：

*   由[db4o](http://db4o.com/)[锐化](http://developer.db4o.com/Projects/html/projectspaces/db4o_product_design/sharpen.html)
*   [XES](http://www.euclideanspace.com/software/language/xes/userGuide/convert/javaToCSharp/index.htm "XES - 用户指南 - 将 Java 源代码转换为 C#")
*   [RemoteSoft 八达通](http://www.remotesoft.com/octopus/)（商业）

注意：我对它们没有经验。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-09-27T15:26:00.607

不。将它们保留为 Java 并使用 IKVM 将它们转换为 .Net DLL。

*   [http://www.ikvm.net/devguide/java2net.html](http://www.ikvm.net/devguide/java2net.html)
*   [http://sourceforge.net/apps/mediawiki/ikvm/index.php?title=Ikvmc](http://sourceforge.net/apps/mediawiki/ikvm/index.php?title=Ikvmc)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-08-25T22:24:46.290

我用这个取得了很好的成绩。比锐化更容易使用。

[http://tangiblesoftwaresolutions.com/Product_Details/Java_to_CSharp_Converter.html](http://tangiblesoftwaresolutions.com/Product_Details/Java_to_CSharp_Converter.html)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-22T08:32:40.970

Microsoft 有一个名为 JLCA 的工具：[Java 语言转换助手](http://www.microsoft.com/downloads/details.aspx?FamilyID=46bea47e-d47f-4349-9b4f-904b0a973174&displaylang=en)。我不知道它是否更好，因为我从未比较过两者。

# python - 使用 pygtk 运行多个进程并在 python 中捕获输出

> ID：896874
> 
> 赞同：1
> 
> 时间：2009-05-22T08:29:23.720
> 
> 标签：python

我想编写一个简单的应用程序来运行多个程序并在多个终端（样式）窗口中显示它们的输出。此外，我希望能够读取这些进程的 stdout/stderr 并在输出中搜索关键字。

我尝试在 python 中实现这两种方法，第一种使用 subprocess.Popen，第二种使用 vte (python-vte)。

我只让 Popen 使用轮询工作。我必须不断检查进程是否有要读取的数据，读取数据，然后将其发送到我的 TextArea。建议改用 gobject.io_add_watch()，但每当我尝试让我的程序在第二次调用 io_add_watch 时挂起——就好像它一次只能处理一个文件描述符。

vte 效果很好，但我还没有找到一种可靠的方法来捕获输出。您可以在光标移动时获得回调，然后使用 get_text() 进行屏幕抓取，但我已经遇到过这样的情况，即我正在查看的这些程序一次性生成了一个淫秽的 tty，然后它就离开了屏幕。似乎没有包含要添加到窗口的新文本的回调。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T09:33:18.117

[我使用subprocess.Popen](http://docs.python.org/library/subprocess.html#popen-objects)做了类似的事情。对于每个进程，我实际上最终将 stdout 和 stderr 重定向到一个临时文件，然后定期检查文件是否有更新并将输出转储到[TextView](http://www.pygtk.org/docs/pygtk/class-gtktextview.html)中。

不使用流程的管道的原因是流程本身是易变的并且容易出现段错误。发生这种情况时，我有时会在上次读取和段错误之间丢失数据（这是确定段错误原因最需要的数据）。

事实证明，有时我想保存特定进程的输出，所以这种方法对我来说效果很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T09:39:28.167

如果您接受 igkuk 的建议，我得到了[一些关于查看文件以了解](https://stackoverflow.com/questions/182197/how-do-i-watch-a-file-for-changes-using-python)相关问题更改的好建议。这对我来说效果很好（我正在查看日志文件以进行更改）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T10:15:39.543

您想使用[select](http://docs.python.org/library/select.html)来监视子流程中的管道。这比投票要好。

# .net - 我可以从 .NET 运行 DBCC CHECKDB 吗？

> ID：896876
> 
> 赞同：5
> 
> 时间：2009-05-22T08:29:50.973
> 
> 标签：.net, sql-server, tsql, ado.net, sql-server-administration

我正在编写一个计划作业来模拟 SQL Express 的 SQL Server 维护计划。（我必须这样做，因为 SQL Express 不存在 SQL 代理和相关工具）

其中一个步骤是进行数据库完整性检查。用于此的 TSQL 是：

```
DBCC CHECKDB(N'Northwind')  WITH NO_INFOMSGS 
```

我如何知道在执行此命令期间是否发生错误，在使用 ADO.NET 时是否会引发***异常***，或者我是否必须解析命令的***文本输出***（如果是，我在输出中查找什么）

这很难测试，因为我手头没有损坏的数据库。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-02-16T20:04:11.110

您可以使用`TABLERESULTS`带有`CHECKDB`( `DBCC CHECKDB WITH TABLERESULTS`) 的选项。这将为您提供一个记录集，其中包含`Error`, `Level`, `State`,等列`MessageText`（以及许多其他列）。

该`Level`记录集的列（严重性级别）应该足以确定是否有任何错误。

MS 表示，级别 11 到 16 是“由用户生成的，并且可以由用户更正”。所以我想说 17 以上的任何东西都应该意味着：停止做任何备份（以避免用损坏的备份覆盖好的备份），如果可能的话让系统脱机，并立即通知操作员。

11 到 16 级可能也应该报告给操作员（通过常规电子邮件或其他方式），以便他在必要时进行检查。（虽然我不确定是否`CHECKDB`会报告级别 11 到 16 的错误。但是，将代码记录错误/通知操作员可能不会受到伤害。）

**注意**：如果您与 结合`TABLERESULTS`使用`NO_INFOMSGS`，并且如果`CHECKDB`没有发现任何错误，您将*不会*得到*任何*记录集，甚至没有一个没有行的记录集。

**注意2**：在某些情况下，`CHECKDB`只会失败并显示错误代码。到目前为止，我只看到一个触发此错误的错误，它看起来像这样：

```
Msg 211, Level 23, State 51, Line 3
Possible schema corruption. Run DBCC CHECKCATALOG.
Msg 0, Level 20, State 0, Line 0
A severe error occurred on the current command.  The results, if any, should be discarded. 
```

我不怎么使用 ADO.NET，但我认为 ADO.NET 会通过抛出异常来做出反应。此外，由于这是一个严重性 >= 20 的错误，它将导致客户端连接被关闭。

* * *

总结一下：我会跑`DBCC CHECKDB WITH TABLERESULTS`. 如果命令失败，则存在问题（可能是严重问题）。如果没有，继续遍历结果集，并查找任何严重级别 >= 17。如果找到，则可能也存在某种严重问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-22T08:38:06.323

是的，我相信您需要处理从 DBCC CHECKDB 返回的文本输出。

为了帮助您进行测试，以下参考详细说明了如何故意破坏 SQL Server 数据库。

[http://sqlblogcasts.com/blogs/tonyrogerson/archive/2007/03/10/how-to-create-a-corrupt-database-using-bulk-insert-update-and-bcp-sql-server-as- a-hex-editor.aspx](http://sqlblogcasts.com/blogs/tonyrogerson/archive/2007/03/10/how-to-create-a-corrupt-database-using-bulk-insert-update-and-bcp-sql-server-as-a-hex-editor.aspx)

# android - 模拟器上的 GPS 没有得到地理修复 - Android

> ID：896889
> 
> 赞同：6
> 
> 时间：2009-05-22T08:34:34.477
> 
> 标签：android, eclipse, gps

我正在为安卓操作系统开发一个应用程序，我才刚刚开始，但我无法让模拟器上的 GPS 工作。我在互联网上读到您需要向模拟器发送地理修复以启用 gps locationProvider。我都在使用 DDMS 和 telnet 来尝试发送它，但是 logcat 从来没有告诉我它收到了一个新的修复程序，而且我的道歉仍然认为 gps 被禁用

这是我的代码

```
package eu.mauriziopz.gps;

import java.util.Iterator;
import java.util.List;

import android.app.Activity;
import android.content.Context;
import android.location.LocationManager;
import android.os.Bundle;
import android.util.Log;

public class ggps extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        LocationManager l =(LocationManager) getSystemService(Context.LOCATION_SERVICE);
        List<String> li = l.getAllProviders();
        for (Iterator<String> iterator = li.iterator(); iterator.hasNext();) {
            String string =  iterator.next();
            Log.d("gps", string);
        }
        if (l.getLastKnownLocation("gps")==null)
            Log.d("gps", "null");   
    }
} 
```

我读过 DDMS 可能无法在非英语操作系统上正常工作，但 telnet 应该可以工作！

更新：在设置中启用了gps

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-25T11:56:47.387

事实证明，因为我是为 Android 1.5（而不是 Google API 1.5）开发的，所以地图（看起来像其他功能）被禁用了。一旦我更改了目标平台，我的错误就消失了。

顺便说一句，谢谢大家

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-25T08:00:20.017

要测试 geofix 是否正常工作，您可以使用带有“我的位置”的 Google 地图应用

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-09-27T13:25:48.780

确保在设置中启用了 gps。如果问题仍然存在，您只需转到主菜单中名为 Navigation 的应用程序，运行它并退出。现在试试你的应用程序。您可以通过选择特定设备在 DDMS 透视图中启用模拟器控制下的位置控制。如果不选择设备，它将无法工作

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-25T15:51:18.003

我想已经修复了，但是在代码中你应该使用 LocationManager 服务返回的字符串作为提供者，而不是你输入的“gps” `l.getLastKnownLocation("gps")`。

# vba - Outlook VBA 根据收件人域更改电子邮件签名？

> ID：896895
> 
> 赞同：4
> 
> 时间：2009-05-22T08:37:04.813
> 
> 标签：vba, outlook

我想根据我发送电子邮件的域来更改我的电子邮件签名。

如果我在内部（我公司的域）发送电子邮件，请使用简短签名。如果至少有一个收件人是外部的，请使用长签名。

我猜我需要拦截某种“发送”事件，然后遍历收件人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T09:31:46.967

我不会用宏使它变得复杂。添加不同的签名，命名它们，然后插入签名的最快方法是使用键盘快捷键：

*   在**Outlook 2003**或更早版本（无功能区）下：[Alt] i + S，然后选择一个签名。
*   在**Outlook 2007**或更高版本（功能区）下：
    *   要么执行 [Alt] N + AS，然后选择一个签名。
    *   或者首先将签名按钮添加到*快速访问工具栏*（只需右键单击按钮并*添加*）。然后您可以使用 [Alt] + 1，然后选择一个签名。

# c# - WCF：将 Nonce 添加到 UsernameToken

> ID：896901
> 
> 赞同：27
> 
> 时间：2009-05-22T08:38:04.110
> 
> 标签：c#, wcf, web-services

我正在尝试连接到用 Java 编写的 Web 服务，但有些东西我想不通。

使用 WCF 和 customBinding，除了 SOAP 消息的一部分之外，几乎一切似乎都很好，因为它缺少 Nonce 和 Created 部分节点。显然我错过了一些东西，所以如果你能指出我正确的方向，那将不胜感激。

这是自定义绑定：

```
<binding name="CustomHTTPBinding">
    <security includeTimestamp="false" authenticationMode="UserNameOverTransport" defaultAlgorithmSuite="Basic256" requireDerivedKeys="True"
              messageSecurityVersion="WSSecurity10WSTrustFebruary2005WSSecureConversationFebruary2005WSSecurityPolicy11BasicSecurityProfile10">
    </security>
    <textMessageEncoding maxReadPoolSize="211" maxWritePoolSize="2132" messageVersion="Soap11"
                         writeEncoding="utf-8"/>
    <httpsTransport />
</binding> 
```

这是消息的相关部分：

```
<o:Security s:mustUnderstand="1" xmlns:o="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">
    <o:UsernameToken u:Id="uuid-c306efd1-e84c-410e-a2ad-1046b368582e-1">
        <o:Username>
            <!-- Removed-->
        </o:Username>
        <o:Password>
            <!-- Removed-->
        </o:Password>
    </o:UsernameToken>
</o:Security> 
```

这就是它的外观：

```
<wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" soapenv:mustUnderstand="1">
 <wsse:UsernameToken xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" wsu:Id="UsernameToken-25763165">
    <wsse:Username>..</wsse:Username>
    <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordDigest">..</wsse:Password>
    <wsse:Nonce>6ApOnLn5Aq9KSH46pzzcZA==</wsse:Nonce>
    <wsu:Created>2009-05-13T18:59:23.309Z</wsu:Created>
 </wsse:UsernameToken>
</wsse:Security> 
```

所以问题是：如何在安全部分中引入 Nonce 和 Created 元素？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2010-11-01T16:21:52.540

要创建随机数，我必须更改一些内容

首先，在我的配置中添加了一个自定义绑定

```
<system.serviceModel>
    <bindings>
      <customBinding>
        <binding name="myCustomBindingConfig">
          <security includeTimestamp="false" 
                    authenticationMode="UserNameOverTransport" 
                    defaultAlgorithmSuite="Basic256" 
                    requireDerivedKeys="true"
                    messageSecurityVersion="WSSecurity10WSTrustFebruary2005WSSecureConversationFebruary2005WSSecurityPolicy11BasicSecurityProfile10">
          </security>
          <textMessageEncoding messageVersion="Soap11"></textMessageEncoding>
          <httpsTransport maxReceivedMessageSize="2000000000" />
        </binding>
      </customBinding>
    </bindings>
</system.serviceModel>

<client>
    <endpoint address="https://..." [other tags] 
        binding="customBinding" bindingConfiguration="OrangeLeapCustomBindingConfig"/>
</client> 
```

然后，获取此处的代码：http: [//social.msdn.microsoft.com/Forums/en-US/wcf/thread/4df3354f-0627-42d9-b5fb-6e880b60f8ee](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/4df3354f-0627-42d9-b5fb-6e880b60f8ee) 并修改它以创建随机数（只是随机哈希，base-64 编码）

```
protected override void WriteTokenCore(System.Xml.XmlWriter writer, System.IdentityModel.Tokens.SecurityToken token)
{
    Random r = new Random();
    string tokennamespace = "o";
    DateTime created = DateTime.Now;
    string createdStr = created.ToString("yyyy-MM-ddTHH:mm:ss.fffZ");
    string nonce = Convert.ToBase64String(Encoding.ASCII.GetBytes(SHA1Encrypt(created + r.Next().ToString())));
    System.IdentityModel.Tokens.UserNameSecurityToken unToken = (System.IdentityModel.Tokens.UserNameSecurityToken)token;
    writer.WriteRaw(String.Format(
    "<{0}:UsernameToken u:Id=\"" + token.Id + "\" xmlns:u=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">" +
    "<{0}:Username>" + unToken.UserName + "</{0}:Username>" +
    "<{0}:Password Type=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText\">" +
    unToken.Password + "</{0}:Password>" +
    "<{0}:Nonce EncodingType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary\">" +
    nonce + "</{0}:Nonce>" +
    "<u:Created>" + createdStr + "</u:Created></{0}:UsernameToken>", tokennamespace));
}

protected String ByteArrayToString(byte[] inputArray)
{
    StringBuilder output = new StringBuilder("");
    for (int i = 0; i < inputArray.Length; i++)
    {
    output.Append(inputArray[i].ToString("X2"));
    }
    return output.ToString();
}
protected String SHA1Encrypt(String phrase)
{
    UTF8Encoding encoder = new UTF8Encoding();
    SHA1CryptoServiceProvider sha1Hasher = new SHA1CryptoServiceProvider();
    byte[] hashedDataBytes = sha1Hasher.ComputeHash(encoder.GetBytes(phrase));
    return ByteArrayToString(hashedDataBytes);
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2011-03-30T09:39:33.020

我有同样的问题。我使用 a在方法`MessageInspector`中添加正确的而不是自定义令牌序列化程序。然后我使用自定义行为来应用修复。`UsernameToken``BeforeSendRequest`

在我的博客文章[Supporting the WS-I Basic Profile Password Digest in a WCF client proxy 中](http://benpowell.org/supporting-the-ws-i-basic-profile-password-digest-in-a-wcf-client-proxy/)记录了整个过程（带有[演示项目](http://www.box.net/shared/lu3q83l6kr)） 。或者，您可以只阅读[PDF](http://www.box.net/shared/ooom8db1i0)。

如果您想了解我的解决方案进度，您可以在 StackOverflow 上找到标题为“ [WCF 客户端使用 WS-Security UsernameToken PasswordDigest 身份验证方案使用 Axis 2 Web 服务时出错](https://stackoverflow.com/questions/3102693/error-in-wcf-client-consuming-axis-2-web-service-with-ws-security-usernametoken-p)”：

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-10-16T09:30:22.173

值得指出的是，Rick Strahl 发表了一篇博文（他引用了这个问题），他非常清楚地解释了这一切，并为 Password 和 PasswordDigest 提供了解决方案。

我发布这个是因为我最初发现这篇文章，无法真正关注它，并且在很久以后才找到 Rick 的帖子。这可能会为一些人节省一些时间。

[WCF WSSecurity 和 WSE Nonce 身份验证](http://www.west-wind.com/weblog/posts/2012/Nov/24/WCF-WSSecurity-and-WSE-Nonce-Authentication)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-08-20T21:52:19.107

我还必须在 SOAP 消息头中放置一个 UserNameHeader 段：

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:urn="urn:bar:services" xmlns:efm="urn:bar:services">
   <soapenv:Header>
       <efm:UserNameHeader>
           <UserName>foouser</UserName>
           <Password>foopass</Password>
       </efm:UserNameHeader>
   </soapenv:Header>
   <soapenv:Body>
      <urn:GetUserList/>
   </soapenv:Body>
</soapenv:Envelope> 
```

这是通过自定义消息头完成的：

```
public class UserNamePasswordHeader : MessageHeader
{
    private readonly string _serviceUserEmail;
    private readonly string _serviceUserPassword;

    public UserNamePasswordHeader(string serviceUserEmail, string serviceUserPassword)
    {
        this._serviceUserEmail = serviceUserEmail;
        this._serviceUserPassword = serviceUserPassword;
    }

    public override string Name
    {
        get { return "UserNameHeader"; }
    }

    public override string Namespace
    {
        get { return "urn:bar:services"; }
    }

    protected override void OnWriteHeaderContents(XmlDictionaryWriter writer, MessageVersion messageVersion)
    {
        writer.WriteElementString("UserName", _serviceUserEmail);
        writer.WriteElementString("Password", _serviceUserPassword);
    }
} 
```

可以轻松添加其他标签，例如`Nonce`和。`Created`

该类的使用如下：

```
var service = new BarServiceClient();
service.ClientCredentials.ClientCertificate.Certificate = MessageSigningCertificate;

using (new OperationContextScope(service.InnerChannel))
{
    OperationContext.Current.OutgoingMessageHeaders.Add(
      new UserNamePasswordHeader(serviceUserEmail, serviceUserPassword));

    try
    {
        var response = service.GetUserList();
        return response;
    }
    finally
    {
        service.Close();
    }
} 
```

注意：MessageSigningCertificate 是一个 X.509 证书，我从一个文件中读取它：

```
private static X509Certificate2 LoadCertificateFromFile(string pfxFilePath, string privateKeyPassword)
{
    // Load the certificate from a file, specifying the password
    var certificate = new X509Certificate2(pfxFilePath, privateKeyPassword);
    return certificate;
} 
```

# perl - 如何在 Perl 中睡一毫秒？

> ID：896904
> 
> 赞同：82
> 
> 时间：2009-05-22T08:38:21.957
> 
> 标签：perl, sleep

如何在 Perl 中睡不到一秒钟？

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2009-05-22T08:44:19.120

从关于[sleep](http://perldoc.perl.org/functions/sleep.html)的 Perldoc 页面：

> 对于比一秒更精细的延迟，[Time::HiRes](http://perldoc.perl.org/Time/HiRes.html)模块（来自 CPAN，从标准发行版的 Perl 5.8 部分开始）提供了 usleep()。

实际上，它提供`usleep()`（以微秒为单位休眠）和`nanosleep()`（以纳秒为单位休眠）。您可能需要`usleep()`，这应该可以让您处理更容易的数字。1 毫秒睡眠（使用每个）：

```
use strict;
use warnings;

use Time::HiRes qw(usleep nanosleep);

# 1 millisecond == 1000 microseconds
usleep(1000);
# 1 microsecond == 1000 nanoseconds
nanosleep(1000000); 
```

如果您不想（或不能）加载模块来执行此操作，您也可以使用内置[`select()`](http://perldoc.perl.org/functions/select.html)函数：

```
# Sleep for 250 milliseconds
select(undef, undef, undef, 0.25); 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-05-22T08:43:28.577

时间::HiRes:

```
 use Time::HiRes;
  Time::HiRes::sleep(0.1); #.1 seconds
  Time::HiRes::usleep(1); # 1 microsecond. 
```

[http://perldoc.perl.org/Time/HiRes.html](http://perldoc.perl.org/Time/HiRes.html)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-05-22T11:21:45.620

从[perlfaq8](http://faq.perl.org/perlfaq8.html#How_can_I_sleep_or_a)：

* * *

**我怎样才能 sleep() 或 alarm() 不到一秒钟？**

如果您想要比 sleep() 函数提供的 1 秒更精细的粒度，最简单的方法是使用 select() 函数，如 select in perlfunc 中所述。试试 Time::HiRes 和 BSD::Itimer 模块（可从 CPAN 获得，从 Perl 5.8 开始 Time::HiRes 是标准发行版的一部分）。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-22T08:44:02.617

使用[时间::HiRes](http://perldoc.perl.org/Time/HiRes.html)。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-22T08:44:05.563

对“perl 高分辨率计时器”的快速谷歌搜索给出了对[Time::HiRes](http://search.cpan.org/dist/Time-HiRes/HiRes.pm)的引用。也许这就是你想要的。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2017-02-23T23:03:01.177

```
system "sleep 0.1"; 
```

成功了。

# sql - 在运行大量插入时选择数百万条记录

> ID：896907
> 
> 赞同：4
> 
> 时间：2009-05-22T08:39:05.747
> 
> 标签：sql, sql-server, select, concurrency

我正在尝试从单个表中提取应用程序日志文件。选择查询语句非常简单。

```
select top 200000 * 
from dbo.transactionlog 
where rowid>7 
and rowid <700000 and 
Project='AmWINS' 
```

上述选择的查询时间在 5 分钟以上。算不算长？在选择运行时，批量插入也在运行。

[编辑]

实际上，我当前的生产日志记录数据库存在严重问题，基本上，我们只有一个表（事务日志）。所有应用程序日志都将插入到该表中。对于像 AmWINS 这样的项目，根据选择计数结果，我们每天插入大约 800K++ 记录。记录插入在生产环境中每天 24 小时运行。如果用户想检查事务日志，用户想从表中提取数据。因此，如果需要，我们需要从表中选择记录。

我尝试在 UAT 环境中进行模拟，以根据 Production 输入卷，到目前为止，该卷已经增长到 1000 万条记录。在我尝试提取记录的同时，我使用批量插入进行模拟，使其看起来符合生产环境。提取 20 万条记录需要 5 分钟。

在提取运行期间，我监控 SQL 物理服务器 CPU 的峰值高达 95%。

这些表有 13 个字段和一个带有 bigint 的身份打开（rowid）。rowid是PK。索引是在 Date、Project、module 和 RefNumber 上创建的。这些表是在启用行锁和页锁时创建的。我正在使用 SQL Server 2005。

希望大家可以给我一些专业的建议来启发我。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T09:50:34.353

您可能可以使用“Nolock”表提示，如下所述：

[表提示 MSDN](http://msdn.microsoft.com/en-us/library/ms187373(SQL.90).aspx)

你的 SQL 会变成这样：

```
select top 200000 * from dbo.transactionlog with (no lock) ... 
```

如果您不关心返回数据的完全准确性，这将获得更好的性能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T11:55:57.983

你在用 200,000 行做什么？你是在网络上运行它吗？根据表格的宽度，仅通过网络获取大量数据可能是花费的大部分时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T08:43:26.907

这取决于您的硬件。在插入数据时拉出 200000 行需要一些严重的 IO，因此除非您有 30 多个磁盘系统，否则它会很慢。

另外，您的 rowID 列是否已编入索引？这将有助于选择，但可能会减慢批量插入。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T08:46:19.817

我不确定，但是 MS SQL 中的批量插入不会锁定整个表吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-11T14:01:15.577

您也可以将其导出为本地 dat 或 sql 文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-22T09:07:17.577

正如ck已经说过的。索引很重要。因此，请确保您已准备好适当的索引。我不仅会在 rowId 上设置索引，还会在 Project 上设置索引。此外，我会将 where 子句重写为：

```
WHERE Project = 'AmWINS' AND rowid BETWEEN 8 AND 699999 
```

原因：我猜 Project 比 rowid 更具限制性 - 纠正我，如果我错了 - BETWEEN 比 < 和 > 比较快。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-22T09:31:48.510

在这里没有多少索引会有所帮助，因为它是一个 SELECT * 查询，所以它很可能是一个 PK 扫描或一个可怕的预订查找

TOP 是没有意义的，因为没有 ORDER BY。

据我所知，同时插入可能会产生误导，除非表只有 2 列并且批量插入锁定了整个表。使用简单的 int IDENTITY 列，插入和选择也可能不会相互干扰。

特别是如果批量插入只有几 1000 行（甚至 10,000 行）

编辑。TOP 和 rowid 值并不意味着超过一百万

# sql - RESTRICTED_USER

> ID：896919
> 
> 赞同：7
> 
> 时间：2009-05-22T08:41:58.517
> 
> 标签：sql, sql-server, tsql, sql-server-administration

在更改数据库架构之前，我发出：

```
ALTER DATABASE SET RESTRICTED_USER 
```

在结束的时候：

```
ALTER DATABASE SET MULTI_USER 
```

我了解正在运行的事务将被允许继续直到完成。

问：有什么方法可以等到所有普通用户都离开数据库？

Q：普通用户可以发更多的交易吗？他们可以继续工作直到与服务器断开连接吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T08:53:18.557

来自 SQL Server 联机丛书

[http://msdn.microsoft.com/en-us/library/aa933082(SQL.80).aspx](http://msdn.microsoft.com/en-us/library/aa933082(SQL.80).aspx)

> 如果终止子句被省略，ALTER DATABASE 语句会无限期地等待，直到事务自行提交或回滚。

所以 SET RESTRICTED_USER 会等到所有事务都完成后才会生效。

一旦到位，普通用户就不能发出进一步的事务，只有 db_owner 固定数据库角色和 dbcreator 和 sysadmin 固定服务器角色的成员可以连接到数据库。

# c# - “异步未来 “还是什么？未来 在后台线程中获得——它是一种模式吗？

> ID：896936
> 
> 赞同：8
> 
> 时间：2009-05-22T08:47:22.920
> 
> 标签：c#, multithreading, design-patterns

我想在后台线程中完成一些工作，就像为它创建一个 Future var 然后稍后询问计算值一样简单。

在伪 C# 代码中：

```
AsyncFuture<int> asyncFuture = new AsyncFuture<int>(FuncToCalculateValue);

//do some other work, or draw UI

if(asyncFuture.NoErrorsHappened){
   int realResult = asyncResult.Value;
} 
```

我可以自己实现这种类型，但我的问题是：这不是某种已知的模式吗？是否有它的名称，或者甚至是框架实现？可能在 .NET 4.0 中？

如果它是一种模式，与之相关的陷阱是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T13:16:38.790

是的， Futures 是.NET 4.0[中的任务并行库的一部分。](http://blogs.msdn.com/pfxteam/archive/2008/02/29/7960146.aspx)

在 .NET 4.0 Beta 1 中，它看起来像以[`Task<TResult>`](http://msdn.microsoft.com/en-us/library/dd321424(VS.100).aspx).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T08:54:55.137

在 Java 中，使用[Future 的代码结构也非常相似](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/Future.html)。

您可能会将“做一些其他工作或绘制 UI”作为参数代码？这可以看作是一个**模板方法**。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T13:27:37.380

Yacoder，我真的很喜欢[Ayende 的两个 Future 实现](http://ayende.com/Blog/archive/2008/01/02/Its-the-future-now.aspx)。[Jon Skeet](http://ayende.com/Blog/archive/2008/01/02/Its-the-future-now.aspx#20542)在关于缺点的评论中有一些[很好的讨论。](http://ayende.com/Blog/archive/2008/01/02/Its-the-future-now.aspx#20529)

# git - git如何控制访问权限

> ID：896938
> 
> 赞同：0
> 
> 时间：2009-05-22T08:47:36.040
> 
> 标签：git, permissions

我使用的是hostingrails.com的租用服务器，我在这里用FastCGI操作Rails，根据SuExec使用的关系，755以上的似乎无法设置权限并且相当适合。（例如，我不能与 775 一起使用）我使用 git 进行开发。我设置为 775 并且不能使用我从 git 签出的东西与服务器在我的 PC（MacOSX）中使用 755 提交它你能帮帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T20:56:43.830

你是直接通过 Git 部署的吗？或者您正在使用 Capistrano 部署？

如果您使用 Capistrano ...您当然可以在生产任务中添加一个修改权限的步骤。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T21:08:56.957

[在您的主机论坛](http://www.hostingrails.com/forums)上询问此问题或联系他们的支持人员可能是一个更好的主意。

# c# - 通过 ref 或按值 (C#) 传递方法参数的一般简短指南？

> ID：896943
> 
> 赞同：6
> 
> 时间：2009-05-22T08:49:56.037
> 
> 标签：c#, parameters, methods, parameter-passing

就像是：

*   如果必须返回方法调用后的变量值：
*   if 可以在方法调用之前实例化使用 ref
*   if 不需要在调用前实例化

*   如果变量的值用于返回、决定或计算方法调用中的其他值，则不要使用 ref 和 out

我得到正确了吗？你的简短指导方针是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T08:58:22.493

对于值类型：

*   如果您只想使用包含的值而不是在原始位置更改它，请使用默认传递方法（按值）
*   如果您需要在原始商店中更改它，请使用 ref. 例子 ：

    ```
    int a = -3;

    protected void EnsurePositiveValues(ref int value)
    {
        if (value < 0)
            value = 0;
    } 
    ```

对于参考类型：

*   如果您只需要使用实例或更改它，请使用默认传递方法（通过引用；应称为“通过引用复制”）
*   如果您需要（重新）分配原始参考，请使用 ref。例子 ：

    ```
    User u = MembershipAPI.GetUser(312354);

    protected void EnsureUser(ref User user)
    {
        if (user == null)
            user = new User();
    } 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T08:58:56.533

您还需要考虑值和引用类型。将引用类型作为参数传递给方法时，将*指针*传递给变量。这意味着您可以在方法内部对变量进行更改，并且它们将可用于调用该方法的代码，但是如果您将其设置为 null，您只是将指针设置为 null，并且当您使用方法返回。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T08:55:42.187

不确定这是否真的回答了您的问题，但我发现通过 ref 传递值（使用 out 关键字）的一种很好的用法是......

```
int i = 0;

if (int.TryParse("StringRepresentation", out i)
{
    // do something with i which has taken the value of a the previous successful TryParse
} 
```

# java - 跟进：没有枚举的Java中的实例控制

> ID：896945
> 
> 赞同：6
> 
> 时间：2009-05-22T08:50:47.767
> 
> 标签：java

[这是对这个问题](https://stackoverflow.com/questions/892304/how-to-guarantee-java-instance-control-without-enum-in-world-of-serialization)的跟进。这个解决方案防水吗？

```
public final class Thing implements Serializable {

    private static final long serialVersionUID = 1L;

    private static final Thing[] instances = new Thing[2];
    private static int nextOrdinal = 0;

    public static final Thing instance0 = new Thing("whatever0");
    public static final Thing instance1 = new Thing("whatever1");

    private transient final String someState;

    public String someMethod() {return someState;}

    private final int ordinal;

    private Thing(String someState) {
        this.someState = someState;
        this.ordinal = nextOrdinal++;
        instances[this.ordinal] = this;
    }

    private Object readResolve() throws ObjectStreamException {
        return instances[this.ordinal];
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-22T10:01:36.763

> 这个解决方案防水吗？

不。（虽然它可能就足够了，这取决于代码的使用方式和位置。）

在*Item 77: For instance control, prefer enum types to readResolve*（[Effective Java, 2nd ed](http://java.sun.com/docs/books/effective/)）中，Bloch 演示了攻击者如何让像你这样的类返回任何值。该攻击依赖于手工制作的字节输入并能够在目标上运行代码（因此，如果在沙盒环境、某些 RMI 案例等中使用您的代码可能存在安全风险）。我不知道这是否是唯一的攻击 - 它是唯一提到的攻击。解决方案是声明所有字段都是瞬态的，但是您遇到了如何存储值的问题。

您可以使用*序列化代理模式*解决这些问题（书中的第 78 条 - 每个阅读过它的 Java 程序员都推荐它是有原因的）。

```
public final class Thing implements Serializable {
  private static final long serialVersionUID = 1L;
  private static final Thing[] INSTANCES = new Thing[2];
  private static int NEXT_ORDINAL = 0;

  public static final Thing INSTANCE0 = new Thing(
      "whatever0");
  public static final Thing INSTANCE1 = new Thing(
      "whatever1");

  private transient final String someState;

  public String someMethod() {
    return someState;
  }

  private final int ordinal;

  private Thing(String someState) {
    this.someState = someState;
    ordinal = NEXT_ORDINAL++;
    INSTANCES[ordinal] = this;
  }

  private Object writeReplace() {
    return new ThingProxy(this);
  }

  private void readObject(ObjectInputStream stream)
      throws InvalidObjectException {
    throw new InvalidObjectException("Proxy required");
  }

  private static class ThingProxy implements Serializable {
    private static final long serialVersionUID = 1L;
    private final int ordinal;

    private ThingProxy(Thing t) {
      ordinal = t.ordinal;
    }

    private Object readResolve()
        throws ObjectStreamException {
      return INSTANCES[ordinal];
    }

  }

} 
```

不过，就像从互联网上复制任何与安全相关的东西一样，买者自负。我绝不是专家。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T09:00:41.693

这段代码仍然缺少 Enum 的一些有趣特性：

*   缺少“values()”作为所有枚举值 的**迭代器**
*   仍然缺少**远程迭代器**
*   不能用于开关

## 例子

```
public final class Day implements Serializable {

    private static final long serialVersionUID = 1L;
    private static Day[] instances = new Day[7];
    public static final Day MONDAY = new Day("Monday");
    public static final Day TUESDAY = new Day("Tuesday");
    public static final Day WEDNESDAY = new Day("Wednesday");
    public static final Day THURSDAY = new Day("Thursday");
    public static final Day FRIDAY = new Day("Friday");
    public static final Day SATURDAY = new Day("Saturday");
    public static final Day SUNDAY = new Day("Sunday");
    private static int nextOrdinal = 0;
    private transient final String name;
    private final int ordinal;

    private Day(String aName) {
        this.name = aName;
        this.ordinal = nextOrdinal++;
        instances[this.ordinal] = this;
    }

    private Object readResolve() throws ObjectStreamException {
        return instances[this.ordinal];
    }

    public String toString() {
        return name;
    }

    public boolean equals(Object obj) {
        return obj instanceof Day && ((Day) obj).ordinal == ordinal;
    }

    public int hashCode() {
        return name.hashCode();
    }

    public static Iterator values() {
        return new Iterator() {

            private int i = 0;

            public boolean hasNext() {
                return i < instances.length;
            }

            public Object next() {
                return instances[i++];
            }

            public void remove() {
                throw new UnsupportedOperationException("Not supported.");
            }
        };
    }

    public static Iterator range(final Day from, final Day to) {
        return new Iterator() {

            private int i = from.ordinal;

            public boolean hasNext() {
                return i <= to.ordinal;
            }

            public Object next() {
                return instances[i++];
            }

            public void remove() {
                throw new UnsupportedOperationException("Not supported.");
            }
        };
    }

    public static void main(String[] args) {
        Iterator week = Day.values();

        while (week.hasNext()) {
            System.out.println(week.next());
        }

        Iterator weekEnd = Day.range(SATURDAY, SUNDAY);

        while (weekEnd.hasNext()) {
            System.out.println(weekEnd.next());
        }
    }
} 
```

# windows - 如何确定 Windows 机器的身份？

> ID：896946
> 
> 赞同：2
> 
> 时间：2009-05-22T08:51:00.543
> 
> 标签：windows, winapi, identity

我有一个由服务器和客户端进程组成的程序。两者都在 Windows 系统上运行 - Windows 2000 或更高版本。这两个进程可以在同一台机器上运行，也可以在两台不同的机器上运行。

客户端如何确定它是否与服务器运行在同一台机器上？如果服务器未运行，则客户端无论如何都无法工作，并且不关心服务器可能在哪里 - 所以这种情况是不可能的。我听说每台 Windows 机器都有一个 UUID - 我可以获取它并用于此目的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T08:58:41.603

[上一个关于生成](https://stackoverflow.com/questions/99880/generating-a-unique-machine-id)可能有帮助的唯一机器 ID 的问题。 [链接到之前提到 MachineGUID 的答案](https://stackoverflow.com/questions/99880/generating-a-unique-machine-id/730611#730611)

将 API 添加到报告其机器名称的服务器很简单。环境变量是 COMPUTERNAME。客户可以检查，对吗？

你需要处理这些情况吗？

1.  客户端正在运行，但服务器没有响应，您想知道无响应的服务器是否在远程计算机上。
2.  客户端和服务器在同一主机上的两个不同虚拟机中运行，您希望将其报告为“在同一台机器上运行”。
3.  客户端运行在与服务器运行在同一台机器上的虚拟机中，您希望将其报告为“在同一台机器上运行”。
4.  客户端和服务器在不协调的网络上运行，并且可能都被分配了相同的名称。
5.  服务器可能是敌对的，并会试图欺骗客户端。

网卡将具有唯一的 MAC。如果服务器和客户端都报告相同的 MAC，那么它们使用的是相同的网卡。如果客户端和服务器都运行在不同的虚拟机上但使用相同的网卡，你认为它们运行在同一台机器上还是不同的机器上？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T10:38:03.913

Windows 网络要求计算机名称是唯一的，因此调用 GetComputerName api 并让客户端和服务器交换名称（并将接收到的名称与他们看到的名称进行比较）就足够了。如果客户端和服务器可以彼此独立启动，那么您将需要某种协议来完成此过程。客户端发起交换似乎是合乎逻辑的，而服务器仅在从客户端接收到名称时才发送其名称。然后，如果客户端看到相同的名称，它可以中止连接。

我相信大多数虚拟机系统都会允许虚拟机有自己的名字，所以你应该仍然可以在虚拟机上进行测试。但是我对所有虚拟化技术没有丰富的经验，所以不能肯定地说。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T08:54:05.433

尝试建立环回 tcp 连接怎么样？或者可能检查服务器在预定义文件夹中创建的某些锁定文件...

我不知道具体是怎么做的，但是 Win32 中肯定有与 Unix 中的 /proc 文件系统等效的东西（我认为 windows 任务管理器有免费的替代品，也许你可以查看它们的来源），你可以在其中搜索你的服务器过程。

# c# - RDP ActiveX Ctrl+Alt+Del

> ID：896947
> 
> 赞同：0
> 
> 时间：2009-05-22T08:52:20.553
> 
> 标签：c#, terminal-services

在我们的 C# 应用程序中，我们将 RDP 查看器用作 ActiveX 控件。该应用程序有自己的带有++`Ctrl`按钮的工具栏。ActiveX 控件上似乎没有执行此功能的方法。我知道您可以在键盘上点击++ ，这很好，但是我如何通过单击工具栏按钮来做到这一点？`Alt``Del``Ctrl``Alt``End`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T10:15:37.890

尝试使用[SendKeys 类](http://msdn.microsoft.com/en-us/library/system.windows.forms.sendkeys.send.aspx)。

在这个例子中，你可以这样发送`CTRL`++ `ALT`：`END`

```
 SendKeys.Send("(^%{END})"); 
```

# c++ - 将lib +头文件转换为DLL

> ID：896949
> 
> 赞同：6
> 
> 时间：2009-05-22T08:52:37.043
> 
> 标签：c++, c, windows, dll

我有一个库（lib 文件 + .h 头文件）。我喜欢把它变成一个 DLL，这样我就可以在 VB6 中轻松使用它。有没有方便的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T12:44:46.420

只需在新的 dll 项目中包含头文件和 .def 文件，并将其与静态库链接。

如何使用 def 文件导出符号的详细信息在这里[http://msdn.microsoft.com/en-us/library/d91k01sh(VS.80).aspx](http://msdn.microsoft.com/en-us/library/d91k01sh(VS.80).aspx)

# .net - .NET 的 Rubygems 风格的实用程序？

> ID：896951
> 
> 赞同：1
> 
> 时间：2009-05-22T08:53:02.753
> 
> 标签：.net, gem

有没有类似 .NET 的 Ruby gems 之类的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-08-10T23:35:41.670

有一个名为 Nu 的新项目，它使用实际的 Ruby gems 框架来打包 .NET 组件。[http://groups.google.com/group/nu-net](http://groups.google.com/group/nu-net)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T19:21:22.740

我不确定您正在寻找 Ruby Gems 的哪些特征。如果您尝试部署自己的应用程序，您应该查看[ClickOnce](http://msdn.microsoft.com/en-us/library/t71a733d.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-09T10:49:56.283

Horn 是一个很有前途的新项目，应该做需要做的事情。 [http://code.google.com/p/hornget/](http://code.google.com/p/hornget/)

# xml - 如何使用 ant 针对 Schema 验证 XML 文件？

> ID：896954
> 
> 赞同：3
> 
> 时间：2009-05-22T08:53:21.160
> 
> 标签：xml, validation, ant, xsd

作为我的构建过程的一部分，我想根据 Schema (XSD) 验证 XML 文件。我正在尝试像这样使用 schemavalidate 任务：

```
<schemavalidate noNamespaceFile="schemas/Model.xsd" file="Model.xml"/> 
```

这会产生以下错误：

```
[...]
构建失败
build.xml:65：执行此行时发生以下错误：
build.xml:59：解析器不支持 Xerces 或 JAXP 模式特性

```

我正在使用最新的 ant 发行版（1.7.1）。是否需要任何其他库才能使验证正常工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-22T09:53:18.933

schemavalidate 任务实际上正在工作，如问题所示。

问题是 xsd 文件不存在。不幸的是，错误消息相当混乱。Ant 仅在以详细模式启动时才抱怨丢失的文件。

我要结束这个问题。

# silverlight - Silverlight：无法让 ScrollViewer 和 WrapPanel 一起工作

> ID：896959
> 
> 赞同：2
> 
> 时间：2009-05-22T08:55:00.237
> 
> 标签：silverlight, scrollviewer, wrappanel

我正在使用 WrapPanel 来格式化一些文本。在运行时，我将 TextBlocks 和 StackPanels 添加为子项。显然我需要一个滚动条，具体取决于数据大小。在网上搜索我发现了多个答案，它们都建议在 WrapPanel 周围放置一个 ScrollViewer。这对我来说很有意义，但我无法让它发挥作用。这是我的代码：

```
scrollView = new ScrollViewer();
scrollView.HorizontalScrollBarVisibility = ScrollBarVisibility.Disabled;
scrollView.VerticalScrollBarVisibility = ScrollBarVisibility.Auto;
scrollView.HorizontalAlignment = HorizontalAlignment.Stretch;
scrollView.VerticalAlignment = VerticalAlignment.Stretch;
scrollView.Margin = new Thickness(0);
scrollView.BorderThickness = new Thickness(0);  

textPanel = new WrapPanel();
textPanel.Width = Width;
scrollView.Content = textPanel; 
```

那是行不通的。ScrollViewer 似乎随着包含的 WrapPanel 一起增长。如果我将垂直滚动条设置为可见，我可以看到滚动条随着内容的增长而增长。但是 ScrollViewer 从包含窗口中长出来，因此永远不会显示滚动条。

任何暗示我可能做错了什么？

干杯，阿奇姆

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T16:49:02.497

您需要一些东西来限制 WrapPanel 和 ScrollViewer 的大小 - 您可以设置查看器的宽度和高度，然后在 wrappanel 上使用元素绑定：

```
 <ScrollViewer x:Name="ScrollViewer1" 
Width="200" 
Height="200"  
ScrollViewer.VerticalScrollBarVisibility="Visible"
  ScrollViewer.HorizontalScrollBarVisibility="Visible" >
                <controls:WrapPanel 
                      Width="{Binding ElementName=ScrollViewer1, Path=Width}" 
                      Height="{Binding ElementName=ScrollViewer1, Path=Height}"> 
```

希望有帮助。

伊恩

# asp.net - ViewState 占用了我 20% 的页面，即使它被禁用了！

> ID：896962
> 
> 赞同：2
> 
> 时间：2009-05-22T08:55:44.090
> 
> 标签：asp.net, viewstate

我在 web.config 文件中禁用了视图状态（页面上的任何地方都没有 EnableViewState = true），但尽管如此，页面仍以相当大的视图状态呈现（40k 页面为 8k）。我用视图状态解码器检查了视图状态内容，发现我在页面上使用的多视图控件是有罪的。有没有办法让多视图控件停止使用视图状态？

我正在考虑创建一个从 MultiView 继承并覆盖 LoadViewState 和 SaveViewState 方法的控件类，但我将其作为最后的手段，有什么建议吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T10:48:58.340

这是一种很好的方法，可以摆脱每次回发时通过电线发送的视图状态。基本上，它将完整的视图状态作为会话变量存储在服务器上，并且只传输视图状态字段中的标识符。

压缩会在带宽方面为您节省一点点，而将视图状态从页面中取出将有相当显着的性能提升

以下文章解释了几种具有性能测量指标的技术以及[eggheadcafe](http://www.eggheadcafe.com/articles/20040613.asp)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-22T09:00:41.130

从 ASP.NET 2.0 开始， ViewState 隐藏字段的内部内容由“旧” ViewState（ViewState 状态包/字典）和**ControlState**组成。与 ViewState 不同，Control State 不能被禁用，它旨在提供 Control 正常运行所需的最少信息。

您不能禁用 ControlState 并且您要么忍受它要么在页面上使用不同（种类）的控件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-18T23:32:53.963

您可以覆盖您的页面（或基本页面）的渲染，扫描视图状态隐藏输入并将其从编写器中删除。

脚步：

*   做base.render
*   将 htmlwriter 内容输出到字符串
*   使用 __viewstate 删除输入
*   将新字符串写入 HTMLWriter。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-24T03:11:59.690

为了回答我自己的问题，我设法通过删除我在母版页中的表单 runat="server" 来摆脱视图状态，现在我只将真正需要回发的控件包含在带有 runat=server 的表单标记中。它似乎也在丢弃控制状态（这是我想要的，页面不会回发），但仍然需要进行更多调查。

剩下的唯一问题是，当我在页面上的任何位置添加表单 runat=server 标记时，多视图会找到我的表单标记并将其垃圾添加到隐藏的视图状态字段中，我认为只有当多视图包含在一个表单 runat="server" 标记，但它足够聪明（或在这方面足够愚蠢）无论如何都能找到表单标记。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T11:06:19.100

System.Web.UI.Page 类有一个名为 PageStatePersister 的属性，您可以在页面中覆盖该属性。在这里，您可以返回一个 PageStatePersister 类型的对象，该对象覆盖页面视图状态的默认持久性模式。

正如 Vikram 建议的那样，您可以使用 SessionPageStatePersister 将视图状态存储在会话中，而不是隐藏字段。但是您也可以实现自己的 PageStatePersister，将视图状态存储在缓存或数据库或文件中。无论您真正需要什么。

您不应该做的事情是使用 PageStatePersister 来丢弃视图状态，因为您的某些控件需要视图状态。

# c++ - 减小 Qt GUI 应用程序的大小

> ID：896968
> 
> 赞同：15
> 
> 时间：2009-05-22T08:58:47.687
> 
> 标签：c++, qt, dll, static-libraries

我正在学习使用 Qt Creator 开发应用程序。我在 Windows 下构建了一个简单的应用程序，依赖于使用 mingwm10.dll、QtCore4.dll、QtGui4.dll、QtNetwork4.dll。在 QtQui4.dll 中，我只使用了几个小部件，不需要所有其他小部件......是否可以缩小 QtGui4.dll 的大小或做其他事情来减少应用程序的部署大小？静态链接呢？它会嵌入整个 dll，还是只嵌入其中的一部分？Qt是否可以静态链接一些dll和动态链接一些dll？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-22T09:39:20.630

无法通过删除某些函数来缩小 QtGui4.dll。奇趣科技正在[研究这个](http://labs.trolltech.com/blogs/2009/04/17/size-matters/)，但好的解决方案似乎很遥远：

静态链接，我觉得在windows上是很成问题的。每次我尝试，这都是一场噩梦。

因此，您似乎被常规 DLL 卡住了。你唯一能做的（我为我的 Qt 应用程序做的是）：

*   使用[UPX](http://upx.sourceforge.net/)压缩您的 DLL

或者

*   在安装程序中使用强压缩

如果您已经对 dll 进行了 UPX，则无法通过安装程序压缩进一步减少它，但这可以减少其他文件。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-22T11:32:25.333

最好的方法是使用 configure 手动配置 Qt 库。通过发行

```
configure --help 
```

您将看到许多可能有助于减少磁盘和内存占用的选项。例如

```
--no-stl
--no-exceptions 
```

两者都可以减少应用程序的占用空间。您还可以修改 mkspec 为您的编译器使用更积极的优化标志。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T11:41:50.230

如果您静态链接，您最终会得到一个 1.5GB 的 exe，并且您会牺牲一些功能，例如插件。因此，除非您不想分发 dll，否则这并不值得。但是，是的，您可以尝试 Henrik 的建议，也可以排除 Webkit，这可能是最大的代码块。

# http - BizTalk HTTPReceive 请求响应与 BTSHTTPReceive.dll?ReqResp

> ID：896969
> 
> 赞同：1
> 
> 时间：2009-05-22T08:58:48.687
> 
> 标签：http, request, biztalk, response

我开始尝试 BizUnit 并注意到 Http 请求响应的 URL 为 BTSHTTPReceive.dll?ReqResp

我在文档中找不到关于使用*?ReqResp的任何内容*

这需要吗？还是它增加了一些价值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T13:23:29.010

这取决于您发送的是 GET 请求还是 POST 请求。一般而言（特别是对于 POST 请求），查询字符串可用于通过单个 BTSHTTPReceive.dll 托管多个接收位置，从而提供一种通过添加的查询字符串参数来区分每个请求位置的 URL 的方法。

对于 GET 请求，它也可以用作将数据传递到请求消息到适配器的一种方式。有关详细信息，请参阅[文档](http://msdn.microsoft.com/en-us/library/ms962150.aspx)。

# asp.net-mvc - 操作方法：ASP.NET MVC 中的 PageView 和控制器继承

> ID：896971
> 
> 赞同：4
> 
> 时间：2009-05-22T08:58:58.857
> 
> 标签：asp.net-mvc

如果我想为所有页面添加通用功能，我会创建一个 BasePage 并从中驱动所有 ASPX 页面，你如何对 MVC 中的 Pageviews 和 Controllers 做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T09:08:26.950

对于控制器来说，您只需继承`System.Web.Mvc.Controller`并添加自定义功能：

```
public class MyController : System.Web.Mvc.Controller
{
  public MyController() : base()
  {
    ViewData["someDataInMasterPage"] = "Hello World!";
  }
} 
```

如果您有一个母版页，它会尝试使用上面的键检索一些 ViewData，如果它们的控制器将从 MyController 继承，它将使其在您的所有视图中都可以访问。

您也可以从 ViewPage 继承来定义自定义功能。例如，请参阅这个 SO 问题：[Extended WebFormView in MVC](https://stackoverflow.com/questions/610890/extending-webformview-in-mvc)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T09:08:40.333

对于视图（您称它们为“页面浏览量”），您可能没有太多数据/行为可以在基类中分组，但您仍然可以。您将定义一个继承自 System.Web.UI.Page 的类，并将所有常见逻辑放在那里。然后在视图的代码隐藏文件中（在 ASP.NET MVC 1.0 中，视图的默认文件没有代码隐藏，但[您可以创建它](https://stackoverflow.com/questions/892007/how-to-add-code-beside-to-asp-net-mvc-view-in-visual-studio)）从这个公共类继承视图类。

对于控制器，您可以从 System.Web.Mvc.Controller 创建一个类，并将所有常见的东西放入其中。然后从这个类派生所有控制器类。对命名、命名空间和文件位置没有限制。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T09:12:01.200

如果您希望所有视图共享相同的脚本，请使用包含所有脚本功能的母版页并在其中放置一个占位符：

```
<asp:ContentPlaceHolder ID="MainContent" runat="server" /> 
```

然后每个子视图都引用母版页。

```
<%@ Page Title="" Language="C#" MasterPageFile="Site.Master" 
Inherits="OpenProjects.Web.Mvc.ApplicationView %>

<asp:Content ID="Content1" ContentPlaceHolderID="MainContent" runat="server">

</asp:Content> 
```

对于控制器，创建您自己的应用程序控制器，该控制器继承自已构建的 MVC 控制器，然后让您的控制器继承自该控制器，而不仅仅是控制器

# apache - Apache 未发送 304 响应（如果启用了 mod_deflate 和 AddOutputFilterByType）

> ID：896974
> 
> 赞同：27
> 
> 时间：2009-05-22T09:00:00.430
> 
> 标签：apache, http, httpd.conf, mod-deflate

我在我的 Apache httpd.conf 中添加了以下行：-

```
AddOutputFilterByType DEFLATE text/html text/css application/javascript application/x-javascript application/json 
```

我有一个包含脚本的 html 文件（test.html）：-

```
<script type="text/javascript" src="/test.js"></script> 
```

问题是，每次我加载 test.html 时，test.js 也会加载 HTTP 状态：200。

*问题是：为什么不满足条件 GET？*

如果我注释掉 httpd.conf 中的“AddOutputFilterByType”行，Apache 会发送 304。

如果我在 httpd.conf 中启用 AddOutputFilterByType，请求标头是：-

```
主持人：优化
用户代理：Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US; rv:1.9.0.10) Gecko/2009042316 Firefox/3.0.10 GTB5 (.NET CLR 3.5.30729) FirePHP/0.2.4
接受： */*
接受语言：en-us,en;q=0.5
接受编码：gzip，放气
接受字符集：ISO-8859-1,utf-8;q=0.7,*;q=0.7
保活：300
连接：保持活动
参考：http://optimize/
饼干：PHPSESSID=nbq6h0eeahkshkcbc6ctu2j2b4
If-Modified-Since: 2009 年 5 月 19 日星期二 07:06:46 GMT
如果-无匹配：“2000000000717f-2c25a-46a3e8dcc2ad8”-gzip
缓存控制：max-age=0

```

响应头是：-

```
日期：格林威治标准时间 2009 年 5 月 22 日星期五 07:03:40
服务器：Apache/2.2.9 (Win32) PHP/5.2.6
最后修改时间：2009 年 5 月 19 日星期二 07:06:46 GMT
Etag：“2000000000717f-2c25a-46a3e8dcc2ad8”-gzip
接受范围：字节
变化：接受编码
内容编码：gzip
内容长度：52583
保活：超时=5，最大值=98
连接：保持活动
内容类型：应用程序/javascript

```

**更新**：我注意到，如果我禁用 ETag，它可以正常工作。我的意思是它发送304。

```
FileETag None 
```

但我真的很想保持 ETag 原样（我知道存在 inode 披露问题）。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-07-09T03:52:08.997

这是 Apache 中的一个已知错误。请参阅[Apache 错误 #45023](https://issues.apache.org/bugzilla/show_bug.cgi?id=45023)以及[Apache 304 etags 和 mod_deflate 的摘要](http://scarff.id.au/blog/2009/apache-304-and-mod_deflate-revisited/)。

从 svn 重建将解决此问题。解决方案是恢复将“-gzip”附加到 etag 的更改。但是，存在相关的 HTTP 合规性问题。

如果您无法重建 Apache，错误报告中有建议的运行时配置解决方法：

```
 RequestHeader  edit "If-None-Match" "^\"(.*)-gzip\"$" "\"$1\""
 Header  edit "ETag" "^\"(.*[^g][^z][^i][^p])\"$" "\"$1-gzip\"" 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2016-07-27T15:40:24.593

> “我还认为 ETag 在 Apache 中并没有那么有用。”
> 
> > 错误，
> > 例如您有一个修改日期设置为 的文件`'2016.07.27 05:00:00'`，您将其上传到您的站点，浏览器使用 HTTP 代码 200 获取此文件，然后将其缓存并每次使用 HTTP 304 重新验证。
> > 接下来您上传一个具有相同文件名的文件再次，但具有较旧的时间戳`'2013.07.27 05:00:00'`和其他内容。
> > 
> > 如果在服务器上禁用了 ETag，浏览器将仅使用`If-Modified-Since:`请求来确定服务器上的文件是否已更改，因此请求将为`If-Modified-Since: 2016.07.27 05:00:00`，但在此日期之后文件不会被修改，因此即使文件已更改，也会返回 HTTP 304 .
> > 
> > 如果在服务器上启用了 ETag，除此之外`If-Modified-Since:`，还会有一个`If-None-Match:`来自浏览器的标头将检测到该文件已更改（默认情况下 - 时间戳不匹配 + 大小不匹配）并且文件将被重新下载。

这个问题在 Apache 2.4.23 中仍然存在，所以，我写了一个比上面更好的代码来解决这个问题。逐行展开：

您可以使用负前瞻或负后瞻，正则表达式速度相同，Apache 支持两者

```
\"(.+(?<!-gzip))\"       #using negative lookbehind
\"((?:.(?!-gzip\"))+)\"  #using negative lookahead 
```

测试用例：

> 将此代码复制粘贴到 Apache .conf

```
SetEnvIf           If-None-Match "-gzip\"$" request_etag=gzip
RequestHeader edit If-None-Match "(.+)-gzip\"$" "$1\""
Header edit        ETag     "(.+(?<!-gzip))\"$" "$1-gzip\"" "expr=reqenv('request_etag') == 'gzip' || resp('Content-Encoding') == 'gzip'" 
```

> 我个人使用以下代码，如果它是 gzip 响应，则最初会去除“-gzip”部分，并且不会重新附加它，因此浏览器将永远不会发送“-gzip”`'If-None-Match'`标头。

```
Header edit ETag "(.+)-gzip\"$" "$1\"" "expr=resp('Content-Encoding') == 'gzip'" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-05-19T16:39:56.767

我知道这是一个非常古老的问题，但似乎有一个更新的答案。

要让 Apache 不附加`-gzip`后缀，您必须使用`DeflateAlterETag`值为`NoChange`.

请参阅此处的文档：[http ://httpd.apache.org/docs/trunk/mod/mod_deflate.html#deflatealteretag](http://httpd.apache.org/docs/trunk/mod/mod_deflate.html#deflatealteretag)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T09:16:58.243

也许您使用操纵 HTTP 请求的（鱿鱼）代理？

# asp.net - 使用 MSBuild 遍历网站类方法

> ID：896979
> 
> 赞同：1
> 
> 时间：2009-05-22T09:00:45.890
> 
> 标签：asp.net, reflection, msbuild

我正在尝试查找有关在 MSBuild 任务中使用反射的信息。

我需要一种在构建时迭代网站包含的类的方法的方法。这可能吗？MSBuild 是最好的工具吗？这是一个不合理的要求，我似乎无法找到有关该主题的任何文档？

任何帮助将非常感激。

富有的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-25T22:07:44.540

[使用名为MSBuild Community Tasks](http://msbuildtasks.tigris.org/)的扩展。您可以从名为 script 的 msbuild 任务中执行代码。使用反射 API，您的任务应该相对简单。

一个可行的替代方案可能是[Psake](http://codebetter.com/blogs/james.kovacs/archive/2008/06/27/introducing-psake.aspx)，因为[PowerShell](http://www.microsoft.com/windowsserver2003/technologies/management/powershell/default.mspx)与 .Net 集成得很好。

# sql-server-2005 - 从 Perl 连接到 SQL Server 2005 并执行 SELECT

> ID：896985
> 
> 赞同：2
> 
> 时间：2009-05-22T09:03:10.360
> 
> 标签：sql-server-2005, perl

如何从 Perl 脚本在 SQL Server 2005 上执行 SELECT？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T09:58:32.043

您将需要使用 DBI，并且您可能最好使用 ( [CPAN](http://search.cpan.org/~mjevans/DBD-ODBC-1.21/ODBC.pm) ) 中的 DBD::ODBC 提供程序。如果您不了解 DBI，那么您需要阅读相关内容。有一本书（[Programming the Perl DBI](http://oreilly.com/catalog/9781565926998/)）很旧但仍然有效。

然后类似于以下内容：

```
use strict;
use warnings;
use DBI;

# Insert your DSN's name here.
my $dsn = 'DSN NAME HERE'

# Change username and password to something more meaningful
my $dbh = DBI->connect("DBI:ODBC:$dsn", 'username', 'password')

# Prepare your sql statement (perldoc DBI for much more info).
my $sth = $dbh->prepare('select id, name from mytable');

# Execute the statement.
if ($sth->execute)
{
    # This will keep returning until you run out of rows.
    while (my $row = $sth->fetchrow_hashref)
    {
        print "ID = $row->{id}, Name = $row->{name}\n";
    }
}

# Done. Close the connection.
$dbh->disconnect; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T09:57:04.607

这是一个使用 DBI 的基本示例（在评论后编辑）：

```
use DBI;

my $dbh = DBI->connect("dbi:Sybase:database=<dbname>;server=<servername>",
    <user>, <password>, 
    { PrintError => 0, RaiseError => 1 });
my $sth = $dbh->prepare( "select field from table" );
my $result = $sth->execute();
while( my $result = $sth->fetchrow_hashref ) {
    print $result->{field};
}
$sth->finish;
$dbh->disconnect; 
```

希望通过更简单的解决方案看到其他答案:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-08T16:25:07.930

```
 #
        # ------------------------------------------------------
        # run a passed sql and retun a hash ref of hash refs
        # ------------------------------------------------------
        sub doRunSqlGetHashRef {

            my $self                   = shift ;
            my $sql                    = shift ;

            my $hsr_meta               = {} ;
            my $hsr                    = {} ;
            my $rowid = 0 ;
            my $flag_filled_hsr_meta   = 0 ;
            my $hsr_meta_colid         = 0 ;

            use DBI;

            my $dbs = "dbi:ODBC:DRIVER=FreeTDS;DSN=DEV_MSSQLSRV_DSN";
            # verify by :
            # isql -v DEV_MSSQLSRV_DSN user pwd

            my $dbh = DBI->connect($dbs, $db_user, $db_user_pw)
                or die "CONNECT ERROR! :: $DBI::err $DBI::errstr $DBI::state $!\n";

            if (defined($dbh)) {

                # Prepare your sql statement (perldoc DBI for much more info).
                my $sth = $dbh->prepare( $sql ) ;

                # Execute the statement.
                if ($sth->execute) {
                # This will keep returning until you run out of rows.
                    while (my $row = $sth->fetchrow_hashref)  {

                        # fill in the meta hash reference with the col names
                        if ( $flag_filled_hsr_meta == 0 ) {
                            for (@{$sth->{ 'NAME' }}) {
                                # debug ok print "$_ => $row->{$_}\t";
                                $hsr_meta->{ $hsr_meta_colid } = $_ ;
                                $hsr_meta_colid++ ;
                                $flag_filled_hsr_meta = 1 ;
                            }
                        }
                        # p ( $row ) ; # row level debug ...
                        $hsr->{ $rowid } = $row ;
                        $rowid++ ;
                    }
                }
                # Done. Close the connection.
                $dbh->disconnect;

                # debug ok p( $hsr_meta ) ;

                return ( $hsr_meta , $hsr )  ;
            }
            else {
                print "Error connecting to database: Error $DBI::err - $DBI::errstr\n";
            }

        }
        #eof sub doRunSqlGetHashRef 
```

# wpf - 我想创建一个 wpf 应用程序，它将消除图像中的红眼

> ID：896987
> 
> 赞同：1
> 
> 时间：2009-05-22T09:03:32.390
> 
> 标签：wpf, xaml, c#-3.0

我想开发一个 WPF 应用程序。现在我想要的是使用该 wpf 应用程序，我可以消除图像中的红眼，或者我必须为此使用任何其他第三方工具。任何建议请。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-22T09:48:09.210

我认为这个问题的答案超出了 Stackoverflow 可以实际提供的范围......但是我建议您下载 Paint.NET 的代码并看看他们在这方面做了什么。

# web-applications - 有哪些开发技术用于开发一些特定的著名网站？

> ID：896990
> 
> 赞同：0
> 
> 时间：2009-05-22T09:04:28.127
> 
> 标签：web-applications

什么网络技术，比如编程语言、框架、库等等，被用来开发一个特别著名的网络服务，尤其是 Web2.0s。

例如，Ruby on Rails 用于开发：Odeo、A List Apart、Twitter、43 Things。([来源 1](http://www.softwaredeveloper.com/features/best-ruby-on-rails-061307/) ) ([来源 2](http://www.freecsscart.com/index.php/some-big-websites-that-use-ruby-on-rails/) )

PHP 用于开发：Facebook、Photobucket、Wikipedia、Yahoo、Digg。（[来源](http://swik.net/PHP/Major+Sites+that+use+PHP)）

是的，包括堆栈溢出；）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T10:35:14.170

看看这个网站 - 很多关于这个主题的好信息：http: [//highscalability.com/](http://highscalability.com/) 具体来说，这个部分：[http ://highscalability.com/links/weblink/24](http://highscalability.com/links/weblink/24)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T09:15:04.317

ASP.NET MVC

*   [堆栈溢出](http://stackoverflow.com)
*   [代码复合体](http://codeplex.com)
*   [市场观察](http://www.marketwatch.com/)
*   [餐厅](http://www.restaurantica.com/)
*   [KB](http://www.kbb.com/)
*   [Ruthschris](http://www.ruthschris.com/)

ASP.NET

*   [怪物](http://www.monster.com)
*   [戴尔](http://www.dell.com)
*   [我的空间](http://www.myspace.com)
*   [乐高](http://www.lego.com)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-22T09:16:46.637

这个[博客](https://blog.stackoverflow.com/2008/09/what-was-stack-overflow-built-with/)告诉我们如何使用 ASP.Net MVC 构建 SO。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-22T09:18:15.540

AFAIK，谷歌的大部分项目都使用 Python 和 GWT。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-22T09:17:47.897

PlentyOfFish 是用 ASP.NET 构建的

# ruby-on-rails - ActiveRecord#存在吗？或从 ActiveRecord::RecordNotFound 救援

> ID：896991
> 
> 赞同：17
> 
> 时间：2009-05-22T09:05:14.040
> 
> 标签：ruby-on-rails, exception, activerecord

处理以下类型情况的推荐方法是什么：

假设我有一个名为 的模型，它与模型和相同的 PK（用户的 id） `Cart`具有 1-1 关系。在我的方法中，我想检查当前用户是否存在。如果我这样做并且购物车不存在，则会引发异常。 我看到两种解决方法：`Person`

`index``cart_controller``Cart``Cart.find(the_user_id)``RecordNotFound`

### 1\. 从异常中解救

```
 begin
    @cart = Cart.find(the_user_id)
    #more code here
 rescue ActiveRecord::RecordNotFound
    #the cart is empty message
 end 
```

### 2\. 使用 ActiveRecord#exists？方法

```
 if Cart.exists?(the_user_id)
    @cart = Cart.find(the_user_id)
    #more code here
 else
    #the cart is empty message
 end 
```

根据我对异常处理的（有限）知识，我知道不建议以这种方式使用异常，但是每次都进行额外的查询值得吗？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-05-22T12:11:54.117

使用 find_by_id 代替 find：

```
@cart = Cart.find_by_id(params[:id]) 
```

如果它不存在则为零，因此您可以根据需要在控制器/视图中检查“if @cart”

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-05-22T09:13:19.967

您可以尝试向用户对象询问其购物车。假设您已将用户分配给`@user`然后，如果用户有购物车，它将是`@user.cart`. 如果`@user.cart`是，`nil`那么他们没有。

这假设您正确设置了模型之间的关系。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-22T23:03:07.427

你为什么不做类似的事情......

```
@cart = @user.cart || @user.cart.new 
```

无需担心异常或 if/else 语句。那么在你看来，你可以有类似的东西......

```
<% if @cart.empty? # or whatever method you use to determine 
     # if there is nothing in the cart...maybe .blank? is fine? 
%>
    <p>Your cart is empty</p>
<% else %>
    <!-- loop through objects in your cart -->
<% end %> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-22T09:12:53.617

存在吗？会导致多一条 SQL 语句，除非 ActiveRecord 的人对此进行了优化（我不会指望这一点）。

所以我建议使用异常，它比 SQL 语句便宜得多。

# iphone - 有没有办法在更改为横向方向后转换坐标系？

> ID：896994
> 
> 赞同：5
> 
> 时间：2009-05-22T09:07:46.547
> 
> 标签：iphone, orientation, device

在基于视图的 iPhone OS 应用程序中，我将方向从初始纵向更改为**横向**(UIInterfaceOrientationLandscapeRight)。但是现在 x,y 原点 (0,0) 位于**左下角**（而不是通常的左上角），每次我想做一些涉及坐标的事情时，我都必须重新计算以补偿新坐标系统。我还注意到我在新坐标系中的视图有时表现不正常。那么，有没有办法在我切换方向后立即转换坐标系，以便我可以继续认为我的坐标在**左上角**有一个原点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-22T12:18:21.433

如果您按照推荐的方法对主视图应用变换以旋转它：

```
UIInterfaceOrientation orientation = [[UIApplication sharedApplication] statusBarOrientation];
if (orientation == UIInterfaceOrientationLandscapeRight) 
{
    CGAffineTransform transform = primaryView.transform;

    // Use the status bar frame to determine the center point of the window's content area.
    CGRect statusBarFrame = [[UIApplication sharedApplication] statusBarFrame];
    CGRect bounds = CGRectMake(0, 0, statusBarFrame.size.height, statusBarFrame.origin.x);
    CGPoint center = CGPointMake(60.0, bounds.size.height / 2.0);

    // Set the center point of the view to the center point of the window's content area.
    primaryView.center = center;

    // Rotate the view 90 degrees around its new center point.
    transform = CGAffineTransformRotate(transform, (M_PI / 2.0));
    primaryView.transform = transform;
} 
```

那么您添加到此主视图的任何子视图都应使用标准坐标系。应用于主视图的变换也负责旋转子视图的坐标。这在我的应用程序中对我很有效。

# jquery - IE 6 和 IE 7 中的 z-index

> ID：896998
> 
> 赞同：2
> 
> 时间：2009-05-22T09:08:46.200
> 
> 标签：jquery, z-index

我有一个嵌套的 div，如下所示：

```
<div id="header"><div class="header-content">
 <div class="button"></div>
 <div id="menu"></div>
</div>
  <ul>
    <li></li>
  </ul>
</div> 
```

现在我的javascript代码是这样的：

```
<script>
 $(".button").click(function(){
   $("#menu").css({
     position:"absolute",
     zIndex:50000,
     display:"block"
   });
 });
</script> 
```

它在 Firefox 中运行良好，但在 IE 6 和 IE 7 中它不是最重要的。任何有这方面经验的人请帮助我！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-22T09:23:01.087

完全相同的

```
var show = function(){
  var menu = document.getElementById("menu");
  menu.style.position = "absolute";
  menu.style.zIndex = "50000";
  menu.style.display = "block";
  menu.style.top = 0;
} 
```

没有 JQuery 对我来说绝对没问题。适用于 IE6 和 IE7。不幸的是，现在无法使用 JQuery 进行测试。

这个例子是你使用的确切代码吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-24T10:13:51.223

您的问题可能与 CSS 相关，而不是与 javascript 相关。Explorer 处理与其他浏览器不同的 z-index 子元素、父元素和兄弟元素。

~~[我不久前写的关于 z-index](http://thatnorwegianguy.com/positioning-and-z-index-in-ie/)的这篇文章可能会对您有所帮助。~~

这篇文章现在已经下架了，所以这里是[回程机器的存档](http://web.archive.org/web/20090105222100/http://thatnorwegianguy.com/positioning-and-z-index-in-ie/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-22T09:23:29.807

问题*可能*是您的菜单元素是空的，因此 IE 会折叠它，因此您看不到它。（至少对于您的示例代码，这可能是一个问题。如果您的标记看起来不是那样，请向我们展示它的真正样子......）

尝试：

```
<div id="header">
    <div class="header-content">
        <div class="button">& nbsp;</div>
        <div id="menu">& nbsp;</div>
    </div>
    <ul>
        <li>& nbsp;</li>
    </ul>
</div> 
```

`&`编辑：和之间的空格`nbsp;`不应该存在，但如果我只是写的话，SO实际上不会打印出代码`&nbsp;`......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-22T09:30:59.557

我猜你是想把 div 放在 div 上`<select>`，`<iframe>`或者`<embed> / <object>`比如 Flash。

这是早期 IE 中的一个已知错误。
通过将您的 div 放在 iframe 中可以绕过它，但这并不漂亮。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T10:01:11.367

```
<form action="ketqua.tintuc" name="myform">
    <div class="Search-text-box"> <img src="http://xalo.vn/1.gif" onclick="return _e_(event,0)" />
        <input type="text" name="q" value="{query/@query}" text="{query/@query}" />
        <input id="hq" type="hidden" name="hq" value="{query/@hiddenquery}" />
        <div class="Search-menu">
            <xsl:choose>
                <xsl:when test="@category-label != ''">
                    <xsl:value-of select="@category-label" />
                </xsl:when>
                <xsl:otherwise>
                    Search all
                </xsl:otherwise>
            </xsl:choose>
        </div>
    </div>
    <div class="search-btn"></div>
    <div id="Search-header-menu">
    <ul>
        <li> <a cat="">Tìm tất cả&lt;/a> </li>
    </ul>
</form> 
```

这是我所有真实的 html 代码以及下面的 javascript 代码：

```
$("#Search-header-menu").css({
      top: top,
      left:left,
      display:"block",
      background:"#fff"
    }); 
```*`**