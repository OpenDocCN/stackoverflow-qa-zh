# StackOverflow 问答 11335000-11335999

# xml - 将 XML 文件导入 SQL Server 太慢

> ID：11335005
> 
> 赞同：3
> 
> 时间：2012-07-04T20:16:25.417
> 
> 标签：xml, sql-server-2008, bulkinsert

我想要实现的任务是将 XML 文件导入 SQL Server。准备好空表后，我将加载整个 xml 文件并填充该表。谷歌搜索我发现 SQL Bulk Insert 是合适的，所以我测试了以下运行良好的代码：

```
INSERT INTO Products (sku, product_desc)
SELECT X.product.query('SKU').value('.', 'INT'),
       X.product.query('Desc').value('.', 'VARCHAR(30)')
FROM (
SELECT CAST(x AS XML)
FROM OPENROWSET(
    BULK 'C:\Products.xml',
    SINGLE_BLOB) AS T(x)
    ) AS T(x)
CROSS APPLY x.nodes('Products/Product') AS X(product); 
```

我的 XML 文件大约有 1860 个节点（30kb），非常小，但上述过程需要 5 多分钟才能导入整个文件。有没有机会加快这个过程？我还读到 SQL Server 2008 有一个影响大容量对象的错误。有什么提示吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-04T20:28:36.113

试试这个 - 我在 53 秒内从磁盘导入了一个包含 4'096 条记录的文件（在普通的普通台式机上 - 没有高性能服务器）：

```
-- declare XML variable
DECLARE @InputXML XML

-- import file from disk
SELECT @InputXML = CAST(x AS XML)
FROM OPENROWSET(BULK 'D:\temp\Products.xml', SINGLE_BLOB) AS T(x)

-- parse XML using XQuery and insert into the table    
INSERT INTO dbo.Products (sku, product_desc)
    SELECT 
        product.value('(SKU)[1]', 'int'),
        product.value('(Desc)[1]', 'varchar(30)')
    FROM @InputXML.nodes('Products/Product') AS X(product) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-19T15:44:07.590

```
declare @xml table (x xml)
--
insert @xml
select x
FROM OPENROWSET(BULK 'D:\temp\Products.xml', SINGLE_BLOB) AS T(x)

INSERT INTO dbo.Products (sku, product_desc)
SELECT
    RESULT.sku, RESULT.product_desc
FROM @xml
cross apply (
   select sku = z.value('SKU[1]', 'int'), 
          product_desc = z.value('Desc[1]','varchar(30)') 
   from x.nodes('Products/Product') Z1(z)
) RESULT 
```

2 秒内 13000 条记录 SQL Server 2008 R2。数据库兼容性 100

另外，试试 Database Compability 90

# opengl-es - OpenGL ES C++ 引擎或框架

> ID：11335007
> 
> 赞同：2
> 
> 时间：2012-07-04T20:16:30.543
> 
> 标签：opengl-es

我正在寻找执行以下操作的 OpenGL (ES) 帮助库。从 PNG、TGA 和 PVRTC 文件加载纹理 从一些 3d 格式文件加载模型，例如 wavefront .obj

你能推荐这样的图书馆吗？

它应该是 C++ 而不是 Objective-c

我已经有了 Marmalade (AirPlay) 引擎，并且使用了它的 GX 库。GX 有一些错误，我希望在果酱中使用普通的 OpenGL ES。所以我正在寻找一些可以加载资源的帮助类。

# php - 使用 PHP 根据引用 URL 选择选项值

> ID：11335008
> 
> 赞同：0
> 
> 时间：2012-07-04T20:17:05.257
> 
> 标签：php, url, select, drop-down-menu

我有一个选择下拉菜单，其中包含三个选项；根据引用的 URL，我需要每个选项都被选中（即 selected="selected"）。

我对 PHP 很陌生，但可以这样做：

```
 <?php if (strstr( $_SERVER['HTTP_REFERER'],"url-1" )) {
            ?>
               <option value="value-1" selected="selected">
            <?
         } else {
            ?>
            <option value="value-1">
            <?
         }                           
      ?> 
```

我对下拉列表中的三个选项中的每一个都执行此操作。如前所述，这是可行的——但是为每个选项重复相同的事情似乎效率很低。有人对我有任何线索吗？在此先感谢您的时间。

编辑：

感谢大家的帮助，尤其是阿德南。在另一个论坛搜索以及您的想法的帮助下，这是我理想的解决方案：

```
<?php 
$options = array(array('value' => 'value-one', 'label' => 'value-one', 'ref' => 'url-one'),array('value' => 'value-two', 'label' => 'value-two', 'ref' => 'url-two'),array('value' => 'value-three', 'label' => 'value-three', 'ref' => 'url-three'),
);  
foreach ($options as $option) {
if (strpos($_SERVER['HTTP_REFERER'], $option['ref']) > 0) {
$optSelected = ' selected';
} else {
$optSelected = ''; 
}
echo '<option value="' . $option['value'] . '"' . $optSelected . '>' . $option['label'] .     '</option>';}
?>` 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T20:34:59.373

这是一种“酷”的做法

```
foreach(array('url-1', 'url-2', 'url-3') as $url){
    echo (strstr ($_SERVER['HTTP_REFERER'], $url))?'<option value="value-'.substr($url, 4, 1).'" selected>':'<option value="value-'.substr($url, 4, 1).'">';
} 
```

注意：`selected`attrib 是布尔值，所以你不需要给它一个值，只要把它放在那里。

更新：这是您评论中代码的更正：

```
foreach (array('url1' => 'value-one', 'url2' => 'value-two', 'url' => 'value-three') as $url => $value){
   echo (strstr($_SERVER['HTTP_REFERER'], $url))?"<option value=\"$value\" selected>$value</option>":"<option value=\"$value\">$value</option>";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T20:21:04.257

您总是可以使用 switch(case) 语句吗？它会阻止你打电话

```
strstr( $_SERVER['HTTP_REFERER'],"url-1" ) 
```

多次？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T20:32:53.343

在将所有选项存储在数组中之后，您始终可以使用 foreach 循环。

```
<select name="someOption">
<?php foreach (array('option1', 'option2', 'option3') as $option):?>
    <option value="<?php echo $option;?>" <?php if (strstr( $_SERVER['HTTP_REFERER'],$option )):?> selected="selected"<?php endif;?>>
        <?php echo $option;?>
    </option>
<?php endforeach;?>
</select> 
```

作品？

# ajax - wordpress 加 ajax 使用 admin-ajax

> ID：11335012
> 
> 赞同：0
> 
> 时间：2012-07-04T20:17:38.610
> 
> 标签：ajax, wordpress

我在 wordpress 主题中使用 ajax 有问题。我阅读了所有谷歌前 5 页和论坛...我卡住了。

所以，我只是在functions.php中添加这些行

```
function my_action_callback(){
    echo"aha";
    die();
}
add_action('wp_ajax_my_action', 'my_action_callback');
add_action('wp_ajax_nopriv_my_action', 'my_action_callback'); 
```

并在我的主题文件中 - main.js 添加点击事件，发送 ajax 调用。

> $('.load_more').click(function(){ $.ajax({
> type: 'POST',
> url: 'http://www.mysite.eu/wp-admin/admin-ajax.php',
> 数据: { action: 'my_action'}, 成功: function(data, textStatus, XMLHttpRequest){
> alert('done');
> },
> error: function(MLHttpRequest, textStatus, errorThrown){
> alert('error:'+errorThrown);
> }
> }); });

我总是得到 - '错误：' 带有空的 textStatus。为什么？？请帮我 ：（

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T22:52:06.920

您的 textStatus 未定义，只需像这样更改数据参数：

数据：{动作：'my_action'，textStatus：$（'.other_div'）.val }，

现在你不会得到任何错误。

# opennlp - 打开 NLP 名称查找器培训

> ID：11335013
> 
> 赞同：4
> 
> 时间：2012-07-04T20:17:45.360
> 
> 标签：opennlp

我正在根据在线手册（http://opennlp.apache.org/documentation/1.5.2-incubating/manual/opennlp.html）构建一个 15k 行的训练数据文档，名为：en-ner-person.train。

我的问题是：在我的培训文档中，我是否包含完整的报告？还是我只包括具有名称的行：`<START:person> John Smith <END>`？

因此，例如，我是否在训练数据中使用整个报告：

```
<START:person> Pierre Vinken <END> , 61 years old , will join the board as a nonexecutive director Nov. 29 .
A nonexecutive  director has many similar responsibilities as an executive director.
However, there are no voting rights with this position.
Mr . <START:person> Vinken <END> is chairman of Elsevier N.V. , the Dutch publishing group . 
```

还是我只在我的培训文档中包含这两行：

```
<START:person> Pierre Vinken <END> , 61 years old , will join the board as a nonexecutive director Nov. 29 .
Mr . <START:person> Vinken <END> is chairman of Elsevier N.V. , the Dutch publishing group . 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-08T19:24:57.273

您应该使用整个报告。这将有助于系统学习何时不标记实体，从而提高假阴性分数。

您可以使用[评估工具](http://opennlp.apache.org/documentation/1.5.2-incubating/manual/opennlp.html#tools.namefind.eval.tool)对其进行测量。保留语料库中的一些句子进行测试，例如总句子的 1/10，并使用其他 9/10 句子训练模型。您可以尝试使用整个报告进行训练，而另一个仅使用带有名称的句子进行训练。结果将在[准确率和召回率](http://en.wikipedia.org/wiki/Precision_and_recall)方面。

请记住将测试样本与整个报告一起保存，而不仅仅是带有名称的句子，否则您将无法准确衡量模型在没有名称的句子中的表现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-20T03:43:08.373

我会包括所有内容，即使所有这些内容可能对训练模型中的权重没有贡献。

训练文件中使用或不使用的内容由用于训练模型的特征生成器确定。如果您到了实际调整特征生成器的地步，那么如果它已经包含所有内容，那么您至少不需要重新构建您的训练文件。

文档中的这个示例特征生成器也恰好是用于名称查找器的代码中的默认生成器：[自定义特征生成](http://opennlp.apache.org/documentation/1.5.2-incubating/manual/opennlp.html#tools.namefind.training.featuregen)

```
AdaptiveFeatureGenerator featureGenerator = new CachedFeatureGenerator(
         new AdaptiveFeatureGenerator[]{
           new WindowFeatureGenerator(new TokenFeatureGenerator(), 2, 2),
           new WindowFeatureGenerator(new TokenClassFeatureGenerator(true), 2, 2),
           new OutcomePriorFeatureGenerator(),
           new PreviousMapFeatureGenerator(),
           new BigramNameFeatureGenerator(),
           new SentenceFeatureGenerator(true, false)
           }); 
```

我无法完全解释那段代码，也没有找到关于它的好的文档或通过源代码来理解它，但那里的 WindowFeatureGenerators 考虑了令牌和令牌的类（例如，如果该令牌已经标记为人）在检查令牌之前和之后的 +/-2 个位置。

因此，句子中不包含实体的标记可能会对包含实体的句子产生影响。通过裁剪多余的句子，您可能会使用不自然的模式来训练模型，例如以名称结尾的句子后跟以名称开头的句子，如下所示：

```
The car fell on <START:person> Pierre Vinken <END>. <START:person> Pierre Vinken<END> is the chairman. 
```

# html - 通过单击主体上的任意位置关闭 Div 覆盖

> ID：11335018
> 
> 赞同：0
> 
> 时间：2012-07-04T20:18:07.970
> 
> 标签：html, overlay, fade, jquery

这就是我所做的：

```
$('#keks-overlay').hide();  

$('#click').click(function(){
    $('#keks-overlay').toggle(450);
});

$('#close-overlay').click(function(){
    $('#keks-overlay').toggle(250);
}); 
```

​ jsFiddle：http: [//jsfiddle.net/rHKkD/22/](http://jsfiddle.net/rHKkD/22/)

这工作正常，但它仅通过单击“X”（#close-overlay）显示/隐藏（切换）。

我想做一些类似fancybox效果的事情：点击整个身体的任何地方都会淡出。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T20:37:38.737

尝试（当文件准备好时）

```
var inoverlay = false;
$('#keks-overlay').hover(function() {
    inoverlay = true;
}, function() {
    inoverlay = false;
}); 
```

然后获取文档上的所有点击，检查 inoverlay 变量，如果它是假的，隐藏你的覆盖，否则什么都不做。如果您有一个首先打开覆盖的按钮，请务必检查当您拦截对文档的点击时，它不是被点击的按钮。

```
$(document).click(function(e){
    if(inoverlay && (e.target.attr('id') != buttonForOverlay.attr('id') )) {
        closeOverlay();
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T21:01:09.990

您可以将事件处理程序添加到`div`包含整个页面（或文档本身）的事件处理程序，以及`hide()`该处理程序中的覆盖。

```
$("#somebody").click(function() {
    $('#keks-overlay').hide(250);
}); 
```

但是，如果您想阻止对覆盖层本身的`hide()`点击`div`触发您的内容（之所以有效，是因为叠加层具有`absolute`定位）。

[我更新了您的小提琴以显示第二种方法。](http://jsfiddle.net/rHKkD/25/)

# objective-c - Objective-C：使用哪个视图？（征求意见）

> ID：11335020
> 
> 赞同：0
> 
> 时间：2012-07-04T20:18:10.210
> 
> 标签：objective-c, xcode, interface-builder

我是一名合作学生，我的任务是制作一个应用程序（适用于 iPad）来替换当前正在使用的纸笔清单。我已经完成了所有功能（我为每个功能都制作了不同的应用程序），现在是时候将它们整合在一起了。

唯一的问题是我不确定我应该使用什么视图。我希望应用程序打开，然后列出所有检查表。我认为基于导航的应用程序是最好的，但它仅适用于 iPhone 应用程序。

我考虑过使用基于拆分视图的应用程序，但我不喜欢侧边菜单如何徘徊；在我的用户选择了一个清单后，他们将不需要再选择另一个，因此侧边菜单不再需要存在。此外，我见过的所有基于拆分视图的应用程序示例都使用数组来存储不同的图像，然后显示这些图像。我需要有一系列的观点。这甚至可能吗？我的每个清单都会有不同数量的字段等，因此我将为每个清单制作不同的视图。

基本上，我正在寻找是否有人创建了类似的应用程序，以及他们为组织界面所做的工作。

谢谢。

编辑：我还应该添加标签栏是不可能的；我不希望用户在填写清单时意外切换到不同的选项卡。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T20:26:23.660

我认为拆分视图控制器会很好。如果需要，您可以通过为拆分视图控制器实现委托并从`splitViewController:shouldHideViewController:inOrientation:`方法返回 YES 来使主视图在两个方向上自动隐藏。（然后您可以让标准滑动或按其他按钮重新显示它。）

# android - MotionEvent ACTION_MOVE 在拖动到原始视图边界之外仍然触发

> ID：11335025
> 
> 赞同：1
> 
> 时间：2012-07-04T20:18:41.383
> 
> 标签：android

我在 relativelayout 中有 3 个 Imageview，并且我为所有 ImageView 添加了 onTouchListener

现在，当我在任何图像视图上按下手指时，onTouchListener 被触发，它工作正常，当我在不抬起 ACTION_MOVE 的情况下移动手指时，触摸被触发，一切正常。

但是，当我将手指移到 imageview 之外时，仍然会触发 ACTION_MOVE :(

当手指移到 ImageView 之外时，我不希望 ACTION_MOVE，另一方面，如果我的手指移到其他一些 ImageView，则应该从该 ImageView 触发 ACTION_MOVE 触摸，因为为所有 ImageView 添加了 TouchListener

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-11-13T06:33:18.647

在收到 ACTION_CANCEL 或 ACTION_OUTSIDE MotionEvent 后，您应该停止响应 ACTION_MOVE。当用户将手指移出视图边界时，会触发 ACTION_OUTSIDE。ACTION_CANCEL 也被触发，此外还涵盖了父 ViewGroup 窃取触摸事件的情况。

主要是，像 ACTION_UP 一样对待 ACTION_CANCEL，你会很高兴的。

# regex - mod_rewrite 匹配第一个和最后一个路径段并替换最后一个

> ID：11335027
> 
> 赞同：0
> 
> 时间：2012-07-04T20:19:05.490
> 
> 标签：regex, mod-rewrite

我正在尝试为我的 .htaccess 文件编写一个规则，检查第一个路径段是否匹配，检查最后一个段！=en，然后替换最后一个段。

例如

转变

/zh/something/somethingelse/de/

进入

/zh/something/somethingelse/zh/

如果最后一段已经是 /en/ 则不需要应用该规则。在第一个和最后一个之间可以有更多或更少的路径段。

我现在正在尝试这个

```
RewriteRule /zh.*/([^/]+)/(?!^en$).*$ /zh/$1/en/   [R=301,L] 
```

但它给了我

/zh/zh/zh/

作为结果

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T20:40:29.007

也许更改正则表达式并添加条件以防止循环`/en/`：

```
RewriteCond %{REQUEST_URI} !/en/?$
RewriteRule ^/zh[^\/]*/(.*)/[a-z]{2}/?$ /zh/$1/en/ [R=301,L] 
```

注意：如果在 .htaccess 文件中使用它并且您使用的是 apache 2.0+，则需要从 to 中删除前导`^/zh`斜杠`^zh`。

# c# - Windows 服务的静态属性

> ID：11335029
> 
> 赞同：-1
> 
> 时间：2012-07-04T20:19:12.847
> 
> 标签：c#, windows-services, static-classes

在我的解决方案资源管理器中，我有一个用于 Windows 服务`BridgeWS` 的项目，另一个项目`Vytru.Platform.Bridge.Configuration`有一个静态类`SharedData.cs`

我的问题：我想使用这个静态属性`SharedData.DeviceList`来获取我在 `BridgeWS`服务中的设备对象列表，但它总是等于 null 吗？

这是我的解决方案

![在此处输入图像描述](../Images/0d43d85aaf8bc1137cda4498871ec3b6.png)

我的静态类中的一些代码

```
public static  class SharedData
    {
        public const string CONFIGURATION_XML_PATH = @"\Configuration.xml";
        private static List<Device> _deviceList;

        public static void Initialize()
        {
            APPLICATION_LOCAL_PATH = Path.GetDirectoryName(System.Reflection.Assembly.GetExecutingAssembly().Location);
            if (!string.IsNullOrEmpty(APPLICATION_LOCAL_PATH)) CONFIGURATION_FULL_PATH = APPLICATION_LOCAL_PATH + CONFIGURATION_XML_PATH;

            _deviceList = new List<Device>();
            _tempDeviceList = new List<Device>();
            _deviceAgent = new DeviceManager();
            _deviceAgent.Initialize();
        }           

        public static bool AddToTempDeviceList(Device device)
        {
            if (_tempDeviceList != null)
            {
                if (!_deviceAgent.IsExist(device, true))
                {
                    _tempDeviceList.Add(device);
                    return true;
                }
            }
            return false;
        }

        public static bool UpdateFile()
        {
            _deviceList = _tempDeviceList;
            return _deviceAgent.Save();
        }

          public static List<Device> DeviceList
        {
            get { return _deviceList; }
            set { _deviceList = value; }
        }

        public static List<Device> TempDeviceList
        {
            get { return _tempDeviceList; }
            set { _tempDeviceList = value; }
        }

        public static DeviceManager DeviceAgent
        {
            get { return _deviceAgent; }
            set { _deviceAgent = value; }
        }
    } 
```

感谢和抱歉我的英语不好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T20:57:02.177

您可以先调用 Initialize 方法。如果你不这样做，属性将为空，因为这部分代码

```
_deviceList = new List<Device>();
            _tempDeviceList = new List<Device>();
            _deviceAgent = new DeviceManager();
            _deviceAgent.Initialize(); 
```

在 BridgeWS 中

```
SharedData.Initialize();
SharedData.TempDeviceList; // not null
SharedData.DeviceList; // not null 
```

# wpf - 可编辑的组合框表达式深色主题错误

> ID：11335030
> 
> 赞同：0
> 
> 时间：2012-07-04T20:19:16.767
> 
> 标签：wpf, combobox, wpf-controls, themes

我正在为正在开发的 WPF 应用程序使用 ExpressionDark 主题。但是，在使用可编辑组合框时，我注意到一个相当烦人的错误。

如下面的截图所示，当我输入一个比控件宽度长的文本时，内容会超出组合框：

![在此处输入图像描述](../Images/1bd43ec7eb0092dc87bf77c448942596.png "这是一个示例，其中选择了比组合框宽度长的组合框内容")

我尝试使用默认的 windows 主题，但这个 bug 不存在，所以我的猜测是 ExpressionDark 主题有问题。

我已经探索了主题 XAML 一段时间，但到目前为止我找不到问题的根源。

也许你们中的一些人已经遇到过这个问题和/或知道如何解决这个问题？

非常感谢！

PS：使用可以在 codeplex 上找到的 ExpressionDark 主题：[http ://wpfthemes.codeplex.com/](http://wpfthemes.codeplex.com/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T12:16:12.557

嗯，我发现了问题。这确实是 ExpressionDarkTheme 中的一个错误。如果其他人遇到此问题，这是解决方案。

在 ExpressionDark.xaml 文件中，搜索名为“ComboBoxTextBox”的 ControlTemplate。目标是在其中放置一个滚动查看器，以便内容可以水平滚动。

只需更换线路

```
<Border x:Name="PART_ContentHost" Focusable="False" Background="{TemplateBinding Background}" /> 
```

和

```
<Border Focusable="False" Background="{TemplateBinding Background}">
    <ScrollViewer Margin="0" x:Name="PART_ContentHost" Style="{DynamicResource NuclearScrollViewer}" />
</Border> 
```

瞧！问题解决了。

# jquery - Javascript淡入淡出到jquery淡入淡出

> ID：11335035
> 
> 赞同：0
> 
> 时间：2012-07-04T20:19:45.973
> 
> 标签：jquery

当用户悬停菜单时，我有 JavaScript 代码来淡入淡出菜单。

我想将 JavaScript 淡入淡出转换为 jQuery 淡入淡出。

请帮我解决这个问题，我想要 jQuery，因为它以淡入淡出样式加载，而不是在 javascript 中加载

```
<style type="text/css">
     #div1 {  
         visibility: hidden;  
     }
</style>

<div onMouseOver="show('div1')" onMouseOut="hide('div1')">
    <div id="div1">
    </div>
</div>

<script>
    function show(id) {
        document.getElementById(id).style.visibility = "visible";
    }
    function hide(id) {
        document.getElementById(id).style.visibility = "hidden";
    }
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T20:26:37.853

淡出设置显示为无；

试试这个：

```
$("#div1").hover(
    function() {$(this).animate({opacity:1})}, // fade in
    function() {$(this).animate({opacity:1})}  // fade out
); 
```

如果您要防止用户的生涩事件，您可能会查看[hoverIntent 插件](http://cherne.net/brian/resources/jquery.hoverIntent.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T20:28:42.787

[jsFiddle](http://jsfiddle.net/sinetheta/AtuDT/4/)

```
<div id="outer">
    <div id="inner">Test</div>
</div>​

$("#outer").hover(function() {
    $('#inner').fadeIn();
}, function() {
    $('#inner').fadeOut();
});​ 
```

虽然通常建议用更语义化的东西来制作菜单，比如`<ul>`s

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T20:38:37.760

试试这个，

```
$("#div1").hover(
function() {$(this).show('slow')},
function() {$(this).hide('slow')} 
```

);

您可以使用 'fast' 或 'normal' 参数而不是 'slow'

更多细节你可以[在这里](http://api.jquery.com/show/)看到。

**编辑**

如果你想在悬停 div 时使用手形光标，你可以试试这个，

```
<style>#div1{cursor: pointer}</style> 
```

# ruby-on-rails - 可以通过命令行运行 Mongoid 查询吗？

> ID：11335038
> 
> 赞同：2
> 
> 时间：2012-07-04T20:20:24.920
> 
> 标签：ruby-on-rails, mongodb, mongoid

我正在使用 MongoDB 和 Mongoid 的 Rails 应用程序中工作。我可以使用 mongo shell 环境运行 mongo 查询，但我很想在 irb 中使用 Mongoid。那是我能做的吗？如果是这样，有人可以告诉我怎么做吗？

谢谢 ：）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-04T20:51:17.210

As mentioned by Semyon the easiest option is to use:

```
$ rails console 
```

If you want to do it manually, run up irb and prepend it with the environment you want (which is most likely development).

e.g./

```
$ RACK_ENV=development irb 
```

Then require the mongoid gem & load your mongoid config & you should be able to use Mongoid. You'll also need to require any models you wish to use.

e.g/

```
> require 'mongoid'

> Mongoid.load!("path/to/your/mongoid.yml") 
```

BTW. I'd recommend using [pry](http://pry.github.com/) rather than irb, it's like irb but you can find things out without leaving your terminal amongst other things.

e.g./

running

```
> ls Mongoid 
```

shows me *all* the possible constants, Class & Instance Methods for Mongoid

```
constants: Atomic  Attributes  Callbacks  Collection  Collections  Components  Config  Contexts  Copyable  Criteria  Criterion  Cursor  DefaultScope  Dirty  Document  Errors  Extensions  Extras  Factory  Fields  Finders  Hierarchy  Identity  IdentityMap  Indexes  Inspection  Javascript  JSON  Keys  Logger  Matchers  MONGODB_VERSION  MultiDatabase  MultiParameterAttributes  NamedScope  NestedAttributes  Observer  Paranoia  Persistence  Relations  Reloading  Safety  Scope  Serialization  Sharding  State  Threaded  Timestamps  Validations  VERSION  Versioning
Mongoid#methods: add_language  add_observer  allow_dynamic_fields  allow_dynamic_fields=  allow_dynamic_fields?  autocreate_indexes  autocreate_indexes=  autocreate_indexes?  blacklisted_options  config  configure  count_observers  database  database=  databases  databases=  default_logger  destructive_fields  from_hash  identity_map_enabled  identity_map_enabled=  identity_map_enabled?  include_root_in_json  include_root_in_json=  include_root_in_json?  include_type_for_serialization  include_type_for_serialization=  include_type_for_serialization?  instantiate_observers  load!  logger  logger=  master  master=  max_retries_on_connection_failure  max_retries_on_connection_failure=  max_retries_on_connection_failure?  notify_observers  observer_instances  observers  observers=  parameterize_keys  parameterize_keys=  parameterize_keys?  persist_in_safe_mode  persist_in_safe_mode=  persist_in_safe_mode?  preload_models  preload_models=  preload_models?  purge!  raise_not_found_error  raise_not_found_error=  raise_not_found_error?  reconnect!  scope_overwrite_exception  scope_overwrite_exception=  scope_overwrite_exception?  skip_version_check  skip_version_check=  skip_version_check?  time_zone  time_zone=  time_zone?  unit_of_work  use_activesupport_time_zone  use_activesupport_time_zone=  use_activesupport_time_zone?  use_utc  use_utc=  use_utc?
Mongoid#methods: add_language  add_observer  allow_dynamic_fields  allow_dynamic_fields=  allow_dynamic_fields?  autocreate_indexes  autocreate_indexes=  autocreate_indexes?  blacklisted_options  config  configure  count_observers  database  database=  databases  databases=  default_logger  destructive_fields  from_hash  identity_map_enabled  identity_map_enabled=  identity_map_enabled?  include_root_in_json  include_root_in_json=  include_root_in_json?  include_type_for_serialization  include_type_for_serialization=  include_type_for_serialization?  instantiate_observers  load!  logger  logger=  master  master=  max_retries_on_connection_failure  max_retries_on_connection_failure=  max_retries_on_connection_failure?  notify_observers  observer_instances  observers  observers=  parameterize_keys  parameterize_keys=  parameterize_keys?  persist_in_safe_mode  persist_in_safe_mode=  persist_in_safe_mode?  preload_models  preload_models=  preload_models?  purge!  raise_not_found_error  raise_not_found_error=  raise_not_found_error?  reconnect!  scope_overwrite_exception  scope_overwrite_exception=  scope_overwrite_exception?  skip_version_check  skip_version_check=  skip_version_check?  time_zone  time_zone=  time_zone?  unit_of_work  use_activesupport_time_zone  use_activesupport_time_zone=  use_activesupport_time_zone?  use_utc  use_utc=  use_utc? 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-04T21:02:46.800

您还可以在项目中启动预配置的 Rails 控制台：

```
$ rails console
>> MyDocument.where(:foo => 'bar').to_a
=> [...] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-09-27T18:21:16.477

在 Rails 控制台中

```
db = Mongoid::Clients.default

collection = db[:collection_name] 
```

现在我们可以对集合执行查询。

要查看所有可能的方法，请使用

```
collection.methods.sort! 
```

# javascript - 在 Firefox 上工作的网络工作者在谷歌浏览器上抛出奇怪的错误

> ID：11335039
> 
> 赞同：1
> 
> 时间：2012-07-04T20:20:32.697
> 
> 标签：javascript, firefox, google-chrome, web-worker

在我的网络工作者中，我有一行设置`onmessage`处理程序，如下所示：

```
onmessage = function() {/*...*/} 
```

这在 Firefox 中完美运行，但在 google chrome 中我收到以下错误：

```
Uncaught ReferenceError: onmessage is not defined 
```

那么我的代码示例有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T20:35:51.067

using`self.onmessage`似乎已经解决了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T20:26:32.353

你可以试试 ：

```
 onmessage = function(e) {
  var data = e.data;
  ... 
}; 
```

或者检查您的浏览器是否支持 Webworkers [CanIuse Webworker](http://caniuse.com/#search=webworker)

# php - 如何在 Doctrine 2 中自动刷新？

> ID：11335041
> 
> 赞同：3
> 
> 时间：2012-07-04T20:20:48.703
> 
> 标签：php, orm, doctrine-orm

我正在使用 Doctrine 2，并希望此 ORM`flush()`在执行任何`SELECT`查询之前自动执行 EntityManager，以确保应用程序中始终保持一致性（此应用程序抽象了很多，并且不应该对 EntityManager 有任何了解，除了在存储库中）。

有没有一个选项可以用 Doctrine 做到这一点？

如果没有，有什么策略可以轻松实施吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T10:47:08.240

为什么需要在所有选择之前刷新（写入更改）？您是否可能需要事务一致性？即，插入/更新是否取决于先前选择的结果？在这种情况下，我建议使用显式事务，如下所示：

```
$em->transactional(function($em) {
    $entity = $em->find('Entity', 123);
    if ($entity->getValue() > 2)
    {
        $user = new User;
        $user->setName('George');
        $em->persist($user);
    }
}); 
```

如果没有，我建议坚持使用默认设置，让 unitOfWork 堆叠并在运行时结束时优化插入/更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T09:19:22.287

到目前为止，我发现的唯一解决方案是在*不得*返回陈旧数据的存储库方法中`flush()`发出查询之前手动进行：`SELECT`

 *```
class OrderRepository
{
   public function findByUser(User $user)
    {
        $this->em->flush();

        $query = $this->em->createQuery( ... );

        // ...
    }
} 
```

这样，刷新对使用存储库的服务隐藏。*

# proxy - 使用 ssh socks5 代理时设置选项

> ID：11335046
> 
> 赞同：1
> 
> 时间：2012-07-04T20:21:15.887
> 
> 标签：proxy, ssh, socks

我的 ssh socks5 代理在运行一段时间后开始挂起，我认为这可能与代理套接字的存活时间比需要的长得多有关。我已经搜索并搜索了要使用的选项（使用 ssh -O），但没有太多可用的选项。

我正在像这样设置我的代理：

```
ssh -D9090 talcolm@a.proxyserver.com 
```

有人可以指出我可以传递给 ssh socks5 代理的详细选项的资源吗？我想我基本上想降低代理使用的套接字超时。很高兴看到我还能摆弄什么来尝试调整我的代理。

提前致谢。

# ios - 从命令行运行 UI 自动化工具时出错

> ID：11335048
> 
> 赞同：1
> 
> 时间：2012-07-04T20:21:21.243
> 
> 标签：ios, command-line, automation, instruments

我正在尝试从命令行使用 UI 自动化启动我的应用程序。这就是我所说的

仪器 -w -t /Applications/Xcode45-DP2.app/Contents/Applications/Instruments.app/Contents/PlugIns/AutomationInstrument.bundle/Contents/Resources/Automation.tracetemplate /projects/TesApp/build/Debug-iphoneos/TestApp。应用程序

我总是收到此错误 Instruments[3613:3503] 在“setThrottleConstraints：”调度期间遇到的异常：（null）仪器使用错误：设备无法准备好使用。

知道我可能做错了什么吗？甚至任何建议我还能尝试什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T15:19:40.513

找到了，只需要添加Device ID。

所以只使用了 -w DEVICE_UDID

此外，还有一件事让我感到困惑，应用程序，您只需要添加已安装的应用程序的名称，而不是本地路径（因为仪器不会为您部署应用程序）

# php - 寻找一种运行 php git post-recieve 挂钩的安全方法

> ID：11335049
> 
> 赞同：2
> 
> 时间：2012-07-04T20:21:22.593
> 
> 标签：php, git, permissions, git-post-receive

我有一个执行 git pull 的钩子，但是当它需要写入添加的文件时它会失败。它操作的用户是 apache，当授予它写权限时（通过将 apache 添加到具有写权限的组），它可以很好地执行 git pull。

我想出了一些解决方案...

*   将 apache 保留在具有写权限的组中（感觉不安全）
*   将文件的所有权更改为 apache（不安全和 hacky）
*   使用 sudo （但这需要存储密码或没有密码）
*   在 git pull 执行之前和之后执行 chmod 添加写入 apache (hacky)

然而，所有这些似乎都是不安全/骇人听闻的解决方案。

请分享您用来解决这些问题的任何建议或方法。我很想听到任何解决方案，特别是如果您必须自己跳过这个障碍。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T23:15:31.993

另一种解决方案（可能是老派）是创建一个 setuid 程序来执行实际工作，然后从挂钩中运行该 setuid 程序。

如果您使用 SELinux 运行，则可能需要调整权限以使 setuid 程序从挂钩运行，因为挂钩以 Apache 用户身份运行。

# c# - 如何使用 Linq 解析 XML 文件 - 后代

> ID：11335056
> 
> 赞同：2
> 
> 时间：2012-07-04T20:21:56.020
> 
> 标签：c#, xml, linq, parsing

我`XDocument`在 C# 中使用 Linq-to-XML 解析以下 XML 时遇到问题：

```
<matches count="9">
<books count="4">
    <book>
        <key>books/batman_dark_knight_returns/frank_miller</key>
        <title>Batman: The Dark Knight Returns</title>
    </book>
    ...
</books>
<movies count="4">
    <movie>
        <key>movies/batman_tales_of_dark_knight/boy_kirklan</key>
        <title>Batman: Tales of the Dark Knight</title>
    </movie>
    ...
</movies>
<music count="1">
    <album>
        <key>music/dark_knight/hans_zimmer</key>
        <title>The Dark Knight</title>
    </album>
</music> </matches> 
```

我非常非常错误的代码片段是

```
var data = from query in xmlFeed.Descendants("books")
           select new Book
           {
               Title = (string)query.Element("book").Element("title"),

               count = (string)query.Element("stickers").Element("sticker").Element("count")

           };

searchListBox.ItemsSource = data; 
```

有关如何解析这样的 xml 的任何帮助，该 xml 将返回可以绑定到列表框的长列表中的书籍、电影、电视节目？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T20:27:36.990

我*怀疑*你想要类似的东西：

```
var books = xmlFeed.Descendants("book").Select(x => Book.FromXElement(x));
var movies = xmlFeed.Descendants("movie").Select(x => Movie.FromXElement(x));
var albums = xmlFeed.Descendants("album").Select(x => Album.FromXElement(x));

// I'm assuming you're using .NET 4 here, otherwise it becomes slightly uglier.
var allResults = books.Concat<object>(movies).Concat(albums).ToList(); 
```

那是假设您`FromXElement`为每个类添加了一个静态方法，我通常发现这是一种处理此类事情的干净方法。如果您愿意，您可以内联进行，但是当您开始获取更多位时，它会使查询代码变得越来越大。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T07:53:14.297

如果所有`key`的都跟在`title`节点后面：

```
var all = xmlFeed.Descendants("key").Select(x => new {
          Key = x.Value,
          Title = ((XElement)x.NextNode).Value
          // else the Title would be
          // Title = x.Parent.Element("title").Value
          }).ToList(); 
```

这会将所有键和标题作为一个长列表。

# android - 如何在android中退出我的应用程序

> ID：11335065
> 
> 赞同：1
> 
> 时间：2012-07-04T20:23:26.010
> 
> 标签：android

当我按下主屏幕上的后退按钮以退出我的应用程序时，它没有发生。它与我的登录窗口循环，所以我如何退出我的应用程序？？？我是 android 新手，这是我的主屏幕代码

```
public class Home extends Activity implements OnClickListener {
    Button btnLinkToRegister;
    Button btnLinkTologin;
    Button btnLinkToCompanyRegister;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.welcome);

        btnLinkToRegister = (Button) findViewById(R.id.btnLinkToRegister);
        btnLinkToCompanyRegister=(Button)findViewById(R.id.btnLinkToCompanyRegister);
        btnLinkTologin=(Button) findViewById(R.id.btnLinkTologin);
        btnLinkToRegister.setOnClickListener(this);
        btnLinkTologin.setOnClickListener(this);
        btnLinkToCompanyRegister.setOnClickListener(this);
    }           

public void onClick(View v) 
{
switch(v.getId())
{

case R.id.btnLinkToRegister:
 Intent i = new Intent(getBaseContext(), Registration.class);
 startActivity(i);
 break;

case R.id.btnLinkTologin:
    Intent j = new Intent(getBaseContext(), Login.class);
    startActivity(j);
    break;

case R.id.btnLinkToCompanyRegister:
    Intent k = new Intent(getApplicationContext(), CompanyRegister.class);
    startActivity(k);
}

}

} 
```

这是登录活动

```
public class Login extends Activity implements OnClickListener 
{

 Button mLogin;
 Button mRegister;

 EditText muname;
 EditText mpassword;

 DBHelper DB = null;
public String status="";

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        mRegister = (Button)findViewById(R.id.register);
        mRegister.setOnClickListener(this);

        mLogin = (Button)findViewById(R.id.login);
        mLogin.setOnClickListener(this); 

    }

 public void onClick(View v) 
 {
 switch(v.getId())
 {

 case R.id.register:
  Intent i = new Intent(getBaseContext(), Registration.class);
  startActivity(i);
  break;

 case R.id.login:

  muname = (EditText)findViewById(R.id.Ledituname);
  mpassword = (EditText)findViewById(R.id.Leditpw);

  String username = muname.getText().toString();
  String password = mpassword.getText().toString();

  if(username.equals("") || username == null)
  {
   Toast.makeText(getApplicationContext(), "Please enter User Name", Toast.LENGTH_SHORT).show();
  }
  else if(password.equals("") || password == null)
  {
   Toast.makeText(getApplicationContext(), "Please enter your Password", Toast.LENGTH_SHORT).show();
  }
  else
  {
   boolean validLogin = validateLogin(username, password, getApplicationContext());

   if(validLogin)
   {        
       if(status.equals("s"))
       {
    Intent in = new Intent(getBaseContext(), JSHomePage.class);
    in.putExtra("UserName", muname.getText().toString());
    startActivity(in);
       }
       else if(status.equals("c"))
       {  Intent in = new Intent(getBaseContext(), CompView.class);
        in.putExtra("UserName", muname.getText().toString());
        startActivity(in);}
   }
  }
  break;

 }

 }

 private boolean validateLogin(String username, String password, Context baseContext) 
 {
  DB = new DBHelper(getBaseContext());
  SQLiteDatabase db = DB.getReadableDatabase();

  String[] columns = {"_id","status"};

  String selection = "username=? AND password=?";
  String[] selectionArgs = {username,password};

  Cursor cursor = null;
  try{

  cursor = db.query(DBHelper.Login_Table, columns, selection, selectionArgs, null, null, null);

  startManagingCursor(cursor);

  }
  catch(Exception e)

  {
   e.printStackTrace();
  }
int numberOfRows = cursor.getCount();

  if(numberOfRows <= 0)
  {

   Toast.makeText(getApplicationContext(), "User Name and Password miss match..\nPlease Try Again", Toast.LENGTH_LONG).show();
   Intent intent = new Intent(getBaseContext(), Login.class);
   startActivity(intent);
   return false;
  }

  cursor.moveToNext();
  status = cursor.getString(cursor.getColumnIndex("status"));
  startManagingCursor(cursor);
  return true;

 }
 public void onBackPressed() 
    {
        Intent i = new Intent(Login.this, Home.class);
        startActivity(i);
    }

 public void onDestroy()
 {
  super.onDestroy();
  DB.close();
 }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T21:47:36.597

我猜你试图实现看起来像这样的东西：

HomeActivity -> buttonClicked -> LoginActivity -> BackPressed -> HomeActivity -> BackPressed -> 退出您的应用

在您的情况下，删除 onBackPressed 覆盖的方法应该可以解决问题（Android 使用后退键自动管理活动之间的导航）。您的循环可能来自对 startActivity 的调用，它向堆栈添加了一个新活动，而不是取消堆栈。如果你覆盖 onBackPressed()，你可能需要调用 super，不确定。

# javascript - 在 JavaScript 中包含 JSF 表达式语言

> ID：11335071
> 
> 赞同：3
> 
> 时间：2012-07-04T20:24:01.020
> 
> 标签：javascript, jsf, el

我找到了这个问题和答案[Mixing JSF EL in a JavaScript file](https://stackoverflow.com/q/2547814/1502416)

这个问题是在 2 年前提出的，所以想知道 JSF 2.0 是否还有其他替代方案。

我一直在研究使用

```
<h:outputStylesheet> 
```

在这些文件中包含 CSS 和这个 EL 似乎确实被解析了。

但是使用

```
<h:outputScript> 
```

似乎没有做同样的事情。

所以

问题1）以上是否是更好的方法（如果有效）？

问题 2）由于它似乎不适用于 JS，因此 [在 JavaScript 文件中混合 JSF EL 中的](https://stackoverflow.com/q/2547814/1502416)哪个答案被认为是更好的选择。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T20:55:33.947

目前，无法通过 JSF API 将 JS 添加到 EL 支持的资源中。在 Mojarra 的情况下，它在`com.sun.faces.application.resource.ResourceHelper`类中是硬编码的。

```
private static final String[] EL_CONTENT_TYPES = {
    "text/css"
}; 
```

无法通过包装其中一个资源管理组件来覆盖它。CSS 中支持 EL，其唯一目的是支持`#{resource['library:image.png']}`CSS 背景图像声明中的“静态”表达式。对于“静态”，我的意思是，它们保证在应用程序范围内获得相同的评估结果。JSF 规范中没有考虑其他用例，也适用于 JS。可能基于每个请求评估不同结果的 EL 表达式在 JS/CSS 资源中会失败，因为默认情况下，Web 浏览器会在第一次请求后将这些资源缓存一段确定的时间，这可能会持续至少一周。

您始终可以通过实现自定义资源处理程序来使其工作，其中您通过 EL 评估输入流拉取 JS 文件并设置适当的响应标头，以便浏览器不会缓存它们。但这并不是一件小事，因为您基本上需要重写整个资源管理系统。如果您真的打算并且有足够的经验，那么起点将是扩展[`ResourceHandlerWrapper`](http://docs.oracle.com/javaee/6/api/javax/faces/application/ResourceHandlerWrapper.html)课程。那么余民应该为自己说话。

至于提到的哪个替代方案是更好的选择，是您必须自己做出的选择。胜过自己，一种或另一种方法对您的特定情况有多有用或多或少有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T20:34:18.453

我将添加到选项列表中 BalusC 提供了第一个避免全局变量的变体：

```
<script id='message-data' type='text/json'>
  { "messages": [    
  <ui:repeat items="#{bean.messages}" var="message">"#{message.value}",</ui:repeat> null
  ] }
</script> 
```

然后从 JavaScript 中，当您需要消息时，您可以：

```
var msgData = document.getElementById('message-data').innerHTML;
msgData = JSON.parse(msgData); 
```

这个想法是在未解析的标签中创建一个 JSON 对象`<script>`（这就是将“type”设置为“text/json”的作用），然后通过`JSON.parse`.

另一种（通用）方法是使用类和`data-xxx`属性将 JSF 上下文中的内容放到 HTML 中，然后 JavaScript 可以“发现”这些内容。

使用服务器端模板系统处理整个 JavaScript 文件的一个显着缺点是使这些文件无法被客户端缓存。

# redirect - Prestashop 无法以管理员身份登录

> ID：11335073
> 
> 赞同：7
> 
> 时间：2012-07-04T20:24:31.890
> 
> 标签：redirect, login, admin, prestashop

几天前，我无法访问基于 prestashop 平台的网站上的管理面板。输入登录名和密码后，我再次被重定向到登录页面，一切都重复了。

该站点托管在专用服务器上，我正在开发的其他一些 prestashop 站点也托管在该服务器上。在尝试访问这些站点上的管理面板后，我得到了相同的“错误”。

你怎么看，有什么问题？

Prestashop 版本：1.4.7.3 和 1.4.8.2

服务器：CentOs，PHP

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-07-05T14:17:51.267

以下是您可以尝试的一些事情：

**1/ 清除浏览器缓存和 cookie**

**2/ 尝试使用 Firefox 而不是 Chrome**（这似乎有一些意想不到的问题）

**3/检查`PS_SHOP_DOMAIN`并`PS_SHOP_DOMAIN_SSL`在`ps_configuration`表中**

**`tools/smarty/compile`4 /**手动清除 smarty 缓存**：删除所有文件`tools/smarty/cache`**

 ****5/禁用IP签**入`classes/Cookie.php`（这可能会导致动态IP出现许多问题）：在`isLoggedBack()`，删除或注释第四个条件：

`AND (!isset($this->_content['remote_addr']) OR $this->_content['remote_addr'] == ip2long(Tools::getRemoteAddr()) OR !Configuration::get('PS_COOKIE_CHECKIP'))`

**6/ 缩短 cookie 的过期时间**（IE 可能会遇到最长 cookie 的问题）：在`classes/Cookie.php`构造函数中，

放 ：`$this->_expire = isset($expire) ? (int)($expire) : (time() + 3600);`

代替`$this->_expire = isset($expire) ? (int)($expire) : (time() + 1728000);`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-09-11T14:46:59.573

在我的 Apache Web 服务器前面添加 NGINX 作为反向代理后，我遇到了同样的问题。

问题出在“*检查 cookie 上的 IP 地址”*参数设置为“*是*”。由于我被管理员锁定并且无法更改它，因此我使用此 SQL 请求直接在数据库中进行了操作：

```
UPDATE ps_configuration SET value = 0 WHERE name='PS_COOKIE_CHECKIP'; 
```

PS：`ps_`是我的表前缀，你可以根据你的设置进行调整。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-10-26T07:54:02.273

I spent a lot of time debugging this. Installed prestashop locallly on my computer. I my case the following, you should manually navigate to the following:

```
< domain >/admin/index.php 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-09-07T05:43:16.067

我和其他人有同样的问题。

我可以通过 IE 登录，但不能通过 Firefox 登录。

我为解决这个问题所做的就是进入 cookie 管理器并删除所有 cookie。

我知道这听起来很陈词滥调，但没有其他效果。

我搜索了我的站点名称并查看了 cookie，它的日期很长但不再有效。我的猜测是我损坏了 cookie 或者他们进行了 IP 匹配，因为在使用管理面板的过程中，我切换到手机浏览器进行检查。返回时，它只会循环登录页面，没有错误。

我认为他们需要从软件的角度解决问题。

无论如何，在我删除了与我的网站相关的所有 cookie 后，我马上就没有问题了。它还解决了我在使用 www.mysite.com 和 mysite.com 时遇到的问题。我正在与技术支持人员交谈，因为有时它会起作用，而有时它不会。也许 cookie 还存储了用于动态链接的 www/non 的哪个变体。我的 DNS 被允许有时间来解决，技术支持将其归咎于此，但事实并非如此。

不要只是清除cookies，而是手动删除您网站的cookies。当我使用清除 cookie 时，它​​并没有删除很多 cookie。我发现在清除 cookie 之后，我的网站仍然设置了 9 个 cookie。这是我的错误还是其他原因，我不知道。

祝大家好运，并感谢其他建议。如果它返回，我将进入其他建议并报告。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-11-25T20:57:30.643

这对我有用：在管理>首选项控制面板中，将“检查 Cookies IP 地址”设置为“否”。

[http://xbfish.com/tag/auto-logout/](http://xbfish.com/tag/auto-logout/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-02-12T16:54:33.610

我使用 prestashop 1.4.8.2 我只是通过更改 admin/login.php 来调试我的后台登录循环只需删除以下代码中看似无用的条件。

```
if ((empty($_SERVER['HTTPS']) OR strtolower($_SERVER['HTTPS']) == 'off')
     AND Configuration::get('PS_SSL_ENABLED')) 
```

改变

```
 if (!Configuration::get('PS_SSL_ENABLED')) 
```

我还清除了 cookie 并成功了。我不知道它是否会弄乱其他东西，但我终于可以进入我的后台了。和平！！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-05T14:09:26.750

有一些可能发生的事情会阻止您的旧密码正常工作。一种可能是您的 _COOKIE_KEY_ 已更改。

您可以尝试使用以下脚本生成新的密码哈希。然后，您可以在 xxxx_employee 表中的数据库中替换它（其中 xxxx_ 是您的表前缀）。我希望这对你有用。无论如何：保留旧哈希的备份。

这是小脚本：

```
<?php
require(dirname(__FILE__).'/config/config.inc.php');
echo Tools::encrypt($_REQUEST["pw"]); 
```

完成后不要忘记从服务器中删除脚本！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-12-18T18:53:22.593

For solution try this:

*   Open; phpMyAdmin, ps_configuration table

*   Find, PS_COOKIE_CHECKIP and set it as 0

*   Clear all cache then try again, probably it will be solved.

You can think that it is related to IP/network issue.

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2012-07-05T13:49:21.920

如果您有一个工作站点，您可以在其中登录。也许您可以将用户从工作复制到非工作，然后确定是否可行。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2012-08-02T12:59:14.123

我知道这是旧的，但它可以帮助某人，通过打开 /config/config.inc.php 打开错误。

寻找线：

```
ini_set('display_errors', 'off'); 
```

将其更改为：

```
ini_set('display_errors', 'on'); 
```

编辑：更改了一个看似错字

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2015-05-05T19:54:49.233

例如，当我使用非 www 配置商店域并尝试使用 www 访问时，有时会出现此错误。我喜欢强制所有用户使用相同的 url，所以我强制在 .htaccess 中输入 www：

```
RewriteCond %{HTTP_HOST} !^www.
RewriteRule ^(.*)$ http://www.%{HTTP_HOST}/$1 [R=301,L] 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2015-07-04T15:21:09.403

如果您从本地版本或其他域中移动了 prestashop，除了经典版本。

```
update ps_configuration table set value="www.myshop.com" where name ="PS_SHOP_DOMAIN";

update ps_configuration table set value="www.myshop.com" where name ="PS_SHOP_DOMAIN_SSL"; 
```

检查名为`ps_shop_url`，更新`domain`和`domain_ssl`字段的表，`physical_url`以及。

例子：

```
update ps_shop_url set domain='www.myshop.com', domain_ssl='www.myshop.com', physical_url='/'; 
```**

# c# - 在 C# 中停止执行程序

> ID：11335074
> 
> 赞同：1
> 
> 时间：2012-07-04T20:24:32.260
> 
> 标签：c#

在 C++ 中，我曾经编写过一个函数，该函数通过传递给它的 float 参数的数量来停止程序的执行，函数如下：

```
void wait(float sec){
  clock_t endwait = clock() + sec * CLOCKS_PER_SEC; // CLOCK_PER_SEC == 1000
  while(clock() < endwait);
} 
```

在 C# 中是否有类似的内置方法？如果没有，我怎么能用 C# 写一个这样的？

提前谢谢.. :)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-04T20:29:36.530

请用`System.Threading.Thread.Sleep(int millisecondsTimeout);`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-04T20:43:48.273

> 线程.睡眠（CLOCKS_PER_SEC）；

是等效的方法

> 无效等待（浮点秒）

但是，它并没有停止程序的执行。它只是暂停程序运行的线程。我认为这些方法之间存在一些差异。`void wait(float sec)`是一种忙碌的等待方法。处理器从活动进程队列中获取线程或进程，进行一些计算。但是在方法`Thread.Sleep(CLOCKS_PER_SEC)`线程进入挂起队列时，除非 CLOCKS_PER_SEC 时间结束，否则处理器不会让它运行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-04T20:26:49.103

```
Thread.Sleep(CLOCKS_PER_SEC); 
```

或者

```
Thread.SpinWait(NUMBER_OF_CYCLES); 
```

**- 编辑 -**

我向各位道歉。在我为上述内容写解释时停电了......这将教会我发布半个答案以尝试成为第一个。感谢评论者保持检查。:)。

无论如何...`Thread.Sleep`将暂停当前线程一段时间，同时`Thread.SpinWait`会导致线程进入紧密循环（来自[MSDN](http://msdn.microsoft.com/en-us/library/system.threading.thread.spinwait.aspx)）。

一个有趣的比较方法是`Thread.Sleep`使用`Thread.SpinWait`任务管理器之类的东西来监视处理器活动。如果您在运行以下命令时查看任务管理器

```
Thread.SpinWait(int.MaxValue); 
```

您会注意到，当该行代码正在运行时，该进程会最大限度地使用其中一个内核。但是，如果您运行以下行，

```
Thread.Sleep(int.MaxValue); 
```

您会注意到该过程根本不使用任何处理周期。

# android - Android Graphs - 这些人是怎么做到的？

> ID：11335076
> 
> 赞同：1
> 
> 时间：2012-07-04T20:24:37.140
> 
> 标签：android, api, graph, charts

我搜索了图形 API（也在这个网站上），我尝试了其中的一些，但没有一个给我真正的解决方案和漂亮的图形。我不能停止想知道，这些应用程序是如何做到的。你能告诉我在哪里可以学到这个：

[https://play.google.com/store/apps/details?id=com.mobidia.android.mdm](https://play.google.com/store/apps/details?id=com.mobidia.android.mdm)

[https://play.google.com/store/apps/details?id=com.appspot.gsjavadev.android.systemmonitorlite](https://play.google.com/store/apps/details?id=com.appspot.gsjavadev.android.systemmonitorlite)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T23:02:56.330

你很快就会发现这个 RFI 被一大堆关于第三方 Android 定制图表工具的建议和指向其他 SO 问题的链接所掩盖，但你不需要长时间招待他们......

我们首选的解决方案（符合我们的设计范式和 UX 要求）是使用 Google Chart API。这是许多 FX 证券交易所应用程序使用的，它是由 Google 构建和维护的，而不是爱好者 - 并不是说​​非企业解决方案无论如何都很差，但图形并不是一个充满发现和奇迹的领域，它只需要以美观和健壮的方式执行，谷歌就可以做到这一点。

Google Chart API 有两条路径；

*   不支持 svg 的浏览器的图像图表（即 Honeycomb 之前的任何浏览器？），最近已弃用。
*   基于 JavaScript 的 wizzy soooper 很棒的版本。我自己没有使用过，但我们的应用程序将在不久的将来朝着这个方向发展。这可能是这些应用程序正在使用的。

它有据可查，去玩吧，结果令人印象深刻，因为开发人员方面的投入如此之少，唯一的问题是您需要互联网连接，并且您正在将信息发送到不受您控制的服务器。那里的一些数据保护问题...

# android - Android 可调整大小的矩形裁剪

> ID：11335079
> 
> 赞同：5
> 
> 时间：2012-07-04T20:25:11.783
> 
> 标签：android, bitmap, crop

我需要根据用户触摸事件使用可调整大小的矩形裁剪图片。我这样做是因为并非所有设备都支持裁剪意图功能，所以我正在创建自己的。

我将原始图像作为位图并将其作为图像视图显示在屏幕上。

现在我接下来需要做的是有一个矩形（已经知道它需要的大小），可以调整大小和移动以供用户裁剪图像（比如获取一张脸）。

如何创建这样的可调整大小的矩形？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-04T21:31:41.893

[CropImage](https://github.com/biokys/cropimage)对我来说非常有用。

# perl - 使用 XML::Twig，如何检查两个节点是否具有完全相同的子节点和属性？

> ID：11335090
> 
> 赞同：2
> 
> 时间：2012-07-04T20:26:12.910
> 
> 标签：perl, xml-parsing, perl-module, xml-twig

这是一个简短的 XML 文件，其中 2 个节点具有相同的子节点（但具有 2 个不同的值）。

5000 用于节点 MIAMI

7777 用于节点 WASHINGTON

```
<country id="USA">
<city id="MIAMI" method="modify">
    <attributes>
        <number_people>5000</number_people>
        <average_income>40</average_income>
    </attributes>
</city>

<city id="WASHINGTON" method="modify">
    <attributes>
        <number_people>7777</number_people>
        <average_income>40</average_income>

    </attributes>
 </city>
</country> 
```

**使用 Perl::Twig，我想检查节点 MIAMI 和 WASHINGTON 是否相同（具有相同的子节点和相同的值）。**

这是我所做的，但它不起作用 ($M->children eq $W->children) 被发现是 TRUE。它应该是假的，因为“number_people”的值是不同的。

```
#!/usr/bin/perl -w
use warnings;
use XML::Twig;

my $t= XML::Twig->new;
my $v= XML::Twig::Elt->new;

$t-> parsefile ('file.xml');
my $M=$t->first_elt('city');            # retrieve node MIAMI 
my $W=$M->next_sibling('city');    # retrieve node WASHINGTON

if ($M->children eq $W->children) {print "the two nodes are exactly IDENTICAL"; } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T20:42:57.467

模块[Data::Compare](http://search.cpan.org/~dcantrell/Data-Compare-1.22/lib/Data/Compare.pm)是什么，它有助于递归地比较两个 perl 数据结构。

我检查了模块 XML::Twig 的文档，您可以使用 method 获取任何 TWIG 对象的结构`simplify`。所以`$M->children->simplify`

# android - 如何更改 android tabhost 中选项卡的样式？

> ID：11335095
> 
> 赞同：0
> 
> 时间：2012-07-04T20:26:30.457
> 
> 标签：android, android-tabhost, android-style-tabhost

我想更改 android 中选项卡的样式`tabhost`，我不想只更改背景颜色，而是更改整个样式（例如制作圆角）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T20:38:12.080

`TabHost`您可以在其中放置一个`Button`或任何其他具有首选样式的小部件，即使是圆角

```
Button myButton = new Button(this);
myButton.setText("My Button");
myButton.setBackgroundColor(Color.TRANSPARENT);
myButton.setCompoundDrawablesWithIntrinsicBounds(0, R.drawable.my_button_drawable_top, 0, 0);
TabHost.TabSpec myButtonTab = mTabHost.newTabSpec("tab1").setIndicator(myButton).setContent(intentPlayList);
mTabHost.addTab(myButtonTab); 
```

# sass - '&' 选择器选择什么？

> ID：11335096
> 
> 赞同：47
> 
> 时间：2012-07-04T20:26:31.617
> 
> 标签：sass

在[这个](http://codepen.io/aniketpant/pen/4/1)codepen 中有一个 css 选择器`&:hover`，该选择器匹配什么？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-07-04T20:28:23.690

我相信与号是[Sass](http://sass-lang.com/)的一个功能。从文档：

[引用父选择器：&](http://sass-lang.com/documentation/file.SASS_REFERENCE.html#parent-selector)

> 有时，以默认方式以外的其他方式使用嵌套规则的父选择器很有用。例如，您可能希望在选择器悬停时或当 body 元素具有特定类时具有特殊样式。在这些情况下，您可以使用 & 字符显式指定父选择器应插入的位置。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2012-07-04T20:40:07.620

确切地。在 Sass 中，你可以有这样的东西......

```
 div {
    background: green;

    p {
        background: red;

        &:hover {
            background: blue;
        }

        &:active {
           background: blue; 
        }
    }   
} 
```

...当转换为 CSS 时会变成这样：

```
div {
    background: green;
}

div p {
    background: red;
}

div p:hover {
    background: blue;
}

div p:active {
    background: blue;
} 
```

编辑：从 &hover: 到 &:hover

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-05-20T21:55:39.340

一种不太广为人知的用法是，您可以将 & 符号添加到样式的末尾，以便父选择器成为子选择器。

例如：

```
 h3
   font-size: 20px
   margin-bottom: 10px

 .some-parent-selector &
   font-size: 24px
   margin-bottom: 20px 
```

变成，

```
 h3 {
    font-size: 20px;
    margin-bottom: 10px;
  }

  .some-parent-selector h3 {
    font-size: 24px;
    margin-bottom: 20px;
  } 
```

你可以在这里阅读更多关于和使用的信息

[http://thesassway.com/intermediate/reference-parent-selectors-using-ampersand](http://thesassway.com/intermediate/referencing-parent-selectors-using-ampersand)

# php - iOS gzip 压缩到 PHP

> ID：11335099
> 
> 赞同：3
> 
> 时间：2012-07-04T20:26:40.563
> 
> 标签：php, ios, post, gzip, asiformdatarequest

我正在通过 PHP 接收的 POST 向我的网页发送大量文本。它大约是 500kb - 1.5 mb。问题在于它是非常重复的数据，我想压缩它。数据看起来像这样，“123,123,123,124,124,124,125,126...等”

[我找到了 Geoggrey Garside http://cocoadev.com/wiki/NSDataCategory](http://cocoadev.com/wiki/NSDataCategory)的 NSData+Compression 库，其中包含 gzipInflate 和 gzipDeflate 方法，并且已经获得了 gzipInflate 方法来正确解压缩来自服务器的数据，但我一生都无法了解如何在 iOS 中压缩字符串并通过 PHP 将其发送到服务器进行解压缩。

这是我的 iOS 代码：

```
NSData* uncompressedStringData = [@"test" dataUsingEncoding:NSUTF8StringEncoding];
NSData* compressedData = [uncompressedStringData gzipDeflate];
ASIFormDataRequest * request = [ASIFormDataRequest requestWithURL:[NSURL URLWithString:@"myserver"]];
[request setPostValue:@compressedData forKey:@"1"];
...more code to deal with sending the request.. etc... 
```

这是我的 PHP 代码：

```
echo gzinflate($_POST['1']); 
```

我从服务器得到的只是

```
Warning: gzinflate() data error 
```

任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T20:34:48.453

尝试[gzdecode](http://www.php.net/manual/en/function.gzdecode.php)而不是 gzinflate

[编辑]
看起来 gzdecode 只能从 php5.4 获得（这是我使用 gzdecode 的版本）

从我得到以下的评论中，我在 php5.3 上对其进行了测试并且它有效

```
<?php 
function gzdecode($data) 
{ 
    return gzinflate(substr($data,10,-8)); 
} 
?> 
```

# javascript - jQuery 链接不起作用

> ID：11335101
> 
> 赞同：1
> 
> 时间：2012-07-04T20:26:52.113
> 
> 标签：javascript, jquery, html

我有一些创建链接的 jQuery，但是这些链接应该触发更多的 jQuery，但它们没有，这里是代码：

```
$(".divisionLinks").click(function () { 
  $('.show_hide_division').show();
  $('.show_hide_main').html($(this).html()+ " is Selected");
  //Load the division xml
  var xmlDoc=new ActiveXObject("Microsoft.XMLDOM");
  xmlDoc.async="false";
  xmlDoc.load("xml//division//"+ $(this).html() + ".xml");
  theEnvNodes = xmlDoc.getElementsByTagName('ENVIRONMENT');
  //Make the html
  theNewHTML = "<ul>";
    for (i = 0; i<theEnvNodes.length; i++){
    theNewHTML = theNewHTML + "<li><a class=\"environmentLinks\" href=\"#\">";
    theNewHTML = theNewHTML + theEnvNodes[i].childNodes[0].childNodes[0].nodeValue;
    theNewHTML = theNewHTML + "</a></li>";
    }
  theNewHTML = theNewHTML + "</ul>"; 
  $('.environmentButtons').html(theNewHTML);
});
$(".environmentLinks").click(function () { 
  $('.show_hide_environment').show();
  $('.show_hide_division').html($(this).html()+ " is Selected");
}); 
```

因此，除法链接有效，但环境链接无效。我一直在阅读它可能与 jQuery 索引 .environmentLink 类有关。但我不知道，也不知道解决方法。提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T20:30:11.947

您必须使用例如：

```
$(".environmentLinks").live('click', function () { 
  $('.show_hide_environment').show();
  $('.show_hide_division').html($(this).html()+ " is Selected");
}); 
```

或者：

```
$("body").on('click', ".environmentLinks", function () { 
  $('.show_hide_environment').show();
  $('.show_hide_division').html($(this).html()+ " is Selected");
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T20:33:05.803

由于您正在动态添加 .environmentLinks，因此不会附加单击事件，因为加载页面时这些链接不存在。如果您使用的是最新版本的 jQuery，请使用`.on()`将 click 事件绑定到 .environmentLinks 链接。

```
$("body").on('click', '.environmentLinks', function () { 
  $('.show_hide_environment').show();
  $('.show_hide_division').html($(this).html()+ " is Selected");
}); 
```

理想情况下，您希望将 $("body") 替换为`.environmentLinks`比 body 元素更接近它的父元素。

> 事件处理程序仅绑定到当前选定的元素；当您的代码调用 .on() 时，它们必须存在于页面上。为确保元素存在并且可以被选择，请在页面 HTML 标记中的元素的文档就绪处理程序内执行事件绑定。如果将新 HTML 注入页面，请在将新 HTML 放入页面后选择元素并附加事件处理程序。或者，使用委托事件来附加事件处理程序，如下所述。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T20:32:51.117

这是因为环境链接是稍后生成的，并且您的点击功能绑定到 DOM，我认为。

尝试这个：

```
$(".environmentLinks").live("click", function(){

 $('.show_hide_environment').show();
 $('.show_hide_division').html($(this).html()+ " is Selected");
}); 
```

这将“刷新”您的点击事件。

# performance - Fortran 分配/解除分配

> ID：11335108
> 
> 赞同：8
> 
> 时间：2012-07-04T20:27:41.137
> 
> 标签：performance, memory-management, fortran

我有以下问题：Fortran90+ 中分配/解除分配语句的实际开销是多少？即，在一个循环内分配了几个中等大小的数组，比如

```
do i = 1, 1000
    allocate(tmp(20))
    tmp(1:20) = 1d0
    call foo(tmp)
    deallocate(tmp)
end do 
```

在这种情况下，是否值得根据最大大小分配单个工作数组？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-05T01:28:55.443

我发现紧密循环中的动态数组分配确实会减慢代码的执行速度，而 valgrind 显示很大比例的循环被`malloc`and占用`free`。所以如果`foo`是一个非常快速的函数，那么静态分配这个数组是值得的。[通过使用valgrind](http://valgrind.org/docs/manual/manual.html)的 callgrind 功能进行分析，很容易看到这种开销（可能值得减少问题的大小，因为分析的执行速度可能至少慢 10 倍）。

在 fortran 2008 中，此类问题有更好的解决方案。您可以在`block`结构中声明变量，其大小在运行时确定。这应该使编译器更容易在堆栈上分配变量。但是我没有亲自使用过它，我不确定哪些编译器支持它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-04T20:45:21.720

使用and 的开销与在 C 中使用 and`ALLOCATE`的`DEALLOCATE`开销相同。实际上，大多数 Fortran 编译器都将其实现为包装器，并增加了一些记录，这是所有 Fortran 90 数组所固有的。`malloc()``free()``(DE)ALLOCATE``malloc()/free()`

通常最好预先分配一个足够大的临时数组并在紧密循环中使用它，而不是不断地分配和释放内存。它还可以防止堆碎片化，这可能会导致稍后出现分配问题（非常罕见的情况，但它会发生，尤其是对于 32 位代码）。

# linq - LINQ中where子句的动态形成

> ID：11335109
> 
> 赞同：1
> 
> 时间：2012-07-04T20:28:06.207
> 
> 标签：linq, sql-server-2008

我需要 LINQ 的帮助。这是我的场景。我有两个表用于存储员工详细信息，例如姓名、ID、工资、Primary_Emp 和年份。用户可以从 DDL 中选择名称或 ID，并将输入值传递给 SP。SQL Server 将根据给定的输入返回数据。

```
tbl_Employee
EmpID   EmpName     Salary  Primary_Emp
1       xxx         10000   Yes
2       yyy         20000   Yes
3       zzz         30000   Yes

tbl_Year
EmpID   [Year]
1       2010
2       2011
3       2011 
```

这是我的 SQLQuery。我想在 LINQ 中应用相同的条件。注意：- 用户有两个选项可以选择`EmpID`或`EmpName`从 DDL 中选择并在文本框中输入值（自由文本）

```
Input Parameters:
Name varchar(100)
EmpID varchar(100)

select distinct e.EmpID from 
tbl_employee e
inner join 
tbl_Year y
on e.EmpID = y.EmpID
where E.Primary_Emp = 'Yes'
**AND e.EmpName = (SELECT CASE WHEN @Key = 'Name' THEN @Value ELSE e.Empname END)
    AND e.EmpID = (SELECT CASE WHEN @Key = 'EmpID' THEN @Value ELSE e.EmpID END)** 
```

问题：如何在linq中形成动态**where**子句。这里的问题是 LHS 也是动态的。如果用户传递 EmpID，则不应考虑 Name，反之亦然。

在 linq 中加入是强制性的！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T21:50:10.233

如果它只是您想要有条件地应用的单独**和过滤表达式，您可以执行以下操作：**

```
var query = from e in dbcontext.tbl_employee 
            join y in tbl_Year 
            on e.EmpID equals y.EmpID 
            where e.Primary_Emp = "Yes"
            select e;

if (key == "EmpName")
    query = from e in query where e.EmpName = value select e;
else if (key == "EmpID")
    query = from e in query where e.EmpID = value select e;

var result = (from e in query
              select e.EmpID).Distinct(); 
```

您可以简单地以这种方式有条件地堆叠**where**子句。

# jquery - jQuery FadeIn 破坏 css 样式的日期选择器

> ID：11335111
> 
> 赞同：1
> 
> 时间：2012-07-04T20:28:14.037
> 
> 标签：jquery, html, css, datepicker, fadein

我有一个 id="DatePicker" 的分隔符，并使用 jQuery UI 日期选择器小部件，我像这样应用小部件：

```
$("#DatePicker").datepicker(); 
```

在浏览器中查看时，这显示得很好。

然而

当我将#DatePicker 分隔符的显示样式更改为 display:none; 并应用附加到网页中的其他事件（例如单击按钮）的 jQuery fadeIn("fast") 函数，当#DatePicker 分隔符淡入时，CSS 样式变得模糊，并且小部件的 Date Picker 容器不会拉伸以填充内容。

好作风：

![在此处输入图像描述](../Images/d85e15ca3034e344230f51f0c18b956e.png)

不好的样式（在 fadeIn() 之后发生）：

![在此处输入图像描述](../Images/9e4dd612816a00830f1575c91fffb2dc.png)

# c++ - 冻结 __write_nocancel

> ID：11335116
> 
> 赞同：6
> 
> 时间：2012-07-04T20:28:37.650
> 
> 标签：c++, qt, unix, io, glog

所以我有一个相当充实的程序，它偶尔会冻结。
该程序使用 Qt、开放场景图和谷歌日志。这种冻结发生在谷歌日志中的打印中间。该程序本身正在打印大量调试信息。我能够通过 gdb-server 连接到程序，这是堆栈跟踪：

```
#0  0x000000397ac0e030 in __write_nocancel () at ../sysdeps/unix/syscall-template.S:82
#1  0x00007f5eecb74aeb in google::LogMessage::SendToLog() () from /lib64/libglog.so.0
#2  0x00007f5eecb71fc7 in google::LogMessage::Flush() () from /lib64/libglog.so.0
#3  0x00007f5eecb721a9 in google::LogMessage::~LogMessage() () from /lib64/libglog.so.0
#4  0x00000000004874a6 in LSDB::process (this=0x242d918, lsp=0x25f9200, circuit=0x24c7af0) at ../src/model/trill/LSDB.cpp:481
#5  0x00000000004a0f6f in Circuit::rx (this=0x24c7af0, eth=0x246fdf0) at ../src/model/trill/Circuit.cpp:355
#6  0x000000000045c950 in Circuit::qt_static_metacall (_o=0x24c7af0, _c=QMetaObject::InvokeMetaMethod, _id=0, _a=0x7fffaade95a0)
    at ../src/model/trill/Circuit.moc.cpp:55
#7  0x000000398798cb9f in QMetaObject::activate (sender=0x2470140, m=<optimized out>, local_signal_index=<optimized out>, argv=0x7fffaade95a0)
    at kernel/qobject.cpp:3547
#8  0x0000000000459610 in FramePublisher::subscription (this=0x2470140, _t1=0x246fdf0) at ../src/model/system/FramePublisher.moc.cpp:98
#9  0x000000000047c0d6 in FramePublisher::rx (this=0x2470140, frame=0x246fdf0) at ../src/model/system/FramePublisher.hpp:21
#10 0x000000000047bedb in EthernetPort::rx (this=0x246d7a0, frame=0x25a4180) at ../src/model/system/EthernetPort.cpp:81
#11 0x000000000045a208 in EthernetPort::qt_static_metacall (_o=0x246d7a0, _c=QMetaObject::InvokeMetaMethod, _id=1, _a=0x7fffaade9810)
    at ../src/model/system/EthernetPort.moc.cpp:51
#12 0x000000398798cb9f in QMetaObject::activate (sender=0x246d7a0, m=<optimized out>, local_signal_index=<optimized out>, argv=0x7fffaade9810)
    at kernel/qobject.cpp:3547
#13 0x0000000000459ddc in Port::rx (this=0x246d7a0, _t1=0x25a4180) at ../src/model/system/Port.moc.cpp:110
#14 0x00000000004803a6 in Port::inject (this=0x246d7a0, frame=0x25a4180) at ../src/model/system/Port.cpp:25 
```

...

注意冻结本身发生在`__write_nocancel`. 只有一个线程在运行...

> (gdb) info threads Id Target Id Frame
> * 1 Thread 21507 0x000000397ac0e030 in __write_nocancel () at ../sysdeps/unix/syscall-template.S:82

关于导致冻结的任何想法？让我知道其他信息可能会有所帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-12T23:32:39.727

您说输出正在写入stderr。如果 stderr 没有被单独的进程持续读取，则 I/O 缓冲区可能已满，因此它在写入更多内容之前等待 stderr 被读取。

如果进程 A 正在写入 stderr 并且进程 B 通常从 stderr 读取但当前正在等待进程 A，这可能会导致死锁。在您的情况下，如果对stderr的写入太大，它只会导致死锁，因为较小的写入会立即成功并释放进程A，从而释放进程B以从stderr读取。

这是我的一些猜测，但总的来说，我认为您的问题是您正在等待写入完整的缓冲区。

# objective-c - 如何在动画时更改 UIView 块动画的速度（或持续时间）？

> ID：11335120
> 
> 赞同：2
> 
> 时间：2012-07-04T20:28:46.283
> 
> 标签：objective-c, ios, cocoa, core-animation

我有一个图像视图，我在屏幕上非常缓慢地制作动画，重复使用如下块动画：

```
[UIView animateWithDuration:100.0f
                      delay:0.0f
                    options:UIViewAnimationOptionCurveLinear | UIViewAnimationOptionRepeat
                 animations:^(void) {
                     pattern.frame = CGRectMake(0-(pattern.frame.size.width/2), 0, pattern.frame.size.width, pattern.frame.size.height);
                 }
                 completion:NULL]; 
```

基本上，图像是屏幕宽度的两倍，当它重复时，它看起来像是在不断地循环。

这一切都很好，但我想做的是根据旋转触摸手势加快或减慢滚动速度。我设置了手势识别器等，但我可以更改当前动画以加快速度吗？

如果没有，我可以取消当前正在运行的动画并用另一个持续时间更短/更长的动画替换它吗？

顺便说一句，我尝试在手势识别器中使用完全相同的动画块，例如：

```
-(void)rotatedSpinner:(UIRotationGestureRecognizer *)gestureRecognizer{
    CGFloat rotation = gestureRecognizer.rotation;

    [UIView animateWithDuration:100-(rotation*10)
             delay:0.0f
             options:UIViewAnimationOptionBeginFromCurrentState
             animations:^(void) {
                 pattern.frame = CGRectMake(0-(pattern.frame.size.width/2), 0, pattern.frame.size.width, pattern.frame.size.height);
             }
             completion:NULL];
} 
```

..但它似乎根本没有做任何事情？任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T20:33:35.083

如果你想要一个缓慢滚动的视图，用户也可以用手指滚动，我建议使用 UIScrollView。您可以使用 NSTimer 不断更新滚动视图的内容偏移量。当用户开始滚动时，您只需停用此计时器，让他随心所欲地滚动。一旦他让我们走并且滚动视图停止减速（您的代表将收到通知），您可以再次开始自己移动它。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-05T21:18:51.880

如果您希望旋转手势像转动转盘一样加快或减慢动画速度，请尝试以下操作：

在视图的图层上设置速度属性。

大多数 UIView 动画最终都会将 CAAnimation 添加到视图的图层对象，因此应该可以。像这样的东西：

pattern.layer.speed = .5 //将动画减慢到半速

值为 2 将完全停止动画。值为 2 将使其以双倍速度运行。

# java - Java小程序未在浏览器中显示

> ID：11335122
> 
> 赞同：0
> 
> 时间：2012-07-04T20:28:54.063
> 
> 标签：java, swing, japplet

嗨，我有一个 java 小程序。在 Eclıpse ıt 上完美运行并显示所有摆动项目，但当我将其嵌入到 html 时，小程序不显示或仅显示浏览器中的一些项目。下面是我的代码。有人可以帮我解决我的问题吗？

```
import java.applet.Applet;
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.ImageIcon;
import javax.swing.JApplet;
import javax.swing.JButton;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.SwingConstants;

import java.applet.*;
import java.net.*;
public class TestApplet extends JApplet implements ActionListener {

    Button talkToAllButton;
    Button sendPhotoToAll;
    int Tikla1Basim, Tikla2Basim;
    JLabel header;

    JLabel statusLabel;
    JLabel posLabel;
    JLabel idLabel;
    JLabel iDLabel;
    JLabel heartRateLabel;
    JLabel heartRateLabel2;
    JLabel backgroundLabel;
    JButton sendPicButton;
    JButton talkOnOffButton;
    public void init() {

        this.setLayout(null);
        setSize(1200, 900);

        idLabel=new JLabel(new ImageIcon(getImage(getDocumentBase(), "res/call_sign.png")));
        idLabel.setFont(new Font("Serif", Font.BOLD, 20));
        idLabel.setBackground(Color.white);
        idLabel.setForeground(Color.black);
        idLabel.setOpaque(true);
        idLabel.setBounds(getWidth()-190,200,180,50);
        //idLabel.setBorder(border);
        add(idLabel);

        iDLabel=new JLabel("NONE",JLabel.CENTER);
        iDLabel.setFont(new Font("Serif", Font.BOLD, 20));
        iDLabel.setBackground(new Color(36,48,24));
        iDLabel.setForeground(Color.WHITE);
        iDLabel.setOpaque(true);
        iDLabel.setBounds(getWidth()-190,250,180,50);
        //iDLabel.setBorder(border);
        add(iDLabel);

        statusLabel=new JLabel(new ImageIcon(getImage(getDocumentBase(), "res/status_alive.png")));
        statusLabel.setFont(new Font("Serif", Font.BOLD, 20));
        statusLabel.setBackground(Color.green);
        statusLabel.setForeground(Color.black);
        statusLabel.setOpaque(true);
        statusLabel.setBounds(getWidth()-190,300,180,50);
        //statusLabel.setBorder(border);
        add(statusLabel);

        posLabel=new JLabel("NO DATA");
        posLabel.setFont(new Font("Serif", Font.BOLD, 20));
        posLabel.setHorizontalAlignment(SwingConstants.CENTER);
        posLabel.setBackground(Color.green);
        posLabel.setForeground(Color.WHITE);
        posLabel.setOpaque(true);
        posLabel.setBounds(getWidth()-190,350,180,70);
        //posLabel.setBorder(border);
        add(posLabel);

        heartRateLabel=new JLabel(new ImageIcon(getImage(getDocumentBase(), "res/hearth_rate.png")));
        heartRateLabel.setFont(new Font("Serif", Font.BOLD, 20));
        heartRateLabel.setBackground(Color.red);
        heartRateLabel.setForeground(Color.black);
        heartRateLabel.setOpaque(true);
        heartRateLabel.setBounds(getWidth()-190,450,180,50);
        //heartRateLabel.setBorder(border);
        add(heartRateLabel);

        heartRateLabel2=new JLabel("NO DATA",JLabel.CENTER);
        heartRateLabel2.setFont(new Font("Serif", Font.BOLD, 20));
        heartRateLabel2.setBackground(new Color(180,2,2));
        heartRateLabel2.setForeground(Color.WHITE);
        heartRateLabel2.setOpaque(true);
        heartRateLabel2.setBounds(getWidth()-190,500,180,50);
        //heartRateLabel2.setBorder(border);
        add(heartRateLabel2);

        sendPicButton=new JButton(new ImageIcon(getImage(getDocumentBase(), "res/send_pic.png")));
        sendPicButton.setFont(new Font("Serif", Font.BOLD, 20));
        sendPicButton.setBackground(Color.red);
        sendPicButton.setForeground(Color.black);
        sendPicButton.setOpaque(true);
        sendPicButton.setBounds(getWidth()-190,580,180,50);
        //sendPicButton.setBorder(border);
        add(sendPicButton);
        sendPicButton.addActionListener(this);

        talkOnOffButton=new JButton(new ImageIcon(getImage(getDocumentBase(), "res/talk_off.png")));
        talkOnOffButton.setFont(new Font("Serif", Font.BOLD, 20));

        talkOnOffButton.setOpaque(true);
        talkOnOffButton.setBounds(getWidth()-190,650,180,50);
        //talkOnOffButton.setBorder(border);
        add(talkOnOffButton);
        talkOnOffButton.addActionListener(this);
        //***********************************************************
        //isFpsLimited = true;
        backgroundLabel=new JLabel(new ImageIcon(getImage(getDocumentBase(), "res/bg.png")));
        backgroundLabel.setOpaque(true);
        backgroundLabel.setBounds(getWidth()-200,0,200,800);
        add(backgroundLabel);

        ImageIcon headerImg=new ImageIcon(getImage(getDocumentBase(),"res/erlink_header.png"));
        header=new JLabel(headerImg);
        header.setBounds(-45, -40, 1800, 200);

        add(header);
        sendPhotoToAll = new Button("Send Photo(All)");
        sendPhotoToAll.setBounds(850,40, 150, 50);
        header.add(sendPhotoToAll);
        talkToAllButton = new Button("Talk(All)");
        talkToAllButton.setBounds(850,90, 100, 50);
        header.add(talkToAllButton);

        sendPhotoToAll.addActionListener(this);
        talkToAllButton.addActionListener(this);
        /*sendPhotoToAll.setLocation(10, 10);
        sendPhotoToAll.setSize(150, 30);

        talkToAllButton.setLocation(10, 40);
        talkToAllButton.setSize(250, 30);*/

    }

    public void actionPerformed(ActionEvent event) { 
    //event things
    }
    // TODO overwrite start(), stop() and destroy() methods
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T20:34:51.727

1.  使用布局。
2.  `validate()`添加所有组件后调用。
3.  在 EDT 上构建 GUI。有关更多详细信息，请参阅[Swing 中的并发。](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/)

# salesforce - 将数据从动态 crm 迁移到 salesforce

> ID：11335124
> 
> 赞同：1
> 
> 时间：2012-07-04T20:29:01.890
> 
> 标签：salesforce, dynamics-crm, dynamics-crm-2011, crm, dynamics-crm-4

我想知道一些将数据从 microsoft crm 迁移到 salesforce crm 的最佳实践。

您应该使用迁移工具吗？如果是这样，那里有什么好的迁移工具？

我应该先将数据迁移到microsoft excel，然后再将其从excel迁移到salesforce吗？

我读到您可以通过 .csv 文件将数据导入到 salesforce crm。例如，您能否将数据从动态 crm 导出到 .csv 文件，然后使用 salesforce 导入文件。这是替代解决方案吗？

哪种做法可以减少功能损失？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T13:26:06.230

我最近刚刚对可用工具进行了评估，发现[Scribe Insight](http://www.scribesoft.com/)仍然是连接到 Dynamics CRM 的最佳工具。他们的 60 天许可证选项非常适合一次性数据迁移。

# c# - 从 Asp.net 应用程序在客户端打开 Word 文档

> ID：11335125
> 
> 赞同：1
> 
> 时间：2012-07-04T20:29:06.930
> 
> 标签：c#, asp.net, document

我们需要使用 Microsoft Word 打开位于客户端计算机上的服务器上的 Word 文档。该解决方案在本地工作，但是当部署在服务器上时，唯一发生的事情是 winword.exe 在服务器上启动。这可以使用互操作或javascript吗？

这是到目前为止的代码

```
Microsoft.Office.Interop.Word.ApplicationClass wordApp = new Microsoft.Office.Interop.Word.ApplicationClass();

object file = FilePath + FileName;
lblError.Text = lblError.Text + file.ToString(); 
object readOnly = false;
object objTrue = true;
object missing = System.Reflection.Missing.Value;
object emptyData = string.Empty;
wordApp.Visible = true;
Microsoft.Office.Interop.Word.Document aDoc                         =
wordApp.Documents.Open(ref file,
         ref missing, ref readOnly,
         ref missing, ref missing, ref missing,
         ref missing, ref missing, ref missing,
         ref missing, ref missing, ref objTrue);

aDoc.Activate(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T20:31:34.523

您必须记住，客户端和服务器运行在两台不同的机器上。服务器无法启动在客户端计算机上运行的程序。

此外，仅供参考，***切勿***使用 ASP.NET 应用程序中的 Office 自动化。这些 API 专为在桌面应用程序中使用而设计。它们将无法正常工作、不受支持，甚至可能违反您的 Office 许可证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T20:32:17.120

它在本地工作的原因是因为它不是。发生的事情是服务器正在打开文档，但是由于您的本地计算机正在充当服务器，因此它看起来好像文件已打开。

一种简单的解决方案是让用户下载文件，对其进行编辑并将其上传回给您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T07:45:12.393

```
<script language="javascript" type="text/javascript"> 
    function openDokument(dokument){ 
        var objAppl;

        try{ 
            objAppl = GetObject("","Word.Application"); 
            objAppl.Documents.open(dokument); 
        } 
        catch(exception){ 
            objAppl = new ActiveXObject("Word.Application");
            objAppl.Visible = true;
            alert(dokument);
            objAppl.Documents.open(dokument);
            objAppl.Activate(); 
        }    
        objAppl = null;           
    }
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-22T10:04:35.827

您可以使用 DocX 类来创建您的单词文档。然后使用 Response.Write() 方法（确切地说 doxument 扩展名是 .docx）将文档下载到您的机器中

# java - 如何使用 Java Math Commons CurveFitter？

> ID：11335127
> 
> 赞同：7
> 
> 时间：2012-07-04T20:29:27.567
> 
> 标签：java, math, curve-fitting

如何使用 Math Commons CurveFitter 将函数拟合到一组数据？有人告诉我将 CurveFitter 与**LevenbergMarquardtOptimizer**和**ParametricUnivariateFunction**一起使用，但我不知道在 ParametricUnivariateFunction 梯度和值方法中要写什么。另外，写完之后，如何获取拟合的函数参数呢？我的功能：

```
public static double fnc(double t, double a, double b, double c){
  return a * Math.pow(t, b) * Math.exp(-c * t);
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2014-11-15T02:56:21.210

所以，这是一个老问题，但我最近遇到了同样的问题，最后不得不深入研究邮件列表和 Apache Commons Math 源代码来解决这个问题。

这个 API 的文档记录非常差，但是在*当前*版本的 Apache Common Math (3.3+) 中，有两个部分，假设您有一个带有多个参数的变量：要拟合的函数（实现 ParametricUnivariateFunction）和曲线拟合器（它扩展了 AbstractCurveFitter）。

**适合的功能**

*   `public double value(double t, double... parameters)`
    *   你的方程式。这是您放置`fnc`逻辑的地方。
*   `public double[] gradient(double t, double... parameters)`
    *   返回上述关于每个参数的偏导数数组。 如果（像我一样）你的微积分生疏了，[这个计算器可能会有所帮助，但是任何好的计算机代数系统都可以计算这些值。](http://www.symbolab.com/solver/partial-derivative-calculator/)

**曲线拟合器**

*   `protected LeastSquaresProblem getProblem(Collection<WeightedObservedPoint> points)`
    *   设置一堆样板废话，并返回一个最小二乘问题供装配工使用。

综上所述，这是您特定情况下的示例解决方案：

```
import java.util.*;
import org.apache.commons.math3.analysis.ParametricUnivariateFunction;
import org.apache.commons.math3.fitting.AbstractCurveFitter;
import org.apache.commons.math3.fitting.leastsquares.LeastSquaresBuilder;
import org.apache.commons.math3.fitting.leastsquares.LeastSquaresProblem;
import org.apache.commons.math3.fitting.WeightedObservedPoint;
import org.apache.commons.math3.linear.DiagonalMatrix;

class MyFunc implements ParametricUnivariateFunction {
    public double value(double t, double... parameters) {
        return parameters[0] * Math.pow(t, parameters[1]) * Math.exp(-parameters[2] * t);
    }

    // Jacobian matrix of the above. In this case, this is just an array of
    // partial derivatives of the above function, with one element for each parameter.
    public double[] gradient(double t, double... parameters) {
        final double a = parameters[0];
        final double b = parameters[1];
        final double c = parameters[2];

        return new double[] {
            Math.exp(-c*t) * Math.pow(t, b),
            a * Math.exp(-c*t) * Math.pow(t, b) * Math.log(t),
            a * (-Math.exp(-c*t)) * Math.pow(t, b+1)
        };
    }
}

public class MyFuncFitter extends AbstractCurveFitter {
    protected LeastSquaresProblem getProblem(Collection<WeightedObservedPoint> points) {
        final int len = points.size();
        final double[] target  = new double[len];
        final double[] weights = new double[len];
        final double[] initialGuess = { 1.0, 1.0, 1.0 };

        int i = 0;
        for(WeightedObservedPoint point : points) {
            target[i]  = point.getY();
            weights[i] = point.getWeight();
            i += 1;
        }

        final AbstractCurveFitter.TheoreticalValuesFunction model = new
            AbstractCurveFitter.TheoreticalValuesFunction(new MyFunc(), points);

        return new LeastSquaresBuilder().
            maxEvaluations(Integer.MAX_VALUE).
            maxIterations(Integer.MAX_VALUE).
            start(initialGuess).
            target(target).
            weight(new DiagonalMatrix(weights)).
            model(model.getModelFunction(), model.getModelFunctionJacobian()).
            build();
    }

    public static void main(String[] args) {
        MyFuncFitter fitter = new MyFuncFitter();
        ArrayList<WeightedObservedPoint> points = new ArrayList<WeightedObservedPoint>();

        // Add points here; for instance,
        WeightedObservedPoint point = new WeightedObservedPoint(1.0,
            1.0,
            1.0);
        points.add(point);

        final double coeffs[] = fitter.fit(points);
        System.out.println(Arrays.toString(coeffs));
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-10-31T16:58:22.143

我知道这个问题已经很老了，而且[i80](https://stackoverflow.com/users/299320/i80and)回答这个问题做得很好，但我只是想补充一下（对于未来的 SO-ers），有一种非常简单的方法可以用 Apache Math 计算导数或偏导数（所以你没有为雅可比矩阵做你自己的微分）。这是[DerivativeStructure](http://commons.apache.org/proper/commons-math/javadocs/api-3.3/org/apache/commons/math3/analysis/differentiation/DerivativeStructure.html)。

扩展[i80and](https://stackoverflow.com/users/299320/i80and)的答案以使用[DerivativeStructure](http://commons.apache.org/proper/commons-math/javadocs/api-3.3/org/apache/commons/math3/analysis/differentiation/DerivativeStructure.html)类：

```
//Everything stays the same except for the Jacobian Matrix

import java.util.*;
import org.apache.commons.math3.analysis.ParametricUnivariateFunction;
import org.apache.commons.math3.fitting.AbstractCurveFitter;
import org.apache.commons.math3.fitting.leastsquares.LeastSquaresBuilder;
import org.apache.commons.math3.fitting.leastsquares.LeastSquaresProblem;
import org.apache.commons.math3.fitting.WeightedObservedPoint;
import org.apache.commons.math3.linear.DiagonalMatrix;
import org.apache.commons.math3.analysis.differentiation.DerivativeStructure;

class MyFunc implements ParametricUnivariateFunction {
    public double value(double t, double... parameters) {
        return parameters[0] * Math.pow(t, parameters[1]) * Math.exp(-parameters[2] * t);
    }

    // Jacobian matrix of the above. In this case, this is just an array of
    // partial derivatives of the above function, with one element for each parameter.
    public double[] gradient(double t, double... parameters) {
        final double a = parameters[0];
        final double b = parameters[1];
        final double c = parameters[2];

        // Jacobian Matrix Edit

        // Using Derivative Structures...
        // constructor takes 4 arguments - the number of parameters in your
        // equation to be differentiated (3 in this case), the order of
        // differentiation for the DerivativeStructure, the index of the
        // parameter represented by the DS, and the value of the parameter itself
        DerivativeStructure aDev = new DerivativeStructure(3, 1, 0, a);
        DerivativeStructure bDev = new DerivativeStructure(3, 1, 1, b);
        DerivativeStructure cDev = new DerivativeStructure(3, 1, 2, c);

        // define the equation to be differentiated using another DerivativeStructure
        DerivativeStructure y = aDev.multiply(DerivativeStructure.pow(t, bDev))
                .multiply(cDev.negate().multiply(t).exp());

        // then return the partial derivatives required
        // notice the format, 3 arguments for the method since 3 parameters were
        // specified first order derivative of the first parameter, then the second, 
        // then the third
        return new double[] {
                y.getPartialDerivative(1, 0, 0),
                y.getPartialDerivative(0, 1, 0),
                y.getPartialDerivative(0, 0, 1)
        };

    }
}

public class MyFuncFitter extends AbstractCurveFitter {
    protected LeastSquaresProblem getProblem(Collection<WeightedObservedPoint> points) {
        final int len = points.size();
        final double[] target  = new double[len];
        final double[] weights = new double[len];
        final double[] initialGuess = { 1.0, 1.0, 1.0 };

        int i = 0;
        for(WeightedObservedPoint point : points) {
            target[i]  = point.getY();
            weights[i] = point.getWeight();
            i += 1;
        }

        final AbstractCurveFitter.TheoreticalValuesFunction model = new
                AbstractCurveFitter.TheoreticalValuesFunction(new MyFunc(), points);

        return new LeastSquaresBuilder().
                maxEvaluations(Integer.MAX_VALUE).
                maxIterations(Integer.MAX_VALUE).
                start(initialGuess).
                target(target).
                weight(new DiagonalMatrix(weights)).
                model(model.getModelFunction(), model.getModelFunctionJacobian()).
                build();
    }

    public static void main(String[] args) {
        MyFuncFitter fitter = new MyFuncFitter();
        ArrayList<WeightedObservedPoint> points = new ArrayList<WeightedObservedPoint>();

        // Add points here; for instance,
        WeightedObservedPoint point = new WeightedObservedPoint(1.0,
                1.0,
                1.0);
        points.add(point);

        final double coeffs[] = fitter.fit(points);
        System.out.println(Arrays.toString(coeffs));
    }
} 
```

就是这样。我知道这是一个使用起来非常复杂/令人困惑的类，但是当您处理非常复杂的方程时，它肯定会派上用场，而手动获得偏导数会很麻烦（这发生在我不久前），或者当您想导出偏导数时，请说二阶或三阶。

对于二阶、三阶等阶导数，您所要做的就是：

```
// specify the required order as the second argument, say second order so 2
DerivativeStructure aDev = new DerivativeStructure(3, 2, 0, a);        
DerivativeStructure bDev = new DerivativeStructure(3, 2, 1, b);
DerivativeStructure cDev = new DerivativeStructure(3, 2, 2, c);

// and then specify the order again here
y.getPartialDerivative(2, 0, 0),
y.getPartialDerivative(0, 2, 0),
y.getPartialDerivative(0, 0, 2) 
```

希望这对某人有所帮助。

# c - C中的显示缓冲区

> ID：11335133
> 
> 赞同：-4
> 
> 时间：2012-07-04T20:29:58.927
> 
> 标签：c

我正在尝试显示一个缓冲区，但它以特殊字符显示。这是我的代码：

```
size_t write(int fd, const void *buf, size_t count)
{

    static size_t (*write_func)(int, const void *, size_t) = NULL;
    if (!write_func)
        write_func = (size_t(*)(int, const void *, size_t)) dlsym(RTLD_NEXT, "write");

    char tmp[count];  

    memcpy(tmp,buf,count);
    printf("  %c \n",tmp[1]); 
```

您对如何解决此问题有任何想法吗？太感谢了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T20:56:46.043

您在堆栈上分配只读数据的副本。这是危险的，因为堆栈空间可能是有限的。（在 Linux 中，只有原始堆栈会动态增长；线程堆栈的大小是固定的，而且通常非常小。）

然后您使用 stdio.h`printf()`函数将指定数据的第二个字节（即使`count`可能是 1）输出到标准输出，因此您很可能访问临时数组之外的内容。

大多数`printf()`实现`write()`在内部调用以刷新缓冲区。根据链接的不同，这最终可能是递归的（你的函数调用`printf`调用你的函数调用`printf`等等），用尽进程可用的所有 RAM，然后崩溃。

以上没有任何意义。

首先，如果您需要复制输入数据，请使用`malloc()`and动态复制`memcpy()`，然后再复制`free()`。这样你就不会突然开始在多线程程序中导致崩溃（除了 Linux 中的原始进程，堆栈空间是有限且固定的）。

其次，您需要使用`write_func`通过链接器获得的原始文件。

第三，您需要保留`errno`以避免在客户端程序中出现不可预见的问题。只需使用临时本地`int`来存储它。请记住，不仅`write()`，而且可能修改，`malloc()`并且您必须对调用者隐藏这些更改。`free()``errno`

第四，返回类型`write()`is `ssize_t`， not `size_t`。前者是签名的，后者可能是未签名的。

第五，总是允许短写。您永远不能依赖获得“完整”块；应用程序进行内部处理，尤其是在使用套接字时，以奇数大小刷新它（特别是 TCP/IP 和 UDP/IP 的 MTU 的倍数）。您对输入/输出的“修改”必须是无状态的。更糟糕的是，如果您的修改更改了缓冲区长度，并且描述符是非阻塞的，并且`write_func()`调用在修改部分的中间返回一个简短的写入，它没有明智地映射到任何原始字节，你将如何处理它？你不能重试，真的，因为描述符是非阻塞的；原始应用程序可能会挂起——例如，如果以协同处理方式使用，同时从具有严格排序要求的对等进程发送和接收数据——因为当应用程序逻辑级别不允许添加时，您的添加将重新发出写入。

简而言之，您的计划行不通。您可能会让它与一些特定的简单应用程序一起工作，但它可能会严重破坏其他应用程序。无论你想达到什么目标，都有更好的方法。

我希望我不会太直率，但我强烈建议您先了解低级 POSIX I/O 的来龙去脉，然后再围绕它们创建包装器。[Linux 手册页项目](http://www.kernel.org/doc/man-pages/online/dir_all_by_section.html)是我可以推荐的一个很好的参考，但我认为您可能需要先从一些教程开始。

# java - 如何实现分层位置信息

> ID：11335139
> 
> 赞同：1
> 
> 时间：2012-07-04T20:30:34.527
> 
> 标签：java, grails, groovy, model, location

我正在查看一个未开发的应用程序，我需要添加对指定位置的支持，[就像 vrbo.com 一样](http://www.vrbo.com/)，您可以在其中从整个美国向下钻取到州、地区、城市/地区。

编译此信息的最佳方法是什么？是否有第三方来源？如果没有，如何最好地建模？

我在考虑是否也允许用户定义位置，但我不确定这是否明智。

现在我只需要处理美国，但我想对未来的国际支持保持聪明。

我正在使用 Grails/Groovy，但如果需要，我可以使用底层 Java。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T21:52:50.650

[ISO 3166](https://en.wikipedia.org/wiki/ISO_3166)是国家和国家细分（州、省等）信息的良好来源。如果你四处寻找，你可以直接从这里下载数据文件：[http](http://anonscm.debian.org/gitweb/?p=iso-codes/iso-codes.git;a=tree) ://anonscm.debian.org/gitweb/?p=iso-codes/iso-codes.git;a=tree 。

对于城市，我发现的最好的资源是[MaxMind 城市数据库](https://www.maxmind.com/app/worldcities)。这是一个免费下载。

# javascript - 在backbone.js中的2个不同模板之间交替

> ID：11335141
> 
> 赞同：6
> 
> 时间：2012-07-04T20:30:49.283
> 
> 标签：javascript, jquery, backbone.js, underscore.js

我的模型视图有 2 个不同的模板。每次从数据库中获取模型时，从后端获取的前 3 个模型（#1、2、3）将使用第一个模板创建视图，接下来的 4 个模型（#4、5、6、7）将使用第二个模板，接下来的 3 个模型（#8、9、10）将使用第一个模板，依此类推。

**问题：**我将如何使用backbone.js 引入这个交替模板？

**JS代码**

```
// Views

PhotoListView = Backbone.View.extend({
    el: '#photo_list',

    render: function() {
        $(this.el).html('');
        _.each(this.model.models, function(photo) {
            $(this.el).append(new PhotoListItemView({ model: photo }).render().el);
        }, this);
        return this;
    }
});

PhotoListItemView = Backbone.View.extend({
    tagNAme: 'div',
    className: 'photo_box',

    template: _.template( $('#tpl_PhotoListView').html() ),

    initialize: function() {
        this.model.bind('destroy', this.close, this);
    },

    render: function() {
        $(this.el).html( this.template( this.model.toJSON() ) );
        return this;
    },

    close: function() {
        this.unbind();
        this.remove();
    }
}); 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-07-04T22:14:00.880

首先，您`PhotoListView`正在包装一个集合，因此您应该`this.collection`在视图中使用并`new PhotoListView({ collection: c })`创建它。视图对待[`collection`选项的方式与对待选项的方式类似`model`](http://backbonejs.org/#View-constructor)：

> **构造函数/初始化** `new View([options])`
> 
> [...] 有几个特殊选项，如果通过，将直接附加到视图：`model`、`collection`、`el`、`id`、`className`和`tagName`属性。

使用正确的名称将有助于防止混淆。此外，视图已经混合了[一些下划线方法](http://backbonejs.org/#Collection-Underscore-Methods)，因此您可以说`this.collection.each(...)`代替`_.each(this.collection.models, ...)`or `_(this.collection.models).each(...)`。您也可以使用[`this.$el`](http://backbonejs.org/#View-%24el)代替`$(this.el)`.

现在谈谈你真正的问题。您可以将两个模板添加到每个模型视图中：

```
PhotoListItemView = Backbone.View.extend({
    template0: _.template($('#the-first-template-id').html()),
    template1: _.template($('#the-other-template-id').html()),
    //...
}); 
```

以及告诉它使用哪一个的选项：

```
initialize: function(options) {
    this.template = this['template' + options.template_number];
    //...
} 
```

然后你只需`group`要从集合视图中指定选项。Underscore[`each`](http://underscorejs.org/#each)将迭代索引作为第二个参数传递给回调函数，因此您只需要一些整数数学来确定`template_number`使用哪个：

```
this.collection.each(function(photo, i) {
    // Grouped in threes and you're alternating between two templates.
    var n = Math.floor(i / 3) % 2; 
    var v = new PhotoListItemView({ model: photo, template_number: n });
    this.$el.append(v.render().el);
}, this); 
```

# ruby-on-rails - “.active?”的含义

> ID：11335144
> 
> 赞同：2
> 
> 时间：2012-07-04T20:31:24.500
> 
> 标签：ruby-on-rails

我正在编写我的第一个 Rails 应用程序，但我对在一些[文档](http://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html#method-i-fields_for)中看到的方法调用感到困惑。在下面的代码段中，调用`project.active?`做什么？

```
<%= form_for @person do |person_form| %>
  ...
  <% @person.projects.each do |project| %>
    <% if project.active? %>
      <%= person_form.fields_for :projects, project do |project_fields| %>
        Name: <%= project_fields.text_field :name %>
      <% end %>
    <% end %>
  <% end %>
  ...
<% end %> 
```

我已经尝试查找 的源代码`.active?`，但找不到它...我搜索了[ActiveRecord::Base](http://api.rubyonrails.org/classes/ActiveRecord/Base.html)，我认为它是 的超类`project`，但它不存在。我不知道还能去哪里看。

有谁知道该`.active?`方法的作用，以及在哪里可以找到有关它的文档？

谢谢，

D.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-04T20:35:31.493

在这种情况下，您的模型很可能`Project`有一个名为 的布尔字段`active`。`active?`是 ActiveRecord 提供的布尔值的快捷方式：它根据该布尔值返回 true 或 false。

附带说明一下，裸字段名称的操作方式相同——因此`project.active`，就像`project.active?`, 将返回`true`or `false`。`true`但是大多数返回或`false`以问号结尾的Ruby 方法，所以为了方便起见，布尔字段获取其名称的别名加上问号。

# c# - C#正则表达式查找行的最后一个字符

> ID：11335145
> 
> 赞同：0
> 
> 时间：2012-07-04T20:31:31.263
> 
> 标签：c#, regex, visual-studio-2010, visual-studio

我想要实现的是显示以`needle`字符开头/结尾的行数。

我的代码看起来像这样

```
case "Starting with":
    count = File.ReadLines(openFileDialog1.FileName)
                .Count(line => Regex.IsMatch(line, "^" + needle + ".*$"));
    break;
case "Ending with":
    count = File.ReadLines(openFileDialog1.FileName)
                .Count(line => Regex.IsMatch(line, "^.*" + needle + ".*$"));
    break; 
```

从找到正确的计数开始，但以不结束。我错过了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-04T20:33:39.120

为什么要为此使用正则表达式？只需使用`string.EndsWith`(and `string.StartsWith`)，除非`needle`实际上*是*正则表达式。（您在问题中将其称为“字符”......如果它是用户输入的字符，如果用户输入“。”，您最终可能会得到一些意外结果。）

编辑：假设你有`needle`一个`string`（例如来自`textBox.Text`）

```
case "Starting with":
    count = File.ReadLines(openFileDialog1.FileName)
                .Count(line => line.StartsWith(needle))
    break;
case "Ending with":
    count = File.ReadLines(openFileDialog1.FileName)
                .Count(line => line.EndsWith(needle))
    break; 
```

（请注意，如果需要，您可以在此处提取常用功能，只需将谓词分配给变量，然后在单个位置调用`ReadLines`和。）`Count`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T20:33:03.883

删除模式末尾的 .* ：

```
Regex.IsMatch(line, "^.*" + needle + "$")); 
```

# javascript - 将 2012-07-04T17:30:52+00:00 转换为 2012-07-04T17:30:52Z

> ID：11335152
> 
> 赞同：2
> 
> 时间：2012-07-04T20:32:42.830
> 
> 标签：javascript, jquery

据我所知，两者
`2012-07-04T17:30:52+00:00`都是
`2012-07-04T17:30:52Z`iso8601 格式的日期**，**时区为 UTC。

我正在使用 prettyDate jquery 插件。它只接受格式的日期`2012-07-04T17:30:52Z`

我正在获取格式的日期`2012-07-04T17:30:52+00:00`作为来自 json 的响应

那么我如何转换`2012-07-04T17:30:52+00:00`为`2012-07-04T17:30:52Z`使用 javascript 或 jquery。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T20:38:16.860

你可以试试：

**[jsFiddle 演示](http://jsfiddle.net/smYKJ/)**

```
var serverSays = '2012-07-04T17:30:52+00:00';
var iWant = serverSays.split('+')[0] +'Z'; 
```

# java - 将 JLabel 数组导入 JComponent

> ID：11335153
> 
> 赞同：1
> 
> 时间：2012-07-04T20:32:50.800
> 
> 标签：java, arrays, swing, jlabel, jcomponent

我环顾四周试图解决我的问题，但找不到任何解决此问题的方法。我对Java真的很陌生，并且正在尝试在不使用控制台的情况下完成书中的项目，但这就是我所拥有的，

```
import javax.swing.JComponent;
import javax.swing.JLabel;
import javax.swing.JOptionPane;

public class FutureInvestmentValue {
public static void main(String[] args) {
    double investmentAmount = Double.parseDouble(JOptionPane.showInputDialog(null, "Enter in the investment amount as a double.", "Investment Amout",
            JOptionPane.PLAIN_MESSAGE));

    double monthlyInterestRate = Double.parseDouble(JOptionPane.showInputDialog(null, "Enter in the monthly interest rate as a double.", "Monthly Interest Rate",
            JOptionPane.PLAIN_MESSAGE));

    int years = 30;

    final JComponent[] outputHeader = new JComponent[] {
            new JLabel("The amount invested: " + investmentAmount),
            new JLabel("Annual interest Rate: " + monthlyInterestRate),
            new JLabel("Years       Future Value"),
    };

    JOptionPane.showMessageDialog(null, outputHeader + futureInvestmentValue(investmentAmount, monthlyInterestRate, years), "Future Investment Value",
            JOptionPane.INFORMATION_MESSAGE);
}

public static JComponent[] futureInvestmentValue(double investmentAmount, double monthlyInterestRate, int years) {
    final JComponent[] investmentArray = new JComponent[years];
    for (int i = 1; i <= years; i++) {
        double investmentTotal = investmentAmount + (investmentAmount * ((monthlyInterestRate / 10) * i));
        investmentArray[i] = new JLabel(i + "              " + investmentTotal);
    }

return investmentArray;
}
} 
```

似乎我收到了要更改 futureInvestmentValue(); 的错误。到一个 Jcomponent ，当我这样做时，会发生另一个错误，它只是让我绕圈子，从 JLabel 更改为 JLabel [] 到 Jcomponent 到 Jcomponent [] 等等。任何可以用不会让新手感到困惑的术语向我解释的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T20:49:29.940

*   why do you create an array of JLabel, to use the JTable instead,

![enter image description here](../Images/33a8194d04abd382ef5e0325acc6e10e.png)

```
import java.awt.*;
import java.awt.event.ActionEvent;
import java.util.Random;
import java.util.concurrent.*;
import javax.swing.*;
import javax.swing.event.*;
import javax.swing.table.DefaultTableModel;

public class ChangeNotifiersOnEvent extends JFrame implements Runnable {

    private static final long serialVersionUID = 1L;
    private boolean runProcess = true;
    private Random random = new Random();
    private javax.swing.Timer timerRun;
    private Executor executor = Executors.newCachedThreadPool();
    private String[] columnNames = {"Source", "Hit", "Last", "Ur_Diff"};
    private JTable table;
    private Object[][] data = {{"Swing Timer", 2.99, 5, 1.01},
        {"Swing Worker", 7.10, 5, 1.010}, {"TableModelListener", 25.05, 5, 1.01}};
    private DefaultTableModel model = new DefaultTableModel(data, columnNames);

    public ChangeNotifiersOnEvent() {
        table = new JTable(model) {

            private static final long serialVersionUID = 1L;

            @Override
            public Class getColumnClass(int column) {
                return getValueAt(0, column).getClass();
            }
        };
        model.addTableModelListener(new TableModelListener() {

            @Override
            public void tableChanged(TableModelEvent tme) {
                if (tme.getType() == TableModelEvent.UPDATE) {
                    if (tme.getColumn() == 1 && tme.getLastRow() == 2) {
                        double dbl = ((Double) table.getModel().getValueAt(2, 1))
                                - ((Integer) table.getModel().getValueAt(2, 2));
                        table.getModel().setValueAt(dbl, 2, 3);
                    } else if (tme.getColumn() == 1 && tme.getLastRow() == 0) {
                        prepareUpdateTableCell();
                    } else if (tme.getColumn() == 1 && tme.getLastRow() == 1) {
                        executor.execute(new MyTask(MyTask.UPDATE_TABLE_COLUMN));
                    }
                }
            }
        });
        table.setRowHeight(30);
        table.setFont(new Font("Serif", Font.BOLD, 20));
        table.getColumnModel().getColumn(0).setPreferredWidth(180);
        table.setPreferredScrollableViewportSize(table.getPreferredSize());
        JScrollPane scrollPane = new JScrollPane(table);
        add(scrollPane, BorderLayout.CENTER);
        new Thread(this).start();
    }

    private void prepareUpdateTableCell() {
        timerRun = new javax.swing.Timer(10, UpdateTableCell());
        timerRun.setRepeats(false);
        timerRun.start();
    }

    private Action UpdateTableCell() {
        return new AbstractAction("Update Table Cell") {

            private static final long serialVersionUID = 1L;

            @Override
            public void actionPerformed(ActionEvent e) {
                double dbl = ((Double) table.getModel().getValueAt(0, 1))
                        - ((Integer) table.getModel().getValueAt(0, 2));
                table.getModel().setValueAt(dbl, 0, 3);
            }
        };
    }

    @Override
    public void run() {
        while (runProcess) {
            try {
                Thread.sleep(330);
            } catch (Exception e) {
                e.printStackTrace();
            }
            changeTableValues();
        }
    }

    private void changeTableValues() {
        Runnable doRun = new Runnable() {

            @Override
            public void run() {
                table.getModel().setValueAt(random.nextInt(128) + random.nextDouble(), 0, 1);
                table.getModel().setValueAt(random.nextInt(256) + random.nextDouble(), 1, 1);
                table.getModel().setValueAt(random.nextInt(512) + random.nextDouble(), 2, 1);

                table.getModel().setValueAt(random.nextInt(128), 0, 2);
                table.getModel().setValueAt(random.nextInt(128), 1, 2);
                table.getModel().setValueAt(random.nextInt(128), 2, 2);
            }
        };
        SwingUtilities.invokeLater(doRun);
    }

    private class MyTask extends SwingWorker<Void, Integer> {

        private static final String UPDATE_TABLE_COLUMN = "update";
        private String namePr;
        private double dbl;

        MyTask(String str) {
            this.namePr = str;
        }

        @Override
        protected Void doInBackground() throws Exception {
            dbl = ((Double) table.getModel().getValueAt(1, 1))
                    - ((Integer) table.getModel().getValueAt(1, 2));
            return null;
        }

        @Override
        protected void done() {
            SwingUtilities.invokeLater(new Runnable() {

                @Override
                public void run() {
                    table.getModel().setValueAt(dbl, 1, 3);
                }
            });
        }
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                ChangeNotifiersOnEvent frame = new ChangeNotifiersOnEvent();
                frame.setDefaultCloseOperation(EXIT_ON_CLOSE);
                frame.setLocation(150, 150);
                frame.pack();
                frame.setVisible(true);
            }
        });
    }
} 
```

*   you can to add / remove row(s) on runtime,

![enter image description here](../Images/99cc2e0c86b8eada550d608c36da82d2.png)

```
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.*;
import javax.swing.table.*;

public class RemoveAddRows extends JFrame {

    private static final long serialVersionUID = 1L;
    private Object[] columnNames = {"Type", "Company", "Shares", "Price"};
    private Object[][] data = {
        {"Buy", "IBM", new Integer(1000), new Double(80.50)},
        {"Sell", "MicroSoft", new Integer(2000), new Double(6.25)},
        {"Sell", "Apple", new Integer(3000), new Double(7.35)},
        {"Buy", "Nortel", new Integer(4000), new Double(20.00)}
    };
    private JTable table;
    private DefaultTableModel model;

    public RemoveAddRows() {

        model = new DefaultTableModel(data, columnNames) {

            private static final long serialVersionUID = 1L;

            @Override
            public Class getColumnClass(int column) {
                return getValueAt(0, column).getClass();
            }
        };
        table = new JTable(model) {

            private static final long serialVersionUID = 1L;

            @Override
            public Component prepareRenderer(TableCellRenderer renderer, int row, int column) {
                Component c = super.prepareRenderer(renderer, row, column);
                int firstRow = 0;
                int lastRow = table.getRowCount() - 1;
                int width = 0;
                if (row == lastRow) {
                    ((JComponent) c).setBackground(Color.red);
                } else if (row == firstRow) {
                    ((JComponent) c).setBackground(Color.blue);
                } else {
                    ((JComponent) c).setBackground(table.getBackground());
                }
                /*if (!isRowSelected(row)) {
                String type = (String) getModel().getValueAt(row, 0);
                c.setBackground("Buy".equals(type) ? Color.GREEN : Color.YELLOW);
                }
                if (isRowSelected(row) && isColumnSelected(column)) {
                ((JComponent) c).setBorder(new LineBorder(Color.red));
                }*/
                return c;
            }
        };
        table.setPreferredScrollableViewportSize(table.getPreferredSize());
        JScrollPane scrollPane = new JScrollPane(table);
        add(scrollPane);
        JButton button1 = new JButton("Remove all rows");
        button1.addActionListener(new ActionListener() {

            public void actionPerformed(ActionEvent arg0) {
                if (model.getRowCount() > 0) {
                    for (int i = model.getRowCount() - 1; i > -1; i--) {
                        model.removeRow(i);
                    }
                }
                System.out.println("model.getRowCount() --->" + model.getRowCount());
            }
        });
        JButton button2 = new JButton("Add new rows");
        button2.addActionListener(new ActionListener() {

            public void actionPerformed(ActionEvent arg0) {
                Object[] data0 = {"Buy", "IBM", new Integer(1000), new Double(80.50)};
                model.addRow(data0);
                Object[] data1 = {"Sell", "MicroSoft", new Integer(2000), new Double(6.25)};
                model.addRow(data1);
                Object[] data2 = {"Sell", "Apple", new Integer(3000), new Double(7.35)};
                model.addRow(data2);
                Object[] data3 = {"Buy", "Nortel", new Integer(4000), new Double(20.00)};
                model.addRow(data3);
                System.out.println("model.getRowCount() --->" + model.getRowCount());
            }
        });
        JPanel southPanel = new JPanel();
        southPanel.add(button1);
        southPanel.add(button2);
        add(southPanel, BorderLayout.SOUTH);
    }

    public static void main(String[] args) {
        RemoveAddRows frame = new RemoveAddRows();
        frame.setDefaultCloseOperation(EXIT_ON_CLOSE);
        frame.pack();
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    }
} 
```

# c# - 如何覆盖默认的未捕获异常对话框？

> ID：11335159
> 
> 赞同：9
> 
> 时间：2012-07-04T20:33:05.193
> 
> 标签：c#, winforms, exception-handling

当 .NET 应用程序中未捕获异常时，虚拟机会向用户显示错误消息。我希望能够显示我自己的错误消息，而不必`catch`在我的应用程序的顶层放置一个块（因为这会使调试未捕获的异常更加乏味）。

现在，我在`AppDomain.UnhandledException`事件侦听器中显示我自己的错误对话框，但 .NET 创建的对话框仍然显示。我也想避免`Environment.FailFast`，因为这会绕过我的`finally`块（我仍然有些依恋）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-04T20:51:59.903

如果这是 WinForms，您必须处理[AppDomain.UnhandledException](http://msdn.microsoft.com/en-us/library/system.appdomain.unhandledexception.aspx)和[Application.ThreadException](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.threadexception.aspx)才能捕获它们。一些例外过滤到一个和其他过滤到另一个。

这里有一个类似（但不完全重复）的问题应该有所帮助：[C# - WinForms - 事件的异常处理](https://stackoverflow.com/questions/2524381/c-sharp-winforms-exception-handling-for-events)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T20:51:16.007

Windows Forms 有一个内置的异常处理程序，默认情况下在没有附加调试器时捕获未处理的托管异常，并且在窗口消息处理期间发生异常，并且App.Config 中的*jitDebugging* = false。然后它会向最终用户显示一个对话框并防止应用程序终止。

您可以更改**HKLM\Software\Microsoft\.NetFramework**下的注册表设置*DbgJitDebugLaunchSetting*。这具有我知道的三个值之一：

 ***   0：显示询问“调试或终止”的用户对话框。
*   1：让异常通过让CLR来处理。
*   *2：启动DbgManagedDebugger*注册表项中指定的调试器。

在 Visual Studio 中，转到*工具 > 选项 > 调试 > JIT*将此键设置为 0 或 2。但值 1 通常是您在最终用户的机器上想要的值

（参见[http://msdn.microsoft.com/en-us/library/2ac5yxx6(v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/2ac5yxx6%28v=vs.90%29.aspx)）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T20:45:15.850

WP7 中的类似模式怎么样？

```
 // Code to execute on Unhandled Exceptions
    private void Application_UnhandledException(object sender, ApplicationUnhandledExceptionEventArgs e)
    {
        // do stuff
        if (System.Diagnostics.Debugger.IsAttached)
        {
            // An unhandled exception has occurred; break into the debugger
            System.Diagnostics.Debugger.Break();
        }
    } 
```**

# iphone - 如何在 Xcode (iPhone) 上为用 C 制作的控制台应用程序制作 GUI。

> ID：11335161
> 
> 赞同：2
> 
> 时间：2012-07-04T20:33:07.260
> 
> 标签：iphone, xcode, terminal

我有一个用 C 语言制作的控制台应用程序，在终端中运行良好。但我需要将它移植到 iPhone。所以我需要制作一个响应模仿终端的 GUI。所以基本上我需要输入数据并从控制台应用程序获取输出（printf）。这个 C 应用程序连接到路由器，所以我不确定是否有实现 GUI 的方法，可能是从控制台应用程序接收输出的文本字段。问题是，iphone 没有终端，C 应用程序在 Xcode 中编译得很好，它也被加载到 iPhone 上。但是由于没有终端..它只是打印一些诸如“正在连接..”之类的东西，但是连接完成后......它会断开连接。我猜是因为它没有找到任何可以与之交互的终端。我已经尝试过 -MobileTerminal- 但该应用程序只能在越狱的 iphone 上运行，所以我不想要那个。

有什么建议么 ？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-20T18:09:45.613

首先，创建一个 iPhone 应用程序。相应地创建您的 UI 和其他内容。

其次，将 C 文件添加到您的项目中，在那里执行您的逻辑。由于 main() 不是您的应用程序的入口点，因此您需要修改代码逻辑并将其组织到方法中。

第三，在要使用逻辑的地方添加对您创建的 C 文件的引用。

最后，直接调用方法就可以了。

* * *

这是我尝试的一个小例子：

1.  我创建了一个 iPhone 单视图项目 getCNumber。

2.  我在项目中添加了两个文件：Number.h 和 Number.m

在 Number.h 中：

```
 #include <stdio.h>

  int getNum(); 
```

在 Number.m 中：

```
 #include "Number.h"

  int getNum()
  {
      return 234;
  }

3\. In getCNumber.xib, I have a label. 
```

在 getCNumber.h 中，

```
 #import <UIKit/UIKit.h>

    @interface getCNumber : UIViewController
    {
         UILabel *lblNum;
    }

    @property (nonatomic, retain) IBOutlet UILabel *lblNum;

    @end 
```

在 getCNumber.m 中，在 -(void)viewDidLoad() 中，

```
 - (void)viewDidLoad
   {
          [super viewDidLoad];
      // Do any additional setup after loading the view, typically from a nib.

          int someNum = getNum();
          self.lblNum.text = [NSString stringWithFormat:@"Number from C: %i",someNum];

    } 
```

您可能需要做一些额外的工作才能让您的 C 程序与 iOS“包装器”一起使用，因为我不确切知道您在 C 中做了什么，但这应该向您展示这里的一般想法。

希望能帮助到你。

# vaadin - vaadin 6.5.7 - 如何使用过滤容器中的多个值

> ID：11335175
> 
> 赞同：1
> 
> 时间：2012-07-04T20:34:56.550
> 
> 标签：vaadin

我正在寻找一种解决方案，我想使用逻辑 OR 过滤具有多个值的容器。

例如，我想过滤我的值并获得 value == "A" 或 "B" 的结果

当我只有 1 个值时，这段代码有效：

```
private void applyTextFilters(List<String> filters)
{
    unselectAllItems();

    IndexedContainer container = (IndexedContainer) valuesTable.getContainerDataSource();
    container.removeContainerFilters(Columns.SEARCH.id());

    for (String filter : filters) {
        container.addContainerFilter(Columns.SEARCH.id(), filter, true, false);
    }

    clinicalValuesGraph.refreshGraph(container, getLabel("clinicalvalues.graph.caption"));
    // if it is the case ...
    //toggleEmptyResultNotification();
    handleView(viewMode);
} 
```

我错过了什么？同样，如果我的代码中有 2 个过滤器（“A”、“B”），则不会显示任何结果，但如果我通过“A”，它会起作用。

跟着我的问题...

使用 6.5.7，我需要使用 2 个条件过滤我的容器，如“patrick”或“john”等搜索名称。

我检查了代码，这是我需要修改方法（受保护）的地方：

```
protected boolean passesFilters(Object itemId) {
    IndexedContainerItem item = new IndexedContainerItem(itemId);
    if (filters == null) {
        return true;
    }
    final Iterator<Filter> i = filters.iterator();
    while (i.hasNext()) {
        final Filter f = i.next();
        if (!f.passesFilter(item)) {
            return false;
        }
    }
    return true;
} 
```

**对此：**

```
protected boolean passesFilters(Object itemId) {
    IndexedContainerItem item = new IndexedContainerItem(itemId);
    if (filters == null) {
        return true;
    }
    boolean previouslyPassedFilter = false;
    boolean PassesFilter = true;

    final Iterator<Filter> i = filters.iterator();
    while (i.hasNext()) {
        final Filter f = i.next();
        if (!f.passesFilter(item) && !previouslyPassedFilter) {
            passesFilter = false;
        } else {
            previouslyPassedFilter = true;
        }
    }
    return passesFilter ;
} 
```

如果不必重写所有这些类（IndexedContainer、IndexContainerItem...），如何做到这一点？

# excel - 250 个客户的动态季度报告 - Crystal Reports 或其他工具？

> ID：11335180
> 
> 赞同：0
> 
> 时间：2012-07-04T20:35:34.147
> 
> 标签：excel, crystal-reports, report, visualization, import-from-excel

我希望为 250 个客户的列表创建一个 2-3 页的 PDF 报告。

数据最初是从 Excel 电子表格中获得的。

我需要做的基本上是将 Excel 数据导入一个工具（Crystal Reports 还是更好的选择？），并让它根据预先设计的模板生成 250 个 PDF 文档。

原始 Excel 电子表格中清楚地标明了 250 个客户。

我不是高级 Crystal Reports 用户，所以我什至不确定这是否可以使用 Crystal Reports。我的问题是，Crystal Reports 是否适合这个项目，如果不是，我应该考虑哪些替代方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T21:27:50.223

Crystal could be quite a good solution for this, although it is somewhat objective and you will need a third party tool (or to design something yourself) to take care of the splitting out to separate clients.

Do you need any pointers?

You can most likely approach 1 of 2 ways:

*   Create a report which will contain all of the data and then said 3rd party or home-made tool will split into many smaller reports
*   Create a report which is executed once per client using said 3rd party or home-made tool

# javascript - jquery mobile，页面上的事件已更改

> ID：11335181
> 
> 赞同：1
> 
> 时间：2012-07-04T20:35:36.050
> 
> 标签：javascript, jquery, jquery-mobile, jqplot

我有一个非常简单的问题，但是我对更深层次的 JS 的了解有点太有限了。我创建的是一个简单的 jQuery Mobile 应用程序。

页面 A 有一个到页面 B 的链接元素。页面 B 包含一些 JavaScript，它会触发 jqPlot 来绘制图表。

当我直接访问页面 B 时，它工作正常。在页面 A 上使用链接时，它不会触发 JavaScript 代码。

在 BI 内部只需调用`$(document).ready(function (){});`

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T20:51:38.863

查看`pagechange`事件文档中的事件：http: [//jquerymobile.com/test/docs/api/events.html](http://jquerymobile.com/test/docs/api/events.html)

这个事件应该完成你想要做的事情。

# jquery - 将选项卡的值重置为默认 css 状态

> ID：11335182
> 
> 赞同：1
> 
> 时间：2012-07-04T20:35:41.903
> 
> 标签：jquery, css, tabs

如果单击另一个选项卡，我有一个关于重置活动选项卡类状态的问题。下面的代码按预期切换类以显示不同的选项卡颜色图像，但是如果我单击另一个选项卡，两个选项卡都显示为活动的。

我的问题是我需要添加什么才能将活动选项卡重置为其默认状态并将新单击的选项卡激活为活动状态。

```
$(document).ready(function(){
    $('.slide-out').each(function(){
        var $this = $(this);
        var defaultPos = roundValue($this.css('left'));

        $('.tab', $this).on('click', function(){
            var tab = $(this);                                                                              
            var goTo = tab.attr('slide-To');
            var currentPos = roundValue($this.css('left'));

            if(goTo == currentPos){
               goTo = defaultPos;
            }                                       

            $this.animate({'left': goTo}, 'slow');  
            $(this).toggleClass('handle2-selected');                                    
        });
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T20:47:29.483

而不是 toggleClass 您应该从选项卡中删除 handle2-selected 类，然后将其应用于当前类（this）

就像是

```
$('.tab').removeClass('handle2-selected');
tab.addClass('handle2-selected'); 
```

更新：

删除活动选项卡上的活动类

```
// check if current clicked tab has the active class or not
if(tab.hasClass('handle2-selected')) {
    // if current clicked tab has active class, remove it
    tab.removeClass('handle2-selected');
    // add other codes for this state if needed
} else {
    // if not then do the normal removing and adding to current tab
    $('.tab').removeClass('handle2-selected');
    tab.addClass('handle2-selected');
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T20:48:11.500

您也应该像在下一个选项卡上一样切换上一个选项卡上的课程。或者你可以在开始动画之前编写我的这段代码。

```
$('.tab').removeClass('handle2-selected'); 
```

# html - 如何使当前项目粘在 CSS3 的模糊菜单中？[内有示例教程]

> ID：11335184
> 
> 赞同：0
> 
> 时间：2012-07-04T20:36:06.970
> 
> 标签：html, css, menu

[我按照这里](http://tympanus.net/codrops/2011/10/19/blur-menu-with-css3-transitions/)的教程 为我的投资组合网站创建了一个模糊菜单。

但是，我将需要帮助确保选择菜单中的其中一个项目时，它保持未束缚，而其他人则模糊，以显示用户目前正在浏览的项目。一旦用户将鼠标悬停在其他项目上，我还希望其他项目变得清晰。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T21:02:20.637

只需向活动项目添加一个类，并将其样式设置为与悬停相同。为了获得更多乐趣，您可以将活动项目定位为在悬停效果期间显示略有不同。

这是一个小提琴示例：http: [//jsfiddle.net/mobidevelop/LPrce/](http://jsfiddle.net/mobidevelop/LPrce/)

# simplexml - PHP 5.3 中的 simplexml_load_file 错误

> ID：11335187
> 
> 赞同：2
> 
> 时间：2012-07-04T20:36:58.583
> 
> 标签：simplexml, php

我正在使用以下代码来读取 RSS 提要并输出结果。

```
function home_page_parser($feedURL) {
    $rss = simplexml_load_file($feedURL);
    $i = 0;

    echo  "<ul>";

    foreach ($rss->channel->item as $feedItem) {
        $i++;
        $myDate = ($feedItem->pubDate);
        $dateForm = explode(" ", $myDate);
        echo "<li class=\"rss-feed\"><a href=\"$feedItem->link\" title=\"$feedItem->title\" target=\"_blank\">".$feedItem->title."</a><br />" .$feedItem->pubDate. "</li>";

    if($i >= 3) break;

    echo "</ul>";
    }
} 
```

它在我运行 PHP 5.2 的 Rackspace Cloud 测试站点上运行良好

在运行 PHP 5.3 的 Media Temple 的实时站点上，我收到以下错误：

* * *

> 警告：simplexml_load_file() [function.simplexml-load-file]: http:// 包装器在服务器配置中被禁用，在第 39 行的 /.../html/includes/functions.php 中的 allow_url_fopen=0
> 
> 警告：simplexml_load_file( `http://www.chinaknowledge.com/Newswires/RSS_News/RSS_News.xml`) [function.simplexml-load-file]：未能打开流：在第 39 行的 /.../html/includes/functions.php 中找不到合适的包装器
> 
> 警告：simplexml_load_file() [function.simplexml-load-file]：I/O 警告：未能`"http://www.chinaknowledge.com/Newswires/RSS_News/RSS_News.xml"`在第 39 行的 /.../html/includes/functions.php中加载外部实体
> 
> 警告：在第 44 行的 /.../html/includes/functions.php 中为 foreach() 提供的参数无效

* * *

第 39 行是这样的：

```
$rss = simplexml_load_file($feedURL); 
```

我做错了什么或需要更改以在 5.3 上工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-04T20:41:46.430

你不觉得这个错误很有描述性吗？

> http:// 包装器在服务器配置中被 allow_url_fopen=0 禁用

您将需要编辑 PHP 配置文件并更改配置`allow_url_fopen`。~~如果你不能直接尝试 ini_set()~~

**编辑：**正如@evanmcd 在评论中指出的那样，这个配置只能在 php.ini 中设置。[PHP 文档](http://php.net/manual/en/filesystem.configuration.php)参考。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T05:45:45.393

这个错误是由于“http:// wrapper is disabled in the server configuration by allow_url_fopen=0”。为了避免这个问题，我们需要将此设置覆盖为 On 而不是 off。在我看来，大多数共享托管服务器**不允许你通过 ini_set('allow_url_fopen', 'on'); 进行这些设置 或 htaccess 覆盖**。因此，我建议不要尝试这些方法来获取该提要，如下所示。使用 CURL，我们需要将提要 xml 的内容获取到变量中。然后处理我们的 simplexml 文件操作。

例子

```
$feed ='http://api.twitter.com/1/statuses/user_timeline.rss?screen_name=mytwittername';
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $feed);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
// get the result of http query
$output = curl_exec($ch);
curl_close($ch);
$xml = simplexml_load_file($output); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-11-21T07:24:18.150

如果您不允许在服务器中编辑 php.ini，您可以使用 curl 获取 xml 并读取 xml Stirng，如下所示。

```
function home_page_parser($feedURL) {
    $rss = simplexml_load_file(curlXML($feedURL);
    $i = 0;

    echo  "<ul>";

    foreach ($rss->channel->item as $feedItem) {
        $i++;
        $myDate = ($feedItem->pubDate);
        $dateForm = explode(" ", $myDate);
        echo "<li class=\"rss-feed\"><a href=\"$feedItem->link\" title=\"$feedItem->title\" target=\"_blank\">".$feedItem->title."</a><br />" .$feedItem->pubDate. "</li>";

    if($i >= 3) break;

    echo "</ul>";
    }
}

function curlXML($url){
   $ch = curl_init();
   curl_setopt($ch, CURLOPT_URL, $url);
   curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
   // get the result of http query
   $output = curl_exec($ch);
   curl_close($ch);

   return $output;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-09T14:16:50.123

```
ini_set("allow_url_fopen", 1); 
```

这将在 php.ini 文件中设置 allow url open = On 但您需要在 easyphp 或 xamp 或 wamp 或托管中重新启动 php。

# wix - WiX：使用 Burn 安装 .NET，然后使用自己的 WPF 嵌入式 UI 启动 MSI

> ID：11335189
> 
> 赞同：1
> 
> 时间：2012-07-04T20:37:18.283
> 
> 标签：wix, windows-installer, bootstrapper, burn

我已经使用带有 EmbeddedUI 元素的自定义 WPF UI 制作了带有 WiX 的 MSI 安装程序。它类似于 src/DTF/Samples/EmbeddedUI 中的示例。

我现在想要一个引导程序来检查是否安装了 .NET 4，如果没有安装它，然后启动我的 MSI。

看起来 Burn 会覆盖我的 WPF EmbeddedUI，以便将 .NET 4 和 MSI 安装链接到带有单个进度条的单个安装中。我知道我可以有一个托管应用程序来更改 Burn 的 UI，然后将参数传递给我的 MSI，但问题是我希望我的 UI 位于依赖 .NET 的 WPF 中，并且如果整个引导程序依赖于 .NET那么如果他没有首先安装引导程序，用户甚至无法打开它。

我想要的是引导程序，如果需要，可以使用像 Wixstdba 这样的简单 UI 来安装 .NET，然后使用它自己的 WPF EmbeddedUI 启动我的 MSI，而无需将其与 .NET 安装链接。我不介意两种安装都有自己的进度条，我只想能够使用我的 WPF EmbeddedUI 来安装主应用程序。

那有可能吗。如何？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T12:15:17.847

如果您希望 WiX 引导程序显示安装程序的 UI，请将MsiPackage的[DisplayInternalUI属性设置为 true。](http://wix.sourceforge.net/manual-wix3/wix_xsd_msipackage.htm)不过，该解决方案确实有在安装过程中显示两个 UI 的缺点。

您还可以使用 WPF 和 .NET创建[托管引导程序应用程序。](http://blogs.msdn.com/b/heaths/archive/2011/10/28/introducing-managed-bootstrapper-applications.aspx)Burn 提供了一种在显示自定义 UI 之前基本上引导自身并安装 .NET 的方法。

# javascript - Javascript 对象的属性是关于“this”的详细信息

> ID：11335190
> 
> 赞同：0
> 
> 时间：2012-07-04T20:37:24.873
> 
> 标签：javascript, object, scope, this

```
var foo = {
  p1: function(){
    return this.p2;
  },

  p2: function(){
    console.log('i am foo.p2');
  }
}; 
```

我正在尝试做与上面的示例类似的事情，但是当我调用时遇到了一个问题：

```
var result = foo.p1(); 
```

结果 == '未定义'

我对“this”在对象上下文中的工作方式感到困惑。有人可以解释我在哪里出错了吗？

**编辑** 更完整的例子：

```
suite_segments.themis = {

    //don't re-run themis initialization script
    initialized: false,

    /**
     * Initializer for themis product. Returns true if initialization
     * operations were performed, false if not (most likely because 
     * the product was already initialized -- not a fresh navigation)
     */
    init: function(){

            //prevent multiple initializations
            if(this.initialized)
                return false; //did not initialize
            this.initialized = true;

            //operations
            jQuery('#tabs').tabs();

            //init success
            return this.themis_destroy;         
    },

    /* ----------------------------------------------------------------------------------
     *      DESTRUCTORS
     * ----------------------------------------------------------------------------------/
    /**
     * Function to be invoked if user navigates away from 'themis' entirely. Other
     * sub-destroy type functions will be invoked if necessary when a user switches 
     * between parts of themis
     * 
     */
    themis_destroy: function(){

        console.log('themis_destructor');
        this.initialized = false;

    },
    /**
     * Designed to be overwritten every time a segment of themis is loaded. Will be invoked 
     * ever time a segment of themis is loaded.
     */
    themis_sub_destroy: function(){}

}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T22:15:18.887

您完成的示例也将起作用。使用您的代码，`suite_segments.themis.init()` *将*返回析构函数（或`false`），而不是`undefined`.

但是你还有另一个问题：析构函数不起作用。阅读[这个关于`this`关键字](https://developer.mozilla.org/en/JavaScript/Reference/Operators/this)的优秀概述，你会看到：`this`指向当前上下文，它是依赖于调用的。当 per 调用时`...themis.init()`，该函数将在`themis`对象的上下文中调用 - 一切都很好。但是返回的函数 ( `suite_segments.themis.destroy`) 不会在对象上调用，而是（我猜）是独立的 - 并且没有机会设置`initialized`正确对象的属性。

在您的情况下，我可以推荐设置返回函数上下文的[`.bind()`方法：](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/bind)

```
return this.themis_destroy.bind(this); 
```

另请参阅有关“[*具有作为函数的属性的对象*](http://blog.niftysnippets.org/2008/03/mythical-methods.html)[”或](http://blog.niftysnippets.org/2008/03/mythical-methods.html)[*方法的神话的*](http://blog.niftysnippets.org/2008/03/mythical-methods.html)[博客文章](http://blog.niftysnippets.org/2008/03/mythical-methods.html)**，它完全涵盖了您的标题问题，以及[有关`this`](http://blog.niftysnippets.org/2008/04/you-must-remember-this.html).**

 *** * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T20:43:32.293

Doug Crockford 有一个[关于对象内私有/公共/特权成员的好页面](http://www.crockford.com/javascript/private.html)，并讨论了定义这些成员的最佳实践。`this`这可能有助于消除您对变量的一些困惑。

但是，在您的示例中，您不能向我们展示某些东西。的返回值是如下所示`foo.p1`的函数：`foo.f2`

[http://jsfiddle.net/erSWu/1/](http://jsfiddle.net/erSWu/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T20:53:17.930

你犯了一个矿工的错误兄弟...

它应该是这样的：

```
var foo = {
  p1: function(){
    return this.p2();
  },

  p2: function(){
    console.log('i am foo.p2');
  }
}; 
```**

# objective-c - 多态关系的 MagicalRecord 导入

> ID：11335193
> 
> 赞同：2
> 
> 时间：2012-07-04T20:37:39.080
> 
> 标签：objective-c, core-data, magicalrecord

我使用 MagicalRecord 将数据导入到大量使用多态性的 CoreData 模型中。

例如，一组具体实体都扩展了相同的抽象实体，用于来自另一个类的多对多关系，该类在模型中将其属性类型指定为抽象类类型，允许 Set是两种具体类型的混合物。

MagicalRecord 不会从导入的数据中生成正确的子实体。

这是一个*最简单*的例子。

我有一个名为的实体`PlantName`，它的`names`Set 定义为 type `NameComponent`。我有一个抽象实体，`NameComponent`它有：`searchString`和. 它由两个子实体扩展：which has和which has 。`timeStamp``title``CommonName``locale``LatinName``type`

要导入的相关 JSON 片段：

```
"names": [                                        /* NameComponent(s) */
    {"title": "Jade Plant", "locale": "en_us"},   /* CommonName - US English */
    {"title": "Crassulaceae", "type":4},          /* LatinName - Family */
    {"title": "Crassula", "type":5},              /* LatinName - Genus */
    {"title": "Ovata", "type":6}                  /* LatinName - Species */
] 
```

导入运行后，如果我查看 SQLite DB，我发现所有记录都已作为抽象类类型导入，此外，每个具体类类型独有的所有属性都丢失了。

我唯一能找到这种工作示例的地方是 MagicalRecord 的单元测试。然而，即便如此，在一个重要的地方也是不同的。测试关系是具体类型的，而我的是由抽象类类型的。

我认为这种差异是导致 MagicalRecord 不将单个记录生成为具体类的原因。

有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-12T10:53:30.790

我来这里是为了寻找一种用 Magical Record 实现多态性的方法。我不确定我的回答是否会对这个特定问题有所帮助（特别是因为它已经晚了 18 个月:)），但一般来说，它应该适用于像我一样在这里借钱的任何人。

假设你有类似的东西（使用 Rails）：

```
class Event
  has_one :location, :as => :localizable, :dependent => :destroy
end

class User
  has_one :location, :as => :localizable, :dependent => :destroy
end

class Location
  belongs_to :localizable, :polymorphic => true
end 
```

你的位置 json 看起来像：

```
{
  id: 1,
  localizable_id: 1,
  localizable_type: "Event"
} 
```

您在 Xcode 中的 Location.m 可能如下所示：

```
@interface Location ()

@end

@implementation Location {
    NSString *_localizableType;
}

- (void) willImport:(id)data {
    _localizableType = [data valueForKey:@"localizable_type"];
}

- (BOOL) shouldImportEvent:(id)data;
{

    return [_attachableType isEqualToString:@"Event"];
}

- (BOOL) shouldImportUser:(id)data;
{

    return [_attachableType isEqualToString:@"User"];
}

@end 
```

不要忘记在每个关系的数据模型用户信息中将 mappedKeyName 设置为“localizable_id”。

请参阅[轻松导入数据](http://www.cimgf.com/2012/05/29/importing-data-made-easy/)或浏览源代码以了解 willImport: 和 shouldImport: 回调以及如何设置 mappedKeyName。

**这背后的逻辑：**

shouldImport: 的 data 只是 id，我们无法从那里访问 localizable_type，所以我们只需预先设置一个私有属性（_localizable_type），并在导入期间使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-03T06:22:34.630

这是我在编写 MagicalImport 库时没有考虑过的情况。我将不得不将此添加为将来的更新。

# java - 使用 JSF Facelets 的国际化 (i18n)：Java 类中的消息

> ID：11335195
> 
> 赞同：2
> 
> 时间：2012-07-04T20:37:56.683
> 
> 标签：java, jsf, internationalization, facelets

我已经在我的项目中成功实现了 i18n。现在我被困在我的豆子里了......

```
private String pageTitle;
public List<Product> getProductsByCategory(String category) {
  if(validate(category)) {
    pageTitle = category;
    return service.getProductsByCategory(String category);
  } else {
    pageTitle = "Random products";
    return service.getRandomProducts();
  }
} 
```

如您所见，我想让我的 pageTitle 依赖于所提供方法的结果。一切都很好，但考虑到国际化，这并不好。我曾尝试使用 Properties.load(new FileInputStream) 方法，但考虑到文件名称为 base.properties、base_en_US.properties 等，这不起作用。

有谁知道在这种情况下的最佳做法？提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-04T20:43:52.190

您需要使用与 JSF 相同的方式来加载资源包：使用[`ResourceBundle`](http://docs.oracle.com/javase/6/docs/api/java/util/ResourceBundle.html)API。这是一个示例，假设基本名称是`com.example.i18n.base`（正是您在`<f:loadBundle>`in view 或`<resource-bundle>`in 中使用的值`faces-config.xml`）

```
ResourceBundle bundle = ResourceBundle.getBundle("com.example.i18n.base",
    FacesContext.getCurrentInstance().getViewRoot().getLocale());
String pageTitle = bundle.getString("page.title");
// ... 
```

# java - 超出年份时日历添加方法错误

> ID：11335203
> 
> 赞同：-7
> 
> 时间：2012-07-04T20:38:35.347
> 
> 标签：java, date, calendar

我一定是错误地使用了 java.util.Calendar#add(...) 方法，因为它给了我意想不到的结果。假设一些初始条件：

*   我创建了一个日历对象并将其初始化为 2012 年 1 月 30 日。
*   我尝试添加 47 周，从中提取日期并打印出结果。
*   我尝试将 48 周添加到原始实例（或它的克隆副本），并打印出结果。

我假设两个结果之间会有 7 天的差异，但我得到的是 7 天 + 1 年。

例如：

```
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.Calendar;

public class CalendarFun {
   public static void main(String[] args) {
      Calendar cal = Calendar.getInstance();

      cal.set(Calendar.MONTH, Calendar.JANUARY);
      cal.set(Calendar.DAY_OF_MONTH, 30);
      cal.set(Calendar.YEAR, 2012);

      Date date = cal.getTime();
      SimpleDateFormat dateFormat = new SimpleDateFormat("MM/dd/YYYY");
      System.out.println(dateFormat .format(date));

      Calendar newCal = (Calendar) cal.clone();
      newCal.add(Calendar.WEEK_OF_YEAR, 47);
      System.out.println("add 47 weeks: " + dateFormat.format(newCal.getTime()));

      newCal = (Calendar) cal.clone();
      newCal.add(Calendar.WEEK_OF_YEAR, 48);
      System.out.println("add 48 weeks: " + dateFormat.format(newCal.getTime()));
   }
} 
```

这打印出来：

```
01/30/2012
add 47 weeks: 12/24/2012
add 48 weeks: 12/31/2013 
```

2013 年 12 月 31 日？我该如何解决？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-04T20:49:23.570

除非我将您的代码更改`YYYY`为`yyyy`. 之后它似乎工作正常。

# asp.net-mvc-3 - EntityFramework - SaveChanges 不保存但在 Profiler 中看到 SQL

> ID：11335204
> 
> 赞同：0
> 
> 时间：2012-07-04T20:38:36.400
> 
> 标签：asp.net-mvc-3, c#-4.0, sql-server-2008-r2, entity-framework-4.3

我已经阅读了关于 EF-SaveChanges 的大多数帖子，并且不相信我的答案存在于这些帖子中。

我正在使用 C#、.NET 4、EF 4.3.1、SQL Server 2008R2、VS 2k11 Beta、AutoMapper。

这是我的代码：

```
using (Model.AnimalRescueEntities context = new Model.AnimalRescueEntities())
{
    using (TransactionScope transaction = new TransactionScope())
    {
        context.Connection.Open();

        //Retrieve the event
        eventDB = context.Events.Single(e => e.ID == eventRegVM.EventID);
        eventOrgBaseDB = context.Entity_Base.Single(b => b.ID == eventDB.Entity_Organisation.ID);
        eventRegVM.Event = Mapper.Map<Model.Event, EventsViewModel>(eventDB);
        eventRegVM.Event.Entity_Organisation.Entity_Base = Mapper.Map<Model.Entity_Base, Entity_BaseViewModel>(eventOrgBaseDB);

        //saves Event_Registration
        eventRegDB = Mapper.Map<Event_RegistrationViewModel, Model.Event_Registration>(eventRegVM);
        eventRegDB.Event = eventDB;
        eventRegDB.EventID = eventDB.ID;
        eventRegDB.Event.Entity_Organisation = context.Entity_Organisation.Single(o => o.ID == eventOrgBaseDB.ID);
        eventRegDB.Event.Entity_Organisation.Entity_Base = eventOrgBaseDB;

        //Add the link between EVENT and REGISTRATION
        context.Event_Registration.AddObject(eventRegDB);
        int numChanges = context.SaveChanges();

        var regs = context.Event_Registration.Where(r => r.ID != null).ToList();
    }
} 
```

我在后台运行 SQL Profiler，当调用 SaveChanges 时，我看到了这个 SQL 代码（**numChanges**为 1）：

```
exec sp_executesql N'declare @generated_keys table([ID] uniqueidentifier)
insert [dbo].[Event_Registration]([EventID], [DateSubmitted], [HasPaid], [PaymentMethod], [Comments], [AmountPaid])
output inserted.[ID] into @generated_keys
values (@0, @1, null, @2, null, @3)
select t.[ID]
from @generated_keys as g join [dbo].[Event_Registration] as t on g.[ID] = t.[ID]
where @@ROWCOUNT > 0',N'@0 uniqueidentifier,@1 datetime2(7),@2 int,@3 decimal(19,4)',@0='1D841F75-AEA1-4ED1-B3F0-4E3994D7FC0D',@1='2012-07-04 14:59:45.5239309',@2=0,@3=0 
```

**regs**将包含三个现有行和我的新行。但是，我无法在 SQL Server 中运行 SELECT 语句并查看我的新行。多次运行将得到相同的结果——数据库中现有的三行和永远不会进入数据库的新的第四行。

**eventRegDB**还包含为主键 ID 创建的 GUID；我假设 SQL 服务器会这样做，但不能 100% 确定这一点。

我采用了上述 TSQL 并在针对我的数据库的查询窗口中运行它 - 之后我在 Event_Registration 表中获得了新行 - 这就是创建三个现有行的方式。

我现在看到生成的异常或其他错误，找不到任何不保存到数据库的原因。有任何想法吗？如果您想查看 SQL 的架构、如何重新创建数据库、代码（任何或全部），然后询问 - 这都托管在[http://animalrescue.codeplex.com/](http://animalrescue.codeplex.com/)但我没有存储这个代码，还。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T21:08:04.733

你失踪了`transaction.Complete()`，所以你的交易永远不会被提交。当`using`块 for`TransactionScope`完成时，您的事务将回滚。

# javascript - js - 如何根据对象数组中另一个键的值更改一个键的值

> ID：11335208
> 
> 赞同：0
> 
> 时间：2012-07-04T20:38:46.777
> 
> 标签：javascript, arrays, iteration

我有一个这样的对象数组：

```
var chartData = [{count: 0, idTag: "24"}
                 {count: 0, idTag: "25"}
                 {count: 0, idTag: "26"}] 
```

我的代码做了一些工作并生成一个数字 ( `totalValue`)。如果`totalValue`与 匹配`idTag`，则其`count`增加一：

```
for (i=0; i<timesFlipped; i++) {
    totalValue = runTrial();
    for (j=0; j<chartData.length; j++) {
        if (chartData[j].idTag === totalValue) {
            chartData[j].count += 1;
            break;
        }
    }
} 
```

这是一个简单的示例，但`chartData`可以容纳几十个对象，并且`timesFlipped`可以进行数十万次迭代。

这是`count`根据匹配`idTag`值更改值的最佳方法吗？有没有办法在`idTag`不遍历整个对象数组的情况下找到具有正确值的数组索引？

如果您需要更多上下文，这是我正在处理的页面：http: [//blue.butler.edu/~aazman/coupling/](http://blue.butler.edu/~aazman/coupling/)

* * *

**更新：**

感谢所有的建议。我有点根据我所看到的形成了自己的解决方案。关于该项目的更多背景信息使我找到了我的解决方案：

*   的长度`chartData`和最小 idTag 值是根据用户点击提交时的输入计算的
*   一旦`min`和`length`被计算（因此最大 idTag 是已知的），`chartData`被迭代初始化：

`var min = 23-5*numNickel-numPenny; //numNickel & numPenny are the user inputs`

`var length = 5*(2*numNickel+1)+2*numPenny;`

`var tempTag = min;`

`for (j=0;j<length;j++) {`

`chartData[j] = {count: 0, idTag = tempTag};`

`tempTag++;`

`}`

*   由于特定于游戏规则的原因，idTag 值（无论有多少）对称地集中在周围`idTag:25`（例如 idTags = {24, 25, 26} 或 idTags = {20,21,22,23,24,25, 26,27,28,29,30}. 无论 的长度如何`chartData`，长度总是奇数，`idTag:25`总是第`[(chartData.length-1)/2]`'th 索引。

因此，如果 idTag 的`chartData`are`{20,21,22,23,24,25,26,27,28,29,30}`和 if given ，那么`runTrial()`将始终位于 index 。`totalValue = 22``idTag:22``(totalValue - min)`

所以我改变了chartData的初始化和计数增加的方式：

```
for (j=0; j<length; j++) {
    chartData[j] = {count: 0};  //based on what I'm doing with chartData next, I need each index to still be an object
}

for (i=0; i<timesFlipped; i++) {
    totalValue = runTrial();
    var index = totalValue - min;
    chartData[index].count++;
} 
```

所以感谢大家的帮助:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T20:52:34.897

You could create another object which points to the objects in the chartData array, like so:

```
var idToChart = {};
for (var i = 0; i < chartData.length; i++) {
    var currChart = chartData[i];
    idToChart[currChart.idTag] = currChart;
} 
```

and then use

```
var chart = idToChart[totalValue];
chart.count++; 
```

Accessing the object's property should be faster than looping through the array each time.

If, as @zerkms pointed out, your array is sorted by `idtag`, you wouldn't even need to create another object and could access the array directly. Ideally, `chartData` would start in the `idToChart` or sorted array format.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T20:55:39.297

我宁愿维护一个以“idTag”值作为键并将其计数作为值的中间散列，使用 for 循环执行操作，然后在 for 循环完成后从中间散列生成 charData。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T20:48:40.963

我建议使用客户端数据库存储机制，让查询为您计算。

这使其更易于监督并减少了来自各种病毒扫描程序的警告，而且您无需每次都重新获取数据。

另一种方法是使用服务器端数据库并通过 json 检索所需的值。

防止浏览器冻结的另一种方法是让您的循环在 webworker 中运行，这样它就成为一个线程并且不会锁定浏览器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-05T16:18:17.023

如果您可以随意更改 chartData 的结构，为什么不将其设为哈希而不是数组呢？

```
var chartData = {24: 0,
                 25: 0,
                 26: 0}; 
```

然后循环变成

```
for (i=0; i<timesFlipped; i++) {
    chartData[runTrial()]++;        
} 
```

# iphone - 我可以在 iPhone 上保存文件吗？

> ID：11335210
> 
> 赞同：1
> 
> 时间：2012-07-04T20:39:21.290
> 
> 标签：iphone, ios, file, download

我有一个要移植到 iPhone 的 Android 应用程序，一个重要功能需要打开用户下载的简单文本文件。在 Android 上，通常的方式是让用户将文件作为电子邮件附件获取，但用户可以通过任何方式将文件下载到他们的 iPhone 以便我的应用程序可以打开它。有没有办法在 iPhone 上做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-11T23:06:58.590

我不太确定您是如何处理文本文件的，但是当用户选择从您的应用程序中的邮件应用程序打开附件时，以下方法可以从附加的电子邮件中检索文本文件。

首先，您需要将您的应用注册为能够打开文本文件。为此，请转到您应用的**info.plist**文件并添加以下部分：

```
<key>CFBundleDocumentTypes</key>
  <array>
      <dict>
        <key>CFBundleTypeName</key>
        <string>Text Document</string>
        <key>CFBundleTypeRole</key>
        <string>Viewer</string>
        <key>LSHandlerRank</key>
        <string>Alternate</string>
        <key>LSItemContentTypes</key>
        <array>
            <string>public.text</string>
        </array>
    </dict>
</array> 
```

这将告诉 iOS 你的应用可以打开文本文件。现在，只要有一个按钮显示“打开方式...”（例如，在 Safari 或 Mail 中）并且用户想要打开一个文本文件，您的应用程序就会显示在列表中。

您还必须在 AppDelegate 中处理文本文件的打开：

```
-(BOOL)application:(UIApplication *)application openURL:(NSURL *)url sourceApplication:(NSString *)sourceApplication annotation:(id)annotation
{    
if (url != nil && [url isFileURL]) {
    //Removes the un-needed part of the file path so that only the File Name is left
    NSString *newString = [[url absoluteString] substringWithRange:NSMakeRange(96, [[url absoluteString] length]-96)];
    //Send the FileName to the USer Defaults so your app can get the file name later
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    [defaults setObject:newString forKey:@"fileURLFromApp"];
    //Save the Defaults
    [[NSUserDefaults standardUserDefaults] synchronize];
    //Post a Notification so your app knows what method to fire
    [[NSNotificationCenter defaultCenter] postNotificationName:@"fileURLFromApp" object:nil];
} else {
}
return YES;
} 
```

您必须在 ViewController.m 中注册该通知：

```
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(fileURLFromApp) name:@"fileURLFromApp" object:nil]; 
```

然后您可以创建所需的方法并检索文件：

```
- (void) fileURLFromApp
{   
//Get stored File Path
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];
NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
NSString *filePath = [defaults objectForKey:@"fileURLFromApp"];
NSString *finalFilePath = [documentsDirectory stringByAppendingPathComponent:filePath];
//Parse the data
//Remove "%20" from filePath
NSString *strippedContent = [finalFilePath stringByReplacingPercentEscapesUsingEncoding:NSUTF8StringEncoding];
//Get the data from the file
NSString* content = [NSString stringWithContentsOfFile:strippedContent encoding:NSUTF8StringEncoding error:NULL]; 
```

上述方法将为您提供名为 NSString 的文本文件的内容`content`

那应该行得通！祝你好运！

# iphone - 并发可靠地使用核心数据

> ID：11335214
> 
> 赞同：7
> 
> 时间：2012-07-04T20:39:36.570
> 
> 标签：iphone, ios, cocoa-touch, core-data, nsmanagedobjectcontext

我正在构建我的第一个 iOS 应用程序，理论上它应该非常简单，但我很难让它足够防弹，让我有信心将它提交到 App Store。

简而言之，主屏幕有一个表格视图，在选择一行后，它会连接到另一个表格视图，该表格视图以主从方式显示与所选行相关的信息。底层数据每天一次从 Web 服务中检索为 JSON 数据，然后缓存在 Core Data 存储中。删除当天之前的数据以阻止 SQLite 数据库文件无限增长。所有数据持久化操作都是使用 Core Data 执行的，并带有一个`NSFetchedResultsController`基础的详细表视图。

我看到的问题是，如果您在检索、解析和保存新数据时多次在主屏幕和详细屏幕之间快速切换，应用程序将完全冻结或崩溃。似乎存在某种竞争条件，可能是由于核心数据在后台导入数据，而主线程正在尝试执行获取，但我在推测。我无法捕获任何有意义的崩溃信息，通常它是核心数据堆栈中的一个 SIGSEGV。

下表显示了加载详细信息表视图控制器时发生的事件的实际顺序：

```
主线程后台线程
viewDidLoad

                                     获取 JSON 数据（使用 AFNetworking）

创建子 NSManagedObjectContext (MOC)

                                     解析 JSON 数据
                                     在子 MOC 中插入托管对象
                                     拯救儿童 MOC
                                     导入后完成通知

接收导入完成通知
保存父 MOC
执行获取和重新加载表视图

                                     删除子 MOC 中的旧托管对象
                                     拯救儿童 MOC
                                     删除后完成通知

接收删除完成通知
保存父 MOC

```

当 JSON 数据到达时触发 AFNetworking 完成块，`NSManagedObjectContext`就会创建一个嵌套并将其传递给解析 JSON 数据并将对象保存到核心数据存储的“导入器”对象。`performBlock`导入器使用iOS 5 中引入的新方法执行：

```
NSManagedObjectContext *child = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSPrivateQueueConcurrencyType];
    [child setParentContext:self.managedObjectContext];        
    [child performBlock:^{
        // Create importer instance, passing it the child MOC...
    }]; 
```

导入器对象观察它自己的 MOC `NSManagedObjectContextDidSaveNotification`，然后发布它自己的通知，该通知由详细表视图控制器观察。发布此通知时，表视图控制器在其自己的（父）MOC 上执行保存。

在导入当天的新数据后，我使用相同的基本模式和“删除器”对象来删除旧数据。这在获取结果控制器获取新数据并且重新加载详细信息表视图后异步发生。

我没有做的一件事是观察任何合并通知或锁定任何托管对象上下文或持久存储协调器。这是我应该做的事情吗？我有点不确定如何正确地构建这一切，所以不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T20:56:02.673

在 iOS 5 之前，我们通常有两个`NSManagedObjectContexts`：一个用于主线程，一个用于后台线程。后台线程可以加载或删除数据然后保存。然后将结果`NSManagedObjectContextDidSaveNotification`（如您所做的那样）传递给主线程。我们调用`mergeChangesFromManagedObjectContextDidSaveNotification:`将它们带入主线程上下文。这对我们来说效果很好。

一个重要方面是`save:`后台线程*阻塞*，直到在`mergeChangesFromManagedObjectContextDidSaveNotification:`主线程上完成运行（因为我们从侦听器调用 mergeChanges... 到该通知）。这可确保主线程托管对象上下文看到这些更改。如果你有亲子关系我不知道你是否*需*要这样做，但你在旧模型中这样做以避免各种麻烦。

我不确定在两个上下文之间建立父子关系的好处是什么。根据您的描述，最终保存到磁盘似乎发生在主线程上，出于性能原因，这可能并不理想。（特别是如果您可能要删除大量数据；在我们的应用程序中删除的主要成本始终发生在最终保存到磁盘期间。）

当控制器出现/消失可能导致核心数据问题时，您正在运行什么代码？你看到什么样的堆栈跟踪崩溃了？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T20:51:01.120

Just an architectural idea:

With your stated data refresh pattern (once a day, FULL cycle of data deleted and added), I would actually be motivated to create a new persistent store each day (i.e. named for the calendar date), and then in the completion notification, have the table view setup a new fetchedresultscontroller associated with the new store (and likely a new MOC), and refresh using that. Then the app can (elsewhere, perhaps also triggered by that notification) completely destroy the "old" data store. This technique decouples the update processing from the data store that the app is currently using, and the "switch" to the new data might be considered dramatically more *atomic*, since the change happens simply be starting to point to the new data instead of hoping you aren't catching the store in an inconsistent state while new data is being written (but is not yet complete).

Obviously I have left some details out, but I tend to think that much data being changed *while being used* should be re-architected to reduce the likelihood of the kind of crash you are experiencing.

Happy to discuss further...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-05T06:17:15.277

`NSFetchedResultsController`已被证明对大量删除有点敏感，所以这是我首先开始挖掘的地方。

我最初的问题是，tableview 的重新获取和重新加载与删除操作的开始有什么关系。删除块是否有可能在`NSFetchedResultsController`仍在获取或不获取时保存子 MOC？

当您从详细视图切换到主视图然后返回详细视图时，是否有可能会有多个并发的后台任务在运行？或者您是否一次从 Web 服务中检索所有数据，而不仅仅是与特定行相关的数据？

使其更健壮的一种替代方法是使用类似于以下用途的模式`UIManagedDocument`：

实际上，不是使用父 MOC 作为主线程并发类型，而是`UIManagedDocument`将主 MOC 创建为私有队列，并使子 MOC 可供您在主线程上使用。这样做的好处是所有 I/O 在后台进行并保存到父 MOC 根本不会干扰子 MOC，直到子 MOC 明确知道它们。那是因为 save 提交从子到父的更改，而不是相反。

因此，如果您在私有的父队列上进行了删除，那根本不会出现在`NSFetchedResultsController`范围内。而且由于它是旧数据，这实际上是首选方式。

我提供的另一种选择是使用三种上下文：

**主 MOC** ( `NSPrivateQueueConcurrencyType`)

*   负责旧数据的持久化存储和删除。

**儿童 MOC A** ( `NSMainQueueConcurrencyType`)

*   负责任何与 UI 相关的和 NSFetchedResultsController

**子 MOC B** ( `NSPrivateQueueConcurrencyType`, 子 MOC A 的子)

*   负责插入新数据并在完成后将其提交给子 MOC A。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-04T21:12:00.183

我遇到的多线程核心数据的主要问题是无意中访问了线程/队列中的托管对象，而不是创建它的对象。

我发现一个很好的调试工具是添加 NSAsserts 来检查在主托管对象上下文中创建的托管对象是否仅在此处使用，而在后台上下文中创建的对象不在主上下文中使用。

这将涉及继承 NSManagedObjectContext 和 NSManagedObject：

*   将 iVar 添加到 MOC 子类并为其分配创建它的队列。
*   您的 MO 子类应该检查当前队列是否与其 MOC 的 queue 属性相同。

这只是几行代码，但从长远来看，可以防止您犯下难以追踪的错误。

# xcode - Xcode 在 Xcode iOS 中保存和加载图像

> ID：11335226
> 
> 赞同：1
> 
> 时间：2012-07-04T20:40:52.863
> 
> 标签：xcode, image, load, save

如果你真的不明白，请检查我的应用程序（快速笔记！）但它就在这里。我的应用程序是一个笔记应用程序，因此它允许用户从下面几种不同的笔记颜色和设计中进行选择。当用户选择一个时，它会将上面的注释更改为他们设置的任何内容。所以我需要一个按钮来保存他们选择的图片，当离开视图并返回时，他们可以单击加载按钮，他们选择的相同图像将出现。我正在使用 Xcode 4.3。非常感谢！

这是我的保存代码：

```
-(IBAction)save123456 {
    NSBitmapImageRep *rep;
    NSData *data;
    NSImage *noteview;

    [self lockFocus];
    rep = [[NSBitmapImageRep alloc] initWithFocusedViewRect:[self frame]];
    [self unlockFocus];

    image = [[[NSImage alloc] initWithSize:[rep size]] autorelease];
    [image addRepresentation:rep];

    data = [rep representationUsingType: NSPNGFileType properties: nil];
    //save as png but failed
    [data writeToFile: @"asd.png" atomically: NO];

    //save as pdf, succeeded but with flaw
    data = [self dataWithPDFInsideRect:[self frame]];
    [data writeToFile:@"asd.pdf" atomically:YES];
}
And my load:
-(IBAction)load123456 {
NSImage loadedImage = [[NSImage alloc] initWithContentsOfFile: NSString* filePath]
} 
```

我的存档中有很多错误代码。我的图像称为noteview。谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T23:03:42.333

尝试改用

```
 [data writeToFile: @"asd.png" atomically: NO]; 
```

一个代码行

```
 [data writeToFile: @"asd.png" atomically: YES]; 
```

一些开源示例：

[AGSimpleImageEditorView](https://github.com/arturgrigor/AGSimpleImageEditorView)

[iOS 中的图像编辑器](https://github.com/search?q=image%20editor&repo=&langOverride=&start_value=1&type=Repositories&language=Objective-C)

[与图片合作的项目](https://github.com/search?q=picture&repo=&langOverride=&start_value=1&type=Repositories&language=Objective-C)

# java - 从 java 类调用 servlet

> ID：11335227
> 
> 赞同：0
> 
> 时间：2012-07-04T20:41:15.853
> 
> 标签：java, servlets, jasper-reports, pdf-generation

我已经制作（或至少尝试制作）一个将 JasperPrint 对象转换为 PDF 并在新选项卡中打开此 PDF 的 servlet。但似乎我的代码调用程序没有调用我的 servlet，也没有抛出任何异常。

当我直接从浏览器调用 URL 时，它确实调用了 servlet，但在我的 java 类中不会发生同样的情况。

调用者代码：

```
URL url = new URL("http://localhost:8080/app/reportgenerator");
HttpURLConnection connection =  (HttpURLConnection)url.openConnection(); 

connection.setRequestMethod("POST");
connection.setDoInput(true);
connection.setDoOutput(true);
connection.setUseCaches(false);
connection.setDefaultUseCaches (false);
connection.setRequestProperty("Content-Type", "application/octet-stream");

ObjectOutputStream out = new ObjectOutputStream(connection.getOutputStream());
JasperPrint jasperPrint = new JasperPrint();
out.writeObject(jasperPrint);           
out.close(); 
```

小服务程序代码：

```
response.setContentType("application/pdf");
response.setHeader("Content-Disposition","attachment; filename=\"report.pdf\"");

JasperPrint jasperPrint = null;

try {
    ObjectInputStream resultStream = new ObjectInputStream(request.getInputStream());
    jasperPrint = (JasperPrint) resultStream.readObject();
    resultStream.close();

    JasperExportManager.exportReportToPdfStream(jasperPrint, response.getOutputStream()); 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T12:13:05.117

经过更多的研究，我找到了解决方案。这就是我解决问题的方法：[Calling a Servlet from a Java application](https://stackoverflow.com/questions/4349854/calling-a-servlet-from-a-java-application)

# jquery - JQuery 重新绑定事件

> ID：11335229
> 
> 赞同：2
> 
> 时间：2012-07-04T20:41:43.103
> 
> 标签：jquery

如果我使用 JQuery 设置 div 标签，如下所示：

```
$('#maindiv').html(some content...); 
```

那么如果我将事件绑定到“maindiv”现在拥有的对象，如果我稍后将 html 重置为“maindiv”，如果我选择不重新绑定这些事件，这些事件是否仍然存在？我的意思是如果我在重置 html 后再次绑定这些事件，我会做双重工作吗？

希望这是有道理的。非常感谢您的任何见解。

大卫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T20:44:40.407

更新元素内容将删除内部元素的所有事件。

但是，您可以使用[事件委托](http://api.jquery.com/on/)只绑定一次事件（所谓的*委托事件方法*）：

```
$("#maindiv").on("click", "#element", function() {
    // do something
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T20:44:03.053

如果您使用 html 函数生成一些 html 并且仅使用 bind，那么在 bind 之后添加的任何未来元素都不会触发任何事件。

如果您打算在初始内容应用了事件后添加元素，则最简单的排序方法是使用[live而不是 bind。](http://api.jquery.com/live/)

# android - Android布局和缩放ImageView问题

> ID：11335231
> 
> 赞同：0
> 
> 时间：2012-07-04T20:41:51.843
> 
> 标签：android, layout, imageview, scaling

我正在努力实现一些我认为很容易但已经研究过负载并且仍在苦苦挣扎的事情。

我正在设置一个 ImageView 作为背景，其中部分图像是按钮应该位于顶部的区域。例如背景看起来有点像这样：

![背景](../Images/6ef9f9fdb7f555059a43c1b8dd7ac66b.png)

这设置为 fitCenter 以便它在所有屏幕类型上以正确的纵横比进行缩放，如下所示：

![背景调整大小](../Images/f017e0acdfbfc12760424cc23fa48d03.png)

现在我正在尝试将 ImageButtons 放置在白色区域上，如下所示：

![白色区域上的按钮](../Images/62f30e2291937109db3270bfdca4c0f8.png)

我正在尝试通过将每个 Imagebutton 对齐到背景 imageView 的左上角，然后设置边距以将其设置在正确的位置。这适用于某些屏幕类型，但是当背景因设备小于背景图像而被调整大小时，例如我发现顶部的按钮不会随之调整大小，所以我得到如下效果：

![在此处输入图像描述](../Images/71f0ea8759cf0d8e0465ad3a1c450d1a.png)

这是我正在尝试的布局类型（这里只有一个按钮）：

```
<RelativeLayout android:layout_height="match_parent" android:layout_width="match_parent" xmlns:android="http://schemas.android.com/apk/res/android" android:id="@+id/outer" xmlns:tools="http://schemas.android.com/tools">
<ImageView android:layout_height="wrap_content" android:layout_width="wrap_content" android:id="@+id/imageView1" android:src="@drawable/no_pills_pane" android:scaleType="fitCenter" android:adjustViewBounds="true" android:layout_centerVertical="true" android:layout_centerHorizontal="true"/> 
<ImageButton android:layout_height="wrap_content" android:layout_width="wrap_content" android:id="@+id/imageButton1" android:src="@drawable/pill_pink" android:scaleType="fitXY" android:background="@null" android:layout_marginTop="50dp" android:layout_marginLeft="44dp" android:layout_alignTop="@id/imageView1" android:layout_alignLeft="@id/imageView1"/>
</RelativeLayout> 
```

我确信必须有一个更简单的方法来解决这个问题，任何帮助将不胜感激。

谢谢西蒙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T22:53:57.060

如果您只需要在 ImageView 中将 ImageButton 居中，只需将 alignBottom、alignLeft、alignRight、alignTop 设置为 ImageView

```
android:layout_alignBottom="@+id/imageView1"
android:layout_alignLeft="@+id/imageView1"
android:layout_alignRight="@+id/imageView1"
android:layout_alignTop="@+id/imageView1" 
```

# c# - 非静态字段、方法或属性 'WindowsApplication1.Form1.TextboxText() 需要对象引用。与标签相同

> ID：11335234
> 
> 赞同：4
> 
> 时间：2012-07-04T20:41:57.330
> 
> 标签：c#, static-methods

> **可能重复：**
> [非静态字段、方法或属性“WindowsApplication1.Form1.setTextboxText(int)”需要对象引用](https://stackoverflow.com/questions/498400/an-object-reference-is-required-for-the-nonstatic-field-method-or-property-wi)

我正在创建一个 IP 跟踪器，它将连接到网络并从文本框中输入值（IP）并接收结果。这是代码。

```
 using System;
    using System.Collections.Generic;
    using System.ComponentModel;
    using System.Data;
    using System.Drawing;
    using System.Linq;
    using System.Text;
    using System.Windows.Forms;
    using System.Xml;

    namespace geoIP
    {
        public partial class Form1 : Form
        {
            public Form1()
            {
                InitializeComponent();
            }

            private void button1_Click(object sender, EventArgs e)
            {
                iptrace();
            }

             public static string iptrace()
            {
                XmlDocument xmldoc = new XmlDocument();
                XmlNodeList xmlnode;
                int i;

                xmldoc.Load("http://freegeoip.net/xml/" + textBox1.Text);
                xmlnode = xmldoc.GetElementsByTagName("response");
                for (i = 0; i < xmlnode.Count; i++)
                {
                    xmlnode[i].ChildNodes.Item(0).InnerText.Trim();
                    label1.Text = "Ip Address: " + xmlnode[i].ChildNodes.Item(0).InnerText.Trim();
                    label2.Text = "Country Code: " + xmlnode[i].ChildNodes.Item(1).InnerText.Trim();
                    label3.Text = "Country Name: " + xmlnode[i].ChildNodes.Item(2).InnerText.Trim();
                    label4.Text = "Region Code: " + xmlnode[i].ChildNodes.Item(3).InnerText.Trim();
                    label5.Text = "Region Name: " + xmlnode[i].ChildNodes.Item(4).InnerText.Trim();
                    label6.Text = "City: " + xmlnode[i].ChildNodes.Item(5).InnerText.Trim();
                    label7.Text = "Zip Code: " + xmlnode[i].ChildNodes.Item(6).InnerText.Trim();
                    label8.Text = "Latitude: " + xmlnode[i].ChildNodes.Item(7).InnerText.Trim();
                    label9.Text = "Longitude: " + xmlnode[i].ChildNodes.Item(8).InnerText.Trim();
                    label10.Text = "Metro Code: " + xmlnode[i].ChildNodes.Item(9).InnerText.Trim();
                }

            }

 }
}` 
```

它给了我错误

非静态字段、方法或属性“geoIP.Form1.textBox1”需要对象引用

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T20:43:33.983

您的`textBox1`控件被声明为类的*成员*，但在`static`函数内部使用。这是一个问题。

要解决此问题，您需要声明方法*non* `static`

```
public string iptrace()
{
   ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T20:43:29.840

`static`从`iptrace()`方法声明中删除。

`textBox1`您正在尝试从静态方法访问非静态（实例）成员。

**编辑：**

此外，将方法声明更改为`public void iptrace()`. 由于您没有`return <some string value>;`语句（并且在您的情况下不需要任何语句），C# 编译器将反对。通过具有[`void`](http://msdn.microsoft.com/en-us/library/yah0tteb%28v=vs.100%29.aspx)返回类型，您声明该方法不返回任何值。

**编辑2：**

您还应该将方法访问更改为`private void iptrace()`. 没必要公开。

最后，检查[.NET Guidelines for Names](http://msdn.microsoft.com/en-us/library/ms229002.aspx)。例如，方法和命名空间应该是[Pascal Cased](http://msdn.microsoft.com/en-us/library/ms229043.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T20:43:33.917

改变`textBox1.Text`为`Form1.ActiveForm.textBox1.Text`

# sip - 如何使用用户名和密码登录 SIP SERVER

> ID：11335235
> 
> 赞同：0
> 
> 时间：2012-07-04T20:42:10.127
> 
> 标签：sip, voip

我是为 .NET 开发并尝试在没有任何 SDK 的 Visual Studio 2010 中开发基本 SIP 客户端（软电话）的新手。

软件电话将按以下步骤工作。

1.  用户将使用该软件电话（SIP 客户端）登录我的网站
2.  登录后，Softphone 将显示用户当前余额和通话记录等。此余额和通话记录在我的终端/服务器/网站上。
3.  比用户拨打一个号码。
4.  我的软电话 SIP 客户端将通过我的用户名和密码登录到我的 sip 提供商服务器并拨打电话。

我已经成功开发了步骤 1-3。现在我无法登录到我的 sip 服务器，因为我不知道在哪里通过登录请求并建立呼叫。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-09-03T04:06:20.740

您可以下载并编译 pjsip，然后从您的 c# 代码中调用 dll。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-03T04:26:49.430

您需要阅读[SIP RFC](https://www.rfc-editor.org/rfc/rfc3261)和[RTP RFC](https://www.rfc-editor.org/rfc/rfc3550)以及可能的[G711 有效负载](https://www.rfc-editor.org/rfc/rfc5391)和其他一堆并实施它们......或者使用 SDK，因为这是一个至少需要几个月全职工作的项目。

# jquery - 如何在此 rails 文件中集成 jQuery Scrollbar UI 元素

> ID：11335239
> 
> 赞同：0
> 
> 时间：2012-07-04T20:42:45.373
> 
> 标签：jquery, html, css, ruby-on-rails, jquery-ui

我有这个文件：geoView.html.erb

```
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<%= stylesheet_link_tag 'application' %>
<%= javascript_include_tag  'application'%>
<body onload="initialize()">

 <div id="top_vendors"></div>
<div id="left_control_panel">
 <input type="button" onclick="getlistings();" value="Add Markers">
 <input type="button" onclick="clearMarkers();" value="Remove Markers">
</div>

<div id="mid_wrapper">
  <div id="map_canvas"></div>
  <div id="right_control_panel">
   <input type="button" onclick="getlistings();" value="Add Markers">
   <input type="button" onclick="clearMarkers();" value="Remove Markers">
  </div>
  </div>
</div>

</body>
<script type="text/javascript"
src="http://maps.googleapis.com/maps/api/js?key=XXsensor=false"></script> 
```

我的问题是我想将 jQuery Cupertino 主题库中的水平滚动条小部件添加到此处的 div“top_vendors”。

我将[本](http://www.railsdeveloper.net/2010/06/rails-and-jquery-how-to-integrate-jquery-ui-into-your-rails-app/)教程视为指南，但是我没有成功

到目前为止，我已经完成了以下步骤：1) 将 jQuery 缩小库复制到我的 Assets/javascripts 文件夹中 2) 也将 jqueryUI 库复制到那里 3) 将 Cupertino 主题图像复制到样式表/图像中 4) 复制 jquery-ui-。 .custom.css 文件到 stylsheets 文件夹 5) 这是我的 application.js 文件的头标签

```
<!DOCTYPE html>
<html>
<head>
<title>App0521</title>
<!--[if lt IE 9]>
<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"  type="text/javascript"></script>
<![endif]-->
<%= stylesheet_link_tag   'jquery-ui-1.8.21.custom.css', "application", :media =>  "all" %>
<%= javascript_include_tag 'jquery-1.4.2.min.js ', 'jquery-ui-1.8.2.custom.min.js',"application" %>
<%= csrf_meta_tags %>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head> 
```

我仍然没有在浏览器中看到任何滚动条。

我错过了什么？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T22:21:19.280

您不需要在 application.html.erb 中包含所有`CSS`s 和`JS`s。您可以配置 Rails 为您包含它。

`application.html.erb:`

```
<%= stylesheet_link_tag    "application", :media => :all %>
<%= javascript_include_tag "application" %> 
```

将文件保存在`js`文件`assets/javascript`夹中并将它们包含在`application.js`

应用程序.js

```
//= require jquery
//= require jquery_ujs
//= require jquery-ui      #here you are including the jQUERY-UI
//= require_tree . 
```

同样在你的`application.js`你需要以一种[不显眼的方式](http://en.wikipedia.org/wiki/Unobtrusive_JavaScript)创建函数（我认为你缺少它）。

如果您想调用您 ID中的[幻灯片](http://jqueryui.com/demos/slider/)`#top_vendors`，例如：

```
$(function() {
    $( "#top_vendors" ).slider();
}); 
```

[任何其他jQuery-UI 插件](http://jqueryui.com/demos/)也可以这样做。

我希望它有帮助...

# javascript - 来自 http://dondedeportes.es/uploader-previewer/ 的图像上传器：更改输入以接受多个请求

> ID：11335240
> 
> 赞同：3
> 
> 时间：2012-07-04T20:42:48.477
> 
> 标签：javascript, jquery

我正在使用标题中[SITE的图像上传器。](http://dondedeportes.es/uploader-previewer/)此图像上传器生成多个表单，其中包含用于输入的各自 iframe。

我正在尝试消除这种单独的输入，并且只有一个输入需要多次上传（至少最多 4 个）。我与作者交谈，只收到修改 uploaderPreviewer.js 的答案，我得到了我想要完成的事情。

如何修改 js 文件以使其生成一个需要上传多个文件（至少最多 4 个）的输入？

如果您想全面了解 js 文件：[这里](http://webprolearner2346.zxq.net/imageupload/js/uploaderPreviewer.js)

**构造形式**

```
jQuery.uploaderPreviewer = new Object({
    formsCount: 1, // number of image forms to handle
    allowedImageTypes: new Array('png', 'jpg', 'jpeg', 'gif'),
    uploadImageAjaxUrl: 'php/uploadImage.php',
    removeImageAjaxUrl: 'php/removeImage.php',
    uploadsThumbDir: 'uploads/thumb/',
    messages: {
        imageLabel: 'Image',
        fileTypeError: 'The file is not an allowed type.',
        removeButtonCaption: 'remove',
        removeButtonTitle: 'Remove the image'
    }
}); 
```

**公共功能**

```
jQuery.uploaderPreviewer.createImageForms = function(options) {

    $.extend(this, options);

    var forms = '';

    for(var i=1; i <= this.formsCount; i++) {
        forms += createImageForm(i);
    }    
    return configureImageForms($(forms));
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T09:30:11.060

[从http://jquery.malsup.com/form](http://jquery.malsup.com/form)插件尝试 ajaxSubmit 功能。我已经尝试过了，它在我测试过的每个浏览器中都可以正常工作（Ie7）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T05:55:59.743

如果您不介意使用另一个脚本，我建议您使用这个。一直在其他项目中使用它，唯一的缺点是与以前的 IE 版本（拖放）有一些轻微的不兼容。

```
https://github.com/valums/file-uploader/ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T08:40:01.480

尝试使用 HTML5`input[multiple]`属性。

# postgresql - 如何运行一系列 SQL 查询并保存结果？

> ID：11335241
> 
> 赞同：1
> 
> 时间：2012-07-04T20:42:50.193
> 
> 标签：postgresql, navicat, psql

在其他统计程序中，可以创建一个日志文件来显示作为命令的结果发出的输出。是否可以在 SQL 中做类似的事情？

特别是，我希望有一个包含许多查询的单个 .sql 文件，然后将每个结果输出到一个文本文件。

我正在使用 PostgreSQL 和 Navicat。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T21:40:34.653

Don't know about navicat, but you can do it with [psql](http://www.postgresql.org/docs/9.1/static/app-psql.html). Check the various `--echo-X` command-line options and the `\o` command if you just want temporary output to a file.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T22:45:33.557

### plpgsql 函数和 COPY

一种方法是将 SQL 脚本放入[plpgsql 函数](http://www.postgresql.org/docs/current/interactive/plpgsql-overview.html#PLPGSQL-ADVANTAGES)中，您可以在其中将各个返回值写入文件，[`COPY`](http://www.postgresql.org/docs/current/interactive/sql-copy.html)并根据需要从中间结果编译报告。

这具有可能或可能不希望的附加效果。就像，您可以授予或撤销对任意角色的整个函数的权限。[`SECURITY DEFINER`](http://www.postgresql.org/docs/current/interactive/sql-createfunction.html#SQL-CREATEFUNCTION-SECURITY)在手册中阅读。当您保存函数时，语法将被验证 - 但是，只是表面上的（有计划在未来改变它）。此答案中的更多详细信息[dba.SE](https://dba.stackexchange.com/questions/8119/postgresql-stored-procedure-performance/8189#8189)。

基本示例：

```
CREATE OR REPLACE FUNCTION func()
  RETURNS void AS
$BODY$
BEGIN

COPY (SELECT * FROM tbl WHERE foo) TO '/path/to/my/file/tbl.csv';

COPY (SELECT * FROM tbl2 WHERE NOT bar) TO '/path/to/my/file/tbl2.csv';

END;
$BODY$
  LANGUAGE plpgsql; 
```

当然，您需要在数据库和文件系统中拥有必要的权限。
从外壳调用它：

```
psql mydb -c 'SELECT func();' 
```

* * *

### psql 在元命令和 SQL 之间切换

```
#!/bin/sh

BASEDIR='/var/lib/postgresql/outfiles/'

echo "
\\o $OUTDIR/file1.txt  \\\\\\\\ SELECT * FROM tbl1;
\\o $OUTDIR/file2.txt  \\\\\\\\ SELECT * FROM tbl2;
\\o $OUTDIR/file3.txt  \\\\\\\\ SELECT * FROM tbl3;" | psql event -p 5432 -t -A 
```

没错，8个反斜杠。双反斜杠的结果会被解释两次，因此您必须将它们加倍。

我引用了有关元命令 [的手册](http://www.postgresql.org/docs/current/interactive/app-psql.html)`\o`：

> 将未来的查询结果保存到文件 filename 或 ...

和`\\`：

> command 必须是服务器完全可解析的命令字符串（即，它不包含特定于 psql 的功能），或者是单个反斜杠命令。因此，您不能将 SQL 和 psql 元命令与此选项混合使用。为此，您可以将字符串通过管道传输到 psql，如下所示： echo '\x \\ SELECT * FROM foo;' | psql。（\\ 是分隔符元命令。）

# jquery - 初始动画功能不工作，但当用户点击后工作

> ID：11335243
> 
> 赞同：1
> 
> 时间：2012-07-04T20:42:54.590
> 
> 标签：jquery, fade

我刚刚学会了如何使用 jquery，所以请耐心等待。

[http://jsfiddle.net/mariabarrette/KqjD3/20/](http://jsfiddle.net/mariabarrette/KqjD3/20/)

有我正在开发的网站。除了最初的动画功能外，我对一切都很满意。我的意思是当用户在访问网站时第一次点击“关于”或“恢复”或“联系”时，内容不会淡入。用户查看了一个部分并从即将联系到resume，没有问题，内容适当淡入淡出。这只是第一次内容不会淡入。

感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T20:56:32.530

设置隐藏

```
.hidden {opacity:0; height:0 } 
```

[http://jsfiddle.net/KqjD3/22/](http://jsfiddle.net/KqjD3/22/)

它以前不起作用，因为您没有显示，所以它没有不透明度来制作动画。

还

```
<div id="contactcontent" class="hidden" class="opacity0"> 
```

可以改为

```
<div id="contactcontent" class="opacity0"> 
```

这将在不改变隐藏的情况下解决你的问题，你可以做更多的优化，但我会留给你

# javascript - html5画布对象碰撞和物理

> ID：11335255
> 
> 赞同：0
> 
> 时间：2012-07-04T20:43:36.887
> 
> 标签：javascript, html, html5-canvas, game-physics, collision

我正在开发一个简单的 html5 平台游戏，构建以前的游戏，但遇到碰撞和物理问题。下面是关于地板及其如何处理碰撞的代码示例。完整的代码在这里。 [http://www.ambitiongames.co.uk/dev/game.php](http://www.ambitiongames.co.uk/dev/game.php)游戏在这里[http://www.ambitiongames.co.uk/dev/](http://www.ambitiongames.co.uk/dev/)

我遇到的问题是碰撞是基于事件抓取，有时会让玩家在地板上而不是在地板上。

此外，由于跳跃和下降的工作方式没有重力，这意味着玩家可以简单地跳到更高的壁架上然后走到空中。

建立永久重力状态的好方法是什么？

什么是与地板或其他物体交互/碰撞的好方法？

```
 that.draw = function(){  
            try {  
                ctx.drawImage(that.image, that.x, that.y, that.width, that.height);  
                } catch (e) {  
                }  
        } 
        return that;  
    };

    var nrOffloors = 40,   
        floors = [],  
        floorWidth = 20,  
        floorHeight = 40;  
        var generatefloor = function(){  

            for (var i = 0; i < 10; i++) {  
                floors[i] = new Floor(i * 20,280);   
            } 
            for (var i = 10; i < 12; i++) {  
                floors[i] = new Floor(i * 20,260);   
            } 
        }();

    var checkCollisionfloor = function(){  
        floors.forEach(function(e, ind){  
            if (   
                (player.X < e.x + floorWidth) &&   
                (player.X + player.width > e.x) &&   
                (player.Y + player.height > e.y) &&   
                (player.Y + player.height < e.y + floorHeight)  

                ) {  
                    e.onCollide();  
                } 
        });     
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T02:28:54.570

您可以尝试像[Box2D.js](http://box2d-js.sourceforge.net/)这样的库。它处理从碰撞检测到重力的所有事情。

看看它的演示。

# android - 如何使android的滑动抽屉在前台可见？

> ID：11335258
> 
> 赞同：0
> 
> 时间：2012-07-04T20:43:52.763
> 
> 标签：android, android-layout, slidingdrawer

当我将滑动抽屉小部件添加到我的布局时，我遇到了障碍。我添加了它，一切正常。问题是当我有一个填充高度的布局时，滑动抽屉的手柄不再可见。有没有办法通过将手柄放在前台或其他方式来实现这一点，从而使手柄可见？

我正在玩的示例来自：

[https://mobibear.wordpress.com/2010/07/12/android-slidingdrawer-with-custom-view/](https://mobibear.wordpress.com/2010/07/12/android-slidingdrawer-with-custom-view/)

我从上面的站点编辑的只是下面的 .xml 文件。提前谢谢你，我会一直待着的......

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/linear"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical">

    <TextView
        android:id="@+id/textView1"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:text="Blah Blah Title"
        android:gravity="center"
        android:textSize="38dp"/>

    <FrameLayout
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" >

    </FrameLayout>

    <SlidingDrawer xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/drawer"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:handle="@+id/handle"
        android:content="@+id/content">

        <bear.exmaple.CustomView
            android:id="@+id/content"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent">
        </bear.exmaple.CustomView>

        <ImageView android:id="@id/handle"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:src="@drawable/tray_handle_normal" />

    </SlidingDrawer>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T21:39:55.153

我最终找到了这个问题的答案，它就像在相对布局中添加所有视图/布局并确保滑动抽屉是最终添加一样简单。这是答案所在的链接：

[相同布局的滑动抽屉](https://stackoverflow.com/questions/4166197/sliding-drawer-in-the-same-layout)

# html - $_POST 被点击的 div 的名称

> ID：11335260
> 
> 赞同：0
> 
> 时间：2012-07-04T20:43:59.203
> 
> 标签：html, post, get

我将如何发布被点击的 div 的 id？目标是让用户单击几个方块中的一个并在 url 中发布该方块的名称，然后使用该新 url 重新加载页面。有什么建议么？

我尝试使用：

```
 <div id="boxone1" onclick="window.location='index.php?name=<? print $_POST['id'] ?  >';" style="cursor:pointer;">
 </div> 
```

但这无济于事，不会重新加载我的页面

目标是让用户能够按特定顺序单击 div，并使该顺序与预定顺序相匹配。但是为了让它更复杂，每次页面重新加载时，每个 div 都会被赋予一种随机颜色（大约 10 种颜色中的一种）。因此，div 的颜色需要与预定密码匹配。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T21:03:25.323

我不是诸如 onclick 事件之类的内联 javascript 的忠实粉丝，但请参阅下面的可能答案（如果动态生成这些 div）：

```
<div id="boxone1" onclick="window.location='?name='+this.id" style=""> 
```

否则你总是可以这样做：

```
<div id="boxone1" onclick="window.location='?name=boxone1'" style=""> 
```

# java - 在 Android 项目中包含另一个项目

> ID：11335264
> 
> 赞同：0
> 
> 时间：2012-07-04T20:44:26.677
> 
> 标签：java, android

我刚刚开始了漫长的 Android 编程和构建应用程序，我想在其中使用这个库[https://github.com/cfgxy/DevsmartLib-Android/tree/](https://github.com/cfgxy/DevsmartLib-Android/tree/)

这是另一个 Android 项目，我应该如何使用 Eclipse 将其包含在我的项目中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T20:49:08.287

The contents of that repo's `devsmartlib/` directory appears to be an [Android library project](http://developer.android.com/tools/projects/index.html#LibraryProjects). You can use such projects [from Eclipse](http://developer.android.com/tools/projects/projects-eclipse.html#ReferencingLibraryProject) or [from the command line](http://developer.android.com/tools/projects/projects-cmdline.html#ReferencingLibraryProject) as you see fit.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T21:21:24.467

在 Eclipse 中创建一个新的 Android 项目并选择`devsmartlib/`作为源文件夹的内容。

然后，您可以右键单击您的项目，单击属性，Android 并从那里添加库项目！

# actionscript-3 - as3中的深度管理

> ID：11335265
> 
> 赞同：0
> 
> 时间：2012-07-04T20:44:39.797
> 
> 标签：actionscript-3

我有许多扑克牌精灵。他们在一个列表中，上面是一张父卡片，后面是一个孩子，那个孩子是另一个孩子的父母。

例如，当我单击堆中的第 4 个时，我希望它及其所有子项都位于顶部。我怎样才能做到这一点？

```
currentCard.parent.setChildIndex(currentCard, numChildren-1); 
```

currentCard 是用户点击的卡片。

以上出现错误，提供的索引超出范围。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T20:58:00.243

尝试：

```
currentCard.parent.setChildIndex(currentCard, currentCard.parent.numChildren-1); 
```

`numChildren`否则会提到`this`。我不确定`this`这里会出现什么，因为您只有那行代码，但如果不是，`currentCard.parent`那么`numChildren`很容易成为比有多少孩子更多的孩子`currentCard.parent`，从而导致超出范围的错误。例如，如果`this`有 17 个孩子并且`currentCard.parent`有 5 个，那么这行代码意味着您将尝试访问显然超出范围的索引 16。

# php - 一个简单的形式：Php & Html

> ID：11335267
> 
> 赞同：0
> 
> 时间：2012-07-04T20:44:55.647
> 
> 标签：php, html, forms

我用 HTML 编写了一个简单的表单，提交用户名和年龄，然后打开一个`.php`页面并打印它们。

这是代码：

**main.html**

```
<form action="Test.php" method="post">
    Name: <input type="text" name="fname" />
    Age: <input type="text" name="age" />
    <input type="submit" />
</form> 
```

**测试.php**

```
Welcome <?php echo $_POST["fname"]; ?>!<br />
You are <?php echo $_POST["age"]; ?> years old. 
```

Тhe 的问题是，当我打开`main.html`，输入一些值并按`Submit`，它不显示`Test.php`页面，而是下载它。

有什么建议吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T21:04:29.873

检查您的服务器是否正在运行。检查您的请求页面是否正确（http://localhost/main.html 或通过您的虚拟主机）

XAMPP 应该正确配置服务器。php 在 httpd.conf 中工作的最常见的事情是：

```
LoadModule php5_module modules/libphp5.so # or necessary .dll for windows
AddType application/x-httpd-php .php 
```

重新启动 apache 并重试。尝试直接请求 Test.php，如果一切正常，您应该会看到一些警告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T20:57:11.557

重新启动 Apache 或任何您的网络服务器。

`sudo service apache2 restart`在 Ubuntu 中，或使用 XAMPP 控制面板。

然后再试一次。

# c# - 带有自定义 uri-namespace 的 XML 命名空间中不存在标记

> ID：11335271
> 
> 赞同：2
> 
> 时间：2012-07-04T20:45:27.067
> 
> 标签：c#, wpf, xml-namespaces

我刚刚使用以下教程编辑了我的自定义控件以提供 uri 命名空间：http: [//blogs.msdn.com/b/knom/archive/2007/11/02/wpf-tired-of-xmlns- clr-命名空间.aspx](http://blogs.msdn.com/b/knom/archive/2007/11/02/wpf-tired-of-xmlns-clr-namespace.aspx)

```
[assembly: XmlnsDefinition("http://schemas.mycompany.de/wpf/CustomControls", "MyCompany.MyApp.CustomControls")]
namespace MyCompany.MyApp.CustomControls
{
 // CODE HERE
} 
```

并像这样使用它：

`<my:ProgressIndicator Grid.Row="2" Height="6" ProgressColor="#23A4D3" />`

现在它说

`The tag 'ProgressIndicator' does not exist in XML namespace 'http://schemas.mycompany.de/wpf/CustomControls'. Line 111 Position 18.`

为什么会这样？我错过了什么？

# c# - TreeNode 关键问题

> ID：11335273
> 
> 赞同：2
> 
> 时间：2012-07-04T20:45:54.513
> 
> 标签：c#, winforms

我在 WinForm 中使用 TreeView 控件。

我正在尝试使用以下代码，但得到“NullReferenceException”。我遵循提供的语法，即`tree.Nodes[key].Nodes.Add(key,text)`

我不知道代码有什么问题。

请看一下我使用的代码 -

```
tvTree.Nodes.Add("Subjects", "Subjects");
tvTree.Nodes["Subjects"].Nodes.Add("Physics", "Physics");

tvTree.Nodes["Physics"].Nodes.Add("PhysicsP1", "Paper1");
tvTree.Nodes["Physics"].Nodes.Add("PhysicsP2", "Paper2");
tvTree.Nodes["Physics"].Nodes.Add("PhysicsP3", "Paper3"); 
```

感谢您分享您的时间。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-04T20:54:11.150

您的问题是“物理”节点不是“主题”节点的直接子节点，`tvTree`而是“主题”节点的子节点。应该使这更容易的是[TreeNodeCollection.Add](http://msdn.microsoft.com/en-us/library/esz34cwb.aspx)返回一个 TreeNode ，您可以稍后引用它。

```
var subjects = tvTree.Nodes.Add("Subjects", "Subjects");
var physics = subjects.Nodes.Add("Physics", "Physics");

physics.Nodes.Add("PhysicsP1", "Paper1");
physics.Nodes.Add("PhysicsP2", "Paper2");
physics.Nodes.Add("PhysicsP3", "Paper3"); 
```

如果您只有名称，则可以使用[Find](http://msdn.microsoft.com/en-us/library/system.windows.forms.treenodecollection.find.aspx)：

```
var parentName = "from wherever";

var parentNodes = tvTree.Nodes.Find(parentName, true);

/* handle multiple results */
/* add children */ 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-04T20:58:13.163

你也可以用

```
 tvTree.Nodes.Add("Subjects", "Subjects");
        tvTree.Nodes["Subjects"].Nodes.Add("Physics", "Physics");

        var phyNode = tvTree.Nodes.Find("Physics", true).First();

        phyNode.Nodes.Add("PhysicsP1", "Paper1");
        phyNode.Nodes.Add("PhysicsP2", "Paper2");
        phyNode.Nodes.Add("PhysicsP3", "Paper3"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-14T13:44:02.013

你可以用这个

```
tvTree.Nodes["Subjects"].Nodes["Physics"].Add("PhysicsP1", "Paper1"); 
```

# amazon-web-services - Amazon Elastic Load Balancing - 自动扩展？

> ID：11335274
> 
> 赞同：3
> 
> 时间：2012-07-04T20:46:11.013
> 
> 标签：amazon-web-services, amazon-elb, autoscaling

你好。Amazon Elastic Load Balancing 是否包含 Auto Scaling？

即：当流量从高位下降到低位时，是否会缩减？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-04T23:51:04.543

是的，它确实。
根据[ELB产品描述](http://aws.amazon.com/elasticloadbalancing/)，

> Elastic Load Balancing 会自动扩展其请求处理能力以响应传入的应用程序流量。
> 
> **使用 Elastic Load Balancing 进行 Auto Scaling**
> 
> 假设您要确保 Elastic Load Balancer 后面的健康 Amazon EC2 实例的数量永远不会少于两个。您可以使用 Auto Scaling 设置这些条件，当 Auto Scaling 检测到满足某个条件时，它会自动将所需数量的 Amazon EC2 实例添加到您的 Auto Scaling 组中。或者，如果您想确保在任何一个 Amazon EC2 实例的延迟在任何 15 分钟内超过 4 秒时添加 Amazon EC2 实例，您可以设置该条件，Auto Scaling 将在您的 Amazon EC2 实例 — 即使在 Elastic Load Balancer 后面运行。无论您是否使用 Elastic Load Balancing，Auto Scaling 都同样适用于扩展 Amazon EC2 实例。

根据[Auto Scaling 功能描述](http://aws.amazon.com/autoscaling/)：

> Auto Scaling 允许您根据您定义的条件自动扩展或缩减 Amazon EC2 容量。借助 Auto Scaling，您可以确保您使用的 Amazon EC2 实例的数量在需求高峰期间无缝增加以保持性能，并在需求低迷期间自动减少以最大限度地降低成本。Auto Scaling 特别适用于每小时、每天或每周的使用量变化的应用程序。
> 
> **自动缩放功能**
> 
> 当需求增加时，无缝自动扩展 Amazon EC2 实例。 **自动卸载不需要的 Amazon EC2 实例，并在需求减弱时节省资金。** 根据您的 Amazon CloudWatch 指标动态扩展，或根据您定义的计划进行可预测的扩展。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-29T12:35:06.677

是的，您可以将 Amazon Auto Scaling 与 Amazon Elastic Load Balancing 连接起来。如果负载增加，Amazon Auto Scaling 可以启动新的 EC2，它将无缝连接到 Amazon ELB。如果流量减少，Auto Scaling 将终止将从 ELB 注销的 EC2 实例。此方案适用于 Amazon Classic 云和 Amazon VPC。

# iphone - 通过 GameCenter ID 在应用程序/推送消息中的 iOS

> ID：11335276
> 
> 赞同：1
> 
> 时间：2012-07-04T20:46:14.430
> 
> 标签：iphone, ios, ipad, game-center

我可以向达到特定成就或处于 GameCenter 排行榜中的玩家发送应用内消息（或推送通知）吗？是否有与 GameCenter 关联的 ID 可用于在我的应用程序中联系此用户？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T22:28:34.950

Game Center 不允许您向他们发送特定消息。您必须使用推送通知并跟踪（在您的服务器端）哪些用户取得了您感兴趣的成就，以及他们的推送通知 ID 是什么。

# javascript - 如何在调用 responde.end() 后执行 NodeJS/connect 中间件？

> ID：11335278
> 
> 赞同：13
> 
> 时间：2012-07-04T20:46:20.363
> 
> 标签：javascript, node.js, architecture, connect

我想实现这样的目标：

```
var c = require('connect');
var app = c();

app.use("/api", function(req, res, next){
    console.log("request filter 1");
    next();
});

app.use("/api", function(req, res, next){
    console.log("request filter 2");
    next();
});

app.use("/api", function(req, res, next){
   console.log("request handler");
    res.end("hello");
    next();
});

app.use("/api", function(req, res, next){
    console.log("response post processor");
    next();
});
app.listen(3000); 
```

当我为地址卷曲时，控制台出现异常，抱怨标头在发送后无法被打扰，这很公平。只是我不碰响应对象。

```
/usr/bin/node app2.js
request filter 1
request filter 2
request handler
Error: Can't set headers after they are sent.
    at ServerResponse.OutgoingMessage.setHeader (http.js:644:11)
    at ServerResponse.res.setHeader (/home/zpace/node_modules/connect/lib/patch.js:59:22)
    at next (/home/zpace/node_modules/connect/lib/proto.js:153:13)
    at Object.handle (/home/zpace/WebstormProjects/untitled1/app2.js:25:5)
    at next (/home/zpace/node_modules/connect/lib/proto.js:190:15)
    at Object.handle (/home/zpace/WebstormProjects/untitled1/app2.js:19:5)
    at next (/home/zpace/node_modules/connect/lib/proto.js:190:15)
    at Object.handle (/home/zpace/WebstormProjects/untitled1/app2.js:14:5)
    at next (/home/zpace/node_modules/connect/lib/proto.js:190:15)
    at Function.app.handle (/home/zpace/node_modules/connect/lib/proto.js:198:3) 
```

调试 NodeJS/Connect 层我进入了一个以某种方式暗示如果标头已经发送，则执行路由处理程序必须初始化响应标头的部分。

问题是上述行为是否是故意的（即在路由处理程序完成发送响应后执行任何代码是完全无法想象的，或者这只是连接中的错误？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2014-02-18T15:30:15.637

不确定您是否找到了解决方案。

如果你想为请求周期设计一个后处理器，你可以使用一个中间件来监听响应对象上的“完成”事件。像这样：

```
app.use(function(req, res, next){
  res.on('finish', function(){
    console.log("Finished " + res.headersSent); // for example
    console.log("Finished " + res.statusCode);  // for example
    // Do whatever you want
  });
  next();
}); 
```

附加到“完成”事件的函数将在响应写出后执行（这意味着 NodeJS 已将响应头和响应体交给操作系统进行网络传输）。

我想这一定是你想要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T23:49:33.183

我认为这是一个糟糕的规划问题。你应该以更好的方式解决这个问题。我不知道为什么你有一个请求处理程序和一个请求后处理器分开，但让我们看看我们能做什么。

所以是的，响应结束后，您无法再次阅读标题。

所以在调用后处理器之前不要完成响应。

```
var isEnd;

app.use("/*", function(req, res, next){
  isEnd = false;
})

app.use("/api", function(req, res, next){
   console.log("request handler");
    res.write("hello");
    isEnd = true;
    next();
});

app.use("/api", function(req, res, next){
    console.log("response post processor");
    if(isEnd) {
        res.end();
    }
    else next();
}); 
```

这是一种解决方案，但这可能不是最适合您的问题。

`next()`在我看来，在响应完成后打电话真的很糟糕。如果您需要后处理器，为什么要在请求过滤器中这样做（或者这是什么）。调用函数但不调用`next()`

也许是这样：

```
app.use("/api", function(req, res, next){
   console.log("request handler");
    res.end("hello");
    setTimeout(function(){(postProcessor(req)},0);
});

function postProcessor(req) {
//doing post process stuff.
//response not needed because already ended.
} 
```

或这个：

```
app.use("/api", function(req, res, next){
   console.log("request handler");
    res.writed("hello");
    setTimeout(function(){(postProcessor(req)},0);
    // u cant res.end here because setTimeout. 
    //If you dont use setTimeout you can use res.end here, but not bot function.
});

function postProcessor(req, res) {
//doing post process stuff.
res.end();
} 
```

这`next()`不是你使用的那种用法。

我希望我的回答对您有所帮助，但我知道它并不能涵盖所有内容，但是您的回答也不是很具体。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-04T23:52:40.237

尝试用早晨的咖啡锻炼身体，这是一个多么好的问题啊！

因此`proto.js`，如果您仔细查看第 102 行，`app.handle`它是中间件堆栈的处理程序代码，您将看到 next() 是如何运行的。

在调用函数 next() 的地方，您可以看到它检查 res.headerSent 是否为真，如果是则抛出错误。

如果将第 14 行修改为：

```
app.use("/api", function(req, res, next){
   console.log("request handler");
    res.end("hello");
    console.log(res);
    next();
}); 
```

您将看到它实际上将“headersSent”设置为true。因此，在我们结束请求后，您可以从 next() 代码中看到，由于所讨论的条件，它会引发错误。

# function - UNIX 功能 - cd .. 然后移动工作目录

> ID：11335279
> 
> 赞同：0
> 
> 时间：2012-07-04T20:46:22.483
> 
> 标签：function, unix

我正在尝试制作一个简单地从工作文件夹中 cd 出来的函数，然后将该文件夹移动到其他地方。但是，在尝试此操作时，我得到一个无法移动的错误，大概是因为该文件夹正在使用中，因为那是我启动该功能的地方。

例如

```
test() {
    cpath=$(pwd)
    cd ..
    mv $cpath $cpath"old"
    cd $cpath"old"
} 
```

这甚至可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T20:51:14.273

The problem is that you're changing the directory **in a different process**. From your script you cannot touch the environment of the parent, unless you `source` it.

# javascript - 在 Raphaël.js 中停止动画并重置元素的位置

> ID：11335281
> 
> 赞同：2
> 
> 时间：2012-07-04T20:46:46.740
> 
> 标签：javascript, html, raphael

我有这个从一边移动到另一边的简单动画，我试图创建一个重置按钮，以便动画停止并恢复默认值，但我似乎无法正确。

我正在使用的库是 Raphael，但我几乎可以肯定，使用简单的 javascript，我可以重置函数内部的值。

正文 onload 初始化函数

```
function init() {
  paper = Raphael("loadSVG");

  var bg = paper.rect( 0, 0, "240px", "90px", 0 );
  bg.attr( {fill: "#f3f3ff"} );
  rect1 = paper.rect(150, 20, 50, 50);
  rect1.attr( {fill: "#ffaaaa", "stroke-width": 3} );
} 
```

动画功能

```
function moveRect1() {      
  if( xEnd == 150 )
    xEnd = 50;
  else
    xEnd = 150;

  rect1.animate( {x: xEnd}, 1000, "Sine", function (){ 
    moveRect1(); 
  }); 
} 
```

和不起作用的停止按钮:)

```
function stopsvgRect1() {
  rect1.stop();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T08:53:35.283

您需要将停止按钮绑定到您创建的函数。

例如像这样：

```
document.querySelector('#stop').onclick = function() {
    stopsvgRect1();
}; 
```

打开**[这个小提琴](http://jsfiddle.net/SF8Z3/)**来看看它的作用。

* * *

**编辑**：

由于位置也应该被重置，您可以选择[`Raphael.transform()`](http://raphaeljs.com/reference.html#Element.transform)此操作。

打开我[**更新的小提琴**](http://jsfiddle.net/SF8Z3/1/)，看看它是如何工作的。

# javascript - 通过手指滑动禁用水平滚动

> ID：11335282
> 
> 赞同：0
> 
> 时间：2012-07-04T20:46:55.367
> 
> 标签：javascript, css, horizontal-scrolling

这可能只是一个 mac 问题，但我有一个页面，其元素是页面大小的两倍，并且动态移动到视图中。**在我的css中我设置了overflow-x:hidden**，这样这个元素就不会创建一个丑陋的底部scollbar，问题出在我的笔记本电脑上（可能在ipad和其他设备上）我可以用两根手指滑动滚动和查看这个内容。这打破了整个布局，看起来非常糟糕，**我正在寻找一种方法来完全禁用这个水平滚动动作与 javascript 或 css。**

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T21:13:43.683

JavaScript：

```
 window.onscroll = function () {
     window.scrollTo(0,0);
    } 
```

每当用户尝试滚动时，这会将滚动条返回到其原始 (0,0) 位置。让我知道这是否适用于我在台式机上的笔记本电脑垫。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-24T19:43:29.227

首先，我使用了一个函数来检查滚动何时停止。然后我使用另一个功能回到中心。

```
(function(){

var special = jQuery.event.special,
    uid1 = 'D' + (+new Date()),
    uid2 = 'D' + (+new Date() + 1);

special.scrollstart = {
    setup: function() {

        var timer,
            handler =  function(evt) {

                var _self = this,
                    _args = arguments;

                if (timer) {
                    clearTimeout(timer);
                } else {
                    evt.type = 'scrollstart';
                    jQuery.event.handle.apply(_self, _args);
                }

                timer = setTimeout( function(){
                    timer = null;
                }, special.scrollstop.latency);

            };

        jQuery(this).bind('scroll', handler).data(uid1, handler);

    },
    teardown: function(){
        jQuery(this).unbind( 'scroll', jQuery(this).data(uid1) );
    }
};

special.scrollstop = {
    latency: 300,
    setup: function() {

        var timer,
                handler = function(evt) {

                var _self = this,
                    _args = arguments;

                if (timer) {
                    clearTimeout(timer);
                }

                timer = setTimeout( function(){

                    timer = null;
                    evt.type = 'scrollstop';
                    jQuery.event.handle.apply(_self, _args);

                }, special.scrollstop.latency);

            };

        jQuery(this).bind('scroll', handler).data(uid2, handler);

    },
    teardown: function() {
        jQuery(this).unbind( 'scroll', jQuery(this).data(uid2) );
    }
};

})();

jQuery(window).bind('scrollstop', function(e){
  // block horizontal scrolling
  window.scrollTo(0,jQuery(window).scrollTop()); 
}); 
```

# jquery - jQuery 动画回调

> ID：11335287
> 
> 赞同：2
> 
> 时间：2012-07-04T20:47:13.477
> 
> 标签：jquery, animation

会很简短。

我找到了一段代码并对其进行了相当多的更改，它似乎有点工作。

```
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript">
   $(document).ready(function(){
   $('dota').click(function(){

     });

        $('#Homebutton').toggle(function(){
            $('.animateme').html('<img src="Construct2/Images/Gnoll_Running.gif" />');         
            $('.animateme').animate({
                left: '+=150',
            }, 800, function() {
                $('.animateme').html('<img src="Construct2/Images/Gnoll_Hit.gif" />');
            });
            $('.animateme').animate({
                left: '+=0',
            }, 500);
            $('#Homebutton').html('<img src="Construct2/Images/buttonred.png" />');
            $('.animateme').animate({
                left: '+=0',
            }, 500, function() {
                $('.animateme') .html('<img src="Construct2/Images/Gnoll_Resting_smaller.gif" />');
                });

        }, function(){
            $('.animateme').html('<img src="Construct2/Images/Gnoll_Running_left.gif" />');  
            $('.animateme').animate({
                left: '-=500',
            }, 2200, function() {
                $('.animateme').html('<img src="Construct2/Images/Gnoll_Resting_smaller.gif" />');  
            });
        });

        $('#AddOnbutton').toggle(function(){
            $('.animateme').html('<img src="Construct2/Images/Gnoll_Running.gif" />');         
            $('.animateme').animate({
                left: '+=250',
            }, 1000, function() {
                $('.animateme').html('<img src="Construct2/Images/Gnoll_Hit.gif" />')
            });
            $('.animateme').animate({
                left: '+=0',
            }, 1000, function() {
                $('.animateme') .html('<img src="Construct2/Images/Gnoll_Resting_smaller.gif" />');
                });

        }, function(){
            $('.animateme').html('<img src="Construct2/Images/Gnoll_Running_left.gif" />');  
            $('.animateme').animate({
                left: '-=500',
            }, 2200, function() {
                $('.animateme').html('<img src="Construct2/Images/Gnoll_Resting_smaller.gif" />');  
            });
        });

    });
</script> 
```

问题是我希望**“#Homebutton”**在 Gnoll_Hit 动画的一半左右变为红色。所以我拼接了Hit动画，但没有这样做。

我想我必须用回调来做到这一点，因为在最后一个动画完成后，我希望它转到按钮链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T04:44:31.307

是的，在动画完成后调用它，所以在第二个参数上添加一个函数并在那里做下一组动画。

和一些提示：你应该尝试使用**jquery 链接**

```
$('.animateme')
    .html('')
    .animate( blah blah  ); 
```

所以代码更容易阅读和更快。

那么你也可以在 animate 函数中使用 $(this)

```
.animate( blah blah , function (){
    $(this).animate('');
  }); 
```

快乐编码:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T23:04:42.490

您可以在 #Homebutton-change-to-red 子动画上使用 jQuery 的 delay()，或者您可以“动画”一个从 0 到 1 的虚拟变量，并使用步进函数每次函数运行（动画的每一步都会运行一次）。

# php - 过滤 google api 以搜索特定城市的地理编码

> ID：11335293
> 
> 赞同：0
> 
> 时间：2012-07-04T20:48:11.123
> 
> 标签：php, jquery, ajax, google-maps-api-3

是否可以过滤自动填充位置 (api v3) 以搜索仅具有特定邮政编码或城市的街道？

现在我的配置如下

```
 var options = {
      componentRestrictions: {country: "it"},
      types: ['geocode']
    };

    var input = document.getElementById('searchTextField');
    var autocomplete = new google.maps.places.Autocomplete(input,options); 
```

现在它仅按国家“它”过滤，我会搜索所有街道，battipaglia (CITY) OR 84091 (ZIP CODE)

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T20:52:40.203

您可以使用边界，但您必须能够指定纬度和经度

> bounds 是一个 google.maps.LatLngBounds 对象，用于指定要在其中搜索 Places 的区域。结果偏向但不限于包含在这些范围内的地点。

# google-maps-api-3 - 关闭本地业务标记的信息窗口

> ID：11335299
> 
> 赞同：2
> 
> 时间：2012-07-04T20:48:36.303
> 
> 标签：google-maps-api-3

我有一个使用 API v3 的新谷歌地图应用程序。在它上面我有一些带有信息窗口的自定义标记。我使用一个全局变量来确保在任何时候只打开一个信息窗口——一切都应该是这样。

然而，该地图带有许多本地商业标记，就像这张地图上的那些 ( [http://goo.gl/maps/M6m3](http://goo.gl/maps/M6m3) )，所有这些都打开了自己的信息窗口。如果我点击其中一个，我的信息窗口不会关闭，如果我点击我的标记之一，内置的信息窗口也不会关闭 - 使多个窗口保持打开状态。

这可以解决吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T01:21:02.440

听起来您希望地图上的“兴趣点”（AKA POI）不可点击（或能够捕获对它们的点击）。

[这在问题跟踪器中](https://developers.google.com/maps/documentation/javascript/3.exp/reference#MapOptions)被跟踪为[FR，](https://code.google.com/p/gmaps-api-issues/issues/detail?id=3866) 最近[在`clickableIcons``MapOptions`](https://developers.google.com/maps/documentation/javascript/3.exp/reference#MapOptions)

如果将其设置为 false，则 POI 功能将不再可点击。您还可以使用对象`get/setClickableIcons`上的方法`Map`来动态更改它。

另一种处理它们的方法是从地图中删除 POI（使用样式地图），如果您不想在单击它们时打开信息窗口。

[这里（如何删除地图上的某些地方）](http://groups.google.com/group/google-maps-js-api-v3/browse_frm/thread/1962f4e70f4b23b9/3458eb9a53edf37c?lnk=gst&q=poi+remove+styledmap#3458eb9a53edf37c)是 v3 API 组关于使用样式地图删除它们的讨论。

在这里[（禁用 POI 的 InfoWindows - 找到解决方法）](http://groups.google.com/group/google-maps-js-api-v3/browse_frm/thread/7567cf8646c1c7d2/c037924dc0719ffc?lnk=gst&q=poi++styledmap#c037924dc0719ffc)是另一个。

至少现在这样做不会花费更多[（样式贴图过去比法线贴图更昂贵）](http://googlegeodevelopers.blogspot.com/2012/06/lower-pricing-and-simplified-limits.html)。

# c++ - GLFW 获取屏幕高度/宽度？

> ID：11335301
> 
> 赞同：13
> 
> 时间：2012-07-04T20:48:54.340
> 
> 标签：c++, opengl, glfw

使用 OpenGL 玩了一段时间，使用 freeglut 库，我决定在我的下一个培训项目中使用 GLFW，因为我被告知 GLUT 仅用于学习目的，不应该用于专业用途。我将 lib 链接到我的 NetBeans 项目没有任何问题，并且使用 mingw32 4.6.2 编译得很好。

但是，我在尝试将窗口定位在屏幕中央时遇到了困难。在freeglut下，我之前用过：

```
glutInitWindowPosition ( 
                         (glutGet(GLUT_SCREEN_WIDTH)-RES_X)  / 2,
                         (glutGet(GLUT_SCREEN_HEIGHT)-RES_Y) / 2 
                       ); 
```

我找不到任何会返回屏幕大小或宽度的 glfw 函数。这样的功能根本没有实现吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-04T20:55:13.690

怎么样[`glfwGetDesktopMode`](http://www.scribd.com/doc/56552343/30/glfwGetDesktopMode)，我想这就是你想要的。

例子：

```
GLFWvidmode return_struct;

glfwGetDesktopMode( &return_struct );

int height = return_struct.Height; 
```

对于 GLFW，他们使用[`glfwGetVideoMode`](http://www.scribd.com/doc/56552343/30/glfwGetDesktopMode)，它具有不同的调用，但返回结构可以以相同的方式使用。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-14T22:15:39.457

首先你需要两个变量来存储你的宽度和高度。

```
int width, height; 
```

然后如[参考文献第 14 页所述。](http://www.glfw.org/GLFWReference276.pdf)

```
glfwSetWindowPos(width / 2, height / 2); 
```

作为奖励，你可以打电话

```
glfwGetWindowSize(&width, &height); 
```

这是一个 void 函数，不返回任何值，但是它将更新两个先前声明的变量.. 所以将它放在 mainloop 或窗口重塑回调函数中。

您可以在第 15 页的官方手册中验证这一点[。](http://www.glfw.org/GLFWReference276.pdf)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-05-18T14:48:58.963

这可能会帮助某人...

```
void Window::CenterTheWindow(){
            GLFWmonitor* monitor = glfwGetPrimaryMonitor();
            const GLFWvidmode* mode = glfwGetVideoMode(monitor);
            glfwSetWindowPos(m_Window, (mode->width - m_Width) / 2, (mode->height - m_Height) / 2);
} 
```

`m_Width`并且`m_Height`是具有窗口宽度和高度的变量。

参考：[http ://www.glfw.org/docs/latest/monitor.html](http://www.glfw.org/docs/latest/monitor.html)

# java - Looking for a Cppcheck-like tool for Java development

> ID：11335302
> 
> 赞同：3
> 
> 时间：2012-07-04T20:49:01.470
> 
> 标签：java, c++, pmd, cppcheck

I'm a software tester and developer. My company is starting a partnership with another development team and we need a new tool for static analysis.

The new team's previous code is written in Java, so we need a static analysis tool with similar features to Cppcheck. We have been trying Macker, PMD and JDepend but none of these are like Cppcheck.

Also, we are trying to get a trial license of Coverity, which it seems like we want, but at the moment I couldn't test it yet.

So, does anyone know of a tool like the one I'm looking for? Thanks!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T08:22:40.980

看看[SonarQube](https://www.sonarqube.org)。此工具提供对 Java 代码的广泛分析。可以在[此处](https://sonarcloud.io/about)找到示例。

# ruby-on-rails - Can't find element to click on using Capybara + Rails3

> ID：11335303
> 
> 赞同：21
> 
> 时间：2012-07-04T20:49:01.387
> 
> 标签：ruby-on-rails, testing, rspec, capybara

**Background**: I'm using Capybara with Rspec to test a Rails 3 app. **Driver used**: Selenium

**Problem**: I can't find the "Sign in" button in order to click on from within my test.

**HTML code:**

```
<form accept-charset="UTF-8" action="/" class="filter_form" id="login" method="post">
        <fieldset>
          <div class="modal-body">
            <div class="clearfix login-fields">
              <label for="user_email">Email</label>
              <div class="input login-inputs">
                <input class="input-text" id="user_email" name="user[email]" placeholder="email" size="30" type="email" value="">
              </div>
            </div>
            <div class="clearfix login-fields">
              <label for="user_password">Password</label>
              <div class="input login-inputs">
                <input class="input-text" id="user_password" name="user[password]" placeholder="password" size="30" type="password">
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <input class="btn btn-primary login_btn" id="btn_login" name="commit" type="submit" value="Sign in">
            <a href="/lms/forgot_password" class="btn">Forgot password...</a>
            <a href="#" class="btn close cancel" data-dismiss="modal">Cancel</a>
          </div>
        </fieldset>
</form> 
```

**Failing test**

```
it "should login correctly if the right credentials are given", :js => true do

    Capybara.default_wait_time = 5
    Capybara.reset_sessions!
    visit '/'
    click_link('login_link') #this will bring a modal window with the code posted above using js
    within("#login") do
      fill_in 'user_email', :with => "my-email@example.com"
      fill_in 'user_password', :with => "mypwd"
    end

    response.should have_selector('input#btn_login') #This passes
    click_on("input#btn_login") #Here it fails, saying it can't find an element with that selector
    response.should have_selector(:xpath, '//div[@class="alert-message block-message info"]')
  end 
```

My test file is inside `spec/requests`.

Any ideas? Thanks!

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-12-10T14:10:52.600

请试试这个：

```
page.find("#btn_login").click 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-05T17:49:38.450

这个：[https ://stackoverflow.com/a/11348065/1504796](https://stackoverflow.com/a/11348065/1504796)

是正确答案。

`click_on`不采用 CSS 选择器，而是采用链接的文本或 id。你想要`click_on("btn_login")`。没有哈希符号或任何东西。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-06-10T09:30:06.677

尝试

```
find('#id',:visible => true).click 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-07-05T15:21:27.863

看起来您正在尝试单击某个模态 css 中的提交按钮。您需要首先调用显示该模态元素的任何内容。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-07-05T14:40:14.153

尝试将“gem 'launchy'”添加到您的 Gemfile 并在步骤文件中的失败行之前放置“save_and_open_page”行。

参考：[http ://techiferous.com/2010/04/using-capybara-in-rails-3/](http://techiferous.com/2010/04/using-capybara-in-rails-3/)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-07-05T15:52:34.093

我认为 click_on 不会采用这样的定位器——我认为它可能只需要一个 id、名称或值。作为实验，尝试将 click_on("input#btn_login") 替换为：

page.find('#btn_login').click

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-03-18T15:52:33.317

*   click_button("登录")
*   find(:xpath, "//*[@id='btn_login']").click (或 .trigger('click'))

如果其他失败，请通过控制台查看是否可以检查按钮的存在： document.getElementById("btn_login")

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-09-08T15:36:38.130

如果您知道链接文本，则可以使用`page.find_link(text).click`. （[来源](http://rubydoc.info/github/jnicklas/capybara/master/Capybara/Node/Finders:find_link)）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-01-16T02:04:31.043

我用镀铬的水豚

```
Capybara.register_driver :chrome do |app|   Capybara::Selenium::Driver.new(app, 
                                                           :browser => :chrome) 
end

Capybara.javascript_driver = :chrome 
```

并安装 chrome 驱动程序：

```
brew install chromedriver 
```

[http://collectiveidea.com/blog/archives/2011/09/27/use-chrome-with-cucumber-capybara/](http://collectiveidea.com/blog/archives/2011/09/27/use-chrome-with-cucumber-capybara/)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-07-05T14:42:04.583

尝试在相关行之前添加 save_and_open_page。这应该允许您查看页面和任何可能阻止单击操作的错误。

# delphi - Delete line in TSTringlist

> ID：11335310
> 
> 赞同：-1
> 
> 时间：2012-07-04T20:49:46.837
> 
> 标签：delphi

Hello i am writing some values to a stringlist. And would like to delete a value from the string list.

Currently I write to the string list like this.

```
 FGamePlay.Locations.strings[0] := ('NumberOfLocations='+inttostr(NOL+1));   //add one to total
   FGameplay.Locations.Add(inttostr(Position.x)+inttostr(Position.Y)+'=pos');  //add the location to list 
```

This will return me a list like so

```
INDEX    VALUE
[0]       NumberOfLocations=4
[1]       23=pos
[2]       34=pos
[3]       24=pos
[4]       52=pos 
```

Now i try to delete it like this

```
FGamePlay.Locations.Delete(FGamePlay.Locations.IndexOf(inttostr(ePosition.x)+inttostr(ePosition.Y))); 
```

were ePosition.x + ePosition.Y will equal 23, 34,24,or 52\. Thus it should delete the that line but instead when i add this delete line i get index out of bounds -1\. I did stop the code just before this line and looked at Locations() and it had all these numbers in there. Also looked at epostion and the X,Y values were 34, thus correct too. Any idea? thanks Glen

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-04T20:56:24.803

当您使用该[`IndexOf`](http://docwiki.embarcadero.com/Libraries/en/System.Classes.TStrings.IndexOf)函数时，您必须传递确切的字符串来查找，在这种情况下，因为您是以这种方式添加字符串

```
FGameplay.Locations.Add(inttostr(Position.x)+inttostr(Position.Y)+'=pos'); 
```

您必须将 添加`=pos`到要搜索的字符串中，例如

```
LIndex:=FGamePlay.Locations.IndexOf(inttostr(ePosition.x)+inttostr(ePosition.Y)+'=pos');
If LIndex>=0 then
 FGamePlay.Locations.Delete(LIndex); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T20:56:40.213

正如 RRUZ 所说，您要删除的字符串缺少“=pos”后缀。

为了更有效地调试它，您应该更多地分解代码。如果您有此等效代码：

```
str := inttostr(ePosition.x)+inttostr(ePosition.Y);
pos := FGamePlay.Locations.IndexOf(str);
FGamePlay.Locations.Delete(pos); 
```

你会在线路上得到一个错误`pos :=`，这将允许更容易地查看错误的来源。

您还可以考虑制作如下函数：

```
function MakePosString(Position : Point);
begin
   Result := inttostr(ePosition.x)+inttostr(ePosition.Y)+'=pos';
end; 
```

然后您可以调用该函数而不是重新实现该代码，并保证您的字符串是一致的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T03:34:31.663

虽然我同意其他人所说的关于考虑为手头的工作使用更好的数据结构的说法，但我认为为了将来遇到类似问题的任何人，值得一提的是其他人尚未发现的东西。

你的表情：

```
IntToStr(ePosition.x) + IntToStr(ePosition.y) 
```

当被视为名称/值列表时，标识字符串列表中条目的名称。也就是说，一个 TStringList，其中每个项目的形式为“name=value”。虽然修复代码的一种方法是附加字符串的其余部分（'=pos'），但这当然仅在每个命名值的“值”部分始终为“pos”时才有效。

如果给定命名值的“pos”值可能不同或未知，那么您仍然可以通过仅使用名称部分查找项目的索引来找到它：

```
 itemName  := IntToStr(ePosition.x) + IntToStr(ePosition.y);
  itemIndex := fGamePlay.Locations.IndexOfName(itemName);
  if itemIndex > -1 then
    fGamePlay.Locations.Delete(IndexOfName(itemName)); 
```

# html - 将浮动元素与 div 底部对齐

> ID：11335311
> 
> 赞同：0
> 
> 时间：2012-07-04T20:49:46.453
> 
> 标签：html, css

试图向左浮动一个 ul，向右浮动一个 ul，并将它们保持在 div 的底部但没有成功

这是小提琴[http://jsfiddle.net/Ku2jk/](http://jsfiddle.net/Ku2jk/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T20:53:30.547

将容器漂浮在另一个容器中的方法没有错，该容器位于绝对底部。

您只是遇到了一些语法错误，而且包含浮动 div 的容器没有宽度。

[http://jsfiddle.net/Ku2jk/26/](http://jsfiddle.net/Ku2jk/26/)

```
height = 100px;
       ^   should be height:100px;
backgroundcolor: blue;
          ^  should be background-color;

#menubar{
   position: absolute;
   bottom: 0;
    width: 100%;
       ^   needed a width because positioned absolute.
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T20:55:51.820

哪个div？尝试删除`position: absolute`. `#menubar`此外，更改`backgroundcolor`，不存在到`background-color`或`background`

# joomla - Phpmyadmin : how to copy a row from a table to another?

> ID：11335314
> 
> 赞同：2
> 
> 时间：2012-07-04T20:50:27.050
> 
> 标签：joomla, phpmyadmin, joomla2.5

Instead of doing never end copy past between 2 joomla 2.5 website (I want to copy past their modul and articles)

Phpmyadmin : How can I copy past a single or multiple row (article, module) from one jrm_content to jasso_content (they have both exactly the same colons type)

I know how to select rows and to import them, but after...? (I changed the id are different exept for some the Asset ID is it a problem?

Thanks a lot!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T21:01:45.063

这样的查询有什么问题？

```
INSERT INTO tableNew
            (col1,col2,col3,col4,col5)
            (
              SELECT
                    col1,col2,col3,col4,col5
              FROM tableOld
            ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-25T16:35:48.137

```
select from tablename where table name.primary key = table name.foreign key

<?php
$sname=$_POST['srname'];
      $link=mysql_connect("localhost","root","") or die("Cannot Connect to the database!");
         mysql_select_db("human_resource",$link) or die ("Cannot select the database!");
         $query="SELECT * FROM employee WHERE  fname='$sname'";
         $resource=mysql_query($query,$link);
         echo "
        <table align=\"center\" border=\"1\">
        <tr>
        <td><b>FName</b></td> <td><b>lname</b></td><td><b></b></td><td><b>Department</b></td></tr> ";
        while($result=mysql_fetch_array($resource))
        {
        echo "<tr><td>".$result[1]."</td><td>".$result[2]."</td><td>".$result[3]."</td></tr>";
        }
        echo "</table>";
        ?> 
```

# ruby - Ruby XMPP4R useer JID

> ID：11335315
> 
> 赞同：2
> 
> 时间：2012-07-04T20:50:30.203
> 
> 标签：ruby, xmpp4r

I use `xmpp4r` gem for create simple jabber bot. how do you know `jid` users in the room? How do I know what `jid` posted a message?

Example code:

```
 @room.join Jabber::JID.new("#{conf}/#{nick}")

  @room.add_message_callback do |msg|
    #msg.jid? 
  end 
```

Thanks.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-05T14:58:49.293

消息对象继承自 XMPP Stanza 对象。所以消息应该有一个`msg.to`and `msg.from`，因为它是一个群聊。msg.to 将是您的群聊的 JID，msg.from 将是发送消息的人的 JID。

# python - Django创建的models.py文件可以被另一个python文件用来填充数据库吗？

> ID：11335327
> 
> 赞同：1
> 
> 时间：2012-07-04T20:51:50.307
> 
> 标签：python, django, postgresql

我已经按照 Django 网站 (https://docs.djangoproject.com/en/1.4/intro/tutorial01/) 上的教程（第 1 部分和第 2 部分），并设法创建了几个文件夹并连接到我的网站。我的应用程序被称为“应用程序”，所以我的文件夹结构看起来有点像：

*   **主文件夹**
*   --- **__*初始化*__** .py
*   ---test.py
*   --- **djangoSite**（由 Django 创建）
*   ------ 管理.py
*   ------ **djangosite**
*   --------- 其他 .py 文件
*   ------**应用程序**
*   ---------- **__*初始化*__** .py
*   --------- 模型.py
*   --------- 其他 .py 文件

我将 models.py 文件更改为：

```
class Result(models.Model):
    options = models.CharField(max_length = 1000, unique = False)
    reverse = models.DecimalField(decimal_places = 6, max_digits = 12) 
```

test.py 目前在其他一些类上运行几个测试。我想要的是让我的 test.py 类运行这些测试并将结果保存在数据库中（列和反向）。我希望在我的 test.py 类中做这样的事情：

```
import models.py
if __name__ == "__main__":
    optionResult = someTestsThatRuns
    reverseResult = someOtherTestThatRuns
    models.Result c;
    c.options = optionResult 
    c.reverse = reverseResult 
```

我希望最后两行将结果保存在数据库中。这可能吗？如何从 app 文件夹中导入 models.py？

谢谢

***编辑***：当我说 someTestsThatRuns 时，这些不是单元测试。它们实际上是一个函数，它返回一个列表和一些带有“PASS”或“FAIL”的字符串。对困惑感到抱歉

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T21:01:37.703

在 app 文件夹中创建一个空`__init__.py`文件，以便 Python 将该目录视为一个包。然后做：

```
from app.models import Result

optionResult = someTestsThatRuns
reverseResult = someOtherTestThatRuns
c = Result()
c.options = optionResult 
c.reverse = reverseResult
c.save() 
```

这会将'c'保存到数据库中。

请注意，Django 的测试套件可以创建自己的测试数据库，该数据库在单独的数据库上运行测试。您可以在此处阅读有关 Django 测试的更多信息。 [https://docs.djangoproject.com/en/dev/topics/testing/?from=olddocs](https://docs.djangoproject.com/en/dev/topics/testing/?from=olddocs)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-07T16:34:35.363

***FIXED***正如大卫在评论中提到的，环境变量确实没有设置。由于我在 Windows 中，我必须做的是开始 -> 计算机 -> 属性 -> 高级系统设置 -> 环境变量 -> 添加环境变量。

在那里我添加了 'DJANGO_SETTINGS_MODULE' 及其位置为 'C:\path\to\your\settings.py' 之后，在命令提示符下，我必须执行以下操作：

```
enter python
>import sys
>import os
>sys.path.append(r"C:\location\to\settings.py")
>from django.core.management import setup_environ
>setup_environ(settings)
>sys.path.append(os.getcwd() + '\\from\\current\\to\\models.py'
>from models import Result 
```

这一切都在[http://www.b-list.org/weblog/2007/sep/22/standalone-django-scripts/](http://www.b-list.org/weblog/2007/sep/22/standalone-django-scripts/)进行了解释，尽管我确实发现它有点难以理解。我在导入模型时遇到的另一个问题是有两个名称完全相同的文件夹（djangoSite），因此在导入时，计算机在试图找出哪个文件夹时遇到了一些问题。我不得不重命名、删除、重置环境变量并重新检查我在整个文件中拥有的所有路径 =/

如果我的解释不是最好的，我很抱歉，我几乎不明白我做了什么，但我希望这对未来的其他人有所帮助

# java - Exception thrown by an interceptor doesn't go to the exception handler.

> ID：11335328
> 
> 赞同：2
> 
> 时间：2012-07-04T20:51:53.960
> 
> 标签：java, exception-handling, struts2, struts, interceptor

There's an issue I've experienced this day. I have an interceptor that begins and commits a Hibernate transaction and it may throw an exception on commit (`org.hibernate.StaleObjectStateException` for instance). That is, it can throw an exception but exception doesn't get to the handler. I thought there's an issue in my code. But then I wrote a simple test and here it is

Package definition in `struts.xml`:

```
<package name="basicstruts2" namespace="/" extends="struts-default">
    <interceptors>
        <interceptor name="dummy" class="test.TestInterceptor"/>

        <interceptor-stack name="myStack">
            <interceptor-ref name="defaultStack" />
            <interceptor-ref name="dummy" />
        </interceptor-stack>
    </interceptors>

    <default-interceptor-ref name="myStack"/>

    <global-results>
        <result name="exception" type="chain">exceptionHandler</result>
    </global-results>

    <global-exception-mappings>
        <exception-mapping exception="java.lang.Exception" result="exception" />
    </global-exception-mappings>

    <action name="test" class="test.TestAction">
        <result>result.jsp</result>
    </action>

    <action name="exceptionHandler" class="test.ExceptionHandler">
        <result>DebugErrorPage.jsp</result>
    </action>
</package> 
```

**`TestAction.java`:**

```
package test;

public class TestAction extends ActionSupport {

    private BusinessLogic logic = new BusinessLogic();

    public String execute() {
        logic.test();
        return SUCCESS;
    }
} 
```

**`TestInterceptor.java`:**

```
package test;

public class TestInterceptor implements Interceptor {

    @Override
    public String intercept(ActionInvocation arg0) throws Exception {
        String result = null;
        try {
            result = arg0.invoke();
            boolean flag = true;
            if (flag) throw new RuntimeException("qwerty");
        } catch (Exception e) {
            System.out.println("exception catched in interceptor, rethrowing " + e);
            throw e;
        }
        return result;
    }

} 
```

**`ExceptionHandler.java`:**

```
package test;

public class ExceptionHandler extends ActionSupport {

    private Exception exception;

    public void setException(Exception e) {
        exception = e;
        System.out.println("setting exception");
    }

    public String execute() {
        System.out.println("exeption in handler " + exception);
        return SUCCESS;
    }

} 
```

**`BusinessLogic.java`:**

```
package test;

public class BusinessLogic {
    public void test() {
        System.out.println("test logic");
//      boolean flag = true;
//      if (flag) throw new RuntimeException("qwerty");
    }
} 
```

So, console output :

```
test logic
exception catched in interceptor, rethrowing java.lang.RuntimeException: qwerty 
```

BUT if an exception is thrown by BusinnesLogic, we can uncomment code:

**`BusinessLogic.java`:**

```
package test;

public class BusinessLogic {
    public void test() {
        System.out.println("test logic");
        boolean flag = true;
        if (flag) throw new RuntimeException("qwerty");
    }
} 
```

and comment out code in interceptor:

```
@Override
        public String intercept(ActionInvocation arg0) throws Exception {
            String result = null;
            try {
            result = arg0.invoke();
        //  boolean flag = true;
        //  if (flag) throw new RuntimeException("qwerty");
            } catch (Exception e) {
                System.out.println("exception catched in interceptor, rethrowing " + e);
                throw e;
            }
            return result;
        } 
```

output will be:

```
test logic
exception catched in interceptor, rethrowing java.lang.RuntimeException: qwerty
setting exception
exeption in handler java.lang.RuntimeException: qwerty 
```

And we will see the error page.

So, can anybody give a good explanation of this behavior? What's the point of putting the exception interceptor at the top of the default struts stack if it can't handle exceptions that was thrown by other interceptors? and why?? I would really appreciate for a good answer.

**EDIT:** There is a code I have a problem with:

```
public String intercept(ActionInvocation arg0) throws Exception {
    String result = null;

    try {

        sf.getCurrentSession().beginTransaction();

        result = arg0.invoke();

        sf.getCurrentSession().getTransaction().commit();

    } catch (StaleObjectStateException staleEx) {
        if (sf.getCurrentSession().getTransaction().isActive()) {
            sf.getCurrentSession().getTransaction().rollback();
        }
        throw staleEx;

    } catch (Exception ex) {
        ex.printStackTrace();
        try {
            if (sf.getCurrentSession().getTransaction().isActive()) {
                sf.getCurrentSession().getTransaction().rollback();
            }
        } catch (Throwable rbEx) {
        }

        // Let others handle it... maybe another interceptor for exceptions?
        throw new ServletException(ex);
    }

    return result;
} 
```

What should be done if I want handle exceptions thrown on `commit()` ?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T01:20:28.023

在动作调用和结果呈现`TestInterceptor` *之后*抛出异常。

从[写作拦截器页面](http://struts.apache.org/2.x/docs/writing-interceptors.html)上的注释：

> 请记住，调用将在调用结果后返回（例如，在呈现 JSP 之后），使其非常适合诸如 open-session-in-view 模式之类的事情。如果你想在结果被调用之前做一些事情，你应该实现一个 PreResultListener。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T00:22:13.027

ExceptionMappingInterceptor 的核心功能

> 这个拦截器构成了异常处理特性的核心功能。异常处理允许您将异常映射到结果代码，就像操作返回结果代码而不是抛出意外异常一样。当遇到异常时，它会被一个 ExceptionHolder 包装并压入堆栈，从而可以从结果中轻松访问异常。注意：虽然您可以随时在配置文件中配置异常映射，但如果此拦截器不在您的操作的拦截器堆栈中，则配置不会产生任何影响。建议您将此拦截器设置为堆栈上的第一个拦截器，确保它具有捕获任何异常的完全访问权限，即使是由其他拦截器引起的异常。

示例代码：

```
 <xwork>
     <package name="default" extends="xwork-default">
         <global-results>
             <result name="error" type="freemarker">error.ftl</result>
         </global-results>

         <global-exception-mappings>
             <exception-mapping exception="java.lang.Exception" result="error"/>
         </global-exception-mappings>

         <action name="test">
             <interceptor-ref name="exception"/>
             <interceptor-ref name="basicStack"/>
             <exception-mapping exception="com.acme.CustomException" result="custom_error"/>
             <result name="custom_error">custom_error.ftl</result>
             <result name="success" type="freemarker">test.ftl</result>
         </action>
     </package>
   </xwork> 
```

# excel-2007 - Excel Cant scroll down to see sheet tabs

> ID：11335333
> 
> 赞同：0
> 
> 时间：2012-07-04T20:52:10.187
> 
> 标签：excel-2007, spreadsheet

I upgraded to office 2007 from 2003 (I think) but now on a couple of documents I cant see all my tabs as the worksheet window goes well below the excel window. I cant move or resize the work sheet window, It's not protected. when I try click on the top bar of the worksheet window - here you would usually be able to drag it around I cant.

however if I select it in full screen mode i can see all the tabs. I have checked the settings and "show tas" is ticked. I've googled for an hour and tried numerous things but to no avail. If I try view as tiles It still doesn't change.

My only option left is to copy and past each sheet.. or is there a way to copy a wwhole work sheet tabs and all?

Please help!!

![Excel cant see sheet tabs](../Images/2fb32a43ceb12d0e112d105a8423112e.png)

Thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T22:31:15.593

您只需双击工作表窗口的标题栏。这将使其最大化，这将使其适合应用程序窗口的确切大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T22:41:37.953

工作簿受到保护。我去评论标签。将保护工作簿下拉并取消选择保护..然后正常工作！希望这对某人有帮助！谢谢！

# ios - 你如何使用 GL_UNSIGNED_BYTE 作为纹理坐标？

> ID：11335336
> 
> 赞同：1
> 
> 时间：2012-07-04T20:52:31.133
> 
> 标签：ios, xcode, performance, opengl-es

在 XCode 附带的“OpenGL ES Programming Guide for iOS”文档中，在“使用顶点数据的最佳实践”部分的“使用最小可接受的属性类型”标题下，它说

> 使用 2 或 4 个无符号字节 (GL_UNSIGNED_BYTE) 或无符号短字节 (GL_UNSIGNED_SHORT) 指定纹理坐标。

我有点疑惑。我认为纹理坐标大部分时间都小于 1，因此需要一个浮点数来表示小数值。你如何使用无符号字节或无符号短裤？在着色器中除以 255？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T21:00:37.460

如果您使用`GL_UNSIGNED_BYTE`，您最终会将 , 传递`normalized`到`GL_TRUE`(例如) `glVertexAttribPointer`，表明您传递的值不在 0 和 1 之间，但应该从它们的完整范围（例如 0 到 255）归一化为归一化在传递给着色器之前的范围为 0 到 1。（有关详细信息，请参阅 OpenGL ES 2.0 规范的第 2.1.2 节）。

换句话说，当您传递无符号字节之类的整数类型时，请使用“标准化”值`GL_TRUE`并使用该类型的完整范围（例如 0 到 255），因此 127 的值将大约相当于浮点0.5。

# routes - 从 CDN 提供静态 play2.x 内容

> ID：11335341
> 
> 赞同：0
> 
> 时间：2012-07-04T20:52:54.303
> 
> 标签：routes, playframework-2.0, cdn

在开发模式下，我希望在本地提供资产，而在生产中部署时，我希望从 CDN 提供资产。任何使用 play2 并从 CDN 提供内容的人都愿意分享他们是如何做到的吗？

```
// Thinking of something like this in the routes file...
@if(play.Play.isDev()) {
    GET     /assets/*file               controllers.Assets.at(path="/public", file)
} else {
    GET     CDNPATH/assets/*file        controllers.Assets.at(path="CDNPATH", file)
} 
```

（注意：使用 2.0.2 因为标头修复[https://github.com/playframework/Play20/pull/276](https://github.com/playframework/Play20/pull/276)）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T20:55:00.973

我所做的只是简单地编辑我计算机上的“主机”文件以在本地指向 CDN 域。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-08T05:08:49.003

对于那些寻求做类似事情的人，我发现这个链接有人准确地描述了如何使用播放从 CDN 提供内容： [http ://www.jamesward.com/2012/08/08/edge-caching-with-play2-heroku -云端](http://www.jamesward.com/2012/08/08/edge-caching-with-play2-heroku-cloudfront)

这是另一种选择，我最终使用了一个功能，以便我可以让我的本地系统具有 application.cdn="" 并且在生产中它具有真正的价值。还允许版本更改使缓存无效：

_assets.scala.html

```
@(path: String)@Html((""""%s%s?v=%s"""").format(
play.api.Play.current.configuration.getString("application.cdn").get,
routes.Assets.at(path), 
play.api.Play.current.configuration.getString("application.version").get )) 
```

采用

@_asset("样式表/css.min.css")

# jquery - 无法获得 jquery 悬停菜单工作

> ID：11335344
> 
> 赞同：-2
> 
> 时间：2012-07-04T20:53:27.530
> 
> 标签：jquery, html, css

我无法让 jquery 菜单正常工作

当我悬停类时，.trigger 向下滑动，但是当我用鼠标向下滑动时，它一直向上和向下滑动。

网站链接：[这里](http://www.nedwebdesign.nl/dvl/)

jQuery

```
<script type="text/javascript">
    $(document).ready(function () { 

        $('.sub_menu').hide();

        $('.trigger,.sub_menu').mouseenter(function() {
        //show its submenu
            $('.sub_menu').slideDown(300); 
        }); 

        $('.sub_menu,.trigger').mouseleave(function() {
        //show its submenu
            $('.sub_menu').slideUp(300); 
        }); 

    });
</script> 
```

HTML

```
<div id="header">
    <div class="container">
        <a href="index.php"><h1 id="logo">Dick van Leeuwen Financieel Consult</h1></a>

        <div id="nav">
            <ul class="main_menu">
                <li><a href="#">Home</a></li>
                <li>
                    <a href="#" class="trigger">Hypotheken</a>
                    <ul class="sub_menu">
                        <li><a href="#">Hypotheekvormen</a></li>
                        <li><a href="#">Hyporheek rente</a></li>
                        <li><a href="#">Nationale hypotheek garantie</a></li>   
                    </ul>
                    <div class="clear"></div>                       
                </li>
                <li><a href="#">Verzekeringen</a></li>
                <li><a href="#">Downloads</a></li>
                <li><a href="#">Contact</a></li>
            </ul>
        </div><!-- nav -->
    </div><!-- container -->
</div><!-- header --> 
```

请帮助我现在卡住大约 5 个小时。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T21:18:09.207

以下应该解决您的问题。

```
$("a.trigger").parent().hover(function(e) {
    //when over the li (could be the a or sub_menu)
    $(this).find(".sub_menu").slideDown(300);
},function(e) {
    //when leaving the li
    $(this).find(".sub_menu").slideUp(300);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T21:18:43.190

您可以将 li 作为触发器而不是 a。这样，当您悬停子菜单时，您不应该得到 mouseleave 事件：

```
 <li><a href="#">Home</a></li>
      <li class="trigger">
           <a href="#">Hypotheken</a>
           <ul class="sub_menu">
                <li><a href="#">Hypotheekvormen</a></li>
                <li><a href="#">Hyporheek rente</a></li>
                <li><a href="#">Nationale hypotheek garantie</a></li>   
           </ul>
           <div class="clear"></div>                       
        </li>
        <li><a href="#">Verzekeringen</a></li>
        <li><a href="#">Downloads</a></li>
        <li><a href="#">Contact</a></li> 
```

然后将您的js更改为：

```
$('.trigger').mouseenter(function() {
    $('.sub_menu').slideDown(300); 
}).mouseleave(function() {
    $('.sub_menu').slideUp(300); 
}); 
```

# jquery - 使用 ajax 加载图像时，Jquery $('img').load() 事件不会触发

> ID：11335347
> 
> 赞同：0
> 
> 时间：2012-07-04T20:53:57.317
> 
> 标签：jquery, html, ajax

嗨，我正在制作一个图片库，您可以在其中通过 AJAX 加载更多图片。

`fadeIn`我使用以下代码有效果。

```
$('img').load(function() {
       $(this).fadeIn();
 }); 
```

这适用于第一组图像（与页面一起加载），但是当我通过 AJAX 调用更多（参见下面的代码）时，`$('img').load()`似乎不再触发。

```
$('#clickme').click(function(){
      $('.tile').fadeOut();
           $.post('http://localhost/wp-admin/admin-ajax.php',{
                   'action' : 'da_ajax_posts',
                   'data'   : 'foobarid'
                 },(function($data){
                 $('#container').html($data);

  })); 
```

这是我的代码的其余部分：

```
<div id="container">
      <div class="tile w2 h2 t1 l1">
           <h2>Image10</h2>
           <img src="/wp-content/themes/site/images/tim.php?w=385&amp;h=256&amp;src=http://localhost/wp-content/uploads/2012/07/img10.jpg">
           <p></p>
        </div>

        <div class="tile w1 h2 t1 l3">
           <h2>image9</h2>
           <img src="/wp-content/themes/site/images/tim.php?w=190&amp;h=256&amp;src=http://localhost/wp-content/uploads/2012/07/Chrysanthemum.jpg">
           <p></p>
        </div>

        <div class="tile w2 h1 t1 l4">
           <h2>Image8</h2>
           <img src="/wp-content/themes/site/images/tim.php?w=385&amp;h=146&amp;src=http://localhost/wp-content/uploads/2012/07/Desert.jpg">
           <p></p>
        </div>

        <div class="tile w2 h2 t2 l4">
           <h2>image7</h2>
           <img src="/wp-content/themes/site/images/tim.php?w=385&amp;h=256&amp;src=http://localhost/wp-content/uploads/2012/07/Hydrangeas.jpg">
           <p></p>
        </div>

        <div class="tile w1 h1 t3 l1">
           <h2>Image6</h2>
           <img src="/wp-content/themes/site/images/tim.php?w=190&amp;h=146&amp;src=http://localhost/wp-content/uploads/2012/07/img10.jpg">
           <p></p>
        </div>

        <div class="tile w1 h1 t4 l1">
           <h2>image 5</h2>
           <img src="/wp-content/themes/site/images/tim.php?w=190&amp;h=146&amp;src=http://localhost/wp-content/uploads/2012/07/Jellyfish.jpg">
           <p></p>
        </div>

        <div class="tile w1 h2 t3 l2">
           <h2>Image4</h2>
           <img src="/wp-content/themes/site/images/tim.php?w=190&amp;h=256&amp;src=http://localhost/wp-content/uploads/2012/07/Koala.jpg">
           <p></p>
        </div>

        <div class="tile w1 h1 t3 l3">
           <h2>Image3</h2>
           <img src="/wp-content/themes/site/images/tim.php?w=190&amp;h=146&amp;src=http://localhost/wp-content/uploads/2012/07/Lighthouse.jpg">
           <p></p>
        </div>

        <div class="tile w1 h1 t4 l5">
           <h2>Image2</h2>
           <img src="/wp-content/themes/site/images/tim.php?w=190&amp;h=146&amp;src=http://localhost/wp-content/uploads/2012/07/Tulips.jpg">
           <p></p>
        </div>

        <div class="tile w2 h1 t4 l3">
           <h2>Image1</h2>
           <img src="/wp-content/themes/site/images/tim.php?w=385&amp;h=146&amp;src=http://localhost/wp-content/uploads/2012/07/Penguins.jpg">
           <p></p>
        </div>

</div> 
```

提前谢谢了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T20:58:07.110

您需要使用 live 定义您的加载事件：

```
$('img').live("load", function() {
    $(this).fadeIn();
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T20:58:24.247

您应该在 ajax 回调中再次绑定此事件。

在这行“$('#container').html($data);”之后写下以下代码

```
$('img').load(function() {
   $(this).fadeIn();
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-29T15:31:28.220

`live`现在已弃用，请参阅`on`替换：[http ://api.jquery.com/on/](http://api.jquery.com/on/)

就像`live`，它的目标是绑定一个事件处理程序，当你第一次绑定它时，它也会被触发的元素不存在。

在类似于 OP 的情况下，您想要的是：

```
// binding the event to the body but restricting its scope to img tags
$('body').on('load', 'img', function() {
    $(this).fadeIn();
}); 
```

# mysql - Mysql timediff 与 min

> ID：11335348
> 
> 赞同：1
> 
> 时间：2012-07-04T20:54:00.893
> 
> 标签：mysql

我正在查询以监控正在进行的和预期的文件上传。这是我正在做的：

```
select time_to_sec(min(timediff(now(), f.SubmittedDate)))/60 FROM dbtable f WHERE f.Status = 'SUBMITTED'; 
```

现在，在 12 小时后，它会继续返回 10 倍于应有的返回值。它返回 6200 分钟，而不是 620 分钟。如果我这样做，它会起作用：

```
select time_to_sec(timediff(now(), max(f.SubmittedDate)))/60 FROM dbtable f WHERE f.Status = 'SUBMITTED' 
```

我不明白其中的区别，为什么会这样？显然，最低 timediff 应该等于现在和最高日期之间的 timediff。我错过了什么还是这是一个错误？

我的问题是我以这种方式设置了大量检查，并且编辑所有这些检查可能是相当大的工作量。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-06T08:55:55.127

我对此和您的代码进行了一些测试：

```
select time_to_sec(min(timediff(now(), f.SubmittedDate)))/60 FROM dbtable f WHERE f.Status = 'SUBMITTED'; 
```

需要是：

```
select min(time_to_sec(timediff(now(), f.SubmittedDate)))/60 FROM dbtable f WHERE f.Status = 'SUBMITTED'; 
```

由于您没有像在第二个查询中那样使用“MAX”函数，因此您需要在“TIME_TO_SEC”之前调用“MIN”函数。

希望这可以帮助

# erlang - “时间通行证”模块

> ID：11335352
> 
> 赞同：3
> 
> 时间：2012-07-04T20:54:22.820
> 
> 标签：erlang

我正在尝试创建一个以*不规则*间隔收集数据的通用模块。一旦新数据到达，数据就会从左端到达。这可能是每秒 100 次。

在右端，我希望能够“插入”n 个侦听器，每个侦听器都有自己的固定*间隔*。为简化起见，假设所有时间间隔为每秒一次。

每个侦听器都会注册一个可能是异步的也可能不是异步的回调函数。

我的问题是，如果回调函数是同步的，我的“临时通道”可能会挂起。解决这个问题的最佳方法是什么？如果回调挂起，我是否应该生成一个纯粹目的是传递数据并付出代价的进程？

```
 +-------------+ Data Out 1
=======> |Temporal Pass| ==========>
Data In  +-------------+ \\ Data Out 2
                          ++=======>
                           \\ Data Out n
                            ++=======> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T21:41:29.580

为消息生成一个新进程，否则该进程将等待同步调用完成。这正是流程模型要解决的问题，我看不出有任何其他方法可以解决。

产卵过程并不昂贵，但也不是完全免费的。通过只为同步调用生成新进程，您可能会获得小的性能提升。这将需要某种方式将每个回调标记为同步或异步。

# c# - 支持移动应用的 C# ASPX Web 服务

> ID：11335360
> 
> 赞同：0
> 
> 时间：2012-07-04T20:55:27.203
> 
> 标签：c#, android, iphone, asp.net, mobile

我开始构建一个网站，它将在客户端站点上使用 jquery 并使用 ajax 调用 aspx 处理程序或 Web 服务。问题是哪种架构将允许我在稍后将在 iPhone 或 Android 上开发的移动应用程序上使用相同的服务。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T22:02:54.913

我想说，只要您的 api 返回 xml 或 json，您就可以在任何平台上使用它，包括 iOS 和 Android。

查看新的 .net [Web API 框架](http://www.asp.net/web-api)，它提供了一种非常好的构建 HTTP 服务的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T22:05:23.200

我认为[Sencha Touch 可以满足](http://www.sencha.com/products/touch/)您的所有需求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T22:59:07.650

您将能够从 Android 或 iPhone 与用 asp.net / C# 编写的 Web 服务进行通信。

```
using System;
using System.Web.Script.Services;
using System.Web.Services;

[WebService(Namespace = "http://url.com")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
[ScriptService]
public class MyWebService : WebService
{
    [WebMethod]
    [ScriptMethod(ResponseFormat = ResponseFormat.Json)] // or ResponseFormat.Xml
    public ResponseObject MyWebMethod(RequestObject input)
    {
        ResponseObject response = new ResponseObject();
        // Do some stuff
        return response;
    }
} 
```

请注意，您需要确保您的请求/响应对象`[Serializable]`在您的代码中被标记。

# sqlite - android中的Sqlite数据库浏览器

> ID：11335365
> 
> 赞同：0
> 
> 时间：2012-07-04T20:55:58.133
> 
> 标签：sqlite

如何将**数据库附加到我在 sqlite 数据库浏览器中创建的活动中。我可以在 sqlite 数据库浏览器*中编写查询吗？它会在我的活动中运行吗*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-10T09:20:51.773

在以下链接中查看我的答案。我认为它将完全解决您的问题。

[填充 SQLite 数据库](https://stackoverflow.com/questions/19263028/populating-sqlite-database/19263302#19263302)

# mysql - 将 ElastiCache 与 RDS 结合使用以提高读/写性能

> ID：11335366
> 
> 赞同：6
> 
> 时间：2012-07-04T20:56:01.327
> 
> 标签：mysql, performance, amazon-ec2, amazon-elasticache

我在亚马逊上使用带有 MySQL 接口的 RDS。我的应用程序在 EC2 节点上运行并读取/更新数据库，但是读取和写入的次数太多，从而降低了性能。大多数情况下，连接数超过了允许的限制。我正在考虑使用 Elasticache 来提高性能，但是我没有在网上找到资源，如何配置数据库以有效地使用它。这是提高我的读/写性能的最佳方法吗？有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-04T23:15:01.280

您不能只是“打开”内存缓存。您需要编写与 memcache 交互的代码，以便将数据库查询结果缓存在 memcache 中。看看这个用户指南——我认为它会给你一个关于如何使用 memcache 的好主意：

[http://www.memcachier.com/documentation/memcache-user-guide/](http://www.memcachier.com/documentation/memcache-user-guide/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T14:07:30.613

性能与所用查询的类型和结构有关，因此可能存在一些优化空间。也许您可以提供有关所使用的确切查询的更多详细信息。但是，您可以从不同的角度解决这个问题 - 如果您有自动缩放功能，您可以在需要时简单地将数据库扩展到其他机器，这样即使没有任何性能优化也可以容纳无限数量的连接（当然，如果你优化它会提高性能）。这在 RDS 上是不可能的，但我知道在 EC2 上运行的至少还有两个其他云数据库提供商提供自动缩放 - [www.xeround.com](http://www.xeround.com)和[www.enterprisedb.com](http://www.enterprisedb.com)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-19T09:10:09.010

您可以使用 elasticache 作为 rds 数据库的二级缓存。如果您使用 java，则可以使用 hibernate-memcached 库。但是您仍然需要根据您的数据配置在二级缓存中缓存的方式和内容。

此外，您至少可以在 RDS 上使用只读副本来拆分读取流量。

（您使用的是什么实例类型，您是否看到它们具有不同的 i/o 容量？）

# c++ - Apache Xerces 预构建二进制文件中的 xerces-c_3_1.dll 和 xerces-c_3_1D.dll 有什么区别？

> ID：11335370
> 
> 赞同：0
> 
> 时间：2012-07-04T20:56:24.020
> 
> 标签：c++, xerces, xerces-c

apache xerces 预构建的 Windows 二进制文件中的 xerces-c_3_1.dll 和 xerces-c_3_1D.dll 有什么区别（来自[http://xerces.apache 的 xerces-c-3.1.1-x86-windows-vc-9.0.zip .org/xerces-c/download.cgi](http://xerces.apache.org/xerces-c/download.cgi)）？

（同样还有 xerces-c_3.lib vs xerces-c_3D.lib）

我认为它与不同的 xerces 构建选项有关，但我似乎找不到任何描述差异的文档。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T21:01:27.713

带有 D 后缀的构建是调试构建。从[构建说明](http://xerces.apache.org/xerces-c/build-3.html)：

> 在构建自己的应用程序时，您需要确保将应用程序与 xerces-c_3.lib（发布）和/或 xerces-c_3D.lib（调试）库（或它们的静态版本）链接，并且关联的 DLL 位于可执行文件/DLL 搜索路径 (PATH) 中的某个位置。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-07-22T06:28:20.440

我找到了解决方案。`TreeRoot`在将孩子添加到另一个位置之前，我没有正确地将其从其中移除。这是正确的线

`PDSTreeRootRemoveKid(*myRoot, pdsElem);` `PDSElementInsertKid(pdsDocElem,pdsElem,kPDSAfterLast);`

# ajax - 浏览器不区分通过 AJAX 获得的部分 HTML 和整个页面

> ID：11335379
> 
> 赞同：6
> 
> 时间：2012-07-04T20:56:55.463
> 
> 标签：ajax, http-headers, xmlhttprequest, browser-cache

我有一个可以通过 URL /products 访问的页面。当我在浏览器中访问它时，它会以布局中的完整页面进行响应。这是请求标头和响应正文的简化示例：

```
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8

<layout>
<products />
</layout> 
```

当用户进行一些搜索时，javascript 会通过 AJAX 更新结果。结果是在没有布局的情况下渲染的，因为渲染需要时间，而且我也不需要它：

```
Accept: */*;q=0.5, text/javascript, application/javascript, application/ecmascript, application/x-ecmascript
X-Requested-With: XMLHttpRequest

<products /> 
```

所以，在我添加缓存之前，这工作得很好`Cache-Control: private, max-age=3600`。最初我虽然会添加`Vary: X-Requested-With`标题，但浏览器会区分这两个响应。但是，当我通过 AJAX 获取 /products 然后在浏览器中访问 /products 时，它会显示部分 AJAX 响应。

有没有简单的方法来解决这个问题？

PS 如果这很重要，我正在使用 Ruby on Rails 和 jQuery。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T01:01:57.253

让您的 Ajax 调用使用不同的 URL，例如 /products/partial。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-12T22:06:57.633

Steve Luscher 的这篇[文章](http://steveluscher.com/archives/ajax-requests-x-requested-with-headers-and-unexpected-cache-contents)描述了一个类似的案例，这个问题比你描述的更间歇性。建议的解决方案是：

> 1.  在提交表单时取消所有 AJAX 请求
>     
>     
> 2.  根据您期望的响应使用不同的 URL

Steve 在 ajax 请求中使用 cancel() 获得了第一名。

你没有提到你用过什么浏览器，这里有一个浏览器相关的[问题](https://stackoverflow.com/questions/1130297/in-ie-the-x-requested-with-header-of-jquery-becomes-x-requested-with-lower)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-13T14:25:42.563

可能最简单的方法是将jquery的Ajax方法的'cache'参数设置为'False'。它会自动将时间戳附加到 URI 以防止它被缓存。

这可以使用以下代码段在应用程序范围内完成：

```
$.ajaxSetup({
    cache: false
}); 
```

如果缓存对于动态请求也很重要，您可以根据日期和小时自行生成时间戳。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-13T09:26:31.903

使用`Vary: Accept`. 这应该有效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-14T00:25:17.503

尝试发送 must-revalidate 而不是 private （更适合代理）。

```
Cache-Control: max-age=3600, must-revalidate 
```

我建议阅读这篇文章：[http](http://www.mnot.net/cache_docs/) ://www.mnot.net/cache_docs/它可能会有所帮助。并且还使用 Mark 的工具[http://redbot.org/](http://redbot.org/)来测试您的结果以消除您的本地机器或 isp 或其他什么。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-10T16:29:10.487

对于部分结果，您应该有一个不同的 url（即 ?partial=yes 或类似的东西......）

或者

您可以通过 ajax 获取整个页面并使用 jquery.load() 仅提取您想要的部分。

```
$("#productsContainerHolder").load("/my/products/url #productsContainer", { myParam: "beer", myParam2: "cold"}); 
```

$.load 将使用“GET”方法调用您的服务器，检索所有内容，从那里提取#productsContainer 并插入“#productsContainerHolder”

```
<div id="productsContainerHolder">
    <div id="productsContainer>
         ...
    </div>
</div> 
```

# python - Python 3 项目初始化/原型设计

> ID：11335380
> 
> 赞同：7
> 
> 时间：2012-07-04T20:56:57.890
> 
> 标签：python, python-3.x

我正在寻找原型的正确方法，启动一个 Python 项目。

*   [PasteScript](http://pythonpaste.org/script/)尚未更新到 Python 3。
*   [Skeleton](http://pypi.python.org/pypi/skeleton/)可用于 3.1，但在过去两年中一直没有维护。
*   [分步指南](http://foobar.lu/wp/2012/05/13/a-comprehensive-step-through-python-packaging-a-k-a-setup-scripts/)提供了手动创建打包项目结构的信息。
*   [搭便车者的包装指南](http://guide.python-distribute.org/index.html)

是否有任何新的候选人可以启动项目并填充项目所需的所有文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T19:43:31.740

不完全是我想要的，但它会完成这项工作。

*   [项目骨架](http://learnpythonthehardway.org/book/ex46.html)
*   [另一个](https://github.com/fcurella/python-package-skeleton)在 Github 上下载的项目框架。
*   [如何打包你的 Python 代码](http://www.scotttorborg.com/python-packaging/)

添加新信息

*   [Cookiecutter](https://github.com/audreyr/cookiecutter)似乎正是初始化和启动项目所需要的。请参阅[解释它的博客文章](http://pydanny.com/cookie-project-templates-made-easy.html)。
*   [用于图书馆的 Cookiecutter](https://github.com/ionelmc/cookiecutter-pylibrary)

# java - Spring MVC 和“魔术字符串”返回类型

> ID：11335387
> 
> 赞同：1
> 
> 时间：2012-07-04T20:57:58.880
> 
> 标签：java, spring, spring-mvc

在控制器请求方法结束时，我们通常会执行以下操作：

```
modelAndView.setViewName("welcomePage");
return modelAndView; 
```

或者

```
return "welcomePage"; 
```

尽管这种方式简单高效，但我是唯一一个发现这些“魔术字符串”错误的人吗？

同一个“welcomePage”字符串可以在同一个类或其他类中多次使用，从而打破了“不要重复自己”的原则。此外，如果我碰巧重命名了“welcomePage.jsp”，我将不得不将项目中所有出现的“welcomePage”全部替换掉​​。

想到的第一个解决方案是将这些（可能是共享的）字符串转换为（可能是集中的）常量或枚举。但我不确定这是使用 Spring MVC 的方式。

您如何看待这些“魔术字符串”？Spring MVC 是否允许以更简洁的方式返回视图？如果没有，您会推荐什么解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T21:24:16.373

1) 当我意识到我对代码中的字符串的厌恶是基于我作为本科生从 EMACS 是所有 IDE 的巅峰之作的人那里学到的东西时，我克服了它。AppConstants.ViewNames.WELCOME_PAGE 真的比“welcomePage”好吗？它的意图很明显，很容易理解。大多数时候，当我看到人们坚持每个字符串不止一次使用时，它们都是常量，常量名称与字符串名称非常接近，因此代码是有意义的，如果你确实改变了，它不会产生任何影响除非您也更改常量名称，否则有意义。/rantoff 在现代 IDE 中更改它需要 15 秒。

2) 视图解析器可以使用 WEB-INF/jsp/welcomePage.jsp（或您设置的任何内容）自动呈现 /welcomePage.htm。除非您要呈现名称与 URL 路径中请求的 html 文档不匹配的 JSP，否则没有理由专门按名称指定视图。

3) 构建您的页面以利用上面的#2，并且不需要指定显式的视图名称。

# java - Java和数据库中的多线程

> ID：11335392
> 
> 赞同：1
> 
> 时间：2012-07-04T20:58:26.467
> 
> 标签：java, mysql, multithreading

我有一个简单的程序。主要思想是我有一个存储在 MySQL 数据库中的名称列表，我想同时对这些名称执行一些操作，但是当然，每个线程应该以单独的名称工作。下一个线程应该使用前一个线程采用的下一个名称。我创建了线程池，在循环内创建了新线程，然后执行可运行的，以便执行对该名称的操作。在此示例中，该操作正在打印从 DB 中选择的名称。该程序正在从数据库中跳过一些名字，并将姓氏重复 6 次。我的程序有什么问题？我还是新手，请原谅我的错误。

这是主要功能：

```
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

public class Main {

    public static volatile ResultSet resultSet = null;
    private static Statement statement = null;

    public static void main(String[] args) throws SQLException 

    {
        DBConnection.ConnectDB(); //connect to database

          statement = DBConnection.con.createStatement();
          resultSet = statement.executeQuery("select Name from schema.table1"); //select statement

          String name = null;

           // create ExecutorService to manage threads 
          ExecutorService threadExecutor = Executors.newFixedThreadPool(3 );

          // create and name each runnable  
          while(resultSet.next()) 
             {
                 name=resultSet.getString("Name");
                 MyRunnable task1 = new  MyRunnable( name);
                 threadExecutor.execute( task1 );
          }

        // This will make the executor accept no new threads
        // and finish all existing threads in the queue

             threadExecutor.shutdown();
        // Wait until all threads are finish
        while (! threadExecutor.isTerminated()) {

        }
        System.out.println("Finished all threads");
    }
} 
```

和 MyRunnable 类：

```
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

import com.mysql.jdbc.exceptions.MySQLIntegrityConstraintViolationException;

public class MyRunnable implements Runnable{
private static String nn;

MyRunnable (String ss)  { synchronized (this) { 
    this.nn=ss;
}
}

public void run() 
{

    System.out.println("hello "+ nn);
}
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-04T21:03:37.757

这当然是一个问题。去除静电。

```
private static String nn; 
```

变成

```
private String nn; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T23:40:43.823

作为旁注，这个块：

```
while (! threadExecutor.isTerminated()) {
} 
```

应该读：

```
while (! threadExecutor.isTerminated()) {
   try {
       threadExecutor.awaitTermination(1, TimeUnit.SECOND);
   }
   catch (InterruptedException e) {
        // you have to determine if someone can interrupt your wait
        // for the full termination of the executor, but most likely,
        // you'll do nothing here and swallow the exception, or rethrow
        // it in a RuntimeException
   }
} 
```

你永远不应该像现在这样忙着等待。您将使用不必要的 CPU 周期，并占用池中实际线程的处理时间。

# ruby-on-rails-3 - 删除链接转到显示方法

> ID：11335393
> 
> 赞同：6
> 
> 时间：2012-07-04T20:58:35.343
> 
> 标签：ruby-on-rails-3

我正在使用Rails 3，我有一个带有方法的link_to：delete，但是当我单击此链接时，它会转到显示操作而不是销毁操作。

我的问题是如何解决这个问题？

提前致谢。

代码：`<%= link_to 'Delete', list_path(@list.id), :method => :delete, :confirm => 'Are you sure?' %>`

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-04T21:08:05.023

您的文件中没有包含`jquery`和`jquery_ujs`库`application.js`，或者您甚至没有将`application.js`文件包含在`app/views/layouts/application.html.erb`. 这通常通过以下行完成：

```
<%= javascript_include_tag "application" %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-26T10:53:35.640

你好，你可以试试这个：

应用程序.html.erb：

```
<%= javascript_include_tag "http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js", "jquery.rails.js" %> 
```

你的链接代码应该是这样的：

```
<%= link_to "<i class='icon-trash'></i> Delete".html_safe, item, :confirm => "Are you sure you want to delete item: " + item.name + "?" ,:method => :delete%> 
```

你的控制器应该是这样的：

```
def destroy
 @item = Item.find(params[:id])
 if @item.destroy
  redirect_to items_path, :notice => "Successfully deleted an item."
 else 
  redirect_to items_path, :notice => "Failed to delete an item."
 end
end 
```

# c - 打开文件 O_NONBLOCKING 在内核模块中丢失

> ID：11335398
> 
> 赞同：4
> 
> 时间：2012-07-04T20:59:14.177
> 
> 标签：c, file-io, blocking, kernel-module

我在我的 C 程序中打开一个文件：

```
pcm->dfd = open(fname, O_RDONLY|O_NONBLOCK); 
```

后来打电话`select()`就`read()`可以了。

但我的问题是，`O_NONBLOCK`迷路了：

```
ssize_t my_read(struct file *filp, char __user *user_buffer, size_t bytes_requested, loff_t *capture_ptr) {

    if (filp->f_flags & O_NONBLOCK){
        LOGI("mode: O_NONBLOCK");
    }
    else{
        LOGI("mode: BLOCKING"); // <-- this is printed      
    }
    ..
} 
```

我也试过

```
pcm->dfd=open(fname, O_RDONLY|O_NONBLOCK);

// O_NONBLOCK does not work :/
int flags = fcntl(pcm->dfd, F_GETFL, 0);
fcntl(pcm->dfd, F_SETFL, flags | O_NONBLOCK); 
```

这不是日志记录问题，驱动程序的行为也与阻塞模式相同。

任何人的想法？

编辑：

从打开的文件中读取的代码非常简单：

```
size=read(pcm->dfd,inBuffer,inBufferBytes); 
```

我还检查了程序是否有`fcntl()`其他人，但没有..

编辑2：

有没有可能，`O_NONBLOCK`我的用户程序（Android NDK）中的值比内核中的值不同？我`O_NONBLOCK`在内核头文件中搜索，已经有 2 个不同的定义。

我还检查了`open`内核模块中的 -implementation 并且`filp->f_flags`已经**没有** `O_NONBLOCK`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-19T16:15:04.623

根据[open(2) man-page](http://www.freebsd.org/cgi/man.cgi?query=open&sektion=2)，传递`O_NONBLOCK`只会使`open`调用本身非阻塞（您可能不想要）。这并不意味着打开的文件描述符也将处于非阻塞模式——您必须在打开后使用 fcntl() 进行设置。

# java - 如何在java中按下按钮时更改按钮的颜色

> ID：11335399
> 
> 赞同：1
> 
> 时间：2012-07-04T20:59:18.157
> 
> 标签：java, swing, jbutton, foreground, jtogglebutton

我有大约 50 个按钮。有些是绿色的（选中），有些是灰色的（取消选中）。如果我按下绿色按钮，它们应该将颜色变为红色，再次按下时会变回绿色。如果我按下灰色按钮，它们应该将颜色更改为绿色，再次按下时会变回灰色。所有按钮都有一些黑色文本。按下按钮时，文本的颜色保持不变。建议相同的解决方案或教程...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-04T21:02:32.267

不要为此使用 JButton，而是使用 JToggleButton。考虑为他们的状态提供 ImageIcons。

# php - 每 3 项和 4 项交替

> ID：11335401
> 
> 赞同：0
> 
> 时间：2012-07-04T20:59:31.943
> 
> 标签：php, javascript, jquery, node.js

我在一个数组中有许多项目，比如超过 14 个项目。

如何以这种方式将它们分成 2 个不同的组：前 3 个（#1,2,3）将在数组 A 中，接下来的 4 个（#4,5,6,7）将在数组 B 中，接下来 3 (#8,9,10) 将在数组 A 中，接下来的 4 (#11,12,13,14) 将在数组 B 中，依此类推。

我尝试使用模数，但在进行到一半时，我意识到因子为 3 和 4 的数字将无法通过使用模数来区分。

*我为此使用 Javascript/PHP，但任何类似的语言都可以*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T21:04:13.143

我会将模数 7 与小于 3 的检查配对......像这样（php）：

```
for($i = 0; $i < count($array); $i++) {
  if($i%7 < 3) {
    $sortA[] = $array[$i];
  } else {
    $sortB[] = $array[$i];
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T21:07:02.750

对于 JavaScript：

```
var array1 = [];
var array2 = [];
for (var i=0; i< input.length; i++) {
    if (i % 7 < 3) 
        array1.push(input[i]);
    else
        array2.push(input[i]);
} 
```

# javascript - 嵌套 For 循环以重置无线电组

> ID：11335402
> 
> 赞同：0
> 
> 时间：2012-07-04T20:59:46.653
> 
> 标签：javascript, html

我找到了重置单选按钮的解决方案。

下一个示例适用于 4 个无线电组：

```
<script type="text/javascript">
function uncheckRadio()
{   
    for(x=0; x<document.QuizForm.Q01.length; x++){document.QuizForm.Q01[x].checked = false;}
    for(x=0; x<document.QuizForm.Q02.length; x++){document.QuizForm.Q02[x].checked = false;}
    for(x=0; x<document.QuizForm.Q03.length; x++){document.QuizForm.Q03[x].checked = false;}
    for(x=0; x<document.QuizForm.Q04.length; x++){document.QuizForm.Q04[x].checked = false;}
}   

</script> 
```

但现在我想通过应用嵌套循环从 01 迭代到 80，以一种（多选）形式重置 80 个无线电组。

尝试了几种使用嵌套循环的方法，但不知何故我找不到让 Q01、Q02 等迭代工作的方法......

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T21:30:45.320

在支持标准的浏览器中，您可以使用[querySelectorAll](https://developer.mozilla.org/en/DOM/Document.querySelectorAll)，如果您确定没有其他具有`name`以“Q”开头的属性的收音机：

```
var radios = document.QuizForm.querySelectorAll("input[type=radio][name^=Q]:checked");

for (var l = radios.length; l > 0;)
  radios[--l].checked = false; 
```

否则，您可以使用方括号表示法：

```
var elements = document.QuizForm.elements;
var prefix;

for (var l = 80; l > 1; l--) {
  prefix = l < 10 ? "Q0" : "Q";
  elements[prefix + l].checked = false;
} 
```

# c# - 如何使表/列名的大写与 PetaPoco 和 PostgreSQL 无关？

> ID：11335403
> 
> 赞同：3
> 
> 时间：2012-07-04T20:59:55.357
> 
> 标签：c#, postgresql, petapoco

我的模型看起来像这样...

```
[PrimaryKey("TaskId")]
public class Task
{
    public int TaskId { get; set; }

    [StringLength(1000)]
    [DisplayName("What do you want to do?")]
    public string Description { get; set; }

    [DisplayName("When do you want it done?")]
    [DisplayFormat(DataFormatString = "{0:MM/dd/yyyy}", ApplyFormatInEditMode = false)]
    [DataType(DataType.Date)]
    public DateTime CompleteByDate { get; set; }

    public bool IsCompleted { get; set; }

    public DateTime InsertDate { get; set; }
    public DateTime UpdateDate { get; set; }
} 
```

如果我尝试从 Task 表中获取数据，我将看到的第一个错误是...

```
ERROR: 42P01: relation "Task" does not exist 
```

据我所知，问题是 PetaPoco 生成这样的 sql ......

```
SELECT "Task"."TaskId", "Task"."Description", "Task"."CompleteByDate", "Task"."IsCompleted", "Task"."InsertDate", "Task"."UpdateDate" FROM "Task" 
```

因此，对于引号，大写很重要，并且在 DB 中，如果将列名放在引号中，则只能以全部小写形式识别列名。我想知道是否有办法改变这种情况。我目前看到的唯一解决方法是让我的模型看起来像这样（注意大小写更改）......

```
[PrimaryKey("taskid")]
[TableName("task")]
public class Task
{
    [Column("taskid")]
    public int taskid { get; set; }

    [StringLength(1000)]
    [DisplayName("What do you want to do?")]
    public string description { get; set; }

    [DisplayName("When do you want it done?")]
    [DisplayFormat(DataFormatString = "{0:MM/dd/yyyy}", ApplyFormatInEditMode = false)]
    [DataType(DataType.Date)]
    public DateTime completebydate { get; set; }
    public bool iscompleted { get; set; }
    public DateTime insertdate { get; set; }
    public DateTime updatedate { get; set; }
} 
```

我不希望我的属性都是小写的。为什么我必须这样做，这是唯一的解决方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T22:40:56.457

Petapoco 需要确切的（区分大小写的）名称来匹配列，但是如果您指定`Column`属性，您可以按照您想要的方式释放属性名称（包括更改名称）

```
[Column("taskid")]
public int TaskID { get; set; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T21:26:40.307

如果 PetaPoco（不管是什么）一直生成带引号的标识符，你会没事的。如果它从不生成带引号的标识符，你会没事的。如果它有时而不是其他情况，则需要提交错误报告。

在您等待错误修复时，快速编辑宏/Perl 应该可以帮助您重命名列名等。看起来选择确实使用带引号的标识符，因此只需重命名表定义即可。

哦，当您需要执行任何手动 SQL 或与其他系统互操作时，您会发现 CamelCased 标识符完全是一件痛苦的事。

# asp.net-mvc - MVC 向导如何保存临时结果

> ID：11335404
> 
> 赞同：1
> 
> 时间：2012-07-04T20:59:58.280
> 
> 标签：asp.net-mvc

我正在开发这个非常重要的松鼠应用程序。

有一个向导可以将松鼠添加到数据库中。

所以说这个向导有三个屏幕：

```
 1.Squirrel name details
 2.Height and weight
 3.Nut storage 
```

我想要做的是在步骤 3 添加所有详细信息后保存向导的结果。

然而，用户想要这个“保存以稍后继续”按钮。因此，在屏幕 1 和 2 上，他们希望能够保存他们目前输入的数据，并在稍后返回并完成它。

问题是松鼠的身高和体重是必填字段，所以我必须在数据库中将它们设为空才能在步骤 1 中保存。

处理这个问题的最佳方法是什么？

我可以：

1.  使这些字段可以为空，并在数据库中的 squirrel 表上具有类似于挂起完成标志的东西。

不是这个的忠实粉丝，它似乎违背了最佳实践。

1.  以某种方式将不完整的松鼠存储在其他地方，直到它们完全完成并准备好保存到数据库中。

不确定不完整的松鼠可以存放在哪里。

肯定还有其他选择。

有人有什么好的建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T21:22:22.397

数据库中的 isValidated 标志似乎是一个好方法。您可以在每一步添加越来越多的列来丰富记录，并在用户完成向导的最后一步将标志设置为 true 以指示用户已完成编辑此记录。宽度和高度列可能确实必须在数据库中设置为可为空，因为在事务完全完成之前，它们可以包含空值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T22:03:39.800

根据您的数据有多大，您可以使用[HTML5 Storage](https://developers.google.com/web-toolkit/doc/latest/DevGuideHtml5Storage)。这意味着您只需要在推送数据时调用数据库，这反过来应该会提高性能，因为一切都发生在客户端。

# android - 了解 Android API 级别

> ID：11335406
> 
> 赞同：2
> 
> 时间：2012-07-04T21:00:02.657
> 
> 标签：android, android-api-levels

Jelly Bean 已经问世，它们有一些非常不错的功能。我的问题是，我想针对尽可能多的设备，但同时有一个应用程序，如果可能的话，可以使用最高 API 级别的所有功能。

所以比如说我有这个

```
<uses-sdk android:minSdkVersion="5" android:targetSdkVersion="16"/> 
```

我在 API 16 上构建了我的应用程序。有没有办法限制代码的某些部分只在运行能够运行它的设备时运行？例如，如果我想要 NFC，那么只有姜饼及以上设备可以使用该功能，否则 froyo down 甚至看不到该功能。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-04T21:09:57.553

基本上，您可以使用从 Android 3.0 引入的许多新 API（例如 Fragment 引擎），包括作为引用库的 Android Support v4。

你可以在这里找到一些参考：

[http://developer.android.com/reference/android/support/v4/app/package-summary.html](http://developer.android.com/reference/android/support/v4/app/package-summary.html)

和这里：

[http://developer.android.com/tools/extras/support-library.html](http://developer.android.com/tools/extras/support-library.html)

另一方面，如果你想使用 NFC 功能，你可以声明这个使用功能：

```
 <uses-feature android:name="android.hardware.nfc" android:required="true" /> 
```

或者，如果您想为不支持此功能的设备提供代码替代方案，您可以执行以下操作：

```
 if (getPackageManager().hasSystemFeature(PackageManager.FEATURE_NFC)) {
        //code for devices with NFC support
 } else {
      //code for others devices
 } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T21:36:42.833

从 ADT r16 开始，我们可以使用 Lint 扫描并检查所有新 API 的项目，请[在此处](https://stackoverflow.com/questions/11321257/if-i-write-an-app-using-android-4-platform-will-the-app-work-in-android-2-devic/11322273#11322273)查看我的答案以获取详细信息：

> NewApi：查找对并非所有目标 API 版本都支持的 API 的 API 访问。

或者，您也可以按 API 级别对代码进行条件分支，而不是按功能（Stefano 的回答）对代码进行条件分支：

```
if (android.os.Build.VERSION.SDK_INT >= 9) {
  // do NFC stuff
} 
```

希望这可以帮助。

# perl - 如何使用 Perl 的 XML::Twig 选择兄弟姐妹（xpath 语法）？

> ID：11335407
> 
> 赞同：2
> 
> 时间：2012-07-04T21:00:06.873
> 
> 标签：perl, xpath, xml-parsing, twig, xml-twig

我需要通过**next_sibling**或**first_elt**选择下一个节点。但我想按节点名称过滤（包含字符串**"TON"**）

```
first_elt ('HILTON[@method]' or 'SHERATON[@method]'); 
```

或者

```
next_sibling ('HILTON[@method]' or 'SHERATON[@method]'); 
```

或者

```
next_sibling ('TON[@method]'); 
```

我试过的例子（不工作）：

```
#!/usr/bin/perl -w
use warnings;
use XML::Twig;
$t-> parsefile ('file.xml');

my $Y0=$t->first_elt('HILTON[@method]' or 'SHERATON[@method]'); 
```

它只会处理'HILTON [@method]'

```
my $Y0=$t->first_elt('/*TON[@method]'); 
```

C:/strawberry/perl/site/lib/XML/Twig.pm 第 3523 行的错误导航条件 '/*TON[@method]' ()

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T05:04:42.390

由于这超出了 XML::Twig 支持的 XPath 子集，因此您必须使用自定义过滤器，将代码传递给`first_elt`：

```
$t->first_elt( sub {  $_[0]->tag=~ m{TON$} && $_[0]->att( 'method') }) 
```

这将返回 sub 返回真值的第一个元素。

不过，对这种表达的需求有点令人不安。在您的示例中，您通过其名称以 TON 结尾的事实来定义一类元素。当你有一个 CARLTON 元素时会发生什么？或者当 MARRIOTT 元素需要与 SHERATON 和 HILTON 一起处理时？你需要重写你的查询吗？

如果您是设计数据格式的人，我建议您修改格式。HILTON 和 SHERATON 应该是 HOTEL、BRAND 或 OWNER 标签的属性。也许一个额外的属性会很有用，以标记这两种类型应该被类似地处理。只有当它是数据固有的属性时，此属性才有意义。

如果数据是这样的并且您对其格式没有输入，那么我将有一个标签列表来处理并检查这些：

```
my %TAGS_TO_PROCESS= map { $_ => 1 } qw( HILTON SHERATON);
my $elt= $t->first_elt( sub {  $TAGS_TO_PROCESS{$_[0]->tag} && $_[0]->att( 'method') }) 
```

这样添加/减去其他标签很容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T21:31:48.253

**使用**：

```
*[substring(name(), string-length(name()) - 2) = 'TON'][@method][1] 
```

**说明**：

此表达式对 XPath 2.0 标准函数使用 XPath 1.0 等效项`ends-with()`：

**XPath 2.0 表达式的 XPath 1.0 等效项：**

```
ends-with($s, $s2) 
```

**是**：

```
substring($s, string-lenth() - string-length($s2) + 1) = $s2 
```

在最后一个表达式中，我们`$s`用`name()`和`$s2`替换`'TON'`

**基于 XSLT 的验证**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="/*">
     <xsl:copy-of select=
     "*[substring(name(), string-length(name()) - 2) = 'TON'][@method] "/>
==========  
     <xsl:copy-of select=
     "*[substring(name(), string-length(name()) - 2) = 'TON'][@method][1] "/>
 </xsl:template>
</xsl:stylesheet> 
```

**应用于此 XML 文档时：**

```
<t>
 <HILTON method="buy"/>
 <TON method="burn"/>
 <TONIC method="drink"/>
 <HILTON nomethod="yes"/>
 <SHERATON/>
 <SHERATON method="visit"/>
</t> 
```

**转换计算两个 XPath 表达式，并将选定的节点复制到输出**：

```
<HILTON method="buy"/>
<TON method="burn"/>
<SHERATON method="visit"/>
==========  
     <HILTON method="buy"/> 
```

第一个表达式选择所有元素 - 上下文节点的子节点，其名称以“TON”结尾并且也具有`method`属性。

第二个表达式从第一个表达式选择的节点中选择第一个节点。

# database-design - web2py中的多对多关系

> ID：11335410
> 
> 赞同：3
> 
> 时间：2012-07-04T21:00:38.407
> 
> 标签：database-design, many-to-many, relational-database, relationship, web2py

我的 web2py 项目中有一张与此类似的文章表：

```
db.define_table('articles',
                Field('created_on', 'datetime', default = datetime.today(),
                      required = True, notnull = True,
                      requires = [IS_NOT_EMPTY(),
                                  IS_DATETIME(format=T('%Y-%m-%d %H:%M:%S'))]),
                Field('article_en', 'text', required = True,
                      notnull = True, requires = IS_NOT_EMPTY())) 
```

另一个跟踪上传的文件：

```
db.define_table('files',
                Field('filename', 'string', required = True, notnull = True),
                Field('uploaded_data', 'upload', autodelete = True,
                      required = True, notnull = True, requires = IS_NOT_EMPTY()),
                Field('created_on', 'datetime', required = True, notnull = True)) 
```

现在我想为文章使用的每个文件提供参考，以及文件所属的每篇文章的参考。我需要这个，这样我就可以轻松删除未使用的文件，而不会因为被忽视的关系而弄乱文章的危险。

更直接地说，这种关系非常接近：每篇文章都有几个文件，每个文件都链接到不同的文章。

根据我从 web2py 书中收集到的信息，没有直接支持多对多关系。为了解决这个问题，一个简单的解决方法是使用一个中间表来处理关系，但显然我不是数据库专家，所以我几乎不知道我应该怎么做。

一些帮助将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T00:44:40.563

web2py 确实支持[多对多关系](http://web2py.com/books/default/chapter/29/6#Many-to-many)。为此，您可以定义一个链接其他两个表的中间表：

```
db.define_table('article_files',
    Field('article', db.articles),
    Field('file', db.files)) 
```

这不是一种解决方法，而是在 RDBMS 中处理此类关系的标准方法。注意，web2py 使用数据库抽象层 (DAL)，而不是 ORM。ORM 通常不需要您显式定义中间表，尽管它仍会在幕后创建一个。

您也可以考虑使用[list:reference](http://web2py.com/books/default/chapter/29/6#Many-to-many,-list%3a%3Ctype%3E,-and-contains)字段。

# c# - 在多个属性上调用 .Sum() 的有效方法

> ID：11335418
> 
> 赞同：9
> 
> 时间：2012-07-04T21:01:33.780
> 
> 标签：c#, linq, iqueryable

我有一个使用 Linq 从数据库中获取数据的函数，然后我在另一个函数中调用该函数以使用 .Sum 对每个单独的属性求和所有单独的属性。我想知道是否有一种有效的方法可以一次汇总所有属性，而不是在每个单独的属性上调用 .Sum() 。我认为我现在的做法非常缓慢（尽管未经测试）。

```
public OminitureStats GetAvgOmnitureData(int? fnsId, int dateRange)
    {
        IQueryable<OminitureStats> query = GetOmnitureDataAsQueryable(fnsId, dateRange);

        int pageViews = query.Sum(q => q.PageViews);
        int monthlyUniqueVisitors = query.Sum(q => q.MonthlyUniqueVisitors);
        int visits = query.Sum(q => q.Visits);
        double pagesPerVisit = (double)query.Sum(q => q.PagesPerVisit);
        double bounceRate = (double)query.Sum(q => q.BounceRate);

        return new OminitureStats(pageViews, monthlyUniqueVisitors, visits, bounceRate, pagesPerVisit);
    } 
```

**编辑**

```
private IQueryable<OminitureStats> GetOmnitureDataAsQueryable(int? fnsId, int dateRange)
    {
        var yesterday = DateTime.Today.AddDays(-1);
        var nDays = yesterday.AddDays(-dateRange);

        if (fnsId.HasValue)
        {
            IQueryable<OminitureStats> query = from o in lhDB.omniture_stats
                                               where o.fns_id == fnsId
                                                     && o.date <= yesterday
                                                     && o.date > nDays
                                               select new OminitureStats ( 
                                                   o.page_views.GetValueOrDefault(), 
                                                   o.monthly_unique.GetValueOrDefault(),
                                                   o.visits.GetValueOrDefault(),
                                                   (double)o.bounce_rate.GetValueOrDefault()
                                               );
            return query;
        }
        return null;
    } 
```

**编辑：**

```
public class OminitureStats
    {
        public OminitureStats(int PageViews, int MonthlyUniqueVisitors, int Visits, double BounceRate)
        {
            this.PageViews = PageViews;
            this.MonthlyUniqueVisitors = MonthlyUniqueVisitors;
            this.Visits = Visits;
            this.BounceRate = BounceRate;
            this.PagesPerVisit = Math.Round((double)(PageViews / Visits), 1);
        }

        public OminitureStats(int PageViews, int MonthlyUniqueVisitors, int Visits, double BounceRate, double PagesPerVisit)
        {
            this.PageViews = PageViews;
            this.MonthlyUniqueVisitors = MonthlyUniqueVisitors;
            this.Visits = Visits;
            this.BounceRate = BounceRate;
            this.PagesPerVisit = PagesPerVisit;
        }

        public int PageViews { get; set; }
        public int MonthlyUniqueVisitors { get; set; }
        public int Visits { get; set; }
        public double PagesPerVisit { get; set; }
        public double BounceRate { get; set; }
    } 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-04T21:10:22.963

IIRC，您可以一次性完成所有总和（只要将查询转换为 SQL）

```
var sums = query.GroupBy(q => 1)
                .Select(g => new
                {
                    PageViews = g.Sum(q => q.PageViews),
                    Visits = g.Sum(q => q.Visits),
                    // etc etc
                })
                .Single(); 
```

这将为您提供一个对象，其中包含所有总和作为单独的属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T05:24:46.113

我发现它为什么会抛出`NotSupportedException`. 我了解到`Linq to Entity`不支持带参数的构造函数，因此删除了构造函数并在我的查询中进行了更改。我是一个新手 C# 程序员，所以如果我的解决方案可以改进，请告诉我，但到目前为止它工作正常。

```
public class OminitureStats
{
    public int PageViews { get; set; }
    public int MonthlyUniqueVisitors { get; set; }
    public int Visits { get; set; }
    public double PagesPerVisit { get; set; }
    public double BounceRate { get; set; }
}

private IQueryable<OminitureStats> GetOmnitureDataAsQueryable(int? fnsId, int dateRange)
{
    var yesterday = DateTime.Today.AddDays(-1);
    var nDays = yesterday.AddDays(-dateRange);

    if (fnsId.HasValue)
    {
        IQueryable<OminitureStats> query = from o in lhDB.omniture_stats
                                           where o.fns_id == fnsId
                                                 && o.date <= yesterday
                                                 && o.date > nDays
                                           select new OminitureStats() { 
                                               o.page_views.GetValueOrDefault(), 
                                               o.monthly_unique.GetValueOrDefault(),
                                               o.visits.GetValueOrDefault(),
                                               (double)o.bounce_rate.GetValueOrDefault()
                                           };
        return query;
    }
    return null;
} 
```

# python - 如何触发scrapy spider启动和关闭？

> ID：11335419
> 
> 赞同：-2
> 
> 时间：2012-07-04T21:01:37.057
> 
> 标签：python, scrapy

我想在蜘蛛启动后写入数据库（start_time），并希望存储所有通过电子邮件发送到数据库的统计信息。那么我该怎么做呢？

我应该写中间件吗，如果是这样，我怎么能触发蜘蛛开始和结束？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-06T12:16:47.853

这是我想出的，如下所述创建我自己的扩展：http: [//doc.scrapy.org/en/latest/topics/extensions.html#writing-your-own-extension](http://doc.scrapy.org/en/latest/topics/extensions.html#writing-your-own-extension)

顺便说一句，我不知道在哪里保存文件，所以我尝试将其命名为 myextension.py 并使用类 MyExtension 并保存在我的项目文件夹中。然后在设置文件（settings.py）中调用它如下：

```
EXTENSIONS = {
    'project_name.myextension.MyExtension': 1000,
} 
```

# django - Django - 多个配置文件

> ID：11335422
> 
> 赞同：0
> 
> 时间：2012-07-04T21:01:48.367
> 
> 标签：django, django-signals, django-profiles

在我的项目中，我有两种不同类型的用户：教师和学生，每个用户都有自己的个人资料数据。

在寻找最佳方法之后，似乎前进的方法是使用多表继承：

```
class BaseProfile(models.Model):
    user = models.OneToOneField(User)
    profile = models.CharField (max_length=10, choices={'teacher', 'student'})
    # other common fields

class Teacher(BaseProfile):
    # teacher specific fields

class Student(BaseProfile):
    # student specific fields 
```

在`settings.py`: `AUTH_PROFILE_MODULE`= `myapp.BaseProfile`。

现在我想实现与 django-profiles 中相同的功能：

*   创建配置文件
*   编辑个人资料
*   显示配置文件

当我在 of 中有正确的值时，我很清楚如何进行编辑和显示`field profile`部分`BaseProfile`。

问题：

现在，我希望在使用信号创建用户时直接自动完成配置文件的创建（并且在正确的 db:`Teacher`或中）。当用户通过注册表单通过站点注册时，`Student`该字段应包含值“学生”。`profile`当管理员通过管理界面创建新用户时，该值应为“教师”。

任何人都知道我怎么能做到这一点？可能我需要编写一个自定义信号，如下所示，并从用户模型发送它，但还没有找到可行的解决方案：

```
def create_user_profile(sender, instance, request, **kwargs):
    if request.user.is_staff:
        BaseProfile(user=instance, profile='teacher').save()
    else:
        BaseProfile(user=instance, profile='student').save() 
```

当然也欢迎其他更好的方法！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T06:09:00.970

在我看来，这不是一个好方法。

我建议做 1 个统一配置文件，其中包含一个选项： user_type = models.CharField(choices=[your_choices], max_length=4)

然后在模型中，您将创建两种形式 - 一种用于教师，一种用于学生。

```
class ProfileFOrm(forms.ModelForm):
    def __init__(self, *args, **kwargs):
        super(BaseProfileForm, self).__init__(*args, **kwargs)
        for name in self.fields:
            self.fields[name].required = True

class TeacherProfile(ProfileForm):
    class Meta:
        model = Profile
        fields = ('your_fields')

class StudentProfile(ProfileForm):
    class Meta:
        model = Profile
        fields = ('school') 
```

这只是我的想法:)

* * *

已编辑

简介版：

看法。

```
def profile(request):
p = get_objects_or_404(ProfileModel, user=request.user)
return TemplateResponse(request, 'template.html', {'profile': p}) 
```

在模型中，我们需要一个函数来检查用户是学生还是老师，所以：

```
class Profile(models.Model):
    ... your fields here...
    def get_student(self):
        return self.user_type == 1 
```

在模板中：

```
{% if profile.get_student%}

>>>>get all data for students ex: <<<<
{{profile.name}}

{% endif %}

{% if profile.get_teacher %}
.... 
```

# mysql - 带有额外选择的 Django 查询集计数

> ID：11335423
> 
> 赞同：3
> 
> 时间：2012-07-04T21:01:59.430
> 
> 标签：mysql, django, django-queryset

我有一个带有 PointField 用于位置坐标的模型。我有一个 MySQL 函数，可以计算两点之间的距离，称为**dist**。我使用额外（）“选择”来计算查询集中每个返回对象的距离。我还使用 extra() "where" 来过滤特定范围内的那些对象。像这样

```
query = queryset.extra(
    select={
        "distance":"dist(geomfromtext('%s'),geomfromtext('%s'))"%(loc1, loc2)
    },
    where=["1 having `distance` <= %s"%(km)]
) #simplified example 
```

这适用于获取和读取结果，除非我尝试计算结果集时出现错误，即**'distance' is not a field**。在进一步探索之后，似乎 count 忽略了 extra 中的“select”，而只使用了“where”。完整的 SQL 查询如下所示：

```
SELECT (dist(geomfromtext('POINT (-4.6858300000000003 36.5154300000000021)'),geomfromtext('POINT (-4.8858300000000003 36.5154300000000021)'))) AS `distance`, `testmodel`.`id`, `testmodel`.`name`, `testmodel`.`email`, (...) FROM `testmodel` WHERE 1 having `distance` <= 50.0 
```

计数查询要短得多，并且没有 dist 选择部分：

```
SELECT COUNT( `testmodel`.`id`) FROM `testmodel` WHERE 1 having `distance` <= 50.0 
```

从逻辑上讲，MySQL 会给出错误，因为“距离”未定义。有没有办法告诉 Django 它必须为计数包含额外的选择？

感谢您的任何想法！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T21:11:47.517

如果您不打算使用任何其他数据库系统，则可以使用[原始查询。](https://docs.djangoproject.com/en/dev/topics/db/sql/)

```
 params = {'point1':wktpoint1, 'point2':wktpoint2}
    query = """
        SELECT
            dist(%(point1)s, %(point2)s)
        FROM
            testmodel
    ;"""
    query_set = self.raw(query, params) 
```

另外，如果你需要更多的 GIS 支持，你应该评估 PostgreSQL+ [PostGIS](http://postgis.refractions.net/)（如果你不喜欢重新发明轮子，你不应该制作自己的 dist 函数）

Django 通过 GeoDjango 提供 GIS 支持。那里有诸如[distance](https://docs.djangoproject.com/en/dev/ref/contrib/gis/geoquerysets/#distance-lookups)之类的功能。你应该[在这里查看支持](https://docs.djangoproject.com/en/dev/ref/contrib/gis/db-api/#compatibility-tables)

为了使用 GeoDjango，你需要在你的模型上添加一个字段，告诉他们使用[GeoManager](https://docs.djangoproject.com/en/dev/ref/contrib/gis/model-api/#geomanager)，然后你可以开始做地理查询，你应该没有问题`count`。

使用 mysql 你可以使用 geodjango 做这样的事情

```
### models.py
from django.contrib.gis.db import models
class YourModel(models.Model):
    your_geo_field=models.PolygonField()
    #your_geo_field=models.PointField()
    #your_geo_field=models.GeometryField()
    objects = models.GeoManager()

### your code
from django.contrib.gis.geos import *
from django.contrib.gis.measure import D
a_geom=fromstr('POINT(-96.876369 29.905320)', srid=4326)
distance=5
YoourModel.objects.filter(your_geo_field__distance_lt=(a_geom, D(m=distance))).count() 
```

[你可以在这里](https://docs.djangoproject.com/en/dev/ref/contrib/gis/db-api/#distance-queries)看到更好的例子和参考[在这里](https://docs.djangoproject.com/en/dev/ref/contrib/gis/geoquerysets/#distance-lookups)

# jquery - 使用 jQuery 评估 div 上的数据属性并将值传递给函数

> ID：11335424
> 
> 赞同：1
> 
> 时间：2012-07-04T21:02:01.627
> 
> 标签：jquery, custom-data-attribute

我有多个带有预览图像的幻灯片块（对于 jQuery Cycle，每个幻灯片实例都有不同的延迟（以毫秒为单位）），如下所示：

```
<div class="content">
    <div class="slideshow preview" data-delay="-2000">
        <img src="media/prevslide_3.jpg" alt="Img 1" />
        <img src="media/prevslide_4.jpg" alt="Img 2" />
        <img src="media/prevslide_5.jpg" alt="Img 3" />
    </div>
</div> 
```

我想使用 jQuery 将这些不同的延迟值（通过数据属性设置）传递到将运行所有 Cycle 事件的函数中。

```
$(document).ready(function() {

$('.slideshow.preview').cycle({
    fx: 'scrollHorz',
    random: 1,
    speed: 300,
    timeout: 6000,
    // here, for a single slideshow, delay is set like this "delay: -1234"
});
}); 
```

如何评估 div 上的数据属性 - data-delay="-2000" - 并将其传递给 Cycle 函数？

提前谢谢了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T21:07:04.667

jQuery 的[.data()](http://api.jquery.com/data/#data-html5)方法适用于 html5 数据属性。

```
$(document).ready(function() {
    $('.slideshow.preview').cycle({
        fx: 'scrollHorz',
        random: 1,
        speed: 300,
        timeout: 6000,
        delay: $(".slideshow.preview").data("delay")
    });
}); 
```

编辑

我错过了延迟键，但这有效。 [小提琴](http://jsfiddle.net/paWej/)

# c# - 检查 DataGridViewCheckBoxCell 中是否选中了复选框

> ID：11335425
> 
> 赞同：1
> 
> 时间：2012-07-04T21:02:05.713
> 
> 标签：c#, vb.net, datagridview

我有一个`DataGridView`包含`DataGridViewColumn`一个按钮和一个按钮。当我单击按钮时，我想检查是否选中了 datagridview 中的所有复选框。

我使用以下代码，但它不起作用：

```
Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button2.Click
    For i As Integer = 0 To DataGridView1.Rows.Count - 1
        Dim CheckBox As DataGridViewCheckBoxCell = DirectCast(DataGridView1.Rows(i).Cells(0), DataGridViewCheckBoxCell)
        If Not CheckBox.Value = Not CheckBox.Value Then
            MsgBox("True")
        End If
    Next
End Sub 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T21:17:08.510

我认为您的 IF 语句有问题。它应该检查是否`Value = True`而不是`.value = Not Checkbox,Value`

```
If CheckBox.Value = True Then
   MsgBox("True")
End If 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T21:20:00.680

我真的不知道你的逻辑应该用这条线做什么：

> If Not CheckBox.Value = Not CheckBox.Value Then

看起来你在说，“如果不是价值 = 不是价值”？？？

尝试这个：

```
Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button2.Click
  For i As Integer = 0 To DataGridView1.Rows.Count - 1
    'Dim CheckBox As DataGridViewCheckBoxCell = DirectCast(DataGridView1.Rows(i).Cells(0), DataGridViewCheckBoxCell)
    'If Not CheckBox.Value = Not CheckBox.Value Then
    '  MsgBox("True")
    'End If
    Dim obj As Object = DataGridView1.Rows(i).Cells(0)
    If (Not obj Is Nothing) Then
      Dim checkBox1 As DataGridViewCheckBoxCell = DirectCast(obj, DataGridViewCheckBoxCell)
      Dim objValue As Object = checkBox1.Value
      If (Not objValue Is Nothing) Then
        Dim checked As Boolean = DirectCast(objValue, Boolean)
        If (checked) Then
          MsgBox("True")
        End If
      End If
    End If
  Next
End Sub 
```

# java - 如何构建分布式Java应用程序？

> ID：11335430
> 
> 赞同：13
> 
> 时间：2012-07-04T21:02:32.667
> 
> 标签：java, multithreading, web-services, client-server, distributed-computing

首先，我有一个概念性的问题，“分布式”这个词是否仅仅意味着应用程序运行在多台机器上？或者还有其他可以将应用程序视为分布式的方式（例如，如果有许多独立的模块交互但在同一台机器上，这是分布式的吗？）。

其次，我想构建一个执行四种类型任务的系统，将有多个客户，每个客户将有许多每种类型的任务要定期运行。例如：customer1今天有task_type1，两天后有task_type2，以此类推，可能有customer2有task_type1像customer1的task_type1一样同时执行。即需要并发。执行任务的配置将存储在 DB 中，这些任务的结果也将存储在 DB 中。客户将通过网络浏览器（html 页面）使用系统与系统交互（基本上，配置任务并查看结果）。我考虑过使用rest webservice（使用JAX-RS），其中html页面将与后端进行通信，并在后端使用线程进行并发执行。问题：

1.  这听起来很简单，但我是否朝着正确的方向前进？或者我应该使用其他技术或概念，例如 Java Beans？

2.如果我的方法没问题，我是否需要使用 JSP 之类的脚本语言，或者我可以直接将 html 表单提交到其余 url 并获取结果（例如使用 JSON）？

1.  如果我想让应用程序分布式，我的想法是否可行？如果不是，我需要使用什么？

很抱歉有很多问题，但我真的很困惑。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-05T08:51:37.040

我只想在已经发布的答案上加一点。请对我的评论持保留态度，因为我曾经构建的所有 Web 应用程序都只在一台服务器上运行（除了部署到 Heroku 的应用程序，它可能会为您“分发”您的应用程序）。

如果您觉得您可能需要分发您的应用程序以实现可伸缩性，那么您首先应该考虑的*不是*Web 服务、多线程和消息队列以及 Enterprise JavaBeans 和...

首先要考虑的是您的应用程序域本身以及应用程序将要做什么。CPU密集型部分将在哪里？这些部分之间有什么依赖关系？系统的各个部分是否会自然分解为并行进程？如果没有，你能重新设计系统来做到这一点吗？重要提示：需要在线程/进程之间共享哪些数据（无论它们是在同一台机器上还是在不同机器上运行）？

理想的情况是每个并行线程/进程/服务器都可以获取自己的数据块并对其进行处理，而无需共享。更好的是，如果系统的某些部分可以变成无状态的——无状态代码可以无限并行化（简单而自然）。并行进程之间的数据共享越频繁和细粒度，应用程序的可扩展性就越低。在极端情况下，您甚至可能无法从分发应用程序中获得任何性能提升。（你可以在多线程代码中看到这一点——如果你的线程不断地争夺相同的锁，你的程序甚至可能在多线程+CPU 的情况下比在一个线程+CPU 的情况下更慢。）

要完成的工作的*概念*分解比实际使用什么工具或技术来分发应用程序更重要。如果您的概念分解很好，那么如果您从一台服务器开始，以后分发应用程序会容易得多。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-05T03:08:27.473

术语“分布式应用程序”是指应用程序系统的某些部分将在不同的计算节点上执行（可能是不同机器上的不同 CPU/内核，也可能是同一台机器上的多个 CPU/内核之间）。

对于如何构建系统的问题，有许多不同的技术解决方案。由于您询问的是 Java 技术，例如，您可以使用 Google 的 Web Toolkit 构建 Web 应用程序，这将为您提供丰富的基于浏览器的客户端用户体验。对于系统的服务器部署部分，您可以开始使用在 servlet 容器（如 Tomcat）中运行的简单 servlet。将使用基于 HTTP 的远程过程调用从浏览器调用您的 servlet。

稍后，如果您遇到可伸缩性问题，您可以开始将部分业务逻辑迁移到 EJB3 组件，这些组件本身最终可以部署在应用服务器上下文中的许多计算节点上，例如 Glassfish。我认为在你运行它之前你不需要解决这个问题。如果不了解客户将要执行的任务的性质，很难说您是否会这样做。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-05T03:17:05.243

要回答您的第一个问题 - 您**可以**让表单直接提交到其余网址。显然，这完全取决于您的要求。

正如上面评论中提到的@AlexD，您并不总是需要分发应用程序，但是如果您希望这样做，您可能应该考虑查看[JMS](http://en.wikipedia.org/wiki/Java_Message_Service)，它是一个消息传递 API，它可以让您运行几乎任何工作应用程序机器的数量，从消息队列中准备好消息并处理它们。

如果您想生成一个动态分布式应用程序，例如在多个资源匮乏的虚拟机（例如 Amazon EC2 微型实例）或物理硬件上运行，可以随意添加和删除以应对需求，那么您可能希望考虑将其与[Project Shoal](http://shoal.java.net/)集成，后者是一个 Java 框架，允许应用程序节点的集群，并让它们随时出现/消失。Project Shoal 使用 JXTA 和 JGroups 作为底层通信协议。

另一种方法是使用在应用服务器上运行的[EJB分发您的应用程序。](http://en.wikipedia.org/wiki/EJB)

# sockets - 使用辅助 IP 地址连接套接字

> ID：11335431
> 
> 赞同：6
> 
> 时间：2012-07-04T21:02:42.737
> 
> 标签：sockets, tcp, routing, linux-kernel, ip

不久前，我能够通过以下步骤从给定接口上的主 IP 地址或辅助 IP 地址连接到给定的目标地址。

1.  使用，将辅助 IP 地址添加到给定接口`ip addr add ...`，
2.  根据需要将套接字绑定到主地址或辅助地址，
3.  使用主地址或辅助地址连接到目标 IP 地址，如 #2 中所述。

我最近将一台机器升级到了 Linux 3.3.6，但它不再工作了，但我不记得我尝试过的最后一个实际工作的版本。有谁知道如何在较新的内核中做同样的事情？我刚刚在另一台机器上验证了 2.6.23 上的相同代码。

> **更新 2**这似乎与 NIC 驱动程序有关。使用 3.3.6 和**8139too**，一切都很好。同一台机器，但使用不同的 NIC 和**via-rhine**，就会出现问题。

以下是我在 3.3.6 上运行代码（最后是源代码）（`tshark`后台运行的数据包捕获输出）时发生的情况：

```
$ ./bind_connect 10.0.1.124 10.0.1.120
Bound socket: 10.0.1.120 [10.0.1.120->10.0.1.124]

#           wrong source IP (should use 10.0.1.120 from bind)
#                      |
#                      v
$ 121.051052   10.0.1.220 -> 10.0.1.124   50418 80 TCP 74 50418 > 80 [SYN] Seq=3358582895 Win=14600 Len=0 MSS=1460 SACK_PERM=1 TSval=30589624 TSecr=0 WS=128
121.051428   10.0.1.124 -> 10.0.1.220   80 50418 TCP 74 80 > 50418 [SYN, ACK] Seq=1815118993 Ack=3358582896 Win=5792 Len=0 MSS=1460 SACK_PERM=1 TSval=8157158 TSecr=30589624 WS=2
121.051475   10.0.1.220 -> 10.0.1.124   50418 80 TCP 66 50418 > 80 [ACK] Seq=3358582896 Ack=1815118994 Win=14720 Len=0 TSval=30589624 TSecr=8157158
121.051504   10.0.1.220 -> 10.0.1.124   50418 80 TCP 66 50418 > 80 [FIN, ACK] Seq=3358582896 Ack=1815118994 Win=14720 Len=0 TSval=30589624 TSecr=8157158
121.051768   10.0.1.124 -> 10.0.1.220   80 50418 TCP 66 80 > 50418 [ACK] Seq=1815118994 Ack=3358582897 Win=5792 Len=0 TSval=8157158 TSecr=30589624
121.051913   10.0.1.124 -> 10.0.1.220   80 50418 TCP 66 80 > 50418 [FIN, ACK] Seq=1815118994 Ack=3358582897 Win=5792 Len=0 TSval=8157158 TSecr=30589624
121.051941   10.0.1.220 -> 10.0.1.124   50418 80 TCP 66 50418 > 80 [ACK] Seq=3358582897 Ack=1815118995 Win=14720 Len=0 TSval=30589625 TSecr=8157158

$ ./bind_connect 10.0.1.124 10.0.1.220
Bound socket: 10.0.1.220 [10.0.1.220->10.0.1.124]
$ 124.139966   10.0.1.220 -> 10.0.1.124   41470 80 TCP 74 41470 > 80 [SYN] Seq=1404133303 Win=14600 Len=0 MSS=1460 SACK_PERM=1 TSval=30590551 TSecr=0 WS=128
124.140421   10.0.1.124 -> 10.0.1.220   80 41470 TCP 74 80 > 41470 [SYN, ACK] Seq=1918490481 Ack=1404133304 Win=5792 Len=0 MSS=1460 SACK_PERM=1 TSval=8157467 TSecr=30590551 WS=2
124.140478   10.0.1.220 -> 10.0.1.124   41470 80 TCP 66 41470 > 80 [ACK] Seq=1404133304 Ack=1918490482 Win=14720 Len=0 TSval=30590551 TSecr=8157467
124.140553   10.0.1.220 -> 10.0.1.124   41470 80 TCP 66 41470 > 80 [FIN, ACK] Seq=1404133304 Ack=1918490482 Win=14720 Len=0 TSval=30590551 TSecr=8157467
124.140934   10.0.1.124 -> 10.0.1.220   80 41470 TCP 66 80 > 41470 [ACK] Seq=1918490482 Ack=1404133305 Win=5792 Len=0 TSval=8157467 TSecr=30590551
124.140976   10.0.1.124 -> 10.0.1.220   80 41470 TCP 66 80 > 41470 [FIN, ACK] Seq=1918490482 Ack=1404133305 Win=5792 Len=0 TSval=8157467 TSecr=30590551
124.140995   10.0.1.220 -> 10.0.1.124   41470 80 TCP 66 41470 > 80 [ACK] Seq=1404133305 Ack=1918490483 Win=14720 Len=0 TSval=30590551 TSecr=8157467

$ uname -a
Linux erebus.mn.ca 3.3.6-1-ARCH #1 SMP PREEMPT Sun May 13 09:59:18 UTC 2012 i686 GNU/Linux
$ ip route get 10.0.1.124
10.0.1.124 dev eth0.894  src 10.0.1.220 
    cache  ipid 0x61ca rtt 3ms rttvar 3ms cwnd 10 
```

然后在 2.6.23 上也一样：

```
$ ./bind_connect 10.0.0.123 10.0.0.226                                                                                                                                           >
Bound socket: 10.0.0.226 [10.0.0.226->10.0.0.123]
$ 231.566278   10.0.0.226 -> 10.0.0.123   TCP 54109 > http [SYN] Seq=0 Win=5840 Len=0 MSS=1460 TSV=99922052 TSER=0 WS=5
231.566448   10.0.0.123 -> 10.0.0.226   TCP http > 54109 [SYN, ACK] Seq=0 Ack=1 Win=5792 Len=0 MSS=1460 TSV=7060755 TSER=99922052 WS=1
231.566463   10.0.0.226 -> 10.0.0.123   TCP 54109 > http [ACK] Seq=1 Ack=1 Win=5856 Len=0 TSV=99922052 TSER=7060755
231.566510   10.0.0.226 -> 10.0.0.123   TCP 54109 > http [FIN, ACK] Seq=1 Ack=1 Win=5856 Len=0 TSV=99922052 TSER=7060755
231.566593   10.0.0.123 -> 10.0.0.226   TCP http > 54109 [ACK] Seq=1 Ack=2 Win=5792 Len=0 TSV=7060755 TSER=99922052
231.566704   10.0.0.123 -> 10.0.0.226   TCP http > 54109 [FIN, ACK] Seq=1 Ack=2 Win=5792 Len=0 TSV=7060755 TSER=99922052
231.566737   10.0.0.226 -> 10.0.0.123   TCP 54109 > http [ACK] Seq=2 Ack=2 Win=5856 Len=0 TSV=99922052 TSER=7060755

$ ./bind_connect 10.0.0.123 10.0.0.126                                                                                                                                           >
Bound socket: 10.0.0.126 [10.0.0.126->10.0.0.123]
$ 235.824867   10.0.0.126 -> 10.0.0.123   TCP 34228 > http [SYN] Seq=0 Win=5840 Len=0 MSS=1460 TSV=99926310 TSER=0 WS=5
235.825185   10.0.0.123 -> 10.0.0.126   TCP http > 34228 [SYN, ACK] Seq=0 Ack=1 Win=5792 Len=0 MSS=1460 TSV=7061180 TSER=99926310 WS=1
235.825236   10.0.0.126 -> 10.0.0.123   TCP 34228 > http [ACK] Seq=1 Ack=1 Win=5856 Len=0 TSV=99926311 TSER=7061180
235.825273   10.0.0.126 -> 10.0.0.123   TCP 34228 > http [FIN, ACK] Seq=1 Ack=1 Win=5856 Len=0 TSV=99926311 TSER=7061180
235.825721   10.0.0.123 -> 10.0.0.126   TCP http > 34228 [ACK] Seq=1 Ack=2 Win=5792 Len=0 TSV=7061180 TSER=99926311
235.825722   10.0.0.123 -> 10.0.0.126   TCP http > 34228 [FIN, ACK] Seq=1 Ack=2 Win=5792 Len=0 TSV=7061180 TSER=99926311
235.825756   10.0.0.126 -> 10.0.0.123   TCP 34228 > http [ACK] Seq=2 Ack=2 Win=5856 Len=0 TSV=99926311 TSER=7061180

$ uname -a
Linux gaia.mn.ca 2.6.23.17-88.fc7 #1 SMP Thu May 15 00:35:10 EDT 2008 i686 i686 i386 GNU/Linux
$ ip route get 10.0.0.123
10.0.0.123 dev eth0  src 10.0.0.126
    cache  mtu 1500 advmss 1460 hoplimit 64 
```

bind_connect 的代码：

```
#include <arpa/inet.h>
#include <errno.h>
#include <netinet/in.h>
#include <netinet/tcp.h>
#include <stdio.h>
#include <sys/socket.h>
#include <sys/types.h>
#include <unistd.h>

int main(int argc, char **argv)
{
    struct sockaddr_in sn;
    socklen_t sn_len;
    struct sockaddr_in src;
    struct sockaddr_in dst;
    int sock;
    char b1[INET_ADDRSTRLEN];
    char b2[INET_ADDRSTRLEN];
    char b3[INET_ADDRSTRLEN];

    src.sin_family = dst.sin_family = AF_INET;
    src.sin_port = 0;
    dst.sin_port = htons(80);

    if (argc < 3) {
        printf("missing argument\n");
        return 1;
    }

    if (inet_pton(AF_INET, argv[1], &dst.sin_addr) != 1) {
        perror("pton");
        return -errno;
    }

    if (inet_pton(AF_INET, argv[2], &src.sin_addr) != 1) {
        perror("pton");
        return -errno;
    }

    sock = socket(AF_INET, SOCK_STREAM, 0);
    if (sock < 0) {
        perror("socket");
        return -errno;
    }

    if (bind(sock, (struct sockaddr*)&src, sizeof src) != 0) {
        perror("bind");
        return -errno;
    }

    sn_len = sizeof sn;
    if (getsockname(sock, (struct sockaddr*)&sn, &sn_len) != 0) {
        perror("getsockname");
        return -errno;
    }

    printf("Bound socket: %s [%s->%s]\n",
           inet_ntop(AF_INET, &sn.sin_addr, b1, sizeof b1),
           inet_ntop(AF_INET, &src.sin_addr, b2, sizeof b2),
           inet_ntop(AF_INET, &dst.sin_addr, b3, sizeof b3));

    if (connect(sock, (struct sockaddr*)&dst, sizeof dst) != 0) {
        perror("connect");
        return -errno;
    }

    close(sock);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T00:04:53.817

问题原来是我用 iptables 设置了一个 nat POSTROUTING 规则，即

```
Chain POSTROUTING (policy ACCEPT 11 packets, 637 bytes)
 pkts bytes target     prot opt in     out     source               destination         
    0     0 MASQUERADE  all  --  any    eth0.894  anywhere             anywhere 
```

一旦我删除了这条规则：

```
$ sudo iptables -t nat -F 
```

事情又开始起作用了。我前段时间在测试另一个问题时设置了 nat 规则，然后忘记将其删除。

# php - PHP 密码 - 加盐、反转、加密

> ID：11335435
> 
> 赞同：-2
> 
> 时间：2012-07-04T21:02:54.857
> 
> 标签：php, security, encryption, hash, passwords

我只想知道这个脚本对于密码加密是否足够安全：

```
<?php

$password    = 'password';
$salt        = '9awd8n12jok1llawawf';

$new         = hash($password . $salt, 'ripemd160');
final        = strrev($new);

?> 
```

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T21:05:59.120

不要为每个密码使用相同的盐。通常你想要做的是使用一些可复制的值作为盐。例如，一些用户 id 的散列（如果用户 id 永远不会改变），或者一些随机字符串，你与用户帐户信息一起保存。最终用户永远不应该看到盐。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T21:07:39.803

如果您想提供更高的安全性，请存储用户注册时间戳并将其用于哈希盐。这样哈希盐就更随机了，你的数据也更安全了。

# sql - 批量插入 SQL Server 2005 问题

> ID：11335436
> 
> 赞同：1
> 
> 时间：2012-07-04T21:03:14.543
> 
> 标签：sql, sql-server, sql-server-2005

我已经尝试过批量插入，但我做错了。我有一个表模式，它以一个 id 和几列开头，然后我需要跳过一列。将列分配给csv中的每一列的正确方法是什么？

谢谢

编辑：

我的代码：

```
BULK INSERT datadb
from 'C:\datainsert.csv'
WITH
(
FIRSTROW=2,
FIELDTERMINATOR = ',',
ROWTERMINATOR = '\n'
)
GO 
```

错误是因为我有一个 ID 列，所以我的第一列是不同的数据类型

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T08:52:08.697

我已经测试过了，它工作正常，没有任何问题。

请发布您的表格和 csv 文件的元数据，以便我有机会找到问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-01T18:58:03.660

Marc_s 做到了。我创建了一个临时表并批量加载到该表。然后从它中选择到我现有的表中。谢谢马克_s！

# java - 从 HttpSessions (Java) 设置/获取对象

> ID：11335439
> 
> 赞同：0
> 
> 时间：2012-07-04T21:03:35.073
> 
> 标签：java, servlets, casting, httpsession

我将一个对象设置为`HttpSession`. 该对象是类的一个实例`User`。然后，在另一堂课中，我试图做这样的事情：

```
User user = session.getAttribute("userObject"); 
```

我读过`Serializable`但我不明白它是如何工作的。有没有更直接和更简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T21:11:42.703

把会话想象成一个简单的、类型不安全的`Map`。你可以在里面放任何东西，也可以把它拿出来，只要你知道你期望的类型。因此，如果您放置了一个`User`对象，请使用：

```
User user = (User) session.getAttribute("userObject"); 
```

如果你放了一个`Long`（userId）

```
Long id = (Long) session.getAttribute("userObject");
User user = getUserById(id); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T21:05:58.433

你的代码看起来不错，你只需要一个演员：

```
User user = (User) session.getAttribute("userObject"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-04T21:07:48.943

阅读有关序列化的内容：

[为什么以及如何在 Java Web 应用程序中使用序列化？](https://stackoverflow.com/questions/894491/why-and-how-is-serialization-used-in-java-web-applications)

我们假设您在其他地方执行此操作。

```
session.setAttribute("userObject", user); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-04T23:35:34.997

仅当您尝试在集群会话环境中运行时，Serializable 才真正重要。如果是这样，应用程序容器（tomcat 或其他）将需要将会话中的所有对象转换为字节数据，以便它可以流式传输到其他服务器以复制会话。在这种情况下，您的所有会话值都需要实现 Serializable 并且只包含本身实现 Serializable 的属性。

# java - android基本身份验证响应问题

> ID：11335443
> 
> 赞同：0
> 
> 时间：2012-07-04T21:04:06.940
> 
> 标签：java, android, string, basic-authentication

对，我一直在努力尝试找出 android 中的基本身份验证，以便我可以从 url 中提取 json 数据。到目前为止，基本身份验证似乎给我带来了很多麻烦。最后经过三天的研究，我在网上找到了一个使用类似技术来下拉 xml 的示例。这就是我所拥有的：

```
 String MY_APP_TAG = "basic.authentication";

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();
    StrictMode.setThreadPolicy(policy);

    String username = "username";
    String host = "www.example.com";
    String password = "password";
    String urlBasePath = "http://www.example.com/api/core/v1/my";
    String urlApiCall_FindAllRepositories = urlBasePath;

    try {
        HttpClient client = new DefaultHttpClient();
        AuthScope as = new AuthScope(host, 80);
        UsernamePasswordCredentials upc = new UsernamePasswordCredentials(
                username, password);

        ((AbstractHttpClient) client).getCredentialsProvider()
                .setCredentials(as, upc);

        BasicHttpContext localContext = new BasicHttpContext();
        BasicScheme basicAuth = new BasicScheme();
        localContext.setAttribute("preemptive-auth", basicAuth);

        HttpHost targetHost = new HttpHost(host, 80, "http");
        HttpGet httpget = new HttpGet(urlApiCall_FindAllRepositories);
        HttpResponse response = client.execute(targetHost, httpget,
                localContext);

        HttpEntity entity = response.getEntity();
        Object content = EntityUtils.toString(entity);

        String decoded_password = new String(Base64.decode(content.toString(), Base64.DEFAULT));
        System.out.println("RESULT: " + decoded_password);

        Log.d(MY_APP_TAG, content.toString());
        System.out.println(content.toString().getBytes().toString());

    } catch (Exception e) {
        e.printStackTrace();
        Log.d(MY_APP_TAG, "Error: " + e);
    }

}
} 
```

正如您从代码中看到的那样，我正在通过身份验证并尝试使用 base 64 解码结果。奇怪的是，这就是我要返回的内容：

> 07-04 21:55:01.726：D/gralloc_goldfish(639)：没有检测到 GPU 仿真的仿真器。
> 
> 07-04 21:58:19.256: I/dalvikvm(753): threadid=3: 对信号 3 做出反应
> 
> 07-04 21:58:19.297: I/dalvikvm(753): 将堆栈跟踪写入“/data/anr/traces.txt”
> 
> 07-04 21:58:19.656：W/DefaultRequestDirector(753)：身份验证错误：无法响应任何这些质询：{}
> 
> 07-04 21:58:19.676：I/System.out(753)：结果：“N�7��|�22”</p>
> 
> 07-04 21:58:19.676: D/basic.authentication(753): ������������1Â0��÷¼ÂÊÒ！
> 
> 07-04 21:58:19.676: D/basic.authentication(753): &ÄÄÊ¬Ä4L¶£¿²îÎÊ
> 
> 07-04 21:58:19.676: D/basic.authentication(753): 2Ëzc¦ùN&]]jð@6ÚOçð ��ñIf¸PÄKì^¨yMè¡é(½{ÕjÑ< `J£/C _RÇÝöLÿããaÃ÷²� ����
> 
> 07-04 21:58:19.676: I/System.out(753): [B@412d87a0
> 
> 07-04 21:58:19.746: I/dalvikvm(753): threadid=3: 对信号 3 做出反应
> 
> 07-04 21:58:19.756: I/dalvikvm(753): 将堆栈跟踪写入“/data/anr/traces.txt”
> 
> 07-04 21:58:19.946：D/gralloc_goldfish(753)：没有检测到 GPU 仿真的仿真器。

如您所见，我收到了一些奇怪的代码，但它也说明存在身份验证错误。

谁能帮我弄清楚发生了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T22:09:43.530

我曾尝试使用 进行身份验证，`UsernamePasswordCredentials`但由于某种原因，它不起作用。没有错误或任何东西，但我的 HTTP 请求是在没有授权标头的情况下发送的。

我结束了这样的“手动”设置：

```
request.setHeader(new BasicHeader("Authorization", "Basic " + new String(Base64.encodeBase64((user + ":" + password).getBytes())))); 
```

对于 Base64，我使用了从这里下载的 apache commons 编解码器：

[http://commons.apache.org/codec/download_codec.cgi](http://commons.apache.org/codec/download_codec.cgi)

要查看您的标头，您可以使用诸如 Fiddler Web 调试器之类的 Web 调试工具。它将非常清楚地向您显示带有标题的请求以及响应，因此您将知道发生了什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T03:15:33.780

这里发生了两件事：您正在主线程上执行网络操作，并且您正在从 Android 获得 ANR（应用程序无响应）。将您的应用更改为使用 AsyncTask 或类似的。第二件事是您返回的数据可能不是您所期望的，因为 Bae64 解码似乎会产生垃圾。转储原始响应并在浏览器中检查/比较结果。

# ruby-on-rails - 在 12 要素应用程序中管理配置

> ID：11335444
> 
> 赞同：20
> 
> 时间：2012-07-04T21:04:11.003
> 
> 标签：ruby-on-rails, configuration, heroku, 12factor

我很喜欢在 Heroku 上使用 Rails，而且我可以调整 Heroku 应用程序的配置属性，而无需提交更改`xyz.yml`和重新部署。

在我的 Rails 应用程序中完全取消 Yaml 配置文件，并尽可能依赖在 ENV 中存储配置会很好。这与[12 因素配置](http://www.12factor.net/config)原则相一致。

但是，在从基于 Yaml 的配置管理切换到基于 Heroku/12 因子的配置管理时需要权衡取舍。

*   虽然部署（qa、stage、prod、dev、demo、labs）的扩散确实会导致 Yaml 文件的扩散，但复制粘贴来创建新的配置文件非常容易。我看不到在 Heroku 中将配置文件从一个部署“复制”到另一个部署的方法。
*   在 repo 中存储配置数据意味着，在 Heroku 的情况下，部署和配置以及应用程序是在单个操作中完成的。如果我要将配置从 Yaml 文件中移到 ENV 变量中，我必须在部署后在单独的步骤中配置我的应用程序。

想听听在他们的私有应用程序中使用 12 因素样式配置的人的意见，以及他们如何跨大量部署管理大量配置变量。

*   如何快速配置新部署？
*   如果不是 repo，您​​将配置变量的权威来源保存在哪里？您如何在开发人员之间分发它？

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-05T14:40:08.420

我通常使用的是使用 ENV 并提供默认值的 Yaml。例如，可以愉快地对 YAML 进行 ERB 处理以包含您的 ENV 变量：

```
foo:
  var: ENV["MY_CONFIG"] || "default_value" 
```

您只需要确保在阅读时使用 ERB 加载 Yaml：

```
YAML.load(ERB.new(File.read("#{Rails.root}/config/app_config.yml")).result) 
```

通过这样做，您的代码在开发中可以正常工作，但也允许您在环境中设置配置变量。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-05T17:12:57.913

您可以使用一些简单的 shell 脚本相对容易地完成此操作，通过 heroku config 或 heroku release:info v99 迭代现有变量，然后设置 heroku config:set k=v --app

但是，如果它是一个问题/痛苦/摩擦，那么您的 env var 配置中可能有太多内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-03-09T03:36:55.493

答案有点晚了，但我相信这就是你要找的。

我开发了一个名为[settei](https://github.com/lulalala/settei)的 gem ，允许您使用 YAML 文件来配置应用程序。然而，gem 会在部署期间将 YAML 文件序列化为**一个**环境变量。这样一来，两全其美：YAML 便于管理/创建衍生环境，ENV 用于 12 因素合规性。

# c++ - 在结构向量的观察窗口中显示特定变量

> ID：11335450
> 
> 赞同：2
> 
> 时间：2012-07-04T21:05:05.947
> 
> 标签：c++, visual-studio, debugging

假设我有一个`std::vector<Foo>`size `30`，`Foo`结构定义为：

```
struct Foo {
    int a,b,c,d,e,f,g,h,i,j,k,l,m; //many fields
    // ...
}; 
```

是否可以仅“观察”`g`向量所有元素的字段内容？

我认为 Watch Window 中的表达式如下：

```
(v)._Myfirst[$index].g
//v would be the variable holding the vector being debugged 
```

就足够了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T23:46:35.853

如果您将可视化工具信息添加`Foo`到 %VSINSTALLDIR%\Common7\Packages\Debugger\autoexp.dat，您应该只需通过观看`v`.

例如，假设您`v`填充了 3 `Foo`s，其`g`值为 111、222 和 333。如果将以下内容添加到 autoexp.dat 的末尾：

```
Foo {
    preview (
        $c.g
    )
} 
```

观察窗口看起来像：

![VS10 观察窗口](../Images/44d5546860c029f2ece05957e75b315e.png)

或者您可以添加：

```
Foo {
    preview (
        #("g = ", $c.g)
    )
} 
```

产生：

![VS10 观察窗口](../Images/457bbc567b87580a3afbfeaca95208b0.png)

# c# - 幻灯片壁纸 Windows 7

> ID：11335451
> 
> 赞同：8
> 
> 时间：2012-07-04T21:05:13.907
> 
> 标签：c#, windows, c#-4.0, windows-7, wallpaper

如何以编程方式设置 Windows 7 壁纸幻灯片？

**设置普通壁纸**

```
 [DllImport("user32.dll", CharSet = CharSet.Auto)]
        private static extern Int32 SystemParametersInfo(UInt32 uiAction, UInt32 uiParam, String pvParam, UInt32 fWinIni);
        private static UInt32 SPI_SETDESKWALLPAPER = 20;
        private static UInt32 SPIF_UPDATEINIFILE = 0x1;
  public void SetImage(string filename)
        {
            SystemParametersInfo(SPI_SETDESKWALLPAPER, 0, filename, SPIF_UPDATEINIFILE);
        } 
```

**到目前为止我发现了什么：**

幻灯片中有一个ini文件

> C:\Users\CurrentUser\AppData\Roaming\Microsoft\Windows\Themes\

在幻灯片放映期间，壁纸必须位于以下文件夹中：

> C:\Users\CurrentUser\AppData\Roaming\Microsoft\Windows\Themes\TranscodedWallpaper.jpg
> 
> （在幻灯片放映期间，文件会自动更改）

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-07-05T09:30:37.693

尝试这个

```
public sealed class Wallpaper
{
Wallpaper() { }

const int SPI_SETDESKWALLPAPER = 20;
const int SPIF_UPDATEINIFILE = 0x01;
const int SPIF_SENDWININICHANGE = 0x02;

[DllImport("user32.dll", CharSet = CharSet.Auto)]
static extern int SystemParametersInfo(int uAction, int uParam, string lpvParam, int fuWinIni);

public enum Style : int
{
    Tiled,
    Centered,
    Stretched
}

public static void Set(Uri uri, Style style)
{
    System.IO.Stream s = new System.Net.WebClient().OpenRead(uri.ToString());

    System.Drawing.Image img = System.Drawing.Image.FromStream(s);
    string tempPath = Path.Combine(Path.GetTempPath(), "wallpaper.bmp");
    img.Save(tempPath, System.Drawing.Imaging.ImageFormat.Bmp);

    RegistryKey key = Registry.CurrentUser.OpenSubKey(@"Control Panel\Desktop", true);
    if (style == Style.Stretched)
    {
        key.SetValue(@"WallpaperStyle", 2.ToString());
        key.SetValue(@"TileWallpaper", 0.ToString());
    }

    if (style == Style.Centered)
    {
        key.SetValue(@"WallpaperStyle", 1.ToString());
        key.SetValue(@"TileWallpaper", 0.ToString());
    }

    if (style == Style.Tiled)
    {
        key.SetValue(@"WallpaperStyle", 1.ToString());
        key.SetValue(@"TileWallpaper", 1.ToString());
    }

    SystemParametersInfo(SPI_SETDESKWALLPAPER,
        0,
        tempPath,
        SPIF_UPDATEINIFILE | SPIF_SENDWININICHANGE);
}
 } 
```

原来的问题是[这个](https://stackoverflow.com/questions/1061678/change-desktop-wallpaper-using-code-in-net)

# c++ - 将指针的 std::list 转换为 std::list 的快速方法

> ID：11335457
> 
> 赞同：3
> 
> 时间：2012-07-04T21:06:01.207
> 
> 标签：c++, stl, containers

我有一个`std::list<obj*>`，`obj`我的课在哪里：

```
std::list<obj*> list_of_ptr;
list_of_ptr.push_back(new obj()); 
```

我想将此列表转换为等效列表`std::list<obj>`，之后我不再需要`list_of_ptr`.

完成这项工作的最快方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-04T21:17:02.067

`std::transform`是你的朋友：

```
std::vector<obj> objects;
std::transform(
    list_of_ptr.begin(), list_of_ptr.end(),
    std::back_inserter(objects), 
    [](obj* p) { return *p; }); 
```

或者，如果不能使用 C++11 lambda 表达式，可以使用一个简单的函数对象来执行间接寻址：

```
struct indirect
{
    template <typename T>
    T& operator()(T* p) { return *p; }
};

std::transform(
    list_of_ptr.begin(), list_of_ptr.end(),
    std::back_inserter(objects), 
    indirect()); 
```

或者，使用[`boost::indirect_iterator`](http://www.boost.org/doc/libs/1_50_0/libs/iterator/doc/indirect_iterator.html)：

```
std::vector<obj> objects(
    boost::make_indirect_iterator(list_of_ptr.begin()),
    boost::make_indirect_iterator(list_of_ptr.end())); 
```

当然，这些假设序列中没有空指针。留给读者作为练习来弄清楚如何正确管理`list_of_ptr`.

理想情况下，`std::vector<obj>`从一开始就使用 a ，或者，如果不可能，则使用智能指针容器。手动管理指向对象的生命周期并正确执行是非常困难的。C++ 有很棒的自动对象生命周期管理工具（析构函数、智能指针、容器、堆栈语义、RAII），没有理由不使用它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T21:52:06.547

简单易懂的代码也是你的朋友：

```
for each (obj* pObj in list_of_ptr)
{
    if (pObj != nullptr)
    {
        list_of_objects.push_back(*pObj);
    }
} 
```

如果这不适合你，这当然应该：

```
std::list<obj> list_of_objects;

for_each(list_of_ptr.begin(), list_of_ptr.end(), [&list_of_objects] (obj* pObj) {
    if (pObj != nullptr)
        list_of_objects.push_back(*pObj);
}); 
```

# jquery - Rails 3 js.erb 从未被调用

> ID：11335458
> 
> 赞同：0
> 
> 时间：2012-07-04T21:06:27.800
> 
> 标签：jquery, ajax, ruby-on-rails-3

我试图让用户在同一页面上并在执行更新后执行一些 Javascript..

然而，我的 js.erb 似乎从未被调用，而是被重定向到路由“http://localhost:3000/upload_images/id”，而我的萤火虫控制台产生了......

```
"NetworkError: 406 Not Acceptable -http://localhost:3000/upload_images/id" 
```

更新操作

```
 def update  
    @upload_image = UploadImage.find(params[:id])
    #If this image is set as the preview restore all associated images to default
    if params[:upload_image][:preview] == "1"
      other_uploads = @upload_image.upload.upload_images.where("not upload_images.id = ?", @upload_image.id)
      other_uploads.each do |upload_image|
        upload_image.preview = "0"
        upload_image.save
      end
    end      
    respond_to do |format|    
      if @upload_image.update_attributes(params[:upload_image])
        #keep the user on current page and call some Javascript
        format.js{render :template => 'update.js.erb'}
      else
        format.html { render action: "edit" }
        format.json { render json: @upload_image.errors, status: :unprocessable_entity }
        format.js
      end
    end
  end 
```

更新.js.erb

```
alert("hello world!"); 
```

编辑表格

```
<%=form_for(@upload_image) do |f| %>
   ....
<% end %> 
```

看到实时更新对我来说并不重要，我不介意用户是否必须刷新才能看到它们。我只想保持页面状态不变（JQuery 所做的一些更改除外）并发布到数据库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T21:14:55.630

您可能需要切换到远程表单：

```
<%= form_for(@upload_image, :remote => true) do |f| %> 
```

否则，您的表单将尝试期望 HTTP 响应的 HTTP POST。

# node.js - 如何在 Node 中解析数据 URL？

> ID：11335460
> 
> 赞同：46
> 
> 时间：2012-07-04T21:06:59.277
> 
> 标签：node.js, url, base64

我有一个这样的数据 URL：

```
data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAA... 
```

将其作为二进制数据（例如 a `Buffer`）以便我可以将其写入文件的最简单方法是什么？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2012-07-04T21:12:00.357

使用“base64”编码将数据放入缓冲区，然后将其写入文件：

```
var fs = require('fs');
var string = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==";
var regex = /^data:.+\/(.+);base64,(.*)$/;

var matches = string.match(regex);
var ext = matches[1];
var data = matches[2];
var buffer = Buffer.from(data, 'base64');
fs.writeFileSync('data.' + ext, buffer); 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2014-06-04T18:14:26.083

尝试这个

```
var dataUrl = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==";
var buffer = new Buffer(dataUrl.split(",")[1], 'base64'); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-05-10T10:32:30.307

我最近也遇到了这样的问题（解析和验证数据 URL），并找到了以下解决方法：[https ://gist.github.com/bgrins/6194623](https://gist.github.com/bgrins/6194623)

我创建了 2 个包，以便在代码中更轻松地处理数据 URL。它们在这里： [https://github.com/killmenot/valid-data-url](https://github.com/killmenot/valid-data-url)
[https://github.com/killmenot/parse-data-url](https://github.com/killmenot/parse-data-url)

查看[示例](https://github.com/killmenot/parse-data-url#example)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-10-17T13:25:37.250

我正在研究 Node.js 的源[代码，并偶然发现了这段](https://github.com/nodejs/node/blob/df22736d80588e04550cbb65a421a74dae661676/lib/internal/modules/esm/get_source.js#L31-L36)将数据 URL 解码为`Buffer`. 尽管该函数不是公开的并且专门用于解析编码的 ES 模块，但它揭示了一些其他答案显然没有考虑到的数据 URL 的方面：数据 URL 的内容**不能是 base64 编码**的，并且**可能是 URL 编码**的，并且它甚至可能是未编码的。

本质上，Node.js 逻辑归结为类似于下面的代码加上错误处理：

```
const parsed = new URL(url);
const match = /^[^/]+\/[^,;]+(?:[^,]*?)(;base64)?,([\s\S]*)$/.exec(parsed.pathname);
const { 1: base64, 2: body } = match;
const buffer = Buffer.from(decodeURIComponent(body), base64 ? 'base64' : 'utf8'); 
```

这将正确处理带有内容的 Javascript 文件的不同编码`console.log("Node.js");`：

*   数据：文本/javascript，console.log（“Node.js”）；
*   数据：文本/javascript，console.log(%22Node.js%22)%3B
*   数据：文本/javascript；base64,Y29uc29sZS5sb2coIk5vZGUuanMiKTs=

如果需要，可以将生成的缓冲区转换为字符串`buffer.toString()`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-02-28T04:35:10.847

这个方法对我有用

```
 function dataURItoBlob(dataURI) {
  // convert base64 to raw binary data held in a string
  var data = dataURI.split(',')[1]; 
  var byteString = Buffer.from(data, "base64");

  // separate out the mime component
  var mimeString = dataURI.split(",")[0].split(":")[1].split(";")[0];

  // write the ArrayBuffer to a blob, and you're done
  var blob = new Blob([byteString], { type: mimeString  });
  return blob;
} 
```

使用

```
var uri = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg=='; 
dataURItoBlob(uri) 
```

# spring - 如何在测试期间注入 Test-Implementation，生产模式下的 Production-Implementation - Spring，JSR-330

> ID：11335461
> 
> 赞同：0
> 
> 时间：2012-07-04T21:07:00.770
> 
> 标签：spring, dependency-injection, inject, jsr330

让我们假设我有定序器和以下 Bean。Sequencer 负责从数据库序列中获取下一个值。OracleSequencer 用于生产模式，在 JUnit-Tests 期间使用 TestSequencer。

```
public interface Sequencer{
  long getNextValue();
}

@Named("OracleSequencer")
public class OracleSequencer implements Sequencer[
...
}

@Named("TestSequencer")
public class TestSequencer implements Sequencer[
...
} 
```

这就是我想使用它的方式：

```
@Named
public class BusinessBean{
  @Inject
  private Sequencer sequencer;
} 
```

**我的问题是**：当我在生产模式下运行应用程序时，我想在**BusinessBean中注入***OracleSequencer*，当我运行 JUnit-Test 时，我想注入*TestSequencer*。JSR-330 (@Inject, @Named) 可以吗？

 ***我找到了 2 个肮脏的解决方案：

*   在测试开始时，可​​以在 bean 中替换 Sequencer，该 bean 取自 Spring-ApplicationContext。当原型合适并且 TestSequencer 没有任何其他依赖项时，这是可能的：

    BusinessBean bean = springContext.getBean(..); bean.setSequencer(new TestSequencer());

*   我们可以用@ProductionScope 注释OracleSequencer，用@TestScope 注释TestSequencer，并配置Spring 以适当的模式扫描适当的注释。

你可能有其他想法如何解决这个问题？

春天 3.1。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T21:25:31.357

一种解决方案是使用 Spring 3.1 引入的 Spring Profiles，本质上定义一个名为“prod”和“test”的配置文件，让您`OracleSequencer`在`prod`配置文件和配置文件`TestSequencer`中创建`test`。

对于您的测试，`test`单独激活配置文件，然后您的产品激活`prod`配置文件。

这是对 Profiles 的一个参考 - [http://blog.springsource.com/2011/02/14/spring-3-1-m1-introducing-profile/](http://blog.springsource.com/2011/02/14/spring-3-1-m1-introducing-profile/)

您建议的另一个解决方案是使用 覆盖`sequencer`测试中的 bean `TestSequencer`，方法是指定一个与您的 prod 排序器具有完全相同名称的 bean，或者在以测试模式导入的新应用程序上下文中指定它。***

# gwt - 在 UiBinder 模板中使用 i18n .properties 定义的映射

> ID：11335466
> 
> 赞同：0
> 
> 时间：2012-07-04T21:07:08.520
> 
> 标签：gwt

假设我`<String,String>`在 i18n .properties 文件中定义了一个地图，例如：

```
userGroupMap = 0, 1, 2, 3
0=Factory 
1=Administrators
2=Superusers
3=Operators 
```

开发指南[解释说](https://developers.google.com/web-toolkit/doc/latest/DevGuideI18nConstants#ConstantsProperties)，在接口中引入相应的`Map<String,String> userGroupMap()`方法`MyConstants implements Constants`会导致调用，例如`MyConstants.userGroupMap().get("1")`返回本地化的`"Administrators"`. 到现在为止还挺好。

UiBinder 呢？如何在 UiBinder 模板中使用其中一个映射值？是否有我遗漏的语法，例如`<ui:msg key="userGroupMap:1">Administrators</ui:msg>`（实际上不起作用）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T11:43:52.410

您可以这样做的一种方法是使用非 xml 解决方案，但您可以使用 @UiFactory 来帮助创建您需要 I18N 的特定字段或标签。但对我来说，这个特殊问题似乎需要下面的解决方案，因为您似乎希望将小部件与屏幕或面板布局分离。

我为此苦苦挣扎，为了我的实现，我最终制作了带有 UiBinder 支持其内部的核心小部件（例如标签和带有帮助按钮的文本字段），然后传入一个用作为各种地图中的所有 I18N 键预先设置。

例如，对于 PartNumber 字段，我在以下映射中有一个键：labelTexts()、helpTexts()、tooltipTexts()、defaultFieldValues()。然后在该小部件的构造函数中，我将传入字符串键“partNumber”，这将用于构建所需的所有键，因此我将调用 labelTexts().get('partNumberLabelText'), helpTexts() .get('partNumberHelpText') 等

我不想直接在 UiBinder 中执行此操作，因为我希望小部件键映射回它的显示信息，所以我可以使用尽可能少的输入信息创建一个小部件，在许多情况下只有键然后是小部件（如果它在 I18N 设置中正确配置）只会根据它填充地图中的所有内容。

From a design standpoint, for me it didn't make sense to have separate UiBinders for the screen sets, they were composited from objects that defined the screen layout and relation of all the widgets (meaning that you could define screen content at runtime).

# android - 如何测试 Google Play Android 订阅？

> ID：11335468
> 
> 赞同：3
> 
> 时间：2012-07-04T21:07:34.227
> 
> 标签：android, google-api, google-play

如何测试 Google Play Android 订阅和 Google API？

1.  应用已上传，但未发布。
2.  APK 已激活。
3.  订阅产品 ID 已发布。
4.  我试图在完全不相关的手机上购买订阅，而不是我的帐户。
5.  我测试的所有帐户都列在 Android Developer Console > Edit Profile
6.  BILLING_REQUEST_ITEM_TYPE 设置为“subs”。
7.  BILLING_REQUEST_API_VERSION 设置为 2。
8.  该应用程序已签名并发布版本，`ant release installr`.

    ```
    IGNORE THIS: When I try to purchase a subscription, it displays the subscription description, but immediately says "The item you are requesting to purchase is not available." 
    ```

我无法测试 Google Android Publisher Web API，[https://developers.google.com/android-publisher/v1/purchases/get](https://developers.google.com/android-publisher/v1/purchases/get)

```
IGNORE THIS: It requires a user subscription token but I can't get a token without buying a subscription! 
```

好的，它开始起作用了，我可以购买订阅。但是，服务器上的脚本中存在错误，因此我无法保存用户订阅令牌。现在，当我尝试重新购买订阅时，它会显示“您已经拥有此订阅”。

当我单击详细信息时，它显示“找不到项目”。带有重试按钮！

我觉得我是世界上唯一一个尝试使用这个 API 的人！

此外，Google 结算 API 中存在错误。`mBillingService.confirmNotifications()`在收到来自服务器的确认订阅已保存后，我才打电话，但我在我的商家帐户中看到了费用/存款。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T21:56:35.753

您是否在测试设备上安装了 .apk 的签名版本？为了让 Google Play 确认您的购买请求，需要对 .apk 进行签名（例如，通过 Eclipse 中常用的“导出”功能）

# c - Linux/ linux 中的文件和 F_TLOCK 问题

> ID：11335471
> 
> 赞同：2
> 
> 时间：2012-07-04T21:07:47.587
> 
> 标签：c, linux, file-io, fork

我读了一本关于 Linux 文件的书，它给出了下一个例子：

```
int main(char ** argv, int argc) {
  int stat;
  int fd = open("dugma1.txt", O_WRONLY, 0666);

  if (fork() == 0) {
    int fd2 = open("dugma1.txt", O_WRONLY, 0666);
    sleep(10);
    if (lockf(fd2, F_TLOCK, 17) >= 0) {
      write(fd2, "I was here second", 17);
    }
  } //if
  else {
    lockf(fd, F_TLOCK, 16);
    write(fd, "I was here first", 16);
    wait(&stat);    
  }
} 
```

它说输出将是: `I was here first`，原因是：我们不关闭文件。但我不明白这个解释。我们先写：`I was here first`，但是为什么后面`sleep(10)`我们就不去这部分代码了：

```
if (lockf(fd2, F_TLOCK, 17) >= 0) {
   write(fd2, "I was here second", 17);
} 
```

`F_TLOCK`是一个非阻塞的，为此我们将成功地写出“我是第二个”。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T21:26:35.370

```
lockf(fd2,F_TLOCK,17) 
```

遇到错误 (EAGAIN)，因此返回 -1。写入文件所需的值等于或大于 0，而不是 -1。测试失败，写入永远不会发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T21:44:54.930

父进程`lockf(fd, F_TLOCK, 16)`在打开的文件上执行，锁定第一个`16`字节。然后它在里面写入文本并等待孩子退出。它不会关闭文件，因此锁定仍然存在。如果`close(fd);`在 之后的父代码中有 a `write()`，则锁将被释放但没有。

孩子先睡了一会儿，当它试图锁定文件的前 17 个字节但由于父仍然拥有锁定而失败。这就是`lockf(fd2, F_TLOCK, 17)`失败的原因`EAGAIN`- 该操作应稍后重复。错误由返回值发出信号，该返回值`-1`使子代码中的条件不执行。

# eclipse - 使用 EGit 在某些文件中更改了换行符

> ID：11335473
> 
> 赞同：3
> 
> 时间：2012-07-04T21:08:02.013
> 
> 标签：eclipse, egit

我将**Eclipse Juno**与**EGit 2.0**一起使用，但遇到以下问题：

我刚刚使用 EGit 克隆了一个相当大的项目，我没有编辑任何文件并且我有一些文件要提交。如果我检查存储库状态，`git status`我会将这些文件视为未暂存的修改。

如果我`Compare With -> HEAD Revision`在 Eclipse 中对这些文件中的任何一个进行操作，我看不出有任何区别。但是，当我这样做时，我会`git diff`看到这样的事情：

```
diff --git a/PortalPlatform/WebContent/WEB-INF/fragment/someFile.jsp b/PortalPlatform/WebContent/WEB-INF/fragment/someFile.jsp
index f883dba..811ad83 100644
--- a/PortalPlatform/WebContent/WEB-INF/fragment/someFile.jsp
+++ b/PortalPlatform/WebContent/WEB-INF/fragment/someFile.jsp
@@ -34,7 +34,7 @@
                                    </c:forEach>
                            </select>
                    </c:if>
-                       <div><a href="reprintLastReceipt"><fmt:message key="label.link" /></a></div>
+                       <div><a href="reprintLastReceipt"><fmt:message key="label.link" /></a></div>^M
            </fieldset>
            <div class="widgetBut">
                    <a class="btn primary submit" href="#"><span><fmt:message key="button.reprint" /></span></a> 
```

它没有影响特定的文件类型，我遇到了 .java、.jsp、.css、.properties 和 .xml 文件的问题。

**为什么我只在某些文件中获得换行符的这些更改？我如何解决它？**

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T06:32:33.237

从 EGit 2.0 开始，根据[bug 301775](https://bugs.eclipse.org/bugs/show_bug.cgi?id=301775)，EGit 支持`core.autocrlf`.

它过去在创建 repo 时将 autocrlf 设置为 false，但[bug 382067](https://bugs.eclipse.org/bugs/show_bug.cgi?id=382067)和[修复 6316 解决](https://git.eclipse.org/r/#/c/6316/)了这个问题，这意味着它依赖于您在本地 Git 安装中的本地或全局设置（如 msysgit）。
正如我之前所说，这[应该始终设置为 false](https://stackoverflow.com/questions/1249932/git-1-6-4-beta-on-windows-msysgit-unix-or-dos-line-termination/1250133#1250133)。

如果您需要对某些文件的 EOL 进行细粒度控制，请[使用`core.eol`属性](https://stackoverflow.com/questions/3206843/how-line-ending-conversions-work-with-git-core-autocrlf-between-different-operat/3209806#3209806)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-04-19T08:38:09.260

有点老问题，但仍然有人可能有问题（就像我一样）。

**EGit 文档 > EGit 用户指南 >可以在[此处找到的](http://help.eclipse.org/oxygen/index.jsp)**入门**说明：**

 **> 指出系统范围的配置
> 
> 如果您使用 Git for Windows 作为 EGit 的伴侣，请确保 EGit 知道 Git 的安装位置，以便它可以找到“系统范围的设置”，例如 core.autocrlf 的设置方式。转到设置并查看 Team>Git>Configuration，然后查看 System Settings 选项卡。
> 
> 如果您在安装适用于 Windows 的 Git 时从命令行提示符中选择了使用 Git 的选项之一，那么系统范围设置的位置将使用路径填充，一切都很好。如果没有，请使用浏览按钮找到 Git 的安装位置，例如 C:\Program Files(x86)\Git。
> 
> 该建议也适用于其他 Git 包装的用户，例如 Cygwin 或 TortoiseGit 下的 Git。
> 
> 非 Windows 用户理论上应该检查此设置，但系统范围的设置通常不会在非 Windows 平台上使用。

正如我们所看到的，EGit 寻找 git 配置文件来了解“autocrlf”是如何被准确配置的。但在 Windows 下似乎找不到所有这些。

该命令将向我们展示 git 使用的配置：

> git config --list --show-origin

**在 Eclipse 中，我们可以在Windows > Preference > Team > Git > Configuration**中看到 git 的配置。这是一个问题：Eclipse 没有看到位于**C:\ProgramData\Git**文件夹中的配置文件，其中定义了 'autocrlf' 选项。

我最终复制了“autocrlf”值（在我的情况下是真的）

> [核]
> 
> autocrlf = 真

在位于主目录的用户“.gitconfig”文件中，一切正常。

另请参阅[Windows 上的 git - 配置文件的位置](https://www.onwebsecurity.com/configuration/git-on-windows-location-of-global-configuration-file.html)。**

# javascript - jquery水平剪辑

> ID：11335477
> 
> 赞同：1
> 
> 时间：2012-07-04T21:08:48.517
> 
> 标签：javascript, jquery, clip

所以我想要一个类似的效果：

[http://docs.jquery.com/UI/Effects/Clip](http://docs.jquery.com/UI/Effects/Clip)

但我希望水平剪切仅从左到右或从右到左发生（使用我将定义的参数），而不是同时从两侧朝向中心。我想知道我应该如何修改 jquery 代码来实现我所需要的。

就像是 ：

```
$(this).hide("clip", { direction: "horizontalL" }, 1000);
$(this).hide("clip", { direction: "horizontaLR" }, 1000); 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T21:11:22.903

你可以试试幻灯片：

```
$(this).hide("slide", { direction: "left" }, 1000); 
```

或者

```
$(this).hide("slide", { direction: "right" }, 1000); 
```

# php - PDO 执行（）抛出错误（42000）

> ID：11335479
> 
> 赞同：2
> 
> 时间：2012-07-04T21:08:55.323
> 
> 标签：php, pdo

我正在尝试使用 PDO 执行准备好的语句，但是尽管类似的语句在其他文件中运行良好，但我仍然收到错误消息。

这是我收到的错误：`Array ( [0] => 42000 [1] => 1064 [2] => 您的 SQL 语法有错误；请查看与您的 MySQL 服务器版本对应的手册以获取正确的语法在第 1 行的“商品”附近使用）1

这是代码的简化版本：

```
class Ben { 

    protected $_BTH;
    protected $_BTH;

    function __construct() {
        $this->_BBH = (---new PDO object---)
        $this->_BTH = $this->_BBH->prepare("SELECT * FROM :table");
    }
    my_function($table) {
        $this->_BTH->bindParam(':table', $table, PDO::PARAM_STR); // table == merch
        $this->_BTH->debugDumpParams(); // outputs SQL: [20] SELECT * FROM :table Params: 1 Key: Name: [6] :table paramno=-1 name=[6] ":table" is_param=1 param_type=2
        $execResult = $this->_BTH->execute();

        if ($execResult == false) {
            die(print_r($this->_BTH->errorInfo())); // prints out the error I wrote earlier
        }
    }
} 
```

我不知道语法错误在哪里，我是否使用了任何关键字？谢谢你的帮助 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T21:11:22.997

您无法准备表的名称。你也不应该。如果您的表名以某种方式来自用户输入，您可能应该重新考虑您的数据库结构。

# java - JSON / JSP 处理 - 成功函数，如何返回未存储在文件中的数据

> ID：11335482
> 
> 赞同：0
> 
> 时间：2012-07-04T21:09:36.463
> 
> 标签：java, jquery, ajax, serversocket

我有一个需要遵循的过程，我希望这是有道理的。

我有一个构建 json 数据并发送到 URL 的 JSP。此 URL 存在，因此会成功。

然而，一个基于 java 的服务器套接字类正在侦听一个端口，并实际获取正在发送的数据并对其进行处理。它需要为我生成一个响应来接收（即它正在发生的事情的成功或失败代码），我希望在 sucess 函数中获取该响应 - 但是这个 java 套接字侦听器代码并不打算将它写入 JSP或类似的东西。

java监听器和我的成功函数如何满足的任何想法，以便我可以得到这个响应。

在我的测试中，我让侦听器代码将响应放在 JSP 上，我选择了它，但是，我想要一种不必放在 JSP 上的方法。是否必须在 JSP/PHP/JSON 文件中实际提供/保存响应（将是 JSON 数据）？

这是我下面的发送代码：

```
$.ajax({    
 type:       "POST",    
 url:        suppliedURL,    
 data:       "jsonData=" + jsonString, // I have already done a json stringify on this. 
 success:    function(data, textStatus, jqXHR) {    
            var jsonJqXHR = JSON.stringify(jqXHR);   
            alert('jsonJqXHR : ' + jsonJqXHR);    
 },    
 error:function (xhr, ajaxOptions, thrownError){    
   alert('Error xhr : ' + xhr.status);    
   alert('Error thrown error: ' + thrownError);    
 },   
 dataType:   "json" 
```

});

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T21:45:23.120

在浏览器页面中运行的 Javascript 具有有限的通信和互连能力。在几乎任何浏览器中运行的 javascript 程序可以做的一件事就是发送 HTTP 请求。因此，将数据获取到 javascript 程序中的明显方法是通过 XMLHttpRequest，通过一些人称之为 AJAX 的模式。此模式在 jQuery ajax 函数中实现。

Javascript 程序需要连接到 HTTP 服务器 - 这就是 JSP 的用武之地。它是一个 Java 程序，可以响应 HTTP GET/POST 等。服务器上的 JSP 或类似的 HTTP 连接编程环境是必要的向 javascript 程序提供数据。

因此，唯一的挑战是将数据从运行在服务器上的 Java 套接字程序转移到也在服务器上运行的 JSP。处理它的一种简单方法是通过共享数据库或文件系统。

# c++ - 重复的 switch 语句需要重构

> ID：11335486
> 
> 赞同：0
> 
> 时间：2012-07-04T21:10:13.997
> 
> 标签：c++, refactoring, switch-statement

许多重复的 switch 语句似乎需要 DRY'd。有什么建议么？（包括什么都不做！）

```
AnimMapIter _iter;
    _iter = _animations->find(name);
    if(_iter == _animations->end()) return;

    if(_curName != name) {
        _curName = name;

        switch(dir) {
        case DIR_FORWARD_LOOPING: /* Fall through to DIR_FORWARD_NONLOOPING */
        case DIR_FORWARD_NONLOOPING:
            _iter->second->First();
            break;
        case DIR_REVERSE_LOOPING: /* Fall through to DIR_REVERSE_NONLOOPING */
        case DIR_REVERSE_NONLOOPING:
            _iter->second->Last();
            break;
        }
    } else {

        switch(dir) {
        case DIR_FORWARD_LOOPING: /* Fall through to DIR_FORWARD_NONLOOPING */
        case DIR_FORWARD_NONLOOPING:
            _iter->second->Next();
            break;
        case DIR_REVERSE_LOOPING: /* Fall through to DIR_REVERSE_NONLOOPING */
        case DIR_REVERSE_NONLOOPING:
            _iter->second->Previous();
            break;
        }

        switch(dir) {
            case DIR_FORWARD_LOOPING:
                if(_iter->second->IsAtEnd())
                    _iter->second->First();
                break;
            case DIR_FORWARD_NONLOOPING:
                if(_iter->second->IsAtEnd())
                    _iter->second->Last();
                break;
            case DIR_REVERSE_LOOPING:
                if(_iter->second->IsAtFront())
                    _iter->second->Last();
                break;
            case DIR_REVERSE_NONLOOPING:
                if(_iter->second->IsAtFront())
                    _iter->second->First();
                break;
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T22:34:28.863

沿着这些思路将逻辑推入任何`_iter->second`内容（假设您已经显示的方法存在）：

```
class WhateverItIs
{
public:
   void Start() { if (m_forward) First(); else Last(); }
   void Stop()  { if (m_forward) Last(); else First(); }
   void Advance()
   {
      if (m_forward)
         Next();
      else
         Previous();
      if (IsLast())
      {
         if (m_loop)
            Start();
         else
            Stop();
      }
   }

private:
   bool IsLast() const
   {
      return m_forward ? IsAtEnd() : IsAtFront();
   }
   // Direction and looping are independent concepts.    
   bool m_forward;
   bool m_loop;
}; 
```

然后你可以写：

```
AnimMapIter _iter;
_iter = _animations->find(name);
if(_iter == _animations->end()) return;

if(_curName != name) {
    _curName = name;
    _iter->second->Start();
} else {
    _iter->second->Advance();
} 
```

* * *

编辑：使用自由函数并保持常量的示例。

```
 void Start(Strip* s, bool forward) 
        { if (forward) s->First(); else s->Last(); }
   void Stop(Strip* s, bool forward) 
        { if (forward) s->Last() else s->First(); }
   void Advance(Strip* s, bool forward, bool loop)
   {
      if (forward)
         s->Next();
      else
         s->Previous();
      if (IsLast(s, forward))
      {
         if (loop)
            Start(s);
         else
            Stop(s);
      }
   }

   bool IsLast(const Strip* s, bool forward) const
   {
      return forward ? s->IsAtEnd() : s->IsAtFront();
   } 

   bool Projector::IsForward() const
   { 
       return dir == DIR_FORWARD_LOOPING || dir == DIR_FORWARD_NONLOOPING; 
   }

   bool Projector::IsLooping() const
   {
       return dir == DIR_REVERSE_LOOPING || dir == DIR_FORWARD_LOOPING;
   }

    if(_curName != name) {
        _curName = name;
        Start(_iter->second, IsForward());
    } else {
        Advance(_iter->second, IsForward(), IsLooping());
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-11T04:27:54.483

else 下的所有内容都应该折叠成一个开关，以使相关步骤更接近；例如

```
case DIR_FORWARD_LOOPING:
    _iter->second->Next();
    if (_iter->second->IsAtEnd()) {
        _iter->second->First();
    }
    break; 
```

……都在那种情况下。重复几个函数调用并不是什么大问题，因为它可以使整个动作序列更加清晰。

# wcf - 使用 Windows 进程使用 wcf 服务？

> ID：11335489
> 
> 赞同：3
> 
> 时间：2012-07-04T21:10:30.967
> 
> 标签：wcf, static, wcf-client, wcf-hosting

我需要在托管服务启动后尽快初始化 wcf 服务类中的一些结构。

现在我将它托管在 WinForms 应用程序中，并在那里初始化这个静态结构。

```
ServiceHost host = new...
host.Open()...
new MyServiceClient().Initialize(); 
```

但我确信有更好的方法来做到这一点。我现在知道这是一个不优雅的解决方案......也许小 wcf-client 作为 Windows 进程运行？（这个客户端应该只负责调用这个初始化方法）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T03:45:06.533

您可以使用服务的构造函数来执行所需的任何初始化工作。

```
// The service
public class MyService : IMyService {
    // Constructor
    public MyService() {
        // Initialize things here
    }
} 
```

如果初始化工作应该只执行一次，则可以将构造函数设为静态。如果正在构建的东西不是静态的，您可以根据您的性能需求将服务设为单例。您可以使用以下代码来装饰服务：

```
[ServiceBehavior(InstanceContextMode = InstanceContextMode.Single)] 
```

# java - 如何以编程方式更改包资源管理器中的选择

> ID：11335491
> 
> 赞同：5
> 
> 时间：2012-07-04T21:11:06.683
> 
> 标签：java, eclipse, eclipse-plugin, package-explorer

我目前正在为 Eclipse 开发一个插件，它分析 Eclipse 工作区中项目之间的依赖关系和引用，并将它们显示在类似 UML 的图表中的自己的视图中。

为了增加我的插件的实用性，我希望通过允许用户在包资源管理器中打开项目并在适用的情况下通过单击显示的图形在编辑器中打开它来为图表添加交互性。

但是，我的问题是，虽然我知道如何从包资源管理器中获取给定的选择，但我无法找到更改选择的方法，或者只是以编程方式在包资源管理器中打开一个项目。

有没有人有这个问题的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-11-29T09:14:39.390

这个答案扩展了[接受的答案](https://stackoverflow.com/a/11380524/499797)状态，但对于那些*介意*使用`PackageExplorerPart`. 您看到的确切警告（更多以便更轻松地在 Google 上搜索）是

> 不鼓励访问：`PackageExplorerPart`由于对所需库的限制，无法访问 该类型`/eclipse_install_path/eclipse/plugins/org.eclipse.jdt.ui_3.9.1.v20130820-1427.jar`

**代码示例：**

```
final IWorkbenchPart activePart = getActivePart();
if (activePart != null && activePart instanceof IPackagesViewPart) {
    ((IPackagesViewPart) activePart).selectAndReveal(newElement);
} 
```

*支持代码：*

```
private IWorkbenchPart getActivePart() {
    final IWorkbench workbench = PlatformUI.getWorkbench();
    final IWorkbenchWindow activeWindow = workbench.getActiveWorkbenchWindow();
    if (activeWindow != null) {
        final IWorkbenchPage activePage = activeWindow.getActivePage();
        if (activePage != null) {
            return activePage.getActivePart();
        }
    }
    return null;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-08T03:51:03.407

我找到了解决方案。Eclipse 确实提供了对 中的包资源管理器的直接访问`org.eclipse.jdt.internal.ui.packageview.PackageExplorerPart`，但不鼓励这样做。

```
import org.eclipse.jdt.internal.ui.packageview.PackageExplorerPart;

...

PackageExplorerPart part= PackageExplorerPart.getFromActivePerspective();
IResource resource =  /*any IResource to be selected in the explorer*/;

part.selectAndReveal(resource); 
```

这将突出显示 IResource`resource`是什么，并根据需要展开树。

# python - 多个 Phonon audioOutput 实例在 Linux 上无法正常工作？

> ID：11335497
> 
> 赞同：1
> 
> 时间：2012-07-04T21:11:52.623
> 
> 标签：python, linux, volume, pyside, phonon

我正在开发一个音板程序。该窗口填充了以下 SoundPlayer 类的多个实例。运行我的程序时，音量滑块不会影响他们自己的播放器。最后启动的播放器的音量滑块控制整个节目的音量。我已经打印出了所有的 audioObjects、volumeSliders 等实例，并且没有一个在播放器之间共享。我让每个播放器打印出它的音量，并且使用正确的音量滑块确实会改变音量（audioOutput.volume()），但没有声音效果。使用最后启动的音量滑块，其他播放器的 audioOutput 音量不会改变音量值，但会产生声音效果。我很茫然，因为这在多台 Windows 机器上运行得非常好，但在 ubuntu 12.04 上却不行。

编辑：似乎问题更多在于音频输出。我将一些按钮连接到 .setVolume() 并手动调节音量，它的窃听器和以前一样。只有最后启动的播放器的音量实际上会影响可听声音，并且对每个播放器都这样做。

SoundPlayer 类：（为简洁起见，修剪了一些 ui 设置。关键部分包括创建 audioOutputs 和 MediaObjects 的 createAttr()/loadAttr() 以及创建音量滑块的 setupUi()。）

```
class SoundPlayer():
  def __init__(self, MainWindow, position, instance, attributes):
    self.instance = instance
    self.mainWindow = MainWindow
    self.pos = position
    self.setupUi(self.pos)
    if attributes == '':
      self.createAttr()
      self.attributes = [self.name, self.filename]
    else:
      self.attributes = attributes
      self.loadAttr()
    self.buttons()
    self.directory = QDesktopServices.storageLocation(QDesktopServices.MusicLocation)

  def updateDevice(self, device):
    self.audio.setOutputDevice(device)
    Phonon.createPath(self.media, self.audio)

  def loadAttr(self):
    self.name = self.attributes[0]
    self.filename = self.attributes[1]
    self.media = Phonon.MediaObject(self.instance)
    self.audio = Phonon.AudioOutput(Phonon.MusicCategory, self.instance)
    self.source = Phonon.MediaSource(self.filename)
    Phonon.createPath(self.media, self.audio)
    self.label.setText(self.name)
    self.updateUi()

  def createAttr(self):
    self.filename = ''
    self.name = 'None'
    self.media = Phonon.MediaObject(self.instance)
    self.audio = Phonon.AudioOutput(Phonon.MusicCategory, self.instance)
    self.source = Phonon.MediaSource(self.filename)
    Phonon.createPath(self.media, self.audio)
    self.media.stateChanged.connect(lambda x,y: self.changed(x,y))
    self.label.setText(self.name)
    self.updateUi()

  def saveAttr(self):
    self.attributes = [self.name, self.filename]

  def buttons(self):
    self.playButton.clicked.connect(self.onplaybutton())
    self.resetButton.clicked.connect(self.onresetbutton())
    self.stopButton.clicked.connect(self.onstopbutton())
    self.optionButton.clicked.connect(self.optionDialog())

  def onplaybutton(self):
    state = self.media.state()
    if state != Phonon.State.PausedState and state != Phonon.State.PlayingState:
      self.playButton.setIcon(QtGui.QIcon(":pause.png"))
      self.media.setCurrentSource(self.source)
      self.media.play()
    elif state == Phonon.State.PlayingState:
      self.playButton.setIcon(QtGui.QIcon(":play.png"))
      self.media.pause()
    elif state == Phonon.State.PausedState:
      self.playButton.setIcon(QtGui.QIcon(":pause.png"))
      time = self.media.currentTime()
      self.media.play()
      self.media.seek(time)

  def onresetbutton(self):
    self.media.setCurrentSource(self.source)
    self.media.play()
    self.playButton.setIcon(QtGui.QIcon(":pause.png"))

  def onstopbutton(self):
    self.media.stop()
    self.playButton.setIcon(QtGui.QIcon(":play.png"))

  def updateUi(self):
    self.seek = Phonon.SeekSlider(self.media, self.widget)
    self.seek.resize(111, 21)
    self.seek.show()
    self.volume = Phonon.VolumeSlider(self.audio, self.volumeWidget)
    self.volume.resize(111, 21)
    self.volume.show()
    self.playButton.setIcon(QtGui.QIcon(":play.png"))
    self.media.stateChanged.connect(lambda x,y: self.changed(x,y)) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-18T05:43:13.763

很可能不是你的错： [https ://bugs.kde.org/show_bug.cgi?id=321288](https://bugs.kde.org/show_bug.cgi?id=321288)

# php - 使用 Jquery 将复选框值传递给 PHP 并在 div 中显示结果

> ID：11335501
> 
> 赞同：1
> 
> 时间：2012-07-04T21:12:03.153
> 
> 标签：php, jquery, checkbox

我想用 jQuery 过滤实时结果（就像在这个网站[http://shop.www.hi.nl/hi/mcsmambo.p?M5NextUrl=RSRCH](http://shop.www.hi.nl/hi/mcsmambo.p?M5NextUrl=RSRCH)上一样）。因此，当有人选中复选框时，结果应该实时更新（在 div 中）。现在我是 jQuery 的新手，我尝试了很多例子，但我无法让它工作。这是我的代码，谁能告诉我做错了什么？非常感谢！

**HTML**

```
<div id="c_b">
    Kleur:<br />
    <input type="checkbox" name="kleur[1]" value="Blauw"> Blauw <br />
    <input type="checkbox" name="kleur[2]" value="Wit"> Wit <br />
    <input type="checkbox" name="kleur[3]" value="Zwart"> Zwart <br />
    <br />
    Operating System:<br />
    <input type="checkbox" name="os[1]" value="Android"> Android <br />
    <input type="checkbox" name="os[2]" value="Apple iOS"> Apple iOS <br />
    </div>

<div id="myResponse">Here should be the result</div> 
```

**jQuery**

```
function updateTextArea() {         
     var allVals = [];
     $('#c_b :checked').each(function() {
       allVals.push($(this).val());
     });

     var dataString = $(allVals).serialize();

    $.ajax({
        type:'POST',
        url:'/wp-content/themes/u-design/filteropties.php',
        data: dataString,
        success: function(data){
            $('#myResponse').html(data);
        }
    });
  }

$(document).ready(function() {
   $('#c_b input').click(updateTextArea);
   updateTextArea();  
}); 
```

**PHP**

```
//Just to see if the var passing works
echo var_export($_POST); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T23:01:32.527

您使用[.serialize()](http://api.jquery.com/serialize/)不正确，它仅适用于表单元素。

有了这段代码，我想你会得到你需要的。

**Javascript/JQuery**

```
function updateTextArea() {         

    var allVals = "";

    $('#c_b input[type=checkbox]:checked').each(function() {

        currentName = $(this).attr("name");
        currentVal  = $(this).val();

        allVals = allVals.concat( (allVals == "") ? currentName + "=" + currentVal : "&" + currentName + "=" + currentVal );

    });

    $.ajax({
        type:'POST',
        url:'/wp-content/themes/u-design/filteropties.php',
        data: allVals,
        dataType: "html",
        success: function(data){
            $('#myResponse').html(data);
        }
    });

  }

$(document).ready(function() {

   $('#c_b input[type=checkbox]').click(updateTextArea);

   updateTextArea();  

}); 
```

# php - 无法扩展位于另一个文件中的类，PHP

> ID：11335502
> 
> 赞同：1
> 
> 时间：2012-07-04T21:12:40.730
> 
> 标签：php, oop

我正在尝试设置一个具有常用任务的类，例如准备输入数据库的字符串和创建 PDO 对象。我想将此文件包含在其他类文件中，并扩展这些类以使用公共类的代码。

但是，当我将公共类放在它自己的文件中并将其包含在将要使用的类中时，我收到一个错误，指出找不到第二个类。例如，如果类名是`foo`并且它正在扩展`bar`（公共类，位于其他地方），则错误表示`foo`找不到。但是，如果我将类的代码`bar`放在与 相同的文件中`foo`，它就可以工作。

以下是有问题的课程 - **普通课程**

```
abstract class coreFunctions {
    protected $contentDB;

    public function __construct() {
        $this->contentDB = new PDO('mysql:host=localhost;dbname=db', 'username', 'password');
    }

    public function cleanStr($string) {
        $cleansed = trim($string);
        $cleansed = stripslashes($cleansed);
        $cleansed = strip_tags($cleansed);
        return $cleansed;
    }
} 
```

**个别类的代码**

```
include $_SERVER['DOCUMENT_ROOT'] . '/includes/class.core-functions.php';
$mode = $_POST['mode'];

if (isset($mode)) {
    $gallery = new gallery;
    switch ($mode) {
        case 'addAlbum':
            $gallery->addAlbum($_POST['hash'], $_POST['title'],
                               $_POST['description']);
    }
}

class gallery extends coreFunctions {

    private function directoryPath($string) {
        $path = trim($string);
        $path = strtolower($path);
        $path = preg_replace('/[^ \pL \pN]/', '', $path);
        $path = preg_replace('[\s+]', '', $path);
        $path = substr($path, 0, 18);

        return $path;
    }
    public function addAlbum($hash, $title, $description) {
        $title = $this->cleanStr($title);
        $description = $this->cleanStr($description);
        $path = $this->directoryPath($title);

        if ($title && $description && $hash) {
            $addAlbum = $this->contentDB->prepare("INSERT INTO gallery_albums
                                        (albumHash, albumTitle, albumDescription,
                                        albumPath)
                                        VALUES
                                        (:hash, :title, :description, :path)");
            $addAlbum->execute(array('hash' => $hash, 'title' => $title, 'description' => $description,
                                     'path' => $path));
        }
    }
} 
```

我以这种方式尝试时的错误是 `Fatal error: Class 'gallery' not found in /home/opheliad/public_html/admin/photo-gallery/includes/class.admin_photo-gallery.php on line 10`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T21:14:22.377

~~您需要`include`或`require`带有原始类的文件。否则 PHP 将看不到它。~~

确保包含成功，启用错误报告以查看错误，或用于`require`在失败时触发致命错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T21:39:04.537

Still learning the ins and outs of OOP. After a few minutes of research I came across `spl_autoload_register` in the PHP documentation.

I placed the `coreFunctions` class in `/includes/classes/coreFunctions.class.php` and the `gallery` class in `/includes/classes/gallery.class.php`

My code then became:

```
function cvfdAutoloader($class) {
    include $_SERVER['DOCUMENT_ROOT'] . '/includes/classes/' . $class . '.class.php';
}

spl_autoload_register('cvfdAutoloader');
$mode = $_POST['mode'];

if (isset($mode)) {
    $gallery = new gallery;
    switch ($mode) {
        case 'addAlbum':
            $gallery->addAlbum($_POST['hash'], $_POST['title'],
                               $_POST['description']);
    }
} 
```

And it works! Would someone care to shed some light on what exactly is happening here that is different from just including coreFunctions?

# html - 如何用 Perl 解析无效的 HTML？

> ID：11335503
> 
> 赞同：6
> 
> 时间：2012-07-04T21:12:41.497
> 
> 标签：html, perl, parsing, html-parsing

我维护一个带有 HTML 格式的文章数据库。不幸的是，写文章的编辑不知道正确的 HTML，所以他们经常写这样的东西：

```
<div class="highlight"><html><head></head><body><p>Note that ...</p></html></div> 
```

我尝试使用`HTML::TreeBuilder`来解析这个 HTML，但是在解析它并转储生成的树之后，之间的所有元素`<div class="highlight">...</div>`都消失了。我只剩下`<div class="highlight"></div>`.

编辑们也经常做以下事情：

```
<div class="article"><style>@font-face {   font-family: "Cambria"; }</style>Article starts here</div> 
```

解析这个`HTML::TreeBuilder`结果再次为空`<div class="article"></div>`。

任何想法如何处理这个破碎的 HTML 并真正理解它？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-04T22:30:37.370

我会首先通过[HTML::Tidy](http://search.cpan.org/perldoc/HTML%3a%3aTidy)运行它：

```
#!/usr/bin/env perl

use strict; use warnings;
use HTML::Tidy;

my $html = <<EO_HTML;
<div class="highlight"><html><head></head>
<body><p>Note that ...</p></html>
</div>
EO_HTML

my $tidy = HTML::Tidy->new;

print $tidy->clean( $html ); 
```

输出：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
<head>
<meta name="generator" content="tidyp for Windows (v1.04), see www.w3.org">
<title></title>
</head>
<body>
<div class="highlight">
<p>Note that ...</p>
</div>
</body>
</html> 
```

您可以通过设置各种配置选项来控制输出。

然后，通过解析器提供清理后的 HTML。

[否则，您可以尝试使用HTML::TokeParser::Simple](http://search.cpan.org/perldoc/HTML%3a%3aTokeParser%3a%3aSimple)或什至仅使用[HTML::Parser](http://search.cpan.org/perldoc/HTML%3a%3aParser)一步一步地构建树，但我相信这种方式很疯狂。

请记住，尝试构建树表示的解析器将比仅识别所看到的各种元素的流解析器更严格。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-08T09:38:29.863

您可以尝试使用[Marpa::HTML](http://search.cpan.org/perldoc?Marpa%3A%3AHTML)，它是一种高级 HTML 解析器，允许非常自由的解析。*它甚至可以使用作者称为ruby​​ slippers*的技术解析无效的 HTML ；Marpa::HTML 添加了应该存在的元素。

请参阅Marpa 解析器和 Marpa::HTML 的作者 Jeffrey Kegler[如何解析 HTML](http://blogs.perl.org/users/jeffrey_kegler/2011/11/how-to-parse-html.html)博客文章中的重新格式化、美化和使无效 HTML 示例有效的示例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-05T15:54:41.897

[如果使用得当， XML::LibXML](https://metacpan.org/module/XML%3a%3aLibXML)也可能令人惊讶地擅长这种清理工作。它也非常快；一旦你超越了它的学习曲线，它就会变得深入/灵活。

```
#!/usr/bin/env perl
use strictures;
use XML::LibXML;

my @craptastic = ( '<div class="article"><style>@font-face{ font-family: "Cambria" }</style>Article starts here</div>',
                   '<div class="highlight"><html><head></head><body><p>Note that ...</p></html></div>' );

# The inline setting of recover_silently is broken/non-functional so
# we do the method calls to set.
my $parser = XML::LibXML->new();
$parser->recover_silently(1);
$parser->keep_blanks(1);

for my $crap ( @craptastic )
{
    my $doc = $parser->load_html( string => $crap );

    # Optional example for killing style tags not in the <head/>
    $_->parentNode->removeChild($_) for $doc->findnodes("//body//style");

    print $/, $crap, $/;
    my ( $body ) = $doc->findnodes("//body");
    print "-" x 60, $/;
    print $_->serialize(1) for $body->childNodes;
    print $/, $/;
} 
```

给你-

```
<div class="article"><style>@font-face{ font-family: "Cambria" }</style>Article starts here</div>
------------------------------------------------------------
<div class="article">Article starts here</div>

<div class="highlight"><html><head></head><body><p>Note that ...</p></html></div>
------------------------------------------------------------
<div class="highlight">
  <p>Note that ...</p>
</div> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-05T07:50:04.033

听起来像[标签汤](http://en.wikipedia.org/wiki/Tag_soup)。作为另一种方法，您还可以在 perl 程序中使用 java 程序“ [html-tagsoup](http://home.ccil.org/~cowan/XML/tagsoup/) ”（例如，使用反引号）。它可以像这样被称为独立程序。

```
java -jar tagsoup-1.2.1 [option ...] [file ...] 
```

我认为 HTML::Tidy 曾经更好或更灵活。

# ios - 同一 iPad 应用程序的不同图标和标题

> ID：11335504
> 
> 赞同：1
> 
> 时间：2012-07-04T21:12:59.157
> 
> 标签：ios, icons, versions, in-house-distribution

我正在开发一个 iPad 应用程序，它将在“内部”分发，即仅在企业内部分发。他们问我是否可以制作相同应用程序的 2 个不同版本以安装在同一个 iPad 上。

第一个将与生产服务器通信，而第二个将使用沙盒服务器，用户将使用它来学习系统。服务器 url 将在应用程序设置中更改。

他们告诉我通过图标和标题（当然还有导航栏中的标题）来区分这些版本。实现这一目标避免重复项目的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T23:27:05.333

听起来你有3个变量：

*   接口地址
*   姓名
*   图标

一个想法可能是添加一个单独的构建配置，称之为“沙盒”。这是一个[如何创建新构建配置](https://stackoverflow.com/a/6218526/1264925)的示例。然后，有两个单独的 Info.plist 文件指定“捆绑显示名称”和“图标文件”。复制现有的 Info.plist 并将其命名为“Sandbox-Info.plist”。

然后，在您的项目设置中，选择目标（在左侧）和“构建设置”选项卡。搜索“Info.plist 文件”，然后展开它。对于 Sandbox 条目（您之前设置的构建配置的名称），将此条目更改为您创建的 Sandbox-Info.plist 文件。

这包括名称和图标设置。对于 API 地址，请在“构建设置”选项卡中搜索“其他 C 标志”。展开它。对于每一行，添加一个值，例如：

```
-DAPI_URI=@\"http://api.example.com\" 
```

将沙盒条目的此项更改为您的沙盒 URI。

最后，在您的代码中，将 API_URI 引用为您的 API 地址的字符串。

希望这可以帮助！

# javascript - 防止哈希导航 url

> ID：11335506
> 
> 赞同：0
> 
> 时间：2012-07-04T21:13:22.377
> 
> 标签：javascript, jquery

我有以下问题：我正在使用滑块（尾声）让人们浏览一些“页面”。滑块使用哈希链接导航到下一页/幻灯片。如果用户在第一页 (#page1)，则有一个链接将引导用户到第二页 (#page2)，依此类推。在滑块的顶部，页面编号显示为链接，但仅在访问页面时显示。因此，如果有六个页面，并且用户从第一页导航到第二页，然后是第三页，则滑块顶部只有三个链接（到第一页、第二页和第三页）。

问题是用户可以导航到第五页（或实际上的任何页面），而无需首先访问第五页之前的页面，只需使用哈希 URL 并在其地址栏中键入整个链接。例如，如果我输入

www.mydomain.com/slider/index.php#page5

滑块会自动导航到滑块的第五张幻灯片/页面，从而跳过前四张。我想让用户仅在访问过前四个时才导航到#page5（因此通过单击幻灯片）。这意味着如果他们通过在地址栏中输入 URL 直接转到#page5，我希望他们被发送到第一页 (#page1)。

有人对解决这个问题有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T21:37:07.393

如果这对您来说确实是个问题，您可以简单地删除文档就绪上的任何主题标签并重新加载页面。

# node.js - nodejs响应速度和nginx

> ID：11335510
> 
> 赞同：9
> 
> 时间：2012-07-04T21:14:01.297
> 
> 标签：node.js, nginx

刚刚开始测试 nodejs，并希望在理解以下行为方面获得一些帮助：

### 示例 #1：

```
var http = require('http');
http.createServer(function(req, res){
    res.writeHeader(200, {'Content-Type': 'text/plain'});
    res.end('foo');
}).listen(1001, '0.0.0.0'); 
```

### 示例 #2：

```
var http = require('http');
http.createServer(function(req, res){
    res.writeHeader(200, {'Content-Type': 'text/plain'});
    res.write('foo');
    res.end('bar');
}).listen(1001, '0.0.0.0'); 
```

在 Chrome 中测试响应时间时：

> 示例 #1 - 6-10 毫秒
> 示例 #2 - 200-220 毫秒

但是，如果通过 nginx proxy_pass 测试这两个示例

```
server{
    listen 1011;
    location / {
        proxy_pass http://127.0.0.1:1001;
    }
} 
```

我明白了：

> 示例 #1 - 4-8 毫秒
> 示例 #2 - 4-8 毫秒

我不是 nodejs 或 nginx 的专家，请问是否有人可以解释这一点？

nodejs - v.0.8.1
nginx - v.1.2.2

## 更新：

感谢 Hippo，我在有和没有 nginx 的服务器上使用 ab 进行了测试，得到了相反的结果。

还添加到 nginx 配置 proxy_cache off

```
server{
    listen 1011;
    location / {
        proxy_pass http://127.0.0.1:1001;
        proxy_cache off;
    }
} 
```

## 示例＃1直接：

> ab -n 1000 -c 50 http://127.0.0.1:1001/

```
    服务器软件：        
    服务器主机名：127.0.0.1
    服务器端口：1001

    文件路径：/
    文档长度：65 字节

    并发级别：50
    测试时间：1.018 秒
    完成请求：1000
    失败的请求：0
    写入错误：0
    总传输量：166000 字节
    传输的 HTML：65000 字节
    每秒请求数：981.96 [#/sec]（平均值）
    每个请求的时间：50.919 [ms]（平均值）
    每个请求的时间：1.018 [ms]（平均值，所有并发请求）
    传输速率：收到 159.18 [Kbytes/sec]

    连接时间（毫秒）
                  最小值平均值[+/-sd] 中值最大值
    连接：0 0 0.6 0 3
    处理：0 50 44.9 19 183
    等待：0 49 44.8 17 183
    总计：1 50 44.7 19 183

```

## 示例 #1 nginx：

> ab -n 1000 -c 50 http://127.0.0.1:1011/

```
    服务器软件：nginx/1.2.2
    服务器主机名：127.0.0.1
    服务器端口：1011

    文件路径：/
    文档长度：65 字节

    并发级别：50
    测试时间：1.609 秒
    完成请求：1000
    失败的请求：0
    写入错误：0
    总传输量：187000 字节
    传输的 HTML：65000 字节
    每秒请求数：621.40 [#/sec]（平均）
    每个请求的时间：80.463 [ms]（平均）
    每个请求的时间：1.609 [ms]（平均值，所有并发请求）
    传输速率：收到 113.48 [Kbytes/sec]

    连接时间（毫秒）
                  最小值平均值[+/-sd] 中值最大值
    连接：0 0 0.6 0 3
    处理：2 77 44.9 96 288
    等待：2 77 44.8 96 288
    总计：3 78 44.7 96 288

```

## 示例＃2直接：

> ab -n 1000 -c 50 http://127.0.0.1:1001/

```
    服务器软件：        
    服务器主机名：127.0.0.1
    服务器端口：1001

    文件路径：/
    文档长度：76 字节

    并发级别：50
    测试时间：1.257 秒
    完成请求：1000
    失败的请求：0
    写入错误：0
    总传输量：177000 字节
    传输的 HTML：76000 字节
    每秒请求数：795.47 [#/sec]（平均值）
    每个请求的时间：62.856 [ms]（平均）
    每个请求的时间：1.257 [ms]（平均值，所有并发请求）
    传输速率：收到 137.50 [Kbytes/sec]

    连接时间（毫秒）
                  最小值平均值[+/-sd] 中值最大值
    连接：0 0 0.3 0 2
    处理：0 60 47.8 88 193
    等待：0 60 47.8 87 193
    总计：0 61 47.7 88 193

```

## 示例#2 nginx：

> ab -n 1000 -c 50 http://127.0.0.1:1011/

```
    服务器软件：nginx/1.2.2
    服务器主机名：127.0.0.1
    服务器端口：1011

    文件路径：/
    文档长度：76 字节

    并发级别：50
    测试时间：1.754 秒
    完成请求：1000
    失败的请求：0
    写入错误：0
    总传输量：198000 字节
    传输的 HTML：76000 字节
    每秒请求数：570.03 [#/sec]（平均）
    每个请求的时间：87.715 [ms]（平均）
    每个请求的时间：1.754 [ms]（平均值，所有并发请求）
    传输速率：收到 110.22 [Kbytes/sec]

    连接时间（毫秒）
                  最小值平均值[+/-sd] 中值最大值
    连接：0 0 0.4 0 2
    处理：1 87 42.1 98 222
    等待：1 86 42.3 98 222
    总计：1 87 42.0 98 222

```

现在结果看起来更有逻辑了，但是调用时仍然有一个奇怪的延迟`res.write()`

我想这是（当然看起来）一个愚蠢的问题，但我仍然在浏览器的响应时间与这个服务器配置（Centos 6）和这个具体的服务器（vps）有很大的不同。

在我的家用计算机（Ubuntu 12）上，但从 localhost 测试旧版本一切正常。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-04T22:05:03.557

查看 http.js 会发现案例 #1 在 nodejs 本身中有特殊处理，我猜是某种快捷优化。

```
var hot = this._headerSent === false &&
            typeof(data) === 'string' &&
            data.length > 0 &&
            this.output.length === 0 &&
            this.connection &&
            this.connection.writable &&
            this.connection._httpMessage === this;

      if (hot) {
        // Hot path. They're doing
        //   res.writeHead();
        //   res.end(blah);
        // HACKY.

        if (this.chunkedEncoding) {
          var l = Buffer.byteLength(data, encoding).toString(16);
          ret = this.connection.write(this._header + l + CRLF +
                                      data + '\r\n0\r\n' +
                                      this._trailer + '\r\n', encoding);
        } else {
          ret = this.connection.write(this._header + data, encoding);
        }
        this._headerSent = true;

      } else if (data) {
        // Normal body write.
        ret = this.write(data, encoding);
      }

      if (!hot) {
        if (this.chunkedEncoding) {
          ret = this._send('0\r\n' + this._trailer + '\r\n'); // Last chunk.
        } else {
          // Force a flush, HACK.
          ret = this._send('');
        }
      }

      this.finished = true; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-04T21:26:17.750

我已经为您提供了示例文件并使用`ab`（Apache Benchmark）作为对 HTTP 服务器性能进行基准测试的**合适**工具：

**示例 1：**

```
Concurrency Level:      50
Time taken for tests:   0.221 seconds
Complete requests:      1000
Failed requests:        0
Write errors:           0
Total transferred:      104000 bytes
HTML transferred:       3000 bytes
Requests per second:    4525.50 [#/sec] (mean)
Time per request:       11.049 [ms] (mean)
Time per request:       0.221 [ms] (mean, across all concurrent requests)
Transfer rate:          459.62 [Kbytes/sec] received

Connection Times (ms)
              min  mean[+/-sd] median   max
Connect:        0    0   0.7      0       4
Processing:     1   11   6.4     10      32
Waiting:        1   11   6.4     10      32
Total:          1   11   6.7     10      33 
```

**示例 2：**

```
Concurrency Level:      50
Time taken for tests:   0.256 seconds
Complete requests:      1000
Failed requests:        0
Write errors:           0
Total transferred:      107000 bytes
HTML transferred:       6000 bytes
Requests per second:    3905.27 [#/sec] (mean)
Time per request:       12.803 [ms] (mean)
Time per request:       0.256 [ms] (mean, across all concurrent requests)
Transfer rate:          408.07 [Kbytes/sec] received

Connection Times (ms)
              min  mean[+/-sd] median   max
Connect:        0    0   0.6      0       4
Processing:     1   12   7.0     12      34
Waiting:        1   12   6.9     12      34
Total:          1   12   7.1     12      34 
```

**笔记：**

第二个例子和第一个例子一样快。小的差异可能是由于代码中的附加函数调用以及文档大小比第一个更大的事实造成的。

# security - 从标准输入到 shell 的任意输入

> ID：11335511
> 
> 赞同：0
> 
> 时间：2012-07-04T21:14:13.233
> 
> 标签：security, shell, unix

所以我有这个接受单个参数的现有命令，但我需要一些可以通过标准输入接受参数的东西。

像下面这样的 shell 脚本包装器可以工作，但由于我将允许不受信任的用户在标准输入上传递任意字符串，我想知道是否有人可能在 shell 上执行任意命令。

```
#!/bin/sh
$CMD "`cat`" 
```

显然，如果 $CMD 在处理参数的方式上有漏洞，我无能为力，所以我担心这样的事情：

*   以某种方式允许用户转义双引号并将输入传递给 $CMD 的参数 #2
*   不知何故导致另一个任意命令运行

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T21:23:45.183

该参数对我来说看起来不错，但命令可能有点不稳定，如果它可以有一个空格。此外，如果您只想从用户那里得到一行，那么您可能更喜欢这样：

```
#!/bin/bash

read line
exec "$CMD" "$line" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T21:25:05.353

`"$(cmd)"`如果可以扩展到多个单词，则会破坏很多代码。

# c++ - 增加计数器时避免竞争条件

> ID：11335513
> 
> 赞同：1
> 
> 时间：2012-07-04T21:14:17.003
> 
> 标签：c++, multithreading, boost, boost-thread

我以前就这个话题发过帖子，但到目前为止我还没有多少运气。我把它归结为我的一个坏问题。这次我做了一个简短的可编译示例，显示了我试图避免的不良行为。我希望这是赞赏。

问题是两个（或更多）线程被设置为运行相同的进程，它们的“id”决定了它们操作的变量数据的哪一部分。目前两个线程都将更新计数器。

当前输出如下所示，

```
tid = 0, var[tid] = 0
tid = 0, var[tid] = 1
tid = 0, var[tid] = 2
tid = 0, var[tid] = 3
tid = 0, var[tid] = 4
tid = 0, var[tid] = 5
tid = 0, var[tid] = 6
tid = 0, var[tid] = 7
tid = 0, var[tid] = 8
tid = 0, var[tid] = 9
tid = 1, var[tid] = 0
Press any key to continue . . . 
```

所需的输出应该是这样的......

```
tid = 0, var[tid] = 0
tid = 1, var[tid] = 0
tid = 0, var[tid] = 1
tid = 1, var[tid] = 1
tid = 0, var[tid] = 2
tid = 1, var[tid] = 2
tid = 0, var[tid] = 3
tid = 1, var[tid] = 3 etc. 
```

此处的任何指导将不胜感激。

编辑：我已经使用按预期工作的代码更新了答案。

【注意这里效率很重要，我想尽快完成流程】

```
#include <iostream>  
#include <boost/thread.hpp>

int var[2];
int mT;
int mTotalSamples;
boost::mutex mCountMutex;
boost::thread *threadMap[2];

using namespace std;

void process()
{
    int tid = 1;

    // sleep for 1 seconds - just to make sure threadMap 
    // has been assigned (only ncessary for this demo).
    boost::this_thread::sleep(boost::posix_time::seconds(1));

    if (threadMap[0]->get_id() == boost::this_thread::get_id()){ tid = 0;}

    while ( mT < mTotalSamples ) 
    {
        // perform processing
        var[tid] = mT; 
        // processing complete

        mCountMutex.lock(); // (a thread waits to aquire mutex)
        cout << "tid = " << tid << ", var[tid] = " << var[tid] << endl;
        mT++;           // How to stop both threads incrementing this?      
        mCountMutex.unlock();       
    }   
}

int main()
{
    boost::thread_group threads;

    mT = 0;
    mTotalSamples = 10;

    threadMap[0] = threads.create_thread( boost::bind(&process) );
    threadMap[1] = threads.create_thread( boost::bind(&process) );

    threads.join_all();

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T21:21:52.243

从您的预期输出来看，您希望线程在每次更新后同步。该`boost`库提供了[boost::barrier](http://www.boost.org/doc/libs/1_33_1/doc/html/barrier.html)，如果你`wait`在 while 循环的开头或结尾放置一个 for 它`process`，应该可以解决问题。

```
#include <iostream>  
#include <boost/thread.hpp>

int var[2];
int mT;
int mTotalSamples;
boost::mutex mCountMutex;
boost::thread *threadMap[2];
boost::barrier bar(2);

using namespace std;

void process()
{
    int tid = 1;        

    // sleep for 2 seconds - just to make sure threadMap 
    // has been assigned (only ncessary for this demo).
    boost::this_thread::sleep(boost::posix_time::seconds(2));

    if (threadMap[0]->get_id() == boost::this_thread::get_id()){ tid = 0;}

    while ( mT < mTotalSamples ) 
    {
        // perform processing
        var[tid] = mT; 
        // processing complete

        bar.wait();
        if (threadMap[0]->get_id() == boost::this_thread::get_id())
        {
            mT++;               
            cout << "var[0] = " << var[0] << endl;
            cout << "var[1] = " << var[1] << endl;                      
        }           
        bar.wait();
    }   
}

int main()
{
    boost::thread_group threads;

    mT = 0;
    mTotalSamples = 10;

    threadMap[0] = threads.create_thread( boost::bind(&process) );
    threadMap[1] = threads.create_thread( boost::bind(&process) );

    threads.join_all();

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T21:24:48.453

`int mT;`在 process() 中将此本地化 - 不是全局的。或者你需要一个`int mT[2];` 然后你不需要互斥锁。

# jquery - JQuery 使用 .on() 而不是选择器

> ID：11335514
> 
> 赞同：22
> 
> 时间：2012-07-04T21:14:19.813
> 
> 标签：jquery, jquery-selectors

我正在使用具有以下语法的 .on() 函数：

```
$(".schemaTab").on("click", ".schema", function () {}) 
```

而不是`.live()`因为我正在`.schema`动态添加 div。那些 div 有这个代码：

```
<div class="schema" id="SCH_16">
   <img src="Img/btnRemove.png" class="ikona SCH_Remove" alt="Smazat" title="Smazat">
</div> 
```

但是我需要从其父 div 的点击事件中排除 img，所以知道该怎么做吗？

我试过了：

```
$(".schemaTab").not(".SCH_Remove").on("click", ".schema", function () {}) 
```

...但它没有用，我不知道如何在代码`.not()`内部添加`.on()`

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-07-04T21:23:14.510

.not() 不起作用，因为`on`方法将事件处理程序附加到 jQuery 对象中当前选定的元素集，并使用原始选择器来测试是否应该应用事件。

所以我认为在你的情况下选择然后过滤就可以了。

接口：[http ://api.jquery.com/on/](http://api.jquery.com/on/)

你可以试试这个：

```
$(".schemaTab").on("click", ".schema", function (e) {

    if (!$(e.target).is(".schemaTab")) {
         // not stuff in here
    }

}); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-04-24T11:03:19.980

您实际上可以将`:not`选择器与`.on`方法一起使用，就像这样。

这是比根据 Tats_innit 的回答过滤结果更清洁的解决方案。

```
$('.schemaTab').on('click', '.schema:not(.booga)', function(event) {
  // Fun happens here
}); 
```

我正在使用 jQuery 1.11.0。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-04T21:22:45.147

只要确保目标匹配：

```
$('.schemaTab').on('click', '.schema', function(e) {
    if(!$(e.target).is('.schema')) {
        return;
    }

    // Do stuff
}); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-04T21:18:50.100

这样做的全部意义在于处理尚未在 DOM 中的元素上的事件，其中包括您的 .sch_Remove。

```
$(".schemaTab").on("click", ".schema", function () {}) 
```

为了防止在单击该 img 时触发父单击操作，请添加以下内容（除了上面的函数）。

```
$(".schemaTab").on("click", ".SCH_Remove", function () { return false; }) 
```

这将阻止“点击”事件传播到父级并触发其 onclick 方法并阻止默认点击行为。

# css - CSS 特定类的第一个孩子

> ID：11335516
> 
> 赞同：7
> 
> 时间：2012-07-04T21:14:27.437
> 
> 标签：css

我有以下一段 HTML 代码：

```
<span class="ui-icon ui-icon-triangle-1-s"></span>
<span class="route-line">4</span>
<span class="route-line">33</span> 
```

我想在第一个上添加**一些** `span`样式`class="route-line"`。CSS可以吗？有点像`nth-of-type`；如果它存在，它就会被调用`nth-of-type-with-class`。

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-04T21:28:59.720

在这种情况下，您可以使用兄弟选择器。像这样：

```
.ui-icon + .route-line{
    color: red;
} 
```

它将仅对`span`带有 class 的元素设置样式`ui-icon`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-04T21:36:11.303

第一个带有类**.route-line**的跨度，然后是没有类 .route-line 的任何其他**元素**

```
*:not(.route-line) + span.route-line
{
    background-color:yellow;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-04T21:27:16.040

为什么不对要设置样式的元素应用另一个类。

```
<span class="ui-icon ui-icon-triangle-1-s"></span>
<span class="route-line custom-route-line">4</span>
<span class="route-line">33</span> 
```

CSS看起来像这样

```
.custom-route-line{/*your styling goes here*/} 
```

请注意，两种样式的类（路由线和自定义路由线）都将应用于该元素。 [看看这里](http://jsfiddle.net/QZ5jE/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-04T21:51:46.583

您正在寻找的是`span.route-line:first-of-type`，但它的支持很差。

# ruby-on-rails - 具有匹配产品的动态类别标准 rails 3

> ID：11335521
> 
> 赞同：0
> 
> 时间：2012-07-04T21:15:15.353
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, model-view-controller

我正在开发一个新的 Rails 项目，在这个项目中我有产品和产品类别。

因此，这些类别彼此非常不同，例如，船、房屋、汽车。

汽车类别可能具有“Mph”、“型号”、“品牌”、“年份”等标准。房屋类别将包含“房间”、“年份”、“城市”、“邮政编码”等内容。

我希望这是非常动态的，以便我能够从后端面板添加/删除标准和添加/删除类别。

现在我的问题是，我一直在玩这个，我无法真正弄清楚这个概念的逻辑，我尝试了一些解决方案，但是它们非常奇怪而且效率很低。也许一些铁杆 Rails 编码器可以给我一个提示，如何解决这个难题？

所以我能想出的最好的解决方案是：

四种型号：

```
 _______________________
| Product.rb            |
 -----------------------
| id          | integer |
 -----------------------
| category_id | integer |
 -----------------------
| Title       | string  |
 -----------------------
| Description | text    |
 ----------------------- 
```

* * *

```
 _______________________
| Category.rb           |
 -----------------------
| id          | integer |
 -----------------------
| Title       | string  |
 -----------------------
| Description | text    |
 ----------------------- 
```

* * *

```
 _______________________
| Criteria.rb           |
 -----------------------
| id          | integer |
 -----------------------
| category_id | integer |
 -----------------------
| Name        | string  |
 -----------------------
| Default     | string  |
 -----------------------
| Description | text    |
 ----------------------- 
```

* * *

```
 _______________________
| ProductInfo.rb        |
 -----------------------
| id          | integer |
 -----------------------
| product_id  | integer |
 -----------------------
| Name        | string  |
 -----------------------
| Value       | text    |
 ----------------------- 
```

它是如何连接的：

```
Criteria.rb is connected to Category.rb with a category_id and has_many/belongs_to relation
Product.rb is connected to Category.rb with a category_id and has_many/belongs_to relation
ProductInfo.rb is connected to Product.rb with a product_id and has_many/belongs_to relation.
Category.rb is the heart og this solution. The category model, both have many products and criterias. 
```

实际上它应该如何工作：

```
In the show category page, i would first print out all the criterias for the given category.
Afterwards i would make a @products.each do |product|.
In the @products.each block, i would make a @category.criterias.each do |criteria|.
In the @category.criterias.each block, i would then run something like product.productinfos.where(:name => criteria.name). 
And then run it one by one. 
```

结论，这个解决方案确实有效，但我怀疑它是最好的解决方案。它将产生非常大的加载时间，高流量和大量数据。而且我需要编写非常奇怪和不可读的代码。

这是一个相当长的问题，并且可能非常令人困惑，所以如果有什么请直接说。另外，我在 Stackoverflow 和谷歌上都搜索了很多这样的问题，但我找不到这样的问题。

奥鲁夫尼尔森。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T01:02:56.513

在我看来，由于很多性能问题，最好不要定义额外的表来处理这个问题。我处理此类事情的偏好是在产品表中使用序列化列。这种方法降低了直接在数据库中搜索的能力，但无论如何您都不想这样做。要处理搜索，您必须添加某种索引搜索机制。像acts_as_ferret 甚至Solr 或ElasticSearch。

如果您使用的是 postgres，请查看[https://github.com/softa/activerecord-postgres-hstore](https://github.com/softa/activerecord-postgres-hstore)

对于 Mysql，使用 Rails 内置的“存储” [http://api.rubyonrails.org/classes/ActiveRecord/Store.html](http://api.rubyonrails.org/classes/ActiveRecord/Store.html)

```
class Product < ActiveRecord::Base
  has_and_belongs_to_many :categories
  store :settings
end 
```

要为每个类别设置标准，请执行以下类似操作：

```
class Category < ActiveRecord::Base
  has_and_belongs_to_many :products

  def criteria
     @criteria_list ||= self[:criteria].split('|')
     @criteria_list
  end

  def criteria=(names)
    self[:criteria] = names.join('|')
  end

end 
```

每次将产品添加到类别时，请检查该类别中的所有条件是否在产品的属性哈希键中可用。如果没有，请根据需要添加默认值。

您还可以使用从产品类别的所有标准字段动态获取访问器名称的过程为属性哈希存储设置访问器？（不确定这个，因为我以前没有这样做过）

您还可以使用 products 表中的类型字段来研究使用 STI（单表继承）。（有据可查）这种方法稍微好一点，因为当产品从一个类别转移到另一个类别时，属性不会改变。

```
class Gadget < Product
   store_accessor :manufacturer, :model
end

class Phone < Gadget
   store_accessor :os, :touch_screen, :is_smart
end 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T14:02:46.597

否则，第二种方法是使用 nosql 数据库。用 mongoid 试试 mogodb，相当稳定。这将非常适合您对变量属性的要求。您也可以稍后轻松添加任何其他类别。

据我所知，使用 mysql，您最终将创建多个数据库来存储这些动态数据，这势必会影响性能。

更新 -

除了使用 nosql 可以使您的数据变得灵活之外，在转移到那里之前您还需要考虑许多事情。我只是根据您需要灵活的数据库结构的事实提出建议。从 mogodb 文档开始，它们是很好的起点。

# ms-access - MS Access：自定义纸张尺寸

> ID：11335523
> 
> 赞同：7
> 
> 时间：2012-07-04T21:15:26.937
> 
> 标签：ms-access, vba, printing, page-size

我正在构建一个 MS Access (2010) 应用程序，我将从该应用程序打印条形码标签。使用标准打印机设置，也可以打印各种其他报告和表格，但是我需要将条形码打印到特定的打印机，并且必须将其设置为使用特殊的页面大小。

在我的搜索中，我[发现了打印机对象的属性](http://msdn.microsoft.com/en-us/library/ff845524)“Papersize”，它本身有很多“标准”默认选项，包括 acPRPSLetter 用于 8.5" x 11" 的标准 US Letter 和用于 A4 纸张尺寸的 acPRPSA4。没有任何预设尺寸适合我使用。有一个预设代表用户自定义大小，acPRPSUser，但我还没有找到任何以编程方式*设置*自定义大小的方法。

我确实阅读了有关打印机的“.height”和“.width”属性的信息，但它们似乎不存在于用于 Access 2010 的 VB 中（我相信它基于 VB6）。

谁能帮我在 Access 2010 中使用 VB 代码设置自定义纸张尺寸？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T21:54:22.770

不需要VBA。您可以使用菜单中的页面设置命令设置页边距、方向、纸张、打印机和列的所有页面设置：*报表设计工具 > 页面设置 > 页面设置 > 页面 > 纸张 > 大小*，或*> 页面 > 打印机为 ReportName > 使用特定打印机 > 打印机 > 属性*。这些设置为每个单独的报告保存。

[![截屏](../Images/881cf6dde1de5c3da71dcbc26a983f94.png "点击显示原始尺寸")](https://i.stack.imgur.com/jlt0F.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-30T22:13:29.590

我有同样的问题。我通过使用[How to: Programmatically Retrieve Printer Capabilities解决了这个问题](http://msdn.microsoft.com/EN-US/library/office/ff197339%28v=office.15%29.aspx)

我制作了一个带有程序打印输出的模块。使用 Function Printerselection，我可以使用打印机名称的特定部分来调用打印机。函数 PaperSelection 用于使用纸张名称的特定部分指定纸张。

首先，我必须使用 DeviceCapabilities 函数 API 调用的声明

```
 ' Declaration for the DeviceCapabilities function API call.
Private Declare Function DeviceCapabilities Lib "winspool.drv" _
    Alias "DeviceCapabilitiesA" (ByVal lpsDeviceName As String, _
    ByVal lpPort As String, ByVal iIndex As Long, lpOutput As Any, _
    ByVal lpDevMode As Long) As Long

' DeviceCapabilities function constants.
Private Const DC_PAPERNAMES = 16
Private Const DC_PAPERS = 2
Private Const DC_BINNAMES = 12
Private Const DC_BINS = 6
Private Const DEFAULT_VALUES = 0

Private Type str_DEVMODE
    RGB As String * 94
End Type

Private Type type_DEVMODE
    strDeviceName As String * 32
    intSpecVersion As Integer
    intDriverVersion As Integer
    intSize As Integer
    intDriverExtra As Integer
    lngFields As Long
    intOrientation As Integer
    intPaperSize As Integer
    intPaperLength As Integer
    intPaperWidth As Integer
    intScale As Integer
    intCopies As Integer
    intDefaultSource As Integer
    intPrintQuality As Integer
    intColor As Integer
    intDuplex As Integer
    intResolution As Integer
    intTTOption As Integer
    intCollate As Integer
    strFormName As String * 32
    lngPad As Long
    lngBits As Long
    lngPW As Long
    lngPH As Long
    lngDFI As Long
    lngDFr As Long
End Type

Private Cnt As Integer, PrinterSelect As Integer

Public Sub PrintOut(ByVal rptName As String, Printer As String, Paper As String, BinName As String, Optional Landscape As Boolean, Optional WhereCond)
Dim rpt As Report
DoCmd.OpenReport rptName, acViewPreview, , WhereCond
Set rpt = Reports(rptName)
PrinterSelect = PrinterSelection(Printer)
rpt.Printer = Application.Printers(PrinterSelect)
rpt.Printer.PaperSize = PaperSelection(Paper, PrinterSelect)
If Landscape Then
    rpt.Printer.Orientation = acPRORLandscape
Else
    rpt.Printer.Orientation = acPRORPortrait
End If
rpt.Printer.PaperBin = BinSelection(BinName, PrinterSelect)
End Sub

Public Function PrinterSelection(Printer As String) As Integer
For Cnt = 0 To Application.Printers.Count - 1
    If InStr(1, Application.Printers(Cnt).DeviceName, Printer) > 0 Then
        PrinterSelection = Cnt
    End If
Next Cnt
End Function

Public Function PaperSelection(Paper As String, Printer As Integer) As Integer

    Dim lngPaperCount As Long
    Dim lngCounter As Long
    Dim hPrinter As Long
    Dim strDeviceName As String
    Dim strDevicePort As String
    Dim strPaperNamesList As String
    Dim strPaperName As String
    Dim intLength As Integer
    Dim strMsg As String
    Dim aintNumPaper() As Integer

    On Error GoTo GetPaperList_Err

    ' Get the name and port of the selected printer.
    strDeviceName = Application.Printers(Printer).DeviceName
    strDevicePort = Application.Printers(Printer).Port

    ' Get the count of paper names supported by the printer.
    lngPaperCount = DeviceCapabilities(lpsDeviceName:=strDeviceName, _
        lpPort:=strDevicePort, _
        iIndex:=DC_PAPERNAMES, _
        lpOutput:=ByVal vbNullString, _
        lpDevMode:=DEFAULT_VALUES)

    ' Re-dimension the array to the count of paper names.
    ReDim aintNumPaper(1 To lngPaperCount)

    ' Pad the variable to accept 64 bytes for each paper name.
    strPaperNamesList = String(64 * lngPaperCount, 0)

    ' Get the string buffer of all paper names supported by the printer.
    lngPaperCount = DeviceCapabilities(lpsDeviceName:=strDeviceName, _
        lpPort:=strDevicePort, _
        iIndex:=DC_PAPERNAMES, _
        lpOutput:=ByVal strPaperNamesList, _
        lpDevMode:=DEFAULT_VALUES)

    ' Get the array of all paper numbers supported by the printer.
    lngPaperCount = DeviceCapabilities(lpsDeviceName:=strDeviceName, _
        lpPort:=strDevicePort, _
        iIndex:=DC_PAPERS, _
        lpOutput:=aintNumPaper(1), _
        lpDevMode:=DEFAULT_VALUES)

    ' List the available paper names.
    For lngCounter = 1 To lngPaperCount

        ' Parse a paper name from the string buffer.
        strPaperName = Mid(String:=strPaperNamesList, Start:=64 * (lngCounter - 1) + 1, Length:=64)
        intLength = VBA.InStr(Start:=1, String1:=strPaperName, String2:=Chr(0)) - 1
        strPaperName = Left(String:=strPaperName, Length:=intLength)
        If InStr(1, strPaperName, Paper) > 0 Then
        ' Select the a paper number corresponding to the paper name.
            PaperSelection = aintNumPaper(lngCounter)
        End If
    Next lngCounter

GetPaperList_End:
    Exit Function

GetPaperList_Err:
    MsgBox Prompt:=err.Description, Buttons:=vbCritical & vbOKOnly, _
        Title:="Error Number " & err.Number & " Occurred"
    Resume GetPaperList_End

End Function

Public Function BinSelection(BIN As String, Printer As Integer) As Integer
' Uses the DeviceCapabilities API function to choose the desired paper bin supported by the    chosen printer

    Dim lngBinCount As Long
    Dim lngCounter As Long
    Dim hPrinter As Long
    Dim strDeviceName As String
    Dim strDevicePort As String
    Dim strBinNamesList As String
    Dim strBinName As String
    Dim intLength As Integer
    Dim strMsg As String
    Dim aintNumBin() As Integer

    On Error GoTo GetBinList_Err

    ' Get name and port of the default printer.
    strDeviceName = Application.Printers(Printer).DeviceName
    strDevicePort = Application.Printers(Printer).Port

    ' Get count of paper bin names supported by the printer.
    lngBinCount = DeviceCapabilities(lpsDeviceName:=strDeviceName, _
        lpPort:=strDevicePort, _
        iIndex:=DC_BINNAMES, _
        lpOutput:=ByVal vbNullString, _
        lpDevMode:=DEFAULT_VALUES)

    ' Re-dimension the array to count of paper bins.
    ReDim aintNumBin(1 To lngBinCount)

    ' Pad variable to accept 24 bytes for each bin name.
    strBinNamesList = String(Number:=24 * lngBinCount, Character:=0)

    ' Get string buffer of paper bin names supported by the printer.
    lngBinCount = DeviceCapabilities(lpsDeviceName:=strDeviceName, _
        lpPort:=strDevicePort, _
        iIndex:=DC_BINNAMES, _
        lpOutput:=ByVal strBinNamesList, _
        lpDevMode:=DEFAULT_VALUES)

    ' Get array of paper bin numbers supported by the printer.
    lngBinCount = DeviceCapabilities(lpsDeviceName:=strDeviceName, _
        lpPort:=strDevicePort, _
        iIndex:=DC_BINS, _
        lpOutput:=aintNumBin(1), _
        lpDevMode:=0)

    ' List available paper bin names.
    strMsg = "Paper bins available for " & strDeviceName & vbCrLf
    For lngCounter = 1 To lngBinCount

        ' Parse a paper bin name from string buffer.
        strBinName = Mid(String:=strBinNamesList, _
            Start:=24 * (lngCounter - 1) + 1, _
            Length:=24)
        intLength = VBA.InStr(Start:=1, _
            String1:=strBinName, String2:=Chr(0)) - 1
        strBinName = Left(String:=strBinName, _
                Length:=intLength)

        If InStr(1, strBinName, BIN) > 0 Then
        ' Select the bin number corresponding to the bin name.
            BinSelection = aintNumBin(lngCounter)
        End If
     Next lngCounter

GetBinList_End:
    Exit Function
GetBinList_Err:
    MsgBox Prompt:=err.Description, Buttons:=vbCritical & vbOKOnly, _
        Title:="Error Number " & err.Number & " Occurred"
    Resume GetBinList_End
End Function 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T17:24:25.127

看起来你需要注意`.DefaultSize`- 如果它是真的，那么你的`ItemSizeHeight`&`ItemSizeWidth`设置将被忽略

[MSDN](http://msdn.microsoft.com/en-us/library/aa139946)上有更多信息和一些示例

# javascript - Excel 像 RoR 中的 javascript 编辑

> ID：11335524
> 
> 赞同：0
> 
> 时间：2012-07-04T21:15:59.343
> 
> 标签：javascript, ruby-on-rails, ruby, ruby-on-rails-3

**我所拥有的：**由单个单元格生成的表格，例如：

```
<tr>
  <%= render :partial => 'partials/fieldtypes/show_in_table', :locals => {:fieldtype => 'textline', :data => {'object' => object, 'value' => 'name'}, :vars => {'textline' => object.name}} %>
  <%= render :partial...
</tr> 
```

部分看起来像这样：

```
<td class='tablecell' <% data.each do |dat| %>data-<%= raw(dat[0]) %>='<%= raw(dat[1]) %>' <% end %> >
  <%= render :partial => 'partials/fieldtypes/show/'+fieldtype, :locals => {:vars => vars} %>
</td> 
```

现在我想通过双击它们来编辑该表的单个条目/单元格，就像在 MS Excel 中一样。该站点在完整的 javascript 上运行，因此没有链接页面。

**所以我想要的是：**每次用户想要编辑字段（通过双击）时生成（**不是预渲染和切换可见性！ ）表单。**

**到目前为止我的想法：**如您所见，我试图将所有必要的数据存储在 html5 数据标签中以生成表单。计划是每次双击一个单元格时调用一个控制器操作，并生成带有 Rails 数据库连接的表单。

**问题/问题：**这样可以吗？因为标签中的数据看起来已转换并且对于进一步的交互无用。如果它有效：我如何使用正确的路线为此创建控制器操作？

或者有没有更简单的解决方案？如前所述，我不想直接隐藏表单！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T10:46:14.027

检查这个宝石，这正是你想要做的 [https://github.com/bernat/best_in_place](https://github.com/bernat/best_in_place)

# c++ - 这是正确的：在构造 Base 对象之前调用 Derived 的虚拟方法吗？

> ID：11335525
> 
> 赞同：4
> 
> 时间：2012-07-04T21:16:06.803
> 
> 标签：c++, constructor, g++, standards, virtual-functions

我知道在 Base 类的构造函数中 - 调用虚拟方法时 - Base 方法被调用，而不是派生 - 请参阅[Calling virtual functions inside constructors](https://stackoverflow.com/questions/962132/calling-virtual-functions-inside-constructors)。

我的问题与这个主题有关。我只是想知道如果我在 Derived 类构造函数中调用虚方法会发生什么 - 但在构造 Base 部分之前。我的意思是调用虚方法来评估基类构造函数参数，请参见代码：

```
class Base {
public:
  Base(const char* name) : name(name) {
    cout << "Base():" << name << endl;
  }
  virtual const char* getName() { 
    cout << "Base::getName()" << endl;
    return "Base";
  }
protected:
  const char* name;
};

class Derived : public Base {
public:
  Derived() : Base(getName()) {
    cout << "Derived():" << name << endl;
  }
  virtual const char* getName() { 
    cout << "Derived::getName()" << endl;
    return "Derived";
  }
};

int main() {
  Derived d;
} 
```

编译器 g++（4.3.x-4.5x 版本）输出为：

```
Derived::getName()
Base():Derived
Derived():Derived 
```

但是我希望：

```
Base::getName()
Base():Base
Derived():Base 
```

这看起来没有错 - 但考虑这个例子，它产生`segmentation fault`：

```
class Derived : public Base {
public:
  Derived() : Base(getName()), name(new string("Derived")) {
    cout << "Derived():" << Base::name << endl;
  }
  virtual const char* getName() { 
    cout << "Derived::getName()" << endl;
    return name->c_str();
  }
private:
  string* name;
}; 
```

请回答：这是正确的 g++ 行为吗？C++ 标准对此有何规定？也许这是未定义的行为？

[更新1] 我考虑了罗伯特和奥利的答案——我改变了我的第一个例子。然后它 getName() 被称为“虚拟” - 它产生分段错误。请也回答我对这部分的问题。

```
const char* virtualGetName(Base* basePtr)
{
  return basePtr->getName();
}

class Derived : public Base {
public:
  Derived() : Base(virtualGetName(this)) {
    cout << "Derived():" << Base::name << endl;
  }
  virtual const char* getName() { 
    cout << "Derived::getName()" << endl;
    return "Derived";
  }
}; 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-04T21:38:24.170

您的所有示例都表现出未定义的行为。C++ 语言标准规定（C++11 §12.6.2/13）：

> 可以为正在构建的对象调用成员函数（包括虚成员函数）。类似地，正在构建的对象可以是运算`typeid`符或 a的操作数`dynamic_cast`。
> 
> 但是，如果这些操作在基类的所有*mem-initializer完成之前在**ctor-initializer*（或直接或间接从*ctor-initializer*调用的函数中）执行，则操作的结果是未定义的。

 *您正在从类构造函数`getName()`的初始化列表（*ctor-initializer*）中调用成员函数。`Derived`这个成员函数调用必须在初始化器`Base`完成（*mem-initializer* for `Base`）之前发生，因为它是初始化器本身的参数。

因此，行为是未定义的。

作为一项规则，[永远不要在构造或破坏期间调用虚函数](http://www.artima.com/cppsource/nevercall.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T21:26:29.610

> 我只是想知道如果我在 Derived 类构造函数中调用虚方法会发生什么 - 但在构造 Base 部分之前。

看起来你正在这样做，但事实并非如此。

在您的第一个示例中，`Derived::getName()`不依赖于`this`，因此方法调用有效。在您的第二个示例中，`Derived::getName()`确实取决于`this`. 由于`this->name`尚未设置，它指向一个未定义的位置并给你一个段错误。

`this->name`尚未设置，因为构造函数所做的第一件事`Derived`就是调用`Base`构造函数。如果您指定要传递给`Base`构造函数的参数，它会首先处理它们。然后它通过调用它们的构造函数来实例化类的成员变量。初始化列表可用于将参数传递给这些构造函数，但它不能更改调用它们的顺序。这一步是`name`初始化的地方。最后，`Derived`执行构造函数的主体。*

# unit-testing - 进行需要输入文件的 distcheck 和测试

> ID：11335528
> 
> 赞同：7
> 
> 时间：2012-07-04T21:16:17.437
> 
> 标签：unit-testing, automake

我最近将我的构建系统转换为 automake/autoconf。在我的项目中，我有一些单元测试需要运行它们的目录中的一些输入数据文件。当我运行 make distcheck 并尝试构建 VPATH 时，这些测试失败，因为它们显然不是从输入文件所在的目录运行的。我想知道是否有一些快速解决方法。例如，我能否以某种方式告诉系统不要在 make distcheck 上运行这些测试（但仍然在 make check 上运行它们）？或者在运行测试之前 cd 到文件所在的目录？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-15T08:23:52.800

我遇到了同样的问题并使用了类似于威廉的解决方案。我的 Makefile.am 看起来像这样：

```
EXTRA_DIST = testdata/test1.dat

AM_CPPFLAGS = -DDATADIR=\"$(srcdir)/\" 
```

然后，在我的单元测试中，我使用 DATADIR 定义：

```
string path = DATADIR "/testdata/test1.dat" 
```

这适用于`make check`和`make distcheck`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-06T14:31:58.523

典型的解决方案是编写测试，以便它们在源目录中查找数据文件。例如，您可以`$srcdir`在测试中引用，或转换`test`为`test.in`并引用`@srcdir@`.

如果您的测试都在源目录中，您可以通过在 Makefile.am 中设置 TESTS_ENVIRONMENT 来运行该目录中的所有测试：

```
TESTS_ENVIRONMENT = cd $(srcdir) && 
```

如果您的某些测试是由 configure 创建的，因此这将失败，因此仅存在于 build 目录中，在这种情况下，您可以选择性地 cd 使用以下内容：

```
 TESTS_ENVIRONMENT = { test $${tst} = mytest && cd $(srcdir); true; } && 
```

尝试像这样使用 TESTS_ENVIRONMENT 充其量是脆弱的，最好编写测试，以便它们在源目录中查找数据文件。

# vb.net - 按顺序浏览控件

> ID：11335529
> 
> 赞同：2
> 
> 时间：2012-07-04T21:16:19.080
> 
> 标签：vb.net

我正在使用表单的文本字段创建一个 XML 文件。当我使用`For Each`循环遍历它们时：

```
For each Ctrl in Me.Controls 
    'dosomething
Next 
```

它没有按顺序排列它们；也就是说，它首先`TextBox`在中间，然后是第一个，然后是另一个，然后一直这样。

有没有办法让我按顺序取值？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-04T21:19:34.917

`Me.Controls`包含按创建顺序排列的控件。

要更改它，请选择第一个控件（在设计器中），单击 Send to Back，然后重复。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-04T21:27:59.190

您可以通过以下方式订购`TabIndex`：

```
Dim allTextBoxes = From txt In Me.Controls.OfType(Of TextBox)()
                   Order By txt.TabIndex 
```

另一种方法是按位置订购：

```
allTextBoxes = From txt In Me.Controls.OfType(Of TextBox)()
               Order By txt.Location.Y, txt.Location.X

For Each txt In allTextBoxes
    '  ...
Next 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T21:24:09.783

这可能对你有用。不是 VB 人，但这是我尝试按位置从上到下对控件进行排序。

```
... Me.Controls.OrderBy(Function(c) c.Location.Y) 
```

# cryptography - 可以为 bcrypt 随机生成盐吗？

> ID：11335533
> 
> 赞同：1
> 
> 时间：2012-07-04T21:16:59.103
> 
> 标签：cryptography, hash, bcrypt

我正在处理我的站点身份验证，并且正在考虑使用 bcrypt 并随机创建一个存储在数据库上我的用户登录行中的盐。我希望我的网站速度很快，但是使用 15 生成（大约需要 1 秒）的任何​​东西都太慢了，所以我想在 5-14 之间随机生成盐，但这是安全的还是有更好的方法？

如果有帮助，我正在使用[py-bcrypt](http://code.google.com/p/py-bcrypt/)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T21:20:54.710

使用 bcrypt 的一个主要原因是通过需要大量 CPU 时间来计算哈希来防止暴力攻击。对于您的问题，我将使用恒定长度的盐，但使用随机值，这样每个密码都需要相同的时间来计算。

从这里你可以满足你的盐的长度和拉伸迭代的数量，只要你觉得足够安全，尽管我个人喜欢确保哈希值至少需要 1/2 秒才能在一个非常强大的服务器上生成。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-04T23:24:41.387

好的，所以看起来盐的长度和工作因子是相关的。bcrypt 已经相当安全了，但问题是无论您使用哪种散列，密码强度本身至少同样重要。所以你应该尽量在你的服务器上处理最好的，最低成本（强度）为 12。

请注意，需要加密安全但快速且经常重新播种的 RNG，否则您可能会用完随机数。

更重要的是：确保密码有足够的强度。即使使用 bcrypt，查找密码“password”也不需要任何时间。

不，没有更好的方法，除了为密码散列找到更快的实现。攻击者当然会使用最快的实现。

# ruby-on-rails - 提交表单时，ruby on rails 保留 url

> ID：11335537
> 
> 赞同：1
> 
> 时间：2012-07-04T21:17:41.967
> 
> 标签：ruby-on-rails, forms, url, submit

我正在使用设计进行用户注册，但我面临一个问题，当我提交注册表单时，我被重定向到`/users`但我想留在`/signup`注册表单的位置......

我做到了，但现在我看不到任何错误消息

我的起始表格打开代码

`<%= form_for(resource, :as => resource_name, :url => signup_path) do |f| %>`

路线

```
 devise_scope :user do
    get "signup", :to => "devise/registrations#new"
    post "signup", :to => "devise/registrations#new"
  end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T21:49:47.160

您的发布路线应指向“设计/注册#创建”

# php - 分类和构建数据库

> ID：11335539
> 
> 赞同：2
> 
> 时间：2012-07-04T21:17:53.703
> 
> 标签：php, mysql, structure, categories

我一直在思考处理这个数据库结构的最佳方法。到目前为止，我所拥有的是：

表**类别**

*   cat_id (PK)
*   标题

表**子猫**

*   sc_id (PK)
*   cat_id (FK)
*   标题

这一切都很好，因为我可以按如下方式使用它：

*   汽车 -> 马自达
*   计算机硬件-> CPU
*   服装 -> 男 :: 裤子
*   汽车零件 -> 马自达 :: 扰流板
*   ...

问题是我如何才能最好地构建数据库以进一步利用每个类别中的精华。汽车数据将需要很多仅适用于汽车的字段，而另一个类别可能需要完全不同的东西。

应该说会有很多类别。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T21:28:10.213

可能是创建一个表“详细信息”，建立这样的东西

```
= ItemId === DetailId === DetailValue =
| Somecar1 | 1         |  Blue        |
| Somecar2 | 2         |  Four        |
| Somecar2 | 1         |  Pink        |
| Somecar2 | 2         |  Two         |
======================================= 
```

其中 DetailId 指的是这样的东西，detailreference；

```
= CategoryId === DetailId === DetailString =
| 1           |  1         | Color         |
| 1           |  2         | Doors         |
============================================ 
```

如果要获取 Somecar1 的信息，则应查询 Details 表中的数据，然后查询 detailreference 以获取存储在特定数字内的特定类别的详细信息类型。

# google-chrome - chrome 扩展自动更新事件

> ID：11335541
> 
> 赞同：1
> 
> 时间：2012-07-04T21:18:11.927
> 
> 标签：google-chrome, google-chrome-extension

当我的扩展程序自动更新时，我想显示发行说明（使用我的网站或 webkit 通知打开新选项卡）。我怎么能做到这一点？请帮我。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-04T21:30:04.943

您可以将扩展版本号保存在 localStorage 中，并检查扩展启动是否当前扩展版本与 localStorage 中写入的版本匹配，如果不匹配，则它已更新，您可以打开新选项卡。

背景页面：

```
window.addEventListener("load", function()
{
    var ver = "1.0.0";
    if (localStorage.ver !== ver)
    {
        if (localStorage.ver)
        {
            // it was updated
            chrome.tabs.create({url:"YOUR_URL"});
        }
        localStorage.ver = ver;
    }
}, false); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-05-03T09:59:18.937

虽然这个问题已经有将近 1 年的历史了，但未来的读者可能会对更好的方法感兴趣。

[`chrome.runtime.onInstalled`](http://developer.chrome.com/extensions/runtime.html#event-onInstalled)为您处理版本检查，从而让您只关注应该发生的操作。您可以显示带有 onclick 事件的通知，而不是总是打开一个新选项卡。

[`onUpdateAvailable`](http://developer.chrome.com/extensions/runtime.html#event-onUpdateAvailable)如果您需要在自动安装新版本之前进行一些处理，还有一个事件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-12-31T17:39:08.000

**更新事件**

```
chrome.runtime.onUpdateAvailable.addListener(function(details) {   

  console.log("updating to version " + details.version);   
  chrome.runtime.reload(); 
}); 
```

**手动检查更新是否可用**

```
chrome.runtime.requestUpdateCheck(function(status) {  
  if (status == "update_available") {
    console.log("update available...");  
  } 
  else if (status == "no_update") {
    console.log("no update found");   
  }   
  else if (status == "throttled") {
    console.log("Oops, wait for some time, you're asking too frequently ");  
  } 
}); 
```

# createprocess - 如何在 Windows 中从另一个 C++ 软件的管理员权限创建一个进程，但不依赖于该软件？

> ID：11335542
> 
> 赞同：0
> 
> 时间：2012-07-04T21:18:31.227
> 
> 标签：createprocess

想象一下，您的 Windows PC 中的某些软件需要在给定的时间内运行，并且假设它的用户会启动它，但他忘记了。并且该软件应该以管理员身份运行（即具有管理员权限）。所以，为了保证给定的软件在那个时候是打开的，你放了一个看门狗，它可以执行用户应该做的事情。

这不完全是我的情况，但这正是我所需要的。它必须在 C++ 中工作，我正在使用 Qt（尽管我认为这不会有太大的不同）。

我在 MSDN 中搜索了几乎所有关于 CreateProcess() 和类似函数的文件，并在网上看到了几十个示例，但直到现在我都无法做我想做的事情（事实上，我什至无法运行软件，更不用说细节了）。

重要的是要注意看门狗应该只是以管理员身份打开软件并立即“忘记它”；它应该没有控制权，并且打开的软件无论如何都不能依赖于看门狗（例如，如果看门狗关闭，则打开的软件继续正常运行）。

如果有人帮忙，我会很高兴。

莫默吉尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T21:24:27.247

通常，如果程序需要管理员权限才能运行，则需要**具有**管理员权限的用户来安装它。

这为程序提供了管理员权限。

**更新：**根据您关于尝试让另一个进程以管理员权限运行另一个应用程序的评论，您应该查看以下代码：

```
using System.Security.Principal;

public static void ProcessStart(string fileName, string arguments) {
  ProcessStartInfo startInfo = new ProcessStartInfo(fileName, arguments);
#if !PocketPC
  try {
    WindowsIdentity id = WindowsIdentity.GetCurrent();
    WindowsPrincipal pal = new WindowsPrincipal(id);
    if (pal.IsInRole(WindowsBuiltInRole.Administrator)) {
      Process.Start(startInfo);
    }
  } catch (Exception e) {
    Console.WriteLine(e.Message);
  }
#else
  Process.Start(startInfo);
#endif
} 
```

此代码不包括[Microsoft PocketPC](http://www.microsoft.com/windowsphone/en-us/default.aspx)设备，并且仅当运行该程序的人在管理员组中时才会执行。

您需要做的是为具有管理员权限的帐户（在您要运行应用程序的 PC 上）启动[WindowsIdentity并](http://msdn.microsoft.com/en-us/library/system.security.principal.windowsidentity.aspx)[模拟](http://msdn.microsoft.com/en-us/library/system.security.principal.windowsidentity.impersonate%28v=vs.71%29.aspx)该帐户以运行您的应用程序。

[在 CodeProject 上有一个名为User Impersonation in .NET](http://www.codeproject.com/Articles/14358/User-Impersonation-in-NET)的工作示例，它可以为您提供更多信息。

# ios - UITextField 成为第一响应者后，UITableView 不会调整大小

> ID：11335547
> 
> 赞同：1
> 
> 时间：2012-07-04T21:19:10.117
> 
> 标签：ios, uitableview, ios5, scroll, uitextfield

我的情节提要中有两个几乎相同的场景。两者都是 UITableViewControllers。两者都有页眉和页脚视图。页眉视图有一个 UISearchBar，页脚视图有一个包含 UITextField 的 UIView。每个只有一个原型单元。一个原型为“基本”单元，另一个原型为“正确细节”单元。

这就是问题所在。当我在第一个场景的页脚视图中单击 UITextField 时，表格会自动调整大小，以便表格底部位于键盘顶部。这允许我向上滚动表格，以便显示页脚视图并且用户能够看到他们正在输入的内容。另一个场景不会自动调整 UITableView 的大小，因此 UITableView 无法将页脚视图滚动到可以看到的位置，并且 UITextField 隐藏在键盘下。我什至无法手动滚动表格足够远，因为页脚始终位于 UITableView 的底部。

一点补充信息。有效的场景有很多行数据，而无效的场景只有几行。我尝试添加一些行，直到表格足以启用滚动并且它不能解决问题。

我已经检查了我能想到的所有内容，但我看不到任何可以让其中一个视图让 UITableView 自动调整大小以使用键盘而另一个不使用的东西。我一定忽略了一些东西，但我似乎找不到它。

任何帮助将不胜感激！

抢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-10T20:49:48.063

我认为这个问题是由从一个视图复制并粘贴到另一个视图引起的，但是一旦我（理论上）修复了它，我就遇到了同样的问题。

对我来说答案很简单：我没有调用`[super viewWillAppear:animated]`我的 UITableViewController 子类的`viewWillAppear:`实现。确保你已经调用了超类的方法，希望问题会消失。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T21:07:44.437

我猜在第二种情况下，tableview 的框架没有被调整为较小的尺寸。

加载后在两种情况下打印出框架和内容大小，这应该可以帮助您查看是否存在问题。

# python - 修改 ZODB 中的数据

> ID：11335554
> 
> 赞同：3
> 
> 时间：2012-07-04T21:20:32.983
> 
> 标签：python, zodb

按照[此处](https://stackoverflow.com/questions/11254384/when-to-commit-data-in-zodb)给出的建议，我使用 ZODB 存储了我的数据，由以下代码创建：

```
# structure of the data [around 3.5 GB on disk]
bTree_container = {key1:[ [2,.44,0], [1,.23,0], [4,.21,0] ...[10,000th element] ], key2:[ [3,.77,0], [1,.22,0], [6,.98,0] ..[10,000th element] ] ..10,000th key:[[5,.66,0], [2,.32,0], [8,.66,0] ..[10,000th element]]}

# Code used to build the above mentioned data set
for Gnodes in G.nodes():      # Gnodes iterates over 10000 values 
Gvalue = someoperation(Gnodes)
    for i,Hnodes in enumerate(H.nodes()):  # Hnodes iterates over 10000 values 
        Hvalue =someoperation(Hnodes)
        score = SomeOperation on (Gvalue,Hvalue)
        btree_container.setdefault(Gnodes, PersistentList()).append([Hnodes, score, 0]) # build a list corresponding to every value of Gnode (key)
        if i%5000 == 0       # save the data temporarily to disk.
           transaction.savepoint(True)
transaction.commit()         # Flush all the data to disk 
```

现在，我想（在一个单独的模块中）（1）修改存储的数据并（2）对其进行排序。以下是我使用的代码：

```
storage = FileStorage('Data.fs')
db = DB(storage)
connection = db.open()
root = connection.root()
sim_sorted = root[0]

# substitute the last element in every list of every key (indicated by 0 above) by 1
# This code exhausts all the memory, never get to the 2nd part i.e. the sorting 
for x in sim_sorted.iterkeys():
    for i,y in enumerate(sim_sorted[x]):
        y[3] = 1
        if i%5000 ==0
            transaction.savepoint()

# Sort all the lists associated with every key in he reverse order using middle element as key   
[sim_sorted[keys].sort(key = lambda x:(-x[1])) for keys in sim_sorted.iterkeys()] 
```

但是，用于编辑值的代码会占用所有内存（永远不会进行排序）。我不确定这是如何工作的，但我感觉我的代码存在严重问题，ZODB 将所有内容都拉入内存，因此出现了问题。什么是实现预期效果的正确方法，即在 ZODB 中存储元素的替换和排序而不会遇到内存问题？代码也很慢，建议加快速度吗？

[注意：我没有必要将这些更改写回数据库]

编辑通过在内部循环之后添加命令似乎对内存使用有所改善`connection.cacheMinimize()`，但是在一段时间后再次消耗了整个 RAM，这让我感到困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T06:48:36.417

你确定不是排序会扼杀你的记忆吗？

请注意，我希望每个 PersistentList 都必须适合内存；它是一个持久记录，因此将在访问时作为一个整体加载。

我会修改您的代码以像这样运行，看看会发生什么：

```
for x in sim_sorted.iterkeys():
    for y in sim_sorted[x]:
        y[3] = 1
    sim_sorted[x].sort(key=lambda y: -y[1])
    transaction.savepoint() 
```

现在您可以一次性处理整个列表并对其进行排序；毕竟，它已经被加载到内存中了。处理后，您告诉 ZODB 您已完成此阶段，整个更改的列表将被刷新到临时存储。只完成了一半就没有必要冲洗它了。

如果这仍然不适合您的内存，您将需要重新考虑您的数据结构并将大列表拆分为较小的持久记录，以便您可以一次处理其中的多个块，而无需将整个内容加载到一个中。

# sql-server - 如何在 xquery 中执行不区分大小写的属性选择器

> ID：11335558
> 
> 赞同：4
> 
> 时间：2012-07-04T21:20:51.793
> 
> 标签：sql-server, xquery

我正在尝试查询 SQL Server 中的 XML 列，并且我想选择属性值与不区分大小写的字符串匹配的记录。

例如，考虑 XML 列的以下值：

```
<items>
  <item k="Description" v="hello" />
</items> 
```

现在，我的选择如下所示：

```
SELECT
MyXmlColumn.value('(/items/item[@k="Description"]/@v)[1]', 'nvarchar(max)') as v
FROM Table 
```

问题是“k”属性的值可能是“Description”、“description”或“DESCRIPTION”。

如何编写 XQuery 以使其执行不区分大小写的匹配？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-04T21:26:32.837

您可以使用[小写函数](http://msdn.microsoft.com/en-us/library/cc645589.aspx) `fn:lower-case`（这将使您正在搜索的属性小写），然后确保在您的查询中使用小写：

```
SELECT 
MyXmlColumn.value('(/items/item[fn:lower-case(@k)="description"]/@v)[1]', 'nvarchar(max)') as v
FROM [Table] 
```

# scala - 特征中的抽象字段（Scala） - 构造顺序

> ID：11335561
> 
> 赞同：2
> 
> 时间：2012-07-04T21:20:59.583
> 
> 标签：scala, inheritance, multiple-inheritance, traits

因此，我正在阅读《[*不耐烦》一书中的 Scala，*](http://horstmann.com/scala/)它使用的示例之一是`Logger`本质上将 a 打印`String`到某个流的特征。在示例中，它具有将消息打印到的特征`ConsoleLogger`（extends ）和（也是extends ）如果长度太长则简单地截断字符串。要更改本书的最大长度，建议使用匿名子类，例如：`Logger``stdout``ShortLogger``Logger``ShortLogger`

```
val acct = new SavingsAccount with ConsoleLogger with ShortLogger {
  val maxLength = 20
} 
```

where`ShortLogger`是具有抽象`maxLength: Int`字段的特征，`SavingsAccount`定义为

```
class SavingsAccount extends Account with Logged { ... } 
```

这对我来说很有意义（有点）。我假设施工顺序是：

1.  `Logger`首先构造（因为它是 的超特征`ConsoleLogger`），
2.  `ConsoleLogger`
3.  `ShortLogger`
4.  `Account`
5.  `SavingsAccount`.
6.  然后我们有匿名子类构造，我们在其中定义了 abstract `maxLength = 20`。

然而，在本书的后面，它给出了一个新的`Logger`子特征：

```
trait FileLogger extends Logger {
  val filename: String
  val out = new PrintStream(filename)
  def log(msg: String) { out.println(msg); out.flush() }
}

val acct = new SavingsAccont with FileLogger {
  val filename = "myapp.log" // Does not work
} 
```

它说由于施工顺序，它不起作用。他们提出修改：

```
val acct = new {
  val filename: "myapp.log"
} with SavingsAccount with FileLogger 
```

但是，这个定义似乎与上面的定义相似`maxLength`，那么在上面的示例和底部示例之间我缺少什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-04T22:46:35.877

你的施工顺序完全错误。:-)

首先要构造的是类，然后从左到右遍历特征。这有点复杂——有处理多次继承的特征的线性化规则，但仅此而已。

所以：

1.  帐户
2.  已记录
3.  储蓄账户
4.  控制台记录器
5.  短记录器
6.  匿名子类

现在，对于你的问题：

```
val acct = new SavingsAccont with FileLogger {
  val filename = "myapp.log" // Does not work
}

val acct = new {
  val filename: "myapp.log"
} with SavingsAccount with FileLogger 
```

Note that the block of code comes first in the second example. That's known as [*early initialization*](https://stackoverflow.com/questions/4712468/in-scala-what-is-an-early-initializer), and what it does is to apply that initialization before anything else.

# android - 无法在 Eclipse 中构建新的 android 项目 - 文件夹是白色的并且没有内容

> ID：11335562
> 
> 赞同：1
> 
> 时间：2012-07-04T21:21:11.340
> 
> 标签：android, eclipse, project, building

当我在“新的 android 项目”窗口中单击完成时，窗口不会自行关闭。我必须手动关闭窗口。当我查看新项目时，文件夹是白色的，并且该`src`文件夹没有我刚刚在“新 android 项目”窗口中创建的 MainActivity。我重新安装了eclipse和sdk的东西，但没有帮助。在项目属性中，我单击“android”，eclipse 说：`The currently displayed page contains invalid values.`我使用 Eclipse Indigo 4.2 和 Android SDK Manager Revision 20。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-08T21:23:56.807

我有同样的问题。
你已经明白了，但我可以确认你是对的。
因此，请确保在向导`create custom launcher icon`中将 设置为**false**。
我正在使用最新的 Eclipse 3.7 和最新的 Android。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T21:51:37.220

有时重新安装 Eclipse 和 Android SDK 无法正常工作。当我开始使用它时，我遇到了同样的问题，并通过删除 Eclipse 的文件夹和我安装它时创建的 Android 文件夹来修复它（默认情况下，Android 的文件夹可以在 C:\ 中找到）

我删除了文件夹“Android”和“.android”，然后我再次下载了 Eclipse 和 Android SDK。尝试这样做并仔细按照说明安装 [ADT 插件](http://developer.android.com/sdk/installing/installing-adt.html)

# c# - 传递依赖导致相同 DLL 的版本冲突

> ID：11335577
> 
> 赞同：10
> 
> 时间：2012-07-04T21:23:30.403
> 
> 标签：c#, .net, dll, dependency-management, transitive-dependency

.NET 世界中管理导致版本冲突的传递依赖项的最佳实践是什么？

详细说明：项目 A 依赖于项目 B，而项目 B 又依赖于库 C

还

项目 A 还依赖于项目 X，项目 X 依赖于库 C 的不同且（可能）不兼容的版本。

A->B->Cv1.0
&
A->X->Cv2.0
其中
Cv1.0 <> Cv2.0

*   有没有办法使这项工作？

*   可以在不使用 GAC 的情况下完成吗？

*   即使 B 和 X 仅是二进制格式（源不可访问），也可以这样做吗？

换句话说，有没有一种方法可以让项目 B 和 X 在项目 A 中一起使用时各自使用它们自己的依赖项，而不会引起冲突。

注意：我意识到理想情况下我根本不应该有这个问题，但是随着对外部库的依赖扩大，这将是一个不可避免的副作用。所以我想知道它应该如何最好地处理它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-05T08:17:48.607

Stack Overflow 上有很多类似的问题。例如[在同一解决方案中引用 2 个不同版本的 log4net](https://stackoverflow.com/questions/3158928/referencing-2-differents-versions-of-log4net-in-the-same-solution)

概括：

1.  确保将程序集 C 分别部署在包含主可执行文件的文件夹中的文件夹 1.0 和 2.0 中。
2.  更改 app.config 文件并包含以下内容：

> ```
>  <configuration>
>    <runtime>
>     <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
>       <dependentAssembly>
>        <assemblyIdentity name="C" publicKeyToken="C's public key token" />
>         <codeBase version="version string for C1.0 e.g. 1.0.0.0" href="1.0\C.dll" />
>         <codeBase version="version string for C2.0 e.g. 2.0.0.0" href="2.0\C.dll" />
>        </assemblyIdentity>
>       </dependentAssembly>
>     </assemblyBinding>
>    </runtime>
>  </configuration> 
> ```

您可以使用 sn -T C.dll 获取 C 的公钥令牌

如果 C 的 v1.0 和 v2.0 具有不同的公钥（尽管理想情况下它们不应该），则包含两个dependentAssembly 标记。

# c++ - Qt HTML5示例一步一步

> ID：11335579
> 
> 赞同：-2
> 
> 时间：2012-07-04T21:23:38.670
> 
> 标签：c++, html, qt

我决定开始学习 Qt C++ 和 HTML5

请有人提供一些关于 Qt HTML5 的逐步教程

或演示

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T21:26:05.870

[http://doc.qt.io/qt-4.8/](http://doc.qt.io/qt-4.8/)

有史以来最好的 Qt 知识中心 :)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-07-05T07:24:10.203

Qt 和 HTML5 有点遥远：Qt 来自 Desktop Federation，HTML5 来自 Web Republic，但如果您想将它们结合起来，您可能会对[QtWUI](http://qtwui.sourceforge.net/)感兴趣。

# c# - 无法将现有的 PictureBox 对象分配给对象数组

> ID：11335582
> 
> 赞同：0
> 
> 时间：2012-07-04T21:23:47.127
> 
> 标签：c#, winforms

我正在尝试从书中解决一个练习。（没有公布的答案）

我需要将表单上存在的 PictureBox 对象引用到对象数组。（我真的需要分配其中四个）

我初始化数组并将变量分配给它。然后我在数组中的每个项目中调用一个方法，但是没有分配 PictureBox 对象。（空异常）

我有点困惑，因为我在网上公开发现了一些代码片段，表明我这样做是正确的。

下面的代码请指点：

主班

```
public partial class Form1 : Form
{
    Greyhound[] greyhoundArray = new Greyhound[4];

    public Form1()
    {
        greyhoundArray[0] = new Greyhound() { Location = 0, MyPictureBox = dog1, RaceTrackLenght = 100, StartingPosition = 0 };
        greyhoundArray[1] = new Greyhound() { Location = 0, MyPictureBox = dog2, RaceTrackLenght = 100, StartingPosition = 0 };
        greyhoundArray[2] = new Greyhound() { Location = 0, MyPictureBox = dog3, RaceTrackLenght = 100, StartingPosition = 0 };
        greyhoundArray[3] = new Greyhound() { Location = 0, MyPictureBox = dog4, RaceTrackLenght = 100, StartingPosition = 0 };

        InitializeComponent();
    }

    private void timer1_Tick(object sender, EventArgs e)
    {
        foreach (Greyhound greyhound in greyhoundArray)
        {
            greyhound.Run();
        }
    }
} 
```

灰狗班

```
public class Greyhound
{
    public int StartingPosition;
    public int RaceTrackLenght;
    public PictureBox MyPictureBox;
    public int Location = 0;
    public Random Randomiser;

    public void Run()
    {
        // MessageBox.Show(MyPictureBox.Name + " was called");
        Randomiser = new Random();

        int distance = Randomiser.Next(0, 4);

        Point p = MyPictureBox.Location;
        p.X += distance;
        MyPictureBox.Location = p;
    }

    public void TakeStartingPosition()
    { }
} 
```

我还可以确认表格上确实存在每只狗的图片框：

来自 Form1.Designer.cs 的片段

```
// 
// dog1
// 
this.dog1.Image = ((System.Drawing.Image)(resources.GetObject("dog1.Image")));
this.dog1.Location = new System.Drawing.Point(17, 21);
this.dog1.Name = "dog1";
this.dog1.Size = new System.Drawing.Size(71, 26);
this.dog1.SizeMode = System.Windows.Forms.PictureBoxSizeMode.CenterImage;
this.dog1.TabIndex = 2;
this.dog1.TabStop = false; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T21:30:32.163

`InitializeComponent()`在初始化 GreyHound 数组之前调用。

当你调用 Greyhound 数组的初始化时，你还没有调用`this.dog1 = new PictureBox()`里面的 InitializeComponent，所以你将一个 null 复制到`MyPictureBox`每个 Greyhound 实例的属性中

另外，我认为您的 Greyhound 课程中的 Randomiser 变量有问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T21:34:40.393

您应该在声明数组中的任何内容之前初始化表单的控件，即因为您的数组正在引用表单中的项目。

```
 Greyhound[] greyhoundArray;

    public Form1()
    {
        InitializeComponent();
        greyhoundArray = new Greyhound[] {
          new Greyhound() {
            Location = 0,
            MyPictureBox = dog1,
            RaceTrackLenght = 100,
            StartingPosition = 0
          },
          new Greyhound() {
            Location = 0,
            MyPictureBox = dog2,
            RaceTrackLenght = 100,
            StartingPosition = 0
          },
          new Greyhound() {
            Location = 0,
            MyPictureBox = dog3,
            RaceTrackLenght = 100,
            StartingPosition = 0
          },
          new Greyhound() {
            Location = 0,
            MyPictureBox = dog4,
            RaceTrackLenght = 100,
            StartingPosition = 0
          },
       }
    } 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-04T21:27:37.533

您不能在表单的构造函数中访问表单控件。您需要在 Form_Load 事件处理程序中初始化您的灰狗的图片框。

# f# - 应用过滤器获取单个项目并使用过滤器函数转换结果

> ID：11335583
> 
> 赞同：1
> 
> 时间：2012-07-04T21:24:01.267
> 
> 标签：f#

在下面的示例代码中，我根据正则表达式过滤字符串列表，因为我知道只有一个条目可以匹配该字符串。然后，我使用相同的匹配字符串从单个剩余值中获取 2 个分组值。

```
let input = ["aaaa bbbb";"aaabbbb";"cccc$$$$";"dddddda";" "] 

let ValuesOfAB (input: string list) = 
    let matchString = "(?<a>\w+)\s(?<b>\w+)"

    let value = input |> List.filter (fun line -> Regex.Matches(line, matchString).Count <> 0) 
                      |> List.head
    (Regex.Matches(value, matchString).[0].Groups.["a"].Value, Regex.Matches(value, matchString).[0].Groups.["b"].Value)

let a = ValuesOfAB input 
```

有没有更好的方法让我不必再次在同一个字符串上使用 Regex.Matches 来获取我希望返回的值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T21:35:40.877

使用[List.pick](http://msdn.microsoft.com/en-us/library/ee370236.aspx)：

```
let input = ["aaaa bbbb";"aaabbbb";"cccc$$$$";"dddddda";" "] 

let valuesOfAB (input: string list) = 
    let matchString = "(?<a>\w+)\s(?<b>\w+)"
    let v = input |> List.pick (fun line -> let m = Regex.Match(line, matchString)
                                            if m.Success then Some m else None)
    v.Groups.["a"].Value, v.Groups.["b"].Value

let a = valuesOfAB input 
```

*解释：*

您想匹配列表中的第一个字符串并返回[Match](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.match.aspx)对象，这样您就不必再次运行 Regex。`List.pick`非常适合这项任务。

对于每个字符串，您至少需要匹配一次，这样`Regex.Match`就`Match.Success`足够了。

# android - 使用 App Widget 中的 ShareCompat 库

> ID：11335586
> 
> 赞同：1
> 
> 时间：2012-07-04T21:24:24.933
> 
> 标签：android, android-appwidget, android-pendingintent

我想为我的应用小部件视图创建一个挂起的意图，它将启动一个共享意图。*问题是在android.appwidget.AppWidgetProvider*类中没有引用任何活动。下面的代码不起作用，因为我无权访问 MainMenuActivity 类。任何想法，这甚至可能吗？

```
Intent shareIntent = ShareCompat.IntentBuilder.from(MainMenuActivity.this)
                   .setText("Some text")
                   .setType("text/plain")
                   .getIntent();

PendingIntent actionPendingIntent = PendingIntent.getActivity(context, 0, shareIntent, 0);
        views.setOnClickPendingIntent(R.id.widget_layout, actionPendingIntent); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T21:53:56.010

将`Context`提供的作为参数传递给您的`onUpdate()`方法到`from()`方法 on `ShareCompat.IntentBuilder`。

* * *

**更新**

抱歉，它看起来`ShareCompat.IntentBuilder`只能与Android 中的大多数其他东西一起使用`Activity`，而不是泛型。`Context`因此，您将无法从应用小部件中使用它。

# java - 将列从一个矩阵复制到另一个矩阵

> ID：11335596
> 
> 赞同：1
> 
> 时间：2012-07-04T21:25:09.940
> 
> 标签：java, opencv, javacv

JavaCV中是否有任何方法可以将一列从一个矩阵复制到另一列？两者的长度相同。

目前我使用一个简单的迭代器：

```
 mat=cvCreateMat(image.rows(), image.cols(), CV_32FC1);
    CvMat col= cvCreateMat(1, image.cols(), CV_32FC1);
    cvGetCol(image, col, 0);
    for (int y = 0; y < image.cols(); y++) {
        mat.put(0, y, col.get(y));
    } 
```

# sorting - 按数据值对 QTreeWidgetItem 进行排序？

> ID：11335602
> 
> 赞同：0
> 
> 时间：2012-07-04T21:25:56.107
> 
> 标签：sorting, pyqt, qtreewidget, qtreewidgetitem

是否可以通过 QTreeWidgetItem 的数据列对 PyQt QTreeWidget 进行排序？

例如，我有一个目录列表，我想在 QTreeWidget 中显示的磁盘上按大小排序，但我没有显示结果（以字节为单位），而是使用一种方法将目录大小转换为兆字节/千兆字节，但仍然能够按我存储在 QTreeWidgetItem 的数据槽中的实际值对项目进行排序。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-01T17:56:09.447

是的，我经常遇到这种情况。我一直认为理论上做类似的事情：

```
item = QTreeWidgetItem()
item.setData(0, Qt.EditRole, QVariant(1024))
item.setData(0, Qt.DisplayRole, '1 Kb') 
```

应该工作......不幸的是它没有。让它工作的唯一真正方法是继承 QTreeWidgetItem 并以自己的方式存储您的排序信息，或者使用 Qt.UserRole 与 EditRole 或 DisplayRole：

```
class MyTreeWidgetItem(QTreeWidgetItem):
    def __lt__( self, other ):
        if ( not isinstance(other, MyTreeWidgetItem) ):
            return super(MyTreeWidgetItem, self).__lt__(other)

        tree = self.treeWidget()
        if ( not tree ):
            column = 0
        else:
            column = tree.sortColumn()

        return self.sortData(column) < other.sortData(column)

    def __init__( self, *args ):
        super(MyTreeWidgetItem, self).__init__(*args)
        self._sortData = {}

    def sortData( self, column ):
        return self._sortData.get(column, self.text(column))

    def setSortData( self, column, data ):
        self._sortData[column] = data 
```

因此，在这种情况下使用它与以前类似，但实际上允许通过自定义数据进行排序：

```
item = MyTreeWidgetItem()
item.setSortData(0, 1024)
item.setText(0, '1 kb')01 
```

# php - jQuery JSON 和 PHP 关联数组数组问题

> ID：11335606
> 
> 赞同：1
> 
> 时间：2012-07-04T21:26:19.573
> 
> 标签：php, jquery, json

嗨，我想知道是否有人可以帮助我？

我有以下代码。它从 php 文件中检索 JSON 数据。Json 格式如下：

```
{"Title":"rose","Price":1.25,"Number":15},{"Title":"daisy","Price":0.75,"Number":25},{"Title":"orchid","Price":1.15,"Number":7} 
```

此 JSON 是使用以下 php 代码创建的：

```
$shop = array();
$shop = array( array( Title => "rose", 
                  Price => 1.25,
                  Number => 15 
                ),
           array( Title => "daisy", 
                  Price => 0.75,
                  Number => 25,
                ),
           array( Title => "orchid", 
                  Price => 1.15,
                  Number => 7 
                )
         );

 echo json_encode($shop); 
```

每当我尝试使用 obj.Title 访问数据时，我都会收到一条未定义的消息。

```
 $.ajax({
        type: "GET",
        url: "data.php",
        success: jsonDo
    });

    //JSON DATA = {"Title":"rose","Price":1.25,"Number":15},{"Title":"daisy","Price":0.75,"Number":25},{"Title":"orchid","Price":1.15,"Number":7}

    function jsonDo(data) {

        var obj = jQuery.parseJSON(data);

        alert(obj.Title)

    } 
```

我想知道如何访问 JSON 中的键并显示数据？

太感谢了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T21:33:53.613

```
var obj = jQuery.parseJSON('{"Title":"rose","Price":"1.25","Number":"15"}');

alert(obj.Title); 
```

这项工作。检查代码中的差异。

好的，这更正确：

```
var obj = [
    {"Title":"rose","Price":"1.25","Number":"15"},
    {"Title":"daisy","Price":"0.75","Number":"25"},
    {"Title":"orchid","Price":"1.15","Number":"7"}
    ];

 alert(obj[1].Title); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T21:38:58.273

`dataType: "JSON"`您必须通过将参数通知函数来指定您期望的是 JSON 对象`ajax()`，因此您不必解析数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-04T21:43:38.520

您的代码中似乎存在一些 PHP 错误。这可能会导致 php 发出通知/警告，这可能会破坏 Json 输出并导致 javascript 在尝试解析它时引发错误。

正确的 json 输出应该是

```
[{"Title":"rose","Price":1.25,"Number":15},{"Title":"daisy","Price":0.75,"Number":25},{"Title":"orchid","Price":1.15,"Number":7}] 
```

既然是数组，JS应该是： $.ajax({ type: "GET", url: "data.php", success: jsonDo });

```
function jsonDo(data) {
    var obj = jQuery.parseJSON(data);
    alert(obj[0].Title)

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-04T21:30:45.537

你应该只使用jQuery的[`$.getJSON`](http://api.jquery.com/jQuery.getJSON/)方法：

```
$.getJSON('data.php',function(data) {
    alert(obj.Title);
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-04T21:32:49.687

尝试 obj[0]["Title"] 或 obj[0].Title

不要忘记您已经嵌套了很多数组，并且 yoyu 需要再次以这种方式访问​​它们。

# android - 在 Android 上运行的 OpenGL ES 2.0 中无法获取要渲染到四边形的纹理

> ID：11335608
> 
> 赞同：2
> 
> 时间：2012-07-04T21:26:29.783
> 
> 标签：android, opengl-es

当我启动该项目时，我会在预期的青色背景中呈现出一个不祥的黑色四边形。我已经确定纹理坐标正在使用片段着色器中注释掉的代码行进行正确插值。我尝试了许多不同的加载纹理的方法，并且总是得到相同的结果。加载 4 像素纹理的临时代码是从书中的示例中逐字复制的。但是，我也将其包括在内，以防万一我疏忽了。

我试图删除无礼的代码。但是，我对此仍然很陌生，并且不断学习大部分代码的全部含义。此外，许多代码都改编自不同的来源。因此，对于混乱、不一致的变量命名和冗长，我深表歉意。我确实觉得问题出在前几行。在此先感谢您的所有见解。甚至任何有关我如何进行调试的信息都将不胜感激；当在这个项目上工作时出现问题时，我感到很茫然。

画框：

```
public void onDrawFrame(GL10 gl) 
{

    GLES20.glClearColor(0.0f, 1.0f, 1.0f, 1.0f);

    GLES20.glClear(GLES20.GL_DEPTH_BUFFER_BIT | GLES20.GL_COLOR_BUFFER_BIT);                    
    update();

    GLES20.glUseProgram(mProgramHandle);
    GLES20.glActiveTexture(GLES20.GL_TEXTURE0);
    GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, mTextureHandle);
    GLES20.glUniform1i(mTextureUniformHandle, 0);

    //For some reason I think the problem is in this area

    Matrix.setIdentityM(mModelMatrix, 0);

    quadVerts.position(mPositionOffset);
    GLES20.glVertexAttribPointer(mPositionHandle, mPositionDataSize, GLES20.GL_FLOAT, false, mStrideBytes, quadVerts);        
    GLES20.glEnableVertexAttribArray(mPositionHandle);

    quadVerts.position(mColorOffset);
    GLES20.glVertexAttribPointer(mColorHandle, mColorDataSize, GLES20.GL_FLOAT, false, mStrideBytes, quadVerts);        
    GLES20.glEnableVertexAttribArray(mColorHandle);

    GLES20.glVertexAttribPointer(mTextureCoordinateHandle, 2, GLES20.GL_FLOAT, false, 0, quadTex);        
    GLES20.glEnableVertexAttribArray(2);

    Matrix.multiplyMM(mMVPMatrix, 0, mViewMatrix, 0, mModelMatrix, 0);

    Matrix.multiplyMM(mMVPMatrix, 0, mOrthographicMatrix, 0, mMVPMatrix, 0);

    GLES20.glUniformMatrix4fv(mMVPMatrixHandle, 1, false, mMVPMatrix, 0);
    GLES20.glDrawArrays(GLES20.GL_TRIANGLE_FAN, 0, 4);         

    //...    
    checkGlError("on draw frame: ");
} 
```

表面改变：

```
 public void onSurfaceChanged(GL10 glUnused, int width, int height) 
{
    GLES20.glViewport(0, 0, width, height);
    w = width;
    h = height;
    final float near = 1.0f;
    final float far = 10.0f;
    Matrix.orthoM(mOrthographicMatrix, 0, 0, width, 0, height, near, far);
    float[] pVertsData =
        {
            20.0f, 20.0f, 0.0f, 
            1.0f, 1.0f, 1.0f, 1.0f,

            (float) width- 20.0f, 20.0f, 0.0f, 
            1.0f, 1.0f, 1.0f, 1.0f,

            (float) width - 20.0f, (float) height - 20.0f, 0.0f, 
            1.0f, 1.0f, 1.0f, 1.0f,

            20.0f, (float) height - 20.0f, 0.0f,
            1.0f, 1.0f, 1.0f, 1.0f
        };

    quadVerts = ByteBuffer.allocateDirect(pVertsData.length * 4).order(ByteOrder.nativeOrder()).asFloatBuffer();

    quadVerts.put(pVertsData).position(0);

    float texture[] = 
        {
            0.0f, 0.0f,
            1.0f, 0.0f,
            1.0f, 1.0f,
            0.0f, 1.0f
        };
    quadTex = ByteBuffer.allocateDirect(texture.length * 4).order(ByteOrder.nativeOrder()).asFloatBuffer();
    quadTex.put(texture).position(0);

checkGlError("surface changed: ");
} 
```

表面创建：

```
public void onSurfaceCreated(GL10 glUnused, EGLConfig config) 
{
    mParticleSystem = new ParticleSystem();
     //GLES20.glEnable(GLES20.GL_TEXTURE_2D);
     if (mTextureHandle != 1)
    mTextureHandle = loadGLTexture(activeContext, resourceID);
    GLES20.glClearColor(0.0f, 0.0f, 0.0f, 1.0f);

    final float eyeX = 0.0f;
    final float eyeY = 0.0f;
    final float eyeZ = 1.5f;

    final float lookX = 0.0f;
    final float lookY = 0.0f;
    final float lookZ = -5.0f;

    final float upX = 0.0f;
    final float upY = 1.0f;
    final float upZ = 0.0f;

    Matrix.setLookAtM(mViewMatrix, 0, eyeX, eyeY, eyeZ, lookX, lookY, lookZ, upX, upY, upZ);

    final String vertexShader = 
            "uniform mat4 u_MVPMatrix;              \n"

        +   "attribute vec4 a_Position;             \n"
        +   "attribute vec4 a_Color;                \n"
        +   "attribute vec2 a_TexCoordinate;        \n"

        +   "//varying vec3 v_Position;             \n"
        +   "varying vec4 v_Color;                  \n"
        +   "varying vec2 v_TexCoordinate;          \n"

        +   "void main()                            \n"
        +   "{                                      \n"
        +   "   v_TexCoordinate = a_TexCoordinate;  \n"
        +   "   v_Color = a_Color;                  \n"
        +   "   gl_Position = u_MVPMatrix           \n"
        +   "               * a_Position;           \n"
        +   "}                                      \n";

    final String fragmentShader =
            "precision mediump float;       \n"

        +   "uniform sampler2D u_Texture;   \n" 
        +   "varying vec4 v_Color;          \n"
        +   "varying vec2 v_TexCoordinate;  \n"
        +   "void main()                    \n"
        +   "{                              \n" 
        +   "   vec4 baseColor;"
        +   "   baseColor = texture2D(u_Texture, v_TexCoordinate);      \n"
        +   "    " 
        +   "   gl_FragColor = baseColor;   \n" 
        +   "                           \n"
        +   "   //gl_FragColor = vec4(v_TexCoordinate.x, v_TexCoordinate.y, 0.0, 1.0);  \n"
        +   "   //gl_FragColor = v_Color;       \n"

        +   "}                              \n";

    //... Compile Shaders

    int programHandle = GLES20.glCreateProgram();
    if (programHandle != 0) 
    {
        GLES20.glAttachShader(programHandle, vertexShaderHandle);           
        GLES20.glAttachShader(programHandle, fragmentShaderHandle);
        GLES20.glBindAttribLocation(programHandle, 0, "a_Position");
        GLES20.glBindAttribLocation(programHandle, 1, "a_Color");
        GLES20.glBindAttribLocation(programHandle, 2, "a_TexCoordinate");
        GLES20.glLinkProgram(programHandle);
        final int[] linkStatus = new int[1];
        GLES20.glGetProgramiv(programHandle, GLES20.GL_LINK_STATUS, linkStatus, 0);
        if (linkStatus[0] == 0) 
        {               
            GLES20.glDeleteProgram(programHandle);
            programHandle = 0;
        }
    }

    if (programHandle == 0)
    {
        throw new RuntimeException("Error creating program.");
    }
    mMVPMatrixHandle = GLES20.glGetUniformLocation(programHandle, "u_MVPMatrix");        
    mPositionHandle = GLES20.glGetAttribLocation(programHandle, "a_Position");
    mColorHandle = GLES20.glGetAttribLocation(programHandle, "a_Color");
    mTextureUniformHandle = GLES20.glGetUniformLocation(programHandle, "u_Texture");
    mTextureCoordinateHandle = GLES20.glGetAttribLocation(programHandle, "a_TexCoordinate");

    //GLES20.glUseProgram(programHandle);  
    mProgramHandle = programHandle;
checkGlError("surface created: ");
    } 
```

加载纹理：

```
private int loadGLTexture(Context context, final int resourceId)
{

    final int[] textureHandle = new int[1];
    GLES20.glActiveTexture(GLES20.GL_TEXTURE0);
    GLES20.glPixelStorei(GLES20.GL_UNPACK_ALIGNMENT, 1);
        GLES20.glGenTextures(1, textureHandle, 0);

        byte[] pixels = 
            {  
                (byte) 0xff,   0,   0, 
                0, (byte) 0xff,   0, 
                0,   0, (byte) 0xff,
                (byte) 0xff, (byte) 0xff,   0
            };

        ByteBuffer pixelBuffer = ByteBuffer.allocateDirect(4*3);
        pixelBuffer.put(pixels).position(0);
        GLES20.glBindTexture ( GLES20.GL_TEXTURE_2D, textureHandle[0] );
        GLES20.glTexImage2D ( GLES20.GL_TEXTURE_2D, 0, GLES20.GL_RGB, 2, 2, 0, GLES20.GL_RGB, GLES20.GL_UNSIGNED_BYTE, pixelBuffer );
        GLES20.glTexParameteri ( GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MIN_FILTER, GLES20.GL_NEAREST );
        GLES20.glTexParameteri ( GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_MAG_FILTER, GLES20.GL_NEAREST );
        GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_WRAP_S, GLES20.GL_CLAMP_TO_EDGE);
        GLES20.glTexParameteri(GLES20.GL_TEXTURE_2D, GLES20.GL_TEXTURE_WRAP_T, GLES20.GL_CLAMP_TO_EDGE);

    }
    if (textureHandle[0] == 0)
    {
        throw new RuntimeException("Error loading texture.");
    }
    checkGlError("create texture: ");
    return textureHandle[0];
} 
```

代码更新如下所示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T13:42:13.990

最后，定位问题。为了简单起见，我在发布的代码中删除了很多注释掉的行。其中之一是片段着色器中直接位于“gl_FragColor = baseColor;”之前的行。然而这条线没有'\n'......所以实际上我已经注释掉了应该实际将纹理放在四边形上的线。因此，上面的代码实际上会正常运行，而我项目中的代码则不会。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T21:46:59.280

夫妇的想法。我不知道你的问题是否在这里，但这里是：

1.  您没有使用 glGetError 进行任何错误检查（您应该这样做）。它会帮助你发现很多问题。

2.  `GLES20.glEnable(GLES20.GL_TEXTURE_2D);`在 GLES2.0 中不是合法调用。启用 GL_TEXTURE_2D 只会影响已弃用的固定功能管道。这可能会产生错误，但不应导致您的问题。

您可以尝试添加错误检查，并在有任何问题时报告吗？我扫描了你的代码，但到目前为止它看起来很正确。

# javascript - XML 问题 - 加载空白页面

> ID：11335613
> 
> 赞同：2
> 
> 时间：2012-07-04T21:27:02.887
> 
> 标签：javascript, xml, ajax

我是 XML 编码的新手，我现在正在一个网站上工作，以帮助我提高技能。我想我得到了页面的所有语法，但它似乎不起作用。这是索引页面的代码，也是我尝试使用的 xml 文件。

```
<html>
<body>

<script type="text/javascript">
var link= "http://api.remix.bestbuy.com/v1/stores(area(55423,10))+products(name=playstation*)?show=storeId,name,products.sku,products.name&page=1&apiKey=ydpyq9h9cmpmzaakbawv9mzk";
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.open("GET","test.xml",false);
xmlhttp.send();
xmlDoc=xmlhttp.responseXML; 
document.write("<table border='1'>");
var x = xmlDoc.getElementsByTagName("name");
for (i=0;i<5;i++)
  { 
  document.write("<tr><td>"); 
  document.write(x[i].getElementsByTagName("name")[0].childNodes[0].nodeValue);
   document.write("Step 2");
  document.write("</td><td>");
  document.write(x[i].getElementsByTagName("distance")[0].childNodes[0].nodeValue);
  document.write("</td></tr>");
  }
document.write("</table>");
</script>

</body>
</html> 
```

和 XML 我得到了一个样品百思买请求

```
<stores warnings="Distances are in terms of miles (default). Your product criteria matches too many records. That exceeds number of records that we allow on the product side of a store-product query. We've automatically truncated the products down to the first 100\. These results are not complete. Avoid this by narrowing the number of products in your query." currentPage="1" totalPages="1" from="1" to="10" total="10" queryTime="0.015" totalTime="0.153" canonicalUrl="/v1/stores(area("55423",10))+products(name="playstation*")?show=storeId,name,products.sku,products.name&apiKey=ydpyq9h9cmpmzaakbawv9mzk" partial="false">
  <store>
    <storeId>281</storeId>
    <name>Richfield</name>
    <products>
      <product>
        <sku>9984133</sku>
        <name>Assassin's Creed Brotherhood - PlayStation 3</name>
      </product>
      <product>
        <sku>7917141</sku>
        <name>Assassin's Creed Greatest Hits - PlayStation 3</name>
      </product>
      <product>
        <sku>2613621</sku>
        <name>Assassin's Creed: Revelations - PlayStation 3</name>
      </product>
      <product>
        <sku>3109269</sku>
        <name>Assassin's Creed: Revelations Collector's Edition (Game Guide) - Xbox 360, PlayStation 3, Windows</name>
      </product>
      <product>
        <sku>3109065</sku>
        <name>Assassin's Creed: Revelations The Complete Official Guide (Game Guide) - Xbox 360, PlayStation 3, Windows</name>
      </product>
      <product>
        <sku>9927337</sku>
        <name>Batman: Arkham Asylum Game of the Year Edition - PlayStation 3</name>
      </product>
      <product>
        <sku>3116162</sku>
        <name>Batman: Arkham City (Signature Series Game Guide) - Windows, PlayStation 3, Xbox 360</name>
      </product>
      <product>
        <sku>5260722</sku>
        <name>Batman: Arkham City - Game of the Year Edition - PlayStation 3</name>
      </product>
      <product>
        <sku>2173056</sku>
        <name>Batman: Arkham City - PlayStation 3</name>
      </product>
      <product>
        <sku>3550073</sku>
        <name>Battlefield 3 (Game Guide) - Xbox 360, PlayStation 3, Windows</name>
      </product>
</products>
  </store>
</stores> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T21:35:32.177

您必须在对象的`onreadystatechange`事件中放置数据加载后执行的代码：http: [//www.w3schools.com/ajax/ajax_xmlhttprequest_onreadystatechange.asp](http://www.w3schools.com/ajax/ajax_xmlhttprequest_onreadystatechange.asp)`xmlhttp`

```
xmlhttp.onreadystatechange = function() {
    if (httprequest.readyState == 4) {
        // Response finished
        if (httprequest.status = 200) {
           // everything OK
           // Parse the data
        } else {
           // Something gone wrong with the request
        }
    }
} 
```

**编辑：**
现在查看您的代码，我意识到您正在使用`var x = xmlDoc.getElementsByTagName("name");`. 这将选择每个标签`name`，包括内部标签。尝试使用`store`来获取每个而不是名称，然后查找`product`.

此外，您在 for 循环中使用了硬编码限制。改用`x.length`：`for (var i=0; i<x.length;i++)`

# java - java服务器将字符串数组列表发送到android客户端

> ID：11335618
> 
> 赞同：0
> 
> 时间：2012-07-04T21:27:55.303
> 
> 标签：java, android, servlets

我想使用servlet从android向java tomcat服务器发送请求，然后服务器将向客户端发送大量数据，数据包含很多行，每一行都有三个参数：

```
competitionID, marks, numberOfQuestions 
```

### 将请求从android发送到服务器的代码

```
HttpClient client = new DefaultHttpClient();
        URI website;
            website = new URI("http://" + HostIP
                    + ":8080/LocalizedBasedComptitionServer/JoinCompetition");
            HttpPost request = new HttpPost();
            request.setHeader("ID", ID + "");
            request.setURI(website);
            HttpResponse response = client.execute(request); 
```

### 小服务程序代码

```
protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        ServletOutputStream out = response.getOutputStream();
        CellDatabase cDB = new CellDatabase();
                List<String[]>list = new LinkedList<String[3]>();
        out.flush();
    } 
```

我如何发送列表`list`以及如何接收？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T22:25:33.133

有几种方法可以实现这一点：

1.将响应格式化为 JSON 数组，例如：

```
[ 
   { competitionId : "6", marks : "2", numberOfQuestions : "3"},
   { competitionId : "2", marks : "1", numberOfQuestions : "5"},
] 
```

然后您的客户端将只将此 JSON 字符串解析为数组

2.创建自己的分隔字符串结果，例如：6,2,3|2,1,5

由于您知道响应将是一个由 3 个元素组成的数组，因此您可以先用特殊字符“|”分隔项目，然后为每个数组项目再用分隔符“,”将其拆分，您将获得比赛 ID、标记和问题。

这种方法快速简单但难以维护：如果您添加/删除新元素，或在服务器端更改分隔符，您的客户端将中断。所以使用 JSON 方法可能是要走的路。

# javascript - 新窗口中的 HTML

> ID：11335621
> 
> 赞同：0
> 
> 时间：2012-07-04T21:28:25.977
> 
> 标签：javascript

我想打开一个新窗口（或选项卡），并将 html 代码放入其中。我怎样才能做到这一点？

就像是：

```
window.open("","foo");
foo.body="alert('HI')';"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T21:34:01.427

好旧的 DOM0：

```
var win = window.open("javascript:void(0)");
win.document.write("<html><body>text</body></html>");
win.document.close(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T21:30:38.943

```
window.open('foo.html', 'foo'); 
```

在里面`foo.html`你可以放你想要的代码。例如：

```
<html>
<head>
    <title>This is Foo</title>
    <script type="text/javascript">
        alert('HI')';
    </script>
</head>
</html> 
```

您也可以直接写入新打开的窗口的内容：

```
var win = window.open('', 'foo');
var doc = win.document;
doc.write('<html>');
doc.write('<head>');
doc.write('<title>This is foo</title>');
doc.write('<script type="text/javascript">alert("HI");</script>');
doc.write('</head>')
doc.write('<body>')
doc.write("</body>")
doc.write("</html>") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-04T21:42:05.387

```
 function openWindow()
 {
     NewWindow=window.open("", "awindow","width=300,height=300");
     NewWindow.document.write('New content...');
 } 
```

**HTML**

```
<a href="javascript:openWindow()">Open</a>​ 
```

[**演示。**](http://jsfiddle.net/BMm9a/4/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-04T21:46:24.783

AFAIK，您不能从父级调用子级函数 - 但您可以从子级调用父函数

因此，在父窗口的全局范围内定义一个返回所需值的函数：

```
// Parent window
var getHTML = function(){
   return "<span>foo</span>";
}; 
```

然后在子窗口中调用它：

```
// Child window
window.onload = function(){
    document.getElementById('foo').innerHTML = window.opener.getHTML();
}; 
```

# c++ - 什么是用于破坏 C++ 符号名称的 Linux 实用程序？

> ID：11335624
> 
> 赞同：53
> 
> 时间：2012-07-04T21:28:59.017
> 
> 标签：c++, compiler-construction, dlsym, demangler

我有`c++filt`命令去破坏符号，相反的工具是什么工具来破坏符号名称？

如果我想调用`dlsym()`一个错位的 C++ 函数名，这将很有用。我宁愿不对代码中的名称进行硬编码，因为由于使用了新的编译器版本或新的编译器品牌，或者目前由于为多个平台编译，它可能会随着时间的推移而改变。

是否有一种编程方式可以在运行时获取表示 C++ 函数的字符串，以便代码独立于编译器？一种可能的方法是在编译时调用一个实用程序，该实用程序为正在使用的编译器执行名称修改，并将适当的修改后的 C++ 符号名称插入到字符串中`dlsym()`以供使用。

[这是我在此站点上找到的最接近解决方案的解决方案，该解决方案](https://stackoverflow.com/q/1067346/115751)是通过使用固定的 C 样式名称间接到您希望的库中定义的 C++ 符号来完成的`dlsym()`，但如果您无法控制该库的内容提供，这不是一个选项。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-08-23T03:37:45.367

这就是 g++ 破坏名称的方式。您可能会在您的程序中实施这些修改规则。

另一个（疯狂的）解决方案是列出您要使用的库中的所有符号（如果您了解格式，这并不难），将它们全部解开，然后在该列表中搜索您的函数名称。这种方法的优点是拆解更容易，因为有一个函数调用来做到这一点：`abi::__cxa_demangle`，来自 cxxabi.h 头文件。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-08-21T21:29:52.417

您可以通过查看 .so 您正在查看的符号表来获得所需的内容：其他人已经回答了此问题 [Returning a shared library symbol table](https://stackoverflow.com/questions/2694290/returning-a-shared-library-symbol-table)。

但是，如果符号太多……那可能行不通。
所以这是一个疯狂的想法。买者自负！

一个潜在的解决方案是：

1.  创建一个包含一个名称的存根文件：您想要的名称：void myfunction() { }

2.  编译该文件（使用 -fPIC 和 -shared 所以它是一个动态库）

3.  在该特定文件上调用 dlopen/dlsym

4.  遍历符号（应该只有一个想要的符号加上您可以过滤的其他常规垃圾）。遍历符号很笨拙，但您可以做到： [返回共享库符号表](https://stackoverflow.com/questions/2694290/returning-a-shared-library-symbol-table)

5.  dlclose() 释放它（从你的符号中丢失存根）

6.  用 dlopen 打开你想要的文件

基本上，你会从你的代码中调用编译器，它会创建一个 .so 你可以查看，取出唯一的值，然后卸载那个 .so 以便你可以加载你想要的那个。

这很疯狂。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-08-19T16:24:20.667

名称修饰是特定于实现的。

名称修饰没有标准，因此最好的办法是找到一个编译器来为您完成。

[名称修改](https://en.wikipedia.org/wiki/Name_mangling#Name_mangling_in_C.2B.2B)

如果您希望手动执行此操作，此处有一个表格可以帮助您

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-06-25T12:51:37.127

比第一次发布的更简单的方法。编写一个小 C++ 程序，例如：

```
#include <stdlib.h>

extern int doit(const char *toto, bool is);

int main(int argc, char *argv[])
{
  exit(doit (argv[0], true));
} 
```

构建它

```
# g++ -S test.cpp 
```

并从汇编源代码中提取符号名称

```
# cat test.s | grep call | grep doit | awk '{print $2}' 
```

你得到：

```
rcoscali@srjlx0001:/tmp/TestC++$ cat test.s | grep call | grep doit | awk '{print $2}'
_Z4doitPKcb
rcoscali@srjlx0001:/tmp/TestC++$ 
```

重整的`doit`符号是`_Z4doitPKcb` 使用您计划使用的编译器，因为每个编译器都有自己的名称重整规则（正如之前所说的，从一个编译器到另一个编译器，这些规则可能会改变）。

玩得开心 ！

# php - ajax中常见的服务器响应页面原因？

> ID：11335625
> 
> 赞同：1
> 
> 时间：2012-07-04T21:28:59.487
> 
> 标签：php, javascript, jquery, mysql, ajax

我开发了一个 facebook 应用程序，它每 3 秒使用一次 ajax 请求/响应。还有一些菜单项正在加载主 div 中的内容。每个 ajax 请求都会发送到 common.php。很少有 ajax 很慢。我想知道对所有请求使用单个文件会降低性能吗？

这是缓慢的ajax请求：

```
function FetchMore()
{

document.getElementById("debugger").innerHTML = "Fetch more called";
    attempt++;  

      /*********proccessing ajax***********/
      document.getElementById("bldr").style.display="";
        var urlp="https://www.shopinion.net/facebook/common.php?FBUID="+fbuid+"&action=more&attempt="+attempt+"&what="+lstevt;

if(lstevt == "home" || lstevt == "rec")
{

    if(complete==false)
    {
    complete=true;

     setTimeout("Watcher()",10000);
document.getElementById("debugger").innerHTML = "Reqest send Fetch more called";
        MoreAjaxReq = $.ajax({
        async: true,
          url: urlp,
          cache: true,
          success: function(data) {

                                complete=false;

document.getElementById("debugger").innerHTML = "Data received Fetch more";
             setTimeout("getScroll()",3000);
                           document.getElementById("content").innerHTML +=data;
                                    document.getElementById("content").style.opacity="1";
                                    Tip();
                                      $('a[rel*=facebox]').facebox({
                    loadingImage : 'facebox/loading.gif',
                    closeImage   : 'facebox/closelabel.png'
                  })

                                     var handler = null;

                                    // Prepare layout options.
                                    var options = {
                                      autoResize: true, // This will auto-update the layout when the browser window is resized.
                                      container: $('#content'), // Optional, used for some extra CSS styling
                                      offset: 6, // Optional, the distance between grid items
                                      itemWidth: 210 // Optional, the width of a grid item
                                    };
                                    $(document).bind('scroll', onScroll);

                                  // Call the layout function.

                                  handler = $('#tiles li');
                                  handler.wookmark(options);

      $('a[rel*=facebox]').facebox({
        loadingImage : 'facebox/loading.gif',
        closeImage   : 'facebox/closelabel.png'
      })

 document.getElementById("bldr").style.display="none";

                    //FB.Canvas.scrollTo(0,400);

setTimeout("Trick87()",3000);

          }
        });

    } 
```

// 请帮我如何提高响应时间？先谢谢了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T21:34:23.167

哦，有很多方法可以提高性能。我会列出几个

*   在服务器端缓存数据
*   最小化响应中的内容
*   如果第一个请求尚未成功，也许您不必获取更多数据。
*   使用尽可能少的数据库调用

# android - Android：如何创建横向传播图像和纵向传播半图像的ViewPager？

> ID：11335627
> 
> 赞同：3
> 
> 时间：2012-07-04T21:29:14.663
> 
> 标签：android, android-viewpager, horizontalscrollview

我想做的只是在 Android 中使用水平寻呼机来**滚动杂志页面。**

**横向模式：**单屏页面 1 和页面 2

**纵向模式：** 第一屏显示第 1 页，第二屏显示第 2 页。同样地..

如果我有 10 个横向屏幕，那么它将是 20 个纵向屏幕。

我看过很多文章并尝试过 HorizantalPager、HorizantalListView 和 ViewPager，但它们似乎都没有做我想做的事。

谁能指导我正确的方向？

# java - 没有重复类型时，XJC Multi 文件已定义错误

> ID：11335628
> 
> 赞同：0
> 
> 时间：2012-07-04T21:29:32.823
> 
> 标签：java, xsd, jaxb, xjc

我正在使用 xjc 命令编译一些 XSD 文件并为我生成类。但我有一个奇怪的问题。当我编译只传递一个文件给它时，它编译得很好。但是当我通过 dir 编译所有内容时，它说已经定义了一个类型。它说这两种类型都在同一个文件中。当我转到指定的行时，我看到类型的名称完全不同（它说 xsd 文件中的每个类型都已定义，并将另一个定义指向同一个文件）。我已经搜索了所有文件以查看该类型是否存在于其他地方，但我没有找到一个重复的文件。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T12:28:58.600

我发现还有其他文件包括相同的 XSD 使其与自身发生冲突。

# google-closure - goog.net.xhrio.send 不调用服务器

> ID：11335629
> 
> 赞同：2
> 
> 时间：2012-07-04T21:29:43.043
> 
> 标签：google-closure, plovr

我在这个 onclick 事件中调用 goog.net.XhrIo

```
goog.events.listen(invBtn, goog.ui.Component.EventType.ACTION,
        function(e) {

   goog.net.XhrIo.sent('http://remotehost.com:8080/customer/add');
 (update :typo here send instead of sent ) 
```

这是我想要完成的非常基本的任务，但这个调用甚至没有到达服务器。我也尝试将 url 作为 goog.Uri 传递，但没有帮助。我想知道是什么阻止了对服务器的调用，我尝试了主机名和 IP 地址，但都没有帮助。它什么也不做。

我能做些什么来看看为什么这个调用甚至无法到达服务器。

感谢任何帮助

问候埃迪

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T22:15:55.153

在您的[plovr](http://plovr.com/)配置文件中，将警告级别设置为`VERBOSE`：

```
// 配置.js
{
  “路径”：“js”，
  “模式”：“高级”，
  “级别”：“详细”
}

```

启用警告后，`VERBOSE`运行程序会显示以下警告：

```
JSC_INEXISTENT_PROPERTY：发送的属性从未在 goog.net.XhrIo 上定义...
goog.net.XhrIo.sent('http://remotehost.com:8080/customer/add');
^

```

尝试更改`goog.net.XhrIo.sent();`为`goog.net.XhrIo.send();`.

此外，您可能希望将回调函数传递给 XhrIo 发送函数，如下所示：

```
goog.net.XhrIo.send('http://remotehost.com:8080/customer/add', function(e) {    
  var xhr = /** @type {goog.net.XhrIo} */ (e.target);
  alert(xhr.getResponseText());
}); 
```

另一种常见的模式是创建一个 xhr 对象并注册一个事件监听器：

```
var xhr = new goog.net.XhrIo();
goog.events.listenOnce(xhr, goog.net.EventType.COMPLETE, function(e) {
  var xhr = /** @type {goog.net.XhrIo} */ (e.target);
  alert(xhr.getResponseText());
  xhr.dispose(); // Dispose of the XHR if it is not going to be reused.
});
xhr.send('http://remotehost.com:8080/customer/add'); 
```

### 延伸阅读

[闭包：权威指南](https://rads.stackoverflow.com/amzn/click/com/1449381871)，第 7 章：***客户端-服务器通信***

# scala - 电梯入门

> ID：11335632
> 
> 赞同：10
> 
> 时间：2012-07-04T21:30:09.640
> 
> 标签：scala, lift

我想学电梯。不幸的是，我尝试过的所有文档都是过时的、不可读的、不正确的或上述的组合。我尝试了以下方法：

*   只需电梯。我尝试过的书中的一些内容会导致错误。
*   探索电梯。书的结构很差。很难同时在野外阅读和尝试代码。
*   电梯在行动。和上一个一样，但需要付费。

PS我见过类似的问题。他们中的大多数是很久以前被问到的。从那篇著作开始，情况是否有所改善？

PPS 是否有任何其他类型安全的 Scala Web 框架（不提供 Play 2.0。它不是类型安全的。我看不出有任何理由在 Scala 中创建它）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-05T00:48:35.083

不幸的是，Lift 文档的状态充其量是不平衡的，并且存在巨大的漏洞。

然而，Lift 社区里到处都是非常乐于助人的人。

我的建议不是玩弄，而是尝试实施一些东西。如果您遇到困难，请询问有关您正在尝试做什么、您是如何做的以及为什么它不起作用的具体、直接的问题。

到目前为止，尽管我希望获得更好的文档，但我已经能够通过 Google 或 Lift 邮件列表获得所需的所有答案——尽管我希望将来我可能会在这里提出更多问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-05T08:35:56.337

Lift 文档不是它的强项。哲学更多的是“尝试并询问您是否有任何问题”。这里有一些提示：

### 组装

一个非常有用的资源是[http://www.assembla.com/wiki/show/liftweb](http://www.assembla.com/wiki/show/liftweb)，有很多示例，因此您可以逐步了解它的工作原理。

### 邮件列表

否则，如果您有特定的问题，您可以随时使用邮件列表，即使在我看来，为了解决已经遇到的问题，很难快速探索它。[http://groups.google.com/group/liftweb](http://groups.google.com/group/liftweb)

### 堆栈溢出

最后，Stackoverflow 上有一个小型社区，因此请随时在这里提问。这是同时寻找答案和创建文档的好方法。

### 源代码

如果您对函数的行为有特定的问题/怀疑，请不要犹豫探索源代码和 scaladoc，它们通常很短，甚至有时会被注释！[http://scala-tools.org/mvnsites/liftweb-2.4-M4/#package](http://scala-tools.org/mvnsites/liftweb-2.4-M4/#package)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-05T19:48:08.597

看看电梯食谱：[http ://cookbook.liftweb.net/](http://cookbook.liftweb.net/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-05T10:37:08.193

> “Simlply Lift。我尝试过的书中的某些内容会导致错误。”

你有什么确切类型的错误？[您是否尝试过使用可以从 GitHub https://github.com/dpp/simply_lift](https://github.com/dpp/simply_lift)下载的“Simply Lift”示例来遵循它 ？

我遇到的唯一错误与我缺乏 SBT 经验有关，但那是另一回事了。

我主要从那个来源开始使用 Lift（Simply Lift + 示例），并结合其强大的社区和 Google（ChrisJamesC 列出了非常好的主要链接），这对我来说非常好。

我建议您解决“Simply Lift”教程中给出的所有示例，或者至少解决它们，除非您觉得可以直接“在媒体资源中”跳并自己尝试一些东西。这对我来说是学习 Lift 的最佳方式。此外，每当您遇到问题并且无法在网络上找到解决方案时，Lift Google 群组（[https://groups.google.com/forum/?fromgroups=#!forum/liftweb](https://groups.google.com/forum/?fromgroups=#!forum/liftweb) ）都欢迎您提出问题并得到解答）。David Pollak 经常会直接回答你的问题，所以我对这个框架的社区和 Lift 的
创造者只有赞美之词。

P.S. Lift's documentation could be better organized, some stuff could be better explained for sure, but IMHO it was just too small a price I had to pay to enjoy such beautiful framework. Learning curve is steeper than with Play, especially in the beginning, but after I "survived" the very first week it was almost impossible for me to give up of all of its advantages and original concepts (Lift's "Seven Things") and switch to another framework.

# ios - 在后台线程中使用时修改 UIImageView？

> ID：11335638
> 
> 赞同：0
> 
> 时间：2012-07-04T21:30:43.863
> 
> 标签：ios, uiimageview

我有一个`UIImageView`我正在制作动画（使用`UIView`'s `commitAnimations`）并且我正在使用`NSObject`'s移动它以`performSelectorInBackground:`获得更好的性能。现在我的问题是，是否可以在`UIImageView`使用单独的线程移动时更改修改图像？一切似乎都运行良好，但我想问一下，因为我知道你应该在启动新线程时复制数据。

我正在使用`UIImageView`'s `setImage:`，它没有记录但有效。`UIImageView.image`使用财产会更好吗？提前致谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T21:47:33.540

Setting a property is equivalent to invoking its corresponding setter method. It's documented, you just haven't noticed it: having a (read-write) property named 'image' implicitly means having an

```
- (UIImage *)image; 
```

and a

```
- (void)setImage:(UIImage *)img; 
```

method.

* * *

You should always perform UI operations on the main thread. Even if it works now, it may break once.

# php - 用 PHP 备份 Linux 服务器？

> ID：11335642
> 
> 赞同：1
> 
> 时间：2012-07-04T21:31:07.353
> 
> 标签：php, backup, exec

我管理我的客户的 VPS。他想要一个备份解决方案，包括一些文件夹和 mysql 数据库。操作系统是 Ubuntu，网络服务器是 apache。我不想让我的客户搞乱 ssh 或 ftp。

我想我可以保存数据库备份文件并从 wab 页面触发 PHP 的 exec 功能到 zip 文件夹和数据库备份文件，然后提供下载此 zip 文件的链接。

这在技术上是可行的，但我想知道除了自动将备份文件复制到另一台服务器之外是否有更好的解决方案。因为在我的情况下需要随时创建备份。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T21:40:10.303

有很多可能性，这里有一个我们每天都在使用的非常简单的方法：

*   创建一个备份脚本（例如，在 bash 中），其中包含 mysqldump、tar 和 date 等常见嫌疑人
*   确保，此备份脚本锁定双重运行
*   创建一个每分钟运行的 cron 作业，检查标志文件是否存在，如果存在则启动备份脚本，然后清除标志文件
*   如果您愿意，可以创建更多的 cron 作业（例如每天一个），除了设置标志文件之外什么都不做
*   创建一个简单的 PHP 脚本，只需触及标志文件即可触发临时备份
*   清除标志文件后，您可以下载完成的备份包（再次通过简单的 PHP 脚本检查）

# google-apps-script - 从另一个“类”/文件调用函数

> ID：11335646
> 
> 赞同：18
> 
> 时间：2012-07-04T21:32:01.717
> 
> 标签：google-apps-script

好的，我为自己无法解决这个问题而感到尴尬，但是在浪费了几个小时之后，我认为在这里简单地问会更容易：

我的 Google Apps 脚本项目中有一堆 .gs 文件。现在，我想从一个方法中调用另一个文件的函数（类似于`AnotherClass.awesomeFunction()`，`ReferenceError`虽然会抛出一个）。这在 Google Apps 脚本中可行吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-07-05T02:37:19.183

文件不是类。您可以从任何其他文件调用任何文件中的任何函数。将您的文件想象成它们只是在运行之前添加到一起。如果您想要类范围界定，您可以使用库功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-08-11T18:15:32.337

上面的回复是正确的上面附加的文件，请确保应用脚本项目页面上文件资源管理器中的文件顺序正确

函数定义应该在第一个文件中，函数调用在后者中。

您可以通过单击文件名旁边的 3 个点并选择`Move file up`或更改每个文件的选项`Move file down`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T03:20:42.047

它可以做到。

Corey 是对的，文件不是类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-10T15:13:54.117

以下语法允许您从 Google Apps 脚本项目中调用任何函数，无论该函数是否定义在调用它的同一文件中：

```
myFunction(); 
```

以下代码是不必要的，会抛出错误：

```
google.script.run.myFunction(); 
```

# android - 运营商分配的公共 IP，但我在我的 Android 手机上看不到它

> ID：11335647
> 
> 赞同：-1
> 
> 时间：2012-07-04T21:32:02.933
> 
> 标签：android, ip-address, public, galaxy, samsung-mobile

承运人：加拿大的 Fido。手机：三星 Galaxy S2 操作系统：Android 4.0.3

Fido 有一项服务，他们可以分配公共 IP 地址并收取一定费用。我已经支付了费用，显然他们已经为我的手机分配了一个公共 IP 地址。在正常情况下，我应该能够在我的设备设置（状态信息）中看到 IP 地址。但它显示IP地址不可用。Fido 客服无法提供帮助，称他们只有 iPhone 的使用说明。对于任何其他电话，我应该联系制造商。

知道如何才能找到我通过鼻子支付的公共 IP 地址吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T22:24:54.163

在设备上，访问[http://www.whatsmyip.org/](http://www.whatsmyip.org/)。该网站会告诉您您在互联网上显示的 IP 地址。

# javascript - 选中复选框时显示/隐藏 div

> ID：11335649
> 
> 赞同：0
> 
> 时间：2012-07-04T21:32:12.477
> 
> 标签：javascript

我想在选中一个复选框时显示/隐藏一个 div。它目前适用于“全选”，但我无法让它与单个复选框一起使用。这是“全选”的代码：

**JS：**

```
<script language='JavaScript'> 
var checkboxcount = 1;

function doCheckOne() {
    if(checkboxcount == 0) {
        with (document.messageform) {
            for (var i=0; i < elements.length; i++) {
                if (elements[i].type == 'checkbox') {
                    elements[i].checked = false;
                document.getElementById('mail_delete_button').style.display = "none";
                }
            }
            checkboxcount = checkboxcount + 1;
        }
    } else
    with (document.messageform) {
        for (var i=0; i < elements.length; i++) {
            if (elements[i].type == 'checkbox') {
                elements[i].checked = true;
            document.getElementById('mail_delete_button').style.display = "block";
            }
        }
    checkboxcount = checkboxcount - 1;
    }
}
</script> 
```

**HTML：**

```
<a href="javascript:void(0);" onclick="doCheckAll();this.blur();">Select all</a>
<div id="mail_delete_button" style="display: none;"></div> 
```

我想在选中单个复选框时显示 div“mail_delete_button”，并在没有选中任何内容时隐藏它。注意：我的 html/input 字段采用“messageform”形式这是我的输入代码：

```
<input type='checkbox' name='delete_convos[]' value='{$pms[pm_loop].pmconvo_id}'> 
```

任何帮助将不胜感激！谢谢！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T21:36:16.820

像这样的东西？给复选框一个`id="chk"`

```
<input type='checkbox' name='delete_convos[]' value='{$pms[pm_loop].pmconvo_id}' id="chk">

document.getElementById("chk").onclick = function() {
    document.getElementById('mail_delete_button').style.display = this.checked ? "block" : "none";
}​ 
```

[**演示**](http://jsfiddle.net/GJG87/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-02-01T16:48:28.233

这可能对使用 jQuery 的人有所帮助。[您可以使用 jQuery 的toggle()](https://api.jquery.com/toggle/)方法根据选中的复选框显示和隐藏 div 块。以下示例中的 div 块默认使用 CSS`display`属性隐藏，该属性设置为`none`.

```
 $(document).ready(function(){
    $('input[type="checkbox"]').click(function(){
      var val = $(this).attr("value");
      $("." + val).toggle();
    });
  }); 
```

你可以在这里看到一个例子：[How to show/hide DIV if checkbox selected](https://stackhowto.com/how-to-show-hide-div-if-checkbox-selected/)

# google-app-engine - 如何处理具有两个“独特”属性的实体？

> ID：11335651
> 
> 赞同：3
> 
> 时间：2012-07-04T21:32:32.540
> 
> 标签：google-app-engine, google-cloud-datastore

考虑一个基于 Web 的系统，其中多个用户可能同时创建帐户。系统要求用户拥有唯一的用户名和唯一的电子邮件地址。在 RDBMS 中，这很简单：“email”字段将被标记为 UNIQUE。我怎么能以数据存储的方式处理这个？

这是我最初的尝试：

```
// Create entity using the username as key
String username = ... // provided by the user
String email = ...    // provided by the user
Entity entity = new Entity("Users", KeyFactory.createKey("User", username));
entity.setProperty("email", email);

// Create a query that matches the email property
Query q = new Query();
q.setFilter(new FilterPredicate("email", FilterOperator.EQUAL, email));

// Start a transaction
Transaction txn = datastore.beginTransaction();

try {
    // Try to get an entity with that username
    datastore.get(KeyFactory.createKey("User", username);
}
catch(EntityNotFoundException e) {
    // No entity with that username, make sure the e-mail
    // is not taken either
    PreparedQuery pq = datastore.prepare(q);
    if (pq.countEntities(FetchOptions.Builder.withLimit(1)) == 0) {
        // The e-mail isn't taken either, all good
        datastore.put(entity);
        txn.commit();

        ... handle success here ...

        return;
    }
}
finally {
    if (txn.isActive())
        txn.rollback();
}

... handle failure here ... 
```

但是经过一些简单的测试后，我注意到查询并不总是“看到”不久之前所做的“放置”（最终的一致性，我应该猜到了）。为了解决这个问题，我尝试将该查询转换为“虚拟”祖先查询。

所以这个“虚拟”祖先查询是这样工作的。我使用命名键创建了一个 RootUser 类型的实体。我从这个 root 用户那里获得了密钥，并在上面的代码中将其设为查询的祖先密钥。现在这也不起作用，我仍然收到重复的电子邮件地址。我还尝试配置事务，使其成为跨组事务，但这也无济于事。

那么，有关如何使其正常工作的任何提示？有可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T02:43:32.497

快速版本：您想使用另一个实体“种类”并将您的唯一值存储为此类对象的 id。例如。“用户名：我的用户名”、“用户名：email@example.com”。通过首先创建这些条目，您将知道值何时不是唯一的。

see this for an example implementation.. [http://webapp-improved.appspot.com/_modules/webapp2_extras/appengine/auth/models.html#Unique](http://webapp-improved.appspot.com/_modules/webapp2_extras/appengine/auth/models.html#Unique)

# reporting-services - 过滤 SSRS 中的嵌套数据区域

> ID：11335655
> 
> 赞同：3
> 
> 时间：2012-07-04T21:33:14.730
> 
> 标签：reporting-services, master-detail

我正在尝试创建一个报告，例如，它看起来像：

![在此处输入图像描述](../Images/d24d77df41f6472fd00d5b51baf798db.png)

我已经能够让它与子报表一起使用，但是这种方法有两个问题：

1.  子报表效率极低。他们为书籍、故事和文章中的每个子报表的每一行和每一列调用数据库。
2.  在 CRM 2011 中使用时，每个子报表只能有一个父报表，这样就无法重复使用子报表。我有同一份报告的横向和纵向版本（横向有额外的列），我想重用相同的子报告，但这似乎不受支持。

我的问题是我是否可以制作一个包含所有连接属性的大型数据集，然后在父表中嵌套一个表并使用过滤器仅在每个单元格中显示正确的数据。换句话说，父表将有作者姓名和电子邮件，然后将有 3 个子表，一个在书籍、故事和文章中。

我曾尝试将过滤器放入子表中，但我收到一条错误消息：
报告“/ReportName”的定义无效
Tablix“tablix3”有一个带有内部成员的详细成员。详细成员只能包含静态内部成员...

这对我来说毫无意义，因为“电子邮件”字段是内部成员，它不是静态的。有谁知道我应该如何更好地解决这个问题？只是为了抢占响应“更改报告的设计”，我不能。这就是用户希望查看数据的方式。我将接受保留此布局但更改底层实现的答案，但不接受“制作 3 个单独的报告”的答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T17:05:29.423

如果您的问题是 - 您能否将一张表嵌套在另一张表中并过滤嵌套表，答案是肯定的。我已经成功地做到了这一点。

如果您遇到问题，则一定是您的设计存在其他问题导致问题，或者我们的环境存在不同之处。您使用的是什么版本的 SSRS？你能更具体地了解你的布局吗？例如，您是使用表格、矩阵还是列表开始？您使用哪些步骤来插入嵌套项？你对最外面的项目有什么样的分组？子项？您是否尝试过仅使用一个嵌套项开始？

# python - python 正则表达式的回溯

> ID：11335656
> 
> 赞同：1
> 
> 时间：2012-07-04T21:33:26.453
> 
> 标签：python, regex

我正在尝试编写正则表达式匹配

我想匹配文件中的 c99，只要它不是十六进制颜色代码的一部分

*   不匹配 `#000c99`
*   做匹配`/mysite.com/c99.php`
*   做匹配`%20c99.php`
*   做匹配`c99?hi=moo`

这甚至可以使用正则表达式吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T22:09:16.627

使用[正则表达式模块](http://pypi.python.org/pypi/regex/)：

```
>>> rx = regex.compile(r"(?<!#\d{0,3})c99")
>>> rx.findall("#000c99")
[]
>>> rx.findall("/mysite.com/c99.php")
[u'c99']
>>> rx.findall("%20c99.php")
[u'c99']
>>> rx.findall("c99?hi=moo")
[u'c99'] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T21:46:54.760

最直接的方法是匹配行中带有“c99”的行，然后丢弃 c99 在颜色代码中的任何位置：

```
line = fileHandle.readline()
while (line) :
     if (re.search("c99", line)) :
          if (re.search("#.?.?.?c99", line)) :
               pass
          else :
               # line contains c99 not in a color code
     line = fileHandle.readline() 
```

可能有一种方法可以在单个正则表达式中完成，但这只是我想到的第一件事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T21:57:19.320

使用这个正则表达式`(^([^#].*?)?c99.*?$)`

# php - MongoDB：集合中的重复文档

> ID：11335665
> 
> 赞同：2
> 
> 时间：2012-07-04T21:35:14.273
> 
> 标签：php, mongodb

我是 mongodb 的新手，找不到解决方案。

我正在使用[mongo-php-driver](https://github.com/mongodb/mongo-php-driver)

我刚刚创建了一些集合。我想从 PHP 代码创建一些文档。

```
$collection->create(array(
    'asda'=>12312,
    'cxzcxz'=>'czczcxz'
)); 
```

当该代码起作用时，集合中有两条相同的记录，但_id不同。

```
{ "_id" : ObjectId("4ff4b3b8859183d41700000f"), "asda" : 12312, "cxzcxz" : "czczcxz" }
{ "_id" : ObjectId("4ff4b3b8859183d417000010"), "asda" : 12312, "cxzcxz" : "czczcxz" } 
```

如何修复它，以及我需要在此处更改哪些内容才能只有一个文档？

我在表中有 _id 索引。也许我每次都需要设置这个键？当我设置 _id 字段时，它在集合中保存了一条记录。但是如何让它自动（如自动增量）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T23:31:04.043

您可以插入多条具有相似信息的记录，因为您没有为这些值中的任何一个指定唯一索引。[默认唯一索引](http://www.mongodb.org/display/DOCS/Indexes#Indexes-The%5CidIndex)将打开`_id`。

[您可以使用MongoCollection.ensureIndex](http://php.net/manual/en/mongocollection.ensureindex.php)从 PHP 定义您自己的索引，例如：

```
// create a unique index on 'phonenum'
$collection->ensureIndex(array('phonenum' => 1), array("unique" => true)); 
```

还值得阅读有关[唯一索引](http://www.mongodb.org/display/DOCS/Indexes#Indexes-unique%3Atrue)的 MongoDB 文档，因为如果正在为可能已经有重复值或空值的现有集合创建唯一索引，则需要注意一些警告。

`_id`如果要使用更自然的主键，您还可以选择提供自己的值。但是，您必须确保这`_id`对于新插入是唯一的。

MongoDB 创建的默认[ObjectID](http://www.mongodb.org/display/DOCS/Object+IDs)被设计为在分配时具有相当高的唯一性。

代码示例：

```
<?php

// Connect to MongoDB server
$mongo = new Mongo();

// Use database 'mydb' and collection 'mycoll'
$collection = $mongo->mydb->mycoll;

// Drop this collection for TESTING PURPOSES ONLY
$collection->drop();

// The document details to insert
$document = array(
    'asda' => 12312,
    'cxzcxz' => 'czczcxz',
);

try {
    $collection->insert($document, array("safe" => true));

    // Note that $collection->insert() adds the _id of the document inserted
    echo "Saved with _id:", $document['_id'], "\n";
}
catch (MongoCursorException $e) {
    echo "Error: " . $e->getMessage()."\n";
}

// Add unique index for field 'asda'
$collection->ensureIndex(array('asda' => 1), array("unique" => true));

// Try to insert the same document again
$document = array(
    'asda' => 12312,
    'cxzcxz' => 'czczcxz',
);
try {
    $collection->insert($document, array("safe" => true));
    echo "Saved with _id:", $document['_id'], "\n";
}
catch (MongoCursorException $e) {
    echo "Error: " . $e->getMessage()."\n";
}

?> 
```

# jquery - jquery $.get 的问题

> ID：11335668
> 
> 赞同：0
> 
> 时间：2012-07-04T21:35:55.790
> 
> 标签：jquery

这不是我第一次使用`$.get`功能，但这次我不知道为什么它不起作用

```
function test(tid)
  {
    alert("1");
   var ttt;
   alert("2");
   var ddd;
    alert("3");

   $.get("demo_ajax_load.txt", function(result){
    alert("4");
     });
   } 
```

`demo_ajax_load.txt`只是一个文本文件内容是：`Welcome`

我收到警报 1、2、3，但没有显示第 4 条警报消息。一切看起来都很正常，这个简单的功能有什么问题？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T22:01:42.237

只要您不在本地对其进行测试，它就可能没有任何问题。

如果您使用的是**Google Chrome** *（我使用的是 20 版）*，请打开控制台（按`F12`），您会看到会收到错误消息：

> Access-Control-Allow-Origin 不允许 Origin null。

![在此处输入图像描述](../Images/4750d34e6e27bb524f2b6edcbc30da57.png)

在**Mozilla Firefox**中，你会得到

> [对象 XMLDocument]

但是如果您远程执行此操作（在您的主机中），一切都会正常工作......

您可以查看我的[**Live DEMO**](http://balexandre.com/Stackoverflow/11335668/)并打开控制台查看输出（如果您愿意）。

我的简单 jQuery：

```
$.when(
    $.get("a.txt")
  )
 .done(function(data) { 
    console.log("All done: " + data); 
    $(".txt-from-file").text(data); 
  })
 .fail(function(data) { 
    console.log("Error found: " + data.statusText); 
    $(".txt-from-file").text(data.statusText); 
  }); 
```

或者您总是可以简化更多并使用：

```
$.get("a.txt").then(
    function() { alert("succeeded"); },
    function() { alert("failed!"); }
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T22:53:27.453

好的，感谢您的帮助，我找到了解决方案，我应该使用 jQuery 而不是 $ ，它有效

# jquery - 如何避免使用 fancybox 版本 2 的安全内容的 IE 警告？

> ID：11335675
> 
> 赞同：0
> 
> 时间：2012-07-04T21:36:55.250
> 
> 标签：jquery, fancybox

我正在使用 Fancybox 版本 2.0.6 将隐藏的 div 加载到 fancybox 中，但在 IE 中我收到警告说只会显示安全内容。我看到有人在版本 1.3.4 中解决了这个问题，但版本 2 没有他们在补丁中替换的相同代码（我检查过）。
有人处理过这个吗？最新的fancybox版本中是否有其他解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T22:59:59.367

我决定尝试安装旧版本的fancybox，它有一个针对这个问题的补丁，但是在添加旧版本包含的javascript之前，我注释掉了新版本的脚本行并且警告仍然存在！

然后我注意到我已经按照[http://fancyapps.com/fancybox/#instructions](http://fancyapps.com/fancybox/#instructions)的说明包含了 jquery，并且没有在这一行中将 http 更改为 https：

```
<!-- Add jQuery library -->
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js"></script> 
```

所以答案是 Fancybox 版本 2.0.6 不会在 IE 中引发任何安全警告，但如果你盲目地按照说明进行操作，你会因为 jquery 行而收到该警告。:)

# orm - 使用 ORM 表示表时，具有非表特定功能是否明智？

> ID：11335677
> 
> 赞同：1
> 
> 时间：2012-07-04T21:37:26.763
> 
> 标签：orm, language-agnostic

例如（不是逐字）

```
/**
@Entity
*/
class Event
{
   /**
      @Column 
   */
   protected $time_start;
   /** .. */
   protected $time_end;

   /** getters, setters, etc */

   /** @return duration of event as a string, non-table function */
   public function getDuration() { ... }
} 
```

或者 ORM 应该只是表，仅此而已？

这可能是一种主观观点，因为每个人都有自己的观点，但在编程中，你会做和你真的不应该做的事情。我只是想知道这是否是其中一种情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T23:50:49.283

不，这不是一个好主意。如果不出意外，将违反[*单一责任原则*](http://en.wikipedia.org/wiki/Single_responsibility_principle)。

如果您正在制作 ORM，您的实例应该只处理数据存储/检索。在您的示例`getDuration()`中是域业务逻辑的一部分，应该驻留在[域对象](http://c2.com/cgi/wiki?DomainObject)中。

基本上，您在这里处理的是[数据映射器](http://martinfowler.com/eaaCatalog/dataMapper.html)和[活动记录](http://martinfowler.com/eaaCatalog/activeRecord.html)模式之间的区别。而且，如果您尝试编写符合 SOLID 原则的代码，人们会认为活动记录是一种反模式，从长远来看，这会导致彻底的[技术债务](http://martinfowler.com/bliki/TechnicalDebt.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T16:48:09.400

除非有一些特定于应用程序的原因不具备该功能，否则答案是肯定的。让我解释一下原因：

1.  在 OOP 中，对象不仅仅是一种数据结构。它将状态和行为联系在一起。这是 OOP 的基本原则。它有一个状态，它有修改状态的方法。什么是实体？它是一个对象，一个业务对象。业务对象包含业务数据和逻辑。因此，他们确实需要具有执行业务逻辑的方法。从业务对象中删除业务逻辑是违背 OOP 的本质的。因为，最终您将需要在某个地方实现该逻辑，但这不是正确的地方。该代码将需要以某种方式访问​​业务对象的状态，这在大多数情况下会破坏信息隐藏（封装）的原则，这也是我们首先拥有 OOP 的原因之一。

2.  现在，关于 ORM！在这里，您需要满足两个需求，面向对象设计和 ORM。现在询问哪个优先于另一个，或者，哪个优先。您是否首先考虑 ORM（或任何其他存储方式）然后设计您的类？或者你设计你的类，然后将它们映射/存储？第一种方法是正确的方法。你设计你的应用程序，然后让 ORM 遵循这个设计。

3.  非访问器方法会阻止您使用 ORM。不。这些方法不会阻止您在对象上使用 ORM。ORM框架的设计者在设计的时候就知道这个原理。

# objective-c - 制作一种方法，以便能够通过触摸屏幕的侧面来横向移动 PapiJump 中的球

> ID：11335678
> 
> 赞同：0
> 
> 时间：2012-07-04T21:37:44.057
> 
> 标签：objective-c, ios, xcode, ios5, touch

我是游戏新手，所以这可能是一个愚蠢的问题，但是我正在处理的这段代码遇到了很多麻烦。当您按下屏幕的右侧时，我试图让球向右移动，左侧反之亦然，但到目前为止，当我触摸屏幕时它会崩溃:-(

有什么建议么？非常感谢！

```
-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
    UITouch *touch = [touches anyObject];
    CGPoint location = [touch locationInView:touch.view];

if (gameState == kStateRunning && controlType == kTouch) {
    if (location.x < (self.view.bounds.size.width/2)) {
        touchState = kLeftDown;
        ballVelocity.x -= 0.2;
    }
    else {
        touchState = kRightDown;
        ballVelocity.x += 0.2;
    }
}

if (gameState == kStateGameOver) {
    if (location.x < (self.view.bounds.size.width/2)) {
        gameState = kStateMenu;
    }
    else {
        gameState = kStateRunning;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T22:28:17.040

我可以看到没有明显的错误（假设您已经定义了所有常量等）

被它咬了几次之后，我现在检查奇怪的崩溃的第一件事是 viewController 所有者上是否有任何损坏的 IBOutlet 或 IBAction 链接（由那些橙色警报三角形表示）。

我想我会注释掉该函数中的所有内容，看看它是否仍然崩溃。然后是 NSLog 语句等 - 标准调试。

# svn - 在 SVN 中基于没有主干目录的项目创建新分支的最佳实践是什么？

> ID：11335680
> 
> 赞同：2
> 
> 时间：2012-07-04T21:38:05.733
> 
> 标签：svn, branch, trunk

我刚跳进一个项目，项目是用SVN维护的。但是它没有主干目录，现在我想对项目做一些实验，但我不想干扰其他人的工作，然后我想我应该做一个分支，但我不能重组项目一个新的主干，那么基于没有主干目录的项目创建一个新分支的最佳实践是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T21:41:36.913

主干只是一个常规名称。如果所有内容都至少包含在一个目录中（而不是直接在根目录中），您可以创建该目录的一个分支。如果所有内容都直接位于根目录下，请与您的同事交谈并决定与他们一起遵循最佳实践：将所有内容移动到主干目录下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T21:40:17.507

您可以创建一个主干目录并使用 SVN relocate 命令将树移动到其中。

或者，您可以只创建一个标签/分支目录并使用它们，它很乱但没有一些重组，那么它总是会很乱:(

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T21:40:38.320

在项目的父级别创建一个分支文件夹并分支到它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-04T21:46:40.860

让我们使用**分布式版本控制系统**（如[Baazar](http://bazaar.canonical.com/en/)，但 Git 或 Mercurial 也一样）。

使用 BZR，您可以**从 SVN 创建一个分支**，并将该分支推送到您想要的位置：本地在您的 HDD、网络、http/ftp 服务器等上......
您可以与 SVN 同步，并将您的分支放在哪里你想要，甚至快速将它推回SVN。不干扰其他人存储库。

您可以使用此类分发工具的所有新功能（3 路合并、本地提交、更快的速度）。
我会推荐**Bazaar**，因为它非常接近 SVN。

# javascript - How do I remove scripts for responsive mobile

> ID：11335684
> 
> 赞同：0
> 
> 时间：2012-07-04T21:38:28.533
> 
> 标签：javascript, jquery, wordpress, html, responsive-design

I have a plugin.js that combine all my plugins for my responsive build. This plugin.js is unnecessarily bulky for mobile. I would like to create 2 plugin.js to switch between for mobile or desktop.

> What is the best practice for reducing overhead for mobile scripting?

Examples: I have a complicated jQuery slider for desktop viewing but I would like that script not to load for mobile.

For this project i'll be using: HTML5, Wordpress, jQuery, Modernizr.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T21:43:31.233

It depends what you define as mobile. If it's all devices below a certain width, you can test for that, and then prevent the script running with an if statement.

```
$(function(){
    var mobile;
    if (window.width < 481) {
        mobile = 1; 
    }

    if (!mobile) {
    // All your stuff.
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T02:04:20.653

我不建议使用 JavaScript 来检查设备。您在服务器端使用什么？我已经成功地使用了免费的 PHP 移动检测类。它也可以检测移动平板电脑或特定制造商，例如。平板电脑。它也超级容易使用。然后，您可以根据该页面生成页面或重定向到特殊格式的移动网站。使用 javascript 非常不可靠，有些人可能会在浏览器中将其关闭，这不太可能，但它确实发生了。如果您在服务器上执行此操作，则不必担心类似的事情。

# django - django admin list display of foreign key

> ID：11335685
> 
> 赞同：0
> 
> 时间：2012-07-04T21:38:36.420
> 
> 标签：django, django-models, django-admin

Various other posts on stack have looked at how to "properly" include a foreignkey in list_display, which enables sorting, etc.

However, I am not interested in that. I just want to display the unicode of the foreignkey field.

From the django docs:

```
A few special cases to note about list_display:

If the field is a ForeignKey, Django will display the __unicode__() of the related object. 
```

I had this working previously, but since I last checked the django admin, it is no longer displaying any entries at all if the list_display includes a foreignkey field. Once the foreignkey field is removed from list_display, the entries are once again displaying.

I obviously updated something minor that caused this. Any ideas?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T23:10:18.040

发现这可能是由于数据库问题将外键信息存储为空字符串。

由于我仍在开发中，我只是放弃了桌子。但是，我欢迎讨论和回答如何在不放弃表格的情况下解决这个问题。

[Django admin List Display + ForeignKey = Empty Change List](https://stackoverflow.com/questions/8941857/django-admin-list-display-foreignkey-empty-change-list?lq=1)

# android - Creating a custom SMS/MMS app in Android - using Eclipse and GitHub - why so many unresolveds?

> ID：11335686
> 
> 赞同：1
> 
> 时间：2012-07-04T21:38:43.340
> 
> 标签：android, git, sms, mms

Okay, here's where I'm at. I used Eclipse to import the code for the SMS/MMS app that is on Android devices. The code on GitHub is at [https://github.com/android/platform_packages_apps_mms.git](https://github.com/android/platform_packages_apps_mms.git). I used the Import -> Git in Eclipse. Got the code into the environment. Had to manually paste the AndroidManifest.xml file into the project, and also copy over source and resource directories.

Basically, I want to get the Eclipse project to a point where I can run it on my device and it behaves JUST like the built-in app. THEN, I can modify it for my specific needs hopefully. I don't want to have to write all the SMS/MMS functionality from scratch if I can avoid it.

NOW, the problem is: A LOT of unresolveds. I keep reading various places where people are saying that some of the packages aren't REALLY in the SDK and are internal... Why the heck call it an "open source platform" when the source isn't available for the built-in apps that Google provides?! (If this is in fact the case). Further, why would they provide the code on GitHub for the MMS app if in fact not all the code is available and you can't compile it? Seems a little ridiculous to me.

I have read some answers to previous posts where I was just sticking my "toes into the water" so to speak, and people are saying that a lot of these packages are part of the firmware? Seems like there should be some base code for a texting/mms app out there somewhere.

Anyone know of any? (Open source, free, SMS/MMS Android code that I can easily obtain and that don't suck, if in fact I can't use Google's code?)

Thanks,

John

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T21:50:55.067

**Mms**以及其他系统应用程序使用 SDK 无法使用的私有或隐藏 API。

正如您所提到的，这与不是一个开源平台无关，而是因为您试图以一种不受支持的方式构建应用程序，而且没有人说它是。

如果您想修改和构建**Mms**，请将其作为固件构建的一部分，使用`make`，而不是在 Eclipse 中导入要由 SDK 构建的项目。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-07-04T21:50:35.067

库存 MMS 应用程序内置于设备的原始固件中，使用私钥签名，并且能够使用一些私有 API。第三方应用程序由于各种原因不能使用私有 API，其中之一是安全性。如果您想查看它，所有源代码都是开放的。

您绝对可以构建自己的固件或 ROM，正如某些人所说的那样，并在其上运行您自己修改过的 MMS 应用程序。

我不知道您是否可以制作和安装自己的彩信应用程序。您可以通过在 Play 商店中查找类似应用程序或查看 Android 开发人员文档来了解为第三方应用程序提供了哪些权限和 API。

# antlr - ANTLR 用于可选键值

> ID：11335689
> 
> 赞同：2
> 
> 时间：2012-07-04T21:39:00.813
> 
> 标签：antlr, grammar, lexer

这是我试图制作的 AST：

```
{{ name }}
{{ name | option }}
{{ name | option1 | option2 }}
{{ name | key=value }}
{{ name | option1 | key=value }}
{{ name | option1 | {{ another }} | option3 }} 
```

所以在实践中总是有一个名称（a..zA..Z0..9），选项有时采用键值格式，有时采用简单且没有值的格式。

我正在尝试通过 ANTLR 为它编写一个词法分析器/解析器语法，但它一直在唠叨不同的东西。这是我最好的镜头：

```
start   :   box+;
box :   '{{' Name  ('|'  Options )* '}}';
Options :   (SimpleOption | KeyValue | box);
Name    :   ID;
SimpleOption:   ID;
KeyValue:       ID '=' ID;
fragment
 ID  :  ('a'..'z'|'A'..'Z'|'_') ('a'..'z'|'A'..'Z'|'0'..'9'|'_')* ;
WS  :   ( ' ' | '\t' | '\r' | '\n'  {$channel=HIDDEN;}  ; 
```

这显然是错误的，因为 Name 和 SimpleOption 是模棱两可的。即使是内联规则也没有用：

```
box :   '{{' Name  ('|'  (ID | KeyValue | box) )* '}}'; 
```

因为它从不拾取 KeyValue 并在遇到 '=' 时给出不匹配异常。

你会怎么写这个语法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-05T17:37:06.913

您使用了太多的词法分析器规则。该规则`KeyValue`只会匹配符号`ID '=' ID`周围没有空格`=`：它应该是解析器规则（以小写字母开头）。只有当它是解析器规则时，它才能在 周围有空格`=`，然后将被丢弃。

确保您了解词法分析器和解析器规则之间的区别！请参阅： [ANTLR 中解析器规则和词法分析器规则之间的实际区别？](https://stackoverflow.com/questions/4297770/practical-difference-between-parser-rules-and-lexer-rules-in-antlr)

这应该这样做：

```
grammar T;

start     : box+ EOF;
box       : '{{' ID ('|' opts)* '}}';
opts      : key_value | ID | box; // note that 'options' is a reserved word in ANTLR!
key_value : ID '=' ID;
ID        : ('a'..'z' | 'A'..'Z' | '_') ('a'..'z' | 'A'..'Z' | '0'..'9' | '_')*;
WS        : (' ' | '\t' | '\r' | '\n') {skip();}; 
```

这将解析输入

```
{{ name | option1 = value1 | {{ another | k=v }} | option3 }} 
```

如下：

![在此处输入图像描述](../Images/48ce3cdd8c5bc9eac7e5b460f8f41c00.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T21:49:48.253

这对你有用吗：

```
Options :   (SimpleOptionOrKeyValue | box);
SimpleOptionOrKeyValue:   ID ( '=' ID | ); 
```

这消除了对`=`标志的前瞻需求。（编辑为反转括号内的出现顺序，不确定 ANTLR 如何处理此问题。）

然后可以在语义级别上进行简单选项和键值之间的区别。

也许相关：[ANTLR How to use lexer rules have the same start?](https://stackoverflow.com/q/10029137/946850)

# java - Java 通用通配符：如果需要？扩展了 T，T 有什么问题？

> ID：11335691
> 
> 赞同：1
> 
> 时间：2012-07-04T21:39:32.173
> 
> 标签：java, generics

```
 protected List<? extends ErrorTO> errors = new ArrayList<ErrorTO>();

    public abstract Collection<? extends ErrorTO> getErrors();

    public void registerError(ErrorTO e) {
        errors.add(e);
    } 
```

“errors.add(e)”行有一个编译错误，它期待某种类型的“？扩展 ErrorTO”并且不喜欢 ErrorTO？为什么要解决这个问题？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T21:44:50.697

编译器不知道`getErrors`会返回一个`Collection<ErrorTo>`; 它可能会返回一个`Collection<SomeSubclassOfErrorTo>`. 如果您随后尝试将`ErrorTo`不属于此子类的对象添加到集合中，则会违反类型安全性。出于这个原因，编译器不会让你这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T21:45:45.770

您不能向`List<? extends ErrorTO>`. 使它成为一个`List<ErrorTO>`.

`List<? extends ErrorTO>`表示：一些未知类的列表，即 ErrorTO 或扩展 ErrorTO。所以很明显，如果你可以给它添加一些东西，它的类型安全就会被破坏。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-04T21:47:31.667

`List<? extends ErrorTO>`不是一个可以包含任何扩展的*列表*`ErrorTO`。

它是一个（未指定）子类的列表`ErrorTO`。

如果`MyErrorTO`extends `ErrorTO`，那么我可以创建一个`List<MyErrorTO>`并将其分配给`errors`.

然后，您的代码将尝试将一个添加`ErrorTO`到我的列表中，这是非法的 - 我的列表只能包含一个特定的子类`ErrorTO`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-04T22:36:54.777

也许这会有所帮助。假设我们有课

```
class Fruit {}
class Pear extends Fruit{ void methodA(){} }
class Apple extends Fruit{ void methodB(){} } 
```

我们想创建这样的方法

```
public static void method(List<? extends Fruit> list, Fruit f) {
    list.add(f); //<-- why is this forbidden?
} 
```

作为`list`参数，此方法可以接受类似的列表

```
ArrayList<Fruit>
ArrayList<Apple>
ArrayList<Pear> 
```

如果参数是，`new ArrayList<Pear>();`那么编译器不应该允许添加像 Fruit 或 Apple 这样的元素。

但是编译器不知道他将处理什么样的列表。由于缺乏知识，不可能通过`List<? extends Fruit> list`参考添加任何元素。

# xslt - xslt change class for every third div

> ID：11335693
> 
> 赞同：2
> 
> 时间：2012-07-04T21:39:35.047
> 
> 标签：xslt

I have a question about Xslt mod. I need to change the div class of every 3rd div from "clmn-3 doublespace" to "clmn-3". Tried several tips but could not understand where to add the argument.

```
 <div class="clmn-9 products">
    <h1>Title</h1>
    <xsl:if test="$mode = 'edit'">
    <xsl:text disable-output-escaping="yes"><![CDATA[<div class="webtop">]]></xsl:text>
    </xsl:if>
    <xsl:call-template name="ndSitePageList">
    <xsl:with-param name="sPgLstID" select="1" />
    <xsl:with-param name="customTemplate">
    <xsl:for-each select="/ndTemplate/ndSitePageLists/ndList[instanceID=1]/ndSitePage">
    <xsl:call-template name="ndReplaceListSitePageElements">
    <xsl:with-param name="template">
    <xsl:text disable-output-escaping="yes">
    <![CDATA[
    <div class="clmn-3 doublespace"> 
    <a href="]]></xsl:text><xsl:value-of select="link"/><xsl:text disable-output-escaping="no">  <![CDATA["><img src="]]></xsl:text><xsl:value-of select="/ndTemplate/ndSpgPath"/><xsl:value-of select="srcThumb"/><xsl:text disable-output-escaping="no"><![CDATA["alt="" /></a>
    <div class="clmn-3 shadow"></div>
    <h2>]]></xsl:text><xsl:value-of select="title"/><xsl:text disable-output-escaping="no"><![CDATA[</h2>
    <span class="text">]]></xsl:text><xsl:value-of select="description"/><xsl:text disable-output-escaping="no"><![CDATA[</span>
    </div>
    ]]>
    </xsl:text>
    </xsl:with-param>
    </xsl:call-template>
    </xsl:for-each>
    </xsl:with-param>
    </xsl:call-template>
    </div> 
```

Thank you in advance Alex

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T03:17:06.850

**I. 下面是如何在 XSLT 1.0 中指定此类处理的示例：**

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:param name="pNewValue" select="'someNewAttribValue'"/>

 <xsl:template match="node()|@*">
     <xsl:copy>
       <xsl:apply-templates select="node()|@*"/>
     </xsl:copy>
 </xsl:template>

 <xsl:template match="num[position() mod 3 = 1]">
  <xsl:copy>
    <xsl:apply-templates select="@*"/>
    <xsl:attribute name="class"><xsl:value-of select="$pNewValue"/></xsl:attribute>
    <xsl:apply-templates select="node()"/>
  </xsl:copy>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于以下 XML 文档**时（问题中未提供任何内容！）：

```
<nums>
  <num>01</num>
  <num>02</num>
  <num>03</num>
  <num>04</num>
  <num>05</num>
  <num>06</num>
  <num>07</num>
  <num>08</num>
  <num>09</num>
  <num>10</num>
</nums> 
```

**产生了想要的正确结果（每三个`num`元素都有一个`class`属性，其值在外部参数中指定）**：

```
<nums>
   <num class="someNewAttribValue">01</num>
   <num>02</num>
   <num>03</num>
   <num class="someNewAttribValue">04</num>
   <num>05</num>
   <num>06</num>
   <num class="someNewAttribValue">07</num>
   <num>08</num>
   <num>09</num>
   <num class="someNewAttribValue">10</num>
</nums> 
```

* * *

**二、XSLT 2.0 解决方案**：

```
<xsl:stylesheet version="2.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output omit-xml-declaration="yes" indent="yes"/>
    <xsl:strip-space elements="*"/>

 <xsl:param name="pNewValue" select="'someNewAttribValue'"/>

 <xsl:template match="/*">
     <nums>
       <xsl:for-each-group select="*" group-adjacent="position() mod 3 eq 1">
         <xsl:sequence select="current-group()[not(current-grouping-key())]"/>
         <xsl:apply-templates select="current-group()[current-grouping-key()]"/>
       </xsl:for-each-group>
     </nums>
 </xsl:template>

 <xsl:template match="num">
  <num class="{$pNewValue}"/>
 </xsl:template>
</xsl:stylesheet> 
```

**当这个 XSLT 2.0 转换应用于同一个 XML 文档（上图）时，会产生同样想要的正确结果**：

```
<nums>
   <num class="someNewAttribValue"/>
   <num>02</num>
   <num>03</num>
   <num class="someNewAttribValue"/>
   <num>05</num>
   <num>06</num>
   <num class="someNewAttribValue"/>
   <num>08</num>
   <num>09</num>
   <num class="someNewAttribValue"/>
</nums> 
```

# ipa - issue when creating IPA file

> ID：11335694
> 
> 赞同：1
> 
> 时间：2012-07-04T21:39:35.270
> 
> 标签：ipa, trigger.io

I'm seeing this error:

```
[  ERROR] Something went wrong that we didn't expect:
[  ERROR] Failed when running /usr/bin/codesign: iPhone Developer: no identity found

[  ERROR] See /Users/yuanfengfeng/Desktop/Chrome_Download/test/forge-error.log for more details
[  ERROR] Please contact support@trigger.io 
```

Please give me some clues on how to resolve this issue?

Thanks.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T02:29:10.387

看起来您的钥匙串中没有 iPhone 开发者证书，或者试图使用“forge package”命令错误地引用它。

将您正在运行的确切命令和 forge-error.log 文件发送到 support@trigger.io，我们将帮助您解决它。

我们在 iOS 和 Android 上发布的文档在这里：[https ://trigger.io/docs/current/recipes/release/release_mobile.html](https://trigger.io/docs/current/recipes/release/release_mobile.html)

# ruby-on-rails - 如何在 Rails 中使用 API 返回嵌套注释

> ID：11335704
> 
> 赞同：1
> 
> 时间：2012-07-04T21:41:01.420
> 
> 标签：ruby-on-rails, ruby-on-rails-3, json, api

每辆车都有关联**_**`has_many :comments`

我有以下方法来还车：

```
 class Api::V1::CarsController < Api::V1::BaseController
  def recent
      recent = Car.most_recent(params[:how_recent])
      comments = recent.each{|r| r.comments} ## ??
      respond_with(:recent => recent)
    end
  end 
```

我通过以下方式获得最近的汽车：

```
curl -X GET http://cars.dev/api/v1/cars/recent -d "token=zzxWkB3SzDP3U1wDsJbY" -d "how_recent=20" 
```

我想得到这样的回应：

```
"recent_with_comments":{"recent":[{"type":"ferrari","price":null,"user_id":78,"username":null,"comments":[{"id":1, "comment": "some text"},{"id":2, "comment": "some text 2"}]}] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T22:51:08.460

当呈现为 json 时，您可以传递一些额外的参数，如[http://jonathanjulian.com/2010/04/rails-to_json-or-as_json/](http://jonathanjulian.com/2010/04/rails-to_json-or-as_json/)

基本示例：

```
class Api::V1::CarsController < Api::V1::BaseController
  def recent
    recent = Car.most_recent(params[:how_recent])
    comments = recent.each{|r| r.comments} ## ??
    respond_to do |format|
      format.html
      format.json { render recent.as_json(:include => :comments) }
    end
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T22:50:26.013

```
comments = Comment.join(:car).merge(Car.most_recent(params[:how_recent])) 
```

如果你想要自定义 json 输出使用[rabl](https://github.com/nesquena/rabl) gem

# magento - Magento Admin 404 after sessions expire

> ID：11335712
> 
> 赞同：1
> 
> 时间：2012-07-04T21:42:17.270
> 
> 标签：magento

We have just moved our joomla/magento site to a new server. We are now getting some intermittant 404 errors for the magento admin panel

We are able to use the Magento Admin periodically. After a couple of hours we will start getting a 404 after logging in. Once we manually clear the magento cache it starts to work again.

When we start getting the 404 the issue appears to be related to the URL.

Our setup is:

1.  Joomla is in the root directory.
2.  Magento (1.5.0.1) is in a sub-directory /magento

When the Admin panel (www.oursite.com.au/magento/_admin) is working the url after login is

*   [https://www.oursite.com.au/magneto/index.php/_admin/](https://www.oursite.com.au/magneto/index.php/_admin/)..........

When the 404 starts occuring the url drops the 'magento' out of the url and becomes

*   [https://www.oursite.com.au/index.php/_admin/](https://www.oursite.com.au/index.php/_admin/)............

After manually cleaning the magneto cache the issue is resolved. After a few hours it starts to occur again.

Any help would be appreciated.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T13:42:49.890

好吧，我找到了解决我们一直遇到的问题的方法。

在某些地方，magento/var/cache 目录的权限不正确。显然，如果 magento 无法写入此目录，它就会开始写入全局 /tmp 目录。

magento 论坛上的这篇文章有信息和解决方案：

[http://www.magentocommerce.com/boards/v/viewthread/282544/#t391174](http://www.magentocommerce.com/boards/v/viewthread/282544/#t391174)

希望它可以帮助某人。

# javascript - Timer fired ad nauseam (native v8natives.js:1582)

> ID：11335714
> 
> 赞同：1
> 
> 时间：2012-07-04T21:42:57.113
> 
> 标签：javascript, wordpress, performance

I have a website that loads very slow. Today I have done a test with the Timeline included in the Chrome Tools for Developers and I have seen that during about 9 seconds there is a Timer firing in a JS called v8natives.js. I have checked my Wordpress plugins and none of them are loading this library. I don't know why this library is loading and what it is used for. Anyone knows something about this JS?

I have tried also deleting some Javascript calls, deactivate plugins... But nothing happens.

The website is [http://www.laparabolica.es](http://www.laparabolica.es)

Thanks!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T22:19:46.923

基于这些结果：

[http://www.webpagetest.org/result/120704_SN_10Z5/1/details/](http://www.webpagetest.org/result/120704_SN_10Z5/1/details/)

Web 服务器似乎需要很长时间（在本例中为 11.388 秒）才能响应。（参见第一个字节的时间）。我在这个等式中看不到 v8natives.js（很确定这与 Chrome 的 Javascript 引擎有关）。

由于接收网站的第一个字节需要 11.388 秒，因此不可能有任何 javascript 减慢速度......

# wordpress - Wordpress and openx htaccess confusion

> ID：11335715
> 
> 赞同：0
> 
> 时间：2012-07-04T21:43:21.773
> 
> 标签：wordpress, apache, .htaccess, mod-rewrite, rewrite

I have a Wordpress install in the root: domain.com

and I installed OpenX in a sub-directory, I installed it without any problem, and I can access the admin panel and everything without any problem, but when I try to access the following URL's

`https://domain.com/ads/www/admin/plugins/videoReport/players.php`, I get Wordpress 404

When I try to access only the directory `https://domain.com/ads/www/admin/plugins/videoReport` I can see the php files, and folders listed.

I added in Wordpress htaccess:

```
RewriteCond %{REQUEST_URI} !^/(ads|ads/.*)$ 
```

but without any success

EDIT: I added the following htaccess file in ads directory:

```
RewriteEngine Off 
```

didn't worked

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T00:01:16.517

解决了！

Openx 安装的插件具有以下权限：文件夹 -> 777 文件 -> 777

我通过 FTP 将所有目录更改为 755，将所有文件更改为 644，插件正常工作，这不是 htaccess 问题

# php - curl_multi_exec in php

> ID：11335721
> 
> 赞同：2
> 
> 时间：2012-07-04T21:43:58.537
> 
> 标签：php, curl

Experience with the php curl_multi_exec($m,$active) function, seems to confirm that the $active will always go down by one between calls, even if two websites are finished. But is it guaranteed, when using this function, that if you do some really long code in between two calls, that the $active will always drop by one from its last value?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T00:32:45.970

[PHP 文档](http://php.net/curl_multi_exec)和[底层](https://github.com/php/php-src/blob/master/ext/curl/multi.c#L229)cURL 函数的[文档](http://curl.haxx.se/libcurl/c/curl_multi_perform.html)都没有说明在调用之间仅减 1，因此这可能只是巧合，您当然不应该依赖它，因为它可能随时更改。`curl_multi_perform()``$active`

# pyside - Pyinstaller：ImportError：无法导入名称 QtGui

> ID：11335722
> 
> 赞同：4
> 
> 时间：2012-07-04T21:44:03.057
> 
> 标签：pyside, pyinstaller

在 Windows 7 上使用最新的[pyinstaller](http://www.pyinstaller.org/)制作独立的 exe (-F)，运行 exe 时：

> ImportError：无法导入名称 QtGui

在 pyinstaller hooks 目录中，PyQt4 有特殊处理，但 PySide 没有。

希望对此有解决方法或尝试一些方法。

**环境**
Windows 7 64 位
Python 2.7 32 位
PYTHONHOME=c:\python27
PYTHONPATH=c:\python27\lib
PYTHONLIB=c:\python27\libs\python27.lib;c:\python27\lib\site-packages

**步骤1\. 从**[http://releases.qt-project.org/pyside/1.1.1/PySide-1.1.1qt474.win32-py2.7.exe](http://releases.qt-project.org/pyside/1.1.1/PySide-1.1.1qt474.win32-py2.7.exe)
添加 PySide 2\. 解压[https://github.com/pyinstaller/ pyinstaller/zipball/develop](https://github.com/pyinstaller/pyinstaller/zipball/develop)到 c:\pyinstaller1.5.1 3\. 对包含以下内容的 .py 文件运行以下命令：

```
from PySide import QtGui 
```

[...或 QtCore 或或。]

**跑**

```
c:\pyinstaller1.5.1>pyinstaller.py -F import_test.py
108 INFO: wrote c:\pyinstaller1.5.1\import_test.spec
171 INFO: Testing for ability to set icons, version resources...
296 INFO: ... resource update available
312 INFO: UPX is not available.
4321 INFO: checking Analysis
4382 INFO: checking PYZ
4430 INFO: checking PKG
4446 INFO: building because c:\pyinstaller1.5.1\build\pyi.win32\import_test\import_test.exe.manifest changed
4446 INFO: building PKG out00-PKG.pkg
16782 INFO: checking EXE
16782 INFO: rebuilding out00-EXE.toc because pkg is more recent
16782 INFO: building EXE from out00-EXE.toc
16799 INFO: Appending archive to EXE c:\pyinstaller1.5.1\dist\import_test.exe

c:\pyinstaller1.5.1>dist\import_test.exe
Traceback (most recent call last):
  File "<string>", line 23, in <module>
ImportError: cannot import name QtGui 
```

**笔记**

```
在 PySide 安装结束时（以管理员身份），此消息：
    在文件对象析构函数中关闭失败：
    sys.excepthook 丢失
    丢失 sys.stderr
如果这是关于安装后的，可以手动处理：
    c:>python.exe c:\Python27\Scripts\pyside_postinstall.py -install
    正在生成文件 C:\python27\qt.conf...
    PySide 安装在 c:/python27/Lib/site-packages/PySide...
    PySide 扩展已成功安装。

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-09T16:08:07.280

解决方法。这有效：

```
# Various imports, whatever, using normal sys.path, for example:
import os, sys, re, time, random
import subprocess, psutil

# Save sys.path
sys_path_saved = sys.path

# Limit sys.path for PySide import
sys.path = ['c:\\python27\\lib\\site-packages']

# PySide imports with limited sys.path
from PySide        import QtGui, QtCore
from PySide.QtGui  import QApplication, QLineEdit
from PySide.QtCore import QSettings, Qt

# Reset sys.path to original
sys.path = sys_path_saved

# Remainder of code... 
```

* * *

Pyinstaller 1.5.1 应该可以很好地定位依赖项，而且经常这样做。但是，在 .spec 中使用其 pathex 或 hiddenimports 的许多尝试都失败了。修改我的环境变量也失败了。从 .egg 中手动提取各种模块文件有时会奏效。

但是对于 PySide 导入，上面的 sys.path 临时限制是有效的解决方法。

更新：不幸的是，该 exe 仅适用于安装了 Python/Pyside 的机器，不适用于没有 Python 的 XP。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-06-08T08:50:57.167

对我来说，直接起作用的是将两个文件夹复制/粘贴到`PySide6`我`shiboken6`的 python 安装文件夹（PYTHON_FOLDER/Lib/site-packages）到 dist/APP_NAME 文件夹中`pyinstaller SCRIPT_NAME`。

# c++ - insert_iterator 失效规则

> ID：11335723
> 
> 赞同：0
> 
> 时间：2012-07-04T21:44:15.470
> 
> 标签：c++, iterator, insert-iterator

对 STL 容器的哪些操作会使`std::insert_iterator`引用该容器的 C++ 无效？`insert_iterator`如果它的底层迭代器（受保护`iter`的成员）符合通常的[迭代器无效规则](https://stackoverflow.com/q/6438086/985943)，那么它是有效的吗？

相关：[std::insert_iterator 和 iterator invalidation](https://stackoverflow.com/q/9154408/985943)给出了一个无效`insert_iterator`但没有阐明规则的例子。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T22:13:18.967

> 当其底层迭代器（受保护的成员 iter）是时， insert_iterator 是否有效，

你是对的，这就是受保护成员在规范中列出的原因，并且在`insert_iterator`（特别是`operator=`，因为其余部分是无操作的）上工作的函数是根据访问的函数定义的`iter`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T22:38:40.233

嗯，答案取决于你具体问的是什么。

（为了解决这个问题，我想立即指出您的“相关”链接完全不相关。该链接上的代码问题与失效完全无关。该问题`insert_iterator`的作者误解了这个问题最后试图解决一个不存在的问题，而真正的问题仍然存在。我也为这个问题提供了一个额外的答案。）

如果你`insert_iterator ins`从一个有效的迭代器创建一个`container::iterator it`，然后独立地对容器做一些会使无效的事情`it`，那么`ins`也会被无效。这是很自然的事情。如果您独立进行，`ins`则无法知道容器发生了什么事。

但同时在`insert_iterator`用于插入时具有自修复特性。例如，如果您使用`insert_iterator ins`将数据插入到 a`vector`中，`ins`即使向量经过重新分配也仍然有效。即，即使向量重新分配是一个大规模的迭代器无效事件，它也不会损坏`ins`（当然，假设重新分配是由通过 执行的插入触发的`ins`）。

这遵循标准插入算法

```
it = container->insert(it, value);
++it; 
```

存储在其中`it`的底层插入点迭代器在哪里`insert_iterator`。前插入和后插入迭代器也具有相同的“自愈”属性。可能无效的内部迭代器会立即重新验证。

为了说明差异，考虑这个简单的例子

```
std::vector<int> v(10);
std::vector<int>::iterator it = v.begin() + 5;

for (unsigned n = 20; n > 0; --n)
  v.insert(it, rand()); 
```

此代码通常无效，因为容器很可能会在插入周期中重新分配，从而使`it`所有进一步的插入无效并导致无效。

同时这段代码

```
std::vector<int> v(10);
std::vector<int>::iterator it = v.begin() + 5;
std::insert_iterator<std::vector<int> > it_ins(v, it);

for (unsigned n = 20; n > 0; --n)
  *it_ins++ = rand(); 
```

无论向量是否重新分配，都保证可以正常工作。

# java - 通过 JavaScript 调用小程序方法不起作用

> ID：11335729
> 
> 赞同：2
> 
> 时间：2012-07-04T21:44:57.803
> 
> 标签：java, javascript, applet, internet-explorer-9

我正在通过 JavaScript 调用 Java 小程序的方法，使用以下命令：

```
document.myApplet.myMethod(); 
```

但是，这仅在我将站点添加到受信任站点并将安全性设置为低时才能完美运行。否则，它会抛出这个错误：

> Microsoft JScript 运行时错误：对象不支持属性或方法“myMethod”

我该如何解决这个问题？

如果我想执行小程序，Chrome 会提示我。

完整的代码片段：

```
<html>
<head>
<script type="text/javascript">
    function getKey() {
    var key = document.myApplet.mymethod();
    }
</script>
</head>
<body onload="getKey()">
<applet id="myApplet" archive="myApplet.jar" code="myApplet.class" width="0" height="0"></applet> 
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T09:30:08.630

像这样使用**对象**标签而不是小程序标签

```
 <object type="application/x-java-applet" width="0" height="0" name="appId">
        <param name="code" value="myApplet" />
        <param name="archive" value="myApplet.jar" />   
 </object> 
```

你的Javascript是这样的：

```
function getKey() {
   var key = appId.mymethod();
} 
```

# jquery - Using Visible Elements for jQuery Form Validation

> ID：11335733
> 
> 赞同：0
> 
> 时间：2012-07-04T21:45:23.743
> 
> 标签：jquery, forms, validation

The fields in my form already validate. If they're invalid, there's a span class that appears and informs the user. Likewise if they're empty.

So I thought it would be easy enough to just check for the visibility of one of these classes.

Here's my script:

```
$(document).ready(function(){
  if (($('.error').length) || ($('.empty').length)) {

      function validateReview(){

               document.getElementById('ReviewForm').submit();
      }

  } else {

      function validateReview(){

                alert("Please check fields and be sure to leave a review.");
      }

  }
}; 
```

And then the submit button in my form simply calls `validateReview()` onclick.

But it's not working how I expected, I get this as an error "**validateReview is not defined**". Did I declare `validateReview()` incorrectly, or in a local scope maybe? BIG newb here so please be aware. I know enough only to get in trouble.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T21:50:01.793

不确定您的逻辑，但我认为您可以使用它

```
$(document).ready(function(){
    if ($('.error').length || $('.empty').length) {
        $('#ReviewForm')[0].submit();
    } else {
        alert("Please check fields and be sure to leave a review.");
    }
}); 
```

# android - Android GCM - 每次在不同设备上都使用相同的注册 ID

> ID：11335735
> 
> 赞同：0
> 
> 时间：2012-07-04T21:45:27.770
> 
> 标签：android, google-cloud-messaging

我正在尝试使用 GCM，除了在不同设备上调用 GCMRegistrar.getRegistrationId 外，一切正常。我已经在模拟器和 2 部不同的手机上运行此代码，并且 GCMRegistrar.getRegistrationId 始终返回相同的字符串。我希望它在每个设备上都会有所不同，但事实并非如此。难道我做错了什么？这是我正在使用的代码（取自文档）。

```
GCMRegistrar.checkDevice(context);
final String regId = GCMRegistrar.getRegistrationId(context);
if (regId.equals("")) {
    GCMRegistrar.register(activity, "123456789012"); //sender id/api project id
} else {
    LogUtil.info("Already registered");
} 
```

当我第一次在模拟器上运行它时，GCMRegistrar.getRegistrationId 返回了“”，但在随后的调用中它返回了大 ID。这就说得通了。奇怪的是，当在两部手机上运行相同的代码时，它们都返回了相同的 id（模拟器返回的那个），之前从未运行过这个应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T08:06:09.747

据我所知，注册 ID 用于匹配用户+设备。在模拟器上，您没有任何用户帐户，并且设备是虚拟的，所以我猜测注册认为两个虚拟设备是相同的。

我不知道他们使用什么来创建注册 ID，但如果他们使用[ANDROID_ID](http://developer.android.com/reference/android/provider/Settings.Secure.html#ANDROID_ID)，那么所有虚拟设备都具有相同的 ID 是一个已知问题。

此外，一些制造商对所有设备使用相同的设备 ID 也是一个已知问题，尽管它应该是唯一的。但也许他们正在使用其他东西。也许您应该尝试向[GCM](http://developer.android.com/support.html)寻求此特定问题的支持。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-09T21:25:31.460

这实际上是我检查身份证的方式的一个错误。XGouchet，感谢您的回复。

# c++ - 在递归函数中创建 std::list of value 而不是 std::list of pointers

> ID：11335738
> 
> 赞同：1
> 
> 时间：2012-07-04T21:45:57.003
> 
> 标签：c++, pointers, recursion, c++11

我有这堂课：

```
class obj
{
public:

    obj()
        : parent(nullptr),
        depth(0)
    {   }

    obj* parent;
    list<obj> children;
    int depth;  // Used only for this example
}; 
```

为了填充我的数据结构，我使用如下递归函数：

```
void recursive(obj& parent)
{
    if(parent.depth == 1)
        return;

    obj son;
    son.parent = &parent;
    son.depth = parent.depth + 1;

    recursive(son);

    parent.children.push_back(son);
} 
```

以这种方式为例：

```
obj root;
recursive(root); 
```

如果您注意，您会看到递归函数中的测试是否是：

```
if(parent.depth == n)
    return; 
```

使用`n >= 2`此代码将不起作用（`root->son->son`一旦退出递归函数，“孙子”父级的存储地址等将不是有效地址）。

解决此问题的一种方法是使用指针列表 ( `list<obj*> children`) 而不是值列表：

```
void recursive(obj& parent)
{
    if(parent.depth == 2)
        return;

    obj* son_ptr = new obj();
    son_ptr->parent = &parent;
    son_ptr->depth = parent.depth + 1;

    recursive(*son);

    parent.children.push_back(son_ptr);
} 
```

是否有另一种方法可以完成相同的工作并将`obj`s 存储在值列表中而不是指针列表中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T22:36:40.597

在你开始创建更多的孩子之前，这不只是固定对象的地址吗？为此，首先将它们放入子列表中，然后递归...

```
void recursive(obj& parent, int n)
{
    if (parent.depth == n)
        return;

    obj son;
    son.parent = &parent;
    son.depth = parent.depth + 1;
    parent.children.push_back(son);

    recursive(parent.children.back(), n);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T22:03:52.297

您可能会考虑在 s 中存储唯一 ID `obj`，这样 s 的实例`obj`不会定义表示对象的身份，而是定义其 ID。如果这样做，您可能会存储 ID 以链接相关`obj`的 s 而不是存储指针。

例如，您可以更改`obj`类以包含一个`int`字段`id`：

```
class obj {
public:
    obj()
        : parent(nullptr),
          depth(0)
    {
        // Not thread-safe; would need to get protected if multi-threaded
        id = nextId++;
    }

    static int nextId;

    int id;
    int parentId;
    list<int> childrenIds;

    int depth;  // Used only for this example
}; 
```

每当您构造一个新`obj`的来表示一个新的逻辑“事物”时，您都可以为该字段分配一个新的、唯一的值`id`。当您想在代表相关“事物”的 s 之间建立关系时`obj`，您可以 - 例如 - 使用`parentId`字段而不是`parent`指针字段：

```
void recursive(obj& parent)
{
    if (parent.depth == 1) {
        return;
    }

    obj son;
    son.parentId = parent.id;
    son.depth = parent.depth + 1;

    recursive(son);

    parent.childrenIds.push_back(son.id);
} 
```

当您想要跟随链接时，这需要更多的工作：而不是跟随指向 parent 的指针`obj`，而是需要在您维护`obj`的一些全局`obj`列表中查找（搜索有`parentId`问题的）。

当然，这实际上取决于这些`obj`s 真正代表什么，以及您要实现的更广泛的目标......

# playframework - Play 1.2.4 在传递给模板时正在清除我的列表

> ID：11335739
> 
> 赞同：0
> 
> 时间：2012-07-04T21:46:18.580
> 
> 标签：playframework, playframework-1.x

我有一个控制器，其中有几个页面共享一个常见的错误页面。该错误页面的代码如下所示：

```
@Util
private static void errorImp(PayPalPaymentStatus status, List<PayPalError> errors, boolean wasCharged) {
    if (wasCharged) {
        Email.chargedPayPalError(status, errors, wasCharged);
    }
    System.out.println("NumErrors=" + errors.size());

    renderTemplate("PayPal/error.html", status, errors, wasCharged);
} 
```

`PayPal/error.html`看起来像这样：

```
<strong>NumErrors=</strong> ${errors.size()}
#{list _errors, as:'error'}
    <p><strong>Code:</strong> ${error.code}</p>
    <p><strong>Message:</strong> ${error.shortMsg}</p>
    <p><strong>Details:</strong> ${error.longMsg}</p>
#{/list} 
```

当发生错误并使用错误`errorImp()`列表调用时，我在控制台中得到 NumErrors=1，但在网页中得到 NumErrors=0。

为什么我的清单被清除了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T06:17:32.460

您必须将错误列表的名称更改为：“errorList”，例如，因为 play 会随每个模板发送一个错误列表对象：[http ://www.playframework.org/documentation/1.2.4/templates#implicits](http://www.playframework.org/documentation/1.2.4/templates#implicits)

# tags - 根据度数在圆周上找到一个点

> ID：11335742
> 
> 赞同：0
> 
> 时间：2012-07-04T21:46:34.820
> 
> 标签：tags, geometry, point, degrees

假设你有一个简笔画。假设简笔画有一个肘部和一只手。如果简笔画想要在风车中转动手而不移动他的肘部怎么办？如果肘部作为圆心，并且手必须始终在圆的圆周上，并且我知道肘部和手的确切位置，我如何在保持半径的同时围绕圆的圆周移动手（肘部和手之间的手臂长度，因为它真的不应该收缩或增长）？

我需要沿着一个圆的圆周移动手的坐标，圆的中心是肘部。这是二维的。

我有两个点的坐标。我可以计算半径，即点之间的线的长度。知道圆的圆心和半径，如何沿圆周旋转手？我希望它保持半径，但改变圆周上的位置。基本上，它必须像铰链一样。

PS：我有一张照片，但是 Stack Overflow 说我太新了……怪 Stack Overflow。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T21:50:53.730

基本三角学说：

```
x = r * cos(a);
y = r * sin(a); 
```

这没有考虑手的旋转，只是显示了手腕所在的圆圈上的点。这就是你所追求的吗？

编辑：对不起，假设肘部在 (0, 0) 并且 x +ve 是正确的并且 y +ve 是向上的。

鉴于肘部在 (ex, ey)，那么手腕在：

```
wx = ex + r * cos(a);
wy = ey + r * sin(a); 
```

如果，就像在浏览器中发生的那样，y 是 +ve 下降，那么减去而不是加。

# c++ - 在 boost::bind 中通过引用传递向量

> ID：11335747
> 
> 赞同：0
> 
> 时间：2012-07-04T21:47:01.310
> 
> 标签：c++, boost

为什么这个输出是0？

[http://ideone.com/S7hgv](http://ideone.com/S7hgv)

```
#include <boost/bind.hpp>
#include <vector>
#include <iostream>

using namespace std;

void f2(vector<int> &h)
{
        h.clear();
        h.push_back(0);
}

void f1(vector<int> &h)
{
        boost::bind(f2, boost::ref(h));
}

int main()
{
        vector<int> h;
        f1(h);

        cout << h.size() << "\n";
} 
```

我需要它为 1，并且由于某种原因 h 没有被修改。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T21:50:51.800

`boost/std::bind()`只构造函数对象。您仍然必须调用它，以便执行内部的任何代码。

要获得 的输出`1`，请替换该行

```
 boost::bind(f2, boost::ref(h)); 
```

和

```
 boost::bind(f2, boost::ref(h))(); 
```

# php - Verify / validate the data before calling insert()

> ID：11335748
> 
> 赞同：-1
> 
> 时间：2012-07-04T21:47:16.567
> 
> 标签：php, mysql, zend-framework

I am using Zend's `insert()` function to insert records in a database table. Eg. From the database model object, I am calling `Zend_Db_Table's insert()` function and passing the incoming data as an array - `$data`, ie

```
 $this->insert($data); 
```

`$data` is an array. The contents of `$data` are of mixed datatypes -integer, money, text etc.

In order to validate the incoming `$data` array, I wrote a function, `verifyData($data)`.

```
private function verifyData(&$data) {
    //Trim whitespace characters from incoming data.
    foreach($data as $key => $val)
    {
        $data[$key] = trim($val);
        if(empty($data[$key])) {
            unset($data[$key]);
        }
    }

    //Checking for not null table columns
    if( empty($data['id']) || empty($data['name']) || empty($data['age'])) {
        error_log("One of the required fields is missing");
        return false;
    }
    else {
        return true;
    }
} 
```

As written above,this function :

1.  trims the incoming data and unsets any fields from the $data array, if they are empty.
2.  Then this function checks for the presence of required fields and if any required field is missing, it returns false. In this particular definition, id, name and age are required. However, there could be other non required fields as well that I want to validate. Eg $data['salary']

I need help/suggestions in adding following validations to the above function / in any other way possible:

1.  I want to check if the datatype of each element of the array is as expected/ convert it to a particular datatype before I insert the data.
2.  I want to convert/process the incoming data such that any threat of SQL injection is taken care of.

One way to take care of the datatype check is that I loop through the incoming data array and convert specific column values to their datatypes and validate. But I want to find out if there is any efficient/standard way to implement the above two points.

An example scenario is, eg on my webform, when the new person is added to db, I need to enter name, age and salary out of which name and age are compulsory. Age and salary should be entered as integers only. I want to implement this restriction on the php level and I am using Zend Framework.

Any help/suggestions would be really appreciated.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T09:56:38.543

一个简单的开始方法可能是使用[Zend_filter_Input](http://framework.zend.com/manual/en/zend.filter.input.html)，它使用 Zend_Validation 和 Zend_Filter 将过滤和验证应用于数据集。

```
//A simple exaample of how you might use Zend_Filter_Input
private function verifyData(&$data) {
    //Add any filters you want there are many standard filters, order of filters may matter
    $filters = array(
        '*' => 'StringTrim', //trim all fields
        'id' => 'Digits'     //filter for digits on id field
    );
    //add any validators you want there are many standard validators, order of validators may matter
    $validators = array(
        '*' => 'NotEmpty' //check all fields for empty()
    );
$input = new Zend_Filter_Input($filters, $validators, $data) {
    if ($input->isValid() {
       return TRUE;
    } else {
       return FALSE
    }    
} 
```

不用说这是一个不完整的例子，但它应该给你基本的想法。有许多不同的方法可以完成验证，找到你喜欢的一种，然后去做。

我个人最喜欢的是在输入阶段（表单、控制器......）进行基本过滤和验证，然后在将数据发送到映射器以插入数据库之前，在域模型中应用任何其他过滤或验证。

祝你好运...

[标准过滤器](http://framework.zend.com/manual/en/zend.filter.set.html)
[标准验证器](http://framework.zend.com/manual/en/zend.validate.set.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T21:52:47.837

`insert`应该已经处理了您可能遇到的任何 SQL 注入问题。至于类型检查和转换，PHP 中有几种方法可用。例如，检查并转换为`int`：

```
if(ctype_digit($something)) {
    $something = (int)$something;
} 
```

这实际上取决于您需要的特定验证。

# android - Android - ListView 项目不改变其状态

> ID：11335751
> 
> 赞同：0
> 
> 时间：2012-07-04T21:47:34.770
> 
> 标签：android, listview, background, selector, drawable

我目前面临 ListView 项目上的背景可绘制对象的问题。我有一个 ListView XML、一个 Item XML 和一个 Drawable XML，用于表示一个项目可以具有的不同状态。

问题是，当我单击或按下其中一项时，视觉上没有任何变化，但是单击有效，因为调用了我覆盖的 onItemClick() 方法并执行了它的代码......就像我没有设置 @background 参数一样！

layout/my_activity.xml（包含列表视图）：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@drawable/background"
    android:orientation="vertical" >

    <include ... />

    <include ... />

    <View
        ... />

    <ListView
        android:id="@+id/listViewPacks"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:divider="@color/blue_vdark"
        android:dividerHeight="2dp" >
    </ListView>

</LinearLayout> 
```

布局/listview_item_a.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:background="@drawable/listview_item_a_d"
    android:orientation="vertical"
    android:padding="5dp" >

    <TextView
        ... />

    <TextView
        ... />

    <TextView
        ... />

</LinearLayout> 
```

可绘制/listview_item_a_d.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">

    <item android:state_selected="true"><shape>
            <gradient android:angle="270" android:endColor="#bbbbbb" android:startColor="#e9e9e3" />
        </shape></item>
    <item android:state_enabled="true"><shape>
            <gradient android:angle="270" android:endColor="#ecca2e" android:startColor="#f9f7c9" />
        </shape></item>
    <item><shape>
            <solid android:color="@color/gray_dark" />
        </shape></item>

</selector> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T22:14:18.650

首先，在触摸模式下没有持久的选择或聚焦状态。

您可以使用`state_activated`.

您可以通过将列表的选择模式设置为单个或多个（默认为无）来实现此目的。

```
getListView().setChoiceMode(ListView.CHOICE_MODE_SINGLE); 
```

然后在选择器 XML 中使用激活状态：

```
<item android:state_activated="true">
    <shape>   
        <gradient android:angle="270" android:endColor="#bbbbbb" droid:startColor="#e9e9e3" />   
    </shape>
</item> 
```

请注意，`state_activated`对于 API 11+... 对于以前的版本，我相信您必须使用自定义适配器中的数组来跟踪所选状态并使用它在适配器`getView`方法中设置背景颜色/可绘制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-21T15:19:22.593

我的 ListView 有一个适配器，问题是我在 getView 方法中更改了视图的背景，所以我认为选择器被绘制在后面，或者根本没有绘制。无论如何，我刚刚删除了这些代码行，现在它可以正常工作了，谢谢！

# sql - SQL 选择查询内连接多对多重构

> ID：11335757
> 
> 赞同：4
> 
> 时间：2012-07-04T21:48:33.397
> 
> 标签：sql

我在条目和关键字之间有一个多对多的关系，连接表条目_关键字。我想获取键“wake”和“up”的所有条目。我想出的唯一方法就是这个。如果我想输入另一个搜索词，它会变得更糟。你如何重构这个？除了使用子查询之外，还有其他加入它的方法吗？

```
select * 
from 
(
    select * 
    from entries e 
    inner join entries_keywords ek 
        on e.id = ek.entry_id 
    inner join keywords k 
        on ek.keyword_id = k.id 
    where k.key = 'wake'
) e 
inner join entries_keywords ek 
    on e.id = ek.entry_id 
inner join keywords k 
    on ek.keyword_id = k.id 
where k.key = 'up'; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T21:58:13.570

如果您只想检索至少包含一个关键字的条目，您可以执行以下操作：

```
SELECT
    a.*
FROM
    entries a
INNER JOIN
    entries_keywords b ON a.id = b.entry_id
INNER JOIN
    keywords c ON b.keyword_id = c.id
WHERE
    c.key IN ('wake', 'up') 
```

如果要检索列表中包含所有关键字的条目，请添加`GROUP BY`和`HAVING`：

```
SELECT
    a.*
FROM
    entries a
INNER JOIN
    entries_keywords b ON a.id = b.entry_id
INNER JOIN
    keywords c ON b.keyword_id = c.id
WHERE
    c.key IN ('wake', 'up')
GROUP BY
    a.id
HAVING
    COUNT(*) = 2 
```

`2`您正在检查的列表中的关键字数量在哪里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T21:57:53.157

如果我满足您的需求，您可以使用 a`UNION`将 2 个查询结果加入列表中：

```
SELECT *
FROM entries e
INNER JOIN entries_keyworkds ek
    ON e.id = ek.entry_id
INNER JOIN keywords k
    ON ek.keywork_id = k.id
WHERE k.key = 'WAKE'

UNION

SELECT *
FROM entries e
INNER JOIN entries_keyworkds ek
    ON e.id = ek.entry_id
INNER JOIN keywords k
    ON ek.keywork_id = k.id
WHERE k.key = 'up'
; 
```

这将返回“wake”的所有条目+“up”的所有条目。

要查找具有两个键的条目，请使用`INTERSECT`：

```
SELECT *
FROM entries e
INNER JOIN entries_keyworkds ek
    ON e.id = ek.entry_id
INNER JOIN keywords k
    ON ek.keywork_id = k.id
WHERE k.key = 'WAKE'

INTERSECT

SELECT *
FROM entries e
INNER JOIN entries_keyworkds ek
    ON e.id = ek.entry_id
INNER JOIN keywords k
    ON ek.keywork_id = k.id
WHERE k.key = 'up'
; 
```

这将返回具有两个关键字的所有条目。

# android - Android：Asynctask 中的多个参数

> ID：11335759
> 
> 赞同：3
> 
> 时间：2012-07-04T21:49:12.170
> 
> 标签：android, android-asynctask

我需要将两个参数（lv 和位置）传递给 Asynctask doInBackground 方法，但我不知道该怎么做......

```
LoadSound.execute(lv,position)
class LoadSound extends AsyncTask<**[ListView,int]**, String, String> 
```

谢谢！

编辑：

我有一个列表视图。如果单击项目播放声音（来自 Internet）。

我想用 Asynctask 显示一个 progressDialog。

在 doInBackground 方法中，我有 itemOnClick：

```
HashMap<String, String> o = (HashMap<String, String>) lv.getItemAtPosition(position); 
```

出于这个原因，我需要通过 lv 和位置。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-07-04T21:54:52.277

尝试在您的内部创建一个构造函数，`AsyncTask`并且每当您创建对象时，您都可以传递参数。像这样的东西：

```
MyAsyncTask asynctask = new MyAsyncTask(10, true, myObject);
//this is how you create your object

 public class MyAsyncTask extends AsyncTask<Void, Void, Void>{

        int a;
        boolean b;
        Object c;

        public MyAsyncTask(int a, boolean b, Object c){
            this.a = a;
            this.b = b;
            this.c = c;
        }

        @Override
        protected Void doInBackground(Void... params) {
            if(b)
                c = a;
            return null;
        }

    } 
```

然后你可以打电话`asynctask.execute();`

*编辑：*阅读您更新的问题后，我同意 Squonk 使用服务例如播放背景声音；你也可以在启动你的 AsynkTask 之前显示一个进度对话框（如果这个是不确定的）并在你的 postexecute 中将其关闭。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-04T09:45:12.603

就像在[这个](https://stackoverflow.com/a/12069670/1323666)答案中所说的那样，您可以使用对象数组作为参数：

```
private class LoadSound extends AsyncTask<Object, String, String> {
    @Override
    protected void doInBackground(Object... params) {
        ListView lv = (ListView) params[0];
        int position = (Integer) params[1];
    }
    // ...
} 
```

确保将它们转换为正确的对象类型

这就是如何调用`AsyncTask`：

```
LoadSound loadSound = new LoadSound();
loadSound.execute(lv, position); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-04T21:56:55.883

您可以创建一个包含参数的内部类，如下所示：

```
public static class LoadSoundParam {
    public ListView lv;
    public int position;
}

class LoadSound extends AsyncTask<LoadSoundParam, String, String> {
    ...
}

LoadSoundParam param = new LoadSoundParam();
param.lv = lv;
param.position = position;

loadsound.execute(param); 
```

**编辑**

正如 Squonk 在他对您的 OP 的评论中提到的那样，将 ListView 传递给 AsyncTask 并不是一个好主意。因此，这段代码展示了如何将多个参数传递给 AsyncTask，但在您的情况下使用它并不是一个好主意。

# android - 使用 OAuth 登录到 Gmail 网络界面

> ID：11335761
> 
> 赞同：0
> 
> 时间：2012-07-04T21:49:44.913
> 
> 标签：android, oauth, gmail

我需要从`WebView`我的活动中访问 Gmail 网络界面。出于明显的安全/信任原因，我想避免向用户询问他的 Gmail 凭据并将其存储在某处，而是使用 OAuth 之类的东西来获得对 Gmail 的访问权限。根据我的发现，OAuth 仅针对 Gmail 帐户的 IMAP 和 SMTP 访问实现，对吗？

`webView.getSettings().setSavePassword(true);`在他/她第一次使用应用程序时使用并让用户登录会起作用吗？我如何在后续应用启动时自动提交保存的详细信息？

谢谢，
尼克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T09:38:36.427

您必须将您的`WebView`视为浏览器。Chrome 之类的浏览器如何让您在每次访问 Gmail 时自动登录？它存储来自 Gmail 的会话 cookie。

要存储您的 cookie`WebView`并在下次重复使用它们，请查看[`CookieManager`](https://developer.android.com/reference/android/webkit/CookieManager.html)。

# c++ - C2864 编译器错误

> ID：11335765
> 
> 赞同：3
> 
> 时间：2012-07-04T21:50:00.350
> 
> 标签：c++, visual-studio-2010

我正在制作一些游戏，但出现以下错误：

```
class Apple:public Fruit{
public:
    bool isAppleOK = false;
Apple(int amount, int pHValue) {
    amount = amount;
    pHValue= pHValue;
} ~Apple() {
}
    /*code trimmed*/ 
```

错误 C2864：“Apple::isAppleOK”：只能在类中初始化静态 const 整数数据成员

我在这里想念什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-04T21:52:16.813

这不是您在 C++ 中初始化成员变量的方式。您需要在构造函数的初始化列表中设置值：

```
Apple(int amount, int pHValue) : isAppleOK(false) {
    amount = amount;
    pHValue= pHValue;
} 
```

您还可以将其他变量的初始化移动到初始化列表中：

```
Apple(int amt, int pHv)
:   isAppleOK(false)
,   amount(amt)
,   pHValue(pHv) {
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-04T21:52:05.833

> 我在这里想念什么？

你错过了这个：

> 只能在类中初始化静态 const 整数数据成员

是`isAppleOk`的静态 const 整数成员`Apple`吗？不，这不对。在构造函数的初始化列表中对其进行初始化。

```
class Apple {
public:
    Apple() : isAppleOk(false) { }
private:
    bool isAppleOk;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-04T21:54:19.900

您不能在声明中初始化变量。

```
class Apple: public Fruit{
public:
    bool isAppleOK;
    Apple(int amount, int pHValue) : amount(amount), pHValue(pHValue),
                                     isAppleOK(false)
    {
    } 

    ~Apple() {
    }
}; 
```

它不完全相关，但也使用初始化[列表](http://www.parashift.com/c++-faq-lite/ctors.html#faq-10.6)，因为您的编译器可能会翻译：

```
class Apple:public Fruit{
public:
    bool isAppleOK;
    Apple(int amount, int pHValue) {
    amount = amount;
    pHValue= pHValue;
    } 
    ~Apple() {
    }
}; 
```

到

```
class Apple:public Fruit{
    public:
        bool isAppleOK;
        Apple(int amount, int pHValue): amount(), phValue(), 
                                        isAppleOk() {
        amount = amount;
        pHValue= pHValue;
        } 
        ~Apple() {
        }
    }; 
```

如果您在构造函数中将复杂类型作为参数，则可能会在每个对象构造中产生一些开销，因为首先将初始化类成员，然后将其分配给新值。

使用初始化列表，这将同时完成，没有可能的开销。

# facebook - 如何在新用户喜欢您的页面时向他们发送通知/邮件

> ID：11335769
> 
> 赞同：0
> 
> 时间：2012-07-04T21:50:20.480
> 
> 标签：facebook, facebook-page

我有一个 facebook 粉丝页面，我的目标是当用户喜欢他们收到通知或 facebook 邮件告诉他们来访问该页面以接收他们的免费优惠券代码的页面时。

但是我不确定如何做到这一点。

这会是一个 CRON 作业，它检查页面何时接收到新用户，然后找到用户和用户一个 facebook api 函数来提供通知或邮件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T06:50:44.897

如果可能是一项 cron 工作，如果 Facebook 允许您确定谁喜欢某个页面。

幸运的是，facebook 不允许这样做。

如果您有一个应用程序，并且用户使用您的应用程序，他们确实允许您检查特定用户是否喜欢某个页面，但这需要用户授予该应用程序的扩展权限。

最好的办法是通知查看您页面的人，他们可以通过订阅您的应用程序获得免费代金券。

然后，您可以创建一个 cron 作业，在新应用注册时发送电子邮件。

# jboss - JBoss AS 7 - NoSuchMethodError org.apache.xml.security.transforms.Transform.init()V

> ID：11335780
> 
> 赞同：0
> 
> 时间：2012-07-04T21:52:03.610
> 
> 标签：jboss, axis, jboss7.x, nosuchmethoderror, wss4j

我正在从 JBoss 5 -> JBoss 7 迁移，根据[https://docs.jboss.org/author/display/AS7/Class+Loading+in+AS7](https://docs.jboss.org/author/display/AS7/Class+Loading+in+AS7)，打包在 WEB-INF/lib 中的本地资源应该在部署间依赖项之前加载。

在我的 WEB-INF/lib 目录中，我有 wss4j（版本 1.5.7）库 jar，其中包含 Transform.init() 方法。

在我部署并运行我的应用程序后，我收到以下错误。

> 错误 [org.apache.catalina.core.ContainerBase.[jboss.web].[default-host].[/].[Resteasy]] (http--127.0.0.1-8080-1) Servlet.service() for servlet Resteasy 抛出异常：org.jboss.resteasy.spi.UnhandledException: java.lang.NoSuchMethodError: org.apache.xml.security.transforms.Transform.init()V at org.jboss.resteasy.core.SynchronousDispatcher.handleApplicationException( SynchronousDispatcher.java:340) [resteasy-jaxrs-2.3.2.Final.jar:] at org.jboss.resteasy.core.SynchronousDispatcher.handleException(SynchronousDispatcher.java:214) [resteasy-jaxrs-2.3.2.Final. jar:] 在 org.jboss.resteasy.core.SynchronousDispatcher.handleInvokerException(SynchronousDispatcher.java:190) [resteasy-jaxrs-2.3.2.Final.jar:] 在 org.jboss.resteasy.core.SynchronousDispatcher.getResponse(SynchronousDispatcher .java：540) [resteasy-jaxrs-2.3.2.Final.jar:] 在org.jboss.resteasy.core.SynchronousDispatcher.invoke(SynchronousDispatcher.java:119) [resteasy-jaxrs-2.3.2.Final.jar:] 在 org.jboss.resteasy.plugins.server.servlet.ServletContainerDispatcher.service(ServletContainerDispatcher .java:208) [resteasy-jaxrs-2.3.2.Final.jar:] 在 org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:55) [resteasy-jaxrs-2.3.2 .Final.jar:] 在 org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher.service(HttpServletDispatcher.java:50) [resteasy-jaxrs-2.3.2.Final.jar:] 在 javax.servlet.http。 HttpServlet.service(HttpServlet.java:847) [jboss-servlet-api_3.0_spec-1.0.0.Final.jar:1.0.0.Final] 在 org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:329) [jbossweb-7.0.13 .Final.jar:] at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:248) [jbossweb-7.0.13.Final.jar:] at org.apache.catalina.core.StandardWrapperValve.invoke( StandardWrapperValve.java:275) [jbossweb-7.0.13.Final.jar:] at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:161) [jbossweb-7.0.13.Final.jar:] at org.jboss.as.web.security.SecurityContextAssociationValve.invoke(SecurityContextAssociationValve.java:153) [jboss-as-web-7.1.1.Final.jar:7.1.1.Final] 在 org.apache.catalina.core。 StandardHostValve.invoke(StandardHostValve.java:155) [jbossweb-7.0.13.Final.jar:] at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102) [jbossweb-7.0.13.Final.jar:] at org.apache。 catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109) [jbossweb-7.0.13.Final.jar:] at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:368) [jbossweb-7.0\. 13.Final.jar:] 在 org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:877) [jbossweb-7.0.13.Final.jar:] 在 org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler .process(Http11Protocol.java:671) [jbossweb-7.0.13.Final.jar:] at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:930) [jbossweb-7.0.13 .Final.jar:] at java.lang.Thread.run(Thread.java:722) [rt.jar:1.7.0_05] 原因：java.lang.NoSuchMethodError: org.apache.xml.security.transforms.Transform.init()V 在 org.apache.ws.security.WSSConfig.(WSSConfig.java:81) [wss4j-1.5.2.jar:]在 org.apache.ws.security.WSSConfig.getNewInstance(WSSConfig.java:95) [wss4j-1.5.2.jar:] 在 org.apache.ws.security.WSSConfig.(WSSConfig.java:47) [wss4j- 1.5.2.jar:] 在 org.apache.ws.security.WSSecurityEngine.(WSSecurityEngine.java:51) [wss4j-1.5.2.jar:] 在 org.apache.ws.security.handler.WSHandler.(WSHandler .java:62) [wss4j-1.5.2.jar:] at java.lang.Class.forName0(Native Method) [rt.jar:1.7.0_05] at java.lang.Class.forName(Class.java:264 ) [rt.jar:1.7.0_05] 在 org.apache.axis.utils.ClassUtils$2.run(ClassUtils.java:177) [axis-1.4.jar:] 在 java.security.AccessController。doPrivileged(Native Method) [rt.jar:1.7.0_05] at org.apache.axis.utils.ClassUtils.loadClass(ClassUtils.java:160) [axis-1.4.jar:] at org.apache.axis.utils。 ClassUtils.forName(ClassUtils.java:100) [axis-1.4.jar:] 在 org.apache.axis.deployment.wsdd.WSDDDeployableItem.getJavaClass(WSDDDeployableItem.java:353) [axis-1.4.jar:] 在 org. apache.axis.deployment.wsdd.WSDDDeployableItem.makeNewInstance(WSDDDeployableItem.java:295) [axis-1.4.jar:] at org.apache.axis.deployment.wsdd.WSDDDeployableItem.getNewInstance(WSDDDeployableItem.java:274) [axis- 1.4.jar:] 在 org.apache.axis.deployment.wsdd.WSDDDeployableItem.getInstance(WSDDDeployableItem.java:260) [axis-1.4.jar:] 在 org.apache.axis.deployment.wsdd.WSDDChain.makeNewInstance(WSDDChain .java:125) [axis-1.4.jar:] 在 org.apache.axis.deployment.wsdd.WSDDDeployableItem.getNewInstance(WSDDDeployableItem.java:274) [axis-1.4.jar:] at org.apache.axis.deployment.wsdd.WSDDDeployableItem.getInstance(WSDDDeployableItem.java:260) [axis- 1.4.jar:] 在 org.apache.axis.deployment.wsdd.WSDDDeployment.getGlobalRequest(WSDDDeployment.java:473) [axis-1.4.jar:] 在 org.apache.axis.configuration.FileProvider.getGlobalRequest(FileProvider.java :269) [axis-1.4.jar:] at org.apache.axis.AxisEngine.getGlobalRequest(AxisEngine.java:365) [axis-1.4.jar:] at org.apache.axis.client.AxisClient.invoke(AxisClient .java:126) [axis-1.4.jar:] 在 org.apache.axis.client.Call.invokeEngine(Call.java:2784) [axis-1.4.jar:] 在 org.apache.axis.client.Call .invoke(Call.java:2767) [axis-1.4.jar:] 在 org.apache.axis.client。Call.invoke(Call.java:2443) [axis-1.4.jar:] 在 org.apache.axis.client.Call.invoke(Call.java:2366) [axis-1.4.jar:] 在 org.apache。 axis.client.Call.invoke(Call.java:1812) [axis-1.4.jar:] 在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) [rt.jar:1.7.0_05] 在 sun.reflect.NativeMethodAccessorImpl。调用（NativeMethodAccessorImpl.java:57）[rt.jar:1.7.0_05] 在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) [rt.jar:1.7.0_05] 在 java.lang.reflect.Method。在 org.jboss.resteasy.core.MethodInjectorImpl.invoke(MethodInjectorImpl.java:155) [resteasy-jaxrs-2.3.2.Final.jar:] 调用（Method.java:601）[rt.jar:1.7.0_05]在 org.jboss.resteasy.core.ResourceMethod.invokeOnTarget(ResourceMethod.java:257) [resteasy-jaxrs-2.3.2.Final.jar:] at org.jboss.resteasy.core.ResourceMethod.invoke(ResourceMethod.java:222) [resteasy-jaxrs-2.3.2.Final.jar:] at org.jboss.resteasy.core.ResourceMethod.invoke (ResourceMethod.java:211) [resteasy-jaxrs-2.3.2.Final.jar:] at org.jboss.resteasy.core.SynchronousDispatcher.getResponse(SynchronousDispatcher.java:525) [resteasy-jaxrs-2.3.2.Final .jar:] ... 还有 19 个

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-15T22:57:37.630

从我能找到的信息来看，似乎该方法在 1.4 版之后的 xmlsec 中不可用。您可以尝试使用旧版本的 jar，例如：

[http://mirrors.ibiblio.org/pub/mirrors/maven2/org/apache/santuario/xmlsec/1.4.2/xmlsec-1.4.2.jar](http://mirrors.ibiblio.org/pub/mirrors/maven2/org/apache/santuario/xmlsec/1.4.2/xmlsec-1.4.2.jar)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T14:53:54.237

我发现了同样的问题，并在 META-INF/jboss-deployment-structure.xml 中设置了以下 JBoss 部署排除（在 7.1.1 中）解决了它：

```
<?xml version="1.0" encoding="UTF-8"?>
<jboss-deployment-structure xmlns="urn:jboss:deployment-structure:1.1">
    <ear-subdeployments-isolated>true</ear-subdeployments-isolated>
    <deployment>
        <dependencies>
            <module name="deployment.javaee.api" />
        </dependencies>
        <exclusions>
            <module name="javaee.api" />
        </exclusions>
    </deployment>
    <module name="deployment.javaee.api">
        <dependencies>
            <module name="javaee.api" export="true">
                <imports>
                    <exclude path="org/apache/xml/security/**" />
                </imports>
            </module>
        </dependencies>
    </module>
</jboss-deployment-structure> 
```

来自[https://community.jboss.org/message/747491#747491](https://community.jboss.org/message/747491#747491)。

# xcode - 自添加 ShareKit 2.0（作为子项目）以来，SVN 无法正常工作

> ID：11335784
> 
> 赞同：0
> 
> 时间：2012-07-04T21:52:20.587
> 
> 标签：xcode, svn, git-svn, sharekit

我已经为我的应用程序使用 SVN 一年多了，从来没有遇到过任何问题。当我在我的项目中添加/编辑/修改文件时，它们会显示“A”“M”以显示自上次提交以来您所做的事情，这很棒！

我最近将 ShareKit 添加到我的项目中。他们希望您将其安装为子项目 ShareKit 安装步骤。

在完成所有这些步骤并提交回我的 SVN 之后，现在当我在 Xcode 中打开我的项目时，我的主项目文件（树中的顶部带有蓝色图标）并且 MainWindow.xib 文件有一个“？” 在他们旁边。现在，当我在项目中添加或编辑文件时，文件名旁边不会显示“M”或任何内容。

我仍然可以正确提交，并且 SVN 知道发生了什么变化。很高兴能够看到自上次提交/获取代码以来我所做的更改以及文件名旁边的指示符。

任何人都有这个问题或知道如何解决它？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T15:39:37.547

Sharekit 来自一个 git 子模块。要解决此问题，请删除 .git（不可见）文件。

[mac如何显示隐藏文件](http://lifehacker.com/188892/show-hidden-files-in-finder)

清理并运行 xcode 项目。我有同样的问题，这解决了。;)

dsa

# mysql - 使用 ajax、php 和 javascript 删除 mySQL 记录

> ID：11335785
> 
> 赞同：0
> 
> 时间：2012-07-04T21:52:24.207
> 
> 标签：mysql, ajax

我在[这里](http://class.piezosystems.org/finder-admin/finder/comment/)做了一个简单的评论系统，我想创建一个删除按钮，如果按下，评论将被删除（基本上从数据库中删除）。我不知道如何在评论中实现这一点。我已经制作了 javascript 来与 delta.php 交互，但我不知道如何制作 delete.php。mySQL 字段是；

*   ID，
*   姓名，
*   网址，
*   电子邮件和
*   身体

我如何编码 delete.php 以与 mySQL 和评论系统交互？谢谢！

```
<script type="text/javascript">
    function deleteUser(id){
    new Ajax.Request('delete.php', {
        parameters: $('idUser'+id).serialize(true),
    });
}
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T14:43:42.893

这是一个例子：

**Javascript**：

```
function deleteComment(id)
{
    $.ajax(
    {
        type: "POST",
        url: "delete.php?id="+id,
        dataType: "html",
        success: function(result)
        {
            if(result == "Ok") alert("The comment is successfuly deleted");
            else alert("The following error is occurred: "+result);
        }
    });
} 
```

**PHP（删除.php）：**

```
if(!isset($_POST['id'])) die("No ID specified");
$id = mysql_real_escape_string($_POST['id']);

mysql_query("DELETE FROM `comments` WHERE `id` = $id") or die(mysql_error());

echo "Ok"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-07T14:37:49.217

您可以使用 jquery 使事情变得更容易：

```
$('#delete_button').click(function(){
   var comment_id = $(this).attr('id');//you should use the id of the comment as id for the delete button for this to work.
   $.post('delete.php', {'comment_id' : comment_id}, function(){
      $(this).parent('div').remove(); //hide the comment from the user
   });
}); 
```

delete.php 将包含以下内容：

```
<?php
//include database configuration file here. 
//If you don't know how to do this just look it up on Google.

$comment_id = $_POST['comment_id'];

mysql_query("DELETE comment from TABLE WHERE comment_id='$comment_id'");
//mysql_query is not actually recommended because its already being deprecated. 
//I'm just using it for example sake. Use pdo or mysqli.  
?> 
```

# iphone - 评价 iOS 应用的 GameKit 成就？

> ID：11335789
> 
> 赞同：0
> 
> 时间：2012-07-04T21:53:03.150
> 
> 标签：iphone, ios, gamekit, rating, achievements

快速提问。尝试谷歌搜索和 SO 并找不到这样的东西。

是否允许为游戏中没有实际进展的事物创建游戏中心成就？例如，您能否取得以下成就：

*   通过电子邮件向我发送反馈
*   在 App Store 上给 App 评分
*   通过应用内购买解锁关卡
*   在 Facebook/Twitter 上分享应用程序
*   完成教程

任何人都试图实现这些？感谢您的任何意见！我不想因为成绩而被拒绝！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T23:10:12.377

关于以下内容：

*   通过电子邮件向我发送反馈
*   在 Facebook/Twitter 上分享应用程序
*   完成教程

您绝对可以为这些创建 GameCenter 成就。我在许多游戏中都做过类似的事情（即，我们总是在第一关（包含教程）和发送“挑战朋友”电子邮件方面取得成就）。苹果从未对此眨眼。非常欢迎你取得任何你喜欢的成就，只要它们不促进 Apple 不赞成的行为。

关于`Unlocking Levels Through In-App Purchases`，你*可以*，但我建议不要这样做。很多用户都以完成游戏中的每一项成就为荣，并且有一种游戏个性在很大程度上依赖于这样的事情。为了防止这些用户在没有应用内购买的情况下获得每一项成就，会疏远你的大部分用户群，这不是获得成功应用的方法。但正如我所说，如果你愿意，你*可以。*

关于`Rating the App on the App Store`，你可以这样做。您可以有一个按钮，要求用户对应用程序进行评分并将他们带到应用程序商店，但是一旦他们到达该页面，您就无法确认他们确实对应用程序进行了评分。所以你必须给他们荣誉系统上的成就，一旦他们点击了按钮，并希望他们真的给它打分。（就像“通过电子邮件向您发送反馈”一样——您可以保证他们发送了一封电子邮件，但不能保证其中包含任何值得阅读的内容（或者甚至他们最终将其发送给您！））。

希望这可以帮助！如果您还有其他问题，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T22:00:04.530

除了“完成教程”之外的所有内容都可能让你被 App Store 拒绝。苹果对这样的恶作剧不屑一顾。

如果教程设置为您的游戏的一部分（即它不仅仅是您显示的 PDF 或文本文件），那么他们应该可以接受。

我们不是苹果。他们的规则不再向我们解释，就像向您解释一样。如果您需要更确切的答案，您应该联系 Apple 并直接询问他们。

# python - 使用python返回重复出现的正则表达式匹配

> ID：11335790
> 
> 赞同：1
> 
> 时间：2012-07-04T21:53:17.000
> 
> 标签：python, regex

我有一个字符串：

```
SomeTextSomeTextA *SomeThing* BSomeTextSomeTextA *SomeThingElse* BSomeText
```

我希望返回字符串 SomeThing 和 SomeThingElse 字符串，因为它们用 A 和 B 括起来，并假设 SomeText 不包含任何 A ... B 出现。

任何提示将不胜感激。

这是我尝试过的，但它不起作用：

```
import re

string = 'SomeTextSomeTextASomeThingBSomeTextSomeTextASomeThingElseBSomeText'
regex='(A.*B)' 
```

我想正则表达式都不正确，我也不知道如何访问匹配项。是`finditer`……还是……的比赛？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T21:54:59.420

尝试使用`re.findall`：

```
>>> print re.findall('A(.*?)B', s)
['SomeThing', 'SomeThingElse'] 
```

在线查看它：[ideone](http://ideone.com/20QrS)

注意问号。没有它，匹配就会贪婪地完成——它会消耗尽可能多的字符。

# java - 从 Java 登录 MSSQL 服务器时出现问题

> ID：11335797
> 
> 赞同：2
> 
> 时间：2012-07-04T21:54:30.783
> 
> 标签：java, sql-server, sql-server-2008, jdbc

我正在尝试连接到本地主机上的 MSSQL server 2008，但出现错误

警告：ConnectionID：2 登录前错误：主机 127.0.0.1 端口 1434 读取登录前响应时出错：连接重置

这个错误很快重复了 20 次，然后我得到 com.microsoft.sqlserver.jdbc.SQLServerException: Connection reset

我怀疑这是服务器的一些错误配置。我可以毫无问题地连接到外部服务器。我也可以毫无问题地通过管理工作室连接。

请帮助我，我厌倦了这个问题：|

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-04T22:01:53.557

1)默认*禁用*MSSQL 2008 的 TCP 协议。您需要从 SQL 配置管理器启用它（在与 MSSQL 相同的 [开始]、程序文件夹中）：

*   [http://msdn.microsoft.com/en-us/library/ms190425%28v=sql.105%29.aspx](http://msdn.microsoft.com/en-us/library/ms190425%28v=sql.105%29.aspx)

2) 要使用 TCP 连接（即使在 localhost 上！），您需要在 Windows 防火墙中允许 MSSQL：

*   [http://technet.microsoft.com/en-us/library/cc646023.aspx](http://technet.microsoft.com/en-us/library/cc646023.aspx)

3) 您*不一定*需要使用 TCP/IP 来访问 MSSQL：

*   [http://msdn.microsoft.com/en-us/library/ms187892%28v=sql.105%29.aspx](http://msdn.microsoft.com/en-us/library/ms187892%28v=sql.105%29.aspx)

'希望有帮助！

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-07-06T11:37:26.667

要从 Java 应用程序连接到 MSSQL Server，您需要使用 JDBC API。JDBC API 提供连接到数据库、加载适当的驱动程序、发送 SQL 查询、检索结果等的类和方法。

如何连接到数据库 “连接”对象表示与数据库的连接。要建立连接，请使用“DriverManager.getConnection”方法。此方法接受一个包含 URL 的字符串，该 URL 表示我们尝试连接的数据库。下面是建立连接的示例代码：

```
private String DATABASE_URL = "jdbc:odbc:embedded_sql_app"; // establish connection to database
Connection connection = DriverManager.getConnection( DATABASE_URL,"sa","123" ); 
```

关于数据库 URL 以及如何创建它的详细讨论可以在本文末尾提供的资源中找到。

查询数据库 JDBC API 提供了三个接口用于将 SQL 语句发送到数据库，“Connection”接口中的相应方法会创建它们的实例。1\. 语句 - 由“Connection.createStatement”方法创建。'Statement' 对象用于发送不带参数的 SQL 语句。2\. PreparedStatement - 由“Connection.prepareStatement 方法”创建。'PreparedStatement' 对象用于预编译的 SQL 语句。它们可以将一个或多个参数作为输入参数（IN 参数）。3\. CallableStatement - 由“Connection.prepareCall”方法创建。'CallableStatement' 对象用于从 Java 数据库应用程序执行 SQL 存储过程。

检索结果 “ResultSet”是一个 Java 对象，包含执行 SQL 查询的结果。存储在“ResultSet”对象中的数据是通过一组允许访问当前行的各个列的 get 方法检索的。'ResultSet.next' 方法用于移动到 'ResultSet' 的下一行，使其成为当前行。以下代码片段执行返回行集合的查询，列“a”为“int”，列“b”为“String”，列“c”为“float”：

```
java.sql.Statement stmt = con.createStatement();
ResultSet rs = stmt.executeQuery("SELECT a, b, c FROM Table1");
while (rs.next()) { // retrieve and print the values for the current row
int i = rs.getInt("a");
String s = rs.getString("b");
float f = rs.getFloat("c");
System.out.println("ROW = " + i + " " + s + " " + f); } 
```

This is just a brief introduction on how to interact with a database from Java. For more details on the items discussed above as well as information on passing parameters, executing stored procedures etc. please refer to the following resource: ( [http://www.shahriarnk.com/Shahriar-N-K-Research-Embedding-SQL-in-C-Sharp-Java.html#Shahriar_N_Embedding_SQL_in_Java](http://www.shahriarnk.com/Shahriar-N-K-Research-Embedding-SQL-in-C-Sharp-Java.html#Shahriar_N_Embedding_SQL_in_Java) ) Here, you will also find information on how to interact with a database programmatically; i.e. without using SQL. Hope you find this useful.

# java - 点击标记时是否可以在 Google 地图上显示叠加项目？

> ID：11335801
> 
> 赞同：0
> 
> 时间：2012-07-04T21:55:29.167
> 
> 标签：java, android, eclipse, google-maps

我已经制作了一个简单的 android 应用程序，我还在其中集成了 Google 地图。它还能够连接到 MySQL (localhost) 以使用经度和纬度值显示我想要的地方。我的问题是，是否可以单击标记时在 Google 地图上方制作另一个叠加项目（就像在foursquare中发生的那样）？

具体来说，我想显示一个包含地名的文本。

这是我显示叠加项目的类。我做了一个 onTap 方法，但它显示一个对话框，我想显示一个简单的文本框，显示地点的名称。

```
 package finddroid.map;

import java.util.ArrayList;

import android.app.AlertDialog;
import android.content.Context;
import android.graphics.Paint;
import android.graphics.Point;
import android.graphics.Rect;
import android.graphics.RectF;
import android.graphics.drawable.BitmapDrawable;
import android.graphics.drawable.Drawable;
import android.text.TextPaint;

import com.google.android.maps.GeoPoint;
import com.google.android.maps.ItemizedOverlay;
import com.google.android.maps.MapView;
import com.google.android.maps.OverlayItem;

public class CustomItemizedOverlay extends ItemizedOverlay<OverlayItem>
{

    private int markerHeight;

    private ArrayList<OverlayItem> mapOverlays = new ArrayList<OverlayItem>();

    private Context context;

    public CustomItemizedOverlay(Drawable defaultMarker)
    {
        super(boundCenterBottom(defaultMarker));
        markerHeight = ((BitmapDrawable) defaultMarker).getBitmap().getHeight();
        populate();
    }

    public CustomItemizedOverlay(Drawable defaultMarker, Context context)
    {
        this(defaultMarker);
        this.context = context;
    }

    @Override
    protected OverlayItem createItem(int i)
    {
        return mapOverlays.get(i);
    }

    @Override
    public int size()
    {
        return mapOverlays.size();
    }

    @Override
    //Event when a place is tapped
    protected boolean onTap(int index)
    {
        OverlayItem item = mapOverlays.get(index);
        AlertDialog.Builder dialog = new AlertDialog.Builder(context);
        dialog.setTitle(item.getTitle());
        dialog.setMessage(item.getSnippet());
        dialog.show();
        return true;
    }

    public void addOverlay(OverlayItem overlay) 
    {
        mapOverlays.add(overlay);
        this.populate();
    }   
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T22:27:00.743

看看这个项目 -[气球逐项叠加](http://code.google.com/p/balloon-itemized-overlay/)。它使用自己的类扩展`FrameLayout`来显示气球。

因此，如果您想修改代码，请将其放入您的`onTap`方法中以显示`TextView`上面的录音项目

```
TextView text = new TextView(context);
text.setText(item.getTitle());
MapView.LayoutParams params = new MapView.LayoutParams(ViewGroup.LayoutParams.WRAP_CONTENT,
    ViewGroup.LayoutParams.WRAP_CONTENT, item.getPoint(), MapView.LayoutParams.BOTTOM_CENTER);
params.mode = MapView.LayoutParams.MODE_MAP;
mMapView.addView(text, params); 
```

我认为这段代码简单易懂，您可以根据需要对其进行改进。要使其工作，您必须将实例传递`MapView`给覆盖的构造函数并将其保存到私有变量`mMapView`。

```
private MapVeiw mMapView;

public CustomItemizedOverlay(Drawable defaultMarker, Context context, MapView mapView) {
    this(defaultMarker);
    this.context = context;
    this.mMapView = mapView;
} 
```

并且不要忘记`MapView`在调用时添加为参数之一`new CustomItemizedOverlay()`。

# jquery - SimpleDialog2 jQuery Mobile 复选框

> ID：11335804
> 
> 赞同：0
> 
> 时间：2012-07-04T21:55:58.110
> 
> 标签：jquery, jquery-mobile

我有这段代码来显示一个带有复选框的弹出窗口，当我单击触发带有复选框值的警报的复选框时，我想要。我怎样才能做到这一点？

```
$('<div>').simpledialog2({
            mode: 'blank',
            headerText: 'Crate',
            headerClose: true,
            blankContent : 
                '<div data-role="fieldcontain">'+
                '<fieldset data-role="controlgroup"><legend>Select:</legend><input type="checkbox" name="checkbox-1a" id="checkbox-1a" class="custom" /><label for="checkbox-1a">Cheetos</label></fieldset>'+
                '</div>'+
                '<a rel="close" data-role="button" href="#" id="submit">Submit</a>'
            }) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-11T17:59:21.197

如果我正确理解了您的问题（您希望在有人单击复选框时显示警报），只需将其放在头部的 javascript 标记中：

```
$('#checkbox-1a').click(function () {    
    alert(this.checked);
}); 
```

# php - 从 SQL 数据库自动更新统计信息

> ID：11335805
> 
> 赞同：0
> 
> 时间：2012-07-04T21:56:07.337
> 
> 标签：php, javascript, jquery, html, ajax

我正在尝试获得类似于[http://www.minecraft.net](http://www.minecraft.net)页面的效果，它会自动更新数据库中的销售额，我已经研究了两个月，但没有运气。我有一个 php 文件，它查找数据库中有多少结果并将它们显示为一个数字，工作正常[http://tzeale.com/sandbox/stats/pull.php](http://tzeale.com/sandbox/stats/pull.php)

我想要做的是获得类似 minecraft.net 的效果，它会自动更新而不刷新页面。谁能指导我该怎么做？我不知道还能尝试什么。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T22:10:35.893

h 您需要使用 AJAX。

[setTimeout](http://www.w3schools.com/jsref/met_win_settimeout.asp)，以及对该 pull.php 的 AJAX 调用

如果您使用的是 jQuery，这里有一个很好的例子来说明如何实现您想要的。添加了一个简单的逻辑来查看服务器是否死机，并最终停止。

```
var failed = 0; 
var limit_failed = 5;
(function updateSales( waitTime ){
   waitTime = waitTime || 1000; // Set to 1 second by default

   setTimeout(function(){
       $.ajax({
           url: 'pull.php',
           success: function( response ){
               // Update something with your response
                alert ("sales are now at: "+ response);
               updateSales(); // Recursion
           },
           error: function(){           
                // Error handling - not necessary
               // If the request failed more then (limit_failed) times, you might want to stop it from checking after (limit_failed) times, 
               // and in the meanwhile icnrease the wait time, so the server has more time to get back online.
               if( ++failed < limit_failed ){
                   waitTime += 1000;
                   updateSales( waitTime );
               }
           }
       });
   }, waitTime);
})(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T22:06:06.113

您将使用`setTimeout`和 Ajax。setTimeout 将使用 Ajax 每 1000 毫秒（或您设置它）获取数据以获取数据。

您可以`html`像这样将显示计数包装起来，例如：

```
<span id="mycount"></span> 
```

然后你的 jQuery 代码看起来像这样：

```
 setTimeout(function(){
   $.get("/sandbox/stats/pull.php",function(data){
      $("#mycount").html(data);
   });
 },1000); 
```

`1000`是一秒，您可以根据需要更改它。我不知道如何让它像那样动画，但是`$.get()`一旦你检索数据，它就会进入你的函数。`http://tzeale.com/`此外，由于[相同的来源策略](http://en.wikipedia.org/wiki/Same_origin_policy)，这必须与 Ajax 工作在同一个域上

* * *

**但是**，在查看了 te minecraft.net 站点后，我注意到他们一次将这些数据加载到他们的页面中，而不是每 1 秒获取一次：

```
<script>
var justLoggedIn = false;
var totalUsers = 33652552;
var paidUsers = 6495707;
var totalUsersRate = 1.2166667;
var paidUsersRate = 0.15;
</script> 
```

然后他们没有得到实时数据。他们只是得到当前的数量，然后继续加 1。

他们使用这个插件使它动画化：http: [//timeago.yarp.com/](http://timeago.yarp.com/) 并且仍然使用`setTimeout()`每秒添加 1 个。我认为这不是真正的用户，只是从`var totalUsers`

# opencv - 为什么 EigenCount 不能大于 TrainingImagesCount-1 [EigenObjectRecognizer]

> ID：11335806
> 
> 赞同：0
> 
> 时间：2012-07-04T21:56:08.130
> 
> 标签：opencv, emgucv, face-recognition, eigen

[http://www.cognotics.com/opencv/servo_2007_series/part_5/fig_6_thumb.png](http://www.cognotics.com/opencv/servo_2007_series/part_5/fig_6_thumb.png)

谁能解释为什么 nEgiens 不能超过上图中的 nTrainFace-1 ？

我正在使用 EmguCv。当 nEgiens 和 nTrainFace 相等时，最后一个特征图像返回空白（黑色）。但是，在 emgucv 实现中：

```
`if (termCrit.max_iter <= 0 || termCrit.max_iter > trainingImages.Length)
    termCrit.max_iter = trainingImages.Length;` 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T13:10:59.700

数学约束：

> 协方差矩阵的秩受训练样例数量的限制：如果有 N 个训练样例，则最多有 N-1 个具有非零特征值的特征向量。

[http://en.wikipedia.org/wiki/Eigenface#Computing_the_eigenvectors](http://en.wikipedia.org/wiki/Eigenface#Computing_the_eigenvectors)

# ruby - 解决 3rd 方 gem 代码中的名称冲突

> ID：11335807
> 
> 赞同：7
> 
> 时间：2012-07-04T21:56:11.227
> 
> 标签：ruby, rubygems

我的项目依赖于[Sunspot](http://rubygems.org/gems/sunspot)，而后者又依赖于[progress_bar](http://rubygems.org/gems/progress_bar)。progress_bar 定义了一个名为`ProgressBar`.

我的测试代码依赖于[minitest-reporters](http://rubygems.org/gems/minitest-reporters)，而 minitest-reporters 又依赖于[ruby](http://rubygems.org/gems/ruby-progressbar) ​​-progressbar 。ruby-progressbar 定义了一个名为`ProgressBar`.

`ProgressBar`作为 Ruby 的新手，我花了很长时间才找到两个类冲突的事实。我知道如何命名我自己的代码以防止此类问题，但是有没有办法解决第 3 方代码中的此类冲突？

**更新**：

minitest-reporters 的所有者非常友好地用另一个进度库[PowerBar](http://rubygems.org/gems/powerbar)替换了他对（显然被放弃的）ProgressBar 的使用。所以这解决了我的问题。但是你猜怎么着——PowerBar 也会污染全局命名空间！这在 Ruby 中似乎是病态的......

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-05T01:55:51.210

如果你面临

```
# alice_bad_code.rb

class ProgressBar
  def initialize
    puts "Alice bad code progress bar created"
  end
end

class AliceBadCode
  def initialize
    @progress_bar = ProgressBar.new
  end
end 
```

和

```
# bob_bad_code.rb

class ProgressBar
  def initialize
    puts "Bob bad code progress bar created"
  end
end

class BobBadCode
  def initialize
    @progress_bar = ProgressBar.new
  end
end 
```

然后我会尝试类似的东西

```
require "alice_bad_code"
class AliceBadCode
  ProgressBar = ::ProgressBar
end
Object.send(:remove_const, "ProgressBar")

require "bob_bad_code"
class BobBadCode
  ProgressBar = ::ProgressBar
end
Object.send(:remove_const, "ProgressBar") # Just in case 
```

欢迎来到 Ruby 元编程！

However, the best way to monkey patch a third-party library is not to monkey patch it at all, and file a bug report as per Jorg W Mittag's answer.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-04T23:17:33.167

*   如果它在您自己的代码中（在这种特殊情况下不适用）：**命名您的 friggin 常量！**
*   如果它在其他人的代码中：提交一个错误，告诉他们为**他们的 friggin 常量命名！**……等待他们发​​布新版本……</li>

你真的无能为力了。

# orchardcms - Orchard 自定义页面呈现默认小部件？

> ID：11335808
> 
> 赞同：0
> 
> 时间：2012-07-04T21:56:12.843
> 
> 标签：orchardcms

仍然了解 Orchard，我现在已经设法使用模块和路由规则创建自定义默认页面。

尽管 Orchard 正确显示了我的页面，但它也呈现了三个似乎是默认小部件，标题为“First Leader Aside”、“Second Leader Aside”、“Third Leader Aside”。好的，显然你需要覆盖默认行为或类似的东西，但我不知道如何。

那么我的模块有什么问题/缺失，还是我需要提供一个设置或类似的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T03:35:36.797

如果小部件位于默认层中，它将出现在站点的每个页面上。请参阅[http://docs.orchardproject.net/Documentation/Managing-widgets](http://docs.orchardproject.net/Documentation/Managing-widgets)

您需要将这些小部件放在由适合您想要的规则定义的不同层中。

# concurrency - 编写可扩展的代码

> ID：11335811
> 
> 赞同：3
> 
> 时间：2012-07-04T21:56:52.953
> 
> 标签：concurrency, distributed, distributed-computing

有人可以用非常简单的术语描述您将如何扩展服务（假设该服务非常简单并且是函数 X() ）。

为了使这种可扩展性，您是否只需为每个想要运行 X 的客户端启动一个新节点（最多取决于您的硬件）？

因此，如果我有四个硬件盒，我最多可以启动四个节点来运行服务 X()，在第 5 个客户端请求时，我将在第一个节点上运行 X()，在第二个节点上运行第 6 个客户端等等？

在此之后，我知道如何在本地生成进程，但是如何让第 1 和第 5 个客户端都使用相同的节点 1 - 是否每次都在节点上为客户端远程生成一个进程？

欢迎任何简单的例子！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-06T09:32:38.620

这在很大程度上取决于 X 是什么。例如，如果 X 是完全独立的，`x() -> 37.`那么您甚至不需要连接您的节点。只需在系统前面放置一些标准负载均衡器（HAProxy、Varnish 等），然后忘记任何类型的分布式通信。事实上，没有必要为此使用 Erlang。用您选择的其他语言替换 Erlang。它同样好。

Erlang 的亮点是当几个 X 函数相互依赖时，以及当 X 可能存在于另一台物理机器上时。在这种情况下，Erlang 可以与另一个 X 无缝通信，即使它位于不同的节点上。

如果你想在 Erlang 中实现循环方案，最简单的方法是有一个入口点，然后让它将请求转发到多个节点。但是，如果存在某个节点以所有长时间运行的进程结束的模式，那就不好了。您需要建立一种反馈机制，以便知道如何加权循环队列。

# android - 基于 AIDL 的双向通信（已更新代码）

> ID：11335813
> 
> 赞同：0
> 
> 时间：2012-07-04T21:57:03.000
> 
> 标签：android, process, ipc, aidl

我有两个应用程序，我希望在它们之间交换一些数据。由于它们在不同的进程中运行，所以我使用 AIDL 在它们之间进行通信。现在，一切都在一个方向上发生得非常好（比如我的应用程序是 A 和 B），即数据正在从 A 发送到 B，但是现在我需要将一些数据从 B 发送到 A。

我注意到我们需要在将调用 AIDL 方法的应用程序的构建路径中包含带有 AIDL 的应用程序。因此，在我的情况下，A 在其构建路径中包含 B。为了让 B 能够向 A 发送一些东西，按照这种逻辑，B 在其构建路径中需要 A。这将创建一个循环。

我被困在这一点上。我想不出解决这个循环的方法。

**- - 编辑 - -**

因此，我遵循以下评论之一中提到的建议，我有以下代码在 IPCAIDL 项目中，AIDL 文件驻留，其内容是

```
package ipc.android.aidl;
interface Iaidl{
        boolean pushBoolean(boolean flag);
 } 
```

该项目在 IPCServer 和 IPC Client 中都被用作库。

IPCServer 项目具有定义 AIDL 方法发生的情况的服务。该文件是 booleanService.java

```
 package ipc.android.server;

 import ipc.android.aidl.Iaidl;
 import android.app.Service;
 import android.content.Intent;
 import android.os.IBinder;
 import android.os.RemoteException;
 import android.util.Log;

   public class booleanService extends Service {

@Override
public IBinder onBind(Intent intent) {
    return new Iaidl.Stub() {

        @Override
        public boolean pushBoolean(boolean arg0) throws RemoteException {
            Log.i("SERVER(IPC AIDL)", "Truth Value:"+arg0);
            return arg0;
        }
    };
  }

  } 
```

调用此方法的 IPCClient 文件是

```
 package ipc.android.client2;

   import ipc.android.aidl.Iaidl;
   import android.app.Activity;
   import android.content.ComponentName;
   import android.content.Context;
   import android.content.Intent;
   import android.content.ServiceConnection;
   import android.os.Bundle;
   import android.os.IBinder;
   import android.os.RemoteException;
   import android.view.View;
   import android.widget.Button;

   public class IPCClient2Activity extends Activity {

Button b1;
Iaidl iAIDL;
boolean k = false;
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    bindService(new Intent("ipc.android.server.booleanService"), conn, Context.BIND_AUTO_CREATE);
    startService(new Intent("ipc.android.server.booleanService"));

    b1 = (Button) findViewById(R.id.button1);

    b1.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            if(k){
                k = false;
            }
            else{
                k = true;
            }
            try {
                iAIDL.pushBoolean(k);
            } catch (RemoteException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }               
        }
    });
}

private ServiceConnection conn = new ServiceConnection() {

    @Override
    public void onServiceDisconnected(ComponentName name) {
        // TODO Auto-generated method stub

    }

    @Override
    public void onServiceConnected(ComponentName name, IBinder service) {
        iAIDL = Iaidl.Stub.asInterface(service);
    }
};
  } 
```

IPCServer 的清单文件包括服务的声明。清单文件如下

```
<?xml version="1.0" encoding="utf-8"?>
   <manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="ipc.android.server"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="15" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" >
        <activity
            android:name=".IPCServerActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <service android:name=".booleanService">
            <intent-filter>
                <action android:name="ipc.android.server.booleanService">
                </action>
            </intent-filter>
            </service>
    </application>

   </manifest> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T23:06:44.547

您只需要在两个项目中包含 AIDL 规范（无需引用所有其他项目）。您可以保留一份 AIDL 副本并在两个项目中引用该副本。如果您使用的是 Eclipse，请找到构建路径属性并将包含 AIDL 的目录添加为源目录。

# xampp - Windows 7 上 XAMPP 1.7.7 的 MySQL 配置问题

> ID：11335814
> 
> 赞同：1
> 
> 时间：2012-07-04T21:57:11.880
> 
> 标签：xampp

刚刚下载了适用于 Windows 的 MySQL 工作台并安装了 XAMPP 1.7.7，但无法启动 MySQL。我确实意识到它是因为 MySQL 已经在使用端口 3306（它说了很多）但是我如何正确配置它们？

当我在尝试将 MySQL 切换为返回 0 后检查状态时：

> MySql 启动 [端口 3306] XAMPP 应用程序状态 1.1.2.2 httpd 状态 1 服务 0 启动 0 线程 0 OP 0 端口 80 mysql 状态 0 服务 0 启动 0 线程 0 OP 0 端口 3306 ftp 状态 1 服务 0 启动 0 线程 0 OP 0 端口21 水银状态 0 服务 0 启动 0 线程 0 OP 0 端口 25 java 状态 0 服务 0 启动 0 线程 0 OP 0 端口 8080

我最近也安装了

我试过关注这个线程并做了它的建议无济于事：

[首次安装后 XAMPP Apache 和 MySQL 服务未启动或停止](https://stackoverflow.com/questions/10259737/xampp-apache-and-mysql-services-not-starting-or-stopping-after-first-installation)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T22:36:48.257

我之前在 Windows 7 中遇到过同样的问题。要重新启动 MySQL，请尝试通过启动并在查找框中键入“服务”来运行 Windows 服务。

您需要打开组件服务程序，然后导航到“服务（本地）”文件夹。在中间面板中找到“mysql”列表，然后右键单击它并选择“start”或“restart”强制它运行。

Workbench 实际上不会占用端口 3306，因此它不应该是问题的原因。

为了让 Workbench 连接（是的，有时它很挑剔），通过转到选项卡数据库 -> 管理连接来创建连接。

单击“新建”，然后填写以下详细信息：

```
Connection Method: Standard (TCP/IP)
Hostname: localhost
Port: 3306
Username: <whatever your XAMPP MySQL username is> 
```

单击“测试连接”，您应该会收到 MySQL 密码的提示。希望它应该表明您可以连接到数据库。

祝你好运！

# javascript - Chrome 扩展 - onRequest/sendRequest 与 onMessage/sendMessage

> ID：11335815
> 
> 赞同：21
> 
> 时间：2012-07-04T21:57:18.350
> 
> 标签：javascript, google-chrome, google-chrome-extension

查看由[Chrome 扩展中心](http://developer.chrome.com/extensions/devguide.html)中的一个页面链接的[这个示例扩展](http://src.chromium.org/viewvc/chrome/trunk/src/chrome/common/extensions/docs/examples/api/pageAction/pageaction_by_content/)，我看到他们使用了

```
chrome.extension.onRequest.addListener(onRequest); 
```

在 background.js 页面中以收听 contentscript.js 和

```
 chrome.extension.sendRequest({}, function(response) {}); 
```

在 contentscript.js 中，以便与 background.js 页面对话。

但是我在网络上的任何地方都找不到这些功能的文档，而且谷歌的[消息传递指南](http://developer.chrome.com/extensions/messaging.html)只提到了

```
chrome.extension.sendMessage(...) 
```

发送，和

```
chrome.extension.onMessage.addListener(...) 
```

听。

**我应该使用哪些功能？sendRequest/onRequest 过时了吗？Google 的开发指南是否仍然是最新的？**

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-07-04T22:35:33.483

它似乎`sendMessage`更受青睐`sendRequest`，将被弃用：[http ://codereview.chromium.org/9965005/](http://codereview.chromium.org/9965005/)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-08-08T16:31:37.347

另请注意 API 路径从

*   chrome.extension.onRequest
*   chrome.extension.sendRequest

到

*   chrome.runtime.onMessage
*   chrome.runtime.sendMessage

将使您免于因例如 chrome.extension.onMessage 无法正常工作而感到沮丧！

# math - 如何缩放贝塞尔曲线（使用 HTML5 画布）？

> ID：11335819
> 
> 赞同：4
> 
> 时间：2012-07-04T21:57:45.167
> 
> 标签：math, canvas, drawing, bezier

我有一个贝塞尔路径存储为几个点的数组，每个点都是 [cp1x,cp1y,cp2x,cp2y,x,y] 形式的坐标数组。

我希望能够上下缩放这条路径以调整其大小，但我不知道这样做的数学。我尝试对每个坐标值应用一个系数，但这似乎不起作用。

有谁知道如何实现这一目标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T22:24:44.630

在标准表示中，点**P**代表空间中的实际点，因此您可以像任何其他点一样移动它们。那就是对它们进行缩放，只需将所有内容乘以缩放因子：说它是`a`，那么就是`[a*cp1x,a*cp1y,a*cp2x,a*cp2y,a*x,a*y]`，或者如果你想单独缩放`x`，你可以对和组件`y`使用不同的因子。`x``y`

另请注意，这将相对于 origin 缩放事物`(x=0, y=0)`，因此如果您在原点没有任何曲线，它可能看起来像移位。如果您想否定这种转变的影响，您可以分别从和值 中减去`Px`和，其中和是您在缩放时不希望移动的点，然后再进行缩放（然后在您多次添加它之后，如果您想要）。但是，如果您要做的是缩放整个画布，例如从 5x5 英寸到 7x7，那么您会希望在没有任何变化的情况下进行乘法运算（在本例中为 7./5）。`Py``x``y``Px``Py`

# ruby-on-rails - 带有 has_many 的 counter_cache

> ID：11335824
> 
> 赞同：1
> 
> 时间：2012-07-04T21:58:18.463
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, activerecord, ruby-on-rails-3.1

我读过这是不可能的，然后其他人告诉我这是不可能的。他们给了我这段代码，但后来不得不走了，现在我的应用程序坏了，直到我让它工作：/

我有一个标签模型，每个标签都有很多资源：通过 => 资源标签。每个资源也有_many 标签。

我需要知道每个标签拥有的资源数量（我不关心其他方式）。

问题是它说unkown key cache_counter

这是我的模型

标签.rb

```
 has_many :resource_tags, :dependent => :destroy, :counter_cache => :resource_count
  has_many :resources, :through => :resource_tags 
```

资源.rb

```
 has_many :resource_tags, :dependent => :destroy
  has_many :tags, :through => :resource_tags 
```

我的迁移：

```
class CreateTags < ActiveRecord::Migration
  def change
    create_table :tags do |t|

      t.string  :name
      t.integer :resource_count, :default => 0

      t.timestamps
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T22:36:06.650

`:counter_cache`选项用于`belongs_to`方法

在 resorce_tag 模型中

```
belongs_to :tag, :counter_cache => :resource_count 
```

我认为最好命名列`resources_count`（复数）

# python - 使用 urllib3 进行身份验证

> ID：11335825
> 
> 赞同：10
> 
> 时间：2012-07-04T21:58:25.213
> 
> 标签：python, authentication, urllib3

我正在尝试使用 urllib3 连接到网页。下面提供了代码。

```
import urllib3
http=urllib3.PoolManager()
fields={'username':'abc','password':'xyz'}
r=http.request('GET',url,fields) 
```

如果我们假设 url 是一些需要使用用户名和密码进行身份验证的网页，我是否使用正确的代码进行身份验证？

我已经很舒服地使用 urllib2 做到了这一点，但我无法使用 urllib3 做同样的事情。

非常感谢

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-07-09T02:56:43.993

假设您正在尝试执行[Basic Authentication](http://en.wikipedia.org/wiki/Basic_authentication)，那么您需要将编码的用户名和密码放入`Authorization`标头中。这是使用[urllib3.make_headers](https://urllib3.readthedocs.io/en/latest/reference/index.html#urllib3.make_headers)帮助器的一种方法：

```
import urllib3

http = urllib3.PoolManager()
url = '...'
headers = urllib3.make_headers(basic_auth='abc:xyz')
r = http.request('GET', url, headers=headers) 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2020-08-17T18:04:30.700

下面是一个使用请求库（带有 python 3.6 的 ubuntu）对 API 进行身份验证的工作示例。希望能帮助到你！

```
import json
import requests
from requests.auth import HTTPBasicAuth

def __init__(self):
    header = {"Content-Type": "application/json"}
    access_url = "https://your.login.url/context_path"
    data = {
    "key_to_send":"value_to_send"
    }

def get_token(self):
    self.data = json.dumps(self.data)
    encoded_data = json.dumps(self.data).encode('utf-8')
    self.response = requests.post(self.access_url, auth=HTTPBasicAuth(self.username, self.password), headers=self.header, data=self.data)
    # Show me what you found
    print(self.response.text) 
```

# delphi - 如何一次将“Sender”参数与“As”运算符一起用于一个以上的类？

> ID：11335829
> 
> 赞同：5
> 
> 时间：2012-07-04T22:00:00.567
> 
> 标签：delphi, oop, sender, as-operator

在Delphi中，有时我们需要这样做......

```
function TForm1.EDIT_Click(Sender: TObject);
begin
  (Sender As TEdit).Text := '';
end; 
```

...但有时我们需要使用其他对象类重复该功能，例如...

```
function TForm1.COMBOBOX_Click(Sender: TObject);
begin
  (Sender As TComboBox).Text := '';
end; 
```

...因为运营商`As`不接受灵活性。它必须知道类才能`.Text`允许`()`.

有时代码会充满相似之处`functions`，`procedures`因为我们需要使用我们无法指定的相似视觉控件来做同样的事情。

*这只是一个使用示例。通常，我将这些代码用于更复杂的代码，以在许多控件和其他类型的对象上实现标准目标。*

**是否有替代方案或技巧可以使这些任务更加灵活？**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-05T04:16:45.597

使用 RTTI 对不相关类的同名属性执行常见任务，例如：

```
Uses
 ..., TypInfo;

// Assigned to both TEdit and TComboBox
function TForm1.ControlClick(Sender: TObject);
var
  PropInfo: PPropInfo;
begin
  PropInfo := GetPropInfo(Sender, 'Text', []);
  if Assigned(PropInfo) then
    SetStrProp(Sender, PropInfo, '');
end; 
```

在某些情况下，一些控件使用`Text`而另一些则使用`Caption`，例如；

```
function TForm1.ControlClick(Sender: TObject);
var
  PropInfo: PPropInfo;
begin
  PropInfo := GetPropInfo(Sender, 'Text', []);
  if not Assigned(PropInfo) then
    PropInfo := GetPropInfo(Sender, 'Caption', []);
  if Assigned(PropInfo) then
    SetStrProp(Sender, PropInfo, '');
end; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-04T22:02:39.253

你可以使用`is`运算符，试试这个示例

```
 if Sender is TEdit then
  TEdit(Sender).Text:=''
 else
 if Sender is TComboBox then
  TComboBox(Sender).Text:=''; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-05T03:48:24.530

**您可以通过使用absolute**关键字来消除混乱的类型转换，该关键字允许您声明不同类型的变量占用相同的内存位置，在这种情况下与事件参数的位置相同。

您仍然需要使用“is”执行类型检查，但在其他方面，这种方法更简洁但同样安全。

```
procedure TMyForm.ControlClick(Sender: TObject);
var
  edit: TEdit absolute Sender;
  combo: TComboBox absolute Sender;
   :
begin
  if Sender is TEdit then
    edit.Text := ''
  else if Sender is TComboBox then
    combobox.Text := ''
  else
   :
end; 
```

大约3 年前，我在我的博客中[更详细地介绍了使用此语言功能。](http://www.deltics.co.nz/blog/?p=586)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-05T18:22:21.603

我将我的评论作为答案发布，因为我在这里看不到任何提到这一点的答案。SetTextBuf 是 TControl 的公共方法。此方法用于通过 SetText 窗口消息填充内部文本数据成员。这就是 TControl 后代更新 Caption 和 Text 属性的方式。因此所有 TControl 后代，例如 TButton、TEdit、TComboBox 都将使用以下类型的代码工作。而且您不必使用 RTTI。

```
function TForm1.EDIT_Click(Sender: TObject);
begin
  (Sender as TControl).SetTextBuf('Text or Caption'); // will work for both the Caption and text property
end; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-05T10:52:28.657

我不知道您是否将 tag 属性用于任何用途，但它对这些情况很有用。将所有 Tedits 的标签设置为 1 并将所有 Tcomboboxes 的标签设置为 2 等可以让你这样做：

```
if Sender is TControl then
  Case TControl(Sender).tag of
    1: TEdit(sender).text := '';
    2: Tcombobox(sender).text := '';
    3....etc
  end; 
```

只是一个想法，它看起来更整洁，更容易阅读/调试:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-28T02:57:54.410

感谢你们，特别是@RemyLebeau，我可以使这个通用功能适用于任何类型的 Win 控件或数据库控件。如果它是必需的但为空，如果它在数据库中有重复的信息，或者我们想要检查的任何其他条件，它会将控件变为红色（或您想要的任何颜色）。它返回数字而不是真假，因此我们可以在多次检查结束时只发送一条消息，并告诉用户他/她犯了多少错误。

```
function CheckInput(Control: TWinControl; Condition: Boolean; EmptyState: Integer; Msg: String): Integer;
var
  PropInfo: PPropInfo;
begin
{ os controles que precisam passar por condições para que seu conteúdo seja aceito }
  Result := 0;
  if EmptyState = ciNotEmpty then
  begin
    PropInfo := GetPropInfo(Control, 'Text', []);
    if Assigned(PropInfo) then
    begin
      if GetStrProp(Control, PropInfo) = '' then
      begin
        Condition := False;
        Msg := ciEmptyMsg;
      end;
    end;
  end;
  if not Condition then
  begin
    Result := 1;
    PropInfo := GetPropInfo(Control, 'Color', []);
    if Assigned(PropInfo) then SetPropValue(Control, PropInfo, ciErrorColor);
    if Msg <> '' then ShowMessage(Msg);
  end
  else
  begin
    PropInfo := GetPropInfo(Control, 'Color', []);
    if Assigned(PropInfo) then SetPropValue(Control, PropInfo, ciNormalColor);
  end;
end; 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-07-05T06:44:56.157

如果你一直往下走，你会注意到 TEdit 和 TCombobox 都从 TControl 下降。如果您查看他们使用哪种方法来设置文本，那么您会发现它是 TControl 实现的方法。这就是为什么你可以做一些丑陋的事情，比如：

```
if (sender is TEdit) or (sender is TComboBox) then
  TEdit(sender).Text:='test'; 
```

您必须确保您放入此处的所有对象在**内部**使用相同的方法，否则您的应用程序将以神秘的方式中断。

# python - 从当前目录的父目录的另一个子目录导入另一个模块（python）

> ID：11335830
> 
> 赞同：0
> 
> 时间：2012-07-04T22:00:01.143
> 
> 标签：python, import, module, path

我正在尝试编写游戏。因此，我有许多不同类型的代码，并希望将它们安排在一个有用的层次结构中。

我已经查看了涉及放置`__init__.py`在每个文件夹中的解决方案，但我仍然有些困惑，尽管不如 python 解释器那么多。

现在假设`resource1.py`想要从目录中导入一个函数`physics1.py`，或者实际上是目录中的任何其他`.py`文件，`Game`我该怎么做呢？

我已经尝试过`from bin.physics.physics1 import function`，但显然这不起作用。

谢谢你的帮助。

```
/Game
    launcher.py
    /bin
        game.py
        __init__.py
        /physics
            __init__.py
            physics1.py
            physics2.py
    /resources
        __init__.py
        resource1.py 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T22:16:40.023

`Game`除非您制作一个包（即，通过`__init__.py`在`Game`目录中放置一个） ，否则正常的导入机制是不可能的。python 相对导入系统仅适用*于 packages*。它不是通过目录结构中的位置来引用任意模块的通用系统。如果你把 Game 做成一个包，那么你可以做`from ..bin.physics.physics1 import function`.

编辑：另请注意，相对导入不适用于作为主程序执行的脚本。如果您尝试`resource.py`直接运行并且它使用相对导入，您将收到“在非包中尝试相对导入”错误。如果您从另一个模块导入资源，它将起作用。这是因为相对导入系统基于执行模块的“名称”，当您直接运行脚本时，它的名称是它的名称，`__main__`而不是通常的名称。[如果你真的需要，可以使用`__package__`关键字](http://www.python.org/dev/peps/pep-0366/)来解决这个问题，但这可能有点棘手。

# c# - 在 Winform 应用程序中打印多页

> ID：11335831
> 
> 赞同：1
> 
> 时间：2012-07-04T22:00:04.230
> 
> 标签：c#, printdocument

我正在尝试使用 C# Winforms 应用程序打印一些东西。我似乎无法理解多页是如何工作的。假设我的构造函数中有以下代码：

```
private string _stringToPrint;
_stringToPrint = "";
for (int i = 0; i < 120; i++)
{
    _stringToPrint = _stringToPrint + "Line " + i.ToString() + Environment.NewLine;
} 
```

然后我的按钮点击事件上有这个代码：

```
private void MnuFilePrintClick(object sender, EventArgs e)
{
    var pd = new PrintDocument();
    pd.PrintPage += pd_PrintPage;

    var z = new PrintPreviewDialog { Document = pd };

    z.ShowDialog(this);
}

void pd_PrintPage(object sender, PrintPageEventArgs e)
{
    Graphics g = e.Graphics;
    var font = new Font("Arial", 10f, FontStyle.Regular);

    g.DrawString(_stringToPrint, font, Brushes.Black, new PointF(10f, 10f));
} 
```

现在，当我运行这段代码时，它给了我一页，大约 70 行之后，它就从纸上跑掉了。我将如何打印这个字符串，以便它打印足够的一页，然后运行到第二页，等等......？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T22:19:08.047

您可以有一个计数器并设置每页所需的行数，如下所示：

```
private string[] _stringToPrint = new string[100]; // 100 is the amount of lines
private int counter = 0;
private int amtleft = _stringToPrint.Length;
private int amtperpage = 40; // The amount of lines per page
for (int i = 0; i < 120; i++)
{
    _stringToPrint[i] ="Line " + i.ToString();
} 
```

然后在`pd_PrintPage`：

```
void pd_PrintPage(object sender, PrintPageEventArgs e)
{
    int currentamt = (amtleft > 40)?40:amtleft;
    Graphics g = e.Graphics;
    var font = new Font("Arial", 10f, FontStyle.Regular);
    for(int x = counter; x < (currentamt+counter); x++)
    {
        g.DrawString(_stringToPrint[x], font, Brushes.Black, new PointF(10f, (float)x*10));
        // x*10 is just so the lines are printed downwards and not on top of each other
        // For example Line 2 would be printed below Line 1 etc
    }
    counter+=currentamt;
    amtleft-=currentamt;
    if(amtleft<0)
        e.HasMorePages = true;
    else
        e.HasMorePages = false;
    // If e.HasMorePages is set to true and the 'PrintPage' has finished, it will print another page, else it wont
} 
```

我有过不好的经历，`e.HasMorePages`所以这可能行不通。

让我知道这是否有效，我希望它有所帮助！

# grails - 基于登录方法的Grails spring安全授权授权

> ID：11335834
> 
> 赞同：1
> 
> 时间：2012-07-04T22:00:11.373
> 
> 标签：grails, spring-security

我有一个应用程序，用户应该根据 2 种替代登录方法访问网站的不同部分，一种是基本的 daoAuthentication，另一种是自定义登录方法。

两种方法都可以完美地工作，但我不确定如何通过来识别用户如何登录。理想情况下，我希望能够创建类似于内置规则的东西（IS_AUTHENTICATED_ANONYMOUSLY，IS_AUTHENTICATED_REMEMBERED，IS_AUTHENTICATED_FULLY），这会很棒如果我可以在某处添加 IS_AUTHENTICATED_CUSTOM_AUTH。

# javascript - 谷歌浏览器错误？

> ID：11335835
> 
> 赞同：20
> 
> 时间：2012-07-04T22:00:39.687
> 
> 标签：javascript, google-chrome

此消息一直出现在 chrome 开发人员工具的控制台中：

```
Port error: Could not establish connection. Receiving end does not exist. miscellaneous_bindings:232
chromeHidden.Port.dispatchOnDisconnect miscellaneous_bindings:232
Error in event handler for 'undefined': Cannot read property 'instanceId' of undefined TypeError: Cannot read property 'instanceId' of undefined
    at [object Object].<anonymous> (chrome-extension://mgijmajocgfcbeboacabfgobmjgjcoja/content_js_min.js:2:372)
    at chrome-extension://mgijmajocgfcbeboacabfgobmjgjcoja/content_js_min.js:1:182
    at miscellaneous_bindings:276:11
    at [object Object].dispatch (event_bindings:203:41)
    at Object.<anonymous> (miscellaneous_bindings:235:27) event_bindings:207
chrome.Event.dispatch event_bindings:207
chromeHidden.Port.dispatchOnDisconnect miscellaneous_bindings:235 
```

这是 chrome 中的错误还是我的 chrome 安装有问题？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-07-04T22:05:17.740

这似乎是[谷歌词典的问题（谷歌）](https://chrome.google.com/webstore/detail/mgijmajocgfcbeboacabfgobmjgjcoja)

[该脚本](https://chrome.google.com/webstore/detail/mgijmajocgfcbeboacabfgobmjgjcoja/content_js_min.js)似乎不存在或该端口无法访问。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-03T09:11:09.347

根据一些谷歌搜索，这是 chrome 扩展的问题，但可能不清楚是哪个。（对我来说，它是 Feedly）。

找出导致问题的最快方法：

1.  禁用所有 chrome 扩展。（Chrome 菜单 > 工具 > 扩展）
2.  刷新页面 - 希望端口错误现在应该消失
3.  一个个重新启用你的扩展，每次刷新页面，直到控制台再次弹出错误。你现在应该找到罪魁祸首了。

我知道如果有很多扩展，这可能会很痛苦：/就我个人而言，我把它当作一个机会来修剪未使用的/不值得的扩展，而我正在经历它们。

# r - 增加轴刻度数

> ID：11335836
> 
> 赞同：239
> 
> 时间：2012-07-04T22:00:58.843
> 
> 标签：r, ggplot2

我正在为一些数据生成图，但刻度数太少，我需要更*精确*的读数。

有什么方法可以增加 ggplot2 中的轴刻度数吗？

我知道我可以告诉 ggplot 使用向量作为轴刻度，但我想要的是增加所有数据的刻度数。换句话说，我希望从数据中计算出刻度数。

可能 ggplot 在内部使用某种算法执行此操作，但我找不到它是如何做到的，以根据我想要的进行更改。

* * *

## 回答 #1

> 赞同：231
> 
> 时间：2012-07-04T22:15:36.613

`scale_x_continuous`您可以通过修改和/或覆盖 ggplots 默认比例`scale_y_continuous`。例如：

```
library(ggplot2)
dat <- data.frame(x = rnorm(100), y = rnorm(100))

ggplot(dat, aes(x,y)) +
  geom_point() 
```

给你这个：

![在此处输入图像描述](../Images/4b00c2714592f75569eccdb305e44d16.png)

覆盖尺度可以给你这样的东西：

```
ggplot(dat, aes(x,y)) +
  geom_point() +
  scale_x_continuous(breaks = round(seq(min(dat$x), max(dat$x), by = 0.5),1)) +
  scale_y_continuous(breaks = round(seq(min(dat$y), max(dat$y), by = 0.5),1)) 
```

![在此处输入图像描述](../Images/716b36d4428d862e46ee07ee43201c42.png)

如果您想简单地“放大”绘图的特定部分，请分别查看`xlim()`和`ylim()`。[在这里](http://had.co.nz/ggplot2/scale_continuous.html)也可以找到很好的洞察力来理解其他论点。

* * *

## 回答 #2

> 赞同：212
> 
> 时间：2015-07-14T13:45:47.200

根据[Daniel Krizian 的评论](https://stackoverflow.com/questions/11335836/increase-number-of-axis-ticks-in-ggplot2#comment32214370_17257422)，您还可以使用库中自动导入的[`pretty_breaks`](https://www.rdocumentation.org/packages/scales/versions/0.4.1/topics/pretty_breaks)函数：`scales`

```
ggplot(dat, aes(x,y)) + geom_point() +
scale_x_continuous(breaks = scales::pretty_breaks(n = 10)) +
scale_y_continuous(breaks = scales::pretty_breaks(n = 10)) 
```

您所要做的就是插入所需的刻度数`n`。

* * *

一个不太有用的解决方案（因为您必须再次指定数据变量），您可以使用内置`pretty`函数：

```
ggplot(dat, aes(x,y)) + geom_point() +
scale_x_continuous(breaks = pretty(dat$x, n = 10)) +
scale_y_continuous(breaks = pretty(dat$y, n = 10)) 
```

* * *

## 回答 #3

> 赞同：68
> 
> 时间：2013-06-23T03:16:15.473

您可以为 提供一个函数参数`scale`，ggplot 将使用该函数来计算刻度位置。

```
library(ggplot2)
dat <- data.frame(x = rnorm(100), y = rnorm(100))
number_ticks <- function(n) {function(limits) pretty(limits, n)}

ggplot(dat, aes(x,y)) +
  geom_point() +
  scale_x_continuous(breaks=number_ticks(10)) +
  scale_y_continuous(breaks=number_ticks(10)) 
```

* * *

## 回答 #4

> 赞同：37
> 
> 时间：2020-01-13T22:29:49.827

从 v3.3.0 开始，`ggplot2`可以选择`n.breaks`自动为`scale_x_continuous`和`scale_y_continuous`

```
 library(ggplot2)

    plt <- ggplot(mtcars, aes(x = mpg, y = disp)) +
      geom_point()

    plt + 
      scale_x_continuous(n.breaks = 5) 
```

[![在此处输入图像描述](../Images/0f797ec1358f66ba7e87db8b4662f0e1.png)](https://i.stack.imgur.com/RUxXg.png)

```
 plt + 
      scale_x_continuous(n.breaks = 10) +
      scale_y_continuous(n.breaks = 10) 
```

[![在此处输入图像描述](../Images/afa4ec2a23b1ecec2de68372622ff3d6.png)](https://i.stack.imgur.com/pyTrw.png)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2018-01-29T16:28:24.813

此外，

```
ggplot(dat, aes(x,y)) +
geom_point() +
scale_x_continuous(breaks = seq(min(dat$x), max(dat$x), by = 0.05)) 
```

适用于分箱或离散缩放的 x 轴数据（即，不需要舍入）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2021-10-02T04:47:45.513

对此问题的答复以及[如何在 R ggplot 中以相等的间隔在 X 和 Y 轴上设置标签？](https://stackoverflow.com/questions/69410603/how-set-labels-on-the-x-and-y-axises-by-equal-intervals-in-r-ggplot)

```
mtcars %>% 
  ggplot(aes(mpg, disp)) +
  geom_point() +
  geom_smooth() + 
  scale_y_continuous(limits = c(0, 500),
                     breaks = seq(0,500,50))  +
  scale_x_continuous(limits = c(0,40),
                     breaks = seq(0,40,5)) 
```

# c++ - 将循环系统转换为单个方程

> ID：11335838
> 
> 赞同：0
> 
> 时间：2012-07-04T22:01:11.673
> 
> 标签：c++, nested-loops

我一直在尝试将一组嵌套循环转换为一个方程，需要一些帮助。

计算我的序列的代码如下：

`

```
int Astart = 1;
int Bstart = 1;
int Cstart = 1;
int Dstart = 1;

int Ai = 6;
int Bi = 2;
int Ci = 3;
int Di = 4;

int A,B,C,D = 0;

int i=0;
for(int a=Astart;a<Astart+Ai; a++)
{
    for(int b=Bstart;b<Bstart+Bi; b++)
    {
        for(int c=Cstart;c<Cstart+Ci;c++)
        {
            for(int d=DStart;d<Dstart+Di;d++)
            {
                std::cout << "[" << i << "]" << a << " " << b << " " << c << " " << d << std::endl;
                i++;
            }
        }
    }
} 
```

`

我需要做的就是让一个 for 循环运行排列的数量来复制嵌套循环的行为。IE

```
for(int i=0; i<(Ai*Bi*Ci*Di); i++)
{

<Insert equations here!>

} 
```

我真正想要的是一个函数，它在序列中取一个整数，并根据变量 Ai、Bi、Ci、Di 和 Astart、Bstart、Cstart、Dstart 计算 A、B、C 和 D 的值。

此外，这个系统依赖于嵌套循环的顺序，有没有一种方法不依赖于顺序来获取值 A、B、C、D？

任何帮助都会很棒，

谢谢，

克里斯。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T22:04:18.917

使用除法 ( `/`) 和余数 ( `%`) 运算符。

```
93 / 10 = 9
93 % 10 = 3 
```

...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T22:09:09.437

变量`A`、`B`、`C`和`D`始终为零，因为您将它们初始化并且不再使用它们。

# mysql - 插入语句不插入似乎找不到问题

> ID：11335842
> 
> 赞同：1
> 
> 时间：2012-07-04T22:01:43.820
> 
> 标签：mysql

我正在尝试编写一个简单的 INSERT 语句来将新用户添加到数据库中，但它无法正常工作，这意味着我尝试插入到表中的数据都没有被插入。我已经尝试解决这个问题几个小时了，但没有成功。我编写插入语句的尝试如下，它们对我来说看起来是正确的，所以我很难排除故障。插入语句中的所有列都存在于我的表中，并且按确切的顺序排列。如果有人可以建议可能是什么问题，我将不胜感激。

我的连接

```
//Create mysql connect variable
$conn = mysql_connect('1122334455.host.com', 'john', 'password');

//kill connection if error occurs
if(!$conn){

    die('Error: Unable to connect.' . '<br>' . mysql_error());
}
//connect to mysql database
mysql_select_db("jefffffff89", $conn); 
```

到目前为止我尝试过的 INSERT 语句：

尝试1：

```
mysql_query("INSERT INTO users (id, email, company-name, city, state, phone, password, first, last)
           VALUES('','hello@gmail.com','johnnys inc','main','NY','443-333-3444','1234567','matt','williams')",$conn); 
```

尝试2：

```
$query = "INSERT INTO users (id, email, company-name, city, state, phone, password, first, last)
               VALUES('','hello@gmail.com','johnnys inc','main','NY','443-333-3444','1234567','matt','williams')";
        mysql_query($query,$conn); 
```

我能够轻松地将一条记录添加到下表中，并且它工作得很好（所以，我按照上面的相同逻辑插入，但它没有成功插入）：

```
mysql_query("INSERT INTO log (log_id, txn_id, email) VALUES('','hello','world')", $conn); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T22:04:46.487

您的列名之一包含连字符：

```
mysql_query("INSERT INTO users (id, email, company-name, city, ..."); 
```

假设这是故意的，你需要用反引号来逃避它：

```
mysql_query("INSERT INTO users (id, email, `company-name`, city, ...");
#                                          ^            ^ 
```

但是，最好将列更改为不包含连字符的名称。

# php - PHP 多页表单会话数据在 2 次导航后丢失

> ID：11335843
> 
> 赞同：1
> 
> 时间：2012-07-04T22:01:47.080
> 
> 标签：php, html, forms, multipage

我有一个正在构建的多页表单网站。

我在用

```
$_SESSION['X']=$_POST['X'] 
```

将表单中的变量存储到结果发布到的页面上的会话中。

表单是动态生成的，以便使用会话变量填充字段

```
$X=$_SESSION['X'] 
```

和

```
(value="$X") 
```

这样，当用户单击返回（带有页面 URL 的按钮，而不是历史记录 -1）时，页面将使用他们之前输入的值进行重组。

我的问题是这适用于一页（即他们可以返回一页并查看值），但是 2 页所有值都是空白的。

一旦值存储在 SESSION 中，它们不应该在浏览器会话期间保留吗？它们不会被覆盖。我误解了会话吗？任何帮助表示赞赏。

代码示例：

第 1 页：

```
session_start();

//populates fields if session value set for this variable 
$sv_01=$_SESSION['sv_01'];

<<<EOT
<form action="page 2 URL" method="post">
<label> q1 <input value=$sv_01 title="title" type="text" name="sv_01">

<input type="submit" value="Continue" />
</form>
EOT; 
```

第2页：

```
session_start();
//stores POST data from page 1 in the session
$_SESSION['sv_01']=$_POST['sv_01']

//populates fields if session value set for this variable 
$sv_02=$_SESSION['sv_02'];

<<<EOT
<form action="page 3 URL" method="post">
<label> q2 <input value=$sv_02 title="title" type="text" name="sv_02">

<input onclick="page 1 URL';" type="button" value="Back" /> <input type="submit" value="Continue" />    
</form>
EOT; 
```

第 3 页：

```
session_start();
//stores POST data from page 2 in the session
$_SESSION['sv_02']=$_POST['sv_02']

//populates fields if session value set for this variable 
$sv_03=$_SESSION['sv_03'];

<<<EOT
<form action="page 4 URL" method="post">
<label> q3 <input value=$sv_03 title="title" type="text" name="sv_03">

<input onclick="page 2 URL';" type="button" value="Back" /> <input type="submit" value="Continue" />    
</form>
EOT; 
```

从第 3 页移到第 2 页会很好 - 第 2 页也可以移到第 1 页，但是从第 3 页移到第 1 页会导致第 1 页为空白。

有任何想法吗？非常感激

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T00:20:01.303

可能您正在使用来自的值覆盖`$_SESSION`var ，因为如果您使用链接从 Page3.php 跳转到 Page2.php，则内容不存在。`NULL``$_POST``$_POST`

因此，您可以`$_POST`在将其值分配给`$_SESSION`. 像这样的代码：

**第2页.php**

```
if( isset($_POST['sv_01'])
    $_SESSION['sv_01']=$_POST['sv_01']; 
```

**第3页.php**

```
if( isset($_POST['sv_02']) )
    $_SESSION['sv_02']=$_POST['sv_02']; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T23:14:19.720

也许尝试检查是否首先设置了 $_POST 成员。

代替：

```
$_SESSION['sv_01']=$_POST['sv_01'] 
```

尝试

```
if (isset($_POST['sv_01'])) {
  $_SESSION['sv_01']=$_POST['sv_01']
} 
```

# css - 相对于其他元素居中文本？

> ID：11335847
> 
> 赞同：-1
> 
> 时间：2012-07-04T22:02:30.707
> 
> 标签：css, image

我想要一排带有文字的图片链接，文字以图片为中心，类似于[苹果网站](http://apple.com/mac)上的产品选择器。有没有办法做到这一点，而不为每个“项目”制作一个 div 并将其集中在 div 中？HTML/CSS strict 会很好，但 Javascript、jQuery 等会很好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T22:09:44.300

它不需要特别是 a `<div>`，它可以是任何具有`display: inline-block`（或`block`，但你必须浮动它们以将它们排列在同一行中）的元素。

**[例子](http://jsfiddle.net/znByV/)**。

# asp.net-mvc - 创建表单提交后检查的项目列表

> ID：11335848
> 
> 赞同：0
> 
> 时间：2012-07-04T22:02:31.403
> 
> 标签：asp.net-mvc

我在这里使用 MVC 4，并且我有一个从 XML 文件生成的活动列表的页面。可以检查超过 1 个活动，并且在每个活动中，用户可以设置日期、成人/儿童人数。我的计划是当用户点击提交时，所有被检查的活动都被放入一个 ActivityItems 列表中。这是我将 ActivityItem 定义为：

**活动项目类**

```
public class ActivityItem
{
    public string ActivityID { get; set; }
    public string Name { get; set; }
    public string Date { get; set; }
    public int NumAdults { get; set; }
    public int NumChildren { get; set; }
    public decimal TotalPrice { get; set; }
} 
```

我的视图看起来像这样（我去掉了很多样式和格式以使代码更易于阅读）。请注意，@item.ActivityID 从“ACT001”开始，然后是“ACT002”，然后是“ACT003”，以此类推，直到 n 次。

```
@model IEnumerable<Project.Models.Activity>

@using (Html.BeginForm())
{
<ul data-role="listview" data-inset="true">
@foreach (var item in Model)
{
    <li>
        <div class="activity" id="@item.ActivityID">
            <h3>@item.Name</h3>
            <input type="checkbox" id="@item.ActivityID-Check" name="checkbox"/>  

        <label for="select-choice-0" class="select">Date:</label>
        <select name="select-choice-0" id="@item.ActivityID-Date">
            <option value="07/03/2012">07/03/2012</option>
            <option value="07/04/2012">07/04/2012</option>
            <option value="07/05/2012">07/05/2012</option>
            <option value="07/06/2012">07/06/2012</option>
        </select>   

        @Html.DropDownList(item.ActivityID+"-AdultNum", AdultNum)<br />
        Price/Adult C$:@Html.TextBox(item.ActivityID+"-AdultPrice", item.PricePerAdult)

        @Html.DropDownList(item.ActivityID+"-ChildNum", ChildNum)<br /> 
        Price/Child C$: @Html.TextBox(item.ActivityID+"-ChildPrice", item.PricePerChild)

        <label style="color:Blue"><h3>Total Price C$:</h3></label>
        <input type="text" id="@item.ActivityID-Sum" readonly="readonly"/>

        </div> 
    </li>
}
</ul>
<input type="submit" id="submit" value="Submit" />
} 
```

因此，基本上，如果单击特定项目（@item.ActivityID-Check）的复选框并提交表单：

将使用从列表中的活动填充的以下字段创建一个 ActivityItem：

*   项目清单
*   ActivityID = @item.ActivityID
*   名称 = @item.Name
*   日期 = @item.ActivityID-日期
*   NumAdults = @item.ActivityID-AdultNum
*   NumChildren = @item.ActivityID-ChildNum
*   TotalPrice = @item.ActivityID-Sum

但是可以单击多个项目，并且在提交表单时，我需要返回一个 ActivityItems 列表。我觉得这是一个复杂的答案，因此，我不希望有一个完整的解决方案（尽管那会很棒哈哈）。但是，如果我能得到一些提示和指示，那将是一个很大的帮助。我真的很感激所有的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T02:58:06.367

当您想对集合进行模型绑定时，第一件事是输入元素的生成名称应遵循某种模式。

前任。

```
@for (int i = 0; i < 3; i++) 
{
  @Html.TextBoxFor(m => m[i].Title)
  @Html.TextBoxFor(m => m[i].Author)
} 
```

请注意，您应该替换`foreach`为`for`，这将生成一个 html 表单，如下所示，

```
<form method="post" action="/Home/Create">    
    <input type="text" name="[0].Title" value="Curious George" />
    <input type="text" name="[0].Author" value="H.A. Rey" />

    <input type="text" name="[1].Title" value="Code Complete" />
    <input type="text" name="[1].Author" value="Steve McConnell" />

    ...
</form> 
```

在您的情况下，接下来的事情是您必须仅将所选项目绑定到集合。所以你必须做几件事，1.删除未选中的 html 元素 2.重置输入元素的名称以及在表单提交事件中所做的这两件事。

```
$("form").submit(function() {

   // iterate the the activities and remove the ones that are not selected 
   // ex.
   $(this).children('[0].Title').remove();
   $(this).children('[0].Author').remove();

   // again iterate the activities in the form and reset their index values
   // ex.
   $(this).children('[1].Title').attr('name', [0].Title);
   $(this).children('[1].Author').attr('name', [0].Author);
}); 
```

**更新：**

另一种解决方案是您可以创建一个视图模型，该模型包含`ActivityItem`一个布尔标志，表示用户是否选择了特定活动。从发布操作中，您可以过滤用户选择的活动。视图模型在这种情况下很有帮助，这样你就可以避免监听表单提交事件。

```
public class ActivityItemViewModel
{
   public class ActivityItem { get; set; }
   public bool IsSelected { get; set; }
} 
```

视图必须绑定到`IEnumerable<Project.Models.ActivityItemViewModel>`而不是`IEnumerable<Project.Models.Activity>`. 用于选择活动的复选框必须绑定到`IsSelected`属性。

```
@Html.CheckBoxFor(m => m[i].Isselected) 
```

您将有一个控制器操作，将此集合作为输入，

```
public ActionResult PostAction(IEnumerable<Project.Models.ActivityItemViewModel>)
{
    .. now you can easily filter the Activities that are selected by checking the
    .. IsSelected boolean flag
} 
```

# python - 函数返回“无”而不是术语

> ID：11335853
> 
> 赞同：0
> 
> 时间：2012-07-04T22:02:59.347
> 
> 标签：python, web2py

我正在尝试将值从表单传递给函数，对其进行处理，然后在另一个函数中调用该函数。基本上，用户提交一个搜索词。它被传递给一个被调用的函数，该函数`process`将现在处理的术语作为字典返回。在`results`函数中，术语被解析为搜索引擎 API，结果以 HTML 或 JSON 格式返回。但是，该函数`process`返回 none 而不是已处理的术语。谁能告诉我我做错了什么？这是在 web2py 中完成的，所以一些代码可能看起来很奇怪，但我认为问题出在 python 上，而不是 web2py

```
import urllib2

def index():
    form = FORM('',
            INPUT(_name='query', requires=IS_NOT_EMPTY()),
            INPUT(_type='submit'))
    if form.process().accepted:
        redirect(URL('results'))
    elif form.errors:
        response.flash = 'form has errors'
    else:
        response.flash = 'please fill the form'
    return dict(form=form)

def __process():
    term=request.vars.query
    #do some processing
    return dict(term=term)

def results():
    import urllib2
    address = "http://www.blekko.com/?q=%(term)s+/json&auth=<mykey>" % __process()

    results = urllib2.urlopen(address).read()

    return dict(results=results) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T22:28:29.650

这是 web2py 的问题。当您在 web2py 中进行 redirect() 时，request.vars 不会传递到新页面。*会话变量虽然。*

尝试在 form.process().accepted 中打印 request.vars，然后在 __process() 中再次打印。

相反，在 index() 内进行所有处理，然后将结果字典返回到索引视图。然后您可以重定向或打开一个新窗口传递数据。或者，如果您希望保持原样，请将其存储在会话中，以便可以从 __process() 访问。

# javascript - jQuery简单菜单

> ID：11335854
> 
> 赞同：1
> 
> 时间：2012-07-04T22:02:59.970
> 
> 标签：javascript, jquery

我需要创建一个与此相同的菜单：

[http://www.girard-perregaux.com/collection/univers-en.aspx?type=1](http://www.girard-perregaux.com/collection/univers-en.aspx?type=1)

单击集合，然后单击制造商，然后再次单击制造商以关闭。正如您所看到的，它首先向下滑动，然后它只是更改链接而无需再次上下滑动，直到您单击相同的打开元素。

我首先尝试了这个：

```
$('ul.sub-menu').hide();
$('.sf-menu').children('li').click(function(){  
    $(this).children(".sub-menu").slideToggle('slow');
    $('ul.sub-menu').hide(); 
```

它可以工作，但每次单击菜单时都会上下滑动，而不仅仅是更改列表项。所以我发现我需要以某种方式定位子 li 元素而不是 ul。此外，如果您在父列表项之间单击，它需要像在该菜单上一样切换，但如果我再次单击同一个打开的列表项，它需要关闭（向上滑动。）

非常感谢这一点，因为我花了半天时间试图弄清楚。还有如何针对孩子李，我试过这个：

```
$('.sf-menu').children('li').click(function(){  

$(this).children(".sub-menu li") 
```

但什么都没有。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T22:50:16.340

您可以尝试将单击绑定到子菜单并使用`e.stopPropagation()`和：http `e.stopImediatePropagation()`: [//jsfiddle.net/7eCjd/](http://jsfiddle.net/7eCjd/)

```
$menu.find(">li>ul").on("click", function(e) {
    e.stopPropagation();
    e.stopImediatePropagation();
}); 
```

当您单击它们时，这将不允许子菜单关闭。

# python - Python BZ2 Module Sequential decompressor：如何得知完整文件何时解压成功？

> ID：11335857
> 
> 赞同：0
> 
> 时间：2012-07-04T22:03:34.850
> 
> 标签：python, bzip2

我正在使用`bz2.BZ2Decompressor`该类顺序解压缩 bz2 压缩数据流。我的流可能包含截断的压缩数据。我需要能够区分解压缩完整文件和仅解压缩部分文件的情况。有什么办法可以确定吗？

更详细地说，我提供给解压缩函数的数据流可能是也可能不是完整的 bz2 压缩文件。它可能会被截断。当我使用这个函数时，它会返回给我它能够使用数据解压缩的任何数量。它没有告诉我是否已到达流的末尾。我如何确定相同？只有在找到流结束*后*`EOFError`还有其他数据时才会引发。所以这对我没有帮助。

 ** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T05:25:24.397

`decompress()`您可以通过将一些额外的“垃圾”数据传递给解压缩器的方法来检测您的数据流是否完整。如果流已完成，它将引发`EOFError`. 如果流仍在继续，它可能不会引发异常，因为解压缩器将假定垃圾是截断流的一部分。

这是一些示例代码：

```
import bz2

def decompress(stream):
    decompressor = bz2.BZ2Decompressor()

    # this generator decompresses the data from the iterable stream
    results = "".join(decompressor.decompress(data) for data in stream)

    # now we test to see if it was a complete BZ2 stream
    try:
        decompressor.decompress("\0") # try adding a "junk" null character
    except EOFError: # the stream was complete!
        return results
    except IOError: # the junk may cause an IOError if it hits a BZ2 header
        pass

    # if we reach this point here, the stream was incomplete
    print "Incomplete stream!"
    return None # you may or may not want to throw away the partial results 
```*

# c - 如何将参数传递给 Linux 守护程序/服务

> ID：11335860
> 
> 赞同：6
> 
> 时间：2012-07-04T22:03:49.627
> 
> 标签：c, linux, daemon

我创建了一个 Linux 守护程序（C 语言），通过 UDP 将某些信息发送到另一台计算机。它当然需要远程 IP 地址和端口号。我存储了这个守护进程，`/usr/local/bin/`我还在其中创建了一个脚本`/etc/init.d/`来启动|停止|重新启动守护进程。

到目前为止，IP 地址和端口号直接由脚本传递给守护进程。例如，脚本的 start() 部分如下所示：

```
start() {
  /usr/local/bin/lvsload_udp_s 192.168.122.25 47239
} 
```

因此，当远程 IP 和/或端口号更改时，我必须修改我的脚本，而不是修改某些配置文件。这是一个不好的做法，我知道。

将参数传递给我的守护进程的最佳方式是什么？谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-04T22:13:01.260

为什么你认为命令行参数不好？

配置文件是额外的工作，因为您需要解析它们。并以您的示例为例，修改配置文件=修改一个文件。修改脚本 = 修改一个文件。当您只有少量参数时，似乎没有太大区别。您甚至可以将参数粘贴到脚本顶部的变量中，这使得它几乎就像一个配置文件 :-) 一些脚本甚至提供了这样的“变量设置脚本”，所以它看起来真的像一个配置文件。

如果您能找到命令行参数不好的原因，那么您很有可能也知道应该使用什么。另一方面，如果您甚至无法解释为什么命令行参数不好，那么使用它们可能没有任何问题......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T22:08:27.030

> 问：到目前为止，IP 地址和端口号都是直接传递给守护进程的……这是一种不好的做法，我知道。

A：你为什么认为这是“不好的做法”？？？？

“良好做法”包括：

*   “DRY”（不要重复自己 - 将数据存储在一处且仅一处）

*   “KISS”（保持简单，愚蠢）

我想说一个脚本（您的 init.d 启动脚本）中的一个参数（命令行 IP 地址）很好地遵守了这两个原则:)

恕我直言...

PS：

如果你真的认为配置文件是合适的——如果有很多复杂的配置数据需要在启动时解析），那么两个合适的地方是：

*   将配置文件存储在 /etc 中（并将您的应用程序存储在 /usr/local/bin 中）

    ... 或者 ..

*   将配置文件存储在应用程序的安装目录中（并可能定义一个全局环境变量以指向安装目录）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-04T22:09:24.870

这是特定于发行版的。例如，在 debian 上，约定是 /etc/init.d/foo 包含像“source /etc/default/foo”这样的行。该文件仅包含环境变量，例如 DAEMON_ARGS="--remote-ip=192.168.0.1"。

如果你使用 debhelper 构建一个 debian 包，它会自动为你创建这个结构。我确信也有类似的工具可以创建“标准”RPM。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-04T22:11:32.600

使用环境变量：

```
// include stdlib for getenv

port = getenv("MY_DAEMON_PORT");
host = getenv("MY_DAEMON_HOST");

// convert port to integer... 
```

我记得这对于从`init.d`.

既然您提到您正在使用 Ubuntu，请查看`/etc/environment`- 查看[文档](https://help.ubuntu.com/community/EnvironmentVariables)。但是正如有人已经提到的，这取决于您的系统/发行版；另一种方法是将环境变量保留在 eg 中`/etc/myDaemon.env`，然后从您的 init 脚本中获取：

```
. /etc/myDaemon.env 
```

但是您的情况非常简单，我也没有看到将参数保留在脚本中的问题。

# javascript - 用于复杂日期的 jquery tablesorter addParser

> ID：11335862
> 
> 赞同：2
> 
> 时间：2012-07-04T22:03:53.633
> 
> 标签：javascript, jquery, regex, tablesorter

我正在尝试为 jquery tablesorter 插件编写解析器，我真的需要帮助... javascript .match 函数...，这是我得到的代码：

```
 $.tablesorter.addParser({
            id: 'DateParser',
            is: function(s) {
                    return false;
            },
            format: function(s) {
                    var date = s.match(/^(\d{1,2})-(\d{1,2})-(\d{4}) :(\d{1,2}):(\d{1,2})$/)
                    var d = date[1];
                    var m = date[2];
                    var y = date[3];
                    var H = date[4];
                    var M = date[5];
                    var S = date[6];
                    var MS = 0;

                    return new Date(y, m, d, H, M, S, MS).getTime();
            },
            type: 'numeric'
    });
    $("#tabletosort").tablesorter({
            headers: {
                    0: {
                            sorter: 'DateParser'
                    }
            }
    }); 
```

match() 调用的结果始终为空...提前非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T22:09:27.210

您当前的正则表达式正在匹配表单中的日期`dd-mm-yyyy :mm:ss`- 您错过了小时、上午/下午，并使用`-`而不是`/`，所以这就是为什么它不匹配格式为`dd/mm/yyyy hh:mm:ss a.m.|p.m.`. 纠正这些问题会为您提供以下内容：

```
/^(\d{1,2})\/(\d{1,2})\/(\d{4}) (\d{1,2}):(\d\d):(\d\d) (a\.m\.|p\.m\.)$/ 
```

...然后您将测试最后一个子表达式以调整上午或下午的时间。

（注意：我认为您不希望分钟和秒允许一位数，因此我已将该部分更改为需要两位数。）

# java - JFreeChart：如何使用振荡器创建中间面板

> ID：11335863
> 
> 赞同：1
> 
> 时间：2012-07-04T22:04:04.167
> 
> 标签：java, jfreechart

我有两个面板。一个带有价格 (OHLC) 和移动平均线，另一个带有交易量。我想创建一个带有两个在零附近[振荡的振荡器的中间面板。](http://www.aspenres.com/Documents/help/userguide/help/aspenMoving_Average_Oscillator.html)每个震荡指标是其上方图表的两条移动平均线之差。可能吗？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T21:38:46.500

这是最终的解决方案。我从 Plot3 创建中删除了所有引用。

```
public class PriceVolumeChart2 extends ApplicationFrame{

final static String filename = "A.txt";
static TimeSeries t1 = new TimeSeries("49-day moving average");

/**
 * Default constructor
 */
public PriceVolumeChart2(String title)
{
    super(title);
    JPanel panel = createDemoPanel();
    panel.setPreferredSize(new Dimension(500, 270));
    setContentPane(panel);
}

//create price dataset
//hard-coded here
private static OHLCDataset createPriceDataset(String filename)
{
    //the following data is taken from http://finance.yahoo.com/
    //for demo purposes...

    OHLCSeries s1 = new OHLCSeries(filename);

    try {
        BufferedReader in = new BufferedReader(new FileReader(filename));
        DateFormat df = new SimpleDateFormat("yyyyMMdd");
        String inputLine;
        in.readLine();
        while ((inputLine = in.readLine()) != null) {
            StringTokenizer st = new StringTokenizer(inputLine, ",");
            Date date       = df.parse( st.nextToken() );
            double open     = Double.parseDouble( st.nextToken() );
            double high     = Double.parseDouble( st.nextToken() );
            double low      = Double.parseDouble( st.nextToken() );
            double close    = Double.parseDouble( st.nextToken() );
            double volume   = Double.parseDouble( st.nextToken() );
            //double adjClose = Double.parseDouble( st.nextToken() );
            s1.add(new Day(date), open, high, low, close);
            t1.add(new Day(date), close);
        }
        in.close();
    }
    catch (Exception e) {
        e.printStackTrace();
    }

    OHLCSeriesCollection dataset = new OHLCSeriesCollection();
    dataset.addSeries(s1);

    return dataset;
}

//create volume dataset
private static IntervalXYDataset createVolumeDataset(String filename)
{
    //create dataset 2...
    TimeSeries s1 = new TimeSeries("Volume");

    try {
        BufferedReader in = new BufferedReader(new FileReader(filename));
        DateFormat df = new SimpleDateFormat("yyyyMMdd");
        String inputLine;
        in.readLine();
        while ((inputLine = in.readLine()) != null) {
            StringTokenizer st = new StringTokenizer(inputLine, ",");
            Date date = df.parse( st.nextToken() );
            st.nextToken();
            st.nextToken();
            st.nextToken();
            st.nextToken();
            double volume   = Double.parseDouble( st.nextToken() );
            //double adjClose = Double.parseDouble( st.nextToken() );
            s1.add(new Day(date), volume);
        }
        in.close();
    }
    catch (Exception e) {
        e.printStackTrace();
    }

    return new TimeSeriesCollection(s1);
}

private static JFreeChart createCombinedChart()
{
    OHLCDataset data1 = createPriceDataset(filename);

    XYItemRenderer renderer1 = new HighLowRenderer();
    renderer1.setBaseToolTipGenerator(new StandardXYToolTipGenerator(StandardXYToolTipGenerator.DEFAULT_TOOL_TIP_FORMAT, new SimpleDateFormat("d-MMM-yyyy"), new DecimalFormat("0.00")));
    renderer1.setSeriesPaint(0, Color.blue);
    DateAxis domainAxis = new DateAxis("Date");
    NumberAxis rangeAxis = new NumberAxis("Price");
    rangeAxis.setNumberFormatOverride(new DecimalFormat("$0.00"));
    rangeAxis.setAutoRange(true);
    rangeAxis.setAutoRangeIncludesZero(false);
    XYPlot plot1 = new XYPlot(data1, domainAxis, rangeAxis, renderer1);
    plot1.setBackgroundPaint(Color.lightGray);
    plot1.setDomainGridlinePaint(Color.white);
    plot1.setRangeGridlinePaint(Color.white);
    plot1.setRangePannable(true);

    //Overlay the Long-Term Trend Indicator
    TimeSeries dataset3 = MovingAverage.createMovingAverage(t1, "LT", 49, 49);
    TimeSeriesCollection collection = new TimeSeriesCollection();
    collection.addSeries(dataset3);
    plot1.setDataset(1, collection);
    plot1.setRenderer(1, new StandardXYItemRenderer());

    //add a second dataset (volume) and renderer
    IntervalXYDataset data2 = createVolumeDataset(filename);
    XYBarRenderer renderer2 = new XYBarRenderer();
    renderer2.setDrawBarOutline(false);
    renderer2.setBaseToolTipGenerator(new StandardXYToolTipGenerator(StandardXYToolTipGenerator.DEFAULT_TOOL_TIP_FORMAT, new SimpleDateFormat("d-MMM-yyyy"), new DecimalFormat("0,000.00")));
    renderer2.setSeriesPaint(0, Color.red);

    XYPlot plot2 = new XYPlot(data2, null, new NumberAxis("Volume"), renderer2);
    plot2.setBackgroundPaint(Color.lightGray);
    plot2.setDomainGridlinePaint(Color.white);
    plot2.setRangeGridlinePaint(Color.white);

    //middle pane oscillator
    TimeSeries threeMA = MovingAverage.createMovingAverage(t1, "SL1", 3, 3);
    TimeSeries tenMA = MovingAverage.createMovingAverage(t1, "SL2", 10, 10);

    List<TimeSeriesDataItem> threeItemsList = new ArrayList<TimeSeriesDataItem>();
    List<TimeSeriesDataItem> tenItemsList = new ArrayList<TimeSeriesDataItem>();
    threeItemsList = threeMA.getItems();
    tenItemsList = tenMA.getItems();

    for (TimeSeriesDataItem item: threeItemsList)
    {
        System.out.println("three" + item.getValue().doubleValue() + " " + item.getPeriod().toString());
    }

    for (TimeSeriesDataItem item: tenItemsList)
    {
        System.out.println("ten" + item.getValue().doubleValue() + " " + item.getPeriod().toString());
    }

    TimeSeries slDataset = new TimeSeries("SL");
    int i = 0;
    //List<TimeSeriesDataItem> slItemsList = new ArrayList<TimeSeriesDataItem>();
    TimeSeriesDataItem myItem;
    Day threeDate;

    for (TimeSeriesDataItem item: threeItemsList)
    {
        //RegularTimePeriod variable = item.getPeriod();
        if (item.getPeriod().compareTo(tenItemsList.get(0).getPeriod()) < 0)
        {
            continue;
        }
        else
        {
            double result = item.getValue().doubleValue() - tenItemsList.get(i).getValue().doubleValue();
            Day currentDay = (Day)item.getPeriod();
            myItem = new TimeSeriesDataItem(currentDay, result);
            slDataset.add(myItem);

            //slItemsList.add(myItem);
            i++;
        }

    }

    System.out.println("slDataset count : " + slDataset.getItemCount());

    TimeSeriesCollection collectionSL = new TimeSeriesCollection();
    collectionSL.addSeries(slDataset);

    XYPlot plot3 = new XYPlot(collectionSL, new DateAxis("Date"), new NumberAxis("Value"), new StandardXYItemRenderer());
    plot3.setBackgroundPaint(Color.lightGray);
    plot3.setDomainGridlinePaint(Color.white);
    plot3.setRangeGridlinePaint(Color.white);
    plot3.setRangePannable(true);
    plot3.setDomainPannable(true);

    CombinedDomainXYPlot cplot = new CombinedDomainXYPlot(domainAxis);
    cplot.add(plot1, 3);
    cplot.add(plot3, 2);
    cplot.add(plot2, 2);
    cplot.setGap(8.0);
    cplot.setDomainGridlinePaint(Color.white);
    cplot.setDomainGridlinesVisible(true);
    cplot.setDomainPannable(true);

    //return the new combined chart
    JFreeChart chart = new JFreeChart("Sun Microsystems (SUNW)", JFreeChart.DEFAULT_TITLE_FONT, cplot, false);

    ChartUtilities.applyCurrentTheme(chart);
    renderer2.setShadowVisible(false);
    renderer2.setBarPainter(new StandardXYBarPainter());

    return chart;
}

//create a panel
public static JPanel createDemoPanel()
{
    JFreeChart chart = createCombinedChart();
    ChartPanel panel = new ChartPanel(chart);
    panel.setMouseWheelEnabled(true);

    return panel;
}

public static void main(String[] args) {
    // TODO code application logic here
    PriceVolumeChart2 demo = new PriceVolumeChart2("JFreeChart: CombinedXYPlotDemo1.java (base)");
    demo.pack();
    RefineryUtilities.centerFrameOnScreen(demo);
    demo.setVisible(true);
} 
```

}

# php - 执行 INSERT 查询时对“错误：‘字段列表’中的未知列‘Connor’”进行故障排除

> ID：11335865
> 
> 赞同：0
> 
> 时间：2012-07-04T22:04:21.747
> 
> 标签：php, mysql, mysqli

这是根据用户在表单中输入的内容来注册用户的功能。

```
function register($firstname, $lastname , $email, $password, $password2){
      // check if the first password is allowed
      if(!checkLogin($email, $password)){
         echo "checklogin failed";
         return false;  
     }

         // check if two passwords are equal
     if(strcmp($password, $password2) != 0){
         echo "passwords rent the same";
         return false;
     }

     // explode the email into two pieces
     $email = explode('@' , $email);
     echo "" . $email[0] . " and " . $email[1] . "";
     $insertemail = "$email[0]-" . "$email[1]";
     echo "" . $insertemail . "";

     // connect to database and insert values
     require("db.inc.php");
     $query = "INSERT into users set 
        firstname = ".mysqli_real_escape_string($link, $firstname) ." ,
        lastname = ".mysqli_real_escape_string($link, $lastname) ." ,
        email = ".mysqli_real_escape_string($link, $insertemail) ." ,
        password = ".mysqli_real_escape_string($link, $password) ." ";
     $result = mysqli_query($link, $query)
            or die("Error: " . mysqli_error($link));
     // check the query worked
     if(!result){
         return false;
     }

     return true;

 } 
```

我不确定这是否有帮助，但“Connor”值是我在表单中输入的值并存储在 $firstname 中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T22:09:41.490

您需要在 SQL 查询中用引号将文本值括起来，更不用说您的 INSERT 语法有点偏离：

```
 $query = "INSERT INTO users (firstname, lastname, email, password) VALUES 
           ( 
              '" . mysqli_real_escape_string($link, $firstname)   . "' ,
              '" . mysqli_real_escape_string($link, $lastname)    . "' ,
              '" . mysqli_real_escape_string($link, $insertemail) . "' ,
              '" . mysqli_real_escape_string($link, $password)    . "' 
           ) "; 
```

# java - 为什么我的 switch 语句的最后一个情况会被击中？

> ID：11335871
> 
> 赞同：2
> 
> 时间：2012-07-04T22:05:23.070
> 
> 标签：java, android

我的 Java 应用程序中 switch 语句的最后一种情况总是受到打击。我怎样才能使它正常工作？

```
public void onClick(View v) {       
    Random r = new Random();
    int x=r.nextInt(4-1) + 1;
    switch (x)
    {
    case 1:
        setContentView(R.layout.image1);
    case 2:
        setContentView(R.layout.image2);
    case 3:
        setContentView(R.layout.image3);
    case 4:
        setContentView(R.layout.image4); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-04T22:10:45.847

在大多数语言中，如果没有 break 语句，case 语句将“失败”。您只需为每个案例添加一个。像这样：

```
case 1:
    setContentView(R.layout.image1);
    break;
case 2:
    setContentView(R.layout.image2);
    break;
case 3:
    setContentView(R.layout.image3);
    break;
case 4:
    setContentView(R.layout.image4);
    break; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-04T22:09:00.043

你正在通过你的案例陈述。你需要`break`。

```
switch (x)
{
  case 1:
    setContentView(R.layout.image1);
    break;
  case 2:
    setContentView(R.layout.image2);
    break;
  case 3:
    setContentView(R.layout.image3);
    break;
  case 4:
    setContentView(R.layout.image4);
    break;
} 
```

看看这个[教程](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/switch.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-04T22:53:31.807

您必须使用您拥有的`break;`每个 switch 语句。如果你不打破语句，那么下一个案例将被击中（所以一个直到最后一个有中断）。

```
 case 1:
        setContentView(R.layout.image1);
        break;
    case 2:
        setContentView(R.layout.image2);
        break;
    case 3:
        setContentView(R.layout.image3);
        break;
    case 4:
        setContentView(R.layout.image4);
        break;
    default:
        //Anything you want;
    break; 
```

而且...使用默认情况是一种很好的编程习惯（如果没有遇到任何情况，将使用）

# php - 获取访问的最后一页

> ID：11335873
> 
> 赞同：9
> 
> 时间：2012-07-04T22:05:25.833
> 
> 标签：php, url, browser-history

我需要知道访问我网站的人是否来自另一个特定网站。例子：

*   用户 A 访问 www.youtube.com/myvideo 并单击指向我的网站的链接。
*   用户 B 访问 google，搜索我的网站并点击链接。

我页面上的结果消息：

*   用户 A：`Welcome! You already know how it works, register now!`
*   用户乙：`Welcome! Please watch our video first at www.youtube.com/myvideo`

我的问题是：

1.  是否可以知道用户在进入我的页面之前访问的最后一个 url？
    我已经尝试过`$_SERVER['HTTP_REFERER']`使用 PHP，但它不能正常工作，而且我读到它不适用于所有浏览器。
2.  是否有任何语言或 php 脚本来获取此 url，在所有浏览器上正常工作？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-07-04T22:06:48.610

HTTP 引用标头是唯一的方法。这是通过 PHP 提供给您的数据`$_SERVER['HTTP_REFERER']`。

请注意，此标头在大多数情况下都可以使用。另请注意，它很容易被欺骗。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-29T17:46:50.597

为什么不在 youtube 上的链接中添加 GET 变量 - www.yoursite.com/?referrer=youtube

为了自由裁量权和外观，您可以将 URL 重写为 www.yoursite.com/youtube

# android - 是否可以在 iPad/iPhone 设备上运行 .APK/Android 应用程序？

> ID：11335874
> 
> 赞同：16
> 
> 时间：2012-07-04T22:05:32.293
> 
> 标签：android, iphone, apk

全部 - 我最近在 Google Play 上发布了一个 android 应用程序。我还在我的网站上以 .apk 文件的形式提供了它。我不想问这个问题，因为我不是 Apple 的忠实粉丝，但 Apple 用户可以从我的网站下载我的应用程序吗？只是想知道我的很多朋友都是苹果用户。谢谢你的时间！

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-07-04T22:35:27.430

在 iOS（支持 iPhone、iPad、iPod 等）下运行 Android 应用程序本身是*不可能的。*

这是因为两个运行时堆栈使用*完全不同*的方法。Android 运行打包在 APK 文件中的 Dalvik（“Java 变体”）字节码，而 iOS 运行来自 IPA 文件的编译（来自 Obj-C）代码。然而，除了时间/精力/金钱和诉讼（！）之外，没有什么本质上会阻止 Android 在 Apple 硬件上的实施。

它看起来为每个应用程序打包一个小型 Dalvik VM，并针对开发人员。

请参阅[iPhoDroid](http://www.iphodroid.com/)：

*看起来是2G/3G 越狱设备*的双启动解决方案。可用的信息很少，但有一些 YouTube 视频。

见[安卓](http://www.redmondpie.com/iandroid-for-iphone-brings-android-simulation-experience-to-ios-cydia-app/)：

> iAndroid 是一款*针对越狱设备*的全新 iOS 应用程序，可模拟 iPhone 或 iPod touch 上的 Android 操作系统体验。虽然*距离完成还很远*，但该项目正在形成。

我不确定它用来实现这一点的方法：它可能是*仿真*或只是*模拟*（例如“看起来像”）。*越狱*的要求听起来像是可以使用*仿真..*

根据 Holo Dev 的评论，请参阅[BlueStacks](http://bluestacks.com/)：

它看起来是一个适用于 OS X（和 Windows）的“Android App Player”。但是，*afaik*，它 [当前] 不针对 iOS 设备..

**YMMV**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T22:08:36.120

Apple 用户可以下载您的 .apk 文件，但他们无法运行它。它是与 iPhone 应用程序 (.ipa) 不同的文件格式

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T08:05:11.207

还有一个前面没有提到的选项：

*   [不幸的是， Pieceable Viewer](https://www.pieceable.com/)已于 2012 年 12 月 31 日停止服务，但将其软件开源。您需要为模拟器编译 iOS 应用程序，Pieceable 的软件会将其嵌入到托管应用程序的网页中。此网页可用于运行 iOS 应用程序。有关详细信息，请参阅 Pieceable 的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-06-20T18:48:14.340

该应用程序无法本地运行，但可以在模拟器上运行。您可以使用 ManyMo 将它们嵌入网站并让用户将您的应用添加到他们的主屏幕。[此链接](https://developer.apple.com/library/ios/documentation/AppleApplications/Reference/SafariWebContent/ConfiguringWebApplications/ConfiguringWebApplications.html)应该有助于使应用程序更加真实。然后，用户只能按共享按钮并将应用程序添加到他们的主屏幕。当“应用程序”在他们的 iOS 设备中关闭时，所有数据都将被删除，因此您应该使用互联网/云进行存储。它无法访问相机或多点触控，但它可能很有用。

# android - 使用 SDK 录制时预览帧处理

> ID：11335875
> 
> 赞同：1
> 
> 时间：2012-07-04T22:05:44.513
> 
> 标签：android

我正在开发一个应该不断处理每个预览帧的应用程序（通过将其传递给本机代码，该代码返回少量布尔值作为元数据）。到目前为止，一切都很好。通过切换活动屏幕中与本机代码输出相关的一些按钮，我可以获得正在发生的事情的实时反馈。

但是，我可以在使用 MediaRecorder 处理每一帧的同时将这些帧记录为视频吗？我使用的 Android SDK 版本是 2.2。非常感谢。

# sql-server - 根据输入参数更改存储过程

> ID：11335879
> 
> 赞同：1
> 
> 时间：2012-07-04T22:06:09.083
> 
> 标签：sql-server, tsql, search

我正在为 Web 应用程序编写一个“高级搜索”页面。它基本上有一个形式：

> **在用户名**最近**日期**发布 的论坛**论坛名称**中搜索**查询**

 ******这个想法是用户可以根据需要将字段留空，并且搜索不会包含它。

我宁愿不编写基于将值留空的所有可能组合进行搜索的存储过程。有没有办法可以编写存储过程，以便根据传入的参数更改搜索是否为空白？

类似的东西（伪代码）

```
SELECT * FROM Table WHERE Message = @query

(if @username isn't null)
AND Username = @Username

(if @forum isn't null)
AND Forum = @forum 
```

..等等。

感谢您的任何帮助，您可以提供！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T22:29:40.133

这应该有效：

```
SELECT *
FROM YourTable
WHERE   (Message = @query OR @query IS NULL)
AND     (Forum = @forum OR @forum IS NULL)
AND     (Username = @username OR @username IS NULL)
AND     (LastDate = @lastdate OR @lastdate IS NULL) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T06:02:39.300

```
 CREATE Proc [dbo].[sp_sarch_with_filter]                   
  @param1 varchar(50)=NULL,                                
  @param2 varchar(50)=NULL,                                
  @param3 varchar(50)=NULL,                                

  AS                                  
  Begin                                                                  

  Declare @dynamicsql varchar(max)                  

  Set @dynamicsql='select  * from tabelName where 1=1'                               

  if(@param1 is not null and @param1  <> '')                  
  Set @dynamicsql=@dynamicsql+' and col1 like''%'+@param1 +'%'''                  

  if(@param2 is not null and @param2  <> '')                  
  Set @dynamicsql=@dynamicsql+' and col2 like''%'+@param2 +'%'''                  

  if(@param3 is not null and @param3  <> '')                  
  Set @dynamicsql=@dynamicsql+' and col3 like''%'+@param3 +'%'''                  

  Set @dynamicsql=@dynamicsql+' Order by col4 Desc'

  Print @dynamicsql                  

  Execute(@dynamicsql) 
```******

# node.js - 使用 javascript/nodejs 方法对 mongod 结果进行排序

> ID：11335883
> 
> 赞同：0
> 
> 时间：2012-07-04T22:06:54.777
> 
> 标签：node.js, mongodb, methods

我正在使用带有[斗牛士](https://github.com/Obvious/matador)mvc 框架的 nodejs。#

我有这个方法来查询 monogodb

```
 .methods({
        getPopular: function(popular) {
          shows.find({date: '2012-07-01'}, popular);
      }
  });
}; 
```

这工作正常。我的问题是我不知道如何对结果进行排序。

我努力了

```
 .methods({
        getPopular: function(popular) {
          shows.find({date: '2012-07-01'}, popular).sort({show : 1});
      }
  });
}; 
```

请帮忙。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T23:06:59.167

排序的工作方式是发送要排序的键，降序或升序（-1 或 1）

因此，使用您的示例按降序排序显示，您将执行以下操作：

```
.methods({
        getPopular: function(popular) {
          shows.find({date: '2012-07-01'}, popular).sort({show : -1});
      }
  }); 
```

Mongo 文档解释得更好一些：

[http://www.mongodb.org/display/DOCS/Sorting+and+Natural+Order](http://www.mongodb.org/display/DOCS/Sorting+and+Natural+Order)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-05T12:45:11.027

我相信您必须`sort`在 Node.js 驱动程序的查询选项中包含关键字。

```
.methods({
    getPopular: function(popular) {
        shows.find({date: '2012-07-01'},{sort:[['show','desc']]}, popular);
    }
}); 
```

有一个双精度数组 ( `[['show','desc']]`)，因为采用了[此处](http://mongodb.github.io/node-mongodb-native/markdown-docs/queries.html#sorting)`sort`解释的排序首选项数组。如果你想要升序，你应该使用。`asc`

# c# - 在 ItemsControl 中查看注入

> ID：11335884
> 
> 赞同：2
> 
> 时间：2012-07-04T22:08:13.350
> 
> 标签：c#, wpf, silverlight, mvvm, prism

在我的应用程序中，我正在处理一个`ItemControl`. 这个 itemControl 接收一个 ObservableCollection。

如上所示，BaseItemViewModel 是一个抽象类。当我的应用程序启动时，`moduleCatalog`通过发现加载模块。

每个模块都有一个继承自 BaseItemViewModel 的类

所以我不能像这样在 ItemsControl 中设置 dataTemplates：

```
<DataTemplate> 
    <View:GeneralSettingsView/> 
</DataTemplate> 
<DataTemplate> 
    <View:AdvancedSettingsView/> 
</DataTemplate> 
```

如果我正在使用模块发现，我该怎么做才能显示来自相应视图模型的视图？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T22:51:11.133

你看过 ItemTemplateSelector 属性吗？

例如，创建一个内容选择器类：

```
public class myContentSelector : DataTemplateSelector
{
    public override DataTemplate SelectTemplate(object item, DependencyObject container)
    {
        if (item != null)
        {
            VMBase vm = item as VMBase;

            switch (vm.Type)
            {
                case myType.General:
                    return Application.Current.Resources["GeneralSettings"] as DataTemplate;
                default:
                    return Application.Current.Resources["AdvancedSettings"] as DataTemplate;
            }
        }

        return null;
    }
} 
```

为它创建一个静态资源：

```
<local:myContentSelector x:Key="contentSelector" /> 
```

并在 ItemsControl 中设置：

```
<ItemsControl ItemsSource="{Binding mySource}" ItemTemplateSelector="{StaticResource contentSelector}" /> 
```

并将您的数据模板设置为名称：

```
<DataTemplate x:Key="GeneralSettings" DataType="{x:Type vm:VMBase}"> 
    <View:GeneralSettingsView/> 
</DataTemplate> 
<DataTemplate x:Key="AdvancedSettings" DataType="{x:Type vm:VMBase}"> 
    <View:AdvancedSettingsView/> 
</DataTemplate> 
```

类似的东西？

# ruby-on-rails - 将“中间页”设置为 rails 站点

> ID：11335891
> 
> 赞同：0
> 
> 时间：2012-07-04T22:09:10.277
> 
> 标签：ruby-on-rails

我们有包含成人内容的网站。如果用户第一次访问网站，我们需要向他显示“如果您年满 18 岁，您可以进入”的消息。和“输入”按钮。我怎样才能显示这个页面一次，如果用户点击进入，显示他的主页？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T22:19:12.140

这是在用户会话中存储某些内容并根据是否设置了某些内容来重定向它们的理想情况。有一个看起来像这样`before_filter`的：`application_controller.rb`

```
before_filter :check_age

private

def check_age
  return true if session[:age_check]
  redirect_to age_verification_path
end 
```

在您的年龄验证控制器中，`session[:age_check]`如果用户单击链接，则设置为 true。然后`before_filter`将让他们按照您的预期访问该站点。

# sql - Oracle 基于列值的唯一约束

> ID：11335899
> 
> 赞同：6
> 
> 时间：2012-07-04T22:09:53.443
> 
> 标签：sql, oracle, constraints

我有以下唯一约束

```
dup_Checklist_QNum UNIQUE (QUESTION_NO, IS_ACTIVE) 
```

我试图防止两个问题在处于活动状态时具有相同的问题编号（IS_ACTIVE 值 = 1）。

在我不得不第二次修改问题之前，一切似乎都很好。

```
QUESTION_NO=1, TEXT="Have you..", REV=1, IS_ACTIVE=0  
QUESTION_NO=1, TEXT="Have you..", REV=2, IS_ACTIVE=0  <-- This should be ok but constraint was violated
QUESTION_NO=1, TEXT="Have you..", REV=3, IS_ACTIVE=1
QUESTION_NO=1, TEXT="Have you..", REV=3, IS_ACTIVE=1 <-- This should be throw constraint exception 
```

我需要仅在 IS_ACTIVE=1 时应用约束

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-04T22:17:56.097

您可以创建唯一的基于函数的索引

```
CREATE UNIQUE INDEX idx_dup_active
    ON <<table name>>( CASE WHEN is_active = 1
                            THEN question_no
                            ELSE NULL
                        END ); 
```

这利用了 Oracle b-tree 索引不存储叶块数据完全为 NULL 的数据这一事实。

# eclipse - 在 PYDEV Eclipse 中使用“TAB”而不是“ENTER”进行自动完成

> ID：11335900
> 
> 赞同：1
> 
> 时间：2012-07-04T22:10:03.413
> 
> 标签：eclipse, autocomplete, tabs, pydev, enter

有没有办法更改自动完成选项？`pydev`如果我使用`TAB`key 而不是key ，我想自动完成，`ENTER`因为这很烦人。每次我想跳到新行时，我都会点击`ENTER`它，它为我完成了一些事情，而不是跳行！

发送

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T11:08:04.580

不幸的是，在 PyDev（也不在 Eclipse 本身）中，实际上不可能使用 tab 而不是 enter 来自动完成。

因此，在这些情况下，我所做的是使用 Shift-Enter 转到新行：请注意，在这种情况下，您可以从行中的任何位置按 Shift+Enter，它会模仿“转到行尾” ，按回车键'（这对我来说是件好事）。

实施说明：`'\t'`and `'\r`, `'\n'`case 实际上是在 Eclipse 中硬编码的：`org.eclipse.jface.text.contentassist.CompletionProposalPopup.verifyKey(VerifyEvent)`所以，要解决这个问题，你需要一个补丁来改变 Eclipse 本身（所以，如果你觉得值得，在 Eclipse 中创建一个错误请求本身要求该功能）。

# iphone - 带有自定义 UIBarButtonItem 后退按钮的 UINavigationController 跳过动画

> ID：11335905
> 
> 赞同：0
> 
> 时间：2012-07-04T22:11:03.990
> 
> 标签：iphone, objective-c, uinavigationcontroller, uibarbuttonitem

我有一个非常奇怪的问题。我隐藏了 UINavigationController 中显示的后退按钮，并插入了一个自定义左按钮来完成相同的工作。它在 95% 的时间内编译和工作。但是它在弹出视图时会随机跳过动画，而不是在推送时。我可以坐下来重复推送和弹出视图，它可以完美地来回滑动，但有时它只是“跳转”到视图而不是动画。任何想法为什么这样做？

谢谢

# sql - 在 Sql Server 中重构时同步多个表

> ID：11335906
> 
> 赞同：1
> 
> 时间：2012-07-04T22:11:09.187
> 
> 标签：sql, sql-server, view, triggers, refactoring-databases

我需要你的智慧。我正在对从经典 asp 到 mvc 的系统进行大修，并且在此过程中，我正在重构 sql server 2008 r2 中的一个主表（称为 MAIN）。该表有一百多列（我对此不负责），我将结构移动到 7 个表以提高性能、灵活性和可维护性。但是，新旧代码在许多新旧页面中都引用了 MAIN 表。我想平稳而渐进地过渡到新表，它是业务的一个活跃的核心站点。请帮帮我。

一旦我转移了现有数据，

我想过：

1.) 在主表和七个新表上使用标准插入、更新和删除触发器。对于无限触发循环，我必须包含一个 catch (http://stackoverflow.com/questions/2237499/sql-server-trigger-loop)。

2.) 创建一个模拟主表的视图，引用新表。我会在视图上使用 INSTEAD OF 触发器来通过视图插入和更新表。这将允许我立即删除 MAIN 表。

其中哪个更有意义？要么是极其愚蠢的吗？两个都？我绝对不是 dba，但我需要在第一时间做到这一点。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T22:50:14.070

听起来您的应用程序正在直接访问数据库表，因为您现在发现这不是一个好主意。

您是否考虑编写存储过程来处理 CRUD 操作，这将抽象出数据库设计？然后您可以从您的应用程序中调用存储的过程并将所有数据作为参数传递。存储过程将完成更新所有新表的所有工作（当然您应该使用事务），您可以立即停止使用旧表。

我认为这比尝试编写复杂的视图更容易，并且肯定比使用触发器更能看到。

# jquery - 在页面上，如何打开一个包含表单的弹出窗口，该表单在提交时将更新“调用者”页面中的选择元素？

> ID：11335907
> 
> 赞同：1
> 
> 时间：2012-07-04T22:11:15.160
> 
> 标签：jquery, ajax

对不起，但我不知道如何更好地问这个问题。

这是我的主页：

![来电窗口图片](../Images/b28cbfe6c199a9932f847f9e320237eb.png)

当我从选择元素中选择“新元素”选项时，应该打开一个弹出窗口（或任何名称）：

![弹出窗口图像](../Images/64c6d9a954a84588c9cbc38fb2bf07fc.png)

表单完成后，提交按钮应向服务器执行 POST 以便在数据库中插入新元素，弹出窗口应自动关闭，下拉列表必须在最新插入的元素中选择

![带有更新的选择元素的调用者窗口](../Images/725cf44a846ce853d35b19947f618ded.png)

弹出窗口**不是**主页面 DOM 的一部分。

我怎么能在 jQuery 中做到这一点？弹出窗口是一个必须以某种方式加载的网页。我想我应该做一个 jQuery.post() 将数据从弹出窗口发送到服务器。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T22:20:27.043

您可以使用[`window.open()`](http://www.w3schools.com/jsref/met_win_open.asp)它，并使用它`querystrings`来填充您的弹出窗口。

所以你的选择框看起来像这样：

```
 <select onChange="popUp(this.value);">
   <option value="0">New Element</option>
   <option value="1">Element 1</option>
   <option value="2">Element 2</option>
   <option value="3">Element 3</option>
 </select> 
```

然后你的`popUp()`函数看起来像这样：

```
 function popUp(val) {
   window.open('mypopupwindow.php?element=' + val,'_target','width=400,height=400');
 } 
```

我会在 上使用某种服务器端语言`mypopupwindow.php`，否则您将需要使用 javascript 来读取 url 中的查询字符串以填充您的文本框。

# bash - brew doctor 说“错误：/usr/bin 发生在 /usr/local/bin 之前”如何解决？

> ID：11335908
> 
> 赞同：37
> 
> 时间：2012-07-04T22:11:23.523
> 
> 标签：bash, path, terminal, homebrew

```
Adams-MacBook-Pro% brew doctor                                 

Error: /usr/bin occurs before /usr/local/bin
This means that system-provided programs will be used instead of those
provided by Homebrew. The following tools exist at both paths:

    clusterdb
    createdb
    createlang
    createuser
    dropdb
    droplang
    dropuser
    ecpg
    git
    git-cvsserver
    git-receive-pack
    git-shell
    git-upload-archive
    git-upload-pack
    gitk
    pg_config
    pg_dump
    pg_dumpall
    pg_restore
    pg_upgrade
    psql
    reindexdb
    vacuumdb

Consider amending your PATH so that /usr/local/bin
is ahead of /usr/bin in your PATH. 
```

这是我的路径：

```
Adams-MacBook-Pro% echo $PATH                                  
/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/X11/bin 
```

我认为将东西移到前面很危险？我该如何解决这个问题？另外，我什至不确定在哪里可以找到 /user/bin 在路径中声明的位置。

谢谢

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-07-04T22:22:41.820

$PATH 只是一个包含字符串的变量。把东西放在前面：

```
% PATH=/usr/local/bin:$PATH
% echo $PATH
/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/X11/bin 
```

这并不危险，因为它只适用于您打开的当前 shell（它不会影响系统或其他 shell 的路径）。

要为您打开的所有 shell 自动更改路径，请将其放入`~/.profile`. 如果此文件不存在，您可以创建它。

在`~/.profile`：

```
homebrew=/usr/local/bin:/usr/local/sbin
export PATH=$homebrew:$PATH 
```

[`export`](https://stackoverflow.com/a/1158231/276457)使该变量可用于 shell 的任何子进程。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2014-06-14T11:58:49.270

我找到了另一种方法来解决这个问题。

```
sudo vim /etc/paths 
```

并像这样添加 /usr/local/bin 和 /usr/local/sbin

```
/usr/local/bin
/usr/local/sbin
/usr/bin
/bin
/usr/sbin
/sbin 
```

打开一个新的终端选项卡，然后你会看到

```
~ $ env|grep PATH
PATH=/usr/local/bin:/usr/local/sbin:/usr/bin:/bin:/usr/sbin:/sbin:/opt/X11/bin 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-10-31T01:14:14.533

只需在您喜欢的终端应用程序中运行以下行：

```
echo export PATH="/usr/local/bin:$PATH" >> ~/.bash_profile 
```

重新启动终端并运行

```
brew doctor 
```

这个问题应该得到解决

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-04-28T11:52:51.810

我刚刚创建了一个 .bashrc 文件并添加了

> homebrew=/usr/local/bin:/usr/local/sbin
> 导出 PATH=$homebrew:$PATH

这似乎成功了！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-04-08T12:43:48.623

也许OP正在使用**zsh**。
解决它的方法是编辑**~/** .zshrc每次打开**iterm**时都会加载这个文件。
更改有关**PATH**的话。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-10-20T16:20:00.717

如果您真的想将其永久化和默认设置，请编辑文件 /etc/paths（使用 sudo）并将 /usr/local/bin 移动到列表顶部。

在我自己的 .bash_profile 中，我使用了一个名为“pathadd”的脚本，它可以防止我的 PATH 在 shell 被分叉时变得笨拙和充满重复。因此，我专门采取了 /etc/paths 操作，通过一次又一次地将 /usr/local/bin 添加到前面来避免在 PATH 中出现重复的目录。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-05-02T01:20:36.213

使用 $PATH 进行任何更改后，您需要重新启动终端。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-08-19T09:33:49.447

On OS X Mountain Lion that needed edits was `~/.bash_profile`

# java - 为什么 class.forName 有用

> ID：11335910
> 
> 赞同：2
> 
> 时间：2012-07-04T22:11:44.177
> 
> 标签：java

我正在努力理解 class.forName 的使用。实际上我正在做一个项目，我有一个接受字符串的字段。类路径！我在 class.forName 中传递了这个字符串——没有例外……所以 class.forName 可以找到指定的类。之后我想调用指定的类。但是我的问题来了。首先，我必须分隔字符串才能取类的名称......对吗？另外，如果我这样做， `Class requestedClass = Class.forName(path); AClass newClassInstance = (AClass)requestedClass.newInstance();`
我有一个异常 InstantiationException，因为必须在类的构造函数中传递一些参数。有什么解决办法吗？对我来说，使用 if 语句并调用相应的类听起来更明智，但如果有很多可能的类，这种方法将是一场噩梦。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T22:19:19.310

它很有用，因为它允许您指定要加载的类，该类在编译代码时不存在。HTML 中的`applet`标签使用它来加载`java.applet.Applet`. Web 服务器使用它来加载 Java servlet 和其他 Web 组件。EJB 容器、Spring 容器和许多其他程序都使用这种方法来加载组件。如果您使用 Eclipse 或 NetBeans，这些 IDE 会通过使用加载插件`Class.forName()`——这使它们能够加载每天创建的新插件。

所有这些魔法的关键是*继承*`。您需要能够将创建的对象视为接口或父类的实例 - 即，

```
Applet applet = (Applet) Class.forName(theNameOfSomeAppletClass).newInstance(); 
```

然后，您可以`theNameOfSomeAppletClass`从 HTML 文件中读取（例如）并创建该类的实例，即使您的代码从未听说过它。

大多数时候，插件 API 只是简单地指定你应该给你的插件类一个无参数的构造函数。但是`java.lang.Class`有一个`getConstructors()`方法可以让你获取`Constructor`对象，如果你真的需要，它反过来让你通过将参数传递给它的构造函数来实例化一个类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T23:08:29.500

您将看到的另一个重要用途是加载 JDBC 驱动程序。这可能是大多数 java 程序员第一次使用 Class.forName。你会看到是这样的：

```
Class.forName("oracle.jdbc.OracleDriver");

Connection connection = DriverManager.getConnection("jdbc:oracle:thin:..."); 
```

这里发生的是，当 OracleDriver 类被加载（通过 Class.forName）时，它包含一个类似这样的类初始化块（它可能更复杂，但说明了这一点）。该块作为类加载过程的一部分运行。

```
public class OracleDriver { 
    static {
        DriverManager.registerDriver(new OracleDriver());
    }
} 
```

然后当你调用 DriverManager.getConnection 时，它会询问所有已注册的驱动程序是否能够处理给定的 url（代码比较复杂，但我会简化一下）：

```
for (Driver driver : registeredDrivers) {
   if (driver.acceptsURL(url)) {
       // use this driver
   }
} 
```

至于您的实例化问题， Class.newInstance() 方法将始终调用无参数构造函数，如果不存在则抛出异常。如果你想要一个特定的构造函数，你可以在类本身上使用“getConstructor”方法。例如，如果你想要一个接受 String 和 Long 的构造函数：

```
Class clazz = ...; // figure out which class here
Constructor c = clazz.class.getConstructor(String.class, Long.class);
Object o = c.newInstance("foo", new Long(1L)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-04T22:30:03.817

您可以使用以下方法通过反射调用参数化构造函数[`Class.getConstructor()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#getConstructor%28java.lang.Class...%29)：

```
class Foo {
    public Foo(String bar) {
        System.out.println("bar = " + bar);
    }
}

Class<?> fooCls = Class.forName("Foo");
Constructor<?> fooCtor = fooCls.getConstructor(String.class);
Foo foo = (Foo) fooCtor.newInstance("BAR"); 
```

如果您需要实例化的类没有无参数构造函数，并且您无法弄清楚要传递给它的参数，那么您就不走运了。（这也是您设计中的一个严重缺陷。如果一个方法需要实例化 N 个类中的一个，则应该可以以相同的方式实例化所有类，无论是构造函数签名还是工厂方法。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-04T22:22:57.593

正如已经指出的那样，它非常有用，因为您可以加载在编译时不存在的类，例如插件或扩展。

您的问题有一个简单的解决方案。简单地获取您正在搜索的构造函数并提供预期的参数。例如：

```
MyClass a = (MyClass) Class.forName("com.test.MyClass")
    .getConstructor(new Class[] { String.class }).newInstance("Test"); 
```

# ruby-on-rails-3 - 链接到函数？功能的新观点？

> ID：11335914
> 
> 赞同：0
> 
> 时间：2012-07-04T22:12:51.793
> 
> 标签：ruby-on-rails-3

我创建了一个函数，它收集以选定字母/数字开头的模型（称为 Nismo）的所有条目：

```
def showByLetter(letter)
    @nismosByLetter = Nismo.all :conditions => ['substr(name,1,1) = ?', letter]
end 
```

我的“Nismo”控制器中有这个。

在我的 Nismo 控制器的索引视图中，我有一个按字母顺序排列的菜单，我想使用它来允许用户选择，例如“B”。这将运行 showByLetter 函数，然后在页面中显示以该字母开头的所有条目。

我的问题是，在我的索引页面中，我真的不知道如何让这一切发生：

```
<% Array('A' .. 'Z').each do |letter| %>
    <%= link_to letter, showByLetter(letter) %>
<% end %> 
```

我猜我需要为这个“showByLetter”函数创建一个新的 view.html.erb 文件来显示它的结果。

我试图从编程程序员的书中了解它，并在网上看到评论，这可能意味着我需要使用 routes.rb 文件来添加类似的东西来获得正确的路线：

```
namespace "nismo" do
    resources :nismos do
        member do
            get :showByLetter
        end
    end
end 
```

我相信这一切都很简单，但我很困惑，需要一些指示。

任何帮助，将不胜感激！

谢谢

亚当

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T23:35:40.997

老实说，最简单的方法是在“nismo”控制器中的索引操作中。你能做的就是改变

```
<%= link_to letter, showByLetter(letter) %> 
```

至

```
<%= link_to letter, nismos_path(:letter => letter) %> 
```

它的作用是创建一个返回到当前索引页面的链接，并将其传递给类似于

```
yourrooturl.com/nismos?letter=A 
```

然后在 Nismo 控制器的 index 操作中，只需添加一个 if 语句来确定是应该加载所有 nismo 还是仅按字母加载。类似于：

```
if params[:letter].nil?
  @nismos = Nismo.all
else
  @nismos = Nismo.all :conditions => ['substr(name,1,1) = ?', params[:letter]]
end 
```

那应该可以解决您的问题，并且您不必处理路线。

# php - 注入非 SQL 站点（仅限 PHP）

> ID：11335917
> 
> 赞同：2
> 
> 时间：2012-07-04T22:13:01.273
> 
> 标签：php, code-injection

我有一个没有 SQL 的 CMS 站点。一切都写入文件。

但是有一个函数 ( `login($login, $pass)`) 可以使用简单的 if-else 语句检查登录表单中的 POST 数据

```
if 
    login-data-from-file == POST['login'] 
and
    password-data-from-file == POST['pass'] 
then 
   "Log user in" 
```

我想知道是否有办法注入这样的代码。你怎么看？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-04T22:15:57.523

没有，因为大概您只是在比较字符串。

但是，对 SQL 注入的免疫不会自动使任何应用程序安全。总是需要担心[跨站点脚本](https://www.owasp.org/index.php/Cross-site_Scripting_%28XSS%29)和[会话固定（只是其中最常见的两个攻击向量）。](https://www.owasp.org/index.php/Session_fixation)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T22:19:19.243

如果您不使用 eval 或任何其他黑魔法，则不能直接注入 PHP 代码。尽管将用户和密码以纯文本形式存储在文件中并不是很安全。如果你仍然想这样做，你应该确保

1.  包含用户名和密码的文件存储在可公开访问的文件夹之外的位置
2.  密码经过哈希处理和加盐处理（非常重要！）
3.  代码中没有用户可以访问包含用户名和密码的文件的地方

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T22:17:56.890

如果您做出正确的 if-else 语句，我认为没有办法注入此代码。可以发送`NULL`值 (%00)，但它不应该改变任何东西。

# jquery - 将 json 结果附加到不同的 div

> ID：11335921
> 
> 赞同：0
> 
> 时间：2012-07-04T22:13:34.597
> 
> 标签：jquery, json

我从客户那里得到了一个脚本，用于在 Google 的自然搜索结果中显示一些星星。问题是脚本两次输出结果。我对这些东西很陌生，所以我不明白为什么会这样。

我的脚本：

```
<script type="text/javascript">
 jQuery.ajax('http://www.shop.com/feed.php?callback=?', {
dataType: 'jsonp',
success: function(json){
  var reviewsHtml = [];
  $.each(json, function(index, company){
    reviewsHtml.push('<div class="stars"><div class="stars_bg"><div style="width:'+ ((company.total_score)*10) +'%" class="stars_on"></div></div></div>' + '<strong>' + company.total_score + '</strong>&nbsp;(' + company.total_reviews + '&nbsp;reviews)');
  });

  reviewsHtml = reviewsHtml.join('');

  $('#feed').html(reviewsHtml);
}
});
</script> 
```

我的 html 看起来像这样：

```
<div id="feed"></div> 
```

我个人认为这与reviewsHtml.join('') 有关。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-04T22:31:56.873

抱歉，我不知道为什么字符串被重复——你的 json 中可能只是重复。在任何情况下，都不需要将结果缓存在数组中。您可以将它们直接附加到`#feed`：

```
success: function(json){
    $.each(json, function(index, company){
        $('#feed').append('<div class="stars"><div class="stars_bg"><div style="width:'+ ((company.total_score)*10) +'%" class="stars_on"></div></div></div>' + '<strong>' + company.total_score + '</strong>&nbsp;(' + company.total_reviews + '&nbsp;reviews)');
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T22:32:16.543

也许你可以做到这一点

```
$.each(json, function(index, company){
    $('#feed').append('<div class="stars"><div class="stars_bg"><div style="width:'+ ((company.total_score)*10) +'%" class="stars_on"></div></div></div>' + '<strong>' + company.total_score + '</strong>&nbsp;(' + company.total_reviews + '&nbsp;reviews)');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-04T22:38:54.293

您应该在您的 javascript 中打断以查看该 json 对象返回的内容。我猜你可能在那个 json 数组中有 2 个项目。

# wordpress - WordPress - 标题中显示蓝条

> ID：11335922
> 
> 赞同：0
> 
> 时间：2012-07-04T22:13:34.817
> 
> 标签：wordpress, wordpress-theming

我正在玩基于骨架的响应式 wordpress 主题，并遇到了一个烦人的问题。一个细的蓝色水平条出现在屏幕顶部，它的高度不能超过 15-18px 左右，并且具有绝对定位，因为即使向下滚动它也会保持在页面顶部。我已经使用了 chrome 和 firefox（带有 firebug）来找出它的来源，但无济于事，它没有显示在 css 或源代码中。有没有其他人经历过这种情况或知道为什么会这样？

NB 它出现在所有浏览器 IE、Chrome 和 FF 中。网址： http: [//www.produceme.co.nz/](http://www.produceme.co.nz/)

![在此处输入图像描述](../Images/a50ccddb3e9c773577dc37237df36aab.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T23:27:53.470

您看到的蓝色背景来自您的 css，您可能有这个：

```
background:#fcfcfc url(.../images/border_top.png) 
```

在你的身体风格，所以只要找到它并删除它，你很高兴去。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T01:30:07.170

错误在`http://www.produceme.co.nz/?get_styles=css`第 1 行。

您定义了以下内容

```
body
{
    background: #fcfcfc url(http://www.produceme.co.nz/wp-content/themes/skeleton/images/border_top.png) repeat-x top center fixed;
    color: #444444;
    font-family: "HelveticaNeue", "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size: 14px;
    font-style: normal;
    font-weight: normal;
} 
```

背景 URL 是添加它的部分。删除该值，它会为您修复它。

# r - 当高阶参数保留时，如何删除模型中的低阶参数？

> ID：11335923
> 
> 赞同：9
> 
> 时间：2012-07-04T22:13:50.737
> 
> 标签：r, lm

**问题：**只要模型中保留高阶参数（即交互作用），我就无法删除模型中的低阶参数（例如，主效应参数）。即使这样做，模型也会被重构，并且新模型不会嵌套在更高的模型中。
请参阅以下示例（因为我来自我使用的 ANOVA `contr.sum`）：

```
d <- data.frame(A = rep(c("a1", "a2"), each = 50), B = c("b1", "b2"), value = rnorm(100))
options(contrasts=c('contr.sum','contr.poly'))
m1 <- lm(value ~ A * B, data = d)
m1

## Call:
## lm(formula = value ~ A * B, data = d)
## 
## Coefficients:
## (Intercept)           A1           B1        A1:B1  
##   -0.005645    -0.160379    -0.163848     0.035523  

m2 <- update(m1, .~. - A)
m2

## Call:
## lm(formula = value ~ B + A:B, data = d)

## Coefficients:
## (Intercept)           B1       Bb1:A1       Bb2:A1  
##   -0.005645    -0.163848    -0.124855    -0.195902 
```

可以看出，虽然我删除了一个参数（`A`），但新模型（`m2`）被重构并且**没有嵌套**在更大的模型（`m1`）中。如果我将我的因子转换为数值对比变量，我可以获得所需的结果，但是如何使用 R 的因子功能获得它？

**问题：**如何去除 R 中的低阶因子并获得一个模型，该模型确实缺少该参数且未重构（即较小模型中的参数数量必须更少）？

* * *

**但为什么？**我想使用包中的函数为`lmer`模型获取“类型 3”之类的 p 值。所以这个例子实际上只是一个例子。`KRmodcomp``pbkrtest`

**为什么不交叉验证？**我觉得这实际上更像是一个 R 而不是一个统计问题（即，我知道你永远不应该拟合一个具有交互但没有主要影响之一的模型，但我仍然想这样做）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-08T20:18:03.597

这是一种答案；我不知道直接用公式来制定这个模型......

如上构造数据：

```
d <- data.frame(A = rep(c("a1", "a2"), each = 50),
                B = c("b1", "b2"), value = rnorm(100))
options(contrasts=c('contr.sum','contr.poly')) 
```

确认仅从公式中减去因子不起作用的原始发现：

```
m1 <- lm(value ~ A * B, data = d)
coef(m1)
## (Intercept)          A1          B1       A1:B1 
## -0.23766309  0.04651298 -0.13019317 -0.06421580 

m2 <- update(m1, .~. - A)
coef(m2)
## (Intercept)          B1      Bb1:A1      Bb2:A1 
## -0.23766309 -0.13019317 -0.01770282  0.11072877 
```

制定新的模型矩阵：

```
X0 <- model.matrix(m1)
## drop Intercept column *and* A from model matrix
X1 <- X0[,!colnames(X0) %in% "A1"] 
```

`lm.fit`允许直接指定模型矩阵：

```
m3 <- lm.fit(x=X1,y=d$value)
coef(m3)
## (Intercept)          B1       A1:B1 
## -0.2376631  -0.1301932  -0.0642158 
```

此方法仅适用于允许明确指定模型矩阵的少数特殊情况（例如`lm.fit`，`glm.fit`）。

更普遍：

```
## need to drop intercept column (or use -1 in the formula)
X1 <- X1[,!colnames(X1) %in% "(Intercept)"]
## : will confuse things -- substitute something inert
colnames(X1) <- gsub(":","_int_",colnames(X1))
newf <- reformulate(colnames(X1),response="value")
m4 <- lm(newf,data=data.frame(value=d$value,X1))
coef(m4)
## (Intercept)          B1   A1_int_B1 
##  -0.2376631  -0.1301932  -0.0642158 
```

这种方法的缺点是它不能将多个输入变量识别为来自同一个预测变量（即，来自多于 2 个水平的因子的多个因子水平）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-08T20:35:19.627

我认为最直接的解决方案是使用`model.matrix`. 可能，您可以通过一些花哨的步法和自定义对比来实现您想要的。但是，如果您想要“类型 3 esque”的 p 值，您可能希望模型中的每个术语都使用它，在这种情况下，我认为我的方法`model.matrix`无论如何都很方便，因为您可以轻松地隐式循环遍历所有模型，将一列放在一次。提供一种可能的方法并不是对其统计优点的认可，但我确实认为你提出了一个明确的问题，并且似乎知道它在统计上可能不合理，所以我认为没有理由不回答它。

```
## initial data
set.seed(10)
d <- data.frame(
  A = rep(c("a1", "a2"), each = 50),
  B = c("b1", "b2"),
  value = rnorm(100))

options(contrasts=c('contr.sum','contr.poly'))

## create design matrix
X <- model.matrix(~ A * B, data = d)

## fit models dropping one effect at a time
## change from 1:ncol(X) to 2:ncol(X)
## to avoid a no intercept model
m <- lapply(1:ncol(X), function(i) {
  lm(value ~ 0 + X[, -i], data = d)
})
## fit (and store) the full model
m$full <- lm(value ~ 0 + X, data = d)
## fit the full model in usual way to compare
## full and regular should be equivalent
m$regular <- lm(value ~ A * B, data = d)
## extract and view coefficients
lapply(m, coef) 
```

这将导致最终输出：

```
[[1]]
   X[, -i]A1    X[, -i]B1 X[, -i]A1:B1 
  -0.2047465   -0.1330705    0.1133502 

[[2]]
X[, -i](Intercept)          X[, -i]B1       X[, -i]A1:B1 
        -0.1365489         -0.1330705          0.1133502 

[[3]]
X[, -i](Intercept)          X[, -i]A1       X[, -i]A1:B1 
        -0.1365489         -0.2047465          0.1133502 

[[4]]
X[, -i](Intercept)          X[, -i]A1          X[, -i]B1 
        -0.1365489         -0.2047465         -0.1330705 

$full
X(Intercept)          XA1          XB1       XA1:B1 
  -0.1365489   -0.2047465   -0.1330705    0.1133502 

$regular
(Intercept)          A1          B1       A1:B1 
 -0.1365489  -0.2047465  -0.1330705   0.1133502 
```

到目前为止，对于使用`lm`. 你提到这最终是为了`lmer()`，所以这里是一个使用混合模型的例子。我相信，如果您有多个随机截距（即，需要从模型的固定和随机部分删除效果），它可能会变得更加复杂。

```
## mixed example
require(lme4)

## data is a bit trickier
set.seed(10)
mixed <- data.frame(
  ID = factor(ID <- rep(seq_along(n <- sample(3:8, 60, TRUE)), n)),
  A = sample(c("a1", "a2"), length(ID), TRUE),
  B = sample(c("b1", "b2"), length(ID), TRUE),
  value = rnorm(length(ID), 3) + rep(rnorm(length(n)), n))

## model matrix as before
X <- model.matrix(~ A * B, data = mixed)

## as before but allowing a random intercept by ID
## becomes trickier if you need to add/drop random effects too
## and I do not show an example of this
mm <- lapply(1:ncol(X), function(i) {
  lmer(value ~ 0 + X[, -i] + (1 | ID), data = mixed)
})

## full model
mm$full <- lmer(value ~ 0 + X + (1 | ID), data = mixed)
## full model regular way
mm$regular <- lmer(value ~ A * B + (1 | ID), data = mixed)

## view all the fixed effects
lapply(mm, fixef) 
```

这给了我们...

```
[[1]]
   X[, -i]A1    X[, -i]B1 X[, -i]A1:B1 
 0.009202554  0.028834041  0.054651770 

[[2]]
X[, -i](Intercept)          X[, -i]B1       X[, -i]A1:B1 
        2.83379928         0.03007969         0.05992235 

[[3]]
X[, -i](Intercept)          X[, -i]A1       X[, -i]A1:B1 
        2.83317191         0.02058800         0.05862495 

[[4]]
X[, -i](Intercept)          X[, -i]A1          X[, -i]B1 
        2.83680235         0.01738798         0.02482256 

$full
X(Intercept)          XA1          XB1       XA1:B1 
  2.83440919   0.01947658   0.02928676   0.06057778 

$regular
(Intercept)          A1          B1       A1:B1 
 2.83440919  0.01947658  0.02928676  0.06057778 
```

# ruby-on-rails - 嵌套路由和 form_for 以及使用 has_one 和 belongs_to 的模型

> ID：11335924
> 
> 赞同：4
> 
> 时间：2012-07-04T22:13:58.580
> 
> 标签：ruby-on-rails, ruby-on-rails-3, controllers, form-for, nested-resources

如何使用嵌套路由映射 has_one 模型以及如何在 RESTful 数据库之后为 /localhost:3000/users/1/profile/new,html.erb 添加 form_for？

用户有一个个人资料。

楷模

```
class Profile < ActiveRecord::Base
  attr_accessible :name, :surname
  belongs_to :user
end

class User < ActiveRecord::Base
  attr_accessible :email, :email_confirmation, :password, :password_confirmation
  has_secure_password
  has_one :profile, dependent: :destroy
end

  resources :users do
    resources :profiles      (note: has_one profile)
    resources :progress_charts
    resources :calories_journals
  end 
```

视图/配置文件/new.html.erb

```
<h1>About You</h1>
<div class="row">
  <div class="span6 offset3">
    <%= form_for(@profile) do |f| %>
    <%= render 'shared/error_messages' %>

      <%= f.label :name %>
      <%= f.text_field :name %>

      <%= f.label :surname %>
      <%= f.text_field :surname %>

      <%= f.submit "Create my account", class: "btn btn-large btn-primary" %>
    <% end %>
  </div>
</div> 
```

控制器：Profiles_controller.rb 我发现了两个错误，因为我不太明白为什么它不起作用。

```
class ProfilesController < ApplicationController
def index
end

def show
end

  def new
  #  @user = User.find(params[:id]) # Error message: Couldn't find User without an ID
  #  @profile = @user.build_profile()

    @profile = current_user.build_profile(params[:id]) # Error message: unknown attributes: user_id
  end

  def edit
  end

  def create
  end

  def update
  end

  def destroy
  end
end 
```

Helpers：SessionHelper（说明current_user）模块SessionsHelper def sign_in(user) cookies.permanent[:remember_token] = user.remember_token self.current_user = user end

```
 def signed_in?
    !current_user.nil?
  end

  def current_user=(user)
    @current_user = user
  end

  def current_user?(user)
    user == current_user
  end

  def current_user
    @current_user ||= User.find_by_remember_token(cookies[:remember_token])
  end

  def sign_out
    self.current_user = nil
    cookies.delete(:remember_token)
  end

  def signed_in_user
    unless signed_in?
      store_location
      redirect_to signin_path, notice: "Please sign in."
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-04T22:22:16.317

您的个人资料表是否有 user_id 属性？

在您的路线中，个人资料应该是单数，因为用户只有一个个人资料：

```
resources :users do
    resource  :profile
    resources :progress_charts
    resources :calories_journals
end 
```

到用户个人资料的路线将是`users/:user_id/profile`（而不是`users/:user_id/profile/:id`

在您的profiles_controller 中：

```
@profile = current_user.build_profile(params[:id]) # why params[:id]?
#it should just be
@profile = current_user.build_profile()
@user = User.find(params[:user_id]) 
```

形式将类似于：

```
form_for [@user, @profile] do |f|...
end 
```

你真的希望用户像那样创建他的个人资料吗？通常，您会在用户注册时创建配置文件。

# binding - Windows 8 WsHttpBinding

> ID：11335928
> 
> 赞同：1
> 
> 时间：2012-07-04T22:14:32.267
> 
> 标签：binding, windows-8, wshttpbinding

我刚刚下载了 Visual Studio 2012，我想连接我用 .net4 编写的 wcf 服务。我想定义一个`WsHttpBinding`like

```
BasicHttpBinding binding = new BasicHttpBinding(); 
```

但问题是系统无法识别

```
WsHttpBinding binding = new WsHttpBinding() 
```

或类似的东西。有谁知道为什么不？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-05T02:30:31.697

这是[Metro Style App 支持的 WCF 绑定列表](http://blogs.msdn.com/b/piyushjo/archive/2011/10/19/wcf-for-metro-apps-supported-functionality.aspx)。Ws-* 目前似乎不受支持。

# key-bindings - XMonad 键绑定不起作用

> ID：11335939
> 
> 赞同：0
> 
> 时间：2012-07-04T22:16:29.837
> 
> 标签：key-bindings, xmonad

我在使用 XMonad 配置时遇到问题。

你能告诉我这段代码有什么问题吗？它可以编译，但没有达到预期的效果。

我在SO上没有找到类似的东西。所以这里是：

```
 myConfig = azertyConfig { modMask = mod4Mask
                    , layoutHook = myLayoutHook
                    , workspaces = ["1", "2", "3", "4", "5", "6", "7", "8", "9"]
                    , terminal = "urxvt"
                    , startupHook = setWMName "LG3D"
                    , manageHook = myManageHook <+> manageHook azertyConfig
                    } `additionalKeysP` myKeys

     myXPConfig = defaultXPConfig

     myManageHook = composeAll
           [ className =? "emulator-arm" --> doFloat
           , className =? "Sylpheed" --> doShift "2:email"
           , className =? "Pidgin" --> doShift "3:im"
           , className =? "Opera" --> doShiftAndGo "4:web"
           , manageDocks
           ] where doShiftAndGo ws = doF (W.greedyView ws) <+> doShift ws

     myKeys = [ ("M-p", shellPrompt defaultXPConfig)

       -- sublayouts
     , ("M-xK_F10", raiseVolume 4 >> return ())
     , ("M-xK_F11", lowerVolume 4 >> return ())
     -- more codes

   myLayoutHook = avoidStruts $ windowNavigation $ subTabbed $
           (smartBorders tall ||| smartBorders threeCol ||| noBorders Full)
   where
      tall     = Tall nmaster delta ratio
      threeCol = ThreeCol nmaster delta ratio
      nmaster  = 1
      delta    = 3/100
      ratio    = 1/2

   main = xmonad =<< xmobar (withUrgencyHook NoUrgencyHook $ myConfig) 
```

也试过这个，但它不编译：

```
 , ((modMask, xK_F10), raiseVolume 3 >> return ())
     , ((modMask, xK_F11), lowerVolume 3 >> return ()) 
```

我收到此错误：

```
 Couldn't match expected type `[Char]' with actual type `(t0, t1)'
      In the expression: (modMask, xK_F10)
      In the expression: (modMask, xK_F10), raiseVolume 3 >> return ()) 
```

和`modMask = modMask4`（Windows 按钮）

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T22:53:00.937

找到了我的问题的解决方案..
替换了这一行

```
 main = xmonad =<< xmobar (withUrgencyHook NoUrgencyHook $ myConfig) 
```

和

```
main = xmonad =<< xmobar (withUrgencyHook NoUrgencyHook $ myConfig){ keys =
keys myConfig `mappend`
\c -> fromList [
    ((mod4Mask, xK_F11), lowerVolume 4 >> return ()),
    ((mod4Mask, xK_F10), raiseVolume 4 >> return ())
]
} 
```

还做了必要的进口

```
import Data.Map    (fromList)
import Data.Monoid (mappend) 
```

# gwt - GWT TableCellElement 不显示背景图像

> ID：11335942
> 
> 赞同：0
> 
> 时间：2012-07-04T22:16:54.553
> 
> 标签：gwt

我正在使用 gwt 在表格单元格中显示图像，它是动态图像，因此我不需要对其进行硬编码，但它不会显示其中的实际图像。这是我的代码..

我的 UiBinder 有点像：

```
 <table>
       <tr><td ui:field="tableCellElement"/></tr>
    </table> 
```

我的演示者正在访问方法中的元素：

```
 void someMethod(Image patterImage) {
        tableCellElement.setBackgroundImage("url('"+patternImage.getUrl()+"')");
        // and I have tried this without using url as well but it doesn't work
        // DOM.setstyleattribute also doesn't work...
    } 
```

代码成功执行，但没有显示图像，我目前使用的是 IE9，但我也在 IE8 和 7 上尝试过。

我知道它可以用 css 解决，但这里我们的图像是动态的，所以如果我们有 100 个图像，我不能为每个图像定义 100 个 css ..

如果有人能为我解决这个问题，我真的很感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T10:13:16.490

Your code is basically ok. The reason you don't see the image is probably just that the default size of the td is 0.

Background images don't influence the size of the element, so you need to set it manually. If the size of all images is the same, you can set it once in UiBinder:

```
<ui:style>
  .myTableCell {
    width: 32px;
    height: 32px;
  }
</ui:style>

...

<table>
  <tr>
    <td class="{style.myTableCell}" ui:field="tableCellElement"></td>
  </tr>
</table> 
```

Otherwise, set it programmatically:

```
Style style = tableCellElement.getStyle();

style.setBackgroundImage("url('"+patternImage.getUrl()+"')");
style.setWidth(patternImage.getWidth(), Unit.PX);
style.setHeight(patternImage.getHeight(), Unit.PX); 
```

# javascript - Dojo 1.7 Ajax 内容和 AMD 要求

> ID：11335944
> 
> 赞同：1
> 
> 时间：2012-07-04T22:17:28.360
> 
> 标签：javascript, dojo, amd, contentpane

我在 Dojo 1.7，异步加载。

我有一个内容窗格，我通过 ajax 填充内容。我想在此内容中以声明方式使用上传器 - 如何正确要求上传器？

假设这是我用来生成将设置为内容窗格的内容的服务器页面：

```
<script>
require(["dojox/form/uploader/FileList",
    "dojox/form/uploader/plugins/Flash"]);
</script>

<center>
<input type="file" multiple="true" data-dojo-type="dojox.form.Uploader"
    data-dojo-props='
        label:"Foo My Bar!",
        url:"/tests/UploadFile.php",
        uploadOnSelect:"true"'/>
</center>
<br>
<div id="files" data-dojo-type="dojox.form.uploader.FileList"
            data-dojo-props='uploaderId:"uploader"'></div> 
```

但这不起作用：找不到小部件类。我知道这是因为加载器处于异步模式，显然解析器正在尝试在 require 调用完成之前呈现小部件。

所以，问题是，如何正确地做到这一点？如果我将 require 调用放在应用程序的主页中，则一切正常（包括在主页中以声明方式设置的小部件）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-07T17:10:16.973

It seems 'dojox/form/Uploader' is not loaded... is it required?

And you can parse contents any time you call dojo.parser.parse. If you want to execute a first parsing from your code, set "parseOnLoad : false" on dojo config, and call "dojo.parser.parse(dojo.body());".

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-01T15:09:23.697

您需要在页面上以声明方式引用所有小部件模块：

```
require(["dojo/parser","dojox/form/Uploader","dojox/form/uploader/FileList"],
  function(parser){
    parser.parse()
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-02T15:23:09.913

您是否尝试过在 dijit 中使用 dojox/layout/ContentPane 而不是 ContentPane？dojox 中的 ContentPane 类型派生自 dijit 中的类型，允许代码在动态内容中运行。在解析内容中的小部件时，它似乎还加载了必要的小部件引用。

# python - OpenERP：获取同名记录

> ID：11335945
> 
> 赞同：2
> 
> 时间：2012-07-04T22:17:32.007
> 
> 标签：python, openerp

如何在 openerp （或相同的其他字段）中检索具有相同 name 值的记录？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-05T08:52:12.267

Ruchir 建议的使用手动 SQL 查询进行分组的解决方案`name`可能是最简单的，但有点低级。您也可以使用`read_group()`执行类似`GROUP BY`查询的 API 方法来执行此操作，但无需绕过访问控制机制和模型业务逻辑。

该`read_group`方法采用搜索域（类似于`search()`）、要读取的字段列表（类似于`read()`）和要分组的字段列表。此方法记录在[OpenERP API](http://doc.openerp.com/v6.1/developer/03_modules_2.html)中。它返回一个有序的字典列表，其中包含分组数据和一些额外的值，包括每个组中的记录数，存储在名为 的键`<grouped_field>_count`中，您可以使用它来查找重复项。

例如，如果您在`name`没有任何其他搜索条件的情况下查找重复值：

```
def duplicate_names(self, cr, uid, context=None):
    # Note: context not propagated for brevity of example
    groups = self.read_group(cr, uid, [], ['name'], ['name'])
    duplicate_names = [g['name'] for g in groups if g['name_count'] > 1]
    print "Duplicates names:", duplicate_names

    if duplicate_names:
        # It's easy to find out the IDs of duplicate records for each name,
        # here is for the first one
        duplicate_ids = self.search(cr, uid, [('name', '=', duplicate_names[0])])
        print "Duplicate IDs for %r: %s" % (duplicate_names[0], duplicate_ids) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-05T05:24:58.140

您可以通过直接 SQL 查询在数据库中找到重复记录。例如，您可以通过以下方式在联系地址中查找重复姓名：

```
cr.execute("""
    SELECT name, id, partner_id FROM res_partner_address
    WHERE name in (SELECT name
                   FROM res_partner_address
                   GROUP BY name
                   HAVING (COUNT(name) > 1))""")

print cr.dictfetchall() 
```

而不是`cr.dictfetchall()`您可以使用`cr.fetchall()`将结果作为元组列表而不是字典来获取。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-05T05:24:45.450

如果您有要搜索的字段“名称”的特定值，则要搜索的域是

```
domain = [('name', '=', your_value)] 
```

如果您有要搜索的值列表，那么

```
domain = [('name', 'in', list_of_values)] 
```

如果您想搜索具有相似值的字段“名称”，那么

```
domain = [('name','ilike',your_value)] 
```

现在你可以搜索

```
our_pool = self.pool.get('your.obj.name')
ids = our_pool.search(cr, uid, domain, context=context) 
```

现在你可以浏览我们得到的 id

```
our_objs = our_pool.browse(cr, uid, ids, context) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-07-05T03:50:14.980

您应该首先阅读文档：http: [//doc.openerp.com/v6.0/developer/2_5_Objects_Fields_Methods/methods.html](http://doc.openerp.com/v6.0/developer/2_5_Objects_Fields_Methods/methods.html)

对于这个问题，您首先需要一个“搜索”，然后是一个“浏览”（或“阅读”），例如：

```
obj = self.pool.get('your.obj.name')
ids = obj.search(cr, uid, [('name','=',your_value)], context=context)
records = obj.browse(cr, uid, ids, context=context) 
```

# c# - 在 64 位操作系统上启动 32 位进程

> ID：11335946
> 
> 赞同：0
> 
> 时间：2012-07-04T22:17:43.547
> 
> 标签：c#, x86, 64-bit

我的 C# 程序在 64 位操作系统 (Windows) 上启动 java 应用程序。Java 进程是 64 位的，如何修复我的启动代码以在 32 位中启动 Java 进程？

我的启动代码：

```
ProcessStartInfo info = new ProcessStartInfo();
info.WorkingDirectory = ServerProperties.ServerWorkingDirectory;
info.FileName = "java"
info.Arguments = "some arguements"
ServerProcess = new Process();
ServerProcess.StartInfo = info;
ServerProcess.Start(); 
```

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-04T22:22:10.527

这更多是您正在启动的进程的功能，而不是正在启动它的进程（即您正在启动的进程必须已编译/定位到 x86 而不是 x86-64）。

但是，如果 x86 和 x86-64 *java.exe*都安装在有问题的机器上，您可能可以通过查看*Program Files (x86)*而不是*Program Files*来寻找 x86 之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T22:33:08.827

如果您在 IIS 中托管应用程序，则需要为 Web 应用程序池启用 x86 进程。遵循以下步骤：

1.  为您的 Web 应用程序选择应用程序池。
2.  单击右侧编辑应用程序池下的**高级设置。**
3.  **将Enable 32-Bit Applications**的值更改为**True**。

详情查看下一篇文章[——64位Windows环境下对32位应用程序的支持](http://www.viva64.com/en/l/0002/)

# java - Jpa（休眠）返回类型

> ID：11335949
> 
> 赞同：0
> 
> 时间：2012-07-04T22:17:56.870
> 
> 标签：java, hibernate, jpa

我使用 jpa（使用 Hibernate 的实现）。

确定查询返回类型的最佳方法是什么？我希望数字默认返回为 java.lang.Long（或 oracle.jbo.number） - 而不是 java.math.BigDecimal。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T22:58:25.340

如果你想要一个长的，为什么不把结果转换成一个数字并使用 .longValue() ???? 我在这里假设您要返回一个对象（或对象数组）。如果您不确定它将为元组或投影返回什么类型，请利用类层次结构，因为 Long、Integer、Short、Double、Float、BigInteger 和 BigDecimal 都扩展了 Number 类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T04:25:56.310

根据需要使用不同的类型投射您的结果，请参阅此

```
 long result= (Long)query.getSingleResult();
       or
       BigDecimal result = (BigDecimal)query.getSingleResult();
       or
       Object result = (Object)query.getSingleResult(); 
```

# google-maps - 谷歌地图 - 基于网格的聚类

> ID：11335950
> 
> 赞同：2
> 
> 时间：2012-07-04T22:18:10.010
> 
> 标签：google-maps, google-maps-api-3, google-maps-markers

在此页面上[https://developers.google.com/maps/articles/toomanymarkers](https://developers.google.com/maps/articles/toomanymarkers)

它说这是最简单的集群可能，但我找不到任何客户端解决方案。有谁知道免费的开源、基于网格的谷歌地图标记聚类客户端解决方案？我不想要 MarkerClusterer。

我没有找到它，所以我开始编写自己的解决方案。第一个明显的要求是它必须快速加载至少 1000 个标记在地图上。每次放大、移动等，都会重复聚类的过程/功能。网格块可自定义，默认值为 50*50 像素。

下图显示了结果应该是什么样子。

我遇到了算法问题，现在我能想到的就是遍历每个网格的所有标记并询问它是否在边界内，然后增加网格 ++ 数组。这显然不能那样做。应该有一些哈希或只需要一次迭代所有标记的东西，我会知道特定于网格的标记属于哪个。

我希望有人能给我一个关于我所追求的算法的提示。谢谢 ！![在此处输入图像描述](../Images/a6977bf64807972bdbfe2337fc8420a0.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-19T08:26:03.313

似乎 geohash 是您问题的答案，您甚至在问题中提到了该解决方案。这里解释得很好：

[http://blog.trifork.com/2013/08/01/server-side-clustering-of-geo-points-on-a-map-using-elasticsearch/](http://blog.trifork.com/2013/08/01/server-side-clustering-of-geo-points-on-a-map-using-elasticsearch/)

我实际上正在探索为 Google Maps API v3 开发类似的聚类算法。如果我真的能得到它，我会发布更多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T22:13:10.023

您可以使用 geohash 或空间填充曲线来减少维度并重新排序和散列标记。在服务器端，您可以使用点和空间索引数据结构，但您也可以手动计算 geohash。寻找 xkcd 互联网地图漫画和希尔伯特曲线，看看它是如何工作的。

# opencv - cvFindContour() 的更快替代方案

> ID：11335951
> 
> 赞同：9
> 
> 时间：2012-07-04T22:18:19.623
> 
> 标签：opencv, arm, computer-vision, augmented-reality

轮廓检测占用了我在计算机视觉中的大部分时间，它需要更快。我已经通过 NEON 指令优化了其他所有内容并进行了矢量化，实际上，轮廓检测在轮廓中占主导地位。不幸的是，我不清楚如何优化它。

我正在执行经典的矩形检测过程来查找基准标记，即 cvFindContours()，然后从轮廓近似正方形。在许多标记可见的情况下（或灾难性的，当不可见标记的密集矩形网格可见时），单独调用 cvFindContours() 在 iPhone 上可能需要超过 30 毫秒。

我已经用 cvFindContours() 替换了极其昂贵的 C++ cv::FindContours()。特别是如果传递一个向量 >，C++ 版本分配和填充向量的时间比其内部 cvFindContours() 花费的时间长！

现在，我完全被 cvFindContours 中的时间所束缚，或者更具体地说，在 cvFindNextContour() 中。cvFindNextContour 中的代码是分支繁重的，并且显然不容易矢量化。它还实现了一个复杂的算法，我不相信自己在任何优化尝试中都不会出错。

我已经看过 cvBlobLib（为了消除歧义，我指的是这个：[http](http://code.google.com/p/cvblob/) ://code.google.com/p/cvblob/ ），看看它是否提供了可以更快地完成同样事情的替代算法。源的基本下载非常慢，因为它将轮廓记录到 std::list() 中，并且几乎所有时间都花在内存分配上。用一个预先调整为 256 个元素的 std::vector 替换该列表以消除 push_back() 上的初始副本，仍然会得到一个比 cvFindContours() 长 3 倍的函数，其中 66% 直接在 cvb::cvLabel( ）。所以走这条路似乎不太可行。

有没有人对我如何优化对许多矩形的检测有任何想法。我含糊的挥手包括：

1.  是否有任何与 cvFindContour() 等效的快速实现，理想情况下作为源代码，因为我是多平台的，在那里？

2.  大多数轮廓不是必需的，只有“成功”的矩形有用。特别是，它们的内部轮廓就没有用了。从理论上讲，我可以根本不调用 cvFindContours，而是调用 cvStartFindContours/cvFindNextContour，测试找到的每个轮廓，如果我找到了我正在寻找的矩形，则不递归，因为子矩形保证是无用的？

3.  我可以从经典的 FindContours()/ApproxPoly() 方法中使用完全不同的矩形检测算法吗？

4.  有没有办法用有用的感兴趣区域“准备”cvFindContours？例如，即使使用非常激进的阈值，FAST 角点检测几乎总是会返回我的基准标记角点。有没有办法使用该点来限制检测？（不幸的是，我不确定这有多大帮助，同样在许多标记或与标记无关的密集网格线的情况下，这在我的应用程序中经常发生。）

5.  与上述相同，由于 Blob 检测可以（如果我理解正确的话）实现为递归洪水填充，是否有任何快速矢量化实现可以用于以某种方式提取有趣的 Blob 矩形和种子轮廓检测从那里？

欢迎任何想法！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-13T13:34:59.103

由于您的目标是矩形检测而不是轮廓检测，我建议使用积分图像进行计算。积分图像的解释可以在[这里](http://computersciencesource.wordpress.com/2010/09/03/computer-vision-the-integral-image/)找到。在计算出所需图像的积分图像后，可以通过三个操作来计算矩形的像素和。

假设您想在每个非黑色对象周围绘制矩形，您可以使用如下方法。递归地将图像及其子图像划分为 4，并丢弃像素和低于所需阈值的矩形。您将留下许多与您的对象近似的小矩形。合并相邻的矩形将产生检测到的对象的快速近似值。

# jquery - 关于 jQuery load() 的概念

> ID：11335952
> 
> 赞同：1
> 
> 时间：2012-07-04T22:18:43.100
> 
> 标签：jquery

我刚开始学习 jquery，我在一些概念问题上苦苦挣扎。如果我使用 load() 来更新我网站中的 div 部分之一，例如：

```
 //link to open another page        
    $('a#open_page').click(function() {
        var myURL = "page.php";
        $('#ajaxHandle').load(myURL);
        return false;
    }); 
```

我的问题是，page.php 中的所有内容都会按字面意思加载吗？如果 page.php 有一些标题或 php 代码，它们也会被加载吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T22:21:15.707

这将从服务器获取 URL 并将带有 id 的元素的内容替换为`ajaxHandle`结果。

请求返回的内容取决于您的服务器。如果有 PHP 代码，并且正常执行，那么你会得到执行的 PHP 的响应。它就像一个普通的 HTTP 请求（就像你用来服务原始页面的那个）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-04T22:21:47.203

是的，服务器将执行该文件中的任何服务器端代码，然后再将其返回给浏览器。

`script`在将内容插入元素之前，浏览器将执行任何 JavaScript（例如元素中的 JavaScript ）（除非您将选择器附加到 URL，在这种情况下`script`元素被剥离而不执行）。

该`load`方法只是发出普通 AJAX 请求的一种更短的方法。默认情况下，它发出一个 GET 请求。如果您指定要发送到服务器的数据，它会发出 POST 请求。

# matlab - 如何在Matlab中制作向量长度不等的矩阵？

> ID：11335958
> 
> 赞同：0
> 
> 时间：2012-07-04T22:19:29.513
> 
> 标签：matlab, vector, matrix, concatenation

我在不同的时间（`t`）有不同的分布，每个分布都有`10,000`元素。我有以下代码行，它计算循环内不同分布的 CDF，`t`变化范围`1`为`nT`：

```
[f_CDF(:,t),x_CDF(:,t)]=ecdf(uncon_noise_columndata_all_nModels_diff_t(:,1,t)); 
```

Matlab 的函数`ecdf`给出的 CDF 值可能小于分布中元素的总数，因为重复元素的概率会相加。结果，由于不同的向量长度不同，输出变量`f_CDF`会`x_CDF`遇到错误问题。`??? Subscripted assignment dimension mismatch.``t`

如何对这个问题进行排序，`NaN`以便填充向量长度小于整个矩阵中任何向量的最大长度的地方，并且我能够在循环内实现上述代码行。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-04T22:32:58.597

以下是解决此问题的多种方法中的两种：

## 1) 使用元胞数组

考虑将结果存储在元胞数组而不是矩阵中，根据定义，矩阵要求列具有相同的长度。

```
[f_CDF{t},x_CDF{t}]=ecdf(uncon_noise_columndata_all_nModels_diff_t(:,1,t));

```

## 2) 预分配 NaN 矩阵

在运行计算 CDF 结果的循环之前，创建一个填充有 NaN 的矩阵。您知道每列不会超过 10,000 条记录。

```
f_CDF = NaN * ones(10000, nT);
x_CDF = NaN * ones(10000, nT);
for t = 1:nT
    [f_CDFTemp, x_CDFTemp]=ecdf(uncon_noise_columndata_all_nModels_diff_t(:,1,t));
    f_CDF(1:length(f_CDFTemp),t) = f_CDFTemp;
    x_CDF(1:length(x_CDFTemp),t) = x_CDFTemp;
end 
```

# ruby-on-rails - 未定义的邀请方法“signup_path”（仍然无法发送测试邀请）

> ID：11335966
> 
> 赞同：0
> 
> 时间：2012-07-04T22:20:42.380
> 
> 标签：ruby-on-rails, actionmailer

在过去的几天里，我正在尝试应用一个 beta 邀请系统。我遵循了 railcasts 第 124 课。我为我的用户定制了它。

我的路线.rb

```
resources :invitations, only: [:new, :create]
match '/signup/:invitation_token',  to: 'users#new' 
```

邀请模型：

```
class Invitation < ActiveRecord::Base
  attr_accessible :new, :recipient_email, :user_id, :sent_at, :token

  belongs_to :user
    has_one :recipient, :class_name => 'User'

    validates_presence_of :recipient_email
    validate :recipient_is_not_registered
    validate :user_has_invitations, :if => :user

    before_create :generate_token
    before_create :decrement_user_count, :if => :user

    private

    def recipient_is_not_registered
        errors.add :recipient_email, 'zaten siteye üye' if User.find_by_email(recipient_email)
    end

    def user_has_invitations
        unless user.invitation_limit > 0
            errors.add_to_base 'Siteye davetiyeniz kalmamıştır.'
        end
    end

    def generate_token
        self.token = Digest::SHA1.hexdigest([Time.now, rand].join)
    end

    def decrement_user_count
        user.decrement! :invitation_limit
    end
end 
```

邀请控制器：

```
class InvitationsController < ApplicationController
    def new
        @invitation = Invitation.new
    end

    def create
        @invitation = Invitation.new(params[:invitation])
        @invitation.user = current_user
        if @invitation.save
            if signed_in?
                Mailer.deliver_invitation(@invitation, signup_path(@invitation.token))
                flash[:notice] = "Teşekkürler,davetiniz gönderildi."
                redirect_to root_path
            else
                flash[:notice] = "Teşekkürler,sizi almaya hazır olduğumuzda bildireceğiz."
                redirect_to root_path
            end
        else
    render :action => 'new'
        end
    end
end 
```

. 这是我的 mailer.rb：

```
def invitation(invitation, signup_url)
  subject    'Siteye Davet'
  recipients invitation.recipient_email
  from       'foo@example.com'
  body       :invitation => invitation, :signup_url => signup_path
  invitation.update_attribute(:sent_at, Time.now)
end 
```

当我发送邀请时，我的日志文件显示：

```
 INSERT INTO "invitations" ("created_at", "recipient_email", "sent_at", "token", "updated_at", "user_id") VALUES (?, ?, ?, ?, ?, ?)  [["created_at", Wed, 04 Jul 2012 21:55:13 UTC +00:00], ["recipient_email", "neveryt@gmail.com"], ["sent_at", nil], ["token", "c29e2dcc22c033a1e975f5755795db9f2a8fd5c2"], ["updated_at", Wed, 04 Jul 2012 21:55:13 UTC +00:00], ["user_id", 1]]
   (131.3ms)  commit transaction
Completed 500 Internal Server Error in 208ms

NoMethodError (undefined method `signup_path' for #<InvitationsController:0x000000044ef508>): 
```

我可以理解我必须更改 signup_url 的。但我找不到正确的方法。如何修复邀请创建操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T22:26:48.823

您需要将您的`match`声明更改为`routes.rb`：

```
match '/signup/:invitation_token',  to: 'users#new', as: 'signup' 
```

这将通知 Rails`signup_path`是链接到的匹配路由的名称`/signup/:invitation_token`。

# .htaccess - Yii 中用户友好的 URL

> ID：11335967
> 
> 赞同：5
> 
> 时间：2012-07-04T22:21:02.633
> 
> 标签：.htaccess, yii

我一直在用 Yii 做一些实验，看看它是否适合我的需要。我想要启用的第一件事是用户友好的 URL。

我想要实现的目标：从这个 URL`webapproot/index.php?r=site/contact`到这个 URL `webapproot/contact`。

我做了什么：

*   使用 Yiic ( `php YiiRoot/framework/yiic.php webapp testdrive`)创建了一个应用程序
*   [按照Yii 文档](http://www.yiiframework.com/doc/guide/1.1/en/topics.url)中此链接的第 2 步和第 6 步进行操作（“用户友好的 URL”和“隐藏 index.php”）。

发生的情况是我不断收到 404。关于我做错了什么有什么想法吗？

以下是该问题的一些相关摘录：

## [项目根目录]/protected/config/main.php

```
(...)
'urlManager'=>array(
    'urlFormat'=>'path',
    'showScriptName'=>false,
    'rules'=>array(
        '<controller:\w+>/<id:\d+>'=>'<controller>/view',
        '<controller:\w+>/<action:\w+>/<id:\d+>'=>'<controller>/<action>',
        '<controller:\w+>/<action:\w+>'=>'<controller>/<action>',
    ),
),
(...) 
```

## [项目根目录]/.htaccess

```
RewriteEngine on

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

RewriteRule . index.php 
```

## /etc/apache2/httpd.conf

```
(...)
LoadModule rewrite_module libexec/apache2/mod_rewrite.so
(...)
<Directory [path to my web projects folder]>
    Options FollowSymLinks
    AllowOverride All
    Order deny,allow
</Directory>
(...) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T05:55:17.820

如果您只想要/contact，您的链接必须`webapproot/site/contact`与控制器/操作中的一样，您需要创建一个带有索引视图的联系人控制器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-05T14:22:49.890

从您的最新评论看来，您还需要设置[RewriteBase](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewritebase)。正如我在对您的问题的第一条评论中提到的那样，如果您的网络服务器的 DocumentRoot 和您的网络应用程序位于不同的文件夹中，则可能会出现此问题。试试这个：

```
RewriteEngine on

RewriteBase /~username/yourwebappfolder
#rest of your rewrite conditions/rules 
```

要调试 htaccess 或其他服务器配置，请检查您的服务器 error_log，对于 mac lion，它位于文件中：*/var/log/apache2/error_log*

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-05T12:38:06.090

如果您不想将其移到外面（尽管@Pentium10 的回答已经足够好了），您可以为要从路径`SiteController`中提取的每页添加一条规则。`/site/`但是，这有点脏，因为您需要尽量不要与其他名为contact、login 或其他名称的控制器发生冲突：

```
'urlManager'=>array(
    'urlFormat'=>'path',
    'showScriptName'=>false,
    'rules'=>array(
        'contact'=>'site/contact',
        '<controller:\w+>/<id:\d+>'=>'<controller>/view',
        '<controller:\w+>/<action:\w+>/<id:\d+>'=>'<controller>/<action>',
        '<controller:\w+>/<action:\w+>'=>'<controller>/<action>',
    ),
), 
```

你基本上是在告诉 Yii 任何请求`/contact`实际上都是对 的请求`/site/contact`。如果您刚开始创建项目并且仍然使用基本的默认布局，请查看`CMenu`Contact 链接，您会看到它现在指向`webapproot/contact`而不是`webapproot/site/contact`

祝你今天过得愉快

# java - 调整大小时 LWJGL 光标问题

> ID：11335973
> 
> 赞同：1
> 
> 时间：2012-07-04T22:21:53.367
> 
> 标签：java, opengl, lwjgl

我可能有一个简单的数学问题，我很难弄清楚。我有一个可调整大小的 LWJGL (OpenGL) 窗口。我正在制作的游戏是 2D 的，但我使用 glFrustum() 来获取我的精灵的深度。这是我的投影代码中的一个（稍微简化的）片段：

```
double divider = 64.0;
double left = -vw / divider;
double right = vw / divider;
double bottom = vh / divider;
double top = -vh / divider;

glMatrixMode(GL_PROJECTION);
glLoadIdentity();
glFrustum(left * aspect, right * aspect, bottom, top, 8, 65536);

float zModifier = -256;
float vRatio = Game.HEIGHT / Display.getHeight();

glMatrixMode(GL_MODELVIEW);
glLoadIdentity();
glTranslatef(-vw / 2.0f, -vh / 2.0f, zModifier * vRatio); 
```

（我必须承认我不太了解截锥体，我在互联网的某个地方找到了这段代码，它对我很有帮助......）

但是，我正在用精灵渲染我自己的光标，并在光标与窗口边框接触时切换到本机光标。在我调整窗口大小之前，这一切都很好。

现在我的问题是，当我调整窗口大小时，本机光标与相对于`vRatio`. 根据调整后的窗口大小，它会“跳跃”一点或更多。

当精灵光标与边框接触时，我执行以下操作：

1.  隐藏精灵光标
2.  显示本机光标
3.  将本机光标的位置设置为精灵光标的位置*（这不再正常工作）*

我觉得对此有一个简单的数学解决方案，但我无法弄清楚（我已经尝试过......但是......）。

我希望我的问题不是太模糊，并且我提供了足够的信息！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T13:11:30.170

起初，您的窗口大小与 OpenGL 的大小相匹配。但是当你调整窗口大小时，投影必须改变。所以至少添加了一个比例因子。这解释了为什么光标不同步。

如果你想让它们一直同步，你必须将窗口坐标映射到世界坐标。这可以通过`gluUnProject` [OpenGL：gluUnProject](http://www.opengl.org/sdk/docs/man/xhtml/gluUnProject.xml)来完成。您已经在手动执行此操作，但没有考虑导致问题的分辨率变化。

为了完整起见，反过来，从世界坐标到窗口坐标，也是可能的[OpenGL：gluProject](http://www.opengl.org/sdk/docs/man/xhtml/gluProject.xml)

使用这些函数时，您必须掌握模型矩阵、投影矩阵和视口。为此目的使用 glGet* 系列的函数。确保在正确设置的位置加载这些矩阵！

# actionscript-3 - Starling Framework - 加载外部 swf / 共享上下文

> ID：11335981
> 
> 赞同：1
> 
> 时间：2012-07-04T22:23:05.003
> 
> 标签：actionscript-3, external, stage3d, starling-framework

我有一个项目，其中包括主菜单和几个级别（页面），所有这些都基于 Starling 框架。我想将页面与主应用程序分开，以将逻辑、视图和效果保留在外部 swf 中。

示例：用户可以选择不同游戏（拼图、乒乓球、国际象棋......）、页面（“选项”、“关于”）的应用程序菜单。这些组件彼此无关，所以我不想做一个巨大的项目。分离这些页面并将它们加载到主应用程序的最佳做法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T07:36:20.957

我会考虑两种选择。两者都可能需要您为可以附加到主应用程序根目录的每个组件创建一个主精灵类。

1.  在主应用程序中嵌入所有不同的 SWF，并在主应用程序的组件 SWF 中实例化类。

    *   [嵌入 Flash](http://www.adobe.com/devnet/flash/articles/embed_metadata.html?PID=5232140)
    *   [在 AS3 中嵌入资产](http://livedocs.adobe.com/flex/3/html/help.html?content=embed_4.html)
2.  将不同的组件导出为 SWC 并将它们导入您的主项目，以便您可以在主应用程序中实例化它们。

    *   [使用 SWC 构建大型项目](http://www.adobe.com/devnet/flash/articles/combine-swfs-with-swcs.html?PID=5232140)

# asp.net - 为什么 bitmap.Save 与 ImageFormat 和 ImageCodecInfo 之间的区别在 .net 中如此之大？

> ID：11335982
> 
> 赞同：1
> 
> 时间：2012-07-04T22:23:19.560
> 
> 标签：asp.net, .net, image-processing, bitmap, jpeg

我正在尝试在 asp.net 中调整图像大小。除了实际调整大小的代码之外，我想知道为什么位图的 Save 重载之间存在如此大的差异

方法一

```
 ImageCodecInfo jpgEncoder =
        ImageCodecInfo.GetImageDecoders()
        .First(c => c.FormatID == ImageFormat.Jpeg.Guid);
    Encoder encoder = Encoder.Quality;
    EncoderParameters encoderParameters = new EncoderParameters(1);
    encoderParameters.Param[0] = new EncoderParameter(encoder, (long)quality);
bitmap.Save(_current_context.Response.OutputStream,jpgEncoder,encoderParameters) 
```

方法二

```
bitmap.Save(_current_context.Response.OutputStream,ImageFormat.Jpeg) 
```

因此，方法 1 以 100 质量输出此特定 jpeg 图像，大小约为 250kb。在 90 质量下，它下降到大约 100kb

然而，方法 2 将图像降低到大约 60kb，这是一个巨大的差异，并且也没有明显的差异。

我似乎找不到任何地方为什么差异如此之大，MSDN 关于这两个重载的细节为零。

任何见解都值得赞赏。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T04:30:31.953

查看似乎没有提供提取设置的方法的 ImageCodeInfo / Encoder 对象。我假设默认情况下它在保存时将质量设置为 100。

如果不深入研究 Windows Imaging 的东西，真的很难说。

您可以尝试使用 Default save (Method2) 和 Method 1 使用 100 来编写代码，看看它们是否相同。很可能是这样。

[http://msdn.microsoft.com/en-us/library/system.drawing.imaging.encoder.quality.aspx#Y800](http://msdn.microsoft.com/en-us/library/system.drawing.imaging.encoder.quality.aspx#Y800)

# php - 类的 Doctrine/symfony2 对象无法转换为字符串

> ID：11335991
> 
> 赞同：-1
> 
> 时间：2012-07-04T22:24:56.813
> 
> 标签：php, symfony, doctrine, doctrine-orm

我在 Symfony 2 中的项目有问题我收到此错误

```
Catchable Fatal Error: Object of class Nicearma\MemesBundle\Entity\Usuario could not be converted to string in C:\wamp\www\24memes\vendor\doctrine-dbal\lib\Doctrine\DBAL\Statement.php line 131 
```

问题是，我试图从 UsuarioInfo 类做一个表单，并且这个类有一个对象 Usuario，表单工作正常，但是发送信息我收到消息而且我找不到解决方案，任何人都知道如何解决这个问题? 我有这个文件

registro.html.twig

```
<div class="usuario">
{{ form_row(form.usuario) }}
</div>
{{ form_rest(form) }} 
```

Usuario.php

```
namespace Nicearma\MemesBundle\Entity;

use Doctrine\ORM\Mapping as ORM;
use Symfony\Component\Security\Core\User\UserInterface;
use Symfony\Component\Validator\Constraints as Assert;

/**
 * Nicearma\MemesBundle\Entity\Usuario
 *
 * @ORM\Table(name="usuario")
 * @ORM\Entity(repositoryClass="Nicearma\MemesBundle\Repository\Usuario")
 */
class Usuario implements UserInterface
{
    /**
     * @var integer $id
     * @ORM\Column(name="id", type="integer", nullable=false)
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="IDENTITY")
     */
    private $id;

    /**
     * @var string $nombre
     * @Assert\Type(type="String") 
     * @Assert\MaxLength(255)
     * @Assert\NotBlank
     * @ORM\Column(name="nombre", type="string", length=255, nullable=false)
     */
    private $nombre;

     /**
     * @var string $clave
     * @Assert\NotBlank
     * @Assert\Type(type="String")
     * @Assert\MaxLength(255)
     * @ORM\Column(name="clave", type="string", length=255, nullable=false)
     */
    private $clave;

    /**
     * @var integer $punto
     *
     * @ORM\Column(name="punto", type="integer", nullable=false)
     */
    private $punto;

    /**
     * @var UsuarioEstado
     *
     * @ORM\ManyToOne(targetEntity="UsuarioEstado")
     * @ORM\JoinColumns({
     *   @ORM\JoinColumn(name="id_usuario_estado", referencedColumnName="id")
     * })
     */
    private $UsuarioEstado;

     /**
     * @var IdUsuarioEstado
     * @ORM\Column(name="id_usuario_estado", type="integer", nullable=false)
     * })
     */
    private $idUsuarioEstado;

    /**
     * @var UsuarioTipo
     *
     * @ORM\ManyToOne(targetEntity="UsuarioTipo")
     * @ORM\JoinColumns({
     *   @ORM\JoinColumn(name="id_usuario_tipo", referencedColumnName="id")
     * })
     */
    private $UsuarioTipo;

   /**
     * @var idUsuarioTipo
     * @ORM\Column(name="id_usuario_tipo", type="integer", nullable=false)
     */

    private $idUsuarioTipo;

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * Set nombre
     *
     * @param string $nombre
     */
    public function setNombre($nombre)
    {
        $this->nombre = $nombre;
    }

    /**
     * Get nombre
     *
     * @return string 
     */
    public function getNombre()
    {
        return $this->nombre;
    }

    /**
     * Set punto
     *
     * @param integer $punto
     */
    public function setPunto($punto)
    {
        $this->punto = $punto;
    }

    /**
     * Get punto
     *
     * @return integer 
     */
    public function getPunto()
    {
        return $this->punto;
    }

    /**
     * Set UsuarioEstado
     *
     * @param Nicearma\MemesBundle\Entity\UsuarioEstado $idUsuarioEstado
     */
    public function setUsuarioEstado(\Nicearma\MemesBundle\Entity\UsuarioEstado $UsuarioEstado)
    {
        $this->UsuarioEstado = $UsuarioEstado;
    }

    /**
     * Get UsuarioEstado
     *
     * @return Nicearma\MemesBundle\Entity\UsuarioEstado 
     */
    public function getUsuarioEstado()
    {
        return $this->UsuarioEstado;
    }
     /**
     * Set idUsuarioEstado
     *
     * @param integer $idUsuarioEstado
     */
    public function setIdUsuarioEstado( $idUsuarioEstado)
    {
        $this->idUsuarioEstado = $idUsuarioEstado;
    }

    /**
     * Get idUsuarioEstado
     *
     * @return integer
     */
    public function getIdUsuarioEstado()
    {
        return $this->idUsuarioEstado;
    }

    /**
     * Set UsuarioTipo
     *
     * @param Nicearma\MemesBundle\Entity\UsuarioTipo $idUsuarioTipo
     */
    public function setUsuarioTipo(\Nicearma\MemesBundle\Entity\UsuarioTipo $UsuarioTipo)
    {
        $this->UsuarioTipo = $UsuarioTipo;
    }

    /**
     * Get UsuarioTipo
     *
     * @return Nicearma\MemesBundle\Entity\UsuarioTipo 
     */
    public function getUsuarioTipo()
    {
        return $this->UsuarioTipo;
    }

    /**
     * Set idUsuarioTipo
     *
     * @param integer $idUsuarioTipo
     */
    public function setIdUsuarioTipo( $idUsuarioTipo)
    {
        $this->idUsuarioTipo = $idUsuarioTipo;
    }

    /**
     * Get idUsuarioTipo
     *
     * @return integer
     */
    public function getIdUsuarioTipo()
    {
        return $this->idUsuarioTipo;
    }

    public function equals(UserInterface $user)
    {
        return $this->username === $user->getUsername();
    }

    public function eraseCredentials() {

    }

    public function getPassword() {
        return $this->clave;
    }

    public function getRoles() {
       $this->idUsuarioTipo->getTipo();
    }

    public function getSalt() {
        return null;
    }

    public function getUsername() {
        return $this->nombre;
    }

    /**
     * Set clave
     *
     * @param string $clave
     */
    public function setClave($clave)
    {
        $this->clave = $clave;
    }

    /**
     * Get clave
     *
     * @return string 
     */
    public function getClave()
    {
        return $this->clave;
    }
} 
```

UsuarioType.php

```
namespace Nicearma\MemesBundle\Form;

use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\FormBuilder;

class UsuarioType extends AbstractType
{
    public function buildForm(FormBuilder $builder, array $options)
    {
        $builder
            ->add('nombre')
            ->add('clave')
        ;
    }
    public function getDefaultOptions(array $options)
    {
    return array(
        'data_class' => 'Nicearma\MemesBundle\Entity\Usuario',
    );
    }
    public function getName()
    {
        return 'Usuario';
    }
} 
```

usuarioInfo.php

```
namespace Nicearma\MemesBundle\Entity;

use Doctrine\ORM\Mapping as ORM;
use Symfony\Component\Validator\Constraints as Assert;
/**
 * Nicearma\MemesBundle\Entity\UsuarioInfo
 *
 * @ORM\Table(name="usuario_info")
 * @ORM\Entity
 */
class UsuarioInfo
{
    /**
     * @var integer $id
     * 
     * @ORM\Column(name="id", type="integer", nullable=false)
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="IDENTITY")
     */
    private $id;

    /**
     * @var string $correo
     * Assert\Email
     * @ORM\Column(name="correo", type="string", length=255, nullable=false)
     */
    private $correo;

    /**
     * @var Usuario
     * @Assert\Type(type="Nicearma\MemesBundle\Entity\Usuario")
     * @ORM\OneToOne(targetEntity="Usuario")
     * @ORM\JoinColumns({
     *   @ORM\JoinColumn(name="id_usuario", referencedColumnName="id")
     * })
     */
    private $Usuario;

     /**
     * @var idUsuario
     * @ORM\Column(name="id_usuario", type="integer", nullable=false)
     */
    private $idUsuario;

    /**
     * @var Nacionalidad
     * @Assert\Type(type="Nicearma\MemesBundle\Entity\Nacionalidad")
     * @ORM\ManyToOne(targetEntity="Nacionalidad")
     * @ORM\JoinColumns({
     *   @ORM\JoinColumn(name="id_pais", referencedColumnName="id")
     * })
     */
     private $Pais;

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * Set correo
     *
     * @param string $correo
     */
    public function setCorreo($correo)
    {
        $this->correo = $correo;
    }

    /**
     * Get correo
     *
     * @return string 
     */
    public function getCorreo()
    {
        return $this->correo;
    }

    /**
     * Set Usuario
     *
     * @param Nicearma\MemesBundle\Entity\Usuario $Usuario
     */
    public function setUsuario(\Nicearma\MemesBundle\Entity\Usuario $Usuario)
    {
        $this->Usuario = $Usuario;
    }

    /**
     * Get Usuario
     *
     * @return Nicearma\MemesBundle\Entity\Usuario 
     */
    public function getUsuario()
    {
        return $this->Usuario;
    }

    /**
     * Set Pais
     *
     * @param Nicearma\MemesBundle\Entity\Nacionalidad $Pais
     */
    public function setPais(\Nicearma\MemesBundle\Entity\Nacionalidad $Pais)
    {
        $this->Pais = $Pais;
    }

    /**
     * Get Pais
     *
     * @return Nicearma\MemesBundle\Entity\Nacionalidad 
     */
    public function getPais()
    {
        return $this->Pais;
    }
} 
```

usuarioInfoType.php

```
namespace Nicearma\MemesBundle\Form;

use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\FormBuilder;
use Doctrine\ORM\EntityRepository;

class UsuarioInfoType extends AbstractType
{
    public function buildForm(FormBuilder $builder, array $options)
    {
        $builder
            ->add('correo')
            ->add('pais', 'entity', array ('class'=>'Nicearma\\MemesBundle\\Entity\\Nacionalidad','property'=>'nom_pais'))
            ->add('usuario',new UsuarioType);    
        ;
    }

    public function getDefaultOptions(array $options)
    {
    return array(
        'data_class' => 'Nicearma\MemesBundle\Entity\UsuarioInfo',
    );
    }

    public function getName()
    {
        return 'UsuarioInfo';
    }
} 
```

控制器是

```
public function registroAction(Request $peticion){
        $regUs= new \Nicearma\MemesBundle\Entity\UsuarioInfo();
        $formulario = $this->createForm(new \Nicearma\MemesBundle\Form\UsuarioInfoType(),  $regUs);
        if ($peticion->getMethod() == 'POST') {
            $formulario->bindRequest($peticion);
            if ($formulario->isValid()) {
               // $regUs->setIdUsuario(1);
                $em = $this->getDoctrine()->getEntityManager();
                $
                $em->persist($regUs);
                $em->flush();
                $base->flush();
               return $this->redirect($this->generateUrl('DenunciaEnviada'));
            }else{

            }
        }
        return $this->render('NicearmaMemesBundle:Usuario:usuarioRegistro.html.twig', array('form' => $formulario->createView(),'titulo'=>'Crear usuario','descripcion'=>'usuario','claves'=>'us','nombre'=>'Prueba usuario'));
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-06-26T06:24:00.500

如此简单，它返回了关系类的对象。

--> 您正在使用主类的 getter 方法，您在该主类上应用了查询，进一步使用关系类的 getter 方法。

例如

> $exp->getExperiencesCompany()->getName();

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-05T23:11:14.733

对于 OneToOne 关系，您应该使用 JoinColumn 注释而不是您正在执行的操作“JoinColumns(JoinColumn)”。您可以从教义 orm 文档[http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/association-mapping.html#one-to-one-bidirectional查看示例](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/association-mapping.html#one-to-one-bidirectional)

所以，你可以先尝试更新 UsuarioInfo 的“Usuario”的属性注解

```
/**
 * @var Usuario
 * @Assert\Type(type="Nicearma\MemesBundle\Entity\Usuario")
 * @ORM\OneToOne(targetEntity="Usuario")
 * @ORM\JoinColumns({
 *   @ORM\JoinColumn(name="id_usuario", referencedColumnName="id")
 * })
 */
private $Usuario; 
```

至

```
/**
 * @var Usuario
 * @Assert\Type(type="Nicearma\MemesBundle\Entity\Usuario")
 * @ORM\OneToOne(targetEntity="Usuario")
 * @ORM\JoinColumn(name="id_usuario", referencedColumnName="id")
 */
private $Usuario; 
```

这同样适用于 Usuario 的“UsuarioEstado”、“UsuarioTipo”属性。查看 ManyToOne 的示例注释[http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/association-mapping.html#many-to-one-unidirectional](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/association-mapping.html#many-to-one-unidirectional)

因此，请确保通过检查您使用正确的注释来正确配置您的实体，然后再试一次:)

# jquery - 带有jQuery的HTML页面拒绝提交？

> ID：11335992
> 
> 赞同：1
> 
> 时间：2012-07-04T22:25:16.147
> 
> 标签：jquery, jquery-validate

我是 jQuery 的初学者，正在尝试构建一个简单的 html 页面。该页面呈现良好并使用 jQuery 正确验证/行为，但是当一切都有效时，它不会在单击“提交”按钮时提交。我的html文件的完整页面代码如下。为什么表单拒绝提交？

```
<html>
<head>
<title>jQuery UI Example Page</title>
<link type="text/css" href="css/cupertino/jquery-ui-1.8.21.custom.css"   rel="stylesheet" />
<script type="text/javascript" src="js/jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="js/jquery-ui-1.8.21.custom.min.js"></script>
<script type="text/javascript" src="http://jzaefferer.github.com/jquery-validation/jquery.validate.js"></script>
<script type="text/javascript">
    jQuery.validator.setDefaults({
        debug: true,
        success: "valid"
    }); ;
</script>
<script>
    $.validator.addMethod(
    "regex",
    function (value, element, regexp) {
        var re = new RegExp(regexp);
        return this.optional(element) || re.test(value);
    },
    "Please check your input."
 );
</script>
<script type="text/javascript">
    /**
    * @author GeekTantra
    * @date 24 September 2009
    */
    /*
    * This functions checks where an entered date is valid or not.
    * It also works for leap year feb 29ths.
    * @year: The Year entered in a date
    * @month: The Month entered in a date
    * @day: The Day entered in a date
    */
    function isValidDate(year, month, day) {
        var date = new Date(year, (month - 1), day);
        var DateYear = date.getFullYear();
        var DateMonth = date.getMonth();
        var DateDay = date.getDate();
        if (DateYear == year && DateMonth == (month - 1) && DateDay == day)
            return true;
        else
            return false;
    }
    /*
    * This function checks if there is at-least one element checked in a group of
    * check-boxes or radio buttons.   
    * @id: The ID of the check-box or radio-button group
    */
    function isChecked(id) {
        var ReturnVal = false;
        $("#" + id).find('input[type="radio"]').each(function () {
            if ($(this).is(":checked"))
                ReturnVal = true;
        });
        $("#" + id).find('input[type="checkbox"]').each(function () {
            if ($(this).is(":checked"))
                ReturnVal = true;
        });
        return ReturnVal;
    }
</script>
<script type="text/javascript">
    $.validator.addMethod(
  "totalValidationDate",
   function (value, element) {

       return isValidDate(parseInt(value.split('/')[2]),  parseInt(value.split('/')[0]), parseInt(value.split('/')[1])) || this.optional(element);
   },
  "Please enter a date in the format mm/dd/yyyy"
);
</script>
<script>
    $(document).ready(function () {
        $("#commentForm").validate({
            rules: {
                date1: {
                    required: true,
                    totalValidationDate: true
                },
                textBox1: {
                    regex: "^[a-zA-Z'.\\s]{1,40}$"
                }
            }
        });
    });
</script>
<script type="text/javascript">
    $(document).ready(function () {
        $("#date1").datepicker();
    });
</script>
</head>
<body>
<form id="commentForm" method="get" action="http://www.yahoo.com">
 <input type="text" name="date1" id="date1" />
 <input type="text" name="textBox1" id="textBox1" />
 <input type="submit" value="Submit" id="btnSubmit"/>
</form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-05T01:13:47.183

好消息！我能够重现您的问题并解决它：

在您的默认声明块中，添加以下内容：

```
submitHandler: function(form) {
        form.submit();
} 
```

所以它看起来像：

```
jQuery.validator.setDefaults({
    debug: true,
    success: "valid",
    submitHandler: function(form) {
        form.submit();
    }
}); 
```

我已经对其进行了测试，并且可以正常工作。不幸的是，我不知道您为什么需要这样做，但这是解决方法。

对于那些好奇的人来说，稍微更新一下，发生这种情况的原因是[插件源中的这一行](https://github.com/jzaefferer/jquery-validation/blob/master/jquery.validate.js#L55)。如果使用调试，它是防止提交发生的内置功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-05T01:45:08.573

问题是您正试图通过调试更多来运行它。工作示例在这里创建。 [http://codebins.com/codes/home/4ldqpbn/2](http://codebins.com/codes/home/4ldqpbn/2)

```
jQuery.validator.setDefaults({
        debug: true,
        success: "valid"
    }); 
```

应该成为

```
jQuery.validator.setDefaults({
        success: "valid"
    }); 
```

原因是当 debug = true 验证器允许您在不提交表单的情况下检查多个用例时，创建此功能只是为了节省开发人员的时间，因此他们不必来回走动。不幸的是，这个功能消耗了很多时间而不是保存。

# java - 哪个代码更有效？为什么？

> ID：11335995
> 
> 赞同：1
> 
> 时间：2012-07-04T22:26:10.917
> 
> 标签：java, performance

在 Y. Daniel Liang 的“Java 编程简介：综合版”的第四章末尾，我正在做一些编程练习。在问题 4.18 中，我提出了两种不同的解决方案。

哪种解决方案（PatternLoop1 或 PatternLoop2）更有效，为什么？

```
public class PatternLoop1 {
    public static void main(String[] args) {
        for (int counter = 0; counter < 6; ++counter) {
            for (int counter2 = 0; counter2 <= counter; ++counter2) {
                System.out.print(counter2 + 1);
            }
            System.out.println();
        }
    }
} 
```

```
public class PatternLoop2 {
    public static void main(String[] args) {
        for (int counter = 1; counter < 7; counter++) {
            for (int counter2 = 1; counter2 < 7 && counter2 <= counter; counter2++) {
                System.out.print(counter2);
            }
            System.out.println();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-04T22:28:16.377

编辑：我之前没有注意到这个`code-efficiency`标签。下面的答案是关于解决方案的*有效性*- 代码的有效性包括它的可读性，IMO。（这就是它如何有效地表达其目标。）*效率*差异将非常小。

假设目标是打印 1，然后是 1 2，然后是 123 ... 直到 123456，我会选择两者之间的数字，其中所有数字都是*输出*中涉及的数字：

```
for (int counter = 1; counter <= 6; counter++) {
    for (int counter2 = 1; counter2 <= counter; counter2++) {
        System.out.print(counter2);
    }
    System.out.println();
} 
```

请注意，计数器始终 <= 6，因此我们不需要额外检查是否为`counter2`<= 6。

另请注意，根据我的经验，*大多数*时候我们需要 [0, n) 范围内的数字 - 这里的 [1, n] 要求相对较少。当然，这取决于你在做什么，但你应该考虑表达范围的*自然*方式。如果自然倾向于使上限包含在内，请使用`<=`; 如果自然倾向于使上限排他，请使用`<`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-04T22:35:00.957

答案是没关系。JVM 已经优化了代码，对于这样的细微差别，它可能最终还是会生成相同的指令。此外，优化是一个非常复杂的问题，你不能只看代码就说它更快。实际性能取决于很多隐藏的东西，比如处理器的缓存行为。最后，您不应该首先尝试进行这种优化。除非您发现存在可衡量的性能问题的瓶颈，否则不要打扰。简介，简介，简介。