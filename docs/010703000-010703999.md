# StackOverflow 问答 10703000-10703999

# sockets - Node.js TCP 输入缓冲

> ID：10703000
> 
> 赞同：3
> 
> 时间：2012-05-22T13:25:55.827
> 
> 标签：sockets, node.js, tcp, buffer, socket.io

我不确定我是否做对了，但据我了解，当我将处理程序附加到`data`事件时，它会为我提供在此之前获得的所有数据。问题是，我如何处理缓冲数据，因为 Node.js 一次可能给我少于 4 个字节（这是我需要的最小值），尤其是当有多个并发请求时？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T13:33:02.253

我认为这篇文章已经解决了这个问题：http: [//openmymind.net/2012/1/12/Reading-From-TCP-Streams/](http://openmymind.net/2012/1/12/Reading-From-TCP-Streams/)

链接到那里描述的 2 个解决方案：

*   [https://github.com/karlseguin/redispy/blob/master/lib/reader.coffee](https://github.com/karlseguin/redispy/blob/master/lib/reader.coffee)
*   [https://gist.github.com/1598236](https://gist.github.com/1598236)

# mysql - 带有 MySQL 抛出错误的 Grails

> ID：10703001
> 
> 赞同：0
> 
> 时间：2012-05-22T13:26:06.313
> 
> 标签：mysql, grails

我正在尝试将 MySQL 与 Grails 一起使用。根据 grails 上的文档，我已经下载了 MySQL 连接器并将 jar 文件放在路径 grails-app/lib 中。

但是在运行应用程序时，我遇到了很多错误。其中一些如下，我认为如果解决可以解决其余的问题。

```
| Loading Grails 2.0.3
| Configuring classpath.
| Environment set to development.....
| Packaging Grails application.....
| Compiling 236 source files.
| Error Compilation error: startup failed:
Compile error during compilation with javac.
C:\xp\sst workspace\racetrack\grails-app\lib\src\com\mysql\jdbc\integration\c3p0\MysqlConnectionTester.java:31: error: package com.mchange.v2.c3p0 does not exist
import com.mchange.v2.c3p0.C3P0ProxyConnection;
                          ^
C:\xp\sst workspace\racetrack\grails-app\lib\src\com\mysql\jdbc\integration\c3p0\MysqlConnectionTester.java:32: error: package com.mchange.v2.c3p0 does not exist
import com.mchange.v2.c3p0.QueryConnectionTester;
                          ^
C:\xp\sst workspace\racetrack\grails-app\lib\src\com\mysql\jdbc\integration\c3p0\MysqlConnectionTester.java:44: error: cannot find symbol
public final class MysqlConnectionTester implements QueryConnectionTester {
                                                    ^
  symbol: class QueryConnectionTester
C:\xp\sst workspace\racetrack\grails-app\lib\src\com\mysql\jdbc\integration\jboss\ExtendedMysqlExceptionSorter.java:28: error: package org.jboss.resource.adapter.jdbc.vendor does not exist
import org.jboss.resource.adapter.jdbc.vendor.MySQLExceptionSorter;
                                             ^
.......... etc
44 errors
2 warnings
1 error 
```

请帮我解决这个问题...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T13:42:25.327

1.  文档在哪里说`grails-app/lib`？我相信它应该只是`lib/`
2.  你确定你把二进制jar放在那里，而不是某种源代码jar？

您应该删除您在里面所做的任何事情`grails-app`，然后简单地取消注释该行：

```
 // runtime 'mysql:mysql-connector-java:5.1.16' 
```

在`grails-app/conf/BuildConfig.groovy`

# php - 在给定行之前和之后选择 N 行有条件

> ID：10703002
> 
> 赞同：1
> 
> 时间：2012-05-22T13:26:07.070
> 
> 标签：php, mysql

```
id  title   cat lang
6101    AAba    1   1
6102    AAad    4   2
6103    AAaf    4   2
6104    AAa 1   1
6105    AAtar   4   2
6106    AAao    1   1
6107    ABya    4   2
6108    ABar    4   2
6109    ACar    1   2
6110    BCad    3   1
6111    CCas    4   1
6112    DCas    4   2
6113    GCaz    2   2
6114    FCaew   2   2
6115    FCaw3   4   2
6116    FCa3    1   1
6117    FCa4    4   2
6118    FCa5    2   1
6119    FCa6    4   2 --- last id 
```

表news，id是主键，title-是标题字段，cat-新闻有四种类别，lang-语言代码1或2。

我想实现以下目标： 1）案例**编辑新闻**- id 可用 - 例如 6111，lang 为 1，cat 为 4 我想收集这些 id 和标题：

```
6119
6117
6115
6112
6109
6105
6103
6102 
```

它们是相反的语言 - lang 是 2，同一类别 cat 是 4，并且在给定 id 6111 之前和之后的 4（或 n）id 范围内也排序 desc

2）案例**添加新闻**- id 不可用，或者在 php 中插入后是 mysql_insert_id() 相同的功能 - 最后 10 个 id 具有相同的 cat = 4 和相反的 lang = 2

到目前为止，我已经尝试过：

对于案例 1) php 片段：

```
 $id = 6111;
    $lang = 1;
    $tip = 4;
    $sql = "SELECT id, title 
            FROM pubs 
            WHERE id BETWEEN ".($id-4)." AND ".($id+4). " AND 
            tip = ".$tip." AND 
            lang <> ".$lang." 
            ORDER BY id DESC "; 
```

**但是**这在 id 之前和之后得到了 4 个 id，而不是来自我需要的 id 的集合。

对于案例 2)

```
$sql = "SELECT id, title 
        FROM news 
        WHERE cat = 4 AND 
        lang <> 1 
        ORDER BY id DESC LIMIT 10"; 
```

这似乎有效，但可能是我错了。

有没有办法用 php 和 mysql 实现案例 1？案例2的更好方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T13:51:36.383

鉴于你只有`$id`，这个看起来很可怕的野兽是我能想到的最好的。我相当确定有一种更整洁的方法可以做到这一点，但我*认为*这会奏效（已**修复**）

```
$id = 6111;

$query = "
  SELECT `id`, `title`
  FROM `news`
  WHERE `id` IN (
    SELECT * FROM (
      SELECT `id`
      FROM `news`
      WHERE `cat` = (
        SELECT `cat`
        FROM `news`
        WHERE `id` = ".$id."
      ) AND `lang` != (
        SELECT `lang`
        FROM `news`
        WHERE `id` = ".$id."
      ) AND `id` < ".$id."
      ORDER BY `id` DESC
      LIMIT 4
    ) `lower`
  ) OR `id` IN (
    SELECT * FROM (
      SELECT `id`
      FROM `news`
      WHERE `cat` = (
        SELECT `cat`
        FROM `news`
        WHERE `id` = ".$id."
      ) AND `lang` != (
        SELECT `lang`
        FROM `news`
        WHERE `id` = ".$id."
      ) AND `id` > ".$id."
      ORDER BY `id` ASC
      LIMIT 4
    ) `upper`
  )
  ORDER BY `id` DESC
"; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-22T13:28:30.003

像这样的东西可能会起作用：

```
$sql = "SELECT id, title FROM pubs 
        WHERE tip = ".$tip." AND lang <> ".$lang." 
        ORDER BY id DESC 
        LIMIT ".($id-4).",".($id+4); 
```

可能有一个更优雅的解决方案，但这可以完成工作。

# ios - NSBundle 实例方法 URLForResource:withExtension 在设备上返回无效的 CFStringRef

> ID：10703010
> 
> 赞同：0
> 
> 时间：2012-05-22T13:26:39.290
> 
> 标签：ios, xcode, nsbundle

我在我的代码中进行了以下方法调用：

```
NSURL *modelURL = [[NSBundle mainBundle] URLForResource:@"myappname" withExtension:@"momd"]; 
```

当我在模拟器上运行时，这会返回一个有效的 NSURL。当我在我的设备上运行时，它返回一个无效的 CFStringRef。我究竟做错了什么？

另一个相关的问题，我的xcode项目文件是这样命名的：“MyApp”，而我的包标识符的末尾是这样命名的：“myapp”。

我已经尝试了这两种方法并且得到了相同的结果，但是我读到资源参数字符串是区分大小写的。我应该使用哪一个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T13:33:19.370

尝试：

```
NSString *modelPath = [[NSBundle mainBundle] pathForResource:@"YourModelName" ofType:@"momd"];
NSManagedObjectModel *objectModel = [[NSManagedObjectModel alloc] initWithContentsOfURL:[NSURL fileURLWithPath:modelPath]]; 
```

# draggable - 使当前和未来的元素可拖动

> ID：10703011
> 
> 赞同：0
> 
> 时间：2012-05-22T13:26:41.407
> 
> 标签：draggable

我有一个小的 Web 应用程序，我在其中通过单击一个按钮来创建 DIV。我想让这些创建的 DIV 可拖动，所以我做了一些研究，并阅读了现在不可用的“livequery”插件。

我的问题有解决方案吗？

谢谢您的帮助 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T19:20:11.280

查看[LiveQuery 插件](http://archive.plugins.jquery.com/project/livequery)

# java - Java 创建对象作为函数的参数

> ID：10703013
> 
> 赞同：2
> 
> 时间：2012-05-22T13:26:52.157
> 
> 标签：java, object

因为，我习惯了用 javascript 编码，所以我想创建具有属性的对象。

这是我的代码：

```
jPanel2.add( new JPanel(){ this.add(new JButton("Add")); }); 
```

你有什么建议吗 ？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-22T13:29:34.963

您始终可以使用以下语法：

```
container.add(new JPanel() {{ this.add(new JButton("Add")); }}); 
```

* * *

完整示例：

```
public static void main(String[] args) throws Exception {

    JFrame frame = new JFrame("Test");

    frame.add(new JPanel() {{ this.add(new JButton("Add")); }});

    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.pack();
    frame.setVisible(true);
} 
```

# jetty - 带有签名者信息错误的码头启动错误

> ID：10703016
> 
> 赞同：4
> 
> 时间：2012-05-22T13:26:59.660
> 
> 标签：jetty, maven-jetty-plugin

由于我已将一些 Maven 依赖项设置为“提供”而不是“编译”范围，因此在启动码头时出现此错误：

*   JEE5 应用
*   应该在 WebSphere 7 和 Jetty 7 上运行
*   春天 3

错误：

```
java.lang.SecurityException: class "javax.servlet.ServletRequestListener"'s signer information does not match signer information of other classes in the same package
    at java.lang.ClassLoader.checkCerts(ClassLoader.java:806)
    at java.lang.ClassLoader.preDefineClass(ClassLoader.java:487)
    at java.lang.ClassLoader.defineClassCond(ClassLoader.java:625)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:615)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:141)
    at java.net.URLClassLoader.defineClass(URLClassLoader.java:283)
    at java.net.URLClassLoader.access$000(URLClassLoader.java:58)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:197)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
    at org.codehaus.plexus.classworlds.realm.ClassRealm.loadClassFromSelf(ClassRealm.java:386)
    at org.codehaus.plexus.classworlds.strategy.SelfFirstStrategy.loadClass(SelfFirstStrategy.java:42)
    at org.codehaus.plexus.classworlds.realm.ClassRealm.loadClass(ClassRealm.java:244)
    at org.codehaus.plexus.classworlds.realm.ClassRealm.loadClass(ClassRealm.java:230)
    at org.eclipse.jetty.server.handler.ContextHandler.setEventListeners(ContextHandler.java:554)
    at org.eclipse.jetty.webapp.WebAppContext.setEventListeners(WebAppContext.java:946)
    at org.eclipse.jetty.webapp.WebAppContext.addEventListener(WebAppContext.java:972)
    at org.eclipse.jetty.webapp.TagLibConfiguration.preConfigure(TagLibConfiguration.java:492)
    at org.eclipse.jetty.webapp.WebAppContext.preConfigure(WebAppContext.java:418)
    at org.eclipse.jetty.webapp.WebAppContext.doStart(WebAppContext.java:454)
    at org.mortbay.jetty.plugin.JettyWebAppContext.doStart(JettyWebAppContext.java:256)
    at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
    at org.eclipse.jetty.server.handler.HandlerCollection.doStart(HandlerCollection.java:224)
    at org.eclipse.jetty.server.handler.ContextHandlerCollection.doStart(ContextHandlerCollection.java:167)
    at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
    at org.eclipse.jetty.server.handler.HandlerCollection.doStart(HandlerCollection.java:224)
    at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
    at org.eclipse.jetty.server.handler.HandlerWrapper.doStart(HandlerWrapper.java:90)
    at org.eclipse.jetty.server.Server.doStart(Server.java:260)
    at org.mortbay.jetty.plugin.JettyServer.doStart(JettyServer.java:65)
    at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:59)
    at org.mortbay.jetty.plugin.AbstractJettyMojo.startJetty(AbstractJettyMojo.java:511)
    at org.mortbay.jetty.plugin.AbstractJettyMojo.execute(AbstractJettyMojo.java:364)
    at org.mortbay.jetty.plugin.JettyRunMojo.execute(JettyRunMojo.java:516)
    at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:101)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:209)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)
    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:84)
    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:59)
    at org.apache.maven.lifecycle.internal.LifecycleStarter.singleThreadedBuild(LifecycleStarter.java:183)
    at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:161)
    at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:319)
    at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:156)
    at org.apache.maven.cli.MavenCli.execute(MavenCli.java:537)
    at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:196)
    at org.apache.maven.cli.MavenCli.main(MavenCli.java:141)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:290)
    at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:230)
    at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409)
    at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352) 
```

Maven部分是：

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <packaging>war</packaging>
    <artifactId>myApp.war</artifactId>
    <!--name??-->

    <parent>
        <groupId>com.example</groupId>
        <artifactId>myApp</artifactId>
        <version>0.0.1-SNAPSHOT</version>
    </parent>

    <properties>
        <java-version>1.5</java-version>
        <org.springframework-version>3.0.5.RELEASE</org.springframework-version>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        <org.aspectj-version>1.6.9</org.aspectj-version>
        <org.slf4j-version>1.6.1</org.slf4j-version>
        <cxf.version>2.5.2</cxf.version>
        <jetty.version>7.6.3.v20120416</jetty.version>
        <skipTests>true</skipTests>
        <log4j.version>1.2.15</log4j.version>
    </properties>

    <!-- … -->
             <plugin>
                 <groupId>org.mortbay.jetty</groupId>
                 <artifactId>jetty-maven-plugin</artifactId>
                 <version>${jetty.version}</version>

                 <dependencies>
                     <dependency>
                         <groupId>commons-dbcp</groupId>
                         <artifactId>commons-dbcp</artifactId>
                         <version>1.4</version>
                     </dependency>
                     <dependency>
                         <groupId>commons-logging</groupId>
                         <artifactId>commons-logging</artifactId>
                         <version>1.1</version>
                         <type>jar</type>
                     </dependency>
                 </dependencies>

                 <configuration>
                     <scanIntervalSeconds>5</scanIntervalSeconds>
                     <webAppConfig>
                         <contextPath>/</contextPath>
                     </webAppConfig>
                     <connectors>
                         <connector implementation="org.eclipse.jetty.server.bio.SocketConnector">
                             <port>8080</port>
                             <!-- this connector defaults to 1300 for some reason -->
                         </connector>
                     </connectors>
                     <!--
                     <useProvided>true</useProvided>
                     -->
                 </configuration>
             </plugin> 
```

查不出原因。欢迎任何提示；）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T21:29:46.720

看起来好像您将 servlet API 作为提供的依赖项包含在内，并将其添加到 Jetty 的类路径中。这与 Jetty 自己捆绑的 servlet API 类发生冲突并导致异常。

将 servlet API 作为提供的依赖项包含在内是绝对正确的——问题出`<useProvided>`在插件配置中的参数中，即将 servlet API 添加到类路径中。最好将其排除在外，并且，如果您在 Jetty 中还没有具有提供范围的任何其他依赖项，则将它们添加到插件依赖项中，就像您对`commons-dbcp`.

另请参阅[http://jira.codehaus.org/browse/JETTY-429](http://jira.codehaus.org/browse/JETTY-429)中的评论，其中讨论了类似的潜在混淆。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-13T07:27:59.350

**javax.servlet**我也遇到过类似的问题，因为 Eclipse Libraries/Maven Dependencies 中有 2.4 和 3.0.0 jar 版本。要**在 Eclipse 打开项目的 pom.xml、依赖层次结构选项卡中修复它**，按“servlet”过滤，选择（鼠标右键）不必要的 2.4（或 2.5）和“排除 Maven Artifact ...”感谢 Valery Gorbunov 的提示： )

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T11:36:20.040

我删除了

```
 <dependency>
                 <groupId>commons-logging</groupId>
                 <artifactId>commons-logging</artifactId>
                 <version>1.1</version>
                 <type>jar</type>
             </dependency> 
```

在码头，现在它可以工作了......似乎另一个 Logger 实现与公共日志记录冲突？！还没有得到线索，但现在......它工作......有时maven和java不是最好的朋友，或者我太愚蠢了;）

# redis - Redis无需迭代且不弹出即可获取列表的所有值

> ID：10703019
> 
> 赞同：86
> 
> 时间：2012-05-22T13:27:05.173
> 
> 标签：redis

我有简单的 redis 列表键 => "supplier_id"

现在我只希望它检索列表的所有值而不实际迭代或从列表中弹出值

从列表中检索所有值的示例现在我已经迭代了 redis 长度

```
element = []
0.upto(redis.llen("supplier_id")-1) do |index| 
  element << redis.lindex("supplier_id",index)
 end 
```

这可以在**没有迭代的情况下**通过更好的 redis 建模来完成吗？谁能建议

* * *

## 回答 #1

> 赞同：195
> 
> 时间：2012-05-22T20:26:41.060

要使用 Redis 检索列表的所有项目，您不需要迭代和获取每个单独的项目。这将是非常低效的。

您只需使用[LRANGE](http://redis.io/commands/lrange)命令一次性检索所有项目。

```
elements = redis.lrange( "supplier_id", 0, -1 ) 
```

将返回列表中的所有项目而不更改列表本身。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T15:39:50.140

我对你的问题有点不清楚，但如果供应商 ID 是数字，为什么不使用 a `ZSET`？

像这样添加您的值：

```
ZADD suppliers 1 "data for supplier 1"  
ZADD suppliers 2 "data for supplier 2"  
ZADD suppliers 3 "data for supplier 3" 
```

然后，您可以像这样删除所有内容（但不包括供应商三）：

```
ZREMRANGEBYSCORE suppliers -inf 2 
```

或者

```
ZREMRANGEBYSCORE suppliers -inf (3 
```

如果您只想从中读取，这也使您可以非常快速地访问（通过供应商 ID）。

希望有帮助！

# orm - 学说生成实体在类名中包含模式名称

> ID：10703029
> 
> 赞同：0
> 
> 时间：2012-05-22T13:27:34.413
> 
> 标签：orm, symfony, doctrine-orm

当我从现有的 Postgres 数据库中使用 Doctrine 生成实体时，创建的文件具有以下形式：

*   类 Public.blog
*   类 Public.post
*   ETC

即我的数据库“模式”名称被包含在类名和文件名中。然后，由于“。”，这使得类名非法。

## 如何指定我不希望数据库模式名称包含在我的类名中？

还是我以错误的方式处理这个问题？

**额外信息** - 该命令很好。我的文件创建正确，但是类名仍然是“Public.blog”——Symfony2 设法在没有公共模式/命名空间的情况下生成相同的文件。所以这是可能的！然而，事实证明，要找到导致这种情况发生的代码部分是很困难的！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T22:29:52.980

What I did was to temporarily move all my tables into the public schema and generate the entities and crud pages. Then I moved the tables back into place and modified the files in /src/Etc/MyBundle/Resources/config/doctrine so that their table: myTable entries were now table: MySchema.myTable.

Then everything worked.

# jquery - jquery td content by attribute - 不能使用子级或查找方法？

> ID：10703035
> 
> 赞同：0
> 
> 时间：2012-05-22T13:27:58.397
> 
> 标签：jquery, find, children

我不知道什么应该是一个简单的任务：

[http://jsfiddle.net/elen/7agUc/3/](http://jsfiddle.net/elen/7agUc/3/)

```
$(document).on("change",'td[col=cat_id] select',function() {
    var v = $(this).val();
    var tr = $(this).parent().parent(); // getting parent row

    var tr_id = tr.attr('primary_key');
    var d = tr.childern('td[col=Artist').html(); // getting text in the specific cell of the same row

    alert(d);

});​ 
```

上面的代码抛出一个错误——“不支持子方法”

以下作品：

```
var d = $("tr[primary_key="+tr_id +"] td[col=Artist]").text(); 
```

但为什么我不能只使用`children()`or `find()`：

```
var d = tr.find('td[col=Artist').text(); 
```

还是我在这里遗漏了什么？...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T13:30:33.287

你有一个错字：替换`childern`为`children`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-22T13:32:46.663

修复以下行：

```
var d = tr.childern('td[col=Artist').html(); 
```

到：

```
var d = tr.children('td[col=Artist]').html(); 
```

[在职的](http://jsfiddle.net/7agUc/6/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T13:33:11.650

您在选择器中缺少 ] ，而且您拼写错误的 children。尝试使用：

```
 tr.children('td[col=Artist]').html() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-22T13:35:17.460

试试这个-->

```
$(document).on("change",'td[col=cat_id] select',function() {
    var v = $(this).find('option:selected').val();
    var tr = $(this).parent().parent();

    var tr_id = tr.attr('primary_key');
    var d = tr.find('td[col=Artist]').html();

    alert(d);

});​ 
```

# c# - SQL SP 返回产品图片列表

> ID：10703041
> 
> 赞同：0
> 
> 时间：2012-05-22T13:28:23.690
> 
> 标签：c#, asp.net, sql, image

我想从 SQL 获取产品图像列表以显示在图像幻灯片中。

但是，我不确定从 MS SQL 存储过程返回数据的最佳方式。

问题是，使用下面的 SP，我得到了每个图像的重复记录。理想情况下，我想获得一个数组或字符串列表或某种方式来从单个记录中拆分数据。但是，我对其他解决方案持开放态度。我的目标是以直观的方式获取页面上的图像。这是针对 ASP.Net C# 应用程序的。

这是我的存储过程中的简化选择语句：

```
 SELECT 

  P.[ProductId]
  ,P.[ProductName]
  ,I.[FileName] as ProductImage

  FROM [Product] P
  LEFT JOIN [ProductImages] I
  on P.ProductId = I.ProductId

  Where P.ProductId = @ProductId 
```

这将返回如下所示的数据：

```
ProductId         ProductName       ProductImage
1                 Coffee Mug        Mug_Image1.jpg
1                 Coffee Mug        Mug_2.jpg
1                 Coffee Mug        Mug_Img3.jpg 
```

我希望它看起来像这样（但我也想听听其他想法）：

```
ProductId         ProductName       ProductImage
1                 Coffee Mug        Mug_Image1.jpg, Mug_2.jpg, Mug_Img3.jpg 
```

同样，我不确定这是否是最好的方法。

我有两张桌子。一个是 Product，另一个是 ProductImages，它具有 Product 表中 ProductId 的 FK。

最终，我需要构建 JSON 来提供客户端幻灯片脚本。像这样：

```
productimages = [
        { "image": "Mug_Image1.jpg", "caption": "", "link": "", "title": "" },
        { "image": "Mug_2.jpg", "caption": "", "link": "", "title": "" },
        { "image": "Mug_Img3.jpg", "caption": "", "link": "", "title": "" }
                                    ]; 
```

这里是 C#

```
//Create product object to display on page
ProductEntity product = new ProductEntity();
product.Id = idval;
//Load the product from SP based on ID
ProductWF.LoadProduct(product);

//Render product details on page
ProductNameLabel.Text = product.ProductName;

//Construct JSON image list
StringBuilder sb = new StringBuilder();
etc... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T13:41:18.260

你可以使用这样的东西：

```
SELECT
   P.[ProductId],
   P.[ProductName],
   FileNames = STUFF(
               (SELECT ', ' + FileName FROM ProductImages 
                WHERE ProductId = P.ProductId FOR XML PATH('')) , 1 , 1 , '')
      FROM 
        [Product] P 
```

获取每个产品的逗号分隔的文件名列表，如果有帮助的话。但是您想要生成的 JSON 字符串可能会从您已有的查询结果中构建得更简单。

如果您从上面获取查询，您可以将其映射到一个类：

```
public class Product
{
   public int ProductId {get; set;}
   public string ProductName {get; set;}
   public string FileNames {get; set;}
} 
```

在服务器端，您必须拆分 FileNames 字符串属性并构造一个 json 字符串。

# html - 重新调整不同图像的大小而不失真

> ID：10703045
> 
> 赞同：3
> 
> 时间：2012-05-22T13:28:31.100
> 
> 标签：html, css, image, aspect-ratio

所有图像都有一个共同点；它们都是 300 或 600 像素宽。但高度在 300-900 像素左右不等。现在我需要一小组图像，用于为用户推荐其他图像。这些将只有大约 100x200 像素（可能会改变）。我之前的尝试使图像缩小到 100x200 的纵横比。我需要它重叠，但多余的部分是隐藏的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-22T13:38:01.783

试试这样的[http://dabblet.com/gist/2769112](http://dabblet.com/gist/2769112)

你需要的 CSS 很简单

```
.img-container {
    width: 200px; /* whatever set width */
    height: 100px;
    display: inline-block; /* or you could float them */
    overflow: hidden;
}
.img-container img {
    width: 100%;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T13:31:14.380

将图像放在具有定义的高度和宽度的包装元素中，例如 DIV，并使用`overflow:hidden`.

# r - 相关热图

> ID：10703052
> 
> 赞同：2
> 
> 时间：2012-05-22T13:29:06.470
> 
> 标签：r, heatmap

我想制作相关数据的热图，而不是从 0.85 获得相关尺度，我想要从 0.90 开始。我需要知道如何调整这个比例。

![在此处输入图像描述](../Images/427c46b01894eb1ecfb6e69899b9689a.png)

我正在使用的命令是：

```
data<-read.table("data_corr", header=T) 
tiff('corrheatmap.tiff')
library(gplots)
z<-cor(data)
lowColor = "purple" #change this if you want
highColor = "blue" #change this if you want
colorMin = 0 # I have made this 0.9 and also 90 in any case I don't see the difference
heatmap.2(z, Rowv=FALSE, Colv=FALSE, dendrogram="none", key=TRUE, density.info="none", trace="none", col=colorpanel(100, lowColor, highColor), scale="none", cexRow=0.15, cexCol=0.15) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T14:10:57.177

也许我误解了你的问题，但我认为你可以使用休息参数。对我来说，它就像

```
heatmap.2(z, breaks = seq(0.9, 1, 0.001), Rowv=FALSE, Colv=FALSE, dendrogram="none", key=TRUE, density.info="none", cexRow = 0.15, cexCol = 0.15, col=colorpanel(100, lowColor, highColor), trace="none") 
```

# php - 在 PHP 中使用 DOMDocument 将 h3 标签集之间的所有 HTML 标签包装起来

> ID：10703057
> 
> 赞同：2
> 
> 时间：2012-05-22T13:29:12.740
> 
> 标签：php, html, domdocument

我有一个后续问题，Jack 已经回答了我的问题： [Wrap segments of HTML with divs (and generate table of contents from HTML-tags) with PHP](https://stackoverflow.com/q/10683421)

我一直在尝试为上面的答案添加一些功能，以获得以下结果。

这是我现在的 HTML：

```
<h3>Subtitle</h3>
<p>This is a paragraph</p>
<p>This is another paragraph</p>
<h3>Another subtile
  <h3>
    <p>Yet another paragraph</p> 
```

这就是我想要实现的目标：

```
<h3 class="current">Subtitle</h3>
<div class="ac_pane" style="display:block;">
  <p>This is a paragraph</p>
  <p>This is another paragraph</p>
</div>
<h3>Another subtitle</h3>
<div class="ac_pane">
  <p>Yet another paragraph</p>
</div> 
```

我一直在尝试修改上面示例中的代码，但无法弄清楚：

```
foreach ($d->getElementsByTagName('h3') as $h3) {
    $ac_pane_nodes = array($h3);
    for ($next = $h3->nextSibling; $next && $next->nodeName != 'h3'; $next = $next->nextSibling) {
        $ac_pane_nodes[] = $next;
    }
    $ac_pane = $d->createElement('div');
    $ac_pane->setAttribute('class', 'ac_pane');
    // Here I'm trying to wrap all tags between h3-sets, but am failing!
            $h3->parentNode->appendChild($ac_pane, $h3);
    foreach ($ac_pane_nodes as $node) {
        $ac_pane->appendChild($node);
    }
} 
```

请注意，添加`class="current"`到第一个 h3 集和添加`style="display:block;"`到第一个集`div.ac_pane`是可选的，但非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T14:37:31.480

根据要求，这是一个工作版本。IMO XSLT 仍然是最适合此类问题的解决方案（将一些 XML 转换为其他 XML，真的），但我不得不承认使用常规代码进行分组要容易得多！

我最终稍微扩展了 DOM API，只是为了`insertAfter`在 DOMElement 上添加一个实用方法。没有它也可以完成，但它更整洁：

**根据评论中的要求，更新为围绕所有标签包装 DIV**

```
<?php

class DOMDocumentExtended extends DOMDocument {
    public function __construct($version = "1.0", $encoding = "UTF-8") {
        parent::__construct($version, $encoding);
        $this->registerNodeClass("DOMElement", "DOMElementExtended");
    }
}

class DOMElementExtended extends DOMElement {
    public function insertAfter($targetNode) {
        if ($targetNode->nextSibling) {
            $targetNode->parentNode->insertBefore($this, $targetNode->nextSibling);
        } else {
            $targetNode->parentNode->appendChild($this);
        }
    }

    public function wrapAround(DOMNodeList $nodeList) {
        while (($node = $nodeList->item(0)) !== NULL) {
            $this->appendChild($node);
        }
    }
}

$doc = new DOMDocumentExtended();
$doc->loadHTML(
    "<h3>Subtitle</h3>
    <p>This is a paragraph</p>
    <p>This is another paragraph</p>
    <h3>Another subtile</h3>
    <p>Yet another paragraph</p>"
);

// Grab a nodelist of all h3 tags
$nodeList = $doc->getElementsByTagName("h3");

// Iterate over each of these h3 nodes
foreach ($nodeList as $index => $h3) {

    // Special handling for first h3
    if ($index === 0) {
        $h3->setAttribute("class", "current");
    }

    // Create a div node that we'll use as our wrapper
    $div = $doc->createElement("div");
    $div->setAttribute("class", "ac_pane");

    // Special handling for first div wrapper
    if ($index === 0) {
        $div->setAttribute("style", "display:block;");
    }

    // Move next siblings of h3 until we hit another h3
    while ($h3->nextSibling && $h3->nextSibling->localName !== "h3") {
        $div->appendChild($h3->nextSibling);
    }

    // Add the div node right after the h3
    $div->insertAfter($h3);
}

// UPDATE: wrap all child nodes of body in a div
$div = $doc->createElement("div");
$body = $doc->getElementsByTagName("body")->item(0);
$div->wrapAround($body->childNodes);
$body->appendChild($div);

echo $doc->saveHTML(); 
```

*请注意，loadHTML 将添加 doctype、html 和 body 节点。[如果需要，可以将它们剥离](https://stackoverflow.com/questions/10416704/remove-parent-element-keep-all-inner-children-in-domdocument-with-savehtml/10657666#10657666)。*

# c# - 按预期发出打印图像

> ID：10703058
> 
> 赞同：1
> 
> 时间：2012-05-22T13:29:14.840
> 
> 标签：c#, .net, winforms, image, printing

我有一张图片，我正在尝试打印到合法尺寸。然而，这有一些挑战。

1.  图像的大小会有所不同。这是因为我使用的控件具有有限的打印选项，但可以导出到图像。
2.  我想最大化页面上的打印区域。可能的最小保证金
3.  用户需要能够选择打印机并设置选项

这是我正在使用的代码：

```
 PrintDocument pd = new PrintDocument();
            pd.PrintPage += (sender, args) =>
            {
                Image i = Image.FromFile(Globals.TempDirectory + @"\temp.jpg");
                Point p = new Point(100, 100);
                Margins margins = new Margins(50, 50, 50, 50);
                pd.DefaultPageSettings.Margins = margins;
                args.Graphics.DrawImage(i, p);
            };
            pd.Print(); 
```

我一直遇到这个问题，因为我无法设置边距并且似乎无法正确打印出来。我希望它以合法方式打印，但是当我打印图像时，它没有正确旋转，它只是打印到默认打印机。我愿意做任何事情来让它发挥作用。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-22T14:42:54.550

用 C# 打印很糟糕

试一试

```
printdialog() 
```

允许用户选择打印机和设置。一旦你得到它的工作，它的其余部分可能会为你点击。

编辑：向您展示在哪里以及如何使用它。

```
PrintDialog pDialog = new PrintDialog();
if (pDialog.ShowDialog() == DialogResult.OK)
{
   pd.PrinterSettings = pDialog.PrinterSettings;
   pd.Print();
} 
```

# php - 如何从 PHP 调用 RESTful WCF-Service

> ID：10703060
> 
> 赞同：2
> 
> 时间：2012-05-22T13:29:19.087
> 
> 标签：php, json, wcf, rest

我正在尝试使用 PHP 中的 REST 向自托管 WCF 服务发送请求。我想将对象作为 JSON 对象发送到 WCF 服务。我还没有让它运行。有没有人举例说明如何从 PHP 中调用服务？

这是 Operation 合约（该方法是 POST 方法）：

```
[OperationContract]
    [WebInvoke(Method = "POST", BodyStyle = WebMessageBodyStyle.Wrapped, RequestFormat = WebMessageFormat.Json, ResponseFormat = WebMessageFormat.Json)]
    void Method1(AnObject object); 
```

PHP中最好的工作代码如下：

```
$url = "http://localhost:8000/webservice/Method1?object=$object"; 
    $url1 = parse_url($url);

// extract host and path:
$host = $url1['host'];
$path = $url1['path'];
$port = $url1['port'];

// open a socket connection on port 80 - timeout: 30 sec
$fp = fsockopen($host, $port, $errno, $errstr, 30);

if($fp)
{
    // send the request headers:
    fputs($fp, "POST $path HTTP/1.1\r\n");
    fputs($fp, "Host: $host\r\n");

    fputs($fp, "Content-type: application/json \r\n");
    fputs($fp, "Content-length: ". strlen($object) ."\r\n");
    fputs($fp, "Connection: close\r\n\r\n");
    fputs($fp, $object);
//
//  $result = ''; 
//  while(!feof($fp)) {
//          // receive the results of the request
//          $result .= fgets($fp, 128);
//  }
}
else { 
    return array(
        'status' => 'err', 
        'error' => "$errstr ($errno)"
    );
}

// close the socket connection:
    fclose($fp); 
```

但是此代码不发送对象。在调试模式下，对象为“null”。我只是看到，它进入了方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T12:17:12.147

我找到了解决我自己问题的方法：

```
$url = "http://localhost:1234/service/PostMethod"; 
$jsonObject = json_encode($transmitObject);

    $options = array(
    CURLOPT_HTTPHEADER => array(
        "Content-Type:application/json; charset=utf-8",
        "Content-Length:".strlen($jsonObject)));

    $defaults = array( 
        CURLOPT_POST => 1, 
        CURLOPT_HEADER => 0, 
        CURLOPT_URL => $url, 
        CURLOPT_FRESH_CONNECT => 1, 
        CURLOPT_RETURNTRANSFER => 1, 
        CURLOPT_FORBID_REUSE => 1, 
        CURLOPT_TIMEOUT => 4, 
        CURLOPT_POSTFIELDS => $jsonObject
    ); 

    $ch = curl_init(); 
    curl_setopt_array($ch, ($options + $defaults)); 
    curl_exec($ch);
    curl_close($ch); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T15:20:37.573

当您在 WCF Rest 服务上执行 POST 时，原始请求应如下所示：

```
POST http://localhost:8000/webservice/Method1 HTTP 1.1
Content-Type: application/json
Host: localhost

{"object":{"ObjectId":1,"ObjectValue":60} 
```

假设您的`AnObject`外观如下：

```
[DataContract]
public class AnObject 
{
    [DataMember]
    public int ObjectId {get;set;}
    [DataMember]
    public int ObjectValue {get;set;}
} 
```

从您的 php 代码中，您尝试将对象作为查询字符串发送，但这是行不通的。而是构建您的代码以将 json 字符串添加到 http 正文。

使用一些工具，如[Fiddler](http://www.fiddler2.com)或[WireShark](http://www.wireshark.org)，您可以在其中拦截请求/响应并检查它们。您甚至可以通过构建原始请求来使用它们来测试 WCF Rest 服务。

查找一些可能有用的链接：

1.  [创建一个 php 客户端以调用 REST 服务](http://www.sematopia.com/2006/10/how-to-making-a-php-rest-client-to-call-rest-resources/)

2.  [php rest api 调用](https://stackoverflow.com/questions/3712183/php-rest-api-call)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T18:00:50.667

通过在 $path 旁边添加参数，我得到了工作“der_chirurg”解决方案，如下所示

原来的：

```
$url = "http://localhost:8000/webservice/Method1?object=$object"; 
fputs($fp, "POST $path HTTP/1.1\r\n"); 
```

变成：

```
fputs($fp, "POST $path**?object=$object** HTTP/1.1\r\n"); 
```

而不是在 $url

```
$url = "http://localhost:8000/webservice/Method1 
```

最后：

```
 url = "http://localhost:8000/webservice/Method1";
        $url1 = parse_url($url);
    // extract host and path:
    $host = $url1['host'];
    $path = $url1['path'];
    $port = $url1['port'];

    // open a socket connection on port 80 - timeout: 30 sec
    $fp = fsockopen($host, $port, $errno, $errstr, 30);

    if($fp)
    {
    // send the request headers:
    fputs($fp, "POST $path?value=test HTTP/1.1\r\n");
    fputs($fp, "Host: $host\r\n");

    fputs($fp, "Content-type: application/json \r\n");
    fputs($fp, "Content-length: ". strlen($param) ."\r\n");
    fputs($fp, "Connection: close\r\n\r\n"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-11T09:18:52.847

```
 $jsonData = json_encode($object, JSON_PRETTY_PRINT);
 $options = array(
     'http'=>array(
            'method'        =>  "POST",
            'ignore_errors' =>  true,
            'content'       =>  $jsonData,
            'header'        =>  "Content-Type: application/json\r\n" .
                                "Content-length: ".strlen($jsonData)."\r\n".
                                "Expect: 100-continue\r\n" .
                                "Connection: close"
            )
        );

        $context = stream_context_create($options);
        $result = @file_get_contents($requestUrl, false, $context); 
```

JSON格式非常重要。

# sql - 创建一个完整的多对多矩阵

> ID：10703061
> 
> 赞同：1
> 
> 时间：2012-05-22T13:29:19.443
> 
> 标签：sql, oracle, oracle11g

我有 2 个具有多对多关系的表：
tableA (ida, valA)
tableB (idb, valB)
tableAB (ida, idb)

我需要一个应该在每个元组中返回的查询：
（ida，idb，0/1，如果相关或不相关）

这是一些输入/输出示例： **tableA**

```
ida   valA
1     b
2     s
3     l 
```

**表B**

```
idb   valB
11    aaa
22    bbb
33    ccc 
```

**表AB**

```
ida   idb
1     11
2     33 
```

预期成绩：

```
ida      idb      is_exists
1        11       1
2        11       0
1        33       0
2        33       1 
```

请注意，我不需要总是为 0 的排列，例如 ida=3 或 idb=22
这是因为这意味着在矩阵中，整行或整列都是 0（这表明该行与其他表）

```
 \ ida |     |     |  
idb \    |  1  |  2  |  3
---------------------------
11       |  1  |  0  |  0
---------------------------
22       |  0  |  0  |  0
---------------------------
33       |  0  |  1  |  0 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T13:36:00.453

您需要的是一张包含所有可能配对的驾驶台。一种方法是从 TableA 和 TableB 中使用交叉连接：

```
select allAB.aid, allAB.bid, max(case when ab.aid is not null then 1 else 0 end) as HasPair
from (select distinct a.id as aid, b.id as bid
      from TableA a cross join
           TableB b
     ) as allAB left outer join
     TableAB ab
     on allAB.aid = ab.aid and
        allAB.bid = ab.bid
group by allAB.aid, allAB.bid 
```

之后，查询只是汇总并判断TableAB中是否有匹配的记录。

# php - TinyMVC 模型/插件如何实现？

> ID：10703064
> 
> 赞同：0
> 
> 时间：2012-05-22T13:29:38.973
> 
> 标签：php, mysql

最近我开始使用[TinyMVC](http://www.tinymvc.com)编写了一个简单的菜单模型，我对那些正在使用它或以前使用过的人有几个问题。1\. 对于以下代码，我应该将其保留为模型还是插件？2.我应该如何在视图中实现它并在每个需要的页面上使用它而不破坏mvc的想法并且不为每个控制器一次又一次地重写？3\. 代码有什么改进吗？4.需要mysql表吗？

[代码在这里](http://notey.it/n/bGs)：

```
<?php
class Menu_Model extends TinyMVC_Model
{
    public function __construct()
    {
        parent::__construct();
    }
    public function listMenu()
    {
        return $this->db->query_all("SELECT * FROM menu_links WHERE is_deleted = 0 ORDER BY position");
    }

    public function listCategorys($menuLinkId)
    {
        return $this->db->query_all("SELECT * FROM menu_subcategorys WHERE menuLinkId = ? AND is_deleted = 0 ORDER BY position", array($menuLinkId));
    }

    public function buildMenu()
    {
        $this->listMenu = $this->listMenu();
        foreach($this->listMenu as $this->listMenuKey => $this->listMenuValue)
        {
            $this->listCategorys = $this->listCategorys($this->listMenuValue['menuLinkId']);
            if(!empty($this->listCategorys))
                $this->listMenu[$this->listMenuKey]['child'] = $this->listCategorys;
        }

        return $this->listMenu;
    }
} 
```

# iphone - 分配财产

> ID：10703068
> 
> 赞同：1
> 
> 时间：2012-05-22T13:29:57.383
> 
> 标签：iphone, ios, memory-management, memory-leaks

处理别人的代码。在分析项目的时候遇到了一段代码

```
self.groupPicker = [[UIPickerView alloc] initWithFrame:CGRectMake(0,260,320,216)];
self.groupPicker.delegate = self;
self.groupPicker.showsSelectionIndicator = YES;
[self.view addSubview:self.groupPicker]; 
```

其中 groupPicker 是一个`UIPicker`属性。在分析项目时，我在这种情况下遇到了潜在的泄漏警告。我还注意到该`dealloc`方法中没有释放 groupPicker 属性。也没有`_groupPicker`在项目的任何地方发布。在这种情况下应该怎么做？

1.  我是否应该删除该`UIPicker`属性并只声明一个`UIPicker`变量。

2.  我应该像这样发布 groupPicker`[_groupPicker release];`

groupPicker 的保留计数是多少，因为它在 .h 文件中保留一次并再次分配，如上面的代码所示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T13:44:37.823

1) 不，拥有财产完全没问题，问题是它被过度保留了。当您分配/初始化时，保留计数为 1，然后您使用保留属性再次增加保留计数。保留计数现在为 2，假设您在 dealloc 中释放对象，最终保留计数为 1，即泄漏的对象。

有很多方法可以处理这个问题。我认为最好的方法是在初始化时自动释放对象。像这样

```
self.groupPicker = [[[UIPickerView alloc] initWithFrame:CGRectMake(0,260,320,216)] autorelease]; 
```

2）你保留的任何东西都应该在dealloc中释放，所以在dealloc中你应该

```
- (void)dealloc {
    [_groupPicker release];
    [super dealloc];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T13:33:14.950

您应该使用 ARC（自动引用计数）

这样做必须编辑>重构>转换为目标 c ARC

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T13:36:28.493

小心！当你设置一个属性时

```
self.property1 = x; 
```

并且property1被声明为retain，property1中的前一个对象被释放，新的对象（x）被保留。这就是为什么这样做：

```
self.property1 = [[x alloc] init]; 
```

当 property1 被声明为保留时，将保留 x 两次。（一个用于初始化，一个用于设置属性）正确的方法是声明对象，设置到属性然后释放

```
object x = [[class alloc] init];
self.property1 = x;
[x release]; 
```

这样，您将释放对象 x 的“责任”交给财产持有者。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T13:40:26.997

虽然应该首选将**ARC**用于 iOS5+ 应用程序，但如果您不想这样做，请使用`autorelease`after`init`方法。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-05-22T13:33:24.110

将 UIPickerView 分配给`_groupPicker`（或任何实例变量的名称），或者`autorelease`在分配时使用值。

（问题是分配给保留属性会导致保留，并且对象上已经存在保留`alloc`。）

# iphone - 使用搜索栏

> ID：10703069
> 
> 赞同：0
> 
> 时间：2012-05-22T13:30:07.983
> 
> 标签：iphone, objective-c, ios, xcode

我需要在我的项目中添加一个搜索栏，我将其称为服务器作为参数传递给搜索栏中的单词。

我发现的所有示例都在 TableView 上查找，其中包含进行搜索的数据，但这不是我想要的。

我曾想过使用 TextField，但想先知道是否可以使用 SearchBar。

ps：对不起我的英语；）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T13:33:21.130

这里如果你使用 Web 服务从服务器获取所有数据，那么这里没有使用搜索栏的意义。你也可以对 textField 做同样的事情。

但如果你想让它看起来像搜索栏，那么你可以使用 Photoshop 设计的 UI。并验证作为搜索栏提交的文本。

# javascript - 带有布尔返回的 jQuery UI 对话框 - true 或 false

> ID：10703071
> 
> 赞同：9
> 
> 时间：2012-05-22T13:30:09.463
> 
> 标签：javascript, jquery, user-interface, dialog

我正在尝试替换**javascript** confirm()。我找到了可以完全自定义的 jquery dialog() 函数。问题是我不能让它返回*true*或*false*。

这是我的代码：

```
$('#delBox').dialog(
        { autoOpen: false, resizable: false, modal: true, closeOnEscape: true, width: 300, height: 'auto', title: 'Deletar registro',
            buttons: {
                "Ok": function () {
                    return true;
                }, "Cancelar": function () {
                    $(this).dialog("close");
                    return false;
                }
            },
            open: function () {
                var buttonsSet = $('.ui-dialog-buttonset').find("button:contains('Ok')");
                buttonsSet.attr("class", "ui-button ui-state-default");
                $('.ui-dialog-titlebar-close span').empty();
                $('.ui-dialog-buttonset').find("button:contains('Ok')").button({
                    text: false,
                    icons: {
                        primary: 'ui-icon-ok'
                    }
                });

                $('.ui-dialog-buttonset').find("button:contains('Cancelar')").button({
                    text: false, 
                    icons: {
                        primary: 'ui-icon-cancel'
                    }
                });
            }
        }); 
```

这仅在选择任何选项之前返回一个对象：

```
function deletar() {
     alert($('#delBox').dialog('open'));
} 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-05-22T13:31:56.653

jQueryUI 对话框不能返回`true`或`false`，因为它们显示在其他内容之上，但*不会*阻止执行。

你能做的最好的事情是：

1.  制作盒子`modal`，使其隐藏其他内容

2.  根据选择的选项提供要使用的回调。

对于额外的奖励积分，您可以创建一个`$.Deferred()`承诺对象并在显示对话框时返回它。`resolve`然后，您可以`reject`在按钮事件处理程序中做出承诺。

这将使您在显示对话框和执行随后由它触发的操作之间清晰分离：

```
function showDialog() {
   var def = $.Deferred();

   // create and/or show the dialog box here
   // but in "OK" do 'def.resolve()'
   // and in "cancel" do 'def.reject()'

   return def.promise();
}

showDialog().done(function() {
    // they pressed OK
}).fail(function() {
    // the pressed Cancel
});

// NB: execution will continue here immediately - you shouldn't do
//     anything else now - any subsequent operations need to be
//     started in the above callbacks. 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-03-10T20:15:17.490

第一个答案很好 - 我想我只是添加一些代码来展示如何返回被点击的按钮：

```
function ShowYesNoMessage(title, message) {
var def = $.Deferred();
$("#infoMessage").html(message);

$("#dialog_infoMessage").dialog({
    modal: true,
    title: title,
    buttons: {
        Yes: function () {
            $("#infoMessage").html("");
            $(this).dialog("close");
            def.resolve("Yes");
        },
        No: function () {
            $("#infoMessage").html("");
            $(this).dialog("close");
            def.resolve("No");
        }
    }
});
return def.promise();
}

$.when(ShowYesNoMessage("Are you sure", message)).then(
            function(status) {
                if (status == "Yes") {
                    //do the next step
                }
            }
        ); 
```

# c# - 将操作数作为 sql 参数传递

> ID：10703072
> 
> 赞同：2
> 
> 时间：2012-05-22T13:30:13.477
> 
> 标签：c#, asp.net, sql-server-2008

我目前正在开发一个以 sql server 2008 作为后端的 asp.net 应用程序。我想让用户能够在 SQL 语句上指定他们想要过滤的内容。在界面上，我让他们选择以下选项作为下拉列表：等于大于小于等

我想将此作为参数传递给要执行的 sql 查询。我怎样才能最好地做到这一点？

例如；

```
Select amount, deduction, month from loan where amount @operant 10000; 
```

这`@operand`是上述下拉列表的返回值，即`= < > <= >=`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-22T14:08:45.430

假设所有正整数 < 20 亿，此解决方案避免了多次查询和动态 SQL。`OPTION (RECOMPILE)`有助于阻止参数嗅探，但这可能不是必需的，具体取决于表的大小、参数化设置和“针对临时工作负载进行优化”设置。

```
WHERE [Amount] BETWEEN 
CASE WHEN @operand LIKE '<%' THEN 0
     WHEN @operand = '>' THEN @operant + 1
     ELSE @operant END
AND
CASE WHEN @operand LIKE '>%' THEN 2147483647
     WHEN @operand = '<' THEN @operant - 1
     ELSE @operant END
OPTION (RECOMPILE); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T13:41:25.837

我会写一些“IF”语句。代码不是很短，但应该很快。

```
IF(@operand = '=')
Select..
ELSE IF(@operand = '>=')
Select..
... 
```

另外，我想说的是，Top (@someRowCount) 可能是个好主意。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-22T13:32:59.300

对于这种情况，您需要动态 sql

对于您的示例，这可以是

```
DECLARE @sql AS nvarchar(max) -- Use max if you can, if you set 
  -- this to a specific size then your assignment later can be 
  -- truncated when maintained and still be valid.

SET @sql = 'Select amount, deduction, month from dbo.loan where amount ' 
  + @operand + ' 10000'

EXEC sp_executesql @sql 
```

**更新 1**

执行动态 sql 有 2 种方法： Exec() 和 sp_executesql

阅读为什么首选 sp_executesql 的评论（不过，请注意 sql 注入！）

我还在表前加上了 dbo，以便执行计划可以在不同用户之间缓存

更多信息请参阅[http://www.sommarskog.se/dynamic_sql.html#queryplans上的精彩论文](http://www.sommarskog.se/dynamic_sql.html#queryplans)

# c# - EF 从父对象中删除子对象

> ID：10703073
> 
> 赞同：1
> 
> 时间：2012-05-22T13:30:21.940
> 
> 标签：c#, entity-framework

我使用 EF 为我的数据库表生成类：

```
public partial class Course
{
    public Course()
    {
        this.People = new HashSet<People>();
    }

    public int ID { get; set; }
    public string Name { get; set; }       

    public virtual ICollection<Person> People { get; private set; }     
}

public partial class Person
{
    public int ID { get; set; }
    public string Name { get; set; }

    public virtual Course Course { get; set; }
} 
```

如您所见，每门课程都有一群人。我创建了第二个部分类，因此当我刷新 EF 图时我的代码不会被清除。我的问题是如何从课程对象中清除人员列表？

我试过了：

```
public partial class Course
{    
      public void ResetCourse()
      {
          this.People.Clear();
      }
} 
```

但我得到这个错误：

操作失败：无法更改关系，因为一个或多个外键属性不可为空。当对关系进行更改时，相关的外键属性将设置为空值。如果外键不支持空值，则必须定义新关系，必须为外键属性分配另一个非空值，或者必须删除不相关的对象。

这显然是因为 EF 实际上并没有删除 person 对象，只是删除了 SQL 抛出的两者之间的关系，因为它不能有空键。

显然我应该使用类似 context.DeleteObject(person)

然而，在课程对象内部，它没有对上下文的引用，我想将代码保留在对象内部以保持 ui 代码的简单性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T13:45:06.390

而不是使用 Course 类来管理数据库操作；在使用实体框架时最好使用存储库和工作单元模式。否则，您的实体总是带有上下文；这会导致一些问题。

只需创建一个以上下文为参数的课程存储库，并在存储库中使用数据库操作而不是实体本身。请参阅： [工作单元和存储库模式](http://blogs.microsoft.co.il/blogs/gilf/archive/2010/02/05/using-unit-of-work-pattern-with-entity-framework.aspx)

# java - 在java中按其索引对arraylist的arraylist进行排序

> ID：10703074
> 
> 赞同：0
> 
> 时间：2012-05-22T13:30:22.733
> 
> 标签：java, android, arraylist

我有一个arraylist的arraylist，每个内部arraylist包含2个值，第一个是整数，第二个是字符串，所以基本上它看起来像：{5，一些文本}，{12，更多文本}，{3，甚至更多文本}等，我想做的是接受它并对其进行排序，使其按从最大整数到最小整数的降序排列，所以前面的例子看起来像：{12，更多文本}，{5，一些text}, {3, even more text}，任何帮助都会有很大帮助，在此先感谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-22T13:37:16.013

您的数据结构实际上听起来像是一个“地图”。也许你应该研究一下数据结构，特别是集合接口和类......

如果您仍然认为您拥有的是“列表”，那么您应该使用正确的 Comparator 或 Comparable 进行 Collections.sort 操作

如果 List 是正确的，这是您的数据结构的解决方案；

```
import java.util.ArrayList;
import java.util.Collections;

public class InnerObject implements Comparable<InnerObject> {
    Integer index;
    String  name;

    public InnerObject(Integer index, String name) {
        this.index = index;
        this.name = name;
    }

    @Override
    public int compareTo(InnerObject other) {
        return index.compareTo(other.index);
    }

    @Override
    public String toString() {
        return "{" + index + "," + name + "}";
    }

    public static void main(String[] args) {
        ArrayList<InnerObject> list = new ArrayList<InnerObject>();
        list.add(new InnerObject(666, "devil"));
        list.add(new InnerObject(1, "one"));
        list.add(new InnerObject(10, "ten"));

        System.out.println("list before order: " + list);

        Collections.sort(list);

        System.out.println("list after order: " + list);

    }   
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T13:35:43.590

如果您的内部列表可以包含一个具有 2 个属性的对象会更好。该对象可用于排序。

# c# - WebException 未被 catch 语句捕获

> ID：10703082
> 
> 赞同：1
> 
> 时间：2012-05-22T13:30:41.247
> 
> 标签：c#, exception-handling, invoke, begininvoke

```
try
{
    this.Invoke((MethodInvoker)delegate
    {
        Uri uri = new Uri("mywebpage.com");
        NetworkCredential credentials = new NetworkCredential("username", "password");
        byte[] lnBuffer;
        byte[] lnFile;
        HttpWebRequest lxRequest = (HttpWebRequest)WebRequest.Create(uri);
        lxRequest.Credentials = credentials;
        // the line below throws a webexception that for some reason is not being caught by my webexception catch statement.
        using (HttpWebResponse lxResponse = (HttpWebResponse)lxRequest.GetResponse())
        {
            using (BinaryReader lxBR = new BinaryReader(lxResponse.GetResponseStream()))
            {
                using (MemoryStream lxMS = new MemoryStream())
                {
                    lnBuffer = lxBR.ReadBytes(1024);
                    while (lnBuffer.Length > 0)
                    {
                        lxMS.Write(lnBuffer, 0, lnBuffer.Length);
                        lnBuffer = lxBR.ReadBytes(1024);
                    }
                    lnFile = new byte[(int)lxMS.Length];
                    lxMS.Position = 0;
                    lxMS.Read(lnFile, 0, lnFile.Length);
                    lxMS.Close();
                    lxBR.Close();
                }
            }
            lxResponse.Close();
        }

        using (MemoryStream lxFS = new MemoryStream(lnFile))
        {
            lxFS.Write(lnFile, 0, lnFile.Length);
            lxFS.Position = 0;
            Image resizedimage = new Bitmap(Image.FromStream(lxFS), new Size(320, 240));
            pictureBox23.Image = resizedimage;

            //otherform.picboximage = Image.FromStream(lxFS);
            lxFS.Close();
        }
    });
}
catch (WebException e)
{
    this.Close();
}
catch (InvalidOperationException e)
{
    this.Close();
} 
```

上面带有注释的行引发了一个网络异常，但是我的网络异常捕获语句没有捕获它。有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T13:31:58.310

如果您使用的是 Visual Studio，请确保转到 Debug>Exceptions 并捕获一般异常并使其抛出它。

# android - android在视图寻呼机中异步加载数据

> ID：10703083
> 
> 赞同：9
> 
> 时间：2012-05-22T13:30:48.213
> 
> 标签：android, android-asynctask, android-viewpager

我需要一个视图寻呼机实现的解决方案。首先，我在单页中从数据库中加载大量数据，因此有时在滑动期间它会减慢滑动频率（您需要在页面上多次滑动），因为它在后台执行获取任务。我没有使用异步任务来返回视图。有什么方法可以延迟加载页面，只允许用户在滑动时进入其他页面，但数据是延迟加载的。

我的代码示例如下；

```
 public Object instantiateItem(View container, int position) {

View v;

v = View.inflate(context,R.layout.swipearea, null);

listView = (ListView)v.findViewById(R.id.MyListView);
largeDataCall();
((ViewPager)container).addView(v);
return v;
} 
```

我在创建方法中调用它。

```
pager=(ViewPager) findViewById(R.id.pagerAdapter);
pager.setAdapter(new SimplePager(MyPager.this));
pager.setCurrentItem(364); 
```

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-05-22T13:45:40.287

我建议使用片段（而不是直接使用视图）。

您需要片段上的接口来告诉它们何时显示：

```
public interface IShowedFragment {

    public void onShowedFragment();
} 
```

让你的所有片段都实现那个接口，并在那个方法中调用你的加载器/异步任务/后台任务。

然后在你的ViewPager上放一个onPageChangeListener，当你检测到用户改变了页面时，调用你的fragment上的接口方法。您可以使用此侦听器进行一些选择，其中一种方法可以等待 viewPager 停止滑动以触发您的界面调用。

为了能够获得正确的片段来进行此调用，请从 yourFragmentApadter.instantiateItem(ViewGroup, int) 中获取片段，如果片段已经加载，它将返回该位置的片段。

```
mPager.setOnPageChangeListener(new OnPageChangeListener() {

  @Override
  public void onPageSelected(int position) {

      Fragment fragment = (Fragment) mAdapter.instantiateItem(mPager, position);
      if(fragment instanceof IShowedFragment){
           ((IShowedFragment) fragment).onShowedFragment();
      }
  }
  (...) 
```

像这样，您可以使用空视图准备片段，当您在其中滑动时，您开始加载数据。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-22T14:29:01.910

我刚刚完成了一个非常相似的任务。为了让您开始寻找问题的解决方案，请按顺序考虑以下几点；

1.  看看您是否需要在第一个实例中获取*所有这些数据。*随时回帖详细说明您需要加载哪些信息以及您正在使用它做什么（将其显示为屏幕上的列表？）
2.  看看 using `CursorLoader`s 执行繁重的任务，例如异步获取数据库。[互联网上的本教程](http://mobile.tutsplus.com/tutorials/android/android-sdk_loading-data_cursorloader/)介绍了 ContentProvider Android 方法。如果这些术语意义不大，最好熟悉官方的 Android URI 和 ContentProvider 文档。
3.  如果您正在使用 Fragments - 看看使用`FragmentStatePagerAdapter`而不是传统的`FragmentPagerAdapter`. 我没有使用过这个适配器，但我读到它只实例化当前可见的片段，即不是当前选定选项卡右侧或左侧的那些片段。
4.  查看优化您对数据库运行的查询。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T13:47:54.233

`instantiateItem` is called when the `ViewPager` is about to swap and needs a view. It doesn't *have* to actually create everything. I think ultimately, lazy-loading is out. The way I see it, there's two things you'll need to do here.

1: Cache the data in the background when the user is about to reach your page. Your example claims that 364 pages (good Lord), so I'd say use a listener to handle page changes. When you're at page 363, start loading the data for 364\. When you're at 364, start loading the data at 365 and keep the data at 363 in case the user wants to swap back. If the data loads relatively quickly or the user takes a long time to swap, it should be seemless assuming you're using asyncTask or thread to load the data.

2: Have a backup default view that doesn't get populated until the data is retrieved. You'll need to do this with option 1 as well in case the user loads the page before you retrieve the data. Basically, just have a view that says "loading..." or something until you have the data. Either that, or populate the data at real time as you get it. In that case the user will see it build.

Either way, I think you'll need to cache something to make the app look good.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-30T16:18:13.653

我有一个类似的问题。正在加载大量数据的浏览器。如果您不打算经常更改各个页面的视图，那么我建议您将这些页面保留在内存中。使用以下代码执行此操作

```
mViewPager.setOffscreenPageLimit(#pages); to keep #pages in memory. I had 5 pages so my #pages was 4\. 
```

如果要刷新 viewpager 幻灯片上的数据，请使用

```
mViewPager.getAdapter().notifyDataSetChanged(); with getItemPosition() returning POSITION_NONE. 
```

并使用 FragmentStatePagerAdapter。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-22T13:56:20.183

你看过[android点火库](https://github.com/kaeppler/ignition)吗？根据[Sample-applications](https://github.com/kaeppler/ignition/wiki/Sample-applications)有一个组件“无尽列表”和一个 http-cache 组件。

我自己没有尝试过，不知道这是否适合你 - 只是看到了例子......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-22T13:36:35.737

我认为没有任何方法可以以您描述的同步方式延迟加载数据。AsyncTask 是要走的路，或者您可以直接使用线程。我相信 AsyncTask 是专门为这种功能设计的。它比直接使用线程更容易。如果您需要有关实施的想法，请查看： http: [//geekjamboree.wordpress.com/2011/11/22/asynctask-call-web-services-in-android/](http://geekjamboree.wordpress.com/2011/11/22/asynctask-call-web-services-in-android/)

# jquery - jquery 图像翻转行为

> ID：10703084
> 
> 赞同：0
> 
> 时间：2012-05-22T13:31:00.537
> 
> 标签：jquery, image, thumbnails, behavior

我有以下代码允许缩略图 src attr 替换主图像窗口中的图像。

```
 $(document).ready(function(){   
            var originalimg = $('#imageMain img').attr('src');
                $(".subImage").hover(function(){
                        var currentimg = $(this).attr('src');
                    $('.mainImage').fadeOut(function () {
                    $('.mainImage').attr('src', currentimg).fadeIn();
                        });
                    },function(){
                            $('.mainImage').fadeOut(function() {
                                $('.mainImage').attr('src', originalimg).fadeIn();
                            })
                            });
            }); 
```

目前的行为如下： 1\. 悬停在 - 主图像淡入白色，然后淡入子图像。2\. 鼠标移出 - 主图像淡化为白色，然后替换为原始图像。

我真正需要的不是两个图像状态之间的“白色”过渡，而是希望它们有点重叠（所以一个淡出而另一个淡入） -

这可能吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T13:52:14.443

您不能使用淡出/淡入顺序旋转图像。您必须以另一种方式进行转换。我已经为您编写了整个代码：

```
 <head>
    <title>jQuery Image Rotator</title>
   <script type="text/javascript" src="jquery-1.3.2.js"></script>
    <script type="text/javascript">
      $("#photoshow").hover(function() {
        setInterval("rotateImages()", 2000); // set the interval time as your wish
    });

    function rotateImages() {
        var oCurPhoto = $('#photoShow div.current');
        var oNxtPhoto = oCurPhoto.next();
        if (oNxtPhoto.length == 0)
            oNxtPhoto = $('#photoShow div:first');

        oCurPhoto.removeClass('current').addClass('previous');
        oNxtPhoto.css({ opacity: 0.0 }).addClass('current').animate({ opacity: 1.0 }, 1000,
            function() {
                oCurPhoto.removeClass('previous');
            });
    }
</script>
       <style type="text/css">
         #photoShow {
        height:400px;
         width:400px;
         }
      #photoShow div {
        position:absolute;
        z-index: 0;
         }
      #photoShow div.previous {
        z-index: 1;
         }
         #photoShow div.current {
          z-index: 2;
           }
</style>
    </head>
  <body>
    <div id="photoShow">
       <div class="current">
        <img src="images/Grass.jpg" alt="Photo Gallery" width="400" height="400" class="gallery" />
    </div>
    <div>
        <img src="images/Leaf.jpg" alt="Photo Gallery" width="400" height="400" class="gallery" />
    </div>
    <div>
        <img src="images/Spring.jpg" alt="Photo Gallery" width="400" height="400" class="gallery" />
    </div>
    <div>
        <img src="images/Water.jpg" alt="Photo Gallery" width="400" height="400" class="gallery" />
    </div>
     </div>
   </body>
    </html> 
```

它将一张一张地转换图像。替换为适当的类、id 名称和图像 url。希望它有所帮助！

# nginx - Amazon ec2 上的 django-nginx-gunicorn 不起作用？

> ID：10703088
> 
> 赞同：1
> 
> 时间：2012-05-22T13:31:16.857
> 
> 标签：nginx, amazon-ec2, django-nonrel, gunicorn

我已经尝试过这个教程[http://adrian.org.ar/python/django-nginx-green-unicorn-in-an-ubuntu-11-10-ec2-instance](http://adrian.org.ar/python/django-nginx-green-unicorn-in-an-ubuntu-11-10-ec2-instance)用 ngnix 和 gunicorn 设置 django。我已经安装了 django和 gunicorn 在 vi​​rtualenv 环境中。一切都已完美安装，甚至每个命令都有效。当我`gunicorn_django -b 0.0.0.0:8000`进入我的 django 应用程序文件夹后尝试此命令时，它会启动 gunicorn 并在 shell 上显示以下内容：

```
2012-05-22 13:22:38 [3146] [INFO] Starting gunicorn 0.14.3
2012-05-22 13:22:38 [3146] [INFO] Listening at: http://0.0.0.0:8000 (3146)
2012-05-22 13:22:38 [3146] [INFO] Using worker: sync
2012-05-22 13:22:38 [3149] [INFO] Booting worker with pid: 3149 
```

但是，如果我通过浏览器转到我的亚马逊 DNS `http://ec2-XX-XX-XXX-XXX.compute-1.amazonaws.com:8000/`，我什么也没有，并且浏览器只是显示“找不到/连接”消息。但是如果我`http://ec2-XX-XX-XXX-XXX.compute-1.amazonaws.com`通过浏览器转到它会显示 Ngnix 欢迎页面。我不知道为什么 gunicorn 没有返回我的 Django 欢迎页面我转到`http://ec2-XX-XX-XXX-XXX.compute-1.amazonaws.com:8000`。我什至看不到任何 GET 请求登录到 gunicorn worker 的 shell。我尝试使用 gunicorn_django 命令更改端口，但没有运气并且得到相同的结果 gunicorn 不提供任何页面。

请注意我正在使用 django-nonrel。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-25T07:44:20.450

看起来您需要配置控制对 EC2 实例的访问的安全组。

你应该以这样的方式结束：

[https://skitch.com/ikis/8h1tc/aws-management-console](https://skitch.com/ikis/8h1tc/aws-management-console)

在我的示例中，22、80 和*8000*向世界开放。

# xml - 使用 xf:load 获取多个参数

> ID：10703091
> 
> 赞同：0
> 
> 时间：2012-05-22T13:31:21.323
> 
> 标签：xml, xforms, exist-db

我正在构建一个以 eXist 作为后端的 web 应用程序。我想用 xf:load 元素加载一个新的资源。

我所做的是这样的：

```
<xf:trigger>
  <xf:label>Trigger</xf:label>
    <xf:action ev:event="DOMActivate">
     <xf:load>
       <xf:resource value="concat('start.xql?floor={$floor}&amp;room={$room}', '')" />
     </xf:load>
    </xf:action>
</xf:trigger> 
```

但是当我点击触发器时，这个 url 被加载：

```
start.xql?floor=0&amp;room=E.01 
```

这显然是不希望的。当我不逃避 & 符号时，我得到一个解析错误：

```
Invalid character in entity name (=) or missing ; 
```

那么，通过 xf:load 元素传递多个参数的正确方法是什么？我可以用＆符号解决这个问题还是我只是错过了什么？

感谢您的帮助

亲切的问候克里斯蒂安

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T20:08:48.217

我在更改资源/@value 的 XPath 表达式后检查了 XSLTForms，因为实际上不需要 AVT……而且因为 XSLTForms 还不支持变量：

```
<xf:resource value="concat('start.xql?floor=',floor,'&amp;room=',room)"/> 
```

FireBug 网络分析器说：

```
http://localhost/xsltforms/trunk/src/testsuite/misc/start.xql?floor=FL&room=RM 
```

因此，我认为您最好将此问题发布到您正在使用的 XForms 实现的支持列表中。

-阿兰

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T17:53:32.410

您确定这是发送的 URL 吗？

在一般的 XML 文档中，即使它们在 URI 值中使用但它们的字符串值仍然存在，也`&`必须编写，并且将提交请求的软件（在这种情况下是 XForms 处理器）不应该混淆......`&amp;``&`

无论如何，在 XForms 中还有另一种处理查询字符串的方法，您也可以通过 HTTP get 提交带有查询字符串的实例。以下提交：

应该照顾这些＆符号“细节”。您可以通过以下方式调用它：

```
<xf:trigger>
  <xf:label>Trigger</xf:label>
  <xf:send ev:event="DOMActivate" submission="trigger-submission"/>
</xf:trigger> 
```

当然，假设正确的值已放置在实例中。

# php - 基于输入的正则表达式创建

> ID：10703094
> 
> 赞同：2
> 
> 时间：2012-05-22T13:31:50.387
> 
> 标签：php, javascript, regex

我有一个 Web 应用程序，用 PHP 编写，包含 Javascript 和 JQuery，将用作我公司的库存管理系统 (IMS)。我希望能够创建的是基于用户输入值的正则表达式。

这背后的想法是，大多数制造商的序列号模式、字符长度以及字母与数值的混合对于某个部分来说是唯一的。因此，当将零件添加到 IMS 并将第一个序列号扫描到系统中时，我希望构建一个 Regex 语句并将其保存到与该零件类型对应的数据库表中。以后任何时候扫描序列号时，都应将部件自动选择为部件类型，因为它与该制造商的序列号模式相匹配。我知道这种方法可能并不总是适用于单个零件，因此我什至可以返回与架构匹配的零件列表，而不是用户需要在目录中查找它。

我的问题的基础是，让代码中的函数能够破译用户给出的值以创建正则表达式的最佳起点是什么？我不是要求一个完整的功能，而是一个如何看待我的情况和目标的起点，这样我就可以理解从哪里开始。我已经挠头很长时间了，并开始多次编写函数，只是为了删除整个块，因为我知道我正走向灾难。

代码中的任何东西都是可能的——这可行吗？

* * *

**编辑 - 添加样本值**

DVD-RW（光驱）

*   1613518L121
*   1613509L121
*   1613519L121

VGA 输出卡

*   0324311071068
*   0324311071134

COM 扩展卡

*   608131234
*   608131237

硬盘驱动器

*   WMAYUJ753738
*   WMAYUJ072099
*   WMAYUJ683739
*   WMAYUJ844900

正如您所看到的，某些值将只是特定长度字符的数字。其他人将在开头有字母字符，后跟一系列数字。其他人可能有相互穿插的字母/数字字符。在大多数情况下，一个简单的字母/数字规则长度将适合识别我们商品列表中的单个零件类型。但是，在多个表达式匹配一个值的情况下，我可以简单地让应用程序显示两个或多个与正则表达式匹配的产品的列表，并提示用户选择正确的部分。总体而言，这将节省在 WMS 数据库中选择产品类型的时间和错误。

感谢您的评论。我知道我问的问题不是只有一个答案。我正在寻找一个关于如何最好地遍历字符串并吐出与该值匹配的相应正则表达式语句的起点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T14:11:03.883

正如@Pete 所说，我认为您为自己设定了过于雄心勃勃的目标。一些想法，可能从您的特定需求中过度概括。

我认为您想扫描 1-56592-487-8 之类的序列号并推断正则表达式 /\d-\d{5}-\d{3}-\d/ 匹配来自给定的制造商。（这恰好是我的“Java in a Nutshell”副本的 ISBN-10。ISBN 不是序列号，而是与我一起使用。）但是您无法从少数示例中推断出制造商使用的模式。也许第一个字符位置是一个十六进制数字 (0-F)。也许最后一个字符是校验和，可以是数字或 X（如 ISBN）。也许有一个后缀，并不总是存在，表示植物。因此，当零件的新实例出现时，您会发现自己为相同的制造商/零件类型构建了许多模式。

你也会遇到相反的问题。小部件制造商使用正则表达式 /[AZ]{3}\d{7}/，声波螺丝刀制造商使用相同的模式。

也就是说，你能做的最好的事情是这样的：

```
for each character in the scanned serial number
    if it is a capital letter
        add [A-Z] to the regular expression
    else if it is a digit
        add \d to the regular expression
    else 
        add the character itself to the regular expression, escaped as necessary
 end for
 collapse multiple occurrences with the {,} interval qualifier 
```

[车辆识别号码](http://en.wikipedia.org/wiki/Vehicle_Identification_Number)的规则也可能是鼓舞人心的。举几个例子，想想你将如何推断 VIN 的规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T14:43:57.217

编辑：对不起，我的示例代码有问题，您需要这种算法作为您将猜测的部分的第一步：[最长的子字符串](http://en.wikibooks.org/wiki/Algorithm_Implementation/Strings/Longest_common_substring)或[这个](https://stackoverflow.com/questions/2892931/longest-common-substring-from-more-than-two-strings-python)

您将需要添加迭代和一些掩蔽，就像上面和 David 解释的那样，也在下面的示例中，没有猜到 DVD-RW 的“L121”（正如我所说的，我必须从“common”开始）。因此，您需要找到所有常见的连续子序列并确定哪些是相关的！（可能带有一种最大化增益函数）

使用第二个链接 long_substr ：

```
>>> for x in d:
    for y in d:
        if x == y: continue
        common = long_substr([x, y])
        length = len(common)
        if x.startswith(common) and y.startswith(common):
            print "\t".join((x, y, str(length), common)) 
```

产生 =>

```
0324311071068   0324311071134   10  0324311071
0324311071134   0324311071068   10  0324311071
1613519L121 1613518L121 6   161351
1613519L121 1613509L121 5   16135
WMAYUJ844900    WMAYUJ753738    6   WMAYUJ
WMAYUJ844900    WMAYUJ072099    6   WMAYUJ
WMAYUJ844900    WMAYUJ683739    6   WMAYUJ
WMAYUJ753738    WMAYUJ844900    6   WMAYUJ
WMAYUJ753738    WMAYUJ072099    6   WMAYUJ
WMAYUJ753738    WMAYUJ683739    6   WMAYUJ
1613518L121 1613519L121 6   161351
1613518L121 1613509L121 5   16135
WMAYUJ072099    WMAYUJ844900    6   WMAYUJ
WMAYUJ072099    WMAYUJ753738    6   WMAYUJ
WMAYUJ072099    WMAYUJ683739    6   WMAYUJ
WMAYUJ683739    WMAYUJ844900    6   WMAYUJ
WMAYUJ683739    WMAYUJ753738    6   WMAYUJ
WMAYUJ683739    WMAYUJ072099    6   WMAYUJ
608131237   608131234   8   60813123
1613509L121 1613519L121 5   16135
1613509L121 1613518L121 5   16135
608131234   608131237   8   60813123 
```

--- 第一个错误回复从这里开始

以下是我回复的第一部分，它只能帮助您了解我错在哪里，并且可能会给您一些想法：

一个使用最长公共子序列问题求解器[LCS](http://code.activestate.com/recipes/576869-longest-common-subsequence-problem-solver/)的示例，满足您的特殊需求，我可以认为这是猜测什么是常见的过程的第一步？

它在 Python 中，但对于演示部分，它可以很容易地阅读（或者可以在 IDLE（python 编辑器）中剪切和粘贴）假设您使用上面第一个链接的 ActiveState 代码食谱

这与生物信息学有关（想想基因对齐）

您将需要一些东西来确定最有趣的常见序列是什么（可能有最小的长度？然后像大卫已经提出或在我的评论中提出的那样进行掩蔽

（起初我没有看到 LCS 不是 LCS 连续求解器，而你需要它！所以我第一次使用 LCS 求解器是错误的 :( 因为它不连续，我有 MAYUJ8 或 WMAYUJ7 而不是WMAYUJ - 更短！虽然求解器找到最长的常见字符而不期望它们是连续的！ - 再次抱歉）

```
>>> raw = """1613518L121
1613509L121
1613519L121

0324311071068
0324311071134

608131234
608131237

WMAYUJ753738
WMAYUJ072099
WMAYUJ683739
WMAYUJ844900"""
>>> d = dict()
>>> for line in raw.split("\n"):
    if not line.strip(): continue
    value = line.strip()
    d[value] = 1

>>> for x in d:
    for y in d:
        if x == y: continue
        length = LCSLength(x, y)
        common = LCS(x,y)
        if  length >= 3 and x.startswith(common):
            print "\t".join((x, y, str(length), common)) 
```

产生 =>

```
0324311071068   0324311071134   10  0324311071
0324311071068   608131234   4   0324
0324311071134   0324311071068   10  0324311071
WMAYUJ844900    WMAYUJ753738    7   WMAYUJ8
WMAYUJ753738    WMAYUJ072099    7   WMAYUJ7
608131237   608131234   8   60813123
608131234   608131237   8   60813123 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-03T00:40:11.130

运行垃圾邮件检测算法（统计算法，如贝叶斯或类似的“学习”算法）。这会或不会帮助你，但如果没有，我真的怀疑你会在这里做出任何有用的逻辑算法。

# asp.net-mvc-3 - 需要 MVC2 / MVC3 Html Helper 或 Editor Template 解决方案

> ID：10703101
> 
> 赞同：1
> 
> 时间：2012-05-22T13:31:59.400
> 
> 标签：asp.net-mvc-3, asp.net-mvc-2, razor, html-helper, razor-declarative-helpers

我有一个运行良好的基于​​ jquery 的定制查找控件，但我希望将它封装成一个更整洁的解决方案。以下是 Razor 视图中包含的代码。在幕后还有一个名为“InitLookup”的定制 jquery 函数，它在运行时完成大部分工作。

```
 <script type="text/javascript">
       $(document).ready(function () {
           InitLookup('#txtDelegatedToLookup', '#Delegated_To_ID', '@Url.Action("ContactLookup", "marMIS")');
       });
   </script>
   @Html.HiddenFor(m => m.Delegated_To_ID)
   <input id="txtDelegatedToLookup" type="text" /> 
```

理想情况下，我想将其缩减为一个更整洁、更可重用的解决方案，其中 javascript InitLookup() 是动态创建并封装在其中的，可能如下所示......

```
@Html.DynamicLookupFor(m => m.Delegated_To_ID, "ContactLookup", "marMIS") 
```

...其中“marMIS”是控制器，“ContactLookup”是控制器方法。这些是用于在查找期间获取数据的地址。

我试图在*/Views/Shared/EditorTemplates*文件夹中创建一个名为 DynamicLookup 的编辑器模板，但是在使用*@Html.DynamicLookup(...*

有这个的接盘侠吗？干杯!

------------ App_Code 建议如下！原始问题的附录！-------------------------

好的，所以我已将我的代码复制到一个名为 CustomHelpers.cshtml 的新 App_Code 文件夹文件中。如何将 lambda 表达式传递到此处然后使用它？

```
@using System.Security.Policy
@using System.Web.Mvc.Html

@helper DynamicLookup(LAMBDAEXPR, CtrlId, Controller, Method) {
    @Html.HiddenFor(LAMBDAEXPR)
    <input id="txtDelegatedToLookup" type="text" />
    @Html.ValidationMessageFor(LAMBDAEXPR)  

    <script type="text/javascript">
        $(document).ready(function () {
            InitLookup(txtCtrlId, idCtrlId, '@Url.Action(Controller, Method)');
        });
    </script>            
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T15:20:30.490

如果您想封装 javascript 部分，您可以创建一个`HtmlHelper`将生成所需内容的内容。

一个看起来像的例子如下：

```
public static MvcHtmlString DynamicLookupFor(this HtmlHelper htmlHelper, string txtCtrlId, string idCtrlId, string controllerName, string actionName)
{
    // create script tag
    var script = new TagBuilder("script");

    // generate script content
    var result = new StringBuilder();
    result.AppendLine("$(document).ready(function () {");
    result.Append("InitLookup(");

    result.Append("'" + txtCtrlId + "',");
    result.Append("'" + idCtrlId + "',");

    // generate action link
    var url = new UrlHelper(HttpContext.Current.Request.RequestContext);
    result.Append("'" + url.Action(actionName, controllerName));

    result.AppendLine("'});");

    script.InnerHtml = result.ToString();
    return MvcHtmlString.Create(script.ToString());
} 
```

在您的视图中，您可以按如下方式调用帮助程序：

```
@Html.DynamicLookupFor("#txtDelegatedToLookup", "#Delegated_To_ID", "ContactLookup", "marMIS") 
```

不要忘记在 Views 文件夹 web.config 中注册帮助程序：

```
 <namespaces>
    <add namespace="System.Web.Mvc" />
    <add namespace="System.Web.Mvc.Ajax" />
    <add namespace="System.Web.Mvc.Html" />
    <add namespace="System.Web.Routing" />
    <add namespace="Names Space Of Helper"/>   
  </namespaces> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T13:05:38.927

好的，这就是我最终做的事情。它确实非常好用！将来它需要一点点润色，它也为扩展它敞开了大门。例如，控件进行了验证，但它不会按照我的其余验证为自己着色，而只是显示文本验证消息。

该功能被称为...

```
@Html.CustomLookupFor(m => m.Task_History.Delegated_To_ID, "txtDelegatedToLookup", @Url.Action("ContactLookup", "marMIS"), new { width = "250px" }) 
```

...并且需要在剃刀视图页面顶部使用 using 语句...

```
@using Custom.MVC.Helpers; 
```

顺便说一句，有两件事...... jquery 1.7.2+ 和 jquery ui 1.8.16+ 是我开发这个时使用的！此外，下面第一个代码部分中的功能包括代码中 javascript 功能的缩小版本，以及包含格式良好的原始 javascript 代码的注释部分。

然后在后台有两段代码。这里的第一个是关于我最初的问题我正在寻求开发的可重用代码。它下面的第二个是服务器上的控制器方法。

```
using System;
using System.Linq.Expressions;
using System.Text;
using System.Web.Mvc;
using System.Web.Mvc.Html;
using System.Web.Routing;

namespace Custom.MVC.Helpers
{
    public static class CustomHtmlHelperExtensions
    {
        public static MvcHtmlString CustomLookupFor<TModel, TValue>(this HtmlHelper<TModel> html, Expression<Func<TModel, TValue>> exp, string id, string url, object options)
        {   
            var hidCtrlId = id + "_id"; 

            //Options
            var opt = new RouteValueDictionary(options);
            var textBoxWidth = (opt["width"] != null) ? opt["width"].ToString() : "";
            var textBoxVisibility = (opt["visibility"] != null) ? opt["visibility"].ToString() : ""; 

            //Construct the script fired when the document is fully loaded
            var sbScript = new StringBuilder();
            sbScript.Append("<script type='text/javascript'>");
            sbScript.Append("  function InitDynamicLookupFor(e,f){var g='#'+e;var h='#'+e+'_id';$(g).click(function(){$(g).val('');$(h).val('');$(h).trigger('change')});$(g).autocomplete({minLength:3,delay:100,autoFocus:true,autofill:true,mustMatch:true,matchContains:true,width:220,source:function(c,d){$.ajax({url:f,type:'POST',dataType:'json',data:{searchId:0,searchTerm:c.term,searchLimit:10},success:function(b){d($.map(b,function(a){return{id:a.id,value:a.value}}))}})},create:function(b,c){if($(h).val()!=''){$.ajax({url:f,type:'POST',dataType:'json',data:{searchId:$(h).val(),searchTerm:'',searchLimit:1},success:function(a){$(g).val(a[0].value);$(g).removeClass('DynamicLookupForNotSelected');$(g).addClass('DynamicLookupForSelected')}})}},select:function(a,b){$(h).val(b.item.id);$(g).val(b.item.value);$(g).removeClass('DynamicLookupForNotSelected');$(g).addClass('DynamicLookupForSelected');$(h).trigger('change');return false},open:function(a,b){$(h).val(null);$(g).removeClass('DynamicLookupForSelected');$(g).addClass('DynamicLookupForNotSelected')}});if($(h).val()==''){$(g).val('Type here to search!');$(g).removeClass('DynamicLookupForSelected');$(g).addClass('DynamicLookupForNotSelected')}}");
            sbScript.Append("  ");
            sbScript.Append("  $(document).ready(function () {");
            sbScript.Append("    InitDynamicLookupFor('" + id + "', '" + url + "');");
            sbScript.Append("  });");
            sbScript.Append("</script>");

            //Construct the HTML controls for the DynamicLookup and its validation
            var sbCtrls = new StringBuilder();
            sbCtrls.Append(html.HiddenFor(exp, new { id=hidCtrlId }));
            sbCtrls.Append("<input id='" + id + "' type='text' style='width:" + textBoxWidth + "; visibility:" + textBoxVisibility + ";' />");
            sbCtrls.Append(html.ValidationMessageFor(exp));

            //Return the lot back to the interface
            var retString = sbScript.ToString() + sbCtrls.ToString();
            return new MvcHtmlString(retString);
        }

    }
}

            //*** This is the original javascript code before it is minified for use above!  DON'T DELETE! ***
            //
            //    function InitDynamicLookupFor(textBox, url) {
            //    var $textBox = '#' + textBox;
            //    var $hiddenId = '#' + textBox + '_id';

            //    $($textBox).click(function () {
            //        $($textBox).val('');
            //        $($hiddenId).val('');
            //        $($hiddenId).trigger('change');
            //    });

            //    $($textBox).autocomplete({
            //        minLength: 3,
            //        delay: 100,
            //        autoFocus: true,
            //        autofill: true,
            //        mustMatch: true,
            //        matchContains: true,
            //        width: 220,
            //        source: function (request, response) {
            //            $.ajax({
            //                url: url, type: 'POST', dataType: 'json',
            //                data: { searchId: 0, searchTerm: request.term, searchLimit: 10 },
            //                success: function (data) {
            //                    response($.map(data, function (item) {
            //                        return {
            //                            id: item.id,
            //                            value: item.value
            //                        };
            //                    }));
            //                }
            //            });
            //        },
            //        create: function (event, ui) {
            //            if ($($hiddenId).val() != '') {
            //                $.ajax({
            //                    url: url, type: 'POST', dataType: 'json',
            //                    data: { searchId: $($hiddenId).val(), searchTerm: '', searchLimit: 1 },
            //                    success: function (data) {
            //                        $($textBox).val(data[0].value);
            //                        $($textBox).removeClass('DynamicLookupForNotSelected');
            //                        $($textBox).addClass('DynamicLookupForSelected');
            //                    }
            //                });
            //            }
            //        },
            //        select: function (event, ui) {
            //            $($hiddenId).val(ui.item.id);
            //            $($textBox).val(ui.item.value);
            //            $($textBox).removeClass('DynamicLookupForNotSelected');
            //            $($textBox).addClass('DynamicLookupForSelected');
            //            $($hiddenId).trigger('change');
            //            return false;
            //        },
            //        open: function (event, ui) {
            //            $($hiddenId).val(null);
            //            $($textBox).removeClass('DynamicLookupForSelected');
            //            $($textBox).addClass('DynamicLookupForNotSelected');
            //        }
            //    });

            //    //If no value selected by now, indicate to the user how to use the control
            //    if ($($hiddenId).val() == '') {
            //        $($textBox).val('Type here to search!');
            //        $($textBox).removeClass('DynamicLookupForSelected');
            //        $($textBox).addClass('DynamicLookupForNotSelected');
            //    }
            //} 
```

服务器上的控制器方法...

```
public JsonResult ContactLookup(int searchId, string searchTerm, int searchLimit)
    {
        //Prepare search filter from criteria entered
        var p = PredicateBuilder.True<vw_Contact_Verbose>();
        if (searchId != 0) p = p.And(x => x.Contact_ID == searchId); 
        if (searchTerm != "") p = p.And(x => x.Fullname.Contains(searchTerm));

        //Grab data
        var results =
            (from x in _mDb.ent.vw_Contact_Verbose.AsExpandable().Where(p).OrderBy("Fullname Desc").Take(searchLimit)
             select new { id = x.Contact_ID, value = x.Fullname + " (" + x.Company + ")" }).ToArray();

        return Json(results, JsonRequestBehavior.AllowGet);
    } 
```

我确实希望发现这个可重用的代码对其他人和我一样有用。这肯定使我的代码在剃刀视图中不那么冗长。

# javascript - JQuery - 获取 input='file' 中的所有文件名

> ID：10703102
> 
> 赞同：37
> 
> 时间：2012-05-22T13:32:00.217
> 
> 标签：javascript, jquery

我有`<input type="file" id="basicUploadFile" multiple="multiple">`并且我想在这个输入中获取所有文件名。我见过一些例子，但它只得到第一个文件的名称。

```
$ ('#basicUploadFile').live ('change', function () {
    alert($ ('#basicUploadFile').val());
}); 
```

我怎样才能做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2012-05-22T13:38:28.273

```
var files = $('#basicUploadFile').prop("files") 
```

`files`将是一个 FileList 对象。

```
var names = $.map(files, function(val) { return val.name; }); 
```

现在`names`是一个字符串数组（文件名）

[FileAPI 参考](http://dev.w3.org/2006/webapi/FileAPI/)
[文件属性参考](http://dev.w3.org/html5/spec/common-input-element-apis.html#dom-input-files)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-05-22T13:42:24.527

# [jsFiddle 演示](http://jsfiddle.net/r64uV/1/)

* * *

您仍然可以将文件作为`FileList`集合访问，而无需过度使用`jQuery`. 我创建了一个快速的[jsFiddle](http://jsfiddle.net/r64uV/1/)，演示了如何使用`FileList`和`File`对象从输入中获取信息。这是一个片段：

```
$('#basicUploadFile').live('change', function ()
{
    for (var i = 0; i < this.files.length; i++)
    {
        alert(this.files[i].name);
        alert(this.files.item(i).name); // alternatively
    }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-12-16T01:03:27.553

我用它在控制台中显示所有文件名：

```
var input_file = $("#input_file");
input_file.on("change", function () {
     var files = input_file.prop("files")
     var names = $.map(files, function (val) { return val.name; });
     $.each(names, function (i, name) {
          console.log(name);
     });
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-29T10:24:36.010

```
<input name="selectAttachment" id="selectAttachment" type="file" multiple="multiple">
<button class="btn btn-default" onclick="uploadAttachment()" type="submit">Upload</button>

function uploadAttachment() {
                debugger;
                var files = $('#selectAttachment').prop('files');
                var names = $.map(files, function (val) { return val.name; });
            } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-12-05T05:28:24.527

您可以扩展**File Object**的原型（例如`File.prototype.toJSON`），并且可以访问 FileList 的`<input ..>`：

```
<input id="myFile" type="file"> 
```

```
 var file = document.getElementById('fileItem').files[0]; 
```

有关更多信息，请查看此文档：

> [https://developer.mozilla.org/en-US/docs/Web/API/FileList#Using_the_file_list](https://developer.mozilla.org/en-US/docs/Web/API/FileList#Using_the_file_list)

### 检查这个简单的例子：

```
File.prototype.toJSON = function() {
	return {
		'lastModified'     : this.lastModified,
		'lastModifiedDate' : this.lastModifiedDate,
		'name'             : this.name,
		'size'             : this.size,
		'type'             : this.type 
	};
}

function getFiles() {
    var files = document.getElementById('myFiles').files;
    document.getElementById('result').innerHTML = '<h1>result</h1>'
      + JSON.stringify(files);
}
```

```
<input id="myFiles" type="file" multiple onchange="getFiles()" />
<pre id='result'></pre>
```

祝你好运！

# php - 网站在线运行良好，但在 localhost 上运行显示未定义的索引和变量

> ID：10703103
> 
> 赞同：1
> 
> 时间：2012-05-22T13:32:02.617
> 
> 标签：php, localhost, undefined-index

这里有恐慌！我的论文网站在网上运行良好，但在提交前一小时我发现它在本地主机上不起作用.. 两三个页面不断出现未定义的索引或变量。有人可以帮忙吗？这是一个错误的片段：注意：未定义的索引：第 76 行 C:\Users..\Desktop\USBWebserver v8_en\root\SnysbArchive\Search.php 中的表

```
<?php
include 'UserFunction.php';
..html omitted..
//write connect function in here
include('Connect.php'); //Connects to database
$sql = "SHOW TABLES FROM $dbname";
$result = mysql_query($sql);

if (!$result) 
{
    echo "DB Error, could not list tables\n";
    echo 'MySQL Error: ' . mysql_error();
    exit;
}
if (mysql_select_db($dbname, $conn))
{
?>
    <form method="post" action="SearchResults.php?go" id="searchform">
    In <select name="tables">
    <?php
    while ($row = mysql_fetch_row($result)) 
    {
    if ($row[0] != 'user_details' && $row[0] != 'request') 
    {
        echo '<option value="'.$row[0].'">'.$row[0].'</option>';
    }
    }
}
    ?>
    </select>
        Seach for: <input type="text" name="name"> 
    <input type="submit" name="submit" value="Search" />
</form>

<br>
<?php
$tbl=$_POST['tables'];
echo $tbl;
?> 
```

它不喜欢这一行 $tbl=$_POST['tables']; 谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T13:34:29.073

您的本地服务器将[错误报告](http://us2.php.net/manual/en/function.error-reporting.php)设置为高于生产服务器上的错误报告。这会导致您收到“较小”错误的错误消息，例如您不会在生产服务器上收到的通知。这是一件好事，因为您的生产服务器不应该显示错误消息可能对黑客有帮助，并且您的本地服务器应该告诉您您做错的*所有事情，无论大小，这样您就可以在上线**之前*正确构建您的应用程序。

在您的情况下`$_POST['tables']`，未设置并且正在由您的本地服务器报告。它也被您的生产服务器捕获，但由于您的错误报告设置，您没有收到通知（可能在您的错误日志中除外）。

**更新**

要修复您的错误，请在将其分配给变量之前检查该值是否存在：

```
$tbl = (isset($_POST['tables'])) ? $_POST['tables'] : ''; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-22T13:47:59.910

You could always put

```
error_reporting(E_ALL ^ E_NOTICE); 
```

In the top of the page, this will prevent PHP complaining about variables that are referenced but do not yet exist.

Better to do what @john conde suggested, my suggestion will remove the error but allow you to code as sloppily. Sloppy code isn't the best..

# php - PHP函数fwrite中的IF THEN表达式

> ID：10703105
> 
> 赞同：2
> 
> 时间：2012-05-22T13:32:14.520
> 
> 标签：php, if-statement

如何将 IF THEN 表达式放入 PHP 函数中`fwrite`？下面给出的代码不能正常工作。请看线`fwrite($fh, "$row[0]...)`。

```
 $myFile = "testFile.php";
    $fh = fopen($myFile, 'w') or die("can't open file");

    fwrite($fh, "lat    lon title   description iconOffset  icon\n");
    foreach ($result4 as $row):
        fwrite($fh, "$row[0]    $row[1] $row[2] Resource average speed is: $row[3] km/h -10,-10 if($row[4]==0) images/markerRed.png else images/markerGreen.png\n");
    endforeach;

    fclose($fh);
?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T13:35:25.790

```
$image = ($row[4] == 0) ? "images/markerRed.png" : "images/markerGreen.png";
/* ... $row[3] ... ".$image."\n"; */ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T13:35:32.730

试试这个：

```
foreach ($result4 as $row) 
{
    $s = "$row[0]    $row[1] $row[2] Resource average speed is: $row[3] km/h -10,-10 ";
    $s .= $row[4]==0 ? 'images/markerRed.png' : 'images/markerGreen.png';
    fwrite($fh, $s."\n");
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T13:36:24.513

`fwrite`不会理解或评估 PHP 逻辑。像这样分开`if`语句：

```
fwrite($fh, "$row[0]    $row[1] $row[2] Resource average speed is: $row[3] km/h -10,-10");
if($row[4]==0)
    fwrite($fh, " images/markerRed.png\n");
else
    fwrite($fh, " images/markerGreen.png\n"); 
```

# java - Commons Pooling: Generic- vs StackObjectPool

> ID：10703106
> 
> 赞同：0
> 
> 时间：2012-05-22T13:32:18.340
> 
> 标签：java, apache-commons, pool

文档`commons-pooling-1.6`定义`GenericObjectPool`为：

> `GenericObjectPool`为任意对象提供强大的池化功能。

此外，Javadocs 显示了大量可用于配置此池的字段。

Javadocs 还定义`StackObjectPool`为：

> 一个简单的、基于堆栈的 ObjectPool 实现 [它] 对池创建的“活动”实例的数量没有限制，但对于在不引入人为限制的情况下重用对象非常有用。

但我找不到任何将这两个池相互*比较的文献：*

*   他们俩的优点/缺点是什么？
*   什么时候应该使用`GenericObjectPool`over `StackObjectPool`，反之亦然？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T15:01:44.767

我认为`GenericObjectPool`只是更具可配置性。但是在长度的四倍时，它更有可能出现错误。只要您针对界面进行编码，如果您遇到问题，就可以在它们之间切换。

这里有一个比较[http://commons.apache.org/pool/guide/index.html](http://commons.apache.org/pool/guide/index.html)。

# python - django-contenttypes - 列出模型的所有通用关系

> ID：10703109
> 
> 赞同：4
> 
> 时间：2012-05-22T13:32:25.183
> 
> 标签：python, django, django-contenttypes

我想反思一个模型并列出它所有的后向通用关系。

我的模型如下所示：

```
class Service(models.Model):
    host = models.ForeignKey(Host)

    statuses = generic.GenericRelation(Status) 
```

状态对象如下所示：

```
class Status(TrackedModel):
    content_type = models.ForeignKey(ContentType)
    object_id = models.PositiveIntegerField()
    content_object = generic.GenericForeignKey()

    class Meta:
        verbose_name_plural = 'statuses' 
```

我想以编程方式了解这`statuses`是服务模型的通用关系。这可能吗？`Status._meta.fields`不显示`statuses`，但`Status._meta.get_all_field_names()`确实，只是它也显示了其他不需要的东西。

我认为这可能是一个可能的解决方案，但对我来说似乎真的很乱。我很想听听更好的。

```
from django.db.models.fields import FieldDoesNotExist
from django.contrib.contenttypes import generic

generic_relations = []
for field_name in Service._meta.get_all_field_names():
    try:
        field = Service._meta.get_field(field_name)
    except FieldDoesNotExist:
        continue

    if isinstance(field, generic.GenericRelation):
        generic_relations.append(field) 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T13:47:02.343

作品`GenericRelation`类似。`ManyToManyField`您可以在以下位置找到它`Service._meta.many_to_many`：

```
filter(lambda f:isinstance(f, generic.GenericRelation), Service._meta.many_to_many) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-11-11T22:38:27.353

2021 年更新：

列出所有`GenericRelations()`字段：

```
print(Service._meta.private_fields) 
```

输出：

```
[<django.contrib.contenttypes.fields.GenericRelation: statuses>] 
```

不过，如果您有更多具有`GenericRelations()`关系的字段，它们将显示在输出列表中。

检查文档：

[https://docs.djangoproject.com/en/3.2/releases/1.10/#id3](https://docs.djangoproject.com/en/3.2/releases/1.10/#id3)

或者，您可以返回所有具有`GenericRelation()`字段类型的字段。

前任：

```
# models.py
class MyModel(models.Model):
    . . .
    my_model_field = GenericRelation(OtherPolyModel)

def get_generic_relation_fields(self):
   """
   This function returns all the GenericRelation 
   fields needed to return the values that are 
   related to a polymorphic model.
   """
   fields = [f.attname for f in self.Meta.model._meta.get_fields()]
   file_fields = []
   for field in fields:
       get_type = self.Meta.model._meta.get_field(field)
       field_type = get_type.__class__.__name__

       if field_type == "GenericRelation":
           file_fields.append(field)

       return file_fields 
```

输出：

```
['my_model_field'] 
```

# c# - 与实体的交易范围

> ID：10703111
> 
> 赞同：5
> 
> 时间：2012-05-22T13:32:31.703
> 
> 标签：c#, .net, entity

我有一个带有 .NET 4 和数据层实体框架的 Windows 窗体应用程序我需要一种带有事务的方法，但是进行简单的测试我无法使其工作

在 BLL 中：

```
public int Insert(List<Estrutura> lista)
{
    using (TransactionScope scope = new TransactionScope())
    {
            id = this._dal.Insert(lista);
    }
} 
```

在 DAL 中：

```
public int Insert(List<Estrutura> lista)
{
   using (Entities ctx = new Entities (ConnectionType.Custom))
   {
     ctx.AddToEstrutura(lista);
     ctx.SaveChanges(); //<---exception is thrown here
   }
} 
```

“底层提供商在 Open 上失败。”

有人有想法么？

问题已解决 - 我的解决方案

我通过一些更改解决了我的问题。在我的一个 DAL 中，我使用批量插入和其他实体。问题事务是由于大部分事务（事务 sql）不理解事务范围而发生的，所以我在 DAL 中分离了实体，并在运行一些琐碎的过程中使用了 sql 事务。执行标量（）；

我相信这不是最优雅的方式，但解决了我的问题交易。

这是我的 DAL 的代码

```
 using (SqlConnection sourceConnection = new SqlConnection(Utils.ConnectionString()))
   {
        sourceConnection.Open();
        using (SqlTransaction transaction = sourceConnection.BeginTransaction())
        {
            StringBuilder query = new StringBuilder();
            query.Append("INSERT INTO...");
            SqlCommand command = new SqlCommand(query.ToString(), sourceConnection, transaction);
            using (SqlBulkCopy bulk = new SqlBulkCopy(sourceConnection, SqlBulkCopyOptions.KeepNulls, transaction))
            {                           
                bulk.BulkCopyTimeout = int.MaxValue;
                bulk.DestinationTableName = "TABLE_NAME";
                bulk.WriteToServer(myDataTable);

                StringBuilder updateQuery = new StringBuilder();
                //another simple insert or update can be performed here
                updateQuery.Append("UPDATE... ");
                command.CommandText = updateQuery.ToString();
                command.Parameters.Clear();
                command.Parameters.AddWithValue("@SOME_PARAM", DateTime.Now);
                command.ExecuteNonQuery();
                transaction.Commit();
            }
        }
    } 
```

谢谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T13:43:18.303

根据全能谷歌的说法，EF 似乎会在每次调用数据库时打开/关闭连接。既然这样做了，它将把事务视为使用多个连接（使用分布式事务）。解决这个问题的方法是在使用时手动打开和关闭连接。

这是有关[分布式事务问题](http://social.msdn.microsoft.com/Forums/en-US/adodotnetentityframework/thread/3aa3942d-1b56-4030-8ea6-8d9734da4168/)的信息。

以下是[手动打开和关闭连接的](http://msdn.microsoft.com/en-us/library/bb738698.aspx)方法。

一个小代码示例：

```
public int Insert(List<Estrutura> lista)
{
    using (TransactionScope scope = new TransactionScope())
    {
        using (Entities ctx = new Entities (ConnectionType.Custom))
        {
            ctx.Connection.Open()

            id = this._dal.Insert(ctx, lista);
        }
    }
}

public int Insert(Entities ctx, List<Estrutura> lista)
{
     ctx.AddToEstrutura(lista);
     ctx.SaveChanges();
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-22T13:41:37.840

与其使用 TransactionScope，不如在使用实体框架时使用 UnitOfWork 模式。请参考： [工作单元模式](http://blogs.microsoft.co.il/blogs/gilf/archive/2010/02/05/using-unit-of-work-pattern-with-entity-framework.aspx)

并且;

[工作单元和持久性无知](http://msdn.microsoft.com/en-us/magazine/dd882510.aspx)

# iphone - 如何在 iOS 上使用 Facebook API Graph 增加签到地点的数量

> ID：10703113
> 
> 赞同：1
> 
> 时间：2012-05-22T13:32:34.903
> 
> 标签：iphone, objective-c, ios, facebook, facebook-graph-api

我希望通过 iOS 上的 Facebook API Graph 增加签到地点的数量。

我正在使用 Hackbook 示例，目前 UITableView 中只显示了 5 个签到位置。

以下方法有一个距离参数，但我找不到要返回的签到地点数...

```
/*
 * Graph API: Search query to get nearby location.
 */
- (void)apiGraphSearchPlace:(CLLocation *)location {
    [self showActivityIndicator];
    currentAPICall = kAPIGraphSearchPlace;
    NSString *centerLocation = [[NSString alloc] initWithFormat:@"%f,%f",
                                location.coordinate.latitude,
                                location.coordinate.longitude];
    HackbookAppDelegate *delegate = (HackbookAppDelegate *)[[UIApplication sharedApplication] delegate];
    NSMutableDictionary *params = [NSMutableDictionary dictionaryWithObjectsAndKeys:
                                   @"place",  @"type",
                                   centerLocation, @"center",
                                   @"3000",  @"distance",
                                   nil];
    [centerLocation release];
    [[delegate facebook] requestWithGraphPath:@"search" andParams:params andDelegate:self];
} 
```

如果有人知道如何做到这一点，请告诉我。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:13:25.743

好的，我在**`- (void)request:(FBRequest *)request didLoad:(id)result`**方法中找到了：

```
case kAPIGraphSearchPlace:
        {
            NSMutableArray *places = [[NSMutableArray alloc] initWithCapacity:1];
            NSArray *resultData = [result objectForKey:@"data"];
            for (NSUInteger i=0; i<[resultData count] && i < 15; i++) {
                [places addObject:[resultData objectAtIndex:i]];
            }
            // Show the places nearby in a new view controller
            APIResultsViewController *controller = [[APIResultsViewController alloc]
                                                initWithTitle:@"Check In"
                                                data:places
                                                action:@"places"];
            [self.navigationController pushViewController:controller animated:YES];
            [controller release];
            [places release];
            break;
        } 
```

# c# - Scala：泛型类的构造函数中的自我类型

> ID：10703114
> 
> 赞同：0
> 
> 时间：2012-05-22T13:32:38.217
> 
> 标签：c#, scala, generics

下面是我移植到 Scala 中的 C# 代码。无需担心细节。

```
public class GridBase<HexT, SideT, UnitT, SegT> : IGridBase
    where HexT : Hex
    where SideT : Side
    where UnitT : Unit
    where SegT : ISeg
{
  public GridBase(Geometry<HexT, SideT, UnitT, SegT> geom, IGridBase orig)
  {
  this.geom = geom;
  }
}

public class Scen: Descrip<HexC, SideC, UnitC>, IListsGeom<HexC, SideC, UnitC>
{
    public Geometry<HexC, SideC, UnitC, ISegC> geomC;
    public override IGeom iGeom { get { return geomC; } }
    public HexCList hexCs { get; private set; }
    public override HexList<HexC> hexs { get { return hexCs; } }
    public SideCList sideCs { get; private set; }
    public override SideList<SideC> sides { get { return sideCs; } }   
    public UnitCList unitCs { get; private set; }
    public override KeyList<UnitC> units { get { return unitCs; } }
} 
```

正如 Martin Odersky 所指出的，泛型的问题在于类型参数引用及其约束引用的数量趋于爆炸式增长。但是对于 GridBase 类，我需要通过泛型而不是抽象类型来解析类型。所以我希望能够从一个类型参数中获得多种类型。所以在 Scala 中，我为我的类型创建了一个特征：

```
abstract class Hex(val num1: Int){} //These are declared in their own files
abstract class Side {val sideString = "This is a side"}

trait DescripTypes //separate file
{
  type HexT <: Hex
  type SideT <: Side
}

class ScenTypes extends DescripTypes //separate file
{ //This is an ex of an implemntation of the above in a different package
  type HexT = HexC
  type SideT = SideC
} 
```

然后我使用自我类型创建我的 Gridbase 类

```
class GridBase[T <: DescripTypes](val myHex: HexT) extends DescripTypes
{//Compiler doesn't recognise the HexT type in the constructor  
  other: DescripTypes =>
  type other = T  

  var testvar = 5   //The rest does nothing at useful at the moment
  var testvar2 = "" //just for testing
  def mymethod(var1: HexT) //Compiler recognises HexT
  {
    testvar += var1.num1 //This compiles fine
  }
  def method2(var1: SideT) //Compiler recognises SideT
  {
    testvar2 = var1.sideString //This compiles fine
  } 
```

}

出于某种原因，我似乎无法在 GridBase 类构造函数中使用 DescriptTypes 的类型成员，尽管我可以在类主体中很好地使用它们。任何帮助表示赞赏。但这也是从一个类型参数中获取多种类型的最佳方法吗？

澄清：所有类都在单独的文件中。这里没有内部类。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T15:15:22.833

`T#HexT`在构造函数中怎么样？

`#`称为[类型投影](https://stackoverflow.com/questions/9443004/what-does-the-operator-mean-in-scala)，用于指代内部类型。我不熟悉术语，因此不会详细介绍，但作为`A#B`执行类型级操作时使用的指南（另请参见[type lambdas](https://stackoverflow.com/questions/8736164/what-are-type-lambdas-in-scala-and-what-are-their-benefits)），而`A.B`与[path-dependent types 相关](https://stackoverflow.com/questions/5976791/is-a-path-dependent-type-a-subtype)。

注意：当`A`是一个包或对象时，它的`A.B`行为与您期望的一样，`#`有趣的是特性或类。

虽然不直接相关，但这可能证明是一个很好的阅读：[表达问题的独立可扩展解决方案](http://lampwww.epfl.ch/papers/IC_TECH_REPORT_200433.pdf)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T15:23:54.480

这当然很难猜，但我认为你的课程应该*可能*（你必须做出相当大的改变才能使它真正起作用）看起来像这样

```
class GridBase[T <: DescripTypes](val myHex: T#HexT) { this: T =>
  var testvar = 5
  var testvar2 = ""
  def mymethod(var1: HexT) {
    testvar += var1.num1
  }
  def method2(var1: SideT) {
    testvar2 = var1.sideString
  }
} 
```

在您的示例`mymethod`中`HexT`，我认为您希望将其限制为具有相同的外部类`myHex`。

根据用例（self-type 要求您混入 的子特征`DescripTypes`），以下更合适：

```
class GridBase[T <: DescripTypes](val myHex: T#HexT) {
  var testvar = 5
  var testvar2 = ""
  def mymethod(var1: T#HexT) {
    testvar += var1.num1
  }
  def method2(var1: T#SideT) {
    testvar2 = var1.sideString
  }
} 
```

您必须指定子类，`DescripTypes`然后才能使用这些子类中定义的类型别名。

```
val scenType = new ScenTypes
val scenTypeHex = new scenType.HexT
val scenTypeSide = new scenType.SideT
val gb_st = new GridBase[ScenTypes](scenTypeHex)
gb_st.mymethod(scenTypeHex)
gb_st.method2(scenTypeSide)

// and the same for some other subclass of DescribTypes
val scenType2 = new ScenTypes2
val scenType2Hex = new scenType2.HexT
val scenType2Side = new scenType2.SideT
val gb_st2 = new GridBase[ScenTypes2](scenType2Hex)
gb_st2.mymethod(scenType2Hex)
gb_st2.method2(scenType2Side)

// Does not compile:
gb_st2.method2(scenTypeSide) 
```

# cross-browser - FCKeditor 未将数据保存到 Chrome 浏览器中的数据库中

> ID：10703118
> 
> 赞同：0
> 
> 时间：2012-05-22T13:32:59.573
> 
> 标签：cross-browser, fckeditor

我的 fckeditor 在 Mozilla 中工作得很好。但它不会将文本保存到 Chrome 浏览器的数据库中。我通过 $,ajax 方法从 php 发送数据。这是PHP文件中的代码：

```
<div class="post_content"> Post Content <?

                                                        $sBasePath = $_SERVER['PHP_SELF'] ;
                                                        $sBasePath = "fckeditor/";

                                                        $oFCKeditor = new FCKeditor('FCKeditor1') ;
                                                        $oFCKeditor->Height = '400' ;
                                                        $oFCKeditor->BasePath   = $sBasePath ;
                                                        $oFCKeditor->Value      = '';
                                                        $oFCKeditor->Create(); 
                                                        ?>
                           </div> 
```

这是我的javascript：

```
$(document).ready(function(){

            $("#add_new_post").submit(function() {

                var FCKGetInstance = FCKeditorAPI.GetInstance('FCKeditor1'); 

                var getText = FCKGetInstance.EditorDocument.body.innerHTML; 
                var StripTag = getText.replace(/(<([^>]+)>)/ig,"");

                var dataString = 'FCKeditor1='+ getText;

                        if(StripTag=='')
                         {
                            alert('Please enter Post Content .');

                         } else {
                             //alert(dataString);
                                $.ajax({
                                        type: "POST",
                                        url: "ajax_add_new_blog_post.php",
                                        data: dataString,
                                        cache: false,
                                        success: function(html){

                                                $("body").showMessage({

                                                      'thisMessage':    [html],

                                                      'autoClose':  true,

                                                      'className':  'tooltip',

                                                      'delayTime':  8000,

                                                      'displayNavigation':  false

                                                  });

                                                      setTimeout(function() {
                                                      window.history.back();

                                                  }, 3000);

                                        } 

                                    });

                             }

                    return false;

                    }); 

    }); 
```

这是我的 ajax_add_new_blog_post.php 代码：

```
$pagedetail = RTESafe($_REQUEST['FCKeditor1']);

                        $str="INSERT INTO posts set

                        post_text='".mysql_real_escape_string($pagedetail)."'";

                        $success = mysql_query($str);

                        if($success){

                                echo 'You have added post successfully!';

                            }else{

                                echo 'Adding post was not successful. Try again';
                            }

function RTESafe($strText) {

     $tmpString = trim($strText);

     $tmpString = str_replace(chr(145), chr(39), $tmpString);

     $tmpString = str_replace(chr(146), chr(39), $tmpString);

     $tmpString = str_replace("'", "&#39;", $tmpString);

     $tmpString = str_replace(chr(147), chr(34), $tmpString);

     $tmpString = str_replace(chr(148), chr(34), $tmpString);

     $tmpString = str_replace(chr(10), " ", $tmpString);

     $tmpString = str_replace(chr(13), " ", $tmpString);

     return $tmpString;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T19:48:56.903

如果可能的话，我的猜测是使用[CKeditor](http://ckeditor.com/download)。FCKeditor 已过时。

# c#-4.0 - TripleDESCryptoServiceProvider 和 \0

> ID：10703120
> 
> 赞同：2
> 
> 时间：2012-05-22T13:33:05.653
> 
> 标签：c#-4.0, encryption

我`TripleDESCryptoServiceProvider`用来加密数据，我注意到的一件事是，当我使用它解密数据时，数据有时会以一系列`'\0'`字符结尾。所以，如果我加密`"Sachin"`然后解密这个的加密版本，我会回来`"Sachin\0\0"`。这是一个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T14:47:21.290

在这种情况下，您的加密方法可能会添加一些填充，即零填充。您的解密方法不需要填充，因此它只是将其解密，就好像它是原始明文的一部分一样。

DES 是一种块密码，它只能处理 64 位（8 字节）块中的数据。任何明文都被填充到下一个块边界。

零填充不好，因为如果纯文本以零字节结尾（如 C 风格的字符串），就会出现问题。更改您的加密方法以添加[PKCS#5 padding](http://en.wikipedia.org/wiki/Padding_%28cryptography%29#Byte_padding)，并更改您的解密方法以期望相同。然后填充将被自动删除，您将永远看不到它。

# c++ - 尝试显示我的线程的优先级时出现分段错误

> ID：10703121
> 
> 赞同：1
> 
> 时间：2012-05-22T13:33:06.620
> 
> 标签：c++, pthreads

我创建了两个线程，我想在创建它们后查看它们的优先级：- 为此，我编写了以下代码：-

```
 #include <iostream>
   #include <unistd.h>
   #include <pthread.h>
   #include <sched.h>
   #include <string.h>
   #include <errno.h>
   int main()
   { //something
     struct sched_param main_param, t1_param, t2_param;
     pthread_t t1, t2;
      int *sched1, *sched2;
     if (pthread_create(&t1, NULL, fn1, NULL) != 0) // inside fn1 thread sleeps in loop
      {
        std::cout << "couldn't create t1" << std::endl;
        return -1;
       }
     if (pthread_create(&t2, NULL, fn2, NULL) != 0)  //inside fn2 thread sleeps in loop
      {
        std::cout << "couldn't create t2" << std::endl;
        return -1;
      }

   if (pthread_getschedparam(t1, sched1, &t1_param) != 0) 
     {
       std::cout << "error setting priority for T1: (" << errno << "), " << 
        strerror(errno) << std::endl;
     }
  std::cout << "t1 thread will have a prio of " << t1_param.sched_priority << std::endl;
   if (pthread_getschedparam(t1, sched2, &t1_param) != 0) 
     {
       std::cout << "error setting priority for T1: (" << errno << "), " << 
       strerror(errno) << std::endl;
     }
   std::cout << "t2 thread will have a prio of " << t2_param.sched_priority <<std::endl;

 // something 
 } 
```

只有当我添加与`pthread_getschedparam`我得到分段错误相关的代码时，否则代码工作正常。我在这里做错了吗？我什至尝试替换arhument`sched1`并`sched2`通过`NULL`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T13:36:20.067

您声明了指针`sched1`和`sched2`类型`int*`，但从未初始化这些指针。您需要分配`int`变量，然后将指针传递给这些变量。

像这样：

```
int sched1, sched2;
.....
if (pthread_getschedparam(t1, &sched1, .... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T13:36:48.533

```
整数 *sched1;
pthread_getschedparam(t1, sched1, &t1_param); // sched1 是未初始化的指针！

```

考虑这个变化：

```
int sched1;
pthread_getschedparam(t1, &sched1, &t1_param);

```

# c++ - Qt - 使用 QUILoader 加载没有父级的小部件

> ID：10703122
> 
> 赞同：2
> 
> 时间：2012-05-22T13:33:09.023
> 
> 标签：c++, qt, qt-creator

我刚刚开始学习 Qt，我正在尝试使用这个 QUiLoader 创建一个简单的小部件。但我收到此错误：“设计器：读取第 1 行第 0 列的 UI 文件时发生错误：文档过早结束。”

```
#include <QtGui/QApplication>
#include <QtUiTools/QUiLoader>
#include <QFile>

int main(int argc, char *argv[])
{
    QApplication a(argc, argv);

    QUiLoader loader;
    QFile file(":/aks.ui");
    file.open(QFile::ReadOnly);

    QWidget *myWidget = loader.load(&file);
    if(myWidget){
        myWidget->show();
    }

    return a.exec();
} 
```

我使用 QtCreator 2.4.1 构建了 ui 文件，我使用的是 Qt 4.7.4。也检查 ui 文件。

```
<?xml version="1.0" encoding="UTF-8"?>
<ui version="4.0">
 <class>Form</class>
 <widget class="QWidget" name="Form">
  <property name="geometry">
   <rect>
    <x>0</x>
    <y>0</y>
    <width>131</width>
    <height>129</height>
   </rect>
  </property>
  <property name="windowTitle">
   <string>Form</string>
  </property>
  <layout class="QGridLayout" name="gridLayout">
   <item row="0" column="0">
    <layout class="QVBoxLayout" name="verticalLayout">
     <item>
      <widget class="QCheckBox" name="checkBox">
       <property name="text">
        <string>A</string>
       </property>
      </widget>
     </item>
     <item>
      <widget class="QCheckBox" name="checkBox_2">
       <property name="text">
        <string>B</string>
       </property>
      </widget>
     </item>
     <item>
      <widget class="QCheckBox" name="checkBox_3">
       <property name="text">
        <string>C</string>
       </property>
      </widget>
     </item>
     <item>
      <widget class="QCheckBox" name="checkBox_4">
       <property name="text">
        <string>D</string>
       </property>
      </widget>
     </item>
     <item>
      <widget class="QCheckBox" name="checkBox_5">
       <property name="text">
        <string>E</string>
       </property>
      </widget>
     </item>
    </layout>
   </item>
   <item row="0" column="1">
    <widget class="QPushButton" name="pushButton">
     <property name="text">
      <string>PushButton</string>
     </property>
    </widget>
   </item>
  </layout>
 </widget>
 <resources/>
 <connections/>
</ui> 
```

我的项目文件：

```
#-------------------------------------------------
#
# Project created by QtCreator 2012-05-21T19:48:31
#
#-------------------------------------------------

QT       += core gui

TARGET = Example
TEMPLATE = app

SOURCES += main.cpp \
    sortdialog.cpp

HEADERS  += \
    sortdialog.h

FORMS    += \
    sortdialog.ui \
    aks.ui

CONFIG += uitools 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T13:52:53.043

您需要将 .ui 文件添加到项目的资源中。资源是在您的应用程序中“编译”的文件，然后可以通过以`":/"`.

为了将资源添加到您的项目，您需要创建一个资源文件，列出您想要注册为资源的文件。该文件将是另一个 XML 文件，可以由 QtCreator 创建和编辑。在项目管理器中，添加另一个文件并从对话框中选择类型 Qt -> Qt 资源文件。

然后在您的 .pro 文件中出现一个部分：

```
RESOURCES += \
    resources.qrc 
```

在资源文件中需要添加前缀；只需命名它`/`（或将其留空）。在此前缀中，您可以添加文件`aks.ui`，以便将其命名为`:/aks.ui`.

请注意，这种类型的 UI 创建发生**在运行时**。这意味着，它更灵活（也许 ui 文件仅在运行时创建），但速度稍慢（因为进行了解析和更多的运行时处理）。

* * *

如果您是 Qt 新手，您可能不知道您还可以让 Qt**在构建过程中**为您的 ui 文件创建一个类文件。当您在该部分的 pro 文件中列出您的 ui 文件时，这已经完成`FORMS +=`。

要使用自动构建的类，您还应该创建一个设计器表单类，这是您将自己的代码放入其中的另一个类。此类将加载自动构建的类来设置您的 ui。

所以有两个类： * 为您的 ui 文件自动生成的类，称为`Ui::Aks`（在命名空间 Ui 中），可在`ui_aks.h`build 文件夹中的文件中找到。* 你自己的包装类；acutal 小部件类，它使用 ui 类。

如果您想手动创建第二个类，您可以编写（当您添加设计器表单类而不是仅设计器表单时，QtCreator 实际上会执行此步骤）：

**aks.h：**

```
#ifndef AKS_H
#define AKS_H

#include <QWidget>

namespace Ui {
    class Aks; // <-- this is the automatically created ui class which we need
}

class aks : public QWidget // <-- your own widget class using the designer UI
{
    Q_OBJECT

public:
    explicit Aks(QWidget *parent = 0);
    ~Aks();

private:
    Ui::Aks *ui; // <-- instance of the automatically created ui class
};

#endif // AKS_H 
```

**aks.cpp：**

```
#include "aks.h"
#include "ui_aks.h" // <-- include the automatically generated ui class

Aks::Aks(QWidget *parent) :
    QWidget(parent),
    ui(new Ui::Aks)
{
    ui->setupUi(this); // <-- here, the widgets from the ui file get created
}

Aks::~Aks()
{
    delete ui;
} 
```

# java - 将自定义首选项添加到系统设置

> ID：10703130
> 
> 赞同：2
> 
> 时间：2012-05-22T13:33:22.447
> 
> 标签：java, android, android-preferences

我可以将自定义 PreferenceActivity 添加到系统设置（Settings.apk）吗？我有几个应用程序，我想将它们组合在一个地方。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T13:37:55.720

SDK 中的开发人员没有外部框架来完成此任务。在设置等系统应用程序中创建自定义行为的唯一方法是直接修改应用程序源并使用自定义 ROM 分发修改后的应用程序。

高温高压

# c# - 如何在 Azure 中执行区分大小写的 LINQ 查询？

> ID：10703142
> 
> 赞同：1
> 
> 时间：2012-05-22T13:34:02.067
> 
> 标签：c#, linq, azure, azure-table-storage

我正在使用 Windows Azure 存储表，并且想要查询一个对象。用户输入一个字符串，我在数据库中查找它：

```
var myKey = "SomeCaseSensitiveKeyInputByTheUser";

var someObject = (from o in dataContext.Objects
    where o.SomeString.Equals(myKey)
    select o).FirstOrDefault(); 
```

但是，由于某种原因，所有字符串比较似乎都不区分大小写（`==`和`string.Equals()`）。但是，我需要匹配用户输入字符串的确切大小写。

如何在我的 LINQ 查询中执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T13:47:36.497

Using`==`与 相同`.Equals(..)`，因为它只是调用该方法。`string.comparison`您可以使用传递枚举的 Equal() 重载来强制使用区分大小写的比较

```
CurrentCulture                   Compare strings using culture-sensitive sort rules and the current culture.
CurrentCultureIgnoreCase         Compare strings using culture-sensitive sort rules, the current culture, and ignoring the case of the strings being compared.
InvariantCulture                 Compare strings using culture-sensitive sort rules and the invariant culture.
InvariantCultureIgnoreCase       Compare strings using culture-sensitive sort rules, the invariant culture, and ignoring the case of the strings being compared.
Ordinal                          Compare strings using ordinal sort rules.
OrdinalIgnoreCase                Compare strings using ordinal sort rules and ignoring the case of the strings being compared. 
```

更多信息：

[http://msdn.microsoft.com/en-us/library/system.stringcomparison.aspx](http://msdn.microsoft.com/en-us/library/system.stringcomparison.aspx)

# web-services - 如何从亚马逊 URL 请求信息

> ID：10703144
> 
> 赞同：2
> 
> 时间：2012-05-22T13:34:21.803
> 
> 标签：web-services, datetime, amazon-web-services

谁能解释我应该从这个 URL 中输入什么信息：

```
http://webservices.amazon.com/onca/xml?
Service=AWSECommerceService&
AWSAccessKeyId=[AWS Access Key ID]&
Operation=ItemSearch&
ItemId=B000Q678OO&
ResponseGroup=Images&
SearchIndex=Blended&
Version=2011-08-01
&Timestamp=[YYYY-MM-DDThh:mm:ssZ]
&Signature=[Request Signature] 
```

AWSAccessKeyId：访问密钥 ID

时间戳：UTC 时间显示为 YYYY-MM-DDThh:mm:ssZ -> 那么我怎样才能像这样显示添加到 url

签名：它是秘密访问密钥吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T13:51:22.827

不，签名是从请求参数和秘密访问密钥生成的字符串。

以下文章解释了如何生成签名：

[http://docs.amazonwebservices.com/AWSECommerceService/latest/DG/rest-signature.html](http://docs.amazonwebservices.com/AWSECommerceService/latest/DG/rest-signature.html)

# ssis - ssis中两种不同类型的excel数据源有什么区别

> ID：10703145
> 
> 赞同：0
> 
> 时间：2012-05-22T13:34:26.360
> 
> 标签：ssis

oledb数据源中用于EXCEL的oledb提供程序和ssis数据流任务中的excel数据源有什么区别？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T15:22:28.613

它们本质上是一样的。Excel 数据源使用 Microsoft OLE DB Jet 4.0 提供程序连接到 Excel 文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T15:50:50.660

兼容性： http: [//msdn.microsoft.com/en-us/library/cc280527 (SQL.100).aspx](http://msdn.microsoft.com/en-us/library/cc280527(SQL.100).aspx)

# ant - 如何在 ant 中访问属性中的属性

> ID：10703148
> 
> 赞同：3
> 
> 时间：2012-05-22T13:34:30.737
> 
> 标签：ant

大家好，请看一下这段代码

在我的属性文件中，我有 win-x86.pc-shared-location=E:\Ant_Scripts

现在下面我试图`PrintInstallerName_build`从我的 build.xml 调用，而`PrintInstallerName_build`在 test.xml 中也是如此。在 build.xml 文件中，`${platform.id} has value=win-x86`在调用目标和被调用目标 param1 中也有 value=win-x86

```
 <target name="PrintInstallerName" >
    <echo>PlatForm.Id====>${platform.id}</echo>
    <ant antfile="test.xml" target="PrintInstallerName_build">
        <property name="param1" value="${platform.id}"/>
    </ant>

<target name="PrintInstallerName_build" >
       <echo>${param1.pc-shared-location}</echo><!--${param1.pc-shared-location}-->
        <echo>${param1}.pc-shared-location}</echo><!--win-x86.pc-shared-location-->
    <echo>${win-x86.pc-shared-location}</echo><!--E:\\Ant_Scripts-->
</target> 
```

正如你所看到的，只有最后一条语句给出了正确的输出，但它是硬编码的，我想使用 param1 并且输出应该是`E:\\Ant_Scripts`我尝试使用 $ 和 @ 但没有工作，可能是我在某处做错了，有人可以帮忙吗，我我被击中了，明天就是它的国防部。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T15:35:38.950

请参阅Ant 手册的[属性页面中](http://ant.apache.org/manual/properties.html)*的花括号嵌套。*

> 在其默认配置中，Ant 不会尝试平衡属性扩展中的大括号，它只会在创建属性名称时使用直到第一个右大括号的文本。即当扩展像 ${a${b}} 这样的东西时，它将被翻译成两部分：
> 
> ```
> the expansion of property a${b - likely nothing useful.
> the literal text } resulting from the second closing brace 
> ```
> 
> 这意味着您不能轻松地使用由属性给出名称的扩展属性，但是对于旧版本的 Ant 有一些解决方法。使用 Ant 1.8.0 和 props Antlib，如果您需要这样的功能，您可以将 Ant 配置为使用其中定义的 NestedPropertyExpander。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-02-26T22:13:19.547

您可以使用`<propertycopy>`它来实现它。
考虑到您需要具有以下属性值`${propA${propB}}`

使用ant标签`propertycopy`如下：

```
<propertycopy property="myproperty" from="PropA.${PropB}"/>

<echo >${myproperty}</echo> 
```

这将呼应`${propA${propB}}`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T05:53:53.967

```
<target name="PrintInstallerName_process" >
       <echo>${param1}</echo><!--win-x86-->

        <macrodef name="testing">
                <attribute name="v" default="NOT SET"/>
                <element name="some-tasks" optional="yes"/>
                    <sequential>
        <echo>Source Dir of ${param1}: ${@{v}}</echo><!-- Dir of Win-x86:E:\Ant_Scripts-->
                                                    <some-tasks/>
                    </sequential>
            </macrodef>

            <testing v="${param1}.pc-shared-location">
                <some-tasks>

                </some-tasks>
            </testing>
    </target> 
```

这就是它的工作方式，对我来说它工作正常无论如何`@sudocode`你的小费把我带到了那里，所以非常感谢你

# java - 正则表达式替换全部不起作用

> ID：10703149
> 
> 赞同：1
> 
> 时间：2012-05-22T13:34:34.090
> 
> 标签：java, android

我从另一个 StackOverflow 帖子中复制了这段代码。但是，我遇到了一些问题。应该替换与指定模式匹配的项目，但它们不是。

代码是：

```
protected String FixHexValuesInString(String str){
    Log.v(TAG, "before fix: "+ str);
    Matcher matcher = Pattern.compile("\\\\x([0-9a-f]{2})").matcher(str);
    while (matcher.find()) {
        int codepoint = Integer.valueOf(matcher.group(1), 16);
        Log.v(TAG, "matcher group 0: " + matcher.group(0));
        Log.v(TAG, "matcher group 1: " + matcher.group(1));
        str = str.replaceAll(matcher.group(0), String.valueOf((char) codepoint));
    }
    Log.v(TAG, " after fix: "+ str);
    return str;
} 
```

这是我写给 LogCat 的一个例子：

```
before fix: 'id': 1268, 'name': 'Reserva de Usos M\xfaltiples de la Cuenca del Lago de Atitl\xe1n-RUMCLA (Atitl\xe1n Watershed Multiple Use Reserve)'
matcher group 0: \xfa
matcher group 1: fa
matcher group 0: \xe1
matcher group 1: e1
matcher group 0: \xe1
matcher group 1: e1
 after fix: 'id': 1268, 'name': 'Reserva de Usos M\xfaltiples de la Cuenca del Lago de Atitl\xe1n-RUMCLA (Atitl\xe1n Watershed Multiple Use Reserve)' 
```

有人知道为什么这不起作用吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T13:38:19.193

当您进行正则表达式匹配和替换时，您根本不应该使用`String.replaceAll`方法......您应该使用内置的匹配器[`Matcher.appendReplacement`](http://docs.oracle.com/javase/6/docs/api/java/util/regex/Matcher.html#appendReplacement%28java.lang.StringBuffer,%20java.lang.String%29)和[`Matcher.appendTail`](http://docs.oracle.com/javase/6/docs/api/java/util/regex/Matcher.html#appendTail%28java.lang.StringBuffer%29)这样的方法：

```
public static void main(String[] args) {

    String str = "'id': 1268, 'name': 'Reserva de Usos M\\xfaltiples de " +
                 "la Cuenca del Lago de Atitl\\xe1n-RUMCLA (Atitl\\xe1n " +
                 "Watershed Multiple Use Reserve)'";

    Matcher matcher = Pattern.compile("\\\\x([0-9a-f]{2})").matcher(str);

    StringBuffer sb = new StringBuffer();
    while (matcher.find()) {
        int codepoint = Integer.valueOf(matcher.group(1), 16);
        matcher.appendReplacement(sb, String.valueOf((char) codepoint));
    }
    matcher.appendTail(sb);

    System.out.println(sb);
} 
```

输出：

```
'id': 1268, 'name': 'Reserva de Usos Múltiples de la Cuenca del Lago de Atitlán-RUMCLA (Atitlán Watershed Multiple Use Reserve)' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T13:44:11.393

`replaceAll()`使用第一个参数作为正则表达式。在您的第一组中，您拥有`\xfa`未转义的`\`. 尝试`\`在组的开头添加一个。

# sql-server-2008 - 如何更改我的本地 sql server sa 密码？

> ID：10703150
> 
> 赞同：4
> 
> 时间：2012-05-22T13:34:36.883
> 
> 标签：sql-server-2008

我是我电脑上的本地管理员，如何更改我本地安装的sql server 2008 的sa 密码？

**注意：我不知道sa账户的密码**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-06-16T14:44:00.543

对线程的真正延迟响应，但我刚刚丢失并重置了 SA 的密码。

按照下面的简单步骤，你就完成了：

1.  以 Window 的身份验证模式连接 SQL Server。

2.  现在转到**安全性**并进行探索。

3.  转到**安全**下的**登录**。

***   选择用户**sa**

    *   **右键单击**sa**并**选择**属性**

    *   您将在此处获得重置密码选项，更改它并再次使用新密码登录。** 

 **干杯:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T13:37:56.797

单程

```
USE [master]
GO
ALTER LOGIN [sa] WITH PASSWORD=N'NewPassword'
GO 
```

也可以去安全，右键ss，选择属性，在密码字段里改**

# javascript - 列表中的图像未正确显示（就像在表格中一样），如何做到这一点

> ID：10703151
> 
> 赞同：0
> 
> 时间：2012-05-22T13:34:37.383
> 
> 标签：javascript, jquery, html

我有这样的代码：

```
<ul>
   <li>some text <img src="path" style="height:15px;width:25px;" /></li>
   <li>some text <img src="path" style="height:15px;width:25px;" /></li>
   <li>some text <img src="path" style="height:15px;width:25px;" /></li>
</ul> 
```

我想要的是，“一些文本”和 img 应该整齐地出现，就好像它们是桌子上的 2 列一样。另外，如果文字像“ab”这样小，那么图像不应该改变它的位置，我的意思是，不应该靠近，它应该总是在“一些文字”之后80px的远距离。而且，如果文本长度超过 80，则 img 应该仅位于 text 之后。如有必要，将提供更多信息。
谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T13:49:04.573

```
<li><span style="min-width:80px; display: inline-block;">some text</span>
<img src="path" style="height:15px;width:25px; float:left;" /></li> 
```

这将有效...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T13:56:58.220

您可以通过在列表项和一些 CSS 中添加几个 span 标签来解决问题，如下所示：

```
<style type="text/css">

li {
    clear: left;
}

li span {
    display:block;
    float: left;
    width: 140px;
}

li img {
    float: left;
}
​
</style>

<ul>
    <li><span>some text</span><img src="path" style="height:15px;width:25px;" /></li>
    <li><span>some text bla bla bla</span><img src="path" style="height:15px;width:25px;" /></li>
    <li><span>some text</span><img src="path" style="height:15px;width:25px;" /></li>
</ul>​ 
```

你可以在这里查看结果：http: [//jsfiddle.net/magnusohlin/xhLmx/](http://jsfiddle.net/magnusohlin/xhLmx/)

# qt - 如何获得qtoolbar的实际位置？

> ID：10703155
> 
> 赞同：0
> 
> 时间：2012-05-22T13:34:46.883
> 
> 标签：qt

我只是想获得实际的 x、y 值或 `Qt::ToolBarArea`我的`QToolBar`.

有什么功能可以得到它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T13:40:31.967

签出[`QWidget::mapTo`](http://qt-project.org/doc/qt-4.8/qwidget.html#mapTo)和相关功能。我认为你想做类似的事情：

`yourWidget->mapToParent(0, 0)``yourWidget`- 将(ie ) 的左上角映射`0, 0`到其父窗口小部件的坐标系。

# tridion - 在 Tridion 2009 中，是否可以抑制 RTF 图像工具的高级对话框？

> ID：10703156
> 
> 赞同：2
> 
> 时间：2012-05-22T13:34:48.823
> 
> 标签：tridion, tridion2009

在富文本格式区域中，我们的网站设计仅规定了几种设置图像样式的可能性。这些可能性是通过 FormatAreaStyles 配置提供的。

如果作者选择图像，打开图像工具，然后单击“高级”按钮，他们将可以从各种格式选项中进行选择，然后将其作为内联 CSS 属性保存在 HTML 中。保存时，这些内容会被 XSLT 删除，这会让用户感到困惑。

为了防止这种混淆，我宁愿根本不显示高级功能。那么，以这种方式定制 2009 gui 的首选技术是什么？我记得在早期版本中，通过 XSLT 修改 RTF 用户界面是很常见的，但我怀疑这不适用于我的场景。也许可以使用 GUI 扩展，它使用 JavaScript 使高级按钮不可见。有谁知道公共领域中可用的这种实现？还有哪些其他技术可能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T21:08:15.010

正如约翰在我的一个问题上所建议的那样（http://stackoverflow.com/questions/10703177/is-it-possible-to-remove-the-upload-mm-component-button-from-the-sdl-tridion-2 /10706405#10706405），您可以尝试使用 CSS 和 !important 属性隐藏它以覆盖默认 CSS。这可能比使用 JavaScript 更容易，但不是一个理想的场景。

# sql - Oracle Where 'TEXT' 以一定百分比匹配某些内容

> ID：10703157
> 
> 赞同：2
> 
> 时间：2012-05-22T13:34:49.273
> 
> 标签：sql, oracle, function, pattern-matching, match

我记得看到有人在 Oracle 中使用一个函数，他们可以指定文本匹配的百分比。例如：

`0123456789`会匹配这个：`1123456789`90% 左右（我不是数学家，但希望你明白......）

我想不出正确的关键字来搜索以找到我正在寻找的功能。谁能帮我解决这个问题？谢谢。

它可能看起来像这样：

```
select *
from something s
where matches(s.textcolumn, 'Matching Text') > .9 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T13:47:18.893

您要查找的包是[`utl_match`](http://docs.oracle.com/cd/E14072_01/appdev.112/e10577/u_match.htm).

它包含通过编辑距离和相似度比较字符串的功能。

# c++ - C++ Speex 到 Flac 包装器/库

> ID：10703168
> 
> 赞同：0
> 
> 时间：2012-05-22T13:35:30.260
> 
> 标签：c++, wrapper, speex, flac

应用程序正在使用 speex 编解码器将音频传输到服务器。在服务器上，我需要将 speex 解码为 PCM（或其他东西？），然后使用 flac 对其进行编码并发送到 Google Speech API。speex/flac 是否有任何易于使用的包装器（或库）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T13:52:17.423

听起来像是 gstreamer 的工作。我不太了解它，但根据[插件页面](http://gstreamer.freedesktop.org/documentation/plugins.html)，它当然可以处理 FLAC 和 Speex 。

# python - Efficiently counting elements in a very large XML doc using lxml

> ID：10703169
> 
> 赞同：3
> 
> 时间：2012-05-22T13:35:32.453
> 
> 标签：python, xml, lxml

I have a very large (1.8GB) XML document. I'd like to simply find the number of elements with the tag `<Product>`.

I've got this far:

```
context = etree.iterparse('./test.xml', tag='Product')
num_elems = 0
for event, elem in context:
    num_elems += 1
print num_elems 
```

It works, but is there a faster way of doing it?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T13:59:30.170

Since this works, I take it that memory use is not an issue (`iterparse` *will* build a tree of the entire file in memory unless you prune it while iterating over the elements). In that case, save yourself the trouble of iterating and counting in Python and let LXML/`libxml` handle that in C:

```
tree = etree.parse("./test.xml")
num_elems = tree.xpath("count(//Product)")    # note: returns a float 
```

# python - Python目录结构

> ID：10703170
> 
> 赞同：0
> 
> 时间：2012-05-22T13:35:32.707
> 
> 标签：python, directory

我正在尝试创建一个包含代表月份的子目录的年目录结构，即。

*   2012
    *   01
    *   02
    *   03

我的代码是这样的：

```
newpath = "test"
for year in range(2000, 2013):
    for month in range(1, 13):
        newpath += str(year)+'\\'+str(month)
        if not os.path.exists(newpath):
            os.makedirs(newpath) 
```

我收到一个错误

```
OSError: [Errno 2] No such file or directory: 'test\\2000\\1 
```

有人可以提供一些关于这方面的信息吗 谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T13:37:58.837

`str(1)`回报`1`，不是`01`。做`"%02d" % month`。

（并考虑使用`os.path.join`来构建路径字符串。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T13:42:44.767

```
newpath += str(year)+'\\'+str(month) 
```

在每次迭代时将新字符附加到一个相同的字符串，这不是您想要的。

试试这个：

```
root_path = "test"
for year in range(2000, 2013):
    for month in range(1, 13):
        newpath = os.path.join(root_path, '{0:04}'.format(year), '{0:02}'.format(month))
        if not os.path.exists(newpath):
            os.makedirs(newpath) 
```

这`os.path.join`将在您的操作系统上正确构建路径名。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T13:43:14.610

你`newpath`会

```
test2000\12000\22000\32000\42000\52000\62000\72000\82000\92000\102000\112000\122001\12001\22001\32001\42001\52001\62001\72001\82001\92001\102001\112001\122002\12002\22002\32002\42002\52002\62002\72002\82002\92002\102002\112002\122003\12003\22003\32003\42003\52003\62003\72003\82003\92003\102003\112003\122004\12004\22004\32004\42004\52004\62004\72004\82004\92004\102004\112004\122005\12005\22005\32005\42005\52005\62005\72005\82005\92005\102005\112005\122006\12006\22006\32006\42006\52006\62006\72006\82006\92006\102006\112006\122007\12007\22007\32007\42007\52007\62007\72007\82007\92007\102007\112007\122008\12008\22008\32008\42008\52008\62008\72008\82008\92008\102008\112008\122009\12009\22009\32009\42009\52009\62009\72009\82009\92009\102009\112009\122010\12010\22010\32010\42010\52010\62010\72010\82010\92010\102010\112010\122011\12011\22011\32011\42011\52011\62011\72011\82011\92011\102011\112011\122012\12012\22012\32012\42012\52012\62012\72012\82012\92012\102012\112012\12 
```

在你的最后一次迭代中。你不需要附加到`newpath`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T13:44:05.103

您没有`newpath`在循环内重置。这样的事情应该会更好：

```
for year in range(2000, 2013):
    for month in range(1,13):
        newpath = os.path.join("test", str(year), "%02d"%(month,)
        if not os.path.exists(newpath):
            os.makedirs(newpath) 
```

# javascript - 从 Chrome 扩展编程中的内容脚本访问本地存储

> ID：10703174
> 
> 赞同：2
> 
> 时间：2012-05-22T13:35:51.997
> 
> 标签：javascript, google-chrome, google-chrome-extension

我正在尝试开发 Chrome 扩展程序。在其中我有一个选项页面和一个`contentscript.js`都注册在`manifest.js`.

我在`option.js`. 现在我想访问本地存储的数据，`contentscript.js`所以我找到了以下代码来向`background.js`from发送请求`contentscript.js`：

```
chrome.extension.sendRequest({method: "getStatus"}, function(response) {
  console.log(response.status);
}); 
```

并`background.js`使用以下响应：

```
chrome.extension.onRequest.addListener(function(request, sender, sendResponse) {
if (request.method == "getStatus")
       sendResponse({status: localStorage['status']});
else
       sendResponse({}); }); 
```

现在它显示以下错误：

> 在“console.log(response.status);”行中未定义 在文件 contentscript.js 中。

那有什么问题？如何获得整个本地存储访问权限`contentscript.js`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T15:02:49.690

它看起来像工作代码。检查您的清单文件和 localStorage.status

[http://code.google.com/chrome/extensions/messaging.html](http://code.google.com/chrome/extensions/messaging.html) http://code.google.com/chrome/extensions/content_scripts.html

# tridion - 是否可以从 SDL Tridion 2011 功能区中删除“上传 MM 组件”按钮

> ID：10703177
> 
> 赞同：6
> 
> 时间：2012-05-22T13:36:01.507
> 
> 标签：tridion, tridion-2011

这个按钮给我的客户带来了很多问题，因为它总是使用预定义的模式。我找不到使用编辑器配置删除此按钮的方法。我已经用其他按钮做到了这一点，但这些按钮是在某种子组中实现的。

在我的个人沙盒机器上，我尝试在 ../WebUI/Editors/CME/Controls/Toolbars/Tabs/CreateRibbonPage.ascx 文件的提取中删除注释掉的控件，如下所示：

```
<c:RibbonSplitButton runat="server" CommandName="NewComponent" 
   Title="<%$ Resources: Tridion.Web.UI.Strings, NewComponent %>" 
   Label="<%$ Resources: Tridion.Web.UI.Strings, NewComponent %>"
   ID="NewComponentBtn1">
  <c:RibbonContextMenuItem runat="server" ID="NewComponentCMI2" 
     Command="NewComponent" 
     Title="<%$ Resources: Tridion.Web.UI.Strings, NewComponent %>" 
     Label="<%$ Resources: Tridion.Web.UI.Strings, NewComponent %>" />
  <c:RibbonContextMenuItem runat="server" ID="NewMultimediaComponentCMI2" 
     Command="NewMultimediaComponent"  
     Title="<%$ Resources: Tridion.Web.UI.Strings, NewMultimediaComponent %>" 
     Label="<%$ Resources: Tridion.Web.UI.Strings, NewMultimediaComponent %>" />
  <!--
  <c:RibbonUploadContextMenuItem runat="server" 
     ID="NewBasicMultimediaComponentCMI2" Command="NewBasicMultimediaComponent"  
     Title="<%$ Resources: Tridion.Web.UI.Strings, NewBasicMultimediaComponent %>"
     Label="<%$ Resources: Tridion.Web.UI.Strings, NewBasicMultimediaComponent %>" />
  -->
</c:RibbonSplitButton> 
```

这似乎有预期的结果，但我想如果我在客户环境中这样做，这可能会使我们的支持协议无效。这是否可以以受支持的方式进行，还是我必须像这样破解 UI 文件才能实现我的目标？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-23T14:44:29.247

解决方案之一是为`NewBasicMultimediaComponent`命令创建扩展，该扩展为它们扩展`isAvailable`和`isEnabled`方法并返回`false`。在这种情况下，“上传 MM 组件”仍将作为“新建组件”按钮的选项出现，但将被禁用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-22T16:46:35.053

我以前使用 css 来隐藏功能区项目的显示。纯粹是因为我找不到合适的解决方案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-27T14:29:12.353

我添加这个答案是因为我需要使用完整的功能区工具栏做类似的事情。

我需要删除完整的功能区工具栏“创建”以添加它的更简单版本，看来您可以通过创建新扩展并在扩展配置中使用它来完成删除部分：

```
<?xml version="1.0"?>
<Configuration xmlns="http://www.sdltridion.com/2009/GUI/Configuration/Merge" xmlns:cfg="http://www.sdltridion.com/2009/GUI/Configuration" xmlns:ext="http://www.sdltridion.com/2009/GUI/extensions" xmlns:cmenu="http://www.sdltridion.com/2009/GUI/extensions/ContextMenu" xmlns:edt="http://www.sdltridion.com/2009/GUI/Configuration/Merge">
    <resources>
        <cfg:groups />
    </resources>
    <definitionfiles />
    <extensions>
        <ext:editorextensions>
            <ext:editorextension target="CME">
                <ext:editurls />
                <ext:listdefinitions />
                <ext:itemicons />
                <ext:taskbars />
                <ext:commands />
                <ext:commandextensions />
                <ext:contextmenus />
                <ext:lists />
                <ext:tabpages>
                </ext:tabpages>
                <ext:toolbars>
                </ext:toolbars>
                <ext:ribbontoolbars>
                    <ext:remove>
                        <ext:extension id="CreatePage">
                            <ext:apply>
                                <ext:view name="DashboardView">
                                    <ext:control id="DashboardToolbar" />
                                </ext:view>
                            </ext:apply>
                        </ext:extension>
                    </ext:remove>
                </ext:ribbontoolbars>
                <ext:extendedareas />
            </ext:editorextension>
        </ext:editorextensions>
        <ext:dataextenders />
    </extensions>
    <commands />
    <contextmenus />
    <localization />
    <settings>
        <dependencies />
        <defaultpage />
        <editurls />
        <listdefinitions />
        <theme>
            <path>/Themes/</path>
        </theme>
        <customconfiguration />
    </settings>
</Configuration> 
```

要使按钮工作，您可能可以做同样的事情（尚未测试过），方法是在 ext:extension id 属性中提供按钮 id。

# ruby-on-rails - 有没有办法扩展 SASS 预处理器来任意操作每个声明的属性？

> ID：10703178
> 
> 赞同：3
> 
> 时间：2012-05-22T13:36:16.650
> 
> 标签：ruby-on-rails, css, sass

我正在开发一个可嵌入的小部件，它需要将其所有 CSS 属性声明为重要，以防止嵌入页面的 CSS 溢出。这意味着如果我想使用一些预先存在的 CSS 框架（如 Bootstrap），或者一些使用 CSS 样式表的 jQuery 插件，我必须手动将 CSS 复制粘贴到我的资产文件夹中，`!important`并向每个属性添加声明。这似乎是一个相当不可维护且容易出错的过程。

**根据标题，有没有办法扩展 SASS 预处理器以添加`!important`到导入文件或部分文件的任何声明属性？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T06:42:33.883

不，Sass 没有那个功能，因为它是你在 Sass、CSS 或任何其他地方想要做的最不常见的事情。

但是，据我了解，您希望`!important`在特定文件中添加所有 CSS 属性。在这种情况下，您只需执行搜索和替换：搜索`;`并替换为`!important;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-03T02:21:09.617

最明显的解决方案是创建一个新的 mixin，可能会`important`像这样附加单词：

```
%margin-none-important {
    margin: 0 !important;
} 
```

然后在您的代码中：

```
.no-margin {
    @extend %margin-none-important;
} 
```

# ios - Xcode 4 控制台仍然为空

> ID：10703182
> 
> 赞同：1
> 
> 时间：2012-05-22T13:36:23.270
> 
> 标签：ios, xcode, macos

这太愚蠢了。突然，我在 Xcode 4 中的控制台仍然是空的。我发誓，我什么都没做。;) 即使我重新启动 Xcode 或重新启动系统。那是什么呀？

编辑：它不在其他项目中。我一定是设置错了。但是什么？

克里斯

![你看到它正在运行但没有输出](../Images/0c81a5b880d0d879c59ed43fc7ac63aa.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T13:44:45.687

控制台是指输出部分吗？您可以尝试使用只有 NSLog 的小应用程序来查看是否有任何变化？

# php - 如何在 XAMPP 上安装 PHP 库？

> ID：10703188
> 
> 赞同：4
> 
> 时间：2012-05-22T13:36:43.423
> 
> 标签：php, xampp

所以我知道要安装 PHP 库，通常你将它安装在网络服务器上的 /lib/ 文件夹中，但是我在 XAMPP 上找不到 /lib/ 文件夹，我正在尝试在 XAMPP 中安装 Swiftmailer。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-22T13:54:02.960

在 /php/ext 中，您可以删除 php 扩展，记得稍后在 /php/php.ini 中将它们添加到 php.ini 并使用相应的配置。您也可以使用 PECL。在 /php/ext 中，您可以删除 php 扩展，请记住稍后在 /php/php.ini 中使用相应的配置将它们添加到 php.ini。您也可以使用 PECL。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T13:45:13.417

XAMPP 是允许您在 Apache 服务器（也包括 Perl 和 MySQL）上运行 PHP 应用程序的工具堆栈。它不应该*保留*任何类型的库。

我建议您将库保存在项目的文件夹中。
或者在您将添加到 PHP[包含路径的](http://www.php.net/manual/fr/ini.core.php#ini.include-path)*全局*文件夹中。

# c - 保存/复制文件指针/描述符

> ID：10703189
> 
> 赞同：0
> 
> 时间：2012-05-22T13:36:43.640
> 
> 标签：c, file, dup, file-pointer

我有一个要求，其中有一个**全局** `FILE`指针/描述符。其中一个函数将从该指针/描述符中读取。与指针/描述符相关的***内部指针***`FILE`前进。此函数返回后，***我想从相同的`FILE`指针/描述符以及与另一个函数读取的相同数据中读取。***

但是我无法读取相同的确切数据，因为内部指针已经前进。*复制描述符不起作用*，因为复制镜像原始。在读取之前保存`FILE`指针也不起作用，因为它是一个指针，并且将再次开始引用同一事物。

一种替代方法是使用`fgetpos()`before read 和 use `fsetpos()`before next read 保存文件位置。

但这适用于文件指针而不是描述符。

使用普通指针非常容易。`FILE`但是指针会变得很困难。

是否有任何其他*非笨拙*的方法来实现这一目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T13:40:03.917

如果您指的是 POSIX 文件描述符，听起来您正在寻找`lseek()`.

```
off_t off;

off = lseek(fd, 0, SEEK_CUR); /* get current offset */
/* do some read(s) */
lseek(fd, off, SEEK_SET); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T14:50:13.027

根据您的描述，我会将该文件指针隐藏在另一个缓冲最后读取的数据块的接口后面，以便代码的不同区域可以访问相同的数据而无需倒回流。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T13:46:21.757

另一种选择是使用[`mmap()`](http://linux.die.net/man/2/mmap).

这将允许您随机读取文件中的任何位置，而无需使用`lseek()`或`fseek()`。

你会`mmap()`在[linuxquestions找到一个简短的教程](https://www.linuxquestions.org/questions/programming-9/mmap-tutorial-c-c-511265/)

# c# - 限制数据查询，只获取最后 1000 行

> ID：10703196
> 
> 赞同：5
> 
> 时间：2012-05-22T13:37:16.093
> 
> 标签：c#, asp.net, .net, linq, nhibernate

我正在使用 linq 来休眠以从大表中查询数据。我试图限制我的数据查询并只获取最后 1000 行，然后才进行过滤、排序和分页。

当我尝试使用 .Take() 时出现错误：

```
unable to locate HQL query plan in cache; generating (.Count[X4Data.Entity.IEventView](.OrderBy[X4Data.Entity.IEventView,System.DateTime](.Take[X4Data.Entity.IEventView](.Where[X4Data.Entity.IEventView](NHibernate.Linq.NhQueryable`1[X4Data.Entity.IEventView], Quote((x, ) => (Equal(x.DeviceId, p1))), ), p2, ), Quote((c5d4d87c-87ba-4e91-9652-bcdc87e3f0ba, ) => (c5d4d87c-87ba-4e91-9652-bcdc87e3f0ba.AtmTime)), ), )) 
```

我的代码：

```
query = query.Take(rowCount);
query = query.ApplyFiltering(cmd, binder);
query = query.ApplySorting(cmd, binder);
binder.TotalCount = query.Count();
query = query.ApplyPaging(cmd); 
```

非常感谢，对不起我的英语不好

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-22T13:41:31.717

尝试：

```
query.OrderByDescending(criteria).Take(rowCount).OrderBy(criteria) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T13:39:48.853

**你可以使用这个：**

```
list.Skip(Math.Max(0, list.Count() - N)).Take(N); 
```

**例子：**

这里创建了一个包含 9999 个值的 List，并通过**LINQ**选择最后 1000 个值。

```
 List<int> list = new List<int>();
        for (int i = 0; i < 9999; i++)
        {
            list.Add(i);
        }
        int take = 1000;
        var result = list.Skip(Math.Max(0, list.Count() - take)).Take(take); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T14:20:45.230

使用 ICriteria 试试这个：

```
 criteria.SetMaxResults(1000);
    criteria.AddOrder(Order.Desc("ID")); 
```

# sql - 在没有 UI 的情况下获取数据类型

> ID：10703201
> 
> 赞同：1
> 
> 时间：2012-05-22T13:37:28.420
> 
> 标签：sql, tsql, sql-server-2008

是否可以在不点击 UI 的情况下获取列的数据类型？

我希望能够做到...

`SELECT SQLGetTypeInfo(TableName.ColumnName)`

返回`int`

在调试参数化查询时，我需要它来声明我自己的变量。我`SQLGetTypeInfo`在 IBM 的网站上发现，在 SSMS 2008 中不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T13:40:13.890

如果您不想将其称为查询，则可以将其放入过程或函数中：

```
SELECT DATA_TYPE 
from INFORMATION_SCHEMA.COLUMNS
where TABLE_NAME = 'TableName'
and COLUMN_NAME = 'ColumnName' 
```

# lucene - 使用 ravendb/lucene 进行自然语言查询

> ID：10703203
> 
> 赞同：2
> 
> 时间：2012-05-22T13:37:30.263
> 
> 标签：lucene, ravendb

获取 ravendb 中的“动物园”文档列表，每个文档都有一个字段用于建立年份和一个字段用于描述。描述是一个字符串，除其他信息外，还包括该动物园可以看到的许多动物。

(1) 如何获取“黑猩猩和猩猩或“大猿”而不是狐猴的用户搜索值并在动物园中搜索描述。

(2) 除了对 1920 年 10 年内建立的所有动物园外，我如何进行相同的搜索。

(3) 如何进行以下邻近搜索：“黑猩猩猩猩”~3 AND 大象。

就这个问题而言，不要担心动物名称的单数或复数形式。假设它们将是复数。

编辑：我希望以下测试返回零结果，而是返回两个：

```
 public void LuceneANDQuery()
    {
        var zoosToCreate = new List<Zoo>
                               {
                                   new Zoo()
                                       {
                                           Description = "We have alligators, orangutans and chimpanzees",
                                           AbbreviatedState = "DC"
                                       },
                                   new Zoo()
                                       {Description = "We have orangutans and elephants", AbbreviatedState = "CA"}
                               };
        using (var session = documentStore.OpenSession())
        {
            zoosToCreate.ForEach(session.Store);
            session.SaveChanges();
            new DescriptionIndex().Execute(documentStore);
            string searchPhrase = @"lizards && orangutans";
            var matchingZoos = session.Advanced.LuceneQuery<Zoo>("DescriptionIndex").Search("Description", searchPhrase).
                WaitForNonStaleResultsAsOfNow().ToList();
            int matchingZoosCount = matchingZoos.Count;
            Assert.AreEqual(matchingZoosCount, 0);
        }
    }

    public class DescriptionIndex : AbstractIndexCreationTask<Zoo>
    {
        public DescriptionIndex()
        {
            Map = zoos => from zoo in zoos
                          select new {zoo.Description};
            Analyzers.Add(z => z.Description, "Lucene.Net.Analysis.Standard.StandardAnalyzer");
            Indexes.Add(z => z.Description, FieldIndexing.Analyzed);
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T20:07:34.970

Balazs，你可以直接运行这个查询。RavenDB 在后台使用 Lucene，并将其查询向外暴露。这意味着您可以只运行这样的查询。这在 API 中使用 Session.Advanced.LuceneQuery 公开。

需要注意的一点是，我们不支持默认字段，因此您需要指定您的意思的字段，但仅此而已。

# .htaccess - 在 SYMFONY 中仅使用 HTACCESS 强制 HTTPS

> ID：10703206
> 
> 赞同：4
> 
> 时间：2012-05-22T13:37:47.773
> 
> 标签：.htaccess, symfony1, https, symfony-1.4

我们有一个 Symfony 1.4 项目，并希望仅使用 htaccess 文件对 symfony 应用程序中的所有页面强制使用 HTTPS。我知道有一些方法可以使用过滤器，但我想知道是否可以先不使用它？

这是我目前正在使用但没有按预期工作的 .HTACCESS 文件...

```
RewriteEngine On
RewriteCond %{HTTPS} !=on
RewriteRule .* https://%{SERVER_NAME}%{REQUEST_URI} [R,L]
RewriteCond %{REQUEST_FILENAME} !-f 
```

我也试过没有成功：

```
RewriteCond %{SERVER_PORT} !^443$
RewriteCond %{HTTPS} !=on
RewriteRule ^.*$ https://%{SERVER_NAME}%{REQUEST_URI} [R,L] 
```

我确信在使用 Symfony 执行此操作时我缺少一些怪癖，因为这是一项容易立即完成的任务。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T13:49:18.017

关于[以前的答案](https://stackoverflow.com/a/5880655/569101)，请尝试：

```
RewriteCond %{SERVER_PORT} !^443$
RewriteRule .? https://%{HTTP_HOST}%{REQUEST_URI} [R,L] 
```

# jquery - Ajax，Jquery，使用 $.ajax 调用过程

> ID：10703207
> 
> 赞同：-1
> 
> 时间：2012-05-22T13:37:49.003
> 
> 标签：jquery, ajax

我在 Jquery 上有一个点击事件，我在 $.ajax 的帮助下获取数组并发布，之后我在循环中调用另一个过程。第二个程序也有一个 $.ajax，是否允许？我的脚本似乎不起作用，我不知道会出现什么问题？请给我任何提示或线索并随时提出任何问题

代码 ：

```
$("#list").click(function(){                  
   var ptext ="";
   $.ajax({
   type: "POST",
   url: "phpname.php",
   data: ({
   newtask: "grab"
    }),
   dataType: "json",
   success: function(data){
   $.each(data, function(key, value) {
   ptext=value.name;    
   parseclick(ptext);   
   });
   }    
   });  
 });    
  });

function parseclick(ptext)
 {
    $.ajax({
   type: "POST",
   url: "phpname.php",
   data: ({
          grab_ads : "grab",
          list_url : ptext

          }),
   dataType: "html",
   success: function(msg){

     $("#all_name").append(msg);
     var part= msg.split("#url#");  
     $("#current_num").val(part[0]);
       }    
         });        
                                  }); 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T13:48:55.100

是的，这是允许的。但是，如果您在第二个程序中进行 Ajax 调用而没有将 asynchronously 选项设置为 false，则循环将同时创建一堆 Ajax 调用，而无需等待服务器的响应。

编辑：添加示例后，我可以看到太多的右括号。

# sharepoint-2010 - sharepoint 2010 的高级表格

> ID：10703208
> 
> 赞同：0
> 
> 时间：2012-05-22T13:37:49.663
> 
> 标签：sharepoint-2010, sharepoint-designer, infopath2010

因此，我是使用 sharepoint 2010 的 Sharepoint 新手，我需要创建一个高级表单，例如使用两个或多个下拉列表类型或使用 javascript 的级联下拉列表。

我读到有 3 种方法可以做到这一点：共享点设计器、信息路径和视觉工作室。

我知道如何在视觉工作室中做到这一点可能有点复杂。

所以我想知道哪一个是这个表格的最佳方法，以及你是否有一些书或类似的东西来学习如何做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T13:49:12.460

Like most complex frameworks, SharePoint development is something you will want to do some research on before you just start attempting to sling code.

Getting started video: [http://msdn.microsoft.com/en-us/sharepoint/ee513147.aspx](http://msdn.microsoft.com/en-us/sharepoint/ee513147.aspx)

MSDN Mag getting started article: [http://msdn.microsoft.com/en-us/magazine/ee309510.aspx](http://msdn.microsoft.com/en-us/magazine/ee309510.aspx)

Book to get you started: [http://www.amazon.com/Professional-SharePoint-2010-Development-Programmer/dp/0470529423](https://rads.stackoverflow.com/amzn/click/com/0470529423)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T16:23:50.427

您很幸运，因为 InfoPath 2010 可以处理级联查找。我以前自己做过。我将假设您具有数据的层次关系，其中 A 是 B 的父级，是 C 的父级，例如州 -> 县 -> 市。我们将使用州 -> 县 -> 市示例。这些信息将存储在一个办公室列表中，因为我们需要了解我们办公室的每一件事（是的，这是一个延伸，在这里和我一起工作）。

首先，因为这也被标记为 SharePoint，我假设您有一个州、县和城市列表。County 有一个查找 State 列表的字段，City 查找 County。这些列表中的每一个都有一个名称字段。没有任何逻辑，我可以选择洛杉矶，但我仍然可以选择阿拉巴马州作为州，奥兰治作为县。

因此，要使这一切正常工作。首先，在 Office 列表中的 SharePoint 中选择“在 InfoPath 中自定义表单”，这将启动 InfoPath Designer 并创建默认布局。根据您的意愿自定义此表单的布局。

现在，要让级联下拉菜单正常工作，您需要记下一些事情。每个下拉列表中存储的值是项目的 ID。显示的值是您在 Office 列表上创建查找时选择显示的值。

您需要在顶级（州）上设置规则，以便在更改字段时将较低级别（县和市）设置为空白值。重复县；它必须将 City 设置为空白。这确保如果您选择一个新的州（或县），较低的级别将被刷新。

下一步是过滤数据。过滤县下拉列表，使县上的州列等于表单中的州字段。对 City 重复此操作，以使 County 列等于表单中 County 下拉列表的值。

您可能需要为县和市创建另一个 Web 服务，因为默认的 Web 服务可能没有州或县列。如果需要，只需选择您需要的字段以减少传输的数据。为了节省更多数据，您可能还需要设置它，以便在顶层更改时在较低级别查询数据；这将是变更规则的第一步。顶层（状态）仍然需要在表单加载时加载，但其他级别不需要自动加载。这样你就不会一次加载所有数据。如果您有很多项目，这可能是必需的，因为 InfoPath 默认具有 1.5MB 的数据加载限制。

如果您需要更多说明，请告诉我。

# javascript - 在 webgl 中制作 2d HUD 的推荐方法

> ID：10703212
> 
> 赞同：29
> 
> 时间：2012-05-22T13:37:56.280
> 
> 标签：javascript, performance, html, webgl

对于 fps 性能很重要的 webgl 游戏，制作 2D HUD 的最有效方法是什么？我可以想到 3 个选项，但我不清楚每个选项的性能成本是多少，哪些是最有效的。

那么以下 3 个选项之间的相对性能成本是多少：

A：使用正交相机在 3D 中渲染带有多边形的 hud，并混合原始场景。优点是可以实现高级的 opengl 效果，代价是手动排列容器。

B：在html/css中构建HUD，让浏览器进行合成。在这种情况下，浏览器组合是否会对性能产生很大影响？

C：在 3D 画布上绘制 2D 画布，让浏览器进行合成。这甚至可能吗？我是否会遇到画布之间的事件传播问题，例如鼠标事件和焦点。

非常感谢！

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-05-22T17:51:19.153

***从技术上讲，***选项 A**可能是最快的，但它会带来一系列您需要手动处理的其他问题。如果您要更新文本（健康、弹药等），您将不得不提出一个文本渲染例程，至少可以说这些都不是微不足道的。如果您通过鼠标或键盘与 UI 进行交互，您将需要自己处理，并且您足够强大和有效地执行此操作以实际产生比本机浏览器小部件更好的体验的机会很小。重点是，要使速度更快一些，需要做很多工作。**

 ****在我看来，**选项 B是可行的方法。**浏览器非常擅长合成，即使因为它会产生性能影响，除非你正在做一个非常疯狂的详细 HUD，我猜想与你应用程序的其他部分（如 JS 逻辑）相比，这种影响可以忽略不计。另外，随着时间的推移，这条路线应该会“神奇地”变得更好，并且浏览器会变得更有效率。IMO 最大的缺点是，如果您使用一些最新最好的 CSS 效果来按照您想要的方式设置 HUD 样式，您可能会遇到一些渲染错误，但随着时间的推移，这种情况应该会消失。**

 ****据我所知，选项 C**在单个画布中是不可能的。您可以在 3D 画布上叠加一个单独的 2D 画布并将 HUD 绘制到上面，但此时您继承了 A 和 B 的所有问题而没有任何好处。我看不出有什么好的理由推荐它。

我认为 WebGL 相对于许多原生 3D 平台的一大优势是它可以轻松访问地球上使用最广泛、最灵活的 UI 框架之一 (HTML)。忽视这一优势将是一项巨大的努力，几乎没有什么切实的好处。使用您可用的工具，不要因此而过多地担心丢失的毫秒数。我向您保证，您在开发游戏时将面临更大的问题，您的时间和精力会花在上面比尝试重新发明这个特定的轮子要好得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-12-14T20:38:49.247

虽然我同意选项 B 在大多数情况下是首选，但选项 C 是可能的，并且可能需要用于 WebVR 中的 HUD（除非您想使用类似[DOM2AFrame](https://github.com/rmarx/DOM2AFrame)的东西将 DOM 渲染为纹理）。

我找到[了这篇](https://www.evermade.fi/story/pure-three-js-hud/)关于如何使用 Three.js 实现选项 C 的博客。它在原始场景之上为 HUD 创建一个单独的场景，并使用 2D 画布生成 HUD 纹理。这是一个带有示例的[Codepen 链接](https://codepen.io/sjcobb/pen/XWjMdXb)，请参见第 57-78 行，开头为：

```
var hudCanvas = document.createElement('canvas')
hudCanvas.width = width
hudCanvas.height = height
var hudBitmap = hudCanvas.getContext('2d') 
```

Aframe 还具有可以使用的预构建 UI 组件，请参见[ex。1](https://github.com/rdub80/aframe-gui)，[例如。2](https://github.com/caseyyee/aframe-ui-widgets)****

# safari-extension - Safari 无法安装此扩展程序

> ID：10703219
> 
> 赞同：2
> 
> 时间：2012-05-22T13:38:13.563
> 
> 标签：safari-extension

嗨，朋友们，我开发了一个 safari 扩展并且也能够构建它。但是当我尝试安装它时，会出现以下错误：“Safari 无法安装此扩展程序。安装此扩展程序时发生错误”我有一个有效的 safari 开发人员证书，它已安装在我的机器上。这是一个简单的 helloworld 扩展，仅此而已。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T08:48:20.203

嗨朋友我找到了解决方案。私下我的开发文件夹名称是*MySafaraiExtension*所以它无法安装，解决方案是你必须将你的开发文件夹命名为*MySafariExtension.safariextension*。

# ios - iPhone 应用程序无法在模拟器中运行

> ID：10703222
> 
> 赞同：2
> 
> 时间：2012-05-22T13:38:21.033
> 
> 标签：ios, xcode, ios-simulator

我刚刚从另一个人那里继承了一个 Xcode 项目，由于某种原因，我似乎无法在模拟器中运行它。

有没有其他人有这个问题？有没有人对如何解决这个问题有任何想法？

![没有模拟器](../Images/5e8f541ffc3fe942792763ef21dabfa9.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T13:40:34.033

可能该项目的“部署目标”设置高于您安装的 SDK 版本 - 尝试将其更改为 Mac 支持的较低版本（或将您的 xcode 升级到较新版本）

# sql - ORA-00936: 缺少表达式

> ID：10703225
> 
> 赞同：0
> 
> 时间：2012-05-22T13:38:32.257
> 
> 标签：sql, oracle

你能帮我知道我的 sql 中可能出现的错误吗？ORA-00936：我缺少表达式错误，但我找不到错误。

```
CREATE TYPE T_ordRef AS OBJECT (
   Ordi REF T_Ordinateur
);
CREATE TYPE T_ordRefs AS TABLE OF REF T_ordRef ;

INSERT INTO THE (SELECT INSTALLESUR FROM LOGICIEL WHERE NUMERO='1')
VALUES (T_ORDREFS( T_ORDREF(SELECT REF(v) 
FROM ORDINATEUR v WHERE v.NUMSERIE='1') )); 
```

错误：

> Erreur à la ligne de commande : 81, Colonne : 34 Rapport d'erreur : Erreur SQL : ORA-00936: 缺少表达式 00936\. 00000 - “缺少表达式” *原因：
> *操作：

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T13:41:56.713

您在创建类型的行之后缺少 / ：

```
CREATE TYPE T_ordRef AS OBJECT ( Ordi REF T_Ordinateur );
/  -- important!

CREATE TYPE T_ordRefs AS TABLE OF REF T_ordRef ;
/  -- important! 
```

此外，您`insert into`是完全错误的，因为您不允许在为列名保留的部分中进行选择。
不幸的是，我无法纠正它，因为我什至不明白它应该做什么。

# clearcase - 获取特定时间的所有版本 - ClearCase UCM

> ID：10703227
> 
> 赞同：2
> 
> 时间：2012-05-22T13:38:43.660
> 
> 标签：clearcase, clearcase-ucm

我们正在使用 ClearCase UCM，有人问我是否有办法从特定时间获取所有版本。

示例：正在开发流中进行工作。有人破坏了构建，但之前的基线太远了，我们会失去太多的工作。他们想获得从上周四上午 11:00 开始的每个文件的版本。

这可能吗，即使在那个特定时间还没有建立基线？有没有办法恢复到那个特定的时间？

（我搜索了一个类似的主题，但其中大多数是“自……以来创建的版本”）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T14:03:21.480

“created_since”是关于查找类似于“[在 Clearcase 视图中查找比特定日期更新的文件？](https://stackoverflow.com/questions/7676263/find-files-in-clearcase-view-newer-than-a-specific-date/7676484#7676484) ”的查询。

但是在您的情况下，使用特定的配置规范**[基于时间的选择规则](https://stackoverflow.com/a/635282/6309)**来定义动态视图会更容易：

```
element /myPath/... .../StreamName/{!created_since(16-Sep-2009)}
element /myPath/... /main/{!created_since(16-Sep-2009)}
element /myPath/... /main/LATEST 
```

所以这将是一个简单的 base-ClearCase 动态视图（在摆弄配置规范时更容易测试：没有文件可以像在快照视图中那样加载）。
这些文件当前由 UCM 组件中的 UCM 视图管理这一事实并不排除使用基本 ClearCase 视图。

我们的想法是在正确的日期寻找版本：

*   首先在`StreamName`分支中（如果这些文件已被签出）
*   如果没有，在`main`分支中

**[从那里，如果您想“恢复”到当前 UCM 视图中的该内容，使用clearfsimport](https://stackoverflow.com/questions/138321/how-can-i-use-clearcase-to-add-to-source-control-recursively/144310#144310)**重新导入所有内容的最简单方法（`-rmname`以实现完全相同的内容）。
创建一个专门用于“重新导入”的 UCM 活动，以注册所有受影响的文件。

# powershell - 从 powershell 中的文本文件中读取多个值，然后操作这些值

> ID：10703231
> 
> 赞同：1
> 
> 时间：2012-05-22T13:39:06.120
> 
> 标签：powershell

原谅新手的问题，我是 powershell 的新手，我正在尝试做一些应该很容易的事情！

我有一个包含以下内容的文本文件

```
DEVICE ID:   {E24CF707-F030-48DC-8E1A-59B96148BF52}
DEVICE NAME: All Devices (RAINBOW-SRV)
TYPE:        Drive pool
DEVICE ID:   {D16DC75F-8A8B-4AEC-A411-9B0BC58CBF16}
DEVICE NAME: HP 1
TYPE:        Drive
DEVICE ID:   {F2D2AB4A-1FBE-4158-AB62-6A94AE4392E2}
DEVICE NAME: RAINBOW-SRV
TYPE:        Machine
DEVICE ID:   {23AD5D42-00A8-496B-96E5-1F5CAA3F9E9D}
DEVICE NAME: Symantec Protection Network (RAINBOW-SRV)
TYPE:        Symantec Protection Network
RETURN VALUE: 1 
```

我正在尝试将 DEVICE NAME: 后面的字符串在每次出现时放入一个数组中，以传递给下一行的命令。我尝试了以下代码，但收到一条错误消息，指出 Substring 不是有效的方法。

我觉得我错过了一些非常明显但看不到的东西！任何帮助将非常感激。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T13:47:01.690

读取文件内容，过滤以'DEVICE NAME:'开头的行，对于每一行删除（替换为空）'DEVICE NAME:'

```
Get-Content devices.txt | Where-Object {$_ -like 'DEVICE NAME:* '} | Foreach-Object {$_ -repla
ce '^DEVICE NAME: '}

All Devices (RAINBOW-SRV)
HP 1
RAINBOW-SRV
Symantec Protection Network (RAINBOW-SRV) 
```

更新：根据 OT 请求，如何将值传递给可执行命令

```
Get-Content devices.txt | 
Where-Object {$_ -like 'DEVICE NAME:* '} | 
Foreach-Object {
    $device = $_ -replace '^DEVICE NAME: '
    app.exe "$device"
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T14:10:15.483

另一种解决方案：

```
$list = @((get-content devices.txt) | where { $_ -match "DEVICE NAME:\s*(?<Device>.+)\s*" } | %{ $matches["Device"] })

$list 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-18T02:40:13.553

另一个解决方案：

```
Get-Content -Path .\devices.txt |
    Select-String 'DEVICE NAME: ' |
        Foreach-Object {
            $_.ToString() -replace '^DEVICE NAME: ','app.exe '
        } 
```

# functional-programming - 为什么引发异常会产生副作用？

> ID：10703232
> 
> 赞同：50
> 
> 时间：2012-05-22T13:39:06.697
> 
> 标签：functional-programming, side-effects

根据副作用的维基百科条目[，](http://en.wikipedia.org/wiki/Side_effect_%28computer_science%29)引发异常构成副作用。考虑这个简单的python函数：

```
def foo(arg):
    if not arg:
        raise ValueError('arg cannot be None')
    else:
        return 10 
```

调用它`foo(None)`总是会遇到异常。一样的输入，一样的输出。它是参照透明的。为什么这不是纯函数？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-05-23T12:35:27.353

只有当您观察到异常并根据它做出改变控制流的决定时，才会违反纯度。实际上抛出异常值是引用透明的——它在语义上等同于非终止或其他所谓的[底值。](http://www.haskell.org/haskellwiki/Bottom)

如果（纯）函数不是[total](http://en.wikipedia.org/wiki/Partial_function#Total_function)，则它的计算结果为底部值。如何编码底部值取决于实现——它可能是一个例外；或不终止，或除以零，或其他一些故障。

考虑纯函数：

```
 f :: Int -> Int
 f 0 = 1
 f 1 = 2 
```

这不是为所有输入定义的。对于某些人来说，它评估为底部。实现通过抛出异常对此进行编码。它在语义上应该等同于使用`Maybe`or`Option`类型。

*现在，只有在观察*底部值并根据它做出决策时才会破坏引用透明度——这可能会引入不确定性，因为可能会抛出许多不同的异常，而你不知道是哪一个。因此，出于这个原因，捕获异常是在`IO`Haskell 的 monad 中，而生成所谓的[“不精确”异常](http://research.microsoft.com/en-us/um/people/simonpj/papers/imprecise-exn.htm)可以纯粹地完成。

因此，引发异常本身就是一种副作用是不正确的。问题在于您是否可以基于异常值修改纯函数的行为——从而破坏引用透明度——这就是问题所在。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-05-22T13:43:39.680

从第一行开始：

> “在计算机科学中，如果一个函数或表达式除了返回一个值之外，它还修改了某些状态或与调用函数或外部世界有可观察的交互，则称其具有副作用”

它修改的状态是程序的终止。回答您关于为什么它不是纯函数的其他问题。该函数不是纯函数，因为抛出异常会终止程序，因此它具有副作用（您的程序结束）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-22T13:43:55.103

引用透明性也是用计算本身的结果替换计算（例如函数调用）的可能性，如果您的函数引发异常，您就无法做到这一点。那是因为异常不参与计算，但它们需要被捕获！

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-08-15T22:07:33.073

我意识到这是一个老问题，但这里的答案并不完全正确，恕我直言。

*引用透明性*是指表达式具有的属性，如果它所属的程序在表达式被其结果替换时具有完全相同的含义。应该清楚的是，抛出异常违反了*引用透明性*，因此会产生*副作用*。让我证明为什么...

我在这个例子中使用了*Scala*。考虑以下函数，它接受一个整数参数 ，`i`并向其添加一个整数值`j`，然后将结果作为整数返回。如果在添加两个值时发生异常，则返回值 0。唉，计算`j`' 的值会导致抛出异常（为简单起见，我已将`j`' 的初始化表达式替换为生成的异常）。

```
def someCalculation(i: Int): Int = {
  val j: Int = throw new RuntimeException("Something went wrong...")
  try {
    i + j
  }
  catch {
    case e: Exception => 0 // Return 0 if we catch any exception.
  }
} 
```

好的。这有点愚蠢，但我试图用一个非常简单的案例来证明这一点。;-)

*让我们在Scala REPL*中定义并调用这个函数，看看我们得到了什么：

```
$ scala
Welcome to Scala 2.13.0 (OpenJDK 64-Bit Server VM, Java 11.0.4).
Type in expressions for evaluation. Or try :help.

scala> :paste
// Entering paste mode (ctrl-D to finish)

def someCalculation(i: Int): Int = {
  val j: Int = throw new RuntimeException("Something went wrong...")
  try {
    i + j
  }
  catch {
    case e: Exception => 0 // Return 0 if we catch any exception.
  }
}

// Exiting paste mode, now interpreting.

someCalculation: (i: Int)Int

scala> someCalculation(8)
java.lang.RuntimeException: Something went wrong...
  at .someCalculation(<console>:2)
  ... 28 elided 
```

好的，很明显，发生了异常。那里没有惊喜。

但是请记住，如果我们可以将表达式替换为它的结果以使程序具有完全相同的含义，则表达式是*引用透明的。*在这种情况下，我们关注的表达式是`j`。让我们重构函数并`j`用它的结果替换（必须将抛出的异常的类型声明为整数，因为那是`j`'s 类型）：

```
def someCalculation(i: Int): Int = {
  try {
    i + ((throw new RuntimeException("Something went wrong...")): Int)
  }
  catch {
    case e: Exception => 0 // Return 0 if we catch any exception.
  }
} 
```

*现在让我们在REPL*中重新评估它：

```
scala> :paste
// Entering paste mode (ctrl-D to finish)

def someCalculation(i: Int): Int = {
  try {
    i + ((throw new RuntimeException("Something went wrong...")): Int)
  }
  catch {
    case e: Exception => 0 // Return 0 if we catch any exception.
  }
}

// Exiting paste mode, now interpreting.

someCalculation: (i: Int)Int

scala> someCalculation(8)
res1: Int = 0 
```

好吧，我想你可能已经看到了：那次我们得到了不同的结果。

如果我们计算`j`然后尝试在一个`try`块中使用它，那么程序会抛出一个异常。但是，如果我们只是`j`在块中用它的值替换，我们得到一个 0。所以抛出异常显然违反了*引用透明性*。

我们应该如何以*功能性*的方式进行？通过不抛出异常。在*Scala*中（在其他语言中有等价物），一种解决方案是将可能失败的结果包装在`Try[T]`类型中：如果成功，则结果将是`Success[T]`包装成功的结果；如果发生故障，则结果将是`Failure[Throwable]`包含相关异常的；这两个表达式都是`Try[T]`.

```
import scala.util.{Failure, Try}

def someCalculation(i: Int): Try[Int] = {
  val j: Try[Int] = Failure(new RuntimeException("Something went wrong..."))

  // Honoring the initial function, if adding i and j results in an exception, the
  // result is 0, wrapped in a Success. But if we get an error calculating j, then we
  // pass the failure back.
  j.map {validJ =>
    try {
      i + validJ
    }
    catch {
      case e: Exception => 0 // Result of exception when adding i and a valid j.
    }
  }
} 
```

注意：我们仍然*使用*异常，只是不*抛出*异常。

让我们在*REPL*中试试这个：

```
scala> :paste
// Entering paste mode (ctrl-D to finish)

import scala.util.{Failure, Try}

def someCalculation(i: Int): Try[Int] = {
  val j: Try[Int] = Failure(new RuntimeException("Something went wrong..."))

  // Honoring the initial function, if adding i and j results in an exception, the
  // result is 0, wrapped in a Success. But if we get an error calculating j, then we
  // pass the failure back.
  j.map {validJ =>
    try {
      i + validJ
    }
    catch {
      case e: Exception => 0 // Result of exception when adding i and a valid j.
    }
  }
}

// Exiting paste mode, now interpreting.

import scala.util.{Failure, Try}
someCalculation: (i: Int)scala.util.Try[Int]

scala> someCalculation(8)
res2: scala.util.Try[Int] = Failure(java.lang.RuntimeException: Something went wrong...) 
```

这一次，如果我们`j`用它的值替换，我们会得到完全相同的结果，而且在所有情况下都是如此。

但是，对此还有另一种看法：如果在计算 的值时抛出异常的原因`j`是由于我们的一些错误编程（*逻辑错误*），那么抛出异常——这将导致程序终止——可能被认为是引起我们注意的一种极好的方法。但是，如果异常是由于我们无法直接控制的情况（例如整数加法溢出的结果），并且我们应该能够从这种情况中恢复，那么我们应该将这种可能性形式化为函数返回的一部分值，并使用但不抛出异常。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-05-12T06:34:39.447

引发异常可以是纯的或非纯的，它仅取决于引发的异常类型。一个好的经验法则是，如果异常是由代码引发的，它是纯的，但如果它是由硬件引发的，那么它通常必须被归类为非纯的。

这可以通过查看硬件引发异常时发生的情况来看出：首先引发中断信号，然后中断处理程序开始执行。这里的问题是中断处理程序不是您的函数的参数，也不是在您的函数中指定的，而是一个全局变量。任何时候读取或写入全局变量（又名状态），您就不再拥有纯函数。

将其与代码中引发的异常进行比较：您从一组已知的、本地范围的参数或常量构造 Exception 值，然后“抛出”结果。没有使用全局变量。抛出异常的过程本质上是您的语言提供的语法糖，它不会引入任何非确定性或非纯行为。正如 Don 所说的“它在语义上应该等同于使用 Maybe 或 Option 类型”，这意味着它也应该具有所有相同的属性，包括纯度。

当我说引发硬件异常“通常”被归类为副作用时，并不总是如此。例如，如果运行您的代码的计算机在引发异常时没有调用中断，而是将一个特殊值压入堆栈，那么它就不能归类为非纯的。我相信 IEEE 浮点 NAN 错误是使用特殊值而不是中断引发的，因此在进行浮点数学运算时引发的任何异常都可以归类为无副作用，因为该值不是从任何全局状态读取的，而是编码到 FPU 中的常量。

查看所有要求一个片段代码是纯的，基于代码的异常和 throw 语句语法糖勾选所有框，它们不修改任何状态，它们与调用函数或调用之外的任何东西没有任何交互，并且它们在引用上是透明的，但只有在编译器使用您的代码时才会这样做。

像所有纯与非纯讨论一样，我排除了执行时间或内存操作的任何概念，并在假设可以纯粹实现的任何功能都是纯粹实现而不管其实际实现如何。我也没有 IEEE 浮点 NAN 异常声明的证据。

# nhibernate - NHibernate LINQ Query - 对象引用未保存的瞬态实例 - 不保存

> ID：10703233
> 
> 赞同：2
> 
> 时间：2012-05-22T13:39:08.667
> 
> 标签：nhibernate, linq-to-nhibernate

当我执行 nHibernate LINQ 查询时，我遇到了一个奇怪的异常。如果我写
`var address = new Address {Id = Guid.Empty}; session.Query().Where(x=> x == address).ToList();`

比我得到

> 对象引用未保存的瞬态实例 - 在刷新之前保存瞬态实例或将属性的级联操作设置为使其自动保存的内容。类型：DomainModel.Address，实体：DomainModel.Address
> 
> 在 NHibernate.Engine.ForeignKeys.GetEntityIdentifierIfNotUnsaved(String entityName, Object entity, ISessionImplementor session) 在 NHibernate.Type.EntityType.GetIdentifier(Object value, ISessionImplementor session) 在 NHibernate.Type.ManyToOneType.NullSafeSet(IDbCommand cmd, Object value, Int32 index , ISessionImplementor session) 在 NHibernate.Param.NamedParameterSpecification.Bind(IDbCommand command, IList `1 multiSqlQueryParametersList, Int32 singleSqlParametersOffset, IList`1 sqlQueryParametersList, QueryParameters queryParameters, ISessionImplementor session) 在 NHibernate.Param.NamedParameterSpecification.Bind(IDbCommand command, IList`1 sqlQueryParametersList, QueryParameters queryParameters, ISessionImplementor session) at NHibernate.SqlCommand.SqlCommandImpl.Bind(IDbCommand command, ISessionImplementor session) at NHibernate.Loader.Loader.PrepareQueryCommand(QueryParameters queryParameters, Boolean scroll, ISessionImplementor session) at NHibernate.Loader.Loader.DoQuery(ISessionImplementor session, QueryParameters queryParameters, Boolean returnProxies) at NHibernate.Loader.Loader.DoQueryAndInitializeNonLazyCollections(ISessionImplementor session, QueryParameters queryParameters, Boolean returnProxies) at NHibernate.Loader.Loader.DoList(ISessionImplementor session, QueryParameters queryParameters) at NHibernate.Loader.Loader.ListIgnoreQueryCache(ISessionImplementor session, QueryParameters queryParameters) at NHibernate.Loader.Loader.List(ISessionImplementor session, QueryParameters queryParameters, ISet`1 NHibernate.Hql.Ast.ANTLR.QueryTranslatorImpl.List(ISessionImplementor session, QueryParameters queryParameters) 在 NHibernate.Hql.Ast.ANTLR.QueryTranslatorImpl.List(ISessionImplementor session, QueryParameters queryParameters) 在 NHibernate.Hql.Ast.ANTLR.Loader.QueryLoader.List(ISessionImplementor session, QueryParameters queryParameters) 1 querySpaces, IType[] resultTypes) .Engine.Query.HQLQueryPlan.PerformList(QueryParameters queryParameters, ISessionImplementor session, IList results) at NHibernate.Impl.SessionImpl.List(IQueryExpression queryExpression, QueryParameters queryParameters, IList results) at NHibernate.Impl.AbstractSessionImpl.List(IQueryExpression queryExpression, QueryParameters parameters ) 在 NHibernate.Impl.ExpressionQueryImpl.List() 在 NHibernate.Linq.DefaultQueryProvider.ExecuteQuery(NhLinqExpression nhLinqExpression, IQuery 查询, NhLinqExpression nhQuery) 在 NHibernate。Linq.DefaultQueryProvider.Execute（表达式表达式）
> 在 NHibernate.Linq.DefaultQueryProvider.Execute[TResult]（表达式表达式）在 Remotion.Linq.QueryableBase `1.GetEnumerator() at System.Linq.Buffer`1..ctor（IEnumerable `1 source) at System.Linq.Enumerable.ToArray[TSource](IEnumerable`1 源）

但是，如果我写
`var person = new Person {Id = Guid.Empty}; session.Query().Where(x=> x == person).ToList();`

一切正常。这两个类和相关映射的唯一区别是Address使用<class />标签进行映射，而Person属于继承映射，Party => Person使用<joined-subclass />进行映射

我知道我可以使用键字段而不是对象来重写查询，但这只是问题的一个真正简化的版本，这个解决方案不适用。

对这种行为有任何想法吗？

谢谢，马可

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T13:48:35.277

看看 QBE（按示例查询）：

*   [NHibernate：通过示例查询主键会产生“WHERE (1=1)”](https://stackoverflow.com/questions/424699/nhibernate-query-by-example-on-primary-key-produces-where-1-1)
*   [使用 NHibernate Query-By-Example 混合喜欢和等于？](https://stackoverflow.com/questions/7840773/mixing-likes-and-equals-with-nhibernate-query-by-example)

# php - 在节点中使用 DomDocument 换行

> ID：10703238
> 
> 赞同：0
> 
> 时间：2012-05-22T13:39:33.017
> 
> 标签：php, xml, domdocument, line-breaks

我正在用 php 中的 DOMDocument 类创建一个 xml 文件。我想为我的地址创建一个块节点，如下所示：

```
<Address>CompanyName
Street
Place</Address> 
```

我必须像这样创建地址字段，因为 xml 是由其他人导入的。

我已经尝试过“\n”、“cdata”、“< br >”，但它也被打印出来了。有没有办法在 xml 中使用 DOMDocument 进行换行而不需要任何额外的文本？

或者是否有其他更好的方法来做到这一点？（XMLWriter？）

对不起我的英语:) 谢谢你的帮助

编辑：如果我在Firefox中打开它，它看起来像这样：

![](../Images/6ac2df7db01e6674c18ee64a166847f8.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:09:44.800

它实际上工作得很好。在您的 Internet Explorer 中，右键单击该页面，然后单击“查看源代码”。新线路就在那里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T14:23:11.797

为了指定换行符是否应该被规范化或保留，您必须相应地设置 preserveWhiteSpace 选项：

[http://www.php.net/manual/de/class.domdocument.php#domdocument.props.preservewhitespace](http://www.php.net/manual/de/class.domdocument.php#domdocument.props.preservewhitespace)

# java - 如何使 Swing 组件变黑？

> ID：10703255
> 
> 赞同：4
> 
> 时间：2012-05-22T13:40:35.360
> 
> 标签：java, swing

嗨，有一个要求，在某些情况下，我必须将摆动组件（文本字段）涂黑，以保留其字符串值。即组件不应该显示它持有的字符串值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T13:47:43.530

有`JPasswordField`, 这是一个文本字段，可以切换以显示*** * （或其他一些回显字符）而不是实际内容。这可能是最简单的方法。

如果这还不够好，您可以拉出内容并将其存储在外部，空白或印迹或任何字段，并`setEnabled(false)`在其上。当您再次启用该字段时，将内容放回原处。如果有必要同时使用`getText()`，您必须覆盖它，以便在适当的时候替换存储的内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-22T13:49:20.307

You could use the [JLayer Component](http://docs.oracle.com/javase/tutorial/uiswing/misc/jlayer.html):

![An example of gradient in front of JPanel](../Images/846f62950e6cffc1e075f07764543604.png)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-22T13:46:50.420

使整个文本黑色调用

```
textfield.setForeground(new Color(0,0,0,0))
textfield.setBackground(Color.BLACK)
textfield.setOpaque(true) 
```

以防止他们选择文本呼叫

```
textfield.setFocusable(false) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-22T13:58:12.570

可能最简单的方法是从其容器中删除组件并用相同类型的虚拟组件替换它。这可以通过创建您自己的组件来很好地封装，该组件封装交换组件（骨架）：

```
public class BlackOutTextField extends JPanel {

    private final JTextField realField = new JTextField();
    private final JTextField dummyField = new JTextField();
    private boolean isBlackedOut;

    {
        dummyField.setEditable(false);
        setLayout(new BorderLayout());
        add(realField, BorderLayout.CENTER);
    }

    public String getText() {
        return isBlackedOut ? "" : realField.getText();
    }

    public void setText(final String text) {
        if (!isBlackedOut)
            realField.setText(text);
    }

    public void setBlackedOut(final boolean blackedOut) {
         if (this.isBlackedOut != blackedOut) {
             this.isBlackedOut = blackedOut;
             removeAll();
             add(this.isBlackedOut ? dummyField : realField, BorderLayout.CENTER);
             revalidate();
         }
    }
} 
```

你明白了。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-22T13:47:23.000

您应该使用 隐藏文本字段`.setVisible(false)`，并将其替换为黑色的不同组件（例如`JLabel`带有黑色背景的 a）。这可以通过将两个组件（标签和文本字段）放在一个专用的`JPanel`中，并将它们相互堆叠来完成。如果您不需要在那里有黑色区域，您可以选择只是简单地隐藏文本字段。

还有其他仅涉及文本字段的方法，但它们都不是万无一失的，因为不同的操作系统会以不同的方式呈现 Swing 组件（尤其是 Mac OS X），因此覆盖文本字段的`paint()`方法或更改文本颜色例如（如@GarrettHall 所述）并不总是有效。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-22T13:54:34.710

**我做了一个小例子，只**使用JTextField，就像你问的那样，使字符变黑，文本框变黑。

```
import java.awt.Color;
import java.awt.Dimension;

import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JTextField;

public class RunnableTest{    
    public static void main(String args[]){

        JFrame frame = new JFrame("frame");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        JPanel panel = new JPanel();
        JTextField textfield = new JTextField();
        textfield.setPreferredSize(new Dimension(400,30));
        textfield.setForeground(Color.black);
        textfield.setBackground(Color.black);
        textfield.setSelectedTextColor(Color.black);
        textfield.setSelectionColor(Color.black);

        frame.getContentPane().add(panel);
        panel.add(textfield);
        frame.pack();

         frame.setVisible(true);    
    } 
} 
```

此方法`textfield.setForeground(Color.black);`将字体设置为黑色，而`textfield.setBackground(Color.black);`其他方法将背景设置为黑色。和

```
textfield.setSelectedTextColor(Color.black);
textfield.setSelectionColor(Color.black); 
```

将选择设置为黑色，以便您看不到选择的内容。

当然，您可以使用密码字段作为替代，如果您不想使用 JTextField，并防止用户复制文本。

编辑：如果您不希望用户使用 CTRL+C 复制文本，请在文本字段中添加一个键适配器，以便您知道用户何时同时按下两个键。当然，在其他系统上还有很多其他的组合，但这不是问题。

# django - Postgres 数组

> ID：10703262
> 
> 赞同：3
> 
> 时间：2012-05-22T13:40:53.800
> 
> 标签：django, postgresql

我们正在使用[django-dbarray](https://github.com/ecometrica/django-dbarray)模块在 postgres 中使用数组。我一直在对 postgres 数组进行一些研究，一些开发人员表示他们不建议使用存储超过 X 值的 postgres 数组。有时，这是十个，而我听到的多达三十个。在性能开始下降之前，是否可以或应该在数组中存储多少值？

作为参考，上面的DB主要是只读DB。

我们正在尝试决定应该在哪里使用中间表以及应该在哪里使用 postgres 数组。

另一个相关问题：在针对表中的列创建索引时，该列存储数组值（比如说 bigint []）。我意识到存储在数组中的值不会被索引，而只有数组本身（我假设这类似于 C 指针）。与简单地拥有一个中间表相比，这有多有效？

我们可能需要针对这些值创建连接或在 where 子句中包含一些特定值，我担心某些性能可能会降低，并且每当我们可能需要创建连接时，最好使用中间表。

最后，鉴于我们使用的是 dbarray，与简单地使用带有标准 django ORM 的中间表相比，它的效率是多少（假设没有连接是上述问题的 where 子句）？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T19:19:05.410

`PostgreSQL`支持`GIN`和`GiST`索引 intarrays，它允许您像这样运行查询：

```
SELECT  *
FROM    mytable
WHERE   myarray @> ARRAY[1, 2]
-- returns arrays which contain 1 AND 2 
```

或这个：

```
SELECT  *
FROM    mytable
WHERE   myarray && ARRAY[1, 2]
-- returns arrays which contain 1 OR 2 
```

有效率的。

第一个查询很难使用规范化模式有效地重写。

# perl - 如何根据单元格值查找带有 Web::Scraper 的表格？

> ID：10703268
> 
> 赞同：1
> 
> 时间：2012-05-22T13:41:19.057
> 
> 标签：perl

想要处理几个带有表格的html页面。

页面：

*   包含几个无类表，唯一的方法是如何识别正确的表
*   所需表格在第一个单元格值“*内容*”中

问题：如何使用 Web::Scrape 或 Scrappy 或其他工具根据其单元格值找到正确的表格？

示例代码：

```
#!/usr/bin/env perl
use 5.014;
use warnings;
use Web::Scraper;
use YAML;

my $html = do { local $/; <DATA> };

my $table = scraper {

    #the easy way - table with class, or id or any attribute
    #process 'table.xxx > tr', 'rows[]' => scraper {
    #unfortunately, the table hasn't class='xxx', so :(

    process 'NEED_HELP_HERE > tr', 'rows[]' => scraper {
        process 'th', 'header' => 'TEXT';
        process 'td', 'cols[]' => 'TEXT';
    };
};
my $result = $table->scrape( $html );
say Dump($result);

__DATA__
<head><title>title</title></head>
<body>
<table><tr><th class="inverted">header</th><td>value</td></tr></table>
<!-- here are several another tables (different count) -->

<table> <!-- would be easy with some class="xxx" -->
   <tr>
     <th class="inverted">Content</th> <!-- Need this table - 1st cell == "Content" -->
     <td class="inverted">col-1</td>
     <td class="inverted">col-n</td>
   </tr>
   <tr>
     <th>Date</th>
     <td>2012</td>
     <td>2001</td>
   </tr>
   <tr>
     <th>Banana</th>
     <td>val-1</td>
     <td>val-n</td>
   </tr>
</table>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T14:51:23.580

您需要使用 XPath 表达式来查看节点的文本内容。

这应该可以解决问题

```
my $table = scraper {
  process '//table[tr[1]/th[1][normalize-space(text())="Content"]]/tr', 'rows[]' => scraper {
    process 'th', 'header' => 'TEXT';
    process 'td', 'cols[]' => 'TEXT';
  };
}; 
```

它可能看起来很复杂，但如果你分解它就可以了。

它选择作为根下`<tr>`任何元素的子元素的所有元素，其中第一个元素的第一个元素包含等于规范化时的文本元素（去除前导和尾随空格）。`<table>``<th>``<tr>``"Content"`

**输出**

```
---
rows:
  - cols:
      - col-1
      - col-n
    header: Content
  - cols:
      - 2012
      - 2001
    header: Date
  - cols:
      - val-1
      - val-n
    header: Banana 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-22T14:30:56.423

[HTML::TableExtract](http://search.cpan.org/perldoc/HTML%3a%3aTableExtract)似乎对这个问题有好处。

试试这个。

```
#!/usr/bin/Perl 

use strict;
use warnings;
use lib qw( ..); 
use HTML::TableExtract; 
use LWP::Simple; 

my $te = HTML::TableExtract->new( headers => [qw(Content)] );
my $content = get("http://www.example.com");
 $te->parse($content);

foreach my $ts ($te->tables) {
   print "Table (", join(',', $ts->coords), "):\n";
   foreach my $row ($ts->rows) {
      print join(',', @$row), "\n";
   }
 } 
```

如果你改变这一行

```
 my $te = HTML::TableExtract->new( headers => [qw(Content)] ); 
```

到

```
 my $te = HTML::TableExtract->new(); 
```

它将返回所有表格。因此，如果上面的代码块不能准确地为您提供所需的内容，您可以摆弄那行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T15:18:35.390

像往常一样，[Web::Query](http://p3rl.org/Web%3a%3aQuery)以紧凑性获胜。与 Scraper 不同的是，不必为结果命名，但如果您愿意，只需多出一行。

```
use Web::Query qw();
Web::Query->new_from_html($html)
->find('th:contains("Content")')
->parent->parent->find('tr')->map(sub {
    my (undef, $tr) = @_;
    +{ $tr->find('th')->text => [$tr->find('td')->text] }
}) 
```

表达式返回

```
[
    {Content => ['col-1', 'col-n']},
    {Date    => [2012,    2001]},
    {Banana  => ['val-1', 'val-n']}
] 
```

# c - 如何将指针的内容存储到变量中？

> ID：10703272
> 
> 赞同：0
> 
> 时间：2012-05-22T13:41:24.220
> 
> 标签：c

我只是想知道我应该如何将指针的内容存储到变量中，特别是类似于以下内容的内容：

```
somethingpoint = getenv(somethingsomething); 
```

该指针将引用一个字符串。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T13:42:35.460

您需要声明一个指针变量，然后分配给它。您可以在一行代码中完成所有这些操作，如下所示：

```
const char *value = getenv(name); 
```

我在`const`这里使用是因为`getenv`返回一个指向程序不能修改其内容的字符串的指针。使用`const`让编译器帮助我们履行该合同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T13:43:01.163

```
const char* test = getenv(pointerName); 
```

# bytecode - 为什么这个修改后的程序集不运行？（JIT 编译器遇到内部限制。）

> ID：10703277
> 
> 赞同：2
> 
> 时间：2012-05-22T13:41:40.287
> 
> 标签：bytecode, .net-assembly, il

我已经修改了程序集的字节码以消除错误，现在当我尝试使用它时，我得到了 InvalidProgramException。我所做的就是用 NOPS 替换这段代码：

```
catch (Exception exception1)
{
    Exception exception = exception1;
    if (exception as InvalidValueException == null)
    {
        throw new InvalidGenerationException(2);
    }
    else
    {
        throw exception;
    }
} 
```

之前的 IL：

```
catch [mscorlib]System.Exception
{
    IL_022f: stloc.s exception
    IL_0231: ldloc.s exception
    IL_0233: isinst Custom.InvalidValueException
    IL_0238: brfalse.s IL_023d

    IL_023a: ldloc.s exception
    IL_023c: throw

    IL_023d: ldc.i4.1
    IL_023e: newobj instance void Custom.InvalidGenerationException ...
    IL_0243: throw
} 
```

IL 之后：

```
catch [mscorlib]System.Exception
{
    IL_022f: nop
    IL_0230: nop
    IL_0231: nop
    IL_0232: nop
    IL_0233: nop
    IL_0234: nop
    IL_0235: nop
    IL_0236: nop
    IL_0237: nop
    IL_0238: nop
    IL_0239: nop
    IL_023a: nop
    IL_023b: nop
    IL_023c: nop
    IL_023d: nop
    IL_023e: nop
    IL_023f: nop
    IL_0240: nop
    IL_0241: nop
    IL_0242: nop
    IL_0243: nop
} 
```

关于为什么这是错误的任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T14:17:46.287

您的原始`catch`块将始终抛出。也就是说，没有办法“正常”退出该块。

您修改的`catch`块不会抛出，因此您需要正常退出块。您需要使用[`leave`](http://msdn.microsoft.com/en-us/library/system.reflection.emit.opcodes.leave)或[`leave.s`](http://msdn.microsoft.com/en-us/library/system.reflection.emit.opcodes.leave_s)这样做。

（您可能还需要[`pop`](http://msdn.microsoft.com/en-us/library/system.reflection.emit.opcodes.pop)将捕获的异常从堆栈中取出以保持整洁。不过，我不确定那个，您必须自己尝试一下。）

```
catch [mscorlib]System.Exception
{
    IL_022f: pop                // not certain if pop is necessary
    IL_0230: leave.s IL_0244
    IL_0232: nop
    IL_0233: nop
    IL_0234: nop
    IL_0235: nop
    IL_0236: nop
    IL_0237: nop
    IL_0238: nop
    IL_0239: nop
    IL_023a: nop
    IL_023b: nop
    IL_023c: nop
    IL_023d: nop
    IL_023e: nop
    IL_023f: nop
    IL_0240: nop
    IL_0241: nop
    IL_0242: nop
    IL_0243: nop
}
IL_0244: ret    // or whatever 
```

# c++ - 使用 cygwin 从 Nmake 切换到 MinGW

> ID：10703280
> 
> 赞同：1
> 
> 时间：2012-05-22T13:41:50.610
> 
> 标签：c++, c, cmake

如何使用 MingW 而不是 Nmake 使用 cmake ???

我在 Windows 7 x64 上安装了带有 Mingw、gcc、g++ 和 gdb 的 cygwin

当我尝试这个命令时：

```
cmake 
```

我收到一个包含以下内容的长错误：

```
-- Building for: NMake Makefiles
-- The C compiler identification is unknown
-- The CXX compiler identification is unknown
CMake Error: your RC compiler: "CMAKE_RC_COMPILER-NOTFOUND" was not found.   Ple
ase set CMAKE_RC_COMPILER to a valid compiler path or name.
-- Check for CL compiler version
-- Check for CL compiler version - failed
-- Check if this is a free VC compiler
-- Check if this is a free VC compiler - yes
-- Using FREE VC TOOLS, NO DEBUG available
-- Check for working C compiler: cl

  CMake will not be able to correctly generate this project.
Call Stack (most recent call first):

CMake Error: your C compiler: "cl" was not found.   Please set CMAKE_C_COMPILER
to a valid compiler path or name.
CMake Error: your CXX compiler: "cl" was not found.   Please set CMAKE_CXX_COMPI
LER to a valid compiler path or name.
-- Configuring incomplete, errors occurred! 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T13:48:24.467

你应该选择

> MinGW 生成文件。

如果`gcc`不在路径中，您应该选择

> 指定本机编译器

指向编译器二进制文件的路径。

# c# - C#列表框和excel如何删除excel中的信息？

> ID：10703283
> 
> 赞同：0
> 
> 时间：2012-05-22T13:41:59.603
> 
> 标签：c#, excel

所以我有带有列表框和按钮1（更新）的winform，所以当我按下按钮1时，它会打开excel文档找到我需要的信息并填充列表框。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using Excel = Microsoft.Office.Interop.Excel;

namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {

        public Form1()
        {
            InitializeComponent();

        }

        private void Form1_Load(object sender, EventArgs e)
        {

        }

        private void button1_Click(object sender, EventArgs e)
        {
            string FName = @"c:\TEST\data.xlsx";
            var excelApp = new Excel.Application();
            excelApp.Visible = true;

            Excel.Workbook excelbk = excelApp.Workbooks._Open(FName,
               Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing,
               Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing,
               Type.Missing, Type.Missing);

            Excel.Worksheet xlSht = (Excel.Worksheet)excelbk.Worksheets["Sheet1"];

            //find Column Number
            //Now find Test in Row 1
            Excel.Range column = (Excel.Range)xlSht.Columns[1, Type.Missing];
            string FindWhat = "name";
            bool MatchCase = true;

            Excel.Range FindResults = column.Find(FindWhat, Type.Missing,
                Excel.XlFindLookIn.xlValues, Excel.XlLookAt.xlWhole,
                Excel.XlSearchOrder.xlByColumns, Excel.XlSearchDirection.xlNext,
                MatchCase, Type.Missing, Type.Missing);

            int colNumber = FindResults.Column;

            //Get Last Row of Data
            Excel.Range xlRange = (Excel.Range)xlSht.get_Range("A" + xlSht.Rows.Count, Type.Missing);
            int LastRow = xlRange.get_End(Microsoft.Office.Interop.Excel.XlDirection.xlUp).Row;

            //start update
            listBox1.BeginUpdate();

            //read data into form
            string CellData;
            for (int RowCount = 2; RowCount <= LastRow; RowCount++)
            {
                xlRange = (Excel.Range)xlSht.Cells[RowCount, colNumber];
                CellData = (string)xlRange.Text;
                listBox1.Items.Add(CellData);

            }

            //end update
            listBox1.EndUpdate();

            object SaveChanges = (object)false;
            excelbk.Close(SaveChanges, Type.Missing, Type.Missing);
            excelApp.Quit();
            excelApp = null;
        }

    }
} 
```

我现在要做的是删除按钮，以便用户选择其中一个名称，然后删除按钮删除具有所选名称的行中的所有信息，例如单元格 A2 包含列表框中显示的名称，当用户点击删除按钮时，它会删除所有第 2 行的信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T13:56:34.830

您可以找到使用 WorksheetFunction.Match 函数来获取用户所在的行，并且从那里您应该能够删除该行。

```
double Match(
    Object Arg1, 
    Object Arg2, 
    Object Arg3
) 
```

参数

Arg1 类型：System.Object Lookup_value - 用于在表中查找所需值的值。

Arg2 类型：System.Object Lookup_array - 包含可能查找值的连续单元格范围。Lookup_array 必须是数组或数组引用。

Arg3 类型：System.Object Match_type - 数字 -1、0 或 1。Match_type 指定 Microsoft Excel 如何将 lookup_value 与 lookup_array 中的值进行匹配。

[http://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel.worksheetfunction.match.aspx](http://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel.worksheetfunction.match.aspx)

额外的东西：本着更有帮助的精神，假设您的 Excel 工作表在第一行有列标题，在第一列有名称，从第 2 行开始。所以像，

> 第 1 行：名称
> 
> 第 2 行：史蒂夫
> 
> 第 3 行：约翰
> 
> 第 4 行：亚当
> 
> 第 5 行：兰迪

如果使用`Match("Adam", A2:A5, 0)`，则返回值为 3，因为在您的 A2:A5 范围内，它是第 3 行，因此您实际要删除的行是 4。必须考虑这些事情。您可以在您的范围中包含 A1，这在大多数情况下都可以使用。

# java - 如何获取存储在枚举中的引用？

> ID：10703284
> 
> 赞同：1
> 
> 时间：2012-05-22T13:42:13.077
> 
> 标签：java, methods, enums

我有一个 Java 枚举，其中一个对象引用存储在一个字段中。如何从枚举外部获取该引用？

```
public enum TisztításiEljárás  {
    BIO_TISZTÍTÁS(new Időtartam(3, 20))

    private Időtartam javasoltVállalás;

    private TisztításiEljárás(Időtartam i) {
        javasoltVállalás = i;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T13:43:59.523

就像上课一样。

`get`公开该字段，或在枚举中添加一个方法。

```
enum TisztításiEljárás  {
    BIO_TISZTÍTÁS(new Időtartam(3, 20));

    private Időtartam javasoltVállalás;

    private TisztításiEljárás(Időtartam i) {
        javasoltVállalás = i;
    }

    public Időtartam getObj() {    // ordinary get method
        return javasoltVállalás;
    }
} 
```

像这样使用它：

```
// Get the object
Időtartam theObject = TisztításiEljárás.BIO_TISZTÍTÁS.getObj(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T13:44:17.060

我不确定我是否完全理解这个问题，似乎过于简单

你试过了`TisztításiEljárás.BIO_TISZTÍTÁS`吗？

如果您需要获取 javasoltVállalás 变量，则需要向其添加公共 getter。

# excel - 按指定的不同颜色计算单元格值

> ID：10703288
> 
> 赞同：0
> 
> 时间：2012-05-22T13:42:24.773
> 
> 标签：excel, vba, macos

请需要您的帮助来计算指定不同颜色的单元格值。

在一张纸上，一些单元格用**红色**填充，一些单元格用**蓝色**填充，一些单元格用**绿色**填充。输出应分别为红色细胞计数、蓝色细胞计数和绿色细胞计数。

这是我尝试过的：

```
Function CountByColor(InputRange As Range, ColorRange As Range) As Long

    Dim cl As Range
    TempCount As Long
    ColorIndex As Integer

    ColorIndex = ColorRange.Cells(1, 1).Interior.ColorIndex TempCount = 0
    For Each cl In InputRange.Cells
        If cl.Interior.ColorIndex = ColorIndex
        Then
        TempCount = TempCount + 1
        End If
    Next cl
    Set cl = Nothing CountByColor = TempCount
End Function 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T14:16:15.560

您的功能按预期工作：-

```
Function CountByColor(InputRange As Range, ColorRange As Range) As Long
    Dim cl As Range, TempCount As Long, ColorIndex As Integer
    ColorIndex = ColorRange.Cells(1, 1).Interior.ColorIndex
    TempCount = 0
    For Each cl In InputRange.Cells
        If cl.Interior.ColorIndex = ColorIndex Then
            TempCount = TempCount + 1
        End If
    Next cl
    Set cl = Nothing
    CountByColor = TempCount
End Function 
```

## 公式：

```
=CountByColor(A:A,A2) 
```

这里`A2 Cell`充满`Green`绿色指数是`14`

## 结果：

对于我的工作表，我得到的结果为

```
3 
```

基本上你需要执行这个公式三次才能得到三个结果

```
=CountByColor(A:A,A2)   // A2 filled with Green
=CountByColor(A:A,A6)   // A6 filled with Red
=CountByColor(A:A,A9)   // A9 filled with Blue 
```

# html - 有人真的在使用 css 命名空间吗？

> ID：10703291
> 
> 赞同：31
> 
> 时间：2012-05-22T13:42:26.840
> 
> 标签：html, css, namespaces, css-selectors

人们似乎更喜欢诸如[SMACSS 之类](http://smacss.com/)的命名空间技术，而不是实际的[css 命名空间](http://www.w3.org/TR/css3-namespace/)的原因是什么？

我已经用谷歌搜索了一下，但我一直无法找到任何好的资源。（这让我担心我的 google-fu 是垃圾（很可能）或者 css 命名空间规范没用（不太可能））

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-05-22T13:46:26.213

它们涵盖了完全不同的用例。

CSS 命名空间用于将 CSS 应用于混合来自不同 XML 命名空间的元素的 XML 文档。例如，这样您就可以定位`<foo:p>`而`<bar:p>`不会混淆。

SMACSS 涵盖了编写不干扰页面其他部分的健壮 CSS 的技术。例如，这样`.title`在您的地址簿中的 HTML 就不会与`.title`您的出版物列表中的 HTML 混淆。

* * *

[规范](http://www.w3.org/TR/html5/dom.html#global-attributes)中的更多详细信息：

> 注意：在 HTML 中，xmlns 属性绝对没有效果。它基本上是一个护身符。仅允许稍微轻松地迁移到 XHTML 和从 XHTML 迁移。当被 HTML 解析器解析时，该属性最终没有命名空间，而不是像 XML 中的命名空间声明属性那样的“ [http://www.w3.org/2000/xmlns/ ”命名空间。](http://www.w3.org/2000/xmlns/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-07-30T11:07:24.307

命名空间在 CSS 中有一种相当讨厌的语法，因为“:”命名空间字符必须用前导反斜杠转义以将其与伪类区分开来：

```
html\:img {
  border: 2px solid black;
}
html\:a:visited html\:img {
  border-color: grey;
} 
```

这仅在将 HTML 嵌入 XML 文档时才真正有用。添加 html 命名空间时，来自 HTML 命名空间的元素会正确显示，就像它们在 HTML 中出现的一样，允许访问 CSS 尚未提供的功能。

```
<story xmlns:HTML="http://www.w3.org/Profiles/XHTML-transitional">
  ...
  <restaurant>
    <name>Red Apple Inn</name>
    <logo>
      <HTML:A href="javascript:alert('Visit the Red Apple Inn!')">
        <HTML:IMG src="red-apple.gif" height="50" width="200"/>
      </HTML:A>
    </logo>
    ... 
```

在 HTML5 上下文中，我想不出你需要这个的任何情况。到目前为止，我在 CSS 中看到命名空间的唯一地方是 Webkit 用于 SVG 或 MathML 的默认 CSS，它们使用不同的语法：`@namespace`at-rule。

例如，这是来自[**WebKit/webkit/blob/master/Source/WebCore/css/mathml.css**](https://github.com/WebKit/webkit/blob/master/Source/WebCore/css/svg.css)的代码：

```
@namespace "http://www.w3.org/1998/Math/MathML";

math {
    -webkit-line-box-contain: glyphs replaced;
    text-indent: 0;
    direction: ltr;
}
mtext {
    line-height: 1.0;
}

... 
```

这是来自[**WebKit/webkit/blob/master/Source/WebCore/css/svg.css**](https://github.com/WebKit/webkit/blob/master/Source/WebCore/css/svg.css)的代码：

```
@namespace "http://www.w3.org/2000/svg";
@namespace html "http://www.w3.org/1999/xhtml";

svg:not(:root), symbol, image, marker, pattern, foreignObject {
    overflow: hidden
}

svg:root {
    width: 100%;
    height: 100%
}

text, foreignObject {
    display: block
}

... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-01-23T19:41:21.370

上班太麻烦了。解析 HTML 的浏览器会将所有内容都粘贴到默认命名空间中，但某些标记名称除外（例如：）`svg`。也就是说，您可以在特殊的命名空间中创建一个元素：

```
<html>
<head>
  <style>
    @namespace foo "http://foo";
    foo|div { color: red; }
  </style>
</head>
<body>
    <div>I'm an HTMLDIVElement</div>
</body>
<script>
  const div = document.createElementNS('http://foo', 'div');
  div.textContent = 'I am namespaced.';
  document.body.appendChild(div);
</script>
</html>
```

据我所知，HTML 解析器无法为您选择另一个名称空间。浏览器的 HTML 解析器创建的任何元素都是在默认命名空间中创建的。此外，一旦您转义 HTML 命名空间，它们就不再是`HTMLElement`元素。您不能只使用 of 的标记名`button`并期望它`HTMLButtonElement`具有所有样式、交互和属性。这也意味着没有 HTML 属性，如`.innerText`, `.dir`,`.offsetTop`等。最大的属性是 no `.style`。这也意味着设置`style`属性什么都不做。您必须在 CSS 文件中指定所有样式。

这实际上意味着这仅适用于非常有限的 XML 上下文，并不适用于一般的 HTML 内容。可能有一种方法可以让您的组件实现`HTMLElement`，尽管我还没有找到（也许是 Web 组件？）。尽管如此，这意味着你的所有元素都必须用它来构建，`document.createElementNS`这可能比找到另一种方法来确定你的 CSS 组件范围要多得多。

# postgresql - Postgis 栅格：加载 Tif 子数据集

> ID：10703292
> 
> 赞同：1
> 
> 时间：2012-05-22T13:42:28.307
> 
> 标签：postgresql, postgis, gdal

我想将 TIF 文件中的子数据集加载到我的 PostGIS 数据库中。

gdalinfo 为我提供了有关 TIF 文件的以下信息：

```
Driver: GTiff/GeoTIFF
Files: pathto/imagename.tif
Size is 611, 1
Coordinate System is `'
Metadata:
  TIFFTAG_IMAGEDESCRIPTION=CXmlTiff type 
  TIFFTAG_RESOLUSTIONUNIT=2 (pixels/inch)
  TIFFTAG_XRESOLUTION=100
  TIFFTAG_YRESOLUTION=100
ImageStructure Metadata:
  INTERLEAVE=BAND
Subdatasets:
  SUBDATASET_1_NAME=GTIFF_DIR:1:pathto/imagename.tif
  SUBDATASET_1_DESC=Page 1 (611P x 1L x 1B)
  SUBDATASET_2_NAME=GTIFF_DIR:2:pathto/imagename.tif
  SUBDATASET_2_DESC=Page 1 (392P x 514352L x 1B)
Corner Coordinates:
Upper Left  (   0.0, 0.0)
Lower Left  (   0.0, 1.0)
Upper Right ( 611.0, 0.0)
Lower Right ( 611.0, 1.0)
Center      ( 305.5, 0.5)
Band 1 Block=611x1 Type=Byte, ColorInterp=Gray 
```

我想加载第二个子数据集（392x514352）。

现在，使用 raster2pgsql 和文件名作为输入，只有第一个子数据集被加载，第二个被忽略。只有一个波段，所以使用 -b 开关不起作用。有什么建议吗？

非常感谢

托马斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T19:45:14.020

子数据集在栅格中并不常见，而且我从未在 TIFF 中看到过它们（通常，您看到的是波段，而不是子数据集）。看起来[类似的错误已针对 HDF5 文件进行了修复](http://trac.osgeo.org/postgis/ticket/1761)，但这可能对您的 GTiff 没有帮助。我鼓励您为此功能创建一个错误票。

同时，[gdal_translate](http://www.gdal.org/gdal_translate.html)可以与将`-sds`文件的所有子数据集复制到单个输出文件的选项一起使用，然后您可以将其与 raster2pgsql 一起使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-22T20:36:18.797

在 postgis 栅格的情况下，子数据集由 postgis 系统创建，因为 postgis 栅格通常是平铺的，并且每个平铺在表中由不同的行表示，通常是不同的 Rid。我不确定这里发生了什么，但我想您使用 outofdb 选项来存储您的栅格，对吧？

对于那些使用 gdal_translate 从 postgis 导出栅格的人，您可以在 postgresql 连接选项中使用选项“mode='2'”：结果是一个简单的文件，它合并了 rast 列的所有行。

例子：

```
gdal_translate PG:"host='localhost' port='5432' dbname='mydb' user='me' schema='public' password='secret' table='rastertable' where='rid BETWEEN 1 and 10' mode='2'" /path/filename.tif 
```

# r - R：使用 data.table := 操作来计算新列

> ID：10703299
> 
> 赞同：16
> 
> 时间：2012-05-22T13:43:07.310
> 
> 标签：r, data.table

我们来看看以下数据：

```
dt <- data.table(TICKER=c(rep("ABC",10),"DEF"),
        PERIOD=c(rep(as.Date("2010-12-31"),10),as.Date("2011-12-31")),
        DATE=as.Date(c("2010-01-05","2010-01-07","2010-01-08","2010-01-09","2010-01-10","2010-01-11","2010-01-13","2010-04-01","2010-04-02","2010-08-03","2011-02-05")),
        ID=c(1,2,1,3,1,2,1,1,2,2,1),VALUE=c(1.5,1.3,1.4,1.6,1.4,1.2,1.5,1.7,1.8,1.7,2.3))
setkey(dt,TICKER,PERIOD,ID,DATE) 
```

现在对于每个代码/周期组合，我需要在新列中添加以下内容：

*   `PRIORAVG`：每个 ID 的最新 VALUE 的平均值，不包括当前 ID，前提是它不超过 180 天。
*   `PREV`: 来自同一个 ID 的前一个值。

结果应如下所示：

```
 TICKER     PERIOD       DATE ID VALUE PRIORAVG PREV
 [1,]    ABC 2010-12-31 2010-01-05  1   1.5       NA   NA
 [2,]    ABC 2010-12-31 2010-01-08  1   1.4     1.30  1.5
 [3,]    ABC 2010-12-31 2010-01-10  1   1.4     1.45  1.4
 [4,]    ABC 2010-12-31 2010-01-13  1   1.5     1.40  1.4
 [5,]    ABC 2010-12-31 2010-04-01  1   1.7     1.40  1.5
 [6,]    ABC 2010-12-31 2010-01-07  2   1.3     1.50   NA
 [7,]    ABC 2010-12-31 2010-01-11  2   1.2     1.50  1.3
 [8,]    ABC 2010-12-31 2010-04-02  2   1.8     1.65  1.2
 [9,]    ABC 2010-12-31 2010-08-03  2   1.7     1.70  1.8
[10,]    ABC 2010-12-31 2010-01-09  3   1.6     1.35   NA
[11,]    DEF 2011-12-31 2011-02-05  1   2.3       NA   NA 
```

请注意`PRIORAVG`，第 9 行等于 1.7（等于`VALUE`第 5 行，这是另一个在过去 180 天内唯一的先前观察`ID`）

我发现了这个`data.table`包，但我似乎无法完全理解它的`:=`功能。当我保持简单时，它似乎有效。要获取每个 ID 的先前值（我基于此问题的解决方案[）](https://stackoverflow.com/questions/9843774/loop-through-data-table-to-calculate-conditional-averages)：

```
dt[,PREV:=dt[J(TICKER,PERIOD,ID,DATE-1),roll=TRUE,mult="last"][,VALUE]] 
```

这很好用，只需 0.13 秒即可对我的数据集执行此操作，其中包含约 250k 行；我的矢量扫描函数得到了相同的结果，但速度慢了大约 30,000 倍。

好的，所以我有我的第一个要求。让我们来看看第二个更复杂的需求。到目前为止，对我来说，禁食的方法是使用几个向量扫描并通过函数抛出`plyr`函数`adply`以获得每一行的结果。

```
calc <- function(df,ticker,period,id,date) {
  df <- df[df$TICKER == ticker & df$PERIOD == period 
        & df$ID != id & df$DATE < date & df$DATE > date-180, ]
  df <- df[order(df$DATE),]
  mean(df[!duplicated(df$ID, fromLast = TRUE),"VALUE"])
}

df <- data.frame(dt)
adply(df,1,function(x) calc(df,x$TICKER,x$PERIOD,x$ID,x$DATE)) 
```

我为 a 编写了函数，`data.frame`但它似乎不适用于 a `data.table`。对于 5000 行的子集，这大约需要 44 秒，但我的数据包含超过 100 万行。我想知道这是否可以通过使用`:=`.

```
dt[J("ABC"),last(VALUE),by=ID][,mean(V1)] 
```

这可以为 ABC 的每个 ID 选择最新 VALUE 的平均值。

```
dt[,PRIORAVG:=dt[J(TICKER,PERIOD),last(VALUE),by=ID][,mean(V1)]] 
```

然而，这并没有按预期工作，因为它取所有代码/周期的所有最后 VALUE 的平均值，而不仅仅是当前代码/周期。所以最终所有行都获得相同的平均值。我做错了什么还是这是一个限制`:=`？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-22T18:45:39.207

好问题。尝试这个 ：

```
dt
     TICKER     PERIOD       DATE ID VALUE
[1,]    ABC 2010-12-31 2010-01-05  1   1.5
[2,]    ABC 2010-12-31 2010-01-08  1   1.4
[3,]    ABC 2010-12-31 2010-01-10  1   1.4
[4,]    ABC 2010-12-31 2010-01-13  1   1.5
[5,]    ABC 2010-12-31 2010-01-07  2   1.3
[6,]    ABC 2010-12-31 2010-01-11  2   1.2
[7,]    ABC 2010-12-31 2010-01-09  3   1.6
[8,]    DEF 2011-12-31 2011-02-05  1   2.3

ids = unique(dt$ID)
dt[,PRIORAVG:=NA_real_]
for (i in 1:nrow(dt))
    dt[i,PRIORAVG:=dt[J(TICKER[i],PERIOD[i],setdiff(ids,ID[i]),DATE[i]),
                      mean(VALUE,na.rm=TRUE),roll=TRUE,mult="last"]]
dt
     TICKER     PERIOD       DATE ID VALUE PRIORAVG
[1,]    ABC 2010-12-31 2010-01-05  1   1.5       NA
[2,]    ABC 2010-12-31 2010-01-08  1   1.4     1.30
[3,]    ABC 2010-12-31 2010-01-10  1   1.4     1.45
[4,]    ABC 2010-12-31 2010-01-13  1   1.5     1.40
[5,]    ABC 2010-12-31 2010-01-07  2   1.3     1.50
[6,]    ABC 2010-12-31 2010-01-11  2   1.2     1.50
[7,]    ABC 2010-12-31 2010-01-09  3   1.6     1.35
[8,]    DEF 2011-12-31 2011-02-05  1   2.3       NA 
```

那么你已经有了稍微简化的东西......

```
dt[,PREV:=dt[J(TICKER,PERIOD,ID,DATE-1),VALUE,roll=TRUE,mult="last"]]

     TICKER     PERIOD       DATE ID VALUE PRIORAVG PREV
[1,]    ABC 2010-12-31 2010-01-05  1   1.5       NA   NA
[2,]    ABC 2010-12-31 2010-01-08  1   1.4     1.30  1.5
[3,]    ABC 2010-12-31 2010-01-10  1   1.4     1.45  1.4
[4,]    ABC 2010-12-31 2010-01-13  1   1.5     1.40  1.4
[5,]    ABC 2010-12-31 2010-01-07  2   1.3     1.50   NA
[6,]    ABC 2010-12-31 2010-01-11  2   1.2     1.50  1.3
[7,]    ABC 2010-12-31 2010-01-09  3   1.6     1.35   NA
[8,]    DEF 2011-12-31 2011-02-05  1   2.3       NA   NA 
```

如果这可以作为原型，那么很大的速度改进将是保持循环但使用`set()`而不是`:=`，以减少开销：

```
for (i in 1:nrow(dt))
    set(dt,i,6L,dt[J(TICKER[i],PERIOD[i],setdiff(ids,ID[i]),DATE[i]),
                   mean(VALUE,na.rm=TRUE),roll=TRUE,mult="last"])
dt
     TICKER     PERIOD       DATE ID VALUE PRIORAVG PREV
[1,]    ABC 2010-12-31 2010-01-05  1   1.5       NA   NA
[2,]    ABC 2010-12-31 2010-01-08  1   1.4     1.30  1.5
[3,]    ABC 2010-12-31 2010-01-10  1   1.4     1.45  1.4
[4,]    ABC 2010-12-31 2010-01-13  1   1.5     1.40  1.4
[5,]    ABC 2010-12-31 2010-01-07  2   1.3     1.50   NA
[6,]    ABC 2010-12-31 2010-01-11  2   1.2     1.50  1.3
[7,]    ABC 2010-12-31 2010-01-09  3   1.6     1.35   NA
[8,]    DEF 2011-12-31 2011-02-05  1   2.3       NA   NA 
```

这应该比问题中显示的重复矢量扫描快得多。

或者，可以对操作进行矢量化。但由于此任务的特性，这将不太容易编写和阅读。

顺便说一句，问题中没有任何数据可以测试 180 天的要求。如果您添加一些并再次显示预期输出，那么我将使用我在评论中提到的连接继承范围添加年龄计算。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-11-20T09:21:20.740

使用更高版本的另一种可能的方法`data.table`：

```
library(data.table) #data.table_1.12.6 as of Nov 20, 2019
cols <- copy(names(DT))
DT[, c("MIN_DATE", "MAX_DATE") := .(DATE - 180L, DATE)]

DT[, PRIORAVG := 
        .SD[.SD, on=.(TICKER, PERIOD, DATE>=MIN_DATE, DATE<=MAX_DATE),
            by=.EACHI, {
                subdat <- .SD[x.ID!=i.ID]
                pavg <- if (subdat[, .N > 0L])
                    mean(subdat[, last(VALUE), ID]$V1, na.rm=TRUE)
                else 
                    NA_real_
                c(setNames(mget(paste0("i.", cols)), cols), .(PRIORAVG=pavg))
            }]$PRIORAVG
]

DT[, PREV := shift(VALUE), .(TICKER, PERIOD, ID)] 
```

输出：

```
 TICKER     PERIOD       DATE ID VALUE   MIN_DATE   MAX_DATE PRIORAVG PREV
 1:    ABC 2010-12-31 2010-01-05  1   1.5 2009-07-09 2010-01-05       NA   NA
 2:    ABC 2010-12-31 2010-01-08  1   1.4 2009-07-12 2010-01-08     1.30  1.5
 3:    ABC 2010-12-31 2010-01-10  1   1.4 2009-07-14 2010-01-10     1.45  1.4
 4:    ABC 2010-12-31 2010-01-13  1   1.5 2009-07-17 2010-01-13     1.40  1.4
 5:    ABC 2010-12-31 2010-04-01  1   1.7 2009-10-03 2010-04-01     1.40  1.5
 6:    ABC 2010-12-31 2010-01-07  2   1.3 2009-07-11 2010-01-07     1.50   NA
 7:    ABC 2010-12-31 2010-01-11  2   1.2 2009-07-15 2010-01-11     1.50  1.3
 8:    ABC 2010-12-31 2010-04-02  2   1.8 2009-10-04 2010-04-02     1.65  1.2
 9:    ABC 2010-12-31 2010-08-03  2   1.7 2010-02-04 2010-08-03     1.70  1.8
10:    ABC 2010-12-31 2010-01-09  3   1.6 2009-07-13 2010-01-09     1.35   NA
11:    DEF 2011-12-31 2011-02-05  1   2.3 2010-08-09 2011-02-05       NA   NA 
```

# java - 以与 Eclipse 中的实现接口相同的顺序对方法进行排序

> ID：10703300
> 
> 赞同：5
> 
> 时间：2012-05-22T13:43:08.633
> 
> 标签：java, eclipse

我正在寻找一种方法来对类中的方法进行排序，其方式与它们在它们覆盖的接口中的排序方式相同。

它是一个仅从一个接口实现方法的类，因此它们不应该有任何问题。

我从 Eclipse 中找到了基本的排序功能，但据我所知，它只能根据方法类型和方法名称进行排序。

有任何想法吗？Eclipse 插件？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T17:33:25.207

如果您也可以修改接口源，**请在接口和类**上使用 Source->Sort 成员。之后它们具有相同的方法顺序。

我仍然想知道您通过对代码进行排序来达到什么目的，因为我认为没有必要这样做，因为

*   您可以对大纲进行排序，因此可以根据需要显示*逻辑结构，而与文件内容无关。*
*   我也看不出需要在文本上比较这两个文件，因为编译器总是会告诉你它们是否匹配。

# kentico - 在 Intranet 门户网站上自定义部门

> ID：10703306
> 
> 赞同：0
> 
> 时间：2012-05-22T13:43:26.263
> 
> 标签：kentico

客户要求我们更改部门网站的默认部分。我创建了一个包含适当部分的部门站点，并创建了一个名为“模板”的副本。我希望当管理员创建一个新的部门站点时，它会从模板生成所有页面。情况并非如此，看起来我需要修改部门文档中的“部门部门经理”，但我不确定如何执行此操作，或者这是否是正确的操作过程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T14:19:27.713

看起来您必须将其创建`Template`为常规页面而不是部门。创建`Template`页面后，我添加了所有子页面，现在一切正常。

# java - 如何在静态上下文中使用具有特定对象的泛型类？

> ID：10703310
> 
> 赞同：10
> 
> 时间：2012-05-22T13:43:44.950
> 
> 标签：java, inheritance, static, playframework-2.0

我会尽力解释。

我使用 Play Framework 2，我会做很多 CRUD 操作。其中一些将是相同的，所以我想 KISS 和 DRY 所以起初我在考虑一个包含`list`、`details`、和方法的抽象类`create`，以及通用对象，并通过指定要使用的对象来扩展这个类（模型＆ 形式） ：`update``delete`

```
public abstract class CrudController extends Controller {
    protected static Model.Finder<Long, Model> finder = null;
    protected static Form<Model> form = null;

    public static Result list() {
        // some code here
    }

    public static Result details(Long id) {
        // some code here
    }

    public static Result create() {
        // some code here
    }

    public static Result update(Long id) {
        // some code here
    }

    public static Result delete(Long id) {
        // some code here
    }
} 
```

还有一个将使用 CRUD 的类：

```
public class Cities extends CrudController {
    protected static Model.Finder<Long, City> finder = City.find;
    protected static Form<City> form = form(City.class);

    // I can override a method in order to change it's behavior :
    public static Result list() {
        // some different code here, like adding some where condition
    }
} 
```

如果我不在静态上下文中，这将起作用。

但既然是这样，我该怎么办？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-22T18:38:33.670

这可以使用委托来实现：定义一个包含 CRUD 操作逻辑的常规 Java 类：

```
public class Crud<T extends Model> {

    private final Model.Finder<Long, T> find;
    private final Form<T> form;

    public Crud(Model.Finder<Long, T> find, Form<T> form) {
        this.find = find;
        this.form = form;
    }

    public Result list() {
        return ok(Json.toJson(find.all()));
    }

    public Result create() {
        Form<T> createForm = form.bindFromRequest();
        if (createForm.hasErrors()) {
            return badRequest();
        } else {
            createForm.get().save();
            return ok();
        }
    }

    public Result read(Long id) {
        T t = find.byId(id);
        if (t == null) {
            return notFound();
        }
        return ok(Json.toJson(t));
    }

    // … same for update and delete
} 
```

然后，您可以定义一个 Play 控制器，其中包含一个包含以下实例的静态字段`Crud<City>`：

```
public class Cities extends Controller {
    public final static Crud<City> crud = new Crud<City>(City.find, form(City.class));
} 
```

你几乎完成了：你只需要定义 Crud 动作的路线：

```
GET     /                     controllers.Cities.crud.list()
POST    /                     controllers.Cities.crud.create()
GET     /:id                  controllers.Cities.crud.read(id: Long) 
```

注意：此示例为简洁起见生成 JSON 响应，但可以呈现 HTML 模板。但是，由于 Play 2 模板是静态类型的，您需要将所有模板作为`Crud`类的参数传递。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-22T14:04:30.337

（免责声明：我对 playframework 没有经验。）

以下想法可能会有所帮助：

```
public interface IOpImplementation {
    public static Result list();
    public static Result details(Long id);
    public static Result create();
    public static Result update(Long id);
    public static Result delete(Long id);
}

public abstract class CrudController extends Controller {
    protected static Model.Finder<Long, Model> finder = null;
    protected static Form<Model> form = null;

    protected static IOpImplementation impl;

    public static Result list() {
        return impl.list();
    }

    public static Result details(Long id) {
        return impl.details(id);
    }
    // other operations defined the same way
}

public class Cities extends CrudController {

    public static Cities() {
        impl = new CitiesImpl();
    }

} 
```

通过这种方式，您可以创建实现的层次结构。

（这一定是一些花哨的设计模式，但我不知道 ATM 这个名字。）

# javascript - javascript/jquery 范围滑块中的语法错误

> ID：10703313
> 
> 赞同：0
> 
> 时间：2012-05-22T13:44:03.440
> 
> 标签：javascript, jquery, slider, range

有人能告诉我这行代码的语法有什么问题吗？在 Dreamweaver 中，我在以下位置遇到语法错误：

```
values: [${command.schedule.startTime.minutesFromMidnight},
            ${command.schedule.stopTime.minutesFromMidnight}], 
```

完整的javascript代码如下：

```
<script language="javascript">
   function slideTime(from_position, to_position){
     var from = parseInt(from_position);
     var to = parseInt(to_position);
     if(from > (23*60)+45) {
     return false;
   }
  if(from >= to) {
     return false;
   }
  var minutes0 = parseInt(from % 60);
  var hours0 = parseInt(from / 60 % 24);
  var minutes1 = parseInt(to % 60);
  var hours1 = parseInt(to / 60 % 24);
  if(getTime(hours0, minutes0) == getTime(hours1, minutes1)){
     to = to - 15;
     minutes1 = parseInt(to % 60);
     hours1 = parseInt(to / 60 % 24);
     }
  $("#time").val(getTime(hours0, minutes0) + ' - ' + getTime(hours1, minutes1));
  $("#schedule\\.startTime\\.minutesFromMidnight").val(from);
  $("#schedule\\.stopTime\\.minutesFromMidnight").val(to);
  }
  function getTime(hours, minutes) {
     var time = null;
     minutes = minutes + "";
     if (hours < 12) {
     time = "AM";
     }
     else {
     time = "PM";
     }
      if (hours == 0) {
     hours = 12;
     }
     if (hours > 12) {
     hours = hours - 12;
     }
     if (minutes.length == 1) {
     minutes = "0" + minutes;
     }
      return hours + ":" + minutes + " " + time;
     } 
</script>

<script language="javascript">
   $(document).ready(function() {
   $("#slider-range").slider({
   range: true,
   min: 0,
   max: 1680,
   values: [${command.schedule.startTime.minutesFromMidnight},
            ${command.schedule.stopTime.minutesFromMidnight}],
   slide: function(event, ui) {
          var from = ui.values[0];
          var to = ui.values[1];
          return slideTime(from, to);
   },
   step:15
   });
 });
</script> 
```

HTML

```
<div id="slider-range"></div> 
```

代码不会在浏览器中运行。代码不是我写的，而是给我重复使用的。谢谢。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-05-22T13:47:40.753

```
<script language="javascript">
   function slideTime(from_position, to_position){
     var from = parseInt(from_position);
     var to = parseInt(to_position);
     if(from > (23*60)+45) {
     return false;
   }
  if(from >= to) {
     return false;
   }
  var minutes0 = parseInt(from % 60);
  var hours0 = parseInt(from / 60 % 24);
  var minutes1 = parseInt(to % 60);
  var hours1 = parseInt(to / 60 % 24);
  if(getTime(hours0, minutes0) == getTime(hours1, minutes1)){
     to = to - 15;
     minutes1 = parseInt(to % 60);
     hours1 = parseInt(to / 60 % 24);
     }
  $("#time").val(getTime(hours0, minutes0) + ' - ' + getTime(hours1, minutes1));
  $("#schedule\\.startTime\\.minutesFromMidnight").val(from);
  $("#schedule\\.stopTime\\.minutesFromMidnight").val(to);
  }
  function getTime(hours, minutes) {
     var time = null;
     minutes = minutes + "";
     if (hours < 12) {
     time = "AM";
     }
     else {
     time = "PM";
     }
      if (hours == 0) {
     hours = 12;
     }
     if (hours > 12) {
     hours = hours - 12;
     }
     if (minutes.length == 1) {
     minutes = "0" + minutes;
     }
      return hours + ":" + minutes + " " + time;
     } 
</script>

<script language="javascript">
   $(document).ready(function() {
   $("#slider-range").slider({
   range: true,
   min: 0,
   max: 1680,
   values: [$command.schedule.startTime.minutesFromMidnight,
            $command.schedule.stopTime.minutesFromMidnight],
   slide: function(event, ui) {
          var from = ui.values[0];
          var to = ui.values[1];
          return slideTime(from, to);
   },
   step:15
   });
 });
</script> 
```

使用此代码..

# javascript - 通过ajax调用多个脚本。只有在脚本 1 完成执行后才能调用脚本 2

> ID：10703316
> 
> 赞同：1
> 
> 时间：2012-05-22T13:44:11.443
> 
> 标签：javascript, ajax

我有 4 个脚本，我想通过 ajax 一个接一个地调用它们。

我只想`script_2`在`script_1`完成执行后调用。

这意味着首先我想`script_1`在 ajax中调用，`script_1`在其各自的 div 中显示执行结果，然后调用第二个脚本，在第二个 div 中显示其结果，依此类推。

目前我正在做的是在`onreadystatechange()`函数内部创建一个新的 ajax 调用（以嵌套方式）。

下面是伪代码：

```
var script1_ajax = new XMLHttpRequest();

script1_ajax.onreadystatechange=function() {            
    if (script1_ajax.readyState==4 && script1_ajax.status==200) {

        document.getElementById('result').innerHTML = script1_ajax.responseText;
        //create second ajax request and call it
        //similarly create two more nested ajax calls and call it
    }
} 
```

我认为这不是正确的做法。请建议如何以不太复杂的方式执行此操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T14:03:03.943

用两个词：抽象和回调：

```
//abstract the AJAX code
function ajax(url,data,callback){
    var xhr = new XHR(...
    //the rest of the AJAX setup here
    xhr.onreadystatechange=function() {            
        if (xhr.readyState === 4 && xhr.status === 200) {
            callback(xhr.responseText); //execute callback
        }
    }
    xhr.send();
}

function script1(){
    //call ajax
    ajax('test1.php','somedata',function(returndata){
        //this callback gets executed when ajax is done
        document.getElementById('result').innerHTML = returndata;
        //execute next
        script2();
    });
}

function script2(){
    ajax('test1.php','somedata',function(returndata){
        document.getElementById('result').innerHTML = returndata;
        script3();
    });
}

function script3(){
    //and so on...
}

script1(); //execute first 
```

* * *

另一方面，您可以使用[`jQuery.ajax`](http://api.jquery.com/jQuery.ajax/)，看起来几乎相同：

```
function script1(){
    $.get('url','data',function(data){
        $('#result').html(data);
        script2();
    });
}

function script2(){
    $.get('url','data',function(data){
        $('#result').html(data);
        script3();
    });
}

function script3(){
    //and so on
}

script1(); //execute first 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T14:01:29.327

可能您最好的选择是使用 Javascript 库，例如 jQuery。jQuery 具有[`jQuery.Deferred()`](http://api.jquery.com/category/deferred-object/)可用于轻松表示承诺（未来结果）的对象，从而允许轻松链接函数调用。请注意[`$.get()`](http://api.jquery.com/jQuery.get/)，例如，返回 a `Deferred`（请参阅页面下方的文档）。[本文](http://spin.atomicobject.com/2011/08/24/chaining-jquery-ajax-calls/)也有一个很好的解决方案和一个工作 jsfiddle，但它与`Deferred`方法完全不同，这只是一个问题

```
function _get(url, params, success) {
  return function() {
    return $.get(url, params, success);
  }
}

$.get("http://host/1", {}, updateDiv)   // see the doc for $.get()
  .pipe(_get("http://host/2"))          // see $.Deferred() and pipe()
  .pipe(_get("http://host/3"))
  .pipe(_get("http://host/4")); 
```

如果你不了解 jQuery，[`$.get(url, params, callback)`](http://api.jquery.com/jQuery.get/)那么是做异步 HTTP GET 请求的方法

*注意：我更新了代码，因为`deferred.then()`需要回调（我给了它一个承诺）并替换`then()`为`pipe()`，这给出了当前 jQuery 版本的预期行为（实际上在 1.8 中它似乎`then()`是 current 的别名`pipe()`）*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-18T03:46:22.713

你可以这样做。假设您必须加载三个脚本，而第三个脚本有一个回调。

```
$.get("js/ext/flowplayer-3.2.8.min.js")
.pipe($.get("js/eviflowplayer.js"))
.pipe($.get("js/evi.flowplayer.js", {}, function()
{
    W.EVI.FLOWPLAYER.init(elem.attr('id'));
}); 
```

还有[更多](http://www.jquery4u.com/errors/getscript-loading-character-url/)使用`$.getScript()`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T13:59:03.660

好吧实际上是非常合适的（想法），您当然可以在 ajax 调用中使用 jQuery 及其异步选项来强制它同步（[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)），或者做同样的事情在我们的代码中使用`success()`回调处理。

至于这个请求的代码，我相信你知道它在某些浏览器上失败了？它看起来很糟糕，因为您必须两次调用同一组函数，尝试将它们放入函数中，也许将整个 ajax 请求包装在某个类/JSON 中。

第三种选择是您自己使用`setTimeout()`/ `clearTimeout()`implementation强制同步模式，`setInterval()`但这不是我推荐的方式。

# html - Stick footer no css 教程与乐趣一起工作

> ID：10703317
> 
> 赞同：0
> 
> 时间：2012-05-22T13:44:11.800
> 
> 标签：html, css, layout, footer

我有一个简单的任务：将页脚粘贴到底部（粘性页脚）。

我在stackoverflow和google上搜索了几个线程。

似乎有两种技术：

1.  [http://ryanfait.com/sticky-footer/layout.css,http://www.cssstickyfooter.com/style.css](http://ryanfait.com/sticky-footer/layout.css,http://www.cssstickyfooter.com/style.css) （重置所有元素填充和边距，拉伸包装，清除两者或其他附加模块）

2.  绝对定位

第一个看起来像一些黑客（也没有工作）所以我想坚持绝对定位（底部：0;）但在这里我提到了内容大的页面（很多段落）页脚挂在中间当我向下滚动...

然而这里是小提琴，希望有人发现我的错误：http: [//jsfiddle.net/379gr/](http://jsfiddle.net/379gr/)

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T15:10:20.627

这是**FooterStick**：http: [//jsfiddle.net/jAbw4/](http://jsfiddle.net/jAbw4/)。

回到你的代码。将#content_wrapper 的属性“位置”设置为相对。否则，**包含块**将是**初始包含块**。初始包含块覆盖视口区域，因此，您的页脚的行为如您的问题中所述。

顺便说一句：Cameron Adams 写了关于定位页脚的**更强大的方法：** [FooterStickAlt](http://themaninblue.com/writing/perspective/2005/08/29/)。他更喜欢 FooterStickAlt，因为可以观察到**旧版本的壁虎浏览器和 IE 中的绘制错误（****使用 FooterStick 时**）：当加载过程中内容的高度变化很大时，页脚位置不正确。因此，例如，如果包含没有尺寸信息的图片，则绝对定位的元素将保持在第一次确定的位置，并且不会随着内容的增长而向下移动。**FooterStickAlt 没有**这个**问题**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T15:09:50.700

看看：http: [//jsfiddle.net/sTW6t/1/](http://jsfiddle.net/sTW6t/1/)

这是我不久前在使用具有相对位置的粘性页脚时所做的。让一些 jquery 来解决问题，瞧 ;-) 它的作用是计算高度，以便页脚知道他需要停留的位置，粘性。

$（函数（）{

```
function positionFooter() {

    var windowHeight = $(window).height();
    var documentHeight = $('#pagewrap').height();

    if (windowHeight > ($('#content').height() + $('#header').height())) {
        var pagewrapHeight = windowHeight - $('#footer').height();
        $("#pagewrap").height(pagewrapHeight);
    }
}

positionFooter();
$(window).resize(positionFooter) 
```

});

干杯!

# java - Java中的线程不是同时启动，而是顺序启动

> ID：10703318
> 
> 赞同：0
> 
> 时间：2012-05-22T13:44:14.080
> 
> 标签：java, multithreading, parallel-processing

我在用 Java 编写多线程算法时遇到了一些问题。这是我所拥有的：

```
public class NNDFS implements NDFS {

//Array of all worker threads
private Thread[] threadArray; 

//Concurrent HashMap containing a mapping of graph-states and 
//algorithm specific state objects (NDFSState)
private ConcurrentHashMap<State, NDFSState> stateStore;

//Whether the algorithm is done and whether a cycle is found
private volatile boolean done;
private volatile boolean cycleFound;

/**
  Constructor that creates the threads, each with their own graph

  @param  file        The file from which we can create the graph
  @param  stateStore  Mapping between graph-states and state belonging to our algorithm
  @param  nrWorkers   Number of working threads we need
 */
public NNDFS(File file, Map<State, NDFSState> stateStore, int nrWorkers) throws FileNotFoundException {
    int i;
    this.stateStore = new ConcurrentHashMap<State, NDFSState>(stateStore);
    threadArray = new Thread[nrWorkers]; 
    for(i=0;i<nrWorkers;i++){
         Graph graph = GraphFactory.createGraph(file);
         threadArray[i] = new Thread(new NDFSRunnable(graph, i));
    }
}

/**
    Class which implements a single thread running the NDFS algorithm
 */
class NDFSRunnable implements Runnable{

    private Graph graph;

    //Neccesary as Java apparently doesn't allow us to get this ID
    private long threadId; 

    NDFSRunnable(Graph graph, long threadId){
         this.graph = graph;
         this.threadId = threadId;
    }

    public void run(){
        try {
            System.out.printf("Thread id = %d\n", threadId);
            //Start by executing the blue DFS for the first graph
            mcdfsBlue(graph.getInitialState(), threadId);
        } catch (CycleFound e) {
            //We must catch all exceptions that are thrown from within our thread
            //If exceptions "exit" the thread, the thread will silently fail
            //and we dont want that. We use 2 booleans instead, to indicate the status of the algorithm

            cycleFound = true;
        }

        //Either the algorithm was aborted because of a CycleFound exception
        //or we completed our Blue DFS without finding a cycle. We are done!
        done = true;
    }

    public void mcdfsBlue(State s, long id) throws CycleFound {
        if(done == true){
           return;
        }
        //System.out.printf("Thread %d begint nu aan een dfsblue\n", id);
        int i;
        int counter = 0;
        NDFSState state = stateStore.get(s);
        if(state == null){
                state = new NDFSState();
                stateStore.put(s,state);
        }
        state.setColor(id, Color.CYAN);
        List<State> children = graph.post(s);
        i = state.incNextBlue();
        while(counter != children.size()){
            NDFSState child = stateStore.get(children.get(i%children.size()));

            if(child == null){
                    child = new NDFSState();
                    stateStore.put(children.get(i % children.size()),child);
            }
            if(child.getLocalColor(id) == Color.WHITE && !child.isRed()){

                mcdfsBlue(children.get(i % children.size()), id);
            }
            i++;
            counter++;
        }
        if(s.isAccepting()){
            state.incRedDFSCount();
            mcdfsRed(s, id);
        }
        state.setColor(id, Color.BLUE);
    }

    public void mcdfsRed(State s, long id) throws CycleFound {
        if(done == true){
            return;
        }
        int i;
        int counter = 0;
        NDFSState state = stateStore.get(s);
        state.setPink(id, true);
        List<State> children = graph.post(s);
        i = state.incNextRed();
        while(counter != children.size()){
            NDFSState child = stateStore.get(children.get(i%children.size()));
            if(child == null){
                    child = new NDFSState();
                    stateStore.put(children.get(i%children.size()),child);
            }
            if(child.getLocalColor(id) == Color.CYAN){
                throw new CycleFound();
            }
            if(!child.isPink(id) && !child.isRed()){
                mcdfsRed(children.get(i%children.size()), id);
            }
            i++;
            counter++;
        }
        if(s.isAccepting()){
            state.decRedDFSCountAndWait();
        }
        state.setRed();
        state.setPink(id, false);
    }

}

public void init() {}

public void ndfs() throws Result {
    int i;
    done       = false;
    cycleFound = false;
    for(i=0;i<threadArray.length;i++){
            System.out.printf("Launch thread %d\n",i);
            threadArray[i].run();
    }

    try {
        for(i=0;i<threadArray.length;i++){
            threadArray[i].join();
        }
    } catch (InterruptedException e) {

    }

    //We want to show the result by throwing an exception (weird, but yeah :-/)
    if (cycleFound) {
      throw new CycleFound();
    } else {
      throw new NoCycleFound();
    }
} 
```

}

但是，当我运行它时，似乎第一个线程被调用，完成，然后下一个被调用等等。我显然想要的是所有线程同时启动！否则该算法几乎没有用......

感谢您的时间/帮助！

问候，

莱纳斯

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-22T13:46:42.080

用于`threadArray[i].start();`启动您的线程。

如果您使用`threadArray[i].run();`，它所做的只是在与调用者相同的线程中正常调用该方法。

# c# - 检查数据表中是否存在值？

> ID：10703320
> 
> 赞同：101
> 
> 时间：2012-05-22T13:44:17.897
> 
> 标签：c#, datatable

我有两列*Author*和*Bookname*的 DataTable 。

我想检查给定的字符串值*Author*是否已存在于 DataTable 中。是否有一些内置的方法来检查它，比如 Arrays `array.contains`？

* * *

## 回答 #1

> 赞同：224
> 
> 时间：2012-05-22T13:46:55.953

您可以[`LINQ-to-DataSet`](http://msdn.microsoft.com/en-us/library/bb386977.aspx)使用[`Enumerable.Any`](http://msdn.microsoft.com/en-us/library/bb534972.aspx)：

```
String author = "John Grisham";
bool contains = tbl.AsEnumerable().Any(row => author == row.Field<String>("Author")); 
```

另一种方法是使用[`DataTable.Select`](http://msdn.microsoft.com/en-us/library/det4aw50.aspx)：

```
DataRow[] foundAuthors = tbl.Select("Author = '" + searchAuthor + "'");
if(foundAuthors.Length != 0)
{
    // do something...
} 
```

* * *

> 问：如果我们不知道列 Headers 并且我们想查找`PEPSI`任何行的 c 列中是否存在任何单元格值怎么办？我可以全部循环以找出答案，但有更好的方法吗？——</p>

是的，您可以使用以下查询：

```
DataColumn[] columns = tbl.Columns.Cast<DataColumn>().ToArray();
bool anyFieldContainsPepsi = tbl.AsEnumerable()
    .Any(row => columns.Any(col => row[col].ToString() == "PEPSI")); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-05-22T13:46:37.680

您可以使用 Linq。就像是：

```
bool exists = dt.AsEnumerable().Where(c => c.Field<string>("Author").Equals("your lookup value")).Count() > 0; 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-05-22T13:49:34.823

```
DataRow rw = table.AsEnumerable().FirstOrDefault(tt => tt.Field<string>("Author") == "Name");
if (rw != null)
{
// row exists
} 
```

添加到您的 using 子句：

```
using System.Linq; 
```

并添加：

> System.Data.DataSetExtensions

参考。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-05-22T13:52:15.363

您应该能够使用[DataTable.Select()](http://msdn.microsoft.com/en-us/library/det4aw50.aspx)方法。你可以这样。

```
if(myDataTable.Select("Author = '" + AuthorName.Replace("'","''") + '").Length > 0)
    ... 
```

Select() 函数为与 where 语句匹配的结果返回一个 DataRows 数组。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-22T13:46:50.800

您可以将数据库设置为 IEnumberable 并使用 linq 检查值是否存在。看看这个链接

[对数据表进行 LINQ 查询以检查记录是否存在](https://stackoverflow.com/questions/6093560/linq-query-on-datatable-to-check-if-record-exists)

给出的例子是

```
var dataRowQuery= myDataTable.AsEnumerable().Where(row => ... 
```

你可以用任何补充 where

# linux - `$$` 在 ps 命令中代表什么？

> ID：10703324
> 
> 赞同：1
> 
> 时间：2012-05-22T13:44:28.987
> 
> 标签：linux

> **可能重复：**
> [$$ 在 shell 中是什么意思？](https://stackoverflow.com/questions/78493/what-does-mean-in-the-shell)

```
$ ./cruncher & ./cruncher & ./cruncher &
$ ps -C cruncher -p $$ -o pid,state,cmd
PID S CMD
2588 S bash
2657 R /bin/sh ./cruncher
2658 R /bin/sh ./cruncher
2659 R /bin/sh ./cruncher

-C cmdlist      Select by command name.
                       This selects the processes whose executable name is
                       given in cmdlist.

-p pidlist      Select by PID.
                       This selects the processes whose process ID numbers
                       appear in pidlist. 
```

**问题**> 是什么意思`$$`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T13:45:38.120

`ps`它与命令无关，由带有**进程 ID**`$$`的 shell 代替。

 *** * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T13:54:27.720

它是一个内置的 shell 变量，用于保存`PID`进程 ID。**

# javascript - 将 Highcharts 重置为初始状态

> ID：10703325
> 
> 赞同：5
> 
> 时间：2012-05-22T13:44:29.953
> 
> 标签：javascript, jquery, highcharts

使用预设选项创建我的 Highchart 效果很好：

```
chart = new Highcharts.Chart(options); 
```

但是，当我想销毁并重新创建图表时，它只会销毁。即使我删除`chart.destroy();`图表仍然只是完全空白但没有重新创建。

```
$('#resetChart').on("click", function(e){
    e.preventDefault();
    chart.destroy();
    chart = new Highcharts.Chart(options);
}); 
```

关于如何重置此图表有点卡在这里。

编辑：：

检查图表容器显示饼图在这里创建*了一些东西*，但似乎没有正确检索数据。即使在选项中设置了我的数据变量，我是否也需要再次传递它？

```
series: [{
                name: name,
                data: data,
                /* changes bar size */
                pointPadding: 0,
                borderWidth: 0,
                pointWidth: 15,
                shadow: false
        }] 
```

然后在页面上定义数据（对于我们的 CMS）：

```
<script type="text/javascript">
        data = [
            {
                y: {value},
                name: 'field1',
                id:'1'
            },
            {
                y: {value},
                name: 'field2',
                id:'2'
            },
            {
                y: {value},
                name: 'field3',
                id:'3'
            }
        ];
    </script> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-22T13:51:51.077

```
$('#resetChart').on("click", function(e){
    e.preventDefault();
    while(chart.series.length > 0) chart.series[0].remove(true);
    chart = new Highcharts.Chart(options);
}); 
```

[http://jsfiddle.net/tapkr/1](http://jsfiddle.net/tapkr/1)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-22T14:12:35.023

当您第一次创建图表时，您通过参数传递一些选项，您可以将它们保存到 var 中，当您想再次创建时，您可以使用与以下代码相同的选项。

```
var defaultOptions = {
    // your options
};

function drawDefaultChart() {
    chart = new Highcharts.Chart(defaultOptions);
}

drawDefaultChart();

$('#resetChart').on("click", function(e){
    e.preventDefault();
    chart.destroy();
    drawDefaultChart();
}); 
```

你可以看到它在**[这里](http://jsfiddle.net/tapkr/4/)**工作。

# vb.net - 这是如何运作的？

> ID：10703326
> 
> 赞同：-1
> 
> 时间：2012-05-22T13:44:31.237
> 
> 标签：vb.net

```
Protected Sub Button1_Click(ByVal sender As Object, ByVal e As System.EventArgs) _
    Handles Button1.Click  
    EmptyTextBoxValues(Me)  
End Sub  

Private Sub EmptyTextBoxValues(ByVal parent As Control)  
    For Each c As Control In parent.Controls  
        If (c.Controls.Count > 0) Then  
            EmptyTextBoxValues(c)  
        Else  
            If TypeOf c Is TextBox Then  
                CType(c, TextBox).Text = ""  
            End If  
        End If  
    Next  
End Sub 
```

* * *

此子用于清除所有文本框值，我只需要知道它是如何工作的？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T13:47:53.250

sub 递归调用所有`EmptyTextBoxValues`子控件（如果它们存在） - 如果不存在，它会检查它们是否是文本框，如果是，则清除它。

首先 - 它遍历属于传入控件的每个子控件：

```
For Each c As Control In parent.Controls 
```

然后它测试子控件是否有它自己的子控件，如果有，就用子控件调用它自己：

```
 If (c.Controls.Count > 0) Then  
        EmptyTextBoxValues(c) 
```

如果子控件上不存在这样的子控件，则测试控件的类型是否为 of `TextBox`，如果是，则将其清除：

```
 Else  
        If TypeOf c Is TextBox Then  
            CType(c, TextBox).Text = ""  
        End If 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T13:51:05.267

它遍历作为窗体的直接子级的所有控件，并检查每个控件是否都是 TextBox 控件。如果是这样，它将清除它。此外，它还会检查每个控件是否是包含更多子控件的容器控件。如果是这样，它会递归调用自己来处理所有这些子控件。

# android - 在 Android 中导入 Jama 库

> ID：10703330
> 
> 赞同：2
> 
> 时间：2012-05-22T13:44:41.887
> 
> 标签：android, android-layout, android-intent, android-widget

我正在尝试在我的 Android 应用程序中使用 Jama 库。但是虽然我在我的项目中导入了 Jama 的 jar，但我收到了这个错误：

```
java.lang.NoClassDefFoundError: Jama.Matrix 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T13:59:21.493

尝试创建一个名为的新文件夹`libs`并将 .jar 文件放在那里...

# codeigniter - 有没有办法 var_dump 一个变量？

> ID：10703332
> 
> 赞同：2
> 
> 时间：2012-05-22T13:44:50.197
> 
> 标签：codeigniter

我想 var_dump 一个变量来调试我的数据库操作。我不想安装任何调试器，所以我在模型中使用了 var_dump($result) 。它输出错误。

```
This page contains the following errors:

error on line 1 at column 1: Document is empty
Below is a rendering of the page up to the first error. 
```

怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T14:01:22.753

或者您可以使用[CI 的日志记录工具](http://codeigniter.com/user_guide/general/errors.html)：

```
log_message('debug', var_export($some_variable)); 
```

并检查您的应用程序的日志文件夹，通常是应用程序/日志。您可以在任何地方执行此操作 - 模型或控制器。

注意 - 检查 application/config/config.php 以确保启用日志记录。它不仅仅是一个开/关开关，您可以选择要记录的日志消息级别。例如，为开发设置为全部，但仅在生产中设置为错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T13:55:54.527

您应该将结果返回给控制器 - 然后在控制器内执行 var_dump($result) 。

我已经注意到几次你不能从模型中获取 var_dump() 。

# c# - 在 3 层应用程序中找不到类型或命名空间名称“Sclient”

> ID：10703336
> 
> 赞同：-3
> 
> 时间：2012-05-22T13:45:13.900
> 
> 标签：c#, asp.net, visual-studio-2010, three-tier

在尝试实现 3 层应用程序时，我复制粘贴了文件并在 10 分钟内完成了以下链接中的步骤。

[http://geekswithblogs.net/edison/archive/2009/04/05/a-simple-3-tier-layers-application-in-asp.net.aspx](http://geekswithblogs.net/edison/archive/2009/04/05/a-simple-3-tier-layers-application-in-asp.net.aspx)

但是我收到一个错误“找不到类型或命名空间名称'Sclient'”，我的客户端、配置和通用数据类位于 App_Code 文件夹中，并且我在 ClientList.ascx 第 6 行收到错误。

我的代码与链接中指示的完全相同，可能是什么错误原因？

下面是截图

![在此处输入图像描述](../Images/d6ba81123294def215845e8a50433efb.png)

![在此处输入图像描述](../Images/e33669b2b2e4ad4450023125ad17f561.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T06:58:03.110

右键单击项目并选择“转换为 Web 应用程序”

# javascript - 如果警报已经存在，确保警报框不会弹出的最佳方法是什么？

> ID：10703344
> 
> 赞同：0
> 
> 时间：2012-05-22T13:45:44.233
> 
> 标签：javascript

在javascript中，如果我有一个无限循环：

```
setInterval("popalert", 5000) 
```

在哪里`popalert()`简单地弹出一个警报框，如果已经有一个尚未关闭的警报框，那么最好的方法是使警报框不会弹出？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T13:48:55.757

无法检测到警报是否存在。

不使用`setInterval`，使用`setTimeout`。

警报发生后重置超时。

[jsfiddle 示例](http://jsfiddle.net/JePru/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T13:49:40.140

检测标准的 javascript 警报框是不可能的，因为它们非常简单。如果您继续生成它们，它们只会排队，在现代浏览器中，它实际上为您提供了在几个之后为某个页面禁止它们的选项。

如果任何时候不超过 1 个框对您很重要，我会考虑使用不同类型的通知系统。像[jQuery UI Dialog](http://jqueryui.com/demos/dialog/)这样的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T13:50:26.660

popalert 函数可以保存警报框的状态。

```
var bOpen = false; 
```

然后当它弹出时设置为真

如果它在按下 ok 后关闭或再次将其设置为 false。

当 popalert 再次被调用时，它会检查 bOpen 变量，如果它是真的，它就不会打开一个新的弹出窗口。

我也会使用 settimeout，所以你不会让这个无限循环的东西阻塞你的 gui。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T13:51:08.827

您无法检测到警报框是否已经存在。您的导航器管理此警报框，因此如果另一个已经在这里，它们将无法弹出。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-22T13:51:53.480

您可以使用全局 javascript 变量（在任何函数之外）并将此 var 最初设置为 false。如果调用了 popalert 函数，请检查全局 var 是否为 false。如果是这样，请弹出警报并将 var 设置为 true。这样做只会显示一个警报，但您的函数将一次又一次地执行（如果这很重要）。

# svn - Subversion 分支合并和树冲突

> ID：10703345
> 
> 赞同：1
> 
> 时间：2012-05-22T13:45:45.980
> 
> 标签：svn, merge, branch, branching-and-merging

一段时间以来，我一直是存储库中的单一开发人员。我有一个开发分支，我在其中进行编码，并将更改合并到`trunk`生产版本中。我现在有一个平面设计师，他正在添加级联样式表和图形。

我在我的开发分支上为他创建了一个分支，他在那个分支上做他的工作，而我在我的工作。我们都进行了更改，我成功地将它们合并到`trunk`. 我无法让他的更改合并回我的分支，反之亦然，因为我一直看到“树冲突”。

这让我相信我没有正确地进行分支和合并。是否有不同的模式可以缓解这些合并问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T14:23:09.747

将分支合并回主干时，您是否使用重新集成选项？根据[这组关于 merging 的说明](http://svnbook.red-bean.com/en/1.7/svn.branchmerge.basicmerging.html)，正确的流程是将您的分支重新集成回主干。

虽然您确实提到初始合并是成功的，但您表示在随后合并到主干时遇到问题。上面链接的站点还建议在重新集成后删除您的分支并重新创建它们。

> 一旦从分支到主干完成了 --reintegrate 合并，该分支就不再可用于进一步的工作。它无法正确吸收新的主干更改，也无法再次正确重新集成到主干。出于这个原因，如果您想继续处理您的功能分支，我们建议您将其销毁，然后从主干重新创建它

[请参阅这组关于合并的说明](http://svnbook.red-bean.com/en/1.7/svn.branchmerge.basicmerging.html)的“重新集成分支”部分。

# ios - 如何在非根控制器视图中创建导航控制器？

> ID：10703347
> 
> 赞同：0
> 
> 时间：2012-05-22T13:46:01.670
> 
> 标签：ios, xcode, uiview, uinavigationcontroller

我的应用程序设置是这样的：我有一个导航控制器（在应用程序委托中创建） View 1 --Push--->View2---Push--->View3 ---Modal transit（向上滑动）--- >View4 --->推送-->View5

我想要做的是在 View4 中创建一个新的导航控制器，以便我可以从 view5 推送到另一个视图

除了根视图控制器之外，我没有在视图中创建导航控制器的经验。

有人可以给我一些指导或说明如何实现它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T13:51:16.317

这是我的做法。

```
+ (UIViewController *)viewControllerWithNavigation
{
    id controller = [[**YOUR VIEW CONTROLLER** alloc] initWithNibName:**FOO** bundle:**BAR**];

    UINavigationController *navController = [[UINavigationController alloc] initWithRootViewController:controller];

    [controller release];
    return [navController autorelease];
} 
```

我使用以下方法在根视图控制器上呈现此视图：

```
UIViewController *controller = [**YOUR VIEW CONTROLLER** viewControllerWithNavigation];
[self.window.rootViewController presentViewController:controller animated:YES completion:NULL]; 
```

当然，您可以在任何您想要的视图上呈现 t

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T13:48:39.957

select view4 in your storyboard, and select the menu Editor -> Embeded In -> Navigation Controller. good luck.

# java - 用于隐藏类型特定实现的 Java 泛型？

> ID：10703348
> 
> 赞同：2
> 
> 时间：2012-05-22T13:46:08.133
> 
> 标签：java, generics, inheritance, polymorphism

我正在尝试创建一个 API，以便在其他程序员使用我的服务时不需要实现和类名。该服务对“项目”执行各种操作，但服务应如何处理对项目的请求的主要影响因素是基于用户类型。到目前为止，我有一个接口（`Item`）和一个实现服务（`ItemService`），然后是几个从这个扩展的用户类型类（例如`CompanyItemService`）。用户类型也具有超类`User`和子类的结构，例如`Company`：

```
public class ItemService<T extends User> extends Item {
    User user;
    public ItemService(User user) {
        this.user = user;
    }

    @Override
    public boolean belongsToUser() {
        //Check all records
    }
}

public class CompanyItemService<T extends Company> extends ItemService<Company> {
    public CompanyItemService(Company user) {
        super(user);
    }

    @Override
    public boolean belongsToUser() {
        //Check company specific records
    }
}

public class User {
    //Common user stuff
}

public class Company extends User {
    //Company specific stuff
} 
```

所以我希望能够通过如下调用使用我的服务：

```
User company = new Company();
//stuff
Item item = new ItemService<Company>(company)
item.belongsToUser(); 
```

但是，当我这样做时，`ItemService`将调用`CompanyItemService`. 是否有可能在不需要知道它属于类的情况下获得这个覆盖方法`CompanyItemService`？

干杯，

阿列克谢蓝。

所有这一切的一般想法是，当发明另一种用户类型时，如果需要，可以添加另一种用户特定的服务，而现有代码不受影响。而且，如果有很多用户类型，我只希望使用 API 的人必须记住使用`ItemService`泛型来完成其余的工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T13:48:59.640

You need to use the *[abstract factory pattern.](http://en.wikipedia.org/wiki/Abstract_factory_pattern)* In short, you need a static method someplace which knows about all the possible `ItemService` subclasses and, given an `Item` object or a `Class` which is a subclass of `User`, returns an instance of the correct `ItemService` subclass. In other words, something like

```
public static ItemService<?> instance(Class<? extends User> c) {
    if (c == Customer.class)
        return new CustomerItemService();
    else if (c == Employee.class)
        return new EmployeeItemService();
    ...
} 
```

Then you can say

```
ItemService<?> service = ItemService.instance(Customer.class); 
```

Alternatively, you could build a map:

```
Map<Class<? extends User>, Class<? extends ItemService>> services = 
    new HashMap<Class<? extends User>, Class<? extends ItemService>>() {{
    put(Customer.class, CustomerItemService.class);
    put(Employee.class, EmployeeItemService.class);
    // more...
}}; 
```

Then `instance()` could just look like

```
ItemService<? extends User> instance(Class<? extends User> c) {
    return services.get(c);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T13:56:56.380

代码可以正常工作。创建一个 ItemService 实例：

```
Item item = new ItemService<Company>(company); 
```

如果您调用 ItemService 的 belongsToUser() 方法，将被调用。您应该创建 CompanyItemService 的实例来调用它的方法。

# gwt - 在 GWT RichTextArea 中禁用上下文菜单

> ID：10703349
> 
> 赞同：2
> 
> 时间：2012-05-22T13:46:08.257
> 
> 标签：gwt, contextmenu, rich-text-editor

我正在 GWT 中开发一种所见即所得的编辑器。为了显示我自己的上下文菜单，我必须禁用默认浏览器的菜单。我通过简单地向 RichTextArea 元素添加一个属性（oncontextmenu = "return false;"）来做到这一点，这在 chrome 中效果很好，但在 FireFox 中却不行。

我一直在网上寻找可能的解决方案几个小时，但我无法工作。

我注意到，当向我的 RichTextArea 添加上下文菜单处理程序时，它永远不会被触发。

如果有人遇到过同样的问题并能指出我正确的方向，我将不胜感激。

# java - Spring Roo '遇到''void'''void''

> ID：10703350
> 
> 赞同：1
> 
> 时间：2012-05-22T13:46:12.007
> 
> 标签：java, spring, spring-roo

我正在阅读 Spring Roo 教程并学习如何向模型添加字段。我今天启动了我的计算机，当我在终端中启动 roo shell 时，它给了我这个错误：

```
Encountered " "void" "void "" at line 17, column 8.
Was expecting one of:
"class" ...
"enum" ...
"interface" ...
"@" ...
"@" ...
"@" ...
"@" ... 
```

我唯一的模型是 Course.java。它看起来像这样：

```
package matt.coursemanager.model;

import java.math.BigDecimal;
import java.util.Date;
import javax.persistence.EnumType;
import javax.persistence.Enumerated;
import javax.persistence.Temporal;
import javax.persistence.TemporalType;
import org.springframework.format.annotation.DateTimeFormat;
import org.springframework.roo.addon.javabean.RooJavaBean;
import org.springframework.roo.addon.jpa.activerecord.RooJpaActiveRecord;
import org.springframework.roo.addon.tostring.RooToString;

@RooJavaBean
@RooToString
@RooJpaActiveRecord
public class Course {

} 
```

第 17 行第 8 列是“public class Course {”行上的“class”中的“c”。

如果我尝试将任何字段添加到 Course 它会引发相同的错误（并且没有成功添加该字段）。我没有在 roo 会话之间进行任何更改，这只是在我打开 shell 时发生的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T03:26:11.900

我的问题是我从错误的目录运行 roo。我们使用 SVN 进行版本控制，我是在*包含*主干的目录中，而不是主干。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T04:07:14.377

存在编译错误。

也许您在编辑字段时输入了错误。

尝试解决它并重新打开 Roo shell。

最好的选择是使用 IDE，例如 STS。导入项目（如果您执行“执行 eclipse”，则作为一般项目，否则作为 maven 项目）

# html - C: 如何提取 HTML 页面的文档类型

> ID：10703351
> 
> 赞同：0
> 
> 时间：2012-05-22T13:46:12.907
> 
> 标签：html, c

我需要使用 C 或 C++ 提取可能是 XHTML、HTML html 或 WML***的 HTML 页面的文档类型。***我将以 HTML 文件或数组的形式提供输入。

如果 html 页面不包含标题，则结果应该与页面相关，例如 html result = html 或 xhtml result = xhtml....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:06:04.670

这似乎是两个不同的问题：

1）如何简单地从 html 页面中获取“doctype”声明，为此我将建议一些简单的东西，例如：

```
char doctype[1024];

void
get_doctype(char *html_page)
{
  sscanf(html_page, "<!DOCTYPE %1024s>", doctype);
} 
```

然后可能与已知`doctype`字符串匹配以获得枚举值。

但是您也在问 2) 如何检测没有 doctype 声明的页面类型。这更难，而且每一页可能有多个正确答案。我建议外包给像[libxml](http://www.xmlsoft.org/)这样的库。它具有将输入流验证为特定类型文档的功能。

# c++ - VS2010中如何设置Windows SDK目标版本？

> ID：10703352
> 
> 赞同：4
> 
> 时间：2012-05-22T13:46:14.943
> 
> 标签：c++, visual-studio-2010, winapi

我最近安装了 Windows 8 SDK 版本（8.0 和 8.0A）以及 VS2011 Beta。这使我所有的 VS2010 项目都尝试针对 Windows SDK 版本 8.0 而不是 7.1A（它们应该针对它们构建）进行构建。我试图弄清楚如何设置应该将哪个 SDK 用作目标版本。我找到了这个页面：

[http://msdn.microsoft.com/en-us/library/ff660764.aspx](http://msdn.microsoft.com/en-us/library/ff660764.aspx)

其中指出：

在 Visual Studio 2010 中使用 Windows SDK 工具

*   在 Visual Studio 2010 中，打开解决方案 (.sln) 文件或创建解决方案。
*   在解决方案资源管理器中，右键单击解决方案节点，然后单击属性。
*   在配置列表中，选择所有配置。
*   在配置属性下，选择常规。
*   作为 Platform Toolset 选项，选择 Windows7.1SDK。
*   单击确定。

但是配置属性下没有“常规”选项....有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T14:44:02.427

您发现的文档略有错误：它在*项目*属性中可用，而不是在解决方案属性中：

![平台工具集](../Images/443f5d9549ba46b96bb917896a16c569.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T13:52:13.913

如果[您](http://msdn.microsoft.com/en-us/library/aa383745%28v=vs.85%29.aspx) 在`WINVER`包含. 你试过这个吗？`_WIN32_WINNT``windows.h`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T13:53:12.063

我通常在解决方案范围内为 Windows XP SP3 定义以下预定义宏：

```
WINVER=0x0501
_WIN32_WINNT=0x0501
NTDDI_VERSION=0x05010300 
```

同样，您可以定义自己的 Windows 版本：[更多信息。](http://msdn.microsoft.com/en-us/library/aa383745%28v=vs.85%29.aspx)

# objective-c - 如果我将一个对象放入 NSDictionary 中，会有一个指向它的强指针吗？

> ID：10703359
> 
> 赞同：1
> 
> 时间：2012-05-22T13:46:41.147
> 
> 标签：objective-c, ios, automatic-ref-counting

如果我将一个对象放入 NSDictionary 中，会有一个指向它的强指针吗？我只是想确保它在我仍然需要它时不会被删除（使用 ARC）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T13:50:02.000

No they wont get deleted. Dictionaries and arrays retain your objects and release them as soon as they are themselves released or the objects are removed from them.

# semaphore - 将进程放入等待队列时中断

> ID：10703363
> 
> 赞同：1
> 
> 时间：2012-05-22T13:46:48.197
> 
> 标签：semaphore, interrupt, critical-section

> 假设有一个进程试图进入临界区，但由于它被其他进程占用，当前进程必须等待它。那么，当进程被添加到信号量的等待队列时，假设有一个中断来了（ex-battery finished），那么这个进程和等待队列会发生什么？

我认为由于电池已用完，因此此中断将具有最高优先级，因此将保存将进程置于等待队列中的进程的上下文，并将执行此路由的中断服务例程。

然后它将返回到将进程放入队列的进程。

请为此问题提供一些提示/建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-25T08:47:21.887

这非常依赖于硬件/操作系统，但是有一些想法：

正如评论中提到的，“电池用完”中断可能被认为是一种特殊情况，仅仅是因为机器可能会在不采取任何行动的情况下关闭，在这种情况下进程+队列将消失。然而，总的来说，假设一个非致命中断和一个正确挂起/恢复的操作系统，我认为这两个进程的执行不太可能有任何明显的影响。

在多核设置中，进程可能不会立即暂停。中断可以由不同的核心处理，您提到的任何一个过程都不​​会更明智。

在抢占式多任务操作系统中，也不能保证添加到队列的进程会在中断后立即恢复，调度程序可以决定激活当前处于临界区的进程或完全激活另一个进程。当进程将自己添加到信号量等待队列恢复时会发生什么取决于添加它的距离、队列的实现方式以及信号量处于什么状态。它可能永远不会进入等待队列因为它检测到另一个进程已经唤醒并离开了临界区，或者它可能是它完成将自己添加到队列中并像什么都没发生一样挂起......</p>

在具有协作多任务操作系统的单核/处理器机器中，我认为您在问题中描述的场景很可能是执行进程被暂停以处理中断，然后恢复，直到它完成将自身添加到队列中并屈服了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T21:40:32.653

这取决于实现，但从概念上讲，相同的操作进程应该同时执行将进程添加到等待队列和管理中断，因此被移动到等待的进程将被视为从等待队列中中断。

对于 Java，请参阅 API[`Thread.interrupt()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Thread.html#interrupt%28%29)

> 中断这个线程。
> 
> 除非当前线程正在中断自己，这总是允许的，否则会调用该线程的 checkAccess 方法，这可能会导致抛出 SecurityException。
> 
> **如果此线程在调用**Object 类的 wait()、wait(long) 或 wait(long, int) 方法或 join()、join(long)、join(long, int) 时被阻塞, sleep(long), or sleep(long, int), 这个类的方法，那么**它的中断状态将被清除，它会收到一个 InterruptedException**。
> 
> 如果此线程在可中断通道上的 I/O 操作中被阻塞，则通道将关闭，线程的中断状态将被设置，并且线程将收到 ClosedByInterruptException。
> 
> 如果此线程在 Selector 中被阻塞，则线程的中断状态将被设置，并且它将立即从选择操作返回，可能带有非零值，就像调用了选择器的唤醒方法一样。
> 
> 如果前面的条件都不成立，则将设置该线程的中断状态。
> 
> 中断一个不活动的线程不需要有任何效果。

# ruby-on-rails - Rails 的代码覆盖和多租户

> ID：10703365
> 
> 赞同：2
> 
> 时间：2012-05-22T13:46:50.030
> 
> 标签：ruby-on-rails, ruby-on-rails-3, multi-tenant

我即将使用 Ruby On Rails构建一个[多租户应用程序。](http://en.wikipedia.org/wiki/Multitenancy)每个客户端都将通过 YAML 文件（或最终存储在数据库中的任何东西，无论工作如何）拥有自己的个性化配置。鉴于销售流程和每个客户所需的配置数量，开发团队将构建配置文件。预期客户数少于 100。

您如何覆盖特定客户端的代码（控制器、视图、布局）（即：每个客户端一个模块？）如何在 Rails 中完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T15:45:24.880

您可以为每个客户拥有模块，并且在您的控制器内部，您可以动态地需要相应的模块。假设你有 current_user 实例，在 ApplicationCONtroller 中你可以有 before_filter 加载一个实例变量 @client_module 并且该变量可以在你的控制器内部使用来扩展你的控制器。您可能希望为每个控制器的每个客户端执行一个模块，以使生活更轻松

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T20:13:07.037

用路线做这个怎么样？

```
 get ":client/:controller/:action/:id" 
```

[从外向内](http://guides.rubyonrails.org/routing.html)研究路由以获得一些关于资源和命名空间的想法。

# lucene - 禁用 CMS 上的自定义索引。CD 索引会受到影响吗？

> ID：10703370
> 
> 赞同：0
> 
> 时间：2012-05-22T13:47:00.250
> 
> 标签：lucene, indexing, sitecore

我在 1 CA 和 3 CD 环境中为 Sitecore 中的几种模板类型设置了自定义 Lucene 索引。这在 CD 服务器上运行良好，但这似乎使 CMS 服务器超载。如果我在 CMS 上注释掉这个索引，它是否会影响 CD 服务器上的索引？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:51:18.907

它不应该影响 CD 服务器，除非您在两者之间有某种文件或配置复制，可能会移动索引文件或 sitecore 配置。

附带说明：lucene 索引部分对其运行的任何服务器都应该几乎没有影响（除非您可能有自定义索引器），所以我有点困惑，因为它会使 CMS 服务器过载。

# java - 如何在 Swing 中禁用第二次单击拆分窗格的一键式可扩展按钮？

> ID：10703378
> 
> 赞同：0
> 
> 时间：2012-05-22T13:47:18.247
> 
> 标签：java, swing, click, jsplitpane

我想禁用`JSplitpane`一键式可扩展按钮的第二次单击选项。

有什么属性可以禁用吗？

请帮我。提前致谢。

编辑：我尝试使用以下方法`BasicSplitPaneDivider`

```
protected JButton createLeftOneTouchButton() {
    JButton left = super.createLeftOneTouchButton();
    left.setEnabled(true);
    // left.doClick(1);
    // left.setMinimumSize(new Dimension(300,600));
    return left;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:09:39.397

AFAIK，不，没有快速简便的方法可以做到这一点。按钮是在`BasicSplitPaneDivider`'s`oneTouchExpandableChanged()`方法中一起创建的。

您可以通过创建自己的 实现来覆盖它`BasicSplitPaneDivider`，但随后您将进入使用 L&F 的混乱世界。

# ruby-on-rails - 如何使资产管道处理子目录中的图像

> ID：10703381
> 
> 赞同：1
> 
> 时间：2012-05-22T13:47:19.087
> 
> 标签：ruby-on-rails, asset-pipeline

我有一个 Rails 应用程序，它最初是 3.0.x 应用程序，最近升级到 3.2.2。图片位于 app/assets/images/ecommerce/new 中，当我在`rake assets:precompile`本地运行时，它们不会复制到 public/assets/。但是，当我将所有图像文件从 app/assets/images/ecommerce/new 复制到根图像资产路径（即 app/assets/imagens）并再次运行 rake 任务时，图像全部发送到 public/assets .

当我在生产模式下本地运行服务器时，它找不到图像，但是当我部署到 Engine Yard 时，它找到了。这很奇怪，你知道发生了什么吗？

资产管道不能处理 app/assets/images 子目录内的图像吗？我错过了什么吗？

以下是 config/environments/production.rb 的来源，关于资产管道的内容：

```
MyApp::Application.configure do
# Settings specified here will take precedence over those in config/application.rb

config.cache_classes = true

# Disable Rails's static asset server (Apache or nginx will already do this)
config.serve_static_assets = false

# Compress JavaScripts and CSS
config.assets.compress = true

# Don't fallback to assets pipeline if a precompiled asset is missed
config.assets.compile = true
config.assets.precompile += %w[*.png *.jpg *.jpeg *.gif] 

# Generate digests for assets URLs
config.assets.digest = true 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T17:11:05.450

config.assets.compile = true 是问题所在。这没有做你认为应该做的事情。这实际上告诉服务器按需编译。这或许可以解释为什么您有时会看到这些文件，而有时却没有。

如果要添加目录，请将它们添加到 config.assets.paths。

# c# - 附加属性以更新事件的样式触发器

> ID：10703384
> 
> 赞同：9
> 
> 时间：2012-05-22T13:47:24.390
> 
> 标签：c#, wpf

我正在尝试使用附加属性来触发`UIElement`事件触发时的样式更改。

以下是案例场景：

用户看到`TextBox`，然后聚焦然后取消聚焦。它在附加属性中的某处注意到此`LostFocus`事件并设置一个属性（某处？）来表示它`HadFocus`。

然后，TextBox 上的样式知道它应该根据这个 HadFocus 属性设置不同的样式。

这是我想象的标记的样子......

```
<TextBox Behaviors:UIElementBehaviors.ObserveFocus="True">
<TextBox.Style>
    <Style TargetType="TextBox">
        <Style.Triggers>
            <Trigger Property="Behaviors:UIElementBehaviors.HadFocus" Value="True">
                <Setter Property="Background" Value="Pink"/>
            </Trigger>
        </Style.Triggers>
    </Style>
</TextBox.Style> 
```

我已经尝试了一些附加属性的组合来使其正常工作，我最近的尝试抛出了一条`XamlParseException`声明**“触发器上的属性不能为空”。**

```
 public class UIElementBehaviors
{
    public static readonly DependencyProperty ObserveFocusProperty =
        DependencyProperty.RegisterAttached("ObserveFocus",
                                            typeof (bool),
                                            typeof (UIElementBehaviors),
                                            new UIPropertyMetadata(false, OnObserveFocusChanged));
    public static bool GetObserveFocus(DependencyObject obj)
    {
        return (bool) obj.GetValue(ObserveFocusProperty);
    }
    public static void SetObserveFocus(DependencyObject obj, bool value)
    {
        obj.SetValue(ObserveFocusProperty, value);
    }

    private static void OnObserveFocusChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
        var element = d as UIElement;
        if (element == null) return;

        element.LostFocus += OnElementLostFocus;
    }
    static void OnElementLostFocus(object sender, RoutedEventArgs e)
    {
        var element = sender as UIElement;
        if (element == null) return;

        SetHadFocus(sender as DependencyObject, true);

        element.LostFocus -= OnElementLostFocus;
    }

    private static readonly DependencyPropertyKey HadFocusPropertyKey =
        DependencyProperty.RegisterAttachedReadOnly("HadFocusKey",
                                                    typeof(bool),
                                                    typeof(UIElementBehaviors),
                                                    new FrameworkPropertyMetadata(false));

    public static readonly DependencyProperty HadFocusProperty = HadFocusPropertyKey.DependencyProperty;
    public static bool GetHadFocus(DependencyObject obj)
    {
        return (bool)obj.GetValue(HadFocusProperty);
    }

    private static void SetHadFocus(DependencyObject obj, bool value)
    {
        obj.SetValue(HadFocusPropertyKey, value);
    }
} 
```

谁能指导我？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T14:02:03.493

注册一个只读依赖属性并不意味着添加`Key`到属性名称。只需更换

```
DependencyProperty.RegisterAttachedReadOnly("HadFocusKey", ...); 
```

经过

```
DependencyProperty.RegisterAttachedReadOnly("HadFocus", ...); 
```

因为`HadFocus`是属性的名称。

# jquery - jQuery Mobile Collapsible Sets, Open Multiple at Once?

> ID：10703395
> 
> 赞同：3
> 
> 时间：2012-05-22T13:48:00.093
> 
> 标签：jquery, jquery-mobile

Is it possible to use the style of the Collapsible Set widget from jQuery mobile but have it function like a normal collapsible(e.g. allow more then one collapsible to be open at once within the collapsible set)?

[http://jquerymobile.com/demos/1.1.0/docs/content/content-collapsible-set.html](http://jquerymobile.com/demos/1.1.0/docs/content/content-collapsible-set.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T12:32:34.033

是的，这是可能的，但你必须像这样破解你的方式：

```
$('.YOUR_COLLAPSIBLE_CLASS.ui-collapsible.ui-collapsible-collapsed')
    .attr('data-collapsed',false).removeClass("ui-collapsible-collapsed")
    .find('.ui-collapsible-content').removeClass('ui-collapsible-content-collapsed'); 
```

您可以在一组中使用任意数量的可折叠项来执行此操作。不过，您必须以某种方式识别可折叠物品。

我在一个表单中执行此操作，因此我从错误的表单字段开始，并逐步完成可折叠集：

```
var el = my_faulty_form_field;

el.attr('placeholder', YOUR_ERROR_MSG)
    .closest('.ui-collapsible.ui-collapsible-collapsed')
      .attr('data-collapsed',false).removeClass("ui-collapsible-collapsed")
        .find('.ui-collapsible-content').removeClass('ui-collapsible-content-collapsed'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-18T13:03:02.207

另一个使用小技巧但没有任何类属性操作的解决方案是声明一个新的小部件扩展`collapsible-set`并取消绑定不需要的事件处理程序。

```
$.widget( "mobile.collapsiblegroup", $.mobile.collapsibleset, {
    options: {
        initSelector: ":jqmData(role='collapsible-group')"
    },
    _create: function() {
        $.mobile.collapsibleset.prototype._create.call(this);
        var $el = this.element;
        if (!$el.jqmData('collapsiblebound2')) {
            $el.jqmData('collapsiblebound2', true)
                .unbind('expand')
                .bind('expand', $._data($el.get(0), 'events')['collapse'][0]);
        }
    }
});

//auto self-init widgets
$( document ).bind( "pagecreate create", function( e ) {
    $.mobile.collapsiblegroup.prototype.enhanceWithin( e.target );
}); 
```

要使用它，只需将`data-role`改为`collapsible-group`代替`collapsible-set`。

* * *

**注意**：这仅适用于 jQuery 1.8+，旧版本更改

`$._data($el.get(0), 'events')`至`$el.data('events')`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-12-01T07:22:29.580

对频繁回答的补充说明：

```
$('.YOUR_COLLAPSIBLE_CLASS.ui-collapsible.ui-collapsible-collapsed')
    .attr('data-collapsed',false).removeClass("ui-collapsible-collapsed")
    .find('.ui-collapsible-content').removeClass('ui-collapsible-content-collapsed'); 
```

我添加了这两行：

```
$( '.YOUR_COLLAPSIBLE_CLASS h2' ).removeClass( 'ui-collapsible-heading-collapsed' );
$( '.YOUR_COLLAPSIBLE_CLASS h2 a' ).removeClass( 'ui-icon-plus' ).addClass( 'ui-icon-minus' ); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-11T14:42:56.143

您可以使用[Collapsibles](http://view.jquerymobile.com/1.3.1/dist/demos/widgets/collapsibles/#Setofindividualcollapsibles)而不是 Collapsible Set 或 Accordion。

> 与“可折叠集”的不同之处在于可以一次打开多个可折叠行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-13T12:31:15.507

这可以通过在主事件完成后停止事件传播来完成。

```
$('.collaps').bind('expand', function (evt) {
  evt.stopImmediatePropagation();
})

$('.collaps').bind('collapse', function (evt) {
  evt.stopImmediatePropagation();
}); 
```

collaps 是您赋予集合中所有可折叠项的类的名称。然后打开和关闭一个不影响其余的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-27T13:18:18.147

感谢您的解决方案 - 尽管我必须进行一些小改动才能使其正常工作：

`stopImmediatePropagation`停止任何要执行的处理程序，因此没有任何扩展或折叠。

使用`stopPropagation();`为我完成了这项工作：

```
$('.collaps').bind('expand', function (evt) {
  evt.stopPropagation();
});

$('.collaps').bind('collapse', function (evt) {
  evt.stopPropagation();
}); 
```

# objective-c - Accessing a song loaded with AVPlayer

> ID：10703396
> 
> 赞同：0
> 
> 时间：2012-05-22T13:48:04.273
> 
> 标签：objective-c, save, nsdata, avplayer

I want to save a song that I loaded with method - (id)initWithURL: of AVPlayer, so I don't need to load it next time I want to play it. I've spent hours browsing Apple documentation, but haven't found a solution.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T17:23:16.780

如果您有 URL，则可以简单地使用其中一个`NSURLConnection`或类似的类将 URL 下载到本地存储。`AVPlayer`但是，不会为您执行此操作 - 您必须手动执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T17:50:26.460

正如@iKenndac 所说，你不能从 AVPlayer 中得到这个。您可以自己下载文件并将其存储到磁盘，但您将失去 AVPlayer 在下载歌曲和开始播放歌曲方面提供的所有优化。当然，下次您播放歌曲时，您将获得已将歌曲保存在磁盘上的好处。如果这种权衡对你来说很好，那么在你的 NSURLConnection 回调中会做这样的事情：

```
- (void)connection:(NSURLConnection *)connection
    didReceiveData:(NSData *)data 
{
    [responseData appendData:data];
}

- (void)connectionDidFinishLoading:(NSURLConnection *)connection
{
    NSFileHandle *myHandle = [NSFileHandle fileHandleForUpdatingAtPath:someFilePath];
    [myHandle writeData:responseData];
    [myHandle synchronizeFile];
    [myHandle closeFile];           
} 
```

您必须将 responseData 定义为 NSMutableData 对象，并确保在调用 appendData 之前对其进行初始化。

# bash - shell脚本中双括号的问题

> ID：10703403
> 
> 赞同：2
> 
> 时间：2012-05-22T13:48:36.460
> 
> 标签：bash, shell

我有一个执行的 shell 脚本。在脚本中我有：

```
if [[ $variable == *something* ]]; then
   do something
fi 
```

我的问题是运行脚本返回“[[未找到”。

从阅读其他答案来看，似乎并非所有 shell 都能识别双括号，但是，我不确定解决方案是什么，该代码的等价物是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T13:51:39.177

听起来您的外壳是 POSIX `sh`，它没有`[[`内置。`sh`可能的解决方案包括将其转换为适用于或将 shebang 行更改为的表达式`#!/bin/bash`。改变shebang通常是最好的解决方案。

`sh`如果你在 Ubuntu 上，你可能有一个 POSIX ，他们使用破折号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T13:52:47.240

我只知道一个括号，你试过每个只用一个括号吗？否则你可以`test`改用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T14:40:58.023

POSIX 标准解决方案：

```
if test echo "${variable}" | grep -q 'something' 
then
   # do something
fi 
```

这将始终有效:)

# silverlight - Custom Sort Comparer Silverlight Datagrid

> ID：10703409
> 
> 赞同：2
> 
> 时间：2012-05-22T13:48:53.713
> 
> 标签：silverlight, xaml, sorting, datagrid

I have a Silverlight Toolkit datagrid where one column shows textual representation of a numeric value. I would like to sort on the column's underlying numeric value but present the text data to the user. Values in the grid column are in a format such as:

*   A Category (200-300)
*   Some Category (100-200)
*   Yet Another Category (300-400)

As these values are textual the grid is correctly sorting on the text, however I have a custom Comparer which can already sort these by the numeric categories and would like to plug it into the grid.

The data-object that the grid cell is binding to only has the textual representation (and no way of easily adding the numeric value). Therefore, SortMemberPath= won't work in this case.

Is it possible to inject a custom comparer for a single grid column and sort on that? Or perhaps implement a CollectionViewSource with custom comparer? Remember this is Silverlight, not WPF so some fields/properties/classes are missing when compared to WPF.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T06:48:34.700

The simplest way I feel to achieve this is to add two properties to entity that you are binding to grid one will be the text and the other can be numeric and binding only one to column of grid and other you can use in SortMemberPath. If not two properties you want to keep in entity then, you can keep Numeric only and use converter to convert it into text and SortMemberPath=NumericPropertyName.

# c - LD_PRELOAD not working with my program

> ID：10703413
> 
> 赞同：2
> 
> 时间：2012-05-22T13:49:02.647
> 
> 标签：c, linux, gcc, x86-64, ld-preload

For testing LD_PRELOAD, I wrote my own `getpid`, which prints something before calling the original `getpid` using dlsym. The code is given below.

```
#define _GNU_SOURCE

#include <unistd.h>
#include <stdio.h>
#include <dlfcn.h>

typedef pid_t (*getpidType)(void);

pid_t getpid(void)
{
    printf("Hello, getpid!\n");
    getpidType f = (getpidType)dlsym(RTLD_NEXT, "getpid");
    return f();
} 
```

However when I use such `getpid` in my program and run it using LD_PRELOAD, by typing `LD_PRELOAD=./prelib.so ./prog`, I get the following error.

```
./prog: symbol lookup error: ./prelib.so: undefined symbol: dlsym 
```

But If I do `LD_PRELOAD=./prelib.so bash -c 'echo $$'`, there is no such error. Any idea what is going on here.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T14:17:51.843

`libdl.so.2`通过`-ldl`在makefile中使用链接它解决了这个问题。

# java - 在 JAVA 中使用 PKCS #7 对数据进行签名

> ID：10703416
> 
> 赞同：13
> 
> 时间：2012-05-22T13:49:07.897
> 
> 标签：java, cryptography, pkcs#7

我想`.exe`使用 PKCS#7 签署一个文本文件（将来可能是一个文件或其他东西）并使用 Java 验证签名。

1.  我需要知道什么？
2.  我在哪里可以找到 API（`.jar`和文档）？
3.  为了签署数据和验证数据，我需要遵循哪些步骤？

如果可能，请提供我的代码片段。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-23T10:48:39.770

我认为您需要以下 2 个 Bouncy Castle 罐子来生成 PKCS7 数字签名：

*   bcprov-jdk15on-147.jar（适用于 JDK 1.5 - JDK 1.7）

*   bcmail-jdk15on-147.jar（适用于 JDK 1.5 - JDK 1.7）

[您可以从这里](http://bouncycastle.org/latest_releases.html)下载 Bouncy Castle 罐子。

您需要使用公钥和私钥对设置您的密钥库。您只需要生成数字签名的私钥和验证它的公钥。

以下是您对 pkcs7 内容进行签名的方式（为简洁起见，省略了异常处理）：

```
import java.io.FileInputStream;
import java.io.InputStream;
import java.security.KeyStore;
import java.security.PrivateKey;
import java.security.Security;
import java.security.cert.Certificate;
import java.security.cert.X509Certificate;
import java.util.ArrayList;
import java.util.List;
import org.bouncycastle.cert.jcajce.JcaCertStore;
import org.bouncycastle.cms.CMSProcessableByteArray;
import org.bouncycastle.cms.CMSSignedData;
import org.bouncycastle.cms.CMSSignedDataGenerator;
import org.bouncycastle.cms.CMSTypedData;
import org.bouncycastle.cms.jcajce.JcaSignerInfoGeneratorBuilder;
import org.bouncycastle.jce.provider.BouncyCastleProvider;
import org.bouncycastle.operator.ContentSigner;
import org.bouncycastle.operator.jcajce.JcaContentSignerBuilder;
import org.bouncycastle.operator.jcajce.JcaDigestCalculatorProviderBuilder;
import org.bouncycastle.util.Store;
import org.bouncycastle.util.encoders.Base64;

public final class PKCS7Signer {

    private static final String PATH_TO_KEYSTORE = "/path/to/keyStore";
    private static final String KEY_ALIAS_IN_KEYSTORE = "My_Private_Key";
    private static final String KEYSTORE_PASSWORD = "MyPassword";
    private static final String SIGNATUREALGO = "SHA1withRSA";

    public PKCS7Signer() {
    }

    KeyStore loadKeyStore() throws Exception {

        KeyStore keystore = KeyStore.getInstance("JKS");
        InputStream is = new FileInputStream(PATH_TO_KEYSTORE);
        keystore.load(is, KEYSTORE_PASSWORD.toCharArray());
        return keystore;
    }

    CMSSignedDataGenerator setUpProvider(final KeyStore keystore) throws Exception {

        Security.addProvider(new BouncyCastleProvider());

        Certificate[] certchain = (Certificate[]) keystore.getCertificateChain(KEY_ALIAS_IN_KEYSTORE);

        final List<Certificate> certlist = new ArrayList<Certificate>();

        for (int i = 0, length = certchain == null ? 0 : certchain.length; i < length; i++) {
            certlist.add(certchain[i]);
        }

        Store certstore = new JcaCertStore(certlist);

        Certificate cert = keystore.getCertificate(KEY_ALIAS_IN_KEYSTORE);

        ContentSigner signer = new JcaContentSignerBuilder(SIGNATUREALGO).setProvider("BC").
                build((PrivateKey) (keystore.getKey(KEY_ALIAS_IN_KEYSTORE, KEYSTORE_PASSWORD.toCharArray())));

        CMSSignedDataGenerator generator = new CMSSignedDataGenerator();

        generator.addSignerInfoGenerator(new JcaSignerInfoGeneratorBuilder(new JcaDigestCalculatorProviderBuilder().setProvider("BC").
                build()).build(signer, (X509Certificate) cert));

        generator.addCertificates(certstore);

        return generator;
    }

    byte[] signPkcs7(final byte[] content, final CMSSignedDataGenerator generator) throws Exception {

        CMSTypedData cmsdata = new CMSProcessableByteArray(content);
        CMSSignedData signeddata = generator.generate(cmsdata, true);
        return signeddata.getEncoded();
    }

    public static void main(String[] args) throws Exception {

        PKCS7Signer signer = new PKCS7Signer();
        KeyStore keyStore = signer.loadKeyStore();
        CMSSignedDataGenerator signatureGenerator = signer.setUpProvider(keyStore);
        String content = "some bytes to be signed";
        byte[] signedBytes = signer.signPkcs7(content.getBytes("UTF-8"), signatureGenerator);
        System.out.println("Signed Encoded Bytes: " + new String(Base64.encode(signedBytes)));
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-22T19:32:09.173

PKCS#7 现在称为 CMS（加密消息语法），您将需要 Bouncy Castle PKIX 库来创建一个。它有充足的文档和完善的邮件列表。

我不会提供代码片段，这违反了家规。先自己试试。

# sql - ORACLE SQL Compare Year Range Trigger

> ID：10703417
> 
> 赞同：-1
> 
> 时间：2012-05-22T13:49:10.067
> 
> 标签：sql, database, oracle, triggers

Trying to get Oracle to Get a date set it to year only and compare to a value inserted or updated into my database before hand This is what I have tried so far. But I seem to be stuck Any assistance would be great, Thanks

```
create or replace
TRIGGER CHECK_YEAR_DIFF
BEFORE INSERT OR UPDATE OF YEAROFPERSON ON PERSON 
FOR EACH ROW 

Currentdate Date; 
Playeryrborn_Var Integer;

Begin

Currentdate := TRUNC(Sysdate,'YYYY');
YEAROFPERSON_var := new.YEAROFPERSON;

  IF (currentDate - YEAROFPERSON_var <= 40) AND (currentDate - YEAROFPERSON_var => 16) THEN 

  dbms_Output.Put_Line('Year of Birth Updated Successfully');

  ELSE

  dbms_output.put_line('Year of Birth Failed to Successfully Update');

  END IF;

END; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T13:52:32.717

我认为您需要更改行： currentDate - YEAROFPERSON_var <= 40

至：

```
cast(to_char(sysdate, 'YYYY') as int) - YearOfPerson_Var <= 40 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T09:54:01.230

IF (currentDate - YEAROFPERSON_var <= 40) AND (currentDate - YEAROFPERSON_var => 16)

替换为以下内容

IF (currentDate - YEAROFPERSON_var <= 40) AND (currentDate - YEAROFPERSON_var >= 16)

# sql - SQL Server - copy stored procedures from one db to another

> ID：10703424
> 
> 赞同：95
> 
> 时间：2012-05-22T13:49:20.977
> 
> 标签：sql, sql-server-2008, copy, procedures

I am new to SQL, and what I needed to do was to combine 2 .mdf databases into one. I did that using SQL Server 2008 Manager - Tasks > Import/Export tables.The tables and views were copied successfully, but there are no Stored procedures in the new database. Is there any way to do that?

* * *

## 回答 #1

> 赞同：144
> 
> 时间：2012-05-22T13:51:46.127

*   右键单击数据库
*   任务
*   生成脚本
*   选择要编写脚本的对象
*   脚本文件
*   针对目标数据库运行生成的脚本

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-10-28T12:06:00.160

此代码将主数据库中的所有存储过程复制到目标数据库，您可以通过过滤过程名称的查询来仅复制您喜欢的过程。

@sql 定义为 nvarchar(max)，@Name 是目标数据库

```
DECLARE c CURSOR FOR 
   SELECT Definition
   FROM [ResiDazeMaster].[sys].[procedures] p
   INNER JOIN [ResiDazeMaster].sys.sql_modules m ON p.object_id = m.object_id

OPEN c

FETCH NEXT FROM c INTO @sql

WHILE @@FETCH_STATUS = 0 
BEGIN
   SET @sql = REPLACE(@sql,'''','''''')
   SET @sql = 'USE [' + @Name + ']; EXEC(''' + @sql + ''')'

   EXEC(@sql)

   FETCH NEXT FROM c INTO @sql
END             

CLOSE c
DEALLOCATE c 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-02-20T19:53:40.107

我最初发现这篇文章是在寻找将存储过程从远程生产数据库复制到本地开发数据库的解决方案。在成功使用此线程中建议的方法后，我意识到我变得越来越懒惰（或足智多谋，无论你喜欢哪个），并希望它能够自动化。我遇到了[这个链接](https://gist.github.com/vincpa/1755925)，它被证明是非常有帮助的（谢谢你 vincpa），我扩展了它，得到了以下文件（schema_backup.ps1）：

```
$server             = "servername"
$database           = "databaseName"
$output_path        = "D:\prod_schema_backup"
$login = "username"
$password = "password"

$schema             = "dbo"
$table_path         = "$output_path\table\"
$storedProcs_path   = "$output_path\stp\"
$views_path         = "$output_path\view\"
$udfs_path          = "$output_path\udf\"
$textCatalog_path   = "$output_path\fulltextcat\"
$udtts_path         = "$output_path\udtt\"

[System.Reflection.Assembly]::LoadWithPartialName("Microsoft.SqlServer.ConnectionInfo")  | out-null
[System.Reflection.Assembly]::LoadWithPartialName("Microsoft.SqlServer.SMO") | out-null
[System.Reflection.Assembly]::LoadWithPartialName("Microsoft.SqlServer.SmoExtended")  | out-null
$srvConn = new-object Microsoft.SqlServer.Management.Common.ServerConnection
$srvConn.ServerInstance = $server
$srvConn.LoginSecure = $false
$srvConn.Login = $login
$srvConn.Password = $password
$srv        = New-Object Microsoft.SqlServer.Management.SMO.Server($srvConn)
$db         = New-Object ("Microsoft.SqlServer.Management.SMO.Database")
$tbl        = New-Object ("Microsoft.SqlServer.Management.SMO.Table")
$scripter   = New-Object Microsoft.SqlServer.Management.SMO.Scripter($srvConn)

# Get the database and table objects
$db = $srv.Databases[$database]

$tbl            = $db.tables | Where-object { $_.schema -eq $schema  -and -not $_.IsSystemObject } 
$storedProcs    = $db.StoredProcedures | Where-object { $_.schema -eq $schema -and -not $_.IsSystemObject } 
$views          = $db.Views | Where-object { $_.schema -eq $schema } 
$udfs           = $db.UserDefinedFunctions | Where-object { $_.schema -eq $schema -and -not $_.IsSystemObject } 
$catlog         = $db.FullTextCatalogs
$udtts          = $db.UserDefinedTableTypes | Where-object { $_.schema -eq $schema } 

# Set scripter options to ensure only data is scripted
$scripter.Options.ScriptSchema  = $true;
$scripter.Options.ScriptData    = $false;

#Exclude GOs after every line
$scripter.Options.NoCommandTerminator   = $false;
$scripter.Options.ToFileOnly            = $true
$scripter.Options.AllowSystemObjects    = $false
$scripter.Options.Permissions           = $true
$scripter.Options.DriAllConstraints     = $true
$scripter.Options.SchemaQualify         = $true
$scripter.Options.AnsiFile              = $true

$scripter.Options.SchemaQualifyForeignKeysReferences = $true

$scripter.Options.Indexes               = $true
$scripter.Options.DriIndexes            = $true
$scripter.Options.DriClustered          = $true
$scripter.Options.DriNonClustered       = $true
$scripter.Options.NonClusteredIndexes   = $true
$scripter.Options.ClusteredIndexes      = $true
$scripter.Options.FullTextIndexes       = $true

$scripter.Options.EnforceScriptingOptions   = $true

function CopyObjectsToFiles($objects, $outDir) {
    #clear out before 
    Remove-Item $outDir* -Force -Recurse
    if (-not (Test-Path $outDir)) {
        [System.IO.Directory]::CreateDirectory($outDir)
    }   

    foreach ($o in $objects) { 

        if ($o -ne $null) {

            $schemaPrefix = ""

            if ($o.Schema -ne $null -and $o.Schema -ne "") {
                $schemaPrefix = $o.Schema + "."
            }

            #removed the next line so I can use the filename to drop the stored proc 
            #on the destination and recreate it
            #$scripter.Options.FileName = $outDir + $schemaPrefix + $o.Name + ".sql"
            $scripter.Options.FileName = $outDir + $schemaPrefix + $o.Name
            Write-Host "Writing " $scripter.Options.FileName
            $scripter.EnumScript($o)
        }
    }
}

# Output the scripts
CopyObjectsToFiles $tbl $table_path
CopyObjectsToFiles $storedProcs $storedProcs_path
CopyObjectsToFiles $views $views_path
CopyObjectsToFiles $catlog $textCatalog_path
CopyObjectsToFiles $udtts $udtts_path
CopyObjectsToFiles $udfs $udfs_path

Write-Host "Finished at" (Get-Date)
$srv.ConnectionContext.Disconnect() 
```

我有一个调用它的 .bat 文件，并从任务计划程序调用。调用 Powershell 文件后，我有：

```
for /f %f in ('dir /b d:\prod_schema_backup\stp\') do sqlcmd /S localhost /d dest_db /Q "DROP PROCEDURE %f" 
```

该行将通过目录并删除将要重新创建的过程。如果这不是一个开发环境，我不希望以这种方式以编程方式删除程序。然后，我将所有存储过程文件重命名为 .sql：

```
powershell Dir d:\prod_schema_backup\stp\ | Rename-Item -NewName { $_.name + ".sql" } 
```

然后运行：

```
for /f %f in ('dir /b d:\prod_schema_backup\stp\') do sqlcmd /S localhost /d dest_db /E /i "%f".sql 
```

这会遍历所有 .sql 文件并重新创建存储过程。我希望这其中的任何部分都会对某人有所帮助。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-08-07T08:08:55.213

迟到了，但提供了更多可能有用的细节……</p>

这是您可以利用优点和缺点做的事情的列表

**使用 SSMS 生成脚本**

*   **优点：**非常易于使用且默认支持
*   **缺点：**脚本的执行顺序可能不正确，如果辅助数据库上已存在存储过程，您可能会收到错误。确保在执行之前查看脚本。

**第三方工具**

*   **优点：**[ApexSQL Diff](http://www.apexsql.com/sql_tools_diff.aspx)等工具（这是我使用的，但还有许多其他工具，例如 Red Gate 或 Dev Art 的工具）将一键比较两个数据库并生成可以立即执行的脚本
*   **缺点：**这些不是免费的（尽管大多数供应商都有功能齐全的试用版）

**系统视图**

*   **优点：**您可以轻松查看辅助服务器上存在哪些存储过程，并且只生成那些您没有的存储过程。
*   **缺点：**需要更多的 SQL 知识

以下是如何获取某个数据库中不存在于另一个数据库中的所有过程的列表

```
select *
from DB1.sys.procedures P
where P.name not in 
 (select name from DB2.sys.procedures P2) 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-05-22T13:55:54.067

利用

```
select * from sys.procedures 
```

展示您的所有程序；

```
sp_helptext @objname = 'Procedure_name' 
```

获取代码

和你的创造力来构建一些东西来循环它们并生成导出代码:)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-05-22T13:52:23.880

您可以使用 SSMS 的“生成脚本...”功能来编写您需要传输的任何内容。右键单击 SSMS 中的源数据库，选择“生成脚本...”，然后按照向导进行操作。然后运行您生成的脚本，该脚本现在将包含存储过程创建语句。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-05-22T14:01:42.620

您可以生成存储过程的脚本，如其他答案中所述。生成脚本后，您可以使用`sqlcmd`它们来针对目标数据库执行它们，例如

```
sqlcmd -S <server name> -U <user name> -d <DB name> -i <script file> -o <output log file> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-03-26T13:58:05.250

另一种选择是使用**SQL Server Integration Services (SSIS)**传输存储过程。有一个名为**Transfer SQL Server Objects Task**的任务。您可以使用该任务转移以下项目：

*   表
*   意见
*   存储过程
*   用户定义的函数
*   默认值
*   用户定义的数据类型
*   分区函数
*   分区方案
*   模式
*   组件
*   用户定义的聚合
*   用户定义的类型
*   XML 模式集合

这是传输 SQL Server 对象任务的[图形教程](https://www.tutorialgateway.org/transfer-sql-server-tables-with-data-in-ssis/)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-10-24T10:42:28.873

SELECT 定义 + char(13) + 'GO' FROM MyDatabase.sys.sql_modules s INNER JOIN MyDatabase.sys.procedures p ON [s].[object_id] = [p].[object_id] WHERE p.name LIKE 'Something% '" queryout "c:\SP_scripts.sql -S MyInstance -T -t -w

获取 sp 并执行

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-05-22T13:52:43.123

在 Mgmt Studio 中，右键单击您的原始数据库，然后单击 Tasks，然后单击 Generate Scripts... - 按照向导进行操作。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2022-02-01T19:11:45.327

```
-- This program copies (CREATE OR ALTER) a single PROCEDURE from one database to another
declare @SourceDatabase nvarchar(50);
declare @SourceSchemaName nvarchar(50)
declare @TargetDatabase nvarchar(50);
declare @ProceduresName nvarchar(50);
declare @sql nvarchar(max) 

set @SourceDatabase =   N'Northwind'        -- The name of the source database
set @SourceSchemaName = N'dbo'              -- The name of Procedure  SCHEME
set @ProceduresName =   N'CustOrderHist'    -- The name of Procedure   
set @TargetDatabase =   N'AdventureWorks'   -- The name of the Target database
-- -------- - - -  

-- If the PROCEDURE SCHEME does not exist, create it
set @sql = ' use [' +@TargetDatabase +'] ' +
            ' IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = ''' + @SourceSchemaName+''') '+
            ' BEGIN ' +
            '   EXEC('' CREATE SCHEMA '+ @SourceSchemaName +''') ' +
            ' END'

exec (@sql);

set @sql = ''
-- 
set @sql = @sql + ' use [' + @TargetDatabase +'] ;' +
                    ' declare @sql2 nvarchar(max) ;' + 
                    ' SELECT @sql2 = coalesce(@sql2,'';'' ) + [definition] + '' ; '' ' +
                    ' FROM  ['+@sourceDatabase+'].[sys].[procedures] p '  +
                    ' INNER JOIN ['+@sourceDatabase+'].sys.sql_modules m ON p.object_id = m.object_id '+
                    ' where SCHEMA_NAME([schema_id]) = ''' +@SourceSchemaName +''' and [name] = N''' + @ProceduresName + '''  ; ' +
                    ' set @sql2 = replace(@sql2,''CREATE PROCEDURE'',''CREATE OR ALTER PROCEDURE'')' +
                    ' exec (@sql2)'
exec (@sql) 
```

# php - PHP PDO 和 MySQLi

> ID：10703426
> 
> 赞同：37
> 
> 时间：2012-05-22T13:49:35.200
> 
> 标签：php, mysql, pdo, mysqli

我刚刚完成了 PHP 入门课程，在整个 stackoverflow 论坛上，人们都建议我切换到 PDO、prepared statements 或 MYSQLi，我简要地查看了手册，但大部分内容都让我头疼。

到目前为止，我一直在使用 mysql_* 函数，所以这些概念对我来说是新的。我认为它们用于访问和执行特定于数据库的操作，但我不确定。

那么 PDO、prepared statements 和 MySQLi 之间有什么区别，它们是完成相同任务的不同功能吗？它们在脚本中是兼容的还是“选择一个或另一个”？最后，哪个提供最佳性能？

更新：感谢您的回答，我将寻找更多 PDO 教程。

作为参考，我还发现以下帖子很有用：

[哪一个又快又轻——mysqli还是PDO](https://stackoverflow.com/questions/10696696/which-one-is-fast-and-light-mysqli-or-pdo)

[mysqli 或 PDO - 有什么优点和缺点？](https://stackoverflow.com/questions/13569/mysqli-or-pdo-what-are-the-pros-and-cons)

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-05-22T14:03:30.647

在基本层面上，mysql、mysqli 和 PDO 扩展都回答了*我如何与数据库通信的问题？*它们都提供连接到数据库并从中发送和检索数据的功能和功能。您可以同时使用它们，一次建立与数据库的多个连接，但这通常是无稽之谈。

mysql* 是一个非常简单的扩展，基本上允许您连接到数据库，向其发送 SQL 查询，仅此而已。
mysqli 通过添加参数化查询和其他一些东西来改进这一点（顾名思义）。
PDO 是一种将多个数据库驱动程序抽象到一个包中的扩展，即它允许您使用相同的代码连接到 MySQL、Oracle、MS SQL Server 和许多其他数据库，而无需使用特定于数据库的扩展或重写您的代码您切换数据库（至少在理论上）。它还支持参数化查询。

如果您知道您将专门使用 MySQL，那么 mysqli 是一个不错的选择。特别是因为您可以以程序方式使用它，您已经习惯了 mysql 扩展。如果您不熟悉 OOP，那会很有帮助。否则，PDO 是一个很好的面向对象、灵活的数据库连接器。

* * *

* 请注意，[现在**不推荐使用**mysql 扩展，并将在将来的某个时候将其删除](http://www.php.net/manual/en/mysqlinfo.api.choosing.php)。那是因为它很古老，充满了不良做法，缺乏一些现代特征。不要用它来编写新代码。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-05-22T14:03:39.990

`PDO`是“PHP 数据对象”。我主要使用PDO，所以我只能说它的优点：

*   适用于更多的数据库，而不仅仅是 MySQL（对你来说可能无关紧要）
*   编译C，所以它更快（据说）
*   准备好的陈述（虽然其他人有这些）
*   SO似乎很喜欢，所以你至少可以在这里得到很多帮助
*   您可以即时设置和更改各种获取/错误处理模式

你问

> 那么 PDO、prepared statements 和 MySQLi 有什么区别...

`PDO`并且`MySQLi`是数据库包装器。“准备好的陈述”是一个完全不同的概念。您可以准备一个可以多次执行的查询，并且正确参数化的语句是 SQL 注入安全的（尽管可能不是证明）。后一个原因是您应该使用 PDO（或 MySQLi）的大部分原因，但准备好的语句也为查询带来了一定程度的清晰度。

```
/* mysql_* version */
mysql_connect("host");
$query = "SELECT column FROM db1.t1 WHERE id = ";
foreach ($_GET['id'] as $id) {
   $id = mysql_real_escape_string($id);
   $result = mysql_query($query . "'$id'";
   while ($row = mysql_fetch_assoc($result)) {
      echo "$row[column]\n";
   }
}
//NOTE: it would probably be better to store the resource returned by
//mysql_connect and use that consistently (in query/escape)

/* PDO version */
$pdo = new PDO('mysql:host=HOST', 'user', 'pass');
$query = $pdo->prepare("SELECT column FROM db1.t1 WHERE id = ?";
foreach ($_GET['id'] as $id) {
   $query->execute($id);
   echo $query->fetch(PDO::FETCH_COLUMN);
}
//Notice that you skip the escape step. 
```

你可以用 做基本相同的事情`MySQLi`，但我更喜欢`PDO`'s 语法。它也可能更快，但我可以弥补。还有`MDB2`很少被提及的 PEAR，我敢肯定还有更多。既然`PDO`是内置的，我会去的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-22T14:11:36.520

如果您习惯了这些`mysql_xxx`功能，那么我将首先转到`MySQLi`扩展程序。

如果您愿意，您可以改用 PDO，但如果您需要开始支持多个数据库，这只会在第一个实例中真正值得。出于您的目的，我建议切换到 MySQLi，因为它对您来说更容易，而且您不会立即获得 PDO 的好处。

`mysql_xx`MySQLi 可用的功能与您习惯使用的功能非常相似；通常可以采用现有代码，在它们之间进行直接交换，并且代码应该可以继续正常工作。

所以这是一个很好的起点——让你的代码使用`mysqli_xxx`而不是 mysql_xxx`。

如果可能的话，我建议使用面向对象的语法而不是过程语法。MySQLi 两者都支持，而且过程语法会更接近你习惯的，但是 OO 语法从长远来看更加灵活，而且一旦你习惯了，实际上并没有太大的不同。

一旦您将代码转换为使用 MySQLi 库，并且您对基础知识感到满意，您就可以开始使用更高级的功能，例如准备好的语句。但首先要让自己对基础知识感到满意。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-22T14:02:58.827

来自和你一样的观点。从我的角度来看，我认为差异并不明显（取决于您使用它的目的）。看起来 PDO 只是一个将所有其他数据库 api 合并为一个的数据库 api。因此，如果您需要连接到 MS Sql 服务器和 MySQL 服务器，您可以简单地调用 PDO api 并指定特定数据库的驱动程序。我的猜测也是，MySQL 中的任何未来特性和能力都将仅在 PDO 中可用。所以基本上只需使用 PDO 来确保您可以访问所有最新功能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-22T14:15:36.230

PDO 的一大优势是平台独立性。这意味着您可以在某个时候迁移到不同的 DBMS，而无需重新编码所有函数调用。这就是在 Java（通过 JDBC）、.Net (ADO) 和大多数其他环境中通常完成的事情。优点不仅在于您可以切换 DBMS 本身，还在于您只需学习一个 API。

关于您的问题，PDO 层提供了执行准备好的语句的工具。准备好的语句背后的想法是您为 SQL 语句的部分创建占位符，这些部分直到运行时才知道。许多学习者首先将 SQL 创建为通过调用 mysqli::query($someQuery) 执行的字符串。由于许多原因，这是有问题的，其中最突出的是 SQL 注入漏洞（有关类似问题和答案，请参见 stackoverflow.com/questions/5315351）。使用 PDO，您可以避免 SQL 注入以及处理引号、反斜杠等字符的所有问题。最终结果是您的代码更加安全、可读和可预测。

如果您已经知道如何使用 mysqli，那么使用 PDO 并没有太大的不同。上面链接的问题和答案显示了使用 PDO 准备语句提交的查询示例，该语句应作为有用的指南。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2013-04-23T06:36:50.273

> 那么 PDO、prepared statements 和 MySQLi 之间有什么区别，它们是完成相同任务的不同功能吗？

区别很简单。
**PDO 可用于**准备**好的语句**，而 mysqli**不能**。

只需使用本机准备好的语句对这两个 API 运行一些常用查询，您就会清楚地看到差异。

# objective-c - NSPathControl problems

> ID：10703429
> 
> 赞同：2
> 
> 时间：2012-05-22T13:49:41.730
> 
> 标签：objective-c, cocoa, nspathcontrol

I have an application I'm developing in cocoa, and I have a problem with `NSPathControl`.

I set the style of the control to `Popup`, and when I launch my App and click on the path control, it shows me a popup menu with the components of the URL I set. I.e., for URL like `file://localhost/Applications/Games/` it shows me the following: `My Macbook`, `Macintosh HD`, `Applications`, `Games`.

Now, when I click on `Applications`, I receive an action, and whithin that action `[[sender clickedPathComponentCell] URL]` returns correct URL: `file://localhost/Applications/`.

Problem 1: But when I click on `Macintosh HD`, I get an URL with double trailing slash: `file://localhost//`.

Problem 2: is that I get the same URL `file://localhost//` when I click on `My Macbook` item. So, I have 2 questions:

1.  Why does the URL to `Macintosh HD` ends with double slash?

2.  How can I distinguish clicks on `Macintosh HD` and `My Macbook`, and what is the correct URL to `My Macbook`, where Finder shows the list of mounted volumes (on my macbook it is `Macintosh HD` and `BOOTCAMP`)?

I've examined the tutorial named "SourceView", but there was no item like `My Macbook`, so I was not able to find out, whether `My Macbook` is really exists as a some kind of virtual folder, or I should just use `NSFileManager` to get the list of mounted volumes.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T17:30:35.970

问题 1：

该 URL 是`file://localhost//`因为引导卷的路径是`/`. 这有点奇怪，但是`file://localhost/`(single slash) 表示“本地主机上没有路径的文件”，所以你得到`file://localhost//`(双斜杠) 表示“本地主机上的文件 path `/`。

你真的不必担心你得到的 URL 的怪癖 - 只需将它传递给任何需要它的东西，它应该可以很好地处理它。

问题2：

“我的 MacBook”实际上并不存在 - 它是一个显示已连接卷列表的虚拟文件夹`/Network`，等等。由于它不存在，因此它没有有效的路径，因此您可以获得引导路径而是音量。

# asp.net-mvc - MVC DisplayFor templates seem to quit working if the same model is reused within the template

> ID：10703435
> 
> 赞同：0
> 
> 时间：2012-05-22T13:50:30.523
> 
> 标签：asp.net-mvc

I have a really strange situation. I have a single Model, and two templates that are both strong-typed on the type of this model. The templates are nested, or in other words, I use DisplayFor on the second Template from within the first template. If I use the model associated with the first template, in the DisplayFor call for the second template, the second template does not render. If I use another instance of the same model type, everything works fine. It seems like there is some sort of cycle checking on the models associated with nested templates.

Model:

```
public class MyModel
{
    public string Value { get; set; }
    public MyModel Copy
    {
        get { return (MyModel) this.MemberwiseClone(); }
    }

    public MyModel MySelf
    {
        get { return this; }
    }
} 
```

DisplayTemplate1:

```
@model TestNestedTemplateSameReference.Models.MyModel

<div>Model1</div>
<div>@Model.Value</div>
<div>@Html.DisplayFor(x=>x, "ModelTemplate2")</div> 
```

DisplayTemplate2:

```
@model TestNestedTemplateSameReference.Models.MyModel

<div>Model2</div>
<div>@Model.Value</div> 
```

Interestingly if instead of calling

```
@Html.DisplayFor(x=>x, "ModelTemplate2") 
```

I call it with the Copy property

```
<div>@Html.DisplayFor(x=>x.Copy, "ModelTemplate2")</div> 
```

everything works fine as the actual instance of the MyModel class is different.

Does anyone know why this is done. Is there a viable workaround. It seems like this is a perfectly legitimate usage which shouldnot cause a stack overflow, or any similar issues. I could see how this could be used to protect against cycles for DisplayFor call without template name, but if I specify the template name seems like it should work fine.

It seems like it would be dangerous to bind the same model to multiple EditFor templates, but DisplayFor seems safe.

I can of course create a separate model for nesting level, but that is creating redundand class.

Any help is appreciated.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:37:09.573

如果您尝试执行的操作有效，则会在通过 Copy 方法创建对象后导致堆栈溢出作为对象。每个对象都会反过来创建自己的新副本，您很快就会用完内存或用完堆栈。

默认模板在显示属性之前执行此方法

```
bool ShouldShow(ModelMetadata metadata) {
    return metadata.ShowForEdit
        && metadata.ModelType != typeof(System.Data.EntityState)
        && !metadata.IsComplexType
        && !ViewData.TemplateInfo.Visited(metadata);
} 
```

我的猜测是它会触发 IsComplexType 或 TemplateInfo.Visited。

这里有更多信息：

[http://bradwilson.typepad.com/blog/2009/10/aspnet-mvc-2-templates-part-3-default-templates.html](http://bradwilson.typepad.com/blog/2009/10/aspnet-mvc-2-templates-part-3-default-templates.html)

# c# - C# WinForm set ConnectionString and Entity Framework on installation

> ID：10703436
> 
> 赞同：3
> 
> 时间：2012-05-22T13:50:32.443
> 
> 标签：c#, winforms, deployment, clickonce, connection-string

I use clickonce to deploy my program. the problem is the deployement team have to enter his conectionString on installation and write into app.config.

How can I add a dialogbox (for put the connectionString) in click once deployment ?

Or I have to add setup project into myProg.sln ?

Thanks you in advance

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-22T14:26:56.177

What you want to do is not nice. I take it that you want the user to specify a connection string at installation and persist this to your program. Well, this is not a good thing to do, and connections strings are liable to change; with this in mind you need to include a connection string dialog in your code or at least a text box where the user can set a new connection string that your application can use.

You could use the VS2010 database connection dialog that Microsoft have released ([download from here](http://archive.msdn.microsoft.com/Connection)). This will do exactly what you want without you having to do the hard work (and for pretty much any remote connection you want).

I hope this helps.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T14:32:40.760

I suggest you integrate those questions in the software itself, something like this:

1.  user gets your software
2.  user installs the packare (no question here!)
3.  the software upon launch searches for the info it needs. if it doesn't find them, it starts questioning the user.

# php - 使用 ArrayObject 存储数组

> ID：10703443
> 
> 赞同：2
> 
> 时间：2012-05-22T13:50:52.780
> 
> 标签：php, arrays, arrayobject

我正在尝试存储一个数组并使用扩展 ArrayObject 的自定义类来操作该数组。

```
class MyArrayObject extends ArrayObject {
    protected $data = array();

    public function offsetGet($name) {
        return $this->data[$name];
    }

    public function offsetSet($name, $value) {
        $this->data[$name] = $value;
    }

    public function offsetExists($name) {
        return isset($this->data[$name]);
    }

    public function offsetUnset($name) {
        unset($this->data[$name]);
    }
} 
```

问题是如果我这样做：

```
$foo = new MyArrayObject();
$foo['blah'] = array('name' => 'bob');
$foo['blah']['name'] = 'fred';
echo $foo['blah']['name']; 
```

输出是 bob 而不是 fred。有什么办法可以在不改变上面 4 行的情况下让它工作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T14:04:53.673

这是 ArrayAccess 的已知行为（“PHP 通知：间接修改 MyArrayObject 的重载元素无效”...）。

[http://php.net/manual/en/class.arrayaccess.php](http://php.net/manual/en/class.arrayaccess.php)

在 MyArrayObject 中实现：

```
public function offsetSet($offset, $data) {
    if (is_array($data)) $data = new self($data);
    if ($offset === null) {
        $this->data[] = $data;
    } else {
        $this->data[$offset] = $data;
    }
} 
```

# java - 如何*真正*确保我的 Java 包名称是唯一的？

> ID：10703444
> 
> 赞同：7
> 
> 时间：2012-05-22T13:50:56.563
> 
> 标签：java, package, conflict

在 Java 中避免包名冲突的标准方法是使用反向域约定`com.[mycompany].[rest-of-the-package-name]`。这非常有效......如果一个人拥有域 [mycompany].com。

但是，有几个个人开发人员（或学生）：

*   不要（或负担不起）拥有域名
*   仍然会想出一些包名称，希望它们是独一无二的。

仅此一项就引入了包冲突的范围。

此外，假设我拥有 [mycompany].com。是什么阻止了开发人员创建与我的包前缀相同的库并分发它？AFAIK，关于包名称没有法律约束力（“你必须拥有你在 Java 包中使用的域”）。更不用说开发人员的这一行为可能不是故意的（我们中有多少人在为我们的包命名之前会在网上搜索一个不存在的域名？）。

更进一步，即使我拥有一个域名，它可能适合也可能不适合用作包名称（我的域名可能包含连字符，或者它可能太长以至于虽然它是一个合法的包名称，但它仍然可以使其不切实际）。

所以我的问题是：我如何真正使我的 Java 包名称独一无二？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-22T13:53:56.360

你不能绝对保证你的包名是全局唯一的。正如您所提到的，没有什么可以阻止其他人使用相同的包名称，无论谁拥有包名称所基于的任何内容。没有使用中的包名称的权威索引。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-22T13:54:33.803

我看到您的问题的两个答案：

*   将您的学生项目设为[SourceForge](http://sourceforge.net/)项目并命名包`net.sf.myproject`（或使用任何类似的免费主机，例如[GitHub](http://github.com/)）。这样的包名称*可能*不会被其他人使用，尽管不能保证正如[Matt Hurne](https://stackoverflow.com/a/10703495/521799)指出的那样
*   除此之外，如果你不能或不想买一个域名，你的程序不太可能被广泛的受众使用，你可以随意命名你的包

# c# - 防止列表视图项显示在第二列中

> ID：10703449
> 
> 赞同：0
> 
> 时间：2012-05-22T13:51:19.987
> 
> 标签：c#, winforms

我正在使用 C# 处理 Winforms。

用屏幕截图更容易解释我的问题：

在左侧的列表视图中，请注意 item15 和更高版本是如何显示在第二列中的。我不想要那个。我希望它有一个垂直滚动条，并且 items15 出现在 item14 下，等等......而不是在新列中。我也在“列表”上设置了“视图”属性。

![在此处输入图像描述](../Images/dc32b6821e55847c2c788eed14b6d971.png)

谢谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T13:55:34.520

你需要设置

```
listview.Scrollable = true;
listview.View = View.Details
listview.HeaderStyle = ColumnHeaderStyle.None; 
```

添加一个虚拟列，这是一个重要的步骤，因为我们将 View 更改为*details*：

```
 ColumnHeader header = new ColumnHeader();
    header.Text = "MyHeader";
    header.Name = "MyColumn1";
    listView.Columns.Add(header); 
```

# jquery-ui - 在 JqueryUI 中用于图像的可拖动和可调整大小不起作用？

> ID：10703450
> 
> 赞同：5
> 
> 时间：2012-05-22T13:51:22.280
> 
> 标签：jquery-ui, jquery-ui-draggable, jquery-ui-resizable

我使用下面的代码来拖动和调整图像大小，

```
<!DOCTYPE html>
<html>
    <head lang="en">
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.2/jquery-ui.js"></script>
<link rel="stylesheet" type="text/css" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css"/>

        <script type="text/javascript">
    $(document).ready(function() {

        $( "#img_content" ).draggable().resizable();

    });
    </script>
    </head>
    <body class='default'>       

<div class="demo">
<!--<div id="img_content" class="ui-widget-content">
    <p>Drag me around</p>
</div>-->

<img id="img_content" class="ui-widget-content" src="Tulips.jpg" />

</div>

    </body>
</html> 
```

resizable 工作正常。但拖动图像不起作用。如果我申请了 div 结构

```
<div id="img_content" class="ui-widget-content">
        <p>Drag me around</p>
    </div> 
```

它工作正常。

如何实现图像标签的拖动和调整大小？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-21T16:29:03.483

您应该**将图像包装到一个 div**中`style="display:inline-block;`，然后使 div 可拖动并且图像可调整大小。 [**工作示例**](http://jsfiddle.net/8VY52/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-05T11:33:06.620

我找到的解决方案是使用背景图像调整大小/使其可拖动。我猜该元素不可拖动和调整大小。好吧，它对我有用。再见。

# c# - 绝对 URL 不适用于虚拟目录？

> ID：10703459
> 
> 赞同：2
> 
> 时间：2012-05-22T13:51:51.623
> 
> 标签：c#, asp.net, url, iis

我创建了几个虚拟导演，我希望能够从当前的 http 请求中获取 url。

**例如：**

`http://www.site.com/app_1/default.aspx ===> http://www.site.com/app_1/`

`http://www.site.com/app_2/default.aspx ===> http://www.site.com/app_2/`

……

`http://www.site.com/app_n/default.aspx ===> http://www.site.com/app_n/`

**我的代码：**

```
 string urlApp = HttpContext.Current.Request.Url.AbsoluteUri.ToString();
    urlApp = urlApp.Substring(0, urlApp.LastIndexOf('/') + 1); 
```

我试过了

```
 string urlApp = HttpContext.Current.Request.Url.GetLeftPart(UriPartial.Authority) + "/"; 
```

在 localhost 中效果很好：`http://localhost:2468/test.aspx`结果`http://localhost:2468/`

, 但是当通过虚拟目录访问时`http://myhost/app_1/test.aspx`结果`http://myhost/`

我怎么能得到`http://myhost/app_1/`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T14:08:50.260

```
HttpContext.Current.Request.ApplicationPath 
```

是获取到虚拟目录的路由所需要的。将其附加到您已经获得的 URL 上，您就赢了。就像是

```
HttpContext.Current.Request.Url.GetLeftPart(UriPartial.Authority) + HttpContext.Current.Request.ApplicationPath 
```

应该可以，但要注意尾部的斜杠。

# forms - 是 Null 条件格式 - MS Access 表单

> ID：10703461
> 
> 赞同：2
> 
> 时间：2012-05-22T13:51:59.123
> 
> 标签：forms, ms-access, formatting, conditional

我会假设很多东西......

我想知道是否有办法在 Access 的条件格式中格式化所有空白字段。在我的情况下，通常需要输入所有字段，但**并非在所有情况下**都需要输入。因此，与其编写一堆条件代码来限制用户在其中写入，我只想在我的字段中添加一些红色背景以提醒“嘿，这里什么都没有……确定这就是你想要的吗？”

它在平板电脑上，所以消息框会很烦人。所以它是条件格式。我知道你可以有“Is Null([Field]) 但这需要我在 30 多个字段上浏览我的 20 多个表单并确保正确的字段名称等，然后分别为它们键入条件。有没有办法我可以简单地多选我的字段，在 Multiple 上执行条件格式，并使用“Is Equal To: NULL”？

我试过“equal to: Null”但它不起作用..“equal to:”也不行"（使用 Access 常量）。想法为什么？或者我该如何解决这个问题？另外，它只对非触摸字段是必需的，所以如果用户开始输入然后删除回空白，我不在乎；它可以保持未格式化或变回红色，所以如果有更好的方法可以做到这一点，我会全力以赴。

编辑：我已经开始做一些 VBA 代码，我将把它们粘贴到我的所有表单中：

```
Private Sub Form_Load()
Dim ctl As Control
Dim reqCol As Long
Dim focusCol As Long
Dim doneCol As Long
Dim format As FormatCondition

reqCol = RGB(246, 180, 180)
focusCol = RGB(252, 249, 238)
doneCol = RGB(255, 255, 255)

For Each ctl In Me.Controls
    With ctl
        Me.Controls(ctl.Name).FormatConditions.Delete 'Delete the existing conditions.
        Me.Controls(ctl.Name).BackColor = doneCol 'Set the background color to the done color.

        Select Case .ControlType
            Case acTextBox
                'Create the format objects.
                format = Me.Controls(ctl.Name).FormatConditions.Add(acFieldValue, acEqual, "")
                format = Me.Controls(ctl.Name).FormatConditions.Add(acFieldHasFocus)

                'Format the filled in boxes (ie set back to red)
                With Me.Controls(ctl.Name).FormatConditions(0)
                    .BackColor = reqCol
                    .Enabled = True
                End With

                'Format the current field color (ie set to beige)
                With Me.Controls(ctl.Name).FormatConditions(1)
                    .BackColor = focusCol
                    .Enabled = True
                End With
        End Select
    End With
Next ctl
End Sub 
```

问题是`FormatConditions.Add(acFieldValue, acEqual, "")`由于同样的原因它不起作用......我该如何解决这个问题？看到 VBA 和内置条件都有缺陷，似乎是一个错误。或者我在我面前错过了一些东西..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2018-05-26T12:10:27.980

在 Access 2016 中，我找不到 @SeanC 提供的解决方案的默认格式选项。相反，我发现要让我的组合框正确格式化，我必须使用带 ISNULL 的表达式。

[![在此处输入图像描述](../Images/8fcaaa881e4193a935b8bcdcd39be5bc.png)](https://i.stack.imgur.com/tYiIz.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T19:17:48.793

将默认格式设置为希望零长度数据出现的方式。采用

`Field Value Is` `greater than` `''`

对于条件格式，并将该格式设置为字段中文本的显示方式。

![条件格式截图](../Images/b762d17a8179d754d1d2bbc994b36e54.png)

您可以在设计视图中按住 Shift 并单击来选择多个字段，以选择需要应用到的所有相应字段

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T12:18:34.640

解决了。把它放在我的表格中（可能会考虑把它变成一个模块；对此是新的，不知道怎么做）

```
Private Sub Form_Load()
On Error Resume Next

Dim ctl As Control
Dim reqCol As Long
Dim focusCol As Long
Dim doneCol As Long
Dim format As FormatCondition
Dim expr As String

reqCol = RGB(246, 180, 180)
focusCol = RGB(252, 249, 238)
doneCol = RGB(255, 255, 255)

For Each ctl In Me.Controls
    With ctl
        'Delete the existing formatting
        Me.Controls(ctl.Name).FormatConditions.Delete
        Me.Controls(ctl.Name).BackColor = doneCol

        Select Case .ControlType
            Case acTextBox
                expr = "IsNull(" & ctl.Name & ") = True"
                'Create the format objects.
                format = Me.Controls(ctl.Name).FormatConditions.Add(acFieldHasFocus)
                format = Me.Controls(ctl.Name).FormatConditions.Add(acExpression, , expr)

                'Format the filled in boxes (ie set back to focus color)
                With Me.Controls(ctl.Name).FormatConditions(0)
                    .BackColor = focusCol
                    .Enabled = True
                End With

                'Format the current field color (ie set to required color)
                With Me.Controls(ctl.Name).FormatConditions(1)
                    .BackColor = reqCol
                    .Enabled = True
                End With
        End Select
    End With
Next ctl
End Sub 
```

诀窍是如何将其输入`FormatConditions.Add(...)`. 完全按照我现在想要的方式工作。

# c++ - 警告：传递“g_timeout_add_seconds”删除的参数 2

> ID：10703471
> 
> 赞同：0
> 
> 时间：2012-05-22T13:52:34.553
> 
> 标签：c++, c

我在我的代码中使用了“g_timeout_add_seconds”。但是当我编译时显示以下错误

> 警告：传递“g_timeout_add_seconds”的参数 2
> 
> g_timeout_add_seconds（1，message_cb，数据）；//用法
> 
> gboolean message_cb(List *data) //原型

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:10:24.683

不要摆脱警告 - 修复它。

的第二个参数`g_timeout_add_seconds`是一个函数指针（`GSourceFunc`），如下：

```
gboolean (*GSourceFunc) (gpointer user_data); 
```

并且`gpointer`是指向`void`它不热衷于您使用的指针`List* data`。

坚持原型，如果你传递 a `List*`then 在回调中进行转换。

# ruby-on-rails - Rails 教程 3.2 第 8 章，无法注销以在会话中销毁 current_user

> ID：10703472
> 
> 赞同：2
> 
> 时间：2012-05-22T13:52:35.553
> 
> 标签：ruby-on-rails, ruby, session, session-variables, session-cookies

我无法让退出按钮正常工作。我已经向 _header.html.erb 部分添加了一个测试，它将添加一个链接来显示 current_user 是否为 nil。点击Account列表项下的sign out链接后，依然显示不是nil。而且它从不显示登录链接，所以它总是认为有用户登录。

有人可以看看这个吗？

这是我的存储库的链接：

[https://github.com/davissean/sample_app](https://github.com/davissean/sample_app)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-17T20:33:20.393

在终端中尝试 `rake db:reset` ，然后重新启动 rails 服务器

我有同样的问题。花了 6 个多小时重新检查代码和测试。一切都检查过了，但仍然没有让它在本地工作，所以我把它推到了 heroku ......它工作了。

但问题一直存在于第 9 章，直到我自动填充数据库，因此`db:reset`

而且，不要忘记运行，`rake db:test:prepare`否则您的测试将失败。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-19T07:35:10.653

问题似乎是

[https://github.com/davissean/sample_app/blob/master/app/helpers/sessions_helper.rb](https://github.com/davissean/sample_app/blob/master/app/helpers/sessions_helper.rb)，第 25 行

将局部变量设置为 nil 而不是 @current_user。

# c++ - 模板函数和 boost::remove_reference

> ID：10703480
> 
> 赞同：1
> 
> 时间：2012-05-22T13:52:59.720
> 
> 标签：c++, boost

我正在追踪一个我无法弄清楚的 C++ 编译器错误。我已将其简化为以下代码：

```
#include <boost/config.hpp>
#include <boost/type_traits/remove_reference.hpp>

template<typename T> inline const T bar( T in )
{
    typedef BOOST_DEDUCED_TYPENAME boost::remove_reference<T>::type nonref;
    const nonref* inPtr = &in;
    return *inPtr;
}

class Foo
{
};

int main()
{
    Foo foo;
    const Foo& ref = bar< Foo& >( foo );
} 
```

这导致：

```
tt.cpp: In function ‘const T bar(T) [with T = Foo&]’:
tt.cpp:19:39:   instantiated from here
tt.cpp:9:13: error: invalid initialization of reference of type ‘Foo&’ from expression of type ‘const nonref {aka const Foo}’ 
```

这里的实际问题是什么？为什么返回值中缺少 const？我需要 remove_reference 因为实际代码需要它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T13:57:33.363

应用于`const`引用类型什么都不做。您需要制作模板参数`const foo &`，或者删除引用，然后在函数签名本身中添加两者`const` *和引用。*

另请参阅[何时应该使用 remove_reference 和 add_reference？](https://stackoverflow.com/a/8860400/153285)特别是第二段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T13:57:44.100

使用 VisualStudio 2008 我收到以下错误

`error C2440: 'return' : cannot convert from 'const nonref' to 'Foo &'`

将蝙蝠更改为

```
template<typename T> inline const typename boost::remove_reference<T>::type& bar( T in )
{
    typedef BOOST_DEDUCED_TYPENAME boost::remove_reference<T>::type nonref;
    const nonref* inPtr = &in;
    return *inPtr;
} 
```

修复此问题并编译代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T14:51:42.783

从您的函数返回`const T`不会达到您的预期。从您的代码中，我了解到您希望它返回`const Foo&`，这是*对类型不可变对象的引用`Foo`*。

但是当`T`是时`Foo&`，表达式`const T`意味着*对类型对象的不可变引用`Foo`*。由于引用始终是不可变的，因此 const 部分只是被删除（根据规范的第 8.3.2 段）！也就是说，你的函数返回`Foo&`而不是返回，`const Foo&`这就是编译器试图告诉你的。

# c# - AxImp .NET4.0 运行时不匹配

> ID：10703481
> 
> 赞同：8
> 
> 时间：2012-05-22T13:53:04.947
> 
> 标签：c#, wpf, .net-4.0, msbuild, activex

我在使用 MSBuild 编译 C#/WPF 应用程序时遇到问题。

问题如下。我创建了一个带有默认 WPF 应用程序的 Visual Studio 2010 项目。我创建了一个“老式”Windows 窗体用户控件，我使用该控件显示该控件。该用户控件唯一要做的就是使用 Adob​​e Reader 中的 ActiveX 控件（使用 AcroPDFLib）显示 PDF 文档。

这可以在我使用以下命令安装了 Windows 7（64 位）和 VS2010 的本地机器上完美编译。

```
>C:\Windows\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe AcroPDFTest.sln /p:Configuration=Debug /t:Rebuild /verbosity:d 
```

但是，如果我在我们的构建机器上以相同的方式编译它，它会失败，这是一个带有 Windows SDK 7.1 的 Windows Server 2008 R2 机器。然后它会出现以下错误（包括详细输出）：

```
Using "ResolveComReference" task from assembly "Microsoft.Build.Tasks.v4.0, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a".
Task "ResolveComReference"
  Creating new cache file at "obj\x86\Debug\AcroPDFTest.csproj.ResolveComReference.cache".
  Resolving COM reference for item "AcroPDFLib" with a wrapper "tlbimp".
  Determining dependencies of the COM reference "AcroPDFLib".
  Resolving COM reference dependency "00020430-0000-0000-c000-000000000046" version 2.0.
  Resolved COM reference dependency "00020430-0000-0000-c000-000000000046" version 2.0: "obj\x86\Debug\Interop.stdole.dll"
  Type '_IAcroAXDocShimEvents' imported.
  Type 'AcroPDF' imported.
  Type 'IAcroAXDocShim' imported.
  Type 'AdobeSPOpenDocuments' imported.
  Type 'ISPOpenDocuments' imported.
  Resolved COM reference for item "AcroPDFLib": "obj\x86\Debug\Interop.AcroPDFLib.dll".
  Resolving COM reference for item "AxAcroPDFLib" with a wrapper "aximp".
  Determining dependencies of the COM reference "AxAcroPDFLib".
  C:\Program Files\Microsoft SDKs\Windows\v7.1\bin\AxImp.exe "C:\Program Files (x86)\Common Files\Adobe\Acrobat\ActiveX\AcroPDF.dll" /out:obj\x86\Debug\AxInterop.AcroPDFLib.dll /rcw:obj\x86\Debug\Interop.AcroPDFLib.dll 
AXIMP : AxImp error : The assembly '[snip]\obj\x86\Debug\Interop.AcroPDFLib.dll' failed to load with this error: Could not load file or assembly 'file:///[snip]\obj\x86\Debug\Interop.AcroPDFLib.dll' or one of its dependencies. This assembly is built by a runtime newer than the currently loaded runtime and cannot be loaded.. [[snip]\AcroPDFTest.csproj]
  The command exited with code -1163019603.
C:\Windows\Microsoft.NET\Framework\v4.0.30319\Microsoft.Common.targets(1558,9): warning MSB3283: Cannot find wrapper assembly for type library "AxAcroPDFLib". [[snip]\AcroPDFTest.csproj]
Done executing task "ResolveComReference" -- FAILED. 
```

如您所见，由于运行时不匹配，AxImp.exe 工具不接受编译时生成的 Interop.AcroPDFLib.dll。我对此进行了进一步调查，这里使用的 AxImp.exe 版本使用 .NET 2.0 运行时，而 Interop.AcroPDFLib.dll 文件使用的是 .NET 4.0：

```
>"C:\Program Files\Microsoft SDKs\Windows\v7.1\bin\AxImp.exe" /?
Microsoft (R) .NET ActiveX Control to Windows Forms Assembly Generator
[Microsoft .Net Framework, Version 2.0.50727.5456]
Copyright (c) Microsoft Corporation.  All rights reserved. 
```

为了完整起见，如果我在我的机器上运行它，我会得到以下（详细）输出：

```
Using "ResolveComReference" task from assembly "Microsoft.Build.Tasks.v4.0, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a".
Task "ResolveComReference"
  Creating new cache file at "obj\x86\Debug\AcroPDFTest.csproj.ResolveComReference.cache".
  Resolving COM reference for item "AcroPDFLib" with a wrapper "tlbimp".
  Determining dependencies of the COM reference "AcroPDFLib".
  Resolving COM reference dependency "00020430-0000-0000-c000-000000000046" version 2.0.
  Resolved COM reference dependency "00020430-0000-0000-c000-000000000046" version 2.0: "C:\Windows\assembly\GAC\stdole\7.0.3300.0__b03f5f7f11d50a3a\stdole.dll"
  Type '_IAcroAXDocShimEvents' imported.
  Type 'AcroPDF' imported.
  Type 'IAcroAXDocShim' imported.
  Type 'AdobeSPOpenDocuments' imported.
  Type 'ISPOpenDocuments' imported.
  Resolved COM reference for item "AcroPDFLib": "obj\x86\Debug\Interop.AcroPDFLib.dll".
  Resolving COM reference for item "AxAcroPDFLib" with a wrapper "aximp".
  Determining dependencies of the COM reference "AxAcroPDFLib".
  C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\bin\NETFX 4.0 Tools\AxImp.exe "C:\Program Files (x86)\Common Files\Adobe\Acrobat\ActiveX\AcroPDF.dll" /out:obj\x86\Debug\AxInterop.AcroPDFLib.dll /rcw:obj\x86\Debug\Interop.AcroPDFLib.dll 
  Generated Assembly: [snip]\obj\x86\Debug\AxInterop.AcroPDFLib.dll
  Resolved COM reference for item "AxAcroPDFLib": "obj\x86\Debug\AxInterop.AcroPDFLib.dll".
Done executing task "ResolveComReference". 
```

这里 AxImp.exe 的路径不同，这个版本确实使用了 .NET 4.0 运行时：

```
>"C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\bin\NETFX 4.0 Tools\AxImp.exe" /?
Microsoft (R) .NET ActiveX Control to Windows Forms Assembly Generator
[Microsoft .Net Framework, Version 4.0.30319.269]
Copyright (c) Microsoft Corporation.  All rights reserved. 
```

所以我的问题是：如何强制 MSBuild 使用 4.0 版本的 AxImp 而不是 2.0 版本？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-23T08:00:03.180

我找到了解决这个问题的方法。

您必须指定 MSBuild 应使用的 SDK 版本。如果您添加以下额外的命令行参数，它将起作用（至少在我的情况下）。

```
/p:WindowsSDKVersionOverride=v7.1 
```

显然 MSBuild 默认尝试使用 v7.0A 版本，该版本未安装在我的构建服务器上。然后它以某种方式决定忽略所有内容并退回到 .NET 2.0 路径。我通过删除 2.0 版本的 AxImp 发现了这一点。然后它抱怨以下内容：

`C:\Windows\Microsoft.NET\Framework\v4.0.30319\Microsoft.Common.targets(1558,9): error MSB3091: Task failed because "AxImp.exe" was not found, or the correct Microsoft Windows SDK is not installed. The task is looking for "AxImp.exe" in the "bin" subdirectory beneath the location specified in the InstallationFolder value of the registry key HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Microsoft SDKs\Windows\v7.0A. You may be able to solve the problem by doing one of the following: 1) Install the Microsoft Windows SDK. 2) Install Visual Studio 2010\. 3) Manually set the above registry key to the correct location. 4) Pass the correct location into the "ToolPath" parameter of the task.`

我的构建服务器上不存在该注册表项。因此，如果您添加 v7.1 版本覆盖，它将查看正确的注册表项并使用正确的工具版本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-10-08T00:39:37.003

我解决了安装[Windows 8.1 SDK的问题](https://developer.microsoft.com/pt-pt/windows/downloads/windows-8-1-sdk)

就我而言，我试图在 CI **Windows 2012 R2**服务器（CI 代表持续集成）上使用**MSBuild编译****.csproj ，尽管与此主题最相关的网络问题建议安装****Windows SDK**，但他们未能准确指出哪一个.

 ******所以，起初，我猜他们的意思是**Windows 10 SDK**，这也是**Windows 2012**服务器的正确版本。不幸的是，**Windows 10 SDK**不包含缺少的**AxImp.exe** SDK 文件。所以，正如你想象的那样，我花了很长时间才弄清楚**Windows 8.1 SDK**是解开这个谜题的关键。

再次，希望它可以帮助别人;-)******

# tfs - 如何将字段定义规则绑定到自定义 TFS 2010 工作项模板的 AD 组？

> ID：10703488
> 
> 赞同：2
> 
> 时间：2012-05-22T13:53:31.937
> 
> 标签：tfs, tfs-workitem, tfs-process-template

我正在尝试将“请求者”字段添加到 TFS 2010 中的自定义工作项模板。当我在工作项中创建该字段时，我希望将值限制为特定的 AD 组。我正在寻找类似于标准模板中“分配给”字段的功能。但是，如果我将此 AD 组添加到 TFS 组之一，它们都会被添加为 TFS 中的有效用户，这不是我要寻找的行为。我只是希望将字段的值限制为特定的 AD 组。我尝试将 AD 组添加到 VALIDUSER 字段定义规则的“组”属性中，但出现以下错误：

```
---------------------------
Error
---------------------------
Error importing work item type definition:

TF26204: The account you entered is not recognized. Contact your Team Foundation Server administrator to add your account.
---------------------------
OK   
--------------------------- 
```

提前致谢！

[更新] 在进一步调查中，我发现它适用于某些 AD 组，但不适用于其他组。例如，它适用于我们的“开发人员组”，但不适用于“域用户”。它实际上是我测试过的一小部分小组。再次，任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T21:56:46.253

我发现最简单的方法是使用 ALLOWEDVALUES 字段定义规则。将 TFS 组的名称添加到允许值列表中。我仍然无法让 AD 组直接工作。但我最大的问题是，当我尝试使用项目组时，我将项目名称放在“[项目]\组名称”中。

[如此处](http://msdn.microsoft.com/en-us/library/ms194954%28v=vs.80%29.aspx)所述

> 有些人可能认为“[project]”是项目名称的占位符，但它的意思是文字。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T05:13:31.447

您应该能够添加一个 AD 组，只需将其写为 domain\group。

但是请注意，该组需要对团队项目具有一些访问权限（例如，贡献者的成员）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T14:19:57.133

您是否尝试过创建 TFS 组，在 TFS 组中添加 AD 组，然后在 VALIDUSER 字段定义的“组”属性中添加 TFS 组？

如果我没记错的话，您不能将 AD 组放在 TFS 字段的“组”属性中，而只能将 TFS 组...

# c++ - OnDestroy 中的 DestroyWindow 不起作用

> ID：10703489
> 
> 赞同：0
> 
> 时间：2012-05-22T13:53:34.090
> 
> 标签：c++, mfc

嗨，我正在 MFC 中制作一个基于对话框的应用程序，使用：

```
BOOL CClockMasterDlg::OnInitDialog()
{
CDialogEx::OnInitDialog();

m_ModeTabs.Create(this,WS_CHILD | WS_VISIBLE, 0);
} 
```

`m_ModeTabs`如果我在使用以下方法创建函数后销毁`CClockMasterDlg::OnInitDialog`它：

```
m_ModeTabs.DestroyWindow(); 
```

我没有内存，但是当我将它放入`CClockMasterDlg::OnDestroy()`内存时会泄漏，即使它很难被调用并返回`true`。我不相信这`OnDestroy`是`OnInitDialog`相反的，但那是哪个功能呢？没有`OnExitDialog`。

检测到内存泄漏！转储对象 -> {601} 客户端块`0x00AEED48`，子类型 c0，212 字节长。一个`CMFCVisualManager`对象`$00AEED48`， 212 字节长 对象转储完成。程序`[5312] ClockMaster.exe: Native`以代码 2 (0x2) 退出。

即使很难，窗口也应该自动销毁，因为它不是指针，我仍然不应该出现内存泄漏吗？而且由于放置

```
m_ModeTabs.DestroyWindow(); 
```

在`OnInitDialog`创建后的函数中解决了内存泄漏，它真的不能是其他原因造成的麻烦吗？删除`m_ModeTabs.Create(...`还解决了内存泄漏，所以我很确定它`m_ModeTabs`会导致它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:04:07.217

以为您没有说，我假设 m_ModeTabs 是您的 CClockMasterDlg 的子窗口。在这种情况下或类似情况下，您不必显式调用 DestroyWindow。当 Win32 对窗口进行 Destroy() 处理时，它的所有子窗口也会被销毁。

由于您将 m_ModeTabs 声明为常规变量（而不是指针），因此它所拥有的内存将在 CClockMasterDlg 的析构函数期间由 C++ 运行时自动释放。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T16:14:37.337

我实际上遇到了一个错误，该错误将“在 MFC 中为 Visual Studio 的下一个主要版本修复”。

在仅对话框 mfc 应用程序中使用 CVSListBox 时会发生内存泄漏。

可以在此处找到有关该错误和几种解决方法的信息：

[https://connect.microsoft.com/VisualStudio/feedback/details/646445/cvslistbox-produces-memory-leaks](https://connect.microsoft.com/VisualStudio/feedback/details/646445/cvslistbox-produces-memory-leaks)

[http://connect.microsoft.com/VisualStudio/feedback/details/565327/memory-leaks-using-c](http://connect.microsoft.com/VisualStudio/feedback/details/565327/memory-leaks-using-c)

还有一份关于这里错误的报告：

[http://social.msdn.microsoft.com/Forums/en/vcgeneral/thread/8870974f-1414-4dd7-b7c3-a1c320c0e91e](http://social.msdn.microsoft.com/Forums/en/vcgeneral/thread/8870974f-1414-4dd7-b7c3-a1c320c0e91e)

第一个链接的报价：

> 你好，
> 
> 感谢您的报告。此问题已在 MFC 中针对 Visual Studio 的下一个主要版本进行了修复。
> 
> Pat Brenner Visual C++ 库开发

# javascript - Http请求&响应

> ID：10703491
> 
> 赞同：0
> 
> 时间：2012-05-22T13:53:40.967
> 
> 标签：javascript, jquery, ajax, json, struts-1

我必须向 pipl.com ( [http://apis.pipl.com//search/v2/json/?email=maryuca_alias%40yahoo.com&person_mode=all&exact_name=0&no_support=0&key=myKey](http://apis.pipl.com//search/v2/json/?email=maryuca_alias%40yahoo.com&person_mode=all&exact_name=0&no_sponsored=0&key=myKey) ) 提出请求才能获得关于一个人的一些信息。这个请求的响应是一个 json 对象。我无法通过 ajax/jquery/jsonp 调用来做到这一点，因为他们的服务器不支持这种类型的调用。有没有办法在服务器端（我使用 Struts 1）或客户端处理响应？

如果您有解决方案，请回答此问题。

```
<html>
<head>
</head>
<body>
<script type="text/javascript">
function getJSONP(url, success) {
var ud = '_' + +new Date,
script = document.createElement('script'),
head = document.getElementsByTagName('head')[0] 
|| document.documentElement;
window[ud] = function(data) {
head.removeChild(script);
alert(data);
success && success(data);
};
script.src = url.replace('callback=?', 'callback=' + ud);
head.appendChild(script);
}
getJSONP('http://apis.pipl.com//search/v2/json/?email=maryuca_alias
%40yahoo.com&person_mode=all&exact_name=0&no_sponsored=0
&key=key&callback=?', function(data){
console.log(data);
});     
</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:36:11.990

[使用HttpClient](http://hc.apache.org/httpcomponents-client-ga/)之类的东西从 Java 发出请求，可能在操作类调用的服务中。该响应可以由 Java 或 JavaScript 处理，具体取决于您的需要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T14:05:03.640

好的，看起来你发出了一个有效的跨站点请求，但是你得到的标题与预期的不同，或者数据不是 JSON 格式的？

如果它只是响应的标题不正确，你总是可以在客户端解析数据。指定问题的最佳方法是粘贴请求、响应和代码的标头

# jquery - 如何在 jQuery 的“子函数”中使用 $(this)？

> ID：10703492
> 
> 赞同：0
> 
> 时间：2012-05-22T13:53:47.180
> 
> 标签：jquery, function

这个函数调用

```
$('#mydiv').paintRed(); 
```

如果您使用以下代码，则使用 id **mydiv**将 DOM 元素的背景绘制为红色：

```
$.fn.paintRed = function() {
    $(this).css("background-color", "red");
} 
```

哦，那好吧。但现在我想“分组”我自己的功能。现在我想让程序员使用这个函数调用来实现和上面一样：

```
$('#mydiv').subsub.paintRed(); 
```

我该如何做到这一点？

（或者，如果上述要求不可行，还有其他方法吗？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T13:59:14.087

```
 $.fn.subsub= function() {
       var that = this;
        return {
            "paintRed" : function(){
                $(that).css("background-color", "red");
            },
            "yourOwnFunction1" : function(){
                 //code here
             },
            "yourOwnFunction2" : function(){
                 //code here
             }
        };
    }
    $("#mydiv").subsub().paintRed();
//  $("#mydiv").subsub().yourOwnFunction1(); 
```

返回一个具有`paintRed`作为其属性的对象。通过使用这种方法，您的所有功能都可以“分组”到该`subsub`功能中。

**[小提琴](http://jsfiddle.net/vy7Mg/1/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T14:06:33.723

您可以使用 jquery 扩展函数

```
$.fn.someFunctionName = function(){
// do something
} 
```

在这里查看[演示](http://jsfiddle.net/anupam/ZCuLj/)

# java - 基本身份验证表单适用于 /myapp/index.jsp 但不适用于 /myapp/?

> ID：10703506
> 
> 赞同：1
> 
> 时间：2012-05-22T13:54:39.933
> 
> 标签：java, security, jakarta-ee, web, war

（顺便说一下，我使用的是 WebSphere 7）

我有一个配置了基本身份验证和安全约束的 java web 应用程序（如下所示）。

当我在 访问我的网络应用程序时`http://localhost:9080/myapp/`，身份验证表单不会出现。

但是，当我直接访问该页面时，`http://localhost:9080/myapp/index.jsp`确实会出现身份验证表单。

如何使表单出现在`/`欢迎页面上？

```
<welcome-file-list>
  <welcome-file>index.jsp</welcome-file>
</welcome-file-list>

<security-constraint>
  <web-resource-collection>
    <url-pattern>/index.jsp</url-pattern>
    <http-method>GET</http-method>
  </web-resource-collection>
  <auth-constraint>
    <role-name>USERGROUP1</role-name>
  </auth-constraint>
  <user-data-contraint>
    <transport-guarantee>NONE</transport-guarantee>
  </user-data-contraint>
</security-constraint> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T14:00:29.743

尝试从这里开始 `<url-pattern>/index.jsp</url-pattern>`

对此 `<url-pattern>/</url-pattern>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T14:03:29.483

您创建一个虚拟 index.jsp 转发到您的“真实”索引页面。

# html - 背景图像的大小未达到指定的宽度和高度

> ID：10703507
> 
> 赞同：0
> 
> 时间：2012-05-22T13:54:41.167
> 
> 标签：html, css

我有一个要为其添加背景图像的链接标签。现在我为背景指定了宽度和高度，即图像的宽度和高度。问题是浏览器不会将背景图像调整为指定的大小，它会忽略它们。这是我的代码：有什么建议吗？

```
<div align="center" style="font-size: 14px; font-weight: bold; font-family: Arial,   
Helvetica, sans-serif;">
<a id="displayText" href="javascript:toggle();" title="UK referral system credits" 
     style="background: url(images/earnings.png) no-repeat center; width: 150px; 
     height: 40px;">Show my earnings</a>
<iframe id="toggleText" style="display: none;" frameborder="0" height="700" 
    src="http://v4m.mobi/cwf/facebook/uk/user_temp_credits_earned.php"; target="_blank"   
    align="center" width="300" scrolling="Auto"; bgcolor="#C9D3DE"> </iframe>
</div> 
```

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T13:59:27.403

您可以使用背景大小语法

下面可能会有所帮助
[http://www.w3.org/TR/css3-background/#the-background-size](http://www.w3.org/TR/css3-background/#the-background-size)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T13:59:38.207

首先，您应该将样式规则移动到外部 .css 文件中。它不仅会使您的代码更易于阅读，而且可以更好地分离关注点。

其次，除非您使用 CSS3`background-size`属性，否则您不能明确设置背景图像的大小。它将是原始图像大小的 100%，并且与作为背景的元素的大小完全分开。

要使用`background-size`，试试这个：`background-size: 150px 40px;`。请注意，这在 IE8 或更低版本中不起作用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T14:02:20.530

像这样添加“显示：块”：

```
<a id="displayText" href="javascript:toggle();" title="UK referral system credits" 
     style="background: url(images/earnings.png) no-repeat center; width: 150px; 
     height: 40px; display: block;">Show my earnings</a> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T14:00:09.233

你需要设置

```
background-size: 150px 40px; 
```

# facebook - Facebook 照片添加显示为单独/单独的帖子

> ID：10703508
> 
> 赞同：0
> 
> 时间：2012-05-22T13:54:48.047
> 
> 标签：facebook, photo, lightroom

将其他照片发布到现有 Facebook 相册时，每张照片都会在移动 Facebook 视图中显示为单独的帖子。桌面显示仍将它们（正确）分组为 1 个相册并显示为单个帖子。

例如，如果我在相册中添加 20 张照片，喜欢我页面的人会在他们的移动设备上的我的帐户中看到 20 条个人帖子。据我所知，这种情况已经发生了大约 2 周。我的上传过程没有改变。

我应该注意到，我通过 Lightroom 以及通过直接 Facebook 界面上传时注意到了这种行为。

有没有其他人经历过这个？有什么我不知道的变化吗？

谢谢。

# mysql - 更改 Joomla 使用的 MySQL 驱动程序

> ID：10703509
> 
> 赞同：1
> 
> 时间：2012-05-22T13:54:51.093
> 
> 标签：mysql, joomla

当我安装 Joomla 时，**mysqli**是默认选项，所以我安装了 mysqli 驱动程序。

但是我客户的数据库是mysqli。因此，当我将本地站点迁移到主机时，出现此错误：

> 数据库连接错误 (1): MySQL 适配器 'mysqli' 不可用。

有人可以知道我如何更改/返回“mysql”驱动程序吗？因为我在 localhost 中使用“mysqli”驱动程序配置了我的所有 Joomla 站点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T15:16:29.490

打开 configuration.php 并更改：

```
public $dbtype = 'mysqli'; 
```

对此

```
public $dbtype = 'mysql'; 
```

# xslt - 如何将 HTML 元素作为参数传递给 XSLT 函数？

> ID：10703511
> 
> 赞同：1
> 
> 时间：2012-05-22T13:54:58.233
> 
> 标签：xslt, xslt-2.0

我在 XSLT 文件中使用以下 XSLT 函数来生成 XHTML 输出：

```
<xsl:function name="local:if-not-empty">
   <xsl:param name="prefix"/>
   <xsl:param name="str"/>
   <xsl:param name="suffix"/>
   <xsl:if test="$str != ''"><xsl:value-of select="concat($prefix, $str, $suffix)"/></xsl:if>
</xsl:function> 
```

它只是检查字符串`str`是否不为空，如果是，则返回字符串，并与前缀和后缀连接。

只要我只传递简单的字符串，该函数就可以正常工作。但是当我尝试将 HTML 元素作为前缀或后缀传递时，例如：

```
<xsl:value-of select="local:if-not-empty('', /some/xpath/expression, '<br/>')"/> 
```

我收到以下错误消息：

```
SXXP0003: Error reported by XML parser: The value of attribute "select"
associated with an element type "null" must not contain the '<' character. 
```

我尝试的下一件事是定义一个变量：

```
<xsl:variable name="br"><br/></xsl:variable> 
```

并将其传递给函数：

```
<xsl:value-of select="local:if-not-empty('', /some/xpath/expression, $br)"/> 
```

但是在这里，当然，我得到一个空字符串，因为元素的值被提取，而不是元素本身被复制。

我最后一次绝望的尝试是在变量中定义一个文本元素：

```
<xsl:variable name="br">
   <xsl:text disable-output-escaping="yes"><br/></xsl:text>
</xsl:variable> 
```

并将其传递给函数，但这也是不允许的。

```
XTSE0010: xsl:text must not contain child elements 
```

我可能不了解 XSLT 复杂的内部工作原理，但在我看来，`<br/>`通过通用函数在 XSLT 转换中添加一个元素似乎是合法的......

无论如何...如果有人能给我一个替代解决方案，我将不胜感激。我也想了解为什么这不起作用...

PS：我使用的是 Saxon-HE 9.4.0.1J，Java 版本 1.6.0_24

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T14:07:12.710

尝试这个：

```
<xsl:value-of select="local:if-not-empty('', /some/xpath/expression, '&lt;br/&gt;')" disable-output-escaping="yes"/> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T14:30:40.023

**代替`concat`, 使用:`<xsl:copy-of>`并作为参数传递*项目*而不是字符串：**

```
 <xsl:copy-of select="$pPrefix"/>
   <xsl:copy-of select="$pStr"/>
   <xsl:copy-of select="$pSuffix"/> 
```

**这是一个完整的例子**：

```
<xsl:stylesheet version="2.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:local="my:local" exclude-result-prefixes="local">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:variable name="vBr"><br/></xsl:variable>

 <xsl:template match="/">
  <xsl:sequence select="local:if-not-empty('a', 'b', $vBr/*)"/>
 </xsl:template>

  <xsl:function name="local:if-not-empty">
  <xsl:param name="pPrefix"/>
  <xsl:param name="pStr"/>
  <xsl:param name="pSuffix"/>

  <xsl:if test="$pStr != ''">
   <xsl:copy-of select="$pPrefix"/>
   <xsl:copy-of select="$pStr"/>
   <xsl:copy-of select="$pSuffix"/>
  </xsl:if>
 </xsl:function>
</xsl:stylesheet> 
```

**当将此转换应用于任何 XML 文档（未使用）时，将产生所需的正确结果**：

```
a b<br/> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T14:20:06.037

问题在于它`<br/>`不是字符串——它是一个 XML 元素，因此不能使用字符串函数对其进行操作。你需要一个像这样的单独函数：

```
<xsl:function name="local:br-if-not-empty"> 
   <xsl:param name="prefix"/> 
   <xsl:param name="str"/> 
   <xsl:if test="$str != ''">
       <xsl:value-of select="concat($prefix, $str)"/>
       <br/>
    </xsl:if> 
</xsl:function> 
```

或像这样的“技巧”，您`<br/>`将其作为单独的案例处理：

```
<xsl:function name="local:if-not-empty"> 
   <xsl:param name="prefix"/> 
   <xsl:param name="str"/> 
   <xsl:param name="suffix"/> 
   <xsl:if test="$str != ''">
       <xsl:value-of select="concat($prefix, $str)"/>
       <xsl:choose>
          <xsl:when test="$suffix = '&lt;br/&gt;'>
             <br/>
          </xsl:when>
          <xsl:otherwise>
            <xsl:value-of select="$suffix"/>
          </xsl:otherwise>
       </xsl:choose>
    </xsl:if> 
</xsl:function> 
```

# node.js - 用于 socket.io 服务器的 Node.js 客户端

> ID：10703513
> 
> 赞同：130
> 
> 时间：2012-05-22T13:55:14.760
> 
> 标签：node.js, socket.io

我有一个正在运行的 socket.io 服务器和一个带有 socket.io.js 客户端的匹配网页。一切正常。

但是，我想知道是否有可能在另一台机器上运行一个单独的 node.js 应用程序，该应用程序将充当客户端并连接到提到的 socket.io 服务器？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2012-05-22T14:05:07.680

这应该可以使用 Socket.IO-client：[https ://github.com/LearnBoost/socket.io-client](https://github.com/LearnBoost/socket.io-client)

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2016-02-16T08:26:45.927

添加前面给出的解决方案的示例。通过使用`socket.io-client` [https://github.com/socketio/socket.io-client](https://github.com/socketio/socket.io-client)

客户端：

```
//client.js
var io = require('socket.io-client');
var socket = io.connect('http://localhost:3000', {reconnect: true});

// Add a connect listener
socket.on('connect', function (socket) {
    console.log('Connected!');
});
socket.emit('CH01', 'me', 'test msg'); 
```

服务器端 ：

```
//server.js
var app = require('express')();
var http = require('http').Server(app);
var io = require('socket.io')(http);

io.on('connection', function (socket){
   console.log('connection');

  socket.on('CH01', function (from, msg) {
    console.log('MSG', from, ' saying ', msg);
  });

});

http.listen(3000, function () {
  console.log('listening on *:3000');
}); 
```

跑 ：

打开 2 控制台并`node server.js`运行`node client.js`

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-05-23T13:13:34.183

安装 socket.io-client 后：

```
npm install socket.io-client 
```

这是客户端代码的样子：

```
var io = require('socket.io-client'),
socket = io.connect('http://localhost', {
    port: 1337,
    reconnect: true
});
socket.on('connect', function () { console.log("socket connected"); });
socket.emit('private message', { user: 'me', msg: 'whazzzup?' }); 
```

谢谢[alessioalex](https://stackoverflow.com/users/617839/alessioalex)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-03-14T06:32:39.553

是的，只要 socket.io 支持，您可以使用任何客户端。不管是node、java、android还是swift。你所要做的就是安装socket.io的客户端包。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-09-04T18:20:51.627

客户端代码：我有一个要求，我的 nodejs 网络服务器既可以作为服务器也可以作为客户端，所以当我需要它作为客户端时，我添加了下面的代码，它应该可以正常工作，我正在使用它并且对我来说工作正常！！ ！

```
const socket = require('socket.io-client')('http://192.168.0.8:5000', {
            reconnection: true,
            reconnectionDelay: 10000
          });

        socket.on('connect', (data) => {
            console.log('Connected to Socket');
        });

        socket.on('event_name', (data) => {
            console.log("-----------------received event data from the socket io server");
        });

        //either 'io server disconnect' or 'io client disconnect'
        socket.on('disconnect', (reason) => {
            console.log("client disconnected");
            if (reason === 'io server disconnect') {
              // the disconnection was initiated by the server, you need to reconnect manually
              console.log("server disconnected the client, trying to reconnect");
              socket.connect();
            }else{
                console.log("trying to reconnect again with server");
            }
            // else the socket will automatically try to reconnect
          });

        socket.on('error', (error) => {
            console.log(error);
        }); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-04-17T22:50:15.070

像这样的东西对我有用

```
const WebSocket = require('ws');
const ccStreamer = new WebSocket('wss://somthing.com');

ccStreamer.on('open', function open() {
  var subRequest = {
    "action": "SubAdd",
    "subs": [""]
  };
  ccStreamer.send(JSON.stringify(subRequest));
});

ccStreamer.on('message', function incoming(data) {
  console.log(data);
}); 
```

# c# - 将 asp.net 从 WebForms 迁移到 MVC 时的表单身份验证问题

> ID：10703516
> 
> 赞同：0
> 
> 时间：2012-05-22T13:55:17.800
> 
> 标签：c#, jquery, asp.net, asp.net-mvc, forms-authentication

我正在逐步将我的项目从 asp.net Web 表单升级到 MVC4。在第一步中，我更改了登录页面和其他几个页面。我正在使用表单身份验证，具有我自己的逻辑（无成员资格） - 我根据数据库表检查用户名/密码。如果没问题，用户将被重定向到其目的地。我的登录代码是：

网络配置：

```
<authentication mode="Forms">
    <forms loginUrl="~/LogIn" name=".ASPXFORMSAUTH" timeout="150" />
</authentication>
<authorization>
    <deny users="?" /> 
</authorization> 
```

登录控制器：

```
[AllowAnonymous]
[HttpPost]
public ActionResult AjaxLogin(FormCollection postedFormData)
{
    try
    {
        string userName = postedFormData["Login_UserName"];
        string password = postedFormData["Login_Password"];
        UserEntity userEntity = new UserEntity(Utilities.AuthenticateUser(userName, password, 1));

        Session["UserEntity"] = userEntity;

        FormsAuthentication.SetAuthCookie(userEntity.Key.Id.ToString(), false);

        return Json(new { redirectToUrl = "./AccountSelection", error = "false", lan = Thread.CurrentThread.CurrentUICulture.ToString() });
    }
    catch (Exception ex)
    {
         return Json(new { redirectToUrl = "", error = ExceptionHandler.HandleException(ex), lan = Thread.CurrentThread.CurrentUICulture.ToString() });
    }
} 
```

当我尝试登录时，我得到 http 302 并重定向回登录。如果我删除 web.config 上的“授权”部分，它会正常工作，但现在我有两个问题：

1.  我必须在每个控制器上加上 [authorize] 属性
2.  我的webforms不会在forms认证里面（不用登录就可以直接访问！！）

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T14:32:57.643

如果您在 web.config 中定义您的授权，则不需要 AllowAnonymousAttribute。

话虽如此，您似乎并未将 AjaxLogin 添加到您的授权列表中。这是必要的，因为否则 Ajax 请求将被阻止。您需要 ~/Login 和 ~/Account/AjaxLogin 路径。您可能还需要一个 ~/Account/Login 路径，但我不确定。

# ios - 使用适用于 iPad 3 (Retina) 的 UIGraphicsBeginImageContextWithOptions 的屏幕截图

> ID：10703520
> 
> 赞同：4
> 
> 时间：2012-05-22T13:55:32.933
> 
> 标签：ios, retina-display, ipad-3

我正在使用以下代码截取屏幕截图：

```
 // Returns 1024x768 for iPad Retina
    CGSize screenDimensions = [[UIScreen mainScreen] bounds].size;

    // Create a graphics context with the target size
    // (last parameter takes scale into account)
    UIGraphicsBeginImageContextWithOptions(screenDimensions, NO, 0);

    // Render the view to a new context
    CGContextRef context = UIGraphicsGetCurrentContext();
    [myView.layer renderInContext:context];

    // Save to Camera Roll
    UIImage *screenshot = UIGraphicsGetImageFromCurrentImageContext();
    UIImageWriteToSavedPhotosAlbum(screenshot, self, nil, nil);

    UIGraphicsEndImageContext(); 
```

这可行，但是我有一个用户报告，这会导致相机胶卷中的图像不是 iPad 视网膜分辨率。相反，它看起来更像 iPad 非视网膜分辨率。（我没有 iPad 3 来测试它）。

还有什么我做错了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T21:09:54.880

所以我终于拿到了一个物理的 iPad Retina，我最初发布的代码运行良好。生成的图像看起来确实具有完整的 Retina 分辨率。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T14:00:29.390

这是我正在使用的代码，我似乎对 iPad 3 没有任何问题。您还可以在 iOS 模拟器中确认使用视网膜 iPad。我的代码还将文件保存到文档目录。你可以修改它你认为合适的方式。

```
 CGSize screenSize = [[UIScreen mainScreen] applicationFrame].size;
    CGColorSpaceRef colorSpaceRef = CGColorSpaceCreateDeviceRGB();
    CGContextRef ctx = CGBitmapContextCreate(nil, screenSize.width, screenSize.height, 8, 4*(int)screenSize.width, colorSpaceRef, kCGImageAlphaPremultipliedLast);
    CGContextTranslateCTM(ctx, 0.0, screenSize.height);
    CGContextScaleCTM(ctx, 1.0, -1.0);

    [(CALayer*)self.view.layer renderInContext:ctx];

    CGImageRef cgImage = CGBitmapContextCreateImage(ctx);
    UIImage *image = [UIImage imageWithCGImage:cgImage];
    CGImageRelease(cgImage);
    CGContextRelease(ctx);
    CGColorSpaceRelease(colorSpaceRef);
    NSString *docDir = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];
    NSString *filePath = [NSString stringWithFormat:@"%@/myscreenshot.jpg", docDir];

    [UIImageJPEGRepresentation(image, 1.0) writeToFile:filePath atomically:YES]; 
```

# python - 基于 Django 文件的会话 - 文件名太长

> ID：10703523
> 
> 赞同：1
> 
> 时间：2012-05-22T13:55:35.053
> 
> 标签：python, django, django-sessions

我正在使用 Django==1.1（我必须）
和基于文件的会话。我得到以下回溯（下）

我知道在 django.contrib.sessions.backends.file.SessionStore 的初始化过程中，构造函数的 session_key 会变得很长。但是这个类实例是在哪里创建的——我不知道。我试图找出答案。为什么会创建这么长的 session_key？

```
Traceback (most recent call last):
  File "/Users/john/.virtualenvs/app/lib/python2.7/site-packages/django/core/servers/basehttp.py", line 279, in run
    self.result = application(self.environ, self.start_response)
  File "/Users/john/.virtualenvs/app/lib/python2.7/site-packages/django/core/servers/basehttp.py", line 651, in __call__
    return self.application(environ, start_response)
  File "/Users/john/.virtualenvs/app/lib/python2.7/site-packages/django/core/handlers/wsgi.py", line 245, in __call__
    response = middleware_method(request, response)
  File "/Users/john/.virtualenvs/app/lib/python2.7/site-packages/django/contrib/sessions/middleware.py", line 36, in process_response
    request.session.save()
  File "/Users/john/.virtualenvs/app/lib/python2.7/site-packages/django/contrib/sessions/backends/file.py", line 88, in save
    fd = os.open(session_file_name, flags)
OSError: [Errno 63] File name too long: '/tmp/sessionid.eJydVktv4zYQ9m63Fx7aQ3-EfXJFvYWeit1FkYuLrpNuDwsQlMTQSmRJJqU4KVCgP70zQ8mPxMmhB8kWh5z55psX_33_z-7d4uaDaWv11_ez2UyW26rZvb_5wQpTVo224raUvdx9d_3Tu9lsUXacrefNsM2VEfmcdT5b2fXc9tL0AjaqvtoqWA5YMX2xw58uZIv1_Nujl3x7LAv4jeDh8HiXnjkruqf-byY61kV48PNg2k79_FUaK_dgI2ZXie957CqI4b2ef_y8voblhPVfuhRfGbMHrBIkHPb6foCrqilP4XLO9AVwHJ_kl5fINOnnPrPLmx-PTFV1r8zuw_VvbDYrirZ7EkZpBq-ibWxvhqJvDRhji6K8k41ul2W-3Lalqu3S7urlblDmif1BbyC2ECIfQGXVCMHa_E4VPRK7AsuAtQRS1nOpNZgAR4RVNWwQW2nviRsMi3ghLmSxUUQSytVjb5CYlOkTUENfASCMusM8GGXZujW9Kj9ViCE7h1bSIpC7KJEUjtiAmvX8Xj39bkplkOCALeqOh8zmYPeuhYNb2aEgou0xW6z-RJ4clbAOCFd9x1O20PAf_kE04ahRNbhTTv7cVqouLeahhwZ8zia3RC_zWpHIZ4sek5SO4AKB8UPcuxtaYGeixSc0fszI0oM4AeonJEKqEnhSQjNYgCLrSlpn6RkzVmHEABmYCzidlEBR4KP-FqkR-RNWCwEKCFBZWThMOIOIXUFm4-LQKSEf2qqUTUH1FSOaICGhupVD3QtSCOyhOIWTxIU27dCNVjJXqyNzrRFDhzUAotCbLI3SkWYU8QMIdauMAYfrVpbOTgjUaucgZmVAVvsuDE9UHUIURuhlSOQSZyOzITEbOmYXjl6M_mqFhkGbi_xWPopSdf0GjkSAN2Ku8TSlNOWp8xGfnHeJcEJ0NKbCRPIRXEQhiAj4IXMiQhzFLnL2pNxImlDZ6Ax-xuSPUipMXCF9secS3gF5VqL8cjhE0-5lhfGP_Yl6caZgytY4IA11uwedhnSGcOLIr1G3RTs0pCs6B9vFzqsraIcAPKYYxOkBeDb6nL-suaKt0f2EKi7hpyk4ifwpAlNYTookIQMJMb2RDy5mSXTWgs774n6jjGJf8b2CVdgN2F0jTAh3kkK3gR7bKOywqC6DhV9Xn7C3ER8NRQ3zOT3kc7Gp6tKoBhd9xJTSaLBD3hulRCdB1iPiNCRp5GIJeVMPJdBRNYCoQmIcVtxJZZkmhywaUzylvEgdqaAr80Z6YR95J4oaPmBnBm0ioRIhpbgCk2BfGdXLrhtZYV-mTgliAk1KcHPownxkKKOWlsE3kKKRDT1RoJ3bWfLiDMHNstfPcM97foh7rvN7_lvHAqzwtwP9kYalrBqaKuFRvxsVXszG_KaR7rqF1UCTdlxQTYtGusnuYW64-8k07D26GECu0uRHR3Alh2aJzfDSxYXjBQFf__P-wmEeXrjBcCi2i3cYDpOSZmnkfmIcgJQw2iUjxwGUy-chgCFJw9d7IwQ-dyHQp9zijMSDAZLxnFLtSDy9SeHw1I47_JuPFNt9hf0Zi59uWoAaRuoRNU7Wl6jdaOU4W19HnV1AHVAn4zRaL6N2odVnUa4xyvr1kL5-65viAQMcPIOpffQMh3d-8hmdf8aud2wqvZl6NQ_cJczdGkVlBcyk4v6JRKnzPl8Oy_8ACepvHw:1SWRxQ:eJ6zYlFnV8NFqaM2mjeYJUjvBlM'
[22/May/2012 15:45:43] "GET /login/ HTTP/1.1" 500 2736 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:09:59.820

`request.session`得到构造，`SessionMiddleware.process_request`您可以签入文件`django/contrib/sessions/middleware.py`。在早期版本中，（刚刚在最近的 Django 中检查它仍然易受攻击），在接触后端之前很少检查传入的会话密钥`request.COOKIES`，因此你得到一个过长的失败`session.save()`。

# symfony - FOSFacebookBundle facebook_login_button({'autologoutlink': true}) 成功登录后不显示“注销”

> ID：10703525
> 
> 赞同：2
> 
> 时间：2012-05-22T13:55:43.380
> 
> 标签：symfony, fosuserbundle

我已经实现了 FOSUserBundle+FOSFacebookBundle，我可以成功注册并登录为普通用户和 facebook 用户。

以 facebook 用户身份登录后，将创建这些会话：

1.  fbm_XXXXXX
2.  fbsr_XXXXXX

模板包含以下代码：

```
{{ facebook_initialize({'xfbml': true, 'fbAsyncInit': 'onFbInit();'}) }}
{{ facebook_login_button({'autologoutlink': true}) }}
<script>
function goLogIn(){
    window.location = "{{ path('fos_facebook_security_check') }}";
}
function onFbInit() {
    if (typeof(FB) != 'undefined' && FB != null ) {
        FB.Event.subscribe('auth.statusChange', function(response) {
            if (response.session || response.authResponse) {
                setTimeout(goLogIn, 5000);
            } else {
                window.location = "{{ path('fos_user_security_logout') }}";
            }
        });
    }
}                      
</script> 
```

当我单击 FB 登录按钮弹出窗口时，我填写了表单，我的模板中的 FB 登录按钮更改为“注销”，我等待 5 秒直到重定向。重定向后，我已正确登录，但按钮再次更改为“登录”（而不是“注销”），我无法强制正确注销 Facebook。

有什么想法可能是错的吗？

**已解决** 应该有`'status': true`争论`facebook_initialize`。

**配置** 安全性.yml

```
services:
    my.facebook.user:
        class: Strict\UserBundle\Security\User\Provider\FacebookProvider
        arguments:
            facebook: "@fos_facebook.api"
            userManager: "@fos_user.user_manager"
            validator: "@validator"
            container: "@service_container"
    strict_user.my_provider:
        class: Strict\UserBundle\Security\User\Provider\StrictProvider
        public: false
        arguments: ["@fos_user.user_manager"]      
security:
    factories:
          - "%kernel.root_dir%/../vendor/bundles/FOS/FacebookBundle/Resources/config/security_factories.xml"

    providers:
        chain_provider:
            providers: [fos_userbundle, my_fos_facebook_provider]
        fos_userbundle:
            id: strict_user.my_provider
        my_fos_facebook_provider:
            id: my.facebook.user

    encoders:
        "FOS\UserBundle\Model\UserInterface": sha512

    firewalls:
        public:
            pattern:   ^/
            fos_facebook:
                app_url: "http://www.facebook.com/apps/application.php?id="
                server_url: "http://localhost/web/app_dev.php"
                login_path: fos_user_security_login
                check_path: fos_facebook_security_check
                default_target_path: homepage
                provider: my_fos_facebook_provider
            form_login:
                login_path: fos_user_security_login
                check_path: fos_user_security_check
                provider: fos_userbundle
            anonymous: true           
            logout:
                path: fos_user_security_logout    
                target: homepage 
```

对于其余文件，请检查用户和 Facebook 捆绑包的文档。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-01T13:57:11.450

应该有`'status': true`争论`facebook_initialize`。

`{{ facebook_initialize({'xfbml': true, 'fbAsyncInit': 'onFbInit();', 'status': true }) }}`

**配置** 安全性.yml

```
services:
    my.facebook.user:
        class: Strict\UserBundle\Security\User\Provider\FacebookProvider
        arguments:
            facebook: "@fos_facebook.api"
            userManager: "@fos_user.user_manager"
            validator: "@validator"
            container: "@service_container"
    strict_user.my_provider:
        class: Strict\UserBundle\Security\User\Provider\StrictProvider
        public: false
        arguments: ["@fos_user.user_manager"]      
security:
    factories:
          - "%kernel.root_dir%/../vendor/bundles/FOS/FacebookBundle/Resources/config/security_factories.xml"

    providers:
        chain_provider:
            providers: [fos_userbundle, my_fos_facebook_provider]
        fos_userbundle:
            id: strict_user.my_provider
        my_fos_facebook_provider:
            id: my.facebook.user

    encoders:
        "FOS\UserBundle\Model\UserInterface": sha512

    firewalls:
        public:
            pattern:   ^/
            fos_facebook:
                app_url: "http://www.facebook.com/apps/application.php?id="
                server_url: "http://localhost/web/app_dev.php"
                login_path: fos_user_security_login
                check_path: fos_facebook_security_check
                default_target_path: homepage
                provider: my_fos_facebook_provider
            form_login:
                login_path: fos_user_security_login
                check_path: fos_user_security_check
                provider: fos_userbundle
            anonymous: true           
            logout:
                path: fos_user_security_logout    
                target: homepage 
```

对于其余文件，请检查用户和 Facebook 捆绑包的文档。

# windows - GetModuleFileName 不返回调用程序的路径

> ID：10703526
> 
> 赞同：1
> 
> 时间：2012-05-22T13:55:49.517
> 
> 标签：windows, api

为什么下面的代码不打印调用程序的路径名？

```
#include<iostream>
int main()
{
    TCHAR buffer[MAX_PATH];
    GetModuleFileName(NULL,buffer,sizeof(buffer));
    cout << "Filepath:" << buffer << "\n";
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T16:48:24.797

感谢大家的帮助，问题出在 cout 上，我使用了 wprintf 并且它有效..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T14:08:58.740

可能是您看不到缓冲区的内容（因为应用程序死掉了），但缓冲区实际上包含您期望的数据？

# authentication - 刷新令牌有什么意义？

> ID：10703532
> 
> 赞同：70
> 
> 时间：2012-05-22T13:56:01.110
> 
> 标签：authentication, oauth, access-token, refresh-token

我不得不承认我有这个问题很长时间了，从来没有真正理解过。

说身份验证令牌就像保险箱的钥匙，当它过期时就不再可用了。现在我们得到了一个魔法刷新令牌，它可以用来获取另一个可用的密钥，以及另一个……直到魔法密钥过期。那么为什么不将身份验证令牌的到期时间设置为与刷新令牌相同呢？为什么要打扰呢？

它的正当理由是什么，也许是历史原因？真的很想知道。谢谢

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2015-03-05T21:22:08.773

前几天我正在阅读Taiseer Joudeh的[一篇文章，我觉得它非常有用，他说：](http://bitoftech.net/2014/07/16/enable-oauth-refresh-tokens-angularjs-app-using-asp-net-web-api-2-owin/)

在我自己看来，使用刷新令牌有三个主要好处：

1.  更新访问令牌内容：如您所知，访问令牌是自包含的令牌，一旦生成，它们就会包含有关经过身份验证的用户的所有声明（信息），现在如果我们为用户颁发长期令牌（例如 1 个月）命名为“Alex”并将他注册为“用户”角色，然后此信息将包含在授权服务器生成的令牌中。如果您稍后决定（在他获得令牌后 2 天）将他添加到“管理员”角色，则无法更新生成的令牌中包含的此信息，您需要让他重新自我验证所以授权服务器将此信息添加到这个新生成的访问令牌中，这在大多数情况下是不可行的。您可能无法联系获得长期访问令牌的用户。

2.  撤销经过身份验证的用户的访问：一旦用户获得长期访问令牌，只要他的访问令牌未过期，他就能够访问服务器资源，除非授权服务器实现自定义逻辑，否则没有标准的方法来撤销访问令牌这迫使您将生成的访问令牌存储在数据库中，并对每个请求进行数据库检查。但是使用刷新令牌，系统管理员可以通过简单地从数据库中删除刷新令牌标识符来撤销访问，因此一旦系统使用已删除的刷新令牌请求新的访问令牌，授权服务器将拒绝此请求，因为刷新令牌不再可用（我们将详细介绍这一点）。

3.  无需存储或询问用户名和密码：使用刷新令牌允许您在用户第一次身份验证后仅向用户询问他的用户名和密码一次，然后授权服务器可以发出非常长的刷新令牌（1 年例如），除非系统管理员尝试撤销刷新令牌，否则用户将一直保持登录状态。您可以将其视为对服务器资源进行离线访问的一种方式，如果您正在构建一个将由前端应用程序使用的 API，而在这种情况下不断询问用户名/密码是不可行的，这可能会很有用。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2016-10-24T20:53:32.643

我想补充另一个观点。

### 无状态身份验证，无需在每个请求上访问数据库

假设您想创建一个无状态（无会话）安全机制，可以对数百万用户进行身份验证，而无需进行数据库调用来进行身份验证。对于您的应用程序获得的所有流量，为每个请求节省一次数据库调用非常值得！而且它需要是无状态的，以便可以轻松地集群并扩展到数百甚至数千台服务器。

使用老式会话，用户登录，此时我们从数据库中读取他们的用户信息。为了避免一次又一次地读取它，我们将它存储在会话中（通常在内存或一些集群缓存中）。我们将会话 ID 在 cookie 中发送给客户端，该 cookie 附加到所有后续请求。在后续请求中，我们使用会话 ID 来查找会话，该会话又包含用户信息。

### 将用户信息直接放入访问令牌中

但我们不想要会话。因此，我们不将用户信息存储在会话中，而是将其放入访问令牌中。我们对令牌进行签名，因此没有人可以篡改它并立即生效。我们可以在没有会话的情况下对请求进行身份验证，并且不必从数据库中为每个请求查找用户信息。

### 没有会话...没有办法禁止用户？

但是没有会议有一个很大的缺点。例如，如果该用户被禁止怎么办？在旧场景中，我们只是删除他的会话。然后他必须再次登录，而他将无法做到这一点。禁令完成。但是在新场景中没有会话。那我们怎么禁止他呢？我们将不得不（非常有礼貌地）要求他删除他的访问令牌。根据禁止列表检查每个传入请求？是的，会起作用，但现在我们必须再次进行我们不想要的数据库调用。

### 与短期令牌妥协

如果我们认为用户可能在被禁止 10 分钟后仍然可以使用他的帐户是可以接受的，我们可以创建一种在每次请求检查数据库和仅在登录时检查数据库之间的折衷方案。这就是刷新令牌的用武之地。它们允许我们使用具有短期访问令牌的无状态机制。我们无法撤销这些令牌，因为没有对它们进行数据库检查。我们只根据当前时间检查它们的到期日期。但是一旦它们过期，用户将需要提供刷新令牌来获取新的访问令牌。在这一点上，我们确实检查了 DB 并看到该用户已被禁止。所以我们拒绝访问令牌的请求，禁令生效。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2012-05-24T01:57:33.347

引用的答案（通过@Anders）很有帮助，它指出：

> 万一被泄露，它的有效时间窗口是有限的，但令牌是通过 SSL 使用的，因此不太可能被泄露。

我认为重要的部分是访问令牌通常会被记录（特别是当用作查询参数时，这对 JSONP 很有帮助），因此最好将它们设为短暂的。

还有一些其他原因，服务提供商大规模实施 OAuth 2.0：

1.  如果不必担心撤销，API 服务器可以安全地验证访问令牌而无需数据库查找或 RPC 调用。这可以带来强大的性能优势并降低 API 服务器的复杂性。如果您可以接受 30m-60m（或任何访问令牌的长度）的令牌撤销，则最好。当然，API 服务器也可以在内存中保留最近一小时内撤销的令牌列表。

2.  由于令牌可以具有多个范围，可以访问多个不同的 API 服务，因此拥有短期访问令牌会阻止 API 服务的开发人员终身访问 API 服务 B 上的用户数据。划分有利于安全性。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-08-05T21:03:44.437

缩短可能的答案：

**刷新令牌允许令牌的范围/不同衰减时间。**实际资源令牌是短暂的，而刷新令牌可以保持多年有效（移动应用程序）。这带来了更好的安全性（资源令牌不必受到保护）和性能（只有刷新令牌 API 必须检查数据库的有效性）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2022-01-23T09:25:19.187

*以下是已经提到的刷新令牌的好处的补充。*

## 安全第一！

访问令牌是短暂的。如果有人窃取了访问令牌，他只能在访问令牌过期之前访问资源。

## “......但是如果刷新令牌被盗怎么办？”

如果攻击者窃取了刷新令牌，他可以获得访问令牌。出于这个原因，它建议每次获得新的访问令牌时都发布一个新的刷新令牌。如果相同的刷新令牌被使用了两次，则很可能意味着刷新令牌被盗了。

> 当每次使用后刷新令牌发生变化时，如果授权服务器曾经检测到刷新令牌被使用了两次，则意味着它可能已被复制并正在被攻击者使用，并且授权服务器可以撤销所有访问令牌和刷新令牌相关联立即使用它。

[https://www.oauth.com/oauth2-servers/making-authenticated-requests/refreshing-an-access-token/](https://www.oauth.com/oauth2-servers/making-authenticated-requests/refreshing-an-access-token/)

当然，这只是另一层安全性。攻击者仍有时间获取访问令牌，直到第二次使用刷新令牌（攻击者或真实用户）。

请始终牢记，刷新令牌必须尽可能安全地存储。

# java - 在 Jboss AS 7.1 Final 上找不到模块

> ID：10703534
> 
> 赞同：1
> 
> 时间：2012-05-22T13:56:03.240
> 
> 标签：java, jboss7.x

我在 Jboss 7.1 上部署了一个使用一些外部模块的 ear 文件。

我已将这些模块作为全局模块添加到我的 Standalone.xml 文件中：

```
<global-modules>
    <module name="org.jboss.messaging" slot="main"/>
    <module name="com.oblicore" slot="main"/>
    <module name="org.infinispan" slot="main"/>
</global-modules> 
```

但由于某种原因，第一个模块似乎无法识别，我收到此错误：

```
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at 

org.jboss.as.ejb3.tx.CMTTxInterceptor.handleExceptionInOurTx(CMTTxInterceptor.java:163) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.as.ejb3.tx.CMTTxInterceptor.invokeInOurTx(CMTTxInterceptor.java:230) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.as.ejb3.tx.CMTTxInterceptor.required(CMTTxInterceptor.java:304) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.as.ejb3.tx.CMTTxInterceptor.processInvocation(CMTTxInterceptor.java:190) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.as.ejb3.component.interceptors.CurrentInvocationContextInterceptor.processInvocation(CurrentInvocationContextInterceptor.java:41) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.as.ejb3.component.interceptors.LoggingInterceptor.processInvocation(LoggingInterceptor.java:59) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.as.ee.component.NamespaceContextInterceptor.processInvocation(NamespaceContextInterceptor.java:50) [jboss-as-ee-7.1.1.Final.jar:7.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.as.ejb3.component.interceptors.AdditionalSetupInterceptor.processInvocation(AdditionalSetupInterceptor.java:43) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.as.ee.component.TCCLInterceptor.processInvocation(TCCLInterceptor.java:45) [jboss-as-ee-7.1.1.Final.jar:7.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.invocation.ChainedInterceptor.processInvocation(ChainedInterceptor.java:61) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.as.ee.component.ViewService$View.invoke(ViewService.java:165) [jboss-as-ee-7.1.1.Final.jar:7.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.as.ee.component.ViewDescription$1.processInvocation(ViewDescription.java:173) [jboss-as-ee-7.1.1.Final.jar:7.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.as.ejb3.component.interceptors.AsyncFutureInterceptorFactory$1$1.runInvocation(AsyncFutureInterceptorFactory.java:71) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.as.ejb3.component.interceptors.AsyncInvocationTask.run(AsyncInvocationTask.java:73) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) [rt.jar:1.6.0_17]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) [rt.jar:1.6.0_17]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at java.lang.Thread.run(Thread.java:619) [rt.jar:1.6.0_17]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.threads.JBossThread.run(JBossThread.java:122)
INFO   | jvm 1    | 2012/05/22 16:43:22 | Caused by: java.lang.NoClassDefFoundError: org/jboss/jms/destination/JBossDestination
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at com.oblicore.manager.adapters.migration.handlers.MigrationHandler.bytesToMap(MigrationHandler.java:322) [MigrationToolAdapter-1.0.jar:1.0]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at com.oblicore.manager.adapters.migration.handlers.MigrationHandler.deserializeMsg(MigrationHandler.java:73) [MigrationToolAdapter-1.0.jar:1.0]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at com.oblicore.manager.adapters.migration.MigrationAdapter.startMigrationAdapter(MigrationAdapter.java:53) [MigrationToolAdapter-1.0.jar:1.0]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at com.oblicore.manager.adapters.migration.scheduler.MigrationAdapterAction.execute(MigrationAdapterAction.java:46) [MigrationToolAdapter-1.0.jar:1.0]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) [rt.jar:1.6.0_17]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) [rt.jar:1.6.0_17]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) [rt.jar:1.6.0_17]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at java.lang.reflect.Method.invoke(Method.java:597) [rt.jar:1.6.0_17]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.as.ee.component.ManagedReferenceMethodInterceptorFactory$ManagedReferenceMethodInterceptor.processInvocation(ManagedReferenceMethodInterceptorFactory.java:72) [jboss-as-ee-7.1.1.Final.jar:7.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.invocation.WeavedInterceptor.processInvocation(WeavedInterceptor.java:53) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.as.ee.component.interceptors.UserInterceptorFactory$1.processInvocation(UserInterceptorFactory.java:36) [jboss-as-ee-7.1.1.Final.jar:7.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.invocation.InterceptorContext$Invocation.proceed(InterceptorContext.java:374) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.as.ejb3.concurrency.ContainerManagedConcurrencyInterceptor.processInvocation(ContainerManagedConcurrencyInterceptor.java:104) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.invocation.InitialInterceptor.processInvocation(InitialInterceptor.java:21) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.invocation.ChainedInterceptor.processInvocation(ChainedInterceptor.java:61) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.as.ee.component.interceptors.ComponentDispatcherInterceptor.processInvocation(ComponentDispatcherInterceptor.java:53) [jboss-as-ee-7.1.1.Final.jar:7.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.as.ejb3.component.singleton.SingletonComponentInstanceAssociationInterceptor.processInvocation(SingletonComponentInstanceAssociationInterceptor.java:53) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.as.ejb3.tx.CMTTxInterceptor.invokeInOurTx(CMTTxInterceptor.java:228) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   ... 23 more
INFO   | jvm 1    | 2012/05/22 16:43:22 | Caused by: java.lang.ClassNotFoundException: org.jboss.jms.destination.JBossDestination from [Module "org.jboss.messaging:main" from local module loader @176cad3 (roots: C:\Program Files\Oblicore\JBOSS7\modules)]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.modules.ModuleClassLoader.findClass(ModuleClassLoader.java:190)
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.modules.ConcurrentClassLoader.performLoadClassUnchecked(ConcurrentClassLoader.java:468)
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.modules.ConcurrentClassLoader.performLoadClassChecked(ConcurrentClassLoader.java:456)
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.modules.ConcurrentClassLoader.performLoadClassChecked(ConcurrentClassLoader.java:423)
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.modules.ConcurrentClassLoader.performLoadClass(ConcurrentClassLoader.java:398)
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at org.jboss.modules.ConcurrentClassLoader.loadClass(ConcurrentClassLoader.java:120)
INFO   | jvm 1    | 2012/05/22 16:43:22 |   at java.lang.ClassLoader.loadClassInternal(ClassLoader.java:316) [rt.jar:1.6.0_17]
INFO   | jvm 1    | 2012/05/22 16:43:22 |   ... 47 more
INFO   | jvm 1    | 2012/05/22 16:43:22 | 
```

缺少的类肯定在这个模块中找到的 jar 中。任何的想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T09:56:12.000

在 Jboss 社区的某个人的帮助下，我终于设法解决了这个问题。

你可以在这里看到答案：[https ://community.jboss.org/message/737218#737218](https://community.jboss.org/message/737218#737218)

基本上我在模块上打开了 TRACE 日志记录，发现我实际上缺少 javax.jms.Destination，所以我只是向该模块添加了依赖项。

# java - 如何在 apache camel 中对 servlet 端点进行单元测试？

> ID：10703537
> 
> 赞同：5
> 
> 时间：2012-05-22T13:56:15.100
> 
> 标签：java, unit-testing, tomcat, junit, apache-camel

我是 Camel 的新手，现在在我的 Tomcat 服务器上运行了一条简单的路由。路线是这样构建的：

```
Processor generateWebResponse = new MySpecialProcessor();
from("servlet:///url?matchOnUriPrefix=true").process(generateWebResponse); 
```

我尝试了这样一个简单的单元测试：

```
Exchange lAuthRequest = createExchangeWithBody("[json body!]");
template.send("servlet:///url", lAuthRequest);
assertEquals("baseline body", lAuthRequest.getOut().getBody()); 
```

但得到一个异常，表明我无法创建 servlet 端点。这是异常消息：

```
org.apache.camel.FailedToCreateProducerException: Failed to create Producer for endpoint: Endpoint[servlet:///url]. Reason: java.lang.UnsupportedOperationException: You cannot create producer with servlet endpoint, please consider to use http or http4 endpoint. 
```

这是新的发展，所以除了好的设计之外我没有太多的限制。我愿意接受需要更改路线的建议。另外，如果我在上面做的事情不是惯用的，我很乐意用任何建议的改进来修改这个问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-22T14:06:50.370

您需要使用 http 客户端组件向 Tomcat 发送消息，例如 camel--http 组件：http: [//camel.apache.org/http](http://camel.apache.org/http)

然后，您需要知道 Tomcat 运行 servlet 的端口号，例如

```
template.send("http://localhost:8080/myapp/myserver", lAuthRequest); 
```

您需要将 camel-http 添加到您的类路径中，例如，如果您使用 maven，则将其添加为依赖项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T19:12:28.707

我通过将路线分成两部分来解决我的问题。现在路由声明如下所示：

```
from("servlet:///auth?matchOnUriPrefix=true").inOut("direct:auth");
from("direct:auth").process(new AuthorizationProcessor()); 
```

测试看起来像这样：

```
Exchange lAuthRequest = createExchangeWithBody("test body");
template.send("direct:auth", lAuthRequest);
assertEquals("processed body", lAuthRequest.getOut().getBody()); 
```

这不是一个完整的测试，但允许我覆盖所有路由，不包括传入的 servlet 部分。我觉得暂时够用了。

# google-app-engine - 503 和 400 在 Google App Engine 中上传图片

> ID：10703542
> 
> 赞同：5
> 
> 时间：2012-05-22T13:56:24.570
> 
> 标签：google-app-engine

最近我在将文件上传到我的 Java gae 应用程序时遇到了两个问题。我正在使用[blobstore doc](https://developers.google.com/appengine/docs/java/blobstore/overview)中描述的技术。

1.  对于常规文件，有时（假设 15% 的时间）客户端会收到“503 服务不可用”。
2.  对于高分辨率图像（例如 7000x10000），客户端总是会收到“400 Bad Request”。

在服务器上的这两种情况下，都没有记录错误消息，blob 写入正确，但从不调用 successPath url（[createUploadUrl](https://developers.google.com/appengine/docs/java/javadoc/com/google/appengine/api/blobstore/BlobstoreService.html#createUploadUrl%28java.lang.String%29)的回调）。由于某些原因，处理上传的 GAE 端点似乎崩溃了。

我的客户端是一个 js XMLHttpRequest，包裹在 GWT 中：

```
public native void uploadWithXMLHttpRequest(UploadForm uploadForm) /*-{
    var fd = new FormData();
    var files = uploadForm.@mypackage.UploadForm::getFiles()();  
    for (var i = 0; i < files.length; i++) {
        fd.append("uploadFile"+i, files[i]);
    }
    var xhr = new XMLHttpRequest();
    //xhr.upload.addEventListeners... omitted
    xhr.open("POST", uploadForm.@mypackage.UploadForm::getUploadUrl()());
    xhr.send(fd);
} 
```

关于可能的原因和解决方案/解决方法的任何想法？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T00:50:48.867

这个问题正在由另一个有同样问题的用户打开的 GAE 票证中讨论：[https](https://code.google.com/p/googleappengine/issues/detail?id=7619) ://code.google.com/p/googleappengine/issues/detail?id= 7619（顺便说一句，错误跟踪系统有一个“开始” 功能，可让您投票并接收通知）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-07T14:40:46.717

尝试使用 Google Cloud Storage，因为 blob 存储服务有很多问题，所以 google 正在尝试将使用从 Blob 迁移到 GCS 支持

我猜应用引擎 blob 商店中的图像分辨率不能超过 8000，这就是它造成的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-24T12:43:10.450

可能的原因：

1 您上传大文件 (> 1MB) 并将其全部写入。你应该把它写成portal：1 write = 1MB。

2 您的请求需要超过 30 秒 - 使用后端。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-24T16:27:52.397

在这种情况下，503 是由我们将上传信息写入您的数据存储区时的错误引起的。当您使用 M/S 数据存储时，可能会不时出现瞬态错误。我建议您将您的应用程序转换为 HRD，以最大程度地减少与将上传信息写入数据存储区相关的错误的可能性。

400 错误是由您的应用程序生成的，并且在您的应用程序日志中。

# ms-word - 通过 UI 设置/访问 Application.CutCopyMode 属性

> ID：10703551
> 
> 赞同：0
> 
> 时间：2012-05-22T13:57:05.470
> 
> 标签：ms-word

在我们的一个 Lotus Notes 应用程序中，我们面临“此方法或属性不可用，因为剪贴板为空或无效”的错误。该代码基本上是打开一个文档，选择所有文本，复制它，然后将其粘贴到 MS Word 文档中。它对一堆文档连续执行此操作。我发现这个[链接](http://www.tek-tips.com/viewthread.cfm?qid=1637602)基本上建议添加`Application.CutCopyMode = False`到代码中来解决问题。

我需要知道是否可以通过 MS Word 的 UI 访问和设置此属性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T20:01:51.433

在您引用的示例中，该关键字实际上是 Excel 对象模型的一部分，而不是 Word 对象模型。所以你不太可能在 Word 的 UI 中找到它。也许您也在使用 Excel 做某事，或者它也是相关 Lotus 对象模型中的关键字？

[ OP 提到了一个链接， [http://www.tech-archive.net/Archive/Word/microsoft.public.word.vba.general/2007-06/msg00446.html](http://www.tech-archive.net/Archive/Word/microsoft.public.word.vba.general/2007-06/msg00446.html) 建议更改变量名称，但确实如此不行。

链接的文章还建议“在复制和粘贴之间休眠几毫秒”]

# jquery - Rails 找不到文件 jquery purr

> ID：10703552
> 
> 赞同：4
> 
> 时间：2012-05-22T13:57:15.440
> 
> 标签：jquery, ruby-on-rails-3, ruby-on-rails-3.2

我正在使用导轨 3.2.3

我在 application.js 中包含以下文件

```
//= require jquery.purr
//= require best_in_place 
```

现在看起来像这样

```
//= require jquery
//= require jquery_ujs
//= require jquery.purr
//= require best_in_place
//= require_tree 
```

我收到一条错误消息：

找不到文件'jquery.purr'

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T14:07:28.820

Rails 并不神奇地知道从哪里下载脚本。

您必须下载并将它们放在`app/assets/javascript`目录中。

在这里可以找到 jQuery Purr：[http ://code.google.com/p/jquery-purr/](http://code.google.com/p/jquery-purr/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-28T18:37:37.213

如果您使用的是 best_in_place gem 的当前 HEAD，则无需下载 jquery.purr。它作为 best_in_place.purr 包含在 gem 中。因此，您将在 application.js 中添加以下内容：

```
//= require jquery
//= require best_in_place
//= require best_in_place.purr 
```

请注意，这不会为 purr 通知提供像样的 CSS。为此，您可以执行类似于 best_in_place[测试应用程序](https://github.com/bernat/best_in_place/blob/master/test_app/app/assets/stylesheets/style.css.erb)所做的事情（发布时的第 62 行到第 87 行）。

# css - Chrome 19 中的 Z-index 渲染错误？

> ID：10703553
> 
> 赞同：6
> 
> 时间：2012-05-22T13:57:15.923
> 
> 标签：css, google-chrome, z-index

直到最近，我在所有浏览器（包括 Chrome）中都正确显示的网站上有一个下拉菜单。现在在 Chrome 19 中，即使它们都有定位并且菜单具有更高的 z-index，它也会呈现在另一个元素的后面。

见右上角的图片：

![在此处输入图像描述](../Images/e4ccdfb7956c005ca41426efc03f8e1e.png)

这里是网站： [http ://www.mediaplanet.com/international/](http://www.mediaplanet.com/international/)

这是渲染错误还是我的代码有问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T15:09:03.407

在您的`style.css`样式表中，设置一个`z-index`to`9999`并且`#header .row`应该这样做。

目前是：

```
#header .row {
  position: relative;
  overflow: visible;
} 
```

如果您将其更改为，它在 Chrome 19 中适用于我：

```
#header .row {
  position: relative;
  overflow: visible;
  z-index: 99999;
} 
```

这应该够了吧！:)

# javascript - 验证问卷表？

> ID：10703555
> 
> 赞同：-2
> 
> 时间：2012-05-22T13:57:22.337
> 
> 标签：javascript, forms, validation, dom-events

我对 JS 的了解非常有限，我需要帮助来验证这个表格，所以它就像他们之前的调查问卷一样，你可以在[这个 URL上看到](http://spillcraft.com/test.html)

最好使用 jQuery 插件还是 Javascript？我试图得到它，所以当您为每个问题选择一个复选框时，您会在右下角显示一个分数，如果您得到正确的答案，分数会增加 1。

可能是迄今为止我在 JS 中所做的最大的事情。任何指示或建议？建议将不胜感激。

当前的新表格[在这里](http://spillcraft.flyingatom.everycity.co.uk/are-you-spill-safe/are-you-spill-safe.aspx)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:03:09.273

我会使用 jQuery 或服务器端验证。此外，将您的复选框更改为单选按钮组，这样只能选择一个，因为单选按钮的工作方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-30T15:30:38.927

我已经设法解决了这个问题 - 编写了一个点击函数，并喜欢为分数创建变量，如果答案正确，则在点击时增加这个变量，然后将其扩展到设置的 div 中。

花了很长时间才完成但最终到达了那里:)

# algorithm - 排序方式：二叉搜索树

> ID：10703556
> 
> 赞同：1
> 
> 时间：2012-05-22T13:57:25.490
> 
> 标签：algorithm, data-structures, tree, binary-search-tree

我对最坏情况时间和平均情况时间复杂度有点困惑。我的困惑来源在 [这里](http://www.cs.ucr.edu/cs14/cs14_06win/slides/BinarySearchTrees.pdf)

我的目标是按递增顺序缩短数据：我选择 BST 来完成我的排序任务。在这里，我正在按递增顺序打印数据。

```
 1) Construct a binary search tree for given input.
        Time complexity: Avg Case O(log n)
                         Worst Case O(H) {H is height of tree, here we can Assume Height is equal to number of node H = n}

 2)After Finishing first work I am traversing BST in Inorder to print data in Increasing order. 
        Time complexity: O(n) {n is the number of nodes in tree}

Now  I analyzed total complexity for get my desire result (data in increasing order) is for Avg Case: T(n) = O(log n) +O(n) = max(log n, n) = O(n)
      For Worst Case : T(n) = O(n) +O(n) = max(n, n) = O(n) 
```

以上是我的理解，这与上述链接概念不同。我知道我在做一些错误的解释请纠正我。我会很感激你的建议和想法。

请在我提到的幻灯片下参考此标题： ![在此处输入图像描述](../Images/0b64af6483e3ea62f686af4b4870e4ed.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:13:31.107

在 (1) 中，您提供每个元素的时间，您需要乘以元素的数量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T14:13:44.610

构建二叉树所需的时间复杂度是您建议的复杂度的 n 倍，因为您需要插入每个节点。

# actionscript-3 - 从 AS3 中的缩放视频中保存原始 bitmapData

> ID：10703558
> 
> 赞同：1
> 
> 时间：2012-05-22T13:57:37.160
> 
> 标签：actionscript-3, flash, webcam, scaling, bitmapdata

我有一个闪光照相亭（网络摄像头）应用程序，我正在尝试结束它，但在尝试从缩小的视频窗口保存 640x480 图像时似乎遇到了问题。视频似乎可以按比例缩小，但是当我将其绘制为位图时，它会进一步缩小照片，因此我必须创建一个 2.0 的矩阵比例以将其调整回 640x480，我不确定这样做是否会伤害图像质量。我不想使用任何调整大小的技巧（尤其是放大）。

我是 AS3 新手，请见谅。

```
import flash.display.Bitmap;
import flash.display.BitmapData;
import com.adobe.images.JPGEncoder;

var cam:Camera = Camera.getCamera();
cam.setQuality(0, 100);
cam.setMode(640,480,30,true); // setMode(videoWidth, videoHeight, video fps, favor   area)
var video:Video = new Video();
video.attachCamera(cam);
video.x = 382;
video.y = 225;
video.width = 256;
video.height = 192;
addChild(video);

var bitmapData:BitmapData = new BitmapData(640,480);

var bitmap:Bitmap = new Bitmap(bitmapData);
bitmap.x = 648;
bitmap.y = 225;
bitmap.width = 256;
bitmap.height = 192;
addChildAt(bitmap, 18);

photoCapture.buttonMode = true;
photoCapture.addEventListener(MouseEvent.CLICK,captureImage); 
```

这是肮脏的部分......

```
function captureImage(e:MouseEvent):void {
var scale:Number=2.0;
var matrix:Matrix = new Matrix();
matrix.scale(scale, scale);
bitmapData.draw(video, matrix, null, null, null, true);

var jpgEncoder:JPGEncoder=new JPGEncoder(100);
var byteArray:ByteArray=jpgEncoder.encode(bitmapData);

var fileReference:FileReference=new FileReference();
fileReference.save(byteArray, ".jpg");
} 
```

基本上我只想要两个大约 256x192 的小盒子，显示视频流 (640x480) 和捕获的照片 (640x480)，当我保存它时，实际上保存的是 640x480 图像。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T16:23:05.187

```
var video:Video = new Video(640, 480); 
```

这应该避免必须使用矩阵。视频默认为 320x240。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T16:32:12.220

*   首先，您创建一个 256x192 的视频
*   然后你创建一个 bitmapData 640x480
*   然后你把这个位图数据（实际上是位图）缩小到 256x192
*   然后你尝试将一个小视频绘制成一个大位图（数据） - 难怪你必须升级

创建一个相同大小的 BitmapData、Bitmap 和 Video，一切都应该没问题。

如果您希望最终图像为 640x480，您应该创建此尺寸的视频、位图、位图数据，然后将视频添加到空的 MovieClip/Sprite（容器）并缩放容器以使其适合屏幕。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-18T16:50:48.400

```
private var cam:Camera;
private var myVideo:Video;

    private function attachCamera():void
    {

        cam = Camera.getCamera();
        cam.setMode(8192,6144,30,true);
        cam.setQuality(0,100);

        myVideo = new Video(160,120);

        //Flip preview on camera and result!
        var flip:Matrix = new Matrix();
        flip.scale(-1,1)
        flip.translate(myVideo.width,0)

        myVideo.transform.matrix = flip;

        myVideo.attachCamera(cam);

        videoDisplay.addChild(myVideo);

    }

    private function takePicture():void
    {

        var bd:BitmapData = new BitmapData(cam.width,cam.height);
            //fill db with source bitmap!!!
            cam.drawToBitmapData(bd)

        //Then the bd contains the highest possible camera source!
        // But videoDisplay show's small preview!

    } 
```

# google-chrome-extension - chrome扩展程序中的消息传递

> ID：10703559
> 
> 赞同：0
> 
> 时间：2012-05-22T13:57:42.727
> 
> 标签：google-chrome-extension

contenscript.js 可以使用 option.js 进行通信吗

```
chrome.extension.sendRequest() 
```

和

```
chrome.extension.onRequest.addListener() 
```

?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T14:07:39.677

当然，这就是重点。请参阅[http://code.google.com/chrome/extensions/extension.html](http://code.google.com/chrome/extensions/extension.html)

如果您需要，这是一个示例：

发送：

[https://github.com/Canop/Chrall/blob/master/chrome/chrall/chrall_cdm.js](https://github.com/Canop/Chrall/blob/master/chrome/chrall/chrall_cdm.js)

接收 ：

[https://github.com/Canop/Chrall/blob/master/chrome/chrall/chrome-extension.html](https://github.com/Canop/Chrall/blob/master/chrome/chrall/chrome-extension.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T17:57:12.627

尝试这个。

*在内容脚本中：*

```
chrome.extension.sendRequest({method: "getStatus"}, function(response) {
    console.log(response.status);
}); 
```

*在扩展脚本中：*

```
chrome.extension.onRequest.addListener(function(request, sender, sendResponse) {
    if (request.method === "getStatus") sendResponse({status: "status"});
}); 
```

# php - 如何创建和 AJAX 任何滑块（长帖）

> ID：10703564
> 
> 赞同：0
> 
> 时间：2012-05-22T13:58:09.650
> 
> 标签：php, jquery, ajax, slider

我正在使用 php、来自 CSS Tricks 的任何 Slider jQuery 插件和 jQuery AJAX 来尝试创建一个滑块，我可以在其中将图像添加到目录并自动更新滑块。下面，我将发布 PHP、Javascript 和 HTML，然后我将解释这些问题。

```
<?php
function hello(){
$dir ='../images';
// Open a known directory, and proceed to read its contents
if (is_dir($dir)) {
    if ($dh = opendir($dir)) {
        while (($file = readdir($dh)) !== false) {
           if ($file != "." && $file != ".." && $file != ".DS_Store"&& $file != "../images") {
            echo "<li><img src=\"http://localhost:8888/wordpress/wp-content/themes/perpetualC/images/$file\" class=\"image\"></li> \n"; 
//add <li> tags, trying to fix the problem...
            }
        }
          closedir($dh);
        }
    } 
}
hello();

?> 
```

这个功能完美，位于一个名为 image.php 的文件中，由以下代码块完美调用。

```
$(document).ready(function() {
$.get('images.php', function(data) {    
    var lines = data.split("\n");
    $.each(lines, function(n, elem) {
       $('#slider').append( elem );
       //comment out an attempt to fix the issue, the <li> tags here were replaced by tags in the PHP.
       //$('.image').wrap('<li>'); 
    });
});
$('#slider').anythingSlider({
    resizeContents: true,
    addWmodeToObject: 'transparent',
    autoPlay: true,
    delay: 1500
});
}); // end ready 
```

现在问题就从这里开始了。这会呈现来自 Firebug 的以下代码块

```
<section class="stuff">
 <div style="width: 860px; height: 200px;" class="anythingSlider anythingSlider-default activeSlider">
<div class="anythingWindow">
  <ul style="width: 0px;" class="anythingBase horizontal" id="slider">
    <li><img src="http://localhost:8888/images/bg.jpg" class="image"></li>
    <li><img src="http://localhost:8888/images/bg.psd" class="image"></li>
    <li><img src="http://localhost:8888/images/bg1.jpg" class="image"></li>
    <li><img src="http://localhost:8888images/bg2.jpg" class="image"></li>
    <li><img src="http://localhost:8888/images/blackTransGradient.png" class="image"></li>
    <li><img src="http://localhost:8888/images/whiteTransGradient.png" class="image"></li>
  </ul>
</div>
<div style="display: none;" class="anythingControls">
  <ul style="display: none;" class="thumbNav">
  </ul>
  <a style="display: none;" href="#" class="start-stop playing"><span>Stop</span></a></div>
<span style="display: none;" class="arrow back"><a href="#"><span>«</span></a></span><span style="display: none;" class="arrow forward"><a href="#"><span>»</span></a></span></div> 
```

这……什么都没做！一个正常工作的任何滑块将在`<li>`标签上具有以设定间隔更改的类......这根本没有类。有什么帮助吗？我的问题在哪里？我知道这样的事情是可能的，因为这个 jsFiddle，[http://jsfiddle.net/Cm479/248/](http://jsfiddle.net/Cm479/248/)但我不知道如何解决我的问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T15:00:20.443

您在 JavaScript 上存在部分竞争条件。滑块正在寻找它们尚不存在的图片。

试试这个：

```
 $(document).ready(function() {

    $.get('images.php', function(data) {    
        var lines = data.split("\n");

        $.each(lines, function(n, elem) {
           $('#slider').append( elem );
           //comment out an attempt to fix the issue, the <li> tags here were replaced by tags in the PHP.
           //$('.image').wrap('<li>'); 
        });

        $('#slider img').promise().done(function() {
            $('#slider').anythingSlider({
                resizeContents: true,
                addWmodeToObject: 'transparent',
                autoPlay: true,
                delay: 1500
            });
        });

    });

}); 
```

# java - 使用不同的行/列数据更新 AjaxFallbackDefaultDataTable

> ID：10703566
> 
> 赞同：0
> 
> 时间：2012-05-22T13:58:15.177
> 
> 标签：java, wicket

我有一个带有多个页面的检票口应用程序，其中许多页面使用 AJAX 表来显示数据。但到目前为止，它们的列都是静态的，只有行发生了变化。新屏幕执行以下操作：

*   用户输入各种查询参数并点击提交。一个参数是日期单位（小时、天、周或月），它与从/到日期一起指定要显示的列数。
*   数据提供者获取参数并刷新要显示的数据

..但是如何更新表中的列？

查看表代码中的 DataGridView 对象，如果没有对数据表对象进行重大重新实现，这些列似乎是不可更改的。有没有人有任何示例说明如何在基础数据更改时更新表的行和列？甚至可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T16:59:42.357

如果您持有对您在构造函数中提供数据表的 List 的引用，理论上您应该能够操纵它来删除/添加列。但是，我不确定数据表周围的所有代码是否都考虑了该用例。

最安全的方法是简单地将数据表实例替换为具有正确列列表的新实例。

所以像这样

```
addOrReplace(new DataTable("table", ...)) 
```

每当列需要更改时。

# c# - 字符串格式在本地而不是在服务器中工作

> ID：10703568
> 
> 赞同：3
> 
> 时间：2012-05-22T13:58:24.067
> 
> 标签：c#, asp.net, gridview

我正在格式化这样的字符串'212,121'。它与本地机器中的以下代码完美配合。但它在服务器上不起作用。请帮我解决这个错误...

这是我的格式：

```
 <%#Eval("balance","{0:###,###,0}") %> 
```

它在本地而不是在服务器中工作正常......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-22T14:00:27.183

检查两者的区域设置是否相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T14:13:07.763

你试过这样的事情吗？（注意：未经测试的代码）

```
 <%#String.Format(CultureInfo.InvariantCulture, "{0:###,###,0}", DataBinder.Eval(Container.DataItem, "balance").ToString)%> 
```

# smart-mobile-studio - 检查 SmartMS 中是否未定义函数参数？

> ID：10703569
> 
> 赞同：3
> 
> 时间：2012-05-22T13:58:27.093
> 
> 标签：smart-mobile-studio

如何检查函数参数是否未定义？

```
procedure Test(aValue: TObject);
begin
  if aValue <> nil then
    ShowMessage('param filled')      <-- also when Test() is executed!
  else
    ShowMessage('no param filled')   <-- not called, only when Test(nil) is called
end; 
```

但是当这个函数在没有参数的纯 JS 中调用时，aValue = undefined，但是 <> nil 检查被转换为 == null！

例如，当你有一个带有回调的 JS 函数时：

```
type
  TObjectProcedure = procedure(aValue: TObject);

procedure FetchUrlAsync(aUrl: string; aCallback: TObjectProcedure )
begin
  asm
    $().load(@aUrl, @aCallback);
  end;
end; 
```

您可以使用以下命令调用此函数：

```
FetchUrlAsync('ajax/test.html', Test); 
```

现在是否使用参数调用“测试”取决于 jQuery。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T06:23:32.440

在下一个版本中，您将能够使用[Defined()](http://code.google.com/p/dwscript/wiki/SpecialDefined "定义（）")特殊函数，它将对 undefined 进行严格检查（对于 null 值，它将返回 true）。

```
if Defined(aValue) then
   ... 
```

在当前版本中，您可以定义一个函数来检查

```
function IsDefined(aValue : TObject);
begin
   asm
      @result = (@aValue!==undefined);
   end;
end; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-06T16:27:10.740

在当前版本 (1.0) 中，您可以使用函数 varIsValidRef() 检查值是否未定义。该函数是 w3system.pas 的一部分，因此它始终存在。它看起来像这样：

```
function varIsValidRef(const aRef:Variant):Boolean;
begin
  asm
    if (@aRef == null) return false;
    if (@aRef == undefined) return false;
    return true;
  end;
end; 
```

这会检查 null 和 undefined ，因此您也可以将它用于对象引用（THandle 类型是变体）。

# ruby-on-rails - 不断得到：PartnersController#create 中的 ActiveRecord::UnknownAttributeError？

> ID：10703573
> 
> 赞同：1
> 
> 时间：2012-05-22T13:58:38.270
> 
> 标签：ruby-on-rails, ruby-on-rails-3, database-design, nested-forms, nested-attributes

我不断在 PartyController#create 中收到 ActiveRecord::UnknownAttributeError：

我有三个模型：Party、Products、Traits。

```
 class Party < ActiveRecord::Base
  has_many :products
  accepts_nested_attributes_for :products
  end

  class Product < ActiveRecord::Base
  belongs_to :party
  has_many :traits
  accepts_nested_attributes_for :traits
  end

  class Trait < ActiveRecord::Base
  belongs_to :product
  end 
```

聚会形式：

```
 <%= form_for(@party) do |f| %>
  <% if @party.errors.any? %>
  <div id="error_explanation">
  <h2><%= pluralize(@party.errors.count, "error") %> prohibited this party from being    
  saved:</h2>

  <ul>
  <% @party.errors.full_messages.each do |msg| %>
  <li><%= msg %></li>
  <% end %>
  </ul>
  </div>
  <% end %>

  <div class="field">
  <%= f.label :name %><br />
  <%= f.text_field :name %>
  </div>
  <table> 
  <%= f.fields_for :products do |builder| %>

  <tr> 
  <td> <%= builder.label :shirt, "Shirt " %> </td>
  <td> <%= builder.text_field :shirt %> </td>

  <%= f.fields_for :traits do |builder| %>
  <td><%= builder.label :color, "Color" %></td>
  <td><%= builder.text_field :color %></td>
  <td><%= builder.label :quantity, "Quantity" %></td>
  <td><%= builder.number_field :quantity %></td>
  </tr>
  <tr>
  <td><%= builder.label :pants, "Pants " %></td>
  <td><%= builder.text_field :pants %></td>
  <td><%= builder.label :color, "Color" %></td>
  <td><%= builder.text_field :color %></td>
  <td><%= builder.label :quantity, "Quantity" %></td>
  <td><%= builder.number_field :quantity %></td>
  </tr>
  <% end %>
  <% end %> 
  </table>
  <div class="actions">
  <%= f.submit %>
  </div>
  <% end %> 
```

当事人控制人：

```
 class PartiesController < ApplicationController
  def new
  @party = Party.new
1.times do
product = @party.products.build
2.times {product.traits.build}
  end
  end

  def create
  @party = Party.new(params[:party])

  respond_to do |format|
  if @party.save
    format.html { redirect_to @party, notice: 'Party was successfully created.' }
    format.json { render json: @party, status: :created, location: @party }
  else
    format.html { render action: "new" }
    format.json { render json: @party.errors, status: :unprocessable_entity }
  end
  end
  end 
```

显示页面：<%= 通知 %>

```
 This is <%= @party.name %>'s registry:
  <table>
  <% for product in @party.products %>
  <tr>  
  <td>Shirt</td>
  <td> <%= product.shirt %> </td>
  <% for trait in @product.traits %>
  <td>Color</td>
  <td> <%= trait.color %> </td>
  <td>Quantity</td>
  <td> <%= trait.quantity %> </td>
  </tr>
  <tr>
  <td>Pants</td>
  <td> <%= product.pants %> </td>
  <td>Color</td>
  <td> <%= trait.color %> </td>
  <td>Quantity</td>
  <td> <%= trait.quantity %> </td>
  </tr>
  <% end %> 
  </table>

  <%= link_to 'Edit', edit_party_path(@party) %> |
  <%= link_to 'Back', parties_path %>
  <% end %> 
```

我什么都试过了。我错过了什么？感谢人们！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T15:02:20.383

所以 params[:party] 散列可能包含表单中不是 Party 属性的元素。要调试，请尝试：

```
def create
  @party = Party.new(:name => params[:party][:name]) 
```

我认为真正的复杂之处在于 Traits 嵌套在 Products 下，而 Products 嵌套在 Party 下。这就是为什么`fields_for`Traits 的方法需要是 `builder.fields_for :traits do |traits_fields|' （尽管我认为您*可以*使用“builder”而不是“traits_fields”。

然后对于所有特征字段，使用`<%= traits_fields.label :pants, "Pants " %>`

然后它应该按照您的方式工作：

```
def create
  @party = Party.new(params[:party]) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T15:35:02.693

参数中的错误，`traits`应该是什么时候`"products_attributes"=>{"traits_attributes" => ...`。

试试这个：`<%= builder.fields_for :traits do |traits_fields| %>`而不是：`<%= f.fields_for :traits do |builder| %>`

# python - PyThread_acquire_lock - 获取密钥的问题

> ID：10703574
> 
> 赞同：1
> 
> 时间：2012-05-22T13:58:48.000
> 
> 标签：python, multithreading, thread-safety, python-multithreading, pydbg

我正在编写多线程 python 应用程序。

主线程创建一个由 5 个工作线程组成的线程池。主线程还创建了一个 Monitor Thread。

总计：6 个线程 + 1 个主线程 = 7

所有线程都与 MySQL 服务器对话 (mysqldb -> libmysqlclient_r)

在我的 SQL 包装器中，我向 DB 查询函数添加了一个 Threading.Lock。这个锁是一个全局锁，所有查询数据库的线程都使用它。

```
def query(self, query):
  with lock:
   execute Query Here 
```

一切正常，直到某个时候，主线程卡住了（所有线程也卡住了）我附加了 GDB 调试器并注意到：（信息线程）

```
 7 Thread 0x7f555c386700 (LWP 16077)  0x00007f5561a503c0 in sem_wait () from /lib/libpthread.so.0
  6 Thread 0x7f555bb85700 (LWP 16078)  0x00007f5561a503c0 in sem_wait () from /lib/libpthread.so.0
  5 Thread 0x7f555b384700 (LWP 16079)  0x00007f5561a503c0 in sem_wait () from /lib/libpthread.so.0
  4 Thread 0x7f555ab83700 (LWP 16080)  0x00007f5561a503c0 in sem_wait () from /lib/libpthread.so.0
  3 Thread 0x7f555a382700 (LWP 16081)  0x00007f5561a503c0 in sem_wait () from /lib/libpthread.so.0
  2 Thread 0x7f5559b81700 (LWP 16083)  0x00007f55609141a3 in select () from /lib/libc.so.6
  1 Thread 0x7f5561e6f700 (LWP 16061)  0x00007f5561a503c0 in sem_wait () from /lib/libpthread.so.0 
```

Th1 = 主线程，Th2 = 监控线程，Th3-Th7 - 工作线程

我注意到监视器线程旁边的所有线程都在等待 sem_wait()：

```
(gdb) bt
#0  0x00007f5561a503c0 in **sem_wait** () from /lib/libpthread.so.0
#1  0x00000000004d44e8 in **PyThread_acquire_lock** ()
#2  0x00000000004d8982 in ?? ()
#3  0x00000000004a7ba5 in PyEval_EvalFrameEx () 
```

但是，监视器线程能够获取和释放锁（它每 30 秒运行一次，您看到的 select() 是由于 sleep(30)）。我不明白，为什么其余线程都卡在 sem_wait() 上，因为没有人获得锁。

任何想法如何解决这个问题？如何调试这个？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T16:38:55.543

似乎我使用多个线程使用相同的连接，这是 DOCS 不允许的。

提示：确保每个 Thread 都有自己的 Connection 对象。

# html - 有序列表 - 双字母

> ID：10703576
> 
> 赞同：2
> 
> 时间：2012-05-22T13:58:53.493
> 
> 标签：html, html-lists

这可能是一个简单的问题，但它现在正在躲避我。

我有一个有序列表，它超出了 AZ 并进入了双字母，这很好。双字母以这种格式出现：

AA。AB。交流。

并且想知道是否有办法让它们变成：

AA。BB。抄送。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T14:02:02.803

来自[Mozilla Dev 的文档](https://developer.mozilla.org/en/CSS/list-style-type)：

> CSS 规范没有定义字母系统如何在字母表末尾换行。例如，在 26 个列表项之后，未定义上 alpha 渲染。Firefox 和其他浏览器将继续为 AA、AB、AC、... 对于长列表，建议作者指定真实数字。

# python - Python MySQL 数据操作

> ID：10703578
> 
> 赞同：0
> 
> 时间：2012-05-22T13:58:57.563
> 
> 标签：python

我有一个 uni 的任务，我碰壁了，我似乎无法让它工作，无论我尝试什么。

因此，本次作业的重点是从 Python 访问 MySQL 数据库，以及查看和排列数据。该数据库名为 inb104，存在两个表，cars_for_sale 和 car_details。

这是我的代码

```
def top_N_expensive(num_of_highest):
connection = MySQLdb.connect(host='localhost', user='root', passwd='root',\
                                                                 db='inb104')
cursor = connection.cursor()
sql = "SELECT cars_for_sale.make, cars_for_sale.model, +'$'+car_details.price \
            FROM cars_for_sale, car_details WHERE cars_for_sale.CarId = car_details.CarId \
            ORDER BY price DESC,price LIMIT " + str(num_of_highest)
cursor.execute(sql) 
rows = cursor.fetchall()
for row in rows:
    print row[0], row[1], row[2]
cursor.close()
connection.close() 
```

现在，当我运行此代码时，测试用例失败，这只是其中一个测试用例，但其余的都是相同的

```
File "__main__", line 4, in __main__
Failed example:
top_N_expensive(10)
Expected:
VOLKSWAGEN GOLF $1300000
MERCEDES-BENZ SL $329990
BMW 3 $299990
MERCEDES-BENZ SL $249990
PORSCHE 911 $249990
MERCEDES-BENZ SL $224990
PORSCHE 911 $219990
PORSCHE 911 $190000
PORSCHE 911 $184990
BMW M5 $180000
Got:
VOLKSWAGEN GOLF 1300000.0
MERCEDES-BENZ SL 329990.0
BMW 3 299990.0
MERCEDES-BENZ SL 249990.0
PORSCHE 911 249990.0
MERCEDES-BENZ SL 224990.0
PORSCHE 911 219990.0
PORSCHE 911 190000.0
PORSCHE 911 184990.0
BMW M5 180000.0 
```

如您所见，它失败了，因为末尾有一个零，而开头没有 $，有人知道问题所在吗？

编辑：添加此新代码后

```
for row in rows:
    print "%s %s $%d" % (row[0], row[1], row[2]) 
```

我得到了 3/4 个测试用例通过，我不知道为什么最后一个没有通过，但这是测试用例转储

```
Trying:
top_N_expensive(10)
Expecting:
VOLKSWAGEN GOLF $1300000
MERCEDES-BENZ SL $329990
BMW 3 $299990
MERCEDES-BENZ SL $249990
PORSCHE 911 $249990
MERCEDES-BENZ SL $224990
PORSCHE 911 $219990
PORSCHE 911 $190000
PORSCHE 911 $184990
BMW M5 $180000

Warning (from warnings module):
File "Z:\Documents\top_N_expensive.py", line 82
cursor.execute(sql)
Warning: Truncated incorrect DOUBLE value: '$'
ok
Trying:
top_N_expensive(15)
Expecting:
VOLKSWAGEN GOLF $1300000
MERCEDES-BENZ SL $329990
BMW 3 $299990
MERCEDES-BENZ SL $249990
PORSCHE 911 $249990
MERCEDES-BENZ SL $224990
PORSCHE 911 $219990
PORSCHE 911 $190000
PORSCHE 911 $184990
BMW M5 $180000
MERCEDES-BENZ E55 $179990
MERCEDES-BENZ CLS $179990
PORSCHE 911 $165000
PORSCHE 911 $164900
PORSCHE 911 $161950
**********************************************************************
File "__main__", line 17, in __main__
Failed example:
top_N_expensive(15)
Expected:
VOLKSWAGEN GOLF $1300000
MERCEDES-BENZ SL $329990
BMW 3 $299990
MERCEDES-BENZ SL $249990
PORSCHE 911 $249990
MERCEDES-BENZ SL $224990
PORSCHE 911 $219990
PORSCHE 911 $190000
PORSCHE 911 $184990
BMW M5 $180000
MERCEDES-BENZ E55 $179990
MERCEDES-BENZ CLS $179990
PORSCHE 911 $165000
PORSCHE 911 $164900
PORSCHE 911 $161950
Got:
VOLKSWAGEN GOLF $1300000
MERCEDES-BENZ SL $329990
BMW 3 $299990
MERCEDES-BENZ SL $249990
PORSCHE 911 $249990
MERCEDES-BENZ SL $224990
PORSCHE 911 $219990
PORSCHE 911 $190000
PORSCHE 911 $184990
BMW M5 $180000
MERCEDES-BENZ CLS $179990
MERCEDES-BENZ E55 $179990
PORSCHE 911 $165000
PORSCHE 911 $164900
PORSCHE 911 $161950
Trying:
top_N_expensive(1)
Expecting:
VOLKSWAGEN GOLF $1300000
ok
Trying:
top_N_expensive(0)
Expecting nothing
ok
1 items had no tests:
__main__.top_N_expensive
**********************************************************************
1 items had failures:
1 of   4 in __main__
4 tests in 2 items.
3 passed and 1 failed.
***Test Failed*** 1 failures. 
```

所以，不知道为什么现在失败了，很奇怪。

这是更新的查询

```
def top_N_expensive(num_of_highest):
connection = MySQLdb.connect(host='localhost', user='root', passwd='root',\
                                                                 db='inb104')
cursor = connection.cursor()
sql = "SELECT cars_for_sale.make, cars_for_sale.model, +'$'+car_details.price \
            FROM cars_for_sale, car_details WHERE cars_for_sale.CarId = car_details.CarId \
            ORDER BY price DESC, make, model DESC" + str(num_of_highest)
cursor.execute(sql) 
rows = cursor.fetchall()
for row in rows:
    print "%s %s $%d" % (row[0], row[1], row[2]) 
cursor.close()
connection.close() 
```

测试用例

```
Trying:
top_N_expensive(10)
Expecting:
VOLKSWAGEN GOLF $1300000
MERCEDES-BENZ SL $329990
BMW 3 $299990
MERCEDES-BENZ SL $249990
PORSCHE 911 $249990
MERCEDES-BENZ SL $224990
PORSCHE 911 $219990
PORSCHE 911 $190000
PORSCHE 911 $184990
BMW M5 $180000
**********************************************************************
File "__main__", line 4, in __main__
Failed example:
top_N_expensive(10)
Exception raised:
Traceback (most recent call last):
  File "C:\Program Files\Python27\lib\doctest.py", line 1254, in __run
    compileflags, 1) in test.globs
  File "<doctest __main__[0]>", line 1, in <module>
    top_N_expensive(10)
  File "Z:\Documentstop_N_expensive.py", line 82, in top_N_expensive
    cursor.execute(sql)
  File "C:\Program Files\Python27\lib\site-packages\MySQLdb\cursors.py", line 174, in execute
    self.errorhandler(self, exc, value)
  File "C:\Program Files\Python27\lib\site-packages\MySQLdb\connections.py", line 36, in defaulterrorhandler
    raise errorclass, errorvalue
ProgrammingError: (1064, "You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'DESC10' at line 1") 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T14:26:00.597

与上一个略有不同：

```
for row in rows:
    print("{} {} ${:0.0f}".format(*row)) 
```

编辑：您的编辑的后续行动 - 您在 E55 之前返回 CLS，它希望他们以另一种方式。检查您的排序顺序；尝试

```
... ORDER BY price DESC, make, model DESC 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T14:27:58.083

如果您想在`SELECT`语句中执行此操作，可以尝试使用[`CONCAT`](http://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_concat)and [`ROUND`](http://dev.mysql.com/doc/refman//5.5/en/mathematical-functions.html#function_round)：

```
SELECT CONCAT('$', ROUND(car_details.price)) AS price FROM car_details; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T14:10:23.940

做一些简单的[字符串格式化](http://docs.python.org/release/2.5.2/lib/typesseq-strings.html)应该会让你到达那里：

```
for row in rows:
    print "%s %s $%d" % (row[0], row[1], row[2]) 
```

`%s`字符用于输出字符串。`%d`用于输出整数（没有小数部分的数字），所以有点作弊。您还可以使用`%.0f`显示以 0 位小数打印的浮点数（而`%.2f`将数字显示到小数点后两位）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T14:05:15.187

看看这个问题[货币格式在 puython](https://stackoverflow.com/questions/320929/currency-formatting-in-python)，它很可能是你想要的。作为一种更 hacky 的方式，您可以转换为字符串并使用字符串操作。

**编辑**

从上面引用的问题中复制

```
>>> import locale
>>> locale.setlocale( locale.LC_ALL, '' )
'English_United States.1252'
>>> locale.currency( 188518982.18 )
'$188518982.18'
>>> locale.currency( 188518982.18, grouping=True )
'$188,518,982.18' 
```

# mysql - 仅包含唯一字符串的专用 SQL 表

> ID：10703579
> 
> 赞同：2
> 
> 时间：2012-05-22T13:58:57.527
> 
> 标签：mysql, sql, sql-server, database, database-design

我似乎在网上找不到任何人这样做的例子，所以我想知道这是否有原因（或者我可能没有使用正确的搜索词）。甚至可能已经有一个我不知道的术语？

为了为定期重复出现的字符串节省数据库存储空间，我正在考虑创建一个名为**unique_string**的 MySQL 表。它只有两列：

1.  **“id** ”：INT：PRIMARY_KEY 索引
2.  **“字符串”**：varchar(255)：唯一索引

然后，数据库中任何位置的任何其他表都可以使用 INT 列而不是 VARCHAR 列。例如，名为**browser**的 varchar 字段将改为名为**browser_unique_string_id**的 INT 字段。

我不会将它用于性能重要的任何事情。在这种情况下，我使用它来跟踪每个页面请求的详细信息（记录 Web 统计信息）和对 Intranet 上的用户操作的“审计试验”，但其他事情也可能如此。

我也知道 SELECT 查询会很复杂，所以我并不担心。我很可能会编写一些代码来生成查询以返回“真实”字符串数据。

想法？我觉得我可能在这里忽略了一些明显的东西。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:46:17.350

我已经将此结构用于类似的应用程序——跟踪 Web 日志的 URI。在这种情况下，数据库是 Oracle。

性能问题不是最小的。随着数据库的增长，有数千万个 URI。因此，仅在 INSERT 期间识别正确的字符串是具有挑战性的。我们通过在 hadoop 中构建大部分更新逻辑来处理这个问题，因此数据库表本质上只是 hadoop 表的副本。

正如您在问题中所建议的那样，在常规数据库中，您可以通过构建索引来解决此问题。而且，索引解决方案可以很好地满足您的可用内存。实际上，这对于索引来说是一种相当退化的情况，因为您实际上只需要索引而不需要基础表。我不知道 mysql 或 SQL Server 是否可以识别这一点，尽管列式数据库（例如 Vertica）应该。

SQL Server 有另一种选择。如果您将字符串声明为 VARCHAR(max)，则它不会与其余数据存储单独的数据页。在全表扫描期间，如果查询中未引用该列，则无需在内存中加载附加页。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T14:09:59.490

这是数据库中非常常见的设计模式，其中数据的基数与其链接的事务表相比相对较小。查询不会很复杂，只是对查找表的简单连接。您可以在查找表中不仅包含一个字符串，还可以包含通常重复的其他信息。您只是对模型进行[规范化](http://en.wikipedia.org/wiki/Database_normalization)以删除重复数据。

例子：

**请求**表：

```
Date    
Time   
IP Address    
Browser_ID 
```

**浏览器**表：

```
Browser_ID
Browser_Name
Browser_Version
Browser_Properties 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T14:23:18.233

如果您计划实时记录数据（而不是批处理作业），那么您希望确保将记录写入数据库的时间尽可能快。如果您正在同步记录，那么显然记录创建时间将直接影响 http 请求完成所需的时间。如果这是异步的，那么缓慢的记录创建时间将导致瓶颈。但是，如果这是批处理作业，那么只要您可以在下一个批处理运行之前自信地创建所有批处理记录，那么性能就无关紧要了。

为了减少创建您真正想要展平数据库结构的记录所需的时间，您当前的伪查询可能看起来像

```
SELECT @id = id from PagesTable
WHERE PageName = @RequestedPageName

IF @id = 0
THEN 
  INSERT @RequestedPageName into PagesTable
  @id = SELECT @@IDENTITY 'or whatever method you db supports for              
                          'fetching the id for a newly created record
END IF

INSERT @id, @BrowserName INTO BrowersLogTable 
```

在平面结构中，您只需要 1 INSERT

如果您担心数据完整性，那么您通常会通过定期查询将这些数据写入一组单独的表（或单独的数据库）并将其用于查询来规范化这些数据。

# php - 需要在 joomla 站点中使用 HTML 的标签 MAP

> ID：10703584
> 
> 赞同：0
> 
> 时间：2012-05-22T13:59:07.780
> 
> 标签：php

我需要使用 Map HTML 标签使我的图像作为超链接工作，链接到不同的社交网站，但 map 标签在 Joomla! 中不起作用，但它在 HTML 网站中起作用。

这是我正在使用的代码

```
<img src="images/social_media_icons.jpg" border="0" alt="social media icons" width="365" height="44" /> <map id="Map" name="Map"> 
<area shape="rect" coords="18,6,56,39" href="twitter_Link" target="_blank" />

<area shape="rect" coords="77,6,112,39" href="facebook_Link" target="_blank" />

<area shape="rect" coords="191,6,229,38" href="youtube_link" target="_blank" />

 </map> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T13:40:36.653

我更改了编辑器，这对我有用:) 为 joomla 使用了 JCE 编辑器

# actionscript-3 - 使用 Flash 媒体服务器 4.5 录制视频

> ID：10703590
> 
> 赞同：0
> 
> 时间：2012-05-22T13:59:31.743
> 
> 标签：actionscript-3, video, record, flash-media-server

您好，我正在尝试使用 fms 4.5 将我的相机捕获为 flv 文件，我正在执行以下操作：

```
 protected function rec_clickHandler(event:MouseEvent):void
        {
            nc = new NetConnection();
            nc.client = { onBWDone: function():void{ trace("onBWDone") } };
            nc.connect("rtmp://localhost/vod");
            nc.addEventListener(NetStatusEvent.NET_STATUS,netStatusHandler);

        }

        private function netStatusHandler(e:NetStatusEvent):void  {    
            var code:String = e.info.code;              

            if(code == "NetConnection.Connect.Success"){                //in case of recording...

                ns = new NetStream(nc); 
                ns.attachCamera(cam);
                ns.attachAudio(mic);
                ns.publish("filename","record");

            }    
            else{    
                trace(code);   
            }  
        } 
```

但我收到以下错误：

```
Error #2044: Unhandled NetStatusEvent:. level=error, code=NetStream.Record.NoAccess 
```

任何人都可以帮忙吗？我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T08:28:35.390

此状态消息 ， `NetStream.Record.NoAccess`通常表示您没有流的写入权限。检查您的流目录的权限以查看它是否是只读的。

如果这不是问题，请检查您尝试发布到哪个应用程序，SSAS 是否有代码拒绝对流的写访问

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-11T16:05:35.570

确保之前录制的视频没有在任何视频播放器中打开。如果它正在被其他程序访问，它将不允许您记录或重写它。

# iphone - 使用故事板以编程方式更改应用程序语言

> ID：10703591
> 
> 赞同：0
> 
> 时间：2012-05-22T13:59:35.767
> 
> 标签：iphone, ios, localization, storyboard

我需要创建一个 iPhone 应用程序，该应用程序将是一个相当简单的应用程序，其中包含几个将一些数据发送到 Web 应用程序的表单。当用户第一次打开应用程序时，他应该看到一个语言选择屏幕。

我已经使用故事板构建了应用程序，一切正常，语言选择视图第一次弹出，所选语言保存在标准用户默认值等中。

现在实现第二语言（法语）的最佳方式是什么，因为这是我第一次处理本地化应用程序。经过一番搜索，我想出了如何将新语言/本地化添加到情节提要中，并且在手机设置中选择了正确的语言后，一切都按预期工作。现在我需要做的是在用户点击应用设置中的国家标志时调用正确的故事板。

当用户点击一个标志时，他的选择被写入standardUserDefaults。之后，我试图更改为正确的故事板。

我发现一些看起来可能有用的代码是：

```
UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil];
UIViewController *rootVC = [storyboard instantiateInitialViewController]; 
```

该代码不起作用，因为我不知道如何调用法语情节提要。

有更简单的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T14:05:55.420

为什么不使用本地语言支持。只需设置您的 labelFields，例如

```
labelField.text = NSLocalizedString(@"key", nil); 
```

您将拥有一个 Localized.strings 文件

```
"key" = "translated key"; 
```

该应用程序将自动选择设备配置的语言。

# jquery - 为什么显示[object HTMLImageElement]？不是吗？

> ID：10703593
> 
> 赞同：0
> 
> 时间：2012-05-22T13:59:44.757
> 
> 标签：jquery, xml, parsing, rss

我尝试解析来自 tumblr 博客的 RSS 提要。这是来自 rss 提要的 xml 片段。

```
<item>
    <title>title goes here</title>
    <description>
        <img src="http://media.tumblr.com/ajfafh.jpg"/>
        <p>text description goes here</p>
    </description>
    .
    .
</item> 
```

我尝试使用此代码在描述标签中获取 img 标签

```
function parse(xml){
    xml.find('item').each(function(index){
        var $item = $(this);
        var df = $item.find('description')[0].textContent;
        var $asdf = $(df).find('img').first()[0];

        var item = {
            index: index,
            description: $item.find('description')[0].textContent,
            img: $asdf
        }

        console.log(item.img);// return exactly the img tag just like what i want <img>
        // i also try this one
        console.log($(item.description).find('img').first());// return [<img src />]

        this.container.append(Mustache.to_html(this.template, item));
        //this.container = $('#container')
        //this.template = $('#template')
    });
} 
```

我使用 mustache.js 将其加载到 html。HTML

```
<ul id="container">
    <script id="template" type="text/template">
    <li>{{img}}</li>
    </script>
</ul> 
```

但是当我在浏览器上运行它时，它返回 [object HTMLImageElement]，而 console.log() 返回正确的值。为什么会这样？我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T14:07:25.957

好吧，您正在`log`输入 item.img，但您正在尝试追加`item`. 我想你想追加`item.img`。

# r - check.Renviron 被忽略 (OSX + R 2.15)

> ID：10703595
> 
> 赞同：2
> 
> 时间：2012-05-22T13:59:52.853
> 
> 标签：r, build, package

学期已经结束，我现在将一些软件包升级到 R 2.15（我不想在学生使用它们时更改它们）。所以我正在做我通常在 R 2.14 下工作的事情。据我所见，文档在这方面都没有改变，但我可能错过了。

我已经编辑了我的包`ChemoSpec`，但是当我去检查它时，R 给出了一个关于 的错误`packages required but not available`，然后列出它们。这些包是可用的，它们位于指向 a- 的本地目录中：

```
.libPaths()
[1] "/Users/bryanhanson/R_pkgs"                                      
[2] "/Library/Frameworks/R.framework/Versions/2.15/Resources/library" 
```

据称丢失的包裹实际上位于`/Users/bryanhanson/R_pkgs`.

我知道我`.Rprofile`被检查过程跳过了，所以`.libPaths`没有被设置`.Rprofile` 相反，我有一个`check.Renviron`文件位于`/Users/bryanhanson/.R`并包含以下行：

```
# Bryan's check.Renviron for customizing check environment
# resides in /Users/bryanhanson/.R
R_LIBS = /Users/bryanhanson/R_pkgs 
```

我试图在终端中检查以下命令

```
R --as-cran CMD check ChemoSpec
R --vanilla CMD check ChemoSpec 
```

对这些中的每一个的响应都略有不同，但是由于没有找到依赖关系，两者都失败了，因为显然，`/Users/bryanhanson/R_pkgs`即使我认为我已经告诉它这样做，R 也没有查看。

有什么建议么？它一定很简单。

这是 sessionInfo()：

```
sessionInfo()
R version 2.15.0 (2012-03-30)
Platform: x86_64-apple-darwin9.8.0/x86_64 (64-bit)

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] sos_1.3-1  brew_1.0-6 
```

# beanstalkd - beanstalkd 上的循环队列

> ID：10703596
> 
> 赞同：1
> 
> 时间：2012-05-22T14:00:00.803
> 
> 标签：beanstalkd

我正在为 beanstalkd 应用程序使用 beanstalkc 一个 python 包装器。

我想做的是让生产者放置一些工作（例如：'a'，'b'，'c'，'d'）一次，并且消费者可以不断地获得工作（例如：'a' ,'b','c','d','a','b',...)。

在消费者中，我使用 job.reserve() 获得工作。我认为解决方案只是保留作业而不删除它们，但是在我运行了一些消费者进程之后，我得到了一个超时错误。

我显然做错了什么，但我找不到一种方法来“重新排队”消费者使用的工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T18:33:40.860

我认为这可能是一个解决方案：

生产商：

```
queue.put('a', priority=0) 
```

消费者：

```
job = queue.reserve()
do something with job
new_priority = job.stats()['pri'] + 1
job.release(priority=new_priority) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T21:47:07.050

为什么不只是，当你完成一项特定的工作，并在你释放它之后，将你刚刚完成的同一工作的另一个副本放回队列中呢？

否则你会试图让它做一些它不打算做的事情。

# node.js - 使用 3 个服务器扩展 node.js socket.io

> ID：10703597
> 
> 赞同：2
> 
> 时间：2012-05-22T14:00:01.007
> 
> 标签：node.js, redis, socket.io

我知道他们在网上有很多关于这个问题的问题和答案，但我无法让它发挥作用。

我有一个服务器写入`node.js`并监听连接`socket.io`

现在，套接字可以在它们之间交换消息，就像聊天一样，我正在将传入的消息广播到服务器上的所有其他套接字。

我想`node`在 3 台不同的服务器上运行我的服务器，每台服务器都有不同的 IP，让我们称它们为`SERVER1`：`SERVER2`和`SERVER3`. 这是我的困惑，如果我从连接到的套接字发送消息，那么连接到的`SERVER1`套接字将如何看到此消息？`SERVER2``SERVER3`

我听说过`RedisStore`,`RabbitMQ`和其他东西，但我找不到可以解释我如何正确做的好文章/帖子/书...

有人能帮助我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T14:13:59.800

我相信 RedisStore 会自动为您执行此操作，这里有一篇关于它的好帖子：[http ://www.ranu.com.ar/2011/11/redisstore-and-rooms-with-socketio.html](http://www.ranu.com.ar/2011/11/redisstore-and-rooms-with-socketio.html)

这是如何在内部完成的？

正如您所听说的，Redis、RabbitMQ、ZeroMQ 等具有发布-订阅功能，这意味着您可以订阅频道并在频道上发布信息（向所有连接的对等方）：

[https://github.com/mranney/node_redis#publish--subscribe](https://github.com/mranney/node_redis#publish--subscribe)

所以服务器 A、B 和 C 订阅了同一个频道。例如，当连接到服务器 A 的客户端想要为连接到聊天室“js”的所有用户发送消息时，他向服务器 A 发送消息，服务器 A 在“js”频道上发布消息。所有其余的服务器都会收到该消息并将其广播给所有客户端。

# sql - 如果使用 STUFF 和 For Xml Path，多列是否会以相同的顺序连接

> ID：10703599
> 
> 赞同：0
> 
> 时间：2012-05-22T14:00:09.873
> 
> 标签：sql, sql-server

请参阅[http://www.sqlfiddle.com/#!3/fb107/3](http://www.sqlfiddle.com/#!3/fb107/3)以获取我要运行的示例架构和查询。我想使用 STUFF 和 FOR XML PATH('') 解决方案来连接由另一列分组的列。

如果我使用此方法将多个列连接到一个 csv 列表中，我是否保证每个连接字符串中的顺序相同？所以如果表是：

```
ID  Col1 Col2 Col3
1   1    1    1   
1   2    2    2
1   3    3    3
2   4    4    4
2   5    5    5
2   5    5    5 
```

我确定如果 Col1 连接起来，结果是：

```
ID Col1Concatenated
1  1,2,3
2  4,5,6 
```

例如，与 ("2,3,1", "5,6,4") 相对的 Co​​l2Concatenated 也将采用相同的顺序 ("1,2,3", "4,5,6")？

如果每行值的索引在每个连接值中都相同，则此解决方案仅适用于我。即第一行是每个 csv 列表中的第一行，第二行是每个 csv 列表中的第二行等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:12:02.843

您可以在函数内的查询中添加`ORDER BY`子句`STUFF`

# r - 如何在 R 中将字符串转换为日期和日期

> ID：10703600
> 
> 赞同：1
> 
> 时间：2012-05-22T14:00:11.100
> 
> 标签：r, date, filter

我有一个包含 10 列的数据集，其中之一是以下格式的日期

```
10-MAR-12 00.00.00.000000000 
```

我想将其转换为数据格式，该格式被读取为日期而不是以下格式的字符串

```
10/03/12 
```

我还希望有一个额外的专栏，说明它是星期几

然后我想过滤掉某些日期或日期并创建我的数据子集。

我是 R 的初学者，所以任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T14:10:57.593

查看`?strptime`格式化选项和`as.Date`/或`as.POSIXct`要转换的功能。此外，如果您的问题被否决或关闭，请不要感到惊讶，因为这是一个常见问题，可以在 SO 或快速谷歌搜索中找到答案。

具体来说：

```
format(as.Date(tolower('10-MAR-12 00.00.00.000000000'), format='%d-%b-%y'), format='%d/%m/%y') 
```

应该给你你正在寻找的格式。如果你想要一个日期类型，你应该去掉外部的`format`.

# python - 如何说服 setuptools 为 setup_require 或 tests_require 中的 requires 包使用临时目录？

> ID：10703601
> 
> 赞同：5
> 
> 时间：2012-05-22T14:00:13.690
> 
> 标签：python, setuptools, distutils, setup.py

在里面`setup.py`我有这样的东西：

```
setup_requires=['nose>=1.0'],
tests_require=[], 
```

问题是，当我运行`./setup.py test`它时，它会下载并解压目录中的这些模块`setup.py`。

我怎样才能说服它为此使用一个临时目录，我不想用这些污染源代码控制系统，我不想开始添加很多很多排除模式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:16:50.797

如果问题出在项目的源代码树上，您可能应该编写一个脚本来删除 distutils 在设置测试结束时创建的所有“dist”和“build”目录。下载的包通常是源代码树中的 *.egg 文件夹。

你没有污染你的分布。

从 setuptools 文档：

> **setup_requires**不会自动安装在运行安装脚本的系统上。如果它们在本地不可用，则只需将它们下载到安装目录。如果您希望它们被安装，并且在运行安装脚本时可用，您应该将它们添加到 install_requires 和 setup_requires。）

和

> **tests_require**如果你的项目的测试除了安装它需要的那些之外还需要一个或多个额外的包，你可以使用这个选项来指定它们。它应该是一个字符串或字符串列表，指定需要存在哪些其他发行版才能运行包的测试。当您运行测试命令时，setuptools 将尝试获取这些（甚至使用 EasyInstall 下载它们）。请注意，这些必需的项目不会安装在运行测试的系统上，如果它们尚未在本地安装，则只会下载到项目的安装目录。

[http://packages.python.org/distribute/setuptools.html](http://packages.python.org/distribute/setuptools.html)

如果你已经安装了一些包并且你需要删除它，只需在你的 python 发行版的子文件夹“site-packages”中找到你的包并删除它。最后删除 easy-install.pth 文件中的包引用，该文件通常位于相同的“site-packages”目录中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-30T19:22:36.927

从 setuptools 7.0 开始，为 、 和类似文件加载的临时依赖`setup_requires`项`tests_require`安装到 ./.eggs 中。我强烈建议将其添加到您的全局忽略列表中。

# python - 在 Python 中访问类变量的性能

> ID：10703605
> 
> 赞同：4
> 
> 时间：2012-05-22T14:00:20.053
> 
> 标签：python, global-variables, scope

**我想知道在使用以下方法访问同一类的方法中的**类变量（字典）时，性能是否有任何差异：

```
self.class_variable_dict.add(some_key, some_value) 
```

和

```
ClassName.class_variable_dict.add(some_key, some_value) 
```

显然，只要没有同名的实例变量，两者都可以工作，但是有什么理由/用例我们应该更喜欢一个而不是另一个？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-22T14:08:29.697

通过`ClassName`而不是通过访问它`self`会*稍微*快一些，因为如果您通过它访问`self`它必须首先检查实例命名空间。但我不认为差异会很显着，除非你有分析信息表明它是显着的。

因此，我建议使用您认为作为人类更容易阅读/理解的任何一种。

`class_variable_dict`从语义上讲，只有当变量在某处被遮蔽时，它们才会有所不同——特别是，如果 (a)`self`定义了一个同名的变量；或 (b)`self`是 的子类的实例`ClassName`，并且该子类（或其仍然是 的子类的基类之一`ClassName`）定义了同名的变量。如果这些都不正确，那么它们在语义上应该是相同的。

**编辑：**

*delnam*有一个很好的观点：有些因素可能会使两者都更快。我坚持我的断言，除非它处于非常紧密的循环中，否则差异将是微不足道的。为了测试它，我创建了我能想到的最紧凑的循环，并用`timeit`. 结果如下：

*   **通过类 var 访问：** 20.226 秒
*   **通过 inst var 访问：** 23.121 秒

基于多次运行，误差条看起来大约为 1 秒——即，这是一个统计上的显着差异，但可能不值得担心。这是我的测试代码：

```
import timeit

setup='''
class A:
    var = {}
    def f1(self):
        x = A.var
    def f2(self):
        x = self.var

a = A()
'''
print 'access via class var: %.3f' % timeit.timeit('a.f1()', setup=setup, number=100000000)
print 'access via inst var: %.3f' % timeit.timeit('a.f2()', setup=setup, number=100000000) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-22T14:11:05.757

让我们看看不同的选项都有什么作用。

```
In [1]: class Foo:
   ...:     bar = {}
   ...:     

In [2]: import dis
In [3]: dis.dis(lambda: Foo.bar.add(1,2))
  1           0 LOAD_GLOBAL              0 (Foo) 
              3 LOAD_ATTR                1 (bar) 
              6 LOAD_ATTR                2 (add) 
              9 LOAD_CONST               1 (1) 
             12 LOAD_CONST               2 (2) 
             15 CALL_FUNCTION            2 
             18 RETURN_VALUE         

In [4]: dis.dis(lambda: Foo().bar.add(1,2))
  1           0 LOAD_GLOBAL              0 (Foo) 
              3 CALL_FUNCTION            0 
              6 LOAD_ATTR                1 (bar) 
              9 LOAD_ATTR                2 (add) 
             12 LOAD_CONST               1 (1) 
             15 LOAD_CONST               2 (2) 
             18 CALL_FUNCTION            2 
             21 RETURN_VALUE 
```

从中可以看出，除了在第二种情况下创建对象之外，两种样式都会生成相同的字节码。

* * *

另一个方面是它并不重要。使用以最精确的方式表达您的目标的任何内容。只有在速度很重要时才进行优化。

我建议只是去`ClassName.dict_value[key] = value`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-10-12T10:35:33.747

[Python 中的实例变量与类变量](https://stackoverflow.com/questions/2714573/instance-variables-vs-class-variables-in-python/52777427#52777427)

另请参阅此处相同的问题，其中我发布了基于@Edward Loper 测试的更广泛的测试，包括模块变量以及比类变量更快的测试。

# javascript - JavaScript 的历史回钩

> ID：10703606
> 
> 赞同：5
> 
> 时间：2012-05-22T14:00:20.467
> 
> 标签：javascript, jquery, history.js

有没有办法提供诸如 onHistoryBack 之类的钩子？我目前正在使用 history.js

```
History.Adapter.bind (window, 'statechange', function () {}); 
```

但是我无法询问用户是否按下了 history.back() 或者它是否是 History.pushState() 调用的结果..有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T14:20:36.413

我这样做的方法是在实际站点上的每次点击时将一个变量设置为 true。然后 statechange 事件会检查这个变量。如果这是真的，他们使用了网站上的链接。如果它是假的，他们点击了浏览器的后退按钮。

例如：

```
var clicked = false;

$(document).on('click','a',function(){

    clicked = true;

    // Do something

});

History.Adapter.bind (window, 'statechange', function () {

    if( clicked ){
        // Normal link
    }else{
        // Back button
    }

    clicked = false;

}); 
```

希望有帮助:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T14:31:59.143

所有状态都存储在`History.savedStates`. 每次返回时都会添加另一个状态。所以理论上你可以测试`History.savedStates`看看是否`History.savedStates[History.savedStates.length - 2] == currentState`。这将表明用户从步骤 a 到步骤 b，然后返回到步骤 a。但是，用户可以通过返回按钮以外的其他方式到达那里 - 因此您可能需要将其与用户事件结合使用。

您还可以使用该`History.getStateByIndex`方法返回已保存的状态。

# sql - 与 CLOB 一起使用的类似 UTL_MATCH 的函数

> ID：10703609
> 
> 赞同：3
> 
> 时间：2012-05-22T14:00:28.403
> 
> 标签：sql, oracle, pattern-matching, string-matching, clob

**我的问题是：**是否有[`UTL_MATCH`](http://docs.oracle.com/cd/E14072_01/appdev.112/e10577/u_match.htm#CHDGDIDJ)与 a`CLOB`而不是 a一起使用的 -like 函数`VARCHAR2`？

**我的具体问题是：**我在 Oracle 数据库上。我有一堆与 Domo [CenterView](http://www.domo.com/solutions/centerview)交互的预先编写的查询。查询中包含由 定义的变量`${variableName}`。我需要重写这些查询。我没有写原件，所以我不想弄清楚变量的好值应该是什么，而是想用应用程序运行查询并获取查询的来源[`V$SQL`](http://docs.oracle.com/cd/B19306_01/server.102/b14237/dynviews_2113.htm)。

**所以我的解决方案是：**在`UTL_MATCH`查询中使用变量 stuff 和`V$SQL.SQL_FULLTEXT`. 但是，`UTL_MATCH`仅限于`VARCHAR2`且数据类型`V$SQL.SQL_FULLTEXT`为`CLOB`. 所以，这就是为什么我正在寻找一个`UTL_MATCH`适用于数据类型的类似函数的原因`CLOB`。

*欢迎任何其他有关如何完成此操作的提示。谢谢！*

**编辑，关于提示。**如果您对如何执行此操作有更好的了解，让我告诉您一些我掌握的信息。我有大约 100 个查询，它们都在一个 excel 电子表格中（其中包含 的`${variableName}`那些）。所以我可以很容易地使用 excel 为我编写查询。我希望将所有这些查询合并在一起并将输出复制到另一张表。无论如何，如果您认为有更好的方法来做到这一点，这可能会有所帮助。

**一个例子：**假设我有来自 Domo 的以下查询：

```
select department.dept_name
from department
where department.id = '${selectedDepartmentId}'
; 
```

我想这样称呼：

```
select v.sql_fulltext
from v$sql v
where utl_match.jaro_winkler_similarity(v.sql_fulltext,
'select department.dept_name
from department
where department.id = ''${selectedDepartmentId}''') > 90
; 
```

并得到这样的回报：

```
SQL_FULLTEXT
------------------------------------------
select department.dept_name
from department
where department.id = '154' 
```

**我试过的：**

我尝试对 clob 进行子串化并将其转换为 varchar。我真的希望这会奏效，但它给了我一个错误。这是代码：

```
select v.sql_fulltext
from v$sql v
where  utl_match.jaro_winkler_similarity( cast( substr (v.sql_fulltext, 0, 4000) as varchar2 (4000)),
'select department.dept_name
from department
where department.id = ''${selectedDepartmentId}''') > 90
; 
```

这是错误：

`ORA-22835: Buffer too small for CLOB to CHAR or BLOB to RAW conversion (actual: 8000, maximum: 4000)`

但是，如果我运行它，它工作正常：

```
select cast(substr(v.sql_fulltext, 0, 4000) as varchar2 (4000))
from v$sql v
; 
```

所以我不确定转换子字符串有什么问题......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T16:19:27.153

如果您要搜索的文本长度 <= 32767，那么您可以将 转换`CLOB`为`VARCHAR2`using `DBMS_LOB.SUBSTR`：

```
select v.sql_fulltext 
from v$sql v 
where utl_match.jaro_winkler_similarity(dbms_lob.substr(v.sql_fulltext), 'select department.dept_name from department where department.id = ''${selectedDepartmentId}''') > 90 ; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T14:14:54.173

UTL_MATCH 是一个用于比较字符串的包装，用于检查两个字符串的相似程度。它的函数评估字符串并返回分数。因此，您将得到的只是一个数字，指示（例如）您需要进行多少次编辑才能`${variableName}`变成“Farmville”或“StackOveflow”。

您不会得到实际差异：这两个文本字符串是相同的，除了偏移量 123 处它替换`${variableName}`为“Farmville”。

这么说意味着另一种方法。使用[INSTR()](http://docs.oracle.com/cd/B19306_01/appdev.102/b14258/d_lob.htm#i998546)和[SUBSTR()](http://docs.oracle.com/cd/B19306_01/appdev.102/b14258/d_lob.htm#i999349)`${variableName}`在 Domo CenterView 查询中定位实例，并使用这些偏移量来识别`v$sql.fulltext`等效文本中的不同文本。您可以使用 PL/SQL 中的 CLOB 和[DBMS_LOB 包](http://docs.oracle.com/cd/B19306_01/appdev.102/b14258/d_lob.htm)来执行此操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-24T14:26:15.347

我最终为它创建了一个自定义函数。这是代码：

```
CREATE OR REPLACE function match_clob(clob_1 clob, clob_2 clob) return number as

similar number := 0;
sec_similar number := 0;
sections number := 0;
max_length number := 3949;
length_1 number;
length_2 number;
vchar_1 varchar2 (3950);
vchar_2 varchar2 (3950);

begin
  length_1 := length(clob_1);
  length_2 := length(clob_2);
  --dbms_output.put_line('length_1: '||length_1);
  --dbms_output.put_line('length_2: '||length_2);
  IF length_1 > max_length or length_2 > max_length THEN

    FOR x IN 1 .. ceil(length_1 / max_length) LOOP

      --dbms_output.put_line('((x-1)*max_length) + 1'||(x-1)||' * '||max_length||' = '||(((x-1)*max_length) + 1));

      vchar_1 := substr(clob_1, ((x-1)*max_length) + 1, max_length);
      vchar_2 := substr(clob_2, ((x-1)*max_length) + 1, max_length);

--      dbms_output.put_line('Section '||sections||' vchar_1: '||vchar_1||' ==> vchar_2: '||vchar_2);

      sec_similar := UTL_MATCH.JARO_WINKLER_SIMILARITY(vchar_1, vchar_2);

      --dbms_output.put_line('sec_similar: '||sec_similar);

      similar := similar + sec_similar;
      sections := sections + 1;

    END LOOP;

    --dbms_output.put_line('Similar: '||similar||' ==> Sections: '||sections);
    similar := similar / sections;

  ELSE
    similar := UTL_MATCH.JARO_WINKLER_SIMILARITY(clob_1,clob_2);
  END IF;
  --dbms_output.put_line('Overall Similar: '||similar);
   return(similar);
end;
/ 
```

# php - 将 SQL 表行拆分为 php 变量

> ID：10703612
> 
> 赞同：-1
> 
> 时间：2012-05-22T14:00:35.193
> 
> 标签：php, sql, variables, explode

我的表格中有一行这样显示；

```
2:2/3:1/17:1/6:1/1:1/ 
```

我想知道如何将它们存储到 php 变量中，以便将它们显示给用户。'/' 分隔元素，':' 分隔元素的各个部分。

我不知道这是否有意义，但就是这样；

```
itemID:quantity/itemID:quantity/itemID:quantity/ 
```

所以我想分离项目，然后将 itemID 和数量存储到变量中以显示给用户。

我尝试过使用爆炸功能；

```
$pieces = explode("/", $order_details); 
```

但我不知道如何分离 itemID 和数量。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:04:16.703

```
$pieces = explode("/", rtrim($order_details, '/'));
$items = array();
foreach ($pieces as $piece)
{
    list($id, $qty) = explode(':', $piece);
    $items[$id] = $qty;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T14:09:56.650

利用[parse_str](http://php.net/manual/en/function.parse-str.php)。

```
<?php
$str = '2:2/3:1/17:1/6:1/1:1/';
$str = str_replace(array(':', '/'), array('=', '&'), $str);

parse_str($str, $vars);

/*
$vars now:
Array
(
    [2] => 2
    [3] => 1
    [17] => 1
    [6] => 1
    [1] => 1
)
*/ 
```

如果可能，将值作为[序列化数组](http://php.net/manual/en/function.serialize.php)存储到您的表中。

# xcode - 包括 ~/.emacs.d/emacs-xcode 和 require 'xcode 给出“无法打开加载文件，xcode”

> ID：10703613
> 
> 赞同：1
> 
> 时间：2012-05-22T14:00:50.140
> 
> 标签：xcode, emacs

我想在 OS X（10.6.8 版）上使用 Emacs（23.4.1 版）来替换 Xcode（4.2 版）作为我的文本编辑器。

我已经`emacs-xcode.el`从[https://github.com/senny/emacs-xcode](https://github.com/senny/emacs-xcode)复制到我的本地目录`~/.emacs.d/emacs-xcode/emacs-xcode.el`

中`.emacs`，我有

```
(add-to-list 'load-path (expand-file-name "~/.emacs.d/emacs-xcode/"))
(require 'xcode) 
```

当我运行 Emacs 时，它会发出警告：

```
Warning (initialization): An error occurred while loading `/Users/thunderrabbit/.emacs':

File error: Cannot open load file, xcode 
```

在`.emacs`，我也试过

```
(add-to-list 'load-path (expand-file-name "~/.emacs.d/emacs-xcode/emacs-xcode.el"))
(require 'xcode) 
```

对于那些比 xcode 更熟悉 Emacs 的人，最后`~/.emacs.d/emacs-xcode/emacs-xcode.el`是该行

```
(provide 'xcode) 
```

我认为它与`(require 'xcode)`in配对`.emacs`

编辑：我`(require 'monkey)`在最后添加了`emacs-xcode.el`Emacs 并*没有*抱怨它无法加载猴子。所以看起来`emacs-xcode.el`根本没有被加载。

`emacs-xcode.el`归我所有，权限为 644。其父目录归我所有，权限为 755。

为什么打不开？

注意我剪切并粘贴了文件名，所以我确定它们拼写正确。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T16:37:14.947

你的问题是该语句的文件名与`provide`语句中的符号名不一样`require`，因此 Emacs 不知道要查看哪个文件。

您可以重命名库`xcode.el`，或者使用显式文件名要求它：

```
(require 'xcode "emacs-xcode") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T14:29:03.980

我在这里找到了一条线索[Emacs not recognize its own scripts in /emacs/lisp/](https://stackoverflow.com/questions/6344542/emacs-not-recognizing-its-own-scripts-in-emacs-lisp)

我已经通过添加`(load "emacs-xcode.el")`到我的`.emacs`

```
(add-to-list 'load-path (expand-file-name "~/.emacs.d/emacs-xcode/"))
(load "emacs-xcode.el")
(require 'xcode) 
```

我暂时不会选择我的答案，以防其他人有更好的解决方案。

# javascript - 在 3d 场景中使用 processing.js 进行对象选择

> ID：10703614
> 
> 赞同：1
> 
> 时间：2012-05-22T14:00:50.743
> 
> 标签：javascript, webgl, processing.js

我正在尝试通过 webgl 在 Processing.js 中对 3d 渲染进行对象选择，但没有找到任何允许我这样做的方法。

我知道在 OpenGL 中，您可以将渲染模式更改为 GL_SELECT，命名并渲染每个对象，完成后找到光标下对象的名称。

如果我可以从目标画布中获取 WebGL 上下文，则此方法对我来说很好，但由于某些奇怪的原因，getContext 方法返回 null。

有没有办法从 Processing.js 获取渲染上下文并应用我提到的方法，或者 Processing.js 本身有更好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T15:10:00.117

[可以从此处](http://processingjs.org/articles/RenderingModes.html)指定的实例访问渲染上下文：

来自 JavaScript：

```
var p = Processing.instances[0];
var context = p.externals.context;
var p2 = Processing.getInstanceById('canvas-id');
var p2Canvas = p2.externals.canvas; 
```

从处理内部：

```
var currentContext = externals.context; 
```

[然后在这个答案](https://stackoverflow.com/questions/4040616/opengl-gl-select-or-manual-collision-detection/4059685#4059685)中进行碰撞检测。

# python - 开始使用 pystache

> ID：10703616
> 
> 赞同：1
> 
> 时间：2012-05-22T14:00:55.520
> 
> 标签：python

这确实是一个新手问题，但我不知道如何搜索答案。我想使用 pystache，并且我能够执行 .py 文件以从 .mustache 文件中打印出一些渲染输出。但我究竟如何将其转换为 .html 文件？具体来说，如何将它放在服务器上，以便浏览器可以直接访问 index.html 之类的 .html 文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T14:09:29.417

Pystache 是一个模板库**而不是**http 服务器！如果您想制作 webapp，请尝试使用现成的 webframeworks，如 Django 或 Pyramid。

# android - 使用模拟器时android的文件路径

> ID：10703619
> 
> 赞同：3
> 
> 时间：2012-05-22T14:00:59.577
> 
> 标签：android, download

我是安卓新手。我正在尝试从服务器下载文件并将文件保存在特定路径中。该应用程序运行良好。但是我无法找到下载文件的路径。在我给出的代码中

文件输出 = new File("/data/data/com.test.firstApp/", fileName);

我在哪里可以找到我系统上的文件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T14:10:09.630

不要使用硬编码的文件路径。该框架将为您提供要保存文件的区域的基本路径。

对于 SD 卡，请使用`Environment.getExternalStorageDirectory()`

对于本地文件，使用`Context.getFilesDir()`（或`Context.openFileOutput(String name, int mode)`，等）

对于本地缓存，使用`Context.getCacheDir()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T14:26:43.613

添加到 Rich 的答案中，如果您最终会写入外部存储，请确保在清单中包含此权限：

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T14:08:29.753

检查此页面[http://developer.android.com/guide/topics/data/data-storage.html](http://developer.android.com/guide/topics/data/data-storage.html)

您可以找到许多方法来保存文件。更重要的是，您还可以阅读有关良好做法的内容。

干杯

# vba - VBA 将 Excel 电子表格链接到 Access

> ID：10703621
> 
> 赞同：0
> 
> 时间：2012-05-22T14:01:01.120
> 
> 标签：vba, excel

我在 Access 2010 中的 VBA 中创建一个代码来链接 excel 工作表并将它们放入访问表中。我不断地在程序之外得到一个无效的`strFile = Dir(StrPath &"*.xls")`它一直告诉`strPath is invalid outside procedure`

请帮忙。

```
Option Compare Database
Option Explicit

'code will link to excel and pull site survey files into access tables

'Setting the path for the directory

Const strPath As String = "C:\Users\cparson\Documents\Survey_Eqpm\SiteSurveyData.xlsx"

'FileName
Dim strFile As String
'Array
Dim strFileList() As String
'File Number
Dim intFile As Integer

'Looping through the folder and building the file list
strFile = Dir(strPath & "*.xls")
While strFile <> ""
    'adding files to the list
    intFile = intFile + 1
    ReDim Preserve strFileList(1 To intFile)
    strFileList(intFile) = strFile
    strFile = Dir()
Wend
'checking to see if files where found
If intFile = 0 Then
    MsgBox "No Files Found"
    Exit Sub
End If
'going through the files and linking them to access
For intFile = 1 To UBound(strFileList)
    DoCmd.TransferSpreadsheet acLink, , _
    strFileList(intFile), strPath & strFileList(intFile), True, "A5:J17"
Next
MsgBox UBound(strFileList) & "Files were linked"
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:34:24.380

你有一个`End Sub`但没有过程名称？

```
Option Compare Database
Option Explicit

Const strPath As String = "C:\Users\cparson\Documents\Survey_Eqpm\SiteSurveyData.xlsx"

Dim strFile As String
Dim strFileList() As String
Dim intFile As Integer

Sub Sample() '<~~ You are missing this...
    strFile = Dir(strPath & "*.xls")

    '~~> Rest of your code
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-01T13:17:06.550

我知道这是一个老问题，但我在谷歌搜索中遇到了它，并意识到你已经`.xlsx`在变量中拥有扩展名`strPath`，但是你也将它添加到字符串变量中`strFile`。

```
Const strPath As String = "C:\Users\cparson\Documents\Survey_Eqpm\SiteSurveyData.xlsx"

strFile = Dir(strPath & "*.xls") 
```

我可能是错的，但只是想指出这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T23:18:35.973

你也可以试试 ADO，在我看来这是一个简单的方法

```
YourConnObj.execute "SELECT * INTO  YourTableName from [Excel 14.0;DATABASE=c:\temp\data copy.xlsx].[Sheet1]" 
```

# iphone - 如何仅在 UITextView 上强制水平滚动

> ID：10703622
> 
> 赞同：1
> 
> 时间：2012-05-22T14:01:02.550
> 
> 标签：iphone, ios, xcode, uiscrollview, uitextview

我有一个`UITextView`with`contentSize`属性设置为一个非常大的值`1000`，宽度`UITextView`为 200，启用滚动，启用水平弹跳和禁用垂直弹跳，但这`UITextView`仍然在大文本上垂直滚动。我怎样才能强制水平滚动呢？

ps[这里的解决方案](https://stackoverflow.com/questions/2826980/how-to-enforce-horizontal-scrolling-on-uitextview)不起作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T14:17:32.250

UITextView 是 - UIScrollView 的子类。所以你可以使用 ScrollViewDelegate 方法来禁用它。

利用 -

```
- (void)scrollViewDidScroll:(id)aScrollView
{
    [aScrollView setContentOffset:CGPointMake([scrollView contentOffset].x, 0.0)];
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T10:52:04.637

我尝试了许多不同的方法来让水平滚动功能按预期工作，但这些方法都不适合我，所以我创建了一个 UIScrollView 并在滚动视图中添加了一个 UILabel 作为子视图，并设置了框架的宽度根据其文本和文本字体动态添加标签，之后我将滚动视图的 contentSize 设置为等于标签的新框架宽度和高度。使用此方法，您将获得水平滚动文本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-03-29T19:22:41.690

使用 JAHelia 的建议，这对我有用：

```
self.dishNameLabel.text = @"Here is some very longgggg text to test with";
float width = ceil([self.dishNameLabel.text sizeWithAttributes:@{NSFontAttributeName: [UIFont fontWithName:@"WorkSans-SemiBold" size:15.0]}].width);
self.dishNameLabel.frame = CGRectMake(self.dishNameLabel.frame.origin.x, self.dishNameLabel.frame.origin.y, width, self.dishNameLabel.frame.size.height);
self.dishNameScrollView.contentSize = CGSizeMake( width, self.dishNameScrollView.frame.size.height); 
```

当然，您必须用各自的规格替换文本和字体

# mysql - 无法连接MySql Server，无法重新配置MySql server

> ID：10703629
> 
> 赞同：0
> 
> 时间：2012-05-22T14:01:27.357
> 
> 标签：mysql

我在 Rails 应用程序中连接到数据库时遇到问题，因此根据[本教程](https://docs.google.com/document/edit?id=1I0vg_xntIykSsfnorCLaYtDXS0OVulz3UH4eCouoKtg)重新安装了所有内容，但没有帮助。

现在，当我运行 MySql Server 的安装时，它说：

> 错误 1045 “root@localhost”的访问被拒绝（使用密码 NO）

当我重新配置时，将旧密码字段留空。我该如何解决这个问题？这是我的日志：

> 无法连接到“localhost”上的 MySQL 服务器 (10061)
> 
> 无法为 {"adapter"=>"mysql2", "encoding"=>"utf8", "reconnect"=>false, "database"=>"testapp_development", "pool"=>5, "username" 创建数据库"=>"root", "password"=>"root", "host"=>"localhost"}, charset: , collat​​ion: Can't connect to MySQL server on 'localhost' (10061)
> 
> 无法为 {"adapter"=>"mysql2", "encoding"=>"utf8", "reconnect"=>false, "database"=>"testapp_test", "pool"=>5, "username" 创建数据库"=>"root", "password"=>nil, "host"=>"localhost"}, charset: , collat​​ion:

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T15:19:59.743

您提到安装 MySQL 时将密码留空？但是您的 Rails 似乎正在尝试使用密码“root”连接。它是哪一个？如果你的 MySQL 有密码，你需要使用它来连接，如果没有，你不能发送密码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-11-12T18:16:41.867

嗨，我也有同样的情况，但可以通过服务找到它，您只需再次重新启动 MySQL 选项

# php - 使用 PHP 将多个值从 HTML 表单选择框传递到 SQL 语句

> ID：10703635
> 
> 赞同：1
> 
> 时间：2012-05-22T14:01:43.457
> 
> 标签：php, html, sql, select, mysqli

我有一个带有选择框的表单，用户可以在其中从数据库中选择预先存在的字段：

```
<form action='' method='POST' autocomplete='off' enctype="multipart/form-data">
  <p><strong>Title and Description:</strong></p>
  <select name='uidtitle' class='chosen-select'>
  <option value="0" ></option>
    <?php 
      $result = $mysqli->query("SELECT uid, title, description FROM tblFacilityHrs") or die($mysqli->error);
      while ($row = $result->fetch_array(MYSQLI_ASSOC)){
        echo "<option value=\"1\">" . $row['title'] ." - " . $row['description'] . "</option>";
        $uid = $row['uid'];
        $title = $row['title'];
        $desc = $row['description'];
      }
    ?>
    </select>
... 
```

如何将所有这三个值（分别）发送到我的 SQL 回发？

```
if (isset($_POST['submitted'])) { 
  //Get params for prepared statements
  $startDatec= date("Y-m-d H:i:s", strtotime($_POST['startEventDate']));
  $endDatec= date("Y-m-d H:i:s", strtotime($_POST['endEventDate']));
  $startTimec=$_POST['startTime'];
  $endTimec=$_POST['endTime'];
  $recurc=$_POST['recurrence'];
  $finalc= date("Y-m-d H:i:s", strtotime($_POST['finalDate']));
  ... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:12:42.100

我不知道您为什么需要将所有三个值都发回。数据库键的存在是因为能够识别给定一个字段的记录中的所有字段，在这种情况下，我假设`uid`. 单独传递该字段将允许您在执行您想要的操作之前选择回发中的其他字段。

但是，可以使用隐藏的表单字段，尽管我不提倡这种方法。

```
<select name='uidtitle' class='chosen-select'>
  <option value="0" ></option>
    <?php 
      $result = $mysqli->query("SELECT uid, title, description FROM tblFacilityHrs") or die($mysqli->error);
      $cacheArray = array(); // Used to store the information to be used below
      while ($row = $result->fetch_array(MYSQLI_ASSOC)){
        echo "<option value=\"" . $row['uid'] . "\">" . $row['title'] ." - " . $row['description'] . "</option>";
          $cacheArray[] = $row;
      }
    ?>
    </select>

<?php

    foreach($cacheArray as $k => $v) {
        echo '<input type = "hidden" name = "title-' . $v['uid'] . '" value = "' . $v['title'] . '">';
        echo '<input type = "hidden" name = "description' . $v['uid'] . '" value = "' . $v['description'] . '">';
    }

?> 
```

隐藏的表单字段将出现在`tblFacilityHrs`表中的所有记录中。通过将 附加到名称来区分`uid`名称。您可以通过以下方式确定您对回发感兴趣的字段：

```
$_POST['title-'.$_POST['uidtitle']]
$_POST['description-'.$_POST['uidtitle']] 
```

# php - iOS - 发送价值的静默推送通知

> ID：10703640
> 
> 赞同：1
> 
> 时间：2012-05-22T14:01:56.843
> 
> 标签：php, objective-c, ios, xcode, push-notification

有没有办法将值从php页面发送到objective-c？我想用推送通知模拟事件编程：当在 Web 服务器中更改一个值时，它会通过推送通知以静默模式将该值发送到 iOS。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T14:38:15.293

也许这可以帮助你。

[http://maniacdev.com/2011/05/tutorial-ios-push-notification-services-for-beginners/](http://maniacdev.com/2011/05/tutorial-ios-push-notification-services-for-beginners/)

# c - 汉明码错误检测

> ID：10703643
> 
> 赞同：2
> 
> 时间：2012-05-22T14:02:10.153
> 
> 标签：c, algorithm, error-detection

我有下面给出的代码，用于使用汉明码进行错误检查。我浏览了 Wikipedia 上的算法，并且还了解了它的工作[原理，如汉明代码如何工作？](https://stackoverflow.com/questions/388599/how-does-the-hamming-code-work)

但是下面的代码使用某种奇偶校验位的总和来检测哪个位是错误的。

有人可以解释一下如何准确地使用总和来检测错误位吗？

代码：

```
#include<stdio.h>
#include<math.h>
void main()
{
    int i,a[4],c[3],r[7],clk[3],n,sum=0;
    printf("Enter data bits\n");

    for(i=3;i>=0;i--)
        scanf("%d",&a[i]);
    printf("\n");

    c[0]=(a[0]+a[1]+a[2])%2;
    c[1]=(a[1]+a[2]+a[3])%2;
    c[2]=(a[1]+a[0]+a[3])%2;

    printf("data bits after hamming code is\n");

    for(i=3;i>=0;i--)
        printf("%d",a[i]);
    for(i=2;i>=0;i--)
        printf("%d",c[i]);
    printf("Enter recieved code\n");
    for(i=0;i<7;i++)
        scanf("%d",&r[i]);

    clk[0]=(r[3]+r[1]+r[2]+r[6])%2;
    clk[1]=(r[0]+r[2]+r[1]+r[5])%2;
    clk[2]=(r[0]+r[2]+r[3]+r[4])%2;

    sum=4*clk[2]+2*clk[1]+1*clk[0];

    if(sum==0)
        printf("\n u have recived coorrect code\n");
    if(sum==1)
    {   printf("Error in check bit 2\n");
        printf("The correct code is");
        r[6]=(r[6]+1)%2;
        for(i=0;i<7;i++)
        printf("%d",r[i]);
    }
    if(sum==2)
    {
        printf("Error in check bit 1\n");
        printf("The correct code is");
        r[5]=(r[5]+1)%2;
        for(i=0;i<7;i++)
        printf("%d",r[i]);
    }
    if(sum==3)
    {
        printf("\nError in data bit 1");
        printf("The correct code is");
        r[1]=(r[1]+1)%2;
        for(i=0;i<7;i++)
        printf("%d",r[i]);
    }
    if(sum==4)
    {
        printf("\n Error in chect bit 0");
        printf("The correct code is");
        r[4]=(r[4]+1)%2;
        for(i=0;i<7;i++)
        printf("%d",r[i]);
    }
    if(sum==5)
    {
        printf("\n Error in data bits 3");
        printf("The correct code is");
        r[3]=(r[3]+1)%2;
        for(i=0;i<7;i++)
        printf("%d",r[i]);
    }
    if(sum==6)
    {
        printf("Error in data bits 0");
        printf("The correct code");
        r[0]=(r[0]+1)%2;
        for(i=0;i<7;i++);
        printf("%d",r[i]);
    }
    if(sum==7)
    {
        printf("Error in data bits 2");
        printf("The correct code is");
        r[2]=(r[2]+1)%2;
        for(i=0;i<7;i++)
        printf("%d",r[i]);
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T18:53:06.313

这是考虑特别是汉明码和一般线性码的另一种方法。对汉明码进行编码的一种方法是传递原始数据，然后对其附加校验和。该校验和是原始数据的线性函数（使用 mod 2 算术计算）。

当您收到数据时，您可以从中计算校验和，并将其以 mod 2 形式添加到收到的校验和中。如果结果为零，则两个校验和相同，您不妨接受数据。

如果结果不为零，则您对传输的数据和破坏它的错误模式有一些线性函数。当您添加两个校验和时，您将原始数据的线性函数和（带有添加到其中的错误模式的原始数据 mod 2）的线性函数添加在一起。由于这是 mod 2 添加，当您添加两个校验和时，来自原始数据的两个贡献相互抵消，您最终得到的结果仅取决于错误模式，而不取决于编码的数据。这个结果被称为综合症（或至少等同于综合症）。

因此，找出错误模式的一种方法是计算每个可能的错误模式（或至少是您关心的错误模式）的伴随式，并将它们的伴随式存储在一个表中。对于汉明码，您通常会考虑所有单位错误模式。这是综合症解码。

因此，当您收到数据时，您会计算综合症（预期和收到的校验和的总和）。如果它是零，一切都很好。如果不是，则在校正子表中查找它，如果存在，则将生成的错误模式添加到接收到的数据中以纠正错误。如果它不存在，则您检测到的不是单位错误，可能是双位错误。

详细介绍这一点的一个原因是表明您可以使用相同的想法（假设您可以创建足够大的表）来纠正更复杂的错误模式，或者纠正不同的错误选择，如果您知道一些单比特错误不太可能（所以不要把它们放在表中），但可能会出现一些双位错误（如果有空间的话，把它们放在表中）。

对于更强大的错误代码，可纠正错误的数量变得难以管理，您必须使用更聪明的想法来利用代码的结构。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T14:25:41.790

这些位以这样一种方式相加，即每个可能的单位错误都会在`sum`. 例如，所有奇数位相加为位零，因此如果错误位于奇数位，则签名将为奇数。（好吧，示例程序中的编号方案混淆了位，但这是我实现它的方式以及 Wikipedia 文章显示的方式。）

汉明码不止一个，因此请务必阅读有关[汉明码 (7,4)](http://en.wikipedia.org/wiki/Hamming_%287,4%29_code)的维基百科文章。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-23T20:21:36.220

通过在代码中添加错误来了解它

1.  假设我们更改`r[3]`接收到的汉明码中的位，因此更改会`r[3]`导致 2 个单独的综合征位发生变化，`clk[0]`然后`clk[2]`生成的相应总和是`5 (1*1+0*2+1*4)`。
2.  同样明智的是，您可以在任何其他位位置放置另一个错误，因此您将获得另一个 sum ，因此您可以区分 sum 位和错误位。
3.  如果您想在这封电子邮件中询问更多信息，我 Sambhav goel 是我的名字，goelsambhav9@gmail.com 是我的 ID。

# jquery - jquery AnythingSlider 控件

> ID：10703644
> 
> 赞同：0
> 
> 时间：2012-05-22T14:02:10.617
> 
> 标签：jquery, anythingslider

我需要有一个外部链接作为下一张和上一张幻灯片的导航。

我认为“appendForwardTo”会起作用，但我怀疑我做错了什么......

```
$('.quiz-items a').click().goForward() 
```

但只要得到

```
Uncaught TypeError: Object [object Object] has no method 'goForward' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:04:53.437

我的猜测是你需要做类似的事情

```
$('.quiz-items a').click(function(){
    $('#slider1').data('AnythingSlider').goForward(); 
}); 
```

# c++ - Eclipse中使用qt插件的qt gui项目

> ID：10703651
> 
> 赞同：1
> 
> 时间：2012-05-22T14:02:43.163
> 
> 标签：c++, eclipse, qt, user-interface, windows-7

所以我创建了一个新的 qt gui 项目，给它起了一个名字，在它创建之后我收到了这个错误：

`"No default QT version is set.Open the QT page in the preferences dialogue and add a QT version."`

我打开首选项对话框，单击添加，但是当我必须提供 bin 和包含文件的路径时，我找不到安装 QT SDK 的任何位置。

我安装了 qt sdk 1.2.1 和 qt eclipse integration 1.6.1。

这些路径安装在 qt sdk 中的哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:27:53.823

系统会要求您添加 Qt 版本。为此，请转到 eclipse 首选项，切换到 Qt 页面并单击“添加...”。

然后您将被询问二进制路径（用于构建过程的 Qt 二进制文件，例如 qmake、moc、...）和包含路径（存储 Qt 头文件的位置）。

浏览您的 Qt 安装路径并分别选择子目录**bin**和**include**。

如果您*不知道*Qt 的安装位置，请尝试从 Windows 开始菜单启动 Qt 命令行（不是 Windows 默认命令行）并键入：

`qmake -v`

输出应与此类似：

```
QMake version ...
Using Qt version ... in C:\Qt\...\lib 
```

你的**bin**路径应该在`C:\Qt\...\bin`; 的**包含**路径`C:\Qt\...\include`。

然后接受助手对话框并通过单击“默认”按钮选择此版本作为默认版本。然后重试构建您的项目。

# c - 编译 v4l2 程序时出现 ioport.h 错误

> ID：10703662
> 
> 赞同：0
> 
> 时间：2012-05-22T14:03:26.270
> 
> 标签：c, header, v4l2, v4l, ioports

我想关注[这篇](http://lwn.net/Articles/204545/)关于 v4l2 驱动程序编写的文章。

但是当我包含 media/v4l2-dev.h 时，我的第一次基本尝试失败了（因为我想访问像 VFL_TYPE_GRABBER 这样的宏）。

media/v4l2-dev.h 包括 linux/device.h ，其中包括 linux/ioport.h 与此输出崩溃：

```
In file included from /usr/src/linux/include/linux/device.h:16,
                 from /usr/src/linux/include/media/v4l2-dev.h:14,
                 from driv.c:11:
/usr/src/linux/include/linux/ioport.h:19: error: expected specifier-qualifier-list         before ‘resource_size_t’
/usr/src/linux/include/linux/ioport.h:116: error: expected declaration specifiers or ‘...’ before ‘resource_size_t’
/usr/src/linux/include/linux/ioport.h:116: error: expected declaration specifiers or ‘...’ before ‘resource_size_t’
/usr/src/linux/include/linux/ioport.h:121: error: expected declaration specifiers or ‘...’ before ‘resource_size_t’ 
```

[...]

来源 ：

```
#include <asm/types.h>
#include <linux/videodev2.h>

#include <media/v4l2-dev.h>

int main(int argc, char **argv) {
    return 0;
} 
```

我编译：

```
gcc -I/usr/src/linux/arch/x86/include -I/usr/src/linux/include -o prog prog.c 
```

它发生在 2.6.32-37-generic-pae 和 gcc 4.4.3 glibc 2.10 我在 gentoo 上用内核头文件和 gcc 的近似等效版本进行了同样的尝试。

我究竟做错了什么 ？

编辑：指出确切的包含路径。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T12:06:52.477

如果您正在进行驱动程序开发，则不妨使用提供的框架来执行此操作。我建议从一个现有的驱动程序构建项目（例如[那个](https://github.com/umlaeute/v4l2loopback/)）开始，通常是一个像这样简单的 Makefile：

```
KERNEL_VERSION := `uname -r`
KERNEL_DIR := /lib/modules/$(KERNEL_VERSION)/build

PWD := $(shell pwd)

obj-m := mymodule.o

all: mymodule
mymodule:
    @echo "Building my driver..."
    $(MAKE) -C $(KERNEL_DIR) M=$(PWD) modules
install:
    $(MAKE) -C $(KERNEL_DIR) M=$(PWD) modules_install
    depmod -ae
clean:
    rm -f *~
    rm -f Module.symvers Module.markers modules.order
    $(MAKE) -C $(KERNEL_DIR) M=$(PWD) clean 
```

而不是试图猜测您需要的路径。

此外，您可能不应该在需要头文件之前包含它们。

# jquery - jQuery Mobile 哈希链接在第一次单击链接后被缓存，直到 shift+f5

> ID：10703666
> 
> 赞同：0
> 
> 时间：2012-05-22T14:03:36.957
> 
> 标签：jquery, mobile, jquery-mobile, hash

我有一个使用 jQuery Mobile 库的网站，并且有几个链接如下所示：

```
<a href="#news?A">News for A zipcode</a>
<a href="#news?B">News for B</a>
<a href="#news?C">News for C</a> 
```

无论首先点击什么链接，浏览器似乎都会为所有具有相同`#news`前缀的后续链接缓存。例子...

1.  用户点击第二个链接`#news?B`，浏览器正确转到`#news?B`
2.  用户点击返回按钮，被带回家
3.  用户点击第一个链接`#news?A`，浏览器错误地转到`#news?B`（从第 1 步缓存？）

如果我再次 shift-f5，那么之后我点击的任何链接都会从那时起成为“缓存”链接。有任何想法吗？我已经在我的手机和带有用户代理切换器的 Chrome 中对此进行了测试（假冒我的浏览器以为它是移动设备）。

**编辑**- 我想我在这里找到了答案，[http://jquerymobile.com/test/docs/pages/page-dynamic.html](http://jquerymobile.com/test/docs/pages/page-dynamic.html)。在更新此问题之前将进行测试和验证。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T14:09:17.350

尝试像这样使用它

```
<a href="#news_A">News for A zipcode</a>
<a href="#news_B">News for B</a>
<a href="#news_C">News for C</a> 
```

如果您在其他地方访问它`_`，还可以更改要使用的代码`?`

您也可以使用 safari 在 iPhone 或 iPad 上进行比 chrome 的 UA 切换器更精确的测试。不过，Chrome 对 Android 测试很有用。你必须去偏好并启用开发者菜单。在开发者菜单中，您可以选择切换用户代理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T15:54:29.110

好的，我发现了问题，hash.location 没有更新到点击/点击的链接（剧院）。

我使用 data-url 属性来提取正确的信息：

例子：

```
$(document).on('pagechange', function (e, o) {
    var dataURL = $('#theater').attr('data-url'); // Use this for the Theater Location as hash is not updating
    var hash = location.hash;
    var action = hash.split('?')[0]; // #whatshot, #showtimes, #zip?{zip}, #theater?{zip},{theaterId}
    var args = dataURL.split('?')[1].split(',');
    var zip = args[0];
    var theaterId = args[1];

    // load theater movies
    codejkjk.movies.Api.GetTheaterMovies(codejkjk.movies.Mobile.Currents.ShowtimeDay(), codejkjk.movies.Mobile.Currents.ZipCode(), theaterId, function (theater) {
        codejkjk.movies.Mobile.Controls.CurrentTheater().html(theater.name);
        codejkjk.movies.Mobile.Controls.TheaterMovieList().html(
            codejkjk.movies.Mobile.Controls.TheaterMovieTemplate().render(theater)
        ).show().listview('refresh'); //.trigger('create');

        // set theaterMovieBackUrl
        theaterMovieBackUrl = hash; // set back url to current url

        $.mobile.hidePageLoadingMsg();
    });
}); 
```

我在 Chrome 控制台中使用了这个功能

# visual-studio - 升级一个非常旧的 SVN 存储库

> ID：10703668
> 
> 赞同：6
> 
> 时间：2012-05-22T14:03:44.193
> 
> 标签：visual-studio, svn, version-control, visualsvn, visualsvn-server

我们目前有一个 SVN 服务器，使用 VisualSVN 服务器作为我们的前端服务器，大多数客户端都运行 VisualSVN Visual Studio 扩展和 TortoiseSVN。

我们拥有的当前存储库要追溯到一段时间...它是由我的猜测**在 2006(!) 左右**创建的，*格式*文件显示它是版本 1... 这似乎是 1.5 之前的存储库...

我们正在移动服务器，其中一台正在升级的服务器是 SVN 盒子。上次我们进行升级时，我们只是`svnadmin hotcopy`在存储库文件夹上做了一个，在新机器上安装了 VisualSVN 服务器的全新安装，复制文件，将内容指向正确的方向，嗯，它工作......

通过这次新的升级，我想知道我们可以对存储库做些什么来赋予它一些新的生命？速度提高，占用的空间更少（整个存储库目前重约 13Gb），以及更高的性能。我知道我说过两次性能/速度，但考虑到我们升级的旧机器是 32 位 P4，大约 4 Gb 内存（3.6 Gb 可用），新机器是具有 32 Gb RAM 的四核 Xeon，我们几乎相同速度就像我们最初所做的那样，从升级中展示一些东西，速度方面会很好......

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T14:31:20.257

[请参阅http://subversion.apache.org/docs/release-notes/1.6.html#repos-upgrades](http://subversion.apache.org/docs/release-notes/1.6.html#repos-upgrades)上的 Subversion 1.6 发行说明。

Apache Subversion 1.7 使用与 Subversion 1.6 相同的存储库格式，因此该条目也适用于 SVN 1.7。

升级存储库格式有两种选择：

*   您可以在存储库上执行[**转储/加载循环**](http://subversion.apache.org/faq.html#dumpload)。这可以导致更小的存储库大小和更好的整体性能，

*   您可以使用命令行升级存储库格式：`svnadmin upgrade <path-to-repository>`. 升级到当前存储库格式**可能会**导致更小的存储库大小。

# c# - Windows 窗体控件上的 Graphics.Clear 也会清除控件本身 - 如何防止这种情况发生？

> ID：10703678
> 
> 赞同：0
> 
> 时间：2012-05-22T14:04:34.397
> 
> 标签：c#, .net, graphics, controls

我尝试使用以下方法在 Picturebox 上绘制自定义选择矩形：

```
 void _drag_UpdateView(bool clearOnly, MouseEventArgs e)
    {
        System.Diagnostics.Debug.WriteLine("UpdateView");
        using (Graphics g = this.i_rendered.CreateGraphics())
        {
            g.Clear(Color.Transparent);
            if (clearOnly)
                return;
            int px = (_drag_start.X > e.Location.X)?e.Location.X:_drag_start.X;
            int py = (_drag_start.Y > e.Location.Y)?e.Location.Y:_drag_start.Y;
            if (px < 0)
                px = 0;
            if (py < 0)
                py = 0;
            int wx = Math.Abs(e.Location.X-_drag_start.X);
            int wy = Math.Abs(e.Location.Y-_drag_start.Y);
            g.DrawRectangle(Pens.LightBlue, px, py, wx, wy);
        }
    } 
```

每当我打电话时：

```
g.Clear(Color.Transparent); 
```

整个图片框变黑。但是，矩形被绘制在它上面。如果我不调用该方法，那么矩形当然会自行堆叠。我想删除旧的矩形并创建一个这样的新矩形。

谁能描述什么是错的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T15:37:53.677

不要在除`OnPaintBackground`or之外的任何其他方法中绘制控件`OnPaint`。

实际上，出于性能原因，您可能需要它（您不会刷新完全控制，只是即时更改某些内容），但它会使您的代码更加棘手，并且您总是需要在`Paint`事件（因为它可能由于许多其他原因被调用，所以输出应该是相同的）。

在`Paint`您甚至不需要使用`CreateGraphics`的内部，图形上下文位于`PaintEventArgs`对象内部，因此将代码更改为：

```
void DoPainting(object sender, PaintEventArgs e)
{
    // Do your calculations
    e.Graphics.DrawRectangle(Pens.LightBlue, px, py, wx, wy);
} 
```

正如@AndersForsgren 所指出的那样，使用该`CreateGraphics`方法并不常见，通常您不需要调用它（除了之前指出的例外情况，例如，您需要根据 AutoSize 等图形执行一些计算）。

# haskell - 在 Windows 7 上的 Haskell 平台中使用 Curl

> ID：10703679
> 
> 赞同：4
> 
> 时间：2012-05-22T14:04:44.607
> 
> 标签：haskell, curl, packages, cabal

我正在尝试在我的项目中使用“导入 Text.XML.HXT.Curl”，以便可以访问在线文件（一些 xml 文件）。

所以我得到的错误是：

```
Could not find module `Text.XML.HXT.Curl':
    Use -v to see a list of the files searched for. 
```

我试过了 ：

```
:! cabal install curl 
```

但我收到一个错误，它必须在 unix 或 cygwin 上，所以我继续安装 cygwin，现在它说：

```
checking for gcc... gcc
checking for C compiler default output file name... configure: error: C compiler cannot create executables
See `config.log' for more details.
cabal: Error: some packages failed to install:
curl-1.3.7 failed during the configure step. The exception was:
ExitFailure 77

:! gcc -version
Access is denied 
```

我尝试下载 curl 包并使用 cmd 安装它：runHaskell Setup.hs configure 但我得到了这个：

```
Setup.hs: Missing dependency on a foreign library:
Missing C library: curl
This problem can usually be solved by installing the system package that provides this library (you may need the "-dev" version) 
```

尝试在 cygwin 中安装 gcc、g++、libcurl、make，仍然失败。

尝试安装mingw/mysis，我也失败了。缺少有关 curl/curl.h 的内容。

有谁成功了，能告诉我他是怎么做到的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T17:27:32.827

`curl`在 Windows 上安装可能会很棘手。但是你可以试试[hxt-http](http://hackage.haskell.org/package/hxt-http)包。它基于原生`HTTP`包，不需要外部依赖。AFAIK 它只会在 Windows 上开箱即用。

小提示：使用`curl`with`hxt`需要安装[hxt-curl](http://hackage.haskell.org/package/hxt-curl)包。但是，是的，它无济于事，因为它取决于`curl`包:(

所以，我的回答实际上是关于“在 Windows 上使用 hxt”，而不是关于“在 Windows 上使用 curl”。如果它对您没有帮助，您可以忽略它。

# iphone - 如何在从 URL 流式传输音频时全屏显示 MPMoviePlayerController 的 UIactivity 指示器

> ID：10703686
> 
> 赞同：2
> 
> 时间：2012-05-22T14:05:09.483
> 
> 标签：iphone, ios, mpmovieplayercontroller, audio-streaming, uiactivityindicatorview

我正在使用 MPMoviePlayerController 从 URL 流式传输音频。我将其设置为全屏模式以获得更好的控制视图

```
 MPMoviePlayerController *audioStreamer = [[MPMoviePlayerController alloc] initWithContentURL:[NSURL URLWithString:URL]];
//[audioStreamer.view  setFrame:CGRectMake(0,0,320,460)];
[audioStreamer.view  setFrame:self.view.bounds];

//[self.view addSubview: audioStreamer.view];
[self.view insertSubview:audioStreamer.view belowSubview:HUD.view];
[audioStreamer setFullscreen:YES animated:YES];

//[audioStreamer.view addSubview:HUD.view];

[[NSNotificationCenter defaultCenter] addObserver: self 
                                         selector: @selector(loadStateChanged:) 
                                             name: MPMoviePlayerLoadStateDidChangeNotification 
                                           object: audioStreamer];

[audioStreamer prepareToPlay]; 
```

在流式传输和准备播放时，我想显示 UIactivicty 指示器，以便用户考虑加载音频。需要在全屏模式下查看 MPMoviePlayerController 黑屏的活动指示器的任何建议或代码段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T08:51:43.727

您需要为此实现自己的....

由于这是控制器，因此您可以获得`MPMoviePlayerController`. 只需创建`UIActivityIndicatorView`并将其放置在`MPMoviePlayerController`. 请看代码。

```
UIActivityIndicatorView *activityIndicator = [[UIActivityIndicatorView alloc] initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleWhite];
activityIndicator.frame = CGRectMake(140, 200, 50, 21);
[activityIndicator startAnimating];
[self.view addSubview:activityIndicator];
[activityIndicator release]; 
```

一旦电影通过其委托方法开始，停止此指示器。

# ms-access - 访问 - 如何返回发送邮件的结果？

> ID：10703687
> 
> 赞同：1
> 
> 时间：2012-05-22T14:05:13.220
> 
> 标签：ms-access, ms-access-2007, email

提前感谢您的帮助。我有以下代码，单击该代码会创建一封电子邮件，插入正文和客户电子邮件地址并附上发票副本。我有两个问题，一个是可以更改附件的名称，目前它只是 invoiceF.pdf 可以用它作为交付的参考。其次，是否可以捕获发送邮件的结果？我知道如果电子邮件没有发送，只是关闭，访问会显示一个信息框，上面写着“发送对象操作已取消”，我想捕捉“成功发送”确认并将今天的日期添加到一个框 [invoiceemailed]。感谢任何人提前提供帮助:)

```
Private Sub emailinvoiceF_Click()
On Error GoTo Err_emailinvoiceF_Click

If MsgBox("Email the invoice?", vbYesNo) = vbYes Then

Dim strMessage
strMessage = "Dear " & First & " " & Last & "," _
& vbCrLf & vbCrLf & "Thank you for your order: (" & DeliveryID & "), please find attached invoice." _
& vbCrLf & vbCrLf & "If you require any further information please do not hesitate to contact us." _
& vbCrLf & vbCrLf & "Kind Regards," _
& vbCrLf & vbCrLf & "SMI Hardwoods" _
& vbCrLf & vbCrLf & "Tel: 01206 396725" _
& vbCrLf & vbCrLf & "www.smi-hardwoods.com" _

    Dim stDocName As String

    stDocName = "InvoiceF"
    DoCmd.SendObject acReport, stDocName, acFormatPDF, [E-mail address], , , "SMI Hardwoods Invoice Ref:" & DeliveryID & ".pdf", strMessage
End If

Exit_emailinvoiceF_Click:
    Exit Sub

Err_emailinvoiceF_Click:
    MsgBox Err.Description
    Resume Exit_emailinvoiceF_Click

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:57:14.437

*DoCmd.SendObject*命令非常有限。它不允许您从磁盘附加文件。*由于此限制，您无法控制要使用DoCmd.SendObject*附加的文件名和文件数。

您可能会发现这篇文章很有帮助： http: [//msdn.microsoft.com/en-us/library/aa167323](http://msdn.microsoft.com/en-us/library/aa167323(v=office.11).aspx) (v=office.11​​).aspx 。

我过去使用*Outlook.Application*对象，发现它没问题。它允许在发送电子邮件之前进行一些用户交互。此外，它直接进入 Outlook，因此跟踪可能更容易。但是，这种方法有其自身的缺点。

根据您关于成功消息的问题，您可以将以下内容添加到您的代码中：

```
....
    DoCmd.SendObject acReport, stDocName, acFormatPDF, [E-mail address], , , "SMI Hardwoods Invoice Ref:" & DeliveryID & ".pdf", strMessage

    'Display success message
    MsgBox("Successfully sent on: " & Date())
End If

Exit_emailinvoiceF_Click:
    Exit Sub
... 
```

# javascript - （拖动 n）在 Firefox 中拖放文件

> ID：10703691
> 
> 赞同：1
> 
> 时间：2012-05-22T14:05:18.890
> 
> 标签：javascript, firefox, drag-and-drop

因为一个演示值得 72.814 字：http: [//jsfiddle.net/rudiedirkx/J575b/3/show/](http://jsfiddle.net/rudiedirkx/J575b/3/show/)

这是最简单的演示。三个事件：drag over、drag leave 和 drop。`over`并按`leave`预期工作（添加和删除类）。然而，下降没有！

与 IE 一样，它会在窗口中打开拖放的文件。在 Chrome 中，该事件取消并且拖放文件（在这种情况下被忽略）。

drop 事件甚至不会在 Firefox 中触发！？

这是怎么回事？我认为这有效......（它在 Chrome 中有效。在 Opera 11.64 中无效。）

**编辑**

**已修复**，感谢阿德里亚诺：http: [//jsfiddle.net/rudiedirkx/J575b/5/show/](http://jsfiddle.net/rudiedirkx/J575b/5/show/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T14:19:40.767

将您的处理程序更改`ondragover`为：

```
drop.ondragover = function() {
    this.classList.add('over');
    return false;
}; 
```

请注意[Mozilla.org](https://developer.mozilla.org/En/DragDrop/Drag_Operations#droptargets)`return false`中的这一行，您需要或从函数中返回一个 false 值以允许删除。`preventDefault()`

# ruby-on-rails - 在 Rails 3.2 中预编译资产时卡住了

> ID：10703693
> 
> 赞同：0
> 
> 时间：2012-05-22T14:05:19.303
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在尝试将我的第一个应用程序投入生产，并在尝试预编译时遇到以下问题：

```
rake aborted!
Undefined variable: "$yellowCorp"
  (in app/assets/stylesheets/_dialog.scss) 
```

$yellowCorp 在

```
 app/assets/stylesheets/_variables.css.scss 
```

我已经做了很多阅读，似乎有很多人为此而苦苦挣扎。我尝试了许多对他们有用的解决方案，但没有一个对我有用。在 config/environments/production.rb 我试过

```
config.assets.precompile += %w(*.css.scss *.scss) 
```

和

```
config.assets.precompile << [ "*.scss", "*.css", "*.js" ] 
```

和

```
config.assets.precompile += [ "_variables.css.scss", "_dialog.scss" ] 
```

...除其他外，但没有任何变化，但没有什么能让我超越这一点。任何帮助/建议将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T14:18:06.897

我想这个问题源于文件的编译顺序。它在变量之前编译对话框文件。

你的 application.css.scss 文件是什么样的？

您可能需要指定编译它们的顺序，而不是需要树：

```
@import "variables.css.scss"
@import "dialog.scss" 
```

# cpu-usage - 高 CPU 使用率是否表明软件模块设计错误

> ID：10703695
> 
> 赞同：1
> 
> 时间：2012-05-22T14:05:28.277
> 
> 标签：cpu-usage

我们有一个计算密集型的过程。当它运行时，它通常使用 99% 的可用 CPU。它被配置为利用所有可用的处理器，所以我相信这没问题。但是，我们的一位客户抱怨说，由于 CPU 利用率高，运行此进程的服务器上的警报会响起。我认为高 CPU 利用率本身并没有错。当进程停止运行并且进程运行完成（没有无限循环等）时，CPU 会恢复正常。当我说高 CPU 使用率本身不是问题时，我只是想知道我是否站稳脚跟。

谢谢，

艾略特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T14:08:07.220

> 如果当我说高 CPU 使用率本身不是问题时，我站在坚实的基础上

你在坚实的基础上。

> 我们有一个计算密集型的过程

然后我预计 CPU 使用率会很高。

> 当进程停止运行时 CPU 恢复正常

到目前为止听起来不错。

* * *

您的客户端使用的系统可能配置为在 CPU 使用率超过某个限制时发出通知，因为有时这表明存在问题（持续的高使用率可能导致过热和相关问题）。

如果这是预期行为，您的客户需要调整他们的监控 - 但您需要确保该行为在他们的系统上符合预期，并且不太可能导致问题（确保不维持高 CPU 使用率）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T14:12:31.180

警报不是设计不佳的可行原因。真正的原因可能是它阻塞了系统上的其他任务。现代操作系统通常通过降低 CPU 饥饿进程的动态优先级来解决这个问题，这样对 CPU 时间要求较低的其他进程将获得更高的优先级。您可能会告诉客户“很好”开始的过程，因为您可能不在乎它是否运行 10 分钟或 12 分钟。只是我的 2 美分 :)

# sencha-touch - Sencha Touch 2 嵌套模型和数据存储

> ID：10703697
> 
> 赞同：10
> 
> 时间：2012-05-22T14:05:31.977
> 
> 标签：sencha-touch, extjs, sencha-touch-2

我什至几乎不知道如何问这个，但这里就行了。

我有两个模型，一个包含许多食谱的拼盘：

```
Ext.define('NC.model.Platter', {
  extend: 'Ext.data.Model',
  config: {
    fields: [
      { name: 'name', type: 'string' },
      { name: 'text', type: 'string' }
    ],
    associations: [
      {type: 'hasMany', model: 'NC.model.Recipe', name: 'recipes', filterProperty: 'text'}
    ]
  }
});

Ext.define('NC.model.Recipe', {
  extend: 'Ext.data.Model',
  config: {
      fields: [
        { name: 'name', type: 'string' },
        { name: 'image', type: 'string' },
        { name: 'stepsText', type: 'string', mapping: 'properties.preparationText' },
        { name: 'ingredientsText', type: 'string', mapping: 'properties.ingredientsText' }
      ]
    }
}); 
```

拼盘基本上是在线食谱商店中的不同过滤器。所以我可能有一千个食谱，但我的“披萨”拼盘只会返回披萨食谱（因此是 filterProperty）。拼盘只是在本地创建和存储，而食谱是在线的。所以，商店：

```
Ext.define('NC.store.Platters', {
  extend: 'Ext.data.Store',

  config: {
    model: 'NC.model.Platter',
    storeId: 'Platters',
    proxy: {
      type: 'localstorage',
      id: 'platters'
    },
    data : [
        {name: 'Noodles', text: 'noodle'},
        {name: 'Baked', text: 'bake'},
        {name: 'Pizza', text: 'pizza'}
    ]
  }
});

Ext.define('NC.store.Recipes', {
  extend: 'Ext.data.Store',

  config: {
    model: 'NC.model.Recipe',
    storeId: 'Recipes',
    proxy: {
      type: 'jsonp',
      url: 'xxxx',  // url here (redacted)
      callbackKey: 'callback',
      filterParam: 'text',
      extraParams: {
        // credentials and tokens here (redacted)
      },
      reader: {
        type: 'json',
        idProperty: 'uuid',
      }
    }
  }
}); 
```

现在，我想创建一个数据视图的数据视图。拼盘列表，每个都包含它的食谱列表：

```
Ext.define('NC.view.DiscoverGrid', {
  extend: 'Ext.DataView',
  xtype: 'discovergrid',
  id: 'discover',

config: {
    title: 'Discover',
    baseCls: '',
    useComponents: true,
    defaultType: 'platter',
    store: 'Platters',
    ui: 'light'
  }
});

Ext.define('NC.view.Platter', {
  extend: 'Ext.dataview.component.DataItem',
    xtype: 'platter',

  config: {
      layout: 'fit',
      height: '100px',
      list: {
        itemTpl: '{name}',
        inline: true,
        scrollable: {
          direction: 'horizontal',
          directionLock: true
        }
      },
      dataMap: {
        getList: {
          setData: 'recipes'
        }
      }
    },

    applyList: function(config) {
      return Ext.factory(config, Ext.DataView, this.getList());
    },

  updateList: function(newList, oldList) {
    if (newList) {
        this.add(newList);
      }

  if (oldList) {
        this.remove(oldList);
      }
    }
  }); 
```

现在，我如何填充拼盘的食谱？如果我用一些内联配方数据填充拼盘，例如：

```
data : [
    {name: 'Noodles', text: 'noodle', recipes: [
      { name: 'Pasta', ingredientsText: "Tomatoes\nPassata\n1tsp Oregano", preparationText: "Do something\nAdd passata\nmix in oregano and tomato",
        ingredients: [{ text: "bla"}]
      }
    ]},
    {name: 'Baked', text: 'bake'},
    {name: 'Pizza', text: 'pizza'}
] 
```

...它直接工作并在其中呈现带有Pasta的数据视图。所以我只需要知道如何让我的盘子填充他们的食谱数据。在哪里（我假设在某种初始化事件的控制器中）以及如何连接它？我是否正确使用了 filterProperty？我不完全理解这方面的文档，但我认为它通常会过滤我没有的外键，并且 filterProperty 会覆盖它。这样 URL 就会附加 &text=noodle 。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T13:49:32.367

这当然似乎没有利用我认为 Sencha Touch 具有的关联和存储结构，但即使在进行到使`recipes()`关联正确加载之后，我也无法触发数据视图刷新。我花了太多时间在上面，所以我选择了一个不太优雅的解决方案。我将过滤器文本传递给 Platter 上的设置器，该设置器使用参数中的此过滤器设置它的存储。它至少有效！

```
Ext.define('NC.view.PlatterDataItem', {
  extend: 'Ext.dataview.component.DataItem',
  xtype: 'platterdataitem',

  config: {
    layout: 'vbox',
    height: '130px',
    cls: 'platter',
    list: {
    },
    dataMap: {
      getList: {
        setRecipeFilters: 'text'
      }
    }
  },

  applyList: function(config) {
    return Ext.factory(config, NC.view.Platter, this.getList());
  },

  updateList: function(newList, oldList) {
    if (newList) {
      this.add(newList);
    }

    if (oldList) {
      this.remove(oldList);
    }
  }
});

Ext.define('NC.view.Platter', {
  extend: 'Ext.DataView',
  xtype: 'platter',

  config: {
    layout: 'vbox',
    height: '130px',
    itemCls: 'platter-item',
    itemTpl:  '<div class="thumb"><tpl if="image != null"><img src="{image}" /></tpl></div>'+
              '<div class="name">{name}</div>',
    inline: {
      wrap: false
    },
    scrollable: {
      direction: 'horizontal',
      directionLock: true
    }
  },

  setRecipeFilters: function(text) {
    var store = Ext.create('Ext.data.Store', {
      model: 'NC.model.Recipe',
      autoLoad: true,
      proxy: {
        type: 'jsonp',
        url: 'xxxxx',
        callbackKey: 'callback',
        extraParams: {
          // credentials & text filter param
        },
        reader: {
          type: 'json',
          idProperty: 'uuid',
        }
      }
    });

    this.setStore(store);
  }
}); 
```

# java - 在一个非常大的给定整数范围内找到所有素数的程序

> ID：10703699
> 
> 赞同：5
> 
> 时间：2012-05-22T14:05:36.840
> 
> 标签：java, algorithm, primes, sieve-of-eratosthenes

我在一个编程网站上遇到了以下问题：彼得想为他的密码系统生成一些素数。帮助他！你的任务是生成两个给定数字之间的所有素数！

输入

输入以单行中的测试用例数量 t (t<=10) 开始。在接下来的 t 行中的每一行中，都有两个数字 m 和 n (1 <= m <= n <= 1000000000, nm<=100000)，由空格分隔。

我想出了以下解决方案：

```
import java.util.*;

public class PRIME1 {
    static int numCases;
    static int left, right;
    static boolean[] initSieve = new boolean[32000];
    static boolean[] answer;

    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);
        numCases = sc.nextInt();
        initSieve[0] = true;
        initSieve[1] = true;
        Sieve();
        for (int j = 0; j < numCases; j++) {
            String line = sc.next();
            String line2 = sc.next();
            left = Integer.parseInt(line);
            right = Integer.parseInt(line2);
            answer = new boolean[right - left + 1];
            getAnswer();
            for (int i = 0; i < answer.length; i++) {
                if (!answer[i]) {
                    int ans = i + left;
                    System.out.println(ans);
                }
            }
            System.out.println();
        }
    }

    public static void Sieve() {

        for (int i = 2; i < 32000; i++) {
            if (!initSieve[i]) {
                for (int j = 2 * i; j < 32000; j += i) {
                    initSieve[j] = true;
                }
            }
            if (i * i > 32000)
                break;
        }
    }

    public static void getAnswer() {
        for (int i = 2; i < 32000 && i <= right; i++) {
            if (!initSieve[i]) {
                int num = i;
                if (num * 2 >= left) {
                    num *= 2;
                } else {
                    num = (num * (left / num));
                    if (num < left)
                        num += i;
                }
                for (int j = num; j >= left && j <= right; j += i) {
                    answer[j - left] = true;
                }
            }
        }
    }
} 
```

在阅读了一些建议后，我编辑了我的解决方案。我仍然收到超出时间限制的错误。关于如何进一步优化这一点的更多建议？我正在计算直到 32000 的所有素数，然后使用这些来找到 n 到 m 之间的素数。

谢谢，罗希特

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T14:48:00.563

给你

> 1 <= m <= n <= 1000000000，nm<=100000

这些都是非常小的数字。要筛选上限为 的范围`n`，您需要 的素数`√n`。在这里，您知道`n <= 10^9`，所以`√n < 31623`，所以您最多需要 31621 的素数。有 3401。您可以在几微秒内使用标准筛子生成它们。

然后，您可以通过标记您之前筛选过的素数的倍数来简单地筛选从`m`到的小范围，当素数超过 时停止。通过从筛子中消除一些小素数的倍数可以获得一些加速，但逻辑变得更加复杂（您需要特别对待小筛子）。`n``√n``m`

```
public int[] chunk(int m, int n) {
    if (n < 2) return null;
    if (m < 2) m = 2;
    if (n < m) throw new IllegalArgumentException("Borked");
    int root = (int)Math.sqrt((double)n);
    boolean[] sieve = new boolean[n-m+1];
    // primes is the global array of primes to 31621 populated earlier
    // primeCount is the number of primes stored in primes, i.e. 3401
    // We ignore even numbers, but keep them in the sieve to avoid index arithmetic.
    // It would be very simple to omit them, though.
    for(int i = 1, p = primes[1]; i < primeCount; ++i) {
        if ((p = primes[i]) > root) break;
        int mult;
        if (p*p < m) {
            mult = (m-1)/p+1;
            if (mult % 2 == 0) ++mult;
            mult = p*mult;
        } else {
            mult = p*p;
        }
        for(; mult <= n; mult += 2*p) {
            sieve[mult-m] = true;
        }
    }
    int count = m == 2 ? 1 : 0;
    for(int i = 1 - m%2; i < n-m; i += 2) {
        if (!sieve[i]) ++count;
    }
    int sievedPrimes[] = new int[count];
    int pi = 0;
    if (m == 2) {
        sievedPrimes[0] = 2;
        pi = 1;
    }
    for(int i = 1 - m%2; i < n-m; i += 2) {
        if (!sieve[i]) {
            sievedPrimes[pi++] = m+i;
        }
    }
    return sievedPrimes;
} 
```

使用一个`BitSet`或任何其他类型的打包标志数组将减少内存使用，因此由于更好的缓存局部性，可能会显着提高速度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T14:09:09.113

使用 BitSet 而不是布尔数组。

```
public static BitSet primes (final int MAX)
{
     BitSet primes = new BitSet (MAX);
     // make only odd numbers candidates...
     for (int i = 3; i < MAX; i+=2)
     {
        primes.set(i);
     }
     // ... except no. 2
     primes.set (2, true);
     for (int i = 3; i < MAX; i+=2)
     {
        /*
            If a number z is already  eliminated (like 9),
             because it is itself a multiple of a prime 
            (example: 3), then all multiples of z (9) are
            already eliminated.
        */
        if (primes.get (i))
        {
            int j = 3 * i;
            while (j < MAX)
            {
                if (primes.get (j))
                    primes.set (j, false);
                j += (2 * i);
            }
        }
    }
    return primes;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T14:19:50.760

你**必须**将结果存储在数组中吗？计算给定整数是否为素数并为每个数字调用它的**方法**`{left,left+1,...,right}`怎么样？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T14:22:09.600

访问 isNotPrime 数组时始终可以使用偏移量。

给定 m，n：

```
boolean[] isNotPrime = new boolean[n-m+1];

// to now if number x is primer or not
boolean xIsPrime = isNotPrime[x-m]; 
```

这里 m 是偏移量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-22T14:36:25.287

您不必拥有一个大数组：您可以保留迄今为止找到的素数列表，并使用多个数组进行测试，值 = array_slot + 偏移量（已经测试过的值）。一旦你完成了从 i 到 j 的值，你将 ji 添加到 offset 并从 J 开始一个新的数组。

您可以从数组中删除偶数，这样可以节省一些空间（值 = array_slot * 2 - 1）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-22T18:48:04.130

由于 m 和 n 之间的距离相对较小，因此您可以对 m 和 n 之间的每个数字进行暴力破解并使用快速素数测试算法。

如果您允许概率算法，您可以使用[Miller-Rabin 测试](http://en.wikipedia.org/wiki/Miller%E2%80%93Rabin_primality_test)。令 M = nm <= 10^5 和 N = n <= 10^9。蛮力算法的复杂度为 O(k M (log N)^3)，其中 k 是控制概率保证的常数（对于实际应用，k 可以设置为 10）。

对于问题的限制，这个复杂度将在 10^9 左右。

# c++ - 视差映射中的立体视觉

> ID：10703702
> 
> 赞同：1
> 
> 时间：2012-05-22T14:05:44.110
> 
> 标签：c++, opencv, camera-calibration, stereo-3d

我正在实现立体视觉深度映射，如 O'reilly 书的 opencv 教科书中的示例所示。

在实现此代码时，我的相机都是水平的并且两者都不相同。执行代码后，我得到了非常奇怪的结果。我想验证这些奇怪的结果是只是因为相机迷失方向还是代码中有任何问题，请帮助我。

```
#include "cv.h"
#include "cxmisc.h"
#include "highgui.h"
//#include "cvaux.h"
#include &lt;vector&gt;
#include &lt;string&gt;
#include &lt;algorithm&gt;
#include &lt;stdio.h&gt;
#include &lt;ctype.h&gt;
#define WIDTH 426
#define HEIGHT 320

using namespace std;
int main()
{
    //---------Initial--------
    int  nx=7, ny=7, frame = 0, n_boards =20, N;
    int count1 = 0,count2 = 0, result1=0, result2=0;
    int showUndistorted = 1, successes1 = 0,successes2 = 0 ;
    const int maxScale = 1;
    const float squareSize = 2.f;        //Set this to your actual square size
    CvSize imageSize = {WIDTH,HEIGHT};
    CvCapture *capture1= NULL, *capture2= NULL;
    CvSize board_sz = cvSize( nx,ny );

    int i, j, n = nx*ny, N1 = 0, N2 = 0;
    vector&lt;CvPoint2D32f&gt; points[2];
    vector&lt;int&gt; npoints;
    vector&lt;CvPoint3D32f&gt; objectPoints;
    vector&lt;CvPoint2D32f&gt; temp1(n);
    vector&lt;CvPoint2D32f&gt; temp2(n);

    double M1[3][3], M2[3][3], D1[5], D2[5];
    double R[3][3], T[3], E[3][3], F[3][3];
    double Q[4][4];
    CvMat _Q = cvMat(4,4, CV_64F, Q);
    CvMat _M1 = cvMat(3, 3, CV_64F, M1 );
    CvMat _M2 = cvMat(3, 3, CV_64F, M2 );
    CvMat _D1 = cvMat(1, 5, CV_64F, D1 );
    CvMat _D2 = cvMat(1, 5, CV_64F, D2 );
    CvMat _R = cvMat(3, 3, CV_64F, R );
    CvMat _T = cvMat(3, 1, CV_64F, T );
    CvMat _E = cvMat(3, 3, CV_64F, E );
    CvMat _F = cvMat(3, 3, CV_64F, F );

    //---------Starting WebCam----------
    capture1= cvCaptureFromCAM(0);
    assert(capture1!=NULL); cvWaitKey(0);
    capture2= cvCaptureFromCAM(1);
    assert(capture2!=NULL);

    //assure capture size is correct...
    int res=cvSetCaptureProperty(capture1,CV_CAP_PROP_FRAME_WIDTH,WIDTH);
    printf("%d",res);
    res=cvSetCaptureProperty(capture1,CV_CAP_PROP_FRAME_HEIGHT,HEIGHT);
    printf("%d",res);
    res=cvSetCaptureProperty(capture2,CV_CAP_PROP_FRAME_WIDTH,WIDTH);
    printf("%d",res);
    res=cvSetCaptureProperty(capture2,CV_CAP_PROP_FRAME_HEIGHT,HEIGHT);
    printf("%d",res); fflush(stdout);

    IplImage *frame1 = cvQueryFrame( capture1 );
    IplImage* gray_fr1 = cvCreateImage( cvGetSize(frame1), 8, 1 );
    IplImage *frame2 = cvQueryFrame( capture2 );
    IplImage* gray_fr2 = cvCreateImage( cvGetSize(frame1), 8, 1 );
    //imageSize = cvGetSize(frame1);

    //Show Window
    cvNamedWindow( "camera2", 1 );
    cvNamedWindow( "camera1", 1 );
    cvNamedWindow("corners camera1",1);
    cvNamedWindow("corners camera2",1);
    while((successes1&lt;n_boards)||(successes2&lt;n_boards))
    {

        //--------Find chessboard corner--------------------------------------------------

        if((frame++ % 20) == 0)
        {
            //----------------CAM1-------------------------------------------------------------------------------------------------------
            result1 = cvFindChessboardCorners( frame1, board_sz,&temp1[0], &count1,CV_CALIB_CB_ADAPTIVE_THRESH|CV_CALIB_CB_FILTER_QUADS);
            cvCvtColor( frame1, gray_fr1, CV_BGR2GRAY );

            //----------------CAM2--------------------------------------------------------------------------------------------------------
            result2 = cvFindChessboardCorners( frame2, board_sz,&temp2[0], &count2,CV_CALIB_CB_ADAPTIVE_THRESH|CV_CALIB_CB_FILTER_QUADS);
            cvCvtColor( frame2, gray_fr2, CV_BGR2GRAY );

            if(count1==n&&count2==n&&result1&&result2)
            {
                cvFindCornerSubPix( gray_fr1, &temp1[0], count1,cvSize(11, 11), cvSize(-1,-1),cvTermCriteria(CV_TERMCRIT_ITER+CV_TERMCRIT_EPS,30, 0.01) );
                cvDrawChessboardCorners( frame1, board_sz, &temp1[0], count1, result1 );
                cvShowImage( "corners camera1", frame1 );
                N1 = points[0].size();
                points[0].resize(N1 + n, cvPoint2D32f(0,0));
                copy( temp1.begin(), temp1.end(), points[0].begin() + N1 );
                ++successes1;

                cvFindCornerSubPix( gray_fr2, &temp2[0], count2,cvSize(11, 11), cvSize(-1,-1),cvTermCriteria(CV_TERMCRIT_ITER+CV_TERMCRIT_EPS,30, 0.01) );
                cvDrawChessboardCorners( frame2, board_sz, &temp2[0], count2, result2 );
                cvShowImage( "corners camera2", frame2 );
                N2 = points[1].size();
                points[1].resize(N2 + n, cvPoint2D32f(0,0));
                copy( temp2.begin(), temp2.end(), points[1].begin() + N2 );
                ++successes2;

                putchar('$');
            }

            else
            {        cvShowImage( "corners camera2", gray_fr2 );
                cvShowImage( "corners camera1", gray_fr1 );
            }

            frame1 = cvQueryFrame( capture1 );
            cvShowImage("camera1", frame1);
            frame2 = cvQueryFrame( capture2 );
            cvShowImage("camera2", frame2);

            if(cvWaitKey(15)==27) break;
        }
    }
    cvReleaseCapture( &capture1 );
    cvReleaseCapture( &capture2 );
    cvDestroyWindow("camera1");
    cvDestroyWindow("camera2");
    cvDestroyWindow("corners camera1");
    cvDestroyWindow("corners camera2");
    printf("\n");

    //--------------Calibaration-------------------
    N = n_boards*n;
    objectPoints.resize(N);
    for( i = 0; i &lt; ny; i++ )
    for(j = 0; j &lt; nx; j++ )   objectPoints[i*nx + j] = cvPoint3D32f(i*squareSize, j*squareSize, 0);
    for( i = 1; i &lt; n_boards; i++ ) copy( objectPoints.begin(), objectPoints.begin() + n, objectPoints.begin() + i*n );
    npoints.resize(n_boards,n);

    CvMat _objectPoints = cvMat(1, N, CV_32FC3, &objectPoints[0] );
    CvMat _imagePoints1 = cvMat(1, N, CV_32FC2, &points[0][0] );
    CvMat _imagePoints2 = cvMat(1, N, CV_32FC2, &points[1][0] );
    CvMat _npoints = cvMat(1, npoints.size(), CV_32S, &npoints[0] );
    cvSetIdentity(&_M1);
    cvSetIdentity(&_M2);
    cvZero(&_D1);
    cvZero(&_D2);

    printf("Running stereo calibration ...");
    fflush(stdout);
    cvStereoCalibrate( &_objectPoints, &_imagePoints1, &_imagePoints2, &_npoints,&_M1, &_D1, &_M2, &_D2,imageSize, &_R, &_T, &_E, &_F,
    cvTermCriteria(CV_TERMCRIT_ITER+CV_TERMCRIT_EPS, 100, 1e-5),
    CV_CALIB_FIX_ASPECT_RATIO+CV_CALIB_ZERO_TANGENT_DIST + CV_CALIB_SAME_FOCAL_LENGTH );
    printf("done\n");
    //-------------Undistort------------------------------------------
    cvUndistortPoints( &_imagePoints1, &_imagePoints1,&_M1, &_D1, 0, &_M1 );
    cvUndistortPoints( &_imagePoints2, &_imagePoints2,&_M2, &_D2, 0, &_M2 );

    //--------Using bouguet algorithm-------------------
    CvMat* mx1 = cvCreateMat( imageSize.height,imageSize.width, CV_32F );
    CvMat* my1 = cvCreateMat( imageSize.height,imageSize.width, CV_32F );
    CvMat* mx2 = cvCreateMat( imageSize.height,imageSize.width, CV_32F );
    CvMat* my2 = cvCreateMat( imageSize.height,imageSize.width, CV_32F );
    CvMat* frame1r = cvCreateMat( imageSize.height,imageSize.width, CV_8U );
    CvMat* frame2r = cvCreateMat( imageSize.height,imageSize.width, CV_8U );
    CvMat* disp = cvCreateMat( imageSize.height, imageSize.width, CV_16S );
    CvMat* vdisp = cvCreateMat( imageSize.height,imageSize.width, CV_8U );
    CvMat* Image3D = cvCreateMat(imageSize.height, imageSize.width, CV_32FC3);
    CvMat* pair;
    double R1[3][3], R2[3][3], P1[3][4], P2[3][4];
    CvMat _R1 = cvMat(3, 3, CV_64F, R1);
    CvMat _R2 = cvMat(3, 3, CV_64F, R2);
    //Calib with Bouguet algrithm
    CvMat _P1 = cvMat(3, 4, CV_64F, P1);
    CvMat _P2 = cvMat(3, 4, CV_64F, P2);
    cvStereoRectify( &_M1, &_M2, &_D1, &_D2, imageSize,&_R, &_T,&_R1, &_R2, &_P1, &_P2, &_Q,0/*CV_CALIB_ZERO_DISPARITY*/ );
    //Find matrix for cvRemap()
    cvInitUndistortRectifyMap(&_M1,&_D1,&_R1,&_P1,mx1,my1);
    cvInitUndistortRectifyMap(&_M2,&_D2,&_R2,&_P2,mx2,my2);

    pair = cvCreateMat( imageSize.height, imageSize.width*2,CV_8UC3 );
    //Paramater for stereo corrrespondences
    CvStereoBMState *BMState = cvCreateStereoBMState();
    assert(BMState != 0);
    BMState-&gt;preFilterSize=31;
    BMState-&gt;preFilterCap=31;
    BMState-&gt;SADWindowSize=35;
    BMState-&gt;minDisparity= 0;
    BMState-&gt;numberOfDisparities=48;
    BMState-&gt;textureThreshold=20;        //reduce noise
    BMState-&gt;uniquenessRatio=15;        // uniquenessRatio &gt; (match_val–min_match)/min_match.
    /*    CvStereoBMState *state = cvCreateStereoBMState(CV_STEREO_BM_BASIC);
    BMState-&gt;speckleRange = 50;
    BMState-&gt;textureThreshold = 400;*/

    //Bat camera va hien thi
    //cvNamedWindow( "camera2", 1 );
    //cvNamedWindow( "camera1", 1 );
    cvNamedWindow( "rectified",1 );
    cvNamedWindow( "disparity",1);
    cvNamedWindow("depthmap",1);

    capture1= cvCaptureFromCAM(0);
    assert(capture1!=NULL); cvWaitKey(10);
    capture2= cvCaptureFromCAM(1);
    assert(capture2!=NULL);
    res=cvSetCaptureProperty(capture1,CV_CAP_PROP_FRAME_WIDTH,WIDTH);
    printf("%d",res);
    res=cvSetCaptureProperty(capture1,CV_CAP_PROP_FRAME_HEIGHT,HEIGHT);
    printf("%d",res);
    res=cvSetCaptureProperty(capture2,CV_CAP_PROP_FRAME_WIDTH,WIDTH);
    printf("%d",res);
    res=cvSetCaptureProperty(capture2,CV_CAP_PROP_FRAME_HEIGHT,HEIGHT);
    printf("%d",res); fflush(stdout);

    frame1 = cvQueryFrame( capture1 );
    frame2 = cvQueryFrame( capture2 );

    while(1)
    {
        CvMat part;
        cvCvtColor( frame1, gray_fr1, CV_BGR2GRAY );
        cvCvtColor( frame2, gray_fr2, CV_BGR2GRAY );
        cvRemap( gray_fr1, frame1r, mx1, my1 );
        cvRemap( gray_fr2, frame2r, mx2, my2 );
        cvFindStereoCorrespondenceBM( frame1r, frame2r, disp, BMState);

        /*        cvShowImage("camera1", frame1);
        cvShowImage("camera2", frame2);            */
        //        cvConvertScale( disp, disp, 16, 0 );
        cvNormalize( disp, vdisp, 0, 256, CV_MINMAX );
        cvShowImage( "disparity", vdisp );
        cvReprojectImageTo3D(disp, Image3D, &_Q);
        cvShowImage("depthmap",Image3D);

        //Hien thi anh da rectify
        cvGetCols( pair, &part, 0, imageSize.width );
        cvCvtColor( frame1r, &part, CV_GRAY2BGR );
        cvGetCols( pair, &part, imageSize.width, imageSize.width*2 );
        cvCvtColor( frame2r, &part, CV_GRAY2BGR ); //CV_GRAY2BGR
        for( j = 0; j &lt; imageSize.height; j += 16 )
        cvLine( pair, cvPoint(0,j), cvPoint(imageSize.width*2,j), CV_RGB(0,255,0));
        cvShowImage( "rectified", pair );
        frame1 = cvQueryFrame( capture1 );
        frame2 = cvQueryFrame( capture2 );
        if( cvWaitKey(15) == 27 )  break;
    }
    while( 1 ) { if((cvWaitKey(10)&0x7f) == 27 ) break; }
    cvReleaseStereoBMState(&BMState);
    cvReleaseMat( &mx1 );
    cvReleaseMat( &my1 );
    cvReleaseMat( &mx2 );
    cvReleaseMat( &my2 );
    cvReleaseCapture( &capture1 );
    cvReleaseCapture( &capture2 );
    cvReleaseMat( &frame1r );
    cvReleaseMat( &frame2r );
    cvReleaseMat( &disp );
    cvReleaseMat(&Image3D);

} 
```

[这个链接](https://plus.google.com/photos/110965556771924534380/albums/5745356738809417329?authkey=CJCyw_DPm52K5wE)中给出了视差图的照片 一个是网络摄像头另一个是USB摄像头

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T15:57:27.023

拥有不同的相机将使您的生活更加困难。首先，我怀疑相机的焦距是否相同，因此`CV_CALIB_SAME_FOCAL_LENGTH`设置的参数会导致您对这对相机进行错误校准（将其作为固定参数删除，因为它几乎肯定会有所不同）。

此外，在相关参数说明中，您通过径向失真参数 k1 - k6 为校准算法提供了很大的灵活性，因为这些参数都不是固定的。首先尝试使用最少数量的参数来获得良好的拟合。例如，修复除 k1 和 k2 之外的所有内容（即使用`CV_CALIB_FIX_K3 + CV_CALIB_FIX_K4 + CV_CALIB_FIX_K5 + CV_CALIB_FIX_K6`）。如果这不起作用，请允许 k3 可变等...

**编辑：** 另一个提示，考虑分别校准每个相机，然后传递`CV_CALIB_FIX_INTRINSIC`两个相机内在矩阵以缩小搜索空间，这将有望使算法收敛到全局而不是局部校准最小值。

希望有帮助！

# encryption - 如何存储用于加密的密钥

> ID：10703704
> 
> 赞同：1
> 
> 时间：2012-05-22T14:05:50.677
> 
> 标签：encryption, coldfusion, coldfusion-9, des

我正在构建一个身份验证系统，其中一些信息被加密存储，因此人类无法阅读。因为它是加密的，所以我需要使用该`generateSecretKey()`函数（因为我没有使用 CFMX_COMPAT 方法）。当用户在系统中注册并一直使用它时，我对创建它感到紧张，所以我考虑在每次用户登录时创建一个新的，但不确定这是否真的有必要。我已经在调用一种方法来更新每次登录时的用户登录时间戳，因此添加一个新的密钥也不错，但我想确保我没有过火，所以我的问题是：

> 在为用户生成用于加密信息的密钥时，最好是在每次登录时创建一个新密钥，还是在注册时创建一个并一直使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T16:10:04.697

你的回答（正如精灵对佛罗多所说）是肯定的和否定的。或者用鲍勃·多尔的话来说，当被问及他是否穿平角裤或短裤时……“取决于”。

您所询问的内容与要求密切相关。表面上，第二种选择——“生成新密钥”——比重复使用相同的密钥*更安全。*在第一种情况下，每个用户都有一个密钥。在第二个中，您的密钥更加短暂，并且在会话后消失。所以真正的问题是，什么级别的安全性*足以*满足您的要求。

权衡是代码稍微复杂一些，服务器必须更加努力地工作，并且您不能持久化会话（因为重新启动服务器可能会杀死您的密钥）。它还可能使审计报告等事情变得更加困难，因为听起来您正在加密某些日志类型或审计跟踪类型的信息。

我要补充一点，如果您将这些密钥与数据一起存储，您最好不要费心生成新密钥。您已经降低了将钥匙放在欢迎垫下可能获得的任何好处；）

希望这会有所帮助......抱歉含糊不清。

# groovy - Groovy 的非参数 grep() 和 findAll() 方法有什么区别吗？

> ID：10703707
> 
> 赞同：25
> 
> 时间：2012-05-22T14:06:02.293
> 
> 标签：groovy

来自 Groovy JDK：

### [公共集合 grep()](http://groovy.codehaus.org/groovy-jdk/java/lang/Object.html#grep%28%29)

> 迭代此 Object 表示的项目集合，并使用 IDENTITY 闭包作为过滤器返回匹配的每个项目 - 有效地返回满足 Groovy 真理的所有元素。

### [公共集合 findAll()](http://groovy.codehaus.org/groovy-jdk/java/lang/Object.html#findAll%28%29)

> 查找与 IDENTITY 闭包匹配的所有项目（即匹配 Groovy 真值）。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-05-23T09:59:12.560

简短的回答：结果是一样的。

长答案： `grep`通常使用过滤器对象，`isCase`然后在其上调用。因此，grep 的参数通常不是 Groovy Closure。因为`findAll`您使用闭包作为参数，并且如果闭包的结果被评估为真，它将被带入结果集合。

现在重要的是要知道闭包也有一个 isCase 方法。`Closure#isCase(Object)`将使用参数作为闭包的参数执行闭包，然后使用 Groovy Truth 对其结果进行评估。对于身份闭包，即。`{it}`，这意味着闭包将返回给它的内容，因此 Groovy 会将*Groovy Truth*应用于 grep 调用的参数。结果与 findAll 相同。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-05-30T13:04:27.453

其实两者还是有细微差别的。至少在将这些方法与地图一起使用时。

`grep`返回一个`ArrayList`，当`findAll`返回一个`Map`。

下面是一个例子：

```
def l_map = [a:1, b:2, c:3]

def map_grep = l_map.grep { it.key == 'a' || it.value == 2}
def map_findAll = l_map.findAll { it.key == 'a' || it.value == 2}

println map_grep
println map_findAll

assert l_map instanceof Map
assert map_grep instanceof ArrayList
assert map_findAll instanceof Map 
```

# php - Facebook 的 PHP sdk 停止为我工作

> ID：10703708
> 
> 赞同：0
> 
> 时间：2012-05-22T14:06:03.600
> 
> 标签：php, facebook, api, sdk

从昨天开始，我停止使用 facebook php sdk。我的代码只是停止工作。尝试了我能找到的所有代码片段，甚至尝试了曾经有用的[http://net.tutsplus.com](http://net.tutsplus.com)教程。我试图改变秘密，甚至创建一个新的应用程序，但仍然没有。

我收到权限请求，权限列在我的帐户中。如果其他用户尝试使用该应用程序，它也不起作用。

使用 js sdk 我可以看到 /me （名称等）使用 php sdk 我看不到。

有没有人有同样的问题？

[更新] 尝试使用 horuko 并且相同的文件在那里可以正常工作，所以问题必须来自 php 主机。我尝试了 2 台不同的服务器（运行 kloxo 的 centos vps），但都没有成功。其中一个昨天工作过

[更新 2/FIX] 问题是旧 cookie 和浏览器缓存的混合。该应用程序从未在我的主机上正常运行，仅在本地主机上运行。缓存不知何故使它看起来像是在服务器上工作。

问题是 curl_exec() 没有运行（即使它已启用）并且我的设置禁用了警告报告。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T17:14:54.773

我的 Facebook 的 PHP SDK 仍在工作，我遵循了最近的教程的指导方针，[http ://thinkdiff.net/facebook/php-sdk-3-0-graph-api-base-facebook-connect-tutorial /](http://thinkdiff.net/facebook/php-sdk-3-0-graph-api-base-facebook-connect-tutorial/)

也许这会有所帮助。

# sql - MS Sql Server 2005 中的计数/选择查询

> ID：10703711
> 
> 赞同：0
> 
> 时间：2012-05-22T14:06:13.890
> 
> 标签：sql, sql-server, sql-server-2005

我有一个旧表，其中包含“主”记录和相关的详细记录。详细记录由“-nnn”主密钥的添加标识。我需要找到没有明细记录的主记录，尝试了几种变体，最后将其分解为最简单的元素。

这有效：

```
select (select count(*) from dbo.client as cl2 
    where cl2.acct_no like (cl1.acct_no + '-%')) as countx, acct_no 
from dbo.client as cl1 
```

并显示预期的零或非零结果，具体取决于有多少详细记录。

但是，当我尝试使用计数结果仅选择具有零详细记录的记录时，如下所示：

```
select (select count(*) from dbo.client as cl2 
    where cl2.acct_no like (cl1.acct_no + '-%')) as countx, acct_no 
from dbo.client as cl1 
where countx = 0 
```

我收到一个错误：“列名 'countx' 无效”

我在这里想念什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:09:20.417

CountX 不是命名列。

这可能不是最佳方式，但包装整个查询可能会起作用。

```
SELECT CountX, Acct_No
FROM
(
    select (select count(*) from dbo.client as cl2 
        where cl2.acct_no like (cl1.acct_no + '-%')) as countx, acct_no 
    from dbo.client as cli
) As InnerQuery
where countx = 0 
```

*编辑*

看这个，使用Join而不是嵌套的Select可能会更好。

```
SELECT     cl1.acct_no, Count(*)
FROM       dbo.client cl1 --the master key numbers
INNER JOIN dbo.client cl2 --the sub-keys
           ON cl1.acct_no NOT LIKE '%-%' --No dashes in the MasterKey
           AND cl1.acct_no LIKE (cl2.acct_no + '-%')
GROUP BY   cl1.acct_no 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T14:15:10.610

尝试使用`in`得到你想要的

```
 select Acct_No from dbo.client where Acct_No not in 
  (
    select acct_no from dbo.client where acct_no like acct_no + '-%'
  ) 
```

# android - Android在通话过程中播放声音

> ID：10703712
> 
> 赞同：3
> 
> 时间：2012-05-22T14:06:20.247
> 
> 标签：android, audio, media-player, call

当有人接到电话时，我想从安卓手机播放音乐。我可以播放音乐，但对方听不到音乐。我怎样才能让对方听音乐（应该是什么编码，以便可以将音乐播放插入麦克风让对方听到）？

关于此功能，我收到了不同的建议。[在这里检查是可能的](http://forums.whirlpool.net.au/archive/1637137)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-31T14:09:04.573

如果您仍然好奇，您无法玩到另一边的原因是Android的硬件通常不会将实际的GSM调用流与可用于修改它的软件堆栈的任何部分互连；它的作用是在将实际通话数据（麦克风/扬声器）发送到线路后将其镜像到软件（允许进行一些控制，例如设置麦克风静音、发送 DTMF 和挂断电话）。

准确的声音路由是在手机芯片中完成的，因此无法控制；更具体地说，蓝牙音频流在芯片中被解码和镜像（这种技术被称为直接音频接口的 DAIBT），这有效地降低了延迟和功率效率。

* * *

一些供应商（目前已知：高通）正在提供特定于供应商的方式来将音频注入某些芯片组（MSM8960、APQ8064）上的 GSM 呼叫上行链路 - 请参阅此答案：[https](https://stackoverflow.com/a/15205455/438039) ://stackoverflow.com/a/15205455/438039 ；

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-30T09:55:56.577

我正在使用 HTC 设备，无法在此设备中实现上述功能。此设置因制造商而异。我的代码可能会在其他一些制造商的手机中向听众播放声音。

# ruby-on-rails-3 - 每个 rake 任务似乎都在运行某种测试，我该如何停止它？

> ID：10703717
> 
> 赞同：3
> 
> 时间：2012-05-22T14:06:46.797
> 
> 标签：ruby-on-rails-3, rake, minitest

自从我创建了这个 Rails 3.2.3 项目以使用 MiniTest 以来，我一直在 rake 命令行收到这些消息：

```
Loaded Suite test/factories,test/helpers,test,test/models,test/requests

Started at 2012-05-22 10:04:01 -0400 w/ seed 45382.

Finished in 0.000229 seconds.

0 tests, 0 passed, 0 failures, 0 errors, 0 skips, 0 assertions 
```

这本身就很奇怪，因为我定义了几个测试并且它们运行良好。上面的信息是多余的，而且令人困惑。我怎样才能摆脱它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T08:19:47.620

有些东西正在测试/单元中加载自动运行文件。加载该文件后，将设置一个退出处理程序，该处理程序将打印出在进程结束时已运行的测试数量。

要修复它，您需要确定是哪个 gem 导致自动运行文件被加载，并停止在 Gemfile 中自动要求它。

就我而言，“罪魁祸首”是nutrasuite。为了修复它，我编辑了 Gemfile，以便像这样添加 nutrasuite：

```
gem "nutrasuite", :require => false 
```

您需要确保在您的 test_helper.rb 文件中需要哪个库导致它，但这确实是它应该设置的方式。

您可以通过反复试验确定导致问题的原因。希望有帮助...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-20T02:02:09.027

您也可以将其移动到自己的组中。

```
group :test do
  gem 'nutrasuite'
end 
```

就我而言，这是因为我从 gemfile 加载了 minitest。

# asp.net - 混合 ASP.NET WebForms 和 MVC 授权

> ID：10703719
> 
> 赞同：2
> 
> 时间：2012-05-22T14:07:00.933
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, authorization, webforms

我正在尝试将一些 MVC3 功能混合到现有的 WebForms 应用程序中。我已经遵循了一些指南，并且除了授权部分之外的所有内容都已设置并正常工作。现有应用程序`<deny users="*" />`位于根 web.config，每个子文件夹都有自己的 web.config，允许访问特定角色中的页面。

我的新理解是这种风格不能/不应该在控制器上使用，我应该使用`Authorize`属性来代替。我已经用 装饰了我的测试“ `HomeController`”类`[Authorize(Roles="AdminRole")]`，但是当我尝试查看该页面时，我得到了一个“拒绝访问”页面。

如果我将根 web.config 更改为`<allow users="*" />`，则该页面有效。这是否意味着我添加到控制器的属性正在工作，但根 web.config 设置优先于它？我不想弄乱我们现有的授权内容，因为该网站已经建立良好，我只是想添加 MVC 来玩。我错过了什么吗？感谢您提供的任何见解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T15:10:04.917

啊，这有点棘手，因为您正在尝试在已经使用 Web 窗体的应用程序中使用 MVC 安全性。如果这是纯 mvc，则选择很简单。如果您不能将 mvc 功能提取到一个单独的应用程序中，那么这会让您有点麻烦。

我的第一个建议是尝试提取代码。如果您使用 MVC 仅提供安静的功能，也可以查看 MVC4 web api 为您的应用程序提供 api 并共享它们之间使用的组件，这需要将它们从您的 web 应用程序中拉出到域库或其他一些适当命名的组件中图书馆。

话虽如此，并不是 100% 确定 allow users="*" 是否按预期工作，但我相信确实如此。它很容易测试，只需将 Roles="AdminRole" 更改为 Roles="placeholder" 并重试。

设置它虽然会杀死你的其余身份验证，所以一个想法可能是将所有 mvc 路由放在特定的 url 下，例如“/api/”并允许 web.config 中的 * 到该路径，然后在所有路径上使用 mvc 的安全性你的控制器方法。这对您的主要网络应用程序的影响很小。

# php - 如何按名称删除会话

> ID：10703721
> 
> 赞同：3
> 
> 时间：2012-05-22T14:07:06.607
> 
> 标签：php

如何按我的名称示例删除 php 会话，`session['sec']`我`session['page']`需要删除`session['page']`而不删除`session['sec']`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-22T14:12:49.143

```
// for a single variable
unset($_SESSION['session_var']); 

// destroy the Session, not just the data stored!
session_destroy();

// delete the session contents, but keep the session_id and name:
session_unset(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T14:08:13.230

在这种情况下，您不会删除会话，只会删除会话变量。所以就这样做：

```
unset($_SESSION['page']); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T14:07:42.650

这应该这样做：

```
unset($_SESSION['page']); 
```

# c++ - 正确使用 exec 命令在 unix 中调用 wget

> ID：10703722
> 
> 赞同：0
> 
> 时间：2012-05-22T14:07:10.020
> 
> 标签：c++, unix, exec, wget

我尝试从 unix 中的 c++ 程序调用 wget。我想在使用 fork 后在子进程中调用它，我需要使用 exec 而不是 system()。我所做的是

```
pid_t pID = fork();
if (pID == 0)
{
   execl("/bin/wget","wget", "http://google.gr",(char*)0);
} 
```

并期望在可执行文件所在的同一文件夹中有一个 html 文件，但这不会发生，我应该如何正确执行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:22:20.997

首先，不要使用`/bin/wget`--`wget`不会总是安装在`/bin`; 仅在第一个参数中单独传递`wget`将导致 PATH 被搜索。

其次，你不应该假设它`execl`不会返回。相反，您应该调用`perror()`以在错误之后正确记录错误（然后在您的代码中以非零状态退出）。

您还可以使用`strace -f`父进程查看正在发生的事情并查找 exec，但是在任何情况下，向您的代码添加错误处理都是正确的。

# c# - 一种 API，允许网站向其查看者提供到某个位置的方向

> ID：10703723
> 
> 赞同：0
> 
> 时间：2012-05-22T14:07:11.460
> 
> 标签：c#, .net, web-services, api, razor

是否有任何服务向您公开 API，允许您在网站上显示往返某个位置的路线？

我已经搜索了一段时间，但只找到了我认为相关的结果，这让我找到了 S/O。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T14:15:23.187

查看谷歌地图 API。它们有许多可通过 JavaScript 或 Web 服务使用的功能。

[谷歌地图方向网络服务 API](https://developers.google.com/maps/documentation/directions/)

[谷歌地图路线 JavaScript API v3](https://developers.google.com/maps/documentation/javascript/directions)

我偏爱 Google Maps，但也有[MapQuest API](http://developer.mapquest.com/web/products/dev-services/directions-ws)。正如下面有人指出的那样，Bing 也有 API。我无法立即在 Yahoo上找到*路线API。*

# javascript - 如何替换不由另一个字符引导的字符

> ID：10703727
> 
> 赞同：0
> 
> 时间：2012-05-22T14:07:18.013
> 
> 标签：javascript, regex

我正在寻找一个 JavaScript 正则表达式，它将替换`i`in`sin(i/20*i)`但不是`i`in `sin`。在这种情况下，使用`(\W)i`总会给我。`(i`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T14:09:57.583

你可以更换

```
\bi\b 
```

这将需要`i`独立（或至少不在字母数字字符和下划线的字符串中）。这`\b`是一个零宽度断言，因为它匹配*characters 之间的位置*，因此您不会捕获超出您需要的内容。

通常的注意事项适用。只有一个例子，很难给出一个适用于你想扔的任何数据的好的解决方案。相应地适应。

# asp.net - asp.net 放大和缩小按钮显示

> ID：10703734
> 
> 赞同：1
> 
> 时间：2012-05-22T14:07:53.057
> 
> 标签：asp.net, button, zooming

我设计了一个asp.net图表，只是我想在图表的右上角显示一个放大和缩小按钮，让用户可以执行缩放图表。

请任何人建议，我必须放置什么样的按钮显示，以及 zoom-in.click 和 Zoom-out.click 方法如何？

提前致谢！

# iphone - 使用 UIToolbar 共享功能娱乐

> ID：10703736
> 
> 赞同：0
> 
> 时间：2012-05-22T14:07:56.327
> 
> 标签：iphone, objective-c, ios, uiview, uitoolbar

我目前正在尝试重新创建在AppStore的[Hacker News中看到的共享功能。](http://itunes.apple.com/us/app/hacker-news/id514166419?ls=1&mt=8)

屏幕截图[在这里](https://www.dropbox.com/s/khwxizvhjl8rs4v/2012-05-22%2015.51.51.png)和[这里](https://www.dropbox.com/s/s9w1nhts4y56z4h/2012-05-22%2015.51.53.png)。

我知道他们使用 UIToolbar，当用户点击 Share-Button 时，他们会以某种方式向上移动视图并在 UIToolbar 下显示另一个视图。但我不知道，他们如何：

1.  向上移动视图
2.  然后显示另一个视图。

您对我有任何指示或代码示例吗？将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:16:46.970

查看 UIView 动画。只需在可见屏幕下方添加共享视图，然后创建一个动画，将您的新视图和它上方的视图向上滑动到位。SO上有大量用于查看动画的示例代码。

# unix - UNIX AIX 提示 - 以彩色显示文件

> ID：10703738
> 
> 赞同：0
> 
> 时间：2012-05-22T14:08:00.977
> 
> 标签：unix, aix, prompt

我想在我的 unix aix 提示符中以亮绿色显示所有文件。谁能帮我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T15:55:57.807

如果您在 AIX 上并且 ls --color 不起作用，您可以尝试从 IBM 的站点安装 coreutils ...

[ftp://public.dhe.ibm.com/aix/freeSoftware/aixtoolbox/RPMS/ppc/](ftp://public.dhe.ibm.com/aix/freeSoftware/aixtoolbox/RPMS/ppc/)

它将更新 ls 以包含颜色。请注意，如果您没有 su 权限，您也可以将 coreutils ls 文件的副本放在您的 home/bin 目录中。并修改您的 PATH 变量以在 /bin:/usr/bin:/usr/local/bin 之前检查 home/bin...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T14:50:45.283

查看手册页`ls`及其`--color`选项。它可能会做你正在寻找的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-28T19:18:47.310

我为 AIX 制作了一个适用于大多数情况的包装器。您应该能够将 ls 别名为 aix-ls：

看：

[https://gist.github.com/earonesty/e04e94bbb139f6d645c6](https://gist.github.com/earonesty/e04e94bbb139f6d645c6)

# javascript - 如何用 BASH 替换 HTML

> ID：10703744
> 
> 赞同：0
> 
> 时间：2012-05-22T14:08:26.500
> 
> 标签：javascript, html, colors

我想在我的服务器上运行一个 bash 脚本，并在网页上显示输出。该脚本是通过 php 启动的，并且正在运行。- 但我想为特定的关键字着色。怎么做最好？

**可能的解决方案：**

我可以找到关键字（警告）的开头`string.search("warning");`（我不知道如何找到结尾）。- 并用 . 挑选关键字`string.substring(from, to)`。然后使用`string.fontcolor("red")`给它上色，并`document.write(colorstring);`显示它。

**编辑：**

**我认为我的问题没有明确表述，所以我再试一次：**

php 运行 bash 脚本，返回文本，例如

```
"This is some text that bash returns" 
```

我如何最好地将文本转换为

```
"This is <span class='keyword'>some</span> text that bash returns" 
```

所以我可以将彩色样式应用于关键字（“some”）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T15:19:22.250

If all you want to do is wrap, and then style, specific strings within a given string:

```
var str = "This is some text that bash returns",
    styledString = str.replace(/some/gi,'<span class="keyword">some</span>'); 
```

[JS Fiddle proof-of-concept](http://jsfiddle.net/eVaGN/).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T14:56:06.197

你最好的选择是使用`<span>`CSS 类，而不是内联样式。样式和数据的分离对于可维护的站点很重要。

```
<span class='keyword'>warning</span> 
```

CSS：

```
.keyword {
   font-color:#ff0000;
   font-weight:bold;
} 
```

# c++ - Microsoft HPC Pack 2008 SDK 的链接器错误

> ID：10703748
> 
> 赞同：1
> 
> 时间：2012-05-22T14:08:36.440
> 
> 标签：c++, visual-studio-2010, mpi

我尝试在 Windows 7 x64 中使用 OpenMP 和 MPI 编写程序。我找到了教程，如何在 VS2010 中安装 MPI

> [http://msdn.microsoft.com/en-gb/library/ee441265.aspx#BKMK_debug1](http://msdn.microsoft.com/en-gb/library/ee441265.aspx#BKMK_debug1)

但是，当我尝试编译解决方案时，出现链接器错误：

```
1>main.obj : error LNK2019: unresolved external symbol _MPI_Finalize@0 referenced in function _main
1>main.obj : error LNK2019: unresolved external symbol _MPI_Barrier@4 referenced in function _main
1>main.obj : error LNK2019: unresolved external symbol _MPI_Recv@28 referenced in function _main
1>main.obj : error LNK2019: unresolved external symbol _MPI_Ssend@24 referenced in function _main
1>main.obj : error LNK2019: unresolved external symbol _MPI_Comm_size@8 referenced in function _main
1>main.obj : error LNK2019: unresolved external symbol _MPI_Comm_rank@8 referenced in function _main
1>main.obj : error LNK2019: unresolved external symbol _MPI_Init@8 referenced in function _main 
```

可能我必须安装其他东西吗？可能是 HPC Pack 2008 R2 Service Pack 2？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:19:47.693

请务必查看您提供的链接中“在 Visual Studio 2010 中创建 C++ MPI 示例项目”部分下的第 3 步（“为项目指定其他属性”）

该错误通知您链接器找不到包含各种*MPI* * 函数定义的库。链接器设置（库目录（3c）和链接器->输入（3d））是为链接器指定使用哪些库以及在哪里找到它们的设置

# sql-server - 跳过/忽略插入时的重复行

> ID：10703752
> 
> 赞同：29
> 
> 时间：2012-05-22T14:08:47.163
> 
> 标签：sql-server, sql-server-2008, tsql, stored-procedures

我有以下表格：

`DataValue`

```
DateStamp    ItemId   Value
----------   ------   -----
2012-05-22   1        6541
2012-05-22   2        12321
2012-05-21   3        32 
```

`tmp_holding_DataValue`

```
DateStamp    ItemId   Value
----------   ------   -----
2012-05-22   1        6541
2012-05-22   4        87
2012-05-21   5        234 
```

`DateStamp`并且`ItemId`是主键列。

我正在做一个全天定期运行的插入（在存储过程中）：

```
insert into DataValue(DateStamp, ItemId, Value)
select DateStamp, ItemId, Value from tmp_holding_DataValue; 
```

这会将数据从保留表 ( `tmp_holding_DataValue`) 移动到主数据表 ( `DataValue`) 中。然后将保留表截断。

问题在于，与示例中一样，holding table 可能包含主表中已经存在的项目。由于该键不允许重复值，因此该过程将失败。

一种选择是在插入过程中放置​​一个 where 子句，但主数据表有 1000 万多行，这可能需要很长时间。

有没有其他方法可以让程序在尝试插入时跳过/忽略重复项？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-05-22T14:10:57.300

```
INSERT dbo.DataValue(DateStamp, ItemId, Value)
SELECT DateStamp, ItemId, Value 
FROM dbo.tmp_holding_DataValue AS t
WHERE NOT EXISTS (SELECT 1 FROM dbo.DataValue AS d
WHERE DateStamp = t.DateStamp
AND ItemId = t.ItemId); 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-05-22T14:39:38.820

您可以将 PK 分配为 Ignore Duplicate Key = Yes。然后它只会给出一个警告重复键被忽略并继续。我不是在猜测。我对此进行了测试。

我发现我不能这样做的是 SMSS。必须通过脚本删除并重新创建索引。但是您可以右键单击索引，选择 drop and recreate，然后只需更改 Ignore Duplicate Key = Yes。对我来说，SMSS 并没有立即显示出变化。

```
IF  EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[PKallowDup]') AND name = N'PK_PKallowDup')
ALTER TABLE [dbo].[PKallowDup] DROP CONSTRAINT [PK_PKallowDup]
GO

USE [test]
GO

/****** Object:  Index [PK_PKallowDup]    Script Date: 05/22/2012 10:23:13 ******/
ALTER TABLE [dbo].[PKallowDup] ADD  CONSTRAINT [PK_PKallowDup] PRIMARY KEY CLUSTERED 
(
    [PK] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, SORT_IN_TEMPDB = ON, IGNORE_DUP_KEY = ON, ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
GO 
```

或者我认为您可以使用外部联接

```
INSERT dbo.DataValue(DateStamp, ItemId, Value)
SELECT t.DateStamp, t.ItemId, t.Value 
  FROM dbo.tmp_holding_DataValue AS t 
  left join dbo.DataValue AS d
    on d.DateStamp = t.DateStamp
   AND d.ItemId = t.ItemId
 WHERE d.DateStamp is null 
   and d.ItemId    in null 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2012-05-22T14:12:47.723

在`SQL Server 2008+`：

```
MERGE
INTO    dataValue dv
USING   tmp_holding_DataValue t
ON      t.dateStamp = dv.dateStamp
        AND t.itemId = dv.itemId
WHEN NOT MATCHED THEN
INSERT  (dateStamp, itemId, value)
VALUES  (dateStamp, itemId, value)
/*
WHEN MATCHED THEN
UPDATE SET
        value = t.value
*/
-- Uncomment above to rewrite duplicates rather than ignore them 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-10-31T19:42:09.967

我遇到了一个类似的要求，最终引发了相同的重复键错误，然后我的想法是选择多个不同的列（主），同时返回其他列，[检查](https://stackoverflow.com/a/17320732/2093880)：

```
INSERT INTO DataValue(DateStamp, ItemId, Value)
SELECT DISTINCT DateStamp, ItemId, MAX(Value) AS Value
FROM tmp_holding_DataValue
GROUP BY DateStamp, ItemId 
```

事实上，目标也可以在没有 Distinct 的情况下实现，因为聚合函数 MAX 将选择单个值。

# javascript - 在按钮之间切换 - 无法显示图像

> ID：10703756
> 
> 赞同：1
> 
> 时间：2012-05-22T14:09:08.600
> 
> 标签：javascript, jquery, css, html

我希望按钮的图像背景在用户单击它时发生变化。我制作了一个包含不同属性的类，以根据它们的类在图像之间切换。我使用这种方法：

HTML：

```
 <span id="play"></span> 
```

JS：

```
 $(document).ready(function(){
    $('#play').click(function(){

    $(this).toggleClass("#pause");
    });
    }); 
```

CSS：

```
 #play
    {
   width:100px;
   height:60px;
   background-image: url('18.jpg');
   float:left;
    }
   #pause
   {
  width:100px;
  height:60px;
  background-image: url('19.jpg');
  float:left;
   } 
```

但是在我点击按钮之前和之后都没有显示图像，你知道为什么吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T14:11:41.647

`#`用于表示一个，`id`但您正在切换一个类。尝试这个：

```
$('#play').click(function(){
    $(this).toggleClass("pause");
}); 
```

```
.pause {
    width:100px;
    height:60px;
    background-image: url('19.jpg');
    float:left;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-22T14:12:40.570

问题是`#pause`不是css类的名称而是id。

你应该有这样的东西

HTML：

```
 <span id="play" class="play"></span> 
```

JS：

```
 $(document).ready(function(){
        $('#play').click(function(){                             
            $(this).toggleClass("pause");
            $(this).toggleClass("play");
        });
    }); 
```

CSS：

```
.play
{
    width:100px;
    height:60px;
    background-image: url('18.jpg');
    float:left;
}
.pause
{
    width:100px;
    height:60px;
    background-image: url('19.jpg');
    float:left;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-22T14:11:58.190

该函数的名称是toggleClass。切换一个类，您正在使用 ID。

HTML

```
 <span class="play"></span> 
```

JS

```
$(document).ready(function(){
    $('.play').click(function(){

        $(this).toggleClass("pause"); //lose the #
    });
}); 
```

CSS

```
.play {
   width:100px;
   height:60px;
   background-image: url('18.jpg');
   float:left;
 }

 .pause {
    width:100px;
    height:60px;
    background-image: url('19.jpg');
    float:left;
 } 
```

# asp.net-mvc-3 - 部署 MVC3 应用程序

> ID：10703765
> 
> 赞同：1
> 
> 时间：2012-05-22T14:09:33.173
> 
> 标签：asp.net-mvc-3, iis-7, .net-4.0

我正在使用 VS2010 并将我的 MVC3 应用程序部署到我的网络服务器。我去了项目->发布设置并添加了我的数据库连接，就是这样。我右键单击我的应用程序并单击生成一个 zip 文件的“构建部署包”。我将它复制到我的服务器并将应用程序导入 IIS，没有任何错误。但是当我尝试在浏览器中加载它时，我感到很害怕：

无法加载文件或程序集 'System.Web.Helpers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' 或其依赖项之一

我从 web.config 中取出该行，然后我得到：

无法加载文件或程序集“System.Web.WebPages，Version=1.0.0.0，Culture=neutral，PublicKeyToken=31bf3856ad364e35”或其依赖项之一

我从 web.config 中取出该行，然后我得到：

无法加载文件或程序集“Microsoft.Web.Infrastructure，Version=1.0.0.0，Culture=neutral，PublicKeyToken=31bf3856ad364e35”或其依赖项之一

我需要继续吗？当我部署或构建我的应用程序以将其加载到 IIS 中以便所有依赖项都可用时，我做错了什么？

.NET 4.0 是 IIS 中的默认应用程序池。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T14:11:56.943

不要将这些行从 Web.config 中删除。

相反，将引用设置为`Copy Local`并重新部署。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T14:15:19.940

您可以通过右键单击项目并选择“添加可部署依赖项”来添加可部署依赖项。

[http://msdn.microsoft.com/en-us/library/gg286946.aspx](http://msdn.microsoft.com/en-us/library/gg286946.aspx)

请注意，它需要 Visual Studio 2010 Service Pack 1 或更高版本的 Visual Studio。

# backbone.js - 通过 fetch 刷新事件后未触发主干事件

> ID：10703768
> 
> 赞同：3
> 
> 时间：2012-05-22T14:09:42.767
> 
> 标签：backbone.js, marionette

我正在使用backbone.marionette 并具有以下CollectionView ItemView 组合：

```
 PlansListItemView = PlansApp.ItemView.extend
    tagName: "tbody"
    template: "#plansRow"    
    events:
      'click th.expander': 'expandDocuments'

    expandDocuments: (e) =>
      # do stuff

  PlansCollectionView = PlansApp.CollectionView.extend
    tagName: "table"
    itemView: PlansListItemView 
```

我从嵌入在页面上的初始 json 集合创建视图。事件哈希中的事件完美运行。

然后在下拉更改事件中，我在集合上调用 fetch() 以检索新的对象集合。DOM 被重建，但事件处理程序没有被重新附加/

有谁知道为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T17:04:58.470

虽然我不知道确切的原因，但您的设置中有一些有趣的东西让我认为这可能是问题的一部分。

**注意**：根据您发布的内容，我对您的代码和模板做出了一些巨大的假设。任何数量的事情都可能发生，这会使我所说的大部分内容无效。不过，鉴于您发布的内容，这是我对如何组织此代码的想法，这可能有助于清理您看到的问题。

### 错误的 HTML 输出？

您将每个项目视图设置为一个`<tbody>`标签，但看起来您有一些`<th>`由该视图呈现的标签 - 至少基于您配置的事件。

这将产生无效的 HTML，例如：

```
<table>
  <tbody>
    <th></th>
  </tbody>
</table> 
```

没有看到模板就很难说`#plansRow`，但我猜想这会产生类似的结果。

问题是集合视图不擅长生成表格。他们可以很好地在表格中生成行，以及表格标签包装器，但他们将无法获得良好的表格结构所需的表格标题、页脚、正文或其他标签，因为集合视图不呈现模板他们自己的。他们只是创建一个包装标签，然后渲染集合中的每个孩子。

要更正此问题，请使用 CompositeView，它是一个也呈现自己的模板的 CollectionView。

### 具有复合视图的更好的表结构

使用 Marionette 构建表格的更合适的设置是使用 CompositeView 作为父级，并让每个项目视图呈现一个`tr`标签。例如：

```
 RowView = Backbone.Marionette.ItemView.extend({
  template: "#row-template",
  tagName: "tr"
});

TableView = Backbone.Marionette.CompositeView.extend({
  template: "#table-template",
  tagName: "table",

  appendHtml: function(cv, iv){
    cv.$("tbody").append(iv.el);
  }
}); 
```

这将建立一个`<table>`与复合视图。然后，该视图的模板将包含适当的`<thead><th>...</th></thead><tbody></tbody>`标签来定义表格。

行视图呈现为`<tr>`标签，并填充它需要的任何数据，包括适当的`<td>`标签。

复合视图上的`appendHtml`方法处理将每个项目视图插入到`<tbody>`父复合视图的标记中。

你可以在这个 JSFiddle 中看到它的实时版本：http: [//jsfiddle.net/derickbailey/me4NK/](http://jsfiddle.net/derickbailey/me4NK/)

以及一篇介绍 CompositeView 的此用途和其他用途的博客文章，请点击此处： http: [//lostechies.com/derickbailey/2012/04/05/composite-views-tree-structures-tables-and-more/](http://lostechies.com/derickbailey/2012/04/05/composite-views-tree-structures-tables-and-more/)

# java - 排序列表

> ID：10703769
> 
> 赞同：1
> 
> 时间：2012-05-22T14:09:43.560
> 
> 标签：java, collections

> **可能重复：**
> [对对象集合进行排序](https://stackoverflow.com/questions/1206073/sorting-a-collection-of-objects)

如何在java中对列表进行排序

```
List<Integer> list = new ArrayList<Integer>();
list.add(13);
list.add(8);
list.add(6);
list.add(4);
list.add(3); 
```

我想对列表进行排序。请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:11:40.893

您可以使用 Collections.sort(list)，但请注意，您的列表必须由实现[Comparable](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Comparable.html)的对象组成才能使用它！ [http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Collections.html](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Collections.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T14:11:52.083

这个[链接](http://www.exampledepot.com/egs/java.util/coll_sortlist.html)应该有帮助。这是字符串列表的示例，但它也应该适用于整数。必须说，我自己没有尝试过。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T14:15:27.990

只需使用：

```
 Collections.sort(list); 
```

如果你想以相反的顺序排序，你必须实现 Comparator 接口

```
public class MyIntComparable implements Comparator<Integer>{

    @Override
    public int compare(Integer o1, Integer o2) {
        return (o1>o2 ? -1 : (o1==o2 ? 0 : 1));
    }
} 
```

并在您的代码中使用：

```
Collections.sort(list, new MyIntComparable()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T14:12:08.130

```
List<Integer> list = new ArrayList<Integer>();
list.add(13);
list.add(8);
list.add(6);
list.add(4);
list.add(3);
Collections.sort(list); 
```

# java - 登录 Web 应用程序

> ID：10703780
> 
> 赞同：0
> 
> 时间：2012-05-22T14:10:07.863
> 
> 标签：java, log4j, stack-trace

(a)如何为每个应用程序实现一个 Logger 实例，而不是每个 Class 一个 Logger 实例。(b) 我们可以自定义堆栈跟踪以仅打印错误发生的行号及其 java 类名。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:13:48.130

通常，您会为每个类设置记录器，因为这是一个很好的逻辑组件。线程已经是日志消息的一部分（如果您的过滤器显示它们），因此以这种方式切片记录器可能是多余的。

关于基于应用程序或层的记录器，问题是您必须找到一个放置该 Logger 对象的位置。没什么大不了的。更大的问题是某些类可能会在多个应用程序的多个级别上使用......可能很难让您的记录器正确。或者至少很棘手。

...您最不想要的就是日志记录设置中的错误假设。

如果您关心应用程序和层并且有简单的分离点，那么 NDC 就是您的最佳选择。代码有时可能有点过分，但我不知道有多少次我被准确的上下文堆栈保存，显示 Foo.bar() 是从 Y 层的应用程序 X 调用的。

最常用的策略是为每个类创建一个记录器。如果您创建新线程，请给它们一个有用的名称，以便它们的日志记录很容易区分。

为每个类创建记录器的好处是能够在类的包结构中打开/关闭日志记录：

```
log4j.logger.org.apache = INFO
log4j.logger.com.example = DEBUG
log4j.logger.com.example.verbose = ERROR 
```

以上会将所有 apache 库代码设置为`INFO`级别，将日志记录从您自己的代码切换到`DEBUG`级别，但详细包除外。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T14:15:45.273

(a) 为 getLogger() 的所有调用定义相同的类别：

```
// Create a logger per class:    
static Logger log = Logger.getLogger(MyClass.class);

// Use the same logger for the whole application:
// use this line in all your classes:
static Logger log = Logger.getLogger("YourLogCategory"); 
```

HTH。

# jquery - 使用 Jquery mobile 创建移动网站

> ID：10703781
> 
> 赞同：0
> 
> 时间：2012-05-22T14:10:08.373
> 
> 标签：jquery

我开始使用 Jquery mobile 在移动设备中创建我的网站版本。到目前为止它很棒，但我昨天刚刚遇到了一些事情，无法弄清楚。我正在提取很多我已经编写的代码，但它们都使用 jQuery，前面带有 $，而 JQuery mobile 在调用前面使用 jQuery。有没有办法同时使用两者。我一直在玩弄 $.noConflict() 但无济于事。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T14:14:44.563

您可以使用[Modernizr](http://www.modernizr.com/)并通过 Modernizr 的新媒体查询测试检查屏幕大小。这使您可以保留一个页面并将其提供给各种屏幕尺寸，而不会牺牲移动/平板电脑/或台式机的质量。

```
if (Modernizr.mq('only screen and (max-width: 480px)')) {  
    Modernizr.load('/mobile.js');  
} else if (Modernizr.mq('only screen and (max-width: 768px)')) {  
    Modernizr.load('/tablet.js');  
} else {  
    Modernizr.load('/desktop.js');  
} 
```

# java - 手动将 Eclipse 库移动到 NetBeans

> ID：10703782
> 
> 赞同：0
> 
> 时间：2012-05-22T14:10:08.723
> 
> 标签：java, eclipse, netbeans

我希望将我的一些库从当前在 Eclipse 中的 Java Web 应用程序移动到新的 NetBeans 项目

我无法使用源代码导入工具，因为我继承的原始 Eclipse 项目设置不正确，因此需要手动完成。

在 Eclipse 中，我的库（例如“axis-ant.jar”和“googleapi.jar”）存储在“Web-INF > lib”中

我可以将它们复制到 NetBeans 的 Library 文件夹中吗？他们应该在一个特定的子文件夹中吗？

目前我的 NetBeans 库文件夹中有一个 JDK 1.6 文件夹和 Apache Tomcat。

一如既往地提供任何帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T10:16:29.393

只是这样的情况是可用的。我继承了一个不是在 IDE 中构建的项目。虽然可以手动完成相同的工作，但最好有标准的文件夹结构。由于缺少文件，我也无法在 NetBeans 或 Eclipse 中重建它。

我的工作是查找 WebApp 的正确文件夹结构，尤其是 WEB-INF 并尝试重新创建它。对于面临相同问题的任何人，您必须手动执行此操作。Eclipse 或 NetBeans 项目导入工具无法正常工作。

就我而言，我将库导入错误的文件夹中，位置错误。

# android - 创建签名 APK 时出现 Dalvik 错误

> ID：10703787
> 
> 赞同：1
> 
> 时间：2012-05-22T14:10:24.957
> 
> 标签：android, dalvik, apk

尝试将项目导出到已签名的 APK。收到以下错误。我相信我的 libs 文件夹中的 AdMob jar 文件是问题所在。我的目标是 API 级别 13。

> org.eclipse.core.runtime.CoreException：在 com.android.ide 的 com.android.ide.eclipse.adt.internal.project.ExportHelper.exportReleaseApk(ExportHelper.java:294) 处转换​​为 Dalvik 格式失败，出现错误 1。 eclipse.adt.internal.wizards.export.ExportWizard.doExport(ExportWizard.java:295) 在 com.android.ide.eclipse.adt.internal.wizards.export.ExportWizard.access$0(ExportWizard.java:232) 在 com .android.ide.eclipse.adt.internal.wizards.export.ExportWizard$1.run(ExportWizard.java:217) at org.eclipse.jface.operation.ModalContext$ModalContextThread.run(ModalContext.java:121) 原因： com.android.ide.eclipse.adt.internal.build.DexException：转换为 Dalvik 格式失败，在 com.android.ide.eclipse.adt.internal.build.BuildHelper.executeDx(BuildHelper.java:713) 处出现错误 1 com.android.ide.eclipse.adt。internal.project.ExportHelper.exportReleaseApk(ExportHelper.java:251) ... 还有 4 个

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T23:21:26.323

好吧，我从项目的“libs”文件夹中删除了 Admob jar，“清理”了项目，关闭了 Eclipse，将 AdMob jar 文件重新复制回项目的“libs”文件夹，再次清理，我能够创建 APK 文件。

我认为这相当于 Eclipse 拍打你的旧电视机以获得更好的接收效果......无论如何，希望这对某人有所帮助。

# javascript - 如何在 JQUERY 中获取数据过滤器文本框的值

> ID：10703789
> 
> 赞同：1
> 
> 时间：2012-05-22T14:10:52.817
> 
> 标签：javascript, jquery, html-lists

我试图在同一个应用程序中实现多个数据过滤器，但如果选择了输入按钮，我还希望能够获取搜索框的值。我知道我可以使用获取输入搜索字段的值，`$("input[data-type='search']").val()`但是有没有办法附加一个 id，以便我可以确保我要求的是正确的值。

以下是我使用数据过滤器的页面之一：

```
 <div data-role="page" data-theme="b" id="enterNewName">
  <div data-role="header" data-theme="b">
    <a class="leavePageBtn ui-btn-left" data-role="button" data-icon="arrow-l" data-iconpos="left" data-theme="b">Cancel</a>
    <h1>
      Enter Name
    </h1><a class="EnterNameBtn ui-btn-right" data-role="button" data-icon="arrow-r" data-iconpos="right" data-theme="e">Enter</a>
  </div>
  <div data-role="content">
    <ul data-role="listview" data-inset="true" data-filter="true" id='nameList' data-filter-placeholder="Enter Name...">
    <li>test1</li>
    <li>test2</li>
    <li>test3</li>
    </ul>
  </div>
</div> 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-17T04:52:54.967

这是迄今为止我发现的最好的方法，虽然很笨重，但似乎很有效。我希望有一种方法可以指定一个 id。

```
$('#nameList').prev().find(".ui-input-search .ui-input-text").val(); 
```

# javascript - Javascript for循环在Firefox中无法正常工作

> ID：10703797
> 
> 赞同：0
> 
> 时间：2012-05-22T14:11:04.250
> 
> 标签：javascript, for-loop

我很可能会遗漏一些东西，或者完全做错了，但这段 javascript 在 Chrome 和 Safari 中运行良好，只是在 Firefox 中运行良好。section.id （在 if 语句内部）似乎没有改变，但总是返回 section[0].id ，无论它是否符合 if 语句条件。

```
var localNavigation = {
    showTab: function (anchortags, anchors) {
        $(window).scroll(function () {
            var scroller, i, section, sectionTop, sectionBottom, sectionColor, sectionTextColor, $section;
            for (i = 0; i < anchors.length; i++) {
                scroller = document.body.scrollTop;
                section = anchors[i];
                $section = $(section);
                sectionColor = $section.css("background-color");
                sectionTextColor = $section.css("color");
                sectionTop = section.offsetTop;
                sectionBottom = section.offsetTop + section.offsetHeight;
                if ((scroller > sectionTop) && (scroller < sectionBottom)) {
                    $(anchortags).removeClass("selected").css({
                        "background-color": "transparent",
                        "color": "#f5eeed"
                    });
                    $("#" + section.id + "_tab").addClass("selected").css({
                        "background-color": "" + sectionColor + "",
                        "color": "" + sectionTextColor + ""
                    });
                    console.log(section.id);
                }
            }
        });
    },
    init: function () {
        var anchortags = $("#local ul li a"),
            anchors = $("section");
        localNavigation.showTab(anchortags, anchors);
    }
};
localNavigation.init(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T14:38:09.560

我看到您使用的是 HTML 5`<section>`标记。之前在 StackOverflow 上已经讨论过许多版本的 Firefox 还不支持这个标签，所以您是否尝试过确保您使用的是最新版本的 Firefox？

如果做不到这一点，你能用不同的标签试试你的代码吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T14:36:41.510

仔细检查您是否正在处理正确的文件。

也尝试使用每个循环。

```
anchors.each(function( i, section ){
    var $section = $(section);
    scroller = document.body.scrollTop;
    sectionColor = $section.css("background-color");
    sectionTextColor = $section.css("color");
    sectionTop = $section.offsetTop;
    sectionBottom = $section.offsetTop + $section.offsetHeight;
    if ((scroller > sectionTop) && (scroller < sectionBottom)) {
        console.log($section.id);
    }
}); 
```

# python - 如何在 Haskell 中表达这个 Python for 循环？

> ID：10703800
> 
> 赞同：3
> 
> 时间：2012-05-22T14:11:19.457
> 
> 标签：python, haskell, io, iteration, wget

有时当我想使用 时`wget`，我最终会用 Python 打印一堆行，如下所示：

```
>>> for i in range(25):
...   print "http://www.theoi.com/Text/HomerOdyssey", i, ".html"
... 
http://www.theoi.com/Text/HomerOdyssey 0 .html
http://www.theoi.com/Text/HomerOdyssey 1 .html
http://www.theoi.com/Text/HomerOdyssey 2 .html
http://www.theoi.com/Text/HomerOdyssey 3 .html
http://www.theoi.com/Text/HomerOdyssey 4 .html
http://www.theoi.com/Text/HomerOdyssey 5 .html
http://www.theoi.com/Text/HomerOdyssey 6 .html
http://www.theoi.com/Text/HomerOdyssey 7 .html
http://www.theoi.com/Text/HomerOdyssey 8 .html
http://www.theoi.com/Text/HomerOdyssey 9 .html
http://www.theoi.com/Text/HomerOdyssey 10 .html
http://www.theoi.com/Text/HomerOdyssey 11 .html
http://www.theoi.com/Text/HomerOdyssey 12 .html
http://www.theoi.com/Text/HomerOdyssey 13 .html
http://www.theoi.com/Text/HomerOdyssey 14 .html
http://www.theoi.com/Text/HomerOdyssey 15 .html
http://www.theoi.com/Text/HomerOdyssey 16 .html
http://www.theoi.com/Text/HomerOdyssey 17 .html
http://www.theoi.com/Text/HomerOdyssey 18 .html
http://www.theoi.com/Text/HomerOdyssey 19 .html
http://www.theoi.com/Text/HomerOdyssey 20 .html
http://www.theoi.com/Text/HomerOdyssey 21 .html
http://www.theoi.com/Text/HomerOdyssey 22 .html
http://www.theoi.com/Text/HomerOdyssey 23 .html
http://www.theoi.com/Text/HomerOdyssey 24 .html
>>> 
```

我可以将该输出粘贴到一个新文件中，删除空格，然后使用`wget -i`.

但我厌倦了 Python。

我想学习 Haskell。

尽管花了 10 分钟试图从 开始做同样的事情`ghci`，但我没有进一步前进。

这就是我的尝试的样子：

```
alec@ROOROO:~/oldio$ ghci
GHCi, version 7.0.4: http://www.haskell.org/ghc/  :? for help
Loading package ghc-prim ... linking ... done.
Loading package integer-gmp ... linking ... done.
Loading package base ... linking ... done.
Prelude> putStrLn

<interactive>:1:1:
    No instance for (Show (String -> IO ()))
      arising from a use of `print'
    Possible fix:
      add an instance declaration for (Show (String -> IO ()))
    In a stmt of an interactive GHCi command: print it
Prelude> putStrLn "hey"
hey
Prelude> putStrLn "hey" [1..10]

<interactive>:1:1:
    The function `putStrLn' is applied to two arguments,
    but its type `String -> IO ()' has only one
    In the expression: putStrLn "hey" [1 .. 10]
    In an equation for `it': it = putStrLn "hey" [1 .. 10]
Prelude> putStrLn "hey" snd [1..10]

<interactive>:1:1:
    The function `putStrLn' is applied to three arguments,
    but its type `String -> IO ()' has only one
    In the expression: putStrLn "hey" snd [1 .. 10]
    In an equation for `it': it = putStrLn "hey" snd [1 .. 10]
Prelude> putStrLn "hey" $ snd [1..10]

<interactive>:1:1:
    The first argument of ($) takes one argument,
    but its type `IO ()' has none
    In the expression: putStrLn "hey" $ snd [1 .. 10]
    In an equation for `it': it = putStrLn "hey" $ snd [1 .. 10]
Prelude> "hello"
"hello"
Prelude> "hello" ++ "world"
"helloworld"
Prelude> "hello" ++ [1..10] ++ " world"

<interactive>:1:16:
    No instance for (Num Char)
      arising from the literal `10'
    Possible fix: add an instance declaration for (Num Char)
    In the expression: 10
    In the first argument of `(++)', namely `[1 .. 10]'
    In the second argument of `(++)', namely `[1 .. 10] ++ " world"'
Prelude> "hello" ++ print [1..10] ++ " world"

<interactive>:1:12:
    Couldn't match expected type `[Char]' with actual type `IO ()'
    In the return type of a call of `print'
    In the first argument of `(++)', namely `print [1 .. 10]'
    In the second argument of `(++)', namely
      `print [1 .. 10] ++ " world"'
Prelude> print [1..10]
[1,2,3,4,5,6,7,8,9,10]
Prelude> map ("hello") [1..10]

<interactive>:1:6:
    Couldn't match expected type `a0 -> b0' with actual type `[Char]'
    In the first argument of `map', namely `("hello")'
    In the expression: map ("hello") [1 .. 10]
    In an equation for `it': it = map ("hello") [1 .. 10]
Prelude> greeting :: String --> Int  -> [String, Int]

<interactive>:1:39: parse error on input `,'
Prelude> greeting :: String --> Int  -> [(String), (Int)]

<interactive>:1:41: parse error on input `,'
Prelude> greeting :: String -> Int  -> [(String), (Int)]

<interactive>:1:40: parse error on input `,'
Prelude> greeting :: String -> Int  -> [(String) (Int)]

<interactive>:1:1: Not in scope: `greeting'
Prelude> foreach [1..24] print

<interactive>:1:1: Not in scope: `foreach'
Prelude> import Data.IORef
Prelude Data.IORef> foreach [1..24] print

<interactive>:1:1: Not in scope: `foreach'
Prelude Data.IORef> foreach = flip mapM_

<interactive>:1:9: parse error on input `=' 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-22T14:17:46.820

```
for i in range(25):
...   print "http://www.theoi.com/Text/HomerOdyssey", i, ".html" 
```

变成：

> 导入 Control.Monad

这样我们就可以：

```
 forM_ [1..25] $ \i ->
     putStrLn $ "http://www.theoi.com/Text/HomerOdyssey" ++ show i ++ ".html" 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-22T14:17:07.537

```
mapM_ (\i -> putStrLn (concat ["http://www.theoi.com/Text/HomerOdyssey", show i, ".html"])) [0..24] 
```

作为奖励，这不会打印任何空格。

现在一些理论：

*   `putStrLn`是一个接受*单个*参数的函数。Python、Perl 等会吞下您提供的所有参数`print`并将其转换为单个字符串。在 Haskell 中，你必须自己做。
*   `mapM_`有两个参数。第二个列表，第一个函数`mapM_`依次传递列表的每个元素。我们在这里传递的函数是一个匿名函数（就像 Python 中的 lambda）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-22T22:28:18.910

考虑使用列表推导：

```
mapM_ putStrLn ["http://www.theoi.com/Text/HomerOdyssey" ++ show i ++ ".html" | i <- [0..24]] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-23T12:04:19.367

这不完全是一个答案，但评论太长了。我认为关于 ghci 的几句话会有很大帮助。

在 ghci 中，您可以使用`:t`和`:info`来分别显示某物的类型和有关某物的信息。

```
Prelude> :t putStrLn
putStrLn :: String -> IO ()
Prelude> :info putStrLn
putStrLn :: String -> IO ()     -- Defined in `System.IO'
Prelude> :t putStrLn "Hello, World"
putStrLn "Hello, World" :: IO () 
```

`:t`很有用，因为您可以使用它来显示任意表达式的类型，而这`:info`不会。但`:info`可以提供关于没有类型的事物的信息，例如类型本身或类型构造函数：

```
Prelude> :info IO
newtype IO a
  = GHC.Types.IO (GHC.Prim.State# GHC.Prim.RealWorld
                  -> (# GHC.Prim.State# GHC.Prim.RealWorld, a #))
    -- Defined in `GHC.Types'
instance Monad IO -- Defined in `GHC.Base'
instance Functor IO -- Defined in `GHC.Base' 
```

当你试图弄清楚如何让 ghci 接受某些东西时，`:t`它会非常有用。

接下来，意识到 ghci 提示符在 IO 中为您提供了逐行的 do-notation。如果您输入 type`IO x`的内容，则当您按 Enter 时，将评估该语句。如果你想绑定那个`x`，使用 do-notation 箭头。如果要创建新绑定（即创建新函数或标识符），请使用`let`. 如果你输入一个不是 IO 的表达式，ghci 会尝试给你，如果没有定义实例`show`，这将不起作用。`Show`

```
Prelude> putStrLn "Hello, World"
Hello, World
Prelude> :t getChar
getChar :: IO Char
Prelude> x <- getChar
yPrelude> 
Prelude> show x
"'y'"
Prelude> let g = 10 :: Int
Prelude> :t g
g :: Int
Prelude> show g
"10"
Prelude> g
10 
```

请注意`show g`和`g`不一样。您可能可以从我上面概述的行为中找出原因。

# r - 在 LaTeX 格式的列联表的行和列标题中包含维度名称

> ID：10703802
> 
> 赞同：11
> 
> 时间：2012-05-22T14:11:23.917
> 
> 标签：r, xtable

如果列联表中属性的类别仅仅是数字，仅使用这些数字作为列/行标题是不够的——需要描述数字的含义。下图显示了家庭规模与家庭样本中外国人数量的交叉分类：

![示例表](../Images/290bd9639ef650fe032cbb526d07fca7.png)

有没有人有使用 R+LaTeX 制作此类表格的经验？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-05T09:17:49.560

我自己有一个相当老套的解决方案，但我也想看看其他方法。当然，如果将此代码的变体添加到`xtable`.

我的解决方案包括更新表的`rownames()`和`colnames()`。行标题进入`rownames()[1]`，列标题进入`colnames()[1]`。有几件事必须记住：

*   如果使用行标题，则结果表中的列数会大一。因此，`tabular`环境必须由用户创建。
*   如果添加了行标题，则列标题必须包含一个额外的`&`
*   请勿在此操作后清理或以其他方式重新格式化行或列名称

该`add.crosstab.headers`功能负责一切。它可以应用于`xtable()`调用的结果。还需要一些辅助函数。

```
macrify <- function(m, s, bs='\\') {
  paste(bs, m, '{', s, '}', sep='')
}

boldify <- function(s) {
  macrify('textbf', s)
}

add.crosstab.headers <- function(t, row.header=NA, col.header=NA,
                                 sanitize=boldify) {
  rownames(t) <- sanitize(rownames(t))
  colnames(t) <- sanitize(colnames(t))
  if (!is.na(row.header)) {
    colnames(t)[1] <- paste('&', colnames(t)[1])
    rownames(t) <- paste('&', rownames(t))
    row.header <- sanitize(row.header)
    row.header <- macrify('rotatebox{90}', row.header)
    multirow <- macrify('multirow', nrow(t))
    multirow <- macrify(multirow, '*', bs='')
    row.header <- macrify(multirow, row.header, bs='')
    rownames(t)[1] <- paste(row.header, rownames(t)[1])
  }
  if (!is.na(col.header)) {
    col.header <- sanitize(col.header)
    multicolumn <- macrify('multicolumn', ncol(t))
    multicolumn <- macrify(multicolumn, 'c', bs='')
    col.header <- macrify(multicolumn, col.header, bs='')
    col.header <- paste(col.header, '\\\\\n')
    col.header <- paste(col.header, '&')
    if (!is.na(row.header)) {
      col.header <- paste('&', col.header)
    }
    colnames(t)[1] <- paste(col.header, colnames(t)[1])
  }
  t
} 
```

用法是这样的。

```
dat <- matrix(round(rnorm(9, 20, 10)), 3, 3)
t <- xtable(dat)
t <- add.crosstab.headers(t, row.header='Foreigners', col.header='Total persons')

print.xtable(t,
             only.contents=TRUE,
             booktabs=TRUE
             , sanitize.text.function=identity
             ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T11:08:27.830

这是一种方法。从矩阵形式的一些数据开始（你应该在发布问题时这样做）。

```
dat<-matrix(round(rnorm(9,20,10)),3,3) 
```

创建名称向量。将名称应用于矩阵。打印矩阵

```
persons<-c(seq("0","2"))
foreign<-c(seq("0","2"))
dimnames(dat)<-list(persons=persons, foreign=foreign)
dat 
```

您可以使用 xtable 输出 Latex 格式的表格。

```
library(xtable)
xtable(dat) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-06T23:03:01.147

可以`ftable`将列联表转换为二维格式化表，并允许指定行中显示的内容和列中显示的内容（对于多于二维的表也很有用）。该`memisc`软件包有助于将其变成漂亮的 LaTeX：

```
library(magrittr)
library(memisc)
expand.grid(Foreigners = 0:5, `Total persons` = 1:8) %>%
  cbind(Freq = rnorm(6*8, 20, 10)) %>%
  xtabs(formula = Freq~.) %>%
  ftable %>%
  toLatex 
```

无需修改，LaTeX 可用于列名`expand.grid`（以支持例如旋转和/或跨越多行）。生成的 LaTeX 代码需要`booktabs`和`dcolumn`包。

![编译输出](../Images/8731fbbed21b3664c897c5179c4abec1.png)

相关：[从 R 中的 ftable 对象创建乳胶表](https://stackoverflow.com/q/9658372/946850)。

# sql - SQL Server - 将总和减去前一行的总和

> ID：10703804
> 
> 赞同：0
> 
> 时间：2012-05-22T14:11:30.427
> 
> 标签：sql, sql-server, group-by, common-table-expression

我有一个查询，它返回对按日期采样的不同对象的请求数，每天可以有多个采样器。开头的 With 部分用于每天只获取最新的样本。

```
With RankedSamples As
    (
    Select  Id, runend
        , ROW_NUMBER() OVER( PARTITION BY convert(varchar , runEnd, 1) ORDER BY runEnd DESC ) ItemRank
    From t_SamplesRuns
    where runend > '05/13/12' and runend < '05/18/12'
    )

select sum(TotalRequests) Hits, 
       convert(nvarchar(10), day(smp.date)) + '-' + 
       convert(nvarchar(10), month(smp.date)) + '-' + 
       convert(nvarchar(10), year(smp.date)) date
from t_samples smp
where  smp.runid in (                 
    select id                 
    from RankedSamples                 
    where ItemRank = 1  
    )    

group by convert(nvarchar(10), day(smp.date)) + '-' + 
         convert(nvarchar(10), month(smp.date)) + '-' + 
         convert(nvarchar(10), year(smp.date)) 
```

这返回的是例如：

```
Hits     date
111111   13-5-2012
222222   14-5-2012
333333   15-5-2012
444444   16-5-2012
555555   17-5-2012 
```

我需要它返回的是这些字段+前一天的点击次数及其减法（第一行无关）：

```
Hits     date       Prev     Res
111111   13-5-2012  0        111111
222223   14-5-2012  111111   111112
333335   15-5-2012  222223   111113 
444447   16-5-2012  333335   111114
555559   17-5-2012  444447   111115 
```

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T14:20:02.007

假设你没有使用 SQL Server 2012，你想要做的是实现一个滞后函数。不幸的是，最简单的方法是使用自联接。所以，我要重写你的查询来做到这一点：

```
With RankedSamples As (
      Select Id, runend,
             ROW_NUMBER() OVER( PARTITION BY convert(varchar , runEnd, 1) ORDER BY runEnd DESC) as ItemRank
      From t_SamplesRuns
      where runend > '05/13/12' and runend < '05/18/12'
    )
     Results as (
      select sum(TotalRequests) Hits,
             convert(nvarchar(10), day(smp.date)) + '-' +  convert(nvarchar(10), month(smp.date)) + '-' +         convert(nvarchar(10), year(smp.date)) as date
      from t_samples smp where  smp.runid in (select id from RankedSamples where ItemRank = 1)
      group by convert(nvarchar(10), day(smp.date)) + '-' +  convert(nvarchar(10), month(smp.date)) + '-' +  convert(nvarchar(10), year(smp.date)
    ),
     Results2 as (
         select r.*, row_number() over (partition by null order by date) as rownum
         from Results
    )
select r.hits, r.date, rprev.hits, r.hits - rprev.hits
from Results2 r left outer join
     Results2 rprev
     on r.rownum = rprev.rownum+1 
```

正如我所说，这在 SQL Server 2012 中更容易，因为窗口函数更类似于 Oracle 的分析函数。

# sql - IF 子句的 SQL 评估

> ID：10703805
> 
> 赞同：9
> 
> 时间：2012-05-22T14:11:30.393
> 
> 标签：sql, sql-server-2008

抱歉，如果这不合适，但实际上这是“为什么”而不是“如何”。不确定这是否合适，但不知道有更好的地方问，我想不出如何用谷歌来表达我想要的东西。

```
 IF 'hell' = 'freezing over'
    BEGIN
    SELECT log(0)
    END 
```

看看那个说法。没有一个世界可以使 IF 子句为真。如果我尝试运行它，我希望 SQL 跳过 IF 子句并移动到末尾。相反，我得到：

```
An invalid floating point operation occurred. 
```

这很奇怪。所以我想这就是 SQL 的工作方式。除了...

```
 IF 'hell' = 'freezing over'
    BEGIN
    SELECT 1/0
    END 
```

这里没有错误。IF 子句中的语句仍应生成错误。谁能解释为什么这没有发生？

这是在调试大量 SQL 计算时出现的，其中 EXP(SUM(LOG())) 用于在 if 子句中累积数据。我可以更改代码以阻止这种情况再次发生，但为什么它会评估未满足的 IF 子句中的某些内容。

干杯。

编辑：额外的娱乐。试着抓？噗噗

```
 IF 1=2
    BEGIN
        BEGIN TRY
            SELECT SQRT(-1)
        END TRY
        BEGIN CATCH
        END CATCH
    END 
```

非数学：

```
 IF 1=2
    BEGIN
    SELECT SUBSTRING('hello',-1,-1)
    END 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-22T14:29:55.393

我的猜测是，`log(0)`由于[常数折叠](http://msdn.microsoft.com/en-us/library/ms175933%28SQL.105%29.aspx)而过早地进行了有效评估，而`1/0`不是，因为它的基数估计或者更可能是 ANSI_WARNINGS 设置会影响除以零的预期结果（溢出与 NULL）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T15:19:27.433

> If I attempt to **run** it I am expecting SQL to jump past the IF clause and move to the end.

When you run your batch three things happen

1.  Your SQL is parsed

2.  Your SQL is compiled

3.  Your SQL is executed

What's unfortunate is that both compile and execution errors in a batch in SQL server result in the same "Query Completed with errors" message. So lets use a Procedure where its easier to see the difference

Consider the following

```
Create proc compiletime
as 
 SELECT log(0)
 SELECT SQRT(-1)
 SELECT SUBSTRING('hello',-1,-1)
 SELECT 1/0 
```

That procedure parses fine. However it can't be compiled unless we remove the first thre SELECTs because we have some constants that are invalid as parameters. It would be nice if `SELECT 1/0` also caused a compile time error instead of a run time error but as @Alex K points out the behavior is based on ANSI_WARNINGS so its not a compile time error.

So that's why we see differences between when the first two. It also explains why TRY CATCH didn't work since its a compile time error.

Now why does SQL server compile unreachable code. Because *in general* in order to know that it's unreachable requires a solution to the halting problem. You can solve it for some cases but then this ...

```
DECLARE @x as integer
SET @x = SomeFunction()
If (1 = @x)
   SomeCompiletime error 
```

would have different behavior which is even more confusing.

```
if (1=0)
   SomeCompiletime error 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-22T14:18:21.717

解析器根本没有智能遵循您的 IF 逻辑。考虑以下示例：

```
IF (1 = 0)
BEGIN
   CREATE TABLE #t(x INT):
END
ELSE
BEGIN 
   CREATE TABLE #t(x INT):
END 
```

无论您是执行它还是只是解析它，解析器都会查看`CREATE TABLE`批处理中的所有语句并确定您尝试创建表两次（显然不必存在第一个副本才能发生这种情况）。结果：

> 消息 2714，级别 16，状态 1，第 7 行
> 数据库中已经有一个名为“#t”的对象。

我真的不知道我是否有比解析器不如你聪明的更好的答案。

您可以通过使用动态 SQL 将问题推迟到运行时来击败解析器，例如

```
IF 'hell' = 'freezing over'
BEGIN
  EXEC sp_executesql N'SELECT log(0);';
END 
```

但是我不得不想知道，为永远不会成立的条件设置脚手架并发布您知道会出错的声明有什么意义？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T14:24:23.767

显然，SQL 编译器试图在编译时和运行时评估一些表达式。我的猜测是，一个部门被认为不是太昂贵，所以它将它推迟到运行时。另一方面，像 log() 这样非常复杂的东西很昂贵，他们想在编译时完成。

这是一个猜测。这也意味着这种差异是不确定的。您必须弄清楚在特定脚本中哪个工作或不工作 - 并且行为可能会在数据库版本之间发生变化。

# sparql - Sesame SPARQL 端点只读

> ID：10703812
> 
> 赞同：5
> 
> 时间：2012-05-22T14:11:44.080
> 
> 标签：sparql, endpoint, sesame

如何防止我的 OpenRDF Sesame 2.6.5 RDF 存储通过 SPARQL 端点进行修改（插入/删除）？

“选择”查询将通过 POST 请求完成。

禁止（通过 Sesame 的 WAR 的 Apache Tomcat 配置文件）以下 SPARQL HTTP 端点 URL：

http://localhost:8080/openrdf-sesame/repositories/test/**更新**...

和

http://localhost:8080/openrdf-workbench/repositories/test/ **update** ... ?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T02:23:13.907

您可以使用基本的 HTTP 身份验证来控制这种事情。有关如何在 Tomcat 中进行配置的分步教程，请参阅[本文。](http://rivuli-development.com/further-reading/sesame-cookbook/basic-security-with-http-authentication/)

诀窍是确保只有某些经过身份验证的用户对存储库具有写入权限。就 HTTP 身份验证而言，这意味着您希望限制对与[Sesame REST 协议](http://www.openrdf.org/doc/sesame2/system/ch08.html)中的修改相对应的任何 URL 模式上的所有 POST、PUT 和 DELETE 请求的访问。

SPARQL 更新操作作为对`repositories/<REPID>/statements`URL 的 POST 请求执行，因此您将具有对该模式的访问权限。此外，您可能还希望限制对 Graph Store 协议操作的访问 ( `repositories/<REPID>/rdf-graphs/*`)。

# python - 如何在matplotlib中设置轴的单位长度？

> ID：10703813
> 
> 赞同：9
> 
> 时间：2012-05-22T14:11:45.330
> 
> 标签：python, matplotlib

例如 x = [1~180,000] 当我绘制它时，在 x 轴上，它显示：1, 20,000, 40,000, ... 180,000 这些 0 真的很烦人

如何将 x 轴的单位长度更改为 1000，使其显示：1、20、40、... 180，并显示其单位为 1000。

我知道我可以自己进行线性变换。但是在matplotlib中没有这样做的功能吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-22T15:17:24.090

如果您的目标是制作出版质量数字，您将需要对坐标轴标签进行精细控制。一种方法是提取标签文本并应用您自己的自定义格式：

```
import pylab as plt
import numpy as np

# Create some random data over a large interval
N = 200
X = np.random.random(N) * 10 ** 6
Y = np.sqrt(X)

# Draw the figure to get the current axes text
fig, ax = plt.subplots()
plt.scatter(X,Y)
ax.axis('tight')
plt.draw()

# Edit the text to your liking
label_text   = [r"$%i \cdot 10^4$" % int(loc/10**4) for loc in plt.xticks()[0]]
ax.set_xticklabels(label_text)

# Show the figure
plt.show() 
```

![在此处输入图像描述](../Images/15917cea4459e3486b5077a061303832.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-22T15:54:45.217

您可以使用`pyplot.ticklabel_format`将标签样式设置为科学计数法。

```
import pylab as plt
import numpy as np

# Create some random data over a large interval
N = 200
X = np.random.random(N) * 10 ** 6
Y = np.sqrt(X)

# Draw the figure to get the current axes text
fig, ax = plt.subplots()
plt.scatter(X,Y)
ax.axis('tight')
plt.draw()

plt.ticklabel_format(style='sci',axis='x',scilimits=(0,0))

# Edit the text to your liking
#label_text   = [r"$%i \cdot 10^4$" % int(loc/10**4) for loc in plt.xticks()[0]]
#ax.set_xticklabels(label_text)

# Show the figure
plt.show() 
```

![输出](../Images/bf002bea579b63d0d2eaaa0b67f87721.png)

# c# - SQLite/C# 连接池和准备好的语句混淆

> ID：10703814
> 
> 赞同：39
> 
> 时间：2012-05-22T14:11:45.463
> 
> 标签：c#, sqlite, prepared-statement, connection-pooling

我一直在花一些时间阅读数据库和 SQLite 的不同最佳实践。在阅读时，我发现我做了很多我不应该做的事情，当我试图解决这些问题时，当我想到将 SQLite 与它的 ADO 实现一起使用的一些更精细的细节时，我变得困惑。

我的困惑特别源于准备好的语句和连接池。

在阅读[http://msdn.microsoft.com/en-us/library/ms971481.aspx](http://msdn.microsoft.com/en-us/library/ms971481.aspx)时，我发现只能为事务打开连接。事务完成后，应关闭连接。我不知道为什么会这样，但我一直在假设作者比我更了解。我理解当连接关闭时并不意味着它实际上已经被关闭。它只是意味着它已被放回池中。

现在为了改进我的查询和插入，我阅读了有关使用准备好的语句的信息。[在 SQLite 中，准备好的语句真的能提高性能吗？](https://stackoverflow.com/questions/1703203/in-sqlite-do-prepared-statements-really-improve-performance)和[http://petesbloggerama.blogspot.com/2007/02/sqlite-adonet-prepared-statements.html](http://petesbloggerama.blogspot.com/2007/02/sqlite-adonet-prepared-statements.html)似乎都表明在执行查询时，将执行多次准备好的语句是要走的路。我还读过准备好的语句是特定于连接的，一旦连接关闭，准备好的语句就会丢失。

我的困惑是这样的。如果我正在打开和关闭我的连接（这可能意味着也可能不意味着由于线程池而关闭了连接），那么我真的从准备好的语句中得到了多少用处？我可以理解，如果我有 1000 个对象，我需要保存在一个事务中，准备好的语句可以提供很大帮助。但是，我不相信我会看到在事务中保存单个对象的好处，因为一旦我关闭连接，从第一个对象生成的准备好的语句现在就丢失了。这是一个真实的说法吗？

我相信准备好的语句与我的 SQLiteCommand 对象的范围相关联，这进一步加剧了我的困惑。

如果我创建一个代表我将经常执行的查询的 SQLiteCommand，我是否需要将该 SQLiteCommand 保留在内存中以使准备好的语句保持活动状态？

如果我使用相同的 SQLite 语句创建一个新的 SQLiteCommand，它是否认识到新的 SQLiteCommand 与以前的相同，因此有一个可以使用的准备好的语句？

如果我在内存中保留一个 SQLiteCommand 并在我打开和关闭不同事务的连接时更改它的参数和连接，我是否实质上在不同的连接之间保持了准备好的语句？

在这一点上，我很可能会过度思考，但我希望你能帮助我更好地理解这些事情是如何相互作用的，这样我就可以从中获得最大的收益。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-22T02:30:18.290

它有助于记住连接池和准备（编译）语句都只是有其局限性的工具，没有任何方法可以同样适用于所有可能的情况。考虑到这一点，让我们记住何时可能想要使用连接池和准备好的语句。

**使用连接池的可能原因**

当连接很昂贵时，连接池很有用，例如：

*   建立连接（与 SQL Server 或 Oracle DB 的网络连接）需要花费*大量时间*，并且“缓存”打开的连接以尝试提高系统性能是有益的。
*   连接在应用程序内（来自服务多个并发请求的 Web 应用程序的连接）或应用程序之间是*有限的和共享*的，因此必须尽快释放它们以让其他客户端继续。

**使用准备好的语句的可能原因**

准备好的语句只是为了通过减少解析时间来提高可重用查询的性能。

**SQLite：最好的选择是什么？**

答案取决于您的应用要求。就个人而言，我不确定 SQLite 连接池是否一定是一个不错的选择。如果您的应用程序是单线程的，最好使用到 SQLite DB 的单个永久连接，这可能比池快得多，并且还允许您使用准备好的语句。这与连接池是一个非常合理的默认值的 SQL Server 不同。

如果性能很重要，您绝对应该分析应用程序以查看 SQLite 连接池是否对您的方案有益。

**具体问题**

大多数答案都与当前`System.Data.SQLite`提供者[来源](http://system.data.sqlite.org/index.html/dir?ci=trunk)有关。

> 如果我正在打开和关闭我的连接（这可能意味着也可能不意味着由于线程池而关闭了连接），那么我真的从准备好的语句中得到了多少用处？

通常，您应该将来自池的连接视为新连接，即您不应该期望从先前准备的语句中获得任何好处。除非您同时保留命令和连接，否则该语句将“重新准备”。

> 但是，我不相信我会看到在事务中保存单个对象的好处，因为一旦我关闭连接，从第一个对象生成的准备好的语句现在就丢失了。这是一个真实的说法吗？

这是一个真实的陈述。

> 如果我创建一个代表我将经常执行的查询的 SQLiteCommand，我是否需要将该 SQLiteCommand 保留在内存中以使准备好的语句保持活动状态？

是的，你需要保留它。`SQLiteCommand`持有对准备好的语句的引用。

> 如果我使用相同的 SQLite 语句创建一个新的 SQLiteCommand，是否可以识别出新的 SQLiteCommand 与以前的 SQLiteCommand 相同，因此有一个可以使用的准备好的语句？

我不认为它被支持。

> 如果我在内存中保留一个 SQLiteCommand 并在我打开和关闭不同事务的连接时更改它的参数和连接，我是否实质上在不同的连接之间保持了准备好的语句？

如果您更改`SQLiteCommand`' 连接，该语句将“重新准备”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-18T13:36:29.523

我没有确切地抓住核心问题是什么，但如果问题是如何在这么短的时间内在一个事务中插入批量插入语句。

这是我之前发现的一个帮助类，可以帮助你：

[SQLiteBulkInsertHelper.cs](https://docs.google.com/file/d/0B5-wcgU-Ku-eMDNlY1R3SzByV00/edit?pli=1)

你可以像这样使用它：

```
SQLiteBulkInsertHelper ContactBlk = new SQLiteBulkInsertHelper("<SQLiteConnection>","<Table Name>");
ContactBlk.AllowBulkInsert = true;
ContactBlk.AddParameter("<Column Name>", /*Column Data Type*/System.Data.DbType.Int64);
ContactBlk.AddParameter("<Column Name>", /*Column Data Type*/System.Data.DbType.String);
ContactBlk.Insert(new object[] {<First Column Value>,<Second Column Value>});
ContactBlk.Flush(); 
```

如果您认为它可以解决您的问题，请尝试一下。

# java - Java - 如何以可移植的方式加载图像？（即，不指定绝对地址？）

> ID：10703815
> 
> 赞同：0
> 
> 时间：2012-05-22T14:11:45.713
> 
> 标签：java, image

我正在制作一个应用程序，它会弹出一个带有图像的窗口。我在网上查看了用Java加载图像的教程，它们似乎都指定了图像的绝对地址。这很好，直到有人在他们的机器上运行我的应用程序。那么有没有办法稳健地加载图像？所以不管它在什么机器上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:14:14.837

在 JAR 文件中包含图像并使用 ClassLoader.getResource ？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T14:15:05.327

我假设您将创建一个包含所有类和图像的 JAR 文件。您可以执行以下操作：

```
BufferedImage background = ImageIO.read(getClass().getResource("/images/background.png")) 
```

这将加载相对于应用程序基础的图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T14:19:51.733

如果您在某人的机器上安装应用程序，您可以将目录结构的根存储为安装的一部分。然后在运行时图像文件将相对于这个根。或者你可以对这个根目录做一些假设。例如执行应用程序的目录。或者，您可以让用户对其进行配置。

# php - 如果标记为真，则从表中返回父母子女子女等

> ID：10703816
> 
> 赞同：0
> 
> 时间：2012-05-22T14:11:49.520
> 
> 标签：php, mysql, loops, multidimensional-array

我有一张表，上面有很多类别，这些类别有与之相关的孩子，这些孩子也可以与那里的孩子相关，最大深度为 3 个孩子。使用数组样式的示例。

我想要做的是查询表和一些如何制作一个数组，将结果存储在一个数组中，就像下面的数组一样，将来可以搜索它以获得值为 true 的键。

cat_1 -> chd_1 -> chd_2 ， chd_3 等等..

示例类别表：

```
 +----+--------+-----------+---------+
    | id | name   | parent_id | storage |
    +----+--------+-----------+---------+
    |  1 | cat_1  |    0      |         |
    |  2 | cat_2  |    0      |         |
    |  3 | chd_1  |    1      |         |
    |  4 | chd_2  |    3      |  true   |
    |  5 | chd_3  |    3      |  true   |
    |  6 | chd_4  |    1      |         |
    |  7 | chd_5  |    6      |  true   |
    |  8 | chd_6  |    2      |         |
    |  9 | chd_7  |    8      |  true   |
    | 10 | chd_8  |    2      |  true   |                                
    +----+--------+-----------+---------+ 
```

我想创建一个这样的数组：

```
 $categories = array(cat_1 => array(chd_1 => array(chd_2 => true,
                                                      chd-3 => true)

                                       chd_4 => array(chd_5 => true),

                        cat_2 => array(chd_6 => array(chd_7 => true)
                                       chd_8 => true) 
```

我以前不必为此使用数组，所以它让我很难过！

基本上，这段代码将让我做的是在其父页面内显示与等于 true 的类别相关的另一个表的信息，直到到达子页面。

谢谢。

# apache - Apache 与 Weblogic 会话时间

> ID：10703822
> 
> 赞同：0
> 
> 时间：2012-05-22T14:12:06.930
> 
> 标签：apache, session, weblogic, session-timeout, stateful

我正在开发一个存储有关会话的一些信息的网络应用程序，它必须保持活跃至少 2 小时。（有点像购物车）。

我在多个 weblogic 实例前使用 Apache。Apache 用于缓存 + 只是一些 RR 平衡。

在我的 web.xml 中，我配置了 120 分钟的会话时间。

但现在我想知道所有这些 Apache 设置，比如一般的“超时，保持活动，保持活动超时”

以及我可以在“balance-config”中指定的那些，目前是

SetHandler weblogic-handler

WebLogicCluster serv1:port1,ser2:port2

ConnectTimeoutSecs 10

连接重试秒 2

KeepAliveEnabled 开启

KeepAliveSecs 15

WLCookieName WLBALANCECOOKIENAME

所以在这里我可以指定另一个 KeepAliveEnabled / KeepAliveSecs

我是否必须将所有内容都设置为 keepalive=YES 并将秒数设置为 7200+？这确保我的 web.xml 的 2 小时会话超时将得到尊重？

我可能可以降低一般的“超时”，因为据我了解，这是针对长请求/响应的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T09:24:16.863

`KeepAlive`未链接到 weblogic 上的会话超时。

Apache 服务器中的`KeepAlive`Apache 插件通过使用从 Apache 插件到 WebLogic Server 的可重用连接池来提高性能。如果连接处于非活动状态超过 30 秒（或用户定义的时间量），则连接将关闭并返回到池中。

仍然建议将 KeepAlive 设置为 ON，并将 KeepAliveSecs 15 设置为默认值。

现在讨论启用 2 小时会话超时的主要问题。注意：2 小时是一个很高的时间（默认只有 30 分钟），您的 Weblogic 服务器将使用更多内存来保持会话详细信息有效。

我假设您依赖 Apache 根据用户的 JSESSIONID 定向到正确的 Weblogic 服务器。在这种情况下 - Apache 会将请求发送到集群中正确的 Weblogic 服务器 - 并且用户的会话将在该服务器上保持活动状态。除非您打开会话复制，这是另一个内存占用者。

但要回答你的问题，你的 120 分钟应该根据`<session-timeout>`web.xml 中的设置得到尊重。也可以在 weblogic.xml 中设置，但最重要的是 web.xml

# html - list-style-image + 选择框，使选择框与顶部对齐

> ID：10703827
> 
> 赞同：0
> 
> 时间：2012-05-22T14:12:12.990
> 
> 标签：html, css

当我尝试在中放置`list-style-image`一个`select`框时`<li>`，该`select`框在底部垂直对齐，但`list-style-image`在顶部垂直对齐。如何使`select`框也与顶部对齐？

看起来`select`盒子里有一个`margin-top:5px`我试图摆脱的东西，但即使我将它设置为 0，它仍然存在。

CSS：

```
 li { 
    list-style-image:url(image1.jpg); 
    vertical-align:text-top;
  }

  select { margin-top:0; } 
```

HTML：

```
 <li>
  <select>
    <option>1</option>
  </select>
 </li> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T14:46:02.237

永远不要使用`list-style-image`. 相反，使用填充 CSS 背景。这是您可以正确控制图像位置的唯一方法。

就像是：

```
li {
  background-image:url(BulletCheck.png); 
  background-repeat:no-repeat; 
  padding-left:30px; 
  margin-left:-30px;
} 
```

请参阅我的教程： http: [//preview.moveable.com/JM/ilovelists/](http://preview.moveable.com/JM/ilovelists/)

# ios - iOS UI 线程/后台或后台到后台线程通信

> ID：10703832
> 
> 赞同：1
> 
> 时间：2012-05-22T14:12:23.997
> 
> 标签：ios, multithreading

我有一个基于地图的程序，当用户与屏幕上的元素交互时，应用程序会查询数据库并根据用户选择的内容添加注释。为了防止整个地图 UI 锁定，我已将此查询并在后台线程中添加注释代码.. 它运行良好。

现在的问题是，如果用户点击界面上的另一个元素，在后台线程完成之前启动一个新线程来做同样的事情。这本身并不是问题，但在速度较慢的设备（旧 iPod 和 iphone 3gs 等）上，第二个线程可能在第一个线程之前完成，因此用户会短暂获得与最后一次交互相关的视图，但如果第一次交互需要很长时间来处理，则会显示第一个结果。（经典赛车条件）。

所以，我想做的是进行第二次交互，通知任何已经在运行的后台线程，嘿，你基本上可以退出你现在正在做的事情并结束。我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T16:16:25.130

使用 GCD 调度队列。它自动提供 FIFO 排序和块。虽然您无法取消已经在运行的请求，但您可以阻止其他请求运行。

由于您没有说您正在使用 CoreData，并且您已经在使用单独的线程，因此我假设您没有使用 CoreData 作为您的“数据库”。

尝试一些简单的事情，例如...

当你的类初始化时创建你的队列（或者应用程序启动，如果它总是应该在那里）......

```
dispatch_queue_t workQ = dispatch_queue_create("label for your queue", 0); 
```

并在您的班级解除分配（或其他适当的时间）时释放它......

```
dispatch_release(workQ); 
```

为了获得类似的取消，如果已经做出了另一个选择，你可以做一些简单的事情，比如使用一个令牌来查看你正在处理的请求是否是“最新的”，或者从那时起是否有另一个请求出现......

```
static unsigned theWorkToken;
unsigned currentWorkToken = ++theWorkToken;
dispatch_async(workQ, ^{
    // Check the current work token at each step, to see if we should abort...
    if (currentWorkToken != theWorkToken) return;
    MyData *data = queryTheDatabaseForData(someQueryCriteria);

    if (currentWorkToken != theWorkToken) return;
    [data doTimeConsumingProcessing];

    for (Foo *foo in [data foo]) {
        if (currentWorkToken != theWorkToken) return;
        // Process some foo object
    }

    // Now, when ready to interact with the UI...
    if (currentWorkToken != theWorkToken) return;
    dispatch_async(dispatch_get_main_queue(), ^{
        // Now you are running in the main thread... do anything you want with the GUI.
    });
}); 
```

该块将“捕获”堆栈变量“currentWorkToken”及其当前值。请注意，解锁检查在这里很好，因为您不需要跟踪连续计数，只要它在您设置后发生了变化。在最坏的情况下，您将执行额外的步骤。

如果您使用 CoreData，您可以使用 NSPrivateQueueConcurrencyType 创建您的 MOC，现在您根本不需要创建工作队列，因为私有 MOC 有自己的...

```
static unsigned theWorkToken;
unsigned currentWorkToken = ++theWorkToken;
[managedObjectContext performBlock:^{
    // Check the current work token at each step, to see if we should abort...
    if (currentWorkToken != theWorkToken) return;
    MyData *data = queryTheDatabaseForData(someQueryCriteria);

    if (currentWorkToken != theWorkToken) return;
    [data doTimeConsumingProcessing];

    for (Foo *foo in [data foo]) {
        if (currentWorkToken != theWorkToken) return;
        // Process some foo object
    }

    // Now, when ready to interact with the UI...
    if (currentWorkToken != theWorkToken) return;
    dispatch_async(dispatch_get_main_queue(), ^{
        // Now you are running in the main thread... do anything you want with the GUI.
    });
}]; 
```

GCD/Blocks 确实是这类东西的首选方法。

**编辑**

为什么首选？嗯，首先，使用块可以让你的代码保持本地化，而不是分散到另一个类（NSOperation）的其他方法中。还有很多其他的原因，但我将把我的个人原因放在一边，因为我不是在谈论我的个人喜好。我说的是苹果的。

只需坐一个周末，观看所有 WWDC 2011 视频。去吧，**真的**是大快人心。我是真诚的。如果您在美国，您将迎来一个长周末。我敢打赌，你想不出更好的办法……

不管怎样，看看这些视频，看看你能不能数出不同的演讲者说他们强烈推荐使用 GCD 的次数......和块......（以及仪器作为另一个）。

现在，WWDC 2012 可能很快就会改变，但我对此表示怀疑。

具体来说，在这种情况下，它也是比 NSOperation 更好的解决方案。是的，您可以取消尚未开始的 NSOperation。哎呀。NSOperation 仍然没有提供一种自动方式来取消已经开始执行的操作。您必须继续检查 isCanceled，并在发出取消请求时中止。因此，所有那些 if (currentToken != theWorkToken) 仍然必须像 ([self isCancelled]) 一样存在。是的，后者更容易阅读，但您还必须明确取消未完成的操作。

对我来说，GCD/blocks 解决方案更容易理解，是本地化的，并且（如所示）具有隐式取消语义。NSOperation 唯一的优点是，如果排队的操作在开始之前被取消，它会自动阻止它运行。但是，您仍然必须提供自己的取消运行操作功能，因此我认为 NSOperation 没有任何好处。

NSOperation 有它的位置，我可以立即想到几个我更喜欢它而不是直接 GDC 的地方，但对于大多数情况，尤其是这种情况，它是不合适的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T14:24:04.063

我会将后台活动放入一个操作中（它将在后台线程上运行），保留一个活动操作正在处理的数组，然后当用户点击地图时扫描数组以查看相同的任务是否已经在进行中，如果是这样，要么不启动新操作，要么取消当前操作。在操作代码中，您需要定期检查 isCancelled。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-22T15:11:10.220

-[NSOperationQueue cancelAllOperations] 调用 -[NSOperation cancel] 方法，这会导致对 -[NSOperation isCancelled] 的后续调用返回 YES。但是，您已经做了两件事以使其无效。

您正在使用 @synthesize isCancelled 来覆盖 NSOperation 的 -isCancelled 方法。没有理由这样做。NSOperation 已经以完全可以接受的方式实现了 -isCancelled。

您正在检查自己的 _isCancelled 实例变量以确定操作是否已被取消。NSOperation 保证如果操作被取消， [self isCancelled] 将返回 YES。它不保证将调用您的自定义 setter 方法，也不保证您自己的实例变量是最新的。你应该检查 [self isCancelled]

```
// MyOperation.h
@interface MyOperation : NSOperation {
}
@end 
```

和实施：

```
// MyOperation.m
@implementation MyOperation

- (void)main {
    if ([self isCancelled]) {
        NSLog(@"** operation cancelled **");
    }
    sleep(1);

    if ([self isCancelled]) {
        NSLog(@"** operation cancelled **");
    }

    // If you need to update some UI when the operation is complete, do this:
    [self performSelectorOnMainThread:@selector(updateButton) withObject:nil waitUntilDone:NO];

    NSLog(@"Operation finished");
}

- (void)updateButton {
    // Update the button here
}
@end 
```

请注意，您不需要对 isExecuting、isCancelled 或 isFinished 执行任何操作。这些都是自动为您处理的。只需覆盖 -main 方法。就这么容易。

然后从 MyOperation 类创建对象，并在有另一个操作时对队列进行操作..您可以检查您是否有操作已经在运行 -?? 如果您只是取消它们并进行新操作..

您可以阅读此参考[Subclassing NSOperation to be concurrent and cancelable](https://stackoverflow.com/questions/3859631/subclassing-nsoperation-to-be-concurrent-and-cancellable)

# php - 移动重定向回到桌面站点

> ID：10703835
> 
> 赞同：0
> 
> 时间：2012-05-22T14:12:31.737
> 
> 标签：php, html, mobile

我在我的网站上添加了一个 php 移动重定向：

```
<?php

require_once('mobile_device_detect.php');
$mobile = mobile_device_detect();
if($mobile==true){
  header('Location:http://www.esielectrical.co.uk/mobile');
}else{
  header('Location:http://www.esielectrical.co.uk/index.html');
}
exit;

?> 
```

当我使用移动网站时，我正在尝试使用链接返回桌面版本。

这样做的最佳方法是什么？

有人可以帮我吗？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T14:25:25.490

当服务器收到一个页面请求时，这个请求头也有浏览器信息。因为这是请求。

当您从服务器设置标头时，您正在发送响应。请注意，您正在发送响应，此时您应该为您重定向的页面设置显示移动版本的参数，以便您重定向的页面可以检测到对于此重定向，我需要显示移动版本。

您可以设置 cookie，您应该在第一次获得请求表单最终用户时设置此 cookie。您可以在 cookie 中存储操作系统类型。

或在 url 中传递值，以便检测它呈现移动版本。

你的问题应该在这之间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T14:18:28.037

该链接上可能应该有一个 URL 变量，因此您可以添加到您的移动检查以查看该变量是否已设置。一旦设置了该变量，您就可以在会话中设置一个值并使用它来检查用户当前对移动设备或桌面的偏好。

# php - 将 iframe src 参数传递给里面的代码

> ID：10703849
> 
> 赞同：0
> 
> 时间：2012-05-22T14:13:11.127
> 
> 标签：php, jquery, iframe

我在 src url 中有一个带有参数的 iframe，如下所示：

```
<iframe src="http://www.form-page.com?suppressRedirect=1&A=1841" width="271px" height="295px" scrolling="no" frameborder="no" allowtransparency="true" style="position: absolute;left: 0;z-index: 1000;padding-left: 5px;"></iframe> 
```

我需要在“**表单页面**” 中获取参数
有没有办法在 php 或 jquery 中做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T14:15:32.870

是的，在 php 中检查 $_GET 数组

```
$_GET['suppressRedirect'];
$_GET['A']; 
```

值应分别为 1 和 1841

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T14:16:00.443

您正在通过查询字符串传递参数，就像任何正常请求一样。

```
$_GET['suppressRedirect']; // = 1
$_GET['A']; // = 1841 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T14:18:42.433

在您的 index.php 上，您可以获取这些参数的值，例如：

```
$suppressRedirect = $_GET['suppressRedirect'];
$A = $_GET['A'];
// use these two variables as you like now 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T14:19:14.103

您已经以通常的方式通过 URL 传递所有参数，即通过 $_GET 变量！
所有参数都存储在超全局变量（数组类型）$_GET 中。

在您的页面中：

```
http://www.form-page.com?suppressRedirect=1&A=1841 
```

假设您在 index.php 文件中以`$_GET['A']`和的形式接收这些参数`$_GET['suppressRedirect']`。

OBS：PHP 变量区分大小写：`$_GET['A']`与`$_GET['a']`

# android - 在我的应用程序上登录 Android :)

> ID：10703851
> 
> 赞同：0
> 
> 时间：2012-05-22T14:13:12.080
> 
> 标签：android, sql, login

我是 android 的新开发人员，我已经开始开发一些回旋镖的应用程序。在这个应用程序中，我需要使用 google plus 或我们的主页 boomerangliv.dk 登录。我需要这个登录名来控制谁将什么上传到我们的 SQL 数据库。这个问题有什么解决办法吗？谢谢 ：）

拉斯

# c++ - 在 std::unordered_map 中使用对象引用作为键

> ID：10703852
> 
> 赞同：12
> 
> 时间：2012-05-22T14:13:15.820
> 
> 标签：c++, c++11, libstdc++, libc++

我想知道是否可以在 C++ 的 unordered_map 容器中使用对象引用作为键。

```
#include <unordered_map>

class Object {
    int value;
};

struct object_hash {
  inline size_t operator()(const Object& o) const { return 0; }
};

std::unordered_map<Object&, int, object_hash> map; 
```

在尝试编译这个简单的代码片段时，我遇到了一些关于方法重新定义的错误：

在 libc++ 中使用 clang

> **/usr/include/c++/v1/unordered_map:352:12：错误：无法重新声明类成员**
> 
> size_t operator()(const _Cp& __x) const

将 gcc 4.6 与 libstdc++ 一起使用

> **/usr/include/c++/4.6/bits/hashtable_policy.h:556:5:**错误：'std::__detail::_Map_base<_Key, _Pair, std::_Select1st<_Pair>, true, _Hashtable>::mapped_type& std ::__detail::_Map_base<_Key, _Pair, std::_Select1st<_Pair>, true, _Hashtable>::operator [with _Key = Object&, _Pair = std::pair, _Hashtable = std::_Hashtable, std::allocator >, std::_Select1st >, std::equal_to, object_hash, std::__detail::_Mod_range_hashing, std::__detail::_Default_ranged_hash, std::__detail::_Prime_rehash_policy, false, false, true>, std::__detail ::_Map_base<_Key, _Pair, std::_Select1st<_Pair>, true, _Hashtable>::mapped_type = int]'**不能重载**
> 
> **/usr/include/c++/4.6/bits/hashtable_policy.h:537:5** : 错误: **with** 'std::__detail::_Map_base<_Key, _Pair, std::_Select1st<_Pair>, true, _Hashtable>::mapped_type& std::__detail::_Map_base<_Key, _Pair, std::_Select1st<_Pair>, true, _Hashtable>::operator[](const _Key&) [with _Key = Object&, _Pair = std::pair, _Hashtable = std: :_Hashtable, std::allocator >, std::_Select1st >, std::equal_to, object_hash, std::__detail::_Mod_range_hashing, std::__detail::_Default_ranged_hash, std::__detail::_Prime_rehash_policy, false, false, true>, std::__detail::_Map_base<_Key, _Pair, std::_Select1st<_Pair>, true, _Hashtable>::mapped_type = int]'</p>

如果我改用旧的 gnu hash_map (__gnu_cxx::hash_map)，我就没有这个问题。

这是新标准施加的一些限制吗？如果是，为什么？

有没有办法解决这个限制？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-22T15:26:31.003

新标准定义`std:reference_wrapper<T>`解决此限制。

它可以隐式转换为 a `T&`，因此它是透明的，并且类似的引用保证没有`null`状态，但与引用不同的是它可以重新定位。

更多信息在[使用`std::reference_wrapper`中作为键`std::map`](https://stackoverflow.com/questions/9139748/using-stdreference-wrapper-as-the-key-in-a-stdmap)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-09-17T18:05:36.117

我遇到了这个问题，我的同事帮我找到了一个我认为值得分享的解决方案：

```
struct RefWapperAddressHash
{
    std::size_t operator()( Object const& obj ) const
    {
        std::hash< Object const* > theHash{};
        return theHash( &obj );
    }
};

std::unordered_map< std::reference_wrapper< Object >, int, RefWrapperAddressHash > m_map; 
```

这使用[std::hash 的](https://en.cppreference.com/w/cpp/utility/hash)ctor ：`template< class T > struct hash<T*>;`

# javascript - 使用 moment.js 进行日期/时间转换

> ID：10703853
> 
> 赞同：2
> 
> 时间：2012-05-22T14:13:20.913
> 
> 标签：javascript, momentjs

我想使用[moment.js](http://momentjs.com)进行日期转换。

这就是我想要的：

```
var original_format = "Tuesday, May 22, 2012";

var output1 = "16 hours ago"
var output2 = "2012-05-22T00:00:00+02:00" 
```

对于 output1 没问题，对于第二个是否可以使用 moment.js 来实现？

```
moment("original_format").fromNow(); // "16 hours ago" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T16:05:17.507

```
moment("original_format").format(); 
```

# python - Python，合并多级字典

> ID：10703858
> 
> 赞同：4
> 
> 时间：2012-05-22T14:13:26.807
> 
> 标签：python, dictionary

> **可能重复：**
> [python：字典的字典合并](https://stackoverflow.com/questions/7204805/python-dictionaries-of-dictionaries-merge)

```
my_dict= {'a':1, 'b':{'x':8,'y':9}}
other_dict= {'c':17,'b':{'z':10}}
my_dict.update(other_dict) 
```

结果是：

```
{'a': 1, 'c': 17, 'b': {'z': 10}} 
```

但我想要这个：

```
{'a': 1, 'c': 17, 'b': {'x':8,'y':9,'z': 10}} 
```

我怎样才能做到这一点？（可能以简单的方式？）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-22T14:22:26.740

```
import collections # requires Python 2.7 -- see note below if you're using an earlier version
def merge_dict(d1, d2):
    """
    Modifies d1 in-place to contain values from d2\.  If any value
    in d1 is a dictionary (or dict-like), *and* the corresponding
    value in d2 is also a dictionary, then merge them in-place.
    """
    for k,v2 in d2.items():
        v1 = d1.get(k) # returns None if v1 has no value for this key
        if ( isinstance(v1, collections.Mapping) and 
             isinstance(v2, collections.Mapping) ):
            merge_dict(v1, v2)
        else:
            d1[k] = v2 
```

如果您没有使用 Python 2.7+，请替换`isinstance(v, collections.Mapping)`为`isinstance(v, dict)`（用于严格类型）或`hasattr(v, "items")`（用于鸭子类型）。

请注意，如果某个键存在冲突——即，如果 d1 有一个字符串值，而 d2 有一个该键的 dict 值——那么这个实现只保留 d2 的值（类似于`update`）

# java - Jsoup，忽略带有 javascript 弹出窗口的链接

> ID：10703861
> 
> 赞同：1
> 
> 时间：2012-05-22T14:13:38.743
> 
> 标签：java, jsoup

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T15:04:30.407

如果`href`总是`javascript:OpenPopup()`你可以添加另一个 if 语句。

```
if (page.attr("href").equals("javascript:OpenPopup()")) {
    if (validateUrl(link) {
    }
} 
```

注意...代码未经过编译测试。

# wpf - 使用 MVVM Light 从组合框中的按钮触发命令

> ID：10703864
> 
> 赞同：2
> 
> 时间：2012-05-22T14:13:54.837
> 
> 标签：wpf, button, mvvm, combobox, command

我在自定义 ComboxBox 触发事件时遇到问题。这个想法是让组合框绑定到一组项目，每个项目都有一个编辑和删除按钮。我可以使用代码隐藏使点击事件工作，但命令绑定似乎什么都不做。

```
 <ComboBox SelectedIndex="0">
                <ComboBox.ItemTemplate>
                    <DataTemplate>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="200"/>
                                <ColumnDefinition Width="auto"/>
                            </Grid.ColumnDefinitions>
                        <TextBlock Text="{Binding Name}"/>
                            <StackPanel Grid.Column="1" 
                                        Orientation="Horizontal"
                                        HorizontalAlignment="Right">
                                <Button Content="Edit" 
                                        Margin="0,0,5,0" 
                                        Command="{Binding EditConnectionCommand}"
                                        CommandParameter="{Binding ID}"/>
                                <Button Content="Delete"
                                        Command="{Binding DeleteConnectionCommand}"
                                        CommandParameter="{Binding ID}"/>
                            </StackPanel>
                        </Grid>
                    </DataTemplate>
                </ComboBox.ItemTemplate>
                <ComboBox.ItemsSource>
                    <CompositeCollection>
                        <ComboBoxItem IsEnabled="False" Visibility="Collapsed">Select a database connection...</ComboBoxItem>
                        <CollectionContainer Collection="{Binding Source={StaticResource ConnectionsBridge}}" />
                        <ComboBoxItem>...New Connection...</ComboBoxItem>
                    </CompositeCollection>
                </ComboBox.ItemsSource>
            </ComboBox> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T14:19:44.747

您的绑定在项目中查找命令，而不是在窗口的 ViewModel 中。
要更改这一点，请像这样修复您的绑定：

```
{Binding ElementName=root, Path=DataContext.EditConnectionCommand} 
```

为此，您需要添加`Name="root"`到您的`UserControl`或`Window`.

# jsp - 了解 JSP 如何填充 JSF UIViewRoot

> ID：10703866
> 
> 赞同：2
> 
> 时间：2012-05-22T14:14:00.707
> 
> 标签：jsp, jsf

JSF 可以使用 JSP 作为视图定义语言。

根据我对 JSP 所做的理解是：它生成一个实现 servlet 接口的 java 类。当这个 servlet 被调用时，它会写入响应对象（即发送到 servlet 客户端）。

如果它只是写入响应对象，那么 UIViewRoot 是如何填充的？

渲染阶段怎么样，如果 JSP 已经写入响应，它还需要做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T14:31:01.747

正是`<f:xxx>`and`<h:xxx>`标签发挥了作用。标签`<f:view>`代表. `UIViewRoot`此标记中的所有内容都由 JSF 渲染器处理，而不是由 JSP 处理。JSP 只执行标记的主体，而标记主体又委托给所有 JSF 工作。JSP 不会将普通标签打印到响应中（在浏览器中右键单击页面并执行*View Source*，那里应该没有单个 JSF 标记，而只有其 HTML 输出）。

要了解有关“自定义”JSP 标记的更多信息，请查看[Java EE 5 教程](http://docs.oracle.com/javaee/5/tutorial/doc/bnann.html)。

请注意，在 JSP 的后续 Facelets 中`<f:view>`，这不是强制性的，它已被隐式使用。

### 也可以看看：

*   [JSF、Servlet 和 JSP 有什么区别？](https://stackoverflow.com/questions/2095397/what-is-the-difference-between-jsf-servlet-and-jsp/2097732#2097732)

# gcc - gcc 未定义 _cxa_pure_virtual

> ID：10703876
> 
> 赞同：0
> 
> 时间：2012-05-22T14:14:59.893
> 
> 标签：gcc, linkage

我有 2 个共享对象库和一个可执行文件。

我编译的 1 个库有链接错误：`Undefined _cxa_pure_virtual`.

为什么？通常我们不需要实现它。有任何想法吗？

如果我实现它，libs 编译和链接都可以，但是链接到两者的应用程序有相同的链接问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:20:22.670

有问题的库是 C++ 库，C++ 运行时需要 __cxa_pure_virtual。建议您先尝试使用 g++ 命令而不是 gcc 进行链接。

在这个问题下阅读更多内容：[cxa pure virtual 的目的是什么](https://stackoverflow.com/questions/920500/what-is-the-purpose-of-cxa-pure-virtual)

# javascript - 从 iFrame 中存在的其他框架调用 JavaScript 函数

> ID：10703881
> 
> 赞同：1
> 
> 时间：2012-05-22T14:15:13.507
> 
> 标签：javascript, html, iframe

我的 HTML 页面中有一个 iFrame`iFrame_Example.html`

```
<iframe src="1.html" height="400" width="400"></iframe> 
```

`1.html``frames`里面有两个

```
 <frameset rows="30,*" frameborder=0 border=0>
        <frame id="top_frame" name="top_frame"src="top_frame.htm"></frame>
        <frame id="main_frame" name="main_frame"src="main_frame.htm"></frame>
    </frameset> 
```

现在`top_frame.htm`我有一个按钮

```
<input type="button" value="Hi" onClick="top.main_frame.SayHi()"> 
```

`SayHi()`在`main_frame.htm`

```
function SayHi()
{
  alert("Hi");
} 
```

当我`1.html`在浏览器中运行时，该函数`SayHi()`被正确调用。但是当我运行 `iFrame_Example.html`它时，它不起作用。

如何使用 onClick 事件调用该函数？非常感激任何的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T14:27:56.727

你试过`frames.top_frame.SayHi()`吗？

**更新：**我想你可能需要`parent.frames.top_frame.SayHi()`

# json - 在 webservice 中传递身份验证参数

> ID：10703883
> 
> 赞同：0
> 
> 时间：2012-05-22T14:15:19.890
> 
> 标签：json, web-services, authentication, header

我正在构建一个 web 服务服务器端。在我的网络服务中，每个客户端都需要通过 POST 方法以 json 格式为他们发出的每个请求传递他们的身份验证参数。通过帖子传递参数是一种好习惯吗？

一个人告诉我，我应该总是使用 GET 方法来检索数据；POST 应该只用于插入。如果是这样，我将如何通过身份验证参数？一种可以通过 URL，另一种可以通过标头值。我应该使用哪种方式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T18:06:44.357

尝试实现此 Web 服务。此 Web 服务允许通过标头值传递其身份验证参数。

```
@WebService(serviceName="authentication")
public class WSAuthentication {
String name = null;
String password = null;

public WSAuthentication() {
   super();
}

public WSAuthentication(String name, String password) {
   this.name = name;
   this.password = password;
}

private static String getData(WSAuthentication sec) {
   System.out.println("********************* AUTHENTICATION ********************" + "\n" + 
   "**********USER: " + sec.name + "\n" + 
   "******PASSWORD: " + sec.password + "\n" + 
   "******************************** AUTHENTICATION ****************************");
   return sec.name + " -- " + sec.password;
}

@WebMethod(operationName="security", action="authenticate")
@WebResult(name="answer")
public String security(@WebParam(header=true, mode=Mode.IN, name="user") String user, @WebParam(header=true, mode=Mode.IN, name="password") String password) {
    WSAuthentication secure = new WSAuthentication(user, password);
    return getData(secure);
 }
} 
```

我使用 POST 方法进行响应。我希望能帮助你。

# ios - TFHpple XML 返回 NULL

> ID：10703885
> 
> 赞同：0
> 
> 时间：2012-05-22T14:15:20.050
> 
> 标签：ios, xml, xpath

我在使用 TFHpple 和执行基本的 XML 搜索查询时遇到问题。我已经包含了代码和 XML 响应。我有一个 MutableArray 存储返回的数据，然后我 NSLog 它。在解析 HTML 页面之前，以下代码对我来说工作得很好（当然我使用了 initWIthHTMLData: 代替）。任何帮助将不胜感激。

```
 NSData *data = [[NSData alloc] initWithContentsOfURL:[NSURL     
 URLWithString:@"http://api.wmata.com/Rail.svc/Stations?     
 LineCode=RD&api_key=---------------------------"]];

// Create parser
TFHpple *xpathParser = [[TFHpple alloc] initWithXMLData:data]; //using XML data

//Pass in the search path
NSArray *elements  = [xpathParser  searchWithXPathQuery:@"//Name"];

// Access the first cell
if([elements count] > 0) {

    TFHppleElement *element = [elements objectAtIndex:0];

    // Get the text within the cell tag
    NSString *content = [element content];

    if (content) {
        //NSLog(@"%@", content);
        self.linkElements = [elements copy];

    }else{
        NSLog(@"No string found in the content");
    }

}else{
    NSLog(@"Nothing was found for your search query");
}

NSLog(@"The following is the result of the link elements array: %@", self.linkElements); 
```

以下是一个示例 xml 响应：

```
 <StationsResp xmlns="http://www.wmata.com" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
<Stations>
<Station>
  <Code>C02</Code>
  <Lat>38.9013327968</Lat>
  <LineCode1>BL</LineCode1>
  <LineCode2>OR</LineCode2>
  <LineCode3 i:nil="true" />
  <LineCode4 i:nil="true" />
  <Lon>-77.0336341721</Lon>
  <Name>McPherson Square</Name>
  <StationTogether1 />
  <StationTogether2 />
</Station>
<Station>
  <Code>C01</Code>
  <Lat>38.8983144732</Lat>
  <LineCode1>BL</LineCode1>
  <LineCode2>OR</LineCode2>
  <LineCode3 i:nil="true" />
  <LineCode4 i:nil="true" />
  <Lon>-77.0280779971</Lon>
  <Name>Metro Center</Name>
  <StationTogether1>A01</StationTogether1>
  <StationTogether2 />
</Station>
<Station>
  <Code>A01</Code>
  <Lat>38.8983144732</Lat>
  <LineCode1>RD</LineCode1>
  <LineCode2 i:nil="true" />
  <LineCode3 i:nil="true" />
  <LineCode4 i:nil="true" />
  <Lon>-77.0280779971</Lon>
  <Name>Metro Center</Name>
  <StationTogether1>C01</StationTogether1>
  <StationTogether2 />
</Station>
... 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-28T15:45:34.207

使用此示例 XML：

```
<?xml version="1.0"?>
<Station>
  <Code>C02</Code>
  <Lat>38.9013327968</Lat>
  <LineCode1>BL</LineCode1>
  <LineCode2>OR</LineCode2>
  <LineCode3 i:nil="true" />
  <LineCode4 i:nil="true" />
  <Lon>-77.0336341721</Lon>
  <Name>McPherson Square</Name>
  <StationTogether1 />
  <StationTogether2 />
</Station> 
```

从`[element content]`变为`[element text]`，这是我的输出：

> 麦弗逊广场

看起来你可以使用`[element text]`. [请参考这个类似的问题/答案](https://stackoverflow.com/questions/11920530/when-i-use-the-tfhpple-parser-html-on-iphone-and-already-find-the-node-but-th/13608230#13608230)。

我希望它有所帮助。

# android - setFillAfter 不工作？

> ID：10703888
> 
> 赞同：3
> 
> 时间：2012-05-22T14:15:24.407
> 
> 标签：android, animation, translate-animation

我正在使用这段代码：

```
 public class Main extends Activity {
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

 final   LinearLayout answerLayout=(LinearLayout)findViewById(R.id.answerlayout);

    Button slideAnswer=(Button)findViewById(R.id.answerslide);
    slideAnswer.setOnClickListener(new View.OnClickListener() {

    @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub

                TranslateAnimation slide = new TranslateAnimation(0,-400, 0,0 );   
                slide.setDuration(1000);   
                slide.setFillAfter(true);   
                slide.setFillEnabled(true);
                answerLayout.startAnimation(slide);  

        }
    });
} 
```

我只是希望 answerLayout 转换到新位置并留在那个地方并正常工作。但事实并非如此。有人可以发现错误并纠正我。或者为相同的问题提供不同的技术？

# c# - 阻止将操作添加到单词 undo redo 或从 undo redo CommandBarComboBox 中删除操作

> ID：10703893
> 
> 赞同：4
> 
> 时间：2012-05-22T14:15:38.563
> 
> 标签：c#, interop, office-interop, word-2010

我们正在以编程方式在 Word 文档中插入内容控件，并且我们不想将操作添加到 Word 的撤消堆栈中。我们发现的唯一方法是访问 undo commandbar-combobox 并删除与插入内容控制操作相关的项目，我们使用以下代码：

```
var commandBars = _wordDocument.CommandBars.Cast<CommandBar>();
var standardCommandBar = commandBars.First(bar => bar.Name.Equals("Standard"));
CommandBarComboBox undoControl = 
                     standardCommandBar.Controls
                     .Cast<CommandBarControl>()
                     .First(control => control.Id == 128) as CommandBarComboBox;

undoControl.RemoveItem(1); 
```

最后一行`undoControl.RemoveItem(1)`抛出 ComException `HRESULT E_FAIL`。

有没有办法从撤消重做组合框中删除操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2022-01-19T17:33:40.640

由于你的问题，我和你有同样的问题，但现在它已经解决了。

```
 var commandBars = WordDoc.CommandBars.Cast<CommandBar>();
  var standardCommandBar = commandBars.First(bar => bar.Name.Equals("Standard"));
  CommandBarComboBox undoControl = standardCommandBar.Controls
                   .Cast<CommandBarControl>()
                   .First(control => control.Id == 128) as CommandBarComboBox; 
```

您的代码将返回撤消列表中的最后一个对象。现在您可以根据您的要求添加检查。

```
 if (undoControl.accName.ToLower().Contains("range.case"))
            WordApp.ActiveDocument.Undo(3);
        else if (undoControl.accName.ToLower().Contains("font.reset"))
            WordApp.ActiveDocument.Undo(2);

        else WordApp.ActiveDocument.Undo(1); 
```

[微软Word](https://i.stack.imgur.com/e0iwC.png)

# ios - 在选定位置周围显示圆圈

> ID：10703898
> 
> 赞同：2
> 
> 时间：2012-05-22T14:15:48.727
> 
> 标签：ios, ios5, mkmapview, mkannotation, cllocation

正如我们所见，iOS mkmapview 中的当前位置周围有一个圆圈。有没有办法在 mkmapview 中为当前位置以外的位置绘制一个类似的圆圈？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-30T18:27:06.273

如果您查看 MKCircle 的文档：http: [//developer.apple.com/library/ios/#documentation/MapKit/Reference/MKCircle_class/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/MapKit/Reference/MKCircle_class/Reference/Reference.html)和 MKCircleView：http: [//developer.apple.com/ library/iOS/documentation/MapKit/Reference/MKCircleView_class/Reference/Reference.html](http://developer.apple.com/library/iOS/documentation/MapKit/Reference/MKCircleView_class/Reference/Reference.html)
这两个都是 MapKit API 的一部分，你会发现画圆的工具！正如此链接中提到的，[围绕 MKMapView 上的一个点圈，](https://stackoverflow.com/questions/7369073/circle-around-a-point-on-an-mkmapview) 没有简单的方法可以为这些圆圈创建动画，但优点是它们将为您在地图上的坐标提供一定程度的准确性！以一种方式创建圆圈的步骤如下：[在 mapkit 上绘制圆圈](https://stackoverflow.com/questions/5563093/drawing-a-circle-on-mapkit)
基本上，使用 circleWithCenterCoordinate:radius: 方法创建一个 MKCircle 对象并将其添加到您的 mapView（使用 addOverlay: 方法）
接下来，在 mapView 委托中，实现 mapView:viewForOverlay: 方法，在那里创建和设置 MKCircleView 实例并返回它。

# java - 休眠注释和连接

> ID：10703904
> 
> 赞同：0
> 
> 时间：2012-05-22T14:16:08.597
> 
> 标签：java, hibernate, annotations

我正在尝试使用休眠从我的数据库中检索数据...我有一个查询，它使用左连接连接两个表（所有字段都是一对一的）。我需要知道如何使用休眠和注释来处理这个问题。我创建了两个映射到表的类，我试图弄清楚如何使用连接......Hibernate 文档令人困惑......

//一个类

```
@Entity
@Table(name = "Class1")
public class Class1{

 @Id
 @Column(name = "INITIAL")
 private String initial;

  @Column(name = "NUMBER")
  private Integer number; 
```

...

//双类

```
@Entity
@Table(name = "Class2")
public class Class2{

 @Column(name = "STATE")
 private String state;

  @Id   
  @Column(name = "NUMBER")
  private Integer number 
```

...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T14:26:17.930

```
@Entity
@Table(name = "Class1")
public class Class1 {
   @Id
   @Column(name = "INITIAL")
   private String initial;

   @Column(name = "NUMBER")
   private Integer number;  
}

@Entity
@Table(name = "Class2")
public class Class2 {
   @Id
   @Column(name = "STATE")
   private String state;

   @Column(name = "NUMBER")
   private Integer number

   @OneToOne
   @JoinColumn(name = "columnWithClass1id")
   private Class1 class1;
} 
```

# javascript - 前景图像/文本纹理

> ID：10703905
> 
> 赞同：1
> 
> 时间：2012-05-22T14:16:11.333
> 
> 标签：javascript, css, image, text, background

文本本身的背景图像层是否有任何 JS/CSS 解决方案？

**例子**

![在此处输入图像描述](../Images/efb84f0a5dd83261784cbe366ff1b993.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:18:23.573

检查这个[http://lea.verou.me/2012/05/text-masking-the-standards-way/](http://lea.verou.me/2012/05/text-masking-the-standards-way/)

# c# - 将数据库模式从数据库导入数据集（使用 DataRelations）

> ID：10703911
> 
> 赞同：0
> 
> 时间：2012-05-22T14:16:29.753
> 
> 标签：c#, .net, ado.net, dataset

我正在尝试使用 VS2010 和 .Net Framework 4 将 NorthWind 数据库的架构导入 DataSet。

我尝试使用设计器和 FillSchema 方法，但这些方法都不允许我导入关系，因此我必须在设计器上手动指定它们或通过代码。

关系信息位于数据库模式中。

有没有人在没有一一指定的情况下成功检索了所有关系？

PS：我正在通过 ODBC 访问数据库（经过测试的 postgresql 和 MDB 驱动程序）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-26T01:41:48.727

虽然我没有使用 NorthWind，但使用 MSQL 执行此操作的步骤如下

1.  在数据库本身中创建数据关系

2.  在 Visual Studio 中，转到“数据源”窗口（查看 > 其他窗口 > 数据源或 Shift-alt-D）

3.  单击添加新数据源图标，这将打开[数据源配置向导](http://msdn.microsoft.com/en-us/library/vstudio/w4dd7z6t.aspx)

> 数据源配置向导在您的应用程序中创建和编辑数据源。这些数据源可以来自数据库、服务或对象。

1.  一旦您按照上面链接上的说明选择 a `Database`，并选择 a 的数据库模型`dataset`，给它一个连接字符串并选择您的表，您应该会在数据集的解决方案中看到一个文件。打开它以查看数据库图表，其中将包含您的数据库关系，也就是外键。

# objective-c - 在 iOS 上显示克林贡文字

> ID：10703913
> 
> 赞同：2
> 
> 时间：2012-05-22T14:16:46.693
> 
> 标签：objective-c, cocoa-touch, unicode

是否可以在 iOS 上显示克林贡文字（不一定是可编辑的）？

如果是，推荐的方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T14:32:50.903

有人提出了[克林贡语](http://www.evertype.com/standards/csur/klingon.html)到 Unicode 私有使用区域的“标准”映射。您需要做的就是为克林贡语[找到一种字体](http://www.google.com/search?client=safari&rls=en&q=klingon%20truetype%20font&ie=UTF-8&oe=UTF-8)（或使用位图），然后就可以走了。将[字体](https://stackoverflow.com/questions/360751/can-i-embed-a-custom-font-in-an-iphone-application)安装到设备上需要做一些工作。

# php - 从浏览器保存为 UTF-8 编码与 ANSI 编码的文件 - 为什么？

> ID：10703915
> 
> 赞同：0
> 
> 时间：2012-05-22T14:16:47.510
> 
> 标签：php, excel, encoding, utf-8, ansi

我有两个正在开发的网站（在 PHP 中）。他们使用相同的代码来提供 XLS 导出（使用 PEAR excel），并且它们在同一本地服务器上运行。为了排除 xls 中实际数据的问题，我现在只是输出一个没有数据的文件。

当我从站点 A 导出并保存文件时，它报告为在 Notepad++ 中编码的“ANSI”。此文件在 Excel 中正确打开。

当我从站点 B 导出时，该文件被报告为“UTF-8”编码，该文件不会在 Excel 中打开。如果我在 Textpad++ 中将文件转换为没有 BOM 的 ANSI 或 UTF-8，它在 Excel 中打开得很好。

当我在站点上保存任意页面时，站点 A 和 B 之间存在相同的编码差异，因此我认为它可能比生成 Excel 文件的方式更基本（导出 CSV/ODS 格式时的编码相同）。我在导出过程中比较了站点 A 和 B 之间的 http 标头，它们在功能上是相同的。将 Charset=ISO-8859-1 显式添加到标头没有任何区别。站点之间的 apache 虚拟主机在功能上也是相同的。两个站点都在其数据库中使用相同的字符编码（但由于我现在没有导出任何数据，这无关紧要）。

还有什么可能导致我没有考虑到这一点？

谢谢！

**更新**

excel 一代是一个红鲱鱼，我已经删除了所有这些，只是输出了下载标题和一个测试字符串。保存后，文件在站点之间的编码仍然不同。当我比较各种文件时，生成下载文件的代码似乎相同......

我无法通过创建一个简化的测试用例来重复这个问题。当我尝试时，两个站点都输出保存为 ANSI 的文件——我不明白还会发生什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T23:34:09.433

Thanks for all your input into this, it's much appreciated. In the end I tracked it down, a PHP source file was being included somewhere along the way which was encoded UTF-8 rather than ANSI (Windows-1252). I don't really understand why this causes a problem though, since that PHP include doesn't output anything. Very weird and very frustrating, I hope maybe someone else finds my pain useful.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T14:26:10.737

**ANSI** “模式”只是使用系统上的语言表来保存数据；您不能确定保存的文档对其他人可见。

**没有 BOM**的UTF-8表示 utf8，但没有附加一些奇怪的 utf 字符（我认为在文件顶部有 2 或 3 个），可能会导致 excel 头痛。

如果我想*i18n*，我总是*不带 bom方法*

# php - Doctrine : One to one to one relation?

> ID：10703917
> 
> 赞同：0
> 
> 时间：2012-05-22T14:16:55.993
> 
> 标签：php, symfony, doctrine, entities, database-relations

I'm making entities for a Symfony2 project at work.

I'm trying to make a system that controls the access to certain resources in function of an organisation (a company) and of a role. To sum it up, roles are the same for all the companies, but a company may make a resource available for a role, as another may not want to.

As for resources, they represent some actions and contents, such as the creation of this, the edition of that, and so on...

I attempted to solve this problematic with the following entity. It represents a one to one to one relationship between my three entities Organisation, Role and Resource.

I wanted to know if that kind of relation was possible/good, or if there is another way to manage resources.

```
/**
 * @ORM\Entity
 */
class Organisation_Role_Resource
{
    /**
     * @ORM\Id
     * @ORM\ManyToOne(targetEntity="Aurae\UserBundle\Entity\Organisation")
     */
    private $organisation;

    /**
     * @ORM\Id
     * @ORM\ManyToOne(targetEntity="Aurae\UserBundle\Entity\Role")
     */
    private $role;

    /**
     * @ORM\Id
     * @ORM\ManyToOne(targetEntity="Aurae\UserBundle\Entity\Resource")
     */
    private $resource; 
```

Do you have any piece of advice on how to solve this problem?

Is there another/better way to represent resources (which are, in fact, pages and links) and to manage their access?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:27:38.737

While this might be quite valid approach you would be really reinventing the wheel.

Symfony2 has it all implemented already as '**Access Control Lists**' or (**ACL**):

[http://symfony.com/doc/current/cookbook/security/acl.html](http://symfony.com/doc/current/cookbook/security/acl.html)

Check it out.... I think it covers everything you need...

# google-drive-api - 从桌面应用程序访问 Google Drive

> ID：10703921
> 
> 赞同：3
> 
> 时间：2012-05-22T14:17:09.010
> 
> 标签：google-drive-api

> **可能重复：**
> [适用于 Google Drive 的 Android API？](https://stackoverflow.com/questions/10306456/android-api-for-google-drive)

我想在 Android 应用程序和单独的基于 Java 的独立桌面应用程序之间同步一个小 xml 文件。首先，用户在 Android 应用程序中按下一个按钮，xml 文件就会存储在云中的某个位置。接下来，用户启动独立桌面应用程序并从云中获取 xml 文件。

为此，我想使用 Google Drive。但是，我对 Google Drive 帮助页面中的以下内容感到困惑：

> 警告：仅授权不足以让您的应用访问用户文件——还需要安装应用。除非用户首先在 Chrome 网上应用店中安装了应用程序，否则应用程序将无法对文件进行任何 API 访问。

有没有办法直接从/向具有凭据的 Google Drive 抓取/写入文件？或者至少是一种对最终用户来说问题最少的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T16:16:56.137

目前，我们意识到这对于 Drive API 是不可行的，因为您需要为从 Chrome 网上应用店安装的客户端 ID 创建一个令牌。我们正在计划对此进行修复，但没有立即解决任何问题。在短期内，您应该使用 Documents List API。

# mysql - mysql 服务不会在 windows 2008 server r1 上启动

> ID：10703922
> 
> 赞同：1
> 
> 时间：2012-05-22T14:17:10.987
> 
> 标签：mysql, windows, windows-server-2008

大约一个月前，我在 mysql 管理员上更改了启动参数后，我的服务器被冻结了。所以我重新启动了。自从我的 mysql 服务不会在启动时或我尝试手动启动它时启动。我只能在控制台模式下启动 mysql (mysqld --console)。我尝试了很多东西，但都没有奏效：

*   我已卸载并重新启动服务器，然后再次安装；
*   我已删除程序文件夹中与 mysql 相关的所有内容并重新安装
*   我已删除 programdata 文件夹中的所有相关文件
*   我已经尝试使用 3307 端口而不是 3306 但仍然无法正常工作

现在，当我再次安装 mysql 时，它永远无法在安装过程中启动服务，因此它永远无法结束安装。但是我仍然可以使用“mysqld --console”在命令行上启动 mysql 服务器我试图查看事件 lgo，我看到的唯一错误是插件联合被禁用，我寻找有关此错误的解决方案，但没有一个对我有用. 我相信这可能是一些关于窗户的东西。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:38:39.070

卸载、删除和您在上面所做的所有清理工作。

另外手动删除 MySQL Windows 服务。这可以通过命令行使用`sc stop MySQL`then来完成`sc delete MySQL`。

在安装之前，不需要重新启动。

手动重新创建 Windows 服务，如果安装程序没有为您完成，可以使用`"C:\Program Files\MySQL\MySQL Server 5.1\bin\mysqld" --install`（如手册所述）完成。

如果 MySQL 安装程序安装了按需启动类型的服务，您可以使用以下命令编辑以在启动时自动启动：`sc config MySQL start= auto`（= 符号后的空格是有意的且需要的）。之后，您可以使用`sc start MySQL`.

# asp.net-mvc - NOPCommerce 广告集成

> ID：10703925
> 
> 赞同：1
> 
> 时间：2012-05-22T14:17:22.923
> 
> 标签：asp.net-mvc, iis, active-directory, nopcommerce

我正在使用 NOPCommerce 2.5 建立一个 Intranet 电子商务网站，我希望用户自动登录到该网站。网络上的每个人都被授权成为客户。NOPCommerce 是否有活动目录集成，或者是否有人有关于如何前进的提示和技巧？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T10:23:07.130

我知道 nopCommerce 使用他们自己的 ASP.net Membership Provider 实现。所以是的，可以对其进行编辑，并让它通过网络凭据自动生成一个 nopCommerce 用户。

我不知道此功能已经存在任何东西。

# deployment - 检测 Microsoft Office 已安装组件的安全方法是什么？

> ID：10703927
> 
> 赞同：2
> 
> 时间：2012-05-22T14:17:43.360
> 
> 标签：deployment, installation, office-2007

我正在寻找最安全的方法来检测给定工作站上安装了 Microsoft Office 的哪些组件（如果有）。我意识到这也可以被视为 Serverfault 的问题，但由于我将在脚本中使用它，而且这里的许多人更熟悉 Office 的内部工作，我认为这将是最好的提问地方。

我查看了卸载键，但它显示了系统上实际不存在的组件。我相信这与 Office 在首次访问时安装组件的方式有关。我不喜欢寻找可执行文件，因为理论上路径可以改变。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-09T18:03:49.337

考虑到 32 位和 64 位 Windows 安装之间的差异，我最终测试了特定的注册表项。我正在关注以下注册表位置/值：

*   `HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Office\12.0\`— 64 位 Windows 安装上的基本 Office12 密钥
*   `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\12.0\`— 32 位 Windows 安装上的基本 Office12 位置
*   *`Office base path`*`\Outlook\InstallRoot\Path`— 表示 Outlook 安装路径的键
*   *`Office base path`*`\Registration\{90120000-0012-0000-0000-0000000FF1CE}`—Office 12 标准 GUID 的密钥
*   *`Office base path`*`\Registration\{90120000-0011-0000-0000-0000000FF1CE}`—Office 12 Professional Plus GUID 的密钥

有了这些位置，我已经能够：

1.  检测是否安装了Office。
2.  检测已安装的 Office 版本。
3.  检测是否安装了 Outlook。

我没有尝试过比这更细化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T04:28:00.393

如果您真的认为您不能依赖 exe 或 dll 的路径，我会在安装各种组件的快照之前和之后比较注册表（存在许多用于此目的的工具）。然而，根据我的经验，我发现有必要测试 dll 和其他文件的存在以检测已安装的 Office 组件（例如，我必须测试 VBA dll 以检测是否存在已安装的 Visual Basic 模块）。文件的路径只能改变这么多。您只需要了解 32 位和 64 位修补程序，以及 winxp 和 win7 路径。

# android - 加速度计数据与振动不良

> ID：10703932
> 
> 赞同：4
> 
> 时间：2012-05-22T14:17:58.237
> 
> 标签：android, accelerometer

我正在开发一个自行车电脑应用程序。我希望使用加速度计计算出斜坡的倾斜度，但事情并不顺利。

我已经输入了测试代码来获取传感器数据，我只是以 UI 速率进行扫描，并保持 128 个样本的移动平均值，这大约是 6 秒的价值。拿着手机，数据很好，与校准平面矢量相比，我可以计算出一个很好的角度。

将电话安装在自行车上时，情况一点都不好。我希望得到一点噪音，但我希望大时间窗口内的大量样本能够消除振动效应和一般的自行车运动。不幸的是，这不起作用，加速度矢量的幅度并没有真正保持在 9.8 左右，而是下降得更低，这对我来说表明某处有问题。

这是来自部分试驾的数据图。 ![在此处输入图像描述](../Images/af80bf1dbf05754c909ac7c8e7db3025.png)

正如你所看到的，当开始时静止时，幅度还可以，但一旦我开始，它就会下降。我相当确定问题与振动有关。我最初下降时振动很大，然后爬升，振动较小，震级回到 9.8，但随后我在糟糕的道路上迅速下降，震级小于 3 .

这是与使用[BMA250 传感器](http://www.bosch-sensortec.com/content/language1/downloads/BST-BMA250-DS002-02.pdf)的 SonyErricson Xperia Active 一起使用的，datasheat 看起来传感器应该有能力。我对问题原因的唯一理论是范围设置为 2g 范围并且振动导致数据超出范围，这导致了我的问题。

有没有人见过这样的事情？有没有人对问题的原因有任何想法？
有什么方法可以改变我没有找到的敏感度吗？

附加信息。

好的，我在过滤之前记录了原始传感器数据。这里展示了一个非常小 ![原始数据的小样本](../Images/d0a24ff1040f5cc77f1f509323c9498d.png) 的部分 主轴是绿色的，并且在我相信这应该没有振动的情况下它应该是大约 8.5 的平面上。数据没有明显的限制，但我得到的低于 8.5 的值多于高于 8.5 的值。即使传感器设置为最灵敏的 2g 范围，它看起来振动应该没问题 我这里的最大值刚刚超过 15 并且最小值为 -10 以及 +- 20 ragnge 只是没有正确居中在8.5应该是。

我会挖出我的另一部手机，它看起来有一个稍微不同的传感器 BMA150 并尝试使用它，但除非它是完美的，否则我认为我将不得不放弃这个想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-01T00:46:42.033

几年前，我使用相同的手机，巧合的是，应用程序的平均间隔为 6 秒，我不记得在图表中看到过这种行为。

我想知道问题是否在于 6 秒平均值的累积方式。我遇到的一个问题是采样间隔不是恒定的，而是取决于处理器的繁忙程度。在指定时间获取样本，但事件处理程序的调用取决于调度程序。当处理器空载时，采样以恒定频率发生，但随着处理器工作得更努力，采样频率变得更慢且更不稳定。您可以编写应用程序以在采样时保持低处理器负载。我们所做的是采样 6 秒，什么都不做，然后停止采样并处理最后一个示例集，但这只是部分成功，因为您无法控制同时运行的其他应用程序，并且调度程序在它们之间共享处理器资源全部。在 Xperia Active 上，我发现它偶尔会在样本之间出现几秒钟，我将其归因于其中一个 JVM 中的垃圾收集。我们的解决方案是为每个样本打上时间戳，然后对样本集进行一些质量检查，并丢弃那些未能通过质量检查的样本。这是一个糟糕的解决方案，因为定义什么足够好是不精确的，并且当用户运行另一个使用大量资源的应用程序时，大多数样本集可能会被丢弃，因此应用程序需要额外的逻辑来处理它。

[当前在 Xperia Active 上不可用的 Android API 应该已经消除了这一点，因为可以按照https://source.android.com/devices/sensors/hal-interface.html#batch_sensor_flags_sampling_period_maximum_report_latency](https://source.android.com/devices/sensors/hal-interface.html#batch_sensor_flags_sampling_period_maximum_report_latency)中的描述对样本进行批处理。

如果算法假设特定数量的样本而不是对它们进行计数，并且随着自行车的速度越来越快，处理器会更加努力地工作，尽管我不确定为什么会这样，但它会产生类似于第一张图的东西，因为当自行车下坡时的幅度下降，上山时上升。那里有很多猜测，但从我使用此传感器的经验来看，6 秒的平均值给出的幅度小于 3 m/s^2 看起来不可信。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T14:30:44.400

我怀疑加速度计在如此大的 G 范围内不是线性的。如果是这样，并且如果有任何不对称，它会做你所看到的。

解决方案是将加速度计支架垫多一点，泡沫橡胶，蹦极绳，无论如何，可能将其安装在更重的舞台上以更多地过滤振动。

或者（不是一个好的解决方案）尝试对错误进行建模并对其进行补偿。

# mongodb - 通过 mongos 路由器在多个服务器中拆分 MongoDB 集合

> ID：10703934
> 
> 赞同：4
> 
> 时间：2012-05-22T14:18:06.257
> 
> 标签：mongodb, cloud, mongoid, mongomapper, nosql

有一个名为 MongoDB 的数据库`maindatabase`，它有 3 个名为用户、标签和类别的文档集合，我想知道是否可以将它们分别拆分在三个不同的服务器上（在不同的云服务提供商上）。

我的意思不是作为副本，而是只有一个服务器集合（一个数据库在服务器上只有类别集合，一个在另一台服务器上具有用户，一个在第三台服务器上用于标签）可以由 mongos 路由器有选择地路由。

有谁知道这是否可能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T03:27:27.827

除了@matulef 关于通过 手动操作数据库的答案之外`movePrimary`，也许这需要一个更简单的解决方案，即只维护 3 个数据库连接：每台服务器一个，每个位于您最初指定的不同云提供商的数据中心。您不会拥有单个`mongos`连接点的简单性，但通过您的三个连接，您可以直接在它们各自的连接上操作`users`、`tags`和。`categories`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T18:52:02.090

不幸的是，您目前不能以这种方式将集合拆分到单个数据库中。但是，如果您将每个集合放在不同的数据库中，则可以执行此操作。在分片系统中，每个数据库都有一个与之关联的“主分片”，该数据库上的所有非分片集合都存在于其中。如果您将 3 个集合分成 3 个不同的数据库，则可以使用“movePrimary”命令将它们单独移动到不同的分片：

[http://www.mongodb.org/display/DOCS/movePrimary+Command](http://www.mongodb.org/display/DOCS/movePrimary+Command)

但是，创建更多数据库会产生一些开销，因此尚不清楚这是否是满足您需求的最佳解决方案。

# google-app-engine - Google App Engine 上的栎树

> ID：10703936
> 
> 赞同：1
> 
> 时间：2012-05-22T14:18:10.363
> 
> 标签：google-app-engine, quercus

我在谷歌应用引擎上错误地添加了 Quercus，它给了我错误。

这是我的 web.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns="http://java.sun.com/xml/ns/javaee"
xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
xsi:schemaLocation="http://java.sun.com/xml/ns/javaee
http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" version="2.5">
<servlet>
    <servlet-name>QueAttempt</servlet-name>
    <servlet-class>com.que.attempt.QueAttemptServlet</servlet-class>
</servlet>
<servlet-mapping>
    <servlet-name>QueAttempt</servlet-name>
    <url-pattern>/queattempt</url-pattern>
</servlet-mapping>
<welcome-file-list>
    <welcome-file>index.html</welcome-file>
</welcome-file-list>

 <servlet>
<servlet-name>Quercus Servlet</servlet-name>
<servlet-class>com.caucho.quercus.servlet.QuercusServlet</servlet-class>

   <init-param>
     <param-name>license-directory</param-name>
     <param-value>WEB-INF/licenses</param-value>
   </init-param>
 </servlet>

    <servlet-mapping>
      <servlet-name>Quercus Servlet</servlet-name>
    <url-pattern>*.php</url-pattern>
      </servlet-mapping>

 <welcome-file-list>
  <welcome-file>index.php</welcome-file>
   </welcome-file-list>

</web-app> 
```

这是我的 appengine-web.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<appengine-web-app xmlns="http://appengine.google.com/ns/1.0">
<application></application>
<version>1</version>

 <threadsafe>true</threadsafe>

 <system-properties>
<property name="java.util.logging.config.file" value="WEB-INF/logging.properties"/> 
```

```
 <static-files>
    <include path="/**" expiration="600s" />
    <include path="/**.png" expiration="30d" />
    <include path="/**.jpg" expiration="30d" />
    <include path="/**.gif" expiration="30d" />
    <include path="/**.ico" expiration="30d" />
    <include path="/**.swf" expiration="30d" />
    <include path="/**.css" expiration="7d" />
    <include path="/**.js" expiration="2d 12h" />
    <exclude path="/**.php" />
    <exclude path="/**.inc" />
  </static-files>

  <resource-files>
    <include path="/**.php" />
    <include path="/**.inc" />
  </resource-files>

</appengine-web-app> 
```

对于 quercus-4.0.25\WEB-INF\lib 中的文件，我手动复制粘贴到

C:\QueAttempt\war\WEB-INF\lib.

完成所有这些后，我在 localhost 上访问该应用程序并出现错误消息。

该网页显示一行错误，即：

```
java.lang.NoClassDefFoundError: Could not initialize class com.caucho.util.Alarm 
```

控制台上显示的错误是：

```
WARNING: Error for /
java.lang.ExceptionInInitializerError
at java.lang.Class.forName0(Native Method)
at java.lang.Class.forName(Unknown Source)
at   com.google.appengine.tools.development.agent.runtime.RuntimeHelper.checkRestricted(RuntimeHelper.java:69)
at com.google.appengine.tools.development.agent.runtime.Runtime.checkRestricted(Runtime.java:64)
at com.caucho.quercus.page.PageManager.<init>(PageManager.java:61)
at com.caucho.quercus.QuercusContext.createPageManager(QuercusContext.java:380)
at com.caucho.quercus.QuercusContext.<init>(QuercusContext.java:250)
at com.caucho.quercus.GoogleQuercus.<init>(GoogleQuercus.java:61)
at com.caucho.quercus.servlet.GoogleQuercusServletImpl.getQuercus(GoogleQuercusServletImpl.java:279)
at com.caucho.quercus.servlet.QuercusServletImpl.init(QuercusServletImpl.java:89)
at com.caucho.quercus.servlet.QuercusServlet.initImpl(QuercusServlet.java:531)
at com.caucho.quercus.servlet.QuercusServlet.init(QuercusServlet.java:441)
at org.mortbay.jetty.servlet.ServletHolder.initServlet(ServletHolder.java:440)
at org.mortbay.jetty.servlet.ServletHolder.getServlet(ServletHolder.java:339)
at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:487)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1166)
at com.google.appengine.tools.development.BackendServersFilter.doFilter(BackendServersFilter.java:97)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:388)
at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
at com.google.appengine.tools.development.DevAppEngineWebAppContext.handle(DevAppEngineWebAppContext.java:78)
at org.mortbay.jetty.servlet.Dispatcher.forward(Dispatcher.java:327)
at org.mortbay.jetty.servlet.Dispatcher.forward(Dispatcher.java:126)
at com.google.appengine.tools.development.StaticFileUtils.serveWelcomeFileAsForward(StaticFileUtils.java:80)
at com.google.appengine.tools.development.LocalResourceFileServlet.maybeServeWelcomeFile(LocalResourceFileServlet.java:247)
at com.google.appengine.tools.development.LocalResourceFileServlet.doGet(LocalResourceFileServlet.java:120)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:617)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)
at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:390)
at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
at com.google.appengine.tools.development.DevAppEngineWebAppContext.handle(DevAppEngineWebAppContext.java:78)
at org.mortbay.jetty.servlet.Dispatcher.forward(Dispatcher.java:224)
at org.mortbay.jetty.servlet.Dispatcher.forward(Dispatcher.java:126)
at com.google.appengine.tools.development.StaticFileUtils.serveWelcomeFileAsForward(StaticFileUtils.java:80)
at com.google.appengine.tools.development.StaticFileFilter.maybeServeWelcomeFile(StaticFileFilter.java:197)
at com.google.appengine.tools.development.StaticFileFilter.doFilter(StaticFileFilter.java:96)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.appengine.tools.development.BackendServersFilter.doFilter(BackendServersFilter.java:97)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:388)
at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
at com.google.appengine.tools.development.DevAppEngineWebAppContext.handle(DevAppEngineWebAppContext.java:78)
at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
at com.google.appengine.tools.development.JettyContainerService$ApiProxyHandler.handle(JettyContainerService.java:369)
at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
at org.mortbay.jetty.Server.handle(Server.java:326)
at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:923)
at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:547)
at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:212)
at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:409)
at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582)
Caused by: java.security.AccessControlException: access denied (java.lang.RuntimePermission modifyThreadGroup)
at java.security.AccessControlContext.checkPermission(Unknown Source)
at java.security.AccessController.checkPermission(Unknown Source)
at java.lang.SecurityManager.checkPermission(Unknown Source)
at com.google.appengine.tools.development.DevAppServerFactory$CustomSecurityManager.checkPermission(DevAppServerFactory.java:252)
at com.google.appengine.tools.development.DevAppServerFactory$CustomSecurityManager.checkAccess(DevAppServerFactory.java:277)
at java.lang.ThreadGroup.checkAccess(Unknown Source)
at java.lang.Thread.init(Unknown Source)
at java.lang.Thread.<init>(Unknown Source)
at com.caucho.env.thread.ThreadLauncher.startWorkerThread(ThreadLauncher.java:125)
at com.caucho.env.thread.AbstractTaskWorker.wake(AbstractTaskWorker.java:118)
at com.caucho.env.thread.AbstractThreadLauncher.update(AbstractThreadLauncher.java:453)
at com.caucho.env.thread.ThreadLauncher.setPriorityIdleMin(ThreadLauncher.java:74)
at com.caucho.env.thread.ThreadLauncher.<init>(ThreadLauncher.java:64)
at com.caucho.env.thread.ThreadPool.<init>(ThreadPool.java:136)
at com.caucho.env.thread.ThreadPool.<init>(ThreadPool.java:129)
at com.caucho.env.thread.ThreadPool.getThreadPool(ThreadPool.java:156)
at com.caucho.util.AlarmClock.<init>(AlarmClock.java:65)
at com.caucho.util.Alarm.<clinit>(Alarm.java:68)
... 63 more
May 23, 2012 11:36:27 AM com.google.apphosting.utils.jetty.JettyLogger warn
WARNING: Nested in java.lang.ExceptionInInitializerError:
java.security.AccessControlException: access denied (java.lang.RuntimePermission modifyThreadGroup)
at java.security.AccessControlContext.checkPermission(Unknown Source)
at java.security.AccessController.checkPermission(Unknown Source)
at java.lang.SecurityManager.checkPermission(Unknown Source)
at com.google.appengine.tools.development.DevAppServerFactory$CustomSecurityManager.checkPermission(DevAppServerFactory.java:252)
at com.google.appengine.tools.development.DevAppServerFactory$CustomSecurityManager.checkAccess(DevAppServerFactory.java:277)
at java.lang.ThreadGroup.checkAccess(Unknown Source)
at java.lang.Thread.init(Unknown Source)
at java.lang.Thread.<init>(Unknown Source)
at com.caucho.env.thread.ThreadLauncher.startWorkerThread(ThreadLauncher.java:125)
at com.caucho.env.thread.AbstractTaskWorker.wake(AbstractTaskWorker.java:118)
at com.caucho.env.thread.AbstractThreadLauncher.update(AbstractThreadLauncher.java:453)
at com.caucho.env.thread.ThreadLauncher.setPriorityIdleMin(ThreadLauncher.java:74)
at com.caucho.env.thread.ThreadLauncher.<init>(ThreadLauncher.java:64)
at com.caucho.env.thread.ThreadPool.<init>(ThreadPool.java:136)
at com.caucho.env.thread.ThreadPool.<init>(ThreadPool.java:129)
at com.caucho.env.thread.ThreadPool.getThreadPool(ThreadPool.java:156)
at com.caucho.util.AlarmClock.<init>(AlarmClock.java:65)
at com.caucho.util.Alarm.<clinit>(Alarm.java:68)
at java.lang.Class.forName0(Native Method)
at java.lang.Class.forName(Unknown Source)
at com.google.appengine.tools.development.agent.runtime.RuntimeHelper.checkRestricted(RuntimeHelper.java:69)
at com.google.appengine.tools.development.agent.runtime.Runtime.checkRestricted(Runtime.java:64)
at com.caucho.quercus.page.PageManager.<init>(PageManager.java:61)
at com.caucho.quercus.QuercusContext.createPageManager(QuercusContext.java:380)
at com.caucho.quercus.QuercusContext.<init>(QuercusContext.java:250)
at com.caucho.quercus.GoogleQuercus.<init>(GoogleQuercus.java:61)
at com.caucho.quercus.servlet.GoogleQuercusServletImpl.getQuercus(GoogleQuercusServletImpl.java:279)
at com.caucho.quercus.servlet.QuercusServletImpl.init(QuercusServletImpl.java:89)
at com.caucho.quercus.servlet.QuercusServlet.initImpl(QuercusServlet.java:531)
at com.caucho.quercus.servlet.QuercusServlet.init(QuercusServlet.java:441)
at org.mortbay.jetty.servlet.ServletHolder.initServlet(ServletHolder.java:440)
at org.mortbay.jetty.servlet.ServletHolder.getServlet(ServletHolder.java:339)
at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:487)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1166)
at com.google.appengine.tools.development.BackendServersFilter.doFilter(BackendServersFilter.java:97)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:388)
at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
at com.google.appengine.tools.development.DevAppEngineWebAppContext.handle(DevAppEngineWebAppContext.java:78)
at org.mortbay.jetty.servlet.Dispatcher.forward(Dispatcher.java:327)
at org.mortbay.jetty.servlet.Dispatcher.forward(Dispatcher.java:126)
at com.google.appengine.tools.development.StaticFileUtils.serveWelcomeFileAsForward(StaticFileUtils.java:80)
at com.google.appengine.tools.development.LocalResourceFileServlet.maybeServeWelcomeFile(LocalResourceFileServlet.java:247)
at com.google.appengine.tools.development.LocalResourceFileServlet.doGet(LocalResourceFileServlet.java:120)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:617)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)
at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:390)
at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
at com.google.appengine.tools.development.DevAppEngineWebAppContext.handle(DevAppEngineWebAppContext.java:78)
at org.mortbay.jetty.servlet.Dispatcher.forward(Dispatcher.java:224)
at org.mortbay.jetty.servlet.Dispatcher.forward(Dispatcher.java:126)
at com.google.appengine.tools.development.StaticFileUtils.serveWelcomeFileAsForward(StaticFileUtils.java:80)
at com.google.appengine.tools.development.StaticFileFilter.maybeServeWelcomeFile(StaticFileFilter.java:197)
at com.google.appengine.tools.development.StaticFileFilter.doFilter(StaticFileFilter.java:96)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.appengine.tools.development.BackendServersFilter.doFilter(BackendServersFilter.java:97)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:388)
at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
at com.google.appengine.tools.development.DevAppEngineWebAppContext.handle(DevAppEngineWebAppContext.java:78)
at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
at com.google.appengine.tools.development.JettyContainerService$ApiProxyHandler.handle(JettyContainerService.java:369)
at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
at org.mortbay.jetty.Server.handle(Server.java:326)
at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:923)
at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:547)
at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:212)
at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:409)
at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582)
May 23, 2012 11:36:32 AM com.caucho.quercus.servlet.GoogleQuercusServletImpl service
WARNING: java.lang.NoClassDefFoundError: Could not initialize class com.caucho.util.Alarm
java.lang.NoClassDefFoundError: Could not initialize class com.caucho.util.Alarm
at java.lang.Class.forName0(Native Method)
at java.lang.Class.forName(Unknown Source)
at com.google.appengine.tools.development.agent.runtime.RuntimeHelper.checkRestricted(RuntimeHelper.java:69)
at com.google.appengine.tools.development.agent.runtime.Runtime.checkRestricted(Runtime.java:64)
at com.caucho.quercus.page.PageManager.<init>(PageManager.java:61)
at com.caucho.quercus.QuercusContext.createPageManager(QuercusContext.java:380)
at com.caucho.quercus.QuercusContext.<init>(QuercusContext.java:250)
at com.caucho.quercus.GoogleQuercus.<init>(GoogleQuercus.java:61)
at com.caucho.quercus.servlet.GoogleQuercusServletImpl.getQuercus(GoogleQuercusServletImpl.java:279)
at com.caucho.quercus.servlet.GoogleQuercusServletImpl.service(GoogleQuercusServletImpl.java:154)
at com.caucho.quercus.servlet.QuercusServlet.service(QuercusServlet.java:594)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1166)
at com.google.appengine.tools.development.BackendServersFilter.doFilter(BackendServersFilter.java:97)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:388)
at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
at com.google.appengine.tools.development.DevAppEngineWebAppContext.handle(DevAppEngineWebAppContext.java:78)
at org.mortbay.jetty.servlet.Dispatcher.forward(Dispatcher.java:327)
at org.mortbay.jetty.servlet.Dispatcher.forward(Dispatcher.java:126)
at com.google.appengine.tools.development.StaticFileUtils.serveWelcomeFileAsForward(StaticFileUtils.java:80)
at com.google.appengine.tools.development.LocalResourceFileServlet.maybeServeWelcomeFile(LocalResourceFileServlet.java:247)
at com.google.appengine.tools.development.LocalResourceFileServlet.doGet(LocalResourceFileServlet.java:120)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:617)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)
at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:390)
at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
at com.google.appengine.tools.development.DevAppEngineWebAppContext.handle(DevAppEngineWebAppContext.java:78)
at org.mortbay.jetty.servlet.Dispatcher.forward(Dispatcher.java:224)
at org.mortbay.jetty.servlet.Dispatcher.forward(Dispatcher.java:126)
at com.google.appengine.tools.development.StaticFileUtils.serveWelcomeFileAsForward(StaticFileUtils.java:80)
at com.google.appengine.tools.development.StaticFileFilter.maybeServeWelcomeFile(StaticFileFilter.java:197)
at com.google.appengine.tools.development.StaticFileFilter.doFilter(StaticFileFilter.java:96)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at com.google.appengine.tools.development.BackendServersFilter.doFilter(BackendServersFilter.java:97)
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:388)
at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
at com.google.appengine.tools.development.DevAppEngineWebAppContext.handle(DevAppEngineWebAppContext.java:78)
at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
at com.google.appengine.tools.development.JettyContainerService$ApiProxyHandler.handle(JettyContainerService.java:369)
at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
at org.mortbay.jetty.Server.handle(Server.java:326)
at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:923)
at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:547)
at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:212)
at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:409)
at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582) 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T19:35:37.693

What version are you using? You should be using the latest version (4.0.30, resin.jar from resin-4.0.30/lib).

# javascript - 如何使用 jQuery TinyMCE 创建自定义列表框？

> ID：10703939
> 
> 赞同：2
> 
> 时间：2012-05-22T14:18:23.977
> 
> 标签：javascript, jquery, asp.net-mvc-3, tinymce, richtextediting

问题：

我使用 TinyMCE，**JQuery 版本**。

现在我想向工具栏添加一个**自定义列表框**，如下所示： [http ://www.tinymce.com/tryit/listbox_splitbutton.php#](http://www.tinymce.com/tryit/listbox_splitbutton.php#)

问题是，在示例中，它是没有 jQuery 的版本。我需要 jQuery。

到目前为止，我有一个自定义按钮工作，但不是列表框。
有人可以帮助我吗？

这是我到目前为止所拥有的：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Full featured example using jQuery plugin</title>

<!-- Load jQuery -->
<script type="text/javascript" src="http://www.google.com/jsapi"></script>
<script type="text/javascript" language="javascript">
    google.load("jquery", "1");
</script>

<!-- Load TinyMCE -->
<script type="text/javascript" src="../jscripts/tiny_mce/jquery.tinymce.js"></script>
<script type="text/javascript" language="javascript">

    $().ready(function () {

        $('textarea.tinymce').tinymce({
            // Location of TinyMCE script
            script_url: '../jscripts/tiny_mce/tiny_mce.js',

            // General options
            //theme: "simple",
            theme: "advanced",
            plugins: "autolink,lists,pagebreak,style,layer,table,save,advhr,advimage,advlink,emotions,iespell,inlinepopups,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,xhtmlxtras,template,advlist",

            // Theme options
            theme_advanced_buttons1: "save,newdocument,|,bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,styleselect,|,formatselect,fontselect,fontsizeselect,|,mybutton,fieldlist",
            theme_advanced_buttons2 : "cut,copy,paste,pastetext,pasteword,|,search,replace,|,bullist,numlist,|,outdent,indent,blockquote,|,undo,redo,|,link,unlink,anchor,image,cleanup,help,code,|,insertdate,inserttime,preview,|,forecolor,backcolor",
            theme_advanced_buttons3 : "tablecontrols,|,hr,removeformat,visualaid,|,sub,sup,|,charmap,emotions,iespell,media,advhr,|,print,|,ltr,rtl,|,fullscreen",
            theme_advanced_buttons4: "insertlayer,moveforward,movebackward,absolute,|,styleprops,|,cite,abbr,acronym,del,ins,attribs,|,visualchars,nonbreaking,template,pagebreak",
            theme_advanced_toolbar_location: "top",
            theme_advanced_toolbar_align: "left",
            theme_advanced_statusbar_location: "bottom",
            theme_advanced_resizing: true,

            // Example content CSS (should be your site CSS)
            content_css: "css/content.css",

            // Drop lists for link/image/media/template dialogs
            template_external_list_url: "lists/template_list.js",
            external_link_list_url: "lists/link_list.js",
            external_image_list_url: "lists/image_list.js",
            media_external_list_url: "lists/media_list.js",

            setup: function (ed) {
                // Add a custom button

                ed.addButton('mybutton', {
                    title: 'My button',
                    image: 'MyCoolBtn.png',
                    onclick: function () {
                        // Add you own code to execute something on click
                        ed.focus();
                        //ed.selection.setContent('Hello world!');
                        ed.selection.setContent('<tag>' + ed.selection.getContent() + '</tag>');
                    }
                });

                /*
                var mlb = ed.controlManager.createListBox('fieldlist',
                       {
                           title: 'Field List',
                           onselect: function (v) {
                               tinyMCE.execCommand('mceInsertContent', false, v);
                           }
                       });

                       mlb.add('Applicant First name', '{appfirstname}');
                       mlb.add('Applicant Last name', '{applastname}'); 
                       */

            }, // End Setup

            // Replace values for the template plugin
            template_replace_values: {
                username: "Some User",
                staffid: "991234"
            }
        });

        /*
        var ed = $('#elm1').tinymce();

        // http://stackoverflow.com/questions/1878418/tinymce-how-to-add-a-button-that-wraps-selected-text-with-a-tag
        // http://stackoverflow.com/questions/3486352/add-a-button-after-loading-tinymce-via-jquery-and-its-not-working
        // http://www.codestumps.com/2011/05/adding-tinymce-into-a-jquery-ui-dialog/
        ed.addButton('mybutton',
        { title: 'My button',
        'class': 'MyCoolBtn',
        image: 'MyCoolBtn.png',
        onclick: function () {
        // Add you own code to execute something on click  
        ed.focus();
        ed.selection.setContent('<tag>' + ed.selection.getContent() + '</tag>');
        }
        }); 
        */

    });
</script>
<!-- /TinyMCE -->

</head>
<body>

<form method="post" action="http://tinymce.moxiecode.com/dump.php?example=true">
    <div>
        <h3>Full featured example using jQuery plugin</h3>

        <p>
            This example shows how TinyMCE can be lazy loaded using jQuery. 
            The jQuery plugin will also attach it's self to various jQuery 
            methods to make it more easy to get/set editor contents etc.
        </p>

        <!-- Gets replaced with TinyMCE, remember HTML in a textarea should be encoded -->
        <div>
            <textarea id="elm1" name="elm1" rows="15" cols="80" style="width: 80%" class="tinymce">
                &lt;p&gt;
                    This is some example text that you can edit inside the &lt;strong&gt;TinyMCE editor&lt;/strong&gt;.
                &lt;/p&gt;
                &lt;p&gt;
                Nam nisi elit, cursus in rhoncus sit amet, pulvinar laoreet leo. 
                Nam sed lectus quam, ut sagittis tellus. 
                Quisque dignissim mauris a augue rutrum tempor. 
                Donec vitae purus nec massa vestibulum ornare sit amet id tellus. 
                Nunc quam mauris, fermentum nec lacinia eget, sollicitudin nec ante. 
                Aliquam molestie volutpat dapibus. Nunc interdum viverra sodales. 
                Morbi laoreet pulvinar gravida. Quisque ut turpis sagittis nunc accumsan vehicula. 
                Duis elementum congue ultrices. Cras faucibus feugiat arcu quis lacinia. 
                In hac habitasse platea dictumst. Pellentesque fermentum magna sit amet tellus varius ullamcorper. 
                Vestibulum at urna augue, eget varius neque. Fusce facilisis venenatis dapibus. 
                Integer non sem at arcu euismod tempor nec sed nisl. 
                Morbi ultricies, mauris ut ultricies adipiscing, felis odio condimentum massa, 
                et luctus est nunc nec eros.
                &lt;/p&gt;
            </textarea>
        </div>

        <!-- Some integration calls -->
        <a href="javascript:;" onclick="$('#elm1').tinymce().show();return false;">[Show]</a>
        <a href="javascript:;" onclick="$('#elm1').tinymce().hide();return false;">[Hide]</a>
        <a href="javascript:;" onclick="$('#elm1').tinymce().execCommand('Bold');return false;">[Bold]</a>
        <a href="javascript:;" onclick="alert($('#elm1').html());return false;">[Get contents]</a>
        <a href="javascript:;" onclick="alert($('#elm1').tinymce().selection.getContent());return false;">[Get selected HTML]</a>
        <a href="javascript:;" onclick="alert($('#elm1').tinymce().selection.getContent({format : 'text'}));return false;">[Get selected text]</a>
        <a href="javascript:;" onclick="alert($('#elm1').tinymce().selection.getNode().nodeName);return false;">[Get selected element]</a>
        <a href="javascript:;" onclick="$('#elm1').tinymce().execCommand('mceInsertContent',false,'<b>Hello world!!</b>');return false;">[Insert HTML]</a>
        <a href="javascript:;" onclick="$('#elm1').tinymce().execCommand('mceReplaceContent',false,'<b>{$selection}</b>');return false;">[Replace selection]</a>

        <br />
        <input type="submit" name="save" value="Submit" />
        <input type="reset" name="reset" value="Reset" />
    </div>
</form>

<script type="text/javascript" language="javascript">
/*
if (document.location.protocol == 'file:') {
    alert("The examples might not work properly on the local file system due to security settings in your browser. Please use a real webserver.");
}
*/
</script>

</body>
</html> 
```

# symfony - 如何应用名称存储在变量中的过滤器

> ID：10703941
> 
> 赞同：3
> 
> 时间：2012-05-22T14:18:28.400
> 
> 标签：symfony, twig

基本上，我正在寻找与`attribute()`对象和数组函数等效的过滤器。我希望能够应用一个过滤器，其名称存储在一个变量中。

```
{# 
    This works and is really useful 
    prints object.someVar 
#}
{% set varName = 'someVar' %}
{{ attribute(object,varName) }} 

{#
    The function "filter" does not exist
#}
{% set filterName = 'somefilter' %}
{{ filter(object,filterName) }} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-01T15:03:23.963

为了达到这个目标，你必须扩展你的 TwigFilter。

如何最初为您编写扩展程序，您可以[在此处](http://symfony.com/doc/current/cookbook/templating/twig_extension.html)阅读。

假设你已经创建了你的扩展，你已经定义了你的函数，比如说`applyFilter`.

```
//YourTwigFilterExtension.php

public function getFunctions()
{
    return array(
        ...
        'apply_filter' => new \Twig_Function_Method($this, 'applyFilter'),
    );
} 
```

然后，你必须定义这个函数

```
public function applyFilter($context, $filterName)
{
    // handle parameters here, by calling the 
    // appropriate filter and pass $context there
} 
```

完成此操作后，您将能够调用 Twig：

```
{{ apply_filter(object, 'filterName') }} 
```

* * *

干杯；）

# c# - Listview 项目文本被截断并且没有全部显示

> ID：10703942
> 
> 赞同：1
> 
> 时间：2012-05-22T14:18:29.303
> 
> 标签：c#, winforms

我正在使用这样的代码，当文本变长时，它会切断它并且不显示整个文本:(在这方面我希望它表现得像一个列表框项目。一行是一个项目在列表框中，并没有这个 trucnacted 文本问题。

```
 listView1.Scrollable = true;
    listView1.View = View.Details;
    listView1.HeaderStyle = ColumnHeaderStyle.None;

    ColumnHeader header = new ColumnHeader();
    header.Text = "MyHeader";
    header.Name = "MyColumn1";
    listView1.Columns.Add(header);

    listView1.Items.Add("TooLongTextDoesntShow");
    listView1.Items.Add("short");
    listView1.Items.Add("abcd"); 
```

我认为附上问题的图片更容易。请注意它没有显示突出显示项目的全文:(

谢谢你的帮助。

![在此处输入图像描述](../Images/fbe73da31586cc8ad3d7a4efa1a06c14.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T14:26:47.007

只需指定列标题宽度。

```
 ColumnHeader header = new ColumnHeader();
 header.Text = "MyHeader";
 header.Name = "MyColumn1";
 header.Width = listView1.Width //Same Width as Entire List Control
 listView1.Columns.Add(header); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T14:27:21.423

替代方法是*在*添加期间。

您可以使用：[ListView.ColumnHeaderCollection.Add](http://msdn.microsoft.com/en-us/library/497zcd0k%28v=vs.110%29.aspx)

```
public virtual ColumnHeader Add(
    string text,
    int width   //width of the header
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T14:24:42.450

好的，我找到了解决方案，如果有更好的方法也请告诉我

**将项目添加到列表视图后**，我们应该调用它：

```
listView1.AutoResizeColumns(ColumnHeaderAutoResizeStyle.ColumnContent); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-20T09:50:11.843

我们以具有 2 列的 ListView 为例，根据内容调整大小，然后调整为最小宽度。

```
// Auto resize of ListView Columns to minimum width
private int[] ColumnsWidth = { 35, 322 };

/// <summary>
/// Resize the columns based on the items entered
/// </summary>
private void ResizeColumns()
{
    // Auto Resize Columns based on content
    m_urlsListView.AutoResizeColumns(ColumnHeaderAutoResizeStyle.ColumnContent);
    // Make sure to resize to minimum width
    if (m_urlsListView.Columns[0].Width < ColumnsWidth[0])
    {
        m_urlsListView.Columns[0].Width = ColumnsWidth[0];
    }
    if (m_urlsListView.Columns[1].Width < ColumnsWidth[1])
    {
        m_urlsListView.Columns[1].Width = ColumnsWidth[1];
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-20T10:15:16.017

由于（实际上不可见）列，内容被截断。您可以告诉`ListView`自动调整列宽：

```
listView1.AutoResizeColumns(ColumnHeaderAutoResizeStyle.HeaderSize);
listView1.AutoResizeColumns(ColumnHeaderAutoResizeStyle.ColumnContent); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-06-16T08:50:39.687

您可以只添加一列并根据您的文本大小要求定义其宽度。此外，如果 listview 控件的实际宽度更小，可以将“Scrollable”属性设置为 true

[ListView_Column_Width_Image](https://i.stack.imgur.com/LnvUY.png)

# google-chrome - 重定向后 Google 开发人员工具“网络”选项卡会清除

> ID：10703944
> 
> 赞同：138
> 
> 时间：2012-05-22T14:18:35.887
> 
> 标签：google-chrome, firebug, developer-tools

重定向到另一个页面后，Google 开发人员工具“网络”选项卡会清除，我想知道是否有任何方法可以保留所有请求？

我想这样做是因为我想验证一个 POST 请求，但它会重定向并被清除。

在 firebug 中，我们可以使用“Persist”选项：

（“Persist”选项可防止在页面重新加载时清除控制台。这意味着，只要启用此选项，消息就会保留在控制台内。） [https://getfirebug.com/wiki/index.php/Console_Panel](https://getfirebug.com/wiki/index.php/Console_Panel)

* * *

## 回答 #1

> 赞同：231
> 
> 时间：2012-05-22T14:25:54.130

在开发工具的网络选项卡中，开发工具的左上角应该有一个标记为 的复选框`Preserve log`。单击它，它将在导航时保留网络。

![铬屏幕截图](../Images/da2fac14e0fcef5455d0d4bb59085508.png)

（旧版本可能在左下角有录制按钮，如此[处所示](https://i.stack.imgur.com/xGMz3.png)）

# javascript - 在 html 选择元素中显示空值

> ID：10703947
> 
> 赞同：4
> 
> 时间：2012-05-22T14:18:37.460
> 
> 标签：javascript, html, select, combobox

我在一个带有几个 if 选项的表单中有一个 HTML 选择元素（组合框）。与往常一样，每个选项都有特定的价值。在页面初始化期间，我从服务器获得一个值，我必须将其用作列表中的选定选项。但是，有时我从服务器获得的值与任何可用选项都不匹配。（咕噜）

我想让用户知道我从服务器获得的值不是一个有效的选项。我想做的是显示一个空的选择框（好像没有进行选择），而没有实际的空选项作为选项之一。如果可能的话，我还想使用默认的选择元素。这样的事情可能吗？

编辑：当您在 IE9 中将组合框的值设置为 '' （我使用 $('select').val('') ）时，它会清空组合框中的文本，这正是我所需要的。不幸的是，只有 IE9 这样做，所以这不是一个选项。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-22T14:29:28.877

开箱即用的 HTML 选择不提供此类功能。您必须添加一个空`<option value="somethingwrong">Please, pick a value</option>`元素并使用脚本来检查用户是否选择了此特定值。我建议同时捕捉`onchange`下拉`onsubmit`事件和整个表单的事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-22T14:32:10.373

您可以在选择中插入选项，并在更改时将其删除以减少该选项的问题

在此处查看[演示](http://jsfiddle.net/ranganadh/hHLyf/)

# java - Java https 在握手时遇到问题

> ID：10703950
> 
> 赞同：4
> 
> 时间：2012-05-22T14:18:44.310
> 
> 标签：java, ajax, https

我正在用 java 编写一个 https 服务器，它将接受并响应 ajax 请求。我有这一切使用http连接，但https被证明难以设置。如果我使用 openssl，我可以访问服务器并按预期获得响应： `openssl s_client -connect localhost:5001`但是来自浏览器的 ajax 调用失败。我不知道从这里去哪里。

**这是尝试 ajax 调用后来自服务器的堆栈跟踪：**

```
javax.net.ssl.SSLHandshakeException: Remote host closed connection during handshake
at sun.security.ssl.SSLSocketImpl.readRecord(Unknown Source)
at sun.security.ssl.SSLSocketImpl.performInitialHandshake(Unknown Source)
at sun.security.ssl.SSLSocketImpl.writeRecord(Unknown Source)
at sun.security.ssl.AppOutputStream.write(Unknown Source)
at sun.nio.cs.StreamEncoder.writeBytes(Unknown Source)
at sun.nio.cs.StreamEncoder.implFlushBuffer(Unknown Source)
at sun.nio.cs.StreamEncoder.implFlush(Unknown Source)
at sun.nio.cs.StreamEncoder.flush(Unknown Source)
at java.io.OutputStreamWriter.flush(Unknown Source)
at java.io.BufferedWriter.flush(Unknown Source)
at com.myDomain.HttpsServer.main(HttpsServer.java:223)
Caused by: java.io.EOFException: SSL peer shut down incorrectly
at sun.security.ssl.InputRecord.read(Unknown Source)
... 11 more 
```

**ajax 调用：**

```
var command, req;
  command = {
    command: "getStatus",
  };
  command = JSON.stringify(command);
  req = $.ajax("https://localhost:5001", {
    data: command,
    dataType: "jsonp",
    timeout: 1000
  }); 
```

**Java 服务器：**

```
private static SSLServerSocket createSSLSocket(){
    SSLServerSocketFactory sslServerSocketFactory =
        (SSLServerSocketFactory) SSLServerSocketFactory.getDefault();
    try{
      SSLServerSocket sslSocket =
        (SSLServerSocket) sslServerSocketFactory.createServerSocket(port, 10, InetAddress.getByName("127.0.0.1"));
      return sslSocket;
    } catch (Exception e){
        e.printStackTrace();
    }
    return null;
}

public static void main (String args[]) throws Exception {
    SSLServerSocket sslSocket;
    sslSocket = createSSLSocket();

    while(running) {
        SSLSocket connected = (SSLSocket) sslSocket.accept();
        try{
         BufferedWriter w = new BufferedWriter(
            new outputStreamWriter(connected.getOutputStream()));
             BufferedReader r = new BufferedReader(
                new InputStreamReader(connected.getInputStream()));
             w.write("HTTP/1.0 200 OK");
             w.write("foo");
             w.newLine();
             w.flush();  //THIS IS WHERE THE ACTUAL EXCEPTION IS THROWN (LINE 223)
             w.close();
             r.close();
             connected.close();
        } catch (Exception e){
         e.printStackTrace();
        }
    }
} 
```

这是正在运行的：

```
java -Djavax.net.ssl.keyStore=mySrvKeystore -Djavax.net.ssl.keyStorePassword=123456 myApp 
```

当使用调试选项完成时，看起来 mySrvKeystore 正在被正确使用。

**更新**

以下是来自调试输出的更多信息：

```
*** ECDH ServerKeyExchange
 Server key: Sun EC public key, 256 bits
   public x coord:      59120686551233854673577061225846672012454441193286172303206804252170042475984
   public y coord: 64356797475544123011351526783519675095229374542555548418334080869325161950574
   parameters: secp256r1 [NIST P-256, X9.62 prime256v1] (1.2.840.10045.3.1.7)
 *** ServerHelloDone
 main, WRITE: TLSv1 Handshake, length = 1317
 main, received EOFException: error
 main, handling exception: javax.net.ssl.SSLHandshakeException: Remote host closed connection      during handshake
 %% Invalidated:  [Session-1, TLS_ECDHE_RSA_WITH_RC4_128_SHA]
 main, SEND TLSv1 ALERT:  fatal, description = handshake_failure
 main, WRITE: TLSv1 Alert, length = 2
 main, called closeSocket() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-03T20:53:49.020

像这样确定握手失败可能会很棘手。尝试使用以下命令打开 SSL/TLS 调试：

```
-Djavax.net.debug=true 
```

您可能还想在服务器上添加信任库：

```
-Djavax.net.ssl.trustStore=mySrvKeystore 
```

您使用的浏览器可能不支持密码套件**TLS_ECDHE_RSA_WITH_RC4_128_SHA 。**可能是客户端/服务器尝试协商多个，但最后一个失败。您可以使用以下命令打印出服务器上启用的密码套件：

```
String[] cipherSuites = sslSocket.getEnabledCipherSuites();
for (int x = 0; x < cipherSuites.length; x++) {
   System.out.println(cipherSuites[x]);
} 
```

您还可以考虑限制服务器提供的密码套件，使用`sslSocket.setEnabledCipherSuites()`.

有关Sun 的一些旧示例，请参阅[在 JSSE 中使用 AES 。](http://java.sun.com/developer/technicalArticles/Security/AES/AES_v1.html)

一般来说，现代浏览器可以连接像**TLS_RSA_WITH_AES_128_CBC_SHA这样的密码套件**

# java - java - 如何在java中的JTextField上防止CTRL + C？

> ID：10703951
> 
> 赞同：1
> 
> 时间：2012-05-22T14:18:55.907
> 
> 标签：java, jtextfield

如何防止用户复制 JTextField 的内容？

我有以下内容，但我无法想办法同时获取多个密钥？

```
myTextField.addKeyListener(new KeyAdapter() {
@Override
public void keyTyped(KeyEvent e) {
  char c = e.getKeyChar();
  if (!Character.isDigit(c)) {
    e.consume();
  }
}
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T14:21:16.467

为此，您必须修改 KeyAdapter 以便它可以在按下键和释放键时进行注册，这样我们就可以知道两个键何时同时按下，下面的代码应该可以解决问题：

```
textfield.addKeyListener(new KeyAdapter() {
        boolean ctrlPressed = false;
        boolean cPressed = false;

        @Override
        public void keyPressed(KeyEvent e) {
            switch(e.getKeyCode()) {
            case KeyEvent.VK_C:
                cPressed=true;

                break;
            case KeyEvent.VK_CONTROL:
                ctrlPressed=true;
                break;
            }

            if(ctrlPressed && cPressed) {
                System.out.println("Blocked CTRl+C");
                e.consume();// Stop the event from propagating.
            }
        }

        @Override
        public void keyReleased(KeyEvent e) {
            switch(e.getKeyCode()) {
            case KeyEvent.VK_C:
                cPressed=false;

                break;
            case KeyEvent.VK_CONTROL:
                ctrlPressed=false;
                break;
            }

            if(ctrlPressed && cPressed) {
                System.out.println("Blocked CTRl+C");
                e.consume();// Stop the event from propagating.
            }
        }
    }); 
```

我只是将它添加到我的一个 JTextFields 中。

# c# - C# enctyped .accdb 连接

> ID：10703954
> 
> 赞同：4
> 
> 时间：2012-05-22T14:19:12.423
> 
> 标签：c#, ms-access, ms-access-2007, oledb

我最近将我的数据库从 .mdb (MS Access 2003) 更新为 .accdb (MS Access 2010)。

通过此更新，我还将我的提供程序更新为`Microsoft.Jet.OLEDB.4.0`：`Microsoft.ACE.OLEDB.12.0`

当我使用没有密码的 .accdb 文件时，连接工作正常，但是一旦我选择

> 用密码加密

当我尝试打开连接时收到以下错误。

> 无法打开数据库''。它可能不是您的应用程序识别的数据库，或者文件可能已损坏。

使用的连接字符串：

```
Provider=Microsoft.ACE.OLEDB.12.0;Data Source=D:\\App\\Main\\bin\\Debug\\db.xxx;
Jet OLEDB:Database Password=MyPass; 
```

注意：我为我的 .accdb 文件使用了自定义扩展名，这用于 .mdb 文件没有问题，我认为这应该不是问题（经过测试）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T18:08:29.657

我认为您的连接字符串没有问题。我仍然会从 VBA 中尝试一下，看看这种努力是否能解决这个问题。

无论我用“accdb”还是“xxx”文件扩展名命名 db 文件，这个都是从 Access 2007 开始工作的。我的密码不需要单引号；无论我是否包含单引号，代码都会成功。

```
Public Sub OleDbToEncryptedAccdb()
    'Const cstrDb As String = "encryptd.accdb" '
    Const cstrDb As String = "encryptd.xxx"
    Const cstrFolder As String = "C:\share\Access"
    Const cstrPassWord As String = "letmein"
    Dim cn As Object
    Dim strConnect As String

    strConnect = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" & _
        cstrFolder & Chr(92) & cstrDb & _
        ";Jet OLEDB:Database Password='" & cstrPassWord & "';"
    Debug.Print strConnect
    Set cn = CreateObject("ADODB.Connection")
    cn.ConnectionString = strConnect
    cn.Open
    cn.Close
    Set cn = Nothing
End Sub 
```

**编辑**：显然 Access 2010 提供了比早期 Access 版本更强大的加密方法。在`db.xxx`Access 2010 中打开，检查哪个 ACE 版本用作`Provider`.

```
? CurrentProject.Connection.Provider 
```

如果它回复类似`Microsoft.ACE.OLEDB.14.0`的内容，请在您的 c# 连接字符串中使用它。

# php - 一对多关系的 SQL 查询

> ID：10703955
> 
> 赞同：2
> 
> 时间：2012-05-22T14:19:12.920
> 
> 标签：php, select, one-to-many

我有两个表，表 A 和表 B。对于表 A 中的每条记录，表 B 中有许多记录；因此，表A和B之间存在一对多的关系。我想执行一个查询，以便对于从表A返回的每一行，所有相应的行都将从表B返回。据我所知，我需要使用`INNER Join`- 但是，我将如何通过 PHP 访问所有返回的行？

```
$sql = "Select A.ID, B.Name * From A INNER JOIN B ON A.ID = B.ID"; 
```

```
身份证 | B.f姓名 | B.lName
1 个名字
1 nametwo lnametwo
2 名称三 lnamethree
4 namefour lnamefour

```

现在我有了上面的结果，我想使用 PHP 来循环遍历所有的值，`B.Name`一次只有`A.ID`一个。所以，我想要的结果看起来像：

```
1.
nameOne lNameOne
nameTwo lnametwo

2.namethree lNamethree

4.nameFour lNameFour

```

基本上，我正在尝试按表 A 中的 ID 对查询结果进行分组。

我非常感谢帮助！

谢谢，

埃文

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T14:28:06.330

你可以只用谷歌“php get from database”并使用一些普通的数组预处理，但我担心你找到的建议可能并不理想。这是我要做的：

```
$pdo = new PDO('mysql:host=host;dbname=dbname', 'user', 'pass');
$result = $pdo->query(<<<SQL
   SELECT
      ID,
      Name
   FROM
      A
      -- Alternative to `JOIN B USING(ID)` or `JOIN B ON (A.ID = B.ID)
      NATURAL JOIN B
SQL
);
$a = array();
while ($row = $result->fetch()) {
   if (!isset($a[$row['ID']]) {
      $a[$row['ID']] = array();
   }
   $a[$row['ID']][] = $row['Name'];
} 
```

您也可以稍后`GROUP BY`在PHP 中使用 d`ID`和`GROUP_CONCAT`名称来`explode`跳过手动创建数组并减少一些迭代（尽管在这种情况下 SQL 会做得更多）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T14:31:02.917

向 SQL 查询添加一个简单`ORDER BY A.ID`的语句可能会让您在将项目“分组”在一起方面走得很远。如果不确切知道您想对“组”做什么，很难给出更详细的答案。

# java - Object.clone() 不应该需要显式转换吗？

> ID：10703958
> 
> 赞同：3
> 
> 时间：2012-05-22T14:19:23.920
> 
> 标签：java, clone

为什么Object.clone() 调用不需要显式转换**？**这不是“向下转换总是需要和显式转换”规则的例外吗？我使用 javac 命令行和带有 JDK1.6.0_29 的 Eclipse Helios 编译并成功运行了以下代码。

```
public class Main {

    public static void main(String[] args) {
        byte[] original = { 1, 2, 3, 4 };
        byte[] copy = original.clone();

        for (byte b : copy) {
            System.out.print(b + " ");
        }

        int[] originalInt = { 11, 22, 33, 44 };
        int[] copyInt = originalInt.clone();

        for (int i : copyInt) {
            System.out.print(i + " ");
        }

        String[] originalStr = { "1", "2", "3", "4" };
        String[] copyStr = originalStr.clone();

        for (String s : copyStr) {
            System.out.print(s + " ");
        }

        Main[] originalMain = { new Main() };
        Main[] copyMain = originalMain.clone();

        for (Main m : copyMain) {
            System.out.print(m + " ");
        }
    } // end method main

} // end class Main 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-22T14:22:15.473

你没有打电话`Object.clone()`。您正在调用`T[].clone()`，它被覆盖为 return `T[]`。

[JLS 10.7 数组成员](http://docs.oracle.com/javase/specs/jls/se7/html/jls-10.html#jls-10.7)：

> 数组类型的成员全部如下：
> 
> *   public 方法`clone`，覆盖类中同名的方法，`Object`不抛出检查异常。**数组类型****的方法的返回类型是。`clone``T[]``T[]`**

# android - XMLRPC Java Android 客户端

> ID：10703959
> 
> 赞同：1
> 
> 时间：2012-05-22T14:19:25.100
> 
> 标签：android, xml-rpc, xmlrpcclient

我下载了[XMLRPC 客户端项目](http://code.google.com/p/android-xmlrpc/)并尝试初始化与我的 XMLRPC 服务器的连接。

我设置了一个本地服务器进行测试并用于`http://10.0.2.2:8080/OpenConf_Server-0.0.1/`调用 rpc。

每次我调用只返回一个简单字符串的测试方法时，我都会收到 XMLRPC 客户端的以下错误消息。

出了什么问题？

```
05-22 16:08:27.503: E/OpenConfDashboardDesignActivity(759): org.xmlpull.v1.XmlPullParserException: expected: START_TAG {null}methodResponse (position:START_TAG <html>@4:7 in java.io.InputStreamReader@413092f8) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T21:10:08.947

尝试添加更多日志记录，很可能是服务器的路径不正确。

```
 } catch (final XMLRPCFault e) {
            // TODO: do something with message.contains
            Log.i(TAG, "XMLRPCFault : " +e.toString());
            String message = e.getMessage();
            if (message.contains("<html>")) {
                Log.i(TAG, MessCon" : " +e.toString());
                return null;
            }
        } catch (XMLRPCException e) {
            Log.i(TAG, " XMLRPCException : " +e.toString());
            return null;
        }
        Log.i(TAG, " respnse : " + response);
        return response; 
```

# javascript - 自动执行javascript函数并稍后调用它们？

> ID：10703962
> 
> 赞同：25
> 
> 时间：2012-05-22T14:19:29.153
> 
> 标签：javascript, jquery, function

我在很多地方读到，您可以通过以下方式在加载时自动启动 js 函数：

```
$(function() {
    // code...
}); 
```

或者

```
var myFunc = function() {
   // code...
}(); 
```

我的问题是，你以后如何调用这些函数？因为简单的声明

```
function myFunc() {
    // code...
} 
```

可以轻松调用，但不会自动启动。我必须在加载时手动调用它们，这很烦人，占用代码中的空间，如果我忘记了它可能是一个错误源。

如果你不明白我的解释，这里有一个例子：

我的表格中有一个“体重”和一个“身高”字段，我需要计算 BMI（身体质量指数）。当页面加载时，重量和高度由数据库填充，然后我在一切准备就绪时启动计算。但后来，如果用户改变体重或身高，BMI 必须立即重新计算。最好的方法是什么？使用 jquery 或纯 JS，我不介意。

谢谢。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-05-22T14:22:39.503

[可重用的即时函数](http://jsfiddle.net/cGmFf/1/)

```
var reference = (function thename(){

    //function body

    return thename; //return the function itself to reference

}()); //auto-run

reference(); //call it again
reference(); //and again 
```

请注意，调用该函数会返回对您刚刚调用的函数的引用。

```
var anotherReference = reference(); //anotherReference === reference 
```

# c++ - std::list 的返回类型是什么 C++ 中的 ::begin()

> ID：10703970
> 
> 赞同：0
> 
> 时间：2012-05-22T14:19:54.570
> 
> 标签：c++, templates, iterator

我想这些信息可以通过深入了解`<list>`实现来获得，这就是我在最后一天所做的。

我的问题是我想要一个我的方法`template<class T>`（它有一个私有`std::list<T>`成员）来包装......但我无法弄清楚这个方法的返回值是什么。

我的代码如下所示：

```
template &lt;class T &gt;
    class MyTemplate {
       std::list&lt;T&gt; myList;
       ...

       somereturnvaluehere myMethod(){
              return myList.begin();       
       }
       ...

} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-22T14:24:30.407

它是

*   `typename std::list<T>::iterator`,（非常量版本）
*   或`typename std::list<T>::const_iterator`（常量版本）

取决于是否`myList`是`const`对象，尽管在您的情况下，它似乎不是`const`对象，这意味着您应该使用第一个版本，即非常量版本。

在 C++11 中，你不需要担心它，如果你愿意，你可以使用 trailing-return 类型为：

```
auto myMethod() -> decltype(myList.begin())
{
    return myList.begin();       
} 
```

但是我认为，就您的情况而言，这太过分了，实际上，这会使事情变得不必要地复杂化。所以我建议你不要使用它；但只要知道在 C++11 中有一种叫做*trailing-return-type的东西，在**某些*情况下使用它可能是合理的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-22T14:22:41.833

该列表`begin`将返回一个`std::list<T>::iterator`.

在您的情况下，它将是一个依赖类型，因此`somereturnvaluehere`应该是

```
typename std::list<T>::iterator 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-22T14:23:46.863

它是

```
std::list<T>::iterator; 
```

或者

```
std::list<T>::const_iterator; 
```

取决于您的列表是否`const`存在。您可以像这样在类中使用该类型：

```
struct Foo {
    typedef typename std::list<SomeType>::iterator iterator;
    typedef typename std::list<SomeType>::const_iterator const_iterator;

    iterator foo() { return m_list.begin();}
    const_iterator foo() const { return m_list.begin(); }

    std::list<SomeType> m_list;
}; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-22T14:30:31.227

`std::list<T>::begin()`正如其他人所说，将返回 a`std::list<T>::iterator`或 a 。`std::list<T>::const_iterator`

可能更重要的是*您*要从该`myMethod()`功能中获得什么？

如果您只是在 a 周围编写一个薄包装器，`std::list`那么我不确定我是否看到了价值。理想情况下，您会将列表封装在您的类中，这样它的实现就不会暴露。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-22T14:42:21.037

正如其他人所说，它将是`std::list<T>::iterator`。但是为了提供更简洁的 API，并允许自己在将来更改它有一定的灵活性，您可能需要定义自己的 typedef（映射到`std::list<T>::iterator`）并将其用作返回类型。IE：

```
template <class T >
    class MyTemplate {
       std::list<T> myList;
       typedef std::list<T>::iterator iterator;
       ...

       iterator myMethod(){
              return myList.begin();       
       }
       ...

} 
```

在这里，我将 typedef 命名为 just `iterator`，这意味着您的类的用户会将其称为`MyTemplate<T>::iterator`-- 但根据`myMethod()`您的类的功能和详细信息，您可能希望将其命名为更具体的名称。

通过使用 a `typedef`，如果您后来改变主意并决定要使用 a`std::vector`而不是 a `std::list`，那么您的用户代码不需要更改（尽管它当然需要重新编译）。

# windows - 为什么 Windows 上的 Apache+mod_php 需要低 RAM 使用率？

> ID：10703976
> 
> 赞同：1
> 
> 时间：2012-05-22T14:20:18.783
> 
> 标签：windows, apache, ram

我在 Windows 上安装了 Apache + mod_php，但我无法将它与 Linux 上使用的任何一个相关联。

它只有这个：

```
# ThreadsPerChild: constant number of worker threads in the server process
# MaxRequestsPerChild: maximum  number of requests a server process serves
ThreadsPerChild 250
MaxRequestsPerChild  0 
```

关于孩子。

httpd.exe 只占用 12MB 的 RAM，如果我使用只有`sleep(10)`30 个并发连接的脚本进行“ab”测试，它只会占用 30MB 的使用量，并且可以将所有这些连接在一起！我在我的 ubuntu vps 上也在 mod_php 中做了同样的事情，为了获得 30 个并发连接，我不得不启动 30 个服务器，而 VPS 基本上崩溃了，因为仅 apache 进程的 RAM 使用量超过 200MB。所以问题是为什么使用的 RAM 如此之少？

# iphone - 如何在 iPhone App 中获取一个国家的所有城市

> ID：10703978
> 
> 赞同：1
> 
> 时间：2012-05-22T14:20:23.763
> 
> 标签：iphone, geolocation

在我的 iPhone 应用程序中，我使用的是 Google API。我必须做的一件事是我有一个国家的下拉列表，当我选择任何国家时，我需要获取该国家的所有城市。是否可以使用 Google API，或者我必须使用任何其他 API。请建议！谢谢-

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-22T14:26:15.293

google Geocoder API 返回 JSON ，它只是一种使用 GET 方法的网络服务

这是 Google Gecoder API，[这是](https://developers.google.com/maps/documentation/geocoding/)[该](http://maps.google.com/maps/api/geocode/json?sensor=true&address=london)Web 服务的链接，在此链接中，我将区域名称指定为 london。你可以给你国名

注意：您需要在代码中包含 SBJson 库。

在该链接的末尾，我附加了地址，如果附加地址，则需要提供区域名称（或），如果附加纬度和经度，则需要提供坐标，它将相应地返回结果。

而调用google api的代码会是这样的

```
 //Call the Google API
 NSString *req = [NSString stringWithFormat:@"http://maps.google.com/maps/api/geocode/json?sensor=false&address=%@", esc_addr];
 NSLog(@"The get address is %@", req);
 //Pass the string to the NSURL
 NSString *result = [NSString stringWithContentsOfURL:[NSURL URLWithString:req] encoding:NSUTF8StringEncoding error:NULL];
 NSLog(@"The result is %@", result);
 //Initialize the SBJSON Class
 SBJSON *parser = [[SBJSON alloc] init];
 NSError *error = nil;
 //Get the resullts and stored in the address array
 addressArray = [parser objectWithString:result error:&error];
 //Get the latitude values for the given address
 NSDictionary *dict = [[[addressArray valueForKey:@"results"] valueForKey:@"geometry"] valueForKey:@"location"];
 self.latitudeValue = [[dict valueForKey:@"lat"] objectAtIndex:0];
 self.longitudeValue = [[dict valueForKey:@"lng"] objectAtIndex:0];
 NSLog(@"LAT : %@",self.latitudeValue);
 NSLog(@"LONG : %@",self.longitudeValue); 
```

我刚刚给出了一个想法，您可以在那里的 JSON 响应中以短名称、长名称等形式获取所有名称

# pycharm - pycharm错误高亮

> ID：10703984
> 
> 赞同：1
> 
> 时间：2012-05-22T14:20:58.727
> 
> 标签：pycharm

我正在使用 pycharm，有时，编辑认为我的编码有错误。

也许它认为变量声明不当，或者不存在，或者括号不在正确的位置？

当然，编辑器是错误的，我的编码是完美的。尽管如此，为了向 pycharm 团队提出错误，我需要能够清楚地看到这些“错误”在哪里。

目前，编辑倾向于采用“几乎看不见的灰色”作为“错误”的配色方案。

我需要采取哪些步骤才能将配色方案更改为更引人注目的内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:43:47.757

`Editor`您可以在|中配置它 `Colors & Fonts`| `General`：

![颜色和字体](../Images/08c353207e9fdaad1e868dbc88e12afa.png)

# apache - 每服务器重写规则不起作用

> ID：10703986
> 
> 赞同：0
> 
> 时间：2012-05-22T14:21:10.750
> 
> 标签：apache, .htaccess, mod-rewrite

我有一个 VirtualHost 指令`/etc/apache2/openpanel.d/www.example.com.conf`：

```
<VirtualHost *:80>
   ServerAdmin        "jon@example.com"
   DocumentRoot       /home/openpanel-admin/sites/www.example.com/public_html
   ServerName         www.example.com
   ServerAlias        example.com
   <Directory /home/openpanel-admin/sites/www.example.com/public_html>
   AllowOverride      All
   Allow from all
   </Directory>
   Include /etc/apache2/openpanel.d//www.example.com.inc/[^.#]*
   Include /etc/apache2/openpanel.d//global.inc
</VirtualHost> 
```

我有以下内容`/etc/apache2/openpanel.d/www.example.com.inc/RewriteRules`

```
<Directory /home/openpanel-admin/sites/www.stallfinder.com/public_html>
        Options +FollowSymlinks
        RewriteEngine On

        RewriteRule agricultural-show-c780.html /search/event/agricultural-shows/1/ [R=301,L]
        RewriteRule antique-fair-c596.html /search/event/antique-and-collectors-fairs/1/ [R=301,L]
        RewriteRule baby-and-toddler-fairs-c896.html /search/event/baby-and-toddler-fairs/1/ [R=301,L]
        RewriteRule book-fair-c631.html /search/event/book-fairs/1/ [R=301,L]

        # etc... there are ~3000 of these
</Directory> 
```

我有一个`.htaccess`文件`/home/openpanel-admin/sites/www.example.com/public_html`：

```
Options +FollowSymlinks

RewriteEngine On
RewriteBase /

# Search pages
RewriteRule ^search/(stallholder|event)/?$ /find-$1.php [L]
RewriteRule ^search/(stallholder|event)/([^/]+)/([0-9]+)/? /$1.php?name=$2&id=$3 [L] 
```

但是包含文件 (RewriteRules) 中的 RewriteRules 似乎没有被解析/使用。

该文件被包含在内，因为我可以在其中放置不允许的内容，并且 apache 将无法加载配置文件，但是如果我打开 Apache 重定向日志记录，那么我只会看到 [perdir] 行，就好像我拥有的​​所有 RewriteRules进入 RewriteRules 包括未被处理。

该`global.inc`文件为空，我`.htaccess`文件中的 RewriteRules 工作正常。

任何线索我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T17:41:44.110

Try adding `RewriteOptions` directive into your .htaccess to allow executing rewrite rules on parent (upper) level.

[http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewriteoptions](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewriteoptions)

# python - 大量搜索替换对的正则表达式替换

> ID：10703987
> 
> 赞同：2
> 
> 时间：2012-05-22T14:21:10.867
> 
> 标签：python, regex, nlp, text-processing

为了文本规范化，我希望能够跨文档进行大规模搜索和替换。

例如：

1.  **查找USA** , **USA**的所有用途并替换为**United States Of America**
2.  查找所有与号 (&) 并替换为单词**and**

我还希望能够在不更改任何代码的情况下向系统添加新规则。因此搜索替换对存储在数据存储中，这意味着任何人都可以添加、更新、删除规则。

我一直在使用 Python re 模块，它非常好，理想情况下，我想将一个元组列表传递给子命令，然后遍历每一个并进行替换。除了遍历元组列表然后为每个元组创建一个正则表达式之外，是否有更好的方法来做到这一点 - 它非常缓慢且效率低下，尤其是对于大型文档：

```
replacements = [
  r('USA','United States Of America'),
  (r'U\.S\.A','United States Of America'),
  (r'US of A', 'United States of America')]

for replacement in replacements:
  document = re.sub(replacement[0],replacement[1],document 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T15:00:04.930

您的示例都不需要正则表达式。为什么不尝试好的 ol' 字符串替换？

```
replacements = [
    ('USA','United States Of America'),
    ('U\.S\.A','United States Of America'),
    ('US of A', 'United States of America')]

for replacement in replacements:
    document = document.replace(replacement[0], replacement[1]) 
```

这似乎会很慢，但是您应该在排除该方法之前对其进行基准测试。Python 非常擅长这样的事情，结果可能会让你大吃一惊。

如果你真的需要正则表达式，你可能会通过编译它们看到巨大的提升：

```
replacements = [
    (re.compile('USA'),'United States Of America'),
    (re.compile('U\.S\.A'),'United States Of America'),
    (re.compile('US of A'), 'United States of America')]

for pattern, replacement in replacements:
    document = pattern.sub(replacement, document) 
```

这节省了 Python 每次使用它们时都必须重新编译这些正则表达式的工作。

如果您有时只需要正则表达式，请考虑对文档进行两次传递：一次使用正则表达式，一次使用字符串替换。或者，如果您需要一些特定的替换顺序，您可以使用以下内容：

```
replacements = [
    (re.compile('USA'),'United States Of America'),
    ('foo', 'bar'),
    (re.compile('U\.S\.A'),'United States Of America'),
    ('spam', 'eggs'),
    (re.compile('US of A'), 'United States of America')]

for pattern, replacement in replacements:
    try:
        document = pattern.sub(replacement, document)
    except AttributeError:
        document = document.replace(pattern, replacement) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T17:15:03.837

我有一个包含 6 MB 文本的[大屁股文件。](http://norvig.com/big.txt)它是几个 Project Gutenberg 文件的汇编。

试试这个：

```
reps = [
  (r'\bthousand\b','>>>>>1,000<<<<<'),
  (r'\bmillion\b',">>>>>1e6<<<<<"),
  (r'\b[Hh]undreds\b',">>>>>100's<<<<<"),
  (r'\bSherlock\b', ">>>> SHERLOCK <<<<")
  ]

t1=time.time()
out=[]  
rsMade=0
textLength=0
NewTextLen=0
with open('big.txt') as BigAssF:
    for line in BigAssF:
        textLength+=len(line)
        for pat, rep in reps:
            NewLine=re.subn(pat,rep,line)     

        out.append(NewLine[0])
        NewTextLen+=len(NewLine[0])
        rsMade+=NewLine[1]

print 'Text Length: {:,} characters'.format(textLength)
print 'New Text Length: {:,} characters'.format(NewTextLen)     
print 'Replacements Made: {}'.format(rsMade)     
print 'took {:.4} seconds'.format(time.time()-t1) 
```

它打印：

```
Text Length: 6,488,666 characters
New Text Length: 6,489,626 characters
Replacements Made: 96
took 2.22 seconds 
```

这对我来说似乎足够快。

您的代码行可能存在一些问题：

`document = re.sub(replacement[0],replacement[1],document`

如果那不是错字。

你期望它有多快？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T14:54:49.473

看看谷歌优化。

> Google Refine，用于处理杂乱数据的强大工具

[http://code.google.com/p/google-refine/](http://code.google.com/p/google-refine/)

# groovy - 如何在 groovy 中报告错误

> ID：10703991
> 
> 赞同：1
> 
> 时间：2012-05-22T14:21:37.853
> 
> 标签：groovy

这些代码：

```
if (false)
    int number = 0

1..3.each{
    println number
}

return bug: 
```

漏洞！源单元“Script7.groovy”中的“类生成”阶段中的异常尝试获取名称为 number 的变量作为堆栈变量，但未创建具有此名称的变量

我如何向 groovy 的开发人员报告此错误以修复它？我正在使用版本 1.8.0

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-22T14:25:12.063

[您可以在他们的公共 JIRA](https://issues.apache.org/jira/projects/GROOVY/issues)上报告 Groovy 错误

发布到 groovy-user 邮件列表可能也是一个好主意，解释问题并提供指向您创建的 JIRA 报告的链接。

顺便说一句：这在​​ Groovy 1.8.6 上也失败了（总是值得检查最新版本的 Groovy，因为它可能已被修复）

* * *

我想即使修复到位，这仍然会失败（但不会`BUG!`失败）。要使其正常工作，您需要执行以下操作：

```
int number = 1

if (false)
    number = 0

(1..3).each{
    println number
} 
```

# java - 使用 Junit 测试 Web 服务出现错误

> ID：10703992
> 
> 赞同：0
> 
> 时间：2012-05-22T14:21:43.310
> 
> 标签：java, web-services, junit, axis

我正在使用由axis-ant制作的客户端jar测试java webservice，当我运行测试时出现以下错误。

java.lang.NoSuchMethodError: org.apache.axis.description.TypeDesc.(Ljava/lang/Class;Z)V at com.xxxx.www.xxxx.xsd.GetSalesIdRequest.(Unknown Source)

请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T14:28:28.377

我怀疑您没有将 apache 轴添加到您的类路径中。

# c# - 在javascript中处理下拉列表选定的索引

> ID：10703994
> 
> 赞同：1
> 
> 时间：2012-05-22T14:21:53.943
> 
> 标签：c#, javascript, drop-down-menu

我有一个下拉列表。When Selected Index changes I wanted to handle it in javascript. 因此，作为开始步骤，我尝试通过 javascript 在文本框中打印列表项文本的值。但未能成功完成。这是下拉列表：

```
 <asp:DropDownList Width="300px" ID="PlaceHoldersDropDownList" runat="server"
                AppendDataBoundItems="True" TabIndex="3" AutoPostBack="True" 
                OnSelectedIndexChanged = "PlaceHoldersDropDownList_SelectedIndexChanged"  >
            <asp:ListItem Value="">Select</asp:ListItem>
            <asp:ListItem Value="ContactName">[Contact Name]</asp:ListItem>
            <asp:ListItem Value="ProductName">[Product Name]</asp:ListItem>
            <asp:ListItem Value="ProductShortName">[Product Short Name]</asp:ListItem>
            <asp:ListItem Value="CurrentTime">[Current Time]</asp:ListItem>
            <asp:ListItem Value="EventStartTime">[Event Start Time]</asp:ListItem>
            <asp:ListItem Value="EventStopTime">[Event Stop Time]</asp:ListItem>
        </asp:DropDownList>
        <asp:TextBox ID="tb" runat="server"></asp:TextBox> 
```

这是C#代码

```
 protected void PlaceHoldersDropDownList_SelectedIndexChanged(object sender, 
                                                            EventArgs e)
    {
        var text = PlaceHoldersDropDownList.SelectedItem.Text;

        string x = text;
        PlaceHoldersDropDownList.Attributes.Add("onchange", "javscript:PasteTextInEditor
                                                                        ('"+text+"')");

    } 
```

这是javascript

```
 function PasteTextInEditor(text) {

        var x = document.getElementById("<%= tb.ClientID %>");
        x.value = text;                    } 
```

你能告诉我我一直在做的错误吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T14:34:13.767

首先，您必须设置`AutoPostBack`为 false 才能在客户端（javascript）中处理它，并且您不需要以`onchange`编程方式添加事件，您可以将它写成`<asp:DrobDownList>`类似的东西

```
<asp:DropDownList Width="300px" ID="PlaceHoldersDropDownList" runat="server"
     AppendDataBoundItems="True" TabIndex="3" AutoPostBack="false"
     onchange="PasteTextInEditor()"> 
```

该`PasteTextInEditor`方法将变为

```
function PasteTextInEditor() {
    var text = $("#<%= PlaceHoldersDropDownList.ClientID %> option:selected").text();
    $("#<%= tb.ClientID %>").val(text);
} 
```

注意我使用的是[jquery](http://www.jquery.com)语法

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-22T14:50:28.427

使用[jQuery](http://www.jquery.com)，您可以进行以下操作：

1-关闭`AutoPostBack`并且不处理`OnSelectedIndexChanged`事件：

```
<asp:DropDownList Width="300px" ID="PlaceHoldersDropDownList" runat="server" AppendDataBoundItems="True" TabIndex="3" > 
```

2-添加对jQuery的引用

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script> 
```

3-添加一个“启动”脚本来挂钩`onchanged`下拉列表的事件，阅读 javascripts 评论以获取更多详细信息。

```
<script type="text/javascript">
    $(function () {
        var ddl = $("#<%= PlaceHoldersDropDownList.ClientID %>");
        var txt = $("#<%= tb.ClientID %>");

        // hook the change event for the drop down list
        $(ddl).change(function (e) {
            var selectedValue = $(ddl).val();

            // set the selectedValue into the textBox
            $(txt).val(selectedValue);
        });
    });
</script> 
```

# java - 泽西岛 URISchemeScanner

> ID：10703996
> 
> 赞同：1
> 
> 时间：2012-05-22T14:22:01.123
> 
> 标签：java, web-services, rest, websphere, jersey

几天前，我遇到了我在此处发布的 Jersey 部署问题

[泽西资源 .class 加载](https://stackoverflow.com/questions/10606919/jersey-resource-class-loading)

我们能够通过扩展 javax.ws.rs.core.Application 使用替代部署机制并进行临时修复。但在研究更多时，我发现了可以在我们的代码中实现的 Jersey Scanners。这可以用来在我们的项目部署结构中查找特定的 JAR。我在网上查找，但找不到任何关于如何将 URISchemeScanner 集成到我们的代码中的具体示例。（web.xml 配置等......）如果我能指出正确的方向，我将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T06:38:23.667

来自 PackagesNamesScanner javadoc：

“可以通过在 META-INF/services 文件中注册 UriSchemeScanner 的实现来注册进一步的方案，该文件的名称是 UriSchemeScanner 的完全限定类名。”

请参阅：http: [//jersey.java.net/nonav/apidocs/1.12/jersey/com/sun/jersey/core/spi/scanning/PackageNamesScanner.html](http://jersey.java.net/nonav/apidocs/1.12/jersey/com/sun/jersey/core/spi/scanning/PackageNamesScanner.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T16:58:25.723

我也遇到了 WAS 7 的问题。我们所做的是从 web.xml 中删除扫描初始化参数本身，并复制包含 Web 项目的 Web-Inf Lib 文件夹中的资源的 Jar。然后它将起作用。仅在耳朵中添加 J2EE 依赖项是行不通的。

我正在使用 jersey 1.12 但默认扫描仪仍然有问题

您可以分享您所做的自定义扫描仪修改，以便我也可以尝试吗？