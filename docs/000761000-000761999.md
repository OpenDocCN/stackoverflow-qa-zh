# StackOverflow 问答 000761000-000761999

# c# - 将字母转换为 base-10 的最佳方法

> ID：761000
> 
> 赞同：1
> 
> 时间：2009-04-17T15:56:54.497
> 
> 标签：c#

到目前为止，我有一些东西，例如：

```
if( Char.IsDigit( c ) ) 
   return Int32.Parse( "" + c );

if( Char.IsLetter( c ) ) 
   return Char.ToUpper( c ) - 'A' + 1; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T16:01:44.690

对于第一个：

```
if (Char.IsDigit(c))
    return c - '0'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T16:02:42.970

有一篇相当详细的[MSDN 文章](http://msdn.microsoft.com/en-us/library/aa326742(VS.71).aspx)正是您正在寻找的。

# c# - 可以快速返回子数组的排序时间序列数据的最佳数据结构？

> ID：761001
> 
> 赞同：1
> 
> 时间：2009-04-17T15:56:57.510
> 
> 标签：c#, linq, range, sortedlist

我需要一个基本上是数据点列表的数据结构，其中每个数据点都有一个时间戳和一个数据值的 double[]。我希望能够检索到给定时间戳的最近点或指定时间戳范围内的所有点。

我正在使用 c#。我的想法是使用常规列表是可能的，其中“数据点”是一个包含时间戳和双 [] 字段的类。然后插入，我会使用内置的 binarysearch() 来查找插入新数据的位置，我可以再次使用它来查找范围搜索的开始/结束索引。

我首先尝试了 sortedlists，但似乎您不能仅通过键迭代索引 i=0,1,2,...,n，所以我不确定如何在没有一些复杂函数的情况下进行范围搜索.

但后来我了解到 list<> 的 insert() 是 o(n)...如果不牺牲其他地方，难道我不能做得更好吗？

或者，是否有一些不错的 linq 查询可以在一行中完成我想要的所有操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T16:36:36.727

如果您愿意使用非 BCL 库，[C5.SortedArray<T>](http://www.itu.dk/research/c5/Release1.1/c5doc/types/C5.SortedArray_1.htm)对我来说一直很有效。

它有一个很棒的方法[RangeFromTo](http://www.itu.dk/research/c5/Release1.1/c5doc/types/C5.SortedArray_1.htm#T:C5.SortedArray%601|M:C5.SortedArray%601.RangeFromTo(%600,%600))，可以很好地解决这类问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T14:48:54.057

如果您**只有静态数据**，那么任何实现 IList 的结构都应该没问题。对其进行一次排序，然后使用 BinarySearch 进行查询。如果您插入的时间戳总是在增加，这也应该有效，那么您可以在 O(1) 中执行 List.Add() 并且它仍然会被排序。

```
 List<int> x = new List<int>();
    x.Add(5);
    x.Add(7);
    x.Add(3);

    x.Sort();

    //want to find all elements between 4 and 6
    int rangeStart = x.BinarySearch(4);

    //since there is no element equal to 4, we'll get the binary complement of an index, where 4 could have possibly been found
    //see MSDN for List<T>.BinarySearch
    if (rangeStart < 0)
        rangeStart = ~rangeStart;

    while (x[rangeStart] < 6)
    {
        //do you business
        rangeStart++;
    } 
```

如果您需要在结构**中的随机点插入数据**、保持排序并能够快速查询范围，则需要一个名为[B+ 树](http://en.wikipedia.org/wiki/B%2B_tree)的结构。它没有在框架中实现，您需要自己在某个地方获取它。

> 在最坏的情况下插入记录需要 O(log n) 操作
> 
> 在最坏的情况下，查找记录需要 O(log n) 次操作
> 
> 在最坏的情况下，删除（先前定位的）记录需要 O(log n) 操作
> 
> 在最坏的情况下，执行范围内出现 k 个元素的范围查询需要 O((log n) + k) 次操作。

PS *“是否有一些不错的 linq 查询可以在一行中完成我想要的所有事情”*

我希望我知道这么好的 linq 查询可以在一行中完成我想要的一切:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T14:57:48.547

如何使用实际的数据库来存储您的数据并针对它运行查询？然后，您可以使用[LINQ-to-SQL](http://msdn.microsoft.com/en-us/library/bb386976.aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T16:39:23.460

您可以选择插入、取出或移除时的成本。每种情况都有各种优化的数据结构。在你决定一个之前，我会估计你的结构的总大小，正在生成多少数据点（以及以何种频率）以及将更频繁地使用什么：插入或检索。

如果您以高频率插入大量新数据点，我建议您查看 LinkedList<>。如果您更频繁地检索，我会使用 List<> 即使它的插入时间较慢。

当然，您可以在 LINQ 查询中执行此操作，但请记住，这只是糖衣：查询将每次执行，每次执行都会搜索整个数据点集以找到匹配项。这可能比一开始就为工作使用正确的集合更昂贵。

# java - JTree的选择路径

> ID：761002
> 
> 赞同：0
> 
> 时间：2009-04-17T15:57:03.360
> 
> 标签：java, swing, xsd, selection, jtree

[我已经使用 XSOM API ( https://xsom.dev.java.net](https://xsom.dev.java.net) )从 XML Schema 文件中加载了带有节点的 JTree 。

每次选择文件时，我都会执行以下操作：

```
schemaParser = new XSDParser(selectedFile.getAbsolutePath());

TreeModel model = schemaParser.generateTreeModel();
schemaTree.setModel(model);
schemaTree.setCellRenderer(new SchemaTreeTraverser.SchemaTreeCellRenderer()); 
```

schemaTree 是 JTree 的变量名。

XSDParser 的代码如下：

```
package schemaparser;

import java.io.*;
import com.sun.xml.xsom.XSSchemaSet;
import com.sun.xml.xsom.impl.util.SchemaTreeTraverser;
import com.sun.xml.xsom.impl.util.SchemaWriter;
import com.sun.xml.xsom.parser.XSOMParser;

import javax.swing.tree.TreeModel;

public class XSDParser {

    private XSOMParser reader;
    private XSSchemaSet xss;

    public XSDParser(String parseFile){
        try {
            reader = new XSOMParser();
            reader.parse(new File(parseFile));

            xss = reader.getResult();
            if (xss == null) {
                System.out.println("error");
            }

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }

   public TreeModel generateTreeModel() {
        SchemaTreeTraverser stt = new SchemaTreeTraverser();
        stt.visit(xss);
        TreeModel model = stt.getModel();

        System.out.println("Returning the tree model");
        return model;
    }
} 
```

现在，每当在 JTree 中选择一个节点时，我都会执行以下操作：

```
private void schemaTreeValueChanged(javax.swing.event.TreeSelectionEvent evt)      {                                        

        TreePath path = schemaTree.getSelectionPath();

        if(path != null)
            System.out.println(path.toString());

} 
```

但是现在无论我在树中选择哪个节点，我都会得到类似： [null, null, null, null] （取决于我走多远的层次结构）

对于一个简单的 JTree，这通常会打印出节点的路径，例如：[JTree, colors, red]

有人知道如何解决这个问题吗？

谢谢，帕特里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-11-17T00:21:51.500

您不应该询问`JTree`所选路径，您应该从`TreeSelectionEvent`.

# c# - 在 Windows 窗体上绘制单个像素

> ID：761003
> 
> 赞同：97
> 
> 时间：2009-04-17T15:57:08.163
> 
> 标签：c#, .net, winforms, gdi+, pixel

我一直在尝试打开 Windows 窗体上的单个像素。

```
graphics.DrawLine(Pens.Black, 50, 50, 51, 50); // draws two pixels

graphics.DrawLine(Pens.Black, 50, 50, 50, 50); // draws no pixels 
```

API确实应该有一种方法来设置一个像素的颜色，但我没有看到。

我正在使用 C#。

* * *

## 回答 #1

> 赞同：119
> 
> 时间：2009-04-17T16:11:55.587

这将设置一个像素：

```
e.Graphics.FillRectangle(aBrush, x, y, 1, 1); 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-04-17T16:03:31.893

该`Graphics`对象没有这个，因为它是一种抽象，可用于覆盖矢量图形格式。在这种情况下，设置单个像素是没有意义的。`Bitmap`图像格式确实有`GetPixel()`and `SetPixel()`，但没有建立在一个之上的图形对象。对于您的方案，您的选项似乎真的是唯一的一个，因为没有一种万能的方法来为一般图形对象设置单个像素（并且您不知道它到底是什么，作为您的控件/表单可以是双缓冲等）

为什么需要设置单个像素？

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2014-04-30T21:07:37.020

只是为了显示 Henk Holterman 答案的完整代码：

```
Brush aBrush = (Brush)Brushes.Black;
Graphics g = this.CreateGraphics();

g.FillRectangle(aBrush, x, y, 1, 1); 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-04-17T16:15:45.107

在我绘制大量单个像素（用于各种自定义数据显示）的地方，我倾向于将它们绘制到位图上，然后将其粘贴到屏幕上。

Bitmap GetPixel 和 SetPixel 操作并不是特别快，因为它们进行了大量的边界检查，但是制作一个可以快速访问位图的“快速位图”类非常容易。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-03-13T16:23:28.900

[GetHdc 上的 MSDN 页面](https://msdn.microsoft.com/en-us/library/9z5820hw%28v=vs.110%29.aspx)

我想这就是你要找的。您将需要获取 HDC，然后使用 GDI 调用来使用 SetPixel。请注意，GDI 中的 COLORREF 是存储 BGR 颜色的 DWORD。没有alpha通道，也不是像GDI+的Color结构那样的RGB。

这是我为完成相同任务而编写的一小段代码：

```
public class GDI
{
    [System.Runtime.InteropServices.DllImport("gdi32.dll")]
    internal static extern bool SetPixel(IntPtr hdc, int X, int Y, uint crColor);
}

{
    ...
    private void OnPanel_Paint(object sender, PaintEventArgs e)
    {
        int renderWidth = GetRenderWidth();
        int renderHeight = GetRenderHeight();
        IntPtr hdc = e.Graphics.GetHdc();

        for (int y = 0; y < renderHeight; y++)
        {
            for (int x = 0; x < renderWidth; x++)
            {
                Color pixelColor = GetPixelColor(x, y);

                // NOTE: GDI colors are BGR, not ARGB.
                uint colorRef = (uint)((pixelColor.B << 16) | (pixelColor.G << 8) | (pixelColor.R));
                GDI.SetPixel(hdc, x, y, colorRef);
            }
        }

        e.Graphics.ReleaseHdc(hdc);
    }
    ...
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-10-22T12:09:40.957

使用带有 DashStyle.DashStyle.Dot 的 Pen 绘制一条 2px 的线条会绘制一个像素。

```
 private void Form1_Paint(object sender, PaintEventArgs e)
    {
        using (Pen p = new Pen(Brushes.Black))
        {
            p.DashStyle = System.Drawing.Drawing2D.DashStyle.Dot;
            e.Graphics.DrawLine(p, 10, 10, 11, 10);
        }
    } 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-17T16:07:49.650

显然 DrawLine 绘制了一条比实际指定长度短一个像素的线。似乎没有 DrawPoint/DrawPixel/whatnot，但是您可以使用将宽度和高度设置为 1 的 DrawRectangle 来绘制单个像素。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-01-05T15:41:23.967

如果您在 SmoothingMode = AntiAlias 的图形上绘图，大多数绘图方法将绘制多个像素。如果您只想绘制一个像素，请创建一个 1x1 位图，将位图的像素设置为所需的颜色，然后在图形上绘制位图。

```
using (var pixel = new Bitmap(1, 1, e.Graphics))
{
    pixel.SetPixel(0, 0, color);
    e.Graphics.DrawImage(pixel, x, y);
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-06-07T01:23:08.530

这里有很多答案，但它们都很糟糕:(

绝对最好的方法是创建一个位图并将一个 intptr（指针）传递给一个现有的数组。这允许数组和位图数据共享相同的内存......不需要'Bitmap.lockbits'/'Bitmap.unlockbits'（慢）。

**这是大致的轮廓...**

1.  将您的函数标记为“不安全”并设置您的项目构建设置以允许“不安全”代码！(c# 指针)
2.  创建你的数组[,]。使用 Uint32、字节或允许 Uint32 或单个 Uint8 访问的结构*（通过使用显式字段偏移）*
3.  使用“System.Runtime.InteropServices.Marshal.UnsaveAddrOfPinnedArrayElement”获取到数组开头的 Intptr。
4.  使用采用 Intptr 和 Stride 的构造函数创建位图。这将使新位图与现有数组数据重叠。

您现在可以永久直接访问像素数据！

**底层数组**

底层数组可能是用户结构“像素”的二维数组。为什么？嗯...结构可以允许多个成员变量通过使用显式的固定偏移来共享同一个空间！这意味着该结构可以有 4 个单字节成员（.R、.G、.B 和 .A），以及 3 个重叠的 Uint16（.AR、.RG 和 ,GB）……和一个 Uint32（.ARGB ) ...这可以使色彩平面操作更快。

由于 R、G、B、AR、RG、GB 和 ARGB 都访问同一个 32 位像素的不同部分，您可以以高度灵活的方式操作像素！

因为 Pixel[,] 的数组与 Bitmap 本身共享相同的内存，所以图形操作会立即更新 Pixel 数组 - 而对数组的 Pixel[,] 操作会立即更新位图！您现在有多种操作位图的方法；）

灵活快速；）

请记住，通过使用这种技术，您不需要使用“lockbits”来将位图数据编组进出缓冲区……这很好，因为 lockbits 非常非常慢。

您也不需要使用画笔并调用能够绘制图案化、可缩放、可旋转、可平移、可别名、矩形的复杂框架代码......只需编写一个像素相信我 - Graphics 类中的所有灵活性使绘图使用“Graphics.FillRect”的单个像素是一个非常缓慢的过程。

**其他福利...**

滚动超级流畅！您的像素缓冲区在高度和宽度上都可以大于您的画布/位图！这可以实现有效的滚动！！！！

如何？

好吧，当您从数组创建位图时，您可以通过获取该 Pixel[,] 的 IntPtr 将位图的左上角坐标指向任意 [y,x] 坐标。

然后，通过故意设置位图“步幅”以匹配数组*的宽度（而不是位图的宽度），*您可以渲染较大数组的预定义子集矩形......同时*（提前）*绘制到看不见的边缘！这就是平滑滚动条中“离屏绘图”的原理。

**最后**

您真的应该将 Bitmap 和 Array 包装到 FastBitmap 类中。这将帮助您控制数组/位图对的生命周期。显然，如果数组超出范围或被破坏 - 位图将指向非法内存地址。通过将它们包装在 FastBitmap 类中，您可以确保不会发生这种情况......

......它也是一个非常方便的地方，可以放置您不可避免地想要添加的各种实用程序......例如滚动，褪色，使用彩色平面等。

**记住：**

1.  从 MemoryStream 创建位图非常慢
2.  使用 Graphics.FillRect 来绘制像素是非常低效的
3.  使用 lockpixels/unlockpixels 访问底层位图数据非常慢
4.  而且，如果您使用的是“System.Runtime.InteropServices.Marshal.Copy”，请停止！

将位图映射到一些现有的数组内存是要走的路。做对了，你将永远不需要/想再次使用框架位图:)

别客气 ;）

# linux - 从 grep -l 得到一个很长的列表——有可能吗？

> ID：761004
> 
> 赞同：1
> 
> 时间：2009-04-17T15:57:09.333
> 
> 标签：linux, unix, grep

我正在执行这个 grep： grep -l "Validation failed" *.dbg

这将返回一个文件列表。但是，我最感兴趣的是这些文件的修改时间。

正确的命令是什么？

编辑：标题中的论点是错误的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-17T16:01:23.800

xargs 显然是我的朋友。答案是：grep -l "Validation failed" *.dbg | xargs ls -ltr

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T16:14:08.637

你也可以这样做

```
for file in `grep -l "Validation failed" *.dbg`; do ls -ltr $file; done 
```

但是 xargs 绝对更简洁、更短，并且为您提供了简单的分隔符选项。

# msbuild - 在大型项目中寻找参考 MsBuild 配置

> ID：761011
> 
> 赞同：0
> 
> 时间：2009-04-17T15:58:36.583
> 
> 标签：msbuild

我一直在努力解决如何最好地组织我的 msbuild 项目文件。有一次是全部在一个文件中。然后我把它分成多个文件。

但我希望能够运行 1 个主项目文件，该文件导入所有内容并使用依赖项构建它们。或者能够独立构建项目，不用担心在“dependsontargets”属性中找不到任务。

所以我想知道是否有人知道我应该如何组织我的项目的好参考。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-17T16:04:16.820

不是惊天动地，但在[msdn](http://msdn.microsoft.com/en-us/magazine/cc163589.aspx)中有[一系列](http://msdn.microsoft.com/en-us/dd419659.aspx)[文章](http://msdn.microsoft.com/en-us/magazine/dvdarchive/dd483291.aspx)。

# mysql - MYSQL：你能提取匹配 4 个表达式中的 3 个的结果吗？

> ID：761014
> 
> 赞同：10
> 
> 时间：2009-04-17T15:59:37.003
> 
> 标签：mysql

假设我有这样的查询：

```
SELECT * FROM my_table WHERE name = "john doe" AND phone = "8183321234" AND email = "johndoe@yahoo.com" AND address = "330 some lane"; 
```

但是假设我只需要 4 个中的 3 个来匹配，我知道我可以编写一个包含多个 OR 的很长的查询，但我想知道是否有这样的功能？

谢谢。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-17T16:02:58.290

```
SELECT
  * 
FROM 
  my_table 
WHERE 
  CASE WHEN name = "john doe"           THEN 1 ELSE 0 END +
  CASE WHEN phone = "8183321234"        THEN 1 ELSE 0 END +
  CASE WHEN email = "johndoe@yahoo.com" THEN 1 ELSE 0 END +
  CASE WHEN address = "330 some lane"   THEN 1 ELSE 0 END
  >= 3; 
```

旁注：这很可能不会有效地使用索引。另一方面，无论如何，这些列很可能没有索引。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-04-17T16:14:31.210

神圣的过于复杂，蝙蝠侠。

```
SELECT * 
FROM my_table 
WHERE (
    (name = "john doe") +
    (phone = "8183321234") +
    (email = "johndoe@yahoo.com") +
    (address = "330 some lane")
) >= 3; 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-17T16:12:09.687

使用索引也是一样的：

```
SELECT  *
FROM    (
        SELECT  id
        FROM    (
                SELECT  id
                FROM    mytable _name
                WHERE   name = 'john doe'
                UNION ALL
                SELECT  id
                FROM    mytable _name
                WHERE   phone = '8183321234'
                UNION ALL
                SELECT  id
                FROM    mytable _name
                WHERE   email = "johndoe@yahoo.com"
                UNION ALL
                SELECT  id
                FROM    mytable _name
                WHERE   address = '330 some lane'
                ) q
        GROUP BY 
                id
        HAVING
                COUNT(*) >= 3
        ) di, mytable t
WHERE   t.id = di.id 
```

有关性能详细信息，请参阅[**我的博客中的条目。**](http://explainextended.com/2009/04/17/matching-3-of-4/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T16:21:45.437

我喜欢 IF 构造：

```
SELECT * FROM my_table
WHERE
(    IF(name    = 'john doe', 1, 0) +
     IF(phone   = '8183311234', 1, 0) +
     IF(email   = 'johndoe@yahoo.com', 1, 0) +
     IF(address = '330 some lane', 1, 0)
) >= 3 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-17T16:45:48.047

稍微修改 Tomalak 的查询，以便在存在索引时使用索引。尽管除非每个字段都有索引，否则无论如何都会发生全表扫描。

```
SELECT
*, 
(
    IF(name="john doe", 1, 0) +
    IF(phone = "8183321234", 1, 0) +
    IF(email = "johndoe@yahoo.com", 1, 0) +
    IF(address = "330 some lane", 1, 0) 
) as matchCount
FROM my_table 
WHERE 
    name = "john doe" OR 
    phone = "8183321234" OR 
    email = "johndoe@yahoo.com" OR 
    address = "330 some lane"
HAVING matchCount >= 3 
```

# asp.net - 如何获取本地网络内访问 ASP.NET 内网页面的用户的用户名？

> ID：761016
> 
> 赞同：4
> 
> 时间：2009-04-17T16:00:27.063
> 
> 标签：asp.net, authentication, intranet, userid

我们有一个 ASP.NET Intranet 站点，可供实际使用并登录到本地计算机的用户或通过 VPN 远程连接的用户使用。有没有办法根据用于登录本地计算机或用于 VPN 的名称自动获取访问该页面的用户的用户名？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-17T16:11:46.240

如果您在页面中使用 Windows 身份验证，这是可能的。

您可以使用其中一个`Page.User.Identity.Name`或更完整的`System.Web.HttpContext.Current.User.Identity.Name`.

在此处阅读更多信息：

[在 Intranet ASP.NET Web 应用程序中启用 Windows 身份验证](http://weblogs.asp.net/scottgu/archive/2006/07/12/Recipe_3A00_-Enabling-Windows-Authentication-within-an-Intranet-ASP.NET-Web-application.aspx)

但是，如果您使用表单身份验证，则必须自己跟踪当前用户，最常用的方法是将他们的登录名存储在 Session 变量中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-17T16:05:52.713

如果身份验证设置为进行集成 Windows 身份验证，那么您应该能够通过访问

```
User.Identity.Name
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-11T03:03:34.317

获取`User`信息如下：

```
User.Identity.Name \\ Get the User name
User.Identity.AuthenticationType \\ What is the Authentication type
User.Identity.IsAuthenticated \\ Is he authenticated?
User.IsInRole("Administrators") \\ Is he administrator? 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T16:07:38.560

如果身份验证是 Windows，这应该会有所帮助：

```
IIdentity WinId= HttpContext.Current.User.Identity;
WindowsIdentity wi = (WindowsIdentity)WinId; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-17T16:08:04.317

您可以使用

```
Page.User.Identity.Name 
```

# asp.net - .net 下拉列表对齐文本

> ID：761022
> 
> 赞同：2
> 
> 时间：2009-04-17T16:02:05.763
> 
> 标签：asp.net, css, drop-down-menu, alignment, web-controls

我正在尝试将 .net 下拉列表中的文本向右对齐。使用 CssClass 我可以在 Firefox 中将文本向右对齐。

IE 不会将文本向右对齐，而是向左对齐。我读过 IE 6 不支持这个。

1.  这是真的？

我使用的是 IE7，但我的大多数用户都使用 IE 6，所以两者都需要工作。

```
<asp:DropDownList ID="ddlNomination" Width="250px" CssClass="ddlnomination"
    runat="server" DataSourceID="Azoa" DataTextField="nomination_type" 
    DataValueField="nomination_type">
    <asp:ListItem> </asp:ListItem>
</asp:DropDownList> 
```

css

```
.ddlnomination
{
   text-align:right;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-17T16:29:36.870

在 IE6、IE7 和 IE8（即使在标准模式下）的 Select 或 Option 元素上设置它 ( `text-align="right"`) 似乎不起作用。

测试后的一些快速统计。

```
Browser    |  Result
 Firefox 3     Passes
 Opera 9.5     Passes
 IE 6          Fails
 IE 7          Fails
 IE 8          Fails
 Safari 3      Fails
 Safari 4      Fails
 Chrome        Fails on the Option element, Passes on the Select element 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T16:11:44.180

可悲的是，Dedrick 是真的……

如果在 IE6 中右对齐真的很重要，也许您可​​以添加空格来填充元素的左侧并使它们测量相同。无论如何，这是一个真正的痛苦......在这一点中IE6的声望点为-1！

# c++ - 获取背景窗口的缩略图

> ID：761023
> 
> 赞同：2
> 
> 时间：2009-04-17T16:02:30.333
> 
> 标签：c++, windows-mobile, gdi

我正在尝试获取不可见的窗口的缩略图。

这是我到目前为止的代码

```
BOOL CALLBACK WindowProc(HWND hWnd, LPARAM lParam)
{
    RECT WindRect;
    GetWindowRect(hWnd, &WindRect)
    CurrentScreenShot->Next = new ScreenShotList();
    CurrentScreenShot = CurrentScreenShot->Next;

    HDC SourceDC = GetDC(hWnd);
    HDC TargetDC = CreateCompatibleDC(SourceDC);
    CurrentScreenShot->ScreenShot = CreateCompatibleBitmap(SourceDC, WindRect.right - WindRect.left, WindRect.bottom - WindRect.top);

    BitBlt(TargetDC, 0, 0, WindRect.right - WindRect.left, WindRect.bottom - WindRect.top, SourceDC, 0, 0, SRCCOPY);

    ReleaseDC(hWnd, SourceDC);

    g_iWindows++;
    return TRUE;
} 
```

目前，`WindowProc`直接调用`FindWindow`用于获取句柄，但我最终想使用`EnumWindows`循环所有窗口以获取它们的缩略图并将它们存储在链接列表中。

```
WindowProc(FindWindow(NULL, L"File Explorer"), 0); 
```

此代码位于从 C# Forms 应用程序调用的 DLL 中。目前，C# 应用程序只需获取位图并将其保存到文件中。

问题是，除非我`FindWindow`用来获取可见窗口（也恰好是 C# 应用程序），否则图片最终会变成一个黑盒子。

是否可以获取背景窗口的图片？

**编辑**：这是一个 Windows Mobile 应用程序

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-18T13:33:40.467

隐形 Windows 没有重绘，这就是为什么您无法从 DC​​ 获取它们的内容的原因。尝试向目标窗口发送[WM_PRINT](http://msdn.microsoft.com/en-us/library/dd145216(VS.85).aspx)消息，请求它将其内容绘制到您的 DC。

**编辑：**

抱歉，我没有注意到这是针对 Windows Mobile 的。除了 WM_PRINT，我不知道如何获取不可见窗口的内容。当然，您仍然可以显示窗口（并确保它在顶部/未被其他窗口覆盖）然后运行您拥有的代码，但这可能有点混乱。

# algorithm - 封闭的多边形网格是否翻转？

> ID：761026
> 
> 赞同：3
> 
> 时间：2009-04-17T16:03:01.347
> 
> 标签：algorithm, graphics, geometry, 3d

我有一个 3d 建模应用程序。现在我正在双面绘制网格，但是当对象关闭时我想切换到单面。

如果多边形网格是闭合的（没有边界边/完全周期性），似乎我应该总是能够确定对象当前是否被翻转，并自动更正。

被翻转意味着我的法线指向对象而不是对象之外。被翻转是我的缠绕规则和当前正面设置不匹配的结果，但我直接从几何图形计算法线，因此查看法线是检测它的简单方法。

我在想的一件事是取边界框，找到最高点，看看它的法线点是向上还是向下——如果它向下，则对象被翻转。

但似乎这个解决方案可能容易出现退化几何错误或浮点错误，因为我只看一个点。我想我可以得到所有 6 个轴对齐的范围，但这似乎是一个更好的组合，而不是一个合适的解决方案。

有没有一种健壮、简单的方法来做到这一点？强大而努力也可以工作.. :)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-17T16:25:27.347

这是到达那里的一种稳健但缓慢的方式：

取一个从质心偏移的边界框的一角（强制它保证在封闭的多边形网格之外），然后创建一条从该角到网格上任何三角形中心点的线段。

测量该线段与三角形法线之间的角度。

将该线段与网格的每个三角形面相交（包括用于生成线段的三角形）。

如果有奇数个交叉点，法线和线段之间的角度应该 <180。如果有偶数，则应大于 180。

如果有偶数个交叉点，则数字应颠倒。

这应该适用于非常复杂的表面，但它们必须关闭，否则会崩溃。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T16:26:30.667

> “我正在双面绘制网格”

你为什么这样做？如果您使用的是 OpenGL，那么有一种更好的方法可以节省您自己的所有工作。采用：

```
glLightModeli(GL_LIGHT_MODEL_TWO_SIDE, 1); 
```

有了这个，所有的多边形总是两侧。
您想要使用单面照明的唯一原因是，如果您有一个开放或部分倒置的网格，并且您想通过不点亮它们来以某种方式指示哪个部分属于内部。

通常，您提出的问题是几何处理中的一个开放问题，AFAIK 没有万无一失的通用方法可以始终确定方向。正如您所建议的，有一些启发式方法几乎总是有效的。
另一种方法让人想起著名的多边形点算法：在网格上选择一个顶点并从它向法线方向射出一条射线。如果光线碰到偶数个面，则法线指向外部，如果是奇数，则法线指向内部。注意不要将原点算作交叉点。这种方法只有在网格是一个封闭的流形时才有效，并且如果光线恰好在两个多边形之间穿过，它可以达到一些边缘情况，所以你可能想要多次这样做并获得领先的投票。

# java - HTMLDocument：Swing 是否“优化”跨度元素？

> ID：761028
> 
> 赞同：0
> 
> 时间：2009-04-17T16:04:01.860
> 
> 标签：java, swing, element, dom

我在 Swing 的 JTextPane 中搞乱了 HTMLDocument。如果我有这种情况：

```
 <html>... 
    <p id='paragraph1'><span>something</span></p> 
    <span id='span1'><span>something else</span></span>
 ...</html> 
```

（额外的`<span>`标签是为了防止Swing抱怨我不能改变叶子的innerHTML）或者这种情况

```
 <html>... 
    <p id='paragraph1' />
    <span id='span1' />
 ...</html> 
```

我可以调用 HTMLDocument.getElement() 并找到 ID 为“paragraph1”的元素，但找不到 ID 为“span1”的元素。如果我将“span1”的标签从“span”更改为“p”，那么我很好。WTF在这里进行吗？是否有另一个我可以使用的 HTML 元素，它允许我使用 id 属性访问文档的特定部分，这不会导致换行符？（跨度本来是完美的:(啊！）

**编辑：**我认为解决方案是重新检查我正在尝试做的事情，这是利用我知道如何在 HTML 中制作 GUI + 表格 + 显示的事实比我在 Swing 中所做的要多得多，所以我会问一个不同的问题....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T16:26:39.137

我不知道摇摆，但是

`<p style="display: inline;">`不换行，同`<span>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-16T01:17:28.023

我正好有这个问题。我的跨度元素消失了。而如果我使用 div 我可以看到它们。但我当然不想要 div 元素，因为它会导致换行。

该死的！该死的爪哇。

编辑！

停止新闻！

找到了答案。至少，一个为我解决问题的答案。

我仍然能够确定我有我的 span 元素。我将描述我在做什么，并提供代码来说明我是如何做到的。

我想知道插入符号在哪个元素中。因此，此代码存在于 caretUpdate 函数中，它每次移动时都会为我提供插入符号的位置。

```
@Override
public void caretUpdate(CaretEvent e)
{
    System.out.println("caret event: " + e.toString());
    Object source = e.getSource();

    if (source instanceof JEditorPane)
    {
        JEditorPane jep = (JEditorPane)source;
        Document doc = jep.getDocument();
        if (doc instanceof HTMLDocument)
        {
            HTMLDocument hdoc = (HTMLDocument)doc;
            int pos = e.getDot();
            Element elem = hdoc.getCharacterElement(pos);
            AttributeSet a = elem.getAttributes();
            AttributeSet spanAttributeSet = (AttributeSet)a.getAttribute(HTML.Tag.SPAN);

            // if spanAttributeSet is not null, then we properly found ' a span '.
            // now we need to discover if it is one of OUR spans
            if (spanAttributeSet!=null)
            {
                Object type = spanAttributeSet.getAttribute(HTML.Attribute.TYPE);
                if (type !=null && type.equals("dragObject"))
                {
                    // for our logging, we get the ref, which holds the source
                    // of our value later
                    System.out.println("the value is: " + spanAttributeSet.getAttribute("ref"));
                }                   
            }
        }
    }
} 
```

编辑！！！

从头开始...这几乎可以工作...除了 Sun 的白痴决定密钥将是 HTML.Attribute 类型。不仅如此，HTML.Attribute 的构造函数是私有的，而且恰好我想要的属性类型不存在于他们的特权属性集中。混蛋！所以，一切都没有丢失......我仍然可以通过枚举器得到它......但这比它需要的要困难一些。

最后编辑！

好的，我现在明白了。如果属性是已知类型，则将其作为 HTML.Attribute("type") 的实例存储在 AttributeSet 中。否则，它以“String”作为键存储在 AttributeSet 中。愚蠢的。但我已经到了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T16:37:45.960

我查看了[HTMLDocument](http://java.sun.com/javase/6/docs/api/javax/swing/text/html/HTMLDocument.html)的 javadoc ，它指向了[HTMLReader](http://java.sun.com/javase/6/docs/api/javax/swing/text/html/HTMLDocument.HTMLReader.html)。

我没有在 HTMLReader 中看到任何关于 span 的提及。也许它只是不知道那个元素。

P 可能不是 span 的好替代品。P 是块级元素，span 是文本级元素[（参见这些术语的描述）](http://www.w3.org/TR/html4/struct/global.html#h-7.5.3)。也许尝试没有属性的字体（另一个文本级元素）？

# c# - 如果禁用 MSDTC，如何绕过 TransactionScope 内的多个数据库连接？

> ID：761031
> 
> 赞同：6
> 
> 时间：2009-04-17T16:04:23.730
> 
> 标签：c#, sql-server, transactions, asp.net-2.0

我有一个向 DAL 中的 3 个数据库发出请求的 Web 应用程序。我正在编写一些集成测试，以确保往返的整体功能确实符合我的预期。这与我的单元测试完全分开，仅供参考。

我打算编写这些测试的方式是这样的

```
[Test]
public void WorkflowExampleTest()
{
    (using var transaction = new TransactionScope())
    {
        Presenter.ProcessWorkflow();
    }
} 
```

在这种情况下，Presenter 已经设置好了。问题出现在 ProcessWorkflow 方法中，因为它调用了各种存储库，这些存储库依次访问不同的数据库，并且我的 sql 服务器框没有启用 MSDTC，所以每当我尝试创建新的 sql 连接或尝试更改缓存连接的数据库以针对不同的数据库。

为简洁起见，Presenter 类似于：

```
public void ProcessWorkflow()
{
    LogRepository.LogSomethingInLogDatabase();
    var l_results = ProcessRepository.DoSomeWorkOnProcessDatabase();
    ResultsRepository.IssueResultstoResultsDatabase(l_results);
} 
```

我尝试了很多方法来解决这个问题。

1.  始终缓存一个活动连接并更改目标数据库
2.  为每个目标数据库缓存一个活动连接（这有点没用，因为池应该为我做这件事，但我想看看我是否得到不同的结果）
3.  在每个存储库中添加额外的 TransactionScope，以便它们使用 TransactionScopeOption“RequiresNew”拥有自己的事务

我在列表中的第三次尝试看起来像这样：

```
public void LogSomethingInLogDatabase()
{
    using (var transaction = 
        new TransactionScope(TransactionScopeOption.RequiresNew))
    {
        //do some database work

        transaction.Complete();
    }
} 
```

实际上，我尝试的第三件事实际上让单元测试工作，但所有完成的事务实际上都命中了我的数据库！所以这是一个彻底的失败，因为整点是不影响我的数据库。

因此，我的问题是，鉴于我提出的限制，还有哪些其他选择可以完成我正在尝试做的事情？

**编辑：**

这就是“//做一些数据库工作”的样子

```
using (var l_context = new DataContext(TargetDatabaseEnum.SomeDatabase))
{
    //use a SqlCommand here
    //use a SqlDataAdapter inside the SqlCommand
    //etc.
} 
```

DataContext 本身看起来像这样

```
public class DataContext : IDisposable
{
   static int References { get; set; }
   static SqlConnection Connection { get; set; }

   TargetDatabaseEnum OriginalDatabase { get; set; }

   public DataContext(TargetDatabaseEnum database)
   {
       if (Connection == null)
          Connection = new SqlConnection();

       if (Connection.Database != DatabaseInfo.GetDatabaseName(database))
       {
           OriginalDatabase = 
               DatabaseInfo.GetDatabaseEnum(Connection.Database);

           Connection.ChangeDatabase(
               DatabaseInfo.GetDatabaseName(database));
       }           

       if (Connection.State == ConnectionState.Closed)
       {
           Connection.Open() //<- ERROR HAPPENS HERE
       }    

       ConnectionReferences++;                 
   }

   public void Dispose()
   {
       if (Connection.State == ConnectionState.Open)
       {
           Connection.ChangeDatabase(
               DatabaseInfo.GetDatabaseName(OriginalDatabase));
       }

       if (Connection != null && --ConnectionReferences <= 0)
       {
           if (Connection.State == ConnectionState.Open)
               Connection.Close();
           Connection.Dispose();
       }
   }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-08-04T17:41:15.573

1.  在连接字符串上设置**Enlist=false**以避免在事务中自动登记。

2.  手动将连接登记为事务范围的参与者。[(http://msdn.microsoft.com/en-us/library/ms172153%28v=VS.80%29.aspx)](http://msdn.microsoft.com/en-us/library/ms172153%28v=VS.80%29.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-21T16:59:56.137

好的，我找到了解决这个问题的方法。我这样做的唯一原因是因为我找不到任何其他方法来解决这个问题，而且因为它在我的集成测试中，所以我不担心这会对生产代码产生不利影响。

我必须向我的 DataContext 添加一个属性来充当一个标志，以跟踪在处置我的 DataContext 时是否处置连接对象。这样，连接在整个事务范围内保持活动状态，因此不再打扰 DTC

这是我的新 Dispose 示例：

```
internal static bool SupressConnectionDispose { get; set; }

public void Dispose()
{
   if (Connection.State == ConnectionState.Open)
   {
       Connection.ChangeDatabase(
           DatabaseInfo.GetDatabaseName(OriginalDatabase));
   }

   if (Connection != null 
       && --ConnectionReferences <= 0 
       && !SuppressConnectionDispose)
   {
       if (Connection.State == ConnectionState.Open)
           Connection.Close();
       Connection.Dispose();
   }
} 
```

这允许我的集成测试采取以下形式：

```
[Test]
public void WorkflowExampleTest()
{
    (using var transaction = new TransactionScope())
    {
        DataContext.SuppressConnectionDispose = true;

        Presenter.ProcessWorkflow();
    }
} 
```

我不建议在生产代码中使用它，但对于集成测试，我认为它是合适的。另请记住，这仅适用于服务器始终相同的连接以及用户。

我希望这可以帮助遇到我遇到同样问题的其他人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T16:51:12.760

如果不想使用 MSDTC，可以直接使用 SQL 事务。

见`SqlConnection.BeginTransaction()`。

# php - SEO历史和PHP

> ID：761034
> 
> 赞同：2
> 
> 时间：2009-04-17T16:05:02.433
> 
> 标签：php, seo

最近有人告诉我，

“过去，Google 从未索引 PHP 页面”。

我不相信有几个原因。但我不是 SEO 专家，甚至不是新手，所以我想知道。在我将那个人归为“不可靠”之前，我想我会问 SO 社区：这有什么问题吗？

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-17T16:07:55.267

荒谬的是，有些人（正确地）争辩说谷歌倾向于支持静态内容，因为它很少改变，但我不确定那是多么真实。

从马嘴里得到它：

请参阅：http: [//googlewebmastercentral.blogspot.com/2008/09/dynamic-urls-vs-static-urls.html](http://googlewebmastercentral.blogspot.com/2008/09/dynamic-urls-vs-static-urls.html)

此外，确实，Javascript 生成的内容（或由 Ajax 提取的内容）完全被忽略了。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-17T16:52:33.273

实际上，我认为“Google 从未索引 PHP 页面”绝对是正确的说法。Google 无权访问 PHP 代码，因此无法对其编制索引。Google 也不索引 Java、Ruby、Perl、Python 或任何其他后端代码。

谷歌只索引输出，不管是什么生成的输出。Google 甚至无法判断生成页面的语言类型（尽管它可以通过扩展名猜测）。您可以轻松更改 Apache 以将所有以 .asp 结尾的文件视为 PHP 文件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-17T16:21:54.577

嗯，搜索引擎优化中国电话民间传说。我发誓，“SEO 技术人员”所做的胡说八道中有一半是基于归因错误，比如这个错误，或者是基于 1996 年 AltaVista 的索引实践。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-17T16:07:49.057

索引**动态**页面的问题是使用了很长的讨厌的查询字符串 url:`www.example.com/somepage.php?lol=23423423&lol2=25235`等等。谷歌本身从来*没有不索引它们，但这样做肯定不是很有效。*SEO 技术，如 URL 重写，只会增强可搜索性和可索引性。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-17T16:09:23.377

以下是一些反例：[http ://www.google.com/search?hl=en&q=inurl:.php+page&btnG=Search](http://www.google.com/search?hl=en&q=inurl:.php+page&btnG=Search)

不，这从来都不是真的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-17T16:11:00.440

就像几乎所有不良信息一样，有一个事实推动了这封信。

首先 - 不 - Google 或任何搜索机器人不会明确忽略具有特定扩展名、PHP 或其他方式的页面。

其次，像 GoogleBot 这样的搜索机器人是非常复杂、善变的生物。衡量和衡量页面的维度和因素如此之多，以至于没有任何一件事比另一件事更有影响力。这里的其他用户已经指出了与页面内容的动态程度有关的 SEO 问题。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-02-21T16:47:14.667

将此添加到来自对某事的误解或彻头彻尾的谎言的长长的[SEO 错误信息列表中。](http://kercommunications.com/seo/seo-misconceptions/)我的猜测是，告诉你这个的人要么对 SEO 了解不足，要么他们对使用 PHP 进行开发一无所知，并且以模糊的 SEO 原因作为不使用 PHP 的借口。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-17T16:08:44.843

谷歌不在乎你拥有什么样的页面，如果它可以访问它，它就会将它编入索引。Javascript 是个例外，googlebot 不会对其进行评估。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-17T16:10:26.307

好吧，这绝对不是完全正确的，因为 wordpress 博客会产生大量的 SEO 并且是用 PHP 编写的。

也就是说，这个人很可能依赖于不完整的信息并就动态页面发表声明并将其称为 PHP。如果 >any< 页面碰巧设置了正确的 HTTP 标头，它将阻止它被很好地编入索引。

其他一些海报还指出，在 URLS 中使用讨厌的查询字符串也会妨碍 SEO，但同样，您不必在您的 php 网站中使用动态 URLS！再次参见 wordpress。

SEO是一门黑色艺术，它有很多东西。我会怀疑任何关于 SEO 的笼统声明，因为几乎可以肯定会有一些不合适的边缘案例。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-17T16:21:20.913

好吧，你不能*得到*一个php页面，你只能得到执行它的结果。然后，考虑一下搜索引擎会如何处理每次检索时都不同的页面，特别是如果它按*相同结果*链接到的次数进行排名。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-17T16:21:38.650

很久很久以前，谷歌没有用 GET 传递的参数（在 URL 中）索引[“深网”页面。](http://en.wikipedia.org/wiki/Deep_web)但那是古老的历史，现在谷歌能够索引它们，而且大多数动态框架无论如何都会生成“友好”的 URL。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-26T02:54:03.573

我认为这很难说。

如果你认为可以，那它怎么会对待每次检索到的内容都不一样呢？如果它可以做到这一点，那么 SEO 作弊者就有很大的空间。

如果你不认为它可以索引 PHP，那么你不觉得它对于 Googlebot 来说有点过时了吗？
我的结论是，如果可以的话，尽量不要使用动态内容。

对不起，我发现我的帖子现在没用了！

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-11-22T15:53:31.310

只要所有动态工作都在服务器端完成，Googlebot 并不关心页面是由什么构成的。只有当动态的东西在客户端（JavaScript）完成时才会出现问题。URL 可能是影响关键字词组索引和相关性的一个因素，但如果遵循设计、开发和 SEO 的最佳实践，则不会成为问题。

# asp.net - 如何使用 ASP.NET 进行应用程序/xml POST？

> ID：761035
> 
> 赞同：1
> 
> 时间：2009-04-17T16:05:08.427
> 
> 标签：asp.net, post

我需要制作一个小处理程序，它需要一些查询字符串数据并用它制定一个到 BaseCamp API 的帖子。问题是我不完全确定这是如何完成的，如何指定要访问的 URL，以及将构建的 XML 放在哪里（我已经构建了 XML）。然后我如何“按 GO”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T16:09:21.567

按照这个[例子](http://authors.aspalliance.com/stevesmith/articles/netscrape2.asp)，它向您展示了如何从 ASP.NET 发布，非常简单。

# sql-server - 为什么 sql server 在 NVarchar 字段中存储问号字符而不是日文字符？

> ID：761036
> 
> 赞同：38
> 
> 时间：2009-04-17T16:05:30.217
> 
> 标签：sql-server

我正在尝试将日文字符存储在我的 SQL Server 2000 数据库中的 nvarchar 字段中。

当我运行如下更新语句时：

```
update blah 
set address = N'スタンダードチャ'
where key_ID = 1 
```

从 SQL Server Management Studio，然后运行一个选择语句，我只看到返回到结果窗口的问号。我在查看数据库的网页中看到了相同的问号。

看来这是存储正确数据的问题吗？谁能告诉我我需要做些什么不同的事情？

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2010-02-04T15:10:05.163

鉴于您的示例，这不是一个正确的答案，但我看到的最常见原因是字符串文字不需要 unicode N 前缀。

所以，而不是

```
set address = N'スタンダードチャ' 
```

有人会尝试写入没有 unicode 前缀的 nvarchar 字段

```
set address = 'スタンダードチャ' 
```

另请参阅： [Transact-SQL 查询中字符串前的 N 前缀](https://stackoverflow.com/questions/217535/n-prefix-before-string-in-transact-sql-query)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2014-04-09T07:15:42.110

在存储在 DB nvarchar 字段中时使用印度语言字符时，我遇到了同样的问题。然后我浏览了这篇微软文章 -

[http://support.microsoft.com/kb/239530](http://support.microsoft.com/kb/239530)

我遵循了这一点，我的 unicode 问题得到了解决。在这篇文章中，他们说 -当您在 SQL Server 中处理 Unicode 字符串常量时，您必须**在所有 Unicode 字符串前面加上前缀 N**

**SQL Server Unicode 支持**

SQL Server Unicode 数据类型支持 UCS-2 编码。Unicode 数据类型对每个字符使用两个字节而不是一个字节来存储字符数据。两个字节中有 65,536 种不同的位模式，因此 Unicode 可以使用一组标准的位模式对所有语言中的每个字符进行编码，包括诸如中文等具有大量字符的语言。

**在 SQL Server 中，支持 Unicode 数据的数据类型有：**

```
nchar
nvarchar
nvarchar(max) – new in SQL Server 2005
ntext 
```

nchar、nvarchar、nvarchar(max) 和 ntext 的使用分别与 char、varchar、varchar(max) 和 text 相同，除了：

```
- Unicode supports a wider range of characters.
- More space is needed to store Unicode characters.
- The maximum size of nchar and nvarchar columns is 4,000 characters, not 8,000     characters like char and varchar.
- Unicode constants are specified with a leading N, for example, N'A Unicode string' 
```

**适用于**

```
Microsoft SQL Server 7.0 Standard Edition
Microsoft SQL Server 2000 Standard Edition
Microsoft SQL Server 2005 Standard Edition
Microsoft SQL Server 2005 Express Edition
Microsoft SQL Server 2005 Developer Edition
Microsoft SQL Server 2005 Enterprise Edition
Microsoft SQL Server 2005 Workgroup Edition 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-08-21T13:33:58.493

代码绝对没问题。您可以将带有前缀 N 的 unicode 字符串插入声明为 NVARCHAR 的字段中。那么你能检查一下 Address 是否是一个 NVARCHAR 列。在 SQL Server 2008R2 中测试了以下代码，它工作正常。

```
update blah 
set address = N'スタンダードチャ'
where key_ID = 1 
```

[在此处输入图像描述](https://i.stack.imgur.com/3mkAR.png)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-11-03T10:35:11.073

您需要在字符串值之前写 N 。egINSERT INTO LabelManagement(KeyValue) VALUES(N'変更命令')；在这里，我以日语存储值，并且在字符串字符之前添加了 N。我正在使用 Sql server 2014。希望您找到解决方案。享受。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-17T16:06:39.107

您需要从您的数据库、数据访问和表示层检查处理此数据的所有代码的全球化设置。这包括 SSMS。

（您还需要弄清楚您使用的是哪个版本，2003 不存在...）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-17T16:11:04.667

SSMS 无法正确显示，您可能会看到问号或方框

将结果粘贴到单词中，它们应该是日语

在需要设置Content-Type的网页中，下面的代码会显示中文Big5

```
<META HTTP-EQUIV="content-type" CONTENT="text/html; charset=big5"> 
```

要验证数据，您不能使用 ascii，因为 ascii 只能看到 ascii 字符集

运行这个

> 选择 unicode(address),ascii(address) from blah where key_ID = 1

输出应该如下（它只看第一个字符） 12473 63

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-06-28T07:01:11.973

我几乎可以保证数据类型不是 unicode。如果您想了解更多信息，可以查看 Wikipedia 以获取有关 Unicode、ASCII 和 ANSI 的信息。Unicode 可以存储更多唯一字符，但需要更多空间来存储、传输和处理。还有一些程序和其他东西不支持 unicode。MS SQL 的 unicode 数据类型是“nchar”、“nvarchar”和“ntext”。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-04-04T19:09:02.617

我们正在使用`Microsoft SQL Server 2008 R2(SP3)`. 我们的表排序规则指定为`SQL_Latin1_General_CP1_CI_AS`。我将我的类型指定为 n 种

```
nvarchar(MAX)
nchar(2) 
```

..ETC

要插入日文字符，我在字符串前面加上大写 N

```
N'素晴らしい一日を' 
```

奇迹般有效。

# c# - 使用 C# 在 ASP.Net 2.0 中添加新标签

> ID：761041
> 
> 赞同：0
> 
> 时间：2009-04-17T16:07:01.837
> 
> 标签：c#, asp.net, asp.net-2.0, label

我正在使用 ASP.NEt 2.0 实现一个网站，并且我想在按下现有按钮时添加一个新标签 有人可以帮我这样做吗？？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T16:11:08.630

在按钮的 OnClick 事件中：

```
Label lbl = new Label();
lbl.Text = "some text";

ControlContainingLabel.Controls.Add(lbl); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T16:11:12.780

您可以使用[Syed Tayyab Ali 的回答](https://stackoverflow.com/a/761057/2372960)创建标签，但是如果有人单击另一个按钮并且您收到另一个回发，您创建的第一个标签将消失，因为页面将从头开始重新创建。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T16:24:40.517

如果按钮不依赖于标签文本中的内容，或者服务器没有更新标签中显示的信息，则没有理由将其添加到服务器端。您可以轻松地将标签放在客户端代码中所需的位置，并使用某种形式的 javascript (jQuery) 来隐藏它，然后在单击按钮时取消隐藏标签，如下所示：

```
 $(function(){
    $('.label1').hide(); //hide the label with the class name label1
    $('.button1').click(function(){  // bind the button's click event
      $('.label1').show(); //unhide the label 

    });
   }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T16:09:27.993

您需要创建新的标签实例，然后在预先存在的按钮事件中使用 control.add(lable1) 添加标签控件。

每当您点击预先存在的按钮时，它都会在页面上添加您的标签。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-15T12:17:39.593

这是一个可能对您有所帮助的简单解决方案。首先向容器添加标签（例如表单、面板等）并使用以下代码将其隐藏：-

```
label1.hide(); 
```

您必须在 form_load 函数中输入上述代码，然后在 button1_click 函数中输入以下代码

```
label1.show();
label1.text="some text"; 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2010-06-03T09:00:24.327

标签 lbl = 新标签（）；lbl.Text = "一些文字";

ControlContainingLabel.Controls.Add(lbl);

标签lbl lblแสดงต้องต้องเขียนเขียนโค้ดคะคะคะคะคะคะคะคะ

# asp.net - 如何向不同的客户端公开 wcf 服务

> ID：761042
> 
> 赞同：2
> 
> 时间：2009-04-17T16:07:07.517
> 
> 标签：asp.net, wcf

我正在创建一个 wcf 服务。当我将服务作为“Web 引用”添加到我的网站时（我通过使用 URL：[http://localhost/myservice.svc?wsdl](http://localhost/myservice.svc?wsdl)来执行此操作）然后调用服务公开的 Web 方法，我得到一个“操作已超时”异常。但是，当我将服务作为“服务参考”添加到站点时，调用工作正常。

我将其添加为 Web 参考的原因是，我想将 wcf 服务公开给所有客户端，如 java、php .....

我看过“ [http://blogs.msdn.com/juveriak/archive/2008/03/18/wcf-proxy-that-works-with-different-clients.aspx](http://blogs.msdn.com/juveriak/archive/2008/03/18/wcf-proxy-that-works-with-different-clients.aspx) ”中的文章，但我没有尝试过按照本文的建议将 wsdl 转换为类型化代理。

关于为什么在将其用作网络参考时出现超时错误的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-17T16:18:21.763

您可能正在使用[`WsHttpBinding`](http://msdn.microsoft.com/en-us/library/system.servicemodel.wshttpbinding.aspx)而不是[`BasicHttpBinding`](http://msdn.microsoft.com/en-us/library/system.servicemodel.basichttpbinding(VS.95).aspx). .NET 2.0 Web 服务不能使用`WsHttpBinding`服务。

问题是协议之一。Web 服务协议不断变化，增加了安全性、联合身份等。随着它们的变化，旧技术无法使用新协议进行通信。

值得庆幸的是，WCF 将允许您在单个服务中使用多个协议——只需为您要使用的每个协议设置单独的端点。但是要小心，因为有些比其他的更安全。

关于版本控制，[`MessageVersion`](http://msdn.microsoft.com/en-us/library/system.servicemodel.channels.messageversion.aspx)该类是一个很好的起点。

**编辑：**我应该提到您需要`MessageVersion`用作自定义[`TextMessageEncodingBindingElement`](http://msdn.microsoft.com/en-us/library/system.servicemodel.channels.textmessageencodingbindingelement.aspx)绑定的一部分，如下所示：

```
<bindings>
    <customBinding>
        <binding name="MyBinding">
            <textMessageEncoding messageVersion="Soap11WSAddressing10"/>
            <httpTransport/>
        </binding>
    </customBinding>
</bindings> 
```

# sql - SQL 查询帮助

> ID：761044
> 
> 赞同：1
> 
> 时间：2009-04-17T16:07:42.647
> 
> 标签：sql, tsql

### 复制：

> [如何在选择中进行选择](https://stackoverflow.com/questions/760950/how-to-do-a-select-in-a-select)

我有 2 张桌子：

```
TABLE1
Table1Id

TABLE2
Table2Id
Table1Id
UserId 
```

TABLE2 中有数千个条目。我想返回一个 TABLE1 条目列表，其中 TABLE2 中没有针对特定用户的条目。因此，TABLE2 中没有外键条目。像这样的查询：

```
select count(*) from TABLE1 where Table1Id not in (
select Table1Id from TABLE2 where id_user = 1) 
```

但是，该查询运行非常缓慢。获得我需要的结果的最有效方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-17T16:10:55.027

有一个类似的[问题](https://stackoverflow.com/questions/760950/how-to-do-a-select-in-a-select)

我觉得会更好

```
SELECT COUNT(*) 
FROM TABLE1 
WHERE NOT EXISTS (SELECT Table1Id FROM TABLE2 WHERE TABLE2.Table1Id = TABLE1.Table1Id AND UserID = 1) 
```

正如ck建议的那样，我也会检查索引

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T16:16:15.340

关于什么

```
select Table1Id from TABLE1 
minus
select Table1Id from TABLE2 where id_user = 1 
```

我不确定，它 MsSql 支持减号。如果没有，您应该尝试相关子查询。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T16:17:15.433

只要选择返回相同的字段类型/顺序，您还可以使用“EXCEPT/MINUS”相交来仅获取两个表之间的差异。

```
SELECT TABLE1ID
FROM TABLE1
EXCEPT -- or MINUS in Oracle
SELECT TABLE1ID
FROM TABLE2
WHERE USER_ID = 1 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-17T16:09:04.407

请参阅[如何在选择中进行选择](https://stackoverflow.com/questions/760950/how-to-do-a-select-in-a-select)

此外，请确保您查询的任何字段都有合适的索引。

# ruby-on-rails - 在 Rails 中使用自定义控制器时从 URL 获取资源名称

> ID：761051
> 
> 赞同：2
> 
> 时间：2009-04-17T16:08:49.820
> 
> 标签：ruby-on-rails, ruby, url, rest, resources

我有一组在运行时动态生成的路由，但它们都指向同一个控制器，即

```
map.resources :authors, :controller => 'main'
map.resources :books, :controller => 'main' 
```

这些都可以正常工作，产生类似`/authors/1`, `/books`,`/books/55`等的路由，然后最终都由“主”控制器处理。

但是，我似乎无法找到如何在控制器中获取资源的名称，即当 URL 是`/authors`或`/books`我希望能够确定它是哪个资源时，即在 index 操作中，即 Author 或 Book

我不能为此使用单独的控制器。

这是可能吗 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T17:08:19.367

编辑：完全改变答案，因为它已经过时了。

因此，因为它更改了您在操作中看到的参数，所以您必须获取实际的 uri。这真的和特里建议的一样简单。

```
 def index
   if request.request_uri =~ /books/
     #...
   else
     # if it is a author
   end
 end 
```

这会将请求 uri（之后的部分`localhost:3000`）与书籍进行比较，因此您可以看到用户请求的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T16:32:28.437

我认为没有类似 .resource 方法的东西，但您可以查看 request.request_uri，在您的情况下，它会返回 /authors 或 /books 之类的内容，并且可以采取相应的行动。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T16:00:13.090

[请参阅ActionController::Routing](http://api.rubyonrails.org/classes/ActionController/Routing.html)文档的“默认路由和默认参数”部分。您可以将希望发送到控制器的任意额外参数编程到您的路由中。

查看请求 URI 将迫使您保持路由和控制器同步，这将使您的代码更脆弱，更不容易重用。尽可能避免。

# iphone - 了解用于查找内存泄漏的“泄漏”命令行实用程序

> ID：761077
> 
> 赞同：5
> 
> 时间：2009-04-17T16:14:39.480
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch, memory-leaks

我正在努力追踪我的 iPhone 程序中一些难以发现的内存泄漏。我正在对一个应用程序进行快速测试，该应用程序使用以下故意不正确的代码泄漏 NSString 对象：

```
-(void)applicationDidFinishLaunching:(NSNotification *)notification;
{
    NSMutableString *test = [[NSMutableString alloc] init];
    [test appendString:@"Testing 1"];
    [test appendString:@"\nTesting 2"];
    NSLog(@"%@", test);

    // Uncomment the following line to release the
    // string and clean up your leak.
    // [test release], test = nil;
} 
```

在应用程序的进程 ID 上运行泄漏后，我想出了以下内容：

```
sf$ leaks 3951
Process 3951: 9988 nodes malloced for 1260 KB
Process 3951: 3 leaks for 128 total leaked bytes.
Leak: 0x163b50  size=64 instance of 'NSCFDictionary', type ObjC, implemented in Foundation  
    0xa07e0720 0x01001080 0x0000000a 0x00000010      .~.............
    0x0000000a 0x0000000c 0x0000000b 0x00000000     ................
    0x00000000 0x00000015 0xa1b1c1d3 0x00163b90     .............;..
    0x00163bd0 0x00000000 0x00000000 0x00000000     .;..............
Leak: 0x178190  size=32 string 'Testing 1
Testing 2'
Leak: 0x178210  size=32 instance of 'NSCFString', type ObjC, implemented in CoreFoundation  
    0xa02e24a0 0x010007ad 0x00178190 0x00000013     .$..............
    0x00000020 0x00000200 0x00000000 0x00000000      ............... 
```

现在，我们都知道泄漏在哪里。这不是这个练习的重点，至少对我来说。我试图了解如何理解这个输出。我被告知有3个泄漏。

它们是位于内存地址 0x163b50、0x178190、0x178210 的对象。根据“泄漏”，他们的实现是在 Apple 框架中，而不是我的代码中。在下面这样一个简单的例子中，找到泄漏点并不难。然而，在一个有 500K 行代码的应用程序中，我发现泄漏的输出在这里毫无用处。

我做错了什么，如何理解这个输出来帮助我找到我为清理内存泄漏而编写的代码中的罪魁祸首？

请注意，这个帖子不应该提倡使用 Instruments 或 Clang Static Analyzer。我已经清理了 Clang 静态分析器向我报告的所有内存泄漏。Instruments 对我来说是臃肿且无信息的。我收到了大量关于泄漏的报告，但堆栈跟踪显示的任何一个都没有回到我自己的代码中——尽管我确信泄漏确实在我的代码中。我想在这里弄清楚如何使用命令行泄漏工具。

谢谢大家。

**编辑**：即使在取消注释清理泄漏的行之后，“泄漏”实用程序的抱怨甚至比泄漏时还要多。Foundation/Cocoa 是否从这样一个微不足道的例子中泄漏了那么多？这发生在取消注释上述测试字符串的版本后：

```
sf$ leaks 4383
Process 4383: 9890 nodes malloced for 1255 KB
Process 4383: 7 leaks for 560 total leaked bytes.
Leak: 0x163920  size=176    instance of 'NSPathStore2', type ObjC, implemented in Foundation    
    0xa07e2ae0 0x04f00000 0x0055002f 0x00650073     .*~...../.U.s.e.
    0x00730072 0x0073002f 0x002f0066 0x0069004c     r.s./.s.f./.L.i.
    0x00720062 0x00720061 0x002f0079 0x00700041     b.r.a.r.y./.A.p.
    0x006c0070 0x00630069 0x00740061 0x006f0069     p.l.i.c.a.t.i.o.
    0x0020006e 0x00750053 0x00700070 0x0072006f     n. .S.u.p.p.o.r.
    0x002f0074 0x00490053 0x0042004d 0x002f004c     t./.S.I.M.B.L./.
    0x006c0050 0x00670075 0x006e0069 0x002f0073     P.l.u.g.i.n.s./.
    0x00650054 0x006d0072 0x006e0069 0x006c0061     T.e.r.m.i.n.a.l.
    ...
Leak: 0x163350  size=160    instance of 'NSPathStore2', type ObjC, implemented in Foundation    
    0xa07e2ae0 0x04a00000 0x0055002f 0x00650073     .*~...../.U.s.e.
    0x00730072 0x0073002f 0x002f0066 0x0069004c     r.s./.s.f./.L.i.
    0x00720062 0x00720061 0x002f0079 0x00700041     b.r.a.r.y./.A.p.
    0x006c0070 0x00630069 0x00740061 0x006f0069     p.l.i.c.a.t.i.o.
    0x0020006e 0x00750053 0x00700070 0x0072006f     n. .S.u.p.p.o.r.
    0x002f0074 0x00490053 0x0042004d 0x002f004c     t./.S.I.M.B.L./.
    0x006c0050 0x00670075 0x006e0069 0x002f0073     P.l.u.g.i.n.s./.
    0x00650044 0x0069006c 0x00690063 0x0075006f     D.e.l.i.c.i.o.u.
    ...
Leak: 0x1635a0  size=64 instance of 'NSCFDictionary', type ObjC, implemented in Foundation  
    0xa07e0720 0x01001080 0x0000000a 0x00000010      .~.............
    0x0000000a 0x0000000c 0x0000000b 0x00000000     ................
    0x00000000 0x00000015 0xa1b1c1d3 0x001635e0     .............5..
    0x00163620 0x00000000 0x00000000 0x00000000      6..............
Leak: 0x163620  size=64 
    0xa02ed360 0x00160ee0 0x00163700 0xa02efc00     `........7......
    0x00000000 0x00000000 0x00163680 0x00000000     .........6......
    0x00000000 0x00000000 0x00163660 0xa02ed440     ........`6..@...
    0xa02ec1a0 0xa02f0420 0x00000000 0x00163660     .... ./.....`6..
Leak: 0x163680  size=48 instance of 'NSCFString', type ObjC, implemented in CoreFoundation  
    0xa02e24a0 0x0100078c 0x6d6f6323 0x6c65642e     .$......#com.del
    0x6f696369 0x61737375 0x69726166 0x6c65442e     icioussafari.Del
    0x6f696369 0x61537375 0x69726166 0x00000000     iciousSafari....
Leak: 0x163660  size=32 instance of 'NSCFString', type ObjC, implemented in CoreFoundation  
    0xa02e24a0 0x0200078c 0x6c65440f 0x6f696369     .$.......Delicio
    0x61537375 0x69726166 0x00000000 0x00000000     usSafari........
Leak: 0x160ee0  size=16 instance of 'NSCFString', type ObjC, implemented in CoreFoundation  
    0xa02e24a0 0x0100078c 0x362e3103 0x00000000     .$.......1.6.... 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-17T20:16:19.180

您显示的输出中没有堆栈跟踪。您看到的地址是对象自己的地址，而不是函数指针，标点符号旁边的十六进制数字只是数据的十六进制转储。

要找出对象是从哪里分配*的*，请在泄漏的环境中设置 MallocStackLogging：

```
% MallocStackLogging=1 leaks … 
```

您可能还想使用 -nocontent 选项，该选项将禁止十六进制转储。但是，不要一直使用它：有时十六进制转储包含有价值的线索。

此外，泄漏不一定告诉您有三个泄漏；准确地说，它告诉你有三个*泄漏的对象*。您展示的故意泄漏仅产生一个泄漏对象，但不同的泄漏（例如在循环或经常调用的方法中）可能会泄漏许多对象。

编辑：顺便说一句，其中一些泄漏来自 SIMBL 或您的一个或多个 SIMBL 插件。在寻找泄漏之前关闭 SIMBL 和任何其他输入管理器黑客。请记住，该代码在您的进程中运行；此外，leaks 不关心谁的代码分配或泄漏了内存，只关心它被泄漏了，所以它会显示泄漏的对象，而不管是谁分配或泄漏它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T17:45:57.387

我认为您在泄漏中看到这种情况的原因是因为在内部`appendString`使用`autorelease`。直到下一个“事件”，自动释放池才会被丢弃。基本上，我认为样本太简单了，无法准确地显示正在发生的事情。

我可能会在这里偏离基础，但我会尝试将您的代码包装在自动释放池中以查看发生了什么变化。

```
-(void)applicationDidFinishLaunching:(NSNotification *)notification;
{
    NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
    NSMutableString *test = [[NSMutableString alloc] init];
    [test appendString:@"Testing 1"];
    [test appendString:@"\nTesting 2"];
    NSLog(@"%@", test);
    [test release], test = nil;
    [pool release] // this should drain the autorelease pool
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T17:02:22.483

对于此示例，泄漏报告 3 个泄漏，总共 128 个字节。解释应如下：

1）您正在泄漏一个 NSMutableString，它似乎在内部实现为 NSCFDictionary，总共 64 个字节

2）您正在泄漏测试 1，总共 32 个字节

3) 你正在泄漏\n测试 2 总共 32 个字节

这应该是因为如果您不释放 NSMutableString，则不会释放任何属于 NSCFDictionary 数据结构的对象（在本例中为字符串）：每次使用 appendString 方法时都会保留它们。当你释放你的 NSMutableString 时，NSCFDictionary 中的所有对象都会自动释放，连同 NSCFDictionary 本身。

从苹果文档（[http://developer.apple.com/iPhone/library/documentation/Performance/Conceptual/ManagingMemory/Articles/FindingLeaks.html](http://developer.apple.com/iPhone/library/documentation/Performance/Conceptual/ManagingMemory/Articles/FindingLeaks.html)）：

如果 Cocoa 对象在没有自动释放池的情况下自动释放，Xcode 会向控制台发送一条消息，警告您该对象正在泄漏。即使您不是在编写 Cocoa 应用程序，也可能会看到相同类型的控制台警告。许多 Cocoa 类的实现基于 Core Foundation 类型。如果您的应用程序使用 Core Foundation，则可能由于调用该框架而发生泄漏。

要查找这种类型的内存泄漏，请使用调试器在 _NSAutoreleaseNoPool 函数上放置断点。该函数在 Foundation 框架的 NSDebug.h 中声明。当调试器到达该函数时，您应该能够查看堆栈爬网并查看是哪段代码导致了泄漏。

# file - GTK# FileChooserDialog 中的 HTTP uri

> ID：761079
> 
> 赞同：2
> 
> 时间：2009-04-17T16:15:02.270
> 
> 标签：file, dialog, gtk

GTK# 的[FileChooserDialog](http://www.go-mono.com/docs/monodoc.ashx?link=T%3aGtk.FileChooserDialog)可以用作统一的文件/URI 对话框吗？我希望它接受 http/https/ftp URI 而无需“重写”它们（在本地目录之前）。

即使我将`LocalOnly=false`http://.... uri 设置并粘贴到文件选择器内的文本框中，我也无法获得原始条目。本地目录总是附加在文本前面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-21T07:55:22.827

我做了一些研究，我认为这是不可能的。至少不使用我测试过的直接原生 C GTK+ API。

在我的测试中，我总是将本地目录的路径添加到我在对话框中输入的 http:// URI 前面，或者我返回（null）。我确实调用了该`[get_uri()](http://library.gnome.org/devel/gtk/stable/GtkFileChooser.html#gtk-file-chooser-get-uri)`方法，而不仅仅是`[get_filename](http://library.gnome.org/devel/gtk/stable/GtkFileChooser.html#gtk-file-chooser-get-filename)()`.

作为参考，我还快速浏览了[GIMP](http://gimp.org/)应用程序的文件菜单。您可能知道，GIMP 在 GTK+ 中提供了 G，因此有时可以将其用作有关如何使用该工具包的想法的参考。GIMP 不尝试支持在文件选择器对话框中输入的 URI，而是有一个专用的[打开位置](http://docs.gimp.org/en/ch05s03s02.html)命令，该命令打开一个只有 GtkEntry 的简单对话框。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T21:55:16.067

我认为您需要将[local-only](http://library.gnome.org/devel/gtk/stable/GtkFileChooser.html#gtk-file-chooser-set-local-only "仅限本地")设置为 FALSE，然后使用 GIO [get_file ()/get_files ()](http://library.gnome.org/devel/gtk/stable/GtkFileChooser.html#gtk-file-chooser-get-file)调用返回可通过 File API 访问的 GFile* `GIO`，因此可通过`gvfs`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T11:17:04.733

毕竟我找到了一个解决方案/破解（在 C# 中）：

```
private string _extractUri(Widget wi) {
    if (wi is Entry)
        return ((wi as Entry).Text);
    else if (wi is Container) {
        foreach (Widget w in (wi as Container).Children) {
            string x = _extractUri(w);
            if (x!=null)
                return x;
        }
    }
    return null;
} 
```

我不确定这是否总是安全的，但它适用于标准 FileChooserDialog。它将从输入字段返回原始字符串 - 即使标准 Uri / 文件结果被破坏。

# css - Sharepoint webpart 和覆盖 css 样式

> ID：761083
> 
> 赞同：2
> 
> 时间：2009-04-17T16:15:57.777
> 
> 标签：css, sharepoint, web-parts

看看这张照片

[替代文字 http://www.abbeylegal.com/downloads/2009-04-01/web%20part%20top%20line.jpg](http://www.abbeylegal.com/downloads/2009-04-01/web%20part%20top%20line.jpg)

有谁知道红色突出显示的线条/边框使用什么css样式？我试图在我的自定义样式表中覆盖它，但我没有任何运气，到目前为止，我已经尝试覆盖这些不同的样式......

.ms-viewheadertr
.ms-vh2
.ms-vb
.ms-vb2
.ms-unselectedtitle
.ms-summarystandardbody

这是改变显示而不是边框​​，这足以让你发疯！

更新：

*.ms-WPHeader*确实是 css 类之一，但是如果将边框样式设置为 none，仍然会出现一行；只是稍微薄一点。我可以使用*.ms-viewheadertr*完全删除标题，但似乎无法删除这一行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T16:20:40.493

为什么不使用 firefox 和 firebug 插件来确定要覆盖的类？

您是否使用 !importance 来覆盖 css 类？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T16:27:28.153

Chrome 似乎暗示 iframe (id `Filterlframe1`) 是罪魁祸首：

```
border-bottom-style: inset;
border-bottom-width: 2px; 
```

澄清：Sharepoint 列表视图使用 iframe 作为顶部的菜单栏 - 这是呈现边框的位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T20:31:24.823

好吧，在IE8开发工具栏中玩过之后，我想出了：

```
<tr class="ms-WPHeader"> 
```

CSS 道具：

```
border-bottom:#4e7cb7 1px solid;
border-collapse:collapse; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-18T16:42:36.313

[在http://www.heathersolomon.com/content/sp07cssreference.htm](http://www.heathersolomon.com/content/sp07cssreference.htm)查看 Heather Solomom 的 SharePoint CSS 参考。

浏览[http://www.heathersolomon.com/content/sp07cssreference.htm#WebParts](http://www.heathersolomon.com/content/sp07cssreference.htm#WebParts)上的 webpart 特定部分，看起来这可能是 ms-WPBorder ？

希望这可以帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T11:13:57.323

我集中精力定制共享点 UI。所以我确定你应该看的课程如下：

```
*.ms-vh,.ms-vh2,.ms-vh-icon,.ms-vh2-nofilter,.ms-vh2-nofilter-icon,.ms-viewheadertr .ms-vh-group,.ms-vh2-nograd,.ms-vh3-nograd,.ms-vh2-nograd-icon,.ms-ph,.ms-pickerresultheadertr{
background-image:url("/_layouts/images/viewheadergrad.gif");
background-repeat:repeat-x;
padding-top:1px;
padding-bottom:0px;
background-color:#f2f2f2;
}* 
```

您应该像这样删除 background-image 属性中的图像引用：

```
*background-image:url("");* 
```

这将删除顶部的深灰色线。

定制快乐！！！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-10-13T23:42:17.137

我查看了每个回复，但没有一个是成功的。关键是“#4E7CB7”行的颜色。然后我搜索了服务器上的根 CSS 文件，并在 CORE.css 的第 2683 行更改了

```
.ms-WPHeader TD {
    border-bottom:1px solid #4e7cb7;
    border-collapse:collapse;
} 
```

到

```
.ms-WPHeader TD {
    border-bottom:0px solid #4e7cb7;
    border-collapse:collapse;
} 
```

# embedded - 微芯片链接器问题

> ID：761084
> 
> 赞同：2
> 
> 时间：2009-04-17T16:15:58.260
> 
> 标签：embedded, linker, pic, microchip

当我尝试在 MPLAB 中构建我的项目时，我收到了此构建错误消息..

```
 Clean: Deleting intermediary and output files.
Clean: Deleted file "M:\12 CCP PWM\12 CCP PWM.o".
Clean: Done.
Executing: "C:\MCC18\bin\mcc18.exe" -p=18F46K20 "12 CCP PWM.c" -fo="12 CCP PWM.o" -Ou- -Ot- -Ob- -Op- -Or- -Od- -Opa-
MPLAB C18 v3.20 (feature limited)
Copyright 1999-2005 Microchip Technology Inc.
This version of MPLAB C18 does not support the extended mode
and will not perform all optimizations.  To purchase a full
copy of MPLAB C18, please contact your local distributor or
visit buy.microchip.com.

Executing: "C:\MCC18\bin\mplink.exe" /l"C:\MCC18\lib" "C:\MCC18\lkr\18f46k20i.lkr" "12 CCP PWM.o" /u_CRUNTIME /o"12 CCP PWM.cof" /M"12 CCP PWM.map" /W
MPLINK 4.20, Linker
Copyright (c) 2008 Microchip Technology Inc.
Error - could not find definition of symbol 'main' in file 'C:\MCC18\lib/c018i.o'.
Errors    : 1

Link step failed.
----------------------------------------------------------------------
Release build of project `M:\12 CCP PWM\12 CCP PWM.mcp' failed.
Thu Apr 16 14:34:41 2009
----------------------------------------------------------------------
BUILD FAILED 
```

我检查了链接器库的路径是否正确。我怀疑它与我的源代码有关......非常感谢任何帮助。

这是我的源代码.. [http://cl1p.net/mplabc18](http://cl1p.net/mplabc18)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-18T16:57:50.943

The compiler may be looking for a different definition of main. I have seen this in some PIC code:

```
// Main application entry point.
#ifdef __C30__
int main(void)
#else
void main(void)
#endif
{ ... } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-20T18:56:25.040

将特定的链接器文件添加到您的项目中是个好主意。如果您正在使用 MPLAB，在工作区下，右键单击链接器文件并从 mcc16\lkr 文件夹中为特定处理器添加链接器文件。清理并重新编译解决方案

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-19T14:26:13.887

在您的源文件中，唯一让我印象深刻的是 ISR 声明的这一部分：

> `#pragma code InterruptVectorLow = 0x18`

您正在使用的编译器的用户指南指出这应该是：

> `#pragma code low_vector=0x18`

由于此声明就在您的主要功能之前，它可能会给您带来麻烦。

编辑：

所提供的解决方案似乎都不起作用，所以我刚刚将您的代码复制粘贴到一个新的 MPLAB 项目中，为 PIC18F46K20 器件设置。它使用 MCC18 编译器编译得很好。项目中唯一缺少的是“12 CCP PWM.h”头文件（我没有）。所以要么你的头文件有问题，要么你的项目设置有问题，或者我使用 MCC18 3.30 而不是 3.20 是问题所在。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-05T05:47:32.333

代码对我来说编译得很好（C18 3.30 full）

我的 MPLAB 有点脱落，尤其是在大型源代码树上，很多次重启都解决了，完全不知道为什么，尝试了其他所有方法，这是让 mplab 重置的唯一方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-17T16:34:17.280

我使用第三方编译器，所以我不能提供任何具体的经验。但我可能怀疑的一件事是代码中的某些内容导致编译中途停止。这可以是未终止的注释，也可以是缺少右大括号的函数。尤其要考虑#included 文件，因为当您查看主文件时，您无法在编辑器中看到效果，尤其要检查您自己编写的任何#includes。最重要的是，“你最后改变了什么”？

我现在要做的是制作一个分支副本，然后开始无情地破解大量代码，看看错误何时消失。分而治之。当然，这可能很耗时，所以我可能会先询问 StackOverflow :)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-17T17:45:02.053

已经有一段时间了，但是我看到您在创建函数之前使用了一个编译指示来定义中断处理程序的位置，您是否需要对 main() 做同样的事情？

它可能在 .h 文件中处理 - 我不确定。我只在 PIC 上使用过 ASM，并且我明确地处理了所有事情（即，在 0x000 处跳转到 main；在中断向量地址处跳转到该内存地址；在 main 地址处执行这些操作，等等）。'main' 对我来说被定义为代码部分中的可用地址（我看到你已经完成了，开始代码部分然后定义 main）但我相信我必须明确定义'main' 是从一个代码段中的内存地址。同样，它是 ASM，但我不怀疑您需要做类似的事情 - 将 main 定义为 main 的 pragma。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-17T23:05:41.253

如果 c018i.o 包含重置向量，并且它通过名称引用函数 main，那么问题可能是 main 需要一个原型 - 即使在与函数本身相同的文件中，所以链接器可以选择它并将 main在其功能列表中。

所以，尝试插入：

```
void main (void); 
```

在 main 函数的正上方。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-17T16:18:53.697

就我个人而言，我不会因为源文件名中有几个空格而使实现的角落变得紧张，尤其是使用嵌入式工具链！

但似乎他们正在做出合理的努力来添加所有双引号，所以也许这不是一个真正的问题。

您的代码中是否真的有一个“主”函数，如果有，它是如何定义的？

# php - 无论如何在PHP中使用E4X？

> ID：761087
> 
> 赞同：0
> 
> 时间：2009-04-17T16:16:14.203
> 
> 标签：php, xml, e4x

我主要是一名 ActionScript 程序员，我喜欢使用 E4X 处理 XML。我也经常使用 PHP，但目前不敢用 PHP 处理 XML，我想知道是否有办法在 PHP 中使用 E4X？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T16:21:17.497

[这](http://www.adobe.com/cfusion/communityengine/index.cfm?event=showdetails&productId=2&postId=7843)可能是您正在寻找的大致内容。

也就是说，您最好使用一种原生 PHP XML 解析方法。[SimpleXML](http://us.php.net/simplexml)可能是您最好的选择。

# latex - LaTeX 中带注释的目录

> ID：761093
> 
> 赞同：2
> 
> 时间：2009-04-17T16:17:15.433
> 
> 标签：latex, tableofcontents

我想使用 LaTeX 的`\tableofcontents`命令（或一些等效命令）自动生成目录，但我还想在目录中的每一行中添加一两句话来描述所引用部分的内容。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T22:04:22.243

该`tocloft`软件包及其`\cftchapterprecistoc`命令解决了我的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T16:26:51.663

尝试

```
\addcontentsline{toc}{section}{sample text} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-17T18:51:37.057

遵循 Oliver 和 simon 的建议：

您可以重新定义切片命令以获取第二个（可能是可选的）参数，并使用它来构建您的参数`\addtocontentsline`，然后调用相应的 section* 命令。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T16:32:26.457

我希望您可以使用 addcontentsline 蛮力和无知。例如：

```
\addcontentsline{目录}{部分}{文本}

```

但是，如果您不使用它所引用的部分的星号版本，这将与自动生成的行冲突。

任何更干净的东西都需要弄乱相关的宏……除非我遗漏了一些东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-23T16:30:16.290

我会将 {section} 部分更改为 {subsection}。

```
\addcontentsline{toc}{subsection}{sample text} 
```

# asp.net - 如何将自定义事件参数传递给标准 asp:controls

> ID：761096
> 
> 赞同：0
> 
> 时间：2009-04-17T16:18:01.093
> 
> 标签：asp.net

我可以很容易地理解如何在纯 C# 代码中使用自定义事件，但是如何在 asp:button click 上传递自定义事件参数？

我已经尝试过各种各样的事情（定义新的事件参数、新的代表等），但我没有运气。

是否有关于如何使用标准 asp 控件执行此操作的教程？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-17T16:21:29.837

只要您的 EventArgs 从 System.EventArgs 继承，您就可以传递它们。然后，一旦进入事件处理程序，您就可以将事件转换为正确的子类型。

这是一个例子：

```
using System;

class Program
{
    static event EventHandler Foo;

    static void Main()
    {
        // Here is cast the EventArgs to FooEventArgs
        Foo += (o,e) => Console.WriteLine(((FooEventArgs)e).Number);

        // Notice that I am passing a "FooEventArgs" instance
        // even though the delegate signature for "EventHandler"
        // specifies "EventArgs".  Polymorphism in action. :)
        Foo(null, new FooEventArgs { Number = 1 });
    }
}

class FooEventArgs : EventArgs
{
    public int Number { get; set; }
} 
```

我知道您正在与现有的控制代表一起工作，所以不幸的是，这种类型的转换是必要的。请记住，`EventHandler<T> where T : EventArgs`在 .NET 2.0 和更高版本中有一个委托，它允许您在不强制转换的情况下执行我在上面所做的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T16:22:51.737

我不相信在不创建自己的控件的情况下可以做到这一点。但是，我有时会在按钮上使用 commandagument 和 commandname 属性来提供附加信息

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T18:16:51.917

我不认为你可以。Button 本身将使用它自己的 EventArgs 对象调用 Click 事件，不幸的是，您无法劫持该调用。但是，您可以使用闭包：

```
protected void Page_Load(object sender, EventArgs e)
{
    int number = 1;
    button.Click += (o, args) => Response.Write("Expression:"+number++);
    number = 10;
    button.Click += delegate(object o, EventArgs args) {  Response.Write("Anonymous:"+number); };
} 
```

顺便说一下，这个输出是

```
表达：10匿名：11
```

理解为什么这是输出是理解闭包的一大步！即使`number`在处理 Click 事件时超出范围，它也不会被销毁，因为两个定义的事件处理程序都有对它的引用。所以它和它的价值将一直保持到不再需要为止。*我知道这不是对闭包最具技术性的解释，但应该让您了解它们是什么。*

# c - 如何防止 vim 在 :make 命令后使用错误的视口？

> ID：761103
> 
> 赞同：2
> 
> 时间：2009-04-17T16:20:35.393
> 
> 标签：c, vim, makefile, vi

我经常使用 :vsp 和 :sp 命令在 vim 中打开多个视口。在我编辑了一段时间之后，我会经常在 vim 中运行 :make 命令。当我收到错误时，vim 会显示 gcc 所说的导致我的错误的行。但是，vim 经常会在另一个视口中打开带有错误的文件，即使该文件已经打开。一个例子：

制作前

```
--------------------
|         |        |
| file 1  | file 2 |
|         |        |
|         |        |
-------------------- 
```

好的，假设文件 2 中有错误

```
--------------------
|         |        |
| file 2  | file 2 |
|         |        |
|         |        |
-------------------- 
```

vim 现在跳转到左视口中的错误行，即使右视口已经打开了该文件。

如果错误所在的文件已经在vim中打开，是否有某种方法可以告诉vim不要使用文件一个视口？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T16:56:37.833

尝试设置选项 switchbuf=useopen。

# c# - 使用带有参数语法的 C# 的 XML 注释 cref 属性

> ID：761104
> 
> 赞同：16
> 
> 时间：2009-04-17T16:20:36.237
> 
> 标签：c#, xml-comments, params-keyword

在 C# 中，我尝试使用 <see cref="blah"/> 来引用包含 params 关键字的方法签名。我知道这会将参数列表转换为数组，但我什至无法弄清楚如何在 CREF 属性中引用数组。我在搜索中一无所获，我认识的人也没有任何想法。编译器在方括号上窒息。我尝试了各种不同的组合，使用花括号，使用 Array 类，但没有任何效果。有人知道吗？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-05-06T01:35:04.413

根据[B.3.1 ID 字符串格式](http://msdn.microsoft.com/en-us/library/aa664807(VS.71).aspx)文章，引用数组是使用 [方括号] （带有可选`lowerbound:size`说明符）完成的，但如果您只想引用某种类型的数组（甚至是 Object 数组），您可以不只是写

`<see cref="Object[]"/>`

相反，您需要指定您正在使用`T:`前缀进行类型引用，例如

`<see cref="T:Object[]"/>`

在引用方法的特定重载时，这似乎并不适用，例如

`<seealso cref="String.Join(String, String[])"/>`

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-17T19:09:32.460

ECMA 334 标准 PDF，附件 E 包含 XML 文档注释的体面概述。您可以在以下位置下载标准：

[http://www.ecma-international.org/publications/standards/Ecma-334.htm](http://www.ecma-international.org/publications/standards/Ecma-334.htm)

具体来说，您需要从第 496 页开始的第 E.3.1 节。

MSDN 上也有类似的内容（尽管 MSDN 似乎在这个主题上的导航很糟糕，因此很难找到其他部分）：

[http://msdn.microsoft.com/en-us/library/aa664787(VS.71).aspx](http://msdn.microsoft.com/en-us/library/aa664787(VS.71).aspx)

等效于 E.3.1：

[http://msdn.microsoft.com/en-us/library/aa664807(VS.71).aspx](http://msdn.microsoft.com/en-us/library/aa664807(VS.71).aspx)

您可能还会发现 Mono 的文档很有用：

[http://www.go-mono.com/docs/index.aspx?tlink=29@man%3amdoc(5)](http://www.go-mono.com/docs/index.aspx?tlink=29@man%3amdoc(5))

具体来说，“CREF FORMAT”部分涵盖了 ID 字符串约定。

# 更新 2018/05/23

上面 ECMA-334 标准 PDF 的 URL 链接到该标准的最新版本。2009 年，这是该标准的第 4 版。但是，截至 2017 年 12 月，第 5 版是最新的，第 4 版中的 E.3.1 部分成为第 5 版中的 D.4.2 部分。

以前版本的 ECMA-334 标准可从以下页面下载：[https ://www.ecma-international.org/publications/standards/Ecma-334-arch.htm](https://www.ecma-international.org/publications/standards/Ecma-334-arch.htm)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-17T16:35:48.803

您只需省略 param 关键字并输入如下类型：

```
/// <summary>
/// <see cref="Method(string[])"/>
/// </summary>
public static void Main()
{
    Method("String1", "String2");
}

public static void Method(params string[] values)
{
    foreach (string value in values)
    {
        Console.WriteLine(value);
    }
} 
```

# .net - 如何使用断点调试 Windows 服务？

> ID：761120
> 
> 赞同：5
> 
> 时间：2009-04-17T16:23:36.367
> 
> 标签：.net, debugging, windows-services

我有一个带有计时器的 Windows 服务。调试它非常困难。因为我启动服务并在代码的不同部分放置断点。当我附加该过程时，我希望服务从一开始就开始，而不是中间代码中我有断点的一些随机位置。它很难像您知道起点的普通应用程序一样进行调试。后台似乎还有一些流程没有完成。所以每次我都开始调试，而不是从第一个断点开始，而是从应用程序中间的某个随机断点开始。

我想知道 Windows 服务在进程、线程等方面的工作原理……以及如何从头开始调试？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-17T16:51:11.670

我假设您当然在谈论.Net。我一直使用以下代码来调试我的服务。我把它放在我想让调试器启动的地方。启动该服务，它会自动启动 Visual Studio。对我来说效果很好。

`System.Diagnostics.Debugger.Launch();`

`System.Diagnostics.Debugger.Debug();`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T20:47:14.957

只需按 F5。您可以像应用程序一样定期运行 Windows 服务。

由于我们没有其他命令行参数，我们只是使用*任何*命令行参数的存在作为信号，以作为普通 Windows 应用程序运行。您还可以要求存在特定的命令行参数（即/debug）。

```
If sArgs IsNot Nothing AndAlso sArgs.Length > 0 Then
    ' If there are command-line args then run in non-service mode
    Dim svc As ServiceMain = New ServiceMain(True)
    svc.OnStart(Nothing)
    System.Windows.Forms.Application.Run()
    svc.OnStop()
Else
    ' If no command-line args then run normally
    Dim ServicesToRun() As System.ServiceProcess.ServiceBase
    ServicesToRun = New System.ServiceProcess.ServiceBase() {New ServiceMain(False)}
    System.ServiceProcess.ServiceBase.Run(ServicesToRun)
End If 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-25T17:35:38.957

您可以使用[“图像文件执行选项”](http://support.microsoft.com/kb/824344)并配置它每次服务启动时都会在调试器中启动。
该调试器可以是 WinDBG 或 Visual Studio。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T16:40:52.893

最简单的方法...

将服务代码的业务功能部分放在单独的类中，在单独的库程序集中...然后您可以使用简单的控制台应用程序独立调试它...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-20T16:27:14.667

它不如调试器中的断点方便，但我发现将输出写入简单的日志文件会有所帮助。我们有产生线程来执行工作的服务，写入日志文件有助于查明问题。

# c# - 性能问题：与 String.Format 相比

> ID：761121
> 
> 赞同：15
> 
> 时间：2009-04-17T16:23:37.803
> 
> 标签：c#, performance, string

不久前，Jon Skeet 的一篇文章在我的脑海中植入了构建`CompiledFormatter`类的想法，用于在循环中使用而不是`String.Format()`.

`String.Format()`这个想法是花费在解析格式字符串的调用的一部分是开销；我们*应该*能够通过将代码移出循环来提高性能。当然，诀窍是新代码应该与行为*完全*匹配。`String.Format()`

这周我终于做到了。我通过使用[Microsoft 提供的 .Net 框架源](http://weblogs.asp.net/scottgu/archive/2008/01/16/net-framework-library-source-code-now-available.aspx)来直接调整他们的解析器（结果`String.Format()`实际上是把工作交给.Net 框架`StringBuilder.AppendFormat()`）。我想出的代码有效，因为我的结果在我的（诚然有限的）测试数据中是准确的。

不幸的是，我还有一个问题：性能。在我最初的测试中，我的代码的性能与正常的`String.Format()`. 根本没有改善；它甚至总是慢几毫秒。至少它仍然是相同的顺序（即：较慢的量不会增加；即使测试集增长它也会保持在几毫秒内），但我希望有更好的东西。

内部调用可能`StringBuilder.Append()`是真正推动性能的因素，但我想看看这里的聪明人是否可以帮助改进事情。

以下是相关部分：

```
private class FormatItem
{
    public int index; //index of item in the argument list. -1 means it's a literal from the original format string
    public char[] value; //literal data from original format string
    public string format; //simple format to use with supplied argument (ie: {0:X} for Hex

    // for fixed-width format (examples below) 
    public int width;    // {0,7} means it should be at least 7 characters   
    public bool justify; // {0,-7} would use opposite alignment
}

//this data is all populated by the constructor
private List<FormatItem> parts = new List<FormatItem>(); 
private int baseSize = 0;
private string format;
private IFormatProvider formatProvider = null;
private ICustomFormatter customFormatter = null;

// the code in here very closely matches the code in the String.Format/StringBuilder.AppendFormat methods.  
// Could it be faster?
public String Format(params Object[] args)
{
    if (format == null || args == null)
        throw new ArgumentNullException((format == null) ? "format" : "args");

    var sb = new StringBuilder(baseSize);
    foreach (FormatItem fi in parts)
    {
        if (fi.index < 0)
            sb.Append(fi.value);
        else
        {
            //if (fi.index >= args.Length) throw new FormatException(Environment.GetResourceString("Format_IndexOutOfRange"));
            if (fi.index >= args.Length) throw new FormatException("Format_IndexOutOfRange");

            object arg = args[fi.index];
            string s = null;
            if (customFormatter != null)
            {
                s = customFormatter.Format(fi.format, arg, formatProvider);
            }

            if (s == null)
            {
                if (arg is IFormattable)
                {
                    s = ((IFormattable)arg).ToString(fi.format, formatProvider);
                }
                else if (arg != null)
                {
                    s = arg.ToString();
                }
            }

            if (s == null) s = String.Empty;
            int pad = fi.width - s.Length;
            if (!fi.justify && pad > 0) sb.Append(' ', pad);
            sb.Append(s);
            if (fi.justify && pad > 0) sb.Append(' ', pad);
        }
    }
    return sb.ToString();
}

//alternate implementation (for comparative testing)
// my own test call String.Format() separately: I don't use this.  But it's useful to see
// how my format method fits.
public string OriginalFormat(params Object[] args)
{
    return String.Format(formatProvider, format, args);
} 
```

补充笔记：

我对为我的构造函数提供源代码持谨慎态度，因为我不确定依赖原始 .Net 实现所带来的许可影响。但是，任何想要对此进行测试的人都可以公开相关的私有数据并分配模仿特定格式字符串的值。

此外，如果有人有可以改善构建时间的建议，我非常愿意更改`FormatInfo`课程甚至列表。`parts`由于我主要关心的是从前端到后端的顺序迭代时间，也许 a`LinkedList`会更好？

### [更新]：

嗯......我可以尝试的其他方法是调整我的测试。我的基准测试相当简单：将名称组合成一种`"{lastname}, {firstname}"`格式，并从区号、前缀、号码和分机组件中组合格式化的电话号码。这些都没有太多的字符串中的文字段。当我考虑原始状态机解析器的工作方式时，我认为这些文字段正是我的代码最有可能做得好的地方，因为我不再需要检查字符串中的每个字符。

另一个想法：

这个类仍然有用，即使我不能让它更快。只要性能*不比*基本的 String.Format() 差，我仍然创建了一个强类型接口，它允许程序在运行时组装它自己的“格式字符串”。我需要做的就是提供对零件清单的公共访问权限。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-18T01:22:50.987

## 这是最终结果：

我将基准试验中的格式字符串更改为更适合我的代码的内容：

> 快速的棕色 {0} 跳过了懒惰的 {1}。

正如我所料，这比原来的要好得多。此代码在 5.3 秒内完成 200 万次迭代，而`String.Format`. 这是不可否认的进步。在许多情况下，您甚至可能很想开始使用它作为一种不费吹灰之力的替代品`String.Format`。毕竟，你不会做得更糟，你甚至可能会得到一个小的性能提升：高达 14%，这没什么好打喷嚏的。

除了它是。请记住，在专门设计用于支持此代码的情况下，我们仍然在谈论 200*万*次尝试的不到半秒的差异。除非您有幸在前 100 名网站上工作，否则即使是繁忙的 ASP.Net 页面也不会产生如此多的负载。

最重要的是，这忽略了一个重要的替代方案：您可以`StringBuilder`每次创建一个新的并使用原始`Append()`调用手动处理您自己的格式。使用这种技术，我的基准测试*仅在 3.9 秒内完成。* 这是一个更大的改进。

* * *

总之，如果性能不那么重要，您应该坚持内置选项的清晰和简单。但是，当分析表明这确实在推动您的表现时，可以通过`StringBuilder.Append()`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-18T02:34:40.503

现在不要停下来！

您的自定义格式化程序可能只比内置 API 稍微高效一些，但您可以向自己的实现添加更多功能，使其更有用。

我在 Java 中做了类似的事情，这里是我添加的一些特性（除了预编译的格式字符串）：

1) format() 方法接受可变参数数组或 Map（在 .NET 中，它是字典）。所以我的格式字符串可以是这样的：

```
StringFormatter f = StringFormatter.parse(
   "the quick brown {animal} jumped over the {attitude} dog"
); 
```

然后，如果我已经在地图中包含了我的对象（这很常见），我可以像这样调用 format 方法：

```
String s = f.format(myMap); 
```

2）在格式化过程中，我有一个特殊的语法来对字符串执行正则表达式替换：

```
// After calling obj.toString(), all space characters in the formatted
// object string are converted to underscores.
StringFormatter f = StringFormatter.parse(
   "blah blah blah {0:/\\s+/_/} blah blah blah"
); 
```

3）我有一个特殊的语法，允许格式化检查参数是否为空，根据对象是空还是非空应用不同的格式化程序。

```
StringFormatter f = StringFormatter.parse(
   "blah blah blah {0:?'NULL'|'NOT NULL'} blah blah blah"
); 
```

您还可以做无数其他事情。我的待办事项列表中的一项任务是添加一种新语法，您可以在其中自动格式化列表、集合和其他集合，方法是指定应用于每个元素的格式化程序以及要在所有元素之间插入的字符串。像这样的东西...

```
// Wraps each elements in single-quote charts, separating
// adjacent elements with a comma.
StringFormatter f = StringFormatter.parse(
   "blah blah blah {0:@['$'][,]} blah blah blah"
); 
```

但是语法有点尴尬，我还不喜欢它。

无论如何，关键是您现有的类可能不会比框架 API 更有效，但是如果您扩展它以满足您所有的个人字符串格式化需求，您最终可能会得到一个非常方便的库。就个人而言，我使用我自己的这个库版本来动态构建所有 SQL 字符串、错误消息和本地化字符串。它非常有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T16:39:10.683

在我看来，为了获得实际的性能改进，您需要将您的 customFormatter 和 formattable 参数完成的任何格式分析分解为一个函数，该函数返回一些数据结构，该数据结构告诉稍后的格式化调用要做什么。然后将这些数据结构拉入构造函数并将它们存储起来以备后用。大概这将涉及扩展 ICustomFormatter 和 IFormattable。似乎不太可能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T16:27:22.070

您是否也考虑过进行 JIT 编译的时间？毕竟，框架将是*可以*解释差异的？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-17T19:20:10.937

该框架为采用固定大小参数列表而不是 params object[] 方法的格式方法提供了显式覆盖，以消除分配和收集所有临时对象数组的开销。您可能也想为您的代码考虑这一点。此外，为常见值类型提供强类型重载将减少装箱开销。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-18T01:33:14.580

我必须相信，花尽可能多的时间优化数据 IO 将获得成倍增长的回报！

这肯定是 YAGNI 的亲表亲。避免过早的优化。APO。

# ruby-on-rails - 在 Rails 中播种数据库的最佳方法是什么？

> ID：761123
> 
> 赞同：86
> 
> 时间：2009-04-17T16:24:04.993
> 
> 标签：ruby-on-rails, ruby, database, task, seed

我有一个 rake 任务，它在我的 rails 应用程序中填充一些初始数据。例如，国家、州、移动运营商等。

我现在设置它的方式是，我在 /db/fixtures 的文件中有一堆创建语句和一个处理它们的 rake 任务。例如，我拥有的一个模型是主题。我在 /db/fixtures 中有一个 theme.rb 文件，如下所示：

```
Theme.delete_all
Theme.create(:id => 1, :name=>'Lite', :background_color=>'0xC7FFD5', :title_text_color=>'0x222222',
                      :component_theme_color=>'0x001277', :carrier_select_color=>'0x7683FF', :label_text_color=>'0x000000',
                      :join_upper_gradient=>'0x6FAEFF', :join_lower_gradient=>'0x000000', :join_text_color=>'0xFFFFFF',
                      :cancel_link_color=>'0x001277', :border_color=>'0x888888', :carrier_text_color=>'0x000000', :public => true)

Theme.create(:id => 2, :name=>'Metallic', :background_color=>'0x000000', :title_text_color=>'0x7299FF',
                      :component_theme_color=>'0xDBF2FF', :carrier_select_color=>'0x000000', :label_text_color=>'0xDBF2FF',
                      :join_upper_gradient=>'0x2B25FF', :join_lower_gradient=>'0xBEFFAC', :join_text_color=>'0x000000',
                      :cancel_link_color=>'0xFF7C12', :border_color=>'0x000000', :carrier_text_color=>'0x000000', :public => true)

Theme.create(:id => 3, :name=>'Blues', :background_color=>'0x0060EC', :title_text_color=>'0x000374',
                      :component_theme_color=>'0x000374', :carrier_select_color=>'0x4357FF', :label_text_color=>'0x000000',
                      :join_upper_gradient=>'0x4357FF', :join_lower_gradient=>'0xffffff', :join_text_color=>'0x000000',
                      :cancel_link_color=>'0xffffff', :border_color=>'0x666666', :carrier_text_color=>'0x000000', :public => true)
puts "Success: Theme data loaded" 
```

这里的想法是我想为用户安装一些股票主题。我对这种方法有疑问。

设置 ID 不起作用。这意味着如果我决定添加一个主题，我们称之为“红色”，那么我只想将主题语句添加到这个夹具文件并调用 rake 任务来重新设置数据库。如果我这样做，因为主题属于其他对象，并且在重新初始化时它们的 id 会发生变化，所有链接都会被破坏。

我的问题首先是，这是处理数据库播种的好方法吗？在之前的帖子中，这是推荐给我的。

如果是这样，我怎样才能对 ID 进行硬编码，这有什么缺点吗？

如果不是，那么播种数据库的最佳方法是什么？

我将真正欣赏包含最佳实践的长而深思熟虑的答案。

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2010-01-15T10:38:52.803

更新，因为这些答案有些过时（尽管有些仍然适用）。

rails 2.3.4 中添加的简单功能，db/seeds.rb

提供新的 rake 任务

```
rake db:seed 
```

适合填充常见的静态记录，如州、国家等......

[http://railscasts.com/episodes/179-seed-data](http://railscasts.com/episodes/179-seed-data)

*请注意，如果您已经创建了固定装置，也可以使用 db:seed 任务填充，方法是将以下内容放入您的 seed.rb 文件（来自 railscast 剧集）：

```
require 'active_record/fixtures'
Fixtures.create_fixtures("#{Rails.root}/test/fixtures", "operating_systems") 
```

对于 Rails 3.x 使用 'ActiveRecord::Fixtures' 而不是 'Fixtures' 常量

```
require 'active_record/fixtures'
ActiveRecord::Fixtures.create_fixtures("#{Rails.root}/test/fixtures", "fixtures_file_name") 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2011-04-04T00:03:46.547

通常需要两种类型的种子数据。

*   **应用程序核心可能依赖的**基本数据。**我称之为普通种子。**
***   **环境数据**，例如开发应用程序，拥有一组已知状态的数据，我们可以使用这些数据在本地处理应用程序（上面的 Factory Girl 答案涵盖了这种数据）。**

 **根据我的经验，我总是遇到对这两种数据的需求。因此，我将[一个小 gem 放在一起，它扩展了 Rails 的种子](https://github.com/james2m/seedbank "耙任务以在 Rails 中为数据库播种")，并允许您在 db/seeds/ 下添加多个通用种子文件，并在 db/seeds/ENV 下添加任何环境种子数据，例如 db/seeds/development。

我发现这种方法足以为我的种子数据提供一些结构，并让我能够通过运行将我的开发或暂存环境设置为已知状态：

```
rake db:setup 
```

固定装置很脆弱，难以维护，常规的 sql 转储也是如此。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2009-04-17T19:33:18.860

[factory_bot](https://github.com/thoughtbot/factory_bot/tree/master)听起来它会做你想要实现的目标。您可以在默认定义中定义所有公共属性，然后在创建时覆盖它们。您还可以将 id 传递给工厂：

```
Factory.define :theme do |t|
  t.background_color '0x000000'
  t.title_text_color '0x000000',
  t.component_theme_color '0x000000'
  t.carrier_select_color '0x000000'
  t.label_text_color '0x000000',
  t.join_upper_gradient '0x000000'
  t.join_lower_gradient '0x000000'
  t.join_text_color '0x000000',
  t.cancel_link_color '0x000000'
  t.border_color '0x000000'
  t.carrier_text_color '0x000000'
  t.public true
end

Factory(:theme, :id => 1, :name => "Lite", :background_color => '0xC7FFD5')
Factory(:theme, :id => 2, :name => "Metallic", :background_color => '0xC7FFD5')
Factory(:theme, :id => 3, :name => "Blues", :background_color => '0x0060EC') 
```

当与 faker 一起使用时，它可以非常快速地使用关联填充数据库，而不必弄乱 Fixtures (yuck)。

我在 rake 任务中有这样的代码。

```
100.times do
    Factory(:company, :address => Factory(:address), :employees => [Factory(:employee)])
end 
```

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2013-11-26T07:54:18.640

使用`seeds.rb`file or`FactoryBot`很好，但它们分别适用于固定数据结构和测试。

[`seedbank`](https://github.com/james2m/seedbank)gem 可以为您的种子提供更多的控制和模块化。它插入 rake 任务，您还可以定义种子之间的依赖关系。您的 rake 任务列表将添加以下内容（例如）：

```
rake db:seed                    # Load the seed data from db/seeds.rb, db/seeds/*.seeds.rb and db/seeds/ENVIRONMENT/*.seeds.rb. ENVIRONMENT is the current environment in Rails.env.
rake db:seed:bar                # Load the seed data from db/seeds/bar.seeds.rb
rake db:seed:common             # Load the seed data from db/seeds.rb and db/seeds/*.seeds.rb.
rake db:seed:development        # Load the seed data from db/seeds.rb, db/seeds/*.seeds.rb and db/seeds/development/*.seeds.rb.
rake db:seed:development:users  # Load the seed data from db/seeds/development/users.seeds.rb
rake db:seed:foo                # Load the seed data from db/seeds/foo.seeds.rb
rake db:seed:original           # Load the seed data from db/seeds.rb 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-05-05T14:21:40.637

Rails 有一种内置的方式来播种数据，如此[处](http://railscasts.com/episodes/179-seed-data)所述。

另一种方法是使用 gem 进行更高级或更简单的播种，例如：[seedbank](https://github.com/james2m/seedbank)。

这个 gem 的主要优点和我使用它的原因是它具有高级功能，例如数据加载依赖项和每个环境的种子数据。

*添加一个最新的答案，因为这个答案首先在谷歌上。*

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2009-04-17T19:10:58.587

最好的方法是使用固定装置。

注意：请记住，夹具会直接插入并且不使用您的模型，因此如果您有填充数据的回调，则需要找到解决方法。

* * *

## 回答 #7

> 赞同：-5
> 
> 时间：2009-04-17T19:13:32.060

将其添加到数据库迁移中，这样每个人都可以在更新时获得它。在 ruby​​/rails 代码中处理您的所有逻辑，因此您永远不必搞乱显式 ID 设置。

# c# - 将多个文本框绑定到 WPF 中的一个结构

> ID：761130
> 
> 赞同：0
> 
> 时间：2009-04-17T16:26:37.080
> 
> 标签：c#, wpf, data-binding, binding, struct

如何将两个 TextBox 对象绑定到[System.Windows.Size](http://msdn.microsoft.com/en-us/library/system.windows.size.aspx) **结构**？绑定只需要朝这个方向工作：

(textBox1.Text + textBox2.Text) => (大小)

用户在 UI 上的 TextBoxes 中插入宽度和高度后，应创建 Size 对象。

XAML：

```
<TextBox Name="textBox_Width" Text="{Binding ???}" />
<TextBox Name="textBox_Height" Text="{Binding ???}" /> 
```

C＃：

```
private Size size
{
  get;
  set;
} 
```

是否有捷径可寻？

**编辑：**大小是一个结构！因此“someObject.Size.Width = 123”不起作用。我需要调用 Size-Constructor 并设置 someObject.Size = newSize

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T21:59:21.570

您能否仅从模型中公开 2 个属性 - 宽度和高度，以及一个 size 属性。宽度和高度会出现在您的 {Binding} 表达式中，然后当您想要获取 size 属性时，它会根据这两个字段进行初始化。

例如，您的模型可能类似于；

```
public class MyModel
{
    public int Width{ get; set; }
    public int Height{ get; set; }

    public Size Size{ get{ return new Size( Width, Height ); }}
}; 
```

希望这可以帮助。

托尼

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T16:34:04.877

*Window1.xaml.cs*：

```
public partial class Window1 : Window
{
    public static readonly DependencyProperty SizeProperty = DependencyProperty.Register("Size",
        typeof(Size),
        typeof(Window1));

    public Size Size
    {
        get { return (Size)GetValue(SizeProperty); }
        set { SetValue(SizeProperty, value); }
    }

    public Window1()
    {
        InitializeComponent();
        DataContext = this;
        _button.Click += new RoutedEventHandler(_button_Click);
    }

    void _button_Click(object sender, RoutedEventArgs e)
    {
        MessageBox.Show(Size.ToString());
    }
} 
```

*Window1.xaml*：

```
<Window x:Class="WpfApplication1.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300">
    <StackPanel>
        <TextBox Text="{Binding Size.Width}"/>
        <TextBox Text="{Binding Size.Height}"/>
        <Button x:Name="_button">Show Size</Button>
    </StackPanel>
</Window> 
```

# wpf - 样式化 ToolTipService.Tooltip

> ID：761137
> 
> 赞同：1
> 
> 时间：2009-04-17T16:27:26.780
> 
> 标签：wpf, tooltip

有没有办法将样式仅应用于某些工具提示？我正在尝试为显示验证错误的工具提示指定工具提示模板。假设我有一个工具提示样式，比如 errorTTStyle 和一些验证模板：

```
<Style TargetType="{x:Type TextBox}">
 <Style.Triggers>
  <Trigger Property="Validation.HasError" Value="true">
    <Setter Property="ToolTip" Value="{Binding RelativeSource={RelativeSource Self}, Path=(Validation.Errors).CurrentItem.ErrorContent}" />
  </Trigger>
 </Style.Triggers>
</Style> 
```

如何强制 WPF 仅针对这种情况使用 errorTTStyle （我知道我可以全局更改提示样式，但这不是我想要的）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T17:16:26.990

您可以在 Textbox 样式的资源中添加 toolTip 的样式，它只会被父样式使用，如果您想使用外部样式，也可以在 errorTTStyle 中使用该样式：

```
<Style TargetType="{x:Type TextBox}">

   <Style.Resources>
        <Style TargetType="{x:Type ToolTip}" BasedOn="{StaticResource errorTTStyle}" />
   </Style.Resources>      

<Style.Triggers>
    <Trigger Property="Validation.HasError" Value="true">
      <Setter Property="ToolTip" Value="{Binding RelativeSource={RelativeSource Self}, Path=(Validation.Errors).CurrentItem.ErrorContent}" />
    </Trigger>
  </Style.Triggers>
</Style> 
```

# c# - 在 Sharepoint 顺序工作流中编辑 Excel 文件

> ID：761139
> 
> 赞同：0
> 
> 时间：2009-04-17T16:28:21.210
> 
> 标签：c#, sharepoint

我有一个与 Excel 文件库相关的相当复杂的工作流程。当工作流完成时，我需要能够在文件底部添加时间戳。

我以前编辑 Excel 文件的大部分经验都是通过 Odbc 连接进行查询。据我所知，没有内置的 Sharepoint 功能可以这样做。我没有文件系统访问权限，只能将文件写入磁盘上的临时位置。我不知道有什么方法可以编辑 Sharepoint 提供的二进制流。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-18T13:21:54.753

您可以使用 OOXML SDK 来编辑 Excel 文件的二进制流并设置该时间戳。
看看[OpenXML Developer](http://openxmldeveloper.com/)。

# iphone - 用户不活动期后 WiFi 连接断开

> ID：761140
> 
> 赞同：3
> 
> 时间：2009-04-17T16:29:18.243
> 
> 标签：iphone, wifi

我的 iPhone 应用程序通过 wifi 与远程服务器建立 TCP 连接。但是，如果一段时间内没有用户活动，设备会关闭 wifi 并断开连接。有可能预防吗？我需要在应用程序运行时保持连接。设置*setIdleTimerDisabled:YES*没有帮助 - 它可以防止屏幕关闭，但 wifi 仍然关闭。

您知道这是否可行以及如何实现？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-17T16:54:35.653

查看此网址：http: [//developer.apple.com/iphone/library/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/ApplicationEnvironment/ApplicationEnvironment.html#//apple_ref/doc/uid/TP40007072-CH7-SW59](http://developer.apple.com/iphone/library/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/ApplicationEnvironment/ApplicationEnvironment.html#//apple_ref/doc/uid/TP40007072-CH7-SW59)

> 表 1-3 Info.plist 文件中的重要键
> 
> UIRequiresPersistentWiFi：
> 
> 一个布尔值，通知系统应用程序使用 Wi-Fi 网络进行通信。任何时间使用 Wi-Fi 的应用程序都必须将此键设置为 true；否则，30 分钟后，设备将关闭 Wi-Fi 连接以节省电量。设置此标志还可以让系统知道它应该在 Wi-Fi 可用但当前未使用时显示网络选择对话框。默认值为假。

# asp.net - 如何自动附加到远程服务器上的特定 IIS 池？

> ID：761141
> 
> 赞同：1
> 
> 时间：2009-04-17T16:29:31.753
> 
> 标签：asp.net, visual-studio-2008, remote-debugging, w3wp

目前三个开发人员共享一个 IIS 盒子进行测试。由于第三方工具和其他限制，我们无法在本地运行项目，因此远程调试是唯一的选择。我们当前的流程是远程连接到网络服务器，运行 iisapp.vps 以获取我们各个站点的 PID，然后在 VS2008 中运行远程调试以连接到该 pid。

我已经找到了自动连接到 w3wp 的脚本，如果它是唯一运行的脚本，但是我还没有找到一种方法可以远程找到脚本中的 w3wp PID 并使用它来附加。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-24T04:40:33.290

大多数使用 IIS 的脚本都假定您在本地计算机上运行。如果您查看脚本代码，它很可能使用 WMI 与 IIS 一起工作，并且它必须做的第一件事是连接到 WMI 提供程序，该提供程序始终需要机器名称和 WMI 提供程序路径。本地机器的机器名称通常表示为“.”。需要的地方。

例如：

```
strComputer =“。”
设置 objWMIService = GetObject("winmgmts:" _
    & "{impersonationLevel=impersonate}!\\" _
    & strComputer & "\root\cimv2")

设置 colProcesses = objWMIService.ExecQuery(_
    "select * from win32_process Where Name = 'w3wp.exe'")
对于 colProcesses 中的每个 objProcess
    WScript.Echo objProcess.ProcessId

```

如果您将 strComputer 更改为指向 IIS 服务器，您将获得查询时运行的所有 w3wp 进程的 PID。

注意：上面的代码是一个脚本的片段，不是一个完整的程序。

# delphi - 我在哪里可以找到用于访问交换/展望联系人和约会的示例 Delphi 代码或组件？

> ID：761144
> 
> 赞同：3
> 
> 时间：2009-04-17T16:30:00.830
> 
> 标签：delphi

我需要 Delphi 代码或组件来访问交换/展望联系人和约会吗？我可能需要使用扩展 MAPI。这是一个概念证明，所以我现在还没有准备好花大价钱。任何提示，链接，经验？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-17T19:26:53.743

看看这个

在 MS Outlook 中创建约会

[http://www.scalabium.com/faq/dct0128.htm](http://www.scalabium.com/faq/dct0128.htm)

MS Outlook 中的联系人列表

[http://www.scalabium.com/faq/dct0145.htm](http://www.scalabium.com/faq/dct0145.htm)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T17:27:01.443

看看来自[Rapware的](http://www.rapware.nl/prod_easymapi_page1.asp?SubMenu=EasyMAPI)[EasyMAPI](http://www.rapware.nl/)。

不是免费的，但物有所值。几年前我用过这个。作者真的很有帮助，并且愿意添加新功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T15:13:50.353

在我们公司，我们使用了转换后的扩展 mapi C/C++ 头文件（到 delphi）和来自这里的示例[http://www.imibo.com/imidev/delphi/les/index.html](http://www.imibo.com/imidev/delphi/les/index.html)。至少我认为不会花那么多钱。

我们用它创建了一个同步服务，可以同步我们自己议程中的任务、联系人和约会，这些议程是在我直接在公司工作之前建立的，并直接进行交流。

好处是您可以使用 MSDN，因为基本上所有内容都与那里编写的内容相同，并且您可以完全控制，但它相当“低级”

I'm not really certain if it is that what you need, but you don't really need outlook to be installed to access the messages then (on exchange). If you just need outlook you could try OLE or some of the other suggestions.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T17:31:06.207

我不确定 TurboPower OfficePartner 是否支持您正在寻找的功能，但它是免费的（与开源一样）并且可能值得一看：

[http://sourceforge.net/projects/tpofficepartner/](http://sourceforge.net/projects/tpofficepartner/)

# deployment - 亚音速变更管理流程。从测试到产品

> ID：761146
> 
> 赞同：0
> 
> 时间：2009-04-17T16:30:32.687
> 
> 标签：deployment, subsonic

当我使用我的网站和通过 Subsonic 生成的 DAL 时，我可以简单地将连接字符串更改为从我的测试数据库指向我的生产数据库吗？

当我尝试推送到我的生产服务器时，即使我已将连接字符串更改为包含相同架构的有效生产数据库，DAL 似乎仍在与我的测试数据库通信。

TIA

约翰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T16:37:18.973

是的，您只需更改 web.config 中的设置并确保您的 Web 应用程序重新加载。（它几乎总是在更改或替换 web.config 时重新加载，但我见过它不会的时候，然后您可以在 IIS 中重新启动它或尝试在本地编辑 web.config）

你不应该重建

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T16:33:36.797

更改连接字符串、重建和 xcopy。

# javascript - JQuery $(document).ready() 和 document.write()

> ID：761148
> 
> 赞同：21
> 
> 时间：2009-04-17T16:30:38.893
> 
> 标签：javascript, jquery

首先，有没有办法`document.write()`在 JQuery 的`$(document).ready()`方法内部使用？如果有，请提示我，因为这将解决我的问题。

否则，我有某人的代码，我应该使用我的代码。问题是我不允许以任何方式更改他的代码。不起作用的部分如下所示：

```
document.write('<script src=\"http://myurl.com/page.aspx?id=1\"></script>'); 
```

脚本标签引用了一个 aspx 页面，该页面执行了一系列测试，然后吐出如下内容：

```
document.write('<img src=\"/image/1.jpg\" alt=\"Second image for id 1\">') 
```

这些脚本只是实际情况的示例。这里的问题是我有一个`document.write()`初始脚本和一个`document.write()`附加到第一个脚本的脚本，我必须以某种方式在 JQuery 的`$(document).ready()`函数中使其工作，而不更改他的代码。

我不知道该怎么做。帮助？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-04-17T16:41:10.570

**根据给定的要求**，不，您不能使用 document.write 而不真正清理文档。如果您真的不想更改代码，您可以像这样覆盖 document.write() 的功能，然后再添加结果：

```
var phbRequirement = "";

$(function() {
  document.write = function(evil) {
    phbRequirement += evil;
  }
  document.write("Haha, you can't change my code!");
  $('body').append(phbRequirement);

}); 
```

确保在使用之前覆盖 document.write 函数。您可以随时进行。

其他答案很无聊，这很有趣，但是为了满足给定的要求，这样做几乎是错误的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-17T17:06:17.437

picardo 有我会使用的方法。要扩展这个概念，请阅读：

```
$('<script/>')
   .attr('src', 'http://myurl.com/page.aspx?id=1')
   .appendTo('body'); 
```

替代风格：

```
var imgnode = $('<img alt="Second image for id 1"/>')
   .attr('src', "image1.jpg");

$('#id1').append(imgnode); 
```

请务必使用该`attr`方法设置任何动态属性。无需以这种方式转义特殊符号。

另外，我不确定动态生成脚本标签的效果如何；我从未尝试过。不过，预计它们包含或引用客户端脚本。我的假设是什么`page.aspx`会返回。你的问题对你在那里尝试做的事情有点模糊。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-17T16:38:37.940

jQuery 有一个现成的 document.write 替代品。您需要使用的只是 append 方法。

```
 jQuery('<img src=""/>').appendTo('body'); 
```

这是不言而喻的。但简而言之，您可以将 替换为您想要的任何 html。appendTo 方法中的标签名称是您要将 html 附加到的标签的名称。就是这样。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-17T16:42:33.657

picardo 的回答有效，但这对我来说更直观：

```
$("body").append('<img src=\"/image/1.jpg\" alt=\"Second image for id 1\">'); 
```

此外，对于使用 document.write() 插入的脚本部分，请查看[jQuery 的 getScript() 函数](http://docs.jquery.com/Ajax/jQuery.getScript#urlcallback)

# sql - IN 谓词在 SQL 中如何工作？

> ID：761150
> 
> 赞同：21
> 
> 时间：2009-04-17T16:31:35.727
> 
> 标签：sql, performance, optimization

[在准备好这个问题](https://stackoverflow.com/questions/761044/sql-query-help)的答案后，我发现我无法验证我的答案。

在我的第一份编程工作中，有人告诉我，`IN ()`谓词中的查询会针对父查询中包含的每一行执行，因此`IN`应该避免使用。

例如，给定查询：

```
SELECT count(*) FROM Table1 WHERE Table1Id NOT IN (
SELECT Table1Id FROM Table2 WHERE id_user = 1) 
```

```
表 1 行 | # 次“IN”执行
----------------------------------
      10 | 10
     100 | 100
    1000 | 1000
   10000 | 10000

```

它是否正确？`IN`谓词实际上是如何工作的？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-17T17:35:59.923

您收到的关于为每一行执行子查询的警告是正确的——对于**相关的子查询。**

```
SELECT COUNT(*) FROM Table1 a 
WHERE a.Table1id NOT IN (
  SELECT b.Table1Id FROM Table2 b WHERE b.id_user = a.id_user
); 
```

请注意，子查询引用`id_user`外部查询的列。`id_user`每一行的值`Table1`可能不同。因此，子查询的结果可能会有所不同，具体取决于外部查询中的当前行。RDBMS*必须*多次执行子查询，外部查询中的每一行执行一次。

您测试的示例是**不相关的子查询**。大多数现代的 RDBMS 优化器应该能够判断子查询的结果何时*不*依赖于外部查询的每一行中的值。在这种情况下，RDBMS 运行一次子查询，缓存其结果，并在外部查询中重复使用它作为谓词。

PS：在 SQL 中，`IN()`称为“谓词”，而不是语句。谓词是语言的一部分，可以评估为真或假，但不一定作为语句独立执行。也就是说，您不能只将其作为 SQL 查询运行：“2 IN (1,2,3);” 尽管这是一个有效的谓词，但它不是一个有效的陈述。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-17T16:34:20.117

这将完全取决于您使用的数据库以及确切的查询。

查询优化器有时非常聪明 - 在您的示例查询中，我希望更好的数据库能够使用与连接相同的技术。更幼稚的数据库可能只是多次执行相同的查询。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-17T16:37:42.433

这取决于所讨论的`RDBMS`问题。

详细分析请看这里：

*   [**MySQL，第 1 部分**](http://explainextended.com/2009/04/18/counting-missing-rows/)
*   [**MySQL，第 2 部分**](http://explainextended.com/2009/04/19/counting-missing-rows-using-distinc/)
*   [**SQL 服务器**](http://explainextended.com/2009/04/20/counting-missing-rows-sql-server/)
*   [**甲骨文**](http://explainextended.com/2009/04/21/counting-missing-rows-oracle/)
*   [**PostgreSQL**](http://explainextended.com/2009/04/22/counting-missing-rows-postgresql/)

简而言之：

1.  `MySQL`将查询优化到这个：

    ```
    SELECT  COUNT(*)
    FROM    Table1 t1
    WHERE   NOT EXISTS
            (
            SELECT  1
            FROM    Table2 t2
            WHERE   t2.id_user = 1
                    AND t2.Table1ID = t1.Table2ID
            ) 
    ```

    并在循环中运行内部子查询，每次都使用索引查找。

    *   `SQL Server`将使用`MERGE ANTI JOIN`.

    内部子查询不会按照常识“执行”，而是同时获取查询和子查询的结果。

    有关详细说明，请参阅上面的链接。

    *   `Oracle`将使用`HASH ANTI JOIN`.

    内部子查询将执行一次，并从结果集中构建一个哈希表。

    来自外部查询的值将在哈希表中查找。

    *   `PostgreSQL`将使用`NOT (HASHED SUBPLAN)`.

    很像`Oracle`。

请注意，将查询重写为：

```
SELECT  (
        SELECT  COUNT(*)
        FROM    Table1
        ) - 
        (
        SELECT  COUNT(*)
        FROM    Table2 t2
        WHERE   (t2.id_user, t2.Table1ID) IN
                (
                SELECT  1, Table1ID
                FROM    Table1
                )
        ) 
```

将大大提高所有四个系统的性能。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-17T16:34:18.260

取决于优化器。检查每个特定查询的确切[查询计划](http://en.wikipedia.org/wiki/Query_plan)，以了解 RDBMS 将如何实际执行该计划。

在甲骨文中是：

```
EXPLAIN PLAN FOR «your query» 
```

在 MySQL 或 PostgreSQL 中

```
EXPLAIN «your query» 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-17T16:34:30.787

现在大多数 SQL 引擎几乎总是为 LEFT JOIN、NOT IN 和 NOT EXISTS 创建相同的执行计划

我会说看看你的执行计划并找出:-)

此外，如果 Table1Id 列的值为 NULL，您将无法取回任何数据

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-17T16:33:48.060

并不真地。但是使用 JOIN 编写这样的查询很方便

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-17T16:38:06.880

是的，但是一旦查询处理器“找到”您正在寻找的值，执行就会停止......因此，例如，如果外部选择中的第一行有 Table1Id = 32，并且如果 Table2 有一条带有 TableId = 的记录32，然后一旦子查询在Table2中找到TableId = 32的行，它就会停止......

# winforms - VS2005 Winforms Designer 异常画面和IE8

> ID：761155
> 
> 赞同：9
> 
> 时间：2009-04-17T16:33:06.737
> 
> 标签：winforms, visual-studio-2005

自从我安装 Internet Explorer V8 以来，我的 Winforms Designer 异常屏幕 (WSOD) 似乎已损坏。之前我会得到带有描述错误的红色文本，今天我得到了这个：

[WSOD 坏了 http://faxt.com/images/WSODBroken.png](http://faxt.com/images/WSODBroken.png)

任何人都可以向我建议一种方法来恢复此显示的文本视图，我正在浪费时间试图阅读 Winform 文件现在不会在设计器中显示的原因。谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-06-10T14:07:01.760

我可以通过向*.tmp注册表添加新子项并从**.html*复制设置来解决此问题。进行这些更改后，应呈现 Visual Studio 中的设计器错误，而不是显示错误的 HTML 代码。

*   打开**HKEY_LOCAL_MACHINE\SOFTWARE\Classes**并添加一个**.tmp**类型的新子项。
*   *将（默认）*值的数据更改为：*htmlfile*
*   *使用text/html*数据添加新的*Content Type*字符串值
**   *使用文本*数据添加*PerceivedType*的新字符串值*

 **[![替代文字](https://i.stack.imgur.com/ka1iu.png)](https://i.stack.imgur.com/ka1iu.png)
[（来源：[lazypenguin.com](http://www.lazypenguin.com/stackoverflow/DesignerErrors.png)）]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-03-09T19:17:04.150

该修复（添加子项）的问题是现在所有 tmp 文件都被视为 HTML 文件。我发现，如果您尝试下载 tmp 文件（而不是仅仅显示不正确），最好的解决方法是从“HKEY_LOCAL_MACHINE\SOFTWARE\Classes”或“的注册表（和 tmp_auto_file）中删除 .tmp 条目HKEY_CLASSES_ROOT”，因为它们实际上是同一个地方。但是，它可能仍显示为文本而不是网页。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2010-10-17T15:01:04.187

问题实际上是“Form1 类可以设计，但不是文件中的第一个类。Visual Studio 要求设计人员使用文件中的第一个类。**移动类代码，使其成为文件中的第一个类，尝试再次加载设计器。** ”

所以我在文件的开头移动了 Form1 类（我在它之前手动创建了几个类） -**它有效！**不要对 IE 做任何事情。

# regex - 非零十六进制值的正则表达式

> ID：761158
> 
> 赞同：1
> 
> 时间：2009-04-17T16:33:40.197
> 
> 标签：regex, hex

我正在寻找一个正则表达式来确定 32 位十六进制值中的任何值何时非零。

数据模式看起来像`0x00000000`，我想知道任何数字何时非零。例如，如果`0x00001000`或将被正则表达式捕获，但不是`0x10000000`模式。现在我执行步行模式匹配`0xB000000``0x00000000`

```
0x[^0]
0x0[^0]
0x00[^0]
...
0x0000000[^0] 
```

这会起作用，但如果可能的话，我更愿意使用一种模式。谢谢。

标记

编辑：我没有提到程序中不需要正则表达式，否则我会使用不同的方法，但我使用正则表达式在使用 UltraEdit 的日志文件中搜索值。我本可以开发一个程序或其他搜索方式，但我只是懒惰，只是诚实。Ben S 解决方案适用于 UltraEdit 和 Rad Software 正则表达式设计器。rampion 解决方案在这两种工具中都不起作用，不知道为什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-17T16:37:30.360

为什么不针对零测试十六进制值？更简单，更快，更具可读性。

如果确实需要正则表达式g，则`0x0*[1-9a-fA-F][0-9a-fA-F]*`应该这样做。

它会寻找尽可能多的零，直到找到一个非零的十六进制值，然后收集其余的十六进制值，无论它是否为零。

**注意**：这将匹配任何长度的十六进制，而不仅仅是 32 位。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T16:44:35.100

```
/0x0*[1-9a-fA-F][0-9a-fA-F]*/ 
```

`*<atom>**`表示匹配原子 0 次或多次，因此此模式匹配`0x`前缀，后跟 0 或多个`0`s，后跟非零十六进制，然后是一些十六进制。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-17T16:45:46.173

为什么不尝试一些稍微不同的东西。测试非零十六进制比测试零十六进制要困难得多。所以测试为零并手动执行。

```
bool IsNonZeroHex(string input) {
  return !Regex.IsMatch(input, "^0x(0*)$");
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T16:43:50.313

```
/0x0*[^0]/ 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-17T16:49:55.040

我认为这应该涵盖所有情况（如果它真的必须是一个正则表达式）：

```
^0x(?=0*[1-9a-fA-F]0*)[0-9a-fA-F]{8}$ 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-05-30T15:32:38.067

可以使用负前瞻来查找固定大小的十六进制数字，如下所示：

```
/(0x(?!0{8})[0-9a-fA-F]{8})/ 
```

一个组被查找开始于`0x`

然后否定向前看`0{8}`（如果找到则失败）

否则匹配`[0-9a-fA-F]{8}`

适用于 PCRE、JavaScript、Python。不知道哪些编辑器支持负前瞻。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-17T16:38:03.977

当然是一个简单的字符串比较，如果它是`DOES NOT EQUAL`“0x00000000”，你就得到了你的匹配。

我是否过度简化它？这只是一种`FALSE`情况，对吧？当字符串为“0x00000000”时？

除非必须，否则不要使用 RegEx。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-17T17:21:34.950

```
/0x0{0,7}[^0]/ 
```

' `0x`'，后跟零到七个 ' `0`'，后跟不是 ' `0`'

# mysql - 在表中存储/检索数组的最佳方式

> ID：761170
> 
> 赞同：0
> 
> 时间：2009-04-17T16:37:04.260
> 
> 标签：mysql

我目前在 MySQL 中有一个可以正常存储值的表，但我想在该表中添加一个字段来存储值数组，例如城市。我应该将该数组简单地存储为 CSV 吗？每行都需要它自己的数组，所以我对制作一个新表并为插入前一个表的每一行插入 2-5 行感到不安。

我觉得这种情况应该有一个名字，我只是想不出来:)

编辑

元素数量 - 2-5（从动态城市列表中选择，数组引用列表，即表格）

该字段不需要可​​搜索，只需与其他数据一起检索即可。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T16:41:44.390

“正确”的方法是拥有另一个包含每个值的表，但是由于您不想走那条路线，因此分隔列表应该可以工作。只需确保您选择了一个不会出现在数据中的分隔符。您还可以将数据存储为 XML，具体取决于您计划如何与数据交互，这可能是更好的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T16:44:18.550

我会采用包含逗号（或其他逻辑分隔符）分隔值的字段的想法。只需确保您的字段足够大以容纳最大数组大小。然后，当您拉出该字段时，应该很容易使用您的分隔符对长字符串执行explode()，然后它将立即在代码中填充您的数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T16:44:06.943

也许您正在寻找的词是“规范化”。如，将数组移动到单独的表中，通过键链接到第一个表。这提供了几个优点：

*   数组大小几乎可以无限增长

*   高效存储

*   无需使用“like”即可在数组中搜索值

当然，是否对这些数据进行归一化的决定取决于很多你没有提到的因素，比如元素的数量，数量是否固定，元素是否需要可搜索等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T17:30:34.257

你的应用程序是 PHP 的吗？可能值得研究函数**[serialize](http://www.php.net/serialize)**和**[unserialize](http://www.php.net/unserialize)**。

These two functions allow you to easily store an array in the database, then recreate that array at a later time.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-17T17:32:34.580

As others have mentioned, another table is the *proper* way to go.

But if you really don't want to do that(?), assuming you're using PHP with MySQL, why not use the [serialize()](http://php.net/serialize) and store a serialized value?

# visual-studio - Silverlight 用户控件在设计器中消失

> ID：761171
> 
> 赞同：0
> 
> 时间：2009-04-17T16:37:09.580
> 
> 标签：visual-studio, silverlight, xaml

我正在 Silverlight 中编写一个应用程序，该应用程序应该从 Google 检索天气数据，然后显示它。我在 XAML 中处理布局，并打算看看它在设计器中的外观，但是当我切换到设计器窗格时，一个小通知说程序集已更新，所以我单击它，用户控件消失了！我一直在尝试删除部分最近的标记，但似乎没有帮助。这是主用户控件的 XAML：

```
<UserControl x:Class="TestApp2.Page"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    xmlns:data="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Data"
    xmlns:wtb="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Extended"
    xmlns:local="clr-namespace:TestApp2"
    Width="400" Height="300">

    <Grid x:Name="LayoutRoot" Background="#FF5e59e4">
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <Border Grid.Row="0" Grid.Column="0" Margin="5" CornerRadius="5" Background="AliceBlue">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="30" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="100" />
                    <ColumnDefinition Width="70" />
                </Grid.ColumnDefinitions>

                <Border Grid.Row="0" Grid.Column="0" Margin="3" Style="{StaticResource RoundedBox}" >
                    <TextBlock x:Name="TextBox" Text="Weather Finder" Margin="5,0,0,0" FontSize="18" VerticalAlignment="Center"/>
                </Border>
                <wtb:WatermarkedTextBox Grid.Row="0" Grid.Column="1" Watermark="City..." Margin="2,4,2,4" />
                <Button x:Name="SearchButton" Grid.Row="0" Grid.Column="3" Content="Search" VerticalAlignment="Center" Margin="2,0,2,0" />

                <!--<ListBox x:Name="DataList" Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="3" Margin="3,0,3,3" />-->

                <StackPanel Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="3" Margin="3,0,3,3" Orientation="Vertical">
                    <local:WeatherBox x:Name="Cur" HorizontalAlignment="Center" />

                    <StackPanel Orientation="Horizontal">
                        <local:WeatherBox x:Name="Day1" HorizontalAlignment="Center" />
                        <local:WeatherBox x:Name="Day2" HorizontalAlignment="Center" />
                        <local:WeatherBox x:Name="Day3" HorizontalAlignment="Center" />
                        <local:WeatherBox x:Name="Day4" HorizontalAlignment="Center" />

                    </StackPanel>
                </StackPanel>
            </Grid>
        </Border>

    </Grid>
</UserControl> 
```

我还没有将任何功能写入应用程序，所以这不是问题。我相信这可能与我自己的 WeatherBox 有关（如果有人想看到它的代码），但是从代码中删除它们是行不通的。有什么问题？

我想我可能已经发现了问题的一个原因。WeatherBox 控件中的这行 XAML 在我运行应用程序时出现异常：

```
<BitmapImage UriSource="{Binding Thumbnail, Converter={StaticResource BitmapImageConverter}}" /> 
```

据我了解，不可能直接在 UriSource 中使用绑定，所以我尝试使用转换器。它似乎在编辑器中有效，但在运行时无效。我仍然不知道出了什么问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-18T00:35:27.887

在您设计的自定义控件中，这种情况总是会发生。目前，Visual Studio 设计师的支持非常不稳定（silverlight 2 & 3 beta 与 Visual Studio 2008）。它会有一点点生气，永远不会告诉你为什么。至少你没有收到 COM 错误。

找出导致它的控件的最简单方法是开始注释掉 XAML 的大片，直到您通过消除来识别控件。

通常它将是您自己的控件之一，并且它会这样做，因为您试图从网站或 Web 服务下载一些数据，而在设计器模式下它不能这样做。您需要做的就是检测它是否处于设计模式，如果是则跳过代码。

这是一个关于检测设计模式的帖子：http: [//blogs.sqlxml.org/bryantlikes/archive/2009/02/25/detecting-design-mode-in-silverlight.aspx](http://blogs.sqlxml.org/bryantlikes/archive/2009/02/25/detecting-design-mode-in-silverlight.aspx)

绑定错误不是原因，但不应忽略它。这意味着您绑定的对象没有您要访问的属性。

# firefox - firefox 3地址栏自动完成依赖

> ID：761179
> 
> 赞同：2
> 
> 时间：2009-04-17T16:38:34.087
> 
> 标签：firefox, autocomplete, interop, address-bar

**背景：** 使用FF3的朋友可能对地址栏的一个有趣的新属性很熟悉。它允许您执行子字符串自动完成，以便过滤您之前查看过的 URL。

因此，如果要打开以下 URL：

```
 http://longservernamehere.thatyou.nevercanremember.com/support/asdf1235234/kbid?1245 
```

您可以简单地键入该 URL 的任何足以唯一区分 URL 的子字符串：

```
 long<space>never<space>support<ENTER> 
```

这改变了用户对 URL 的思考方式，因为现在他们只需要记住有助于缩小潜在链接范围的关键字（子字符串）

**问题：**这个功能很棒，但有一个缺点。用户对 URL 进行书签和记忆的动机降低。如果用户需要在远程站点（例如在销售电话期间）键入 URL，并且由于不记得想要在会议期间显示的时髦产品目录的 URL，这显然会成为一个问题。

显然，有一些方法可以解决这个问题：在你开会之前给你的网址添加书签，然后将书签复制到你的笔记本电脑上；使用第三方解决方案或在线书签门户；社交书签网站等。

**问题** 问题是，对于那些不想使用上述任何解决方法的用户，实际上是否有一种方法可以**直接**挖掘 FF3 内部结构，这样我就可以编写一个脚本来提取复制用户自动所需的组件 -任何机器上的完整行为？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-17T17:24:26.440

Firefox 将所有这些信息存储在[SQLite](http://www.sqlite.org/)数据库中。如果安装了 SQLite，可以直接查询。您还可以使用[SQLite Manager](http://code.google.com/p/sqlite-manager/) Firefox 插件浏览它。

总之，url历史存储在moz_places中，您在地址栏中输入的各种“短语”通过moz inputhistory（一个子表）与*地点相关联。*`_`

他们的算法似乎是：当您在地址栏中键入每个字符时，查询`_`moz inputhistory 以查找匹配条目并按 use_count 降序显示它们。

希望有帮助。

编辑：这个网站有一堆关于 Firefox 数据库的好信息：[firefoxforensic.com](http://www.firefoxforensics.com/)

# html - 关注点 - 表格布局、iFrame、代码弃用

> ID：761182
> 
> 赞同：2
> 
> 时间：2009-04-17T16:38:47.657
> 
> 标签：html, css, iframe, layout, html-table

我正在使用一个简单的基于表格的布局，该布局使用 iFrame，如下例所示。这段代码在所有现代浏览器中都能很好地呈现。iFrame 通常充满长数据表，但没有奇怪的行为或剪辑。

我担心的是它对我来说看起来像是一个非常糟糕的黑客攻击。除了基于表格的布局弊端，*我是否应该担心 HTML 和 iFrame 标签的所有 width="100%" height="100%" 属性被弃用*？

我知道 CSS 可以做大部分（如果不是全部），但我不想使用浮动 hack，而且我无法确定任何适用于所有现代浏览器的东西。

需要明确的是，我正在寻找关于这个解决方案是否适合未来几年的意见和建议，或者我是否应该继续深入研究 CSS hack。

感谢您的任何反馈。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Untitled</title>
 <style type="text/css">
   <!--
    html, body
    {
      height: 100%;
      margin: 0px;
    }
    -->
 </style>
</head>
<body>
   <table border="0" cellpadding="0" cellspacing="0" width="100%" height="100%">
    <tr>
        <td colspan="2"><div align="center">This is the header.</div></td>
    </tr>
    <tr>
        <td height="100%">
            <iFrame src="pane1.php" width="100%" height="100%" frameborder="0"></iframe>
        </td>
        <td height="100%">
            <iFrame src="pane2.php" width="100%" height="100%" frameborder="0"></iframe>
        </td>
    </tr>
    <tr>
        <td colspan="2">This is the footer.</td>
    </tr>
   </table>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T19:38:33.670

在接下来的几年（或几年）内，我看不到任何将从任何浏览器中删除的内容。

表格标签是一组有效且需要的标签。没有它，就无法显示表格数据。

发生的事情是人们开始利用它来显示非常复杂的布局，最终无法维护。

没有人会因为你以你正在使用的方式使用桌子而开枪。它超级简单，可以在您开发的同时完成工作，因此只需将其视为一次迭代。迭代开发是好的。一旦你确定了一个基于 CSS 的布局，这里的代码就很简单，可以替换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T16:53:30.697

如果您担心弃用，最好转向 css 样式。如果您更舒服，您仍然可以使用表格布局，但我更喜欢浮动 div。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-18T09:23:22.423

据我所知，标签没有被弃用的危险。我有一个很好的来源！

请参阅[IFrame (HTML) 是否已过时？](https://stackoverflow.com/questions/755795/are-iframes-html-obsolete)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T19:53:44.617

弃用意味着这些功能将不会出现在 (X)HTML 的未来版本中。到目前为止，所有浏览器都支持旧版本的 HTML，但我自己不会依赖它。

您正在做的所有事情以及更多事情都可以通过 CSS 完成，而无需使用 hack。完成练习将帮助您保持相关技能。您现在拥有的页面需要两个额外的 HTTP 请求才能显示；这是否是一个问题取决于有多少人在请求该页面。

# oop - 接口 vs 抽象类（通用 OO）

> ID：761194
> 
> 赞同：1500
> 
> 时间：2009-04-17T16:42:38.523
> 
> 标签：oop, interface, abstract-class

我最近接受了两次电话采访，被问及接口和抽象类之间的区别。我已经解释了我能想到的每个方面，但似乎他们在等我提一些具体的东西，我不知道它是什么。

根据我的经验，我认为以下是正确的。如果我遗漏了一个要点，请告诉我。

**界面：**

接口中声明的每一个方法都必须在子类中实现。接口中只能存在事件、委托、属性 (C#) 和方法。一个类可以实现多个接口。

**抽象类：**

只有抽象方法必须由子类实现。抽象类可以具有带有实现的普通方法。除了事件、委托、属性和方法之外，抽象类还可以具有类变量。由于 C# 中不存在多重继承，一个类只能实现一个抽象类。

1.  毕竟，面试官提出了一个问题“如果你有一个只有抽象方法的抽象类怎么办？这与接口有什么不同？” 我不知道答案，但我认为这是上面提到的继承对吗？

2.  另一位面试官问我，如果你在接口中有一个公共变量，那与抽象类有什么不同？我坚持你不能在接口内有一个公共变量。我不知道他想听什么，但他也不满意。

**另见**：

*   [何时使用接口而不是抽象类，反之亦然](https://stackoverflow.com/questions/479142/when-to-use-an-interface-instead-of-an-abstract-class-and-vice-versa)

*   [接口与抽象类](https://stackoverflow.com/questions/747517/interfaces-vs-abstract-classes)

*   [您如何决定使用抽象类和接口？](https://stackoverflow.com/questions/558164/how-do-you-decide-between-using-an-abstract-class-and-an-interface-closed)

*   [接口和抽象类有什么区别？](https://stackoverflow.com/questions/1913098/what-is-the-difference-between-an-interface-and-abstract-class?rq=1)

* * *

## 回答 #1

> 赞同：909
> 
> 时间：2010-08-30T04:40:32.607

打个比方吧：当我在空军时，我参加了飞行员培训并成为了 USAF（美国空军）飞行员。那时我没有资格驾驶任何东西，必须参加飞机类型培训。一旦我获得资格，我就是一名飞行员（抽象类）和一名 C-141 飞行员（具体类）。在我的一项任务中，我被赋予了一项额外的职责：安全官。现在我仍然是一名飞行员和一名 C-141 飞行员，但我也履行了安全官的职责（可以这么说，我实施了 ISafetyOfficer）。飞行员不需要成为安全官，其他人也可以这样做。

所有美国空军飞行员都必须遵守某些空军范围内的规定，所有 C-141（或 F-16 或 T-38）飞行员“都是”美国空军飞行员。任何人都可以成为安全员。所以，总结一下：

*   Pilot：抽象类
*   C-141 飞行员：混凝土级
*   I安全官：界面

补充说明：这是一个类比来帮助解释这个概念，而不是编码建议。请参阅下面的各种评论，讨论很有趣。

* * *

## 回答 #2

> 赞同：788
> 
> 时间：2009-04-17T17:18:40.247

虽然您的问题表明它是针对“一般 OO”的，但它似乎确实专注于 .NET 对这些术语的使用。

在 .NET 中（Java 类似）：

*   接口可以没有状态或实现
*   实现接口的类必须提供该接口所有方法的实现
*   抽象类可能包含状态（数据成员）和/或实现（方法）
*   可以在不实现抽象方法的情况下继承抽象类（尽管这样的派生类本身就是抽象的）
*   接口可能是多重继承的，抽象类可能不是（这可能是接口与抽象类分开存在的关键具体原因——它们允许实现多重继承，从而消除了一般 MI 的许多问题）。

作为一般的 OO 术语，这些差异不一定是明确定义的。例如，有些 C++ 程序员可能持有类似的严格定义（接口是抽象类的严格子集，不能包含实现），而有些人可能会说具有某些默认实现的抽象类仍然是接口或非抽象类仍然可以定义一个接口。

确实，有一个称为非虚拟接口 (NVI) 的 C++ 习语，其中公共方法是非虚拟方法，它们“转换”到私有虚拟方法：

*   [http://www.gotw.ca/publications/mill18.htm](http://www.gotw.ca/publications/mill18.htm)
*   [http://en.wikibooks.org/wiki/More_C%2B%2B_Idioms/Non-Virtual_Interface](http://en.wikibooks.org/wiki/More_C%2B%2B_Idioms/Non-Virtual_Interface)

* * *

## 回答 #3

> 赞同：233
> 
> 时间：2011-08-31T12:09:43.967

我认为他们正在寻找的答案是根本的或 OPPS 哲学差异。

当派生类共享抽象类的核心属性和行为时，使用抽象类继承。实际定义类的那种行为。

另一方面，当类共享外围行为时使用接口继承，这些外围行为不一定定义派生类。

例如。Car 和 Truck 共享汽车抽象类的许多核心属性和行为，但它们也共享一些外围行为，例如生成排气，即使是 Drillers 或 PowerGenerators 等非汽车类也共享，并且不一定定义 Car 或 Truck ，所以 Car、Truck、Driller 和 PowerGenerator 都可以共享同一个接口 IExhaust。

* * *

## 回答 #4

> 赞同：220
> 
> 时间：2012-04-05T09:53:44.017

简短：抽象类用于对外观相似的类的类层次结构进行**建模**（例如，Animal 可以是抽象类，Human、Lion、Tiger 可以是具体的派生类）

和

接口用于两个相似/不相似的类之间的**通信**，它不关心实现接口的类的类型（例如高度可以是接口属性，它可以由 Human ， Building ， Tree 实现。不管你能不能吃，你可以游泳，你可以死或任何事情..重要的是你需要有高度（在你的课堂上实现））。

* * *

## 回答 #5

> 赞同：78
> 
> 时间：2009-04-17T16:46:41.337

还有一些其他差异 -

接口不能有任何具体的实现。抽象基类可以。这允许您在那里提供具体的实现。这可以允许抽象基类实际上提供更严格的契约，而接口实际上只描述如何使用类。（抽象基类可以有定义行为的非虚拟成员，这给了基类作者更多的控制权。）

一个类可以实现多个接口。一个类只能派生自一个抽象基类。这允许使用接口而不是抽象基类的多态层次结构。这也允许使用接口进行伪多继承。

抽象基类可以在 v2+ 中进行修改，而不会破坏 API。对接口的更改是重大更改。

[C#/.NET 特定] 与抽象基类不同，接口可以应用于值类型（结构）。结构不能从抽象基类继承。这允许将行为契约/使用指南应用于值类型。

* * *

## 回答 #6

> 赞同：70
> 
> 时间：2013-06-14T13:11:05.443

**继承**
考虑一辆汽车和一辆公共汽车。它们是两种不同的车辆。但是，它们仍然具有一些共同的属性，例如它们具有转向、制动器、齿轮、发动机等。
因此，使用继承概念，这可以表示为以下...

```
public class Vehicle {
    private Driver driver;
    private Seat[] seatArray; //In java and most of the Object Oriented Programming(OOP) languages, square brackets are used to denote arrays(Collections).
    //You can define as many properties as you want here ...
} 
```

现在一辆自行车...

```
public class Bicycle extends Vehicle {
    //You define properties which are unique to bicycles here ...
    private Pedal pedal;
} 
```

还有一辆车...

```
public class Car extends Vehicle {
    private Engine engine;
    private Door[] doors;
} 
```

这就是*继承*。如上所示，我们使用它们将对象分类为更简单的基本形式及其子形式。

**抽象类**

抽象类是*不完整*的对象。为了进一步理解它，让我们再次考虑车辆类比。
可以驾驶车辆。对？但是不同的车辆以不同的方式驾驶......例如，您不能像驾驶自行车一样驾驶汽车。
那么如何表示车辆的驱动功能呢？更难检查它是什么类型的车辆并用它自己的功能来驱动它；添加新类型的车辆时，您将不得不一次又一次地更改 Driver 类。
这就是抽象类和方法的作用。您可以将驱动方法定义为抽象的，以告知每个继承子必须实现此功能。
因此，如果您修改车辆类别...

```
//......Code of Vehicle Class
abstract public void drive();
//.....Code continues 
```

自行车和汽车还必须指定如何驾驶它。否则，代码将无法编译并引发错误。
简而言之..抽象类是具有一些不完整功能的部分不完整类，继承的孩子必须自己指定。

**接口** 接口是完全不完整的。它们没有任何属性。他们只是表明继承的孩子有能力做某事......
假设你有不同类型的手机。他们每个人都有不同的方式来完成不同的功能；例如：打电话给一个人。手机制造商指定如何操作。在这里，手机可以拨打一个号码——也就是说，它是可拨号的。让我们将其表示为一个接口。

```
public interface Dialable {
    public void dial(Number n);
} 
```

此处 Dialable 的制造商定义了如何拨打号码。您只需要给它一个号码即可拨打。

```
// Makers define how exactly dialable work inside.

Dialable PHONE1 = new Dialable() {
    public void dial(Number n) {
        //Do the phone1's own way to dial a number
    }
}

Dialable PHONE2 = new Dialable() {
    public void dial(Number n) {
        //Do the phone2's own way to dial a number
    }
}

//Suppose there is a function written by someone else, which expects a Dialable
......
public static void main(String[] args) {
    Dialable myDialable = SomeLibrary.PHONE1;
    SomeOtherLibrary.doSomethingUsingADialable(myDialable);
}
..... 
```

因此使用接口而不是抽象类，使用 Dialable 的函数的编写者不必担心它的属性。例如：是否有触摸屏或拨号盘，是固定座机电话还是手机。你只需要知道它是否可以拨号；它是否继承（或实现） Dialable 接口。

*更重要的是*，如果有一天你把 Dialable 换成另一个

```
......
public static void main(String[] args) {
    Dialable myDialable = SomeLibrary.PHONE2; // <-- changed from PHONE1 to PHONE2
    SomeOtherLibrary.doSomethingUsingADialable(myDialable);
}
..... 
```

您可以确定代码仍然可以完美运行，因为使用 dialable 的函数不（也不能）依赖于 Dialable 接口中指定的细节以外的细节。它们都实现了一个 Dialable 接口，这是该函数唯一关心的事情。

开发人员通常使用接口来确保对象之间的互操作性（可互换使用），只要它们共享一个共同的功能（就像您可以更改为固定电话或手机一样，只要您只需拨打一个号码即可）。简而言之，接口是抽象类的一个更简单的版本，没有任何属性。
另外，请注意，您可以实现（继承）任意数量的接口，但您只能扩展（继承）单个父类。

**更多信息** [抽象类与接口](http://www.programmerinterview.com/index.php/java-questions/interface-vs-abstract-class/)

* * *

## 回答 #7

> 赞同：50
> 
> 时间：2015-11-27T19:20:47.993

如果您考虑`java`使用 OOP 语言来回答这个问题，Java 8 版本会导致上述答案中的某些内容已过时。现在java接口可以有带有具体实现的默认方法。

Oracle[网站](https://docs.oracle.com/javase/tutorial/java/IandI/abstract.html)`interface`提供了与`abstract`类之间的关键区别。

**在以下情况下考虑使用抽象类**：

1.  您希望在几个密切相关的类之间共享代码。
2.  您希望扩展抽象类的类具有许多公共方法或字段，或者需要公共以外的访问修饰符（例如受保护和私有）。
3.  您要声明非静态或非最终字段。

**在以下情况下考虑使用接口**：

1.  您希望不相关的类会实现您的接口。例如，许多不相关的对象可以实现`Serializable`接口。
2.  您想指定特定数据类型的行为，但不关心谁实现了它的行为。
3.  您想利用类型的多重继承。

简单来说，我想使用

***接口：***通过多个不相关的对象来实现一个契约

***抽象类：***在多个相关对象之间实现相同或不同的行为

查看代码示例以清楚地理解事物：[我应该如何解释接口和抽象类之间的区别？](https://stackoverflow.com/questions/18777989/how-should-i-have-explained-the-difference-between-an-interface-and-an-abstract/34978606#34978606)

* * *

## 回答 #8

> 赞同：33
> 
> 时间：2009-04-17T16:48:06.170

面试官们在叫着一棵奇怪的树。对于像 C# 和 Java 这样的语言，是有区别的，但在像 C++ 这样的其他语言中则没有。OO 理论并没有区分两者，只是语言的语法。

抽象类是具有将被继承的实现和接口（纯虚方法）的类。接口通常没有任何实现，只有纯虚函数。

在 C# 或 Java 中，没有任何实现的抽象类与接口的区别仅在于用于从接口继承的语法以及您只能从接口继承的事实。

* * *

## 回答 #9

> 赞同：30
> 
> 时间：2009-04-17T16:52:42.913

通过实现接口，您正在实现组合（“has-a”关系）而不是继承（“is-a”关系）。当涉及到需要使用接口来实现行为组合而不是继承的设计模式时，这是一个需要记住的重要原则。

* * *

## 回答 #10

> 赞同：28
> 
> 时间：2012-01-23T11:43:42.533

从概念上讲，保持语言特定的实现、规则、好处并通过使用任何一个或两者来实现任何编程目标，可以或不可以有代码/数据/属性，等等等等，单继承或多继承，都放在一边

1-抽象（或纯抽象）类旨在实现层次结构。如果您的业务对象在结构上看起来有些相似，仅表示父子（层次结构）类型的关系，那么将使用继承/抽象类。如果您的业务模型没有层次结构，则不应使用继承（这里我不是在谈论编程逻辑，例如某些设计模式需要继承）。从概念上讲，抽象类是在OOP中实现业务模型层次结构的一种方法，它与接口无关，实际上将抽象类与接口进行比较是没有意义的，因为两者在概念上是完全不同的东西，在采访中要求它只是为了检查概念，因为它看起来在实现方面都提供了一些相同的功能，而且我们程序员通常更强调编码。[请记住，抽象与抽象类不同]。

2-接口是一个契约，一个完整的业务功能，由一组或多组功能表示。这就是为什么它被实现而不是继承。业务对象（无论是否属于层次结构）可以具有任意数量的完整业务功能。它与抽象类无关，通常意味着继承。例如，人可以RUN，大象可以RUN，鸟可以RUN，等等，所有这些不同层次的对象都会实现RUN接口或EAT或SPEAK接口。不要进入实现，因为您可能会将其实现为具有实现这些接口的每种类型的抽象类。任何层次结构的对象都可以具有与其层次结构无关的功能（接口）。

我相信，接口不是为了实现多重继承或公开公共行为而发明的，同样，纯抽象类不是为了推翻接口，而是接口是对象可以执行的功能（通过该接口的函数），抽象类代表一个层次结构的父级，以产生具有父级核心结构（属性+功能）的子级

当您被问及差异时，除非明确询问，否则实际上是概念上的差异而不是特定于语言的实现的差异。

我相信，两位面试官都期望这两者之间有一条直接的区别，当你失败时，他们试图通过将 ONE 作为 OTHER 来推动你走向这种区别

> 如果你有一个只有抽象方法的抽象类怎么办？

* * *

## 回答 #11

> 赞同：26
> 
> 时间：2014-05-31T06:33:14.943

我将解释接口和抽象类的深度细节。如果您了解接口和抽象类的概述，那么第一个问题会出现在您的脑海中，什么时候应该使用接口，什么时候应该使用抽象类。所以请查看下面对接口和抽象类的解释。

1.  **什么时候应该使用接口？**

    *如果您不知道实现只是我们有需求规范，那么我们使用接口*

2.  **什么时候应该使用抽象类？**

    *如果您知道实现但不完全（部分实现），那么我们使用抽象类。*

    **界面**

    默认情况下，公共抽象的每个方法都意味着接口是 100% 纯抽象的。

    **抽象的**

    可以有具体方法和抽象方法，什么是具体方法，在抽象类中有实现，抽象类是声明为抽象的类——它可能包含也可能不包含抽象方法。

    **界面**

    我们不能将接口声明为私有的、受保护的

    问：为什么我们不将接口声明为私有和受保护的？

    因为默认接口方法是公共抽象的，所以我们没有将接口声明为私有和受保护的。

    **接口方法**
    我们也不能将接口声明为私有的、受保护的、最终的、静态的、同步的、本机的.....

    我将给出原因：为什么我们不声明同步方法，因为我们不能创建接口对象并且同步是在对象上工作的，所以我们不声明同步方法的原因瞬态概念也不适用，因为瞬态使用同步。

    **抽象的**

    我们很乐意与 public,private final static.... 一起使用，这意味着抽象中没有任何限制。

    **界面**

    默认情况下，变量在接口中声明为公共静态最终变量，因此我们也没有将变量声明为私有的、受保护的。

    易失性修饰符也不适用于接口，因为接口变量默认是公共静态最终和最终变量，一旦将值分配给变量，您就无法更改值，一旦将变量声明到接口，您必须分配变量。

    易失性变量不断变化，所以它是opp。到 final 这就是我们不在接口中使用 volatile 变量的原因。

    **抽象的**

    抽象变量无需声明为 public static final。

我希望这篇文章有用。

* * *

## 回答 #12

> 赞同：21
> 
> 时间：2009-04-17T16:48:05.763

对于.Net，

你对第二个面试官的回答也是对第一个面试官的回答......抽象类可以有实现，AND状态，接口不能......

编辑：另一方面，我什至不会使用短语“子类”（或“继承”短语）来描述“定义为实现”接口的类。对我来说，接口是一个契约的定义，如果一个类被定义为“实现”该接口，则它必须遵守该契约。它不继承任何东西......您必须自己添加所有内容，明确。

* * *

## 回答 #13

> 赞同：21
> 
> 时间：2014-08-14T10:27:02.387

***Interface***：如果您想对可能相互关联或不相互关联的组件暗示规则，则应使用

**优点：**

1.  允许多重继承
2.  通过不暴露上下文中使用的确切类型的对象来提供抽象
3.  通过合同的特定签名提供一致性

**缺点：**

1.  必须执行所有定义的合同
2.  不能有变量或委托
3.  一旦定义就不能在不破坏所有类的情况下进行更改

***抽象类***：应该用于您希望对彼此相关的组件有一些基本或默认行为或实现的地方

**优点：**

1.  比界面快
2.  实施具有灵活性（您可以完全或部分实施）
3.  可以在不破坏派生类的情况下轻松更改

**缺点：**

1.  无法实例化
2.  不支持多重继承

* * *

## 回答 #14

> 赞同：21
> 
> 时间：2019-06-08T19:00:40.660

这些答案都太长了。

*   接口用于定义行为。

*   抽象类用于定义事物本身，包括其行为。这就是为什么我们有时会创建一个抽象类，它具有一些继承接口的额外属性。

这也解释了为什么 Java 只支持类的单继承，而对接口没有限制。因为一个具体的对象不可能是不同的东西，但它可以有不同的行为。

* * *

## 回答 #15

> 赞同：18
> 
> 时间：2014-12-05T10:38:08.987

我认为他们不喜欢您的回复，因为您给出了技术差异而不是设计差异。这个问题对我来说就像一个巨魔问题。事实上，接口和抽象类具有完全不同的性质，因此您无法真正比​​较它们。我会给你我对接口的作用和抽象类的作用的看法。

**接口：**用于确保类之间的契约和低耦合，以便拥有更可维护、可扩展和可测试的应用程序。

**抽象类：**仅用于分解具有相同职责的类之间的某些代码。请注意，这是多重继承在 OOP 中不好的主要原因，因为一个[类不应该处理很多责任](https://en.wikipedia.org/wiki/Single_responsibility_principle)（改用[组合](https://en.wikipedia.org/wiki/Composition_over_inheritance)）。

所以接口具有真正的架构作用，而抽象类几乎只是实现的一个细节（当然，如果你正确使用它的话）。

* * *

## 回答 #16

> 赞同：14
> 
> 时间：2011-10-23T09:00:13.707

1.  界面：
    *   我们不实现（或定义）方法，我们在派生类中这样做。
    *   我们不在接口中声明成员变量。
    *   接口表达了 HAS-A 关系。这意味着它们是对象的面具。
2.  抽象类：
    *   我们可以在抽象类中声明和定义方法。
    *   我们隐藏它的构造函数。这意味着没有直接从它创建的对象。
    *   抽象类可以保存成员变量。
    *   派生类继承到抽象类，这意味着派生类的对象没有被屏蔽，它继承到抽象类。这种情况下的关系是 IS-A。

这是我的意见。

* * *

## 回答 #17

> 赞同：13
> 
> 时间：2013-08-20T12:34:23.787

```
After all that, the interviewer came up with the question "What if you had an 
Abstract class with only abstract methods? How would that be different
from an interface?" 
```

[文档](http://docs.oracle.com/javase/tutorial/java/IandI/abstract.html)清楚地说明，如果抽象类仅包含抽象方法声明，则应将其声明为接口。

```
An another interviewer asked me what if you had a Public variable inside
the interface, how would that be different than in Abstract Class? 
```

接口中的变量默认为 public static 和 final。如果抽象类中的所有变量都是公共的，那么问题可能会如何？与接口中的变量不同，它们仍然可以是非静态和非最终的。

最后，我要在上面提到的基础上再补充一点——抽象类仍然是类，属于单一继承树，而接口可以存在于多重继承中。

* * *

## 回答 #18

> 赞同：12
> 
> 时间：2014-04-21T19:34:47.177

Jeffrey Richter 通过 C# 从 CLR 复制...

我经常听到这样的问题，“我应该设计一个基本类型还是一个接口？” 答案并不总是明确的。

以下是一些可能对您有所帮助的指南：

■■ IS-A 与CAN-DO 关系 一个类型只能继承一个实现。如果派生类型不能声明与基类型的 IS-A 关系，则不要使用基类型；使用接口。接口意味着 CAN-DO 关系。如果 CAN-DO 功能似乎属于各种对象类型，请使用接口。例如，类型可以将自身的实例转换为另一种类型（IConvertible），类型可以序列化自身的实例（ISerializable）等。请注意，值类型必须从 System.ValueType 派生，因此不能派生来自任意基类。在这种情况下，您必须使用 CAN-DO 关系并定义接口。

■■ 易用性 作为开发人员，定义从基本类型派生的新类型通常比实现接口的所有方法更容易。基类型可以提供很多功能，因此派生类型可能只需要对其行为进行相对较小的修改。如果您提供接口，则新类型必须实现所有成员。

■■ 一致的实现 无论接口契约的文档记录得多么好，每个人都不太可能100% 正确地实现契约。事实上，COM 遇到了这个问题，这就是为什么某些 COM 对象只能在 Microsoft Word 或 Windows Internet Explorer 中正常工作的原因。通过提供一个具有良好默认实现的基本类型，您可以开始使用一种有效且经过良好测试的类型；然后您可以修改需要修改的部分。

■■ 版本控制 如果将方法添加到基类型，派生类型会继承新方法，您可以开始使用有效的类型，甚至不必重新编译用户的源代码。向接口添加新成员会强制接口的继承者更改其源代码并重新编译。

* * *

## 回答 #19

> 赞同：10
> 
> 时间：2013-10-04T21:11:14.587

接口定义了一个服务或一组服务的契约。它们以水平方式提供多态性，因为两个完全不相关的类可以实现相同的接口，但可以互换用作它们实现的接口类型的参数，因为这两个类都承诺满足接口定义的服务集。接口不提供实现细节。

抽象类定义了它的子类的基本结构，以及可选的部分实现。抽象类以垂直但定向的方式提供多态性，因为任何继承抽象类的类都可以被视为该抽象类的实例，但不能反过来。抽象类可以并且经常确实包含实现细节，但不能自行实例化 - 只有它们的子类可以“更新”。

请注意，C# 也允许接口继承。

* * *

## 回答 #20

> 赞同：10
> 
> 时间：2014-04-08T12:07:21.787

大多数答案都集中在抽象类和接口之间的*技术差异*上，但由于从技术上讲，接口基本上是一种抽象类（没有任何数据或实现），我认为**概念上**的差异要有趣得多，这可能是什么面试官在后面。

一个**接口**是一个**协议**。它指定：“这就是我们彼此交谈的方式”。它不能有任何实现，因为它不*应该*有任何实现。这是一份合同。就像`.h`C 中的头文件一样。

**抽象类**是不完整的**实现**。一个类可能实现也可能不实现接口，抽象类不必完全实现它。没有任何实现的抽象类有点无用，但完全合法。

*基本上任何类，无论是否抽象，都与它是*什么有关，而接口则与*您如何使用它*有关。例如：`Animal`可能是一个抽象类，实现了一些基本的代谢功能，并指定了呼吸和运动的抽象方法而没有给出实现，因为它不知道它应该通过鳃或肺呼吸，以及它是否会飞、游泳、走路或爬行。`Mount`另一方面，它可能是一个接口，它指定你可以骑着动物，而不知道它是什么动物（或者根本不知道它是否是动物！）。

事实上，在幕后，接口基本上是一个只有抽象方法的抽象类，这并不重要。从概念上讲，他们扮演完全不同的角色。

* * *

## 回答 #21

> 赞同：10
> 
> 时间：2014-11-13T03:07:49.933

由于您可能已经从专家那里获得了理论知识，所以我不会在这里重复所有这些，而是​​让我用一个简单的例子来解释我们可以使用/不能使用`Interface`and `Abstract class`。

假设您正在设计一个应用程序来列出 Cars 的所有功能。在各个方面，您需要共同继承，因为 DigitalFuelMeter、空调、座椅调节等某些属性对于所有汽车都是通用的。同样，我们只需要对某些类进行继承，因为制动系统（ABS，EBD）等某些属性仅适用于某些汽车。

以下类作为所有汽车的基类：

```
public class Cars
{
    public string DigitalFuelMeter()
    {
        return "I have DigitalFuelMeter";
    }

    public string AirCondition()
    {
        return "I have AC";
    }

    public string SeatAdjust()
    {
        return "I can Adjust seat";
    }
} 
```

考虑我们为每个 Cars 设置一个单独的类。

```
public class Alto : Cars
{
    // Have all the features of Car class    
}

public class Verna : Cars
{
    // Have all the features of Car class + Car need to inherit ABS as the Braking technology feature which is not in Cars        
}

public class Cruze : Cars
{
    // Have all the features of Car class + Car need to inherit EBD as the Braking technology feature which is not in Cars        
} 
```

考虑到我们需要一种方法来继承 Verna 和 Cruze 的制动技术（不适用于 Alto）。虽然两者都使用制动技术，但“技术”是不同的。所以我们正在创建一个抽象类，其中方法将被声明为 Abstract 并且应该在其子类中实现。

```
public abstract class Brake
{
    public abstract string GetBrakeTechnology();
} 
```

现在我们尝试从这个抽象类继承，制动系统的类型在 Verna 和 Cruze 中实现：

```
public class Verna : Cars,Brake
{
    public override string GetBrakeTechnology()
    {
        return "I use ABS system for braking";
    }       
}

public class Cruze : Cars,Brake
{
    public override string GetBrakeTechnology()
    {
       return "I use EBD system for braking";
    }         
} 
```

看到上面两个类的问题了吗？它们继承自多个 C#.Net 不允许的类，即使该方法是在子级中实现的。这就需要接口了。

```
interface IBrakeTechnology
{
    string GetBrakeTechnology();
} 
```

实现如下：

```
public class Verna : Cars, IBrakeTechnology
{
    public string GetBrakeTechnology()
    {
        return "I use ABS system for braking";
    }
}

public class Cruze : Cars, IBrakeTechnology
{
   public string GetBrakeTechnology()
   {
       return "I use EBD system for braking";
   }        
} 
```

现在 Verna 和 Cruze 可以在 Interface 的帮助下，用自己的制动技术实现多重继承。

* * *

## 回答 #22

> 赞同：9
> 
> 时间：2010-01-19T05:48:26.553

接口是执行特定行为的轻量级方式。这是一种思考方式。

* * *

## 回答 #23

> 赞同：7
> 
> 时间：2009-04-17T16:50:06.430

1）一个接口可以看成一个纯抽象类，是一样的，但是尽管如此，实现一个接口和从一个抽象类继承是不一样的。当你从这个纯抽象类继承时，你定义了一个层次结构 -> 继承，如果你实现了你没有实现的接口，你可以实现任意数量的接口，但你只能从一个类继承。

2）您可以在接口中定义属性，因此实现该接口的类必须具有该属性。

例如：

```
 public interface IVariable
  {
      string name {get; set;}
  } 
```

实现该接口的类必须具有这样的属性。

* * *

## 回答 #24

> 赞同：7
> 
> 时间：2012-08-25T22:22:47.577

虽然这个问题已经很老了，但我想补充一点支持接口：

可以使用任何依赖注入工具注入接口，而抽象类注入很少支持。

* * *

## 回答 #25

> 赞同：7
> 
> 时间：2020-03-03T16:26:13.197

tl;博士; 当您看到“Is A”关系时，请使用继承/抽象类。当你看到“有”关系时，创建成员变量。当您看到“依赖于外部提供者”时，实现（而不是继承）一个接口。

面试题：接口和抽象类有什么区别？你如何决定何时使用什么？我大多得到以下一个或全部答案： 答案 1：您不能创建抽象类和接口的对象。

ZK（那是我的姓名缩写）：你不能创建任何一个对象。所以这没有区别。这是接口和抽象类之间的相似之处。反问：为什么不能创建抽象类或接口的对象？

答案 2：抽象类可以有一个函数体作为部分/默认实现。

ZK：反问：所以如果我把它改成一个纯抽象类，把所有的虚函数都标记为抽象，并且不为任何虚函数提供默认实现。那会使抽象类和接口相同吗？之后它们可以互换使用吗？

答案 3：接口允许多重继承，而抽象类不允许。

ZK：反问：你真的继承自一个接口吗？还是您只是实现一个接口并从抽象类继承？实现和继承有什么区别？这些反题让候选人望而却步，让大多数人摸不着头脑，或者直接跳到下一个问题。这让我觉得人们在面向对象编程的这些基本构建块方面需要帮助。原始问题和所有反问题的答案都可以在英语和 UML 中找到。您必须至少了解以下内容才能更好地理解这两个结构。

普通名词：普通名词是给同一类或同类事物“共同”的名称。例如水果、动物、城市、汽车等。

专有名词：专有名词是物体、地点或事物的名称。苹果、猫、纽约、本田雅阁等。

汽车是普通名词。而本田雅阁是一个专有名词，可能是一个复合专有名词，一个由两个名词组成的专有名词。

来到 UML 部分。您应该熟悉以下关系：

*   是一个
*   有一个
*   用途

让我们考虑以下两句话。- 本田雅阁是汽车吗？- 本田雅阁有车吗？

哪一个听起来正确？简单的英语和理解力。HondaAccord 和 Cars 共享“Is A”关系。本田雅阁没有汽车。这是辆车。本田雅阁“有一个”音乐播放器。

当两个实体共享“Is A”关系时，它是更好的继承候选者。并且有一个关系是创建成员变量的更好候选者。有了这个，我们的代码看起来像这样：

```
abstract class Car
{
   string color;
   int speed;
}
class HondaAccord : Car
{
   MusicPlayer musicPlayer;
} 
```

现在本田不生产音乐播放器。或者至少这不是他们的主要业务。

所以他们联系其他公司并签订合同。如果您在此处接收电源并在这两条线上接收输出信号，它将在这些扬声器上正常播放。

这使得音乐播放器成为界面的完美候选者。只要连接工作正常，您不在乎谁为其提供支持。

您可以用索尼或其他方式替换 LG 的 MusicPlayer。它不会改变本田雅阁的任何事情。

为什么不能创建抽象类的对象？

因为你不能走进陈列室说给我一辆车。你必须提供一个专有名词。什么车？可能是本田雅阁。那时销售代理可以为您提供一些东西。

为什么不能创建接口的对象？因为你不能走进陈列室说给我一份音乐播放器的合同。它不会有帮助。接口位于消费者和提供者之间，只是为了促进达成协议。您将如何处理该协议的副本？它不会播放音乐。

为什么接口允许多重继承？

接口不被继承。实现了接口。接口是与外部世界交互的候选者。本田雅阁有一个加油接口。它有给轮胎充气的接口。还有用来给足球充气的软管。所以新代码如下所示：

```
abstract class Car
{
    string color;
    int speed;
}
class HondaAccord : Car, IInflateAir, IRefueling
{
    MusicPlayer musicPlayer;
} 
```

并且英文会这样写“Honda Accord is a Car 支持充气轮胎和加油”。

* * *

## 回答 #26

> 赞同：6
> 
> 时间：2009-04-17T16:48:49.053

从[我的另一个答案](https://stackoverflow.com/questions/268698/inheritance-and-interfaces/268721#268721)，主要处理何时使用一个与另一个：

> 根据我的经验，当您有多个类，每个类都需要响应相同的方法或方法时，最好使用接口，以便它们可以被其他代码互换使用，这些代码将针对这些类的公共接口编写。接口的最佳用途是当协议很重要但每个类的底层逻辑可能不同时。如果您要复制逻辑，请考虑使用抽象类或标准类继承。

* * *

## 回答 #27

> 赞同：6
> 
> 时间：2009-10-05T12:03:08.913

回答第二个问题：默认情况下`public`定义的变量`interface`是，而类中的变量是实例变量。`static final``public``abstract`

* * *

## 回答 #28

> 赞同：6
> 
> 时间：2014-08-29T23:29:10.683

**接口类型与抽象基类**

改编自[Pro C# 5.0 和 .NET 4.5 Framework](http://www.apress.com/9781430242338)书。

接口类型可能看起来非常类似于抽象基类。回想一下，当一个类被标记为抽象时，它可以定义任意数量的抽象成员来为所有派生类型提供多态接口。然而，即使一个类确实定义了一组抽象成员，它也可以自由定义任意数量的构造函数、字段数据、非抽象成员（带有实现）等等。另一方面，接口只包含抽象成员定义。由抽象父类建立的多态接口受到一个主要限制，即只有派生类型支持抽象父类定义的成员。但是，在较大的软件系统中，开发多个类层次结构非常常见，这些层次结构除了 System.Object 之外没有共同的父级。鉴于抽象基类中的抽象成员仅适用于派生类型，我们无法配置不同层次结构中的类型以支持相同的多态接口。例如，假设您定义了以下抽象类：

```
public abstract class CloneableType
{
// Only derived types can support this
// "polymorphic interface." Classes in other
// hierarchies have no access to this abstract
// member.
   public abstract object Clone();
} 
```

鉴于此定义，只有扩展 CloneableType 的成员才能支持 Clone() 方法。如果您创建一组不扩展此基类的新类，则无法获得此多态接口。此外，您可能还记得 C# 不支持类的多重继承。因此，如果您想创建一个既是 Car 又是 CloneableType 的 MiniVan，您无法这样做：

```
// Nope! Multiple inheritance is not possible in C#
// for classes.
public class MiniVan : Car, CloneableType
{
} 
```

正如您所猜测的那样，接口类型来拯救。定义接口后，它可以由任何类或结构、任何层次结构、任何命名空间或任何程序集（用任何 .NET 编程语言编写）实现。如您所见，接口是高度多态的。考虑在 System 命名空间中定义的名为 ICloneable 的标准 .NET 接口。该接口定义了一个名为 Clone() 的方法：

```
public interface ICloneable
{
object Clone();
} 
```

* * *

## 回答 #29

> 赞同：6
> 
> 时间：2016-01-05T04:29:44.450

当然，了解 OOP 中接口和抽象类的行为（以及语言如何处理它们）很重要，但我认为了解每个术语的确切含义也很重要。您能想象该`if`命令与该术语的含义不完全一致吗？此外，实际上某些语言正在减少，甚至更多，接口和抽象之间的差异......如果有一天这两个术语的操作几乎相同，至少您可以定义自己应该在哪里（以及为什么）它们中的任何一个用于。

如果您阅读一些字典和其他字体，您可能会发现同一术语的不同含义但有一些共同的定义。我认为我在[这个网站](http://dictionary.reference.com)上找到的这两个含义非常非常好并且合适。

界面：

> 使独立的、有时是不相容的元素能够有效协调的事物或情况。

抽象的：

> 某种东西，它本身集中了任何更广泛或更普遍的东西或几样东西的基本品质；本质。

例子：

你买了一辆车，它需要燃料。

[![在此处输入图像描述](https://i.stack.imgur.com/2zvSS.png)](https://i.stack.imgur.com/2zvSS.png)

您的汽车模型是`XYZ`，属于类型`ABC`，所以它是一辆具体的汽车，是汽车的具体实例。汽车不是真实的物体。实际上，它是创建特定对象的一组抽象标准（质量）。简而言之，Car 是一个**抽象类**，它是*“在自身中集中了任何更广泛或更一般事物的本质品质的东西”*。

应使用唯一符合汽车手册规格的燃料来填充汽车油箱。实际上，没有什么可以限制您添加任何燃料，但发动机只有使用指定的燃料才能正常工作，因此最好遵循其要求。要求说它接受与同类型的其他汽车一样`ABC`的标准燃料。

在面向对象的视图中，`ABC`不应该将流派的燃料声明为一个类，因为那里没有针对特定类型的汽车的具体燃料。尽管您的汽车可以接受抽象类 Fuel 或 VehicularFuel，但您必须记住，您只有一些现有的车辆燃料符合规范，即那些实现汽车手册中要求的燃料。简而言之，他们应该实现**接口** `ABCGenreFuel`，*“……使单独的、有时不兼容的元素能够有效地协调”*。

### 附录

另外，我认为您应该记住术语类的含义，即（来自前面提到的同一站点）：

班级：

> 由于共同的属性、特征、品质或特征而被视为组成一个群体的若干人或事物；种类;

这样，一个类（或抽象类）不应该只代表公共属性（如接口），而是某种具有公共属性的组。接口不需要代表一种。它必须代表共同的属性。这样，我认为类和抽象类可以用来表示不应该经常改变其方面的事物，比如人类是哺乳动物，因为它代表了一些种类。种类不应该经常改变自己。

* * *

## 回答 #30

> 赞同：5
> 
> 时间：2014-02-21T01:25:55.220

从编码的角度

如果抽象类只有抽象方法，则接口可以替换抽象类。否则将抽象类更改为接口意味着您将失去继承提供的代码可重用性。

从设计角度

如果它是“是”关系并且您需要一个子集或所有功能，请将其保留为抽象类。如果它是“应该做”的关系，请将其保留为接口。

决定你需要什么：只是策略执行，或代码可重用性和策略。

* * *

## 回答 #31

> 赞同：3
> 
> 时间：2010-05-12T22:10:56.237

其他几个区别：

抽象类可以具有静态方法、属性、字段等，而运算符、接口则不能。Cast 运算符允许转换为抽象类或从抽象类转换，但不允许转换为接口或从接口转换。

因此，您几乎可以单独使用抽象类，即使它从未实现（通过其静态成员）并且您不能以任何方式单独使用接口。

* * *

## 回答 #32

> 赞同：3
> 
> 时间：2013-09-12T15:22:47.317

`Interface:-`== 契约。无论哪个类实现它都必须遵循接口的所有规范。

一个实时示例是任何`ISO`标记的产品。`ISO`给出了`rules/specification`关于产品应该如何构建以及`minimum set of features`它`Must`有什么的集合。

这不过是`subset of properties`产品必须拥有。ISO 将对产品进行签名`only if it satisfies the its standards`。

现在看看这段代码

```
public interface IClock{       //defines a minimum set of specification which a clock should have

    public abstract Date getTime();
    public abstract int getDate();
}
public class Fasttrack: Clock {
    // Must have getTime() and getTime() as it implements IClock
    // It also can have other set of feature like 
    public void startBackgroundLight() {
        // watch with internal light in it.
    }
    .... //Fastrack can support other feature as well
    ....
    ....
} 
```

这里 a`Fastrack`被称为 watch 因为`it has all that features that a watch must suppost`（**最小特征集**）。

**为什么和何时抽象：**

***来自 MSDN：***

an 的目的`abstract class`是提供`common definition of a base class`多个派生类可以共享的 a。

例如，类库可以定义一个抽象类，用作其许多函数的参数，并要求使用该库的程序员通过创建派生类来提供他们自己的类实现。`Abstract simply means if you cannot define it completely declare it as an abstract`.实现类将完成这个实现。

例如-：假设我将一个类声明`Recipe`为abstract，但我不知道要制作哪个菜谱。然后我将概括这个类来定义。菜谱的`common definition of any recipe`植入**将取决于实现菜。**

抽象类可以由抽象方法组成，也可以由非抽象方法组成，所以你可以注意到接口的区别。所以不一定你的实现类必须有每个方法。你只需要重写抽象方法。

用简单的话如果你想要`tight coupling use Interface o/w use in case of lose coupling Abstract Class`

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2017-04-07T13:25:29.870

除了比较之外，比较`Abstract class`是`Interface`有意义`Abstract class`的`Concrete class`。

使用抽象类，就像使用具体类一样，**只是**在您**不希望/不能在**不扩展的情况下实例化它们的时候除外。并制作您不想要/无法实现抽象方法的方法。

如果您喜欢类比，可以将 chromium 视为一个抽象类（不能将其用作浏览器，因此无法实例化），将 chrome 和 opera 视为从 chromium 派生的具体类，将浏览器附加结构视为接口。

* * *

## 回答 #34

> 赞同：1
> 
> 时间：2018-05-07T06:26:27.237

抽象类处理有效地打包类功能，而接口用于意图/合同/通信，并且应该与其他类/模块共享。

使用抽象类作为合同和（部分）合同实施者违反了 SRP。使用抽象类作为契约（依赖）限制了创建多个抽象类以获得更好的可重用性。

在下面的示例中，使用抽象类作为 OrderManager 的合同会产生问题，因为我们有两种不同的处理订单的方式 - 基于客户类型和类别（客户可以是直接或间接或黄金或白银）。因此接口用于合同，抽象类用于不同的工作流执行

```
public interface IOrderProcessor
{
    bool Process(string orderNumber);
}

public abstract class CustomerTypeOrderProcessor: IOrderProcessor
{
    public bool Process(string orderNumber) => IsValid(orderNumber) ? ProcessOrder(orderNumber) : false;

    protected abstract bool ProcessOrder(string orderNumber);

    protected abstract bool IsValid(string orderNumber);
}

public class DirectCustomerOrderProcessor : CustomerTypeOrderProcessor
{
    protected override bool IsValid(string orderNumber) => string.IsNullOrEmpty(orderNumber); 

    protected override bool ProcessOrder(string orderNumber) => true; 
}

public class InDirectCustomerOrderProcessor : CustomerTypeOrderProcessor
{
    protected override bool IsValid(string orderNumber) => orderNumber.StartsWith("EX");

    protected override bool ProcessOrder(string orderNumber) => true;
}

public abstract class CustomerCategoryOrderProcessor : IOrderProcessor
{
    public bool Process(string orderNumber) => ProcessOrder(GetDiscountPercentile(orderNumber), orderNumber);

    protected abstract int GetDiscountPercentile(string orderNumber);

    protected abstract bool ProcessOrder(int discount, string orderNumber);
}

public class GoldCustomer : CustomerCategoryOrderProcessor
{
    protected override int GetDiscountPercentile(string orderNumber) => 15;

    protected override bool ProcessOrder(int discount, string orderNumber) => true;

}

public class SilverCustomer : CustomerCategoryOrderProcessor
{
    protected override int GetDiscountPercentile(string orderNumber) => 10;

    protected override bool ProcessOrder(int discount, string orderNumber) => true;

}

public class OrderManager
{
    private readonly IOrderProcessor _orderProcessor;// Not CustomerTypeOrderProcessor or CustomerCategoryOrderProcessor 

    //Using abstract class here would create problem as we have two different abstract classes
    public OrderManager(IOrderProcessor orderProcessor) => _orderProcessor = orderProcessor;
} 
```

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2018-08-01T11:20:41.027

界面：

> 不包含实现接口可以从多个接口继承（支持多重继承）成员自动公共可能包含属性、方法、事件和索引器

抽象类：

> 可能/可能不包含实现；至少一名成员不会被执行。一个类可以继承自一个基类；不允许多重继承。成员具有访问修饰符 可能包含字段、属性、构造函数、析构函数、方法、事件和索引器

这些是抽象类和接口之间的主要区别。

# mysql - 数据库性能调整有哪些资源？

> ID：761204
> 
> 赞同：214
> 
> 时间：2009-04-17T16:45:17.097
> 
> 标签：mysql, sql-server, database, oracle, postgresql

有哪些好的资源可以帮助您了解主要引擎上的数据库调优并提升您在该领域的知识？

这个问题的想法是收集始终存在的资源的卸载负载，以便人们可以对良好的、同行认可的资源进行“一站式”知识商店。

* * *

**通用 SQL**

*   [书籍：SQL 性能调优](http://books.google.com/books?id=3H9CC54qYeEC&dq=sql+performance+tuning&printsec=frontcover&source=bn&hl=en&ei=1dDoSYmjMOrlnQfX-bSYBw&sa=X&oi=book_result&ct=result&resnum=4)
*   [书籍：SQL 调优](http://books.google.com/books?id=pKXF7UU0gBYC&printsec=frontcover&dq=sql%2Btuning)
*   [书籍：SQL的艺术](https://rads.stackoverflow.com/amzn/click/com/0596008945)
*   [书籍：重构 SQL 应用程序](http://books.google.com/books?id=gjyd3IOrwz4C&lpg=PP1&dq=refactoring%20sql%20applications&pg=PP1#v=onepage&q&f=false)
*   [书籍：数据库调优：原理、实验和故障排除技术](http://books.google.com/books?id=1CJdgVO8PwAC&lpg=PR21&dq=database%20tuning%20principles&pg=PP1#v=onepage&q&f=false)
*   [使用索引，卢克！- 开发人员数据库性能指南](http://Use-The-Index-Luke.com/)

**PostgreSQL** ([维基](http://wiki.postgresql.org/)) ( [PGsearch](http://www.pgsql.ru/db/pgsearch/) )

*   [性能优化](http://wiki.postgresql.org/wiki/Performance_Optimization)
*   [快速 PostgreSQL 优化](http://www.mohawksoft.org/?q=node/56)
*   [解释 分析 解释器](http://explain.depesz.com/)
*   [PostgreSQL 性能提示](http://www.postgresql.org/docs/current/static/performance-tips.html)
*   [书籍：PostgreSQL 9.0 高性能](https://www.packtpub.com/postgresql-90-high-performance/book)

**MySQL**

*   [MySQL的隐藏特性](https://stackoverflow.com/questions/368858/hidden-features-of-mysql)
*   [书籍：高性能 MySQL](http://oreilly.com/catalog/9780596101718/) /[博客：高性能 MySQL](http://www.mysqlperformanceblog.com/)
*   [博客：Xaprb（适用于 MySQL DBA）](http://www.xaprb.com/blog/)

**甲骨文**

*   [如何在 StackOverflow 上询问 Oracle 调优问题](https://stackoverflow.com/a/34975420/146325)
*   [你如何解释查询的解释计划？](https://stackoverflow.com/questions/79266/how-do-you-interpret-a-querys-explain-plan)
*   [Oracle 高级调优脚本](http://www.ixora.com.au/scripts/)
*   [Oracle 数据库性能调优指南](http://download.oracle.com/docs/cd/B28359_01/server.111/b28274/toc.htm)
*   [问汤姆](http://asktom.oracle.com)
*   [Oracle 数据库 SQL 参考](http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/toc.htm)
*   [书籍：了解 Oracle 性能](http://www.amazon.ca/Troubleshooting-Oracle-Performance-Christian-Antognini/dp/1590599179)
*   [书籍：优化 Oracle 性能](https://rads.stackoverflow.com/amzn/click/com/059600527X)
*   [书籍：Oracle 性能故障排除](https://rads.stackoverflow.com/amzn/click/com/1590599179)
*   [书籍：基于成本的 Oracle 基础知识](https://rads.stackoverflow.com/amzn/click/com/1590596366)

**微软 SQL 服务器**

*   [SQL Server 性能](http://www.sql-server-performance.com/index.aspx)
*   [电子书：高性能 SQL Server](http://downloads.red-gate.com/ebooks/HighPerformanceSQL_ebook.zip)
*   [SO 问题：最好的 SQL Server 性能优化技术是什么？](https://stackoverflow.com/questions/103423/what-are-the-best-sql-server-performance-optimization-techniques)
*   [Brent Ozar 的性能调整页面](http://www.brentozar.com/sql-server-performance-tuning/)
*   [SqlServerPedia 的性能调优页面](http://www.toadworld.com/platforms/sql-server/w/wiki/9805.performance-tuning.aspx)
*   [书籍：Sql Server 2008 内部知识](https://rads.stackoverflow.com/amzn/click/com/0735626243)
*   [如何使用 SQL Profiler 识别运行缓慢的查询](http://www.simple-talk.com/sql/performance/how-to-identify-slow-running-queries-with-sql-profiler/)

**Sybase SQL 无处不在**

*   [博客：SQL Anywhere](http://sqlanywhere.blogspot.com/)
*   [书籍：SQL Anywhere Studio 9 开发人员指南](https://rads.stackoverflow.com/amzn/click/com/1556225067)

**JDBC**

*   [JDBC 性能提示](http://www.javaperformancetuning.com/tips/jdbc.shtml)

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-04-24T19:17:38.330

Oracle 自己的 Tom Kyte 在[http://asktom.oracle.com](http://asktom.oracle.com)上有一个非常棒的存储库，可以解决各种可以想象的性能问题。他通常会花时间重现具体问题并给出非常详细的解释。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-04-17T16:57:00.453

这家伙对一个不一样的询问的回答可能是一个好的开始。

[MySQL的隐藏特性](https://stackoverflow.com/questions/368858/hidden-features-of-mysql/600830#600830)

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-04-17T19:04:04.347

还有一些 PostgreSQL 的东西：官方[wiki上的](http://wiki.postgresql.org/)[“性能优化”](http://wiki.postgresql.org/wiki/Performance_Optimization)。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-04-23T19:21:14.757

如果您使用的是 Oracle 数据库，本指南也可能会有所帮助。 [http://download.oracle.com/docs/cd/B28359_01/server.111/b28274/toc.htm](http://download.oracle.com/docs/cd/B28359_01/server.111/b28274/toc.htm)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-04-17T18:53:55.477

对于 MySQL，性能调优的“圣经”是[高性能 MySQL](http://oreilly.com/catalog/9780596101718/)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-04-23T00:58:23.000

[快速 PostgreSQL 优化](http://www.mohawksoft.org/?q=node/56)（查询优化）

简短的阅读，很好地解释了很多事情，并且“有效”了一个真实的例子，这对我们这些以这种方式学得更好的人来说很好。

在看到 PostgreSQL 的 wiki 链接后，我想我会用[mysql](http://dev.mysql.com/doc/) / [oracle](http://www.oracle.com/technology/documentation/index.html)文档的链接来编辑这篇文章，这并不是专门的优化指南，但两者都是很好的资源，尤其是 mysql 的。用于优化和任何其他调整功能。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-17T16:47:16.607

所以这里有一个很好的：[你如何解释查询的解释计划？](https://stackoverflow.com/questions/79266/how-do-you-interpret-a-querys-explain-plan)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-04-26T07:20:34.417

我要补充一点，除了理论上调整您的数据库之外，您还应该使用跟踪 SQL 调用的分析器来分析您的应用程序。

尽管您的意图是最好的，但一些错误的调用会潜入您的应用程序，并且通常会导致 90% 的性能相关问题。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-04-20T22:04:30.643

可以在[http://www.mysqlperformanceblog.com/找到很多好的 MySQL 特定技巧](http://www.mysqlperformanceblog.com/)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-04-27T05:43:37.760

*   书籍：Oracle 性能故障排除 (Antognini Christian)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-04-17T18:53:45.650

如果您正在寻找特定于 SQL Server 的性能调优参考，那么在线提供的质量资源绝对可以减少，从有关实现特定技术（如分区）的白皮书到优秀的博客，其中详细介绍了如何进行性能调优的分步说明。 sql 服务器平台。

无耻插件如下：您可以通过查看我个人博客的性能调整区域来开始您的研究，或者对于任何特定的 SQL Server 要求/问题，请随时向我发送电子邮件。

[SQL Server 资源](http://www.johnsansom.com)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-04-20T13:39:42.930

[SQL Server Performance](http://www.sql-server-performance.com/index.aspx) 提供 MSSQL 特定信息的体面站点。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-04-27T09:12:06.247

## [http://explain.depesz.com/](http://explain.depesz.com/)

*   帮助您解释**PostgreSQL**的[EXPLAIN ANALYZE](http://www.postgresql.org/docs/current/static/using-explain)输出。

PostgreSQL 文档中的整个[性能提示](http://www.postgresql.org/docs/current/static/performance-tips.html)一章都值得一读。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-09-25T16:30:20.647

[How to identify Slow Running Queries with SQL Profiler](http://www.simple-talk.com/sql/performance/how-to-identify-slow-running-queries-with-sql-profiler/)是一个很好的教程，介绍了如何识别运行缓慢的查询。这将使人们能够将注意力集中在最需要的地方。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-04-17T18:57:25.140

“SQL 性能调优” [http://books.google.com/books?id=3H9CC54qYeEC&dq=sql+performance+tuning&printsec=frontcover&source=bn&hl=en&ei=1dDoSYmjMOrlnQfX-bSYBw&sa=X&oi=book_result&ct=result&resnum=4](http://books.google.com/books?id=3H9CC54qYeEC&dq=sql+performance+tuning&printsec=frontcover&source=bn&hl=en&ei=1dDoSYmjMOrlnQfX-bSYBw&sa=X&oi=book_result&ct=result&resnum=4)涵盖了大多数主要 DBMS -- 如何编写高性能的跨平台 SQL 查询等。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-04-23T12:55:41.717

[http://www.javaperformancetuning.com/tips/jdbc.shtml](http://www.javaperformancetuning.com/tips/jdbc.shtml)
[http://www.google.com/search?q=database+performance+tuning](http://www.google.com/search?q=database+performance+tuning)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-04-20T22:15:35.343

[Xaprb](http://www.xaprb.com/blog/)是 MySQL DBA 的必读博客。作者写了一本关于[高性能 MySQL的书](https://rads.stackoverflow.com/amzn/click/com/0596101716)

对于使用 Sybase SQL Anywhere 的少数人来说，我只能推荐[Breck Carter 的博客](http://sqlanywhere.blogspot.com/)和他的[SQL Anywhere Studio 9 开发人员指南](https://rads.stackoverflow.com/amzn/click/com/1556225067)

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-04-23T19:19:02.390

这是另一本平台中立的备受推崇的书籍：

Dan Tow 的[SQL 调优：生成最佳执行计划](http://books.google.com/books?id=pKXF7UU0gBYC&printsec=frontcover&dq=sql%2Btuning)

包含一些针对 Oracle、MS SQL 和 IBM DB2 的特定示例，但所涉及的技术也应该适用于其他平台。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-04-24T18:07:29.933

对于 SQL Server，我主要使用：

*   [Brent Ozar 的性能调整页面](http://www.brentozar.com/sql-server-performance-tuning/)

*   [SqlServerPedia 的性能调优页面](http://sqlserverpedia.com/wiki/Performance_Tuning)

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-07-27T23:05:08.023

当我看到这种快速查看您在 Oracle 下调整的 SQL 语句发生了什么的方式时，我非常高兴。将下面的第一个 SQL 语句更改为您的 SELECT 语句并将该提示保留在那里。

```
SELECT /*+ GATHER_PLAN_STATISTICS */ * FROM DUAL;

SELECT * FROM TABLE(dbms_xplan.display_cursor( NULL, NULL, 'RUNSTATS_LAST'))
;

PLAN_TABLE_OUTPUT
-----------------------------------------------------
SQL_ID  5z36y0tq909a8, child number 0
-------------------------------------
SELECT /*+ GATHER_PLAN_STATISTICS */ * FROM DUAL

Plan hash value: 272002086

---------------------------------------------------------------------------------------------
| Id  | Operation         | Name | Starts | E-Rows | A-Rows |   A-Time   | Buffers | Reads  |
---------------------------------------------------------------------------------------------
|   1 |  TABLE ACCESS FULL| DUAL |      1 |      1 |      1 |00:00:00.02 |       3 |      2 |
---------------------------------------------------------------------------------------------

12 rows selected. 
```

在哪里：

*   E-Rows 是估计的行数。
*   A-Rows 是实际的行。
*   A-Time 是实际时间。
*   缓冲区是实际的缓冲区。

如果估计的计划与实际执行相差几个数量级，你就知道你遇到了问题。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2014-02-12T07:27:32.013

甲骨文网站

1.  2 天性能调优指南[http://docs.oracle.com/cd/E11882_01/server.112/e10822/toc.htm](http://docs.oracle.com/cd/E11882_01/server.112/e10822/toc.htm)
2.  性能调优指南[http://docs.oracle.com/cd/E36909_01/server.1111/e16638/toc.htm](http://docs.oracle.com/cd/E36909_01/server.1111/e16638/toc.htm)

甲骨文书籍

1.  Oracle Core：面向 DBA 和开发人员的基本内部知识，Jonathan Lewis
2.  专家级 Oracle 数据库架构：Oracle 数据库 9i、10g 和 11g 编程技术和解决方案，Thomas Kyte
3.  Dan Tow 的 SQL 调优
4.  Oracle 数据库 11g 第 2 版性能调优技巧和技术（Oracle 出版社）作者：Richard Niemiec

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2010-07-05T13:42:11.490

对于 Oracle，[基于成本的 Oracle：](http://www.jlcomp.demon.co.uk/cbo_book/ind_book.html)[Jonathan Lewis](http://jonathanlewis.wordpress.com/)的基础知识。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-05-09T04:38:15.640

我首先要了解数据库是如何在基本层面上工作的。数据如何存储在磁盘上，创建索引做什么，查询计划优化如何工作，计划如何缓存，缓存计划何时到期。

如果您可以记住所有这些，那么大多数关于调优的建议似乎都是显而易见的。

这是一本适用于 MSSQL 的好书

[SQL Server 内部结构](https://rads.stackoverflow.com/amzn/click/com/0735626243)

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2009-04-27T07:49:23.623

对于使用 Oracle 的人，我推荐这个链接............

[http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/toc.htm](http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/toc.htm)

根据我在 Oracle 数据库开发方面的经验，我发现建立关于如何使用 SQL、它如何工作以及知道什么是可用的知识（提供的函数、您不知道存在或从上一个版本增强的子句）意味着我花在调整 sql 上的时间少了很多。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2011-02-28T18:15:33.640

有时您需要知道一旦发现问题后如何解决。这将展示用基于集合的操作替换表现不佳的游标的方法： [http ://wiki.lessthandot.com/index.php/Cursors_and_How_to_Avoid_Them](http://wiki.lessthandot.com/index.php/Cursors_and_How_to_Avoid_Them)

它特定于 SQL Server，但许多技术也可能转换为其他数据库。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2012-10-18T07:54:21.130

对于 Microsoft SQL，我推荐 Kalen Delaney (et al) 的书，名为“Inside SQL Server”。它们提供了对 SQL Server 内部的深入了解，从而使读者能够了解为什么特定语句可能比其他语句更快。

[SQL Server 7.0](https://rads.stackoverflow.com/amzn/click/com/0735605173)
[内部 SQL Server 2000](https://rads.stackoverflow.com/amzn/click/com/0735609985)
[内部 Microsoft SQL Server 2005](https://rads.stackoverflow.com/amzn/click/com/0735621969)
[内部 Microsoft SQL Server 2008 内部结构](https://rads.stackoverflow.com/amzn/click/com/0735626243)

还有一本书专门介绍 SQL Server 2008 查询的性能调优： [SQL Server Performance Tuning Distilled](https://rads.stackoverflow.com/amzn/click/com/1430219025)

我也喜欢 SQLSkills.com 上 Paul Randal 和 Kimberly Tripp 的博客。它们充满了可靠的 SQL 建议：

[Paul 的博客](http://www.sqlskills.com/blogs/paul/)
[Kimberly 的博客](http://www.sqlskills.com/blogs/kimberly/)

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2013-09-23T12:46:24.627

对于 SQL Server 性能调优，Itzik Ben-Gan 堪称传奇。

您可以在这里找到他的许多详细书籍，所有这些都以他惯用的经验测量风格来证明他的情况：[http ://tsql.solidq.com/books/index.htm](http://tsql.solidq.com/books/index.htm)

如果您正在寻找 t-sql 问题的最快解决方案，请在您的 google 搜索词中添加单词“itzik”。

Itzik Ben-Gan[在 stackoverflow 上被提及超过 600 次](https://www.google.co.uk/search?q=site%3astackoverflow.com+itzik+ben-gan)，但我不敢相信在这个性能调整问题上没有提到他。

作为附加资源，您还可以[在 youtube 上找到一些 Itzik 谈论性能相关内容](https://www.youtube.com/results?search_query=itzik%20ben-gan&oq=itzik%20ben-gan&gs_l=youtube.3...0.0.0.8225.0.0.0.0.0.0.0.0..0.0...0.0...1ac..11.youtube.)的视频。

# database-design - 如何处理数据库中没有枚举字段的枚举？

> ID：761211
> 
> 赞同：22
> 
> 时间：2009-04-17T16:46:38.810
> 
> 标签：database-design, enums

如何在不支持枚举的数据库中实现枚举字段？（即 SQLite）

需要使用“ `field`=？”轻松搜索这些字段 所以使用任何类型的数据序列化都是一个坏主意。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-04-17T17:19:23.240

**使用查找表**的外键是我使用的方法。事实上，即使我使用支持 ENUM 的数据库（例如 MySQL），我也会使用它。

为简单起见，我可能会跳过`id`查找表中一直存在的“”，而只使用主表中我需要的实际值作为查找表的主键。这样你就不需要加入来获得价值。

```
CREATE TABLE BugStatus (
  status            VARCHAR(20) PRIMARY KEY
);

INSERT INTO BugStatus (status) VALUES ('NEW'), ('OPEN'), ('FIXED');

CREATE TABLE Bugs (
  bug_id            SERIAL PRIMARY KEY,
  summary           VARCHAR(80),
  ...
  status            VARCHAR(20) NOT NULL DEFAULT 'NEW',
  FOREIGN KEY (status) REFERENCES BugStatus(status)
); 
```

诚然，存储字符串比 MySQL 的实现占用更多的空间`ENUM`，但除非有问题的表有数百万行，否则几乎没有关系。

查找表的其他优点是您可以使用简单的`INSERT`或从列表中添加或删除值`DELETE`，而`ENUM`您必须使用`ALTER TABLE`重新定义列表。

还可以尝试查询 中的当前允许值列表`ENUM`，例如在用户界面中填充选择列表。这是一个很大的烦恼！使用查找表，很容易：`SELECT status from BugStatus`.

如果需要，您还可以将其他属性列添加到查找表中（例如，标记仅对管理员可用的选项）。在 中`ENUM`，您不能注释条目；它们只是简单的值。

除了查找表之外的另一种选择是使用**`CHECK`约束**（只要数据库支持它们——MySQL 直到版本 8.0.16 才支持 CHECK）：

```
CREATE TABLE Bugs (
  bug_id            SERIAL PRIMARY KEY,
  summary           VARCHAR(80),
  ...
  status            VARCHAR(20) NOT NULL
    CHECK (status IN ('NEW', 'OPEN', 'FIXED'))
); 
```

但是这种`CHECK`约束的使用具有与 相同的缺点`ENUM`：没有 很难更改值列表`ALTER TABLE`，难以查询允许值列表，难以注释值。

PS：SQL 中的相等比较运算符是单个`=`. 双`==`精度在 SQL 中没有意义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T17:15:03.437

为了限制可能的值，我将对包含枚举项的表使用外键。

如果您不想 JOIN 进行搜索，那么如果 JOINS 不是问题，则将键设为 varchar，然后将键设为 INT 并且不要加入，除非您需要在该字段上进行搜索。

请注意，将您的枚举放入数据库会排除编译时检查代码中的值（除非您在代码中复制枚举。）我发现这是一个很大的缺点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T17:10:03.510

你基本上有两个选择：

*   使用整数字段

*   使用 varchar 字段

我个人会提倡使用 varchars，因为如果你改变你的枚举，你不会破坏任何东西 + 字段是人类可读的，但是 int 也有一些优点，即性能（数据的大小是一个明显的例子）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T17:25:04.410

这是我最近做的

在我的休眠映射 POJO 中，我将成员的类型保留为字符串，它在数据库中是 VARCHAR。

这个设置器需要一个枚举 还有另一个设置器需要 String- 但这是私有的（或者您可以直接映射该字段 - 如果这是您喜欢的。）

现在，我使用 String 的事实是从所有方面封装的。对于应用程序的其余部分——我的域对象使用枚举。就数据库而言 - 我使用的是字符串。

如果我错过了你的问题 - 我很抱歉。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-02-11T13:08:31.280

如果您将 Spring JPA 2.1 或更高版本与 hibernate 一起使用，您可以实现自己的 AttributeConverter 并定义您的枚举如何映射到列值

```
@Converter(autoApply = true)
public class CategoryConverter implements AttributeConverter<Category, String> {

    @Override
    public String convertToDatabaseColumn(Category category) {
        if (category == null) {
            return null;
        }
        return category.getCode();
    }

    @Override
    public Category convertToEntityAttribute(String code) {
        if (code == null) {
            return null;
        }

        return Stream.of(Category.values())
          .filter(c -> c.getCode().equals(code))
          .findFirst()
          .orElseThrow(IllegalArgumentException::new);
    }
} 
```

请参阅[Persisting Enums in JPA](https://www.baeldung.com/jpa-persisting-enums-in-jpa)文章中的第 4 个解决方案。代码片段也来自那里。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-04-17T16:49:14.247

我会使用一个varchar。这不是您的选择吗？

# artificial-intelligence - 如何编写人工神经网络（井字游戏）？

> ID：761216
> 
> 赞同：21
> 
> 时间：2009-04-17T16:48:29.303
> 
> 标签：artificial-intelligence, neural-network, game-ai

我想使用人工神经网络玩井字游戏。我的网络配置如下：对于 9 个字段中的每一个，我使用 2 个输入神经元。所以我当然有 18 个输入神经元。对于每个字段，我有一个用于玩家 1 的输入神经元和一个用于玩家 2 的神经元。除此之外，我还有 1 个输出神经元用于评估当前棋盘位置。输出值越高，玩家 1 的位置越好。输出值越低，玩家 2 的位置越好。

但我的问题是：我如何编码那个神经网络？我的想法是使用 Array[1-18] 作为输入神经元。该数组的值是输入权重。我会使用循环遍历数组。每当有神经元被激活时，我都会将权重添加到输出值中。所以输出值是激活的输入神经元的权重之和：

```
Output = SUM(ActivatedInputNeurons) 
```

您认为这是对网络进行编程的好方法吗？你有更好的想法吗？

我希望你能帮助我。提前致谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-17T17:22:06.010

好吧，你有一个 18 个神经元的输入层和一个 1 个神经元的输出层。没关系。但是，您需要让您的神经网络有机会将输入关联起来。为此，您至少需要一个中间层。我建议在中间层使用 9 个神经元。每一个都应该连接到每个输入神经元，输出神经元应该连接到每个中间神经元。每个这样的连接都有一个权重，每个神经元都有一个激活级别。

然后，你遍历所有神经元，一次一层。输入层刚刚被板状态激活。对于所有其他神经元，您将遍历其所有各自的连接，并对连接的神经元的激活水平和连接权重的乘积求和。最后，您通过对该总和应用 sigmoid 函数来计算激活水平。

这就是工作原理。现在，您需要训练这个网络以获得更好的结果。有几种算法可以解决这个问题，你必须做一些谷歌搜索和阅读。最后，当结果不够快时，您可能需要调整神经元和层数。例如，您可以将输入层减少到 9 个神经元，并用 +1 表示 X 和 -1 表示 O 激活它们。也许添加另一个中间层会产生更好的结果，或者增加一层的神经元数量。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-17T16:59:51.210

我不太明白您希望如何从一个输出神经元中获得对电路板情况的有意义的总结。我会更多地考虑拥有：

```
 I I I             O O O
    I I I      x      O O O
    I I I             O O O
9 input neurons  9 output neurons 
```

在全连接网络中，即 81 个权重。然后训练输出神经元在那个位置上的相对期望。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-07-29T22:21:38.347

看看我的 Tic 项目。我已经用神经网络和遗传算法解决了这个问题。源代码是免费提供的。

[http://www.roncemer.com/tic-tac-toe-an-experiment-in-machine-learning](http://www.roncemer.com/tic-tac-toe-an-experiment-in-machine-learning)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-17T16:59:18.607

我认为您应该使用传递函数来实现“传统”[前馈 ANN](http://en.wikipedia.org/wiki/Feedforward_neural_network)，因为它允许您使用反向传播来训练它。这些代码通常以几行代码结束，如下所示：

```
SetupInputs();
for (l = 1 .. layers.count)
    for (i = 0 .. layers[l].count)
        sum = 0
        for (j = 0 .. layers[l-1].count)
            sum += layers[l-1][j] * weights[l-1][j]
        layers[l][i] = TransferFunction(sum) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-17T16:55:24.233

这是一个很好的 AI 编码入门项目，但提出一个完整的解决方案将是解决 SO 的重要途径。

与大多数软件一样，我建议使用面向对象的设计。例如：定义一个`Neuron`具有输入、权重和输出函数的类。然后，创建其中几个`Neuron`对象以构建您的网络。

[请参阅有关人工神经网络](http://en.wikipedia.org/wiki/Artificial_neural_network)的 wikipedia 文章以获得良好的起点。

祝你好运！听起来很有趣。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-17T16:56:22.420

添加权重后，您需要使用函数对总和进行归一化，如果您想允许负数，人们通常使用 TANH。

**编辑：**

这是我几年前研究的[一个 java 多层感知器实现。](https://jpicsort.dev.java.net/source/browse/jpicsort/src/evolutionary_nn/JavaMLP.java?rev=1.15&view=markup)这个用于跳棋，但输入较少，您也可以将其用于跳棋。

另外，你可能需要想办法教它赢，但那是另一个问题

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-17T16:59:00.027

这不是您问题的直接答案，但您应该查看以下框架/工具：[SNNS](http://www.ra.cs.uni-tuebingen.de/SNNS/)或其 Java 对应物[JavaNNS](http://www.ra.cs.uni-tuebingen.de/downloads/JavaNNS/)。我很确定在那里你会找到你的问题的答案。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-03-14T08:41:47.933

如果您使用 FANN 或 Neuroph 等神经网络库，您将节省时间。

编码输入的一种方法是使用 9 个输入神经元。输出也可以是 9 个神经元。我在其他回放中没有看到隐藏层的大小。我想您将使用具有传统 3 层的 MLP。隐藏层的大小始终是个谜。我会尝试 10 个隐藏的神经元。

如果传递函数是 sigmoid，您可以按如下方式对输入进行编码：

0.0 - O 玩家。

1.0 - X 播放器。

0.5 - 空。

ANN 的输出将是 9 个实数。在这种情况下，一些单元格将被占用。您可以搜索与空单​​元格对应的最高输出值。

# php - 为什么这个 PHP 迭代不起作用？

> ID：761220
> 
> 赞同：0
> 
> 时间：2009-04-17T16:49:06.697
> 
> 标签：php, iteration, concatenation

我想将 foreach 循环的结果变成一个字符串变量，我以后可以使用它（所以我不需要将 foreach 循环粘贴到任何地方）。我有这个：

```
foreach($pairs as $d=>$m) {
$orderedpairs .= "[".$d."],[".$m."]"+"<br />";
}
echo $orderedpairs; 
```

如果我用“echo”替换赋值运算符，它工作正常，所以循环没问题，我认为这只是有问题的变量赋值。谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-17T16:51:25.070

您有一个 + 用于连接。你需要 。

此外，您应该在循环之前将 $orderedpairs 定义为空字符串。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-17T16:52:47.843

加号导致您的连接失败 - 将其更改为`.`

*与其他人所说*的相反，变量的范围不是问题。您**可以在循环中声明它们并在循环之后访问它们**。PHP 变量的范围不像 Java、C# 和其他语言。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-17T17:05:25.427

在您的情况下，实际上不需要与运算符连接，您可以这样做：

```
$orderedpairs .= "[$d],[$m]<br />"; 
```

PHP 将用它们的值替换变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T16:52:03.693

$orderedpairs 是否在循环之前被声明为空字符串以实例化并将其带入范围？最后的 + 实际上也应该是 . ?

# opensocial - 最有用的 OpenSocial 教程和视频是什么？

> ID：761233
> 
> 赞同：-1
> 
> 时间：2009-04-17T16:51:37.503
> 
> 标签：opensocial

Google 和其他人创建了许多教程和视频，以帮助教育如何使用 Opensocial 构建应用程序以及了解容器架构。

粗略的搜索会产生大量信息。但是，我想知道存在哪些人们认为在展示如何创建 OpenSocial 应用程序方面脱颖而出的教程，尤其是那些具有最新且有趣的示例代码的教程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-23T17:51:39.133

Google I/O 的视频很棒。我去年参加了，发现这些课程非常有帮助。谷歌随后免费发布所有内容的事实令人惊叹。

这是社交轨道的链接：

[http://code.google.com/events/io/sessions.html#social](http://code.google.com/events/io/sessions.html#social)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T17:45:52.490

到目前为止，我已经阅读并使用了 Google 的教程——它们很有帮助。当然，您想在容器中播放 Flex SWF 的部分除外。我必须做很多挖掘才能做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-23T17:38:45.230

尝试：

[http://www.hi5networks.com/platform/wiki/SampleCode](http://www.hi5networks.com/platform/wiki/SampleCode) [http://incubator.apache.org/shindig/getting-started.html](http://incubator.apache.org/shindig/getting-started.html)

和

[http://wiki.opensocial.org/index.php?title=Articles_%26_Tutorials](http://wiki.opensocial.org/index.php?title=Articles_%26_Tutorials)

希望有帮助！:)

# c# - lambda 表达式和匿名方法之间的区别 - C#

> ID：761236
> 
> 赞同：10
> 
> 时间：2009-04-17T16:52:04.863
> 
> 标签：c#, .net

**重复：** [委托关键字与 lambda 表示法](https://stackoverflow.com/questions/299703/c-delegate-keyword-vs-lambda-notation)

我了解匿名方法可用于定义委托和编写内联函数。使用 Lambda 表达式与此有何不同？

我想我对何时使用什么有点困惑。

**编辑：另外，似乎要使用匿名或 lambdas，需要为该类型提供扩展方法？**

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-17T16:56:46.147

lambda 表达式只是匿名方法的快捷语法。匿名方法如下所示：

```
delegate(params) {method body} 
```

等效的 lambda 表达式如下所示：

```
params => method body 
```

简而言之，所有 lambda 表达式都是匿名方法，但也有可能有一个不是用 lambda 语法编写的匿名方法（如上面的第一个示例）。希望这有帮助！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-17T17:07:59.040

Lambda 表达式可以转换为表达式树，而匿名委托则不能。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-08-05T01:08:46.523

只有没有方法体的 lambda 表达式可以转换为表达式树

以下构造编译**：**

```
 Func<int> exp1 = () => 1;
            Func<int> exp2 = () => { return 1; };
            Func<int> exp3 = delegate { return 1; };
            Expression<Func<int>> exp4 = () => 1; 
```

并且以下**不**

```
Expression<Func<int>> exp5 = delegate { return 1; }; //no anonymous delegates
Expression<Func<int>> exp6 = () => { return 1; }; //or lambdas with block body 
```

因此，即使在不是很高级的水平上也存在差异（Jon Skeet 在这里指出了[病态差异示例](https://stackoverflow.com/questions/299703/c-delegate-keyword-vs-lambda-notation/299858#299858)）

另一个区别是，如果您不打算在方法主体中使用匿名委托，则可以创建没有参数列表的匿名委托，而使用 lambda，您始终必须提供参数。

以下两行说明了区别

```
Func<int, int, int, int, int> anonymous = delegate { return 1; };
Func<int, int, int, int, int> lambda = (param1, param2, param3, param4) => 1; 
```

你基本上做同样的事情，但匿名委托显然在这里看起来更好。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-17T16:52:54.503

不是真的没有。它们本质上是具有不同语法结构的完全相同的功能。不过，一般的转变似乎是从 C# 2.0 匿名方法语法转向匿名表达式和函数的 lambda 样式语法。

# java - Java 中声明式 GUI 编程的建议

> ID：761237
> 
> 赞同：55
> 
> 时间：2009-04-17T16:52:05.020
> 
> 标签：java, swing, user-interface, layout, declarative

我想知道是否对 Java 中的声明式 GUI 编程有任何建议。（我讨厌基于视觉的 GUI 创建器/编辑器软件，但对手动实例化 JPanels 和 Boxes 以及 JLabels 和 JLists 等有点厌倦了。）

这是我的总体问题，但对于我正在考虑采取的方法，我有两个具体问题：

1.  JavaFX：在JavaFX 中是否有一个真实的GUI 显示（例如，不是圆形和矩形，而是列表框、按钮和标签等）的示例，它可以与访问和更新各种元素的Java 源文件交互？

2.  Plain Old Swing with something to parse XUL-ish XML：有没有人发明了一种用于 XML 的声明性语法（如 XUL）以与 Java Swing 一起使用？我想不难做到，创建一些基于 STaX 的代码，它读取 XML 文件，实例化 Swing 元素的层次结构，并通过某种对象模型使层次结构可访问。但我宁愿使用众所周知的、有文档记录和测试过的东西，也不愿自己发明这样的东西。

3.  [JGoodies Forms——](http://www.jgoodies.com/freeware/forms/)不完全是声明性的，但有点接近，我在 JGoodies Binding 上运气不错。但是他们的表单布局语法似乎有点神秘。

**编辑：**这里有很多很棒的答案！（我在上面添加了#3）我会特别感谢听到你们中的任何人在将这些框架之一用于实际应用程序方面的任何经验。

ps 我确实尝试了一些谷歌搜索（“java gui declarative”），只是不太知道要寻找什么。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-17T16:56:29.473

你可以看看[javabuilders](http://code.google.com/p/javabuilders/)；它使用[YAML](http://en.wikipedia.org/wiki/YAML)来构建 Swing UI。

[手册](http://github.com/jacek99/javabuilders/raw/39a2f1854c1bd53162e53e845f5ce663d7214d22/org.javabuilders.docs/javabuilders/out/pdf/swing.javabuilder.pdf)[PDF]中的一个简单示例：

```
JFrame:
    name: myFrame
    title: My Frame
    content:
        - JLabel:
            name: myLabel2
            text: My First Label
        - JLabel:
            name: myLabel2
            text: My Second Label 
```

或者：

```
JFrame:
    name: myFrame
    title: My Frame
    content:
        - JLabel: {name: myLabel2, text: My First Label}
        - JLabel: {name: myLabel2, text: My Second Label} 
```

甚至：

```
JFrame(name=myFrame,title=My Frame):
    - JLabel(name=myLabel2, text=My First Label)
    - JLabel(name=myLabel2, text=My Second Label) 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-05-28T12:41:16.430

作为 CookSwing 的作者，这个工具可以满足您的需求，在实际实现之前，我已经仔细研究了这个主题。我以编写 Java Swing GUI 应用程序为生。

IMO，如果您打算使用任何一种命令式编程语言来描述 Java Swing 组件，那么您不妨只使用 Java。Groovy 等只是增加了复杂性而没有太多简化。

声明式语言要好得多，因为即使是非程序员也能理解它，尤其是当您需要将微调特定布局的任务委托给艺术家时。XML 非常适合声明性语言（优于其他选择），因为它简单、易读，并且有大量可用的编辑器/转换工具等。

以下是声明式 GUI 编程中面临的问题，没有任何特定的顺序。这些问题已在 CookSwing 中得到解决。

1.  可读性和简单性。（JavaFX 并不比 XML 简单。XML 的关闭标签有助于阅读，并且不会增加额外的输入，因为 XML 编辑器通常会为您做这件事）
2.  可扩展性。非常重要，因为自定义 Swing 组件将出现在任何重要的项目中。
3.  GUI 布局。也非常重要。能够处理 BorderLayout、GridBagLayout、JGoodies FormsLayout 等实际上是必须的。
4.  复制/粘贴的简单性。在设计布局的过程中，有必要尝试不同的布局。所以需要能够复制/粘贴和移动东西。XML 更好，因为组件和布局的层次结构很容易看到。由于多行属性和缩进问题，JavaFX 存在一些问题。拥有一个好的编辑器是必须的，而且有很多好的 XML 编辑器。
5.  模板（即能够包含另一个布局文件）对于一致的外观非常有用。例如，您可能希望对话框、按钮面板等具有一致的外观。
6.  与 Java 代码的交互。这是至关重要的。某些 GUI 组件只能使用 Java 代码创建（无论出于何种原因）。因此有必要能够加载这些对象。它还必须能够直接连接 XML 代码中的侦听器和其他 Java 对象/组件。稍后使用 id 将它们连接起来将无法正常工作，因为它非常乏味。
7.  国际化 (i18n)。能够从资源包而不是硬编码文本加载文本/字符串。此功能对于某些应用程序可能至关重要。
8.  本地化 (l10n)。声明式编程（尤其是 XML）的优势在于，您可以针对特定的语言环境切换到不同的 GUI 表单，仅此而已。如果您使用 Java 或任何其他命令式语言进行编码，那就不那么容易了。
9.  错误检查/容错。最初的设计经常会在这里和那里包含错误。有时错误可能是因为尚未设计相应的 Java 代码。或者缺少图标资源。用命令式编码处理错误是非常乏味的。因此，希望能够定位错误，同时又具有容错性，因此可以尽早进行 GUI 布局的预览。
10.  GUI 组件替换。也就是说，将曾经有 JTextField 的 textfield 替换为一些更高级的组件版本。用一些花哨的 UI 对话框（例如 JIDE 的）代替对话框的含义，而不是 JDialog。此功能可以节省大量工作量。由于 XSLT 和其他转换工具，XML 本身也很有用。
11.  超越摇摆。因为迟早你会发现许多组件配置使用对象类型，例如数组、图标、图像、矢量等。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-04-17T19:38:06.230

如果简洁很重要，您可能需要考虑双括号习语：

```
new JFrame("My Frame") {{
    setName("myFrame");
    add(new JLabel("My First Label") {{
         setName("myLabel2");
    }};
    add(new JLabel("My Second Label") {{
         setName("myLabel2");
    }};
}} 
```

这样您就不会失去众所周知的通用编程语言的任何功能（您知道您将需要它，而 JellyTags 很烂）。你所需要的只是一个额外的习语。

它的使用并不多，因为实际上人们对 XML 的不满并没有解决真正的痛点。

通常，您可以使用构建器层来抽象重复代码。GUI 代码不必写得很糟糕，只是几乎所有代码都是如此（包括在教科书中）。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-04-18T05:15:12.487

我强烈推荐[MiG Layout](http://www.miglayout.com/) - 需要几天时间来适应语法，但是一旦你掌握了它，它就会产生奇迹。我使用 JGoodies Forms 有一段时间了，Karsten 的构建器概念运行良好，但它有点神秘…… MiG 更容易上手，并且代码非常简洁。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-04-17T16:55:28.680

如果您愿意稍微超越普通 Java，[Groovy](http://groovy.codehaus.org)的“构建器”概念与 GUI 配合得非常好。当然，您可以相当轻松地在 Groovy 和 Java 之间进行互操作。有关更多信息，请参阅[Swing Builder](http://groovy.codehaus.org/Swing+Builder)页面。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-17T16:55:59.240

试试 Swiby：[http ://swiby.codehaus.org/](http://swiby.codehaus.org/)

“Swiby 是 Swing 和 Ruby 的混合体，适用于真正丰富的分布式应用程序。” 换句话说，Swiby 是一种混合了 swing 和 ruby​​ 的领域特定语言。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-06-08T13:25:23.740

[SDL/Swing](http://www.ikayzo.org/confluence/display/SSW/Home)完全满足您的需求。它是一个小巧 (283k)、不显眼、易于学习的声明性 Swing 框架。

```
menus {
    "File" {
        "Open" do="open" // calls "open()" in the controller
        "---"
        "Exit" do="exit"
    }
} 
```

SDL/Swing 是开源的，但享有商业支持。我们 (Ikayzo.com) 开发了它多年，并已将其部署到从生命科学公司到银行的许多客户的生产系统中。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-17T16:55:47.197

我可以找到您所要求的以下示例：

*   [SWIXML](http://www.swixml.org/)
*   [SwiXAT Swing-XML 创作工具](http://swixat.sourceforge.net/index.htm)（基于 SWIXML）
*   [CookSwing：XML 到 Swing GUI](http://cookxml.yuanheng.org/cookswing/)
*   [JFCML - JFC/Swing XML 标记语言](http://jfcml.sourceforge.net/)
*   可能是[JEasy](http://www.jeasy.de/)，我不确定

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-20T03:18:27.883

尽管它不是声明性的并且仅限于布局，但您可能想看看[DesignGridLayout](https://designgridlayout.dev.java.net/)，它允许以非常简洁的方式以编程方式定义 Swing 布局（它是开源的）。

主要优点：

*   轻松快速地学习。
*   简洁的代码（表格中每行组件一行代码）也便于维护
*   编译时检查（声明式 UI 没有）
*   尊重平台外观和感觉（基线对齐，组件之间的间隙......），没有任何硬编码的长度值

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-26T20:57:56.253

一些新的东西...... [XWT](http://www.xwt.org/)，将包含在 eclipse e4 中

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-04-26T23:27:12.370

我最近遇到了[SDL / Swing](http://www.ikayzo.org/confluence/display/SSW/Home)。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-07-03T17:00:14.843

我尝试了很多解决方案，例如 SWIXML、Javabuilders、MigLayout、Cookswing。我终于发现 javaFX 和 javaFX-Scenebuilder 是最好的最快的解决方案，基于 XML 的 GUI 工具。您喜欢 scenebuilder 创建 GUI 的方式（使用拖放项目！）。此外，它使用 CSS（层叠样式表）作为 GUI 主题。请相信 Oracle，它是 Java 应用程序的最佳 GUI 工具。参观使用场景构建器创建 javaFX 应用程序，这里： [http ://docs.oracle.com/javafx/scenebuilder/1/get_started/prepare-for-tutorial.htm#CEGJBHHA](http://docs.oracle.com/javafx/scenebuilder/1/get_started/prepare-for-tutorial.htm#CEGJBHHA)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-17T16:57:30.420

通常，在您寻找某些东西时执行搜索总是一个好主意。[这](http://java-source.net/open-source/xml-user-interface-toolkits)是谷歌在寻找“java xml gui”时的第一个链接

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-01-11T02:02:37.840

[WindowBuilder](http://code.google.com/javadevtools/download-wbpro.html) , 一个非常不错的插件, 包含 GWT,XWT,SWT,Swing 等

# c# - 在 ScrollViewer 的子控件上时鼠标滚轮不起作用

> ID：761243
> 
> 赞同：8
> 
> 时间：2009-04-17T16:53:07.203
> 
> 标签：c#, .net, wpf, scrollviewer, mousewheel

我有点期待我的 ScrollViewer 的子控件能够自动将 MouseWheel 事件备份到 ScrollViewer，但事实并非如此。

我有一个 ScrollViewer，里面有一个 ListBox。如果我手动将 ListBox 的宽度调整为小于 ScrollViewer，则 MouseWheel 可在所有 ScrollViewer 上工作，但当鼠标位于 ListBox 上方时不起作用。

这样做的标准方法是什么？我是否在触发父事件的 ListBox 上放置了一个事件触发器？我是否在后面的代码中处理和重新路由事件？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-17T17:01:25.560

的`ListBox`模板中有一个`ScrollViewer`，因此`ScrollViewer`它将处理事件并阻止它们向上传播可视化树。

你到底想通过一个`ListBox`inside a来实现`ScrollViewer`什么？也许您需要重新模板化`ListBox`，但如果没有进一步的信息就不可能说。

# language-agnostic - QA 流程 - 最佳创意

> ID：761248
> 
> 赞同：1
> 
> 时间：2009-04-17T16:54:54.890
> 
> 标签：language-agnostic, qa

质量保证的最佳流程是什么（除了测试）？你使用代码审查、代码分析器吗？您使用 QA 标准文档，还是仅使用眼球代码？另外，您如何向开发人员提供反馈？你为质量保证做**什么**？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-17T17:03:02.793

*   除非您的问题率非常低，否则请使用数据库来跟踪问题。
*   通过让开发人员进行 TDD（[测试驱动开发](http://en.wikipedia.org/wiki/Test-driven_development)）来使 QA 过程变得有趣。这对他们有好处，它摆脱了愚蠢的错误。
*   自动化测试。
*   让 QA 从一开始就参与产品，而不仅仅是最后两周。
*   给他们权力。QA 可以决定产品何时可以发货。
*   给 QA 一条真正的职业道路。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-17T17:16:47.643

我认为所有 QA 都是多管齐下的。开发人员必须测试他们自己的代码，以确保它做他认为应该做的事情并且不会破坏构建。测试人员应根据规范进行测试，以查看开发人员是否正确解释了它们（开发人员测试几乎从未发现这些问题）。同行应进行代码审查，以确保遵循标准并促进学习。用户必须进行测试，就像他们将尝试做没有人期望或在需求中定义的事情一样。通常这些都是愚蠢的事情，让我们摇摇头，“为什么每个人都想这样做？” 但是许多其他的真正需求不在规范中，因为没有人费心去问用户他们需要什么。应该进行客户验收测试，特别是如果您为不同的客户进行定制开发。如果客户在工作投入生产之前已经签署了工作，那么表明新的工作请求是新的开发而不是错误要容易得多。这可以节省大量关于谁来支付费用的合同纠纷。

此外，让其他人修复您的错误代码是确保继续生成错误代码的最佳方式，这就是为什么我讨厌某些公司的组织结构，即让开发人员做新事物并支持进行修复的人。此外，修复错误代码以节省时间而不将其发送回开发人员进行修复的经理正在给未修复它们的组织带来问题。

在我看来，QA 的另一个重要部分是花时间实际定义需求和标准。（是的，它们会在任何大型项目中发生变化，但仍然需要它们）。没有要求，测试充其量是随机的。如果没有标准，维护可能会成为一场噩梦，而且比需要的成本要高得多。

QA 的最后一部分是从我们的错误中学习。不幸的是，在许多组织中，你不能诚实地在项目后讨论出了什么问题以及如何防止下一次出现问题，而不会陷入相互指责的指责会议，这会导致人们保持安静，而不是因为他们的绩效评估而受到不好的评价. 事实上，出于这个原因，绩效评估通常对提高质量的目标是有害的。（查阅《戴明与全面质量管理》，了解质量大师对绩效考核危害的看法。）

从理论上讲，应该有可以用来衡量改进质量的质量指标。但在实践中，只要您的组织进行绩效评估，这些数字通常会被“按摩”以使事情看起来更好或衡量磨损的事情（更少的代码行并不意味着在所有情况下都有更好的代码，更多的错误报告可能意味着我们在发现（或至少报告）错误方面做得更好，而不是代码比过去的项目更糟糕）因此无用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-17T18:29:19.280

请注意，“质量保证”通常不专注于提高质量本身，而是提供没有错误。有可能制造出仍然存在错误的高质量产品（*但它们当然最好不是重大错误*）。[可以制造出 100% 没有错误但仍不提供质量的产品。](http://www.computerweekly.com/Articles/2008/04/30/230499/brits-list-the-top-20-most-useless-gadgets.htm) [激光制导剪刀 http://www.computerweekly.com/Assets/GetAsset.aspx?ItemID=40649](http://www.computerweekly.com/Assets/GetAsset.aspx?ItemID=40649)

当然，无论如何尝试消除产品中的错误并没有错。然而，QA 的风险在于，专注于阻止错误发生可能会讽刺地干扰产品质量的提高。Tom DeMarco 在他的一本书（我不记得是哪一本，但可能是[Peopleware](http://en.wikipedia.org/wiki/Peopleware:_Productive_Projects_and_Teams)）中写到了这一点，他在其中以 Adob​​e Photoshop 为例说明了他认为什么是高质量的产品以及原因。

来自[维基百科](http://en.wikipedia.org/wiki/Software_quality)：

> Steve McConnell 的 Code Complete 中的定义将软件分为两部分：内部质量特性和外部质量特性。外部质量特征是产品面向用户的部分，而内部质量特征是不面向用户的部分。
> 
> Tom DeMarco 博士的另一个定义是：“产品的质量取决于它使世界变得更好的程度。” 这可以解释为意味着用户满意度在确定软件质量方面比任何事情都更重要。

我想另一种说法是，如果 QA 只关注内部质量，而没有其他人对外部质量负责，那么您最终只能靠运气获得杀手级产品。我希望我听起来不会对错误删除持否定态度，我只想指出这不是灵丹妙药。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T16:59:18.780

拥有一个在交付之前对软件进行认证的 QA 环境是一种很好的做法。在每日报告中提供清晰的质量指标（系统正常运行时间、严重错误的数量、由于流程不善导致的问题数量）可以明确关注质量问题（如果存在）。对于有问题的项目，需要开发团队进行事后分析，以确定如何改进初始和持续质量。任何和所有的沟通都应该是积极的声音，并专注于寻找质量差的根本问题。有时只是询问开发团队他们缺乏什么来提高质量就可以解决许多问题。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2018-04-02T22:56:59.233

对于质量保证，了解产品开发的整个过程比代码审查更重要。作为质量保证，非常需要对实际需求有一个非常清晰的概念，要开发的功能，跟踪要开发的单个/多个，以便可以根据该时间表创建测试范围。

为了向开发人员提供反馈，只需确定用户需求的条件，传达任何可能是功能性或非功能性的不匹配。这将是一个有效的反馈。

# c++ - 你如何“重构”ant build.xml 文件？

> ID：761256
> 
> 赞同：14
> 
> 时间：2009-04-17T16:56:19.130
> 
> 标签：c++, configuration, ant, build-process

我正在开发一个使用 ant+ [cpptasks](http://ant-contrib.sourceforge.net/cpptasks/index.html)构建的大型 C++ 系统。它工作得很好，但是 build.xml 文件已经失控了，因为添加新库或可执行目标的标准操作过程是复制和粘贴另一个 lib/exe 的规则（已经相当大）。如果这是“正确的代码”，它会为重构而尖叫，但作为一个蚂蚁新手（更习惯于制作或 VisualStudio 解决方案），我不确定有哪些选项。

ant 用户阻止 ant 构建文件爆炸的最佳实践是什么？

一个明显的选择是通过 XSLT 生成 build.xml，为常见的重复模式定义我们自己的标签。有没有人这样做，或者有更好的方法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-17T17:04:39.827

您可能对以下内容感兴趣：

*   [<导入>](http://ant.apache.org/manual/Tasks/import.html)
*   [<宏定义>](http://ant.apache.org/manual/Tasks/macrodef.html)
*   [<subant>](http://ant.apache.org/manual/Tasks/subant.html)

[另请查看有关“大型项目的 ant 功能](http://web.archive.org/web/20060822050723/http://www.oracle.com/technology/pub/articles/bodewig_ant1.6.html)”的这篇文章。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-17T17:07:41.007

如果规则是重复的，那么您可以使用 macrodef 将它们分解为一个 ant 宏并重用该宏。

如果文件的绝对大小无法管理，那么您也许可以将其分解为较小的文件，并在这些文件中设置主要的 build.xml 调用目标。

如果两者都不是，那么您可能需要考虑使用构建系统。尽管我自己没有使用过 Maven，但我听说它可以解决许多大型且难以管理的构建文件的问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-17T17:20:41.643

通常，如果您的构建文件又大又复杂，那么这清楚地表明您的代码布局方式（就文件夹和包而言）是复杂且过于复杂的。我发现复杂的 ant 脚本明显带有布局不佳的代码库的味道。

要解决此问题，请考虑您的代码是如何布局的。你有多少项目？这些项目是否知道如何使用主构建脚本来构建自己，该脚本知道如何将各个项目/应用程序/组件捆绑在一起成为一个更大的整体。

当您重构代码时，您正在寻找方法或分解事物以便它们更容易理解——更小的方法、更小的类、做一件事的方法和类。您还需要将这些相同的原则应用于您的代码库。

创建较小的组件，这些组件在功能上具有凝聚力，并且与其余代码非常松散地分离。使用构建脚本将该组件构建到库中。使用其余代码执行此操作。现在创建一个主构建脚本，它知道如何捆绑所有库并将它们构建到您的应用程序中。如果您有多个应用程序，则为每个应用程序创建构建脚本，并创建一个知道如何将应用程序捆绑到可分发文件中的主脚本。

您应该能够通过查看构建脚本来查看和理解代码库的布局和结构。如果它们/它不干净且不易于理解，那么您的源代码也不是。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-20T21:57:58.973

使用 Antlib 文件。这是一种非常干净的方式

1.  删除复制/粘贴的代码
2.  定义默认值

If you want to see an example, you can take a look at some of the [build script](http://code.google.com/p/workingonit/source/browse/trunk/depictus/build.xml) I'm writing for my sandbox projects.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-17T17:11:27.533

我会尝试 Ant-Ivy——[敏捷依赖管理器](http://ant.apache.org/ivy/)。我们最近开始将它用于我们的一些更复杂的系统，它就像一个魅力。这里的优点是您不会获得 maven 的开销和转换成本（它使用 ant 目标，因此可以与您当前的设置一起使用）。[这是](http://ant.apache.org/ivy/m2comparison.html)两者之间的比较。

# javascript - 在 JavaScript 中预加载多个图像的最佳方法是什么？

> ID：761263
> 
> 赞同：31
> 
> 时间：2009-04-17T16:58:07.783
> 
> 标签：javascript

如果我有一组图像文件名，

```
var preload = ["a.gif", "b.gif", "c.gif"]; 
```

我想在循环中预加载它们，每次都需要创建一个图像对象吗？下面列出的所有方法都有效吗？一个更好吗？

一种。

```
var image = new Image();
for (i = 0; i < preload.length; i++) {
    image.src = preload[i];
} 
```

B.

```
var image;
for (i = 0; i < preload.length; i++) {
    image = new Image();
    image.src = preload[i];
} 
```

C。

```
var images = [];
for (i = 0; i < preload.length; i++) {
    images[i] = new Image();
    images[i].src = preload[i];
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-17T17:02:07.040

**编辑**：

其实，我只是测试了一下，方法 A 并没有按预期工作：

看看：[http ://www.rootspot.com/stackoverflow/preload.php](http://www.rootspot.com/stackoverflow/preload.php)

如果您在页面加载完成后单击第二张图片，它应该会立即显示，因为它是预加载的，但第一个不会，因为在更改源之前它没有时间加载。有趣的。有了这个新的发展，我就继续使用方法 C。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-11-09T06:27:21.770

以下代码似乎对我有用。它基于 [A]

查询：

```
var gallery= ['img/1.png','img/2.png','img/3.png','img/4.png','img/5.png'];

var preload_image_object=new Image(); 
```

//解决方案：

```
$.each(gallery,function(i,c){preload_image_object.src=c.logo}) 
```

或者

```
$.each(['img/1.png','img/2.png','img/3.png','img/4.png','img/5.png'],function(i,c){preload_image_object.src=c}) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-17T17:17:00.500

我一直使用下面的代码，我也看到许多其他网站都在使用它，所以我会假设这种方法性能最高，并且类似于你的方法 c

```
function MM_preloadImages() { //v3.0
    var d=document; 
    if(d.images){ 
        if(!d.MM_p) d.MM_p=new Array();
         var i,j=d.MM_p.length,a=MM_preloadImages.arguments; 
         for(i=0; i<a.length; i++)
             if (a[i].indexOf("#")!=0) { 
                 d.MM_p[j]=new Image; d.MM_p[j++].src=a[i];
             }
    }
} 
```

我建议使用诸如[萤火虫之类的东西对它们进行分析](http://getfirebug.com/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T17:05:16.830

如果我没记错的话，我遇到的问题是`A`解决方案实际上没有在浏览器中预加载。不过，我不是 100% 确定。

既然您已将它们全部编码，为什么不测试它们，您甚至可以分析它们以查看哪个最快。

# database - 异构数据库系统在实践中吗？

> ID：761264
> 
> 赞同：1
> 
> 时间：2009-04-17T16:58:20.123
> 
> 标签：database, distributed, multiple-databases

我在数据库领域进行了一些探索，并提出了拥有异构数据库的概念。我用谷歌搜索并找到了这个 -[链接文本](http://en.wikipedia.org/wiki/Heterogeneous_Database_System)

我的问题是什么样的场景可以将其付诸实践，它真的有用吗？是否只是另一件被考虑但未实施的事情，或者如果实施了，那么它被限制在一个非常利基的领域？

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T17:06:16.233

我会说是的，非常如此。我熟悉的一种实现是将 MAS90 与 LOB 生产系统集成。数据在两者中都是重复的，但以不同的方式访问和使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T17:08:40.083

我以前在异构系统上工作过。它是一个商业系统，用于管理大型大学的留学项目，并安装在 Oracle、MySql 和 Sql Server 上。不过，我是一名外部顾问，负责处理一个非常具体的转换项目，所以我没有看到很多关于让它在任何地方都能正常工作所涉及的问题。

我确实记得，我必须处理的最大障碍是 Oracle 缺乏简单的自动增量式列，而不得不设置单独的序列。也有许多数据类型不匹配，但是有一个非常好的系统来映射它们。

请注意，即使在这里，每个客户也只有一种数据库。我们不必担心在数据库类型之间复制数据本身（除了一些常见的查找表）。只是结构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T17:10:55.443

贵公司的不同部门可能使用不同的数据库。我从以下拉入数据并将数据推送到

SQL 服务器

甲骨文

Sybase 智商

使用权

MySQL

福克斯专业版

平面文件

Excel 文件

SQL Server 数据库是所有数据的存储库，但它从许多不同的数据库中提取数据以填充数据，然后将数据推送到不同的数据库以供部门使用

# nhibernate - 使用 NHibernate 2.0.1 插入子表

> ID：761272
> 
> 赞同：0
> 
> 时间：2009-04-17T17:01:01.940
> 
> 标签：nhibernate

我这周开始使用[NHibernate](http://en.wikipedia.org/wiki/NHibernate)（苦苦挣扎）。我有一个带有 3 个表的小型应用程序（我现在使用 2 个）。这里的表`currency`和表`country`是映射文件。

```
<class name="dataprovider.Country,dataprovider" table="country">
    <id name="CountryId" column="country_id" unsaved-value="0">
        <generator class="native"/>
    </id>
    <!--<bag name="BatchList" inverse="true" lazy="true" >
        <key column="country_id" />
        <one-to-many class="Batch" />
    </bag>
    <bag name="PrinterList" inverse="true" lazy="true" >
        <key column="country_id" />
        <one-to-many class="Printer" />
    </bag>-->
    <many-to-one name="CurrencyId" column="currency_id" class="Currency"  cascade="save-update"/>
    <!--<property column="currency_id" name="Currency_Id"/>-->
    <property column="name" name="Name"/>
    <property column="region" name="Region" />
    <property column="comments" name="Comments"/>
</class> 
```

货币映射文件：

```
<class name="dataprovider.Currency, dataprovider" table="currency">
    <id name="CurrencyId" column="currency_id" >
        <generator class="native"/>
    </id>
    <bag name="CountryList" inverse="true" lazy="true" >
        <key column="currency_id" />
        <one-to-many class="Country" />
    </bag>
    <!--<bag name="DenominationList" inverse="true" lazy="true" >
        <key column="currency_id" />
        <one-to-many class="Denomination" />
    </bag>-->
    <property column="name" name="Name"/>
    <property column="authorizer" name="Authorizer"  />
    <property column="date_created"  name="DateCreated" type="DateTime" not-null="true" />
    <property column="comments"  name="Comments"  /> 
```

保持的多对一关系在持久性类中`country`创建了该类型的属性。现在，当我的测试成功（我导出架构）时，我在字段的表中有空值。`Currency``country``can_add_currency``can_add_country``country``currency_id`

这是测试代码：

```
[Test]
    public void can_add_new_country()
    {
        CountryManager cm = new CountryManager();

        Country country = new Country();
        //country.CurrencyId = CurrencyManager.GetCurrencyById(1);
        country.CurrencyId = new CurrencyManager().GetCurrencyById(1);
        country.Name = "POUND";
        country.Region = "ENGLAND";
        country.Comments = "the comment";

        cm.Add(country);

        using(ISession session = _sessionFactory.OpenSession())
        {
            Country fromdb = session.Get<Country>(country.CountryId);
            Assert.IsNotNull(fromdb);
            Assert.AreNotSame(fromdb, country);
        }
    }

    public Currency GetCurrencyById(int currency_id)
    {//GetCurrencyById from CurrencyManger class
        try
        {
            using(ISession session = NHibernateHelper.OpenSession())
            {
                return session.Get<Currency>(currency_id);

            }
        } catch (Exception ex)
        {
            return null;
        }
    } 
```

问题是：**如何使用表 currency 中现有 currency_id 的 currency_id 插入表 country**？

你们是怎么做到的？我被严重卡住了，一个为期 2 天的小项目现在需要我一周的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-17T20:02:35.983

设置`cascade="save-update"`在您的`bag name="CountryList"`. 如果这不起作用，发布您的代码`CountryManager.Add()`以查看保存情况可能会有所帮助。

在回答您的第二个问题时，如果我理解正确，这就是 NHibernate 处理映射集合的方式：

您将集合映射为惰性，因此加载对象不会*同时*加载集合的所有元素。相反，当您第一次访问集合时，NHibernate 将查询数据库以填充集合并返回它。因此，当您第一次执行以下操作时：

```
var countries = currency.CountryList; 
```

或者

```
foreach (Country country in currency.CountryList) 
```

NHibernate 将静默执行类似于以下内容的查询：

```
SELECT * FROM country WHERE currency_id = ? 
```

然后构建一个 Country 对象的集合以返回（并缓存以便不再运行查询）。

基本上，通过映射文件，您已经告诉 NHibernate 关于您的两个实体（国家和货币）以及它们之间的关系，因此它知道如何构建查询以访问数据。同样，它会跟踪集合中的内容，因此当您添加或删除项目时，它可以比较更改的内容并执行适当的 INSERT 或 REMOVE 语句。

因此，使用 NHibernate 映射的集合的方法是像使用普通 .NET 集合一样使用它们。随意添加和删除项目。完成后，请确保告诉 NHibernate 保存您对数据库所做的更改，方法是调用`session.Save()`或`session.Delete()`在您添加/删除的每个项目上，或者（如果您设置了级联，就像您一样）`session.Save()`对父对象进行简单调用包含集合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-18T14:45:43.350

我的级联在这一边：

```
<many-to-one name="CurrencyId" column="currency_id" class="Currency"  cascade="save-update"/> 
```

在我改变它之后，即使我重建了解决方案，它一开始也不起作用。然后我从`Currency_Test`该类中进行了另一个测试：`can_get_currency_by_id`它调用相同的函数`GetCurrncyById`并且我可以有一个对象，而从`can_add_new_country`同一个函数返回 null。

然后我意识到要么的 ExportSchema 要么`Country_Test [Setup]`没有`Currency_Test`按时创建数据库`can_add_new_product`以获得货币对象。这就是它返回空对象的原因。

现在不要滥用；但是你能告诉我如何使用`IList<Counrty>CountryList`吗？不知道我说的好不好。据我了解，它应该`country`使用相同的`currency`（currency_id 参考）存储所有对象。NHibernate 是如何做到这一点的？

# ruby-on-rails - ActiveRecord 中的条件验证

> ID：761275
> 
> 赞同：0
> 
> 时间：2009-04-17T17:01:14.750
> 
> 标签：ruby-on-rails, validation, activerecord

我需要根据模型中的一个字段对 Rails 中的模型进行条件验证。[这是对较早问题](https://stackoverflow.com/questions/585270/how-do-i-do-conditional-validation-in-activerecord-with-n-conditions)的后续处理，该问题促使开发了一种感觉不正确的解决方案。

我有许多基于“订单模型”的 ActiveRecord 模型，其简化版本如下所示。

```
class Order < ActiveRecord::Base

  has_many: previous_addresses
  has_one: applicant
  has_one: current_address
end 
```

所有其他模型都属于订单。

我希望根据订单的公司属性以不同的方式验证各种模型，例如申请人、当前地址等。

我为此开发了一个解决方案，它涉及一个完整的手动验证套件，支持所有标准的 activeRecord 验证器。该解决方案是使用许多表（如模型、字段、field_items 等）开发的，这些表描述了验证并包含大量数据。

我现在必须为我连接的每家新公司处理这些数据并复制和编辑它。这是乏味且容易出错的。

在阅读“The Rails Way”时，我发现 Obie Fernandez 描述了将验证代码以 ActiveRecord 验证语句的形式保存在数据库中并在运行时根据公司 id 的值将这些代码注入模型的部分。

我正在想象将数据保存在如下表中：-

```
公司：200
型号：人
代码 validates_length_of :middle_name, :maximum => 20, :allow_nil => true

公司：201
型号：人
代码 validates_length_of :middle_name, :maximum => 1, :allow_nil => true

```

因此，对于公司 201，中间名“John”将无法通过验证，但对于公司 200 来说可以。

有没有人看过这个，如果有，他们有关于如何做到这一点的任何提示/建议，更好的是，有没有人有任何指向这样做的教程/代码的链接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T17:52:43.597

听起来您需要的是分别验证每条记录的能力。如果这是真的，那么您可以使用[validates_each](http://www.railsbrain.com/api/rails-2.2.2/doc/index.html?a=M001818&name=validates_each)。在此块中，您可以传入逻辑来评估模型的成员。

```
 validates_each :middle_name do |record, attr, value|
   if record.company == 201
     record.errors.add attr, 'cannot be more than 1 character' if value.length > 1
   elsif record.company == 200
     record.errors.add attr, 'must be less than 20 characters' if value.length > 1
   end
 end 
```

# eclipse - 如何将编辑器连接到位置光标图标？

> ID：761284
> 
> 赞同：0
> 
> 时间：2009-04-17T17:03:16.180
> 
> 标签：eclipse, swt, jface

我已经构建了一个图形编辑器作为 Eclipse 插件。用户可以放大和平移图形图像。

我想使用 Eclipse 图标栏中的“后退”和“前进”箭头图标在图形图像中来回切换，其方式类似于文本编辑器中已经实现的方式。我所有的参考资料都在这个主题上保持沉默

欢迎提供所有线索或更好的参考资料。

M。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-17T18:27:56.617

我认为您需要定义一个 RetargetAction

[请参阅http://help.eclipse.org/ganymede/index.jsp?topic=/org.eclipse.platform.doc.isv/guide/rcp_actions.htm](http://help.eclipse.org/ganymede/index.jsp?topic=/org.eclipse.platform.doc.isv/guide/rcp_actions.htm)中的示例

（我自己没有这样做，但听起来不错......）

另请参阅[http://help.eclipse.org/ganymede/topic/org.eclipse.platform.doc.isv/guide/wrkAdv_retarget.htm](http://help.eclipse.org/ganymede/topic/org.eclipse.platform.doc.isv/guide/wrkAdv_retarget.htm)

# python - pyQT QNetworkManager 和 ProgressBars

> ID：761286
> 
> 赞同：1
> 
> 时间：2009-04-17T17:03:51.297
> 
> 标签：python, pyqt

我正在尝试编写从网络服务器下载文件并保存它的代码，在 QProgressBar 中显示下载进度。现在，有一些方法可以在常规 Python 中做到这一点，而且很容易。问题是它锁定了进度条的刷新。解决方案是使用 PyQT 的 QNetworkManager 类。我可以用它下载东西，我只是无法设置以在进度条上显示进度。这是一个例子：

```
class Form(QDialog):

    def __init__(self,parent=None):
        super(Form,self).__init__(parent)
        self.progressBar = QProgressBar()
        self.reply = None
        layout = QHBoxLayout()
        layout.addWidget(self.progressBar)
        self.setLayout(layout)
        self.manager = QNetworkAccessManager(self)
        self.connect(self.manager,SIGNAL("finished(QNetworkReply*)"),self.replyFinished)
        self.Down()

    def Down(self):

        address = QUrl("http://stackoverflow.com") #URL from the remote file.
        self.manager.get(QNetworkRequest(address))
    def replyFinished(self, reply):
        self.connect(reply,SIGNAL("downloadProgress(int,int)"),self.progressBar, SLOT("setValue(int)"))
        self.reply = reply
        self.progressBar.setMaximum(reply.size())
        alltext = self.reply.readAll()
        #print alltext
        #print alltext
    def updateBar(self, read,total):
        print "read", read
        print "total",total
        #self.progressBar.setMinimum(0)
        #self.progressBar.setMask(total)
        #self.progressBar.setValue(read) 
```

* * *

在这种情况下，我的方法“updateBar”永远不会被调用......有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-18T00:53:34.193

好吧，您还没有将任何信号连接到您的 updateBar() 方法。

改变

```
def replyFinished(self, reply):
        self.connect(reply,SIGNAL("downloadProgress(int,int)"),self.progressBar, SLOT("setValue(int)")) 
```

至

```
def replyFinished(self, reply):
        self.connect(reply,SIGNAL("downloadProgress(int,int)"),self.updateBar) 
```

请注意，在 Python 中，您不必显式使用 SLOT() 语法；您可以将引用传递给您的方法或函数。

更新：

我只是想指出，如果您想在处理期间 GUI 锁定的任何情况下使用进度条，一种解决方案是在另一个线程中运行您的处理代码，以便您的 GUI 接收重绘事件。考虑阅读有关 QThread 类的内容，以防您遇到没有为您提供预构建解决方案的进度条的另一个原因。

# asp.net-mvc - 使用 htmlAttributes 时 Ajax.ActionLink 出现的问题不正确地呈现链接

> ID：761288
> 
> 赞同：0
> 
> 时间：2009-04-17T17:04:33.913
> 
> 标签：asp.net-mvc, ajax, rendering, actionlink

有谁知道在 Ajax.ActionLink 中使用 htmlAttributes 时呈现不正确的查询字符串的任何问题？似乎如果我为 htmlAttributes 放入一个空数组，链接就会被错误地呈现。这是我的代码。

当我这样做时（注意新的 { }）：

```
<%= Ajax.ActionLink("Delete", "Delete", "Milestone", new RouteValueDictionary { { "id", Model.Id } }, new AjaxOptions { HttpMethod = "GET", UpdateTargetId = "ModalDeleteContainer", OnSuccess = "modalDelete" }, new { })%> 
```

链接呈现如下：

```
<a href="/Client/1/Admin/Milestone/Delete?Count=1&amp;Keys=System.Collections.Generic.Dictionary%602%2BKeyCollection%5BSystem.String%2CSystem.Object%5D&amp;Values=System.Collections.Generic.Dictionary%602%2BValueCollection%5BSystem.String%2CSystem.Object%5D" onclick="Sys.Mvc.AsyncHyperlink.handleClick(this, new Sys.UI.DomEvent(event), { insertionMode: Sys.Mvc.InsertionMode.replace, httpMethod: 'GET', updateTargetId: 'ModalDeleteContainer', onSuccess: Function.createDelegate(this, modalDelete) });">Delete</a> 
```

当我这样做时（null 而不是 new { }）：

```
<%= Ajax.ActionLink("Delete", "Delete", "Milestone", new RouteValueDictionary { { "id", Model.Id } }, new AjaxOptions { HttpMethod = "GET", UpdateTargetId = "ModalDeleteContainer", OnSuccess = "modalDelete" }, null)%> 
```

链接呈现如下：

```
<a href="/Client/1/Admin/Milestone/Delete/703c749e-c145-4cf1-90eb-9bee00bac79d" onclick="Sys.Mvc.AsyncHyperlink.handleClick(this, new Sys.UI.DomEvent(event), { insertionMode: Sys.Mvc.InsertionMode.replace, httpMethod: 'GET', updateTargetId: 'ModalDeleteContainer', onSuccess: Function.createDelegate(this, modalDelete) });">Delete</a> 
```

两者之间的唯一区别是 Ajax.ActionLink 末尾的 htmlAttributes 参数。感谢您的任何见解！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T17:50:35.020

您需要使用正确的方法重载。您正在使用的那个需要一个 IDictionary，这就是它呈现它的方式的原因。

如果您像这样选择对象 RouteValues 和对象 htmlAttributes：

```
<%= Ajax.ActionLink("Delete", "Delete", "Milestone", new { id = Model.Id }, 
new AjaxOptions { HttpMethod = "GET", UpdateTargetId = "ModalDeleteContainer", 
OnSuccess = "modalDelete" }, new { })%> 
```

这一切都会奏效！

# c# - 在哪里使用 XmlWriter 编写 XML 以在 ASP.NET 中通过 HttpWebRequest POST 发送？

> ID：761303
> 
> 赞同：1
> 
> 时间：2009-04-17T17:08:08.400
> 
> 标签：c#, asp.net, post, httpwebrequest, xmlwriter

这是我的代码，请参阅说明 ???在这里做什么??? 我不确定我将这个 XML 写到哪里以便能够通过那里的 objRequest 在我的 POST 中发送它......

```
string project_id = context.Request.QueryString["project"];
string person_id = context.Request.QueryString["person"];
string post_date = context.Request.QueryString["date"];
string post_hours = context.Request.QueryString["hours"];
string case_num = context.Request.QueryString["case"];

HttpWebRequest objRequest = (HttpWebRequest)WebRequest.Create("http://company.updatelog.com/projects/" + project_id + "/time_entries.xml");

objRequest.Method = "POST";

objRequest.ContentType = "application/xml";

XmlWriterSettings settings = new XmlWriterSettings();
settings.Indent = true;
settings.IndentChars = ("    ");

using (XmlWriter writer = XmlWriter.Create(?????WHAT TO DO HERE????, settings))
{
    writer.WriteStartElement("time-entry");
    writer.WriteElementString("person-id", person_id);
    writer.WriteElementString("date", post_date);
    writer.WriteElementString("hours", post_hours);
    writer.WriteElementString("description", "Worked on Case #" + case_num);
    writer.WriteEndElement();
}

StreamWriter myWriter = null;

try
{

    myWriter = new StreamWriter(objRequest.GetRequestStream());

    myWriter.Write(post_xml);

}

catch (Exception e)
{

    context.Response.Write(e.Message);

}

finally
{

    myWriter.Close();

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T17:26:52.660

`XmlWriter writer = XmlWriter.Create(objRequest.GetRequestStream(), settings);`

那时您不需要创建 StreamWriter。您在 XmlWriter 中写入的内容将写入 requestStream。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T17:12:59.977

您可以只使用一个 XmlTextWriter，它采用一个基本上只是将其写入内存的字符串构建器。

代码：

```
var buidler = new StringBuilder();
var writer = XmlWriter.Create(builder); 
```

# java - JDO - 更新对象

> ID：761306
> 
> 赞同：6
> 
> 时间：2009-04-17T17:08:53.857
> 
> 标签：java, google-app-engine, jdo

我正在尝试使用 Google App Engine 和持久选项 JDO。我想知道是否可以将瞬态对象映射到持久对象？或者使用瞬态对象来更新持久对象？

在编码示例中，我看到以下用于更新对象的代码：

```
public void updateEmployeeTitle(User user, String newTitle) {
PersistenceManager pm = PMF.get().getPersistenceManager();
try {
    Employee e = pm.getObjectById(Employee.class, user.getEmail());
    if (titleChangeIsAuthorized(e, newTitle) {
        e.setTitle(newTitle);
    } else {
        throw new UnauthorizedTitleChangeException(e, newTitle);
    }
} finally {
    pm.close();
}
} 
```

但这不是我想要的，有人知道我是否可以像 JPA 那样更新整个对象：object.update();

所以我想要这样的东西：

```
public User update(User u) {
    PersistenceManager pm = PMF.get().getPersistenceManager();
    User usr;
    try {
        usr = pm.getObjectById(User.class, u.getId());
        // copy transient object u to persist object usr.
                    // on update of usr all changes in object u are persistent.

    } finally {
        pm.close();
    }

    return u;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-22T13:20:10.573

“瞬态”对象没有“身份”，因此无法在数据存储中找到它。仔细考虑是否要使用瞬态对象，或者仅使用分离对象是否更好。JPA 使用“分离”对象的等价物。JDO 也可以这样做，然后您只需调用 pm.makePersistent(detachedObj);

——安迪（数据[核](http://www.datanucleus.org)）

# asp.net - 如何回收 SqlDataSource 对象中的数据？

> ID：761308
> 
> 赞同：2
> 
> 时间：2009-04-17T17:09:11.953
> 
> 标签：asp.net, vb.net, sqldatasource

我有一个`SqlDataSource`对象，链接到 a `GridView`，它在执行时从数据库接收数据。

我想添加“*成本*”列的值，以获取“总成本*”*，并将其`TextBox`放在`GridView`.

是否可以只使用（回收）`SqlDataSource`对象中的数据，而不是使用另一个`SqlDataSource`对象来获取*TotalCost*？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T17:12:41.413

如果您处理 rowdatabound 事件，则可以从每一行获取值以获取总数。

# asp.net - 如何在 ASP.NET 中延迟/限制登录尝试？

> ID：761313
> 
> 赞同：9
> 
> 时间：2009-04-17T17:12:07.233
> 
> 标签：asp.net, security, iis, throttling

我正在尝试对我的 ASP.NET Web 项目进行一些非常简单的请求限制。目前我对针对 DOS 攻击的全局限制请求不感兴趣，但想人为地延迟对所有登录尝试的响应，只是为了让字典攻击更难做（或多或少像 Jeff Atwood[在这里](http://www.codinghorror.com/blog/archives/001206.html)概述的那样）。

你将如何实施它？这样做的幼稚方式是 - 我想 - 简单地调用

```
Thread.Sleep(); 
```

在请求期间的某个地方。建议？:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-12-08T13:49:56.230

关于如何提高登录屏幕（和密码重置屏幕）的安全性，我的想法与您相同。我将为我的项目实施这个，我会和你分享我的故事。

# 要求

我的要求有以下几点：

*   不要仅仅因为有人试图入侵而阻止个人用户
*   我的用户名很容易猜到，因为它们遵循某种模式（而且我不喜欢默默无闻的安全性）
*   不要因为过多的请求休眠而浪费服务器资源，队列最终会溢出并且请求会开始超时
*   99% 的时间为大多数用户提供快捷的服务
*   消除登录屏幕上的暴力攻击
*   处理分布式攻击
*   需要合理的线程安全

# 计划

因此，我们将有一个失败尝试的列表及其时间戳。每次我们尝试登录时，我们都会检查这个列表，失败的尝试越多，登录所需的时间就越长。每次我们都会根据时间戳修剪旧条目。超过一定阈值，将不允许登录，所有登录请求将立即失败（攻击紧急关闭）。

我们不会停止自动保护。如果发生紧急关闭，应向管理员发送通知，以便调查事件并采取补救措施。我们的日志应该保留失败尝试的可靠记录，包括时间、用户名和源 IP 地址以供调查。

计划是将其实现为静态声明的队列，其中失败的尝试入队和旧条目出队。队列的长度是我们的严重性指标。当我准备好代码时，我会更新答案。我也可能包括 Keltex 的建议——快速发布响应并使用另一个请求完成登录。

更新：缺少两件事：

1.  将响应重定向到等待页面不会阻塞请求队列，这显然有点大。我们需要给用户一个令牌，以便稍后通过另一个请求进行检查。这可能是另一个安全漏洞，因此我们需要非常谨慎地处理它。或者只是在 Action 方法中删除 Thread.Sleap(xxx) :)
2.  那个IP，呵呵，下次...

让我们看看我们是否最终能度过难关......

# 做了什么

## ASP.NET 页面

ASP.NET UI 页面应该有最小的麻烦，然后我们得到一个 Gate 的实例，如下所示：

```
static private LoginGate Gate = SecurityDelayManager.Instance.GetGate<LoginGate>(); 
```

并在尝试登录（或密码重置）后，调用：

```
SecurityDelayManager.Instance.Check(Gate, Gate.CreateLoginAttempt(success, UserName)); 
```

## ASP.NET 处理代码

LoginGate 在 ASP.NET 项目的 AppCode 中实现，因此它可以访问所有前端好东西。它实现了后端 SecurityDelayManager 实例使用的接口 IGate。Action 方法需要通过等待重定向来完成。

```
public class LoginGate : SecurityDelayManager.IGate
{
    #region Static
    static Guid myID = new Guid("81e19a1d-a8ec-4476-a187-3130361a9006");
    static TimeSpan myTF = TimeSpan.FromHours(24);
    #endregion

    #region Private Types
    class LoginAttempt : Attempt { }
    class PasswordResetAttempt : Attempt { }
    class PasswordResetRequestAttempt : Attempt { }
    abstract class Attempt : SecurityDelayManager.IAttempt
    {
        public bool Successful { get; set; }
        public DateTime Time { get; set; }
        public String UserName { get; set; }

        public string SerializeForAuditLog()
        {
            return ToString();
        }
        public override string ToString()
        {
            return String.Format("{2} Successful:{0} @{1}", Successful, Time, GetType().Name);
        }
    }
    #endregion

    #region Attempt creation utility methods
    public SecurityDelayManager.IAttempt CreateLoginAttempt(bool success, string userName)
    {
        return new LoginAttempt() { Successful = success, UserName = userName, Time = DateTime.Now };
    }
    public SecurityDelayManager.IAttempt CreatePasswordResetAttempt(bool success, string userName)
    {
        return new PasswordResetAttempt() { Successful = success, UserName = userName, Time = DateTime.Now };
    }
    public SecurityDelayManager.IAttempt CreatePasswordResetRequestAttempt(bool success, string userName)
    {
        return new PasswordResetRequestAttempt() { Successful = success, UserName = userName, Time = DateTime.Now };
    }
    #endregion

    #region Implementation of SecurityDelayManager.IGate
    public Guid AccountID { get { return myID; } }
    public bool ConsiderSuccessfulAttemptsToo { get { return false; } }
    public TimeSpan SecurityTimeFrame { get { return myTF; } }

    public SecurityDelayManager.ActionResult Action(SecurityDelayManager.IAttempt attempt, int attemptsCount)
    {
        var delaySecs = Math.Pow(2, attemptsCount / 5);

        if (delaySecs > 30)
        {
            return SecurityDelayManager.ActionResult.Emergency;
        }
        else if (delaySecs < 3)
        {
            return SecurityDelayManager.ActionResult.NotDelayed;
        }
        else
        {
            // TODO: Implement the security delay logic
            return SecurityDelayManager.ActionResult.Delayed;
        }
    }
    #endregion

} 
```

## 后端有点线程安全的管理

所以这个类（在我的核心库中）将处理尝试的多线程计数：

```
/// <summary>
/// Helps to count attempts and take action with some thread safety
/// </summary>
public sealed class SecurityDelayManager
{
    ILog log = LogManager.GetLogger(typeof(SecurityDelayManager).FullName + ".Log");
    ILog audit = LogManager.GetLogger(typeof(SecurityDelayManager).FullName + ".Audit");

    #region static
    static SecurityDelayManager me = new SecurityDelayManager();
    static Type igateType = typeof(IGate);
    public static SecurityDelayManager Instance { get { return me; } }
    #endregion

    #region Types
    public interface IAttempt
    {
        /// <summary>
        /// Is this a successful attempt?
        /// </summary>
        bool Successful { get; }

        /// <summary>
        /// When did this happen
        /// </summary>
        DateTime Time { get; }

        String SerializeForAuditLog();
    }

    /// <summary>
    /// Gate represents an entry point at wich an attempt was made
    /// </summary>
    public interface IGate
    {
        /// <summary>
        /// Uniquely identifies the gate
        /// </summary>
        Guid AccountID { get; }

        /// <summary>
        /// Besides unsuccessful attempts, successful attempts too introduce security delay
        /// </summary>
        bool ConsiderSuccessfulAttemptsToo { get; }

        TimeSpan SecurityTimeFrame { get; }

        ActionResult Action(IAttempt attempt, int attemptsCount);
    }

    public enum ActionResult { NotDelayed, Delayed, Emergency }

    public class SecurityActionEventArgs : EventArgs
    {
        public SecurityActionEventArgs(IGate gate, int attemptCount, IAttempt attempt, ActionResult result)
        {
            Gate = gate; AttemptCount = attemptCount; Attempt = attempt; Result = result;
        }
        public ActionResult Result { get; private set; }
        public IGate Gate { get; private set; }
        public IAttempt Attempt { get; private set; }
        public int AttemptCount { get; private set; }
    }
    #endregion

    #region Fields
    Dictionary<Guid, Queue<IAttempt>> attempts = new Dictionary<Guid, Queue<IAttempt>>();
    Dictionary<Type, IGate> gates = new Dictionary<Type, IGate>();
    #endregion

    #region Events
    public event EventHandler<SecurityActionEventArgs> SecurityAction;
    #endregion

    /// <summary>
    /// private (hidden) constructor, only static instance access (singleton)
    /// </summary> 
    private SecurityDelayManager() { }

    /// <summary>
    /// Look at the attempt and the history for a given gate, let the gate take action on the findings
    /// </summary>
    /// <param name="gate"></param>
    /// <param name="attempt"></param>
    public ActionResult Check(IGate gate, IAttempt attempt)
    {
        if (gate == null) throw new ArgumentException("gate");
        if (attempt == null) throw new ArgumentException("attempt");

        // get the input data befor we lock(queue)
        var cleanupTime = DateTime.Now.Subtract(gate.SecurityTimeFrame);
        var considerSuccessful = gate.ConsiderSuccessfulAttemptsToo;
        var attemptSuccessful = attempt.Successful;
        int attemptsCount; // = ?

        // not caring too much about threads here as risks are low
        Queue<IAttempt> queue = attempts.ContainsKey(gate.AccountID)
                                ? attempts[gate.AccountID]
                                : attempts[gate.AccountID] = new Queue<IAttempt>();

        // thread sensitive - keep it local and short
        lock (queue)
        {
            // maintenance first
            while (queue.Count != 0 && queue.Peek().Time < cleanupTime)
            {
                queue.Dequeue();
            }

            // enqueue attempt if necessary
            if (!attemptSuccessful || considerSuccessful)
            {
                queue.Enqueue(attempt);
            }

            // get the queue length
            attemptsCount = queue.Count;
        }

        // let the gate decide what now...
        var result = gate.Action(attempt, attemptsCount);

        // audit log
        switch (result)
        {
            case ActionResult.Emergency:
                audit.ErrorFormat("{0}: Emergency! Attempts count: {1}. {2}", gate, attemptsCount, attempt.SerializeForAuditLog());
                break;
            case ActionResult.Delayed:
                audit.WarnFormat("{0}: Delayed. Attempts count: {1}. {2}", gate, attemptsCount, attempt.SerializeForAuditLog());
                break;
            default:
                audit.DebugFormat("{0}: {3}. Attempts count: {1}. {2}", gate, attemptsCount, attempt.SerializeForAuditLog(), result);
                break;
        }

        // notification
        if (SecurityAction != null)
        {
            var ea = new SecurityActionEventArgs(gate, attemptsCount, attempt, result);
            SecurityAction(this, ea);
        }

        return result;
    }

    public void ResetAttempts()
    {
        attempts.Clear();
    }

    #region Gates access
    public TGate GetGate<TGate>() where TGate : IGate, new()
    {
        var t = typeof(TGate);

        return (TGate)GetGate(t);
    }
    public IGate GetGate(Type gateType)
    {
        if (gateType == null) throw new ArgumentNullException("gateType");
        if (!igateType.IsAssignableFrom(gateType)) throw new Exception("Provided gateType is not of IGate");

        if (!gates.ContainsKey(gateType) || gates[gateType] == null)
            gates[gateType] = (IGate)Activator.CreateInstance(gateType);

        return gates[gateType];
    }
    /// <summary>
    /// Set a specific instance of a gate for a type
    /// </summary>
    /// <typeparam name="TGate"></typeparam>
    /// <param name="gate">can be null to reset the gate for that TGate</param>
    public void SetGate<TGate>(TGate gate) where TGate : IGate
    {
        var t = typeof(TGate);
        SetGate(t, gate);
    }
    /// <summary>
    /// Set a specific instance of a gate for a type
    /// </summary>
    /// <param name="gateType"></param>
    /// <param name="gate">can be null to reset the gate for that gateType</param>
    public void SetGate(Type gateType, IGate gate)
    {
        if (gateType == null) throw new ArgumentNullException("gateType");
        if (!igateType.IsAssignableFrom(gateType)) throw new Exception("Provided gateType is not of IGate");

        gates[gateType] = gate;
    }
    #endregion

} 
```

## 测试

我为此制作了一个测试夹具：

```
[TestFixture]
public class SecurityDelayManagerTest
{
    static MyTestLoginGate gate;
    static SecurityDelayManager manager;

    [SetUp]
    public void TestSetUp()
    {
        manager = SecurityDelayManager.Instance;
        gate = new MyTestLoginGate();
        manager.SetGate(gate);
    }

    [TearDown]
    public void TestTearDown()
    {
        manager.ResetAttempts();
    }

    [Test]
    public void Test_SingleFailedAttemptCheck()
    {
        var attempt = gate.CreateLoginAttempt(false, "user1");
        Assert.IsNotNull(attempt);

        manager.Check(gate, attempt);
        Assert.AreEqual(1, gate.AttemptsCount);
    }

    [Test]
    public void Test_AttemptExpiration()
    {
        var attempt = gate.CreateLoginAttempt(false, "user1");
        Assert.IsNotNull(attempt);

        manager.Check(gate, attempt);
        Assert.AreEqual(1, gate.AttemptsCount);
    }

    [Test]
    public void Test_SingleSuccessfulAttemptCheck()
    {
        var attempt = gate.CreateLoginAttempt(true, "user1");
        Assert.IsNotNull(attempt);

        manager.Check(gate, attempt);
        Assert.AreEqual(0, gate.AttemptsCount);
    }

    [Test]
    public void Test_ManyAttemptChecks()
    {
        for (int i = 0; i < 20; i++)
        {
            var attemptGood = gate.CreateLoginAttempt(true, "user1");
            manager.Check(gate, attemptGood);

            var attemptBaad = gate.CreateLoginAttempt(false, "user1");
            manager.Check(gate, attemptBaad);
        }

        Assert.AreEqual(20, gate.AttemptsCount);
    }

    [Test]
    public void Test_GateAccess()
    {
        Assert.AreEqual(gate, manager.GetGate<MyTestLoginGate>(), "GetGate should keep the same gate");
        Assert.AreEqual(gate, manager.GetGate(typeof(MyTestLoginGate)), "GetGate should keep the same gate");

        manager.SetGate<MyTestLoginGate>(null);

        var oldGate = gate;
        var newGate = manager.GetGate<MyTestLoginGate>();
        gate = newGate;

        Assert.AreNotEqual(oldGate, newGate, "After a reset, new gate should be created");

        manager.ResetAttempts();
        Test_ManyAttemptChecks();

        manager.SetGate(typeof(MyTestLoginGate), oldGate);

        manager.ResetAttempts();
        Test_ManyAttemptChecks();
    }
}

public class MyTestLoginGate : SecurityDelayManager.IGate
{
    #region Static
    static Guid myID = new Guid("81e19a1d-a8ec-4476-a187-5130361a9006");
    static TimeSpan myTF = TimeSpan.FromHours(24);

    class LoginAttempt : Attempt { }
    class PasswordResetAttempt : Attempt { }
    abstract class Attempt : SecurityDelayManager.IAttempt
    {
        public bool Successful { get; set; }
        public DateTime Time { get; set; }
        public String UserName { get; set; }

        public string SerializeForAuditLog()
        {
            return ToString();
        }
        public override string ToString()
        {
            return String.Format("Attempt {2} Successful:{0} @{1}", Successful, Time, GetType().Name);
        }
    }
    #endregion

    #region Test properties
    public int AttemptsCount { get; private set; }
    #endregion

    #region Implementation of SecurityDelayManager.IGate
    public Guid AccountID { get { return myID; } }
    public bool ConsiderSuccessfulAttemptsToo { get { return false; } }
    public TimeSpan SecurityTimeFrame { get { return myTF; } }

    public SecurityDelayManager.IAttempt CreateLoginAttempt(bool success, string userName)
    {
        return new LoginAttempt() { Successful = success, UserName = userName, Time = DateTime.Now };
    }
    public SecurityDelayManager.IAttempt CreatePasswordResetAttempt(bool success, string userName)
    {
        return new PasswordResetAttempt() { Successful = success, UserName = userName, Time = DateTime.Now };
    }

    public SecurityDelayManager.ActionResult Action(SecurityDelayManager.IAttempt attempt, int attemptsCount)
    {
        AttemptsCount = attemptsCount;

        return attemptsCount < 3
            ? SecurityDelayManager.ActionResult.NotDelayed
            : attemptsCount < 30
            ? SecurityDelayManager.ActionResult.Delayed
            : SecurityDelayManager.ActionResult.Emergency;
    }
    #endregion
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T17:14:57.540

我会将延迟放在服务器验证部分，它不会尝试验证（自动返回，因为 false 有一条消息说用户必须等待这么多秒才能再次尝试）。另一个答案，直到过了这么多秒。执行 thread.sleep 将阻止一个浏览器进行另一次尝试，但它不会阻止分布式攻击，即有人有多个程序试图同时以用户身份登录。

另一种可能性是尝试之间的时间因尝试登录的次数而异。所以第二次尝试他们等待一秒钟，第三次可能是 2，第三次是 4，依此类推。这样，您就不必让合法用户在两次登录尝试之间等待 15 秒，因为他们第一次输入错误的密码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-17T18:10:45.923

Kevin 提出了一个很好的观点，即不想占用您的请求线程。一个答案是让登录成为一个[异步请求](http://msdn.microsoft.com/en-us/magazine/cc163725.aspx)。异步过程只是等待您选择的时间量（500ms？）。那么你就不会阻塞请求线程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T18:32:57.010

我认为您所要求的在网络环境中并不是一种非常有效的方式。登录屏幕的目的是为“用户”提供访问您的服务的简便方法，并且应该易于使用且快速。所以你不应该让用户等待，因为他们中的 99% 都不会坏。

如果有很多并发用户尝试登录，Sleep.Trhead 也有可能给您的服务器带来巨大的负载。可能的选项是：

*   阻止（例如）会话结束的 IP 进行 x 次不成功的登录尝试
*   提供验证码

当然这些不是*所有*的选择，但我仍然相信更多的人会有更多的想法......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-17T17:16:56.850

我认为这不会帮助您阻止 DOS 攻击。如果您休眠请求线程，您仍然允许请求占用您的线程池，并且仍然允许攻击者使您的 Web 服务屈服。

您最好的选择可能是根据尝试的登录名、源 IP 等在指定次数的失败尝试后锁定请求，以尝试定位攻击源，而不会损害您的有效用户。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-17T18:13:31.220

I know it's not what you're asking, but you could implement an account lockout instead. That way, you give them their guesses and then can make them wait any amount of time you want before they can start guessing again. :)

# javascript - 使用 jQuery 删除浏览器历史记录

> ID：761316
> 
> 赞同：6
> 
> 时间：2009-04-17T17:14:06.607
> 
> 标签：javascript, jquery, browser, browser-history

我有一个基于 jQuery 的 ajax 应用程序。**我使用jQuery 历史**插件启用了浏览器历史记录。但我们发现该应用程序生成了太多历史记录。

特别是，我们提供了一个页面内的“ajax-back”按钮，使页面能够返回到以前的 ajax 状态。当按下页面内的“ajax-back”按钮时，我们希望它像浏览器返回按钮一样，通过移动历史的当前索引，或删除最新的历史记录，而不是插入新的历史记录。

所以，我想问一下，**是否可以从javascript中删除最新的浏览器记录？**或者**是否可以修改浏览器历史列表的当前索引？**

非常感谢基于 jQuery 历史插件的示例。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-18T00:31:39.643

很可能你不能轻易地做你正在尝试的事情。有 window.location.replace，它会转到一个新的 URL 并从历史记录中删除当前页面，但这是用于全页面导航的，并且几乎肯定会打破 jQuery 伪造历史的方式。

可以使用 window.history.go() 更改您在历史堆栈中的位置，该函数将整数偏移量放入历史记录并导航到相关条目。它根本不会修改堆栈，它只是把你放在一个新的地方。还有 back() 和 forward() 函数，它们分别用 -1 和 1 调用 go。这可能是您正在寻找的，虽然它不会修改堆栈，只是在其中移动您。

理想情况下，您会找到一个 jQuery 插件，它不会像 jQuery.history 那样维护历史记录，而是提供 onhashchange 抽象，并且您的库只会对哈希更改做出反应。这样，浏览器负责历史堆栈，您不会遇到很多困扰 ajaxian 历史库的疯狂问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-03-06T03:58:59.170

浏览器历史记录通常可以通过 javascript 以非常有限的方式访问（以防止站点窥探/访问该信息）。简短的回答 - 据我所知，您无法通过 jquery 获得您想要做的事情。

# database - PostgreSQL 的隐藏特性

> ID：761327
> 
> 赞同：80
> 
> 时间：2009-04-17T17:16:28.050
> 
> 标签：database, postgresql, rdbms, postgresql-9.3

我很惊讶这还没有发布。您在 Postgres 中知道哪些有趣的技巧？晦涩的配置选项和缩放/性能技巧特别受欢迎。

我相信我们可以击败相应[MySQL 线程](https://stackoverflow.com/questions/368858/hidden-features-of-mysql/600830#600830)上的 9 条评论:)

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-04-17T18:14:09.723

由于 postgres 比 MySQL 更健全，因此没有那么多“技巧”可以报告；-)

该[手册](http://www.postgresql.org/docs/current/interactive/)有一些不错的[性能](http://www.postgresql.org/docs/current/interactive/performance-tips.html)提示。

其他一些与性能相关的事情要记住：

*   确保 autovacuum 已打开
*   确保你已经完成了你的 postgres.conf（有效的缓存大小、共享缓冲区、工作内存......有很多选项可以调整）。
*   使用 pgpool 或[pgbouncer](http://pgfoundry.org/projects/pgbouncer/)将您的“真实”数据库连接保持在最低限度
*   了解[EXPLAIN](http://www.postgresql.org/docs/current/interactive/sql-explain.html)和 EXPLAIN ANALYZE 的工作原理。学习阅读输出。
*   [CLUSTER](http://www.postgresql.org/docs/current/interactive/sql-cluster.html)根据索引对磁盘上的数据进行排序。可以显着提高大型（大部分）只读表的性能。集群是一次性操作：当表随后更新时，更改不会集群。

以下是我发现的一些有用的东西，它们本身与配置或性能无关。

要查看当前正在发生的事情：

```
select * from pg_stat_activity; 
```

搜索杂项功能：

```
select * from pg_proc WHERE proname ~* '^pg_.*' 
```

查找数据库大小：

```
select pg_database_size('postgres');
select pg_size_pretty(pg_database_size('postgres')); 
```

查找所有数据库的大小：

```
select datname, pg_size_pretty(pg_database_size(datname)) as size
  from pg_database; 
```

查找表和索引的大小：

```
select pg_size_pretty(pg_relation_size('public.customer')); 
```

或者，列出所有表和索引（可能更容易查看）：

```
select schemaname, relname,
    pg_size_pretty(pg_relation_size(schemaname || '.' || relname)) as size
  from (select schemaname, relname, 'table' as type
          from pg_stat_user_tables
        union all
        select schemaname, relname, 'index' as type
          from pg_stat_user_indexes) x; 
```

哦，你可以嵌套事务，回滚部分事务++

```
test=# begin;
BEGIN
test=# select count(*) from customer where name='test';
 count 
-------
     0
(1 row)
test=# insert into customer (name) values ('test');
INSERT 0 1
test=# savepoint foo;
SAVEPOINT
test=# update customer set name='john';
UPDATE 3
test=# rollback to savepoint foo;
ROLLBACK
test=# commit;
COMMIT
test=# select count(*) from customer where name='test';
 count 
-------
     1
(1 row) 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-04-17T17:41:43.577

让 postgresql 执行得更好的最*简单*的技巧（当然除了设置和使用正确的索引）就是给它更多的 RAM 来使用（如果你还没有这样做的话）。在大多数默认安装中，**shared_buffers**的值太低了（在我看来）。你可以设置

> 共享缓冲区

在 postgresql.conf 中。将此数字除以 128 以获得 postgres 可以要求的内存量（以 MB 为单位）的近似值。如果你足够高，这将使 postgresql 飞起来。不要忘记重新启动 postgresql。

在 Linux 系统上，当 postgresql 无法重新启动时，您可能已经达到 kernel.shmmax 限制。将其设置得更高

```
sysctl -w kernel.shmmax=xxxx 
```

要在两次启动之间保持这种状态，请将 kernel.shmmax 条目添加到 /etc/sysctl.conf。

**可以在这里找到一大堆 Postgresql 技巧**：

*   [http://www.postgres.cz/index.php/PostgreSQL_SQL_Tricks](http://www.postgres.cz/index.php/PostgreSQL_SQL_Tricks)

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-04-18T01:38:52.353

由于对 INTERVAL 的支持，Postgres 有一个非常强大的日期时间处理工具。

例如：

```
select NOW(), NOW() + '1 hour';
              now              |           ?column?            
-------------------------------+-------------------------------
 2009-04-18 01:37:49.116614+00 | 2009-04-18 02:37:49.116614+00
(1 row)

select current_date ,(current_date +  interval '1 year')::date;
    date             |  date            
---------------------+----------------
 2014-10-17          | 2015-10-17
(1 row) 
```

您可以将许多字符串转换为 INTERVAL 类型。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-04-17T17:20:22.143

**复制**

我会开始的。每当我从 SQLite 切换到 Postgres 时，我通常都会有一些非常大的数据集。关键是使用 COPY FROM 加载您的表，而不是执行 INSERTS。请参阅文档：

[http://www.postgresql.org/docs/8.1/static/sql-copy.html](http://www.postgresql.org/docs/8.1/static/sql-copy.html)

以下示例使用竖线 (|) 作为字段分隔符将表复制到客户端：

```
COPY country TO STDOUT WITH DELIMITER '|'; 
```

要将文件中的数据复制到国家/地区表中：

```
COPY country FROM '/usr1/proj/bray/sql/country_data'; 
```

另请参阅： [sqlite3 中的更快批量插入？](https://stackoverflow.com/questions/364017/faster-bulk-inserts-in-sqlite3/759866#759866)

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-04-17T17:21:54.403

*   到目前为止，我最喜欢的是`generate_series`：最后是一种生成虚拟行集的干净方法。
*   `LIMIT`在子查询的子句中使用相关值的能力：

    ```
    SELECT  (
            SELECT  exp_word
            FROM    mytable
            OFFSET id
            LIMIT 1
            )
    FROM    othertable 
    ```

*   在自定义聚合中使用多个参数的能力（文档未涵盖）：请参阅[**我博客中的文章以**](http://explainextended.com/2009/03/04/aggregate-concatenation/)获取示例。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-04-17T18:21:33.557

我真正喜欢 Postgres 的一件事是列中支持的一些数据类型。例如，有一些列类型用于存储[Network Addresses](http://www.postgresql.org/docs/8.3/interactive/datatype-net-types.html)和[Arrays](http://www.postgresql.org/docs/8.3/interactive/arrays.html)。这些列类型的相应函数（[网络地址](http://www.postgresql.org/docs/8.3/interactive/functions-net.html)/[数组](http://www.postgresql.org/docs/8.3/interactive/functions-array.html)）使您可以在查询中执行许多复杂操作，这些操作必须通过 MySQL 或其他数据库引擎中的代码处理结果来完成。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2010-02-17T03:01:26.873

一旦你了解了数组，它们就真的很酷了。假设您想在页面之间存储一些超链接。您可能首先考虑创建一个像这样的表：

```
CREATE TABLE hyper.links (
     tail INT4,
     head INT4
); 
```

如果您需要索引*尾*列，并且您有 200,000,000 个链接行（就像 wikipedia 给您的那样），您会发现自己有一个巨大的表和一个巨大的索引。

但是，对于 PostgreSQL，您可以改用这种表格式：

```
CREATE TABLE hyper.links (
     tail INT4,
     head INT4[],
     PRIMARY KEY(tail)
); 
```

要获取链接的所有头，您可以发送这样的命令（unnest() 自 8.4 以来是标准的）：

```
SELECT unnest(head) FROM hyper.links WHERE tail = $1; 
```

与第一个选项相比，此查询速度惊人（unnest() 速度快，索引小得多）。此外，您的表和索引将占用更少的 RAM 内存和 HD 空间，尤其是当您的数组太长以至于它们被压缩到 Toast 表时。数组真的很强大。

注意：虽然 unnest() 将从 Array 中生成行，但 array_agg() 会将行聚合到 Array 中。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-06-22T00:15:01.420

物化视图很容易设置：

```
CREATE VIEW my_view AS SELECT id, AVG(my_col) FROM my_table GROUP BY id;
CREATE TABLE my_matview AS SELECT * FROM my_view; 
```

这将创建一个新表 my_matview，其中包含 my_view 的列和值。然后可以设置触发器或 cron 脚本以使数据保持最新，或者如果您很懒惰：

```
TRUNCATE my_matview;
INSERT INTO my_matview SELECT * FROM my_view; 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2010-02-19T17:15:41.017

*   Inheritance..infact 多重继承（如父子“继承”而不是许多 Web 框架在使用 postgres 时实现的一对一关系继承）。

*   PostGIS（空间扩展），一个出色的附加组件，提供全面的几何函数集和开箱即用的坐标存储。广泛用于许多开源地理库（例如 OpenLayers、MapServer、Mapnik 等），并且绝对优于 MySQL 的空间扩展。

*   用不同的语言编写程序，例如 C、Python、Perl 等（如果您是开发人员而不是 db-admin，那么编写代码会让您的生活更轻松）。

    此外，所有过程都可以存储在外部（作为模块），并且可以在运行时通过指定的参数调用或导入。这样您就可以轻松地对代码进行源代码控制并调试代码。

*   数据库中实现的所有对象（即表、约束、索引等）的庞大而全面的目录。

    我总是发现运行少量查询并获取所有元信息非常有帮助，例如，约束名称和实施它们的字段，索引名称等。

    对我来说，当我必须加载新数据或在大表中进行大量更新（我会自动禁用触发器并删除索引）然后在处理完成后轻松地重新创建它们时，这一切都变得非常方便。有人在编写少量这些查询方面做得非常出色。

    [http://www.alberton.info/postgresql_meta_info.html](http://www.alberton.info/postgresql_meta_info.html)

*   一个数据库下有多个schema，如果您的数据库有大量表，您可以使用它，您可以将schema视为类别。所有表（无论其架构如何）都可以访问父数据库中存在的所有其他表和函数。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2012-06-19T09:57:56.593

您无需学习如何解读“解释分析”输出，有一个工具：[http ://explain.depesz.com](http://explain.depesz.com)

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-04-20T02:04:46.143

```
select pg_size_pretty(200 * 1024) 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-04-18T01:31:48.063

[pgcrypto](http://www.postgresql.org/docs/8.3/interactive/pgcrypto.html)：比许多编程语言的加密模块提供的更多的加密功能，所有这些都可以直接从数据库中访问。它使密码学的东西非常容易做到正确。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2011-06-14T15:39:41.177

可以使用以下命令复制数据库：

> createdb -T old_db new_db

文档说：

> 这不是（还）打算作为通用的“复制数据库”工具

但它对我来说效果很好，而且比

> createdb new_db
> 
> pg_dump old_db | psql 新数据库

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2011-05-08T10:06:40.690

**一次性数据/全局变量的内存存储**

您可以在 RAM 中创建一个表空间，并在该表空间中创建表（可能未记录，在 9.1 中），以存储您希望跨会话共享的一次性数据/全局变量。

[http://magazine.redhat.com/2007/12/12/tip-from-an-rhce-memory-storage-on-postgresql/](http://magazine.redhat.com/2007/12/12/tip-from-an-rhce-memory-storage-on-postgresql/)

**咨询锁**

这些记录在手册的一个不起眼的区域：

[http://www.postgresql.org/docs/9.0/interactive/functions-admin.html](http://www.postgresql.org/docs/9.0/interactive/functions-admin.html)

它有时比获取大量行级锁要快，并且它们可用于解决未实现 FOR UPDATE 的情况（例如递归 CTE 查询）。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2014-10-17T05:17:53.390

***1.) 当您需要附加通知来查询时，您可以使用嵌套注释***

```
SELECT /* my comments, that I would to see in PostgreSQL log */
       a, b, c
   FROM mytab; 
```

***`text`2.) 从数据库中的所有and`varchar`字段中删除尾随空格。***

```
do $$
declare
    selectrow record;
begin
for selectrow in
select 
       'UPDATE '||c.table_name||' SET '||c.COLUMN_NAME||'=TRIM('||c.COLUMN_NAME||')  WHERE '||c.COLUMN_NAME||' ILIKE ''% '' ' as script
from (
       select 
          table_name,COLUMN_NAME
       from 
          INFORMATION_SCHEMA.COLUMNS 
       where 
          table_name LIKE 'tbl%'  and (data_type='text' or data_type='character varying' )
     ) c
loop
execute selectrow.script;
end loop;
end;
$$; 
```

***3.) 我们可以使用窗口函数来非常有效地删除重复行：***

```
DELETE FROM tab 
  WHERE id IN (SELECT id 
                  FROM (SELECT row_number() OVER (PARTITION BY column_with_duplicate_values), id 
                           FROM tab) x 
                 WHERE x.row_number > 1); 
```

一些 PostgreSQL 的优化版本（带 ctid）：

```
DELETE FROM tab 
  WHERE ctid = ANY(ARRAY(SELECT ctid 
                  FROM (SELECT row_number() OVER (PARTITION BY column_with_duplicate_values), ctid 
                           FROM tab) x 
                 WHERE x.row_number > 1)); 
```

***4.) 当我们需要识别服务器的状态时，我们可以使用一个函数：***

```
SELECT pg_is_in_recovery(); 
```

***5.) 获取函数的 DDL 命令。***

```
select pg_get_functiondef((select oid from pg_proc where proname = 'f1')); 
```

***6.) 在 PostgreSQL 中安全地更改列数据类型***

```
create table test(id varchar );
insert into test values('1');
insert into test values('11');
insert into test values('12');

select * from test
--Result--
id
character varying
--------------------------
1
11
12 
```

从上表可以看出，我使用了数据类型——'id'<br> 列的'character varying'。但这是一个错误，因为我总是将整数作为 id。所以在这里使用 varchar 是一种不好的做法。因此，让我们尝试将列类型更改为整数。

```
ALTER TABLE test ALTER COLUMN id TYPE integer; 
```

但它返回：

> 错误：列“id”不能自动转换为整数 SQL 状态：42804 提示：指定一个 USING 表达式来执行转换

这意味着我们不能简单地更改数据类型，因为列中已经存在数据。由于数据是“字符变化”类型，postgres 不能期望它是整数，尽管我们只输入了整数。所以现在，正如 postgres 建议的那样，我们可以使用“USING”表达式将我们的数据转换为整数。

```
ALTER TABLE test ALTER COLUMN id  TYPE integer USING (id ::integer); 
```

有用。

***7.) 知道谁连接到数据库***
这或多或少是一个监控命令。要知道哪个用户连接到哪个数据库，包括他们的 IP 和端口，请使用以下 SQL：

```
SELECT datname,usename,client_addr,client_port FROM pg_stat_activity ; 
```

***8.) 在不重启服务器的情况下重新加载 PostgreSQL 配置文件***

PostgreSQL 配置参数位于特殊文件中，如 postgresql.conf 和 pg_hba.conf。通常，您可能需要更改这些参数。但是为了使某些参数生效，我们经常需要重新加载配置文件。当然，重启服务器就可以了。但是在生产环境中，仅仅为了设置一些参数而不是重新启动数据库，这是数千人使用的。在这种情况下，我们可以使用以下函数在不重启服务器的情况下重新加载配置文件：

```
select pg_reload_conf(); 
```

> 请记住，这不适用于所有参数，某些参数更改需要完全重启服务器才能生效。

***9.) 获取当前Database集群的数据目录路径***

可能在一个系统中，PostgreSQL 的多个实例（集群）被设置在不同的端口左右。在这种情况下，查找哪个实例使用哪个目录（物理存储目录）是一项繁重的任务。在这种情况下，我们可以在我们感兴趣的集群中的任何数据库中使用以下命令来获取目录路径：

```
SHOW data_directory; 
```

可以使用相同的功能更改集群的数据目录，但需要重新启动服务器：

```
SET data_directory to new_directory_path; 
```

***10.) 查找 CHAR 是否为 DATE***

```
create or replace function is_date(s varchar) returns boolean as $$
begin
  perform s::date;
  return true;
exception when others then
  return false;
end;
$$ language plpgsql; 
```

用法：以下将返回*True*

```
select is_date('12-12-2014')
select is_date('12/12/2014')
select is_date('20141212')
select is_date('2014.12.12')
select is_date('2014,12,12') 
```

***11.) 更改 PostgreSQL 中的所有者***

```
REASSIGN OWNED BY sa  TO postgres; 
```

***12.) PGADMIN PLPGSQL 调试器***

[这里](http://www.postgresonline.com/journal/archives/214-Using-PgAdmin-PLPgSQL-Debugger.html)解释得很好

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2014-10-17T06:30:28.820

这是我最喜欢的鲜为人知的功能列表。

## 事务性 DDL

在 Postgres 中，几乎每个 SQL 语句都是事务性的。如果您关闭自动提交，则可能发生以下情况：

```
drop table customer_orders;
rollback;
select *
from customer_orders; 
```

## 范围类型和排除约束

据我所知，Postgres 是唯一可以让您创建一个约束来检查两个范围是否重叠的 RDBMS。一个示例是包含具有“有效期自”和“有效期至”日期的产品价格的表：

```
create table product_price
(
   price_id      serial        not null primary key,
   product_id    integer       not null references products,
   price         numeric(16,4) not null,
   valid_during  daterange not null
); 
```

## NoSQL 特性

该`hstore` 扩展提供了一个灵活且非常快速的键/值存储，可以在数据库的某些部分需要“无模式”时使用。JSON 是以无模式方式存储数据的另一种选择，并且

```
insert into product_price 
  (product_id, price, valid_during)
values 
  (1, 100.0, '[2013-01-01,2014-01-01)'),
  (1,  90.0, '[2014-01-01,)');

-- querying is simply and can use an index on the valid_during column
select price
from product_price
where product_id = 42
  and valid_during @> date '2014-10-17'; 
```

上面的执行计划在一个有 700.000 行的表上：

```
Index Scan using check_price_range on public.product_price  (cost=0.29..3.29 rows=1 width=6) (actual time=0.605..0.728 rows=1 loops=1)
  Output: price
  Index Cond: ((product_price.valid_during @> '2014-10-17'::date) AND (product_price.product_id = 42))
  Buffers: shared hit=17
Total runtime: 0.772 ms 
```

为了避免插入具有重叠有效性范围的行，可以定义一个简单（有效）的唯一约束：

```
alter table product_price
  add constraint check_price_range 
  exclude using gist (product_id with =, valid_during with &&) 
```

## 无穷

Postgres 可以将日期与无穷大进行比较，而不是要求遥远的“真实”日期。例如，当不使用日期范围时，您可以执行以下操作

```
insert into product_price 
  (product_id, price, valid_from, valid_until)
values 
  (1,  90.0, date '2014-01-01', date 'infinity'); 
```

## 可写公用表表达式

您可以在单个语句中删除、插入和选择：

```
with old_orders as (
   delete from orders
   where order_date < current_date - interval '10' year
   returning *
), archived_rows as (
   insert into archived_orders 
   select * 
   from old_orders
   returning *
)
select *
from archived_rows; 
```

以上将删除所有超过 10 年的订单，将它们移动到`archived_orders`表中，然后显示被移动的行。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2014-01-17T08:10:28.357

重命名旧数据库比 mysql 更方便。只需使用以下命令：

```
ALTER DATABASE name RENAME TO new_name 
```

# c# - 对于部分类的所有实例化，我们是否需要一个关键字 partial？

> ID：761336
> 
> 赞同：0
> 
> 时间：2009-04-17T17:17:32.743
> 
> 标签：c#, .net

假设我有一个从 c# 1.1 开始的旧类，我想向它添加更多方法和字段。现在我使用的是 2005，因此最合乎逻辑的解决方案是使用部分类。但是，似乎我必须假装对我定义它的文件中的每个类都偏爱这个词。

问题：

如果我无法更改旧文件中的类声明（添加部分单词），但仍想为其添加方法，我该怎么办？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-17T17:20:57.823

好吧，首先，是的，您确实需要在同一个命名空间下对所有涉及的类使用 partial 关键字。这将告诉编译器这些是将放在一起的同一类的部分。

现在，如果你真的不能改变旧类，你可以做的一件事就是继承你的旧类：

```
public class NewClass : OldClass 
```

...因此您可以扩展 OldClass 的功能。

您也可以选择仅使用旧类某种包装器，作为属性/属性：

```
public class NewClass
{
    public OldClass MyClass { get; set; } //.NET 3.5 / VS2008

    private OldClass _oldClass; //.NET 2.0 / VS2005
    public OldClass MyClass
    {
       get { return _oldClass; }
       set { _oldClass = value; }
    }
} 
```

...甚至是通用的：

```
public class NewClass<T> where T: OldClass //applicable in both versions 
```

扩展方法的建议也将起作用：

```
public void NewMethod1(this OldClass, string someParameter){}  //available only in .NET 3.5/VS2008 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-17T17:20:25.123

你应该从中得到。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T17:20:40.177

好吧，总是有扩展方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T17:22:15.400

这是我的订单：

1.  您是否可以使用扩展方法？如果您使用的是 VS2005，则可能不是。
2.  然后，您可能必须从该类继承以添加更多方法。
3.  如果该类是密封的，那么您需要使用“组合模式”将您的类包装到另一个类中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-17T17:22:31.577

你什么也做不了。您无权编辑旧文件，因此您无法向该文件添加成员。您也不能添加`partial`关键字并将成员添加到另一个文件中。

唯一的出路可能是编写扩展方法（需要 C# 3.0）或创建派生类。两种解决方案都不会（真的）修改原始类。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-17T17:22:46.100

如果您使用的是 VS2005 并且无法修改旧类，那么您真的无能为力。如果您使用的是 VS2008，您可以使用扩展方法来“模拟”添加新类，但 2005 中没有任何帮助。

如果可能的话，你唯一可能的选择是子类化并以这种方式添加新方法。可能不会解决您遇到的问题。

为什么不能更改旧文件？这似乎相当极端。

# java - 分配布局时出错：无法共享 BoxLayout

> ID：761341
> 
> 赞同：122
> 
> 时间：2009-04-17T17:18:13.587
> 
> 标签：java, swing, layout, boxlayout

我有这个 Java`JFrame`类，我想在其中使用 boxlayout，但我收到一条错误消息`java.awt.AWTError: BoxLayout can't be shared`。我见过其他人有这个问题，但他们通过在内容窗格上创建 boxlayout 来解决它，但这就是我在这里所做的。这是我的代码：

```
class EditDialog extends JFrame {
    JTextField title = new JTextField();
    public editDialog() {
        setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
        setTitle("New entity");
        getContentPane().setLayout(
            new BoxLayout(this, BoxLayout.PAGE_AXIS));
        add(title);
        pack();
        setVisible(true);
    }
} 
```

* * *

## 回答 #1

> 赞同：187
> 
> 时间：2009-04-17T17:26:04.690

您的问题是您正在`BoxLayout`为`JFrame`( `this`) 创建一个，但将其设置为`JPanel`( `getContentPane()`) 的布局。尝试：

```
getContentPane().setLayout(
    new BoxLayout(getContentPane(), BoxLayout.PAGE_AXIS)
); 
```

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2010-07-27T19:30:40.753

我也发现了这个错误：

```
JPanel panel = new JPanel(new BoxLayout(panel, BoxLayout.PAGE_AXIS)); 
```

将 JPanel 传递给 BoxLayout 时，它尚未初始化。所以像这样拆分这一行：

```
JPanel panel = new JPanel();
panel.setLayout(new BoxLayout(panel, BoxLayout.PAGE_AXIS)); 
```

这将起作用。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2011-09-07T20:46:06.910

我认为从前面的答案中要强调的一件重要的事情是 BoxLayout 的目标（第一个参数）应该与调用 setLayout 方法的容器相同，如下例所示：

```
JPanel XXXXXXXXX = new JPanel();
XXXXXXXXX.setLayout(new BoxLayout(XXXXXXXXX, BoxLayout.Y_AXIS)); 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2017-12-13T05:19:06.610

如果您正在使用`JFrame`类似的布局：

```
JFrame frame = new JFrame();
frame.setLayout(new BoxLayout(frame, BoxLayout.Y_AXIS));
frame.add(new JLabel("Hello World!")); 
```

控件实际上是被添加到的，`ContentPane`所以它看起来像是在`JFrame`和之间“共享”的`ContentPane`

改为这样做：

```
JFrame frame = new JFrame();
frame.setLayout(new BoxLayout(frame.getContentPane(), BoxLayout.Y_AXIS));
frame.add(new JLabel("Hello World!")); 
```

# django - Django QuerySet 顺序

> ID：761352
> 
> 赞同：20
> 
> 时间：2009-04-17T17:20:58.587
> 
> 标签：django, django-models

我对 django 和 python 都是新手，但我开始掌握一些东西。我认为。

我有这个问题，我似乎无法找到答案。（虽然我认为它真的很简单，限制因素是我的谷歌技能和缺乏 python/django 知识）

场景：

用户可以选择在他或她选择的任意数量的商店中接收临时职位空缺。

我想提供一个仅按 DateField 排序的即将到来的职位空缺 (StoreEvents) 列表。

```
Example: 
    Store A - 2009-04-20 
    Store B - 2009-04-22
    Store A - 2009-04-23 
```

Atm 我坚持首先按商店排序然后按日期显示数据，因为我显然是通过 Store 模型访问 StoreEvents。

```
Example:
    Store A - 2009-04-20
    Store A - 2009-04-23
    Store B - 2009-04-22 
```

所以我的问题是：是否可以创建一个看起来像第一个示例的 QuerySet，我该怎么做？

相关模型的示例包括：

```
class Store(models.Model):

class StoreEvent(models.Model):
    info = models.TextField()
    date = models.DateField()
    store = models.ForeignKey(Store, related_name='events')

class UserStore(models.Model):
    user = models.ForeignKey(User, related_name='stores')
    store = models.ForeignKey(Store, related_name='available_staff') 
```

编辑：

以下 SQL 可以解决问题，但我仍然不知道如何在 django 中执行此操作：

```
SELECT *
FROM store_storeevent
WHERE store_id
IN (
    SELECT store_id
    FROM profile_userstore
    WHERE user_id =1
)
ORDER BY date 
```

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-04-17T17:41:05.840

所有用户的按日期排序：

```
queryset = StoreEvent.objects.all().order_by('-date') 
```

按用户过滤：

```
queryset = StoreEvent.objects.filter(stores__user=request.user).order_by('-date') 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-18T10:41:09.570

谢谢各位大神帮忙，终于搞定了：

```
qs = StoreEvent.objects.filter(
    store__in=Store.objects.filter(
        available_staff__in=UserStore.objects.filter(user=user)
    )
).order_by('date') 
```

它会产生 3 个 SQL SELECT，但可以解决问题......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T18:07:44.747

```
queryset = StoreEvent.objects.filter(store__in=UserStore.objects.filter(user__id=1).store).order_by('store__name', '-date') 
```

或更优雅地

```
user = User.objects.get(username="foo")
user_stores = user.stores.all()

store_events = StoreEvent.objects.filter(store__in=user_stores).order_by('store__name', '-date') 
```

# silverlight-2.0 - Silverlight 2 中的最后一步

> ID：761354
> 
> 赞同：1
> 
> 时间：2009-04-17T17:21:14.547
> 
> 标签：silverlight-2.0, publishing, finalize

我一直在开发多个 silverlight 应用程序，但到目前为止，当我从 Visual Studio 测试它们时，它们才在我的系统中运行。现在我正准备推出它，我无法弄清楚完成它的步骤。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-21T23:30:25.530

查看这两个链接：

[http://blogs.msdn.com/tims/archive/2008/03/18/configuring-a-web-server-to-host-silverlight-content.aspx](http://blogs.msdn.com/tims/archive/2008/03/18/configuring-a-web-server-to-host-silverlight-content.aspx) [http://learn.iis.net/page.aspx /262/银光/](http://learn.iis.net/page.aspx/262/silverlight/)

基本上，您需要确保您的网络主机可以运行 silverlight，然后部署 XAP 文件（在您的 ClientBin 文件夹中）

在要引用 silverlight 控件的页面上，复制示例 silverlight 对象容器和 javascript 引用 (silverlight.js)，然后确认 xap 文件的路径正确。

# javascript - 如何使用 Javascript 或 JQuery 在父项中显示子记录数

> ID：761358
> 
> 赞同：1
> 
> 时间：2009-04-17T17:21:38.850
> 
> 标签：javascript, jquery

```
<html>
<head>
    <script src="some.js" type="text/javascript"></script>
    <script type="text/javascript">
        //javascript-jquery code
    </script>
</head>
<body>
    <table>
        <tr id="parent_1">
            <td>Parent 1</td>
        </tr>
        <tr class="child">
            <td>Child 1</td>
        </tr>
        <tr class="child">
            <td>Child 2</td>
        </tr>
        <tr id="parent_2">
            <td>Parent2</td>
        </tr>
    </table>
</body>
</html> 
```

我希望“父 1”文本更改为“父 1(2)”，其中“2”是使用 Javascript 或 Jquery 的给定父级的子级数。这怎么可能？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-17T17:30:21.747

嗯。艰难的一个。:) 这应该这样做，但是：

```
$(function() {
    $("tr[id^='parent_']").each(function() {
        var count = 0;
        $(this).nextAll('tr').each(function() {
            if($(this).hasClass('child')) {
                count++;
            } else {
                return false;
            }
        });
        $(this).find('td').append(' (' + count + ')');
    });
}); 
```

[测试和工作](http://jsbin.com/izeze)。

* * *

尽管上述方法有效，但效率不高。我还想花一点时间建议您稍微更改一下 HTML 的格式。您希望使您的代码在语义上与其所包含的内容尽可能相关。拥有一张混合父母和孩子的大桌子并不是实现这一目标的最佳方式。我不确定你的用例是什么，但考虑做这样的事情：

```
<ul>
  <li id="parent_1">
    <span>Parent 1</span>
    <ul>
      <li>Children 1</li> 
      <li>Children 2</li>
      <li>Children 3</li>
    </ul>
  </li>
  <li id="parent_2">
    <span>Parent 2</span>
    <ul>
      <li>Children 1</li> 
    </ul>
  </li>
  <li id="parent_3">
    <span>Parent 3</span>
    <ul>
      <li>Children 1</li> 
      <li>Children 2</li>
    </ul>
  </li>
</ul> 
```

你仍然可以设置它的样式，但是你想给它你想要的外观，虽然如果你真的要显示关于父母和孩子的表格数据，这可能不是那么容易。

但是，使用该代码，您可以更高效地简化上述代码：

```
$('ul > li').each(function() {
    var count = $(this).find('li').length;
    $('span', this).append(' (' + count + ')');
}); 
```

如果无法/不希望将代码从表更改为列表，但您可以访问可能生成此表的服务器端代码，那么您至少可以通过为所有孩子提供具有 ID 的类来使事情变得更容易父母，并给所有父母一个共同的班级：

```
<table>
    <tr id="parent_1" class="parent">
        <td>Parent 1</td>
    </tr>
    <tr class="child parent-1">
        <td>Child 1</td>
    </tr>
    <tr class="child parent-1">
        <td>Child 2</td>
    </tr>
    <tr id="parent_2" class="parent">
        <td>Parent2</td>
    </tr>
    <tr class="child parent-2">
        <td>Child 1</td>
    </tr>
    <tr id="parent_3" class="parent">
        <td>Parent3</td>
    </tr>
    <tr class="child parent-3">
        <td>Child 1</td>
    </tr>
    <tr class="child parent-3">
        <td>Child 2</td>
    </tr>
    <tr class="child parent-3">
        <td>Child 3</td>
    </tr>
</table> 
```

这将允许您执行此操作，比原始解决方案快得多：

```
$('tr.parent').each(function() {
    var id = $(this).attr('id').split('_').pop();
    var count = $('tr.parent-' + id).length;
    $(this).find('td').append(' (' + count + ')');
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T17:34:25.480

给父母一个“父母”的班级，让它更容易一些。

```
$('tr.parent').each(function() {
  var next = $(this).next();
  var count = 1;
  while (next = $(next).next() && $(next).hasClass('child')) {
    count++;
  }
  $(this).find('td').append(' (' + count + ')');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T17:38:18.030

因为您的 html 实际上并没有将子节点放置在标记中的父节点下方，所以最简单的方法是遍历所有 TR 并为每个父节点计算 class="child"。Paolo 的代码应该为您执行此操作。

最好将子节点定义为父 td 的实际子节点，然后 jquery 可以为您简化事情。如果你有能力像这样重构你的表：

```
<table>
<tr id="parent_1">
<td>Parent 1
<table>
<tr class="child">
<td>Child 1</td>
</tr>
<tr class="child">
<td>Child 2</td>
</tr>
</table>
</td>
</tr>
<tr id="parent_2">
<td>Parent2</td>
</tr>
</table> 
```

那么你可以编写更简单的jquery，如：

```
$("td").each(function(){$(this).val($(this).val() + "(" + $(this).find("td").length + ")"); }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-18T04:27:01.090

我发现复杂的 jQuery 选择器和循环非常有趣，因为 DOM 已经有一个非常好的“rowIndex”属性，您可以使用它来简单且更有效地获取子节点的数量：

```
var p1= document.getElementById('parent_1');
var p2= document.getElementById('parent_2');

var childn= p2.rowIndex-p1.rowIndex-1;
p1.cells[0].firstChild.data+= ' ('+childn+')'; 
```

# ruby-on-rails - 奇怪的 Rails 路由行为：在嵌套资源中交换了两个 id

> ID：761360
> 
> 赞同：3
> 
> 时间：2009-04-17T17:22:04.323
> 
> 标签：ruby-on-rails, routing

我在我的应用程序中设置了以下路由（表单属于站点）：

```
map.resources :sites do |site| 
 site.resources :forms
end 
```

但是，当我尝试使用帮助程序（例如

```
edit_site_form_path(form) 
```

或者

```
<%= link_to 'Show', [:site, form] %> 
```

我的 URL 出现的 ID 已交换（ /sites/5/forms/1 ），其中 5 是表单 ID，1 是站点 ID。这是来自页面/sites/1。

帮助（？）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-17T17:32:28.183

该`edit_site_form_path`方法必须有两个参数，site_id 和 form_id。因此，在您的示例中，您只传递了 form_id。第一个参数是方法中最先出现的模型，在本例中是`site`. 第二个参数是form_id。

改进后的路径方法可能如下所示

```
 edit_site_form_path(form.site, form) 
```

（假设你有一个`Form`模型`belongs_to :site`）

# python - 抑制python字符串中的u'前缀表示unicode'

> ID：761361
> 
> 赞同：49
> 
> 时间：2009-04-17T17:22:04.667
> 
> 标签：python, string, unicode, printing

有没有办法在 python 中全局抑制 unicode 字符串指示符？我在一个应用程序中专门使用 unicode，并且做了很多交互的东西。在我的所有调试输出中显示 u'prefix' 是不必要且令人讨厌的。可以关闭吗？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-04-17T17:42:38.830

您可以使用 Python 3.0.. 默认字符串类型是 unicode，因此`u''`不再需要前缀..

简而言之，没有。您不能将其关闭。

`u`来自该方法`unicode.__repr__`，该方法用于在 REPL 中显示内容：

```
>>> print repr(unicode('a'))
u'a'
>>> unicode('a')
u'a' 
```

如果我没记错的话，你不能在不重新编译 Python 的情况下覆盖它。

解决这个问题的最简单方法是简单地打印字符串..

```
>>> print unicode('a')
a 
```

如果您使用`unicode()`内置函数来构造所有字符串，则可以执行类似..

```
>>> class unicode(unicode):
...     def __repr__(self):
...             return __builtins__.unicode.__repr__(self).lstrip("u")
... 
>>> unicode('a')
a 
```

..但不要那样做，这太可怕了

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2012-11-06T07:05:49.537

我有一个需要删除 u 前缀的情况，因为我正在使用 python 设置一些 javascript 作为 html 模板的一部分。一个简单的输出将 u 前缀留在 dict 键中，例如

```
var turns = [{u'armies':2...]; 
```

这破坏了javascript。

为了获得所需的输出 javascript，我使用 json python 模块为我编码字符串：

```
turns = json.dumps(turns) 
```

这在我的特定情况下可以解决问题，并且由于键都是 ascii，因此无需担心编码。您可能可以将此技巧用于调试输出。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-05-11T11:54:37.980

```
from __future__ import unicode_literals 
```

从 Python 2.6（2008 年 10 月 1 日发布）开始可用。它在 Python 3 中是默认的。

它允许`u''`在源代码中省略前缀，尽管它不会改变`repr(unicode_string)`这会产生误导。

您可以在 Python REPL 中覆盖`sys.displayhook()`，以显示您喜欢的对象。您还可以覆盖`__repr__`您自己的自定义对象。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2011-04-30T05:15:38.133

`str( text )`实际上，当您不能 100% 确定您的 python 的默认编码和字符串的确切内容时，使用是一个有点坏的主意——后者对于从 Internet 获取的文本来说是典型的。此外，取决于您想要做什么，使用`print text.encode( 'utf-8' )`或`print repr( text.encode( 'utf-8' ) )`可能会产生令人失望的结果，因为您可能会得到一个充满不可读代码点的渲染，例如`\x3a`.

我认为最佳方案实际上是利用支持 unicode 的命令行（在 windows 下很难，在 linux 下很容易）并从 python 2.x 切换到 python 3.x。新的 python 3 系列提供的文本与字节处理的易用性和清晰度确实是您可以期待的一大收获。这确实意味着您将不得不花一点时间来学习“字节”和“文本”之间的区别并掌握字符编码的概念，但是那段时间最好花在 python 3 环境中，因为 python 对这些的新方法与 python 2 所提供的相比，令人烦恼的问题更清晰，更不容易出错。回想起来，我什至会称 python 2 处理 unicode 的方法有问题，

**编辑我刚刚在 SO 上**[的相关讨论](https://stackoverflow.com/questions/571694/what-factors-make-php-unicode-incompatible)中停下来，发现这条评论是关于这些天 php 似乎解决 unicode / 编码问题的方式：

> 就像老鼠想吃大象一样。通过将 Unicode 构建为 ASCII 的扩展（我们有普通的字符串，我们有 mb_strings），它会让事情变得错误，并且在处理需要超过一个字节的有趣曲线的字符时需要什么特殊情况。如果您将 Unicode 视为为您需要的任何字符提供抽象空间，则 ASCII 可以容纳在其中，无需将其视为特殊情况。

我在这里引用这个是因为根据我的经验，90% 的 SO python+unicode 主题似乎来自那些曾经对 ascii 或 latin-1 很好的人，被他们通常设置中不支持的偶尔字符所困扰，然后基本上只是想摆脱它。你在切换到 python 3 时所做的正是上面的评论者建议做的：不要将 unicode 视为 ascii 的令人烦恼的扩展，而是开始将 ascii（以及你将遇到的几乎任何其他编码）视为子集（s ) 的 unicode。

诚然，unicode v6 肯定不是编码领域的最后一个词，但它已接近 2011 年的通用性。习惯它吧。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2016-08-01T15:31:56.293

什么似乎对我有用：

```
import ast
import json
j = json.loads('{"one" : "two"}')
j
dd = {u'one': u'two'}
dd
# to get double quotes
json.dumps(j,  encoding='ascii')
json.dumps(dd, encoding='ascii')
# to get single quotes
str(ast.literal_eval(json.dumps(j,  encoding='ascii')))
str(ast.literal_eval(json.dumps(dd, encoding='ascii'))) 
```

输出：

```
>>> {u'one': u'two'}
>>> {u'one': u'two'}
>>> '{"one": "two"}'
>>> '{"one": "two"}'
>>> "{'one': 'two'}"
>>> "{'one': 'two'}" 
```

以上适用于字典和 JSON 对象，这是不言而喻的。

对于一个字符串，包装在 str() 中似乎对我有用。

```
s=u'test string'
s
str(s) 
```

输出：

```
>>> u'test string'
>>> 'test string' 
```

Python版本：2.7.12

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-07-18T00:19:01.467

我知道这不是一个全局选项，但您也可以通过将字符串放在 str() 函数中来抑制 Unicode u。

所以一个 Unicode 派生列表看起来像：

```
>>> myList=[unicode('a'),unicode('b'),unicode('c')]
>>> myList
[u'a', u'b', u'c'] 
```

会变成这样：

```
>>> myList=[str(unicode('a')),str(unicode('b')),str(unicode('c'))]
>>> myList
['a', 'b', 'c'] 
```

这有点麻烦，但可能对某些人有用

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2016-03-07T17:37:57.570

万一你得到这样的东西，`u['hello']`那么你必须打印一个数组。打印`str(arr[0])`，你很高兴。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-04-28T17:16:02.330

不确定 unicode，但通常您可以调用`str.encode()`将其转换为更合适的形式。例如，在 Python 3.0+ 中捕获的子进程输出将其捕获为字节流（前缀 'b'），并且 encode() 修复为常规字符串形式。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-04-28T17:14:03.367

尝试以下

> 打印 str(result.url)

可能是您的默认编码已更改。

您可以使用以下内容检查您的默认编码：-

```
> import sys
> print sys.getdefaultencoding()
> ascii 
```

默认值应为 ascii，这意味着 u'string' 应打印为 'string' 但您的可能已被修改。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-04-30T04:06:41.960

你必须使用`print str(your_Variable)`

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-12-24T22:29:10.063

如果您不想更新到 Python 3，则可以使用子字符串。例如，假设原始输出是 (u'mystring',)。让我们假设变量 row 包含没有 unicode 前缀的“mystring”字符串。然后你会想做这样的事情：

```
temp = str(row); #str is not necessary, but probably good practice
temp = temp[:-3];
print = temp[3:]; 
```

# deployment - 将网站部署为持续集成构建的一部分

> ID：761363
> 
> 赞同：1
> 
> 时间：2009-04-17T17:22:08.613
> 
> 标签：deployment, continuous-integration

我开始对我们的网站进行持续集成构建。我目前有 CI 服务器将站点发布到一个文件夹。下一步是将文件部署到我们的站点。

该站点设置在我们的持续集成服务器上，因此我们可以看到构建的结果。该站点设置为 IIS 中默认网站下的虚拟目录。我正在努力解决如何将构建文件部署到站点。如果我将文件复制/xcopy/robocopy 文件到虚拟目录的物理目录，我应该停止并启动服务器上的 Web 发布服务作为脚本的一部分吗？我应该回收应用程序池吗？

稍后将构建移动到 QA 服务器或生产服务器怎么样？你会用什么工具来做这个？

预先感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T17:27:17.370

如果它是一个 ASP.NET 应用程序，xcopying 将修改 web.config，这将卸载应用程序域，因此您不需要停止和启动 Web 发布服务，也不需要回收应用程序池。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T17:27:40.287

看看 Capistrano，它是一个专门用于将应用程序部署到服务器的 Ruby 工具。它从 SCM 中检查您的代码并将其部署到您的服务器。您可以设置多个服务器环境并告诉它要部署到哪个环境。一旦您的基本部署方案正常工作，就很容易添加新服务器。

查看 peepcode 截屏视频，了解 Capistrano 的工作原理。

*   [http://www.capify.org/](http://www.capify.org/)
*   [http://peepcode.com/products/capistrano-2](http://peepcode.com/products/capistrano-2)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-14T07:47:43.873

查看 Visual Studio 发布管理，您可以在这里找到它：[www.visualstudio.com](http://www.visualstudio.com/en-us/explore/release-management-vs.aspx)

Microsoft 从 InRelease 购买产品。它将通过您的所有服务器管理您的解决方案，直至生产。您可以在每台服务器上设置由不同用户完成的审批，或者您可以自动化整个过程。

开始工作有点麻烦，由于它仅作为 Microsoft 产品于 2013 年 11 月 15 日发布，因此它相对较新且未记录。但是，您可以从[www.colinsalmcorner.com](http://www.colinsalmcorner.com/)和本文档[download.microsoft.com](http://download.microsoft.com/download/B/C/8/BC8558E1-192E-4286-B3B0-320A8B7CE49D/Embracing%20Continuous%20Delivery%20with%20Release%20Management%20for%20Visual%20Studio%202013.docx)获取信息。

我现在已经完全集成了它，它让生活变得如此简单。只需登录 Web 界面即可批准我分配的部署，并且一切顺利。它与 TFS 高度集成。

# linux - 线程好用吗？

> ID：761371
> 
> 赞同：2
> 
> 时间：2009-04-17T17:23:44.367
> 
> 标签：linux, multithreading, winapi

我有一组非常昂贵但几乎都是独立的操作。其中一些依赖于一些“全局”状态或数据，但都是只读的。我相当肯定，这些操作本身都可以并行完成，但是所有操作都需要在程序进展到某个点之前完成。

在这里增加多线程的额外工作和危险是否值得，尤其是因为主线程无论如何都必须阻塞和等待？

另一个问题是这个应用程序很可能必须在 Windows 和 Linux 上运行，我不确定添加使用两个不同线程系统的代码是否值得复杂。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-17T17:26:39.710

那么，第一个问题是：你真的有问题吗？

听起来您当然可以安全有效地合理地并行化它，但是如果等待操作以串行方式执行实际上不是*问题*，则可能不值得担心。

例如，如果这是一个在夜间执行的批处理应用程序，它可能不值得做。但是，如果这是一个面向用户的应用程序并且用户已经厌倦了等待，那么听起来使用多线程来解决这个问题是值得的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-17T17:29:37.113

除非您的工作线程是一些无法获得并行化好处的病态案例，否则它们并行完成的速度可能比串行完成得快。因此，它是否值得的问题变成了在上下文中节省了多少时间以及对您来说价值多少的问题。如果有一个坐立不安的用户等待鼠标点击做某事，那么节省 10 秒中的 5 秒是一个有意义的好处。在 cron 工作中节省同样的费用，但不是很多。

If you think there's a decent chance that it'll do something useful for you, build a quick test version and **profile it**.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-17T17:27:27.433

您所描述的是并发术语中的[障碍](http://en.wikipedia.org/wiki/Barrier_(computer_science))，并且在许多类型的应用程序中都非常流行。

如果没有更多细节，很难说它是否适合您的应用程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T17:28:06.527

如果您有多核处理器，那么您可能能够让线程同时运行并通过并行性获得加速。

但是，我相信线程的主要用途是允许更容易编写多个逻辑动作链，尤其是当它们涉及等待外部事件时，例如用户输入或 I/O 完成。

# javascript - 使用 innerHTML 输出

> ID：761374
> 
> 赞同：0
> 
> 时间：2009-04-17T17:24:56.423
> 
> 标签：javascript

我需要输出其中包含 HTML 代码的 JavaScript 变量的内容：

```
var jsVar = '<div>
<p> Sample text </p>
<img src="some image.jpg"  alt="" />
<div>'; 
```

我想将它添加到页面上的对象中，使用`innerHTML`. 我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-17T17:28:24.857

```
var element = document.getElementById("myElementId");
element.innerHTML = jsVar; 
```

这是假设您通过[getElementById()](https://developer.mozilla.org/En/Document.getElementById)获取元素；除此之外，还有很多方法可以在 JavaScript 中获取元素，例如[getElementsByTagName()](https://developer.mozilla.org/en/DOM/element.getElementsByTagName)（它返回一个元素数组）或通过侦听将自身作为参数传入的元素上的事件。

此外，您将字符串加载到 jsVar 的方式目前不起作用。您要么需要将其全部放在一行上，要么连接多个字符串，如下所示：

```
// Method 1
var jsVar = '<div><p> Sample text </p><img src="some image.jpg"  alt="" /><div>';

// Method 2
var jsVar = '<div>' +
    '<p> Sample text </p>' +
    '<img src="some image.jpg"  alt="" />' +
    '<div>'; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T17:27:51.800

```
var element= document.getElementById("elementID");
element.innerHTML = someHTMLstring; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-17T17:28:17.227

```
document.getElementById('id').innerHTML = jsVar; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T17:32:04.380

另请注意，您必须`\n`在 JavaScript 中使用而不是换行符：

```
var jsVar = '<div>\n<p> Sample text </p>\n<img src="some image.jpg"  alt="" />\n<div>'; 
```

如果你不这样做，你会得到一个“ `unterminated string literal`”错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-17T17:41:09.957

您分配的字符串不能跨越多行：

这不起作用

```
ttt = "ab
c"; 
```

这确实

```
ttt = "ab" +
      "c"; 
```

最好是转义所有特殊字符，并去掉字符串中的换行符（我不喜欢用 ' 完成的字符串，尽管这是个人的事情 :)。

```
var jsVar = "<div><p> Sample text </p> <img src=\"some image.jpg\"  alt=\"\" /><div>"; 
```

# asp.net - 检查连接在 ASP.NET 中是否处于活动状态

> ID：761376
> 
> 赞同：1
> 
> 时间：2009-04-17T17:25:14.583
> 
> 标签：asp.net, iis, comet

我在用 ASP.NET 编写的[Comet应用程序上工作。](http://en.wikipedia.org/wiki/Comet_(programming))有一组活动连接上下文（[HttpContext](http://msdn.microsoft.com/en-us/library/system.web.httpcontext.aspx)）。并且有一个线程应该定期遍历集合并检查它们的状态。所以应用程序架构不是每个请求的线程。

检查连接是否处于活动状态（未被远程主机关闭）的最佳方法是什么？

我找到了这个：

```
context.Response.Write(' ');
context.Response.Flush();

if (!context.Response.IsClientConnected)
{
    // ...
} 
```

但这不是一个好的解决方案，因为它需要一个线程时间来处理（Flush() 是阻塞操作）。我需要对许多并发连接运行非常快并且不使用阻塞操作的解决方案。

也许有一些 IIS 或 ASP.NET 功能允许以这种方式监视连接？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-18T11:18:45.220

最简洁的答案是不。ASP.NET 知道为 IsClientConnected 返回 false 的唯一方法是用户是否对服务器进行了不同的调用，或者之前调用了 Response.Close。根据我的经验，用户很可能关闭连接并仍然让 IsClientConnected 返回 true。只要想一想正在进行的底层 HTTP 通信，您就会明白为什么。

你想达到什么目的？

# macos - java.io.IOException：作业失败！使用 hadoop-0.19.1 在我的 osx 上运行示例应用程序时

> ID：761377
> 
> 赞同：1
> 
> 时间：2009-04-17T17:25:15.190
> 
> 标签：macos, hadoop, ioexception, java-6

```
bash-3.2$ 回声 $JAVA_HOME
/System/Library/Frameworks/JavaVM.framework/Versions/1.6/Home
bash-3.2$ bin/hadoop dfs -copyFromLocal conf /user/yokkom/input2
bash-3.2$ bin/hadoop jar hadoop-*-examples.jar grep input2 output 'dfs[az.]+'
2017 年 9 月 4 日 10:09:32 信息 mapred.FileInputFormat：要处理的总输入路径：10
2017 年 9 月 4 日 10:09:33 信息 mapred.JobClient：正在运行的作业：job_200904171309_0001
java.io.IOException：作业失败！
        在 org.apache.hadoop.mapred.JobClient.runJob(JobClient.java:1232)
        在 org.apache.hadoop.examples.Grep.run(Grep.java:69)
        在 org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:65)
        在 org.apache.hadoop.examples.Grep.main(Grep.java:93)
        在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        在 sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        在 java.lang.reflect.Method.invoke(Method.java:597)
        在 org.apache.hadoop.util.ProgramDriver$ProgramDescription.invoke(ProgramDriver.java:68)
        在 org.apache.hadoop.util.ProgramDriver.driver(ProgramDriver.java:141)
        在 org.apache.hadoop.examples.ExampleDriver.main(ExampleDriver.java:61)
        在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        在 sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        在 java.lang.reflect.Method.invoke(Method.java:597)
        在 org.apache.hadoop.util.RunJar.main(RunJar.java:165)
        在 org.apache.hadoop.mapred.JobShell.run(JobShell.java:54)
        在 org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:65)
        在 org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:79)
        在 org.apache.hadoop.mapred.JobShell.main(JobShell.java:68)

```

有谁知道为什么会这样？同样的工作在 linux 机器上运行得很好。并且，在“作业失败”发生后，整个 Hadoop 集群停止响应。

我的 MacOS 版本是 10.5.6。

*编辑*hadoop-0.20.1 的相同结果

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T20:25:20.523

我用谷歌搜索它，同样的错误（在完全相同的行）之前发生过。[在这里](http://www.mail-archive.com/nutch-user@lucene.apache.org/msg13346.html)和[这里](http://www.txtob.com/bbs/dispbbs.asp?boardID=27&ID=1046&page=1)阅读它。

第二个链接建议以下内容：

*   删除conf/log4j.properties查看详细报告
*   尝试增加堆内存（使用 -Xms 和 -Xmx 开关）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T17:14:30.857

是的 grep 会占用内存，尤其是在大型数据集上。你的输入有多大？顺便说一句，还有烫发记忆。

[http://java.sun.com/javase/technologies/hotspot/vmoptions.jsp](http://java.sun.com/javase/technologies/hotspot/vmoptions.jsp)

有一些有趣的开关可以在 OutOfMemory 上执行自定义行为，但是我怀疑 jobRunner 只是在到达 VM 之前捕获所有内容。您可能需要另一种方式来调试它。

# php - 公司与员工 ID 的困境

> ID：761378
> 
> 赞同：2
> 
> 时间：2009-04-17T17:25:29.900
> 
> 标签：php, mysql, database, database-design

我的 SQL 数据库中有两个表：

公司：

*   ID（自动增量）
*   姓名
*   地址
*   ...

雇员：

*   ID（自动增量）
*   公司_id
*   **internal_id**
*   姓名
*   姓

问题是我想要一个与他们所属**公司相关的员工 ID（internal_id）。**我遇到了这个困境，因为我一直在寻找实现它的最干净的方法。

一种选择是从员工 WHERE company_id = X 中选择一种 SELECT MAX(internal_id)，但问题是，如果我碰巧删除了最后一个员工，下一个员工将使用下一个员工的 ID 创建。

有什么想法或建议吗？

**PD：我为什么要这样做的原因是我不希望来自 X 公司的用户创建一个 ID=2000 的员工，而在他的公司创建的最后一个员工是 1532。这通常会发生在一个系统中，Y 公司和 Z 公司也在同一系统上创建员工。我希望这个 ID 不用作外键，而是让它供内部（甚至是文档或报告）使用。**

**PD2：在这种情况下，员工永远不必更换公司**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-17T17:35:15.807

不，不要那样做！这将在您的数据库中产生许多问题（您必须担心并发问题）以解决一些不是问题并且实际上设计正确的问题。id 应该是无意义的，并且差距是不重要的。您需要一个关于employeeid/companyid 组合的唯一索引，以确保没有将任何员工分配给多个公司。

您的员工 ID 应该是永远不需要更改的东西。如果您制作了某种基于公司的愚蠢 ID，而公司 A 收购了公司 B 并成为公司 C，那么您最终不得不更改所有 ID 和所有相关表。在您当前的设计中，您只需要更新公司代码而不是相关表。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-17T17:35:28.007

创建一个单独的表：

```
CREATE TABLE t_identity (company INT NOT NULL PRIMARY KEY, id INT NOT NULL) 
```

并发出：

```
INSERT
INTO    t_identity (@company, 1)
ON DUPLICATE KEY UPDATE
SET     id = id + 1 
```

在插入新员工之前。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-17T17:33:14.563

这里有很多关于创建与主键无关的“业务”ID 或数字的问题。

在您的情况下，我将在 Company 表“NextEmployeeID”上创建一个列，然后在创建新员工时只需检索该值并增加它。

现在我让你来弄清楚如果员工换公司会发生什么。:-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T17:31:10.310

您永远不应该从关系数据库中删除一行。您应该使该员工过期（IE，Set Employee.ActiveFlag = 0）

因此，如果您有一个 internal_id (int) 并执行了 (SELECT MAX(internal_Id) +1 FROM Employees WHERE Company_Id = [parameterCompanyID])，那么这将正常工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-17T17:31:24.553

如果您打算将员工 ID 用作 fk，您真的要删除它以及他们在数据库中的所有工作吗？在员工中创建一个状态字段并将其设置为“A”ctive 或“I”nactive。如果 EmployeeID 在所有公司中保持唯一，那么它是最好的，所以让它自动递增。永远不要让用户看到 ID，只让他们看到名称。

也不要将列命名为 ID、CompanyID 或 EmployeeID，这样会更具可读性和更易于搜索。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-17T17:31:38.687

为什么不对您的 internal_ids 使用 GUID？这样，您总是可以只插入而不用担心 ID 冲突。

鉴于您当前的结构，您将无法避免删除异常，但您确实不应该按照您建议的方式进行操作。为了可靠地获得“下一个数字”，您必须锁定表，这将导致各种错误。也许您可以为员工实施某种软删除，因为他们有时会来去匆匆。:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-17T17:56:00.750

正如 Quassnoi 建议的那样，我将创建一个单独的表，其中包含公司和当前最大序列号。但是我会将它包装在一个存储过程或 UDF 中（MySQL 是否执行 UDF？），它接受公司作为输入，增加当前值并返回增加的值。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-03-20T10:02:32.180

我宁愿为 3 个变量创建 3 列，并允许管理员修改数据库中的值！1\. 公司短代码（companyCode 即 COMP） 2\. 公司部门短代码（depCode 即 DEP） 3\. 公司起始计数值（compVal 即 00000） 现在当添加新员工时，我会加入所有变量，每次都增加和更新 compVal++！（即 COMP-DEP-0001）或者我们也可以使用员工 ID 添加 date()

# perl - 使用 Perl 打开文本文件并将其读入数组的最简单方法

> ID：761392
> 
> 赞同：20
> 
> 时间：2009-04-17T17:28:29.863
> 
> 标签：perl

向我拥有的每个脚本添加一个标准的 Perl 文件打开函数有点烦人：

```
sub openfile{
    (my $filename) = @_;
    open FILE,"$filename" or die $!;
    my @lines = <FILE>;
    return @lines;
} 
```

我可以创建一个 Perl 模块来执行此操作，但这太简单了，我相信应该已经有一个。

我正在尝试找到一种将文本文件读入数组的方法，但我似乎找不到可以完成这个简单任务的 Perl 模块......也许我看起来太努力了，它已经附带了标准 5.10 安装。

理想情况下，我相信它看起来像这样：

```
my @lines = Module::File::Read("c:\some\folder\structure\file.txt"); 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-04-17T20:41:26.997

你有几个选择，经典的 do 方法：

```
my @array = do {
    open my $fh, "<", $filename
        or die "could not open $filename: $!";
    <$fh>;
}; 
```

[IO::All](http://search.cpan.org/dist/IO-All/lib/IO/All.pod)方法：

```
use IO::All;

my @array = io($filename)->slurp; 
```

[File::Slurp](http://search.cpan.org/dist/File-Slurp/lib/File/Slurp.pm)方法：

```
use File::Slurp;

my @array = read_file($filename); 
```

可能还有更多，毕竟[TIMTOWDI](http://en.wikipedia.org/wiki/There_is_more_than_one_way_to_do_it)。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-04-17T17:32:37.327

这就是著名的“啜饮模式”：

```
 my @lines = <FILEHANDLE> ; 
```

您可能还会看到[Perl Slurp Ease](http://www.sysarch.com/Perl/slurp_article.html)

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-04-17T17:32:49.337

我想这就是你要找的

[文件::啜饮](http://search.cpan.org/~drolsky/File-Slurp-9999.13/lib/File/Slurp.pm)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-17T18:15:56.847

您可能还想考虑使用 Tie::File，尤其是当您正在读取较大的文件并且不想将整个文件读入内存时。它是一个核心模块。另外，请参阅[perlfaq5](http://perldoc.perl.org/perlfaq5.html#How-can-I-read-in-an-entire-file-all-at-once%3f)。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-04-17T20:28:09.433

还可以查看[Perl6::Slurp](http://search.cpan.org/dist/Perl6-Slurp/)，它实现了 Perl6 版本的 slurp，并在“Perl Best Practices”一书中推荐。

一些例子....

```
my @lines         = slurp 'filename';
my @lines_chomped = slurp 'filename', { chomp => 1 };
my @lines_utf8    = slurp 'filename', { utf8  => 1 }; 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-04-17T17:36:14.057

你已经掌握了一般技术，但我想说 Perl 有点不鼓励你这样做，因为在**很多**情况下你可以一次做一行做同样的事情，这本质上效率更高。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-17T18:56:52.553

为了快速和肮脏，我更喜欢使用`@ARGV`.

```
# Ysth is right, it doesn't automatically die; I need another line.
use 5.010;
use strict;
my @rows = do { 
    use warnings FATAL => 'inplace'; # oddly enough, this is the one. ??
    @ARGV='/a/file/somewhere';
    <>;
};
say q(Not gettin' here.); 
```

~~如果 perl* 无法打开文件，它会自动死掉。~~

* * *

* - 可执行文件，所以请不要大写。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-19T16:30:48.940

我会推荐一种面向对象的方法，它不需要 CORE 发行版之外的模块，并且可以在任何地方工作：

```
use strict;
use warnings;
use IO::File;
my $fh = IO::File->new("< $file");

foreach ($fh->getlines) {
    do_something($_);
}
$fh->close 
```

# visual-c++ - VC++ 链接器输出中的 /DISALLOWLIB 消息是什么意思？

> ID：761394
> 
> 赞同：3
> 
> 时间：2009-04-17T17:29:27.147
> 
> 标签：visual-c++

我正在使用 VC++ 2005 应用程序跟踪链接器错误。当我打开详细链接器输出时，我注意到大量这些消息：

已处理 /DISALLOWLIB:nafxcwd.lib

/DISALLOWLIB 开关究竟是什么意思？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-01-04T11:07:48.893

它阻止某些库与其他库一起使用。例如，该`msvcrtd.lib`库有一个不允许的条目`msvcrt.lib`（因为将该库的调试和发布版本放在同一个可执行文件中会导致各种问题）。

我不确定它实际上是一个链接器开关，尽管我从未尝试过它（在各种 Visual Studio 版本的任何链接器版本中都没有这样记录）。可以插入*：*

```
#pragma comment(linker, "/disallowlib:somelib.lib") 
```

在您的源文件中，因此链接器也可能允许它。您*确实*可以在图书馆内找到它。如果你执行：

```
dumpbin.exe /rawdata msvcrtd.lib 
```

你会看到类似的东西：

```
/disallowlib:libcmt.lib
/disallowlib:libcmtd.lib
/disallowlib:msvcrt.lib 
```

在输出中，这意味着“命令”是库内容本身的一部分。

# flash - 为什么 IE 中的 Z-Index 不能以它应该在 Flash 电影上的方式呈现？

> ID：761402
> 
> 赞同：6
> 
> 时间：2009-04-17T17:30:35.553
> 
> 标签：flash, internet-explorer, z-index, css-position

我正在一个有两个绝对定位的 div 的网站上工作......徽标和菜单（导航栏）

即使在多次尝试 z-index 操作之后，IE 也将它们都掩埋了。看在上帝的份上，为什么 IE 不能像 Firefox 甚至 Opera 一样好用？

更新.......

我忘了提到这些 div 位于 Flash 电影上。我怎么可能把它漏掉？！

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-20T22:16:13.110

如果您的 flash 电影正在掩埋您的其他内容，您可能会通过向嵌入对象添加额外的 param 元素来获得好运：

```
<param name="wmode" value="opaque" /> 
```

如需更长的答案，您可以查看[有关堆叠窗口/闪存内容的博客文章](http://blog.mediawhole.com/2008/11/stacking-windowed-elements-and-flash.html)。Adobe 也[有关于此问题的技术说明](http://kb2.adobe.com/cps/155/tn_15523.html)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-17T17:33:20.787

IE 有几个有据可查的 Z-index 错误。似乎 IE 为定位元素创建了一个新的堆叠上下文。见[这里](http://www.quirksmode.org/bugreports/archives/2006/01/Explorer_z_index_bug.html)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-17T17:46:31.443

这也是IE7中的一个问题。这是描述问题的链接：http: [//therealcrisp.xs4all.nl/meuk/IE-zindexbug.html](http://therealcrisp.xs4all.nl/meuk/IE-zindexbug.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-17T17:32:34.503

这是 IE6 的一个已知错误（我假设您正在使用）。这里有一些描述和一些帮助：[http ://www.last-child.com/conflicting-z-index-in-ie6/](http://www.last-child.com/conflicting-z-index-in-ie6/)

# flash - “使用 sIFR 3 渲染，修订版 436”显示为内联

> ID：761406
> 
> 赞同：0
> 
> 时间：2009-04-17T17:31:19.060
> 
> 标签：flash, sifr

我正在将客户站点升级到 rev。436 来自旧版本的 sIFR 3，并且无法在我的一生中使导出正常工作。当我在页面中或本地（通过 file://）查看 .swf 时，我收到以下消息：

> 使用 sIFR 3 渲染，修订版 436

但是，如果我直接查看文件（例如[http://localhost/path/to/font.swf](http://localhost/path/to/font.swf)），则消息是：

> 电影 (436) 与 sifr.js (未定义) 不兼容。使用未定义的电影。

我通常不是这个 sIFR 愚蠢的。关于我应该在哪里看的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-18T19:49:05.553

Flash 影片和 sIFR JavaScript 代码需要具有相同的版本。在您的情况下，Flash 电影是 r436，而 JavaScript 代码太旧了，甚至没有传递版本号。

如果是这样，您可能会看到类似的内容：

> 电影 (436) 与 sifr.js (419) 不兼容。使用419的电影。

我想这条消息可能会更清楚一点，尤其是在没有版本号的情况下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-13T18:43:25.963

好的，想通了。您必须使用 CS3 或以下版本导出。从 CS4 导出会导致此错误！s

# oracle - sqlplus怎么连不上？

> ID：761418
> 
> 赞同：7
> 
> 时间：2009-04-17T17:33:11.973
> 
> 标签：oracle, macos, sqlplus, ora-12170

我的目标是从我的 OS X 机器连接到 Oracle 9i 实例。我已按照[此处](http://blog.rayapps.com/2008/04/24/how-to-setup-ruby-and-new-oracle-instant-client-on-leopard/)的设置说明进行操作，并且没有错误（最终）通过它们。但是，我发现 sqlplus 无法连接：

```
[ ethan@gir ~ ]$ sqlplus xxx/yyy@zzz

SQL*Plus: Release 10.2.0.4.0 - Production on Fri Apr 17 10:13:08 2009

Copyright (c) 1982, 2007, Oracle.  All Rights Reserved. 
```

呜呜呜等...

```
ERROR:
ORA-12170: TNS:Connect timeout occurred

Enter user-name: xxx
Enter password: 
ERROR:
ORA-12162: TNS:net service name is incorrectly specified

Enter user-name: 
```

我的`tnsnames.ora`档案...

```
zzz =
  (DESCRIPTION = 
    (ADDRESS_LIST =
      (ADDRESS =
        (PROTOCOL = TCP)
        (HOST = dbhost)
        (PORT = 1521))
    )
  (CONNECT_DATA =
    (SERVICE_NAME = zzz)
  )
) 
```

也许需要设置一个环境变量？

* * *

更新

能够ping DB主机没有问题。

试过...

```
sqlplus xxx/yyy@//dbhost/zzz 
```

拿到...

```
ERROR:
ORA-12170: TNS:Connect timeout occurred 
```

尝试在 tnsnames.ora 中使用`SID`而不是。`SERVICE_NAME`似乎没有改变结果。恢复为`SERVICE_NAME`.

* * *

sqlnet.log 中的最后几个条目...

```
***********************************************************************
Fatal NI connect error 12170.

  VERSION INFORMATION:
    TNS for MacOS X Server: Version 10.2.0.4.0 - Production
    TCP/IP NT Protocol Adapter for MacOS X Server: Version 10.2.0.4.0 - Production
  Time: 17-APR-2009 10:33:06
  Tracing not turned on.
  Tns error struct:
    ns main err code: 12535
    TNS-12535: Message 12535 not found; No message file for product=network, facility=TNS
    ns secondary err code: 12560
    nt main err code: 505
    TNS-00505: Message 505 not found; No message file for product=network, facility=TNS
    nt secondary err code: 60
    nt OS err code: 0

***********************************************************************
Fatal NI connect error 12170.

  VERSION INFORMATION:
    TNS for MacOS X Server: Version 10.2.0.4.0 - Production
    TCP/IP NT Protocol Adapter for MacOS X Server: Version 10.2.0.4.0 - Production
  Time: 17-APR-2009 11:24:08
  Tracing not turned on.
  Tns error struct:
    ns main err code: 12535
    TNS-12535: Message 12535 not found; No message file for product=network, facility=TNS
    ns secondary err code: 12560
    nt main err code: 505
    TNS-00505: Message 505 not found; No message file for product=network, facility=TNS
    nt secondary err code: 60
    nt OS err code: 0 
```

* * *

部分答案

谢谢大家的回答。他们很有帮助。我发现有一个DNS问题。我能够通过主机名 ping，所以认为应该可以正常工作。我也试过IP地址。原来，我需要**内部**的“10.1.xx”IP 地址才能在这台 OS X 机器上工作（但主机名在 Windows 上很好）。

在这一点上，我可以连接...

```
sqlplus xxx/yyy@//INTERNAL_IP/zzz 
```

但是，将这些值输入到 tnsnames.ora 中，这仍然不起作用......

```
sqlplus xxx/yyy@zzz 
```

...

```
ORA-12154: TNS:could not resolve the connect identifier specified 
```

* * *

我搜索了一个与我需要的内容接近的示例 tnsnames.ora 文件，并将内容复制到我的文件中。更改了参数，现在一切正常。不知道为什么我的不工作。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-17T17:40:10.757

由于您使用的是`10g`客户端，因此建议使用`Easy Connect`语法：

```
export TWO_TASK=//dbhost/zzz
sqlplus xxx/yyy 
```

，或者只是这样：

```
sqlplus 'xxx/yyy@//dnhost/zzz' 
```

还要检查您`ORACLE_HOME`对正确文件夹的点：`tnsnames.ora`在`$ORACLE_HOME/network/admin/tnsnames.ora`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-17T17:45:57.590

你的括号似乎是正确的。

尝试使用 SID：

以下是 tnsnames.ora 文件的示例：

```
IDENTIFIER =
  (DESCRIPTION =
    (ADDRESS_LIST =
      (ADDRESS = (PROTOCOL = TCP) (HOST = userid.myhosteddb.net)(PORT = 1521))
    )
    (CONNECT_DATA = (SID = odb))
  ) 
```

[在此处阅读有关 SID 的信息。](https://stackoverflow.com/questions/43866/how-sid-is-different-from-service-name-in-oracle-tnsnamesora)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-03-25T09:41:39.003

您可以使用

```
sqlplus user/password@servicename_host 
```

如果您无法连接，您可以使用

```
sqlplus user/password@(DESCRIPTION=((ADDRESS=(PROTOCOL = TCP)(HOST = dbhost)(PORT = 1521))(CONNECT_DATA=(SERVICE_NAME = zzz))) 
```

如果您使用的是 linux 另一个 *Nix OS，则需要使用引号，否则 () 将由 shell 解释

例如

```
sqlplus user/password@'(DESCRIPTION=((ADDRESS=(PROTOCOL = TCP)(HOST = dbhost)(PORT = 1521))(CONNECT_DATA=(SERVICE_NAME = zzz)))' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T18:12:02.973

您的工作目录中可能会生成一个 sqlnet.log 文件。这可能会对您有所帮助，或者如果您发布其内容，它可能会为我们提供更多信息。

在您的示例中，您正在尝试两种不同的事情。在命令行上，您使用了“xxx/yyy@zzz”。看起来这是在 tnsnames.ora 中成功找到“zzz”条目，但超时表明它没有从服务器获得任何响应。能ping 通dbhost 成功吗？

在您第二次尝试时，您刚刚输入了“xxx”作为用户名；如果您不习惯 SQLPlus，这是有道理的，但正如您所见，它没有提示您输入数据库名称的地方。所以在这种情况下，它试图在没有服务名称的情况下连接到“xxx/yyy”，导致第二个错误。这只是意味着您没有设置默认服务名称。所以这个错误来自不完整的输入。（您可以输入“xxx@zzz”作为用户名以在此提示符处指定服务名称。如果您不介意密码为可见的。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-17T18:39:28.040

您是否尝试过使用 telnet 访问开放端口以确保防火墙没有阻止您？可能值得一试 telnet port-num host

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-17T22:36:54.193

[您是否使用oraenv](http://www.orafaq.com/wiki/Oraenv)脚本设置了您的环境？

你试过`tnsping`吗？

```
$ tnsping $ORACLE_SID 
```

也许它有助于比较一台机器上的输出，该机器确实连接到一台无法连接的机器上的输出。至少这是我在联系我们的 DBA 之前所做的。

您可以更详细地了解该`oerr`命令的错误：

```
$ oerr ora 12170
12170, 00000, "TNS:Connect timeout occurred"
// *Cause:  The server shut down because connection establishment or
// communication with a client failed to complete within the allotted time
// interval. This may be a result of network or system delays; or this may
// indicate that a malicious client is trying to cause a Denial of Service
// attack on the server.
// *Action: If the error occurred because of a slow network or system,
// reconfigure one or all of the parameters SQLNET.INBOUND_CONNECT_TIMEOUT,
// SQLNET.SEND_TIMEOUT, SQLNET.RECV_TIMEOUT in sqlnet.ora to larger values.
// If a malicious client is suspected, use the address in sqlnet.log to
// identify the source and restrict access. Note that logged addresses may
// not be reliable as they can be forged (e.g. in TCP/IP). 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-04-02T23:08:56.397

我有一个类似的问题，似乎是 Oracle sqlplus 的问题！

像这些作品中的任何一个一样连接：

```
 > sqlplus MyUsername/MyPassword@MyHostname:1521/MyServiceName
   > sqlplus MyUsername/MyPassword@//MyHostname:1521/MyServiceName 
```

（// 在主机名之前是可选的）。但是，留下密码或两个用户/密码都失败，如下所示：

```
 sqlplus @//MyHostname:1521/MyServiceName

    SQL*Plus: Release 11.2.0.4.0 Production on Thu Apr 2 15:59:49 2015

    Copyright (c) 1982, 2013, Oracle.  All rights reserved.

    SP2-0310: unable to open file "//MyHostname:1521/MyServiceName.sql"
    Enter user-name: MyUsername
    Enter password: MyPassword
    ERROR: 
    ORA-12162: TNS:net service name is incorrectly specified 
```

因此，即使 sqlplus 要求您输入用户名/密码，如果您在提示符下输入它们，它也会愚蠢地失败并显示虚假错误消息。仅当您将它们（两者！）放在连接字符串的开头时，它才有效。

> 愚蠢的甲骨文！！！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-09-10T09:34:20.647

按照[此](http://www.oracle.com/webfolder/technetwork/tutorials/obe/db/10g/r2/prod/install/wininst/wininst_otn.htm#a)链接逐步安装和安装后方法..小心它。

并与 sql plus 连接：

1.  用户名将按照上述链接中的说明成为系统
2.  您的密码不能是tiger，而是您在安装开始时设置的密码

PS：如果您的浏览器是 Google Chrome，则在测试安装时发现连接 Oracle Enterprise Manager 的问题（浏览器不兼容）不要惊慌。点击后页箭头和下一页箭头以同意条款并单击“确定”。

我在一天之内就在我的机器上解决了这个问题.. 但这对你来说只是几小时的事情。

资源：我是计算机科学工程师，主要是用 Java 编写代码

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-10-21T20:39:30.237

我遇到了同样的错误（ORA-12162：TNS:net 服务名称指定不正确），但原因不同（在 Windows 7 Enterprise 64 位上）。希望这可以帮助某人：

我工作时的 IT 安装了 32 位和 64 位 Oracle，并且基于我的 PATH 变量，shell 在 64 位路径中查找 SQLPLUS.exe 与 32 位路径相比。

不同的路径使用不同的 TNSNAMES.ora 文件，并且我在 64 位路径中没有连接字符串：

Oracle\product\11.1.0\client_1_64bit\network\admin\TNSNAMES.ora

我只有 32 位 TNSNAMES.ora 中的连接字符串：Oracle\product\11.1.0\client_1_32bit\network\admin\TNSNAMES.ora

此外，由于有多个 ORACLE 安装，我必须删除 ORACLE_HOME 环境变量，以便两个安装可以使用不同的主目录。

# programming-languages - 为什么动态类型语言很慢？

> ID：761426
> 
> 赞同：21
> 
> 时间：2009-04-17T17:35:07.413
> 
> 标签：programming-languages

与静态类型语言相比，是什么让动态类型语言难以加速。换句话说，静态类型语言的固有属性是什么，使它们易于优化执行速度？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-04-17T17:45:33.940

在静态类型语言中访问属性/方法时，查找通常可以简化为静态函数地址。即使在较慢的虚拟方法的情况下，查找也只是从 vtable 读取偏移量。

在动态语言中，名称基于字符串。想抬头看`foo.bar`？`foo`在局部变量哈希表中查找，然后在`bar`的`foo`哈希表中查找。在一些动态语言中，比如 Python 和 Ruby，可能会有额外的查找/方法调用来实现动态生成的属性。

所有这些查找都*很难*快速完成。Python 拥有世界上最优化的哈希表实现之一，而 JavaScript 已经投入数百万美元的研究资金来加快它的速度。这些策略是有效的——将 Chrome 的 JavaScript 与 IE 5 进行比较，看看有多少——但它们比静态生成函数调用要困难得多。

* * *

我应该提到，一种语言的“动态”程度可能会有所不同。Python 有几种不同的方式与变量查找进行交互，这在某些情况下很好，但使优化变得非常困难。其他动态语言，例如 Common Lisp 和 Smalltalk，可以在许多用例中与静态语言平分秋色，因为动态查找/修改更受控制。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-17T17:42:59.360

看看这个 python 例子：

```
def fact(n):
    if n==0:
        return n
    return n*fact(n-1) 
```

什么是n？是数字吗？它是一个字符串吗？它是您之前定义的类吗？编译器无法知道它将获得什么输入。您必须在运行时进行大量检查，这意味着您正在为简单的操作做更多的隐式工作。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-04-17T17:39:24.440

某些类型的编译时优化只有在变量的确切类型已知的情况下才能执行。

动态类型语言还经常添加逻辑来确定类型并确保该类型的值是正确的。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-17T17:46:31.223

动态类型语言必须在运行时进行所有检查，因为在执行过程中类型可能会发生变化。

静态类型语言在编译期间解析所有类型，因此一次性一次性消耗成本。

这是动态类型语言通常较慢的主要原因。但还有其他事情需要考虑。很大程度上取决于编译器或解释器、GC 实现、调度表布局和查找算法以及其他优化。

这一切都取决于实现：动态类型语言可以比编译语言更快，它只需要更多的工作来完成这一点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-17T17:55:53.963

您的问题有点偏离，因为动态类型的语言实际上并不慢。许多示例可能在实践中，但其他示例很快（其中快速意味着“与 c 相当可比”或类似的东西，cf common lisp）。

许多动态语言在 VM 上运行甚至解释，这可能会导致可以避免的减速。在某个级别上，静态语言编译器（或已做出正确承诺的动态编译器）可以使用的优化在完全动态的情况下是不可能的。

但是，如果您正在考虑例如 python 和 c++ 之间的差异，那么真正的问题不是动态与静态。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-17T17:37:42.320

这是因为静态类型语言通常被编译为机器代码，而动态类型语言在大多数情况下由解释器运行。

# python - 为什么 csv.reader 不是 pythonic？

> ID：761430
> 
> 赞同：7
> 
> 时间：2009-04-17T17:35:38.333
> 
> 标签：python, csv

我开始在 Python 2.6 中使用[csv.reader](https://docs.python.org/2/library/csv.html#csv.reader)但你不能`len`在它上面使用，或者切片它等等。这背后的原因是什么？这当然感觉非常有限。

或者这只是以后版本中的一个废弃模块？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-17T17:40:42.673

我很确定你不能使用 len 或 slice 因为它是一个迭代器。试试这个。

```
import csv
r = csv.reader(...)
lines = [line for line in r]
print len(lines) #number of lines
for odd in lines[1::2]: print odd # print odd lines 
```

# mysql - 在单个制表符分隔的文件中存储 ascii 和二进制数据

> ID：761442
> 
> 赞同：3
> 
> 时间：2009-04-17T17:38:29.667
> 
> 标签：mysql

我遇到了一种情况，将 ascii 和二进制数据存储在制表符分隔的文件中会很有利。我最初的尝试是可怕的。这还值得追求吗？有什么建议吗？我需要能够轻松干净地解析生成的制表符分隔文件。在下游，这些数据将进入 MySQLdb。将二进制数据存储在数据库中会很好。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-17T17:40:52.983

base64 对您的二进制数据进行编码。也许在它前面加上 base64: 或者如果有帮助的话。然后它只是一个 ASCII 文件，您可以轻松地对其进行解析。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T17:41:05.933

您是否考虑过使用与制表符分隔不同的格式？

由于二进制数据可能包含相当于制表符的字符，因此这不是一项简单的任务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T17:44:14.897

也许以[hex-blob](http://dev.mysql.com/doc/refman/5.1/en/mysqldump.html#option_mysqldump_hex-blob)格式存储二进制数据？这至少得到 MySQL 工具链的支持。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T17:53:21.723

尽管我强烈反对这种方法，但只要您知道二进制数据的确切长度（以字节为单位），您就可以将其直接存储在文件中。然后，您可以从长度值之后的制表符开始读取。希望在读入指定长度的字节后，您有另一个制表符或换行符。

一个例子：

```
ASCII 1 ASCII 2 BinaryLength Blob
this    is horrible 18  ®##]-û¢?#ý¯#d       ­ú2
please  don't   48  Þ­¾ï¥Zß¨}è¨ÙØ¨©×ÚX©©x©†Ú…zŠWG©j ‡­˜zÇ˜Ç°˜y|‰}— 
```

不过，您确实应该对二进制数据进行 Base64 编码。

# iphone - iPhone中的HttpBasicAuthentication

> ID：761445
> 
> 赞同：1
> 
> 时间：2009-04-17T17:39:27.497
> 
> 标签：iphone, nsurlconnection

在我的 iPhone 应用程序中，我试图在 iphone 上显示来自我的服务器的图像，这需要授权。我正在尝试使用 NSURLConnection 来获取图像，但它没有要求我提供用户凭据。即它根本不会使用 didReceiveAuthenticationChallenge 方法。谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-19T22:30:32.100

您可以自己计算必要的 Authorization 标头，并在创建 NSURLConnection 之前手动将其应用于传出的 NSURLRequest，如下所示：

```
NSMutableURLRequest *someURLReq = ...
NSString *auth = ...
[someURLReq setValue:auth forHTTPHeaderField:@"Authorization"]; 
```

在`auth`HTTP 基本身份验证的情况下，使用[Dave Dribin 的 base64 NSData 类别的](http://www.dribin.org/dave/blog/archives/2006/03/12/base64_cocoa/)内容将是：

```
NSString *username = ...
NSString *password = ...
NSString *combo = [NSString stringWithFormat:@"%@:%@", username, password];
NSData *comboData = [NSData dataWithBytes:[combo UTF8String] length:combo.length];
NSString *auth = [NSString stringWithFormat:@"Basic %@", [comboData encodeBase64]]; 
```

请注意，这不是加密，出于所有实际目的，密码都是纯文本，除非您使用 SSL 连接，否则将被嗅探。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T21:35:24.030

由于您没有发布任何代码，因此很难说。我会仔细检查并确保您在 NSURLConnection 上正确设置了委托成员。如果这不是问题，请尝试使用 HTTP 调试器并确保 URL 实际上触发了身份验证请求。

# vb.net - 我应该如何对一个简单的 CRUD 类进行单元测试？

> ID：761462
> 
> 赞同：6
> 
> 时间：2009-04-17T17:43:19.860
> 
> 标签：vb.net, visual-studio, unit-testing

我现在正在尝试在 VS2008 中使用单元测试做非常非常简单的事情，以开始并对此有所了解。我想我已经测试了小型非数据库的东西，但现在我想开始测试我真正的解决方案——这几乎总是 CRUD-heavy。

所以让我们假设我在数据访问层中有一个类，它为产品执行标准的 CRUD 内容。我想对产品上的每种方法进行测试。

以下是我在没有任何关于该主题的真正知识的情况下所能想到的。这是这样做的方式，还是......我应该如何处理这个？很酷（但请简单）参考也非常受欢迎。

### 创造

1.  馈送一些相关参数（产品名称等）
2.  检查是否返回了身份。
3.  删除产品（清理）。

### 读

1.  创建一个新产品
2.  调用选择方法
3.  确保产品名称与我在创建时提供的名称匹配
4.  删除产品

### 更新

1.  创建新产品
2.  更新一些字段
3.  选择产品
4.  验证某些字段匹配
5.  删除产品

### 删除

1.  创建一个新产品，保留 ProductID
2.  删除产品（清理通道 4！）
3.  检查具有此 Productid 的产品是否仍在表中？

## 编辑：

...或者我应该简单地创建一个**测试**所有这些东西的测试？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-18T01:35:00.567

我一直在这条路上，这里是你将遇到的所有问题：

1) 这对于一个记录来说看起来不错，但是当您需要 4 个其他记录来创建该记录时会发生什么？您最终创建了 4 条记录来测试插入一条记录。这会导致以下所有问题。

2）每个测试创建和删除 4-5 条记录很慢，它会慢慢加起来，运行你的测试需要 45 分钟（相信我，我在那里）。缓慢的测试意味着你永远不会运行它们，这意味着它们大部分时间都会被破坏并且毫无用处。

3）您的删除将因某些丢失的外键关系或依赖关系而失败，然后垃圾数据将留在您的数据库中。然后，这些垃圾数据将导致其他测试失败。

鉴于此，我恳请您考虑两件事。首先是尝试使用 ORM，而不是自己编写所有这些逻辑。然后，您只需要测试您的映射文件（甚至更少，取决于您使用的 ORM）或查看模拟，以便您可以将数据访问代码中的逻辑与直接访问数据库隔离开来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T20:50:11.237

我发现基本上按照您的概述进行操作效果最好。但是，我不是将创建事件拆分到每个操作中，而是倾向于在一个方法中创建一条记录，但将该记录的 id 值存储在私有类变量中，然后在每个方法中取回（读取）它。所以，然后我有一个 Read 断言方法，然后是另一个 Update 断言方法，最后是一个 Delete 断言方法。

不过，您上面概述的内容非常详尽。但是，最大的问题是，如果您的删除方法在您的读取断言方法中失败，那么您可能会误以为您的读取功能已损坏，而实际上删除功能已被删除。

# java - 易于学习的 Java 3D IDE

> ID：761463
> 
> 赞同：1
> 
> 时间：2009-04-17T17:43:33.977
> 
> 标签：java, ide, 3d

我需要创建一个机械臂的 3D 模型并为其设置动画。手臂将通过串行 I/O 接收有关如何移动的输入。

对我来说创建这个 3D 模型的最佳 Java IDE 是什么？它不必是花哨的或任何东西，只是一个概念证明。不幸的是，我之前没有任何动画方面的经验，所以我很感激那些容易上手的东西。

非常感谢，我真的很感激任何帮助。

赞恩

PS：我也可以在 2D 中进行此操作，但我认为这可能需要更多工作，因为我必须绘制更多图像。如果我错了，请告诉我。

下面我绘制了手臂需要看起来的近似 ascii 图，x 显示了所有需要旋转的关节。如果我也不必旋转底座，这在 2D 中可能很容易做到。

```
 ____
              / ___|
       ______/ /
      /x_____x|
     / /     \ \___
    / /       \____|
   /x/
   | |
   | |
___| |___
|___x___| 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T17:47:19.693

您似乎将编程与 3D 建模混淆了。这不是 Java IDE 将为您做的事情。如果您确实需要一个真正的 3D 模型，您可以查看免费的 3D 建模程序，例如[Blender](http://en.wikipedia.org/wiki/Blender_(software))。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T17:51:04.380

您将需要创建/使用类似游戏引擎的东西。您需要在 3ds Max 或 Blender 中为您的 3D 对象建模，并让您的引擎根据从外部来源接收到的输入来控制模型运动。我会为您的渲染/模型控制建议[这样的事情。](http://www.jmonkeyengine.com/)就 IO 而言，您必须自己弄清楚，因为我没有在 Java 中使用串行 IO 的经验。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T17:53:05.013

Java3D 或 JOGL 是用于在 Java 中创建 3D 图形的常用库。如果您有一个简单的 3D 模型，您可以使用简单的 3D 形状以编程方式创建它。任何更复杂的东西都可能需要像 Chad 和 Alex 提到的 3D 建模工具。

*   [http://java.sun.com/javase/technologies/desktop/java3d/](http://java.sun.com/javase/technologies/desktop/java3d/)
*   [https://jogl.dev.java.net/](https://jogl.dev.java.net/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T17:55:54.167

签出[处理](http://processing.org/)。它既是 IDE 也是 3D 建模环境——而且它是 100% java。你会发现很多例子和一个[简单的 api](http://processing.org/learning/3d/)来帮助你入门。

# javascript - 在对话框中加载另一个页面

> ID：761467
> 
> 赞同：0
> 
> 时间：2009-04-17T17:44:34.583
> 
> 标签：javascript, jquery, jquery-ui

单击链接时，我能够显示一个对话框。如何在对话框中拉另一个页面的内容？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-23T12:08:50.143

我过去通过将“其他内容”加载到 div 中然后将该 div 显示为对话框来完成此操作。

```
$('#dialog').load('other_content.html', function(){ 
    $(this).dialog();
} 
```

[用于Ajax/加载](http://docs.jquery.com/Ajax/load)的 jQuery 文档

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T17:58:54.283

jQuery [load()](http://docs.jquery.com/Ajax/load)方法是您正在寻找的吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-18T16:04:47.933

当您通过 jquery 的 ie load-method 调用文件时，可以在将加载的文件放入窗口对话框时从加载的文件中加载更多内容：

```
<script>
$(document).ready(function(){
  $("#myDropZone").load("another-file.html");
});
</script> 
```

此代码必须从加载的 html 内容中返回。

BTM，您可以通过不同方式加载内容，但请注意您在做什么。不要递归加载文件。将与循环相同。

希望这可以帮助

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-27T10:19:36.223

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <link href="Scripts/css/ui-lightness/jquery-ui-1.8.16.custom.css" rel="stylesheet"
        type="text/css" />
    <script src="Scripts/jquery-1.7.1.min.js" type="text/javascript"></script>
    <script src="Scripts/jquery-ui-1.8.16.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            var UIDialogId = 0;

            $('.UIDialogOpen').live('click', function (e) {
                e.preventDefault();
                alert(this.href);
                UIDialogId++;

                $('<div/>', {
                    'id': $(this).attr('data-dialog-id') !== undefined ? $(this).attr('data-dialog-id') : 'UIDialog' + UIDialogId,
                    'class': 'UIDialog'
                }).appendTo('body').dialog({
                    title: $(this).attr('data-dialog-title') !== undefined ? $(this).attr('data-dialog-title') : 'Message',
                    position: ['center', 'center'],
                    modal: true, resizable: false, zIndex: 10000, autoOpen: true,
                    minWidth: $(this).attr('data-dialog-minwidth') !== undefined ? $(this).attr('data-dialog-minwidth') : '300px',
                    minHeight: $(this).attr('data-dialog-minheight') !== undefined ? $(this).attr('data-dialog-minheight') : '300px',
                    maxWidth: $(this).attr('data-dialog-maxwidth') !== undefined ? $(this).attr('data-dialog-maxwidth') : '300px',
                    maxHeight: $(this).attr('data-dialog-maxheight') !== undefined ? $(this).attr('data-dialog-maxheight') : '300px',
                    close: function (event, ui) {
                        $(this).remove();
                    }
                })
                .load(this.href);

                //Or   //Use .load(this.href); and comment or delete below append line.

                //.append('<h1>Hi.. This is Testing </h1> <input type="button" class="UIDialogCancel" value="Cancel" /> <input type="button" class="UIDialogClose" value="Close" />');

                $('.UIDialogClose, .UIDialogCancel').live('click', function (e) {
                    var obj = $(this)
                    e.preventDefault();
                    obj.parents('.UIDialog').dialog('close');
                });
            });

        });
    </script>
</head>
<body>
    <a href="your url" title="test1" class="UIDialogOpen">test1</a>
    <br />
    <a href="your url" title="test2" class="UIDialogOpen">test2</a>
    <br />
    <a href="your url" title="test3" class="UIDialogOpen">test3 </a>
</body>
</html> 
```

# vbscript - 保持 VBScript 井井有条

> ID：761471
> 
> 赞同：2
> 
> 时间：2009-04-17T17:45:08.527
> 
> 标签：vbscript, code-reuse, organization

我维护了大量用于在我的网络上执行各种启动脚本的 vbscripts，并且我几乎在所有这些脚本中都使用了一些函数。

没有复制和粘贴，有人对我如何创建可重用的 vbscript 代码库有建议吗？我不反对使用代码生成器来这样做，只要它不比复制和粘贴更令人头疼。但任何建议将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-17T18:37:39.540

VBScript 有`Execute`声明，所以如果你不想走 Tester101 建议的 WSF 路线，你可以像这样做一个包含：

```
Set fso = CreateObject("Scripting.FileSystemObject")
file = "your_library.vbs"

Execute fso.OpenTextFile(file, 1).ReadAll

Set foo = New FooClass
MsgBox foo.GetBar() 
```

假设`"your_library.vbs"`将包含`FooClass`.

请务必在全局上下文中调用 Execute，否则您将陷入范围界定问题。

当然，一定要严格控制所有文件，以防止恶意使用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-23T14:32:37.260

我使用合成`include`（如下）并将我的库存储在子目录中。

```
Sub Include( scriptName )
    Dim sScript
    Dim oStream
    With CreateObject( "Scripting.FileSystemobject" )
    Set oStream = .OpenTextFile( scriptName )
    End With
    sScript = oStream.ReadAll()
    oStream.Close
    ExecuteGlobal sScript
End Sub 
```

显然，如果包含的脚本中有错误，您将不会收到非常有用的错误消息（VBScript 将无法告诉您问题发生在哪一行。）一旦一切正常，但是......

```
Include "c:\script\stdlib.vbs"
Include "c:\script\INI.cls" 
```

# vba - 如何使用 VBA 宏附加到 word 文档

> ID：761475
> 
> 赞同：3
> 
> 时间：2009-04-17T17:45:54.190
> 
> 标签：vba, ms-word

我正在用 MS Word 编写一个宏。
我需要宏来解析文件名、页码和注释列表，并只过滤掉文件名和页码。文档中的每个段落（行）都引用了一个不同的文件，所以我正在循环 For/Next 语句。

对于每一行，我都会提取文件名和页码并将其放入字符串中。除此之外，我还在每个文件名的字符串中添加了一些注释。

在转到文档中的下一行之前，我想输出我在 word 文档中构建的字符串。

我目前使用以下代码打开 word 文档：

```
Dim oWord as Object
Set oWord = CreateObject("Word.Application")
oWord.Documents.Open "C:\document.doc"
oWord.visible = true 
```

这让我可以成功打开文档，但我需要一些帮助来确定如何输出到该文档。

从概念上讲，我知道我需要先使其成为活动文档，然后转到文档的末尾，然后附加到它。

任何帮助，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-17T18:16:41.743

这个呢……更多[在这里](http://www.ozgrid.com/forum/showthread.php?t=50936)。

```
Sub test()
    Dim app As Word.Application
    Dim doc As Word.Document

    Set app = CreateObject("Word.Application")
    app.Visible = True
    Set doc = app.Documents.Open("C:\test.doc")
    doc.Content.InsertAfter "Hello World"
    doc.Save
    doc.Close
    app.Quit
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-03T06:38:26.977

这将帮助您遍历给定目录中的文件列表

```
Sub ProcessDocs()
    Dim rng As Range
    Dim MainDoc As Document
    Dim strFile As String
    Const strFolder = "d:\Userfiles\yourname\testFiles\" 'change to suit
    Set MainDoc = Documents.Add
    strFile = Dir$(strFolder & "*.doc") ' can change to .docx
    Do Until strFile = ""
        'Extract your filename, pagenum here, and build a string
        'write string into the file
        strFile = Dir$()
    Loop 
```

循环时，您可以提取文件名等；构建您的字符串并将其写入文件。我希望它有帮助

# hibernate - 休眠：未配置 CurrentSessionContext

> ID：761480
> 
> 赞同：26
> 
> 时间：2009-04-17T17:47:06.697
> 
> 标签：hibernate, liferay

我不断收到：

> HibernateException：未配置 CurrentSessionContext！

在我的代码中。其他搜索返回的唯一信息是罪魁祸首是：

```
<property name="current_session_context_class">thread</property> 
```

在我的 hibernate.cfg.xml 中。我的 hibernate.cfg.xml 文件中确实有它，并且我在 Tomcat 6 中运行它。有人知道其他可能的原因吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-17T20:00:12.463

我相信你需要将你的 current_session_context_class 设置为一个实际的类......我为此配置了 hibernate.cfg.xml，如下所示：

```
<property name="hibernate.current_session_context_class">org.hibernate.context.ThreadLocalSessionContext</property> 
```

上面的代码用于 mySql 数据库，但我认为数据库对于上面的属性是什么类型并不重要

希望这可以帮助

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-04-20T17:49:44.417

这两个都在 Hibernate 4+ 中工作：

```
<property name="hibernate.current_session_context_class">thread</property>
<property name="hibernate.current_session_context_class">org.hibernate.context.internal.ThreadLocalSessionContext</property> 
```

在早期版本的 Hibernate 中，它使用 org.hibernate.context.ThreadLocalSessionContext （如其他答案所示）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-09T11:10:33.117

在 Hibernate 4.1.5 中它是：

```
<property> name="hibernate.current_session_context_class">org.hibernate.context.internal.ThreadLocalSessionContext</property> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-01-22T17:25:21.417

我在tomcat 7上使用Hibernate 4，下面的属性（问题中提到的那个）对我有用。

```
<property name="current_session_context_class">thread</property> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-11-16T22:58:20.330

```
var config = new Configuration().Configure(); // Read config from hibernate.cfg.xml
config.CurrentSessionContext<WebSessionContext>(); // <-- No CurrentSessionContext fixing
return config.BuildSessionFactory(); 
```

# mysql - MySQL 触发器是异步的吗

> ID：761482
> 
> 赞同：9
> 
> 时间：2009-04-17T17:47:28.820
> 
> 标签：mysql, triggers

当触发 AFTER UPDATE 或 AFTER INSERT 触发器时，它是同步事件还是异步事件？换句话说，它是否保留了触发触发器的查询的总执行时间？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-17T17:51:07.547

触发器不是异步的。是的，它们会增加完成更新或插入所需的时间。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-17T18:06:29.210

是的，触发器是同步的。例如，如果您编写一个 AFTER INSERT 触发器来记录另一个日志表中的插入，您可以确定主 INSERT 和对日志表的插入作为原子操作发生。当主 INSERT 返回时，触发器（包括 BEFORE 和 AFTER 触发器）完成的所有其他工作也完成了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-11-24T13:03:03.670

是的，触发器是同步的。但是，如果您需要实现异步 MySQL 触发器，您可以利用[Maxwell](http://maxwells-daemon.io/) + 自定义代码轻松读取 MySQL 二进制日志并在感兴趣的事件上启动您自己的逻辑。

# javascript - 你如何让 VS 2008 Javascript Intellisense 为复杂的原型工作？

> ID：761483
> 
> 赞同：3
> 
> 时间：2009-04-17T17:47:31.300
> 
> 标签：javascript, visual-studio-2008, intellisense

我已经能够让 javascript intellisense 为这样定义的“类”原型正常工作：

```
function GetCustomerList()
{
}

GetCustomerList.prototype = 
{
    HEADER: {
        RETURN_CODE: 0,
        RETURN_MESSAGE: "",
        }
    ,
    NUM_RECORDS: 0,
    START_RECORD: 0,
    END_RECORD: 0
}; 
```

我可以输入如下内容：

```
var req = new GetCustomerList();
req.HEADER.RETURN_CODE = 100; 
```

Visual Studio 的智能感知知道 HEADER 属性，以及它自己的名为“RETURN_CODE”和“RETURN_MESSAGE”的属性。我可以：

```
req.NUM_RECORDS = 50; 
```

智能感知完美运行。

所以智能感知适用于复杂的嵌套类型 - 很棒。但是，是否有可能通过一系列复杂类型获得智能感知？

例子：

```
function Customer()

Customer.prototype = {

    NAME: "",
    ADDRESS: "",
    ID: 0
};

function GetCustomerList()
{
}

GetCustomerList.prototype = 
{
    HEADER: {
        RETURN_CODE: 0,
        RETURN_MESSAGE: "",
        }
    ,
    NUM_RECORDS: 0,
    START_RECORD: 0,
    END_RECORD: 0,
    CUSTOMERS: [ new CUSTOMER() ]
}; 
```

我有一个“客户”类型的数组，我还为其定义了一个原型。我希望能够输入以下内容：

```
req.CUSTOMER[ 0 ].NAME 
```

并让智能感知提示我“NAME”是该数组可用的属性。

这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-21T14:43:26.403

**更新：**

正如您已经注意到的那样，IntelliSense 适用于您的复杂类型，但不适用于 Array。即使你创建了一个像 String 这样的内在类型数组，它仍然不起作用。

我已经彻底研究过这个话题，理论上这应该是可能的，但事实并非如此。
作为测试，创建名为***“customers.js*** ”的 javascript 文件并包含以下内容：

```
function Customer() {
    /// <summary>This is my custom intellisense for the Customer type</summary>
    ///<field name="NAME" type="String">The Customer's name</field>
    ///<field name="ADDRESS" type="String">The customer's address</field>
    ///<field name="ID" type="String">The ID number</field>
}
Customer.prototype = {
    NAME: "",
    ADDRESS: "",
    ID: 0
};

function CustomerList() {
    /// <summary>The List of Customers</summary>
    ///<field name="HEADER" type="String">The header</field>
    ///<field name="CUSTOMERS" type="Array" elementType="Customer" >The list of customers in an Array</field>
}

CustomerList.prototype =
{
    HEADER: {
        RETURN_CODE: 0,
        RETURN_MESSAGE: ""
    },
    NUM_RECORDS: 0,
    START_RECORD: 0,
    END_RECORD: 0,
    CUSTOMERS: [new Customer()]
}; 
```

然后在里面引用这个文件`<script src="customers.js"/>`

或 `/// <reference path="customer.js" />`在另一个 JS 文件中。

看看智能感知如何正确显示摘要，但是当涉及到数组时，什么也没有。

```
var custList = new CustomerList();

custList.CUSTOMERS // intellisense
custList.CUSTOMERS[0] // no intellisense as you already know 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T00:23:54.777

没有办法让它在 VS2008 中工作。它将在下一个版本的 VS 中工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-06T02:24:51.187

尽管 VS 不支持它，但您可能需要考虑以下解决方法。

我将示例脚本更改为：

```
function Customer(obj) {
    /// <summary>This is my custom intellisense for the Customer type</summary> 
    ///<field name="NAME" type="String">The Customer's name</field> 
    ///<field name="ADDRESS" type="String">The customer's address</field>
    ///<field name="ID" type="String">The ID number</field>
    if (obj) return obj;
}

Customer.prototype = {
    NAME: '',
    ADDRESS: '',
    ID: 0
};

function CustomerList() {
    /// <summary>The List of Customers</summary> 
    ///<field name="HEADER" type="String">The header</field> 
    ///<field name="CUSTOMERS" type="Array" elementType="Customer" >The list of customers in an Array</field> 
}

CustomerList.prototype =
{
    HEADER: {
        RETURN_CODE: 0,
        RETURN_MESSAGE: ''
    },
    CUSTOMERS: []
}; 
```

（注意构造函数的变化——不确定智能感知的 XML 注释）。

然后你可以像这样引用它（使用智能感知）：

```
var list = new CustomerList();

var cust = new Customer();
cust.NAME = 'john';
list.CUSTOMERS.push(cust);

var cust1 = new Customer(list.CUSTOMERS[0]);
alert(cust1.NAME);

var cust2 = new Customer({ NAME: 'Mark' });
alert(cust2.NAME); 
```

反对这一点的论点是您需要构造函数中的参数。

# java - Java有没有像ELMAH这样的东西？

> ID：761484
> 
> 赞同：4
> 
> 时间：2009-04-17T17:47:51.643
> 
> 标签：java, exception, elmah

### 复制：

[Java中的异常驱动编程](https://stackoverflow.com/questions/760397/)

我一直在研究[ELMAH](http://code.google.com/p/elmah/)，想知道有哪些类似的应用程序可用于 Java。

感谢您对 log4j 和其他框架的建议。就像帖子的作者一样，这个问题重复了，我只是想看看是否存在功能更全面的解决方案，而不是不得不推出我自己的解决方案（如果没有可比性，我当然可以这样做）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T17:50:38.827

查看 Wikipedia 上的[Java 日志框架](http://en.wikipedia.org/wiki/Java_Logging_Frameworks)页面，它比较了几个不同的记录器及其功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T17:55:16.633

我会建议[log4j](http://logging.apache.org/log4j/2.x/)。它足够灵活，几乎可以做任何你需要的事情，而且它稳定且经过验证。

# java - 多个动画 JPanel - 仅显示添加到 JFrame 的最后一个

> ID：761485
> 
> 赞同：0
> 
> 时间：2009-04-17T17:48:12.997
> 
> 标签：java, multithreading, swing

我正在制作一个多线程吃豆人游戏。

有一个扩展 JFrame 的 PacmanController 类，一个扩展 JPanel 的 Maze 类，一个在自己的线程中运行并扩展 JPanel 的 Pacman 类，以及在自己的线程中运行并扩展 JPanel 的 Ghost 类。每个线程（pacman 和每个 Ghost）都会不断地重新绘制自己并调用 maze.repaint()。

当我将迷宫添加到框架时，它显示正常，如果我再添加 pacman，它仍然可以正常显示和动画。

但是，当我在 pacman 之后将 Ghost 添加到框架时，ghost 出现而 pacman 消失。如果我切换添加 pacman 和 ghost 的顺序，则相反，即只显示 pacman 或每个 ghost 实例中的一个 - 最后添加的那个。

例如：

```
add(maze);
add(pacman);
add(ghostA); 
```

只有迷宫和ghostA出现？

我意识到这与 JFrames BorderLayout 有关，即只能将一个组件添加到中心区域，但不知道如何修复它。我曾尝试将 pacman 和 ghosts 添加到 EAST WEST 等，但这没有用。

我也试过

```
maze.add(pacman);
add(pacman); //etc 
```

但这也不起作用。

对不起，很长的帖子，非常感谢任何帮助。我不能发布任何代码，因为代码太长并且分布在许多类中。

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-17T18:11:23.583

**第一：**在 Swing 中从多个线程重绘会带来麻烦。更好的方法是从主游戏类更新并将`Graphics`对象传递给所有演员来绘制自己（我确信还有其他模式，但我有一段时间没有做这种事情了）。

**第二：**你的演员（吃豆人，鬼魂）不应该是`JPanels`。这是更糟糕的麻烦的秘诀。让它们扩展一个`Actor`类或其他东西，但它们不应该是 Swing 组件。

我意识到这并不能直接回答您的问题，但是如果您正确设计游戏，您的一些问题将会消失。网上有很多关于游戏设计的教程；我个人不能推荐其中任何一个，但《[Killer Game Programming in Java](http://fivedots.coe.psu.ac.th/~ad/jg/) 》的前几章看起来很有希望。

* * *

**编辑：**好的，我会尝试解决实际问题。

如果您使用`BorderLayout`，添加多个组件的方法是指定位置：

```
setLayout(new BorderLayout());
add(maze, BorderLayout.CENTER);
add(pacman, BorderLayout.EAST);
add(ghostA, BorderLayout.WEST); 
```

或者（也许更好），您可以将玩家添加到迷宫中：

```
setLayout(new BorderLayout());
maze.setLayout(new BorderLayout());
maze.add(pacman, BorderLayout.EAST);
maze.add(ghostA, BorderLayout.WEST);
add(maze, BorderLayout.CENTER); 
```

现在，虽然这些*应该*将所有三个组件都添加到框架中，但我仍然看不出你怎么能有一个玩家`JPanel`试图逃跑的游戏`JPanels`。
无论如何，如果它们不起作用，接下来要做的就是尝试不同的[布局管理器](http://java.sun.com/docs/books/tutorial/uiswing/layout/using.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T19:23:32.677

您是否将这些面板直接添加到 JFrame 中？如果是这样，您应该将它们添加到框架的内容窗格中：

```
getContentPane().add(maze);
getContentPane().add(pacman);
getContentPane().add(ghostA); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T19:38:05.277

仅供参考，mmyers 是对的。你将与​​这个设计抗争到最后，它永远不会正常工作。你的做法是错误的。

让我们从解决其中一些问题开始

*   你如何控制pacman和ghost的位置/定位？
*   您是在设置 jpanel 的位置还是在面板内的某个 x/y 处绘制？
*   您是否希望所有 3 个面板都在彼此之上绘制/渲染？
*   `paintComponent()`您是否在每个中都覆盖`JPanel`以绘制 pacman/ghost/maze？
*   家庭作业的标准是什么？
*   它必须是多线程的吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T19:45:36.757

看一眼

[分层面板](http://java.sun.com/docs/books/tutorial/uiswing/components/layeredpane.html)

或者

[堆栈布局](http://www.jroller.com/gfx/entry/stacklayout)

# iphone - UIImagePickerController 在 5 到 7 张图片后崩溃 - 再次

> ID：761488
> 
> 赞同：3
> 
> 时间：2009-04-17T17:49:55.757
> 
> 标签：iphone, cocoa-touch

好的，我知道这个人在这个论坛上被打死了，但我仍然有记忆问题，我已经尝试了网络上的*所有*技术来解决这个问题。

我有一个使用 UIImagePickerController 从相机捕获图像的应用程序。我已经尝试为每张图片创建和销毁控制器，并在应用程序的生命周期中保留它。两者都失败了。第一种方式几乎立即使手机崩溃。而第二个，离开控制器，在大约 5 到 7 张图片后使应用程序崩溃。

我的原始应用程序使用了一个未记录的 API 来解决这个问题，但苹果因此拒绝了它。我*真的*需要将我的应用程序带到商店。有没有人有代码显示他们如何解决这个问题？

我知道有一种方法，因为商店中有使用相机的应用程序，但我似乎无法获得它。*非常*感谢任何帮助！

如果需要，我也可以在这里发布我的代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-03-21T23:53:10.427

我对单点触控应用程序也有类似的问题。对我来说，原因原来是内存泄漏。我使用相同的 UIImage 变量来存储每个连续的图片。结果，以前的照片被泄露了。Monotouch (c#) 与 Objective C 有些不同，有时垃圾收集器会为您处理这类事情。但就我而言，它似乎没有。对我来说，解决方案是在存储新图像之前对旧图像显式调用 .Dispose() 。

我的猜测是你的问题可能很相似。确保您没有孤立任何图像数据，并且明确处置您已完成的任何数据。另外，请记住，您的应用程序可用的内存量是有限制的。也可能是您只是想一次在内存中保存太多图片。

# sql-server - 如何在 Sql Server 2008 表上启用全文索引

> ID：761501
> 
> 赞同：3
> 
> 时间：2009-04-17T17:52:43.907
> 
> 标签：sql-server, sql-server-2008, full-text-search

不知道发生了什么，但这是我的问题。我有一个 Sql Server 2008 数据库，我需要能够进行全文索引/搜索，但是当我尝试在表上设置索引时，我得到以下信息：

[替代文字 http://docs.google.com/a/delorenzodesign.com/File?id=dgr4q2dh_25sq4dnxd9_b](http://docs.google.com/a/delorenzodesign.com/File?id=dgr4q2dh_25sq4dnxd9_b)

我试过在我的数据库上运行这个存储过程，它是成功的：

```
EXEC sp_fulltext_database @action = 'enable' 
```

但是我仍然得到上面的窗口，并且我的全文搜索没有返回任何结果。

我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-03-19T14:37:00.210

我有一个从以前版本的 SQL Server 迁移到 SQL Server 2008 的数据库。它在迁移之前没有启用全文索引。为了启用 SQL Management Studio 全文选项，我必须发出以下命令：

```
use [your_database_name]

CREATE FULLTEXT CATALOG ftCatalog AS DEFAULT;
GO

EXEC [your_database_name].[dbo].[sp_fulltext_database] @action = 'enable'
GO 
```

第一个命令创建全文目录。第二个初始化全文索引并告诉 Management Studio 在指定的数据库上启用了全文。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T19:16:26.017

感谢约翰的“踢裤子”。我看过那里，但正如我妻子所说，我“看起来像个男人”。第二次看出现了这个页面：

[管理全文搜索](http://msdn.microsoft.com/en-us/library/ms142557.aspx)

在阅读了第一个要点之后（至少对我来说，我已经将重要的东西加粗了）......

> 系统管理任务，例如管理 FDHOST Launcher 服务 (MSSQLFDLauncher)、如果更改服务帐户凭据则**重新启动过滤器守护进程主机进程、****配置服务器范围的全文属性**以及备份全文目录...

重新启动守护进程，让我继续前进。伙计，这很容易。:D

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T18:49:15.503

不确定您是否浏览过文档，但 Microsoft 的内容非常详尽，您应该能够快速找到您正在寻找的内容的说明，而无需过多查找。

这是开始您的研究的好地方：

[http://msdn.microsoft.com/en-us/library/ms142571.aspx](http://msdn.microsoft.com/en-us/library/ms142571.aspx)

# php - 什么定义了 MVC 中的传统“页面”概念？

> ID：761506
> 
> 赞同：6
> 
> 时间：2009-04-17T17:53:58.537
> 
> 标签：php, model-view-controller, codeigniter, controller

我目前使用 CodeIgniter 作为我在使用 PHP 时选择的框架。我正在努力解决的一件事是“页面”的概念，以及如何在 MVC 中正确地表示它。据我所知，CodeIgniter 有一个代表页面控制器的前端控制器。在我的思考过程中，每个页面都有自己的控制器。尽管我经常看到有人使用塞满了许多方法的页面控制器。所以从这个意义上说，每个动作都成为它自己的页面。

我从来没有真正喜欢将许多方法填充到一个控制器中的想法，因为如果您一次只需要控制器中的一两个方法，似乎会有太多的开销。每个页面都有自己的控制器似乎更合理，并且操作只会对应于您可以在该特定页面上执行的操作。我在想这个错误的方式吗？

更令人困惑的是，我会注意到在某些 Web 应用程序中，它们将有一个控制器，该控制器将具有多种方法（即登录、注册、查看、编辑等），但在其他应用程序中，它们实际上有一个登录控制器，和一个寄存器控制器。“页面控制器”的正确用途是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-17T17:59:57.103

从域的角度来看，我肯定地说每个域上下文有 1 个控制器更有意义。不一定每页一个，但根据上下文可能会出现这种情况。我所说的上下文是“密切相关的行动”。

例如，帐户控制器应处理登录、注册、注销、更改密码、操作。他们都生活在“帐户”的范围内

以 Stackoverflow 为例。我将有一个“问题”控制器，它具有诸如 DisplayQuestion、AskQuestion、删除问题、MostRecent Questions 等操作。它们都是由一个控制器管理的不同“视图/页面”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T18:01:16.710

你是对的，控制器中的每个公共方法都变成了一个“页面”。话虽这么说，它不一定是网页，一个动作可能是数据的发布，然后重定向到另一个动作/页面，因此页面不一定意味着“网页”。

MVC 使用许多约定来使事情正常进行。例如，每个控制器都必须以“Controller”结尾。因此，一组用户页面（创建、编辑、删除等）将位于 UserController 中。在 Views 文件夹中，控制器类中的每个公共方法或操作都成为与控制器前缀匹配的文件夹中的网页（在本例中为用户文件夹）。因此，控制器类中称为“删除”的操作将指向用户文件夹中的 Delete.aspx 页面。

将所有这些方法放在一个类中似乎有点尴尬，但它可以很好地根据您的对象组织类似的功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T18:44:43.550

在 MVC 中，将三者放在一起就可以得到一个“页面”。模型处理数据层，视图处理用户看到的实际 HTML，控制器决定它们如何连接在一起以显示所需的数据。我选择对现有控制器使用单独的控制器或其他方法取决于操作与我拥有的其他控制器的接近程度。假设我想要一个 UserAdmin 控制器，现在它很可能会处理添加用户、删除用户、更改密码等。如果我要添加以某种方式更改用户帐户的功能，我很可能会说在那里。如果我将它们分离到它们自己的控制器中，我自然会添加另一个。控制器允许您将类似的任务放在一起，因此它们可以利用类中已有的内容，而不必重新创建已经完成的内容。很多都是程序员认为应该怎么做的。对你有意义的对我来说可能没有意义，那是开发人员（或设计师）的选择。

# ruby-on-rails - 如何在 Windows 上的 Rails 上编写 Ruby CGI

> ID：761513
> 
> 赞同：0
> 
> 时间：2009-04-17T17:56:40.653
> 
> 标签：ruby-on-rails, ruby, cgi

我尝试创建一个 test.rb 文件，将其放在公共目录中，然后像[http://localhost:3000/test.rb](http://localhost:3000/test.rb)一样调用它，但这似乎不起作用。它认为我正在尝试下载文件。我在这里想念什么？小脚本如下：

```
#!/usr/local/bin/ ruby
print "HTTP/1.0 200 OK\r\n"
print "Content-type: text/html\r\n\r\n"
print "<html><body>Hello World!</body></html>\r\n" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T18:48:15.523

有一个小型的 http 守护程序服务器用于此类事情。我从未听说您可以配置任何浏览器来为您执行脚本，因此您可能会遇到与我类似的设置：

[您可以在sourceforge](http://sourceforge.net/projects/shttpd/)找到 shttpd（现在称为 mongoose，从外观上看）。我用于 ruby​​ 应用程序的配置文件如下所示：

```
# SHTTPD web server configuration file.
# Lines starting with '#' and empty lines are ignored.
# For detailed description, visit http://shttpd.sourceforge.net/shttpd.1.txt

#platform-specific stuff
root            c:\main\src\worker\http
systray         no
access_log      logs\shttpd_access_log.txt
error_log       logs\shttpd_error_log.txt
cgi_env         RUBYLIB=c:\main\src\worker;c:\main\src\worker\lib
cgi_interp      c:\InstantRails\ruby\bin\ruby.exe

#platform-dependant stuff
ports           2001
cgi_ext         rb
threads         5
index_files     index.rb 
```

如果您有任何进一步的问题，只需更新，我会尽量关注线程。

# php - 关于我的 Web 服务器的服务器配置有什么建议吗？

> ID：761514
> 
> 赞同：2
> 
> 时间：2009-04-17T17:56:51.090
> 
> 标签：php, configuration, lamp

我正在为客户端设置 Web 服务器。他们将使用我正在构建的 Web 应用程序 (PHP/LAMP)。服务器将位于本地网络中。同一台服务器上还将有一个 MySQL 数据库。服务器上的负载只会是 20-25 个并发用户，但正常运行时间和性能仍然非常重要。

应用程序本身将使用后端 CMS (TBD) 向用户显示内容，前端使用 JQuery，后端使用 PHP。

所以，我的问题是：在 CPU、缓存和内存（大小/类型）方面是否有一套好的服务器系统要求，以提供相对便宜的解决方案，但仍能提供高质量的性能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T18:12:35.420

说实话，硬件不是最大的因素，它是编码。如果您正确且优化地开发应用程序，那么您应该能够在一台运行 1ghz、512mb ram 和 5200rpm 硬盘驱动器的机器上同时运行至少 100 个用户。

我建议使用 VMWare 创建虚拟机并将 MySQL 服务器与 Web 服务器分开。这也使您能够复制、迁移或升级机器，而无需重新配置和重新安装。

此外，在没有 GUI 的操作系统上运行 LAMP 配置（Debian、Ubuntu、Fedora 等，没有安装 X-Window）。这些是服务器，它们不应该浪费资源来显示漂亮的窗口。

最后，就像 Trent 所说，RAID 配置是个好主意，但 RAID 不是备份解决方案。如果您有两个相同的硬盘驱动器，很可能如果一个出现故障，另一个很快就会出现故障。始终拥有备份解决方案（NAS、磁带、DVD、软盘等）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T18:00:06.027

只需确保您拥有 2 个一切... 2 电源 2 个硬盘驱动器（raid 1）或使用 raid 5 更好。根据正常运行时间的重要性，您甚至可能希望拥有一个完整的故障转移服务器。至于性能，您没有给我们足够的信息……查询有多大，数据库中有多少数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T18:31:36.653

在不了解将在服务器上运行的应用程序的详细信息的情况下，任何具体的建议（即 X GB 的 RAM、具有 Z 缓存的 Y 处理器）都将毫无意义。也就是说，我强烈建议不要在 RAM 上吝啬，尤其是对于数据库驱动的应用程序 - 您可以在 RAM 中保留的数据越多而不会影响硬盘驱动器，您的性能就会越好。但是，作为开发人员，永远不要忘记丰富的硬件资源不能替代适当的索引和代码优化！

我还想在这里回应一些其他建议 - RAID 你的驱动器（我过去更喜欢 RAID 10 用于数据库服务器），获取某种脱机备份（磁带、DVD-R、USB 驱动器等）和确保将备份保存在异地（以防发生洪水、火灾或其他物理灾难）。并且不要忘记定期测试从您的备份恢复 - 没有比发现您的备份在为时已晚时不起作用更糟糕的感觉了。

# perl - MS Exchange POP3 UIDL 命令提供的 UID 真的是唯一的吗？

> ID：761516
> 
> 赞同：6
> 
> 时间：2009-04-17T17:57:32.617
> 
> 标签：perl, exchange-server, pop3, uidl

我在 Perl 中使用 Net::POP3 来遍历 MS Exchange 服务器上的邮箱。我对每个消息编号运行 UIDL 命令，并将返回的 ID 与以前看到的 ID 进行比较，以查看我过去是否处理过此消息。但是，我还发现在单个 POP3 邮箱中，相同的 UID 似乎针对不同的邮件多次出现。

知道为什么会发生这种情况吗？UID 不是真正唯一的吗？或者消息是否以某种方式在同一个邮箱中重复？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T19:03:57.153

[RFC](https://www.rfc-editor.org/rfc/rfc1939)说：

> 虽然服务器实现通常最好将任意分配的唯一 ID 存储在邮件投递中，但本规范旨在允许将唯一 ID 计算为消息的哈希值。 **客户端应该能够处理邮件投递中消息的两个相同副本具有相同唯一 ID 的情况。**

[我的重点]

# python - 尝试导入 Python 文件时可以在 Python 文件中使用破折号吗？

> ID：761519
> 
> 赞同：176
> 
> 时间：2009-04-17T17:58:59.853
> 
> 标签：python, naming

基本上当我有一个python文件时：

```
python-code.py 
```

并使用：

```
import (python-code) 
```

解释器给了我语法错误。

关于如何解决它的任何想法？python文件名中的破折号是非法的吗？

* * *

## 回答 #1

> 赞同：196
> 
> 时间：2009-04-17T18:01:46.227

您应该查看[PEP 8](http://www.python.org/dev/peps/pep-0008/)，Python 代码的样式指南：

> 包和模块名称模块应该有简短的全小写名称。如果提高可读性，可以在模块名称中使用下划线。Python 包也应该有简短的全小写名称，尽管不鼓励使用下划线。
> 
> 由于模块名称映射到文件名称，并且某些文件系统不区分大小写并截断长名称，因此选择相当短的模块名称很重要——这在 Unix 上不是问题，但它可能是将代码传输到较旧的 Mac 或 Windows 版本或 DOS 时出现问题。

换句话说：重命名你的文件:)

* * *

## 回答 #2

> 赞同：137
> 
> 时间：2009-04-18T01:06:18.467

在您的代码中要注意的另一件事是 import 不是一个函数。正如一些人已经提到的那样，`import(python-code)`应该将`import python-code`其解释为“导入python减去代码”，而不是您想要的。如果您确实需要导入名称中带有破折号的文件，您可以执行以下操作：

```
python_code = __import__('python-code') 
```

但是，如上所述，这并不是真正推荐的。如果文件名由您控制，则应更改文件名。

* * *

## 回答 #3

> 赞同：87
> 
> 时间：2016-06-15T09:52:47.933

**TLDR**

破折号*并不*违法，但出于 3 个原因，您不应使用破折号：

1.  您需要特殊的语法来导入带有破折号的文件
2.  没有人希望模块名称带有破折号
3.  这违反了[Python Style Guide的建议](https://www.python.org/dev/peps/pep-0008/#id38)

如果您确实需要导入带有破折号的文件名，则特殊语法如下：

```
module_name = __import__('module-name') 
```

**好奇为什么我们需要特殊的语法？**

特殊语法的原因是，当您编写时，`import somename`您正在创建一个带有标识符的模块对象`somename`（因此您以后可以将它与 eg 一起使用`somename.funcname`）。当然`module-name`不是一个有效的标识符，因此是给出有效标识符的特殊语法。

**你不明白为什么 module-name 不是有效的标识符？**

别担心——我也没有。这里有一个提示可以帮助你：看看这个 python 行：`x=var1-var2`。您是否看到赋值右侧的减法或带有破折号的变量名？

**附言**

我的答案中没有任何原创内容，除了在一个地方包含我认为与所有其他答案中最相关的信息

* * *

## 回答 #4

> 赞同：35
> 
> 时间：2009-04-17T18:01:05.480

问题是它`python-code`不是标识符。解析器将此视为`python`减号`code`。当然，这不会满足您的要求。您将需要使用一个也是有效的 Python 标识符的文件名。尝试用`-`下划线替换。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2019-05-24T15:29:08.837

在 Python 3 上使用[import_module](https://docs.python.org/3.7/library/importlib.html#importlib.import_module)：

```
from importlib import import_module
python_code = import_module('python-code') 
```

更普遍，

```
import_module('package.subpackage.module') 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-04-17T18:03:29.560

您可能可以通过一些`__import__`hack 导入它，但如果您还不知道如何导入，则不应该这样做。Python 模块名应该是有效的变量名（“标识符”）——这意味着如果你有一个模块`foo_bar`，你可以在 Python ( `print foo_bar`) 中使用它。您将无法使用奇怪的名称（`print foo-bar`-> 语法错误）这样做。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-09-29T18:20:46.447

尽管正确的文件命名是最好的方法，但如果`python-code`不在我们的控制之下，那么使用 hack`__import__`比复制、重命名或以其他方式弄乱其他作者的代码要好。`.py`但是，我试过了，除非我重命名文件并添加扩展名，否则它不起作用。在查看 [文档](https://docs.python.org/2/library/imp.html)以获取如何获取描述`.py`后，我得出了以下结论：

```
import imp

try:
    python_code_file = open("python-code")
    python_code = imp.load_module('python_code', python_code_file, './python-code', ('.py', 'U', 1))
finally:
    python_code_file.close() 
```

`python-codec`它在第一次运行时创建了一个新文件。

# java - 在java中比较两个数据结构的最快方法

> ID：761520
> 
> 赞同：5
> 
> 时间：2009-04-17T17:59:01.333
> 
> 标签：java

我想知道在 java 1.5 中比较两个数据结构的最快方法是什么。

我的数据结构代表一棵可能非常大的树。我可以遍历整个数据结构并逐个节点比较 2 个节点（我猜这会很慢）。或者我可以计算数据结构的哈希以更快地完成它，对吗？

计算此哈希的最佳（有效且不太长）方法是什么？

我不希望需要太多时间来计算哈希...

希望我很清楚.. :-) ...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T18:10:51.680

您是否考虑过保持一个运行中的 hashCode，它会随着元素的插入或从树中移除而不断更新？这样，在任何给定时间通过 hashCode 比较树将是即时的。

根据您实现散列函数的方式以及插入和删除节点的频率，这可能是一个糟糕的解决方案。如果你的散列函数很快，你没有做很多改变，你需要做很多比较，这可能会奏效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T18:04:25.503

[`.equals()`](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html#equals(java.lang.Object))每个对象都继承[`.hashCode()`](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html#hashCode())自[Object](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html)。

Java 中的标准数据结构应该已经为您实现了一种相对快速的`.hashCode()`方法（哈希可能是增量计算的，或者可能需要遍历每个元素，请检查您正在使用的数据结构的来源以确保）。

您应该知道，即使数据结构不相同，也可能发生[哈希冲突。](http://en.wikipedia.org/wiki/Hash_collision)

为了进行准确的比较，我会在比较每个元素的两棵树上同时执行[树遍历。](http://en.wikipedia.org/wiki/Tree_traversal)这样，树的形状以及包含的元素将在`O(n)`时间上进行比较，其中`n`最大树的大小是。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T18:05:50.740

要计算哈希，您必须完全遍历两棵树。您必须检查每个节点的属性并执行哈希计算。例如，如果 a`String`在节点中，则必须遍历其字符并进行一些数学运算。然后你必须将节点的哈希与其他节点的哈希结合起来。

因此，计算两个结构的哈希值与一次比较它们是否相等具有相同的顺序（可能会更昂贵）。事实上，因为在执行相等比较时，您可以在检测到任何差异时立即停止，平均而言，单个相等测试会快得多。

仅当您缓存散列值并多次重用它时，散列可能是有益的。请记住，因为不同树的哈希值可能会发生冲突，所以您仍然需要实现相等比较。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T18:23:55.550

正如 gdm 所说，您可以保持一个正在运行的 hashCode，这将允许您快速确定两棵树是否**不同**（一旦确定它们具有相同的哈希值，您就需要进行深度比较）。您可以`xor`对所有节点使用（例如）node.hashCode，这使得添加和删除非常简单的计算：

```
this.hashcode ^= nodeInQuestion.hashCode; 
```

或者，您可以创建一个可以[实习的](http://en.wikipedia.org/wiki/String_intern_pool)[不可变](http://en.wikipedia.org/wiki/Immutable_object)结构。同样，它增加了更改的开销，但没有比较比引用相等更快。这取决于您是针对修改还是比较进行优化，是否需要相似的正负速度，最重要的是，您的树的大小是否真的很明显。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-17T18:24:37.327

根据比较节点的成本，可能值得首先只比较树的拓扑结构，并且只有在树结构相同的情况下才比较每对节点。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-17T20:33:04.927

如果图中的所有对象都实现了可比较 - 您只需调用 compareTo。在可能的情况下，我总是在 POJOS 上实现可比较的（以及 hashcode 和 equals）。

为了加快速度，您可以实现快捷方式，以便不匹配的对象尽早返回。我们这样做，它真的很有帮助。

*在您对其运行真正的*分析器之前，我不会尝试过早地优化其他方法（Netbeans 是免费的并且有一个非常好的分析器）。

添加 compareTo 的好处是它为您提供了在其他地方有用的通用功能：TreeMaps、排序集合等

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-07-25T12:17:13.640

```
public void preOrderTraversal(Node r1, Node r2) {

       if (r1 != r2 )  { // implement equals here !!  

           System.exit(0); // exit and print not equal
       }

       preOrderTraversal(r1.left(),r2.left());
       preOrderTraversal(r1.right(),r2.right());
} 
```

# json - 当我尝试 sudo gem install json 我收到以下错误

> ID：761521
> 
> 赞同：32
> 
> 时间：2009-04-17T17:59:23.563
> 
> 标签：json, ruby, macos, rubygems

我需要安装 JSON gem 来启动我的应用程序，但是每当我尝试安装 json gem 时都会收到以下错误。谁能帮我吗。我正在使用 rails 2.2.2 和 gems 1.3.1。

```
Arions-macbook-pro:.ssh arion$ sudo gem install json
Password:
Sorry, try again.
Password:
Building native extensions.  This could take a while...
ERROR:  Error installing json:
    ERROR: Failed to build gem native extension.

/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby extconf.rb install json
can't find header files for ruby.

Gem files will remain installed in /Library/Ruby/Gems/1.8/gems/json-1.1.4 for inspection.
Results logged to /Library/Ruby/Gems/1.8/gems/json-1.1.4/ext/json/ext/parser/gem_make.out 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-10-23T03:36:29.780

使用 Mavericks，您可以通过从命令行安装 Xcode 命令行工具来解决此问题，如下所示：

`xcode-select --install`

更新：安装或更新后不要忘记接受许可协议：

`sudo xcodebuild -license`

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-09-06T06:26:38.177

如果你有这个问题：

```
ERROR:  Error installing json:
ERROR: Failed to build gem native extension. 
```

并且您使用的是带有 OS X 的 Mac（使用 10.8.1 Mountain Lion 测试），您需要从 Mac App Store 下载 Xcode（或者如果您有开发帐户，则从 developer.apple.com 下载 - 这是免费的顺便说一句，您可以下载 DMG 安装程序）

最新的 Xcode 版本（我使用的是 Xcode 4.4.1）不包括命令行工具。现在你需要在 Xcode 中安装这个额外的包。完成后，您的问题就解决了。

为此，请打开 Xcode，转到 Preferences > Downloads > Components。安装“命令行工具”。你完成了。现在您可以安装 json Ruby gem。

![在此处输入图像描述](https://i.stack.imgur.com/Vpn5R.png)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-17T18:05:43.237

您缺少 ruby​​ 开发标头。要将这些安装在像 ubuntu 这样的操作系统上，您应该使用：

```
aptitude install ruby1.8-dev 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-17T18:59:55.307

ruby 头文件不随 Mac OS X 的基本 ruby​​ 安装一起安装。这些可以通过安装 XCode 工具在 Mac OS X 安装光盘 2 上找到。

安装后，一切正常！

**更新**至少从 OS X 10.7.3 开始，这不再是问题，它“正常工作”

```
MacBook-Pro:tmp$ sudo gem install json
Password:
Building native extensions.  This could take a while...
Successfully installed json-1.6.5
1 gem installed
Installing ri documentation for json-1.6.5...
Installing RDoc documentation for json-1.6.5...
MacBook-Pro:tmp$ uname -a 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-17T19:04:00.553

安装 Xcode 命令行工具...应该可以解决这个问题。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-17T21:58:08.903

一个简单的[谷歌搜索](http://www.google.com/search?rls=en-us&q=can't+find+header+files+for+ruby)揭示了这一点：

如果在尝试构建扩展或 gem 时收到 can't find header files for ruby​​ 错误消息，这意味着 Ruby 无法找到其头文件。

Mac OS X 默认不提供头文件，安装后需要安装 Xcode Tools 包。您可以在 Leopard DVD 上的 Optional Installs / Xcode Tools 目录中找到它。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-02-27T07:48:43.607

事实证明，某些 gem 需要一些 ruby​​ 头文件才能正确安装。这些头文件**不**随 Lion (OSX 10.7) 一起提供。

事实证明，Xcode 4（最新版本）**也没有**安装这些头文件。我试过这个。

**解决方案 -**假设您在 Mac OS X 上（您似乎基于终端输出）。为了让它工作，我从以下页面安装了 gcc*和一些开发者工具*

*   访问[https://github.com/kennethreitz/osx-gcc-installer](https://github.com/kennethreitz/osx-gcc-installer)
*   向下滚动到 README 并下载相应的包（对于 OSX 10.7 或 10.6）
*   打开`.pkg`文件并运行安装程序。

您现在应该可以使用`gem install`或安装 gem `bundle install`。

**开销**如果您担心它附带的其他垃圾，这里有一个摘要。

*   `gcc`- 有用
*   `make`- 有用
*   `clang`- 对 ObjectiveC 有用
*   开发人员 CLI 工具（清除等）- 有用吗？
*   DevSDK（标头等） -**你需要什么**

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-01-08T06:49:33.263

如果您使用自制软件，请运行`brew doctor`. 您可能会发现编译所需的 gcc 库已过时和/或丢失。

```
Warning: No compiler found in /usr/bin!
Warning: Your Xcode (4.2) is outdated

checking for gcc... /Developer/usr/bin/llvm-gcc
checking whether the C compiler works... no
configure: error: in `/private/tmp/freexl-apNF/freexl-1.0.0d':
configure: error: C compiler cannot create executables 
```

对于 Lion 和 Mountain Lion 用户，Apple 现在提供了一个官方的 Xcode 命令行工具包，您无需安装 Xcode 即可安装它！您可以从 Apple 的开发者网站[https://developer.apple.com/downloads/index.action](https://developer.apple.com/downloads/index.action)下载它。如果您仍然需要 gcc-4.2，并且使用 Homebrew，则可以使用 homebrew/dupes 中的 apple-gcc42 软件包安装它。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2011-12-03T21:38:00.147

我有同样的问题。

这是我的冒险经历（希望对您有用）：

为了修复它，我做了很多操作:-)

我正在使用 Fedora Core。我已经这样解决了：

我已经安装了 rails-devel：

> sudo yum install rails-devel

再次尝试：

> 须藤宝石安装导轨

但我还有另一个问题：

> 构建原生扩展。这可能需要一段时间... 错误：安装 rails 时出错：错误：无法构建 gem 原生扩展。
> 
> ```
>  /usr/bin/ruby extconf.rb creating Makefile 
> ```
> 
> 制作 gcc -I。-I/usr/lib/ruby/1.8/i386-linux -I/usr/lib/ruby/1.8/i386-linux -I. -D_FILE_OFFSET_BITS=64 -fPIC -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector --param=ssp-buffer-size=4 -m32 -march=i686 -mtune=atom -fasynchronous -unwind-tables -fno-strict-aliasing -fPIC -O3 -Wall -c parser.c **make: gcc: Command not found**

所以我安装了 GCC：

> 须藤百胜安装 gcc

再次尝试：

> 须藤宝石安装导轨

现在我有另一个问题）））：

> 正在为 json-1.6.3 安装 ri 文档...错误：为 json-1.6.3 生成文档时...消息：没有要加载的文件 -- irb/slex ... RDOC 参数：--ri --op /usr/lib/ruby/gems/1.8/doc/json-1.6.3/ri --title JSON 实现 Ruby --main README.rdoc ext/json/ext ext lib README.rdoc --title json-1.6。 3 文档——安静

所以安装了ruby-irb：

> sudo yum 安装 ruby​​-irb

再次尝试：

> 须藤宝石安装导轨
> 
> **成功安装rails-3.1.3**

就这样 ）））

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2012-11-12T20:42:31.613

这是我的解决方案：

```
rvm gem 安装 json -v=xxx
```

我的设置：

```
OSX 狮子
红宝石-1.9.3
转速
gcc-4.2 #=> 老实说没有看到它被使用过

```

# c# - 您认为 C# 属性（或类似机制）是个好主意还是不鼓励使用它们？

> ID：761537
> 
> 赞同：3
> 
> 时间：2009-04-17T18:04:35.347
> 
> 标签：c#, attributes, custom-attributes

在过去的 4 或 5 年中，我建立了许多使用 C# 属性的设计和框架。

但最近我看到很多人公开反对他们的使用或改变他们的框架以减少对它们的需求或使用。

我发现它们是天赐之物，但现在我开始想知道我错过了什么。

澄清一下：使用约定优于配置正在成为一个主要原则，尤其是在 ORM 领域。这个区域是否可以使用配置文件 (XML) 映射字段、使用属性或具有直接映射到数据库表中的字段的通用命名约定。我没有引用任何引用，但我已经阅读了一些反对在组合中添加另一个属性的强烈反对。

但我觉得在我刚刚列出的三个选项中，属性仍然是最有意义的。配置文件更难维护，并且通用命名约定将您与数据库字段的实现联系起来。属性被准确地放置在需要它们的位置，并且实现可以在不与使用位置断开连接的情况下进行更改。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-17T18:08:26.273

这是一个很难给出一般答案的问题。属性是另一种语言功能，正确使用时非常强大，但也有可能被滥用。我从未见过完全放弃使用属性的令人信服的理由，也没有理由认为它们是一个坏主意。

事实上，恰恰相反。属性允许将特定于框架的信息添加到元数据中。无法通过类型层次结构轻松表达的信息。这极大地增加了使用属性的框架的能力。

我当然见过一两个实现，人们滥用它们但没什么了不起的。你可以说得更详细点吗？是否有您在谈论的特定属性/框架。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-17T18:09:08.597

这是一个相当广泛的问题，比如“我应该把奶酪放在砂锅里吗”；两者的答案都是“这取决于你在做什么”。

如果您大量使用 addributes 并且几乎像声明式编程范例一样使用它们，那么您可能会在此过程中遇到麻烦。无论是来自反射某处的放缓还是只是一般的可维护性，谁都猜不透。

就像其他一切一样……在适当的时候使用它们，使您的代码更高效或更具可读性。不要为了使用而使用，也不要为了放弃而放弃。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-17T18:24:43.817

属性实际上有两个用途：作为用户可见的东西，以及作为编译器发出的东西。

我假设您正在谈论用户可见属性。

一般来说，我会说用户可见属性并不理想。

大多数时候，它们用于在 C# 之上嵌入某种形式的自定义语言。LINQ 属性就是一个很好的例子。从消费者的角度来看，更好的方法是为宿主语言添加一流的支持。那最终会感觉更自然。（拥有定义表和外键的语言支持会比所有疯狂的 linq-to-sql 属性更容易使用）。

然而，实际上，对于大多数开发人员来说，扩展编程语言的成本太高了。好处只是不超过成本。

也许有一天 C# 将具有元编程功能，这将使做那种事情变得容易。

然而，目前这种能力并不存在。

这为您提供了 3 个选项：

1.  使用属性
2.  使用动态语言，并在运行时生成代码
3.  只是不要使用生成式编程

通常＃1最终是最容易做出的选择，即使它并不理想。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-17T18:08:53.947

在定义有关我的代码的元数据时，我发现它们非常有用。我使用它们来生成自定义报告、插件架构以及与第三方代码通信。

我想你可以按照惯例做所有事情，但我喜欢他们。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-17T18:10:15.207

我看到在 ASP.NET MVC 中大量使用属性。事实上，切换到 MVC 使我对 Attributes 的使用显着增加。我不确定您对反属性反弹的看法来自哪里，但我当然没有从 MS 中看到它，至少在 MVC 方面。

我特别喜欢 Attributes 可用于在那些经过如此修饰的控制器/动作之间提供横切行为（方面）的方式。看到如何构建 MVC 以在操作调用之前和之后处理属性调用，我必须相信这是让方面在 MVC 中工作的首选方式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-17T18:09:07.987

好吧，如果 ASP.NET MVC 有什么用，我想说不要担心。使用反射和属性在该框架中完成了很多工作，我认为它没有任何问题。MVC 是一个相当新的框架，它被广泛使用。从验证输入、处理错误到非常棒的 ActionFilter 属性，其中有很多。所以不，我个人认为他们没有错。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-17T19:56:52.877

我个人认为属性，就像大多数语言特征一样，有它们的位置，但可能会被滥用或误用。

在正确的框架中，它们是无价的。它们确实简化了 DI 框架之类的东西（[MEF](http://www.codeplex.com/MEF)就是一个很好的例子），并且对于测试框架之类的东西非常非常有用。

但是，我认为疯狂地添加用户定义的属性可能是矫枉过正。我个人喜欢使用属性，但尽量减少它们的使用，并且只在最有意义的地方使用它们。

# visual-studio - 在 Visual Studio 2008 中是否有任何选项可以默认关闭 Silverlight XAML 预览？

> ID：761538
> 
> 赞同：0
> 
> 时间：2009-04-17T18:05:00.773
> 
> 标签：visual-studio, visual-studio-2008, silverlight

vs2008中silverlight用户控件的预览对我来说几乎没有用，而且加载需要很长时间。我花了很多时间只切换到 XAML 并最小化我打开的每个 Silverlight UserControl 的预览。是否有一个设置我可以告诉 VS2008 默认以仅 XAML 模式打开这些？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-17T18:10:51.867

是的。

右键单击并选择“打开方式...”

选择“源代码（文本）编辑器”，以便您获得智能感知并将其从该对话框设置为默认值。

噗。没有更多的设计师:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-19T17:07:08.073

我发现当我使用“打开方式”选项时，我遇到了锁定问题，这是一个问题。（可能只有我。）
无论如何，这个选项对我来说效果更好：使用 Visual Studio 工具菜单，选择选项 - 文本编辑器 - XAML - 杂项。然后您将看到“始终以完整的 XAML 视图打开文档”这就是票证。

节省了很多时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T18:22:02.310

我不知道是否有办法只打开 XAML。但是您当然可以只启用 XML 编辑器来打开。

*   右键点击
*   选择打开方式...
*   选择“XML 编辑器”

# silverlight - 在 Silverlight 单元测试中处理 DependencyObjects

> ID：761542
> 
> 赞同：3
> 
> 时间：2009-04-17T18:05:58.900
> 
> 标签：silverlight, unit-testing

一段时间以来，我一直在使用 NUnit 和 Moq 和我的 Silverlight 代码编写单元测试。我一直遇到的一个问题与 DependencyObjects 有关。

如果有任何东西是从 DependencyObject 派生的，那么我无法在我的测试中实例化它。例如，MouseEventArgs 派生自 DependencyObject。如果我有使用这些参数的代码，我无法创建参数有几个原因......其中之一是它是一个 DependencyObject。

据我了解，DependencyObject 的基本构造函数正在尝试使用一些不存在的静态变量，除非整个 Silverlight 系统启动并运行。从 DependencyObject 派生的类的任何构造都会引发异常。真可惜。

我不使用[Silverlight 单元测试框架](http://code.msdn.microsoft.com/silverlightut/)，因为它确实不是单元测试并且需要 UI。我需要真正的、无头的单元测试。

无论如何，我想出的最好的方法是包装这些对象并给它们接口`ITimelineMarker`，我给它们扩展方法来做到这一点：`timelineMarker.ToInterface()`. 这很好用，我可以模拟它们......但我想知道：

有没有人想出更好的方法来处理 Silverlight 单元测试中的依赖对象？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-11T22:55:35.580

为什么将应用程序逻辑直接绑定到 SilverLight 事件和对象？尝试通过其 UI 测试应用程序逻辑的警告是众所周知的反模式，并且已经让位于以更有效方式解决此问题的模式。

您的 UI 真的应该只关心 UI 事件并将任何处理传递给另一层，然后在您的 UI 中测试的唯一事情就是图形响应（例如，当您单击按钮时，面板是否从侧面滑入），测试这种交互的唯一好方法是实际进行点击。

也许对您的问题更合适的答案是您需要重构代码以使用诸如 MVC、MVP 或 MVVM 之类的模式，以便您可以独立于 UI 层测试应用程序逻辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T08:57:25.453

您看过 TestDriven.NETs Silverlight NUnit 项目吗？ [关联](http://weblogs.asp.net/nunitaddin/archive/2008/05/01/silverlight-nunit-projects.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T20:01:01.457

我可以在抽象类中看到 DependencyObject。

无耻地从 Rhino 模拟[文档](http://ayende.com/wiki/TestingAbstractClasses.ashx)中翻录，想象你有一个抽象类：

```
public abstract class MessageBase {
   private List<User> _receivers = new List<User>();
   public void Send() {
      //Some setup
      DetermineReceivers();
      SendMessages();
   }
   private void SendMessages() {
      //Lots of logic
   }
   protected abstract void DetermineReceivers();
   protected void AddReceiver(Group g) {
      //Lots of logic <---- Test this
   }
} 
```

并且您想测试指定的部分。然后，您将创建一个可以模拟的假类：

```
TestFixture
public sealed class MessageBaseTester {
 public abstract class MockMessageMocker
 {
    public abstract List<Group> RecipientsGroups { get; set; }
 }
 private class MockMessage : MessageBase {
   private MockMessageMocker _mock;
   public MockMessage(MockMessageMocker mock) {
      _mock = mock;
   }
   protected override void DetermineReceivers() {
      if (_mock.RecipientsGroups != null)
         foreach(Group g in _mock.RecipientsGroups)
            base.AddReceiver(g);
   }
 }
} 
```

之后您的测试可以执行以下操作：

```
 Test
 public void ShouldblablablaWhenBlabla() {
    var SuThelper = mocks.Stub();
    var SuT = new MockMessage(SuThelper);
    using (mocks.Record())
    {
       Expect.Call(SuTHelper.RecipientsGroups).Return(
             new List<Group>{ new Group(...) });
    }
    using (mocks.Playback())
    {
       SuT.Send();
    }
 } 
```

上面的解决方案比你的有一个优势，因为你不需要修改你的原始代码。但是，您需要编写一些“额外”代码才能使其工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T15:10:30.870

尝试使用[SilverUnit](http://www.typemock.com/Silverlight_unit_testing_page.php)进行[单元测试 Silverlight](http://www.typemock.com/Silverlight_unit_testing_page.php)。由于它是在伪造 Silverlight 基础架构，因此它可能有助于解决有问题的异常。

# asp.net - 使用 DB2Command.ExecuteNonQuery 插入多行

> ID：761543
> 
> 赞同：3
> 
> 时间：2009-04-17T18:06:09.507
> 
> 标签：asp.net, sql, insert, db2

我正在尝试使用 C# 代码将多行插入 DB2 数据库，如下所示：

```
string query = 
"INSERT INTO TESTDB2.RG_Table (V,E,L,N,Q,B,S,P) values" +
"('abc', 'def', '2009-03-27 12:01:19', 'ghi', 'jkl', NULL, NULL, NULL)," +
"('abc', 'def', '2009-03-27 12:01:19', 'ghi', 'jkl', NULL, NULL, NULL)";

DB2Command cmd = new DB2Command(query, this.connection, this.transaction);

cmd.ExecuteNonQuery(); 
```

如果我在第一组值之后停止构建查询字符串，它会在没有错误的情况下执行。尝试使用此方法加载多个值会导致以下错误：

```
Upload error : ERROR [42601] [IBM][DB2] SQL0104N  
An unexpected token "," was found following "".  
Expected tokens may include:  "<END-OF-STATEMENT>".  SQLSTATE=42601 
```

SQL 语法与我在[其他地方](https://stackoverflow.com/questions/452859/inserting-multiple-rows-in-a-single-sql-query)读到的相匹配， IBM 的文档给出了这个例子：

```
cmd = conn.CreateCommand();
cmd.Transaction = trans;

cmd.CommandText =
"INSERT INTO company_a VALUES(5275, 'Sanders', 20, 'Mgr', 15, 18357.50), " +
"(5265, 'Pernal', 20, 'Sales', NULL, 18171.25), " +
"(5791, 'O''Brien', 38, 'Sales', 9, 18006.00)";

cmd.ExecuteNonQuery(); 
```

谁能解释什么可以解释这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-01-13T18:08:12.413

我意识到这是一个非常古老的问题，但到目前为止，还没有一个答案能找到问题的真正根源。由于他不能使用多个 VALUES 子句，我猜他是在不支持的 z/OS 上。有关更多信息，请参阅[我的其他答案](https://stackoverflow.com/questions/11743265/insert-multiple-rows-into-db2-database/11743610#11743610)。

不过，还有一个替代方案，因为他似乎使用的是 .NET，这是驱动程序的[“链接”能力](http://www-01.ibm.com/support/knowledgecenter/SSEPGG_10.5.0/com.ibm.swg.im.dbclient.adonet.ref.doc/doc/DB2ConnectionClassBeginChainMethod.html)。这允许您批量处理多个插入/更新/删除，当您“结束”您的链时，驱动程序会立即发送所有语句。这是一些示例代码：

```
<!-- language: lang-cs --> //Code parser seems to be going crazy here...
public void InsertToDatabase(IEnumerable<Row> rows)
{
    using (var conn = new DB2Connection())
    using (var trans = conn.BeginTransaction())
    using (var cmd = conn.CreateCommand())
    {
        cmd.Transaction = trans;
        cmd.CommandText =
            "INSERT INTO company_a VALUES " +
            "(@field1,@field2,@field3,@field4,@field5,@field6)";

        conn.BeginChain();
        foreach (var row in rows)
        {
            cmd.Parameters.Clear();
            cmd.Parameters.Add("@field1", row.Field1);
            cmd.Parameters.Add("@field2", row.Field2);
            cmd.Parameters.Add("@field3", row.Field3);
            cmd.Parameters.Add("@field4", row.Field4);
            cmd.Parameters.Add("@field5", row.Field5);
            cmd.Parameters.Add("@field6", row.Field6);
            cmd.ExecuteNonQuery();
        }
        conn.EndChain();
        trans.Commit();
    }
} 
```

如果 DB2 抛出任何异常，您只会在运行时得到它`EndChain`，而且它们都会同时出现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T15:02:23.293

您是否尝试过通过命令行插入？[根据此链接，语法似乎是正确的](http://publib.boulder.ibm.com/infocenter/db2luw/v8/index.jsp?topic=/com.ibm.db2.udb.sqlassist2.doc/sqlassist2/t_insert.htm)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-20T19:37:52.253

您的语法看起来大致正确。

*   它可以从 cli 中工作吗？
*   你看过 JDBC 批量更新吗？我认为您会发现它几乎一样快，并且更具可读性和可支持性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-07T14:50:08.643

如果您指定行列表，我很确定插入多行不起作用；在这种情况下

```
(V,E,L,N,Q,B,S,P) 
```

要插入多行，您必须按照表列的本机顺序给出值。

尝试将您的 SQL 修改为：

```
string query = "INSERT INTO TESTDB2.RG_Table values" +   
"('abc', 'def', '2009-03-27 12:01:19', 'ghi', 'jkl', NULL, NULL, NULL)," +
"('abc', 'def', '2009-03-27 12:01:19', 'ghi', 'jkl', NULL, NULL, NULL)"; 
```

# sql - 混合隐式和显式 JOIN

> ID：761545
> 
> 赞同：8
> 
> 时间：2009-04-17T18:06:31.737
> 
> 标签：sql, hibernate, join, cartesian-product, cross-join

我遇到了 Hibernate 生成无效 SQL 的问题。具体来说，混合和匹配隐式和显式连接。这似乎是一个[开放的错误](http://opensource.atlassian.com/projects/hibernate/browse/HHH-3388)。

但是，我不确定*为什么*这是无效的 SQL。我想出了一个生成相同语法异常的小玩具示例。

## 架构

```
CREATE TABLE Employee (
    employeeID INT,
    name VARCHAR(255),
    managerEmployeeID INT   
) 
```

## 数据

```
INSERT INTO Employee (employeeID, name) VALUES (1, 'Gary')
INSERT INTO Employee (employeeID, name, managerEmployeeID) VALUES (2, 'Bob', 1) 
```

## 工作 SQL

这两个查询都有效。我意识到有一个笛卡尔积；这是故意的。

*显式连接：*

```
SELECT e1.name,
       e2.name,
       e1Manager.name
  FROM Employee e1
 CROSS JOIN Employee e2
 INNER JOIN Employee e1Manager
    ON e1.managerEmployeeID = e1Manager.employeeID 
```

*隐式连接：*

```
SELECT e1.name,
       e2.name,
       e1Manager.name
  FROM Employee e1,
       Employee e2,
       Employee e1Manager
 WHERE e1.managerEmployeeID = e1Manager.employeeID 
```

## 无效的 SQL

此查询不适用于 MSSQL 2000/2008 或 MySQL：

```
SELECT e1.name, 
       e2.name, 
       e1Manager.name
  FROM Employee e1,
       Employee e2
 INNER JOIN Employee e1Manager 
    ON e1.managerEmployeeID = e1Manager.employeeID 
```

在 MS2000 中，我收到错误：

> 列前缀“e1”与查询中使用的表名或别名不匹配。

在 MySQL 中，错误是：

> “on 子句”中的未知列“e1.managerEmployeeID”。

## 问题）

1.  为什么这个语法无效？
2.  **奖励：**有没有办法强制 Hibernate 只使用显式 JOIN？

* * *

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-17T18:18:31.443

它会导致错误，因为根据 SQL 标准，`JOIN`关键字的优先级高于逗号。关键点是表别名直到*在*`FROM`子句 中评估了相应的表之后才可用。

因此，当您`e1`在`JOIN...ON`表达式中引用时，`e1`还不存在。

在我研究 Hibernate 时请稍候，看看你是否可以说服它`JOIN`在所有情况下都使用。

* * *

唔。Hibernate.org 上的所有内容似乎都重定向到了 jboss.org。所以现在无法在线阅读 HQL 文档。我相信他们最终会弄清楚他们的名字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-22T13:01:30.083

这可能有点跑题了，因为它根本不涉及休眠，但[比尔卡尔文](https://stackoverflow.com/users/20860/bill-karwin)的评论真的让我大开眼界。您需要先进行显式连接，而不是先编写隐式连接。如果您有多个隐式连接，则此语法特别有趣。

在 MS SQL 中检查以下示例。并非所有联系人都定义了国家代码，但所有联系人都有一个属性 val，该属性将在表 Tbl 中查找。所以直观的解决方案将不起作用：

```
SELECT * FROM 
contacts, Tbl
LEFT OUTER JOIN country ON CtryCod = country.CtryCod 
WHERE val = Tbl.val 
```

相反，您可能更愿意使用以下语法：

```
SELECT * FROM 
contacts LEFT OUTER JOIN country ON CtryCod = country.CtryCod, 
Tbl
WHERE val = Tbl.val 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T18:19:31.643

PostgreSQL 也给出了一个错误：

```
ERROR:  invalid reference to FROM-clause entry for table "e1"
LINE 7:     ON e1.managerEmployeeID = e1Manager.employeeID;
               ^
HINT:  There is an entry for table "e1", but it cannot be referenced from this part of the query. 
```

我认为问题在于，当您加入两个表 a 和 b（在本例中为 e2 和 e1Manager）时，您只能在“ON”子句中引用这两个表。因此，您可以在此 ON 子句中引用 e2 和 e1Manager，但不能引用 e1。

我认为这可以扩展，因此如果您有“JOIN”语句链，则可以在“ON”子句中引用同一链中的其他表，但不能跨越“，”。所以像 `a JOIN b ON a.a_id = b.a_id JOIN c ON c.b_id = b.b_id AND c.a_id = a.a_id" 是允许的。

您用于生成此 SQL 的 HQL 是什么？类似“从员工 e1、员工 e2 中选择 e1.name、e2.name、e1.manager.name”？

# oracle - 我应该使用 TNSNAMES.ORA 还是 tnsnames.ora？

> ID：761546
> 
> 赞同：1
> 
> 时间：2009-04-17T18:06:43.110
> 
> 标签：oracle

我正在尝试从 OS X 连接到 Oracle。我在这里有这个文件：

```
/usr/local/oracle/network/admin/TNSNAMES.ORA 
```

网上我看到这个文件的引用文件名都是大写和小写的。哪个是对的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T18:10:36.673

官方文档是小写的：[Local Naming Parameters (tnsnames.ora)](http://download.oracle.com/docs/cd/B28359_01/network.111/b28317/tnsnames.htm)，所以我会这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T18:11:21.553

如果您在默认 HPFS（不区分大小写）下，则无关紧要。

我更喜欢“tnsnames.ora”。但这只是口味问题。

# ruby-on-rails - 当我的 rails 应用程序加载时，如何自动启动 sphinx 守护进程？

> ID：761547
> 
> 赞同：2
> 
> 时间：2009-04-17T18:06:51.300
> 
> 标签：ruby-on-rails, ruby, automation, sphinx, thinking-sphinx

我知道手动启动 sphinx 守护进程的命令。我使用 rake 任务：“rake thinking_sphinx:start” 是否可以在我的 rails 应用程序加载时启动它，这样我就不必每次都手动输入命令？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T19:01:06.443

如果您通过 capistrano 进行部署（您应该这样做），只需将其添加为 after_deploy：

desc "每次成功部署后运行它"

```
 task :after_deploy, :roles => :app do
        run "#{current_path}/rake thinking_sphinx:start"
  end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-17T19:20:47.037

您可以配置 daemon_controller 来执行此操作：http: [//blog.phusion.nl/2008/08/25/daemon_controller-a-library-for-robust-daemon-management/](http://blog.phusion.nl/2008/08/25/daemon_controller-a-library-for-robust-daemon-management/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-17T18:10:24.833

您应该能够测试它是否正在运行并从 Rails 内启动它（使用[反引号](http://ruby-doc.org/core/classes/Kernel.html#M006001)或`%x{...}`符号。

鉴于（正如您在评论中所说）这是一项 rake 任务，您可能希望这样做而不是使用反引号：

```
Rake::Task['thinking_sphinx:start'].invoke 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T18:17:40.510

将启动它的命令放入您的 config/initializers/custom.rb

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-17T18:28:18.363

我不得不在我的应用程序中做同样的事情，但使用 Windows。如果您陷入同样的​​困境，您会发现如果您执行以下操作，您的生活会轻松得多：

```
if app_not_already_running
  IO.popen("start app") do |fd|
  end
end 
```

我正在查看旧代码，但我不记得 do |fd| 真的很有必要。试一试。

“开始”很重要的原因是让窗口成为​​被诅咒的东西的背景。啊！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-08T21:51:00.863

如上所述，在 config/initializers.xml 中创建一个文件。例如，我创建了一个名为 initializers/start_thinking_sphinx.rb 的文件。在我放的文件中

```
require 'rake'
require 'rake/testtask'
require 'rake/rdoctask'
require 'tasks/rails'
require "#{RAILS_ROOT}/vendor/plugins/thinking-sphinx/tasks/thinking_sphinx_tasks"
Rake::Task['thinking_sphinx:start'].invoke 
```

如果我随后使用脚本/服务器启动服务器，这将有效。但是，如果我从乘客开始 :(

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-08-22T09:09:14.353

虽然这篇文章已经很老了，但为了完整起见，我添加了我的解决方案......

我在不使用 rake 的情况下启动 sphinx 守护程序，方法是将以下代码放入 config/initializers/launch_sphinx.rb。

```
Kernel.system("/usr/local/sphinx/bin/searchd --pidfile --config [full-path-to-your-app]/config/#{RAILS_ENV}.sphinx.config") 
```

**重要**：

根据需要更改 searchd 和 rails 应用程序的路径。

# java - 有多少 Java SE api 是用 Java 编写的？

> ID：761553
> 
> 赞同：5
> 
> 时间：2009-04-17T18:09:05.727
> 
> 标签：java

有多少 Java SE api 实际上是用 Java 本身编写的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-17T18:13:34.437

最简单的查找方法就是查看[源代码](http://download.java.net/jdk6/source/)（来自 Sun 的 J2SE 网站；还有[6](http://download.java.net/openjdk/jdk6/)和[7](http://download.java.net/openjdk/jdk7/)的 OpenJDK 源代码）。这与您所期望的差不多 - 绝对*必须*用本机代码编写的东西，例如“打开套接字或文件”是本机的，但几乎所有其他东西都是用 Java 编写的（无论如何，在 Sun 的实现中）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-17T18:14:06.603

下载[OpenJDK](http://openjdk.java.net/)并找出答案！

其中大部分是 Java，但有一些低级的东西必须是本机代码（想到图形和文件操作）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-17T19:29:27.153

下载 Apache Harmony 并找出答案！

Sun 大约 85% 的 JRE 是用 Java 编写的。事实上，很少需要用本机代码编写。IBM 的 Jikes RVM（以前称为 Jalapeño）和 Sun 的 Maxine 是几乎完全用 Java 编写的 JVM。由于遗留原因，Sun 的 JRE 中的大多数本机代码都是本机代码。有些是因为方便。很小的一部分是原生的，因为它（或曾经）快一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T18:14:31.390

我没有数字，但应该很容易计算。

如果您想考虑 API 的方法总数来计算百分比，您可以只计算总数和定义中带有**native**关键字的方法。

您可以通过解析 SUN 的开源实现源代码来执行此计算。

# oracle - 设置 ORACLE_HOME 的正确方法？

> ID：761557
> 
> 赞同：3
> 
> 时间：2009-04-17T18:09:12.980
> 
> 标签：oracle

在 OS X 上，我的 ORACLE_HOME 环境变量应该是...

```
/usr/local/oracle 
```

或者...

```
/usr/local/oracle/instantclient_10_2 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T18:12:03.410

它应该设置为包含您的 \bin 目录的目录的值，在您的情况下，我相信它是 /usr/local/oracle/instantclient_10_2。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T02:03:12.347

将其设置为`/usr/local/oracle`，现在一切正常。不知道这意味着`/usr/local/oracle`是否一定是正确的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-21T04:01:49.083

如果您按照此处的说明进行操作：

[在 Mac OS/X 上安装 Oracle Instantclient 而不设置环境变量？](https://stackoverflow.com/questions/684352/installing-oracle-instantclient-on-mac-os-x-without-setting-environment-variables)

您无需设置任何环境变量。不用担心真是太好了！

# asp.net - 有没有办法在 IIS 重新启动后“自动部署”ASP.NET 应用程序？

> ID：761559
> 
> 赞同：3
> 
> 时间：2009-04-17T18:09:36.973
> 
> 标签：asp.net, iis, lifecycle, fluorinefx

我有一个使用 Fluorine FX 远程处理库的 ASP.NET 应用程序。当 Web 应用程序初始化时，它会在一个单独的端口上启动一个套接字服务器来处理 RTMP 连接。

我们遇到的问题是，当重新启动 IIS 时，RTMP 服务将不会开始运行，直到针对应用程序中的一个 .aspx 文件发出第一个 HTTP 请求。

我一直在阅读有关 ASP.NET 生命周期以及它如何与 IIS 相关联的信息，请参阅本文：

[http://msdn.microsoft.com/en-us/library/ms178473.aspx](http://msdn.microsoft.com/en-us/library/ms178473.aspx)

似乎生命周期都基于它由第一个 HTTP 请求初始化的假设......

有谁知道当 IIS 重新启动时我是否有某种钩子，以便我可以强制初始化 Fluorine 及其 RTMP 服务器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T19:05:26.963

我相信你所有的陈述都是正确的。您正在寻找的功能最好在 Windows 服务中完成。

Windows 2008 的 Windows 进程激活服务 (WAS) 支持非 HTTP 场景，例如普通 TCP、命名管道或 MSMQ，但关键术语是“激活”——总有一个触发器。

# matlab - 如何使用 imread 和 imwrite 进行路径检索？

> ID：761564
> 
> 赞同：7
> 
> 时间：2009-04-17T18:10:48.780
> 
> 标签：matlab, image

我知道如何`imread`工作`imwrite`，但我不知道函数从哪里调用图像文件？换句话说，我应该在哪里存储图像以便使用它来调用它`imread`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-17T19:26:01.593

正如[亚当](https://stackoverflow.com/questions/761564/problem-with-matlab-imread/761583#761583)建议的那样，您可以将 Matlab 工作目录更改为图像的位置，或者我倾向于让用户选择要读取的文件`uigetfile`

```
>> [fn,pn]=uigetfile({'*.TIFF,*.jpg,*.bmp','Image files'}, 'Select an image');
>> I = imread(fullfile(pn,fn)); 
```

或者，如果您知道要读取的图像的目录，则可以将其存储在变量中，然后您可以使用该目录中的图像列表`dir`

```
>> imageDir = 'c:\path\to\my\images';
>> imageList = dir(fullfile(imageDir,'*.tif')); % store all files with extension tif  
                                               % in a structure array imageList 
```

从那里您可以循环`imageList`并处理找到的每个图像。最后，您可以使用`uigetdir`向用户询问包含图像集的目录。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T20:51:57.317

您可以将绝对和相对文件路径传递给 IMREAD 和 IMWRITE。例如，绝对路径将是：

```
filePath = 'C:\mywork\matlab\images\picture1.jpg'; 
```

如果您已经将 MATLAB 中的当前工作目录更改为“C:\mywork\matlab”，那么相对路径（*相*对于当前目录）将是：

```
filePath = 'images\picture1.jpg'; 
```

此外，要考虑的另一件事是您的路径字符串在不同平台上的工作情况。例如，Windows 相对路径将是：

```
filePath = 'toolbox\matlab\iofun'; 
```

但是 UNIX 相对路径是：

```
filePath = 'toolbox/matlab/iofun'; 
```

请注意，一个使用反斜杠，一个使用正斜杠。为确保您的代码可以跨多个平台工作，我会查看这些 MATLAB 函数来处理文件路径（仅举几例）：[FULLFILE](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/fullfile.html)、[FILEPARTS](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/fileparts.html)、[FILESEP](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/filesep.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T19:38:59.377

其他回复讨论了 matlab 将在当前目录中查找要加载的任何文件的想法。

如果不确定当前目录是什么，请在命令提示符处键入

```
pwd 
```

这将返回当前目录。命令 cd 不带参数使用时，也将显示当前目录名称。cd 还可以帮助您在适当的时候移动到不同的目录。当然，如果您不确定目录中这些文件的名称，dir 会帮助您。

如果您更喜欢使用目录堆栈，那么 pushd 和 popd 是不错的下载函数。

[http://www.mathworks.com/matlabcentral/fileexchange/8103](http://www.mathworks.com/matlabcentral/fileexchange/8103)

如果 matlab 没有找到有问题的文件，并且您没有指定绝对路径（可能由 uigetfile 生成），那么它将查看您搜索路径上的其他目录。所以另一个想法是，如果您经常想从特定目录加载文件，您可以将该目录添加到您的搜索路径中。addpath、rmpath、savepath 和 pathtool 在这里都是有用的工具。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T19:24:54.687

默认情况下`imread()`在当前工作目录中查找图像。一个非常明智的做法是给出`imread`每个图像的绝对路径。

假设您在 Windows 上，您可以执行以下操作：

```
 imdir = 'C:\myproject\images\';
imfile1 = 'image1.jpg';
imfile2 = 'image2.jpg';

im1 = imread([imdir, imfile1]);
im2 = imread([imdir, imfile2]); 
```

这样，如果您决定将图像移动到另一个目录，您只需要更改一行代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-17T18:14:26.850

`cd` displays the current working directory. Place your files in there.

Alternately, change the directory to the one you want first:

[www.mathworks.com/access/helpdesk/help/techdoc/ref/cd.html](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/cd.html)

# xml - Consuming Database Result Sets with Silverlight DataGrid

> ID：761567
> 
> 赞同：0
> 
> 时间：2009-04-17T18:11:05.877
> 
> 标签：xml, silverlight, datagrid, datatable, essbase

So I have a WCF Service that gets a result set from a database (not SQL) - I can get this data as a `DataTable`, `string[][]`, etc.

I can't use LINQ or ADO.NET Entity Framework very easily as it's not coming from an SQL DB.

So my question is:

*   What's the best way to package this data for transmission across the wire? I can use any data structure supported in Silverlight.

*   What's a good way to consume it?

*   Is there any easy way to connect it to a DataGrid?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-07T23:56:32.073

1.  您应该将数据打包到 WCF 服务公开的服务实体中。

2.  SL2 中的 WCF 基本 HTTP 绑定，在 SL3 中，您有更多选项

3.  `<DataGrid ItemsSource="{Binding MyCollectionOfObjects}" />`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-05T23:35:32.647

对不起，但你做错了。

数据集已死。
数据集是最糟糕的做法。
数据集不是解决任何问题的可行技术解决方案。

对于数据访问，您有多种选择：
1\. **Entity Framework** (Microsoft)
2\. **Linq-To-Sql** (Microsoft)
3\. **NHibernate / ActiveRecord** (Open source)
4\. 更多属于 ORM 类别的框架（Object Relational Mapper ) 或持久层。

要开始使用 Microsoft 数据平台，请允许我推荐“我如何”Microsoft 数据视频 @ [http://msdn.microsoft.com/en-us/data/cc300162.aspx](http://msdn.microsoft.com/en-us/data/cc300162.aspx)

对于通过网络传输的数据，您有几个选择：
1.**不是 Web**服务——那些也已经死了。伤心，我知道。
2\. **WCF**
3\. **ADO.Net 数据服务**
4\. **RIA 服务**

每个可能的 ORM 框架选择和通信框架都有优缺点。人们对选择他们的支持框架非常虔诚，所以我会避免提出建议。只需选择最适合您的一种。
不，数据集不算数。

# multithreading - Delphi/Indy IdHttpServer 不是多线程的？

> ID：761582
> 
> 赞同：9
> 
> 时间：2009-04-17T18:14:26.803
> 
> 标签：multithreading, delphi, http, indy

我使用的是 Delphi 2006 和 Indy 10。我创建了一个表单并下拉了一个 IdHttpServer 组件。我为表单创建了一个 OnCreate 事件以将服务器设置为活动状态，并为服务器的 OnCommandGet 输入这些行：

```
procedure TForm3.IdHTTPServerCommandGet(AContext: TIdContext;
  ARequestInfo: TIdHTTPRequestInfo; AResponseInfo: TIdHTTPResponseInfo);
begin
   Beep;
   Sleep(10000);
   AResponseInfo.ContentText := DateTimeToStr(Now);
end; 
```

注意睡眠 10 秒钟。

然后我用 Firefox 进行测试，使用 2 个浏览器。我有第一个连接到“本地主机”，我马上听到哔哔声。然后我切换到第二个浏览器，并让它连接到 localhost（不到 10 秒），但它不会立即发出哔哔声。它等待第一个请求完成，然后发出哔声，再等待 10 秒。

我以为这些组件是多线程的？是否有一些属性我可以设置以使其按照我认为的方式运行（两个请求都会立即得到答复）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-17T23:45:02.843

不是 Indy，并且`TIdHTTPServer`对这种行为负责！是浏览器！

Firefox 为同一服务器上的不同请求共享 TCP 连接。

因此，Firefox 对同一个 URI 的 2 个请求进行序列化。同时打开 2 个不同的浏览器（例如 IE 和 Firefox），`http://localhost/`在这两个浏览器中请求，你会得到预期的结果。

您的问题的答案是：是的，当然，每个`TIdHTTPServer.OnCommandGet`事件都在自己的“调度程序”线程中执行，并且可以同时执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T18:17:50.650

我使用过 Indy 10 idHTTPServer，它*是*多线程的。阻止您的应用程序的可能是“哔”或“睡眠”命令。因为虽然组件是多线程的，但是有些命令可能还是会锁住整个进程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-04-25T03:14:26.700

GUI 在这 10 秒内响应，因此它是多线程的，用于长时间操作将您的代码放入另一个线程 - 您将得到您想要的

```
unit uSomeThread;

interface

uses
  System.Classes;

type
  TSomeThread = class(TThread)
  protected
    procedure Execute; override;
  end;

implementation

procedure TSomeThread.Execute;
begin
  //  Beep;
  Sleep(10000);
end;

end. 
```

............

```
 procedure TServer.IdHTTPServerCommandGet(AContext: TIdContext; ARequestInfo: TIdHTTPRequestInfo; AResponseInfo: TIdHTTPResponseInfo);
var
  cContext: TClientContext;
  t: TSomeThread;
begin
//  Beep;
//  Sleep(10000);

  t := TSomeThread.Create(true);
  t.FreeOnTerminate := true;
  t.Start;

  AResponseInfo.ResponseNo := 200;
  AResponseInfo.CacheControl := 'no-cache';
  AResponseInfo.CustomHeaders.Add('Access-Control-Allow-Origin: *');
  AResponseInfo.ContentText := 'ok';
  AResponseInfo.ResponseNo := 200;
  AResponseInfo.WriteContent;
  Beep;

end; 
```

# java - CMS 对于 Java 的垃圾收集器意味着什么？

> ID：761585
> 
> 赞同：11
> 
> 时间：2009-04-17T18:14:41.000
> 
> 标签：java, garbage-collection, jvm

许多[处理垃圾收集器的 JVM 命令行参数](http://java.sun.com/javase/technologies/hotspot/gc/gc_tuning_6.html#icms.available_options)都带有“CMS”前缀。这代表什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-17T18:16:10.857

[并发标记扫描](http://java.sun.com/javase/6/docs/technotes/guides/vm/cms-6.html)

（或者正如汤姆在评论中提到的那样，*主要是*并发标记扫描。）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-17T18:18:26.000

从理论上讲，它是一种垃圾收集方法或算法，它对应用程序性能的影响小于旧方法。

> 并发标记清除收集器，也称为并发收集器或 CMS，针对对垃圾收集暂停敏感的应用程序。它同时执行大多数垃圾收集活动，即在应用程序线程运行时，以保持垃圾收集引起的短暂停

[G1](http://tech.puredanger.com/2008/05/09/javaone-g1-garbage-collector)是正在考虑/开发的下一个级别。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-03T09:35:36.443

有关详细信息，请参阅[Java 虚拟机中的内存管理](https://www.oracle.com/technetwork/java/javase/tech/memorymanagement-whitepaper-1-150020.pdf)......

# python - 在python中覆盖'to boolean'运算符？

> ID：761586
> 
> 赞同：27
> 
> 时间：2009-04-17T18:15:27.800
> 
> 标签：python

我正在使用从列表继承的类作为数据结构：

```
class CItem( list ) :
  pass
oItem = CItem()
oItem.m_something = 10
oItem += [ 1, 2, 3 ] 
```

一切都很完美，但是如果我在“if”中使用我的类的对象，如果列表底层没有元素，python 会将其评估为 False。由于我的课程不只是列表，我真的希望它仅在为 None 时评估 False，否则评估为 True：

```
a = None
if a :
  print "this is not called, as expected"
a = CItem()
if a :
  print "and this is not called too, since CItem is empty list. How to fix it?" 
```

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-04-17T18:21:14.790

在 2.x 中：覆盖[`__nonzero__()`](https://docs.python.org/2/reference/datamodel.html#object.__nonzero__)。在 3.x 中，覆盖[`__bool__()`](https://docs.python.org/3/reference/datamodel.html?highlight=__bool__#object.__bool__).

# java - How best to sanitize input in Java webapp

> ID：761588
> 
> 赞同：26
> 
> 时间：2009-04-17T18:15:56.380
> 
> 标签：java, security, validation

We use jsp, servlets, beans with mysql database. We don't want to restrict the characters entered by users on form fields. So how do I sanitize the input and how to make sure the output is not changed for malicious activities. Is there way while sending the output I could check if extra code has been sent. Like suppose there is search input field -- the user gives something like `<script>alert("I am here")</script>`. Is there anway I could know this is a html tag. If the user appends an extra parameter to a link field, is there like a before and after check I could do for the document to realize there has been a extra link field.

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-17T21:06:58.933

您确实应该允许用户输入尽可能少的 HTML 和/或 javascript。[验证和清理这些东西的一个很好的解决方案是使用像OWASP AntiSamy](http://www.owasp.org/index.php/Category:OWASP_AntiSamy_Project)这样的现成库。

此外，请查看[OWASP Enterprise Security API](http://www.owasp.org/index.php/Category:OWASP_Enterprise_Security_API)，了解开发人员构建安全 Web 应用程序所需的一系列安全方法。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-03-06T07:17:33.843

试一试[`jsoup`](http://jsoup.org/cookbook/cleaning-html/whitelist-sanitizer)以帮助您解决这个问题。无论你做什么，都不要尝试使用正则表达式或其他东西来破解它，因为那样你就会遇到两个问题。:-)

使用`jsoup`，您只需要一小段代码：

```
String safe = Jsoup.clean(unsafe, Whitelist.basic()); 
```

您可以`Whitelist`相当轻松地添加标签和属性，尽管我发现它不支持命名空间标签。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-17T18:23:12.617

您应该始终对从用户输入或可能包含无效字符的数据库等来源获取的数据进行基本的 HTML 转义。例如，`<c:out>`JSP 标记就是这样做的。这样，如果用户输入`"<script> ..."`一个字段并且您再次打印它，它将被打印到 HTML 为`"&lt;script&gt; ..."`.

# sql-server-2005 - SQL中的计数查询

> ID：761604
> 
> 赞同：0
> 
> 时间：2009-04-17T18:20:16.057
> 
> 标签：sql-server-2005, count

我正在使用 SQL 2005。

表一 LinkedDocumentFolderTable 包含有关保存链接文档的文件夹的名称和信息。

表二，LinkedDocumentTable，包含有关链接文档本身的信息。

这两个表由 LinkedDocumentFolderID 链接。

我需要 LinkedDocumentFolderTable 中的 LinkedDocumentFolderID、Description、FolderURL 和 IsUnmanagedFolder。我还想计算每个文件夹中链接文档的数量（由linkeddocumentfolderid标识）。

下面的语句从为我提供 LinkedDocumentTable 中的文档总数的角度工作，但没有通过linkeddocumentfolderid 将其分解。请帮我重新编写语句以计算每个文件夹中链接文档的数量。提前致谢。

```
select Count(*)
from linkeddocumenttable
    select ld.linkeddocumentfolderid,ld.description,
    ld.folderURL,ld.isunmanagedfolder
    from linkeddocumentfoldertable ld
        inner join linkeddocumenttable l on
        ld.linkeddocumentfolderid=l.linkeddocumentfolderid 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T18:27:55.757

```
select LinkedDocumentFolderTable.LinkedDocumentFolderID, Description,
    FolderURL, IsUnmanagedFolder, DocumentCount
from LinkedDocumentFolderTable
join (select count(*) as DocumentCount, LinkedDocumentFolderID
    from LinkedDocumentTable
    group by LinkedDocumentFolderID) stats
on LinkedDocumentFolderTable.LinkedDocumentFolderID = stats.LinkedDocumentFolderID 
```

这与其他人建议的相关子查询版本之间可能几乎没有区别。对 postgres 的快速测试表明他们确实有不同的计划，如果可能的话，我喜欢进行不相关的查询。另一方面，如果您要限制正在查看的文件夹，则相关查询可能涉及扫描的文档表要少得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T18:25:39.350

我认为您正在寻找获取每个文件夹的文档数的内容类似于：

```
SELECT
    LinkedDocumentFolderID
    ,COUNT(*) AS DocumentCount
FROM
    LinkedDocumentTable
GROUP BY
    LinkedDocumentFolderID; 
```

如果您实际上试图将其作为单个语句获取，那么您可以使用相关的子查询，例如

```
SELECT 
    ld.LinkedDocumentFolderID
    ,ld.Description
    ,ld.FolderURL,
    ,ld.IsUnmanagedFolder
    ,DocumentCount =
         (SELECT COUNT(*) 
          FROM LinkedDocumentTable l
          WHERE l.LinkedDocumentFolderID = ld.LinkedDocumentFolderID)
FROM
    LinkedDocumentFolderTable ld; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T18:26:28.803

如果我遵循正确，这应该可以完成工作：

```
SELECT
    f.LinkedDocumentFolderID,
    f.Description,
    f.FolderURL,
    f.IsUnmanagedFolder,
    (SELECT COUNT(*)
    FROM LinkedDocumentTable d
    WHERE d.LinkedDocumentFolderID = f.LinkedDocumentFolderID) NumDocuments
FROM LinkedDocumentFolderTable f
ORDER BY f.LinkedDocumentFolderID; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T18:29:08.080

在子查询中，获取每个 LinkedDocumentFolderID 有多少文档的计数，然后将它们加入到您想要的其余信息中。

```
SELECT LinkedDocumentFolderID, Description, FolderURL, IsUnmanagedFolder, Num_Docs
FROM LinkedDocumentFolderTable, (
    SELECT LinkedDocumentFolderID, COUNT(*) AS Num_Docs
    FROM LinkedDocumentFolderTable folders, LinkedDocumentTable docs 
    WHERE folders.LinkedDocumentFolderID=docs.LinkedDocumentFolderID
    GROUP BY LinkedDocumentFolderID
) AS DocsPerFolder
WHERE DocsPerFolder.LinkedDocumentFolderID=LinkedDocumentFolderTable.LinkedDocumentFolderID 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-17T18:30:33.910

您需要它们在同一个查询中吗？我问的原因是，如果您这样做，您将为每个文档提供文件夹中文档数量的计数。

假设你这样做了，让我们来布置你在这里得到的东西（这可能不是你所描述的，但它会成为一个很好的例子）：

> **LinkedDocumentFolder** -- ID、文件夹名称
> 
> **LinkedDocument** -- ID、LinkedDocumentFolderID、描述

首先，您需要的是一份文件清单，当然是：

```
SELECT * FROM LinkedDocument 
```

现在，由于您还需要文件夹信息，因此您需要将其加入：

```
SELECT ldf.FolderName, ld.*
FROM LinkedDocument ld
INNER JOIN LinkedDocumentFolder ldf ON ldf.ID = ld.LinkedDocumentFolderID 
```

现在，有趣的部分。由于我们的假设是您希望返回数据集的每条记录都包含文档列表，因此您现在需要的是在该特定列表中包含一个计数。您想要的是添加另一个联接，该联接仅适用于计数：

```
SELECT ldf.FolderName, ld.*
FROM
   LinkedDocument ld
   INNER JOIN LinkedDocumentFolder ldf ON ldf.ID = ld.LinkedDocumentFolderID 
   INNER JOIN (
      SELECT LinkedDocumentFolderID, COUNT(ID) AS DocCount
      FROM LinkedDocument
      GROUP BY LinkedDocumentFolderID
   ) AS CNT ON cnt.LinkedDocumentFolderID = ldf.ID 
```

# ruby - 我如何在鞋类中进行子类化？

> ID：761612
> 
> 赞同：0
> 
> 时间：2009-04-17T18:23:48.200
> 
> 标签：ruby, subclass, shoes

这是我正在谈论的一个简单的测试 Ruby Shoes 程序：当我尝试使用子类语法时，喜欢`class Hello < Shoes`并运行我的程序，它会抱怨“未定义的方法参数”或“未定义的方法堆栈”。显然它不能继承鞋类，因此对“para”或“stack”方法一无所知。但是，当我将它作为一个块传递给 Shoes.app 时，它运行良好，例如`Shoes app do....`.

可能是什么问题呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T21:06:31.307

让我猜猜，你正在尝试做这样的事情：

```
class MyClass < Shoes

  stack :width => 200 do
    subtitle 'People who like ponies'
    para 'TheTXI'
    para 'Pesto'
    para 'Einstein'
  end

  stack :width => -200 do
    subtitle 'People who hate ponies'
    para 'Hitler'
    para 'Stalin'
    para 'Einstein (He was bipolar)'
  end
end 
```

好吧，这当然行不通。 `para`, `stack`,`subtitle`等都是实例方法，但您试图将它们称为类方法。它们必须在实例方法中，如下所示：

```
class MyClass < Shoes
  url '/', :pony_list

  def pony_list
    stack :width => 200 do
      subtitle 'People who like ponies'
        para 'TheTXI'
        para 'Pesto'
        para 'Einstein'
      end

      stack :width => -200 do
        subtitle 'People who hate ponies'
        para 'Hitler'
        para 'Stalin'
        para 'Einstein (He was bipolar)'
      end
    end
  end

  Shoes.app :width => 400 
```

看看`pony_list`现在方法中的那些东西是怎样的？当然，我们必须让一个实例调用该方法。我们怎么能做到这一点？这就是我们调用该`url`方法的原因（与`para`它的朋友不同，它实际上是一个类方法）。它设置默认 url 来调用该`pony_list`方法。请记住，您必须在类定义之后调用 Shoes.app 并且一切就绪。

# security - 通过http实现安全性的最佳方式是什么

> ID：761613
> 
> 赞同：0
> 
> 时间：2009-04-17T18:23:52.133
> 
> 标签：security, http, ssl, https

我知道使用 SSL 是一种方法。我访问了 Facebook 和 LinkedIn 等网站，发现他们仅在处理密码和个人设置等敏感数据时才使用 https。这是怎么做到的？他们如何能够在某些网站上实现 https，同时在其他网站上使用 http，同时仍然保持安全，或者是吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T18:34:04.603

这种方法并不安全。好吧，使用 HTTPS 时它是安全的，但是一旦您切换到 HTTP，所有数据都将通过未加密的线路传输。会话 ID cookie（或维护状态和用户身份）也是如此。因此，在未加密的线路上窃取该信息并试图冒充您仍然存在差距。

但这种双车道方法很常见。因为HTTPS有一些缺点。一个是昂贵的（加密传出和解密传入数据），另一个是它至少禁用公共缓存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T19:04:31.660

安全性不仅仅是 HTTP/HTTPS。这些只是为了防止数据在网络上被读取。

在 HTTP 站点上执行 HTTPS 请求的最简单方法是通过操作为[https://yoursite/login](https://yoursite/login)或类似内容的表单。这将导致您转到该页面，并且这些页面通常会返回到您的来源或将您转发到主页。这就是 Facebook 的做法。该站点的其余部分被认为是相对安全的，因为访问控制是为了确保那些有权查看某些内容的人是唯一可以这样做的人。这不能防止 Wireshark 或其他嗅探流量的工具。通过 ajax 发帖是个坏主意，因为使用跨站点脚本很容易弄乱 ajax 调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T18:27:58.207

他们的 HTTP 站点并不安全——通常，在处理社交网络登录等事务时，HTTPS 的开销被认为是不必要的。例如，StackOverflow 是不安全的——拥有网络嗅探器的人可以拦截登录 cookie 并冒充用户。

如果您只需要检查登录是否有效，并且不太关心可用性，则可以使用[摘要身份验证](http://en.wikipedia.org/wiki/Digest_access_authentication)。它提供了一种通过 HTTP 传输用户名和密码的安全方式。当然，从网站发回或用户提交的任何数据都容易受到嗅探。

短版：如果您需要安全性，请使用 HTTPS。您甚至可以从[CAcert](http://www.cacert.org/)等网站获得免费证书。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T18:41:56.020

It depends on what you are trying to protect and how much hassle you want for the user, if you are not using https.

You can selectively encrypt the data in javascript so that only sensitive information is protected, but that is risky as anything done in javascript can be reverse-engineered.

You can look at my answer here for one way to do it in javascript: [How Do I encrypt post data while using ajax and JQuery?](https://stackoverflow.com/questions/760273/how-do-i-encrypt-post-data-while-using-ajax-and-jquery/760324#760324)

If you just don't want the data to be modified while being transmitted you can get create a hash, or convert the data to a hash if you saved it as a hash. Passwords are often saved as a hash, so this would make sense for them.

You can do all of this in javascript, but it will slow down transmitting the data.

If you are using webservices, which also go through http, then these options also work, but they can be faster as the program would not be in javascript.

# parameters - 有没有办法指示批处理文件中的最后 n 个参数？

> ID：761615
> 
> 赞同：48
> 
> 时间：2009-04-17T18:23:58.233
> 
> 标签：parameters, shell, cmd

在以下示例中，我想从父批处理文件调用子批处理文件并将所有剩余参数传递给子批处理文件。

```
C:\> parent.cmd child1 foo bar
C:\> parent.cmd child2 baz zoop
C:\> parent.cmd child3 a b c d e f g h i j k l m n o p q r s t u v w x y z 
```

在 parent.cmd 中，我需要从参数列表中删除 %1，并且只将剩余的参数传递给子脚本。

```
set CMD=%1
%CMD% <WHAT DO I PUT HERE> 
```

我已经研究过将 SHIFT 与 %* 一起使用，但这不起作用。虽然 SHIFT 会将位置参数向下移动 1，但 %* 仍然指的是原始参数。

有人有想法么？我应该放弃并安装Linux吗？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2009-04-17T18:33:30.533

`%*`遗憾的是，将始终扩展到所有原始参数。但是您可以使用以下代码片段来构建一个包含除第一个参数之外的所有参数的变量：

```
rem throw the first parameter away
shift
set params=%1
:loop
shift
if [%1]==[] goto afterloop
set params=%params% %1
goto loop
:afterloop 
```

我认为它可以做得更短，虽然......我不经常写这些东西:)

不过应该可以。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-09-03T14:01:39.300

这是使用“for”命令的单行方法...

```
for /f "usebackq tokens=1*" %%i in (`echo %*`) DO @ set params=%%j 
```

此命令将第一个参数分配给“i”，其余（用“*”表示）分配给“j”，然后用于设置“params”变量。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-12-20T11:25:01.373

**警告！**如果参数中有 «*» 或 «?»，此方法具有扩展通配符的副作用。如果存在通配符但没有对应的文件，则跳过参数（非通配符参数保持原样）。如果参数必须保持不变，请寻找另一种方式。

* * *

线

```
%CMD% <WHAT DO I PUT HERE> 
```

应改为：

```
(
  SETLOCAL ENABLEDELAYEDEXPANSION
  SET skip=1

  FOR %%I IN (%*) DO IF !skip! LEQ 0 (
        SET "params=!params! %%I"
    ) ELSE SET /A skip-=1
)
(
  ENDLOCAL
  SET "params=%params%"
)
%CMD% %params% 
```

当然，您可以将*skip* var 设置为任意数量的参数。

解释：

```
(
@rem Starting block here, because it's read once and executed as one
@rem otherwise cmd.exe reads file line by line, which is waaay slower.

SETLOCAL ENABLEDELAYEDEXPANSION
SET skip=1

@rem if value contains unquoted non-paired parenthesis, SET varname=value 
@rem confuses cmd.exe. SET "a=value" works better even if value has quotes.
  FOR %%I IN (%*) DO (
    IF !skip! LEQ 0 (
      SET "params=!params! %%I"
      @rem newline after SET to lower amount of pitfalls when arguments 
      @rem have unpaired quotes
    ) ELSE (
      SET /A skip-=1
    )
)
(
@rem get variables out of SETLOCAL block
@rem as whole block in parenthesis is read and expanded before executing,
@rem SET after ENDLOCAL in same block will set var to what it was before
@rem ENDLOCAL. All other envvars will be reset to state before SETLOCAL.
ENDLOCAL
SET "params=%params%"
)
@rem doing this outside of parenthesis block to avoid
@rem cmd.exe confusion if params contain unquoted closing round bracket
%CMD% %params% 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-10-01T20:42:22.227

你实际上可以这样做：

```
%* 
```

如果这是该行中唯一的内容，则扩展为将第一个参数*作为*执行的命令，并将所有其他参数传递给它。:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-12-20T11:15:58.700

另一种方式（几乎与 Alxander Bird 相同）而不在子shell 中执行 ECHO：

```
FOR /F "usebackq tokens=1*" %%I IN ('%*') DO SET params=%%J 
```

所以，线

```
%CMD% <WHAT DO I PUT HERE> 
```

看起来像：

```
FOR /F "usebackq tokens=1*" %%I IN ('%*') DO %CMD% %%J 
```

问题是，如果参数包含带引号的字符串，其中包含空格，cmd.exe 将适当地解析它们以用作编号参数 (%1)，但 FOR 将忽略引号。在这种特殊情况下，如果第一个参数包含一个或更多空格，这是很可能的，考虑到第一个参数可以是例如“C:\Program Files\Internet Explorer\iexplore.exe”。

所以，这里将是另一个答案。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-04-11T14:43:32.910

我改进了 Moshe Goren 的答案，因为它似乎对我不起作用：

```
set _input=%*
call set params=%%_input:%1 =%%
@echo %params% 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-12-12T09:49:50.567

虽然在很多情况下，'for' 解决方案确实是优越的，但对于一些简单的事情，我经常只是保存并将其他参数移开，然后`%*`像往常一样使用（实际上相同的策略通常适用于`$*`或`$@`in `{,ba,da,k,*}sh`）：

***例子：***

```
:: run_and_time_me.cmd - run a command with the arguments passed, while also piping
::                       the output through a second passed-in executable

@echo off

set run_me=%1
set pipe_to_me=%2
shift
shift

:: or
:: set run_me=%1
:: shift
:: set pipe_to_me=%1
:: shift

%run_me% %* | %pipe_to_me% 
```

无论如何，我看到这个问题已经得到了很长时间的回答，但我想我会放弃两美分，因为这是我没有看到的东西，而且因为这是我几年前终于遇到它时需要的答案.. .然后去“哦......呃。” :)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-09-25T06:34:08.167

我在遇到类似问题时遇到了这个问题，但我使用不同的方法解决了这个问题。我没有使用循环重新创建输入行（如@Joey 的回答），我只是从输入字符串中删除了第一个参数。

```
set _input=%*
set params=!_input:%1 =!
call OTHER_BATCH_FILE.cmd %params% 
```

当然，这是假设所有参数都不同。

# c++ - 使用 Xerces C++ 对 DOM 部分进行 XML 序列化

> ID：761616
> 
> 赞同：3
> 
> 时间：2009-04-17T18:23:58.310
> 
> 标签：c++, xml, dom, serialization, xerces

我一直在努力使用 Xerces C++ 并且我对 XML 的所有内容都不熟悉，但是我需要将 XML 用于我正在从事的项目。

我的问题是如何序列化我已经从 XML 实例文档（根据我编写的模式验证）解析和创建的 DOM 树的部分，以便我可以创建许多新的实例文档（仍然包含原始文档）以某种方式对我的架构保持有效？

更具体地说，我有一个大型实例文档，其中包含在单个根元素中的数千个集合，我需要将其单独放入单独的文件中以供以后处理。基本上是一大组集合，每个集合都需要放入单独的文件中，并且仍然单独验证。

我迷失了如何做到这一点的整个过程。我没有任何运气找到序列化 DOM 树部分的示例，而且我发现很多围绕 XML 相关文档的术语没有什么帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T18:28:51.467

[这篇](http://www.ibm.com/developerworks/xml/library/x-xsdxerc.html)文章（部分：使用语法序列化到磁盘的 XML Schema 验证）有帮助吗？

我们已经成功地使用了[这里](http://www.ibm.com/developerworks/xml/library/x-serial.html)`MemBufFormat`描述的。

# plugins - 正在使用简化的 RAILS 插件？

> ID：761617
> 
> 赞同：1
> 
> 时间：2009-04-17T18:24:21.197
> 
> 标签：plugins

看起来 Plugin Streamlined 大获全胜，然后我看不到太多。有人在用吗？值得一看吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-20T08:59:46.873

我几乎在使用 Rails 编写的所有内容中都使用了它，并发现它是我尝试过的任何其他脚手架插件所无法超越的。试试看，也许先看看教程。玩得开心

# email - Linux postfix 不会发送到本地域

> ID：761621
> 
> 赞同：1
> 
> 时间：2009-04-17T18:24:55.547
> 
> 标签：email, postfix-mta, mx-record

我认为这个问题的症结在于我是一个`postfix`新手，但这里有。

我在 1&1 VPS 帐户上使用`postfix`'s`sendmail`从网络服务器发布消息（通过 PHP；联系表格、密码重置等）。它工作正常，除了邮件无法发送到本地域。也就是说，如果主机是 example.com，则根本不会传递到 x@example.com 的任何消息。

我已经看到一些建议，这是因为服务器识别出邮件正在发送给自己，并缩短了出站 SMTP 方法。麻烦的是，我们正在使用 1&1 的电子邮件管理器来分配转发地址，因此将 x@example.com 重定向到 x 的服务器帐户不适合我们的情况（通过主机的 Web 界面，我们可以将 x@example.com 设置为转发到 x@gmail.com，这就是我们正在做的）。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T18:27:58.097

看看 .Forward 文件[http://www.feep.net/sendmail/tutorial/intro/forward.html](http://www.feep.net/sendmail/tutorial/intro/forward.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T18:44:49.493

除了不清楚你是在运行 postfix 还是 sendmail（你不能同时运行，它不起作用），你也不清楚你希望“example.com”的电子邮件去哪里。

如果您希望将其交付到该机器上的本地帐户，那么您必须告诉 postfix（假设您确实在运行 postfix）您是 example.com 的终点交付。您可以在 /etc/postfix/main.cf 文件中执行此操作。我忘记了该选项的确切名称，但是当您看到它时就很明显了。

然后，如果您想将特定地址转发到其他地方，您可以在 /etc/postfix/aliases（有时是 /etc/aliases，取决于设置）或 /etc/postfix/virtual 中转发它们。不要忘记在更新该文件后运行“postmap /etc/postfix/aliases; postfix reload”。

# cocoa - Xcode / Cocoa：调试和发布版本之间有什么区别？

> ID：761628
> 
> 赞同：15
> 
> 时间：2009-04-17T18:26:55.853
> 
> 标签：cocoa, xcode, debugging

Cocoa 应用程序的调试版本和发布版本之间有什么区别？我知道调试版本包含用于调试的附加信息，但还有什么不同？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-04-17T18:38:47.730

调试版本将包含调试器可以使用的调试符号。发布版本通常不包含调试符号，因此如果您获得故障转储，您将得到的只是一堆十六进制地址而不是有用的符号名称。

调试版本不是使用优化编译的（`-O0`使用 gcc），而发布版本是使用优化编译的（通常是`-O2`or `-O3`）。优化使调试变得更加困难。如果您尝试调试发布应用程序，调试器将变得非常混乱，因为汇编语句不再与 HLL 语句匹配，语句被重新排序，函数被内联，循环被展开等等。

调试和发布版本还定义了不同的预处理器符号，并且一些代码基于这些符号有条件地编译（例如，数组边界检查、断言等），尽管这高度依赖于应用程序。一个典型的例子是`#define NDEBUG`for release 模式，它会导致断言被删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-18T16:21:21.637

在 Tiger 中，调试版本是“零链接”的。这是它仅针对您的环境进行了优化，并不是真正的完整构建。

# design-patterns - DDD：保存对模型的更改并访问存储库

> ID：761630
> 
> 赞同：2
> 
> 时间：2009-04-17T18:27:14.387
> 
> 标签：design-patterns, architecture, domain-driven-design

我有一个 Question 对象，它是 Question Aggregate 的根。该问题在其聚合中关联了答案实体。创建新的 Answer 对象时，更改将通过存储库保存到 DB。我可以调用存储库方法 SaveAnswer(Question ID) 还是必须调用 SaveQuestion(QUestionID) 并让存储库确定进行了哪些更改？如果是后者，这是如何实现的？

相反，如果我想加载特定问题的所有答案，我必须调用 GetQuestion() 然后提取答案，或者我可以简单地调用 GetAnswers(questionID)。

蒂亚

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-17T20:28:20.117

首先，让我说这里没有硬性规定，这是我对 DDD 和存储库访问的理解，但这是一个相当主观的领域......

因此，从 DDD 的角度来看，在向现有问题添加答案时，您可能想要做的是类似于以下 C# 样式的伪代码：

```
using(unitOfWork = new UnitOfWork())
{
  var question = _questionRepository.GetQuestion(questionId);
  question.AddAnswer(new Answer("blah"));
  unitOfWork.SaveChanges();
} 
```

假设您正在使用一个处理更改跟踪的 ORM，并且该 ORM 配置为将子对象级联回数据库，这就是您需要做的所有事情（我在这里考虑的是 NHibernate，但其他 ORM 可以以类似的方式工作）。通过添加对问题的答案，您已经告诉 ORM 您希望在工作单元完成时将答案保留在数据库中。您通常不会调用 SaveAnswer(QuestionId) - 这不是一种非常以 DDD 为中心的处理方式，其中 Answer 与 Question 处于同一聚合中，并且 Question 是聚合根。

为了从数据库中获取对象，通常您会向存储库询问问题对象（可能是通过 id），然后从那里导航到答案（通过问题上的 Answers 集合） - 例如

```
var question = _questionRepository.GetQuestion(questionId);
foreach(var answer in question.Answers)
{
  Console.WriteLine(answer.Description); // or do something useful instead!
} 
```

如果这似乎是一种奇怪的保存或检索 Answer 对象的方式，那么您可能需要重新评估 Answer 是否确实属于同一聚合，或者是否最好将其完全从问题聚合中分离出来。

# c# - 在 RadWindows 中选择一个 RadGrid 行（客户端）

> ID：761633
> 
> 赞同：7
> 
> 时间：2009-04-17T18:27:30.440
> 
> 标签：c#, javascript, asp.net, telerik

我在 RadWindow 中有一个 RadGrid。我需要在客户端选择一个 Radgrid 行。
我怎样才能做到这一点？

我正在尝试像这样获得 radgrid：

```
var masterTable = $find("<%=radgridID.ClientID%>").get_masterTableView(); 
```

但总是变得空...

有什么帮助吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-22T16:21:42.587

我明白了...代码：

```
var oManager = GetRadWindowManager();  
var oWnd = oManager.GetWindowByName("RadWindow1");     
var grid = oWnd.GetContentFrame().contentWindow.$find('RadGrid1') //Get reference to RadGrid 
var masterTable = grid.get_masterTableView();  
masterTable.selectItem(3);  //Select 4th row 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-17T18:58:53.857

您的 Javascript 是否在 RadCodeBlock 中：

```
<telerik:HeadTag runat="server" ID="Headtag2"></telerik:HeadTag>
    <!-- custom head section -->
    <telerik:RadCodeBlock ID="RadCodeBlock1" runat="server">
        <script type="text/javascript">
         <!--
            function RowSelected(sender, args)
            {
                document.getElementById("<%= Label1.ClientID %>").innerHTML =
                 "<b>CustomerID: </b>" + args.getDataKeyValue("CustomerID") +
                 "<br />" +
                 "<b>CompanyName: </b>" + args.getDataKeyValue("CompanyName");
            }

            function GetFirstDataItemKeyValues()
            {
             var firstDataItem = $find("<%= RadGrid1.MasterTableView.ClientID %>").get_dataItems()[0];
             var keyValues =
                    'CustomerID: "' + firstDataItem.getDataKeyValue("CustomerID") + '"' +
                 ' \r\n' +
                 'CompanyName: "' + firstDataItem.getDataKeyValue("CompanyName") + '"';
             alert(keyValues);
            }
            -->
        </script>
        </telerik:RadCodeBlock>
    <!-- end of custom head section -->
</head> 
```

这是示例的[链接。](http://demos.telerik.com/aspnet-ajax/grid/examples/client/keys/defaultcs.aspx)我犯了同样的错误，只包含 javascript 函数但没有代码块选项卡。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-24T14:56:11.130

```
var grid = $find("<%=grdList.ClientID %>");
var firstDataItem = grid.get_masterTableView().get_dataItems()[grid._selectedIndexes[0]];
var keyValues = firstDataItem.getDataKeyValue("id_estadoreq");
alert(keyValues); 
```

试试这个！

# java - 为什么我会收到带有本机代码的 UnsatisfiedLinkError？

> ID：761639
> 
> 赞同：7
> 
> 时间：2009-04-17T18:28:00.733
> 
> 标签：java, native

我有一个名为 HelloWorld.so 的库和一个包含以下内容的程序 HelloWorld.java：

```
class HelloWorld {
     private native void print();
     public static void main(String[] args) {
         new HelloWorld().print();
     }
     static {
         System.loadLibrary("HelloWorld");
     }
 } 
```

现在，当我尝试运行 HelloWorld.java 时，出现此错误：

```
$ /usr/java1.4/bin/java HelloWorld
线程“主”中的异常
java.lang.UnsatisfiedLinkError：java.library.path 中没有 HelloWorld
        在 java.lang.ClassLoader.loadLibrary(ClassLoader.java:1491)
        在 java.lang.Runtime.loadLibrary0(Runtime.java:788)
        在 java.lang.System.loadLibrary(System.java:834)
        在 HelloWorld.<clinit>(HelloWorld.java:7)

```

有小费吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-07-09T22:08:38.907

我遇到了这个问题，并通过将我的库重命名为`libHelloWorld.so`并遵循 Michael Myers 的建议来解决它。我在 Arch Linux 64 位。

`HelloWorld.c`：

```
#include <jni.h>
#include <stdio.h>
#include "HelloWorld.h"

/* shamelessly stolen from the book 'The Java Native Interface: Programmer's
   Guide and Specification' */
JNIEXPORT void JNICALL
Java_HelloWorld_print (JNIEnv *env, jobject obj) {
    printf("Hello World!\n");
} 
```

`HelloWorld.java`：

```
class HelloWorld {
     private native void print();
     public static void main(String[] args) {
         new HelloWorld().print();
     }
     static {
         System.loadLibrary("HelloWorld");
     }
 } 
```

构建和测试：

```
$ javac HelloWorld.java
$ javah -classpath . HelloWorld
$ gcc -shared -fPIC -I $JAVA_HOME/include -I $JAVA_HOME/include/linux HelloWorld.c -o libHelloWorld.so
$ java -classpath . -Djava.library.path=. HelloWorld
Hello World! 
```

**tl;dr：放在`lib`库文件名的开头**

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-12-09T10:11:29.280

我认为在收到此错误时有些要点会有所帮助：

1.  *检查.c 文件和生成的文件 (* .h)中函数名称的一致性
2.  基于操作系统的 jni 库名称。例如：在 HelloWorld.java 中，`System.loadLibrary("HelloWorld");`
    *   索拉里斯：`libHelloWorld.so`
    *   Linux：`libHelloWorld.so`
    *   赢：`HelloWorld.dll`
    *   苹果电脑：`libHelloWorld.jnilib`
3.  运行时，添加`-Djava.library.path=PATH`. `PATH`放置你的 jni 库

这是我的参考：[https ://blogs.oracle.com/moonocean/entry/a_simple_example_of_jni](https://blogs.oracle.com/moonocean/entry/a_simple_example_of_jni)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-17T18:29:43.570

HelloWorld.so位于哪里？您可能需要使用命令行参数指定其父目录`"-Djava.library.path"`。

例如，如果它在 中`"/path/libs/HelloWorld.so"`，则在调用时添加`-Djava.library.path=/path/libs`为选项`java`。例如，它`"-Djava.library.path=lib"`在我的一个项目中。

**编辑：** Dan Dyer 指出环境变量`LD_LIBRARY_PATH`也可以用于此。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-20T16:26:02.360

@mmyers 感谢您的回复。我们发现我们所要做的就是将 System.loadLibrary 更改为 System.load 并将完整路径 + 文件名作为参数传递，就像一个魅力一样。

甚至在这样做之前，我们尝试使用“-D”参数并设置 LD_LIBRARY_PATH 但我们没有成功。

去搞清楚！:)

再次感谢，凯伦

# sql - PostgreSQL 可以从函数返回的数组中进行选择吗？

> ID：761641
> 
> 赞同：5
> 
> 时间：2009-04-17T18:28:28.173
> 
> 标签：sql, xml, postgresql

此查询失败：

```
SELECT xpath('/my/xpath/expr', my_xml)[1] FROM my_table

ERROR:  syntax error at or near "[" 
```

但这一个有效：

```
SELECT x[1] FROM
    (SELECT xpath('/my/xpath/expr', my_xml) as x FROM my_table) as ss 
```

我的 xpath 表达式总是只返回一个值，但 Postgres xpath 函数返回一个数组。我想选择数组中的第一个值。虽然子选择有效，但它非常难看。

为什么第一个查询不起作用，有没有比第二个查询更干净的方法呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-17T18:56:39.697

这个怎么样：

```
SELECT (xpath('/my/xpath/expr', my_xml))[1] FROM my_table; 
```

# wcf - RESTful WCF Starter Kit 中的句号

> ID：761644
> 
> 赞同：0
> 
> 时间：2009-04-17T18:29:14.523
> 
> 标签：wcf, rest

我正在使用 RESTful WFC 的 WebInvoke 和 WebGet 属性类。在 UriTemplate 参数中，我想捕获一个包含句点字符的变量。我该怎么做？

所以

```
[WebInvoke(Method = "PUT", UriTemplate = "{id}")]
[OperationContract]
TItem UpdateItemInXml(string id, TItem newValue); 
```

我希望它与网址匹配： [http://service.svc/A.1](http://service.svc/A.1)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-17T20:59:36.627

我找不到这样做的方法。我实现的解决方案是对 URL 中的 id 进行 base64 编码。

# python - 如果你要在 Python 中克隆 Monopoly Tycoon，你会使用哪些库？

> ID：761652
> 
> 赞同：3
> 
> 时间：2009-04-17T18:30:52.710
> 
> 标签：python, opengl

玩过大富翁游戏吗？我认为这很棒。我很想重拍它。不幸的是，我在 3D 编程方面没有经验。我想当涉及到openGL的东西时，有一个相对陡峭的学习曲线，弄清楚点击了什么等等......

如果您要承担这项任务，您需要哪些库？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-17T18:36:22.180

[pyGame](http://www.pygame.org/news.html) seems quite mature and builds on top of the proven SDL library.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-18T08:40:11.683

我会使用pyglet。从一开始就是opengl，不是建立在丑陋的SDL库之上，并且比我在其他python的多媒体库上看到的接口更好。

```
import pyglet
from pyglet.gl import *

class Application(object):
    def __init__(self):
        self.window = window = pyglet.window.Window()
        window.push_handlers(self)

    def on_draw(self):
        self.window.clear()
        glBegin(GL_TRIANGLES)
        glVertex2f(0,0)
        glVertex2f(200,0)
        glVertex2f(200,200)
        glEnd()

if __name__=='__main__':
    app = Application()
    pyglet.app.run() 
```

我从头开始写这个给你一个参考。你几乎可以从那开始。

库中有一些有用的东西，比如顶点列表、纹理、调度、unicode 字体、一些 UI 组件、事件调度、音频。图书馆本身很乱，我不太喜欢它。但是，这是我对每个已经广泛传播并且我研究过的图书馆的看法。

我自己对 opengl 命名空间不满意。在前面使用非 C 命名空间会更好。这会给你一些灵活性：

```
from pyglet.gl import Begin, Vertex2f, TRIANGLES, End

...
    Begin(TRIANGLES)
    Vertex2f(0,0)
    Vertex2f(200,0)
    Vertex2f(200,200)
    End() 
```

# c++ - typdef 复杂 STL 映射时的命名约定是什么？

> ID：761655
> 
> 赞同：13
> 
> 时间：2009-04-17T18:32:52.283
> 
> 标签：c++, stl

1) typedef'ing 时实际使用的约定是什么

就像是

```
typedef std::map<SomeClass*, SomeOtherClass>  [SomeStandardName>]
typedef std::map<SomeClass*, std<SomeOtherClass> >  <[SomeStandardName] 
```

2）你通常把 typedef: 全局头文件放在哪里，类本地？

3) 你是 typedef 迭代器还是 const map<> 版本？

4）假设您有两个不同概念使用的地图，您是否为它们创建了两个单独的 typedef？

```
typedef map<string, SomeClass *> IDToSomeClassMap;
typedef map<string, SomeClass *> DescriptionToSomeClassMap; 
```

谢谢

* * *

**编辑#1**

我对 typedef STL 映射特别感兴趣，例如

```
typedef map<int, string> IdToDescriptionMap 
```

或者

```
typedef map<int, string> IdToDescription 
```

什么是常见的做法？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-17T18:42:07.907

我更喜欢以下约定：

```
typedef std::map< Foo, Bar > FooToBarMap 
```

我故意避免对迭代器进行类型定义，我更喜欢明确地将它们称为：

```
FooToBarMap::const_iterator 
```

因为迭代器已经是*事实上的*标准类型名。我发现，在略读代码时，FooToBarMapConstIter 实际上读起来不太清楚。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T18:40:37.163

这些名称没有普遍认可的规则。我通常做的就是使用“值”类的名称，以 Map 为后缀。在您的示例中，这将是*SomeOtherClassMap*。我使用这种约定是因为通常更有趣的是，您的地图包含*SomeOtherClass类型的“值”对象，然后使用**SomeClass*的“键”查找它们。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-19T00:33:47.820

问题的第二部分对我来说是最有趣的。我更喜欢将`typedef`s 放在使用它们的类中，当它们有一个合乎逻辑的位置时，即使它们在其他类中使用。但这会导致前向声明出现一些问题（我们大量使用它来提高编译速度）。

例如，在最近的一个项目中，我们有一个名为 的类`Io`，其中嵌入了一个名为 的 typedef `Point`，这使得代码非常易读—— an`Io::Point`非常清晰易读。但是每当我们想使用该类型时，我们必须包含`Io`类的声明，即使我们需要的只是声明`Io::Point`，因为没有办法（据我所知）前向声明一个在前向内的类型-声明的类。

在那种情况下，我们最终都这样做了。我们创建了一个全局`IoPoint`类型，然后`typedef`d`Io::Point`到它（这样我们已经编写的代码就不必修改了）。不是最漂亮的答案，但它完成了工作。

至于其他部分：

我们不对名称使用任何特殊约定。对于地图，我们经常使用 *DescriptiveSomething***Map**（因为我们不太可能从地图更改为其他容器类型），但如果*DescriptiveSomething*具有足够的描述性并且与现有名称不冲突，我们会经常使用它。

我们通常不会费心为迭代器创建 typedef，因为简单地使用`Type::iterator`or很容易（并且非常易读） `Type::const_iterator`。也就是说，如果类型名称太长以至于使代码看起来太“笨重” ，*我们有时会对它们进行 typedef。*`Type::const_iterator`（不知道有什么更好的表达方式，但你可能知道我的意思。）

我们为每个概念创建不同的 typedef，即使其中两个定义完全相同的类型。它们可以相互独立地更改，因此为它们使用不同的类型名称可以简化以后的任何重构。在许多情况下，它还使代码更具可读性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T18:35:23.820

我不知道这个主题是否有任何正式规则，但我通常在最适合项目中使用的位置添加类型定义。

*   如果 typedef 仅在一个类中使用，则在类定义中添加 typedef
*   如果 typedef 被多个不相关的类使用，则将其添加到命名空间范围级别的头文件中

至于 typedef'd 类型的实际名称。我将它命名为对 typedef 有意义的任何名称。我没有为 typedef 名称提供任何特殊约定，例如以 _t 为前缀或类似的任何内容。例如

```
typedef stl::map<stl::string,Student> NameToStudentMap; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-17T18:37:30.227

没有，只要记住命名标识符的一般规则（不`_`以等开头）。此外，如果您的组织有编码指南，最好坚持下去。

通常，在定义您自己的模板类时，如果没有 typedef，它会变得很混乱——所以我会在那里创建它们作为方便的快捷方式。但是，如果它真的是一堆类，我宁愿有它的`namespace`水平。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-17T18:39:04.983

我们在我的工作场所使用以下内容：

```
typedef std::map 不管映射；
typedef WhatMap::iterator WhatIter;
typedef WhatMap::const_iterator WhatCIter;

```

就位置而言，这会有所不同。如果它是特定于类的，它可能在 Impl 结构中，或者可能在类声明的受保护或私有区域中。如果它更通用（跨文件使用，在 API 中使用），我们将其放在单独的“FooTypes.h”样式标题中。

请注意，由于我们有时更改底层类型很常见，因此我们可以使用“WhateverCollection”而不是“WhateverVec”或“WhateverList”。根据所需的占用空间和性能特征，实际上将“WhateverList”类型定义为向量或 slist 的情况并不少见。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-17T18:50:38.417

兴趣问题：
我查看了 boost，我发现它们没有任何全局规则，但最常用的约定

```
typedef std::map< key, value > some_domain_specific_name_map; 
```

或者

```
typedef std::map< key, value > some_domain_specific_name_map_type; 
```

为 value_type 或迭代器创建 typedef 也是一个好习惯，通常它们与 map 具有相同的名称，但以 _value_type、_iterator 结尾。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-17T18:56:17.140

通常我会为 typedef 定义相关的名称来指示对象的类型。

前任：

```
typedef std::vector<ClassCompStudent*> StudentCollection;

typedef std::map<std::string /*id*/, ClassCompStudent* /*pStudent*/>  IDToStudentMap; 
```

另外，我在创建对象的类头中将它们定义为公共的。这给了我在不破坏客户端代码的情况下更改容器类型的好处。

```
class Test
{
public:
    typedef std::vector<ClassCompStudent*> StudentCollection;

    /* Users of Test need not know whether I use vector or list for 
        storing students. They get student collection and use it*/
    bool getStudents(StudentCollection& studentList) const;

    void print()
    {
        //do printing
    }
private:

    StudentCollection m_StudentList;
};

bool function(const Test& testObj)
{
    //If StudentCollection gets changed to list, this code need not be changed.
    StudentCollection aCollection;
    testObj.getStudents(aCollection);
    std::for_each(aCollection.begin(), aCollection.end(), std::mem_fun(&Test::print));
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-18T20:25:33.017

在无用的符号中使用单词“地图”或“矢量”。这些是与实现相关的词，而不是与商业模式相关的词。

您不必表明此类型是矢量或地图。您可以使用列表。像

```
typedef std::vector<std::string> List;
typedef std::set<std::string> List; 
```

这两个都是字符串列表。这是真的。

```
typedef std::map<std::string, Object> List;
or  
typedef std::map<std::string, Object> NamedList; 
```

我的观点是不要使用匈牙利符号。

# .net - .NET：处理 HashAlgorithm 对象

> ID：761660
> 
> 赞同：6
> 
> 时间：2009-04-17T18:34:17.007
> 
> 标签：.net, hashalgorithm

从 HashAlgorithm 派生的对象（例如 MD5CryptoServiceProvider）具有 Dispose() 方法，但它是私有的。相反，它有一个 Clear() 方法，可以“释放所有资源”。

怎么回事？

那么这是如何正确处理 HashAlgorithm 呢？

```
var hasher = new MD5CryptoServiceProvider();

byte[] hashCode = hasher.ComputeHash(data);

hasher.Clear(); 
```

有人想向我解释这个吗？:)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-17T18:39:21.237

虽然该`Dipose()`方法是私有的，但如果您将其强制转换为`IDisposable`您可以访问它。但是，正如其他人所说，`Clear()`将为您调用它。

然而，更好的方法是将变量的声明和赋值包含在 using() 块中：

```
byte[] hashCode;

using(var hasher = new MD5CryptoServiceProvider())
{
    hashCode = hasher.ComputeHash(data);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-17T18:39:16.137

用 Reflector 来看，`Clear`方法`HashAlgorithm`简单的调用了私有`Dispose`方法。公开带有名称的方法的原因`Clear`可能只是类的设计者认为它更适合散列算法的名称。您会在 BCL 的其他部分中看到类似的样式，例如`Close`for `System.IO.Stream`。此外，这里的最佳实践是使用一个`using`块，它会在完成后自动调用私有`Dispose`方法。

* * *

## 回答 #3

> 赞同：-5
> 
> 时间：2009-04-17T18:36:46.983

您应该让 GC 为您处理。这就是它的工作。

一些资源应该被处理掉，比如数据库连接和文件句柄，所以把它们放在一个`using`块中（C#）。不过，这不是其中一种情况。

# c++ - 从 xsd 生成 xml 文件的工具（用于测试）

> ID：761661
> 
> 赞同：8
> 
> 时间：2009-04-17T18:34:19.317
> 
> 标签：c++, xml, xsd

我有一个 xsd 文件，并没有做太多的 xml 操作、解析等。我想要/需要为我的代码测试 xml 文件，但没有任何示例。（我正在使用 xerces 来解析）

这类似于：[xml-instance-generation-from-xml-schema-xsd](https://stackoverflow.com/questions/307616/xml-instance-generation-from-xml-schema-xsd)

但我真的不想让它成为一个两步过程。（蟒蛇或Java）

我只想将 xsd 文件提供给某个工具并让它生成一个示例 xml 文件。我怎样才能做到这一点？

> 另请参阅：[how-to-generate-sample-xml-documents-from-their-dtd-or-xsd](https://stackoverflow.com/questions/17106/how-to-generate-sample-xml-documents-from-their-dtd-or-xsd/730208#730208)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-17T18:48:40.450

Eclipse 有执行此操作的工具（而且它是免费的。）

**编辑**（是的，我有点太简洁了）：你想要的是 Eclipse 中的 XSD 编辑工具。[我知道它与Eclipse IDE for Java EE Developers](http://www.eclipse.org/downloads/download.php?file=/technology/epp/downloads/release/ganymede/SR2/eclipse-jee-ganymede-SR2-win32.zip)捆绑在一起，而且我认为它也与[Eclipse Modeling Tools](http://www.eclipse.org/downloads/download.php?file=/technology/epp/downloads/release/ganymede/SR2/eclipse-modeling-ganymede-SR2-incubation-win32.zip)下载捆绑在一起。（也可以将它们添加到现有的 Eclipse 安装中，尽管我不确切知道您要添加哪个插件。）

（我想比这更准确，但 eclipse.org 网站模仿马萨诸塞州的道路：如果你不知道自己在哪里，你就不属于那里。）

无论如何：一旦您获得了正确版本的 Eclipse，打开现有模式文件进行编辑（或创建一个新模式文件：选择 File -> New... Other ... XML / XML Schema ）。当您准备好生成测试 XML 文件时，在 Package Explorer（导航器视图，通常在左侧）中找到该文件，右键单击它，然后选择 Generate/XML File。

（我在说什么可导航性......？）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-03T15:57:53.523

Microsoft 已发布“文档生成器”工具作为示例。 [这是一篇](http://msdn.microsoft.com/en-us/library/aa302296.aspx)详细描述示例应用程序的架构和操作的文章。

如果您只想*使用*文档生成工具，[请单击此处](http://download.microsoft.com/download/0/A/2/0A2B9B6C-33B8-4B9D-BE0B-077F5CF46820/XmlSampleGenerator.msi)并安装 MSI。

免费。源是可用的。需要 .NET Framework 才能运行。仅适用于 XSD。（不是放松 NG 或 DTD）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-17T19:38:46.867

[Oxygen 的](http://www.oxygenxml.com/xml_schema_editor.html)XML 模式编辑器可以从给定的模式生成示例 XML 实例文档。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-07-26T19:18:11.750

我可以在 VS2010 中非常简单地做到这一点，我不知道这是否是一个新功能，但这很容易。在“xml 模式资源管理器”中右键单击 xsd 的根元素。您将看到“生成示例 XML”的选项。单击它时，VS会创建一个临时文件

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-12-29T11:06:01.563

使用 Eclipse Ganymede 或更高版本，您可以从 xsd 生成 xml。只需右键单击 xsd 并导航到生成 > xml。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-28T13:20:51.430

Liquid XML 会[生成 XML 样本](http://www.liquid-technologies.com/XmlStudio/XML-Sample-Generator.aspx)，不要认为有命令行选项，但您可以通过 UI 来完成。似乎做得很好，正确获取所有数据类型/枚举，它似乎唯一挣扎的是模式，但是理解正则表达式足以产生有效字符串有点棘手......

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-17T18:36:19.123

我过去曾为此使用过[XMLSpy ，并取得了巨大的成功。](http://www.altova.com/products/xmlspy/xmlspy.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-02-14T18:50:22.717

您可以使用[XMLFox](http://xmlfox.com/)来完成这个简单的任务。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-04-17T18:38:45.343

Have you taken a look at Microsoft's [XML Schema Definition Tool (xsd.exe)](http://msdn.microsoft.com/en-us/library/x6c1kb0s(VS.71).aspx)?

# flash - sIFR r436 - 警告：indexOf 不是函数

> ID：761666
> 
> 赞同：1
> 
> 时间：2009-04-17T18:35:58.423
> 
> 标签：flash, sifr

*注意：从joyent论坛交叉发布（[http://discuss.joyent.com/viewtopic.php?id=25229](http://discuss.joyent.com/viewtopic.php?id=25229)）*

我可能疯了，但我一直在我的闪存调试日志中看到这些消息：

*警告：indexOf 不是函数*

我在 sIFR 演示页面上没有看到这些消息，所以它让我觉得这是我正在做的事情，不管我最终能够将其追溯到 SifrStyleSheet.as 中的这个函数：

```
公共函数变换（样式）{
    var format = super.transform(style);
    if(style.leading) 格式 = applyLeading(格式, style.leading);
    if(style.letterSpacing) format.letterSpacing = style.letterSpacing;
    如果（样式。字体大小）{
      // 支持相对于 .sIFR-root 大小的字体大小。
      if (this.fontSize && style.fontSize.indexOf('%') > 0) {
        format.size = this.fontSize * parseInt(style.fontSize, 10) / 100;
      } 别的 {
        format.size = parseInt(style.fontSize, 10);
      }     
    }
    format.kerning = _root.kerning == 'true' || !(_root.kerning == 'false') || sIFR.defaultKerning；
    返回格式；
  }

```

我找不到调用这个函数的地方，看起来 style.fontSize 只使用 font-size css 属性的数字部分，所以寻找“%”是徒劳的。我疯了吗？是否存在会导致调用此函数的 CSS 属性？

谢谢，

- 克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-19T17:07:39.023

似乎您的一种样式使用“字体大小”，但它失败了。也许您应该首先验证您的 CSS 文件，以确保您没有忘记结尾的“;” 或使用 fontSize 而不是 font-size，或者您的字体大小值可能不正确？你也可以发布CSS吗？

# nhibernate - NHibernate Lambda 扩展 - CreateCriteria 问题

> ID：761672
> 
> 赞同：2
> 
> 时间：2009-04-17T18:37:15.063
> 
> 标签：nhibernate, nhlambdaextensions

我想将 NHibernate CreateCriteria 转换为[NHLambdaExtensions](http://code.google.com/p/nhlambdaextensions)标准，但我遇到了不知道如何修复的错误。

NHibernate 标准如下所示：

```
var departments = DepartmentService
    .CreateCriteria()
    .CreateAlias( "Goals", "goal" )
    .Add( Expression.Eq( "goal.Company.Id", companyId ) )
    .Add( Expression.Eq( "goal.Program.Id", programId ) )
    .List<Business.Department>(); 
```

我尝试创建的 NHLambdaExtensions 标准如下所示：

```
Business.Goal goalAlias = null;
var departments = DepartmentService
    .CreateCriteria()
    .CreateAlias<Business.Goal>( g => g.Department, () => goalAlias )
    .Add<Business.Goal>( g => g.Company.Id == companyId )
    .Add<Business.Goal>( g => g.Program.Id == programId )
    .List<Business.Department>(); 
```

我得到的错误是“无法解析属性部门：Business.Department”。该错误显然与“g => g.Department”有关，原始 NHibernate 查询中没有任何类似的内容，但没有不采用该表达式的重载。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-14T17:58:44.320

```
Business.Goal goalAlias = null;
var departments = DepartmentService
    .CreateCriteria(typeof(Business.Department)) // need to specify the first criteria as Business.Department
        .CreateCriteria<Business.Department>(d => d.Goals, () => goalAlias)
            .Add<Business.Goal>( g => g.Company.Id == companyId )
            .Add<Business.Goal>( g => g.Program.Id == programId )
    .List<Business.Department>(); 
```

[在NHibernate Lambda Extensions (V1.0.0.0) - 文档](http://nhlambdaextensions.googlecode.com/files/NhLambdaExtensions.html)中查找“使用别名创建标准关联”

编辑：

您实际上可以更有效地编写如下：

```
// no alias necessary
var departments = DepartmentService
    .CreateCriteria<Business.Department>()
        .CreateCriteria<Business.Department>(d => d.Goals)
            .Add<Business.Goal>( g => g.Company.Id == companyId )
            .Add<Business.Goal>( g => g.Program.Id == programId )
    .List<Business.Department>(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T21:14:46.387

我没有使用过 NHLambdaExpressions（但它看起来很酷，我肯定会很快检查出来），所以我只是在这里猜测。你能做这样的事情吗：

```
Business.Goal goalAlias = null;
var departments = DepartmentService
    .CreateCriteria()
        .CreateCriteria((Business.Department g) => g.Goals, () => goalAlias)
            .Add<Business.Goal>( g => g.Company.Id == companyId )
            .Add<Business.Goal>( g => g.Program.Id == programId )
            .List<Business.Department>(); 
```

我认为这将在目标处建立一个新标准，并通过目标别名分配一个别名。

# javascript - 如何使用 JavaScript 打开文件？

> ID：761682
> 
> 赞同：7
> 
> 时间：2009-04-17T18:39:31.143
> 
> 标签：javascript, ajax, pdf, prototypejs

我有一个 servlet，它将 pdf 文件作为 ByteArrayOutputStream 写入 servlet 的输出流。如果我打开 servlet URL，浏览器会打开文件。但是如果 servlet 发生错误，浏览器会打开一个带有错误消息的空 pdf。通过 ServletResponse 发送错误，浏览器会打开默认错误页面。

我想发送错误消息而不重定向到错误页面或打开无效的 pdf 文件。

我试过：

```
new Ajax.Request('/pdfservlet', {            
        onSuccess: function(response) {
            docWindow = window.open('','title');
            docWindow.document.open('application/pdf');
            docWindow.document.write(response);
            docWindow.document.close();
        },
        onFailure: function(response) {
            alert(response);
        }
    }); 
```

但是，onSuccess 会打开一个带有 [object object] 的页面

如何使用 JavaScript 打开 PDF 文件？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-17T19:05:40.177

注意：我假设您在[`Ajax.Request`](http://www.prototypejs.org/api/ajax/request)通话中使用 Prototype 框架。

[响应对象](http://www.prototypejs.org/api/ajax/response)并不意味着直接编写，但是它确实具有应该包含返回的 PDF 的属性`responseText`。

你有没有尝试过：

```
new Ajax.Request('/pdfservlet', {            
        onSuccess: function(response) {
            docWindow = window.open('','title');
            docWindow.document.open('application/pdf');
            document.write(response.responseText);
            docWindow.document.close();
        },
        onFailure: function(response) {
            alert(response);
        }
    }); 
```

（注意添加`.responseText`）

**编辑：**好的，所以这不起作用......尝试这样的事情：

```
new Ajax.Request('/pdfservlet', {            
        onSuccess: function(response) {
            window.open('/pdfservlet');
        },
        onFailure: function(response) {
            alert(response);
        }
    }); 
```

这将做的是创建 ajax 请求，如果成功，则在新窗口中打开它。打开新窗口应该很快，实际上不需要再次请求 PDF，因为浏览器应该在 Ajax.Request 调用期间缓存了它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T18:58:39.117

您可以尝试“两次通过”的方法。您使用 Ajax 调用 servlet（如果它动态生成 PDF，则让它缓存它）。如果成功，将用户重定向到带有参数的 servlet 以加载缓存的 PDF。

还有其他选项，但这取决于您使用 PDF 的方式。

我的 0.02 美元..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T19:56:31.490

由于看起来您将 PDF 作为“内联”而不是“附件”发送，因此您可以将 PDF 的 URL 放在动态创建的 Iframe 中，然后将该 Iframe 附加到叠加层。那会奏效。

-J.P

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-18T04:12:58.847

> 但是如果 servlet 发生错误，浏览器会打开一个带有错误消息的空 pdf。

在我看来，尝试在服务器端解决这个问题比所有这些脆弱的 AJAX 和缓存摆弄更好。为什么 servlet 错误仍在设置“Content-Type: application/pdf”标头及其错误消息？检查servlet中发送东西的顺序；在您成功创建 PDF 并准备好返回之前，不要发送“Content-Type”。

# ruby-on-rails - rails ruby -prof 和基准测试

> ID：761684
> 
> 赞同：0
> 
> 时间：2009-04-17T18:40:30.597
> 
> 标签：ruby-on-rails, ruby, performance, profiling, ruby-prof

我正在运行 Rails 2.2.2。我已经阅读了一些关于 ruby​​-prof 和分析 rails 应用程序的文章。我对事情的真正运作方式感到困惑。

我最初使用本教程 [http://snippets.aktagon.com/snippets/255-How-to-profile-your-Rails-and-Ruby-applications-with-ruby-prof](http://snippets.aktagon.com/snippets/255-How-to-profile-your-Rails-and-Ruby-applications-with-ruby-prof) 来分析我的应用程序，它可以工作。这涉及编写您自己的配置文件环境并运行`> RAILS_ENV=profiling ./script/performance/request -n 100 profiling/homepage.rb`

所以这是我的困惑。不知何故，这会运行 ruby​​-prof 并打开所有统计信息等，但我看不到任何实际调用 ruby​​-prof 的地方。

所以我进一步阅读，似乎 2.2.2 内置了基准测试/分析。所以我在性能部分编写了一个测试文件，如下所示

```
require 'test_helper'
require 'performance_test_help'

# Profiling results for each test method are written to tmp/performance.
class BrowsingTest < ActionController::PerformanceTest
  def test_worksheet
    get '/reduction/worksheet'
  end
end 
```

并运行

> 耙式测试：配置文件

这是否等同于我上面所做的，但刚才它已集成到整个 rails 框架中？

我的下一个问题是这个。原始脚本输出一个平面文件和 html 文件，但我不知道如何自动获取树文件以使用 KCacheGrind 或在我的情况下为 MacCallGrind 打开。我可以在脚本调用中添加格式吗？

编辑：通过 rake test 运行脚本似乎实际上产生了一个树文件，太好了。然而，Mac CallGrind 在尝试解析它时似乎挂起。有人知道查看这些树文件的其他工具吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-28T16:19:12.763

事实证明，完全一样，我一定是在阅读旧教程。现在所有的基准测试和分析都在 Rails 中，这太棒了。它输出 txt、html 和树文件，也很棒。现在，如果只有 MacCallGrind 可以工作，我就无法安装仅查看树文件所需的 4gb KDE 包。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T12:13:37.170

布拉德，你应该联系 MacCallGrind 的作者，看看是否有更新，或者他/她是否对你的文件进行了修复。

哦对了，就是我。请通过 symbol aggmedia.net 向 Richard 发送电子邮件，因为即将发布更新，我希望能够获得 Ruby/Rails 支持。

# c# - UserControl inflates when placed on a form?

> ID：761687
> 
> 赞同：6
> 
> 时间：2009-04-17T18:40:46.633
> 
> 标签：c#, user-interface, devexpress, tabpage

EDIT > SOLVED: It turns out that I had set all of the UI elements' font properties to be 14pt Arial, but not the usercontrol itself, so when it was drawing it on the form, it was resizing it all. Changing the usercontrol's font size to 14pt Arial, and then repositioning/resizing everything fixed it.

I started working on the UI for an app I'm making. The app has a devexpress tab control, and initially I was just placing all of my controls in there to see what it'd look like and to work out any layout issues. Well, I decide to pull out all of the ui elements for each tabpage and toss them into a UserControl and to have that UserControl fill the tab page.

The problem is that it looks perfectly normal (ie. the same as before) when in the usercontrol but when I bring that over to the tab page, all of the ui elements are HUGE (about double in size, but not exactly double).

Here's some images to show you what I mean.

**Edit>** Note: This is a winforms app.

UserControl:

edit > images removed

Form:

edit > images removed

It turns out that the objects are being resized. I checked the .Size property of the ui elements after the usercontrol.load event and they are much larger than they are supposed to be. This happens if there is the anchoring as I'd like it, all top-left anchored and no anchoring at all.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-08-25T14:23:43.303

UserControl 的 AutoScaleMode 应为“无”...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T18:44:25.203

Hard to say without seeing code...

[edit]

Well if you have no code then I only have one idea. The controls inside your user control have anchors that are being adjusted to the size of the parent control. The parent control could be larger than expected making all the anchors adjust with the parent. This would then make them all appear too big. This is my only idea...

[/edit]

# asp.net - asp.net WCF 服务慢...禁用 asp.net 应用程序回收有帮助吗？

> ID：761688
> 
> 赞同：0
> 
> 时间：2009-04-17T18:41:27.287
> 
> 标签：asp.net, wcf, performance, recycle, application-pool

我有一个需要一定响应时间（不到 1 分钟）的 WCF 服务。

我的问题是每隔一段时间，最常见的是在早上，服务需要很长时间才能响应（有时超过 2 分钟）。

我认为这是因为该应用程序已回收并且第一次运行必须重新编译。

还有其他可能发生这种情况的原因吗？

是否可以关闭应用程序回收？如果是，那会导致任何副作用或不稳定吗？我假设将 asp.net 应用程序设置为回收是有原因的。

还有什么可以做的来提高首次运行的性能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T18:43:36.033

是的，您可以阻止 AppPool 回收。另一种选择是创建一个保持活动状态的作业来不断地 ping 服务以防止工作进程休眠。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T20:52:16.643

基本上，以下规则规定了应用程序何时被回收或卸载：

1.  达到应用程序池回收时间后 - 默认情况下，我认为这是每 29 小时一次。
2.  最后一次申请申请后的设定时间。

使用 keep-alive 来 ping 服务将解决 2，然后您只需要处理 1。

根据您的 IIS 版本，配置它的方法略有不同。

1.  [对于 IIS 6](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/1eee28e2-b319-4b4e-8267-a8c0aa0dcf36.mspx?mfr=true)
2.  [对于 IIS 7](http://www.iis.net/ConfigReference/system.applicationHost/applicationPools/add/recycling)

我认为空闲超时通常默认为“infinte”，但可以通过配置文件的[processModel 元素（idleTimeout 属性）](http://msdn.microsoft.com/en-us/library/7w2sway1.aspx)进行配置。

至于首次运行性能 - 不查看您的应用很难说，您是否在其上运行过[DotTrace](http://www.jetbrains.com/profiler/)或其他分析器之类的东西？

您是否在第一次加载时进行了大量密集查找和缓存数据？这些可以延期吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T18:44:51.800

性能问题可能是由您没有首先排除的任何原因引起的。既然你没有排除任何事情，它可能是由任何事情引起的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T20:30:32.517

也许是一个愚蠢的想法：您是否可以安排一个控制台应用程序在早上 5:30 访问您的服务，这样该请求将需要很长时间才能运行，并且您的普通用户在那之后进入不会有这个问题?

当然 - 它没有解决根本原因，但就目前而言，它可能是一个有用的解决方法 - 不是吗？

马克

# c# - Making an ASP.NET ASMX web service easily callable by ColdFusion web clients

> ID：761689
> 
> 赞同：0
> 
> 时间：2009-04-17T18:41:36.130
> 
> 标签：c#, web-services, coldfusion

I've written an ASP.NET webservice (.asmx style rather than WCF) and I have the main web methods working now in my prototype enviroment. Now I need to add several new parameters to one of the webmethods but, more significantly, I need to make my webservice as "consumable" (callable) as possible from a ColdFusion web application. I'm confused about how to best design parameter types for the webservice methods in light of usage by CF (or other client callers).

My prototype relies on my own ASP.NET web page which calls my webservice; here is how the proxy class for my service is called from the .aspx page:

```
BrokerASMXProxy.Svc.FileService brokerService = new BrokerASMXProxy.Svc.FileService();
recNumber = brokerService.UploadFile(binData, fileNameOnly, kvData); 
```

Here is the signature of the webmethod:

```
[WebMethod]
    public string UploadFile(byte[] incomingArray
        , string FileName
        , MetaData[] metaDataArray) 
```

I'm a little concerned already about the byte array and the MetaData array (will ColdFusion have a problem calling this service with argument types like that?). I assume strings are not a problem but what are the best practices for designing webmethods (and their types) for use by ALL types of callers?

p.s. I also have a DownloadFile webmethod that has "out" parameters:

```
 [WebMethod]
    public bool DownloadFile(string recNumString, out byte[] docContents, out string returnFiletype) 
```

..and I wonder similarly about ColdFusion's accomodation of these outputs. Thank you in advance.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-18T13:58:14.337

If you're running ColdFusion 8, and happen to have that on the same physical server as your .NET code, you may be better off using .NET integration, where you can write a .NET class and intantiate it inside your CF code as if it were a CFC or a Java object.

[Here's a good example (with tons more on the same blog) of writing a .NET class that's used in CFML code](http://wrvishnu.wordpress.com/2007/10/06/downlaod-eventviewer-log-and-save-in-database/).

However, if your .NET and CF app servers are not on the same machine, you may have to go with a web service as you originally thought.

The great thing about web services is that they are language agnostic. It looks like you have a MetaData type or class defined, and you're expecting a collection of those to be sent as an input parameter. What that's going to ultimately translate to is some XML that represents that array, and each item in the array will be broken down to its core parts (strings, numbers, bools, etc)... In theory, it should *just work*, as long as you design your input XML accordingly.

It's been a while since I last created a .NET web service, but I'm sure there's a way to look at the expected XML structure (aka WSDL). Find that, and you've got your answer. Then you just need to create XML that fits that definition from your ColdFusion code and you're all set.

# .net - What does HTTP 404 mean?

> ID：761695
> 
> 赞同：1
> 
> 时间：2009-04-17T18:42:14.647
> 
> 标签：.net, asp.net

What does this error mean?

> HTTP 404\. The resource you are looking for (or one of its dependencies) could have been removed, had its name changed, or is temporarily unavailable. Please review the following URL and make sure that it is spelled correctly.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-17T18:45:08.073

从[HTTP 规范](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)：

> **10.4.5 404 未找到**
> 
> 服务器未找到任何与请求 URI 匹配的内容。没有说明这种情况是暂时的还是永久性的。...当服务器不希望确切地揭示请求被拒绝的原因或没有其他响应适用时，通常使用此状态代码。

...因此服务器可能没有（或找不到）您要的文件。

如果您认为文件应该在那里（即您控制服务器，并且您创建了文件）：

*   您指定的路径（在 URL 中）不正确
*   您的 URL 重新映射代码可能无法正常工作
*   可能有一些配置选项会阻止服务器查找文件。

# python - 如何在 Django 表单 ChoiceField 中获取选项标签？

> ID：761698
> 
> 赞同：71
> 
> 时间：2009-04-17T18:43:52.193
> 
> 标签：python, django, choicefield

我有一个`ChoiceField`，现在如何在需要时获得*标签？*

```
class ContactForm(forms.Form):
     reason = forms.ChoiceField(choices=[("feature", "A feature"),
                                         ("order", "An order")],
                                widget=forms.RadioSelect) 
```

`form.cleaned_data["reason"]`只给我`feature`or`order` *值*左右。

* * *

## 回答 #1

> 赞同：147
> 
> 时间：2009-04-18T03:28:26.147

[请参阅Model.get_FOO_display()](http://docs.djangoproject.com/en/dev/ref/models/instances/#django.db.models.Model.get_FOO_display)上的文档。所以，应该是这样的：

```
ContactForm.get_reason_display() 
```

在模板中，像这样使用：

```
{{ OBJNAME.get_FIELDNAME_display }} 
```

* * *

## 回答 #2

> 赞同：87
> 
> 时间：2011-09-29T17:14:51.320

这可能会有所帮助：

```
reason = form.cleaned_data['reason']
reason = dict(form.fields['reason'].choices)[reason] 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2012-03-05T21:40:16.783

这是最简单的方法：[模型实例参考：Model.get_FOO_display()](https://docs.djangoproject.com/en/dev/ref/models/instances/#django.db.models.Model.get_FOO_display)

您可以使用此函数将返回显示名称：`ObjectName.get_FieldName_display()`

替换`ObjectName`为您的类名和`FieldName`您需要获取其显示名称的字段。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-04-07T02:18:21.143

如果表单实例已绑定，则可以使用

```
chosen_label = form.instance.get_FOO_display() 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-17T20:06:40.827

这是我想出的一种方法。可能有更简单的方法。我使用以下方法对其进行了测试`python manage.py shell`：

```
>>> cf = ContactForm({'reason': 'feature'})
>>> cf.is_valid()
True
>>> cf.fields['reason'].choices
[('feature', 'A feature')]
>>> for val in cf.fields['reason'].choices:
...     if val[0] == cf.cleaned_data['reason']:
...             print val[1]
...             break
...
A feature 
```

注意：这可能不是很 Pythonic，但它演示了在哪里可以找到您需要的数据。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-05-09T11:20:24.367

你可以有这样的表格：

```
#forms.py
CHOICES = [('feature', "A feature"), ("order", "An order")]
class ContactForm(forms.Form):
     reason = forms.ChoiceField(choices=CHOICES,
                                widget=forms.RadioSelect) 
```

那么这会给你你想要的：

```
reason = dict(CHOICES)[form.cleaned_data["reason"]] 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-03-23T01:07:21.530

好的。我知道这是**很**老的帖子，但阅读它对我有很大帮助。我想我有一些要补充的。

这里的症结在于模型方法。

```
ObjectName.get_FieldName_display() 
```

不适用于表格。

如果您有一个不基于模型的表单并且该表单具有选择字段，那么您如何获得给定选择的显示值。

这是一些可能对您有所帮助的代码。

您可以使用此代码从已发布的表单中获取选择字段的显示值。

```
display_of_choice = dict(dateform.fields['fieldnane'].choices)[int(request.POST.get('fieldname'))] 
```

'int' 是基于选择的选择是一个整数。如果选择索引是一个字符串，那么您只需删除 int(...)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-02-26T09:48:12.907

我使用@Andrés Torres Marroquín 的方式，我想分享我的实现。

```
GOOD_CATEGORY_CHOICES = (
    ('paper', 'this is paper'),
    ('glass', 'this is glass'),
    ...
)

class Good(models.Model):
    ...
    good_category = models.CharField(max_length=255, null=True, blank=False)
    ....

class GoodForm(ModelForm):
    class Meta:
        model = Good
        ...

    good_category = forms.ChoiceField(required=True, choices=GOOD_CATEGORY_CHOICES)
    ...

    def clean_good_category(self):
        value = self.cleaned_data.get('good_category')

        return dict(self.fields['good_category'].choices)[value] 
```

结果是`this is paper`而不是`paper`。希望这有帮助

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-10-25T22:57:07.377

我想也许@webjunkie 是对的。

如果您正在从 POST 中读取表单，那么您会这样做

```
def contact_view(request):
    if request.method == 'POST':
        form = ContactForm(request.POST)
        if form.is_valid():
            contact = form.save()
            contact.reason = form.cleaned_data['reason']
            contact.save() 
```

# sql - 如何根据事件的日期、时间和持续时间检查 SQL 表中的平均并发事件？

> ID：761700
> 
> 赞同：11
> 
> 时间：2009-04-17T18:44:33.393
> 
> 标签：sql, sql-server, algorithm, sql-server-2000, sql-server-7

我有一组呼叫详细记录，从这些记录中，我应该确定每个系统每小时的平均并发活动呼叫（精度为一分钟）。如果我查询晚上 7 点到晚上 8 点，我应该看到该小时内（对于每个系统）的平均并发呼叫数（平均每分钟的并发呼叫数）。

所以，我需要一种方法来检查 7:00-7:01、7:01-7:02 等的活动呼叫计数，然后平均这些数字。如果呼叫的时间和持续时间在被检查的当前分钟内，则认为呼叫处于活动状态。

使这更加困难的是它需要跨越 SQL 7.0 和 SQL 2000（2000 中的某些函数在 7.0 中不可用，例如 GetUTCTime()），如果我能让 2000 工作我会很高兴。

## 我可以采取什么方法来解决这个问题？

我考虑在检查的一小时内循环通过分钟 (60) 并添加该分钟之间的呼叫计数，然后以某种方式交叉引用持续时间以确保呼叫从晚上 7:00 开始并且持续时间为300 秒显示在 7:04 处于活动状态，但我无法想象如何解决这个问题。我试图找出一种方法来衡量每个呼叫与特定分钟的权重，这会告诉我呼叫在该分钟内是否处于活动状态，但无法提出有效的解决方案。

这里的数据类型与我必须查询的相同。我对架构没有任何控制权（除了可能转换数据并插入到另一个具有更合适数据类型的表中）。我提供了一些我知道有并发活动调用的示例数据。

```
CREATE TABLE Records(
  seconds char(10),
  time char(4),
  date char(8),
  dur int,
  system int,
  port int,
)

--seconds is an stime value. It's the difference of seconds from UTC 1/1/1970 00:00:00 to the current UTC time, we use it as an identifier (like epoch).
--time is the time the call was made.
--date is the day the call was made.
--dur is the duration of the call in seconds.
--system is the system number.
--port is the port on the system (not particularly relevant for this question).

INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924228','1923','20090416',105,2,2)
INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239923455','1910','20090416',884,1,97)
INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924221','1923','20090416',116,2,15)
INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924259','1924','20090416',90,1,102)
INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239923458','1910','20090416',891,2,1)
INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924255','1924','20090416',99,2,42)
INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924336','1925','20090416',20,2,58)
INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924293','1924','20090416',64,2,41)
INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239923472','1911','20090416',888,2,27)
INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924347','1925','20090416',25,1,100)
INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924301','1925','20090416',77,2,55)
INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924332','1925','20090416',52,2,43)
INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924240','1924','20090416',151,1,17)
INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924313','1925','20090416',96,2,62)
INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924094','1921','20090416',315,2,16)
INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239923643','1914','20090416',788,2,34)
INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924447','1927','20090416',6,2,27)
INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924342','1925','20090416',119,2,15)
INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924397','1926','20090416',76,2,41)
INSERT INTO Records(seconds, time, date, dur, system, port) VALUES('1239924457','1927','20090416',23,2,27) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-18T04:29:03.830

我认为 MarkusQ 有答案，但让我开发一个您可能会发现更容易使用的替代方案。我将使用我[惯用的方法](https://stackoverflow.com/questions/702500/sql-query-to-collapse-duplicate-values-by-date-range/712309#712309)来开发它，将其作为一系列简单的视图转换，类似于过程语言中的[功能分解](https://stackoverflow.com/questions/754527/best-way-to-test-sql-queries/754570#754570)。

首先，让我们将所有内容放在共同的单位中。回想一下`record`' 列`s`是自 1970 年 1 月 1 日午夜以来的秒数*。*我们可以通过仅对一天中的秒数取 s 模数来找到自通话当天午夜以来的秒数：`s % (60 * 60 * 24)`。

```
select *, 
s % (60 * 60 * 24) as start_secs_from_midnight,
s % (60 * 60 * 24) + dur - 1 as end_secs_from_midnight,
; 
```

我们从中减去 1，`s + dur`因为从 12:00:00 开始的一秒呼叫也在 12:00:00 结束。

我们可以通过将这些结果除以 60 或仅除以来找到自午夜以来的分钟数`floor( s / 60 ) % (60 * 24)`：

```
create view record_mins_from_midnight as
select *, 
floor( s / 60 ) % (60 * 24) as start_mins_fm,
floor( ( s + dur - 1) / 60 ) % (60 * 24) as end_mins_fm 
from record
; 
```

现在我们创建一个分钟表。我们需要其中的 1440 个，编号从 0 到 1439。在不支持任意序列的数据库中，我*创建了一个人工范围或序列*，如下所示：

```
 create table artificial_range ( 
   id int not null primary key auto_increment, idz int) ;
  insert into artificial_range(idz) values (0);
  -- repeat next line to double rows
  insert into artificial_range(idz) select idz from artificial_range; 
```

所以要创建一个`minute`表：

```
 create view minute as 
   select id - 1 as active_minute 
   from artificial_range 
   where id <= 1440
   ; 
```

现在我们只需加入`minute`我们的记录视图

```
create view record_active_minutes as
select * from minutes a 
join record_mins_from_midnight b
on (a.active_minute >= b.start_mins_fm 
and a.active_minute <= b.end_mins_fm 
 ; 
```

这只是交叉乘积/乘以记录行，因此我们在呼叫处于活动状态的每一整分钟都有一个记录行。

请注意，我通过将活动定义为“在一分钟内发生的（部分）呼叫”来做到这一点。也就是说，根据此定义，从 12:00:59 开始并在 12:01:01 结束的两秒通话发生在两个不同的分钟内，但是从 12:00:58 开始并在 12 结束的两秒通话： 00:59 发生在一分钟内。

我这样做是因为您指定了“所以，我需要一种方法来检查 7:00-7:01、7:01-7:02 的活动呼叫计数”。如果您希望只考虑在超过 1 分钟内发生的持续时间超过 60 秒的呼叫，则需要调整加入。

现在，如果我们想找到等于或大于分钟粒度的任何粒度的活动记录数，我们只需在最后一个视图上进行分组。要找到每小时的平均通话次数，我们除以 60 以将分钟变为小时：

```
 select floor( active_minute / 60 ) as hour, 
 count(*) / 60 as avg_concurent_calls_per_minute_for_hour
 from record_active_minutes
 group by floor( active_minute / 60 ) ; 
```

*请注意，这是所有电话*的平均每小时，在所有日子里；如果我们想将其限制在特定的日期或日期范围内，我们会添加一个`where`子句。

* * *

**但是等等，还有更多！**

如果我们创建一个`record_active_minutes`执行左外连接的版本，我们可以得到一个显示一天中所有小时的平均值的报告：

```
 create view record_active_minutes_all as
 select * 
 from 
 minutes a 
 left outer join record_mins_from_midnight b
   on (a.active_minute >= b.start_mins_fm 
       and a.active_minute <= b.end_mins_fm) 
 ; 
```

然后我们再次进行选择，但针对的是新视图：

```
 select floor( active_minute / 60 ) as hour, 
 count(*) / 60 as avg_concurent_calls_per_min
 from record_active_minutes_all
 group by floor( active_minute / 60 ) ;

+------+------------------------------+
| hour | avg_concurrent_calls_per_min |
+------+------------------------------+
|    0 |                       0.0000 |
|    1 |                       0.0000 |
|    2 |                       0.0000 |
|    3 |                       0.0000 |
   etc.... 
```

我们也可以用 where 来索引它。`record`不幸的是，连接意味着我们将在特定小时内不存在调用的基础表中有空值，例如，

```
 select floor( active_minute / 60 ) as hour, 
 count(*) / 60 as avg_concurent_calls_per_min
 from record_active_minutes_all
 where month(date) = 1 and year(date) = 2008 
 group by floor( active_minute / 60 ) ; 
```

将在未发生呼叫的几个小时内恢复任何行。如果我们仍然想要显示所有时间的“类似报告”视图，我们确保我们还包括那些没有记录的时间：

```
 select floor( active_minute / 60 ) as hour, 
 count(*) / 60 as avg_concurent_calls_per_minute_for_hour
 from record_active_minutes_all
 where (month(date) = 1 and year(date) = 2008) 
 or date is null 
 group by floor( active_minute / 60 ) ; 
```

请注意，在最后两个示例中，我使用的是 SQL 日期（函数`month`和`year`可以应用到的日期），而不是记录表中的 char(4) 日期。

这带来了另一点：记录表中的日期和时间都是多余的和非规范化的，因为每个都可以从您的 column s 派生。将它们留在表中可能会出现不一致的行，其中`date(s) <> date`或`time(s) <> time`. 我宁愿这样做：

```
 create table record ( id int not null primary key, s, duration) ; 

   create view record_date as 
   select *, dateadd( ss, s, '1970-01-01') as call_date
   from record
  ; 
```

在`dateadd`函数中，`ss`是一个枚举类型，告诉函数加秒；`s`是记录中的列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T18:56:31.353

如果我理解正确，您想要获取开始时间小于 t+60 秒且开始时间加上持续时间小于或等于 t 的所有记录的计数，对于感兴趣的间隔中的每个 t （例如，t=7:00、7:01、7:02...等）。

然后只需对这些计数进行平均即可。

但什么是平均值？这只是总和除以项目数，对吗？在这种情况下，项目的数量将始终等于以分钟为单位的时间范围，并且总和将等于间隔内的持续时间-分钟的总和，您可以根据给定的数据一次性计算出.

现在听起来不太可能了？在伪 SQL 中：

```
select sum( 
     ((time+duration rounded up to next minute, capped at end of period)
    - (time rounded down, bottom-capped at start of period) - 1)
     /(1 minute) )
  from Records
  where date is right 
```

然后将其除以感兴趣期间的分钟数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T19:40:51.683

我的第一个建议是，如果您发现自己说（在使用 SQL 时）“我可以创建一个循环......”那么您应该立即开始寻找基于集合的方法。使用 SQL 时要摆脱程序化思维模式。

您的逻辑仍有一些模糊的部分。如果通话只是在那一分钟内通话的任何部分，那么通话是否算作在一分钟内？例如，如果一个呼叫从 1923 开始并持续 62 秒，是否认为它与从 1924 开始的所有呼叫重叠？我会假设那个是肯定的，但如果不是这样，你可以调整下面的代码。这应该是一个小调整。

对于以分钟为单位的细分，我通常会使用一个带有时间跨度的表格——我感兴趣的每个切片的开始时间和结束时间。在您的情况下，因为您正在处理确切的分钟数并且您的开始时间以分钟为单位（即使数据类型被搞砸了），我将只使用一个包含确切分钟数的列。

要设置该表：

```
CREATE TABLE dbo.Minutes (
    start_time  INT NOT NULL,
    CONSTRAINT PK_Minutes PRIMARY KEY CLUSTERED (start_time)
)

DECLARE
    @hour   TINYINT,
    @minute TINYINT

SET @hour = 19
SET @minute = 0

WHILE (@hour <= 20)
BEGIN
    INSERT INTO dbo.Minutes (start_time) VALUES (@hour * 100 + @minute)

    SET @minute = @minute + 1
    IF @minute = 60
    BEGIN
        SET @minute = 0
        SET @hour = @hour + 1
    END
END 
```

现在我们可以选择平均值等。

```
SELECT
    M.start_time,
    COUNT(R.seconds)
FROM
    dbo.Minutes M
LEFT OUTER JOIN dbo.Records R ON
    M.start_time BETWEEN CAST(R.time AS INT) AND
        (CAST(SUBSTRING(time, 1, 2) AS INT) * 100) +    -- hours
        (FLOOR((CAST(SUBSTRING(time, 3, 2) AS INT) + FLOOR(dur/60))/60)) +  -- carryover to hours
        (CAST(SUBSTRING(time, 3, 2) AS INT) + dur/60) % 60  -- minutes
GROUP BY
    M.start_time 
```

您需要将其用作子查询来获取给定时间内的平均值。由于星期五很晚，我将把这一步留给你；）

**编辑：**最后一个警告：我没有考虑跨越日界的时间跨度（即，超过午夜）。希望代码为您指明正确的方向。更好的方法可能是创建一个视图，将所有这些讨厌的字符串转换为实际的 DATETIME 值，然后使用 Minutes 表就变得非常简单。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T19:22:48.823

正如 MarkusQ 所说，您对“并发”的定义允许您缩短数学运算。

*   呼叫 (A) 开始于“12:00:59”并结束于“12:01:01”
*   呼叫 (B) 开始于“12:01:59”并结束于“12:02:01”
    => 1 次呼叫在“12:00”间隔
    => 2 次呼叫在“12:01”间隔
    => 1在“12:02”间隔调用

那么平均并发调用为 (1+2+1)/intervalCount

(1+2+1) 可以以不同的方式计算，并且更快/更容易：

*   通话 (A) 涵盖 2 个不同的分钟间隔（12:00 和 12:01）
*   通话 (B) 覆盖 2 个不同的分钟间隔（12:01 和 12:02）
    => 总覆盖分钟 = 4

这里的重要事实（以及为什么我在 MarkusQ 发布后打扰回复）是呼叫本身的持续时间不足以计算覆盖了多少分钟间隔。在我的示例中，两个通话仅持续 2 秒...

您需要以下信息：
- “开始时间”，四舍五入到分钟
- “结束时间”，四舍五入到分钟
=> 覆盖的时间间隔 = 分钟差数 + 1

要将“时间”字段四舍五入到分钟，我会使用这个......

```
DATEADD(minute, DATEDIFF(minute, 0, time), 0) 
```

所以一个电话覆盖的分钟数将是......

```
DATEDIFF(
   minute,
   DATEADD(minute, DATEDIFF(minute, 0, time), 0),
   DATEADD(second, dur, time)
) + 1

No need to round the "end time" down.
Using DATEDIFF(minute) gives rounding down anyway. 
```

将该值与您正在查看的范围相加，然后除以该范围内的分钟数，您就有了答案。

如果你只是在寻找真正并发的调用，你就不能使用这样的技巧，但它仍然是可能的（我不得不做类似的事情）。但是对于您对并发的定义，应该这样做......

```
DECLARE
   @date DATETIME, @start DATETIME, @end DATETIME
SELECT
   @date = '2009 Jan 01', @start = '12:00', @end = '13:00'

SELECT
   system,
   SUM(
       DATEDIFF(
          minute,
          CASE WHEN
             CAST(LEFT(time,2) + ':' + RIGHT(time,2) AS DATETIME) < @start
          THEN
             @start
          ELSE
             CAST(LEFT(time,2) + ':' + RIGHT(time,2) AS DATETIME)
          END,
          CASE WHEN
             DATEADD(second, dur, CAST(LEFT(time,2) + ':' + RIGHT(time,2) AS DATETIME)) > @end
          THEN
             @end
          ELSE
             DATEADD(second, dur, CAST(LEFT(time,2) + ':' + RIGHT(time,2) AS DATETIME))
          END
       ) + 1
   )
   /
   CAST(DATEDIFF(minute, @start, @end) AS FLOAT)
FROM
   records
WHERE
   date = @date
   AND CAST(LEFT(time,2) + ':' + RIGHT(time,2) AS DATETIME) >= @start
   AND DATEADD(second, dur, CAST(LEFT(time,2) + ':' + RIGHT(time,2) AS DATETIME)) < @end
GROUP BY
   system 
```

这将故意不包括间隔 13:00->13:01
仅包括 12:00->12:01 到 12:59->13:00 的 60 个“1 分钟长间隔”

**编辑：**

我刚刚注意到您的时间和日期存储为字符串，您需要将它们转换为 DATETIME 才能使我的代码正常工作。

**编辑2：**

错误已更正。如果呼叫开始于“11:59:01”并结束于“12:00:01”，则不应计算“11:59”间隔。添加 CASE 语句以进行补偿。

**各种布局编辑**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-17T21:10:23.667

我只能看到一种从通话记录中提取数据的方法：

创建事件列表，其中事件定义为通话开始或通话结束。（因此每个通话记录将生成两个事件。）每个事件项应包含：系统、日期时间和布尔值开始/结束。日期时间应向下舍入到最接近的分钟。

按（系统、日期时间）对该列表进行排序并扫描它。对于每个调用开始，将 CURCNT 加一。对于每个呼叫结束，将 CURCNT 减 1。

如果日期时间值与之前的记录不同，请将 CURCNT 添加到 HOURSUM。如果 datetime 值指示新小时的开始，则将 HOURSUM 除以 60，写入新的结果记录（系统、日期、小时、平均值），并将 HOURSUM 重置为零。

应该很明显什么时候初始化CURCNT和HOURSUM，当系统值与之前的记录不同时怎么办等等。

-阿尔。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-17T20:37:19.143

我通过将数据转换为更简单的格式来解决这个问题。我创建了一个表格，其中每一行代表一分钟的通话。一旦你知道了每小时每分钟的平均值就很简单了。那里有多个选择来显示中间结果。只要被查询的时间范围和时长不是很大，应该没问题...？

```
CREATE TABLE #Records(
  seconds char(10),
  [time] char(4),
  date char(8),
  dur int,
  system int,
  port int
)

/*
seconds is an s[time] value. It's the difference of seconds from UTC 1/1/1970 00:00:00 to the current UTC [time], we use it as an identifier (like epoch).
[time] is the [time] the call was made.
date is the day the call was made.
dur is the duration of the call in seconds.
system is the system number.
port is the port on the system (not particularly relevant for this question).
*/

INSERT INTO #Records(seconds, [time], date, dur, system, port) VALUES('1239924228','1923','20090416',105,2,2)
INSERT INTO #Records(seconds, [time], date, dur, system, port) VALUES('1239923455','1910','20090416',884,1,97)
INSERT INTO #Records(seconds, [time], date, dur, system, port) VALUES('1239924221','1923','20090416',116,2,15)
INSERT INTO #Records(seconds, [time], date, dur, system, port) VALUES('1239924259','1924','20090416',90,1,102)
INSERT INTO #Records(seconds, [time], date, dur, system, port) VALUES('1239923458','1910','20090416',891,2,1)
INSERT INTO #Records(seconds, [time], date, dur, system, port) VALUES('1239924255','1924','20090416',99,2,42)
INSERT INTO #Records(seconds, [time], date, dur, system, port) VALUES('1239924336','1925','20090416',20,2,58)
INSERT INTO #Records(seconds, [time], date, dur, system, port) VALUES('1239924293','1924','20090416',64,2,41)
INSERT INTO #Records(seconds, [time], date, dur, system, port) VALUES('1239923472','1911','20090416',888,2,27)
INSERT INTO #Records(seconds, [time], date, dur, system, port) VALUES('1239924347','1925','20090416',25,1,100)
INSERT INTO #Records(seconds, [time], date, dur, system, port) VALUES('1239924301','1925','20090416',77,2,55)
INSERT INTO #Records(seconds, [time], date, dur, system, port) VALUES('1239924332','1925','20090416',52,2,43)
INSERT INTO #Records(seconds, [time], date, dur, system, port) VALUES('1239924240','1924','20090416',151,1,17)
INSERT INTO #Records(seconds, [time], date, dur, system, port) VALUES('1239924313','1925','20090416',96,2,62)
INSERT INTO #Records(seconds, [time], date, dur, system, port) VALUES('1239924094','1921','20090416',315,2,16)
INSERT INTO #Records(seconds, [time], date, dur, system, port) VALUES('1239923643','1914','20090416',788,2,34)
INSERT INTO #Records(seconds, [time], date, dur, system, port) VALUES('1239924447','1927','20090416',6,2,27)
INSERT INTO #Records(seconds, [time], date, dur, system, port) VALUES('1239924342','1925','20090416',119,2,15)
INSERT INTO #Records(seconds, [time], date, dur, system, port) VALUES('1239924397','1926','20090416',76,2,41)
INSERT INTO #Records(seconds, [time], date, dur, system, port) VALUES('1239924457','1927','20090416',23,2,27)

/* convert date + [time] into datetimes */
select 
    seconds,
    system,
    cast(date + ' ' + left([time], 2) + ':' + right([time], 2) as datetime) as start_date,
    /* end date to the minute */
    dateadd(mi, datediff(mi, 0, dateadd(s, dur, cast(date + ' ' + left([time], 2) + ':' + right([time], 2) as datetime))), 0) as end_date
into 
    #r
from
    #Records

select * from #r order by system, seconds, start_date, end_date;

/* create a row for each minute of each call */
create table #r_min(rnd int, seconds char(10), system int, minute datetime)

declare @maxrnd int;
select @maxrnd = max(datediff(mi, r.start_date, r.end_date)) from #r r
declare @i int;
set @i = 0;

while @i < @maxrnd begin

    insert into #r_min
    select @i, r.seconds, r.system, dateadd(mi, @i, r.start_date)
    from #r r
    where dateadd(mi, @i, r.start_date) <= r.end_date

set @i = @i + 1
end

select * from #r_min order by system, seconds, minute

/* concurrent per minute */
select  
    system, minute, count(*) as cnt
from 
    #r_min 
group by
    system, minute
order by 
    system, minute

/* avg concurrent per minute by hour */
select
    m.system,
    dateadd(hh, datediff(hh, 0, m.minute), 0) as hour,
    avg(m.cnt) as average_concurrent_per_minute
from
    (select  
        system, minute, count(*) as cnt
    from 
        #r_min 
    group by
        system, minute
    ) m
group by
    m.system,
    dateadd(hh, datediff(hh, 0, m.minute), 0)

drop table #Records
drop table #r
drop table #r_min 
```

最后的选择产生...

```
system  hour    average_concurrent_per_minute
1   2009-04-16 19:00:00.000 1
2   2009-04-16 19:00:00.000 3 
```

# asp.net-mvc - 混合 http/https 站点

> ID：761704
> 
> 赞同：7
> 
> 时间：2009-04-17T18:44:52.393
> 
> 标签：asp.net-mvc, https, azure, cloud

到目前为止，我的 https 部署通常涉及使用 https 对整个站点进行简单的锁定，并在 Web 服务器上提供 http-to-https 重定向。

我现在计划创建一个包含 http 和 https 页面的 ASP.NET MVC 站点（在云上）。因此，该站点将有 2 个概念（非物理）区域，同时提供安全和非安全请求。

配置方面，我已经为 80 和 443 设置了输入端口，并且站点接受了这两个请求。

对于属于安全区域的操作的任何调用，有什么方法可以将协议转换为 https 吗？例如，动作过滤器可以做的事情。

非常感谢。

**编辑：** *请注意，这样做的整个想法是避免在表单操作属性上使用绝对 url，因为可移植性问题以及因为用户不会在浏览器上看到 https:// 保证视觉提示。*

磷

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-17T20:03:17.823

您可能想查看 Microsoft[提供的 MVC 期货程序集，可在此处下载。](http://aspnet.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=24471)

这有一个 FilterAttribute, RequireSslFilterAttribute 允许您轻松标记控制器中需要 SSL 的 Action 方法 - 例如

```
[RequireSsl(Redirect=true)]
public ActionResult LogOn()
{
  return View();
} 
```

可选的重定向参数将导致请求被重定向到相同的 URL，但如果需要，通过 https 而不是 http。

警告：正如 Daniel 指出的那样，当您点击此操作时，如果数据已发布到页面的非安全版本可能已经为时已晚 - 它已经可能受到损害，因此您在使用此操作时仍然需要小心并确保所有敏感数据都通过 https 发送。（我刚刚注意到你对丹尼尔的评论，你显然明白这一点，我会把警告留给其他偶然发现这一点的人！）

编辑：正如 Luke 指出的，在 MVC2 中，这个属性现在是核心框架的一部分，并重命名为 [RequireHttps]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T19:15:16.173

> 对于属于安全区域的操作的任何调用，有什么方法可以将协议转换为 https 吗？

简短的回答是否定的，一旦请求是通过 http 发出的，它就已经被潜在地破坏了。您可以要求某些调用通过 HTTPS 进行（不知道该怎么做，因为我有一段时间没有使用 ASP.Net），如果没有，则发送错误。关键是决定您希望应用程序何时进行跳转，即在登录期间并选择 HTTPS 作为这些表单的操作。这就是你所说的“动作过滤器”吗？

# emacs - 在 Emacs 中，一次编辑多行

> ID：761706
> 
> 赞同：79
> 
> 时间：2009-04-17T18:46:26.947
> 
> 标签：emacs

我相信 textmate 有一种模式，如果您开始输入，则会在您选择的所有行上输入相同的内容。在emacs中有类似的东西吗？我猜有一种矩形可以帮助我，但我不确定如何......

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2009-04-17T18:54:18.800

就这么简单：[Cx rt](https://ftp.gnu.org/old-gnu/Manuals/emacs/html_node/emacs_68.html)

一些例子在这里： [http ://ergoemacs.org/emacs/emacs_string-rectangle_ascii-art.html](http://ergoemacs.org/emacs/emacs_string-rectangle_ascii-art.html)

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2013-02-25T17:37:39.933

您绝对需要尝试安装多个游标：

[https://github.com/magnars/multiple-cursors.el](https://github.com/magnars/multiple-cursors.el)

它在果酱和melpa中，所以只是：

```
Mx 包安装多游标

```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2009-04-17T19:19:55.507

其中一种解决方案是使用 CUA 模式。使用 激活 cua 模式`M-x cua-mode`，选择矩形开始：首先按下`C-Enter`然后使用标准移动命令移动光标以进行选择，现在随时按 Enter 将使光标循环穿过矩形的角，使您能够将文本添加到选择中。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2009-04-17T18:56:07.500

您可以使用以下命令（和键）来完成此操作：

*   open-rectangle (Cx, r, o) 添加空格
*   kill-rectangle (Cx, r, k) 删除
*   clear-rectangle (Cx, r, c) 替换为空格
*   Mx string-insert-rectangle 填充指定文本

以下是这些功能的完整描述： [http ://www.gnu.org/software/emacs/manual/html_node/emacs/Rectangles.html](http://www.gnu.org/software/emacs/manual/html_node/emacs/Rectangles.html)

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2014-02-12T10:40:40.877

对于那些想要在更复杂的场景中执行此操作并且想要在不安装新模块的情况下执行此操作的人，请继续阅读。（这在 Emacs 中是可能的，无需安装 MarkMultiple，虽然我个人使用并喜欢 MarkMultiple）

我最近不得不将 SQL 查询输出到文件，然后将其格式化为 MYSQL INSERT 查询。以下是 Emacs 如何让我的生活变得轻松......

文件看起来像：

```
1   I am a random text
2   I am not
3   G, you've gone mad
4   Click on this link
5   Transfer in progress (we've started the transfer process)
6   But transfer happend yesterday
7   No you are
8   Oh please! this is getting too much!
9   I love emacs
10  I cant be bothered with this any more
11  its time to raise the bar
12  show me how to expand my territory 
```

我想让它看起来像：

```
(1,   ,'I am a random text'),
(2,   ,'I am not'),
(3,   ,'G, youve gone mad'),
(4,   ,'Click on this link'),
(5,   ,'Transfer in progress (weve started the transfer process)'),
(6,   ,'But transfer happend yesterday'),
(7,   ,'No you are'),
(8,   ,'Oh please! this is getting too much!'),
(9,   ,'I love emacs'),
(10,  ,'I cant be bothered with this any more'),
(11,  ,'its time to raise the bar'),
(12,  ,'show me how to expand my territory'), 
```

1.  将光标放在第一行
2.  按下`C-x (`开始录制宏 [此时您的所有按键输入都已被录制，因此请仔细按照说明进行操作]
3.  按`C-a`转到行首
4.  键入“（”，然后`M-f`向前移动一个单词，然后键入“，”
5.  `C-n`转到下一行，然后`C-x )`结束宏
6.  `C-u 11 C-x e`重复宏 n（在这种情况下为 11）次

*尤里卡！*到目前为止，如果您没有失败，您将得到如下所示的内容：

```
(1,   I am a random text
(2,   I am not
(3,   G, youve gone mad
(4,   Click on this link
(5,   Transfer in progress (weve started the transfer process)
(6,   But transfer happend yesterday
(7,   No you are
(8,   Oh please! this is getting too much!
(9,   I love emacs
(10,  I cant be bothered with this any more
(11,  its time to raise the bar
(12,  show me how to expand my territory 
```

在这一点上，我将让你弄清楚剩下的事情。但是，在我走之前，我想提一下，有很多方法可以实现这种事情。这只是其中一种方式，它恰好是我最喜欢的方式。

希望你觉得它有帮助；）

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-04-17T19:28:40.027

我相信您正在寻找 boskom 建议的 cua 模式。[http://www.vimeo.com/1168225?pg=embed&sec=1168225](http://www.vimeo.com/1168225?pg=embed&sec=1168225)这个截屏视频可能会让您了解如何使用它。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-17T18:50:18.137

矩形用于简单的东西，例如删除相邻行中相同数量的空格。

否则键盘宏是要走的路。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-21T22:33:08.660

上面显示的答案用于在列中插入文本。TextMate 的“Edit Each Line in Selection”在每行中插入相同的文本，而不管每行的长度如何。我现在正在学习 Lisp，所以作为练习，我编写了一个函数来做到这一点：

```
(defun append-to-lines (text-to-be-inserted)
  ;;Appends text to each line in region
  (interactive "sEnter text to append: ")
  (save-excursion
    (let (point-ln mark-ln initial-ln final-ln count)
      (barf-if-buffer-read-only)
      (setq point-ln (line-number-at-pos))
      (exchange-point-and-mark)
      (setq mark-ln (line-number-at-pos))
      (if (< point-ln mark-ln)
          (progn (setq initial-ln point-ln final-ln mark-ln)
                 (exchange-point-and-mark))
        (setq initial-ln mark-ln final-ln point-ln))
      (setq count initial-ln)
      (while (<= count final-ln)
        (progn (move-end-of-line 1)
               (insert text-to-be-inserted)
               (next-line)
               (setq count (1+ count))))
      (message "From line %d to line %d." initial-ln final-ln )))) 
```

您首先选择包含您想要影响的所有行，然后使用 Mx append-to-lines 运行该函数。

# php - PHPUnit 和 XDebug 会一起工作吗？

> ID：761708
> 
> 赞同：1
> 
> 时间：2009-04-17T18:46:42.857
> 
> 标签：php, testing, phpunit, xdebug

我一直在为我的 PHP 代码编写单元测试。PHPUnit 是我正在使用的。

我有一些课程效果很好，直到...

我将 XDebug 加入其中。

那时，PHPUnit 不会崩溃或发生任何事情，但 setExpectedException 永远不会触发。

事实上，代码永远不会超出这一点。

任何人都遇到过这个并知道解决方案是什么？

编辑：这是 PHP5.2.6，XUnit 和 XDebug 的最新版本。这是在 linux fedora 7 上

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-17T19:34:00.810

我之前在使用 Xdebug 和 PHPUnit 的组合时遇到过一些问题（就像其他人一样，来自我当时在[devzone.zend.com](http://devzone.zend.com)上发表的一份报告），但那是不久前的事了。PHPUnit 确实明确支持 Xdebug - 我正在使用它为我自己的系统生成代码覆盖率报告。

我建议使用相当标准的调试技术，更新任何版本（甚至可能是 PHP？）注释掉 @setExpectedException，或者明确地抛出它——当然，确保你有完整的警告和错误显示在`error_reporting(E_ALL|E_STRICT);`set on .

不要忘记停止并重新启动 Apache 服务器以确保 Xdebug 模块也已加载。

# iphone - 保护 iPhone 到服务器的通信，以便只有我的应用程序可以发布数据？

> ID：761709
> 
> 赞同：2
> 
> 时间：2009-04-17T18:46:47.943
> 
> 标签：iphone

我正在开发一个 iPhone 应用程序，该应用程序必须将一些数据发布到服务器，例如说用户对某个主题的投票。这是问题所在：

我想实现某种形式的加密，以便只有我的 iPhone 客户端可以将投票发布到服务器，其他设备/来源不能发布数据。

我没有使用用户名/密码，并且服务器定义了 REST 接口来读取/发布数据。

有任何想法吗？感谢任何/所有帮助。

--
米

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T19:07:57.533

我建议对您的申请进行挑战/响应认证。在应用程序中嵌入密钥，服务器发送消息，您发布数据并对挑战数据进行计算并返回。

# unit-testing - 使用 resharper 调试单元测试

> ID：761719
> 
> 赞同：1
> 
> 时间：2009-04-17T18:49:46.033
> 
> 标签：unit-testing, debugging, resharper

我刚刚开始使用 resharper，我发现了一件非常烦人的事情。调试单元测试时，我尝试单步执行 (F11) 方法，但 Visual Studio 抱怨源代码不可用。问题是 resharper 正在用自己的类包装方法调用。当然，我可以在我的源代码中进一步添加一个断点，但这很烦人。你知道这是否有解决方案吗？顺便说一句，我正在使用 NUnit 来编写我的测试

谢谢

费德里科

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T19:38:08.477

在玩了一些之后，我设法在我的设置上重新创建了这个（resharper 中的 Xunit.net，visual studio 2008）......我重新创建这个的步骤是：

1.  将包含测试的 dll 设置为启动项目（我知道你不需要这样做，只是想让它失败）
2.  在单元测试中设置断点
3.  按 F11（我的配置中“进入”的快捷键）
4.  这抱怨“无法启动测试项目'RowanBeach.Crm.Domain.Test'，因为该项目不包含任何测试。”
5.  从 Resharper 菜单运行“调试单元测试”命令（我将此绑定到我机器上的组合键）
6.  这将显示“没有可用的源代码...”消息

当然，这不是您应该从 resharper 开始单元测试的方式！:) 如果那是您正在做的事情（或类似的事情），请尝试以下操作：

1.  不要费心将 dll 设置为启动项目 - 它不需要
2.  构建或重建包含测试的 dll
3.  设置断点
4.  将光标放在要调试的单元测试的源代码中的某个位置，以将其设置为“当前上下文”单元测试
5.  从 Resharper 菜单运行“调试单元测试”命令（如果您还没有将其绑定到组合键）

希望这应该有效

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T18:55:31.213

您正在运行什么类型的测试 - NUnit？质谱测试？还有什么？

我从来没有发现使用 R# 调试测试很困难 - 只需在您的测试中放置一个断点然后继续。你想进入什么方法？我通常不会尝试进入 NUnit 方法本身（断言等），但进入你自己的代码应该没问题。

如果你能想出一个简单的例子，我很乐意自己尝试。

# iphone - 为什么手动移动 UIImageView 很慢？

> ID：761723
> 
> 赞同：0
> 
> 时间：2009-04-17T18:50:31.960
> 
> 标签：iphone, opengl-es

我正在尝试编写一个面对面的 iPhone Air Hockey (like) 游戏。当用户触摸屏幕时，我通过将 UIImageView 中心放置在触摸中心的位置来移动“冰球”。

我还使用计时器移动冰球（另一个 UIImageView）。这种方法缓慢且不稳定。我知道我可以从 OpenGL ES 中获得性能，但如果我能提供帮助，我不希望它参与其中。

我还想利用动画引擎来实现特殊效果等。如何手动将桨和冰球移动到计时器并获得更好的性能。还是我只需要为此接受 OpenGL ES？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T20:54:47.667

> 还是我只需要拥抱 OpenGL？

没有中间地带：CoreAnimation。

Matt Gallagher 有一个[演示游戏](http://cocoawithlove.com/2009/02/asteroids-style-game-in-coreanimation.html)（适用于 Mac），它使用 Core Animation 来显示精灵。您不会在 iPhone 上看到与台式机相同的性能，但是您的游戏比他的示例要简单得多。

# asp.net - ASP.NET 应用程序部署问题

> ID：761725
> 
> 赞同：0
> 
> 时间：2009-04-17T18:50:44.330
> 
> 标签：asp.net, deployment

我正在创建一个 asp.net 应用程序/插件以在 asp.net 网站/电子商务解决方案上运行。我想让用户的部署变得容易，这样他们所要做的就是双击一个图标，我所有的应用程序文件都将放在他们的 asp.net 网站上的正确文件夹和所有必要的第三方文件中，像微软的Visual Fox Pro 9 dll，都会被安装。我可以查看一个好的教程或参考资料来了解如何处理这些部署问题，它们甚至可能吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T18:51:31.723

您可以制作一个 MSI（Microsoft 安装程序）来为他们完成大部分工作。

来自Dino Esposito 的*[Programming Microsoft ASP.NET 3.5](https://rads.stackoverflow.com/amzn/click/com/0735625271)*

> 用于部署的预编译会创建由程序集和静态文件组成的站点的文件表示。此表示可以在任何机器上生成，并且可以打包到 MSI 并进行部署。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T19:05:00.130

1.  创建一个 MSI 绝对是一个不错的选择。
2.  如果您已经拥有所有具有依赖关系的输出，那么批处理复制脚本可以为您完成。
3.  如果您是从源代码构建，请查看 MsBuild/NAnt，您可以修改一些构建后脚本来为您执行该批处理。
4.  您还可以查看[web 部署项目](http://weblogs.asp.net/scottgu/archive/2008/01/28/vs-2008-web-deployment-project-support-released.aspx)。

# asp.net - 移动网络开发？

> ID：761729
> 
> 赞同：2
> 
> 时间：2009-04-17T18:52:07.337
> 
> 标签：asp.net, vb.net, visual-studio-2008, mobile

我有一个现有的网站，我需要为移动设备开发一小部分。由于不在本条目范围内的原因 - 我正在使用 Microsoft 平台和工具 - VS2008、ASP.Net、VB.net、.Net AJAX Framework、jquery。

我有两个问题：

1.  制作页面的最佳页面尺寸（高度和宽度 - 主要是宽度）是多少，因为我不知道哪些设备将访问网站的移动部分。我可以检测它们是否是移动设备并将它们相应地定向到移动部分，但我不想为每个移动设备编写自定义内容 - 所以我想创建一种适合所有移动应用程序的东西。

2.  .Net 3.5 框架环境中移动 Web 开发的任何建议或链接？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T20:21:55.297

您的普通移动设备的屏幕分辨率仍然非常小。

一个[快速的谷歌](http://www.google.com/search?btnG=1&q=mobile+screen+resolution+list)发现了许多网站列出了这种事情，或者指向列表，我看到的最好的一个是：

> [按品牌和型号划分的手机屏幕分辨率](http://cartoonized.net/cellphone-screen-resolution.php)

或者为了更好地了解平均值：

> [手机屏幕分辨率，按大小排序](http://cartoonized.net/cellphone-screen-resolution-by-size.php)

至于构建移动版本，我将从[System.Web.Mobile](http://msdn.microsoft.com/en-us/library/system.web.mobile.aspx)开始，然后从那里开始工作 - 接受[System.Web.Ui.MobileControls](http://msdn.microsoft.com/en-us/library/system.web.ui.mobilecontrols.aspx)以及[他们的演练](http://msdn.microsoft.com/en-us/library/z8h56a3f(VS.80).aspx)。

我可以说“谢谢你为我们着想”吗？作为“移动”互联网的用户，遇到在我的手机（Windows Mobile 6.1，安装了 Opera Mobile 8.5）上无法运行的大量启用 javascript 的网站（我正在看着你）总是很痛苦因为 JS 支持有限（或感知到的限制）。

* * *

刚刚有了另一个想法 - 每个人都在谈论 DRY - 研究 MVC 框架将是一件非常好的事情 - 然后你的控制器可以都是相同的，并且只返回基于浏览器上限的修改视图 - [Scott Hanselmann 包括一个在他的 MIX 演讲中谈到了这一点](http://www.hanselman.com/blog/MixMobileWebSitesWithASPNETMVCAndTheMobileBrowserDefinitionFile.aspx)，都是好东西。

* * *

我知道我在这里还有更多。

Scott 对此也有播客（[ASP.Net 和移动网络](http://www.hanselminutes.com/default.aspx?showID=172)），[移动设备浏览器文件](http://mdbf.codeplex.com/)位于 codeplex

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T20:06:53.163

我们现在正在开发一个移动应用程序作为一个单独的应用程序。这个设计决定的原因是我们不会使用我们现有的页面，因为它们包含太多信息。因此，尽管 Scott 在一定程度上认为“干燥”是有道理的，但这并不是一个准确的概括。

移动应用程序应该针对非常小的屏幕和低带宽进行优化。尽量减少图片、JS文件等。这将改善用户的体验。您可以做的最好的事情是获得移动设备或一些模拟器，并检查它们在这些设备上的表现/外观。[这是一个很酷的 iPhone](http://www.testiphone.com/)。

此外，请记住，许多移动用户只使用移动应用程序几分钟 - 并且只是为了快速获取关键信息。您的应用程序应该让用户通过最少的几次点击和页面加载轻松地仅访问他们需要的信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T19:57:42.610

理想情况下，您应该开发不受屏幕大小影响的页面。为移动设备创建单独的页面意味着在需要更改时必须在两个地方进行更新。这违背了不重复自己的原则。使用手持媒体类型创建样式表以将您的内容提供给移动设备。这使您可以很容易地将元素重新定位为单列格式。请注意，许多移动设备会向服务器报告它们同时接受手持和屏幕媒体类型，因为它们试图提供与桌面一致的用户体验。您可能需要覆盖手持式样式表中的一些屏幕规则。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-02T23:35:31.900

在构建 XHTML+CSS 模板时，有几种不同的显示尺寸值得考虑。

它们如下（以 px 为单位的宽度）：

*   120 - 我怀疑没有必要担心小于 120 像素的显示器。无论如何，可能必须在 WML 中提供更少的服务。
*   128
*   176
*   240
*   320 - 可能是您目前需要担心的最大宽度。

所有的变化都应该适合这些宽度。还可以考虑将宽度设置为比视口小 10 像素左右（例如 240 必须为 230）。图像也是如此。这是必要的，因为滚动条会在许多移动浏览器上进一步缩小视口。

无需担心高度，就像普通浏览器一样，这不是问题 - 始终可以向下滚动。但是，一个好的建议可能是保持页面相对较短。

哦，我会向你指出[WURFL](http://wurfl.sourceforge.net/)，虽然我自己没有使用过它，但也许你会发现它很有用。

# php - Unix 时间戳和 JavaScript 时间；太大！

> ID：761734
> 
> 赞同：2
> 
> 时间：2009-04-17T18:53:59.267
> 
> 标签：php, javascript, time, bignum

我正在为 jQuery 使用 flot 图形库，它对任何时间序列都使用 javascript 时间（提醒一下，这是自 1970 年 1 月以来的毫秒数。Unix 时间是*seconds*）。

我当前的代码如下所示：

```
foreach($decoded['results'] as $currentResult) {
         if($currentResult['from_user'] == $user) {
             $strippedTexts = $currentResult['created_at'];
             $dates []= strtotime($strippedTexts);
         }
    } 
```

这给了我一组 Unix 时间戳。我想在循环中为 JavaScript 准备数据，但是当我尝试

```
$dates []= 1000*strtotime($strippedTexts); 
```

数字太大，它会吐出“[-2147483648]”。我是否需要将允许在数组中保存的变量的“类型”更改为 bignum 之类的？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T19:05:32.237

试试这个：

```
$dates []= 1000.0*strtotime($strippedTexts); 
```

这将把它变成浮点数，在 php 中它可以存储比 int 更大的数字。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T19:02:51.977

[如果有可用的BCMath 任意精度函数](http://php.net/manual/en/ref.bc.php)，您可以尝试使用它们：

```
$dates[] = bcmul("1000", strtotime($strippedTexts)); 
```

或者只是，你知道，在末尾附加三个零。

```
$dates[] = strtotime($strippedTexts).'000'; 
```

在这两种情况下，您最终都会将值存储为字符串，但这对您的使用无关紧要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-27T05:45:06.410

不需要解决方案，因为没有问题：让 JavaScript 来做乘法。

# asp.net - 向表单添加自定义成员资格

> ID：761739
> 
> 赞同：0
> 
> 时间：2009-04-17T18:56:00.137
> 
> 标签：asp.net, asp.net-membership

我有一个使用 asp.net 成员表的站点（ASP 3.5 站点）。我将使用 Excel 表定期将用户添加到会员表中，并且我想通过表单上传所有 Excel 信息。我使用了一个小表单应用程序来处理 Excel 表，现在准备将信息添加到成员表中。

有没有办法调用成员资格表的成员资格类并在处理 Excel 工作表时从 from 手动添加用户？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T19:18:05.857

您可以使用 Membership.CreateUser()

这是[链接](http://msdn.microsoft.com/en-us/library/system.web.security.membership.createuser.aspx)

# linker - 在 Windows 中链接 libsox

> ID：761744
> 
> 赞同：1
> 
> 时间：2009-04-17T18:56:47.607
> 
> 标签：linker, sox

谁能帮助我将 libsox 链接到我在 Windows 中的程序？我根据 sox 14.2.0 源代码版本的 INSTALL 文件中的说明制作了一个静态库 libsox.lib。有没有办法建立一个动态库？我认为这应该是更简单的方法...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-17T19:48:26.220

您使用什么语言？您目前如何构建和链接库？

[此链接](http://www.codeproject.com/KB/DLL/XDllPt1.aspx)提供了一些有关在 windows 下在 VC++ 中链接库的信息，但如果没有您提供的更多信息，没人能提供帮助

# visual-studio-2008 - VS2008 立即窗口丢失

> ID：761750
> 
> 赞同：8
> 
> 时间：2009-04-17T18:58:34.903
> 
> 标签：visual-studio-2008

我在 Visual Studio 2008 中工作，不久前，我无法访问通常停靠在 IDE 底部的窗口（立即、错误列表、搜索结果），而且我找不到让它们再次恢复的方法。

我试过

*   使用所有可能的快捷方式（`CTRL`++ 、`ALT`++ ）——它们都不起作用`I``CTRL``ALT``O`
*   使用菜单：Debug > Windows > Immediate- 不起作用
*   进行搜索 - 没有结果出现
*   重新启动 - 也没有工作

但是，我可以观看、停靠并通常在断点窗口中工作。当我处于调试模式时，我可以再次看到它们，但如果我尝试取消停靠窗口，我会得到一个 VS 异常。

有没有人遇到过这个问题？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-17T19:00:13.527

菜单命令（您已经尝试过）

*   调试 > Windows > 立即
*   查看 > 查找结果 > 查找结果

或键盘快捷键

`Ctrl`+`D`或+ + `I`（对于立即窗口）`Ctrl``Alt``I`

应该管用。

如果他们不这样做，（这不是因为窗户被折叠、未停靠等），那么就出了问题。

尝试

```
窗口 > 重置窗口布局
```

（请参阅 Mladen 的帖子）如果失败，请尝试重新启动 Visual Studio。

如果一切都失败了，你可以试试

```
工具 > 导入和导出设置... > 重置所有设置
```

（它为您提供了备份当前设置的选项）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-17T19:11:34.700

另一个尝试，在运行应用程序时，转到窗口/重置窗口布局...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-07-15T08:28:26.510

试试这个

[http://blogs.msdn.com/b/wriju/archive/2009/05/14/immediate-window-is-missing-in-visual-studio-menu.aspx](http://blogs.msdn.com/b/wriju/archive/2009/05/14/immediate-window-is-missing-in-visual-studio-menu.aspx)

这是您可以从命令窗口找到即时窗口的地方

# .net - ASP.NET 站点地图配置错误

> ID：761756
> 
> 赞同：4
> 
> 时间：2009-04-17T18:59:59.427
> 
> 标签：.net, asp.net, sitemap

我收到了这个错误，但不知道它是什么意思：

> System.Configuration.ConfigurationErrorsException：在`<siteMapNode>`元素内直接需要一个`<siteMap>`元素。

你能帮助我吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-17T19:03:28.807

可能是站点地图的东西......我用谷歌搜索并发现了这个：

[http://forums.asp.net/t/1245553.aspx](http://forums.asp.net/t/1245553.aspx)

> 站点地图必须有一个根 siteMapNode 元素，所有其他元素都位于该元素之下。所以你有了：
> 
> ```
> <siteMap>
>     <siteMapNode title="Home" ...>
>         all other nodes
>     </siteMapNode>
> </siteMap> 
> ```
> 
> 这意味着所有节点至少是根节点的子节点。显示菜单时，您可以选择不显示根节点，或同时显示根节点和子节点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-01-10T18:04:00.000

如果您正在从站点地图构建菜单并且您不想将所有菜单项都放在一个节点中，那么您可以使用属性隐藏 SiteMapDataSource 中的起始节点

```
ShowStartingNode="false" 
```

例如：

```
<asp:SiteMapDataSource ID="MainMenuSiteMap" SiteMapProvider="MainMenuProvider" ShowStartingNode="false" runat="server" /`> 
```

# c# - 内部连接内部扩展方法（linq）

> ID：761757
> 
> 赞同：1
> 
> 时间：2009-04-17T19:00:06.587
> 
> 标签：c#, linq, extension-methods

我正在尝试为存储库编写扩展方法。存储库有一个`IQueryable<parent>`GetAll() 方法。我想创建一个扩展方法 FilterByChildId(int childId) 以便我可以编写：

```
List<parent> data = from d in repository.getAll().FilterByChildId(33).ToList() 
```

不确定如何在扩展方法中对父子节点进行连接。我认为它会是这样的：

```
public static IQueryable<parent> FilterByChildId(
  this IQueryable<parent> query, 
  int id)
{
  return from data in query where data.child.id == id select data
} 
```

但没有机会。我使用 join、groupjoin 尝试了各种变体，但没有点击。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T19:11:03.970

我基本上会写和你一样的。

```
public static IQueryable<Parent> FilterByChildId(
   this IQueryable<Parent> parents, Int32 id)
{
   return parents.Where(p => p.Child.Id == id);
} 
```

刚刚用我的一个实体框架模型检查了它，它可以工作。正如您的代码所示，我假设一个简单的多（父）对一个（子）关系。请注意，这有点令人困惑 - 一个孩子的许多父母。可能是你有一个多对多的关系吗？一个父母可能有很多孩子，一个孩子可能有多个父母？那么属性`Childs`（`child`在您的代码中）将是一个集合，并且必须按如下方式更改代码。

```
public static IQueryable<Parent> FilterByChildId(
   this IQueryable<Parent> parents, Int32 id)
{
   return parents.Where(p => p.Childs.Any(c => c.Id == id));
} 
```

第三种可能性是一个父母有很多孩子。第二种方法适用于这种情况，但假设子 ID 是唯一的，则总是最多返回一个父级。

# javascript - 使用 JavaScript，有哪些选项可以设置当前选择的导航项？

> ID：761767
> 
> 赞同：0
> 
> 时间：2009-04-17T19:03:57.637
> 
> 标签：javascript, menu

使用 JavaScript，有哪些选项可以设置当前选择的导航项？

假设每当有人单击导航链接时页面都会刷新，唯一的方法是在服务器端执行它还是通过查找当前 URL 来动态设置它？

还有其他技巧吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T19:15:11.043

该[`window.location.pathname`](http://www.w3schools.com/htmldom/prop_loc_pathname.asp)属性是可靠的，如果您要使用子字符串与菜单中链接的 href 进行比较，它会很快（即没有正则表达式测试）。

```
var menuLinks = document.getElementById('menu').getElementsByTagName('a');

for (var i = 0; i < menuLinks.length; i++) {
  if (menuLinks[i].href.indexOf(window.location.pathname) > -1) {
    doSomething();
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T19:16:27.000

我为页面的元素设置了一个类属性`<body>`，例如“home-section”或“products-section”。

当页面加载时，您可以使用 JavaScript 来检索属性的值并适当地设置导航类。

```
if ($("body").attr("class") == 'home-section') {
    $("li#primary-nav-home").addClass("active");
} 
```

您也可以使用适当的选择器直接使用 CSS 来完成同样的事情，并摆脱对类的需求。

`body.home-section li#primary-nav-home { /* styling rules */ }`

# c# - 如何在 .NET 远程处理期间使用自定义序列化？

> ID：761770
> 
> 赞同：5
> 
> 时间：2009-04-17T19:04:15.500
> 
> 标签：c#, .net, serialization, remoting

我编写了一个自定义序列化例程，它不使用 ISerializable 或 SerialzableAttribute 将我的对象保存到文件中。

我也远程这些相同的对象，并希望使用相同的序列化技术。但是，我不想实现 ISerializable，因为我的序列化方法与我的对象完全分离（我希望它保持这种状态）。

有没有一种简单的方法（可能使用远程接收器），我可以获取一个流并向其写入字节，另一方面从中读取字节，跳过 .NET 中的序列化框架？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T20:32:22.260

如果您想使用*远程处理*，那么您仅限于`BinaryFormatter`. 通常，您可以使用“序列化代理”来提供与格式化程序分开的序列化程序，但是 AFAIK 这不适用于 .NET 远程处理。

然而; 如果您编写自己的 RPC 堆栈（例如通过 TCP/IP 或 HTTP），您将拥有更多的控制权。同样，使用 WCF，您可以通过行为替换序列化程序。[我在protobuf-net](http://code.google.com/p/protobuf-net/)中使用了这两个技巧（WCF 钩子[在这里](http://code.google.com/p/protobuf-net/source/browse/#svn/trunk/protobuf-net/ServiceModel)）。

不确定您是否可以通过*远程处理*来做到这一点- 您可能必须使用`ISerializable`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T19:10:46.107

如果要显式处理进程之间的流字节，请使用管道。[这是命名管道](http://www.switchonthecode.com/tutorials/interprocess-communication-using-named-pipes-in-csharp)的入门，谷歌也有很多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-23T18:16:35.437

您可以实现[IClientFormatterSinkProvider](http://msdn.microsoft.com/en-us/library/system.runtime.remoting.channels.iclientformattersinkprovider%28v=vs.100%29.aspx)和 IServerFormatterSinkProvider 并配置通道格式化程序（fe[通过配置](http://msdn.microsoft.com/en-us/library/ka23a3hs%28v=vs.100%29.aspx)）。

有关实现细节，请参阅 BinaryServerFormatterSinkProvider / BinaryServerFormatterSink 和 BinaryClientFormatterSinkProvider / BinaryClientFormatterSink。

# css - 使用 css 强制抗锯齿：这是一个神话吗？

> ID：761778
> 
> 赞同：62
> 
> 时间：2009-04-17T19:06:20.143
> 
> 标签：css, fonts

最近有客户抱怨 IE6 中出现了系统字体。基本上这个问题是 IE6 不支持字体平滑/抗锯齿（我知道你可以在操作系统设置或其他东西中打开它）。但是有人扔掉了这个宝石：

“您可以通过使用 pt 而不是 px 来强制 css 中的字体抗锯齿。”

我在各种浏览器中做了一个快速的 POC，并没有发现任何区别。我在网上找到了一个参考，这个论坛的最后一个帖子：

[http://www.webmasterworld.com/css/3280638.htm](http://www.webmasterworld.com/css/3280638.htm)

这听起来相当于一个网络开发者的都市神话，我的感觉是它的 BS。有人遇到过吗？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-01-03T01:35:19.043

# 哦，是的，您可以：

```
-webkit-font-smoothing: antialiased;
-moz-osx-font-smoothing: grayscale;
font-smoothing: antialiased; 
```

[火狐的来源](https://stackoverflow.com/a/17927764/922522)，感谢[贾斯汀](https://stackoverflow.com/users/922522/justin)的提醒。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2011-03-14T21:09:42.083

CSS3 中有这些令人兴奋的新属性：

```
font-smooth:always;
-webkit-font-smoothing: antialiased; 
```

尽管如此，我自己仍然没有对它们进行太多测试，而且它们几乎肯定不会对 IE 有任何好处。可能对 Windows 上的 Chrome 或 Firefox 有用。上次我检查时，他们并没有像在 OSX 中那样自动消除小东西的锯齿。

**更新**

IE 或 Firefox 不支持这些。据我记得，font-smooth 属性仅在 iOS Safari 中可用

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2009-04-17T19:17:36.887

不，作为 Web 开发人员，没有任何方法可以控制这一点。

[小的例外是您可以通过sIFR](http://www.mikeindustries.com/blog/sifr/)使用 Flash 来做一些虚假的抗锯齿强制，并且一些浏览器不会抗锯齿位图/像素字体（因为它们不应该，更多信息：[Anti-Aliasing](http://daringfireball.net/2003/03/antialiasing) / [Anti-Anti - 混叠](http://daringfireball.net/2003/03/antiantialiasing)）。

此外，正如 Daniel 提到的，对所有字体使用`em`单位是理想的，请参阅[The Incredible Em & Elastic Layouts with CSS](http://jontangerine.com/log/2007/09/the-incredible-em-and-elastic-layouts-with-css)了解更多信息。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2010-01-27T11:34:40.673

我发现了一个非常尴尬的解决方案，使用缩放和过滤 ms-only 属性示例（尝试不使用 aa、标准和 cleartype）： [http ://nadycoon.hu/special/archive/internet-explorer-force-antialias.html](http://nadycoon.hu/special/archive/internet-explorer-force-antialias.html)

这个怎么运作：

- 使用 zoom:x, x>1 放大文本

- 应用一些模糊（或任何其他过滤器）

-zoom down with zoom:1/x

它有点慢，非常！需要内存的方法，并且在非白色背景上它有一些轻微的暗光晕。

CSS：

```
.insane-aa-4b                  { zoom:0.25; }
.insane-aa-4b .insane-aa-inner { zoom:4; }
.insane-aa-4b .insane-aa-blur  { zoom:1;
  filter:progid:DXImageTransform.Microsoft.Blur(pixelRadius=2);
} 
```

HTML：

```
<div class="insane-aa-4b">
<div class="insane-aa-blur">
<div class="insane-aa-inner">
  <div style="font-size:12px;">Lorem Ipsum</div>
</div></div></div> 
```

您可以使用这个简短的 jQuery 来强制消除锯齿，只需将 ieaa 类添加到任何内容：

```
$(function(){ $('.ieaa').wrap(
'<div style="zoom:0.25;"><div style="zoom:1;filter:progid:DXImageTransform.Microsoft.Blur(pixelRadius=2);"><div style="zoom:4;"><'+'/div><'+'/div><'+'/div>'
); }); 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-11-26T21:28:11.397

添加以下 CSS 行适用于 Chrome，但不适用于 Internet Explorer 或 Firefox。

`text-shadow: #fff 0px 1px 1px;`

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2010-12-28T21:05:27.350

我不同意乍得伯奇。我们**可以**强制消除锯齿，至少在**Chrome**中使用带有`-webkit-text-stroke`属性的简单 css 技巧：-

```
-webkit-text-stroke: 1px transparent; 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-17T19:13:43.683

我说这是一个神话。

我发现 pt、px 和基于百分比的字体之间的唯一区别在于，当菜单 > 视图 > 文本大小 > 设置？被改变。

IIRC：

*   `px`和基于的`pt`字体不会缩放
*   `percent`在 IE 中基于字体缩放就好了

AFAIK：

*   字体抗锯齿主要由 windows 设置控制，`"ClearType"`或者在 IE7/IE8 的情况下，IE 特定设置为`ClearType`.

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-17T19:13:24.650

我觉得你说的有点不对。您粘贴的线程中有人说您可以通过使用而不是来**停止**抗锯齿，而不是您可以通过使用后者来**强制它。**虽然我对这两种说法都持怀疑态度......`px``pt`

 *** * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-04-26T19:07:51.337

px 到 pt 修复在使用 Google Web Fonts 字体的网站上为我工作。在 Win7 - IE8 上，它正确修复了缺少抗锯齿渲染的问题。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-12-06T21:34:00.760

使用 99% 的不透明度设置（通过 DXTransform 过滤器）实际上会强制 Internet Explorer 关闭 ClearType，至少在版本 7 中是这样。[来源](http://blogs.msdn.com/ie/archive/2006/08/31/730887.aspx)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-12-13T18:36:50.573

这是实现抗锯齿的好方法：

```
text-shadow: 0 0 1px rgba(0,0,0,0.3); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-17T19:14:29.610

我怀疑无论如何都可以强制浏览器做任何事情。这取决于系统配置、使用的字体、浏览器设置等。这对我来说听起来也很废话。

请注意，始终使用相对大小而不是 PX。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-09-14T13:31:51.297

似乎可以在[http://www.elfboy.com/blog/text-shadow_anti-aliasing/](http://www.elfboy.com/blog/text-shadow_anti-aliasing/)找到最详尽的解决方案。在 Firefox 和 Chrome 中工作，尽管 Firefox 不如 Chrome 有效。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-02-06T20:47:02.167

附带说明一下，Gecko 和 WebKit 支持

```
text-rendering 
```

财产也是如此。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-09-13T13:55:36.333

不是纯 CSS 而是原生支持的方法，没有任何字体替换技巧：只需将字体转换为 SVG 并按 @font-face 顺序将其放在更高的位置（在 WOFF 或 TTF 之前）。瞧！字体现在很平滑，因为它们不再被视为字体，而是被很好地平滑的 SVG 形状。

注意：我注意到 SVG 比 WOFF 或 TTF 更重要。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-03-11T16:58:51.907

我找到了一个修复...

```
.text {
            font-size: 15px;  /* for firefox */
            *font-size: 90%; /* % restart the antialiasing for ie, note the * hack */
            font-weight: bold; /* needed, don't know why! */
        } 
```

# silverlight - Debugging Silverlight Bindings

> ID：761779
> 
> 赞同：4
> 
> 时间：2009-04-17T19:06:30.563
> 
> 标签：silverlight, debugging, data-binding

I have a binding in Silverlight that is causing my application to exit. An unhandled exception is not throw; I just get a white screen.

I am not seeing anything from the binding engine in the output window.

Does anyone have any ideas for debugging this issue?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-10-16T19:20:36.220

我建议您为此使用 Karl Shiflett 的[Silverlight 瞥见](http://karlshifflett.wordpress.com/2009/06/08/glimpse-for-silverlight-viewing-exceptions-and-binding-errors/)。

[另外，我刚刚在推](http://twitter.com/LBugnion/status/4922574340)特上“听到”Laurent Bugnion建议在绑定上使用模拟转换器来找出它失败的原因。如果您不确定将哪些值提供给绑定，这是一个好主意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-07-02T16:12:25.110

Dave，不要对 SL5 中的 XAML 调试过于兴奋。我已经在 SL5 中构建项目几个星期了，我只能说 XAML 调试器在很少使用后就会中断，而你得到的只是荒谬的错误消息，说找不到 PDB。我已经多次重置我的 VS2010 设置，但调试器仍然瘫痪。我花了几天甚至几周的时间试图找出原因，并且像往常一样没有针对此问题的支持文档或帮助站点。调试 Silverlight 数据绑定是一种黑盒方案，也是该技术的一个巨大弱点。没有办法知道 XAML 解析器在做什么或不做什么，视情况而定。由于视图中的绑定完全失败，我不得不放弃一个项目。由于视图上的所有绑定失败，VM 正在正确执行。人们会告诉你，VS2010 中的输出窗口会显示绑定错误。我的经验是，您可能会遇到绑定完全失败的情况，并且不会在输出窗口中显示任何错误。如果您遇到这种情况，则根本没有我知道的解决方案，甚至充满错误的 XAML 调试器也无法为您提供帮助。

# cluster-computing - PBS: Requesting only a single core per node without requesting the entire node

> ID：761789
> 
> 赞同：1
> 
> 时间：2009-04-17T19:11:08.167
> 
> 标签：cluster-computing, hpc, pbs

I've got processes that need to be farmed out over a cluster that supports PBS, however, due to limitations with the process, I can only run one process per node at a time. Each node has two processors, the ghetto approach would be to simply request two processors per job. But that wastes a core per job. Is it possible to request a single core per job while making sure that only a single process from all of my jobs is running at a time on a given node?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-01-12T23:39:15.937

`qsub -l place=free:excl`应该做的伎俩

# c++ - 在 C/C++ 中在当地时间和 GMT/UTC 之间转换

> ID：761791
> 
> 赞同：31
> 
> 时间：2009-04-17T19:11:43.780
> 
> 标签：c++, c, timezone, dst

在 C/C++ 中本地时间和 UTC 之间转换日期时间的最佳方法是什么？

“日期时间”是指包含日期和时间的一些时间表示。`time_t`我会对,`struct tm`或任何其他使其成为可能的表示方式感到满意。

我的平台是Linux。

这是我要解决的具体问题：我得到一对包含儒略日期和一天中的秒数的值。这些值在 GMT 中。我需要将其转换为本地时区“YYYYMMDDHHMMSS”值。我知道如何将儒略日期转换为 YMD，显然很容易将秒转换为 HHMMSS。然而，棘手的部分是时区转换。我确信我可以找到解决方案，但我更愿意找到一种“标准”或“众所周知”的方式，而不是四处走动。

* * *

一个可能相关的问题是[Get Daylight Saving Transition Dates For Time Zones in C](https://stackoverflow.com/questions/678445/get-daylight-saving-transition-dates-for-time-zones-in-c)

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-17T19:17:07.513

您应该使用`gmtime`/`localtime`和`timegm`/的组合`mktime`。那应该为您提供正交工具来在 和 之间进行`struct tm`转换`time_t`。

对于 UTC/GMT：

```
time_t t;
struct tm tm;
struct tm * tmp;
...
t = timegm(&tm);
...
tmp = gmtime(t); 
```

对于当地时间：

```
t = mktime(&tm);
...
tmp = localtime(t); 
```

所做的只是从环境变量`tzset()`中设置内部时区变量。`TZ`我认为这不应该被多次调用。

如果您尝试在时区之间进行转换，则应修改`struct tm`'s `tm_gmtoff`.

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-06-24T16:12:44.660

如果在 Windows 上，您没有可用的 timegm()：

```
struct tm *tptr;
time_t secs, local_secs, gmt_secs;
time( &secs );  // Current time in GMT
// Remember that localtime/gmtime overwrite same location
tptr = localtime( &secs );
local_secs = mktime( tptr );
tptr = gmtime( &secs );
gmt_secs = mktime( tptr );
long diff_secs = long(local_secs - gmt_secs); 
```

或类似的东西...

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-18T02:57:19.107

如果您需要担心使用时区规则转换日期/时间，您可能需要查看[ICU](http://userguide.icu-project.org/intro)。

# python - 如何从字符串中修剪空格？

> ID：761804
> 
> 赞同：1314
> 
> 时间：2009-04-17T19:16:06.860
> 
> 标签：python, string, trim

如何从 Python 中的字符串中删除前导和尾随空格？

例如：

```
" Hello " --> "Hello"
" Hello"  --> "Hello"
"Hello "  --> "Hello"
"Bob has a cat" --> "Bob has a cat" 
```

* * *

## 回答 #1

> 赞同：1929
> 
> 时间：2009-04-17T19:21:29.607

只是一个空格还是所有连续的空格？如果是第二个，那么字符串已经有一个[`.strip()`](https://docs.python.org/library/stdtypes.html#str.strip)方法：

```
>>> ' Hello '.strip()
'Hello'
>>> ' Hello'.strip()
'Hello'
>>> 'Bob has a cat'.strip()
'Bob has a cat'
>>> '   Hello   '.strip()  # ALL consecutive spaces at both ends removed
'Hello' 
```

但是，如果您只需要删除一个空格，您可以这样做：

```
def strip_one_space(s):
    if s.endswith(" "): s = s[:-1]
    if s.startswith(" "): s = s[1:]
    return s

>>> strip_one_space("   Hello ")
'  Hello' 
```

另外，请注意，它`str.strip()`也会删除其他空白字符（例如制表符和换行符）。要仅删除空格，您可以将要删除的字符指定为 的参数`strip`，即：

```
>>> "  Hello\n".strip(" ")
'Hello\n' 
```

* * *

## 回答 #2

> 赞同：279
> 
> 时间：2011-05-18T04:16:47.390

正如上面的答案所指出的

```
my_string.strip() 
```

将删除所有前导和尾随空白字符，例如`\n`, `\r`, `\t`, `\f`, space 。

为了获得更大的灵活性，请使用以下

*   仅删除**前导**空白字符：[`my_string.lstrip()`](https://docs.python.org/library/stdtypes.html#str.lstrip)
*   仅删除**尾随**空格字符：[`my_string.rstrip()`](https://docs.python.org/library/stdtypes.html#str.rstrip)
*   删除**特定的**空白字符：`my_string.strip('\n')`或`my_string.lstrip('\n\r')`或`my_string.rstrip('\n\t')`等等。

[文档](https://docs.python.org/library/stdtypes.html#string-methods)中提供了更多详细信息。

* * *

## 回答 #3

> 赞同：131
> 
> 时间：2012-04-17T13:22:23.820

`strip`也不限于空白字符：

```
# remove all leading/trailing commas, periods and hyphens
title = title.strip(',.-') 
```

* * *

## 回答 #4

> 赞同：60
> 
> 时间：2009-04-17T19:19:12.780

这将删除**所有**前导和尾随空格`myString`：

```
myString.strip() 
```

* * *

## 回答 #5

> 赞同：29
> 
> 时间：2009-04-17T19:21:14.007

你想要[`strip()`](https://docs.python.org/library/stdtypes.html#str.strip)：

```
myphrases = [" Hello ", " Hello", "Hello ", "Bob has a cat"]

for phrase in myphrases:
    print(phrase.strip()) 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2020-05-02T00:18:28.820

这也可以用正则表达式来完成

```
import re

input  = " Hello "
output = re.sub(r'^\s+|\s+$', '', input)
# output = 'Hello' 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-06-17T17:58:27.700

好吧，作为初学者看到这个线程让我头晕目眩。因此想出了一个简单的捷径。

尽管**str.strip()**可以删除前导和尾随空格，但它对**字符之间的空格没有任何作用。**

```
words=input("Enter the word to test")
# If I have a user enter discontinous threads it becomes a problem
# input = "   he llo, ho w are y ou  "
n=words.strip()
print(n)
# output "he llo, ho w are y ou" - only leading & trailing spaces are removed 
```

相反，***使用 str.replace()***更有意义，错误更少，更重要。下面的代码可以概括 str.replace() 的使用

```
def whitespace(words):
    r=words.replace(' ','') # removes all whitespace
    n=r.replace(',','|') # other uses of replace
    return n
def run():
    words=input("Enter the word to test") # take user input
    m=whitespace(words) #encase the def in run() to imporve usability on various functions
    o=m.count('f') # for testing
    return m,o
print(run())
output- ('hello|howareyou', 0) 
```

在 diff 中继承相同内容时可能会有所帮助。职能。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-08-04T16:35:23.583

为了删除在 Pyhton 中运行完成的代码或程序时会导致大量缩进错误的“空白”。只需执行以下操作；显然，如果 Python 一直告诉错误是第 1、2、3、4、5 行等中的缩进...，只需来回修复该行。

但是，如果您仍然遇到与输入错误、运算符等相关的程序问题，请确保您阅读了 Python 对您大喊大叫的原因：

**首先要检查的是您的缩进是否正确。**如果这样做，请检查代码中是否有混合制表符和空格。

请记住：代码看起来不错（对您而言），但解释器拒绝运行它。如果你怀疑这一点，一个快速的解决方法是将你的代码带入一个空闲的编辑窗口，然后从菜单系统中选择 Edit..."Select All 从菜单系统中选择 Format..."Untabify Region。如果您将制表符与空格混合在一起，这将一次性将所有制表符转换为空格（并修复任何缩进问题）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-04-11T07:43:53.807

我找不到我正在寻找的解决方案，所以我创建了一些自定义函数。你可以试一试。

```
def cleansed(s: str):
    """:param s: String to be cleansed"""
    assert s is not (None or "")
    # return trimmed(s.replace('"', '').replace("'", ""))
    return trimmed(s)

def trimmed(s: str):
    """:param s: String to be cleansed"""
    assert s is not (None or "")
    ss = trim_start_and_end(s).replace('  ', ' ')
    while '  ' in ss:
        ss = ss.replace('  ', ' ')
    return ss

def trim_start_and_end(s: str):
    """:param s: String to be cleansed"""
    assert s is not (None or "")
    return trim_start(trim_end(s))

def trim_start(s: str):
    """:param s: String to be cleansed"""
    assert s is not (None or "")
    chars = []
    for c in s:
        if c is not ' ' or len(chars) > 0:
            chars.append(c)
    return "".join(chars).lower()

def trim_end(s: str):
    """:param s: String to be cleansed"""
    assert s is not (None or "")
    chars = []
    for c in reversed(s):
        if c is not ' ' or len(chars) > 0:
            chars.append(c)
    return "".join(reversed(chars)).lower()

s1 = '  b Beer '
s2 = 'Beer  b    '
s3 = '      Beer  b    '
s4 = '  bread butter    Beer  b    '

cdd = trim_start(s1)
cddd = trim_end(s2)
clean1 = cleansed(s3)
clean2 = cleansed(s4)

print("\nStr: {0} Len: {1} Cleansed: {2} Len: {3}".format(s1, len(s1), cdd, len(cdd)))
print("\nStr: {0} Len: {1} Cleansed: {2} Len: {3}".format(s2, len(s2), cddd, len(cddd)))
print("\nStr: {0} Len: {1} Cleansed: {2} Len: {3}".format(s3, len(s3), clean1, len(clean1)))
print("\nStr: {0} Len: {1} Cleansed: {2} Len: {3}".format(s4, len(s4), clean2, len(clean2))) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-10-25T10:17:02.697

如果**要从 left 和 right 修剪指定数量的空格**，可以这样做：

```
def remove_outer_spaces(text, num_of_leading, num_of_trailing):
    text = list(text)
    for i in range(num_of_leading):
        if text[i] == " ":
            text[i] = ""
        else:
            break

    for i in range(1, num_of_trailing+1):
        if text[-i] == " ":
            text[-i] = ""
        else:
            break
    return ''.join(text)

txt1 = "   MY name is     "
print(remove_outer_spaces(txt1, 1, 1))  # result is: "  MY name is    "
print(remove_outer_spaces(txt1, 2, 3))  # result is: " MY name is  "
print(remove_outer_spaces(txt1, 6, 8))  # result is: "MY name is" 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-05-17T00:42:19.803

> 如何从 Python 中的字符串中删除前导和尾随空格？

所以下面的解决方案也将删除前导和尾随空格以及中间空格。就像您需要获得没有多个空格的清晰字符串值一样。

```
>>> str_1 = '     Hello World'
>>> print(' '.join(str_1.split()))
Hello World
>>>
>>>
>>> str_2 = '     Hello      World'
>>> print(' '.join(str_2.split()))
Hello World
>>>
>>>
>>> str_3 = 'Hello World     '
>>> print(' '.join(str_3.split()))
Hello World
>>>
>>>
>>> str_4 = 'Hello      World     '
>>> print(' '.join(str_4.split()))
Hello World
>>>
>>>
>>> str_5 = '     Hello World     '
>>> print(' '.join(str_5.split()))
Hello World
>>>
>>>
>>> str_6 = '     Hello      World     '
>>> print(' '.join(str_6.split()))
Hello World
>>>
>>>
>>> str_7 = 'Hello World'
>>> print(' '.join(str_7.split()))
Hello World 
```

如您所见，这将删除字符串中的所有多个空格（输出`Hello World`为所有）。位置无所谓。但是如果你真的需要前导和尾随空格，那么`strip()`就会找到。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2018-09-24T10:53:38.553

我想删除字符串中过多的空格（也在字符串之间，不仅在开头或结尾）。我做了这个，因为我不知道该怎么做：

```
string = "Name : David         Account: 1234             Another thing: something  " 

ready = False
while ready == False:
    pos = string.find("  ")
    if pos != -1:
       string = string.replace("  "," ")
    else:
       ready = True
print(string) 
```

这将替换一个空格中的双空格，直到您不再有双空格

# asp.net - asp会员的问题

> ID：761809
> 
> 赞同：0
> 
> 时间：2009-04-17T19:16:54.830
> 
> 标签：asp.net, sql-server

我有以下代码：

```
 if (Membership.FindUsersByName(username) == null)
        {
            Membership.CreateUser(username, password, email);
        }

        if (!Roles.RoleExists("USR"))
        {
            Roles.CreateRole("USR");
        }
        Roles.AddUserToRole(username,"USR"); 
```

数据被插入到 aspnet_Users 和 aspnet_UsersInRoles 中，但数据没有被插入到 aspnet_membership 中，我需要这些数据，因为我正在使用 asp 登录控件。

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-17T19:25:42.453

试试这个。我相信你没有传递所有参数。

```
string userName = txtUserId.Text;

//this value is either encrypted or hashed and is never displayed 
string password = txtPassword.Text; 

string email = txtEmail.Text;
string passwordQuestion = ddlPasswordQuestion.SelectedValue;

//this value is either encrypted or hashed and is never displayed 
string passwordAnswer = txtPasswordAnswer.Text;

MembershipCreateStatus result;
Membership.CreateUser(userName, password, email, passwordQuestion, passwordAnswer, true,out result);

lblResults.Visible = true;
switch (result) {
  case MembershipCreateStatus.Success:
    txtUserId.Text = null;
    txtPassword.Text = null;
    txtEmail.Text = null;
    ddlPasswordQuestion.SelectedIndex = -1;
    txtPasswordAnswer.Text = null;
    lblResults.Text = "User successfully created!";
    break;
  case MembershipCreateStatus.InvalidUserName:
    lblResults.Text = "The username format was invalid.  Please enter a different username.";
    break;
  case MembershipCreateStatus.InvalidPassword:
    lblResults.Text = "The password was invalid:  A password cannot be an empty string and must also meet the pasword strength requirements of the configured provider.  Please enter a new password.";
    break;
  case MembershipCreateStatus.InvalidEmail:
    lblResults.Text = "The email format was invalid.  Please enter a different username.";
    break;
  case MembershipCreateStatus.InvalidQuestion:
    lblResults.Text = "The password question format was invalid.  Please enter a different question.";
    break;
  case MembershipCreateStatus.InvalidAnswer:
    lblResults.Text = "The password answer format was invalid.  Please enter a different answer.";
    break;
  case MembershipCreateStatus.DuplicateUserName:
    lblResults.Text = "The username is already in use.  Please enter a new username.";
    break;
  case MembershipCreateStatus.DuplicateEmail:
    lblResults.Text = "The email address is already in use.  Please enter a different email address.";
    break;
  default:
    lblResults.Text = "An error occurred while creating the user.";
    break;
} 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T19:34:24.037

问题在于**if**语句。之所以不起作用，是因为 FindUsersByName 方法返回了 MembershipUsers 的集合。可能没有任何用户，但仍会返回一个集合。

请将语句更改为以下内容...

```
if (Membership.FindUsersByName(username).Count == 0)
{
    Membership.CreateUser(username, password, email);
} 
```

那应该这样做。

# iphone - iPhone 界面生成器和代表

> ID：761814
> 
> 赞同：14
> 
> 时间：2009-04-17T19:18:30.847
> 
> 标签：iphone, interface-builder

当我制作一个示例应用程序（即，从一个标签栏应用程序或其他东西开始）时，在我的 MainWindow.xib 文件中，我看到列出了 5 个项目——文件所有者、第一响应者、应用程序代表、窗口和标签栏控制器。

如果我创建另一个 .xib 文件，并为其创建一个委托，并将该文件的所有者设置为我刚刚创建的新委托，我不会在...objects(?) 的列表中看到“NewDelegateFile”。西布。

这对我来说没有意义，我认为这是我没有那么快地追上 iPhone 开发的重要原因。

有没有人愿意花时间向我解释这个小怪癖？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-17T21:06:06.597

File's Owner 不是 xib 文件中的真实对象。它是一个代理对象。它表示加载时将成为 xib 所有者的对象。First Responder 和 App Delegate 也是代理。第一个响应者是当前位于响应者链顶部的对象。当应用程序的状态发生变化时，另一个对象可能是第一响应者。您可以使用此代理对象将诸如 File->Save 菜单之类的内容连接到在任何给定时间负责处理它的任何对象。

App Delegate 是一个实际的对象。加载 xib 时，它会自动恢复。正如您在 Interface Builder 中看到的，它连接到文件所有者的委托出口。应用程序加载 MainWindow.xib，它是文件的所有者。

其他 xib 文件通常通过委托对象加载。该委托对象是文件的所有者。但是委托本身是从代码中实例化的。它不是从 xib 加载的。这就是它没有在 Interface Builder 中显示的原因。

xib 文件包含实际的序列化对象。文件的所有者和第一响应者是例外。它们代表其他一些已经存在的对象。

文件的所有者（通常是非 MainWindow.xib 文件中的 UIViewDelgate）是鸡。xib是鸡蛋。鸡本身不包含在鸡蛋中。

有点长。希望能帮助到你。

# python - 活动目录 - Django/Rails

> ID：761820
> 
> 赞同：3
> 
> 时间：2009-04-17T19:20:28.813
> 
> 标签：python, ruby-on-rails, ruby, django, active-directory

我正在考虑用 Django 或 Rails 重新编写一个 Web 应用程序，并想知道如何针对 AD 进行身份验证。一个生态系统更适合这个（图书馆等）还是一个折腾？

（该应用程序将托管在 Linux 上）

我有很多重写的理由，其中之一是让自己更有市场。有人愿意评论这些框架中的哪一个对新程序员有更好的长期前景吗？（我已经阅读了 StackOverflow 线程，但请询问以防万一出现新内容）。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T19:32:41.360

一个快速的谷歌给你一些关于在这些环境中使用 Active Directory 的指示。

*   [http://www.djangosnippets.org/snippets/501/](http://www.djangosnippets.org/snippets/501/)
*   [http://www.zorched.net/2007/06/04/active-directory-authentication-for-ruby-on-rails/](http://www.zorched.net/2007/06/04/active-directory-authentication-for-ruby-on-rails/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-18T18:33:31.320

大约一年前，我在 Rails 中进行了 Active Directory 身份验证。我的做法与 Daniel 链接到的文章类似。感觉很hacky，但它是一个内部应用程序，所以它是可以接受的。

从那时起，[Passenger](http://www.modrails.org/) ( `mod_rails`) 出现了，它可能是比 FastCGI 更好的选择。

# python - Python：如何将 Markdown 格式的文本转换为文本

> ID：761824
> 
> 赞同：41
> 
> 时间：2009-04-17T19:21:18.967
> 
> 标签：python, parsing, markdown

我需要将 markdown 文本转换为纯文本格式以在我的网站中显示摘要。我想要python中的代码。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-04-17T19:27:32.137

[Markdown](https://pypi.org/project/Markdown/)和[BeautifulSoup](https://pypi.org/project/beautifulsoup4/) （现在称为*beautifulsoup4*）模块将帮助您完成您所描述的工作。

将 markdown 转换为 HTML 后，可以使用 HTML 解析器去除纯文本。

您的代码可能如下所示：

```
from bs4 import BeautifulSoup
from markdown import markdown

html = markdown(some_html_string)
text = ''.join(BeautifulSoup(html).findAll(text=True)) 
```

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2019-02-28T10:44:42.587

尽管这是一个非常古老的问题，但我想提出一个我最近提出的解决方案。这个既不使用 BeautifulSoup，也没有转换为 html 和返回的开销。

**markdown**模块核心类 Markdown 有一个属性**output_formats**，它是不可配置的，但可以像 python 中的几乎任何东西一样修补。此属性是将输出格式名称映射到渲染函数的字典。默认情况下，它有两种输出格式，'html' 和 'xhtml' 对应。稍加帮助，它可能有一个易于编写的明文渲染功能：

```
from markdown import Markdown
from io import StringIO

def unmark_element(element, stream=None):
    if stream is None:
        stream = StringIO()
    if element.text:
        stream.write(element.text)
    for sub in element:
        unmark_element(sub, stream)
    if element.tail:
        stream.write(element.tail)
    return stream.getvalue()

# patching Markdown
Markdown.output_formats["plain"] = unmark_element
__md = Markdown(output_format="plain")
__md.stripTopLevelTags = False

def unmark(text):
    return __md.convert(text) 
```

**unmark**函数将 markdown 文本作为输入，并返回所有删除的 markdown 字符。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-10-28T14:43:21.183

这类似于 Jason 的回答，但可以正确处理评论。

```
import markdown # pip install markdown
from bs4 import BeautifulSoup # pip install beautifulsoup4

def md_to_text(md):
    html = markdown.markdown(md)
    soup = BeautifulSoup(html, features='html.parser')
    return soup.get_text()

def example():
    md = '**A** [B](http://example.com) <!-- C -->'
    text = md_to_text(md)
    print(text)
    # Output: A B 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-17T19:42:56.950

评论并删除它，因为我终于认为我在这里看到了问题：将您的降价文本转换为 HTML 并从文本中删除 HTML 可能更容易。我不知道有什么可以有效地从文本中删除降价，但是有很多 HTML 到纯文本的解决方案。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2021-11-26T09:53:41.440

我在寻找通过[API 调用执行 sc](https://docs.gitlab.com/ee/api/releases/) [GitLab Releases](https://docs.gitlab.com/ee/user/project/releases/)的方法时来到这里。我希望这与原始提问者的用例相匹配。

我以这种方式将降价解码为纯文本（包括`\n`等形式的空格）：

```
 with open("release_note.md", 'r') as file:
        release_note = file.read()
        description = bytes(release_note, 'utf-8')
    return description.decode("utf-8") 
```

# sql - 处理 SQL 参数的最佳方式？

> ID：761830
> 
> 赞同：0
> 
> 时间：2009-04-17T19:23:27.513
> 
> 标签：sql, .net, parameters, data-access-layer

我基本上有一个与任何业务逻辑完全隔离的数据库层。这意味着每当我准备好将一些业务数据提交到数据库时，我都必须将所有业务属性传递到数据方法的参数中。例如：

`Public Function Commit(foo as object) as Boolean`

这很好用，但是当我进行需要几十个参数的提交和更新时，可能需要大量输入。更不用说我的两个方法——更新和创建——采用相同的参数，因为它们本质上做同样的事情。我想知道的是，传递这些参数的最佳解决方案是什么，这样我就不必在每次发生变化时都更改这两种方法中的参数以及减少我的打字:) 我想到了一些可能的解决方案。一种是将所有 sql 参数移动到数据类的类级别，然后将它们存储在我在业务层中设置的某种数组中。任何帮助都会很有用！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-17T19:27:09.423

所以本质上你想传入一个[参数](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlparameter.aspx)[列表](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)？

为什么不重做 Commit 函数并让它接受 Parameter 对象列表？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T19:27:14.850

如果您在 SQL 2008 上，您可以使用合并来替换插入/更新杂耍。有时称为 upsert。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T19:30:17.887

您可以创建一个`struct`来保存参数值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-22T17:53:05.660

感谢您的回复，但我想我已经找到了更好的方法来做我正在做的事情。它类似于使用 upsert，但我所做的是使用一种名为 Commit 的方法来查找给定的主键。如果在数据库中找到记录，则执行更新命令。如果没有，我会执行插入命令。由于参数相同，您不必担心更改它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-22T18:02:07.183

对于您的问题，我猜迭代器设计模式是最好的解决方案。传入一个接口实现说 ICommitableValues 你可以像这样传入一个密钥对枚举值。键是列名，值是列可提交值。一个属性甚至专门用于返回要在其中插入这些值和/或存储过程等的表名。

为了节省输入，您可以使用声明性编程语法（属性）来声明可提交属性，并且中间件中的主类可以使用反射来提取这些可提交属性的值并从中准备 ICommitableEnumeration 实现。

# c# - 静态反射的动态场？

> ID：761842
> 
> 赞同：2
> 
> 时间：2009-04-17T19:26:44.930
> 
> 标签：c#, reflection, static-reflection

我一直在研究使用 LINQ 表达式的静态反射——非常酷！

我有一个想法——一个类是否有可能基于对另一类进行的静态反射在一个类上“生成”字段？我特别想到了我在这里多次看到的 Builder 模式。我想做一个 fluent-nhibernate 风格的属性注册，在构建器上“生成”与我想要构建的类匹配的字段。像这样的东西：

```
public class Color
{
    private Color()
    {
    }
    public string Name { get; private set; }

    public class Builder : BuilderBase<Color>
    {
        public Builder()
        {
            Property(x => x.Name);
        }
        public Build()
        {
            return built_up_color;
        }
    }
} 
```

并支持这样的构造函数语法：

```
Color c = new Color.Builder() { Name = "Red" }.Build(); 
```

这一切的目的是减少我必须重复定义颜色属性的次数。我玩这个：

```
public class Color
{
    private Color()
    {
    }
    public string Name { get; private set; }

    public class Builder
    {
        private Color _color = new Color();
        public string Name
        {
            get { return _color.Name; }
            set { _color.Name = value; }
        }

        public Build()
        {
            return _color;
        }
    }
} 
```

这当然有效，并且列出了相同的属性 # 次，但感觉更冗长且不太灵活。看来我应该可以在这里做一些匿名类型的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-24T14:12:21.917

值得指出的是，让一个名为 Color 的类与 System.Drawing.Color 发生冲突可能是个坏主意。

这*很*可能导致其他人混淆（更糟糕的是 System.Drawring.Color 具有值语义，而您的类具有引用语义，这可能导致进一步的混淆）

我会指出，您真正想要的是[Named Optional Arguments](http://blogs.msdn.com/samng/archive/2009/02/03/named-arguments-optional-arguments-and-default-values.aspx)。我建议现在放入繁琐的 Builder 类将更加努力，并且一旦您进入 c# 4.0 就会更痛苦地迁移到这些类。而是制作所需的构造函数（或者如果需要避免类型签名冲突，则类上的静态工厂方法）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T19:45:17.320

我认为这是不可能的，除非明确声明它们，否则您无法生成成员。咬紧牙关，为`Color`.

PS：我认为静态反射是用词不当，唯一静态的就是查找要引用的成员——就它而言，这是一件好事，但这并不是很远。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-17T13:32:22.443

编写更少的代码，但使用反射来设置值。

诀窍是使用集合初始化器。它是类型安全的。

```
public class Color
{
    private Color()
    {
    }
    public string Name { get; private set; }
    public int Prop2 { get; private set; }

    public class Builder : Builder<Color>
    {
        public Builder()
        {
            // possible
            _instance.Name = "SomeDefaultValue";
        }
    }
}

class Builder<T> : IEnumerable<string>
{
    protected T _instance = Activator.CreateInstance(typeof(T));

    public void Add<TProperty>(Expression<Func<T, TProperty>> prop, TProperty value)
    {
        StaticReflection.GetPropertyInfo(prop).SetValue(_instance, value, null);
    }

    public static implicit operator T(Builder<T> builder)
    {
        return builder.Build();
    }

    public T Build()
    {
        return _instance;
    }

    IEnumerator<string> IEnumerable<string>.GetEnumerator()
    {
        // e.g. return iterator over the property names
        throw new NotImplementedException();
    }

    IEnumerator IEnumerable.GetEnumerator()
    {
        return ((IEnumerable<string>)this).GetEnumerator();
    }
} 
```

并调用语法

```
var color = new Color.Builder
{
    { x => x.Name, "foo" },
    { x => x.Prop2, 5 }
}.Build();

// or

var color = new Builder<Color>
{
    { x => x.Name, "foo" },
    { x => x.Prop2, 5 }
}.Build();

// or

Color color = new Builder<Color>
{
    { x => x.Name, "foo" },
    { x => x.Prop2, 5 }
}; 
```

# asp.net - 如何将 javascript 放到最初可能隐藏在 ASP.NET 中的控件上？

> ID：761849
> 
> 赞同：2
> 
> 时间：2009-04-17T19:27:49.950
> 
> 标签：asp.net, javascript, controls

我有一个控件，最初显示在一页上，但在另一页上最初是隐藏的。

对于最初显示控件的页面，控件中的 javascript 工作正常，但对于最初隐藏控件的页面，javascript 不起作用。

我最终使用以下代码在代码中注册了javascript：

```
this.Page.ClientScript.RegisterClientScriptBlock(...); 
```

它工作得很好，但是对于大的 javascript 块它会变得很难看。另外，我想更改它，我必须重建解决方案，而我宁愿不必这样做。

如果页面加载时没有发送到浏览器，是否有另一种方法可以使用标记注册 javascript？我试图通过仅在页面加载时向浏览器发送我需要的内容来保持网络流量很小。

谢谢，

标记

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T19:36:42.973

问题不是使按钮不可见，而是拥有一个可以从 javascript 中单击的不可见按钮，并让按钮调用它的事件处理程序。

前任：

```
 <asp:button id="button1" runat="server" style="display:none"> 
```

是您应该使用的东西，或者您可以设置一个带有 display:none 的 css 类，然后将其分配给您的控件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T19:33:23.010

我假设您通过使用 document.getElementById 来获取控件，如果是这种情况，您可以在使用它之前检查它是否为空：

```
var ctrl = document.getElementById("someID");
if (ctrl) {
    do something here...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T19:33:23.027

如果通过将其服务器端属性“Visible”设置为 false 来隐藏您的控件，则浏览器无法将 js 附加到任何内容，因为 ASP.NET 不会呈现该控件。您可以尝试将 CSS 属性“显示”设置为“无”。

# c# - 为什么抽象类的构造函数应该受到保护，而不是公开的？

> ID：761854
> 
> 赞同：59
> 
> 时间：2009-04-17T19:31:19.397
> 
> 标签：c#, .net, oop, inheritance, access-modifiers

ReSharper 建议将类中`public`构造函数的可访问性更改为，但并未说明其背后的基本原理。`abstract``protected`

你能解释一下吗？

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2009-04-17T19:33:30.623

仅仅因为在抽象类中公开是没有意义的。根据定义，抽象类不能直接实例化。它只能由派生类型的实例实例化。因此，唯一可以访问构造函数的类型是它的派生类型，因此受保护比公共更有意义。它更准确地描述了可访问性。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-03-18T14:24:07.247

`public`如果您创建构造函数而不是`protected`抽象类，它在技术上没有任何区别。构造函数的可访问性/可见性仍然完全相同：相同的类或派生类。这两个关键字对所有意图和目的都具有无法区分的效果。

所以，这个选择只是风格问题：类型`protected`来满足精明的面向对象的人。

* * *

默认情况下，反射只会包含构造函数`public`，但无论如何您都不能调用该构造函数。

IntelliSense 将`public`在键入时显示构造函数`new`，但无论如何您都不能调用该构造函数。

程序集的元数据将反映构造函数是公共的或受保护的事实。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-04-17T19:39:38.300

这是一个很好的 OO 实践。

```
public abstract class ExampleAbstractClass
{
    protected ExampleAbstractClass()
    {
      // :::
    }
} 
```

您只希望继承的子类可以访问构造函数。做到这一点的唯一方法是使构造函数受到保护。
请记住，当您向这些构造函数添加参数时，这是一个完全不同的讨论。

# browser - 限制来自服务器端的并发连接数？

> ID：761858
> 
> 赞同：0
> 
> 时间：2009-04-17T19:32:50.343
> 
> 标签：browser, webserver, concurrency, connection

我正在编写自己的网络服务器，但我还没有正确处理并发连接。由于不恰当地处理并发连接，我得到了大量的页面加载延迟（我响应 SYN，但我以某种方式丢失了 GET 数据包。浏览器会在一段时间后重试，但需要 3 秒！）我试图弄清楚是否有指示浏览器停止同时加载内容的方法，因为调试这需要很长时间。网络服务器非常精简，不会公开，也不是这个应用程序的主要目的，这就是为什么我愿意以这种方式偷工减料。

将并发连接限制为 1 会很好，因为使用 IE 的注册表修改该参数和使用 Firefox 的 about:config 都可以使事情完美运行。

任何其他解决方法的想法也会很有用。我能想到的一对：

1 - 指示浏览器缓存所有内容而不会过期，以便缓慢加载（.js、.css 和图像文件）仅发生一次。我可以将校验和附加到文件的末尾（img src="/img/blah.png?12345678"），以确保如果我更新文件，它会正确重新加载。

2 - 添加 .js 和 .css 以与 .html 文件一起加载内联 - 但这仍然不能解决图像问题，而且无论如何都很难看。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-17T19:46:21.437

我不相信有可能告诉像 Firefox 这样的浏览器不要同时加载，至少不能通过一些 http 标头或其他东西来告诉你的用户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-26T19:27:51.390

所以我从来没有找到一种方法来做到这一点。

我的根本问题是有太多请求进入并溢出我在 emac ram 中的有限接收缓冲区。溢出的接收缓冲区 = 丢弃的数据包。解决方案是将所有 .js 和所有 .css 文件合并为 1 个 .js 和 1 个 .css 文件，以降低我的请求。我将所有图像、js 和 css 页面设置为一年到期。html 页面设置为立即过期。我编写了一个 perl 脚本来将 md5 校验和附加到文件中，以便重新获取更改的文件。现在效果很好。页面在第一次加载缓存所有内容后立即加载。

# nhibernate - NHibernate 概念聚合根

> ID：761860
> 
> 赞同：0
> 
> 时间：2009-04-17T19:33:15.647
> 
> 标签：nhibernate, architecture

我有几个我想将其视为聚合的实体。问题是它们的关联是概念性的，而不是通过数据库中的外键。

我得到的模式：（ [来源：][[robtennyson.us](http://files.robtennyson.us/2009/2009-04-17_1414.png)][）][![替代文字](https://i.stack.imgur.com/ZwKzF.png)](https://i.stack.imgur.com/ZwKzF.png)

我的目标是创建一个`InventoryWeek`添加库存交易的类。因此，库存周明显结束`FACIL_INVENTORY_WEEK`，交易被添加到`FACIL_INVENTORY`. 因此，从数据库中提取这个，我会得到给定设施和日期的星期，然后我想要所有`INVENTORY_DATE`在一周内有的交易。

**有没有办法在 nhibernate 中映射这种关系？还是有更好的方法来完全建模？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-22T12:13:12.230

您可以基于非主键映射表之间的关系，但方式有限。

要给出一些具体的建议，你必须问一个更具体的问题。尝试映射它，如果某些东西没有按您的预期工作，请询问。

# ruby - 为什么这段代码会导致堆栈溢出？

> ID：761867
> 
> 赞同：7
> 
> 时间：2009-04-17T19:33:54.710
> 
> 标签：ruby, recursion

以下会导致大'n'的堆栈溢出，我可以理解为什么。

```
def factorial(n)
  (n > 1) ? (return (n * factorial(n - 1))) : (return 1)
end 
```

为什么以下也会导致溢出？

```
def factorial(n, k)
  (n > 1) ? (return factorial(n - 1, lambda {|v| return k.call(v * n)})) : (return k.call(1))
end 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-17T19:53:21.123

您的第二个算法创建了一个`n`长链 lambda 过程，每个过程都包含对前一个过程的引用。我不确切知道 Ruby 做了什么，但是在适当的尾递归语言中，堆栈不会在您的第二个算法中溢出，因为`k.call`在 lambda 中也处于尾部位置。如果，正如 Brian 的实验所暗示的，Ruby 没有适当的尾调用，那么`n`当调用链的头部时，对 lambda 的 -long 嵌套调用链将溢出堆栈，即使 Ruby 足够聪明，可以转换尾部 -递归`factorial`调用循环（=尾调用优化）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-17T19:38:36.883

在大多数语言中，函数调用进入**调用堆栈**，这实际上只是堆栈。递归调用函数会不断添加到调用堆栈中。最终你填满了堆栈，你会得到堆栈溢出。在运行递归函数时，递归级别会很深，这始终是一个危险。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-17T19:40:36.987

出于同样的原因，第一个有堆栈溢出......调用堆栈变得太大。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T19:37:06.277

与第一个函数一样，递归调用最终可能会导致系统无法处理。

# c# - 知道为什么这个用于发送 http 请求的 ASP.NET C# 代码不起作用吗？

> ID：761877
> 
> 赞同：0
> 
> 时间：2009-04-17T19:36:59.133
> 
> 标签：c#, asp.net, http, post, request

代码如下，当我点击页面时：

[http://ryan.local.testmode.com/timecrunch/bctimepost.ashx?project=2593059&person=2831215&date=04/16/2009&hours=2.5&case=555](http://ryan.local.testmode.com/timecrunch/bctimepost.ashx?project=2593059&person=2831215&date=04/16/2009&hours=2.5&case=555)

它只是有点挂起，加载条永远缓慢移动，直到我停下来，我忘了做点什么吗？我不知道哪行代码用于实际“提交”请求......

注意：用户名/密码和 [公司名称] 是共享代码的占位符，并在我的运行代码中包含正确的值

```
using System;
using System.Web;
using System.Xml;
using System.Net;
using System.IO;

public class bctimepost : IHttpHandler {

    public void ProcessRequest(HttpContext context)
    {

        string project_id = context.Request.QueryString["project"];
        string person_id = context.Request.QueryString["person"];
        string post_date = context.Request.QueryString["date"];
        string post_hours = context.Request.QueryString["hours"];
        string case_num = context.Request.QueryString["case"];

        HttpWebRequest objRequest = (HttpWebRequest)WebRequest.Create("https://[company name].updatelog.com/projects/" + project_id + "/time_entries.xml");

        objRequest.Method = "POST";
        objRequest.ContentType = "application/xml";
        objRequest.Accept = "application/xml";

        string creds = "username:password";
        byte[] encData_byte = new byte[creds.Length];
        encData_byte = System.Text.Encoding.UTF8.GetBytes(creds);
        string encodedData = Convert.ToBase64String(encData_byte);

        objRequest.Headers.Add("Authorization", "Basic " + encodedData);

        XmlWriterSettings settings = new XmlWriterSettings();
        settings.Indent = true;
        settings.IndentChars = ("    ");

        using (XmlWriter writer = XmlWriter.Create(objRequest.GetRequestStream(), settings))
        {
            writer.WriteStartElement("time-entry");
            writer.WriteElementString("person-id", person_id);
            writer.WriteElementString("date", post_date);
            writer.WriteElementString("hours", post_hours);
            writer.WriteElementString("description", "Worked on Case #" + case_num);
            writer.WriteEndElement();
        }

        HttpWebResponse myHttpWebResponse = (HttpWebResponse)objRequest.GetResponse();

        context.Response.Write(myHttpWebResponse.StatusCode);

    }

    public bool IsReusable {
        get {
            return false;
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T19:43:55.623

我认为是 XmlWriter 不会自动关闭 GetRequestStream() 返回的流。添加：

```
settings.CloseOutput = true; 
```

在创建 XmlWriter 之前看看是否有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T20:28:01.040

作为旁注，您应该能够替换它：

```
string creds = "username:password";
byte[] encData_byte = new byte[creds.Length];
encData_byte = System.Text.Encoding.UTF8.GetBytes(creds);
string encodedData = Convert.ToBase64String(encData_byte);

objRequest.Headers.Add("Authorization", "Basic " + encodedData); 
```

和：

```
objRequest.Credentials = new NetworkCredential("username", "password"); 
```

# asp.net - 如何对跨项目共享的资源进行版本控制

> ID：761885
> 
> 赞同：4
> 
> 时间：2009-04-17T19:38:46.680
> 
> 标签：asp.net, version-control, tfs, build-automation, branch

我们使用 Team Foundation Server 并拥有大量 ASP.NET Web 应用程序项目。每个 Web 应用程序都使用我们内部开发的自定义内容管理系统。CMS 本身就是一个 ASP.NET Web 应用程序。

部署后，CMS 驻留在子目录中，例如“/Admin”。CMS 由 .aspx 和 ascx 文件组成，相应的程序集当然放在 bin 中。

目前，CMS 文件分别存在于源代码管理中的每个 Web 应用程序中。换句话说，每个依赖于 CMS 的 Web 应用程序中都存在一个“Admin”文件夹。这带来了明显的挑战，因为 CMS 的更新必须分发到每个相关站点。自动化/简化流程是我的工作。

我们目前不执行任何自动构建。我对 TFS 中的源代码控制分支了解有限，我不确定它是否适用于这种情况。确保依赖项目从 CMS 项目接收最新程序集和标记的最佳方法是什么？提前致谢。

听起来#2（来自'bamboo）是我想要的解决方案。鉴于共享代码已经存在于每个单独的项目中，您能否简要描述一下我将通过“分支/共享”CMS 的过程？此外，值得注意的是，我不希望将 .cs 文件传播到依赖项目，而只是传播到标记和程序集。这会改变策略吗？我是否应该首先在共享项目上创建一个构建事件以将必要的文件复制到“发布”文件夹，然后分支发布文件夹？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-17T19:51:04.153

这是处理这种情况的几种流行方法。

1.  将共享内容的 TFS 项目映射到每个应用程序工作区，然后将共享项目包含在每个应用程序解决方案中。如果您希望所有团队/应用程序在构建时立即获得共享更改，请使用此方法，因为他们也会获得最新的共享内容。

2.  将共享内容分支/共享到每个应用程序源代码控制树中。这在 TFS 中很容易做到。如果每个团队/应用程序都想控制他们何时获得最新的共享内容，这真的很好。这使团队能够做他们的事情，直到他们准备好整合共享的东西。

我通常总是喜欢#2。但这实际上取决于您需要/想要如何工作的具体情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T19:46:57.533

不确定 TFS，但在大多数源代码控制系统中，您可以跨多个位置共享代码。对任何共享副本的更改都会反映在所有副本中。在 Visual Studio 级别，它们将显示为独立的代码片段。

您的每个 Web 应用程序（解决方案）都包含一个完全由共享代码组成的项目。通常，源代码是共享的，并成为构建过程的一部分。您可以共享生成的 DLL，但大多数人不使用源代码控制 DLL。

如果您没有共享部分的源代码，则可能在 GAC 中安装代码成为您创建共享部分的唯一选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T23:02:27.003

我们有一个共享库，用于我们的几个项目。然后我们添加对共享库的引用，而不是实际的项目......

然后，您必须将引用的路径添加到构建 xml，以便您的 TFS 服务器知道 .dll 的位置。每次为项目完成新构建时，它会将最新版本的 shared 复制到项目的 bin 中。

我们所有的项目，包括 Shared 都有 4 个分支：开发、集成、暂存和生产。因此，当我们需要对共享库进行更改并且我们在其开发分支中进行更改时，因为它是孤立的。一旦我们感到高兴，我们就会将我们的更改合并到集成中。我们构建共享集成，然后构建受变更影响的项目。这是我们开始测试其他应用程序以查看我们的更改是否导致任何错误的时候。所以...

1.  对共享库进行更改的地方
2.  合并到单个分支，而不是每个项目中的多个分支。
3.  使用 Shared 就像添加参考一样简单
4.  A single project and a version of Shared can be pushed from Development to Production without affecting any of the other projects. The .dll version of Shared is copied to the projects bin folder. Once changes on another project are being done it will get the most recent version when its pushed through its branches.

# c# - 使用 RSACryptoServiceProvider 最小化签名段中的信息

> ID：761889
> 
> 赞同：1
> 
> 时间：2009-04-17T19:39:20.080
> 
> 标签：c#, .net, xml, cryptography

我有一个看起来像这样的 XML 文件

```
<Licence>
      <Name>Test company</Name>
      <Version>1.1.1.1</Version>
      <NumberOfServer>2</NumberOfServer>
</Licence> 
```

然后，我使用之前生成的私钥使用以下代码对 XML 文件进行签名

```
private void SignFile(XmlDocument doc)
{
    SignedXml signedXml = new SignedXml(doc2);

    _cryptoServiceProvider.FromXmlString(XmlDocument.Load("private.key").Root.ToString());

    signedXml.SigningKey = _cryptoServiceProvider;

    Signature XMLSignature = signedXml.Signature;

    Reference reference = new Reference("");

    XmlDsigEnvelopedSignatureTransform env = new XmlDsigEnvelopedSignatureTransform();
    reference.AddTransform(env);

    XMLSignature.SignedInfo.AddReference(reference);

    signedXml.ComputeSignature();

    XmlElement xmlDigitalSignature = signedXml.GetXml();

    doc.DocumentElement.AppendChild(doc2.ImportNode(xmlDigitalSignature, true));

    doc.Save("signed.xml");
} 
```

我得到一个看起来像这样的文件，并使用公钥进行验证！

```
<Licence>
  <Name>Test company</Name>
  <Version>1.1.1.1</Version>
  <NumberOfServer>2</NumberOfServer>
  <Signature xmlns="http://www.w3.org/2000/09/xmldsig#">
    <SignedInfo>
      <CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315" />
      <SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1" />
      <Reference URI="">
        <Transforms>
          <Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature" />
        </Transforms>
        <DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1" />
        <DigestValue>tmGyr97mgGDviRpzcWjpMdNNMSI=</DigestValue>
      </Reference>
    </SignedInfo>
    <SignatureValue>Vc5R/OWiup4Rv7+1Tu8Ino83P0mh6npLkNYEaq0QVa6j+OvISOPERO57EllCQWdB1Lgjc7B+lmV4JiSvdfovkldhNZb4+iFgdrI+qOdSEIsBk/KhGS93PfekhDd3qirGerpeGbLAEqZ36jT0aT/QruZXpOX6Y6H5fqGj4prUZaM=</SignatureValue>
  </Signature>
</Licence> 
```

***但是***我必须在那里有 SignedInfo 字段吗？我怎样才能摆脱它？

我用这样的东西来验证。

```
 _cryptoServiceProvider.FromXmlString(XDocument.Load("public.key").Root.ToString());

    XmlDocument doc = new XmlDocument();
    doc.Load("signed.xml");

    SignedXml signedXml = new SignedXml(doc);

    XmlNodeList nodeList = doc.GetElementsByTagName("Signature");
    signedXml.LoadXml((XmlElement)nodeList[0]);

    bool valid = signedXml.CheckSignature(_cryptoServiceProvider); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T20:05:36.973

不，您不能删除该`SignedInfo`元素。有几个原因：

1.  XML 签名模式需要它。如果您删除它，支持 XML 签名的软件将会崩溃。
2.  是在`SignatureValue`上计算的`SignedInfo`。如果`SignedInfo`不存在，则无需验证。

In a license file, where the message verifier might know the digest algorithm and other parameters though some "out-of-band" means, I suppose you could argue that the verifier could reconstruct the `SignerInfo` structure. But, it seems hard to justify breaking the standard and doing the extra work required.

# date - PowerShell 获取日期

> ID：761891
> 
> 赞同：1
> 
> 时间：2009-04-17T19:39:50.610
> 
> 标签：date, powershell, get

大家好，我在 PowerShell 中有这个：

我有一个包含名为“rep_date”的CustomProp的集合，其中包含格式为：mm/dd/yyyy的日期，现在我想以这种格式保存日期：dd/mm/yyyy，我正在尝试这种方法：

```
For ($i=0;$i –le $HD.count; ++$i)
{
    $B = $HD[$i].CustomProps[‘rep_date’] = Get-Date –date $HD[$i].CustomProps[‘rep_date’] -format "dd.mm.yyyy"

    $HD[$i].CustomProps[‘rep_date’] = $B
} 
```

但不工作。

关于如何做到这一点的任何想法？

此致！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T19:59:55.943

代码中有两个问题。首先是格式字符串应该是“dd.MM.yyyy”。（注意大写M） 第二个是不必要的变量赋值。你可以使用

```
$HD[$i].CustomProps[‘rep_date’] = Get-Date –date $HD[$i].CustomProps[‘rep_date’] -format "dd.MM.yyyy" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-21T15:42:01.397

尝试使用 ToString()：

$HD[$i].CustomProps['rep_date'] = $HD[$i].CustomProps['rep_date'].ToString("dd/MM/yyyy")

# c++ - 错误：从 'const prog_uchar*' 转换为 'byte' 会丢失精度？

> ID：761893
> 
> 赞同：1
> 
> 时间：2009-04-17T19:40:13.120
> 
> 标签：c++, c, avr

错误在这一行：

```
dataArray[iLedMatrix][iRow] |=  (byte)(bufferPattern[iRow]) & (1<<7); 
```

**dataArray**是：字节 dataArray[NUMBER_LED_MATRIX][NUMBER_ROW_PER_MATRIX];

**bufferPattern**是： const patternp * bufferPattern;

**patternp**是以下类型的 typedef： typedef prog_uchar patternp[NUM_ROWS];

我可以在参考中看到 prog_uchar 是 1 个字节（0 到 255）。所以我不明白失去精度的错误？任何想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-17T19:46:34.710

问题出在这个子表达式中

```
(byte)(bufferPattern[iRow]) 
```

变量 bufferPattern 是类型`const patternp *`，因此当应用索引器时，结果是 patternp。“patternp”类型是 prog_uchar[] 的 typedef。所以实际上这个表达式是在说

> 将 prog_uchar* 转换为字节

Byte 几乎可以肯定是单字节值，而 prog_uchar* 是平台特定的指针类型（4 或 8 字节）。这确实会导致精度损失。也许你的意思是取消引用这个值？

```
(byte)(*(bufferPattern[iRow])) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-17T19:45:14.947

您正在尝试从指针类型转换为字节。指针类型通常以 4 字节（32 位操作系统）或 8 字节（64 位）表示，并且您试图将其地址值转换为 1 字节。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T19:48:59.637

`bufferPattern[ iRow ]`解析为 a `patternp`，即 a `prog_uchar[ NUM_ROWS ]`。

因此，您实际上是将数组（实现为指针）转换为字节。没有意义; 幸运的是编译器警告你！

# sql-server-2005 - SQL Server 错误处理：异常和数据库客户端契约

> ID：761898
> 
> 赞同：6
> 
> 时间：2009-04-17T19:42:30.167
> 
> 标签：sql-server-2005, tsql, sql-server-2008, exception, stored-procedures

我们是一个由 SQL Server 数据库开发人员组成的团队。我们的客户混合了 C#/ASP.NET、C# 和 Java Web 服务、Java/Unix 服务和一些 Excel。

我们的客户端开发人员只使用我们提供的存储过程，我们希望（当然，在合理的情况下）他们将它们视为 Web 服务方法。

我们的一些客户开发人员不喜欢 SQL 异常。他们用他们的语言理解它们，但他们不明白 SQL 在我们沟通问题的方式上是有限的。

我不仅仅指 SQL 错误，例如试图将“bob”插入 int 列。

我还指例外情况，例如告诉他们参考值错误，或者数据已经更改，或者他们不能这样做，因为他的总和不为零。

他们实际上并没有任何具体的替代方案：他们提到我们应该输出参数，但我们假设异常意味着“处理停止/回滚。

这里的人们如何处理数据库-客户端合同？通常或在数据库和客户端代码猴子之间存在分离的地方。

编辑：

*   我们只使用 SQL Server 2005 TRY/CATCH
*   我们已经在回滚到异常表后记录了所有错误
*   我们担心我们的一些客户不会检查输出参数并假设一切正常。我们需要标记错误以供支持查看。
*   一切都是例外......客户应该做一些消息解析来区分信息和错误。要将我们的异常与数据库引擎和调用错误分开，它们应该使用错误号（我们当然都是 50,000）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-08-04T21:00:47.497

好吧，我是一个经常处理数据库的客户端代码猴子。这是我的处理方式。

SQL 中发生的异常（引发错误）会传播回调用者。这将包括 ref 约束、唯一索引违规、更严重的问题等。基本上任何不会使数据操作正常发生的事情都应该被传播回来。

调用者 C# 应该有这个：

```
catch (SQLException sqlEx) 
```

然后根据需要处理异常。他们应该有一个特定的 SQLException 处理程序。这个很重要。

我通常远离输出参数，因为我认为这些与正在传输的数据有关，而不是任何错误消息，此外我可以检查 SQL Server 错误代码的异常，因此我们需要的所有数据都应该在该异常中。

此外，在 SQL Server 的某些情况下，我们有可能引发“业务类型异常”的存储过程。在这些情况下，我们添加一个自定义错误编号（50000 以上）并在需要时在存储过程中引发该错误。一般来说，我们尽量将这些保持在最低限度，因为它增加了复杂性，但在某些情况下，我们发现它们是必要的。

现在，由于客户端正在捕获 SQLException，因此他们可以查看 SQL Server 在异常中返回的错误代码，然后在捕获到异常并且错误号为某个值时采取任何特殊操作（如果需要）。如果自定义错误 (>50000) 需要，这允许基于错误代码的二级错误处理。

这也允许 DBA 提出自定义错误并让客户端代码有一致的方式来处理它们。然后，DBA 必须告诉客户端代码猴子自定义错误是什么，以便他们为它们做好准备。

我通常不将返回码用于错误处理目的，虽然我可以看到它们是如何使用的，但这意味着代码猴子层中有更多的逻辑来查看和处理返回码。如果它们是一个问题，我想要一个例外，因为这样我就可以始终如一地处理它们。如果我还必须查看返回码，那么现在有多种错误处理途径。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T20:02:54.767

我通常使用输出参数 - 并定义可能的值。

0 = 成功
正整数（假设在插入时）= 新行 ID（@@identity）

负整数 = 已知可能的错误条件
-1 = 缺少@LastName（或零长度）
-2 = 缺少@FirstName（或零长度）
...等等...

定义起来有点乏味 - 但它可以扩展 - 它是一种将有意义的结果返回给客户的方法，并且数据访问层可以将失败的确切原因传递回业务对象层（我使用枚举在业务对象层中用于不同的状态条件）。

如果需要，数据访问层也可以抛出异常 - 但我相信从性能角度来看，当您可以检查枚举或整数值时，最好不要抛出错误。

还有其他技术——这只是我过去使用过的一种，取得了一定的成功。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-17T20:06:08.237

这是我的建议：

当一切正常时返回 0 当
发生逻辑错误、丢失或无效数据
时返回负 x 当发生致命错误、插入失败等时返回正 x。

将输出参数 ErrorMsg 和 ErrorLog 添加到存储过程中。ErrorMessage 将包含人类可读的消息，ErrorLog 将包含调试信息。
如果返回 0，这些将是 NULL
您可以使用 ErrorLog 记录任何问题，确保如果要将它们插入到表中，则在回滚后执行。

使用 TRY - Catch 捕获问题，构建您自己的消息，并使用上述约定返回信息。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-17T20:19:53.883

在我目前的工作中，我们为特殊情况保留例外*情况*。对于诸如错误参数之类的事情，我们有标准的返回码——例如，无效的参数值总是返回 98。（为什么是 98？那已经被历史遗忘了……）

这不一定是理想的 b/c 客户端和 SP 都必须了解特定返回代码的含义；这是一个糟糕的关注点分离。

在特殊情况下，我们使用 OUT 参数返回消息，并且我们的批处理服务使用标准化的#scratch 表设置。

在之前的雇主中，我们出于相同目的使用了自定义 SQL 错误。所以，使用有意义的东西。就个人而言，我更喜欢单一机制，但这可能取决于您的环境。

也许你们都应该聚在一起为客户端代码开发标准化的方法来处理它。Excel 中使用的 VBA 具有 C# 和 Java 代码所没有的明显限制，并且尽管 Java 和 C# 彼此相似，但它们并不相同。 **如果您要坚持返回异常**，那么如果您可以就 a) 指示“错误”异常的已知消息 # 范围和 b) 标准化消息布局以便进行标准化解析达成一致，那么开发人员将是 90%完毕。

# javascript - Ecma-262 (EcmaScript 5) 将如何帮助您？

> ID：761905
> 
> 赞同：8
> 
> 时间：2009-04-17T19:43:39.883
> 
> 标签：javascript, ecma262, ecmascript-5

EcmaScript 第五版或[Ecma-262](http://www.ecma-international.org/publications/files/drafts/tc39-2009-025.pdf)已发布，其中包含对语言的一些更改。新版本中的哪些功能将帮助您编写更好的代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T21:00:30.307

15.12 节中的 JSON 对象看起来很棒。这会有所帮助，因为现在必须依赖不安全的 eval() 或一些缓慢的纯 JavaScript 实现，您必须将其包含在其余脚本中。没有原生支持，但这个新版本会有它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T21:47:31.503

ES3.1 所做的很多事情实际上是定义了已经存在的行为——比如`for (... in ...) ...`语句中的枚举顺序。所以在某种程度上这些东西不会直接帮助你（除非出现一个新的 js 引擎）。

它还定义了一些新功能，例如

```
* prototype access -- i think through `getPrototype()` or something -- alas this isn't as powerful as `__proto__` present in JavaScriptCore and SpiderMonkey

* The JSON object to provide fast and safe JSON parsing rather than the conflagration of existing techniques 
```

[编辑：回应抱怨 IE 的人——我相信 IE8 已经支持上述功能]

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T20:47:37.420

“严格”模式在介绍中听起来很有希望，但快速浏览附件 C（第 223 页）让我想知道它会有多大用处。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-04-17T19:45:42.497

可悲的是，绝对没有，因为 IE 将不支持任何超过五年左右的新标准。

# c# - 为什么控件会两次填充回发数据 - 在 LoadPostBack 期间和在

> ID：761911
> 
> 赞同：1
> 
> 时间：2009-04-17T19:45:22.903
> 
> 标签：c#, .net, asp.net, postback, viewstate

*控件在LoadPostBack 数据阶段*期间填充回发数据。*如果在OnInit*阶段未创建动态控件并将其添加到控件树，但稍后，则控件不会填充回发数据，如以下代码所示，其中*Label1*将显示一个空字符串：

```
public partial class _Default : System.Web.UI.Page
{
    TextBox textB;
    protected void Page_Load(object sender, EventArgs e)
    {
        textB = new TextBox();
        textB.ID = "dynamicTextC";
        Panel1.Controls.Add(textB);
        Label1.Text = textB.Text; // displays an empty string
    } 
```

但是如果我把*Label1.Text = textB.Text;* 在订阅了 textB 的*TextChanged 事件*的事件处理程序中，*Label1*将显示用户输入到*textB*中的文本。现在这表明控件两次填充相同的回发数据 - 在*LoadPostBack 数据阶段*和在*Raise Postback Events 阶段*。那么为什么控件需要用相同的回发数据填充两次呢？

顺便说一句 - 我意识到在引发*回发事件阶段*控制将回发值与前一页加载的回发值进行比较，然后决定是否需要引发事件

```
 TextBox textB;
    protected void Page_Load(object sender, EventArgs e)
    {
        textB = new TextBox();
        textB.ID = "dynamicTextC";
        Panel1.Controls.Add(textB);

        textB.TextChanged += textB_TextChanged;         
    }

    protected void textB_TextChanged(object sender, EventArgs e)
    {
        Label1.Text = textB.Text; // Label1 displays value user
                                     entered into textB
    } 
```

谢谢

编辑：

> 该控件将被创建并成为视图状态的一部分（因为它是一个服务器端控件。因此，它不需要在回发时再次创建）

这不是发生的事情，至少在我的情况下 TextBox 在回发时消失了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T21:10:36.913

我认为您应该将此代码置于检查之下

```
if (!IsPostBack)
{
 textB = new TextBox();
 textB.ID = "dynamicTextC";
 Panel1.Controls.Add(textB)
}
```

编辑：控件将被创建并将成为视图状态的一部分（因为它是服务器端控件。因此，它不需要在回发时再次创建）

尝试查看它在第一次和下一次加载页面时生成的 HTML 标记，以了解“dynamicTextC”的标记文本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-19T07:10:24.870

您是否有特定原因不想在 Page_Init 中创建动态控件？这段代码似乎工作：

```
 protected void Page_Init(object sender, EventArgs e) {
    textB = new TextBox();
    textB.ID = "dynamicTextC";
    Panel1.Controls.Add(textB);
  }

  protected void Page_Load(object sender, EventArgs e) {
    Label1.Text = textB.Text;
  } 
```

# c++ - 处理具有长初始化列表和多个构造函数的类？

> ID：761917
> 
> 赞同：13
> 
> 时间：2009-04-17T19:48:01.057
> 
> 标签：c++, constructor, initialization

我有一个（对我来说）复杂对象，它有大约 20 个数据成员，其中许多是指向其他类的指针。所以对于构造函数，我有一个又长又复杂的初始化列表。该类还具有十几个不同的构造函数，反映了可以创建该类的各种方式。这些初始化项目中的大多数在这些不同的构造函数之间都没有变化。

我在这里担心的是，我现在有大量复制（或大部分复制）的代码，如果我需要向类添加新成员，可能无法将其放入每个构造函数初始化列表中。

```
class Object 
{
    Object();
    Object(const string &Name);
    Object (const string &Name, const string &path);
    Object (const string &Name, const bool loadMetadata);
    Object (const string &Name, const string &path, const bool loadMetadata);
} 

Object::Object() :
    name(),
    parent_index (0),
    rowData (new MemoryRow()),
    objectFile (),
    rows (new MemoryColumn (object_constants::RowName, OBJECTID, object_constants::ROWS_OID)),
    cols (new MemoryColumn (object_constants::ColName, OBJECTID, object_constants::COLS_OID)),
    objectName (new MemoryColumn(object_constants::ObjName, STRING, object_constants::short_name_len, object_constants::OBJECTNAME_OID)),
    parent     (new MemoryColumn(object_constants::ParentName, STRING, object_constants::long_name_len, object_constants::PARENT_OID)),
    parentIndex (new MemoryColumn(object_constants::ParentIndex, OBJECTID, object_constants::PARENTINDEX_OID)),
    childCount (new MemoryColumn (object_constants::ChildCount, INTEGER, object_constants::CHILD_COUNT_OID)),
    childList (new MemoryColumn (object_constants::ChildList, STRING, object_constants::long_name_len, object_constants::CHILD_OID)),
    columnNames (new MemoryColumn (object_constants::ColumnNames, STRING, object_constats::short_name_len, object_constants::COLUMN_NAME)),
    columnTypes (new MemoryColumn (object_constants::ColumnTypes, INTEGER, object_constants::COLUMN_TYPE)),
    columnSizes (new MemoryColumn (object_constants::ColumnSizes, INTEGER, object_constants::COLUMN_SIZE))
{} 
```

然后对其他构造函数重复上述操作。有没有为此使用默认构造函数的聪明方法，然后修改其他构造函数的结果？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-18T13:35:28.387

如何将公共字段重构为基类。基类的默认构造函数将处理大量默认字段的初始化。看起来像这样：

```
class BaseClass {
    public:
    BaseClass();
};

class Object : public BaseClass
{
    Object();
    Object(const string &Name);
    Object (const string &Name, const string &path);
    Object (const string &Name, const bool loadMetadata);
    Object (const string &Name, const string &path, const bool loadMetadata);
};

BaseClass::BaseClass() :
    parent_index (0),
    rowData (new MemoryRow()),
    objectFile (),
    rows (new MemoryColumn (object_constants::RowName, OBJECTID, object_constants::ROWS_OID)),
    cols (new MemoryColumn (object_constants::ColName, OBJECTID, object_constants::COLS_OID)),
    objectName (new MemoryColumn(object_constants::ObjName, STRING, object_constants::short_name_len, object_constants::OBJECTNAME_OID)),
    parent     (new MemoryColumn(object_constants::ParentName, STRING, object_constants::long_name_len, object_constants::PARENT_OID)),
    parentIndex (new MemoryColumn(object_constants::ParentIndex, OBJECTID, object_constants::PARENTINDEX_OID)),
    childCount (new MemoryColumn (object_constants::ChildCount, INTEGER, object_constants::CHILD_COUNT_OID)),
    childList (new MemoryColumn (object_constants::ChildList, STRING, object_constants::long_name_len, object_constants::CHILD_OID)),
    columnNames (new MemoryColumn (object_constants::ColumnNames, STRING, object_constats::short_name_len, object_constants::COLUMN_NAME)),
    columnTypes (new MemoryColumn (object_constants::ColumnTypes, INTEGER, object_constants::COLUMN_TYPE)),
    columnSizes (new MemoryColumn (object_constants::ColumnSizes, INTEGER, object_constants::COLUMN_SIZE))
{} 
```

现在，您的 Object 构造函数应该看起来更易于管理：

```
Object::Object() : BaseClass() {}
Object::Object (const string &Name): BaseClass(), name(Name) {}
Object::Object (const string &Name, const string &path): BaseClass(), name(Name), path_(path){}
Object::Object (const string &Name, const bool loadMetadata): BaseClass(), name(Name){}
Object::Object (const string &Name, const string &path, const bool loadMetadata): BaseClass(), path_(path) {} 
```

本质上与 Iraimbilanja 的答案相似，但避免添加用于访问数据的内部类，这可能会影响许多现有代码。但是，如果您已经有了类层次结构，则可能很难将其分解为基类。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-07-10T14:38:00.473

现在几年后我们有了 C++ 11。如果你可以在你的项目中使用它，你有两个选择：

当公共初始化值仅在运行时已知时，您可以使用委托构造函数，这意味着一个构造函数调用另一个构造函数。

```
 // function that gives us the init value at runtime.
 int getInitValue();

 class Foo
 {
     const int constant;
     int userSet;

 public:
     // initialize long member list with runtime values
     Foo() 
       : constant(getInitValue())
       , userSet(getInitValue())
     {}

     // other constructors with arguments
     Foo( int userSetArg) 
       : Foo()
       , userSet(userSetArg) 
     {
     }
 }; 
```

或者，如果成员的值在编译时已知，则可以直接在类定义中初始化成员。

```
class Foo
{
    const int constant = 0;
    int userSet = 0;

public:
    Foo( int userSetArg) : userSet(userSetArg){}
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-17T19:57:40.050

是的，这是可能的。
为简单起见，我假设原始代码是：

```
class Foo {
public:
    Foo() : a(0), b(1), x() { }
    Foo(int x) : a(0), b(1), x(x) { }

    int get_a() const { return a; }
    int get_b() const { return b; }
    int get_x() const { return x; }
private:
    int a, b, x;
}; 
```

那么，重构后的代码是：

```
class Foo {
public:
    Foo() : x() { }
    Foo(int x) : x(x) { }

    int get_a() const { return common.a; }
    int get_b() const { return common.b; }
    int get_x() const { return x; }
private:
    struct Common {
        Common() : a(0), b(1) { }
        int a, b;
    } common;
    int x;
}; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-17T19:52:03.590

[Boost::Parameter](http://www.boost.org/doc/libs/1_38_0/libs/parameter/doc/html/index.html)可以轻松实现[Named Parameter Idiom](http://www.parashift.com/c++-faq-lite/ctors.html#faq-10.8)。在 SO 上查看此[线程。](https://stackoverflow.com/questions/203667/c-named-parameter-idiom-vs-boostparameter-library)这可能不是您所需要的，但在您要将呼叫转发到默认 ctor 时提供了一些灵活性。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-17T19:53:06.630

与构造函数无关，但为什么您认为必须使用 new 动态创建所有这些子对象？这不是一个好主意 - 您应该尽可能避免动态创建。不要让所有这些成员成为指针 - 让它们成为实际的对象。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-17T19:53:45.303

您可以在私有 init() 成员函数中共享他们的公共代码。

例子：

```
class Object
{
 public:
   Object(const string &Name);
   Object(const string &Name, const string &path);
   ...
 private:
   void init();
 };

 Object::Object(const string &Name)
 {
   init();
   ...
 }

 Object::Object(const string &Name, const string &path)
 {
   init();
   ...
 }

 void Object::init()
 {
//intialization stuff
   ...
 } 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-17T19:57:45.403

首先，如果你没有在析构函数中删除分配的对象，你就会有内存泄漏。所以你应该定义你的析构函数并删除那里的对象。

如果您确实需要动态分配成员（如果此类拥有数据成员对象，我不建议这样做），您可以使用私有方法进行所有初始化，并且可以从构造函数中调用该方法。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-17T20:15:01.243

```
Object (const string &Name = "", const string &path = "", const bool loadMetadata = false); 
```

这不会解决您的所有问题（特别是，没有办法用 Name 和 loadMetaData 表示构造函数），但它至少会将一些构造函数合并为一个。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-17T20:29:36.900

我会先说我（显然）不知道你的系统的细节，或者导致你的设计决策的约束。

话虽如此，一个好的经验法则是，当一个类开始变得笨拙时——大约在你开始询问如何处理它的时候:)——可能是时候将该类重构为几个较小的子类了。

请记住，一个类应该*很好地完成**一*件事。如果您开始拥有尝试做太多事情的大型类，那么您就偏离了良好的 OO 设计。

 ** * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-18T02:51:06.080

我将使用不同的工厂方法（静态方法）将智能指针返回给您的类。工厂方法名称还有助于记录为什么需要所有不同的参数。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-17T20:01:31.650

你真的需要 5 个不同的构造函数吗？

很多时候，如果您需要转换构造函数，您也不需要默认构造函数。

您的其他构造函数都采用相同事物的不同组合。最好只有一个构造函数接受所有参数，每个参数都有一个选项，表示希望为该参数调用某种默认值。

例如：

```
class Object
{
  Object (const string *Name, // can be NULL
    const string *path, // can be NULL 
    const bool loadMetadata);

}; 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-17T21:31:27.750

只需将初始化列表放入 MACRO 中即可。

# sql - 高分数据库中的SQL语句问题

> ID：761918
> 
> 赞同：0
> 
> 时间：2009-04-17T19:48:10.510
> 
> 标签：sql, ms-access

我在java中创建了一个字母游戏，我需要在其中包含一个高分功能。通过 JDBC 使用 Microsoft 访问数据库。数据库中的表包含以下内容

```
Table name Easy

fields
Name
Score 
Time 
```

需要一条 SQL 语句，按照最高分数和最低时间的顺序显示前 5 个分数。例如。如果有两名球员得分 20 分，则时间较短的球员应该在第一名，但如果有一名球员得分 21 分，则无论时间如何，他都应该在第一名。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-17T19:49:28.387

```
select top 5 
    name,
    score,
    time

from easy

order by score desc, time asc 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-17T20:06:11.090

该表名为`Easy`，这似乎表明它是为玩简单模式的玩家准备的。我建议添加一列来解决困难并且只拥有一张大`HighScores`桌子。

```
SELECT TOP 5 
  name, score, time
FROM HighScores
WHERE difficulty = 'Easy'
ORDER BY score desc, time asc 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T19:57:27.557

不是你问的，但你可能有兴趣知道不同数据库的答案是不同的。例如，在 Oracle 中，这将是

```
select
    name,
    score,
    time
from easy
where rownum <= 5
order by score desc, time asc 
```

在 PostgreSQL 中，它会是

```
select
    name,
    score,
    time
from easy
order by score desc, time asc
limit 5 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T19:50:50.473

```
Select top 5 Name
From Easy
order by score desc, time asc 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-17T19:51:02.500

```
SELECT TOP 5 Score, Time
FROM Easy
ORDER BY Score DESC, Time 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-17T19:55:56.967

其他人已经提出了`SELECT TOP 5...`解决方案，但是，这种语法是 Microsoft SQL Server 和 Sybase 支持的非标准 SQL。如果您使用其他品牌的数据库，它将无法正常工作。您应该编辑您的问题并指定您正在使用的数据库品牌和版本，因为根据该信息，答案可能会有所不同。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-04-17T19:57:24.590

```
select top5 Score, Time from Easy order byScore desc, Time 
```

# php - 您可以将 PHP 文件渲染为变量吗？

> ID：761922
> 
> 赞同：16
> 
> 时间：2009-04-17T19:50:24.920
> 
> 标签：php

如果我有一个这样的 hello.php 文件：

```
Hello, <?php echo $foo; ?>! 
```

我想在一些 php 代码中做这样的事情：

```
$text = renderPhpToString('hello.php', array('foo'=>'World')); 
```

最后得到

```
$text == 'Hello, World!' 
```

这对标准 PHP 5 可行吗？显然我想要更复杂的模板循环等等..

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-04-17T19:54:12.213

你可以使用这样的一些功能：

```
function renderPhpToString($file, $vars=null)
{
    if (is_array($vars) && !empty($vars)) {
        extract($vars);
    }
    ob_start();
    include $file;
    return ob_get_clean();
} 
```

它使用输出缓冲控制函数[`ob_start()`](http://docs.php.net/ob_start)来缓冲后面的输出，直到它被`ob_get_clean()`.

**编辑**    确保您验证传递给此函数的数据，以便`$vars`没有会覆盖传递的参数值的`file`元素。`$file`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-19T16:08:00.883

正如 Gumbo 所说，您必须检查 $file 变量，它是一个已经困扰我的微妙错误。我会使用 func_get_arg( i ) 并且根本没有变量，还有一件小事，我会使用 require。

```
function renderPhpToString( )
{
    if( is_array( func_get_arg(1) ) ) {
        extract( func_get_arg(1) );
    }
    ob_start();
    require func_get_arg( 0 );
    return ob_get_clean();

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-17T19:52:29.097

[http://www.devshed.com/c/a/PHP/Output-Buffering-With-PHP/](http://www.devshed.com/c/a/PHP/Output-Buffering-With-PHP/)

输出缓冲可能是开始的地方。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-20T06:36:59.327

关于传递`$vars = array('file' => '/etc/passwd');`，你可以使用`extract($vars, EXTR_SKIP);`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-17T19:56:23.173

您可以使用[output buffering](http://php.net/manual/en/function.ob-get-contents.php)来做到这一点，但使用许多模板引擎之一可能会更好。

# c# - 从 C# 中的 C++ 代码中获取对象功能

> ID：761930
> 
> 赞同：2
> 
> 时间：2009-04-17T19:51:53.123
> 
> 标签：c#, c++, interop, object

我有一个用 C++ 编写的函数，它调用旧库中的一些函数。该函数创建一些内存进行调用并销毁内存。为了优化这一点，我将创建一个对象，该对象将保持分配的内存，直到对象被销毁。但是我将从 C# 调用这个函数并且不相信我可以导出一个类，只是函数或变量。

我的想法是这样；将 DLL 视为一个类，并在 dll 范围内使用本地变量来指向内存。然后有一个函数来创建内存，调用工作函数和另一个在完成 DLL 后销毁内存。

这是一个好方法吗？有没有更好的办法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T20:09:35.013

我更喜欢在 C++/CLI（以前的 Managed C++）中编写托管包装器，因为它可以更轻松地在 C++ 端通过托管/非托管互操作性显式执行您想要的操作，并且您的 C# 不会被 P/ 污染调用样式代码。

**编辑**刚刚注意到您的评论“*但是我将从 C# 调用这个函数并且不相信我可以导出一个类，只是函数或变量。* ”

这并不完全正确 - C#**可以**从 C++/CLI 代码生成的程序集中导入完整的类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T20:52:11.840

如果您愿意更改本机 C++ 代码，您始终可以将其导出为 C# 可以使用的 COM 接口。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T20:01:33.537

创建一个实现 IDisposable 的 C# 类。您可以在您的 C++ 对象周围包装一个简单的 C API，因此当您构造一个实例时，它会返回一个指向 C++ 类的指针，而当您对您的 C# 类进行 Dispose() 时，它会删除该指针。

您始终可以取消引用此指针以调用 C++ 类上的方法。

另一个不错的选择是只使用 C++/CLI 为您的 C++ 类制作包装器。在那里处理这种情况要简单得多。

# c# - 我应该如何检测文本文件中使用了哪个分隔符？

> ID：761932
> 
> 赞同：24
> 
> 时间：2009-04-17T19:52:08.083
> 
> 标签：c#, asp.net, csv, text-parsing

我需要能够解析 CSV 和 TSV 文件。我不能依靠用户知道区别，所以我想避免要求用户选择类型。有没有一种简单的方法来检测正在使用哪个分隔符？

一种方法是阅读每一行并计算制表符和逗号，并找出在每一行中最常用的。当然，数据可能包括逗号或制表符，因此说起来容易做起来难。

**编辑：**这个项目的另一个有趣的方面是，当我读入文件时，我还需要检测文件的模式，因为它可能是其中之一。这意味着在解析之前我不会知道我有多少字段。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-17T21:40:48.617

在 Python 中，csv 模块中有一个 Sniffer 类，可用于猜测给定文件的分隔符和引号字符。它的策略是（引用自 csv.py 的文档字符串）：

* * *

[首先，查找] 包含在两个相同的引号（可能的引号字符）之间的文本，这两个引号前后都有相同的字符（可能的分隔符）。例如：

```
 ,'some text', 
```

赢得最多的报价，与分隔符相同。如果没有引号字符，则无法以这种方式确定分隔符。

在这种情况下，请尝试以下操作：

分隔符*应*在每一行上出现相同的次数。但是，由于数据格式不正确，它可能不会。我们不想要全有或全无的方法，所以我们允许这个数字有小的变化。

1.  建立每行每个字符的频率表。
2.  建立这个频率的频率表（元频率？），例如'x在10行中出现5次，在1000行中出现6次，在2行中出现7次'
3.  使用元频率的模式来确定该 字符的*预期频率*
4.  找出角色实际达到该目标的频率
5.  最符合其目标的字符是分隔符

出于性能原因，数据以块的形式进行评估，因此它可以尝试评估数据的最小部分，并根据需要评估额外的块。

* * *

我不会在这里引用源代码——它位于每个 Python 安装的 Lib 目录中。

请记住，CSV 也可以使用分号而不是逗号作为分隔符（例如，在德语版本的 Excel 中，CSV 是用分号分隔的，因为在德国使用逗号作为小数分隔符......）

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-04-17T19:56:36.917

您可以在预览窗口中向他们展示结果 - 类似于 Excel 的方式。在这种情况下使用错误的分隔符时非常清楚。然后，您可以允许他们选择一系列分隔符并实时更新预览。

然后，您可以简单地猜测以分隔符开头（例如，逗号或制表符是否在前）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-02-03T23:55:05.137

我遇到了类似的需求，并认为我会分享我的想法。我还没有通过它运行大量数据，因此可能存在边缘情况。另外，请记住，此函数的目标不是 100% 确定分隔符，而是呈现给用户的最佳猜测。

```
/// <summary>
/// Analyze the given lines of text and try to determine the correct delimiter used. If multiple
/// candidate delimiters are found, the highest frequency delimiter will be returned.
/// </summary>
/// <example>
/// string discoveredDelimiter = DetectDelimiter(dataLines, new char[] { '\t', '|', ',', ':', ';' });
/// </example>
/// <param name="lines">Lines to inspect</param>
/// <param name="delimiters">Delimiters to search for</param>
/// <returns>The most probable delimiter by usage, or null if none found.</returns>
public string DetectDelimiter(IEnumerable<string> lines, IEnumerable<char> delimiters) {
  Dictionary<char, int> delimFrequency = new Dictionary<char, int>();

  // Setup our frequency tracker for given delimiters
  delimiters.ToList().ForEach(curDelim => 
    delimFrequency.Add(curDelim, 0)
  );

  // Get a total sum of all occurrences of each delimiter in the given lines
  delimFrequency.ToList().ForEach(curDelim => 
    delimFrequency[curDelim.Key] = lines.Sum(line => line.Count(p => p == curDelim.Key))
  );

  // Find delimiters that have a frequency evenly divisible by the number of lines
  // (correct & consistent usage) and order them by largest frequency
  var possibleDelimiters = delimFrequency
                    .Where(f => f.Value > 0 && f.Value % lines.Count() == 0)
                    .OrderByDescending(f => f.Value)
                    .ToList();

  // If more than one possible delimiter found, return the most used one
  if (possibleDelimiters.Any()) {
    return possibleDelimiters.First().Key.ToString();
  }
  else {
    return null;
  }   

} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-17T19:56:05.437

你知道每行*应该有多少个字段吗？*如果是这样，我会阅读文件的前几行并据此进行检查。

根据我的经验，“正常”数据通常包含逗号，但很少包含制表符。这表明您应该检查前几行中的选项卡数量是否一致，并将该选择作为首选猜测。当然，这取决于您所拥有的数据。

最终，很有可能拥有一个对两种格式都完全有效的文件——所以你不能让它绝对万无一失。这必须是一项“尽力而为”的工作。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-08-23T22:00:47.403

它在 PHP 中，但这似乎很可靠：

```
$csv = 'something;something;something
someotherthing;someotherthing;someotherthing
';
$candidates = array(',', ';', "\t");
$csvlines = explode("\n", $csv);
foreach ($candidates as $candidatekey => $candidate) {
 $lastcnt = 0;
 foreach ($csvlines as $csvline) {
  if (strlen($csvline) <= 2) continue;
  $thiscnt = substr_count($csvline, $candidate);
  if (($thiscnt == 0) || ($thiscnt != $lastcnt) && ($lastcnt != 0)) {
   unset($candidates[$candidatekey]);
   break;
  }
  $lastcnt = $thiscnt;
 }
}
$delim = array_shift($candidates);
echo $delim; 
```

它的作用如下：对于每个指定的可能分隔符，它读取 CSV 中的每一行并检查每个分隔符出现的次数是否为常数。如果不是，则删除候选分隔符，最终您应该得到一个分隔符。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-17T19:58:21.610

我想您建议的解决方案将是最好的方法。在格式良好的 CSV 或 TSV 文件中，每行逗号或制表符的数量应该是恒定的（根本没有变化）。对文件的每一行进行计数，并检查哪一个对于所有行都是恒定的。每行的两个分隔符的计数似乎不太可能相同，但在这种不可思议的罕见情况下，您当然可以提示用户。

如果制表符和逗号的数量都不是恒定的，则向用户显示一条消息，告诉他们该文件格式错误，但程序认为它是一个（任何格式的每行分隔符的标准偏差最低的）文件。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-17T20:02:44.423

只需阅读几行，计算逗号的数量和制表符的数量并进行比较。如果有 20 个逗号且没有制表符，则为 CSV。如果有 20 个制表符和 2 个逗号（可能在数据中），则它在 TSV 中。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-17T19:58:01.470

没有“有效”的方法。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-17T19:58:34.853

假设每行有固定数量的字段，并且值中的任何逗号或制表符都用引号 (") 括起来，您应该能够计算出每行中每个字符的频率。如果字段不是t 已修复，这更难，如果不使用引号将其他分隔字符括起来，我怀疑这几乎是不可能的（并且取决于数据，特定于语言环境）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-17T19:59:11.983

根据我的经验，数据很少包含制表符，因此一行制表符分隔的字段（通常）会相当明显。

不过，逗号更难——尤其是当您在非美国语言环境中读取数据时。如果您正在阅读在国外生成的文件，数字数据可能包含大量逗号，因为浮点数通常会包含它们。

最后，唯一安全的做法通常是尝试，然后将其呈现给用户并允许他们进行调整，尤其是当您的数据包含逗号和/或制表符时。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-17T20:01:36.530

我会假设在普通文本中，制表符非常罕见，除了作为一行中的第一个字符——想想缩进的段落或源代码。我认为，如果您发现嵌入的制表符（即不遵循逗号的制表符），您可以假设这些制表符被用作分隔符并且大部分时间都是正确的。这只是一种预感，没有经过任何研究证实。我当然会为用户提供覆盖自动计算模式的选项。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-04-17T21:09:26.883

假设您有一组标准的列，您会期望...

我会使用 FileHelper（SourceForge 上的开源项目）。 [http://filehelpers.sourceforge.net/](http://filehelpers.sourceforge.net/)

定义两种阅读器模板，一种用于昏迷，一种用于制表符。

如果第一个失败，请尝试第二个。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-08-15T12:14:07.587

您可以检查一行是否使用一个分隔符或另一个，如下所示：

```
while ((line = readFile.ReadLine()) != null)
{
    if (line.Split('\t').Length > line.Split(',').Length) // tab delimited or comma delimited?
        row = line.Split('\t');
    else
        row = line.Split(',');

    parsedData.Add(row);
} 
```

# c# - C#数据库交互介绍

> ID：761933
> 
> 赞同：10
> 
> 时间：2009-04-17T19:52:17.147
> 
> 标签：c#, sql, linq-to-sql, ado.net

到目前为止，在我的编程生涯（两年）中，我没有太多的数据库经验，但是我现在工作的公司在他们的产品中广泛使用数据库，我觉得落后了。

所以我想知道如何最好地开始学习与 C# 的数据库交互。我读过 LINQ-to-SQL 和 ADO.net。这些是值得研究的正确技术吗？

我从哪说起呢？

编辑：感谢所有回复。有很多好的——我很难选择一个作为“答案”。这对我帮助很大！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-17T19:53:43.180

我建议您花时间学习**Microsoft SQL Server**本身、企业**库中的****数据访问应用程序块**和**ADO.NET 实体框架**。

 ****学习 SQL Server 的入口点在这里 -> **[SQL Server 开发人员中心](http://msdn.microsoft.com/en-us/sqlserver/default.aspx)**
学习 ADO.NET 的入口点在这里 ->在 MSDN**[学习 ADO.NET](http://msdn.microsoft.com/en-us/data/aa937699.aspx)**

首先，为了更好地了解 ADO.NET 是什么，请查看以下链接：

*   维基百科上的[ADO.NET](http://en.wikipedia.org/wiki/ADO.NET)
*   维基百科上的[ADO.NET 实体框架](http://en.wikipedia.org/wiki/ADO.NET_Entity_Framework)

了解如何在不使用任何框架和 ORM 工具的情况下使用 C# 编写对 SQL Server 的直接查询，然后继续学习 ADO.NET 系列中的更高级技术。

**另见**：

*   MSDN 上的[数据访问应用程序块](http://msdn.microsoft.com/en-us/library/cc309504.aspx)
*   MSDN 上[的 ADO.NET 实体框架概述](http://msdn.microsoft.com/en-us/library/aa697427.aspx)
*   [学习 ADO.NET Entity Framework](http://msdn.microsoft.com/en-us/data/aa937723.aspx)（“我如何”视频等）
*   ASP.NET 上的[视频、截屏视频和教程](http://www.asp.net/learn/)
*   [Microsoft SQL Server 2008：ADO.NET 实体框架](http://www.microsoft.com/sqlserver/2008/en/us/ado-net-entity.aspx)

您可能还想下载**[LINQPad](http://www.linqpad.net/)**，这是玩 LINQ 的完美工具。

我还建议订阅 ADO.NET 相关的**RSS 提要**：

*   MSDN 上的[ADO.NET 团队博客](http://blogs.msdn.com/adonet/)

[还可以在CodePlex.com](http://www.codeplex.com)上查看使用这些技术的现有开源项目并深入研究它们的源代码。

**适合您的有关该主题的**好书：****

 ***   [Microsoft SQL Server 2008 T-SQL 基础](https://rads.stackoverflow.com/amzn/click/com/0735626014)，Itzik Ben-gan（2008 年 10 月）
*   [Julia Lerman 编写的实体框架编程](https://rads.stackoverflow.com/amzn/click/com/059652028X)（2009 年 2 月）
*   [Murach 的 ADO.NET 3.5、LINQ 和](https://rads.stackoverflow.com/amzn/click/com/1890774529)Anne Boehm 的实体框架（2009 年 3 月）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-17T19:55:02.477

**更新**：这个答案过去没有的一件事是指向 SQL 和数据库新手信息的链接，所以我也会在此处放置一些相关链接，以便您（或其他任何人）可以了解他们的 SQL 和其他数据库设计技能。

*   [W3 Schools SQL 教程](http://www.w3schools.com/sql/default.asp)
*   [数据库设计教程](http://www.tekstenuitleg.net/en/articles/database_design_tutorial/1)

其中很多内容来自我今天写的另一个答案，但它详细介绍了您的确切问题：

**原答案**：

这听起来您或多或少需要基本介绍如何从 C# 连接和操作数据库。上面的海报说要研究 LINQ to SQL，但您也可以研究更基本的 ADO.NET 底层框架，这将使您了解它的基本工作原理。

[此外，您可以在此处](http://www.codebeach.com/index.asp?tabID=2&categoryID=15&subcategoryID=3)使用此站点获取许多不同的 C# 数据库教程。

**编辑**：来自[C# Station](http://www.csharp-station.com/Tutorials/AdoDotNet/Lesson01.aspx)、[CodeProject](http://www.codeproject.com/KB/database/DatabaseAcessWithAdoNet1.aspx)和[Codersource的更多信息](http://www.codersource.net/csharp_adonet_tutorial_ed.html)

**编辑 2**：如果您对上面提到的 Linq to SQL 之类的东西感兴趣，这里有一些来自[C# Corner](http://www.c-sharpcorner.com/UploadFile/scottlysle/L2SinCS06022008035847AM/L2SinCS.aspx)和[C-Sharp Online 的教程](http://en.csharp-online.net/Introducing_LINQ%E2%80%94Using_LINQ_to_SQL)

**编辑 3**：其他人也会建议诸如 ADO.NET 实体框架之类的东西。对于仍然需要掌握使用数据库的基础知识的初学者，我不一定建议这样做。这是来自[MSDN 概述的一些信息](http://msdn.microsoft.com/en-us/library/aa697427(VS.80).aspx)

**简单示例**（这是直接从上面给出的 C# Station 链接中提取的）

> 清单 1\. 使用 SqlConnection

```
using System;
using System.Data;
using System.Data.SqlClient;

/// <summary>
/// Demonstrates how to work with SqlConnection objects
/// </summary>
class SqlConnectionDemo
{
    static void Main()
    {
        // 1\. Instantiate the connection
        SqlConnection conn = new SqlConnection(
            "Data Source=(local);Initial Catalog=Northwind;
             Integrated Security=SSPI");

        SqlDataReader rdr = null;

        try
        {
            // 2\. Open the connection
            conn.Open();

            // 3\. Pass the connection to a command object
            SqlCommand cmd = 
                new SqlCommand("select * from Customers", conn);

            //
            // 4\. Use the connection
            //

            // get query results
            rdr = cmd.ExecuteReader();

            // print the CustomerID of each record
            while (rdr.Read())
            {
                Console.WriteLine(rdr[0]);
            }
        }
        finally
        {
            // close the reader
            if (rdr != null)
            {
                rdr.Close();
            }

            // 5\. Close the connection
            if (conn != null)
            {
                conn.Close();
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-17T20:29:22.033

是的，您已经确定了正确的技术。

我有一些很棒的免费 pdf/电子书供您查看：

**网络**

[http://www.murach.com/books/adon/chapters.htm（vb](http://www.murach.com/books/adon/chapters.htm)和 ado.net

[http://www.springerlink.com/content/w2126101r8qr2052/（ado.net](http://www.springerlink.com/content/w2126101r8qr2052/)基础与 c#）

[http://archive.visualstudiomagazine.com/books/chapters/1590595122.pdf](http://archive.visualstudiomagazine.com/books/chapters/1590595122.pdf) (vb & c#)

[http://dotnet.jku.at/courses/tutorial/05.ADO.NET.pdf](http://dotnet.jku.at/courses/tutorial/05.ADO.NET.pdf)（伟大的概述幻灯片）

[http://docs.msdnaa.net/ark_new3.0/cd3/content/Courses%5CVargas%5CCh12.pdf（ado.net](http://docs.msdnaa.net/ark_new3.0/cd3/content/Courses%5CVargas%5CCh12.pdf)书）

[http://media.wiley.com/product_data/excerpt/38/07821418/0782141838-1.pdf](http://media.wiley.com/product_data/excerpt/38/07821418/0782141838-1.pdf)（不错）

**LINQ-TO-SQL** Scott Gu 的 Linq to Sql 可能是一个好的开始所需要的一切：

[http://it-box.blogturk.net/wp-content/themes/it-box/files/LINQToSql.pdf](http://it-box.blogturk.net/wp-content/themes/it-box/files/LINQToSql.pdf)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-17T19:56:02.753

就个人而言，我认为了解这些“框架”是做什么的很好。我将从一些基本查询开始尝试了解 SQL 的工作原理。一旦你开始使用它，你可能最终不会使用那么多，但我一直发现如果我能理解它为我做的事情，我会更容易理解为什么我需要一个框架。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-17T20:05:04.137

在考虑使用 LINQ 之前，请先学习数据库基础知识和 t-sql。如果您不了解连接的工作原理以及数据库的结构，您将无法使用任何工具进行有效查询。

以下是一些帮助链接： [http ://www.tek-tips.com/faqs.cfm?fid=4785](http://www.tek-tips.com/faqs.cfm?fid=4785) [http://www.deeptraining.com/litwin/dbdesign/FundamentalsOfRelationalDatabaseDesign.aspx](http://www.deeptraining.com/litwin/dbdesign/FundamentalsOfRelationalDatabaseDesign.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-17T19:56:51.893

首先拿起[Ben Forta](http://www.forta.com/books/)的任何 sql 书籍。一旦你掌握了基本的基础知识，你就可以继续理解库、块和其他框架。对数据库有一个很好的理解将对你的职业生涯有很大帮助。

# unit-testing - Resharper 单元测试运行器：MSTest 部署项目问题

> ID：761946
> 
> 赞同：14
> 
> 时间：2009-04-17T19:55:54.017
> 
> 标签：unit-testing, resharper, mstest

[ReSharper 单元测试运行程序：支持部署项](https://stackoverflow.com/questions/747263/resharper-unit-test-runner-support-for-deployment-items)

对于上述问题，我有一个后续问题。我正在使用带有本机 mstest 支持的 resharper 4.5 版来运行 mstest 单元测试。当我将 resharper 的单元测试选项配置为使用我的 testrunco​​nfig（以利用我的部署项集）时，我的测试运行结束，没有显示任何结果或错误。有没有人使用 resharper 的 mstest 跑步者有同样的问题或类似的事情？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-27T18:16:11.667

事实证明，resharper 的 mstest 运行器不适用于启用了代码覆盖的 testrunco​​nfig 文件。我通过在我的测试运行配置文件中禁用代码覆盖来解决这个问题。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-04-27T11:56:38.670

我也遇到了这个问题。但是，我不想禁用代码覆盖，因为我经常使用它。构建服务器也使用它。所以我想要一个解决方案，让我大部分时间都使用 R# 的运行器以方便起见，但仍然允许我使用 Visual Studio 的 MSTest 运行器运行我的测试，以便在我想要的任何时候获得代码覆盖率，并允许构建服务器继续生成代码覆盖率统计信息。

## 解决方法

我创建了一个名为 Resharper.testsettings 的附加测试设置文件。它与我的普通 Local.testsettings 文件完全相同，只是它禁用了代码覆盖率。然后我告诉 R# 使用这个特定的测试运行配置。

1.  打开你的 Visual Studio 项目
2.  选择**测试->编辑测试设置->本地**（local.testsettings）（或您通常使用的任何测试设置）
3.  点击**“另存为...** ”
4.  将文件命名为 ReSharper.testsettings
5.  在Test Settings 窗口的**General选项卡的****Name**字段中，将名称更改为 ReSharper
***   单击**数据和诊断***   **取消选中代码覆盖率**旁边的框***   转到**ReSharper-> 工具-> 单元测试***   选择**MSTest**单元测试提供程序*   选择**“使用此测试运行配置：”***   选择**ReSharper***   点击**确定******

 ****如果在第 8 步中使用 R# 5.0，则会有一个额外的菜单深度：

1.  转到**Resharper-> 选项-> 工具-> 单元测试**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-20T07:09:57.000

您不需要 resharper 来支持独立的 mstest 安装。我在这里的帖子中解释了如何在没有 VS 的情况下进行独立的 mstest 安装 - [http://www.shunra.com/shunrablog/index.php/2009/04/running-mstest-without-visual-studio](http://www.shunra.com/shunrablog/index.php/2009/04/running-mstest-without-visual-studio)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-31T18:59:55.497

有类似的问题。我的 MSTest 测试使用 Visual Studio 测试运行程序而不是 R# 的运行程序运行。抛出的异常直接归因于 R# 测试运行没有找到必须部署的文件（并且在 testrunco​​nfig 中指定）。

尝试让它选择配置的文件并指定文件。没有骰子。

不知道如何在 testrunco​​nfig 文件中“禁用代码覆盖”，而不是不指定任何内容（我没有）。

问过R#。现在询问 StackOverflow 的观众。

# sql-server - 将 Access 数据表迁移到 SQL Server 2005

> ID：761955
> 
> 赞同：0
> 
> 时间：2009-04-17T19:57:13.967
> 
> 标签：sql-server, ms-access, datetime, types

我使用标准的导入/导出工具将表引入我的 SQL 数据库。日期都以 CHAR 类型出现。现在，我不断收到一个转换错误，指出 CHAR 到 datetime 导致超出范围的情况。请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-18T05:02:43.657

以及来自 marc_s 的解决方案，检查超出范围的值。

*   MS Access 日期范围从[100 年 1 月 1 日到 9999 年 12 月 31 日](http://support.microsoft.com/kb/210276)
*   SQL Server 日期时间是[1753 年 1 月 1 日到 9999 年 12 月 31 日](http://msdn.microsoft.com/en-us/library/ms187819(SQL.90).aspx)

这可以解释为什么它升迁为 char 而不是 datetime ...您的日期可能 < 1753

这仅适用于 SQL Server 2005 及之前版本，[SQL Server 2008 有 datetime2](http://msdn.microsoft.com/en-us/library/bb677335.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-18T05:08:10.867

建议使用[SQL Server 迁移助手](http://www.microsoft.com/sqlserver/2008/en/us/migration.aspx)(SSMA) 而不是 MS Access 中内置的升迁向导。绝对不那么痛苦。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T20:24:30.220

SQL Server 中 CHAR(x) 类型的字段将用空格填充到它们的固定长度，例如，如果您有 CHAR(20) 并且其中有类似“2009-04-20”的日期，则该字段将真正包含“ 2009-04-20"，这可能会在转换为日期时间时引起麻烦。

此外，如果您的 CHAR 字段完全为空，它也可能无法转换为有效的日期时间。

解决方案：

a）您可以将列的数据类型更改为 VARCHAR(x) ，从而摆脱最可能不必要的填充：

```
ALTER TABLE YourTable
  ALTER COLUMN YourColumnName VARCHAR(x) 
```

b）您可以确保检查空 CHAR(x) 字段值并且不转换这些值（或为这些值选择默认日期时间值）

c）您可以修剪 CHAR(x) 字段以删除不必要的填充：

```
CONVERT(LTRIM(RTRIM(YourFieldName)), ......) 
```

# asp.net-mvc - 使用 Asp.Net MVC 进行自动事务的最佳方法是什么？

> ID：761958
> 
> 赞同：3
> 
> 时间：2009-04-17T19:57:32.437
> 
> 标签：asp.net-mvc, transactions, aop

我对在我的 MVC 应用程序中到处编写以下代码感到恼火。

```
using(var tx = new TransactionScope()){
   blah...
   tx.Complete()
} 
```

我想以某种方式制作这款 DRYer。

我为此想到了几种不同的选择。

1.  一个动作过滤器，以声明方式将某些动作标记为事务性的。
2.  重写 Controller 基类中的 OnActionExecuting 并一次性使所有操作都具有事务性。

这些都是一个好主意吗？有什么我应该注意的问题吗？第二个选项似乎可能是获得大量死锁的好方法。

哦，是的，我还使用 StructureMap 和自定义控制器工厂将 deps 注入到我的控制器中，以防有人知道以这种方式注入事务的一些技巧。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T21:59:43.673

您可以使用[工作单元模式](http://www.martinfowler.com/eaaCatalog/unitOfWork.html)来进行事务管理。工作单元模式的主要好处是您可以将事务策略保存在一个地方，或者当您有多个策略时，可以将其保存在几个地方。最简单的工作单元接口可能是：

```
public interface IUnitOfWork
{
    void Start();
    void Commit();
    void RollBack();
} 
```

您可以为不同的 ORM 或存储过程或硬编码的 sql 创建各种 UnitOfWork 实现。您可以在请求开始时启动事务。事务可以在请求结束时处理。在处理之前，您可以将提交包装在 try-catch 块中，并在 catch 中回滚。

```
try
{
    unitOfWork.Commit();
} 
catch
{
     unitOfWork.RollBack();
     throw;
} 
```

事务启动策略有：

*   每个请求：一个事务用于整个请求，这是大多数情况下的最佳方式。
*   每个请求多次：每个方法一个事务。
*   每个对话：您可以围绕购物车结账过程的多个请求创建交易。

您可以通过以下方式管理您的交易：

*   属性
*   global.asax 中的 application_begin 和 endrequest 方法
*   http模块

使用 StructureMap 时，您可以在工作单元配置中使用 Hybrid 缓存作为 InstanceScope。您可以使用 StructureMap 将工作单元注入到存储库中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-17T20:35:03.987

在我目前正在开发的一个应用程序中，我的存储库`ISession`从一个`ISessionProvider`注入到构造函数中的 NHibernate 中获取。会话提供者是 an `AspNetMvcSessionProvider`，它将创建一个`ISession`并在第一次`ISessionProvider.OpenSession()`调用时开始一个事务，将 存储`ISession`在当前的 Web 请求中。

在`OnActionExecuted`我手动拉出`ISessionProvider`我的容器并调用`Commit`或调用`RollBack`它，具体取决于是否引发了异常 - 当然，如果 Web 请求中当前没有存储会话，则什么也不做。

这已被证明是有用的，而且我认为它表现得非常好——大多数时候，应用程序只是*读取*数据，不会阻塞其他读取事务。我还没有经历过数据库死锁。

# nhibernate - Hibernate 不再是一个独立的产品

> ID：761963
> 
> 赞同：0
> 
> 时间：2009-04-17T19:57:59.643
> 
> 标签：nhibernate, jboss

Hibernate.org 发生了什么？我被重定向到 jboss.org，然后在该站点上一次我找不到它。这是否意味着hibernate不再是一个独立的项目——它现在是jboss的一个组件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T19:59:35.757

它一直是 JBoss 的一部分。他们是创建 Hibernate 的人。

现在，如果您正在寻找[NHIBERNATE](http://www.nhibernate.org)，那是完全不同的产品和 URL。

[这](http://en.wikipedia.org/wiki/NHibernate)是 WIKI 条目，[这里](http://sourceforge.net/projects/nhibernate)是 sourceforge 下载站点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T20:13:37.500

[http://www.jboss.com/products/hibernate/](http://www.jboss.com/products/hibernate/)

在产品菜单上，它是“JBoss Hibernate”。

但你是对的 - 文档的旧链接已损坏，例如 [http://www.hibernate.org/hib_docs/v3/api/org/hibernate/context/ThreadLocalSessionContext.html](http://www.hibernate.org/hib_docs/v3/api/org/hibernate/context/ThreadLocalSessionContext.html)

带你到一个通用的 jboss.org 顶级页面。希望他们能修复它。

[https://sourceforge.net/projects/hibernate](https://sourceforge.net/projects/hibernate)也可以。

# ldap - 如何为我的 Web 应用程序构建 LDAP 集成？

> ID：761966
> 
> 赞同：40
> 
> 时间：2009-04-17T19:58:26.790
> 
> 标签：ldap, single-sign-on, saas

我的公司开发和销售拥有数百名客户的 SaaS 应用程序。我们的一些客户要求我们支持 LDAP 集成，以便针对他们现有的系统验证用户帐户，而不必为他们的每个员工创建另一个登录帐户。似乎这在许多地方被称为单点登录 (SSO)？自然，我们的系统已经有一种机制来维护用户帐户资料并从我们的登录页面验证这些用户帐户。

我们对 LDAP 有点无知，并且对一些事情感到困惑。请原谅可能使用了错误的术语（请记住，我们对此有点无知）。

我们认为我们了解这可能如何工作的基础知识：

*   我们的客户将他们的帐户配置为为其帐户“打开”“远程身份验证”功能。他们提供将对其用户进行身份验证的远程 URL。
*   用户来到我们的登录页面并尝试使用他们公司的 LDAP 系统提供的用户名和密码登录。
*   我们的登录页面将安全地将登录凭据（可能以某种约定的格式加密和散列）转发到我们客户提供的“远程身份验证”URL。
*   客户的脚本将对用户进行身份验证，然后使用“身份验证状态”将他们重定向回我们的站点。
*   我们的页面将分析“身份验证状态”并接受用户是否已登录。

假设上述信息甚至是半正确的，我们仍然需要每个用户在我们的系统中都有一个帐户。难道我们不需要某种方式来将我们的用户帐户配置文件与 LDAP 目录中的用户配置文件同步吗？这仅仅是一个引用 LDAP 系统中用户 ID 的“外部 ID”吗？那么是否需要客户的“远程身份验证”脚本必须向我们的系统提供该 ID，以便我们知道系统中的哪个用户帐户与登录相关联？

我们缺少什么？

顺便说一句，我们的平台是 IIS、ASP.Net 2.0 和 SQL Server 2005。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-08-29T15:04:55.273

有几种选择。如果您真的指的是 LDAP，而不仅仅是 Active Directory，我可能会考虑使用 System.DirectoryServices.Protocols 通过安全通道使用提供的凭据执行 LDAP 绑定。

严格来说，这不是单点登录。SSO 意味着您只需在首次登录时提交一次您的凭据。这只是通过只有一个 ID 来降低用户的复杂性。通常，对于混合平台和技术的企业环境中的 Windows 客户端，SSO 是通过添加到桌面的客户端来实现的，该客户端管理对各种系统的身份验证。在纯 MS 环境中，如果您的所有 Web 应用程序都在 IIS 上，您可能会实现 SSO，您使用 IE 并使用集成 Windows 身份验证、模拟和所有这些东西。

您可以考虑将经过身份验证的用户自动注册到您的系统中，除非您需要预先配置配置文件类型的数据。如果您确实需要预先配置用户，您可以考虑定期从 LDAP 目录导入（所有或过滤的子集）用户，并将它们置于未配置状态，以便管理员从现有的未配置列表中选择- 配置用户而不是输入 ID。否则，您的管理员可能会输入错误的用户 ID 并出现不匹配的情况。

您可以提供一个 API，以便身份和访问管理解决方案（鉴于您的 Microsoft 倾向，请参阅 ILM2 007 作为一个示例）可以与您的系统集成并为您执行所有用户帐户管理。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-19T01:47:37.923

一如既往地记得验证身份验证测试以确保发送的密码不为空。

根据标准，具有用户名且没有密码的绑定被视为匿名绑定，并且看起来已经成功！事实上，它真的没有。

这是应用程序要处理的问题，因为 LDAP 服务器只是遵循标准，这是一个令人讨厌的标准，但仍然是一个标准。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-15T14:51:23.030

也许考虑身份验证与授权

身份验证 - 这是哪个用户？授权 - 谁应该能够使用应用程序、指定的用户、组？

目前，您通过身份验证暗示授权，因为只有那些注册到您的应用程序的人才能使用它。

如果您使用目录而不是自定义数据存储，那么

*   使用目录连接方式对用户进行认证
*   您（可能）免费获得身份验证 - windows 知道用户，windows 可以识别 iis 和 sqlserver，也许不需要问用户他们是谁。
*   您将知道更多的用户，而不是拥有授权并需要应用限制 - 限制与特定组的连接。
*   可以将用户数据存储在目录中，而不是与您的应用程序数据一起存储在 sql server 中。

如果您的用户真的想要通用 LDAP，那么您需要查看 (C) `ldap_connect, ldap_bind_s`(C#)`LDAPConnection System.DirectoryServices.Protocols`

或者再次回到 AD 这个[Demystified .Net App 单点登录](http://channel9.msdn.com/posts/donovanf/Demystified-Series-WinForms-App-Single-Sign-On-in-2-Lines-of-Code/)可能会有所帮助

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T20:33:40.010

您需要确定计划如何将 LDAP 用户链接到应用程序中的帐户。

例如，您可以要求 LDAP 系统中的用户名与您的应用程序中的用户名匹配，或者您可以要求某人在您的应用程序的每个用户帐户中明确指定 LDAP 用户名。

一旦你找到了那个链接，你就可以简单地执行一个 LDAP 绑定来测试用户凭据。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-09-15T15:09:55.923

这在我们的系统中的工作方式：

*   当用户导航到 Web 应用程序时，REMOTE_USER 服务器变量被假定为用户令牌
*   登录代码使用特定于搜索的帐户连接到 ldap 目录
*   登录代码查找“匹配”REMOTE_USER 的 ldap 帐户
*   然后登录代码尝试将该帐户与我们系统中的帐户进行匹配
*   如果一直可以匹配，假设用户登录为匹配账号，正常继续

这样，用户可以在我们的应用程序中重用他们的 Windows 域身份验证。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-08-24T11:11:25.050

这是一个有用的软件，它允许使用 JSON-RPC 通过 Web 访问 LDAP 目录：[Json2Ldap](https://connect2id.com/products/json2ldap)

# c - 在 Objective-C 中检查对象的大小

> ID：761969
> 
> 赞同：35
> 
> 时间：2009-04-17T19:58:56.850
> 
> 标签：c, objective-c, sizeof

我试图找到一个objective-c对象的大小。我正在使用类似于：

```
 NSLog(@"sizeof myObject: %ld", sizeof(*myObject)); 
```

这只是给了我指针的大小。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-04-17T20:17:56.803

编译器只知道指针，这就是为什么您要返回指针的大小。要查看分配对象的大小，请使用以下代码片段之一：

### 使用 ARC：

```
#import <malloc/malloc.h>

// ...

NSLog(@"Size of %@: %zd", NSStringFromClass([myObject class]), malloc_size((__bridge const void *) myObject)); 
```

### 没有 ARC：

```
#import <malloc/malloc.h>

// ...

NSLog(@"size of myObject: %zd", malloc_size(myObject)); 
```

Mike Ash 在他的问答博客上写了一篇关于 Obj-C 运行时内部的文​​章：[http ://mikeash.com/?page=pyblog/friday-qa-2009-03-13-intro-to-the -objective-c-runtime.html](http://mikeash.com/?page=pyblog/friday-qa-2009-03-13-intro-to-the-objective-c-runtime.html)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-04-18T05:45:29.060

在 GNU Objective-C 运行时中，您可以使用（必须导入`<objc/objc-api.h>`：

```
class_get_instance_size ([MyClass class]); 
```

在 Mac OS X 上，您可以使用（您可能需要 import `<objc/runtime.h>`）：

```
class_getInstanceSize ([MyClass class]); 
```

这些函数将返回分配对象需要多少内存，它不包括对象在初始化时分配的内存。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2010-09-16T20:00:48.457

首先，我认为从上面的帖子中可以清楚地看出，*对象*大小由 malloc_size(myObject) 给出，正如 Jason 和 Mac OS 参考手册所建议的那样：

“malloc_size( *ptr ) 函数返回支持**ptr*指向的分配 的内存块的大小。内存块大小始终至少与其支持的分配一样大，并且可能更大。” （[http://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man3/malloc_size.3.html](http://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man3/malloc_size.3.html)）

但是如果您有兴趣找出字典的大小，请记住以下几点：

字典存储键值对并且在值部分中**不**包含对象本身，而只是增加要“添加”的对象的保留计数，并保持对该对象的引用。现在，字典本身只包含对各种对象的引用（带有一个键）。因此，如果您有机会查找字典引用的所有对象的对象大小，从技术上讲，这不会是字典的大小。字典的大小将是所有键的大小加上所有对键的值引用的大小加上父 NSObject 的大小的总和。如果您仍然对找出引用对象的大小感兴趣，请尝试遍历字典值数组：

```
NSArray *myArray = [myDictionary allValues];
id obj = nil;
int totalSize = 0;
for(obj in myArray)
{
    totalSize += malloc_size(obj);
}
//totalSize now contains the total object size of the refered objects in the dictionary. 
```

希望能回答这个问题。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-04-17T21:58:01.680

（objective-c）对象的大小不容易找到，因为它甚至不容易定义。“objective-c 对象的大小”是什么意思？

引用的大小是指针的大小（由 sizeof(obj_ref) 返回）。

创建时分配的内存大小（+alloc）可以通过 Jason 在第一个答案中给出的方式找到。但这取决于运行时。gnu-runtime 与 apple-runtime 不同。最终，这只是实例所包含的原始数据类型所需的内存。但**不是**稍后可能为 ivars 或字符串引用的对象分配的内存（即在初始化 (-init) 期间）。

类的一个实例

```
@interface FirstClass
{
    int _someInt;
    char _someChar;
}
…
@end 
```

如果运行时需要，至少需要 5 个字节（在许多系统上 -`int`大小可能会有所不同）加上静态开销。这样一个物体的大小是显而易见的。

但是对于类的一个实例

```
@interface SecondClass
{
    FirstClass *_someObject;
    char *_name;
    id _data;
}
…
@end 
```

“大小”的定义很复杂。该对象需要 12 个字节（在 32 位系统上）加上分配开销。但也许名称是对象的一部分并由它分配/释放。实际名称所需的内存是否应该是对象大小的一部分？那么引用的对象呢？

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-01-28T18:00:21.330

我建议使用`class_getInstanceSize`并`malloc_good_size`查看它的结果。这不会显示返回大小内的 ivars 和其他内容。

```
#import <malloc/malloc.h>
#import <objc/runtime.h>

NSLog(@"Object Size: %zd", malloc_good_size(class_getInstanceSize([yourObject class]))); 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-04-17T20:17:43.373

我认为类描述包含大小信息——查找它比使用`sizeof`运算符查询要好。

# sql-server - SSRS 2005：将列显示从项目列值/一行更改为其他内容？

> ID：761970
> 
> 赞同：1
> 
> 时间：2009-04-17T19:59:00.517
> 
> 标签：sql-server, sql-server-2005, reporting-services, csv, reportingservices-2005

我有一个表/数据集，例如：

```
1/1/2009 | Training 1 | Mike
1/1/2009 | Training 1 | Bill
1/1/2009 | Training 1 | Steve 
```

我想显示为

```
1/1/2009 | Training 1 
Mike, Bill, Steve 
```

这个想法是，打印的页面空间不会浪费在大部分页面上打印一列，而是将空间缩短为水平列表或该字段内的列式结果。什么是最好的方法？

我想处理这个是报表设计器，而不是处理 SQL 结果。我看到了几种接近但不准确的方法。我在 SSRS 2005 上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-17T20:04:41.127

不使用 SQL 生成 CSV，然后尝试使用矩阵控件将行更改为日期/培训上的列和组......但您之间不会有逗号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T20:54:12.330

（我随意标记你的三列`Date`，，`Session`和`Participant`，和你的表`MyTable`）

我认为您无法仅在报表设计器中执行此操作。我认为最好的方法是编写一个标量值函数，它将 a`datetime`和 a `varchar`（或两个`varchar`s）作为两个输入并产生一个`varchar`输出。该函数看起来像这样：

```
Declare @Names varchar(MAX), @Participant varchar(MAX)
Set @Names = ''
Declare NameCursor Insensitive cursor For 
    SELECT Participant FROM MyTable WHERE Date = @Date AND Session = @Session
Open NameCursor
Fetch Next From NameCursor Into @Participant
While @@FETCH_STATUS=0
Begin
    Select @Names = @Names + ', ' + @Participant
    Fetch Next From NameCursor Into @Participant
End
Close NameCursor
Deallocate NameCursor
Return SUBSTRING(@Names, 3, LEN(@Names)) 
```

然后，当您从`MyTable`中选择时，请使用

```
SELECT Date, Session, dbo.MyFunction(Date, Session) As Participants GROUP BY Date, Session 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-10T16:46:30.367

我编写了以下查询以使用公用表表达式构建基本数据集，然后使用分组/连接操作来获得我认为您正在寻找的结果：

```
 WITH temp AS (
    SELECT CAST('1/1/2009' AS DATETIME) AS Date, 'Training 1' AS Session, 'Mike' AS Participant
    UNION ALL
    SELECT CAST('1/1/2009' AS DATETIME) AS Date, 'Training 1' AS Session, 'Bill' AS Participant
    UNION ALL
    SELECT CAST('1/1/2009' AS DATETIME) AS Date, 'Training 1' AS Session, 'Steve' AS Participant
    UNION ALL
    SELECT CAST('1/2/2009' AS DATETIME) AS Date, 'Training 2' AS Session, 'Steve' AS Participant
    UNION ALL
    SELECT CAST('1/2/2009' AS DATETIME) AS Date, 'Training 2' AS Session, 'Bill' AS Participant
    UNION ALL
    SELECT CAST('1/3/2009' AS DATETIME) AS Date, 'Training 3' AS Session, 'Mike' AS Participant
)
SELECT DISTINCT
    Date,
    Session,
    (
        SELECT STUFF(
            (
                SELECT
                    ',' + CAST(Participant AS NVARCHAR(50)) + '' AS [text()]
                FROM
                    temp b
                WHERE
                    b.Date = a.Date AND
                    b.Session = a.Session
                FOR  
                    XML PATH('')
            ),
            1,
            1,
            ''
        )
    ) AS Participants
FROM
    temp a 
```

这将输出以下内容：

```
Date    Session Participants
2009-01-01 00:00:00.000 Training 1  Mike,Bill,Steve
2009-01-02 00:00:00.000 Training 2  Steve,Bill
2009-01-03 00:00:00.000 Training 3  Mike 
```

您可以在 SSRS 中随意格式化这些结果。由于 DISTINCT 子句，无法保证这将在非常大的数据集上快速运行，但是您在大型数据集上执行的任何分组操作无论如何都会很慢。当涉及到连接时，使用这样的 FOR XML 子句绝对是规则。

希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-10T19:47:47.147

在 SSRS 中进行聚合连接的常用方法是使用自定义代码。请参阅此处的示例：

[http://blogs.msdn.com/suryaj/archive/2007/08/11/string-aggregation.aspx](http://blogs.msdn.com/suryaj/archive/2007/08/11/string-aggregation.aspx)

这是基本形式的自定义代码：

```
Private CurrGroupBy As String = String.Empty
Private ConcatVal As String = String.Empty
Public Function AggConcat(GroupBy as String, ElementVal as String) as String
    If CurrGroupBy = GroupBy Then
        ConcatVal = ConcatVal & ", " & ElementVal 
    Else
        CurrGroupBy = GroupBy 
        ConcatVal = ElementVal 
    End If
    Return ConcatVal 
End Function 
```

然后在您要显示的分组级别：

```
=RunningValue(
     Code.AggConcat(
         Fields!YourFieldToGroupBy.Value
       , Fields!YourFieldToConcat.Value
       )
   , Last
   , "YourGroupName" 
   ) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-29T17:11:35.370

我最终在 t-sql 的选择部分中使用了 SQL stuff/xml 语句，并连接回了整个选择的数据。像这样的东西：[http ://www.kodyaz.com/articles/concatenate-using-xml-path.aspx](http://www.kodyaz.com/articles/concatenate-using-xml-path.aspx)

# python - 在 python 中发送标题

> ID：761978
> 
> 赞同：7
> 
> 时间：2009-04-17T20:00:45.770
> 
> 标签：python, post, http-headers

我有以下 python 脚本，我想发送“假”头信息，这样我的应用程序就好像它是 firefox 一样。我怎么能那样做？

```
import urllib, urllib2, cookielib

username = '****'

password = '****' 

login_user = urllib.urlencode({'password' : password, 'username' : username})

jar = cookielib.FileCookieJar("cookies")

opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(jar))

response = opener.open("http://www.***.com")

response = opener.open("http://www.***.com/login.php")

response = opener.open("http://www.***.com/welcome.php", login_user) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-17T20:07:30.713

在您的对象 上使用该`addheaders()`功能。只需在创建开瓶器后添加这一行，然后再开始打开页面：`opener`

```
opener.addheaders = [('User-agent', 'Mozilla/5.0')] 
```

[http://docs.python.org/library/urllib2.html](http://docs.python.org/library/urllib2.html)（在本文档的底部）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-17T20:06:10.483

你必须获得更多的低级才能做到这一点。

```
request = urllib2.Request('http://stackoverflow.com')
request.add_header('User-Agent', 'FIREFOX LOL')
opener = urllib2.build_opener()
data = opener.open(request).read()
print data 
```

未测试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-17T21:04:39.983

FWIW，取决于您想模仿 Firefox 的精确程度，设置 User-Agent 可能还不够（尽管对于大多数情况来说这可能就足够了）。为了使您的脚本看起来像“正常”的网页浏览，您可能需要设置一个适当的引用者并对页面的其余内容（Javascript/CSS/Images/Flash/etc）发出额外的请求。一些事情，虽然可能不适合你的特定情况。

# multithreading - 如何在多线程游戏引擎中保持我的世界数据同步？

> ID：761990
> 
> 赞同：5
> 
> 时间：2009-04-17T20:03:18.867
> 
> 标签：multithreading, synchronization

所以我正在尝试为我想要编写的游戏创建一个简单的多线程游戏引擎。到目前为止，一切都没有任何问题，我什至知道我必须采取哪些步骤才能完成它。

只有一件事我不知道（好吧，从技术上讲，我知道一个解决方案，但我希望有更优雅和更快的东西）：基本上，我的引擎的每个部分都有一个单独的线程 -图形、输入、物理、音频等

物理线程有一个完整的世界场景节点结构，它模拟一切。但是，我现在必须以尽可能少的开销将这个结构转移到我的图形线程中。理想情况下，它应该只传输自上次更新以来发生变化的部分。

我有用于传输这些数据的组件，唯一的问题是生成它。

到目前为止，我已经想到了两种不同的方法：

*   为每次更新复制整个结构 - 非常简单，但可能会占用大量时间和内存（我没有使用大型引擎的经验 - 这可行吗？）
*   通过用一些标志标记场景节点来跟踪场景的哪些部分发生了变化，然后只复制变化的部分

方法一会复制大量内存，但没有太多的处理能力，方法二会做相反的事情：大量的处理能力，复制的内存更少。

是否有一些一般性的答案，在典型的游戏环境中哪种方法会更快？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-17T20:19:16.503

不，没有公认的普遍答案，这是游戏开发的当前研究领域。

我的 2 美分是传统观念 - 使用哪一个实际上取决于您的具体用例 - 如果您的游戏有大量数据（即它非常占用内存，就像大多数大片标题一样），您可能只想传输更改。如果您的游戏不是内存密集型游戏（例如街机游戏），您可能可以通过复制整个对象而侥幸成功。

我建议同时实现并连接性能计时器，看看哪个更适合你；可以实现一种可以透明地处理这两种方法的架构。

# .net - 如何写入 MQMessage：多个写入调用或 StringBuilder？

> ID：761991
> 
> 赞同：2
> 
> 时间：2009-04-17T20:03:23.033
> 
> 标签：.net, queue, ibm-mq

我是 WebSphere MQ 的新手。我正在使用 IBM 的 .NET 类 (IBM.WMQ) 来放置请求消息，然后获取响应消息。MQMessage 对象有许多用于各种数据类型的 Writexxx 方法。我需要将各种不同的数据元素写入请求消息。我的问题是，我应该为每个单独的数据元素调用适当的 Write 方法，还是应该使用 StringBuilder 构建整个事物，然后调用一次 MQMessage WriteString 方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T06:51:27.777

编写 API 是为了帮助您编写更清晰的代码，但是将 WMQ API 转换为 .Net 的人是个白痴。

他们编写了 20 种不同的 API，而不是带有重载的“写入”函数。write 调用有一些可用的重载。

他们创建了一个枚举，它有 100 个（如果不是数千个）选项，称为 MQC（MQ 常量）。玩得开心，但要注意 WMQ 上的事务，因为使用该功能会产生少量成本。

既然我已经完成了我的咆哮，请注意大多数 api 在大小方面对有符号 int 有限制的 API，只有 write(byte[] array) 和 writestring(string s) 函数采用大消息。此外，.net api 根据 .net 的实现写入所有字符串 UTF-16，这可能会影响您。

# air - 您可以解压缩 Adob e AIR 应用程序吗？

> ID：761995
> 
> 赞同：3
> 
> 时间：2009-04-17T20:05:22.357
> 
> 标签：air

我想知道是否/如何解压缩 Adob​​e AIR 应用程序，以便查看它是如何实现的。我是否需要 SDK 来解压它，还是像 .gadget 文件这样重命名的 .zip 文件？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-17T20:06:38.343

据我所知，它只是一个拉链。*****************