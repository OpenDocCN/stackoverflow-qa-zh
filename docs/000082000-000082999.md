# StackOverflow 问答 000082000-000082999

# sql - 为什么 DB2 不允许我在 WHERE 子句中有一个列？

> ID：82003
> 
> 赞同：1
> 
> 时间：2008-09-17T11:00:14.090
> 
> 标签：sql, database, db2

我有一个通过 ODBC 访问的远程 DB2 数据库。当我有类似的查询时

```
SELECT t.foo, t.bar, t.problemcolumn
FROM problemtable t
WHERE t.bar < 60; 
```

它就像一个魅力，所以表和列显然存在。

但是如果我在 WHERE 子句中指定问题列

```
SELECT t.foo, t.bar, t.problemcolumn
FROM problemtable t
WHERE t.problemcolumn = 'x'
AND t.bar < 60; 
```

它给了我一个错误

```
Table "problemtable" does not exist. 
```

这可能是什么原因？我已经仔细检查了拼写，我可以通过在 where 子句中包含问题列来触发问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T11:11:07.090

很抱歉答案很明显，但问题是否存在？由于表/列名称，您的代码看起来像伪代码，但请务必仔细检查您的拼写。这不是一个视图，它甚至可能包含跨不同数据库/服务器的连接表？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T11:31:23.487

您使用的实际 SQL 是什么？我认为您提出的示例没有任何问题。尝试查找可能触发错误的错位逗号和/或引号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-18T15:16:06.153

请运行下一条 SQL 语句。对我来说，它工作正常。如果您仍然有这个奇怪的错误，那将是一个 DB2 错误。我曾经在将代码从 UNIX 编辑器复制到 Windows 时遇到了一些问题，反之亦然。SQL 不会运行，虽然它看起来没问题。重新输入语句解决了我的问题。

创建表问题表（ foo varchar(10)、bar int、problemcolumn varchar(10) ）；

SELECT t.foo, t.bar, t.problemcolumn FROM problemtable t WHERE t.bar < 60;

从问题表 t 中选择 t.foo、t.bar、t.problemcolumn，其中 t.problemcolumn = 'x' AND t.bar < 60;

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-02T16:32:50.667

It think it should be work in DB2. What is your font-ent software?

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T11:49:39.900

它是否仅适用于：

```
SELECT t.foo, t.bar, t.problemcolumn
FROM problemtable t
WHERE t.problemcolumn = 'x' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-10T04:22:20.193

DB2 有时会给出误导性错误。您可以尝试以下故障排除步骤：

1.  尝试通过 DBArtisan 或 DB2 Control Center 执行代码，看看是否得到正确的结果/错误消息。
2.  尝试使用 schema_name.problemtable 而不仅仅是 problemtable
3.  确保问题列的数据类型与您要与之比较的数据类型相同。

# xml - 非 unicode XML 表示

> ID：82008
> 
> 赞同：2
> 
> 时间：2008-09-17T11:01:25.040
> 
> 标签：xml, string, unicode, character

我有 xml，其中一些元素值是 unicode 字符。是否可以用 ANSI 编码来表示？

例如

```
<?xml version="1.0" encoding="utf-8"?>
<xml>
<value>受&lt;/value>
</xml> 
```

到

```
<?xml version="1.0" encoding="Windows-1252"?>
<xml>
<value>&#27544;</value>
</xml> 
```

我反序列化 XML，然后尝试使用 XmlTextWriter 指定默认编码（默认为 Windows-1252）对其进行序列化。所有的 unicode 字符都以问号结尾。我正在使用 VS 2008，C# 3.5

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-17T12:11:33.420

好的，我使用以下代码对其进行了测试：

```
 string xml = "<?xml version=\"1.0\" encoding=\"utf-8\"?><xml><value>受&lt;/value></xml>";

 XmlWriterSettings settings = new XmlWriterSettings { Encoding = Encoding.Default };
 MemoryStream ms = new MemoryStream();
 using (XmlWriter writer = XmlTextWriter.Create(ms, settings))
      XElement.Parse(xml).WriteTo(writer);

 string value = Encoding.Default.GetString(ms.ToArray()); 
```

它正确地转义了 unicode 字符，因此：

```
<?xml version="1.0" encoding="Windows-1252"?><xml><value>&#x53D7;</value></xml> 
```

我一定在其他地方做错了什么。谢谢您的帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-17T11:03:25.410

如果我理解这个问题，那么是的。你只需要一个`;`之后`27544`：

```
<?xml version="1.0" encoding="Windows-1252"?>
<xml>
<value>&#27544;</value>
</xml> 
```

或者您想知道如何以编程方式生成此 XML？如果是这样，您在哪种语言/环境中工作？

# .net - .NET 语言真的对消费者桌面应用程序产生了影响吗？

> ID：82022
> 
> 赞同：8
> 
> 时间：2008-09-17T11:03:56.157
> 
> 标签：.net, desktop, native

**您*是否*使用 .NET 语言编写消费者桌面应用程序？**如果是什么类型？

我的印象是，大多数消费者桌面应用程序仍然是 C、C++ 等的本地编译应用程序。

虽然 .NET 语言越来越受欢迎，但这些新类型的应用程序是否曾经突破企业和 Web 领域成为高街消费应用程序？

例如现在看看你的桌面？有多少应用程序是用 .NET 语言、Firefox 编写的？微软办公软件？雷鸟？iTunes？微软视觉工作室？

我的公司开发高端 CAD/CAE 应用程序，我们利用新技术，但我们的核心开发仍然使用 C++ 完成。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-17T11:34:52.103

我构建并维护了一个用 .NET 编写的大型桌面应用程序（现在是 1.1、2.0）。该应用程序适用于牙医，它利用 TabletPC SDK 的 MIcrosoft.Ink 命名空间中的 Ink 技术工作。一些牙医使用平板电脑使事情变得更容易，并利用该技术的力量。

另一方面，由于我发现 Windows UI 不好看（XP/Vista）并且发现每个应用程序看起来都相同且不一致，所以我编写了自己的 GDI+ 控件库，同时或多或少地尊重“Windows UI 指南”，我想出了非常漂亮的按钮和其他 UI 元素，使我的应用程序看起来比任何其他“普通”Windows 应用程序“更好”。

我们全屏运行（最大混合，无控件，无应用栏），但我们这样做是因为它是*专用*于任务的机器中使用的非常*特定*的应用程序。牙科诊所不会在我们的应用程序中使用 Microsoft Excel 和 ALT-TAB。该应用程序像“ATM”一样工作，触摸触摸，完成。非常简单。它在我所在的欧洲取得了成功。

 *所以我不得不说，我很高兴该应用程序**不是**Web 应用程序，因为当我们开始时，用于 Windows 窗体的 .NET GDI+ 比 WEB 所能提供的任何东西都要好得多；即使在今天，Ajax 也无法重现完整的桌面体验（不是应该，而是……）。

那时 Java 有一个丑陋的 UI（现在不知道），所以我们选择了 .NET 并从那时起使用 C#。

桌面应用程序不会很快消亡，有些东西仍然无法在网络浏览器中重现。

在六年前开始使用它之前，我考虑过 Java、C++、Delphi 等。没有一个提供 c#.NET 的简单性和强大功能而几乎没有缺点（比如当时没有人拥有的框架）。现在，每个 Windows 盒子*肯定*都有 .NET Framework 2.0。

同样，我的消费者应用程序非常具体并且针对封闭市场，但我们没有任何*反对*.NET 的东西。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-17T11:14:40.017

如前所述，我知道 Tomboy、Beagle，此外还有 F-Spot。所有这些都是大多数 linux 发行版的一部分。Paint.NET 是另一个应用程序。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-17T11:09:54.990

也许您看到这一点是因为许多流行的桌面应用程序的代码库早于 2001 年？

编辑：我可能应该说早于 2003 年或 2004 年......我怀疑任何人都会在 .NET 版本的第一年或第二年开始一个主要的桌面应用程序。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-04T09:24:32.657

Intuit 的 TurboTax 2007 和 2008 都是用 .NET 编写的。与我在对另一个答案的评论中抱怨的利基市场视频编辑工具的演示不同，它实际上完全干净地安装在家里我稍微老化的 XP 盒子上，没有发生任何事故（包括它的自我更新技巧）。

今年的用户界面与往年有很大不同，而且大部分情况都更好。由于向 .NET 的过渡似乎是在去年发生的，根本没有对 UI 进行太多更改，因此不能将新 UI 归咎于（或归功于）向 .NET 的切换。

我只是一个用户，不知道是什么促使他们的开发团队转换。

我确实认为这是我在野外发现的第一个明显基于 .NET 的零售软件包。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-17T11:06:54.370

真可惜。阻止使用 .net 进行桌面开发的唯一原因是桌面机器上需要 .net 框架，但恕我直言，对于能够在 .net 环境中工作时获得的好处，这是一个很小的代价。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-17T11:14:18.240

只要您不需要 über 性能，我看不出有任何理由不使用 .NET。使用新的超小型可再发行组件，您可以包含一个占用几百 KB 的 .net 安装程序。

我想说的是，如果您已经拥有精通该语言的开发人员，或者有特定的技术要求使其成为必要，或者客户的机器是被锁定，无法使用 .net 平台。

虽然我还不是工作人员的一员（即我是一名学生），但我可以用 C# 编写所有我能摆脱的东西。我尝试过的其他任何事情都无法接近这种语言所提供的效率和清洁度（并且它提供了 Visuall Studio 的所有生产力功能）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-17T11:50:40.787

我注意到在[Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)中，越来越多的桌面应用程序以黄色突出显示（意味着它们是 .Net）。如上所述，ATI 的 Catalyst 是 Windows Live Mesh，许多游戏都有 .Net 更新或配置引擎，以及我编写的大部分尚未完全进入公共领域的位（因为我没有尽可能多的时间用于编码和测试）。此外，Visual Studio 的大部分都是 .NET - 至少根据 Process Explorer。

我认为，正如上面提到的那样，已经有很多桌面应用程序具有较旧的代码库，除非这样做有一些奇妙的价值，否则它们的所有者不会转换这些代码库。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-07T23:40:24.137

Visual Studio（至少 2008 年）是用 .NET 编写的

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-17T11:12:27.790

嗯，有一些应用程序，如 [Tomboy](http://www.gnome.org/projects/tomboy/)和[Beagle](http://beagle-project.org/Main_Page)，它们作为一些 Linux 发行版的一部分提供，所以我不确定它们是否算作高街消费者应用程序。想一想，我真的不知道用 .NET 语言编写的任何其他“非企业”应用程序。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-17T11:16:25.097

不是传统的桌面应用程序，而是 ATI Catalyst Control Center 基于 .NET。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-17T11:26:12.407

实际上，我在我的桌面上发现了一些需要 .Net 的应用程序。

最著名的是 Paint.Net，但其中还有“催化剂控制中心”，它与我的 ATI 显卡一起提供。

当然，我们公司正在编写我们自己的桌面 .Net 应用程序。我们的目标受众是商业用户。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-17T11:46:36.290

可能不会有很多传统意义上的winforms应用程序正在编写，但是两个windows live messenger的下一个版本都将在windows presnetation基础中编写，我认为这就是趋势。

Windows Media Center 是用 C# 编写的，令人印象深刻，但话虽如此，它也不是您传统的 winforms 应用程序。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-17T11:47:17.440

TechSmith 的 Jing 是 .NET，实际上是 WPF，所以它是 3.5，最前沿的 .NET。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-17T11:57:42.410

在我工作的地方，几乎所有在这里编写的客户端程序都使用 .NET；这是一个非常棒的商业应用平台。话虽如此，大多数 .NET 将成为一个很好的目标的程序都被部署为 Web 应用程序。其余的通常是图形和 cpu 密集型应用程序，出于性能原因，它们通常在 c++ 中实现。出于同样的原因，您也不会看到太多用 java 编写的桌面应用程序。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-17T12:16:20.057

你们中的大多数人指的是开源。我同意，有些项目使用 .NET（例如，我使用的是 RSSBandit），但它们并不重要（大部分情况下）。但是企业应用程序呢？最近我写了一个类似于 MS Surface 的应用程序，它是用于广告目的。在此之前，我必须编写一个应用程序来维护仓库。有些不同？在 WinForms 时代，我编写了一个应用程序来支持类似 ebay 的页面。你还需要吗？

就我个人而言，我认为 .NET 在商业中被广泛使用（你每天都看不到）并且它没有被开源使用（为什么？我不知道，也许贡献者讨厌 MS？）。但是，我也认为它将向 .NET 转变，尤其是在 Windows 平台的下一个版本中。而且，我差点忘记了——安装 .NET 框架不是问题，说真的，用户没那么愚蠢和懒惰！

确实，桌面正在失去对 Web 环境的魔力，但它永远不会消亡；）

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-10-13T10:55:32.853

Microsoft InfoPath - Microsoft Office 的一部分也是用 .NET 编写的

# xml - 根据 Oracle PL/SQL 中的模式验证 XML 文件

> ID：82047
> 
> 赞同：6
> 
> 时间：2008-09-17T11:08:05.133
> 
> 标签：xml, oracle, ora-06512

我需要针对 XSD 验证传入文件。两者都将在服务器文件系统上。

我看过`dbms_xmlschema`，但在让它工作时遇到了问题。

使用一些 Java 会更容易吗？
我可以在数据库中放入的最简单的类是什么？

这是一个简单的例子：

```
DECLARE
  v_schema_url       VARCHAR2(200) := 'http://www.example.com/schema.xsd';
  v_blob             bLOB;
  v_clob             CLOB;
  v_xml XMLTYPE;
BEGIN
  begin
    dbms_xmlschema.deleteschema(v_schema_url);
  exception
    when others then
     null;
  end;

  dbms_xmlschema.registerSchema(schemaURL => v_schema_url,
                                schemaDoc => '
<xs:schema targetNamespace="http://www.example.com" 
xmlns:ns="http://www.example.com" 
xmlns:xs="http://www.w3.org/2001/XMLSchema" 
elementFormDefault="qualified" attributeFormDefault="unqualified" version="3.0">
<xs:element name="something"  type="xs:string"/>
</xs:schema>',
                                local => TRUE);

  v_xml := XMLTYPE.createxml('<something xmlns="http://www.xx.com" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.example.com/schema.xsd">
data
</something>');

  IF v_xml.isschemavalid(v_schema_url) = 1 THEN
    dbms_output.put_line('valid');
  ELSE
    dbms_output.put_line('not valid');
  END IF;
END; 
```

这会产生以下错误：

```
ORA-01031: insufficient privileges
ORA-06512: at "XDB.DBMS_XDBZ0", line 275
ORA-06512: at "XDB.DBMS_XDBZ", line 7
ORA-06512: at line 1
ORA-06512: at "XDB.DBMS_XMLSCHEMA_INT", line 3
ORA-06512: at "XDB.DBMS_XMLSCHEMA", line 14
ORA-06512: at line 12 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-06-16T06:14:42.260

**更新**

XML Schema 注册需要以下权限：

```
grant alter session to <USER>;
grant create type to <USER>; /* required when gentypes => true */
grant create table to <USER>; /* required when gentables => true */ 
```

出于某种原因，仅通过角色间接授予这些权限是不够的，但需要*将权限直接授予 schema/user*。

**原始答案**

我还注意到参数的默认值`gentables`并`gentypes`引发`insufficient privileges`异常。可能我只是缺乏使用这些功能的一些特权，但目前我还没有很好地理解它们的作用。我很高兴禁用它们并且验证似乎工作正常。

我在 Oracle Database 11g 版本 11.2.0.1.0 上运行

## gentypes => true, gentables => true

```
dbms_xmlschema.registerschema(schemaurl => name,
                              schemadoc => xmltype(schema),
                              local => true
                              --gentypes => false,
                              --gentables => false
                              );

ORA-01031: insufficient privileges
ORA-06512: at "XDB.DBMS_XMLSCHEMA_INT", line 55
ORA-06512: at "XDB.DBMS_XMLSCHEMA", line 159
ORA-06512: at "JANI.XML_VALIDATOR", line 38
ORA-06512: at line 7 
```

## gentypes => false，gentables => true

```
dbms_xmlschema.registerschema(schemaurl => name,
                              schemadoc => xmltype(schema),
                              local => true,
                              gentypes => false
                              --gentables => false
                              );

ORA-31084: error while creating table "JANI"."example873_TAB" for element "example"
ORA-01031: insufficient privileges
ORA-06512: at "XDB.DBMS_XMLSCHEMA_INT", line 55
ORA-06512: at "XDB.DBMS_XMLSCHEMA", line 159
ORA-06512: at "JANI.XML_VALIDATOR", line 38
ORA-06512: at line 7 
```

## gentypes => true, gentables => false

```
dbms_xmlschema.registerschema(schemaurl => name,
                              schemadoc => xmltype(schema),
                              local => true,
                              --gentypes => false
                              gentables => false
                              );

ORA-01031: insufficient privileges
ORA-06512: at "XDB.DBMS_XMLSCHEMA_INT", line 55
ORA-06512: at "XDB.DBMS_XMLSCHEMA", line 159
ORA-06512: at "JANI.XML_VALIDATOR", line 38
ORA-06512: at line 7 
```

## gentypes => false，gentables => false

```
dbms_xmlschema.registerschema(schemaurl => name,
                              schemadoc => xmltype(schema),
                              local => true,
                              gentypes => false,
                              gentables => false
                              );

PL/SQL procedure successfully completed. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-03-11T14:50:27.617

您必须`ALTER SESSION`授予特权才能注册模式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-21T11:14:56.757

这是一段对我有用的代码。user272735的答案是对的，我写了另一个答案，因为我不能在评论中写下所有代码（太长）。

```
/* Formatted on 21/08/2012 12:52:47 (QP5 v5.115.810.9015) */
DECLARE
   -- Local variables here
   res          BOOLEAN;
   tempXML      XMLTYPE;
   xmlDoc       XMLTYPE;
   xmlSchema    XMLTYPE;
   schemaURL    VARCHAR2 (256) := 'testcase.xsd';
BEGIN
   dbms_xmlSchema.deleteSchema (schemaURL, 4);
   -- Test statements here
   xmlSchema :=
      xmlType('<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xdb="http://xmlns.oracle.com/xdb"
elementFormDefault="qualified" attributeFormDefault="unqualified">
<xs:element name="root" xdb:defaultTable="ROOT_TABLE">
<xs:complexType>
<xs:sequence>
<xs:element name="child1"/>
<xs:element name="child2"/>
</xs:sequence>
</xs:complexType>
</xs:element>
</xs:schema>
');
    -- http://stackoverflow.com/questions/82047/validating-xml-files-against-schema-in-oracle-pl-sql
    dbms_xmlschema.registerschema(schemaurl => schemaURL,
                                  schemadoc => xmlSchema,
                                  local => true,
                                  gentypes => false,
                                  gentables => false
                                  );
   xmlDoc :=
      xmltype('<root xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="'
              || schemaURL
              || '"><child1>foo</child1><child2>bar</child2></root>');
   xmlDoc.schemaValidate ();
   -- if we are here, xml is valid
   DBMS_OUTPUT.put_line ('OK');
exception
    when others then
    DBMS_OUTPUT.put_line (SQLErrm);
END; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-07T14:43:02.583

一旦您解决了安装问题，当模式变大时，某些 Oracle 版本会遇到挑战，特别是当您的模式包含其他模式时。我知道我们在 9.2 中遇到了这个问题，不确定 10.2 还是 11。

但是，对于像您的示例这样的小型架构，它应该可以正常工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-01-09T21:10:10.167

注册 XSD 会导致创建表、类型和触发器。因此，您需要以下补助金：

```
grant create table to <user>;
grant create type to <user>;
grant create trigger to <user>; 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-09-17T13:56:46.897

如果我没记错的话，当 XDB（Oracle 的 XML 数据库包）未正确安装时会给出该错误消息。让 DBA 检查一下。

# c# - 反序列化客户端 AJAX JSON 日期

> ID：82058
> 
> 赞同：36
> 
> 时间：2008-09-17T11:09:01.277
> 
> 标签：c#, asp.net, json, ajax, date

给定以下 JSON 日期表示：

```
"\/Date(1221644506800-0700)\/" 
```

您如何将其反序列化为它的 JavaScript 日期类型形式？

我尝试使用 MS AJAX JavaScrioptSerializer，如下所示：

```
Sys.Serialization.JavaScriptSerializer.deserialize("\/Date(1221644506800-0700)\/") 
```

但是，我得到的只是文字字符串日期。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-06-06T05:51:51.757

如果您知道字符串绝对是我更喜欢这样做的日期：

```
 new Date(parseInt(value.replace("/Date(", "").replace(")/",""), 10)) 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2010-04-16T16:25:15.240

从事 ASP.NET Atlas/AJAX 工作的 Bertrand LeRoy[描述了 JavaScriptSerializer DateTime 输出的设计，](http://weblogs.asp.net/bleroy/archive/2008/01/18/dates-and-json.aspx)并揭示了神秘的前斜线和后斜线的起源。他提出了这个建议：

> 运行一个简单的搜索 "\/Date((\d+))\/" 并在 eval 之前替换为 "new Date($1)" （但在验证之后）

我将其实现为：

```
var serializedDateTime = "\/Date(1271389496563)\/";
document.writeln("Serialized: " + serializedDateTime + "<br />");

var toDateRe = new RegExp("^/Date\\((\\d+)\\)/$");
function toDate(s) {
    if (!s) {
        return null;
    }
    var constructor = s.replace(toDateRe, "new Date($1)");
    if (constructor == s) {
        throw 'Invalid serialized DateTime value: "' + s + '"';
    }
    return eval(constructor);
}

document.writeln("Deserialized: " + toDate(serializedDateTime) + "<br />"); 
```

这与许多其他答案非常接近：

*   像 Sjoerd Visscher 那样使用锚定的正则表达式——不要忘记 ^ 和 $。
*   避免使用 string.replace，以及 RegEx 上的“g”或“i”选项。“/Date(1271389496563)//Date(1271389496563)/”根本不应该工作。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-09-17T12:07:23.743

JSON 值是字符串、数字、对象、数组、true、false 或 null。所以这只是一个字符串。没有官方的方式来表示 JSON 中的日期。此语法来自 asp.net ajax 实现。其他人使用 ISO 8601 格式。

你可以像这样解析它：

```
var s = "\/Date(1221644506800-0700)\/";
var m = s.match(/^\/Date\((\d+)([-+]\d\d)(\d\d)\)\/$/);
var date = null;
if (m)
  date = new Date(1*m[1] + 3600000*m[2] + 60000*m[3]); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-09T16:59:54.710

ASP.net AJAX 反序列化方法中使用的正则表达式查找看起来像“/Date(1234)/”的字符串（字符串本身实际上需要包含引号和斜杠）。要获得这样的字符串，您需要转义引号和反斜杠字符，因此创建字符串的 javascript 代码看起来像“\”\/Date(1234)\/\""。

这将起作用。

```
Sys.Serialization.JavaScriptSerializer.deserialize("\"\\/Date(1221644506800)\\/\"") 
```

这有点奇怪，但我发现我必须序列化一个日期，然后序列化从该日期返回的字符串，然后在客户端反序列化一次。

像这样的东西。

```
Script.Serialization.JavaScriptSerializer jss = new Script.Serialization.JavaScriptSerializer();
string script = string.Format("alert(Sys.Serialization.JavaScriptSerializer.deserialize({0}));", jss.Serialize(jss.Serialize(DateTime.Now)));
Page.ClientScript.RegisterStartupScript(this.GetType(), "ClientScript", script, true); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-10-29T22:32:43.080

对于那些不想使用 Microsoft Ajax 的人，只需在字符串类中添加一个原型函数即可。

例如

```
 String.prototype.dateFromJSON = function () {
    return eval(this.replace(/\/Date\((\d+)\)\//gi, "new Date($1)"));
}; 
```

不想使用评估？尝试一些简单的事情，比如

```
var date = new Date(parseInt(jsonDate.substr(6))); 
```

作为旁注，我曾经认为微软使用这种格式是在误导。但是，在定义一种在 JSON 中描述日期的方式时，JSON 规范并不是很清楚。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-12-28T18:26:28.667

实际上，momentjs 支持这种格式，你可以这样做：

```
 var momentValue = moment(value);

    momentValue.toDate(); 
```

这将返回 javascript 日期格式的值

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-17T11:41:48.377

大数字是标准的JS时间

```
new Date(1221644506800) 
```

2008 年 9 月 17 日星期三 19:41:46 GMT+1000 (EST)

# regex - 版本号解析的正则表达式

> ID：82064
> 
> 赞同：102
> 
> 时间：2008-09-17T11:10:06.143
> 
> 标签：regex, versioning

我有以下形式的版本号：

版本.发布.修改

其中版本、发布和修改是一组数字或“*”通配符。此外，这些数字中的任何一个（以及任何前面的 .）都可能丢失。

因此以下内容有效并解析为：

```
1.23.456 = version 1, release 23, modification 456
1.23     = version 1, release 23, any modification
1.23.*   = version 1, release 23, any modification
1.*      = version 1, any release, any modification
1        = version 1, any release, any modification
*        = any version, any release, any modification 
```

但这些是无效的：

```
*.12
*123.1
12*
12.*.34 
```

谁能给我一个不太复杂的正则表达式来验证和检索发布、版本和修改号？

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2008-09-17T11:33:02.467

我将格式表示为：

> “1-3个点分隔的组件，每个数字除了最后一个可能是*”

作为一个正则表达式，那就是：

```
^(\d+\.)?(\d+\.)?(\*|\d+)$ 
```

[编辑添加：此解决方案是一种简洁的验证方式，但已指出提取值需要额外的工作。是通过使正则表达式复杂化还是通过处理匹配的组来处理这个问题，这是一个个人喜好问题。

在我的解决方案中，组捕获`"."`角色。这可以使用非捕获组来处理，如 ajborley 的回答。

此外，即使组件少于三个，最右边的组也将捕获最后一个组件，因此例如双组件输入会导致第一个和最后一个组捕获，而中间的一个未定义。我认为这可以由支持的非贪婪团体来处理。

在正则表达式之后处理这两个问题的 Perl 代码可能是这样的：

```
@version = ();
@groups = ($1, $2, $3);
foreach (@groups) {
    next if !defined;
    s/\.//;
    push @version, $_;
}
($major, $minor, $mod) = (@version, "*", "*"); 
```

这并不比在`"."` ]上拆分更短

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2008-09-17T11:24:42.143

**使用正则表达式，现在你有两个问题。**我会在点（“。”）上拆分东西，然后确保每个部分都是通配符或数字集（正则表达式现在很完美）。如果事情是有效的，您只需返回正确的拆分块。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-09-17T12:13:01.793

感谢所有的回复！这是王牌：）

基于 OneByOne 的回答（这对我来说看起来最简单），我添加了一些非捕获组（'(?:' 部分 - 感谢 VonC 将我介绍给非捕获组！），所以只捕获的组包含数字或 * 字符。

```
^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$ 
```

非常感谢大家！

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-09-17T11:16:12.947

这可能有效：

```
^(\*|\d+(\.\d+){0,2}(\.\*)?)$ 
```

在顶层，“*”是有效版本号的特例。否则，它以数字开头。然后是零个、一个或两个“.nn”序列，后跟一个可选的“.*”。此正则表达式将接受 1.2.3.*，您的应用程序中可能允许也可能不允许。

检索匹配序列的代码，尤其是`(\.\d+){0,2}`部分，将取决于您的特定正则表达式库。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2014-12-18T06:55:20.830

我的 2 美分：我遇到了这种情况：我必须从字符串文字中解析版本号。（我知道这与原始问题有很大不同，但谷歌搜索查找用于解析版本号的正则表达式在顶部显示了此线程，因此在此处添加此答案）

所以字符串文字将类似于：“服务版本 1.2.35.564 正在运行！”

我不得不从这个文字中解析出 1.2.35.564 。从@ajborley 得到提示，我的正则表达式如下：

```
(?:(\d+)\.)?(?:(\d+)\.)?(?:(\d+)\.\d+) 
```

一个小的 C# 片段来测试它如下所示：

```
void Main()
{
    Regex regEx = new Regex(@"(?:(\d+)\.)?(?:(\d+)\.)?(?:(\d+)\.\d+)", RegexOptions.Compiled);

    Match version = regEx.Match("The Service SuperService 2.1.309.0) is Running!");
    version.Value.Dump("Version using RegEx");   // Prints 2.1.309.0        
} 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-09-17T11:52:32.873

不知道您使用的是什么平台，但在 .NET 中有 System.Version 类可以为您解析“nnnn”版本号。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2017-06-12T13:43:53.603

我需要搜索/匹配版本号，遵循 Maven 约定，甚至只是单个数字。但无论如何都没有限定符。这很奇怪，我花了一些时间才想出这个：

```
'^[0-9][0-9.]*$' 
```

这可以确保版本，

1.  以数字开头
2.  可以有任意位数
3.  只有数字和“。” 被允许

一个缺点是版本甚至可以以“.”结尾。但它可以处理无限长度的版本（如果你想这样称呼它，那就是疯狂的版本控制）

火柴：

*   1.2.3
*   1.09.5
*   3.4.4.5.7.8.8。
*   23.6.209.234.3

如果您对“。”不满意。结束，也许你可以结合用逻辑结束

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-09-17T11:46:33.513

我倾向于同意拆分建议。

我在 perl 中为您的问题创建了一个“测试器”

```
#!/usr/bin/perl -w

@strings = ( "1.2.3", "1.2.*", "1.*","*" );

%regexp = ( svrist => qr/(?:(\d+)\.(\d+)\.(\d+)|(\d+)\.(\d+)|(\d+))?(?:\.\*)?/,
            onebyone => qr/^(\d+\.)?(\d+\.)?(\*|\d+)$/,
            greg => qr/^(\*|\d+(\.\d+){0,2}(\.\*)?)$/,
            vonc => qr/^((?:\d+(?!\.\*)\.)+)(\d+)?(\.\*)?$|^(\d+)\.\*$|^(\*|\d+)$/,
            ajb => qr/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/,
            jrudolph => qr/^(((\d+)\.)?(\d+)\.)?(\d+|\*)$/
          );

  foreach my $r (keys %regexp){
    my $reg = $regexp{$r};
    print "Using $r regexp\n";
foreach my $s (@strings){
  print "$s : ";

    if ($s =~m/$reg/){
    my ($main, $maj, $min,$rev,$ex1,$ex2,$ex3) = ("any","any","any","any","any","any","any");
    $main = $1 if ($1 && $1 ne "*") ;
    $maj = $2 if ($2 && $2 ne "*") ;
    $min = $3 if ($3 && $3 ne "*") ;
    $rev = $4 if ($4 && $4 ne "*") ;
    $ex1 = $5 if ($5 && $5 ne "*") ;
    $ex2 = $6 if ($6 && $6 ne "*") ;
    $ex3 = $7 if ($7 && $7 ne "*") ;
    print "$main $maj $min $rev $ex1 $ex2 $ex3\n";

  }else{
  print " nomatch\n";
  }
  }
print "------------------------\n";
} 
```

电流输出：

```
> perl regex.pl
Using onebyone regexp
1.2.3 : 1\. 2\. 3 any any any any
1.2.* : 1\. 2\. any any any any any
1.* : 1\. any any any any any any
* : any any any any any any any
------------------------
Using svrist regexp
1.2.3 : 1 2 3 any any any any
1.2.* : any any any 1 2 any any
1.* : any any any any any 1 any
* : any any any any any any any
------------------------
Using vonc regexp
1.2.3 : 1.2\. 3 any any any any any
1.2.* : 1\. 2 .* any any any any
1.* : any any any 1 any any any
* : any any any any any any any
------------------------
Using ajb regexp
1.2.3 : 1 2 3 any any any any
1.2.* : 1 2 any any any any any
1.* : 1 any any any any any any
* : any any any any any any any
------------------------
Using jrudolph regexp
1.2.3 : 1.2\. 1\. 1 2 3 any any
1.2.* : 1.2\. 1\. 1 2 any any any
1.* : 1\. any any 1 any any any
* : any any any any any any any
------------------------
Using greg regexp
1.2.3 : 1.2.3 .3 any any any any any
1.2.* : 1.2.* .2 .* any any any any
1.* : 1.* any .* any any any any
* : any any any any any any any
------------------------ 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2013-05-14T10:33:45.800

我已经看到了很多答案，但是......我有一个新的。它至少对我有用。我添加了一个新的限制。版本号不能以任何零开头（主要、次要或补丁）后跟其他版本。

> 01.0.0 无效 1.0.0 有效 10.0.10 有效 1.0.0000 无效

```
^(?:(0\\.|([1-9]+\\d*)\\.))+(?:(0\\.|([1-9]+\\d*)\\.))+((0|([1-9]+\\d*)))$ 
```

它基于上一个。但我认为这个解决方案更好......对我来说;）

享受！！！

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2008-09-17T12:30:27.400

```
^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$ 
```

也许更简洁的一个可能是：

```
^(?:(\d+)\.){0,2}(\*|\d+)$ 
```

然后可以将其增强到 1.2.3.4.5.* 或使用 * 或 {2} 而不是 {0,2} 完全限制为 XYZ

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2010-04-12T03:28:59.063

这应该适用于您的规定。它取决于通配符的位置，是一个嵌套的正则表达式：

```
^((\*)|([0-9]+(\.((\*)|([0-9]+(\.((\*)|([0-9]+)))?)))?))$ 
```

![http://imgur.com/3E492.png](https://i.stack.imgur.com/wAazA.png)

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2008-09-17T12:17:51.050

另一个尝试：

```
^(((\d+)\.)?(\d+)\.)?(\d+|\*)$ 
```

这给出了 4、5、6 组中的三个部分，但是：它们向右对齐。所以 4,5 或 6 中的第一个非空值给出版本字段。

*   1.2.3 给出 1,2,3
*   1.2.* 给出 1,2,*
*   1.2 给出 null,1,2
*   *** 给出 null,null,*
*   1.* 给出 null,1,*

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2017-05-20T16:48:15.110

我对此的看法，作为一个很好的练习 - [vparse](https://github.com/vitaly-t/vparse)，它有一个[很小的 ​​source](https://github.com/vitaly-t/vparse/blob/master/index.js)，具有一个简单的功能：

```
function parseVersion(v) {
    var m = v.match(/\d*\.|\d+/g) || [];
    v = {
        major: +m[0] || 0,
        minor: +m[1] || 0,
        patch: +m[2] || 0,
        build: +m[3] || 0
    };
    v.isEmpty = !v.major && !v.minor && !v.patch && !v.build;
    v.parsed = [v.major, v.minor, v.patch, v.build];
    v.text = v.parsed.join('.');
    return v;
} 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2020-06-12T12:38:22.470

用于解析遵循以下规则的版本号： - 只有数字和点 - 不能以点开头或结尾 - 不能是两个点

这个对我有用。

```
^(\d+)((\.{1}\d+)*)(\.{0})$ 
```

有效的案例是：

1、0.1、1.2.1

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2020-10-09T06:24:30.593

有时版本号可能包含字母数字的次要信息（例如*1.2.0b*或*1.2.0-beta*）。在这种情况下，我使用这个正则表达式：

```
([0-9]{1,4}(\.[0-9a-z]{1,6}){1,5}) 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2008-09-17T11:39:44.153

请记住，正则表达式是贪婪的，所以如果您只是在版本号字符串中搜索而不是在更大的文本中，请使用 ^ 和 $ 标记字符串的开始和结束。Greg 的正则表达式似乎工作正常（只是在我的编辑器中快速尝试了一下），但根据您的库/语言，第一部分仍然可以匹配错误版本号中的“*”。也许我错过了一些东西，因为我已经有一年左右没有使用 Regexp 了。

这应该确保您只能找到正确的版本号：

^(\*|\d+(\.\d+)*(\.\*)?)$

编辑：实际上格雷格已经添加了它们，甚至改进了他的解决方案，我太慢了:)

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2008-09-17T11:47:56.287

```
(?ms)^((?:\d+(?!\.\*)\.)+)(\d+)?(\.\*)?$|^(\d+)\.\*$|^(\*|\d+)$ 
```

与您的前 6 个示例完全匹配，并拒绝其他 4 个

*   第 1 组：major 或 major.minor 或 '*'
*   第 2 组（如果存在）：次要或 *
*   第 3 组（如果存在）：*

您可以删除 '(?ms)'
我用它来指示此正则表达式通过[QuickRex应用于多行](http://bastian-bergerhoff.com/eclipse/features/web/QuickREx/toc.html)

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2008-09-17T12:00:20.437

这也匹配 1.2.3.*

> ^(*|\d+(.\d+){0,2}(.*)?)$

我会建议不太优雅：

(*|\d+(.\d+)?(.*)?)|\d+.\d+.\d+)

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2008-09-17T12:19:34.133

似乎很难有一个正则表达式完全符合您的要求（即只接受您需要的情况并拒绝**所有**其他情况*并*为三个组件返回一些组）。我试了一下，想出了这个：

```
^(\*|(\d+(\.(\d+(\.(\d+|\*))?|\*))?))$ 
```

IMO（我没有进行过广泛的测试）这应该可以很好地作为输入的验证器，但问题是这个正则表达式不提供检索组件的方法。为此，您仍然需要对期间进行拆分。

该解决方案不是一体式的，但大多数时候在编程时不需要这样做。当然，这取决于您的代码中可能存在的其他限制。

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2016-12-28T15:17:01.520

指定 XSD 元素：

```
<xs:simpleType>
    <xs:restriction base="xs:string">
        <xs:pattern value="[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}(\..*)?"/>
    </xs:restriction>
</xs:simpleType> 
```

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2016-09-06T09:09:21.467

另一种解决方案：

```
^[1-9][\d]*(.[1-9][\d]*)*(.\*)?|\*$ 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2020-11-11T10:07:59.380

我发现了这个，它对我有用：

```
/(\^|\~?)(\d|x|\*)+\.(\d|x|\*)+\.(\d|x|\*)+ 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2022-01-04T07:41:18.443

```
/^([1-9]{1}\d{0,3})(\.)([0-9]|[1-9]\d{1,3})(\.)([0-9]|[1-9]\d{1,3})(\-(alpha|beta|rc|HP|CP|SP|hp|cp|sp)[1-9]\d*)?(\.C[0-9a-zA-Z]+(-U[1-9]\d*)?)?(\.[0-9a-zA-Z]+)?$/ 
```

*   普通版：`([1-9]{1}\d{0,3})(\.)([0-9]|[1-9]\d{1,3})(\.)([0-9]|[1-9]\d{1,3})`
*   预发布或修补版本：（`(\-(alpha|beta|rc|EP|HP|CP|SP|ep|hp|cp|sp)[1-9]\d*)?` 扩展包、修补程序包、Coolfix 包、服务包）
*   定制版：`(\.C[0-9a-zA-Z]+(-U[1-9]\d*)?)?`
*   内部版本：`(\.[0-9a-zA-Z]+)?`

[![在此处输入图像描述](https://i.stack.imgur.com/Qnquk.png)](https://i.stack.imgur.com/Qnquk.png)

# multithreading - 多线程观察者的设计模式

> ID：82074
> 
> 赞同：1
> 
> 时间：2008-09-17T11:11:37.357
> 
> 标签：multithreading, design-patterns, observer-pattern, dataflow

在数字信号采集系统中，数据通常由一个线程推送到系统中的观察者中。

来自[Wikipedia/Observer_pattern](http://en.wikipedia.org/wiki/Observer_pattern)的示例：

```
foreach (IObserver observer in observers)
    observer.Update(message); 
```

例如，当来自例如 GUI 线程的用户操作要求数据停止流动时，您希望中​​断主体与观察者的连接，甚至一起处置观察者。

有人可能会争辩说：您应该停止数据源，并等待一个哨兵值来处理连接。但这会在系统中产生更多的延迟。

当然，如果数据泵线程刚刚询问了观察者的地址，它可能会发现它正在向被破坏的对象发送消息。

是否有人创建了一个“官方”设计模式来应对这种情况？他们不应该吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T15:37:01.060

如果您希望数据源始终处于并发安全的一侧，您应该至少有一个指针始终可以安全地供他使用。所以 Observer 对象的生命周期应该不会在数据源的生命周期之前结束。

这可以通过仅添加观察者来完成，但永远不要删除它们。您可以让每个观察者自己不执行核心实现，而是让它将此任务委托给 ObserverImpl 对象。您锁定对此 impl 对象的访问。这没什么大不了的，它只是意味着 GUI 取消订阅者将被阻止一段时间，以防观察者忙于使用 ObserverImpl 对象。如果 GUI 响应是一个问题，您可以使用某种并发作业队列机制，并将取消订阅作业推送到它上面。（如 Windows 中的 PostMessage ）

取消订阅时，您只需将核心实现替换为虚拟实现。再次，此操作应该抓住锁。这确实会引入一些等待数据源，但由于它只是一个 [锁定-指针交换-解锁]，您可以说这对于实时应用程序来说已经足够快了。

如果您想避免堆叠仅包含虚拟对象的 Observer 对象，则必须进行某种簿记，但这可能归结为一些琐碎的事情，例如一个对象持有指向列表中他需要的 Observer 对象的指针。

优化：如果您还保持实现（真实的 + 虚拟的）与观察者本身一样长，您可以在没有实际锁的情况下执行此操作，并使用 InterlockedExchangePointer 之类的东西来交换指针。最坏的情况：在交换指针时委托调用正在进行——>没什么大不了的，所有对象都保持活动状态并且委托可以继续。下一个委托调用将是新的实现对象。（当然，除非有任何新的互换）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T11:18:56.603

您可以向所有观察者发送消息，通知他们数据源正在终止，并让观察者将自己从列表中删除。

作为对评论的回应，主体-观察者模式的实现应该允许动态添加/删除观察者。在 C# 中，事件系统是一种主体/观察者模式，其中观察者`event += observer`使用`event -= observer`.

# c# - .Net 的 Y-Modem 实现

> ID：82093
> 
> 赞同：3
> 
> 时间：2008-09-17T11:14:29.453
> 
> 标签：c#, .net

.Net 是否有现成且免费的 Y-Modem 实现，最好在 C# 中实现？

我发现只有 C/C++ 解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T12:17:29.087

有一个[XModem 库](http://trackday.cc/b2evo/blog2.php/2007/08/02/net-xmodem)，您可以轻松适应使用 Y-Modem。

# .net - 如何处理 WCF 的 MSMQ 绑定中的消息失败

> ID：82099
> 
> 赞同：17
> 
> 时间：2008-09-17T11:15:21.357
> 
> 标签：.net, wcf, msmq

我创建了一个 WCF 服务并正在使用 netMsmqBinding 绑定。

这是一个简单的服务，它将 Dto 传递给我的服务方法并且不期望响应。消息被放置在一个 MSMQ 中，并且一旦被拾取就插入到一个数据库中。

确保没有数据丢失的最佳方法是什么。

我尝试了以下两种方法：

1.  抛出异常

    这会将消息置于死信队列中以供手动阅读。当我的服务开始时，我可以处理这个

2.  在绑定上设置 receiveRetryCount="3"

    经过 3 次尝试后 - 瞬间发生，这似乎将消息留在队列中，但我的服务出错了。重新启动我的服务会重复此过程。

理想情况下，我想做以下事情：

尝试处理消息

*   如果失败，请等待该消息 5 分钟，然后重试。
*   如果该过程失败 3 次，则将消息移动到死信队列。
*   重新启动服务会将死信队列中的所有消息推回队列中，以便对其进行处理。

我能做到这一点吗？如果有怎么办？你能给我指出任何关于如何最好地利用 WCF 和 MSMQ 来处理我给定场景的好文章吗？

任何帮助将非常感激。谢谢！

**一些附加信息**

我在 Windows XP 和 Windows Server 2003 上使用 MSMQ 3.0。不幸的是，我无法使用针对 MSMQ 4.0 和 Vista/2008 的内置有害消息支持。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-17T12:29:41.833

我认为使用 MSMQ（仅在 Vista 上可用）您可以这样做：

```
<bindings>
    <netMsmqBinding>
        <binding name="PosionMessageHandling"
             receiveRetryCount="3"
             retryCycleDelay="00:05:00"
             maxRetryCycles="3"
             receiveErrorHandling="Move" />
    </netMsmqBinding>
</bindings> 
```

WCF 将在第一次调用失败后立即重试 ReceiveRetryCount 次。批处理失败后，消息将移至重试队列。延迟 RetryCycleDelay 分钟后，消息从重试队列移动到端点队列，并重试批处理。这将重复 MaxRetryCycle 时间。如果所有失败，则根据receiveErrorHandling 处理消息，该消息可以移动（到毒队列）、拒绝、丢弃或故障

顺便说一句，关于 WCF 和 MSMQ 的好文章是来自 Juval Lowy 的 Progammig WCF 书的第 9 章

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-17T17:36:23.077

SDK 中有一个示例可能对您的情况有用。基本上，它所做的是将 IErrorHandler 实现附加到您的服务，当 WCF 将消息声明为“毒药”（即，当所有配置的重试都已用尽时）时，它将捕获错误。该示例所做的是将消息移动到另一个队列，然后重新启动与该消息关联的 ServiceHost（因为在发现有害消息时它会出现故障）。

这不是一个非常漂亮的示例，但它可能很有用。但是有几个限制：

1-如果您有多个与您的服务关联的端点（即通过多个队列公开），则无法知道有毒消息到达哪个队列。如果您只有一个队列，这不会是问题。我还没有看到任何官方的解决方法，但我已经尝试了一种可能的替代方案，我在这里记录了：[http ://winterdom.com/weblog/2008/05/27/NetMSMQAndPoisonMessages.aspx](http://winterdom.com/weblog/2008/05/27/NetMSMQAndPoisonMessages.aspx)

2-一旦问题消息被移动到另一个队列，它就成为您的责任，因此一旦超时完成（或将新服务附加到该队列以处理它），您就可以将其移回处理队列。

老实说，在任何一种情况下，您都会在这里看到一些 WCF 本身并没有涵盖的“手动”工作。

我最近一直在从事一个不同的项目，我需要明确控制重试发生的频率，我当前的解决方案是创建一组重试队列并在重试队列和主处理队列之间手动移动消息基于一组计时器和一些启发式方法，仅使用原始 System.Messaging 东西来处理 MSMQ 队列。它似乎工作得很好，但如果你这样做会有几个问题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-17T12:54:14.520

如果您使用的是 SQL-Server，那么您应该使用分布式事务，因为 MSMQ 和 SQL-Server 都支持它。发生的情况是您将数据库写入包装在 TransactionScope 块中并仅在成功时调用 scope.Complete() 。如果失败，那么当您的 WCF 方法返回时，消息将被放回队列中以再次尝试。这是我使用的精简版代码：

```
 [OperationBehavior(TransactionScopeRequired=true, TransactionAutoComplete=true)]
    public void InsertRecord(RecordType record)
    {
        try
        {
            using (TransactionScope scope = new TransactionScope(TransactionScopeOption.Required))
            {
                SqlConnection InsertConnection = new SqlConnection(ConnectionString);
                InsertConnection.Open();

                // Insert statements go here

                InsertConnection.Close();

                // Vote to commit the transaction if there were no failures
                scope.Complete();
            }
        }
        catch (Exception ex)
        {
            logger.WarnException(string.Format("Distributed transaction failure for {0}", 
                Transaction.Current.TransactionInformation.DistributedIdentifier.ToString()),
                ex);
        }
     } 
```

我通过排队大量但已知数量的记录来测试这一点，让 WCF 启动大量线程来同时处理其中的许多（达到 16 个线程 - 一次队列中有 16 条消息），然后在操作中间终止进程. 当程序重新启动时，从队列中读回消息并再次处理，就好像什么都没发生一样，并且在测试结束时数据库是一致的并且没有丢失的记录。

分布式事务管理器具有环境存在，当您创建 TransactionScope 的新实例时，它会自动在方法调用范围内搜索当前事务——当 WCF 将消息从队列中弹出时，它应该已经创建并调用了你的方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T12:43:24.017

不幸的是，我被困在 Windows XP 和 Windows Server 2003 上，所以这对我来说不是一个选择。- （我将在我的问题中重新澄清这一点，因为我在发布后找到了这个解决方案并意识到我无法使用它）

我发现一种解决方案是设置一个自定义处理程序，它将我的消息移动到另一个队列或毒队列并重新启动我的服务。这对我来说似乎很疯狂。想象一下，我的 Sql Server 关闭了服务重启的频率。

所以我最终做的是让线路出现故障并在队列中留下消息。我还向我的系统日志记录服务记录了一条致命消息，表明这已经发生。一旦我们的问题得到解决，我会重新启动服务，所有消息都会再次开始处理。

我意识到重新处理此消息或任何其他消息都会失败，那么为什么需要将此消息和其他消息移动到另一个队列。我不妨停止我的服务，并在一切按预期运行时重新启动它。

aogan，您对 MSMQ 4.0 有完美的答案，但不幸的是不适合我

# java - 应该将 Log4J 记录器声明为瞬态吗？

> ID：82109
> 
> 赞同：31
> 
> 时间：2008-09-17T11:17:39.773
> 
> 标签：java, logging, serialization, log4j

我正在使用带有 Log4J 的 Java 1.4。

我的一些代码涉及序列化和反序列化值对象 (POJO)。

我的每个 POJO 都声明了一个记录器

```
private final Logger log = Logger.getLogger(getClass()); 
```

序列化程序抱怨 org.apache.log4j.Logger 不是可序列化的。

我应该使用

```
private final transient Logger log = Logger.getLogger(getClass()); 
```

反而？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-09-17T11:20:52.340

使用静态记录器怎么样？或者您是否需要为每个类实例使用不同的记录器引用？静态字段默认不序列化；您可以显式声明字段以使用名为的私有、静态、最终数组进行序列`ObjectStreamField`化`serialPersistentFields`。[请参阅 Oracle 文档](http://java.sun.com/developer/technicalArticles/ALT/serialization/#2)

添加内容：当您使用[getLogger(getClass())](http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/Logger.html#getLogger(java.lang.String))时，您将在每个实例中使用相同的记录器。如果要为每个实例使用单独的记录器，则必须在 getLogger() 方法中区分记录器的名称。例如 getLogger(getClass().getName() + hashCode())。然后，您应该使用瞬态属性来确保记录器未序列化。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-17T11:20:25.883

记录器必须是静态的；这将使其不可序列化。

没有理由让记录器成为非静态的，除非你有充分的理由这样做。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-09-17T12:27:37.923

如果您*真的*想采用瞬态方法，则需要在反序列化对象时重置日志。这样做的方法是实现该方法：

```
 private void readObject(java.io.ObjectInputStream in) 
   throws IOException, ClassNotFoundException; 
```

[Serializable](http://java.sun.com/javase/6/docs/api/java/io/Serializable.html)的 javadocs包含有关此方法的信息。

您的实现将类似于：

```
 private void readObject(java.io.ObjectInputStream in) 
     throws IOException, ClassNotFoundException {
   log = Logger.getLogger(...);
   in.defaultReadObject();
 } 
```

如果你不这样做，那么在反序列化你的对象后 log 将为空。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-17T12:26:37.113

将您的记录器字段声明为静态或瞬态。

这两种方式都确保 writeObject() 方法在序列化期间不会尝试将字段写入输出流。

通常记录器字段被声明为静态的，但如果您需要它是一个实例字段，只需将其声明为瞬态，就像它通常对任何不可序列化的字段所做的那样。但是，在反序列化时，记录器字段将为空，因此您必须实现一个 readObject() 方法来正确初始化它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-17T11:21:36.940

尝试将 Logger 设为静态。比你不必关心序列化，因为它是由类加载器处理的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-17T12:26:34.023

这类情况，尤其是在 EJB 中，通常最好通过线程本地状态来处理。通常，用例就像您有一个遇到问题的特定事务，您需要提升日志记录以调试该操作，以便您可以生成有关问题操作的详细日志记录。在事务中携带一些线程本地状态并使用它来选择正确的记录器。坦率地说，我不知道在这种环境中在实例上设置级别有什么好处，因为实例到事务的映射应该是容器级别的函数，您实际上无法控制在一个实例中使用哪个实例无论如何给定交易。

即使在处理 DTO 的情况下，以需要给定特定实例的方式设计系统通常也不是一个好主意，因为设计很容易演变为使该选择成为错误选择的方式。从现在开始一个月后，您可能会决定效率考虑（缓存或其他一些改变生命周期的优化）将打破您关于将实例映射到工作单元的假设。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T11:48:22.837

如果您希望 Logger 是每个实例的，那么是的，如果您要序列化您的对象，您可能希望它是瞬态的。Log4J Loggers 不是可序列化的，在我使用的 Log4J 版本中也不是，所以如果你不让你的 Logger 字段是瞬态的，你会在序列化时遇到异常。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T11:54:18.283

记录器不可序列化，因此在将它们存储在实例字段中时必须使用瞬态。如果您想在反序列化后恢复记录器，您可以将级别（字符串）存储在您的对象中，该对象确实会被序列化。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-17T15:02:56.067

使用实例记录器有充分的理由。一个非常好的用例是，您可以在超类中声明记录器并在所有子类中使用它（唯一的缺点是来自超类的日志归于子类，但通常很容易看到那个）。

（就像其他人提到的使用静态或瞬态一样）。

# multithreading - Delphi 类变量是否具有全局或线程本地存储？

> ID：82113
> 
> 赞同：7
> 
> 时间：2008-09-17T11:18:32.470
> 
> 标签：multithreading, delphi

我的猜测是类变量（“class var”）在存储中是真正的全局变量（即整个应用程序的一个实例）。

但我想知道是否是这种情况，或者它们是否是存储中的线程（例如，类似于“threadvar”） - 每个线程一次实例。

有人知道吗？

*编辑：将“范围”更改为“存储”，因为这实际上是正确的术语，也是我所追求的（感谢巴里）*

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-17T13:14:52.253

类变量根据其成员可见性属性进行作用域，并且具有全局存储，而不是线程存储。

范围是一个句法概念，与从何处可见的标识符有关。这里关心的是变量的存储。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-17T11:23:32.070

是的，类变量是全局范围的。查看 RTL 源代码，了解如何实现 threadvars 的详细信息。在 Win32 下，每个线程都可以在创建线程时自动分配一块内存。这个额外的数据区域用于包含您的线程变量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T00:43:19.870

类变量就像类一样：对应用程序来说是全局且唯一的。

# java - BIRT 运行时引擎 API 的 AssertionError

> ID：82123
> 
> 赞同：0
> 
> 时间：2008-09-17T11:20:10.517
> 
> 标签：java, reporting, birt

我是 BIRT 的新手，我正在尝试让报表引擎运行。我正在使用[http://www.eclipse.org/birt/phoenix/deploy/reportEngineAPI.php中提供的代码片段](http://www.eclipse.org/birt/phoenix/deploy/reportEngineAPI.php)

但我有一个奇怪的例外：

> java.lang.AssertionError at org.eclipse.birt.core.framework.Platform.startup(Platform.java:86)

并且日志文件中没有任何内容。

也许我错过了配置中的某些内容？有人可以提示我可以尝试使其运行吗？

这是我正在使用的代码：

```
public static void executeReport()
    {

        IReportEngine engine=null;
        EngineConfig config = null;

        try{
            config = new EngineConfig( );           
            config.setBIRTHome("D:\\birt-runtime-2_3_0\\ReportEngine");
            config.setLogConfig("d:/temp", Level.FINEST);
            Platform.startup( config );
            IReportEngineFactory factory = (IReportEngineFactory) Platform
            .createFactoryObject( IReportEngineFactory.EXTENSION_REPORT_ENGINE_FACTORY );
            engine = factory.createReportEngine( config );      

            IReportRunnable design = null;
            //Open the report design
            design = engine.openReportDesign("D:\\birt-runtime-2_3_0\\ReportEngine\\samples\\hello_world.rptdesign"); 
            IRunAndRenderTask task = engine.createRunAndRenderTask(design);         

            HTMLRenderOption options = new HTMLRenderOption();      
            options.setOutputFileName("output/resample/Parmdisp.html");
            options.setOutputFormat("html");

            task.setRenderOption(options);
            task.run();
            task.close();
            engine.destroy();
        }catch( Exception ex){
            ex.printStackTrace();
        }       
        finally
        {
            Platform.shutdown( );
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T11:37:50.553

几个月前我犯了同样的错误。我不太确定究竟是什么修复了它，但我的代码如下所示：

```
 IDesignEngine engine = null;
    DesignConfig dConfig = new DesignConfig();
    EngineConfig config = new EngineConfig();
    IDesignEngineFactory factory = null;
    config.setLogConfig(LOG_DIRECTORY, Level.FINE);
    HttpServletRequest servletRequest = (HttpServletRequest) FacesContext.getCurrentInstance()
     .getExternalContext().getRequest();

    String u = servletRequest.getSession().getServletContext().getRealPath("/");
    File f = new File(u + PATH_TO_ENGINE_HOME);

    log.debug("setting engine home to:"+f.getAbsolutePath());
    config.setEngineHome(f.getAbsolutePath());

    Platform.startup(config);
    factory = (IDesignEngineFactory) Platform.createFactoryObject(IDesignEngineFactory.EXTENSION_DESIGN_ENGINE_FACTORY);
    engine = factory.createDesignEngine(dConfig);
    SessionHandle session = engine.newSessionHandle(null);

    this.design = session.openDesign(u + PATH_TO_MAIN_DESIGN); 
```

也许您可以通过将此代码段与您自己的代码进行比较来解决您的问题。顺便说一句，我的 PATH_TO_ENGINE_HOME 是“/WEB-INF/platform”。[编辑]我使用了 birt-runtime-2_1_1 的 WebViewerExample 中的完整“平台”文件夹。atm birt-runtime-2_3_0 是实际的。[/edit]

如果这没有帮助，请提供更多详细信息（例如代码片段）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T14:53:11.310

只是一个想法，但我想知道您在设置记录器时使用正斜杠是否会导致问题？代替

```
config.setLogConfig("d:/temp", Level.FINEST); 
```

你应该使用

```
 config.setLogConfig("/temp", Level.FINEST); 
```

或者

```
 config.setLogConfig("d:\\temp", Level.FINEST); 
```

最后，我意识到这只是一些示例代码，但您肯定希望将平台启动代码从运行和渲染任务中分离出来。平台启动非常昂贵，每个会话只应进行一次。

我在 Subversion 服务器中设置了几个 Eclipse 项目，这些项目演示了如何使用 Report Engine API (REAPI) 和 Design Engine API (DEAPI)，随着代码变得越来越复杂，您可能会发现它们很有用。

要获取示例，您将需要 Subclipse 或 Subversive 插件，然后您需要连接到以下存储库：

```
http://longlake.minnovent.com/repos/birt_example 
```

您需要的项目是：

```
birt_api_example
birt_runtime_lib
script.lib 
```

您可能需要调整 BirtUtil 类中的一些文件位置，但我认为大多数文件位置都是相对路径。在我的博客 http://birtworld.blogspot.com 上有更多关于如何使用示例项目的信息。特别是这篇文章应该有所帮助：[报告的测试和调试](http://birtworld.blogspot.com/2008/04/testing-and-debug-of-reports.html)

# visual-studio - 在 Visual Studio 中显示构建时间？

> ID：82128
> 
> 赞同：189
> 
> 时间：2008-09-17T11:20:16.040
> 
> 标签：visual-studio, msbuild, build-process

我们的构建服务器花费了太长时间来构建我们的 C++ 项目之一。它使用 Visual Studio 2008。有什么方法可以让 devenv.com 记录在解决方案中构建每个项目所花费的时间，以便我知道应该将精力集中在哪里？

在这种情况下，改进硬件不是一种选择。

我尝试设置输出详细程度（在工具/选项/项目和解决方案/构建和运行/MSBuild 项目构建输出详细程度下）。这在 IDE 中似乎没有任何影响。

从命令行运行 MSBuild 时（对于 Visual Studio 2008，它需要是 MSBuild v3.5），它会在最后显示经过的总时间，但不会在 IDE 中显示。

我真的很想为解决方案中的每个项目提供一份耗时的报告，以便我可以弄清楚构建过程在哪里花费了时间。

或者，由于我们实际上使用 NAnt 来驱动构建过程（我们使用 Jetbrains TeamCity），有没有办法让 NAnt 告诉我每个步骤所用的时间？

* * *

## 回答 #1

> 赞同：217
> 
> 时间：2008-09-25T10:34:16.823

菜单*工具*→*选项*→*项目和解决方案*→ *VC++ 项目设置*→*构建时间*应该可以工作。

* * *

## 回答 #2

> 赞同：101
> 
> 时间：2008-09-17T11:22:16.720

转到工具 → 选项 → 项目和解决方案 → 构建和运行 → MSBuild 项目构建输出详细程度 - 设置为“正常”或“详细”，构建时间将出现在输出窗口中。

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2014-08-08T12:38:36.690

## 视觉工作室 2012 - 2019

*   **对于 MSBuild 项目（例如所有 .Net-Projects）：**
    单击`Tools -> Options`然后选择`Projects and Solutions -> Build and Run`. 更改`MSBuild project build output verbosity`为`Normal`。所以它会在它构建的每个解决方案项目中显示经过的时间。但不幸的是，所有项目都没有经过时间总和。您还将看到构建开始的时间戳

*   **对于 C/C++ 项目：**

单击`Tools -> Options`，然后选择`Projects and Solutions -> VC++ Project Settings`。

更改`Build Timing`为`Yes`。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2019-01-11T10:49:36.167

我创建了一个扩展来测量构建时间并在图表中显示事件的顺序：[Visual Studio Build Timer](https://marketplace.visualstudio.com/items?itemName=OdysseasPetrocheilos.VisualStudioBuildTimer)。

[![在此处输入图像描述](https://i.stack.imgur.com/KC8EI.png)](https://i.stack.imgur.com/KC8EI.png)

它可在视觉工作室市场获得，适用于 VS2015、VS2017 和 VS2019。

除了显示哪些项目需要更长的时间之外，该图表还有效地显示了它们之间的依赖关系，即需要等待其他项目的项目，这有助于确定需要打破哪些依赖关系以增加构建的并行化。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2013-07-08T12:16:57.033

对于 Visual Studio 2012，您可以使用[Build Monitor](http://visualstudiogallery.msdn.microsoft.com/b0c87e47-f4ee-4935-9a59-f2c81ce692ab)扩展。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-01-16T12:14:36.550

工具->选项->项目和解决方案->构建和运行->

将“MSBuild 项目构建输出详细程度”从“Minimal”设置为“Normal”

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2010-04-07T04:29:02.460

如果你卡在 VS2005 上，你可以使用[vs-build-timer 插件](http://code.google.com/p/vs-build-timer/)。在构建完成时，它会显示所花费的总时间和每个项目持续时间的（可选）摘要。

免责声明；我写的。是的，我需要创建一个安装程序……总有一天！

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-09-17T11:36:27.950

由于您的问题涉及从命令行使用 DevEnv，我还建议使用[MSBuild](http://en.wikipedia.org/wiki/MSBuild)（它可以构建 .sln 文件而无需修改）。

```
msbuild /fl /flp:Verbosity=diagnostic Your.sln 
```

`msbuild /?`将向您展示文件记录器的其他有用选项。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2015-12-06T14:38:34.477

如果您想可视化您的构建，您可以使用 IncrediBuild。作为 Visual Studio 2015 Update 1 的一部分，IncrediBuild 现在以独立模式免费提供（未分发，但仅用于本地计算机上的 8 个内核）

**免责声明：我为 IncrediBuild 工作**

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2015-03-19T14:02:18.993

我最终来到这里是因为我只想在构建输出中包含日期和时间。如果其他人正在搜索类似的东西，就像添加`echo %date% %time%`到项目下的 Pre-build 和/或 Post-build 事件一样简单，*Properties* → *Compile* → *Build Events*。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2015-08-05T08:34:49.980

首先进行构建，然后查看哪个项目首先出现在构建输出中（`Ctrl`+`Home`在输出窗口中）。右键单击该项目 →*项目属性*→*编译*→*构建事件*→*预构建*。和`echo ###########%date% %time%#############`。

因此，每次您看到构建结果（或在构建期间）时，都在输出窗口中执行`Ctrl`+ 。`Home`在那个区域的某个地方，时间和日期盯着你的脸！

哦，由于构建顺序可能会发生变化，您最终可能会将这些细节添加到许多项目中:)

* * *

我找到了更好的解决方案！###

*Tools* → *Options* → *Projects & Solutions* → *Build and Run* → *MSBuild project build output verbosity* = Normal （或高于*Minimal*）。这会在输出窗口的开头/顶部添加时间。`Ctrl`+`Home`在输出窗口应该做。

如果我们想查看每个项目需要多少时间，那么*Projects & Solutions* → *VC++ Project Settings* → *Build Timing = yes*。适用于所有项目；“VC++”具有误导性。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-05-10T12:49:12.950

如果您想调用一个可以跟踪您的总构建时间的外部程序，您可以为 VS 2010（可能更早）使用以下解决方案。下面的代码使用 Casey Muratori 的 CTime。当然，您也可以使用它来简单地打印构建时间。

打开宏资源管理器，并在之前粘贴以下内容`End Module`：

```
Dim buildStart As Date
Private Sub RunCtime(ByVal StartRatherThanEnd As Boolean)
    Dim Arg As String
    Dim psi As New System.Diagnostics.ProcessStartInfo("ctime.exe")
    If StartRatherThanEnd Then
        psi.Arguments = "-begin"
    Else
        psi.Arguments = "-end"
    End If
    psi.Arguments += " c:\my\path\build.ctm"
    psi.RedirectStandardOutput = False
    psi.WindowStyle = ProcessWindowStyle.Hidden
    psi.UseShellExecute = False
    psi.CreateNoWindow = True
    Dim process As System.Diagnostics.Process
    process = System.Diagnostics.Process.Start(psi)
    Dim myOutput As System.IO.StreamReader = process.StandardOutput
    process.WaitForExit(2000)
    If process.HasExited Then
        Dim output As String = myOutput.ReadToEnd
        WriteToBuildWindow("CTime output: " + output)
    End If
End Sub

Private Sub BuildEvents_OnBuildBegin(ByVal Scope As EnvDTE.vsBuildScope, ByVal Action As EnvDTE.vsBuildAction) Handles BuildEvents.OnBuildBegin
    WriteToBuildWindow("Build started!")
    buildStart = Date.Now
    RunCtime(True)
End Sub

Private Sub BuildEvents_OnBuildDone(ByVal Scope As EnvDTE.vsBuildScope, ByVal Action As EnvDTE.vsBuildAction) Handles BuildEvents.OnBuildDone
    Dim buildTime = Date.Now - buildStart
    WriteToBuildWindow(String.Format("Total build time: {0} seconds", buildTime.ToString))
    RunCtime(False)
End Sub

Private Sub WriteToBuildWindow(ByVal message As String)
    Dim win As Window = DTE.Windows.Item(EnvDTE.Constants.vsWindowKindOutput)
    Dim ow As OutputWindow = CType(win.Object, OutputWindow)
    If (Not message.EndsWith(vbCrLf)) Then
        message = message + vbCrLf
    End If
    ow.OutputWindowPanes.Item("Build").OutputString(message)
End Sub 
```

答案取自[这里](https://stackoverflow.com/questions/523220/awesome-visual-studio-macros/2112181#2112181)和[这里](https://blogs.msdn.microsoft.com/vbfaq/2004/05/30/how-can-i-run-another-application-or-batch-file-from-my-visual-basic-net-code/)。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-07-03T10:39:34.323

选项 -> 项目和解决方案 -> VC++ 项目设置 -> 构建时间

[![在此处输入图像描述](https://i.stack.imgur.com/t4ZxA.png)](https://i.stack.imgur.com/t4ZxA.png)

# html - 网页加载时发出 2 个或更多短促的声音

> ID：82141
> 
> 赞同：1
> 
> 时间：2008-09-17T11:22:23.180
> 
> 标签：html, audio

我有 6 个声音文件（1.wav 2.wav 等），每次打开网页时都必须听到其中 3 个不同的声音文件。数字是随机选择的。我尝试了多个“嵌入”，但只产生了最后一个选择的声音。我也尝试过修改 bgsound 属性的 javascript 例程，但是，我一次无法产生多个声音。声音需要在页面打开时自动播放，或者可以通过单击按钮或链接触发，但是，三种声音只能单击一次。还有另一种方法可以做到这一点吗？非常欢迎提出建议。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-17T11:28:42.230

一个简单的 Flash 会比其他任何东西都做得更好。但是请注意，除非您为 Intranet 应用程序开发页面并且该功能是用户特别要求的，否则它很可能会违反 Web 的最佳可用性实践。大多数用户认为产生声音的页面非常分散注意力，如果在页面加载时产生声音，很可能无法将其关闭。如果你想在你的页面中嵌入一些声音，你可以允许用户明确地打开它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T11:25:03.127

如果我想在网页中添加声音，我会使用 Flash，你可以嵌入一个没有宽度或高度的 Flash 文档，这样它就会不可见，但仍然会播放噪音。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-23T20:50:29.513

查看[Sound Manager 2](http://www.schillmania.com/projects/soundmanager2/)一个可用于播放声音的隐形 Flash 电影。它允许您加载和播放多种声音。

为了完成您希望完成的工作，我会将 wav 文件重新编码为 mp3（以便它们下载更快并且声音管理器可以播放它们）。然后使用 javascript 获取声音管理器来创建声音并以随机顺序播放它们。您可以收听每个声音的 onfinish 事件以开始播放下一个声音。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T11:25:14.407

我有一个好主意：**不要**！

我讨厌在没有我告诉他们的情况下播放声音的网站。我使用多标签浏览器和多任务操作系统，而你无法控制我的电脑，所以不要以为你可以播放声音而不会干扰我正在做的其他事情。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T11:44:16.577

如果您不反对使用 JavaScript 框架播放声音，则 scriptaculous 提供了一个用于播放声音的 API。

[http://github.com/madrobby/scriptaculous/wikis/sound](http://github.com/madrobby/scriptaculous/wikis/sound)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T11:25:23.733

浏览器会将页面加载拆分为多个项目，因此它可能会使用多个线程一次加载所有声音。我认为你想要完成的事情是不可能的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T11:37:05.203

我知道这有点过分，但组合的数量并不过分。如果您将 wav 文件预先混合成一系列文件，然后将它们命名如下

```
1_2_3, 1_2_3, 1_2_5, 1_2_6 
1_3_4, 1_3_5, 1_3_6
1_4_5, 1_4_6
2_3_4, 2_3_5, 2_3_6, 
2_4_5, 2_4_6,
2_5_6
3_4_5, 3_4_6,
3_5_6,
4_5_6 
```

（幸好没有太多的组合）

然后只要你这样做：

```
 $n = [ randomnumber , randomnumber , randomnumber ]; 
   $n = sort $n; 
   file = "$n[0]_$n[1]_$n[2].wav" 
```

那应该让它工作。

注意到许多人反对声音，根据您使用的播放技术，它可能/可能不适用于所有人，但这可能是我们应该让浏览器强制执行的功能，因为有些人喜欢能够听到声音（令人震惊，但是是真的 ）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-23T20:39:11.860

添加声音 - HTML 课程 HTML 音乐/媒体代码 - 声音 [http://html-lesson.blogspot.com/2008/06/music-media-code-sound.html](http://html-lesson.blogspot.com/2008/06/music-media-code-sound.html)

# java - 是否有适用于 Lucene 的快速、准确的荧光笔？

> ID：82151
> 
> 赞同：3
> 
> 时间：2008-09-17T11:24:33.800
> 
> 标签：java, lucene

一段时间以来，我一直在使用 (Java) [Highlighter for Lucene](http://lucene.apache.org/java/2_4_1/lucene-sandbox/index.html#Term%20Highlighter)（在 Sandbox 包中）。但是，在匹配搜索结果中的正确术语时，这并不是很准确 - 它适用于简单的查询，例如搜索两个单独的单词会突出显示结果中的两个代码片段。

但是，它不适用于更复杂的查询。在最简单的情况下，诸如“Stack Overflow”之类的短语查询将匹配突出显示中出现的所有 Stack 或 Overflow，这给用户留下了它运行不佳的印象。

[我尝试在此处](http://www.gossamer-threads.com/lists/lucene/java-user/15528)应用此修复程序，但随之而来的是很多性能警告，最终根本无法使用。性能尤其是通配符查询的问题。这是由于突出显示的工作方式；而不是只处理查询字符串和文本，它会像 Lucene 那样解析它，然后查找 Lucene 所做的所有匹配；不幸的是，这意味着对于某些通配符查询，它可以在大型文档中查找与 2000 多个子句匹配的内容，而且速度还不够快。

有没有更快的准确荧光笔实现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-16T18:44:46.017

有一个新的更快的荧光笔（需要修补，但将是 2.9 版的一部分）

[https://issues.apache.org/jira/browse/LUCENE-1522](https://issues.apache.org/jira/browse/LUCENE-1522)

以及对这个问题的[反向引用](https://issues.apache.org/jira/browse/LUCENE-1522?focusedCommentId=12688408&page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#action_12688408)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T16:24:03.017

您可以考虑使用 Solr。[http://lucene.apache.org/solr](http://lucene.apache.org/solr)

Solr 是一种使用 Lucene 并支持突出显示的通用搜索应用程序。Solr 中的突出显示可能可用作 Solr 之外的 API。您还可以查看 Solr 如何获得灵感。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-02T21:49:16.913

我一直在阅读该主题并遇到了[spanQuery](http://lucene.apache.org/java/2_3_1/api/org/apache/lucene/search/spans/SpanQuery.html)，它会返回匹配项的跨度或匹配字段中的项。

# .net - 使用 NAnt 构建设置项目

> ID：82169
> 
> 赞同：1
> 
> 时间：2008-09-17T11:26:19.287
> 
> 标签：.net, deployment, build, continuous-integration, nant

我已经有一个 NAnt 构建脚本，可以一起构建/运行测试/压缩 web 项目等，但我正在开发一个基本的桌面应用程序。我将如何使用 NAnt 构建设置项目，以便我可以将它包含在 TeamCity 的构建报告中。

编辑：设置是 Visual Studio 提供的基本设置项目。这是公司内部的，所以它没有做任何花哨的事情。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-17T11:31:29.460

构建 Visual Studio 安装项目的唯一方法是通过 Visual Studio。您需要在构建机器上安装 VS 的副本，并将其作为命令行工具 (exec devenv.exe) 运行，并带有适当的参数（应该是构建模式（发布或调试）和要构建的项目名称，可能还有其他一些，但您可以运行 devenv /? 来获取不同命令行选项的列表）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T11:37:09.587

已经有几年了，但最后一次我不得不这样做时，我使用了一个名为 Wix 的工具，它有名为 Candle 和 Light 的实用程序。我在我的 NAnt 脚本中使用了这些工具来创建 MSI 安装程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T11:40:37.677

与其尝试使用 MSBUILD（假设）进行构建，不如使用 DEVENV.EXE 构建解决方案或项目。命令行类似于以下内容：

DEVENV MySolutionFile.sln /build DEBUG /project SetupProject.vdproj

您可以将 DEBUG 更改为 RELEASE 或您设置的任何其他构建配置。您也可以省略 /project... 部分来构建整个解决方案。

# python - PyQt 和 PyCairo

> ID：82180
> 
> 赞同：2
> 
> 时间：2008-09-17T11:28:23.260
> 
> 标签：python, qt, gtk, pyqt

我知道可以在 Gtk 绘图区域内放置一个 PyCairo 表面。但我认为 Qt 的使用要好得多，所以我一直想知道是否有办法在某个 Qt 组件中放置 PyCairo 表面？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-17T11:44:49.973

众所周知，Qt 自己的基于 OpenGL 的表面（使用 QPainter）比 Cairo 快得多。你能解释一下为什么你特别想在 Qt 中使用 Cairo 吗？

有关使用 QPainter 的基础知识，请参阅“使用 Qt4 进行 C++ GUI 编程”一书的[摘录](http://www.informit.com/articles/article.aspx?p=1174421)，虽然它是 C++ 代码，但 PyQt 实现将是并行的。

至于用 Qt 加入开罗...... [ArsTechnica 上的这篇文章](http://arstechnica.com/news.ars/post/20080818-nokia-helps-port-firefox-to-qt.html)揭示了一些启示 - 目前似乎没有任何东西可以帮助你（iow.，没有人尝试过这样的婚姻）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-17T11:38:54.957

为了与您一起绘图，还应该考虑 matplotlib，它提供了更高级别的 API 并与 PyQT 很好地集成。

# ruby-on-rails - 使用 RSpec 指定插件的最佳方法是什么？

> ID：82191
> 
> 赞同：-1
> 
> 时间：2008-09-17T11:30:55.983
> 
> 标签：ruby-on-rails, plugins, rspec

我正在创建一个插件，并希望使用 RSpec，以便可以使用 BDD 构建它。

有推荐的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T13:15:32.080

好的，我想我有一个解决方案：

*   通过脚本/生成插件生成插件
*   更改 Rakefile，并添加

`require 'spec/rake/spectask'`

 ````
desc 'Test the PLUGIN_NAME plugin.'
Spec::Rake::SpecTask.new(:spec) do |t|
  t.libs << 'lib'
  t.verbose = true
end 
````  `*   创建一个规范目录，然后像往常一样开始在 *_spec.rb 文件中添加规范

您也可以修改默认任务以运行规范而不是测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T12:40:23.180

有关使用 rspec 的现有插件的示例，请查看 [restful_authentication 插件](http://github.com/technoweenie/restful-authentication/tree/master)。也许会有所帮助。

# sharepoint - 如何在 SharePoint 中自定义 RSS 源

> ID：82214
> 
> 赞同：3
> 
> 时间：2008-09-17T11:36:09.433
> 
> 标签：sharepoint, rss, moss

在 SharePoint 2007 测试版的早期，我遇到了自定义用于从列表中发出 RSS 源的模板的能力。我再也找不到了。有人知道它在哪里吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T11:44:42.440

啊，根据[Jan Tielens 的微妙提示](http://weblogs.asp.net/jan/archive/2006/06/07/YASR_3A00_-RSS-In-SharePoint-2007.aspx)找到了它。它位于列表的“设置”页面上，位于“通信”->“RSS 设置”下。
/_layouts/listsyndication.aspx?List= *<列表ID>*

我可以发誓还有更多，例如您可以自定义的实际模板文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T12:28:38.730

我的搜索，也遇到[*了为内容查询 Web 部件自定义 RSS*](http://msdn.microsoft.com/en-us/library/bb608445.aspx)

“在自定义内容查询 Web 部件以显示所需的字段和内容后，您可以设置 Web 部件以发出该内容的真正简单的联合 (RSS) 提要。”

# sharepoint - 如何在 Sharepoint 列表字段中使用计算的起息日来查找日期+30 天？

> ID：82220
> 
> 赞同：4
> 
> 时间：2008-09-17T11:36:43.880
> 
> 标签：sharepoint

我有一个在 Sharepoint 中构建的列表，其中一个字段是用户输入的日期。我想添加另一个字段，这是一个计算值字段，需要是用户提供的日期+30天。我需要将什么公式传递给计算值字段来实现这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-17T11:49:34.097

试试这个：

1.  创建一个新的计算列
2.  在 Forumla 框中，输入如下内容： =TEXT([existing date column]+30,"yyyy-mm-dd") 您可以使用任何您喜欢的日期格式字符串来代替“yyyy-mm-dd”
3.  将数据类型设为“日期和时间”
4.  将日期和时间格式设为“仅日期”

# java - 从手工制作的休眠映射文件转移到注释是否值得？

> ID：82223
> 
> 赞同：2
> 
> 时间：2008-09-17T11:37:08.590
> 
> 标签：java, hibernate, annotations

我有一个 webapp，其原始代码库是使用手工制作的 hibernate 映射文件开发的。从那时起，我已经相当精通“编码”我的 hbm.xml 文件。但是这些天所有酷孩子都在使用注释。

所以，问题是：重构我的代码以使用休眠注释**是否值得？**除了时髦和现代，我会得到什么吗？我会失去现有的手工编码映射文件中的任何控制权吗？

一个子问题是，**要付出多少努力？** 我喜欢我的数据库精益求精。该映射仅涵盖十几个域对象，包括两个集合、一些子类和大约 8 个表。

亲爱的 SOpedians，提前感谢您提供明智的意见。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-17T11:47:51.200

“如果它没有坏 - 不要修理它！”

无论如何，我是一个老式的 POJO/POCO 类型的人，但为什么要更改注释只是为了酷？据我所知，您可以将大部分内容作为注释来完成，但更复杂的映射有时会更清楚地表示为 XML。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-17T11:46:52.090

使用注释而不是外部映射文件将获得的一件事是，您的映射信息将位于类和字段上，从而提高了可维护性。您添加一个字段，您立即添加注释。你删除一个，你也删除了注释。您重命名一个类或一个字段，注释就在那里，您也可以重命名表或列。您在类继承中进行了更改，它会被考虑在内。您不必稍后再去编辑外部文件。这使得整个事情更高效，更不容易出错。

另一方面，您将失去映射文件曾经为您提供的全局视图。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-17T14:08:20.223

我最近在一个项目中做了两个，发现：

1.  我更喜欢为 XML 编写注释（与 Java 的静态类型、IDE 中的自动完成、重构等配合得很好）。我喜欢看到所有的东西交织在一起，而不是在代码和 XML 之间来回切换。
2.  在您的类中编码数据库信息。有些人觉得这很粗暴和不可接受。我不能说它困扰着我。它必须去某个地方，无论如何我们都将重建 WAR 以进行更改。
3.  我们实际上一直使用 JPA 注释，但肯定存在 JPA 注释不够用的情况，因此不得不使用 Hibernate 注释或配置进行调整。
4.  请注意，您实际上可以同时使用注释和 hbm 文件。可能是一个很好的混合体，它指定注释中的 O 部分和 hbm 文件中的 R 部分，但听起来比它的价值更麻烦。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-17T11:50:05.283

尽管我喜欢继续进行新的和可能更好的事情，但我需要记住不要弄乱没有损坏的东西。因此，如果现在将休眠映射放在单独的文件中对您有用，我不会更改它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T03:36:57.953

我绝对更喜欢注释，两者都使用过。它们更易于维护，而且由于您不需要处理那么多要重新映射的类，我会说这是值得的。注释使重构更容易。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T11:48:48.437

XML 和注释都支持所有功能。您仍然可以使用 xml 声明覆盖您的注释。

至于付出的努力，我认为这是值得的，因为您将能够在一个地方查看所有内容，而无需在代码和 xml 文件之间切换（当然，除非您使用两个监视器；））

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T11:49:22.850

> 使用注释您将获得的唯一好处

我可能会争辩说，这是您希望从使用注释中获得**的东西。**因为您没有使用 NHibernate 获得编译时安全性，所以这是下一个最好的事情。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T14:18:39.987

> “如果它没有坏 - 不要修理它！”

@Macka - 谢谢，我需要听听。并感谢大家的回答。

虽然我处于非常幸运的位置，可以对我的工作进行***大量***的专业和创造性控制，并且可以出于任何原因（排除昂贵的东西）引入几乎任何技术、库或工具，包括*“因为所有很酷的孩子们正在使用它”* ......移植现有项目核心的重要部分并没有什么意义。

一段时间后，我会在一个未开发项目中试用 Hibernate 或 JPA 注释。不幸的是，我很少得到新的完全独立的项目。

# iis-7 - 强制 IIS7 建议在“本地 Intranet”区域下载 *.exe 文件

> ID：82232
> 
> 赞同：0
> 
> 时间：2008-09-17T11:38:39.287
> 
> 标签：iis-7, executable, download

问题：

1.  本地服务器（我们组织内部）上的 html 文件，其中包含指向同一服务器上的 exe 的链接。
2.  单击该链接在客户端上运行 exe。相反，我希望它提供下载。

到目前为止尝试过：

1.  更改了要读取和脚本的 exe 虚拟目录的权限。
2.  在 exe 的目录中添加了 Content-disposition 标头。
3.  我无法更改浏览器中的设置。它的目的是让很多人消费。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T11:41:52.260

您需要`content-disposition`在 HTTP 标头中进行设置。

[此 Microsoft 知识库条目](http://support.microsoft.com/kb/260519)包含有关如何执行此操作的更多详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T11:46:31.907

在哪里运行它们：在服务器上还是在客户端上？如果在服务器上：设置文件的处理程序映射，以便禁用 CGI-exe。如果在客户端：那么这是一个 Web 浏览器问题 - 它不应该直接运行 EXE！它是什么浏览器？

正如 Dave Webb 所提到的，您可以使用*Content-Disposition* HTTP 标头：可以使用IIS7 中的**HTTP 响应标头**为该目录/文件添加这些标头。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2008-09-17T11:43:26.483

是否自动下载或打开文件是浏览器，而不是服务器端设置。

另一种方法是将文件的 MIME 类型更改为 application/octet-stream 或类似的东西，以尝试强制浏览器下载它。

# java - JPA 实体、Oracle 10g 和日历类型属性是否存在问题？

> ID：82235
> 
> 赞同：2
> 
> 时间：2008-09-17T11:38:50.287
> 
> 标签：java, oracle, jpa, ejb-3.0

在将 JPA 实体与 Oracle 10g 结合使用时，我遇到了以下非常烦人的行为。

假设您有以下实体。

```
@Entity
@Table(name = "T_Order")
public class TOrder implements Serializable {
    private static final long serialVersionUID = 2235742302377173533L;

    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private Integer id;

    @Column(name = "activationDate")
    private Calendar activationDate;

    public Integer getId() {
        return id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    public Calendar getActivationDate() {
        return activationDate;
    }

    public void setActivationDate(Calendar activationDate) {
        this.activationDate = activationDate;
    }
} 
```

该实体映射到 Oracle 10g，因此在 DB 中将有一个表`T_ORDER`，其中包含一个主键`NUMBER`列`ID`和一个`TIMESTAMP`列`activationDate`。

假设我创建了一个带有激活日期的类的实例`15\. Sep 2008 00:00AM`。我的本地时区是 CEST，即`GMT+02:00`. 当我持久化这个对象并`T_ORDER`使用 sqlplus 从表中选择数据时，我发现表中实际上`14\. Sep 2008 22:00`是存储的，到目前为止还可以，因为 oracle db 时区是 GMT。

但现在令人讨厌的部分。当我将这个实体读回到我的 JAVA 程序中时，我发现 oracle 时区被忽略并且我得到`14\. Sep 2008 22:00 CEST`，这绝对是错误的。

所以基本上，当写入数据库时​​，将使用时区信息，读取时将被忽略。

有什么解决方案吗？我猜最简单的解决方案是将 oracle dbs 时区设置为`GMT+02`，但不幸的是我不能这样做，因为有其他应用程序使用同一服务器。

我们使用以下技术

MyEclipse 6.5 JPA 和 Hibernate 3.2 Oracle 10g 瘦 JDBC 驱动程序

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T16:57:32.093

出于这个确切原因，您不应该使用日历来访问数据库中的日期。你应该`java.util.Date`这样使用：

```
@Temporal(TemporalType.TIMESTAMP)
@Column(name="activationDate")
public Date getActivationDate() {
    return this.activationDate;
} 
```

`java.util.Date`指向一个时刻，与任何时区无关。日历可用于格式化特定时区或区域设置的日期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T12:11:55.837

我已经在 J​​PA 和时间戳方面遇到了一些问题。我一直在阅读[oracle 论坛](http://forums.oracle.com/forums/thread.jspa?threadID=612075)，请检查以下内容：

*   数据库中的字段应该是 TIMESTAMP_TZ 而不仅仅是 TIMESTAMP
*   尝试添加注释 @Temporal(value = TemporalType.TIMESTAMP)
*   如果您真的不需要时区，请输入日期或时间戳字段。

# java - 测试 StarTeam 操作

> ID：82245
> 
> 赞同：1
> 
> 时间：2008-09-17T11:41:50.433
> 
> 标签：java, unit-testing, starteam

在 Java 应用程序中，我需要通过各种参数（日期、标签）使用 Starteam API 从 Borland Starteam 2006 R2 签出文件。是否有任何框架可以帮助为此类功能编写自动测试？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T13:56:25.353

我不知道；我采用的方法是一个项目，其中包含示例文件，您可以通过各种标准签出，然后验证您期望到达的所有内容，它是正确的文件（哈希匹配）。

你知道他们也发布了一个命令行客户端（stcmd），对吧？对于很多事情，你根本不需要使用 api。

# linux - 如何使用 sudo 将输出重定向到我无权写入的位置？

> ID：82256
> 
> 赞同：1020
> 
> 时间：2008-09-17T11:44:39.820
> 
> 标签：linux, bash, permissions, sudo, io-redirection

我在我们的一个开发 RedHat linux 机器上获得了 sudo 访问权限，我似乎发现自己经常需要将输出重定向到我通常没有写入权限的位置。

问题是，这个人为的例子不起作用：

```
sudo ls -hal /root/ > /root/test.out 
```

我刚收到回复：

```
-bash: /root/test.out: Permission denied 
```

我怎样才能让它工作？

* * *

## 回答 #1

> 赞同：1415
> 
> 时间：2008-09-17T11:48:56.063

您的命令不起作用，因为重定向是由您的 shell 执行的，它没有写入权限`/root/test.out`。输出的重定向**不是**由 sudo 执行的。

有多种解决方案：

*   `-c`使用 sudo 运行 shell 并使用以下选项向它发出命令：

    ```
    sudo sh -c 'ls -hal /root/ > /root/test.out' 
    ```

*   使用您的命令创建一个脚本并使用 sudo 运行该脚本：

    ```
    #!/bin/sh
    ls -hal /root/ > /root/test.out 
    ```

    运行`sudo ls.sh`。如果您不想创建临时文件，请参阅 Steve Bennett 的[回答。](https://stackoverflow.com/a/16514624/12892)

*   启动一个 shell，`sudo -s`然后运行你的命令：

    ```
    [nobody@so]$ sudo -s
    [root@so]# ls -hal /root/ > /root/test.out
    [root@so]# ^D
    [nobody@so]$ 
    ```

*   使用（如果您在使用该选项`sudo tee`时必须逃避很多）：`-c`

    ```
    sudo ls -hal /root/ | sudo tee /root/test.out > /dev/null 
    ```

    需要重定向到来`/dev/null`阻止[**tee**](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/tee.html)输出到屏幕。要*追加*而不是覆盖输出文件 ( `>>`)，请使用`tee -a`or `tee --append`（最后一个特定于[GNU coreutils](https://www.gnu.org/software/coreutils/manual/html_node/tee-invocation.html)）。

感谢[Jd](https://stackoverflow.com/a/82274/12892)、[Adam J. Forster](https://stackoverflow.com/a/82279/12892)和[Johnathan](https://stackoverflow.com/a/82553/12892)提供的第二个、第三个和第四个解决方案。

* * *

## 回答 #2

> 赞同：128
> 
> 时间：2008-09-17T12:26:37.237

这里有人刚刚建议 sudoing tee：

```
sudo ls -hal /root/ | sudo tee /root/test.out > /dev/null 
```

这也可用于将任何命令重定向到您无权访问的目录。它之所以有效，是因为 tee 程序实际上是一个“回显到文件”程序，并且重定向到 /dev/null 是为了阻止它也输出到屏幕，以保持它与上面最初的人为示例相同。

* * *

## 回答 #3

> 赞同：92
> 
> 时间：2011-11-21T14:24:03.270

我自己发现的一个技巧是

```
sudo ls -hal /root/ | sudo dd of=/root/test.out 
```

* * *

## 回答 #4

> 赞同：57
> 
> 时间：2008-09-23T10:10:04.167

问题是**命令**在 下运行`sudo`，但**重定向**在您的用户下运行。这是由 shell 完成的，您几乎无能为力。

```
sudo command > /some/file.log
`-----v-----'`-------v-------'
   command       redirection 
```

绕过这个的通常方法是：

*   将命令包装在您在 sudo 下调用的脚本中。

    如果命令和/或日志文件发生更改，您可以让脚本将这些作为参数。例如：

    ```
    sudo log_script command /log/file.txt 
    ```

*   调用 shell 并将命令行作为参数传递给`-c`

    这对于一次性复合命令特别有用。例如：

    ```
    sudo bash -c "{ command1 arg; command2 arg; } > /log/file.txt" 
    ```

*   安排具有所需权限的管道/子外壳（即 sudo）

    ```
    # Read and append to a file
    cat ./'file1.txt' | sudo tee -a '/log/file.txt' > '/dev/null';

    # Store both stdout and stderr streams in a file
    { command1 arg; command2 arg; } |& sudo tee -a '/log/file.txt' > '/dev/null'; 
    ```

* * *

## 回答 #5

> 赞同：25
> 
> 时间：2013-11-02T01:51:55.570

*澄清一下为什么 tee 选项更可取*

假设您具有执行创建输出的命令的适当权限，如果您将命令的输出通过管道传输到 tee，则只需使用 sudo 提升 tee 的权限并指示 tee 写入（或附加）到相关文件。

在问题中给出的示例中，这意味着：

```
ls -hal /root/ | sudo tee /root/test.out 
```

举几个更实际的例子：

```
# kill off one source of annoying advertisements
echo 127.0.0.1 ad.doubleclick.net | sudo tee -a /etc/hosts

# configure eth4 to come up on boot, set IP and netmask (centos 6.4)
echo -e "ONBOOT=\"YES\"\nIPADDR=10.42.84.168\nPREFIX=24" | sudo tee -a /etc/sysconfig/network-scripts/ifcfg-eth4 
```

在这些示例中的每一个中，您都将获取非特权命令的输出并写入通常只能由 root 写入的文件，这是您问题的根源。

这样做是个好主意，因为生成输出的命令不是以提升的权限执行的。在这里似乎无关紧要，`echo`但是当源命令是您不完全信任的脚本时，这一点至关重要。

请注意，您可以使用 -a 选项 tee 将追加（like `>>`）附加到目标文件而不是覆盖它（like `>`）。

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2013-05-13T03:53:42.623

主题的另一个变体：

```
sudo bash <<EOF
ls -hal /root/ > /root/test.out
EOF 
```

或者当然：

```
echo 'ls -hal /root/ > /root/test.out' | sudo bash 
```

他们有一个（微小的）优势，你不需要记住任何参数`sudo`or `sh`/`bash`

* * *

## 回答 #7

> 赞同：19
> 
> 时间：2008-09-17T11:48:32.307

让 sudo 运行一个 shell，如下所示：

```
sudo sh -c "echo foo > ~root/out" 
```

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2016-06-24T19:48:59.950

我解决这个问题的方法是：

如果您需要写入/替换文件：

```
echo "some text" | sudo tee /path/to/file 
```

如果您需要附加到文件：

```
echo "some text" | sudo tee -a /path/to/file 
```

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2016-07-28T09:27:47.527

并不是要打死马，但是这里使用的答案太多了`tee`，这意味着您必须重定向`stdout`到，`/dev/null`除非您想在屏幕上看到副本。

一个更简单的解决方案是`cat`像这样使用：

```
sudo ls -hal /root/ | sudo bash -c "cat > /root/test.out" 
```

请注意重定向是如何放在引号内的，以便它由一个 shell 启动`sudo`而不是运行它的一个 shell 来评估它。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2008-09-17T11:48:20.777

写个剧本怎么样？

文件名：myscript

```
#!/bin/sh

/bin/ls -lah /root > /root/test.out

# end script 
```

然后使用 sudo 运行脚本：

```
sudo ./myscript 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2013-04-21T12:33:10.003

我会这样做：

```
sudo su -c 'ls -hal /root/ > /root/test.out' 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2008-09-17T11:49:12.053

每当我必须做这样的事情时，我就会成为 root：

```
# sudo -s
# ls -hal /root/ > /root/test.out
# exit 
```

这可能不是最好的方法，但它确实有效。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2013-11-27T04:55:53.950

这是基于涉及的答案`tee`。为了方便起见，我编写了一个小脚本（我称之为`suwrite`）并在`/usr/local/bin/`获得`+x`许可的情况下将其放入：

```
#! /bin/sh
if [ $# = 0 ] ; then
    echo "USAGE: <command writing to stdout> | suwrite [-a] <output file 1> ..." >&2
    exit 1
fi
for arg in "$@" ; do
    if [ ${arg#/dev/} != ${arg} ] ; then
        echo "Found dangerous argument ‘$arg’. Will exit."
        exit 2
    fi
done
sudo tee "$@" > /dev/null 
```

如代码中的**USAGE**所示，您所要做的就是将输出传送到此脚本，然后是所需的超级用户可访问的文件名，如果需要，它将自动提示您输入密码（因为它包括`sudo`）。

```
echo test | suwrite /root/test.txt 
```

请注意，由于这是一个简单的包装器`tee`，它还将接受 tee 的`-a`附加选项，并且还支持同时写入多个文件。

```
echo test2 | suwrite -a /root/test.txt
echo test-multi | suwrite /root/test-a.txt /root/test-b.txt 
```

它还具有一些针对`/dev/`设备写入的简单保护，这是本页评论之一中提到的一个问题。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-17T12:00:45.163

也许您只获得了对某些程序/路径的 sudo 访问权限？那么就没有办法做你想做的事了。（除非你会以某种方式破解它）

如果不是这样，那么也许您可以编写 bash 脚本：

```
cat > myscript.sh
#!/bin/sh
ls -hal /root/ > /root/test.out 
```

按`ctrl`+ `d`：

```
chmod a+x myscript.sh
sudo myscript.sh 
```

希望它有所帮助。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2017-09-21T10:55:03.620

```
sudo at now  
at> echo test > /tmp/test.out  
at> <EOT>  
job 1 at Thu Sep 21 10:49:00 2017 
```

# javascript - HTML 拖放可排序表格

> ID：82259
> 
> 赞同：11
> 
> 时间：2008-09-17T11:44:56.963
> 
> 标签：javascript, html, drag-and-drop, html-table

曾经想要有一个 HTML 拖放可排序表，您可以在其中对行和列进行排序？我知道这是我会为之而死的东西。有很多可排序的列表，但似乎无法找到可排序的表。

我知道您可以非常接近 script.aculo.us 提供的工具，但我遇到了一些跨浏览器问题。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-09-19T08:36:45.573

我使用了 jQuery UI 的可排序插件，效果很好。与此类似的标记：

```
<table id="myTable">
<thead>
<tr><th>ID</th><th>Name</th><th>Details</th></tr>
</thead>
<tbody class="sort">
<tr id="1"><td>1</td><td>Name1</td><td>Details1</td></tr>
<tr id="2"><td>2</td><td>Name1</td><td>Details2</td></tr>
<tr id="3"><td>3</td><td>Name1</td><td>Details3</td></tr>
<tr id="4"><td>4</td><td>Name1</td><td>Details4</td></tr>
</tbody>
</table> 
```

然后在javascript中

```
$('.sort').sortable({
    cursor: 'move',
    axis:   'y',
    update: function(e, ui) {
        href = '/myReorderFunctionURL/';
        $(this).sortable("refresh");
        sorted = $(this).sortable("serialize", 'id');
        $.ajax({
            type:   'POST',
            url:    href,
            data:   sorted,
            success: function(msg) {
                //do something with the sorted data
            }
        });
    }
}); 
```

这会将项目 ID 的序列化版本发布到给定的 URL。这个函数（在我的例子中是 PHP）然后更新数据库中的项目订单。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-17T12:03:30.197

我推荐[jQuery](http://jquery.com/)中的[Sortables](http://docs.jquery.com/UI/Sortables)。你可以在列表项或几乎任何东西上使用它，包括表格。

jQuery 对跨浏览器非常友好，我一直推荐它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-17T12:53:08.953

我过去使用过[dhtmlxGrid](http://www.dhtmlx.com/docs/products/dhtmlxGrid/index.shtml)。除其他外，它还支持拖放行/列、客户端排序（字符串、整数、日期、自定义）和多浏览器支持。

对评论的回应：不，没有发现更好的东西 - 只是从那个项目开始。:-)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-12T10:50:14.257

David Heggie 的回答对我最有用。它可以稍微简洁一点：

```
var sort = function(event, ui) {
  var url = "/myReorderFunctionURL/" + $(this).sortable('serialize');
  $.post(url, null,null,"script");  // sortable("refresh") is automatic
}

$(".sort").sortable({
  cursor: 'move',
  axis: 'y',
  stop: sort
}); 
```

对我有用，具有相同的标记。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T16:33:16.817

大多数框架（Yui、MooTools、jQuery、Prototype/Scriptaculous 等）都具有可排序的列表功能。对每一个做一点研究，然后选择最适合你需要的那个。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T12:14:51.727

如果您不介意 Java，有一个非常方便的 GWT 库，称为[GWT-DND](http://code.google.com/p/gwt-dnd/)，请查看在线演示，了解它的强大功能。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-21T07:07:38.083

如果您发现 .serialize() 在 David Heggie 的解决方案中返回 null，则将 TR 的 id 值设置为“id_1”而不是简单的“1”

例子：

```
<tr id="id_1"><td>1</td><td>Name1</td><td>Details1</td></tr>
<tr id="id_2"><td>2</td><td>Name1</td><td>Details2</td></tr>
<tr id="id_3"><td>3</td><td>Name1</td><td>Details3</td></tr>
<tr id="id_4"><td>4</td><td>Name1</td><td>Details4</td></tr> 
```

以上将序列化为“id[]=1&id[]=2&id[]=3”

您可以使用“=”、“-”或“_”代替“_”。以及除“id”之外的任何其他词。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-02-03T07:01:12.677

我正在使用 JQuery Sortable 来执行此操作，但如果您像我一样使用 Vue.js，这是一个创建自定义 Vue 指令来封装 Sortable 功能的解决方案，我知道 Vue 可拖动，但它不会将表列排序为根据[这里](https://github.com/SortableJS/Vue.Draggable/issues/456)的问题要查看此操作，请[检查此](https://codepen.io/zupkode/pen/VgbRdQ)

**JS代码**

```
Vue.directive("draggable", {
  //adapted from https://codepen.io/kminek/pen/pEdmoo
  inserted: function(el, binding, a) {
    Sortable.create(el, {
      draggable: ".draggable",
      onEnd: function(e) {
        /* vnode.context is the context vue instance: "This is not documented as it's not encouraged to manipulate the vm from directives in Vue 2.0 - instead, directives should be used for low-level DOM manipulation, and higher-level stuff should be solved with components instead. But you can do this if some usecase needs this. */
        // fixme: can this be reworked to use a component?
        // https://github.com/vuejs/vue/issues/4065
        // https://forum.vuejs.org/t/how-can-i-access-the-vm-from-a-custom-directive-in-2-0/2548/3
        // https://github.com/vuejs/vue/issues/2873 "directive interface change"
        // `binding.expression` should be the name of your array from vm.data
        // set the expression like v-draggable="items"

        var clonedItems = a.context[binding.expression].filter(function(item) {
          return item;
        });
        clonedItems.splice(e.newIndex, 0, clonedItems.splice(e.oldIndex, 1)[0]);
        a.context[binding.expression] = [];
        Vue.nextTick(function() {
          a.context[binding.expression] = clonedItems;
        });

      }
    });
  }
});

const cols = [
  {name: "One", id: "one", canMove: false},
  {name: "Two", id: "two", canMove: true},
  {name: "Three", id: "three", canMove: true},
  {name: "Four", id: "four", canMove: true},
]

const rows = [
  {one: "Hi there", two: "I am so excited to test", three: "this column that actually drags and replaces", four: "another column in its place only if both can move"},
  {one: "Hi", two: "I", three: "am", four: "two"},
  {one: "Hi", two: "I", three: "am", four: "three"},
  {one: "Hi", two: "I", three: "am", four: "four"},
  {one: "Hi", two: "I", three: "am", four: "five"},
  {one: "Hi", two: "I", three: "am", four: "six"},
  {one: "Hi", two: "I", three: "am", four: "seven"}
]

Vue.component("datatable", {
  template: "#datatable",
  data() {
    return {
      cols: cols,
      rows: rows
    }
  }
})

new Vue({
  el: "#app"
}) 
```

**CSS**

```
.draggable {
  cursor: move;
}

table.table tbody td {
  white-space: nowrap;
} 
```

**帕格模板 HTML**

```
#app
  datatable

script(type="text/x-template" id="datatable")
  table.table
    thead(v-draggable="cols")
      template(v-for="c in cols")
        th(:class="{draggable: c.canMove}")
          b-dropdown#ddown1.m-md-2(:text='c.name')
            b-dropdown-item First Action
            b-dropdown-item Second Action
            b-dropdown-item Third Action
            b-dropdown-divider
            b-dropdown-item Something else here...
            b-dropdown-item(disabled='') Disabled action

    tbody
      template(v-for="row in rows")
        tr
          template(v-for="(col, index) in cols")
            td {{row[col.id]}} 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-09-17T11:52:38.817

排序表怎么[样](http://www.kryogenix.org/code/browser/sorttable/)？这似乎很符合您的要求。

它相当容易使用 - 加载 sorttable Javascript 文件，然后，对于您希望它可排序的每个表，将 class="sortable" 应用于 <table> 标记。

它会立即了解如何对大多数类型的数据进行排序，但如果有一些它没有，您可以添加自定义排序键来告诉它如何排序。该文档很好地解释了这一切。

# video - wmv 文件的伪流

> ID：82264
> 
> 赞同：1
> 
> 时间：2008-09-17T11:46:48.393
> 
> 标签：video, streaming, wmv

是否可以使用 wmv 文件和 silverlight 进行伪流（例如在任何时候开始播放）？

这可以在渐进式下载设置中使用 Flash，但可以在 Microsoft 轨道上完成吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T18:58:03.833

您可以**使用[Windows Media Services 2008](http://www.microsoft.com/windows/windowsmedia/forpros/server/version.aspx)**。它使您能够真正将 WMV 流式传输到 Silverlight 界面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-05T20:35:47.667

没有理由你不能像任何其他 HTTP 视频一样流式传输它；它基本上只是希望文件是正确的 WMV 文件。不过，您需要有一个支持搜索的服务器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-29T12:26:05.940

自从提出这个问题后，Microsoft 发布了[Smooth Streaming](http://www.iis.net/extensions/SmoothStreaming)，这正是我所要求的以及更多。

显然，这是最好的 Silverlight 解决方案，尽管您在后端确实需要 Windows Server 2008。

# citrix - 从 Citrix 上托管的应用程序启动本地邮件客户端

> ID：82266
> 
> 赞同：0
> 
> 时间：2008-09-17T11:47:04.027
> 
> 标签：citrix

我有一个桌面应用程序（Windows 窗体），我的客户端托管在 Citrix 服务器上。我想启动用户本地配置的邮件客户端以从我的应用程序发送邮件。我该怎么做呢？

除此之外，我还需要在发送之前将文件附加到电子邮件中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T13:33:09.653

我完全不确定 Citrix 客户端将如何处理`mailto:`链接（或者您是否可以对其进行配置），但如果您还没有尝试过，我建议您这样做。

例子：

```
mailto:someone@example.com?subject=hello&body=see+attachment&attachment=\\host\path-to\file.foo 
```

另请注意，并非所有电子邮件客户端都支持`mailto`URL 中的附件参数。

# parsing - cygwin中命令行文件解析工具

> ID：82268
> 
> 赞同：0
> 
> 时间：2008-09-17T11:47:43.290
> 
> 标签：parsing, cygwin

我必须处理各种格式的文本文件。这是一个示例（**A**列和**B**列以制表符分隔）：

```
A   B
a   Name1=Val1, Name2=Val2, Name3=Val3
b   Name1=Val4, Name3=Val5
c   Name1=Val6, Name2=Val7, Name3=Val8 
```

这些文件可能有标题，也可能没有标题，有混合的分隔方案，有上面的名称/值对的列等。
我经常需要以各种方式从这些文件中提取数据。例如，从上面的数据中，我可能想要与 Name2 相关联的值。IE

```
A   B
a   Val2
c   Val7 
```

有哪些工具/技术可以执行诸如单行命令之类的操作，以上述为例，但可以扩展到其他情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T11:49:36.967

您可以使用所有基本的 bash shell 命令，例如 grep、cut、sed 和 awk。您还可以将 Perl 或 Ruby 用于更复杂的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T12:04:23.267

我不太喜欢 sed，但它适用于这样的事情：

```
var="Name2";sed -n "1p;s/\([^ ]*\) .*$var=\([^ ,]*\).*/\1 \2/p" < filename 
```

给你：

```
 A B
 a Val2
 c Val7 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T11:51:42.330

从我所看到的情况来看，我会从 Awk 开始做这类事情，然后如果你需要更复杂的东西，我会继续使用 Python。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T11:53:04.790

我会使用 sed：

```
 # print section of file between two regular expressions (inclusive)
   sed -n '/Iowa/,/Montana/p'             # case sensitive 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T12:00:40.810

既然你有 cygwin，我会选择 Perl。它是最容易学习的（查看 O'Reily 的书：[Learning Perl](http://books.google.com/books?id=bS--s5DAIHsC&dq=%22learning+perl%22&pg=PP1&ots=udTVanap5Y&sig=gJW55LqGpEXCHqRMgHfTJ8nmP70&hl=en&sa=X&oi=book_result&resnum=1&ct=result)）并且应用广泛。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T12:27:05.240

我会使用 Perl。编写一个小模块（或多个模块）来处理不同的格式。然后，您可以使用该库运行 perl oneliners。示例如下：

```
perl -e 'use Parser;' -e 'parser("in.input").get("Name2");' 
```

不要引用我的语法，但这是一般的想法。抽象手头的任务，让你思考你需要做什么，而不是你需要如何去做。Ruby 将是另一种选择，它往往具有更简洁的语法，但任何一种语言都可以工作。

# sharepoint - 如何在 SharePoint 的多个列表中使用相同的字段类型？

> ID：82269
> 
> 赞同：0
> 
> 时间：2008-09-17T11:47:47.410
> 
> 标签：sharepoint

我有一个包含多个列表的 SharePoint 网站，其中一些具有相同的字段 - 产品或国家/地区的选择。

如何以我配置选择字段一次并在多个列表中使用它的方式构建列表，以便将来，如果我向选择添加一个值，我只添加一次？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T12:41:38.107

如果您转到站点设置，则在画廊下有一个站点列选项。您可以在那里创建您的选择列表。然后，在库设置下，有一个从现有站点列添加的选项。您应该能够在那里看到并选择您新创建的列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T12:34:57.843

您应该创建一个包含国家/地区的列表。然后在您要重复使用国家/地区查找的列表中，创建查找类型的列并在“获取信息”下拉列表中选择国家/地区列表。

这是一个更直观的指南的链接： [http ://blog.phase2int.com/?p=101](http://blog.phase2int.com/?p=101)

# sharepoint - 将共享文档子文件夹作为 Web 部件放置在 SharePoint 中

> ID：82286
> 
> 赞同：3
> 
> 时间：2008-09-17T11:50:04.300
> 
> 标签：sharepoint

我想在包含 SharePoint 中文档库子文件夹的页面上放置一个 Webpart，但不知何故，我得到的唯一东西是文档库的根文件夹。

是否有满足这种需求的 Webpart？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T14:47:18.340

以下是在 Sharepoint 2010 中仅使用 Javascript 而不需要 SharePoint Designer 的方法。

1.  在 Web 部件页面上创建文档库 Web 部件
2.  更改视图以显示没有文件夹的所有项目并将项目限制设置为足够大的数量，以便没有批次
3.  在文档库 Web部件*下方*添加内容编辑器 Web部件
4.  添加以下 javascript 并更改第一个变量以满足您的需要

注意：如果您有多个文档库 Web 部件，则需要添加到此代码。

```
<script type="text/javascript" language="javascript">

    //change this to meet your needs
    var patt = /FOLDER%20TO%20SEARCH/gi; 
    var x = document.getElementsByTagName("TD"); // find all of the TDs
    var i=0; 

    for (i=0;i<x.length;i++)
    {
        if (x[i].className =="ms-vb-title") //find the TDs styled for documents
        {
            var y = x[i].getElementsByTagName("A");  //this gets the URL linked to the name field
            //conveniently the URL is the first variable in the array. YMMV.
            var title = y[0];  

            //search for pattern
            var result = patt.test(title);

            //If the pattern isn't in that row, do not display the row
            if ( !result )
            {
                x[i].parentNode.style.display = "none"; //and hide the row            
            }
        }
    }   
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T12:11:03.343

默认情况下，我认为这是不可能的。

将显示共享文档的列表 Web 部件了解如何呈现库，但不了解如何过滤以仅显示一个子文件夹的内容。

最好创建一个筛选器 Web 部件并将该筛选器提供给列表 Web 部件，以便它根据文档库的 fileref 字段中定义的子文件夹进行筛选。然而，它似乎能够使用的过滤器是类型、修改和修改者。因此，您可以将其过滤到您触摸的文档，而不是给定位置的文档。

最终结果：滚动您自己的 Web 部件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-01T02:50:58.670

原因是webpart选择的文件夹不是由webpart本身控制的，而是由一个querystring参数控制的。

例如

```
"?RootFolder=%2fDocuments%2fMyFolder1&FolderCTID=" 
```

所以文件夹不是“真正的”文件夹，尽管“谎言”是 webdav 界面，例如`\\sharepointsite\documents`

应该有一种方法可以包含所需的 RootFolder 参数，例如链接到包含查询字符串的页面（远非理想）。

我不知道有任何网络部件可以做到这一点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-02T22:17:46.513

我可以通过创建一个新列并为整个共享文档列表指定一个关键字来做到这一点。

然后我必须添加元数据。将 WebPart 再次添加到页面。创建一个可以将文件显示为平面列表的视图，并在新列上进行过滤（即关键字所在/包含----）。然后我在带有 Web 部件的页面上获得我想要的列表。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-03-24T08:29:16.117

我有一个不需要 Designer 的解决方法。没有那么优雅，但任何高级用户都可以实现。

添加库 Web 部件后，转到页面并向下单击要设为默认文件夹的文件夹。看到页面链接现在显示如下内容： `www.mysite.com/sharepoint/default.aspx?RootFolder=%2Fsubfoldername&FolderCTID=...`

复制那个链接。删除`&FolderCTID`以及随后的所有内容。在这种情况下，剩下的是：
`www.mysite.com/sharepoint/default.aspx?RootFolder=%2Fsubfoldername`

使用此链接导航到页面，库将在该页面中按您的需要显示。请注意，它不会替换该页面的默认视图。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-11-06T16:35:25.733

面对此问题的另一种方法是仅使用内容搜索 WebPart (CSWP) 并根据以下内容过滤结果：

*   文件夹路径
*   网址深度

您将需要一个符合您要求的 UrlDepth 值。最好的办法是使用一个较高的值，比如 10，然后减少，直到它只显示您需要的文件。关于文件夹路径，删除（引号）“，这样查询将执行“包含”查找，而不是“等于”：

结果将是这样的：

```
path:[your site]/Docs/our_team  UrlDepth:7 
```

如果**文件夹名称包含空格**，您可能需要用引号将其括起来。就像是：

```
path:[your site]/Docs/"our team" 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-01-14T22:32:29.797

我使用的一种替代方法是将页面查看器 Web 部件放在页面上，然后选择“文件夹”作为要查看的内容类型。然后将 webdav UNC 指定到文件夹，例如“\some_sharepoint-site\some_site\shared documents\some_folder\”

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-12-17T16:36:55.230

将文档库列表视图 Web 部件放置在任何页面上。编辑 Web 部件。从过滤器中选择列“内容类型”和值“文件夹”保存，您就完成了。

通过这样做，它只会向您显示根文件夹文件。

# java - 是否可以构建 Linux/Motif Eclipse RCP 应用程序？

> ID：82305
> 
> 赞同：1
> 
> 时间：2008-09-17T11:54:53.413
> 
> 标签：java, linux, eclipse, rcp, motif

我正在尝试构建一个适用于 linux/motif 安装目标的 Eclipse 应用程序。但是，即使产品导出向导中提供了导出选项，这似乎也不可能。

我检查了 delta 包的内容，确实缺少 linux/motif 的包。检查 eclipse 3.4 的下载页面后：http: [//download.eclipse.org/eclipse/downloads/drops/R-3.4-200806172000/index.php](http://download.eclipse.org/eclipse/downloads/drops/R-3.4-200806172000/index.php)

我看到即使有一个标记为 Linux/motif 的 Eclipse 版本，它也被标记为***Testing only***。此外，此目标没有增量包。

有没有人成功构建了一个针对 linux/motif 的 RCP 应用程序？如果我下载这个仅测试版本的 Eclipse 并复制缺少的插件，它会起作用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T12:04:59.537

我们有一个类似的问题。我们正在构建 Eclipse 应用程序，我们的平台之一是 Solaris 10 x86，它在 3.2 中作为早期访问版本在短时间内受到支持，后来被放弃。我相信 3.2 和 3.3 支持的主题，所以你最好的选择可能是恢复到旧版本的 Eclipse。我在 3.4 中开发，当我们执行 Solaris 特定版本时，我们切换回 3.2，通常需要大约 10 分钟的更改来修复以前版本的所有内容。通常它会在几个位置删除 @overides 并更改 Eclipse 不再使用的一两个函数。

您可以做的另一件事是获取 Eclipse 的 Linux/Motif 包，并将其安装在运行 Motif 的 Linux 机器上。在该 Eclipse 机器上检查您的项目并将其导出到那里。我试用了 VirtualBox（来自 Sun Microsystems 的免费虚拟机），它应该会让您轻松。

# c# - How can I determine the length (i.e. duration) of a .wav file in C#?

> ID：82319
> 
> 赞同：30
> 
> 时间：2008-09-17T11:58:10.677
> 
> 标签：c#, audio, compression

In the uncompressed situation I know I need to read the wav header, pull out the number of channels, bits, and sample rate and work it out from there: (channels) * (bits) * (samples/s) * (seconds) = (filesize)

Is there a simpler way - a free library, or something in the .net framework perhaps?

How would I do this if the .wav file is compressed (with the mpeg codec for example)?

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2011-11-18T11:49:31.957

Download NAudio.dll from the link [https://www.dll-files.com/naudio.dll.html](https://www.dll-files.com/naudio.dll.html)

and then use this function

```
public static TimeSpan GetWavFileDuration(string fileName)       
{     
    WaveFileReader wf = new WaveFileReader(fileName);
    return wf.TotalTime; 
} 
```

you will get the Duration

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-09-17T12:11:20.613

You may consider using the mciSendString(...) function (error checking is omitted for clarity):

```
using System;
using System.Text;
using System.Runtime.InteropServices;

namespace Sound
{
    public static class SoundInfo
    {
        [DllImport("winmm.dll")]
        private static extern uint mciSendString(
            string command,
            StringBuilder returnValue,
            int returnLength,
            IntPtr winHandle);

        public static int GetSoundLength(string fileName)
        {
            StringBuilder lengthBuf = new StringBuilder(32);

            mciSendString(string.Format("open \"{0}\" type waveaudio alias wave", fileName), null, 0, IntPtr.Zero);
            mciSendString("status wave length", lengthBuf, lengthBuf.Capacity, IntPtr.Zero);
            mciSendString("close wave", null, 0, IntPtr.Zero);

            int length = 0;
            int.TryParse(lengthBuf.ToString(), out length);

            return length;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-28T11:54:24.040

I had difficulties with the example of the MediaPlayer-class above. It could take some time, before the player has opened the file. In the "real world" you have to register for the MediaOpened-event, after that has fired, the NaturalDuration is valid. In a console-app you just have to wait a few seconds after the open.

```
using System;
using System.Text;
using System.Windows.Media;
using System.Windows;

namespace ConsoleApplication2
{
  class Program
  {
    static void Main(string[] args)
    {
      if (args.Length == 0)
        return;
      Console.Write(args[0] + ": ");
      MediaPlayer player = new MediaPlayer();
      Uri path = new Uri(args[0]);
      player.Open(path);
      TimeSpan maxWaitTime = TimeSpan.FromSeconds(10);
      DateTime end = DateTime.Now + maxWaitTime;
      while (DateTime.Now < end)
      {
        System.Threading.Thread.Sleep(100);
        Duration duration = player.NaturalDuration;
        if (duration.HasTimeSpan)
        {
          Console.WriteLine(duration.TimeSpan.ToString());
          break;
        }
      }
      player.Close();
    }
  }
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-01-05T22:55:07.693

Not to take anything away from the answer already accepted, but I was able to get the duration of an audio file (several different formats, including AC3, which is what I needed at the time) using the `Microsoft.DirectX.AudioVideoPlayBack` namespace. This is part of [DirectX 9.0 for Managed Code](http://msdn.microsoft.com/en-us/library/bb318658(VS.85).aspx). Adding a reference to that made my code as simple as this...

```
Public Shared Function GetDuration(ByVal Path As String) As Integer
    If File.Exists(Path) Then
        Return CInt(New Audio(Path, False).Duration)
    Else
        Throw New FileNotFoundException("Audio File Not Found: " & Path)
    End If
End Function 
```

And it's pretty fast, too! Here's a reference for the [Audio](http://msdn.microsoft.com/en-us/library/bb324224(VS.85).aspx) class.

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-12-02T13:21:00.537

Yes, There is a free library that can be used to get time duration of Audio file. This library also provides many more functionalities.

[**TagLib**](http://taglib.org/)

TagLib is distributed under the GNU Lesser General Public License (LGPL) and Mozilla Public License (MPL).

I implemented below code that returns time duration in seconds.

```
using TagLib.Mpeg;

public static double GetSoundLength(string FilePath)
{
    AudioFile ObjAF = new AudioFile(FilePath);
    return ObjAF.Properties.Duration.TotalSeconds;
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-17T12:10:12.333

In the .net framework there is a mediaplayer class:

[http://msdn.microsoft.com/en-us/library/system.windows.media.mediaplayer_members.aspx](http://msdn.microsoft.com/en-us/library/system.windows.media.mediaplayer_members.aspx)

Here is an example:

[http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=2667714&SiteID=1&pageid=0#2685871](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=2667714&SiteID=1&pageid=0#2685871)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-02-01T16:05:42.227

Try code below from [How to determine the length of a .wav file in C#](http://alvas.net/alvas.audio,tips.aspx#tip25)

```
 string path = @"c:\test.wav";
    WaveReader wr = new WaveReader(File.OpenRead(path));
    int durationInMS = wr.GetDurationInMS();
    wr.Close(); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-01-15T04:17:18.237

i have tested blew code would fail,file formats are like "\\ip\dir\*.wav'

```
 public static class SoundInfo
   {
     [DllImport("winmm.dll")]
     private static extern uint mciSendString
     (
        string command,
        StringBuilder returnValue,
        int returnLength,
        IntPtr winHandle
     );

     public static int GetSoundLength(string fileName)
      {
        StringBuilder lengthBuf = new StringBuilder(32);

        mciSendString(string.Format("open \"{0}\" type waveaudio alias wave", fileName), null, 0, IntPtr.Zero);
        mciSendString("status wave length", lengthBuf, lengthBuf.Capacity, IntPtr.Zero);
        mciSendString("close wave", null, 0, IntPtr.Zero);

        int length = 0;
        int.TryParse(lengthBuf.ToString(), out length);

        return length;
    }
} 
```

while naudio works

```
 public static int GetSoundLength(string fileName)
     {
        using (WaveFileReader wf = new WaveFileReader(fileName))
        {
            return (int)wf.TotalTime.TotalMilliseconds;
        }
     }` 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-17T12:02:46.483

You might find that the [XNA library](http://msdn.microsoft.com/en-us/xna/default.aspx) has some support for working with WAV's etc. if you are willing to go down that route. It is designed to work with C# for game programming, so might just take care of what you need.

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-17T12:06:03.170

There's a bit of a tutorial (with - presumably - working code you can leverage) over at [CodeProject](http://www.codeproject.com/KB/audio-video/WaveEdit.aspx).

The only thing you have to be a little careful of is that it's perfectly "normal" for a WAV file to be composed of multiple chunks - so you have to scoot over the entire file to ensure that all chunks are accounted for.

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-17T12:07:53.320

What exactly is your application doing with compressed WAVs? Compressed WAV files are always tricky - I always try and use an alternative container format in this case such as OGG or WMA files. The XNA libraries tend to be designed to work with specific formats - although it is possible that within XACT you'll find a more generic wav playback method. A possible alternative is to look into the SDL C# port, although I've only ever used it to play uncompressed WAVs - once opened you can query the number of samples to determine the length.

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-17T12:14:21.620

I'm gonna have to say [MediaInfo](http://mediainfo.sourceforge.net/en), I have been using it for over a year with a audio/video encoding application I'm working on. It gives all the information for wav files along with almost every other format.

[MediaInfoDll](http://sourceforge.net/project/showfiles.php?group_id=86862&package_id=90614) Comes with sample C# code on how to get it working.

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-17T13:36:02.767

I'm going to assume that you're somewhat familiar with the structure of a .WAV file : it contains a WAVEFORMATEX header struct, followed by a number of other structs (or "chunks") containing various kinds of information. See [Wikipedia](http://en.wikipedia.org/wiki/WAV) for more info on the file format.

First, iterate through the .wav file and add up the the unpadded lengths of the "data" chunks (the "data" chunk contains the audio data for the file; usually there is only one of these, but it's possible that there could be more than one). You now have the total size, in bytes, of the audio data.

Next, get the "average bytes per second" member of the WAVEFORMATEX header struct of the file.

Finally, divide the total size of the audio data by the average bytes per second - this will give you the duration of the file, in seconds.

This works reasonably well for uncompressed and compressed files.

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-10-22T12:44:59.130

time = FileLength / (Sample Rate * Channels * Bits per sample /8)

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2012-09-13T23:20:14.917

```
Imports System.IO
Imports System.Text

Imports System.Math
Imports System.BitConverter

Public Class PulseCodeModulation
    ' Pulse Code Modulation WAV (RIFF) file layout

    ' Header chunk

    ' Type   Byte Offset  Description
    ' Dword       0       Always ASCII "RIFF"
    ' Dword       4       Number of bytes in the file after this value (= File Size - 8)
    ' Dword       8       Always ASCII "WAVE"

    ' Format Chunk

    ' Type   Byte Offset  Description
    ' Dword       12      Always ASCII "fmt "
    ' Dword       16      Number of bytes in this chunk after this value
    ' Word        20      Data format PCM = 1 (i.e. Linear quantization)
    ' Word        22      Channels Mono = 1, Stereo = 2
    ' Dword       24      Sample Rate per second e.g. 8000, 44100
    ' Dword       28      Byte Rate per second (= Sample Rate * Channels * (Bits Per Sample / 8))
    ' Word        32      Block Align (= Channels * (Bits Per Sample / 8))
    ' Word        34      Bits Per Sample e.g. 8, 16

    ' Data Chunk

    ' Type   Byte Offset  Description
    ' Dword       36      Always ASCII "data"
    ' Dword       40      The number of bytes of sound data (Samples * Channels * (Bits Per Sample / 8))
    ' Buffer      44      The sound data

    Dim HeaderData(43) As Byte

    Private AudioFileReference As String

    Public Sub New(ByVal AudioFileReference As String)
        Try
            Me.HeaderData = Read(AudioFileReference, 0, Me.HeaderData.Length)
        Catch Exception As Exception
            Throw
        End Try

        'Validate file format

        Dim Encoder As New UTF8Encoding()

        If "RIFF" <> Encoder.GetString(BlockCopy(Me.HeaderData, 0, 4)) Or _
            "WAVE" <> Encoder.GetString(BlockCopy(Me.HeaderData, 8, 4)) Or _
            "fmt " <> Encoder.GetString(BlockCopy(Me.HeaderData, 12, 4)) Or _
            "data" <> Encoder.GetString(BlockCopy(Me.HeaderData, 36, 4)) Or _
            16 <> ToUInt32(BlockCopy(Me.HeaderData, 16, 4), 0) Or _
            1 <> ToUInt16(BlockCopy(Me.HeaderData, 20, 2), 0) _
        Then
            Throw New InvalidDataException("Invalid PCM WAV file")
        End If

        Me.AudioFileReference = AudioFileReference
    End Sub

    ReadOnly Property Channels() As Integer
        Get
            Return ToUInt16(BlockCopy(Me.HeaderData, 22, 2), 0) 'mono = 1, stereo = 2
        End Get
    End Property

    ReadOnly Property SampleRate() As Integer
        Get
            Return ToUInt32(BlockCopy(Me.HeaderData, 24, 4), 0) 'per second
        End Get
    End Property

    ReadOnly Property ByteRate() As Integer
        Get
            Return ToUInt32(BlockCopy(Me.HeaderData, 28, 4), 0) 'sample rate * channels * (bits per channel / 8)
        End Get
    End Property

    ReadOnly Property BlockAlign() As Integer
        Get
            Return ToUInt16(BlockCopy(Me.HeaderData, 32, 2), 0) 'channels * (bits per sample / 8)
        End Get
    End Property

    ReadOnly Property BitsPerSample() As Integer
        Get
            Return ToUInt16(BlockCopy(Me.HeaderData, 34, 2), 0)
        End Get
    End Property

    ReadOnly Property Duration() As Integer
        Get
            Dim Size As Double = ToUInt32(BlockCopy(Me.HeaderData, 40, 4), 0)
            Dim ByteRate As Double = ToUInt32(BlockCopy(Me.HeaderData, 28, 4), 0)
            Return Ceiling(Size / ByteRate)
        End Get
    End Property

    Public Sub Play()
        Try
            My.Computer.Audio.Play(Me.AudioFileReference, AudioPlayMode.Background)
        Catch Exception As Exception
            Throw
        End Try
    End Sub

    Public Sub Play(playMode As AudioPlayMode)
        Try
            My.Computer.Audio.Play(Me.AudioFileReference, playMode)
        Catch Exception As Exception
            Throw
        End Try
    End Sub

    Private Function Read(AudioFileReference As String, ByVal Offset As Long, ByVal Bytes As Long) As Byte()
        Dim inputFile As System.IO.FileStream

        Try
            inputFile = IO.File.Open(AudioFileReference, IO.FileMode.Open)
        Catch Exception As FileNotFoundException
            Throw New FileNotFoundException("PCM WAV file not found")
        Catch Exception As Exception
            Throw
        End Try

        Dim BytesRead As Long
        Dim Buffer(Bytes - 1) As Byte

        Try
            BytesRead = inputFile.Read(Buffer, Offset, Bytes)
        Catch Exception As Exception
            Throw
        Finally
            Try
                inputFile.Close()
            Catch Exception As Exception
                'Eat the second exception so as to not mask the previous exception
            End Try
        End Try

        If BytesRead < Bytes Then
            Throw New InvalidDataException("PCM WAV file read failed")
        End If

        Return Buffer
    End Function

    Private Function BlockCopy(ByRef Source As Byte(), ByVal Offset As Long, ByVal Bytes As Long) As Byte()
        Dim Destination(Bytes - 1) As Byte

        Try
            Buffer.BlockCopy(Source, Offset, Destination, 0, Bytes)
        Catch Exception As Exception
            Throw
        End Try

        Return Destination
    End Function
End Class 
```

# wpf - 如何在 XAML 中根据窗口或屏幕大小设置网格列 MaxWidth

> ID：82323
> 
> 赞同：9
> 
> 时间：2008-09-17T11:59:44.557
> 
> 标签：wpf, xaml, width, actualwidth

我在一个窗口中有一个 3 列网格，第一列上有一个 GridSplitter。我想将第一列的 MaxWidth 设置为父窗口或页面`Width`（或`ActualWidth`）的三分之一，如果可能的话，我更愿意在 XAML 中执行此操作。

这是在 XamlPad（或类似）中使用的一些示例 XAML，它显示了我在做什么。

```
<Page xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:sys="clr-namespace:System;assembly=mscorlib" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" >
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition x:Name="Column1" Width="200"/>
            <ColumnDefinition x:Name="Column2" MinWidth="50" />
            <ColumnDefinition x:Name="Column3" Width="{ Binding ElementName=Column1, Path=Width }"/>
            </Grid.ColumnDefinitions>

        <Label Grid.Column="0" Background="Green" />
        <GridSplitter Grid.Column="0" Width="5" />
        <Label Grid.Column="1" Background="Yellow" />
        <Label Grid.Column="2" Background="Red" />
    </Grid>
</Page> 
```

如您所见，右列的宽度与第一列的宽度绑定，因此当您使用拆分器滑动左列时，右列也会这样做:) 如果您将左列向右滑动，最终它将滑过页面/窗口的一半并滑到窗口的右侧，推开第 2 列和第 3 列。

我想通过将第 1 列的 MaxWidth 设置为窗口宽度的三分之一（或类似的东西）来防止这种情况。我可以很容易地在后面的代码中做到这一点，但是如何在“仅 XAML”中做到这一点？

***编辑：****大卫施密特建议使用 SharedSizeGroup 而不是绑定，这是一个很好的建议。我的示例代码将如下所示：*

```
<Page xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:sys="clr-namespace:System;assembly=mscorlib" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" >
        <Grid IsSharedSizeScope="True">
            <Grid.ColumnDefinitions>
                <ColumnDefinition x:Name="Column1" SharedSizeGroup="ColWidth" Width="40"/>
                <ColumnDefinition x:Name="Column2" MinWidth="50" Width="*" />
                <ColumnDefinition x:Name="Column3" SharedSizeGroup="ColWidth"/>
            </Grid.ColumnDefinitions>
            <Label Grid.Column="0" Background="Green" />
            <GridSplitter Grid.Column="0" Width="5" />
            <Label Grid.Column="1" Background="Yellow" />
            <Label Grid.Column="2" Background="Red" />
        </Grid>
</Page> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-01T14:10:28.023

我认为仅 XAML 的方法有些迂回，但这是一种方法。

```
<Page xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
      xmlns:sys="clr-namespace:System;assembly=mscorlib"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" >

    <!-- This contains our real grid, and a reference grid for binding the layout-->
    <Grid x:Name="Container">

      <!-- hidden because it's behind the grid below -->
      <Grid x:Name="LayoutReference">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*"/>
          <ColumnDefinition Width="*"/>
          <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <!-- We need the border, because the column doesn't have an ActualWidth -->
        <Border x:Name="ReferenceBorder" 
                Background="Black" />
        <Border Background="White" Grid.Column="1" />
        <Border Background="Black" Grid.Column="2" />
      </Grid>

      <!-- I made this transparent, so we can see the reference -->
      <Grid Opacity="0.9">
          <Grid.ColumnDefinitions>
              <ColumnDefinition x:Name="Column1" 
                                MaxWidth="{Binding ElementName=ReferenceBorder,Path=ActualWidth}"/>
              <ColumnDefinition x:Name="Column2" 
                                MinWidth="50"  />
              <ColumnDefinition x:Name="Column3" 
                                Width="{ Binding ElementName=Column1, Path=Width }"/>
              </Grid.ColumnDefinitions>

          <Label Grid.Column="0" Background="Green"/>
          <GridSplitter Grid.Column="0" Width="5" />
          <Label Grid.Column="1" Background="Yellow" />
          <Label Grid.Column="2" Background="Red" />
      </Grid>
    </Grid>

</Page> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T16:43:14.203

懒得自己写出来，但你应该能够使用数学转换器并绑定到你的父窗口宽度（通过名称，或使用 RelativeSource 祖先搜索）。

```
//I know I borrowed this from someone, sorry I forgot to add a comment from whom
public class ScaledValueConverter : IValueConverter
{
  public Object Convert(Object value, Type targetType, Object parameter, System.Globalization.CultureInfo culture)
  {
     Double scalingFactor = 0;
     if (parameter != null)
     {
        Double.TryParse((String)(parameter), out scalingFactor);
     }

     if (scalingFactor == 0.0d)
     {
        return Double.NaN;
     }

     return (Double)value * scalingFactor;
  }

  public Object ConvertBack(Object value, Type targetType, Object parameter, System.Globalization.CultureInfo culture)
  {
     throw new Exception("The method or operation is not implemented.");
  }
} 
```

# c# - 使用 CreateItemFromTemplate 处理 olEmbeddeditem Outlook 附件

> ID：82332
> 
> 赞同：0
> 
> 时间：2008-09-17T12:01:15.177
> 
> 标签：c#, .net, outlook, attachment

我正在使用 C# 处理 Outlook 收件箱中包含附件的邮件。其中一个附件属于 olEmbeddeditem 类型。我需要能够处理该附件的内容。据我所知，我需要将附件保存到磁盘并使用 CreateItemFromTemplate 来返回一个对象。

我遇到的问题是 olEmbeddeditem 可以是任何 Outlook 对象类型 MailItem、ContactItem、MeetingItem 等。您如何知道特定 olEmbeddeditem 附件将是哪种对象类型，以便您知道将返回的对象从模板创建项目？

或者，如果有更好的方法将 olEmbeddeditem 附件内容放入对象中进行处理，我也会对此持开放态度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T20:11:55.630

我在 Google Groups 上找到了以下代码，用于确定 Outlook 对象的类型：

```
Type t = SomeOutlookObject.GetType();
string messageClass = t.InvokeMember("MessageClass",
  BindingFlags.Public | 
  BindingFlags.GetField | 
  BindingFlags.GetProperty,
  null,
  SomeOutlookObject,
  new object[]{}).ToString();
Console.WriteLine("\tType: " + messageClass); 
```

我不知道这是否有助于 olEmbedded 项目，但它似乎可以识别常规消息、日历项目等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T15:33:00.150

使用也是电子邮件的电子邮件附件，这些电子邮件又包含我想要访问的用户定义的属性，然后我执行以下步骤：

```
Outlook.Application mailApplication = new Outlook.Application();
Outlook.NameSpace mailNameSpace = mailApplication.GetNamespace(“mapi”);
// make sure it is an embedded item
If(myAttachment.Type == Outlook.OlAttachmentType.olEmbeddeditem)
{
    myAttachment.Type.SaveAsFile(“temp.msg”);
    Outlook.MailItem attachedEmail = (Outlook.MailItem)mailNameSpace.OpenSharedItem(“temp.msg”);
    String customProperty = attachedEmail.PropertyAccessor.GetProperty(
        “http://schemas.microsoft.com/mapi/string/{00020329-0000-0000-c000-000000000046}/myProp
} 
```

如果您使用打开 MailItem，那么我将无法访问上述属性：

```
Outlook.MailItem attachedEmail = (Outlook.MailItem)mailApplication.CreateFromTemplate(“temp.msg”); 
```

# java - 有没有办法用 Tomcat 指定不同的会话存储？

> ID：82340
> 
> 赞同：4
> 
> 时间：2008-09-17T12:02:25.953
> 
> 标签：java, tomcat, session

Tomcat（此处为版本 5）将会话信息存储在内存中。集群时，此信息会定期广播到集群中的其他服务器以保持同步。您可以使用数据库存储使会话持久化，但此信息也只是定期写入，并且仅真正用于故障恢复，而不是实际替换内存中的会话。

如果您不想使用粘性会话（不幸的是，我们的配置不允许这样做），这会引发会话不同步的问题。

在其他语言中，Web 框架倾向于允许您使用数据库作为主要会话存储。虽然这引入了潜在的扩展问题，但它确实使会话管理非常简单。我想知道是否有办法让tomcat以这种方式使用数据库进行会话（从技术上讲，这也将消除对tomcat server.xml中任何集群配置的需要）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T12:09:50.867

肯定有办法的。虽然我强烈支持粘性会话 - 为您的服务器/数据库节省了很多负载（除非出现故障）......

[http://tomcat.apache.org/tomcat-5.5-doc/config/manager.html](http://tomcat.apache.org/tomcat-5.5-doc/config/manager.html)包含有关 Tomcat 的 SessionManager 配置和设置的信息。根据您的确切要求，您可能必须实现自己的会话管理器，但是这个起点应该会提供一些帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T12:08:53.210

看看[Terracotta](http://www.terracotta.org/)，我认为它可以解决您的扩展问题，而无需重新设计重大的应用程序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-07-29T01:15:09.303

我一直是 Rails 会话技术的粉丝：将会话（压缩+加密+签名）存储在用户的 cookie 中。这样你就可以对你的心脏内容进行负载平衡，而不必担心粘性会话，或者为你的会话数据访问数据库等。我只是不确定你是否可以在没有某种形式的 Java 应用程序中轻松实现这一点重写你的会话访问代码。无论如何只是一个想法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-04-12T08:19:39.987

另一种选择是[memcached-session-manager](http://code.google.com/p/memcached-session-manager/)，这是一个基于 memcached 的会话故障转移和会话复制解决方案，适用于 tomcat 6.x / 7.x。它支持粘性会话和非粘性会话。

我创建这个项目是为了获得最佳的性能和可靠性，并且能够通过添加更多的 tomcat 和 memcached 节点来进行横向扩展。

# asp.net - 基于 Web 的应用程序中的图表

> ID：82345
> 
> 赞同：3
> 
> 时间：2008-09-17T12:02:50.523
> 
> 标签：asp.net, charts

有哪些各种图表工具可用于使用 ASP.NET 在网页上显示图表？

我知道诸如 Dundas 和 Infragistics 之类的商业工具。

我本可以“用谷歌搜索”这个，但我想知道 SO 参与者使用的各种工具？也欢迎提及任何可用的免费图表工具。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T12:09:25.843

如果您不介意使用 Flash 显示图表，[Open Flash Charts](http://teethgrinder.co.uk/open-flash-chart/)支持多种语言。这也是[此问题中提到的 Stackoverflow 信誉跟踪器部分的选择](https://stackoverflow.com/questions/6936/using-what-ive-learned-from-stackoverflow-html-scraper)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T12:06:21.217

我喜欢[谷歌图表](http://code.google.com/apis/chart/)，但在使用前检查许可证。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T12:04:05.980

嘿 - 不知道这是否适用于 ASP.NET，但我已经为我的 winforms 应用程序使用了 ZedGraph 工具，它真的很棒。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T12:06:08.613

ZedGraph 在 ASP .NET 中表现出色，是一个出色的图表包。非常灵活，并且制作出有吸引力的图表。图形生成为静态图像（默认为 PNG），它会自动删除旧图像。

此外，它得到了广泛的支持，有一个很棒的 wiki 和一个不错的代码项目教程 ( [http://www.codeproject.com/KB/graphics/zedgraph.aspx](http://www.codeproject.com/KB/graphics/zedgraph.aspx) )。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T12:09:06.657

我在一个中型项目中使用了[Chart Director ，并且很喜欢它。](http://www.advsofteng.com/)它的功能非常丰富，文档非常好，支持论坛非常好——它是您提出问题的地方之一，并且为生产该软件的公司工作的人几乎总是会在几个小时内回答它. 我将它与 PHP 和 MySQL 一起使用，但据我所知，它也适用于 ASP.NET。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-17T12:14:36.580

您可能想看看新的[Google Visualization API](http://code.google.com/apis/visualization/)。在昨天的 Google Dev 上看到了一个关于这个的介绍。在伦敦的一天，看起来很有趣。

虽然它目前只能处理从 Google 电子表格检索到的数据，但将其扩展为处理从其他来源检索的数据是 Viz 的高优先级。团队。

HTH。

干杯，

抢

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-17T12:17:55.590

使用[Flotr](http://solutoire.com/flotr/)怎么样？语法非常简洁，您可以轻松生成一些非常漂亮的图表（查看[一些示例](http://solutoire.com/flotr/docs/)）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-12-06T20:46:06.310

如果您需要快速构建图表，请查看这个火箭：

dsec.com/csp_charts.png

您可以从 ASP.Net 脚本调用图表服务器。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-21T18:06:46.427

对于免费的 flash 图表，您可以查看[FusionCharts Free](http://www.fusioncharts.com/free)。或者，如果您想要更专业并准备好掏出 $$$，请查看[FusionCharts v3](http://www.fusioncharts.com)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-17T12:05:25.807

如果使用 SQL Server，那么 SQL Server 报表服务也不错。它包括一个免费版本的 Dundas 图表控件，可让您进行基本的图表绘制。演示和使其对 Firefox 友好存在一些问题，但这是一个非常简单的解决方案。- 如果你当然有 SQL Server！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-17T12:05:43.857

我们使用了[Telerik 的 RadChart](http://demos.telerik.com/aspnet/prometheus/Chart/Examples/Overview/DefaultCS.aspx)和 MSSQL 报告服务。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-17T17:35:24.593

如果你有钱买的话，我不会比登打士更远。我在几个项目中使用过它，但没有找到更好的选择。更好的许可更便宜，是的，但在功能方面并不更好。

# ruby - 如何使用 Net::HTTP 仅读取正文的 x 个字节数？

> ID：82349
> 
> 赞同：12
> 
> 时间：2008-09-17T12:03:40.773
> 
> 标签：ruby, http

在阅读网页正文时，似乎 Ruby 的 Net::HTTP 方法要么全有，要么全无。例如，我如何读取正文的前 100 个字节？

如果请求的文件不可用，我正在尝试从内容服务器读取响应正文中的简短错误消息。我需要阅读足够多的正文以确定文件是否存在。文件很大，所以我不想为了检查文件是否可用而获取整个文件。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2011-12-21T22:55:41.540

This is an old thread, but the question of how to read only a portion of a file via HTTP in Ruby is still a mostly unanswered one according to my research. Here's a solution I came up with by monkey-patching Net::HTTP a bit:

```
require 'net/http'

# provide access to the actual socket
class Net::HTTPResponse
  attr_reader :socket
end

uri = URI("http://www.example.com/path/to/file")
begin
  Net::HTTP.start(uri.host, uri.port) do |http|
    request = Net::HTTP::Get.new(uri.request_uri)
    # calling request with a block prevents body from being read
    http.request(request) do |response|
      # do whatever limited reading you want to do with the socket
      x = response.socket.read(100);
      # be sure to call finish before exiting the block
      http.finish
    end
  end
rescue IOError
  # ignore
end 
```

The rescue catches the IOError that's thrown when you call HTTP.finish prematurely.

FYI, the socket within the `HTTPResponse` object isn't a true `IO` object (it's an internal class called `BufferedIO`), but it's pretty easy to monkey-patch that, too, to mimic the `IO` methods you need. For example, another library I was using (exifr) needed the `readchar` method, which was easy to add:

```
class Net::BufferedIO
  def readchar
    read(1)[0].ord
  end
end 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-09-17T12:43:03.110

您不应该只使用 HTTP`HEAD`请求（Ruby`Net::HTTP::Head`方法）来查看资源是否存在，并且只有在收到 2xx 或 3xx 响应时才继续？这假定您的服务器配置为在文档不可用时返回 4xx 错误代码。我认为这是正确的解决方案。

另一种方法是请求 HTTP 头并查看`content-length`结果中的头值：如果您的服务器配置正确，您应该能够轻松分辨短消息和长文档之间的长度差异。另一种选择：`content-range`在请求中设置标头字段（再次假定服务器的行为正确 WRT HTTP 规范）。

我不认为在您发送 GET 请求*后*在客户端解决问题是可行的方法：到那时，网络已经完成了繁重的工作，您不会真正节省任何浪费的资源。

参考：[http头定义](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html "http方法头")

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-17T14:46:07.340

我想这样做一次，我唯一能想到的就是猴子修补`Net::HTTP#read_body`and`Net::HTTP#read_body_0`方法以接受长度参数，然后在前者中只需将长度参数传递给`read_body_0`方法，在那里你只能读取长度字节。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-17T12:28:54.127

您确定内容服务器只返回一个简短的错误页面吗？

它是否也将 设置`HTTPResponse`为适当的值，例如 404。在这种情况下，您可以捕获在访问时引发的`HTTPClientError`派生异常（最有可能） 。`HTTPNotFound``Net::HTTP.value()`

如果您收到错误，那么您的文件不存在，如果您收到 200，则文件开始下载，您可以关闭连接。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-17T12:38:37.147

要分块读取 HTTP 请求的正文，您需要`Net::HTTPResponse#read_body`像这样使用：

```
http.request_get('/large_resource') do |response|
  response.read_body do |segment|
    print segment
  end
end 
```

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2008-09-17T12:27:36.893

你不能。但你为什么需要？当然，如果页面只是说文件不可用，那么它不会是一个巨大的页面（即根据定义，文件不会存在）？

# virtual-pc - 通过虚拟和主机 PC 中的所有应用程序使用 Alt-Tab 的方式

> ID：82350
> 
> 赞同：5
> 
> 时间：2008-09-17T12:03:58.947
> 
> 标签：virtual-pc

我越来越多地使用 VirtualPc 2007，一个烦恼是“Alt-Tab”。

我想要的是能够使用 alt-tab 来遍历主机 pc 和虚拟机中的所有应用程序，就好像它们是一个长列表一样。有没有设置或程序来做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-17T12:10:19.820

否。如果 VPC 处于全屏模式，则 alt+tab 仅在 VPC 上下文中有效。如果 VPC Screen 没有被聚焦，您将获得 Host 中的应用程序集合（包括 VPC 的实例）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T12:12:58.380

可悲的是没有。这在 Mac 上的 Parallels 中是可能的，他们称之为“连贯”模式。但Virtual PC 不支持这种集成。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-23T15:15:29.020

否。如果 VPC 处于全屏模式，则 alt+tab 仅在 VPC 上下文中有效。但是，您可能会发现“主机键+向下箭头”快捷方式很有用。这可以最小化虚拟机并允许您再次在主机上使用 alt-tab。

# java - 在 Struts 1.3 中，Controller 用变量填充 View 的最佳方式是什么？

> ID：82359
> 
> 赞同：0
> 
> 时间：2008-09-17T12:05:26.900
> 
> 标签：java, model-view-controller, struts

我刚刚继承了一些旧的 Struts 代码。

如果 Struts (1.3) 遵循 MVC 模式，Action 类如何用变量填充 View 以在 HTML 中呈现？

到目前为止，我已经看到 Action 类在`(1)`HTTP 请求中推送变量

```
request.setAttribute("name", user.getName()) 
```

`(2)`在 ActionForm 类中，使用特定于应用程序的方法：

```
UserForm form = (UserForm) actionForm;
form.setUserName(user.getName()); 
```

和`(3)`一个 requestScope 变量，我在 JSP 层中看到（视图使用 JSP），但在 Action 类中看不到。

```
<p style='color: red'><c:out value='${requestScope.userName}' /></p> 
```

那么，其中哪些被认为是老派，在 Struts 的视图中推送变量的推荐方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T12:22:16.797

我的 Struts 时代已经结束了，但据我所知，我们曾经在 Action.perform() 的请求范围内放置一个特定于视图的 bean（它可以作为更精细的 bean 或 bean 集合的持有者）执行。这个特定于视图的 bean 然后将由视图呈现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T12:22:37.763

由于`Struts 1.3`被认为是老派，我建议顺其自然并使用您继承的整个应用程序中已经使用的样式。

如果已经使用了所有不同的样式，请选择最常用的一种。之后，选择你个人最喜欢的。我的应该是 1 或 3 - 表单 (2) 通常最适合最终将在某些表单控件中呈现的数据。如果是这种情况 - 使用表格，否则 - 不要。

# asp.net - ASP.NET 中的网站或 Web 应用程序

> ID：82361
> 
> 赞同：2
> 
> 时间：2008-09-17T12:05:29.520
> 
> 标签：asp.net, visual-studio

哪个 Visual Studio 模板应该用于 ASP.NET 网站、网站模板或项目 | Web 应用程序模板？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T12:11:30.503

你最好阅读这个： http: [//msdn.microsoft.com/en-us/library/aa730880](http://msdn.microsoft.com/en-us/library/aa730880(VS.80).aspx) (VS.80).aspx 在我看来这取决于你正在开发什么

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-02T12:10:00.757

两者的功能和性能相似，但在以下方面仍然不同：

Web应用程序：

*   我们不能在单个 Web 应用程序中包含 C# 和 VB 页面。
*   我们可以在多个项目之间建立依赖关系。
*   部署后无法在不重新编译的情况下编辑单个文件。
*   多个开发人员共同工作以进行创建、测试和部署的企业环境的正确选择。

网站：

*   可以在单个网站中混合使用 VB 和 C# 页面。
*   无法建立依赖关系。
*   部署后编辑单个文件。
*   当一名开发人员负责创建和管理整个网站时，这是正确的选择。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T13:59:58.900

如果您使用 Team Foundation Server 进行源代码控制，您可能必须使用 Web 应用程序项目，因为您需要一个 .csproj 文件。

Jeff Atwood 本人提供了更多详细信息：[Web Site Projects vs. Web Application Projects](http://blogs.vertigosoftware.com/teamsystem/archive/2006/11/03/4057.aspx)

> 由于缺少包含项目信息和元数据的物理文件，Web 站点 web 项目在 Team System 中尤其痛苦。例如，无法在网站项目中签入代码分析规则，因为代码分析规则完全存储在客户端！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-17T12:18:40.410

Web 应用项目的工作方式更像是一个传统的 VS 项目，它有一个项目文件，一步编译等等。

网站项目更像经典的 ASP 或 PHP 站点。没有项目文件（引用存储在解决方案文件中），页面在服务器上动态重新编译。网站的好处是您可以通过 ftp 访问服务器并在文本编辑器中更改文件。你不需要VS。不过，有些人可能会讨厌这一点。

这可能取决于你的背景。如果您习惯于 ASP 或 PHP 风格的开发，网站项目对您来说似乎更自然。如果您有传统的应用程序开发人员背景，Web 应用程序项目会显得更加自然。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T12:08:25.940

我更喜欢网站。网站是目录中文件的集合。它变得更加便携和可部署。Web 应用程序用项目文件解决了这个问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T13:57:19.733

我个人现在专门使用 Web 应用程序项目。由于网站的编译时间，我实际上将一个相当网站转换为 Web 应用程序。

我还使用预构建事件来移动特定于配置的配置文件，并且预构建和构建后事件在网站中不可用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-09-17T06:31:49.360

在 Visual Studio 2015 中，与 Web 应用程序项目相比，我更喜欢网站项目。我仍然使用 Visual Studio，因为您获得了 Nuget Packaging，您可以将 nuget 包安装到这两种类型的项目中。

但是，网站项目没有项目文件，您实际上只是将一个文件夹添加到您的解决方案中。

但是你仍然可以有代码，但我更喜欢把它放在一个单独的项目中。

在 WebApp 项目中，您的资产、Css、视图（razor、aspx 等）、控制器/代码隐藏等都在一个项目中，它们只是混合在一起。我更喜欢将网站分成两半。前端（css、js、图像、“html/cshtml/aspx/ashx/.master/etc”）和后端（所有代码）。

所以我创建了一个网站项目和一个类库来伴随它（在 Visual Studio 中，您可以添加对网站项目的引用）。我将我的类库添加为依赖项，所有代码都在类库中。你仍然可以有一个 global.asax，你只需要告诉它后面的代码在另一个 dll 中（不是网站将编译到的那个）。MVC 视图，您只需像正常一样指定名称空间（dll 是引用，因此名称空间就在那里）。在 WebForms 中，您只需要记住在代码所在的类型引用中包含程序集名称。

习惯起来有点乏味，但是当你有孤立的结构时，一切都在一个有意义的地方，并且以易于维护的方式模块化。

PLUS 方面是因为网站只是一个文件夹（没有项目文件），它可以在 Visual Studio Code 中轻松打开，其他流行的文本编辑器使设计人员可以轻松地处理 css/js/images 等（不在代码项目中）。保持层设计师分开，设计师看到他们需要看到的东西。

现在结构明智。我使用 Tortoise SVN 和 Visual SVN（java/.net 商店）将我的代码保存在我的机器上检查到 subversion 存储库中。为了在本地进行测试，我安装了 IIS，并在本地的 IIS 中设置了网站项目，就像在 dev/prod 服务器上一样。

然后我在 dev/prod 服务器上安装 MSDeploy，并在 Visual Studio 中通过 MSDeploy 使用发布 Web 应用程序功能，并使用 web.config 转换。因此，我对 dev 和 prod 进行了 web.config 转换，而没有转换的主要 web.config 用于本地测试（因此它适用于项目中的所有开发人员）。

对于之前所说的缺点：拥有一个网站项目与一个 WebApp 项目并不意味着多个开发人员不能在它上面工作，只有当你的网站项目在某个服务器上的某个地方并且你直接从那里加载它时，这会很糟糕实践。

您可以像对待任何其他 Visual Studio 项目、本地代码、源代码管理、多个开发人员一样对待网站项目。

最后一点，分离代码的另一个好处是您可以将所有代码放在一个共享项目中。然后你可以为你可能做的每个端口创建一个类库，比如说一个在直接的 .net 4.6 上，另一个在 .net core 5 上，并链接到你的共享项目中。只要您的代码与两者兼容，它就会构建并且您没有任何重复的代码文件。

# c# - WPF 中的平滑进度条

> ID：82365
> 
> 赞同：6
> 
> 时间：2008-09-17T12:06:05.557
> 
> 标签：c#, wpf, progress-bar

我在 WPF 应用程序中使用 ProgressBar 控件，我得到了这个旧的 Windows 3.1 Progress *Blocks*东西。在 VB6 中，有一个属性可以显示*平滑*的ProgressBar。WPF有这样的事情吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-17T12:09:38.043

[这篇](http://support.microsoft.com/kb/323116)知识库文章似乎解释了您在寻找什么……也有一个指向该文章的 VB 版本的链接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-26T09:47:37.483

我无法为此找到直接的解决方案。但我发现了更好的东西。在 WPF 中，您可以使用 Windows 主题。我正在使用 Windows XP，并在我的 WPF 应用程序上安装了 Vista-Aero 主题，使所有控件看起来都像 Vista-Aero。

这是代码...

转到 Application.xaml.vb 并编写...

```
 Enum appThemes
        Aero
        Luna
        LunaMettalic
        LunaHomestead
        Royale
    End Enum

Private Sub Application_Startup(ByVal sender As Object, ByVal e As System.Windows.StartupEventArgs) Handles Me.Startup

        setTheme(appThemes.Aero)

    End Sub

    ''' <summary>
    ''' Function to set the default theme of this application
    ''' </summary>
    ''' <param name="Theme">
    ''' Theme of type appThemes
    ''' </param>
    ''' <remarks></remarks>
    Public Sub setTheme(ByVal Theme As appThemes)

        Dim uri As Uri

        Select Case Theme
            Case appThemes.Aero
                ' Vista Aero Theme
                uri = New Uri("PresentationFramework.Aero;V3.0.0.0;31bf3856ad364e35;component\\themes/Aero.NormalColor.xaml", UriKind.Relative)

            Case appThemes.Luna
                ' Luna Theme
                uri = New Uri("PresentationFramework.Luna;V3.0.0.0;31bf3856ad364e35;component\\themes/Luna.NormalColor.xaml", UriKind.Relative)

            Case appThemes.LunaHomestead
                ' Luna Mettalic
                uri = New Uri("PresentationFramework.Luna;V3.0.0.0;31bf3856ad364e35;component\\themes/Luna.Metallic.xaml", UriKind.Relative)

            Case appThemes.LunaMettalic
                ' Luna Homestead
                uri = New Uri("PresentationFramework.Luna;V3.0.0.0;31bf3856ad364e35;component\\themes/Luna.Homestead.xaml", UriKind.Relative)

            Case appThemes.Royale
                ' Royale Theme
                uri = New Uri("PresentationFramework.Royale;V3.0.0.0;31bf3856ad364e35;component\\themes/Royale.NormalColor.xaml", UriKind.Relative)

        End Select

        ' Set the Theme
        Resources.MergedDictionaries.Add(Application.LoadComponent(uri))

    End Sub 
```

（我希望你能把它转换成 C#）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T14:18:17.237

我不确定你想做什么。如果您只是想要一个像启动 Vista 一样从一侧“扫描”到另一侧的进度条，您可以使用：IsIndetermined = true。

如果您真的想从 0% 变为 100%，则必须对值进行动画处理，如 msdn 上的此示例所示：http: [//msdn.microsoft.com/en-us/library/system.windows.controls。 progressbar.aspx](http://msdn.microsoft.com/en-us/library/system.windows.controls.progressbar.aspx) 或在代码隐藏中（很可能来自后台工作人员）或通过绑定到更改值显式设置值。

尽管如此，WPF ProgressBar 应该始终是“平滑的”，UI 可能会通过 RemoteDesktop 连接默认为更简单的版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T16:26:44.947

我最近对在 Vista 上开发后在 XP 上出现的进度条感到恼火。我不想尝试从 dll 中加载 Vista 样式的建议，但是[这篇文章](http://www.theamoebaproject.com/blog/aquaseal/look-and-feel-progressbar)给了我我想要的东西。vista 外观 - 没有新课程。此外，它在计时器上有玻璃状的亮点。文章上没有图片，但它看起来就像Vista的ProgressBar。

# asp.net - 在 ASP.net 中处理多语言站点中 URL 的最佳方法

> ID：82380
> 
> 赞同：7
> 
> 时间：2008-09-17T12:08:16.173
> 
> 标签：asp.net, internationalization, multilingual

我需要做一个多语言网站，网址如

```
www.domain.com/en/home.aspx for english
www.domain.com/es/home.aspx for spanish 
```

以前我会在IIS中设置两个虚拟目录，然后在global.aspx中检测URL，根据URL更改语言

```
Sub Application_BeginRequest(ByVal sender As Object, ByVal e As EventArgs)
    Dim lang As String
    If HttpContext.Current.Request.Path.Contains("/en/") Then
        lang = "en"
    Else
        lang = "es"
    End If
    Thread.CurrentThread.CurrentUICulture = CultureInfo.GetCultureInfo(lang)
    Thread.CurrentThread.CurrentCulture = CultureInfo.CreateSpecificCulture(lang)

End Sub 
```

解决方案更像是一个黑客。我正在考虑将路由用于新网站。

**你知道更好或更优雅的方法吗？**

编辑：问题是关于 URL 处理，而不是关于资源等。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-17T20:16:36.593

我决定使用新的 ASP.net 路由。
为什么不url重写？因为我不想更改路由提供给您的干净 URL。

这是代码：

```
Sub Application_Start(ByVal sender As Object, ByVal e As EventArgs)
    ' Code that runs on application startup
    RegisterRoutes(RouteTable.Routes)
End Sub

Public Sub RegisterRoutes(ByVal routes As RouteCollection)
    Dim reportRoute As Route
    Dim DefaultLang As String = "es"

    reportRoute = New Route("{lang}/{page}", New LangRouteHandler)
    '* if you want, you can contrain the values
    'reportRoute.Constraints = New RouteValueDictionary(New With {.lang = "[a-z]{2}"})
    reportRoute.Defaults = New RouteValueDictionary(New With {.lang = DefaultLang, .page = "home"})

    routes.Add(reportRoute)
End Sub 
```

然后是 LangRouteHandler.vb 类：

```
Public Class LangRouteHandler
     Implements IRouteHandler

  Public Function GetHttpHandler(ByVal requestContext As System.Web.Routing.RequestContext) As System.Web.IHttpHandler _
      Implements System.Web.Routing.IRouteHandler.GetHttpHandler

    'Fill the context with the route data, just in case some page needs it
    For Each value In requestContext.RouteData.Values
        HttpContext.Current.Items(value.Key) = value.Value
    Next

    Dim VirtualPath As String
    VirtualPath = "~/" + requestContext.RouteData.Values("page") + ".aspx"

    Dim redirectPage As IHttpHandler
    redirectPage = BuildManager.CreateInstanceFromVirtualPath(VirtualPath, GetType(Page))
    Return redirectPage

  End Function
End Class 
```

最后，我使用根目录中的 default.aspx 重定向到浏览器列表中使用的默认语言。
也许这可以通过 route.Defaults 完成，但不能在 Visual Studio 中工作（也许它可以在服务器中工作）

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs)
    Dim DefaultLang As String = "es"
    Dim SupportedLangs As String() = {"en", "es"}
    Dim BrowserLang As String = Mid(Request.UserLanguages(0).ToString(), 1, 2).ToLower
    If SupportedLangs.Contains(BrowserLang) Then DefaultLang = BrowserLang

    Response.Redirect(DefaultLang + "/")
End Sub 
```

一些资料来源：
* [Mike Ormond 的博客](http://blogs.msdn.com/mikeormond/archive/2008/05/14/using-asp-net-routing-independent-of-mvc.aspx)
* [Chris Cavanagh 的博客](http://chriscavanagh.wordpress.com/2008/04/25/systemwebrouting-with-webforms-sample/)
* [MSDN](http://msdn.microsoft.com/en-us/library/cc668201.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T12:42:44.437

1.  将 urlrewriteing.net 用于 asp.net 网络表单，或使用 mvc 路由。将 www.site.com/en/something.aspx 重写为 url：page.aspx?lang=en。
    UrlRewriteing.net 可以通过 web.config 中的正则表达式轻松配置。您现在也可以将路由与网络表单一起使用，它可能类似......
2.  使用 webforms，让每个 aspx 页面都继承自 BasePage 类，然后继承自 Page 类。
    在 BasePage 类中覆盖“InitializeCulture()”并将文化信息设置为线程，就像您在问题中描述的那样。
    最好按以下顺序执行此操作：1\. 检查 url 以获取 Lang 参数，2\. 检查 cookie，3\. 设置默认语言
3.  对于页面上的静态内容（文本、图片 url），使用 LocalResources，如果内容跨站点重复，则使用 Global。您可以观看有关使用全局/本地资源的视频广播。在 www.asp.net
4.  为多种语言准备数据库。但那是另一回事了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T12:29:51.893

我个人使用[资源文件](http://msdn.microsoft.com/en-us/library/c6zyy3s9.aspx)。

非常高效，非常简单。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T15:44:43.160

UrlRewriting 是要走的路。

MSDN 上有一篇很好的文章，介绍了最好的方法。

[http://msdn.microsoft.com/en-us/library/ms972974.aspx](http://msdn.microsoft.com/en-us/library/ms972974.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-09T11:08:28.037

有点切线，但我实际上会避免使用不同的路径来执行此操作，除非不同语言的内容完全相互分离。

对于 Google 排名或共享 URL 的用户（“干净” URL 的一大优势），您希望地址尽可能保持不变。

您可以从他们的浏览器设置中找到用户的语言偏好：

```
CultureInfo.CurrentUICulture 
```

然后你的英文或西班牙文网址：

> www.domain.com/products/newproduct

任何语言的相同地址，但用户以他们选择的语言获取页面。

我们在加拿大使用它来同时提供英语和法语的系统。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-07T21:02:55.073

要使用 URL 路由执行此操作，请参阅此帖子：

[带有 URL 路由的友好 URL](https://stackoverflow.com/questions/266719/url-routing-how-to-handle-spaces-and-illegal-characters-for-friendly-urls#271568)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-17T10:49:41.543

另外，请注意新的 IIS 7.0 - URL 重写。优秀的文章在这里[http://learn.iis.net/page.aspx/496/iis-url-rewriting-and-aspnet-routing/](http://learn.iis.net/page.aspx/496/iis-url-rewriting-and-aspnet-routing/)

我喜欢这部分 **你应该使用哪个选项？**

1.  如果您正在开发使用 ASP.NET MVC 或 ASP.NET 动态数据技术的新 ASP.NET Web 应用程序，请使用 ASP.NET 路由。您的应用程序将受益于对干净 URL 的原生支持，包括为网页中的链接生成干净 URL。请注意，ASP.NET 路由尚不支持标准的 Web 窗体应用程序，尽管有计划在未来支持它。

2.  如果您已经有一个旧的 ASP.NET Web 应用程序并且不想更改它，请使用 URL-rewrite 模块。URL-rewrite 模块允许您将搜索引擎友好的 URL 转换为您的应用程序当前使用的格式。此外，它还允许您创建可用于将搜索引擎爬虫重定向到清理 URL 的重定向规则。 [http://learn.iis.net/page.aspx/496/iis-url-rewriting-and-aspnet-routing/](http://learn.iis.net/page.aspx/496/iis-url-rewriting-and-aspnet-routing/)

谢谢，毛利克。

# html - 是否应该不惜一切代价避免在 HTML 中使用表格？

> ID：82391
> 
> 赞同：40
> 
> 时间：2008-09-17T12:09:46.263
> 
> 标签：html, css, html-table

建议在 HTML 页面中使用表格（现在我们有了 CSS）？

表的应用有哪些？表格有哪些 CSS 中没有的特性/能力？

# 相关问题

*   [表而不是 DIV](https://stackoverflow.com/questions/30251/tables-instead-of-divs)
*   [DIV 与表格](https://stackoverflow.com/questions/83073/div-vs-table)
    *   [DIVs vs. TABLEs 请反驳](https://stackoverflow.com/questions/96137/divs-vs-tables-a-rebuttal-please)

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2008-09-17T12:10:50.443

一点都不。但是对表格数据使用表格。只是不要将它们用于一般布局。

但是，如果您显示表格数据，例如结果甚至表格，请继续使用表格！

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2008-09-17T12:28:35.143

我想我不是这里的大多数人，但我仍然看到 HTML 中的表格有很多用途。当然，是的，对于表格之类的东西，您根本无法击败桌子。尝试排列标签和随附的表单字段当然可以使用 DIV，但是这将是一个多么好的 PITA，并且在某些情况下调整页面大小会很丑陋。一张桌子在这里创造奇迹。

但也要考虑更大的问题。例如，您是否尝试过仅使用 DIV 和 CSS 创建带有页眉和页脚的标准 3 列布局？同样，这是很有可能的，大约有 1000 个网站有示例，但它们都倾向于遇到同样的问题。第一个问题是，在没有某种 javascript 帮助的情况下，这些列永远不会真正地变成相同的高度。第二个问题是更改布局通常是一件棘手的事情，因为要让所有东西都“恰到好处”开始有点平衡，所以你不想弄乱它。最后，这又回到了最后一点——这并不容易。你必须布置所有的 DIV，然后返回并创建魔法 CSS 来强制这些 DIV 进入正确的位置，然后花几个小时调整它，直到它是正确的......呃。然后在没有查看器的情况下查看 HTML 真的会让你不知道页面是什么样子，因为它最终都被 CSS 重新解释了。

现在，选项 B。使用表格。花大约 30 秒输入 <tr> 和 <td> 标记，可能根本没有 CSS，没有 javascript 'fixit'，并且仅通过查看 HTML 就知道它会是什么样子。

当然，有支持和反对表格的争论，纯粹主义者似乎更喜欢 DIV 的布局，但不要仅仅因为有人告诉你表格是邪恶的，就出于宗教原因使用 DIV。使用最适合您、您的页面以及查看者将与页面交互的方式。如果那是一张桌子，那就用它。如果没有，不要。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-09-17T12:16:00.663

到目前为止，每个人都说过表应该只用于表格数据，这是真的。看看 SO 上任何页面的 HTML 源代码，你会发现他们有不同的想法......

我认为他们的理由是*有时*使用表格要简单得多。虽然，有很多非常好的可用性原因可以避免它们。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-09-17T12:19:30.390

除了[表格数据](http://www.w3.org/TR/html401/struct/tables.html#h-11.1)之外，不幸的是，如果您想以跨浏览器兼容的方式创建*灵活*的网格布局（例如复杂表单），表格仍然是必需的。

CSS2 支持在不使用`table`元素的情况下通过[display 属性](http://www.w3.org/TR/CSS21/tables.html)创建灵活的网格布局，但这[在 IE6 或 IE7 中不受支持](http://www.quirksmode.org/css/display.html)。

然而，对于大多数基本的表单布局，CSS 应该就足够了。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-09-17T12:38:37.757

如果只有等效的 CSS 可以方便地设置“类似表格”的布局，那么我会喜欢使用 CSS。我发现模仿其他人在这里列出的东西（单元格的高度相等，自动生长的行等）所花费的时间根本不值得付出努力。在大多数情况下，我没有得到我的投资回报，而不是快速拼凑一张桌子。

所有浏览器都可以就表格的布局方式达成一致。巴姆。完毕。

下面是我的 CSS 蠢事通常是这样的：尝试在 CSS 中设置一个类似表格的布局。花 20 分钟或更长时间在 Mozilla 中获取所有内容，然后在 IE 中打开它。再花 30 分钟在这两个浏览器之间进行调整。假装世界上只有两个浏览器，因为我实际上需要完成一些工作。

我相信 CSS 的承诺：关注点分离。问题是，对于那些需要高效工作的人来说，CSS 还没有准备好迎接黄金时间。或者它可能是浏览器的渲染引擎——无论哪种。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-17T12:12:30.580

CSS 的好处在于它将设计和布局与内容分开。

`<TABLE>`如果您有表格数据，那么使用标签是有意义的。如果你想布局不同的内容块，那么你应该使用`<DIV>`or`<SPAN>`和 CSS。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-17T12:12:19.893

表格用于输出表格数据。您可能在电子表格中显示的任何内容，结果列，诸如此类。

使用 CSS 而不是表格的建议适用于列式布局，这并不是真正的表格。它从来没有打算建议应该完全删除表。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-09-17T12:18:34.607

表格在 CSS2 中没有等价物，而且使用 css 复制它们也不是那么容易。表中难以重现的特定部分是列的自动调整大小。虽然让 1 行在整个页面中增长到相同大小很容易，但下一行很难动态匹配列大小或每个单元格大小，事实上，如果不使用其他脚本语言，例如javascript、php 或其他。您可以使用最大和最小宽度，以及设置单元格大小的百分比或硬编码单元格宽度，但动态增长的单元格适用于 1 行，它下面的下一行将不匹配。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2010-06-18T19:58:42.923

浏览这些答案，我没有看到一个现实世界的原因，即布局需要表格，那就是 html 电子邮件。

我在一家非常非常大的金融公司工作，我们每个月跟踪大约 600 个不同的工作......其中许多是多个电子邮件活动。

您不能将 css 用于任何邮件阅读器的布局。您可以使用一些与颜色、字体和大小相关的内联 CSS 规范，甚至行高也相当广泛，但对于布局，您必须使用表格作为所有主要和次要的电子邮件阅读器（Outlook 97/ 03、Entourage、MSN 等）阅读它们就好了。

当您的 td 没有指定高度/宽度时，表格的问题就会发挥作用，无论它们是否包含数据。因此，“损坏”的表格布局通常通过注意属性来修复，是的...... html 中的空格......是的，应该不重要的空格。

因此，如果您曾经为一家大公司/公司工作，或者您拥有一个非常大的客户，请准备好抛弃所有当前技术并戴上您的 html 礼帽！

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-17T12:41:04.037

我认为这完全取决于时间/努力。虽然纯粹主义者可能会说“仅将表格用于表格数据”，但我过去曾使用表格来简化跨浏览器布局。

对我来说，这是时间利用的问题。我可以把时间花在 CSS 上以使其正确，或者我可以把它扔在桌子上，花更少的时间在上面。我倾向于走这条路，直到一切顺利。一旦功能到位，我就回去润色 CSS/HTML。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-17T13:42:07.430

我必须在这里使用表格方法。其原因简单归结为成本。直到一个得到很好支持的以 CSS 为中心的布局方法出现之前，我说的是宏观层面……而不是容器内的微观，试图将 CSS 定位硬塞进一个通用的布局方法是低效的。您必须从编写开发支票的人的角度来处理这个问题。

几年前，我与一家大型连锁酒店签订了开发和维护网站的合同。我们采用了表格驱动的布局；您的基本页眉、正文、带有左/右列的页脚。我们还将表格用于一些更精细的元素，例如非图形按钮。该连锁店的母公司维护自己的网站，并采用纯 CSS 方法进行布局。当 IE7 出现时，我们的网站运行良好，没有任何变化。母公司的网站一团糟。总体而言，他们总共花费了大约 1000 小时（在会议/开发/QA/推出之间）来解决问题。

当您获得开发站点的报酬时，您的部分责任是减轻未来风险并最大限度地降低未来开发成本，特别是如果这些成本不会为站点（您的产品）增加价值。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-17T12:12:52.700

我对此非常简单和基本的看法是，表格是用于表格数据的 - 而不是将一个东西放在顶部或另一个元素旁边，因为你碰巧喜欢它在那里。

所以 - 如果你想显示一个数据表：这样做（用一个表）。如果要在页面上定位内容：使用 css。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-17T12:23:57.870

我相信并希望使用表格进行布局的时代已经过去。简单地说：**一张桌子就是一张桌子，别无其他**。

我认为未来几年新的、类似的、激烈的话题是：我应该使用新的 CSS 功能**显示**：**table**、**table-cell**、**table-row**等进行布局吗？? :-)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-17T12:26:51.433

我想你可能会有点困惑。CSS 是一种样式化 HTML 文档的方法，无论是表格元素还是“div”。

过去在 HTML 中使用表格来设计整个页面布局。经常看到多个嵌套表（通常由诸如 Dreamweaver 等所见即所得程序生成），这导致了维护方面的噩梦。

自从 CSS 样式表的引入和采用以来，现在只使用表格来存储表格数据是正确的。这意味着如果您的数据最自然地呈现为表格，请使用表格元素。您仍然可以使用 CSS 设置表格样式。

但是，我通常不赞成这种方法，因为它复制了现有的功能，可以使用元素来构建类似表格的结构。事实上有几个网站会为你生成这样的代码，但我手头没有链接。

还请记住，一些用户可能要么以纯文本模式查看，要么使用屏幕阅读器，这两者都可能会破坏页面（例如垂直而不是水平阅读列），因此正确使用表格。

高温高压

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-17T12:42:19.650

我认为出现这么多的原因是在创建结构和布局时使用 html 表格比 CSS 更容易理解。使用 CSS 更抽象，但有助于分离您的代码。

为了响应“结构”参数......根据定义，不使用 html 表格为数据提供结构，以便您将其识别为“表格”。无论是 CSS 还是 html，您都在控制数据的流动和布局。无论是表格还是其他...

如果 CSS 表格如此重要（而且我确信我的回答会引发某种激烈的战争），为什么 Visual Studio 中没有一种机制可以使用 CSS 创建布局？哦，你没有检查VS中的布局功能吗？是的，您可以直接从 Microsoft 获得表格。我不是在抱怨，只是指出如果它对世界其他地方同样重要，你会看到 MS 切换到 CSS。

在我看来，做最适合您的项目的事情。对于一页或两页的 web 项目，我仍然使用 html，因为它的作用是显而易见的。使用 CSS 更抽象，有些早上我只是没有喝那么多咖啡。HTML 表格可能会变得混乱、快速。CSS 需要更多时间才能变得凌乱，但也会如此。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-09-17T13:42:43.983

虽然对于某些使用表格的布局一开始可能看起来更简单，但当维护时间到来时，使用 css 是有回报的。特别是如果您想更改某物的位置，或者如果您想在多个地方使用相同的布局。

恕我直言，仅在展示表格时才应使用表格。从不用于布局目的。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-17T12:10:57.137

表格用于显示表格数据。没有什么要补充的了:-D

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-17T12:14:22.150

如果有理由以语义方式使用表格（例如用于显示表格数据），请使用表格。

只需不使用表格来进行布局。语义标记有很多搜索引擎和可访问性的好处。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-09-17T12:22:08.810

大多数情况下，保留表以仅用于表格数据。有些布局问题用表格比其他任何东西都更容易解决。例如，垂直对齐和等高列。在栅栏的另一边，有一些复杂的数据表，我使用了浮动 div，因为表不符合要求。

像其他任何事情一样，为正确的工作使用正确的工具，有时最实用的工具并不是您认为的那样。也就是说，即使在我给出的示例中，我也很少使用表格进行布局，因为我不可避免地遇到了一些问题，这让我不得不用 CSS 来做。你的旅费可能会改变。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-09-17T12:33:50.123

我也不喜欢使用表格来排列页面上的项目的想法。然而，这不应该成为一种宗教 - 桌子很糟糕。我遇到了一个示例，其中我有一个三列布局，并且需要中心列随内容一起增长。最后，最简单且适用于所有需要的浏览器的解决方案是使用表格。恕我直言 CSS 仍然有一些缺点，有时最好使用一些简单有效的东西，而不是盲目地坚持某个想法（“表格很糟糕......”）。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-09-17T12:34:36.720

如果您的布局有点表格，您甚至可以将它们用于布局。我喜欢动态调整到浏览器窗口宽度的表格和单元格的功能。永远不要使用任何固定的宽度或高度，那只会把事情搞砸。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-09-17T12:38:52.967

这简单。将您的网页视为纸上的真实页面。仅当您要在纸上绘制表格时，才应在网页上使用表格。

**另一个提示是**仅使用边框 > 0 的表格。这样，仅当您想要一个表格时才使用表格（而不是用于布局）。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2008-09-19T17:50:11.223

@toddhd，提倡使用表格进行布局只是为了节省时间是一种逃避。[如果时间是问题，那么您可以使用Blueprint CSS](http://code.google.com/p/blueprintcss/)或[960 Grid](http://960.gs/)等框架快速创建没有表格的列式布局。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2009-09-16T19:29:11.850

似乎取决于您开始设计时浏览器的能力。如果您从只有表格工作的时候开始，那么这就是您可能一直想要使用的东西，因为您知道这一点。或者，即使在浏览器已经先进到能够呈现 CSS 之后，你也喜欢使用它……

我只是不喜欢一遍又一遍地做同样的事情，因为它们很容易而且我知道怎么做。那很无聊。我宁愿学习新技术也不愿放弃一些东西，因为我不知道如何使用它，或者我认为我没有时间学习。

我不喜欢使用表格，我不理解它们，它们看起来很陌生和令人反感，但那是因为我从 2005 年开始。我也不使用设计程序来吐出模板，因为我更喜欢手工编码。

* * *

## 回答 #25

> 赞同：-1
> 
> 时间：2008-09-17T12:19:36.710

我将假设您的问题实际上是 - *“我应该避免使用 HTML 表格进行布局吗？”* . 答案是：不。事实上，表格是专门用来控制布局的。使用表格来控制整个页面的布局的缺点是源文件很快变得难以手动理解和编辑。使用表格来控制整个布局的一个（可能的）优点是是否对跨浏览器兼容性和呈现有特定的关注。我更喜欢直接使用 HTML 源文件，对我来说，使用 CSS 比在整个布局中使用表格更容易。

* * *

## 回答 #26

> 赞同：-1
> 
> 时间：2008-09-17T13:10:06.057

仅当您尝试显示表格数据时，表格才有意义，仅此而已。对于布局，您应该始终使用 DIV 并使用 CSS 定位。

* * *

## 回答 #27

> 赞同：-4
> 
> 时间：2009-10-21T16:57:05.483

如果你需要使用一张桌子，你的布局可能很糟糕。给我看一个使用表格的精心设计的网站，我会给你看一千个不使用表格的网站。

很多人都在抛出“纯粹主义者”这个词。这是垃圾。你会在书中打印报纸副本吗？你会用 Excel 设计小册子吗？不？那么为什么要使用表格来显示非表格数据呢？

大多数时候，人们在放弃表格进行布局时所面临的困难是他们自己对 HTML/CSS/良好设计原则的无知的结果。虽然您可能会发现很难使多列布局在垂直方向上均匀延伸，但您可能会考虑尝试不同的方法。DIV 不是表。您可以使用宽边框、页面背景等制作人造栏。花一些时间实际学习做您打算做的事情，或者永远被视为没有任何有用技能的人。（[http://www.alistapart.com](http://www.alistapart.com)将是一个好的开始）

老实说，我很惊讶这个问题在 2008 年出现。DIV 是在我上高中的时候出现的。别再做菜鸟了。

如上所述，表格在移动设备和屏幕阅读器上很难运行。

# uri - 如何匹配文本中的 URI？

> ID：82398
> 
> 赞同：3
> 
> 时间：2008-09-17T12:10:32.940
> 
> 标签：uri, textmatching

如何在文本块中发现 URI？

这个想法是将这样的文本运行变成链接。如果只考虑 http(s) 和 ftp(s) 方案，这很简单；但是，我猜一般问题（考虑到 tel、mailto 和其他 URI 方案）要复杂得多（如果可能的话）。

如果可能的话，我更喜欢 C# 中的解决方案。谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-17T13:45:39.997

正则表达式可能证明是一个很好的起点，尽管众所周知，URI 和 URL 很难与单个模式匹配。

为了说明，最简单的模式看起来相当复杂（在 Perl 5 表示法中）：

`\w+:\/{2}[\d\w-]+(\.[\d\w-]+)*(?:(?:\/[^\s/]*))*`

这将匹配 `http://example.com/foo/bar-baz`

和 `ftp://192.168.0.1/foo/file.txt`

但至少会导致以下问题：

*   `mailto:support@stackoverflow.com`（不匹配 - 不`//`，但存在`@`）
*   `ftp://192.168.0.1.2`（匹配，但数字太多，所以它不是有效的 URI）
*   `ftp://1000.120.0.1`（匹配，但 IP 地址需要 0 到 255 之间的数字，因此它不是有效的 URI）
*   `nonexistantscheme://obvious.false.positive`
*   `http://www.google.com/search?q=uri+regular+expression`（匹配，但查询不是我认为这是 80:20 规则的情况。如果你想捕捉大多数东西，那么如果你自己不能写一个，我会按照建议找到一个像样的正则表达式。

如果您正在查看从相当受控的来源（例如机器生成）中提取的文本，那么这将是最好的行动方案。

如果您绝对必须捕获遇到的每个 URI，并且您正在查看来自野外的文本，那么我想我会查找其中带有冒号的任何单词，例如`\s(\w:\S+)\s`. 一旦你有一个合适的 URI 候选者，然后将它传递给你正在使用的任何库的 URI 类中的真实 URI 解析器。

如果您对编写 URI 模式如此困难的原因感兴趣，我想可能是 URI 的定义是使用[Type-2 语法](http://en.wikipedia.org/wiki/Chomsky_hierarchy#The_hierarchy)完成的，而正则表达式只能解析来自[Type-3 语法的](http://en.wikipedia.org/wiki/Chomsky_hierarchy#The_hierarchy)语言。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T12:18:20.690

某个东西是否是 URI 取决于上下文。一般来说，它们唯一的共同点是它们以“scheme_name:”开头。方案名称可以是任何名称（受合法字符限制）。但其他字符串也包含冒号，而不是 URI。

因此，您需要确定您感兴趣的方案。通常，您可以搜索“scheme_name:”，然后为您关心的每个方案搜索直到空格的字符。不幸的是，URI 可以包含空格，因此如果它们嵌入到文本中，它们可能会产生歧义。您无法解决歧义 - 编写文本的人必须解决它。URI 可以选择包含在 <> 中。但是，大多数人不会这样做，因此认识到这种格式只会偶尔有所帮助。

URI 的 Wikipedia 文章列出了相关的 RFC。

[编辑添加：使用正则表达式来完全验证 URI 是一场噩梦——即使你以某种方式找到或创建了一个正确的，它也会非常大并且难以评论和维护。幸运的是，如果您所做的只是突出显示链接，您可能并不关心奇怪的误报，因此您不需要验证。只需查找“http://”、“mailto:\S*@”等]

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T21:35:29.040

Ubiquity的[URL 工具](http://blog.fligtar.com/2008/08/30/url-tool-for-ubiquity/)执行以下操作：

```
findURLs: function(text) {
    var urls = [];
    var matches = text.match(/(\S+\.{1}[^\s\,\.\!]+)/g);
    if (matches) {
        for each (var match in matches) {
            urls.push(match);
        }
    }
    return urls;
}, 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T12:13:22.450

对于很多协议，您可以只搜索“：//”而不带引号。虽然不确定其他人。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T12:21:20.277

这是一个带有正则表达式的代码片段，可满足各种需求：

[http://snipplr.com/view/6889/regular-expressions-for-uri-validationparsing/](http://snipplr.com/view/6889/regular-expressions-for-uri-validationparsing/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T12:26:10.017

这并不容易做到，如果你还想匹配“something.tld”，因为普通文本会有很多该模式的实例，但如果你只想匹配以方案开头的 URI，你可以试试这个正则表达式（对不起，我不知道如何将它插入C#）

```
(http|https|ftp|mailto|tel):\S+[/a-zA-Z0-9] 
```

您可以在那里添加更多方案，它会匹配方案直到下一个空白字符，考虑到最后一个字符不是无效的（例如在非常常见的字符串“ [http://www.example.com](http://www.example.com) ”中。 )

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-09-17T12:33:33.913

下面的 perl 正则表达式应该可以解决问题。c# 有 perl 正则表达式吗？

```
/\w+:\/\/[\w][\w\.\/]*/ 
```

# sql-server - WAITFOR command

> ID：82404
> 
> 赞同：5
> 
> 时间：2008-09-17T12:11:01.817
> 
> 标签：sql-server

Given the problem that a stored procedure on SQL Server 2005, which is looping through a cursor, must be run once an hour and it takes about 5 minutes to run, but it takes up a large chunk of processor time:

edit: I'd remove the cursor if I could, unfortunatly, I have to be doing a bunch of processing and running other stored procs/queries based on the row.

Can I use WAITFOR DELAY '0:0:0.1' before each fetch to act as SQL's version of .Net's Thread.Sleep? Thus allowing the other processes to complete faster at the cost of this procedure's execution time.

Or is there another solution I'm not seeing?

Thanks

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-17T13:33:10.730

Putting the WAITFOR inside the loop would indeed slow it down and allow other things to go faster. You might also consider a WHILE loop instead of a cursor - in my experience it runs faster. You might also consider moving your cursor to a fast-forward, read-only cursor - that can limit how much memory it takes up.

```
declare @minid int, @maxid int, @somevalue int 
select @minid = 1, @maxid = 5
while @minid <= @maxid
begin
  set @somevalue = null
  select @somevalue = somefield from sometable where id = @minid
  print @somevalue
  set @minid = @minid + 1
  waitfor delay '00:00:00.1'
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T12:49:29.197

I'm not sure if that would solve the problem. IMHO the performance problem with cursors is around the amount of memory you use to keep the dataset resident and loop through it, if you then add a waitfor inside the loop you're hogging resources for longer.

But I may be wrong here, what I would suggest is to use perfmon to check the server's performance under both conditions, and then make a decision whether it is worth-it or not to add the wait.

Looking at the tag, I'm assuming you're using MS SQL Server, and not any of the other flavours.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T12:51:12.997

You could delay the procedure, but that might or might not help you. It depends on how the procedure works. Is it in a transaction, why a cursor (horribly inefficient in SQL Server), where is the slowdown, etc. Perhaps reworking the procedure would make more sense.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T13:09:34.110

Ever since SQL 2005 included windowing functions and other neat features, I've been able to eliminate cursors in almost all instances. Perhaps your problem would best be served by eliminating the cursor itself?

Definitely check out Ranking functions [http://msdn.microsoft.com/en-us/library/ms189798.aspx](http://msdn.microsoft.com/en-us/library/ms189798.aspx) and Aggregate window functions [http://msdn.microsoft.com/en-us/library/ms189461.aspx](http://msdn.microsoft.com/en-us/library/ms189461.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-17T12:19:18.807

I'm guessing that whatever code you have means that the other processes can't access the table your cursor is derived from.

Provided that you make the cursor READONLY FASTWORD you should not lock the tables the cursor is derived from.

If, however, you need to write, then WAITFOR wouldn't help. Once you've locked the table, it's locked.

An option would be to snapshot the tables into a temp table, then cursor/loop through that instead. You would then not be locking the underlying tables, but equally the tables could change while you're processing the snapshot...

Dems

# c# - 有没有办法覆盖 LINQtoSQL 生成的类中的空构造函数？

> ID：82409
> 
> 赞同：9
> 
> 时间：2008-09-17T12:11:24.780
> 
> 标签：c#, .net, linq, linq-to-sql

如果我的数据库中有一个名为“Users”的表，则会有一个由 LINQtoSQL 生成的名为“User”的类，该类已声明为空构造函数。

如果我想重写这个构造函数并向它添加我自己的逻辑，最佳实践是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-17T14:30:45.990

由 O/R-Designer 生成的默认构造函数调用一个名为的部分函数`OnCreated`- 所以最佳实践不是覆盖默认构造函数，而是实现部分函数`OnCreated`来`MyDataClasses.cs`初始化项目：

```
partial void OnCreated()
{
  Name = "";
} 
```

如果您正在实现其他构造函数，请始终注意调用默认构造函数，以便正确初始化类 - 例如，在默认构造函数中构造实体集（关系）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T12:17:46.527

看起来您不能覆盖空的构造函数。相反，我将创建一个方法来执行您在空构造函数中所需的功能并返回新对象。

```
// Add new partial class to extend functionality
public partial class User {

  // Add additional constructor
  public User(int id) {
    ID = id;
  }

  // Add static method to initialize new object
  public User GetNewUser() {
    // functionality
    User user = new User();
    user.Name = "NewName";
    return user;
  }
} 
```

然后在代码的其他地方，而不是使用默认的空构造函数，执行以下操作之一：

```
User user1 = new User(1);
User user2 = User.GetNewUser(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-08T11:39:42.913

将 DataContext Connection 属性设置为“无”对我有用。下面的步骤。

打开 dbml -> 右键单击​​属性 -> 将 DataContext 属性中的连接更新为“无”。这将从生成的代码文件中删除空构造函数。-> 使用如下所示的空构造函数为 DataContext 创建一个新的部分类

```
Partial Class MyDataContext    
    Public Sub New()             
        MyBase.New(ConfigurationManager.ConnectionStrings("MyConnectionString").ConnectionString, mappingSource)
        OnCreated()    
    End Sub    
End Class 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-07-03T19:14:29.057

这是 C# 版本：

```
public partial class PENCILS_LinqToSql_DataClassesDataContext
{
     public PENCILS_LinqToSql_DataClassesDataContext() : base(ConnectionString(), mappingSource)
    {
    }

    public static String ConnectionString()
    {
        String CS;
        String Key;

        Key = System.Configuration.ConfigurationManager.AppSettings["DefaultConnectionString"].ToString();

        /// Get the actual connection string.
        CS = System.Configuration.ConfigurationManager.ConnectionStrings[Key].ToString();

        return CS;
    }
} 
```

# c++ - ARM 上的预取指令

> ID：82415
> 
> 赞同：4
> 
> 时间：2008-09-17T12:11:54.607
> 
> 标签：c++, arm, assembly

较新的 ARM 处理器包括 PLD 和 PLI 指令。

我正在编写紧密的内部循环（在 C++ 中），它具有非顺序内存访问模式，但我的代码自然可以完全理解这种模式。如果我可以在处理当前内存位置的同时预取下一个位置，我预计会大大加快速度，并且我希望这足够快，值得尝试！

我正在使用来自 ARM 的新的昂贵编译器，它似乎没有在任何地方包含 PLD 指令，更不用说在我关心的这个特定循环中了。

如何在我的 C++ 代码中包含显式预取指令？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-17T12:23:37.870

应该有一些编译器特定的功能。对于 C/C++，没有标准的方法可以做到这一点。查看您的编译器编译器参考指南。对于 RealView 编译器，请参见[this](http://www.keil.com/support/man/docs/armccref/armccref_cjagadac.htm)或[this](http://www.keil.com/support/man/docs/armccref/armccref_cjacagfi.htm)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T12:26:51.107

如果您试图从这些循环中获得真正的最大性能，那么我建议您在汇编程序中编写整个循环结构。根据循环中涉及的数据结构，您应该能够使用内联汇编。如果您可以展开循环的任何部分（例如使访问不连续所涉及的部分），那就更好了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-28T13:52:40.330

冒着问显而易见的风险：您是否验证了编译器的目标架构？例如（幽默），如果默认情况下编译器针对 ARM7，您将*永远不会*看到 PLD 指令。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T06:06:37.643

其他优化（如[软件流水线](http://en.wikipedia.org/wiki/Software_pipelining)和[循环展开](http://en.wikipedia.org/wiki/Loop_unwinding)）可能会达到与您的预取想法相同的效果（通过将加载的延迟与有用的计算重叠来隐藏加载的延迟），但不会导致额外的指令缓存压力。通过额外的说明。我什至会说这种情况经常发生，因为紧密的内部循环往往只有很少的指令和很少的控制流。您的编译器是否正在执行这些类型的传统优化。如果是这样，可能值得查看流水线图，以开发更详细的处理器工作成本模型，并更定量地评估预取是否有帮助。

# sql-server - 根据 Reporting Services 中的呈现格式更改报表数据的可见性

> ID：82417
> 
> 赞同：2
> 
> 时间：2008-09-17T12:12:10.690
> 
> 标签：sql-server, reporting-services, report

如果报告以特定格式（csv、xml、excel、pdf、html）呈现，是否可以从报告中隐藏或排除某些数据。问题是我希望在以 Excel 格式生成报表时不呈现指向其他报表的超链接 - 但当报表以 HTML 格式呈现时它们应该存在。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T19:58:40.053

我使用 ReportViewer 控件为 Web 应用程序使用 SSRS 2005 执行此操作的方式是，我有一个隐藏的布尔报表参数，该参数在报表中用于决定是否将文本呈现为超链接。

然后诀窍是如何根据渲染格式发送该参数值。我这样做的方法是禁用 ReportViewer 导出控件（通过将其 ShowExportControls 属性设置为 false）并为我想要导出的每种格式制作我自己的 ASP.NET 按钮。这些按钮的代码首先设置隐藏的布尔参数并刷新报告：

```
ReportViewer1.ServerReport.SetParameters(New ReportParameter() {New ReportParameter("ExportView", "True")})
ReportViewer1.ServerReport.Refresh() 
```

然后您需要以编程方式导出报告。有关如何执行此操作的示例，请参阅[此页面（忽略创建和初始化 ReportViewer 的前几行代码）。](http://weblogs.asp.net/srkirkland/archive/2007/10/29/exporting-a-sql-server-reporting-services-2005-report-directly-to-pdf-or-excel.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T12:55:34.000

我认为这在 2000 版本中是不可能的，但可能在以后的版本中。

如果我没记错的话，我们最终制作了两个版本的报告。

# java - 当 Hibernate 刷新一个 Session 时，它如何判断 session 中哪些对象是脏的？

> ID：82429
> 
> 赞同：19
> 
> 时间：2008-09-17T12:13:18.300
> 
> 标签：java, hibernate, session, orm, flush

我对 Hibernate 的理解是，当对象从数据库加载时，它们会被添加到会话中。在不同的点，根据您的配置，会话被刷新。此时，修改后的对象被写入数据库。

Hibernate 如何决定哪些对象是“脏的”并且需要写入？

Hibernate 生成的代理会拦截对字段的分配，并将对象添加到 Session 的脏列表中吗？

还是 Hibernate 会查看 Session 中的每个对象并将其与对象的原始状态进行比较？

还是完全不同的东西？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-09-17T13:07:12.680

Hibernate 确实/可以使用字节码生成 (CGLIB)，以便在您调用 setter（或什至分配给字段 afaict）时立即知道字段是脏的。

这会立即将该字段/对象标记为脏，但不会减少在刷新期间需要进行脏检查的对象数量。它所做的只是影响`org.hibernate.engine.EntityEntry.requiresDirtyCheck()`. 它*仍然*会进行逐个字段的比较以检查是否脏污。

我说以上内容是基于最近对源代码（3.2.6GA）的拖网，无论增加了什么可信度。兴趣点是：

*   `SessionImpl.flush()`触发`onFlush()`事件。
*   `SessionImpl.list()``autoFlushIfRequired()`触发`onAutoFlush()`事件的调用。（在感兴趣的表格上）。也就是说，查询可以调用刷新。有趣的是，如果没有事务，则不会发生刷新。
*   这两个事件最终都在`AbstractFlushingEventListener.flushEverythingToExecutions()`，最终（在其他有趣的位置）在`flushEntities()`。
*   这将遍历 session( `source.getPersistenceContext().getEntityEntries()`) 调用中的每个实体`DefaultFlushEntityEventListener.onFlushEntity()`。
*   你最终会在`dirtyCheck()`. 该方法确实对 CGLIB 脏标志进行了一些优化，但我们仍然最终循环遍历每个实体。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-17T12:35:27.543

Hibernate 对加载到 Session 中的每个对象的状态进行快照。在刷新时，将 Session 中的每个对象与其对应的快照进行比较，以确定哪些是脏的。根据需要发出 SQL 语句，并更新快照以反映（现在干净的）会话对象的状态。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T12:36:27.557

查看 org.hibernate.event.def.DefaultFlushEntityEventListener.dirtyCheck 会话中的每个元素都会通过与未触及的版本（来自缓存或来自数据库的版本）进行比较来确定它是否脏。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-08-21T11:20:27.713

[Hibernate 默认脏检查机制](http://vladmihalcea.com/the-anatomy-of-hibernate-dirty-checking/)将遍历当前附加的实体并将所有属性与它们的初始加载时间值匹配。

您可以在下图中更好地可视化此过程：

![默认自动脏检查](https://i.stack.imgur.com/tBdwk.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-12-22T14:58:06.397

这些答案是不完整的（充其量——我不是这里的专家）。如果你的会话中有一个 hib man 实体，你什么都不做，当你调用 save() 时你仍然可以获得更新。什么时候？当另一个会话在您的 load() 和 save() 之间更新该对象时。这是我的示例：[即使客户端没有更改值，休眠也会设置脏标志（并发出更新）](https://stackoverflow.com/questions/27595252/hibernate-sets-dirty-flag-and-issues-update-even-though-client-did-not-change)

# linux - 在您自己的服务器上托管网站

> ID：82431
> 
> 赞同：4
> 
> 时间：2008-09-17T12:13:29.313
> 
> 标签：linux, dns, web-hosting

是否有详细的指南解释如何在您自己的 Linux 服务器上托管网站。我目前已将其托管在其中一个商业网络主机上。此外，该域已注册到不同的供应商。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-17T12:16:35.297

[本指南](http://gentoo-wiki.com/HOWTO_setup_a_home-server)可能比您真正要求的信息更多，但其中包含网络服务器信息。它是特定于 Gentoo 的，但您可以将相同的信息通过少量翻译应用到任何其他发行版。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T12:18:08.537

我认为这取决于您对 linux 的熟悉程度。当然，许多人为爱好者网站这样做。

涉及到很多方面——你应该从一些简单的事情开始，比如让 apache 运行并且对外界可见。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T12:19:09.660

我会考虑安装 apache

99% 的 Linux 发行版都会有一个包。

在 ubuntu 上，您可以运行：

```
sudo apt-get install apache2 
```

您是否正在考虑在本地托管一个网页以供 Internet 使用？或者这只是为了开发等等。

如果是用于 Internet 服务器，则需要具有良好上游的稳定 Internet 连接。

您可能还需要一个静态 IP 地址，以便将 DNS 设置为指向正确的位置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T12:19:47.393

虽然我没有一个好的英文教程的网址，但我只是警告你，这不是你应该掉以轻心的事情。管理服务器涉及弄脏 linux 的东西，根据您的知识和要求，处理安全性可能非常复杂。

因此，如果您对此一无所知，则应该非常小心，如果您托管的网站具有任何商业重要性，您最好聘请服务器管理员。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T13:00:24.020

只是指出; 如果这是个人（家庭）服务器，而不是公司环境中的服务器，那么最好不要费心托管它 - 您不一定有带宽，而且您的 ISP 可能不允许。

如上所述，您还需要一个静态 IP 地址，并且您需要设置 DNS 记录以指向正确的位置，您的域供应商可能会或可能不会帮助您。

# c# - 为什么无法覆盖仅 getter 的属性并添加 setter？

> ID：82437
> 
> 赞同：151
> 
> 时间：2008-09-17T12:14:04.570
> 
> 标签：c#, .net, properties, getter-setter

为什么不允许使用以下 C# 代码：

```
public abstract class BaseClass
{
    public abstract int Bar { get;}
}

public class ConcreteClass : BaseClass
{
    public override int Bar
    {
        get { return 0; }
        set {}
    }
} 
```

> CS0546 'ConcreteClass.Bar.set'：无法覆盖，因为 'BaseClass.Bar' 没有可覆盖的 set 访问器

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2010-04-03T12:06:27.693

我认为主要原因只是语法过于明确，无法以任何其他方式工作。这段代码：

```
public override int MyProperty { get { ... } set { ... } } 
```

非常明确的是 the`get`和 the`set`都是覆盖。基类中没有`set`，所以编译器会抱怨。就像您不能覆盖未在基类中定义的方法一样，您也不能覆盖 setter。

您可能会说编译器应该猜测您的意图，并且仅将覆盖应用于可以被覆盖的方法（即本例中的 getter），但这违反了 C# 设计原则之一——编译器不得猜测您的意图，因为它可能会在你不知情的情况下猜错。

我认为下面的语法可能会做得很好，但正如 Eric Lippert 一直说的那样，即使是实现这样的小功能仍然需要大量的努力......

```
public int MyProperty
{
    override get { ... } // not valid C#
    set { ... }
} 
```

或者，对于自动实现的属性，

```
public int MyProperty { override get; set; } // not valid C# 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2014-03-05T22:07:38.667

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2010-09-09T16:18:37.873

我今天偶然发现了同样的问题，我认为我有一个非常正当的理由想要这个。

首先，我想争辩说，拥有一个 get-only 属性并不一定会转化为只读。我将其解释为“从这个接口/抽象类中你可以得到这个值”，这并不意味着该接口/抽象类的某些实现不需要用户/程序显式地设置这个值。抽象类的目的是实现部分所需功能。我完全看不出为什么继承的类不能在不违反任何合同的情况下添加 setter。

以下是我今天需要的一个简化示例。我最终不得不在我的界面中添加一个 setter 来解决这个问题。添加 setter 而不是添加 SetProp 方法的原因是接口的一个特定实现使用 DataContract/DataMember 来序列化 Prop，如果我不得不添加另一个属性只是为了达到目的，这将变得不必要地复杂的序列化。

```
interface ITest
{
    // Other stuff
    string Prop { get; }
}

// Implements other stuff
abstract class ATest : ITest
{
    abstract public string Prop { get; }
}

// This implementation of ITest needs the user to set the value of Prop
class BTest : ATest
{
    string foo = "BTest";
    public override string Prop
    {
        get { return foo; }
        set { foo = value; } // Not allowed. 'BTest.Prop.set': cannot override because 'ATest.Prop' does not have an overridable set accessor
    }
}

// This implementation of ITest generates the value for Prop itself
class CTest : ATest
{
    string foo = "CTest";
    public override string Prop
    {
        get { return foo; }
        // set; // Not needed
    }
} 
```

我知道这只是一个“我的 2 美分”帖子，但我觉得原始海报并试图合理化这是一件好事对我来说似乎很奇怪，特别是考虑到直接从界面。

此外，关于使用 new 而不是 override 的提及在这里不适用，它根本不起作用，即使它这样做也不会给你想要的结果，即接口描述的虚拟 getter。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-09-13T20:50:42.577

我同意不能覆盖派生类型中的 getter 是一种反模式。Read-Only 指定缺乏实现，而不是纯功能的合同（由最高投票答案暗示）。

我怀疑微软有这个限制，要么是因为同样的误解被宣传了，要么是因为简化了语法；不过，现在可以应用范围来单独获取或设置，也许我们可以希望覆盖也可以。

最高投票答案所表明的误解，即只读属性应该以某种方式比读/写属性更“纯”是荒谬的。简单看一下框架中很多常见的只读属性；该值不是常数/纯函数；例如， DateTime.Now 是只读的，但不是纯函数值。尝试“缓存”只读属性的值，假设它下次将返回相同的值是有风险的。

无论如何，我使用以下策略之一来克服此限制；两者都不完美，但可以让你克服这种语言缺陷：

```
 class BaseType
   {
      public virtual T LastRequest { get {...} }
   }

   class DerivedTypeStrategy1
   {
      /// get or set the value returned by the LastRequest property.
      public bool T LastRequestValue { get; set; }

      public override T LastRequest { get { return LastRequestValue; } }
   }

   class DerivedTypeStrategy2
   {
      /// set the value returned by the LastRequest property.
      public bool SetLastRequest( T value ) { this._x = value; }

      public override T LastRequest { get { return _x; } }

      private bool _x;
   } 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-17T12:37:06.807

你也许可以通过创建一个新属性来解决这个问题：

```
public new int Bar 
{            
    get { return 0; }
    set {}        
}

int IBase.Bar { 
  get { return Bar; }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-20T11:03:32.240

我可以理解您的所有观点，但实际上，C# 3.0 的自动属性在这种情况下变得毫无用处。

你不能做这样的事情：

```
public class ConcreteClass : BaseClass
{
    public override int Bar
    {
        get;
        private set;
    }
} 
```

IMO，C# 不应该限制这种情况。开发人员有责任相应地使用它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-12-19T02:49:49.500

问题是，无论出于何种原因，微软决定应该存在三种不同类型的属性：只读、只写和读写，在给定的上下文中，只有一个可能存在给定签名；属性只能被相同声明的属性覆盖。要执行您想要的操作，有必要创建两个具有相同名称和签名的属性——其中一个是只读的，另一个是读写的。

就个人而言，我希望可以废除“属性”的整个概念，除了可以使用类似于属性的语法作为语法糖来调用“get”和“set”方法。这不仅有利于 'add set' 选项，而且还允许 'get' 返回与 'set' 不同的类型。虽然这种能力不会经常使用，但有时让“get”方法返回包装器对象而“set”可以接受包装器或实际数据可能会很有用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-06-24T04:03:49.757

这是一个解决方法，以使用反射实现此目的：

```
var UpdatedGiftItem = // object value to update;

foreach (var proInfo in UpdatedGiftItem.GetType().GetProperties())
{
    var updatedValue = proInfo.GetValue(UpdatedGiftItem, null);
    var targetpropInfo = this.GiftItem.GetType().GetProperty(proInfo.Name);
    targetpropInfo.SetValue(this.GiftItem, updatedValue,null);
} 
```

这样我们可以在只读属性上设置对象值。但可能不适用于所有场景！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-10-22T20:13:49.750

您应该将问题标题更改为详细说明您的问题仅与覆盖抽象属性有关，或者您的问题通常与覆盖类的 get-only 属性有关。

* * *

**如果前者**（覆盖抽象属性）

那个代码没用。单独的基类不应该告诉您您被迫覆盖 Get-Only 属性（可能是接口）。基类提供可能需要来自实现类的特定输入的通用功能。因此，通用功能可能会调用抽象属性或方法。在给定的情况下，常见的功能方法应该要求您覆盖抽象方法，例如：

```
public int GetBar(){} 
```

但是如果你无法控制它，并且基类的功能从它自己的公共属性中读取（奇怪），那么就这样做：

```
public abstract class BaseClass
{
    public abstract int Bar { get; }
}

public class ConcreteClass : BaseClass
{
    private int _bar;
    public override int Bar
    {
        get { return _bar; }
    }
    public void SetBar(int value)
    {
        _bar = value;
    }
} 
```

我想指出（奇怪的）评论：我想说一个最佳实践是让一个类不使用它自己的公共属性，而是在它们存在时使用它的私有/受保护字段。所以这是一个更好的模式：

```
public abstract class BaseClass {
    protected int _bar;
    public int Bar { get { return _bar; } }
    protected void DoBaseStuff()
    {
        SetBar();
        //Do something with _bar;
    }
    protected abstract void SetBar();
}

public class ConcreteClass : BaseClass {
    protected override void SetBar() { _bar = 5; }
} 
```

* * *

**如果是后者**（覆盖类的 get-only 属性）

每个非抽象属性都有一个 setter。否则它是无用的，你不应该关心使用它。微软不必让你做你想做的事。原因是：setter 以某种形式存在，你可以轻松地完成你想要**的 Veerryy**。

基类或任何您可以使用 读取属性的类都`{get;}`具有**某种**针对该属性的公开设置器。元数据将如下所示：

```
public abstract class BaseClass
{
    public int Bar { get; }
} 
```

但是实现将具有复杂性的两端：

最简单的：

```
public abstract class BaseClass
{
    private int _bar;
    public int Bar { 
        get{
            return _bar;
        }}
    public void SetBar(int value) { _bar = value; }
} 
```

最复杂的：

```
public abstract class BaseClass
{
    private int _foo;
    private int _baz;
    private int _wtf;
    private int _kthx;
    private int _lawl;

    public int Bar
    {
        get { return _foo * _baz + _kthx; }
    }
    public bool TryDoSomethingBaz(MyEnum whatever, int input)
    {
        switch (whatever)
        {
            case MyEnum.lol:
                _baz = _lawl + input;
                return true;
            case MyEnum.wtf:
                _baz = _wtf * input;
                break;
        }
        return false;
    }
    public void TryBlowThingsUp(DateTime when)
    {
        //Some Crazy Madeup Code
        _kthx = DaysSinceEaster(when);
    }
    public int DaysSinceEaster(DateTime when)
    {
        return 2; //<-- calculations
    }
}
public enum MyEnum
{
    lol,
    wtf,
} 
```

我的观点是，无论哪种方式，你都暴露了二传手。在您的情况下，您可能想要覆盖`int Bar`，因为您不希望基类处理它，无权查看它是如何处理它的，或者被要求违背您的意愿对一些代码进行真正的快速'n'dirty .

**在后者和前者**（结论）

长话短说：微软没有必要改变任何东西。您可以选择如何设置实现类，并且在没有构造函数的情况下，使用全部或不使用基类。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-10-09T17:28:10.477

仅针对一小部分用例的解决方案，但是：在 C# 6.0 中，“只读”setter 会自动添加用于覆盖的仅 getter 属性。

```
public abstract class BaseClass
{
    public abstract int Bar { get; }
}

public class ConcreteClass : BaseClass
{
    public override int Bar { get; }

    public ConcreteClass(int bar)
    {
        Bar = bar;
    }
} 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-09-17T12:17:39.617

因为那会破坏封装和实现隐藏的概念。考虑一下当你创建一个类，发布它，然后你的类的消费者让他自己能够设置一个你最初只为其提供一个 getter 的属性的情况。它会有效地破坏您在实现中可以依赖的类的任何不变量。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2010-08-21T20:06:44.347

这并非不可能。您只需在属性中使用“new”关键字。例如，

```
namespace {
    public class Base {
        private int _baseProperty = 0;

        public virtual int BaseProperty {
            get {
                return _baseProperty;
            }
        }

    }

    public class Test : Base {
        private int _testBaseProperty = 5;

        public new int BaseProperty {
            get {
                return _testBaseProperty;
            }
            set {
                _testBaseProperty = value;
            }
        }
    }
} 
```

这种方法似乎满足了本次讨论的双方。使用“new”打破了基类实现和子类实现之间的契约。当一个类可以有多个契约（通过接口或基类）时，这是必要的。

希望这可以帮助

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2012-07-13T12:42:15.073

基类中的只读属性表示此属性表示始终可以从类中确定的值（例如，与对象的 (db-) 上下文匹配的枚举值）。因此，确定价值的责任留在班级内。

在此处添加 setter 会导致一个尴尬的问题：如果您将值设置为它已经拥有的单个可能值之外的任何其他值，则会发生验证错误。

不过，规则通常有例外。很有可能，例如在一个派生类中，上下文将可能的枚举值缩小到 10 个中的 3 个，但该对象的用户仍然需要决定哪个是正确的。派生类需要将确定值的责任委托给该对象的用户。 **重要的**是要意识到这个对象的用户**应该很清楚这个异常**并承担设置正确值的责任。

在这种情况下，我的解决方案是将属性保留为只读，并向派生类添加新的读写属性以支持异常。原始属性的覆盖将简单地返回新属性的值。新属性可以有一个正确的名称来正确指示此异常的上下文。

这也支持了 Gishu 的有效言论：“尽可能避免误解”。

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2008-09-17T13:15:24.703

因为具有只读属性（没有设置器）的类可能有充分的理由。例如，可能没有任何底层数据存储。允许你创建一个 setter 会破坏类的约定。这只是糟糕的面向对象。

* * *

## 回答 #15

> 赞同：-3
> 
> 时间：2008-09-17T12:17:11.783

因为在 IL 级别，读/写属性转换为两个（getter 和 setter）方法。

覆盖时，您必须继续支持底层接口。如果您可以添加一个 setter，那么您将有效地添加一个新方法，就您的类的接口而言，该方法对外部世界是不可见的。

诚然，添加新方法本身不会破坏兼容性，但由于它会保持隐藏状态，因此决定禁止这样做是完全合理的。

* * *

## 回答 #16

> 赞同：-7
> 
> 时间：2008-09-17T12:17:54.047

因为 Baseclass 的作者已经明确声明 Bar 必须是只读属性。派生打破这个契约并使其可读写是没有意义的。

我在这方面与微软合作。
假设我是一名新程序员，被告知要针对 Baseclass 派生进行编码。我写了一些假设 Bar 不能被写入的东西（因为 Baseclass 明确声明它是一个只能获取的属性）。现在有了您的推导，我的代码可能会损坏。例如

```
public class BarProvider
{ BaseClass _source;
  Bar _currentBar;

  public void setSource(BaseClass b)
  {
    _source = b;
    _currentBar = b.Bar;
  }

  public Bar getBar()
  { return _currentBar;  }
} 
```

由于 Bar 无法根据 BaseClass 接口进行设置，因此 BarProvider 假设缓存是安全的 - 因为 Bar 无法修改。但是，如果在派生中可以设置，则如果有人在外部修改了 _source 对象的 Bar 属性，则此类可能会提供陈旧的值。关键是'*保持开放，避免做鬼鬼祟祟的事情和令人惊讶*的事情'

**更新**：*Ilya Ryzhenkov 问道“那为什么界面不按照相同的规则运行呢？”* 嗯..当我想到它时，这变得更加混乱。
接口是一个契约，它说“期望一个实现有一个名为 Bar 的读取属性。” **如果我看到一个接口，就个人**而言，我不太可能做出只读的假设。当我在接口上看到一个 get-only 属性时，我将其读作“任何实现都会公开此属性 Bar”......在基类上它单击为“Bar 是一个只读属性”。当然，从技术上讲，您并没有违反合同..您做得更多。所以从某种意义上说，你是对的。我最后会说“尽可能避免出现误解”。

# pdf - 语言为 PL（波兰语）时的大 PDF 文件

> ID：82441
> 
> 赞同：2
> 
> 时间：2008-09-17T12:14:30.747
> 
> 标签：pdf, abap

我使用功能模块将 Smart Form 输出转换为 PDF `SX_OBJECT_CONVERT_OTF_PDF`。

我的问题是，当语言是 PL（波兰语）时，PDF 文件比 EN 语言大 10 倍。为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-07T08:34:46.867

Gunstick的答案可能是正确的。Sap note：843480 讨论这个问题。

从 620 版开始，支持补丁可以压缩 pdf 元素（例如字体）。生成的 pdf 将比唯一的英文版大，但可能不到 10 倍。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T12:42:03.877

这可能是因为波兰语使用了一种特定的字体（特殊字符），该字体默认情况下未安装在操作系统上。因此，pdf 转换器将完整的字体包含到文档中，以便在目的地正确呈现。

不过，这只是猜测。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-12-08T03:56:49.940

你可以试试这个：[http ://lucattelli.com/blog/?page_id=478](http://lucattelli.com/blog/?page_id=478)

此 FM 可以获取二进制 PDF 并将其转换为 BASE 64 并将其作为邮件附件发送。

看看有没有帮助

# c# - 扩展方法不适用于接口

> ID：82442
> 
> 赞同：6
> 
> 时间：2008-09-17T12:14:31.667
> 
> 标签：c#, .net, extension-methods

受 MVC 店面启发，我正在进行的最新项目是在 IQueryable 上使用扩展方法来过滤结果。

我有这个界面；

```
IPrimaryKey
{
  int ID { get; }
} 
```

我有这个扩展方法

```
public static IPrimaryKey GetByID(this IQueryable<IPrimaryKey> source, int id)
{
    return source(obj => obj.ID == id);
} 
```

假设我有一个类 SimpleObj，它实现了 IPrimaryKey。当我有一个 SimpleObj 的 IQueryable 时，GetByID 方法不存在，除非我明确地将其转换为 IPrimaryKey 的 IQueryable，这不太理想。

我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-17T17:15:31.257

如果做得对，它会起作用。cfeduke 的解决方案有效。但是，您不必使`IPrimaryKey`接口通用，实际上，您根本不必更改原始定义：

```
public static IPrimaryKey GetByID<T>(this IQueryable<T> source, int id) where T : IPrimaryKey
{
    return source(obj => obj.ID == id);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-17T17:10:11.377

编辑：[Konrad](https://stackoverflow.com/questions/82442/extension-methods-not-working-for-an-interface#85503)的解决方案更好，因为它更简单。下面的解决方案有效，但仅在类似于 ObjectDataSource 的情况下才需要，在这种情况下，通过反射检索类的方法，而无需遍历继承层次结构。显然，这不会发生在这里。

这是可能的，当我设计一个使用 ObjectDataSource 的自定义实体框架解决方案时，我不得不实现类似的模式：

```
public interface IPrimaryKey<T> where T : IPrimaryKey<T>
{
    int Id { get; }
}

public static class IPrimaryKeyTExtension
{
     public static IPrimaryKey<T> GetById<T>(this IQueryable<T> source, int id) where T : IPrimaryKey<T>
     {
         return source.Where(pk => pk.Id == id).SingleOrDefault();
     }
}

public class Person : IPrimaryKey<Person>
{
    public int Id { get; set; }
} 
```

使用片段：

```
var people = new List<Person>
{
    new Person { Id = 1 },
    new Person { Id = 2 },
    new Person { Id = 3 }
};

var personOne = people.AsQueryable().GetById(1); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T12:16:53.597

由于泛型没有遵循继承模式的能力，因此这不起作用。IE。IQueryable<SimpleObj> 不在 IQueryable<IPrimaryKey> 的继承树中

# delphi - Delphi 2009 切换到 Unicode(/UTF16) 对可执行文件大小和内存占用有什么影响（如果有的话）？

> ID：82454
> 
> 赞同：2
> 
> 时间：2008-09-17T12:15:58.573
> 
> 标签：delphi, unicode, delphi-2009

这是“毫无疑问太愚蠢”部门的一个：

好吧，正如主题所说：有影响吗？如果有，多少钱？我的代码和 DFM 资源中的所有字符串文字现在是否会在已编译的二进制文件中占用两倍的空间？已编译应用程序的运行时内存使用情况如何？现在所有的字符串变量会占用两倍的 RAM 吗？我应该打扰吗？

我记得在早期的预发布网络广播中有人问过类似的问题，但我不记得答案了。而且由于试用期只有 14 天，我不会在我需要的第三方库更新之前自己尝试（预计大约一个月）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T13:01:42.753

D2009 使用 UTF-16 作为默认字符串类型，但如果需要，您可以将变量设为 UTF-8。

Jan Goyvaerts在一篇不错的博客文章中[讨论了大小/速度的权衡。](http://www.micro-isv.asia/2008/09/speed-benefits-of-using-the-native-win32-string-type/)

DFM 中的字符串文字至少从 D7 开始就是 UTF-8。因此，D2009 的 DFM 中的字符串不会增加大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-06T00:19:27.670

我现在终于掌握了 Delphi 2009，在进行了必要的调整之后，我的项目现在可以编译并运行得很好。:)

为了快速获得结果，我最初不得不注释掉应用程序的一个稍微复杂的模块，因此它还不是 100% 可比的，但它似乎已经足够安全，可以预测尽管我们的源代码中有大量的字符串文字（过多的调试日志消息) 使用 Delphi 2009 编译的二进制文件的大小可能与以前大致相同——如果不是实际上更少的话！

我想知道，Delphi 编译器实际上是否以任何方式对二进制文件或至少其资源部分执行任何类型的压缩？我真的希望对 UTF-16 字符串文字的更改会对这个特定的应用程序产生更大的影响。文字是否真的在二进制文件中存储为（未压缩的）UTF-16？

我还没有时间研究内存占用的差异。

**编辑：**不直接与 Unicode 相关，但绝对相关：Andreas Hausladen 最近发布了一个有趣的关于`{$STRINGCHECKS}`编译器选项（顺便说一句：默认打开）对编译的可执行文件大小的（显着）影响：http: [//andy.jgknet.de /博客/?p=487](http://andy.jgknet.de/blog/?p=487)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-09-17T17:26:52.430

我一直在等待一个 Unicode VCL 太多年了，终于我们看到了。我认为大多数应用程序不需要担心大小问题，因为它们无论如何都没有那么多字符串文字或在内存中存储大量数据。

可用性问题更加重要，以证明尽可能多地使用 Unicode。

如果某些开发人员想要创建一个小型 exe，他们可以使用 AnsiString 手动优化（如果 i18n 不是问题）。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2008-09-17T12:35:49.307

我已经很多年没有使用过 Delphi，但这可能取决于他们使用的 Unicode 编码。UTF8 与常规 ASCII 字符集完全相同（当您进入外来字符时，它只使用一个以上的字节）。UTF16 可能有点臃肿。

# perforce - 强制执行。获取沙箱中的文件状态

> ID：82468
> 
> 赞同：3
> 
> 时间：2008-09-17T12:17:34.763
> 
> 标签：perforce

如何确定客户端中文件的状态，我想知道文件是否需要更新、修补或修改等。在 CVS 中，我曾经简单地运行“cvs -n -q update.> file ”。稍后查找 M,U,P,C 属性以获取文件的当前状态。

在 perforce 中，“p4 sync -n”不会像“cvs -n -q update”那样给出输出。在 Perforce 的情况下，我如何查看文件的当前状态？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-17T13:06:38.220

据我所知，没有一个命令可以准确地给你你想要的东西。在查看更新命令的作用时，Perforce 中没有单一的替代方法。我认为您最接近的将是使用“p4 fstat”命令并从那里解析输出以获取您需要的信息。

您可能会发现[此](http://kb.perforce.com/Conversions/CvsToPerforce/CvsVsPerforce)页面很有帮助。

我还发现这个[链接](http://public.perforce.com/wiki/P4Wrapper)指向一个 p4wrapper，它声称将 CVS 命令（包括更新）包装到一个脚本中。周围可能还有其他类似的。

我还想评论说，当问“我该怎么做......”时，这个问题的答案就像 Perforce 的许多人一样。答案通常归结为编写脚本以获取 perforce 命令的输出以获得所需的结果。他们的理念是提供简单的命令并让开发人员构建基本功能。爱它或恨它，这是基本模式。可以在[此处](http://public.perforce.com/wiki/Welcome_to_the_Public_Depot)的 Perforce Public Depot 中找到许多好的脚本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T12:57:49.440

不确定这是否是您要查找的内容，但 p4 diff 命令有一些有用的选项。从用法上看：

```
    -sa 打开的文件与修订版本不同
            在仓库，或失踪。  
    -sb 为已解析的集成文件打开
            但解决后已修改。  
    -sd 客户端上缺少的未打开文件。  
    -se 与修订版不同的未打开文件
            在仓库。  
    -sl 每个未打开的文件，连同文件的状态
            与其相比，“相同”、“差异”或“缺失”
            在仓库中进行修订。  
    -sr 打开的文件与
            仓库。

```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-02-09T12:42:23.597

全面披露：我为 Perforce 工作

在即将发布的 2012.1 版本中将有 2 个新命令“p4 status”和“p4 reconcile”。有关详细信息，请参阅以下内容：

> [http://www.perforce.com/blog/120126/new-20121-p4reconcile-p4status](http://www.perforce.com/blog/120126/new-20121-p4reconcile-p4status)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T12:40:43.583

不太清楚你的意思。如果您正在谈论查看哪些文件需要“解析”（使用 perforce 语言），那么您可以使用：

```
p4 resolve -n 
```

请参阅此处的 p4 命令行手册网站： [http ://www.perforce.com/perforce/doc.current/manuals/cmdref/resolve.html#1040665](http://www.perforce.com/perforce/doc.current/manuals/cmdref/resolve.html#1040665)

如果您使用该客户端，P4V 还有一个很好的功能可以突出显示未提交和脏文件。右键单击工作区视图中的文件夹，然后选择“协调脱机工作”。经过一些处理后，您将获得与软件仓库不同步的文件列表。

希望这可以帮助。

# c# - 如何在 .NET 应用程序中捕获所有异常/崩溃

> ID：82483
> 
> 赞同：39
> 
> 时间：2008-09-17T12:19:02.403
> 
> 标签：c#, .net, exception-handling

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-09-17T12:21:57.047

您可以将事件处理程序添加到 AppDomain.UnhandledException 事件，当异常被抛出但未被捕获时，它将被调用。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-09-17T14:44:28.747

与其他人发布的内容相反，捕获所有异常并没有错。重要的是要妥善处理它们。如果您有堆栈溢出或内存不足的情况，应用程序应该为它们关闭。另外，请记住，OOM 条件可能会阻止您的异常处理程序正确运行。例如，如果您的异常处理程序显示一个带有异常消息的对话框，如果您的内存不足，则可能没有足够的空间用于对话框显示。最好记录下来并立即关闭。

正如其他人所提到的，您可以处理 UnhandledException 和 ThreadException 事件来收集可能会错过的异常。然后只需在主循环周围抛出一个异常处理程序（假设是一个 winforms 应用程序）。

此外，您应该知道 OutOfMemoryExceptions 并不总是因内存不足而引发。OOM 条件可以在您的代码或框架中触发各种异常，这些异常不一定与真正的底层条件内存不足这一事实有关。当根本原因实际上是内存不足时，我经常看到 InvalidOperationException 或 ArgumentException。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-09-17T13:46:35.470

[我们的主持人 Jeff Atwood 在 codeproject 中的这篇文章](http://www.codeproject.com/KB/exception/ExceptionHandling.aspx) 正是您所需要的。包括捕获未处理异常的代码和向用户显示有关崩溃信息的最佳实践。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-09-17T12:24:32.173

**Global.asax**类是您的最后一道防线。看着：

```
protected void Application_Error(Object sender, EventArgs e) 
```

方法

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-09-17T12:43:15.373

请注意，某些异常很容易被捕获 - 或者大部分是无法捕获的，

*   OutOfMemoryException：您在 catch 处理程序中执行的任何操作都可能分配内存（在 CLR 的托管或非托管端）并因此触发另一个 OOM
*   StackOverflowException：取决于 CLR 是否足够早地检测到它，您可能会收到通知。最坏的情况是，它只会终止进程。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-17T12:23:57.773

您可以使用 AppDomain.CurrentDomain.UnhandledException 来获取事件。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-17T14:21:55.167

尽管在没有计划正确处理它们的情况下捕获**所有**异常肯定是一种不好的做法，但我认为应用程序应该以某种优雅的方式失败。崩溃不应该把用户吓死，至少它应该显示错误的描述，向技术支持人员报告的一些信息，理想情况下是一个关闭应用程序并重新启动它的按钮。在理想情况下，应用程序应该能够将用户数据转储到磁盘上，然后尝试恢复它（但我发现这要求太多了）。

无论如何，我通常使用：

```
AppDomain.CurrentDomain.UnhandledException 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-09-17T12:27:08.580

您也可以使用 Application.ThreadException 事件。

曾经我正在开发一个在基于 COM 的应用程序中运行的 .NET 应用程序；这个事件非常有用，因为 AppDomain.CurrentDomain.UnhandledException 在这种情况下不起作用。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-17T12:29:19.697

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-17T13:43:15.150

请注意，捕获这些未处理的异常可能会改变应用程序的安全要求。您的应用程序可能会在某些情况下停止正常运行（从网络共享运行时等）。一定要彻底测试。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-20T18:05:11.440

同时使用 AppDomain.CurrentDomain.UnhandledException Application.ThreadException 并没有什么坏处

但请记住，辅助线程上的异常不会被这些处理程序捕获；如果需要，将[SafeThread](http://www.codeproject.com/KB/threads/SafeThread.aspx)用于辅助线程

# c++ - 有没有人尝试过 C++ 的事务性内存？

> ID：82495
> 
> 赞同：10
> 
> 时间：2008-09-17T12:20:08.690
> 
> 标签：c++, multithreading, locking, intel, transactional-memory

我正在查看英特尔的“whatif”站点和他们的事务内存编译器（每个线程都必须进行原子提交或回滚系统内存，就像数据库一样）。

这似乎是替换锁和互斥锁的一种有前途的方法，但我找不到很多推荐。这里有人有意见吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-17T15:12:27.993

我没有使用英特尔的编译器，但是，Herb Sutter 对此有一些有趣的评论......

来自[Sutter Speaks：并发的未来](http://www.devx.com/go-parallel/Article/37839)

**您是否看到了对事务内存的大量兴趣和使用，或者这个概念对于大多数开发人员来说太难掌握了？**

目前还无法回答谁在使用它，因为它还没有推向市场。英特尔有一个软件事务内存编译器原型。但如果问题是“开发人员使用起来是否太难了？” 答案是我当然希望不会。关键是它比锁更容易。这是研究范围内唯一希望大大减少我们对锁的使用的主要事物。它永远不会完全替换锁，但部分替换它们是我们唯一的大希望。

有一些限制。特别是，一些 I/O 本质上不是事务性的——你不能采用一个原子块来提示用户输入他的名字并从控制台读取名字，如果它与另一个事务冲突，就自动中止并重试该块；如果您提示他两次，用户可以分辨出区别。不过，事务性内存非常适合只接触内存的东西。

我认识的每个主要硬件和软件供应商都在研发中拥有多个事务性内存工具。有关于基本问题的理论答案的会议和学术论文。我们还没有到可以发货的 T 型阶段。您可能会看到早期的有限原型，在这些原型中您无法进行无限制的事务性内存——例如，您只能读取和写入 100 个内存位置。不过，这对于启用更多无锁算法仍然非常有用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-17T15:29:01.840

Dobb 博士去年有一篇关于这个概念的文章：Calum Grant 的 Transactional Programming -- [http://www.ddj.com/cpp/202802978](http://www.ddj.com/cpp/202802978)

它包括使用他的示例库的一些示例、比较和结论。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-04-02T16:41:00.117

我在一些函数式编程思想的基础上构建了组合 STM 库。它不需要任何编译器支持（除了它使用 C++17），不会带来新的语法。一般采用Haskell的[STM 库的接口。](https://hackage.haskell.org/package/stm)

所以，我的图书馆有几个不错的属性：

*   一元组合。每个事务都是名为 的自定义 monad 中的计算`STML`。您可以将单子事务组合成更大的单子事务。
*   事务与数据模型分离。您使用事务变量 ( ) 构建并发数据模型`TVars`并在其上运行事务。
*   有`retry`组合器。它允许您重新运行事务。对于构建简短易懂的交易非常有用。
*   有不同的单子组合器可以简单地表达计算。
*   有`Context`。每个计算都应该在某些上下文中运行，而不是在全局运行时中。因此，如果您需要多个独立的 STM 集群，您可以拥有许多不同的上下文。
*   从概念上讲，实现非常简单。至少， Haskell 中[的参考实现](https://github.com/graninas/stm-free)是这样，但由于缺乏对函数式编程的良好支持，我不得不重新发明几种 C++ 实现方法。

该库显示出非常好的稳定性和鲁棒性，即使我们认为它是实验性的。此外，我的方法为通过性能、功能、全面性等改进库提供了很多可能性。

为了展示它的工作，我已经解决了这个`Dining Philosophers`任务。您可以在下面的链接中找到代码。示例交易：

```
STML<bool> takeFork(const TVar<Fork>& tFork)
{
    STML<bool> alreadyTaken = withTVar(tFork, isForkTaken);
    STML<Unit> takenByUs    = modifyTVar(tFork, setForkTaken);
    STML<bool> success      = sequence(takenByUs, pure(true));
    STML<bool> fail         = pure(false);
    STML<bool> result       = ifThenElse(alreadyTaken, fail, success);
    return result;
}; 
```

**更新** 我写了一个教程，你可以在[这里](https://gist.github.com/graninas/c7e0a603f3a22c7e85daa4599bf92525)找到它。

*   [餐饮哲学家任务](https://github.com/graninas/cpp_philosophers_stm)
*   [我的 C++ STM 库](https://github.com/graninas/cpp_stm_free)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T21:24:22.843

Sun Microsystems 宣布他们将在明年发布一款代号为 Rock 的新处理器，该处理器具有对事务内存的硬件支持。它会有一些限制，但这是一个很好的第一步，它应该使程序员更容易用事务替换锁/互斥锁，**并**期望从中获得良好的性能。

对于由 Sun 从事事务性记忆和摇滚研究的研究人员之一 Mark Moir 就该主题进行的有趣演讲，请查看此[链接](http://sunfeedroom.sun.com/ifr_main.jsp?nsid=d6089cb92:11c7211bc9a:42e&fr_story=FRdamp266994&st=1221685974862&mp=FLV&cpf=false&fr=091708_051254544_6089cb92x11c7211bc9ax42f&rdm=860981.4080409706)。

有关 Sun 关于 Rock 和 Transactional Memory 的更多信息和公告，请访问此[链接](http://research.sun.com/spotlight/2007/2007-08-13_transactional_memory.html)。

强制性的[维基百科条目](http://en.wikipedia.org/wiki/Rock_processor):)

最后，威斯康星大学麦迪逊分校的[这个链接](http://www.cs.wisc.edu/trans-memory/biblio/index.html)包含关于事务性内存的大部分研究的参考书目，无论是硬件相关的还是软件相关的。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-09-17T12:22:43.457

在某些情况下，我认为这是有用的，甚至是必要的。

但是，即使处理器具有使此过程更容易的特殊指令，与互斥锁或信号量相比，仍然存在较大的开销。根据它的实现方式，它也可能会影响实时性能（必须停止中断，或阻止它们写入您的共享区域）。

我的期望是，如果实现了这一点，那么只有给定内存空间的一部分才需要它，因此影响可能是有限的。

-亚当

# javascript - 是否可以使用 JavaScript 从 / 到 Flash 小程序外部拖放？

> ID：82509
> 
> 赞同：6
> 
> 时间：2008-09-17T12:22:01.617
> 
> 标签：javascript, flash, drag-and-drop

假设我想要一个包含 Flash 小程序的网页，并且我想从网页的其余部分拖放一些对象，这可能吗？

如果您知道某个网站可以做到这一点，那就太好了！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-17T17:19:27.330

This one intrigued me. I know jessegavin posted some code while I went to figure this out, but this one is tested. I have a super-simple working example that lets you drag to and from flash. It's pretty messy as I threw it together during my lunch break.

Here's the [demo](http://enobrev.github.io/DragSWF/)

And the [source](https://github.com/enobrev/DragSWF)

The base class is taken directly from the [External Interface LiveDocs](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/external/ExternalInterface.html). I added MyButton so the button could have some text. The majority of the javascript comes from the same LiveDocs example.

I compiled this using mxmlc.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T15:50:37.420

**免责声明**我根本没有测试过这段代码，但这个想法应该可行。此外，这仅处理拖动***到***Flash 电影。

下面是一些使用[ExternalInterface](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/external/ExternalInterface.html)类的 Actionscript 3.0 代码。

```
import flash.display.Sprite;
import flash.external.ExternalInterface;
import flash.net.URLLoader;
import flash.net.URLRequest;

if (ExternalInterface.available) {
  ExternalInterface.addCallback("handleDroppedImage", myDroppedImageHandler);
}

private function myDroppedImageHandler(url:String, x:Number, y:Number):void {

  var container:Sprite = new Sprite();
  container.x = x;
  container.y = y;
  addChild(container);

  var loader:Loader = new Loader();
  var request:URLRequest = new URLRequest(url);
  loader.load(request);

  container.addChild(loader);
} 
```

这是 HTML/jQuery 代码

```
<html>
<head>
  <title>XHTML 1.0 Transitional Template</title>
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js"></script>
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.5.2/jquery-ui.min.js"></script>
  <script type="text/javascript">
    $(function() {
      $("#dragIcon").draggable();

      $("#flash").droppable({ 
        tolerance : "intersect",
        drop: function(e,ui) {

          // Get the X,Y coords relative to to the flash movie
          var x = $(this).offset().left - ui.draggable.offset().left;
          var y = $(this).offset().top - ui.draggable.offset().top;

          // Get the url of the dragged image
          var url = ui.draggable.attr("src");

          // Get access to the swf
          var swf = ($.browser.msie) ? document["MyFlashMovie"] : window["MyFlashMovie"];

          // Call the ExternalInterface function
          swf.handleDroppedImage(url, x, y);

           // remove the swf from the javascript DOM
          ui.draggable.remove();
        }
      });
    });
  </script>
</head>
<body>

  <img id="dragIcon" width="16" height="16" alt="drag me" />

  <div id="flash">
    <object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"
      id="MyFlashMovie" width="500" height="375"
      codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab">
      <param name="movie" value="MyFlashMovie.swf" />
      <param name="quality" value="high" />
      <param name="bgcolor" value="#869ca7" />
      <param name="allowScriptAccess" value="sameDomain" />
      <embed src="MyFlashMovie.swf" quality="high" bgcolor="#869ca7"
        width="500" height="375" name="MyFlashMovie" align="middle"
        play="true" loop="false" quality="high" allowScriptAccess="sameDomain"
        type="application/x-shockwave-flash"
        pluginspage="http://www.macromedia.com/go/getflashplayer">
      </embed>
    </object>
  </div>

</body>
</html> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T12:30:52.720

我会说如果您检测到该项目被拖到包含 Flash 内容的项目上，并且您将拖动的对象设置为具有高于 Flash 的 z-index，则可以拖放到 Flash *。*然后，当它被丢弃时，您可以使用 javascript 与 Flash 交谈，告诉它丢弃的位置和内容。

然而，相反的方法可能更难，因为您必须检测对象何时触及 Flash 电影的边框并将其“传递”给 javascript 处理程序（在 html 中创建它，将其隐藏在 Flash 中）。

问题可能是要知道这是否值得麻烦，或者您是否可以在 JS 或 Flash 中实现一切？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T13:10:51.720

等等，封装点是有效的，但是 flash 可以执行 JS 函数，Seldaek 是正确的，具有更高 z-index 的 HTML 元素应该浮动在 flash 电影上。因此，如果您在 JS 中完成所有拖动处理并让 flash 读取其自身的尺寸和指针在应用程序中的位置，它可以向 JS 方法发出信号，即使（尤其是）当指针离开Flash 应用程序的边界。不过它会很毛茸茸。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T12:23:46.980

如果整个站点是一个大的嵌入式闪存文件，那么是的，这是可能的。

我不认为你可以通过任何其他方式实现它

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T12:32:19.737

在 Flash 中不可能 - 除非您想拖动到同一个 Flash 应用程序内的目标。

可能可以用一个签名的 Java 小程序来完成（但谁愿意走那条路呢？）

# keyboard - 对可编程平铺窗口管理器 ion3 的评论

> ID：82518
> 
> 赞同：1
> 
> 时间：2008-09-17T12:22:41.507
> 
> 标签：keyboard, window-managers, tiling

我发现可编程的、平铺的、以键盘为中心的窗口管理器[ion3](http://www.modeemi.fi/~tuomov/ion/)的概念非常吸引人，但我认为需要一些时间来根据您的需要对其进行自定义，直到您可以真正评估这个完全不同的 UI 概念。

因此，我想阅读那些尝试将其作为编程环境（尤其是使用 emacs/gcc）的人的评论。

（ion3作者关于linux-distros的政策对我来说并不容易遵循，但这不应该是这里的重点......）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-09T03:31:48.617

我每天使用ion3。这是一个很棒的窗口管理器。平铺界面确实使您能够最大限度地利用房地产。一旦您根据自己的喜好进行设置，通过键盘导航会更加高效。一旦您习惯了标签/附加键序列，即使在图块之间移动应用程序也不是那么难。

使用 ion3、Vimperator 和我白天打开的各种贝壳——我几乎不使用啮齿动物。

撇开作者的意见不谈——可以在以下位置找到根据自己的喜好配置/扩展 Ion 的好资源：

[使用 Lua 配置和扩展 Ion3](http://modeemi.fi/%7Etuomov/ion-doc-3/ionconf/ionconf.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-10T16:53:09.403

我已经每天使用 Ion 将近两年了。好东西：

*   易于从键盘使用。
*   很好地处理多个屏幕（Xinerama）（一旦你有 mod_xinerama 插件），特别是在我的情况下，屏幕的大小不同。
*   窗口将出现的位置非常可预测。
*   拆分、调整大小和移动窗口非常容易。
*   每个屏幕上有多个独立的工作区。
*   非常快速和可靠。

坏事：

*   太多不同的快捷方式。例如，有单独的键用于移动到下一个选项卡、下一个帧、下一个屏幕和下一个工作区。
*   使用大量小窗口的应用程序工作得非常糟糕（例如 Gimp），因为它最初将所有小窗口最大化。
*   子对话框可能会引起麻烦。有时，当您希望它们在同一选项卡中时，它们会在单独的选项卡中打开，或者有时在您想要继续与主窗口交互时在同一选项卡中打开并获得焦点。

这些东西可能可以在配置文件中更改，但我还没有开始。此外，实际的 C 代码很容易阅读，并且在我想要修复某些东西的少数情况下，它非常容易。无论如何，我不想回到非平铺 WM。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T13:01:57.607

在过去的几年里，我断断续续地使用它，我认为它是一个很棒的窗口管理器，但无论我使用什么，我都会不断地爬回 kde3。

然而，很难用可量化的术语来描述为什么会发生这种情况，但它就在 gnome-vs-kde 之战中。双方都无法理解对方。

我也很想拥有 kicker + ion3，但它们的凝胶效果不是很好。

在图块之间移动应用程序（我经常做的事情）也有点低效（太沉迷于鼠标）

（ Kicker + Evilwm 是一个很好的组合，但 evilwm 无法以用户友好的方式处理堆叠）

# linux - svn over HTTP 代理

> ID：82530
> 
> 赞同：51
> 
> 时间：2008-09-17T12:23:56.823
> 
> 标签：linux, svn, ubuntu, proxy

我在笔记本电脑（Ubuntu）上，网络使用 HTTP 代理（只允许 HTTP 连接）。
当我将 svn up 用于 'http://.....' 之类的 url 时，一切都很酷（谷歌浏览器存储库工作完美），但现在我需要使用 'svn://... 从服务器上 svn up。 ' 我看到连接被拒绝。
我已经在 /etc/subversion/servers 中设置了代理配置，但它没有帮助。
有人有意见/解决方案吗？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2008-09-17T12:30:50.363

在`/etc/subversion/servers`您正在设置中，这与连接到通常在由 命令启动的端口 3690 上运行的不同服务器`http-proxy-host`无关。`svn://``svnserve`

如果您有权访问服务器，则可以`svn+ssh://`按照[此处的说明进行设置。](http://svnbook.red-bean.com/en/1.0/ch06s03.html)

**更新**：您也可以尝试使用[`connect-tunnel`](http://search.cpan.org/~book/Net-Proxy-0.12/script/connect-tunnel)，它使用您的 HTTPS 代理服务器来建立隧道连接：

```
connect-tunnel -P proxy.company.com:8080 -T 10234:svn.example.com:3690 
```

然后你会使用

```
svn checkout svn://localhost:10234/path/to/trunk 
```

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2010-09-24T17:24:42.907

好的，这应该很容易：

```
$ sudo vi /etc/subversion/servers 
```

编辑文件：

```
[Global]
http-proxy-host=my.proxy.com
http-proxy-port=3128 
```

保存它，`svn`再次运行，它会工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T12:29:44.657

如果您可以通过 SSH 访问它，您可以使用 SSH 端口转发的 SVN 服务器。

使用`SSHs -L`（或者`-R`，我忘记了，它总是让我感到困惑）创建一个 ssh 隧道，以便

`127.0.0.1:3690` 真的是通过 ssh 隧道连接到 remote:3690，然后你可以通过

```
svn co svn://127.0.0.1/.... 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-18T22:28:39.987

好的，这个话题有点过时了，但是当我在谷歌上找到它并且有一个解决方案时，这对某人来说可能很有趣：

基本上（当然）这在每个 http 代理上都是不可能的，但适用于允许在端口 3690 上进行 http 连接的代理。端口 443 上的 http 代理使用此方法来提供安全 https 连接的方法。如果您的管理员将代理配置为为 http 连接打开端口 3690，您可以设置本地计算机以通过代理建立隧道。

我只是需要从我们公司网络中的 svn.openwrt.org 中查看一些文件。创建隧道的一个简单解决方案是将以下行添加到您的 /etc/hosts

127.0.0.1 svn.openwrt.org

之后，您可以使用 socat 创建到本地端口的 tcp 隧道：

虽然是真的；do socat tcp-listen:3690 proxy:proxy.at.your.company:svn.openwrt.org:3690; 完毕

您应该以 root 身份执行该命令。它打开本地端口 3690 并在连接时在同一端口上创建到 svn.openwrt.org 的隧道。

只需根据自己的需要替换端口和服务器地址。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T12:26:15.680

当您使用 svn:// URI 时，它使用端口 3690，可能不会使用 http 代理

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T12:28:46.250

svn:// 不说 http，因此 http 代理无能为力。

http不起作用的任何原因？你考虑过https吗？如果您真的需要它，您可能必须在防火墙中打开端口 3690。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T12:30:51.847

如果您使用的是标准 SVN 安装，则 svn:// 连接将在 tcpip 端口 3690 上运行，因此除非您更改网络配置（您说只允许 Http 流量）或安装 http 模块，否则基本上无法连接托管 SVN 服务器的服务器上的 Apache。

# c++ - Boost序列化：指定模板类版本

> ID：82550
> 
> 赞同：10
> 
> 时间：2008-09-17T12:26:30.780
> 
> 标签：c++, boost-serialization

我有一个要序列化的模板类（称为 C），我想为它指定一个用于提升序列化的版本。由于 BOOST_CLASS_VERSION 不适用于模板类。我试过这个：

```
namespace boost {
namespace serialization {
    template< typename T, typename U >
    struct version< C<T,U> >
    {
        typedef mpl::int_<1> type;
        typedef mpl::integral_c_tag tag;
        BOOST_STATIC_CONSTANT(unsigned int, value = version::type::value);
    };
}
} 
```

但它不编译。在 VC8 下，对 BOOST_CLASS_VERSION 的后续调用会给出以下错误：

`error C2913: explicit specialization; 'boost::serialization::version' is not a specialization of a class template`

正确的方法是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-17T14:06:44.533

```
#include <boost/serialization/version.hpp> 
```

:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-06-06T14:33:47.803

我能够正确使用宏 BOOST_CLASS_VERSION 直到我将它封装在命名空间中。返回的编译错误是：

```
error C2988: unrecognizable template declaration/definition
error C2143: syntax error: missing ';' before '<'
error C2913: explicit specialization; 'Romer::RDS::Settings::boost::serialization::version' is not a specialization of a class template
error C2059: syntax error: '<'
error C2143: syntax error: missing ';' before '{'
error C2447: '{': missing function header (old-style formal list?) 
```

正如先前编辑中所建议的，将 BOOST_CLASS_VERSION 移至全局范围解决了该问题。我宁愿保持宏接近引用的结构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-11-28T11:44:10.580

为避免您的库过早依赖 Boost.Serialization，您可以转发声明：

```
namespace boost {
namespace serialization {

template<typename T> struct version;

}  // end namespace serialization
}  // end namespace boost 
```

而不是包括标题。要声明您的课程版本，您可以执行以下操作：

```
namespace boost {
namespace serialization {
template<typename T, int D, class A>
struct version< your_type<T, D, A> > {
    enum { value = 16 };
};
}  // end namespace serialization
}  // end namespace boost 
```

由于它不使用`BOOST_CLASS_VERSION`宏，因此仍然不需要过早包含 Boost.Serialization 标头。

（由于某种原因`static const [constexpr] unsigned int value = 16;`对我不起作用，在 C++14 中）。

# java - 用于基于 RIA 的繁重应用程序的最佳服务器端框架？

> ID：82599
> 
> 赞同：-1
> 
> 时间：2008-09-17T12:30:47.930
> 
> 标签：java, python, ria

集体认为什么是用作**AJAX/Flex/Silverlight**应用程序后端的最佳平台，为什么？

我们正在进行技术审查，我想知道其他一些意见。

是**Java、Grails、Python、Rails、ColdFusion 还是**其他？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T12:36:13.610

**没有确定的答案。**但是，我会选择一个轻量级的解决方案，比如 Python 或 Rails，而不是 Java 或 ColdFusion。

您可能想研究*C# ASP.NET + Silverlight*组合。微软让它高度集成，这是一把双刃剑。但在许多情况下，这会有所帮助。

您可能还想**查看**现有的解决方案/应用程序/初创公司。不要预先放弃 PHP，它有许多现有的组件。并且不要高估服务器端技术选择对成功的影响。

# python - Python + DNS：无法获取 RRSIG 记录：无答案

> ID：82607
> 
> 赞同：3
> 
> 时间：2008-09-17T12:32:01.967
> 
> 标签：python, dns, dnspython

[我使用DNS Python](http://www.dnspython.org/)从 Python 程序中获取 DNS 记录

我可以获得各种与 DNSSEC 相关的记录：

```
>>> import dns.resolver
>>> myresolver = dns.resolver.Resolver()
>>> myresolver.use_edns(1, 0, 1400)
>>> print myresolver.query('sources.org', 'DNSKEY')
<dns.resolver.Answer object at 0xb78ed78c>
>>> print myresolver.query('ripe.net', 'NSEC')
<dns.resolver.Answer object at 0x8271c0c> 
```

但没有 RRSIG 记录：

```
>>> print myresolver.query('sources.org', 'RRSIG')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/lib/python2.5/site-packages/dns/resolver.py", line 664, in query
    answer = Answer(qname, rdtype, rdclass, response)                        
  File "/usr/lib/python2.5/site-packages/dns/resolver.py", line 121, in __init__
    raise NoAnswer 
```

我尝试了几个签名域，如 absolight.fr 或成熟.net。

用 dig 试了一下，发现确实有 RRSIG 记录。

使用 tcpdump 检查，我可以看到 DNS Python 发送了正确的查询并收到了正确的回复（这里有 8 条记录）：

```
16:09:39.342532 IP 192.134.4.69.53381 > 192.134.4.162.53: 22330+ [1au] RRSIG? sources.org. (40)
16:09:39.343229 IP 192.134.4.162.53 > 192.134.4.69.53381: 22330 8/5/6 RRSIG[|domain] 
```

DNS Python 1.6.0 - Python 2.5.2 (r252:60911, Aug 8 2008, 09:22:44) [GCC 4.3.1] on linux2

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T15:25:29.943

你的意思可能是 RRSIG ANY （否则，顺序错误，类需要在类型之后）

```
>>> print myresolver.query('sources.org', 'RRSIG', 'ANY')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/lib/python2.5/site-packages/dns/resolver.py", line 664, in query
    answer = Answer(qname, rdtype, rdclass, response)
  File "/usr/lib/python2.5/site-packages/dns/resolver.py", line 121, in __init__
    raise NoAnswer
dns.resolver.NoAnswer 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-14T22:42:41.783

RRSIG 不是记录，它是有效 DNS 记录的散列摘要。您可以查询 DNSKEY 记录，设置 want_dnssec=True 并获取 DNSKEY 记录和“DNSKEY 记录的 RRSIG”。

更一般地说，RRSIG 只是有效记录（例如 DS 记录）的签名。

所以当你问服务器

```
myresolver.query('sources.org', 'RRSIG') 
```

它不知道你在问什么。RRSIG 本身没有任何意义，你需要指定*RRSIG 的什么？*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-22T13:42:59.810

这看起来像是 Python DNS 库中的一个可能的错误，尽管我对 Python 的阅读不够好，无法找到它。

请注意，在任何情况下，您的 EDNS0 缓冲区大小参数都不足以处理 sources.org 的 RRSIG 记录，因此您的客户端和服务器必须故障转移到 TCP/IP。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T12:59:30.747

如果你试试这个，会发生什么？

```
print myresolver.query('sources.org', 'ANY', 'RRSIG') 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-15T03:23:10.560

您可能想使用`raise_on_no_answer=False`，您将得到正确的响应：

```
resolver.query(hostname, dnsrecord, raise_on_no_answer=False) 
```

# visual-studio-2005 - 有关在 Visual Studio 中构建之前要编译多少文件的信息

> ID：82612
> 
> 赞同：0
> 
> 时间：2008-09-17T12:32:38.050
> 
> 标签：visual-studio-2005

在我开始构建过程*之前，*我怎么知道需要重新编译多少文件。

有时我不记得我更改了多少基本头文件，因此 Rebuild All 会比简单构建更好。对此没有任何选择，但恕我直言，它必须是可能的（fe XCode 给我这个信息）。

**更新：**

我的问题不是，Visual Studio 不知道要编译什么。*我需要知道它将*编译多少，以便我可以决定是否可以使用我的新代码进行快速测试，或者是否应该编写更多代码，直到我开始“昂贵”的构建过程。或者，如果我的老板问“我什么时候可以拥有新建筑？” 最好的答案不是“完成后就完成了！”。

*当 IDE 可以说“编译 589 个文件中的 200 个”*而不是*“编译 x，y，...”*时，这真的很有帮助

 ** * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T13:02:55.623

你的版本控制能告诉你吗？例如，在 Subversion 中，“检查修改”将列出自您上次签入以来更改的所有内容（尽管不是自您上次构建以来）

请注意，“构建”不会自动执行此操作吗？（仅构建已更改的内容）？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T13:08:41.070

通常 Visual Studio 擅长了解需要为您编译的内容。

如果您在一个解决方案中有多个项目，那么只需确保您的解决方案依赖项设置正确，并且在您点击 Build 时它应该可以正常工作。

# c# - NHibernate、Castle、Linq 之间的区别——它们针对谁？

> ID：82632
> 
> 赞同：9
> 
> 时间：2008-09-17T12:35:06.703
> 
> 标签：c#, database, linq, nhibernate

[这个答案说](https://stackoverflow.com/questions/71955/when-choosing-an-orm-is-linq-to-sql-or-linq-to-entities-better-than-nhibernate#71974)，Linq 针对的开发人员群体与 NHibernate、Castle 等略有不同。

作为 C# 的新手，别管它周围的所有数据库内容：

*   有没有比 NHibernate、Castle、Linq 更重要的 SQL 包装器？
*   它们之间有什么区别？
*   他们针对什么样的开发人员或开发人员？

-亚当

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-09-17T12:40:13.260

当您说 Castle 时，我假设您的意思是 Castle Active Record？

不同之处在于 NHibernate 是一个 OR/M，面向希望专注于域而不是数据库的开发人员。使用 linq to sql，您的数据库是预先存在的，并且您的关系和一些编程将由您的数据库的定义方式驱动。

现在在 NHibernate 和 Castle ActiveRecord 之间——它们的相似之处在于您从域中驱动您的应用程序设计，但是使用 NHibernate 您提供映射 xml 文件（或使用流利的 NHibernate 映射类），而在 Active Record 中您使用的是约定而不是配置（使用属性来定义任何不适合自然的列和设置）。Castle Active 记录仍在后台使用 NHibernate。

一个 OR/M 不一定是“一条真正的路”。这取决于您的环境、您开发的应用程序和您的团队。

您可能还想查看[SubSonic](http://www.subsonicproject.com)。它非常适合主动记录，但不适用于您希望主要关注您的域的项目。根据项目的不同，我通常使用 NHibernate（带有 Castle Active Record）或 Subsonic

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T12:40:43.867

LINQ 只是一组新的 C# 特性：扩展方法、lambda 表达式、对象初始化器、匿名类型等。

另一方面，“LINQ to SQL”是您可以比较其他 SQL 包装器的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T12:46:06.707

NHibernate 和 Linq To Sql 是对象/关系映射器，旨在轻松处理对象和 RDBMS 之间发现的阻抗不匹配。如果你想实现一个可测试的、持久的、无知的应用程序，NHibernate 是你要走的路。我总是推荐 NHibernate 而不是 Linq To Sql。这两种工具都旨在消除对数据访问的处理。您真正需要编写多少次数据访问代码？

Castle 是一个应用程序框架和控制反转容器，不提供数据访问。它提供了使用 NHibernate 的设施，减少了摩擦，它还提供了使用 NHibernate 的 Actuve Record 模式的实现。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-09-10T13:10:04.880

实际上，我们同时使用 Linq 和 NHibernate（与 Fluent 一起使用）。如果你对学习曲线有一点耐心，那么你很快就会坠入爱河。

# .net - 您可以将 Microsoft Entity Framework 与 Oracle 一起使用吗？

> ID：82644
> 
> 赞同：96
> 
> 时间：2008-09-17T12:36:35.250
> 
> 标签：.net, oracle, entity-framework, odp.net

是否可以将 Microsoft Entity Framework 与 Oracle 数据库一起使用？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2011-02-13T17:27:35.500

**更新**：

Oracle 现在完全支持实体框架。Oracle Data Provider for .NET 版本 11.2.0.3 (ODAC 11.2) 发行说明： [http ://docs.oracle.com/cd/E20434_01/doc/win.112/e23174/whatsnew.htm#BGGJIEIC](http://docs.oracle.com/cd/E20434_01/doc/win.112/e23174/whatsnew.htm#BGGJIEIC)

有关 Linq to Entities 和 ADO.NET Entity Framework 的更多文档：http: [//docs.oracle.com/cd/E20434_01/doc/win.112/e23174/featLINQ.htm#CJACEDJG](http://docs.oracle.com/cd/E20434_01/doc/win.112/e23174/featLINQ.htm#CJACEDJG)

注意：ODP.NET 也支持实体 SQL。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-09-17T13:45:55.190

DevArt 的 OraDirect 提供程序现在支持实体框架。见[http://devart.com/news/2008/directs475.html](http://devart.com/news/2008/directs475.html)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2010-06-11T16:28:30.197

Oracle 宣布了ODP.net 和实体框架的[“方向声明” ：](http://www.oracle.com/technetwork/topics/dotnet/whatsnew/oracle-entity-framework-sod-130214.pdf "方向声明：Oracle 数据库和 Microsoft Entity Framework")

总而言之，ODP.Net 测试版在 2010 年底左右，在 2011 年的某个时候生产。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2011-12-23T16:05:05.530

是的。请参阅[Oracle 数据库 (11G) 的实体框架、LINQ 和 Model-First 的分步教程，并使用带有 .NET 4 的 Visual Studio 2010](http://www.oracle.com/webfolder/technetwork/tutorials/obe/db/dotnet/EntityFrameworkOBE/EntityFrameworkOBE.htm)。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-01-12T15:28:40.533

如果您还不知道，Oracle 已经发布了支持实体框架的 ODP.NET。虽然它还不支持代码。

[http://www.oracle.com/technetwork/topics/dotnet/index-085163.html](http://www.oracle.com/technetwork/topics/dotnet/index-085163.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-07-20T15:00:16.620

答案是“大部分”。

我们在使用它时遇到了一个问题，即 EF 生成使用 CROSS 和 OUTER APPLY 运算符的代码。[此链接显示](http://msdn.microsoft.com/en-us/library/bb896273.aspx)MS 知道它在 2005 年之前与 SQL Server 存在问题，但是他们忘记提及 Oracle 也不支持这些运算符。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-04-22T20:04:33.103

现在有一个新的 nuget 包，尝试使用它： [https ://www.nuget.org/packages/Oracle.ManagedDataAccess.EntityFramework/](https://www.nuget.org/packages/Oracle.ManagedDataAccess.EntityFramework/)

# java - 使用 Tomcat 允许子域会话 cookie 的最佳方式

> ID：82645
> 
> 赞同：27
> 
> 时间：2008-09-17T12:36:45.560
> 
> 标签：java, tomcat, session, cookies, subdomain

默认情况下，tomcat 将为当前域创建一个会话 cookie。

如果您在 www.example.com，您的 cookie 将为 www.example.com 创建（仅适用于 www.example.com）。而对于 example.com，它将为 .example.com 创建（所需的行为将适用于 example.com 的任何子域以及 example.com 本身）。

我见过一些 Tomcat 阀门，它们似乎拦截了会话 cookie 的创建并使用正确的 .example.com 域创建了一个替换 cookie，但是它们似乎都没有完美地工作，它们似乎都离开了现有的 cookie，只是创建一个新的。这意味着每个请求都会发送两个 JSESSIONID cookie。

我想知道是否有人对这个问题有明确的解决方案。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2010-08-06T19:56:13.123

这显然是通过 6.0.27 及更高版本中的配置设置支持的：

> 通过编辑 META-INF/context.xml 完成配置
> 
> <上下文 sessionCookiePath="/something" sessionCookieDomain=".domain.tld" />

[https://issues.apache.org/bugzilla/show_bug.cgi?id=48379](https://issues.apache.org/bugzilla/show_bug.cgi?id=48379)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-05-25T06:56:03.967

我刚刚经历了所有这些寻找一个简单的解决方案。我首先从tomcat的角度开始看它。

Tomcat 不提供直接访问为会话配置域 cookie 的权限，我绝对不想自定义补丁 tomcat 来解决该问题，如其他一些帖子所示。

由于访问 Servlet 规范中内置的标头和 cookie 的限制，tomcat 中的阀门似乎也是一个问题解决方案。如果 http 响应在传递到您的阀门之前提交，它们也会完全失败。

由于我们通过 Apache 代理我们的请求，因此我转而讨论如何使用 apache 来解决问题。

我首先尝试了 mod_proxy 指令 ProxyPassReverseCookieDomain，但它不适用于 JSESSIONID cookie，因为 tomcat 没有设置域属性，并且如果没有某种域作为 cookie 的一部分，ProxyPassReverseCookieDomain 就无法工作。

我还遇到了一个使用 ProxyPassReverseCookiePath 的黑客攻击，他们正在重写路径以向 cookie 添加域属性，但这对于生产站点来说感觉很混乱。

我终于通过使用上面 Dave 提到的 apache 中的 mod_headers 模块重写响应头来让它工作。

我在虚拟主机定义中添加了以下行：

```
Header edit Set-Cookie "(JSESSIONID\s?=[^;,]+?)((?:;\s?(?:(?i)Comment|Max-Age|Path|Version|Secure)[^;,]*?)*)(;\s?(?:(?i)Domain\s?=)[^;,]+?)?((?:;\s?(?:(?i)Comment|Max-Age|Path|Version|Secure)[^;,]*?)*)(,|$)" "$1$2; Domain=.example.com$4$5" 
```

以上都应该是配置中的一行。它将任何 JSESSIONID cookie 域属性替换为“.example.com”。如果 JSESSIONID cookie 不包含域属性，则该模式将添加一个值为“.example.com”的。作为奖励，此解决方案不会受到阀门的双 JSESSION cookie 问题的影响。

该模式应该适用于 Set-Cookie 标头中的多个 cookie，而不会影响标头中的其他 cookie。通过将模式第一部分中的 JSESSIONID 更改为您想要的任何 cookie 名称，它也应该可以修改以与其他 cookie 一起使用。

我不是 reg-ex 高级用户，所以我确信可以对模式进行一些优化，但到目前为止它似乎对我们有用。

如果我发现该模式有任何错误，我会更新这篇文章。希望这将阻止你们中的一些人像我一样经历过去几天的挫折。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T13:11:02.483

我在 $DAYJOB 遇到过这个问题。就我而言，我想实现 SSL 登录，然后重定向到非 SSL 页面。tomcat 的核心问题是方法（从内存中） SessionManager.configureSessionCookie 硬编码您想要访问的所有变量。

我想出了一些想法，包括在 apache 中使用 mod_headers 来基于正则表达式替换重写 cookie 的一个特别令人震惊的 hack。

解决这个问题的决定性方法是向 tomcat 开发人员提交一个补丁，将可配置参数添加到 SessionManager 类。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T13:15:20.850

由于会话（及其 Id）基本上只对发布应用程序有价值，您可能宁愿寻找设置额外的 cookie。看看 Tomcats SingleSignOnValve，它为服务器路径“/”而不是“/applicationName”（通常设置 JSESSIONID cookie）提供额外的 Cookie JSESSIONIDSSO（注意 ...SSO）。

使用这样的 Valve，您可以实现所需的任何进程间通信，以便在任意数量的 tomcats/webservers/其他任何东西上同步不同服务器、虚拟主机或 webapps 之间的任何状态。

您不能出于自己的目的使用 tomcats 会话 cookie 的另一个原因是，同一主机上的多个 Web 应用程序具有不同的会话 ID。例如，“/webapp1”和“/webapp2”有不同的cookies。如果您将“/webapp1”的 cookie 提供给“/webapp2”，这将找不到您引用的会话，使您的会话+cookie 无效并设置自己的新会话。您必须重写所有 tomcats 会话处理以接受外部会话 id 值（安全方面的坏主意）或在应用程序之间共享某个状态。

会话处理应被视为容器（tomcats）业务。无论你需要什么，你都应该在不干扰容器认为必须做的事情的情况下添加。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-11T05:40:39.220

阀门技术似乎不是 100% 完美的。如果你敢修改Tomcat本身：

**catalina.jar**包含以下类：**org.apache.catalina.connector.Request**

请求有一个方法：

```
configureSessionCookie(Cookie cookie) 
```

对于我们的环境，最好只对其进行硬编码，但您可以做更多奇特的逻辑：

```
cookie.setDomain(".xyz.com"); 
```

似乎工作完美。如果这可以在 tomcat 中配置，那就太好了。

# python - 有没有用 Django 编写的博客引擎列表？

> ID：82653
> 
> 赞同：18
> 
> 时间：2008-09-17T12:37:48.037
> 
> 标签：python, django

有没有用 Django 编写的博客引擎列表？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-09-17T12:45:14.823

编辑：原始链接失效了，所以这里有一个更新的链接，其中列表的摘录按顶部最近更新的源排序。

[你应该知道的 11 个 Django 博客引擎](http://blog.montylounge.com/2010/02/10/eleven-django-blog-engines-you-should-know/)

蒙蒂酒廊工业

> *   [书目](http://github.com/eldarion/biblion)
> *   [Django-文章](http://bitbucket.org/codekoala/django-articles/)
> *   [花絮](http://github.com/flother/flother)
> *   [基础-博客](http://github.com/nathanborror/django-basic-apps)
> *   [你好-纽曼](http://github.com/gregnewman/hello-newman)
> *   [班卓琴](http://getbanjo.com/download/)
> *   [djangotech博客](http://code.google.com/p/djangotechblog/)
> *   [Django-YABA](http://github.com/f4nt/django-yaba/)
> *   [Shifting Bits](http://github.com/paltman/shiftingbits/)（现在只是一个[biblion](http://github.com/eldarion/biblion)博客）
> *   [强大的柠檬](http://github.com/mightylemon/mightylemon)
> *   [科尔川](http://code.google.com/p/coltrane-blog/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-17T12:43:37.290

James Bennett对这个问题有一个[有趣的看法：](http://www.b-list.org/weblog/2007/nov/29/django-blog)

> “我在哪里可以找到一个好的 Django 驱动的博客应用程序”可能在 django-users 和 IRC 的常见问题列表的顶部；部分原因在于，目前还没有“权威”的 Django 博客应用程序；如果你去寻找的话，有很多可用的，但是你不太可能让任何人推荐其中一个作为“the”Django 博客应用程序（除非进行推荐的人恰好是其中一个的作者） .

[博客条目](http://www.b-list.org/weblog/2007/nov/29/django-blog)也有一个列表。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-17T12:40:53.820

**Byteflow**是一个博客引擎，用 Python 编写，使用 Django

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-17T12:46:38.610

Django 强大的管理界面和简单的 ORM 使得构建一个适合您需求的博客只需 30 分钟；当您可以自己快速制作时，为什么还要寻找第三方产品？

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-01-04T18:41:48.620

[Practical Django Projects](https://rads.stackoverflow.com/amzn/click/com/1430219386)一书提供了有关如何创建 Django 博客应用程序的教程。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-26T18:46:29.523

Nathan Borror 有一个很棒的“基本应用程序”包，其中包含一个博客。这些是编写良好、文档完善的应用程序，您应该尝试、从中获取想法等。

[http://code.google.com/p/django-basic-apps/](http://code.google.com/p/django-basic-apps/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-01-09T18:55:06.167

你应该检查一下`django-blogango`。[http://agiliq.com/blog](http://agiliq.com/blog)使用这个博客引擎运行。

[https://github.com/agiliq/django-blogango](https://github.com/agiliq/django-blogango)

# printing - 从 ASP.NET 页面 .NET1.1/.NET2.0 打印屏幕的最佳方法是什么

> ID：82654
> 
> 赞同：1
> 
> 时间：2008-09-17T12:37:51.050
> 
> 标签：printing, asp.net-2.0, asp.net-1.1

我已经看到了从 Windows 应用程序打印的示例，但我找不到任何这样做的好示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T13:40:38.590

我使用了打印样式表

这里和文章[http://alistapart.com/stories/goingtoprint/](http://alistapart.com/stories/goingtoprint/)将通过设置方式。而不是设置一个需要维护的特殊页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T12:45:33.387

如果您只需要从客户端打印您的网页，请使用`window.print()`. 示例可以在这里找到：[http](http://www.javascriptkit.com/howto/newtech2.shtml) ://www.javascriptkit.com/howto/newtech2.shtml 。我建议首先准备一个特殊版本的页面，其中没有动态内容，并且布局在打印时看起来不错。

如果您需要向服务器端的打印机发送一些东西，那会*有点*复杂。查看这篇[MSDN](http://msdn.microsoft.com/en-gb/magazine/cc188767.aspx)文章，了解如何进行基本打印。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T13:27:20.820

浏览器打印您的页面。如果您需要调整页面以使其在打印机上看起来更好，请使用 CSS @media 选择器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T13:50:46.303

重申其他人所说的话，您只需要在 javascript 中调用 window.print() 即可。那并为打印构建一个单独的CSS。

# visual-studio - 如何在 Visual Studio 中清除 MRU 列表？

> ID：82661
> 
> 赞同：45
> 
> 时间：2008-09-17T12:38:27.850
> 
> 标签：visual-studio, registry, mru

我想清除起始页上的项目列表...我该怎么做？我知道我可以在注册表中找到它，但是否有经过批准的途径？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2008-09-17T15:58:38.430

[这里](http://msdn.microsoft.com/en-us/library/aa991991.aspx)有一篇 MSDN 文章建议您只需将项目移动到新目录。

但是，正如您所提到的，项目列表保存在注册表中的以下项下：

```
HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\<version>\ProjectMRUList 
```

最近的文件列表保存在这个键中：

```
HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\<version>\FILEMRUList 
```

**注意对于 Visual Studio 2015：**
位置已更改。您可以查看[此答案](https://stackoverflow.com/a/33945037/62195)以获取详细信息。

有些人使用自己的工具自动清除此注册表项：用于清除 Visual Studio 2008 MRU 项目列表的
[Visual Studio 最近文件实用程序](http://www.codeplex.com/vsrecentfiles)
[插件](http://code.msdn.microsoft.com/CleanRecentListAddIn)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2010-12-10T05:28:03.230

## [适用于 Visual Studio 2008 的 PowerCommands](https://visualstudiogallery.msdn.microsoft.com/e5f41ad9-4edc-4912-bca3-91147db95b99)

### 特征

*   清除最近的文件列表
*   清除最近的项目列表
*   清除所有窗格
*   复制路径
*   电子邮件代码片段
*   插入 Guid 属性
*   显示所有文件
*   撤消关闭
*   折叠项目
*   复制类
*   粘贴类
*   复制参考
*   粘贴参考
*   复制为项目参考
*   编辑项目文件
*   打开包含文件夹
*   打开命令提示符
*   卸载项目
*   重新加载项目
*   删除和排序使用
*   提取常数
*   转换模板
*   关闭所有

![替代文字](https://i.stack.imgur.com/G8BFv.png)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-17T12:42:48.307

如果您尝试打开一个无法再找到的项目，Visual Studio 将提示您允许将其从 MRU 列表中删除。因此，如果您临时重命名适当的顶级文件夹以伪造项目的消失，则可以将项目一一删除。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-07-20T10:30:07.450

在 Visual Studio 2015 中，所有历史列表（包括搜索历史、文件 MRU 和项目 MRU）现在位于：

`HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\14.0\MRUItems`

您将看到每个列表的不同 GUID 文件夹，以及每个列表中调用的子文件夹`Items`。找到`Items`包含相关列表的文件夹，然后删除其父 GUID 文件夹。

Visual Studio 将重新创建 GUID 文件夹和一个新的`Items`子文件夹，下次它想再次向列表中添加一些东西。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-17T12:47:17.267

我发现[Code Project的](http://www.codeproject.com)[MRU 编辑器](http://www.codeproject.com/KB/cs/VSProjectListEditorIII.aspx)是一个很好的工具。没有问题，它适用于 2003 年、2005 年和 2008 年。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-07-09T16:33:44.153

**注意**：此答案特定于 Visual Studio 2010。

如果不想手动编辑注册表，可以使用[PowerCommands for Visual Studio 2010](http://visualstudiogallery.msdn.microsoft.com/e5f41ad9-4edc-4912-bca3-91147db95b99/)。

> PowerCommands 10.0 是 Visual Studio 2010 的一组有用的扩展，为 IDE 的各个区域添加了附加功能。

从扩展中清除注册表的具体命令是：

> **清除最近的项目列表**此命令清除 Visual Studio 最近的项目列表。清除最近的项目列表命令会弹出一个清除文件对话框，允许选择任何或所有最近的项目。

PowerCommands 可以与 Visual Studio 扩展管理器一起安装：Tools > Extension Manager > Online Gallery：搜索*PowerCommands for Visual Studio 2010*。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-04-07T07:47:04.493

试用最近使用的文件：Visual Studio 的免费插件，可按项目管理 MRU 文件：支持 VS 2010、2012、2013。

对于 Visual Studio 2012、2013：http: [//visualstudiogallery.msdn.microsoft.com/a61cbd1d-b5a2-490b-a6bb-f0ea3ecf214a](http://visualstudiogallery.msdn.microsoft.com/a61cbd1d-b5a2-490b-a6bb-f0ea3ecf214a)

对于 Visual Studio 2010：http: [//visualstudiogallery.msdn.microsoft.com/45283881-5a62-4dc1-8ffb-4cbc02709947](http://visualstudiogallery.msdn.microsoft.com/45283881-5a62-4dc1-8ffb-4cbc02709947)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-03-23T04:21:31.963

对于 Visual Studio 2013：打开运行对话框（按 Win + R）类型：regedit 导航到：HKEY_CURRENT_USER > Software > Microsoft > VisualStudio 点击 12.0 然后文件将显示在右侧。查找“LastLoadedSolution”，右键单击然后单击修改将值更改为 0。

这对我有用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-12-06T20:29:43.180

我不确定此解决方案是否已在此处发布，但如果您有 VS 2013 Update 5，您可以打开开始页面，然后右键单击“最近”列表下方的项目，然后选择“从列表中删除”。我不知道其他VS版本怎么样，也许这个功能可用。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-10-18T16:48:27.820

我在应用于 VS 2017 时遇到了这个问题，在该版本中，注册表中没有任何 MRU 项目，就像以前的版本一样。另一方面，解决方案很简单：转到“工具->扩展和更新”并安装“Visual Studio 的电源命令”。安装后，您的文件菜单将如下所示。

[![在此处输入图像描述](https://i.stack.imgur.com/vfZRC.png)](https://i.stack.imgur.com/vfZRC.png)

只需单击菜单项即可清除项目 MRU。

# java - 什么是移动应用程序的最佳远程技术？

> ID：82691
> 
> 赞同：3
> 
> 时间：2008-09-17T12:41:02.290
> 
> 标签：java, iphone, windows-mobile, java-me, mobile

我有一个 java 后端，需要向在以下环境中运行的客户端公开服务：

*   J2ME
*   视窗手机
*   苹果手机

我正在为每个平台寻找最好的工具。
我不会寻找一种无处不在的技术。
我需要适合低速互联网访问的“轻量级”。

现在我正在使用 SOAP。它很冗长，不容易在移动设备上解析。问题是我还没有看到任何真正的替代方案。

是否有一种格式可以与这些平台之一“开箱即用”？
我宁愿不使用会大大增加应用程序下载时间的臃肿库。

每个人似乎都同意 JSON。有没有人实现了基于 JSON 的解决方案，运行 Objective-C、J2ME、Windows Mobile ？

注意：到目前为止，最好的解决方案似乎是 Hessian。它在 Windows Mobile 和 Objective-C/iPhone 上运行良好。最大的问题是 J2ME。Hessian 的 J2ME 实现有严重的局限性。它不支持复杂对象。我已经写了另一个关于它的问题。

如果您有任何想法，非常欢迎。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-17T12:45:56.740

[JSON](http://www.json.org/)相当紧凑，并且被大多数框架支持。[您可以使用标准REST](http://en.wikipedia.org/wiki/Representational_State_Transfer)技术通过 HTTP 传输数据。

有用于[Java](http://www.json.org/java/)、[Objective C](http://code.brautaset.org/JSON/)和[许多其他语言](http://www.json.org/)的 JSON 库（向下滚动）。在服务器端找到框架支持应该没有问题，因为 JSON 用于 Web 应用程序。

较旧的替代方案包括纯 XML 和 XML-RPC（类似于 SOAP，但要简单得多，并且带有适用于大多数语言的库）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-17T16:17:53.407

黑森州。 [http://hessian.caucho.com](http://hessian.caucho.com)。多种语言（包括 ObjC）的实现，超轻量级，并且不需要依赖 dom/xml 解析器来进行从线到对象模型的转换。一旦我们找到 Hessian，我们就忘记了我们曾经了解过 XML。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T12:47:35.130

REST + XML 或 JSON 将是一个不错的选择。它在 RIA 世界中取得了长足的进步，它的美妙之处在于它的简单性。它非常易于使用，无需任何特殊工具。SOAP 有它的优点，但它在具有强大工具支持的环境中工作得最好。我从你的问题猜想不是这样的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T20:47:27.837

支持 JSON。我将[Stringtree JSON 阅读器](http://stringtree.org/stringtree-json.html)[移植](http://www.olivepeak.com/code/)到 J2ME。它是一个单类 JSON 阅读器，可编译成 5KB 的类文件，并将 JSON 结构直接映射到本机 CLDC 类型，如 Hashtable 和 Vector。现在我可以将同一台服务器用于我的桌面浏览器 AJAX 前端和我的 J2ME 客户端。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T12:48:20.633

普通的旧 XML（有点不幸地称为 POX）怎么样？

另一个非常有用的选项是[JSON](http://www.json.org/)。每种编程语言都有库。

可能，由于您在计算和网络资源方面都受到限制的环境中工作，并且使用静态类型语言，因此 Google 的[协议缓冲区](http://code.google.com/apis/protocolbuffers/docs/overview.html)将更适合您。（忽略其中的 RPC 垃圾；RPC 是一种有吸引力的麻烦，而不是一种有用的技术。）

您的问题的问题在于，您没有提供关于这是什么类型的数据以及您的用例是什么的大量背景信息，因此除了非常模糊的概括外，很难说任何话。

# sql-server - 如何更改 SQL Server 中数据库表上的 TEXT 列？

> ID：82721
> 
> 赞同：2
> 
> 时间：2008-09-17T12:43:49.257
> 
> 标签：sql-server, tsql

在 SQL 服务器数据库中，我有一个表，其中包含一个设置为允许 NULL 的 TEXT 字段。我需要将其更改为不允许 NULL。我可以通过企业管理器做到这一点，但是当我尝试运行以下脚本时，**alter table dbo.[EventLog] Alter column [Message] text Not null**，我得到一个错误：

*无法更改列“ErrorMessage”，因为它是“文本”。*

阅读 SQL 联机丛书确实表明您不允许在 TEXT 字段上执行 ALTER COLUMN。不过，我确实需要能够通过脚本来执行此操作，而不是在企业管理器中手动执行。那么在脚本中执行此操作的选项是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-17T12:58:21.997

您可以使用企业管理器来创建您的脚本。右键单击 EM 中的表并选择设计。取消选中 Text 字段的 Allow Nulls 列。不要点击常规的保存图标（软盘），而是单击一个看起来像带有小软盘的金色卷轴的图标，或者只是从菜单中执行 Table Designer > Generate Change Script。将脚本保存到文件中，以便您可以重复使用它。这是一个示例脚本：

```
 /* To prevent any potential data loss issues, you should review this script in detail before running it outside the context of the database designer.*/
BEGIN TRANSACTION
SET QUOTED_IDENTIFIER ON
SET ARITHABORT ON
SET NUMERIC_ROUNDABORT OFF
SET CONCAT_NULL_YIELDS_NULL ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
COMMIT
BEGIN TRANSACTION
GO
CREATE TABLE dbo.Tmp_TestTable
    (
    tableKey int NOT NULL,
    Description varchar(50) NOT NULL,
    TextData text NOT NULL
    )  ON [PRIMARY]
     TEXTIMAGE_ON [PRIMARY]
GO
IF EXISTS(SELECT * FROM dbo.TestTable)
     EXEC('INSERT INTO dbo.Tmp_TestTable (tableKey, Description, TextData)
        SELECT tableKey, Description, TextData FROM dbo.TestTable WITH (HOLDLOCK TABLOCKX)')
GO
DROP TABLE dbo.TestTable
GO
EXECUTE sp_rename N'dbo.Tmp_TestTable', N'TestTable', 'OBJECT' 
GO
ALTER TABLE dbo.TestTable ADD CONSTRAINT
    PK_TestTable PRIMARY KEY CLUSTERED 
    (
    tableKey
    ) ON [PRIMARY]

GO
COMMIT 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T12:46:01.340

创建一个新字段。复制数据。放弃旧领域。重命名新字段。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T13:10:24.247

我认为摆脱空值是最简单的。

（正如 raz0rf1sh 所说）

```
CREATE TABLE tmp1( col1 INT identity ( 1, 1 ),   col2 TEXT )    
GO  

INSERT  
INTO     tmp1  
SELECT   NULL   

GO 10  

SELECT   *  
FROM     tmp1  

UPDATE tmp1  
SET      col2  = ''  
WHERE    col2 IS NULL  

ALTER TABLE tmp1   
ALTER COLUMN col2 TEXT NOT NULL  

SELECT   *
FROM     tmp1  

DROP TABLE tmp1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T12:47:35.520

在我的脑海中，我会说您需要创建一个与现有表具有相同结构但您的文本列设置为非空的新表，然后运行查询以将记录从一个移动到另一个。

我意识到这是一种伪代码答案，但我认为这确实是您唯一的选择。

如果其他人对确切的 TSQL 语法有更好的把握来补充这个答案，请随意。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T12:49:28.667

我将使用 NULL 值更新所有列并将其设置为空字符串，例如，''。然后您应该能够毫无问题地运行您的 ALTER TABLE 脚本。比创建新列要少得多。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T12:51:30.580

尝试从企业管理器中生成更改脚本，看看它是如何在那里完成的

# linux - 在 Vim 中将 DOS 行尾转换为 Linux 行尾

> ID：82726
> 
> 赞同：785
> 
> 时间：2008-09-17T12:44:26.010
> 
> 标签：linux, vim, file, editor, dos2unix

如果我打开在 Windows 中创建的文件，这些行都以`^M`. 如何一次删除这些字符？

* * *

## 回答 #1

> 赞同：1160
> 
> 时间：2008-09-17T12:45:38.567

[dos2unix](https://sourceforge.net/projects/dos2unix)是一个命令行实用程序，可以执行此操作，或者`:%s/^M//g`如果您使用`Ctrl`- `v` `Ctrl`-`m`输入 ^M，或者您可以`:set ff=unix`，Vim 会为您执行此操作。

有关于文件格式设置的文档[，](http://www.vim.org/htmldoc/options.html#%27fileformat%27) Vim wiki 有一个[关于行尾转换的综合页面](http://vim.wikia.com/wiki/Change_end-of-line_format_for_dos-mac-unix)。

或者，如果你频繁地来回移动文件，你可能不想转换它们，而是想转换它们，`:set ff=dos`所以 Vim 会知道它是一个 DOS 文件并使用 DOS 约定作为行尾。

* * *

## 回答 #2

> 赞同：312
> 
> 时间：2008-09-18T18:53:17.423

更改视图中的行尾：

```
:e ++ff=dos
:e ++ff=mac
:e ++ff=unix 
```

这也可以用作保存操作（单独的:w 不会使用您在屏幕上看到的行尾进行保存）：

```
:w ++ff=dos
:w ++ff=mac
:w ++ff=unix 
```

您可以从命令行使用它：

```
for file in *.cpp
do 
    vi +':w ++ff=unix' +':q' "$file"
done 
```

* * *

## 回答 #3

> 赞同：172
> 
> 时间：2009-07-30T01:17:35.443

我通常使用

```
:%s/\r/\r/g 
```

这似乎有点奇怪，但由于 Vim 匹配换行符的方式而有效。我也发现它更容易记住:)

* * *

## 回答 #4

> 赞同：112
> 
> 时间：2008-09-17T12:51:31.983

我更喜欢使用以下命令：

```
:set fileformat=unix 
```

您还可以使用`mac`或`dos`将您的文件分别转换为 Mac 或 MS-DOS/Windows 文件约定。如果文件已经是正确的格式，它什么也不做。

有关详细信息，请参阅 Vim 帮助：

```
:help fileformat 
```

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2008-09-17T12:52:08.910

`:set fileformat=unix`从 DOS 转换为 Unix。

* * *

## 回答 #6

> 赞同：20
> 
> 时间：2008-09-17T12:45:24.680

```
:%s/\r\+//g 
```

在 Vim 中，这会去掉所有回车，只留下换行符。

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2008-09-17T12:49:28.510

来自：[文件格式](http://vim.wikia.com/wiki/Change_end-of-line_format_for_dos-mac-unix)

[Esc] :%s/\r$//

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2009-12-15T12:36:50.673

`dos2unix`可以直接修改文件内容。

您可以直接在文件上使用它，而无需临时文件重定向。

```
dos2unix input.txt input.txt 
```

以上使用假定的美式键盘。使用该`-437`选项使用英国键盘。

```
dos2unix -437 input.txt input.txt 
```

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2014-01-01T19:31:16.103

# 将文件目录从 DOS 转换为 Unix

### 使用命令行和 sed，在当前目录中查找所有扩展名为“.ext”的文件并删除所有“^M”

*@ [https://gist.github.com/sparkida/7773170](https://gist.github.com/sparkida/7773170)*

```
find $(pwd) -type f -name "*.ext" | while read file; do sed -e 's/^M//g' -i "$file"; done; 
```

此外，如上一个答案中所述，**^M** = `Ctrl+V`+ `Ctrl+M`（不要只键入插入符号“^”符号和 M）。

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2020-12-03T12:17:02.753

在 VIM 中：

```
:e ++ff=dos | set ff=unix | w! 
```

在带有 VIM 的 shell 中：

```
vim some_file.txt +'e ++ff=dos | set ff=unix | wq!' 
```

`e ++ff=dos`- 强制以`dos`格式打开文件。

`set ff=unix`- 将文件转换为`unix`格式。

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2012-02-17T22:59:25.940

以下步骤可以将 DOS 的文件格式转换为 Unix：

```
:e ++ff=dos     Edit file again, using dos file format ('fileformats' is ignored).[A 1]
:setlocal ff=unix     This buffer will use LF-only line endings when written.[A 2]
:w     Write buffer using Unix (LF-only) line endings. 
```

参考：*[文件格式](http://vim.wikia.com/wiki/Change_end-of-line_format_for_dos-mac-unix)*

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2012-05-24T04:03:26.547

```
tr -d '\15\32' < winfile.txt > unixfile.txt 
```

（请参阅：*[在 Unix 和 Windows 文本文件之间转换](http://kb.iu.edu/data/acux.html)*）

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2018-10-17T13:30:52.023

直接在 Linux 控制台中运行：

```
vim file.txt +"set ff=unix" +wq 
```

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2008-09-17T12:46:51.167

使用以下命令：

```
:%s/^M$//g 
```

要让`^M`出现，请键入`Ctrl``V`，然后`Ctrl``M`。 `Ctrl``V`告诉 Vim 按字面意思输入下一个字符。

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2012-07-13T17:46:37.563

关于让 ^M 出现的评论对我有用。仅在我的 vi 中键入“^M”一无所获（未找到）。`CTRL`++序列虽然完美地完成了它`V` `CTRL`。`M`

我的工作替换命令是

```
:%s/Ctrl-V Ctrl-M/\r/g 
```

它在我的屏幕上看起来像这样：

```
:%s/^M/\r/g 
```

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2008-09-17T12:45:34.510

```
:g/Ctrl-v Ctrl-m/s/// 
```

`Ctrl``M`是 DOS 行尾添加的字符`\r`或回车符。`Ctrl``V`告诉 Vim`Ctrl``M`在命令行插入一个文字字符。

作为一个整体，此命令将所有内容都替换`\r`为空，将它们从行尾删除。

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2016-04-30T18:11:19.073

[我找到了一个非常简单的方法：使用nano](https://en.wikipedia.org/wiki/GNU_nano)打开文件：`nano file.txt`

按`Ctrl`+`O`保存，但在按 之前`Enter`，按：`Alt`+`D`在 DOS 和 Unix/Linux 行尾之间切换，或：`Alt`+`M`在 Mac 和 Unix/Linux 行尾之间切换，然后按`Enter`保存，`Ctrl`+`X`退出。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2016-12-15T13:13:11.480

您可以使用：

```
vim somefile.txt +"%s/\r/\r/g" +wq 
```

或[dos2unix](https://linux.die.net/man/1/dos2unix)实用程序。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2008-09-17T12:46:12.027

您可以使用以下命令：
`:%s/^V^M//g`
'^' 表示使用`CTRL`密钥。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2015-02-13T09:22:23.443

以下命令用于重新格式化当前目录中的所有 .sh 文件。我在我的[Fedora](https://en.wikipedia.org/wiki/Fedora_%28operating_system%29)操作系统上对其进行了测试。

```
for file in *.sh; do awk '{ sub("\r$", ""); print }' $file >luxubutmp; cp -f luxubutmp $file; rm -f luxubutmp ;done 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2018-01-17T13:35:15.013

在 Vim 中，键入：

```
:w !dos2unix % 
```

这会将当前缓冲区的内容通过管道传输到[dos2unix](https://en.wikipedia.org/wiki/Unix2dos)命令，并将结果写入当前内容。之后 Vim 会要求重新加载文件。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-07-30T09:46:04.687

通常有一个`dos2unix`命令可以用于此。只需确保您阅读了手册，因为 GNU 和 BSD 版本在处理参数的方式上有所不同。

BSD版本：

```
dos2unix $FILENAME $FILENAME_OUT
mv $FILENAME_OUT $FILENAME 
```

GNU 版本：

```
dos2unix $FILENAME 
```

或者，您可以在此处使用任何建议的答案创建自己`dos2unix`的答案，例如：

```
function dos2unix(){
    [ "${!}" ] && [ -f "{$1}" ] || return 1;

    { echo ':set ff=unix';
      echo ':wq';
    } | vim "${1}";
} 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2016-02-08T18:09:16.033

来自维基：

```
%s/\r\+$//g 
```

这将找到所有回车符号（一个和多个代表）直到行尾并删除，所以只会`\n`留在 EOL。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2016-06-08T01:52:55.663

这是我的方式。我在 DOS EOL 中打开了一个文件，当我保存文件时，它会自动转换为 Unix EOL：

```
autocmd BufWrite * :set ff=unix 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2017-02-11T10:13:19.443

我想要换行符代替 ^M。Perl 的救援：

```
perl -pi.bak -e 's/\x0d/\n/g' excel_created.txt 
```

或写入标准输出：

```
perl -p -e 's/\x0d/\n/g' < excel_created.txt 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2017-08-24T07:02:23.543

如果你在 Windows 的 Notepad 或[Notepad++](https://en.wikipedia.org/wiki/Notepad_%28software%29)中创建一个文件，把它带到 Linux 上，然后用 Vim 打开它，你会在每一行的末尾看到 ^M。要删除它，

在您的 Linux 终端上，键入

```
dos2unix filename.ext 
```

这将发挥所需的魔力。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2017-10-24T19:03:39.587

我知道我在某个地方看到过这个。这是[FreeBSD](https://en.wikipedia.org/wiki/FreeBSD)登录提示：

您是否需要从 DOS 文件中删除所有这些 ^M 字符？尝试

```
tr -d \\r < dosfile > newfile
    -- Originally by Dru <genesis@istar.ca> 
```

# visual-studio - 如何在 DSL T4 模板中引用图表？

> ID：82776
> 
> 赞同：2
> 
> 时间：2008-09-17T12:49:25.873
> 
> 标签：visual-studio, diagram, dsl

谷歌没有来这里拯救我，我只**知道**这是一个完美的地方。

我正在为 DSL 编写自定义 DirectiveProcessor，我希望能够从我的 T4 模板中访问图表。

在我的 DirectiveProcessor 中，我已经使用（等待它...）LoadModelAndDiagram(...) 加载了域模型和我的图表。

因此，现在图表已加载到 Store 中的默认分区中，但我终生无法弄清楚以后如何解析对它的引用。

有人可以指导吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T21:08:34.057

好吧，经过大量进一步的工作，我决定不需要**从自定义 DirectiveProcessor 中访问我的图表。

我仍然有一个自定义 DirectiveProcessor，因为生成的标准在加载域模型时不会加载现有图表。

获取自定义 DirectiveProcessor 以同时加载图表和模型非常容易。您将标准生成的 DirectiveProcessor 基类子类化并覆盖：

```
protected override bool LoadDiagramData
{
    get
    {
        return true;
    }
} 
```

现在，我们已经加载了图表，所以回到最初的问题，我们如何访问它？像这样：

```
using (Transaction t = partition.Store.TransactionManager
           .BeginTransaction("MyTxn", true))
{
    MyDslDiagram diagram = partition.ElementDirectory
        .FindElements<MyDslDiagram>(true).SingleOrDefault();

    /*
     * Now, do stuff with your diagram.
     *
     */
} 
```

现在，如果您加载了图表，则此代码可以正常工作。如果不这样做，**图表**将返回为**null**，在这种情况下，我们必须显式加载图表或动态创建图表。

在这里我就不多说了。也许在我睡觉的时候在[我的博客上！](http://hastobe.net)

# rss - 什么是合并 RSS 源的最佳 Windows 工具？

> ID：82782
> 
> 赞同：1
> 
> 时间：2008-09-17T12:49:39.350
> 
> 标签：rss, merge

这似乎是一件简单的事情，但我找不到任何明显的解决方案......

我希望能够获取两个或三个提要，然后合并到一个 rss 提要中，以便在我们的网络内部发布。

有没有一个简单的工具可以做到这一点？免费或商业..

更新：应该提到，寻找将作为预定服务在服务器上运行的 Windows 应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T12:50:50.457

也许[http://www.planetplanet.org/](http://www.planetplanet.org/) 会做你想做的事。

[它用于创建像planet lisp](http://planet.lisp.org/)这样的博客聚合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T12:52:19.703

谷歌阅读器，创建一个组，将您的提要添加到文件夹中，然后将其共享为 RSS 提要。

:-)

在你睡觉的时候工作！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T12:53:56.783

这里有一大堆选项：http: [//allrss.com/rssremixers.html](http://allrss.com/rssremixers.html)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T12:54:51.990

[雅虎管道](http://pipes.yahoo.com/)可能会很好。取决于您希望生成的提要有多少“私人”。

对于 100% 离线解决方案，请调查[Atomisator](http://tarekziade.wordpress.com/2008/08/20/atomisator-a-framework-to-build-custom-rss-feeds/)。它是一个 Python 框架，主要用于离线完成 Yahoo Pipes 在线所做的工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T13:04:51.717

如果您使用 PHP，[SimplePie](http://simplepie.org/)库将执行此操作。 [这是一个教程](http://www.webmaster-source.com/2007/08/06/merging-rss-feeds-with-simplepie/)。

# c# - 没有管理用户配置文件权限的 Sharepoint UserProfileManager

> ID：82788
> 
> 赞同：4
> 
> 时间：2008-09-17T12:50:36.493
> 
> 标签：c#, sharepoint

我有一个让我有点抓狂的问题：使用 UserProfileManager 作为非授权用户。

问题：用户没有“管理用户配置文件”权限，但我仍然想使用 UserProfileManager。使用 SPSecurity.RunWithElevatedPrivileges 的想法似乎不起作用，因为 UserProfileManager 似乎授权了 SSP。

```
 SPSecurity.RunWithElevatedPrivileges(delegate()
            {
                using (SPSite site = new SPSite(inputWeb.Site.ID))
                {
                    ServerContext ctx = ServerContext.GetContext(site);
                    UserProfileManager upm = new UserProfileManager(ctx,true);
                    UserProfile u = upm.GetUserProfile(userLogin);
                    DepartmentName = u["Department"].Value as string;
                }
            }); 
```

这在“new UserProfileManager”行上仍然失败，“您必须具有管理用户配置文件管理员权限才能使用管理员模式”例外。

就我用户而言，RunWithElevatedPrivileges 恢复为 AppPool 身份。WindowsIdentity.GetCurrent().Name 返回“NT AUTHORITY\network service”，并且我已授予该帐户“管理用户配置文件”权限 - 不走运。

site.RootWeb.CurrentUser.LoginName 为在 RunWithElevatedPrivileges 中创建的站点返回 SHAREPOINT\system，该站点不是有效的 Windows 帐户。

有没有办法做到这一点？我不想给所有用户“管理用户配置文件”的权限，但我只想从用户配置文件（部门、国家、直接报告）中获取一些数据。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-17T13:21:41.613

需要设置的权限实际上是在共享服务提供者中找到的。

1.  导航到中央管理
2.  导航到共享服务提供商
3.  在**用户配置文件和我的站点**下导航到个性化服务权限。
4.  如果该帐户尚不存在，请添加运行您的站点 App Domain 的帐户。
5.  授予该用户**管理用户配置文件**权限。

我注意到您正在网络服务帐户下运行应用程序池。我在我的网站上实现了相同的功能；但是，应用程序池托管在 Windows 帐户下。但是，我不确定为什么这会有所作为。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-02T09:57:40.353

我实际上有两种方法可以做到这一点：

1.  将使用 UserProfileManager 的代码放在 Web 服务层后面。Web 服务应使用有权访问用户配置文件服务的应用程序池身份。
2.  使用以下文章中描述的模拟技术：http: [//www.dotnetjunkies.com/WebLog/victorv/archive/2005/06/30/128890.aspx](http://www.dotnetjunkies.com/WebLog/victorv/archive/2005/06/30/128890.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-02T11:59:52.743

感谢您的回答。一个警告：如果您将应用程序池作为“网络服务”而不是域帐户运行，那么您就完蛋了。

但是话又说回来，无论如何建议使用域帐户（在测试服务器上我使用了网络服务，但将其更改为域帐户后它可以工作）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T02:06:22.057

这是答案。它是一个愚蠢的 Microsoft 错误，并且有一个修补程序。我现在下载来测试一下。

[http://support.microsoft.com/kb/952294/en-us](http://support.microsoft.com/kb/952294/en-us)

# sharepoint - 确保我们的 SharePoint 实施可访问的最佳方法是什么？

> ID：82806
> 
> 赞同：1
> 
> 时间：2008-09-17T12:51:42.810
> 
> 标签：sharepoint, accessibility

是否应使用任何博客、指南、清单或控件来确保我们的 SharePoint 实施可访问？最好是 W3C 双 A 标准，或者尽可能接近。

我们正在实施一个外联网解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T12:54:36.343

最好的起点是[Sharepoint 的 Accessibility Kit](http://aks.hisoftware.com/index.html)。有了这个，你可能会达到单A的标准，但根据我的经验，你会发现很难达到AA。

Microsoft 没有考虑 Sharepoint 中的可访问性，甚至 2007 年也严重依赖表格布局。

祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T12:59:46.770

这项研究已经由微软资助，不幸的是，结果似乎只在 Word 文档中在线。

该文档托管在此博客上：http: [//blog.mastykarz.nl/best-practices-for-developing-accessible-web-sites-in-microsoft-office-sharepoint-server-2007/](http://blog.mastykarz.nl/best-practices-for-developing-accessible-web-sites-in-microsoft-office-sharepoint-server-2007/)

文档的路径在这里： http: [//go.microsoft.com/fwlink/ ?LinkId=121877](http://go.microsoft.com/fwlink/?LinkId=121877)

我不确定将其内容复制到此处是否是一件好事，以便以搜索引擎索引的方式完全回答问题，但我会安全行事，因为它不是我的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T12:54:45.440

您如何部署实施？它是作为 Intranet，还是作为面向公众的网站。

我认为首要规则之一是在使用开箱即用的 Web 部件时非常有选择性。我查看的许多 Web 部件即使在基本级别上也不合规。

安德鲁

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T13:01:42.193

最好的方法是在开发过程中进行检查，以便了解您的痛点在哪里。下一步可能从一个最小的母版页开始，这样您就可以选择向用户呈现哪些元素。

更高级的是，您可以覆盖渲染方法以删除或更改不符合您检查的页面位。EG 更改标签的大小写（XHTML 不喜欢全部大写） 本指南中的更多内容。

> [http://techtalkpt.wordpress.com/2008/06/18/building-accessible-sharepoint-sites-part-1/](http://techtalkpt.wordpress.com/2008/06/18/building-accessible-sharepoint-sites-part-1/) [http://techtalkpt.wordpress.com/2008/08/07/building-accessible-sharepoint-网站第 2 部分/](http://techtalkpt.wordpress.com/2008/08/07/building-accessible-sharepoint-sites-part-2/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T13:25:11.373

我最近阅读了 Andrew Connell (www.andrewconnell.com) 的 MOSS 书，其中有一章专门介绍可访问性和 SharePoint 网站。

简单地说，SharePoint 网站很难生成 W3C AAA 标准，但 Accessibility Kit 是最好的起点之一。

Stronly 为本章推荐他的书（[http://www.amazon.com/dp/0470224754?tag=andrewconnell-20&camp=14573&creative=327641&linkCode=as1&creativeASIN=0470224754&adid=18S6FKQJR5FZK56WHH6A&](https://rads.stackoverflow.com/amzn/click/com/0470224754)）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-25T23:23:41.933

这取决于您打算使用多少开箱即用的 Sharepoint。在实施我们面向公众的网站时，我们设法实现了 AA 合规性，尽管所需的定制开发量引发了人们对我们最初从使用 Sharepoint 中实际获得的好处的质疑。

几点建议：

我们大量使用 SPQuery/SPSiteDataQuery 来使用 xslt 将站点数据呈现到屏幕上，这使我们可以完全控制输出。我发现这个链接很有帮助：

[http://blog.thekid.me.uk/archive/2007/02/25/xml-results-using-spsitedataquery-in-sharepoint.aspx](http://blog.thekid.me.uk/archive/2007/02/25/xml-results-using-spsitedataquery-in-sharepoint.aspx)

查看用于 Sharepoint 的 RadEditor 以获取用于发布的易于访问的富文本编辑器。

对于 xhtml 合规性，事情有点棘手，我们必须覆盖大多数 Sharepoint 发布控件的渲染方法以纠正不可靠的输出。

如果您想在外联网中利用门户（如 Sharepoint 的功能），那就更成问题了。Web 部件框架不可访问，我还没有找到一种方法来实现它。欢迎任何建议！

# c# - Vista 上的 SoundPlayer 崩溃

> ID：82814
> 
> 赞同：2
> 
> 时间：2008-09-17T12:52:58.923
> 
> 标签：c#, winforms, windows-vista, audio

以下代码导致 Vista 机器上的间歇性崩溃。

```
using (SoundPlayer myPlayer = new SoundPlayer(Properties.Resources.BEEPPURE))
     myPlayer.Play(); 
```

我高度怀疑是这段代码，因为程序在哔哔声中或每次播放哔哔声之前崩溃。我的应用程序域中的 all 和`ThreadExceptions`around都有顶级陷阱，但没有一个会导致此崩溃。`UnhandledExceptions``try-catch``Application.Run`

有任何想法吗？

* * *

编辑：

事件查看器具有以下信息：

> 错误应用程序 [xyz].exe，版本 4.0.0.0，时间戳 0x48ce5a74，错误模块 msvcrt.dll，版本 7.0.6001.18000，时间戳 0x4791a727，异常代码 0xc0000005，错误偏移量 0x00009b30，进程 ID 0x%9，应用程序启动时间 0x %10。

有趣的是，`HRESULT 0xc0000005`有这样的信息：

> “读取或写入不可访问的内存位置。” (STATUS_ACCESS_VIOLATION)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-02T01:10:03.557

其实上面的代码（也就是 new SoundPlayer(BEEPPURE)).Play(); 对我来说是崩溃的。

本文解释了原因，并提供了一个可以完美运行的 SoundPlayer 替代方案：

[http://www.codeproject.com/KB/audio-video/soundplayerbug.aspx?msg=2862832#xx2862832xx](http://www.codeproject.com/KB/audio-video/soundplayerbug.aspx?msg=2862832#xx2862832xx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T13:03:07.260

您可以使用 WinDBG 并捕获所有第一次机会异常。我相信你会看到一些有趣的东西。如果是这样，您可以使用 SOS 清理堆栈并将其发布在此处以帮助我们。

或者，您可以通过启用所有异常的陷阱来使用 Visual Studio。转到“调试”，然后转到“异常”，确保捕获所有内容。在将调试器切换到混合模式（托管和非托管）的同时执行此操作。

一旦你有了堆栈跟踪，我们就可以确定答案。

进程不会在 Windows 上无异常退出。它在里面。此外，您可能需要检查机器的事件日志以查看是否有任何显示。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T13:50:52.607

事件查看器显示 HRESULT 0xc0000005“正在读取或写入不可访问的内存位置”。(STATUS_ACCESS_VIOLATION)

有关更多详细信息，请参阅我上面的编辑；重现这需要一段时间，所以我暂时无法获得 WinDBG 的新故障转储。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T19:43:13.663

解决方案是使用不受此错误影响的 Microsoft.VisualBasic.Devices。由于它只是 Vista，而且事件查看器甚至在记录崩溃的过程中失败（进程 id 0x**%9** 应该有一个十六进制值），我将责任归咎于 Vista 中的新声音代码。

顺便说一句，将 VS 调试器远程连接到崩溃进程，首先挂起 Visual Studio，然后在我的机器上导致蓝屏死机，同时杀死无响应的 devenv.exe。精彩的！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-02T17:20:22.020

这里纯属猜测，但问题可能出在 using 语句上。你的代码是这样的（我认为）：

```
using (SoundPlayer myPlayer = new SoundPlayer(BEEPPURE))
{    
    myPlayer.Play();
} 
```

using 块将调用 myPlayer 上的 Dispose()，有时在它完成播放声音之前（但很少，因为声音很短 - 声音较长，我敢打赌你每次都能重现错误）。该错误将是 Windows API（SoundPlayer 包装）试图播放已由 .NET 释放的缓冲区的结果。

我想如果你这样做：

```
SoundPlayer myPlayer = new SoundPlayer(BEEPPURE);
myPlayer.Play(); 
```

甚至

```
(new SoundPlayer(BEEPPURE)).Play(); 
```

您将不会再看到该错误。

# python - 如何检查文件是否存在无异常？

> ID：82831
> 
> 赞同：6545
> 
> 时间：2008-09-17T12:55:00.587
> 
> 标签：python, file, file-exists

如何在不使用[`try`](https://docs.python.org/3.6/reference/compound_stmts.html#try)语句的情况下检查文件是否存在？

* * *

## 回答 #1

> 赞同：5975
> 
> 时间：2008-09-17T12:57:51.127

如果您检查的原因是您可以执行类似的操作，那么在尝试打开它`if file_exists: open_it()`时使用 a 会更安全。`try`检查然后打开可能会导致文件被删除或移动，或者在检查和尝试打开文件之间存在风险。

如果您不打算立即打开文件，可以使用[`os.path.isfile`](https://docs.python.org/library/os.path.html#os.path.isfile)

> `True`如果 path 是现有的常规文件，则返回。这遵循符号链接，因此[islink()](https://docs.python.org/library/os.path.html#os.path.islink)和[isfile()](https://docs.python.org/library/os.path.html#os.path.isfile)对于同一路径都可以为真。

```
import os.path
os.path.isfile(fname) 
```

如果您需要确定它是一个文件。

从 Python 3.4 开始，该[`pathlib`模块](https://docs.python.org/3/library/pathlib.html#pathlib.Path.is_file)提供了一种面向对象的方法（`pathlib2`在 Python 2.7 中向后移植）：

```
from pathlib import Path

my_file = Path("/path/to/file")
if my_file.is_file():
    # file exists 
```

要检查目录，请执行以下操作：

```
if my_file.is_dir():
    # directory exists 
```

要检查一个`Path`对象是否独立于它是文件还是目录而存在，请使用`exists()`：

```
if my_file.exists():
    # path exists 
```

您还可以`resolve(strict=True)`在`try`块中使用：

```
try:
    my_abs_path = my_file.resolve(strict=True)
except FileNotFoundError:
    # doesn't exist
else:
    # exists 
```

* * *

## 回答 #2

> 赞同：2428
> 
> 时间：2008-09-17T12:57:08.740

你有这个[`os.path.exists`](https://docs.python.org/2/library/os.path.html#os.path.exists)功能：

```
import os.path
os.path.exists(file_path) 
```

这`True`将为文件和目录返回，但您可以改为使用

```
os.path.isfile(file_path) 
```

测试它是否是专门的文件。它遵循符号链接。

* * *

## 回答 #3

> 赞同：1125
> 
> 时间：2008-09-17T15:01:14.853

与, 不同[`isfile()`](https://docs.python.org/library/os.path.html#os.path.isfile)，[`exists()`](https://docs.python.org/library/os.path.html#os.path.exists)将返回`True`目录。因此，取决于您是否只想要普通文件或目录，您将使用`isfile()`or `exists()`。这是一些简单的 REPL 输出：

```
>>> os.path.isfile("/etc/password.txt")
True
>>> os.path.isfile("/etc")
False
>>> os.path.isfile("/does/not/exist")
False
>>> os.path.exists("/etc/password.txt")
True
>>> os.path.exists("/etc")
True
>>> os.path.exists("/does/not/exist")
False 
```

* * *

## 回答 #4

> 赞同：814
> 
> 时间：2008-09-17T12:55:48.807

```
import os

if os.path.isfile(filepath):
   print("File exists") 
```

* * *

## 回答 #5

> 赞同：402
> 
> 时间：2012-01-16T05:57:12.017

[`os.path.isfile()`](https://docs.python.org/3.3/library/os.path.html?highlight=os.path#os.path.isfile)与 一起使用[`os.access()`](https://docs.python.org/3.3/library/os.html?highlight=os.access#os.access)：

```
import os

PATH = './file.txt'
if os.path.isfile(PATH) and os.access(PATH, os.R_OK):
    print("File exists and is readable")
else:
    print("Either the file is missing or not readable") 
```

* * *

## 回答 #6

> 赞同：336
> 
> 时间：2008-09-17T12:56:22.563

```
import os
os.path.exists(path) # Returns whether the path (directory or file) exists or not
os.path.isfile(path) # Returns whether the file exists or not 
```

* * *

## 回答 #7

> 赞同：271
> 
> 时间：2017-06-20T19:28:07.863

尽管几乎所有可能的方式都列在（至少一个）现有答案中（例如添加了*Python 3.4*特定的东西），但我会尝试将所有内容组合在一起。

**注意**：我要发布的每一段*Python标准库代码都属于***3.5.3**版本。

**问题陈述**：

1.  检查文件（*有争议*：还有文件夹（“特殊”文件）？）存在
2.  不要使用***try*** / ***except*** / ***else*** / ***finally***块

**可能的解决方案**：

1.  [[Python 3]：os.path。**存在**（*路径*）](https://docs.python.org/3/library/os.path.html#os.path.exists)（也检查其他函数系列成员，如，，，以`os.path.isfile`了解略有不同的行为）`os.path.isdir``os.path.lexists`

    ```
    os.path.exists(path) 
    ```

    > `True`如果*path*引用现有路径或打开的文件描述符，则返回。返回`False`损坏的符号链接。`False`在某些平台上，如果未授予对请求的文件执行[os.stat()](https://docs.python.org/3/library/os.html#os.stat)的权限，即使*路径*物理存在，此函数也可能返回。

    一切都好，但如果遵循导入树：

    *   `os.path`- *posixpath.py* ( *ntpath.py* )

        *   *genericpath.py*，行*~#20+*

            ```
            def exists(path):
                """Test whether a path exists.  Returns False for broken symbolic links"""
                try:
                    st = os.stat(path)
                except os.error:
                    return False
                return True 
            ```

    这只是 [Python 3] 周围的***try*** / ***except***块[：os. **stat**（*路径，*，dir_fd=None，follow_symlinks=True*）](https://docs.python.org/3/library/os.html#os.stat)。因此，您的代码是***try*** / ***except*** free，但在框架堆栈的较低位置（至少）**有一个**这样的块。这也适用于其他功能（**包括** `os.path.isfile`）。

    1.1。[[Python 3]：路径。**is_file** ()](https://docs.python.org/3/library/pathlib.html#pathlib.Path.is_file)

    *   这是一种处理路径的更高级（和更多*python ic）的方式，***但是**
    *   在引擎盖下，它做的事情**完全相同**（*pathlib.py*，行*~#1330*）：

        ```
        def is_file(self):
            """
            Whether this path is a regular file (also True for symlinks pointing
            to regular files).
            """
            try:
                return S_ISREG(self.stat().st_mode)
            except OSError as e:
                if e.errno not in (ENOENT, ENOTDIR):
                    raise
                # Path doesn't exist or is a broken symlink
                # (see https://bitbucket.org/pitrou/pathlib/issue/12/)
                return False 
        ```

2.  [[Python 3]：使用语句上下文管理器](https://docs.python.org/3/reference/datamodel.html#context-managers)。任何一个：

    *   创建一个：

        ```
        class Swallow:  # Dummy example
            swallowed_exceptions = (FileNotFoundError,)

            def __enter__(self):
                print("Entering...")

            def __exit__(self, exc_type, exc_value, exc_traceback):
                print("Exiting:", exc_type, exc_value, exc_traceback)
                return exc_type in Swallow.swallowed_exceptions  # only swallow FileNotFoundError (not e.g. TypeError - if the user passes a wrong argument like None or float or ...) 
        ```

        *   及其用法 - 我将复制该`os.path.isfile`行为（请注意，这仅用于演示目的，请勿**尝试**为*生产*编写此类代码）：

            ```
            import os
            import stat

            def isfile_seaman(path):  # Dummy func
                result = False
                with Swallow():
                    result = stat.S_ISREG(os.stat(path).st_mode)
                return result 
            ```

    *   使用[[Python 3]：contextlib。**抑制**( **exceptions* )](https://docs.python.org/3/library/contextlib.html#contextlib.suppress) -**专**为选择性抑制异常而设计

    但是，它们似乎是***try*** / ***except*** / ***else*** / ***finally***块的包装器，如[[Python 3]：*with*语句](https://docs.python.org/3/reference/compound_stmts.html#with)指出：

    > 这允许封装常见的[try](https://docs.python.org/3/reference/compound_stmts.html#try) ... [except](https://docs.python.org/3/reference/compound_stmts.html#except) ... [finally](https://docs.python.org/3/reference/compound_stmts.html#finally)使用模式以方便重用。

3.  文件系统遍历函数（并搜索匹配项的结果）

    *   [[Python 3]：操作系统。**listdir** ( *path='.'* )](https://docs.python.org/3/library/os.html#os.listdir)（或[[Python 3]: **os.scandir** ( *path='.'* )](https://docs.python.org/3/library/os.html#os.scandir) on *Python v **3.5*** +，backport: [[PyPI]: scandir](https://pypi.org/project/scandir)）

        *   在引擎盖下，两者都使用：

            *   *尼克斯*：[[man7]：OPENDIR（3）](http://man7.org/linux/man-pages/man3/opendir.3.html) / [[man7]：READDIR（3）](http://man7.org/linux/man-pages/man3/readdir.3.html) / [[man7]：CLOSEDIR（3）](http://man7.org/linux/man-pages/man3/closedir.3.html)
            *   *Win* : [[MS.Docs]: FindFirstFileW 函数](https://docs.microsoft.com/en-gb/windows/desktop/api/fileapi/nf-fileapi-findfirstfilew)/ [[MS.Docs]: FindNextFileW 函数](https://docs.microsoft.com/en-gb/windows/desktop/api/fileapi/nf-fileapi-findnextfilew)/ [[MS.Docs]: FindClose 函数](https://docs.microsoft.com/en-gb/windows/desktop/api/fileapi/nf-fileapi-findclose)

            通过[[GitHub]：python/cpython - (master) cpython/Modules/posixmodule.c](https://github.com/python/cpython/blob/master/Modules/posixmodule.c)

        > 使用[scandir()](https://docs.python.org/3/library/os.html#os.scandir)代替[listdir()](https://docs.python.org/3/library/os.html#os.listdir)可以显着提高还需要文件类型或文件属性信息的代码的性能，因为如果操作系统在扫描目录时提供了这些信息， [os.DirEntry对象就会公开这些信息。](https://docs.python.org/3/library/os.html#os.DirEntry)所有[os.DirEntry](https://docs.python.org/3/library/os.html#os.DirEntry)方法都可以执行系统调用，但[is_dir()](https://docs.python.org/3/library/os.html#os.DirEntry.is_dir)和[is_file()](https://docs.python.org/3/library/os.html#os.DirEntry.is_file)通常只需要对符号链接进行系统调用；[os.DirEntry.stat()](https://docs.python.org/3/library/os.html#os.DirEntry.stat)在 Unix 上总是需要一个系统调用，但在 Windows 上只需要一个用于符号链接。

    *   [[Python 3]：操作系统。**walk** ( *top, topdown=True, onerror=None, followlinks=False* )](https://docs.python.org/3/library/os.html#os.walk)
        *   它使用`os.listdir`（`os.scandir`如果可用）
    *   [[Python 3]：全局。**iglob** ( *pathname, *, recursive=False* )](https://docs.python.org/3/library/glob.html#glob.iglob) (或其前身: `glob.glob`)
        *   *本身*似乎不是一个遍历函数（至少在某些情况下），但它仍然使用`os.listdir`

    由于这些迭代文件夹，（在大多数情况下）它们对我们的问题效率低下（有例外，如非通配符*glob* bing - 正如@ShadowRanger 指出的那样），所以我不会坚持使用它们。更不用说在某些情况下，可能需要文件名处理。

4.  [[Python 3]：操作系统。**访问**（*path, mode, *, dir_fd=None, Effective_ids=False, follow_symlinks=True*）](https://docs.python.org/3/library/os.html#os.access)的行为接近`os.path.exists`（实际上它更广泛，主要是因为^(第二)个参数）

    *   **正如文档所述，用户权限**可能会限制文件“可见性”：

        > *...测试调用用户是否具有对path*的指定访问权限。*模式*应该是[F_OK](https://docs.python.org/3/library/os.html#os.F_OK)来测试路径的存在...

    `os.access("/tmp", os.F_OK)`

    由于我也在*C*中工作，因此我也使用此方法，因为在后台，它调用**本机*API*（**再次通过*"${PYTHON_SRC_DIR}/Modules/posixmodule.c"*），但它也为可能的**用户打开了一扇门errors**，它不像其他变体那样是*Python* ic。因此，正如@AaronHall 正确指出的那样，除非您知道自己在做什么，否则不要使用它：

    *   *Nix* : [[man7]: ACCESS(2)](http://man7.org/linux/man-pages/man2/access.2.html) (!!!注意关于它的使用可能引入的**安全漏洞的注释!!!)**
    *   *赢*：[[MS.Docs]：GetFileAttributesW 函数](https://docs.microsoft.com/en-gb/windows/desktop/api/fileapi/nf-fileapi-getfileattributesw)

    **注意**：也可以通过[[Python 3]](https://docs.python.org/3/library/ctypes.html#module-ctypes)调用本机*API ：* [*ctypes*](https://docs.python.org/3/library/ctypes.html#module-ctypes) [- Python 的外部函数库](https://docs.python.org/3/library/ctypes.html#module-ctypes)，但在大多数情况下它更复杂。[](https://docs.python.org/3/library/ctypes.html#module-ctypes)

     *（特定于***Win***）：由于*vcruntime** ( *msvcr** ) *.dll*也导出了[[MS.Docs]: _access, _waccess](https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/access-waccess?view=vs-2015)函数系列，下面是一个示例：

    > ```
    > Python 3.5.3 (v3.5.3:1880cb95a742, Jan 16 2017, 16:02:32) [MSC v.1900 64 bit (AMD64)] on win32
    > Type "help", "copyright", "credits" or "license" for more information.
    > >>> import os, ctypes
    > >>> ctypes.CDLL("msvcrt")._waccess(u"C:\\Windows\\System32\\cmd.exe", os.F_OK)
    > 0
    > >>> ctypes.CDLL("msvcrt")._waccess(u"C:\\Windows\\System32\\cmd.exe.notexist", os.F_OK)
    > -1 
    > ```

    **备注**：

    *   虽然这不是一个好习惯，但我`os.F_OK`在通话中使用，但这只是为了清楚起见（其值为**0**）
    *   我正在使用*_waccess*以便在*Python3*和*Python2*上运行相同的代码（尽管它们之间存在*unicode*相关的差异）
    *   虽然这针对一个非常具体的领域，**但在之前的任何答案中都没有提到**

    *Lnx* ( Ubtu *(16 x64)* ) 也对应：

    > ```
    > Python 3.5.2 (default, Nov 17 2016, 17:05:23)
    > [GCC 5.4.0 20160609] on linux
    > Type "help", "copyright", "credits" or "license" for more information.
    > >>> import os, ctypes
    > >>> ctypes.CDLL("/lib/x86_64-linux-gnu/libc.so.6").access(b"/tmp", os.F_OK)
    > 0
    > >>> ctypes.CDLL("/lib/x86_64-linux-gnu/libc.so.6").access(b"/tmp.notexist", os.F_OK)
    > -1 
    > ```

    **备注**：

    *   相反，硬编码*libc*的路径（*“/lib/x86_64-linux-gnu/libc.so.6”*）可能（并且很可能会）因系统而异，*无*（或空字符串）可以传递给*CDLL*构造函数( **`ctypes.CDLL(None).access(b"/tmp", os.F_OK)`**)。根据[[man7]： DLOPEN(3)](http://man7.org/linux/man-pages/man3/dlopen.3.html)：

        > 如果*filename*为 NULL，则返回的句柄用于主程序。当给**dlsym** () 时，这个句柄会导致在主程序中搜索一个符号，然后是在程序启动时加载的所有共享对象，然后是由**dlopen** () 加载的所有共享对象，带有标志**RTLD_GLOBAL**。

        *   主（当前）程序（*python*）与*libc*链接，因此将加载其符号（包括*access ）*
        *   这必须小心处理，因为*main*、*Py_Main*和（所有）其他函数都是可用的；调用它们可能会产生灾难性影响（在当前程序上）
        *   这也不适用于*Win*（但这没什么大不了的，因为*msvcrt.dll*位于*“%SystemRoot%\System32”*中，默认情况下位于*%PATH%中）。*我想更进一步并在*Win*上复制这种行为（并提交补丁），但事实证明，[[MS.Docs]：GetProcAddress 函数](https://docs.microsoft.com/en-gb/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress)只“看到”**导出**的符号，所以除非有人在主可执行文件中声明这些函数作为`__declspec(dllexport)`（为什么地球上的*普通人*会这样做？），主程序是可加载的，但几乎无法使用* 
**   安装一些具有文件系统功能的第三方模块

    最有可能的是，将依赖上述方式之一（可能有轻微的定制）。
    一个例子是（同样，特定于*Win*）[[GitHub]：mhammond/pywin32 - Python for Windows (pywin32) Extensions](https://github.com/mhammond/pywin32)，它是*WINAPI上的**Python*包装器。

     *但是，由于这更像是一种解决方法，所以我在这里停下来。* **   另一个（蹩脚的）解决方法（*gainarie*）是（我喜欢这样称呼它）*系统管理员*方法：使用*Python*作为包装器来执行 shell 命令

    *   *赢*：

        > ```
        > (py35x64_test) e:\Work\Dev\StackOverflow\q000082831>"e:\Work\Dev\VEnvs\py35x64_test\Scripts\python.exe" -c "import os; print(os.system('dir /b \"C:\\Windows\\System32\\cmd.exe\" > nul 2>&1'))"
        > 0
        > 
        > (py35x64_test) e:\Work\Dev\StackOverflow\q000082831>"e:\Work\Dev\VEnvs\py35x64_test\Scripts\python.exe" -c "import os; print(os.system('dir /b \"C:\\Windows\\System32\\cmd.exe.notexist\" > nul 2>&1'))"
        > 1 
        > ```

    *   *尼克斯*（*Lnx*（*乌图*））：

        > ```
        > [cfati@cfati-ubtu16x64-0:~]> python3 -c "import os; print(os.system('ls \"/tmp\" > /dev/null 2>&1'))"
        > 0
        > [cfati@cfati-ubtu16x64-0:~]> python3 -c "import os; print(os.system('ls \"/tmp.notexist\" > /dev/null 2>&1'))"
        > 512 
        > ```** 

 ****底线**：

*   **一定要**使用***try*** / ***except*** / ***else*** / ***finally***块，因为它们可以防止你遇到一系列讨厌的问题。我能想到的一个反例是性能：这样的块很昂贵，所以尽量不要将它们放在应该每秒运行数十万次的代码中（但因为（在大多数情况下）它涉及磁盘访问，不会是这样）。

**最后说明**：

*   我会尽量保持最新，欢迎任何建议，我会将任何有用的东西纳入答案

* * *

## 回答 #8

> 赞同：208
> 
> 时间：2014-02-08T02:38:42.560

**Python 3.4+**有一个面向对象的路径模块：[**pathlib**](https://docs.python.org/3/library/pathlib.html)。使用这个新模块，您可以像这样检查文件是否存在：

```
import pathlib
p = pathlib.Path('path/to/file')
if p.is_file():  # or p.is_dir() to see if it is a directory
    # do stuff 
```

`try/except`您可以（通常应该）在打开文件时仍然使用块：

```
try:
    with p.open() as f:
        # do awesome stuff
except OSError:
    print('Well darn.') 
```

pathlib 模块中有很多很酷的东西：方便的通配符、检查文件的所有者、更简单的路径连接等。值得一试。如果您使用的是较旧的 Python（2.6 版或更高版本），您仍然可以使用 pip 安装 pathlib：

```
# installs pathlib2 on older Python versions
# the original third-party module, pathlib, is no longer maintained.
pip install pathlib2 
```

然后按如下方式导入：

```
# Older Python versions
import pathlib2 as pathlib 
```

* * *

## 回答 #9

> 赞同：166
> 
> 时间：2013-06-27T13:38:04.933

这是检查文件是否存在的最简单方法。仅仅**因为**您检查时该文件存在并不能**保证**在您需要打开它时它会在那里。

```
import os
fname = "foo.txt"
if os.path.isfile(fname):
    print("file does exist at this time")
else:
    print("no such file exists at this time") 
```

* * *

## 回答 #10

> 赞同：135
> 
> 时间：2015-08-11T03:54:25.493

> ## 如何在不使用 try 语句的情况下使用 Python 检查文件是否存在？

现在从 Python 3.4 开始可用，`Path`使用文件名导入和实例化一个对象，并检查`is_file`方法（注意，对于指向常规文件的符号链接，这也会返回 True）：

```
>>> from pathlib import Path
>>> Path('/').is_file()
False
>>> Path('/initrd.img').is_file()
True
>>> Path('/doesnotexist').is_file()
False 
```

如果您使用的是 Python 2，则可以从 pypi 反向移植 pathlib 模块[`pathlib2`](https://pypi.python.org/pypi/pathlib2/)，或者`isfile`从`os.path`模块中检查：

```
>>> import os
>>> os.path.isfile('/')
False
>>> os.path.isfile('/initrd.img')
True
>>> os.path.isfile('/doesnotexist')
False 
```

现在上面可能是这里最好的实用直接答案，但是可能存在竞争条件（取决于您要完成的工作），以及底层实现使用 a 的事实`try`，但 Python`try`在其实现中无处不在。

因为 Python`try`无处不在，所以没有理由避免使用它的实现。

但是这个答案的其余部分试图考虑这些警告。

## 更长，更迂腐的答案

从 Python 3.4 开始可用，`Path`使用`pathlib`. 请注意，这`.exists`并不完全正确，因为目录不是文件（除非在 unix 意义上，*一切*都是文件）。

```
>>> from pathlib import Path
>>> root = Path('/')
>>> root.exists()
True 
```

所以我们需要使用`is_file`：

```
>>> root.is_file()
False 
```

这是关于的帮助`is_file`：

```
is_file(self)
    Whether this path is a regular file (also True for symlinks pointing
    to regular files). 
```

所以让我们得到一个我们知道是文件的文件：

```
>>> import tempfile
>>> file = tempfile.NamedTemporaryFile()
>>> filepathobj = Path(file.name)
>>> filepathobj.is_file()
True
>>> filepathobj.exists()
True 
```

默认情况下，`NamedTemporaryFile`关闭时删除文件（当没有更多引用时将自动关闭）。

```
>>> del file
>>> filepathobj.exists()
False
>>> filepathobj.is_file()
False 
```

但是，如果您深入[研究实现](https://github.com/python/cpython/blob/master/Lib/pathlib.py#L1318)，您会看到`is_file`使用`try`：

```
def is_file(self):
    """
    Whether this path is a regular file (also True for symlinks pointing
    to regular files).
    """
    try:
        return S_ISREG(self.stat().st_mode)
    except OSError as e:
        if e.errno not in (ENOENT, ENOTDIR):
            raise
        # Path doesn't exist or is a broken symlink
        # (see https://bitbucket.org/pitrou/pathlib/issue/12/)
        return False 
```

## 比赛条件：为什么我们喜欢尝试

我们喜欢`try`，因为它避免了竞争条件。使用`try`，您只需尝试读取您的文件，并期望它存在，如果没有，您将捕获异常并执行任何有意义的回退行为。

如果您想在尝试读取文件之前检查文件是否存在，并且您可能正在删除它，然后您可能正在使用多个线程或进程，或者另一个程序知道该文件并可以删除它 - 您可能会冒如果您检查它是否存在，则为**竞争条件**，因为您随后会在其*条件*（其存在）更改之前*竞相*打开它。

 *竞态条件很难调试，因为有一个非常小的窗口可能会导致程序失败。

但如果这是你的动机，你*可以*`try`通过使用`suppress`上下文管理器来获得语句的价值。

## 在没有 try 语句的情况下避免竞争条件：`suppress`

Python 3.4 为我们提供了[`suppress`](https://docs.python.org/3/library/contextlib.html#contextlib.suppress)上下文管理器（以前的[`ignore`](https://bugs.python.org/issue19266)上下文管理器），它在语义上以更少的行数完成完全相同的事情，同时（至少在表面上）满足了避免`try`声明的原始要求：

```
from contextlib import suppress
from pathlib import Path 
```

用法：

```
>>> with suppress(OSError), Path('doesnotexist').open() as f:
...     for line in f:
...         print(line)
... 
>>>
>>> with suppress(OSError):
...     Path('doesnotexist').unlink()
... 
>>> 
```

对于早期的 Python，你可以自己滚动`suppress`，但没有 a`try`会比 with 更冗长。我确实相信这实际上是唯一一个在 Python 3.4 之前**的 Python 中任何级别****都没有使用的答案，因为它使用了上下文管理器：`try`**

```
class suppress(object):
    def __init__(self, *exceptions):
        self.exceptions = exceptions
    def __enter__(self):
        return self
    def __exit__(self, exc_type, exc_value, traceback):
        if exc_type is not None:
            return issubclass(exc_type, self.exceptions) 
```

尝试一下可能更容易：

```
from contextlib import contextmanager

@contextmanager
def suppress(*exceptions):
    try:
        yield
    except exceptions:
        pass 
```

## 其他不符合“无需尝试”要求的选项：

**文件**

```
import os
os.path.isfile(path) 
```

来自[文档](https://docs.python.org/library/os.path.html#os.path.isfile)：

> `os.path.isfile(path)`
> 
> 如果 path 是现有的常规文件，则返回 True。这遵循符号链接，因此对于同一路径，两者`islink()`和`isfile()`都可以为真。

但是如果你检查这个函数的[源代码](https://hg.python.org/cpython/file/tip/Lib/genericpath.py#l25)，你会发现它确实使用了一个 try 语句：

> ```
> # This follows symbolic links, so both islink() and isdir() can be true
> # for the same path on systems that support symlinks
> def isfile(path):
>     """Test whether a path is a regular file"""
>     try:
>         st = os.stat(path)
>     except os.error:
>         return False
>     return stat.S_ISREG(st.st_mode) 
> ```

```
>>> OSError is os.error
True 
```

它所做的只是使用给定的路径来查看它是否可以获得统计信息，捕获`OSError`然后检查它是否是一个文件，如果它没有引发异常。

如果您打算对该文件执行某些操作，我建议您直接尝试使用 try-except 来避免竞争条件：

```
try:
    with open(path) as f:
        f.read()
except OSError:
    pass 
```

**操作系统访问**

适用于 Unix 和 Windows 的是`os.access`，但要使用你必须传递标志，并且它不区分文件和目录。这更用于测试真正的调用用户是否可以在提升的特权环境中访问：

```
import os
os.access(path, os.F_OK) 
```

它也遭受与`isfile`. 从[文档](https://docs.python.org/2/library/os.html#os.access)：

> 注意：使用 access() 来检查用户是否被授权例如在使用 open() 实际打开文件之前打开文件会产生安全漏洞，因为用户可能会利用检查和打开文件之间的短时间间隔来操作它。最好使用 EAFP 技术。例如：
> 
> ```
> if os.access("myfile", os.R_OK):
>     with open("myfile") as fp:
>         return fp.read()
> return "some default data" 
> ```
> 
> 最好写成：
> 
> ```
> try:
>     fp = open("myfile")
> except IOError as e:
>     if e.errno == errno.EACCES:
>         return "some default data"
>     # Not a permission error.
>     raise
> else:
>     with fp:
>         return fp.read() 
> ```

避免使用`os.access`. 它是一个低级函数，比上面讨论的高级对象和函数有更多的用户错误机会。

### 对另一个答案的批评：

另一个答案是这样说的`os.access`：

> 就个人而言，我更喜欢这个，因为在底层，它调用原生 API（通过“${PYTHON_SRC_DIR}/Modules/posixmodule.c”），但它也为可能的用户错误打开了大门，而且它不像其他变体那样 Pythonic ：

这个答案说它更喜欢非 Pythonic、容易出错的方法，没有任何理由。它似乎鼓励用户在不了解它们的情况下使用低级 API。

它还创建了一个上下文管理器，通过无条件返回`True`，允许所有异常（包括`KeyboardInterrupt`和`SystemExit`！）静默通过，这是隐藏错误的好方法。

这似乎鼓励用户采用不良做法。

* * *

## 回答 #11

> 赞同：134
> 
> 时间：2009-11-04T00:48:06.243

更喜欢 try 语句。它被认为是更好的风格并避免了竞争条件。

不要相信我的话。这个理论有很多支持。这是一对：

*   [样式： http](http://allendowney.com/sd/notes/notes11.txt) ://allendowney.com/sd/notes/notes11.txt 的“处理异常情况”部分
*   [避免竞争条件](https://developer.apple.com/library/mac/#documentation/security/conceptual/SecureCodingGuide/Articles/RaceConditions.html#//apple_ref/doc/uid/TP40002585-SW8)

* * *

## 回答 #12

> 赞同：94
> 
> 时间：2015-05-25T18:29:22.343

```
import os
#Your path here e.g. "C:\Program Files\text.txt"
#For access purposes: "C:\\Program Files\\text.txt"
if os.path.exists("C:\..."):   
    print "File found!"
else:
    print "File not found!" 
```

导入`os`使您可以更轻松地在操作系统中导航和执行标准操作。

另请参阅[如何使用 Python 检查文件是否存在？](/q/82831)

如果您需要高级操作，请使用`shutil`.

* * *

## 回答 #13

> 赞同：92
> 
> 时间：2016-10-08T12:43:02.357

`os.path.isfile()`使用和测试文件和文件`os.path.isdir()`夹`os.path.exists()`

假设“路径”是有效路径，下表显示了每个函数为文件和文件夹返回的内容：

[![在此处输入图像描述](https://i.stack.imgur.com/tOs9p.png)](https://i.stack.imgur.com/tOs9p.png)

您还可以测试文件是否是用于获取扩展名的某种类型的文件`os.path.splitext()`（如果您还不知道）

```
>>> import os
>>> path = "path to a word document"
>>> os.path.isfile(path)
True
>>> os.path.splitext(path)[1] == ".docx" # test if the extension is .docx
True 
```

* * *

## 回答 #14

> 赞同：79
> 
> 时间：2016-02-24T12:44:10.810

在 2016 年，最好的方法仍然是使用`os.path.isfile`：

```
>>> os.path.isfile('/path/to/some/file.txt') 
```

或者在 Python 3 中，您可以使用`pathlib`：

```
import pathlib
path = pathlib.Path('/path/to/some/file.txt')
if path.is_file():
    ... 
```

* * *

## 回答 #15

> 赞同：72
> 
> 时间：2013-09-25T01:52:46.610

try/except 和 之间似乎没有有意义的功能差异`isfile()`，因此您应该使用哪个有意义。

如果要读取文件，如果存在，请执行

```
try:
    f = open(filepath)
except IOError:
    print 'Oh dear.' 
```

但是，如果您只想重命名文件（如果存在），因此不需要打开它，请执行

```
if os.path.isfile(filepath):
    os.rename(filepath, filepath + '.old') 
```

如果要写入文件，如果文件不存在，请执行

```
# python 2
if not os.path.isfile(filepath):
    f = open(filepath, 'w')

# python 3, x opens for exclusive creation, failing if the file already exists
try:
    f = open(filepath, 'wx')
except IOError:
    print 'file already exists' 
```

如果您需要文件锁定，那就另当别论了。

* * *

## 回答 #16

> 赞同：69
> 
> 时间：2021-01-23T09:48:29.683

## **TL；DR**
答案是：`pathlib`模块——只有一行代码——

**Pathlib**可能是几乎所有文件操作的最现代和最方便的方式。对于**文件**或**文件夹**的存在，一行代码就足够了。

```
from pathlib import Path

if Path("myfile.txt").exists(): # works for both file and folders
    # do your cool stuff... 
```

该`pathlib`模块是在 中引入的`Python 3.4`，因此您需要拥有 Python 3.4+，这个库使您在处理文件和文件夹时变得更加轻松，而且它很好用，这里有更多关于它的文档（[https://docs.python. org/3/library/pathlib.html](https://docs.python.org/3/library/pathlib.html) )。

顺便说一句，如果您要重用路径，那么最好将其分配给变量

所以会变成

```
from pathlib import Path

p = Path("loc/of/myfile.txt")
if p.exists(): # works for both file and folders
    # do stuffs...
#reuse 'p' if needed. 
```

* * *

## 回答 #17

> 赞同：64
> 
> 时间：2011-01-25T23:00:01.193

你可以试试这个（更安全）：

```
try:
    # http://effbot.org/zone/python-with-statement.htm
    # 'with' is safer to open a file
    with open('whatever.txt') as fh:
        # Do something with 'fh'
except IOError as e:
    print("({})".format(e)) 
```

输出将是：

> （[Errno 2] 没有这样的文件或目录：'whatever.txt'）

然后，根据结果，您的程序可以从那里继续运行，或者您可以根据需要编写代码来停止它。

* * *

## 回答 #18

> 赞同：55
> 
> 时间：2017-12-04T08:51:49.200

日期：2017-12-04

每个可能的解决方案都已在其他答案中列出。

检查文件是否存在的一种直观且有争议的方法如下：

```
import os
os.path.isfile('~/file.md')  # Returns True if exists, else False
# additionaly check a dir
os.path.isdir('~/folder')  # Returns True if the folder exists, else False
# check either a dir or a file
os.path.exists('~/file') 
```

我制作了一份详尽的备忘单供您参考：

```
#os.path methods in exhaustive cheatsheet
{'definition': ['dirname',
               'basename',
               'abspath',
               'relpath',
               'commonpath',
               'normpath',
               'realpath'],
'operation': ['split', 'splitdrive', 'splitext',
               'join', 'normcase'],
'compare': ['samefile', 'sameopenfile', 'samestat'],
'condition': ['isdir',
              'isfile',
              'exists',
              'lexists'
              'islink',
              'isabs',
              'ismount',],
 'expand': ['expanduser',
            'expandvars'],
 'stat': ['getatime', 'getctime', 'getmtime',
          'getsize']} 
```

* * *

## 回答 #19

> 赞同：54
> 
> 时间：2014-12-26T20:05:32.250

Although I always recommend using `try` and `except` statements, here are a few possibilities for you (my personal favourite is using `os.access`):

1.  Try opening the file:

    Opening the file will always verify the existence of the file. You can make a function just like so:

    ```
    def File_Existence(filepath):
        f = open(filepath)
        return True 
    ```

    If it's False, it will stop execution with an unhanded IOError or OSError in later versions of Python. To catch the exception, you have to use a try except clause. Of course, you can always use a `try` except` statement like so (thanks to [hsandt](https://stackoverflow.com/users/3256073/hsandt) for making me think):

    ```
    def File_Existence(filepath):
        try:
            f = open(filepath)
        except IOError, OSError: # Note OSError is for later versions of Python
            return False

        return True 
    ```

2.  Use `os.path.exists(path)`:

    This will check the existence of what you specify. However, it checks for files *and* directories so beware about how you use it.

    ```
    import os.path
    >>> os.path.exists("this/is/a/directory")
    True
    >>> os.path.exists("this/is/a/file.txt")
    True
    >>> os.path.exists("not/a/directory")
    False 
    ```

3.  Use `os.access(path, mode)`:

    This will check whether you have access to the file. It will check for permissions. Based on the os.py documentation, typing in `os.F_OK`, it will check the existence of the path. However, using this will create a security hole, as someone can attack your file using the time between checking the permissions and opening the file. You should instead go directly to opening the file instead of checking its permissions. ([EAFP](https://docs.python.org/2/glossary.html#term-eafp) vs [LBYP](https://docs.python.org/2/glossary.html#term-lbyl)). If you're not going to open the file afterwards, and only checking its existence, then you can use this.

    Anyway, here:

    ```
    >>> import os
    >>> os.access("/is/a/file.txt", os.F_OK)
    True 
    ```

I should also mention that there are two ways that you will not be able to verify the existence of a file. Either the issue will be `permission denied` or `no such file or directory`. If you catch an `IOError`, set the `IOError as e` (like my first option), and then type in `print(e.args)` so that you can hopefully determine your issue. I hope it helps! :)

* * *

## 回答 #20

> 赞同：49
> 
> 时间：2021-05-10T16:42:59.710

最简单的方法是使用

```
import os

if os.path.exists(FILE):
  # file exists
  pass
else:
  # file does not exists
  pass 
```

来自 os 库，而**FILE**是相对路径。在 Windows 中，这可能会或很多不起作用，您可能必须通过这样做来使用绝对路径`os.path.exists(os.path.join(os.path.abspath('./'), FILE))`，其中**FILE**仍然是相对路径加上文件名

* * *

## 回答 #21

> 赞同：41
> 
> 时间：2008-09-17T13:13:31.430

此外，`os.access()`：

```
if os.access("myfile", os.R_OK):
    with open("myfile") as fp:
        return fp.read() 
```

存在`R_OK`,`W_OK`和`X_OK`用于测试权限的标志 ( [doc](https://docs.python.org/3/library/os.html#os.access) )。

* * *

## 回答 #22

> 赞同：41
> 
> 时间：2014-10-13T07:45:16.663

如果文件用于打开，您可以使用以下技术之一：

```
with open('somefile', 'xt') as f: #Using the x-flag, Python3.3 and above
    f.write('Hello\n')

if not os.path.exists('somefile'): 
    with open('somefile', 'wt') as f:
        f.write("Hello\n")
else:
    print('File already exists!') 
```

* * *

**更新**

只是为了避免混淆，根据我得到的答案，当前答案会找到具有给定名称的文件**或目录。**

* * *

## 回答 #23

> 赞同：35
> 
> 时间：2021-04-16T05:21:31.163

您可以使用 os.path.exists() ：

```
import os
print(os.path.exists("file")) 
```

希望它有帮助：D

* * *

## 回答 #24

> 赞同：22
> 
> 时间：2015-04-28T02:45:31.913

```
if os.path.isfile(path_to_file):
    try: 
        open(path_to_file)
            pass
    except IOError as e:
        print "Unable to open file" 
```

> 引发异常被认为是一种可接受的 Pythonic 方法，用于在您的程序中进行流控制。考虑使用 IOErrors 处理丢失的文件。在这种情况下，如果文件存在但用户没有读取权限，则会引发 IOError 异常。

SRC：[http ://www.pfinn.net/python-check-if-file-exists.html](http://www.pfinn.net/python-check-if-file-exists.html)

* * *

## 回答 #25

> 赞同：22
> 
> 时间：2017-08-10T05:50:16.413

如果您已经出于其他目的导入了 NumPy，则无需导入其他库，如`pathlib`、`os`、`paths`等。

```
import numpy as np
np.DataSource().exists("path/to/your/file") 
```

这将根据其存在返回 true 或 false。

* * *

## 回答 #26

> 赞同：20
> 
> 时间：2014-02-10T21:30:20.503

您可以在没有`try:`.

```
from contextlib import suppress

with suppress(IOError), open('filename'):
    process() 
```

`suppress`是 Python 3.4 的一部分。在旧版本中，您可以快速编写自己的抑制：

```
from contextlib import contextmanager

@contextmanager
def suppress(*exceptions):
    try:
        yield
    except exceptions:
        pass 
```

* * *

## 回答 #27

> 赞同：19
> 
> 时间：2018-03-04T06:24:37.457

# 检查文件或目录是否存在

您可以遵循以下三种方式：

> 注1：`os.path.isfile`仅用于文件

```
import os.path
os.path.isfile(filename) # True if file exists
os.path.isfile(dirname) # False if directory exists 
```

> 注意2：`os.path.exists`用于文件和目录

```
import os.path
os.path.exists(filename) # True if file exists
os.path.exists(dirname) #True if directory exists 
```

> 该`pathlib.Path`方法（包含在 Python 3+ 中，可通过 Python 2 的 pip 安装）

```
from pathlib import Path
Path(filename).exists() 
```

* * *

## 回答 #28

> 赞同：18
> 
> 时间：2016-05-05T12:00:42.880

我是一个已经存在了大约 10 年的包的作者，它具有直接解决这个问题的功能。基本上，如果您在非 Windows 系统上，它用于`Popen`访问`find`. 但是，如果您在 Windows 上，它会`find`使用高效的文件系统 walker 进行复制。

代码本身不使用`try`块......除了确定操作系统并因此引导您使用“Unix”风格`find`或手工构建的`find`. 计时测试表明，`try`确定操作系统的速度更快，所以我确实在那里使用了一个（但没有在其他地方使用）。

```
>>> import pox
>>> pox.find('*python*', type='file', root=pox.homedir(), recurse=False)
['/Users/mmckerns/.python'] 
```

还有医生……</p>

```
>>> print pox.find.__doc__
find(patterns[,root,recurse,type]); Get path to a file or directory

    patterns: name or partial name string of items to search for
    root: path string of top-level directory to search
    recurse: if True, recurse down from root directory
    type: item filter; one of {None, file, dir, link, socket, block, char}
    verbose: if True, be a little verbose about the search

    On some OS, recursion can be specified by recursion depth (an integer).
    patterns can be specified with basic pattern matching. Additionally,
    multiple patterns can be specified by splitting patterns with a ';'
    For example:
        >>> find('pox*', root='..')
        ['/Users/foo/pox/pox', '/Users/foo/pox/scripts/pox_launcher.py']

        >>> find('*shutils*;*init*')
        ['/Users/foo/pox/pox/shutils.py', '/Users/foo/pox/pox/__init__.py']

>>> 
```

如果你想看的话，实现在这里： [https ://github.com/uqfoundation/pox/blob/89f90fb308f285ca7a62eabe2c38acb87e89dad9/pox/shutils.py#L190](https://github.com/uqfoundation/pox/blob/89f90fb308f285ca7a62eabe2c38acb87e89dad9/pox/shutils.py#L190)

* * *

## 回答 #29

> 赞同：18
> 
> 时间：2016-08-05T15:54:37.243

添加一个未完全反映在其他答案中的细微变化。

这将处理`file_path`存在`None`或空字符串的情况。

```
def file_exists(file_path):
    if not file_path:
        return False
    elif not os.path.isfile(file_path):
        return False
    else:
        return True 
```

根据 Shahbaz 的建议添加变体

```
def file_exists(file_path):
    if not file_path:
        return False
    else:
        return os.path.isfile(file_path) 
```

根据 Peter Wood 的建议添加变体

```
def file_exists(file_path):
    return file_path and os.path.isfile(file_path): 
```

* * *

## 回答 #30

> 赞同：16
> 
> 时间：2015-08-29T16:15:29.367

这是用于 Linux 命令行环境的 1 行 Python 命令。我觉得这很方便，因为我不是那么热的 Bash 人。

```
python -c "import os.path; print os.path.isfile('/path_to/file.xxx')" 
```

我希望这是有帮助的。

* * *

## 回答 #31

> 赞同：15
> 
> 时间：2014-12-20T15:21:40.383

您可以使用 Python 的“OS”库：

```
>>> import os
>>> os.path.exists("C:\\Users\\####\\Desktop\\test.txt") 
True
>>> os.path.exists("C:\\Users\\####\\Desktop\\test.tx")
False 
```

* * *

## 回答 #32

> 赞同：15
> 
> 时间：2016-12-02T06:39:08.737

> **如何在不使用 try 语句的情况下检查文件是否存在？**

在 2016 年，这仍然可以说是检查文件是否存在以及它是否是文件的最简单方法：

```
import os
os.path.isfile('./file.txt')    # Returns True if exists, else False 
```

`isfile`实际上只是内部使用`os.stat`和`stat.S_ISREG(mode)`底层的辅助方法。这`os.stat`是一种较低级别的方法，它将为您提供有关文件、目录、套接字、缓冲区等的详细信息。[更多关于 os.stat 这里](https://docs.python.org/2/library/os.html#os.stat)

**注意：**但是，这种方法不会以任何方式锁定文件，因此您的代码可能容易受到“**检查时间到使用时间**”（*TOCTTOU*）错误的影响。

因此，引发异常被认为是一种可接受的 Pythonic 方法，用于在您的程序中进行流控制。并且应该考虑使用 IOErrors 而不是`if`语句（*只是一个建议*）来处理丢失的文件。

* * *

## 回答 #33

> 赞同：11
> 
> 时间：2015-08-05T06:28:27.807

```
import os.path

def isReadableFile(file_path, file_name):
    full_path = file_path + "/" + file_name
    try:
        if not os.path.exists(file_path):
            print "File path is invalid."
            return False
        elif not os.path.isfile(full_path):
            print "File does not exist."
            return False
        elif not os.access(full_path, os.R_OK):
            print "File cannot be read."
            return False
        else:
            print "File can be read."
            return True
    except IOError as ex:
        print "I/O error({0}): {1}".format(ex.errno, ex.strerror)
    except Error as ex:
        print "Error({0}): {1}".format(ex.errno, ex.strerror)
    return False
#------------------------------------------------------

path = "/usr/khaled/documents/puzzles"
fileName = "puzzle_1.txt"

isReadableFile(path, fileName) 
```

* * *

## 回答 #34

> 赞同：9
> 
> 时间：2020-01-26T23:28:23.603

****' Path ' 对象的****exists()**和**is_file()**方法可用于检查给定路径是否存在并且是文件。**

 ******用于检查文件是否存在的 Python 3 程序：**

```
# File name:  check-if-file-exists.py

from pathlib import Path

filePath = Path(input("Enter path of the file to be found: "))

if filePath.exists() and filePath.is_file():
    print("Success: File exists")
else:
    print("Error: File does not exist") 
```

**输出：**

> **$ python3 检查文件是否存在.py**
> 
> 输入要找到的文件的路径：***/Users/macuser1/stack-overflow/index.html***
> 
> 成功：***文件存在***
> 
> **$ python3 检查文件是否存在.py**
> 
> 输入要查找的文件路径：***hghjg jghj***
> 
> 错误：***文件不存在***

* * *

## 回答 #35

> 赞同：8
> 
> 时间：2013-04-04T18:21:11.250

你绝对应该使用这个。

```
from os.path import exists

if exists("file") == True:
    print "File exists."
elif exists("file") == False:
    print "File doesn't exist." 
```

* * *

## 回答 #36

> 赞同：7
> 
> 时间：2011-08-26T08:08:04.907

```
import os
path = /path/to/dir

root,dirs,files = os.walk(path).next()
if myfile in files:
   print "yes it exists" 
```

这在检查多个文件时很有帮助。或者您想对现有列表进行设置交集/减法。

* * *

## 回答 #37

> 赞同：7
> 
> 时间：2014-10-17T21:25:30.180

要检查文件是否存在，

```
from sys import argv

from os.path import exists
script, filename = argv
target = open(filename)
print "file exists: %r" % exists(filename) 
```

* * *

## 回答 #38

> 赞同：7
> 
> 时间：2014-05-23T10:01:20.093

您可以使用以下打开方法来检查文件是否存在+可读：

```
file = open(inputFile, 'r')
file.close() 
```

* * *

## 回答 #39

> 赞同：6
> 
> 时间：2016-06-08T12:45:32.343

您可以使用 os.listdir 检查文件是否在某个目录中。

```
import os
if 'file.ext' in os.listdir('dirpath'):
    #code 
```

* * *

## 回答 #40

> 赞同：5
> 
> 时间：2018-10-31T13:22:09.593

```
import os

# for testing purpose args defaulted to current folder & file. 
# returns True if file found
def file_exists(FOLDER_PATH='../', FILE_NAME=__file__):
    return os.path.isdir(FOLDER_PATH) \
        and os.path.isfile(os.path.join(FOLDER_PATH, FILE_NAME)) 
```

基本上是文件夹检查，然后使用*os.path.join*使用适当的目录分隔符进行文件检查。

* * *

## 回答 #41

> 赞同：4
> 
> 时间：2020-05-12T14:35:54.657

使用[os.path.exists()](https://www.geeksforgeeks.org/python-os-path-exists-method/)检查文件是否存在：

```
def fileAtLocation(filename,path):
    return os.path.exists(path + filename)

filename="dummy.txt"
path = "/home/ie/SachinSaga/scripts/subscription_unit_reader_file/"

if fileAtLocation(filename,path):
   print('file found at location..')
else:
   print('file not found at location..') 
```

* * *

## 回答 #42

> 赞同：2
> 
> 时间：2021-04-07T20:26:23.783

另一种可能的选择是使用 os.listdir() 检查文件名是否在目录中

```
import os
if 'foo.txt' in os.listdir():
    # Do things 
```

如果是则返回 true，否则返回 false

# .net - 在控制台应用程序中读取命令行参数的最佳方法

> ID：82838
> 
> 赞同：20
> 
> 时间：2008-09-17T12:56:03.203
> 
> 标签：.net, command-line, parameters

下面是两种读取命令行参数的方法。第一种是我习惯于在 main 中使用参数的方式。我在审查代码时偶然发现的第二个。我注意到第二个将数组中的第一项分配给路径和应用程序，但第一个跳过了这个。

它只是偏好还是第二种方式现在更好？

```
Sub Main(ByVal args() As String)
    For i As Integer = 0 To args.Length - 1
        Console.WriteLine("Arg: " & i & " is " & args(i))
    Next

    Console.ReadKey()
End Sub 
```

```
Sub Main()
    Dim args() As String = System.Environment.GetCommandLineArgs()

    For i As Integer = 0 To args.Length - 1
        Console.WriteLine("Arg: " & i & " is " & args(i))
    Next

    Console.ReadKey()
End Sub 
```

我认为在 C# 中也可以这样做，所以这不一定是 vb.net 的问题。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-09-17T12:58:10.203

第二种方法更好，因为它可以在 main() 之外使用，所以当你重构时，它就少了一件需要考虑的事情。

另外，我不喜欢第一种方式将 args 放入方法参数的“魔术”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T13:05:27.300

你知道getopt吗？在 codeplex 上有一个 C# 端口：http: [//www.codeplex.com/getopt](http://www.codeplex.com/getopt)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T13:01:25.923

第一种方法更好，因为它更简单。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-15T14:15:39.633

对我来说，第一种方法似乎更直观，因为这就是我从 C/C++ 时代以来一直在做的事情。

如果您的命令行有太多开关，请查看 Thomas 推荐的 getopt。它非常有用。不过，我还没有看过相同的 C# 端口。

问候，

公斤

# sql - 简化 SQL JOIN 语句创建的 MySQL 工具？

> ID：82842
> 
> 赞同：9
> 
> 时间：2008-09-17T12:56:24.217
> 
> 标签：sql, mysql

有谁知道查看 MySQL 数据库、以图形方式显示所有表并允许您通过拖放创建复杂的 JOIN 语句的工具？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-01T03:58:06.137

在你购买任何东西之前，看看免费的官方[MySQL 的 GUI 工具](http://dev.mysql.com/downloads/gui-tools/)（特别是**MySQL Query Browser**）是否适合你。

就个人而言，我与 MySQL 的命令行界面交互相当自如，并且没有太多使用他们的 GUI 工具，但我刚刚下载了 Query Browser，它似乎完全符合您的要求。

此外，请查看[“在 MySQL 查询浏览器中可视化构建查询”](http://www.packtpub.com/article/building-queries-visually-in-mysql-query-browser) ，了解 MySQL 查询浏览器的精彩之旅。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-07-24T18:54:15.773

作为更新，不再支持 MySQL Tools 集合，并已被 MySQL Workbench 取代。文档可以在这里找到：http: [//dev.mysql.com/doc/workbench/en/index.html](http://dev.mysql.com/doc/workbench/en/index.html)，你可以在这里下载：http: [//dev.mysql.com/downloads/workbench/](http://dev.mysql.com/downloads/workbench/)

编辑：今天也偶然发现了这个，一个很好的mysql工作台初学者教程-> [http://net.tutsplus.com/tutorials/databases/visual-database-creation-with-mysql-workbench/](http://net.tutsplus.com/tutorials/databases/visual-database-creation-with-mysql-workbench/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T12:58:10.203

[EMS SQL Manager for MySQL](http://www.sqlmanager.net/products/mysql/manager)具有查询构造函数。不记得有关联接的信息，但应该支持它们。

# c# - 在 WPF 中，什么相当于 Windows 窗体中的 Suspend/ResumeLayout() 和 BackgroundWorker()

> ID：82847
> 
> 赞同：15
> 
> 时间：2008-09-17T12:57:24.810
> 
> 标签：c#, .net, wpf, backgroundworker

如果我在后面代码中的函数中，并且我想实现在状态栏中显示“正在加载...”，则以下是有意义的，但正如我们从 WinForms 中知道的那样，这是一个否：

```
StatusBarMessageText.Text = "Loading Configuration Settings...";            
LoadSettingsGridData();
StatusBarMessageText.Text = "Done"; 
```

我们现在从 WinForms 第 1 章第 101 课中了解到，在整个函数完成之前，表单不会向用户显示更改……这意味着永远不会向用户显示“正在加载”消息。需要以下代码。

```
Form1.SuspendLayout();    
StatusBarMessageText.Text = "Loading Configuration Settings...";                
Form1.ResumeLayout();

LoadSettingsGridData();

Form1.SuspendLayout();    
StatusBarMessageText.Text = "Done";
Form1.ResumeLayout(); 
```

在 WPF 中处理这个基本问题的最佳实践是什么？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2010-08-01T17:30:29.437

最好和最简单的：

```
using(var d = Dispatcher.DisableProcessing())
{
    /* your work... Use dispacher.begininvoke... */
} 
```

或者

```
IDisposable d;

try
{
    d = Dispatcher.DisableProcessing();
    /* your work... Use dispacher.begininvoke... */
} finally {
    d.Dispose();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T00:55:59.013

在阅读 Shawn Wildermuth [WPF Threads: Build More Responsive Apps With The Dispatcher](http://msdn.microsoft.com/en-us/magazine/cc163328.aspx)的文章时。

我遇到了以下内容，其中指出您可以像在 WindowsForms 中一样使用后台工作人员。幻想：

> BackgroundWorker 现在您已经了解了 Dispatcher 的工作原理，您可能会惊讶地发现在大多数情况下您不会发现它有用。在 Windows Forms 2.0 中，Microsoft 引入了一个用于非 UI 线程处理的类，以简化用户界面开发人员的开发模型。此类称为 BackgroundWorker。图 7 显示了 BackgroundWorker 类的典型用法。
> 
> ### 图 7 在 WPF 中使用 BackgroundWorker
> 
> ```
> BackgroundWorker _backgroundWorker = new BackgroundWorker();
> 
> ...
> 
> // Set up the Background Worker Events
> _backgroundWorker.DoWork += _backgroundWorker_DoWork;
> backgroundWorker.RunWorkerCompleted += 
>     _backgroundWorker_RunWorkerCompleted;
> 
> // Run the Background Worker
> _backgroundWorker.RunWorkerAsync(5000);
> 
> ...
> 
> // Worker Method
> void _backgroundWorker_DoWork(object sender, DoWorkEventArgs e)
> {
>     // Do something
> }
> 
> // Completed Method
> void _backgroundWorker_RunWorkerCompleted(
>     object sender, 
>     RunWorkerCompletedEventArgs e)
> {
>     if (e.Cancelled)
>     {
>         statusText.Text = "Cancelled";
>     }
>     else if (e.Error != null) 
>     {
>         statusText.Text = "Exception Thrown";
>     }
>     else 
>     {
>         statusText.Text = "Completed";
>     }
> } 
> ```
> 
> BackgroundWorker 组件与 WPF 配合得很好，因为它在底层使用 AsyncOperationManager 类，而后者又使用 SynchronizationContext 类来处理同步。在 Windows 窗体中，AsyncOperationManager 传递派生自 SynchronizationContext 类的 WindowsFormsSynchronizationContext 类。同样，在 ASP.NET 中，它使用 SynchronizationContext 的不同派生，称为 AspNetSynchronizationContext。这些 SynchronizationContext 派生类知道如何处理方法调用的跨线程同步。
> 
> 在 WPF 中，此模型使用 DispatcherSynchronizationContext 类进行了扩展。通过使用 BackgroundWorker，Dispatcher 被自动用于调用跨线程方法调用。好消息是，由于您可能已经熟悉这种常见模式，您可以继续在新的 WPF 项目中使用 BackgroundWorker。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-09-17T13:32:18.423

The easiest way to get this to work is to add the LoadSettingsGridData to the dispatcher queue. If you set the operation's DispatcherPriority sufficiently low enough, the layout operations will occur, and you will be good to go.

```
StatusBarMessageText.Text = "Loading Configuration Settings...";
this.Dispatcher.BeginInvoke(new Action(LoadSettingsGridData), DispatcherPriority.Render);
this.Dispatcher.BeginInvoke(new Action(() => StatusBarMessageText.Text = "Done"), DispatcherPriority.Render); 
```

# sharepoint - 您可以在 SharePoint 2007 中修改哪些文件？

> ID：82850
> 
> 赞同：1
> 
> 时间：2008-09-17T12:57:49.330
> 
> 标签：sharepoint

我们可以修改哪些文件以使我们的解决方案仍受 Microsoft 支持？

是否允许自定义错误页面？我们可以修改 web.config 文件以使用自定义 HTTPHandlers 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T13:04:16.617

您当然可以为您的站点编辑 web.config 文件。但是，您应该注意的一件事是，当您开始在文件系统上手动编辑文件时，您必须记住在场中的所有服务器上手动进行这些更改（假设存在场）。除此之外，当您在 12 配置单元中编辑文件时，重要的是要了解您将对服务器上托管的所有 SharePoint 网站进行更改，这些网站是为其编辑文件的。

就个人而言，如果我要创建自定义错误页面，我只需将 <customErrors> 部分添加到我的 web.config 中。我避免**编辑**12 配置单元中的任何**现有**文件，但我**添加了**文件（尽管很少见）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T13:06:20.420

错误页面的定制不是很容易（或灵活）。你可以在这里看到一个例子：

[http://blogs.msdn.com/jingmeili/archive/2007/04/08/how-to-create-your-own-custom-404-error-page-and-handle-redirect-in-sharepoint-2007-苔藓.aspx](http://blogs.msdn.com/jingmeili/archive/2007/04/08/how-to-create-your-own-custom-404-error-page-and-handle-redirect-in-sharepoint-2007-moss.aspx)

web.config 可以更改。除了原始的HttpModules，我还使用了自己的HttpModules，但我没有使用自定义的HttpHandlers。如果您不更改原始处理程序（即，如果您为未由 SP 处理的特定类型的文件添加处理程序），IMO 它应该可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T13:30:40.080

不要修改 12 hive (Program Files\Common Files\Microsoft Shared\Web Server Extensions\12) 中的任何预安装文件...服务包可能会更新并覆盖任何更改。

内容数据库（母版页，~Catalogs 中的样式表列表）中的任何内容都可以修改（我会添加，而不是更新，以防服务包更改任何内容），因为它位于文件系统之上，并且立即可供任何成员使用的网络场（新添加的服务器）。

任何自定义功能，添加到 features 文件夹中的 12 配置单元，在 custom/non-microsoft 文件夹中（即，在 12\feature 文件夹中，不要修改任何预安装的文件，但随时为您的功能添加文件夹并在其中工作）。

可以使用 Visual Studio Extensions (VSeWSS) 开发自定义功能，目前可用于 Visual Studio 2005/2008... 好处是输出是一个功能包（.WSP 文件），旨在跨 SharePoint 移植。此外，.WSP 文件只是具有不同扩展名的 CAB 文件，提供了通过简单地重命名它们来探索的能力。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T00:07:57.660

对于站点定义，Microsoft 有一篇很好的文章，介绍了支持和不支持的内容。简而言之，您可以对开箱即用的站点定义进行的唯一更改是将 webtemp.xml 文件中的条目更改为隐藏，以防止站点定义出现在站点模板列表中。这可能是许多人感兴趣的事情。

当然，您也可以复制现有定义并重命名它们以创建新定义。

可以在此处找到使用自定义站点定义的支持和不支持方案的完整列表：

[http://support.microsoft.com/default.aspx?scid=kb;en-us;898631](http://support.microsoft.com/default.aspx?scid=kb;en-us;898631)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T09:14:40.720

这是我能找到的最接近微软官方回应的：

[http://technet.microsoft.com/en-us/library/cc263010.aspx](http://technet.microsoft.com/en-us/library/cc263010.aspx)

# unit-testing - 对象模拟是否被广泛使用？

> ID：82855
> 
> 赞同：6
> 
> 时间：2008-09-17T12:58:02.827
> 
> 标签：unit-testing, mocking

我很好奇你们中有多少人将对象模拟（JMock、NMock、RhinoMocks 等框架与单元测试框架携手并进）到您的日常开发过程中。你有什么经验？

你看，我在 GIS（地理信息系统）平台上进行开发，其中大部分工作都与某种处理数据的方式有关。由于它的数据对象模型相当复杂（许多类和接口，都是基于 COM 的），模拟起来也相当困难和麻烦。在这种情况下，模拟在编写测试套件时会产生大量开销。我想知道是否有类似情况的人，或者只是，嘲笑（在任何情况下）对你有什么作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-17T13:08:59.977

在我最近参与的一个项目中，我们在单元测试方法中广泛使用了模拟对象。该项目 100% 是 Java 并且规模适中（大约 100,000 行非注释代码）。它是一个基于 Swing 的桌面应用程序——我们发现测试用户界面逻辑的唯一有效方法是通过 MVC 变体设计，它允许我们使用模拟对象来替代实际的 Swing 用户界面类来进行自动化测试。我们还在数据访问层（Hibernate/DAO）的测试中广泛使用了模拟。

在用户界面使用中，Mocks 易于构建。并且应用程序的设计（Fowler Passive View）很容易合并模拟。对于用于测试数据访问层的模拟，情况并非如此。但我可以说，这显然是值得的。事实上，大部分的“努力”真正集中在提出一个可重用的解决方案，以最大限度地减少开发人员创建每个单独的模拟所必须做的工作。我建议您花时间深入研究并发现一种适合您情况的方法，让您可以轻松地模拟您的 GIS 数据层。那 - 或者只是手动模拟每个班级。无论哪种方式，运行依赖于模拟的自动化单元测试的能力都是值得的......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T13:01:27.093

在我的情况下，模拟工作**非常好。**但是我使用的是 Python，它是如此动态，以至于它使许多涉及测试的事情变得非常容易。

在像您这样的情况下，当应用程序主要是**数据驱动**时（据我所知），模拟可能没有那么有用。只需将数据传入并观察它的输出就足以进行测试。我只是确保应用程序**足够模块化**，因此这种方法可以应用于相当小的组件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T13:06:51.870

模拟在某种项目中很有用。但是，有时 mocking 非常耗时，而且 ROI 很低。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T13:09:01.833

尝试测试 Sharepoint 似乎只有模拟是唯一的方法，只有[typemock](http://www.typemock.com/)会让你模拟密封类。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T13:10:26.837

在我的例子中，模拟被广泛使用。模拟通常用于具有外部依赖关系的类，例如网络、数据库、文件系统。如果不使用模拟，任何这些都可能在测试中引入片状。

如果您发现由于要填充大量虚假数据而编写成本高昂的模拟，您可以将一些预先填充的数据对象设置为常量，并在测试中使用它们或稍作修改的副本。如果这样的数据对象具有外部依赖关系，那么也许可以以一种可以分离这两个关注点的方式对其进行重构。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-04T17:21:42.507

Dave Bouman 发起了一项倡议，试图建立一个 Mocks 社区库，用于 ArcObjects 相关的单元测试。他的博客和这个 svn 存储库包含与单元测试 GIS 系统相关的大量信息

[http://blog.davebouwman.net/CategoryView,category,Unit%2BTesting.aspx](http://blog.davebouwman.net/CategoryView,category,Unit%2BTesting.aspx)

[http://svn2.assembla.com/svn/arcdeveloper/TestingUtilities/trunk/](http://svn2.assembla.com/svn/arcdeveloper/TestingUtilities/trunk/)

# ms-office - 如何在 Word 2007 中创建自动修订历史记录表

> ID：82864
> 
> 赞同：7
> 
> 时间：2008-09-17T12:58:43.340
> 
> 标签：ms-office, word-2007

在 Word 2007 中是否可以使用跟踪更改或其他方法自动创建修订历史记录表？

例如

**修订记录**

DateVersionDescriptionAuthor 16/09/20081.0CreatedJohn Smith 17/09/20081.1修正了愚蠢的拼写错误Colin Jones

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T12:53:24.280

我认为不可能自动完成。

我建议您使用建议的表格手动跟踪，然后将所有文档保存在单独的文档分支下的版本控制系统中，以便拥有自动修订历史记录。如果您愿意，您还可以创建一个工具，将所述元素与文档的修订历史进行比较，如果您还没有更新它，就会对您大喊大叫 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-28T06:51:27.880

几天前我正在努力解决完全相同的问题，这真是一个意外。虽然我使用的方法是手动的，但它非常直观。

在审阅选项卡中有一个比较 word 2007 中的文档的选项。您可以选择生成仅包含更改的新文档。在第二个监视器上打开更改文档并手动合并更改。

您也可以转到打印并选择在新文档中打印标记（如果存在），但即使是最微不足道的更改也会生成一个新条目，因此很难了解更改的内容。

希望这可以帮助。

# asp.net - 如何动态创建 MaskedEditExtender？

> ID：82867
> 
> 赞同：1
> 
> 时间：2008-09-17T12:59:29.873
> 
> 标签：asp.net, maskededitextender

我想从代码隐藏中创建许多蒙面编辑扩展器。就像是：

```
private MaskedEditExtender m_maskedEditExtender;
protected override void OnLoad(EventArgs e)
{
    base.OnLoad(e);
    m_maskedEditExtender = new MaskedEditExtender()
    {
        BehaviorID = "clientName"
    };
    m_maskedEditExtender.Mask = "999999999";
    this.Controls.Add(m_maskedEditExtender);
}
protected override void Render(HtmlTextWriter writer)
{
    m_maskedEditExtender.RenderControl(writer);
} 
```

当我这样做时，我在 MaskedEditExtender 的 OnLoad 上收到 NullReferenceException。这样做的正确方法是什么？请注意，将扩展器放入类似中继器的控件中并使用 DataBind 对我不起作用。

**编辑：**我没有更新面板。原来我还需要在服务器端指定一个目标控件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T13:20:03.630

您的示例未提供 TargetControlID。

页面上有更新面板吗？我在动态创建扩展程序时遇到了问题，因为它们没有被添加到 updatePanel 内容中。

我还认为您必须对 ScriptManager 做一些事情（注册扩展器），但我可能弄错了（我目前无法访问我做动态扩展器的代码）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T13:24:57.597

如果这是在 Page 子类中，请参阅[ASP.NET 页面生命周期概述。](http://msdn.microsoft.com/en-us/library/ms178472.aspx)如果您向下滚动到事件列表，该页面会建议您使用 PreInit 事件来创建任何动态控件。有必要尽早这样做，以确保 ASP.NET 在正确的阶段干净地加载 ViewState，等等。

但是，如果您在 Web 用户控件或自定义控件中执行此操作，请覆盖 CreateChildControls 并在其中执行此操作。

如果没有帮助，请发布更完整的代码示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-16T14:51:25.423

为 MaskedEditExtender 提供正确的 TargetControlID 值

# php - PHP - RSS 生成器

> ID：82872
> 
> 赞同：2
> 
> 时间：2008-09-17T12:59:46.097
> 
> 标签：php, rss

我有一个旧网站，每次创建新帖子时都会生成自己的 RSS。当我在使用 PHP 4 的服务器上时一切正常，但现在主机更改为 PHP 5，我总是有一个“格式错误的 XML”。我正在使用 xml_parser_create() 和 xml_parse(...) 和 fwrite(..) 来保存所有内容。

这是保存时的示例（当然，我在保存之前阅读以附加旧的 RSS 行）。

```
function SaveXml()
{
    if (!is_file($this->getFileName()))
    {
        //Création du fichier
        $file_handler = fopen($this->getFileName(),"w");

        fwrite($file_handler,"");

        fclose($file_handler);
    }//Fin du if

    //Header xml version="1.0" encoding="utf-8"
    $strFileData = '<?xml version="1.0" encoding="iso-8859-1" ?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/"><channel><title>'.$this->getProjectName().'</title><link>http://www.mywebsite.com</link><description>My description</description><lastBuildDate>' . date("r"). '</lastBuildDate>';

    //Data
    reset($this->arrData);
    foreach($this->arrData as $i => $value)
    {
        $strFileData .= '<item>';
            $strFileData .= '<title>'. $this->GetNews($i,0) . '</title>';
            $strFileData .= '<pubDate>'. $this->GetNews($i,1) . '</pubDate>';
            $strFileData .= '<dc:creator>'. $this->GetNews($i,2) . '</dc:creator>';
            $strFileData .= '<description><![CDATA['. $this->GetNews($i,3) . ']]> </description>';
            $strFileData .= '<link><![CDATA['. $this->GetNews($i,4) . ']]></link>';
            $strFileData .= '<guid>'. $this->GetNews($i,4) . '</guid>';
            //$strFileData .= '<category>'. $this->GetNews($i,5) . '</category>';
            $strFileData .= '<category>Mycategory</category>';
        $strFileData .= '</item>';

    }//Fin du for i

    $strFileData .= '</channel></rss>';

    if (file_exists($this->getFileName()))//Détruit le fichier
        unlink($this->getFileName());

    $file_handler = fopen($this->getFileName(),"w");

    fwrite($file_handler,$strFileData);

    fclose($file_handler);
}//Fin de SaveXml 
```

我的问题是：你如何在 PHP 中创建和填写你的 RSS？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T13:02:09.773

我将使用[simpleXML](http://www.php.net/simplexml)创建所需的结构并导出 XML。然后我会用 file_put_contents() 将它缓存到磁盘。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T15:37:50.150

在 swcombine.com，我们使用[Feedcreator](http://feedcreator.org/)。使用那个，你的问题就会消失。:)

这是安装后使用它的 PHP 代码：

```
function feed_simnews() {
    $objRSS = new UniversalFeedCreator();
    $objRSS->title = 'My News';
    $objRSS->link = 'http://link.to/news.php';
    $objRSS->description = 'daily news from me';
    $objRSS->xsl = 'http://link.to/feeds/feedxsl.xsl';
    $objRSS->language = 'en';
    $objRSS->copyright = 'Copyright: Mine!';
    $objRSS->webmaster = 'webmaster@somewhere.com';
    $objRSS->syndicationURL = 'http://link.to/news/simnews.php';
    $objRSS->ttl = 180;

    $objImage = new FeedImage();
    $objImage->title = 'my logo';
    $objImage->url = 'http://link.to/feeds/logo.jpg';
    $objImage->link = 'http://link.to';
    $objImage->description = 'Feed provided by link.to. Click to visit.';
    $objImage->width = 120;
    $objImage->height = 60;
    $objRSS->image = $objImage;

    //Function retrieving an array of your news from date start to last week
    $colNews = getYourNews(array('start_date' => 'Last week'));

    foreach($colNews as $p) {
        $objItem = new FeedItem();
        $objItem->title = $p->title;
        $objItem->description = $p->body;
        $objItem->link = $p->link;
        $objItem->date = $p->date;
        $objItem->author = $p->author;
        $objItem->guid = $p->guid;

        $objRSS->addItem($objItem);
    }

    $objRSS->saveFeed('RSS2.0', 'http://link.to/feeds/news.xml', false);
}; 
```

相当亲吻。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T13:03:12.593

我过去曾使用过[这个 LGPL 许可的 feedcreator 类](http://www.bitfolge.de/rsscreator-en.html)，它非常适合我非常简单的使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T13:03:23.703

PHP5 现在带有`SimpleXML`扩展，如果您的需求不复杂，它是构建有效 XML 的一种非常快速的方法。

但是，您建议的问题似乎不是实现问题，而是语法问题。也许您可以使用代码示例或生成的 XML 副本来更新您的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T13:06:32.913

不是完整的答案，但您**不必解析**自己的 XML。它会损害性能和可靠性。

但一定要确保它**格式**正确。如果您手动生成它或使用通用工具生成它应该不会很难。或者也许你包含的 HTML 毁了它？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T15:05:06.983

有很多事情会导致 XML 格式错误。这可能是字符实体的问题（XML 标记之间的数据中的“<”、“>”或“&”）。连接字符串时，尝试通过 htmlentities() 运行数据库的任何输出。您是否有一个生成的 XML 示例供我们查看，以便我们了解问题出在哪里？

# sql - 如何列出使用 ATTACH 打开的 SQLite 数据库文件中的表？

> ID：82875
> 
> 赞同：1296
> 
> 时间：2008-09-17T12:59:53.633
> 
> 标签：sql, database, sqlite, metadata

什么 SQL 可用于列出表，以及 SQLite 数据库文件中这些表中的行 - 一旦我使用`ATTACH`SQLite 3 命令行工具上的命令附加它？

* * *

## 回答 #1

> 赞同：1326
> 
> 时间：2008-09-17T13:02:51.940

有几个步骤可以查看 SQLite 数据库中的表：

1.  列出数据库中的表：

    ```
    .tables 
    ```

2.  列出表格的外观：

    ```
    .schema tablename 
    ```

3.  打印整个表格：

    ```
    SELECT * FROM tablename; 
    ```

4.  列出所有可用的 SQLite 提示命令：

    ```
    .help 
    ```

* * *

## 回答 #2

> 赞同：649
> 
> 时间：2008-09-17T13:30:00.113

,`.tables`和`.schema`"helper" 函数不查看 ATTACHed 数据库：它们只是查询`SQLITE_MASTER`表中的 "main" 数据库。因此，如果您使用

```
ATTACH some_file.db AS my_db; 
```

那么你需要做

```
SELECT name FROM my_db.sqlite_master WHERE type='table'; 
```

请注意，临时表都不会显示`.tables`：您必须为此列出`sqlite_temp_master`：

```
SELECT name FROM sqlite_temp_master WHERE type='table'; 
```

* * *

## 回答 #3

> 赞同：453
> 
> 时间：2008-09-17T13:01:48.433

看来您需要通过**sqlite_master**表，如下所示：

```
SELECT * FROM dbname.sqlite_master WHERE type='table'; 
```

然后用 a 或类似的方法手动遍历每个表`SELECT`以查看行。

`.DUMP`and`.SCHEMA`命令似乎根本看不到数据库。

* * *

## 回答 #4

> 赞同：180
> 
> 时间：2008-09-17T13:06:03.743

要显示所有表格，请使用

```
SELECT name FROM sqlite_master WHERE type = "table" 
```

要显示所有行，我想您可以遍历所有表，然后对每个表执行 SELECT *。但也许 DUMP 是你所追求的？

* * *

## 回答 #5

> 赞同：73
> 
> 时间：2011-08-31T04:13:29.280

用于`.help`检查可用命令。

```
.table 
```

此命令将显示当前数据库下的所有表。

* * *

## 回答 #6

> 赞同：46
> 
> 时间：2008-09-17T13:06:30.870

SQLite 命令行上有一个可用的命令：

```
.tables ?PATTERN?      List names of tables matching a LIKE pattern 
```

转换为以下 SQL：

```
SELECT name FROM sqlite_master
WHERE type IN ('table','view') AND name NOT LIKE 'sqlite_%'
UNION ALL
SELECT name FROM sqlite_temp_master
WHERE type IN ('table','view')
ORDER BY 1 
```

* * *

## 回答 #7

> 赞同：39
> 
> 时间：2008-09-17T13:04:57.443

要列出表格，您还可以执行以下操作：

```
SELECT name FROM sqlite_master
WHERE type='table'; 
```

* * *

## 回答 #8

> 赞同：34
> 
> 时间：2010-06-07T02:53:42.683

试试`PRAGMA table_info(table-name);`
[http://www.sqlite.org/pragma.html#schema](http://www.sqlite.org/pragma.html#schema)

* * *

## 回答 #9

> 赞同：31
> 
> 时间：2015-08-01T15:13:04.030

我使用此查询来获取它：

```
SELECT name FROM sqlite_master WHERE type='table' 
```

并在 iOS 中使用：

```
NSString *aStrQuery=[NSString stringWithFormat:@"SELECT name FROM sqlite_master WHERE type='table'"]; 
```

* * *

## 回答 #10

> 赞同：19
> 
> 时间：2013-01-31T10:47:09.397

根据[文档](http://www.sqlite.org/sqlite.html)，相当于 MySQL 的`SHOW TABLES;`是：

> “.tables”命令类似于设置列表模式然后执行以下查询：

```
SELECT name FROM sqlite_master
  WHERE type IN ('table','view') AND name NOT LIKE 'sqlite_%'
UNION ALL
SELECT name FROM sqlite_temp_master
  WHERE type IN ('table','view')
ORDER BY 1; 
```

但是，如果您要检查是否存在单个表（或获取其详细信息），请参阅[LuizGeron 的答案](https://stackoverflow.com/a/2986841/89771)。

* * *

## 回答 #11

> 赞同：16
> 
> 时间：2014-09-08T23:59:25.683

从 SQLite 3 的最新版本开始，您可以发出：

```
.fullschema 
```

查看您的所有创建语句。

* * *

## 回答 #12

> 赞同：12
> 
> 时间：2009-01-30T06:19:48.710

最简单的方法是直接打开数据库并使用`.dump`命令，而不是在调用 SQLite 3 shell 工具后附加它。

所以...（假设您的操作系统命令行提示符是 $）而不是`$sqlite3`：

```
sqlite3> ATTACH database.sqlite as "attached" 
```

从您的操作系统命令行，直接打开数据库：

```
$sqlite3 database.sqlite
sqlite3> .dump 
```

* * *

## 回答 #13

> 赞同：11
> 
> 时间：2016-10-13T21:48:00.580

通过 a `union all`，将所有表合并到一个列表中。

```
select name
from sqlite_master 
where type='table'

union all 

select name 
from sqlite_temp_master 
where type='table' 
```

* * *

## 回答 #14

> 赞同：10
> 
> 时间：2015-10-13T08:07:11.060

采用：

```
import sqlite3

TABLE_LIST_QUERY = "SELECT * FROM sqlite_master where type='table'" 
```

* * *

## 回答 #15

> 赞同：8
> 
> 时间：2015-04-02T21:24:51.820

由于没有人提到 SQLite 的官方参考，我认为在此标题下参考它可能会很有用：

[https://www.sqlite.org/cli.html](https://www.sqlite.org/cli.html)

您可以使用此链接中描述的命令来操作数据库。此外，**如果您使用的是 Windows 操作系统**并且不知道命令 shell 在哪里，那就是在 SQLite 的站点中：

[https://www.sqlite.org/download.html](https://www.sqlite.org/download.html)

下载完成后，**点击 sqlite3.exe 文件初始化 SQLite 命令外壳**。初始化时，默认情况下，此 SQLite 会话使用内存数据库，而不是磁盘上的文件，因此会话退出时所有更改都将丢失。要将永久磁盘文件用作数据库，请在终端窗口启动后立即输入“.open ex1.db”命令。

上面的示例导致名为“ex1.db”的数据库文件被打开和使用，如果它以前不存在，则创建它。您可能希望使用完整路径名来确保文件位于您认为它所在的目录中。使用正斜杠作为目录分隔符。换句话说，使用“c:/work/ex1.db”，而不是“c:\work\ex1.db”。

要查看您之前选择的数据库中的所有表，请键入命令**.tables**，如上述链接中所述。

如果您在 Windows 中工作，我认为将这个 sqlite.exe 文件移动到与其他 Python 文件相同的文件夹可能会很有用。这样，写入的 Python 文件和从 .db 文件读取的 SQLite shell 位于同一路径中。

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2008-09-17T13:05:20.203

“.schema”突击队将通过向您显示用于创建所述表的语句来列出可用表及其行：

```
sqlite> create table_a (id int, a int, b int);
sqlite> .schema table_a
CREATE TABLE table_a (id int, a int, b int);

```

* * *

## 回答 #17

> 赞同：6
> 
> 时间：2017-11-12T10:04:56.950

使用*.da*查看所有数据库 - 一个称为“ **main** ”。

该数据库的表可以通过以下方式查看：

```
SELECT distinct tbl_name from sqlite_master order by 1; 
```

附加的数据库需要您在 ATTACH 语句中使用 AS 选择的前缀，例如**aa** (, bb, cc...) 所以：

```
SELECT distinct tbl_name from **aa.sqlite_master** order by 1; 
```

请注意，在这里您也可以获得视图。要排除这些添加：

```
where type = 'table' 
```

在“订单”之前

# asp.net - 有没有人使用 Iron speed Designer 进行快速的 asp.net 开发？

> ID：82878
> 
> 赞同：5
> 
> 时间：2008-09-17T13:00:28.280
> 
> 标签：asp.net, gui-designer, ironspeed

Visual Studio 相当不错，但不会自动创建存储过程。Iron Speed 设计师应该是这样做的。但这有什么好处吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-21T20:44:47.013

在过去的两年中，我在大多数 ASP.NET 表单数据项目中都广泛使用了 Ironspeed。

有用。做好几件事：存储过程，表格浏览和 CRUD 屏幕的快速布局，单记录 CRUD 屏幕的快速布局。它体面地管理往返（或半往返）过程，检测后端数据库架构中的更改并更新其数据访问层，然后使更改的列可供您更改 UI（在记录或表控制面板中） ）。ISD（正如他们所说的那样）在使您的应用程序的安全管理变得非常轻松方面做得非常出色，甚至可以达到控制级别（如果您使用 ISD 的 asp.net 控件的子类版本）。最后一个不小的优点是基于 CSS 的主题控件（易于更改为各种主题，易于自定义特定主题，甚至通过分叉您喜欢的现有主题来构建自己的主题变体也不错）。

相当活跃的论坛，拥有一群乐于助人的核心贡献者。您可能可以通过论坛避免付费技术支持。

好吧，缺点。创建相当大的代码组合，是一个三层架构。正如 Galwegian 所说，就像任何框架一样，您已经戴上了天鹅绒手铐（如果您正在考虑代码限制和约定以外的任何事情，请让您的思绪摆脱困境！）。天鹅绒手铐是页面和控制模型、数据层、本身缺乏业务对象/类功能、回发模型以及使您的用户 GUI 看起来像他们的用户 GUI 的诱惑，因为它开箱即用如此简单方便。

ISD 通过组合 HTML 模板（在其中放置 ISD 特定代码生成标签和任何其他标签等，您使用 ISD GUI 或手动）来构建基本页面。页面模型依赖于从一段代码模板创建的页面背后的代码。基类几乎是完全可重写的，因此您可以重写所有默认函数、重新生成应用程序而不会丢失您的重写。数据库控件位于页面容器中，但在特定的 /app_code 文件中有自己的类定义（即，它们的代码隐藏）。同样，每种控件类型都有自己的基类，其中包含完全可重写的方法。单个记录控件（显示单个 db 记录）非常简单。一张表，显示多条记录，有一个表类和一个表行类。ISD 网站 (www.ironspeed.

那么，这个模型的问题在哪里呢？1\. 使用开箱即用的 GUI 轻松而诱人。将 ISD 指向您的数据库，选择您希望将其转换为页面的表格，告诉它页面的种类，给它一个主题样式，五分钟后您就可以查看该应用程序了。凉爽的。但是，很容易忘记他们的用户 GUI 可能不是您的用户想要看到的。因此，请准备好自己思考并修补由此创建的 GUI。不难做到，您可以使用 VS 2005 来帮助您。

2.  业务对象。您可以将自己的业务对象放在一起，但这会很困难，而且您不会从 ISD 获得任何帮助。ISD 做了很多简单的验证和检查（适当的查找值、范围、长度等）的构建。ISD 允许您构建自定义查询，但这些是只读的。它足够聪明（并且您可以在任何情况下覆盖从页面写入），让您进行一对多视图并将其写回数据库（您可能会覆盖默认的基本方法，但它不是很难做到）。然而，当你开始认真检查依赖关系时，ISD 仍然是关于表而不是业务对象。所以，你要写一些代码。

如果你很聪明，你会在将它存储在 app_code 某处后编写它，并通过从表或记录控件中的重写方法调用它来使用它。如果您像我们大多数人一样，您将首先将其放入上述代码隐藏类之一，然后忘记您这样做，或者在处理客户数据的 10 个页面中的每个页面中都有一个副本。在我的世界里，这通常意味着 5 个相同的功能和 5 个完全不同的功能（即使它们都应该是相同的）。ISD 让人很想订购 marinara，因为该模型适合意大利面条式代码。当然，您可以完全避免这种情况，但您必须学习 ISD 模型以确定在您的项目中执行此操作的最佳方法。

3.  页面状态和回发。尽管 ISD 对这个问题非常开放，并告诉用户不要只在回发流中默认返回整个 asp.net 页面状态（而不是在服务器上缓存），但默认是返回整个页面。可以制作一些大页面。这使用户认为 SLO W。正如我所说，您可以操纵它。但是，当只需要指向、点击和繁荣时，新手会得到什么 - 即时应用程序。您的经理现在不在您身边，因为她的产品库存表是“在网络上”，带有很酷的搜索和编辑 GUI（如果您有点发疯并且刚刚采用 ISD 的默认行为，则为 400kb 状态页面）。内部很棒，但现实世界中的客户......

再次，知识是关键。你可以解决这个问题，但你需要知道你应该。

4.  数据库读/写回发。这里没什么大问题，但你也需要知道模型是只获取当前使用的数据。如果您的表以 50 条记录增量显示 1000 条记录，那么当您从记录 1 到 50 再到 51 到 100 时，您将回发并再次访问数据库。这使数据保持最新，但增加了服务器流量。

总体：试试演示版。将它指向您真正想要将其转换为 asp.net 应用程序的简单事物。建立可能三个表。然后以上述为指导对其进行剖析。看看你的想法，然后回复这个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T13:08:40.523

为了方便一个非常小的项目，我使用它。它完成了我想要的，并为我节省了几天的工作时间。

我发现的主要问题是在自定义或扩展生成的项目时。你必须花相当多的时间来理解 Ironspeed 的做事方式，我承认，这不是我的方式。

如果我事先知道以后不必再定制它，我会再次将它用于一个小项目。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T17:32:54.647

如果您只需要生成存储过程，那么 CodeSmith 是一个不错的选择，其成本仅为 IronSpeed 的一小部分。有几个可用的 sproc 模板，如果需要，您可以创建自己的模板或调整现有模板。您还可以使用 CodeSmith 生成 .Net 代码，让您心满意足。为此已经存在大量的商务舱模板。

IronSpeed 的价值不在于存储过程的生成，而在于 RAD 功能。我同意@Galwegian ... IronSpeed 适用于模型或非常简单的应用程序，如果您需要进行*任何*自定义，则根本不是那么好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-24T16:53:50.743

您可能想查看 Evolutility CRUD 框架。它提供了一些相同的功能（仅限于 CRUD）并且是开源的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-08-31T09:10:29.277

IronSpeed 在帮助我开发数据驱动的企业 Intranet 应用程序方面表现出色（开箱即用）。虽然代码模型需要一点时间来适应，但它可以有效地维护一个漂亮的三层应用程序。虽然与 2010 年的网页设计相比，页面模板看起来很花哨，但当您需要功能而不是形式时，它可以完成工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-03-21T17:00:23.810

Iron Speed Designer 非常适合简单的 CRUD 类型的 Web 应用程序。您可以在我们的网站[http://www.dotnetarchitect.co.uk/上找到一些有用的信息](http://www.dotnetarchitect.co.uk/)

# c# - 在 C# .NET 2.0 中，反向执行 foreach 的简单方法是什么？

> ID：82881
> 
> 赞同：17
> 
> 时间：2008-09-17T13:00:40.667
> 
> 标签：c#, .net, collections, iteration

假设我有一个 Dictionary 对象：

```
Dictionary myDictionary<int, SomeObject> = new Dictionary<string, SomeObject>(); 
```

现在我想以相反的顺序遍历字典。我不能使用简单的 for 循环，因为我不知道字典的键。*foreach*很简单：

```
foreach (SomeObject object in myDictionary.Values)
{
    // Do stuff to object
} 
```

但是我怎样才能反过来执行呢？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-09-17T13:02:20.647

字典或任何其他形式的哈希表没有排序。所以你试图做的是没有意义的:)

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-09-17T13:17:01.097

我会使用 SortedList 而不是字典。您仍然可以通过 Key 访问它，但您也可以通过索引访问它。

```
SortedList sCol = new SortedList();

sCol.Add("bee", "Some extended string matching bee");
sCol.Add("ay", "value matching ay");
sCol.Add("cee", "Just a standard cee");

// Go through it backwards.
for (int i = sCol.Count - 1; i >=0 ; i--)
    Console.WriteLine("sCol[" + i.ToString() + "] = " + sCol.GetByIndex(i));

// Reference By Key
foreach (string i in sCol.Keys)
    Console.WriteLine("sCol[" + i + "] = " + sCol[i]);

// Enumerate all values
foreach (string i in sCol.Values)
    Console.WriteLine(i); 
```

值得注意的是，排序列表仅存储按键排序的键/值对。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-09-17T13:05:53.103

如果您有**.NET 3.5**，则可以在 IEnumerables 上使用 .Reverse() 扩展方法。例如：

```
foreach (object o in myDictionary.Values.Reverse())
{
     // Do stuff to object
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-17T13:24:09.550

实际上，在 C# 2.0 中，您可以创建自己的迭代器来反向遍历容器。然后，您可以在 foreach 语句中使用该迭代器。但是您的迭代器首先必须有一种导航容器的方法。如果它是一个简单的数组，它可以像这样倒退：

```
static IEnumerable<T> CreateReverseIterator<T>(IList<T> list)
{
    int count = list.Count;
    for (int i = count - 1; i >= 0; --i)
    {
        yield return list[i];
    }
} 
```

但是当然你不能用 Dictionary 来做到这一点，因为它没有实现 IList 或提供索引器。说字典没有顺序是不正确的：它当然有顺序。如果您知道它是什么，该命令甚至会很有用。

对于您的问题的解决方案：我会说将元素复制到数组中，然后使用上述方法反向遍历它。像这样：

```
static void Main(string[] args)
{
    Dictionary<int, string> dict = new Dictionary<int, string>();

    dict[1] = "value1";
    dict[2] = "value2";
    dict[3] = "value3";

    foreach (KeyValuePair<int, string> item in dict)
    {
        Console.WriteLine("Key : {0}, Value: {1}", new object[] { item.Key, item.Value });
    }

    string[] values = new string[dict.Values.Count];
    dict.Values.CopyTo(values, 0);

    foreach (string value in CreateReverseIterator(values))
    {
        Console.WriteLine("Value: {0}", value);
    }

} 
```

将值复制到数组中似乎是个坏主意，但根据值的类型，它并不是那么糟糕。您可能只是在复制参考！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-17T13:09:43.313

我同意@leppie 的观点，但认为你应该得到这个问题的一般答案。可能是您的意思是一般问题，但意外选择了错误的数据结构。字典中值的顺序应该被认为是特定于实现的；根据文档，它始终与键的顺序相同，但此顺序也未指定。

无论如何，没有一种简单的方法可以`foreach`反过来进行工作。使用类的枚举器是语法糖，枚举器只能在一个方向移动。从技术上讲，答案可能是“反转集合，然后枚举”，但我认为这是一种你只需要使用“向后”for循环的情况：

```
for (int i = myCollection.Length - 1; i >= 0; i--)
{
    // do something
}
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-17T14:14:52.377

如果您没有 .NET 3.5 和 Reverse 扩展方法，您可以实现自己的。我猜它可能会生成一个中间列表（必要时）并反向迭代它，如下所示：

```
public static IEnumerable<T> Reverse<T>(IEnumerable<T> items)
{
    IList<T> list = items as IList<T>;
    if (list == null) list = new List<T>(items);
    for (int i = list.Count - 1; i >= 0; i-- )
    {
        yield return list[i];
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-17T13:05:45.960

那将是 a `Dictionary<int, SomeObject> myDictionary`，您可以通过以下方式进行：

```
foreach(SomeObject _object in myDictionary.Values.Reverse())
{
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-17T13:06:08.827

**在.NET 2.0**中我能想到的唯一方法是首先将所有值复制到一个列表中，反转该列表，然后在该列表上运行 foreach：

```
Dictionary<int, object> d;
List<object> tmplist;
foreach (object o in d.Values) tmplist.Add(s);
tmplist.Reverse();
foreach (object o in tmplist) {
    //Do stuff
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-17T13:54:52.127

字面答案：

```
Dictionary<int, SomeObject>  myDictionary = new Dictionary<int, SomeObject>();

foreach (var pair in myDictionary.OrderByDescending(i => i.Key))
{
    //Observe pair.Key
    //Do stuff to pair.Value
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-17T13:05:52.637

如果排序是最重要的，您可以使用 Stack 并创建一个简单的结构来存储您的 int、Object 对。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-17T13:13:10.887

如果你想要一个字典类型的集合，但你需要维护插入顺序，你可以在 [这里查看 KeyedCollection](http://msdn.microsoft.com/en-us/library/ms132438.aspx)

它是字典和列表的合并。这样您就可以通过键或插入索引访问集合中的元素。

唯一的问题是存储在集合中的元素是否必须有一个 int 键。如果您可以将其更改为字符串或其他类型（Guid Mabye）。由于集合[1](http://msdn.microsoft.com/en-us/library/ms132438.aspx)将搜索 1 的键而不是 1 的索引。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-17T13:15:58.523

一个标准的`for`循环将是最好的。您不必担心反转集合的处理开销。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-17T13:42:39.567

您可以使用[LinqBridge](http://www.albahari.com/nutshell/linqbridge.html)在 .NET 2.0 中使用[LINQ to Objects](http://en.wikipedia.org/wiki/Language_Integrated_Query#LINQ_to_Objects) Enumerable.Reverse() 函数。

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2012-09-01T03:54:16.940

```
foreach (Sample in Samples)

try the following:

Int32 nEndingSample = Samples.Count - 1;

for (i = nEndingSample; i >= 0; i--)
{
     x = Samples[i].x;
     y = Samples[i].y;
} 
```

# sql - 存储过程或 OR 映射器？

> ID：82882
> 
> 赞同：3
> 
> 时间：2008-09-17T13:00:51.947
> 
> 标签：sql, stored-procedures

哪个更好？或者使用和或映射器与 SP 的？如果您已经有一个带有 SP 的系统，那么 OR 映射器值得吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-17T13:05:58.423

我喜欢 ORM，因为您不必重新发明轮子。话虽如此，这完全取决于您的应用程序需求、开发风格和团队的风格。

这个问题已经讨论过了[为什么 NHibernate 生成参数化 SQL 的速度和存储过程一样快？](https://stackoverflow.com/questions/50346/why-is-parameterized-sql-generated-by-nhibernate-just-as-fast-as-a-stored-proce)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-17T15:52:22.923

存储过程没什么好说的。10 年前有必要，但使用存储过程的每一个好处都不再有效。两个最常见的论点是关于安全性和性能。“通过网络发送东西”的废话也不成立，我当然可以动态地创建一个查询来完成服务器上的所有事情。sproc 支持者不会告诉您的一件事是，如果您在合并发布上使用列冲突解决方案，它会使更新变得不可能。只有自认为是数据库霸主的 DBA 才会坚持使用存储过程，因为它使他们的工作看起来比实际更令人印象深刻。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-17T13:13:15.770

这已在前面的问题中详细讨论过。

[将 SQL 保存在存储过程与代码中的优缺点是什么](https://stackoverflow.com/questions/15142/what-are-the-pros-and-cons-to-keeping-sql-in-stored-procs-versus-code#15153)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-17T15:09:48.220

在我的工作中，我们主要做业务线应用程序——合同工作。

对于这种类型的业务，我是 ORM 的忠实粉丝。大约四年前（当时 ORM 工具还不太成熟），我们研究了 CSLA 并推出了我们自己的简化 ORM 工具，我们在大多数应用程序中都使用了该工具，包括一些拥有 100 多个表的企业级系统。

我们估计这种方法（当然包括大量代码生成）在我们的项目中可以节省高达 30% 的时间。说真的，这很荒谬。

有一个小的性能折衷，但只要您对软件开发有充分的了解，它就无关紧要。总是有例外需要灵活性。

例如，如果可能，仍应在专门的存储过程中处理极其数据密集的批处理操作。如果您可以在数据库上的存储过程中完成，您可能不想通过网络发送 100,000 条巨大的记录。

这是新手开发人员无论是否使用 ORM 都会遇到的问题类型。他们只需要看到结果，如果他们有能力，他们就会得到它。

我们在 Web 应用程序中看到的是，通常最难解决的性能瓶颈不再与数据库相关，即使使用 ORM 也是如此。相反，由于带宽、AJAX 开销等原因，它们位于前端（浏览器）。如今，即使是中端数据库服务器也非常强大。

当然，其他在更大的高需求系统上工作的商店可能会有不同的体验。:)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-17T13:06:57.063

存储过程不言自明。或映射器是特定于语言的，并且经常添加图形减速。

存储过程意味着您不受语言界面的限制，您只需以向前兼容的方式添加到数据库的新界面。

我个人对 OR Mappers 的看法是，它们的存在凸显了流行的数据库结构中的一个设计缺陷。数据库开发人员应该意识到人们试图通过复杂的 OR-Mapper 完成的任务，并创建有助于执行此任务的服务器端实用程序。

OR Mappers 也是“泄漏抽象”综合症的史诗目标（[Joel On Software: Leaky Abstractions](http://www.joelonsoftware.com/articles/LeakyAbstractions.html)）

由于抽象层不是通灵的，因此很容易找到它无法处理的东西。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-17T13:06:09.310

在我看来，存储过程更好，因为它们可以具有独立于基础表的安全配置。

这意味着您可以允许特定操作，而不会允许对特定表进行写入/读取。它还限制了人们在发现 SQL 注入漏洞时可能造成的损害。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-17T13:08:59.913

绝对**是 ORM**。更灵活、更便携（通常它们倾向于内置便携性）。如果速度很慢，您可能希望在热点中使用缓存或手动调整的 SQL。

通常，存储过程在可维护性方面存在几个问题。

*   与应用程序分开（现在必须在两个地方进行很多更改）
*   通常更难改变
*   更难置于版本控制之下
*   更难确保它们已更新（部署问题）
*   便携性（已经提到）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T13:03:44.077

我个人发现 SP 在性能方面往往更快，至少对于我定期执行的大型数据项而言。但我知道很多人对 OR 工具发誓，不会做任何其他事情。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-17T13:06:53.693

我认为使用 OR 映射器将提高应用程序源代码的可读性和可维护性，而使用 SP 将提高应用程序的性能。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-17T13:07:30.853

它们实际上并不相互排斥，尽管就您而言，它们通常是相互排斥的。

使用对象关系映射的优点是您可以交换数据源。不仅是数据库结构，您还可以使用任何数据源。随着 Web 服务/面向服务的体系结构/ESB 的出现，在大型公司中，考虑拥有比存储过程中更高级别的关注点分离是明智的。但是，在较小的公司和永远不会使用不同数据源的应用程序中，SP 可以很好地满足要求。最后一点，没有必要使用 OR 映射器来获得抽象。我以前的团队通过简单地使用使用 Spring.NET 的适配器模型插入数据源而取得了巨大的成功。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-17T13:17:58.410

@肯特弗雷德里克

> 我个人对 OR Mappers 的看法是，它们的存在凸显了流行的数据库结构中的一个设计缺陷”

我认为您在谈论关系模型和面向对象模型之间的区别。这实际上是我们需要 ORM 的原因，但这些模型的实现是故意完成的——它不是设计流程——它只是历史上的结果。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-17T13:18:49.860

使用已确定性能瓶颈的存储过程。如果你还没有发现瓶颈，你在做什么过早的优化？
在您关心对特定表的安全访问时使用存储过程。
如果您有一个 SQL 向导，他准备坐下来编写复杂的查询，这些查询将遗留数据库中的大量表连接在一起，请使用存储过程，以完成 OR 映射器中难以完成的事情。

对数据库的其他（至少）80% 使用 OR 映射器：选择和更新是如此例行，以至于仅通过存储过程进行访问是手动编码中毫无意义的练习，并且更新如此罕见以至于没有性能成本。使用 OR 映射器来自动化简单的事情。

大多数 OR 映射器可以与存储的过程进行通信以完成其余的工作。

你不应该使用存储过程，假设它们比字符串中的 sql 语句更快，这在 MS SQL 服务器的最后几个版本中不一定是这种情况。

您不需要使用存储过程来阻止 SQL 注入攻击，还有其他方法可以确保您的查询参数是强类型的，而不仅仅是字符串连接。

您不需要使用 OR 映射器来获取 POCO 域模型，但它确实有帮助。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-17T13:27:03.910

如果您已经有一个作为存储过程公开的数据 API，那么您需要证明对 ORM 进行重大架构改革是合理的。

对于绿地构建，我会评估几件事：

1.  如果团队中有专门的 DBA，我会倾向于 sprocs
2.  如果有多个应用程序接触同一个数据库，我会倾向于使用 sprocs
3.  如果永远不可能进行数据库迁移，我会倾向于使用 sprocs
4.  如果我想在数据库中实现 MVCC，我会倾向于 sprocs
5.  如果我将其部署为可能具有多个后端数据库（MySql、MSSql、Oracle）的产品，我会倾向于 ORM
6.  如果我的时间紧迫，我会倾向于 ORM，因为它是一种更快的方式来创建我的域模型并使其与数据模型保持同步（使用适当的工具）。
7.  如果我以多种方式（Web 应用程序、Web 服务、RIA 客户端）公开相同的域模型，我将倾向于 ORM，因为然后数据模型隐藏在我的 ORM 外观后面，使健壮的域模型更有价值我。

我认为性能有点像红鲱鱼。hibernate 的性能似乎几乎与手动编码的 SQL 一样好或更好（由于它的缓存层），并且很容易在存储过程中编写错误的查询。

最重要的标准可能是团队的技能和长期的数据库可移植性需求。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-17T13:28:31.583

那么SP已经在那里了。真的能做到这些是没有意义的。我想将映射器与 SP 一起使用是否有意义？

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-17T13:32:25.833

“我正试图钉钉子。我应该用鞋跟还是玻璃瓶？”

存储过程和 ORM 对开发人员（尽管不一定分别对 DBA 或架构师而言）来说使用起来既困难又烦人，因为它们会产生启动成本和更高的维护成本，而这并不能保证得到回报。

如果期望在系统的生命周期内需求不会发生太大变化，那么两者都会得到很好的回报，但是如果您构建系统以首先发现需求，它们就会妨碍您。

像 LINQ 和 ActiveRecord 这样的直接编码 SQL 或准 ORM 更适合构建到发现项目（企业中发生的项目比 PR 希望你想象的要多得多）。

存储过程在与语言无关的环境或需要对权限进行细粒度控制的环境中效果更好。如果您的 DBA 比您的程序员更好地掌握需求，它们也会更好。

如果您预先进行大设计，使用大量 UML，想要抽象数据库后端，并且您的架构师比您的 DBA 或程序员更好地掌握需求，那么成熟的 ORM 会更好。

然后是选项#4：使用所有这些。整个系统通常不仅仅是一个程序，虽然许多程序可能与同一个数据库通信，但它们都可以使用适合程序特定任务和成熟度级别的任何方法。也就是说：您从直接编码的 SQL 或 LINQ 开始，然后通过在 ORM 和存储过程中重构您认为它们有意义的地方来使程序成熟。

# c# - CausesValidation 设置为“False”，但客户端验证仍在触发

> ID：82908
> 
> 赞同：1
> 
> 时间：2008-09-17T13:03:41.643
> 
> 标签：c#, asp.net, javascript, validation

我在 ASP.NET 1.1 Web 应用程序中有几个RequiredFieldValidators，当我按下取消按钮时，它们会在客户端触发，它的 CausesValidation 属性设置为“False”。我怎样才能让它停止？

我认为 1.1 不支持验证组。

这是一个代码示例：

```
<asp:TextBox id="UsernameTextBox" runat="server"></asp:TextBox>
<br />
<asp:RequiredFieldValidator ID="UsernameTextBoxRequiredfieldvalidator" ControlToValidate="UsernameTextBox" 
runat="server" ErrorMessage="This field is required."></asp:RequiredFieldValidator>
<asp:RegularExpressionValidator ID="UsernameTextBoxRegExValidator" runat="server" ControlToValidate="UsernameTextBox"
Display="Dynamic" ErrorMessage="Please specify a valid username (6 to 32 alphanumeric characters)." 
ValidationExpression="[0-9,a-z,A-Z, ]{6,32}"></asp:RegularExpressionValidator>

<asp:Button CssClass="btn" id="addUserButton" runat="server" Text="Add User"></asp:Button>
<asp:Button CssClass="btn" id="cancelButton" runat="server" Text="Cancel" CausesValidation="False"></asp:Button> 
```

**更新：**在后面的代码中生成了一些动态页面，这一定把它搞砸了，因为当我清理它时它开始工作了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T13:11:06.977

直到 2.0 版才将验证组添加到 ASP.NET。这是一个1.1的问题。

仔细检查您的设置，并确保您没有在后面的代码中覆盖它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T13:05:36.787

它们是否在单独的验证组中（按钮和验证器控件）？

您不是手动调用 JS 来进行客户端验证吗？

# c# - 如何在 XNA 中将精灵着色为白色？

> ID：82914
> 
> 赞同：7
> 
> 时间：2008-09-17T13:04:42.997
> 
> 标签：c#, xna, shader, tint

我认为仅使用 SpriteBatch 中的颜色设置是不可能的，所以我正在尝试制定一个简单的着色器，它将每个像素都设为白色，同时尊重像素的 alpha 值。

Joel Martinez 给出的答案看起来是对的，但是当我用 SpriteBatch 绘制精灵时，我该如何结合呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T13:38:31.090

我想这就是你要找的

```
sampler2D baseMap;

struct PS_INPUT 
{
   float2 Texcoord : TEXCOORD0;

};

float4 ps_main( PS_INPUT Input ) : COLOR0
{
   float4 color = tex2D( baseMap, Input.Texcoord );
   return float4(1.0f, 1.0f, 1.0f, color.w);
} 
```

这很简单，它只是从纹理中获取采样颜色，然后使用纹理的 alpha 值返回全白色。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T19:55:38.907

If you want to use custom shaders with SpriteBatch, check out this sample:

[http://creators.xna.com/en-us/sample/spriteeffects](http://creators.xna.com/en-us/sample/spriteeffects)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T18:20:36.297

Joel Martinez 确实是对的，您可以像这样将它与 SpriteBatch 一起使用，并将效果加载到 tintWhiteEffect 中：

```
spriteBatch.Begin(SpriteBlendMode.AlphaBlend, SpriteSortMode.Immediate, SaveStateMode.None);

tintWhiteEffect.Begin();
tintWhiteEffect.CurrentTechnique.Passes[0].Begin();

   // DRAW SPRITES HERE USING SPRITEBATCH

tintWhiteEffect.CurrentTechnique.Passes[0].End();
tintWhiteEffect.End();

spriteBatch.End(); 
```

SpriteSortMode.Immediate 是这里的诀窍，它允许您将 SpriteBatch 的默认着色器换成您自己的。使用它会使 sprite 的绘制速度变慢一些，因为 sprite 不会在一次绘制调用中批量处理，但我认为您不会注意到其中的区别。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T18:25:18.000

我附上了 MS 的文档页面，如果您按照所有步骤操作，您应该立即启动并运行它。

[http://msdn.microsoft.com/en-us/library/bb203872(MSDN.9).aspx](http://msdn.microsoft.com/en-us/library/bb203872(MSDN.9).aspx)

总结一下 - 您需要创建和效果文件（结合上面的代码，这对于您的目的确实是正确的），将其添加到您的项目中，然后在源文件中加载它并在渲染期间按照说明使用它在链接中。

顺便说一句：我不太记得 SpriteBatch（因为我选择自己编写，所以限制太大），但我记得您可能需要在发送到渲染的材质中设置效果。无论如何 - 也许你会在这里找到它：

[http://creators.xna.com/en-us/utilities/spritebatchshader](http://creators.xna.com/en-us/utilities/spritebatchshader)

如果您想到达那里，还有一个高级代码：

[http://creators.xna.com/en-us/sample/particle3d](http://creators.xna.com/en-us/sample/particle3d)

玩得开心

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T13:13:03.087

我还没有编写自己的像素着色器，主要是从网上修改过的样本，你会做的是你会分别增加像素中 R、G、B 分量的值，只要它们低于 255，这将逐渐将精灵的颜色变为白色。嘿，押韵。

# sql - 使用一个选项进行排序，强制排在列表顶部

> ID：82929
> 
> 赞同：4
> 
> 时间：2008-09-17T13:05:59.780
> 
> 标签：sql, sorting

我有一个向用户显示选项列表的 PHP 应用程序。该列表是从针对 SQL 2000 的简单查询生成的。我想做的是在列表顶部有一个特定选项，然后将其余选项按字母顺序排序。

例如，以下是按字母顺序排序的选项：

```
Calgary  
Edmonton  
Halifax  
Montreal  
Toronto 
```

我希望列表更像这样：

```
**Montreal**  
Calgary  
Edmonton  
Halifax  
Toronto 
```

有没有办法可以使用单个查询来做到这一点？还是我坚持运行查询两次并附加结果？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-17T13:11:00.533

```
SELECT name
FROM locations
ORDER BY
    CASE
        WHEN name = 'Montreal' 
        THEN 0
        ELSE 1
    END, name 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-17T13:07:04.520

```
SELECT name FROM options ORDER BY name = "Montreal", name; 
```

注意：这适用于 MySQL，而不是像 OP 要求的 SQL 2000。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T13:08:26.793

```
create table Places (
    add Name varchar(30),
    add Priority bit
)

select   Name
from     Places
order by Priority desc,
         Name 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T13:16:38.350

我在一个充满案例报告的网站上遇到了类似的问题。我希望已知受害者姓名的案例报告排在最前面，因为它们更引人注目。相反，我希望所有 John Doe 案件都在底部。由于这也涉及到人名，所以我也遇到了名字/姓氏排序问题。我不想将它分成两个名称字段，因为有些情况根本不是人。

我的解决方案：

我有一个显示的“名称”字段。我还有一个用于所有查询但从未显示的“NameSorted”字段。我的输入 UI 负责将输入到排序字段的“LAST，FIRST”自动转换为显示版本。

最后，为了“装配”排序，我只需在排序字段的开头放置适当的字符。因为我想让东西在最后出来，所以我把“zzz”放在开头。要在顶部排序，您可以输入“！” 一开始。同样，您的编辑 UI 可以为您解决这个问题。

是的，我承认它有点俗气，但它确实有效。对我来说，一个优势是我必须在不同的地方进行更复杂的查询来生成页面而不是 RSS 等，而且我不必记住一个复杂的表达式来正确排序，它总是按“NameSorted “ 场地。

单击我的个人资料以查看生成的网站。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-11-07T18:49:31.780

我结束了这个

```
SELECT name
FROM locations
LEFT JOIN (VALUES ('Toronto', 1), ('Montreal', 2)) city (name, rank)
    ON locations.name = city.name
ORDER BY city.rank, locations.name; 
```

对于这个例子来说，这可能是多余的，但可以扩展以满足更复杂的需求。

# project-management - 管理 GUI 中的功能蔓延

> ID：82933
> 
> 赞同：13
> 
> 时间：2008-09-17T13:06:14.100
> 
> 标签：project-management

有人对如何管理 GUI 中的功能蔓延有任何实用建议吗？

我受到来自内部和外部来源的巨大压力，要求我添加、修改、调整等。当有人接近我说“如果……会不会很好？”时，我总是畏缩不前。我不能只是转身对他们大喊“不”，因为他们通常是我的上司或客户。

相反，我正在寻找建议来帮助解释为什么不断添加新功能是一个坏主意，并在此过程中管理他们对最终产品的期望。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-17T13:10:06.977

在正式流程中处理功能请求，通常通过项目经理和最初分析需求的人。将这些决定交给不是开发人员的人总是更好的做法，前提是无论谁来做这项工作实际上都有能力。

如果您是自由职业者，那么显然会对需求的更改收取费用，如果您是内部开发团队，那么您可以考虑跨部门计费，以确保人们考虑他们想要花钱的地方。

最后，**预计**需求会发生变化，特性会发生变化。如果您在编写代码时没有考虑可能会要求进行哪些更改，或者您的流程和/或截止日期如此不灵活，以至于您无法适应这一点，那么您会发现该项目将成为一场噩梦。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-09-17T14:05:39.310

我所做的是将功能创意保留在索引卡上并将卡片张贴在可见的地方。当有人问，“它也可以做XXX吗？” 我写了一张新卡片。这是一个比尖叫“不！”更好的建立关系的举措。:-) 它还具有不会丢失潜在好主意的优点。OTOH，我当时没有强迫实施它。建议者知道他们已经被听取了，我知道我不会忘记，我可以重新开始工作，而且我们可以聚在一起，在比我的大脑在 CodeLand 时更好的时间做出优先级决定。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-17T13:24:54.400

好吧，我将在这里成为敏捷的代言人。在该过程结束时无法解决问题，必须通过不同的项目管理来避免它。

除了特定的方法之外，诀窍是将这些决定交到客户手中。你有一份待办事项的清单。当他们想要更改该列表时，您询问他们列表中的哪个项目不会完成以容纳新项目。或者，他们会给你多少钱来处理它。

此外，您必须以小迭代（一周到一个月）的方式完成工作，以便他们有机会在其间重新调整。

我们使用 SCRUM，它很棒。经过几次迭代后，所有业务级别和流程级别的项目都得到了解决，您最终交付的正是他们想要的。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-17T13:12:50.077

理想情况下，此类请求应由功能设计负责人处理。无论您喜欢与否，都会发生变化（从功能设计中的第一个字母到代码的最后一个字节等等），并且总会有对额外功能的要求。因此，请确保您的设计适合这样一个动态过程。

这可能听起来像是一个非常蹩脚的解决方案（我怀疑这是一个好的做法），但我过去一直在努力解决同样的问题。它发生在一家非常小的公司（管理层缺乏“层次”）的事实使情况变得更糟，因为我负责开发、功能设计、技术设计和管理我自己的项目。

对我有用的是将问题转移给提出问题的人（无论是上级还是客户）。交出功能设计、原型打印输出或任何描述当前情况的内容，并要求他们弄清楚应该“如何”和“在哪里”实现这个强大的新功能。

然后，上级和客户都“被迫”将其带回给自己的人，在会议上讨论等等。通常这意味着您没有第二次收到它的消息。在它确实出现的情况下，它实际上是一个有效的概念。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-17T13:13:30.637

贵公司在开始项目之前似乎没有明确定义需求，这只会以泪水告终。

我的政策是提前清楚地细分所有要求，并让所有各方都知道违反这些要求的含义。

1.  逐步延迟发布时间
2.  增加的错误
3.  不完整的功能
4.  员工压力
5.  员工辞职。
6.  期望从最终产品中获得的额外费用比价格声明中商定的要多（这真的很糟糕）

如果他们不想坚持一个可持续且富有成效的系统，那么他们可能想要选择#5，或者以#5 威胁。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-17T13:14:06.127

对于管理者：

*   产品越早投放市场（假设它是收缩包装），公司就能越早赚钱，现金流就越好。
*   不要完全排除新功能，而是要平衡它与你可以从做替代工作中获得的价值；解释机会成本。

为了所有人：

*   如果新功能在 UI 中呈现在您面前，请开始谈论视觉复杂性对整个产品的可用性以及吸引力的影响。但我相信你已经在这样做了。我会尝试挖掘一些参考资料...

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-17T13:16:27.680

恕我直言，最好的方法是明确概述实施新功能的成本。当用户开始看到此类添加的成本时，“如果”真的开始减少，那就太好了。

与客户对某项功能的不同意见通常会让你一事无成。如果你明目张胆地对他们说不，他们会感到疏远，与你和你的团队脱节。总体而言，该功能可能是一个好主意，因为您拥有世界上所有的时间和金钱，并且没有技术限制。在他们的世界里，在他们点击一个片段后*能够在**酒吧*旁边看到一个*fiz*是一个好主意。当然，在我们的世界中，这意味着全表扫描、潜在的安全漏洞，以及确保它在下一个版本发布之前通宵达旦。

 **如果您为他们安排并解释为什么总体而言这不是一个好主意，他们通常会理解。不要忘记所有不同的因素（时间/金钱/增加项目复杂性的成本/推迟截止日期的风险）。一个通情达理的人会明白，如果你画得足够清楚，你至少可以对一个不通情达理的人说“我告诉过你”。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-17T13:16:49.927

您不能只处理功能蠕变——您需要以适当的方式组织整个开发过程。

但是，根据您的描述，您似乎只是编写了其他人要求的代码，并且无法重新组织该过程。在这种情况下，您最好的方式是通过使用跟踪/票务系统来有效管理请求，该系统将允许您接收来自其他人的请求、对其进行优先级排序、估计它们、同意实施计划并跟踪您实际花在处理它们上的时间。

当您能够用现实世界的数据证明“这个小按钮”需要 2-3 天而不是 5 秒时，客户可能认为您应该处于更好的谈判位置。

如果您能够清楚地表明项目上线日期将由于新功能而延迟两周，您可能会看到这些请求完全消失。

但是，您必须记住，“功能蠕变”并不总是负面的。随着应用程序的成熟和增长，您的客户优先级也在发生变化。不承认这一点可能意味着您的成品将不是他们想要的。尝试检查他们是否会接受用尚未实现的原始规范中的旧功能交换新功能。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-17T13:19:57.063

我保留了工作任务的优先列表，以及我对构建 X 中的内容的估计，以及我预计编写测试、实现代码和执行其他相关操作需要多长时间（粗略地说）。我总是听取他们的意见，讨论他们真正想要/需要的东西，并坚持让我们确定它在宏伟计划中的位置。我们谈论对日程安排和其他任务的影响。

它使沟通线路保持畅通无阻 - 没有任何意外，并且期望得到管理。最后，这不是我的程序——它是客户的（无论客户是谁），我想为他们建造他们想要（和需要）建造的东西。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-17T14:30:41.480

关键似乎在问题中。

'**管理**特性蠕变'...您通过实施需要遵循的管理流程来做到这一点。你无法避免它（毕竟，经常是顾客要求它并且一直对他们大喊不，这往往会把这些可怜的生物赶走）......但这并不意味着它必须是无纪律的。有了一个程序，要求提出请求的人给出简单的事情，比如理由和对变更的初步调查/用例，你开始减少“这样做会不会很好”的数量。一旦你做到了这一点，你的特性蠕变就会得到管理，你可以开始确定优先级并提供更一致的反馈。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-17T14:49:41.777

如果我们可以从 Internet 和 Web 2.0 之类的东西中吸取教训，那就是人们喜欢定制。这就是 iGoogle 和其他数百个网站的全部意义所在。如果您可以在 GUI 中进行自定义，那么您的客户很可能会因此而爱上您。

另外，看看其他项目如何成功地管理特性蠕变。例如，Google 允许用户提交功能请求，但也会显示已请求功能的列表。然后，用户也可以投票请求该功能。并不是说我很烂，而是看看[stackoverflow.uservoice.com](https://web.archive.org/web/20090219112537/http://stackoverflow.uservoice.com:80/)。他们有类似的政策。

听取用户的意见并获得他们的反馈至关重要。期待他们提出比你更好的新想法。期待他们提出你认为愚蠢的想法。如果有足够多的人想要它，而且看起来很合理，那就给他们想要的东西。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-17T15:22:09.640

您的用户有很多没有得到照顾的需求。他们正在受苦。他们需要关注，他们需要*你*。我认为功能蠕变是在您尚未实现*正确功能*时发生的事情。

*   与您的用户建立密切的关系。让他们知道你总是对他们的意见感兴趣。定期给他们打电话，询问您的软件如何对待他们。
*   了解他们的工作习惯、标准做法、他们如何使用您的软件以及他们如何使用其他软件。当这些信息进来时，收集它。
*   当功能请求进来时，您的用户不会真正知道他们想要什么。但是，您知道他们想要什么，因为您拥有专业知识并且一直在倾听。因此，与他们一起澄清他们遇到的问题，然后使用您收集的知识尽可能概括问题。写一个解决*这个*问题的解决方案。

另一方面，“功能蔓延”通常是软件产品对不断发展的业务的反应。如果您的客户的业务正在增长，那么您很幸运，因为他们会在您的工作上花费更多的钱。所以放轻松，他们会付钱给你的！他们只需要明白，系统越大，更改就越困难，有时一个新的小功能需要进行大的重写，或者一个全新的用户界面，以保持一切顺利运行。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-17T17:49:23.123

您必须小心平衡不愿避免功能蔓延与忽略功能请求和反馈的倾向。

每次用户向您提供反馈时，这都是改进您的产品和您的工作的机会。最终您可能会为用户和您的开发人员添加一些有趣的东西；工作实际上可能很有趣。*是的，正如*向您提出的那样，这可能是一个愚蠢的想法。但你的工作是接受反馈，从中提取任何积极的东西，并将其塑造成对你的用户、产品、公司和开发团队有价值的东西。

话虽如此，功能蠕变是一件非常难以管理的事情。而你管理它的程度取决于你的位置和“蠕变”是谁。如果您是中初级开发人员，并且 CEO 要求某个功能；好吧，您将添加该功能。你可以尝试让 CEO 相信这不是一个有价值的功能，或者它不起作用，或者有更重要的事情需要处理，或者它会对日程安排产生负面影响。但在请求该功能时，切勿这样做。你最终会得到的只是两个人捍卫自己的立场，而不是为了一个共同的目标而共同努力。

相反，立即接受反馈和功能请求（或功能需求）。走开，自己开诚布公地想一想。“这会很有价值吗？” “我在 CEO 要求的方式中遗漏了什么吗？” “有我说的那么难吗？” 问自己这些问题，并想出一些具体的答案。然后**总是**带着后续问题回到 CEO 那里。证明您已经考虑过请求的功能，并且实际上已经提出了一些想法、调整、增强或反对意见等。这将创建一个公开讨论。这是 CEO 没有预料到的，但他很可能不会反对，因为它最初并没有完全反对他的想法。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-10-21T14:08:12.183

我们的一位财务支持者一直要求功能。有时他说我们可以让软件做'x'。如果可能的话，我们会告诉他是的，然后问他有什么时间表。如果他尽快回来 - 那么我们会告诉他其他一些功能将不得不放弃或延长我们的最后期限。值得庆幸的是，他通常会在未来的某个时间改变自己的观点。

我认为最重要的是实际记录想法或请求，即使该功能没有立即实施。

我们使用 Bugzilla 来跟踪错误 - 以及功能请求。我们有一个“功能”工作清单（或目标版本）...这样每个人都可以看到我们希望在未来开发哪些功能，并且随着人们对某个功能有更多想法，他们可以简单地在 bugzilla 中的项目中添加更多内容。

每次发布时，当我们坐下来制定版本的工作清单时，我们都会将脚趾伸入功能列表中，看看是否有任何可以引入的东西。我们确实会尝试在可能的情况下引入功能并向人们提供反馈 -这表明功能和想法并没有被置若罔闻。

这种反馈有助于人们知道我们正在承认他们的功能请求，并且我们确实可以实施它们，而不是仅仅坐在越来越大的列表上。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-10-21T14:24:47.047

1) 增加发布前的时间。

2）成本增加。

3）指数维护成本

4）增加潜在的错误

为了管理功能请求，请他们提交变更单。定期审查变更单并就每个请求发回一份声明，“这将花费 X 长时间来完成，这意味着这 Y 额外费用。这可以接受吗？” 一旦请求者接受了额外的费用，那就没问题了。你的手已经洗过了。:)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-10-21T14:28:33.093

你解释说“当然，这是可行的，你想估计它会推迟项目完成日期吗？另外，给你这个估计也会使项目结束时间增加大约一天。”

添加功能并没有错，只要利益相关者明白这样做是有成本的。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-11-21T23:05:16.047

假设您构建的产品只有一个功能，并且所有 100 位客户都喜欢您的产品并发现它易于使用。现在假设您向产品添加了另外 10 个功能，只有 10 个客户会使用这些功能。现在您会发现 90% 的客户在使用您的产品时遇到了更多的麻烦，因为要做出的选择要多十倍，而您可以做的事情也多十倍，但对您无济于事。好东西已经在喧嚣中消失了。

这当然是一种简化，但现实情况是您的大多数用户只会使用您产品的一小部分功能。

阅读一些关于软件设计和 UI 设计的好书，并让你的经理也阅读它们。Joel Spolsky 的书籍是一个很好的起点 - www.joelonsoftware.com

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-17T13:08:29.010

创建定义需要解决的问题的工作任务。您的工作受限于只需要实施解决问题所必需的内容。

问题的任何进一步细化都将成为变更控制。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-09-17T13:08:37.510

我们在我的办公室遵循线框。签核后的任何变更都必须通过变更控制程序。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-09-17T13:14:13.380

在短时间内锁定功能集（Scrum/迭代/敏捷）。当用户开始看到东西在工作时，功能的必要性或缺乏性将变得更加明显。

此外，拥有一个能够带来所有变化的人是很有帮助的（在 Scrum 中，一个非常好的产品负责人）。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-09-17T13:14:54.517

**向他们展示**简单****的 GUI 是如何有效的。**示例：Google Chrome，Apple 的软件。您可能还想展示臃肿软件的示例，如 Eclipse、Netbeans、Visual Studio……好吧，这些实际上都是软件 IDE，但它们都有杂乱的界面。**

 *** * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-09-17T13:51:40.980

诀窍是将项目定义为一系列版本。您的初始设计是针对 2.0 版的，但预期的第一个版本是 1.0 版。欢迎所有新想法（功能），但由于时间安排，1.0 版被冻结，新想法必须进入 2.0 版。

当然，一旦 1.0 版发布，您就开始为 1.01 版的维护版本进行错误修复和编码等等……也许 2.0 版从未真正发布过，但它被用作难以捉摸的目标和功能的停车位很好，但还不足以延迟工作版本的发布。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2008-09-17T13:58:26.470

要问的正确问题是“我怎样才能给开发人员一个**稳定**的环境，同时仍然**只响应**高收益的功能请求。” 类似 SCRUM 的方法是：

## 稳定的环境：

让开发人员在固定的小迭代间隔内处理一小部分**固定**的**功能**。

 **## 仅响应高收益功能请求：

一个人维护一个优先功能列表。**总是**可以添加新功能（减少很多政治）。然而，为下一次迭代选择的特征只是**高优先级**项目。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2008-09-17T14:02:35.853

沟通是关键。在与客户的关系中，他们必须清楚，当创建具有一组功能的计划时，这就是一组功能。这只是那些与客户互动的人的错，他们要么误导了客户，要么以某种方式被客户吓倒了。

至于为特性蔓延做出贡献的开发人员，关键是在做出实施决策和直接添加新特性之间找到平衡。同样，定期与开发人员沟通可能会解决这里的问题。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-09-17T14:11:59.997

可能无法避免所有功能请求。

但请尝试为每个功能请求分配成本。当下次计划会议或决定下一个版本的功能时，这将有助于清除不必要的功能。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2008-09-17T14:53:37.400

如果您不是项目的经理或所有者，我会规定以下内容：

如果他们想要，就去做。确保他们在发薪日付钱给你。我了解到，有时为了让事情符合*你*的意愿而进行的战斗是不值得战斗的。享受生活，下班后并计划和编写以正确方式做事的个人项目。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2008-09-17T15:02:46.863

您的问题的答案不仅仅是 GUI。当有人不注意合同规定的内容以及没有处理变更请求的正式流程时，总是会发生功能/范围蔓延。

如果您缺乏实施正式流程或影响其创建的能力，我建议您将***所有***功能更改请求记录在电子邮件中，并在电子邮件中通知您的管理层可能产生的后果。这不是为了*得到*任何人，而是为了保护自己免受最终失败的影响。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2008-09-17T16:25:55.057

在某些时候，您必须运送一些东西。假设您正在经历某种正式的测试过程，只要产品继续变化，测试就永远无法在工作产品上签字。

它有助于提出一个时间表，描述将发布哪些功能以及何时发布。这样，推动新功能的人们就会知道他们的请求会得到处理。这并不意味着他们将立即得到处理，但它应该为他们提供一些保证，即下一个版本将解决他们的担忧。

# c# - 在 C# 中的任意起始索引上初始化数组

> ID：82943
> 
> 赞同：6
> 
> 时间：2008-09-17T13:06:59.247
> 
> 标签：c#, arrays, interop, ms-office, initialization

是否可以在 c# 中初始化一个数组，例如，子索引 1？

我正在使用 Office 互操作，每个属性都是从 1 开始的对象数组（我假设它最初是在 VB.NET 中编程的），你不能修改它，你必须设置整个数组才能接受变化。

作为一种解决方法，我正在克隆原始数组，修改该数组，并在完成后将其设置为一个整体。

但是，我想知道是否可以创建一个新的基于非零的数组

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-17T14:12:30.743

可以按照您的要求执行，请参见下面的代码。

```
// Construct an array containing ints that has a length of 10 and a lower bound of 1
Array lowerBoundArray = Array.CreateInstance(typeof(int), new int[1] { 10 }, new int[1] { 1 });

// insert 1 into position 1
lowerBoundArray.SetValue(1, 1);

//insert 2 into position 2
lowerBoundArray.SetValue(2, 2);

// IndexOutOfRangeException the lower bound of the array 
// is 1 and we are attempting to write into 0
lowerBoundArray.SetValue(1, 0); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-17T13:11:13.713

您可以使用[`Array.CreateInstance`](http://msdn.microsoft.com/en-us/library/system.array.createinstance%28v=vs.110%29.aspx).

请参阅[.NET 中的数组类型](http://msdn.microsoft.com/en-us/magazine/cc301755.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T13:10:31.390

不简单。但是您当然可以编写自己的课程。它将有一个数组作为私有变量，用户会认为他的数组从 1 开始，但实际上它从 0 开始，您从他的所有数组访问中减去 1。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T13:09:42.080

您可以编写自己的数组类

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T13:11:38.643

我不认为是否可以修改数组的起始索引。

我会使用泛型创建自己的数组并在内部处理它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T13:12:04.290

只需将名为 'offset' 的 const int 保留为 1，并始终将其添加到代码中的下标中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T13:14:33.457

我不认为您可以在 C# 中创建基于非零的数组，但是您可以轻松地围绕内置数据结构编写自己的包装类。这个包装类将包含您需要的数组类型的私有实例；不允许重载 [] 索引运算符，但您可以向类添加索引器以使其行为类似于可索引数组，请参见[此处](http://www.developer.com/net/csharp/article.php/1547581)。然后，您编写的索引函数可以对所有传入的索引添加（或减去）1。

然后，您可以按如下方式使用您的对象，它的行为会正确：

```
myArrayObject[1]; //would return the zeroth element. 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-09-17T13:10:21.220

在 VB6 中，您可以将数组更改为以 0 或 1 开头，所以我认为 VBScript 也可以这样做。对于 C#，这是不可能的，但您可以简单地在第一个 [0] 中添加 NULL 值并在 [1] 处开始实际值。当然，这有点危险……

# java - jUnit 4.x 中的前后套件执行挂钩

> ID：82949
> 
> 赞同：84
> 
> 时间：2008-09-17T13:07:33.270
> 
> 标签：java, testing, junit, integration-testing

我正在尝试为一组集成测试进行设置和拆卸，使用 jUnit 4.4 来执行测试。拆解需要可靠地运行。我在使用 TestNG 时遇到了其他问题，所以我希望移植回 jUnit。在运行任何测试之前和所有测试完成之后，哪些钩子可用于执行？

注意：我们使用 maven 2 进行构建。我尝试过使用 maven 的`pre-`&`post-integration-test`阶段，但是，如果测试失败，maven 会停止并且不会运行`post-integration-test`，这无济于事。

* * *

## 回答 #1

> 赞同：117
> 
> 时间：2008-10-07T02:51:40.210

是的，可以在测试套件中的任何测试之前和之后可靠地运行设置和拆除方法。让我用代码演示一下：

```
package com.test;

import org.junit.AfterClass;
import org.junit.BeforeClass;
import org.junit.runner.RunWith;
import org.junit.runners.Suite;
import org.junit.runners.Suite.SuiteClasses;

@RunWith(Suite.class)
@SuiteClasses({Test1.class, Test2.class})
public class TestSuite {

    @BeforeClass
    public static void setUp() {
        System.out.println("setting up");
    }

    @AfterClass
    public static void tearDown() {
        System.out.println("tearing down");
    }

} 
```

所以你的`Test1`班级看起来像：

```
package com.test;

import org.junit.Test;

public class Test1 {
    @Test
    public void test1() {
        System.out.println("test1");
    }

} 
```

...你可以想象这`Test2`看起来很相似。如果你跑了`TestSuite`，你会得到：

```
setting up
test1
test2
tearing down 
```

因此，您可以看到设置/拆卸仅分别在所有测试之前和之后运行。

问题：这仅在您运行测试套件且不将 Test1 和 Test2 作为单独的 JUnit 测试运行时才有效。您提到您正在使用 maven，并且 maven surefire 插件喜欢单独运行测试，而不是套件的一部分。在这种情况下，我建议创建一个每个测试类都扩展的超类。然后超类包含带注释的@BeforeClass 和@AfterClass 方法。虽然不如上述方法干净，但我认为它对你有用。

至于测试失败的问题，您可以设置 maven.test.error.ignore 以便在失败的测试上继续构建。不建议将这作为一种持续的做法，但它应该让您在所有测试通过之前都能正常工作。有关更多详细信息，请参阅[maven surefire 文档](http://maven.apache.org/maven-1.x/plugins/test/properties.html)。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2013-02-07T17:29:46.093

我的一位同事建议如下：您可以使用自定义 RunListener 并实现 testRunFinished() 方法： http://junit.sourceforge.net/javadoc/org/junit/runner/notification/RunListener.html#testRunFinished(org [. junit.runner.Result)](http://junit.sourceforge.net/javadoc/org/junit/runner/notification/RunListener.html#testRunFinished(org.junit.runner.Result))

要注册 RunListener，只需按如下方式配置 surefire 插件： [http](http://maven.apache.org/surefire/maven-surefire-plugin/examples/junit.html) ://maven.apache.org/surefire/maven-surefire-plugin/examples/junit.html “使用自定义侦听器和报告器”部分

故障安全插件也应选择此配置。这个解决方案很棒，因为您不必指定套件、查找测试类或任何这些东西——它让 Maven 发挥它的魔力，等待所有测试完成。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2011-10-03T18:15:12.140

您可以[在 JUnit 4.9+ 中使用 @ClassRule 注释，](http://java.dzone.com/articles/junit-49-class-and-suite-level-rules)正如[我在另一个问题的回答中所描述的那样](https://stackoverflow.com/questions/349842/junit-4-set-up-things-in-a-test-suite-before-tests-are-run-like-a-tests-befor/7638935#7638935)。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-17T13:32:46.800

Using annotations, you can do something like this:

```
import org.junit.*;
import static org.junit.Assert.*;
import java.util.*;

class SomethingUnitTest {
    @BeforeClass
    public static void runBeforeClass()
    {

    }

    @AfterClass
    public static void runAfterClass()
    {  

    }

    @Before  
    public void setUp()
    {

    }

    @After
    public void tearDown()
    {

    }

    @Test
    public void testSomethingOrOther()
    {

    }

} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-01T18:13:40.127

在这里，我们

*   升级到 JUnit 4.5，
*   编写注释来标记每个需要工作服务的测试类或方法，
*   为每个注释编写处理程序，其中包含实现服务设置和拆卸的静态方法，
*   扩展了通常的 Runner 以定位测试上的注释，在适当的点将静态处理程序方法添加到测试执行链中。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-09-27T15:51:26.717

假设您所有的测试都可以扩展一个“技术”类并且在同一个包中，您可以做一个小技巧：

```
public class AbstractTest {
  private static int nbTests = listClassesIn(<package>).size();
  private static int curTest = 0;

  @BeforeClass
  public static void incCurTest() { curTest++; }

  @AfterClass
  public static void closeTestSuite() {
      if (curTest == nbTests) { /*cleaning*/ }             
  }
}

public class Test1 extends AbstractTest {
   @Test
   public void check() {}
}
public class Test2 extends AbstractTest {
   @Test
   public void check() {}
} 
```

请注意，此解决方案有很多缺点：

*   必须执行包的所有测试
*   必须是“技术”类的子类
*   您不能在子类中使用 @BeforeClass 和 @AfterClass
*   如果只执行包中的一项测试，则不进行清洗
*   ...

有关信息：listClassesIn() =>[如何在 Java 中找到给定类的所有子类？](https://stackoverflow.com/questions/492184/how-do-you-find-all-subclasses-of-a-given-class-in-java/495851#495851)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-12-07T14:54:16.527

至于“注意：我们使用 maven 2 进行构建。我尝试过使用 maven 的 pre- & post-integration-test 阶段，但是，如果测试失败，maven 会停止并且不会运行 post-integration-test ，这无济于事。”

您可以尝试使用故障安全插件，我认为它可以确保无论设置或中间阶段状态如何都可以进行清理

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T13:50:29.923

我认为获得所需功能的唯一方法是执行类似的操作

```
import junit.framework.Test;  
import junit.framework.TestResult;  
import junit.framework.TestSuite;  

public class AllTests {  
    public static Test suite() {  
        TestSuite suite = new TestSuite("TestEverything");  
        //$JUnit-BEGIN$  
        suite.addTestSuite(TestOne.class);  
        suite.addTestSuite(TestTwo.class);  
        suite.addTestSuite(TestThree.class);  
        //$JUnit-END$  
     }  

     public static void main(String[] args)  
     {  
        AllTests test = new AllTests();  
        Test testCase = test.suite();  
        TestResult result = new TestResult();  
        setUp();  
        testCase.run(result);  
        tearDown();  
     }  
     public void setUp() {}  
     public void tearDown() {}  
} 
```

我在eclipse中使用了类似的东西，所以我不确定它在那个环境之外的便携性

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-17T13:28:22.597

As far as I know there is no mechanism for doing this in JUnit, however you could try subclassing Suite and overriding the run() method with a version that does provide hooks.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-06-23T17:39:59.503

由于 maven-surefire-plugin 不首先运行套件类，而是将套件和测试类视为相同，因此我们可以如下配置插件以仅启用套件类并禁用所有测试。Suite 将运行所有测试。

```
 <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-surefire-plugin</artifactId>
            <version>2.5</version>
            <configuration>
                <includes>
                    <include>**/*Suite.java</include>
                </includes>
                <excludes>
                    <exclude>**/*Test.java</exclude>
                    <exclude>**/*Tests.java</exclude>
                </excludes>
            </configuration>
        </plugin> 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-10-25T22:38:58.823

如果您不想创建套件并且必​​须列出所有测试类，则可以使用反射来动态查找测试类的数量并在基类 @AfterClass 中倒计时以仅进行一次拆卸：

```
public class BaseTestClass
{
    private static int testClassToRun = 0;

    // Counting the classes to run so that we can do the tear down only once
    static {
        try {
            Field field = ClassLoader.class.getDeclaredField("classes");
            field.setAccessible(true);

            @SuppressWarnings({ "unchecked", "rawtypes" })
            Vector<Class> classes = (Vector<Class>) field.get(BlockJUnit4ClassRunner.class.getClassLoader());
            for (Class<?> clazz : classes) {
                if (clazz.getName().endsWith("Test")) {
                    testClassToRun++;
                }
            }
        } catch (Exception ignore) {
        }
    }

    // Setup that needs to be done only once
    static {
        // one time set up
    }

    @AfterClass
    public static void baseTearDown() throws Exception
    {
        if (--testClassToRun == 0) {
            // one time clean up
        }
    }
} 
```

如果您更喜欢使用 @BeforeClass 而不是静态块，您还可以使用布尔标志在第一次调用时只进行一次反射计数和测试设置。希望这对某人有所帮助，我花了一个下午才找到比枚举套件中的所有课程更好的方法。

现在你需要做的就是为你所有的测试类扩展这个类。我们已经有一个基类来为我们所有的测试提供一些通用的东西，所以这对我们来说是最好的解决方案。

灵感来自这个 SO 答案[https://stackoverflow.com/a/37488620/5930242](https://stackoverflow.com/a/37488620/5930242)

如果您不想在任何地方扩展此类，那么最后一个 SO 答案可能会满足您的需求。

# rss - 使用雅虎！管道

> ID：82950
> 
> 赞同：1
> 
> 时间：2008-09-17T13:07:39.933
> 
> 标签：rss, yahoo-pipes

您是否使用[过 pipe.yahoo.com](http://pipes.yahoo.com/pipes/)来快速轻松地做……任何事情？我最近创建了一个[StackOverflow 标签的快速混搭](http://pipes.yahoo.com/kooshmoose/stackoverflow_merge)（[通过 rss](http://pipes.yahoo.com/pipes/pipe.run?_id=NIlbqD_E3RGfAAUWpgt1Yg&_render=rss)），这样我就可以浏览我喜欢关注的领域中的新问题。

这已经存在了一段时间，但我最近才重新访问它，它的易用性给我留下了深刻的印象。几乎到了可以设置管道然后授予客户端权限以进入并编辑提要源的程度……而且我不必编写多于几行代码。

那么，您还能想到管道的其他实际用途吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T14:05:59.683

你可以用管道做很多事情。例如对于 digg 或 reddit 之类的网站，您可以制作一个绕过该网站并直接转到链接的文章（重写 RSS）。

我还喜欢过滤网络漫画的提要以仅保留漫画，然后将它们全部混合在一个提要中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T13:13:53.613

聚合提要很好，是的，但另一件方便的事情是过滤提要。不久前，我为 Digg 创建了一个提要（在 Digg 陷入绝望的 Fark 深渊之前）。我不关心压倒性的 Apple 和 Ubuntu 新闻，所以我从技术中过滤掉了这些关键词，然后将其与科学和世界与商业提要结合起来。

无论如何，您可以做的不仅仅是组合事物。如果您想变得聪明一点，您可以设置每个子提要和整个提要过滤器，以便随着新闻的变化以及您对某个主题或另一个主题感到厌烦，提供细粒度或总体过滤能力。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T13:19:09.717

我真正使用过的一件事是Y！管道（而不仅仅是玩弄它）是清理项目标题，合并并最终删除我从使用相同搜索词查询多个博客搜索引擎获得的提要。这是我在几个非常不同的情况下所做的事情，例如。用于我自己的自我冲浪，在另一种情况下，用于某些会议组织者建立的地球站点以密切关注他们的会议的嗡嗡声等。强烈推荐。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T13:19:59.327

好吧，管道确实快速且有用。其他有效用途可能是：

1) 将许多提要合并为一个，然后对其进行排序、过滤和翻译。

2) 对您最喜欢的提要进行地理编码并在交互式地图上浏览项目。

3) 您网站上的电源小部件/徽章。

4) 以 RSS、JSON、KML 和其他格式抓取任何 Pipes 的输出。

这绝不是一个完整的列表。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T00:42:35.970

我冒昧地复制了你的管道并重新排列了它，以便更容易添加和删除标签：

[Yahoo Pipe: StackOverflow 合并标签](http://pipes.yahoo.com/flenser/stackoverflow_merge_tag_feeds)

标签现在列在字符串构建器中，因此要添加标签，您只需点击字符串构建器上的 + 按钮并在标签前输入斜杠即可。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T13:57:50.857

我使用 Pipes 将博客翻译成英文。我本来想用它来获取博客的全文，这些博客只提供提要中内容的摘要，但不幸的是，它们没有提供任何从可参数化的源获取内容的输入:-(。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T13:15:08.930

我最喜欢和雅虎一起做的事情之一！管道是将多个 craigslist 提要聚合到一个提要中。您可以根据 craigslist 上的任何类别或搜索条件制作供稿。例如，我住在大学城，一直在寻找体育赛事的门票。我有六个 craigslist 搜索都通过 Yahoo! 合并到一个提要中！管道。这对我来说比简单地监控整个“Tickets”类别要好得多；过滤掉大部分我不感兴趣的票证。是的，这是另一个聚合提要示例，但是 craigslist 的使用非常有价值，因为它能够聚合本身基于搜索的提要。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-31T20:49:58.050

只是在寻找将 Excel 连接到 Pipes 的方法时偶然发现了这一点。有点死灵法师的风格，但就在这里。

我做过的一件事是获取一个 HTML 页面（科学数据），其中链接到大量陆军军测量站的大量 CSV 文件。每个站都有一个大数据文件表，所有数据文件都按月和年单独组织。我使用 YQL 以 Pipes 可以读取的方式解析和组织各个 CSV 文件的链接。然后，我将其用作管道的输入，该管道具有“站”和“日期”的用户输入。

使用它，我可以转到 Pipes 页面，输入这些值并仅获取特定站点和日期的值，而不必在网站上查找站点，在大表中查找年份和月份，单击链接，打开 CSV 文件，然后在该月的数据中查找一天的值。我什至可以更改管道以指定小时和参数，然后返回单个值。

现在，我希望我能弄清楚如何对 Excel 进行编程，以便我可以使用“=yahoo_function(station, datetime)”将该值自动放入单元格中，并给出其他列的值！

# sql-server - SQL Server Reporting Services 2005 中的订阅参数

> ID：82956
> 
> 赞同：3
> 
> 时间：2008-09-17T13:08:26.903
> 
> 标签：sql-server, reporting-services

当我订阅报告时，我可能会选择以下主题：`@ReportName was executed at: @ExecutionTime`

我想要一个这样的名字：`Your "@ReportName" report covering Sep 10 2008 - Sep 16 2008`

`Sep 10 2008 - Sep 16 2008`是两个报告参数的值：`@DateFrom`和`@DateTo`，分别。

我可以指定类似的东西`@ReportParameters!DateFrom`作为我的主题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-30T11:50:42.027

看看[这篇文章](http://www.sqlservercentral.com/articles/Development/datadrivensubscriptions/2432/)。作者展示了如何从代码执行数据驱动订阅，并为此提供了一个存储过程。存储过程允许您指定电子邮件正文，因此如果您在运行报告之前知道报告参数，则可以在调用过程之前填充它们。我不确定他的程序是否涵盖电子邮件主题，但也许您可以接受他所做的并对其进行修改。

还刚刚发现[此 MSDN 论坛帖子](https://forums.microsoft.com/msdn/ShowPost.aspx?PostID=3656006&SiteID=1)，其中包含 MSFT 的回复，即数据驱动订阅是实现此目的的方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T17:01:33.567

我不相信除了这两个参数之外的任何其他参数都可用于报告订阅电子邮件（至少在 SSRS 2005 中）。

您可能可以通过数据驱动订阅执行某些操作，但您要使用的值需要在用于订阅数据的数据源中 - SSRS 仍然无法在报告本身中收集数据。

# visual-studio - 如何在 Visual Studio 2008 中自动删除尾随空格？

> ID：82971
> 
> 赞同：139
> 
> 时间：2008-09-17T13:09:49.973
> 
> 标签：visual-studio, visual-studio-2008

是否可以将 Visual Studio 2008 配置为在保存文件时自动删除每行末尾的空白字符？似乎没有内置选项，那么是否有可用的扩展来执行此操作？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2008-09-17T13:16:09.037

使用正则表达式查找/替换

在查找和替换对话框中，展开*查找选项*，检查*使用*，选择*正则表达式*

*查找内容*：“ `:Zs#$`”

*替换为*：“”

点击*全部替换*

在其他编辑器（*普通*的正则表达式解析器）中，“ `:Zs#$`”将是“ `\s*$`”。

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2012-07-03T15:51:03.753

CodeMaid 是一个非常流行的 Visual Studio 扩展，它与其他有用的清理一起自动完成。

*   下载：[https ://github.com/codecadwallader/codemaid/releases/tag/v0.4.3](https://github.com/codecadwallader/codemaid/releases/tag/v0.4.3)
*   现代下载：[https ://marketplace.visualstudio.com/items?itemName=SteveCadwallader.CodeMaid](https://marketplace.visualstudio.com/items?itemName=SteveCadwallader.CodeMaid)
*   文档： http: [//www.codemaid.net/documentation/#cleaning](http://www.codemaid.net/documentation/#cleaning)

我将其设置为在保存时清理文件，我相信这是默认设置。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2009-03-30T17:40:33.090

您可以创建一个在保存后执行的宏来为您执行此操作。

将以下内容添加到您的宏的 EnvironmentEvents 模块中。

```
Private saved As Boolean = False
Private Sub DocumentEvents_DocumentSaved(ByVal document As EnvDTE.Document) _
                                         Handles DocumentEvents.DocumentSaved
    If Not saved Then
        Try
            DTE.Find.FindReplace(vsFindAction.vsFindActionReplaceAll, _
                                 "\t", _
                                 vsFindOptions.vsFindOptionsRegularExpression, _
                                 "  ", _
                                 vsFindTarget.vsFindTargetCurrentDocument, , , _
                                 vsFindResultsLocation.vsFindResultsNone)

            ' Remove all the trailing whitespaces.
            DTE.Find.FindReplace(vsFindAction.vsFindActionReplaceAll, _
                                 ":Zs+$", _
                                 vsFindOptions.vsFindOptionsRegularExpression, _
                                 String.Empty, _
                                 vsFindTarget.vsFindTargetCurrentDocument, , , _
                                 vsFindResultsLocation.vsFindResultsNone)

            saved = True
            document.Save()
        Catch ex As Exception
            MsgBox(ex.Message, MsgBoxStyle.OkOnly, "Trim White Space exception")
        End Try
    Else
        saved = False
    End If
End Sub 
```

我已经使用了一段时间了，没有任何问题。我没有创建宏，而是根据 ace_guidelines.vsmacros 中的宏对其进行了修改，可以通过快速 google 搜索找到该宏。

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2008-09-17T13:16:20.037

在保存之前，您可以使用自动格式化快捷键`CTRL`++ 。`K``D`

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2011-02-05T11:05:34.180

您可以通过以下三个操作轻松完成此操作：

*   `Ctrl`+ `A`（选择所有文本）

*   编辑 -> 高级 -> 删除水平空白

*   编辑 -> 高级 -> 格式选择

等待几秒钟就完成了。

它是`Ctrl`+ `Z`'，以防万一出现问题。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2011-01-16T13:05:59.180

从已经给出的所有答案中提取元素，这是我最终得到的代码。（我主要编写 C++ 代码，但很容易根据需要检查不同的文件扩展名。）

感谢所有贡献的人！

```
Private Sub DocumentEvents_DocumentSaved(ByVal document As EnvDTE.Document) _
    Handles DocumentEvents.DocumentSaved
    Dim fileName As String
    Dim result As vsFindResult

    Try
        fileName = document.Name.ToLower()

        If fileName.EndsWith(".cs") _
        Or fileName.EndsWith(".cpp") _
        Or fileName.EndsWith(".c") _
        Or fileName.EndsWith(".h") Then
            ' Remove trailing whitespace
            result = DTE.Find.FindReplace( _
                vsFindAction.vsFindActionReplaceAll, _
                "{:b}+$", _
                vsFindOptions.vsFindOptionsRegularExpression, _
                String.Empty, _
                vsFindTarget.vsFindTargetFiles, _
                document.FullName, _
                "", _
                vsFindResultsLocation.vsFindResultsNone)

            If result = vsFindResult.vsFindResultReplaced Then
                ' Triggers DocumentEvents_DocumentSaved event again
                document.Save()
            End If
        End If
    Catch ex As Exception
        MsgBox(ex.Message, MsgBoxStyle.OkOnly, "Trim White Space exception")
    End Try
End Sub 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2016-01-29T16:54:44.840

我个人喜欢通过 Visual Studio 2012 支持的**[Trailing Whitespace Visualizer Visual Studio 扩展。](https://visualstudiogallery.msdn.microsoft.com/a204e29b-1778-4dae-affd-209bea658a59)**

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-17T13:13:12.820

您可以使用如*[删除空格和重写注释中所述的宏，使用正则表达式搜索](http://www.codeguru.com/cpp/v-s/devstudio_macros/article.php/c3203/)*

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-17T13:25:05.990

除非这是一个人的项目，否则不要这样做。将本地文件与源代码存储库进行比较一定很简单，清除空格会更改您不需要更改的行。我完全理解；我喜欢让我的空白全部统一——但为了更清晰的协作，你应该放弃这一点。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2011-08-03T08:57:44.357

不幸的是，我正在使用不支持宏的[VWD 2010 Express。](http://en.wikipedia.org/wiki/Microsoft_Visual_Studio_Express#Visual_Web_Developer_Express)所以我只是复制/粘贴到[Notepad++](http://en.wikipedia.org/wiki/Notepad_%28software%29)左上角菜单`Edit`> `Blank Operations`>`Trim Trailing Space`还有其他相关操作可用。然后复制/粘贴回 Visual Studio。

也可以使用[NetBeans](http://en.wikipedia.org/wiki/NetBeans)代替 Notepad++，后者在“源”菜单下有“删除尾随空格”。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2010-02-17T12:51:16.887

我认为如果*Jeff Muir*版本只修剪源代码文件（在我的例子中是 C#，但很容易添加更多扩展），它可能会有所改进。我还添加了一项检查以确保文档窗口可见，因为某些没有该检查的情况会显示奇怪的错误（例如，LINQ to SQL 文件“*.dbml”）。

```
Private Sub DocumentEvents_DocumentSaved(ByVal document As EnvDTE.Document) Handles DocumentEvents.DocumentSaved
    Dim result As vsFindResult
    Try
        If (document.ActiveWindow Is Nothing) Then
            Return
        End If
        If (document.Name.ToLower().EndsWith(".cs")) Then
            document.Activate()
            result = DTE.Find.FindReplace(vsFindAction.vsFindActionReplaceAll, ":Zs+$", vsFindOptions.vsFindOptionsRegularExpression, String.Empty, vsFindTarget.vsFindTargetCurrentDocument, , , vsFindResultsLocation.vsFindResultsNone)
            If result = vsFindResult.vsFindResultReplaced Then
                document.Save()
            End If
        End If
    Catch ex As Exception
        MsgBox(ex.Message & Chr(13) & "Document: " & document.FullName, MsgBoxStyle.OkOnly, "Trim White Space exception")
    End Try
End Sub 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-17T13:14:40.697

我使用[ArtisticStyle](http://astyle.sourceforge.net/) (C++) 来执行此操作并重新格式化我的代码。但是，我必须将其添加为外部工具，并且您需要自己触发它，因此您可能不喜欢它。

但是，我发现可以以更自定义的方式（例如，多行函数参数）重新格式化代码非常好，我可以付出手动运行它的代价。该工具是免费的。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2010-05-19T15:45:53.007

[建立在 Dyaus 的答案和连接报告](http://connect.microsoft.com/VisualStudio/feedback/details/386050/delete-trailing-white-spaces)中的正则表达式的基础上，这是一个处理全部保存的宏，不会用空格替换制表符，并且不需要静态变量。它可能的缺点？它似乎有点慢，可能是由于多次调用`FindReplace`.

```
Private Sub DocumentEvents_DocumentSaved(ByVal document As EnvDTE.Document) _
                                         Handles DocumentEvents.DocumentSaved
    Try
        ' Remove all the trailing whitespaces.
        If vsFindResult.vsFindResultReplaced = DTE.Find.FindReplace(vsFindAction.vsFindActionReplaceAll, _
                             "{:b}+$", _
                             vsFindOptions.vsFindOptionsRegularExpression, _
                             String.Empty, _
                             vsFindTarget.vsFindTargetFiles, _
                             document.FullName, , _
                             vsFindResultsLocation.vsFindResultsNone) Then
            document.Save()
        End If
    Catch ex As Exception
        MsgBox(ex.Message, MsgBoxStyle.OkOnly, "Trim White Space exception")
    End Try
End Sub 
```

对于尝试在 Visual Studio 2012 加载项中使用它的任何其他人，我最终使用的正则表达式是`[ \t]+(?=\r?$)`（如果必要，不要忘记转义反斜杠）。在几次徒劳地尝试解决与回车不匹配的[原始转换](http://msdn.microsoft.com/en-us/library/vstudio/2k3te2cs.aspx)问题后，我到达了这里。`{:b}+$`

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-04-25T07:01:20.213

我想我有这个宏的一个版本，它不会在重构时使 VS2010 崩溃，并且在保存非文本文件时也不会挂起 IDE。试试这个：

```
Private Sub DocumentEvents_DocumentSaved( _
    ByVal document As EnvDTE.Document) _
    Handles DocumentEvents.DocumentSaved
    ' See if we're saving a text file
    Dim textDocument As EnvDTE.TextDocument = _
        TryCast(document.Object(), EnvDTE.TextDocument)

    If textDocument IsNot Nothing Then
        ' Perform search/replace on the text document directly
        ' Convert tabs to spaces
        Dim convertedTabs = textDocument.ReplacePattern("\t", "    ", _
            vsFindOptions.vsFindOptionsRegularExpression)

        ' Remove trailing whitespace from each line
        Dim removedTrailingWS = textDocument.ReplacePattern(":Zs+$", "", _
            vsFindOptions.vsFindOptionsRegularExpression)

        ' Re-save the document if either replace was successful
        ' (NOTE: Should recurse only once; the searches will fail next time)
        If convertedTabs Or removedTrailingWS Then
            document.Save()
        End If
    End If
End Sub 
```

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2009-11-11T03:29:02.333

这是如何删除尾随空格的一个非常好的示例。根据我使用此宏的发现，我会更改一些内容。首先，宏自动将制表符转换为空格。这并不总是可取的，并且可能导致喜欢标签的人（通常基于 Linux）的情况变得更糟。无论如何，制表符问题与额外的空白问题并不完全相同。其次，宏假设一次只保存一个文件。如果您一次保存多个文件，将无法正确删除空格。原因很简单。当前文档被认为是您可以看到的文档。第三，它不对查找结果进行错误检查。这些结果可以更好地了解下一步该做什么。例如，如果没有找到并替换空格，无需再次保存文件。一般来说，我不喜欢是否需要保存全局标志。它倾向于根据未知状态自找麻烦。我怀疑添加标志只是为了防止无限循环。

```
 Private Sub DocumentEvents_DocumentSaved(ByVal document As EnvDTE.Document) _
                                         Handles DocumentEvents.DocumentSaved
    Dim result As vsFindResult
    'Dim nameresult As String

    Try
        document.Activate()

        ' Remove all the trailing whitespaces.
        result = DTE.Find.FindReplace(vsFindAction.vsFindActionReplaceAll, _
                             ":Zs+$", _
                             vsFindOptions.vsFindOptionsRegularExpression, _
                             String.Empty, _
                             vsFindTarget.vsFindTargetCurrentDocument, , , _
                             vsFindResultsLocation.vsFindResultsNone)

        'nameresult = document.Name & " " & Str$(result)

        'MsgBox(nameresult, , "Filename and result")

        If result = vsFindResult.vsFindResultReplaced Then
            'MsgBox("Document Saved", MsgBoxStyle.OkOnly, "Saved Macro")
            document.Save()
        Else
            'MsgBox("Document Not Saved", MsgBoxStyle.OkOnly, "Saved Macro")
        End If

    Catch ex As Exception
        MsgBox(ex.Message, MsgBoxStyle.OkOnly, "Trim White Space exception")
    End Try

End Sub 
```

我添加了调试消息框以帮助查看发生了什么。很明显，多个文件保存不起作用。如果您想和他们一起玩，请取消注释这些行。

关键区别在于使用 document.Activate() 强制文档进入前台活动当前文档。如果结果为 4，则表示文本已被替换。零表示什么都没发生。您将看到每个文件有两次保存。第一个将替换，第二个将什么也不做。如果保存无法写入文件，则可能会出现问题，但如果发生这种情况，希望不会调用此事件。

在原始脚本之前，我不知道脚本在 Visual Studio 中是如何工作的。它使用 Visual Basic 作为主界面有点令人惊讶，但它可以很好地完成它需要做的事情。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2010-03-10T07:31:06.213

一个简单的添加是在保存期间删除回车。

```
' Remove all the carriage returns.
result = DTE.Find.FindReplace(vsFindAction.vsFindActionReplaceAll, _
                             "\x000d\x000a", _
                             vsFindOptions.vsFindOptionsRegularExpression, _
                             "\x000a", _
                             vsFindTarget.vsFindTargetCurrentDocument, , , _
                             vsFindResultsLocation.vsFindResultsNone) 
```

这项工作的关键是将\x000d\x000a 更改为\x000a。\x 前缀表示 Unicode 模式。这将使为 Linux 系统准备好源文件的过程自动化。

# html - 内嵌显示的块在IE中形成一个单词

> ID：82981
> 
> 赞同：1
> 
> 时间：2008-09-17T13:10:47.443
> 
> 标签：html, css, internet-explorer

问题是我有几个具有`display:inline`属性的“h2”标签，而在微软出色的浏览器上，它们之间的空格不会出现。有解决方法吗？

我知道 HTML 中有一个“非中断空间” `&nbsp;`，但我想知道是否可以创建一个可能是“中断空间”的空间。

- - 编辑 - -

该网站是[http://newstoday.ro](http://newstoday.ro)，行为在页脚中。如果站点在 IE 中打开，则列表是连续的，即使单词之间有空格。请不要评论其余代码，因为我只是这种情况下的管道工。标题也必须是必要的，因为客户认为这对 SEO 更好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T18:57:07.080

我想不出你为什么希望 h2 内联显示的理由。事实上，为什么要两个标题一起阅读？想想应该如何阅读它。你想让它阅读：

“标题一标题二”

或者：

“标题一”

“标题二”

如果是第一种方式，那么很可能是你的 HTML 搞砸了。如果是第二个，那么您可能应该考虑它的定位而不是改变它的行为并利用其他 css 方法，如 float 和 position。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T13:12:53.727

您可以只使用常规空格，但在 h2 css 定义中添加“margin-right:_ px”以调整标签之间的间距。也允许负值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T13:14:24.940

您是否尝试过设置“边距”属性？不确定这是否直接适用于您的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T13:15:10.773

抛出一个   在那里似乎创造了一个空间：

```
<html>
    <head><title>Blah</title></head>
    <body>
        <h2 style="display:inline;">Something</h2>
        &nbsp;
        <h2 style="display:inline;">Something Else</h2>
    </body>
</html> 
```

在此示例中，您实际上以 2 个空格结束，因此您可能希望消除标签和   之间的空格。如果您只需要一个空间。另一种选择是为标题元素添加左/右边距。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T13:38:49.640

将样式`margin: 0 0.5em`应用于两个标题 - 调整 0.5 以适应（也许 0.25 或 0.75 更好；第一个 0 也是顶部/底部边距，根据相关调整）。

注意：由于您想要一个字符空间，因此您`em`不需要`px`像前面建议的那样。

完整的示例代码...

```
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/> 
        <title>Inline Header Example</title>
        <style type="text/css">
            h2
            {
                display: inline;
                margin: 0 0.5em;
            }
        </style>
    </head>
    <body>
        <h2>First Header</h2>
        <h2>Second Header</h2>
    </body>
</html> 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-09-17T13:12:59.420

好吧，制动空间只是一个空间，你知道没有引号的“”......

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-09-17T17:55:59.397

答案是不可能的。您的意思是您希望较大文本块中的文本像其余部分一样流动，就好像标签是 <strong> 而不是 <h2>

由于 h2 是一个块级元素，无论您如何设置它，一些浏览器（*咳嗽*）都会阻止您尝试将其与其他文本内联。

# c++ - Windows CD 刻录 API

> ID：82993
> 
> 赞同：12
> 
> 时间：2008-09-17T13:12:02.387
> 
> 标签：c++, c, windows, cd-burning

我们需要在使用 Borlands Turbo C++ 开发的 C\C++ Windows XP/Vista 应用程序中以编程方式将文件刻录到 CD。

最简单和最好的方法是什么？我们更喜欢本机 Windows API（不依赖于 MFC），以便不依赖任何第三方软件/驱动程序（如果可用）。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-17T16:42:23.147

我们使用了以下内容：

将文件存储在 GetBurnPath 返回的目录中，然后使用 Burn 进行写入。GetCDRecordableInfo 用于检查 CD 何时准备就绪。

```
#include <stdio.h>
#include <imapi.h>
#include <windows.h>

struct MEDIAINFO {
    BYTE nSessions;
    BYTE nLastTrack;
    ULONG nStartAddress;
    ULONG nNextWritable;
    ULONG nFreeBlocks;
};
//==============================================================================
//  Description:    CD burning on Windows XP
//==============================================================================
#define CSIDL_CDBURN_AREA               0x003b
SHSTDAPI_(BOOL) SHGetSpecialFolderPathA(HWND hwnd, LPSTR pszPath, int csidl, BOOL fCreate);
SHSTDAPI_(BOOL) SHGetSpecialFolderPathW(HWND hwnd, LPWSTR pszPath, int csidl, BOOL fCreate);
#ifdef UNICODE
#define SHGetSpecialFolderPath  SHGetSpecialFolderPathW
#else
#define SHGetSpecialFolderPath  SHGetSpecialFolderPathA
#endif
//==============================================================================
// Interface IDiscMaster
const IID IID_IDiscMaster = {0x520CCA62,0x51A5,0x11D3,{0x91,0x44,0x00,0x10,0x4B,0xA1,0x1C,0x5E}};
const CLSID CLSID_MSDiscMasterObj = {0x520CCA63,0x51A5,0x11D3,{0x91,0x44,0x00,0x10,0x4B,0xA1,0x1C,0x5E}};

typedef interface ICDBurn ICDBurn;
// Interface ICDBurn
const IID IID_ICDBurn =    {0x3d73a659,0xe5d0,0x4d42,{0xaf,0xc0,0x51,0x21,0xba,0x42,0x5c,0x8d}};
const CLSID CLSID_CDBurn = {0xfbeb8a05,0xbeee,0x4442,{0x80,0x4e,0x40,0x9d,0x6c,0x45,0x15,0xe9}};

MIDL_INTERFACE("3d73a659-e5d0-4d42-afc0-5121ba425c8d")
ICDBurn : public IUnknown
{
public:
    virtual HRESULT STDMETHODCALLTYPE GetRecorderDriveLetter(
        /* [size_is][out] */ LPWSTR pszDrive,
        /* [in] */ UINT cch) = 0;

    virtual HRESULT STDMETHODCALLTYPE Burn(
        /* [in] */ HWND hwnd) = 0;

    virtual HRESULT STDMETHODCALLTYPE HasRecordableDrive(
        /* [out] */ BOOL *pfHasRecorder) = 0;
};
//==============================================================================
//  Description:    Get burn pathname
//  Parameters:     pathname - must be at least MAX_PATH in size
//  Returns:        Non-zero for an error
//  Notes:          CoInitialize(0) must be called once in application
//==============================================================================
int GetBurnPath(char *path)
{
    ICDBurn* pICDBurn;
    int ret = 0;

    if (SUCCEEDED(CoCreateInstance(CLSID_CDBurn, NULL,CLSCTX_INPROC_SERVER,IID_ICDBurn,(LPVOID*)&pICDBurn))) {
        BOOL flag;
        if (pICDBurn->HasRecordableDrive(&flag) == S_OK) {
            if (SHGetSpecialFolderPath(0, path, CSIDL_CDBURN_AREA, 0)) {
                strcat(path, "\\");
            }
            else {
                ret = 1;
            }
        }
        else {
            ret = 2;
        }
        pICDBurn->Release();
    }
    else {
        ret = 3;
    }
    return ret;
}
//==============================================================================
//  Description:    Get CD pathname
//  Parameters:     pathname - must be at least 5 bytes in size
//  Returns:        Non-zero for an error
//  Notes:          CoInitialize(0) must be called once in application
//==============================================================================
int GetCDPath(char *path)
{
    ICDBurn* pICDBurn;
    int ret = 0;

    if (SUCCEEDED(CoCreateInstance(CLSID_CDBurn, NULL,CLSCTX_INPROC_SERVER,IID_ICDBurn,(LPVOID*)&pICDBurn))) {
        BOOL flag;
        WCHAR drive[5];
        if (pICDBurn->GetRecorderDriveLetter(drive, 4) == S_OK) {
            sprintf(path, "%S", drive);
        }
        else {
            ret = 1;
        }
        pICDBurn->Release();
    }
    else {
        ret = 3;
    }
    return ret;
}
//==============================================================================
//  Description:    Burn CD
//  Parameters:     None
//  Returns:        Non-zero for an error
//  Notes:          CoInitialize(0) must be called once in application
//==============================================================================
int Burn(void)
{
    ICDBurn* pICDBurn;
    int ret = 0;

    if (SUCCEEDED(CoCreateInstance(CLSID_CDBurn, NULL,CLSCTX_INPROC_SERVER,IID_ICDBurn,(LPVOID*)&pICDBurn))) {
        if (pICDBurn->Burn(NULL) != S_OK) {
            ret = 1;
        }
        pICDBurn->Release();
    }
    else {
        ret = 2;
    }
    return ret;
}
//==============================================================================
bool GetCDRecordableInfo(long *FreeSpaceSize)
{
    bool Result = false;
    IDiscMaster *idm = NULL;
    IDiscRecorder *idr = NULL;
    IEnumDiscRecorders *pEnumDiscRecorders = NULL;
    ULONG cnt;
    long type;
    long mtype;
    long mflags;
    MEDIAINFO mi;

    try {
        CoCreateInstance(CLSID_MSDiscMasterObj, 0, CLSCTX_ALL, IID_IDiscMaster, (void**)&idm);
        idm->Open();
        idm->EnumDiscRecorders(&pEnumDiscRecorders);
        pEnumDiscRecorders->Next(1, &idr, &cnt);
        pEnumDiscRecorders->Release();

        idr->OpenExclusive();
        idr->GetRecorderType(&type);
        idr->QueryMediaType(&mtype, &mflags);
        idr->QueryMediaInfo(&mi.nSessions, &mi.nLastTrack, &mi.nStartAddress, &mi.nNextWritable, &mi.nFreeBlocks);
        idr->Release();

        idm->Close();
        idm->Release();
        Result = true;
    }
    catch (...) {
        Result = false;
    }

    if (Result == true) {
        Result = false;
        if (mtype == 0) {
            //  No Media inserted
            Result = false;
        }
        else {
            if ((mflags & 0x04) == 0x04) {
                // Writable Media
                Result = true;
            }
            else {
                Result = false;
            }

            if (Result == true) {
                *FreeSpaceSize = (mi.nFreeBlocks * 2048);
            }
            else {
                *FreeSpaceSize = 0;
            }
        }
    }

    return Result;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-19T14:17:10.190

为了补充接受的答案，我们添加了这个帮助函数来以编程方式即时更改刻录目录，因为这是我们的要求。

```
typedef HMODULE (WINAPI * SHSETFOLDERPATHA)( int , HANDLE , DWORD , LPCTSTR );

int SetBurnPath( char * cpPath )
{
    SHSETFOLDERPATHA pSHSetFolderPath;
    HANDLE hShell = LoadLibraryA( "shell32.dll" );
    if( hShell == NULL )
        return -2;

    DWORD dwOrdinal = 0x00000000 + 231;

    pSHSetFolderPath = (SHSETFOLDERPATHA)GetProcAddress( hShell, (LPCSTR)dwOrdinal );
    if( pSHSetFolderPath == NULL )
        return -3;

    if( pSHSetFolderPath( CSIDL_CDBURN_AREA, NULL, 0, cpPath ) == S_OK )
        return 0;

    return -1;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T19:21:42.233

这是 MSDN 站点[http://msdn.microsoft.com/en-us/library/aa939967.aspx中 IMAPI 的信息](http://msdn.microsoft.com/en-us/library/aa939967.aspx)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-09-17T13:31:44.867

您应该能够使用 shell 的 ICDBurn 接口。早在 XP 时代，MFC 甚至没有任何用于 cd 刻录的课程。我会看看是否可以为您找到一些示例，但是我已经有一段时间没有看到这个了。**************`*