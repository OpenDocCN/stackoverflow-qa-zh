# StackOverflow 问答 000596000-000596999

# c# - 使不可为空的值类型可以为空

> ID：596003
> 
> 赞同：23
> 
> 时间：2009-02-27T18:32:34.257
> 
> 标签：c#, .net-3.5, non-nullable

我有一个使用有限的简单结构。该结构是在从数据库调用数据的方法中创建的。如果没有从数据库返回的数据，我希望能够返回 null，但 Visual Studio 抱怨，无法将 null 转换为 PackageName.StructName，因为它是不可为 null 的值类型。

我怎样才能使它可以为空？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-27T18:34:03.907

您想查看[`Nullable<T>`](http://blogs.msdn.com/ericgu/archive/2004/05/27/143221.aspx)值类型。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-27T18:37:25.117

```
public struct Something
{
    //...
}

public static Something GetSomethingSomehow()
{
    Something? data = MaybeGetSomethingFrom(theDatabase);
    bool questionMarkMeansNullable = (data == null);
    return data ?? Something.DefaultValue;
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-27T18:42:00.910

结构的定义`Nullable<T>`是：

```
struct Nullable<T>
{
    public bool HasValue;
    public T Value;
} 
```

它以这种方式创建：

```
Nullable<PackageName.StructName> nullableStruct = new Nullable<PackageName.StructName>(params); 
```

您可以通过简单地键入以下内容来简化这种混乱：

```
PackageName.StructName? nullableStruct  = new PackageName.StructName(params); 
```

参见：[MSDN](http://msdn.microsoft.com/en-us/library/b3h38hb0.aspx)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-27T18:38:41.883

[`Nullable<T>`](http://blogs.msdn.com/ericgu/archive/2004/05/27/143221.aspx)是一个包装类，它创建类型 T 的可为空版本。您还可以使用语法 T? (例如 int?) 来表示类型 T 的可空版本。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-05-09T07:18:41.653

通过简单地添加到声明中，使用结构的内置*快捷方式：*`Nullable<T>``?`

```
int? x = null;

if (x == null) { ... } 
```

对于任何其他类型、结构等都是一样的。

```
MyStruct? myNullableStruct = new MyStruct(params); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-20T01:04:45.527

您可以使某些东西可以为空，例如：

```
// Create the nullable object.
int? value = new int?();

// Check for if the object is null.
if(value == null)
{
    // Your code goes here.
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-05-16T05:48:18.837

您可以使用**默认值**作为替代

```
public struct VelocityRange
{
    private double myLowerVelocityLimit;
    private double myUpperVelocityLimit;
} 
```

VelocityRange velocityRange =**默认值**(VelocityRange);

# security - Websphere 共享库和 Java 2 安全性

> ID：596004
> 
> 赞同：1
> 
> 时间：2009-02-27T18:32:39.247
> 
> 标签：security, websphere, shared

我创建了一个 jar 文件来加载本机库（使用 System.loadlibrary()）并将其配置为 WebSphere（v6.1）中的共享库。服务器**必须**在启用 Java 2 的情况下运行（这是法律……）

当我尝试访问该库时，我可以看到正在从我的 jar 文件中加载正确的类，但是尝试加载本机库时会出现以下安全异常：-

```
允许：

      loadLibrary.gbif : 拒绝访问 (java.lang.RuntimePermission loadLibrary.gbif)

代码：

     com.dave.nativelibrary.NativeLibraryLoader 在 {file:/hosting/apps/D03-dave-dev/lib/NativeLibraryLoader.jar}

堆栈跟踪：

java.security.AccessControlException：访问被拒绝（java.lang.RuntimePermission loadLibrary.gbif）
    在 java.security.AccessController.checkPermission(AccessController.java:104)
    在 java.lang.SecurityManager.checkPermission(SecurityManager.java:547)
    在 com.ibm.ws.security.core.SecurityManager.checkPermission(SecurityManager.java:189)
    在 java.lang.SecurityManager.checkLink(SecurityManager.java:833)
    在 java.lang.ClassLoader.loadLibraryWithClassLoader(ClassLoader.java:917)
    在 java.lang.System.loadLibrary(System.java:453)
    在 com.dave.nativelibrary.NativeLibraryLoader.(NativeLibraryLoader.java:21)

```

--- 剪断 ---

我不太确定自己在做什么——所以我尝试了几次将以下内容放入我的 was.policy 文件中

权限 java.lang.RuntimePermission "loadLibrary.gbif";

我在应用程序和 jars 部分都尝试过，但没有任何有益效果。

任何人都可以阐明我需要在这里做什么吗？

谢谢

戴夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-19T10:55:44.503

而不是将您的本机库包装在 jar 库中。您是否尝试过将本机代码定义为 websphere 内的共享本机库？

# sql - 存储过程的 Sql 聚合结果

> ID：596010
> 
> 赞同：1
> 
> 时间：2009-02-27T18:33:51.990
> 
> 标签：sql, stored-procedures, aggregate

我目前有一个存储过程，它返回一个帐号和相关详细信息的列表。结果集可能包含同一帐号的多个条目。我还想获得一些汇总信息，例如特定结果集中包含多少不同的帐户。有没有办法从我的存储过程结果中检索这样的视图，例如

```
SELECT AccountNumber, Count(*) 
FROM mystoredproc_sp 
GROUP BY AccountNumber 
```

如果它需要包含在另一个存储过程中很好，但我希望至少能够从第一个 SP 中已经存在的逻辑中受益，而无需复制其大部分代码。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-27T18:40:25.033

```
DECLARE @tt TABLE (acc INTEGER)
INSERT INTO @tt EXECUTE mystoredproc_sp
SELECT acc, COUNT(*) FROM @tt GROUP BY acc 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-27T18:38:44.130

您必须将查询移动到表值函数中，并从两个存储过程（旧的和新的）中调用它。这样，您只需在一个地方进行查询。无法从存储过程结果集中进行选择。

# entity-framework - 实体框架 - 仅更新数据表列字段的第一个字符

> ID：596015
> 
> 赞同：1
> 
> 时间：2009-02-27T18:35:03.797
> 
> 标签：entity-framework, entity

我最近才使用 EF，只是因为我认为以这种方式拥有 DAL 更简单、更快捷……但这对 ....s 来说很痛苦

解决严重问题后，我无法从 sql 数据库中的表中成功更新数据。

我有一个 aspx 表单，可以编辑实体对象（System.Data.Objects.DataClasses.EntityObject）中的一些字段，然后我调用 EntitiesContext.SaveChanges()...它实际上保存了更改。但是以错误的方式。

例如，如果格式具有以下数据：名称：abcd 编号：1234

保存的数据将是 Name:a Number:1

请不要向我发送我已经看过的所有初学者文档！是的...我已经创建了 Store 过程，并且我已经多次重新创建了 .edmx！

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T18:38:40.230

您的存储过程是否有可能引入只有 1 个字符长的参数？我不做任何 EF 工作，但我过去遇到过一些问题，我会不小心在存储过程中声明错误的参数，并且它只能处理尽可能多的数据，以适应错误声明的参数。

# javascript - JavaScript 备忘单

> ID：596017
> 
> 赞同：14
> 
> 时间：2009-02-27T18:35:45.713
> 
> 标签：javascript

我正在寻找 JavaScript 的参考卡 - 例如语法和方法参数的摘要。谷歌给了我很多选择。什么是好的？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-27T18:43:03.933

实际上，我使用的是谷歌搜索中的第一个命中 -[添加字节备忘单](http://www.addedbytes.com/cheat-sheets/javascript-cheat-sheet/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T18:45:03.913

Danny Goodman 的[JavaScript 和浏览器对象快速参考](http://www.dannyg.com/dl/JSB6RefBooklet.pdf)非常有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T19:31:31.913

[Devguru](http://www.devguru.com/Technologies/ecmascript/quickref/javascript_intro.html)是一个非常好的工具，我在有疑问时会使用它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-06-30T06:25:45.863

如果您不介意花一点钱 VisiBone 产品非常物有所值！

[VisiBone Javascript](http://www.visibone.com/javascript/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T18:44:36.083

对于基本的东西，我推荐[W3Schools](http://www.w3schools.com/JS/default.asp)。这不是很好，但它是一个好的开始。对于高级的东西，我推荐[Mozilla 文档](https://developer.mozilla.org/en/JavaScript)。对于动态原型设计，我推荐使用[JavaScript Shell](http://www.squarefree.com/shell/)，它可以让您通过`props(object)`显示对象具有的属性（字段、方法）之类的操作来测试可用的方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-27T18:45:29.527

就个人而言，我喜欢[O'Reilly 的袖珍参考书](https://rads.stackoverflow.com/amzn/click/com/0596004117 "Javascript袖珍参考")，它们很便宜，而且随处都能派上用场。

[但是，如果你在网上寻找东西，我通常会在w3schools](http://www.w3schools.com/js/default.asp "w3schools")上找到很多好的基本 javascript（和 HTML/CSS/等）东西。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-02-11T14:25:55.407

[您可以在TechPosters](http://techposters.net/blog/javascript/)网站上找到很多 JavaScript 备忘单。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-07-31T12:35:10.200

这是新的，但非常好：[Encycode JavaScript Cheat Sheet](http://encycode.com/wiki/index.php/JavaScript_Cheat_Sheet)

# asp.net - VS 2005 网站项目模板的烦恼

> ID：596023
> 
> 赞同：1
> 
> 时间：2009-02-27T18:36:32.107
> 
> 标签：asp.net, controls, registration

我最近继承了一个使用“网站项目模板”完成的项目（顺便说一句，我讨厌它）。我一直使用我喜欢的“Web 应用程序模板”。不过，我对在项目中发现的一些东西感到困惑。在所有页面中都有自定义控件实例，如下所示：

```
<cc1:MarketingItem runat="server" ID="BannerAd" /> 
```

没有什么太花哨的，对吧？真正让我恼火的是，它工作得很好，没有任何“cc1”页面顶部的控制注册标签或它背后的代码只是魔术！正如您可以想象的那样，这使得追踪这些控件的位置变得更加工作，坦率地说是一种痛苦。我的问题是这怎么可能？为什么微软会在这个项目模板中引入如此令人讨厌的不一致？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T18:42:04.670

您可能会发现它已在 web.config 中注册（我相信是 system.web>pages>controls）。您可以像在页面上一样在此处全局注册控件。

```
<pages>
  <controls>
    <add tagPrefix="asp" namespace="System.Web.UI" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
    <add tagPrefix="asp" namespace="System.Web.UI.WebControls" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
  </controls>
</pages> 
```

# macos - 使用单个提供程序名称为插件创建 dtrace 探针

> ID：596028
> 
> 赞同：0
> 
> 时间：2009-02-27T18:37:39.813
> 
> 标签：macos, plugins, dtrace

请注意，这是针对 Mac OS X 的，尽管我想我的问题会存在于任何支持 dtrace 的操作系统上。

我有一个使用很多插件的应用程序。我在核心应用程序和插件本身中都添加了用户态探测器。问题是，如果我在主应用程序使用的插件中使用相同的提供程序名称，则当我尝试创建可用探针列表时，这些探针不会显示。似乎谁的代码先加载谁就赢了。

我的主应用程序中的 .d 文件：

```
provider MyApp {
    probe doSomething();
}; 
```

在我的插件中：

```
provider MyApp {
    probe plugin_doSomethingPluginish();
}; 
```

将提供程序的名称更改为其他名称（例如 MyAppPlugin）可以正常工作，但随后提供程序的列表将变得疯狂（MyAppPlugin1、MyAppPlugin2 等）。我想有一种方法可以在与主应用程序相同的提供程序名称下添加新的插件定义的探针，但我要么没有看到它，要么它不存在。

那么有没有办法做到这一点？如果不是，即使模块名称已经是唯一的，为每个插件提供不同的提供程序是否正常？似乎这就是模块名称的用途......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-27T21:01:23.837

您应该只定义一个 provider.d 文件，然后使用这些探测器中的任何一个将 .h 文件导入每个类，实际上没有理由执行多个 .d 文件，每个文件都列出相同的提供者。我刚刚检查了有关此的 DTrace 文档，并没有立即看到任何有关它的信息，但是是的，我认为多个 .d 文件每个都定义相同的提供程序会产生某种冲突，或者加载相同的探针列表provider 就像重新定义探测列表，而不是按照您的预期扩展它。

# serial-port - Compact Framework 串口 开放功能

> ID：596035
> 
> 赞同：0
> 
> 时间：2009-02-27T18:38:45.817
> 
> 标签：serial-port, compact-framework

有没有办法判断串口是否打开成功？问题是如果串口没有打开，不会抛出异常，用户也无法知道问题出在哪里。

有输入吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T18:44:41.527

System.IO.Ports.SerialPort.IsOpen 属性告诉您这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T19:27:36.370

您可以尝试[共享源代码 OpenNETCF 串行端口实现](http://opennetcf.com/FreeSoftware/OpenNETCFIOSerial/tabid/252/Default.aspx)。至少通过这种方式，如果它没有做你想做的事情，你就有改变行为的来源，而且它是接口兼容的。

# reporting-services - 您如何从单个数据集中获取记录以显示在横向页面的 4 个角上？[SSRS]

> ID：596041
> 
> 赞同：4
> 
> 时间：2009-02-27T18:40:45.670
> 
> 标签：reporting-services

我正在使用 Microsoft SQL Server 报告服务 2005

我有一份报告，打印时我想在横向页面的 4 个角中的每一个中显示一条记录。

我正在使用一个数据集，它返回 1 到许多记录。

如何使用表格或矩阵完成此操作？

例如，如果我的数据集中有 6 条记录：

第 1 页

```
|---------------------|
| record 1 | record 2 |
|---------------------|
| record 3 | record 4 |
|---------------------| 
```

第2页

```
|---------------------|
| record 5 | record 6 |
|---------------------|
| [empty]  | [empty]  |
|---------------------| 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T19:33:54.560

所以我找到了一种成功的方法（在 cdonner 的建议的帮助下），有 2 个相同的表格模板，一个显示所有奇数记录，另一个显示所有偶数记录。

这是设计模式的样子：

```
|-------------------|
| table 1 | table 2 |
|-------------------| 
```

然后，我所做的是在每个表的每个 tablerow 上将表达式添加到 tablerow 的 Visibility > Hidden**属性**：

对于奇数行：

```
=RowNumber(Nothing) Mod 2 = 0 
```

对于偶数行：

```
=RowNumber(Nothing) Mod 2 = 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T18:50:33.230

我能想到的唯一方法是使用子报表，一个显示所有偶数行，另一个显示所有奇数行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-13T00:57:28.747

要将组添加到 Jon 的答案中，请将表 1 和 2 放在执行分组的父表中：

```
table-parent
    group-row-header // header text..?
    group-row-footer // group name is important for below
        rectangle
            table-child-1 | table-child-2 | etc  // =RowNumber("my-group-name") 
```

注意 RowNumber 必须基于组，以便它在每个循环中重置。

# c# - 使用 JavaWS 服务时，您可以查看 .NET 生成的 XML 吗？

> ID：596043
> 
> 赞同：0
> 
> 时间：2009-02-27T18:40:59.307
> 
> 标签：c#, java, xml, asp.net-2.0, java-ws

如何查看从基于 C# 的 ASP.NET 页面发送到 Java Web 服务的 XML？

我已经从我的 Java WSDL 在 .NET 中创建了一个迪斯科对象 web ref，但是当我使用 Fiddler 之类的工具查看附加到 HTTP 请求的 XML 时，我看到的是正在传递的表单参数。有没有办法可以查看序列化的 XML？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T18:48:31.907

至少，您可以使用 Ethereal/Wireshark 等数据包嗅探器查看 HTTP 请求和响应。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T18:56:06.647

使用来自 Apache 的[tcpmon](http://ws.apache.org/commons/tcpmon/)，它可以拦截流量并将其重定向到另一个主机/端口。

您在端口 A 上设置了一个侦听器，所有流量都转发到主机/端口 B。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-28T17:30:25.333

或者，您可以使用 XmlSerializer 并将您将要传递的对象实例序列化到磁盘，例如。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T18:54:08.790

只是一个想法。我确信这不是最好的方法，但我想它会起作用。这个想法是注入一个响应过滤器并覆盖 write 方法以记录从 ASP.NET 页面生成的所有输出。要了解如何编写 ASP.NET 过滤器，请查看这篇文章：

[http://www.highoncoding.com/Articles/468_Protecting_Email_Addresses_Using_Response_Filters.aspx](http://www.highoncoding.com/Articles/468_Protecting_Email_Addresses_Using_Response_Filters.aspx)

# delphi - 使用字段配置复制 TClientDataSet 内容

> ID：596045
> 
> 赞同：0
> 
> 时间：2009-02-27T18:41:03.500
> 
> 标签：delphi, delphi-7, dataset

我想将整个 TClientDataSet 实例复制到另一个实例中，这样我就可以恢复对原始实例所做的任何更改。我尝试 saveToStream 来复制数据属性，但在所有情况下我都会丢失字段配置（displayLabel、大小等）

有没有办法做我正在尝试的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T18:48:45.307

Delphi 只会流式传输已发布的属性。您可能需要稍微调整一下才能正确取出和恢复所有内容。有关挂钩的示例，请参见[http://www.delphipages.com/news/detaildocs.cfm?ID=145 。](http://www.delphipages.com/news/detaildocs.cfm?ID=145)

——马库斯

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-11T21:44:31.823

这应该有效：

DestClientDataSet.Data := SrcClientDataSet.Data;

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-08T19:10:18.113

你试过 [TClientdataset.Clonecursor](http://codegearguru.com/index.php?option=com_content&task=view&id=82&Itemid=27)吗？

# wcf - Silverlight Combobox 数据绑定竞争条件

> ID：596047
> 
> 赞同：6
> 
> 时间：2009-02-27T18:41:21.957
> 
> 标签：wcf, silverlight, data-binding, silverlight-2.0

在我开发一个漂亮的数据驱动的 Silverlight 应用程序的过程中，我似乎不断地遇到某种需要解决的竞争条件。最新的如下。任何帮助，将不胜感激。

后端有两张表：一张是组件，一张是制造商。每个组件都有一个制造商。根本不是不寻常的外键查找关系。

我 Silverlight，我通过 WCF 服务访问数据。我将调用 Components_Get(id) 以获取当前组件（以查看或编辑）并调用 Manufacturers_GetAll() 以获取制造商的完整列表以填充 ComboBox 的可能选择。然后，我将 ComboBox 上的 SelectedItem 绑定到当前组件的制造商，并将 ComboBox 上的 ItemSource 绑定到可能的制造商列表。像这样：

```
<UserControl.Resources>
    <data:WebServiceDataManager x:Key="WebService" />
</UserControl.Resources>
<Grid DataContext={Binding Components.Current, mode=OneWay, Source={StaticResource WebService}}>
    <ComboBox Grid.Row="2" Grid.Column="2" Style="{StaticResource ComboBoxStyle}" Margin="3"
              ItemsSource="{Binding Manufacturers.All, Mode=OneWay, Source={StaticResource WebService}}" 
              SelectedItem="{Binding Manufacturer, Mode=TwoWay}"  >
        <ComboBox.ItemTemplate>
            <DataTemplate>
                <Grid>
                    <TextBlock Text="{Binding Name}" Style="{StaticResource DefaultTextStyle}"/>
                </Grid>
            </DataTemplate>
        </ComboBox.ItemTemplate>
    </ComboBox>
</Grid> 
```

这在很长一段时间内都非常有效，直到我变得聪明并且对组件进行了一点客户端缓存（我也计划为制造商打开它）。当我为组件打开缓存并且缓存命中时，所有数据都将正确地存在于对象中，但 SelectedItem 将无法绑定。这样做的原因是，Silverlight 中的调用是异步的，并且由于缓存的好处，组件不会在制造商之前返回。因此，当 SelectedItem 尝试在 ItemsSource 列表中查找 Components.Current.Manufacturer 时，它不存在，因为该列表仍然为空，因为 Manufacturers.All 尚未从 WCF 服务加载。同样，如果我关闭组件缓存，它会再次工作，但这感觉是错误的——就像我很幸运时机已经成熟一样。恕我直言，正确的修复是让 MS 修复 ComboBox/ItemsControl 控件，以了解这将在异步调用成为常态的情况下发生。但在那之前，我需要一种方法来修复它......

以下是我想到的一些选项：

1.  消除缓存或全面打开它以再次掩盖问题。不好恕我直言，因为这将再次失败。不太愿意把它扫回地毯下。
2.  创建一个可以为我进行同步的中间对象（应该在 ItemsControl 本身中完成）。它会接受 Item 和 ItemsList ，然后在两者都到达时输出 ItemWithItemsList 属性。我会将 ComboBox 绑定到结果输出，以便它永远不会先获得一个项目。我的问题是这看起来很痛苦，但它可以确保比赛条件不会再次发生。

有什么想法/意见吗？

FWIW：我将在这里发布我的解决方案以造福他人。

@Joe：非常感谢您的回复。我知道只需要从 UI 线程更新 UI。这是我的理解，我想我已经通过调试器确认了这一点，在 SL2 中，服务参考生成的代码会为您处理这个问题。即，当我调用 Manufacturers_GetAll_Asynch() 时，我通过 Manufacturers_GetAll_Completed 事件获得结果。如果您查看生成的服务参考代码，它会确保从 UI 线程调用 *Completed 事件处理程序。我的问题不是这个，而是我做了两个不同的调用（一个用于制造商列表，一个用于引用制造商 ID 的组件），然后将这两个结果绑定到一个 ComboBox。它们都绑定在 UI 线程上，问题是如果列表在选择之前没有到达那里，

[另请注意，如果您只是将 ItemSource 和 SelectedItem 设置为错误的顺序](http://brantob.wordpress.com/2008/10/09/silverlight-2-combo-box-binding-sublety/)，这仍然是一个问题！

另一个更新：虽然仍然存在组合框竞争条件，但我发现了其他有趣的东西。您**永远不**应该从该属性的“getter”中生成 PropertyChanged 事件。示例：在我的 ManufacturerData 类型的 SL 数据对象中，我有一个名为“All”的属性。在 Get{} 中，它会检查它是否已加载，如果没有，它会像这样加载它：

```
public class ManufacturersData : DataServiceAccessbase
{
    public ObservableCollection<Web.Manufacturer> All
    {
        get
        {
            if (!AllLoaded)
                LoadAllManufacturersAsync();
            return mAll;
        }
        private set
        {
            mAll = value;
            OnPropertyChanged("All");
        }
    }

    private void LoadAllManufacturersAsync()
    {
        if (!mCurrentlyLoadingAll)
        {
            mCurrentlyLoadingAll = true;

            // check to see if this component is loaded in local Isolated Storage, if not get it from the webservice
            ObservableCollection<Web.Manufacturer> all = IsoStorageManager.GetDataTransferObjectFromCache<ObservableCollection<Web.Manufacturer>>(mAllManufacturersIsoStoreFilename);
            if (null != all)
            {
                UpdateAll(all);
                mCurrentlyLoadingAll = false;
            }
            else
            {
                Web.SystemBuilderClient sbc = GetSystemBuilderClient();
                sbc.Manufacturers_GetAllCompleted += new EventHandler<hookitupright.com.silverlight.data.Web.Manufacturers_GetAllCompletedEventArgs>(sbc_Manufacturers_GetAllCompleted);
                sbc.Manufacturers_GetAllAsync(); ;
            }
        }
    }
    private void UpdateAll(ObservableCollection<Web.Manufacturer> all)
    {
       All = all;
       AllLoaded = true;
    }
    private void sbc_Manufacturers_GetAllCompleted(object sender, hookitupright.com.silverlight.data.Web.Manufacturers_GetAllCompletedEventArgs e)
    {
        if (e.Error == null)
        {
            UpdateAll(e.Result.Records);
            IsoStorageManager.CacheDataTransferObject<ObservableCollection<Web.Manufacturer>>(e.Result.Records, mAllManufacturersIsoStoreFilename);
        }
        else
            OnWebServiceError(e.Error);
        mCurrentlyLoadingAll = false;
    }

} 
```

请注意，此代码在“缓存命中”时**失败**，因为它将在 All { Get {}} 方法中为“All”生成 PropertyChanged 事件，这通常会导致绑定系统再次调用 All {get{}}。 .我从 ScottGu 的博客中复制了这种创建可绑定的 silverlight 数据对象的模式，它总体上对我很有帮助，但是像这样的东西让它变得非常棘手。幸运的是，修复很简单。希望这对其他人有帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-02T21:45:34.610

好的，我找到了答案（使用大量 Reflector 来弄清楚 ComboBox 的工作原理）。

在设置 SelectedItem 后设置 ItemSource 时存在问题。发生这种情况时，组合框将其视为选择的完全重置并清除 SelectedItem/SelectedIndex。您可以在 System.Windows.Controls.Primitives.Selector（ComboBox 的基类）中看到这一点：

```
protected override void OnItemsChanged(NotifyCollectionChangedEventArgs e)
{
    base.OnItemsChanged(e);
    int selectedIndex = this.SelectedIndex;
    bool flag = this.IsInit && this._initializingData.IsIndexSet;
    switch (e.Action)
    {
        case NotifyCollectionChangedAction.Add:
            if (!this.AddedWithSelectionSet(e.NewStartingIndex, e.NewStartingIndex + e.NewItems.Count))
            {
                if ((e.NewStartingIndex <= selectedIndex) && !flag)
                {
                    this._processingSelectionPropertyChange = true;
                    this.SelectedIndex += e.NewItems.Count;
                    this._processingSelectionPropertyChange = false;
                }
                if (e.NewStartingIndex > this._focusedIndex)
                {
                    return;
                }
                this.SetFocusedItem(this._focusedIndex + e.NewItems.Count, false);
            }
            return;

        case NotifyCollectionChangedAction.Remove:
            if (((e.OldStartingIndex > selectedIndex) || (selectedIndex >= (e.OldStartingIndex + e.OldItems.Count))) && (e.OldStartingIndex < selectedIndex))
            {
                this._processingSelectionPropertyChange = true;
                this.SelectedIndex -= e.OldItems.Count;
                this._processingSelectionPropertyChange = false;
            }
            if ((e.OldStartingIndex <= this._focusedIndex) && (this._focusedIndex < (e.OldStartingIndex + e.OldItems.Count)))
            {
                this.SetFocusedItem(-1, false);
                return;
            }
            if (e.OldStartingIndex < selectedIndex)
            {
                this.SetFocusedItem(this._focusedIndex - e.OldItems.Count, false);
            }
            return;

        case NotifyCollectionChangedAction.Replace:
            if (!this.AddedWithSelectionSet(e.NewStartingIndex, e.NewStartingIndex + e.NewItems.Count))
            {
                if ((e.OldStartingIndex <= selectedIndex) && (selectedIndex < (e.OldStartingIndex + e.OldItems.Count)))
                {
                    this.SelectedIndex = -1;
                }
                if ((e.OldStartingIndex > this._focusedIndex) || (this._focusedIndex >= (e.OldStartingIndex + e.OldItems.Count)))
                {
                    return;
                }
                this.SetFocusedItem(-1, false);
            }
            return;

        case NotifyCollectionChangedAction.Reset:
            if (!this.AddedWithSelectionSet(0, base.Items.Count) && !flag)
            {
                this.SelectedIndex = -1;
                this.SetFocusedItem(-1, false);
            }
            return;
    }
    throw new InvalidOperationException();
} 
```

请注意最后一种情况 - 重置...当您加载新的 ItemSource 时，您最终会出现在这里，并且任何 SelectedItem/SelectedIndex 都会被吹走？！？！

好吧，最终解决方案非常简单。我只是将错误的 ComboBox 子类化，并为该方法提供和覆盖，如下所示。虽然我确实必须添加一个：

```
public class FixedComboBox : ComboBox
{
    public FixedComboBox()
        : base()
    {
        // This is here to sync the dep properties (OnSelectedItemChanged is private is the base class - thanks M$)
        base.SelectionChanged += (s, e) => { FixedSelectedItem = SelectedItem; };
    }

    // need to add a safe dependency property here to bind to - this will store off the "requested selectedItem" 
    // this whole this is a kludgy wrapper because the OnSelectedItemChanged is private in the base class
    public readonly static DependencyProperty FixedSelectedItemProperty = DependencyProperty.Register("FixedSelectedItem", typeof(object), typeof(FixedComboBox), new PropertyMetadata(null, new PropertyChangedCallback(FixedSelectedItemPropertyChanged)));
    private static void FixedSelectedItemPropertyChanged(DependencyObject obj, DependencyPropertyChangedEventArgs e)
    {
        FixedComboBox fcb = obj as FixedComboBox;
        fcb.mLastSelection = e.NewValue;
        fcb.SelectedItem = e.NewValue;
    }
    public object FixedSelectedItem 
    {
        get { return GetValue(FixedSelectedItemProperty); }
        set { SetValue(FixedSelectedItemProperty, value);}
    }
    protected override void OnItemsChanged(System.Collections.Specialized.NotifyCollectionChangedEventArgs e)
    {
        base.OnItemsChanged(e);
        if (-1 == SelectedIndex)
        {
            // if after the base class is called, there is no selection, try
            if (null != mLastSelection && Items.Contains(mLastSelection))
                SelectedItem = mLastSelection;
        }
    }

    protected object mLastSelection = null;
} 
```

所做的只是 (a) 保存旧的 SelectedItem，然后 (b) 检查是否在 ItemsChanged 之后，如果我们没有进行选择并且旧的 SelectedItem 存在于新列表中......嗯......选择了它！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-07-09T19:54:21.107

当我第一次遇到这个问题时，我很生气，但我认为必须有办法解决它。到目前为止，我的最大努力在帖子中有详细说明。

[http://blogs.msdn.com/b/kylemc/archive/2010/06/18/combobox-sample-for-ria-services.aspx](http://blogs.msdn.com/b/kylemc/archive/2010/06/18/combobox-sample-for-ria-services.aspx)

我很高兴，因为它将语法范围缩小到如下所示。

```
<ComboBox Name="AComboBox" 
      ItemsSource="{Binding Data, ElementName=ASource}" 
      SelectedItem="{Binding A, Mode=TwoWay}" 
      ex:ComboBox.Mode="Async" /> 
```

凯尔

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-19T16:38:22.613

我在构建级联组合框时遇到了同样的问题，偶然发现了一篇博客文章，其中有人找到了一个简单但令人惊讶的修复方法。在设置 .ItemsSource 之后但在设置 SelectedItem 之前调用 UpdateLayout()。这必须强制代码阻塞，直到数据绑定完成。我不确定为什么它会修复它，但从那以后我再也没有经历过比赛条件......

此信息的来源： http: [//compiledexperience.com/Blog/post/Gotcha-when-databinding-a-ComboBox-in-Silverlight.aspx](http://compiledexperience.com/Blog/post/Gotcha-when-databinding-a-ComboBox-in-Silverlight.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-28T18:01:02.700

从您的帖子中不清楚您是否知道必须在 UI 线程上修改 UI 元素 - 否则您会遇到问题。这是一个简短的示例，它创建一个后台线程，该线程使用当前时间修改 TextBox。

关键是 Page.xaml.cs 中的 MyTextBox.Dispather.BeginInvoke。

页面.xaml：

```
<UserControl x:Class="App.Page"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    Width="400" Height="300"
             Loaded="UserControl_Loaded">
    <Grid x:Name="LayoutRoot">
        <TextBox FontSize="36" Text="Just getting started." x:Name="MyTextBox">
        </TextBox>
    </Grid>
</UserControl> 
```

页面.xaml.cs：

```
using System;
using System.Windows;
using System.Windows.Controls;

namespace App
{
    public partial class Page : UserControl
    {
        public Page()
        {
            InitializeComponent();
        }

        private void UserControl_Loaded(object sender, RoutedEventArgs e)
        {
            // Create our own thread because it runs forever.
            new System.Threading.Thread(new System.Threading.ThreadStart(RunForever)).Start();
        }

        void RunForever()
        {
            System.Random rand = new Random();
            while (true)
            {
                // We want to get the text on the background thread. The idea
                // is to do as much work as possible on the background thread
                // so that we do as little work as possible on the UI thread.
                // Obviously this matters more for accessing a web service or
                // database or doing complex computations - we do this to make
                // the point.
                var now = System.DateTime.Now;
                string text = string.Format("{0}.{1}.{2}.{3}", now.Hour, now.Minute, now.Second, now.Millisecond);

                // We must dispatch this work to the UI thread. If we try to 
                // set MyTextBox.Text from this background thread, an exception
                // will be thrown.
                MyTextBox.Dispatcher.BeginInvoke(delegate()
                {
                    // This code is executed asynchronously on the 
                    // Silverlight UI Thread.
                    MyTextBox.Text = text;
                });
                //
                // This code is running on the background thread. If we executed this
                // code on the UI thread, the UI would be unresponsive.
                //
                // Sleep between 0 and 2500 millisends.
                System.Threading.Thread.Sleep(rand.Next(2500));
            }
        }
    }
} 
```

因此，如果您想异步获取数据，则必须使用 Control.Dispatcher.BeginInvoke 来通知 UI 元素您有一些新数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T11:44:08.000

与其每次都重新绑定 ItemsSource，不如将它绑定到 ObservableCollection<> 然后在其上调用 Clear() 和 Add(...) 所有元素会更容易。这样绑定就不会被重置。

另一个问题是所选项目必须是列表中对象的实例。当我认为默认项目的查询列表已修复但在每次调用时重新生成时，我犯了一个错误。因此，尽管它具有与列表项相同的 DisplayPath 属性，但当前是不同的。

您仍然可以获得当前项目的 ID（或任何唯一定义它的 ID），重新绑定控件，然后在绑定列表中找到具有相同 ID 的项目并将该项目绑定为当前项目。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-08-31T04:33:00.810

如果您因为遇到组合框选择问题而到达这里，这意味着当您单击列表中的项目时不会发生任何事情。请注意，以下提示也可能对您有所帮助：

1/ 确保您在选择项目时不通知某事

```
public string SelectedItem
        {
            get
            {
                return this.selectedItem;
            }
            set
            {
                if (this.selectedItem != value)
                {
                    this.selectedItem = value;
                    //this.OnPropertyChanged("SelectedItem");
                }
            }
        } 
```

2/确保您选择的项目仍在基础数据源中，以防您意外删除它

我犯了两个错误；）

# php - 如何在 Slicehost 的 Ubunty Hardy 上同时运行 Mono、PHP 和 .NET 模块？

> ID：596053
> 
> 赞同：0
> 
> 时间：2009-02-27T18:42:24.527
> 
> 标签：php, asp.net, .net, mono, ubuntu-8.04

我在我的 SliceHost Ubuntu Hardy Heron vps 服务器上运行 Rails 应用程序和 PHP。我有一个`PdfProcess.exe`基于 ASP.NET (.NET 2) 的模块。

我有一个 PHP 文件，它使用一个`passthru("PdfProcess.exe ......")`加载 pdf 模板并输出新处理的 pdf 文件并发送到浏览器的函数。

`PdfProcess.exe`和功能的组合`PHP passthru(...)`适用于我的开发系统中的 Windows Apache/PHP 服务器。

现在我必须在我的 Ubuntu Hardy 中使用它。我用谷歌搜索了如何在 Ubuntu 中使用 Mono 运行 .NET 应用程序，然后我找到了[Mono](http://mono-project.com/Main_Page)。

而且我从 2 天以来一直在尝试安装 Mono 2.0.1、2.2，但仍然发现安装错误，但我无处可去。

所以，在花更多时间之前，我想知道要安装哪些东西才能使 PHP passthru(...) 函数和 PdfProcess.exe 一起工作？

只有安装 Mono 才能工作，还是我也必须安装 XSP 和 MCS？

运行这个基于 PdfProcess.exe .NET 2 的模块需要哪个版本的 Mono？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-28T05:58:35.120

首先，您应该使用 Moma 检查您的 PdfProcess.exe 是否可以在 Mono 上正常运行。

[http://mono-project.com/Moma](http://mono-project.com/Moma)

其次，在 Ubuntu 上安装 Mono 很困难。目前还没有官方支持。您可以尝试其他 Linux 发行版。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-28T05:49:37.217

你在运行 Apache 吗？最可能。

您需要安装和配置 mod_mono 才能运行 Asp.net 应用程序。

在 Mono 项目站点上，您可以找到[配置 mod_mono 的详细说明](http://www.mono-project.com/Mod_mono)

我建议您在 repo（添加/删除程序）中查找单声道，但会有旧版本。

PdfProcess.exe 是 .net 应用程序吗？如果是，请先与[MoMa核对](http://www.mono-project.com/Moma)

如果 PdfProcess.exe 不是 .net 应用程序，那么您可以找到它的替代品。

# .net - 表适配器 SQL 注入

> ID：596057
> 
> 赞同：2
> 
> 时间：2009-02-27T18:43:18.067
> 
> 标签：.net, dataset, sql-injection

嗨，我正在使用一个数据集，在该数据集中我有一个表适配器。在我的表适配器中，我使用存储过程作为查询。如果我使用以下行通过我的表适配器插入表单数据，它对 SQL 注入安全吗？谢谢。

```
UserDataSetTableAdapters.UserInformationTableAdapter myFactory = new TestProject.UserDataSetTableAdapters.UserInformationTableAdapter();
            myFactory.spTest_InsertUserInformation(id, frmAddress); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T18:52:46.750

如果不发布您的存储过程代码，就无法真正回答您的问题，但您可能可以自己回答。

* * *

SQL 注入攻击源于用户输入的数据摆动到动态生成和执行的 SQL 查询中。使用存储过程通常通过将参数作为参数传递来避免此问题，因此不会动态生成 SQL。过程会自动封装，不会成为原始 SQL 查询文本的一部分。

以以下为例：

```
SELECT *
FROM myTable
WHERE myId = @ID; 
```

作为参数，您可以安全地设置`@ID`为“21; DROP TABLE myTable;”。它将为您转义，整个字符串将与 myId 进行比较。但是，如果您动态生成 SQL 查询，例如

```
string query = "SELECT *\nFROM myTable\nWHERE myId = " + userEnteredText + ";"; 
```

现在你会得到以下信息：

```
SELECT *
FROM myTable
WHERE myId = 21; DROP TABLE myTable;; 
```

哎哟。

* * *

因此，回答您的问题：如果您的存储过程没有根据其参数和`EXEC`它们动态生成 SQL，那么您应该是安全的。

注意：当然，这依赖于您的 .NET 数据提供程序来调用带有参数的过程，而不是生成动态 SQL 语句。大多数都正确执行此操作，但如果您使用的是第 3 方提供商，则应在假设您安全之前仔细检查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T18:48:40.287

简短的回答：是的:)

**更新 1：**即使您没有在适配器上使用存储过程和定义的带有参数的查询，也可以安全地防止 sql 注入，即 select f1, f2 where f3 = @myparameter ... 这将使用准备好的查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-04T19:02:55.197

**如果您在使用 EXEC (@SQL) 而不是带有参数**的sp_executesql 的 proc 本身中使用动态 SQL，那么您是不安全的，否则您是

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T18:51:43.273

使用 SQL Prolier 跟踪进行验证。如果底层 API 是安全的，您将看到参数化的 T-SQL 命令，类似于 sp_executesql。

# model-view-controller - 是否有 MVC 嵌入式系统 GUI 示例？

> ID：596058
> 
> 赞同：1
> 
> 时间：2009-02-27T18:43:35.243
> 
> 标签：model-view-controller, user-interface, embedded

我想将 MVC 模式应用于我们为嵌入式系统开发的 GUI。在这种情况下，我的理解是我们需要为控制器和视图之间的侦听器/事件操作提供底层框架。此外，我还看到了一些模型向视图发送事件的示例，但这可能是不正确的。这看起来正确吗？

有谁知道针对可能具有此功能的嵌入式设备的框架？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-14T04:02:58.903

如果您的嵌入式设备支持 Java，那么在这种情况下，eRCP 将是最好的 GUI 框架。查看： http: [//www.eclipse.org/ercp/](http://www.eclipse.org/ercp/)

模型向视图发送事件是一种通知视图更新模型中的事物已更改的方法。这是MVC中M&V之间的正常通信。但是，这里的“视图”应该是通过“可观察”接口绑定的*通用视图*，而不是具体视图。

例如：

*   抽象视图：时钟（通用接口）
*   具体观点：数字时钟、模拟时钟<--时钟的实现
*   模型：时间<--“知道”时钟，但不是数字或模拟......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-28T07:41:20.467

如果你在 linux 平台上工作。试试 Enlightenment 我见过的最好的 GUI .....

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-13T23:50:29.930

我可以推荐 Qt Toolkit。但是您没有提及您的平台功能。

# .net - “ID”的 .NET 命名约定（任何标识：大写）

> ID：596062
> 
> 赞同：39
> 
> 时间：2009-02-27T18:44:41.027
> 
> 标签：.net, naming-conventions

我正在统一这些不一致的命名约定，最近这个问题让我有点发疯。

在我正在使用的代码库中，没有关于“ID”的约定；“ID”、“Id”甚至“iD”的使用不一致。

****问题**：在.NET中，你们如何将“ID”大写？例如，nodeID，nodeId？文件夹 ID 还是文件夹 ID？

****编辑**：复数情况如何？那我应该做“NodeIDs”还是“NodeIds”？

谢谢

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2009-02-27T18:50:43.650

大写是 2 个字母的首字母**缩写词**。用户界面、IP 等

“Id”是 Identifier 的**缩写**，所以它应该保持帕斯卡大小写。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2009-02-27T18:46:30.570

[Microsoft 的命名指南](http://msdn.microsoft.com/en-us/library/x2dbyw72(VS.71).aspx)建议使用全部大写的 2 字母缩写词作为标识符（IP、IO、UI 等），所以**我**倾向于使用“ID”（即使它不是首字母缩写词），因为当我阅读它时，我仍然会说字母分别。

但老实说，我认为微软也不知道/不知道如何处理 ID/Id：

```
ID

System.Runtime.InteropServices._Activator.GetIDsOfNames()
System._AppDomain.GetIDsOfNames()
System.Runtime.InteropServices._Attribute.GetIDsOfNames()
System.Type.GetTypeFromProgID()
System.Threading.Thread.ThreadID
System.Threading.Thread.GetDomainID()
System.Runtime.Serialization.ObjectHolder.ContainerID
System.Globalization.Calendar.ID
System.Globalization.CultureInfo.InvariantCultureID
System.Web.UI.Control.ClientID
System.Web.UI.Control.UniqueID

Id

System.AppDomain.GetCurrentThreadId()
System.AppDomain.GetIdForUnload()
System.AppDomain.IsDomainIdValid()
System.AppDomain.GetId()
System.Attribute.TypeId
System.TypeLoadException.ResourceId
System.Reflection.AssemblyAlgorithm.AssemblyAlgorithmAttribute.AlgorithmId
System.Runtime.Remoting.Lifetime.Lease.GetNextId()
System.Xml.Xpath.XPathNavigator.UniqueId
System.Data.OleDb.DBPropSet.PropertyId 
```

（来自[http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/dcb8e08b-026a-4903-a413-7dbdda131a82/](http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/dcb8e08b-026a-4903-a413-7dbdda131a82/)）

我想这就是他们发明智能感知的原因......

关于多元化：在我看来，`s`应该总是小写。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2015-01-22T13:59:30.627

自提出此问题以来，Microsoft 已更新其指南。

在 MSDN 文章[Capitalization Conventions](https://msdn.microsoft.com/en-us/library/ms229043%28v=vs.110%29.aspx) (.NET Framework 4.5) 中，有一个名为**Capitalizing Compound Words and Common Terms**的部分。在本节的表格中，在命名标识符时，为“标识符”的缩写给出了以下大写指南：

*   当应用**Pascal**大小写时，使用**Id**。*（例如`System.Attribute.TypeId`：）*
*   当**Camel**大小写应用时，使用**id**。*（例如`var id = 42;`：）*
*   **永远不要**使用**ID**。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-02-27T18:54:57.867

最新的指南是“Id”，关于这个和其他的更多信息（例如“Ok”），请参阅[我](http://www.moserware.com/2008/12/private-life-of-public-api.html)关于最新框架设计指南（第 2 版）的帖子

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-27T18:56:43.353

当 ID 是标识符等的缩写时，我总是将其大写。它看起来不对，让我想起[Freud](http://en.wikipedia.org/wiki/Id,_ego,_and_super-ego)，否则——这绝对不是一件好事。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-02-16T17:52:51.703

如果您愿意检查字典，您会发现 ID 不被视为缩写。实际上，表格被指定为 ID 或 ID 那里。这可能是因为它来自诸如“身份文档”或“身份数据”之类的表达式，并且最初并未被视为“标识符”的缩写形式。因此，表单 ID 不仅被推荐，而且字典直接支持。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-03-03T12:03:00.443

我认为有些人使用“ID”而不是“Id”的原因是因为它是通常大写的“GUID”、“UUID”或“UID”的子集。

我同意它应该是“Id”，但我认为它在很大程度上取决于上下文，因为在某些环境中使用“ID”*可能*更合适。

所以对我来说，“ID”是一个技术术语，是上述术语的一个子集，或者用于指代这些技术术语中的任何一个，而“Id”是任何类型标识符的简写，并且在您需要一个人时在非技术上下文中要像在公共 API 或 UML 中那样阅读它，您应该（在我看来）使用“Id”。

# c# - 在 C# 下，在 32 位处理器上使用 Int64 是危险的

> ID：596065
> 
> 赞同：17
> 
> 时间：2009-02-27T18:44:51.713
> 
> 标签：c#, .net, thread-safety, int64

我在 MS 文档中读到，在 32 位 Intel 计算机上分配 64 位值不是原子操作；也就是说，该操作不是线程安全的。这意味着如果两个人同时为一个静态`Int64`字段赋值，则无法预测该字段的最终值。

三部分问题：

*   这是真的吗？
*   这是我在现实世界中会担心的事情吗？
*   如果我的应用程序是多线程的，我真的需要`Int64`用锁定代码包围我的所有任务吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-27T18:48:21.893

这不是关于您遇到的每个变量。如果某些变量被用作共享状态或其他东西（包括但不限于*某些* `static`字段），您应该注意这个问题。对于由于在闭包或迭代器转换中被关闭而没有被提升并且一次由单个函数（因此，单个线程）使用的局部变量，这完全没有问题。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-27T19:40:24.420

即使写入*是*原子的，您仍然需要在访问变量时取出锁。如果您不这样做，则至少必须创建变量`volatile`以确保所有线程在下次读取变量时都能看到新值（这几乎总是您想要的）。这让你可以做原子的、易失的集合——但只要你想做任何更有趣的事情，比如向它添加 5，你就会回到锁定状态。

无锁编程非常非常难以做到正确。您需要*确切地*知道自己在做什么，并将复杂性保持在尽可能小的代码中。就个人而言，我什至很少尝试尝试它，除了非常知名的模式，例如使用静态初始化器来初始化集合，然后在不锁定的情况下从集合中读取。

使用[`Interlocked`](http://msdn.microsoft.com/en-us/library/system.threading.interlocked.aspx)类在某些情况下会有所帮助，但只需取出锁几乎总是容易得多。无争议的锁“相当便宜”（诚然，它们会因为更多的内核而变得昂贵，但一切都是如此）——在你有充分的证据证明它实际上会产生重大影响之前，不要乱用无锁代码。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-27T18:51:01.387

[MSDN](http://msdn.microsoft.com/en-us/library/system.int64.aspx)：

> 在所有硬件平台上分配这种类型的实例并不是线程安全的，因为该实例的二进制表示可能太大而无法在单个原子操作中分配。

但是也：

> 与任何其他类型一样，对包含此类型实例的共享变量的读取和写入必须由锁保护以保证线程安全。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-27T19:35:27.067

如果您确实有一个共享变量（例如，作为类的静态字段，或作为共享对象的字段），并且该字段或对象将被跨线程使用，那么，是的，您需要确保通过原子操作保护对该变量的访问。x86 处理器具有确保发生这种情况的内在函数，并且此功能通过 System.Threading.Interlocked 类方法公开。

例如：

```
class Program
{
    public static Int64 UnsafeSharedData;
    public static Int64 SafeSharedData;

    static void Main(string[] args)
    {
        Action<Int32> unsafeAdd = i => { UnsafeSharedData += i; };
        Action<Int32> unsafeSubtract = i => { UnsafeSharedData -= i; };
        Action<Int32> safeAdd = i => Interlocked.Add(ref SafeSharedData, i);
        Action<Int32> safeSubtract = i => Interlocked.Add(ref SafeSharedData, -i);

        WaitHandle[] waitHandles = new[] { new ManualResetEvent(false), 
                                           new ManualResetEvent(false),
                                           new ManualResetEvent(false),
                                           new ManualResetEvent(false)};

        Action<Action<Int32>, Object> compute = (a, e) =>
                                            {
                                                for (Int32 i = 1; i <= 1000000; i++)
                                                {
                                                    a(i);
                                                    Thread.Sleep(0);
                                                }

                                                ((ManualResetEvent) e).Set();
                                            };

        ThreadPool.QueueUserWorkItem(o => compute(unsafeAdd, o), waitHandles[0]);
        ThreadPool.QueueUserWorkItem(o => compute(unsafeSubtract, o), waitHandles[1]);
        ThreadPool.QueueUserWorkItem(o => compute(safeAdd, o), waitHandles[2]);
        ThreadPool.QueueUserWorkItem(o => compute(safeSubtract, o), waitHandles[3]);

        WaitHandle.WaitAll(waitHandles);
        Debug.WriteLine("Unsafe: " + UnsafeSharedData);
        Debug.WriteLine("Safe: " + SafeSharedData);
    }
} 
```

结果：

> **不安全**：-24050275641 **安全**：0

有趣的是，我在 Vista 64 上以 x64 模式运行它。这表明运行时将 64 位字段视为 32 位字段，也就是说，64 位操作是非原子的。有人知道这是 CLR 问题还是 x64 问题？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-27T18:53:31.537

在 32 位 x86 平台上，最大的原子大小的内存是 32 位的。

这意味着，如果某些内容写入或读取 64 位大小的变量，则该读取/写入可能会在执行期间被抢占。

*   例如，您开始为 64 位变量赋值。
*   在写入前 32 位后，操作系统决定另一个进程将获得 CPU 时间。
*   下一个过程尝试读取您正在分配的变量。

这只是 32 位平台上 64 位分配的一种可能的竞争条件。

然而，即使使用 32 位变量，也可能存在读写竞争条件，因此任何共享变量都应该以某种方式同步以解决这些竞争条件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-27T18:53:58.853

这是真的吗？是的，事实证明。如果您的寄存器中只有 32 位，并且您需要将 64 位值存储到某个内存位置，则将需要两次加载操作和两次存储操作。如果您的进程被这两个加载/存储之间的另一个进程中断，则另一个进程可能会损坏您的一半数据！奇怪但真实。这在每个构建的处理器上都是一个问题 - 如果您的数据类型比您的寄存器长，您将遇到并发问题。

这是我在现实世界中会担心的事情吗？是和不是。由于几乎所有现代编程都有自己的地址空间，所以如果你在进行多线程编程，你只需要担心这一点。

如果我的应用程序是多线程的，我真的需要用锁定代码包围我的所有 Int64 分配吗？可悲的是，如果你想获得技术，是的。在实践中，在较大的代码块周围使用 Mutex 或 Semaphore 通常比将每个单独的 set 语句锁定在全局可访问变量上更容易。

# javascript - 检测窗口宽度并补偿滚动条 - Javascript

> ID：596072
> 
> 赞同：18
> 
> 时间：2009-02-27T18:47:23.237
> 
> 标签：javascript, screen, width

如何使用 Javascript 检测用户窗口的宽度并考虑他们的滚动条？（我需要滚动条内的屏幕宽度）。这就是我所拥有的......它似乎可以在多个浏览器中工作......除了它不考虑滚动条......

```
 function browserWidth() {
  var myWidth = 0;
  if( typeof( window.innerWidth ) == 'number' ) {
    //Non-IE
    myWidth = window.innerWidth;
  } else if( document.documentElement && document.documentElement.clientWidth ) {
    //IE 6+ in 'standards compliant mode'
    myWidth = document.documentElement.clientWidth;
  } else if( document.body && document.body.clientWidth ) {
    //IE 4 compatible
    myWidth = document.body.clientWidth;
  }
  return myWidth;
} 
```

有任何想法吗？我需要它在所有浏览器中工作；）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-12-13T18:05:49.437

如果您只对宽度感兴趣，一个（非常讨厌的）解决方法是创建一个 1px x 100% div 并使用它的 offsetWidth。适用于 IE>=7、FF、Chrome、Safari 和 Opera（我没有尝试过 IE6，因为我们正在努力让你很幸运，它可以正常工作，所以不要抱怨-关于这些天的渲染奇数政策）。我用 attributes 将 div 挂在 document.body 上`{ position: 'absolute', top: '-1px', left: 0, width: '100%', height: '1px' }`，在第一次需要时创建它。

如果你能忍受它就可以工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-27T18:57:10.233

[您将在 quirksmode.org 的此页面上](http://www.quirksmode.org/dom/w3c_cssom.html)找到哪些浏览器支持哪些属性的概要。

您最好的选择可能是抓取页面中的一个元素（在支持的情况下使用 document.body 或 document.getElementById 或其他），遍历其 offsetParent 链以找到最顶层的元素，然后检查该元素的 clientWidth 和 clientHeight。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-08-04T10:41:41.393

只需在 window.innerWidth() 检查之前添加：

```
if (typeof(document.body.clientWidth) == 'number') {
    // newest gen browsers
    width = document.body.clientWidth;
    height = document.body.clientHeight;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-02-17T05:28:26.413

This is what I did - only half a year into learning JavaScript, so this may be a bad fix. First, I created a transparent square image `(10px x 10px)`, but you could also create a non-transparent image and add this to your JavaScript as
`document.getElementById('getDimensions').style.visibility = "hidden";`

**HTML:**

```
<img id="getDimensions" src="images/aSmallBox.png" alt="A small transparent image  
meant to determine the dimensions of the viewport" width="10px" height="10px"/> 
```

**JavaScript:**

```
//Inside function called by window.onload event handler (could go in CSS file, but   
//better to keep it with other related code in JS file)
document.getElementById('getDimensions').style.position = "fixed";
document.getElementById('getDimensions').style.bottom = "0px";
document.getElementById('getDimensions').style.right = "0px";   

//Everything below inside function called by window.onresize event handler
var baseWidthCalculation = document.getElementById('getDimensions').offsetLeft;
var baseHeightCalculation = document.getElementById('getDimensions').offsetTop;
  //Account for the dimensions of the square img element (10x10)
var viewportWidth = baseWidthCalculation + 10;
var viewportHeight = baseHeightCalculation + 10; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-11-11T22:33:53.500

This is a more efficient version of an idea posted here by Tim Salai ( even though you are just beginning, it was brilliant to place an element in the bottom right corner like that ).

```
var getDimensions = document.createElement("div");
getDimensions.setAttribute("style", 
            "visibility:hidden;position:fixed;bottom:0px;right:0px;");
document.getElementsByTagName("body")[0].appendChild(getDimensions);
var viewportWidth = getDimensions.offsetLeft;
var viewportHeight = getDimensions.offsetTop; 
```

And here is a modular version

```
var PageDimensions = function(){
 var Width;
 var Height;     

 function pagedimensionsCtor (){
   var getDimensions = document.createElement("div");
   getDimensions.setAttribute("style" , 
         "visibility:hidden;position:fixed;bottom:0px;right:0px;");
   document.getElementsByTagName("body")[0].appendChild(getDimensions);
   Width = getDimensions.offsetLeft;
   Height = getDimensions.offsetTop;
   getDimensions.parentNode.removeChild(getDimensions);
 }
 pagedimensionsCtor();

 function Reset(){
  pagedimensionsCtor();
 }     

 function GetPageHeight(){
  return Height;
 }

 function GetPageWidth(){
  return Width;
 }

 return{
  Reset: Reset,
  GetPageHeight: GetPageHeight,
  GetPageWidth: GetPageWidth
 };
} 
```

Use the modular version:

```
var page = new PageDimensions();
console.log("viewportWidth: " + page.GetPageWidth() + " viewportHeight: " + page.GetPageHeight()); 
```

Bonus feature:

```
page.Reset();//just in case you think your dimensions have changed 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-27T18:59:36.717

我会将“innerWidth”与身体的宽度进行比较。如果 body width > innerwidth，则存在滚动条。

```
if (browserWidth() < document.body.offsetWidth) {
  doSomething();
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-12-21T05:59:29.720

Another solution you can try is changing some CSS so scrolling happens within your page, instead of the browser window doing it. In the style for body, add overflow:auto. Now the body element includes the scrollbar, so when you get the window width you're measuring the width outside the scrolling container instead of inside it.

This does feel like a potential source of quirkiness, and possibly an accessibility issue, so if you're going for widespread use you might want to test it quite carefully.

# linker - 等效于 GNU LD --export-dynamic 标志的 Solaris 链接器

> ID：596076
> 
> 赞同：1
> 
> 时间：2009-02-27T18:48:03.500
> 
> 标签：linker, solaris, shared-libraries, ld

就像问题所说：我们正在使用 GNU 链接器在 Linux 上构建，并在 Solaris 上使用 solaris `ld`。GNU`ld`支持以下`--export-dynamic`标志：

> 创建动态链接的可执行文件时，将所有符号添加到动态符号表中。动态符号表是在运行时从动态对象可见的符号集。

使用 solaris 链接器的这个标志的等价物是什么？ *有*没有等价物？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T19:55:41.560

默认情况下， Sun Studio 链接器 ( `ld`) 会导出所有符号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-21T05:55:17.480

您可以在 docs.sun.com 上找到 Sun 链接器的完整参考。搜索“链接器和库指南”。“所有符号”是指所有全局符号，对吗？C文件静态符号不提升为全局对吗？我认为那行不通。

# wpf - 如何让 IntelliSense 在 XAML 中的自定义/用户控件上自动完成枚举？

> ID：596089
> 
> 赞同：4
> 
> 时间：2009-02-27T18:50:19.283
> 
> 标签：wpf, xaml

> **可能重复：**
> [WPF：如何在 vs2008 xaml 编辑器智能感知中显示枚举属性值？](https://stackoverflow.com/questions/419802/wpf-how-to-display-enum-property-values-in-vs2008-xaml-editor-intellisense)

在 XAML 中，如果我为 StackPanel 定义 Orientation 属性，IntelliSense 会显示 Orientation 枚举。如果我使用基于枚举的 DependencyProperty 定义自己的控件，有没有办法让 IntelliSense 调出枚举？

枚举：

```
public enum MyEnum { Foo, Bar } 
```

控制中的 DependencyProperty：

```
public static readonly DependencyProperty MyEnumValueProperty =
    DependencyProperty.Register(
        "MyEnumValue",
        typeof(MyEnum),
        typeof(MyControl),
        new UIPropertyMetadata());

public MyEnum MyEnumValue
{
    get { return (MyEnum)GetValue(MyEnumValueProperty); }
    set { SetValue(MyEnumValueProperty, value); }
} 
```

编辑：

将答案交给“Daniel Pratt”，因为他为我指明了正确的方向。我更喜欢代码示例。

要让它工作：

1.  将 XmlnsDefinition 属性添加到 AssemblyInfo.cs

    [程序集：XmlnsDefinition（“ [http://schemas.your-company.com/wpf/](http://schemas.your-company.com/wpf/) ”，“YourNamespace”）]

2.  在将定义控件的 XAML 源中为其添加 xmlns 条目

    xmlns:control="http://schemas.your-company.com/wpf/"

3.  然后 presto，您可以添加控件，IntelliSense 将调出枚举值

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-27T19:03:46.597

尝试这样的事情[或](http://vyasashutosh.blogspot.com/2007/05/providing-custom-intellisense-in-vsnet.html)使用[ReSharper](http://www.jetbrains.com/resharper/)

# c++ - 关于堆上成员变量的 C++ 礼仪

> ID：596093
> 
> 赞同：9
> 
> 时间：2009-02-27T18:50:49.250
> 
> 标签：c++, heap-memory

明确地将对象成员放在堆上（通过新的）是否被认为是不礼貌/不好的做法？我认为您可能希望允许客户端选择内存区域来实例化对象。我知道在某些情况下堆成员可能是可以接受的。如果你知道一种情况，你能描述一下吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-27T19:07:09.460

如果您有一个专为复制语义设计的类，并且您正在不必要地分配/取消分配一堆内存，我可能会认为这是一种不好的做法。但总的来说，它不是。有很多类可以使用堆存储。只要确保你没有内存泄漏（在析构函数中释放东西，引用计数等），你就没事了。

如果您想要更大的灵活性，请考虑让您的用户指定一个[Allocator](http://en.cppreference.com/w/cpp/memory/allocator)。我会解释的。

某些类，例如`std::vector`字符串、映射等，**需要**堆存储来存储它们所代表的数据结构。这不被认为是不礼貌的；当您有一个自动分配`vector`的 时，用户应该知道`vector`在调用构造函数时分配了一个缓冲区：

```
void foo() {
    // user of vector knows a buffer that can hold at least 10 ints
    // gets allocated here.
    std::vector<int> foo(10);  
} 
```

同样，对于`std::string`，您知道有一个内部的堆分配的`char*`。每个`string`实例是否有一个通常取决于 STL 实现；很多时候他们被引用计数。

然而，对于几乎所有的 STL 类，用户**确实**可以选择放置东西的位置，因为他们可以指定分配器。 `vector`是这样定义的：

```
template <typename T, typename Alloc = DefaultAllocator<T> >
class vector {
    // etc.
}; 
```

在内部，`vector`使用`Alloc`（默认为 T 的默认分配器）来分配它可能需要的缓冲区和其他堆存储。如果用户不喜欢默认的分配策略，他们可以指定自己的一种：

```
vector<int, MyCustomAllocator> foo(10); 
```

现在，当构造函数分配时，它将使用 a`MyCustomAllocator`而不是默认值。[以下是有关编写自己的 STL 分配器](http://www.codeguru.com/cpp/cpp/cpp_mfc/stl/article.php/c4079)的一些细节。

如果您担心将堆用于类中的某些存储可能是“不礼貌”，您可能需要考虑为您的类的用户提供这样的选项，以便他们可以指定在以下情况下如何分配事物您的默认策略不符合他们的需求。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-27T19:22:38.877

我根本不认为这是不好的做法。您可能希望通过 new 显式分配成员变量的原因有很多。这里有一些我的想法。

*   假设您的班级有一个非常大的缓冲区，例如 512kb 或 1MB。如果此缓冲区未存储在堆上，则您的用户在创建类的多个局部变量时可能会超出默认堆栈空间。在这种情况下，在构造函数中分配缓冲区并将其存储为指针是有意义的。
*   如果您正在执行任何类型的引用计数，您将需要一个指针来跟踪实际有多少对象指向您的数据。
*   如果您的成员变量的生命周期与您的类不同，那么指针就是要走的路。一个完美的例子是惰性评估，您只需在用户要求时为创建成员**付费**。
*   尽管它不一定对您的用户有直接好处，但编译时间是使用指针而不是对象的另一个原因。如果将对象放入类中，则必须在类的头文件中包含定义该对象的头文件。如果使用指针，则可以前向声明该类，并且只在需要它的源文件中包含定义该类的头文件。在大型项目中，使用前向声明可以通过减少编译单元的整体大小来显着加快编译时间。

另一方面，如果您的用户创建了许多类的实例以在堆栈上使用，那么使用对象而不是成员变量的指针将是有利的，因为相比之下堆分配/释放比较慢。在这种情况下避免堆更有效，当然考虑到上面的第一个项目符号。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T19:20:53.467

类放置其成员的位置不如对它们的管理包含在类中重要；即客户和子类不必担心对象的成员变量。

最简单的方法是让它们成为堆栈变量。但是在某些情况下，比如如果你的类有一个像链表这样的动态数据结构，那就没有意义了。

但是，如果您确保您的对象自行清理，那么对于大多数应用程序来说应该没问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T19:12:47.840

嗯，我不太明白你的问题。

如果你有一堂课：

```
class MyOtherClass;
class MyClass
{
  MyOtherClass* m_pStruct;
}; 
```

然后，MyClass 的客户端无法真正选择如何分配 m_pStruct。

但这将由客户决定如何分配 MyClass 类本身，无论是在堆栈上还是在堆上：

```
MyClass* pMyClass = new MyClass; 
```

或者

```
MyClass myClass; 
```

# sql - 针对多个 SQL Server 版本的软件测试

> ID：596100
> 
> 赞同：2
> 
> 时间：2009-02-27T18:52:56.843
> 
> 标签：sql, windows, testing, operating-system

我目前正在制定一个测试计划并遇到了一个可能的问题，我想知道是否有人有任何建议。

该应用程序使用 SQL Server，它可以在不同版本之间连接以实现兼容性（2000、2005、2008）。好吧，我正在尝试设置一些测试机器，并且想知道应该如何设置。我应该针对每个 SQL 版本执行每个操作系统，还是由于某些我不知道的原因我可以排除的版本/操作系统。我现在看到的测试一切的方式是 9 台机器或 VM（最后三台正在为将来的 Win7 做准备，但现在没有必要）。

WinXP - 2k、2k5、2k8 WinVista - 2k、2k5、2k8 Win7 - 2k、2k5、2k8

任何想法将不胜感激。

在此先感谢，亚伦福利

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T22:39:02.073

你的测试计划是有意义的，尽管它可能不是你必须多次执行的事情。只需确保您设置了某种类型的自动化测试计划。

至少，针对 2k 和 2k5 测试 XP，针对 2k5 和 2k8 测试 Vista/Win7。

# objective-c - 忽略目标 C 中的消息

> ID：596103
> 
> 赞同：0
> 
> 时间：2009-02-27T18:53:28.463
> 
> 标签：objective-c

我有一些 obj-c 代码，我打算在插件中发送不支持的消息。但是我似乎无法忽略消息。我认为“-（id）转发：（SEL）选择器：（marg_list）arglist；” 会解决它，但它没有。我如何让这个应用程序完全运行而不会收到警告和终止呼叫？

```
#import <stdio.h>
#import <objc/Object.h>

//------- @interface section -------

@interface Fraction: Object
{
    int  numerator;
    int  denominator;
}

-(void)   print;
-(void)   setNumerator: (int) n;
-(void)   setDenominator: (int) d;
-(id)     forward: (SEL) selector: (marg_list) arglist;

@end

//------- @implementation section -------

@implementation Fraction;
-(void) print
{
    printf (" %i/%i ", numerator, denominator);
}

-(void) setNumerator: (int) n
{
    numerator = n;
}

-(void) setDenominator: (int) d
{
    denominator = d;
}

-(id) forward: (SEL) selector: (marg_list) arglist
{
    return nil;
}

@end

//------- program section -------

int main (int argc, char *argv[])
{
    Fraction  *myFraction;

    // Create an instance of a Fraction

    myFraction = [Fraction alloc];
    myFraction = [myFraction init];

    // Set fraction to 1/3

    [myFraction setNumerator: 1];
    [myFraction setDenominator: 3];

    // Display the fraction using the print method

    printf ("The value of myFraction is:");
    [myFraction print];
    printf ("\n");
    [myFraction someMsg: 99];
    [myFraction free];
    printf("end");  
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T21:36:02.037

最好在*调用者*中完成，而不是在插件中处理。代替：

```
[myFraction someMsg: 99]; 
```

您应该检查是否`myFraction`响应`someMsg`选择器：

```
if ([myFraction respondsToSelector:@selector(someMsg:)]) {
    [myFraction someMsg: 99];
} 
```

该`-respondsToSelector:`方法在[NSObject 协议参考](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Protocols/NSObject_Protocol/Reference/NSObject.html)中定义，因此请注意您的`MyFraction`对象需要继承自`NSObject`，而不是`Object`（或者`NSObject`自己实现协议）。当然，无论如何，这确实是最佳实践——`Object`通常不鼓励直接对类进行子类化。

# c# - asp.net ExpressionBuilder：可以连接事件吗？

> ID：596107
> 
> 赞同：0
> 
> 时间：2009-02-27T18:54:03.360
> 
> 标签：c#, asp.net

我在我的 asp.net 标记中到处使用 ExpressionBuilders 来返回简单的数据类型。

有谁知道如何使用 ExpressionBuilder 来连接内联事件？还是 ExpressionBuilders 只能返回文字？

我想通过创建一个 ExpressionBuilder（在我的示例中名为 AutoBind）来连接 OnLoad 事件（或任何事件）。如果可以做到这一点，有什么想法吗？

```
<asp:DropDownList ID="DropDownList1" runat="server"
    DataSource='<%# GetRecords() %>'
    DataTextField="Name" DataValueField="ID"
    OnLoad="<%$ AutoBind: this.DataBind() %>" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-05T18:17:00.997

山姆是对的。表达式只能在属性上设置，它不会连接事件。通过使用表达式生成器执行此操作，我得到了“关闭”。

```
[System.Web.Compilation.ExpressionPrefix("Delegate")]
    public class DelegateExpressionBuilder : ExpressionBuilder
    {
        public override CodeExpression GetCodeExpression(BoundPropertyEntry entry, object parsedData, ExpressionBuilderContext context)
        {           

         return new CodeDelegateCreateExpression(new CodeTypeReference("System.EventHandler"), null, entry.Expression);
        }
    } 
```

在页面的标记中你会写这样的东西......

```
<asp:DropDownList runat="server" onload='<%$ Delegate:(o,e) => { this.DataBind(); } %>' /> 
```

问题是编译器会生成这个。

```
 ((System.Web.UI.IAttributeAccessor)(@__ctrl)).SetAttribute("onload", System.Convert.ToString(new System.EventHandler((o,e) => { this.DataBind(); }), System.Globalization.CultureInfo.CurrentCulture)); 
```

本质上是将委托“转换”为字符串，实际上您希望编译器执行此操作...

```
@__ctrl.Load += new System.EventHandler((o,e) => { this.DataBind(); }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T13:55:42.570

而不是使用表达式生成器，您可以调用代码中定义的任何事件方法，该方法具有事件处理程序的 reuqired 签名

在事件句柄事件参数中，您可以根据需要识别对象和数据并操作控制

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T00:11:16.833

我想我明白你在这里想要做什么，如果我错了，请纠正我。

看起来您希望将实际处理程序本身编码为表达式的一部分，即，当 Load 为下拉列表触发时，您希望调用 DataBind()。

首先在这种情况下使用表达式是不合法的。表达式只能用于设置控件实例的公共属性 - OnLoad 不是公共属性，而是解析器根据控件的公共事件生成的事件挂钩。

如果在事件挂钩（如 OnLoad）上设置任何表达式，您将收到如下编译错误：类型“System.Web.UI.WebControls.DropDownList”没有名为“OnLoad”的公共属性。

此外，表达式构建器不仅返回文字 - 它们返回表达式，因此得名。此上下文中的表达式表示 CodeDom 表达式，它表示将在执行页面时执行的代码，作为目标属性分配的一部分。

例如，这个 ConnectionStrings 表达式：

<asp:Literal Text="<%$ ConnectionStrings: myConnection %>" />

返回一个 CodeDom 表达式，在编译页面中看起来像这样：

control.Text = ConnectionStringsExpressionBuilder.GetConnectionString("myConnection");

# process - 错误跟踪和帮助工单应该如何集成？

> ID：596121
> 
> 赞同：4
> 
> 时间：2009-02-27T18:57:17.457
> 
> 标签：process, bug-tracking, issue-tracking

我对错误跟踪系统（例如 FogBugz）有*一点*经验，其中帮助票是（或可能是）错误，并且我在内部使用完全独立于帮助中心系统的错误跟踪系统有一些经验。

我的问题是，在一家拥有现有（本土）帮助中心系统且无法替换它的公司中，应该如何将错误跟踪系统（可能是 Mantis）集成到流程中？

现在，为问题、疑问等提供帮助票证，并将它们分配给适当的人（PC 技术、帮助台工作人员，或者如果这是他们无法在帮助台解决的应用程序问题，则分配给开发人员）。用户可以在帮助工单中提出对应用程序进行小的修改或修复的请求，分配给它的开发人员将在某个时候进行更改，将他们的时间应用于该工单，然后在工单投入生产时关闭工单.

我们目前没有错误跟踪系统，所以我正在寻找最好的集成方式。如果它是错误（或问题或功能请求），我们是否应该只获取帮助票并将其放入错误跟踪系统，然后如果不是紧急修复则关闭票证？我们可能不想将错误跟踪系统暴露给其他任何人，因为他们不知道在帮助中心系统中放置什么以及在错误跟踪器中放置什么......对吗？

有什么想法吗？建议？尖端？建议？待办事项？不是待办事项？ETC...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T18:59:54.050

在帮助台系统上有一个升级到错误按钮，该按钮在错误跟踪器上发布故障单，并带有适当的参考信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T19:00:55.153

这是针对最终用户报告错误的生产系统，还是在 QA 期间解决问题？

如果是前者，一些现场人员应该对帮助台票进行分类，并且只将真正的错误记录为错误。

如果是后者，则根本不应该集成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-26T14:09:37.387

嗯，这是一个权衡。

我们使用单独的系统来处理服务台票和错误。

优点：

*   开发人员和服务台之间的工作流程和要求可能会有所不同，您可以为每个系统选择适合需求的系统（例如，仅与开发人员或服务台相关的字段，不同类型的电子邮件集成）。
*   职责明确：服务台处理工单，开发人员处理错误。

缺点：

*   集成不会很无缝（您需要自动集成，这并不总是存在，或者手动回溯链接，人们可能会忘记）。

到目前为止，我们对两款产品都很满意。有时不得不粘贴链接或关闭工单和错误很烦人，但通常工单和错误无论如何都是由不同的人处理的，所以这没什么大不了的。

如果您能找到适合每个人的工作流程的产品，那么一种产品也可能运行良好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-01-08T05:14:31.227

在**raiseaticket 帮助台系统**中，我们为 Prod、Dev 和 Bugs 创建了一个单独的工作流。根据问题的性质将工单分配给相关组。这些票证不会暴露给任何其他组。因此，我们可以在我们的帮助台门户系统中为错误跟踪做一个解决方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-02-09T21:23:25.503

对于希望在 2022 年（及以后）集成帮助台系统和错误跟踪器的任何人，DoneDone 做得很好。

我们使用 DoneDone*邮箱*提供一般客户支持（通过我们的支持电子邮件地址和我们网站上的联系表）。它使您可以就电子邮件进行私人讨论，同时允许您分配、优先级、标记和创建/更改它们的状态（例如“打开”、“进行中”等）

我们使用 DoneDone*项目*来管理内部错误/问题/任务。

DoneDone 还允许您[将支持电子邮件（帮助台部分）连接到内部任务（错误跟踪部分）](https://www.donedone.com/blog/new-create-link-tasks-directly-from-your-mailbox-conversations)。因此，如果您的公司有独特的支持和面向客户的人员，同时也有内部开发人员，并且您希望将他们的工作分开，您可以从传入的对话中创建任意数量的子任务。

即使您的公司没有那么分层，也很高兴能够使用自己的工作流程与帮助台票（有自己的工作流程）分开来创建错误。

更多信息请访问[https://www.donedone.com](https://www.donedone.com)

# c++ - GCC下的模板函数

> ID：596122
> 
> 赞同：-2
> 
> 时间：2009-02-27T18:57:43.243
> 
> 标签：c++, templates, gcc

**复制。看到[这个](https://stackoverflow.com/questions/594521/stl-iterator-with-custom-template/594630#594630)。**

有人能告诉我为什么这不能在 GCC 下编译吗？MSVC6 和 VS2008 都会编译它，甚至没有警告。

编码...

```
#include <iostream>
#include <vector>
#include <ctime>
#include <cstdlib>
using namespace std;
template <typename T>
T range(vector<T> &v)
{
   vector<T>::iterator i = v.begin(); 
```

在最后一行抛出错误，预期；于我之前。

我需要typedef吗？

我所做的大部分编译都是使用 MSVC6 或 VS2008。我对 GCC 做的不多，所以我有点摸不着头脑。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T18:59:57.403

编译器没有足够的知识来将 vector::iterator 解析为此时的类型。使用 typename 关键字给它一个提示：

```
typename vector<T>::iterator i = v.begin(); 
```

# .net - 将 WCF 请求从 JSON 转换为 IPC/TCP/等

> ID：596124
> 
> 赞同：1
> 
> 时间：2009-02-27T18:57:47.847
> 
> 标签：.net, wcf

我有一个 HttpHandler 充当网站访问者和 Windows 托管 WCF 服务之间的代理。现在 WCF 服务已设置为处理 json 请求，但我想将 json 请求转换为 net.pipe 或 net.tcp 或 WCF 可以处理的任何协议。我希望有这样的沟通：

> 客户端 <--json 使用 HTTP(S)--> IIS/HttpHandler <--SOAP/XML 使用 net.pipe--> WCF 服务

这可能吗？

现在我只是使用 HttpHandler 向 WCF 服务发出另一个 web 请求，但想摆脱它。问题是使用代理，如果我调用的方法包含 out 参数，则没有真正的方法（我可以看到）关于如何反序列化响应。

例如采取这种方法：

```
int DoSomething(string x, out long y) 
```

如果我要在 HttpHandler 代理的逻辑中使用标准 WCF 代理对象调用该方法，那么我如何将该响应序列化为 json（使用 WCF json 格式）并将其反馈给客户端？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-06T10:08:08.123

我认为，如果您在设计时考虑到服务，您希望您的“方法”具有面向消息的签名。

```
 ResponseMessage DoSomething(RequestMessage) {...} 
```

而不是

```
int DoSomething (String x, out long y)  {...} 
```

它避免了您在问题中提出的挑战以及其他问题。它可以帮助您考虑进出服务的消息，而不是参数。

回到你问题的根源......我认为你暗示的是在说 JSON/HTTP 的客户端和你想在 net.pipe 通道上监听的 WCF 服务之间的协议桥。好吧，很抱歉，没有自动协议桥可以为您做到这一点。

但也许你不是在寻找魔法。如果您对编写桥接代码感到满意，那么是的，它会正常工作。但首先清理那些方法签名。

# visual-studio - 视觉工作室 msbuild

> ID：596128
> 
> 赞同：0
> 
> 时间：2009-02-27T18:58:46.407
> 
> 标签：visual-studio, msbuild

我对 msbuild 的命令行选项有疑问。我目前正在使用 msbuild 使用现有的解决方案文件构建项目。这些解决方案文件引用了在每台机器上具有不同路径的外部 dll。我目前正在编写一个构建脚本，并通过 msbuild 的 /p: 开关将特定路径传递给项目文件。

我当前的构建行是： msbuild test.sln /p:ReferencePath="c:\abc" /p:ReferencePath="c:\rca"

我注意到参考路径现在只包含 c:\rca 而不是 c:\abc。这给我带来了问题，因为外部 dll 位于两个不同的目录中。我可以通过 Visual Studio 保留多个参考路径，但不能通过命令行。

有什么已知的方法可以做到这一点

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T19:07:04.033

我相信你可以使用这个 /p:ReferencePath="c:\abc;c:\rca"

至少那是该[链接](http://social.msdn.microsoft.com/Forums/en-US/msbuild/thread/7771664f-ccee-48a3-8d7b-5e3b79e47232/)所暗示的，他们正在使用 %3B 来编码“;” 在构建文件中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-09T08:57:43.133

尽管上面列出了提供更多一个引用路径的正确语法，但我建议解决根本原因，在我看来，这是引用程序集的不同位置。我建议您将所有第三方依赖项（除了框架程序集之外）放在源代码存储库中，原因如下：

1.  相对路径在计算机之间是一致的
2.  源代码始终与您的第三方程序集的正确版本放在一起（例如，如果您需要在 2 年后构建您的软件的旧版本）。
3.  升级您的第三方程序集就像在一台机器上升级然后将您的更改提交到存储库一样简单。（在之前的项目中，我们甚至检查了整个 Java 运行时环境，并且对给定的设置非常满意。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-19T19:08:15.913

用于设置参考路径的命令行选项可以正常工作（假设您转义了分号，看起来 %3B 和`&#59;`可以正常工作）。但是，当从 nant 传入参数时（并且我需要多个路径），创建“Visual Studio 项目用户选项文件”似乎效果更好。

我只是使用以下格式向文件系统发出（回显）一个文件：

```
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
<PropertyGroup>
    <ReferencePath>
        C:\abc;c:\rca
    </ReferencePath>
</PropertyGroup> 
```

我给 *.user 文件起一个适当的名称（给定项目文件 MyProject.csproj，我的用户文件将是 MyProject.csproj.user）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T19:07:50.473

尝试用分号 (;) 分隔路径

像这样：

c:\abc;c:\rca

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T19:10:05.460

跨机器同步库可能会更好。我发现 Visual Studio 让这一切变得简单。只需添加一个解决方案文件夹，然后在其中添加您的库。然后，在每个项目中，从这个公共位置引用库。这样，每个开发人员都将它们放在同一个地方。

这将删除您在尝试编写构建脚本时拥有的变量之一。

# vb.net - VB.NET List(of X).Contains 行为

> ID：596130
> 
> 赞同：1
> 
> 时间：2009-02-27T18:59:35.687
> 
> 标签：vb.net, list, contains, type-safety

我有一个自定义类设置为具有两个属性 X 和 Y 的键

我有类似的东西：

```
Dim test As New List(of TestClass)
Dim key as New TestData

key._a = A
key._b = B

For Each a As TestClass In SomeCollection
  If Not test.Contains(key) Then
     'Do Stuff
  End If
Next 
```

我的问题是： List(of T) 上的 .Contains 的行为如何？它是在寻找相同的数据结构，还是仅仅匹配我的密钥的一个属性？

如果可以的话，请提供一个链接，我可以在其中查看有关此的一些文档。

*编辑* 包含方法类型安全吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T19:00:40.850

它使用该`Equals`方法来检查身份。

默认情况下（如果没有被覆盖）如果两个引用相同或两个结构成员相等则`Equals`返回。`true`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T19:14:33.217

我昨天刚问[了同样的问题](https://stackoverflow.com/questions/593171/how-do-i-make-sure-that-listt-containst-works-with-my-custom-class):)

您的 TestClass 应该实现**IEquatable(of T)** [http://msdn.microsoft.com/en-us/library/ms131187(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms131187(VS.80).aspx)接口以使其类型安全

# asp.net - 如何让业务对象和 UI 控件相互通信

> ID：596133
> 
> 赞同：1
> 
> 时间：2009-02-27T18:59:44.877
> 
> 标签：asp.net, oop, binding

我有一个人对象，其名称和年龄属性实现了 INotifyPropertyChanged。我想将此对象连接到 ASP.NET 表单，以便“名称”和“年龄”属性以某种方式绑定到文本框，当任一位置（控件或对象中）发生更改时，另一个将得到更新。

我是否创建了一个中间类来监听每个文本框更改事件和对象更改事件并处理它们之间的更新？最好的方法是什么？

我不清楚如何让业务对象和 UI 相互交谈。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T19:07:14.563

我已经对这个确切的问题强调了很多。

简短的回答是，是的，一个中间项目。

诀窍是不要为每个控件编写任何代码。您应该能够在屏幕上放置一个 GUI 控件（可能需要也可能不需要代码），然后通过通用绑定机制将您的业务逻辑绑定到它。

我已经通过 XML、属性文件和常量数组定义了绑定——有一百万种方法......

您可能必须为每个类型的对象绑定编写代码（列表框与文本控件的绑定方式不同），并且您可能必须编写验证器（但指定验证器的参数以及验证器绑定到的控件也应该在数据中完成）

话虽如此，如果某些数据驱动的自动绑定机制还不存在，我会感到非常惊讶，微软自 VB 首次问世以来就已经涉足这一领域（尽管他们的实现曾经非常不灵活，我敢肯定他们现在做得更好）。

我非常坚持每个控件的 0 行代码，因为我的工作通常涉及配置具有数十页控件的复杂设备。一个典型的客户端/服务器系统将有 7(!) 行 PER CONTROL 代码，仅用于将数据从数据库传输到服务器、客户端、屏幕和返回（这是普通 ole“哑”代码的最小值没有智能绑定技巧）。

0LOC/控制可能不是每个人的要求，但这是一个很好的目标。

评论回复：我已经在 J​​ava 中手动完成了大部分工作，所以我不确定我能否在具体细节上提供太多帮助。

搜索 C# 和绑定给了我[这个](http://www.akadia.com/services/dotnet_databinding.html)看起来很有希望的东西，虽然它可能直接绑定到一个太多 IMO 的数据库，它应该绑定到一个业务对象，但概念应该是相同的。

首先创建绑定的一种方法是手动实例化绑定对象......（请原谅我的 Java）

```
TextControl textCtrl1=new TextControl("Name Goes Here");
new TextBinder(textCtrl1, personObject, nameField); 
```

在 Java 中，第二行变得很棘手。当您绑定到特定字段时，您必须使用反射来查找 personObject 的该字段的 setter 和 getter。在 C# 中，我认为它应该更容易。

无论如何，活页夹应该将自己添加为控件和对象的侦听器，然后来回转发更改。

这有帮助吗？

Edit2：正如您所注意到的，当您的属性更新时，最困难的部分是注意到。幸运的是，这是可选的。通常，一旦设置了对象，您就不需要更新组件（当我分发可以相互更新的 UI 时，我不得不处理几次）。

因此，如果您假设您的对象不会改变，“绑定”必须执行以下操作：

*   从属性中获取值并将其设置在组件中。
*   将自己添加为组件的侦听器。
*   存储属性/对象（如果可以操作属性，就设置在这里。如果没有，则需要存储对象和属性名称，并使用反射）
*   保释并等待来自您的组件的“更新”事件。

当您从组件获取更新时： - 将值存储在属性中。- 您可能想要设置“已更新”标志或存储原始标志，以便在遍历所有绑定组件时，您可以判断是否需要保存任何更新/启用“确定”按钮。

您的对象现在应该始终是最新的。

在构建表单时，您可能希望将所有绑定控件放入一个集合中，以便您可以执行一些其他操作...

*   “保存”操作可以调用每个绑定控件并告诉它从控件复制到属性，这样您就不需要使用侦听器。
*   “重置”操作可以将所有控件重置为其原始值。
*   “测试”操作可以询问每个控件是否已更新。. ETC

这样做的好处是，您希望添加的每个“操作”都非常简单，但会自动影响整个 UI。

您可能还想要一个带有抽象基础“绑定”类的控件的小对象层次结构，然后是每种控件类型的特定绑定器（文本字段、数字字段、日期、微调器、表格、下拉）——我想就是这样.

这可能非常简单，但会迅速变得复杂。尝试使用文本字段，看看你能做什么。如果您可以在 C# 中传递“属性”，那么一个简单的文本绑定对象应该只是 5 行代码......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T23:48:42.153

好的，完全不同的答案。正如我告诉你的，我对 C# 技术不是很了解，但据我所知，LINQ 可能会为你完成整个工作。

事实上，LINQ 可能会完全按照您的要求去做。它在 Java 中不存在，所以这就是我在另一个答案中给你“手动”版本的原因。

本页底部的评论：http: [//msdn.microsoft.com/en-us/library/z919e8tw.aspx](http://msdn.microsoft.com/en-us/library/z919e8tw.aspx)暗示了一种更好的方法。

# visual-studio - 您想继续并运行最后一次成功的构建吗？

> ID：596142
> 
> 赞同：49
> 
> 时间：2009-02-27T19:02:43.170
> 
> 标签：visual-studio, visual-studio-2008, debugging, visual-studio-2005

您在 Visual Studio 中...您按 F5（运行）并受到此对话框的欢迎：

> 存在构建错误。您想继续并运行最后一次成功的构建吗？

精彩的。

我确信在某些情况下运行最后一次成功的构建很有用，但是，我***从来没有***故意对这个问题回答“是”。哦，当然，我已经点击了很多次，并且沮丧地等待第一次机会来弥补我的错误，但仅此而已。

那么，你有没有发现这个功能很有用？如果是这样，在什么情况下能够运行您的应用程序的最后一次成功构建对您有帮助？

您在等待应用程序启动时不小心单击“是”并踢自己的频率是多少？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-02-27T19:31:56.297

在 VS2008 中，您可以设置以下选项来更改行为（不确定其他版本的 Visual Studio 中是否有类似的选项）：

```
Projects and Solutions/Build and Run

    - On Run, when projects are out of date:

          Always build
          Never build
          Prompt to build <== default setting

    - On Run, when build or deployment errors occur:

          Launch old version
          Do not launch
          Prompt to launch <== default setting 
```

将上述选项设置为“始终构建”和“不启动”，你会得到我认为更有用的行为。虽然有时当我尝试启动调试器并且出现构建错误时，我需要几秒钟才能意识到为什么我没有到达我认为我会遇到的断点（获得某种“烤面包机”可能会很好' 类型的消息让我摆脱昏迷）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-09T08:56:19.613

This behaviour can be defined under Tools->Options->Projects and Solutions->Build And Run-> On Run, when Build or Deployment Errors occur

here you can select: - Launch old version - Do not launch - Ask to launch

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-27T19:06:26.873

当您调试 Web 应用程序并且其中一个页面无法编译时，这可能很有用，因为其他一些开发人员签入了错误的版本，或者您出于某种原因无法签出最新代码，但您知道您不会命中那个页面。我总是这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T19:07:36.947

有趣的。我实际上从未见过该对话框 - 我知道有一个选项可以启用/禁用运行先前成功的构建，所以它可能首先显示一个对话框。如果您不使用它，您可以考虑禁用它。

然而，这可能有用的一个原因是，如果您想提醒自己您正在处理的错误是什么。并非所有事情都可以在编辑并继续中修复，您可能需要记忆慢跑。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T19:23:12.107

它对 Web 应用程序也很有帮助，因为它会强制 cassini 服务器启动。如果您正在处理无法编译的解决方案中的一个项目，并且您需要刷新另一个项目中的 Web 服务，则需要此选项。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-27T20:05:50.787

When using VS 2008 Express, there is a box to never show this dialog again. Just tried it and it will take away the dialog, leaving only a build failed message in the bottom left hand portion of the screen.

As for how often do I hit it, quite often. Frustrating as sometimes I have changed the code complete while testing things and will get something completely unrelated to the task at hand. Not sure when Microsoft figured this would be useful.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-09T12:03:41.793

它适用于在运行时选择适当的 dll 的偏好。如果存在任何构建错误，则不会生成可执行文件，因此编译器会查找现有的可执行文件，这显然是最后一次成功编译的。

# delphi - 使用数组的更简单方法

> ID：596146
> 
> 赞同：1
> 
> 时间：2009-02-27T19:03:53.713
> 
> 标签：delphi

我有以下情况：

```
procedure SomeMethod(SomeList: array of string); 
```

我必须使用 DataSet 中的一些 ID 调用此方法，我知道我可以这样做：

```
var
  MyArray: array of string;
  I: Integer;
begin
  SetLength(MyArray, MyDataSet.RecordCount);

  I := 0;
  MyDataSet.First;
  while not MyDataSet.Eof do
  begin
    MyArray[I] := MyDataSetID.Value;
    Inc(I);
    MyDataSet.Next;
  end;
  SomeMethod(MyArray);
end; 
```

我很懒惰，这对我来说太多了……我想要一个更简单的方法来做这件事，有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T19:15:02.313

这是我能想到的唯一方法。但是，为什么你不能把你已经拥有的东西变成一个函数呢？您只需要在需要时调用它。

如果您需要将它与不同的数据集一起使用，只需传递数据集和字段以用作参数：

```
procedure FieldToArray(const DS: TDataSet; const FieldName: string; 
    const Arr: TStringArray);
var
  i: Integer;
begin
  SetLength(Arr, DS.RecordCount);
  i := 0;
  DS.First;
  while not DS.Eof do
  begin
    Arr[i] := DS.FieldByName(FieldName).AsString;
    Inc(i);
    DS.Next;
  end;
end; 
```

在可见的地方（可能在声明此函数的单元的接口部分），声明 TStringArray 类型：

```
type
  TStringArray = array of string; 
```

现在在您的代码中，任何您需要该字段值列表的地方：

```
var
  MyArray: TStringArray;

FieldToArray(MyDataSet, 'ID', MyArray);
SomeProc(MyArray);

FieldToArray(AnotherDataSet, 'LastName', MyArray);
SomeOtherProc(MyArray);
MyArray := nil; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T19:21:48.240

除了肯怀特的回答。反复调用 FieldByName 可能会严重消耗性能。因此，您可以使用变量来存储字段（随数据集更新）。

```
procedure FieldToArray(const DS: TDataSet; const FieldName: string; 
    const Arr: TStringArray);
var
  i:  Integer;
  field : TField;
begin
  SetLength(Arr, DS.RecordCount);
  i := 0;
  DS.First;
  field := DS.FieldByName(FieldName);
  while not DS.Eof do
  begin
    Arr[i] := field.AsString;
    DS.Next;
    Inc(i);
  end;
end; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T19:25:33.410

据我所知，Delphi 没有更简单的方法，但有两件事可以让你的生活更轻松：

1.  编写自己的`DataSetToArray`函数。（正如其他答案所建议的）
2.  如果您使用的是 Delphi 2007 或更新版本，您可以`ToArray`使用帮助类向数据集添加函数：

    ```
    TDataSetHelper = class helper for TDataSet
      function ToArray: TStringArray;
    end; 
    ```

这样你所有的数据集都会有这个功能，你可以使用：

```
SomeMethod(MyDataset.ToArray); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T19:26:24.063

我建议永远不要使用*TDataSet.RecordCount*，除非您*确切地*知道数据在任何给定时间可能如何变化，以及您将来将使用什么数据访问。先获取记录数再循环遍历有以下问题：

*   如果这不是在一个事务中执行，则在执行循环时记录数可能会发生变化。这可能会导致严重的崩溃——数组实际上可能太短了。

*   如果 SQL 服务器在*TDataSet*后面，那么您最终可能会获取两次结果集，一次用于获取记录数，然后用于获取数据。

*出于这个原因，我看不到在TStrings*对象上使用字符串数组的好处。在循环中调用*TStrings.Add()*是您可以拥有的最短代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T19:40:25.527

我也是一个懒惰的程序员。我曾经是一名 VB6 程序员，我有点喜欢他们所有的 CInt、CStr、CSomethingOrOther 函数，我在自己的公共单元中设置了一些类似的函数。我做的第一个是 CArray 函数，我使用**OVERRIDE**声明制作了它的几个版本。我有一个用于 StringLists，一个用于分隔字符串，还有一个用于数据集。所以我可能会做类似的事情

```
 while not DS.Eof do
  begin
    MyValue := CArray(DS)[4];
    DS.Next;
  end; 
```

我在这方面作弊了一点，因为我使用了该字段的索引。所以我的解决方案在这方面有点糟糕，但是能够在很多不同的场景中使用 CArray 真是太好了，它把像 StringLists 和数据集这样的东西变成了你可以监视并检查你何时到达的东西具体值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-03T22:15:45.557

它绝对必须是“字符串数组”吗？几乎可以用动态数组做的任何事情，您都可以使用 List 并且更轻松地完成它。这是我的做法

```
procedure SomeMethod(SomeList: TStringList);

...

var
  MyList: TStringList;
begin
  MyList := TStringList.Create;
  MyDataSet.First;
  while not MyDataSet.Eof do
  begin
    MyList.add(MyDataSetID.Value);
    MyDataSet.Next;
  end;
  SomeMethod(MyList);
end; 
```

当然，请确保在完成 TStringList 后释放它。

# javascript - 如何判断元素是否与选择器匹配？

> ID：596150
> 
> 赞同：14
> 
> 时间：2009-02-27T19:05:31.087
> 
> 标签：javascript, jquery, dom

假设我有一个 DOM 元素 - 我如何判断它是否匹配 jQuery 选择器，例如`p`or `.myclass`？使用选择器来匹配元素的子元素很容易，但我想要这个特定元素是否匹配的真/假答案？

该元素可能没有 ID（出于其他原因，我无法为其分配一个随机 ID），因此我无法将选择器应用于元素的父级并查找与我的 ID 相同的子级。

这会按预期工作吗？我无法弄清楚 Javascript 对象比较。

```
$(selector, myElement.parentNode).each({
  if (this == myElement) // Found it
}); 
```

似乎有一种简单的方法可以查看 DOM 元素是否与 jQuery 选择器匹配......

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-02-27T19:18:23.193

您可以使用以下[`is()`](http://docs.jquery.com/Is)方法：

```
if($(this).is("p")){
 // ...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T20:35:07.190

我相信[is()](http://docs.jquery.com/Is)方法是您正在寻找的。

否则，您可能只是尝试直接选择该项目，如果这是您的意思。

因此，如果它是一个带有“myclass”类的“a”，只需执行 $("a.myclass")

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T20:42:27.657

> 我无法将我的选择器应用于元素的父元素并寻找与我的 ID 相同的子元素。

无论如何您都不能这样做 -`id`属性必须是唯一的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-07-09T09:51:45.027

# 没有 jQuery，使用[Element.matches()](https://developer.mozilla.org/en/docs/Web/API/Element/matches)：

```
// lets define 2 variables pointing to ordinary <div> elements
var elm1 = document.querySelector('div');
var elm2 = elm1.nextElementSibling;

console.log(
   elm1.matches('.foo'),         // true
   elm1.matches('.bar'),         // false
   elm2.matches('[title=bar]'),  // true
)
```

```
<div class='foo'></div>
<div title='bar'></div>
```

* * *

[查看支持的浏览器列表](https://caniuse.com/#feat=matchesselector)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-05T22:22:15.660

也许你只是想要：

```
$(".complicated #selector p.with > div.manyParts").length 
```

如果没有匹配，长度返回 0，这是假的，所以你可以在`if`语句中使用它，比如：

```
if($(".doesThis #exist").length) {
    // Do things
} 
```

可能值得将它存储在一个单独的变量中，然后检查长度；这样，如果您需要对匹配的元素做任何事情，您不必再次执行相同的选择器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-08-22T12:34:49.587

尝试`Element.matches()`

[元素匹配（）](https://developer.mozilla.org/en-US/docs/Web/API/Element/matches)

```
document.addEventListener("click", event => {
  if (event.target.matches(".elementsClass")) {
    // It matches
  } else {
    // Does not match
  }
}); 
```

# asp.net-mvc - 为什么 ASP.NET MVC 项目的 Content 文件夹中没有 Scripts 文件夹？

> ID：596151
> 
> 赞同：9
> 
> 时间：2009-02-27T19:06:16.047
> 
> 标签：asp.net-mvc

出于好奇，我想知道是否有合理的理由让 Scripts 文件夹不是 ASP.NET MVC 项目中 Contents 文件夹的子文件夹。Contents 文件夹通常包含您的样式表和图像，出于某种原因，我觉得在其中也包含 Scripts 文件夹似乎很自然。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-27T19:09:33.463

可能是因为脚本可以被表示为提供比样式和设计项目更多的功能，所以它可以被视为业务逻辑的一部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T19:20:42.063

脚本和内容文件夹是客户端使用文件的容器。它们不会以任何方式影响您的 MVC 应用程序。如果您更新对它们的 URL 引用以指向新路径，您可以根据需要重命名和移动它们。

话虽如此，我个人倾向于将它们重命名为 js 和 css，主要是因为这使我的 URL 更短，更易于阅读和理解。

# php - php的require和include有什么区别？

> ID：596156
> 
> 赞同：7
> 
> 时间：2009-02-27T19:07:29.273
> 
> 标签：php, include

我想知道什么时候应该使用`include`or`require`以及每个的优点是什么。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-02-27T19:09:34.930

[`require`](http://us3.php.net/require)需要，[`include`](http://www.php.net/include)包括。

根据手册：

> require() 与 include() 相同，但失败时会产生致命的 E_ERROR 级别错误。换句话说，它将停止脚本，而 include() 只发出一个警告 (E_WARNING) 允许脚本继续。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-27T21:24:42.093

正如其他人所说，如果“require”没有找到它正在寻找的文件，则执行将停止。如果 include 没有归档它正在寻找的文件，则执行将继续。

一般来说，导入代码/类/函数库时应该使用require。如果您尝试调用一个函数、实例化一个类等，但定义不存在，就会发生坏事。因此，您**需要**php 来包含您的文件，如果不能，则停止。

当您使用 PHP 输出内容或以其他方式执行代码时使用 include，如果它不运行，则不一定会破坏以后的代码。典型的例子是在模型/视图/控制器框架中实现视图。视图中不应定义任何新内容，也不应更改应用程序状态。因此，使用包含是可以的，因为失败不会破坏应用程序中发生的其他事情。

一个小切线。关于 include、require、require_once 和 include_once 的性能，有很多相互矛盾的信息和错误信息。它们在不同的情况/用例下表现完全不同。这是您真正需要在自己的应用程序中对差异进行基准测试的地方之一。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-27T19:11:20.933

区别在于：如果找不到资源，include 不会失败，require 会。老实说，完全存在 include 有点愚蠢，因为如果你试图加载一个资源，你几乎指望它在那里。如果您要使用任何东西，我建议您始终使用 require_once，这样您就不会遇到冲突（即，如果另一个脚本需要相同的文件）并且您的代码始终按预期工作，因为您知道自己的资源包括在那里（否则它会失败）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-27T19:11:59.073

如果文件是可选的，请包含它。例如，您可能有一个文件“break-news.txt”，它在有突发新闻时创建，但在没有突发新闻时不存在。如果没有突发新闻，它可以在没有脚本中断的情况下被包含在内。

如果脚本的其余部分需要该文件才能正常运行，则需要该文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T19:10:26.927

根据[http://www.alt-php-faq.org/local/78/](http://www.alt-php-faq.org/local/78/)：

与 include() 不同，require() 将始终读取目标文件，即使它所在的行从不执行。如果要有条件地包含文件，请使用 include()。条件语句不会影响 require()。但是，如果出现 require() 的那一行没有被执行，那么目标文件中的任何代码都不会被执行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-08T11:59:48.797

用简单的语言来说，如果我们使用 require ，我们必须确保该文件在那个时代存在，而在 include 的情况下则没有必要。但尝试确保文件存在。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-21T08:46:33.590

```
Include and require are identical, except upon failure:

require will produce a fatal error (E_COMPILE_ERROR) and stop the script
include will only produce a warning (E_WARNING) and the script will continue 
```

你可以用例子来理解 include("test.php"); echo "\n此行将被打印";

输出：警告：include（test.php）：打开流失败：/var/www/........ 将打印此行

要求（“test.php”）；echo "\n此行将被打印"; 警告：需要（test.php）：打开流失败：/var/www/...中没有这样的文件或目录

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2010-05-08T04:08:41.390

`Require()`并且`include()`在处理故障方面是相同的。但是，`require()`会导致致命错误并且不允许处理该页面。即包含将允许脚本继续。

# asp.net - PolicyException：无法获得所需的权限——这个错误是什么意思

> ID：596160
> 
> 赞同：5
> 
> 时间：2009-02-27T19:08:11.907
> 
> 标签：asp.net, sqlite, iis, permissions

尝试加载 aspx 页面时出现此错误：

```
Source Error:

An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.

Stack Trace:

[PolicyException: Required permissions cannot be acquired.]
   System.Security.SecurityManager.ResolvePolicy(Evidence evidence, PermissionSet reqdPset, PermissionSet optPset, PermissionSet denyPset, PermissionSet& denied, Boolean checkExecutionPermission) +2770052
   System.Security.SecurityManager.ResolvePolicy(Evidence evidence, PermissionSet reqdPset, PermissionSet optPset, PermissionSet denyPset, PermissionSet& denied, Int32& securitySpecialFlags, Boolean checkExecutionPermission) +57

[FileLoadException: Could not load file or assembly 'SQLite.NET, Version=0.21.1869.3794, Culture=neutral, PublicKeyToken=c273bd375e695f9c' or one of its dependencies. Failed to grant minimum permission requests. (Exception from HRESULT: 0x80131417)]
   System.Reflection.Assembly._nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, Assembly locationHint, StackCrawlMark& stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection) +0
   System.Reflection.Assembly.nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, Assembly locationHint, StackCrawlMark& stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection) +54
   System.Reflection.Assembly.InternalLoad(AssemblyName assemblyRef, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection) +211
   System.Reflection.Assembly.InternalLoad(String assemblyString, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection) +141
   System.Reflection.Assembly.Load(String assemblyString) +25
   System.Web.Configuration.CompilationSection.LoadAssemblyHelper(String assemblyName, Boolean starDirective) +32

[ConfigurationErrorsException: Could not load file or assembly 'SQLite.NET, Version=0.21.1869.3794, Culture=neutral, PublicKeyToken=c273bd375e695f9c' or one of its dependencies. Failed to grant minimum permission requests. (Exception from HRESULT: 0x80131417)]
   System.Web.Configuration.CompilationSection.LoadAssemblyHelper(String assemblyName, Boolean starDirective) +596
   System.Web.Configuration.CompilationSection.LoadAllAssembliesFromAppDomainBinDirectory() +211
   System.Web.Configuration.CompilationSection.LoadAssembly(AssemblyInfo ai) +46
   System.Web.Compilation.BuildManager.GetReferencedAssemblies(CompilationSection compConfig) +177
   System.Web.Compilation.BuildProvidersCompiler..ctor(VirtualPath configPath, Boolean supportLocalization, String outputAssemblyName) +185
   System.Web.Compilation.ApplicationBuildProvider.GetGlobalAsaxBuildResult(Boolean isPrecompiledApp) +230
   System.Web.Compilation.BuildManager.CompileGlobalAsax() +49
   System.Web.Compilation.BuildManager.EnsureTopLevelFilesCompiled() +462

[HttpException (0x80004005): Could not load file or assembly 'SQLite.NET, Version=0.21.1869.3794, Culture=neutral, PublicKeyToken=c273bd375e695f9c' or one of its dependencies. Failed to grant minimum permission requests. (Exception from HRESULT: 0x80131417)]
   System.Web.Compilation.BuildManager.ReportTopLevelCompilationException() +57
   System.Web.Compilation.BuildManager.EnsureTopLevelFilesCompiled() +612
   System.Web.Hosting.HostingEnvironment.Initialize(ApplicationManager appManager, IApplicationHost appHost, IConfigMapPathFactory configMapPathFactory, HostingEnvironmentParameters hostingParameters) +644

[HttpException (0x80004005): Could not load file or assembly 'SQLite.NET, Version=0.21.1869.3794, Culture=neutral, PublicKeyToken=c273bd375e695f9c' or one of its dependencies. Failed to grant minimum permission requests. (Exception from HRESULT: 0x80131417)]
   System.Web.HttpRuntime.FirstRequestInit(HttpContext context) +3465427
   System.Web.HttpRuntime.EnsureFirstRequestInit(HttpContext context) +69
   System.Web.HttpRuntime.ProcessRequestInternal(HttpWorkerRequest wr) +279 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-27T19:11:43.023

您是否将 Web 应用程序配置为中等信任且 SQLite.NET 程序集需要完全信任？

查看是否将其添加到您的 web.config 修复它：

```
<system.web>
    <securityPolicy>
        <trust level="Full" />
    </securityPolicy>

...
</system.web> 
```

或者，如果您已经拥有信任标签，请将级别更改为完整。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-11-05T15:07:37.420

如果 slolife 答案不起作用，您也可以从[msdn (ASP.NET Trust Levels and Policy Files)](http://msdn.microsoft.com/en-us/library/wyts434y(v=vs.100).aspx)尝试此操作：

```
<system.web>
    <securityPolicy>
        <trustLevel name="Full"    policyFile="internal"/>
    </securityPolicy>
</system.web> 
```

# c++ - 您可以在迭代时从 std::list 中删除元素吗？

> ID：596162
> 
> 赞同：272
> 
> 时间：2009-02-27T19:08:20.567
> 
> 标签：c++, list, std

我的代码如下所示：

```
for (std::list<item*>::iterator i=items.begin();i!=items.end();i++)
{
    bool isActive = (*i)->update();
    //if (!isActive) 
    //  items.remove(*i); 
    //else
       other_code_involving(*i);
}
items.remove_if(CheckItemNotActive); 
```

我想在更新后立即删除不活动的项目，以避免再次遍历列表。但是，如果我添加注释掉的行，当我到达`i++`：“List iterator not incrementable”时会出现错误。我尝试了一些在 for 语句中没有增加的替代方法，但是我什么也做不了。

走 std::list 时删除项目的最佳方法是什么？

* * *

## 回答 #1

> 赞同：320
> 
> 时间：2009-02-27T19:11:26.067

您必须首先增加迭代器（使用 i++），然后删除前一个元素（例如，使用 i++ 的返回值）。您可以将代码更改为 while 循环，如下所示：

```
std::list<item*>::iterator i = items.begin();
while (i != items.end())
{
    bool isActive = (*i)->update();
    if (!isActive)
    {
        items.erase(i++);  // alternatively, i = items.erase(i);
    }
    else
    {
        other_code_involving(*i);
        ++i;
    }
} 
```

* * *

## 回答 #2

> 赞同：151
> 
> 时间：2009-02-27T19:18:02.133

你想做：

```
i= items.erase(i); 
```

这将正确更新迭代器以指向您删除的迭代器之后的位置。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-02-27T21:12:11.407

您需要结合 Kristo 的答案和 MSN 的：

```
// Note: Using the pre-increment operator is preferred for iterators because
//       there can be a performance gain.
//
// Note: As long as you are iterating from beginning to end, without inserting
//       along the way you can safely save end once; otherwise get it at the
//       top of each loop.

std::list< item * >::iterator iter = items.begin();
std::list< item * >::iterator end  = items.end();

while (iter != end)
{
    item * pItem = *iter;

    if (pItem->update() == true)
    {
        other_code_involving(pItem);
        ++iter;
    }
    else
    {
        // BTW, who is deleting pItem, a.k.a. (*iter)?
        iter = items.erase(iter);
    }
} 
```

当然，最高效和 SuperCool® STL 精明的东西应该是这样的：

```
// This implementation of update executes other_code_involving(Item *) if
// this instance needs updating.
//
// This method returns true if this still needs future updates.
//
bool Item::update(void)
{
    if (m_needsUpdates == true)
    {
        m_needsUpdates = other_code_involving(this);
    }

    return (m_needsUpdates);
}

// This call does everything the previous loop did!!! (Including the fact
// that it isn't deleting the items that are erased!)
items.remove_if(std::not1(std::mem_fun(&Item::update))); 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-02-27T19:29:32.947

使用`std::remove_if`算法。

**编辑：**
使用集合应该是这样的：

1.  准备收藏。
2.  过程采集。

如果您不混合这些步骤，生活会更轻松。

1.  `std::remove_if`. 或`list::remove_if`（如果您知道您使用的是 list 而不是 the `TCollection`）
2.  `std::for_each`

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2018-10-24T01:24:01.437

我已经总结了，这里是三个方法的例子：

### 1.使用`while`循环

```
list<int> lst{4, 1, 2, 3, 5};

auto it = lst.begin();
while (it != lst.end()){
    if((*it % 2) == 1){
        it = lst.erase(it);// erase and go to next
    } else{
        ++it;  // go to next
    }
}

for(auto it:lst)cout<<it<<" ";
cout<<endl;  //4 2 
```

### 2.使用`remove_if`列表中的成员函数：

```
list<int> lst{4, 1, 2, 3, 5};

lst.remove_if([](int a){return a % 2 == 1;});

for(auto it:lst)cout<<it<<" ";
cout<<endl;  //4 2 
```

### 3.使用`std::remove_if`函数结合`erase`成员函数：

```
list<int> lst{4, 1, 2, 3, 5};

lst.erase(std::remove_if(lst.begin(), lst.end(), [](int a){
    return a % 2 == 1;
}), lst.end());

for(auto it:lst)cout<<it<<" ";
cout<<endl;  //4 2 
```

### 4.使用`for`循环，要注意更新迭代器：

```
list<int> lst{4, 1, 2, 3, 5};

for(auto it = lst.begin(); it != lst.end();++it){
    if ((*it % 2) == 1){
        it = lst.erase(it);  erase and go to next(erase will return the next iterator)
        --it;  // as it will be add again in for, so we go back one step
    }
}

for(auto it:lst)cout<<it<<" ";
cout<<endl;  //4 2 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2011-08-05T12:57:59.763

克里斯托答案的替代循环版本。

你失去了一些效率，你在删除时后退然后再次前进，但是为了换取额外的迭代器增量，你可以在循环范围内声明迭代器并且代码看起来更干净。选择什么取决于当下的优先事项。

答案完全过时了，我知道...

```
typedef std::list<item*>::iterator item_iterator;

for(item_iterator i = items.begin(); i != items.end(); ++i)
{
    bool isActive = (*i)->update();

    if (!isActive)
    {
        items.erase(i--); 
    }
    else
    {
        other_code_involving(*i);
    }
} 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2013-07-04T20:37:39.527

这是一个使用`for`循环的示例，该循环迭代列表并在遍历列表期间删除项目时递增或重新验证迭代器。

```
for(auto i = items.begin(); i != items.end();)
{
    if(bool isActive = (*i)->update())
    {
        other_code_involving(*i);
        ++i;

    }
    else
    {
        i = items.erase(i);

    }

}

items.remove_if(CheckItemNotActive); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-27T19:29:58.580

删除仅使指向已删除元素的迭代器无效。

因此，在这种情况下，删除 *i 后， i 无效，您无法对其进行增量。

您可以做的是首先保存要删除的元素的迭代器，然后递增迭代器，然后删除保存的迭代器。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-06-03T23:55:26.260

如果您将其`std::list`视为队列，那么您可以将所有要保留的项目出队并入队，但只能出队（而不是入队）您要删除的项目。这是一个示例，我想从包含数字 1-10 的列表中删除 5 ...

```
std::list<int> myList;

int size = myList.size(); // The size needs to be saved to iterate through the whole thing

for (int i = 0; i < size; ++i)
{
    int val = myList.back()
    myList.pop_back() // dequeue
    if (val != 5)
    {
         myList.push_front(val) // enqueue if not 5
    }
} 
```

`myList`现在只有数字 1-4 和 6-10。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2019-03-13T04:52:05.660

向后迭代避免了擦除元素对要遍历的剩余元素的影响：

```
typedef list<item*> list_t;
for ( list_t::iterator it = items.end() ; it != items.begin() ; ) {
    --it;
    bool remove = <determine whether to remove>
    if ( remove ) {
        items.erase( it );
    }
} 
```

PS：参见[this](https://stackoverflow.com/a/3610963/2707864)，例如，关于反向迭代。

PS2：我没有彻底测试它是否能很好地处理末端的擦除元素。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-03-26T09:06:31.153

你可以写

```
std::list<item*>::iterator i = items.begin();
while (i != items.end())
{
    bool isActive = (*i)->update();
    if (!isActive) {
        i = items.erase(i); 
    } else {
        other_code_involving(*i);
        i++;
    }
} 
```

您可以使用 编写等效代码`std::list::remove_if`，这样更简洁且更明确

```
items.remove_if([] (item*i) {
    bool isActive = (*i)->update();
    if (!isActive) 
        return true;

    other_code_involving(*i);
    return false;
}); 
```

`std::vector::erase` `std::remove_if`当 items 是一个向量而不是一个列表以保持 O(n) 的复杂性时，应该使用该习语 - 或者如果您编写通用代码并且 items 可能是一个没有有效方法擦除单个项目的容器（如向量）

```
items.erase(std::remove_if(begin(items), end(items), [] (item*i) {
    bool isActive = (*i)->update();
    if (!isActive) 
        return true;

    other_code_involving(*i);
    return false;
})); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-07-12T19:16:13.250

做while循环，灵活、快速、易读易写。

```
auto textRegion = m_pdfTextRegions.begin();
    while(textRegion != m_pdfTextRegions.end())
    {
        if ((*textRegion)->glyphs.empty())
        {
            m_pdfTextRegions.erase(textRegion);
            textRegion = m_pdfTextRegions.begin();
        }
        else
            textRegion++;
    } 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-05-08T05:37:47.883

我想分享我的方法。此方法还允许在迭代期间将元素插入到列表的末尾

```
#include <iostream>
#include <list>

int main(int argc, char **argv) {
  std::list<int> d;
  for (int i = 0; i < 12; ++i) {
    d.push_back(i);
  }

  auto it = d.begin();
  int nelem = d.size(); // number of current elements
  for (int ielem = 0; ielem < nelem; ++ielem) {
    auto &i = *it;
    if (i % 2 == 0) {
      it = d.erase(it);
    } else {
      if (i % 3 == 0) {
        d.push_back(3*i);
      }
      ++it;
    }
  }

  for (auto i : d) {
      std::cout << i << ", ";
  }
  std::cout << std::endl;
  // result should be: 1, 3, 5, 7, 9, 11, 9, 27,
  return 0;
} 
```

* * *

## 回答 #14

> 赞同：-4
> 
> 时间：2012-09-18T16:15:53.900

我认为你有一个错误，我这样编码：

```
for (std::list<CAudioChannel *>::iterator itAudioChannel = audioChannels.begin();
             itAudioChannel != audioChannels.end(); )
{
    CAudioChannel *audioChannel = *itAudioChannel;
    std::list<CAudioChannel *>::iterator itCurrentAudioChannel = itAudioChannel;
    itAudioChannel++;

    if (audioChannel->destroyMe)
    {
        audioChannels.erase(itCurrentAudioChannel);
        delete audioChannel;
        continue;
    }
    audioChannel->Mix(outBuffer, numSamples);
} 
```

# sql - 如何从 SQL 结果中提取数值数据

> ID：596166
> 
> 赞同：3
> 
> 时间：2009-02-27T19:09:15.570
> 
> 标签：sql, db2

假设有一个包含 2 列的表“A” - ID (INT)、DATA (VARCHAR(100))。执行“SELECT DATA FROM A”会生成一个表，如下所示：

```
DATA
---------------------
Nowshak 7,485 m
Maja e Korabit (Golem Korab) 2,764 m
Tahat 3,003 m
Morro de Moco 2,620 m
Cerro Aconcagua 6,960 m (located in the northwestern corner of the province of Mendoza)
Mount Kosciuszko 2,229 m
Grossglockner 3,798 m
// the DATA continues...
--------------------- 
```

如何在 SELECT SQL 查询中使用某种字符串处理函数仅提取数字数据，以便修改后的 SELECT 的结果如下所示：

```
DATA (in INTEGER - not varchar)
---------------------
7485
2764
3003
2620
6960
2229
3798
// the DATA in INTEGER continues...
--------------------- 
```

顺便说一句，如果这可以在单个 SQL 语句中完成，那将是最好的。（我使用的是 IBM DB2 9.5 版）

谢谢 ：）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-08-26T00:27:51.443

我知道这个线程很旧，并且 OP 不需要答案，但我必须通过这个线程和其他线程的一些提示来解决这个问题。他们似乎都错过了确切的答案。

执行此操作的简单方法是将`TRANSLATE`所有不需要的字符转换为单个字符，然后`REPLACE`将该单个字符转换为空字符串。

```
DATA = 'Nowshak 7,485 m'

# removes all characters, leaving only numbers
REPLACE(TRANSLATE(TRIM(DATA), '_____________________________________________________________________________________________', ' abcdefghijklmnopqrstuvwzyaABCDEFGHIJKLMNOPQRSTUVWXYZ`~!@#$%^&*()-_=+\|[]{};:",.<>/?'), '_', '')
 => '7485' 
```

* * *

分解`TRANSLATE`命令：

```
TRANSLATE( FIELD or String, <to characters>, <from characters> ) 
```

例如

```
DATA = 'Sample by John'

TRANSLATE(DATA, 'XYZ', 'abc')
 => a becomes X, b becomes Y, c becomes Z
 => 'SXmple Yy John' 
```

** 注意：我无法谈论性能或版本兼容性。我使用的是 9.x 版本的 DB2，并且是这项技术的新手。希望这可以帮助某人。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T21:40:49.247

在线快速搜索 DB2，我能找到的最好的内置功能是[Translate](http://publib.boulder.ibm.com/infocenter/dzichelp/v2r2/index.jsp?topic=/com.ibm.db29.doc.sqlref/db2z_bif_translate.htm "翻译") ，它允许您指定要更改为其他字符的字符列表。这并不理想，但是您可以指定要删除的每个字符，即每个可用的非数字字符...

（是的，这是一个很长的列表，很长的列表，这就是为什么我说它不理想）

TRANSLATE('data', 'abc...XYZ,./\<>?|[等等]', ' ')

或者，您需要创建一个用户定义的函数来搜索号码。有几种选择。

1.  一个一个地检查每个字符，只有当它是数字时才保留它。

2.  如果您知道数字前面的内容和数字后面的内容，则可以搜索这些内容并保留介于两者之间的内容...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-27T19:15:02.267

在`Oracle`：

```
SELECT TO_NUMBER(REGEXP_REPLACE(data, '[^0-9]', ''))
FROM a 
```

在`PostgreSQL`：

```
SELECT CAST(REGEXP_REPLACE(data, '[^0-9]', '', 'g') AS INTEGER)
FROM a 
```

在[`MS SQL Server`](http://msdn.microsoft.com/magazine/cc164512.aspx)and[`DB2`](http://www.ibm.com/developerworks/data/library/techarticle/0301stolze/0301stolze.html)中，您需要`UDF`像这样为正则表达式和查询创建 's。

有关更多详细信息，请参阅链接。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-19T03:50:17.003

为了详细说明 Dems 的建议，我使用的方法是一个标量用户定义函数 (UDF)，它接受一个字母数字字符串并递归地遍历该字符串（每次迭代一个字节）并抑制输出中的非数字字符。递归表达式每次迭代都会生成一行，但只保留最后一行并将其返回给调用应用程序。

# children - 适合7岁小孩的环境

> ID：596170
> 
> 赞同：39
> 
> 时间：2009-02-27T19:09:35.600
> 
> 标签：children

我 7 岁的孩子想学习，如何编程？（他的想法不是我的，而且他在外面的世界里做事。所以，从这个角度来看，我并不太担心。他竟然从我的办公室里拿出一本游戏编程书在睡前阅读。 ) 前几天我们坐下来写了一个非常简单的猜数字游戏（你选 8 就对了，其他都是错的）。

一切顺利，但他根据语言的语法提出了许多问题。（我碰巧选择了 Java，因为当时我打开了 IDE。）我教中学后的入门编程课程，所以这让我大开眼界（大多数高中毕业的学生都不愿意问问题）我真的不得不弄清楚，如何向 7 岁的孩子解释语法？

显然，任何 C 类型语言都会有同样的问题，大多数“语言”也是如此。我看着吱吱声，但决定不使用它。我查看了 Alice 环境，但也不喜欢它。

从物理的角度来看，他对键盘/鼠标感到满意，并且可以相对轻松地组装乐高套装（因此，遵循具有有趣结果的指示对他有用）。我可以使用 Lego NXT，但他仍然有点年轻（即使使用提供的图形环境，也需要很长时间才能看到工作结果）。

理想情况下，我希望这些经验可以帮助他建立对数学和逻辑的信心（如果 7 岁的孩子有逻辑：-）。

我记得小时候使用海龟图形/徽标。我倾向于这个，但想知道是否还有其他想法，或者是否有人可以推荐一个好的标志环境？

编辑1：

徽标效果很好。我需要教他角度的概念（90 度、180 度）。不幸的是，他们在学校还没有真正做除法，所以角度可能很有趣......

首先画一个正方形：

```
FORWARD 50
RIGHT 90
FORWARD 50
RIGHT 90
FORWARD 50
RIGHT 90
FORWARD 50
RIGHT 90 
```

稍后我将进入循环：

```
REPEAT 4 
[
    FORWARD 50
    RIGHT 90
] 
```

然后变量：

```
make "length 50

REPEAT 4 
[
    FORWARD :length
    RIGHT 90
] 
```

这非常有效。几乎没有语法，对于 7 岁的孩子来说很容易记住词汇和即时反馈。

编辑2：

嗯，这是成功的，因为他能够在我不在房间时编写一个简单的程序（还没有循环）。实际上效果很好——我们出去拿了方格纸和量角器，我们计算出 90 度角，然后他做了一堆正方形，把正方形变成了矩形，然后看看他哪里出错了如何调试它。我会向对编程感兴趣的 7 岁儿童推荐这种方法。我想我也会向我的大专学生推荐它（！）

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-27T19:14:45.277

Javascript 中实际上有一个基于浏览器的 Logo 解释器。

[http://logo.twentygototen.org/](http://logo.twentygototen.org/)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-02-27T19:26:26.933

我非常不同意那些说七岁孩子很难学习新语法的人。这完全是倒退。尝试向七岁的孩子和三十多岁的非英语母语者教授猪拉丁语。或尝试与您的孩子在国外旅行。看看一个月后谁能和当地人流利地聊天（提示：可能不是你）。

与我们白发苍苍的孩子相比，孩子们掌握任意语言惯例的速度**要快得多。**

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-02-27T20:27:02.187

我在 10 岁时就按照您教儿子的方式学习了如何 **编程**。我爸爸使用我们 AT&T PC6300 附带的 GW-Basic 解释器，我们编写了一个游戏，电脑问你一个问题，你必须回答 A/B/C。GW-Basic 中语法的一大优势是您没有多行语句。你可能想尝试类似的东西。Java，带有花括号，可能有点难。

示例代码：

```
10 PRINT "What color is Big Bird?"
20 PRINT "A. Blue"
30 PRINT "B. Green"
40 PRINT "C. Yellow"
50 INPUT$ ANSWER$
60 IF ANSWER$ = "C" THEN PRINT "Good Job!" ELSE PRINT "Oops, wrong answer!" 
```

我花了几个小时使用该语法的各种排列并编写自己的“游戏”。它让我想了解更多......可能会有所帮助。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-02-27T19:23:19.233

告诉他解析器。您只需要为事物存在的原因添加上下文和推理。花括号是为了让读取代码的机器知道事情从哪里开始和停止。

我发现只要你解释它们的**目的**，包括孩子在内的大多数人都很容易拿起东西。这就是为什么学校对我来说是一个可怕的失败，没有人解释过学习一半东西的意义。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-27T19:13:55.763

我认为 Python 可能适合您的需求。众所周知，它比许多其他语言更容易学习，交互式解释器允许程序员立即看到执行一段代码时会发生什么。随附的 IDLE gui 易于使用。它还有一个通过 TKinter 的海龟模块。

[https://docs.python.org/library/turtle.html](https://docs.python.org/library/turtle.html)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-02-27T20:15:32.090

[划痕](http://Scratch.MIT.Edu/)是另一个。在麻省理工学院开发，专门用于向儿童教授编程。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-02-27T19:15:25.667

从发展的角度来看，一个七岁的孩子即使在口语中也不太可能掌握语法的基础知识。

无论您使用哪种语言或环境，我都建议您专注于将编程作为游戏的想法，而不是编写实际程序的能力。为此，您可以从命令行运行并立即查看结果，例如 Python，或者为了获得更多图形体验，Silverlight 可能是最好的。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-02-27T19:20:32.690

微软有一些有趣的努力似乎很合适：

*   popfly： http: [//msdn.microsoft.com/en-us/devlabs/cc950523.aspx](http://msdn.microsoft.com/en-us/devlabs/cc950523.aspx) ---“Popfly 包含一种创建和与朋友分享游戏的简单方法。从各种内置模板中选择或开始从头开始创建横向滚动游戏、2D 射击游戏或许多其他游戏。最重要的是，您无需编写一行代码即可开始“......我认为这真的有助于激发动力:)

    *   smallbasic： http: [//msdn.microsoft.com/en-us/devlabs/cc950524.aspx](http://msdn.microsoft.com/en-us/devlabs/cc950524.aspx) ---应该是简化的，但有智能感知+.net框架支持（简短的描述太营销了，所以我没有粘贴它：P）

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-02-27T19:27:49.753

试试[Small Basic](http://msdn.microsoft.com/en-us/devlabs/cc950524.aspx)，它有一个 mini-BASIC 语言并且为年轻的人群简化了。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-02-28T03:50:14.647

逃离爪哇！尝试为教学设计的东西，例如[从头开始](http://scratch.mit.edu)、LOGO 或[PLT 方案](http://plt-scheme.org)。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-02-27T19:21:37.430

为什么不回到 QBasic 的时代呢？那是我学的第一门语言（实际上是 GW-BASIC，但这无关紧要）。

语法更容易理解（尽管变化无常，有时令人沮丧）。它没有教任何面向对象的东西，但无论如何这可能在他的头上，因为它本来是我的。

[这个网站](http://www.tedfelix.com/qbasic/)可能也很有趣。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-02-27T20:32:50.503

我会说使用visual basic，或者类似的东西，你不必担心语法、花括号等。我在 7 岁时编程，但它是在 LOGO 和 C64 Basic 中的。我讨厌 LOGO……这让我非常沮丧，以至于你能做的“大”事情之一就是绕过一只愚蠢的乌龟。然而，C64 Basic（对我来说）很棒……一旦我把它弄下来（几年），我就很兴奋地学习 C 甚至 C64 汇编程序。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-02-27T20:45:50.253

想到了两个想法：

*   我 3 岁的儿子喜欢和我一起玩[World of Goo](http://worldofgoo.com)。他还不能解决问题，但我可以看到他正在吸收大量信息。
*   [和爱丽丝](http://www.alice.org)一起去吧。我的儿子太小了，不能尝试这个，但是一旦他长大了，如果他热衷的话，我们会试一试。FWIW 在观看Randy Pausch (RIP)[的 The Last Lecuture](http://www.thelastlecture.com)后，我了解了这个程序

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-04-15T12:31:00.487

让他查看[http://scratch.mit.edu](http://scratch.mit.edu)。我七岁的孩子在我们打字时正在学习这个......

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-02-27T19:21:27.977

[Etoys](http://www.squeakland.org/about/)也许是您正在寻找的东西。这是专为儿童制作的部分图形化的 smalltalk。这是 olpc 项目使用的。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-02-27T19:29:00.157

[我参与了一个使用Stagecast](http://www.stagecast.com/)的小学计算机课程。这是一种专为儿童设计的图形编程语言。我发现它是一种理想的介绍性语言，因为它是图形化的和交互式的。它不需要阅读或数学，它可以在 Windows 和 Mac OS 上运行，非常适合简单的游戏，让孩子们有学习的动力。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-02-27T20:55:58.060

虽然看起来它正在重新设计，但您仍然可以获得旧版本的[Hackety Hack](http://hacketyhack.net/get/)，这是一个由 _why 为青少年和初级程序员设计的 ruby​​ 编程工具包。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-02-27T23:01:41.097

我对爱丽丝有点失望。

一方面，很高兴有一个框架，您可以在其中以直接的视觉满足感进行编程。这真是个好主意。

另一方面，我认为让初学者完全通过拖放进行编程是一个非常糟糕的主意。我担心这甚至可能导致一种文盲，当拖放界面被取消时，他们无法生成正确编写的代码。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-02-28T06:26:16.490

就个人而言，我认为算术运算和布尔逻辑的基础知识首先教给孩子更重要。在他们掌握了这些概念之后，我认为转向基本结构是合适的。我只是不明白一个孩子如何在没有布尔逻辑的情况下理解条件和循环，但话又说回来，那里有一些非常聪明的孩子:)

假设前面的陈述得到满足，我将不得不为 python 投票。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-02-27T19:24:17.687

我会寻找许多街机游戏引擎中的一种，然后让他玩。选择一个他需要使用循环和条件的地方，也许还有一些程序。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-02-27T23:07:13.127

有一本书叫Learning to program from pragmatic，它面向那些以前从未编程过并且可能不是非常技术性的人。

它使用 Ruby，对于新手来说很容易上手。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-02-27T23:23:43.603

[Squeak Smalltalk 系统](http://www.squeak.org)是 Smalltalk 的一个实现，我在教育儿童编程方面听到了很多好消息。[Etoys 项目](http://www.squeakland.org/)据称包含大量资源，可让学习体验保持乐趣和激励。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-02-28T03:59:53.580

当我在高中时接触到图灵语言时，我对编程产生了兴趣。当时很多学校都使用图灵作为教学语言，它对我介绍编程概念非常有效。这是来自维基百科的图灵[描述](http://en.wikipedia.org/wiki/Turing_(programming_language))

*图灵是一种类似 Pascal 的编程语言，由当时的加拿大多伦多大学的 Ric Holt 和 James Cordy 于 1982 年开发。Turing 是 Euclid、Pascal 和 SP/k 的后代，具有简洁的语法和精确的机器无关语义。*

*图灵以英国计算机科学家艾伦·图灵命名，主要用作高中和大学水平的教学语言。存在其他两个版本，面向对象的图灵和图灵加，一种系统编程变体。2001年9月，“面向对象的图灵”更名为“图灵”，原来的图灵更名为“经典图灵”。图灵可从多伦多的 Holt Software Associates 获得。*

*提供适用于 Microsoft Windows、Linux 和 Apple Macintosh 的版本。图灵在安大略省的高中仍然被广泛用作编程的介绍。*

*2007 年 11 月，以前是商业化的编程语言的图灵成为免费软件。自 2007 年 11 月 28 日起，可从 Holt Software 网站免费下载，用于个人、商业和教育用途。[1](http://en.wikipedia.org/wiki/Turing_(programming_language))*

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2009-02-28T07:39:33.457

您也可以使用 Commodore 64 模拟器。它从 BASIC 开始。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2009-04-15T12:41:18.357

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2009-06-12T20:36:53.880

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2009-06-12T20:41:47.317

我最近回答了一个类似的[SO 问题](https://stackoverflow.com/questions/960935/would-shell-scripting-be-a-good-language-to-teach-a-kid-some-very-simple-programm/961030#961030)，其中提到了[kidbasic](http://kidbasic.sourceforge.net)，它是开源和跨平台软件。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2009-06-12T20:53:07.600

Scheme 很好，在语法上与 Logo 相似，就简单而言。此外，Scheme 提供了一种非常直观的方式来理解递归，并在计算机科学中学习这些类型的基本概念，这些概念在早期只不过是更好的更好。

UCB Scheme 还提供了许多用于操作句子的内置功能，这对于 7 岁的孩子来说可能比构建多边形和解决数字谜题更有意义（并不是说天空是极限！）。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2009-07-01T04:17:52.157

我在二年级时正在输入“BASIC Fun”一书中的程序。

我清楚地记得无限循环和 INPUT A$ 的概念就像发现重力一样。令人头疼的东西。

自学成才，我的进步非常缓慢，尽管我确实在程序中达到了希望 GOSUB 接受可变参数的程度，回想起来这意味着我理解函数指针。

我早期的目标包括编写 LONG 程序。对于一个 7 岁的孩子来说，一个冗长的计划并不是一个坏目标，因为一个具有明确规范的计划会使失败的风险太高。任何人都可以编写一个*很长*的程序并对此感觉良好，并在此过程中学到很多东西。

从 80 年代开始，就有各种各样的 BASIC 编程书籍。这些东西是编程思想的重要来源。但是，即使是 7 岁的孩子，我也不建议使用 BASIC —— lua 具有 BASIC 的简单感觉，但它并不是废话。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2009-07-17T06:35:36.153

别再看了，实际上有一个完整的学习平台/操作系统就是为此目的而设计的：**Sugar**。

**[名为Sugar](http://en.wikipedia.org/wiki/Sugar_(interface))**的**OLPC（每个孩子一台笔记本电脑）**操作系统现已向公众开放，您可以在 Mac、Windows 和 Linux 等所有主要操作系统中将其作为 VM 运行。

[在Sugar Labs](http://www.sugarlabs.org/)下载副本。

其中一项有趣的活动称为 TurtleArt，这是 21 世纪版本的 Logo。还有一个名为 Pippy 的儿童友好版本的 Python IDE。***它实际上教孩子们 Python！***

参见[TurtleArt](http://wiki.sugarlabs.org/go/Activities/TurtleArt)和[Pippy](http://wiki.laptop.org/go/Pippy)以及 Sugar 中的[其他活动](http://www.sugarlabs.org/index.php?template=page&page=about_activities)。

Alan Kay 支持 Sugar OS 中的一些新颖概念，这实际上是他富有远见的 DynaBook 的现代化身。即使作为一个成年人（他是一名工程师），我也觉得和我一起玩很有趣。

如果您喜欢将 Sugar 作为虚拟机，您甚至可以购买硬件，同时帮助世界其他地方的穷孩子。

Engadget 解释：[OLPC XO Buy-One, Give-One 计划正在进行中](http://www.engadget.com/2007/11/12/olpc-xo-buy-one-give-one-program-underway-399/)

![OLPC 牛](https://www.blogcdn.com/www.engadget.com/media/2007/11/olpc-xo-bogo.jpg)

*作为对我们成年人的奖励*，Sugar 源自 Fedora。所以它是一个真正完整的基于 Linux 的操作系统。破解应该很有趣。;-)

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2011-02-16T13:26:13.237

**我和我 6 岁的Greenfoot** (http://www.greenfoot.org/)一起玩得很开心。它以对象为中心，视觉/图形，我的孩子很喜欢。

# perl - 为什么 Perl 的 PAR 找不到 Socket.pm 的可加载对象？

> ID：596173
> 
> 赞同：4
> 
> 时间：2009-02-27T19:10:15.553
> 
> 标签：perl, cpan, multiplatform, par

我使用 PAR::Packer 在 Cygwin 上打包我的 Perl 应用程序，然后在 HPUX 上运行它。

一个简单的 hello world 运行良好，例如：

```
pp -p hello.pl 
```

这导致 a.par 然后在 HPUX 上：

```
parl a.par 
```

它工作得很好。

但是，当使用 -B 捆绑开关打包具有许多依赖项的更大应用程序时，没有这样的运气，而是出现错误：

```
 Can't locate loadable object for module Socket in @INC 
```

任何想法，也许是 Windows/unix 网络的一些问题？有什么修复吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T19:18:55.470

您之所以遇到这个问题，是因为 Socket 加载了一个共享库，并且它不能跨平台移植（也就是说，Windows 上的 Socket 共享库在 Linux 上不起作用，在 HPUX 上不起作用）。

你可以尝试两件事：

1.  确定您需要共享库的所有位置，并在您的目标平台上进行本地安装。您可能还需要从 PAR 存档中排除这些模块。
2.  切换到纯 Perl 实现（（更多）可移植的）。如果您不是 Perl、C 和您的目标平台的专家，并且还没有纯 Perl 版本，那么您可能不走运。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T20:07:27.367

在你的 HPUX 上安装一个实际的 perl 的好处是你的 cygwin 应用程序可以在 hpux perl 上运行。PAR 包通常不会在任何两个平台之间工作。在我看来，这与在 cygwin 上生成 hello.exe 并尝试在 HPUX 上运行它并没有什么不同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T18:28:21.633

Perl blixtor 来自评论的建议我正在移动我在问题中的“编辑更新”来回答我自己的问题：

这里的大部分功劳归功于 Andrew Barnett，两个关键问题是

1.  本机 C 代码库
2.  perl LIB 路径

以下是我为使 cygwin 创建的 par 在 HPUX 上运行所遵循的步骤，我相信在任何 unix 上的步骤应该大致相同：

遵循 Andrew 的建议并使用**pp -X IO::Socket**开关删除了 IO::Socket ，但随后在 unix 上运行生成的 parl 我得到了一些修改但仍然相关错误：

```
Can't locate Socket.pm in @INC (@INC contains: CODE(0x406ab018) CODE(0x4055c880) CODE(0x40563978)) at Net/Config.pm line 11 
```

即使在 unix 上运行“perl -MCPAN -e shell”显示 Socket 应该已安装并且是最新的：

```
cpan[2]> install IO::Socket
IO::Socket is up to date (1.30_01). 
```

因此，除了使用 -X 开关排除 Socket 之外，我还必须在 HPUX 上创建一个包装脚本，其中只有这 1 行，wrapper.pl：

```
use PAR { file => 'bdiff.par', run => 'bdiff.pl' }; 
```

然后要运行它，我没有使用 parl，而是只用 perl 调用它，我必须使用 -I 开关将整个路径提供到默认 lib 路径，如下所示：

```
perl -I/lib/perl5/lib/5.10.0/PA-RISC2.0 -I/lib/lib/site_perl wrapper.pl allparameters 
```

由于某种原因，在使用 parl 时，似乎默认的 lib 路径被排除在外，因此上面的完整路径。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-08-13T20:33:17.320

FWIW，PAR 的设计目的不是跨不同平台可移植——不要指望在 cygwin 上创建的 par 包可以在 linux/hpux 上运行......

# c++ - 是否可以从 C++ 中的模板类型中获取 char* 名称

> ID：596185
> 
> 赞同：10
> 
> 时间：2009-02-27T19:12:27.670
> 
> 标签：c++, string, templates, typeid

我想获取模板类型的字符串名称（const char*）。不幸的是，我无法访问 RTTI。

```
template< typename T >
struct SomeClass
{
    const char* GetClassName() const { return /* magic goes here */; }
} 
```

所以

```
SomeClass<int> sc;
sc.GetClassName();   // returns "int" 
```

这可能吗？我找不到方法，准备放弃。谢谢您的帮助。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-27T19:53:10.207

不，它也不能与 typeid 一起工作。它将为您提供一些取决于编译器实现的内部字符串。像“int”这样的东西，但“i”也很常见`int`。

顺便说一句，如果您只想比较两种类型是否相同，则无需先将它们转换为字符串。你可以做

```
template<typename A, typename B>
struct is_same { enum { value = false }; };

template<typename A>
struct is_same<A, A> { enum { value = true }; }; 
```

然后做

```
if(is_same<T, U>::value) { ... } 
```

Boost 已经有了这样的模板，下一个 C++ 标准也会有`std::is_same`。

## 手动注册类型

您可以专注于以下类型：

```
template<typename> 
struct to_string {
    // optionally, add other information, like the size
    // of the string.
    static char const* value() { return "unknown"; }
};

#define DEF_TYPE(X) \
    template<> struct to_string<X> { \
        static char const* value() { return #X; } \
    }

DEF_TYPE(int); DEF_TYPE(bool); DEF_TYPE(char); ... 
```

所以，你可以像这样使用它

```
char const *s = to_string<T>::value(); 
```

当然，如果你想在类型未知的情况下获得编译时错误，你也可以去掉主模板定义（只保留前向声明）。我只是将其包含在此处以完成。

我以前使用过 char const* 的静态数据成员，但它们会导致一些复杂的问题，例如在何处放置它们的声明等问题。像上面这样的类专业化很容易解决这个问题。

## 自动，取决于 GCC

另一种方法是依赖编译器内部。在 GCC 中，以下给出了合理的结果：

```
template<typename T>
std::string print_T() {
    return __PRETTY_FUNCTION__;
} 
```

归来`std::string`。

> `std::string print_T() [with T = std::basic_string<char, std::char_traits<char>, std::allocator<char> >]`

一些`substr`混合的魔法`find`会给你你寻找的字符串表示。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-27T19:23:16.893

**真正简单的解决方案：**只需将一个字符串对象传递给 SomeClass 的构造函数，该构造函数说明类型是什么。

例子：

```
#define TO_STRING(type) #type
SomeClass<int> s(TO_STRING(int)); 
```

只需将其存储并显示在 GetClassName 的实现中。

**稍微复杂的解决方案，但仍然很容易：**

```
#define DEC_SOMECLASS(T, name) SomeClass<T> name;  name.sType = #T; 

template< typename T >
struct SomeClass
{
    const char* GetClassName() const { return sType.c_str(); }
    std::string sType;
};

int main(int argc, char **argv)
{
    DEC_SOMECLASS(int, s);
    const char *p = s.GetClassName();

    return 0;
} 
```

**模板非类型解决方案：**

您还可以创建自己的类型 ID，并具有在 ID 和字符串表示之间进行转换的函数。

然后可以在将类型声明为模板非类型参数时传递 ID：

```
template< typename T, int TYPEID>
struct SomeClass
{
    const char* GetClassName() const { return GetTypeIDString(TYPEID); }
};

...

SomeClass<std::string, STRING_ID> s1;
SomeClass<int, INT_ID> s2; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-27T19:33:25.590

您可以尝试这样的事情（警告这只是我的想法，所以可能会出现编译错误等。）

```
template <typename T>
const char* GetTypeName()
{
    STATIC_ASSERT(0); // Not implemented for this type
}

#define STR(x) #x
#define GETTYPENAME(x) str(x) template <> const char* GetTypeName<x>() { return STR(x); }

// Add more as needed
GETTYPENAME(int)
GETTYPENAME(char)
GETTYPENAME(someclass)

template< typename T >
struct SomeClass
{
    const char* GetClassName() const { return GetTypeName<T>; }
} 
```

这适用于您为其添加`GETTYPENAME(type)`行的任何类型。它的优点是无需修改您感兴趣的类型即可工作，并且可以使用内置类型和指针类型。它确实有一个明显的缺点，即您必须为每种要使用的类型设置一行。

如果不使用内置的 RTTI，您将不得不自己在某处添加信息，无论是 Brian R. Bondy 的答案还是 dirkgently 的都可以。除了我的回答之外，您还可以在三个不同的位置添加该信息：

1.  在对象创建时使用`SomeClass<int>("int")`
2.  在使用 dirkgently 的编译时 RTTI 或虚函数的类中
3.  使用我的解决方案的模板。

这三个都可以工作，这只是在你的情况下你会在哪里得到最少的维护头痛。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-27T19:15:52.170

您无权访问 RTTI，这是否意味着您不能使用 typeid(T).name()？因为这几乎是在编译器的帮助下完成它的唯一方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-27T21:14:14.367

类型具有唯一名称是否非常重要，或者名称是否会以某种方式持久化？如果是这样，你应该考虑给他们一些比代码中声明的类名更健壮的东西。您可以通过将两个类放在不同的名称空间中来为它们赋予相同的非限定名称。您还可以在 Windows 上将两个具有相同名称（包括命名空间限定）的类放在两个不同的 DLL 中，因此您还需要在名称中包含 DLL 的标识。

当然，这完全取决于你要对字符串做什么。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-27T19:16:48.563

你可以自己添加一点魔法。就像是：

```
#include <iostream>

#define str(x) #x
#define xstr(x) str(x)
#define make_pre(C) concat(C, <)
#define make_post(t) concat(t, >)

#define make_type(C, T) make_pre(C) ## make_post(T)
#define CTTI_REFLECTION(T, x)  static std::string my_typeid() \
                               { return xstr(make_type(T, x)); }

// the dark magic of Compile Time Type Information (TM)
#define CTTI_REFLECTION(x)  static const char * my_typeid() \
                                  { return xstr(make_type(T, x)); }

#define CREATE_TEMPLATE(class_name, type) template<> \
                                    struct class_name <type>{ \
                                        CTTI_REFLECTION(class_name, type) \
                                    }; 

// dummy, we'll specialize from this later
template<typename T> struct test_reflection;

// create an actual class
CREATE_TEMPLATE(test_reflection, int)

struct test_reflection {
  CTTI_REFLECTION(test_reflection)
};

int main(int argc, char* argv[])
{
    std::cout << test_reflection<int>::my_typeid();
} 
```

我将使检查员成为一个`static`函数（因此非`const`）。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-02-27T19:15:00.033

不，对不起。

如果您尝试在 int 上使用它，RTTI 甚至不会编译。

# powershell - 在 Vista 中自动设置双显示器

> ID：596186
> 
> 赞同：5
> 
> 时间：2009-02-27T19:12:37.967
> 
> 标签：powershell, automation, accessibility

我使用笔记本电脑作为我的主要工作站。有时我独自工作，但大部分时间，我在办公桌前，连接外接显示器以增加工作空间。

每次执行此操作时，我都会单击 Windows Vista 中的相同对话框来设置双屏并定位窗口。这似乎是一项我可以自动化的可重复任务。

我希望能够插入我的显示器电缆，双击一个程序并让它自动配置显示器。

什么类型的程序可以做到这一点？我在网上没有找到太多相关的。我正在考虑尝试使用自动热键脚本或带有 PowerShell 的 Windows 可访问性 API。这个问题已经解决了吗？

澄清：我特别希望自动化我使用鼠标调用 Windows Vista 中的基本功能的步骤。

1.  右键单击桌面
2.  在上下文菜单中选择个性化
3.  点击显示设置
4.  单击监视器＃2，然后单击复选框以“将桌面扩展到此监视器”
5.  单击并将监视器#2 拖到监视器#1 的左侧
6.  单击确定关闭对话框
7.  在随后的弹出窗口中单击是以接受这些监视器设置

**更新：Windows 7 会自动执行此操作**

我刚刚升级到 Windows 7，它记住了我的双显示器设置。我在上面列出的工作中设置了一次，然后在周末拔掉电源并在家工作。我周一早上进来，开机，插上电源，哇！它刚刚奏效。感谢 Windows 7！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-29T13:04:14.060

我还没有看到执行此操作的现有实用程序，但使用 Win32 API 编写一个非常容易。通过[此页面](http://msdn.microsoft.com/en-us/library/dd162617(VS.85).aspx)，[EnumDisplayDevices](http://msdn.microsoft.com/en-us/library/dd162609(VS.85).aspx)获取显示设备列表，[EnumDisplaySettingsEx](http://msdn.microsoft.com/en-us/library/dd162612(VS.85).aspx)获取当前设置，[ChangeDisplaySettingsEx](http://msdn.microsoft.com/en-us/library/dd183413(VS.85).aspx)将进行更改。

DEVMODE.dmPosition 字段应包含显示器左上角的虚拟坐标，主显示器始终为 (0,0)，其他相对于该坐标。

该工具需要两种模式，第一种将当前设置保存到配置文件，第二种应用配置中的设置。我只存储/检索 ChangeDisplaySettingsEx 文档中提到的显示设备索引、名称和每个 DEVMODE.dm* 字段。基于文本的配置允许手动编辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T19:13:19.743

尝试[UltraMon](http://www.realtimesoft.com/ultramon/)以获得出色的双显示器支持。多年来，我一直在许多不同的笔记本电脑和台式机上使用它，并且效果很好。我只使用过 XP，所以我不确定它如何与 Vista 配合使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T19:30:53.677

我的 Leovo T60p 无需任何特殊步骤即可自动执行此操作。尝试升级您的视频驱动程序，并检查制造商的网站是否有任何可以执行此操作的实用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-10T16:34:26.710

如果你有 windows vista 或 7，你可以点击 windows_key + P。你有很多选项可供选择，包括扩展

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-29T12:35:34.457

我相信 Ultramon 实际上会起作用。在系统托盘中 Ultramon 图标的右键菜单中，有一个“禁用/启用辅助”命令。

我想你可以简单地：

1.  插入第二台显示器
2.  选择“启用辅助”

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-03-22T18:30:52.767

三年后，我在这里回答我自己的问题！耶！！！

这很容易用[http://www.autohotkey.com编写脚本](http://www.autohotkey.com)

这是一个示例脚本，用于在一台显示器和两台使用 Windows+1 和 Windows+2 的显示器之间进行交换。AutoHotKey 还允许交换第二个监视器的位置所需的单击和拖动行为。

```
#NoEnv  ; Recommended for performance and compatibility with future AutoHotkey releases.
#Warn  ; Recommended for catching common errors.
SendMode Input  ; Recommended for new scripts due to its superior speed and reliability.
SetWorkingDir %A_ScriptDir%  ; Ensures a consistent starting directory.
#1::
Send {LWin}
WinWaitActive Start menu
Send Adjust Screen Resolution
Send {enter}
WinWaitActive Screen Resolution
ControlClick ComboBox3
Send {PgDn}
Send {Up} ; Select "Show desktop only on 1"
Send {enter}
Sleep 3000 ; workaround - cannot select accept/revert window?
Send {left}
Send {enter} ; accept changes
Return
#2::
Send {LWin}
WinWaitActive Start menu
Send Adjust Screen Resolution
Send {enter}
WinWaitActive Screen Resolution
ControlClick ComboBox3
Send {PgDn}
Send {Up}
Send {Up} ; Select "Extend these displays"
Send {enter}
Sleep 3000 ; workaround - cannot select accept/revert window?
Send {left}
Send {enter} ; accept changes
Return 
```

# python - wxPython 工具栏帮助

> ID：596190
> 
> 赞同：0
> 
> 时间：2009-02-27T19:13:08.573
> 
> 标签：python, user-interface, wxpython, toolbars

我是 Python 新手。我正在使用 wxPython 编写一个应用程序，我目前生成工具栏的代码如下所示：

```
class Window(wx.Frame)
def __init__(self, parent, plot):
    wx.Frame.__init__(self, parent, wx.ID_ANY, "Name", size =(900, 600))
    self.Centre()

    self.toolbar = self.CreateToolBar(style=(wx.TB_HORZ_LAYOUT | wx.TB_TEXT))
    self.toolbar.SetToolBitmapSize((32,32))
    self.toolbar.AddLabelTool(3, '', wx.Bitmap('GUI/icons/fileopen.png'))
    self.toolbar.AddLabelTool(3, '', wx.Bitmap('GUI/icons/filesave.png'))
    self.toolbar.AddSeparator()
    self.toolbar.Realize() 
```

我正在尝试稍微清理一下代码，并且我希望工具栏有自己的类，所以当我想创建一个工具栏时，我只需将其命名为：

```
toolbar = Toolbar() 
```

我的问题是我怎样才能重写它，让它像那样工作？目前我的代码如下所示：

```
class Toolbar():
    def __init__(self):
        self.toolbar = self.CreateToolBar(style=(wx.TB_HORZ_LAYOUT | wx.TB_TEXT))
        self.toolbar.SetToolBitmapSize((32,32))
        self.toolbar.AddLabelTool(3, '', wx.Bitmap('GUI/icons/fileopen.png'))
        self.toolbar.AddLabelTool(3, '', wx.Bitmap('GUI/icons/filesave.png'))
        self.toolbar.AddSeparator()
        self.toolbar.Realize() 
```

我不太确定“自我”是如何工作的。我需要重写**init**函数吗？我如何解决它？任何帮助是极大的赞赏。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T19:52:14.657

不要使用设置工具栏的类，而是使用函数。该函数可以是子类 wx.Frame 的 Window 的成员函数。这样，工具栏将从正确的窗口创建，并以您期望的方式附加。

如果您在上面编写的类知道将工具栏连接到哪个 wx.Frame（您的类称为 Window），它就会起作用。为了让它工作，你必须将框架对象传递给工具栏创建者类......

```
class Toolbar():
  def __init__(self, frame_to_connect_to):
    frame_to_connect_to.toolbar = frame_to_connect_to.CreateToolBar(style=(wx.TB_HORZ_LAYOUT | wx.TB_TEXT))
    frame_to_connect_to.toolbar.SetToolBitmapSize((32,32))
    frame_to_connect_to.toolbar.AddLabelTool(3, '', wx.Bitmap('GUI/icons/fileopen.png'))
    frame_to_connect_to.toolbar.AddLabelTool(3, '', wx.Bitmap('GUI/icons/filesave.png'))
    frame_to_connect_to.toolbar.AddSeparator()
    frame_to_connect_to.toolbar.Realize() 
```

它看起来像一个快速修复......但真正使用类来做到这一点并不是很好地使用类。（我什至会说这是不正确的。）

真的，稍微清理一下的只是将工具栏的东西移到它自己的成员函数中：

```
class Window(wx.Frame)
  def __init__(self, parent, plot):
    wx.Frame.__init__(self, parent, wx.ID_ANY, "Name", size =(900, 600))
    self.Centre()
    self._init_toolbar()

  def _init_toolbar(self):
    self.toolbar = self.CreateToolBar(style=(wx.TB_HORZ_LAYOUT | wx.TB_TEXT))
    self.toolbar.SetToolBitmapSize((32,32))
    self.toolbar.AddLabelTool(3, '', wx.Bitmap('GUI/icons/fileopen.png'))
    self.toolbar.AddLabelTool(3, '', wx.Bitmap('GUI/icons/filesave.png'))
    self.toolbar.AddSeparator()
    self.toolbar.Realize() 
```

你得到所有的好处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-28T15:04:55.087

是的。将你的 wxpython 代码分解成这样的对象。如果您要手动编写 GUI 代码（我愿意），维护起来会容易得多。

您需要子类[化 wx.ToolBar](http://wxpython.org/docs/api/wx.ToolBar-class.html)（它本身是[wx.ToolBarBase](http://wxpython.org/docs/api/wx.ToolBarBase-class.html)的子类，并且 wx.ToolBar 的大部分函数都派生自该命名空间）：

```
class MyToolBar(wx.ToolBar):
    def __init__(self, parent, *args, **kwargs):
        wx.ToolBar.__init__(self, parent, *args, **kwargs)
        #note self here and not self.toolbar
        self.SetToolBitmapSize((32,32))
        #add other code here 
```

然后在你`__init__`的 wx.Frame 中调用你的工具栏：

```
class MyFrame(wx.Frame):
    def __init__(self, parent, *args, **kwargs):
        wx.Frame.__init__(self, parent, *args, **kwargs)
        #note that below, self refers to the wx.Frame
        #self(wx.Frame) = parent for the toolbar constructor
        toolbar = MyToolBar(self) 
```

[wxPython 风格指南](http://wiki.wxpython.org/wxPython%20Style%20Guide)

需要注意的另一件事是[wxWidgets 文档](http://docs.wxwidgets.org/stable/)通常更容易导航和[破译](http://docs.wxwidgets.org/stable/wx_wxtoolbar.html#wxtoolbar)。

# version-control - 我可以集成不在我的客户规范中的文件吗？

> ID：596194
> 
> 赞同：1
> 
> 时间：2009-02-27T19:14:25.653
> 
> 标签：version-control, perforce, perforce-client-spec, perforce-branch-spec, perforce-integrate

有没有办法整合不在您的客户规范中的文件？

具体来说，我们有一个目录，其中包含我在本地构建的大量静态库（所以我不需要它们脱离源代码控制），并且不希望仅仅为了做一个整合。

在分支规范中：

//project1/project/lib/... //project2/project/external/project1/lib/...

在我的客户规范中：

-//project1/project/lib/... //cleintspec/project1/project/lib/...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-28T20:01:45.123

我不清楚你的整合方向是一个问题。但是您可以从不在您的客户规范中的文件进行集成，但从不集成*到*文件中。

另一种方法是使用缺少库文件夹映射的分支规范。只需复制当前的分支规范，然后将其过滤掉。然后你可以很愉快地集成，库将被忽略。

# php - PHP mysqli 意外参数问题

> ID：596200
> 
> 赞同：-1
> 
> 时间：2009-02-27T19:15:02.593
> 
> 标签：php, mysql, mysqli

我觉得完全不理解我做错了什么，但这里就是这样。

我正在编写一个简单的 Web 表单，将信息存储在 MySQL 数据库中。我收到此错误：

```
mysqli_stmt_init() expects parameter 1 to be mysqli, null given in /myfile.php 
```

这是我的代码：

```
$server = 'localhost';
$username = 'myusername';
$password = 'mypassword';
$db = 'mydb';
$link = mysqli_connect($server, $username, $password, $db);
.
.
. 
$stmt = mysqli_stmt_init($link); /*This line throws the error*/ 
```

有任何想法吗？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T19:17:34.380

您是否 100% 确定您已成功连接到数据库？

在脚本顶部添加：

```
error_reporting(E_ALL);
ini_set('display_errors', 1); 
```

还在您的连接线下方添加：

```
if (mysqli_connect_errno()) {
    printf("Connect failed: %s", mysqli_connect_error());
    exit;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T19:53:14.250

如果这是您的开发服务器，您可能应该在 php.ini 文件中而不是在每个脚本中设置以下行。

error_reporting = E_ALL display_errors = on

如果这不能解决您的问题，那么您应该打印我们的 $link 以查看它是什么。

# user-interface - 随用随保存 Web 表单 --- 模式请求

> ID：596202
> 
> 赞同：0
> 
> 时间：2009-02-27T19:15:11.487
> 
> 标签：user-interface, design-patterns, soa

许多网页设计师喜欢“随用随保存”的方法，而不是在 Web 表单上使用“保存”按钮。一旦用户将焦点从文本框中更改出来，用户对数据的更改就会立即保存。

有没有人确定这种技术的正式模式？我特别需要将这一切与厚实的服务电话联系起来。并发问题似乎是首先想到的问题之一。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T19:19:37.013

Ajax 模式具有[对象持久性](http://ajaxpatterns.org/Object_Persistence)模式，听起来像您所描述的。

您可能还想查看有关可能出现的响应问题的[胖客户端文章。](http://ajaxpatterns.org/Fat_Client)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T19:31:44.130

你可以试试 Infragistics 的 UX Partterns Explorer。

[http://quince.infragistics.com/#/Main](http://quince.infragistics.com/#/Main)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T19:33:12.347

这种“模式”实际上是现实世界界面的规范（收音机不会在应用音量更改之前等待您点击保存）。

至于并发性，一种解决方案是说服务器时间是“真实的”，然后使用 ajax 将更改推送给可能正在查看语义相交视图的客户端。

——马库斯

# silverlight-2.0 - 从 Silverlight 异步调用返回的对象丢失其包含的聚合

> ID：596210
> 
> 赞同：1
> 
> 时间：2009-02-27T19:17:29.123
> 
> 标签：silverlight-2.0, asynchronous

通过 MyWebServiceNameEventArgs 返回的从 Silverlight 2.0 控件到 WebService 的调用不返回包含的 List<> 聚合。例如，我有一个包含 List 和 List 的 Person 类。当我跟踪通话时，我看到该人的列表已正确填充。但是，当它通过 MyWebServiceNameEventArgs 到达时，列表为空。正确返回 FirstName、DOB 等简单类型。

我必须做些什么才能退回随附的聚合吗？

这是我的代码：

```
private void btnGetPerson_Click(object sender, RoutedEventArgs e)
{
  var proxy = new TutorWCFServicesClient();
  proxy.GetPersonWithPersonKeyOfCompleted += new EventHandler<GetPersonWithPersonKeyOfCompletedEventArgs>(proxy_GetPersonWithPersonKeyOfCompleted);
  var perID = 29; // testing
  proxy.GetPersonWithPersonKeyOfAsync(perID);
}

void proxy_GetPersonWithPersonKeyOfCompleted(object sender, GetPersonWithPersonKeyOfCompletedEventArgs e)
{
  var per = e.Result;
  if (per != null)
  {
    FirstName.Text = per.FirstName;
    LastName.Text = per.LastName;
    if (per.Phones != null)
    {
      var hPhone = (from phone in per.Phones where phone.PhoneType.ToLower() == "home" select phone).FirstOrDefault();
      var cPhone = (from phone in per.Phones where phone.PhoneType.ToLower() == "cell" select phone).FirstOrDefault();
      var wPhone = (from phone in per.Phones where phone.PhoneType.ToLower() == "work" select phone).FirstOrDefault();

      if (hPhone != null)
      {
        PhoneHome.Text = string.Format("({0}) {1}-{2}", hPhone.AreaCode, hPhone.Exchange, hPhone.Number);
      }
      if (cPhone != null)
      {
        PhoneCell.Text = string.Format("({0}) {1}-{2}", cPhone.AreaCode, cPhone.Exchange, cPhone.Number);
      }
      if (wPhone != null)
      {
        PhoneSchool.Text = string.Format("({0}) {1}-{2}", wPhone.AreaCode, wPhone.Exchange, wPhone.Number);
      }
    }
  }
  else
  {
    FirstName.Text = "Not Found";
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T21:33:45.240

愚蠢的错误，我忘记刷新 Silverlight 应用程序中的 ServiceReference。

# image - 确定RGB颜色感知亮度的公式

> ID：596216
> 
> 赞同：471
> 
> 时间：2009-02-27T19:19:31.757
> 
> 标签：image, colors, rgb, perception

我正在寻找某种公式或算法来确定给定 RGB 值的颜色的亮度。我知道这不可能像将 RGB 值相加并获得更高的总和更亮那样简单，但我不知道从哪里开始。

* * *

## 回答 #1

> 赞同：543
> 
> 时间：2009-02-27T19:25:59.727

该方法可能因您的需要而异。这里有3种计算亮度的方法：

*   亮度（某些色彩空间的标准）：`(0.2126*R + 0.7152*G + 0.0722*B)` [来源](https://en.wikipedia.org/wiki/Luminance_%28relative%29) ![图像](https://i.stack.imgur.com/NJ1Ci.png)

*   亮度（感知选项 1）：`(0.299*R + 0.587*G + 0.114*B)` [来源](https://www.w3.org/TR/AERT#color-contrast) ![图像](https://i.stack.imgur.com/ut7jI.png)

*   亮度（感知选项 2，计算速度较慢）： ~~`sqrt( 0.241*R^2 + 0.691*G^2 + 0.068*B^2 )`~~→ `sqrt( 0.299*R^2 + 0.587*G^2 + 0.114*B^2 )`（感谢[@MatthewHerbst](https://stackoverflow.com/users/2518231/matthew-herbst)）[来源](https://alienryderflex.com/hsp.html) ![图像](https://i.stack.imgur.com/A2x05.png)

^([[编辑：使用按每种方法排序的命名 css 颜色添加示例。]])

* * *

## 回答 #2

> 赞同：343
> 
> 时间：2009-02-27T19:25:11.307

我认为您正在寻找的是 RGB -> [Luma](http://en.wikipedia.org/wiki/Luma_(video))转换公式。

光度/数字[ITU BT.709](http://www.itu.int/rec/R-REC-BT.709)：

```
Y = 0.2126 R + 0.7152 G + 0.0722 B 
```

数字[ITU BT.601](http://www.itu.int/rec/R-REC-BT.601)（赋予 R 和 B 分量更多的权重）：

```
Y = 0.299 R + 0.587 G + 0.114 B 
```

如果您愿意用准确性来换取性能，这里有两个近似公式：

```
Y = 0.33 R + 0.5 G + 0.16 B

Y = 0.375 R + 0.5 G + 0.125 B 
```

这些可以快速计算为

```
Y = (R+R+B+G+G+G)/6

Y = (R+R+R+B+G+G+G+G)>>3 
```

* * *

## 回答 #3

> 赞同：136
> 
> 时间：2019-06-20T03:16:09.607

# *“已接受”的答案不正确且不完整*

唯一准确的答案是[@jive-](https://stackoverflow.com/a/13558570/2228559) dadson和[@EddingtonsMonkey](https://stackoverflow.com/a/37624009/2228559)的答案，并支持[@nils-pipenbrinck](https://stackoverflow.com/a/596527/2228559)。其他答案*（包括接受的）*链接或引用错误、不相关、过时或损坏的来源。

### 简要地：

*   *sRGB*必须在应用系数之前进行线性化。
*   亮度（L 或 Y）与光一样是线性的。
*   感知亮度 (L*) 与人类感知一样是非线性的。
*   HSV 和 HSL 在感知方面甚至都不是很准确。
*   sRGB 的 IEC 标准指定阈值为 0.04045，而*不是*0.03928（来自过时的早期草案）。
*   有用*（即相对于感知）*，欧几里得距离需要感知一致的笛卡尔向量空间，例如 CIELAB。*sRGB 不是一个。*

* * *

## 以下是正确而完整的答案：

因为这个帖子在搜索引擎中出现的频率很高，所以我添加这个答案是为了澄清关于这个主题的各种误解。

**亮度**是光的线性度量，对正常视力进行光谱加权，但未针对亮度的非线性感知进行调整。它可以是一个相对量度，如 CIEXYZ 中的**Y ，或者是****L ，一个以 cd/m** ² 为单位的绝对量度*（不要与 混淆`L*`）*。

**感知亮度**被一些视觉模型如CIELAB使用，这里`L*`（Lstar）是*感知亮度*的一个值，是非线性的，以近似人类视觉的非线性响应曲线。

**亮度**是一种感知属性，它没有“物理”度量。然而，一些颜色外观模型确实有一个*值*，通常表示为感知亮度的***“Q”***，它与感知亮度不同。

**Luma** ( *Y´* prime) 是一种伽马编码的加权信号，用于某些视频编码 (Y´I´Q´)。不要与线性亮度混淆。

**Gamma**或传输曲线 (TRC) 是一种通常类似于感知曲线的曲线，通常应用于存储或广播的图像数据，以减少感知噪声和/或提高数据利用率（以及相关原因）。

**要确定感知亮度**，首先将伽马编码的 R´G´B´ 图像值转换为线性亮度 (**`L`**或**`Y`**)，然后转换为非线性感知亮度 ( **`L*`**)

* * *

# 寻找亮度：

*...因为显然它在某个地方丢失了...*

### 第一步：

将所有 sRGB 8 位整数值转换为十进制 0.0-1.0

```
 vR = sR / 255;
  vG = sG / 255;
  vB = sB / 255; 
```

### 第二步：

将伽马编码的 RGB 转换为线性值。例如，sRGB（计算机标准）需要大约 V^2.2 的功率曲线，尽管“准确”的变换是：

[![sRGB 转线性](https://i.stack.imgur.com/syfhh.png)](https://i.stack.imgur.com/syfhh.png)

*其中 V´ 是 sRGB 的伽马编码 R、G 或 B 通道。*
伪代码：

```
function sRGBtoLin(colorChannel) {
        // Send this function a decimal sRGB gamma encoded color value
        // between 0.0 and 1.0, and it returns a linearized value.

    if ( colorChannel <= 0.04045 ) {
            return colorChannel / 12.92;
        } else {
            return pow((( colorChannel + 0.055)/1.055),2.4);
        }
    } 
```

### 第三步：

要找到亮度 (Y)，请应用 sRGB 的标准系数：

[![应用系数 Y = R * 0.2126 + G * 0.7152 + B * 0.0722](https://i.stack.imgur.com/TZoZA.png)](https://i.stack.imgur.com/TZoZA.png)

使用上述函数的伪代码：

```
Y = (0.2126 * sRGBtoLin(vR) + 0.7152 * sRGBtoLin(vG) + 0.0722 * sRGBtoLin(vB)) 
```

* * *

# 寻找感知到的轻盈：

### 第四步：

从上方获取亮度 Y，并转换为 L*

[![来自 Y 方程的 L*](https://i.stack.imgur.com/bgmlT.png)](https://i.stack.imgur.com/bgmlT.png)
伪代码：

```
function YtoLstar(Y) {
        // Send this function a luminance value between 0.0 and 1.0,
        // and it returns L* which is "perceptual lightness"

    if ( Y <= (216/24389) {       // The CIE standard states 0.008856 but 216/24389 is the intent for 0.008856451679036
            return Y * (24389/27);  // The CIE standard states 903.3, but 24389/27 is the intent, making 903.296296296296296
        } else {
            return pow(Y,(1/3)) * 116 - 16;
        }
    } 
```

L* 是一个从 0（黑色）到 100（白色）的值，其中 50 是感知的“中间灰色”。L* = 50 相当于 Y = 18.4，即 18% 的灰卡，代表摄影曝光的中间（Ansel Adams 区域 V）。

### 参考：

[`IEC 61966-2-1:1999 Standard`](https://webstore.iec.ch/publication/6169)
[`Wikipedia sRGB`](https://en.wikipedia.org/wiki/SRGB)
[`Wikipedia CIELAB`](https://en.wikipedia.org/wiki/CIELAB_color_space)
[`Wikipedia CIEXYZ`](https://en.wikipedia.org/wiki/CIE_1931_color_space)
[Charles Poynton 的 Gamma 常见问题解答](https://poynton.ca/GammaFAQ.html)

* * *

## 回答 #4

> 赞同：118
> 
> 时间：2014-06-13T20:20:52.583

我在接受的答案中比较了三种算法。我在循环中生成颜色，其中大约每 400 种颜色被使用。每种颜色由 2x2 像素表示，颜色从最暗到最亮（从左到右，从上到下）排序。

第一张图片 -[亮度（相对）](https://en.wikipedia.org/wiki/Luminance_%28relative%29)

```
0.2126 * R + 0.7152 * G + 0.0722 * B 
```

第二张图片 - [http://www.w3.org/TR/AERT#color-contrast](http://www.w3.org/TR/AERT#color-contrast)

```
0.299 * R + 0.587 * G + 0.114 * B 
```

第三张图片 - [HSP 颜色模型](http://alienryderflex.com/hsp.html)

```
sqrt(0.299 * R^2 + 0.587 * G^2 + 0.114 * B^2) 
```

第 4 张图片 - [WCAG 2.0 SC 1.4.3](http://www.w3.org/TR/UNDERSTANDING-WCAG20/visual-audio-contrast-contrast.html) [相对亮度](http://www.w3.org/TR/WCAG20/#relativeluminancedef)和[对比度](http://www.w3.org/TR/WCAG20/#contrast-ratiodef)公式（请参阅[@Synchro](https://stackoverflow.com/users/333340/synchro)[的](https://stackoverflow.com/a/17343790/2228559)答案）

根据一行中颜色的数量，有时会在第一张和第二张图片上发现图案。我从未在第 3 或第 4 算法的图片上发现任何图案。

如果我必须选择，我会选择算法 3，因为它更容易实现，并且比第四算法快 33%。

![感知亮度算法对比](https://i.imgur.com/I4alyQe.png)

* * *

## 回答 #5

> 赞同：71
> 
> 时间：2012-11-26T04:16:48.630

以下是将浏览器等中使用的 sRGB 图像转换为灰度的唯一正确算法。

在计算内积之前，有必要对颜色空间应用伽马函数的逆函数。然后将 gamma 函数应用于减小的值。未能结合伽马函数可能导致高达 20% 的错误。

对于典型的计算机内容，色彩空间是 sRGB。sRGB 的正确数字约为。0.21、0.72、0.07。sRGB 的 Gamma 是一个复合函数，它通过 1/(2.2) 近似取幂。这是 C++ 中的全部内容。

```
// sRGB luminance(Y) values
const double rY = 0.212655;
const double gY = 0.715158;
const double bY = 0.072187;

// Inverse of sRGB "gamma" function. (approx 2.2)
double inv_gam_sRGB(int ic) {
    double c = ic/255.0;
    if ( c <= 0.04045 )
        return c/12.92;
    else 
        return pow(((c+0.055)/(1.055)),2.4);
}

// sRGB "gamma" function (approx 2.2)
int gam_sRGB(double v) {
    if(v<=0.0031308)
      v *= 12.92;
    else 
      v = 1.055*pow(v,1.0/2.4)-0.055;
    return int(v*255+0.5); // This is correct in C++. Other languages may not
                           // require +0.5
}

// GRAY VALUE ("brightness")
int gray(int r, int g, int b) {
    return gam_sRGB(
            rY*inv_gam_sRGB(r) +
            gY*inv_gam_sRGB(g) +
            bY*inv_gam_sRGB(b)
    );
} 
```

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2013-06-27T12:56:06.127

与其在此处提到的随机选择的公式中迷失方向，我建议您选择 W3C 标准推荐的公式。

[这是WCAG 2.0 SC 1.4.3](http://www.w3.org/TR/UNDERSTANDING-WCAG20/visual-audio-contrast-contrast.html) [相对亮度](http://www.w3.org/TR/WCAG20/#relativeluminancedef)和[对比度](http://www.w3.org/TR/WCAG20/#contrast-ratiodef)公式的简单但准确的 PHP 实现。它生成的值适用于评估 WCAG 合规性所需的比率，如[本页所示](http://www.msfw.com/accessibility/tools/contrastratiocalculator.aspx)，因此适用于任何 Web 应用程序。这对于移植到其他语言来说是微不足道的。

```
/**
 * Calculate relative luminance in sRGB colour space for use in WCAG 2.0 compliance
 * @link http://www.w3.org/TR/WCAG20/#relativeluminancedef
 * @param string $col A 3 or 6-digit hex colour string
 * @return float
 * @author Marcus Bointon <marcus@synchromedia.co.uk>
 */
function relativeluminance($col) {
    //Remove any leading #
    $col = trim($col, '#');
    //Convert 3-digit to 6-digit
    if (strlen($col) == 3) {
        $col = $col[0] . $col[0] . $col[1] . $col[1] . $col[2] . $col[2];
    }
    //Convert hex to 0-1 scale
    $components = array(
        'r' => hexdec(substr($col, 0, 2)) / 255,
        'g' => hexdec(substr($col, 2, 2)) / 255,
        'b' => hexdec(substr($col, 4, 2)) / 255
    );
    //Correct for sRGB
    foreach($components as $c => $v) {
        if ($v <= 0.04045) {
            $components[$c] = $v / 12.92;
        } else {
            $components[$c] = pow((($v + 0.055) / 1.055), 2.4);
        }
    }
    //Calculate relative luminance using ITU-R BT. 709 coefficients
    return ($components['r'] * 0.2126) + ($components['g'] * 0.7152) + ($components['b'] * 0.0722);
}

/**
 * Calculate contrast ratio acording to WCAG 2.0 formula
 * Will return a value between 1 (no contrast) and 21 (max contrast)
 * @link http://www.w3.org/TR/WCAG20/#contrast-ratiodef
 * @param string $c1 A 3 or 6-digit hex colour string
 * @param string $c2 A 3 or 6-digit hex colour string
 * @return float
 * @author Marcus Bointon <marcus@synchromedia.co.uk>
 */
function contrastratio($c1, $c2) {
    $y1 = relativeluminance($c1);
    $y2 = relativeluminance($c2);
    //Arrange so $y1 is lightest
    if ($y1 < $y2) {
        $y3 = $y1;
        $y1 = $y2;
        $y2 = $y3;
    }
    return ($y1 + 0.05) / ($y2 + 0.05);
} 
```

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2009-02-27T20:25:06.217

添加所有其他人所说的话：

所有这些方程在实践中都工作得很好，但如果你需要非常精确，你必须首先将颜色转换为线性颜色空间（应用逆图像伽玛），然后对原色进行加权平均 - 如果你想显示颜色 - 将亮度带回监视器伽玛。

在深灰色中，忽略伽玛和做正确伽玛之间的亮度差异高达 20%。

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2010-05-26T19:34:05.203

我发现[这段代码](http://www.nbdtech.com/Blog/archive/2008/04/27/Calculating-the-Perceived-Brightness-of-a-Color.aspx)（用 C# 编写）在计算颜色的“亮度”方面做得很好。在这种情况下，代码试图确定是在颜色上放置白色还是黑色文本。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2013-04-03T18:09:17.943

有趣的是，[RGB=>HSV 的这个公式](http://en.literateprograms.org/RGB_to_HSV_color_space_conversion_%28C%29)只使用 v=MAX3(r,g,b)。换句话说，您可以使用 (r,g,b) 的*最大值*作为 HSV 中的 V。

我检查并在[Hearn & Baker](http://books.google.ca/books?id=oBbY3uFIgM8C&pg=PA318&lpg=PA318&dq=%22The+three-dimensional+representation+of+the+HSV+model%22&source=bl&ots=yP-bc9zeEk&sig=YXor-sGrcrrOENu-OzEHsDtc4bA&hl=en&sa=X&ei=5G9cUcbTAYrn0QHX9IHgCQ&ved=0CC0Q6AEwAA#v=onepage&q=%22The%20three-dimensional%20representation%20of%20the%20HSV%20model%22&f=false)的第 575 页上，这也是他们计算“价值”的方式。

![来自 Hearn&Baker 第 319 页](https://i.stack.imgur.com/ubpRX.png)

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2020-01-05T17:26:44.153

我今天用 javascript 解决了一个类似的任务。我已经`getPerceivedLightness(rgb)`为 HEX RGB 颜色选择了这个函数。它通过 Fairchild 和 Perrotta 公式处理 Helmholtz-Kohlrausch 效应以进行亮度校正。

```
/**
 * Converts RGB color to CIE 1931 XYZ color space.
 * https://www.image-engineering.de/library/technotes/958-how-to-convert-between-srgb-and-ciexyz
 * @param  {string} hex
 * @return {number[]}
 */
export function rgbToXyz(hex) {
    const [r, g, b] = hexToRgb(hex).map(_ => _ / 255).map(sRGBtoLinearRGB)
    const X =  0.4124 * r + 0.3576 * g + 0.1805 * b
    const Y =  0.2126 * r + 0.7152 * g + 0.0722 * b
    const Z =  0.0193 * r + 0.1192 * g + 0.9505 * b
    // For some reason, X, Y and Z are multiplied by 100.
    return [X, Y, Z].map(_ => _ * 100)
}

/**
 * Undoes gamma-correction from an RGB-encoded color.
 * https://en.wikipedia.org/wiki/SRGB#Specification_of_the_transformation
 * https://stackoverflow.com/questions/596216/formula-to-determine-brightness-of-rgb-color
 * @param  {number}
 * @return {number}
 */
function sRGBtoLinearRGB(color) {
    // Send this function a decimal sRGB gamma encoded color value
    // between 0.0 and 1.0, and it returns a linearized value.
    if (color <= 0.04045) {
        return color / 12.92
    } else {
        return Math.pow((color + 0.055) / 1.055, 2.4)
    }
}

/**
 * Converts hex color to RGB.
 * https://stackoverflow.com/questions/5623838/rgb-to-hex-and-hex-to-rgb
 * @param  {string} hex
 * @return {number[]} [rgb]
 */
function hexToRgb(hex) {
    const match = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex)
    if (match) {
        match.shift()
        return match.map(_ => parseInt(_, 16))
    }
}

/**
 * Converts CIE 1931 XYZ colors to CIE L*a*b*.
 * The conversion formula comes from <http://www.easyrgb.com/en/math.php>.
 * https://github.com/cangoektas/xyz-to-lab/blob/master/src/index.js
 * @param   {number[]} color The CIE 1931 XYZ color to convert which refers to
 *                           the D65/2° standard illuminant.
 * @returns {number[]}       The color in the CIE L*a*b* color space.
 */
// X, Y, Z of a "D65" light source.
// "D65" is a standard 6500K Daylight light source.
// https://en.wikipedia.org/wiki/Illuminant_D65
const D65 = [95.047, 100, 108.883]
export function xyzToLab([x, y, z]) {
  [x, y, z] = [x, y, z].map((v, i) => {
    v = v / D65[i]
    return v > 0.008856 ? Math.pow(v, 1 / 3) : v * 7.787 + 16 / 116
  })
  const l = 116 * y - 16
  const a = 500 * (x - y)
  const b = 200 * (y - z)
  return [l, a, b]
}

/**
 * Converts Lab color space to Luminance-Chroma-Hue color space.
 * http://www.brucelindbloom.com/index.html?Eqn_Lab_to_LCH.html
 * @param  {number[]}
 * @return {number[]}
 */
export function labToLch([l, a, b]) {
    const c = Math.sqrt(a * a + b * b)
    const h = abToHue(a, b)
    return [l, c, h]
}

/**
 * Converts a and b of Lab color space to Hue of LCH color space.
 * https://stackoverflow.com/questions/53733379/conversion-of-cielab-to-cielchab-not-yielding-correct-result
 * @param  {number} a
 * @param  {number} b
 * @return {number}
 */
function abToHue(a, b) {
    if (a >= 0 && b === 0) {
        return 0
    }
    if (a < 0 && b === 0) {
        return 180
    }
    if (a === 0 && b > 0) {
        return 90
    }
    if (a === 0 && b < 0) {
        return 270
    }
    let xBias
    if (a > 0 && b > 0) {
        xBias = 0
    } else if (a < 0) {
        xBias = 180
    } else if (a > 0 && b < 0) {
        xBias = 360
    }
    return radiansToDegrees(Math.atan(b / a)) + xBias
}

function radiansToDegrees(radians) {
    return radians * (180 / Math.PI)
}

function degreesToRadians(degrees) {
    return degrees * Math.PI / 180
}

/**
 * Saturated colors appear brighter to human eye.
 * That's called Helmholtz-Kohlrausch effect.
 * Fairchild and Pirrotta came up with a formula to
 * calculate a correction for that effect.
 * "Color Quality of Semiconductor and Conventional Light Sources":
 * https://books.google.ru/books?id=ptDJDQAAQBAJ&pg=PA45&lpg=PA45&dq=fairchild+pirrotta+correction&source=bl&ots=7gXR2MGJs7&sig=ACfU3U3uIHo0ZUdZB_Cz9F9NldKzBix0oQ&hl=ru&sa=X&ved=2ahUKEwi47LGivOvmAhUHEpoKHU_ICkIQ6AEwAXoECAkQAQ#v=onepage&q=fairchild%20pirrotta%20correction&f=false
 * @return {number}
 */
function getLightnessUsingFairchildPirrottaCorrection([l, c, h]) {
    const l_ = 2.5 - 0.025 * l
    const g = 0.116 * Math.abs(Math.sin(degreesToRadians((h - 90) / 2))) + 0.085
    return l + l_ * g * c
}

export function getPerceivedLightness(hex) {
    return getLightnessUsingFairchildPirrottaCorrection(labToLch(xyzToLab(rgbToXyz(hex))))
} 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2021-11-26T10:14:49.963

将此[视为 Myndex 出色答案](https://stackoverflow.com/a/56678483/2652785)的附录。正如他（和其他人）解释的那样，用于计算 RGB 颜色的相对亮度（和感知亮度）的算法被设计为使用*线性*RGB 值。您不能只将它们应用于原始 sRGB 值并希望获得相同的结果。

好吧，理论上这一切听起来都很棒，但我真的需要亲自*看到*证据，所以，受到[Petr Hurtak 的颜色渐变的](https://stackoverflow.com/a/24213274/2652785)启发，我继续制作自己的。它们说明了两种最常见的算法（ITU-R Recommendation [BT.601](https://www.itu.int/rec/R-REC-BT.601-7-201103-I/en)和[BT.709](https://www.itu.int/rec/R-REC-BT.709-6-201506-I/en)），并清楚地说明了为什么您应该使用线性值（不是经过伽马校正的值）进行计算。

首先，这是旧的 ITU BT.601 算法的结果。左边的那个使用原始 sRGB 值。右边的使用线性值。

## ITU-R BT.601 色彩亮度梯度

0.299 R + 0.587 G + 0.114 B

[![ITU-R BT.601 色彩亮度梯度](https://i.stack.imgur.com/W29rZ.png)](https://i.stack.imgur.com/W29rZ.png)

在这个分辨率下，左边的实际上看起来非常好！但是如果你仔细观察，你会发现一些问题。在更高的分辨率下，不需要的伪影更加明显：

[![ITU-R BT.601 色彩亮度梯度（高分辨率）](https://i.stack.imgur.com/IunRs.jpg)](https://i.stack.imgur.com/IunRs.jpg)

线性的不受这些影响，但那里有很多噪音。让我们将其与 ITU-R Recommendation BT.709 进行比较……</p>

## ITU-R BT.709 色彩亮度梯度

0.2126 R + 0.7152 G + 0.0722 B

[![ITU-R BT.709 色彩亮度梯度](https://i.stack.imgur.com/GRfaL.png)](https://i.stack.imgur.com/GRfaL.png)

好家伙。显然不打算与原始 sRGB 值一起使用！然而，这*正是*大多数人所做的！

[![ITU-R BT.709 色彩亮度梯度（高分辨率）](https://i.stack.imgur.com/S6R2T.jpg)](https://i.stack.imgur.com/S6R2T.jpg)

在高分辨率下，您可以真正看到该算法在使用线性值时的有效性。它几乎没有早期的噪音那么大。虽然这些算法都不是完美的，但这个算法已经做到了最好。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2016-06-03T21:53:07.780

这是一些应该正确计算感知亮度的 C 代码。

```
// reverses the rgb gamma
#define inverseGamma(t) (((t) <= 0.0404482362771076) ? ((t)/12.92) : pow(((t) + 0.055)/1.055, 2.4))

//CIE L*a*b* f function (used to convert XYZ to L*a*b*)  http://en.wikipedia.org/wiki/Lab_color_space
#define LABF(t) ((t >= 8.85645167903563082e-3) ? powf(t,0.333333333333333) : (841.0/108.0)*(t) + (4.0/29.0))

float
rgbToCIEL(PIXEL p)
{
   float y;
   float r=p.r/255.0;
   float g=p.g/255.0;
   float b=p.b/255.0;

   r=inverseGamma(r);
   g=inverseGamma(g);
   b=inverseGamma(b);

   //Observer = 2°, Illuminant = D65 
   y = 0.2125862307855955516*r + 0.7151703037034108499*g + 0.07220049864333622685*b;

   // At this point we've done RGBtoXYZ now do XYZ to Lab

   // y /= WHITEPOINT_Y; The white point for y in D65 is 1.0

    y = LABF(y);

   /* This is the "normal conversion which produces values scaled to 100
    Lab.L = 116.0*y - 16.0;
   */
   return(1.16*y - 0.16); // return values for 0.0 >=L <=1.0
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-02-27T19:28:08.520

HSV 颜色空间应该可以解决问题，请参阅[**维基百科文章**](http://en.wikipedia.org/wiki/HSL_and_HSV)，具体取决于您使用的语言，您可能会获得库转换。

H 是色调，它是颜色的数值（即红色、绿色……）

S 是颜色的饱和度，即它有多“强烈”

V 是颜色的“亮度”。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-02-27T19:34:54.557

RGB 亮度值 = 0.3 R + 0.59 G + 0.11 B

[http://www.scantips.com/lumin.html](http://www.scantips.com/lumin.html)

> 如果您正在寻找颜色与白色的接近程度，您可以使用 (255, 255, 255) 的欧几里得距离

我认为 RGB 颜色空间相对于 L2 欧几里得距离在感知上是不均匀的。统一空间包括 CIE LAB 和 LUV。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2016-01-19T14:21:24.333

Jive Dadson 的反伽玛公式在 Javascript 中实现时需要去掉半调整，即函数 gam_sRGB 的返回需要返回 int(v*255); 不返回 int(v*255+.5); 半调整四舍五入，这可能导致 R=G=B（即灰色三元组）上的值太高。R=G=B 三元组的灰度转换应该产生一个等于 R 的值；这是公式有效的一个证明。有关实际操作的公式，请参见[灰度的九种阴影](http://casamatita.co.uk/nineshades)（没有半调整）。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2017-03-11T07:15:56.807

我想知道这些 rgb 系数是如何确定的。我自己做了一个实验，结果如下：

```
Y = 0.267 R + 0.642 G + 0.091 B 
```

与长期建立的 ITU 系数接近但明显不同。我想知道每个观察者的这些系数是否可能不同，因为我们每个人的眼睛视网膜上可能有不同数量的视锥细胞和视杆细胞，尤其是不同类型视锥细胞之间的比例可能不同。

以供参考：

国际电联 BT.709：

```
Y = 0.2126 R + 0.7152 G + 0.0722 B 
```

国际电联 BT.601：

```
Y = 0.299 R + 0.587 G + 0.114 B 
```

我通过在亮红色、亮绿色和亮蓝色背景上快速移动一个小灰色条进行测试，并调整灰色直到它尽可能地融合。我还用其他色调重复了这个测试。我在不同的显示器上重复了测试，即使是一个固定伽马因子为 3.0 的显示器，但在我看来一切都一样。此外，ITU 系数对我来说是错误的。

是的，我大概有正常的色觉。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-02-27T19:40:56.760

HSV 的“V”可能是您正在寻找的。MATLAB 有一个 rgb2hsv 函数，之前引用的 wikipedia 文章充满了伪代码。如果 RGB2HSV 转换不可行，则不太准确的模型将是图像的灰度版本。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2012-02-24T05:27:38.787

[此链接](http://paulbourke.net/texture_colour/)深入解释了所有内容，包括为什么这些乘数常数存在于 R、G 和 B 值之前。

编辑：这里也有一个答案的解释（0.299*R + 0.587*G + 0.114*B）

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-04-10T21:16:01.253

为了用 R 确定颜色的亮度，我将 RGB 系统颜色转换为 HSV 系统颜色。

在我的脚本中，我之前出于其他原因使用 HEX 系统代码，但您也可以从 RGB 系统代码开始`rgb2hsv {grDevices}`。文档在[这里](https://stat.ethz.ch/R-manual/R-devel/library/grDevices/html/rgb2hsv.html)。

这是我的代码的这一部分：

```
 sample <- c("#010101", "#303030", "#A6A4A4", "#020202", "#010100")
 hsvc <-rgb2hsv(col2rgb(sample)) # convert HEX to HSV
 value <- as.data.frame(hsvc) # create data.frame
 value <- value[3,] # extract the information of brightness
 order(value) # ordrer the color by brightness 
```

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2016-01-19T14:25:56.960

为了清楚起见，使用平方根的公式需要

`sqrt(coefficient * (colour_value^2))`

不是

`sqrt((coefficient * colour_value))^2`

这一点的证明在于将 R=G=B 三元组转换为灰度 R。只有当您将颜色值平方而不是颜色值乘以系数时，这才是正确的。见[九级灰度](http://casamatita.co.uk/nineshades)

* * *

## 回答 #21

> 赞同：-2
> 
> 时间：2009-02-27T19:22:36.227

请定义亮度。如果您正在寻找颜色与白色的接近程度，您可以使用(255, 255, 255)的[欧几里得距离](http://en.wikipedia.org/wiki/Euclidean_distance)

# flash - 如何从 Flash 访问 allowScriptAccess 的值？

> ID：596218
> 
> 赞同：3
> 
> 时间：2009-02-27T19:20:15.670
> 
> 标签：flash

我正在寻找读取 allowScriptAccess 标记的值，以便如果将其设置为“从不”，或者如果未设置，我将不会尝试进行 ExternalInterface 调用。使用 flex 框架，我可以使用 Application.application。Flash 是否有等价物？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-04-30T19:11:32.703

无法直接访问allowScriptAccess 值，但您可以很容易地确定是否能够通过使用try-catch 来进行ExternalInterface 调用。

```
try
{
  ExternalInterface.call( 'document.getElementById', 'NOELEMENTBYTHISNAME' );
  allowScriptAccess = true;
}
catch( err:SecurityError )
{
  allowScriptAccess = false;
} 
```

然后，您可以使用您的 allowScriptAccess 来确定应用程序控制流，以避免进行任何进一步的 ExternalInterface 调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T17:46:22.560

似乎很好地记录了从 Flex 或 Flash 访问这些参数值是不可能的。可以按照上一个答案的建议访问 Flashvars，但对象标记的参数值不能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-28T07:45:44.427

可以通过 flashVars 属性访问此类信息以及任何查询字符串参数。您可以访问 flashVars 属性。阅读[此](http://livedocs.adobe.com/flex/3/html/help.html?content=passingarguments_3.html)内容进行详细讨论。Flash 等效`Application.application.parameters`于`stage.loaderInfo.parameters`.

[该](http://elromdesign.com/blog/2009/02/17/passing-flashvars-using-flex-template-html/)博客解释了如何以一致的方式做到这一点。

# objective-c - 我绑定的对象的工作是什么？

> ID：596226
> 
> 赞同：0
> 
> 时间：2009-02-27T19:21:52.170
> 
> 标签：objective-c, cocoa, binding

当我使用 Interface Builder > Inspector > Bindings 为我的其中一个视图项（即文本字段）设置绑定时，我必须指定该视图项将绑定到的对象。

所以我现在想知道，我在“绑定到：”中指定的这个对象的工作到底是什么？我假设 Interface Builder 会自动创建一些方法来完成所有同步工作。那正确吗？

当我“绑定到：文件的所有者”是什么意思？那是我的文件里面有 main-Method 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T20:08:20.360

> ...我在“绑定到：”中指定的这个对象的具体工作是什么？

您将视图绑定到控制器。控制器拥有模型；您绑定到的控制器键是为该模型的某些部分提供服务的属性的名称。模型对象有自己的属性，您可以（在某些情况下必须）提供模型键路径以及控制器键。

> 我假设 Interface Builder 会自动创建一些方法来完成所有同步工作。那正确吗？

没有。IB 从不创建方法。Bindings 系统完成了所有同步工作，而且它已经存在。IB 只是调用它（具体来说，它调用我在[回答您的其他问题时](https://stackoverflow.com/questions/595188/what-describes-objective-c-and-cocoa-bindings-best/595649#595649)`bind::::`提到的方法）。

> 当我“绑定到：文件的所有者”是什么意思？

File's Owner 是拥有 nib 文件中所有顶级对象的对象。MainMenu nib 的所有者是应用程序对象 ( `NSApp`)。在基于文档的应用程序中，文档对象将加载一个包含文档窗口的 nib；因此，它是窗口的所有者，以及该笔尖中的任何其他顶级对象。

> 那是我的文件里面有 main-Method 吗？

没有这样的文件，因为没有这样的方法。有一个`main` *函数*，但它是一个函数，而不是一个对象的方法。那里没有对象，所以你不能绑定到它。

而且您不能绑定到文件，只能绑定到对象。当您将程序链接到单个可执行文件时，源文件会消失*。可执行文件仅包含类和函数，而 nib 包含对象（类的实例）。

如果你问的是哪个文件被拥有，它是 nib 文件（或者，更准确地说，它的内容——但是“文件的内容所有者”有点长）。

*好吧，除了调试符号，它标识每条指令的文件名和行号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T19:45:44.033

您绑定的对象必须是[键值编码](http://developer.apple.com/documentation/Cocoa/Conceptual/KeyValueCoding/index.html)和[键值观察](http://developer.apple.com/documentation/Cocoa/Conceptual/KeyValueObserving/KeyValueObserving.html)兼容。[Bindings](http://developer.apple.com/documentation/Cocoa/Conceptual/CocoaBindings/CocoaBindings.html)只是一个包装器，它使用这两种技术以减少代码。

如果你真的想知道它是如何工作的，可以[在 Mike Ash 的博客中找到一篇文章 KVO 是如何工作的。](http://www.mikeash.com/?page=pyblog/friday-qa-2009-01-23.html).

我不知道你是否想要这么多细节。我建议您阅读[cocoadevcentral.com 的绑定介绍](http://cocoadevcentral.com/articles/000080.php)。它在解释它们方面做得相当好。

对于您关于文件所有者的具体问题，[Apple](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/CocoaFundamentals/CoreAppArchitecture/chapter_7_section_8.html)写道：

> 每个 Cocoa 应用程序都有一个主 nib 文件，其中包含应用程序特定的菜单和可能的一个或多个窗口。**NSApp 是主 nib 文件的文件所有者。**当应用程序启动时，NSApp 加载主 nib 文件，取消归档，并显示菜单和初始窗口。

# php - 在使用 PHP+MySQL 成功插入后立即插入附加值

> ID：596228
> 
> 赞同：0
> 
> 时间：2009-02-27T19:22:01.577
> 
> 标签：php, mysql

```
if(isset($_REQUEST['SAVE'])) {
    $sql = "SELECT SecName FROM section WHERE SecID='$section'";
    $result = mysql_query($sql);
    while ($row = mysql_fetch_assoc($result)){
        $SecName = $row["SecName"];
    }
    $sql = "SELECT SubjName FROM subject WHERE SubjID='$subject'";
    $result = mysql_query($sql);
    while ($row = mysql_fetch_assoc($result)){
        $SubjName = $row["SubjName"];
    }

    $check = mysql_query("SELECT SecID FROM service where SubjID='$SubjName'")or die(mysql_error());
    $bool = 1;
    while($info = mysql_fetch_array( $check )) 
        if(($info['SecID'] == $SecName)){
            $bool = 0;
        }
    if($bool){

        $check = mysql_query("SELECT * FROM service ")or die(mysql_error());
        $bool = 1;
        while($info = mysql_fetch_array( $check )) 
            if(($info['Start_date'] == $Start_date) && ($info['Venue'] == $Venue) || ($info['Start_date'] == $Start_date) && ($info['Facilitator'] == $Facilitator)){
                $bool = 0;
            }
        if($bool){

            $sql="INSERT INTO service ( ServiceID, Date, Semester, School_year, Start_date, Venue, Facilitator, Stype, SecID, SubjID)VALUES('$RecCode','$Date','$Semester','$School_year','$Start_date','$Venue','$Facilitator','$Stype', '$SecName', '$SubjName')";

            if (!mysql_query($sql,$con))
                {
                    die('Error: ' . mysql_error());
                }
            echo '<script type="text/javascript">';
            echo 'alert("Save Successfully!");';
            echo 'window.location="Admin_RecSchedMapLst.php";';
            echo '</script>';
            mysql_close($con);
        }else
            {       
                echo '<script type="text/javascript">';
                echo 'alert("Conflicting schedule for Venue or Facilitator!");';
                echo '</script>';
            }                       
    }else
        {   
            echo '<script type="text/javascript">';
            echo 'alert("The SECTION has been already scheduled!");';
            echo '</script>';
        }                   
}                   

/*  $result = mysql_query("SELECT SIDno FROM class WHERE SecID=$SecID AND SubjID=$SubjID");
$row = mysql_fetch_assoc($result);
$SIDno = $row['SIDno'];
$result = mysql_query("SELECT ServiceID FROM service WHERE SecID=$SecID AND SubjID=$SubjID");
$row = mysql_fetch_assoc($result);
$ServiceID = $row['ServiceID'];
$sql="INSERT INTO registered ( ServiceID, IDno, Stype )VALUES('$ServiceID','$SIDno','$Stype')"; */                          

} 
```

此代码工作正常，。我只想问我怎么可能处理上面评论的代码。我要做的就是在插入 serviceid 时，我还想立即将 serviceID、idno、类型插入到另一个已注册的表中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T19:58:42.300

[使用mysql_insert_id](http://us2.php.net/mysqli_insert_id)函数来获取您刚刚插入的行的 ID 比执行另一个 SELECT更容易和更好。例如：

```
$sql="INSERT INTO service ( ServiceID, Date, Semester, School_year, Start_date, Venue, Facilitator, Stype, SecID, SubjID) VALUES ('$RecCode','$Date','$Semester','$School_year','$Start_date','$Venue','$Facilitator','$Stype', '$SecName', '$SubjName')";

if (mysql_query($sql,$con)) {
   $ServiceID = mysql_insert_id();
   $sql="INSERT INTO registered ( ServiceID, IDno, Stype )VALUES('$ServiceID','$SIDno','$Stype')";           
   mysl_query($sql, $con);  // check for error here too though
}
else {
   echo "OH NO!!!";
} 
```

此外，请注意构建 SQL 字符串的方式 的[SQL 注入。](http://en.wikipedia.org/wiki/SQL_injection)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T19:26:53.407

在第一个 SQL INSERT 命令之后执行另一个 SQL INSERT 命令，例如：

```
$sql="INSERT INTO service ( ServiceID, Date, Semester, School_year, Start_date, Venue, Facilitator, Stype, SecID, SubjID) VALUES ('$RecCode','$Date','$Semester','$School_year','$Start_date','$Venue','$Facilitator','$Stype', '$SecName', '$SubjName')";

if (!mysql_query($sql,$con))
{
    die('Error: ' . mysql_error());
}
else
{
    /*Begin your SELECT and INSERT code*/
    $result = mysql_query("SELECT SIDno FROM class WHERE SecID=$SecID AND SubjID=$SubjID");
    $row = mysql_fetch_assoc($result);
    $SIDno = $row['SIDno'];
    $result = mysql_query("SELECT ServiceID FROM service WHERE SecID=$SecID AND SubjID=$SubjID");
    $row = mysql_fetch_assoc($result);
    $ServiceID = $row['ServiceID'];
    $sql2 = "INSERT INTO registered ( ServiceID, IDno, Stype )VALUES('$ServiceID','$SIDno','$Stype')";   
    /*End your SELECT and INSERT code*/                      

    if(!mysql_query($sql2,$con))
    {
        die('Error: ' . mysql_error());
    }
} 
```

# language-agnostic - 哪些层应该使用领域模型？

> ID：596236
> 
> 赞同：2
> 
> 时间：2009-02-27T19:24:10.450
> 
> 标签：language-agnostic, design-patterns

假设我的业务层中有这样的方法：

```
// This is in the business layer
public Result DeleteSomeDomainObject( ???? )
{
   //Enforce business logic here.

   //Delete records in the database
   DAL. DeleteSomeDomainObject( ??? )
}

// This is in the data access layer
public Result DeleteSomeDomainObject( ???? )
{
   // Delete records from the database.       
} 
```

这些方法应该采用域模型的实例还是只采用主键？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T19:40:41.720

我经常为此挣扎。我通常说您的业务/服务层应该将域对象作为参数。

如果我们在谈论 Web，您的 Web 层将具有 ID。它可能会从服务层实例化或检索对象的实例。因此，将它传递给您的服务层是有意义的。

但是，有时您最终会复制对象的检索。有时，由于 Web 层未捕获一些附加数据，您的服务无论如何都会加载对象。我什至曾经有过数据访问层必须为依赖加载对象的情况。缓存可以解决其中一些问题，重新构建数据/模型可以解决其他问题。当然。但有时，考虑到性能或其他问题，传递 ID 更有意义。

总而言之，更喜欢将域对象传递给业务层。但是要意识到，出于其他原因，您最好传递一个 ID，不幸的是，您的规则需要有例外。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T19:27:55.947

在任何合理的地方，将政策与实施脱钩都是有意义的。我想说，如果您打算使用某种 ORM，请传递您的业务对象的实例。

# php - 从传入字符串中删除所有垃圾的例程？

> ID：596247
> 
> 赞同：0
> 
> 时间：2009-02-27T19:26:47.247
> 
> 标签：php, string, sanitization

有时，当用户将数据复制并粘贴到输入表单中时，我们会得到如下字符：

> 没有，“用于开头引号和“用于结尾引号等...

我使用此例程来清理 Web 表单上的大多数输入（我前段时间写过，但也在寻找改进）：

```
function fnSanitizePost($data) //escapes,strips and trims all members of the post array
{
    if(is_array($data))
    {
    $areturn = array();
    foreach($data as $skey=>$svalue)
    {
      $areturn[$skey] = fnSanitizePost($svalue);
    }
    return $areturn;
  }
  else
    {
      if(!is_numeric($data))
        {
            //with magic quotes on, the input gets escaped twice, which means that we have to strip those slashes. leaving data in your database with slashes in them, is a bad idea
            if(get_magic_quotes_gpc()) //gets current configuration setting of magic quotes
      {
        $data = stripslahes($data);
      }
        $data = pg_escape_string($data); //escapes a string for insertion into the database
        $data = strip_tags($data);  //strips HTML and PHP tags from a string
      }
        $data = trim($data);  //trims whitespace from beginning and end of a string
      return $data;
    }
} 
```

我真的很想避免上面提到的字符被存储在数据库中，我是否需要在我的清理程序中添加一些正则表达式替换？

谢谢，

`-`尼古拉斯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-27T20:55:58.577

> 没有，“用于开头引号和”用于结尾引号

这不是垃圾，它们是合法的“智能引用”字符，它们被编码为 UTF-8，但被错误地读取为 ISO-8859-1。

您可以尝试摆脱它们或尝试使用 utf_decode 将它们解析为普通的旧 Latin-1，但如果您这样做，您将拥有一个不允许您在 ASCII 之外键入任何内容的应用程序，在当今时代是一个很差的节目。

如果您可以管理它，最好将您的所有页面都以 UTF-8 格式提供，所有表单提交都以 UTF-8 格式输入，并且所有数据库内容都以 UTF-8 格式存储。理想情况下，您的应用程序将在内部使用所有 Unicode 字符，但不幸的是 PHP 作为一种语言没有原生 Unicode 字符串，因此通常将所有字符串也保存为 UTF-8，并冒着偶尔截断的风险UTF-8 序列并得到一个�，除非你想处理 mbstring。

> $data = pg_escape_string($data); //转义字符串以插入数据库
> 
> $data = strip_tags($data); //从字符串中去除 HTML 和 PHP 标签

您不希望将其作为进入您的应用程序的消毒措施。将所有字符串保存为纯文本形式以处理它们，然后 pg_escape_string() 仅在输出到 Postgres 查询时使用，而 htmlspecialchars() 仅在输出到 HTML 页面时使用。

否则你会得到奇怪的东西，比如 SQL 转义出现在直接通过脚本传递到输出页面的变量上，并且没有人能够使用普通的小于字符。

*作为清理措施，您可以*做的一件事是删除字符串中的任何控制代码（除了换行符，\n，您可能想要）。

```
$data= preg_replace('/[\x00-\x09\x0B-\x19\x7F]/', '', $data); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-27T19:28:18.350

您想查看[PHP 的 utf_decode](http://us3.php.net/manual/en/function.utf8-decode.php)函数：将带有以 UTF-8 编码的 ISO-8859-1 字符的字符串转换为单字节 ISO-8859-1。看来您正在获取 UTF 字符，而数据库无法处理这些字符。

如果可能，另一种解决方案是更改数据库的编码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T20:15:05.770

我*终于*想出了一个替换这些字符的例程。它需要一次一个字符地解析一些有问题的字符串并返回每个字符的八进制值。在这样做的过程中，我了解到智能引号字符作为 3 个八进制值的集合返回。这是我用来解析字符串的例程：

```
$str = "string_with_smart_quote_chars";

$ilen = strlen($str);
$sords = NULL;

echo "$str\n\n";

for($i=0; $i<$ilen; $i++)
{
    $sords .= ord(substr($str, $i, 1))."  ";
}

echo "$sords\n\n"; 
```

这是用于“修复”字符串的 str_replace() 调用：

```
$str = str_replace(chr(226).chr(128).chr(156), '"', $str); // start quote
$str = str_replace(chr(226).chr(128).chr(157), '"', $str); // end quote
$str = str_replace(chr(226).chr(128).chr(153), "'", $str); // for single quote 
```

我将继续构建这些搜索/替换的数组，我相信随着这些类型字符的使用越来越多，这些搜索/替换将继续增长。

我知道有一些固定例程可以替换这些例程，但是在运行我的脚本的 Solaris 10 平台上，我对它们中的任何一个都没有运气。

——尼古拉斯

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-28T08:34:17.337

[Zend Framework](http://framework.zend.com/)并[`Zend_Filter`](http://framework.zend.com/manual/en/zend.filter.html)为此[`Zend_Filter_Input`](http://framework.zend.com/manual/en/zend.filter.input.html)提供了非常好的工具。

# sql-server - 什么 SqlDbType 映射到 varChar(max)？

> ID：596257
> 
> 赞同：18
> 
> 时间：2009-02-27T19:29:15.460
> 
> 标签：sql-server, ado.net

什么 SqlDbType 映射到 varChar(max)？SqlDbType.VarChar 说它限制为 8K，尽管这可能是文档错误。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-27T20:10:39.887

实际上，您可以将它与 VarChar 一起使用。如果它是一个参数，您可以使用以下命令构建它： new SqlParameter("@myparam", SqlDbType.NVarChar, -1)

请参阅：http: [//msdn.microsoft.com/en-us/library/bb399384.aspx](http://msdn.microsoft.com/en-us/library/bb399384.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T17:54:33.890

好的...终于弄清楚了...如果您收到一条错误消息：“字符串 [0]：Size 属性的大小为 0 无效。” 您只需将输出 SQL 参数的 size 参数设置为：

```
Dim parameter As SqlParameter = New SqlParameter("@FinalImportCount", SqlDbType.NVarChar)
parameter.Direction = ParameterDirection.Output
parameter.Size = 4000
cmd.Parameters.Add(parameter) 
```

希望这对某人有所帮助 - 已经尝试了 2 个小时来解决这个问题.... grrrrr。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-28T12:06:30.930

使用 VarChar，并将大小设置为 2147483647 (2gb-1)

# image - 图像指纹来比较许多图像的相似性

> ID：596262
> 
> 赞同：98
> 
> 时间：2009-02-27T19:30:53.180
> 
> 标签：image, image-processing, fingerprint

我需要创建许多图像的指纹（大约 100.000 个现有图像，每天 1000 个新图像，RGB，JPEG，最大尺寸 800x800）以非常快速地将每个图像与其他图像进行比较。我不能使用二进制比较方法，因为也应该识别几乎相似的图像。

最好的将是一个现有的库，但对现有算法的一些提示也会对我有很大帮助。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-07-02T18:19:41.080

普通散列或 CRC 计算算法不适用于图像数据。必须考虑信息的维度性质。

如果您需要极其强大的指纹识别，例如考虑仿射变换（缩放、旋转、平移、翻转），您可以[在图像源上使用 Radon 变换](http://www.sciencedirect.com/science?_ob=ArticleURL&_udi=B6V08-4BF62YK-1&_user=10&_rdoc=1&_fmt=&_orig=search&_sort=d&_docanchor=&view=c&_searchStrId=946481881&_rerunOrigin=google&_acct=C000050221&_version=1&_urlVersion=0&_userid=10&md5=869fbfafb72859f5918b6d21dff56762)来生成图像数据的规范映射 - 将其存储在每个图像中并然后只比较指纹。这是一个复杂的算法，不适合胆小的人。

一些简单的解决方案是可能的：

1.  为图像创建亮度直方图作为指纹
2.  创建每个图像的缩小版本作为指纹
3.  将技术 (1) 和 (2) 组合成一种混合方法，以提高比较质量

亮度直方图（尤其是分离为 RGB 分量的直方图）是图像的合理指纹 - 并且可以非常有效地实现。从另一个中减去一个直方图将产生一个新的直方图，您可以对其进行处理以确定两个图像的相似程度。直方图，因为唯一评估亮度/颜色信息的分布和出现可以很好地处理仿射变换。如果将每个颜色分量的亮度信息量化为 8 位值，则 768 字节的存储空间足以存储几乎任何合理大小的图像的指纹。当图像中的颜色信息被操纵时，亮度直方图会产生假阴性。如果您应用对比度/亮度、色调分离、颜色偏移等转换，亮度信息会发生变化。

使用缩放图像是将图像的信息密度降低到更容易比较的水平的另一种方法。缩小到原始图像大小的 10% 以下通常会丢失太多无法使用的信息 - 因此，可以将 800x800 像素的图像缩小到 80x80，并且仍然提供足够的信息来执行体面的指纹识别。与直方图数据不同，当源分辨率具有不同的纵横比时，您必须对图像数据执行各向异性缩放。换句话说，将 300x800 的图像缩小为 80x80 的缩略图会导致图像变形，因此与 300x500 的图像（非常相似）相比会导致误报。当涉及仿射变换时，缩略图指纹也经常产生假阴性。如果您翻转或旋转图像，

结合这两种技术是一种合理的方式来对冲您的赌注并减少误报和误报的发生。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-07-02T20:56:05.830

与此处提出的按比例缩小的图像变体相比，有一种更不特别的方法，它保留了它们的一般风格，但它为正在发生的事情提供了更严格的数学基础。

取图像的[Haar 小波](http://en.wikipedia.org/wiki/Haar_wavelet)。基本上，Haar 小波是从较低分辨率图像到每个较高分辨率图像的连续差异，但根据您在 mipmap 的“树”中的深度加权。计算很简单。然后，一旦对 Haar 小波进行了适当加权，就丢弃除 k 个最大系数之外的所有系数（就绝对值而言），对向量进行归一化并保存它。

如果你取其中两个标准化向量的点积，它会给你一个相似度的度量，其中 1 几乎相同。我在[这里](https://stackoverflow.com/questions/1034900/near-duplicate-image-detection/1076507#1076507)发布了更多信息。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2013-06-14T08:38:09.070

你绝对应该看看[phash](http://phash.org "开源感知哈希库")。

对于图像比较，有这个**php**项目： [https ://github.com/kennethrapp/phasher](https://github.com/kennethrapp/phasher)

还有我的小**javascript**克隆： [https ://redaktor.me/phasher/demo_js/index.html](https://redaktor.me/phasher/demo_js/index.html)

不幸的是，这是基于“位计数”的，但会识别旋转的图像。javascript 中的另一种方法是借助画布从图像中构建亮度直方图。您可以在画布上可视化多边形直方图并比较数据库中的多边形（例如 mySQL 空间...）

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-07-02T18:51:20.217

很久以前，我在一个具有一些相似特征的系统上工作，这是我们遵循的算法的近似值：

1.  将图片划分为多个区域。在我们的例子中，我们处理的是 4:3 分辨率的视频，所以我们使用了 12 个区域。这样做会使源图像的分辨率脱离图片。
2.  对于每个区域，计算一个整体颜色 - 区域中所有像素的平均值
3.  对于整个图像，计算整体颜色 - 所有区域的平均值

因此，对于每张图像，您都在存储`n + 1`整数值，其中`n`是您要跟踪的区域数。

为了进行比较，您还需要单独查看每个颜色通道。

1.  对于整体图像，比较整体颜色的颜色通道，看看它们是否在某个阈值内——比如 10%
2.  如果图像在阈值内，接下来比较每个区域。如果所有区域也在阈值范围内，则图像的匹配度足够高，您至少可以标记它们以进行进一步比较。

这使您可以快速丢弃不匹配的图像；您还可以使用更多区域和/或递归应用算法以获得更强的匹配置信度。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-27T20:07:06.057

与 Ic 的答案类似 - 您可以尝试以多种分辨率比较图像。因此，每个图像都保存为 1x1、2x2、4x4 .. 800x800。如果最低分辨率不匹配（受阈值限制），您可以立即拒绝它。如果匹配，您可以在下一个更高分辨率下比较它们，依此类推..

此外 - 如果图像共享任何相似的结构，例如医学图像，您可能能够将该结构提取到更容易/更快比较的描述中。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-12-24T23:05:26.220

截至 2015 年（回到未来……关于这个 2009 年的问题，现在在 Google 中排名靠前），可以使用深度学习技术计算图像相似度。称为自动编码器的算法系列可以创建可搜索相似性的向量表示。[这里](http://www.cbsr.ia.ac.cn/users/ynyu/dnn.html)有一个演示。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-02-17T19:54:53.140

对于 iPhone 图像比较和图像相似度开发，请查看： [http ://sites.google.com/site/imagecomparison/](http://sites.google.com/site/imagecomparison/)

要查看它的实际效果，请查看 iTunes AppStore 上的 eyeBuy Visual Search。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-27T19:47:23.780

您可以做到这一点的一种方法是调整图像大小并显着降低分辨率（可能是 200x200？），存储一个较小的（像素平均）版本进行比较。然后定义一个容差阈值并比较每个像素。如果所有像素的 RGB 都在容差范围内，则表示匹配。

您的初始运行时间为 O(n^2)，但如果您对所有匹配项进行编目，则每个新图像只是一个 O(n) 算法进行比较（您只需将其与每个先前插入的图像进行比较）。然而，随着要比较的图像列表变大，它最终会崩溃，但我认为你暂时是安全的。

运行 400 天后，您将拥有 500,000 张图像，这意味着（扣除缩小图像大小的时间）`200(H)*200(W)*500,000(images)*3(RGB)`= 60,000,000,000 次比较。如果每张图片都完全匹配，那么您将落后，但情况可能并非如此，对吧？请记住，只要单个比较超出您的阈值，您就可以将图像视为匹配项。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-27T19:56:16.613

您是否真的想将每张图片与其他图片进行比较？应用程序是什么？也许您只需要某种基于某些描述符的图像索引和检索？然后，例如，您可以查看多媒体内容描述接口的 MPEG-7 标准。然后你可以比较不同的图像描述符，这不会那么准确，但要快得多。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-09-30T10:49:33.993

所以你想做与“图像匹配”完全不同的“指纹匹配”。指纹分析在过去 20 年中得到了深入研究，并且开发了几种有趣的算法来确保正确的检测率（关于**FAR**和**FRR**测量 -**错误接受率**和**错误拒绝率**）。

我建议您更好地查看**LFA（局部特征分析）**类检测技术，主要基于细节检查。细节是任何指纹的特定特征，并已分为几类。将光栅图像映射到细节图实际上是大多数公共当局为提交罪犯或恐怖分子所做的事情。

请参阅[此处](http://en.wikipedia.org/wiki/Minutiae)以获取更多参考

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-02-28T07:15:13.283

似乎专门的图像散列算法是一个积极研究的领域，但也许图像字节的正常散列计算可以解决问题。

您是否正在寻找字节相同的图像，而不是寻找源自相同来源但可能具有不同格式或分辨率的图像（这让我觉得这是一个相当困难的问题）。

# ruby-on-rails - 通过覆盖二进制文件将 Ruby 1.86 升级到 1.9

> ID：596265
> 
> 赞同：1
> 
> 时间：2009-02-27T19:31:23.130
> 
> 标签：ruby-on-rails, windows, ruby, installation, upgrade

不久前，我使用一键式安装程序安装了 1.86。

我想升级到 1.9，但由于 1.9 没有一键式安装程序，我只下载了 1.91 二进制文件并覆盖了我的 1.86 安装。

没那么好用。之后我到处都是错误。

升级的正确方法是什么（对于一个假人，即我）？

[下载页面](http://www.ruby-lang.org/en/downloads/) 有三个适用于 Windows的选项：

```
* Ruby 1.8.6 One-Click Installer (md5: 00540689d1039964bc8d844b2b0c7db6) Stable version (recommended)
* Ruby 1.8.7-p72 Binary (md5: d4b04ba03a76dc70120fe96ffa22e5df) Stable version (recommended)
* Ruby 1.9.1-p0 Binary (md5: 921db53c709ce20106610f7d229e24e1) Stable version (recommended) 
```

**一般是不是应该用一键安装器安装1.86，然后用1.9覆盖安装目录就可以了？还是我不应该那样做？**

有没有更好的方法来全新安装 1.9？

我想我只是不确定如何在不首先使用 1.86 一键安装程序的情况下安装 1.9。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T20:37:39.290

要安装，只需将 zip 文件解压缩到您选择的文件夹中。您会发现它为您提供的文件夹结构与您在 1.8 安装文件夹中看到的大致相同。缺少 Scite 和示例，当然你不会有你的开始菜单快捷方式。

我建议您将 Ruby 1.9 安装到与 1.8 安装不同的文件夹中，然后更改路径语句以指向这个新文件夹。

可能发生的情况是您正在提取与 1.9 不兼容的 gem 或其他代码。全新的 1.9 安装将使您更好地了解缺少哪些代码和/或需要更新哪些代码才能工作。

——布鲁斯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T19:44:29.823

Ruby 1.9 可能安装得很好，但上次我听说 1.9 仍然[*不是 100%*与 Rails](http://blog.codefront.net/2007/12/26/ruby-190-has-been-released/)兼容，尽管[非常基础的东西是可以工作的](http://frozenplague.net/2009/01/ruby-191-rubygems-rails/)。你知道这种情况吗？

# c# - DataContractJsonSerializer 的反序列化问题

> ID：596271
> 
> 赞同：23
> 
> 时间：2009-02-27T19:32:31.863
> 
> 标签：c#, wcf, json, dictionary, serialization

我有以下一段 JSON：

```
[{
    "name": "numToRetrieve",
    "value": "3",
    "label": "Number of items to retrieve:",
    "items": {
        "1": "1",
        "3": "3",
        "5": "5"
    },
    "rules": {
        "range": "1-2"
    }
},
{
    "name": "showFoo",
    "value": "on",
    "label": "Show foo?"
},
{
    "name": "title",
    "value": "Foo",
    "label": "Foo:"
}] 
```

多合一版本（适用于字符串文字）：

```
[{\"name\":\"numToRetrieve\",\"value\":\"3\",\"label\":\"Number of items to retrieve:\",\"items\":{\"1\":\"1\",\"3\":\"3\",\"5\":\"5\"},\"rules\":{\"range\":\"1-2\"}},{\"name\":\"showFoo\",\"value\":\"on\",\"label\":\"Show foo?\"},{\"name\":\"title\",\"value\":\"Foo\",\"label\":\"Foo:\"}] 
```

在上面的示例中`name`，`value`、 和`label`是必需的，但`items`和`rules`是可选的。

这是我试图反序列化的类：

```
using System.Collections;
using System.Collections.Generic;
using System.Runtime.Serialization;

namespace foofoo
{
    [DataContract]
    public sealed class FooDef
    {
        [DataMember(Name = "name", IsRequired = true)]
        public string Name { get; set; }

        [DataMember(Name = "value", IsRequired = true)]
        public string Value { get; set; }

        [DataMember(Name = "label", IsRequired = true)]
        public string Label { get; set; }

        [DataMember(Name = "items", IsRequired = false)]
        public Dictionary<string, string> Items { get; set; }

        [DataMember(Name = "rules", IsRequired = false)]
        public Dictionary<string, string> Rules { get; set; }
    }
} 
```

这是我用来反序列化的代码：

```
var json = new DataContractJsonSerializer(typeof(List<FooDef>));
var bar = "[{\"name\":\"numToRetrieve\",\"value\":\"3\",\"label\":\"Number of items to retrieve:\",\"items\":{\"1\":\"1\",\"3\":\"3\",\"5\":\"5\"},\"rules\":{\"range\":\"1-2\"}},{\"name\":\"showFoo\",\"value\":\"on\",\"label\":\"Show foo?\"},{\"name\":\"title\",\"value\":\"Foo\",\"label\":\"Foo:\"}]";
var stream = new MemoryStream(Encoding.UTF8.GetBytes(bar));
var foo = json.ReadObject(stream);
stream.Close(); 
```

一切都还算顺利，除了`items`第一遍是`rules`空的。`FooDef`我已经在阳光下尝试了所有方法来尝试填充它们：后者的自定义类`NameValueCollection`，，，`KeyValuePair<string, string>`以及`List`似乎适用的所有其他集合。[编辑：我忘了尝试`Hashtable`，这似乎是一个明显的候选人。没用。]

正如我所看到的，问题在于下面的关键部分`items`是`rules`开放式的。也就是说，它并不总是被称为`range`or `3`。有什么建议或想法吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-01T11:24:57.230

恕我直言，无法使用 DataContractJsonSerializer 将您提供的 JSON 字符串反序列化为 .NET 类。

问题来自[DataContractJsonSerializer](http://msdn.microsoft.com/en-us/library/bb412168.aspx)序列化字典的方式。您可以使用替代序列化程序，例如[Json.NET](http://james.newtonking.com/projects/json-net.aspx)（我强烈推荐）或[JavaScriptSerializer](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.aspx)（我认为它已被弃用，有利于 DataContractJsonSerializer，但它适用于您的场景）。

您也可以阅读[这些](http://blog.geocortex.com/2009/02/17/handy-trick-for-json-serialization/) [咆哮](http://blog.dotsmart.net/2008/01/07/wcf-json-serialization-is-flawed/)。

文档：**[序列化集合 - Json.NET](http://www.newtonsoft.com/json/help/html/SerializingCollections.htm)**

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-06-25T11:56:09.663

[http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/071f73bb-e141-4a68-ae61-05635382934f](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/071f73bb-e141-4a68-ae61-05635382934f)

看看这篇文章——它几乎完美地解决了我的问题。我不得不将他们的 object[] 类型更改为字符串，但我只使用字符串：字符串类型键/值对，所以那里没有问题。

# asp.net - 为什么我的数据库没有被这个 LINQ 查询更新？

> ID：596274
> 
> 赞同：1
> 
> 时间：2009-02-27T19:33:20.583
> 
> 标签：asp.net, linq

代码：

```
Public Sub UpdateDB()
    Dim db As New linqclassesDataContext
    Dim article = From p In db.articles _
              Where p.id = articlelist.SelectedValue _
              Select p

    article.FirstOrDefault.body = FCKeditor1.Value
    Try
        db.SubmitChanges()
    Catch ex As ChangeConflictException
        fcke_output.Text = ex.Message
    End Try
End Sub 
```

没有抛出错误，但我的数据库值没有更新。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T19:35:56.350

是的，确保生成的类具有主键属性。

**更新 1：** linq2sql 在没有指定主键时表现不佳 - 如果表上没有主键，请确保在设计器上指定一个适当的主键

# javascript - 加载后更新 iframe 正文颜色

> ID：596277
> 
> 赞同：0
> 
> 时间：2009-02-27T19:33:51.300
> 
> 标签：javascript, iframe

我有一个页面 ,page1.html 通过 iframe 加载 page2.html 。我需要更改 iframe 页面 (page2.html) 的正文颜色以覆盖 page2.html 上加载的 CSS 样式。（两个页面都在同一个域上）。如何通过 Javascript 进行更新？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T19:49:32.387

一些谷歌搜索出现了这个：

[编写 IFrame 脚本](http://www.dyn-web.com/tutorials/iframes/)

它建议 window.frames[iframeName].document 应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T20:03:57.453

由于两个页面都位于同一个域中，因此应该很容易。

尝试这个，

```
 var changeIFrameBodyColor = function()
 {
   var iFrame =  document.getElementById('iFrame');
   var iFrameBody;
   if ( iFrame.contentDocument ) 
   { // DOM
     var iFrameBody = iFrame.contentDocument.getElementdByTagName('body')[0];
   }
   else if ( iFrame.contentWindow ) 
   { // IE
     var iFrameBody = iFrame.contentWindow.document.getElementdByTagName('body')[0];
   }
   iFrameBody.style.color = '#ff0000';
 }
 <a href="javascript:;" onclick="changeIFrameBodyColor()">Change Color</a>
 <iframe id="iFrame" src="page2.html" ../> 
```

# jquery - jQuery onclick 函数没有触发

> ID：596281
> 
> 赞同：2
> 
> 时间：2009-02-27T19:34:37.087
> 
> 标签：jquery

我有一个“链接”，点击后会显示一个充满内容的 div。单击“打开”按钮后，将变为具有关闭功能的“关闭”按钮。

> **jQuery 代码**

```
$(document).ready(function () {
    $('.open_user_urls').click(function () {
        $('#user_urls').slideDown('slow');
        $('.open_user_urls').addClass('close_user_urls');
        $('.open_user_urls').removeClass('open_user_urls');
        $('.close_user_urls').html('Close Search History');
        return false;
    });

    $('.close_user_urls').click(function () {
        $('#user_urls').slideUp('slow');
        $('.close_user_urls').addClass('open_user_urls');
        $('.close_user_urls').removeClass('close_user_urls');
        $('.open_user_urls').html('Show Search History');
        return false;
    });
}); 
```

它在第一次点击时按预期工作。显示 div，将 html 内容更改为新文本，并更改​​链接上的类。

但是再次点击关闭它什么也没做。如果我将 .close__user_urls 单击函数粘贴到 Firebug 控制台中，运行它，然后单击，它将按预期关闭。

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-27T19:39:13.067

当页面被填充时，类 $('.close_user_urls') 不存在 - 所以当它被绑定在 $(document).ready() 上时它不存在。

使用 jQuery 1.3.2 完成此任务的最简单方法是使用“实时”函数：

```
$(document).ready(function(){
   $('.open_user_urls').live('click', function() {
       $('#user_urls').slideDown('slow');
       $(this).addClass('close_user_urls');
       $(this).removeClass('open_user_urls');
       $(this).html('Close Search History');
       return false;
   });

   $('.close_user_urls').live('click', function() {
       $('#user_urls').slideUp('slow');
       $(this).addClass('open_user_urls');
       $(this).removeClass('close_user_urls');
       $(this).html('Show Search History');
       return false;
   }); 
)}; 
```

实时函数将指定的事件绑定到所有当前*和未来的*匹配元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T19:37:42.837

我相信第二个函数仅适用于具有该 CSS 类“.close_user_urls”的元素，最初为 0。

在旧版本的 jQuery 中，[livequery 插件](http://docs.jquery.com/Plugins/livequery)将让 jQuery 在项目获取和丢失 css 类时跟踪和添加/删除点击事件。如上面的答案所述，在较新的版本中，这是内置的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T20:03:29.653

我会这样做：

```
$(document).ready(function(){
    $('.open_user').click(function() {
        var link = $(this);
        if (link.hasClass('opened')) {
            link.removeClass('opened').text('Show Search History');
            $('#user_urls').slideUp('slow');
        } else {
            link.addClass('opened').text('Close Search History');
            $('#user_urls').slideDown('slow');
        }
        return false;
    }
); 
```

# c# - 在域驱动设计中，将调用其他对象的存储库放在域对象中会违反 DDD 吗？

> ID：596285
> 
> 赞同：8
> 
> 时间：2009-02-27T19:35:34.540
> 
> 标签：c#, design-patterns, service, domain-driven-design

我目前正在重构一个即将结束的项目的一些代码，我最终将大量业务逻辑放入服务类而不是域对象中。此时，大多数域对象只是数据容器。我决定在服务对象中编写大部分业务逻辑，然后将所有内容重构为更好、更可重用和更易读的形状。这样我就可以决定哪些代码应该放在域对象中，哪些代码应该分拆到它们自己的新对象中，以及哪些代码应该留在服务类中。所以我有一些代码：

```
public decimal CaculateBatchTotal(VendorApplicationBatch batch)
{
     IList<VendorApplication> applications = AppRepo.GetByBatchId(batch.Id);

     if (applications == null || applications.Count == 0)
          throw new ArgumentException("There were no applications for this batch, that shouldn't be possible");
     decimal total = 0m;
     foreach (VendorApplication app in applications)
          total += app.Amount;
     return total;
} 
```

这段代码似乎可以很好地添加到域对象中，因为它的唯一输入参数是域对象本身。似乎是一些重构的完美候选者。但唯一的问题是这个对象调用了另一个对象的存储库。这让我想把它留在服务课上。

我的问题是：

1.  你会把这段代码放在哪里？
2.  你会打破这个功能吗？
3.  遵循严格的领域驱动设计的人会把它放在哪里？
4.  为什么？

谢谢你的时间。

编辑注意：不能在这个上使用 ORM，所以我不能使用延迟加载解决方案。

编辑注2：我不能改变构造函数来接受参数，因为可能的数据层如何使用反射来实例化域对象（不是我的想法）。

编辑注3：我不认为批处理对象应该能够汇总任何应用程序列表，似乎它应该只能汇总该特定批次中的应用程序。否则，将函数留在服务类中对我来说更有意义。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T19:48:49.237

我不是 DDD 方面的专家，但我记得伟大的 Jeremy Miller 的一篇文章为我回答了这个问题。您通常需要与域对象相关的逻辑 - 在这些对象中，但您的服务类将执行包含此逻辑的方法。这帮助我将特定领域的逻辑推送到实体类中，并使我的服务类不那么笨重（因为我发现自己像你提到的那样在服务类中放置了很多逻辑）

**编辑：示例**

我使用企业库进行简单的验证，所以在实体类中我将设置一个属性，如下所示：

```
 [StringLengthValidator(1, 100)]
 public string Username {
     get { return mUsername; }
     set { mUsername = value; }
 } 
```

该实体继承自具有以下“IsValid”方法的基类，该方法将确保每个对象都满足验证条件

```
 public bool IsValid()
     {
         mResults = new ValidationResults();
         Validate(mResults);

         return mResults.IsValid();
     }

     [SelfValidation()]
     public virtual void Validate(ValidationResults results)
     {
         if (!object.ReferenceEquals(this.GetType(), typeof(BusinessBase<T>))) {
             Validator validator = ValidationFactory.CreateValidator(this.GetType());
             results.AddAllResults(validator.Validate(this));
         }
         //before we return the bool value, if we have any validation results map them into the
         //broken rules property so the parent class can display them to the end user
         if (!results.IsValid()) {
             mBrokenRules = new List<BrokenRule>();
             foreach (Microsoft.Practices.EnterpriseLibrary.Validation.ValidationResult result in results) {
                 mRule = new BrokenRule();
                 mRule.Message = result.Message;
                 mRule.PropertyName = result.Key.ToString();
                 mBrokenRules.Add(mRule);
             }
         }
     } 
```

接下来我们需要在服务类的保存方法中执行这个“IsValid”方法，像这样：

```
 public void SaveUser(User UserObject)
 {
     if (UserObject.IsValid()) {
         mRepository.SaveUser(UserObject);
     }
 } 
```

一个更复杂的例子可能是银行账户。存款逻辑将存在于帐户对象中，但服务类将调用此方法。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-27T20:00:23.903

您甚至不应该从域对象访问存储库。

您可以做的是让服务为域对象提供适当的信息，或者在由服务或构造函数设置的域对象中拥有一个委托。

```
public DomainObject(delegate getApplicationsByBatchID)
{
    ...
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-27T19:45:34.143

为什么不传入 IList`<VendorApplication>`作为参数而不是 VendorApplicationBatch？对此的调用代码可能来自可以访问 AppRepo 的服务。这样一来，您的存储库访问权限将在它所属的地方进行，而您的域功能可以保持对数据的来源一无所知。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-27T19:58:30.540

据我了解（没有足够的信息知道这是否是正确的设计） VendorApplicationBatch 应该在域对象内包含一个延迟加载的 IList，并且逻辑应该保留在域中。

例如（航空代码）：

```
public class VendorApplicationBatch  {

    private IList<VendorApplication> Applications {get; set;};   

    public decimal CaculateBatchTotal()
    {
        if (Applications == null || Applications.Count == 0)
            throw new ArgumentException("There were no applications for this batch, that shouldn't be possible");

        decimal Total = 0m;
        foreach (VendorApplication App in Applications)
            Total += App.Amount;
       return Total;
    }
} 
```

使用像 NHibernate 这样的 ORM 很容易做到这一点，我认为这将是最好的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-12-22T23:43:40.327

在我看来，您的 CalculateTotal 是 VendorApplication 集合的服务，并且为 Batch 返回 VendorApplication 集合自然适合作为 Batch 类的属性。因此，其他一些服务/控制器/任何会从批处理中检索适当的 VendorApplication 集合并将它们传递给 VendorApplicationTotalCalculator 服务（或类似的东西）。但这可能会破坏一些 DDD 聚合根服务规则或一些我不知道的东西（DDD 新手）。

# c# - 更新数据库时为什么要绕过DataSet？

> ID：596287
> 
> 赞同：0
> 
> 时间：2009-02-27T19:35:59.047
> 
> 标签：c#, .net, asp.net

1)

a) 为什么在更新、删除或插入记录时最好绕过 DataSet（我意识到使用 DataSet 需要更多的 CPU 时间和内存，但除此之外还有其他原因吗？！）？

b) 直接更新比批量更新快吗？为什么？

c) 为什么 Web 服务只代表真正的 Web 应用程序场景，在这种场景中通过 DataSet 执行批量更新是有意义的？

2) 我们可以使用UpdateCommand 来插入、删除或更新数据库中的行，那么DataAdapter 有InsertCommand、UpdateCommand 和DeleteCommand 对象有什么意义呢？为什么不只有一个 Command 对象而不是三个（甚至四个，因为 UpdateCommand 也可以用于 SELECT 语句）？

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-27T19:54:09.427

1）我不同意对这个问题所做的全部假设。还要注意 b) 是完全错误的。

2) 因为您希望针对不同的操作执行不同的查询，并且当您有一个加载了更改的数据集时，您只想执行一个简单的调用来完成所有的插入、删除和更新。

# visual-studio-2008 - VS 2008 C# Build 没有显示所有错误？

> ID：596289
> 
> 赞同：0
> 
> 时间：2009-02-27T19:36:06.117
> 
> 标签：visual-studio-2008, ide

VS2008/C# 新手在这里。

如果我打开我们的项目，没有打开任何代码文件，然后点击构建解决方案，它将显示大约六个错误。美好的。当我开始双击打开单个代码文件（或双击错误行）时，会出现更多错误，而不一定是我刚刚打开的文件。似乎构建解决方案没有进行完整的构建。这是正常行为吗？我们有 4 个人在同一个项目中处理不同的代码文件，有些人会看到与其他人不同的错误集。它很烦人。是否有设置或我们缺少的东西？

编辑：对不起，我没有更具体。这是一个 Visual C# 类库项目，包含 19 个 CS 文件，每个文件中有 1 到 3 个类。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T21:24:31.657

我必须看看才能确定，但​​我认为发生的事情是您在第一次构建时看到编译器错误，然后在打开文件时，您会收到额外的警告（黄色图标）或错误（红色 x ) 特定于文件。此外，还有一个设置只显示前 n 个错误，所以如果你超过了这个阈值，它可能会有这种行为。

通常，当您遇到一堆这样的错误时，有一些常见的原因，一旦解决，就会解决其余的问题。例如，缺少参考或类似的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T19:49:09.470

您是否尝试过使用 Build All vs Build？build all 命令实际上会编译您的整个解决方案。您的解决方案中有多个项目吗？

它也可能与您如何引用其他程序集有关。你的项目结构是什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T20:08:13.543

如果您使用的是 ASP.NET MVC，我遇到了一个问题，即一个视图页面上的错误会导致大量其他错误，从而导致项目无法构建。如果我在视图上找到并修复错误，其他一切都会自行纠正，整个项目就会构建。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-28T15:32:43.953

我看到#warning 有同样的问题。如果我搜索#warning 的解决方案，我会在 13 个文件中找到 16 行。如果我在没有打开文件的情况下重建解决方案，我只会在错误列表中看到 3 个警告（有 3 个项目有警告）。任何打开的文件也会报告它们的警告，如果任何有警告的文件被打开，它们也会显示在错误列表中。

如果我查看输出，则会在此处正确报告警告。我有一个项目有 14 个警告，但如果没有文件打开，则只显示一个。经过一番调查，似乎报告了项目中最后一个文件的警告：我在其中一个项目中的一个文件中添加了一个警告，只有一个警告，并且出现了新的警告（如果它是在之后编译的有其他警告的文件）。

# tsql - 您可以在 JOIN w/TSQL 上使用 LIKE 运算符进行更新吗？

> ID：596296
> 
> 赞同：2
> 
> 时间：2009-02-27T19:40:22.143
> 
> 标签：tsql, join, sql-like

我正在从逗号分隔文件进行大量导入，并希望在导入过程结束时执行的存储过程中查找雇主 ID。我遇到的问题是我的 LIKE 似乎不起作用......所以我想看看语法是否正确。

注意 - 这将更新所有记录 = 雇主名称，但任何像 'foo%' 之类的东西都不会更新

```
UPDATE UnitOfWork
SET EmployerId = SG.EmployerId
FROM UnitOfWork UO    
LEFT JOIN SpecialtyGroup SG ON SG.Name LIKE UO.EmployerName + '%'
WHERE SG.EmployerId IS NOT NULL 
```

是否可以以这种方式进行 LIKE，或者我是否需要在此加入之外进行另一次更新？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T19:45:17.700

对于`MS SQL 2008`：

```
MERGE
UnitOfWork UO
USING SpecialtyGroup SG
   ON SG.Name LIKE UO.EmployerName + '%'
WHEN MATCHED THEN
   UPDATE
   SET UO.EmployerId = SG.EmployerId 
```

对于`MS SQL 2005`：

```
WITH so AS
(
  SELECT UO.EmployerID, SG.EmployerID AS newEmployerID
  FROM UnitOfWork UO    
  LEFT JOIN SpecialtyGroup SG ON SG.Name LIKE UO.EmployerName + '%'
  WHERE SG.EmployerId IS NOT NULL
) 
UPDATE so
SET EmployerId = newEmployerID 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-08T06:44:47.073

在 JOIN 中使用 LIKE 通常让我抓到的是 CHAR 数据类型，您需要记住在添加 % 之前执行 RTRIM

# c - 使用 open() 系统调用

> ID：596306
> 
> 赞同：12
> 
> 时间：2009-02-27T19:44:24.393
> 
> 标签：c, file, unix

我正在编写一个将输出写入文件的程序。如果这个文件不存在，我想创建它。

目前，我在调用 open 时使用以下标志：O_WRONLY | O_CREATE

但是，当这创建文件时，它没有给我任何写入它的权限......

如何使用 open 以便在文件不存在时创建文件，但在需要时使用必要的权限创建文件？

谢谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-27T19:51:38.637

您可能需要第三个参数。例如：

```
打开（'路径'，O_WRONLY|O_CREAT，0640）；

```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-27T19:52:46.077

只需使用可选的第三个参数即可`open`：

```
int open(const char* pathname, int flags, mode_t mode); 
```

像这样：

```
open("blahblah", O_CREAT | O_WRONLY, S_IRUSR | S_IWUSER | S_IRGRP | S_IROTH); 
```

见`man open(2)`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T19:52:30.007

在 Linux 上，您可以使用第三个参数来传递权限。S_IWUSR 应该是给你写权限的标志，但实际上你可能想要使用更多的标志而不是那个标志（按位或一起）。检查手册页以获取权限标志列表。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-27T19:52:34.407

从[手册](http://www.opengroup.org/onlinepubs/000095399/functions/open.html)：

> O_CREAT
> 
> 如果文件存在，则此标志无效，除非在下面的 O_EXCL 下注明。否则，应创建文件；文件的用户ID设置为进程的有效用户ID；文件的组ID应设置为文件父目录的组ID或进程的有效组ID；**并且文件模式的访问权限位（参见 ）应设置为第三个参数的值**取类型 mode_t 修改如下：对文件模式位和进程的文件模式创建掩码的补码中的相应位执行按位与。因此，在文件模式创建掩码中设置了相应位的文件模式中的所有位都被清除。当设置了文件权限位以外的位时，未指定效果。第三个参数不影响文件是否打开以供读取、写入或两者兼而有之。实现应提供一种将文件的组 ID 初始化为父目录的组 ID 的方法。实现可以但不必提供一种实现定义的方式来将文件的组 ID 初始化为调用进程的有效组 ID。

因此，您似乎需要传递第三个参数来指定所需的文件权限。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-28T00:10:45.253

请注意，在 POSIX（Unix、Linux、MacOS 等）下，您可以使用您选择的任何权限打开和创建文件，包括 0（任何人都没有权限），但如果打开以进行写入，仍然可以写入文件。

# javascript-events - Javascript - onload, onclick 事件

> ID：596308
> 
> 赞同：2
> 
> 时间：2009-02-27T19:44:40.977
> 
> 标签：javascript-events

我有一个在页面加载时实例化的方法。该方法触发两个事件，window.onload 和 image.onclick。问题是在任何给定时间只有一个事件有效（即：如果我评论**image.onclick**方法，**window.onload**方法有效）。我如何让两者都工作？

**这在 Firefox (mozilla) 中可以正常工作，但在 IE 中不行**

*例子*

```
test.method = function()
{
    window.onload = this.doSomeWork;

    for (i = 0; i < images.length; i++) {
        var image = images[i];
        image.onclick = this.imageClickEvent;

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T22:42:12.560

在页面加载时触发 test.method 后，您使用新值覆盖您的 window.onload：this.dosomework，因此在主体加载的时间范围内，您调用第一个函数，然后立即覆盖，然后第二个函数采用结束，然后执行...您是否尝试将 window.onload 语句推到 test.method 的底部？我猜如果功能块太长，第二个 window.onload 永远不会执行，因为窗口已经完成加载，它的毫秒数，但仅此而已

显然在Firefox中，该功能在被覆盖之前执行，或者可能附加到当前的onload，不确定技术性。再次尝试将 onload 推到底部，看看会发生什么

您不应该在正文加载后调用的任何其他函数中真正调用 onload 函数，因为无论您多么小心，您都不能依赖于加载时间框架足够长以包含两个事件的事实，您应该追加到窗口.onload 在调用（或完成）body 标签之前确保事件被捕获。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T20:09:41.883

我们的问题是您只能有一个 onload 事件。

我建议 yuu 尝试使用此处的 addEvent 方法：

[http://ejohn.org/projects/flexible-javascript-events/](http://ejohn.org/projects/flexible-javascript-events/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T20:26:35.790

问题中没有足够的信息来弄清楚出了什么问题，但要查看的内容包括：

*   doSomeWork() 或 imageClickEvent() 中的代码是否期望收到一个指向任何特定内容的“this”？因为它不会，当您将方法从其所有者对象中剥离以分配给事件处理程序时。

*   是否有另一种写入 window.onload 或 image.onclick 的方法，您可能会覆盖它？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T19:49:14.383

使用 Firefox 3 查看页面上的代码。然后打开 Firefox 错误控制台 (Ctrl Shift J) 以查看哪一行中断了。然后使用新信息更新您的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-03T22:27:19.617

也许您应该在这里添加一个事件侦听器，而不是尝试捕获 window.onload？

# jquery - 带有空格的jQuery ID

> ID：596314
> 
> 赞同：140
> 
> 时间：2009-02-27T19:46:50.240
> 
> 标签：jquery

当 ID 有空格时，有谁知道如何使用 jQuery 通过 ID 选择 DOM 中的项目？

例如，我的项目的 ID 将是

```
<div id="content Module">Stuff</div> 
```

我将如何使用 jQuery 选择它？

如果我只是这样做

```
$("#content Module").whatever() 
```

jQuery 将尝试查找同时具有内容 ID 和模块 ID 的项目，这不是我想要的。

我应该补充一点，我正在使用一个旧代码库，其中这两个单词 id 被广泛使用，因此遍历并更改所有 ID 会很糟糕。

* * *

## 回答 #1

> 赞同：275
> 
> 时间：2009-03-31T16:45:31.607

使用属性选择器。

```
$("[id='content Module']").whatever(); 
```

或者，更好的是，也指定标签：

```
$("div[id='content Module']").whatever(); 
```

请注意，与 $('#id') 不同，如果您的页面中有多个具有相同 id 的元素，这将返回多个元素。

* * *

## 回答 #2

> 赞同：65
> 
> 时间：2009-02-27T19:51:10.277

不要使用空格，原因很简单，空格字符对于 ID 属性无效。

> ID 标记必须以字母 ([A-Za-z]) 开头，后跟任意数量的字母、数字 ([0-9])、连字符 ("-")、下划线 ("_")、冒号(":") 和句点 (".")。

**但是，如果您不关心标准，请尝试`$("[id='content Module']")`**

类似线程 > [HTML 中 id 属性的有效值是什么？](https://stackoverflow.com/questions/70579/what-is-a-valid-value-for-id-attributes-in-html)

编辑：**HTML 4.01 和 HTML5 之间的 id 有何不同**

> HTML5 摆脱了对 id 属性的额外限制。除了在文档中唯一之外，剩下的唯一要求是该值必须包含至少一个字符（不能为空），并且不能包含任何空格字符。

链接： http: [//mathiasbynens.be/notes/html5-id-class](http://mathiasbynens.be/notes/html5-id-class)

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2011-03-13T03:11:04.620

以防万一有人好奇，我发现逃离这个空间是可行的。当您无法控制目标 DOM（例如从用户脚本中）时，这特别有用：

```
$("#this\\ has\\ spaces"); 
```

请注意双反斜杠，这是必需的。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-02-27T23:13:52.613

Chris 建议的方法很可能适用于 jQuery 函数。

```
var element = document.getElementById('content Module');
$(element) ... ; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-27T19:51:29.947

一个尝试的想法：

```
$("#content" + &amp;#032; + "Module").whatever()

$("#content" + %20 + "Module").whatever() 
```

分号可能会导致 javascript 错误。我还建议将 ID 更改为没有任何空格。

另外，试试`document.getElementByID("content Module")`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-01-26T20:53:14.630

这对我有用。

```
document.getElementById(escape('content Module')); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-10-24T08:38:34.323

虽然[在 HTML 中的 ID 属性值中有空格在技术上是无效的](http://mathiasbynens.be/notes/html5-id-class)，但您实际上可以使用 jQuery 选择它。

见[http://mothereffingcssescapes.com/#content%20module](http://mothereffingcssescapes.com/#content%20module)：

```
<script>
  // document.getElementById or similar
  document.getElementById('content module');
  // document.querySelector or similar
  $('#content\\ module');
</script> 
```

jQuery 使用类似于 Selectors API 的语法，因此您可以`$('#content\\ module');`使用`id="content module"`.

要在 CSS 中定位元素，您可以像这样对其进行转义：

```
<style>
  #content\ module {
    background: hotpink;
  }
</style> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-11-16T19:56:11.027

如果您希望元素具有 id 的确切值，这可以工作

```
$("[id='content Module']").whatever(); 
```

但是如果你想检查元素是否只有其中一个（就像 class 一样）有或没有其他 id

```
$("[id~='content']").whatever(); 
```

这将选择元素，如果它有`id="content"`or`id="content Module"`或`id="content Module other_ids"`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-11-13T00:09:52.970

我发现对于我的情况，转义不起作用，因为它用 %20 替换了空格。我使用了替换，例如用列表项的文本替换页面的 h1。如果菜单包含：

```
<li id="Contact Us"\>Contact Us</li>

function setTitle(menu) {
    $("h1").text( $("li#" + menu.replace(" ", "\\ ")).text() );
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-09-17T15:42:37.623

我在 jQuery 中遇到了包含逗号和/或空格的元素 id 的问题，所以我这样做了，它就像一个魅力：

`var ele = $(document.getElementById('last, first'));`

这有空格并且不起作用：

`var ele = $('#last, first');`

这有逗号并且不起作用：

`var ele = $('#last,first');`

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-09-27T03:48:20.417

转义选择器上的任何杂项字符**（连同空格）**。

```
var escapeSelector = function(string) {
  string = string||"";
  if (typeof string !== 'string') return false;
    return string.replace( /(:|\.|\[|\]|,|=|@|\s|\(|\))/g, "\\$1" );

}
console.log($("div[data-id="+escapeSelector("Document (0).json")+"]").text()); 
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<div data-id="Document (0).json">Howdy</div>
```

# c# - 使用 HTTP PUT 将文件上传到 Sharepoint (WSS 3.0) 文档库

> ID：596315
> 
> 赞同：9
> 
> 时间：2009-02-27T19:46:50.300
> 
> 标签：c#, sharepoint, http, upload

嗨，我有以下代码可以将文件上传到 Sharepoint。它使用 HTTP PUT：

```
public static string UploadFile(string destUrl, string sourcePath)
        {
            try
            {
                Uri destUri = new Uri(destUrl);
                FileStream inStream = File.OpenRead(sourcePath);
                WebRequest req = WebRequest.Create(destUri);
                req.Method = "PUT";
                req.Headers.Add("Overwrite", "F");
                req.Timeout = System.Threading.Timeout.Infinite;
                req.Credentials = CredentialCache.DefaultCredentials;
                Stream outStream = req.GetRequestStream();
                string status = CopyStream(inStream, outStream);
                if (status == "success")
                {
                    outStream.Close();
                    WebResponse ores = req.GetResponse();
                    return "success";
                }
                else
                {
                    return status;
                }
            }
            catch (WebException we)
            {
            return we.Message;
            }
            catch (System.Exception ee)
            {
            return ee.Message;
            }
        } 
```

当我运行此代码时，我得到了异常：

> “远程服务器返回错误：（409）冲突。”

有人对我哪里出错有任何想法吗？

谢谢，

亚历克斯

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-04-18T20:54:09.420

当我引用文档库的 url 而不是目标文件本身时，我遇到了这个问题。

即尝试[http://服务器](http://server)名称/文档库名称/新文件名.doc

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T21:46:45.257

没有线索。但是你为什么不使用远程过程调用（RPC），这就是我通常的做法。

我发现这个例子可能会让你开始[http://geek.hubkey.com/2007/11/upload-file-to-sharepoint-document.html](http://geek.hubkey.com/2007/11/upload-file-to-sharepoint-document.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-05-31T18:44:28.077

尝试：

```
void StorePlainFile(string target_url, string filename, byte[] file_bytes)
{
      string url = target_url + "/" + filename;
      System.Net.WebClient client = new System.Net.WebClient();
      client.Credentials = System.Net.CredentialCache.DefaultCredentials;
      client.Headers.Add("Overwrite", "F");
      byte[] response = client.UploadData(url, "PUT", file_bytes);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-24T20:10:27.130

我还没有解决我的问题，这就是我在这里的原因，但我知道你为什么会收到这个错误。

出现错误是因为您没有设置隐藏但必需的字段。就我而言，我没有列，当然也没有必要的列。但是，有一个版本控制字段存在冲突。

我的意图是 1）上传文档，2）设置文档的元数据。1) 和 2) 发生在单独的 HTTP 调用上。理想情况下，我想在一个电话中执行此操作，但我不知道如何执行此操作。

为此，1) 成功，因此文档出现在库中。然后，当我尝试更新元数据时，就会出现 409 错误。

I'm pretty sure that I first need to insert a step in between 1) and 2) which first downloads the document's list (or manifest) which would in theory contain the needed versioning information. All I would need to do is set the metadata fields I need, and send back to the server.

No, we don't want to use the Sharepoint API because there are no libraries for it in Java. ;-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-02T02:08:22.567

您不能只使用 Sharepoint API（例如 SPFolder.Files.Add）上传文件是否有特殊原因？如下：

[http://msdn.microsoft.com/en-us/library/ms454491.aspx](http://msdn.microsoft.com/en-us/library/ms454491.aspx)

```
public void UploadFile(string srcUrl, string destUrl)
{
    if (! File.Exists(srcUrl))
    {
        throw new ArgumentException(String.Format("{0} does not exist", 
            srcUrl), "srcUrl");
    }

    SPWeb site = new SPSite(destUrl).OpenWeb();

    FileStream fStream = File.OpenRead(srcUrl);
    byte[] contents = new byte[fStream.Length];
    fStream.Read(contents, 0, (int)fStream.Length);
    fStream.Close(); 

    EnsureParentFolder(site, destUrl);
    site.Files.Add(destUrl, contents);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-10T10:21:38.430

亚历克斯，这也发生在我身上。您可能应该创建另一个照明或文档库并将文件上传到其中进行测试。

您可能需要检查变量“destUri”以查看它是否准确指向预期的共享点列表。

我的情况是我首先创建了一个文档库“需求”，有一个拼写错误，然后我将标题更改为“需求”。您应该注意到 sharepoint 仍然将此列表的 URL 保留为[http://server:port/Requrements](http://server:port/Requrements)

这是一个例外。希望它有所帮助。

# c# - 如何设计继承的集合

> ID：596316
> 
> 赞同：0
> 
> 时间：2009-02-27T19:47:18.147
> 
> 标签：c#, oop, inheritance, collections, .net-2.0

我正在用 C# 编写一个具有自定义集合的程序。自定义集合对其 ResultInfo 类型的成员执行一些有用的聚合函数（AllSuccessful、%Successful 等）。我有几个派生自 ResultInfo 的类（UploadResultInfo、XUploadResultInfo 和 YUploadResultInfo），并且希望拥有从具有附加聚合函数的 ResultInfoCollection 继承的附加集合。按照规定执行此操作的唯一问题是它留下了无用的

```
public void Add(ResultInfo item)
{ 

} 
```

收藏上。 **说明：此方法采用 ResultInfo 类型的参数，但添加到 UploadResultInfoCollection 的 ResultInfo 将引发错误。**有没有一种优雅的方式来解决我的问题？我考虑过泛型，但我不太清楚它是如何工作的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T20:03:28.653

要定义一个通用类来处理 ResultInfo 的任何子类，您只需将其定义为

```
public class MyCollection<T> : ICollection<T>
where T : ResultInfo
{

     ... the required methods ... just use "T" instead of "ResultInfo" ...

    public void Add(T item) {}
} 
```

稍后您可以使用它

```
 MyCollection<FooResultInfo> coll = new MyCollection<FooResultInfo>(); 
```

只是尝试使用它们，它们并不太难，边做边学是最好的方法......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T20:03:07.393

我不确定您是如何使用无用的 Add 方法的。

如果集合自行填充，您可以将 Add 方法设为私有。

如果您希望“继承”的附加集合不公开 Add 方法，请使用组合而不是继承。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T20:59:49.893

考虑一下你有用的方法是否真的需要是实例方法。

当其他操作发生时，它们是否需要维护状态，或者它们是否都可以使用公开可用（或内部可用）的 API？

如果是这样，那么只需将它们设为静态方法（扩展方法可能是一个好主意）并且不用担心继承。如果这些方法对 IEnumerable 有意义，`<T>`那就更好了，通过这样做，您可以使您的实用程序函数更加有用，从而更加有用。

使用生成的函数包只需要导入相关的命名空间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T21:17:00.677

如果您所做的只是为现有的集合类型提供一些额外的方法，那么请考虑简单地为该类型定义扩展方法并使用普通的泛型集合。

# linux - /dev/windrvr6 是什么

> ID：596320
> 
> 赞同：0
> 
> 时间：2009-02-27T19:47:59.097
> 
> 标签：linux, unix

什么是 /dev/windrvr6 这是通用驱动程序吗？我有 2 张由不同供应商使用 /dev/windrvr6 制作的卡，它们似乎工作正常。这会是未来的问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T19:52:48.947

可能他们都使用了[Jungo](http://www.jungo.com/)的工具；他们有帮助人们制作 PCI 驱动程序的产品，他们的部分通用基础架构是[WinDriver](http://www.jungo.com/st/windriver_usb_pci_driver_development_software.html)。（尽管它的名字，[它也适用于 Linux](http://www.jungo.com/st/linux.html)）

我不认为这应该是一个问题。

# sql - 在没有外键的情况下以编程方式提取 RDBMS 中表之间的关系？

> ID：596328
> 
> 赞同：1
> 
> 时间：2009-02-27T19:50:08.890
> 
> 标签：sql, database, metadata

我正在对 Oracle 数据库中中等数量的表（50+）之间的关系进行逆向工程，其中表之间没有定义外键。我可以指望（有点）能够跨表匹配列名。例如，列名“SomeDescriptiveName”在整个表集中可能相同。

我想做的是找到一种更好的方法来根据那些匹配的列名提取一些关系，而不是手动逐个遍历表。我可以用 Java DatabaseMetaData 方法做一些事情，但似乎这是有人可能以前必须编写脚本的任务之一。也许使用 Perl 或其他脚本语言提取列名，使用列名作为哈希键并将表添加到哈希键指向的数组中？

有人有任何提示或建议可以使这更简单或提供一个好的起点吗？这是一个丑陋的需求，如果已经定义了外键，那么理解关系会容易得多。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-28T01:55:15.970

我的策略是使用 Oracle 系统目录来查找列**名**和**数据类型**相同但**表名**不同的列。还有哪一列是表的主键或唯一键的一部分。

这是一个可能接近于执行此操作的查询，但我没有方便的 Oracle 实例来测试它：

```
SELECT col1.table_name || '.' || col1.column_name || ' -> ' 
    || col2.table_name || '.' || col2.column_name
FROM all_tab_columns col1 
  JOIN all_tab_columns col2
    ON (col1.column_name = col2.column_name 
    AND col1.data_type = col2.data_type)
  JOIN all_cons_columns cc
    ON (col2.table_name = cc.table_name 
    AND col2.column_name = cc.column_name)
  JOIN all_constraints con
    ON (cc.constraint_name = con.constraint_name 
    AND cc.table_name = con.table_name 
    AND con.constraint_type IN ('P', 'U')
WHERE col1.table_name != col2.table_name; 
```

当然，这不会得到任何相关但名称不同的列的情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T20:00:21.610

你几乎在你的问题中写下了答案。

```
my %column_tables;
foreach my $table (@tables) {
    foreach my $column ($table->columns) {
        push @{$column_tables[$column]}, $table;
    }
}
print "Likely foreign key relationships:\n";
foreach my $column (keys %column_tables) {
    my @tables = @{$column_tables[$column]};
    next
        if @tables < 2;
    print $column, ': ';
    foreach my $table (@tables) {
        print $table->name, ' ';
    }
    print "\n";
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T23:19:53.550

您可以结合使用三种（或四种）方法，具体取决于模式的混淆程度：

*   动态方法
    *   **观察**：
        *   在 RDBMS（或 ODBC 层）中启用跟踪，然后
        *   在应用程序中执行各种活动（理想情况下创建记录），然后
        *   确定哪些表以严格的顺序被更改，以及使用哪些列值对
        *   在序列间隔期间出现在多于一列中的值可能表示外键关系
*   静态方法*（仅分析现有数据，无需运行应用程序）*
    *   **命名法**：尝试从列名推断关系
    *   **统计**：查看所有数字列中唯一值的最小值/最大值（可能还有平均值），并尝试执行匹配
    *   **代码逆向工程**：你最后的手段（除非处理脚本）——不适合胆小的人:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-28T05:03:19.807

这是个有趣的问题。我采用的方法是蛮力搜索与小样本集的类型和值匹配的列。您可能必须调整启发式方法才能为您的模式提供良好的结果。我在不使用自动递增键的模式上运行它并且效果很好。代码是为 MySQL 编写的，但是很容易适应 Oracle。

```
use strict;
use warnings;
use DBI;

my $dbh = DBI->connect("dbi:mysql:host=localhost;database=SCHEMA", "USER", "PASS");

my @list;
foreach my $table (show_tables()) {
    foreach my $column (show_columns($table)) {
        push @list, { table => $table, column => $column };
    }
}

foreach my $m (@list) {
    my @match;
    foreach my $f (@list) {
        if (($m->{table} ne $f->{table}) &&
            ($m->{column}{type} eq $f->{column}{type}) &&
            (samples_found($m->{table}, $m->{column}{name}, $f->{column}{samples})))
        {
            # For better confidence, add other heuristics such as
            # joining the tables and verifying that every value
            # appears in the master. Also it may be useful to exclude
            # columns in large tables without an index although that
            # heuristic may fail for composite keys.
            #
            # Heuristics such as columns having the same name are too
            # brittle for many of the schemas I've worked with. It may
            # be too much to even require identical types.

            push @match, "$f->{table}.$f->{column}{name}";
        }
    }
    if (@match) {
        print "$m->{table}.$m->{column}{name} $m->{column}{type} <-- @match\n";
    }
}

$dbh->disconnect();

exit;

sub show_tables {
    my $result = query("show tables");
    return ($result) ? @$result : ();
}

sub show_columns {
    my ($table) = @_;
    my $result = query("desc $table");
    my @columns;
    if ($result) {
        @columns = map {
            { name => $_->[0],
              type => $_->[1],
              samples => query("select distinct $_->[0] from $table limit 10") }
        } @$result;
    }
    return @columns;
}

sub samples_found {
    my ($table, $column, $samples) = @_;
    foreach my $v (@$samples) {
        my $result = query("select count(1) from $table where $column=?", $v);
        if (!$result || $result->[0] == 0) {
            return 0;
        }
    }
    return 1;
}

sub query {
    my ($sql, @binding) = @_;
    my $result = $dbh->selectall_arrayref($sql, undef, @binding);
    if ($result && $result->[0] && @{$result->[0]} == 1) {
        foreach my $row (@$result) {
            $row = $row->[0];
        }
    }
    return $result;
} 
```

# sharepoint - SharePoint - 确定用于创建网站模板 (.STP) 的网站定义

> ID：596330
> 
> 赞同：2
> 
> 时间：2009-02-27T19:50:26.003
> 
> 标签：sharepoint, stp

SharePoint 网站模板基本上是网站定义和网站当前状态之间差异的保存版本。我读过站点模板只能应用于使用与创建模板相同的站点定义的站点。

如果您有 STP 文件，您如何确定使用哪个站点定义来创建站点模板？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T04:17:09.717

STP 文件只是 ZIP 压缩文件。如果您将扩展名重命名为 *.ZIP，您可以提取内容并检查包含您要查找的信息的 XML 文件。

我没有 STP 文件，所以我无法准确告诉您要查找的文件，但我以前做过，而且不难找到。

祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-10T14:55:25.370

使用这些步骤来确定站点模板所基于的站点定义：

1.  将 .STP 站点模板保存到本地文件夹。
2.  将其重命名为 .CAB 文件。
3.  提取 cab 文件。
4.  打开 manifest.xml 文件。
5.  在靠近顶部的部分会有一个 TemplateID 值（例如 1）
6.  TemplateID 指的是站点定义。
7.  打开 [12 hive]\TEMPLATE\1033\XML\WEBTEMP.XML。
8.  找到与站点模板清单文件中的 TemplateID 对应的 ID 的模板名称（例如 ）

我不知道为什么，但是站点定义是分组的，因此您可能不知道确切使用了哪个站点定义。例如，团队网站、空白网站和文档工作区都共享相同的模板 ID (1)。这应该意味着具有该 ID 的站点模板应该能够应用于这 3 个站点中的任何一个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-04T08:34:43.740

我编写的 SharePoint 对象模型代码列出了所有站点以及用于创建端的站点定义。请在此处查看：

[http://manish-sharepoint.blogspot.com/2009/06/finding-template-used-to-create-sites.html](http://manish-sharepoint.blogspot.com/2009/06/finding-template-used-to-create-sites.html)

# apache-flex - 弹性响应者默认超时值？

> ID：596331
> 
> 赞同：2
> 
> 时间：2009-02-27T19:50:26.173
> 
> 标签：apache-flex, actionscript

有谁知道响应者对象的默认超时值是多少？flex 应用程序等待结果并调用故障处理程序而不是结果处理程序时是否有时间限制？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-28T05:21:38.313

使用 getter / setter 访问 RemoteObject 的 requestTimeOut 属性。

更多信息：[远程对象](http://livedocs.adobe.com/flex/2/langref/mx/rpc/remoting/RemoteObject.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T20:11:56.497

首先...我建议在任何 cfc 调用中设置 cfquery 超时（如果您使用的是coldfusion）。如果查询超时，那么它将遇到您的错误。

在此处查看“requestTimeout” [http://livedocs.adobe.com/flex/2/langref/mx/rpc/remoting/RemoteObject.html#propertySummary](http://livedocs.adobe.com/flex/2/langref/mx/rpc/remoting/RemoteObject.html#propertySummary)

您也可以使用计时器对象创建自己的计时器一旦计时器达到某个点，您可以“断开连接”或“注销”，并手动调用故障函数

让我知道这是否有帮助。

# sql - 用于 XML 路径的 SQL Server

> ID：596333
> 
> 赞同：0
> 
> 时间：2009-02-27T19:50:53.707
> 
> 标签：sql, sql-server, sqlxml

我正在返回查询的 xml 结果。

给定两个表：

```
**Foo**
FooId int
FooName varchar(10)

**Bar**
BarId int
FooId int (FK)
BarName varchar(10) 
```

我创建了一个选择语句，例如：

```
SELECT
  FooId,
  FooName,
  (
    SELECT
      BarId,
      FooId,
      BarName
    FROM
      Bar
    WHERE
      Bar.FooId = Foo.FooId
      AND Bar.BarName = 'SomeBar'
    FOR XML PATH('Bar'), TYPE
  )
FROM
  Foo
WHERE
  Foo.FooName = 'SomeFoo'
  AND Foo.FooId IN
  (
    SELECT
      Bar.FooId
    FROM
      Bar
    WHERE
      Bar.BarName = 'SomeBar'
  )
FOR XML PATH('Foo'), TYPE 
```

这可以按我的预期工作并返回正确的结果。我意识到，在开发它时，我需要在子选择和 where 子句中的嵌套选择中复制过滤子句，以获得正确的结果。

我想确保没有更好的方法来做到这一点。一位同事提到使用别名来删除重复的子句，但不确定这将如何完成任何事情。

这是必要的，还是有更好的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T20:25:16.387

假设您只想返回具有 Bar 的 Foos，并且您需要在 XML 中保留 Bar 节点（即连接不起作用，因为它会使您的 XML 变平），没有办法大大简化这一点。您当然可以将 Bar 查询放入公用表表达式中，但如果您这样做，整个事情实际上会变得更长。

# c# - 重新打开 SqlConnection 实例

> ID：596339
> 
> 赞同：1
> 
> 时间：2009-02-27T19:52:04.517
> 
> 标签：c#, .net, asp.net

1）我注意到关闭 SqlConnection 实例后，您仍然可以重新打开相同的连接：

a) 你能告诉我幕后发生了什么吗？这意味着，在我们关闭文件流对象后，我们不能重新打开它，而是必须创建一个新对象——那么为什么 SqlConnection 对象不一样呢？

b）如果启用池，那么我假设连接对象返回到连接池，以后可以重用？！

但是我们怎么知道在重新打开连接之后，我们会得到与最初关闭它之前相同的 Sqlconnection 实例呢？我问这个是因为据我所知，即使连接池有多个可用连接，这些 SqlConnection 对象也可能处于与原始 SqlConnection 对象不同的状态（通过“不同状态”，我的意思是某些属性可能持有与那些不同的值在“原始”连接对象中）？！

c) 如果未启用池化怎么办？.Net 是否“从头开始”重新创建 SqlConnection 对象？同样，在我们最初关闭 SqlConnection 对象之前，我们可能已经更改了某些属性的值？编译器如何知道如何重新创建 SqlConnection 对象在我们关闭它之前所处的状态？

谢谢你

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T20:00:25.887

SqlConnection 首先不是直接的“真实”连接。连接池负责处理。我不确定，但如果您重新打开 SqlConnection，您最终可能会使用不同的“物理”网络连接，我不会感到惊讶。

您可以*编写*一个`FileStream`允许重新打开的文件 - 如果它跟踪文件的名称以及底层句柄，它可以尝试重新打开它，包括所有可能的失败等。它不是很有用。（我不能说我发现能够重新打开对`SqlConnection`个人很有用，诚然。）

就知道您将获得“相同的`SqlConnection`对象”而言 - 您没有调用返回`SqlConnection`对象引用的方法，您只是调用*现有*对象的方法。该引用不会改变 - 只是对象的状态（或者可能是它所引用的其他东西的状态）。

我不知道如果没有启用池会发生什么。它不能创建一个全新的`SqlConnection`对象（或者更确切地说它可以，但这不会*取代*你已经引用过的那个）。我怀疑这一切都归结为`SqlConnection`“其他东西”的包装——“其他东西”当然可以重新创建。

# javascript - 我如何知道通过 jQuery 选择了哪个单选按钮？

> ID：596351
> 
> 赞同：2939
> 
> 时间：2009-02-27T19:53:27.180
> 
> 标签：javascript, jquery, html, jquery-selectors, radio-button

我有两个单选按钮，想发布所选单选按钮的值。如何使用 jQuery 获得价值？

我可以像这样得到所有这些：

```
$("form :radio") 
```

我怎么知道选择了哪一个？

* * *

## 回答 #1

> 赞同：4178
> 
> 时间：2009-02-27T19:58:39.320

要获取具有 id 的表单的**选定** `radioName`项的值`myForm`：

```
$('input[name=radioName]:checked', '#myForm').val() 
```

这是一个例子：

```
$('#myForm input').on('change', function() {
   alert($('input[name=radioName]:checked', '#myForm').val()); 
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<form id="myForm">
  <input type="radio" name="radioName" value="1" /> 1 <br />
  <input type="radio" name="radioName" value="2" /> 2 <br />
  <input type="radio" name="radioName" value="3" /> 3 <br />
</form>
```

* * *

## 回答 #2

> 赞同：447
> 
> 时间：2010-01-07T00:45:35.760

用这个..

```
$("#myform input[type='radio']:checked").val(); 
```

* * *

## 回答 #3

> 赞同：331
> 
> 时间：2011-02-09T18:25:30.633

如果您已经引用了单选按钮组，例如：

```
var myRadio = $("input[name=myRadio]"); 
```

使用`filter()`函数，而不是`find()`. （`find()`用于定位子/后代元素，而`filter()`在您的选择中搜索顶级元素。）

```
var checkedValue = myRadio.filter(":checked").val(); 
```

* * *

*注意：*此答案最初是纠正另一个建议使用的答案，该答案`find()`似乎已被更改。`find()`对于您已经引用了容器元素但没有引用单选按钮的情况，仍然可能有用，例如：

```
var form = $("#mainForm");
...
var checkedValue = form.find("input[name=myRadio]:checked").val(); 
```

* * *

## 回答 #4

> 赞同：153
> 
> 时间：2011-03-30T22:29:39.923

这应该有效：

```
$("input[name='radioName']:checked").val() 
```

注意输入周围使用的“”：检查而不是像彼得J的解决方案那样的“”

* * *

## 回答 #5

> 赞同：86
> 
> 时间：2009-02-27T20:00:25.963

您可以将 :checked 选择器与单选选择器一起使用。

```
 $("form:radio:checked").val(); 
```

* * *

## 回答 #6

> 赞同：75
> 
> 时间：2013-08-30T20:27:20.817

如果您只想要布尔值，即是否已检查，请尝试以下操作：

```
$("#Myradio").is(":checked") 
```

* * *

## 回答 #7

> 赞同：58
> 
> 时间：2011-09-01T17:55:05.957

获取所有收音机：

```
var radios = jQuery("input[type='radio']"); 
```

过滤以获取选中的那个

```
radios.filter(":checked") 
```

* * *

## 回答 #8

> 赞同：55
> 
> 时间：2011-09-21T19:35:22.653

另一种选择是：

```
$('input[name=radioName]:checked').val() 
```

* * *

## 回答 #9

> 赞同：33
> 
> 时间：2010-10-16T20:20:16.097

```
$("input:radio:checked").val(); 
```

* * *

## 回答 #10

> 赞同：27
> 
> 时间：2012-08-02T17:09:49.283

就我而言，我在一种形式中有两个单选按钮，我想知道每个按钮的状态。这对我有用：

```
// get radio buttons value
console.log( "radio1: " +  $('input[id=radio1]:checked', '#toggle-form').val() );
console.log( "radio2: " +  $('input[id=radio2]:checked', '#toggle-form').val() ); 
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<form id="toggle-form">
  <div id="radio">
    <input type="radio" id="radio1" name="radio" checked="checked" /><label for="radio1">Plot single</label>
    <input type="radio" id="radio2" name="radio"/><label for="radio2">Plot all</label>
  </div>
</form>
```

* * *

## 回答 #11

> 赞同：26
> 
> 时间：2012-09-21T16:19:38.380

以下是我将如何编写表单并处理检查收音机的获取。

使用名为 myForm 的表单：

```
<form id='myForm'>
    <input type='radio' name='radio1' class='radio1' value='val1' />
    <input type='radio' name='radio1' class='radio1' value='val2' />
    ...
</form> 
```

从表单中获取值：

```
$('#myForm .radio1:checked').val(); 
```

如果您不发布表格，我会使用以下方法进一步简化它：

```
<input type='radio' class='radio1' value='val1' />
<input type='radio' class='radio1' value='val2' /> 
```

然后获取检查值变为：

```
 $('.radio1:checked').val(); 
```

在输入上有一个类名可以让我轻松地为输入设置样式......

* * *

## 回答 #12

> 赞同：18
> 
> 时间：2010-09-29T19:06:46.817

在**JSF**生成的单选按钮（使用`<h:selectOneRadio>`标记）中，您可以这样做：

```
radiobuttonvalue = jQuery("input[name='form_id\:radiobutton_id']:checked").val(); 
```

其中 selectOneRadio ID 是**radiobutton_id**，表单 ID 是**form_id**。

一定要使用**name**代替**id**，因为 jQuery 使用这个属性（**name**由 JSF 自动生成，类似于控件 ID）。

* * *

## 回答 #13

> 赞同：17
> 
> 时间：2011-11-15T16:04:02.503

另外，检查用户是否没有选择任何内容。

```
var radioanswer = 'none';
if ($('input[name=myRadio]:checked').val() != null) {           
   radioanswer = $('input[name=myRadio]:checked').val();
} 
```

* * *

## 回答 #14

> 赞同：17
> 
> 时间：2012-06-07T04:45:50.560

如果您有多个单一形式的单选按钮，那么

```
var myRadio1 = $('input[name=radioButtonName1]');
var value1 = myRadio1.filter(':checked').val();

var myRadio2 = $('input[name=radioButtonName2]');
var value2 = myRadio2.filter(':checked').val(); 
```

这对我有用。

* * *

## 回答 #15

> 赞同：16
> 
> 时间：2013-04-17T09:58:49.017

我编写了一个用于设置和获取单选按钮值的 jQuery 插件。它还尊重他们身上的“改变”事件。

```
(function ($) {

    function changeRadioButton(element, value) {
        var name = $(element).attr("name");
        $("[type=radio][name=" + name + "]:checked").removeAttr("checked");
        $("[type=radio][name=" + name + "][value=" + value + "]").attr("checked", "checked");
        $("[type=radio][name=" + name + "]:checked").change();
    }

    function getRadioButton(element) {
        var name = $(element).attr("name");
        return $("[type=radio][name=" + name + "]:checked").attr("value");
    }

    var originalVal = $.fn.val;
    $.fn.val = function(value) {

        //is it a radio button? treat it differently.
        if($(this).is("[type=radio]")) {

            if (typeof value != 'undefined') {

                //setter
                changeRadioButton(this, value);
                return $(this);

            } else {

                //getter
                return getRadioButton(this);

            }

        } else {

            //it wasn't a radio button - let's call the default val function.
            if (typeof value != 'undefined') {
                return originalVal.call(this, value);
            } else {
                return originalVal.call(this);
            }

        }
    };
})(jQuery); 
```

将代码放在任何地方以启用插件。那就尽情享受吧！它只是覆盖默认的 val 函数而不破坏任何东西。

你可以访问这个 jsFiddle 来尝试它，看看它是如何工作的。

[小提琴](http://jsfiddle.net/ffMathy/MN856/)

* * *

## 回答 #16

> 赞同：14
> 
> 时间：2012-07-17T12:01:46.803

```
 $(".Stat").click(function () {
     var rdbVal1 = $("input[name$=S]:checked").val();
 } 
```

* * *

## 回答 #17

> 赞同：14
> 
> 时间：2015-02-14T11:41:37.003

这工作正常

```
$('input[type="radio"][class="className"]:checked').val() 
```

[**工作演示**](http://jsfiddle.net/as4bnkmm/1/)

选择`:checked`器适用于`checkboxes`、`radio buttons`和 select 元素。仅对于选择元素，使用`:selected`选择器。

[**API 用于`:checked Selector`**](http://api.jquery.com/checked-selector/)

* * *

## 回答 #18

> 赞同：12
> 
> 时间：2013-01-11T18:05:37.697

要获取使用类的选定无线电的值：

```
$('.class:checked').val() 
```

* * *

## 回答 #19

> 赞同：11
> 
> 时间：2014-10-19T17:34:09.917

我使用这个简单的脚本

```
$('input[name="myRadio"]').on('change', function() {
  var radioValue = $('input[name="myRadio"]:checked').val();        
  alert(radioValue); 
}); 
```

* * *

## 回答 #20

> 赞同：10
> 
> 时间：2013-08-10T18:22:13.617

用这个：

```
value = $('input[name=button-name]:checked').val(); 
```

* * *

## 回答 #21

> 赞同：10
> 
> 时间：2020-09-28T11:48:29.237

试试这个。它对我有用

```
$('input[type="radio"][name="name"]:checked').val(); 
```

* * *

## 回答 #22

> 赞同：8
> 
> 时间：2017-08-01T06:09:58.667

**演示**：[https ://jsfiddle.net/ipsjolly/xygr065w/](https://jsfiddle.net/ipsjolly/xygr065w/)

```
 $(function(){
	    $("#submit").click(function(){      
	        alert($('input:radio:checked').val());
	    });
	 });
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<table>
       <tr>
         <td>Sales Promotion</td>
         <td><input type="radio" name="q12_3" value="1">1</td>
         <td><input type="radio" name="q12_3" value="2">2</td>
         <td><input type="radio" name="q12_3" value="3">3</td>
         <td><input type="radio" name="q12_3" value="4">4</td>
         <td><input type="radio" name="q12_3" value="5">5</td>
      </tr>
    </table>
<button id="submit">submit</button>
```

* * *

## 回答 #23

> 赞同：6
> 
> 时间：2013-08-12T02:13:15.463

如果您在 1 个表单上只有一组单选按钮，则 jQuery 代码就像这样简单：

```
$( "input:checked" ).val() 
```

* * *

## 回答 #24

> 赞同：5
> 
> 时间：2014-01-23T06:40:07.980

我已经发布了一个库来帮助解决这个问题。实际上，拉出所有可能的输入值，但还包括选中了哪个单选按钮。[您可以在https://github.com/mazondo/formalizedata](https://github.com/mazondo/formalizedata)查看它

它会给你一个答案的 js 对象，所以形式如下：

```
<form>
<input type="radio" name"favorite-color" value="blue" checked> Blue
<input type="radio" name="favorite-color" value="red"> Red
</form> 
```

会给你：

```
$("form").formalizeData()
{
  "favorite-color" : "blue"
} 
```

* * *

## 回答 #25

> 赞同：5
> 
> 时间：2018-11-07T20:27:20.423

JQuery 获取表单中的所有单选按钮和选中的值。

```
$.each($("input[type='radio']").filter(":checked"), function () {
  console.log("Name:" + this.name);
  console.log("Value:" + $(this).val());
}); 
```

* * *

## 回答 #26

> 赞同：4
> 
> 时间：2013-09-03T03:25:23.633

要检索 JavaScript 数组中的所有单选按钮值，请使用以下 jQuery 代码：

```
var values = jQuery('input:checkbox:checked.group1').map(function () {
    return this.value;
}).get(); 
```

* * *

## 回答 #27

> 赞同：4
> 
> 时间：2017-07-10T12:21:21.827

尝试一下-

```
var radioVal = $("#myform").find("input[type='radio']:checked").val();

console.log(radioVal); 
```

* * *

## 回答 #28

> 赞同：3
> 
> 时间：2017-10-03T12:56:52.860

另一种获取方式：

```
 $("#myForm input[type=radio]").on("change",function(){
   if(this.checked) {
    alert(this.value);
    }
  });
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<form id="myForm">
   <span><input type="radio" name="q12_3" value="1">1</span><br>
   <span><input type="radio" name="q12_3" value="2">2</span>
</form>
```

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2017-05-04T21:26:41.293

```
$(function () {
// Someone has clicked one of the radio buttons
var myform= 'form.myform';
$(myform).click(function () {
    var radValue= "";
    $(this).find('input[type=radio]:checked').each(function () {
        radValue= $(this).val();
    });
  })
}); 
```

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2020-01-10T09:22:53.243

尝试

```
myForm.myOption.value 
```

```
function check() {
  console.log( myForm.myOption.value );
}
```

```
<form id="myForm">
  <input type="radio" name="myOption" value="1"> 1 <br>
  <input type="radio" name="myOption" value="2"> 2 <br>
  <input type="radio" name="myOption" value="3"> 3 <br>
</form>
<button onclick="check()">check</button>
```

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2016-01-15T17:31:18.510

从[这个问题](https://stackoverflow.com/q/34815656/1541563)，我想出了另一种方法来访问当前选择的`input`当您在`click`其各自标签的事件中时。原因是因为新选择的对象在其click 事件`input`之后才更新。`label`

**TL;博士**

```
$('label').click(function() {
  var selected = $('#' + $(this).attr('for')).val();

  ...
}); 
```

```
$(function() {
  // this outright does not work properly as explained above
  $('#reported label').click(function() {
    var query = $('input[name="filter"]:checked').val();
    var time = (new Date()).toString();

    $('.query[data-method="click event"]').html(query + ' at ' + time);
  });

  // this works, but fails to update when same label is clicked consecutively
  $('#reported input[name="filter"]').on('change', function() {
    var query = $('input[name="filter"]:checked').val();
    var time = (new Date()).toString();

    $('.query[data-method="change event"]').html(query + ' at ' + time);
  });

  // here is the solution I came up with
  $('#reported label').click(function() {
    var query = $('#' + $(this).attr('for')).val();
    var time = (new Date()).toString();

    $('.query[data-method="click event with this"]').html(query + ' at ' + time);
  });
});
```

```
input[name="filter"] {
  display: none;
}
#reported label {
  background-color: #ccc;
  padding: 5px;
  margin: 5px;
  border-radius: 5px;
  cursor: pointer;
}
.query {
  padding: 5px;
  margin: 5px;
}
.query:before {
  content: "on " attr(data-method)": ";
}
[data-method="click event"] {
  color: red;
}
[data-method="change event"] {
  color: #cc0;
}
[data-method="click event with this"] {
  color: green;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<form id="reported">
  <input type="radio" name="filter" id="question" value="questions" checked="checked">
  <label for="question">Questions</label>

  <input type="radio" name="filter" id="answer" value="answers">
  <label for="answer">Answers</label>

  <input type="radio" name="filter" id="comment" value="comments">
  <label for="comment">Comments</label>

  <input type="radio" name="filter" id="user" value="users">
  <label for="user">Users</label>

  <input type="radio" name="filter" id="company" value="companies">
  <label for="company">Companies</label>

  <div class="query" data-method="click event"></div>
  <div class="query" data-method="change event"></div>
  <div class="query" data-method="click event with this"></div>
</form>
```

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2017-09-04T15:41:35.647

我需要做的是简化 C# 代码，即尽可能在前端 JavaScript 中做。我正在使用字段集容器，因为我在 DNN 中工作并且它有自己的形式。所以我不能添加表格。

我需要测试正在使用 3 个文本框中的哪个文本框，如果是，搜索的类型是什么？从值开始，包含值，值的精确匹配。

HTML：

```
<fieldset id="fsPartNum" class="form-inline">
<div class="form-group">
    <label for="txtPartNumber">Part Number:</label>
    <input type="text" id="txtPartNumber" class="input-margin-pn" />
</div>
<div class="form-group">
    <label for="radPNStartsWith">Starts With: </label>
    <input type="radio" id="radPNStartsWith" name="partNumber" checked  value="StartsWith"/>
</div>
<div class="form-group">
    <label for="radPNContains">Contains: </label>
    <input type="radio" id="radPNContains" name="partNumber" value="Contains" />
</div>
<div class="form-group">
    <label for="radPNExactMatch">Exact Match: </label>
    <input type="radio" id="radPNExactMatch" name="partNumber" value="ExactMatch" />
</div> 
```

我的 JavaScript 是：

```
 alert($('input[name=partNumber]:checked', '#fsPartNum').val()); 
    if(txtPartNumber.val() !== ''){
        message = 'Customer Part Number';
    }
    else if(txtCommercialPartNumber.val() !== ''){

    }
    else if(txtDescription.val() !== ''){

    } 
```

只需说可以使用任何带有 ID 的包含标签。对于 DNNers，这很高兴知道。此处的最终目标是将在 SQL Server 中启动部件搜索所需的内容传递给中级代码。

这样我也不必复制以前更复杂的 C# 代码。繁重的工作就在这里完成。

我不得不为此寻找一些东西，然后对其进行修补以使其正常工作。所以对于其他 DNNers，希望这很容易找到。

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2018-07-18T10:49:42.250

您需要使用`:checked`选择器进行访问：

### 检查此文档：

> *   [https://api.jquery.com/checked-selector/](https://api.jquery.com/checked-selector/)

一个例子：

```
$('input[name=radioName]:checked', '#myForm').val()
$('#myForm input').on('change', function() {
	$('#val').text($('input[name=radioName]:checked', '#myForm').val());
});
```

```
#val {
  color: #EB0054;
  font-size: 1.5em;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

<h3>Radio value: <span id='val'><span></h3>
<form id="myForm">
  <input type="radio" name="radioName" value="a"> a <br>
  <input type="radio" name="radioName" value="b"> b <br>
  <input type="radio" name="radioName" value="c"> c <br>
</form>
```

* * *

## 回答 #34

> 赞同：1
> 
> 时间：2019-01-26T14:05:43.740

这个怎么样？

使用**更改**并获取无线电类型的值被检查...

```
$('#my-radio-form').on('change', function() {
  console.log($('[type="radio"]:checked').val());
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0/jquery.min.js"></script>
<form id="my-radio-form">
  <input type="radio" name="input-radio" value="a" />a
  <input type="radio" name="input-radio" value="b" />b
  <input type="radio" name="input-radio" value="c" />c
  <input type="radio" name="input-radio" value="d" />d
</form>
```

* * *

## 回答 #35

> 赞同：1
> 
> 时间：2019-05-29T04:59:09.020

**请尝试以下示例以检查选择了哪个单选按钮**

```
<script>
    $('#form1 input').on('change', function() {
       alert($('input[name=age]:checked', '#form1 ').val()); 
    });
</script>
 <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js">
    <form id="form1">
      <input type="radio" name="age" value="18" /> 18 <br />
      <input type="radio" name="age" value="20" /> 20 <br />
      <input type="radio" name="age" value="22" /> 22 <br />
    </form> 
```

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2019-12-27T09:01:40.747

**用于设置和获取单选按钮值的 jQuery 插件。它还尊重他们身上的“改变”事件。**

```
 <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <form id="toggle-form">
      <div id="radio">
        <input type="radio" id="radio1" name="radio" checked="checked" /><label for="radio1">Plot single</label>
        <input type="radio" id="radio2" name="radio"/><label for="radio2">Plot all</label>
      </div>
    </form>
    <script type="text/javascript">
    $( document ).ready(function() {
     //Get all radios:
     var radios = jQuery("input[type='radio']");
     checked_radios=radios.filter(":checked");
for(i=0;i<checked_radios.length;i++)
{
   console.log(checked_radios[i]);
}

    });
    </script> 
```

**或其他方式**

```
<script type="text/javascript">
$( document ).ready(function() {
  //Get all radios:
  checked_radios=jQuery('input[name=radio]:checked').val(); 
for(i=0;i<checked_radios.length;i++)
{
   console.log(checked_radios[i]);
}

});
</script> 
```

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2020-04-13T19:41:37.457

除了 CSS 选择器`:checked`，您还可以使用[prop 函数](https://api.jquery.com/prop/)（从 jQuery 1.6 开始）。我不记得我正在从事的项目中，`$('#something').is(':checked')`有时仅使用仅有效，并且在失败时我也使用`$('#something').prop('checked')`了有效，但这使我同时使用了两者。

在下面的代码片段中，我编写了两个辅助函数，`is_checked`并且`get_group_value`. 该函数`is_checked`返回一个布尔真/假值；如果检查了传入参数的输入（也检查`prop()`函数），则为 true；如果未检查，则为 false。该函数`get_group_value`采用`name`无线电输入的 并返回被检查的值，如果没有被检查，则返回一个空字符串。这些辅助函数也适用于复选框，而不仅仅是单选按钮。

由于问题没有定义他们*何时*检索值，因此我为四 (3) 个不同的场景编写了一些侦听器：与任何单选按钮交互时、提交表单时以及单击其中一个时硬编码按钮一次性检索组的值。

请注意，我使用“单击”来识别用户何时与单选输入元素交互，因为“更改”永远不会被触发，因为“值”属性在被选中或不被选中时不会被更改。我将它用于复选框和单选按钮。

```
function is_checked(input) {
  var $input = $(input);
  return $input.is(':checked') || $input.prop('checked'); //Returns a boolean value. True if checked, false if not.
}
function get_group_value(group_name) {
  var $inputs = $('[name="' + group_name + '"]:checked');
  if ($inputs.length) { return $inputs.first().val(); } //If it exists, return the value of the first one found
  return ''; //If it doesn't exist, return nothing
}
$('form').on('submit', function(e) {
  e.preventDefault();
  var $form = $(this), results = {};
  $form.find('input[type=radio]').each(function() {
    var $input = $(this);
    if (is_checked(this)) {
      results[$input.attr('name')] = $input.val();
    }
  });
  console.info('Form Results', results);
});
$('form input[type=radio]').on('click', function(e) {
  var group_name = $(this).attr('name');
  console.info('Radio Button Click', group_name, get_group_value(group_name));
});
$('button.radio-button').on('click', function(e) {
  var group_name = $(this).attr('id');
  console.info('Button Click', group_name, get_group_value(group_name));
});
```

```
.my-test {
  background: #ffffff;
  color: #000000;
  padding: 16px;
}

form {
  padding: 8px;
  border: 1px solid #999999;
}

fieldset {
  border: none;
}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<div class="my-test">
  <form>
    Group 1
    <fieldset>
      <label><input type="radio" name="example-1" value="Foo" required />Foo</label>
      <label><input type="radio" name="example-1" value="Bar" required />Bar</label>
    </fieldset>
    Group 2
    <fieldset>
      <label><input type="radio" name="example-2" value="Banana" required />Banana</label>
      <label><input type="radio" name="example-2" value="Apple" required />Apple</label>
    </fieldset>
    <button type="submit">Submit</button>
  </form>
  <p>Press this button to just get the value of the first group: <button class="radio-button" id="example-1">Foo or Bar?</button></p>
  <p>Press this button to just get the value of the second group: <button class="radio-button" id="example-2">Banana or Apple?</button></p>
</div>
```

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2021-01-02T21:05:05.787

此解决方案不需要 jQuery。

```
const RADIO_NAME = "radioName";
const radios = Array.from(document.getElementsByName(RADIO_NAME));
const checkedRadio = radios.filter(e=>e.checked); 
```

这使用 jQuery：

```
const radios = Array.from($(`[name=${RADIO_NAME}`));
const checkedRadio = radios.filter(e=>e.checked); 
```

jQuery 添加了这里不需要的额外抽象层。

您还可以使用：

```
const radios = Array.from(document.querySelectorAll(`[name=${RADIO_NAME}`));
const checkedRadio = radios.filter(e=>e.checked)[0]; 
```

但是`getElementsByName`足够简单明了。

* * *

## 回答 #39

> 赞同：-1
> 
> 时间：2018-07-04T08:31:58.997

您可以调用函数**onChange()**

```
 <input type="radio" name="radioName" value="1" onchange="radio_changed($(this).val())" /> 1 <br />
  <input type="radio" name="radioName" value="2" onchange="radio_changed($(this).val())"  /> 2 <br />
  <input type="radio" name="radioName" value="3"  onchange="radio_changed($(this).val())" /> 3 <br />

<script>
function radio_changed(val){
    alert(val);
}
</script> 
```

# fluent-nhibernate - 我在哪里可以找到 Fluent NHibernate 教程？

> ID：596357
> 
> 赞同：35
> 
> 时间：2009-02-27T19:55:12.183
> 
> 标签：fluent-nhibernate

我已经用谷歌搜索并环顾四周，有没有人知道任何隐藏的宝石，这些宝石不在谷歌搜索的前几页......

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-28T00:34:34.307

维基是你最好的选择[。](https://github.com/jagregory/fluent-nhibernate/wiki/)我的博客上有一些[Fluent NHibernate 帖子](http://blog.jagregory.com/category/fluent-nhibernate/)，但大部分内容都反映在 wiki 上。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-08-03T20:26:12.740

我很欣赏这个教程，也许可以帮助你：

[http://nhforge.org/blogs/nhibernate/archive/2008/09/17/value-objects.aspx](http://nhforge.org/blogs/nhibernate/archive/2008/09/17/value-objects.aspx)

作者解释了值对象的概念，像组件一样使用它们。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-05-17T18:22:45.883

[这](http://dotnetslackers.com/articles/ado_net/Your-very-first-NHibernate-application-Part-1.aspx)对我帮助很大，也许你应该试试。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-27T20:12:11.643

[这](http://nhibernate.info/blog/2008/09/05/a-fluent-interface-to-nhibernate-part-1.html)是一篇关于 FluentNHibernate 的 4 部分博客文章。不确定你在寻找什么，但你也没有说。;)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-12-08T17:39:09.370

[http://www.dreamincode.net/forums/topic/161638-fluent-nhibernate-tutorial/](http://www.dreamincode.net/forums/topic/161638-fluent-nhibernate-tutorial/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-27T20:16:24.723

Fluent Nhibernate 有一个[wiki](https://github.com/jagregory/fluent-nhibernate/wiki/)，你检查过吗？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-10-29T04:11:16.290

这个视频教程于 2011 年 10 月 5 日添加到 youtube.com，让我在大约 30 分钟内开始跑步。 [流畅的 NHibernate 教程](http://www.youtube.com/watch?v=HQcnLP0iYQo)

更新：已经几个月了，但是如果您需要高级映射并且不介意 3rd 方工具，请使用 DevArt 的 Entity Developer 工具，它可以免费为多达 10 个表/实体创建所有实体和映射。实体映射的源代码可供您随时学习。如果你看它，你可以学到很多东西。 [http://www.devart.com/entitydeveloper/](http://www.devart.com/entitydeveloper/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-03-09T20:51:40.610

我喜欢[带有 Fluent Nhibernate 和 LINQ 2 NHibernate 的 NHibernate 3.0 教程](http://web.archive.org/web/20150829045748/http://www.d80.co.uk/post/2011/02/20/Linq-to-NHibernate-Tutorial.aspx)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-09-09T11:45:02.140

GitHub 项目页面提供了您需要的所有基本示例：[https ://github.com/jagregory/fluent-nhibernate/wiki/Getting-started](https://github.com/jagregory/fluent-nhibernate/wiki/Getting-started)

# c++ - 用于线程的良好 c++ 库

> ID：596360
> 
> 赞同：4
> 
> 时间：2009-02-27T19:55:52.400
> 
> 标签：c++, multithreading

我更喜欢仅基于 pthreads 的库。什么是用于线程的好的 c++ 库？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-27T19:59:59.520

[提升线程](http://www.boost.org/doc/libs/1_38_0/doc/html/thread.html)怎么样？

> Boost.Thread 允许在可移植的 C++ 代码中使用多个执行线程和共享数据。它提供用于管理线程本身的类和函数，以及用于在线程之间同步数据或提供特定于各个线程的数据的单独副本的其他类和函数。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-28T05:19:50.550

前段时间我看了一些选项。这里有一些：

*   [Boost Thread](http://www.boost.org/doc/libs/1_38_0/doc/html/thread.html) - 这是最标准的选择。Boost 是最标准的 C++ 库，不在官方标准中。
*   [POCO](http://pocoproject.org/) - 具有线程支持等等。是我的首选，因为它可以让你设置线程优先级，这是 boost 不支持的。线程优先级对我的应用程序域很重要（软实时）。
*   [Zthread](http://en.wikipedia.org/wiki/Zthread) - 看起来不错的库。我没有这方面的经验。
*   [ACE](http://www.cs.wustl.edu/~schmidt/ACE.html) - 著名的图书馆。我没有这方面的经验。

然后你有库可以让你在更高的抽象级别上操作，比如[Thread Buildings Blocks](http://www.intel.com/cd/software/products/asmo-na/eng/294797.htm)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T20:00:22.827

*   [Boost Threads](http://www.boost.org/doc/libs/1_38_0/doc/html/thread.html)似乎是一个非常明显的建议。
*   另外，如果您需要一些并发性，但又不想在线程上玩太多，那么也许是[Futures](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2671.html)（另请参阅 Boost 邮件列表）？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-27T20:07:29.427

另外，如果您需要一些并发性，但又不想过多地使用线程，那么您可以查看[Thread Building Blocks](http://www.threadingbuildingblocks.org/)。

# sql-server - 数据库表上的 1 对 1 关系有味道吗？

> ID：596363
> 
> 赞同：3
> 
> 时间：2009-02-27T19:56:18.733
> 
> 标签：sql-server, database, db-schema

我有一张有一堆字段的表。这些字段可以分成逻辑组——比如工作的项目经理信息。分组本身并不是真正的实体候选者，因为它们没有也不应该有自己的 PK。

现在，为了对它们进行分组，这些字段具有前缀（例如 PmFirstName），但我正在考虑将它们分成多个表，在主表上具有 1:1 的关系。

当我这样做时，有什么需要注意的吗？这只是一个糟糕的选择吗？

我可以看到，也许我的查询会因为所有额外的连接而变得更加复杂，但可以通过视图来缓解，对吗？如果我们谈论的是一个少于 10 万条记录的表，这会对性能产生显着影响吗？

**编辑：**我将进一步证明非实体候选人的想法。此信息由我们的用户群输入。他们不了解/不关心彼此。因此，同一个用户可能会提交相同的“projectManager 名称”或任何在这一点上不会违反任何约束的东西。如果我们想关联来自不同用户的条目，我们可以稍后确定。如果我给这些东西自己的键，它们将以与主表相同的速度增长——因为它们本质上是同一个实体的一部分。没有 pt 是用户从可用的“项目经理”列表中挑选的。

因此，鉴于上述情况，我认为它们不是实体。但也许不是 - 如果您有进一步的想法，请发布。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T20:03:28.747

除非有特定的性能原因，否则我通常不使用 1 对 1 关系。例如，将不常用的大文本或 BLOB 类型字段存储在单独的表中。

我怀疑这里还有其他事情发生。在您给出的示例中 - PmFirstName - 似乎应该有一个与“ProjectManagers”或“Employees”表相关的单个 pm_id。您确定这些分组都不是真正的实体候选人吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T20:00:54.370

对我来说，它们闻起来很臭，除非对于某些行或查询，您不会对额外的列感兴趣。例如，如果对于大部分查询，您没有选择 PmFirstName 列，或者对于大部分行，这些列是 NULL。

我喜欢气味标签。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-27T20:08:12.763

我将 1 对 1 关系用于类似继承的构造。

例如，所有债券都有一些基本信息，如 CUSIP、Coupon、DatedDate 和 MaturityDate。这一切都在主表中。

现在，每种类型的债券（Treasury、Corporate、Muni、Agency 等）也有自己独特的一组列。

在过去，我们只会有一张非常宽的桌子，里面有所有这些信息。现在我们将特定类型的信息分解成单独的表，这给了我们更好的性能。

> 现在，为了对它们进行分组，这些字段具有前缀（例如 PmFirstName），但我正在考虑将它们分成多个表，在主表上具有 1:1 的关系。

创建一个人表，每个数据库都需要这个。然后在您的项目表中有一个名为 PMKey 的列，它指向人员表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T20:02:21.277

为什么感觉这组字段不是实体候选项？如果不是，那么为什么要尝试用前缀来识别它们呢？

删除前缀或将它们提取到自己的表中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T20:09:02.090

如果它们是可以在其他地方使用的单独的逻辑实体，那么将它们分成单独的表是很有价值的。

因此，“项目经理”可能与当前的所有项目是 1:1 的，但稍后您可能希望项目经理拥有多个项目是有道理的。所以有额外的桌子很好。

如果您有 PrimaryFirstName、PrimaryLastName、PrimaryPhone、SecondaryFirstName、SecondaryLastName、SEcondaryPhone

您可以只拥有一个包含 FirstName、LastName、Phone 的“Person”表

那么您的原始表只需要“PrimaryId”和“SecondaryId”列来替换您之前拥有的 6 列。

此外，使用 SQL，您可以跨物理位置拆分文件组和表。因此，您可以有一个具有 1:1 关系的 POST 表和一个 COMMENT 表，但 COMMENT 表位于不同的文件组上，并且位于具有更多内存的不同物理驱动器上。

1:1 并不总是有气味。除非没有目的。

# sql - sp_reset_connection 有什么作用？

> ID：596365
> 
> 赞同：46
> 
> 时间：2009-02-27T19:57:14.770
> 
> 标签：sql, sql-server, connection-pooling

sp_reset_connection 似乎由 SQL Server 连接池调用，以确保从池中重用的连接的大部分设置都被重置。有谁确切地知道它做什么和不做什么？

例如，我从[这篇文章](http://blogs.msdn.com/jimmymay/archive/2009/02/02/sp-reset-connection-does-not-reset-transaction-isolation-level-unexpected-behavior-by-design.aspx)中看到它不会重置事务隔离级别

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-02-27T20:01:31.250

当重新使用来自连接池的连接时，数据访问 API 的层（如 ODBC、OLE-DB 和 SqlClient）调用（内部）存储过程 sp_reset_connection。它这样做是为了在重新使用之前重置连接的状态。

似乎没有关于重置什么的官方文档，但这里有一个非官方的列表。

sp_reset_connection 重置连接的以下方面：

> *   它重置所有错误状态和数字（如@@error）
> *   它停止作为执行并行查询的父 EC 的子线程的所有 EC（执行上下文）
> *   它将等待任何未完成的 I/O 操作
> *   它将通过连接释放服务器上任何持有的缓冲区
> *   它将解锁连接使用的任何缓冲区资源
> *   它将释放连接拥有的所有分配的内存
> *   它将清除连接创建的所有工作表或临时表
> *   它将杀死连接拥有的所有全局游标
> *   它将关闭所有打开的 SQL-XML 句柄
> *   它将删除任何打开的 SQL-XML 相关工作表
> *   它将关闭所有系统表
> *   它将关闭所有用户表
> *   它将丢弃所有临时对象
> *   它将中止打开的交易
> *   入伍时它将脱离分布式事务
> *   它将减少当前数据库中用户的引用计数；释放共享数据库锁
> *   它将释放获得的锁
> *   它将释放任何可能已获取的句柄
> *   它将所有 SET 选项重置为默认值
> *   它将重置@@rowcount 值
> *   它将重置@@identity 值
> *   它将使用 dbcc traceon() 重置任何会话级别的跟踪选项

sp_reset_connection 不会重置：

> *   安全上下文，这就是连接池根据确切的连接字符串匹配连接的原因
> *   如果您使用 sp_setapprole 输入了应用程序角色，因为应用程序角色无法恢复
> *   事务隔离级别

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-27T20:02:22.713

从[这个论坛帖子](http://bytes.com/groups/net-c/230333-sp_reset_connection)：

sp_reset_connection 存储过程用于重置连接，以便当它在池中使用时，不会存储先前会话中特定于连接的任何内容。

# c# - C# 中的静态方法与实例方法

> ID：596367
> 
> 赞同：6
> 
> 时间：2009-02-27T19:57:52.723
> 
> 标签：c#, .net, garbage-collection, clr, methods

对于我正在编写的应用程序，我希望具有极高的可扩展性，并且扩展方法似乎可以满足我的需求，并且能够在没有实例的情况下调用它们，这也是我需要的。

我记得读过静态方法比实例方法更快，但没有获得 GC 的优势。它是否正确？

除非我通过设计而不是速度找到更好的替代方案，否则我不太可能改变我的设计。但仍然需要额外的信息，我想知道速度、GC 等方面的差异。

编辑：谢谢。更多信息：假设我们有一个 Person 类：

```
class Person 
```

它可以有一个实例距离方法，例如：

```
this.Distance (Person p) 
```

这很好，但这并没有让我能够计算 2 个点之间的距离（比如 Point3），而无需创建 Person 类的实例。

我想做的是：

```
class Person (no Distance methods) 
```

但距离的扩展方法：

```
Distance (this Person, Person)
Distance (this Point3, Point3) 
```

这样我就可以做到：

```
myPerson.Distance (yourPerson) 
```

和

```
Extensions.Distance (pointA, pointB) 
```

EDIT2：@Jon，是的，我认为这就是（不要获得 GC 的优势）的意思，但我不知何故认为静态方法会产生这种负担/开销。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-27T20:03:16.893

在静态方法和实例方法之间进行选择是面向对象设计的问题。如果您正在编写的方法是一个对象的*行为*，那么它应该是一个实例方法。如果它不依赖于对象的实例，它应该是静态的。

基本上，静态方法属于一种类型，而实例方法属于一种类型的实例。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-27T20:03:42.553

“没有得到 GC 的优势”是什么意思？方法不是垃圾收集 - 实例是。

虚拟方法比非虚拟方法*稍慢*，我猜在任何实例方法之前都会有讨厌的空检查，但这并不重要。选择最合适的设计。

静态方法对测试来说很痛苦——例如，如果你`Foo()`通过调用一些静态方法在方法中进行身份验证，那么当你测试时`Foo()`你不能让它只调用一个模拟验证器（除非静态方法本身允许你这样做）。但是，如果您给正在测试的任何内容的原始实例提供包含`Authenticate()`方法的某个接口的模拟实现，那么您可以使其行为随心所欲。

编辑：在这种情况下，听起来您真正需要的是`Point`类型上的实例方法来计算两点之间的距离（“this”一个和另一个） - 或者可能是该`Distance`类型的静态工厂方法。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-27T20:17:05.783

如果更快意味着方法内的代码执行得更快，那么不是。静态方法中的代码与非静态方法中的代码一样快。

如果您正在谈论执行对方法的调用的开销，它会变得有点复杂。对于像 Java 这样的语言来说，实例调用具有更多开销是很常见的。然而，在 C# 中，情况并非如此，因为实例方法默认情况下不是虚拟的。

因此，虚拟方法比非虚拟方法的开销略多。静态方法不能是虚拟的，但实例方法可以声明为虚拟的。

至于垃圾收集，这主要与字段相关，而不是方法。可以从代码中的任何地方访问静态字段，因此垃圾收集器无法确定是否会再次使用引用，因此永远不会收集它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-27T20:24:39.820

根据您的示例，我将编写一个静态实用程序函数来查找两点之间的距离：

```
public static class Geometry
{
    public static double GetDistanceBetween(Point a, Point b) { ... }
} 
```

然后我会给 Person 一个名为 Position 的属性，它返回一个点。所以我可以写：

```
double distance = Geometry.GetDistanceBetween(personA.Position, personB.Position); 
```

它实际上已经是英文的了——为什么让它更晦涩难懂？如果你让距离成为一种方法，那么你可以写：

```
personA.Distance(personB) 
```

或者：

```
personB.Distance(personA) 
```

这两种排序之间没有区别，但是方法调用语法的使用表明可能存在区别。

# objective-c - 在objective-c / Cocoa中什么描述了“出口”最好？

> ID：596382
> 
> 赞同：14
> 
> 时间：2009-02-27T20:01:09.613
> 
> 标签：objective-c, cocoa, interface-builder

有人可以以人类可以理解的方式解释什么是“出口”吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-27T20:13:53.543

它是一个显示在 Interface Builder 中的实例变量，因此您可以使用 IB 将另一个对象插入到插座中。

当您加载笔尖时，笔尖加载系统将发挥必要的作用，以确保正确的对象出现在每个插座中。

编辑：我打算围绕这张图片写一篇完整的博客文章（完成图片后我改变了主意），但即使是单独的，它也应该有助于澄清人们的出路。干得好：

[![出口关系。](https://i.stack.imgur.com/omM5Z.png)](https://i.stack.imgur.com/omM5Z.png)
[（来源：[boredzo.org](http://boredzo.org/images/The-outlet-relationship-small.png)）]

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-28T14:29:32.397

从代码的角度来看，IBOutlet 只是对 Interface Builder 的*提示*。它实际上是一个编译成的宏，嗯，什么都没有。即编译器在编译时完全删除。

但是 Interface Builder 可以扫描您的代码以查找 IBOutlet，因此当您右键单击 IB 中的对象时，您可以看到可以连接到其他对象的所有插座。

[替代文字 http://img27.imageshack.us/img27/5512/picture820090228.png](http://img27.imageshack.us/img27/5512/picture820090228.png)

在这个例子中，**delegate**是 UIApplication 的成员变量，也是一个 IBOutlet。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-27T20:24:39.057

我只是认为它是一个指向 UI 控件的指针。一旦我在脑海中建立了这种心理联系，它就变得有意义了。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-27T20:07:44.230

我会说它们是将您的用户界面对象连接到使用它们的代码的桥梁。顾名思义，它们提供了一个将用户界面“插入”到代码中的位置。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-08-25T05:47:56.207

IBOutlet 关键字定义如下：

```
#ifndef IBOutlet
#define IBOutlet
#endif 
```

就编译器而言，IBOutlet 完全没有做任何事情。它的唯一目的是作为一个提示，告诉 Interface Builder 这是一个实例变量，我们将连接到 nib 中的对象。您创建并希望连接到 nib 文件中的对象的任何实例变量必须以 IBOutlet 关键字开头。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-27T22:14:33.830

`IBOutlet`是一个符号，向 Interface Builder 指示对象实例变量定义为

```
IBOutlet id ivar_name; 
```

应该作为关联类的实例的出口来呈现。这允许您在 Interface Builder 中以图形方式连接对象，以便在加载 NIB 后（即，当向对象发送`-awakeFromNib`消息时），ivar_name 的值将是指向您在 Interface Builder 中选择作为出口值的对象的指针。

从 Objective-C 语言的角度来看，`IBOutlet`没有任何意义。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-01-20T07:01:56.370

出口是您的代码（在 X 代码中）中的一个实例变量，可以为它分配对用户界面对象的引用（在 Interface Builder 中）。您将用户界面对象插入到实例变量中。分配在 Interface Builder 创建的 NIB 文件中指定。

# asynchronous - 非实时游戏的基于异步 TCP 的良好协议？

> ID：596389
> 
> 赞同：2
> 
> 时间：2009-02-27T20:02:52.447
> 
> 标签：asynchronous, networking, tcp, cross-platform

我正在为非实时多人聊天/游戏系统开发开源跨平台平台。像纸牌游戏、棋盘游戏、回合制游戏等。服务器是在服务器端生成的（不是从用户计算机生成的）。客户端有这些游戏模块或下载游戏模块然后运行它们。

我得出的结论是，最好的协议是“类似 IRC”的。这样就有了聊天和游戏的渠道。

例如有频道

*   大堂
*   大厅.English
*   大堂.芬兰语
*   Lobby.Mygame - 聊天一个特定的游戏
*   大厅.Mygame.English
*   Game.Server.Announcements - 创建新服务器时，服务器会在此处大喊。所有的客户都在听这个。您可以获得所有正在运行的游戏服务器的列表。
*   Game.3636534.chat - 特殊的游戏聊天
*   Game.3636534.game - 用户在此处发送购买 X 等命令，服务器对其作出响应

我调查过的一些东西

*   XMLRPC 不好，因为您必须每隔几秒轮询一次新数据
*   ICE - 相当不错，但应该对 RPC 更友好一些
*   ActiveMQ/RabbitMQ 和它的发布者/消费者系统是我正在寻找的东西。问题是缺少良好的用户 ACL。所以基本上每个人都可以“去”任何地方，将任何垃圾发送到主 AMQ 服务器。

为此支持的编程语言至少应为 C#、Java 和 Python。加密支持也应该在那里。当然是免费的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T21:42:25.220

您应该研究 XMPP，它是异步消息传递的开放标准。它支持加密、防火墙穿越等。服务器和库可用于许多平台，包括您提到的平台。

实现和信息的链接：http: [//xmpp.org/](http://xmpp.org/)

# xml - 在 xml 列上加入表

> ID：596406
> 
> 赞同：2
> 
> 时间：2009-02-27T20:05:22.410
> 
> 标签：xml, sql-server-2005

我在 Sql Server 2005 数据库上有如下 2 个表

```
Request(RequestId int, Filter xml)
DataTable(Id int,.....) 
```

过滤器列具有来自数据表的 id 列表作为 xml，例如 1013

现在我想从 DataTable 中选择与过滤器 xml 中的 id 匹配的数据。这是我想出的

```
select d.*
   from request 
   cross apply filter.nodes('Ids/Id') as Ids(id)
   inner join DataTable d on d.id = Ids.Id.value('.', 'int')
   where requestid = 35 
```

这可行，但我想知道这是否是最好的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-01T12:01:05.303

这就是我进行类似连接的方式（从 xml 参数到表）......如果有帮助的话。

它干净易懂

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-11T21:43:18.863

这是我能够从具有 xml 列的表的多行中提取连接的唯一方法。我使用的另一种方法是使用 CTE 并使用 CTE 的交叉应用将整个结果集组合到单个 XML 列中。上面的例子是：

```
WITH tmpCTE AS
(
    SELECT
        (
            SELECT
                r.RequestID AS [requestid]
            ,   r.Filter.query('//id') AS [id]
           FROM Request AS r
           FOR XML PATH('request'), TYPE, ROOT('root')
        ) AS tmpXML
)
SELECT d.*
FROM
    tmpCTE AS tmp
    CROSS APPLY tmpXML.nodes('Ids/Id') as Ids(id)
    INNER JOIN DataTable AS d on d.id = Ids.Id.value('.', 'int')
WHERE
    requestid = 35
; 
```

这有点多余，但我认为将整个结果集分解为 XML 然后将其分解为列是有价值的；特别是跨多行。

# c++ - 简单的 C++ 线程

> ID：596411
> 
> 赞同：9
> 
> 时间：2009-02-27T20:05:53.593
> 
> 标签：c++, multithreading, winapi

我正在尝试在 C++ (Win32) 中创建一个线程来运行一个简单的方法。我是 C++ 线程的新手，但对 C# 中的线程非常熟悉。这是我正在尝试做的一些伪代码：

```
static void MyMethod(int data)
{
    RunStuff(data);
}

void RunStuff(int data)
{
    //long running operation here
} 
```

我想从*MyMethod调用**RunStuff*而不会阻塞。在单独的线程上运行*RunStuff*的最简单方法是什么？

 ****编辑：**我还应该提到我想将依赖关系保持在最低限度。（没有 MFC ......等）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-27T20:09:01.497

```
#include <boost/thread.hpp>

static boost::thread runStuffThread;

static void MyMethod(int data)
{
    runStuffThread = boost::thread(boost::bind(RunStuff, data));
}

// elsewhere...
runStuffThread.join(); //blocks 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-10-01T02:39:58.333

C++11 可用于更新的编译器（例如 Visual Studio 2013），将线程作为语言的一部分，以及许多其他不错的部分，例如 lambda。

包含文件`threads`提供了线程类，它是一组模板。线程功能位于`std::`命名空间中。一些线程同步函数`std::this_thread`用作命名空间（有关解释，请参阅[为什么使用 std::this_thread 命名空间？](https://stackoverflow.com/questions/15032692/why-the-stdthis-thread-namespace)）。

以下使用 Visual Studio 2013 的控制台应用程序示例演示了 C++11 的一些线程功能，包括 lambda 的使用（请参阅[什么是 C++11 中的 lambda 表达式？](https://stackoverflow.com/questions/7627098/what-is-a-lambda-expression-in-c11)）。请注意，用于线程睡眠的函数，例如`std::this_thread::sleep_for()`，使用持续时间来自`std::chrono`。

```
// threading.cpp : Defines the entry point for the console application.
//

#include "stdafx.h"
#include <iostream>
#include <chrono>
#include <thread>
#include <mutex>

int funThread(const char *pName, const int nTimes, std::mutex *myMutex)
{
    // loop the specified number of times each time waiting a second.
    // we are using this mutex, which is shared by the threads to
    // synchronize and allow only one thread at a time to to output.
    for (int i = 0; i < nTimes; i++) {
        myMutex->lock();
        std::cout << "thread " << pName << " i = " << i << std::endl;
        // delay this thread that is running for a second.  
        // the this_thread construct allows us access to several different
        // functions such as sleep_for() and yield().  we do the sleep
        // before doing the unlock() to demo how the lock/unlock works.
        std::this_thread::sleep_for(std::chrono::seconds(1));
        myMutex->unlock();
        std::this_thread::yield();
    }

    return 0;
}

int _tmain(int argc, _TCHAR* argv[])
{
    // create a mutex which we are going to use to synchronize output
    // between the two threads.
    std::mutex  myMutex;

    // create and start two threads each with a different name and a
    // different number of iterations. we provide the mutex we are using
    // to synchronize the two threads.
    std::thread myThread1(funThread, "one", 5, &myMutex);
    std::thread myThread2(funThread, "two", 15, &myMutex);

    // wait for our two threads to finish.
    myThread1.join();
    myThread2.join();

    auto  fun = [](int x) {for (int i = 0; i < x; i++) { std::cout << "lambda thread " << i << std::endl; std::this_thread::sleep_for(std::chrono::seconds(1)); } };

    // create a thread from the lambda above requesting three iterations.
    std::thread  xThread(fun, 3);
    xThread.join();
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-27T20:11:47.013

[CreateThread (Win32)](http://msdn.microsoft.com/en-us/library/ms682453.aspx)和[AfxBeginThread (MFC)](http://msdn.microsoft.com/en-us/library/s3w9x78e.aspx)是执行此操作的两种方法。

无论哪种方式，您的 MyMethod 签名都需要稍作更改。

**编辑：**正如评论和其他受访者所指出的，CreateThread 可能很糟糕。

[_beginthread 和 _beginthreadex](http://msdn.microsoft.com/en-us/library/kdzttdcb.aspx)是 C 运行时库函数，根据文档相当于[System::Threading::Thread::Start](http://msdn.microsoft.com/en-us/library/system.threading.thread.start.aspx)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-27T23:27:31.753

考虑使用 Win32 线程池而不是为工作项启动新线程。启动新线程是浪费 - 每个线程默认为其堆栈保留 1 MB 的保留地址空间，运行系统的线程启动代码，导致通知传递到进程中的几乎每个 DLL，并创建另一个内核对象。线程池使您能够快速有效地为后台任务重用线程，并且会根据您提交的任务数量而增长或缩小。一般来说，考虑为永无止境的后台任务启动专用线程，并将线程池用于其他所有任务。

在 Vista 之前，您可以使用 QueueUserWorkItem。在 Vista 上，新的线程池 API 更可靠，并提供了一些更高级的选项。每个都会导致您的后台代码开始在某个线程池线程上运行。

```
// Vista
VOID CALLBACK MyWorkerFunction(PTP_CALLBACK_INSTANCE instance, PVOID context);

// Returns true on success.
TrySubmitThreadpoolCallback(MyWorkerFunction, context, NULL);

// Pre-Vista
DWORD WINAPI MyWorkerFunction(PVOID context);

// Returns true on success
QueueUserWorkItem(MyWorkerFunction, context, WT_EXECUTEDEFAULT); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-27T20:08:06.210

C ++中的简单线程在术语上是矛盾的！

查看 boost 线程，了解与当今可用的简单方法最接近的方法。

对于一个最小的答案（它实际上不会为您提供同步所需的所有东西，而是从字面上回答您的问题）请参阅：

[http://msdn.microsoft.com/en-us/library/kdzttdcb(VS.80).aspx](http://msdn.microsoft.com/en-us/library/kdzttdcb(VS.80).aspx)

`static`在 C++ 中也意味着不同的东西。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-27T20:18:26.170

这安全吗：

```
unsigned __stdcall myThread(void *ArgList) {
//Do stuff here
}

_beginthread(myThread, 0, &data); 
```

在此调用之后，我是否需要做任何事情来释放内存（如 CloseHandle）？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-16T19:55:23.757

另一种选择是[pthreads](http://sourceware.org/pthreads-win32/) - 它们适用于 windows 和 linux！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-27T20:14:13.090

> CreateThread (Win32) 和 AfxBeginThread (MFC) 是执行此操作的两种方法。

如果您需要使用 C 运行时库 (CRT)，请小心使用 _beginthread。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-27T20:14:56.083

仅适用于 win32 且无需其他库，您可以使用 CreateThread 函数 [http://msdn.microsoft.com/en-us/library/ms682453(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms682453(VS.85).aspx)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-27T20:15:07.707

如果您真的不想使用第三方库（我会推荐 boost::thread 如其他 anwsers 中所述），您需要使用 Win32API：

```
static void MyMethod(int data)
{

    int data = 3;

    HANDLE hThread = ::CreateThread(NULL,
        0,
        &RunStuff,
        reinterpret_cast<LPVOID>(data),
        0,
        NULL);

    // you can do whatever you want here

    ::WaitForSingleObject(hThread, INFINITE);
    ::CloseHandle(hThread);
}

static DWORD WINAPI RunStuff(LPVOID param)
{  

     int data = reinterpret_cast<int>(param);

     //long running operation here

     return 0;
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-27T20:25:31.427

存在许多可以使用的开源跨平台 C++ 线程库：

其中有：

Qt
Intel
TBB Boost 线程

您描述它的方式，我认为英特尔 TBB 或 Boost 线程都可以。

英特尔 TBB 示例：

```
class RunStuff
{
public:
  // TBB mandates that you supply () operator  
  void operator ()()
  {
    // long running operation here
  }
};

// Here's sample code to instantiate it
#include <tbb/tbb_thread.h> 

tbb::tbb_thread my_thread(RunStuff); 
```

提升线程示例：
[http ://www.ddj.com/cpp/211600441](http://www.ddj.com/cpp/211600441)

Qt 示例：
[http ://doc.trolltech.com/4.4/threads-waitconditions-waitconditions-cpp.html](http://doc.trolltech.com/4.4/threads-waitconditions-waitconditions-cpp.html)
*（我认为这不适合您的需求，但只是为了完整性而包含在此处；您必须继承 QThread，实现 void run( )，并调用 QThread::start())：*

如果你只在 Windows 上编程而不关心跨平台，也许你可以直接使用 Windows 线程：http:
[//www.codersource.net/win32_multithreading.html](http://www.codersource.net/win32_multithreading.html)

# c# - 尝试读取或写入受保护的内存

> ID：596413
> 
> 赞同：40
> 
> 时间：2009-02-27T20:07:08.973
> 
> 标签：c#, .net, access-violation, servicepacks

我已经开始在我的应用程序的几个不同位置看到一个 AccessViolationException。它从未发生在我的开发电脑，我们的测试服务器上。它也只出现在我们的 2 台生产服务器中的 1 台上。因为它似乎只发生在我们的一台生产服务器上，所以我开始查看服务器上安装的 .net 框架版本。

我发现（出于某种奇怪的原因），有问题的生产服务器有 2.0 sp2、3.0 sp2 和 3.5 sp1，而另一台生产服务器和测试服务器有 2.0 sp1。

我的应用程序仅针对 2.0 框架，决定从生产服务器卸载所有框架版本并仅安装 2.0 sp1。到目前为止，我还无法重现该问题。很有意思。

Development pc: compact 2.0 sp2, compact 3.5, 2.0 sp2, 3.0 sp2, 3.5 sp1 Test server: 2.0 sp1 Production server1: 2.0 sp1 Production server2: 2.0 sp2, 3.0 sp2, 3.5 sp1

现在，为什么我不能重现这个问题我的开发电脑上面有 2.0 sp2，我不知道。我听说这种访问冲突可能发生在某些使用远程处理的软件上，我的就是这样做的，但是当远程处理实际发生时，访问冲突从未发生过。我现在只使用 2.0 sp1 没问题，但我真的很想知道是否有人遇到过这个问题，以及他们是否找到了新版本框架的解决方法。

以下是一些异常及其堆栈跟踪：

```
System.AccessViolationException: Attempted to read or write protected memory. This is often an indication that other memory is corrupt.
   at ICSharpCode.TextEditor.TextArea.HandleKeyPress(Char ch)
   at ICSharpCode.TextEditor.TextArea.SimulateKeyPress(Char ch)
   at ICSharpCode.TextEditor.TextArea.OnKeyPress(KeyPressEventArgs e)
   at System.Windows.Forms.Control.ProcessKeyEventArgs(Message& m)
   at System.Windows.Forms.Control.ProcessKeyMessage(Message& m)
   at System.Windows.Forms.Control.WmKeyChar(Message& m)
   at System.Windows.Forms.Control.WndProc(Message& m)
   at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message& m)
   at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m)
   at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)

System.AccessViolationException: Attempted to read or write protected memory. This is often an indication that other memory is corrupt.
   at System.Windows.Forms.UnsafeNativeMethods.CallWindowProc(IntPtr wndProc, IntPtr hWnd, Int32 msg, IntPtr wParam, IntPtr lParam)
   at System.Windows.Forms.NativeWindow.DefWndProc(Message& m)
   at System.Windows.Forms.Control.DefWndProc(Message& m)
   at System.Windows.Forms.Control.WndProc(Message& m)
   at System.Windows.Forms.TextBoxBase.WndProc(Message& m)
   at System.Windows.Forms.RichTextBox.WndProc(Message& m)
   at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message& m)
   at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m)
   at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam) 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-12-10T10:38:56.527

从 .NET 4.5 升级到 .NET 4.5.1 后，我遇到了同样的问题。为我解决的问题是运行以下命令：

`netsh winsock reset`

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2010-06-09T11:44:20.560

我有同样的问题。2.0 运行良好。安装到 3.5 sp1 后，应用程序会出现访问冲突。

安装了[http://support.microsoft.com/kb/971030](http://support.microsoft.com/kb/971030)并解决了我的问题，即使我没有使用 LCG。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-17T23:08:50.700

Microsoft 还发布了一个修补程序（2007 年 7 月 2 日），以防止已经困扰 .NET 2.0 平台一段时间的错误“尝试读取或写入受保护的内存”。查看[http://support.microsoft.com/kb/923028](http://support.microsoft.com/kb/923028) - 不确定它是否适用于您，但认为您可能想检查一下。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-12-30T22:40:58.400

对于 VS 2013，[.NET Framework 4.5.1`AccessViolationException`](https://support.microsoft.com/kb/2915689?wa=wsignin1.0)在处理 SQL Server / TCP 套接字时也有一个[错误(KB2915689)。](https://support.microsoft.com/kb/2915689?wa=wsignin1.0)升级到[.NET Framework 4.5.2](http://www.microsoft.com/en-us/download/details.aspx?id=42637)可以解决此问题。

### 报告 VS.NET AccessViolationException

> 尝试读取或写入受保护的内存。这通常表明其他内存已损坏。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-02-14T17:21:11.493

我正在使用 OLEDB 并切换到 SQL 客户端，它解决了我的这个错误问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-03T20:03:27.647

在某些 WinForms 上调用“显示”方法时，我通常会得到“尝试读取或写入受保护的内存”。我检查了这些表格并没有什么特别之处。我不知道为什么会这样（也许有人可以告诉我），但通常将在表单的“Load”事件中执行的代码移动到“Shown”事件会为我修复它，我再也看不到它了。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-08-08T17:27:42.910

检查以确保线程中没有线程。这就是导致我这个错误的原因。请参阅此链接：[尝试读取或写入受保护的内存。这通常表明其他内存已损坏](https://stackoverflow.com/questions/9982692/attempted-to-read-or-write-protected-memory-this-is-often-an-indication-that-ot/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-02-18T23:31:36.733

在某些情况下，在 VB.NET 中添加“Option Strict On”并通过正确的转换解决它发现的所有问题已经为我解决了这个问题。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-10-20T06:29:46.903

您好 有两个可能的原因。

1.  我们有非托管代码，我们从托管代码中调用它。那是阻止运行此代码。尝试运行这些命令并重新启动您的电脑

    cmd: netsh winsock 重置

打开`cmd.exe`并运行命令`"netsh winsock reset catalog"`

2.  防病毒软件将非托管代码视为有害并限制运行此代码 **禁用防病毒软件**，然后检查

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-06-10T10:40:37.740

就我而言，当我为 IIS 服务器中的应用程序池设置“启用 32 位应用程序”=True 时，此问题已得到解决。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-02-22T04:05:15.950

问题可能是由于项目中的混合构建平台 DLL。即，您将项目构建到任何 CPU，但在项目中已经为 x86 平台构建了一些 DLL。由于 32 位和 64 位架构的不同内存映射，这些将导致随机崩溃。如果所有的 DLL 都是为一个平台构建的，那么问题就可以解决。为安全起见，请尝试使用 32 位 x86 架构进行构建，因为它是最兼容的。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-10-06T09:32:18.750

在我的情况下，系统中未安装共享库之一中使用的字体。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-02-21T21:25:40.347

在我的情况下，我在添加对我的 COM DLL 的引用时遇到了“环境变量”的问题。

当我添加对我的项目的引用时，我正在寻找**P:\Core**路径，而我过去已将**c:\core**路径添加到路径环境变量中。

所以我的代码首先尝试了错误的路径。我删除了它并取消注册了 DLL 引用并使用 (regsvr32) 重新注册了我的 DLL 引用。希望这可以帮助。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-03-26T08:19:52.633

在创建导致此问题的新项目时，我忘记添加 EntityFramework。

# c# - Visual Studio 可以将项目引用编译到不同的文件夹然后是主 .exe

> ID：596416
> 
> 赞同：11
> 
> 时间：2009-02-27T20:07:39.643
> 
> 标签：c#, build

我有一个 WPF 应用程序项目，在 VS 2008 的单个解决方案中包含多个项目引用。当我编译我的解决方案时，所有引用的 dll 都输出到主 .exe 输出到的同一文件夹中。

是否可以将我的主 .exe 项目构建配置为输出相对于我的 .exe 的子文件夹中的所有引用？

我希望最终结果是这样的：

MyApp.exe MyApp.exe.config Lib\SomeReference.dll Lib\SomeReference2.dll

（我假设如果这是可能的，那么任何 .exe 都可以）。

谢谢！乔恩

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-27T20:24:39.010

看起来这是一个相当密集的过程。

首先将引用的 Copy Local 属性设置为 false，以便 .dll 不会复制到 bin\Debug 文件夹。

然后在 app.config 中创建一个[assemblyBinding\probing](http://msdn.microsoft.com/en-us/library/823z9h8w.aspx)元素，以指示运行时在 Lib 文件夹中查找 dll

然后创建一个构建后操作以将必要的 dll 复制到 \bin\Debug\Lib 文件夹。

# extreme-programming - 工作面试的结对编程

> ID：596426
> 
> 赞同：41
> 
> 时间：2009-02-27T20:09:00.357
> 
> 标签：extreme-programming, pair-programming

我们公司一直在考虑取消我们的面试程序，让每个候选人与一些程序员坐下来 4-5 小时，然后做一些结对编程。

我在理论上喜欢这个想法，但我不确定如何才能真正让每个候选人都公平。你如何评价他们？他们的输入真的不取决于每个程序员那天的工作吗？

关于这是一个好主意/坏主意或如何使其发挥作用的任何想法都是我在这里寻找的。

干杯!

**编辑：**

结果 - 按要求

我们将像以前一样进行面试的第一步。电话后是面对面。我们不会让他们回来进行第三次也是最后一次烧烤，而是让 3 名开发人员回来与团队的所有 7 名成员坐在一起。我们决定让团队决定随后雇用谁。

我们得出这个结论有几个原因。我们相信这将赋予开发人员权力，让他们可以选择他们的工作对象。第二个原因是群体动态。我们认为拥有良好的团队动态非常重要，而且在您雇用一个人之前很难判断他们是否适合。

所以最终的结果是我们将继续进行结对编程课程，但以完全不同的方式和完全不同于最初预期的方式。

任何对这种方法的想法或批评都非常受欢迎！！（此编辑在下面发布为答案，因此如果您认为这不是最佳方法，请随时投反对票）

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-02-27T20:14:25.307

除非您在实际开发中广泛使用结对编程，否则我会非常犹豫是否使用它。我遇到过许多高质量的专业开发人员，他们提到了对结对编程的强烈反感，并且在这样的过程中他们的技能不会得到很好的评价。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-27T20:12:20.507

我希望你在这一步之前有很多步骤。为此，您需要出色的简历和电话屏幕。你不想在你一开始就不应该与之交谈的候选人身上花费大量时间。

> 因此，您建议进行初次面试，并可能将第二次面试作为结对编程会议？– 泰德·史密斯（1 分钟前）

是的。[您甚至可能会想到使用CoPilot](https://www.copilot.com/)之类的东西在网络上进行简单的编码面试。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-02-27T20:12:38.460

最简单的方法是为每个人提供相同的程序员和完全相同的代码。

你会遇到的问题是招聘不像编程。没有一个循序渐进的过程可以得出关于雇用谁的正确答案。（您可以采取多个步骤来简化决策）。您必须评估每个人的优势等，并从根本上做出有根据的猜测，以确定哪个是最好的雇用。有时你猜错了。

关于结对编程，你需要注意的另一件事是让每个候选人在那个阶段通过这种测试所需的时间。如果我正在找工作，我会犹豫是否去一家要求我这样做的公司面试。为什么？因为那是很多时间，如果我在多个地方面试，我可以花几天时间去面试我什至可能得不到或想要的工作。像 Google 或 MS 这样的地方是个例外，但大多数地方都不像这两个。（更不用说如果他们正在编写真正的代码，您实际上是在要求他们免费完成某人的工作）。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-02-27T20:31:50.817

作为个人轶事，我在一次采访中因为这样的技巧而被打脸。我在他们的面试过程中走得很远；通过了简历检查，代码提交，这是面试的面对面部分。

我刚从大学毕业，以前从未结对编程，也没有做过 TDD。他们让我坐下来做一副纸牌练习，结果失败了。糟糕！我不明白为什么面试官要编写看起来如此愚蠢的测试*（即“返回 null；”），他们没有解释为什么，当然我不知道要问什么问题。最终结果是，看起来我无法从纸袋中编程出来。

如果你要做这种类型的练习，你需要迎合被采访者，因为他们将在不同的地方以他们的能力。这意味着你会得到不同的评估，这些评估可能不是基于实际人才，因此会有很大的偏见。

**现在我了解了 TDD，我确实了解了这样的测试以及它应该如何工作，但是在当时，这似乎很愚蠢！*

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-06-29T20:04:19.703

我刚刚接受了一家总部位于旧金山的公司的采访，该公司以敏捷方法/等为荣。我要去采访CEO本人。我有大约 20 年的行业经验，但从未使用 TDD 方法进行结对编程或开发。有人告诉我这将是一次“编程面试”，但不知道会发生什么，在我们开始之前，那个人说他认为我可能同意所有面试都应该以这种方式进行。（回想起来，这不过是一种傲慢的说法）。

无论如何，在面试中，练习是使用 TDD 开发一个类。我花了一秒钟来调整我对整个过程的想法，因为我从未结对编程或做过 TDD。虽然我在这里和那里跌跌撞撞，但最后我做得还不错。但他的回答是，我没有表现出他们在结对编程环境中所需的积极的来回性质。现在，这也可能是一种卑鄙的方式来表达“我不认为你做得很好”之类的信息。

幸运的是，我不需要这份工作，老实说，这段经历让我意识到，我宁愿找一份不同的职业，也不愿成为一名必须结对工作的软件工程师，日复一日，在开发方面代码。奇怪的是，有时我会同时与另一个人一起编写代码，所以一切皆有可能。

最后我想这是一个很好的结果，因为他们认为我不合适，我也不关心他们的工作方法。但是，如果我多谈了几分钟关于我自己的事情，如果他给我更多关于他们如何开展工作的信息，我们就会得出同样的结论。也就是说，除了让他们承受与完全陌生的人结对编程的压力之外，还有其他方法可以找到合适的候选人；虚假的方式来衡量海事组织的能力。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-05-17T21:58:34.427

一家特定的公司使用一种称为**极端面试**的技术。对于极限面试，他们会带上 30 名开发人员，并将他们分成 15 对。他们会解释说他们正在寻找与他人合作良好的人。他们将仅根据与他人合作的能力来做出招聘决定。

他们将为配对解决问题。他们会强调他们对解决方案不感兴趣，只是每个程序员与他人合作的能力。对于每一对，他们将提供该对的观察者。在练习过程中（大约持续 2 到 4 小时），观察者将记录一个人的配对能力……而不是解决方案。

他们惊讶于有多少程序员专注于解决问题而不是协作。在这 15 对中，他们将确定大约 4 到 6 名开发人员进行第二次面试。这些开发人员将被要求回来并与团队一起度过一个星期（他们得到报酬）。一周后，他们决定留下谁。一般大约有一半（2 到 3 个开发人员）。

当他们完成后，他们有能够协作的开发人员，并且在与各种配对工作一周后，团队有一个强有力的迹象表明谁可以有效地开发软件。这个过程既创新又有效。他们与他们雇用的人取得了很高的成功率。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2011-11-03T22:14:11.593

几天前我刚刚接受了一次结对编程面试，老实说，我不太喜欢它。我在面试前一天收到了通知，然后面试官告诉我结对编程是我最终在工作中要做的事情。我走进办公室，与一位非常资深的软件工程师配对。该公司位于旧金山，是一家以结对编程而闻名的公司，每个人都在办公室结对编程。起初看起来还不错，他解释了他们使用的所有工具、他们构建的自己的单元测试框架以及项目的一些内容。然后他基本上写了一堆单元测试，并希望我致力于实现以使其通过。仅供参考，已经存在的代码库是巨大的，我会说 10k 行，它' 不像一个超级复杂的项目，但是对于一个人来说，在没有事先了解类层次结构等的情况下介入然后编写代码是很复杂的。我发现很难相信他期望有人马上跳进 10k 行已经存在的源代码。它只是不适合结对编程面试，较小的代码库会有所帮助。我在浏览类和来回移动时有点挣扎，因为我不记得类名，因为我被已经存在的类/代码的数量所淹没。说实话，这真的让我在面试过程中做得很糟糕。最后我真的感觉不太好。我以前没有做过结对编程，主要是在我大学那年的作业中。但是对于一个人来说，在没有事先了解类层次结构等的情况下介入然后编写代码是很复杂的。我发现很难相信他希望有人立即跳入已经存在的 10k 行源代码中。它只是不适合结对编程面试，较小的代码库会有所帮助。我在浏览类和来回移动时有点挣扎，因为我不记得类名，因为我被已经存在的类/代码的数量所淹没。说实话，这真的让我在面试过程中做得很糟糕。最后我真的感觉不太好。我以前没有做过结对编程，主要是在我大学那年的作业中。但是对于一个人来说，在没有事先了解类层次结构等的情况下介入然后编写代码是很复杂的。我发现很难相信他希望有人立即跳入已经存在的 10k 行源代码中。它只是不适合结对编程面试，较小的代码库会有所帮助。我在浏览类和来回移动时有点挣扎，因为我不记得类名，因为我被已经存在的类/代码的数量所淹没。说实话，这真的让我在面试过程中做得很糟糕。最后我真的感觉不太好。我以前没有做过结对编程，主要是在我大学那年的作业中。我很难相信他会期望有人立即跳入已经存在的 10k 行源代码中。它只是不适合结对编程面试，较小的代码库会有所帮助。我在浏览类和来回移动时有点挣扎，因为我不记得类名，因为我被已经存在的类/代码的数量所淹没。说实话，这真的让我在面试过程中做得很糟糕。最后我真的感觉不太好。我以前没有做过结对编程，主要是在我大学那年的作业中。我很难相信他会期望有人立即跳入已经存在的 10k 行源代码中。它只是不适合结对编程面试，较小的代码库会有所帮助。我在浏览类和来回移动时有点挣扎，因为我不记得类名，因为我被已经存在的类/代码的数量所淹没。说实话，这真的让我在面试过程中做得很糟糕。最后我真的感觉不太好。我以前没有做过结对编程，主要是在我大学那年的作业中。我在浏览类和来回移动时有点挣扎，因为我不记得类名，因为我被已经存在的类/代码的数量所淹没。说实话，这真的让我在面试过程中做得很糟糕。最后我真的感觉不太好。我以前没有做过结对编程，主要是在我大学那年的作业中。我在浏览类和来回移动时有点挣扎，因为我不记得类名，因为我被已经存在的类/代码的数量所淹没。说实话，这真的让我在面试过程中做得很糟糕。最后我真的感觉不太好。我以前没有做过结对编程，主要是在我大学那年的作业中。

对我来说，如果您已经精通/熟悉您的配对，但并不真正适合面试，则可以利用配对编程的力量。有时我想问我的搭档，但后来我想如果我问太多问题，他们会认为我很愚蠢，不会表演。如果这已经是一份真正的工作，我会毫不犹豫地问，但在面试中很难..你想问是因为当你遇到困难时你的搭档应该帮助你，但同时它也是一次面试，所以你不能问太多。

这只是我从结对编程面试中获得的经验，如果您真的想这样做，我的建议是：

1.  确保你不要让候选人使用大型代码库，使用较小的代码库，因此他/她可以最大限度地展示他/她的技能
2.  在结对编程面试之前与候选人面对面，当你遇到困难时，你能问问题吗，你能做到这个那个，你不能做什么
3.  尽可能详细

最后，我不会建议它。很难衡量候选人在结对编程中的表现，而且也可能存在偏见。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-27T20:15:12.417

我喜欢这个主意。但是我认为这可能很难做到，因为这需要候选人对你将与他配对的项目有一些了解。另外，4到5个小时似乎有点长。如果您立即发现它不会奏效，您是否会与候选人一起坐在整个会话中？

不过是个好问题。要考虑的东西。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-27T20:14:27.317

为什么不？此外，面试并不总是（或永远）公平。您应该对照传统的基于面试的方法评估新方法的最终结果。

此外，在结对编程会议之前进行一次小型采访可能会很好地避免将程序员的时间浪费在不适合的人身上。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-04-10T00:29:48.603

从我有限的经验来看，我的感受是复杂的。我喜欢将配对作为面试的一部分的想法，尤其是。如果公司经常使用配对，因为它会给两者带来更好的合身感。作为一名应聘者，我经常参加面试，我会在一个房间里回答几个小时的问题，但之后对在他们的环境中工作的真正感觉并没有很好的感觉。配对可能比随机编码练习更有益，除非面试官擅长通过这些练习。我喜欢能够从双方讨论技术问题。作为候选人，我宁愿与某人互动，也不愿自己回答问题或解决代码问题。

但是......正如其他人所指出的，所需的时间可能是一个问题。我经历了几天的配对面试，发现有些时间很好，而另一些则觉得浪费了几个小时：一个是因为开发人员没有在做适合配对的事情（尤其是考虑到我的背景），另一个是因为环境问题暂时阻止了很多有用的工作。如果工作不成功，为此请一两天假可能会令人沮丧。

尝试这种方法的一个地方不确定他们是否应该让公司以外的人从事客户的项目。他们还担心解释领域和正在完成的工作会花费太长时间，尽管没有这一点，候选人可能无法做出太多贡献。所以他们选择了员工正在从事的开源项目。

这似乎是一个关键点：**需要有一个精心挑选的任务，候选人可以快速理解并能够做出贡献。**后一部分将在一定程度上取决于候选人的技能。同样关键的是员工使用这种方法评估某人的能力。不是每个人都擅长正常的面试，配对面试可能更是如此。

此外，如果一家公司没有做太多的配对，那么这种面试可能就没有那么有用了。看到某人的代码似乎确实有好处（正如 Joel Spolsky 指出的那样），这可能是一个很好的方法。但是，如果配对不是工作的典型部分，那么完整的配对会话可能是不合适的。可能是修改版。

我很好奇采用这种方法的公司对结果的看法。阅读此问题的其他一些答案表明，从候选人的角度来看，它并不总是理想的。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-27T20:16:15.940

为了公平起见，你必须让每个参与的工作人员都有一个准备好的问题来评估候选人。最好是在他们的公司经验中取材于现实世界，但已经解决了。这是一个评估问题知识的好机会，而不仅仅是评估编程技能。

我讨厌回答太具体的问题。有一次我有一次面试，一位程序员正在测试我对我广泛使用的 STL 的了解，并试图让我回答需要自定义分配器。我听说过它们，但从未使用过它们（尤其是在 Windows 中）并且感觉很愚蠢。IOW，避免评判。

所以我的观点是，问一些与测试编程知识无关的实际问题，如果你使用“结对编程”的想法，你可以评估更多的定性个性和解决问题的方法。

好问题！

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-27T20:17:15.813

老实说，这听起来是个好主意，尽管 Jason Punyon 确实是正确的，您应该在将大量开发人员的时间浪费在剔除之前进行大量除草。你可以从中看到一个在面试中几乎无法获得的重要指标：某人喜欢与什么一起工作。

如果你保持正确的评估态度，我认为没有必要担心基于主题的“公平”或试图向不同的候选人呈现一致的情况——这与他们是否“得到了正确的答案”或跳过了正确的圈套，但他们表现出什么样的努力、解决问题的能力、沟通能力和灵活性。如果将其变成人工测试，您将失去该练习的大部分好处，更不用说将其从您的开发人员可以从中获得一些好处（或至少在此期间完成一些工作）更改为大量浪费他们的时间。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-27T20:17:29.930

Joel Spolsky 有一本出色的[Guerrilla Guide to Interviewing](http://joelonsoftware.com/articles/GuerrillaInterviewing3.html)，其中谈到了编程任务等。

琐事：Joel Spolsky 是 stackoverflow.com 的联合创始人

# java - 在 JFileChooser 中将选定的文件调整为 FileFilter

> ID：596429
> 
> 赞同：14
> 
> 时间：2009-02-27T20:09:05.473
> 
> 标签：java, swing, jfilechooser

我正在用java编写一个图表编辑器。此应用程序可以选择导出为各种标准图像格式，例如 .jpg、.png 等。当用户单击 File->Export 时，您会看到`JFileChooser`其中包含多个`FileFilter`s 的 a，for`.jpg`等`.png`。

现在这是我的问题：

有没有办法让默认的扩展名调整为选定的文件过滤器？例如，如果文档名为“lolcat”，则在选择 png 过滤器时默认选项应为“lolcat.png”，当用户选择 jpg 文件过滤器时，默认选项应自动更改为“lolcat.jpg”。

这可能吗？我该怎么做？

编辑：根据下面的答案，我写了一些代码。但它还没有完全奏效。我在 中添加了一个`propertyChangeListener`，`FILE_FILTER_CHANGED_PROPERTY`但似乎在此方法中`getSelectedFile()`返回 null。这是代码。

```
package nl.helixsoft;

import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.beans.PropertyChangeEvent;
import java.beans.PropertyChangeListener;
import java.io.File;
import java.util.ArrayList;
import java.util.List;

import javax.swing.JButton;
import javax.swing.JFileChooser;
import javax.swing.JFrame;
import javax.swing.filechooser.FileFilter;

public class JFileChooserTest {
    public class SimpleFileFilter extends FileFilter {
        private String desc;
        private List<String> extensions;
        private boolean showDirectories;

        /**
         * @param name example: "Data files"
         * @param glob example: "*.txt|*.csv"
         */
        public SimpleFileFilter (String name, String globs) {
            extensions = new ArrayList<String>();
            for (String glob : globs.split("\\|")) {
                if (!glob.startsWith("*.")) 
                    throw new IllegalArgumentException("expected list of globs like \"*.txt|*.csv\"");
                // cut off "*"
                // store only lower case (make comparison case insensitive)
                extensions.add (glob.substring(1).toLowerCase());
            }
            desc = name + " (" + globs + ")";
        }

        public SimpleFileFilter(String name, String globs, boolean showDirectories) {
            this(name, globs);
            this.showDirectories = showDirectories;
        }

        @Override
        public boolean accept(File file) {
            if(showDirectories && file.isDirectory()) {
                return true;
            }
            String fileName = file.toString().toLowerCase();

            for (String extension : extensions) {   
                if (fileName.endsWith (extension)) {
                    return true;
                }
            }
            return false;
        }

        @Override
        public String getDescription() {
            return desc;
        }

        /**
         * @return includes '.'
         */
        public String getFirstExtension() {
            return extensions.get(0);
        }
    }

    void export() {
        String documentTitle = "lolcat";

        final JFileChooser jfc = new JFileChooser();
        jfc.setDialogTitle("Export");
        jfc.setDialogType(JFileChooser.SAVE_DIALOG);
        jfc.setSelectedFile(new File (documentTitle));
        jfc.addChoosableFileFilter(new SimpleFileFilter("JPEG", "*.jpg"));
        jfc.addChoosableFileFilter(new SimpleFileFilter("PNG", "*.png"));
        jfc.addPropertyChangeListener(JFileChooser.FILE_FILTER_CHANGED_PROPERTY, new PropertyChangeListener() {
            public void propertyChange(PropertyChangeEvent arg0) {
                System.out.println ("Property changed");
                String extold = null;
                String extnew = null;
                if (arg0.getOldValue() == null || !(arg0.getOldValue() instanceof SimpleFileFilter)) return;
                if (arg0.getNewValue() == null || !(arg0.getNewValue() instanceof SimpleFileFilter)) return;
                SimpleFileFilter oldValue = ((SimpleFileFilter)arg0.getOldValue());
                SimpleFileFilter newValue = ((SimpleFileFilter)arg0.getNewValue());
                extold = oldValue.getFirstExtension();
                extnew = newValue.getFirstExtension();
                String filename = "" + jfc.getSelectedFile();
                System.out.println ("file: " + filename + " old: " + extold + ", new: " + extnew);
                if (filename.endsWith(extold)) {
                    filename.replace(extold, extnew);
                } else {
                    filename += extnew;
                }
                jfc.setSelectedFile(new File (filename));
            }
        });
        jfc.showDialog(frame, "export");
    }

    JFrame frame;

    void run() {
        frame = new JFrame();
        JButton btn = new JButton ("export");
        frame.add (btn);
        btn.addActionListener (new ActionListener() {
            public void actionPerformed(ActionEvent ae) {
                export();
            }
        });
        frame.setSize (300, 300);
        frame.pack();
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        javax.swing.SwingUtilities.invokeLater(new Runnable() {     
            public void run() {
                JFileChooserTest x =  new JFileChooserTest();
                x.run();
            }
        });     
    }
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-27T20:41:58.343

看起来您可以收听属性`JFileChooser`的更改`FILE_FILTER_CHANGED_PROPERTY`，然后使用适当更改所选文件的扩展名`setSelectedFile()`。

* * *

编辑：你是对的，这个解决方案不起作用。事实证明，当文件过滤器更改时，如果所选文件的文件类型与新过滤器不匹配，则会将其删除。这就是为什么你在`null`尝试时得到的原因`getSelectedFile()`。

您是否考虑过稍后添加扩展程序？当我写. 时`JFileChooser`，我通常在用户选择要使用的文件并单击“保存”后添加扩展名：

```
if (result == JFileChooser.APPROVE_OPTION)
{
  File file = fileChooser.getSelectedFile();
  String path = file.getAbsolutePath();

  String extension = getExtensionForFilter(fileChooser.getFileFilter());

  if(!path.endsWith(extension))
  {
    file = new File(path + extension);
  }
} 
```

* * *

```
fileChooser.addPropertyChangeListener(JFileChooser.FILE_FILTER_CHANGED_PROPERTY, new PropertyChangeListener()
{
  public void propertyChange(PropertyChangeEvent evt)
  {
    FileFilter filter = (FileFilter)evt.getNewValue();

    String extension = getExtensionForFilter(filter); //write this method or some equivalent

    File selectedFile = fileChooser.getSelectedFile();
    String path = selectedFile.getAbsolutePath();
    path.substring(0, path.lastIndexOf("."));

    fileChooser.setSelectedFile(new File(path + extension));
  }
}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-11-25T10:45:38.780

这个怎么样：

```
class MyFileChooser extends JFileChooser {
   public void setFileFilter(FileFilter filter) {

    super.setFileFilter(filter);

    FileChooserUI ui = getUI();

    if( ui instanceof BasicFileChooserUI ) {
     BasicFileChooserUI bui = (BasicFileChooserUI) ui;

     String file = bui.getFileName();

     if( file != null ) {
      String newFileName = ... change extension 
      bui.setFileName( newFileName );
     }
    }
   }
  } 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-08-12T13:45:17.923

在附加后缀之前，您还可以在 SELECTED_FILE_CHANGED_PROPERTY 上使用 PropertyChangeListener。当对新筛选器检查所选文件（随后设置为NULL）时，所选_file_changed_property事件实际上是在file_filter_changed_property事件*之前*触发的。

如果 evt.getOldValue() != null 和 evt.getNewValue() == null，你知道 JFileChooser 已经炸毁了你的文件。然后，您可以获取旧文件的名称（使用 ((File)evt.getOldValue()).getName() 如上所述），使用标准字符串解析函数提取扩展，并将其存储到类中的命名成员变量中.

这样，当触发 FILE_FILTER_CHANGED 事件时（紧随其后，尽可能接近我可以确定），您可以从命名成员变量中提取隐藏的根名称，应用新文件过滤器类型的扩展名，并设置 JFileChooser 的选定文件因此。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-01-16T14:45:02.990

这是我的解决方案，它工作正常。它可能会帮助某人。您应该创建自己的“MyExtensionFileFilter”类，否则您必须修改代码。

```
public class MyFileChooser extends JFileChooser {
    private File file = new File("");

    public MyFileChooser() {
        addPropertyChangeListener(JFileChooser.FILE_FILTER_CHANGED_PROPERTY, new PropertyChangeListener() {
            public void propertyChange(PropertyChangeEvent e) {
                String filename = MyFileChooser.this.file.getName();
                String extold = null;
                String extnew = null;
                if (e.getOldValue() == null || !(e.getOldValue() instanceof MyExtensionFileFilter)) {
                    return;
                }
                if (e.getNewValue() == null || !(e.getNewValue() instanceof MyExtensionFileFilter)) {
                    return;
                }
                MyExtensionFileFilter oldValue = ((MyExtensionFileFilter) e.getOldValue());
                MyExtensionFileFilter newValue = ((MyExtensionFileFilter) e.getNewValue());
                extold = oldValue.getExtension();
                extnew = newValue.getExtension();

                if (filename.endsWith(extold)) {
                    filename = filename.replace(extold, extnew);
                } else {
                    filename += ("." + extnew);
                }
                setSelectedFile(new File(filename));
            }
        });
    }

    @Override
    public void setSelectedFile(File file) {
        super.setSelectedFile(file);
        if(getDialogType() == SAVE_DIALOG) {
            if(file != null) {
                super.setSelectedFile(file);
                this.file = file;
            }
        }
    }

    @Override
    public void approveSelection() { 
        if(getDialogType() == SAVE_DIALOG) {
            File f = getSelectedFile();  
            if (f.exists()) {  
                String msg = "File existes ...";  
                msg = MessageFormat.format(msg, new Object[] { f.getName() });  
                int option = JOptionPane.showConfirmDialog(this, msg, "", JOptionPane.YES_NO_OPTION);
                if (option == JOptionPane.NO_OPTION ) {  
                    return;  
                }
            }
        }
        super.approveSelection();   
    }

    @Override
    public void setVisible(boolean visible) {
        super.setVisible(visible);
        if(!visible) {
            resetChoosableFileFilters();
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-02-28T15:29:19.540

这是获取当前文件名（作为字符串）的方法。在您的属性更改侦听器中`JFileChooser.FILE_FILTER_CHANGED_PROPERTY`，您进行以下调用：

```
final JFileChooser fileChooser = new JFileChooser();
fileChooser.addPropertyChangeListener(JFileChooser.FILE_FILTER_CHANGED_PROPERTY, new PropertyChangeListener()
{
    @Override
    public void propertyChange(PropertyChangeEvent e) {
        String currentName = ((BasicFileChooserUI)fileChooser.getUI()).getFileName();
        MyFileFilter filter = (MyFileFilter) e.getNewValue();

        // ... Transform currentName as you see fit using the newly selected filter.
        // Suppose the result is in newName ...

        fileChooser.setSelectedFile(new File(newName));
    }
}); 
```

( returned by的后代)的`getFileName()`方法将返回对话框文本框的内容，该文本框用于输入文件名。似乎该值始终设置为非空字符串（如果框为空，则返回空字符串）。另一方面，如果用户尚未选择现有文件，则返回 null。`javax.swing.plaf.basic.BasicFileChooserUI``FileChooserUI``JFileChooser.getUI()``getSelectedFile()`

似乎对话框的设计受“文件选择”概念的支配；也就是说，虽然对话框可见，但`getSelectedFile()`如果用户已经选择了现有文件或名为`setSelectedFile()`. 将在用户单击批准（即确定）按钮**后**`getSelectedFile()`返回用户输入的内容。

 **该技术仅适用于单选对话框，但是基于选定过滤器更改文件扩展名也应该仅对单个文件有意义（“另存为...”对话框或类似的）。

这种设计早在 2003 年就曾在 sun.com 上引起过争论，详情请参阅[链接](http://bugs.sun.com/view_bug.do?bug_id=4528663)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-29T23:39:19.663

前面使用getAbsolutePath() 改变当前目录。当我选择不同的 FileFilter 时，当显示“我的文档”目录的 JFileChooser 对话框更改为 Netbeans 的项目目录时，我感到很惊讶，因此我将其更改为使用 getName()。我还使用了 JDK 6 FileNameExtensionFilter。

这是代码：

```
 final JFileChooser fc = new JFileChooser();
    final File sFile = new File("test.xls");
    fc.setSelectedFile(sFile);
    // Store this filter in a variable to be able to select this after adding all FileFilter
    // because addChoosableFileFilter add FileFilter in order in the combo box
    final FileNameExtensionFilter excelFilter = new FileNameExtensionFilter("Excel document (*.xls)", "xls");
    fc.addChoosableFileFilter(excelFilter);
    fc.addChoosableFileFilter(new FileNameExtensionFilter("CSV document (*.csv)", "csv"));
    // Force the excel filter
    fc.setFileFilter(excelFilter);
    // Disable All Files
    fc.setAcceptAllFileFilterUsed(false);

    // debug
    fc.addPropertyChangeListener(new PropertyChangeListener() {

        public void propertyChange(PropertyChangeEvent evt) {
            System.out.println("Property name=" + evt.getPropertyName() + ", oldValue=" + evt.getOldValue() + ", newValue=" + evt.getNewValue());
            System.out.println("getSelectedFile()=" + fc.getSelectedFile());
        }
    });

    fc.addPropertyChangeListener(JFileChooser.FILE_FILTER_CHANGED_PROPERTY, new PropertyChangeListener() {

        public void propertyChange(PropertyChangeEvent evt) {
            Object o = evt.getNewValue();
            if (o instanceof FileNameExtensionFilter) {
                FileNameExtensionFilter filter = (FileNameExtensionFilter) o;

                String ex = filter.getExtensions()[0];

                File selectedFile = fc.getSelectedFile();
                if (selectedFile == null) {
                    selectedFile = sFile;
                }
                String path = selectedFile.getName();
                path = path.substring(0, path.lastIndexOf("."));

                fc.setSelectedFile(new File(path + "." + ex));
            }
        }
    }); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-06-11T06:13:05.027

这是我的尝试。它使用accept() 函数来检查文件是否通过过滤器。如果文件名没有，则将扩展名附加到末尾。

```
JFileChooser jfc = new JFileChooser(getFile()) {
        public void approveSelection() {
            if (getDialogType() == SAVE_DIALOG) {
                File selectedFile = getSelectedFile();

                FileFilter ff = getFileFilter();

                // Checks against the current selected filter
                if (!ff.accept(selectedFile)) {
                    selectedFile = new File(selectedFile.getPath() + ".txt");
                }
                super.setSelectedFile(selectedFile);

                if ((selectedFile != null) && selectedFile.exists()) {
                    int response = JOptionPane.showConfirmDialog(
                            this,
                            "The file " + selectedFile.getName() + " already exists.\n" +
                            "Do you want to replace it?",
                            "Ovewrite file",
                            JOptionPane.YES_NO_OPTION,
                            JOptionPane.WARNING_MESSAGE
                    );
                    if (response == JOptionPane.NO_OPTION)
                        return;
                }
            }
            super.approveSelection();
        }
    }; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-11-03T15:38:01.310

如果您的 Java 版本支持它，我建议使用`FileNameExtensionFilter`而不是。`FileFilter`否则，创建您自己的新的类似抽象类，该类扩展自`FileFilter`并具有添加的方法`getExtension`（类似于`FileNameExtensionFilter.getExtensions`）。然后覆盖`getExtension`您打算使用的每个导出过滤器。

```
public abstract class MyFileFilter extends FileFilter {
    abstract public String getExtension();
} 
```

然后对于一个示例 JPG 过滤器，您只需要覆盖一个比以前额外的方法：

```
 MyFileFilter filterJPG = new MyFileFilter () {
        @Override
        public String getDescription() {
            return "A JPEG image (*." + getExtension() + ")";
        }
        @Override
        public boolean accept(File f) {
            String filename = f.getName().toLowerCase();
            return filename.endsWith("."+getExtension());
        }
        @Override
        public String getExtension() { return "jpg"; }
    }; 
```

用户选择文件后，只需调用`getFileFilter`以确定用户选择的过滤器：

```
jfc.showDialog(frame, "export");
File file = jfc.getSelectedFile();
RvFileFilter filter = (RvFileFilter)jfc.getFileFilter();
String sExt = filter.getExtension(); //The extension to ensure the file has 
```

如果您能够使用，`FileNameExtensionFilter.getExtensions()`那么您可以简单地使用数组中的第一个条目。

# email - 邮箱收到邮件时触发脚本？

> ID：596438
> 
> 赞同：1
> 
> 时间：2009-02-27T20:10:44.020
> 
> 标签：email, cron, polling, background-process

我想在收到邮件时处理一个特定的邮箱，我知道我可以每 n 分钟检查一次是否有任何邮件，但想知道是否有一种方法可以“收听”邮件而不是不断地轮询。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T20:13:53.917

尝试[.forward 文件](http://en.wikipedia.org/wiki/E-mail_forwarding)

您可以将消息通过管道传输到您想要的任何程序或脚本中，还可以检查[procmail](http://en.wikipedia.org/wiki/Procmail)是否可以执行您想要的操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-27T20:14:45.040

如果您使用的是后缀，我建议您将您感兴趣的邮箱[别名](https://stackoverflow.com/questions/487635/defining-a-messagle-handler-in-postfix/487666#487666)为可以为您完成工作的进程。然后就没有投票了。消息进来并直接进入处理。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-27T20:22:33.257

根据您的邮件服务器，实际上有可能将任何传入消息传递到进程。无论是在 .forward 还是通过设置更高级的东西。在 exim 中，您可以设置传输以针对某些地址运行命令。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-27T20:28:59.000

正如[Jason](https://stackoverflow.com/users/6212/jason-punyon)和[Zoredache](https://stackoverflow.com/users/20267/zoredache)已经提到的，您可以在 MTA 本身中执行此操作。另一种可能性是让[inotify](http://en.wikipedia.org/wiki/Inotify)监视邮箱文件或 maildir。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-02-28T16:19:48.623

如果您没有自己的邮件服务器（root 访问权限）- 您可以使用网络服务：[http](http://cloudmailin.net) ://cloudmailin.net（200 邮件/月免费）- 像魅力一样工作并帮助了我。

# ruby-on-rails - Facebooker Rails 插件 - 通知

> ID：596439
> 
> 赞同：1
> 
> 时间：2009-02-27T20:10:54.987
> 
> 标签：ruby-on-rails, facebook, publisher

我有一个非常愚蠢的问题：如何发送通知？例如，当我在我的应用程序上注册用户时，我想通过通知欢迎他/她。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T20:43:02.320

假设您正在使用 Facebooker（实际上，您应该使用），您可以创建一个[Publisher 类](http://apps.facebook.com/facebooker_tutorial/messaging/mini_feed)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T09:00:19.200

您还可以使用 facebook_session.send_notification([user_fb_id], "notification message") （在您的控制器中）。这将是一个应用到用户的通知，并且您每周可以向用户发送有限数量的通知。

要查看此限制，您可以使用以下调用： Facebooker::Session.create.post('facebook.admin.getAllocation', :integration_point_name => 'announcement_notifications_per_week')

# asp.net-mvc - Html.ActionLink 作为按钮或图像，而不是链接

> ID：596444
> 
> 赞同：335
> 
> 时间：2009-02-27T20:11:39.853
> 
> 标签：asp.net-mvc, actionlink

在 ASP.NET MVC 的最新 (RC1) 版本中，如何让 Html.ActionLink 呈现为按钮或图像而不是链接？

* * *

## 回答 #1

> 赞同：356
> 
> 时间：2010-05-05T14:42:43.287

我喜欢这样使用 Url.Action() 和 Url.Content() ：

```
<a href='@Url.Action("MyAction", "MyController")'>
    <img src='@Url.Content("~/Content/Images/MyLinkImage.png")' />
</a> 
```

严格来说， Url.Content 仅用于路径并不是您问题答案的一部分。

感谢@BrianLegg 指出这应该使用新的 Razor 视图语法。示例已相应更新。

* * *

## 回答 #2

> 赞同：334
> 
> 时间：2009-03-20T20:23:22.313

延迟响应，但您可以保持简单并将 CSS 类应用于 htmlAttributes 对象。

```
<%= Html.ActionLink("Button Name", "Index", null, new { @class="classname" }) %> 
```

然后在您的样式表中创建一个类

```
a.classname
{
    background: url(../Images/image.gif) no-repeat top left;
     display: block;
     width: 150px;
     height: 150px;
     text-indent: -9999px; /* hides the link text */
} 
```

* * *

## 回答 #3

> 赞同：96
> 
> 时间：2012-09-20T13:43:20.533

借用帕特里克的回答，我发现我必须这样做：

```
<button onclick="location.href='@Url.Action("Index", "Users")';return false;">Cancel</button> 
```

避免调用表单的 post 方法。

* * *

## 回答 #4

> 赞同：51
> 
> 时间：2011-09-27T04:29:56.967

称我为简单，但我只是这样做：

```
<a href="<%: Url.Action("ActionName", "ControllerName") %>">
    <button>Button Text</button>
</a> 
```

您只需处理超链接突出显示。我们的用户喜欢它:)

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2017-03-28T04:10:47.787

使用 bootstrap 这是创建链接到显示为动态按钮的控制器操作的最短和最干净的方法：

```
<a href='@Url.Action("Action", "Controller")' class="btn btn-primary">Click Me</a> 
```

或者使用 Html 助手：

```
@Html.ActionLink("Click Me", "Action", "Controller", new { @class = "btn btn-primary" }) 
```

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2014-10-02T02:41:04.553

如果您不想使用链接，请使用按钮。您也可以将图像添加到按钮：

```
<button type="button" onclick="location.href='@Url.Action("Create", "Company")'" >
   Create New
   <img alt="New" title="New" src="~/Images/Button/plus.png">
</button> 
```

**type="button"**执行您的操作而不是提交表单。

* * *

## 回答 #7

> 赞同：15
> 
> 时间：2012-01-28T17:52:45.080

简单地说：

```
<button onclick="@Url.Action("index", "Family", new {familyid = Model.FamilyID })">Cancel</button> 
```

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2014-01-09T13:46:22.700

一个迟到的答案，但这就是我如何将我的 ActionLink 变成一个按钮。我们在项目中使用 Bootstrap，因为它很方便。不要介意@T，因为它只是我们使用的翻译器。

```
@Html.Actionlink("Some_button_text", "ActionMethod", "Controller", "Optional parameter", "html_code_you_want_to_apply_to_the_actionlink"); 
```

上面给出了一个这样的链接，如下图所示：

```
localhost:XXXXX/Firms/AddAffiliation/F0500 
```

![带引导程序的图片演示按钮](https://i.stack.imgur.com/su0dO.png)

在我看来：

```
@using (Html.BeginForm())
{
<div class="section-header">
    <div class="title">
        @T("Admin.Users.Users")
    </div>
    <div class="addAffiliation">
        <p />
        @Html.ActionLink("" + @T("Admin.Users.AddAffiliation"), "AddAffiliation", "Firms", new { id = (string)@WorkContext.CurrentFirm.ExternalId }, new { @class="btn btn-primary" })
    </div>
</div>

} 
```

希望这可以帮助某人

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2009-02-27T20:12:52.313

你不能用`Html.ActionLink`. 您应该使用`Url.RouteUrl`并使用 URL 来构造您想要的元素。

* * *

## 回答 #10

> 赞同：11
> 
> 时间：2017-06-30T14:46:58.163

将 Html.ActionLink 变成按钮的一种简单方法（只要您插入了 BootStrap - 您可能已经插入）如下所示：

```
@Html.ActionLink("Button text", "ActionName", "ControllerName", new { @class = "btn btn-primary" }) 
```

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2012-03-05T14:04:29.387

`<button onclick="location.href='@Url.Action("NewCustomer", "Customers")'">Checkout >></button>`

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2009-06-15T18:42:31.997

甚至后来的回应，但我刚刚遇到了类似的问题，最终编写了我自己的[图像链接 HtmlHelper 扩展](http://blogs.aspiant.com/Mirko/2009/06/15/ASPNETMVCStronglyTypedActionLinkWithImages.aspx)。

您可以在上面链接中的我的博客上找到它的实现。

只是添加以防有人正在寻找实现。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2015-05-26T12:35:31.820

```
<li><a href="@Url.Action(  "View", "Controller" )"><i class='fa fa-user'></i><span>Users View</span></a></li> 
```

显示带有链接的图标

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2009-02-27T20:25:05.547

按照 Mehrdad 所说的去做 - 或者使用`HtmlHelper`Stephen Walther[在这里](http://stephenwalther.com/blog/archive/2009/02/18/asp.net-mvc-tip-47-ndash-using-resolveurl-in-an-html.aspx)描述的扩展方法中的 url 帮助程序，并制作您自己的扩展方法，该方法可用于呈现您的所有链接。

然后很容易将所有链接呈现为按钮/锚或任何您喜欢的方式 - 最重要的是，当您发现您实际上更喜欢其他方式制作链接时，您可以改变主意。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2016-08-16T16:39:52.367

你可以创建自己的扩展方法
看看我的实现

```
public static class HtmlHelperExtensions
{
    public static MvcHtmlString ActionImage(this HtmlHelper html, string action, object routeValues, string imagePath, string alt, object htmlAttributesForAnchor, object htmlAttributesForImage)
    {
        var url = new UrlHelper(html.ViewContext.RequestContext);

        // build the <img> tag
        var imgBuilder = new TagBuilder("img");
        imgBuilder.MergeAttribute("src", url.Content(imagePath));
        imgBuilder.MergeAttribute("alt", alt);
        imgBuilder.MergeAttributes(new RouteValueDictionary(htmlAttributesForImage));
        string imgHtml = imgBuilder.ToString(TagRenderMode.SelfClosing);

        // build the <a> tag
        var anchorBuilder = new TagBuilder("a");
        anchorBuilder.MergeAttribute("href", action != null ? url.Action(action, routeValues) : "#");
        anchorBuilder.InnerHtml = imgHtml; // include the <img> tag inside
        anchorBuilder.MergeAttributes(new RouteValueDictionary(htmlAttributesForAnchor));

        string anchorHtml = anchorBuilder.ToString(TagRenderMode.Normal);
        return MvcHtmlString.Create(anchorHtml);
    }
} 
```

然后在你的视图中使用它看看我的电话

```
 @Html.ActionImage(null, null, "../../Content/img/Button-Delete-icon.png", Resource_en.Delete,
               new{//htmlAttributesForAnchor
                   href = "#",
                   data_toggle = "modal",
                   data_target = "#confirm-delete",
                   data_id = user.ID,
                   data_name = user.Name,
                   data_usertype = user.UserTypeID
               }, new{ style = "margin-top: 24px"}//htmlAttributesForImage
                    ) 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2018-10-30T17:42:33.617

对于 Material Design Lite 和 MVC：

```
<a class="mdl-navigation__link" href='@Url.Action("MyAction", "MyController")'>Link Name</a> 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2012-01-11T03:35:03.270

```
@using (Html.BeginForm("DeleteMember", "Member", new { id = Model.MemberID }))
    {
        <input type="submit" value="Delete Member" onclick = "return confirm('Are you sure you want to delete the member?');" />
    } 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2013-10-11T19:35:11.003

关于如何创建显示为图像的链接似乎有很多解决方案，但没有一个解决方案使它看起来像一个按钮。

我发现只有一个好方法可以做到这一点。它有点hacky，但它有效。

您需要做的是创建一个按钮和一个单独的操作链接。使用 css 使操作链接不可见。当您单击按钮时，它可以触发操作链接的单击事件。

```
<input type="button" value="Search" onclick="Search()" />
 @Ajax.ActionLink("Search", "ActionName", null, new AjaxOptions {}, new { id = "SearchLink", style="display:none;" })

function Search(){
    $("#SearchLink").click();
 } 
```

每次添加需要看起来像按钮的链接时，这样做可能会让人头疼，但它确实实现了预期的结果。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2015-12-07T11:25:53.847

使用 FORMACTION

```
<input type="submit" value="Delete" formaction="@Url.Action("Delete", new { id = Model.Id })" /> 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2010-11-29T10:35:03.123

`Url.Action()`将为您提供大多数重载的裸 URL `Html.ActionLink`，但我认为该`URL-from-lambda`功能仅在目前可用`Html.ActionLink`。希望他们会`Url.Action`在某个时候添加类似的重载。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2012-01-06T12:34:18.377

刚刚找到[了这个扩展](http://dotnetdevdude.com/Blog/CommentView,guid,D1BC810E-CEE1-4A38-967E-AF7EB553831B.aspx#71a95cc2-ffe8-4a91-a238-efca693c25b8)来做到这一点 - 简单而有效。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2012-05-03T13:58:53.813

我这样做的方式是分别拥有 actionLink 和图像。将 actionlink 图像设置为隐藏，然后添加一个 jQuery 触发器调用。这更像是一种解决方法。

```
'<%= Html.ActionLink("Button Name", "Index", null, new { @class="yourclassname" }) %>'
<img id="yourImage" src="myImage.jpg" /> 
```

触发示例：

```
$("#yourImage").click(function () {
  $('.yourclassname').trigger('click');
}); 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2016-06-19T22:38:32.630

这就是我在没有脚本的情况下做到的：

```
@using (Html.BeginForm("Action", "Controller", FormMethod.Get))
{
    <button type="submit" 
            class="btn btn-default" 
            title="Action description">Button Label</button>
} 
```

相同，但带有参数和确认对话框：

```
@using (Html.BeginForm("Action", "Controller", 
        new { paramName = paramValue }, 
        FormMethod.Get, 
        new { onsubmit = "return confirm('Are you sure?');" }))
{
    <button type="submit" 
            class="btn btn-default" 
            title="Action description">Button Label</button>
} 
```

# multithreading - 线程范式？

> ID：596449
> 
> 赞同：0
> 
> 时间：2009-02-27T20:12:09.710
> 
> 标签：multithreading, paradigms

是否有任何范式可以给您不同的思维方式或对编写多线程应用程序有不同的看法？也许是感觉非常不同的东西，比如过程编程和函数编程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T20:18:12.287

并发对于不同的问题有很多不同的模型。Wikipedia page for [concurrency](http://en.wikipedia.org/wiki/Concurrency_(computer_science)#Models)列出了一些模型，还有一个[并发模式](http://en.wikipedia.org/wiki/Concurrency_pattern)页面，它为处理并发的不同方法提供了一些很好的起点。

您采用的方法很大程度上取决于手头的问题。不同的模型解决了并发应用程序中可能出现的各种不同的问题，有些是基于其他的。

在课堂上我被教导并发使用[互斥](http://en.wikipedia.org/wiki/Mutual_exclusion)和[同步](http://en.wikipedia.org/wiki/Synchronization_(computer_science))来解决并发问题。有些解决方案只需要一个，但两者都应该能够解决任何并发问题。

对于一个截然不同的概念，您可以查看不变性和并发性。如果所有数据都是不可变的，那么甚至不需要传统的并发方法。[本文](http://strangelights.com/blog/archive/2008/05/18/1617.aspx)探讨了该主题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T20:21:49.267

我不太明白这个问题，但是如果您开始使用[CUDA](http://www.nvidia.com/cuda)进行一些编码，那么您会对多线程应用程序有一些不同的思考方式。

它不同于一般的多线程技术，如信号量、监视器等，因为您同时有数千个线程。因此，CUDA 中的并行问题更多地在于对数据进行分区并稍后混合数据块。

[SCAN](http://developer.download.nvidia.com/compute/cuda/1_1/Website/projects/scan/doc/scan.pdf)算法是对常见串行问题进行彻底重新思考的一个小例子。它很简单：

*   给定一个 SET {a,b,c,d,e}

我想要以下套装：

{a, a+b, a+b+c, a+b+c+d, a+b+c+d+e}

在这种情况下，符号“+”是任何交换运算符（不仅是加号，您还可以进行乘法运算）。

如何并行执行此操作？这是对问题的彻底重新思考，[本文](http://developer.download.nvidia.com/compute/cuda/1_1/Website/projects/scan/doc/scan.pdf)对此进行了描述。

可以在 NVIDIA[网站上找到更多 CUDA 中不同算法的实现](http://www.nvidia.com/object/cuda_sample_data-parallel.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T20:47:05.010

嗯，一个非常保守的范式转变是从以线程为中心的并发（共享一切）到以进程为中心的并发（地址空间分离）。这样可以避免意外的数据共享，并且更容易在不同子系统之间实施通信策略。

这个想法很古老，并且被微内核操作系统社区（以及其他）传播，以构建更可靠的操作系统。有趣的是，微软研究院的[Singularity](http://research.microsoft.com/en-us/projects/singularity/) OS 原型表明，在使用该模型时甚至不需要传统的地址空间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T20:49:47.140

我最喜欢的相对较新的想法是[事务性内存](http://en.wikipedia.org/wiki/Transactional_memory)：通过确保更新始终是原子的来避免并发问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-28T17:08:04.933

查看[OpenMP](http://en.wikipedia.org/wiki/OpenMP)以了解有趣的变化。

# asp.net - jQuery 和 ASP.NET 名称

> ID：596458
> 
> 赞同：6
> 
> 时间：2009-02-27T20:13:55.900
> 
> 标签：asp.net, jquery, controls, jquery-selectors

获取由 ASP.NET 使用 jQuery 呈现的控件的正确方法是什么？

示例：我有一个这样生成的复选框：

```
<input id="ctl00_Content_chkOk" type="checkbox" name="ctl00$Content$chkOk" /> 
```

如果我想选择它来获取它是否被选中，我试过这个：

```
$('form input[name=chkOk]').attr("checked") 
```

和

```
$('chkOk').attr("checked") 
```

但它没有用，我不得不这样做

```
$('form input[name=ctl00$Content$chkOk]').attr("checked") 
```

我想这也会奏效：

```
$('ctl00$Content$chkOk').attr("checked") 
```

这是正确的方法吗？我可以使用其他选择器吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-27T20:19:46.353

您可以使用服务器端控件[ClientID](http://msdn.microsoft.com/en-us/library/system.web.ui.control.clientid.aspx)属性：

```
var isChecked = $('#<%=YourCheckBox.ClientID%>').attr("checked"); 
```

或者你可以使用“结尾”选择器：[attribute$=value](http://docs.jquery.com/Selectors/attributeEndsWith#attributevalue)

```
var isChecked =  $('form input[name$=chkOk]').attr("checked"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T20:19:31.080

我一直用这个符号

```
$('#ctl00_Content_chkOk:checked').length; // will evaluate as true when checked 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T20:21:57.627

你可以做

$("input[id*=_chkOk]").attr('checked');

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T20:15:50.247

```
$('#ctl00_Content_chkOk').attr('checked');
$('form #ctl00_Content_chkOk').attr('checked');
$('form input#ctl00_Content_chkOk').attr('checked');
$('form input#ctl00_Content_chkOk[type="checkbox"]').attr('checked'); 
```

选一个 ;）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T20:17:12.960

是的，JQuery 只关心页面上呈现的内容，无论是通过 ASP.NET 引擎还是通过简单的 HTML，因此您必须通过 id 或名称访问它。您使用的两个底层版本与 $('#ct100_Content_chk0k').attr("checked") 一样有效。

亚当

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-27T20:22:44.613

我倾向于在两种方式之间来回走动。我要么使用 CMS 提到的控件的 clientID 属性，要么在后面的代码中生成 javascript 代码并使用页面的[ClientScriptManager](http://msdn.microsoft.com/en-us/library/system.web.ui.clientscriptmanager.aspx)将其写入浏览器。

# java - 在生成 .equals() 时，有什么理由更喜欢 getClass() 而不是 instanceof？

> ID：596462
> 
> 赞同：187
> 
> 时间：2009-02-27T20:14:37.020
> 
> 标签：java, eclipse, equals, instanceof

我正在使用 Eclipse 生成`.equals()`and `.hashCode()`，并且有一个标记为“使用'instanceof'来比较类型”的选项。默认情况下未选中此选项并用于`.getClass()`比较类型。有什么理由我应该更喜欢`.getClass()`吗`instanceof`？

不使用`instanceof`：

```
if (obj == null)
  return false;
if (getClass() != obj.getClass())
  return false; 
```

使用`instanceof`：

```
if (obj == null)
  return false;
if (!(obj instanceof MyClass))
  return false; 
```

我一般勾选`instanceof`选项，然后进去去掉“ `if (obj == null)`”勾选。（这是多余的，因为空对象总是会失败`instanceof`。）有什么理由是个坏主意吗？

* * *

## 回答 #1

> 赞同：185
> 
> 时间：2009-02-27T20:21:55.507

[乔什·布洛赫（Josh Bloch）](http://www.artima.com/intv/bloch17.html)赞成您的方法：

> 我赞成这种`instanceof`方法的原因是，当您使用这种`getClass`方法时，您会受到限制，即对象只能与同一类、相同运行时类型的其他对象相等。如果你扩展一个类并为其添加一些无害的方法，然后检查子类的某个对象是否与超类的某个对象相等，即使这些对象在所有重要方面都相等，你也会得到令人惊讶的答案是它们不相等。事实上，这违反了对*Liskov 替换原则*的严格解释，并且可能导致非常令人惊讶的行为。在 Java 中，它特别重要，因为大多数集合 (`HashTable`等）基于equals方法。如果将超类的成员作为键放在哈希表中，然后使用子类实例查找它，您将找不到它，因为它们不相等。

另请参阅[此 SO 答案](https://stackoverflow.com/questions/27581/overriding-equals-and-hashcode-in-java/32223#32223)。

Effective Java[第 3 章](http://java.sun.com/developer/Books/effectivejava/Chapter3.pdf)也涵盖了这一点。

* * *

## 回答 #2

> 赞同：107
> 
> 时间：2009-02-27T21:11:51.907

如果您使用`instanceof`，使您的`equals`实现`final`将保留该方法的对称契约：`x.equals(y) == y.equals(x)`. 如果`final`看起来有限制，请仔细检查您的对象等价概念，以确保您的覆盖实现完全维护`Object`类建立的合同。

* * *

## 回答 #3

> 赞同：68
> 
> 时间：2009-02-27T21:34:21.120

使用的原因`getClass`是为了保证`equals`合约的对称性。来自 equals 的 JavaDocs：

> 它是对称的：对于任何非空引用值 x 和 y，当且仅当 y.equals(x) 返回 true 时，x.equals(y) 才应该返回 true。

通过使用instanceof，可能不是对称的。考虑这个例子：Dog 扩展 Animal。Animal's对 Animal`equals`进行`instanceof`检查。Dog's对 Dog`equals`进行`instanceof`检查。给出 Animal **a**和 Dog **d**（其他字段相同）：

```
a.equals(d) --> true
d.equals(a) --> false 
```

这违反了对称性。

要严格遵循equal的契约，必须保证对称性，因此类需要相同。

* * *

## 回答 #4

> 赞同：68
> 
> 时间：2009-02-27T21:52:39.080

Angelika Langers [**Secrets of equals**](http://www.angelikalanger.com/Articles/JavaSolutions/SecretsOfEquals/Equals.html)对一些常见和知名的例子进行了长时间而详细的讨论，包括 Josh Bloch 和 Barbara Liskov 的例子，在其中发现了一些问题。她也进入了`instanceof`vs `getClass`。引用其中的一些内容

> 结论
> 
> 在剖析了四个任意选择的 equals() 实现示例之后，我们得出什么结论？
> 
> 首先：在 equals() 的实现中执行类型匹配检查有两种截然不同的方法。一个类可以通过 instanceof 运算符允许超类和子类对象之间的混合类型比较，或者一个类可以通过 getClass() 测试将不同类型的对象视为不相等的对象。上面的示例很好地说明了使用 getClass() 的 equals() 实现通常比使用 instanceof 的实现更健壮。
> 
> instanceof 测试仅适用于最终类，或者至少方法 equals() 在超类中是最终的。后者本质上意味着没有子类必须扩展超类的状态，而只能添加与对象的状态和行为无关的功能或字段，例如瞬态或静态字段。
> 
> 另一方面，使用 getClass() 测试的实现总是遵守 equals() 契约；它们是正确且稳健的。然而，它们在语义上与使用 instanceof 测试的实现非常不同。使用 getClass() 的实现不允许将子类与超类对象进行比较，即使子类不添加任何字段并且甚至不想覆盖 equals() 也是如此。例如，这种“微不足道”的类扩展将是在为这个“微不足道”目的而定义的子类中添加调试打印方法。如果超类通过 getClass() 检查禁止混合类型比较，那么微不足道的扩展将无法与其超类进行比较。这是否是一个问题完全取决于类的语义和扩展的目的。

* * *

## 回答 #5

> 赞同：27
> 
> 时间：2009-02-27T22:15:14.000

这是一场宗教辩论。两种方法都有其问题。

*   使用*instanceof*，您永远无法向子类添加重要成员。
*   使用*getClass*会违反 Liskov 替换原则。

[Bloch在](http://en.wikipedia.org/wiki/Joshua_Bloch)[Effective Java Second Edition](http://wayback.archive.org/web/20100827151804/http://java.sun.com/docs/books/effective/)中有另一条相关建议：

*   **第 17 项：继承或禁止继承的设计和文件**

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2011-10-26T05:03:34.267

如果我错了，请纠正我，但是当您想确保您的实例不是您正在比较的类的子类时，getClass() 将很有用。如果您在这种情况下使用 instanceof，您将无法知道这一点，因为：

```
class A { }

class B extends A { }

Object oA = new A();
Object oB = new B();

oA instanceof A => true
oA instanceof B => false
oB instanceof A => true // <================ HERE
oB instanceof B => true

oA.getClass().equals(A.class) => true
oA.getClass().equals(B.class) => false
oB.getClass().equals(A.class) => false // <===============HERE
oB.getClass().equals(B.class) => true 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-02-27T20:24:48.323

如果您想确保只有该类匹配，请使用`getClass() ==`. 如果要匹配子类，则`instanceof`需要。

此外，instanceof 不会与 null 匹配，但可以安全地与 null 进行比较。所以你不必对它进行空检查。

```
if ( ! (obj instanceof MyClass) ) { return false; } 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-02-27T20:25:19.757

这取决于您是否考虑给定类的子类是否等于其父类。

```
class LastName
{
(...)
}

class FamilyName
extends LastName
{
(..)
} 
```

在这里我会使用“instanceof”，因为我希望将 LastName 与 FamilyName 进行比较

```
class Organism
{
}

class Gorilla extends Organism
{
} 
```

在这里我会使用“getClass”，因为该类已经说这两个实例不等价。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-02-27T20:33:29.707

**instanceof**适用于同一类**或其**子类的实例

> *您可以使用它来测试对象是类的实例、子类的实例还是实现特定接口的类的实例。*

ArryaList 和 RoleList 都是**instanceof** List

尽管

**getClass() == o.getClass()**仅当两个对象（ this 和 o ）都属于完全相同的类时才为真。

因此，根据您需要比较的内容，您可以使用其中一种。

如果您的逻辑是：“只有当它们都是同一个类时，一个对象才等于另一个对象”，那么您应该选择“等于”，我认为这是大多数情况。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-02-27T22:06:10.420

两种方法都有其问题。

如果子类改变了身份，那么你需要比较它们的实际类。否则，您违反了对称属性。例如，不同类型的`Person`s 不应该被认为是等价的，即使它们具有相同的名称。

但是，一些子类不会改变身份，这些需要使用`instanceof`. 例如，如果我们有一堆不可变`Shape`对象，那么`Rectangle`长度和宽度为 1 的 a 应该等于 unit `Square`。

在实践中，我认为前一种情况更可能是正确的。通常，子类化是您身份的基本组成部分，与您的父母完全一样，除了您可以做一件小事并不会使您平等。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2015-12-01T13:27:32.197

实际上 instanceof 检查对象是否属于某个层次结构。例如： Car 对象属于 Vehical 类。所以“Vehical 的 new Car() 实例”返回 true。并且“new Car().getClass().equals(Vehical.class)”返回 false，虽然 Car 对象属于 Vehical 类，但它被归类为单独的类型。

# c# - 如何使用 Func 在 Linq 中指定 .NET 匿名对象返回类型 ?

> ID：596465
> 
> 赞同：1
> 
> 时间：2009-02-27T20:14:50.390
> 
> 标签：c#, linq, anonymous-types

如何为匿名对象指定**Func签名？**

```
new Func<DataSet, **IEnumerable<int>>** 
```

我在 Func 声明中指定为**IEnumerable<>的返回类型有问题**

我从表达式中得到的错误是

> 无法将表达式类型“System.Collections.Generic.IEnumerable<{ParentNodeId:int}>”转换为返回类型“System.Collections.Generic.IEnumerable”

如何在 func 中指定**IEnumerable<{ParentNodeId:int}> ？**

```
 public int GetCachedRootNodeId(IList<int> fromNodeIds, int forNodeId)
    {
        var result = forNodeId;

        const string spName = "spFetchAllParentNodeIDs";
        using (var ds = _df.ExecuteDatasetParamArray(_ConnectionString, spName, forNodeId))
        {
            if (DataAccessUtil.DataSetIsEmpty(ds)) return result;

            var orderByLevelDesc = new Func<DataSet, IEnumerable<int>>(resultSet =>
                from DataRow row in DataAccessUtil.GetFirstTableRows(resultSet) 
                orderby DataAccessUtil.GetInt32(row, "Level") descending 
                select new { ParentNodeId = DataAccessUtil.GetInt32(row, "ParentNodeID") });

            //// Get top-most parent's node ID first (higher the level, the more top-most the parent is)
            //var query = from DataRow row in DataAccessUtil.GetFirstTableRows(ds)
            //            orderby DataAccessUtil.GetInt32(row, "Level") descending
            //            select new { ParentNodeId = DataAccessUtil.GetInt32(row, "ParentNodeID") };
            //foreach (var nodeInfo in query)
            foreach (var nodeInfo in orderByLevelDesc(ds))
            {
                if (fromNodeIds.Contains(nodeInfo.ParentNodeId))
                    return nodeInfo.ParentNodeId;
            }
        }

        return result;
    } 
```

顺便说一句，我可以使用注释代码“查询”并完成它。但是想要更有表现力并在查看这个答案后尝试一些新的东西 [为什么 C# 没有词法嵌套函数？](https://stackoverflow.com/questions/576374/why-doesnt-c-have-lexically-nested-functions/576386#576386)

**编辑**：最终结果

```
 public int GetCachedRootNodeId(IList<int> fromNodeIds, int forNodeId)
    {
        var result = forNodeId;

        const string spName = "spFetchAllParentNodeIDs";
        using (var ds = _df.ExecuteDatasetParamArray(_ConnectionString, spName, forNodeId))
        {
            if (DataAccessUtil.DataSetIsEmpty(ds)) return result;

            var orderParentNodeIDByLevelDesc = new Func<DataSet, IEnumerable<int>>(resultSet =>
                from DataRow row in DataAccessUtil.GetFirstTableRows(resultSet) 
                orderby DataAccessUtil.GetInt32(row, "Level") descending
                select DataAccessUtil.GetInt32(row, "ParentNodeID"));

            foreach (var parentNodeId in orderParentNodeIDByLevelDesc(ds))
            {
                if (fromNodeIds.Contains(parentNodeId))
                    return parentNodeId;
            }
        }

        return result;
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T20:21:41.403

这是一个想法 - 调用一个静态方法并让类型推断来做：

```
public static Func<T, TResult> FuncOf(Func<T, TResult> func)
{
    return func;
} 
```

然后就叫它：

```
var orderByLevelDesc = FuncOf(resultSet =>
    from DataRow row in DataAccessUtil.GetFirstTableRows(resultSet) 
    orderby DataAccessUtil.GetInt32(row, "Level") descending 
    select new { ParentNodeId = DataAccessUtil.GetInt32(row, "ParentNodeID")
    }); 
```

基本上，您只需要“Func”部分告诉编译器它需要将 lambda 表达式转换为委托而不是表达式，以及委托的类型。它应该能够计算出给定 FuncOf 签名的类型。

无论如何，值得一试。

顺便说一句，我应该说，我发现您的注释版本更容易理解。为什么要引入一个额外的功能？或者您是否计划*不*将其作为局部变量（这会更有意义，但是您不能使用`var`）？或者可能是在循环*外部而不是内部声明的局部变量？*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T20:17:31.443

无法在声明中指定匿名类型。你必须为它创建一个命名类。

Jon Skeet 有一篇关于这个问题的[相关博客文章。](http://msmvps.com/blogs/jon_skeet/archive/2009/01/09/horrible-grotty-hack-returning-an-anonymous-type-instance.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-27T20:36:21.493

在这种情况下，您真正​​想要的只是 int... 所以只需将您的选择更改为：

```
select DataAccessUtil.GetInt32(row, "ParentNodeID")); 
```

并将您的 foreach 更改为：

```
foreach (var nodeInfo in orderByLevelDesc(ds))
{
    if (fromNodeIds.Contains(nodeInfo))
        return nodeInfo;
} 
```

# javascript - 如何在 JavaScript 中将浮点数转换为整数？

> ID：596467
> 
> 赞同：1354
> 
> 时间：2009-02-27T20:15:07.317
> 
> 标签：javascript, syntax

我想在 JavaScript 中将浮点数转换为整数。实际上，我想知道如何进行两种标准转换：截断和舍入。并且有效，而不是通过转换为字符串和解析。

* * *

## 回答 #1

> 赞同：1976
> 
> 时间：2009-02-27T20:21:02.077

```
var intvalue = Math.floor( floatvalue );
var intvalue = Math.ceil( floatvalue ); 
var intvalue = Math.round( floatvalue );

// `Math.trunc` was added in ECMAScript 6
var intvalue = Math.trunc( floatvalue ); 
```

[数学对象参考](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math)

* * *

### 例子

**积极的**

```
// value=x        //  x=5          5<x<5.5      5.5<=x<6  

Math.floor(value) //  5            5            5
Math.ceil(value)  //  5            6            6
Math.round(value) //  5            5            6
Math.trunc(value) //  5            5            5
parseInt(value)   //  5            5            5
~~value           //  5            5            5
value | 0         //  5            5            5
value >> 0        //  5            5            5
value >>> 0       //  5            5            5
value - value % 1 //  5            5            5 
```

**消极的**

```
// value=x        // x=-5         -5>x>=-5.5   -5.5>x>-6

Math.floor(value) // -5           -6           -6
Math.ceil(value)  // -5           -5           -5
Math.round(value) // -5           -5           -6
Math.trunc(value) // -5           -5           -5
parseInt(value)   // -5           -5           -5
value | 0         // -5           -5           -5
~~value           // -5           -5           -5
value >> 0        // -5           -5           -5
value >>> 0       // 4294967291   4294967291   4294967291
value - value % 1 // -5           -5           -5 
```

**正数 - 较大的数字**

```
// x = Number.MAX_SAFE_INTEGER/10 // =900719925474099.1

// value=x            x=900719925474099    x=900719925474099.4  x=900719925474099.5

Math.floor(value) //  900719925474099      900719925474099      900719925474099
Math.ceil(value)  //  900719925474099      900719925474100      900719925474100
Math.round(value) //  900719925474099      900719925474099      900719925474100
Math.trunc(value) //  900719925474099      900719925474099      900719925474099
parseInt(value)   //  900719925474099      900719925474099      900719925474099
value | 0         //  858993459            858993459            858993459
~~value           //  858993459            858993459            858993459
value >> 0        //  858993459            858993459            858993459
value >>> 0       //  858993459            858993459            858993459
value - value % 1 //  900719925474099      900719925474099      900719925474099 
```

**负数 - 更大的数字**

```
// x = Number.MAX_SAFE_INTEGER/10 * -1 // -900719925474099.1

// value = x      // x=-900719925474099   x=-900719925474099.5 x=-900719925474099.6

Math.floor(value) // -900719925474099     -900719925474100     -900719925474100
Math.ceil(value)  // -900719925474099     -900719925474099     -900719925474099
Math.round(value) // -900719925474099     -900719925474099     -900719925474100
Math.trunc(value) // -900719925474099     -900719925474099     -900719925474099
parseInt(value)   // -900719925474099     -900719925474099     -900719925474099
value | 0         // -858993459           -858993459           -858993459
~~value           // -858993459           -858993459           -858993459
value >> 0        // -858993459           -858993459           -858993459
value >>> 0       //  3435973837           3435973837           3435973837
value - value % 1 // -900719925474099     -900719925474099     -900719925474099 
```

* * *

## 回答 #2

> 赞同：331
> 
> 时间：2012-10-11T10:18:29.280

## 按位或运算符

按位或运算符可用于截断浮点数，它适用于正数和负数：

```
function float2int (value) {
    return value | 0;
} 
```

结果

```
float2int(3.1) == 3
float2int(-3.1) == -3
float2int(3.9) == 3
float2int(-3.9) == -3 
```

## 性能比较？

我创建了一个比较性能的[JSPerf 测试](http://jsperf.com/float-to-int-conversion-comparison)：

*   `Math.floor(val)`
*   `val | 0` ^(按位**或**)
*   `~~val` ^(按位**非**)
*   `parseInt(val)`

这只适用于正数。在这种情况下，您可以安全地使用按位运算和`Math.floor`函数。

但是，如果您需要您的代码同时**使用 positives 和 negatives**，那么按位运算是最快的（OR 是首选）。[这个其他 JSPerf 测试](http://jsperf.com/truncating-decimals)比较相同，很明显，由于额外的符号检查，**Math 现在是**四个中最慢的。

## 笔记

如评论中所述，BITWISE 运算符对有符号的 32 位整数进行操作，因此将转换大数，例如：

```
1234567890  | 0 => 1234567890
12345678901 | 0 => -539222987 
```

* * *

## 回答 #3

> 赞同：98
> 
> 时间：2009-10-14T16:17:26.940

注意：您不能`Math.floor()`用作截断的替代品，因为`Math.floor(-3.1) = -4`而不是`-3`!!

截断的正确替换是：

```
function truncate(value)
{
    if (value < 0) {
        return Math.ceil(value);
    }

    return Math.floor(value);
} 
```

* * *

## 回答 #4

> 赞同：48
> 
> 时间：2012-01-11T16:54:59.640

双[位非](https://developer.mozilla.org/en/JavaScript/Reference/Operators/Bitwise_Operators#.7E_%28Bitwise_NOT%29)运算符可用于截断浮点数。您提到的其他操作可通过[`Math.floor`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Math/floor)、[`Math.ceil`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Math/ceil)和 进行[`Math.round`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Math/round)。

```
> ~~2.5
2
> ~~(-1.4)
-1 
```

[更多细节由 James Padolsey 提供。](http://james.padolsey.com/javascript/double-bitwise-not/)

* * *

## 回答 #5

> 赞同：42
> 
> 时间：2009-02-27T20:22:47.190

对于截断：

```
var intvalue = Math.floor(value); 
```

对于圆形：

```
var intvalue = Math.round(value); 
```

* * *

## 回答 #6

> 赞同：34
> 
> 时间：2011-09-26T20:41:16.847

您可以使用[parseInt](http://www.w3schools.com/jsref/jsref_parseInt.asp)方法不进行舍入。由于 0x（十六进制）和 0（八进制）前缀选项，请注意用户输入。

```
var intValue = parseInt(floatValue, 10); 
```

编辑：作为**警告**（来自评论部分），请注意某些数值将被转换为它们的指数形式，例如`1e21`这会导致不正确的十进制表示`"1"`

* * *

## 回答 #7

> 赞同：19
> 
> 时间：2013-07-25T07:33:43.400

***位移 0 相当于除以 1***

```
// >> or >>>
2.0 >> 0; // 2
2.0 >>> 0; // 2 
```

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2009-10-14T16:30:48.293

在您的情况下，当您最后想要一个字符串（以便插入逗号）时，您也可以只使用该[`Number.toFixed()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/toFixed)函数，但是，这将执行舍入。

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2016-02-28T17:45:44.097

另一种可能的方法 - 使用 XOR 操作：

```
console.log(12.3 ^ 0); // 12
console.log("12.3" ^ 0); // 12
console.log(1.2 + 1.3 ^ 0); // 2
console.log(1.2 + 1.3 * 2 ^ 0); // 3
console.log(-1.2 ^ 0); // -1
console.log(-1.2 + 1 ^ 0); // 0
console.log(-1.2 - 1.3 ^ 0); // -2
```

按位运算的优先级低于数学运算的优先级，它很有用。试试[https://jsfiddle.net/au51uj3r/](https://jsfiddle.net/au51uj3r/)

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2015-09-22T14:46:53.370

**截断**：_

```
// Math.trunc() is part of the ES6 spec
console.log(Math.trunc( 1.5 ));  // returns 1
console.log(Math.trunc( -1.5 )); // returns -1
// Math.floor( -1.5 ) would return -2, which is probably not what you wanted
```

**舍**入：

```
console.log(Math.round( 1.5 ));  // 2
console.log(Math.round( 1.49 )); // 1
console.log(Math.round( -1.6 )); // -2
console.log(Math.round( -1.3 )); // -1
```

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2013-07-11T13:42:45.287

这里有很多建议。到目前为止，按位 OR 似乎是最简单的。这是另一个简短的解决方案，它也适用于负数以及使用模运算符。它可能比按位 OR 更容易理解：

```
intval = floatval - floatval%1; 
```

此方法也适用于 '|0' 、 '~~' 和 '>>0' 都不能正常工作的高值数字：

```
> n=4294967295;
> n|0
-1
> ~~n
-1
> n>>0
-1
> n-n%1
4294967295 
```

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2020-05-07T16:11:43.840

```
//Convert a float to integer

Math.floor(5.95)
//5

Math.ceil(5.95)
//6

Math.round(5.4)
//5

Math.round(5.5)
//6

Math.trunc(5.5)
//5

//Quick Ways
console.log(5.95| 0)
console.log(~~5.95) 
console.log(5.95 >> 0)
//5
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2019-01-31T09:33:00.923

如果查看`Math`JavaScript 中的原生对象，你会得到一大堆函数来处理数字和值等......

基本上你想要做的是非常简单和原生的 JavaScript ......

假设您有以下数字：

```
const myValue = 56.4534931; 
```

现在，如果您想将其四舍五入到最接近的数字，只需执行以下操作：

```
const rounded = Math.floor(myValue); 
```

你得到：

```
56 
```

如果要将其四舍五入到最接近的数字，只需执行以下操作：

```
const roundedUp = Math.ceil(myValue); 
```

你得到：

```
57 
```

也`Math.round`只是将它四舍五入到更高或更低的数字取决于哪个更接近浮点数。

您也可以`~~`在浮点数后面使用，它将浮点数转换为整数。

你可以像`~~myValue`...一样使用它

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2020-11-28T18:47:09.490

# 表现

今天 2020 年 11 月 28 日，我在 Chrome v85、Safari v13.1.2 和 Firefox v80 上对 MacOs HighSierra 10.13.6 进行测试，以选择解决方案。

## 结果

*   对于所有浏览器，所有解决方案（B 和 K 除外）都给出了非常相似的速度结果
*   解决方案 B 和 K 很慢

[![在此处输入图像描述](https://i.stack.imgur.com/XaaEe.png)](https://i.stack.imgur.com/XaaEe.png)

## 细节

[我执行你可以在这里](https://jsbench.me/vnkhzab2d6/1)运行的测试用例

下面的片段显示了解决方案 [A](https://stackoverflow.com/a/596503/860099) [B](https://stackoverflow.com/a/596503/860099) [C](https://stackoverflow.com/a/596503/860099) [D](https://stackoverflow.com/a/596503/860099) [E](https://stackoverflow.com/a/596503/860099) [F](https://stackoverflow.com/a/596503/860099) [G](https://stackoverflow.com/a/35686008/860099) [H](https://stackoverflow.com/a/596503/860099) [I](https://stackoverflow.com/a/596503/860099) [J](https://stackoverflow.com/a/596503/860099) [K](https://stackoverflow.com/a/1567461/860099) [L之间的差异](https://stackoverflow.com/a/596503/860099)

```
function A(float) {
    return Math.trunc( float );
}

function B(float) {
    return parseInt(float);
}

function C(float) {
    return float | 0;
}

function D(float) {
    return ~~float;
}

function E(float) {
    return float >> 0;
}

function F(float) {
    return float - float%1;
}

function G(float) {
    return float ^ 0;
}

function H(float) {
    return Math.floor( float );
}

function I(float) {
    return Math.ceil( float );
}

function J(float) {
    return Math.round( float );
}

function K(float) {
    return float.toFixed(0);
}

function L(float) {
    return float >>> 0;
}

// ---------
// TEST
// ---------

[A,B,C,D,E,F,G,H,I,J,K,L]
  .forEach(f=> console.log(`${f.name} ${f(1.5)} ${f(-1.5)} ${f(2.499)} ${f(-2.499)}`))
```

```
This snippet only presents functions used in performance tests - it not perform tests itself!
```

这是 chrome 的示例结果

[![在此处输入图像描述](https://i.stack.imgur.com/d3u3C.png)](https://i.stack.imgur.com/d3u3C.png)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2015-11-04T16:20:33.533

我只想指出，从金钱上讲，您要四舍五入，而不是截断。减少一分钱的可能性要小得多，因为四舍五入的 4.999452 * 100 会给你 5，这是一个更具代表性的答案。

最重要的是，不要忘记[银行家的四舍五入](https://en.wikipedia.org/wiki/Rounding#Round_half_to_even)，这是一种抵消直接四舍五入带来的轻微正偏差的方法——您的金融应用程序可能需要它。

*[JavaScript 中的高斯/银行家四舍五入](https://stackoverflow.com/questions/3108986/gaussian-bankers-rounding-in-javascript)*

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-01-20T10:36:15.490

如果您使用的是 angularjs，那么简单的解决方案如下在 HTML 模板绑定中

`{{val | number:0}}`

它会将 val 转换为整数

通过此链接[docs.angularjs.org/api/ng/filter/number](http://docs.angularjs.org/api/ng/filter/number)

# tcl - tcl 中 upvar 和全局命令之间的实际区别是什么

> ID：596474
> 
> 赞同：1
> 
> 时间：2009-02-27T20:15:43.663
> 
> 标签：tcl, coding-style

我对 TCL 相当陌生，并且正在为其他人开发的一些代码提供 QA（不是真的！）。在这个特定的程序中有很多很多全局变量，我有时会看到 upvar 被使用，通常与 global 结合使用。我知道 upvar 模拟传递引用，但是以下两个 procs 之间的实际区别是什么？

```
set myBigFatGloblVariable "hello"

proc myFirstProc { var1 var2 } {
    upvar 1 $var1 local
    set local [expr $var2 * 3]
}

proc mySecondProc { var2 } {
    global myBigFatGlobalVariable
    set $myBigFatGlobalVariable [expr $var2 * 3]
} 

myFirstProc $myBigFatGlobalVariable 3
mySecondProc 3 
```

在我看来， myFirstProc 会更干净，而且 . 我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T20:49:06.003

它们相似但有细微的不同。

upvar 允许您访问调用堆栈中向上 x 级的变量。它们不一定需要是全局变量。

您可以使用 upvar 通过传递 upvar #0 varName localVarName 来模拟全局在这种情况下，您将获得具有本地名称的全局变量。

要模拟按引用传递，您需要传递变量的名称，然后在该名称上调用 upvar。

如果您知道变量的名称，则可以按原样使用它。

观察以下代码：

```
 # here there is only 1 global variable, but we also need to access to variables defined in the calling functions
    proc p3 {} {
        # upvar defaults to 1, so not needed to put in here
        # also notice you can call upvar on more than one variable
        upvar dog myDog horse myHorse cat myCat
        upvar 2 cow myCow alpha myAlpha
        upvar #0 samurai mySamurai
        puts "Level 1: $myDog $myHorse $myCat"
        puts "Level 2: $myCow $myAlpha"
        puts "Global : $mySamurai"
    }
    proc p2 {} {
        set dog "bowow"
        set horse "niegh"
        set cat "meow"
        p3

    }
    proc p1 {} {
        set cow "moo"
        set alpha "beta"
        p2
    }

    set samurai "japan"
    p1 
```

这返回

```
 Level 1: bowow niegh meow
    Level 2: moo beta
    Global : japan 
```

upvar 只是一种从调用堆栈中获取变量的方法。（调用函数）包括“全局”堆栈。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T11:30:10.007

```
set myBigFatGlobalVariable "hello"

proc myFirstProc { var1 var2 } {
    upvar 1 $var1 local
    set local [expr $var2 * 3] }

proc mySecondProc { var2 } {
    global myBigFatGlobalVariable
    set $myBigFatGlobalVariable [expr $var2 * 3] } 

myFirstProc $myBigFatGlobalVariable 3
mySecondProc 3 
```

您的两个 proc 之间的最大区别在于：myFirstProc 设置**全局**“hello”，mySecondProc 设置**本地**“hello”。

mySecondProc 引用全局 myBigFat... 以获取值“hello”，但不会更改“hello”变量的范围。

myFirstProc 接收值“hello”作为参数，然后在堆栈上一帧名为“hello”的变量和局部变量“local”之间创建链接。设置“本地”具有在堆栈中设置“hello”一帧的效果。

查看：

```
 myFirstProc $myBigFatGlobalVariable 3
puts $hello ;# ==> 9
unset hello
mySecondProc 3
puts $hello ;# ==> can't read "hello": no such variable 
```

如果你真的想从 mySecondProc 设置全局“hello”，你需要添加`global $myBigFatGlobalVariable`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T20:36:38.137

不同之处在于 upvar 1 $var local 使 local 从上一级 $var 中命名的变量中获取其值。所以在 myBigFatGlobalVariable 中 $var 不必在全局范围内定义。

```
proc p1 { var1 } {
upvar 1 $var1 local1
puts $local1
}

proc p2 { } {
set local2 "local2"
p1 local2
}

set global1 "global1"
p1 global1
p2 
```

p1 将在调用堆栈中从它上面的级别 1 打印出 var1 的值。全局始终在顶层定义，因此 upvar #0 与全局执行相同的操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T06:49:52.503

你是说：

> 在这个特定的程序中有很多很多的全局变量

我对中型到超大型 Tcl 应用程序（20k+ 行！）的经验是，使用命名空间将极大地帮助在大量全局变量中获取结构。

好的部分是，您可以在每次为代码创建新模块或重构某些代码时迭代地添加它们。

```
namespace eval module1 {
  variable counter
  variable name
}

namespace eval module2 {
  variable n
  variable names
} 
```

您可以通过 module1::counter 引用它们（就像您可以将全局变量称为 ::counter

有关名称空间的更多信息，请参阅[wiki 名称空间页面](http://wiki.tcl.tk/1489)和有关名称空间的[Tcl 手册页。](http://www.tcl.tk/man/tcl8.5/TclCmd/namespace.htm)

# reporting-services - SSRS 报告查看器控制浏览器兼容性

> ID：596479
> 
> 赞同：12
> 
> 时间：2009-02-27T20:16:52.227
> 
> 标签：reporting-services

MS Report Viewer Control 与 Firefox 和 Safari 等浏览器的兼容性如何？

如果您知道任何 SSRS 的第三方报告查看器，也请发布。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-08-16T08:41:56.597

**编辑 - 2016/2017 更新**

SSRS 2016+可以说是跨浏览器兼容的。
表格边框在 IE10 中无法正确显示，但 IE10 无论如何都会消失。
在其他浏览器中，这很好。

您仍然需要注册`add_pageLoaded`才能翻译参数提示。

```
Sys.WebForms.PageRequestManager.getInstance().add_pageLoaded(function () { fixReportingServices('rpt-container'); }); 
```

此外，就像 < 2016 的版本一样，您需要添加`PageCountMode="Actual"`到`RS:ReportViewerHost`控件。

```
<RS:ReportViewerHost ID="ReportViewerControl" PageCountMode="Actual" runat="server" /> 
```

如果你想有有意义的寻呼号码。

此外，当您使用日期选择器在查询字符串中设置语言时（SSRS < 2016 也是如此），也会出现问题。`context.Request.UserLanguages[i]`如果您希望 datepicker 使用非浏览器语言，则需要设置为 HTTP 模块中 context.BeginRequest 中查询字符串中指定的语言。

此外，如果您想在 Internet 的 iframe 中安全地使用 SSRS，则需要在每个 HTTP 响应中添加 X-Frame-Options 和 Content-Security-Policy HTTP-headers。有关详细信息，请参阅[我的 github 存储库](https://github.com/ststeiger/SSRS-Localizer)。

```
</EndEdit> 
```

2016 年之前：

我可以告诉你，我在这该死的东西上有 9 年的经验（SSRS 2005、SSRS 2008 R1 和 R2、2012 和 SSRS 2014）。

让我向你保证，因为 SSRS HTML 报告依赖于 IE5-Quirksmode，所以它们绝对不可能在 Internet Explorer 以外的任何浏览器中正确呈现（我可能倾向于添加 IE < 10）。

如果您对报表服务器具有管理员访问权限，并且我强调 IF，您可以在 ReportViewer 页面上添加 jQuery 例程和 CSS 来纠正最基本的问题（例如您看不到超过 1 厘米的报表），否则，HTML 渲染看起来仍然非常糟糕（边距、表格边框、图片填充、列大小、文本字段大小、标题和/或页码对齐等，简而言之——几乎任何东西）

当然，ActiveX 打印机控件只能在 InternetExplorer（Windows 上）中工作，因为只有 ActiveX 支持。

让我也向你保证，绝对没有办法让 ReportManager 在 IE 以外的任何其他浏览器中工作。

至于对 Internet Explorer 的支持，应该提到的是，从 IE 版本 10 开始，IE 默认为 webkit-quirksmode（出于兼容性原因）而不是 IE5 quirksmode，因此呈现的 HTML 看起来与在 Chrome/Firefox/Safari 中一样可怕对于 IE 10+，除非您在 ReportViewer.aspx 页面中添加了与 meta xua 兼容的 IE5。

后者可能不适用于 Intranet，因为 IE 在 Intranet 站点上时会自动回退到 IE 7 兼容模式（但仅限于任何 Windows 版本**< 8**）。

在 Windows 8 中，localhost 链接和计算机名链接（无法在 stackoverflow 帖子中添加 http://）未分配给本地 Intranet 区域（可能是快速破解，因此 IE 不会回退到 IE7 兼容模式），并且因此，Windows 身份验证将失败。

还应该提到的是，不能为 ReportManager 添加与 meta xua 兼容的 IE5，因为没有可以编辑的页面（编译后的不可更新的 ASP.NET 网站项目...）。
并且没有使用开发工具在 quirksmode 中切换 reportmanager，因此无法在 IE 10+ 中使用 ReportManager。

然后，要提到的另一件事是，从 IE9 开始，IE 从父页面继承 iframe 元素的 doctype，并且地狱也无法更改它（无需将父页面更改为所需的子页面 doc -模式）。

因此，如果您足够聪明地使用 iframe 进行报告，因为在弹出窗口拦截器时代，任何理智的人都不会想要弹出窗口，因此报告页面将继承父页面的文档类型。如果这不是 IE5-QuirksMode，它将使报告与 Safari/Chrome/Firefox/Opera 上的任何 IE > 8 一样可怕，无论 ReportViewer.aspx 中是否存在任何可能的 meta xua 兼容 ie5 标记。

至于替代方案，免费且具有类似功能集的只有 Eclipse BIRT（幸运的是，HTML 呈现不相似）。

应该提到的是，虽然 BIRT 是根据 Eclipse 公共许可证获得许可的，但它使用 SUN Java，因此您使用的是 Oracle 技术，该技术受其各自许可条款的约束。
此外，您使用的是非 Microsoft 技术，而 Excel-Sheets BIRT 渲染实际上是 XML 文件，在 Office 2010+ 中打开时会产生（谁会猜到）相当惊人的警告。

然后，有相当大的费用，有[http://www.stimulsoft.com](http://www.stimulsoft.com)报告和 Telerik 报告。
从它的技术角度来看，我推荐 stimulsoft 报告，但是：免责声明，我没有使用过其中任何一个，因为它们不是免费的。

至于替代 SSRS 渲染引擎（不是观众顺便说一句），只有 www.fyireporting.com/，这里有一个分支[http://www.codeproject.com/Articles/138271/An-Open-Source-RDL-引擎](http://www.codeproject.com/Articles/138271/An-Open-Source-RDL-Engine)。

但是 fyiReporting 不完整并且正在进行中（如果没有放弃的话），所以我会避免使用它。

底线，如果您的产品仅是 IE 和 Windows，Windows 版本 < 8（并且没有 - 不是 <= 以防万一您没有注意），在 Intranet 中，从弹出窗口而不是 iframe 调用，然后去与 SSRS。
对于其他任何事情，请使用 stimulsoft 报告（问题是，您必须重做所有报告，因为没有自动迁移 - 甚至不是非工作报告）。

**PS：**
通过添加“a little javascript”，我的意思是以下内容（2008 R1 Edition，不适用于 2008R2+，可能适用于 2005，并注意您需要将 jQuery 和 jQuery Migrate 嵌入到 inline-script 标记中，如果客户端 PC 无权访问 http(s)://ajax.aspnetcdn.com [注意：将脚本放入 Pages 文件夹并添加相对或绝对链接将不起作用...]）：

```
<%@ Register TagPrefix="RS" Namespace="Microsoft.ReportingServices.WebServer" Assembly="ReportingServicesWebServer" %>
<%@ Page Language="C#" AutoEventWireup="true" Inherits="Microsoft.ReportingServices.WebServer.ReportViewerPage" %>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<%= System.Web.HttpContext.Current.Request.Browser.Browser == "IE" && System.Globalization.CultureInfo.InvariantCulture.CompareInfo.IndexOf(System.Convert.ToString(System.Web.HttpContext.Current.Request.QueryString), "stylesheet", System.Globalization.CompareOptions.IgnoreCase) == -1 ? (System.Web.HttpContext.Current.Request.Browser.Browser != "IE" ? "": "<meta http-equiv=\"X-UA-Compatible\" content=\"IE=5\">") : "<meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\">" %>

    <head id="headID" runat="server">
    <title>Report Viewer</title>

    <script type="text/javascript" src="//ajax.aspnetcdn.com/ajax/jQuery/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="//ajax.aspnetcdn.com/ajax/jquery.migrate/jquery-migrate-1.1.0.min.js"></script>

    <script type="text/javascript">

        var bInFrameOrIframe = false;
        var iLanguageIndex = 0;
        var language = "DE_LOL";
        var UpdateLock = false;

        if (window.self === window.top) {
            // alert("true");
            // not in a frame 
            // Use IE5 quirksmode 
            //document.writeln('<meta http-equiv="X-UA-Compatible" content="IE=5" />');
            bInFrameOrIframe = false
        }
        else {
            // in a frame, FMS
            bInFrameOrIframe = true;
        }

        function TranslateParameterPrompts() {

            //mTo = false;
            $("table[id^='ParametersGridReportViewerControl'] span").each(function(index) {
                var strText = $(this).text();
                if (strText != null && strText.indexOf('/') != -1) {
                    strText = strText.split('/');
                    if (iLanguageIndex < strText.length)
                        strText = strText[iLanguageIndex];
                    else {
                        if (strText.length > 0)
                            strText = strText[0];
                    }

                    $(this).text(strText);
                }

            });

            //setTimeout(function(){mTo = true}, 5000);
        }

        function setTableSize() {
            //$("[id$='ReportViewerControl']")
            $(
                $(
                    $("#ReportFrameReportViewerControl")[0].contentWindow.document
                )
                .find("[id$='report']")[0].contentWindow.document.body
            ).find('*')
            .each(function() {
                //console.log("Processing an element");
            //var cls = $(this).attr("class");

            try {

                    // Don't add a border to sort-arrow
                    if ($(this).is('img')) {
                        return;
                    }

                    var anywidth = $(this).css('width');
                    var anywidth = parseFloat(anywidth);
                    //console.log("anywidth: " + anywidth);

                    //var lol = $(this).css('borderLeftWidth');
                    var blw = $(this).css('border-left-width');
                    var brw = $(this).css('border-right-width');
                    var btw = $(this).css('border-top-width');
                    var bbw = $(this).css('border-bottom-width');

                    var borls = $(this).css('border-left-style') == "solid";
                    var borrs = $(this).css('border-right-style') == "solid";
                    var borts = $(this).css('border-top-style') == "solid";
                    var borbs = $(this).css('border-bottom-style') == "solid";

                    var blw = parseFloat(blw);
                    var brw = parseFloat(brw);
                    var btw = parseFloat(btw);
                    var bbw = parseFloat(bbw);

                    //parseInt($(this).css("borderRightWidth"))
                    //console.log(parseInt($(this).css("borderLeftWidth")));

                    UpdateLock = true;

                    // Set width to 1px where 0px
                    if (anywidth == 0)
                        $(this).css('width', '1px');

                    if (borls && blw == 0.0 || (blw > 0.0 && blw < 1.0)) {
                        //console.log("setting border width");
                        $(this).css('border-left-width', '1px');
                    }

                    if (borrs && brw == 0.0 || (brw > 0.0 && brw < 1.0)) {
                        $(this).css('border-right-width', '1px');
                    }

                    if (borts && btw == 0.0 || (btw > 0.0 && btw < 1.0)) {
                        $(this).css('border-top-width', '1px');
                    }

                    if (borbs && bbw == 0.0 || (bbw > 0.0 && bbw < 1.0)) {
                        $(this).css('border-bottom-width', '1px');
                    }

                    UpdateLock = false;
                }
                catch (ex) {
                    UpdateLock = false;
                    //console.log(ex);
                }

            });             // End $('*').each

            // console.log("loop");

            var $img = $("img[onload^='this.fitproportional=true']");
            if ($img == null) {
                // console.log("img is null");
                return;
            }
            var $div = $img.parent();
            if ($div == null) {
                // console.log("div is null");
                return;
            }

            UpdateLock = true;
            {
                $img.removeAttr("height");
                $img.css('max-width', '100%')
                $img.css('max-height', '100%')

                $div.css('text-align', 'right');

                var divMinWidth = parseFloat($div.css('min-width'));
                var divWidth = parseFloat($div.css('width'));

                var divMinHeight = parseFloat($div.css('min-height'));
                var divHeight = parseFloat($div.css('height'));

                // console.log("width: " + divWidth);
                // console.log("height: " + divHeight);
                // console.log("min-width: " + divMinWidth);
                // console.log("min-height: " + divMinHeight);

                if (divMinWidth != 0)
                    $div.css('width', $div.css('min-width'));

                if (divMinHeight != 0)
                    $div.css('height', $div.css('min-height'));

            }
            UpdateLock = false;

        }

        $(document).ready(function() {

            switch (language) {
                case "fr":
                    iLanguageIndex = 1;
                    break;
                case "it":
                    iLanguageIndex = 2;
                    break;
                case "en":
                    iLanguageIndex = 3;
                    break;
                default: // "DE" 
                    iLanguageIndex = 0;
            }

            TranslateParameterPrompts();
            // setInterval(function() { TranslateParameterPrompts() }, 100);

            if ($.browser.msie && !bInFrameOrIframe)
                return;

            // if ($.browser.webkit)
            //setTableSize();

            $("[id$='ReportFrameReportViewerControl']").load(function() {
                //setNewHeight();
                //alert("Loading");

                setTableSize();

                $(
                    $("[id$='ReportFrameReportViewerControl']")[0].contentWindow.document
                )
                .find("[id$='report']").load(function() {
                    //alert("load report");
                    setTableSize();
                }
                ); // End load #report

            }); // End Function load #ReportFrameReportViewerControl

        });    // End Function document.ready

    </script>

</head>
<body style="margin: 0px; overflow: auto">
    <form style="width:100%;height:100%" runat="server" ID="ReportViewerForm">
        <RS:ReportViewerHost ID="ReportViewerControl" runat="server" />
    </form>
</body>
</html> 
```

注意：UpdateLock 源于 2012 年的反向移植，此处并未真正使用，语言也源于反向移植，2012 年需要 TranslateParameterPrompts 上的 setInterval，2012 年的函数仅在 jQuery 选择器中添加了少量“标签”...

```
 function TranslateParameterPrompts() {

        //mTo = false;
        $("table[id^='ParametersGridReportViewerControl'] label span").each(function(index) {
            var strText = $(this).text();
            if (strText != null && strText.indexOf('/') != -1) {
                strText = strText.split('/');
                if (iLanguageIndex < strText.length)
                    strText = strText[iLanguageIndex];
                else 
                { 
                    if(strText.length > 0)
                        strText = strText[0];
                }

                $(this).text(strText);
            }

        });

        //setTimeout(function(){mTo = true}, 5000);
    } 
```

从浏览器语言推断语言是这样的，顺便说一句：

```
<script type="text/javascript">
    language = <%= System.Web.HttpContext.Current.Request.UserLanguages != null ? "\"" + System.Convert.ToString(System.Web.HttpContext.Current.Request.UserLanguages[0]) + "\"" : "null" %>;

    if(language == null)
        language = window.navigator.userLanguage || window.navigator.language;

    if(language != null)
        language = language.substr(0,2).toLowerCase();

</script> 
```

并且在 2012 年您需要处理会话 cookie，否则在打开大约 120 个报告后您会得到“HTTP 400: Header too long”：

```
<script type="text/C#" runat="server">
protected string ClearSessionKeepAliveCookiesToPreventHttp400HeaderTooLong()
{
    if(Request == null || Request.Cookies == null)
        return "";

    if(Request.Cookies.Count < 60)
        return "";

    // System.Web.HttpContext.Current.Response.Write("<h1>"+Request.Cookies.Count.ToString()+"</h1>");
    for(int i = 0; i < System.Web.HttpContext.Current.Request.Cookies.Count; ++i)
    {
        if(StringComparer.OrdinalIgnoreCase.Equals(Request.Cookies[i].Name, System.Web.Security.FormsAuthentication.FormsCookieName))
            continue;

        if(!Request.Cookies[i].Name.EndsWith("_SKA", System.StringComparison.OrdinalIgnoreCase))
            continue;

        if(i > 60)
            break;

        //System.Web.HttpContext.Current.Response.Write("<h1>"+Request.Cookies[i].Name+"</h1>");

        System.Web.HttpCookie c = new System.Web.HttpCookie( Request.Cookies[i].Name );
        //c.Expires = System.DateTime.Now.AddDays( -1 );
        c.Expires = new System.DateTime(1970, 1 ,1);
        c.Path = Request.ApplicationPath + "/Pages";
        c.Secure = false;
        c.HttpOnly = true;

        // http://stackoverflow.com/questions/5517273/httpcookiecollection-add-vs-httpcookiecollection-set-does-the-request-cookies
        //Response.Cookies[Request.Cookies[i].Name] = c;
        //Response.Cookies.Add(c);
        Response.Cookies.Set(c);
    }

    return "";
}

</script> 
```

而在2012年，你需要收听内容更新，因为它使用了微软的Ajax控件

```
function cbOnContentUpdate() {
    //console.log("content update");
    alterTableBorderWidth();
    // TranslateParameterPrompts();
} // End Callback cbOnContentUpdate

var hLastTimeout = null;

function queueUpdate() {

    if (UpdateLock)
        return;

    if (hLastTimeout != null)
        clearTimeout(hLastTimeout);

    hLastTimeout = window.setTimeout(function() { cbOnContentUpdate(); }, 50);

    //window.setTimeout(function() { cbOnContentUpdate(); }, 3000);
} // End Function queueUpdate

$(document).ready(function() {

    switch (language) {
        case "fr":
            iLanguageIndex = 1;
            break;
        case "it":
            iLanguageIndex = 2;
            break;
        case "en":
            iLanguageIndex = 3;
            break;
        default: // "DE" 
            iLanguageIndex = 0;
    }

    setInterval(function() { TranslateParameterPrompts() }, 100);

    // opt-out for non-framed IE, because that crook supports IE5-Quirks (framed takes parent-doctype in IE >= 9)
    if ($.browser.msie && !areWeInFrame())
        return;

    // if ($.browser.webkit)

    // console.log('Setting event listener!');

    // http://stackoverflow.com/questions/4979738/fire-jquery-event-on-div-change
    //$("[id$='ReportViewerControl']").bind('DOMNodeInserted DOMNodeRemoved', function(event) {
    //$("[id$='ReportArea']")
    $("body")
     .bind('DOMNodeInserted DOMNodeRemoved DOMSubtreeModified', function(event) {

         if (event.type == 'DOMNodeInserted') {
             //console.log('Content added! Current content:' + '\n\n' + this.innerHTML);
             //console.log('Content added!');
             queueUpdate();
         }
         else {
             //console.log('Content removed! Current content:' + '\n\n' + this.innerHTML);
             //console.log('Content removed!');
             queueUpdate();
         }
     }); // End Bind IRM

});   // End Function $(document).ready 
```

请注意，对于 2012 年，setTableSize 是 alterTableBorderWidth，选择器如下所示：

```
 function alterTableBorderWidth() 
        {
            //$('*')
            $("[id$='ReportViewerControl']").find('*')
            .each(function() { 
```

顺便说一句，如果你想删除 PRINT 图标，因为它只是一个悲伤的来源，就像这样（德语、英语、法语和意大利语 [瑞士使用的语言 + 英语]）。

这个CSS是给2008 R1用的，不知道2012是不是一样。

```
input[type="image"][title="Drucken"], input[type="image"][title="Print"], input[type="image"][title="Imprimer"], input[type="image"][title="Stampa"]
{
    display: none !important;
} 
```

如果这仍然不能阻止您，那么请继续并在 SSRS 2012 中使用表单身份验证（提示 1：没有 ms-provied 示例，如 2005-2008R2，您需要自己编写）；）

提示 2：如果您遵循提示 1，当 URL [错误？] 中有冒号时，表单身份验证重定向不起作用，您可以从 mono 中窃取代码并编写自己的重定向。

提示 3：如果您遵循提示 2 并获得表单身份验证工作，那么您可能想要更改您要编写的上传工具，因为您不喜欢手动执行“为每个报告浏览目录 - 选中允许覆盖复选框 -上传报告 - 设置数据源）大约 120 个报告，那么您将从 ReportingService2005 继承一个类并覆盖 GetWebRequest 和 GetWebResponse

```
''' <summary>
''' Overriding the method defined in the base class.
''' </summary>
''' <param name="uri"></param>
''' <returns></returns>
Protected Overrides Function GetWebRequest(uri As Uri) As System.Net.WebRequest
    Dim request As System.Net.HttpWebRequest
    request = DirectCast(System.Net.HttpWebRequest.Create(uri), System.Net.HttpWebRequest)
    request.Credentials = MyBase.Credentials
    request.CookieContainer = New System.Net.CookieContainer()

    If m_authCookie IsNot Nothing Then
        request.CookieContainer.Add(m_authCookie)
    End If

    Return request
End Function ' GetWebRequest 

''' <summary>
''' Overriding the method defined in the base class.
''' </summary>
''' <param name="request"></param>
''' <returns></returns>
Protected Overrides Function GetWebResponse(request As System.Net.WebRequest) As System.Net.WebResponse
    Dim response As System.Net.WebResponse = MyBase.GetWebResponse(request)

    ' http://social.msdn.microsoft.com/Forums/sqlserver/en-US/f68c3f2f-c498-4566-8ba4-ffd5070b8f7f/problem-with-ssrs-forms-authentication
    Dim cookieName As String = response.Headers("RSAuthenticationHeader")
    If cookieName IsNot Nothing Then
        m_authCookieName = cookieName
        Dim webResponse As System.Net.HttpWebResponse = DirectCast(response, System.Net.HttpWebResponse)
        Dim authCookie As System.Net.Cookie = webResponse.Cookies(cookieName)

        ' Save it for future reference and use.
        m_authCookie = authCookie
    End If

    Return response
End Function ' GetWebResponse 
```

提示 4：如果您尚未在 SSRS 2008 R2 上安装 Service Pack 1 + 2，上述方法将不起作用...

提示 5：存在 TranslateParameters 方法是因为您无法（通过设计）通过 SSRS 将参数提示翻译成多种语言，因此您编写：

```
Raum / Local / Locale / Room 
```

它使用模式：

```
Text_DE / Text_FR / Text_IT / Text_EN 
```

然后在文本上用'/'分割（如果提示文本在某处包含'/'，这很容易出错），然后通过选择MIN（splitarray.length，index）按语言索引选择正确的文本) 顺便说一句，以防万一您只有 Text_DE / Text_FR 或其他什么，当然，首先检查文本是否包含“/”。

提示 6：我需要继续吗？（我仍然可以将这篇文章扩大到十倍，但我想我现在应该回去工作了 :)）

如果您想看看它的外观如何，这就是 vanilla ssrs 在 chrome 中呈现的方式

![香草 SSRS 镀铬](https://i.stack.imgur.com/OoN0K.png)

这是它在 IE11 中的样子，通过 xua 设置 IE5 兼容性

![盖布](https://i.stack.imgur.com/pIsLR.png)

这就是它应该的样子，你可以通过大量修改 javascript 和 CSS 来渲染它 ![应用了 CSS 和 JS 的 Chrome 中的 SSRS](https://i.stack.imgur.com/ai4xM.png)

**附录：**
哦，它变得更好了

如果要以应用程序指定的语言（与浏览器语言不同）运行 reportviewer，则需要将 reportviewer 的文化设置为查询字符串中指定的文化...

```
<script type="text/C#" runat="server">
    protected override void InitializeCulture()
    {
        string sprache = System.Web.HttpContext.Current.Request.QueryString["in_sprache"];

        // System.Web.HttpContext.Current.Response.Write(sprache);

        switch(System.Globalization.CultureInfo.InvariantCulture.TextInfo.ToLower(sprache))
        {
            case "fr":
                sprache = "fr-CH";
                break;
            case "it":
                sprache = "it-CH";
                break;
            case "en":
                sprache = "en-US";
                break;
            default:
                sprache = "de-CH";
                break;
        }

        // System.Web.HttpContext.Current.Response.Write(sprache);

        System.Threading.Thread.CurrentThread.CurrentCulture = System.Globalization.CultureInfo.CreateSpecificCulture(sprache);
        System.Threading.Thread.CurrentThread.CurrentUICulture = new System.Globalization.CultureInfo(sprache);
        base.InitializeCulture();
    }

</script> 
```

如果要设置静态文化，可以在页面声明中进行

```
<%@ Page UICulture="de" Culture="de-CH" %> 
```

而且，如果您尝试删除打印图标和原子提要，使用样式进行操作，无论如何，它仅适用于 Chrome...

```
 input[type="image"][title="Drucken"], input[type="image"][title="Print"],    input[type="image"][title="Imprimer"], input[type="image"][title="Stampa"]
    {
        display: none !important;
    }

    input[type="image"][title="In Datenfeed exportieren"], input[type="image"][title="Exporter vers un flux de données"], input[type="image"][title="Esporta in feed di dati"], input[type="image"][title="Export to Data Feed"]
    {
        display: none !important;
    }
    */
    input[type="image"][src$="Microsoft.Reporting.WebForms.Icons.Print.gif"] {
        display: none !important;
    }

    input[type="image"][src$="Microsoft.Reporting.WebForms.Icons.AtomDataFeed.gif"] {
        display: none !important;
    } 
```

`ShowPrintButton="false"`但是您实际上可以通过添加到 reportviewer 控件来至少删除 internet-explorer 中的打印图标：

```
<RS:ReportViewerHost ID="ReportViewerControl" ShowPrintButton="false" runat="server" /> 
```

另一个想法：在 SSRS 2012 和 2014（可能还有 2008R2）中，您还可以将修复 SSRS 的 javaScript 方法添加到 ScriptManager 的 add_pageLoaded 中。像这样：

```
Sys.WebForms.PageRequestManager.getInstance().add_pageLoaded(function () { fixReportingServices('rpt-container'); }); 
```

这样你就不必监听页面更改事件，这会加快速度，因为在每次更新结束时，loaded 只会被调用一次。

# 警告

因为在 Internet 中，IE 并不默认为兼容性视图，

```
<meta http-equiv="X-UA-Compatible" content="IE=5"> 
```

也不会帮助您解决某些问题（rotate270 文本/垂直文本）。

即使在 IE 中，它也只有在内网时才能正常工作，因为只有这样它才会使用“兼容性视图”。虽然元标记将浏览器设置为 IE5-Quirksmode，但它并没有启用“兼容性视图”，所以它不是真正的 quirksmode...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-25T06:01:16.807

MS Report Viewer Control 只能在 IE 中正常工作。您可以从其他浏览器查看报告，但无法查看缩放选项

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-02T11:55:29.477

有关浏览器兼容性和 ReportViewer 控件的信息，请参阅以下 MSDN 文章：

*   [ReportViewer Web 服务器控件的浏览器支持](http://msdn.microsoft.com/en-us/library/ms251673.aspx)
*   [Reporting Services 中的浏览器支持](http://technet.microsoft.com/en-us/library/ms156511%28SQL.90%29.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-28T01:11:41.447

SSRS works perfectly on IE6,7,8\. It works on Firefox and Safari, but with displaying issues.

There are two possible solutions to fix those, test and see whichever works for you.

**Solution 1**

Go to

> C:\Program Files\Microsoft SQL Server\MSSQL.(your report server instance)\Reporting Services\ReportServer\Pages\reportviewer.aspx

Update style as

> ```
> <body style="margin: 0px; overflow: auto"> ... <RS:ReportViewerHost style="display:table;" ID="ReportViewerControl" runat="server" /> 
> ```

**Solution 2**

Add following changes to stylesheet:

> .DocMapAndReportFrame { min-height: 660px; min-width: 1280px; }
> .MenuBarBkGnd { min-width:1000px; }

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T20:25:07.183

我没有注意到它在 Firefox 或 Safari 中显示的任何实际问题。有时我认为它在 Firefox 中可能会变得更好，但我没有任何实际的基准来支持这一点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-27T20:26:40.627

从臀部，也许有点陈旧。ASP.NET 曾经将任何非 IE 浏览器视为一盒石头。如果您遇到问题，可能值得研究。

[http://weblogs.asp.net/fmarguerie/archive/2005/01/04/346222.aspx](http://weblogs.asp.net/fmarguerie/archive/2005/01/04/346222.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-01-09T22:13:49.913

Firefox、Chrome 和 Safari 存在渲染问题。我知道对于 Firefox 和 Chrome，有 IE 插件允许您在 Firefox/Chrome 选项卡中运行报告。

# javascript - 是否可以以编程方式模拟按键事件？

> ID：596481
> 
> 赞同：491
> 
> 时间：2009-02-27T20:17:12.273
> 
> 标签：javascript, dom-events

是否可以在 JavaScript 中以编程方式模拟按键事件？

* * *

## 回答 #1

> 赞同：220
> 
> 时间：2012-08-29T22:18:11.157

适用于 webkit 和 gecko 的非 jquery 版本：

```
var keyboardEvent = document.createEvent('KeyboardEvent');
var initMethod = typeof keyboardEvent.initKeyboardEvent !== 'undefined' ? 'initKeyboardEvent' : 'initKeyEvent';

keyboardEvent[initMethod](
  'keydown', // event type: keydown, keyup, keypress
  true, // bubbles
  true, // cancelable
  window, // view: should be window
  false, // ctrlKey
  false, // altKey
  false, // shiftKey
  false, // metaKey
  40, // keyCode: unsigned long - the virtual key code, else 0
  0, // charCode: unsigned long - the Unicode character associated with the depressed key, else 0
);
document.dispatchEvent(keyboardEvent);
```

* * *

## 回答 #2

> 赞同：89
> 
> 时间：2017-05-25T22:40:29.213

[您可以像这样在EventTarget](https://developer.mozilla.org/en-US/docs/Web/API/EventTarget)（元素、窗口、文档等）上分派键盘事件：

```
element.dispatchEvent(new KeyboardEvent('keydown', {'key': 'a'})); 
```

* * *

但是，`dispatchEvent`可能不会更新输入字段值，并且可能不会触发常规键盘按下的行为，可能是因为[Event.isTrusted](https://developer.mozilla.org/en-US/docs/Web/API/Event/isTrusted)属性，我不知道是否有办法绕过

但是您也可以通过设置输入来更改输入`value`。

```
element.value += "a"; 
```

* * *

**例子：**

```
let element = document.querySelector('input');
element.onkeydown = e => alert(e.key);
changeValButton.onclick = () => element.value += "a";
dispatchButton.onclick = () => {
   element.dispatchEvent(new KeyboardEvent('keydown', {'key': 'a'}));
}
```

```
<input/>
<button id="dispatchButton">Press to dispatch event </button>
<button id="changeValButton">Press to change value </button>
```

* * *

您可以根据需要向事件添加更多属性，如[本答案所示](https://stackoverflow.com/a/59113178/3577695)。查看[KeyboardEvent 文档](https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent)

```
element.dispatchEvent(new KeyboardEvent("keydown", {
    key: "e",
    keyCode: 69, // example values.
    code: "KeyE", // put everything you need in this object.
    which: 69,
    shiftKey: false, // you don't need to include values
    ctrlKey: false,  // if you aren't going to use them.
    metaKey: false   // these are here for example's sake.
})); 
```

此外，由于`keypress`已[弃用](https://developer.mozilla.org/en-US/docs/Web/Events/keypress)，您可以使用`keydown`+ `keyup`，例如：

```
element.dispatchEvent(new KeyboardEvent('keydown', {'key':'Shift'} ));
element.dispatchEvent(new KeyboardEvent( 'keyup' , {'key':'Shift'} )); 
```

* * *

## 回答 #3

> 赞同：79
> 
> 时间：2009-02-27T20:36:55.923

如果您可以使用 jQuery 1.3.1：

```
function simulateKeyPress(character) {
  jQuery.event.trigger({
    type: 'keypress',
    which: character.charCodeAt(0)
  });
}

$(function() {
  $('body').keypress(function(e) {
    alert(e.which);
  });
  simulateKeyPress("e");
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.3.1/jquery.min.js">
</script>
```

* * *

## 回答 #4

> 赞同：59
> 
> 时间：2013-11-09T22:20:29.583

您可以做的是通过触发*keyevents以编程方式触发**keyevent 侦听*器。从沙盒安全的角度来看，允许这样做是有意义的。使用此功能，您可以应用典型的[观察者模式](http://en.wikipedia.org/wiki/Observer_pattern)。您可以将此方法称为“模拟”。

 *下面是如何在 W3C DOM 标准和 jQuery 中完成此操作的示例：

```
function triggerClick() {
  var event = new MouseEvent('click', {
    'view': window,
    'bubbles': true,
    'cancelable': true
  });
  var cb = document.querySelector('input[type=submit][name=btnK]'); 
  var canceled = !cb.dispatchEvent(event);
  if (canceled) {
    // preventDefault was called and the event cancelled
  } else {
    // insert your event-logic here...
  }
} 
```

本示例改编自：[https ://developer.mozilla.org/en-US/docs/Web/Guide/Events/Creating_and_triggering_events](https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Creating_and_triggering_events)

在 jQuery 中：

```
jQuery('input[type=submit][name=btnK]')
  .trigger({
    type: 'keypress',
    which: character.charCodeAt(0 /*the key to trigger*/)      
   }); 
```

**但是直到最近，还没有 [DOM] 方法可以真正触发离开浏览器沙箱的键事件。**所有主要的浏览器供应商都将坚持这一安全理念。

至于像 Adob​​e Flash 这样基于 NPAPI 并允许绕过沙箱的插件：这些是[逐步淘汰的](http://blog.chromium.org/2013/09/saying-goodbye-to-our-old-friend-npapi.html)；[火狐](http://blog.mozilla.org/futurereleases/2013/09/24/plugin-activation-in-firefox/)。

**详细说明：**

出于安全原因，您不能也不能（正如 Pekka 已经指出的那样）。您将始终需要在两者之间进行用户交互。另外想象一下浏览器供应商被用户起诉的可能性，因为各种程序化键盘事件将导致欺骗攻击。

有关替代方案和更多详细信息，请参阅此[帖子](http://www.lsauer.com/2012/05/javascript-copy-text-to-clipboard.html)。总是有基于闪存的复制和粘贴。这是一个优雅的 [例子](http://www.colorzilla.com/gradient-editor/)。同时，这也证明了网络正在远离插件供应商的原因。

[在选择加入 CORS 策略](http://www.lsauer.com/2013/11/understanding-access-control-allow.html)以编程方式访问远程内容的情况下，应用了类似的安全思维方式。

答案是：
**一般情况下，沙盒浏览器环境下是没有办法通过编程方式触发输入键的**。

**底线：**我并不是说在特殊的浏览器模式和/或游戏最终目标的特权或类似的用户体验下，这在未来是不可能的。但是，在进入此类模式之前，会要求用户提供权限和风险，类似于[全屏 API 模型](https://www.google.at/search?client=opera&q=w3c%20fullscreen%20api%20permission)。

**有用：**在 KeyCodes 的上下文中，[这个](http://www.lsauer.com/2011/08/javascript-keymap-keycodes-in-json.html)工具和键码映射会派上用场。

*披露：*答案基于[此处](https://stackoverflow.com/questions/8668192/programmatically-triggering-ctrls/19882728#19882728)的答案。

* * *

## 回答 #5

> 赞同：39
> 
> 时间：2019-11-30T04:20:59.747

截至 2019 年，此解决方案对我有用：

```
document.dispatchEvent(
  new KeyboardEvent("keydown", {
    key: "e",
    keyCode: 69, // example values.
    code: "KeyE", // put everything you need in this object.
    which: 69,
    shiftKey: false, // you don't need to include values
    ctrlKey: false,  // if you aren't going to use them.
    metaKey: false   // these are here for example's sake.
  })
); 
```

我在我的浏览器游戏中使用了它，以支持带有模拟键盘的移动设备。

**澄清：**此代码调度单个`keydown`事件，而真正的按键按下将触发一个`keydown`事件（如果按住时间较长，则触发几个事件），然后`keyup`在您释放该键时触发一个事件。如果您也需要`keyup`事件，也可以`keyup`通过更改代码片段`"keydown"`来模拟事件。`"keyup"`

这也将事件发送到整个网页，因此`document`. 如果您只希望特定元素接收事件，则可以替换`document`所需元素。

* * *

## 回答 #6

> 赞同：29
> 
> 时间：2009-05-08T12:44:24.403

您可以使用`dispatchEvent()`：

```
function simulateKeyPress() {
  var evt = document.createEvent("KeyboardEvent");
  evt.initKeyboardEvent("keypress", true, true, window,
                    0, 0, 0, 0,
                    0, "e".charCodeAt(0))
  var body = document.body;
  var canceled = !body.dispatchEvent(evt);
  if(canceled) {
    // A handler called preventDefault
    alert("canceled");
  } else {
    // None of the handlers called preventDefault
    alert("not canceled");
  }
} 
```

我没有对此进行测试，但它改编自[dispatchEvent() 文档](https://developer.mozilla.org/en/DOM/element.dispatchEvent)中的代码。您可能想要通读它，以及 createEvent() 和 initKeyEvent() 的文档。

* * *

## 回答 #7

> 赞同：27
> 
> 时间：2013-07-04T17:28:48.227

您可以创建和调度键盘事件，它们将触发适当的已注册事件处理程序，但它们**不会产生任何 text**，例如，如果调度到输入元素。

要完全模拟文本输入，您需要生成一系列键盘事件并显式设置输入元素的文本。事件的顺序取决于您想要模拟文本输入的彻底程度。

最简单的形式是：

```
$('input').val('123');
$('input').change(); 
```

* * *

## 回答 #8

> 赞同：17
> 
> 时间：2017-11-23T11:55:24.270

在某些情况下`keypress`，事件无法提供所需的功能。从[mozilla 文档](https://developer.mozilla.org/en-US/docs/Web/API/Document/keypress_event)中我们可以看到该功能已被弃用：

> 不再推荐此功能。尽管某些浏览器可能仍然支持它，但它可能已经从相关的 Web 标准中删除，可能正在被删除，或者可能仅出于兼容性目的而保留。避免使用它，并尽可能更新现有代码；请参阅本页底部的兼容性表以指导您的决定。请注意，此功能可能随时停止工作。

因此，由于该`keypress`事件是由两个因此触发的事件组合而成，并且对于相同的键`keydown`跟随它，因此只需一个接一个地生成事件：`keyup`

```
element.dispatchEvent(new KeyboardEvent('keydown',{'key':'Shift'}));
element.dispatchEvent(new KeyboardEvent('keyup',{'key':'Shift'})); 
```

* * *

## 回答 #9

> 赞同：15
> 
> 时间：2011-10-02T15:11:25.297

基于 alex2k8 的答案，这是一个适用于 jQuery 支持的所有浏览器的修订版本（问题在于缺少 jQuery.event.trigger 的参数，使用该内部函数时很容易忘记）。

```
// jQuery plugin. Called on a jQuery object, not directly.
jQuery.fn.simulateKeyPress = function (character) {
  // Internally calls jQuery.event.trigger with arguments (Event, data, elem).
  // That last argument, 'elem', is very important!
  jQuery(this).trigger({ type: 'keypress', which: character.charCodeAt(0) });
};

jQuery(function ($) {
  // Bind event handler
  $('body').keypress(function (e) {
    alert(String.fromCharCode(e.which));
    console.log(e);
  });
  // Simulate the key press
  $('body').simulateKeyPress('x');
}); 
```

您甚至可以进一步推动它，让它不仅模拟事件，而且实际插入字符（如果它是输入元素），但是在尝试这样做时有很多跨浏览器陷阱。最好使用更复杂的插件，例如[SendKeys](http://bililite.com/blog/2008/08/20/the-fnsendkeys-plugin/)。

* * *

## 回答 #10

> 赞同：13
> 
> 时间：2014-05-30T22:40:40.870

对于那些感兴趣的人，您实际上可以可靠地重新创建键盘输入事件。为了更改输入区域中的文本（移动光标或通过输入字符移动页面），您必须密切遵循 DOM 事件模型：http: [//www.w3.org/TR/DOM-Level-3-Events/ #h4_events-inputevents](http://www.w3.org/TR/DOM-Level-3-Events/#h4_events-inputevents)

模型应该做：

*   焦点（在具有目标集的 DOM 上调度）

然后对于每个字符：

*   keydown（在 DOM 上调度）
*   beforeinput（如果它是文本区域或输入，则在目标处调度）
*   keypress（在 DOM 上调度）
*   输入（如果它是文本区域或输入，则在目标处调度）
*   更改（如果选择，则在目标处调度）
*   keyup（在 DOM 上调度）

然后，对于大多数人来说，可选：

*   模糊（在带有目标集的 DOM 上调度）

这实际上通过 javascript 更改页面中的文本（不修改 value 语句）并适当地触发任何 javascript 侦听器/处理程序。如果你弄乱了序列，javascript 将不会以适当的顺序触发，输入框中的文本不会改变，选择不会改变或光标不会移动到文本区域中的下一个空间。

不幸的是，代码是根据 NDA 为雇主编写的，所以我不能分享它，但这绝对是可能的，但您必须以正确的顺序为每个元素重新创建整个键输入“堆栈”。

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2015-12-04T19:00:05.020

只需使用 CustomEvent

```
Node.prototype.fire=function(type,options){
     var event=new CustomEvent(type);
     for(var p in options){
         event[p]=options[p];
     }
     this.dispatchEvent(event);
} 
```

4 ex想模拟ctrl+z

```
window.addEventListener("keyup",function(ev){
     if(ev.ctrlKey && ev.keyCode === 90) console.log(ev); // or do smth
     })

 document.fire("keyup",{ctrlKey:true,keyCode:90,bubbles:true}) 
```

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2013-05-22T07:32:03.427

这种方法支持跨浏览器更改**key code**的值。 [资源](http://bresleveloper.blogspot.co.il/2013/03/jsjq-simulate-enter-event.html)

```
var $textBox = $("#myTextBox");

var press = jQuery.Event("keypress");
press.altGraphKey = false;
press.altKey = false;
press.bubbles = true;
press.cancelBubble = false;
press.cancelable = true;
press.charCode = 13;
press.clipboardData = undefined;
press.ctrlKey = false;
press.currentTarget = $textBox[0];
press.defaultPrevented = false;
press.detail = 0;
press.eventPhase = 2;
press.keyCode = 13;
press.keyIdentifier = "";
press.keyLocation = 0;
press.layerX = 0;
press.layerY = 0;
press.metaKey = false;
press.pageX = 0;
press.pageY = 0;
press.returnValue = true;
press.shiftKey = false;
press.srcElement = $textBox[0];
press.target = $textBox[0];
press.type = "keypress";
press.view = Window;
press.which = 13;

$textBox.trigger(press); 
```

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2020-03-17T23:13:21.283

我想模拟“Tab”按下...扩展[Trevor 的答案](https://stackoverflow.com/a/23964375/3577695)，我们可以看到像“tab”这样的特殊键确实被按下，但我们看不到“tab”按下的实际结果.. .

尝试为“activeElement”以及全局文档对象调度这些事件 - 下面添加了两者的代码；

**下面的片段**：

```
var element = document.getElementById("firstInput");

document.addEventListener("keydown", function(event) {

  console.log('we got key:', event.key, '  keyCode:', event.keyCode, '  charCode:', event.charCode);

  /* enter is pressed */
  if (event.keyCode == 13) {
    console.log('enter pressed:', event);

    setTimeout(function() {
      /*  event.keyCode = 13;  event.target.value += 'b';  */

      theKey = 'Tab';
      var e = new window.KeyboardEvent('focus', {
        bubbles: true,
        key: theKey,
        keyCode: 9,
        charCode: 0,
      });
      document.activeElement.dispatchEvent(e);
      e = new window.KeyboardEvent('keydown', {
        bubbles: true,
        key: theKey,
        keyCode: 9,
        charCode: 0,
      });
      document.activeElement.dispatchEvent(e);
      e = new window.KeyboardEvent('beforeinput', {
        bubbles: true,
        key: theKey,
        keyCode: 9,
        charCode: 0,
      });
      document.activeElement.dispatchEvent(e);
      e = new window.KeyboardEvent('keypress', {
        bubbles: true,
        key: theKey,
        keyCode: 9,
        charCode: 0,
      });
      document.activeElement.dispatchEvent(e);
      e = new window.KeyboardEvent('input', {
        bubbles: true,
        key: theKey,
        keyCode: 9,
        charCode: 0,
      });
      document.activeElement.dispatchEvent(e);
      e = new window.KeyboardEvent('change', {
        bubbles: true,
        key: theKey,
        keyCode: 9,
        charCode: 0,
      });
      document.activeElement.dispatchEvent(e);
      e = new window.KeyboardEvent('keyup', {
        bubbles: true,
        key: theKey,
        keyCode: 9,
        charCode: 0,
      });
      document.activeElement.dispatchEvent(e);
    }, 4);

    setTimeout(function() {
      theKey = 'Tab';
      var e = new window.KeyboardEvent('focus', {
        bubbles: true,
        key: theKey,
        keyCode: 9,
        charCode: 0,
      });
      document.dispatchEvent(e);
      e = new window.KeyboardEvent('keydown', {
        bubbles: true,
        key: theKey,
        keyCode: 9,
        charCode: 0,
      });
      document.dispatchEvent(e);
      e = new window.KeyboardEvent('beforeinput', {
        bubbles: true,
        key: theKey,
        keyCode: 9,
        charCode: 0,
      });
      document.dispatchEvent(e);
      e = new window.KeyboardEvent('keypress', {
        bubbles: true,
        key: theKey,
        keyCode: 9,
        charCode: 0,
      });
      document.dispatchEvent(e);
      e = new window.KeyboardEvent('input', {
        bubbles: true,
        key: theKey,
        keyCode: 9,
        charCode: 0,
      });
      document.dispatchEvent(e);
      e = new window.KeyboardEvent('change', {
        bubbles: true,
        key: theKey,
        keyCode: 9,
        charCode: 0,
      });
      document.dispatchEvent(e);
      e = new window.KeyboardEvent('keyup', {
        bubbles: true,
        key: theKey,
        keyCode: 9,
        charCode: 0,
      });
      document.dispatchEvent(e);
    }, 100);

  } else if (event.keyCode != 0) {
    console.log('we got a non-enter press...: :', event.key, '  keyCode:', event.keyCode, '  charCode:', event.charCode);
  }

});
```

```
<h2>convert each enter to a tab in JavaScript... check console for output</h2>
<h3>we dispatchEvents on the activeElement... and the global element as well</h3>

<input type='text' id='firstInput' />
<input type='text' id='secondInput' />

<button type="button" onclick="document.getElementById('demo').innerHTML = Date()">
    Click me to display Date and Time.</button>
<p id="demo"></p>
```

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2017-03-13T02:33:21.260

这对我有用，它确实为我的 textaera 模拟了一个键盘。如果你想要它用于整个页面，只需`KeySimulation()`像`<body>`这样`<body onmousemove="KeySimulation()">`或者如果不是`onmousemove`那么`onmouseover`或者`onload`也可以工作。

```
function KeySimulation()
    {
    var e = document.createEvent("KeyboardEvent");
    if (e.initKeyboardEvent) {  // Chrome, IE
        e.initKeyboardEvent("keyup", true, true, document.defaultView, "Enter", 0, "", false, "");
    } else { // FireFox
        e.initKeyEvent("keyup", true, true, document.defaultView, false, false, false, false, 13, 0);
    }
    document.getElementById("MyTextArea").dispatchEvent(e);
    }
```

```
<input type="button" onclick="KeySimulation();" value=" Key Simulation " />
<textarea id="MyTextArea" rows="15" cols="30"></textarea>
```

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2014-09-10T23:18:48.477

这是一个真正有帮助的库：[https ://cdn.rawgit.com/ccampbell/mousetrap/2e5c2a8adbe80a89050aaf4e02c45f02f1cc12d4/tests/libs/key-event.js](https://cdn.rawgit.com/ccampbell/mousetrap/2e5c2a8adbe80a89050aaf4e02c45f02f1cc12d4/tests/libs/key-event.js)

我不知道它是从哪里来的，但它很有帮助。它向 中添加了一个`.simulate()`方法`window.KeyEvent`，因此您可以简单地使用它`KeyEvent.simulate(0, 13)`来模拟 a`enter`或`KeyEvent.simulate(81, 81)`a `'Q'`。

我在[https://github.com/ccampbell/mousetrap/tree/master/tests](https://github.com/ccampbell/mousetrap/tree/master/tests)得到它。

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2019-08-12T17:26:35.010

让它发挥作用的关键部分是认识到这一点`charCode`，`keyCode`并且`which`都是[不推荐使用的方法](https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/keyCode)。因此，如果*处理*按键事件的代码使用这三个中的任何一个，那么它将收到一个虚假的答案（例如，默认值为 0）。

只要您使用非弃用方法访问按键事件，例如`key`，您应该可以。

为了完成，我添加了用于触发事件的基本 Javascript 代码：

```
const rightArrowKey = 39
const event = new KeyboardEvent('keydown',{'key':rightArrowKey})
document.dispatchEvent(event)
```

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2018-05-21T08:24:51.797

由于在控制台上下文中易于使用，它曾经是单排的。但可能仍然有用。

```
var pressthiskey = "q"/* <-- q for example */;
var e = new Event("keydown");
e.key = pressthiskey;
e.keyCode = e.key.charCodeAt(0);
e.which = e.keyCode;
e.altKey = false;
e.ctrlKey = true;
e.shiftKey = false;
e.metaKey = false;
e.bubbles = true;
document.dispatchEvent(e);
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2019-07-15T22:14:09.093

支持 TypeScript 的原生 JavaScript 解决方案：

键入 keyCode 或您正在使用的任何属性并将其转换为 KeyboardEventInit

**例子**

```
 const event = new KeyboardEvent("keydown", {
              keyCode: 38,
            } as KeyboardEventInit);
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2020-02-26T19:13:00.313

这就是我在 chrome 中使用 js/typescript 所尝试的。感谢 [这个答案](https://stackoverflow.com/a/23812767/74167)的灵感。

```
var x = document.querySelector('input');

var keyboardEvent = new KeyboardEvent("keypress", { bubbles: true });
// you can try charCode or keyCode but they are deprecated
Object.defineProperty(keyboardEvent, "key", {
  get() {
    return "Enter";
  },
});
x.dispatchEvent(keyboardEvent); 
```

```
{
  // example
  document.querySelector('input').addEventListener("keypress", e => console.log("keypress", e.key))
  // unfortunatelly doesn't trigger submit
  document.querySelector('form').addEventListener("submit", e => {
    e.preventDefault();
    console.log("submit")
  })
}

var x = document.querySelector('input');

var keyboardEvent = new KeyboardEvent("keypress", { bubbles: true });
// you can try charCode or keyCode but they are deprecated
Object.defineProperty(keyboardEvent, "key", {
  get() {
    return "Enter";
  },
});
x.dispatchEvent(keyboardEvent);
```

```
<form>
  <input>
</form>
```

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2018-03-31T16:57:28.687

这是适用于 Chrome 和 Chromium 的解决方案（仅测试过这些平台）。似乎 Chrome 有一些错误或自己的方法来处理键码，所以这个属性必须单独添加到 KeyboardEvent。

```
 function simulateKeydown (keycode,isCtrl,isAlt,isShift){
        var e = new KeyboardEvent( "keydown", { bubbles:true, cancelable:true, char:String.fromCharCode(keycode), key:String.fromCharCode(keycode), shiftKey:isShift, ctrlKey:isCtrl, altKey:isAlt } );
        Object.defineProperty(e, 'keyCode', {get : function() { return this.keyCodeVal; } });     
        e.keyCodeVal = keycode;
        document.dispatchEvent(e);
    }
    simulateKeydown(39, false, false, false);
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2019-03-11T13:30:53.830

我知道这个问题要求一种模拟按键的javascript方式。但对于那些正在寻找 jQuery 做事方式的人来说：

```
var e = jQuery.Event("keypress");
e.which = 13 //or e.keyCode = 13 that simulates an <ENTER>
$("#element_id").trigger(e); 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2018-09-25T07:56:30.433

这是我设法找到的：

```
function createKeyboardEvent(name, key, altKey, ctrlKey, shiftKey, metaKey, bubbles) {
  var e = new Event(name)
  e.key = key
  e.keyCode = e.key.charCodeAt(0)
  e.which = e.keyCode
  e.altKey = altKey
  e.ctrlKey = ctrlKey
  e.shiftKey = shiftKey
  e.metaKey =  metaKey
  e.bubbles = bubbles
  return e
}

var name = 'keydown'
var key = 'a'

var event = createKeyboardEvent(name, key, false, false, false, false, true)

document.addEventListener(name, () => {})
document.dispatchEvent(event)
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2018-03-25T06:55:28.610

只要用户按下有问题的键，您就可以存储对该键的引用并将其用于任何 HTML 其他元素：

```
EnterKeyPressToEmulate<input class="lineEditInput" id="addr333_1" type="text" style="width:60%;right:0%;float:right" onkeydown="keyPressRecorder(event)"></input>
TypeHereToEmulateKeyPress<input class="lineEditInput" id="addr333_2" type="text" style="width:60%;right:0%;float:right" onkeydown="triggerKeyPressOnNextSiblingFromWithinKeyPress(event)">
Itappears Here Too<input class="lineEditInput" id="addr333_3" type="text" style="width:60%;right:0%;float:right;" onkeydown="keyPressHandler(event)">
<script>
var gZeroEvent;
function keyPressRecorder(e)
{
  gZeroEvent = e;
}
function triggerKeyPressOnNextSiblingFromWithinKeyPress(TTT)
{
  if(typeof(gZeroEvent) != 'undefined')  {
TTT.currentTarget.nextElementSibling.dispatchEvent(gZeroEvent);
keyPressHandler(TTT);
  }
}
function keyPressHandler(TTT)
{
  if(typeof(gZeroEvent) != 'undefined')  {
TTT.currentTarget.value+= gZeroEvent.key;
event.preventDefault();
event.stopPropagation();
  }
}
</script>
```

如果您创建自己的事件，则可以设置 keyCode，您可以从任何真实的键盘事件中复制现有参数（忽略目标，因为它的 dispatchEvent 的工作）和：

```
ta = new KeyboardEvent('keypress',{ctrlKey:true,key:'Escape'}) 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2021-08-13T16:52:01.333

基于@aljgom 的回答：

这对我很有用。与其将事件分派给 aljgom 建议的元素，不如将其分派给文档。

```
document.dispatchEvent(new KeyboardEvent("keydown", { key: "c" })); 
```

# ruby-on-rails - Rails cookie 会话共享和“www.example.com”或“example.com”问题

> ID：596491
> 
> 赞同：1
> 
> 时间：2009-02-27T20:18:52.143
> 
> 标签：ruby-on-rails, apache

当人们在 www.example.com 上访问我的应用程序并登录时，他们会得到一个 cookie。我正在使用 cookie 选项在 Rails 上存储会话。访问 example.com（没有 www），他们必须重新登录，因为 Firefox 无法识别上一个会话。

那么，您认为避免这种情况的最佳方法是什么？

我想我会使用这样的小`.htaccess`规则（Apache + Passenger）：

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^example\.com
RewriteRule ^(.*)$ http://www.example.com/$1 [R=permanent,L] 
```

大家觉得这个解决方案好不好？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T20:24:36.247

我会做的是：

1.  为 domain.com 和 www.domain.com 设置单独的虚拟主机
2.  永远不要发布到 domain.com 的链接，只发布到 www.domain.com
3.  当用户代理请求[http://domain.com/](http://domain.com/)时，使用 301 响应重定向到[http://www.domain.com/](http://www.domain.com/)
4.  仅从 www.domain.com 发出 cookie
5.  不要试图从 domain.com 提供整个站点，只提供主页（被重定向）

您根本不需要在此解决方案中涉及 Rails。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-28T00:22:43.227

创建单独的虚拟主机条目：

```
ServerName domain.com
Redirect permanent / http://www.domain.com 
```

重定向将用户指向您的其他虚拟主机：

```
ServerName www.domain.com 
```

# .net - pdb 文件包含多少信息？（C#/.NET）

> ID：596512
> 
> 赞同：19
> 
> 时间：2009-02-27T20:22:29.297
> 
> 标签：.net, debugging, symbols, pdb-files

将 pdb 文件与商业应用程序一起重新分发是否明智？

有时，我使用堆栈跟踪从已部署的应用程序中获取更详细的错误报告日志；可以在不依赖这些文件的情况下实现此功能吗？

另外，这些文件包含多少原始源代码的提示？使用它对我的应用程序进行逆向工程会更容易吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-27T20:42:46.687

它基本上添加了以下信息：

*   所有非公共类型、接口、结构、类
*   函数中的局部变量
*   相关代码的源文件名和源代码中对应的行号。

所有这些结合起来使得本机代码的逆向工程非常容易。

[幸运的是，您可以创建仅包含带有/PDBSTRIPPED](http://msdn.microsoft.com/en-us/library/y87kw2fd.aspx)参数的公共信息的 PDB 文件的精简版本。

哦，您编辑添加了 C#/.NET，所以我不确定“PDBSTRIPPED”是否适用。然而，即使没有任何符号信息，.NET 应用程序也很容易进行[逆向工程。](http://www.red-gate.com/products/reflector/)我不介意将它们包含在 .NET 项目中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-17T16:18:10.610

您可以尝试使用[dia2dump](http://msdn.microsoft.com/en-us/library/b5ke49f5(VS.80).aspx)查看内容。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-12-13T14:27:17.570

托管 .pdb 文件包含以下信息：

*   所有局部变量的名称
*   所有源代码文件的名称以及从 IL 指令到这些文件中的行的映射。

其他所有内容都包含在二进制文件本身中，包括所有类型的名称、成员和函数参数。

来源：[PDB 文件：每个开发人员都必须知道](https://web.archive.org/web/20090901041827/http://www.wintellect.com/CS/blogs/jrobbins/archive/2009/05/11/pdb-files-what-every-developer-must-know.aspx)的内容。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-08-03T13:09:54.743

PDB 文件还包括源文件的所有注释。因此，使用 EXE 和 PDB 文件可以从原始源代码生成 1:1 副本。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-10-04T16:20:23.937

较新的 .Net 编译器版本可以在 PDB 文件中嵌入**带有所有注释的完整源代码。**

免费的*JetBrains dotPeek*反编译器使用此 Blob 来显示反编译的代码。检查程序集 -> 元数据 -> 便携式 PDB 元数据 -> CustomDebugInformation -> 种类：guid 0003 0E8A571B-6926-466E-B4AD-8AB04611F5FE（嵌入式源）。

这记录在这里： [https ://github.com/dotnet/corefx/blob/master/src/System.Reflection.Metadata/specs/PortablePdb-Metadata.md#EmbeddedSource](https://github.com/dotnet/corefx/blob/master/src/System.Reflection.Metadata/specs/PortablePdb-Metadata.md#EmbeddedSource)

# apache - 使用 Apache httpd，如何为给定的 UserAgent 配置不缓存？

> ID：596520
> 
> 赞同：1
> 
> 时间：2009-02-27T20:24:38.043
> 
> 标签：apache, configuration, caching, user-agent

我已将 Apache HTTPD 配置为向大多数静态内容的请求添加缓存标头：

```
ExpiresActive On
ExpiresDefault "access plus 1 year"

# Force JNLP and BSH files to expire immediately so updates are checked for
# and seen (We need this so we see changes in the dynamic content in both)
ExpiresByType application/x-java-jnlp-file "now"
ExpiresByType application/x-bsh "now" 
```

如何为`UserAgent`包含字符串 JNLP 的任何请求禁用此缓存？当请求来自用户代理 JNLP（例如“ `User-Agent: JNLP/6.0 javaws/1.6.0_12 (b04) Java/1.6.0_12`”）时，我不希望HTTP 响应上有*任何或其他与缓存相关的标头。* `Cache-Control`

我可以找到基于用户代理的几件事的配置示例，但我无法弄清楚如何根据用户代理配置缓存。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T21:41:38.717

您的`ExpiresByType`指令看起来是个好主意……如果这还不够，请尝试使用`BrowserMatch`：

```
BrowserMatch JNLP ua_is_jnlp 
```

对于用户代理标头包含字符串的任何请求，这会将环境变量设置`ua_is_jnlp`为某个值`JNLP`（还有一个不区分大小写的变体，`BrowserMatchNoCase`）。然后你可以清除任何缓存头

```
Header unset Cache-Control env=ua_in_jnlp
Header unset Expires env=ua_in_jnlp 
```

虽然如果你想完全禁用缓存，你最好设置

```
Header set Cache-Control no-cache env=ua_in_jnlp
Header set Expires 0 env=ua_in_jnlp 
```

# c# - 关闭并刷新页面后弹出窗口一直打开？

> ID：596536
> 
> 赞同：0
> 
> 时间：2009-02-27T20:26:39.037
> 
> 标签：c#, javascript, html

我有一个带有以下代码的 aspx.cs 页面：

```
hypPopup.Attributes.Add("onclick",
                        "window.open('Popup.aspx',
                        '',
                        'height=650,
                         width=800,
                         location=no,
                         toolbar=no, 
                         status=no, 
                         scrollbars=yes, 
                         resizable=yes');
                         return false"
                         ); 
```

当我单击 hypPopup 链接时，会弹出窗口，这很好，但如果我关闭它并刷新页面，弹出窗口会不断弹出。我必须离开页面然后回来让它在每次刷新时停止弹出。这是默认行为还是有解决方法？

hypPopup.Attributes.Add 在 Page_Load 中完成

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-27T20:47:24.150

如果 hypPopup 按钮设置为在服务器上运行，请尝试将其删除。也许它会导致重新发布，而重新发布的东西会触发按钮点击，所以当您刷新页面时，它会重新模拟重新发布和点击？

我不知道……只是想点什么！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T21:24:50.923

我已经在 Firefox 3.0.6 和 IE 6 上测试了这个，它们`<asp:Hyperlink>`都`<asp:LinkButton>`没有重现这种行为。如果我刷新页面，弹出窗口将不会出现（这实际上是所需的行为，因为客户端事件只能由特定的客户端操作触发。）

你使用的是什么浏览器？那是被触发的确切代码，还是显示的内容更多？

# .net - inout 参数有没有用处？

> ID：596549
> 
> 赞同：2
> 
> 时间：2009-02-27T20:29:28.717
> 
> 标签：.net, calling-convention

.NET 中的 inout（C# 中的 ref，vb.net 中的 byref（如 out 参数））参数有很好的用途吗？
我觉得一个参数既作为输入又作为返回值造成的混乱，比out参数的参数数量增加，或者返回数组或者返回自定义类更糟糕。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-27T20:41:00.203

我遇到的最常见的用途（仍然不是那么常见，IMO）是一种“修改现有对象，或者在必要时创建一个”。例如：

```
public void AppendToBuilder(ref StringBuilder builder)
{
    if (builder == null)
    {
        builder = new StringBuilder();
    }
    builder.Append(/* whatever */);
} 
```

`StringBuilder`可能不是一个很好的例子，但这意味着您有时可以避免在不需要时创建对象：

```
public static string DoSomething(IEnumerable<Foo> foos)
{
    // For an empty collection or where there aren't any
    // frobulating foos, we don't need to create a builder
    StringBuilder builder = null;
    foreach (Foo foo in foos)
    {
        if (foo.Frobulates)
        {
            foo.AppendToBuilder(ref builder);
        }
    }
    return builder == null ? null : builder.ToString();
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-27T20:48:16.923

我主要用它来适应遗留代码。=（com互操作）。

我也倾向于在需要高性能并表明成功的代码中使用它：

```
bool PerformSomeReadOperation(SomeInput obj, ref int defaultedOutput) { } 
```

其中返回值是成功或失败的概念，或者可能是错误代码，而 defaultedOutput 是带有默认值的值。

您是否知道[out 和 ref 之间没有真正的区别](http://www.atalasoft.com/cs/blogs/stevehawley/archive/2008/04/18/out-out-damn-ref.aspx)（至少就 CLR 而言）？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T20:33:06.773

当您可能进行一系列修改同一变量的调用时。

但是，在 C# 等基于指针的语言中，这种情况不会发生太多，因为您可以将对象作为“in”参数传递，并且被调用的函数可以调用其方法来根据需要对其进行修改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T20:35:03.243

在极少数情况下，它可能很有用，主要是出于性能原因。

在大多数情况下，它可以并且在我看来应该通过返回您提到的数组或自定义类来避免。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T20:39:17.057

ref 和 out 参数传递模式用于允许方法更改由方法调用者传入的变量。

每种参数传递模式（ref 和 out）都旨在适应不同的编程需求。

**带有out 参数**的方法的调用者**不需要**在调用之前分配作为 out 参数传递的变量；但是，该方法需要在返回之前分配给 out 参数。

一种考虑**out**参数的方法是，它们就像方法的附加返回值。**当一个方法应该返回多个**值时，它们很方便。

不要将通过引用传递的概念与引用类型的概念混淆。

这两个概念不相关；方法参数无论是值类型还是引用类型都可以被ref修改，通过引用传递时没有值类型的装箱。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-27T20:45:33.607

我在图形例程中将它与值类型参数一起使用，该例程以垂直布局将文本打印到 GDI 窗口。inout 参数跟踪当前的 Y 位置：

```
WriteString("hello", ref y); 
```

而不是

```
y += WriteString("hello", y); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-27T20:46:26.680

Out 适用于需要多个返回值的简单情况。这样您就不`ref`会对可能导致的“它是参数/它是返回值”感到困惑。

```
public void GetStockQuote(
  string stock, 
  out double lastTrade, 
  out DateTime tradeTime, 
  out double change, 
  out double open)
{
  //perform stock magic here
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-27T22:11:10.313

当我想修改一个值并认为包装类太过分时，我会使用它。

例如

```
if (line[index].StartsWith("X12"))
    ParseX12(lines, ref index, builder); //eats 2 or 4 lines

else if (line[index].StartsWith("A27"))
    ParseA27(lines, ref index, builder); //eats 1 line

else if (line[index].StartsWith("B16"))
    ParseB16(lines, ref index, builder); //eats 1 to 3 lines

else 
    index++; //this line couldn't be parsed, skip to the next one 
```

在这个例子中，Parse 函数可能会消耗不止一行。因此，他们负责正确更新索引变量。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-28T00:14:33.700

你真的回答了你自己的问题。

如果通过参数传入和传出数据是有意义的 - 即。如果该方法需要知道当前值并且还需要更新它（或者，在引用类型的情况下，替换它），那么 ref 是正确的。它不会经常发生，但是当它发生时，您知道该使用什么;-)

# php - php mysql查询的问题

> ID：596552
> 
> 赞同：0
> 
> 时间：2009-02-27T20:30:32.973
> 
> 标签：php, mysql

我有一个带有method = post提交到表单处理程序文件的表单，该文件将帖子写入数据库，然后将结果通过电子邮件发送给用户。

我写了一个插入语句，但是在处理表单时出现错误，但不是数据库专家，我不确定问题出在哪里。这是代码——

```
// MYSQL QUERY
$result = mysql_query("INSERT INTO 2009_prize_results 
  (name, address, address2, email, 100, 101, 102, 103, 104, 105, 106, 107, 108) 
VALUES
  ($_POST[name],$_POST[address],$_POST[address2],$_POST[email]
  ,$_POST[100],$_POST[101],$_POST[102],$_POST[103],$_POST[104],$_POST[105]
  ,$_POST[106],$_POST[107],$_POST[108])");
if (!$result) {
    die ("SQL error: " . mysql_error());
} 
```

我得到的错误是——

> SQL 错误：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以了解在 '100, 101, 102, 103, 104, 105, 106, 107, 108) 附近使用的正确语法（Marty Martin,313 Orlando Av' at line 1

提交值为

```
name = Marty Martin
address = 313 Orlando Ave
address2 = Anytown, VA
email = foo@foo.com
100 = on
101 = off
10* are all checkboxes so are either on or off 
```

我在这里有什么问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-27T20:39:37.210

请参见：

![小鲍比桌:-)](https://imgs.xkcd.com/comics/exploits_of_a_mom.png) ["Bobby Tables" XKCD 漫画中的 SQL 注入是如何工作的？](https://stackoverflow.com/questions/332365/xkcd-sql-injection-please-explain)

如果您必须使用 mysql 库，那么请确保您通过 mysql_real_escape_string 运行所有输入，否则使用准备好的语句。

然后，当您将查询放在一起时，将所有 VALUES 用引号括起来（单引号或双引号都可以）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-27T20:40:13.667

如果您实际上有具有类似数字名称的列，则可能需要用反引号分隔它们，以便它们不会被 SQL 解释为文字数字。并且，为了您自己和我的理智，请格式化您的查询。

```
$result = mysql_query("
INSERT INTO 2009_prize_results(
       name
     , address
     , address2
     , email
     , `100`
     , `101`
     , `102`
     , `103`
     , `104`
     , `105`
     , `106`
     , `107`
     , `108`
)
VALUES (
    -- values here as others have stated
)"); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-27T20:34:21.170

您需要在 VALUES 中的每个项目周围加上单引号

编辑：您的 $_POST[] 变量在字符串中也可能无法计算。您需要使用不同的语法或使用邪恶的 extract();

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-27T20:35:47.813

调试这类问题的方法是查看实际发送的查询，看看它有什么问题。当你看到它有什么问题时，你可以找出什么价值正在影响作品，并通过适当的调整和/或验证检查来修复它。

另外，请记住：字符串被 '' （单引号）包围，未为字符串指定的值应作为 NULL （无引号）传入。如果您的表或列名称不标准或有其他问题，请不要忘记其名称周围的 ``（反引号）；这些也可能导致语法错误。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-27T20:42:15.147

除了将变量用单引号括起来之外，您还应该转义 POST 变量中的特殊字符。查看[`mysql_real_escape_string`方法文档](http://us3.php.net/mysql_real_escape_string)以获取解释和示例。

在预览版中，转义有助于防止XKCD 取笑的那种[SQL 注入攻击。](http://en.wikipedia.org/wiki/SQL_injection)只是当它发生在你身上时并不好玩，而且很容易避免。

要回答评论者的问题，是的，您还可以使用 PHP 和 MySQL执行[准备好的语句。](http://devzone.zend.com/node/view/id/686#Heading10)这是使用该方法的替代`mysql_real_escape_string`方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-27T20:33:39.893

你需要把你的价值观放在引号里。例如：

```
... VALUES(Marty 
```

应该

```
... VALUES('Marty' 
```

尝试：

```
// Concatenated for readability
$query = "INSERT INTO 2009_prize_results " .
         "(name, address, address2, email, 100, 101, 102, " . 
         "103, 104, 105, 106, 107, 108) VALUES " . 
         "('{$_POST['name']}', 
          '{$_POST['address']'}, 
          '{$_POST['address2']}', 
          '{$_POST['email']}', 
          '{$_POST[100]'}, '{$_POST[101]}', '{$_POST[102]}', '{$_POST[103]}', 
          '{$_POST[104]}', '{$_POST[105]}', '{$_POST[106]'}, '{$_POST[107]}', 
          '{$_POST[108]'})";

$result = mysql_query($query); 
```

# structuremap - 结构图教程

> ID：596563
> 
> 赞同：8
> 
> 时间：2009-02-27T20:34:11.343
> 
> 标签：structuremap

我正在寻找一些结构图教程。

有人知道吗？

编辑：感谢所有答案，但我正在寻找不在谷歌前 2 页上的东西。我会觉得首先这样做。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-27T20:44:30.037

阅读[http://structuremap.sourceforge.net/QuickStart.htm](http://structuremap.sourceforge.net/QuickStart.htm)。从那里您可以找到许多不同用途的信息。

**更新 1：**我一直在使用结构图，其中的信息足以让它运行起来。另请注意，我对文本格式有偏见，尽管我不时听/看其他格式。也就是说，这里有一些我读过/看过的额外信息：

*   [http://wekeroad.com/2008/06/03/mvcstore-part-13/](http://wekeroad.com/2008/06/03/mvcstore-part-13/)的这个网络广播（我看了整个系列）——这个让我开始看结构图
*   chad myer 的博客文章： [http ://www.lostechies.com/blogs/chad_myers/archive/tags/StructureMap/default.aspx](http://www.lostechies.com/blogs/chad_myers/archive/tags/StructureMap/default.aspx)
*   这篇关于结构图配置文件的博客文章[http://devlicio.us/blogs/derik_whittaker/archive/2008/08/13/contextual-binding-with-structuremap-2-5.aspx](http://devlicio.us/blogs/derik_whittaker/archive/2008/08/13/contextual-binding-with-structuremap-2-5.aspx)
*   jeremy miller 在[http://codebetter.com/blogs/jeremy.miller/archive/tags/StructureMap/default.aspx上的一些帖子](http://codebetter.com/blogs/jeremy.miller/archive/tags/StructureMap/default.aspx)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-04T10:54:39.523

我发现的最好的例子是在[DimeCast](http://dimecasts.net/Casts/ByTag/StructureMap)

# spring - Spring MVC 以外部渲染的 PDF 作为视图

> ID：596578
> 
> 赞同：2
> 
> 时间：2009-02-27T20:36:35.877
> 
> 标签：spring, pdf, spring-mvc

Spring 中是否有内置机制允许我将外部渲染的 PDF 显示为视图？

我通过 web 服务获取 PDF（返回附加的 DataHandler），所以我不希望继承 AbstractPdfView 来呈现 PDF。

这不是一个很难单独解决的问题。只需将 PDF 写入 ServletOutputStream 就很容易了。但是，为了保持一致性，我想保留返回 ModelAndView 的 Spring 控制器类，这意味着编写我自己的 AbstractView 子类来将 PDF 写入 ServletOutputStream。这样做没什么大不了的，但我不想重新创建 Spring 中其他地方可能已经存在的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T20:46:20.847

所以你有 PDF 作为一个（字节）流，你想把它写到响应中吗？这不是您拥有 ModelAndView 并且希望生成包含模型数据的 PDF 的情况吗？

在这种情况下，除了将其写入响应流之外，我看不到您还有什么其他选择。除了这个之外，任何可重用的 Spring 代码还有什么动作呢？听起来您的逻辑就像“获取此流并将其写入输出流”一样简单。

# subsonic - 亚音速多对多

> ID：596583
> 
> 赞同：3
> 
> 时间：2009-02-27T20:37:39.727
> 
> 标签：subsonic, many-to-many

对于亚音速用户，

是否有关于如何处理 Subsonic 中的多对多关系的信息来源？尽管我在数据库中定义了正确的关系，但我在生成的代码中不断收到“ ***//no ManyToMany tables defined (0) ”。***

有什么帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T14:00:18.570

[在http://dotnetslackers.com/articles/aspnet/UsingSubSonicToCreateASimpleBogEngine.aspx](http://dotnetslackers.com/articles/aspnet/UsingSubSonicToCreateASimpleBogEngine.aspx)查看 Kent Sharkey 的示例。具体来说，请查看标题为“添加类别支持”的部分。

很多次，我错误地设置了键，导致 SubSonic 无法识别多对多关系。确保这两个字段构成一个复合键。

# ios - iPhone SDK 网络连接检测

> ID：596589
> 
> 赞同：39
> 
> 时间：2009-02-27T20:39:10.800
> 
> 标签：ios, objective-c, iphone

我正在开发一个对 Web 服务进行几次调用的[iPhone应用程序。](http://en.wikipedia.org/wiki/IPhone)我在 Apple Store 上发布了这个应用程序，但它被拒绝了（这是正确的），因为如果没有可用的 Internet 连接，则不会向用户显示错误消息。因为显然没有它，应用程序将无法工作。

所以我只是想知道如何最好地实现这一目标？我猜想该方法需要进行一些操作，该`viewDidLoad`方法会抛出一个警告框，上面写着“您需要 Internet 连接才能使用此应用程序”。

任何想法，将不胜感激。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-02-27T21:09:18.620

如果您的应用程序必须具有网络访问权限，最简单的方法是将以下设置作为布尔值添加到您的 info.plist。

*   ~~SBUsesNetwork - 确保设备具有活动连接~~（编辑：不适用，这似乎是某人在某个时候发现的私有 API。它不在 Apple 的开发人员文档中。）
*   UIRequiresPersistentWiFi - 确保设备通过 WiFi 连接

如果您的选择不正确，则在启动应用程序时将向用户显示适当的消息。最重要的是，这条消息来自操作系统，因此是本地化的。

如果您的应用程序在运行时无法从网站下载数据（信号丢失、站点关闭），您仍然应该警告用户，而不是无限期地旋转。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-02-27T21:26:29.813

Apple Developer Connection 有一个示例应用程序 ( [Reachability](http://developer.apple.com/iphone/library/samplecode/Reachability/index.html#//apple_ref/doc/uid/DTS40007324) )，它使用系统配置框架来确定网络状态。它会告诉您是否有 WiFi、EDGE/3G 或没有互联网连接。

您将在应用程序中使用此代码的一部分来确定网络状态，然后在没有可用连接时提供界面提示，例如[UIAlertView](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UIAlertView_Class/UIAlertView/UIAlertView.html)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-02-21T12:00:49.430

警告词：当心 SBUsesNetwork。我个人很想知道 SBUsesNetwork 最初来自哪里，因为在我能找到的 Apple 文档中的任何地方都没有提到它。当我将密钥添加到我的应用程序的 plist（作为布尔值）并设置为 true 时，它​​似乎不会影响我的应用程序的行为 - 我没有收到有关飞行模式的警告，无论是完全重新启动应用程序，还是前景化以前的背景启动。

我的应用程序将 UIRequiresPersistentWifi 设置为 true，这似乎也完成了人们声称 SBUsesNetwork 所做的工作（以及其他事情！）。

（我在 iPhone 4 上运行 iOS4.2.1，XCode 3.2.5 64 位）。

# linux - 如何获取 Linux/UNIX 上当前的网络接口吞吐量统计信息？

> ID：596590
> 
> 赞同：104
> 
> 时间：2009-02-27T20:39:12.127
> 
> 标签：linux, networking, bandwidth

诸如 MRTG 之类的工具为特定接口（例如 eth0）上的当前网络利用率提供网络吞吐量/带宽图。如何在 Linux/UNIX 的命令行中返回该信息？

最好不要安装系统上可用的标准以外的任何东西。

* * *

## 回答 #1

> 赞同：161
> 
> 时间：2009-03-23T17:29:27.870

`iftop does for network usage what top(1) does for CPU usage`-- [http://www.ex-parrot.com/~pdw/iftop/](http://www.ex-parrot.com/~pdw/iftop/)

我不知道 iftop 有多“标准”，但我可以`yum install iftop`在 Fedora 上安装它。

* * *

## 回答 #2

> 赞同：111
> 
> 时间：2010-10-27T19:04:44.803

有萨尔吗？如果您使用的是 RHEL/CentOS，可能是的。

不需要 priv、dorky 二进制文件、hacky 脚本、libpcap 等。赢。

```
$ sar -n DEV 1 3
Linux 2.6.18-194.el5 (localhost.localdomain)    10/27/2010

02:40:56 PM     IFACE   rxpck/s   txpck/s   rxbyt/s   txbyt/s   rxcmp/s   txcmp/s  rxmcst/s
02:40:57 PM        lo      0.00      0.00      0.00      0.00      0.00      0.00      0.00
02:40:57 PM      eth0  10700.00   1705.05 15860765.66 124250.51      0.00      0.00      0.00
02:40:57 PM      eth1      0.00      0.00      0.00      0.00      0.00      0.00      0.00

02:40:57 PM     IFACE   rxpck/s   txpck/s   rxbyt/s   txbyt/s   rxcmp/s   txcmp/s  rxmcst/s
02:40:58 PM        lo      0.00      0.00      0.00      0.00      0.00      0.00      0.00
02:40:58 PM      eth0   8051.00   1438.00 11849206.00 105356.00      0.00      0.00      0.00
02:40:58 PM      eth1      0.00      0.00      0.00      0.00      0.00      0.00      0.00

02:40:58 PM     IFACE   rxpck/s   txpck/s   rxbyt/s   txbyt/s   rxcmp/s   txcmp/s  rxmcst/s
02:40:59 PM        lo      0.00      0.00      0.00      0.00      0.00      0.00      0.00
02:40:59 PM      eth0   6093.00   1135.00 8970988.00  82942.00      0.00      0.00      0.00
02:40:59 PM      eth1      0.00      0.00      0.00      0.00      0.00      0.00      0.00

Average:        IFACE   rxpck/s   txpck/s   rxbyt/s   txbyt/s   rxcmp/s   txcmp/s  rxmcst/s
Average:           lo      0.00      0.00      0.00      0.00      0.00      0.00      0.00
Average:         eth0   8273.24   1425.08 12214833.44 104115.72      0.00      0.00      0.00
Average:         eth1      0.00      0.00      0.00      0.00      0.00      0.00      0.00 
```

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2009-02-27T22:40:53.580

我很久以前写过这个愚蠢的脚本，它只依赖于 Perl 和 Linux≥2.6：

```
#!/usr/bin/perl

use strict;
use warnings;

use POSIX qw(strftime);
use Time::HiRes qw(gettimeofday usleep);

my $dev = @ARGV ? shift : 'eth0';
my $dir = "/sys/class/net/$dev/statistics";
my %stats = do {
    opendir +(my $dh), $dir;
    local @_ = readdir $dh;
    closedir $dh;
    map +($_, []), grep !/^\.\.?$/, @_;
};

if (-t STDOUT) {
    while (1) {
        print "\033[H\033[J", run();
        my ($time, $us) = gettimeofday();
        my ($sec, $min, $hour) = localtime $time;
        {
            local $| = 1;
            printf '%-31.31s: %02d:%02d:%02d.%06d%8s%8s%8s%8s',
            $dev, $hour, $min, $sec, $us, qw(1s 5s 15s 60s)
        }
        usleep($us ? 1000000 - $us : 1000000);
    }
}
else {print run()}

sub run {
    map {
        chomp (my ($stat) = slurp("$dir/$_"));
        my $line = sprintf '%-31.31s:%16.16s', $_, $stat;
        $line .= sprintf '%8.8s', int (($stat - $stats{$_}->[0]) / 1)
            if @{$stats{$_}} > 0;
        $line .= sprintf '%8.8s', int (($stat - $stats{$_}->[4]) / 5)
            if @{$stats{$_}} > 4;
        $line .= sprintf '%8.8s', int (($stat - $stats{$_}->[14]) / 15)
            if @{$stats{$_}} > 14;
        $line .= sprintf '%8.8s', int (($stat - $stats{$_}->[59]) / 60)
            if @{$stats{$_}} > 59;
        unshift @{$stats{$_}}, $stat;
        pop @{$stats{$_}} if @{$stats{$_}} > 60;
        "$line\n";
    } sort keys %stats;
}

sub slurp {
    local @ARGV = @_;
    local @_ = <>;
    @_;
} 
```

它只是每秒读取`/sys/class/net/$dev/statistics`一次，并打印出当前数字和平均变化率：

```
$ ./net_stats.pl eth0
rx_bytes                       :  74457040115259 4369093 4797875 4206554 364088
rx_packets                     :     91215713193   23120   23502   23234  17616
...
tx_bytes                       :  90798990376725 8117924 7047762 7472650 319330
tx_packets                     :     93139479736   23401   22953   23216  23171
...
eth0                           : 15:22:09.002216      1s      5s     15s     60s

                                ^ current reading  ^-------- averages ---------^ 
```

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2014-04-09T22:32:59.273

[nload](http://www.debuntu.org/nload-a-network-traffic-analyser/)是一个用于实时监控带宽的好工具，并且可以使用 sudo apt-get install nload 轻松安装在 Ubuntu 或 Debian 中。

```
Device eth0 [10.10.10.5] (1/2):
=====================================================================================
Incoming:

                               .         ...|    
                               #         ####|   
                           .. |#|  ...   #####.         ..          Curr: 2.07 MBit/s
                          ###.###  #### #######|.     . ##      |   Avg: 1.41 MBit/s
                         ########|#########################.   ###  Min: 1.12 kBit/s
             ........    ###################################  .###  Max: 4.49 MBit/s
           .##########. |###################################|#####  Ttl: 1.94 GByte
Outgoing:
            ##########  ###########    ###########################
            ##########  ###########    ###########################
            ##########. ###########   .###########################
            ########### ###########  #############################
            ########### ###########..#############################
           ############ ##########################################
           ############ ##########################################
           ############ ##########################################  Curr: 63.88 MBit/s
           ############ ##########################################  Avg: 32.04 MBit/s
           ############ ##########################################  Min: 0.00 Bit/s
           ############ ##########################################  Max: 93.23 MBit/s
         ############## ##########################################  Ttl: 2.49 GByte 
```

另一个出色的工具是[iftop](http://www.ex-parrot.com/pdw/iftop/)，也很容易 apt-get'able：

```
 191Mb      381Mb                 572Mb       763Mb             954Mb     
└────────────┴──────────┴─────────────────────┴───────────┴──────────────────────
box4.local            => box-2.local                      91.0Mb  27.0Mb  15.1Mb
                      <=                                  1.59Mb   761kb   452kb
box4.local            => box.local                         560b   26.8kb  27.7kb
                      <=                                   880b   31.3kb  32.1kb
box4.local            => userify.com                         0b   11.4kb  8.01kb
                      <=                                  1.17kb  2.39kb  1.75kb
box4.local            => b.resolvers.Level3.net              0b     58b    168b
                      <=                                     0b     83b    288b
box4.local            => stackoverflow.com                   0b     42b     21b
                      <=                                     0b     42b     21b
box4.local            => 224.0.0.251                         0b      0b    179b
                      <=                                     0b      0b      0b
224.0.0.251           => box-2.local                         0b      0b      0b
                      <=                                     0b      0b     36b
224.0.0.251           => box.local                           0b      0b      0b
                      <=                                     0b      0b     35b

─────────────────────────────────────────────────────────────────────────────────
TX:           cum:   37.9MB   peak:   91.0Mb     rates:   91.0Mb  27.1Mb  15.2Mb
RX:                  1.19MB           1.89Mb              1.59Mb   795kb   486kb
TOTAL:               39.1MB           92.6Mb              92.6Mb  27.9Mb  15.6Mb 
```

不要忘记旧 *nix 上经典而强大的 sar 和 netstat 实用程序！

* * *

## 回答 #5

> 赞同：30
> 
> 时间：2009-02-27T20:54:57.313

您可以解析[/proc/net/dev](http://www.redhat.com/docs/manuals/enterprise/RHEL-4-Manual/en-US/Reference_Guide/s2-proc-dir-net.html)。

* * *

## 回答 #6

> 赞同：26
> 
> 时间：2013-11-22T16:30:43.550

*   `dstat`- 结合 vmstat、iostat、ifstat、netstat 信息等
*   `iftop`- 惊人的网络带宽实用程序来分析你的 eth 上真正发生的事情
*   `netio`- 通过 TCP/IP 测量网络的净吞吐量
*   `inq`- 显示存储信息的 CLI 故障排除实用程序，通常是 Symmetrix。默认情况下，INQ 返回设备名称、Symmetrix ID、Symmetrix LUN 和容量。
*   `send_arp`- 在指定的网络设备（默认为 eth0）上发送 arp 广播，报告新旧 IP 地址映射到 MAC 地址。
*   `EtherApe`- 是仿照 etherman 的 Unix 图形网络监视器。它具有链路层、IP 和 TCP 模式，以图形方式显示网络活动。
*   `iptraf`- IP 流量监视器，显示有关通过您的网络的 IP 流量的信息。

更多详情： http: [//felipeferreira.net/?p=1194](http://felipeferreira.net/?p=1194)

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2013-06-14T06:45:53.373

为此，我得到了另一个 quick'n'dirty bash 脚本：

```
#!/bin/bash
IF=$1
if [ -z "$IF" ]; then
        IF=`ls -1 /sys/class/net/ | head -1`
fi
RXPREV=-1
TXPREV=-1
echo "Listening $IF..."
while [ 1 == 1 ] ; do
        RX=`cat /sys/class/net/${IF}/statistics/rx_bytes`
        TX=`cat /sys/class/net/${IF}/statistics/tx_bytes`
        if [ $RXPREV -ne -1 ] ; then
                let BWRX=$RX-$RXPREV
                let BWTX=$TX-$TXPREV
                echo "Received: $BWRX B/s    Sent: $BWTX B/s"
        fi
        RXPREV=$RX
        TXPREV=$TX
        sleep 1
done 
```

它正在考虑这`sleep 1`实际上会持续一秒钟，这不是真的，但对于粗略的带宽评估来说已经足够了。

感谢@ephemient `/sys/class/net/<interface>`！:)

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2009-02-27T20:45:30.830

您可以解析的输出`ifconfig`

* * *

## 回答 #9

> 赞同：15
> 
> 时间：2010-05-07T00:00:33.000

除了 iftop 和 iptraf，还要检查：

*   `bwm-ng`（下一代带宽监视器）

和/或

*   `cbm`（彩色带宽计）

参考：[http ://www.powercram.com/2010/01/bandwidth-monitoring-tools-for-ubuntu.html](http://www.powercram.com/2010/01/bandwidth-monitoring-tools-for-ubuntu.html)

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2014-09-20T13:10:06.457

如果您只想获取值，可以使用简单的 shell oneliner，如下所示：

```
S=10; F=/sys/class/net/eth0/statistics/rx_bytes; X=`cat $F`; sleep $S; Y=`cat $F`; BPS="$(((Y-X)/S))"; echo $BPS 
```

它将显示 10 秒周期内的平均“每秒接收字节数”（您可以通过更改参数来更改周期，并且您可以使用而不是`S=10`测量传输的 BPS 而不是接收的 BPS ）。不要忘记更改为您要监控的网络设备。`tx_bytes``rx_bytes``eth0`

当然，您不仅限于显示平均速率（如其他答案中所述，还有其他工具可以显示更好的输出），但是此解决方案很容易编写脚本来执行其他操作。

例如，下面的 shell 脚本（为了可读性分成多行）只有在 5 分钟的平均传输速度低于 10kBPS 时（大概是其他一些消耗带宽的进程完成时）才会执行 offlineimap 进程：

```
#!/bin/sh
S=300; F=/sys/class/net/eth0/statistics/tx_bytes
BPS=999999
while [ $BPS -gt 10000 ]
do
  X=`cat $F`; sleep $S; Y=`cat $F`; BPS="$(((Y-X)/S))";
  echo BPS is currently $BPS
done
offlineimap 
```

请注意，这`/sys/class/...`是 Linux 特定的（可以，因为提交者确实选择了`linux`标签），并且需要非过时的内核。Shell 代码本身与 /bin/sh 兼容（因此不仅 bash，而且 dash 和其他 /bin/sh 实现都可以工作）并且 /bin/sh 是真正总是安装的东西。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2009-02-27T20:44:32.223

我喜欢[`iptraf`](http://iptraf.seul.org/)，但您可能必须安装它，而且它似乎不再被积极维护。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-04-01T02:59:35.393

我发现 dstat 非常好。不过必须安装。为您提供比您需要的更多的信息。Netstat 将为您提供数据包速率，但也不会提供带宽。网络统计 -s

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2014-07-28T20:02:12.563

您可以使用 iperf 对网络性能进行基准测试（*最大可能吞吐量*）。有关详细信息，请参阅以下链接：

[http://en.wikipedia.org/wiki/Iperf](http://en.wikipedia.org/wiki/Iperf)

[https://iperf.fr/](https://iperf.fr/)

[https://code.google.com/p/iperf/](https://code.google.com/p/iperf/)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-11-25T14:39:48.450

我无法让解析 ifconfig 脚本在 AMI 上为我工作，所以让它工作测量平均超过 10 秒的接收流量

```
date && rxstart=`ifconfig eth0 | grep bytes | awk '{print $2}' | cut -d : -f 2` && sleep 10 && rxend=`ifconfig eth0 | grep bytes | awk '{print $2}' | cut -d : -f 2` && difference=`expr $rxend - $rxstart` && echo "Received `expr $difference / 10` bytes per sec" 
```

对不起，它曾经如此便宜和讨厌，但它奏效了！

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-12-08T13:31:01.327

```
ifconfig -a
ip -d link
ls -l /sys/class/net/ (physical and virtual devices)
route -n 
```

如果你想以 json 格式输出 (ifconfig -a) 你可以使用[这个](https://github.com/tazjel/python-ifcfg)(python)

# c# - 创建JavascriptConverter时，如何返回数组？

> ID：596593
> 
> 赞同：2
> 
> 时间：2009-02-27T20:39:29.240
> 
> 标签：c#, web-services, jscript.net

我正在尝试编写一个自定义 JavascriptConverter 以与我正在编写的 WebService 一起使用。我必须编写一个自定义转换器，因为 Microsoft.JScript.JSObject 不支持 IDictionary，所以它被视为一个数组。我的这部分工作正常。但是，由于 Microsoft.JScript.ArrayObject 是 Microsoft.JScript.JSObject 的子类，因此它也尝试使用相同的方法对其进行转换。如何返回将被序列化为 JSON 数组的内容？我必须返回一个 IDictionary，它将成为一个 JSON 对象。有什么我想念的吗？

具体来说，我如何从 Serialize 返回一些被序列化为数组而不是对象的东西。

谢谢！

编辑：

我想我需要更具体一些。

Microsoft.JScript.JSObject 实现 IEnumerable，但不是 IDictionary。Microsoft.JScript.ArrayObject 是 Microsoft.JScript.JSObject 的子类。如果我在 JScript.NET 中创建一个 .asmx，当我尝试返回一个 JSObject 时，它会被序列化为一个数组（因为它实现了 IEnumerable，而不是 IDictionary），这意味着只有对象中的属性名称会被序列化。当然，如果我交回一个 ArrayObject，它就可以正常工作，并将其序列化为一个数组。

所以，我实现了一个JavascriptConverter的子类，它说它的SupportedType是Microsoft.JScript.JSObject。现在，JSObjects 被正确序列化了。但是，由于 ArrayObject 是 JSObject 的子类，JavascriptSerializer 不再负责序列化 ArrayObjects 本身，而是将其交给 JSObject 序列化器。问题是，我的自定义序列化程序如何返回 JavaScriptSerializer 将正确视为数组而不是对象的东西——Serialize 被迫返回一个 IDictionary，并且它被序列化为一个对象，而不是一个数组。

这个问题更有意义吗？

顺便说一句：我已经查看了 WCF 和 C#，但是 DataContractJsonSerializer 输出完全没用，除非您只使用 WCF 客户端访问它；我打算使用 jQuery 来检索它。

回答：

我终于明白了 bdukes 想说什么，而且它有效！您需要在返回字典时告诉它它是一个数组（尽管这不适用于顶级数组）。这是`Serialize`我要编写的函数：

```
 public override IDictionary<string, object> Serialize (object obj, JavaScriptSerializer serializer) {
        JSObject jsobj = obj as JSObject;
        Dictionary<string, object> netdict = new Dictionary<string, object>();

        if (jsobj != null) {
            foreach (string prop in jsobj) {
                object value = jsobj.GetField(prop, BindingFlags.Default).GetValue(jsobj);
                switch (value.GetType().FullName) {
                    case "Microsoft.JScript.ArrayObject":
                        object[] arr_obj = ((IEnumerable)(Microsoft.JScript.ArrayObject)value).Cast<object>().ToArray<object>();
                        netdict.Add(prop, arr_obj);
                        break;
                    default:
                        netdict.Add(prop, value);
                        break;
                }
            }
        }
        return netdict;
    } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-27T20:46:25.527

JavaScriptConverters 只能创建 JSON 对象，不能创建其他类型。如果您只想返回一个数组，则需要将对象转换为 .NET 数组，然后将其发送给`Serialize`方法。

例如，要返回一个 Person 对象数组，请执行以下操作：

```
IList<Person> people = ...;
var serializer = new JavaScriptSerializer();
serializer.Serialize(people.ToArray()); 
```

或者，如果您正在创建 JSON 对象并希望其属性之一是数组，则应使用自定义 JavaScriptConverter，如下所示：

```
public class ExampleConverter : JavaScriptConverter
{
    /// <summary>
    /// Gets a collection of the supported types
    /// </summary>
    /// <value>An object that implements <see cref="IEnumerable{T}"/> that represents the types supported by the converter. </value>
    public override IEnumerable<Type> SupportedTypes
    {
        get
        {
            return new ReadOnlyCollection<Type>(new Type[] { typeof(MyExampleType) });
        }
    }

    /// <summary>
    /// Converts the provided dictionary into an object of the specified type. 
    /// </summary>
    /// <param name="dictionary">An <see cref="IDictionary{TKey,TValue}"/> instance of property data stored as name/value pairs. </param>
    /// <param name="type">The type of the resulting object.</param>
    /// <param name="serializer">The <see cref="JavaScriptSerializer"/> instance. </param>
    /// <returns>The deserialized object. </returns>
    /// <exception cref="InvalidOperationException">We only serialize</exception>
    public override object Deserialize(IDictionary<string, object> dictionary, Type type, JavaScriptSerializer serializer)
    {
        throw new InvalidOperationException("We only serialize");
    }

    /// <summary>
    /// Builds a dictionary of name/value pairs
    /// </summary>
    /// <param name="obj">The object to serialize. </param>
    /// <param name="serializer">The object that is responsible for the serialization. </param>
    /// <returns>An object that contains key/value pairs that represent the object’s data. </returns>
    /// <exception cref="InvalidOperationException"><paramref name="obj"/> must be of the <see cref="MyExampleType"/> type</exception>
    public override IDictionary<string, object> Serialize(object obj, JavaScriptSerializer serializer)
    {
        MyExampleType example = obj as MyExampleType;
        if (example == null)
        {
            throw new InvalidOperationException("object must be of the MyExampleType type");
        }

        IDictionary<string, object> jsonExample = new Dictionary<string, object>();
        jsonExample.Add("arrayMember", example.People.ToArray());
        jsonExample.Add("otherMember", example.Member);

        return jsonExample;
    }
} 
```

这被称为：

```
JavaScriptSerializer serializer = new JavaScriptSerializer();
serializer.RegisterConverters(new JavaScriptConverter[] { new ExampleConverter() });
return serializer.Serialize(myExample); 
```

# ms-office - MS Office 97 ODE 设置向导挂起并显示消息“找不到路径”

> ID：596595
> 
> 赞同：0
> 
> 时间：2009-02-27T20:40:03.030
> 
> 标签：ms-office, installation, legacy, wizard

我有一个客户使用 Access 97 运行时来支持他们的部分产品。理想情况下，考虑到这样做的预算，我会在此时替换那只恐龙，但今天这不是一个选择。我不是系统的原始作者，但我正在尝试提供持续的支持。

为了将它分发给他们的客户，他们购买了 Office 97 开发人员版工具，并且每隔几年他们就会通过它的安装向导打包一个新的分发版。

这一次，设置向导似乎达到了它想要对 做某事的地步，`AXDIST.EXE`而是弹出一个对话框，只显示“找不到路径”。我在网络上找到的唯一参考资料是对一个不再存在的域中的页面的诱人一瞥，谷歌已经清除了缓存，只保留了搜索结果中出现的句子。提示不足以帮助我...

（**编辑：**除了由 AXDIST.EXE 本身引起的许多报告问题，或者尝试以某种方式使用 AXDIST.EXE 的安装之外，也就是说。我们的问题是使用 ODE 安装向导创建安装包期间的问题. 它自己的文档只在一处引用了 AXDIST，根本不包含文本“找不到路径”。）

（**编辑 2：**进一步调查显示 AXDIST.EXE 本身不是罪魁祸首。从安装向导的列表中删除该文件导致向导在列表中的下一个文件上停止。描述之间似乎没有任何显着差异它停止的文件，以及上面列出的十几个*已*成功处理的文件。我猜测此时的解决方案将是从头开始手动重新创建模板，如果它并没有被困在可怕的 UI 中，而是以 Access 数据库的形式存储，其中包含一堆未记录的表。）

我的问题是：这次我们在设置向导中犯了什么错误，我们该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T07:26:50.370

事实证明，该问题与设置向导中明确列出的 Access 运行时功能有关，但应该留给向导进行推断。

我对任何也坚持使用向导的人的一般建议是回到开始并仔细而有条不紊地检查所有设置。

# jquery - 从右向左滑动？

> ID：596608
> 
> 赞同：408
> 
> 时间：2009-02-27T20:43:52.363
> 
> 标签：jquery, html, css, jquery-ui, position

我怎样才能让一个 div 从折叠到展开（反之亦然），但从右到左这样做？

我在那里看到的大多数东西总是从左到右。

* * *

## 回答 #1

> 赞同：393
> 
> 时间：2009-03-05T15:20:58.987

```
$("#slide").animate({width:'toggle'},350); 
```

参考：[https ://api.jquery.com/animate/](https://api.jquery.com/animate/)

* * *

## 回答 #2

> 赞同：243
> 
> 时间：2012-02-14T17:27:29.463

这可以使用 jQueryUI 隐藏/显示方法本地实现。例如。

```
 // To slide something leftwards into view,
    // with a delay of 1000 msec
    $("div").click(function () {
          $(this).show("slide", { direction: "left" }, 1000);
    }); 
```

参考：[http ://docs.jquery.com/UI/Effects/Slide](http://docs.jquery.com/UI/Effects/Slide)

* * *

## 回答 #3

> 赞同：77
> 
> 时间：2012-12-15T13:58:25.490

用这个：

```
$('#pollSlider-button').animate({"margin-right": '+=200'}); 
```

[现场演示](http://jsfiddle.net/XNnHC/3/)

*改良版*

演示中添加了一些代码，以防止双击时出现双页边距：http: [//jsfiddle.net/XNnHC/942/](http://jsfiddle.net/XNnHC/942/)

与缓动一起使用；）

[http://jsfiddle.net/XNnHC/1591/](http://jsfiddle.net/XNnHC/1591/)

*   删除了额外的 JavaScript 代码。

*   类名和一些 CSS 代码已更改

*   添加了查找是否展开或折叠的功能

*   改变是否使用缓动效果

*   改变动画速度

[http://jsfiddle.net/XNnHC/1808/](http://jsfiddle.net/XNnHC/1808/)

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2013-01-10T17:59:25.557

看看这个使用[jQuery UI的 Fiddle 上的](http://en.wikipedia.org/wiki/JQuery_UI)[工作示例](http://jsfiddle.net/erwinjulius/az4JL/)。这是我最初从左到右使用的解决方案，但我已将其更改为从右到左工作。

它允许用户快速单击链接，而不会破坏可用面板之间的动画。

JavaScript 代码很简单：

```
$(document).ready(function(){
    // Mostra e nascondi view-news
    var active = "europa-view";
    $('a.view-list-item').click(function () {
        var divname= this.name;
        $("#"+active ).hide("slide", { direction: "right" }, 1200);
        $("#"+divname).delay(400).show("slide", { direction: "right" }, 1200);
        active = divname;
    });
}); 
```

在 Fiddle 链接上获取 HTML 和 CSS。

添加白色背景和左填充只是为了更好的效果呈现。

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2012-12-31T08:18:35.537

用这个

```
<script src="jquery.min.js"></script>
<script src="jquery-ui.min.js"></script>
<script>
    $(document).ready(function(){
        $("#flip").click(function () {
            $("#left_panel").toggle("slide", { direction: "left" }, 1000);
        });
    });
</script> 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2017-05-07T12:09:22.440

```
$(function() {
  $('.button').click(function() {
    $(this).toggleClass('active');
    $('.yourclass').toggle("slide", {direction: "right"}, 1000);
  });
}); 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2012-05-10T11:20:45.997

我是这样做的：

```
var btn_width = btn.width();
btn.width(0);
btn.show().animate({width: btn_width}, {duration: 500}); 
```

请注意，该节点“btn”应该在动画之前隐藏，您可能还需要为其设置“位置：绝对”。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2019-08-27T23:12:10.593

或者你可以使用

```
$('#myDiv').toggle("slide:right"); 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2016-11-11T15:25:24.767

另一个值得一提的库是[animate.css](https://github.com/daneden/animate.css)。它与 jQuery 一起工作得很好，你可以通过切换 CSS 类来制作很多有趣的动画。

喜欢..

> $("#slide").toggle().toggleClass('动画bounceInLeft');

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2015-11-05T18:10:24.523

带有`TweenLite`/**[的GreenSock 动画平台 (GSAP)](http://greensock.com/gsap)**`TweenMax`提供了比 jQuery 或 CSS3 过渡更平滑的过渡和更多的自定义。为了使用 TweenLite / TweenMax 为 CSS 属性设置动画，您还需要他们的名为“CSSPlugin”的插件。TweenMax 自动包含此内容。

**首先，加载 TweenMax 库：**

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.18.0/TweenMax.min.js"></script> 
```

**或者轻量级版本，TweenLite：**

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.18.0/plugins/CSSPlugin.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.18.0/easing/EasePack.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.18.0/TweenLite.min.js"></script> 
```

**然后，调用你的动画：**

```
 var myObj= document.getElementById("myDiv");

// Syntax: (target, speed, {distance, ease})
 TweenLite.to(myObj, .7, { x: 500, ease: Power3.easeOut}); 
```

**您也可以使用 ID 选择器调用它：**

```
 TweenLite.to("#myID", .7, { x: 500, ease: Power3.easeOut}); 
```

**如果您加载了 jQuery，您可以使用更高级的广泛选择器，例如包含特定类的所有元素：**

```
 // This will parse the selectors using jQuery's engine.
TweenLite.to(".myClass", .7, { x: 500, ease: Power3.easeOut}); 
```

**有关完整详细信息，请参阅： [TweenLite 文档](http://greensock.com/docs/#/HTML5/GSAP/TweenLite/)**

根据他们的网站： *“TweenLite 是一个极其快速、轻量级和灵活的动画工具，它是 GreenSock 动画平台 (GSAP) 的基础。”*

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2016-05-27T15:45:53.393

**一个没有 jQuery UI**的从右到左动画的例子，只有 jQuery（任何版本，请参阅[https://api.jquery.com/animate/](https://api.jquery.com/animate/)）。

```
$(document).ready(function() {
  var contentLastMarginLeft = 0;
  $(".wrap").click(function() {
    var box = $(".content");
    var newValue = contentLastMarginLeft;
    contentLastMarginLeft = box.css("margin-left");
    box.animate({
      "margin-left": newValue
    }, 500);
  });
});
```

```
.wrap {
  background-color: #999;
  width: 200px;
  overflow: hidden;
}
.content {
  width: 100%;
  margin-left: 100%;
  background-color: #eee;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<div class="wrap">
  click here
  <div class="content">
    I would like to have a div go from collapsed to expanded (and vice versa), but do so from right to left. Most everything I see out there is always left to right.
  </div>
</div>
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2013-05-30T07:37:58.173

您可以首先将元素的宽度定义为 0，向右浮动，然后在您将要显示它的事件上.. 它会像

```
$('#the_element_to_slide_from_right_left').animate({ width:'your desired width' }, 600); 
```

就那么简单。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2016-07-22T22:25:00.613

在此处查看示例。

```
$("#slider").animate({width:'toggle'}); 
```

[https://jsfiddle.net/q1pdgn96/2/](https://jsfiddle.net/q1pdgn96/2/)

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2017-10-31T15:54:29.007

我使用滚动（仅 HTML、CSS 和 JS，仅使用 jquery 库）完成的示例。**向下滚动时，按钮将向左滑动。**

另外，我建议你如果你唯一想要的就是这个效果，不要使用 jQuery UI，因为它太重了（如果你只是想用它）。

```
$(window).scroll(function(){
  if ($(this).scrollTop() > 100) {
          event.preventDefault();
          $(".scrollToTop").css({'transform': 'translate(0px, 0px)'});
      } else {
          $(".scrollToTop").css({'transform': 'translate(40px, 0px)'});
      }
  }); 
```

检查[这个例子](https://codepen.io/w0nk/pen/zPGEgO)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2018-06-14T16:07:32.593

如果您`div`绝对定位并且您知道宽度，则可以使用：

```
#myDiv{
position:absolute;
left: 0;
width: 200px;
}

$('#myDiv').animate({left:'-200'},1000); 
```

这会将其滑出屏幕。

或者，您可以将其包装在一个容器中`div`

```
#myContainer{
position:relative;
width: 200px;
overflow: hidden;
}

#myDiv{
position:absolute;
top: 0;
left: 0;
width: 200px;
}

<div id="myContainer">

<div id="myDiv">Wheee!</div>

</div>

$('#myDiv').animate({left:'-200'},1000); 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-01-08T12:45:55.430

我在尝试为小屏幕尺寸编写菜单时遇到了类似的问题。我采用的解决方案是将其从视口中推开。

我使用 SASS 和 JQuery（无 JQuery UI）制作了这个，但这都可以在原生 JS 和 CSS 中实现。

[https://codepen.io/maxbethke/pen/oNzMLRa](https://codepen.io/maxbethke/pen/oNzMLRa)

```
var menuOpen = false

var init = () => {
    $(".menu__toggle, .menu__blackout").on("click", menuToggle)
}

var menuToggle = () => {
    console.log("Menu:Toggle");
    $(".menu__blackout").fadeToggle();

    if(menuOpen) { // close menu
        $(".menu__collapse").css({
            left: "-80vw",
            right: "100vw"
        });
    } else { // open menu
        $(".menu__collapse").css({
            left: "0",
            right: "20vw"
        });
    }

    menuOpen = !menuOpen;
}

$(document).ready(init);
```

```
.menu__toggle {
    position: absolute;
    right: 0;
    z-index: 1;
}

.menu__blackout {
  display: none;
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  background-color: rgba(0, 0, 0, 0.5);
  z-index: 10;
}

.menu__collapse {
  position: absolute;
  top: 0;
  right: 100vw;
  bottom: 0;
  left: -80vw;
  background: white;
  -webkit-transition: ease-in-out all 1s;
  transition: ease-in-out all 1s;
  z-index: 11;
}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<button class="menu__toggle">Toggle menu</button>

<menu class="menu">
  <div class="menu__blackout"></div>
  <div class="menu__collapse">
    <ul class="list">
      <li class="list__item">
        <a class="list__item__link" href="#section1">Menu Item 1</a>
      </li>
      <li class="list__item">
        <a class="list__item__link" href="#section2">Menu Item 2</a>
      </li>
      <li class="list__item">
        <a class="list__item__link" href="#section3">Menu Item 3</a>
      </li>
      <li class="list__item">
        <a class="list__item__link" href="#section4">Menu Item 4</a>
      </li>
      <li class="list__item">
        <a class="list__item__link" href="#section5">Menu Item 5</a>
      </li>
    </ul>
  </div>
</menu>
```

# django - 使用 json 文件在开发服务器中测试文档上传

> ID：596610
> 
> 赞同：1
> 
> 时间：2009-02-27T20:44:00.913
> 
> 标签：django, json, testing

我刚刚构建了一个小应用程序（使用 Django），它将接受任何求职者的简历。因此，任何求职者都以提供的表格上传他/她的简历。如何使用测试用例进行测试。我习惯于使用 json 文件为我的初始数据编写固定装置。我怎么会有与 doc 文件相同的东西？因此，我只想在一组不同的简历上运行我的测试用例。我怎样才能以最小的复杂性实现这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-28T02:02:16.983

你可以试试[django 假文件上传](http://www.djangosnippets.org/snippets/1300/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-24T07:40:36.297

当然，这是我想出的一个解决方法。我将所有 .doc 文件放在 /fixtures/ 目录中，然后手动打开并阅读它们。喜欢：

> MyTests 类（TestCase）：

```
 def setUp(self):
        from django.test.client import Client
        self.client = Client()
        self.file = open(settings.FILES + 'somefile.doc', 'rb')

    def test_someusecase(self):
        signup_data = {'fname':"Alexander", 'email':'someexistingemail@gmail.COM', 'file':self.file}
        response = self.client.post(path='/signup/', data=signup_data) 
```

所以它只是完成我的工作的另一种方式。我确信它不是最好的解决方案。如果有人找到！让我知道。

# sql - Mysql4：用于选择一条或零条记录的 SQL

> ID：596629
> 
> 赞同：1
> 
> 时间：2009-02-27T20:48:27.830
> 
> 标签：sql, mysql, database

表布局：

```
CREATE TABLE t_order  (id INT, custId INT, order DATE) 
```

我正在寻找一个 SQL 命令来为每个订单选择最多一行（拥有该订单的客户由名为 custId 的字段标识）。

如果没有为任何行提供订单日期，我想选择*一个*客户的订单（不管是哪一个，比如按 id 排序）。

如果已经有给定订单日期的记录，我想为 customerId 检索一个空的结果集。

这是一个例子。每个客户最多应该有一份订单（一份没有给出日期）。已经有日期值的订单根本不应该出现。

```
  +-------------------------------------------------- --------+
  |标识 | 客户 ID | 日期 |
  +-------------------------------------------------- --------+
  | 1 10 空 |
  | 2 11 2008-11-11 |
  | 3 12 2008-10-23 |
  | 4 11 空 |
  | 5 13 空 |
  | 6 13 空 |
  +-------------------------------------------------- --------+
                           |
                           |
                           | 结果
                         \ | /
                          \ /
  +-------------------------------------------------- --------+
  |标识 | 客户 ID | 日期 |
  +-------------------------------------------------- --------+
  | 1 10 空 |
  | |
  | |
  | |
  | 5 13 空 |
  | |
  +-------------------------------------------------- --------+
                                供电是 JavE

```

编辑：我选择了 glavić 的答案作为正确答案，因为它提供了正确的结果和稍微修改的数据：

```
  +-------------------------------------------------- --------+
  |标识 | 客户 ID | 日期 |
  +-------------------------------------------------- --------+
  | 1 10 空 |
  | 2 11 2008-11-11 |
  | 3 12 2008-10-23 |
  | 4 11 空 |
  | 5 13 空 |
  | 6 13 空 |
  | 7 11 空 |
  +-------------------------------------------------- --------+

```

当客户出现两次以上时，Sfossen 的答案将不起作用，因为它的 where 子句约束 a.id != b.id。

Quassnoi 的答案对我不起作用，因为我运行服务器版本 4.0.24 会产生以下错误： [alt text http://img25.imageshack.us/img25/8186/picture1vyj.png](http://img25.imageshack.us/img25/8186/picture1vyj.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T21:24:11.847

对于特定客户，它是：

```
SELECT *
FROM t_order
WHERE date IS NULL AND custId=? LIMIT 1 
```

对于所有客户，其：

```
SELECT a.*
FROM t_order a 
    LEFT JOIN t_order b ON a.custId=b.custID and a.id != b.id
WHERE a.date IS NULL AND b.date IS NULL
GROUP BY custId; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T20:54:39.857

试试这个：

```
SELECT to1.*
FROM t_order AS to1
WHERE
    to1.date IS NULL AND 
    to1.custId NOT IN (
        SELECT to2.custId
        FROM t_order AS to2
        WHERE to2.date IS NOT NULL
        GROUP BY to2.custId
    )
GROUP BY to1.custId 
```

对于 MySQL 4：

```
SELECT to1.*
FROM t_order AS to1
LEFT JOIN t_order AS to2 ON
    to2.custId = to1.custId AND
    to2.date IS NOT NULL
WHERE
    to1.date IS NULL AND 
    to2.id IS NULL
GROUP BY to1.custId 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T22:28:59.273

此查询将在`custId`.

对于每个不同的`custId`，它将在同一索引上使用一个子查询。

不`GROUP BY`，不`TEMPORARY`，不`FILESORT`——如果你的桌子很大，效率很高。

```
SELECT VERSION()

--------
'4.1.22-standard'

CREATE INDEX ix_order_cust_id ON t_order(custId)

SELECT id, custId, order_date
FROM (
  SELECT o.*,
    CASE
      WHEN custId <> @c THEN
        (
        SELECT 1
        FROM   t_order oi
        WHERE  oi.custId = o.custId
          AND  order_date IS NOT NULL
        LIMIT 1
        )
    END AS n,
    @c <> custId AS f,
    @c := custId
  FROM
    (
    SELECT @c := -1
    ) r,
    t_order o
  ORDER BY custId
) oo
WHERE n IS NULL AND f

---------
1, 10, ''
5, 13, '' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T22:58:04.273

首先过滤掉带有日期的行，然后过滤掉任何具有较低 id 的类似行的行。这应该有效，因为如果 id 是唯一的，则具有最少 id 的匹配记录是唯一的。

```
select * from t_order o1
    where date is null
      and not exists (select * from t_order o2
                         where o2.date is null
                           and o1.custId = o2.custId
                           and o1.id > o2.id) 
```

# windows - 构建调度应用程序需要查看哪些 Windows API？

> ID：596631
> 
> 赞同：1
> 
> 时间：2009-02-27T20:48:43.617
> 
> 标签：windows, delphi, scheduling

为什么不使用 Windows 调度程序？我有几个应用程序必须根据业务规则在特定时间运行，而不是典型的每个工作日下午 1 点。

我还需要一种让应用程序提供其进度反馈的方法，以便我可以制定规则，在应用程序运行缓慢或什至不再运行时通知我。

我应该研究什么 Windows API？（例如，FileWatcher api 的时间版本）

让应用程序通知调度程序其进度（文件、套接字、Windows 消息、???）的最佳方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T21:07:35.647

AppControls 有一个[CronJob](http://www.appcontrols.com/components.html#CronJob)组件，您可以使用它来创建计划事件。这使您的程序不必每分钟醒来并检查时间表本身。相反，只需安排作业并指示回调方法。

我自己使用这个组件来安排工作，并且对它的工作方式非常满意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T21:42:02.880

对于 Vista/Win2k8，有很好的 Task Scheduler 2.0 API： http: [//msdn.microsoft.com/en-us/library/aa384138](http://msdn.microsoft.com/en-us/library/aa384138(VS.85).aspx) (VS.85).aspx 。以前的版本有 Task Scheduler 1.0 API，但我从未使用过它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T22:22:23.860

我认为您真正想要的是一个通用框架，用于您的应用程序报告某些东西（您或系统消息或跟踪或性能、事件日志等），并通过一些进程间协议接收一种接收消息和响应的方式。

根据报告，您可以更改计划或进行更改等。

因此，有一些监控应用程序，然后您的每个其他应用程序都会进行通用报告。

我能想到的事件： - 开始 - 停止 - 错误 - 正常的日志消息 - 当然还有你的应用程序所做的特定事情。

我认为可能有现有的类/框架可以做到这一点 - 你必须检查一下。

如果是我，我会创建一个可以与所有其他应用程序通信的服务，甚至可能是一个 http 服务器。它将能够将消息路由到特定应用程序并开始停止这些进程并查询它们。

不过，有很多方法可以做你想做的事。这些只是我的想法。

或者，您可能只是能够让这些成为服务，并且它们处理发送给它们的消息。在他们被一些任务命令“唤醒”之前，他们的正常处理什么都不做。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-28T11:07:29.013

你有更多的问题。通常你应该拆分它们。但是让我们忽略这一点并尝试回答。

1.  要安排某些事件（包括运行应用程序）：使用 JVCL 中的 TJvScheduledEvents。恕我直言， [JVCL](http://jvcl.sourceforge.net/)是最好的 Delphi 开源库，拥有大量组件、开发人员和支持。TJvScheduledEvents 非常简洁，使用线程进行事件调度，并且您在 JVCL 中有一个详细的事件编辑器（不过它需要一个小技巧才能使用它）。

2.  从您的应用程序向（远程）中心点提供“反馈”：一个非常非常好的解决方案（如果您的要求允许）是将应用程序的进度记录在[Firebird](http://firebirdsql.org/)服务器上的表中（我们称之为 LOG）。在 LOG 中，您可以有以下字段：COMPUTER、USERNAME、APPNAME、MSG、LOGDATE（等等）。在 LOG 表的 After Insert 触发器中，您可以触发一个事件（我们称之为 NEW_LOG）。在您的控制台应用程序中，您可以注册对此事件的兴趣，因此，您的应用程序将自动更新您的任何应用程序中发生的所有事情，因此您可以进行日志分析、图表等。当然您可以使用 IB 来完成，但是IB费用。

...继续 Windows API 路由，您需要标头（可能没有翻译），您会遇到我们最亲爱的指针/PChars 等。当然，从头开始构建一切是不值得的，但是当这已经完成时以德尔福的方式，为什么不使用它？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T20:55:12.243

使用带有定期（例如每分钟）触发的计时器的服务。它读取计划并查看是否有一些在下一次迭代之前到期。如果是这样，您可以执行它们。

您可以添加一个显示所有正在运行的应用程序的界面。对于使用桌面应用程序的反馈和查询。

# apache-flex - 使用 Flex 上传文件夹中的所有文件

> ID：596632
> 
> 赞同：0
> 
> 时间：2009-02-27T20:48:49.980
> 
> 标签：apache-flex, jsp

我想用 Flex 做一个文件上传器。但是，我希望它选择一个文件夹并上传文件夹中的所有文件。如果我可以在上传之前实际检查文件会更好。

我在后端使用带有 JSP 的 Flex。有没有办法做到这一点？

到目前为止，我从谷歌搜索中发现的只是如何制作文件上传器来上传单个文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T20:53:41.140

[您可以使用FileReferenceList](http://livedocs.adobe.com/flex/3/langref/flash/net/FileReferenceList.html)类上传多个文件。链接底部有一个示例。

> 当调用 FileReferenceList.browse() 方法并且用户从 browse() 方法打开的对话框中选择了一个或多个文件时，此属性将填充一个 FileReference 对象数组，每个对象代表用户的文件选择。然后，您可以使用此数组通过 FileReference.upload() 方法上传每个文件。您必须一次上传一个文件。

# c++ - C++：函数/方法声明中与号“&”和星号“*”之间的区别？

> ID：596636
> 
> 赞同：78
> 
> 时间：2009-02-27T20:49:53.007
> 
> 标签：c++, pointers, reference

它们之间是否存在某种微妙的区别：

```
void a1(float &b) {
    b=1;
};
a1(b); 
```

和

```
void a1(float *b) {
    (*b)=1;
};
a1(&b); 
```

?

他们都做同样的事情（或者从 main() 看来），但第一个显然更短，但是我看到的大多数代码都使用第二种表示法。有区别吗？也许万一它是一些对象而不是浮动？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-02-27T20:51:47.633

两者都做同样的事情，但一个使用引用，一个使用指针。

[有关所有差异的完整列表，请参阅我的答案](https://stackoverflow.com/questions/57483/difference-between-pointer-variable-and-reference-variable-in-c/57492#57492)。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-02-27T20:59:25.633

是的。该`*`符号表示在堆栈上传递的是一个指针，即某物的地址。`&`说是参考。效果类似但不完全相同：

让我们来看两个案例：

```
 void examP(int* ip);
   void examR(int& i);

   int i; 
```

如果我打电话`examP`，我会写

```
 examP(&i); 
```

它获取项目的地址并将其传递到堆栈上。如果我打电话`examR`，

```
 examR(i); 
```

我不需要它；现在编译器“以某种方式”传递了一个引用——这实际上意味着它获取并传递`i`. 在代码方面，然后

```
 void examP(int* ip){
        *ip += 1;
   } 
```

我必须确保取消引用指针。 `ip += 1`做一些非常不同的事情。

```
 void examR(int& i){
        i += 1;
   } 
```

总是更新 的值`i`。

如需更多思考，请阅读“按引用调用”与“按值调用”。该`&`概念通过引用提供 C++ 调用。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-27T20:53:28.817

在第一个带有引用的示例中，您知道它`b`不能为 NULL。对于指针示例，`b`可能是 NULL 指针。

但是，请注意，*可以*通过引用传递 NULL 对象，但这很尴尬，并且被调用的过程可以假定这样做是错误的：

```
a1(*(float *)NULL); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-27T20:53:57.583

在第二个例子中，*调用者*必须在变量名前加上'&'来传递变量的地址。

这可能是一个优势——当调用者认为他们是按值传递时，调用者不能通过将变量作为引用传递来无意中修改变量。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-27T20:54:29.577

除了语法糖之外，唯一真正的区别是作为指针的函数参数可以为空。因此，如果指针版本正确处理空大小写，则可以更具表现力。null case 也可以附加一些特殊的含义。参考版本只能对指定类型的值进行操作，而没有 null 能力。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-27T20:54:26.660

在您的示例中，两个版本的功能相同。

第一个优点是它在调用端是透明的。想象一下它会如何寻找操作员：

```
cin >> &x; 
```

以及它对于交换调用的外观如何

```
swap(&a, &b); 
```

你想交换a和b。而且它看起来比您第一次必须获取地址时要好得多。顺便说一句，bjarne stroustrup 写道，引用的主要原因是在调用端添加的透明度 - 特别是对于操作员。另请参阅以下是否不再明显

```
&a + 10 
```

将 10 添加到 a 的内容，调用它的 operator+，或者是否将 10 添加到指向 a 的临时指针。再加上不可能只为内置操作数（如指针和整数）重载运算符。参考资料使这一点一目了然。

如果您希望能够放置“null”，则指针很有用：

```
a1(0); 
```

然后在 a1 中，该方法可以将指针与 0 进行比较，并查看指针是否指向任何对象。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-28T15:02:42.487

值得注意的一大区别是外面发生了什么，你要么有：

```
a1(something); 
```

或者：

```
a1(&something); 
```

我喜欢通过引用传递参数（总是一个 const one :)）当它们没有在函数/方法中修改时（然后你也可以在里面传递自动/临时对象）并通过指针传递它们来表示和提醒用户/调用该参数的方法的代码的读者可能并且很可能在内部被有意修改。

# iphone - 多点触控在我正在构建的 iphone 应用程序中不起作用

> ID：596638
> 
> 赞同：3
> 
> 时间：2009-02-27T20:50:27.700
> 
> 标签：iphone, objective-c, ipod-touch

我有以下代码：

```
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {

NSUInteger touchCount = 0;
// Enumerates through all touch objects
for (UITouch *touchb in touches){
    touchCount++;
}

// When multiple touches, report the number of touches. 
if (touchCount > 1) {
    lblStatustouch.text = [NSString stringWithFormat:@"Tracking %d touches", touchCount];
} else {
    lblStatustouch.text = [NSString stringWithFormat:@"Tracking 1 touch", touchCount];
} 
```

当我运行它时，它永远不会检测到一次以上的触摸。是否有一些设置可能会阻止我的应用程序进行多次触摸？或者我在这里错过了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-27T20:55:08.373

您需要在 InterfaceBuilder 中的视图上启用“多点触控”

[替代文字 http://img.skitch.com/20090227-rpkafsxtg56pujk1h1583if88i.jpg](http://img.skitch.com/20090227-rpkafsxtg56pujk1h1583if88i.jpg)

或者，如果您已经在代码中创建了视图，则它设置为

```
[theView setMultipleTouchEnabled:YES]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-10T01:09:19.157

*还要知道，如果两个手指同时*移动，您只会在 touchesMoved 中获得多次触摸。如果您将一根手指固定在屏幕上，然后移动另一根手指，手机将只报告正在移动的手指。

# sql - vb.net 循环查询结果

> ID：596639
> 
> 赞同：2
> 
> 时间：2009-02-27T20:50:38.057
> 
> 标签：sql, vb.net, iteration

我熟悉处理 SQL 查询和循环记录集结果的 VB6 ADO 方式。

但是，查询服务器、循环查看结果并在 VB.Net 中处理我的查询的正确方法是什么？我一直使用的所有方式似乎都不稳定并且随机崩溃。

我一直在使用以下代码：

```
Public Function GetSQLTable(ByVal strSQL As String) As DataTable
    Dim table As New DataTable
    Dim adapt As SqlDataAdapter

    Try
        adapt = New SqlDataAdapter(strSQL, gconIntegration)
        adapt.Fill(table)
    Catch ex As Exception
        LogError("GetSQLTable: " & ex.ToString(), "SQL: " & strSQL)
    End Try

    Return table
End Function 
```

并像这样使用它：

```
 Dim dt As DataTable
 Dim lngRow As Long
 Dim current As DataRow
 Dim lngContact As long

 Try
        dt = GetSQLTable(strSQL)
        For lngRow = 0 To dt.Rows.Count - 1
            current = dt.Rows.Item(lngRow)
            lngContact = current.Item("indvid") 
            DoSomething(lngContact)
        Next
Catch ex As Exception
    LogError("FindContact: " & ex.ToString(), "SQL: " & strSQL)
    lngContact = -1     
 Finally
    current = nothing
    dt = nothing 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-27T21:01:57.703

我怀疑问题与您管理`gconIntegration`连接的方式有关。您正在努力保持使用相同的连接。看看它住在哪里会很有帮助。

最好从池中获取“新”连接，让 .Net 为您担心。

此外，您的通用“GetSQLTable”代码缺少一个重要部分：它不允许设置参数，这告诉我您正在将它们直接构建到查询字符串中。这是灾难的秘诀：它将导致 Sql 注入安全漏洞。

还有一件事：不要`Nothing`在 .Net 中设置对象。如果需要，要么处置它们，要么让它们自行超出范围。

这是我从数据表中拉回数据表的常规方法：

```
Function GetSomeData(ByVal Table2ID As Integer)
    Dim result As New DataTable

    Dim sql As String = "SELECT Column1,Column2 FROM [Table1] WHERE Table2ID= @Table2ID"

    Using cn As New SqlConnection( GetConnectionString() ), _
    Using cmd As New SqlCommand(sql, cn)

        cmd.Parameters.Add("@Table2ID", SqlDbType.Int).Value = Table2ID

        Using rdr As SqlDataReader = cmd.ExecuteReader()
           result.Load(rdr)
        End Using
    End Using
    return result
End Function 
```

关于该代码的一些注释：

*   该`Using`语句将保证关联的对象被放置在相应的`End Using`.
*   查询参数保持强类型，并且*永远不会*直接替换到查询字符串中，即使它们被传输到服务器。Sql 数据和 Sql 代码永远不会混合。
*   对于需要发送的每个查询，您确实需要一个单独的函数。这确实是一件好事，因为它会导致为您的数据库构建强类型接口。理想情况下，所有这些函数都在同一个类中，并且 GetConnectionString 函数是该类私有的。在此数据层之外不会发生任何数据库访问。

# asp.net - 如何在 GridView 的 HyperLinkField 中传递页码？

> ID：596640
> 
> 赞同：0
> 
> 时间：2009-02-27T20:50:42.707
> 
> 标签：asp.net, vb.net, gridview

我有我正在使用分页的gridview。我想在 asp:Hyperlink 中传递当前页面，以便在他们查看完记录的详细信息后将它们发送回当前页面。这可能吗？如果是我该怎么做？

```
<asp:GridView ID="grdObitList" runat="server" allowpaging="true"
            PageSize="10" AutoGenerateColumns="false" CssClass="grdClass" 
                BorderStyle="None" GridLines="None" CellSpacing="2" >
            <PagerStyle HorizontalAlign="Center" />
            <PagerSettings Position="Bottom" FirstPageText="First" LastPageText="Last" Mode="NumericFirstLast"  />
               <Columns>     
                   <asp:HyperLinkField HeaderText="Name" DataTextField="obit_fullname" DataNavigateUrlFields="obit_id" DataNavigateUrlFormatString="obitDisplay.aspx?oid={0}" />                                     
                   <asp:BoundField ReadOnly="true" HeaderText="Date" DataField="obit_dod" DataFormatString="{0:d/M/yyyy}" />
                   <asp:BoundField ReadOnly="true" HeaderText="Resident Of" DataField="obit_resident" />
                   <asp:BoundField ReadOnly="true" HeaderText="Funeral Home" DataField="obit_funeralhome" />
               </Columns> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T20:53:31.077

一种方法是将其转换为模板列，这样您就可以使用普通的数据绑定语法来获取它 (<%#)

# php - 当我不能使用 PDO 时，当我使用 MySQL 时，我应该使用哪个，pear MDB2 或 pear DB_DataObject？

> ID：596644
> 
> 赞同：0
> 
> 时间：2009-02-27T20:52:14.357
> 
> 标签：php, mysql, database, pear, mdb2

几乎所有免费的虚拟主机服务器，

你不能使用 PDO + MySQL。

他们缺乏 PDO 驱动程序。

所以我正在考虑选择

梨MDB2，

或 DB_DataObject。

你向我推荐哪个？

给我你的意见！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-28T01:58:33.933

如果可以的话，我实际上会推荐使用[Mysqli函数。](http://us2.php.net/mysqli)它们速度快，文档齐全，并且得到了整个 php 社区的良好支持。

如果您正在寻找更强大的数据库抽象层，我建议您首先查看任何优秀的库，如 DataMapper、Propel 或 Doctrine，甚至使用 Zend 等框架的必要部分。进一步说明，我过去使用过 Adodb，但最近没有看到太多支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T20:55:43.693

我已经使用了很多 MDB2，但发现内置的 mysqli 函数快速且易于使用，而且它们可以轻松集成到您自己的数据库抽象层中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-28T08:17:18.920

[ADOdb](http://adodb.sourceforge.net/)也不错。

PHP 版本目前支持数量惊人的数据库，这要归功于出色的 ADOdb 社区：MySQL、PostgreSQL、Interbase、Firebird、Informix、Oracle、MS SQL、Foxpro、Access、ADO、Sybase、FrontBase、DB2、SAP DB、SQLite、 Netezza、LDAP 和通用 ODBC、ODBTP。Sybase、Informix、FrontBase 和 PostgreSQL、Netezza、LDAP、ODBTP 驱动程序是社区贡献的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-28T09:47:55.287

DB_DataObject 依赖于 MDB2，所以无论如何你都必须拥有它。

问题是：您只需要裸数据库独立性还是更高级的 ORM（即 DB_DataObject）。

我建议您坚持使用 MDB2，因为您似乎对这些东西感到困惑。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-09-22T12:08:39.483

您可以毫无问题地将**DB_DataObject**与**MDB2**一起使用。

# asp.net - 检查是什么控件发起了 AJAX 请求

> ID：596645
> 
> 赞同：3
> 
> 时间：2009-02-27T20:52:20.270
> 
> 标签：asp.net, javascript, jquery, ajax, pagerequestmanager

asp.net 2.0 / jQuery / AJAX

```
<script type="text/javascript">
//updated to show proper method signature

var prm = Sys.WebForms.PageRequestManager.getInstance();

prm.add_endRequest(hideMessage);

function hideMessage(sender, args)
{
    var ctl = args.get_postBackElement();
    //check if ctl is the disired control
    //hide user notification message
}
</script> 
```

我在页面上有几个控件可能会启动 AJAX 请求，但我只希望我的 js 在我单击一个特定按钮时触发。我如何检查发起请求的控件是什么，以便我可以相应地触发 JS。

**编辑：**我解决了它，但我仍然想知道我是否可以这样做。

**澄清：**我不能从 onclick 事件中调用 JS，因为页面在 UpdatePanel 内，我只希望 JS 在 AJAX 请求结束时执行，并且它是由页面上的一个特定按钮触发的。在服务器端，我将 myLabel.Text 设置为一些文本，然后 js 检查 $(myLabel.CliendID) 的 innerHTML 是否不为空并触发 js。检查 innerHTML 是我的解决方法，因为我不知道如何检查 AJAX 请求的“发件人”。希望这现在更有意义。

**编辑2：**我已经阅读了一些[文档](http://msdn.microsoft.com/en-us/library/bb311028.aspx)，结果你可以检查“发件人”控件。

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-27T23:49:10.937

这就是我在代码中所做的，以确定是什么控件初始化了请求。所有的 JavaScript 代码。

```
function pageLoad() {
    if (!Sys.WebForms.PageRequestManager.getInstance().get_isInAsyncPostBack()) {
        Sys.WebForms.PageRequestManager.getInstance().add_endRequest(endRequestHandler);
        Sys.WebForms.PageRequestManager.getInstance().add_initializeRequest(initializeRequest);
    }
}
function endRequestHandler(sender, args) {
    if (sender._postBackSettings.sourceElement.id == '<%= gvResults.ClientID %>')        {
        //do something because of this...
    }
}
function initializeRequest(sender, args) {
    if (CheckForSessionTimeout()) {
        args.set_cancel(true);
    }
    else {
        if (sender._postBackSettings.sourceElement.id == '<%= gvResults.ClientID %>') {
             //do something because of this
        }
    }
} 
```

**编辑**
这是在客户端检查超时的方法。

```
var sessionTimeoutDateTime = new Date();
    var sessionTimeoutInterval = <%= this.SesstionTimeoutMinutes %>;

    function CheckForSessionTimeout() {
        var currentDateTime = new Date()
        var iMiliSeconds = (currentDateTime - sessionTimeoutDateTime);
        if (iMiliSeconds >= sessionTimeoutInterval) {
            ShowSessionTimeout();
            return true;
        }
        return false;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T21:40:13.837

我建议您不要让每个控件都执行相同的 javascript 函数。或者，如果他们这样做，则传递一个参数，指示哪个执行了它。

然后，您可以在控件执行的 js 函数中包含您的 ajax。

而且，如果我没有正确理解这个问题，也许你可以更详细地解释它或发布一些代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T22:39:02.057

我已经阅读了一些[文档](http://msdn.microsoft.com/en-us/library/bb311028.aspx)，结果你可以检查“发件人”控件。问题中的 JS 已更新以显示正确的方法签名。

[这篇文章](http://www.asp.net/ajax/documentation/live/tutorials/ExclusiveAsyncPostback.aspx)给出了更好的解释。

# actionscript-3 - AS3 如何删除以前的加载器

> ID：596660
> 
> 赞同：1
> 
> 时间：2009-02-27T20:55:30.183
> 
> 标签：actionscript-3, actionscript, flash-cs4

在 Flash CS4 中，我正在创建一个照片库。我的目标是从许多图像中加载不同的缩略图。我已经设法，当一个人点击一个图像时，会显示一些缩略图，但是当一个人点击另一个图像时，新的缩略图会放在旧的缩略图之上。有人可以帮助我如何摆脱旧的缩略图吗？

这是代码：

```
for (var i:int = 0; i < thumbnails.length(); i++) {
  imgLoader.unload();
  imgLoader = new Loader();
  imgLoader.load(new URLRequest(thumbnails[i]));
  imgLoader.name= i;
  imgLoader.x =  95 * columns;
  imgLoader.y = 80 * rows;
  imgLoader.alpha = 0;
  details.gallery.addChild(imgLoader);

  if (columns+1< 5) {
    columns++;
  } else {
    columns = 0;
    rows++;
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-28T10:36:15.030

这就是数组是你的朋友的地方。您可以在没有数组的情况下执行此操作，只需使用一个 while 循环从添加拇指的精灵或影片剪辑中删除每个最后一个子项。我们使用数组的原因是我们可以重用拇指，而不是重新加载它们，我们只是将它们从显示列表中删除。在将每个拇指添加到显示列表时，您将对每个对象的引用推送到每个拇指的数组中。XML 中的每个 thumbContainer 节点都有自己的数组，该数组被添加到主数组中。主数组包含对缩略图数组的引用。缩略图数组保存对加载的缩略图的引用，以便可以在显示列表中添加和删除它们。如果您打算在看到拇指后不再使用拇指，则可以将其引用设置为 null，否则只需将其从显示列表中删除；没有理由多次加载它。当您准备好添加新的拇指时，您必须清除以前的拇指。最简单的方法是使用 while 循环。

```
//Assuming the thumbs were loaded into container
while(container.numChildren > 0)
{
    //Remove the first child until there are none.
    container.removeChildAt(0);
}

//The XML / 2 Containers / thumbContainer[0] and thumbContainer[1] 
```

```
<?xml version="1.0" encoding="utf-8"?>
<xml>
    <thumbContainer>
        <thumb path="path/to/file" />
        <thumb path="path/to/file" />
        <thumb path="path/to/file" />
    </thumbContainer>
    <thumbContainer>
        <thumb path="path/to/file" />
        <thumb path="path/to/file" />
        <thumb path="path/to/file" />
    </thumbContainer>
</xml> 
```

```
package
{
    import flash.display.Sprite;
    import flash.events.Event;
    import flash.events.MouseEvent;
    import flash.net.URLLoader;
    import flash.net.URLRequest;

    public class DocumentClass extends Sprite
    {
        private var _container:Sprite;
        private var _mainArray:Array;
        private var _xml:XML;
        private var _urlLoader:URLLoader;
        private var _urlRequest:URLRequest;

        public function DocumentClass():void
        {
            if(stage) _init();
            else addEventListener(Event.ADD_TO_STAGE, _init, false, 0 , true);
        }
        private function _init(e:Event = null):void
        {
            //Will contain arrays for each thumbContainer in the XML.
            _mainArray = [];

            _urlRequest = new URLRequest('path/to/xml');
            _urlLoader = new URLLoader();
            _urlLoader.addEventListener(Event.COMPLETE, _onXMLComplete, false, 0, true);      
        }
        private function _onXMLComplete(e:Event):void
        {
            _xml = new XML(e.target.data);

            _loadThumbs(0);
        }
        private function _loadThumbs(pIndex:int):void
        {
            _clearThumbs();

            //Find out how many sets of thumbs there and add to _mainArray
            for(var i:int = 0; i < _xml.thumbContainer.length(); i++)
            {
                var tempArray:Array = new Array();

                for(var j:int = 0; j < _xml.thumbContainer[i].thumb.length; j++)
                {
                    tempArray[i].push(_xml.thumbContainer[i].thumb[j].@path);
                }
                _mainArray.push(tempArray);
            }

            //Here is where we add the new content to container, or you can call a function to do it.
        }
        private function _clearThumbs():void
        {
            while(container.numChildren > 0)
            {
                //Remove the first child until there are none.
                container.removeChildAt(0);
            }
        }
    }
} 
```

同样，保持对可重用事物的引用并简单地将其从显示列表中删除，而不是设置为 null 并准备垃圾收集，以便稍后再次加载，这是一种很好的做法。我已经写了比我想要的更多的东西，并且无法输入我想要的所有代码。设置代码以确保它只加载一组特定的拇指是很重要的；这就是整个想法。至于删除它们，就像我向您展示的 while 循环一样简单，您只需要知道作为它们的父对象的 DisplayObjectContainer 的名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T21:27:41.510

您正在通过 addChild() 方法将新缩略图添加到图库对象，因此您应该调用一个方法，在添加新缩略图之前从图库中删除所有缩略图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T22:22:16.340

我相信你应该使用 removeChild() 。

不久前我遇到了一些非常奇怪的问题，导致各种疯狂的碰撞碰撞等等。我的解决方案是在我想要删除的对象上调用 removeChild()，然后将其设置为“null”。在此之前，我检查了对象是否为空（不能 removeChild 为空的东西）。

不能保证这是您“应该”这样做的方式，因为我自己对 Actionscript 场景还是很陌生。希望它能解决你的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T22:23:14.420

您可以通过将对象传递到 details.gallery.removeChild(object) 或使用 details.gallery.removeChildAt(index) 通过索引来删除它们。如果您使用 removeChild()，请务必检查是否为 null，否则会引发错误。

请务必查看 Flash 帮助文件，它们是迄今为止您可以使用的最佳资源。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-13T06:56:45.030

这将删除一个名为的影片剪辑中的所有子项`gallery`：

```
while( gallery.numChildren > 0) { gallery.removeChildAt(0); }; 
```

# c# - C# - 从对象进行模板打印

> ID：596662
> 
> 赞同：5
> 
> 时间：2009-02-27T20:55:44.300
> 
> 标签：c#, wpf, crystal-reports, reporting-services, printing

我需要从 C# 打印或导出 (pdf/doc) 的解决方案。我希望能够设计一个带有占位符的模板，将一个对象（或 xml）绑定到这个模板，并得到一个完成的文档。

我不确定这是否是报告解决方案。

我也不想编写自己的打印/图形代码——我希望在模板中处理所有显示问题。

我最初认为这是 Crystal Reports 可以做的事情（尽管我从未使用过 CR），但我不确定我是否在这里滥用系统——我对绑定 ADO.NET 数据集并不感兴趣时刻（螺丝数据集）。Crystal 可以处理与对象的绑定吗？

SSRS 或 WPF 是否也在这个领域发挥作用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T13:26:54.277

WPF-P 的一个子集是 XPS，可用于通过数据绑定呈现您的对象。如果您已经在使用 WPF，这是最好的选择之一。

Google 关键字：XPS、FixedDocument、FlowDocument、WPF 打印

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T21:01:01.560

可能会通读此线程： [http ://groups.google.com/group/nhusers/browse_thread/thread/e2c2b8f834ae7ea8](http://groups.google.com/group/nhusers/browse_thread/thread/e2c2b8f834ae7ea8)

似乎很多人都喜欢 iTextSharp [http://itextsharp.sourceforge.net/](http://itextsharp.sourceforge.net/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T21:55:31.957

对于 Word 文档，请查看 Word 的邮件合并功能和 Word 自动化。我最近在一个套用信函打印项目中做到了这一点。基本上我所做的是创建一个 Word 模板文件（文件扩展名为 .dot），在这个模板文件中，我在标准格式信函中定义了 MergeFields。我的应用程序在数据库中查询它需要打印的记录，然后对于它返回的每条记录，它将数据库中的字段与这些合并字段匹配，并将结果（合并的文档）发送到打印机。

它工作得非常好，如果我有一个给出明确解释的链接，我会提供它（回来看看，我会看看我是否找不到最有用的链接）。希望我提供了足够多的关键字，让您找到自己的资源。如果您需要，我可以更详细地介绍。

我从来不需要导出 PDF 文件，但对于我现在正在处理的项目，我必须这样做。对于一个免费的解决方案，我的研究导致了 iTextSharp（就像 Will Shaver 指出的那样），但我只进行了初步调查，我发现了一些我最终可能会求助的付费解决方案。

# sql - 如何删除db2中的所有非数字字母

> ID：596665
> 
> 赞同：4
> 
> 时间：2009-02-27T20:57:15.360
> 
> 标签：sql, db2

我在 DATA 列（varchar）中有一些数据，如下所示：

```
Nowshak 7,485 m
Maja e Korabit (Golem Korab) 2,764 m
Tahat 3,003 m
Morro de Moco 2,620 m
Cerro Aconcagua 6,960 m (located in the northwestern corner of the province of Mendoza)
Mount Kosciuszko 2,229 m
Grossglockner 3,798 m 
```

我想要的是这样的：

```
7485
2764
3003
2620
6960
2229
3798 
```

**IBM DB2 9.5 版中有没有办法通过执行以下操作来删除/删除所有这些非数字字母：**

```
SELECT replace(DATA, --somekind of regular expression--, '') FROM TABLE_A 
```

**或任何其他方式？**

这个问题来自[这个问题](https://stackoverflow.com/questions/596166/how-to-extract-numerical-data-from-sql-result)。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T21:53:01.417

正如另一个问题中所建议的那样，[TRANSLATE](http://publib.boulder.ibm.com/infocenter/db2luw/v9/topic/com.ibm.db2.udb.admin.doc/doc/r0000862.htm)功能可能会有所帮助。例如，试试这个：

```
select translate('Nowshak 7,485 m','','Nowshakm,') from sysibm.sysdummy1; 
```

回报：

```
7 485 
```

可能只需稍作调整，您就可以将其变为您想要的样子……在函数的第三个参数中，您只需要指定整个字母表。有点难看，但它会起作用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-04-11T20:42:29.587

一种简单的方法是使用 TRANSLATE(value, replacewith, replacelist) 函数。它将列表（第三个参数）中的所有字符替换为第二个参数中的值。

您可以利用它从根本上擦除字符串中的所有非数字字符，包括空格。

只需使第三个参数中的列表包含您可能看到的所有可能不想要的字符。将它们转换为空白空间，您最终只会得到您想要的字符，基本上会删除不需要的字符。

注意：我包括了所有常见的符号（非字母数字），以帮助其他可能具有比您的示例更多种类的字符值的人。

```
Select 
   TRANSLATE(UCASE(CHAR_COLUMN),'',
            'ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()-=+/\{}[];:.,<>? ')
FROM TABLE_A 
```

更简单：对于您的特定值集，由于可能的字符集要小得多，您可以将替换列表修剪为：

```
Select 
   TRANSLATE(UCASE(CHAR_COLUMN),'','ABCDEFGHIJKLMNOPQRSTUVWXYZ(), ')
FROM TABLE_A 
```

注意：CHAR_COLUMN 上的“UCASE”不是必需的，但通过消除包含所有小写字母字符的需要来简化此表达式是一个很好的增强。

```
TRANSLATE(CHAR_COLUMN,'',
      'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz!@#$%^&*()-=+/\{}[];:.,<>? ') 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-06-07T17:13:31.513

由于上面的许多答案，您的最佳方法是使用 TRANSLATE 函数。然而，这种方法是不同的，因为您可以将您想要的字符列入白名单，而不是将您不想要的字符列入黑名单。我们可以通过使用 TRANSLATE 函数两次来做到这一点。我们将使用内部翻译为外部翻译的参数生成要删除的字符列表。

```
select TRANSLATE(dirty,'',TRANSLATE(dirty,'','1234567890',''),'') as clean
from (Values 'Nowshak 7,485 m'
             ,'Maja e Korabit (Golem Korab) 2,764 m'
             ,'Tahat 3,003 m','Morro de Moco 2,620 m'
             ,'Cerro Aconcagua 6,960 m (located in the northwestern corner of the province of Mendoza)'
             ,'Mount Kosciuszko 2,229 m','Grossglockner 3,798 m'
      ) as temp(dirty) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-09-12T22:42:22.630

只需使用@Darryls99 并将其变成 UDF

```
CREATE OR REPLACE FUNCTION REMOVE_ALLBUT(in_string VARCHAR(32000), characters_to_remote VARCHAR(32000))
RETURNS VARCHAR(32000)
LANGUAGE SQL CONTAINS SQL DETERMINISTIC NO EXTERNAL ACTION
RETURN
TRANSLATE(in_string,'',TRANSLATE(in_string,'',characters_to_remote,''),'')
; 
```

像这样使用

```
select DB_REMOVE_ALLBUT(s,'1234567890')
from (values 'Nowshak 7,485 m'
             ,'Maja e Korabit (Golem Korab) 2,764 m'
             ,'Tahat 3,003 m','Morro de Moco 2,620 m'
             ,'Cerro Aconcagua 6,960 m (located in the northwestern corner of the province of Mendoza)'
             ,'Mount Kosciuszko 2,229 m'
             ,'Grossglockner 3,798 m'
      ) t(s); 
```

返回

```
 1
 ----
 7485
 2764
 3003
 2620
 6960
 2229
 3798 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-10-27T13:09:37.857

脏字符串可以是这样的：*'qwerty12453lala<<>777*9'*

我们需要清除字符串并只保留数字。

我们可以使用 TRANSLATE 函数删除任何多余的字符，但有一个问题：第 3 个参数的值太长且丑陋。像这样的东西：

```
VALUES
(
TRANSLATE( UPPER('qwerty12453lala<<>777*9'), '', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()-=+/\{}[];:.,<>? ')
) 
```

所以，这不是很方便。

我的想法是 - 使用 TRANSLATE 功能 2 次（一次在另一次内）：

*   计算第 3 个参数作为替换符号的特定列表
*   使用此计算参数第二次使用 TRANSLATE 函数替换多余的符号

让我在这里用代码告诉你：

```
VALUES
( 
  REPLACE --Remove spaces from result
  (  
    TRANSLATE
    (
      UPPER( 'qwerty12453lala<<>777*9')
    , ' '
    , TRANSLATE( UPPER( 'qwerty12453lala<<>777*9') , ' ' , '0123456789')-- This is calculation of 3-th param, it contains only NOT digital characters, like 'QWERTYLALA<<>*'
    )
  , ' '
  , ''  
  )  
) 
```

结果必须是这样的：*124537779*

在 SELECT 语句的情况下，它将是这样的：

```
SELECT REPLACE
       (
         TRANSLATE( UPPER(T.DIRTY_FIELD), ' ', TRANSLATE(UPPER(T.DIRTY_FIELD), '', '1234567890' ) )
       , ' '
       , ''
       )
  FROM SOMETABLE T 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-12-24T17:07:32.557

所有的适当组合
`select replace(translate(dirty,' ','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz!@#$%^&*()-=+/{}[];:.,<>?' ), ' ','') as clean`

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-02-27T21:16:40.727

> IBM DB2 9.5 版中有没有办法通过执行以下操作来删除/删除所有这些非数字字母：
> 
> SELECT replace(DATA, --somekind of regular expression--, '') FROM TABLE_A
> 
> 或任何其他方式？

不可以。您必须创建一个[用户定义函数](http://publib.boulder.ibm.com/infocenter/wsadhelp/v5r1m2/index.jsp?topic=/com.ibm.etools.subuilder.doc/topics/cudf.html)或以您的宿主应用程序的语言实现它。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2014-12-08T12:12:20.790

下面的语句将从任何“字符串值”中删除非字母数字字符，并在传递零长度字符串值时阻止 SQLSTATE 消息 42815。

```
SELECT REPLACE(TRANSLATE(string-value || '|',
                        '||||||||||||||||||||||||||||||||',
                        '`¬!"£$%^&*()_-+={[}]:;@~#,<>.?/'''),'|','')
FROM SYSIBM.SYSDUMMY1; 
```

# html - HTML 页面上的 3D 模型

> ID：596666
> 
> 赞同：14
> 
> 时间：2009-02-27T20:58:14.920
> 
> 标签：html, 3d, cad

我有想要在网页上显示的 3D CAD 模型。我想以`<img>`标签之类的形式显示它（例如与其他所有内容内联而不是作为单独的页面），并且我希望访问者能够旋转模型以从不同的角度查看它。

我有什么选择？

我在想/在看的东西

*   [虚拟现实语言](http://en.wikipedia.org/wiki/VRML)
*   [3DXML](http://en.wikipedia.org/wiki/3DXML)
*   闪光
*   PDF 有一些有用的东西，但它没有像我想要的那样嵌入
*   [3DMLW](http://en.wikipedia.org/wiki/3DMLW)（看起来很慢）
*   [通用 3D](http://en.wikipedia.org/wiki/U3D)（由 Adob​​e Reader 支持）

* * *

*编辑：* 模型不是很复杂，所以性能不是主要问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-19T15:08:04.367

Chrome Experiments 已经发布了几个 3D Javascript 应用程序。这是一个示例： [颜色立方体](http://www.chromeexperiments.com/detail/colorscube/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-27T21:48:30.757

[Papervison3D](http://code.google.com/p/papervision3d/wiki/Getting_Started_FAQ)是一个值得一看的 3D 闪存库。我自己没有机会玩它，但有些演示看起来不错。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-11-12T23:58:56.777

Papervision 和 Unity3D 是管道输入和快速加载的最佳选择。Flash 安装在大多数机器上，但您需要导出为 COLLADA 格式，并且在它陷入困境之前有 2000 个多边形的限制。

Unity 3D 有一个很棒的流程，现在对独立开发者是免费的。它支持非常高的多边形数量，并且插件无需重启浏览器即可安装，大小约为 4MB（Flash 和 Sliverlight 现在都超过 4MB）。

另一种选择可能是 Torque 3D，但这也是非常基于游戏的。我认为您最好的选择是 Unity 3D。您可以导出为 FBX 并在大约 5 分钟内将其发布到网络上。

将来您可以使用来自 Google 或 WebGL 的 O3D，但它还没有准备好进入黄金时段。目前唯一能够在网络上获得 3d 且多边形数量可观的简单管道是 Unity3D。它可以像 Flash 和 Silverlight 一样在 PC 和 Mac 上运行。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-27T21:02:23.817

我不确定 Flash 对 CAD 应用程序文件格式之类的 3D 支持有多好。IIRC，flash 不能做硬件加速的 3D 图形。另一方面，Java 小程序可以（使用正确的库）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-05-17T13:14:55.253

几个月前出现了一个名为[Sketch Fab的新工具。](https://sketchfab.com/)它完全用 HTML5 设计，看起来非常强大。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-27T21:25:57.303

您还可以查看 <canvas> 标记，该标记已被更多浏览器实现。可能已经有一个用于模型查看的 JavaScript 库。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-27T21:27:48.297

考虑 QuickTime VR。它可以满足您的大部分要求，并且由于您拥有原始模型，因此您可以创建一个相当准确的模型。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-27T22:39:27.687

VRML 可能是一个不错的选择。[Parallel Graphics](http://www.cortona3d.com/)提供了一个很好的客户端，我已经使用了很长一段时间了。我的[网站](http://www.forman.free-online.co.uk/sev/sev.html)上有一些 VRML 模型（尽管内容很简单！）。模型将很快加载，特别是如果它们不是那么大。有几种可用的导航模式，您可以将其锁定为“检查”，从而让用户旋转模型（尽管实际上它是围绕对象移动的相机）。

您将需要找到一个可以编写 VRML 文件的程序，尽管任何体面的建模师都会有这个选项。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-01T12:23:13.737

统一：[http ://unity3d.com](http://unity3d.com)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-02T08:04:23.943

看看[http://labs.autodesk.com/technologies/freewheel/](http://labs.autodesk.com/technologies/freewheel/)

Project FreeWheel 可以显示在 Autocad、Invertor 或 Revit 中制作的 2D 和 3D 模型。我认为它使用 DWF 或其他东西。

此时无法在您自己的服务器上托管 FreeWheel，但您可以将 DWF 上传到 Autodesk 并在 IFrame 中显示您的模型。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-11-13T00:10:36.400

似乎基于画布标签的 javascript 绘图 API 正在兴起。请参阅这个最近发布的 canvas 3d js 库，尽管它仅适用于 FF 3.5：[http ://www.c3dl.org/](http://www.c3dl.org/)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-06-09T20:48:02.607

Autodesk 推出了他们的新查看器 API：

[http://through-the-interface.typepad.com/through_the_interface/webtech/](http://through-the-interface.typepad.com/through_the_interface/webtech/)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-28T00:05:30.007

Shockwave 带有一些脚本代码，用户可以旋转模型。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-09-27T17:56:00.997

这是一个 JavaScript 3D 渲染引擎：[pre3d](http://github.com/deanm/pre3d)。

如果您还没有查看过，Doob 先生有一个用于 3D 图形和建模的库：[homepage](http://mrdoob.com/)和[git repo for three.js](http://github.com/mrdoob/three.js)。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-02-07T01:36:10.353

您可以使用[A3dsViewer](http://www.aptagraphis.com/index.php?option=com_content&view=article&id=48&Itemid=62) - 提供对 HTML5(three.js) 的导出，或者您可以直接导出到 Google Drive 并`<iframe>`为您的页面获取生成的 url。导出的 HTML5 模型默认包含旋转功能。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-12-31T04:04:54.263

您可以使用此插件创建[3D 模型的 html 文件。](http://prototechsolutions.com/Live/plugins.html)它将生成单个 html 文件，您可以在网站的任何位置使用它，或者您也可以将其发送给客户端

# c# - 在 C# 中提供方法的同步和异步版本

> ID：596673
> 
> 赞同：4
> 
> 时间：2009-02-27T21:00:13.650
> 
> 标签：c#, .net, asynchronous

我正在用 C# 编写一个 API，我想同时提供公开可用方法的同步和异步版本。例如，如果我有以下功能：

```
public int MyFunction(int x, int y)
{
   // do something here
   System.Threading.Thread.Sleep(2000);
   return  x * y;

} 
```

如何创建上述方法的异步版本（可能是 BeginMyFunction 和 EndMyFunction）？是否有不同的方法可以达到相同的结果，不同方法的好处是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-27T21:09:58.370

通用方法是使用 a `delegate`：

```
IAsyncResult BeginMyFunction(AsyncCallback callback)
{
    return BeginMyFunction(callback, null);
}

IAsyncResult BeginMyFunction(AsyncCallback callback, object context)
{
    // Func<int> is just a delegate that matches the method signature,
    // It could be any matching delegate and not necessarily be *generic*
    // This generic solution does not rely on generics ;)
    return new Func<int>(MyFunction).BeginInvoke(callback, context);
}

int EndMyFunction(IAsyncResult result)
{
    return new Func<int>(MyFunction).EndInvoke(result);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-27T21:41:03.320

Mehrdad Afshari 尽我所能回答您的问题。但是，如果可能的话，我会建议不要这样做。除非您的业务对象的唯一职责是同步或异步运行事物，否则您甚至试图使其意识到它可以异步运行的事实，从而违反了[单一职责原则。](http://en.wikipedia.org/wiki/Single_responsibility_principle)使用匿名委托在消费类中执行此类操作很容易：

```
public void Foo(int x, int y)
{
    ThreadPool.QueueUserWorkItem(delegate
        {
            // code to execute before running
            myObject.MyFunction(x, y);
            // code to execute after running
        });
} 
```

如果之前或之后没有要运行的代码，可以使用 lambda 使其更简洁

```
ThreadPool.QueueUserWOrkItem(() => myObject.MyFunction(x, y)); 
```

**编辑**

回应@kshahar 下面的评论，外部化异步仍然是一个好主意。这是几十年来一直使用回调解决的常见问题。Lambdas 只是缩短了路线，而 .Net 4.0 使它更简单。

```
public void Foo(int x, int y)
{
    int result = 0; // creates the result to be used later
    var task = Task.Factory.StartNew(() => // creates a new asynchronous task
    {
        // code to execute before running
        result = myObject.MyFunction(x, y);
        // code to execute after running
    });
    // other code
    task.Wait(); // waits for the task to complete before continuing
    // do something with the result.
} 
```

.Net 5 makes it even easier than that, but I'm not familiar enough with it to make a statement beyond that at this point.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-27T21:11:29.287

首先，如果您受计算限制，我不会打扰。让客户端来决定他们是想在当前线程上同步调用你，还是通过 ThreadPool.QueueUserWorkItem 异步调用你。

但是，如果您的例程中有某种形式的 I/O，那么提供异步版本可能会有所帮助。您应该确保您的异步版本使用相应的异步 I/O 调用。您还需要[实现 IAsyncResult](https://stackoverflow.com/questions/405647/implementing-iasyncresult-explicitly)并从您的 BeginMyFunction 调用中返回它。在此处查看 Joe Duffy 的实现，并[在此处](http://www.bluebytesoftware.com/blog/PermaLink,guid,661dc0d7-9759-4a91-ad97-247c66d6f784.aspx)[查看](http://iodyner.spaces.live.com/blog/cns!7B505254340D5E9A!154.entry)有关各种 BCL 实现的微妙之处的一些注释。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-27T21:10:27.433

您可以创建一个将委托进行回调的方法版本：

```
delegate void PassIntDelegate (int i);
delegate void PassIntIntCallbackDelegate (int i1, int i2, PassIntDelegate callback);

public int MyFunction (int i1, int i2)
{
    return i1 * i2;
}

public void MyFunctionAsync (int i1, int i2, PassIntDelegate callback)
{
    new PassIntIntDelegate (_MyFunctionAsync).BeginInvoke (i1, i2, callback);
}

private void _MyFunctionAsync (int i1, int i2, PassIntDelegate callback)
{
    callback.Invoke (MyFunction (i1, i2));
} 
```

此版本不如使用 AsyncCallback 的版本干净，但它的类型安全性更高。

# sharepoint - SharePoint DelegateControl 呈现顺序

> ID：596674
> 
> 赞同：3
> 
> 时间：2009-02-27T21:00:50.030
> 
> 标签：sharepoint, sharepoint-feature

我有两个 SharePoint 功能，每个功能都以相同的方式实现（见下文），它们将控件添加到页面标题中的委托控件。其中一个控件依赖于另一个（一个是jQuery库，另一个依赖于jQuery），但是在渲染控件时，控件的顺序不正确。如何指定这些控件的呈现顺序？

控件（两者相同，只是它们引用了不同的 .js 文件）：

```
<%@ Control ClassName="MyScriptControl" %>
<script type="text/javascript" src="/_layouts/MyScript.js"></script> 
```

特征.xml：

```
<?xml version="1.0" encoding="utf-8" ?> 
<Feature Id="AA9D59AC-D53E-4338-9B52-CD39F2A8C31A" 
    ActivateOnDefault="true" 
    Title="My Feature" 
    Description="Does something." 
    Scope="Site" Version="1.0.0.0" 
    Hidden="FALSE" 
    DefaultResourceFile="core" 
    xmlns="http://schemas.microsoft.com/sharepoint/">
    <ElementManifests>
        <ElementManifest Location="MyFeature\Elements.xml" /> 
    </ElementManifests>
</Feature> 
```

元素.xml：

```
<?xml version="1.0" encoding="utf-8" ?> 
<Elements xmlns="http://schemas.microsoft.com/sharepoint/" 
    Id="24A4BB9A-9636-4a73-B3A5-35661DE19902">
    <Control Id="AdditionalPageHead" 
        ControlSrc="~/_controltemplates/MyControl.ascx" /> 
</Elements> 
```

页面上的输出（jQuery 部署在 DependsOnjQuery 之前）：

```
<script type="text/javascript" src="/_layouts/DependsOnjQuery.js"></script>
<script type="text/javascript" src="/_layouts/jQuery.min.js"></script> 
```

我希望 MyControl1.js 在 MyControl2.js 之前呈现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T21:55:52.800

我能够通过在我的母版页的标题中添加第二个 DelegateControl 并将 jQuery 添加到该委托来实现此功能。这样，我可以确保 jQuery 总是在其他所有内容之前加载，而无需编写一些逻辑来延迟我的依赖库的加载。

```
<SharePoint:DelegateControl runat="server" ControlId="jQueryDelegate" AllowMultipleControls="true"/>
<SharePoint:DelegateControl runat="server" ControlId="AdditionalPageHead" AllowMultipleControls="true"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T21:20:30.170

在我看来，Sequence 属性可以用来控制这些家伙的渲染顺序。给你的 jQuery 控件一个 50 的序列，你的 DependsOnjQuery 控件一个 100 的序列，你应该很好。

有关详细信息，请参阅[MSDN 上的委托控制文档](http://msdn.microsoft.com/en-us/library/ms463169.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T21:29:27.123

您是否尝试在脚本上设置 DEFER="DEFER" 属性。

这将告诉用户代理脚本应该在加载脚本之前等待页面加载和呈现。

否则，您可以通过在一个脚本中设置一个变量来破解它，该变量在加载脚本时设置为 true。在另一个中，如果脚本已加载，则您放置了测试的逻辑（思考循环和超时方法），然后在加载两个脚本时调用您的逻辑。

不是很好，但是您需要某种逻辑来处理执行，而不仅仅是在脚本中内联运行方法。

To nathan：委托中的序列用于确定要加载*哪些委托控件。*这应该与所讨论的问题无关。据我了解，JS 文件只是在恰好是委托控件的脚本上设置值。

# c# - 如何限制 Ajax 日历上的日期范围？

> ID：596684
> 
> 赞同：0
> 
> 时间：2009-02-27T21:04:33.283
> 
> 标签：c#, java, .net, asp.net, javascript

我正在使用 ajax 日历工具。我喜欢它的功能，但我想限制用户选择从今天开始到 6 个月前结束的时间范围。我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-01T21:31:08.677

如果您使用的是 asp.net 日历控件，请使用 DayRender 事件来检查每一天是否与您希望施加的日期限制相符。

```
protected void Calendar_DayRender(object sender, DayRenderEventArgs e)
{
   //Get date in past relative to current date.
   DateTime dateInPast = DateTime.Now.Subtract(TimeSpan.FromDays(10));

   if (e.Day.Date < dateInPast || e.Day.Date > DateTime.Now)
      {
         e.Day.IsSelectable = false;
      }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T21:55:41.957

您使用的是哪个 ajax 日历工具。那里大约有7000个。我已经看到雅虎（YUI）和其他一些采用开始和结束日期配置的用户必须在两者之间选择一些东西的配置。
如果您使用的日历没有该日历，则可以通过检查用户选择后的日期并检查该日期是否超出您的范围来添加它。然后显示一条消息并让日历可见，让他们再次选择。（虽然切换到已经支持此功能的日历可能会更容易）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-01T10:14:29.817

您可以使用 asp:comaparevalidator 检查选定的日期。

# c# - C# _Click 事件转换发送者和使用 FindControl

> ID：596685
> 
> 赞同：0
> 
> 时间：2009-02-27T21:04:55.870
> 
> 标签：c#, .net, asp.net, events

我有一个在单击图表时触发的 _Click 事件。在这种情况下，我立即让发件人输入图表。我经常遵循这种范式，但每次这样做都会感到恶心。

在这个特定的实例中，我也立即用完以找到相应的 UpdatePanel，因此我可以向其添加动态呈现的 GridView。Chart 和 UpdatePanel 通过具有相似的 ID 拼凑在一起。图表和更新面板都是在运行时动态创建的。

我想知道是否有更好/首选的方法来实现这种行为。

```
protected void Chart_Click(object sender, ImageMapEventArgs e)
{
    Chart chart = (Chart)sender;
    UpdatePanel up = (UpdatePanel)chart.Parent.FindControl(chart.ID + "UP");

    GridView gv = new GridView();
    Dictionary<string, string> displayFields =
        new Dictionary<string, string>();

    // add data to displayFields by using the ImageMapEventArgs.PostBackValue
    // to create data for dictionary ...

    gv.DataSource = displayFields;
    gv.DataBind();
    up.ContentTemplateContainer.Controls.Add(gv);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T21:10:53.563

我不确定关于将 sender 转换为图表（除了使用之外`as`）还能做些什么，但是有很多方法可以处理相关的控件问题。

*   向图表添加一个名为“LinkedPanel”的属性并将更新面板分配给它

    您会在通知图标中看到类似的模式，将[其与上下文菜单相关联](http://msdn.microsoft.com/en-us/library/system.windows.forms.notifyicon.contextmenu.aspx)）

    我认为这特别好，因为当它正确完成时，您可以在表单设计器中分配链接控件。（当然它对您动态生成的控件没有帮助）

*   将两个控件合并到一个 UserControl 中（如果控件总是紧挨着显示，这可能是正确的做法）

*   创建一个知道这两个控件的对象，并让它处理它们引发的事件

我同意这取决于名字感觉不对；在生产代码中使用它我会太尴尬/紧张:-/（如果你是唯一的开发人员，那么我想这取决于你......）

使用这些其他方法可以降低其他开发人员所做的“无害更改”开始导致意外异常的可能性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T21:09:47.263

我认为将 sender 投射到是安全的，`Chart`因为您知道它始终是`Chart`. 注意方法名是 even `Chart_Click`。

但是，您可以保存`UpdatePanel`对`Chart`'`Tag`属性中的引用。这样可以避免在父级中搜索名称的丑陋和风险。如果您经常更换父母或移动面板，可能会难以维护。

但是，如果您*100%*`UpdatePanel`知道' 将在那里并*正确*命名，那么恕我直言，您的方法不一定是“错误”的。`UpdatePanel.Name =`为了安全起见，您可能希望在初始化它的行旁边添加“不要更改此名称”注释。（顺便说一句，如果您不是唯一可以访问您的代码的人，那么 100% 会立即下降到最多 99.9%。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T21:10:16.327

改为使用 as。

如果失败，您的演员将抛出。

```
Chart chart = sender as Chart;
if (chart == null)
   return; // or do something else

// the rest of your handler. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T21:47:32.850

你所做的并没有什么真正的错误。但是您可以通过使用“as”代替显式转换来防止类型转换错误，如下所示。

如果要查找控件是否为 UpdatePanel，可以使用`GetType()`方法

示例： `sender.GetType().name`将为您提供控件名称

```
protected void Chart_Click(object sender, ImageMapEventArgs e)
{
    Chart chart = (Chart)sender;
    control c = Parent.FindControl(chart.ID + "UP");
    UpdatePanel up ;

    if (c != null)
    {
       up = c as UpdatePanel;**

       GridView gv = new GridView();
       Dictionary<string, string> displayFields =
           new Dictionary<string, string>();

       // add data to displayFields by using the ImageMapEventArgs.PostBackValue
       // to create data for dictionary ...

       gv.DataSource = displayFields;
       gv.DataBind();
       up.ContentTemplateContainer.Controls.Add(gv);
   }
} 
```

# video - 在静态网页上显示视频

> ID：596686
> 
> 赞同：0
> 
> 时间：2009-02-27T21:06:00.597
> 
> 标签：video, static, webpage

我有一个需要显示视频的静态网站。我不控制服务器（但知道控制服务器的人）。是否有任何“托管一些文件并添加一些样板”的方式来将视频显示为页面的一部分？我正在考虑一些看起来像嵌入式 youtube 视频的东西。

我宁愿把东西保存在本地（我没有 youtube 帐户，也没有其他理由得到一个），但如果这不仅仅是微不足道的，我会让别人托管它而不是乱七八糟。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T21:10:57.993

将您的视频转换为 FLV（我使用 Avidemux，但有很多工具可用），然后使用任何嵌入式 Flash 视频播放器。参见例如。[http://osflv.com/](http://osflv.com/) , [http://flowplayer.org/](http://flowplayer.org/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T21:35:44.987

嵌入 Windows Media Player 是[小菜一碟](http://austria-boston.org/)（见页面底部），并且使用正确的背景图像可以看起来像 Youtube。随意刮我的代码。

*BCS 编辑：他的代码*

```
<object id="MediaPlayer" width="165" height="170"
  type="application/x-oleobject" 
  standby="Loading Microsoft Windows Media Player components..." 
  codebase="http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=9"
  classid="CLSID:22d6f312-b0f6-11d0-94ab-0080c74c7e95">

   <PARAM NAME="FileName" VALUE="vienna.wmv">
   <PARAM NAME="TransparentAtStart" Value="true">
   <PARAM NAME="AutoStart" Value="false">
   <PARAM NAME="AnimationatStart"   Value="true">
   <PARAM NAME="ShowControls" Value="true">
   <PARAM NAME="autoSize" Value="false">
   <PARAM NAME="displaySize" Value="0">
   <EMBED TYPE="application/x-mplayer2"
      pluginspage="http://www.microsoft.com/Windows/MediaPlayer/"
      src="vienna.wmv"
      Name=MediaPlayer AutoStart=0
      Width=165 Height=170
      transparentAtStart=1
      autostart=0
      animationAtStart=1
      ShowControls=1 
      autoSize=0 
      displaySize=0>
   </EMBED>
</OBJECT> 
```

同样古老，[这里](http://systo.com/stream.shtml)有一个如何处理不同比特率的例子。我知道，我是一个糟糕的演员。

我今天会使用 Youtube，当我发布这些页面时，我认为它不存在。

* * *

# java - JFreechart XYPlot 重叠数据工件

> ID：596696
> 
> 赞同：-1
> 
> 时间：2009-02-27T21:10:14.283
> 
> 标签：java, jfreechart

我正在尝试使用包含重叠优先级的数据集绘制一些条形图。

例如，可以在一点绘制三个不同颜色的条，但将显示具有最高优先级的条。这在大多数情况下都有效，但是我的绘图中出现了一些伪影，因为来自较低优先级的一些颜色偶尔会泄漏。关于我可以在哪里解决这个问题的任何想法？

我认为这可能是一个抗锯齿问题，但打开或禁用它对工件没有影响。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-03T17:40:44.983

当我之前看到这样的事情时，那是因为我正在绘制多个数据系列，并且在大多数情况下，数据集中存在巨大的重叠，并且大多数时候只有最后一个渲染的数据集（顶部）是可见的。我怀疑您在隐藏代码中所做的任何事情都可能没有您想象的那么好，并且其他颜色的“出血”是重叠不太重要的数据集。尝试一个实验并更改数据集的呈现顺序 - 我敢打赌，您会突然发现条形图的主要颜色发生了变化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-28T18:34:20.780

我不太确定您的意思，但是您可能应该完全删除您不想从数据模型中看到的优先级，然后根本不会绘制它们。

# c# - 如何使用动态添加的自定义模板字段在 asp.net 中对 GridView 进行排序？

> ID：596701
> 
> 赞同：1
> 
> 时间：2009-02-27T21:10:45.637
> 
> 标签：c#, asp.net

我创建了一个供 GridView 使用的模板类，它工作正常，但是如果我启用对列标题进行排序，则不会变成链接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T22:10:54.947

我需要设置模板的 SortExpression 属性...

# php - 在数据库中存储银行信息的最佳实践

> ID：596706
> 
> 赞同：54
> 
> 时间：2009-02-27T21:11:44.403
> 
> 标签：php, mysql, mcrypt

**答案摘要：
不要这样做。法律和财务影响将是灾难性的。寻找成熟的第三方解决方案或聘请专家。切勿将任何敏感信息存储在共享服务器上。研究最合适的加密机制。**

我正在为需要将其客户的银行信息（路由+帐号）存储在数据库中以进行直接存款的客户建立一个网站。以下是一些细节：

1）该网站最初将位于共享托管服务器上（这是我首先关心的问题）。
2) 我正在使用 PHP/MySQL。
3）我打算使用mcrypt。
4) 密钥将位于 Web 根目录之外。

请让我知道你的想法。如果可能，请向我提供一些关于 ACH 处理的资源。

谢谢！

**编辑：我期待这样的回应，因为我也害怕那里的安全问题。我已经向我的客户表达了我的担忧，这将是一个很好的支持。**

**编辑 2：将远离这一点。一开始对这个想法不满意！将调查 PayPal 的 Mass Payment API。**

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2009-02-27T21:32:30.127

我认为您可以通过使用诸如[Paypal 的 Mass Payment API 之](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/howto_api_masspay)类的东西来解决这个问题，而无需自己存储任何银行信息。这样一来，您的客户就可以向人们付款，而 PayPal 会存储所有信息，因此您不必这样做。

如果您想了解您需要采取的所有步骤，甚至可以远程保护您客户的敏感财务数据，请搜索“ [PCI 合规性](http://en.wikipedia.org/wiki/PCI_DSS)”

如果您不是非常害怕在线存储财务数据，那您就太天真了。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-27T21:14:15.130

1）该网站最初将位于共享托管服务器上（这是我首先关心的问题）。 - 特别糟糕。没有对服务器的绝对管理控制，并且能够将其他人拒之门外是一个非常大的问题。

我真的很担心您是从前端 Web 服务器直接访问数据库。这是财务数据的一大禁忌。

即使您拥有有史以来最强大的加密算法，如何防止有人劫持您的系统并使用它为他们解密数据。他们不需要密钥，他们只需要您的应用程序为他们完成工作。这是假设您使用单个密钥来加密和解密数据，或者您正在从数据库中检索数据以显示给系统用户。

好的，事情就是这样。如果您必须提出这些问题，则说明您不具备正确执行此操作的技术专长。我不是想听起来刻薄，这只是一个事实。我会和一群经验丰富的人一起工作，他们首先做这个专业。有很多这里没有提到的事情需要考虑。有很多关于安全的东西本身并没有写下来。读一本书学不到的东西。这是一件非常困难的事情，因为闯入金融系统的人可以获得丰厚的回报。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-02-27T21:16:19.183

不要这样做。

但是，如果必须，请使用公钥/私钥加密。仅存储和使用公钥来加密进入数据库的数据。将私钥存储在安全位置（意思是：不是托管服务器，而是具有适当访问控制的“安全”本地机器）。必要时，将数据下载到本地机器，使用私钥解密，然后离开。

但说真的，如果可能的话，想办法避免这样做。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-27T21:22:39.167

在继续之前与律师讨论您的潜在责任。将个人银行数据存储在共享托管服务器上会带来危险。您无法控制谁能最终获得数据。

另外值得关注的是，这不是您客户的数据，而是您客户的*客户*数据！您也许可以与您的客户达成协议以赔偿您，但当他们的客户参与其中时则不行。一旦数据被泄露，他们会立即转回给您，客户会紧跟其后！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-27T21:18:16.540

对于银行信息，您的服务器应该在他们的控制之下而不是共享。

此外，mcrypt 也不是很安全。我知道它是内置的，但我会建议一些不太容易破解的东西，比如 RSA。如果有人确实掌握了这些信息，那么他们应该无法在没有私钥的情况下破解它。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-27T21:24:07.183

我同意其他人的观点——这是一个非常糟糕的主意。

专用服务器的价格在每月 79 美元到 99 美元之间，如果这无法承受，我真的想知道他们为什么要从一开始就处理银行信息。在这种情况下，首选方法是让数据库与 Web 框分开。最好有一些防火墙和它们之间的其他保护（即2个防火墙，一个在Web服务器前面，一个在Web服务器和数据库之间）。

但任何事情都会比使用共享主机更好。我的意思是，您可以直接连接到 SQL 服务器并查看所有可用的数据库 - 以最少的黑客攻击直接跳入其中有多容易？

另外，请告诉我网站的名称，这样我就永远不会注册并将我的银行信息放在上面！！！:)

此外，在继续使用共享主机之前，请确保您有错误和遗漏保险。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-08-25T13:10:27.100

我遇到了和你类似的情况，就这样解决了。

1.  由于您不会进行 ACH 处理，因此请确定 ACH 处理 API 是否能够创建客户。
2.  如果是，则此客户对象通常会包括帐号、路由号码等，并将令牌存储在您的数据库中。（因此，当用户提供他的信息时，您通过 HTTPS 将其直接传递给您的 ACH 处理器，并保存令牌）。
3.  每当您必须从他们的帐户中扣除时，将此令牌传递给处理器，就是这样！

这样，您就不会在数据库中保存任何帐户和路由号码，即使有人入侵了数据库，他们也只会看到令牌，这是非常没用的 - 他们无法用它做任何事情，因为它是 ACH 处理器特定的。

我已经为使用 Stripe 的信用卡做了类似的事情。

祝你好运！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-27T21:47:22.680

你没有这方面的经验，你甚至在仓库俱乐部都找不到这么大的蠕虫罐头。这是您的客户需要聘请领域专家的情况；如果您有兴趣在未来从事此类工作，请尝试与专家密切合作并尽可能多地吸收知识。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-27T21:52:18.470

我认为这里的每个人都已经充分表达了他们对这种情况的厌恶，所以我会在进行任何类型的加密时提示另一个问题（我们同意这是必要的）：

数据必须在某处加密！

如果您在服务器上执行此操作，那么受感染的服务器只会执行您的加密并在不加密的情况下传递它们。

如果您在客户端执行此操作，这会更安全一些，但如果有人可以访问您的服务器，仍然会敞开大门：理论上他们可以简单地打开一个 XSS 漏洞（即在您的页面中插入远程脚本.. .) 在加密之前将副本发送到他们的盒子...

最后：如果您真的考虑在可能不是 110% 安全的服务器上执行此操作，请**走开**。

# compact-framework - Compact Framework 串口和平衡

> ID：596726
> 
> 赞同：2
> 
> 时间：2009-02-27T21:20:16.740
> 
> 标签：compact-framework, serial-port

因此，要打开一个串口并通过串口成功传输来自天平的数据，我需要确保 serialPort 对象上的设置与天平的实际设置相匹配。

现在，问题是我如何检测到由于设置不同而没有建立连接？serialPort.Open 没有抛出异常，表明连接已经建立。是的，设置是有效的，但如果它们与设备（天平）设置不匹配；我对为什么没有捕捉到天平上的重量一无所知。

这里有什么输入吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T21:27:59.903

在不了解您希望从天平获得的数据格式的任何更多信息的情况下，只有通用串行端口设置不匹配检测技术适用。

如果 UART 设置明显不正确，您可能会看到很多帧错误：当 UART 需要 1 个停止位时，它实际上会看到 0。您可以通过端口上的[ErrorReceived](http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.errorreceived.aspx)事件检测到这一点。

```
private void OnErrorReceived(object sender, SerialErrorReceivedEventArgs e)
{
    if ((e.EventType & SerialError.Frame) == SerialError.Frame)
    {
        // your settings don't match, try something else
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T21:38:06.180

如果事情很接近，但仍然不正确，.NET 串行端口对象甚至可能不会给您错误（也就是说，直到发生灾难性事件）。

我最常见的串口通信失败是由于波特率不匹配造成的。如果您有一条消息，您知道您可以得到“回声”，请尝试将其作为握手工作的一部分。也许您要连接的设备有“状态”消息。请求它不会造成任何伤害，并且您会发现通信是否正常进行。

对于软件握手 (xon xoff) 您几乎无法检测它是否配置正确。串行端口对象可以做任何事情，从完全忽略它到出现线程异常错误，具体取决于底层串行端口驱动程序的实现。我有完全忽略 xon/xoff 的串行端口驱动程序，并将字符直接传递到程序中 - 哎呀！

对于硬件握手，波特率的基本回显策略可能会起作用，具体取决于您的设备的工作方式。如果您知道它会进行硬件握手，您可能能够检测到它并将其打开。如果设备需要硬件握手但它没有打开，你可能什么也得不到，反之亦然。

另一个很少使用的设置是 DTR 引脚 - 数据终端就绪。一些串行设备要求将其置位（即设置为真）以指示是时候开始发送数据了。默认设置为 false；试一试。

请注意，串行端口对象是......挑剔的。虽然不一定需要，但我会考虑在您进行任何更改之前关闭端口。

编辑：

感谢您的评论，看起来[这](http://balance.balances.com/scales/915/)是您的设备。它说默认设置应该是：

*   1200 波特
*   奇校验
*   1 个停止位
*   硬件握手

它没有指定多少数据位，但设备说它支持 7 和 8。我会尝试这两个。它还说它支持 600、1200、2400、4800、9600 和 19200 波特。

如果您打开了硬件握手，启用了 DTR（不同的东西）并循环了所有不同的波特率，那么很有可能不是您的设置。可能是正在使用的串行电缆为您的设备接线不正确。一些串行电缆是“直通”电缆，其中一侧的 1-9 引脚与另一侧的 1-9 引脚完全匹配。然后，您有“交叉”电缆，其中“TX”和“RX”电缆被切换（这样当一侧传输时，另一侧接收，非常方便的电缆。）

考虑查看手册后面的命令表；您可以发出“打印软件版本”命令来获取某种类型的回声。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T21:38:49.143

串行端口使用一种非常非常古老的通信技术，该技术使用一种非常非常古老的协议，称为[RS-232](http://en.wikipedia.org/wiki/RS-232). 这非常简单......两个端点具有同步时钟，并且它们在每个时钟周期测试线路电压以查看它是高还是低（高意味着0和低意味着1，这是相反的大多数公约......再次成为协议时代的产物）。时钟同步是通过使用停止位来实现的，停止位实际上只是字节之间的休息时间。还有一些其他的东西被投入到协议的更高级用途中，例如奇偶校验位、XON/XOFF 等，但这些都建立在这个非常基本的通信层之上。检测串行线路每一端的时钟不匹配几乎是不可能的——你只会在接收端得到不正确的数据。协议本身没有内置方法来识别这种情况。我不知道有任何串行驱动程序足够聪明，可以注意到输入数据的时钟频率不合适。如果您使用其中一种错误检测方案，例如奇偶校验位，则每个字节都将被声明为错误。简而言之，您能做的最好的事情就是检查传入数据的错误（奇偶校验错误应该由您的驱动程序/软件层检测，而您的应用程序从该层接收的数据中的错误需要由您的程序检查 -后者可以通过使用[校验和](http://en.wikipedia.org/wiki/Checksum)）。

# python - 如何在不依赖框架的情况下使用 python 进行 Web 开发？

> ID：596729
> 
> 赞同：33
> 
> 时间：2009-02-27T21:20:50.607
> 
> 标签：python, performance, web.py

我知道各种框架都有它们的好处，但我个人希望我在 python 中的 Web 开发尽可能简单：少写框架，多写*python*。

到目前为止，我发现的唯一可以让我以最明显的方式做到这一点的是[web.py](http://webpy.org/)，但我对它的性能有点担心。

对于那些使用 nginx（或其他风格）+mod_wsgi+web.py 的人...性能如何？可以进一步改进吗？

对于那些使用过 web.py、喜欢这个想法并继续写出更好的东西或找到更好的东西的人来说......介意给我指出源吗？

我想听听所有引人注目的、最小化但强大的方法。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-02-27T21:45:58.097

要走的路是[wsgi](http://wsgi.org)。

WSGI 是**Web 服务器网关接口**。它是 Web 服务器和应用程序服务器与 Web 应用程序通信的规范（尽管它也可以用于更多用途）。**它是一个 Python 标准，在[PEP 333](http://www.python.org/dev/peps/pep-0333/)**中有详细描述。

当前所有的框架都支持 wsgi。许多网络服务器也支持它（包括 apache，通过[mod_wsgi](http://code.google.com/p/modwsgi/)）。如果您想编写自己的框架，这是要走的路。

这里是hello world，直接写到wsgi：

```
def application(environ, start_response):
    status = '200 OK'
    response_headers = [('Content-type','text/plain')]
    start_response(status, response_headers)
    return ['Hello world!\n'] 
```

把它放在 a 中`file.py`，将你的`mod_wsgi`apache 配置指向它，它就会运行。纯蟒蛇。没有进口。只是一个python函数。

如果你真的在编写自己的框架，你可以检查[werkzeug](http://werkzeug.pocoo.org/)。它不是一个框架，而是 WSGI 应用程序的各种实用程序的简单集合，并已成为最先进的 WSGI 实用程序模块之一。它包括一个强大的调试器、功能齐全的请求和响应对象、处理实体标签的 HTTP 实用程序、缓存控制标头、HTTP 日期、cookie 处理、文件上传、强大的 URL 路由系统和一堆社区贡献的插件模块。把无聊的部分从你手中拿走。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-02-27T22:11:40.703

有趣的是，即使有人提出一个问题，询问如何在没有框架的情况下编写代码，每个人仍然涌入推销他们最喜欢的框架。OP 抱怨不想要一个“重量级框架”，回复提到*Twisted*，最重要的是？！来吧，真的。

是的，*完全*有可能编写直接的 WSGI 应用程序，并从独立模块中获取一些想要的功能，而不是让您的代码适应特定框架的世界观。

要走这条路，您通常需要熟悉 HTTP 和 CGI​​ 的基础知识（因为 WSGI 从早期的规范中继承了很多东西）。这不一定是向初学者推荐的方法，但它非常可行。

> 我想听听所有引人注目的、最小但强大的方法

你不会*听说*它们，因为没有人有兴趣将“自己动手”作为一种方法论来推广。我，我使用一个特定的独立模板包、一个特定的独立表单阅读包、一个特定的数据访问层和一些自制实用程序模块。我写的不是一种我可以传教的特定哲学，它们都只是无聊的工具，可以换掉并用其他同样好的东西代替。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-27T21:46:50.670

你也可以检查[cherrypy](http://cherrypy.org)。cherrypy 的重点是成为一个让你编写 python 的框架。Cherrypy 有自己非常好的网络服务器，但它与 wsgi 兼容，因此您可以通过 mod_wsgi 在 apache 中运行cherrypy 应用程序。这是cherrypy中的hello world：

```
import cherrypy

class HelloWorld(object):
    def index(self):
        return "Hello World!"
    index.exposed = True

cherrypy.quickstart(HelloWorld()) 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-02-27T22:23:49.847

+1 对 WSGI 的所有答案。

Eric Florenzo 最近写了一篇很棒的博客文章，你应该阅读：[编写 Blazing Fast, Infinitely Scalable, Pure-WSGI Utilities](http://www.eflorenzano.com/blog/post/writing-blazing-fast-infinitely-scalable-pure-wsgi/)。这将使您更好地了解 Hello World 之外的纯 WSGI。还要注意评论，尤其是 Kevin Dangoor 的第一条评论，他建议至少将[WebOb](http://pythonpaste.org/webob/)添加到您的工具集中。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-27T21:33:33.150

对于它的价值，我在 mod_python 中编写了我的网站，没有任何像 Django 这样的干预框架。我真的没有理由抱怨。（好吧，也许有一点，mod_python 在某些方面有点古怪，但在常见的用例中却不是）有一件事是肯定的，它肯定会让你编写 Python ;-)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-11-01T15:09:09.773

为什么你担心 web.py 的性能？正如我在[这里](https://stackoverflow.com/questions/7788149/web-py-deployment-for-ios-app-backend/7853705#7853705)提到的，我们在[nginx后面使用](http://nginx.org/)[CherryPy](http://www.cherrypy.org/)（“内置”web.py 的 Web 服务器）来提供 Oyster.com 上的大部分 HTML —— nginx 将流量拆分到 2 或 3 个 Web 服务器上，每个服务器运行 4 个 Python 进程，我们可以轻松地每秒处理 100 个请求。

Oyster.com 是一个大容量网站，平均每天有 200,000 次动态生成的网页浏览量，并且达到的峰值要高得多。但是，我们确实为我们的静态资源（如图像和 CSS）使用了内容交付网络 (CDN)。

我们绝对关心性能（我们的大多数页面在 25 毫秒内呈现），但 web.py 不是瓶颈。我们的瓶颈是模板渲染（我们使用[Cheetah](http://www.cheetahtemplate.org/)，它足够快，但速度不够快）和数据库查询（我们大量缓存并将每页的数据库查询数量保持在 0 或 1）以及访问我们的 3rd-party 酒店定价提供者（当您使用我们尚未缓存的日期进行搜索时访问这些提供者）。

请记住，过早的优化是万恶之源——除非您服务于 google.com，否则 web.py 可能会为您工作。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-27T22:16:44.590

我已经使用 mod-python 和[PSP](http://www.math.temple.edu/doc/packages/apache2-mod_python/doc-html/pyapi-psp.html)编写了一些小型 Web 应用程序——mod -python 相当于 php。

在一个案例中，我编写了一个网页，通过检查我们的源代码存储库来生成发行说明。我将它重写为 PHP，并惊讶地发现 PSP 版本快了大约 20%，并且代码行数减少了大约一半。

所以，至少对于小问题，psp 对我来说效果很好。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-27T22:53:00.353

我认为这取决于框架是什么以及它应该为您做什么的定义。

正如所指出的，一个非常小的“框架”将是 WSGI，因为它只定义了一个用于与 Web 服务器交互的小接口。但这是一种强大的方法，因为您可以在应用程序和服务器之间放置中间件。

如果你想要更多一点，比如一些 URL 到函数的映射，那么你有一些选择，其中一些已经提到过。

如果你走得更远，你可能会来到 Pylons、Turbogears 或 Django，之后可能会是 Zope，但它会变得更大，可能会很痛苦，而且你总是会接受那个框架的意见。

我最近越来越多（来自 Zope/Plone）使用的是[repoze.bfg](http://static.repoze.org/bfgdocs/)。它非常小，没有捆绑 ORM（因此您可以使用 SQLAlchemy、Storm 或简单地转到像[ZODB](http://new.zope.org/projects/zodb)这样的对象数据库）。它所做的基本上是处理您如何从 URL 转到作为函数的视图。它支持 URL 映射（a la Routes）或对象遍历，恕我直言，这在某些情况下非常强大，尤其是。如果您的映射不那么严格。好消息是它直接带有一个基于 ACL 的安全框架，如果你想使用它，恕我直言非常实用。这样，您就不需要似乎主要用于此类事情的装饰器。

当然，它是基于 WSGI 的。还要寻找大量中间件的[repoze subversion 存储库，](http://svn.repoze.org) [Paste](http://pythonpaste.org)的东西对于 WSGI 相关的任务也非常有用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-27T21:56:26.043

姜戈怎么了？它不会强迫您使用它的 ORM，控制器只是普通的 Python 函数，而不是类似 Rails 的类方法。此外，url 路由是使用正则表达式而不是其他框架发明的语法完成的。如果 django 对你来说似乎太多了，我建议你看看[Werkzeug](http://werkzeug.pocoo.org/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-27T22:14:37.060

我非常喜欢 Google AppEngine。我使用 ORM 和模板系统，但在其他方面遵循 REST 模式设计，只为相应的 HTTP 实现 Python 方法。它使原始 HTTP 交互成为中心，并且可以选择为您提供其他使用的东西。此外，无需再配置和管理您的部署环境！

# c# - 如何在智能手机上显示“忙碌”对话框（旋转轮）

> ID：596730
> 
> 赞同：5
> 
> 时间：2009-02-27T21:20:58.657
> 
> 标签：c#, windows-mobile

找不到它是如何调用的，也找不到如何弹出它。

我的 CF 应用程序正在使用 Web 服务在 Web 上进行通信。想向我的用户展示一些“忙碌的活动”对话框。

有什么建议如何显示 WinMo 中的默认设置吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-27T21:38:44.230

以下应该工作......

```
using System.Windows.Forms;
...
Cursor.Current = Cursors.WaitCursor; 
```

# .net - 是否有类似 FireBug 的实用程序用于检查 Winform 应用程序？

> ID：596744
> 
> 赞同：11
> 
> 时间：2009-02-27T21:25:28.753
> 
> 标签：.net, winforms, user-interface, utilities

我正在设计一个在运行时动态创建自己的 GUI 的程序。

我正在寻找一个类似萤火虫的实用程序，它允许我在表单周围移动鼠标以查看突出显示的不同控件并查看它们的大小、填充、边距等设置。

谢谢你，
基思

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-27T22:03:06.260

有一个名为 Hawkeye 的工具可以完全满足您的要求。这是我写的关于它的两篇文章。

[调试工具：鹰眼](http://www.infoq.com/news/2007/01/Hawkeye)

[Corneliu Tusnea 已将 Hawkeye 发布为开源](http://www.infoq.com/news/2008/04/Hawkeye)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-27T21:34:58.013

Spy++ 是您将获得的最接近的......但它适用于通用 Windows，而不是 .NET。

我确实在 MSDN 杂志上找到了这篇关于[ManagedSpy的文章](http://msdn.microsoft.com/en-us/magazine/cc163617.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-01-10T23:09:27.250

codeplex 上的 Hawkeye 项目（再次）处于活动状态。你可以试试它的最新版本：

[http://hawkeye.codeplex.com/releases/view/58898](http://hawkeye.codeplex.com/releases/view/58898)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T21:35:54.673

浏览器有一个 DOM 模型，没有它我认为这是不可能的。不用想太多，我不知道这样的东西如何能够插入到应用程序中，更不用说浏览控制层次结构了。

可能要自己滚。如果你留下正确的钩子，应该不会太难。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-05T16:08:49.940

试试Nirsoft 的[WinExplorer](http://www.nirsoft.net/utils/winexp.html)。它在非 dot net 程序上工作得相当好，并允许您操作程序的 gui（例如，启用您不应该按下的按钮）

# java - 生成一个包含 Cobertura 报告的 maven 站点

> ID：596746
> 
> 赞同：7
> 
> 时间：2009-02-27T21:25:54.633
> 
> 标签：java, maven-2, code-coverage, cobertura

我有一些项目已经通过 maven 进行站点生成，我想在其中集成 cobertura 报告，但我似乎运行的任何 maven 目标都不会生成本地预览供我查看，其中包括 Cobertura 报告地点。在我将 pom 更改提交到 repo 并生成损坏的站点之前，我想确保它们正确生成。

以下是我添加到 maven poms（父级和模块）中的内容，但是我在运行时看到的站点`mvn site:run`不包括 cobertura 报告：

```
<project>
...
    <build>
    <plugins>
        <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>cobertura-maven-plugin</artifactId>
            <configuration>
                <check>
                    <haltOnFailure>false</haltOnFailure>
                    <regexes>
                        <regex>
                            <pattern>parent-package-name-here.*</pattern>
                            <branchRate>80</branchRate>
                            <lineRate>80</lineRate>
                        </regex>
                    </regexes>
                </check>
                <instrumentation>
                    <includes>
                        <include>parent-package-name-here/**/*.class</include>
                    </includes>
                </instrumentation>
            </configuration>
            <executions>
                <execution>
                    <id>clean</id>
                    <phase>pre-site</phase>
                    <goals>
                        <goal>clean</goal>
                    </goals>
                </execution>
                <execution>
                    <id>instrument</id>
                    <phase>site</phase>
                    <goals>
                        <goal>instrument</goal>
                        <goal>cobertura</goal>
                        <goal>check</goal>
                    </goals>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build>
...
<reporting>
        <plugins>
            <plugin>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>cobertura-maven-plugin</artifactId>
            </plugin>
        </plugins>
</reporting>
...
</project> 
```

我应该使用什么 Maven 命令来生成带有 cobertura 报告的站点？或者，我应该（另外）添加什么以使站点生成包含 cobertura 报告？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-01T07:50:53.983

应该做：

```
mvn site 
```

详细地说，运行**mvn a:b**会在插件 a 中运行目标 b。说**mvn c**意味着运行生命周期阶段 c，它运行直到 c 的所有阶段中的所有绑定目标。结果，这将触发更多的事情发生（例如做必要的准备以生成 cobertura 报告）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-11T17:55:03.760

我想出了如何做到这一点。

maven 站点生成插件中的链接生成似乎有很多错误。

我发现让 maven 使用工作模块链接生成站点的本地副本的唯一方法是修改`distributionManagement/site`标记以指向某个本地目录而不是实际部署目录，然后使用`maven site:deploy`.

每次尝试使用都会`mvn site:stage`产生断开的链接。也一样`mvn site:run`。

报告链接与`mvn site:run`/一起使用，`mvn site:stage`但到模块的链接不使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T23:05:37.717

```
mvn site 
```

应该做你正在寻找的东西。您将插件配置为在生命周期的预站点和站点阶段运行，但您随后执行的是站点：运行目标而不是站点。我们正在使用 clover（商业报道工具）做类似的事情，而 mvn site 可以做到这一点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-11T05:12:23.913

根据我的经验，site:stage 模块链接对于多模块构建也不起作用，但 site:deploy 可以。试试这个：

在父 pom 中使用站点 URL 的属性，例如`${site.url}`. 然后调用这个

```
mvn clean site site:deploy -Dsite.url=file://`pwd`/target/site-deployed 
```

这`pwd`是一个`-nix`将替换当前目录的命令。这是因为您使用的 URL 必须是绝对的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T22:52:19.450

我们用

```
mvn site-deploy 
```

这将构建站点并部署它（将其复制到我们配置的位置）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-01T18:13:53.503

`mvn site:site`应该产生您所追求的，在目标目录中，将有一个站点目录，其中包含与`index.html`该目录中的链接链接的所有报告。

# asp.net-ajax - ModalPopupExtender：我如何在拖回帖子后保留我的位置？

> ID：596764
> 
> 赞同：2
> 
> 时间：2009-02-27T21:33:56.847
> 
> 标签：asp.net-ajax, ajaxcontroltoolkit, modalpopupextender

我已经尝试谷歌搜索这个并查看这个控件的来源，但没有找到答案。如果我能够链接到拖动事件，我将能够解决这个问题，但我认为它不存在（有关 DragDropPanel 的解决方案，请参阅此链接（[http://www.dotnetcurry.com/ShowArticle.aspx ?ID=181](http://www.dotnetcurry.com/ShowArticle.aspx?ID=181) ). 如何使用 modalPopupExtender 执行此操作？弹出窗口运行良好，但在将其拖动到其他位置，然后单击“测试部分回发”后，对话框将重新定位到其默认位置。

```
<asp:Panel ID="panelDivPopup" runat="server" EnableViewState="false" style="display:none;" 
    CssClass="modalPopup">
    <img id="modalCancel" class="jqmClose" src="cancel.png" runat="server" enableviewstate="false" />
    <div class="jqmdHeader jqDrag" id="dragHandle">Dialog Title</div>
    <div class="jqmdContent">
        Hello!!
        <br />
        <asp:UpdatePanel ID="updatePanel" runat='server'>
            <Triggers>
                <asp:AsyncPostBackTrigger ControlID="btnUpdatePostBack" />
            </Triggers>
            <ContentTemplate>
                <asp:Label runat="server" ID="lblUpdateText" EnableViewState="false" />
                <asp:Button runat="server" EnableViewState="false" ID="btnUpdatePostBack" Text="Test Partial Postback" OnClick="btnUpdatePostBack_Click"  />
            </ContentTemplate>
        </asp:UpdatePanel>          
    </div>
</asp:Panel>    
<ajct:ModalPopupExtender ID="modalPopupExtender" runat="server" EnableViewState="false"
    PopupControlID="panelDivPopup" TargetControlID="linkShowDialog" DropShadow="false"
    BackgroundCssClass="modalBackground" CancelControlID="modalCancel" 
    Drag="true" PopupDragHandleControlID="dragHandle" RepositionMode="RepositionOnWindowResizeAndScroll">
    </ajct:ModalPopupExtender> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-20T03:25:53.837

您要么必须删除“DocType”标签，要么设置正文高度，例如在正文中添加此样式 =“height:1000px”，或者添加一个 css 类

# c# - 泛型或非泛型

> ID：596772
> 
> 赞同：6
> 
> 时间：2009-02-27T21:36:59.443
> 
> 标签：c#, .net, generics

基本上我有一个包含不同水果的自定义 List 类。假设每个水果都有一个存储在列表中的 ID 号。

是否更好：

```
new AppleList();
new OrangeList();
new LemonList(); 
```

或者

```
new FruitList<Fruit.Apple>();
new FruitList<Fruit.Orange>();
new FruitList<Fruit.Lemon>(); 
```

需要考虑的事项：

*   所有 ID 都是 int 类型。
*   水果的类型不会影响 List 本身的执行。它只会被列表的客户端使用，如外部方法等。

我想使用更清晰，设计更好，更快，更高效等的一种。另外，如果上述两种技术不是最好的，请提出您的想法。

编辑：顺便说一句，如果不清楚的话，水果是一个枚举。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-27T21:41:55.610

使用组合：

```
public class AppleList : FruitList<Apple> { ... }
public class OrangeList : FruitList<Orange> { ... }
public class LemonList : FruitList<Lemon> { ... } 
```

将通用逻辑放在基列表类中：

```
public class FruitList<T> : List<T>
    where T : IFruit 
{ ... } 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-27T21:41:40.120

如果您使用泛型，是否有创建 FruitList 类型的目的？你可以只使用列表吗？

性能不会有太大差异，所以我说为什么要创建三个不同的类，而一个人会做同样的事情呢？使用通用解决方案。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-27T21:41:28.497

维护 1 个通用列表比 3 个非通用版本要容易得多。如果您真的喜欢 AppleList 名称，您可以随时使用 using 技巧来命名通用列表

```
using AppleList=Fruit.FruitList<Fruit.Apple> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-27T21:42:34.610

仅当您添加其他功能时，才重用通用集合类并将它们子类化。如果可以的话，保持你的子类实现通用。这是最简单的实现。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-27T21:57:13.577

> •所有ID 都是int 类型。
> 
> •水果的种类不会影响清单本身的执行。它只会被列表的客户端使用，如外部方法等。

鉴于这两个事实，我不会为泛型而烦恼。我会在 FruitList 上放置一个普通属性来指示它是哪种类型的水果。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-27T21:43:09.617

使用通用列表，没有必要创建 3 个列表，保持一定程度的抽象总是好的。（IFruit 将是一个很好的界面）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-10-02T19:04:27.377

我不会推荐接受的答案，我认为你的意思是这样的：

```
public enum Fruit
{
   Apple,
   Orange,
   Lemon
}

public interface IFruitList : IList<int>
{
   Fruit Type { get; }
};

public class FruitList : List<int>, IFruitList
{
   private readonly type;

   FruitList(Fruit type)
     : base()
   {
      this.type = type;
   }

   FruitList(Fruit type, IEnumerable<int> collection)
     : base(collection)
   {
      this.type = type;
   }

   Fruit Type { return type; }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-27T21:49:19.603

除非你需要它，否则你应该假设[YAGNI 。](http://c2.com/xp/YouArentGonnaNeedIt.html)因此，如果您不需要比您在 List 中获得的更多信息，那么只需`List<T>`. 如果由于某种原因您必须覆盖列表，则创建

```
FruitList<T> : List<T> where T : Fruit 
```

如果您的列表出现分歧并且不再是多态的，那么请考虑实现您的自定义列表：

*   `AppleList`
*   `OrangeList`
*   `LemonList`

但是，请尽量保持继承层次结构尽可能平坦，以避免解决方案过于复杂。

# iphone - 如何在 Mac 上模拟慢速互联网连接 (Edge/3g)。有火狐插件吗？

> ID：596780
> 
> 赞同：6
> 
> 时间：2009-02-27T21:40:39.247
> 
> 标签：iphone, firefox, plugins, connection

**完全重复**：[https ://stackoverflow.com/questions/473465/firefox-plugin-to-simulate-slow-internet-connection](https://stackoverflow.com/questions/473465/firefox-plugin-to-simulate-slow-internet-connection)

如何在 Mac 上模拟慢速互联网连接 (Edge/3g)？有火狐插件吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-10-27T02:38:58.343

在 Mac 或 BSD 上，使用：

```
sudo ipfw pipe 1 config bw 350kbit/s plr 0.05 delay 500ms
sudo ipfw add pipe 1 dst-port http 
```

并重置为您的初始设置：

```
sudo ipfw flush 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2011-11-09T04:42:57.720

Apple now have an official developer tool called Network Link Conditioner which simulates different network conditions. It has some more powerful features that alternatives like SpeedLimit and Charlie — for example it can simulate packet loss and DNS delays as well as bandwidth and latency — and it is free.

Network Link Conditioner is provided with [Xcode](http://developer.apple.com/xcode/), with is a free download but is also a very large download!

![Apple Xcode Network Link Conditioner](https://i.stack.imgur.com/jvOTa.png)

Ref: [https://apple.stackexchange.com/questions/24066/how-to-simulate-slow-internet-connections-on-the-mac](https://apple.stackexchange.com/questions/24066/how-to-simulate-slow-internet-connections-on-the-mac)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-10-27T02:41:11.840

[SpeedLimit](http://mschrag.github.com/ "速度极限")为我解决了问题。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-27T22:39:53.413

[Charles](http://www.charlesproxy.com/)和[Fiddler](http://www.fiddlertool.com/)是 HTTP 代理，可以限制您的速度等。您甚至可以告诉您的 iPod 或 iPhone 使用它们，并捕捉所有来来往往的流量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T17:24:46.467

当我评估一个软件如何与坏的手机卡连接工作时，我在天线周围包裹了一些锡箔。这听起来很愚蠢，但效果非常好；信号下降到一根柱子，但并未完全消失。

我还尝试将笔记本电脑放在微波炉中，但结果几乎没有那么有效。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-02-27T21:53:43.553

从来没听说过。如果您想查看加载时的外观，您可以使用 firebug 并在 javascript 中设置断点，或在服务器上设置断点。我总是使用这种技术来查看加载时的外观。

另一种选择是 NetLimiter，我听说它有效，但我自己没有尝试过 [http://www.netlimiter.com/](http://www.netlimiter.com/)

# cocoa - Inspector > Bindings 窗格中 IB 中的“Controller Key”属性有什么意义？

> ID：596795
> 
> 赞同：2
> 
> 时间：2009-02-27T21:42:28.963
> 
> 标签：cocoa, interface-builder, cocoa-bindings

苹果 说：

> NSController 对象的属性。绑定到 NSController 对象时，您可以使用此字段选择键路径中的第一个条目。为方便起见，与此字段关联的菜单显示所选控制器对象上可用的属性。您可以键入属性的名称，或者直接从提供的列表中选择它。

有人可以换句话说解释吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T22:11:20.813

您正在将视图对象绑定到模型属性。类似于（示意性地）：

```
myTextField.value <=> myModel.textValue. 
```

虽然您*可以*将视图属性直接绑定到模型对象的属性，如上所示，但您确实不应该这样做。您会错过 Apple 控制器提供的出色功能（例如`NSObjectController`、`NSArrayController`等）。相反，您应该将视图绑定到绑定到模型的控制器，例如：

```
myTextField.value <=> myObjectController.selection.textValue 
  and 
myObjectController.contentObject <=> myModel 
```

在此设置中，myObjectController.selection 是 myObjectController.contentObject 的键值绑定兼容代理，myObjectController 可以充当视图和模型之间的中介。Interface Builder 使这种关注点分离变得明确，因为控制器可能会为其绑定模型公开多个代理（例如`NSArrayController`'s`arrangedObjects`和`selectedObjects`）。在上例中绑定 myTextField.value 时，您将在“Controller Key”字段中输入“selection”，在“Model Object Keypath”路径字段中输入“textValue”。

# wpf - 如何在 MVVM 中构建 ViewModel 不违反单一职责原则？

> ID：596797
> 
> 赞同：12
> 
> 时间：2009-02-27T21:42:44.517
> 
> 标签：wpf, silverlight, mvvm, solid-principles

罗伯特·马丁说：**“改变班级的理由不应该不止一个”**。

让我们考虑绑定到视图的 ViewModel 类。ViewModel 有可能（甚至很可能）由彼此并不真正相关的属性组成。对于小视图，ViewModel 可能是相当一致的，但是当应用程序变得更加复杂时，ViewModel 会暴露数据，这些数据会**因不同和不相关的原因而**发生变化。

在 ViewModel 类的情况下，我们是否应该担心 SRP 原则？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-28T00:44:33.457

ViewModel 的唯一职责是为 View 提供它需要的信息。如果 View 需要不同且不相关的属性，这并不重要，因为 ViewModel 只有一个改变的原因，那就是 View 显示不同的属性。所以你不应该太担心。

也就是说，如果 ViewModel 确实变得很大，也许您可​​以考虑将视图分成几个子视图以提高可重用性并保持 View 和 ViewModel 的可管理性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-28T00:50:48.793

我同意 gcores。

一旦您看到 ViewModel 增长到超过两屏的文本，就该考虑将 ViewModel 拆分为多个子模型了。

另一个经验法则是，我在 XAML 文件中的嵌套级别永远不会超过两层——如果视图的一部分变得过于复杂，则该是视图重构的时候了——将内部 XAML 提取到单独的 UserControl 并创建相应的 ViewModel，这将是子视图的默认数据上下文。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T23:52:06.407

是的，但这并不意味着糟糕的设计不能强迫你去做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-22T13:47:39.943

我同意将您的屏幕拆分为具有多个 ViewModel 的多个视图对于减少臃肿和复杂性是必要的。这是我用来帮助坚持使用 MVVM 的 SRP 的另一种模式：

这是一种情况。我的 ViewModel 需要获取数据并响应来自 UI 的过滤命令。我将 ViewModel 创建为复合结构。也就是说，有权访问 ViewModel 的私有成员的子类执行线性任务，例如处理过滤。我可能还有另一个子类，它执行基于标准选择项目的必要逻辑。你明白了。一旦 ViewModel 执行跨越多个方法的某些功能，它可能是委托给子类的好选择。子类仍然是主 ViewModel 的一部分，因此它只是减小 ViewModel 大小并使单元测试这些线性操作更容易的一种方式。

# php - 如何比较 PHP 函数内的 unix 时间戳（数字）？

> ID：596802
> 
> 赞同：1
> 
> 时间：2009-02-27T21:43:42.220
> 
> 标签：php, function, timestamp

好吧，我担心这只是我忘记了一些关于 PHP 的愚蠢的小事，但我似乎无法弄清楚这里发生了什么。

### 测试代码：

```
<?php header('Content-Type: text/plain');

$closingDate     = mktime(23, 59, 59, 3, 27, 2009);

function f1()
{
    return time() > $closingDate;
}
function f2()
{
    return time() < $closingDate;
}

printf('    Time: %u
Closing: %u

t > c: %u
f1   : %u

t < c: %u
f2   : %u', 
    time(), 
    $closingDate, 
    time() > $closingDate,
    f1(), 
    time() < $closingDate,
    f2()); 
```

问题是输出对我来说根本没有意义。而且我不明白为什么结果会这样：

```
Time: 1235770914
Closing: 1238194799

t > c: 0
f1   : 1

t < c: 1
f2   : 0 
```

为什么函数输出的结果与函数内部的代码不一样？？我没有得到什么？我是否对自己的代码完全视而不见？到底是怎么回事？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-27T21:45:52.730

你没有传递`$closingDate`给函数。他们正在`time`与`null`.

尝试：

```
function f1()
{
    global $closingDate;
    return time() > $closingDate;
}
function f2()
{
    global $closingDate;
    return time() < $closingDate;
} 
```

或者：

```
// call with f1($closingDate);
function f1($closingDate)
{
    return time() > $closingDate;
}

// call with f2($closingDate);
function f2($closingDate)
{
    return time() < $closingDate;
} 
```

查看有关[变量作用域](http://us.php.net/global)的 PHP 文档。

# visual-c++ - COM 基本示例

> ID：596809
> 
> 赞同：0
> 
> 时间：2009-02-27T21:46:43.070
> 
> 标签：visual-c++, com, sample

我一直在阅读[Essential COM](https://rads.stackoverflow.com/amzn/click/com/0201634465)，这是一本非常好的书，非常有启发性且易于理解。现在我想加快速度并实现一个简单的 COM 对象，将其编译为 .dll，最后从客户端应用程序中使用它。

如果有人能展示如何做到这一点的最基本示例，我将不胜感激？

我一直在[一步一步地尝试这个，](http://www.codeguru.com/cpp/com-tech/activex/tutorials/article.php/c5567)但是除了发现一些错误之外，我无法让它工作。原因是我创建了一个简单的 Win32 应用程序，我从头开始编写 COM（如一步一步所示）并且无法编译/链接（很多错误），我一定是忘记了一些配置或一些包含在 stdafx.h 或其他内容中。

我正在使用 Microsoft Visual Studio .Net 2003 使用 Visual C++

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T23:07:28.400

最无摩擦的方法之一是使用向导生成的解决方案之一，特别是 VS 2008 中的“ATL Project”向导（不确定 2003 年）。当询问您想要的服务器类型时，您只需选择“DLL”，然后您就会得到一个非常有用的 COM DLL 框架来填写您的代码。

提示：要添加新的 COM 接口和 coclass，最简单的方法是转到 Class View，右键单击项目，然后选择 Add->Class...，然后选择“ATL Simple Object”并回答向导问题.

**编辑**：回答 Toto 在评论中的附加问题（如何创建客户端以使用新创建的 COM DLL），答案是“这取决于语言”，因为您在这里有很多选择。您可以使用 VB（“添加引用”）、C#/VB.NET（“添加引用”、COM 选项卡）、VBScript (WScript.CreateObject)，当然也可以使用 C++。简而言之，在 C++ 客户端中，您需要包含服务器的 IDL 并链接到服务器的 LIB 文件。

# php - 如何使用 PHP 将图像从网络摄像头传输到我的网站？

> ID：596814
> 
> 赞同：0
> 
> 时间：2009-02-27T21:47:48.967
> 
> 标签：php, streaming, webcam

我将使用 PHP。

我想建立一个基本的约会网站，所以我认为我需要学习如何逐个模块或逐个学习，直到完成。我想开始的是网络摄像头部分。

我将如何将网络摄像头流式传输到网站？

我如何获取网络摄像头的一些屏幕截图并将其发布在网站上（将其存储到数据库中）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-28T00:18:31.723

简单的答案是，您不能直接在 PHP 中执行此操作，您必须使用诸如 Flash、Flex、Silverlight（？）甚至 AJAX（超低技术）之类的客户端技术来执行此类操作，仅 PHP在服务器端运行，页面加载后无法更改页面内容。

如果我要（再次）做这样的事情，我会使用 Flash，根据我的经验，它最适合这种类型的媒体，具有最佳的用户体验和最佳的浏览器/操作系统跨平台可用性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T22:34:38.307

您可以使用 AJAX 以某些间隔刷新图像（或使用元刷新）...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-28T00:06:35.590

您应该使用 Flash 或 Flex 之类的东西来显示视频。

# r - 避免传递数据框的最佳方法是什么？

> ID：596819
> 
> 赞同：12
> 
> 时间：2009-02-27T21:49:17.963
> 
> 标签：r, dataframe

我有 12 `data.frame`s 可以使用。它们是相似的，我必须对每一个都做同样的处理，所以我写了一个函数，它接受 a `data.frame`，处理它，然后返回 a `data.frame`。这行得通。但我担心我正在绕过一个非常大的结构。我可能正在制作临时副本（是吗？）这效率不高。避免绕过的最佳方法是什么`data.frame`？

```
doSomething <- function(df) {
  // do something with the data frame, df
  return(df)
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-04T21:28:26.303

实际上，您正在传递对象并使用一些内存。但我不认为你可以在不传递对象的情况下对 R 中的对象进行操作。即使您没有创建函数并在函数之外进行操作，R 的行为也基本相同。

看到这一点的最好方法是建立一个例子。如果您在 Windows 中，请打开 Windows 任务管理器。如果您在 Linux 中打开终端窗口并运行 top 命令。在此示例中，我将假设 Windows。在 R 中运行以下命令：

```
col1<-rnorm(1000000,0,1)
col2<-rnorm(1000000,1,2)
myframe<-data.frame(col1,col2)

rm(col1)
rm(col2)
gc() 
```

这会创建一对名为 col1 和 col2 的向量，然后将它们组合成一个名为 myframe 的数据帧。然后它会丢弃向量并强制垃圾收集运行。在 Windows 任务管理器中查看 Rgui.exe 任务的内存使用情况。当我启动 R 时，它使用大约 19 兆内存。运行上述命令后，我的机器对 R 的使用量不到 35 兆。

现在试试这个：

```
myframe<-myframe+1 
```

您对 R 的内存使用量应该超过 144 兆。如果您使用 gc() 强制垃圾收集，您将看到它回落到大约 35 兆。要使用函数尝试此操作，您可以执行以下操作：

```
doSomething <- function(df) {
    df<-df+1-1
return(df)
}
myframe<-doSomething(myframe) 
```

当您运行上面的代码时，内存使用量将跃升至 160 兆左右。运行 gc() 会将其降回 35 兆。

那么如何看待这一切呢？好吧，在函数之外执行操作（就内存而言）并不比在函数中执行操作更有效。垃圾收集清理东西真的很好。你应该强制 gc() 运行吗？可能不会因为它会根据需要自动运行，我只是在上面运行它以显示它如何影响内存使用。

我希望这会有所帮助！

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-04T21:41:41.980

我不是 R 专家，但大多数语言对大对象使用引用计数方案。在您修改对象的副本之前，不会生成对象数据的副本。如果您的函数仅读取数据（即用于分析），则不应进行复制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-01T19:34:15.980

我在寻找其他东西时遇到了这个问题，而且它已经过时了-所以我现在只提供一个简短的答案（如果您想获得更多解释，请发表评论）。

您可以在 R 中传递环境，其中包含从 1 到所有变量的任何位置。但可能你不需要担心它。

[你也可以对类做类似的事情。我目前只了解如何将类用于多态函数 - 并注意有不止 1 个类系统正在运行。]

# usability - 如何衡量规范要求文档中的“可用性”？

> ID：596826
> 
> 赞同：0
> 
> 时间：2009-02-27T21:52:19.017
> 
> 标签：usability, accessibility, requirements, specifications

现在开始查看我去年的项目，因此我正在编写规范要求文档。现在，碰巧这个项目需要高度的“可用性”——我不知道这是否是正确的英文单词，但我的意思是它应该很容易从用户 PoV 中使用。现在 - 在我目前从事的所有项目中，可用性并不是一个真正重要的因素，所以我可以写一些乱七八糟的东西来解决它。虽然我总是问我们的老师他们会如何指定可用性的要求，但还没有人给我一个我觉得足够好的答案。

*我们的老师一直鼓吹对项目的任何要求都应该是“可测试的”，但是您如何测试您的用户界面的可访问性？*

假设我有一个实时应用程序正在运行。在这里说“一个条目应该在初始调用后不到 100 毫秒内被删除”并不难。但是要说“用户界面应该是 86% 直观”要困难得多。

我想这是一个难以破解的难题，但我肯定不会是世界上第一个想到这一点的人，更不用说遇到问题了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T22:00:05.940

> ...您如何测试您的用户界面是否易于访问？

通过可用性测试。

基本上，你找一堆朋友（因为你没有钱鼓励陌生人参与）给他们一个新用户应该拥有的文档，并要求他们执行系统的关键用例。

理想情况下，您希望您的测试用户至少具有目标用户的一些品质，因此如果您的系统针对的是技术受众，那么您的同学会工作；但是，如果您的系统是针对公众的，那么您将希望让您在艺术、人体动力学等领域的朋友参与其中。

那么如何将其转化为需求呢？您确定您的关键用例并规定它们的可用性（步行可用，几分钟的文档，真正的实际培训......），然后验证您的测试对象可以完成用例而没有太多挫败感，在合理的时间内进行适量的培训。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T22:39:59.403

尝试根据“可测试”需求来定义可用性。

您已经给了自己答案，因为可用性可以用诸如“应在初始调用后 100 毫秒内删除条目”之类的要求来描述。

是什么让用户界面 86% 直观？如果没有某种形式的测量，这是无法回答的。您需要询问哪些功能可以使用户界面直观。与客户和潜在的未来用户交谈。收集功能（或更好地挖掘它们！），这将使使用该软件更容易。

也许您会得到一个功能列表，例如：

*   部门的组织必须显示在分层树视图中。
*   在此树视图中，必须可以拖放。
*   必须为每个用户配置和保存字体大小。
*   在屏幕顶部必须有一个重要链接列表。每个用户都可以配置和保存他自己的个人列表。
*   ...

对这些功能提出要求。它们是“可测试的”，因此是“可测量的”。如果在验收测试中发现 20 个功能中有 17 个可以正常工作，那么您的成功率为 85%。

编辑：这适用于项目环境，您需要在其中提供测量结果（如在许多商业项目中）。如果您有一个“较软”形式的项目环境，不是每个人都在关注数字，那么过于拘泥于这种形式主义可能会适得其反，因为灵活性和敏捷性可能会受到影响。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T22:23:15.260

我建议您不要量化可用性要求。问题不在于您无法定义指标。例如，你可以说

*   一个人在网站上找到 y 的时间应该不超过 x 秒，或者
*   店铺的转化率必须高于z%
*   等等等等

问题在于您必须花费时间和资源来为您实际可以达到的指标寻找可接受的目标值。什么是查找内容的可接受时间？

# asp.net - 如何使用 VisualStudio 发布我的网站并跟踪更改？

> ID：596829
> 
> 赞同：0
> 
> 时间：2009-02-27T21:52:40.653
> 
> 标签：asp.net, publishing

有谁知道如何在 VS 2008 上使用“发布网站”命令并能够跟踪更改以便仅将修改后的文件发送到托管服务器？

调用该命令时，目标文件夹文件将被擦除并替换为新构建的结果（创建程序集文件以及一些标记文件）。随着我的网站越来越大，我必须全部转移到服务器我的 bin 目录中的程序集，并记住我可能修改了哪些其他文件。

有没有更好的方法来做到这一点？

ps：我使用 FileZila 将我的文件传输到服务器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T21:56:27.540

您可以在本地发布并使用您选择的任何机制来传输文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T21:58:44.353

发布到本地目录，然后使用差异工具（例如[WinMerge](http://winmerge.org/)）查找修改后的文件并将其复制到服务器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T22:44:49.563

您是否尝试过**网站-> 复制网站**菜单项？它似乎知道哪些文件被更改。

# asp.net-mvc - 如何为 ASP.NET MVC 重新填充向导样式页面中的所有内容？

> ID：596832
> 
> 赞同：0
> 
> 时间：2009-02-27T21:53:20.480
> 
> 标签：asp.net-mvc

我有一个在我们的帮助台系统中创建票证的页面。它充当向导，具有以下步骤：

## 步骤1

用户从下拉列表中选择客户。有一个 jquery onchange 事件触发并生成第 2 步的列表并隐藏第 1 步 div 并显示第 2 步 div。

## 第2步

用户从下拉列表中选择位置。这是根据在步骤 1 中选择的客户生成的。有一个 jquery onchange 事件触发并生成步骤 3 的列表并隐藏 step2 div 并显示 step3 div。

## 第 3 步

用户从下拉列表中选择类型并将文本输入到 3 个不同的文本框中。如果用户无法输入文本或输入无效文本，我的控制器会将模型状态更改为无效并返回视图。

如何使用用户选择的正确选择重新填充所有下拉列表并在步骤 3 中重新显示页面？

我的第一个想法是使用 ajax，当用户单击“创建”按钮时，我可以从那里创建票证，如果成功将它们发送到票证详细信息。如果不成功，那么只需显示一条错误消息，我仍在页面上，所以没什么大不了的。现在我把它写出来，我认为这是最好的。使用ajax有什么大问题吗？如今，似乎大多数网站都使用某种类型的 javascript 或 ajax。

第二个想法是根本不使用 ajax 并将所有页面提交到服务器。

你有什么建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T22:17:46.757

这 3 个步骤显示完全不同的标记。AJAX 版本可能没有什么好处，除了在您更改步骤时避免的页面闪烁。

如果您采用非 AJAX 方式，您将获得：

*   漂亮的书签链接（ www.ticketsystem.com/Customer -> www.ticketsystem.com/Customer/Microsoft/ -> www.ticketsystem.com/Customer/Microsoft/Location -> www.ticketsystem.com/Customer/Microsoft/Location/雷德蒙德）
*   浏览器历史有效
*   更容易测试

要在第 3 步之后重新显示列表，您将加载所有列表并根据 URL 中的参数设置所选项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T21:57:59.783

我同意你的看法。使用 AJAX 提交票证。

# c# - 避免 .NET (C#) 项目中的重复图标资源

> ID：596837
> 
> 赞同：23
> 
> 时间：2009-02-27T21:55:22.940
> 
> 标签：c#, winforms, winapi, resources

我正在使用 Visual C# 2008 Express。我想为应用程序（即.exe 显示的图标）和主窗体使用相同的图标。不幸的是，VC# 对此似乎不太聪明，并且坚持要复制图标数据。

似乎没有办法选择在表单或项目图标中使用的“已嵌入”图标（仅选择一个文件），并且为两个图标使用相同的文件只是尽可能地嵌入文件两倍看。这没什么大不了的（硬盘空间现在很便宜，对吧？），但这让我很烦恼。

知道如何避免这种情况吗？有没有办法以编程方式加载可执行文件的图标，以便在构建表单时使用，比如说？一些关于类似事情的论坛帖子似乎表明 .NET 资源不使用普通的旧 Windows 资源系统——在获取旧式资源的框架内有没有办法？还是我必须绑定 Win32 API 函数才能做到这一点？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-27T21:57:47.553

你是对的，这很烦人。

您必须自己加载图标，而不是依赖设计器生成的代码。将图标保存为项目资源，然后将资源加载到`Icon`表单构造函数中的表单属性中：

```
this.Icon = Properties.Resources.myIconResourceName; 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-27T22:36:12.343

你正在寻找[`Icon.ExtractAssociatedIcon`](http://msdn.microsoft.com/en-us/library/system.drawing.icon.extractassociatedicon.aspx). 调用传递您的可执行文件：

```
var icon = Icon.ExtractAssociatedIcon(Assembly.GetExecutingAssembly().Location); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-10T21:27:28.797

是的，这很烦人。但是 Icon.ExtractAssociatedIcon 的建议答案的问题在于它会检索 32x32 图标，然后在表单窗口或任务栏上下采样到 16x16 图标，除非您的 32x32 图标非常巧妙地构建，否则这看起来很糟糕。

我这样做的方式是使用互操作（将第一行放在表单构造函数中）：

```
this.Icon = ExtractSmallIconFromLibrary(Application.ExecutablePath);
...

public static Icon ExtractSmallIconFromLibrary(string file) {
    IntPtr[] reficon = new IntPtr[1];
    int nextracted = ExtractIconEx(file, 0, null, reficon, 1);
    if (nextracted < 1)
        return null;
    Icon unmanaged_icon = Icon.FromHandle(reficon[0]);
    Icon icon = (Icon)unmanaged_icon.Clone();
    DestroyIcon(unmanaged_icon.Handle);
    return icon;
}

[DllImport("Shell32", CharSet = CharSet.Auto)]
extern static int ExtractIconEx(
    [MarshalAs(UnmanagedType.LPTStr)] 
    string lpszFile,
    int nIconIndex,
    IntPtr[] phIconLarge,
    IntPtr[] phIconSmall,
    int nIcons
    );

[DllImport("user32.dll", CharSet = CharSet.Auto)]
extern static bool DestroyIcon(IntPtr handle); 
```

但这也不是很好，因为您*确实*需要 32x32 图标来表示 Alt-Tab 图标列表之类的东西。所以你真的需要提取*整个*图标，这是一项更大的工作。也许有一种简单的方法可以将两个图标组合成一个。或者你可以像这个[codeproject](http://www.codeproject.com/KB/dialog/AssigningDefaultIcon.aspx)程序那样做，它首先用一大堆代码提取整个图标。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-02-15T09:16:54.790

我认为在许多情况下，包括重复图标最终比尝试从非托管资源中提取它更有效 - 考虑到您不能将 Icon.ExtractAssociatedIcon 用于 UNC 路径。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-07-30T14:41:46.573

我有一个类似的问题。

我有一个 exe 图标，我想在不增加文件大小的情况下将其重用于子表单。

```
//From MyApp
MySubForm msf = new MySubForm();
msf.Icon = this.Icon;
msf.Show(); 
```

我不知道这是否有用，但无论如何我想分享它。

# sql - 列顺序很重要的 Oracle DB 简单 SELECT

> ID：596841
> 
> 赞同：0
> 
> 时间：2009-02-27T21:55:51.553
> 
> 标签：sql, database, oracle

我正在 Oracle DB 中执行一个简单的 SELECT 语句，并且需要以某种特定的顺序选择列。例子：

表 A 有 100 个属性，其中之一是按表中列顺序某处出现的“章节”。我需要先选择带有“章节”的数据，然后选择剩余的列，没有特定的顺序。从本质上讲，我的声明需要阅读如下内容：

`SELECT a.chapter, a. *the remaining columns* FROM A`

此外，我不能简单地输入：

`SELECT a.chapter, a.*`

因为这将选择“章节”两次。

我知道 SQL 语句看起来很简单，但如果我知道如何解决这个问题，我可以将这个想法外推到更复杂的领域。另外，假设我不能滚动找到“章节”列并将其拖到开头。

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-27T22:04:46.787

您不应该在程序中选择 *。随着模式的发展，它会带来你还不知道的东西。想想当有人添加一个包含整本书的专栏时会发生什么？您认为非常便宜的查询突然开始引入数兆字节的数据。

这意味着您*必须*指定所需的每一列。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-27T22:35:06.683

您最好的选择是明确选择每一列。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-27T22:00:24.927

解决此问题的一种快速方法是 SELECT a.chapter AS chapterCol, a.* FROM table a; 这意味着将有一个列名称 chapterCol（假设那里还没有一个名为 chapterCol 的列。;））

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-28T21:33:37.010

如果您要将“SELECT *”嵌入到程序代码中，那么我强烈建议您不要这样做。正如前面的作者所指出的，如果曾经将列添加到表中（或从表中删除），则设置代码以中断。简单的建议是不要这样做。

如果您在开发工具中使用它（查看数据等）。然后，我建议使用您需要的特定列顺序创建一个视图。从 'SELECT COLUMN_NAME FROM ALL_TAB_COLUMNS' 捕获输出，并使用您需要的列顺序为视图创建一个 select 语句。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-27T22:18:09.843

这就是我无需输入所有名称而是通过一些手动操作来构建您的查询的方式。

从“选择一个章节”开始

现在在您的数据库上执行另一个选择，如下所示：

选择','|| 来自 user_tab_cols 的 column_name 其中 table_name = your_real_table_name 和 column_name <> 'CHAPTER'；

现在以剪切和粘贴的方式从中获取输出并将其附加到您开始的内容中。现在运行该查询。应该是你要求的。

达达！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-27T22:05:39.437

除非您有充分的理由这样做，否则不应在查询中使用 SELECT *。每次架构更改时，它都会破坏您的应用程序。

# javascript - 像 JetBrains dotTrace 这样的 JavaScript 分析器？

> ID：596855
> 
> 赞同：1
> 
> 时间：2009-02-27T21:59:59.810
> 
> 标签：javascript, profiler, dottrace

我是我的 Web 应用程序的 dotTrace 的忠实粉丝，我想找到一个功能相同的可靠 javascript 分析器。我环顾四周，似乎找不到这样的 JavaScript 分析器。

有人知道像 dotTrace 这样的 Javascript 分析器吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T22:16:06.340

[Firebug](http://getfirebug.com/)内置了一个不错的分析器，以及许多其他有用的东西。如果您需要特定功能，请更具体。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T22:33:11.510

IE8 包含一个 Javascript 分析器：http: [//blogs.msdn.com/ie/archive/2008/09/11/introducing-the-ie8-developer-tools-jscript-profiler.aspx](http://blogs.msdn.com/ie/archive/2008/09/11/introducing-the-ie8-developer-tools-jscript-profiler.aspx)。它的报告和输出看起来有点像 dotTrace。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T22:19:45.753

如果您正在寻找性能改进，我会推荐一个名为[YSlow的 Firebug 插件。](http://developer.yahoo.com/yslow/)

此外，Venkman 调试器[提供](http://www.hacksrus.com/~ginda/venkman/faq/venkman-faq.html#profiler)分析。这是[最新版本](https://addons.mozilla.org/en-US/firefox/addon/216)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T22:17:31.233

[总是有一个名为Firebug](http://getfirebug.com/js.html)的 Firefox 插件。

# iphone - 是否可以以编程方式使 iPhone 静音？

> ID：596862
> 
> 赞同：6
> 
> 时间：2009-02-27T22:02:06.747
> 
> 标签：iphone, volume

我已经看到了确保应用程序尊重静音开关的技术，但是是否可以使用 SDK 将 iPhone 设置为静音（没有来自任何应用程序的声音）？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-27T22:07:30.197

不。

使用官方 SDK 开发的应用程序无法更改（在大多数情况下甚至无法访问）系统范围的设置。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-08-10T15:24:51.020

这是可能的，但只能使用私有 API。我只是把铃声静音，但你应该也可以控制大师级别。

请参阅[如何禁用 iOS 系统声音](https://stackoverflow.com/questions/6284402/how-to-disable-ios-system-sounds/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-01T00:10:07.460

技术上可以通过 Celestial.framework 中的私有类更改系统音量`AVSystemController`，但会阻止您的应用程序获得 Apple 的批准

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-27T23:04:12.497

由于一次只能运行一个应用程序，我能想到的唯一可能的用途就是静音其他人的应用程序，而且应该很清楚为什么 Apple 会阻止它。

如果某个应用程序将 iPhone 静音而我不知道它发生了，我会怎么做？它不能物理移动手机侧面的静音开关，所以这不匹配，我必须弄清楚a）手机已静音，b）如何在没有开关的情况下取消静音。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-13T02:22:53.150

我可以使用 AVSystemController 更改音量，它设置为最小值，即 0.06x。是否有类/API 可以完全静音？toggleActiveCategoryMuted 不起作用

# html - 如何在 FF 或 IE 中打印背景图像？

> ID：596876
> 
> 赞同：40
> 
> 时间：2009-02-27T22:11:36.663
> 
> 标签：html, css

有没有办法设置 ff 和 ie 打印背景图像？

我正在使用星星图像对一些技能进行分类，并将其设置为背景图像并定位为设置一开始、二、三等。当我尝试打印页面时，图像消失了。

那么，当我打印页面时，有什么方法可以让它们出现，或者至少有办法用 * 或可见的东西替换图像？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-27T22:20:01.057

您是否考虑过使用打印样式表？这可以让您执行以下操作：

```
<div class="star">*</div>

/* media:screen */
.star {
    background: ...;
    overflow: hidden;
    text-indent: 9999em;
}

/* media:print */
.star {
    text-indent: 0;
} 
```

甚至更简单：

```
<div class="star"><img src="./images/star.jpg" alt="*" /></div>

/* media:screen */
.star img {
    visibility: hidden;
}

/* media:print */
.star img {
    visibility: visible;
} 
```

您可以通过 css 或 link 元素提供媒体标签来指定浏览器应使用的样式表：

```
<link rel="stylesheet" type="text/css" href="main.css" media="screen" />
<link rel="print stylesheet" type="text/css" href="print.css" media="print" /> 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-02-27T22:14:37.013

在 Firefox 中，转到文件 => 页面设置。“打印背景（颜色和图像）”有一个复选框。只需检查一下，您就应该准备就绪。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-08-02T03:07:42.827

在您的 print.css 文件中，将背景图像更改为列表项。

所以：

```
.background {
  display: list-item;
  list-style-image: url(yourbackgroundimage.gif);
  list-style-position: inside;
} 
```

这种方法在这里有更多描述：[http ://www.web-graphics.com/mtarchive/001703.php](http://www.web-graphics.com/mtarchive/001703.php)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2010-06-03T12:45:32.447

其实我发现答案很简单。

情况：我有一个带有背景图像的 div 标签。打印时不会打印出来。

解决方案：

1.  创建另一个名为“print.css”的样式表

2.  在您的原始 css 样式表链接之后，将以下代码行添加到您的所有网页：

    ```
    <link rel="stylesheet" type="text/css" media="print" href="css/print_styles.css" /> 
    ```

3.  在原始非打印标题之后，立即添加以下内容：

    ```
    <div id="header"></div> <!-- YOUR NON PRINTING HEADER -->

    <div id="printheader"><img src="images/header_image.jpg" width="940" height="100" alt="header" /></div> 
    ```

4.  在您的 style.css 文件中，这是您网站的主要 css 样式，添加以下行：

    ```
    #printheader {display: none; } /* Makes the print header not visible */ 
    ```

5.  在您的 print.css 文件中，添加以下代码：

    ```
    #footer, #nav, #sidenav, .print, .search, .breadcrumb, .noprint {display: none;} /* Items from your page you DO NOT want to print */

    #container, #container2, #contentwide, #contentwide_tpsub, #contentwide_tp, #contentwide_open {width: 100%; margin: 0; float: none;} /* Clear widths to ensure all text is printed */

    #printheader {display: block; } /* Turns ON the div when printing */ 
    ```

您所做的实际上是关闭正常“屏幕”页面上的标题并在您进行打印调用时打开打印头。

** 请注意：您将需要修改 print.css 文件以包含 style.css 文件的其他元素以格式化字体、颜色等。使用“打印预览”并添加您需要的元素直到您获取您一直在寻找的打印输出。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-08-16T18:58:43.840

不要`background-image`用于显示可打印的图像，`<img>`而是使用普通标签。

`background-image`适用于大多数现代浏览器在打印期间倾向于跳过的*不重要图像（IE 11、Chrome 35、FF 30 中的默认设置）。*

为什么**不想**使用`img`标签？

*   **对齐问题**- 使用绝对定位来解决对齐问题。

*   **Spriting** - Spriting[可以](https://stackoverflow.com/questions/2428053/css-sprites-not-only-for-background-images)使用简单的`img`和`div`标签。

*   **让用户更难保存图像**- 这[也可以](https://stackoverflow.com/questions/1678579/how-to-disable-right-click-save-on-one-specific-image-only)通过简单的`img`和`div`标签来实现。

*   **为了“保持我的 HTML 干净”** - 是否有任何变通解决方案真的让您的 HTML 更干净？放弃 ：）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-27T22:14:02.960

对于 IE [http://support.microsoft.com/kb/980077](http://support.microsoft.com/kb/980077)

FF 一定有类似的东西。

ps 你不能为客户设置这个！

ps2。您可以在 css (media="print") 中用前景图片（如果需要，绝对）替换这些星星。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-01-13T20:59:10.273

我遇到了同样的问题，IE 不支持打印背景。

所以我创建了 2 个 div，一个 div 有更高的 Z 并且有文本内容。第二个 div 紧跟在前面 div 后面，但 Z 索引较低，并且有一个宽度和高度为 100% 的图像（img 不是背景图像）。因此，当我将 2 个 div 一起显示时，它看起来就像一个 div，因为它们完全重叠。当我在 IE 浏览器中打印时，它会显示图像，因为图像不是背景图像，而是填充较低 div 的普通 img 标签。

一些代码。

```
<div id="survey" class="surveyResponseWindow" style="display:none;">Please logout and re-login, because your session has expired.</div>
<div id="surveyBackground" class="surveyBackgroundDiv" style="display:none;">
<!-- provides the background image for ie browser so that it does not show the lower level divs. -->
<img src="/rsm/jsp/public/images/contentGrad.gif" width="100%" height="100%" />
</div>

<script language="javascript" type="text/javascript">  
function showSurvey(surveyResponseId) {
    var e = document.getElementById("survey");
    var bkgd = document.getElementById("surveyBackground");
    var focusinput = document.getElementById('focusinput');
    var nh = 'data-nohide';

    if (e.style.display=='none') {
        e.style.display='block';//show div
        bkgd.style.display='block';//show div
    }
    focusinput.focus();//set focus so we know when they click outside

    e.onclick = function(e) {
        this.style.display='none';//hide div if they click on it
        bkgd.style.display='none';//show div
    };
    //if the user press ESC
    focusinput.onkeyup = function(e){
        if(e.keyCode === 27){
            var survey = document.getElementById("survey");
            var bkgd = document.getElementById("surveyBackground");
            //hide the div
            survey.style.display = 'none';
            bkgd.style.display = 'none';
            this.removeAttribute(nh);
        }else{
            //do something else with other keys(ie:down, up, enter)...
            focusinput.focus();
        }
    };
    //click somewhere else input onblur
    // was taken out because the browser print function would close the survey div page.
    //focusinput.onblur = function(){
    //    if(!e.getAttribute(nh)){
    //      //hide the div
    //        e.style.display = 'none';
    //    }
    //};     

    var params='<%=request.getContextPath()%>/request/dashboard/drilldown/callSurveyDetailAjax.html?surveyResponseId='+surveyResponseId;
    YAHOO.plugin.Dispatcher.fetch(e,params, {onLoad:showBackground});
}

var showBackground = function() {
    var e = document.getElementById("survey");
    var bkgd = document.getElementById("surveyBackground");
    bkgd.style.width = e.innerWidth();
    bkgd.style.height = e.innerHeight();
    bkgd.style.left = e.offsetWidth();
    bkgd.style.top = e.offsetHeight();
}

window.onload = function() {
    var focusinput = document.getElementById('focusinput');
    focusinput.focus();//set focus so we know when they click outside
}
</script> 
```

在 CSS 中放这个

```
.surveyResponseWindow 
{
width:500px;
height:600px;
z-index: 2;
position: absolute;
top:100px;
left:150px;
border:1px solid #AAAAAA;   
border-bottom-left-radius:10px;
border-bottom-right-radius:10px;
border-top-left-radius:10px;
border-top-right-radius:10px;   
box-shadow: -1px 7px 15px -2px #000;
}

.surveyBackgroundDiv 
{
z-index: 1;
position: absolute;
top:100px;
left:150px;
width:500px;
height:600px;
border:1px solid #AAAAAA;   
border-bottom-left-radius:10px;
border-bottom-right-radius:10px;
border-top-left-radius:10px;
border-top-right-radius:10px;   
box-shadow: -1px 7px 15px -2px #000;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-27T22:17:22.017

我相信这是浏览器设置，而不是网站的后端。然而，我可能是错的。

# windows - 在将由 cscript.exe 执行的 VBScript 中创建 Windows 复选框

> ID：596878
> 
> 赞同：0
> 
> 时间：2009-02-27T22:13:19.233
> 
> 标签：windows, user-interface, scripting, vbscript, wsh

如果我有一个[像](http://en.wikipedia.org/wiki/VBScript)...

```
inputControl1 = InputBox("Hello World")
WScript.Quit 
```

如何在其中创建复选框而不是 InputBox？

我知道 VBScript 本身没有像 InputBox 这样的复选框控件，但是是否有一些库可以用来执行以下操作？

```
inputControl1 = CreateObject("library.checkboxcontrol")
WScript.Quit 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T22:34:58.650

你不能使用是/否 msgbox 代替吗？

```
dim Answer
Answer=msgbox("Your question here",4) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T22:44:15.007

您可以使用 HTA。这将比 VBScript 更复杂，但它会用 VBScript + HTML 编写。不过，您可能需要解决一些 IE 限制。

或者，如果您获得 VB.NET Express 和使用它的代码。当然，这是一种不同的语言。

# python - AttributeError：“str”对象没有属性“readline”

> ID：596886
> 
> 赞同：4
> 
> 时间：2009-02-27T22:15:25.263
> 
> 标签：python, file, readline

**更新：我当前的问题是如何让我的代码从每个新的搜索短语开始读取到 EOF。**

这是我正在做的一项任务，目前仍在坚持。请注意，这是一个使用 Python 的初学者编程课程。

```
jargon = open("jargonFile.txt","r")
searchPhrase = raw_input("Enter the search phrase: ")
while searchPhrase != "":
    result = jargon.readline().find(searchPhrase)
    if result == -1:
        print "Cannot find this term."
    else:
        print result
    searchPhrase = raw_input("Enter the search phrase: ")
jargon.close() 
```

任务是获取用户的 searchPhrase 并在文件（jargonFile.txt）中找到它，然后让它打印结果（这是它出现的行和字符出现）。我将使用计数器来查找发生的行号，但我稍后会实现它。现在我的问题是我得到的错误。我找不到搜索整个文件的方法。

样品运行：

```
Enter the search phrase: dog
16
Enter the search phrase: hack
Cannot find this term.
Enter the search phrase: 
```

“dog”出现在第一行，但它也出现在 jargonFile 的其他行中（多次作为字符串），但它只显示第一行中的第一次出现。在 jargonFile 中多次发现字符串 hack，但我的代码设置为仅搜索第一行。我该如何解决这个问题？

如果这还不够清楚，我可以在需要时发布作业。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T22:21:22.893

首先，您打开文件并使用 readline() 将其读入字符串。稍后您尝试从您在第一步中获得的字符串中读取行（）。

您需要注意您正在处理的对象（事物）：open() 给了您一个文件“行话”，行话上的 readline 给了您字符串“jargonFile”。

所以 jargonFile.readline 不再有意义

更新为评论的答案：

好的，既然 str 错误问题已经解决，请考虑程序结构：

```
big loop
  enter a search term
  open file
  inner loop
     read a line
     print result if string found
  close file 
```

您需要更改程序，使其遵循该描述

更新二：

SD，如果您想避免重新打开文件，您仍然需要两个循环，但是这次一个循环将文件读入内存，完成后第二个循环询问搜索词。所以你会像这样构造它

```
create empty list
open file
read loop:
    read a line from the file
    append the file to the list
close file
query loop:
    ask the user for input
    for each line in the array:
        print result if string found 
```

对于您的教授的加分，请在您的解决方案中添加一些评论，提及两种可能的解决方案，并说明您为什么选择您选择的解决方案。提示：在这种情况下，这是执行时间（内存很快）和内存使用量（如果您的行话文件包含 1 亿个条目怎么办...好吧，在这种情况下您会使用比平面文件更复杂的东西）之间的经典权衡，但您也无法将其加载到内存中。）

哦，还有一个关于第二种解决方案的提示：Python 支持元组 ("a","b","c") 和列表 ["a","b","c"]。您想使用后者，因为列表可以修改（元组不能。）

```
myList = ["Hello", "SD"]
myList.append("How are you?")
foreach line in myList:
    print line 
```

==>

```
Hello
SD
How are you? 
```

好的，最后一个示例包含程序第二个解决方案的所有新内容（定义列表、附加到列表、循环列表）。把它们放在一起玩得开心。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T22:20:13.210

您的文件是`jargon`，而不是`jargonFile`（字符串）。这可能是导致您的错误消息的原因。您还需要第二个循环从头开始读取文件的每一行，直到找到您要查找的单词。如果在文件的当前行中找不到该单词，您的代码当前会停止搜索。

尝试编写只给用户一次输入字符串的机会的代码怎么样？输入该字符串，搜索文件直到找到（或没有）并输出结果。完成该工作后，您可以返回并添加允许多次搜索并以空字符串结尾的代码。

**更新：**

为避免多次迭代文件，您可以通过将整个文件插入到字符串列表中来启动程序，一次一行。查找`readlines`文件对象的方法。然后，您可以在该列表中搜索每个用户输入，而不是重新读取文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-28T00:21:41.513

嗯，我对 Python 一无所知，但在我看来，您并没有在文件的所有行中迭代输入的搜索字符串。

通常，您需要执行以下操作：

```
enter search string
open file
if file has data
   start loop
     get next line of file
     search the line for your string and do something

   Exit loop if line was end of file 
```

所以对于你的代码：

```
jargon = open("jargonFile.txt","r")
searchPhrase = raw_input("Enter the search phrase: ")
while searchPhrase != "":
    <<if file has data?>>
      <<while>>
        result = jargon.readline().find(searchPhrase)
        if result == -1:
            print "Cannot find this term."
        else:
            print result
      <<result is not end of file>>
   searchPhrase = raw_input("Enter the search phrase: ")
jargon.close() 
```

酷，对 DNS 提供的页面做了一些研究，Python 恰好有“with”关键字。例子：

```
with open("hello.txt") as f:
    for line in f:
        print line 
```

因此，您的代码的另一种形式可能是：

```
searchPhrase = raw_input("Enter the search phrase: ")
while searchPhrase != "":
    with open("jargonFile.txt") as f:
        for line in f:
           result = line.find(searchPhrase)
           if result == -1:
              print "Cannot find this term."
           else:
              print result
    searchPhrase = raw_input("Enter the search phrase: ") 
```

请注意，“with”会在您完成后自动关闭文件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-28T13:14:32.967

你不应该尝试重新发明轮子。只需使用 [re 模块功能](http://docs.python.org/3.0/library/re.html?highlight=findall#re.findall)。如果您使用： result = jargon.read() ，您的程序可能会更好地工作。而不是： result = jargon.readline() 。然后你可以使用 re.findall() 函数并加入你用 str.join() 搜索的字符串（带有索引）这可能会有点混乱，但如果需要一些时间来解决它，这可以解决你的问题. python文档有这个完美记录

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-27T22:31:55.630

每次您输入搜索词组时，它都会**在下**一行而不是第一行中查找。如果您希望它的行为与您描述的一样，您需要为每个搜索短语重新打开文件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-27T22:33:56.937

查看 File 对象的文档：

[http://docs.python.org/library/stdtypes.html#file-objects](http://docs.python.org/library/stdtypes.html#file-objects)

您可能对该`readlines`方法感兴趣。对于您的文件不是很大的简单情况，您可以使用它将所有行读入列表中。然后，每当您获得一个新的搜索字符串时，您都可以遍历整个列表以查看它是否存在。

# wcf - 与 Silverlight 兼容的 Azure 上的 WCF 使用了哪种类型的安全性？

> ID：596893
> 
> 赞同：4
> 
> 时间：2009-02-27T22:17:30.080
> 
> 标签：wcf, silverlight, security, ssl, azure

是否有人在 Azure 上获得了与 Silverlight 兼容的 WCF 的任何类型的安全性？

我已经在基本的 http 绑定上尝试过传输安全，但它[不起作用](http://social.msdn.microsoft.com/Forums/en/windowsazure/thread/f3778772-e74e-4b5e-9ae5-72ecc0138ff1)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T06:22:40.310

看看这些 WCF Azure 示例：[http ://code.msdn.microsoft.com/wcfazure](http://code.msdn.microsoft.com/wcfazure)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-27T22:23:04.700

看看这里：[http ://silverlightuk.blogspot.com/2008/03/silverlight-wcf-and-aspnet.html](http://silverlightuk.blogspot.com/2008/03/silverlight-wcf-and-aspnet.html)

在我看来，基于表单的基本身份验证应该适合您。

编辑：在您的评论中，您说您不喜欢使用基于表单的身份验证。

您是否尝试过此处提供的建议：http: [//blogs.msdn.com/mikeormond/archive/2007/07/12/accessing-asp-net-application-services-from-silverlight-part-2.aspx](http://blogs.msdn.com/mikeormond/archive/2007/07/12/accessing-asp-net-application-services-from-silverlight-part-2.aspx)

# firefox - 在 Firefox 扩展中使用 nsIURIContentListener 的问题

> ID：596900
> 
> 赞同：1
> 
> 时间：2009-02-27T22:20:28.387
> 
> 标签：firefox

我正在开发一个小型扩展，它必须将某些 URL 重定向到另一个站点。它工作正常，除了一种情况：如果使用“上下文菜单 - > 在新选项卡中打开”打开链接，当前页面将重定向到我的页面，并打开第二个选项卡，其中包含应重定向的链接。我做错了什么？有没有更好的方法来实现我想要的？

```
var myListener =
{
    QueryInterface: function(iid)
     {
         if (iid.equals(Components.interfaces.nsIURIContentListener) ||
          iid.equals(Components.interfaces.nsISupportsWeakReference) ||
             iid.equals(Components.interfaces.nsISupports))
             return this;
         throw Components.results.NS_NOINTERFACE;
     },
     onStartURIOpen: function(aUri)
     {
            if (check_url(aUri)) {
                getBrowser().mCurrentTab.linkedBrowser.loadURI(######REDIRECT IS HERE#############);
                return true;
            }
            return false;
     },
     doContent: function(aContentType, aIsContentPreferred, aRequest, aContentHandler )
     {
           throw Components.results.NS_ERROR_NOT_IMPLEMENTED;
     },
     canHandleContent: function(aContentType, aIsContentPreferred, aDesiredContentType)
    {
           throw Components.results.NS_ERROR_NOT_IMPLEMENTED;
     },
     isPreferred: function(aContentType, aDesiredContentType)
    {
         try
        {
             var webNavInfo =
             Components.classes["@mozilla.org/webnavigation-info;1"]
                         .getService(Components.interfaces.nsIWebNavigationInfo);
             return webNavInfo.isTypeSupported(aContentType, null);
         }
       catch (e)
       {
             return false;
         }
     },
       GetWeakReference : function()
    {
        throw Components.results.NS_ERROR_NOT_IMPLEMENTED;
     }
} 
```

完整的扩展可以在这里找到：http: [//github.com/bitboxer/firefox-detinyfy](http://github.com/bitboxer/firefox-detinyfy)

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-02-28T12:58:31.833

好的，我做了一些研究。Hook 是一个错误的方法。我现在更改了代码。查看 git 以了解更多信息...

# ruby-on-rails - Mongrel 与 WEBrick

> ID：596902
> 
> 赞同：30
> 
> 时间：2009-02-27T22:21:26.983
> 
> 标签：ruby-on-rails, ruby

Mongrel 和 WEBrick 有什么区别？

我应该使用哪一个？

为什么 Rails 两者都附带？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-02-27T22:27:42.067

对于您的本地开发，它们都将起作用。Mongrel 更快、更高效、更稳定。有些人（包括我自己）甚至使用它来托管他们的生产站点。本地发展当然没问题。

如果您使用的是非 Windows，我建议您查看[Phusion Passenger](http://www.modrails.com/)。您可以在 localhost 上支持多个应用程序，而无需在每次想要运行某些东西时都执行“ruby 脚本/服务器”。

运行 Phusion Passenger 时，您必须自己跟踪日志文件。mongrel 将在控制台窗口中显示日志，因此要获得该功能，您必须`tail -f log/development.log`使用Passenger。

为什么 Rails 两者都附带？历史。Webrick 是用 ruby​​ 编写的，所以它是早期的最爱。Mongrel 出现并且变得更好，但是 webrick 支持并没有被放弃。

如果您不想安装 Phusion Passenger，请使用 mongrel。这是默认设置，并且可以正常工作。

编辑 2009-08：我也很幸运，[薄](http://code.macournoyer.com/thin/)，杂种的替代品。对于开发来说，这没什么大不了的，但对于生产来说，这是需要检查的东西。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-27T22:26:59.713

Mongrel 的*效率*和稳定性要高得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T23:13:16.310

我也喜欢 mongrel 在运行时如何将有用的信息输出到标准输出。两者都可以，对于生产来说，mongrel 比 webrick 更好。Phusion 也很酷，但我不将它用于开发。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-28T00:47:55.553

虽然两者都可以，但我强烈建议不要使用 WEBrick，即使在开发模式下它也确实很不稳定，有时甚至会在不应该的时候需要重新启动。

我绝对推荐 Mongrel 进行开发，因为这意味着您不必按照您可能想要或需要的方式设置 Apache，您可以了解您的应用程序在生产中可能如何运行，而我真的不知道看看打字脚本/服务器是多么糟糕。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-01-04T13:43:56.600

有相当公平的速度测试，因此您可以在您的环境中重复它并选择最佳方式。 [http://kovyrin.net/2006/08/28/ruby-performance-results/lang/en/](http://kovyrin.net/2006/08/28/ruby-performance-results/lang/en/)

# excel - 在 Excel 自动化中获得范围“设置差异”的最有效方法是什么？

> ID：596914
> 
> 赞同：0
> 
> 时间：2009-02-27T22:24:56.100
> 
> 标签：excel, automation

给定一对范围，其中一个已知包含另一个的元素：

```
src = ActiveSheet.UsedRange
sel = src.SpecialCells(xlCellTypeVisible) 
```

获得代表这两个范围之间设定差异的新范围的最有效方法是什么，即其中的*单元*格`src`不在？*`sel`*

 *这可以通过对 中的单元格进行循环来完成`src`，但这需要对按范围`m * n`进行自动化调用，这没有很好的性能，而且我希望涉及更少的远程 API 调用。`m``n`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-02T16:04:43.353

您是否尝试过使用 Excel 的内置公式来过滤数据？例如，如果在 D 列中找到单元格 A2 中的值，则以下公式将打印“是”。在您的情况下，您可以简单地获取所有没有相应“是”的单元格。

```
=IF(MATCH(A2,D:D, 0)>0,"Yes","No") 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-06-07T18:05:17.727

为了扩展 Tom E 的答案，我遇到的一个问题是，当没有匹配时，`=MATCH()`返回`#N/A`整个函数不喜欢的。

要解决此问题，您可以对等式进行以下更改：

```
=IF(ISNA(MATCH(A2,D:D, 0)),"No","Yes") 
```

`ISNA()`有效地将数字转换为和`Yes`（`#N/A`不匹配）转换为`No`，这是我们想要的。请注意，由于功能的不同，我不得不颠倒是和否的顺序`ISNA()`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T15:31:06.117

我认为没有比遍历 src 中的每个单元格更好的方法了。Excel.Application 对象具有 Intersect 函数，它告诉您哪些单元格包含在两个或多个区域中，但不是相反。您还可以执行联合，它只为您提供一个范围，其中包含两个或多个范围内的所有单元格......

但我认为你将不得不遍历 src 中的每个单元格，看看它是否在 sel 中......

```
Function GetInvisibleCells() As Range
    Dim src As Range, sel As Range

    Set src = ActiveSheet.UsedRange
    Set sel = src.SpecialCells(xlCellTypeVisible)

    Dim Isection As Range
    Set Isection = Application.Intersect(src, sel)

    Dim Result As Range

    Dim cl As Range
    For Each cl In src ' Go find all the cells in range2 that aren't in Isection
        If Application.Intersect(cl, Isection) Is Nothing Then
            ' Cl is not in sel
            If Not Result Is Nothing Then
                Set Result = Range(Result, cl)
            Else
                Set Result = cl
            End If
            ' Debug.Print Cl.Address & " is in " & src.Address & " and not in " & sel.Address
        End If
    Next cl
    Application.Intersect
    Set GetInvisibleCells = Result

End Function 
```

[这里](http://www.dailydoseofexcel.com/archives/2007/08/17/two-new-range-functions-union-and-subtract/)有一些详细的方法

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-08T07:27:42.267

这是另一种解决方法。根据 MSDN 中的`ColumnDifferences`方法[参考](http://msdn.microsoft.com/en-us/library/office/aa223836%28v=office.11%29.aspx)：“*返回一个`Range`对象，该对象表示其内容与每列中的比较单元格不同的所有单元格*”。

基于此，我应用了以下策略：

(1) 将 的内容存储`src`到 a`Variant`中。

`sel`(2)用完全随机的东西代替 的内容。

(3) 使用`ColumnDifferences`方法得到所需的范围。

(4) 返回 的原始值`src`，这些值存储在 中`Variant`。

上述步骤的实现如下：

```
Dim src As Range, sel As Range, rngDiff As Range, varTempStorage As Variant
Dim icnt1 As Long, icnt2 As Long

Set src = ActiveSheet.UsedRange
Set sel = src.SpecialCells(xlCellTypeVisible)

' Store the src values in a variant
varTempStorage = src.Value

' Fill up the visible range with something random
sel.Value = "something completely random"

' Will return an error if nothing is found so needs appropriate error handling
' If it works, it should set rngDiff to point to the hidden cells only
Set rngDiff = src.ColumnDifferences(Comparison:=src(1,1))

' Pass data from variant to range - method taken from CPearson's website
Set src = src(1, 1)
src.Resize(UBound(varTempStorage, 1), UBound(varTempStorage, 2)).Value = varTempStorage

' Have a look at the output
For icnt1 = 1 To rngDiff.Rows.Count
    For icnt2 = 1 To rngDiff.Columns.Count
        Debug.Print " address: "; rngDiff(icnt1, icnt2).Address; " value: "; rngDiff(icnt1, icnt2)
    Next icnt2
Next icnt1 
```

该`RowDifferences`方法应该给出相同的结果 - 这是因为我们替换了可见范围内的所有单元格，因此两种方法的行为方式相同。

我通过在第 1 - 17 行和 A - U 列中生成随机数并隐藏第 7 - 10 行来检查上述内容，它完成了这项工作。

# user-interface - 如何将 UI 添加到 WiX 3 安装程序？

> ID：596919
> 
> 赞同：44
> 
> 时间：2009-02-27T22:27:57.903
> 
> 标签：user-interface, wix, wix3.6, wix-extension

我试过`<UIRef Id="WixUI_Minimal" />`了，但我得到“未解决的对符号 WixUI:WixUIMinimal 的引用”。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2009-02-27T22:39:21.993

wixui 扩展不再是 wixui.wixlib。它被卷入了 WixUIExtension。

如果您在命令行上，请添加`-ext WixUIExtension`对 light.exe 的调用。

[如果您在 Visual Studio 中有一个 WiX 项目，请通过右键单击解决方案资源管理器](http://en.wikipedia.org/wiki/Microsoft_Visual_Studio#Other_tools)中的“引用”来添加对“WixUIExtension”的引用。

请参阅 WIX3 的[WiXUI 对话框集页面](http://wixtoolset.org/documentation/manual/v3/wixui/)。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-06-24T07:41:41.140

如果`.wixproj`直接通过 MSBuild 使用，不使用 Visual Studio，则需要的修改是添加以下内容：

```
<Project ...>
  ...
  <ItemGroup>
    <WixExtension Include="WixUIExtension">
      <HintPath>$(WixToolPath)WixUIExtension.dll</HintPath>
      <Name>WixUIExtension</Name>
    </WixExtension>
  </ItemGroup>
  ...
</Project> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T22:40:56.450

请参阅[Re：（WiX 用户）如何使用 WixUI_Minimal 起步？](http://www.mail-archive.com/wix-users@lists.sourceforge.net/msg03614.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-20T15:32:16.883

下面是一个关于如何自定义 WixUIExtensions 的好例子的链接。

[Wix 的自定义 UI](http://neilsleightholm.blogspot.com/2008/08/customised-uis-for-wix.html#links)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-01-27T09:28:36.613

您需要在 WIX 项目中添加对 WixUIExtension 的引用来解决此问题。

# ruby-on-rails - 如何自动找到用户的位置？

> ID：596921
> 
> 赞同：11
> 
> 时间：2009-02-27T22:28:12.317
> 
> 标签：ruby-on-rails, ruby, language-agnostic, location, detect

我目前正在开发一个节目列表网站。我将按位置显示以各种不同方式排序的用户的显示信息。

我**知道**我可以在用户第一次登录网站时询问他们的位置，但我注意到许多网站都内置了自动检测位置的功能（例如，请参阅[Last.fm](http://www.last.fm/) “Events: Concert Listings in your区域”）。

他们如何做到这一点？我目前正在用 Ruby on Rails 构建我的网站。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-27T22:39:44.833

以下是相关 Google Maps API 文档的链接：

[http://code.google.com/apis/ajax/documentation/#ClientLocation](http://code.google.com/apis/ajax/documentation/#ClientLocation)

它显示了如何使用它的示例：

```
/**
 * Set the currentState_ and currentCountry_ properties based on the client's
 * current location (when available and in the US), or to the defaults.
 */
InTheNews.prototype.setDefaultLocation_ = function() {
  this.currentState_ = this.options_.startingState;
  if (google.loader.ClientLocation &&
      google.loader.ClientLocation.address.country_code == "US" &&
      google.loader.ClientLocation.address.region) {

    // geo locate was successful and user is in the United States. range
    // check the region so that we can safely use it when selecting a
    // state level polygon overlay
    var state = google.loader.ClientLocation.address.region.toUpperCase();
    if (InTheNews.stateNames[state]) {
      this.currentState_ = state;
    }
  }
  this.currentCountry_ = "US";
} 
```

并告诉你你会从中得到什么：

> 填充后，该 `google.loader.ClientLocation`对象将使用以下 Metro 级别粒度属性填充：
> 
> *   `ClientLocation.latitude`— 提供与客户端 IP 地址相关的低分辨率纬度
>     
>     
> *   `ClientLocation.longitude`— 提供与客户端 IP 地址相关的低分辨率经度
>     
>     
> *   `ClientLocation.address.city`— 提供与客户端 IP 地址关联的城市名称
>     
>     
> *   `ClientLocation.address.country`— 提供与客户 IP 地址相关的国家名称
>     
>     
> *   ClientLocation.address.country_code — 提供与客户端 IP 地址关联的 ISO 3166-1 国家代码的名称
>     
>     
> *   ClientLocation.address.region — 提供与客户端 IP 地址关联的国家特定区域名称

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T22:32:18.437

他们通常通过 IP 表使用 IP 解析。 [ip2nation](http://www.ip2nation.com/)可能会给出一些想法

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-03-09T17:07:22.933

[http://humbuckercode.co.uk/licks/gems/geoip/](http://humbuckercode.co.uk/licks/gems/geoip/)是一个使用 Maxminds 免费或付费库的简单 gem。

轻松设置，无需架构更新。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T22:40:31.243

您可能想查看[MaxMind 的 GeoLite](http://www.maxmind.com/app/geolitecountry)解决方案以获取 IP 位置。一个开源解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-27T12:57:42.230

有一种新方法，实际上它是查找地理位置的更好方法，因为浏览器将原生支持 W3C API 进行地理位置...您应该查看[GeoMereLaal](http://github.com/parolkar/geo_mere_laal)。

# visual-studio-2008 - Visual Studio Team System 数据库版稳定吗？

> ID：596925
> 
> 赞同：0
> 
> 时间：2009-02-27T22:29:55.993
> 
> 标签：visual-studio-2008

我试图找出是否值得迁移到这个系统，并想知道人们对它的体验？

你发现它稳定了吗？越野车？

您遇到过哪些问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-28T03:50:55.067

据我所知，这是在 VS 2008 中拥有 SQL Server 2005 数据库项目的唯一方法。我没有注意到它有什么问题。

# embedded - (!C) 中的嵌入式平台开发

> ID：596929
> 
> 赞同：16
> 
> 时间：2009-02-27T22:33:03.677
> 
> 标签：embedded, development-environment

我很想知道 C 的替代品在嵌入式开发人员世界中有多受欢迎，例如 Ada ...

我只使用过 C（带有一点汇编程序），但是我的目标资源非常有限。在这个空间的其他地方是否有其他地方可以移动到其他地方？什么是机顶盒中的佼佼者？

如果！C 的根本原因是什么？

*   编译器对目标的支持
*   Trace\静态分析工具
*   其他...

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-28T01:12:19.207

[Forth](http://Forth.Org/)在嵌入式开发中非常流行。

此外，虽然[Smalltalk](http://Smalltalk.Org/)在嵌入式社区中可能不流行，但[嵌入式开发](http://Smalltalk.Org/versions/OOVM.html)在 Smalltalk 社区中肯定很流行。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-07-31T20:35:58.107

当您说“嵌入式开发”时，请记住您必须考虑项目的规模。

在对微控制器规模或 ASIC 固件进行编程时，您往往会看到 C 和汇编占主导地位。嵌入式开发人员倾向于“专门化”这些语言，因为它们的编译器几乎可用于每个嵌入式目标平台。例如，如果您的项目从具有 PowerPC 内核的芯片迁移到具有 ARM 内核的芯片，您可以相当确信您的 C 代码不会过于难以移植。一些芯片确实有可用于其他语言的编译器，但在生成的二进制文件的效率方面，它们通常与 C 编译器不匹配。由于嵌入式系统通常资源不足，系统设计人员希望使他们的代码尽可能高效（这也是您看到大量汇编语言代码的原因之一）。我见过可用于 C++、Pascal、Basic 等语言的开发工具，但它们通常是小众工具，还不够成熟，无法与可用的 C 编译器的效率相匹配。这些语言的调试工具也往往比 C/汇编语言更难找到。

您还提到了机顶盒。这种规模的嵌入式系统可以提供与 7 到 8 年前台式计算机相当的功能。它们可用的 RAM、存储空间和处理能力使它们能够运行功能齐全的操作系统和高级语言的解释器。在这些更强大的系统上，您仍然会看到 C 和汇编语言被使用（用于驱动程序代码，如果没有别的），但其他语言（如 Java、Lua、Tcl、Ruby 等）正变得越来越普遍。只要平台有足够的资源来处理语言解释器的开销，使用解释语言就可以更容易地将代码从一个平台移植到另一个平台。任何直接与硬件（驱动程序）接口的低级代码仍然通常使用汇编或 C，因为高级语言不' t总是有能力做这种事情。在嵌入式操作系统之上作为应用程序运行的任何东西通常都可以在模拟器或虚拟机中进行开发和测试，因此您会看到很多代码是用开发人员碰巧熟悉的任何语言开发的。

**TLDR 版本：** C 之所以流行，是因为它是一种几乎所有开发人员都熟悉的通用语言。组装很受欢迎，因为它允许以其他方式困难或不可能的方式进行低级硬件访问。Java 等解释/脚本语言正变得越来越流行，但是这些语言的解释器对资源的要求可能对于某些嵌入式系统来说过于庞大，无法处理。C 和汇编语言的开发/调试工具的质量和多样性也使这些选项具有吸引力。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-01T00:44:51.777

也许不是您正在寻找的 C 的一大步，但 C++ 在嵌入式项目中也相当受欢迎。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-27T22:54:00.447

我自己没用过，但是[Bascom](http://microcontrollershop.com/product_info.php?cPath=110_131&products_id=352)对于 AVR 微控制器来说非常流行。它是一个基本 IDE，可让您非常轻松地与外围设备进行交互。我遇到了成功使用它的硬件人员。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-28T00:15:13.667

是的。Java 变得越来越流行 - 许多处理器添加了主要与 Java 和类似语言 (.net) 相关的指令。此外，uclinux 在微控制器上运行，因此对于一些较大的微控制器，您几乎可以使用任何语言。

基本仍然很常见，组装也是如此。

你会在某些政府项目中看到 Ada。

一些工程师甚至将 Lua 和其他解释器放在他们的微控制器上，以便他们的客户可以扩展功能。

但是C仍然占主导地位。

-亚当

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-05T22:53:30.990

在 90 年代初期，我使用 Intel PLM51 和 DCX51 操作系统在 8051 上进行了大量嵌入式开发。

PLM 是一种非常简单的语言，但功能非常强大

我们现在使用 C

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-12T22:08:13.030

如果您在智能卡领域工作，您可以使用[Java Card](http://java.sun.com/javacard/ "Java 卡")。是的，Java，在 8 位微控制器上。其实挺好玩的 我可以在 Eclipse 中进行开发，在 PC 模拟器上进行测试（和调试！），并且可以确信它会在卡上运行相同的程序。可惜Java对于嵌入式应用程序来说是一种糟糕的语言:)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-03T22:36:53.277

我已经非常广泛地使用了[EC++](http://en.wikipedia.org/wiki/Embedded_C%2B%2B)（[嵌入式 C++](http://en.wikipedia.org/wiki/Embedded_C%2B%2B)）。

此外，[PICBasic](https://rads.stackoverflow.com/amzn/click/com/1589950011)已经在[PIC'ers](http://www.microchip.com/forums/)中流行了很久。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-05T11:00:19.893

由于客户的要求，我在军用航空电子设备的嵌入式项目中使用了 Ada。有很多用于嵌入式开发的 Ada 工具，但其中大部分都非常昂贵。就个人而言，我只会使用C。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-05T22:21:29.180

8051有一个[Pascal编译器](http://turbo51.com/)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-13T20:53:36.610

[日航](http://en.wikipedia.org/wiki/JAL_(compiler))

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-14T02:34:13.157

有[一群人](http://www.eluaproject.net/)致力于使 Lua 成为嵌入式工作的可行选择。他们主要针对具有 256K 闪存和 64K RAM 或更高的 32 位 ARM，并且似乎对他们目前的工作感到满意。

它们的部分灵感来自经典的[BASIC-Stamp](http://www.parallax.com/)，这是一个在中等强大的 PIC 中运行的 BASIC 解释器，程序本身存储在串行 EEPROM 设备中。

在工作中，我仍在维护客户的嵌入式系统，该系统是用编译的 BASIC 风格编写的，在 Zilog Z180 CPU 中运行。1980 年代的技术无处不在，大部分系统仍由 24 位 DIP 封装在插槽中构建而成。编译器在 Z80 模拟器中运行的 CP/M-80 下运行，该模拟器本身在 Windows 内置的 MS-DOS 模拟器中运行。除了惊讶于任何有生产力的事情都可以通过这种方式完成（而且你仍然可以购买 27C256 UV 可擦除 EPROMS，而且我将近 20 年的数据/IO PROM 编程器仍然可以工作）之外，我真的希望客户能够负担得起搬到新的硬件设计，以便系统可以用可维护的语言重写。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-14T02:54:56.227

取决于微控制器，它们中的许多都有 C，但编译器非常糟糕，汇编程序通常很简单，性能最好，效率最高等。像 msp、avr 和 arm 这样的编译器对 C 编译器和我想要的编译器都有好处使用C（取决于问题）。

我会坚持使用 C 或汇编程序，您使用其他任何东西都在浪费内存、性能和资源。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-08T13:31:57.363

Pascal，Modula2 也可以正常工作。从本质上讲，它们几乎等同于 C，除了无法执行 alloca（尽管有些将其作为扩展）。

但核心问题将是任何 !C 编译器的问题：您更喜欢什么，更好的编译器/工具链或偏好的语言。

尽管我最喜欢 Wirthian 语言，但我只是使用 C，并且忍受后果，仅仅是因为工具链更好。

过去有过示例（Pascals，甚至是紧密编译的 Basics），但 C 语言主要是规范。我一直不明白为什么。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-05-09T15:34:00.440

我在一个设备上工作，该设备运行了一些非常旧的 python 版本（1.4 或其他版本）。没有办法调试它（除了打印调试消息），所以当你的代码遇到异常时，一切都会停止，你挠头一个小时。每当您对正在运行的代码进行更改和升级时，都需要大约 10 分钟来解释和编译它。

不用说，我们放弃了它并用运行 C 的微控制器替换了微控制器。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-05-12T22:16:15.323

请参阅此相关问题：

[什么语言用于实时系统编程](https://stackoverflow.com/questions/697916/what-languages-are-used-for-real-time-systems-programming)。

在回答您的“为什么”问题时，从政府/军方采购的角度来看，有一种看法认为 Java（语言、平台等）是当今的通用语言，并且该语言的规模经济将减少购置和维护成本。还有一个希望是，与要求他们学习一门新语言相比，可以有效地训练一个称职的 Java 程序员成为一个合理的 RT/嵌入式 Java 程序员。在我看来，这个理由是可疑的，但它确实回答了“为什么”的问题。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-07-31T20:48:08.647

如果您将 iPhone 作为嵌入式平台包括在内，那么 Objective-C

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-07-31T21:03:05.760

考虑到我有多少次在我的手机上遇到 Java 内存不足异常（大多数时候我会做一些非常有趣的事情），我会像蝙蝠一样逃离 Java。

我听说 Erlang 是为手机设计的。我认为 Lisp 是一个很好的远程设备支持架构——如果设备可以处理运行时。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2010-06-15T19:45:40.610

许多需要廉价解决方案的自制用户和小公司发现 Tiny Tiger 和 Basic STAMP（使用 BASIC）可以满足他们的需求。

# java - 防止 jdbc 在 sql 插入和更新时填充字符串

> ID：596937
> 
> 赞同：1
> 
> 时间：2009-02-27T22:35:06.870
> 
> 标签：java, jdbc, odbc

我们正在使用 jdbc-odbc 网桥连接到 MS SQL 数据库。执行插入或更新时，将字符串放入数据库中，填充到数据库字段的长度。有什么办法可以关闭这种行为（字符串应该在没有填充的情况下进入表格）？

作为参考，我们可以使用 SQL 管理工具和查询分析器插入不包含填充的字段值，所以我很确定这发生在 jdbc 或 odbc 层。

编辑：数据库中的字段被列为 nvarchar(X)，其中 X = 50、255，无论

编辑 2： 执行插入的调用使用准备好的语句，就像：

```
PreparedStatement stmt = new con.prepareStatement("INSERT INTO....");
stmt.setString(1, "somevalue"); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T22:41:07.107

你是如何设置字符串的？你在做什么？：

```
PreparedStatement stmt = new con.prepareStatement("INSERT INTO....");
stmt.setString(1, "somevalue"); 
```

如果是这样，试试这个：

```
stmt.setObject(1, "somevalue", Types.VARCHAR); 
```

同样，这只是猜测，没有看到你是如何插入的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T22:47:30.553

您是在数据库中使用 CHAR 字段还是 VARCHAR？

CHAR 填充字段的大小。VARCHAR 没有。

我不认为 JDBC 会导致这种情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-28T04:29:32.930

如果您可以使您的插入与常规 SQL 工具一起使用（例如......我不知道 Toad for MS SQL Sever 或其他东西），那么应该更改驱动程序。

使用 Microsoft SQL Server JDBC 类型 IV 驱动程序。

试试这个链接

[http://www.microsoft.com/downloads/details.aspx?familyid=F914793A-6FB4-475F-9537-B8FCB776BEFD&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=F914793A-6FB4-475F-9537-B8FCB776BEFD&displaylang=en)

不幸的是，这类下载带有很多垃圾。有一个安装工具和另外数百个文件。只需寻找类似的东西：

intalldir\lib\someSingle.jar

复制到其他地方并卸载/删除其余部分。

几个月前我这样做了，不幸的是我不记得它到底在哪里。

**编辑**

好，我知道了。

点击下载，在页面最后点击“我同意并希望下载 UNIX 版本”

这是一个常规压缩文件（使用 win rar 或其他），并在那里寻找那个单一的 jar。

那应该行得通。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T23:00:36.013

如果您使用捆绑的 Sun JDBC-ODBC Bridge 驱动程序，您可能需要考虑迁移到适当的 MS SQL JDBC 驱动程序。Sun 不建议在生产环境中使用网桥驱动程序。

> JDBC-ODBC 桥驱动程序仅推荐用于实验性使用或没有其他替代方案可用时。

转向更有针对性的驱动程序可能会一起解决您的问题，或者至少在您修复错误时它会提供一个生产就绪的解决方案。

# java - 监视 InputStream 的最佳方法是什么？

> ID：596940
> 
> 赞同：1
> 
> 时间：2009-02-27T22:37:07.973
> 
> 标签：java, io, inputstream

我正在通过 apache.commons.FtpClient 读取文件。

这在 99.9% 的情况下都可以正常工作，但有时它会在 read() 方法中死掉......

```
InputStream inStream = ftp.retrieveFileStream(path + file.getName());
String fileAsString = "";

if(inStream == null){
    return;
}
while((c = inStream.read()) != -1){ //this is where the code sometimes just hangs               
   fileAsString += Character.valueOf((char)c);

} 
```

我的问题是什么是防止这种无限期锁定系统的最可靠方法。我应该在单独的线程中设置计时器吗？或者有更简单的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-28T07:22:12.970

如果您的代码挂起，则意味着您的 FTP 服务器尚未发送整个文件。您可以使用计时器，但我相信 FtpClient 允许您设置超时。

顺便说一句：您读取文件的方式*非常*低效。如果您的文件大于几 K，它将使用越来越多的 CPU。

您正在从一个字节（这本身就是一个坏主意）创建一个字符，并为文件中的每个字节创建一个字符串对象。

我建议使用提供的复制方法或 commons-io 库附带的方法将数据复制到 ByteArrayInputStream。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T22:42:44.997

只需快速浏览一下文档，如果您这样做了...

```
while (inStream.available() > 0 && (c = inStream.read()) != -1) 
```

似乎它会在您实际阅读之前仔细检查您是否可以阅读而不会阻塞。不过我不确定。

# math - 分区中可能的组合数

> ID：596942
> 
> 赞同：2
> 
> 时间：2009-02-27T22:37:34.993
> 
> 标签：math, combinatorics, linear-programming

给定一个大小为 n 的集合 S，它被划分为大小为 n1,..,nk 的类 (s1,..,sk)。自然地，它认为 n = n1+...+nk。

我有兴趣找出可以组合此分区元素的方法的数量，以便每个组合恰好包含每个类的一个元素。

因为我可以从 s1 中选择 n1 个元素，从 s2 中选择 n2 个元素，依此类推，所以我正在为任意 n1,..nk 寻找 max(n1*..*nk) 的解决方案，它持有 n1+..+nk =n。

我感觉这是一个线性优化问题，但是自从我作为本科生学习这些东西以来已经太久了。我希望有人记得如何计算这个。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T22:40:50.460

您正在寻找每个分区中包含一个元素的组合数量？

这只是 n1*n2*...*nk。

编辑：您似乎还问了一个单独的问题：

给定 N，我如何分配 n1, n2, ..., nk 以使它们的乘积最大化。这实际上不是线性优化问题，因为您的变量是相乘的。

它可以通过一些微积分来解决，即通过使用拉格朗日乘数对每个变量进行偏导数，并带有约束。

结果将是 n1 .. nk 应该尽可能接近相同的大小。

```
if n is a multiple of k, then n_1 = n_2 = ... = n_k = n/k

otherwise, n_1 = n_2 = ... = n_j = Ceiling[n/k]
      and  n_j+1 = ... = n_k = floor[n/k] 
```

基本上，我们尝试将元素尽可能均匀地分配到分区中。如果他们平均分配，那就太好了。如果不是，我们尽可能均匀地划分，剩下的部分，我们给第一个分区每个额外的元素。（不必是第一个分区，这个选择相当随意。）这样，任何两个分区拥有的元素数量的差异最多为一个。

**血腥细节**：

这是我们希望最大化的乘积函数：

P = n1*n2*...nK

我们使用拉格朗日乘数定义一个新函数：

Lambda = P + l(N - n1 - n2 ... -nk)

并在每个 k n_i 变量中取偏导数：

dLambda/dn_i = P/n_i - l

在 l 中：

dLambda/dl = N - n1 -n2 ... -nk

设置所有偏导数 = 0，我们得到一个由 k + 1 个方程组成的系统，当我们求解它们时，我们将得到 n1 = n2 = ... = nk

一些有用的链接：

[拉格朗日乘数](http://en.wikipedia.org/wiki/Lagrange_multipliers)

[优化](http://en.wikipedia.org/wiki/Constrained_optimization_and_Lagrange_multipliers)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T23:04:51.993

```
floor(n/k)^(k - n mod k)*ceil(n/k)^(n mod k) 
```

——马库斯

PS 对于您给出的 S = {1,2,3,4}, n = 4, k = 2 的示例，这给出：

```
floor(4/2)^(2 - 4 mod 2)*ceil(4/2)^(4 mod 2)
floor(2)^(2 - 0)*ceil(2)^(0)
2^2 * 2^0
4 * 1
4 
```

……如你所愿。

为了澄清，这个公式给出了分区产生的排列数，其中排列的最大可能数。当然会有其他不太理想的分区。

对于给定的周长，面积最大的矩形是最接近正方形的矩形（在更高维度上也是如此），这意味着您希望边的长度尽可能接近相等（例如，所有平均长度向上或向下四舍五入）。那么公式可以看成是：

```
 (length of short sides)^(number of short sides)
times
   (length of long sides)^(number of long sides) 
```

这只是满足此约束的超矩形的体积。

请注意，以这种方式查看时，它还告诉您如何构造最大分区。

# hyperlink - 如何在您的网站上提供免费铃声？

> ID：596954
> 
> 赞同：2
> 
> 时间：2009-02-27T22:40:09.697
> 
> 标签：hyperlink, mobile-phones

我被要求提供在网站上提供免费铃声下载的选项。这些将是*实际*的免费铃声下载，而不是“当然，我们有免费的铃声，但您不想在这里以 1.99 美元的价格获得这些更酷的铃声吗？”，而是真正的免费下载铃声。有没有办法以相对全球化的方式提供这一点？是不是像提供一个低质量的 30 秒 MP3 让用户自己转换一样简单？是否有提供此功能的服务？我们正在寻找选择。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T22:56:47.223

根据您使用的运营商/电话，有不同的开始下载方法

*   Sprint - GCD（通用内容描述符）
*   Verizon 您必须发送彩信
*   ATT - 取决于手机
*   诺基亚手机需要 DD（下载描述符）
*   名单还在继续

不是一个真正要解决的简单问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T22:45:55.550

铃声因手机而异；例如，有些需要 MIDI 铃声，但对于大多数现代手机来说，直接下载一个简短的 mp3 文件就足够了

# java - 如何通过 CSS 突出显示 Java 代码？

> ID：596958
> 
> 赞同：5
> 
> 时间：2009-02-27T22:40:31.880
> 
> 标签：java, css, highlight

我看到了一些很酷的代码突出显示，看起来像 Eclipse 中的代码，但是我找不到它。:( 你知道任何很酷的 java 代码高亮 css 吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-28T05:50:30.880

我想你想要[代码美化](http://code.google.com/p/google-code-prettify/)

支持一堆不同的语言（包括Java）。这是[文档/示例](http://google-code-prettify.googlecode.com/svn/trunk/README.html)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-27T23:48:57.613

你可能想看看[SyntaxHighlighter](http://alexgorbatchev.com/wiki/SyntaxHighlighter)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T23:33:19.023

[GeSHi](http://qbnz.com/highlighter/)我用过一次，没问题，但不是我试过其他的比较过。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-01-14T16:27:42.633

我将[code2html](http://www.palfrader.org/code2html/)用于我自己的网站。但是，由于“官方”版本不支持 CSS，所以我使用自己的版本。这个打了补丁的支持 CSS 的版本可以[在我的网站上](http://www.field-theory.org/software/index.html#code2html)下载。

# c++ - 帮助我使这段代码异常安全

> ID：596964
> 
> 赞同：1
> 
> 时间：2009-02-27T22:41:18.243
> 
> 标签：c++, exception, smart-pointers, container-managed

所以我有这个库代码，看...

```
class Thing
{
public:

    class Obj 
    {
     public:
        static const int len = 16;

        explicit Obj(char *str)
        {
            strncpy(str_, str, len);
        }

        virtual void operator()() = 0;

    private:
        char str_[len];
    };

    explicit Thing(vector<Obj*> &objs) : objs_(objs) {}

    ~Thing() {
        for(vector<Obj*>::iterator i = objs_.begin(); i != objs_.end(); ++i) {
            delete *i;
        }
    }

private:
    vector<Obj*> objs_;
} 
```

在我的客户代码中......

```
 class FooObj : public Thing::Obj
    {
        virtual void operator()() {
            //do stuff
        }
    }

    class BarObj : public Thing::Obj
    {
        virtual void operator()() {
            //do different stuff
        }
    }

vector<Objs*> objs;
int nStructs = system_call(*structs);
for(int i = 0; i < nStructs; i++) {
    objs.push_back(newFooObj(structs[i].str));
}
objs.push_back(newBarObj("bar1");
objs.push_back(newBarObj("bar2");

Thing thing(objs);
// thing does stuff, including call Obj::()() on the elements of the objs_ vector 
```

我坚持的是异常安全。就目前而言，如果任何 Obj 构造函数抛出，或者 Thing 构造函数抛出，已经在向量中的 Objs 将会泄漏。向量需要包含指向 Objs 的指针，因为它们被多态地使用。而且，我需要在这里处理任何异常，因为这是从不知道异常的旧代码库中调用的。

在我看来，我的选择是：

1.  将客户端代码包装在一个巨大的 try 块中，并清理 catch 块中的向量。
2.  在所有分配周围放置 try 块，其中的 catch 块调用公共清理函数。
3.  一些我还没有想到的基于 RAII 的聪明想法。
4.  平底船。实际上，如果构造函数抛出异常，应用程序无论如何都会陷入火海，但我想更优雅地处理这个问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T22:54:19.960

看一眼[`boost::ptr_vector`](http://www.boost.org/doc/libs/1_38_0/libs/ptr_container/doc/ptr_container.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-27T22:51:38.673

答案 3 - 在向量中使用智能指针而不是 Obj*。我建议[boost::shared_ptr](http://www.boost.org/doc/libs/1_38_0/libs/smart_ptr/shared_ptr.htm)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-27T22:52:40.510

由于您的 Thing 析构函数已经知道如何清理向量，因此您大部分时间都在使用[RAII](http://en.wikipedia.org/wiki/Resource_acquisition_is_initialization)解决方案。除了创建 Objs 的向量，然后将其传递给 Thing 的构造函数之外，您还可以使用空向量初始化 Thing，并添加一个成员函数以通过指针向向量添加新的 Objs。

这样，如果 Obj 的构造函数抛出异常，编译器将自动调用 Thing 的析构函数，正确销毁任何已分配的 Obj。

Thing 的构造函数变为空操作：

```
explicit Thing() {} 
```

添加`push_back`成员：

```
void push_back(Obj *new_obj) { objs_.push_back(new_obj); } 
```

然后您的客户端中的分配代码变为：

```
Thing thing(objs);
int nStructs = system_call(*structs);
for(int i = 0; i < nStructs; i++) {
    thing.push_back(newFooObj(structs[i].str));
}
thing.push_back(newBarObj("bar1");
thing.push_back(newBarObj("bar2"); 
```

正如另一位海报所建议的那样，向量内的智能指针类型也可以很好地工作。只是不要使用 STL 的`auto_ptr`；它不遵循正常的复制语义，因此不适合在 STL 容器中使用。Boost 和即将推出的`shared_ptr`C++0x 提供的就可以了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-27T22:54:11.413

Obj 的向量在性能方面可能非常差，因为向量可能必须在调整大小时移动对象并且必须将它们全部复制。指向对象的指针更好。

我用过[Pointainers](http://ootips.org/yonat/4dev/pointainer.h)，它可以满足你的需要。这是原始代码。

```
/*
 * pointainer - auto-cleaning container of pointers
 *
 * Example usage:
 * {
 *     pointainer< std::vector<int*> > v;
 *     // v can be manipulated like any std::vector<int*>.
 *
 *     v.push_back(new int(42));
 *     v.push_back(new int(17));
 *     // v now owns the allocated int-s
 *
 *     v.erase(v.begin());
 *     // frees the memory allocated for the int 42, and then removes the
 *     // first element of v.
 * }
 * // v's destructor is called, and it frees the memory allocated for
 * // the int 17.
 *
 * Notes:
 * 1\. Assumes all elements are unique (you don't have two elements
 *    pointing to the same object, otherwise you might delete it twice).
 * 2\. Not usable with pair associative containers (map and multimap).
 * 3\. For ANSI-challenged compilers, you may want to #define
 *    NO_MEMBER_TEMPLATES.
 *
 * Written 10-Jan-1999 by Yonat Sharon <yonat@@ootips.org>
 * Last updated 07-Feb-1999
 *
 * Modified June 9, 2003 by Steve Fossen
 *  -- to fix g++ compiling problem with base class typenames
 */

#ifndef POINTAINER_H
#define POINTAINER_H

#ifdef NO_MEMBER_TEMPLATES
    #include <functional> // for binder2nd
#endif

template <typename Cnt>
class pointainer : public Cnt
{
public:
    // sf - change to fix g++ compiletime errors
#ifdef USE_USING_NOT_TYPEDEF
    // I get compile errors with this
    using typename Cnt::size_type;
    using typename Cnt::difference_type;
    using typename Cnt::reference;
    using typename Cnt::const_reference;
    using typename Cnt::value_type;
    using typename Cnt::iterator;
    using typename Cnt::const_iterator;
    using typename Cnt::reverse_iterator;
    using typename Cnt::const_reverse_iterator;
#else
    // this way works
    typedef typename Cnt::size_type                 size_type;
    typedef typename Cnt::difference_type           difference_type;
    typedef typename Cnt::reference                 reference;
    typedef typename Cnt::const_reference           const_reference;
    typedef typename Cnt::value_type                value_type;
    typedef typename Cnt::iterator                  iterator;
    typedef typename Cnt::const_iterator            const_iterator;
    typedef typename Cnt::reverse_iterator          reverse_iterator;
    typedef typename Cnt::const_reverse_iterator    const_reverse_iterator;
#endif

    typedef pointainer< Cnt > its_type;

    pointainer()                            {}
    pointainer( const Cnt &c )   : Cnt( c ) {}

    its_type &operator=( const Cnt &c )      { Cnt::operator=( c ); return *this;        }
    ~pointainer()                            { clean_all();                              }

    void clear()                             { clean_all();   Cnt::clear();              }
    iterator erase( iterator i )             { clean( i );    return Cnt::erase( i );    }
    iterator erase( iterator f, iterator l ) { clean( f, l ); return Cnt::erase( f, l ); }

    // for associative containers: erase() a value
    size_type erase( const value_type& v )
    {
        iterator i = find( v );
        size_type found( i != end() ); // can't have more than 1
        if( found )
            erase( i );
        return found;
    }

    // for sequence containers: pop_front(), pop_back(), resize() and assign()
    void pop_front()    { clean( begin() ); Cnt::pop_front();                 }
    void pop_back()     { iterator i( end() ); clean( --i ); Cnt::pop_back(); }

    void resize( size_type s, value_type c = value_type() )
    {
        if( s < size() )
            clean( begin() + s, end() );
        Cnt::resize( s, c );
    }

#ifndef NO_MEMBER_TEMPLATES
    template <class InIter> void assign(InIter f, InIter l)
#else
    void assign( iterator f, iterator l )
#endif
    {
        clean_all();
        Cnt::assign( f, l );
    }

#ifndef NO_MEMBER_TEMPLATES
    template <class Size, class T> void assign( Size n, const T& t = T() )
#else
    void assign( size_t n, const value_type& t = value_type() )
#endif
    {
        clean_all();
        Cnt::assign( n, t );
    }

    // for std::list: remove() and remove_if()
    void remove( const value_type& v )
    {
        clean( std::find( begin(), end(), v ));
        Cnt::remove( v );
    }

#ifndef NO_MEMBER_TEMPLATES
    template <class Pred>
#else
    typedef std::binder2nd< std::not_equal_to< value_type > > Pred;
#endif
    void remove_if(Pred pr)
    {
        for( iterator i = begin(); i != end(); ++i )
            if( pr( *i ))
                clean( i );

        Cnt::remove_if( pr );
    }

private:
    void clean( iterator i )                { delete *i; *i = 0;            } // sf add *i = NULL so double deletes don't fail
    void clean( iterator f, iterator l )    { while( f != l ) clean( f++ ); }
    void clean_all()                        { clean( begin(), end() );      }

    // we can't have two pointainers own the same objects:
    pointainer( const its_type& ) {}
    its_type& operator=( const its_type& ) { return  NULL;} // sf - return null to remove no return value warning..
};

#endif // POINTAINER_H 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T22:50:04.463

您总是可以使用 Obj 的向量来代替指向 Obj 的指针向量。在这种情况下，您需要确保可以安全地复制 Obj（当它包含指针时很危险）。由于您的 Obj 仅包含一个固定大小的 char 数组，因此它应该是安全的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-27T23:22:23.527

在不将 objs 中存储的类型更改为可以复制和管理 Obj* 本身的类型的情况下，如果抛出异常，您需要添加一个 try/catch 块来清理 objs。最简单的方法是这样做：

```
vector<Obj *> objs;

try {...}
catch (...) 
{
    // delete all objs here
    throw;
} 
```

尽管如果没有抛出异常，您无论如何都需要清理 objs。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-28T04:03:19.377

嗯。我真的很喜欢 Commodore Jaeger 的想法；它巧妙地清除了这段代码给我的一些有趣的气味。我现在不愿意引入 Boost 库。这是一个有点保守的代码库，我宁愿把它带入 21 世纪的蠕动和抱怨，而不是踢和尖叫。

# vb6 - 在 VB6 中使用按钮标题作为变量有什么不好？

> ID：596968
> 
> 赞同：5
> 
> 时间：2009-02-27T22:43:08.287
> 
> 标签：vb6

我收到了一些关于我的最后一个问题（[如何在用户取消时从嵌套子例程中间优雅地退出？](https://stackoverflow.com/questions/587218/how-to-gracefully-exit-from-the-middle-of-a-nested-subroutine-when-user-cancels)）的一些合理的批评反馈，用于使用命令按钮的标题作为状态变量。我这样做是因为它很高效，只需很少的代码就可以同时满足两个或三个目的，但我理解它也可能导致问题，尤其是在我最初呈现它时略显草率的方式。

我觉得这值得自己讨论，所以这里同样的想法被清理了一下并修改为“正确”（这基本上意味着在一个地方定义字符串，这样你的代码就不会开始失败，因为你只是改变了命令按钮的文本）。我知道我的变量和控件命名约定很差（好的，不存在），所以提前道歉。但我想继续关注标题作为状态变量的讨论。

所以我们开始：

```
' Global variables for this form
Dim DoTheThingCaption(1) As String
Dim UserCancel, FunctionCompleted As Boolean

Private Sub Form_Initialize()
  ' Define the possible captions (is there a #define equivalent for strings?)
  DoTheThingCaption(0) = "Click to Start Doing the Thing"
  DoTheThingCaption(1) = "Click to Stop Doing the Thing"

  ' Set the caption state when form initializes
  DoTheThing.Caption = DoTheThingCaption(0)
End Sub

Private Sub DoTheThing_Click() ' Command Button

If DoTheThing.Caption = DoTheThingCaption(0) Then
  UserCancel = False ' this is the first time we've entered this sub
Else ' We've re-entered this routine (user clicked on button again
     ' while this routine was already running), so we want to abort
  UserCancel = True ' Set this so we'll see it when we exit this re-entry
  DoTheThing.Enabled = False 'Prevent additional clicks
  Exit Sub
End If

' Indicate that we're now Doing the Thing and how to cancel
DoTheThing.Caption = DoTheThingCaption(1)

For i = 0 To ReallyBigNumber
  Call DoSomethingSomewhatTimeConsuming
  If UserCancel = True Then Exit For ' Exit For Loop if requested
  DoEvents ' Allows program to see GUI events
Next

' We've either finished or been canceled, either way
' we want to change caption back
DoTheThing.Caption = DoTheThingCaption(0)

If UserCancel = True Then GoTo Cleanup

'If we get to here we've finished successfully
FunctionCompleted = True
Exit Sub '******* We exit sub here if we didn't get canceled ******* 

Cleanup:
'We can only get to here if user canceled before function completed

FunctionCompleted = False
UserCancel = False ' clear this so we can reenter later
DoTheThing.Enabled = True 'Prevent additional clicks

End Sub  '******* We exit sub here if we did get canceled ******* 
```

就这样。*这样*做还有什么不好的地方吗？只是风格问题吗？还有什么其他东西可以以更理想或可维护的方式给我这四件事吗？

1.  用户按下按钮导致动作的即时 GUI 反馈
2.  在用户眼睛已经注视的位置上的即时 GUI 反馈，如果不希望采取行动，如何取消
3.  用户启动/取消操作的一键式方式（减少 GUI 上的杂乱程度）
4.  一个简单的即时命令按钮禁用以防止多个关闭请求

我可以看到一个问题可能是代码和 GUI 之间的紧密耦合（以多种方式），所以我可以看到这对于大型项目（或至少是大型 GUI）如何成为一个大问题。这恰好是一个较小的项目，只有 2 或 3 个按钮可以接受这种“处理”。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-27T22:59:00.213

这种技术的最大问题是它使用字符串作为布尔值。根据定义，布尔变量只能有两种状态，而字符串可以有任意数量的状态。

现在，您已经通过依赖预定义字符串数组来定义命令按钮文本的允许值，从而在一定程度上减轻了其中固有的危险。这留下了一些较小的问题：

*   关于当前和可用状态的逻辑不太明确（表单实际上有四种可能的状态：未启动、已启动、已完成、已启动但正在取消） - 维护需要仔细观察按钮文本之间的潜在交互和布尔变量 states 来确定当前状态是/应该是什么。单个枚举将使这些状态显式化，使代码更易于阅读和理解，从而简化维护。
*   您依赖控件属性（按钮文本）的行为来与公开的属性值类型（字符串）保持一致。这种假设使得将旧的 VB6 代码迁移到新的语言/平台*绝对是地狱*。
*   字符串比较比布尔变量的简单测试要慢得多。在这种情况下，这无关紧要。一般来说，避免它同样容易。
*   您正在使用 DoEvents 来模拟多线程（与问题没有直接关系......但是，呃）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-27T23:00:24.720

在处理像这样的（非常旧的）代码[按钮标题作为变量]时，我遇到的最大问题是全球化是一场噩梦......我不得不移动一个旧的 vb6 应用程序来使用英语和德语......需要数周，甚至数月。

您也在使用 goto ......可能需要进行一些重构以使代码可读？

**根据评论进行编辑，我只会在每个 proc 顶部的 vb6 中使用 goto；出错时转到 myErrorHandler。

然后在 proc 的最底部，我会有一个将错误传递给全局处理程序的衬里，以记录错误。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-28T15:36:17.617

忽略一般架构/耦合问题，因为您知道这些问题，您的方法的一个问题是因为 VB6 控件在您设置属性时会做一些神奇的事情。您可能认为您只是在设置一个属性，但在许多情况下您也会触发事件。将复选框值设置为 true 会触发 click 事件。在选项卡控件上设置 tabindex 会导致单击事件。有很多情况。

如果我没记错的话，我还认为在某些情况下，如果您设置一个属性，然后立即阅读它，您将看不到更新。我相信在您看到新值之前必须进行屏幕刷新。

我见过太多可怕的 VB6 代码，它们使用控件属性作为存储。如果您发现这种代码，您会认出它，因为它散布着对 Refresh 方法、DoEvents 的冗余调用，并且您会经常看到 UI 挂起。这通常是由无限循环引起的，其中设置了一个属性，触发了一个事件，然后设置了另一个属性，最终有人编写了一行代码再次更新第一个属性。

如果这些问题还不够吓到你，那么想想这个。我们中的一些人就是没有那么聪明。我已经在 VB6 中编码超过 10 年，并且亲自编写了大约 750K LOC 并且我一直盯着上面的示例，我发现很难理解它发生了什么。假设将来所有需要阅读您的代码的人都将非常愚蠢，并通过编写看起来非常简单的代码让我们感到高兴。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-27T23:34:43.110

我认为最好将字幕文本与处理状态分离。goto也使它难以阅读。这是我的重构版本...

```
Private Const Caption_Start As String = "Click to Start Doing the Thing"
Private Const Caption_Stop As String = "Click to Stop Doing the Thing"

Private Enum eStates
  State_Initialized
  State_Running
  State_Canceled
  State_Completed
End Enum

Private Current_State As eStates

Private Sub Form_Initialize()

  DoTheThing.Caption = Caption_Start
  Current_State = State_Initialized

End Sub

Private Sub DoTheThing_Click()

  If Current_State = State_Running Then

    'currently running - so set state to canceled, reset caption'
    'and disable button until loop can respond to the cancel'
    Current_State = State_Canceled
    DoTheThing.Caption = Caption_Start
    DoTheThing.Enabled = False

  Else

    'not running - so set state and caption'
    Current_State = State_Running
    DoTheThing.Caption = Caption_Stop

    'do the work'
    For i = 0 To ReallyBigNumber
      Call DoSomethingSomewhatTimeConsuming

      'at intervals check the state for cancel'
      If Current_State = State_Canceled Then
        're-enable button and bail out of the loop'
        DoTheThing.Enabled = True
        Exit For
      End If

      DoEvents

    Next

    'did we make it to the end without being canceled?'
    If Current_State <> State_Canceled Then
      Current_State = State_Completed
      DoTheThing.Caption = Caption_Start
    End If

  End If

End Sub 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-28T00:05:17.857

除了像 DJ 在[他的回答](https://stackoverflow.com/questions/596968/whats-so-bad-about-using-button-captions-as-variables-in-vb6/597094#597094)中所做的那样删除 GTos 之外，您的方法并没有真正的错误。按钮标题只能有两种状态，您可以使用这两种状态来定义代码中的流程。

然而，我有两个理由让我采取不同的做法：

1.  当您想将程序翻译成另一种语言时，您的方法会产生问题（根据我的经验，您应该*始终*为此做好计划），因为字幕会以另一种语言更改
2.  它违背了用户界面与程序流分离的原则。这对你来说可能不是一件重要的事情，但是当程序变得更大更复杂时，将 UI 与逻辑明确分离会使事情变得更容易。

总而言之，对于手头的情况，您的解决方案肯定有效，而且没有理由不应该这样做。但另一方面经验告诉我们，对于更复杂的程序，这种方式可能会导致问题，您可以通过使用稍微不同的方法轻松避免这些问题。

此外，我认为可以肯定地假设每个批评你的例子的人都这样做是因为他们在某个时候做了一个相似的选择，后来意识到这是一个错误。

我知道我做到了。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-28T00:22:59.263

这会将您的底层算法与您的 UI 中的特定行为联系起来。现在，如果您想更改其中任何一个，则必须同时更改两者。随着您的应用程序规模不断扩大，如果您不通过封装逻辑将更改保持在本地，那么维护将成为一场噩梦。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-28T00:48:28.673

如果有人出于任何原因需要处理您的代码，他们将找不到他们熟悉和熟悉的实践和约定，因此功能的边界将不存在。换句话说，您在耦合/内聚路径上的方向是错误的。在功能上将状态管理与 UI 集成是这个问题的典型代表。

你完全了解 OOP 吗？（不是批评，而是一个合理的问题。如果你这样做了，这对你来说会更清楚。即使它只是 VB6 OOP。）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-02-26T18:18:39.603

本地化对 OP 呈现的逻辑类型影响最大。正如一些人提到的那样 - 如果您需要将应用程序翻译成中文怎么办？还有德语？还有俄语？

您还必须添加涵盖这些语言的其他常量……纯属地狱。GUI 数据应该保持原样，一个 GUI 数据。

OP 在这里描述的方法让我想起了亨利福特所说的：“任何客户都可以让汽车涂上他想要的任何颜色，只要它是黑色的”。

# css - CSS：模拟灵活宽度（没有最小宽度）-

> ID：596970
> 
> 赞同：5
> 
> 时间：2009-02-27T22:44:19.860
> 
> 标签：css

我有一个 100% 宽度的 DIV 容器，里面有 x 个 div。最后一个子 DIV 向右浮动，其余的向左浮动。只要它们适合条形图，所有子 DIV 都会保持在一条线上（所有子 DIV 都向左，除了最后一个单独位于右侧的 div）。如果窗口被调整得更小并且孩子们没有足够的空间，他们会从水平方向折叠（我不想要）。为了解决这个问题，我知道我可以设置 DIV 容器的最小宽度，问题是容器中的 DIV 数量可变，宽度可变。我想模拟能够设置容器的 min-width where min-width = 所有子项的宽度，但我无法计算这些，因为它们是可变的（这将模拟右 div 和其余部分之间的灵活空间,

我知道这有点不清楚，所以这是一张图片：![http://img3.imageshack.us/img3/933/barfuo.jpg](https://i.stack.imgur.com/sCVxE.jpg)

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-27T22:57:59.030

我不想这么说（或者更确切地说，反桌人群会讨厌它）但你知道这很容易吗？

没错：桌子。

```
<style type="text/css">
#topbar { width: 100%; }
#topbar div { white-space: nowrap; overflow: hidden; }
#topright div { text-align: right; }
</style>
<table id="topbar">
<tr>
  <td><div>Item 1</div></td>
  <td><div>Item 2</div></td>
  <td><div>Item 3</div></td>
  <td><div>Item 4</div></td>
  <td><div>Item 1</div></td>
  <td id="topright"><div>Item Right</div></td>
</tr>
</table> 
```

内部 div 很重要，因为溢出隐藏仅适用于块元素，表格单元格不是块元素（它们是“表格单元格”显示类型）。

# r - Y函数是什么？

> ID：596976
> 
> 赞同：1
> 
> 时间：2009-02-27T22:45:59.247
> 
> 标签：r

我的一个朋友问我是否理解这个`Y`功能。我什至不知道那是什么。`? Y`没有让我到任何地方。

它是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T22:56:38.800

最常见的应用：它使匿名函数能够递归调用自身。

可以在[Mike Vanier 的 livejournal 页面上找到一个很好的解释](http://mvanier.livejournal.com/2897.html)

# php - 没有在浏览器中输入 www 前缀时，网站页面变窄

> ID：596978
> 
> 赞同：0
> 
> 时间：2009-02-27T22:46:38.060
> 
> 标签：php, firefox, rendering

这是我见过的最奇怪的事情之一。在 Firefox 3 for PC 中，我们正在开发的网站的页面变得狭窄，这使得布局变得完全疯狂。

如果您输入[http://www.wms-clients.com/vcb](http://www.wms-clients.com/vcb)，索引页面看起来不错。

如果你输入[http://wms-clients.com/vcb](http://wms-clients.com/vcb)，一切都会被压扁。

任何拥有 FF3 for PC 的人都可以告诉我他们是否看到相同的东西，如果是，我该如何解决这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-27T22:55:23.420

你一直在搞乱文本缩放吗？我相信缩放设置是按域存储的。

尝试重置缩放（查看 -> 缩放 -> 重置）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-27T22:49:47.133

听起来它正在根据 URL 缓存文件。尝试“删除私人数据”，或按 CTRL+F5 看看会发生什么。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-27T22:48:13.283

您是否在将其缓存在服务器上的内部网络上？我们的一直这样做。

他们看起来和我一模一样。你在玩 Firebug 吗？它可能会将您的更改存储到 CSS。我在使用 WinXP 的 FF 3.0.6

# c# - 按钮 BackgroundImage 属性

> ID：596990
> 
> 赞同：0
> 
> 时间：2009-02-27T22:53:16.280
> 
> 标签：c#, .net-3.5, windows-mobile, button

我正在尝试在 Windows Mobile 上编写应用程序，但遇到了问题。

我想在按钮上画一张箭头图，但我不知道该怎么做。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T23:01:28.603

您需要绘制一个自定义控件。有关示例，请参见此[链接。](http://msdn.microsoft.com/en-us/library/ms229655.aspx)您可以使用 Graphics.DrawImage 函数绘制图标。

# c# - C# 多线程设计示例

> ID：596991
> 
> 赞同：2
> 
> 时间：2009-02-27T22:53:20.227
> 
> 标签：c#, multithreading, design-patterns

我对 C#/.Net 比较陌生。我正在开发一个需要多线程的桌面应用程序。我想出了下面的模式作为基础。我想知道是否有人可以指出如何在编码、线程安全和高效方面做得更好。

希望这有点道理。

* * *

```
public abstract class ThreadManagerBase
{
    // static class variables

    private static ThreadManagerBase instance = null;
    private static BackgroundWorker thread = null;
    private static ProgressBarUIForm progress = null;

    /// <summary>
    /// Create a new instance of this class. The internals are left to the derived class to figure out.
    /// Only one instance of this can run at any time. There should only be the main thread and this thread.
    /// </summary>
    public abstract static ThreadManagerBase NewInstance();

    /// <summary>
    /// Clears the instance.
    /// </summary>
    public static void ClearInstance()
    {
        instance = null;
    }

    /// <summary>
    /// Initializes the background worker with some presets.
    /// Displays progress bar.
    /// </summary>
    private abstract static void InitializeThread()
    {
        thread = new BackgroundWorker();

        thread.WorkerReportsProgress = true;
        thread.WorkerSupportsCancellation = true;

        thread.DoWork += new DoWorkEventHandler(thread_DoWork);
        thread.RunWorkerCompleted += new RunWorkerCompletedEventHandler(thread_RunWorkerCompleted);
        thread.ProgressChanged += new ProgressChangedEventHandler(thread_ProgressChanged);

        thread.RunWorkerAsync();

        progress = new ProgressBarUIForm();

        progress.EnableCancelButton = true;

        progress.UserCanceled += new EventHandlerCancelClicked(progress_UserCanceled);

        progress.ShowDialog();

        thread.Dispose();

        thread = null;
    }

    private static void progress_UserCanceled(bool userCanceled)
    {
        thread.CancelAsync();
    }

    private static void thread_ProgressChanged(object sender, ProgressChangedEventArgs e)
    {
        progress.SetProgressLevel = e.ProgressPercentage;
        progress.SetProgressMessage = e.UserState.ToString();
    }

    private static void thread_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
    {
        progress.Close();

        progress = null;
    }

    private static void thread_DoWork(object sender, DoWorkEventArgs e)
    {
        ProcessWork();
    }

    private abstract static void ProcessWork()
    {
        // do actuall stuff here.
        // the derived classes will take care of the plumbing.
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T00:15:21.557

您是否查看过[Microsoft Parallel Extensions to .NET Framework 3.5](http://www.microsoft.com/downloads/details.aspx?FamilyId=348F73FD-593D-4B3C-B055-694C50D2B0F3&displaylang=en)？这是一个非常好的库，它可以从线程中提取大量工作。

MSDN 上也有很多关于线程模式的文章，你也应该研究一下。线程可以很快变得非常复杂。很高兴有其他人来处理所有可能出错的重要内容，并将其简化为库或模式。当然，如果您不了解任何特定解决方案的陷阱，那也有危险。因此，请确保您研究好您选择的任何解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T23:12:31.447

我认为没有充分的理由在 BackgroundWorker 上创建这种抽象。如果你坚持，只是一个警告：我不确定它是否在以后的版本中发生了变化，但在 NET 2.0 中，不可能真正取消 DoWork 处理程序（除非它在被要求停止时偶尔检查一次）。阅读[此处](http://weblogs.asp.net/rosherove/pages/BackgroundWorkerEx.aspx)获取解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-05T14:48:26.697

我做过类似的事情。如果您确实有多个要执行的任务，但您不希望在整个项目中复制 BackgroundWorker 代码，这是有充分理由的。我没有将进度条绑定到实际的基类，我只是在主窗体中拥有它。这是我想出的解决方案：

以下是基类：

```
 public abstract class Operation
   {
      #region public Event Handlers

      /// 
      /// The event that updates the progress of the operation
      /// 
      public event OperationProgressChangedEventHandler OperationProgressChanged;

      /// 
      /// The event that notifies that the operation is complete (and results)
      /// 
      public event OperationCompletedEventHandler OperationCompleted;

      #endregion

      #region Members

      // Whether or not we can cancel the operation
      private bool mWorkerSupportsCancellation = false;
      // The task worker that handles running the operation
      private BackgroundWorker mOperationWorker;
      // The operation parameters
      private object[] mOperationParameters;

      #endregion

      /// 
      /// Base class for all operations
      /// 
      public Operation(params object[] workerParameters)
      {
         mOperationParameters = workerParameters;
         // Setup the worker
         SetupOperationWorker();
      }

      #region Setup Functions

      /// 
      /// Setup the background worker to run our Operations
      /// 
      private void SetupOperationWorker()
      {
         mOperationWorker = new BackgroundWorker();
         mOperationWorker.WorkerSupportsCancellation = mWorkerSupportsCancellation;
         mOperationWorker.WorkerReportsProgress = true;
         mOperationWorker.WorkerSupportsCancellation = true;
         mOperationWorker.DoWork += new DoWorkEventHandler(OperationWorkerDoWork);
         mOperationWorker.ProgressChanged += new ProgressChangedEventHandler(OperationWorkerProgressChanged);
         mOperationWorker.RunWorkerCompleted += new RunWorkerCompletedEventHandler(OperationWorkerRunWorkerCompleted);
      }

      #endregion

      #region Properties

      /// 
      /// Whether or not to allow the user to cancel the operation
      /// 
      public bool CanCancel
      {
         set
         {
            mWorkerSupportsCancellation = value;
         }
      }

      #endregion

      #region Operation Start/Stop Details

      /// 
      /// Start the operation with the given parameters
      /// 
      /// The parameters for the worker
      public void StartOperation()
      {
         // Run the worker
         mOperationWorker.RunWorkerAsync(mOperationParameters);
      }

      /// 
      /// Stop the operation
      /// 
      public void StopOperation()
      {
         // Signal the cancel first, then call cancel to stop the test
         if (IsRunning())
         {
            // Sets the backgroundworker CancelPending to true, so we can break
            // in the sub classes operation
            mOperationWorker.CancelAsync();
            // This allows us to trigger an event or "Set" if WaitOne'ing
            Cancel();
            // Wait for it to actually stop before returning
            while (IsRunning())
            {
               Application.DoEvents();
            }
         }
      }

      /// 
      /// Whether or not the operation is currently running
      /// 
      /// 
      public bool IsRunning()
      {
         return mOperationWorker.IsBusy;
      }

      #endregion

      #region BackgroundWorker Events

      /// 
      /// Fires when the operation has completed
      /// 
      /// 
      /// 
      private void OperationWorkerRunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
      {
         // Allow the sub class to clean up anything that might need to be updated
         Clean();

         // Notify whoever is register that the operation is complete
         if (OperationCompleted != null)
         {
            OperationCompleted(e);
         }
      }

      ///  
      /// Fires when the progress needs to be updated for a given test (we might not care)
      /// 
      /// 
      /// 
      private void OperationWorkerProgressChanged(object sender, ProgressChangedEventArgs e)
      {
         // Notify whoever is register of what the current percentage is
         if (OperationProgressChanged != null)
         {
            OperationProgressChanged(e);
         }
      }

      /// 
      /// Fires when we start the operation (this does the work)
      /// 
      /// 
      /// 
      private void OperationWorkerDoWork(object sender, DoWorkEventArgs e)
      {
         // Run the operation
         Run(sender, e);
      }

      #endregion

      #region Abstract methods

      /// 
      /// Abstract, implemented in the sub class to do the work
      /// 
      /// 
      /// 
      protected abstract void Run(object sender, DoWorkEventArgs e);

      /// 
      /// Called at the end of the test to clean up anything (ex: Disconnected events, etc)
      /// 
      protected abstract void Clean();

      /// 
      /// If we are waiting on something in the operation, this will allow us to
      /// stop waiting (ex: WaitOne).
      /// 
      protected abstract void Cancel();

      #endregion
   } 

```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-05T14:50:23.477

以下是我发布的示例的示例测试类：

```
 class TestOperation : Operation
   {
      AutoResetEvent mMsgRec;

      public TestOperation(params object[] workerParameters)
         : base(workerParameters)
      {
         CanCancel = true;
         mMsgRec = new AutoResetEvent(false);
         //mSomeEvent += DoSomething();
      }

      protected override void Cancel()
      {
         mMsgRec.Set();
      }

      protected override void Clean()
      {
         //mSomeEvent -= DoSomething();
      }

      protected override void Run(object sender, DoWorkEventArgs e)
      {
         BackgroundWorker bg = (BackgroundWorker)sender;
         for (int i = 0; !bg.CancellationPending && (i < 90); i++)
         {
            bg.ReportProgress(i);
            Thread.Sleep(100);
         }

         for (int i = 90; !bg.CancellationPending && (i < 100); i++)
         {
            mMsgRec.WaitOne(2000, false);
            bg.ReportProgress(i);
         }

         if (bg.CancellationPending)
         {
            e.Cancel = true;
         }
         else
         {
            e.Result = "Complete"; // Or desired result
         }
      }
   } 

```

这是主要形式的样子（非常基本的例子）：

```
 public partial class Form1 : Form
   {
      TestOperation t;

      public Form1()
      {
         InitializeComponent();
      }

      private void button1_Click(object sender, EventArgs e)
      {
         t = new TestOperation();
         t.CanCancel = true;

         t.OperationProgressChanged += new OperationProgressChangedEventHandler(t_OperationProgressChanged);
         t.OperationCompleted += new OperationCompletedEventHandler(t_OperationCompleted);

         t.StartOperation();
      }

      void t_OperationCompleted(RunWorkerCompletedEventArgs e)
      {
         progressBar1.Value = 0;
      }

      void t_OperationProgressChanged(ProgressChangedEventArgs e)
      {
         progressBar1.Value = e.ProgressPercentage;
      }

      private void button2_Click(object sender, EventArgs e)
      {
         t.StopOperation();
      }
   } 

```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-12-07T13:21:08.030

我目前正在[http://sklobovsky.nstemp.com/community/threadmare/threadmare.htm](http://sklobovsky.nstemp.com/community/threadmare/threadmare.htm)为 C# 项目调查 Threadmare。它看起来非常非常有用。它在 Delphi 中，但原则适用于任何可以处理事件的语言。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-02-27T22:58:03.027

除非您想被喂食，否则您不需要 BackgroundWorker，只要您遵守规则，普通线程是完全可以接受的。

# java - JFace FontRegistry 上的 NoClassDefFoundError

> ID：596999
> 
> 赞同：3
> 
> 时间：2009-02-27T22:55:29.660
> 
> 标签：java, eclipse, swt

当我启动 SWT 应用程序（通过 Eclipse 启动配置文件）时，我收到以下堆栈跟踪：

```
Exception in thread "main" java.lang.NoClassDefFoundError: org/eclipse/jface/resource/FontRegistry
    at org.eclipse.jface.resource.JFaceResources.getFontRegistry(JFaceResources.java:338)
    at org.eclipse.jface.window.Window.close(Window.java:313)
    at org.eclipse.jface.dialogs.Dialog.close(Dialog.java:971)
    at org.eclipse.jface.dialogs.ProgressMonitorDialog.close(ProgressMonitorDialog.java:348)
    at org.eclipse.jface.dialogs.ProgressMonitorDialog.finishedRun(ProgressMonitorDialog.java:582)
    at org.eclipse.jface.dialogs.ProgressMonitorDialog.run(ProgressMonitorDialog.java:498)
    at com.blah.si.workflow.SWTApplication.main(SWTApplication.java:135) 
```

现在，让这变得奇怪的事情：

1.  当我更改项目构建路径并将 jface.jar 替换为源项目（相同版本 - 3.3.1）时，错误消失了。
2.  我拥有的其他应用程序使用相同的 jar，以及相同启动配置文件和项目的副本，一切正常。
3.  这**不是**一个`ClassNotFoundException`. 该类位于类路径上。如果我将源附加到 jar，我可以调试到 getFontRegistry 方法。该方法将成功执行几次，然后最终`NoClassDefFoundError`在第 338 行抛出一个。第 337 行是一个“if variable == null”语句，用于检查静态变量是否已被初始化。如果它尚未初始化，第 338 行正在初始化它。第一次通过，空检查失败，进行初始化。在随后通过该方法时，空检查通过，因此返回已经初始化的静态值。在最后一次通过（失败的那一次）时，空值检查再次失败（即使静态变量已经初始化），当它尝试重新初始化静态变量时，`NoClassDefFoundError`被抛出。这是相关的源代码（从第 336 行开始，注意 fontRegistry 是一个私有静态变量，没有在其他地方设置）：

.

```
public static FontRegistry getFontRegistry() {
   if (fontRegistry == null) {
     fontRegistry = new FontRegistry(
         "org.eclipse.jface.resource.jfacefonts");
   }
   return fontRegistry;
} 
```

.

1.  我已经获得了 jar 的新副本（以确保它没有损坏），删除了我的 .classpath 和 .project 文件并开始了一个新项目，并重新创建了启动配置文件。不用找了。

由于上面 #3 中的特殊性，我怀疑某种奇怪的类加载器行为 - 似乎最终通过该方法的方法是在另一个类加载器中？

想法？

**更新：** Pourquoi Litytestdata 提供的答案提示我注意在 ProgressMonitorDialog 的第 458 行上方的 try 块中发生了什么。实际上，该代码正在引发异常，该异常正在被 finally 块吞噬。根本原因是另一个缺失的类（缺失的类不是 JFontRegistry 或其任何直接相关的类，而是另一个在边缘情况下依赖于蜘蛛网的类。）我赞成所有答案，指出我要注意类路径，并接受 Pourquoi 的，因为这是突破。谢谢大家。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-28T09:18:53.687

听起来您缺少一个包含依赖项的 JAR 文件，如[**Sanjiv JIVAN**](http://www.jroller.com/sjivan/)于 2006 年 7 月的这篇博客文章中所述：

[**ClassNotFoundException 和 NoClassDefFoundError 之间的区别**](http://www.jroller.com/sjivan/entry/difference_between_classnotfoundexception_and_noclassdeffounderror)

> **`ClassNotFoundException`**当 ClassLoader 找不到报告的类时抛出A。
> 这通常意味着该类从`CLASSPATH`.
> 这也可能意味着有问题的类正试图从另一个类中加载，该类在父类中加载，`ClassLoader`因此来自子类的类`ClassLoader`不可见。
> 在应用服务器等更复杂的环境中工作时有时会出现这种情况（WebSphere 因此类`ClassLoader`问题而臭名昭著）。
> 
> 人们往往容易**`java.lang.NoClassDefFoundError`**与`java.lang.ClassNotFoundException`. 但是有一个重要的区别。
> 
> 例如一个异常（一个错误，因为**`java.lang.NoClassDefFoundError`**它是 的子类**`java.lang.Error`**），比如

```
java.lang.NoClassDefFoundError:
org/apache/activemq/ActiveMQConnectionFactory 
```

> 并不意味着 ActiveMQConnectionFactory 类不在`CLASSPATH`.
> 
> 事实上，情况恰恰相反。
> 
> **这意味着该类`ActiveMQConnectionFactory`已被找到，`ClassLoader`但是在尝试加载该类时，它在读取类定义时遇到了错误。**
> 
> **这通常发生在所讨论的类具有使用`ClassLoader`.**
> 
> 因此，要找到罪魁祸首，请查看相关类的源代码（`ActiveMQConnectionFactory`在这种情况下）并**使用静态块或静态成员查找代码**。
> 如果您无权访问源代码，则只需使用**[JAD](http://www.kpdus.com/jad.html)**对其进行反编译。
> 
> 在检查代码时，假设您找到如下代码行，请确保您的`CLASSPATH`.

```
private static SomeClass foo = new SomeClass(); 
```

> 提示：要找出一个类属于哪个 jar，您可以使用网站**[jarFinder](http://www.jarfinder.com/)**。这允许您使用通配符指定类名，并在其 jar 数据库中搜索该类。
> [jarhoo](http://www.jarhoo.com/)允许你做同样的事情，但它不再免费使用。
> 
> 如果您想在本地路径中找到一个类所属的 jar，您可以使用**[jarscan 之](http://www.inetfeedback.com/jarscan/)**类的实用程序。您只需指定要查找的类以及您希望它开始在 jars 和 zip 文件中搜索类的根目录路径。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-28T13:11:01.820

我认为上面介绍的堆栈跟踪在这里隐藏了真正的问题。以下是[org.eclipse.jface.dialogs.ProgressMonitorDialog](http://kickjava.com/src/org/eclipse/jface/dialogs/ProgressMonitorDialog.java.htm)`run`中方法中 的代码（我添加了注释）：

```
public void run(boolean fork, boolean cancelable,
         IRunnableWithProgress runnable) throws InvocationTargetException,
         InterruptedException {
     setCancelable(cancelable);
     try {
         aboutToRun();
         // Let the progress monitor know if they need to update in UI Thread
         progressMonitor.forked = fork;
         ModalContext.run(runnable, fork, getProgressMonitor(), getShell()
                 .getDisplay());
     } finally {
         finishedRun();  // this is line 498
     }
} 
```

Jared 的堆栈跟踪中倒数第二行是此类的第 498 行，它是对块`finishedRun()`内的调用。`finally`我怀疑真正的原因是在`try`块中引发了异常。由于`finally`块中的代码也抛出了异常，所以原来的异常丢失了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-02T02:52:36.407

为了更好地处理它是否是类加载器问题，请查看它工作的代码并添加：

```
try
{
    final Class       clazz;
    final ClassLoader loader;

    clazz  = Class.forName("org/eclipse/jface/resource/FontRegistry");
    loader = clazz.getClassLoader(); 
    System.out.println("The classloader at step 1 is: " + loader);
}
catch(final Throwable ex)
{
    ex.printStackTrace();
} 
```

然后在你得到 NoClassDefFoundError 的地方做同样的事情，看看类加载器是否不同。

然后您将能够确保它是不同的 ClassLoader。你能报告一下这会发生什么吗？根据结果​​，我可能会有更多想法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-28T00:38:08.447

添加到[优秀的 TofuBeer 的答案](https://stackoverflow.com/questions/596999/noclassdeffounderror-on-jface-fontregistry/597781#597781)中，因为`NoClassDefFoundError`表明：

*   班级*被*, _**`org.eclipse.jface.resource.FontRegistry`** *`ClassLoader`*
**   但不能在不触发错误**的****情况下加载，例如使用`Class``ClassLoader`**.*

 *让我们看一下[**`org.eclipse.jface.resource.FontRegistry`**源代码](http://kickjava.com/src/org/eclipse/jface/resource/FontRegistry.java.htm)：

它没有任何静态变量初始化（也没有它的超类）。

让我们看看**[`org.eclipse.jface.resource.JFaceResources`源代码](http://kickjava.com/src/org/eclipse/jface/resource/JFaceResources.java.htm)**

触发错误的`getFontRegistry()`函数是使用**静态变量 fontRegistry**：

```
/**
 * The JFace font registry; <code>null</code> until lazily initialized or
 * explicitly set.
 */
private static FontRegistry fontRegistry = null; 
```

因此，它~~引出~~ *了*一个[问题](https://stackoverflow.com/questions/405364/whats-up-with-static-memory-in-java)：为什么会突然再次考虑[静态初始化变量](http://java.sun.com/docs/books/jvms/second_edition/html/Concepts.doc.html#19075)`null`？

因为不知何故[`FontRegistry`或被`JFaceResources`gc 卸载了](http://www.daniweb.com/forums/thread34695-3.html)？！

> 如果一个字段被声明为静态的，那么无论最终创建多少个类的实例（可能为零），都只存在该字段的一个化身。静态字段，有时称为类变量，在类初始化时体现（第 12.4 节）。
> 
> 所以无论类的实例是否在任何时候都存在，只要类本身已经加载，该字段就会存在。

* * *

如果这是一个**eclipse Plugin**，这可能与此**[FAQ 条目有关](http://wiki.eclipse.org/FAQ_What_causes_my_plug-in_to_build_but_not_to_load_in_a_runtime_workbench%3F)**

> 这是一个新用户的典型场景：
> 您正在编写一个扩展插件 XYZ 的插件。
> 要编译它，您可以从 Java Build Path 属性页面或通过编辑 .classpath 文件，将插件 XYZ 的 JAR 文件的引用添加到项目的构建路径中。
> 当您启动运行时工作台时，会报告以下令人惊讶的错误：`java.lang.NoClassDefFoundError: XYZ.SomeClass`.
> 
> 不要开始查看运行时工作台的启动配置中的插件和片段选项卡。
> 该选项卡仅影响用于运行时工作台的插件以及它们是从工作区加载还是从 Eclipse 安装目录加载。
> 
> 相反，开始查看插件清单。
> **编辑 plugin.xml 文件并确保提到 XYZ 作为必需的插件**。
> 然后，保存 plugin.xml 文件。
> 这将自动更新项目的构建路径。
> 
> 编写插件时切勿手动编辑 .classpath 文件。
> 插件清单编辑器只会覆盖您对其所做的任何更改。不是很文明，但这就是它的工作方式。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-09-20T11:46:15.023

如果您尝试自己加载类 FontRegistry（如 TofoBeer 所述），您会发现如果使用 FontRegistry，则以下 JAR 的类是依赖类。

```
org.eclipse.core.commands_xxxxx.jar 
```

您必须将此 JAR 添加到您的构建路径中。*******