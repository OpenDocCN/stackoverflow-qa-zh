# StackOverflow 问答 000697000-000697999

# sqlite - 将数据批量加载到 sqlite 中？

> ID：697004
> 
> 赞同：42
> 
> 时间：2009-03-30T12:34:09.863
> 
> 标签：sqlite, bulk-load

是否有人对可用于将存储在分隔文本文件中的数据批量加载到 SQLite 数据库中的实用程序有任何提示？

理想情况下，可以从脚本等中作为独立程序调用的东西。

我与之合作的一个小组有一个 Oracle 数据库，它会将一堆数据转储到文件中，然后将这些数据加载到 SQLite 数据库中以在移动设备上使用，并且正在寻找实现这种场景的最简单方法。

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-03-30T13:41:59.607

查看 sqite .import 命令 - 它确实做到了这一点。
您可以使用 .separator 命令设置分隔符

```
sqlite3 myDatabase
create table myTable (a, b, c);
.separator ','
.import  myFile  myTable 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T13:30:54.347

为什么要文本文件？

[只需使用 Java，它确实具有用于Oracle](http://www.oracle.com/technology/tech/oci/instantclient/index.html)和[SQLite](http://zentus.com/sqlitejdbc/)访问的易于使用的库。连接到两个数据库，只需从一个数据库中选择并插入另一个数据库，而不会增加 CSV 的复杂性，这不是一种定义非常明确的格式，并且会给您带来字符编码、引号、逗号/制表符或分号、换行符等方面的问题。你的数据。

# java - 如何安装 Apache Ant？

> ID：697006
> 
> 赞同：4
> 
> 时间：2009-03-30T12:35:53.760
> 
> 标签：java, apache, ant

我想在安装说明 ( [http://code.google.com/p/smslib/wiki/Installation ) 中安装 SMSlib (](http://code.google.com/p/smslib/wiki/Installation) [http://smslib.org/](http://smslib.org/) )。

在这里我必须安装 Apache Ant，但我不明白如何安装。我已经下载了 Apache Ant 1.7.1，阅读手册 ( [http://ant.apache.org/manual/index.html](http://ant.apache.org/manual/index.html) )

在这里我必须有来自 jpackage.org 的 RPM 版本，对吗？我已经去[http://www.jpackage.org/](http://www.jpackage.org/)之后我该怎么办？我已经尝试过（[http://mirrors.dotsrc.org/jpackage/1.7/generic/free/repodata/](http://mirrors.dotsrc.org/jpackage/1.7/generic/free/repodata/)）和（[http://www.jpackage.org/browser/browse.php?jppversion=1.7](http://www.jpackage.org/browser/browse.php?jppversion=1.7)）但是太多了关联。我不知道我必须下载女巫

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2011-02-22T20:11:53.477

如果您使用的是 Windows，则可以使用[WinAnt](http://code.google.com/p/winant/)，这是我为 Apache Ant 制作的 Windows 安装程序。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-02-06T11:12:42.447

You can follow these instrunctions-

1)Download the latest version of ant from [http://ant.apache.org/bindownload.cgi](http://ant.apache.org/bindownload.cgi)

2)Unzip and save it to your C:\ directory as ant.

3)Add the bin directory to your PATH environment variable.

4)Add the ANT_HOME environment variable set to C:\ant.

you can use following commands to set ANT_HOME variable

> C:>set ANT_HOME=C:\ant
> 
> C:>set JAVA_HOME=C:\jdk
> 
> C:>set PATH=%ANT_HOME%\bin;%JAVA_HOME%\bin
> 
> C:>ant -version
> 
> Apache Ant version 1.8.1 compiled on April 30 2010

if you have java installed on your machine

5)Add the ANT_OPTS environment variable set to -Xmx256M.

This is all you need to install ant on your machine.

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-05-27T13:08:25.263

**第 1 步：**下载并安装

下载蚂蚁。转到[Ant 主页](http://ant.apache.org)并单击以下载二进制文件。因为我们谈论的是 Windows，所以选择下载 ZIP 文件而不是其他任何文件。向下滚动到显示“当前版本的 Ant”的位置，然后单击 ZIP 文件名。

下载后，解压缩文件。您现在需要在计算机上为 Ant 选择一个永久的家。`c:\java\ant`经常使用，但你可以把它放在任何你想要的地方。

**第二步：**设置环境变量

*对于 Windows XP：*要在 Windows XP 上设置环境变量，请右键单击我的电脑并选择属性。然后转到高级选项卡并单击底部的环境变量按钮。

*对于 Windows 7：*要在 Windows 7 上设置环境变量，请右键单击计算机并选择属性。单击高级系统设置，然后单击底部的环境变量按钮。您绝对需要的唯一环境变量是 JAVA_HOME，它告诉 Ant 您的 JRE 的位置。

如果你已经安装了 JDK，这很可能

```
c:\Program Files\Java\jdk1.x.x\jre 
```

在 Windows XP 和

```
c:\Program Files(x86)\Java\jdk1.x.x\jre 
```

在 Windows 7 上。您会注意到它们的路径中都有空格，这会导致问题。您需要使用错位名称 [3] 而不是完整名称。因此，对于 Windows XP，使用 C:\Progra~1\Java\jdk1.xx\jre，对于 Windows 7，如果安装在 Program Files(x86) 中，则使用 C:\Progra~2\Java\jdk1.6.0_26\jre ） 文件夹

仅此一项就足以让 Ant 工作，但为了方便起见，最好将 Ant 二进制路径添加到 PATH 变量中。

此变量是以分号分隔的目录列表，用于搜索可执行文件。为了能够在任何目录中运行 ant，Windows 需要知道 ant 二进制文件和 java 二进制文件的位置。您需要将这两个都添加到 PATH 变量的末尾。对于 Windows XP，您可能会添加如下内容：

```
;c:\java\ant\bin;C:\Progra~1\Java\jdk1.x.x\jre\bin 
```

对于 Windows 7，它看起来像这样：

```
;c:\java\ant\bin;C:\Progra~2\Java\jdk1.x.x\jre\bin 
```

**完毕**

完成此操作并应用更改后，您需要打开一个新的命令提示符以查看变量是否设置正确。您应该能够简单地运行 ant 并看到如下内容：

```
Buildfile: build.xml does not exist!
Build failed 
```

这意味着 Ant 已正确安装并且正在寻找 build.xml 文件。

*来源：[http ://www.nczonline.net/blog/2012/04/12/how-to-install-apache-ant-on-windows/](http://www.nczonline.net/blog/2012/04/12/how-to-install-apache-ant-on-windows/)*

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-18T11:30:11.667

[1) 从“ http://ant.apache.org/bindownload.cgi](http://ant.apache.org/bindownload.cgi) ”下载“apache-ant-1.8.4-bin.zip ”

2）解压并复制“c:\Program Files”中的“apache-ant-1.8.4”

3）右键单击“我的电脑”->属性->高级->环境变量->编辑变量“PATH”并附加值“C:\Program Files\Java\jdk 1.7.0_04\bin;C:\Program Files\ apache-ant-1.8.4\bin”，然后单击“确定”。

4）打开cmd并输入“ant”进行检查。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-30T13:03:08.687

ant 和 smslib 的安装非常简单。您需要做的就是将其解压缩到某个目录。在 Linux 的情况下导出路径或将 ANT_HOME\bin 设置为 PATH 变量以从 shell 中的任何目录访问它。ANT_HOME 是安装 ant 的根目录。

对于 SMSLib 下载 zip 文件，此[链接](http://blog.dagitab.com/index.php?blog=1&p=38&more=1&c=1&tb=1&pb=1)应逐步指导您

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-11-23T06:04:04.450

它非常简单，只需在 [link][1] 上安装适用于 Windows 的 Apache ant 安装程序

[1]：[http](http://code.google.com/p/winant/) ://code.google.com/p/winant/一切都设置好了。无需设置环境变量。它会自动为你做每一件事。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-30T12:45:32.613

听起来就像你在使用 Linux。如果是这样，最简单的方法是使用像 Synaptic 这样的包管理前端并在其中安装 ant。

# c++ - 构造函数的初始化列表中的异常处理

> ID：697026
> 
> 赞同：5
> 
> 时间：2009-03-30T12:41:51.827
> 
> 标签：c++, exception-handling

在我的项目中，我发现了一段代码，其中在构造函数的初始化列表中调用了一个方法。

```
Test2(Test* pTest):m_pTest(pTest), m_nDuplicateID(pTest->getTestID())
    {
    } 
```

我观察到 Test2 的用户有可能将 NULL 传递给构造函数。由于指针在未经验证的情况下使用，因此存在访问冲突的可能性。

这促使我在构造函数的初始化列表中查看异常处理。我在一篇文章中发现 try 可以在初始化列表中使用。我写了一个小测试程序来测试这个概念：

```
//Test class stores the unique ID and returns the same with API getTestID
class Test
{
public:

    Test(int nID):m_nID(nID){
    }

    int getTestID() const
    {
            return m_nID;
    }
private:
    int m_nID;

};

class Test2
{
public:

    Test2(Test* pTest) 
        try :m_pTest(pTest), m_nDuplicateID(pTest->getTestID())
    {
    }
    catch (...) 
    {
        cout<<"exception cought "<< endl;
    }

    void printDupID()
    {
        cout<<"Duplicate ID" << m_nDuplicateID << endl;
    }
private:

    Test* m_pTest;
    int m_nDuplicateID;
};

int main(int argc, char* argv[])
{

    Test* pTest = new Test(10);

    Test2 aTest2(pTest);
    aTest2.printDupID();

    delete pTest;

    return 0;
} 
```

此代码**未在 VC6.0 中编译**。我是否需要进行任何更改才能使其在 VC 6.0 中编译？

此外，在其中一篇文章中，我发现在构造函数的初始化列表中使用 try 并不严格符合 C++ 标准。在这种情况下，我们如何处理构造函数的初始化列表中的异常（标准处理方式）？

谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-30T12:49:14.523

C++ 标准第 15 / 3 节

> function-try-block 将 handler-seq 与ctor-initializer（如果存在）和函数体相关联。在执行 ctor-initializer 中的初始化程序表达式期间或在执行函数体期间引发的异常将控制权转移到 function-try-block 中的处理程序，其方式与在执行 try 期间引发的异常相同-block 将控制权转移给其他处理程序。

```
class C 
{  
    int i;  
    double d;  
public:  
    C(int, double);  
};  

C::C(int ii, double id)  
try  : i(f(ii)), d(id)  
{  
//constructor function body  
}  catch (...)  
{  
//handles exceptions thrown from the ctor-initializer  
//and from the constructor functionbody  
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-30T12:48:45.743

首先，如果您取消引用 NULL 指针，标准 C++ 不保证会引发异常，因此您的代码在这种情况下毫无用处。

其次，如果抛出异常，您的异常处理程序会做什么？

第三，构造函数/函数异常块被广泛认为是浪费时间 - 看看这个[http://www.gotw.ca/gotw/066.htm](http://www.gotw.ca/gotw/066.htm)和 Herb Sutter 的 GotW 站点上的其他文章。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-30T12:48:19.737

根据[这篇文章](http://weseetips.com/2008/06/04/how-to-catch-exceptions-from-constructor-initializer-list/)，看起来你不能在 VC++ 6.0 中做到这一点

您要么必须升级到 7.0，要么只在构造函数主体中进行初始化。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-09T10:25:39.897

你不能只使用一个函数来检查ptr，例如：

```
template<typename P>
P* checkPtr (P* p)
{
    if (p == 0)
        throw std::runtime_error ("Null pointer");
    return p;
}

class Test2
{
public:
    Test2 (Test* pTest)
        : m_pTest (checkPtr (pTest))
    {
    }

    Test* m_pTest;
}; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-30T14:34:42.493

人们还在使用VC6？说真的，VC6 几乎不是一个符合标准的编译器。帮自己一个忙，至少得到VS2005。VC6是你的问题。试试 VS2008 express 看看能不能编译。

当然，另一种选择是参考构造，这需要绑定。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-27T17:07:19.537

（对于谷歌同事）

如果我们不想存储 ptr / shared_ptr 的副本，另一种解决方案：

```
class Foo::Pimpl
{
public:
    bool paramTest_;

    Pimpl(ConstNodePtr root)
    try  :
       paramTest_( root ? true : throw std::invalid_argument("Foo (pimpl) constructed from NULL node")),
    ...
{
    ...
}  catch (...)
{
    throw; // rethrow
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-05-29T08:04:59.350

已经有很多有用的答案，但我会尝试添加一点，也许它会对某人有所帮助。

首先，正如其他人已经提到的 - 取消引用`nullptr`或无效指针（地址）不会在标准 C++ 中引发异常。MSVC 通过其[结构化异常处理](https://msdn.microsoft.com/en-us/library/ms680657%28VS.85%29.aspx)来支持它，但它不是可移植的。[在这个答案](https://stackoverflow.com/a/1823728/895077)中阅读更多相关信息。

构造函数中的函数 try 块不允许您抑制异常，如果您不抛出另一个异常，它将无论如何都会传播。而当你进入 catch 子句时，类的所有成员都已经被销毁了。因此，您可以在其中做的唯一合理的事情是以某种方式记录错误，或者可能更改一些全局变量。这就是为什么它或多或少被认为是无用的。

至于你的初始代码

```
Test2(Test* pTest):m_pTest(pTest), m_nDuplicateID(pTest->getTestID())
    {
    } 
```

您可以使用三元运算符在初始化程序列表中检查 pTest 的空值，并在它为空的情况下执行一些适当的操作 - 只需根据其类型将 m_nDuplicateID 设置为 nullptr 或其他值，调用另一个函数并使用它的返回类型， ETC：

```
Test2(Test* pTest):
    m_pTest(pTest),
    m_nDuplicateID( pTest ? pTest->getTestID() : /*some value or call*/ )
{
} 
```

您甚至可以使用多个嵌套的三元运算符来创建更复杂的执行流程。

只是为了完整起见，您的代码并非如此，但它可能会在相同情况下磨损某人。如果您使用类的成员 m_pTest 来初始化 m_nDuplicateID，这将取决于这些成员在类的声明中的顺序，因为初始化列表中的类成员按照声明的顺序进行初始化，而不是按照它们出现在初始化列表本身中的顺序进行初始化，所以这可能是一个问题，最好避免成员初始化顺序依赖：

```
class A
{
    A( B* pTest );
    int m_nDuplicateID;
    B* m_pTest;
};

A::A( B* pTest ) :
    m_pTest( pTest ),
    m_nDuplicateID( m_pTest->someMethod() ) // here m_pTest isn't initialized yet,
                                            // so access violation probably
{
} 
```

# extjs - 如何为 extjs 设置调试环境

> ID：697038
> 
> 赞同：0
> 
> 时间：2009-03-30T12:45:45.703
> 
> 标签：extjs

我将 Eclipse EE 和 tomcat 用于 webwork、extjs、hibernate spring 应用程序。对于 spring 和 hibernate 人员，我配置了远程应用程序调试设置。所以我进行调试。但是对于extjs，我已经在我的ubuntu机器的firefox浏览器中安装了firebugs，但是我仍然不知道如何捕获断点以查看如何跟踪javascript代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T16:26:03.113

在 Firebug 中，转到脚本选项卡。在顶部，您可以看到：

```
Inspect | all | <filename> 
```

单击以选择包含要跟踪的 javascript 的文件。选择文件后，单击行号以放置断点（将出现一个大红点）。

您可以在不同的文件中放置多个断点。如果刷新页面（F5），断点不会消失。

本[教程](http://michaelsync.net/2007/09/30/firebug-tutorial-script-tab-javascript-debugging)也应该对您有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-21T18:19:39.093

实际上对于 Sencha EXT JS，我也会推荐优秀的 Sencha App Inspector。[https://chrome.google.com/webstore/detail/app-inspector-for-sencha/pbeapidedgdpniokbedbfbaacglkceae](https://chrome.google.com/webstore/detail/app-inspector-for-sencha/pbeapidedgdpniokbedbfbaacglkceae)

# sql - 编写事务表

> ID：697048
> 
> 赞同：-1
> 
> 时间：2009-03-30T12:49:02.277
> 
> 标签：sql, transactions

我需要有关如何将数据从一个帐户号转移到单个表中的另一个帐户号的帮助。在此客户将从下拉列表中获取他的帐户编号（它将通过他的会话自动出现）并且客户必须在文本框中输入目标帐户编号，并且他正在转移的金额将写入另一个文本框中。在转移金额之前，目的地帐号和余额金额应进行验证。

Customer_Account 表：

```
+-----------+--------+--------+---------+--------------+
| AccountId | UserId | Status | Balance | AccountCode  |
+-----------+--------+--------+---------+--------------+
|    101    |  xyz   |    A   |  2000   | SB ->Savings |
+-----------+--------+--------+---------+--------------+
|    102    |  abc   |    A   |  3000   | SV->Current  |
+-----------+--------+--------+---------+--------------+
|    103    |  yxz   |    A   |  4000   |  SI->Joint   |
+-----------+--------+--------+---------+--------------+ 
```

对于 SB MinBalance 500,SV 1000,SI 2000 应该有

交易表：

```
TransactionID, AccountID, TransactionType, Amount, DOT, UserID ,SourceOrDestAccountId ,TransferFlag,Balance 
```

在此如果 AccountId 101 想要将他的 1000 金额转移到 AccountId 102 AccountId 101 将被借记，AccountId 102 将被记入贷方。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T13:43:54.923

检查您的教科书是否有“交易”，并了解如何明确开始交易。一旦您知道如何在事务中包装一系列语句，只需执行所有必要的检查并在出现问题时回滚即可。

尽管大多数银行都允许负余额，但我猜你的家庭作业并非如此——如果他们没有足够的资金进行转账，它应该会失败。如果这是真的，那么对 Amount 列的约束可能会很有用。然后你不需要明确地检查它。如果你想允许负余额，那么我可能会编写如下代码：（伪代码。我不会尝试提交。如果你想学习，你需要自己做一些工作。）：

开始交易

更新源帐户以将金额减去正在转移的金额

查看源账户上的Amount是否小于0，如果是则回滚交易

更新目标帐户以将金额增加正在转移的金额

提交交易

还包括您认为合适的任何其他错误检查。如何执行此操作将取决于您的特定数据库。

# c# - C# 和 UTF-16 字符

> ID：697055
> 
> 赞同：7
> 
> 时间：2009-03-30T12:51:09.887
> 
> 标签：c#, unicode

在 C# 中是否可以使用不在平面 0 中的 UTF-32 字符作为字符？

```
string s = ""; // valid
char c = ''; // generates a compiler error ("Too many characters in character literal") 
```

在 s 中，它由两个字符表示，而不是一个字符。

编辑：我的意思是，是否有一个字符 AN 字符串类型具有完整的 unicode 支持，每个字符 UTF-32 或 UTF-8？例如，如果我想对字符串中的 utf-32（可能不在 plane0）字符进行 for 循环。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-11T23:29:14.263

该类[`string`](http://msdn.microsoft.com/en-us/library/system.string.aspx)代表一个 UTF-16 编码的文本块，[`char`](http://msdn.microsoft.com/en-us/library/system.char.aspx)a 中的每个`string`代表一个 UTF-16 编码值。

尽管没有表示单个 Unicode 代码点的 BCL 类型，但支持平面 0 以外的 Unicode 字符，其形式为采用 a`string`和索引而不是仅 a的方法重载`char`。例如，[System.Globalization.CharUnicodeInfo](http://msdn.microsoft.com/en-us/library/system.globalization.charunicodeinfo.aspx)[`GetUnicodeCategory`﻿`(char)`](http://msdn.microsoft.com/en-us/library/h6sx68ke.aspx)类的静态方法有一个相应的方法，可以识别从指定索引开始的简单字符或代理对。[`GetUnicodeCategory`﻿`(string,int)`](http://msdn.microsoft.com/en-us/library/a91e3zb6.aspx)

* * *

要遍历 a 中的文本元素`string`，您可以使用[System.Globalization.StringInfo](http://msdn.microsoft.com/en-us/library/system.globalization.stringinfo.aspx)类上的方法。这里，“文本元素”对应于屏幕上显示的单个字符。这意味着简单字符 ( `"a"`)、组合字符 ( `"a\u0304\u0308"`= "ā̈") 和代理对 ( `"\uD950\uDF21"`= "��") 都将被视为单个文本元素。

具体来说，[GetTextElementEnumerator](http://msdn.microsoft.com/en-us/library/x2f3k4f6.aspx)静态方法将允许您枚举 a 中的每个文本元素`string`（有关代码示例，请参见链接的 MSDN 页面）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-30T12:58:16.327

我只从 Java 中知道这个问题，并在回答之前检查了[文档`char`](http://msdn.microsoft.com/de-de/library/x9h8tsay%28VS.80%29.aspx)，实际上 .NET/C# 和 Java 中的行为几乎相同。

似乎确实 a`char`被定义为 16 位，并且绝对不能保存平面 0 之外的任何内容。只有`String`/`string`能够处理这些字符。在`char`-array 中，它将表示为[两个代理字符](http://en.wikipedia.org/wiki/UTF-16)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-09T15:13:11.597

C# System.String 支持 UTF-32 就好了，但你不能像 System.Char 的数组一样遍历字符串或使用 IEnumerable。

例如：

```
// iterating through a string NO UTF-32 SUPPORT
for (int i = 0; i < sample.Length; ++i)
{
    if (Char.IsDigit(sample[i]))
    {
        Console.WriteLine("IsDigit");
    }
    else if (Char.IsLetter(sample[i]))
    {
        Console.WriteLine("IsLetter");
    }
}

// iterating through a string WITH UTF-32 SUPPORT
for (int i = 0; i < sample.Length; ++i)
{
    if (Char.IsDigit(sample, i))
    {
        Console.WriteLine("IsDigit");
    }
    else if (Char.IsLetter(sample, i))
    {
        Console.WriteLine("IsLetter");
    }

    if (Char.IsSurrogate(sample, i))
    {
        ++i;
    }
} 
```

注意 Char.IsDigit 和 Char.IsLetter 调用的细微差别。并且 String.Length 始终是 16 位“字符”的数量，而不是 UTF-32 意义上的“字符”数量。

题外话，但是对于处理国际语言的应用程序来说，UTF-32 支持是完全没有必要的，除非你有一个模糊的历史/技术语言的特定业务案例。

# silverlight - 确保文本在 Silverlight 中始终可读

> ID：697056
> 
> 赞同：1
> 
> 时间：2009-03-30T12:51:14.830
> 
> 标签：silverlight, graphics

我们有一个 Silverlight 应用程序，可以在视频上显示文本。文本和视频都可以被认为是变量。有时我们可能会有一个黑暗的视频，有时是一个明亮的视频，有时是一个包含两者部分的视频。

想想电影结尾处的演职员表。我们希望确保最终用户始终可以阅读视频中显示的文本。文本始终是视频顶部的叠加层。

简单的解决方案是两次显示文本两次，一次是白色，一次是黑色，偏移量很小。这几乎可以工作，但实际上看起来有点粗糙，并且会影响用户体验。

理想情况下，我们的文本边缘会带有轻微的半透明发光。因此，如果文本是白色的，那么边缘就会有黑色的光芒。

有没有办法做到这一点？还是有同等或更好的解决方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T12:59:26.713

您可以尝试使用对比鲜明的轮廓来显示它，而不是像您以小偏移量显示一次时所获得的“投影”。为此，以一种颜色显示四次，然后以对比色显示第五次，以之前的四个副本为中心。前四个应该从中心向上、向右、向下和向左偏移一个像素。

最终效果应该是一个轮廓。当然，也许这看起来也很“粗糙”，因为它是计算机生成的，因此在字距调整、字符间距等问题上并不完美。但至少可以很快尝试。

一般来说，当背景是视频时，自动找到好的对比色听起来有点困难。在最坏的情况下，视频包含的文本与您要显示的文本一样。在这种情况下，正确的解决方案很难想象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T14:05:51.750

听起来类似于确保字幕在电影/电视中始终可读的问题。最稳健但不一定最优雅的解决方案是为文本设置一个彩色背景矩形，该矩形要么不透明，要么具有低透明度值——通常是灰色或黑色，具有良好的对比前景色。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-06T20:55:35.263

我在 Silverlight 3 中使用 DropShadow 像素着色器效果完成了这项工作。它运行良好，但由于像素着色器不在硬件上执行，它会对应用程序的性能产生相当大的影响。

如果你想变得雄心勃勃，你可以编写自己的像素着色器。Silverlight 3 支持 HLSL 着色器。

# .net - Click-Once 替代图标位置

> ID：697057
> 
> 赞同：1
> 
> 时间：2009-03-30T12:52:07.667
> 
> 标签：.net, clickonce, desktop, icons, shortcut

单击一次内是否有任何功能可以推送多个快捷方式？（例如桌面，启动菜单等）过去我总是将其作为已部署应用程序的表单加载事件的一部分（安装触发应用程序启动 - 因此我可以使用表单加载来完成设置过程）。但是，我想知道这是否是最好的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T13:05:46.793

您不能使用 ClickOnce 创建任意快捷方式。您拥有的唯一附加选项是“清单”下的“发布”->“选项”对话框中的“创建桌面快捷方式”。

与让应用程序在运行时创建快捷方式一样：我不会这样做，因为您正在对未作为安装包的一部分拾取的系统进行更改。因此，在卸载应用程序时，您可能会留下孤立文件。

# c# - 单实例 Windows 窗体应用程序以及如何获取它的参考？

> ID：697058
> 
> 赞同：5
> 
> 时间：2009-03-30T12:52:27.200
> 
> 标签：c#, winforms, singleton, mutex

我有一个 Windows 窗体应用程序，它当时只允许一个实例运行。我已经使用 Mutex 实现了 Singleton。应用程序必须可以从命令行启动（带或不带参数）。应用程序由脚本启动和退出。用户不能对其采取任何行动。

因此，应用程序的目的是简单的“指标”应用程序，它只会为最终用户显示一些视觉和图形信息。最终用户不能用它做任何事情，只是看到它。它是 Windows 窗体应用程序，因为视觉和图形外观相对容易实现（您可以将其置于最顶层、无边界等）。

简而言之：当有人尝试使用 exit 命令行参数运行同一个应用程序时，我如何退出当前正在运行的应用程序？

```
bool quit = (args.Length > 0 && args[0] == "quit") ? true : false;
using (Mutex mutex = new Mutex(false, sExeName))
{
    if (!mutex.WaitOne(0, true)) 
    {
        if (quit)
        {
            // This is the tricky part?
            // How can I get reference to "previous" launced 
            // Windows Forms application and call it's Exit() method.
        }
    } 
    else 
    {
        if (!quit)
        {
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            Application.Run(new Form1());
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-31T01:26:43.487

.NET 框架为此提供了一个非常好的通用解决方案。[查看这篇MSDN 杂志文章](http://msdn.microsoft.com/en-us/magazine/cc163741.aspx)的底部。使用 StartupNextInstanceHandler() 事件处理程序将任意命令传递给正在运行的实例，例如“退出”。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-30T13:04:09.747

这不是把事情复杂化了吗？与其关闭现有实例并启动一个新实例，不如重新激活现有实例？无论哪种方式，下面的代码都应该给你一些关于如何去做的想法......？

```
Process thisProcess = Process.GetCurrentProcess();
        Process[] allProcesses = Process.GetProcessesByName(thisProcess.ProcessName);
        Process otherProcess = null;
        foreach (Process p in allProcesses )
        {
            if ((p.Id != thisProcess.Id) && (p.MainModule.FileName == thisProcess.MainModule.FileName))
            {
                otherProcess = p;
                break;
            }
        }

       if (otherProcess != null)
       {
           //note IntPtr expected by API calls.
           IntPtr hWnd = otherProcess.MainWindowHandle;
           //restore if minimized
           ShowWindow(hWnd ,1);
           //bring to the front
           SetForegroundWindow (hWnd);
       }
        else
        {
            //run your app here
        } 
```

这里还有一个关于这个的[问题](https://stackoverflow.com/questions/646480/is-using-a-mutex-to-prevent-multipule-instances-of-the-same-program-from-running)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T16:49:25.163

这是一个有点快速和肮脏的解决方案，您可能希望对其进行改进：

```
[STAThread]
static void Main()
{
    var me = Process.GetCurrentProcess();
    var otherMe = Process.GetProcessesByName(me.ProcessName).Where(p => p.Id != me.Id).FirstOrDefault();

    if (otherMe != null)
    {
        otherMe.Kill();
    }
    else
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        Application.Run(new Form1());
    }
} 
```

如果应用程序的一个实例已经启动，则该进程被终止；否则应用程序正常启动。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-02-15T06:08:51.777

我认为最简单的方法是以下

看链接

[http://codenicely.blogspot.com/2010/04/creating-forms-object.html](http://codenicely.blogspot.com/2010/04/creating-forms-object.html)

# java - 人们选择 Ruby 而不是 Java 的原因是什么？

> ID：697060
> 
> 赞同：9
> 
> 时间：2009-03-30T12:53:01.583
> 
> 标签：java, ruby

我是 Ruby 的初学者。我听到了以下关于 Ruby 的抱怨，并希望 Stack Overflow 社区能够解决提出的每个问题。

我听到的关于 Ruby 的常见抱怨：

*   Ruby 比 Java 慢
*   Ruby 不是静态类型的
*   不适合大型项目

鉴于这些公认的基于意见的陈述，Ruby 如何比 Java“更好”？Ruby 是否会成为企业和个人广泛使用的语言？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-30T15:31:09.377

Ruby 的运行速度比 Java 慢，但读写速度更快。哪个对你更重要？如果有机会（比如说）以硬件翻倍为代价将他们的开发时间缩短一半，我不知道世界上有任何公司会通过。

Ruby 不是静态类型的，但 Python、Perl、Lisp、shell 脚本等也不是。这对你来说真的是个问题吗？我敢肯定，你会发现同样多的人使用动态语言会抱怨 Java、C#、C++ 等是静态类型的。我们不乏基于动态语言构建的系统示例。

我同意 Ruby 不适合大型项目，但我们今天拥有的任何其他语言也不适合。软件工程的现状对我来说非常清楚：没有人能够可靠地构建大型系统。至少 Ruby 使您的大型项目的代码行数更小，这使得它们（在某种程度上）更易于管理。它在语法上更丰富，因此您可以说出（更接近）您的意思。写起来更快，所以你会更快地发现你是否走在正确的道路上。

如果这些是反对 Ruby 的最佳论据，那么 Ruby 的表现比我想象的要好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-30T12:57:51.943

[Ruby 的速度在最新版本](http://blog.dhananjaynene.com/2008/07/performance-comparison-c-java-python-ruby-jython-jruby-groovy/)中大大提高。尽管在旧版本中 Ruby[比其他脚本语言慢。](http://shootout.alioth.debian.org/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-30T15:22:47.963

出于某些目的，Ruby 的运行速度太慢。对于其他人来说，它已经足够快了。

出于某些目的，Java 的开发时间太长。

对于某些应用程序，静态类型是不必要的，而对于其他应用程序来说，这是非常可取的。

项目的规模在很大程度上是无关紧要的。

在某些方面，Java 比 Ruby 更好，在其他方面，Ruby 比 Java 更好。任何认为在任何情况下都“更好”的人可能对两者都没有足够的了解，无法持有有效的意见。

那么 JRuby 呢？

我认为现在 Ruby 是“流行的”，这已经得到了很好的证明。例如，不像 Java、C++ 或 C 那样“流行”，但仍然很流行。

看

*   [http://www.langpop.com/](http://www.langpop.com/)
*   [http://www.tiobe.com/index.php/content/paperinfo/tpci/index.html](http://www.tiobe.com/index.php/content/paperinfo/tpci/index.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T13:18:57.837

“哪种语言更好，这个还是那个？”这个问题的答案。总是主观的。当然，客观性是有效的，您可以以某种方式得出关于一种语言更适合 X 任务/项目的结论。

然而，即便如此，如果您的团队对某些不是某个任务/项目的首选语言感到满意，但无论如何都可以完成工作......一个明智的团队会选择让他们开心的语言，因为他们的生产力也会更高。

最后，没有人能告诉你他的选择比你的选择更好。他们可以试图说服你，但如果出于某种原因 X 语言让你更加兴奋，他们对此无能为力。

话虽如此：就性能而言，Ruby 1.9+ 已经有了很大的改进。如果你问我，我的偏见是选择 Ruby，因为我喜欢它。但是，如果您想要一个公正的意见，我们将不得不讨论更多方面并检查您究竟想对语言/框架等做什么。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-30T15:18:10.297

我建议您尝试两种语言，然后决定您认为最好的语言。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-30T13:00:24.077

Ruby 已经是一门流行的语言了 :)

我不同意您关于“我们应该始终考虑性能”和“ruby 比 java 更好”的观点。在某些项目中，代码可读性可能比性能更重要。例如，想想没有人可以阅读和维护的优化 C++ 代码。并且没有完美的证据证明“Ruby 比 Java 更好”。你从哪里得到这些信息的？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-30T17:41:01.607

取决于你需要做什么。

我们希望我们的代码可以运行数十年。继续使用纯 Java 意味着我们非常确定这些技术将保持“时尚”，并且未来的同事可以维护代码。选择当时的语言，最终将意味着您将使用已经过时的语言编写程序，因此更难以维护。

“纯 Java”基本上意味着我们使用标准的 Java 运行时和 Sun 规范的实现（如 JavaServer Faces）。它并不像听起来那么无聊:)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-30T15:30:01.970

> Ruby 如何比 Java“更好”？

事实并非如此，Java 并不比 Ruby“更好”。两者各有利弊，这取决于你的项目；什么是这项工作的最佳**工具**。

# c# - 如何在 WCF 服务中列出请求用户的角色？

> ID：697065
> 
> 赞同：2
> 
> 时间：2009-03-30T12:54:03.217
> 
> 标签：c#, .net, wcf, security-roles

刚刚开始掌握 WCF 安全性。如何在服务中列出用户的角色？

例如

```
// Could use declarative security here, i.e. using PrincipalPermission attribute
public string MyService()
{
    // Would like some code that does something like:
    foreach( Role role in CurrentUser.Roles )
    {
    }
} 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T13:38:56.153

在处理 Windows 组时，您可以使用以下代码：

```
foreach (IdentityReference idRef in WindowsIdentity.GetCurrent().Groups)
{
    Console.WriteLine(idRef.Translate(typeof(NTAccount)).Value);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T14:40:12.620

.NET 中基于角色的安全基础架构（即 IPrincipal）不允许获取用户的所有角色。您只能查询用户是否处于特定角色（通过 IPrincipal.IsInRole("role-name")）。

但是，如果您不介意被绑定到特定的身份验证/授权设置，则有一些解决方案。例如，另一位发帖人指出了如何在使用 Windows 身份验证时获取用户的角色。

# development-environment - 寻找非程序员的快速应用程序开发/应用程序构建器

> ID：697067
> 
> 赞同：-1
> 
> 时间：2009-03-30T12:54:42.123
> 
> 标签：development-environment

是否有任何工具可以为我生成简单的应用程序，例如访问权限，但无需安装访问权限或打开办公室，可以将数据保存在真正的独立可执行文件中，并为非程序员提供嵌入式简单数据库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T13:01:55.570

我相信[Filemaker 可以满足](http://www.filemaker.com/index.html)您的需求。它不是免费的，但是您可以随时下载试用版并查看它是否合适。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T13:19:46.680

如果您熟悉 Access，则应考虑使用 Access 运行时将其编译为独立应用程序。[这是](http://www.tech-archive.net/Archive/Access/microsoft.public.access.devtoolkits/2005-01/0046.html)一个线程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T13:43:02.337

请记住，非程序员能够完成的工作非常有限，因此称其为“快速应用程序开发”可能有点夸大其词。

# cloud - 云技术的最佳概述是什么？

> ID：697076
> 
> 赞同：6
> 
> 时间：2009-03-30T12:58:12.257
> 
> 标签：cloud, cloud-platform

关于云技术的讨论很多。您会推荐哪些资源来回顾云计算世界，并帮助人们了解**全局**和**当前趋势**？

除了阅读这些概述之外，您还推荐什么作为熟悉这些技术的第一步？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-30T13:51:11.660

除了其他人提到的[Microsoft Azure](http://www.microsoft.com/azure/default.mspx)之外，还有：

*   [亚马逊 EC2](http://aws.amazon.com/ec2/)
*   [谷歌应用引擎](http://code.google.com/appengine/)
*   [太阳云计算](http://www.sun.com/solutions/cloudcomputing/index.jsp)

..还有其他一些。Azure 在 CTP 中并且在秋季之前免费。Google 的 App Engine 是免费的，但有限制，我上次听说的 Amazon EC2 也是如此。

整个事情仍处于开发阶段，因此可能很难准确地提炼出它的发展方向。Microsoft 有很多有趣的[PDC](https://sessions.microsoftpdc.com/public/timeline.aspx)和[MIX](http://live.visitmix.com/)会议视频来说明他们的方法。

另请参阅[Wikipedia](http://en.wikipedia.org/wiki/Cloud_computing)了解更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T15:33:35.550

我喜欢伯克利的[“云端之上”](http://d1smfj0g31qzek.cloudfront.net/abovetheclouds.pdf)白皮书。它对云计算的成本/收益分析以及不同类型的云提供商进行了简明而详细的讨论。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T15:27:01.710

我最近做了一些类似的研究，这里有一个链接，可以很好地比较主要供应商：

[http://cloudenterprise.info/2008/10/29/microsoft-azure-vs-amazon-google-and-vmware/](http://cloudenterprise.info/2008/10/29/microsoft-azure-vs-amazon-google-and-vmware/)

我还建议查看诸如[RightScale](http://www.rightscale.com)之类的“元提供者” ，它们可以让您的云管理更简单一些。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T12:59:18.323

熟悉 Azure。它的网站上有很多手册和教程。

[http://www.microsoft.com/azure/](http://www.microsoft.com/azure/)

还可以观看 MIX 09 中与 Azure 相关的在线会议：

[http://sessions.visitmix.com/](http://sessions.visitmix.com/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T13:05:24.750

Azure CTP 在年底前免费提供。检查[此](http://www.microsoft.com/azure/register.mspx)链接。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-17T11:45:11.530

我总是会看一下 John M Willis/Cote 关于云的著作/播客：

*   [http://www.johnmwillis.com/cloud-computing/cloud-favorites/](http://www.johnmwillis.com/cloud-computing/cloud-favorites/)
*   [http://www.johnmwillis.com/cloud-computing/cloud-cafe-30-what-is-a-cloud-from-the-beginning/](http://www.johnmwillis.com/cloud-computing/cloud-cafe-30-what-is-a-cloud-from-the-beginning/)

也许浏览“思考云”：

*   [http://gevaperry.typepad.com/main/2009/01/what-is-a-cloud-first-define-a-table-the-furniture-kind-that-is.html](http://gevaperry.typepad.com/main/2009/01/what-is-a-cloud-first-define-a-table-the-furniture-kind-that-is.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-30T15:02:17.863

我在这里找到了有关最佳云计算书籍的相关讨论：http: [//highscalability.com/books-web-2-0-architectures-and-cloud-application-architectures](http://highscalability.com/books-web-2-0-architectures-and-cloud-application-architectures)

如果您正在寻找有关云计算和云架构的优秀书籍，请查看这一点。

# php - 我在哪里可以找到用 PHP 编写的好的 VCS？

> ID：697078
> 
> 赞同：3
> 
> 时间：2009-03-30T12:58:27.950
> 
> 标签：php, version-control

我有一个可以运行 PHP 和 Ruby 的 Web 服务器。

我想知道是否有一个PHP程序可以对我的代码进行类似于SVN的版本控制？
我知道已经有提供此服务的开源项目托管站点，但我希望将它安装在我自己的主机上。
我也无权访问此服务器来安装其他软件包

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-30T13:01:06.897

我不知道任何用 PHP 编写的版本控制系统。但即使有，我也会远离它。版本控制不是脚本语言最适合使用的事情之一。

编辑：我建议在您的本地计算机上安装 Subversion 并在那里开发所有代码，这样您本地计算机上的 SVN 就可以用于版本控制。

编辑 2：如果您正在与其他人合作并希望他们能够访问您的存储库，我建议为您的项目在某个地方进行 subversion 托管。有一些免费的主机支持它，只需谷歌它，你应该会找到一些结果。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-11-30T21:26:08.707

出于同样的原因 - 想将数据存储在我自己的网站上，该网站只支持 PHP - 我创建了[phpEasyVCS](http://phpeasyvcs.sourceforge.net)。它提供 Web 界面和 WebDAV 访问。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-30T14:24:29.757

[http://sourceforge.net/projects/asvcs/](http://sourceforge.net/projects/asvcs/) - 没试过这个。但这听起来像你所追求的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-02-16T09:30:18.197

据我所知，WEBSVN 只是查看您的 SVN 存储库的一种方式

问候

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T13:01:25.383

为什么你会关心你使用的工具的语言？这就像抱怨你房子的建造者使用木梯而不是金属梯子。

使用[Subversion](http://subversion.tigris.org/)或 Git 或任何你想要的东西，它们都可以正常工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-30T13:11:35.233

只需使用在线服务，例如[http://unfuddle.com/](http://unfuddle.com "解惑")或[http://cvsdude.com/](http://cvsdude.com/ "csvdude") 他们有免费的基本计划，甚至他们的付费计划也足够便宜，值得一试。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-30T13:18:36.683

如果您在不是您的计算机的地方需要 VCS，并且生产站点也不在您的控制之下，我同意 nandos 的观点，即您应该使用在线服务。

然后，为了在生产中进行更改，您可以在生产站点上制作 PHP 脚本，该脚本访问在线服务并通过 HTTP 下载最新版本（http 应该通常与 CVS 一起使用，而 SVN 原生使用它）而不是使用特定的 VCS 协议。

您将拥有有限的选择，但这并不是通常期望从生产中控制的内容。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-30T13:25:57.867

好的，我认为没有人真正回答我的问题。我说我不想要像[http://en.wikipedia.org/wiki/Comparison_of_free_software_hosting_facilities](http://en.wikipedia.org/wiki/Comparison_of_free_software_hosting_facilities)这样的托管设施。所以我想我会使用[http://websvn.tigris.org/](http://websvn.tigris.org/) 谢谢。

纪尧姆

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-30T13:36:01.760

为什么必须用 PHP 编写 VCS？您可以使用 SVN 作为 VCS 并使用 apache 提供文件。我想不出与另一个版本控制系统搏斗的单一好处。您可以做的是获得一个用于源代码控制和问题管理的虚拟机设备，例如[vmTrac](http://www.garghouti.co.uk/vmTrac/)，然后直接运行它或将其拆开并弄清楚它是如何组合在一起的

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-06-15T18:51:59.783

我知道这是旧的，但作为参考，因为您有 FTP 访问权限，您可以通过 FTP 使用[Bazaar](http://bazaar.canonical.com/en/)，并使用[Redmine](http://www.redmine.org)之类的东西作为网络查看器。使用 FTP 会比在服务器上安装 Bazaar 智能服务器慢（FTP 被称为“哑”传输），但它会满足您的所有要求。

希望对某人有所帮助

-斯科特

# oracle - 升级 Informix - 切换到 Oracle、Sybase 还是继续使用 Informix？

> ID：697083
> 
> 赞同：3
> 
> 时间：2009-03-30T12:59:13.843
> 
> 标签：oracle, sybase, rdbms, informix

之前我发布了一个问题，所以我可以在这里确认我们当前（尽管是过时的）Informix 版本：

[您如何识别 Solaris 上的 Informix 版本？](https://stackoverflow.com/questions/682154/how-do-you-identify-informix-version-on-solaris)

（感谢 Jonathan 和 RET 澄清了这一点）

我们肯定在计划升级，但首先讨论的是此时迁移到 Oracle 或 Sybase 是否更有意义。您对此有何看法？我相信虽然所有 3 种 RDBM 都有自己的独特性，但它们本质上都必须涵盖相同的领域。那么如何决定使用什么数据库呢？

最大的问题是我需要知道如果我们升级 Informix（目前使用 7.13），我们是否需要修改我们的嵌入式 sql C 程序？如果不是，那么坚持使用 Informix 就很有意义。因为如果我们使用 Sybase/Oracle 等，我们将有很多工作要做来更新后端程序。

但是如果切换到另一个数据库可以提供比较大的回报，那么我们仍然会考虑它。我期待听到您的意见。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T23:12:50.500

我是一个有偏见的观察者（我在 Informix 上为 IBM 工作） - 谨慎对待我的评论。

如果您的应用程序是用 Informix ESQL/C 编写的，那么您必须进行大手术才能将它们迁移到其他系统。您需要决定使用哪个替代接口 - 您的跨平台选择（以 C 作为基本语言）是 ODBC，但 Oracle 提供了 OCI，而 Sybase 提供了 TDS 作为替代方案。

相比之下，使用 Informix ESQL/C，升级到当前版本（Informix ClientSDK 3.50，包含 ESQL/C 3.50，*比*您当前使用的 ESQL/C 6.00 更新）应该很轻松，除非您已经外出你写坏代码的方式。

即使只是简单地迁移数据也可能有点创伤——并非无法克服。在某种程度上，复杂性取决于您使用的数据类型。（字符串很容易迁移；例如，日期和时间值不太容易。）但是，正如您所说，迁移应用程序需要大量工作，除非您非常有先见之明并编写了一个非常好的数据抽象层。

升级到 Informix SE 7.26 将不费吹灰之力 - 获取软件，安装它，将其指向您现有的数据库。您可能希望重新编译您的程序以使用更现代的 CSDK，但您可以谨慎地逐步执行此操作（两个 INFORMIXDIR 值，一个用于旧代码，一个用于新代码）。

升级到 Informix Dynamic Server (IDS) 11.50 需要您从 SE 导出数据 (DB-Export) 并将其导入 (DB-Import) 到 IDS。一旦 IDS 启动并运行，这也将非常简单。启动和运行 IDS 比 SE 需要更多的努力，但并不是那么难。

显然，我的建议是继续使用 Informix。当然，决定权在你。

* * *

> 使用 IDS，我们是否必须进行代码更改或只是重新编译？

IDS 与 SE 密切相关，但又有所不同。IDS 提供了几乎严格的 SE 功能超集。我能想到的存在差异的地方主要是边缘情况：

*   SE 为 CREATE TABLE 提供了额外的语法来定位数据库的 C-ISAM 文件；IDS 有一组完全不同的扩展。基本的 CREATE TABLE 是相同的（尽管 IDS 具有 SE 没有的类型，例如 VARCHAR），但装饰不同。
*   SE 有 CREATE AUDIT 和 DROP AUDIT 而 IDS 没有（它有其他审计设施）。
*   SE 有 START DATABASE 和 ROLLFORWARD DATABASE；IDS 没有（恢复和登录 IDS 是不同的）。

可能导致问题的主要领域是事务管理。IDS 具有未记录、记录和“LOG MODE ANSI”数据库，SE 也是如此。在 IDS 中，我们鼓励您使用已记录的数据库——强烈建议您这样做。IDS 在记录的数据库中提供原子语句——语句作为一个整体工作或作为一个整体失败。然而，许多 SE 应用程序在编写时并没有考虑到事务。当数据库上有事务时，有些事情是不能做的，例如在事务范围之外打开游标进行更新。这就是从 SE 迁移到 IDS 的代码。此外，您不能在事务中锁定表，并且不能通过 COMMIT 或 ROLLBACK 解锁表。

这将有多少问题取决于您在 SE 中使用的内容以及程序的设计方式（如果它们是设计的而不是放在一起的）。IDS 未记录数据库和 SE 未记录数据库非常接近 - 您可以从一个迁移到另一个。但是 IDS 只有在记录数据库时才能执行操作（如复制），并且您应该以使用记录数据库为目标。

然而，迁移到 CSDK 3.50 应该只是重新编译，除非你已经设法做了一些非常可怕的事情。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-31T04:04:08.163

Informix 消亡的谣言被大大夸大了。

随着您对嵌入式代码的投资，从切换到品牌 O 或品牌 S 所带来的任何明显的标价成本节省将很快在重新开发成本中消失。这只是生活中的事实：我已经看到项目在重建上花费了 10 万美元以上，以每年节省 2 万美元的许可费用。那不是钱花得好。

您会非常非常确定 RDBMS 的转换将提供一些您确实无法坚持现有的东西。因为风险（来自痛苦的经历——我与它进行了长期而艰苦的斗争）是如果不倒退的话，你可能会花费大量的金钱和时间来当场奔跑。

如果您要退后一步从整体上看待您的问题，我认为您最好评估更新的、松散耦合的、与数据库无关的架构的可能性，而不是将一个嵌入式模型换成另一个。这将为您提供更大的灵活性。

希望有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-12-01T21:59:48.563

多年来，我们一直使用 GeneXus 支持 Informix DB。Informix 是一个很棒的数据库，但它周围没有很多工具可以帮助以敏捷的方式构建。我知道许多只使用 GeneXus IDE 来构建 Web 应用程序和智能手机应用程序的 Informix 商店。如果您还没有听说过 GeneXus，请查看。

# sql - 逗号分隔值 - 问题

> ID：697087
> 
> 赞同：0
> 
> 时间：2009-03-30T12:59:34.810
> 
> 标签：sql

[**我之前**](https://stackoverflow.com/questions/696675/comma-separated-values)问过一个问题并收到了这个答案：

```
SELECT  table1.id, GROUP_CONCAT(table2.values)
FROM    table1
INNER JOIN
        table2
ON      FIND_IN_SET(table2.id, table1.nos)
GROUP BY
        table1.id 
```

但是我还有另一个字段`nos1`（具有多个值）`table1`也指向`table2`，我像这样使用它：

```
 SELECT  table1.id, GROUP_CONCAT(table2.values),GROUP_CONCAT(table2.values)
 FROM table1  INNER JOIN table2 ON
 FIND_IN_SET(table2.id, table1.nos),
 INNER JOIN table2 ON
 FIND_IN_SET(table2.id, table1.nos1),
 GROUP BY table1.id 
```

，但它不能正常工作。我不知道如何在这种情况下使用。

这是我的数据和所需的结果集：

表格1：

```
id:   no              nos1

1     14,15,16        17,18 
```

表2：

```
id     value

14     PHP 
15     JAVA       
16     C++  
17     mysql  
18     mysql server 
```

输出：

```
id     no               nos1

1      PHP, JAVA, C++   mysql, mysql server 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T13:10:14.317

```
SELECT  table1.id,
        (
        SELECT  GROUP_CONCAT(table2.values)
        FROM    table2
        WHERE   FIND_IN_SET(table2.id, table1.no)
        ) AS no,
        (
        SELECT  GROUP_CONCAT(table2.values)
        FROM    table2
        WHERE   FIND_IN_SET(table2.id, table1.nos1)
        ) AS nos1
FROM    table1 
```

# delphi - 如何快速验证区分大小写的文件名是否真的存在

> ID：697093
> 
> 赞同：3
> 
> 时间：2009-03-30T13:00:54.073
> 
> 标签：delphi

我必须制作一个与 unix 兼容的 windows delphi 例程，以确认文件系统中是否存在与所需文件完全相同的 CaSe 文件名，例如“John.txt”在那里，而不是“john.txt”。

如果我检查 "FileExists('john.txt')" 对于 John.txt 和 JOHN.TXT 由于 windows 总是如此。

如何创建“FileExistsCaseSensitive(myfile)”函数来确认文件确实是它应该是的。

DELPHI Sysutils.FileExists 使用以下函数来查看文件是否存在，如何将其更改为仔细检查文件系统上的文件名是否为小写并存在：

```
function FileAge(const FileName: string): Integer;
var
  Handle: THandle;
  FindData: TWin32FindData;
  LocalFileTime: TFileTime;
begin
  Handle := FindFirstFile(PChar(FileName), FindData);
  if Handle <> INVALID_HANDLE_VALUE then
  begin
    Windows.FindClose(Handle);
    if (FindData.dwFileAttributes and FILE_ATTRIBUTE_DIRECTORY) = 0 then
    begin
      FileTimeToLocalFileTime(FindData.ftLastWriteTime, LocalFileTime);
      if FileTimeToDosDateTime(LocalFileTime, LongRec(Result).Hi,
        LongRec(Result).Lo) then Exit;
    end;
  end;
  Result := -1;
end; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-30T13:17:15.050

```
function FileExistsEx(const FileName: string): Integer;
var
  Handle: THandle;
  FindData: TWin32FindData;
  LocalFileTime: TFileTime;
begin
  Handle := FindFirstFile(PChar(FileName), FindData);
  if Handle <> INVALID_HANDLE_VALUE then
  begin
    Windows.FindClose(Handle);
    if (FindData.dwFileAttributes and FILE_ATTRIBUTE_DIRECTORY) = 0 then
    begin
      FileTimeToLocalFileTime(FindData.ftLastWriteTime, LocalFileTime);
      if FileTimeToDosDateTime(LocalFileTime, LongRec(Result).Hi, LongRec(Result).Lo) then
        if AnsiSameStr(FindData.cFileName, ExtractFileName(FileName)) then Exit;
    end;
  end;
  Result := -1;
end; 
```

* * *

汤姆，我也对你的用例很感兴趣。我倾向于同意 Motti 的观点，即它会违反直觉，并且可能会让您的用户感到奇怪。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-30T13:22:28.687

在 Windows 上，文件名不区分大小写，因此我看不出将文件名视为区分大小写可以得到什么。

在任何情况下，您都不能命名两个文件`"John.txt"`并且`"john.txt"`无法找到`"John.txt"`何时`"john.txt"`存在可能会导致用户非常困惑。

试图在这种情况下强制区分大小写是不直观的，我看不到它的可行用例（如果你有一个，我会很高兴听到它是什么）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T13:09:31.060

我前段时间处理过这个问题，即使我**确定**那里有更简洁的解决方案，我最终还是会使用区分大小写的字符串比较器...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T13:09:54.770

我在使用 Java 时遇到了类似的问题。最终，我拉出了一个目录内容列表（它为每个文件加载了正确的文件名大小写），然后对每个文件的文件名进行字符串比较。

这是一个丑陋的黑客，但它有效。

编辑：我尝试做 Banang 描述的事情，但至少在 Java 中，如果你打开文件“a.txt”，即使底层文件系统将其命名为“A.txt”，程序也会顽固地将其报告为“a.txt” ”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T13:18:32.970

您可以使用 Delphi 的 FindFirst 和 FindNext 例程来实现 Kris 提到的方法。

看[这篇文章](http://www.delphibasics.co.uk/RTL.asp?Name=FindFirst)

# javascript - 如何自定义此 javascript 函数？

> ID：697096
> 
> 赞同：1
> 
> 时间：2009-03-30T13:01:54.307
> 
> 标签：javascript

我有这个阻止特殊字符的javascript函数......

```
function validaTexto(texto)
{
    !(/^[A-zÑñ0-9]*$/i).test(texto.value) ? texto.value = texto.value.replace(/[^A-zÑñ0-9]/ig, '') : null;
} 
```

问题是这个函数不允许我输入空格......我怎样才能自定义这个函数来允许我做一些其他的事情，比如空格，“，”，“。” , ";" 等等？

谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T13:03:31.713

将正则表达式更改为：

```
!(/[^A-zÑñ0-9 ,\.;]*$/i) 
```

此外，该函数非常多余，因为它检查字符串两次，基本上是说“字符串是否包含这些字符中的任何一个？是的？好的，所以在字符串中搜索这些相同的字符并将它们删除。只需将其更改为：

```
function validaTexto(texto) {
    texto.value.replace(/[^a-zñ0-9 ,\.;]/ig, '');
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T13:03:31.510

```
function validaTexto(texto) {
    texto.value.replace(/[^A-z0-9 ,\.;]/ig, '');
} 
```

参考（附例子）：

*   [http://www.regular-expressions.info/](http://www.regular-expressions.info/)
*   [http://regexlib.com/](http://regexlib.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T13:04:59.213

阅读这篇文章：

[正则表达式：允许字母、数字和空格（至少包含一个字母或数字）](https://stackoverflow.com/questions/576196/regular-expression-allow-letters-numbers-and-spaces-with-at-least-one-letter)

通过一些努力，您应该能够修改您的正则表达式来做您需要的事情。

# c# - 将事务包装在使用中——需要手动关闭它吗？

> ID：697098
> 
> 赞同：0
> 
> 时间：2009-03-30T13:02:59.810
> 
> 标签：c#, nhibernate

我在通过 nhibernate 访问数据库时有以下代码：

```
 ISessionFactory factory =
new NHibernate.Cfg.Configuration().Configure().BuildSessionFactory();

            using (ISession session = factory.OpenSession())
            {

                ICriteria sc = session.CreateCriteria(typeof(Site));
                siteList = sc.List();
                session.Close();
            }
            factory.Close(); 
```

我想知道是否可以用这种方式包装它：

```
 using (var factory= new NHibernate.Cfg.Configuration().Configure().BuildSessionFactory())
        {
            var session = factory.OpenSession();
            ICriteria sc = session.CreateCriteria(typeof(Site));
            siteList = sc.List();

        } 
```

据我了解， using() 块内的所有连接都将自动关闭。所以我猜第二个陈述完全等同于第一个。

我对吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T13:31:50.070

这是你通常做的：

```
 using (ISession session = factory.OpenSession()) {

            ICriteria sc = session.CreateCriteria(typeof(Site));
            siteList = sc.List();
        } 
```

但是，您只打开一次构建您的工厂 - 在应用程序开始时。您不应该真正打扰关闭它（除非某些特定情况），因为它是应用程序端清理它。

你的工厂通常位于一个明确定义的地方——作为一个单身人士。

为了帮助您理解 - 使用只是 c# 构造，它等于以下内容：

```
try {
   ISession session = sf.OpenSession();
   .....
} finally {
   session.Dispose();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T13:06:33.017

您的第二个代码示例至少有一个不好的做法：您正在构建 SessionFactory，然后将其销毁。所以，我假设您每次需要会话时都构建您的 SessionFactory ？

建造工厂是相当昂贵的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T13:25:31.380

是的。如果 Session 对象实现[IDisposable](http://msdn.microsoft.com/en-us/library/system.idisposable.aspx)，那应该是它的语义。如果不是这样，NHibernate 就被设计破坏了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T13:27:17.117

```
var factory= new NHibernate.Cfg.Configuration().Configure().BuildSessionFactory()) 
```

看看[http://en.wikipedia.org/wiki/Principle_of_least_knowledge](http://en.wikipedia.org/wiki/Principle_of_least_knowledge)以及为什么这个代码片段是代码异味。尝试从您的客户端代码中包装/封装此类构造代码。也许通过将 ISessionFactory 作为参数提供给类的构造函数。

# iphone - 测试 NSURLConnection 与 HTTP 响应错误状态的使用

> ID：697108
> 
> 赞同：22
> 
> 时间：2009-03-30T13:04:58.853
> 
> 标签：iphone, objective-c, cocoa-touch, ocmock

我正在编写一个需要从 Web 服务器获取一些数据的 iPhone 应用程序。我`NSURLConnection`用来执行 HTTP 请求，效果很好，但是在响应具有 HTTP 错误代码（如 404 或 500）的情况下，我无法对代码进行单元测试。

我使用[GTM](http://code.google.com/p/google-toolbox-for-mac/)进行单元测试，使用[OCMock](http://www.mulle-kybernetik.com/software/OCMock/)进行模拟。

当服务器返回错误时，连接不会调用`connection:didFailWithError:`委托，而是调用`connection:didReceiveResponse:`, `connection:didReceiveData:`, and `connectionDidFinishLoading:`。我目前正在检查响应中的状态代码，并在状态代码看起来像错误时`connection:didReceiveResponse:`调用连接以防止被调用，从而报告成功的响应。`cancel``connectionDidFinishLoading:`

提供静态存根`NSURLConnection`很简单，但我希望我的测试在调用模拟连接的方法之一时改变它的行为。具体来说，我希望测试能够判断代码何时调用`cancel`了模拟连接，因此测试可以停止调用`connection:didReceiveData:`和`connectionDidFinishLoading:`委托。

有没有办法让测试判断是否`cancel`已在模拟对象上调用？有没有更好的方法来测试使用的代码`NSURLConnection`？有没有更好的方法来处理 HTTP 错误状态？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-04-24T14:49:13.950

> 有没有更好的方法来处理 HTTP 错误状态？

我认为你在正确的轨道上。我使用类似于以下代码的东西，我在[这里](http://www.gigliwood.com/weblog/Cocoa/Q__When_is_an_conne.html)找到了：

```
if ([response respondsToSelector:@selector(statusCode)])
{
    int statusCode = [((NSHTTPURLResponse *)response) statusCode];
    if (statusCode >= 400)
    {
        [connection cancel];  // stop connecting; no more delegate messages
        NSDictionary *errorInfo
          = [NSDictionary dictionaryWithObject:[NSString stringWithFormat:
            NSLocalizedString(@"Server returned status code %d",@""),
            statusCode]
                                        forKey:NSLocalizedDescriptionKey];
        NSError *statusError
          = [NSError errorWithDomain:NSHTTPPropertyStatusCodeKey
                                code:statusCode
                            userInfo:errorInfo];
        [self connection:connection didFailWithError:statusError];
    }
} 
```

这会取消连接，并调用`connection:didFailWithError:`以使 http 错误代码的行为与任何其他连接错误完全相同。

# apache-flex - 在 itemRenderer 中设置标签宽度 - FLEX

> ID：697111
> 
> 赞同：0
> 
> 时间：2009-03-30T13:05:19.790
> 
> 标签：apache-flex, label, itemrenderer

我正在 Datagrid itemRenderer（从 UIComponent 扩展）中创建一个标签，现在我正在将标签的宽度设置为某个静态值。我想创建 100% 宽度的标签。我不想使用 unScaledWidth，因为我正在使用链接作为标签，因此链接将在整个单元格中可见。

我在这里先向您的帮助表示感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-30T16:59:19.977

我在这里遗漏了什么还是你应该简单地使用`percentWidth`？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-04-15T15:01:56.657

使用 percentWidth 将不起作用。如果您在 ItemRenderer 中只有 a `Label`，请确保 Label 具有（如果是 mx 项目渲染器）`autolayout="true"`（这是默认设置）并添加`top="0" left="0" right="0" bottom="0"`到`Label`. 这将使您的标签占据整个单元格。

如果您使用的是 Spark 项目渲染器，则 none 的默认布局是绝对布局，只需添加`top="0" left="0" right="0" bottom="0"`到`Label`应该就足够了。

另一方面，updateDisplayList() 和 measure() 是 Fl​​ex 中使用最频繁的两个覆盖。在尝试覆盖 updateDisplayList() 和 measure() 之前，请始终尝试使用 MXML 皮肤类解决您的问题。大多数 MX 类绘图方法在执行大部分绘图的方法中实现不正确，`private`这使得扩展这些类变得困难。

# design-patterns - 设计模式，有没有推荐的模式供大三学生尝试应用，为什么？

> ID：697118
> 
> 赞同：1
> 
> 时间：2009-03-30T13:07:16.213
> 
> 标签：design-patterns

我注意到最近几周，经验丰富的程序员不经常讨论“编码”问题，而是讨论设计问题。我真的很喜欢学习这些模式，我知道 OO 编程和设计的概念，我已经在日常工作中应用了大量这些原则，我尝试保持我的组件模块化、可重用，并且每个组件都有一个明确的、明确的职责。最近有人建议我开始学习各种设计模式（顾问推荐[代码完整](https://rads.stackoverflow.com/amzn/click/com/0735619670)作为开始），他提到了一些流行模式的名称（如 MVC、SingleTon 等）。所以大师！我应该如何开始学习这些模式？

**编辑：**
由于详细的解释，我想我很想给 Saua 点

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-30T13:12:26.543

1.  了解它们（我个人喜欢[C2 Wiki](http://c2.com/cgi/wiki?DesignPatterns)，其他人可能会建议四人组的[“设计模式” ）](https://rads.stackoverflow.com/amzn/click/com/0201633612)
2.  应用它们
3.  严重误用它们（主要候选人：singelton）
4.  了解为什么数字 3 是一个错误
5.  学会正确应用它们

这更像是一份观察报告，而不是一份指导清单；-)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-30T13:19:37.477

“ [Head-First Design Patterns](http://www.codinghorror.com/blog/archives/000380.html) ”可能是一种有趣的开始方式（也可以查看链接上的讨论）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-30T13:11:25.703

你从阅读设计模式这本书开始

[![替代文字](https://i.stack.imgur.com/Brs7J.png)](https://i.stack.imgur.com/Brs7J.png)
[（来源：[codinghorror.com](http://www.codinghorror.com/blog/images/design-patterns-book-cover.png)）]

然后你开始一个小项目，尝试一下。没有比尝试更好的学习方法了。添加几个朋友以获得更好的结果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T13:17:02.397

尽管 Code Complete 是一本优秀的书（在我看来它绝对是必备书），但它并不是学习模式的最佳书籍。

如果你想了解模式，一本好书是四人组的[设计模式书。](https://rads.stackoverflow.com/amzn/click/com/0201633612)它是对一些常用设计模式的参考。

至于您提到的模式：我将 MVC 模式更多地视为一种架构模式而不是设计模式，因为它影响整个系统（架构）的结构，而不是更孤立的一段代码。单例（不是单例）是一种容易掌握的模式，虽然它被过度使用并且它的缺点经常被忽视，所以我不建议从它开始（或者至少，阅读它，了解它背后的想法，但是不要只是为了使用它而开始在任何地方应用它——你通常并不*需要*它）。

很难推荐一个开始的模式，但我认为工厂方法、命令和策略并不难学，但我相信其他人可能不同意。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T13:11:40.227

从四人组开始：[http](https://rads.stackoverflow.com/amzn/click/com/0201633612) ://www.amazon.com/Design-Patterns-Object-Oriented-Addison-Wesley-Professional/dp/0201633612/ref=pd_bbs_sr_1?ie=UTF8&s=books&qid=1238418597&sr=8-1 。有点过时但是..

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-30T13:28:49.810

除了这里提到的书籍之外，请查看[此](http://www.dofactory.com/Patterns/Patterns.aspx)站点以获取一些带有很好示例的理论。

# wpf - WPF 3D - 为什么我的 ImageBrush 不渲染？

> ID：697120
> 
> 赞同：3
> 
> 时间：2009-03-30T13:08:01.123
> 
> 标签：wpf, 3d, visualbrush, imagebrush

我有一个 3D 平面，我正在尝试使用 ImageBrush 进行渲染，因为它是 DiffuseMaterial.Brush。如果我使用 SolidColorBrush，那么飞机看起来很好，但使用 ImageBrush 或 VisualBrush 我什么也得不到。

谁能告诉我为什么？这是代码。

```
<ModelVisual3D>
        <ModelVisual3D.Transform>
            <RotateTransform3D CenterX="0" CenterY="0" CenterZ="0">
                <RotateTransform3D.Rotation>
                    <AxisAngleRotation3D Axis="0 1 0" Angle="90"/>
                </RotateTransform3D.Rotation>
            </RotateTransform3D>
        </ModelVisual3D.Transform>
        <ModelVisual3D.Content>
            <GeometryModel3D>
                <GeometryModel3D.Geometry>
                    <MeshGeometry3D x:Name="frontmesh" TriangleIndices="
                                    0 1 2
                                    2 3 0">
                        <MeshGeometry3D.Positions>
                            <MultiBinding Converter="{StaticResource front}">
                                <Binding ElementName="UC" Path="CubeHeight" />
                                <Binding ElementName="UC" Path="CubeWidth" />
                                <Binding ElementName="UC" Path="CubeDepth" />
                            </MultiBinding>
                        </MeshGeometry3D.Positions>
                    </MeshGeometry3D>
                </GeometryModel3D.Geometry>
                <GeometryModel3D.Material>
                    <DiffuseMaterial>
                        <DiffuseMaterial.Brush>
                            <ImageBrush ImageSource="CF.jpg" 
                                        AlignmentX="Center" AlignmentY="Center" 
                                        Stretch="Fill"/>

                        </DiffuseMaterial.Brush>
                    </DiffuseMaterial>
                </GeometryModel3D.Material>
            </GeometryModel3D>
        </ModelVisual3D.Content>
    </ModelVisual3D> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-30T15:07:48.327

知道了，

我需要为要渲染的画笔提供贴图坐标。MeshhGeometry3D 现在看起来像这样 -

```
<MeshGeometry3D x:Name="frontmesh" TriangleIndices="
                                    0 1 2
                                    2 3 0"
                                    TextureCoordinates="0 1,1 1,1 0 ,0 0">
                        <MeshGeometry3D.Positions>
                            <MultiBinding Converter="{StaticResource front}">
                                <Binding ElementName="UC" Path="CubeHeight" />
                                <Binding ElementName="UC" Path="CubeWidth" />
                                <Binding ElementName="UC" Path="CubeDepth" />
                            </MultiBinding>
                        </MeshGeometry3D.Positions>
                    </MeshGeometry3D> 
```

# java - 使用ajax调用JMS

> ID：697121
> 
> 赞同：0
> 
> 时间：2009-03-30T13:08:13.107
> 
> 标签：java, ajax, jsp, jms

嗨，我有以下代码：

page1.jsp 点击按钮时调用的ajax函数

```
function ajaxFunction()
{
var xmlHttp;
xmlHttp = new ActiveXObject("Msxml2.XMLHTTP");
xmlHttp.onreadystatechange=function()
    {
    if(xmlHttp.readyState==4)
      {
alert("Data loaded");
      }
    }
  xmlHttp.open("GET","page2.jsp",true);
  xmlHttp.send(null);
} 
```

page2.jsp

```
<%@ page import="javax.jms.*" %>

<%!
private QPublisher qPublisher = null;
public class QPublisher {

        private  TopicPublisher publisher = null;
        private  TopicSession   session   = null;
        public void configPublisher(){
               TopicConnectionFactory factory = null;
               TopicConnection connection = null;
                try {
                        factory = new com.tibco.tibjms.TibjmsTopicConnectionFactory("tcp");
                        connection = factory.createTopicConnection("user","pwd");
                session = connection.createTopicSession(false,javax.jms.Session.AUTO_ACKNOWLEDGE);
                javax.jms.Topic topic = session.createTopic("topic1");
                publisher = session.createPublisher(topic);
                } 
        }

        public void publish(String msg)
        {

                        javax.jms.TextMessage message = session.createTextMessage();
                        message.setText(msg);
                        publisher.publish(message);
            }
}
public void jspInit(){
        qPublisher = new QPublisher();
        qPublisher.configPublisher();
}
%>

<%
qPublisher.publish("This is a test for TT");
%> 
```

如果我在不使用 ajax 的情况下调用 page2.jsp，即从 page1.jsp 使用

```
<form action="page2.jsp"> 
```

消息由订阅者选择并显示。

但不是通过制作ajax ..

我对ajax有基本的了解，所以请指导我缺少什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-01T15:54:59.307

您确定 Ajax 代码成功调用了 page2.jsp 吗？为了验证这一点，您可以简单地将 JMS 相关代码替换为更简单的代码，只需一个在客户端显示“Hello World”的 JSP 命令即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T18:32:35.183

我知道这并不能真正回答您的问题，但如果您不太习惯使用严格的 JSP 和 JMS，您可能需要研究为您提供管道的框架。

例如，这是一个关于[如何在 40 分钟内使用 Grails 构建 twitter](http://skillsmatter.com/podcast/java-jee/javawug-bof-44)的演示*视频*。该演示文稿由[Graeme Rocher](http://twitter.com/graemerocher) [twitter] - G2One 的 CTO，现在归 Spring Source 所有。在演示中，Graeme 创建了一个功能齐全、支持**AJAX**、可搜索、安全、基于**JMS**的 twitter 克隆。

 ****我确信其他 Web 框架也有类似的示例。

就像有人曾经说过的那样——“不要重新发明轮子，除非你*真的*有兴趣学习很多关于轮子的低级细节”

# pdf - 使用 ColdFusion 和 iText 将动态图像添加到 PDF

> ID：697122
> 
> 赞同：4
> 
> 时间：2009-03-30T13:08:53.417
> 
> 标签：pdf, coldfusion, itext

[我拼凑了一些代码，使用ColdFusion](http://www.adobe.com/products/coldfusion/)和[iText](http://www.lowagie.com/iText/)将动态图像插入 PDF ，同时还填写了一些表单字段。在我让它工作并在博客上写下它之后，我不禁想到可能有更好的方法来实现这一点。我现在在生产应用程序中使用这个的基本思想，所以任何意见或建议都会受到欢迎。

```
<cfscript>
// full path to PDF you want to add image to
readPDF = expandpath(”your.pdf”);
// full path to the PDF we will output. Using creatUUID() to create
// a unique file name so we can delete it afterwards
writePDF = expandpath(”#createUUID()#.pdf”);
// full path to the image you want to add
yourimage = expandpath(”dynamic_image.jpg”);

// JAVA STUFF!!!
// output buffer to write PDF
fileIO = createObject(”java”,”java.io.FileOutputStream”).init(writePDF);
// reader to read our PDF
reader = createObject(”java”,”com.lowagie.text.pdf.PdfReader”).init(readPDF);
// stamper so we can modify our existing PDF
stamper = createObject(”java”,”com.lowagie.text.pdf.PdfStamper”).init(reader, fileIO);
// get the content of our existing PDF
content = stamper.getOverContent(reader.getNumberOfPages());
// create an image object so we can add our dynamic image to our PDF
image = createobject(”java”, “com.lowagie.text.Image”);
// get the form fields
pdfForm = stamper.getAcroFields();
// setting a value to our form field
pdfForm.setField(”our_field”, “whatever you want to put here”);
// initalize our image
img = image.getInstance(yourimage);
// centering our image top center of our existing PDF with a little margin from the top
x = (reader.getPageSize(1).width() - img.scaledWidth()) - 50;
y = (reader.getPageSize(1).height() - img.scaledHeight()) / 2 ;
// now we assign the position to our image
img.setAbsolutePosition(javacast(”float”, y),javacast(”float”, x));
// add our image to the existing PDF
content.addImage(img);
// flattern our form so our values show
stamper.setFormFlattening(true);
// close the stamper and output our new PDF
stamper.close();
// close the reader
reader.close();
</cfscript>
<!— write out new PDF to the browser —&gt;
<cfcontent type=”application/pdf” file = “#writePDF#” deleteFile = “yes”&gt; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T22:42:43.510

`<cfpdf>`+ DDX 似乎是可能的。

[请参阅 http://forums.adobe.com/thread/332697](http://forums.adobe.com/thread/332697)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-04T12:25:15.293

我用 itext 库以另一种方式做到了，我不想用要插入的图像覆盖我现有的 pdf，所以只需修改插入图像的原始 pdf，只需使用 itext 插入对我不起作用。

因此，我必须将图像插入空白 pdf ( [http://itextpdf.com/examples/iia.php?id=59](http://itextpdf.com/examples/iia.php?id=59) )，然后加入我的原始 pdf 和新的 pdf-image。获取一份包含多页的 pdf。（[http://itextpdf.com/examples/iia.php?id=110](http://itextpdf.com/examples/iia.php?id=110)）

之后，您可以用这个很酷的概念覆盖 pdf 页面 [http://itextpdf.com/examples/iia.php?id=113](http://itextpdf.com/examples/iia.php?id=113)

# asp-classic - 从经典 ASP 到 ASP.NET 的转换

> ID：697123
> 
> 赞同：1
> 
> 时间：2009-03-30T13:09:07.317
> 
> 标签：asp-classic, migration

我必须将一些代码从经典 ASP 转换为 ASP.NET

1）我怎样才能最好地处理如下语法，它似乎失败了，因为代码在一个标签内，也可能是因为条件被分成了几个标签。

2) 有什么工具或指南适用于此类代码？

3) 经典 ADO。

```
 <li><a<% if "" = myFolder then %> class="selected"<% end if %> href="http://<%= SERVER_NAME %>/"><%= getLocale("Home") %></a></li>
            <% SQL = "SP_TOPNAV  '" & lang & "'"
            Set maNav = conn.execute(SQL)
            do while not maNav.EOF %>
                <li><a<% if maNav(0) = myFolder then %> class="selected"<% end if %> href="http://<%= SERVER_NAME %>/<%= maNav(0) %>"><%= maNav(1) %></a></li>
            <% maNav.MoveNext
            loop
            Set maNav = Nothing %>
            </ul> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T13:11:09.620

如果您使用 .net 2.0 查看可以绑定到数据源的 asp:repeater，如果您使用 .net 3.5 查看 asp:listview。这些控件使您能够遍历数据并生成标记，这本质上就是您所做的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T13:15:05.100

ASP.net 可以很好地处理几个 <%%> 标记之间的代码拆分。问题出在其他地方。请编辑您的问题以包含错误消息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T13:25:57.867

您始终可以使用 ASP.NET 的数据控件，例如`Repeater, GridView, DataList`显示项目集合。您可以通过修改**`ItemTemplate`**. 您也可以在其中包含渲染条件`ItemTemplate`。

例如：

```
 <asp:Repeater id="Repeater1" runat="server">

      <HeaderTemplate>
         <table border="1">
      </HeaderTemplate>

      <ItemTemplate>
         <tr>
            <td> <%# Container.DataItem %> </td>
         </tr>
      </ItemTemplate>

      <FooterTemplate>
         </table>
      </FooterTemplate>

   </asp:Repeater> 
```

取自：http: [//msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.repeater.itemtemplate.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.repeater.itemtemplate.aspx)

您始终可以在`<%# ... %>`文本中插入条件逻辑。或者如果逻辑很复杂，您可以将它们编码在代码隐藏文件中并从这里调用它们。

搜索“ASP.NET If inside ItemTemplate”或“ASP.NET Condition in ItemTemplate”了解更多信息。

# python - 如何为 Python 的 MD5 模块设置加密密钥？

> ID：697134
> 
> 赞同：1
> 
> 时间：2009-03-30T13:11:35.687
> 
> 标签：python, hash, md5, hmac

跟随 Perl 代码的 Python 等价物是什么？

```
hmac_md5_hex($login . "^" . $seq . "^" . $time . "^" . $amo . "^", $CryptoKey); 
```

Python hashlib.md5 似乎没有采用“加密密钥”参数。它只接受 1 个参数。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-30T13:16:13.867

您必须将[hmac 模块](http://docs.python.org/library/hmac.html)与 md5 或 sha 一起使用。默认情况下，它使用 md5：

```
In [1]: import hmac, hashlib
In [2]: hmac.new('key', 'msg').hexdigest()
Out[2]: '18e3548c59ad40dd03907b7aeee71d67'
In [3]: hmac.new('key2', 'msg').hexdigest()
Out[3]: 'a4bde113179bc2a7c6ac9ad7309ea073'
In [4]: hmac.new('key', 'msg', hashlib.sha256).hexdigest()
Out[4]: '2d93cbc1be167bcb1637a4a23cbff01a7878f0c50ee833954ea5221bb1b8c628' 
```

您的示例可能类似于：

```
hmac.new(CryptoKey, '^'.join([login, seq, time, amo]), hashlib.md5).hexdigest() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-30T13:19:21.690

看看[这个关于 hmac 的 python 库文档](http://docs.python.org/library/hmac.html)

你可能想要的是：

```
import hmac
hmac_object = hmac.new(crypto_key)
hmac_object.update('^'.join([login, seq, time, amo, ''])
print hmac_object.hexdigest() 
```

最好使用**.update()**，因为这样你就不必每次都实例化 hmac 类，如果你想要大量的十六进制消息摘要，它会大大提高性能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-03-01T15:19:54.400

另一种基于[PyCrypto](https://www.dlitz.net/software/pycrypto/)的解决方案：

```
from Crypto.Hash import HMAC
print HMAC.new(CryptoKey, '^'.join([login, seq, time, amo, ''])).hexdigest() 
```

# python - 当使用 Pydev 插件选择运行或调试时，如何配置 Eclipse 以启动浏览器

> ID：697142
> 
> 赞同：14
> 
> 时间：2009-03-30T13:14:05.917
> 
> 标签：python, eclipse, eclipse-plugin, pydev

我正在使用 Eclipse Pydev 插件学习 Python 和 Django。当我按下运行或调试时，我希望内部或外部浏览器使用 URL http:/127.0.0.1 启动或刷新。我已经看到它是用 PHP 插件完成的，但不是 Pydev。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-07-25T14:50:33.277

以下是设置外部启动配置以启动 IE 的步骤：

1.  选择**运行**->**外部工具**->**外部工具配置...**
2.  在左侧窗格中，选择**程序**，然后选择新图标（窗格上方最左侧的图标）。
3.  在右侧窗格中，选择**主**选项卡。
4.  在**名称：**字段中输入**launch_ie 。**
***   在**位置：**字段中输入**${system_path:explorer.exe} 。*****   在**参数**字段中输入**http:/127.0.0.1 。*****   要运行外部配置，请选择**Run**。******

 ****如果要共享配置，可以使用以下可选步骤：

6.  选择**常用**选项卡
7.  **在另存为**部分中选择**共享文件：**选项。
***   选择一个位置来保存配置（将其保存到一个空项目中可能是个好主意，因为您可以将其导入另一个工作区）**

 **要重新运行配置，您有几个选择：

1.  从菜单栏中选择外部工具图标，[![外部工具图标](https://i.stack.imgur.com/u0tVb.png)](https://i.stack.imgur.com/u0tVb.png) 然后单击**launch_ie**
2.  选择**运行**->**外部工具**->**启动即**
3.  按 Alt+R、E、1（假设 launch_ie 是列表中的第一项，否则选择适当的数字）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T20:53:11.507

项目属性（在左窗格中右键单击项目）

转到“运行/调试设置”，添加一个新的配置文件。设置您要启动的路径和环境等。新配置将显示在您的构建菜单中。您还可以将其配置为“外部工具”

# facebook - 有人对 Xbox 360 控制台历史导出项目有更多详细信息吗？

> ID：697150
> 
> 赞同：0
> 
> 时间：2009-03-30T13:17:59.230
> 
> 标签：facebook, xna, xbox360, xbox

最近，在 Charlotte 2009 Code Camp 上，有人告诉我一个项目/产品将导出 XBox 360 控制台的历史，然后为 XBox 创建某种日记或日志。

他并不真正了解细节，但他认为这需要 Xbox 控制台历史记录，然后将其转换为 Facebook 等社交网站之一。

所以它可能看起来像这样：

克里斯今天玩了 3 个小时的“光环战争”……更具体的细节，比如分数等。

我今天根本没有见到克里斯。希望他能尽快停下来。

克里斯今天玩了 2 个小时的“银河大战”……再次获得更多细节。

我不确定它是否会成为 Facebook 内容。它可能是博客、推特或其他任何东西。

我认为这是一个好主意，我想看看它，并希望它是开源的，因为那时我有一些自己的想法。

不管怎样，首先我需要找到它。到目前为止，我所有的搜索都是徒劳的。

如果您知道更多细节，请分享，因为我相信现在还有其他人很好奇。:D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T13:21:51.527

类似于[360 语音](http://360voice.gamerdna.com/)在做什么？

# flash - 有没有办法在 Flash 中将外部 swf 加载到沙箱中？

> ID：697155
> 
> 赞同：1
> 
> 时间：2009-03-30T13:18:54.763
> 
> 标签：flash, actionscript-3, sandbox

我正在使用 Loader 在我的全 Flash 网站中加载 Flash 广告横幅。我无法控制横幅内的代码，因为它们来自广告商。

我想加载它们，这样他们就无法在他们有限的区域之外搞乱网站上的鼠标事件。广告商横幅上的草率代码在任何情况下都不应该扼杀我网站的功能。

额外的问题，我该如何解决横幅与我的主站点的帧速率不同而导致的问题？（或者有没有一种简单的方法可以将当前绘制的动画转换为我的帧速率，同时保持动画速度与以前相同？）

以前一定有人处理过这些问题。

最好的方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T14:12:13.980

理论上，加载的 swf 在没有权限的情况下是无法访问父级的对象和变量的。[您可以在此处阅读有关 Security.allowDomain 的更多信息](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/system/Security.html#allowDomain())。除非您对横幅的域执行 allowDomain()，否则它将无法调用您网站中的对象。

您还可以执行以下一项或多项操作：

*   为横幅的 Loader 对象创建一个掩码，以防止横幅扩展超过其分配的空间

*   使用[mouseChildren](http://livedocs.adobe.com/flex/2/langref/flash/display/DisplayObjectContainer.html#mouseChildren)属性来禁用 Loader.content 对象的所有鼠标事件，然后在 Loader 上添加单击事件，以导航到横幅的目标页面

我自己玩过帧率，但无济于事。在所有情况下，孩子似乎都遵循父母的帧速率。唯一有效的是停止孩子的自动帧速率提前并通过 TimerEvent 来完成，但这会产生额外的处理器负载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T16:56:28.283

加载外部 swf 时，请确保将其加载到单独的安全域和子应用程序域中。这样它就无法访问舞台鼠标和键盘事件（以及某些其他事件），并且不会有任何类定义冲突。

查看此文档：[开发和加载子应用程序](http://www.scribd.com/doc/12990361/Developing-and-loading-subapplications)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-08-11T14:37:26.780

我刚刚找到了一个关于此的 Adob​​e PDF：[加载应用程序](http://livedocs.adobe.com/flex/3/loading_applications.pdf)。

# vbscript - 从 vbscript 修改 XP 主题（外观和配色方案）

> ID：697161
> 
> 赞同：2
> 
> 时间：2009-03-30T13:20:00.580
> 
> 标签：vbscript, windows-xp, installation, themes

有人知道如何使用 VBScript 修改 Windows XP 的外观和配色方案吗？

我有一个用 Visual C++ 编写的应用程序，需要正确显示 Windows XP 外观（不是经典），我想从安装中设置此属性。

我使用 InstallShield 来制作安装程序，并使用 VBScript 来执行一些自定义操作。因此，如果我可以在 Visual Basic 中创建一个脚本来更改此属性，那就太好了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T21:13:27.103

这应该这样做：

```
rundll32 shell32.dll,Control_RunDLL desk.cpl desk,@themes /Action:OpenTheme /File:"%WinDir%\Resources\Themes\Luna.theme" 
```

但是，您仍然需要让用户单击“确定”或使用其他实用程序为您执行此操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-23T18:53:16.907

如果您需要更改**个别外观选项**`HKEY_CURRENT_USER\Control Panel\Appearance`（如窗口颜色），您可以在和键下修改相应的注册表值`HKEY_CURRENT_USER\Control Panel\Colors`。例如，此代码会将窗口背景颜色更改为奶油色：

```
Set oShell = CreateObject("WScript.Shell")
oShell.RegWrite path & "HKCU\Control Panel\Colors\Window", "255 251 240", "REG_SZ" 
```

但是请注意，Windows 可能仅在重新启动后才会应用注册表更改。

如果需要**加载准备好的 .theme 文件**，可以使用以下代码：

```
Const Theme = "C:\MyTheme.theme"

Set oShellApp = CreateObject("Shell.Application")
oShellApp.ControlPanelItem "desk.cpl desk,@Themes /Action:OpenTheme /file:""" & Theme & """" 
```

虽然，正如 sascha 所指出的，这只会打开显示属性对话框并选择指定的主题；您仍然需要用户单击确定或按 Enter。[`WshShell.SendKeys`](http://msdn.microsoft.com/en-us/library/8c6yea83.aspx)可以使用以下方法从脚本代码模拟按键：

```
Set oShell = CreateObject("WScript.Shell")

' Wait until the Display Properties dialog is opened
While Not oShell.AppActivate("Display Properties")
  WScript.Sleep 500
Wend

' Send the Enter key to close the dialog and apply the theme
Do
  oShell.SendKeys "~"
  WScript.Sleep 500
Loop While oShell.AppActivate "Display Properties" 
```

但是这种方法是不可靠的，因为用户可以点击其他地方，所以 Enter 会转到另一个窗口。此外，“显示属性”对话框标题取决于区域设置。

另一种选择是使用`Theme.Manager`从 Windows XP SP1 开始的 themeui.dll 库提供的 API，但它似乎不适用于 XP SP2。[无论如何，您可以在此处](http://www.neowin.net/forum/lofiversion/index.php/t315426.html)找到示例代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-24T07:33:49.700

我所做的是创建一个 c++ dll，用作 Install Shield 中的自定义操作。在这个 dll 中，我使用 uxtheme.dll 将 luna.msstyle 文件设置为主题。这是完成工作的函数：

```
bool SetVisualStyle()
{
    TCHAR szUxTheme[MAX_PATH+1];
    UINT nSize = ::GetSystemDirectory(  szUxTheme,
                                        MAX_PATH);
    szUxTheme[nSize] = '\0';

    wcscat_s(   szUxTheme,
                MAX_PATH - nSize,
                L"\\uxtheme.dll");

    HMODULE hModule = ::LoadLibrary(szUxTheme);
    if(!hModule)
    {
        return false;
    }

    typedef int (__stdcall *SETVISUALSTYLE) (   LPCWSTR szTheme, 
                                                LPCWSTR szScheme, 
                                                LPCWSTR szFontType, 
                                                int nReserved);
    SETVISUALSTYLE pFnSetVisualStyle;
    pFnSetVisualStyle = (SETVISUALSTYLE)GetProcAddress( hModule,
                                                        MAKEINTRESOURCEA(LOWORD(65)));
    if(pFnSetVisualStyle)
    {
        pFnSetVisualStyle(  L"C:\\WINDOWS\\Resources\\Themes\\Luna\\luna.msstyles", 
                            L"NormalColor",
                            L"NormalSize",
                            1|32);
    }

    ::FreeLibrary(hModule);
    return true;
} 
```

它并不完美，但它可以满足我的需求。

我希望这可以帮助其他人......如果您有任何疑问，请不要犹豫问我。

干杯。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-01-28T13:19:23.370

```
'Script name: yourtheme.vbs

'Object: Automate without command prompt the application of a Windows Theme by a VB script

'

'SCRIPT CONTENTS:

'Define Variables : 

    Set ShellApp = CreateObject("Shell.Application")
    Set WsShell = CreateObject("Wscript.Shell")

'

'Define path for your file theme (put it on a network share and don't forget to apply "read and execute" ACL for your Users)

    Theme = "typeyoursharepath\typeyourtheme.theme"
    Theme = """" + Theme + """"

'Open Display Properties Windows, Select your theme and apply with keep focus on Windows

    ShellApp.ControlPanelItem cstr("desk.cpl desk,@Themes /Action:OpenTheme /file:" & Theme)
    Wscript.Sleep 100
    WsShell.SendKeys "{ENTER}"
    While WsShell.AppActivate ("Display Properties") = TRUE
    WsShell.AppActivate "Display Properties"
    Wend

'END OF SCRIPT 
```

在 Windows XP 和 Windows Server 2003R2 X86 上成功应用，在 Citix XenApp 4.6FP7（操作系统：W2003R2X86 SP2）下应用 Windows Embedded 主题，蓝色背景颜色更亮。

在 Citrix 会话用户上看起来很棒！

在 Citrix XenApp 下用户登录时集成在用户配置 GPO 中。

# mysql - 在桌面应用程序中使用 MySql 的各种可能性是什么

> ID：697164
> 
> 赞同：-1
> 
> 时间：2009-03-30T13:21:21.903
> 
> 标签：mysql, desktop, frontend

MySql 数据库可以用作桌面应用程序的后端吗？有哪些可能的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T13:26:21.907

我想说的是，每个桌面应用程序客户端都可以在客户端站点连接到集中式 mysql 数据库，或者可能连接到由您/您的公司管理的集中式服务器，就像[@Neil Butterworth](https://stackoverflow.com/questions/697164/what-are-the-various-possibilities-to-use-mysql-in-a-desktop-applicaion/697176#697176)提到的那样，有各种 API /methods 用于与数据库对话。但是，如果您希望在应用程序中嵌入数据库，我建议您改用[sqlite 。](http://www.sqlite.org/)它是一个小型、轻量级的关系数据库，旨在嵌入到应用程序中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T13:32:37.570

要添加到[nstehr 的答案](https://stackoverflow.com/questions/697164/what-are-the-various-possibilities-to-use-mysql-in-a-desktop-applicaion/697183#697183)，请参阅：

*   [SQLite 与 MySQL](https://stackoverflow.com/questions/3630/sqlite-vs-mysql)
*   [Sqlite 的可扩展性如何](https://stackoverflow.com/questions/54998/how-scalable-is-sqlite)
*   [数据库如何在内部工作](https://stackoverflow.com/questions/172925/how-do-databases-work-internally)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T13:43:29.463

是的，我不止一次这样做了。在 MySQL 中构建您的数据库，无论是在本地还是在远程机器上，然后使用适当的 API 设置与数据库的连接。

有一个用于连接 .NET 应用程序的包（只需搜索 .NET MySQL 库，它就会出现），使用 Java，您可以使用 Hibernate（或任何其他 ORM 框架）并将方言设置为您使用的任何 MySQL 版本在 hibernate.config 文件中使用。或者您可以直接使用 ODBC/JDBC。我相信其他语言也有自己的支持。

任何应用程序，如果构建得好，应该能够得到各种数据库的支持，并且不应该影响应用程序。在数据库之间切换最多应该涉及更改几个属性文件，然后测试特定于数据库的特性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T13:24:54.593

> MySql 数据库可以用作桌面应用程序的后端吗

是的，当然 - 就像任何其他数据库一样。

> 有哪些可能的方法来做到这一点？

你什么意思？你的意思是如何从应用程序访问数据库？很多方法 - 有些是：

*   通过其原生 C API
*   通过 ODBC
*   通过 JDBC

当然，您使用哪一种很大程度上取决于您的桌面应用程序是用哪种语言编写的。

# java - 在 Max OS X 上增加 SQuirreL SQL 的堆大小

> ID：697165
> 
> 赞同：8
> 
> 时间：2009-03-30T13:21:41.187
> 
> 标签：java, macos, squirrel-sql

我在 Max OS X 上运行 SQuirreL SQL (2.6.8)。

尝试创建 Table 脚本时，堆空间不足。

如何配置 SQuirreL SQL 以启动更高的 JVM 堆大小？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-04T08:13:08.560

假设您的 Dock 中有 SQuirreL，您可以执行以下操作：

2.  Cmd-单击 Dock 中的 SQuirreL 图标，Finder 窗口将打开，向您显示应用程序。

3.  左键单击 SQuirreL 应用程序并选择“显示包内容”

4.  导航到 Contents 文件夹并打开 Info.plist 文件

5.  将以下内容更改或添加到您的 Info.plist 文件中：

> ```
> <key>Java</key>   
>  <dict>
>     <key>VMOptions</key> 
>     <array> 
>         <string>-Xms128m</string> 
>         <string>-Xmx512m</string> 
>     </array> 
> </dict> 
> ```

在这里，您在最大 SQuirreL 的开始时间获得 128M。

保存 Info.plist 文件并重新启动应用程序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-30T14:03:01.290

我正在运行 Linux，所以你必须稍微调整一下这个答案，但它应该是适用的。

在安装程序 jar 创建的主目录中，您会找到一个名为“squirrel-sql.sh”的文件。该文件的最后一行是 java 启动 cmd。不确定 mac 启动配置，您可能需要在此目录中查找包含此行的文件。我的读

```
$JAVA -Xmx256m -cp $TMP_CP net.sourceforge.squirrel_sql.client.Main --log-config-file $SQUIRREL_SQL_HOME/log4j.properties --squirrel-home $SQUIRREL_SQL_HOME $1 $2 $3 $4 $5 $6 $7 $8 $9 
```

-Xmx256m 配置堆 - 它将最大堆大小设置为 256m。只需编辑文件以读取 -Xmx512m 或其他内容。（有关内存标志的列表，请在命令提示符下键入“java -X”）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-06-03T07:43:46.460

### SQuirreL SQL 客户端版本 3.7 - Windows

我有以下弹出窗口：

[![错误超出内存](https://i.stack.imgur.com/Qsd8A.png)](https://i.stack.imgur.com/Qsd8A.png)

> 查询结果已超过分配给此应用程序的最大内存量。所有结果选项卡都已关闭，以便您保存工作并重新启动应用程序。

以及控制台中的以下消息（错误选项卡）：

[![内存不足错误](https://i.stack.imgur.com/G97rC.png)](https://i.stack.imgur.com/G97rC.png)

> java.lang.OutOfMemoryError：超出 GC 开销限制
> 位置：0

### 解决方案

1.  右键单击 SQuirreL 图标 >**属性**

    [![松鼠图标](https://i.stack.imgur.com/DIylH.png)](https://i.stack.imgur.com/DIylH.png)

2.  复制**目标值**_

    [![松鼠目标](https://i.stack.imgur.com/nvq24.png)](https://i.stack.imgur.com/nvq24.png)

3.  在编辑器中打开该 .bat 文件并替换`-Xmx256m`为`-Xmx1024m`：

    ```
    start "SQuirreL SQL Client" /B "%LOCAL_JAVA%" -Xmx1024m -Dsun.awt.nopixfmt=true -Dsun.java2d.noddraw=true -cp %SQUIRREL_CP% -splash:"%SQUIRREL_SQL_HOME%/icons/splash.jpg" net.sourceforge.squirrel_sql.client.Main %TMP_PARMS% 
    ```

4.  保存并再次打开 SQuirreL SQL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-09T07:14:19.943

谢谢这对我有帮助，起初我将`squirrel-sql.bat`文件从`-Xmx256m`to编辑，`--Xmx1024m`但没有用，所以我将其更改为 -`-Xmx4096m`它有效。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2016-01-14T06:05:36.553

我在 Windows 8 Pro 机器上遇到了这种情况，我在根文件夹中找到了这个文件 squirrel-sql.sh 并编辑了以下参数：

-Xmx256m 到 --Xmx4096m

它完全解决了我的问题....！

# css - 仅使用 Firefox CSS 来圆角元素？

> ID：697169
> 
> 赞同：3
> 
> 时间：2009-03-30T13:23:06.597
> 
> 标签：css, firefox, rounded-corners

我刚刚注意到 Stack Overflow 仅使用 Firefox 的 CSS 来圆化首页上用户徽章的角落。这是一个有趣的想法，但仅使用 Firefox 的 CSS（除了那些明显的 CSS 之外）会有哪些缺陷和优势？

```
-moz-border-radius:6px;
-webkit-border-radius:6px; 
```

上图：用于在 Stack Overflow 首页上圆角的 CSS。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-30T13:33:24.090

如我所见，主要问题是您的CSS无法验证。除此之外，我认为没有理由不使用此类平台特定功能，因为它们不会对浏览器不支持这些功能的用户造成任何伤害。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-30T13:29:43.367

优点是它比使用角落图像或其他技巧要容易得多。明显的缺点是您的页面无法在 IE 上按预期呈现，世界上超过一半的网络用户仍在使用它。

总体而言，这是情境性的；我想 SO 使用 Firefox 的人比例比平时要高，所以 IE 问题不那么相关。圆角是一个小的视觉改进，所以如果有些人看到而有些人没有看到，这没什么大不了的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-30T18:21:57.097

我同意[牛肉火鸡](https://stackoverflow.com/questions/697169/using-firefox-only-css-to-round-corners-of-elements/697212#697212)。

我什至可以更进一步，将其称为[使用 CSS 进行渐进增强](http://www.alistapart.com/articles/progressiveenhancementwithcss)的案例。借用[理解渐进增强](http://www.alistapart.com/articles/understandingprogressiveenhancement)，我认为圆角是巧克力覆盖的花生周围彩色糖果涂层的一部分。

最终 CSS3 将被批准，[border-radius](http://www.w3.org/TR/css3-background/#the-border-radius)将被标准化。`-moz`,`-webkit`并且`-ms`前缀样式可以被删除并替换为它们的标准等效项。您的 CSS 将通过验证，使用不支持 CSS3 的浏览器的用户**仍将**获得完全可接受的体验，而使用支持 CSS3 的浏览器的用户将获得*增强*的体验。

或者，除了任何标准之外，您还可以继续使用专有的 CSS 来为更多的受众提供增强的体验。这实际上取决于维护所有 CSS 所需的工作量以及您认为增强体验对您的观众的重要性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T13:31:26.217

它适用于 Firefox 和基于 Webkit 的浏览器（尤其是 Safari 和 Chrome）。IE 或 Opera 没有替代品。

使用它的主要原因是当您想要为显示在图案或不可预测背景之上的元素提供圆角时，否则这是不可能的。普通的 CSS 和图像可以处理其他情况。

它也非常容易实现，并且肯定适用于该站点上超过一半的人。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-30T13:25:37.713

缺陷当然是它在其他浏览器中不受支持，并且不在 W3C 规范中。

当前的实现很糟糕（在 firefox 和 webkit 中），因为它们不共享语法。

# c# - 在 asp.net 中中继请求（转发请求）

> ID：697177
> 
> 赞同：40
> 
> 时间：2009-03-30T13:25:17.230
> 
> 标签：c#, .net, http, communication, forwarding

我有一个 Web 应用程序在两个不同的 Web 应用程序之间进行通信（一个接收者和一个发送者，发送者与我的应用程序通信，我的应用程序与两者通信）。

一个常规的场景是发送者向我的应用程序发送一个 HttpRequest，而我在一个 HttpHandler 中接收它。这反过来将 HttpContext 发送到一些业务逻辑以进行一些管道操作。

在我的业务类完成存储数据（一些日志记录等）之后，我想将包含所有标头、表单数据等的相同请求中继到接收器应用程序。这必须从类发送，而不是 HttpHandler。

问题是真的 - 我怎样才能获取一个 HttpContext 对象，并转发/中继完全相同的请求，只需将 URL 从[http://myserver.com/](http://myserver.com/)修改为[http://receiver.com](http://receiver.com)。

最好的 c# 中的任何代码示例都会很棒！

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-09-20T04:31:08.743

我有一个扩展方法`HttpResponseBase`可以将传入请求复制到传出请求。

用法：

```
 var externalRequest = (HttpWebRequest)WebRequest.Create("http://stackoverflow.com");
    this.Request.CopyTo(externalRequest);
    var externalResponse = (HttpWebResponse)externalRequest.GetResponse(); 
```

来源：

```
/// <summary>
/// Copies all headers and content (except the URL) from an incoming to an outgoing
/// request.
/// </summary>
/// <param name="source">The request to copy from</param>
/// <param name="destination">The request to copy to</param>
public static void CopyTo(this HttpRequestBase source, HttpWebRequest destination)
{
    destination.Method = source.HttpMethod;

    // Copy unrestricted headers (including cookies, if any)
    foreach (var headerKey in source.Headers.AllKeys)
    {
        switch (headerKey)
        {
            case "Connection":
            case "Content-Length":
            case "Date":
            case "Expect":
            case "Host":
            case "If-Modified-Since":
            case "Range":
            case "Transfer-Encoding":
            case "Proxy-Connection":
                // Let IIS handle these
                break;

            case "Accept":
            case "Content-Type":
            case "Referer":
            case "User-Agent":
                // Restricted - copied below
                break;

            default:
                destination.Headers[headerKey] = source.Headers[headerKey];
                break;
        }
    }

    // Copy restricted headers
    if (source.AcceptTypes.Any())
    {
        destination.Accept = string.Join(",", source.AcceptTypes);
    }
    destination.ContentType = source.ContentType;
    destination.Referer = source.UrlReferrer.AbsoluteUri;
    destination.UserAgent = source.UserAgent;

    // Copy content (if content body is allowed)
    if (source.HttpMethod != "GET"
        && source.HttpMethod != "HEAD"
        && source.ContentLength > 0)
    {
        var destinationStream = destination.GetRequestStream();
        source.InputStream.CopyTo(destinationStream);
        destinationStream.Close();
    }
} 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-03-31T06:39:47.587

实际上，这样的事情效果很好

```
HttpRequest original = context.Request;
HttpWebRequest newRequest = (HttpWebRequest)WebRequest.Create(newUrl);

newRequest .ContentType = original.ContentType;
newRequest .Method = original.HttpMethod;
newRequest .UserAgent = original.UserAgent;

byte[] originalStream = ReadToByteArray(original.InputStream, 1024);

Stream reqStream = newRequest .GetRequestStream();
reqStream.Write(originalStream, 0, originalStream.Length);
reqStream.Close();

newRequest .GetResponse(); 
```

编辑：ReadToByteArray 方法只是从流中创建一个字节数组

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-08-17T22:06:29.533

这是使用 MVC 在 VB.NET 中的一些很好的中继代码。

## 全球.ASAX.VB

```
Public Class MvcApplication
    Inherits System.Web.HttpApplication

    Shared Sub RegisterRoutes(ByVal routes As RouteCollection)
        routes.MapRoute("Default", "{*s}", New With {.controller = "Home", .action = "Index"})
    End Sub

    Sub Application_Start()
        RegisterRoutes(RouteTable.Routes)
    End Sub
End Class 
```

## 家庭控制器.vb

```
Option Explicit On
Option Strict On

Imports System.Net

<HandleError()> _
Public Class HomeController
    Inherits System.Web.Mvc.Controller

    Function Index(ByVal s As String) As ActionResult
        Server.ScriptTimeout = 60 * 60
        If Request.QueryString.ToString <> "" Then s = s + "?" + Request.QueryString.ToString
        Dim req As HttpWebRequest = CType(WebRequest.Create("http://stackoverflow.com/" + s), HttpWebRequest)
        req.AllowAutoRedirect = False
        req.Method = Request.HttpMethod
        req.Accept = Request.Headers("Accept")
        req.Referer = Request.Headers("Referer")
        req.UserAgent = Request.UserAgent
        For Each h In Request.Headers.AllKeys
            If Not (New String() {"Connection", "Accept", "Host", "User-Agent", "Referer"}).Contains(h) Then
                req.Headers.Add(h, Request.Headers(h))
            End If
        Next
        If Request.HttpMethod <> "GET" Then
            Using st = req.GetRequestStream
                StreamCopy(Request.InputStream, st)
            End Using
        End If
        Dim resp As WebResponse = Nothing
        Try
            Try
                resp = req.GetResponse()
            Catch ex As WebException
                resp = ex.Response
            End Try

            If resp IsNot Nothing Then
                Response.StatusCode = CType(resp, HttpWebResponse).StatusCode
                For Each h In resp.Headers.AllKeys
                    If Not (New String() {"Content-Type"}).Contains(h) Then
                        Response.AddHeader(h, resp.Headers(h))
                    End If
                Next
                Response.ContentType = resp.ContentType

                Using st = resp.GetResponseStream
                    StreamCopy(st, Response.OutputStream)
                End Using
            End If
        Finally
            If resp IsNot Nothing Then resp.Close()
        End Try
        Return Nothing
    End Function
    Sub StreamCopy(ByVal input As IO.Stream, ByVal output As IO.Stream)
        Dim buf(0 To 16383) As Byte
        Using br = New IO.BinaryReader(input)
            Using bw = New IO.BinaryWriter(output)
                Do
                    Dim rb = br.Read(buf, 0, buf.Length)
                    If rb = 0 Then Exit Do
                    bw.Write(buf, 0, rb)
                Loop
            End Using
        End Using
    End Sub
End Class 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T13:43:53.473

HttpContext 包括 Request 属性，该属性又包含 Headers 集合。它应该是您需要的所有信息。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-31T03:50:52.873

可能是这样的：

```
HttpWebRequest request = (HttpWebRequest)WebRequest.Create("www.testing.test");
request.Headers = (WebHeaderCollection)Request.Headers; 
```

然后调用get响应

```
HttpWebResponse response  = (HttpWebResponse)request.GetResponse(); 
```

这将具有与原始请求相同的 HTTP 标头。

# mysql - MySQL 的 Nhibernate 映射工具

> ID：697187
> 
> 赞同：1
> 
> 时间：2009-03-30T13:26:57.193
> 
> 标签：mysql, nhibernate-mapping

有没有适用于 nhibernate-mysql 的映射工具？我想要一个映射工具

1.  接受 MySQL 数据库
2.  一般相关的hbm.xml文件
3.  创建映射到每个表的数据访问层类。

有没有这样的工具可用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T13:29:56.813

只有一个类似于您描述的工具，称为 ActiveWriter，它是一个 VStudio 插件。它很有用，但有一些严重的局限性。我会考虑改用 NHibernate Fluent 或 ActiveRecords。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T16:31:13.460

这在 NHibernate 用户组中出现了一段时间。总体感觉是从数据库生成 hbm.xml 是一件很麻烦的事情。最好编写类和 XML 文件。

一个人[建议使用](http://groups.google.com/group/nhusers/browse_thread/thread/16b2019f456f21e6/fa1fd001bc7db02c?lnk=gst&q=generate+hbm.xml+from+database#fa1fd001bc7db02c)MyGeneration，这可能值得一看。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-10T00:59:25.097

[CodeSmith](http://www.codesmithtools.com/)有这样的工具可用。

# java - 快速圆碰撞检测

> ID：697188
> 
> 赞同：15
> 
> 时间：2009-03-30T13:27:09.270
> 
> 标签：java, optimization, collision-detection, performance, geometry

我正在尝试编写一种方法来计算两个圆圈是否重叠。我想出了以下内容，我只是想知道是否可以进一步优化它。

```
private static boolean isCollision(Point2D p1, float r1, Point2D p2, float r2)
{
    float a,dx, dy;
    a = (r1+r2) * (r1+r2);
    dx = (float) (p1.getX() - p2.getX());
    dy = (float) (p1.getY() - p2.getY());

    if (a > (dx*dx) + (dy*dy))
    {
        return true;
    }
    return false;
} 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-30T13:38:43.483

唔。就数学而言，这看起来相当不错。关于如何使 Java 方面更快、更简洁的一些小问题：

*   如果您使用双精度数而不是浮点数作为半径，则不必将双精度数向下转换为浮点数。
*   如果您特别要求 Point2D.Double 参数，您可以使用它们的 x 和 y 公共字段而不是使用 getter。
*   另外，为什么`if (foo) { return true; } else { return false; }?`Just do `return foo;`！

一个改进的版本，然后：

```
private static boolean isCollision(Point2D.Double p1, double r1, Point2D.Double p2, double r2)
{
    final double a = r1 + r2;
    final double dx = p1.x - p2.x;
    final double dy = p1.y - p2.y;
    return a * a > (dx * dx + dy * dy);
} 
```

（请注意，如果您的代码完全基于浮点数，您可以使用`Point2D.Float`and `float`s 做同样的事情。）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-30T13:35:29.733

重叠还是相交？

如果相交，不要忘记圆圈不相交的情况，因为它们在彼此内部。

如果它是重叠的，我真的不知道如何进一步优化；您正在将点距离与半径之和进行比较，使用距离平方来避免取平方根。似乎没有任何脂肪可以修剪。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-30T14:02:17.657

您真的需要满足任何可能的 Point2D 实现吗？如果您不需要，它将保存一个虚拟呼叫：

```
private static boolean isCollisionFloat (Point2D.Float p1, float r1, Point2D.Float p2, float r2)
{
    final float r = r1+r2;
    final float dx = p1.x - p2.x;
    final float dy = p1.y - p2.y;

    return (r*r) > (dx*dx) + (dy*dy);
} 
```

```
测试 1000x1000 点：
什么都不做需要 6 毫秒
执行 isCollision 传递 Point2D.Float 耗时 128 毫秒
执行 isCollision 传递 Point2D.Double 耗时 127 毫秒
执行 isCollisionFloat 耗时 71 毫秒
执行 isCollisionDouble 耗时 72 毫秒

```

如果可以，请选择其中之一，而不是同时满足两者。

* * *

性能问题的问题在于，您确实必须衡量效果，到那时有人发布了与不受支持的意见相同的答案。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-02-14T11:32:42.167

我不知道它是否与您的情况相关，但如果您想检查您的圈子与许多其他圈子（假设有数千个圈子）之间的重叠，您可以尝试在四叉树中组织您的圈子（参见[http: //en.wikipedia.org/wiki/Quadtree](http://en.wikipedia.org/wiki/Quadtree)）并在四叉树中进行树查找（基于圆的边界矩形）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-30T19:57:42.917

通过计算每个圆的矩形边界并查看它们是否重叠，可以进一步优化您的算法。如果它们不重叠，则返回 false。这避免了那些矩形边界不重叠的圆的乘法（即，它们彼此不接近）。矩形边界计算的加法/减法比乘法便宜。

这是 Java 2D 使用的模式。请参阅[Shape.getBounds()](http://docs.oracle.com/javase/6/docs/api/java/awt/Shape.html#getBounds%28%29)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-30T13:40:40.237

它不会使您的代码更快，但我更喜欢：

```
return a > (dx*dx + dy*dy); 
```

# visual-studio - 如何从解决方案中完全删除 TFS 绑定？

> ID：697195
> 
> 赞同：7
> 
> 时间：2009-03-30T13:28:50.123
> 
> 标签：visual-studio, tfs

我们有许多项目的大型解决方案。一些项目是外包的，供应商使用 TFS。当他们提交到我们的 SVN 存储库时，一些绑定仍然存在。

当我打开 sln 时，VS2008 说“找不到与解决方案关联的源代码控制提供程序，您要删除它们吗”。我点击是，保存并退出，然后下次它会再次这样做:)

所以 - 任何人都知道我是如何一劳永逸地摆脱 sln 中的任何 TFS 绑定的吗？我是否需要手动搜索 csproj 文件以查找任何“scc”引用并删除？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-08T09:11:22.987

一些 PDA 部署项目 (.vddproj) 有一些绑定。刚刚手动删除它们:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T13:36:06.987

删除绑定的方法是搜索 csproj 文件并将其删除。关于这个主题已经有一个类似的问题：请参阅：[How to remove TFS source control bindings for a solution from the command line](https://stackoverflow.com/questions/160495/how-to-remove-tfs-source-control-bindings-for-a-solution-from-the-command-line)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-15T18:28:38.537

这是用于删除源代码控制绑定信息[的 PowerShell 脚本。](http://purplestoat.com/blog/how-to-remove-tfs-source-control-info-from-a-vs-solution/)它是从一些 C# 移植而来的，并且仅在 VS 2010 解决方案上进行了测试。原始[代码](http://www.atalasoft.com/cs/blogs/jake/archive/2008/05/21/2custom-nant-task-for-removing-tfs-bindings.aspx)是为 VS 2005 和 2008 编写的，因此您可以重新添加相关内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-26T07:58:42.157

[在这里，您可以找到一个工具](http://blog.instance-factory.com/?p=565)（包括源代码），用于从解决方案和项目文件以及 .vssscc 和 .vspscc 文件中删除 SCC 占用空间。此外，它还删除了输出和其他可配置目录。

Hth

斯特凡

# javascript - 将 JavaScript 链接转换为标准链接

> ID：697209
> 
> 赞同：1
> 
> 时间：2009-03-30T13:33:00.487
> 
> 标签：javascript, dom, jython

我正在使用具有如下 javascript 链接的 HTML：

```
<a href="javascript:openExternalLink(5542, true, 'http://www.websitedomain.com')">Links Text Here</a> 
```

我需要用标准的锚标签替换它们，如下所示：

```
<a href="http://www.websitedomain.com">Links Text Here</a> 
```

在 Jython 中实现这一目标的最佳解决方案是什么？

谢谢

伊夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T13:42:44.863

最好的方法可能是使用正则表达式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T15:44:55.087

```
var i= 0, A= document.links, who, url;
while(A[i]){
    who= A[i++];
    url= who.href || '';
    if(url.indexOf('javascript:openExternalLink')== 0){
        who.href= url.substring(url.indexOf("'"), url.lastIndexOf("'")+1);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T14:00:18.300

我的解决方案是使用 jQuery 库（为了便于使用，您可以通过循环锚点来简单地用纯 Javascript 编写代码，因为其余代码是纯 Javascript）。

在这里，它遍历锚点并将属性设置为`href`DOM 中的真实属性

```
$(document).ready(function () 
    {
        $("a").each(function () 
        {
            var href = $(this).attr('href');
            var urlStart = href.indexOf('http://'); //start point of the substring cut
            var urlStop = href.lastIndexOf("'"); //end point of the substring cut

            var realUrl = href.substring(urlStart, urlStop); //this is the real URL

            $(this).attr( {'href': realUrl} ); //now replace and we're ready to go
        });
    }); 
```

我自己测试了这个方法，它按预期工作。享受！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T16:05:03.757

像这样的东西可能会起作用：

```
newhtml = oldhtml.replace(/href=".*?'(http:.*?)'.*?"/gi, 'href="$1"'); 
```

# model-view-controller - 指向不受当前路由影响的路由的 ActionLink

> ID：697210
> 
> 赞同：0
> 
> 时间：2009-03-30T13:33:03.593
> 
> 标签：model-view-controller

我有问题，因为我有一个菜单，其中的链接始终应指向 MyController/MyAction，但该站点还有其他路由可以执行相同的操作，但参数更多。

会给我路线，但如果我目前在同一个动作和控制器上，但有更多参数，这些也包含在 url 中。

例如。如果我在页面上： [http://localhost/MyWebsite/organizations/p001/departments/vest/employees/chn/MyController/MyAction](http://localhost/MyWebsite/organizations/p001/departments/vest/employees/chn/MyController/MyAction)

生成的 url 将与上面相同，而不是： [http://localhost/MyWebsite/MyController/MyAction](http://localhost/MyWebsite/MyController/MyAction)

如我所愿。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-30T14:09:04.783

啊发现我可以使用 RouteLink 代替......

# c# - .NET 中的字符串转换

> ID：697216
> 
> 赞同：9
> 
> 时间：2009-03-30T13:34:24.993
> 
> 标签：c#, .net, string, casting

为什么有这么多方法可以在.net 中转换为字符串？我见过的方式是.ToString、Convert.ToString() 和(string)。有什么不同。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-30T13:36:29.170

## `Convert.ToString(obj)`

将指定的值转换为其等效的字符串表示形式。`String.Empty`如果指定值为 ，将返回`null`。

## `obj.ToString()`

返回表示当前对象的字符串。此方法返回对区域性敏感的人类可读字符串。例如，对于值为零的 Double 类的实例，Double.ToString 的实现可能会返回“0.00”或“0,00”，具体取决于当前的 UI 文化。默认实现返回 Object 类型的完全限定名称。

可以在派生类中重写此方法以返回对该类型有意义的值。例如，基本数据类型（如 Int32）实现 ToString 以便它返回对象表示的值的字符串形式。需要比 ToString 提供更多的字符串格式控制的派生类必须实现 IFormattable，其 ToString 方法使用当前线程的 CurrentCulture 属性。

## `(string)obj`

这是一个强制转换操作，而不是函数调用。如果您确定对象是字符串类型，或者它具有可以将其转换为字符串的隐式或显式运算符，请使用它。`null`如果对象是，将返回`null AND of type String or of type which implements custom cast to string operator. See examples.`

 `## `obj as string`

Safe cast operation. Same as above, but instead of throwing an exception it will return `null` if cast operation fails.

* * *

**Hint**: Don't forget to use CultureInfo with `obj.ToString()` and `Convert.ToString(obj)`

## Example:

```
12345.6D.ToString(CultureInfo.InvariantCulture);          // returns 12345.6
12345.6D.ToString(CultureInfo.GetCultureInfo("de-DE"));   // returns 12345,6
Convert.ToString(12345.6D, CultureInfo.InvariantCulture); // returns 12345.6
Convert.ToString(12345.6D, CultureInfo.GetCultureInfo("de-DE"));  // 12345,6
Convert.ToString(test);  // String.Empty, "test" is null and it's type
                         // doesn't implement explicit cast to string oper.
Convert.ToString(null);  // null
(string) null;           // null
(string) test;           // wont't compile, "test" is not a string and
                         // doesn't implement custom cast to string operator
(string) test;           // most likely NullReferenceException,
                         // "test" is not a string,
                         // implements custom cast operator but is null
(string) test;           // some value, "test" is not a string,
                         // implements custom cast to string operator
null as string;          // null 
```

Here is an example of custom cast operator:` 

```
public class Test
{
    public static implicit operator string(Test v)
    {
        return "test";
    }
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-30T13:41:22.667

*   **`.ToString()`**可以从*任何*对象调用。但是，如果您调用它的类型没有良好的实现，则默认返回类型名称而不是对该类型的实例有意义的内容。这个方法继承自基`Object`类型，你可以在你自己的类型中重载它来做任何你想做的事情。

*   **`(string)`**是*cast*，而不是函数调用。如果您需要的对象在某种意义上已经是一个字符串，或者您知道有一个很好的隐式转换可用（例如 from `int`），您应该只使用它。这将抛出异常是对象无法转换（包括对象时`null`）

*   **`as string`**是另一种写法`(string)`，但不同之处在于，`null`如果转换失败，它会返回而不是抛出异常。

*   **`Convert.ToString()`**尝试将参数实际*转换*为字符串。如果你对这个论点不太了解，这是最好的选择。它可能很慢，因为它必须做很多额外的工作来确定要返回什么样的结果，但是当你对参数不太了解时，同样的工作也使它成为最可靠的选择。如果没有其他可用的，它将回退到调用参数的`.ToString()`方法。

*   **`String.Format`**string 类的`.Format`方法也可用于将某些类型转换为字符串，还有一个额外的好处是您可以控制生成的字符串的外观。

*   **`Serialization`**这有点复杂，但 .Net 包含一些不同的机制，用于将对象转换为可以安全存储并从磁盘或其他流机制重新加载的表示。这包括二进制格式化程序，但通常涉及以某种格式或其他格式（通常是 xml）转换为字符串。当您想稍后将字符串转换回其原始类型时，或者如果您想要复杂类型的完整表示，则序列化是合适的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-30T13:36:16.283

如果对象为 null .ToString 并且 (String) 将引发异常，则 Convert.ToString() 将返回一个空字符串。如果值为 null，Convert.ToString 将在内部调用 .ToString()，它将返回一个空字符串。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-30T13:43:40.523

**`object.ToString()`**是检索对象的字符串表示的最基本的方法，可以由对象具体实现。

**`Convert.ToString()`**对此进行了扩展并为原始类型（char、byte、int、double 等）提供了一些特定的重载，从而允许一些更特定于类型的功能（例如基本转换）

**`(string)`**是一个强制转换运算符，并且仅当类型是字符串或具有可以将其转换为字符串的隐式或显式运算符时才有效。否则你会得到一个**`InvalidCastException`**

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-30T13:37:15.220

不要忘记`as string`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-30T13:36:51.430

思考。

ToString 是一个虚方法，每种类型都可以随心所欲地实现它。System.Object 还提供默认实现，以便它始终成功。Convert.ToString 也仅适用于空值，并允许您使用 IFormat 提供程序，如评论中所述。

转换为字符串需要对象来实现转换运算符。同样，类型可以随心所欲地实现它，但大多数类型不会，因此您可能会在此处遇到异常。

使用 .ToString 作为您的最佳选择。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-30T13:37:10.557

ToString() 是一个对象的方法，它总是在非空引用上工作，所以你会得到一些东西，但是那个东西是否是你想要的，是另一回事。

Convert.ToString() 在大多数情况下会产生相同的结果，但不如 Object.ToString() 灵活，因为您无法传递自定义格式规则。

(string) 会将您的对象转换为字符串，如果它不是字符串，那么您将获得 InvalidCastException()。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-30T13:39:21.783

.ToString() 是一个实例方法，它向对象询问其字符串表示形式。当对象为空时，这将引发异常。

(string) 是对字符串类型的强制转换，在大多数情况下，除了简单数据类型外，这不是一个好主意，因为当它为 null 或无效强制转换时，它可能会中断（抛出异常）

Convert.ToString() 比简单的强制转换做更多的检查，为强制转换提供了更强大的替代方案。当对象为空时，它将返回空字符串。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-30T14:04:12.877

不是吹毛求疵，而是对象`null`的有效值`String`。因此`(string) null`不会抛出任何异常。自己试试吧：

```
using System;

namespace Test
{
    class Program
    {
        public static void Main(string[] args)
        {
            string s = (string) null;
            Console.WriteLine(s);
        }
    }
} 
```

# asp.net - ASP.Net，捕获客户端错误的图像/屏幕截图

> ID：697217
> 
> 赞同：0
> 
> 时间：2009-03-30T13:35:18.423
> 
> 标签：asp.net, image, error-handling

我们目前在我们的 ASP.Net 应用程序中具有相当强大的错误处理功能。

我们将所有错误记录在数据库、服务器上的文本文件中，并将包含错误详细信息的自动电子邮件发送回我们的支持人员。

当然，这一切都发生在服务器上。

我们想在错误发生时捕获（并检索）客户端浏览器的图像，以便为故障排除提供更多信息？

这是可能吗？

如果是这样，解决这个问题的优雅方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T13:39:12.970

这在技术上并非不可能，但对于几乎所有目的来说都是如此不切实际，以至于它也可能是不可能的。您需要在客户端机器上运行一个插件，该插件可以从您的错误页面接收指令以截取屏幕截图，连接到服务器并上传。

如果您的客户端屏幕包含影响异常周围状态的复杂数据，您应该重新审视您的设计，以确保在将所有内容发送到客户端之前记录所有内容，这样您就可以跟踪所有相关状态以及给定的异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T15:21:01.553

说某事“不切实际”通常比实际尝试解决困难但在技术上并非不可能的事情更容易。

我做了更多的研究，并遇到了 [一种方法](http://www.west-wind.com/weblog/posts/481.aspx)，可以让人们掌握呈现的 html 服务器端。

此外，还有一些方法可以将[html 转换为图像](https://stackoverflow.com/questions/334532/render-html-as-an-image)

我将结合使用两者来实施解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T13:41:45.943

由于安全和隐私原因，无法捕获客户端浏览器屏幕截图。您可以（而且您应该）做的是捕获 url 和浏览器版本，并尝试在同一环境中重现它。

# c# - 编写控制台应用程序时，有没有办法创建第二个控制台以在 .NET 中输出？

> ID：697227
> 
> 赞同：22
> 
> 时间：2009-03-30T13:37:03.240
> 
> 标签：c#, .net, console

编写控制台应用程序时，有没有办法创建第二个控制台以在 .NET 中输出？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-30T14:12:53.013

好吧，您可以启动一个新的 cmd.exe 进程并使用 stdio 和 stdout 发送和接收数据。

```
ProcessStartInfo psi = new ProcessStartInfo("cmd.exe")
{
    RedirectStandardError = true,
    RedirectStandardInput = true,
    RedirectStandardOutput = true,
    UseShellExecute = false
};

Process p = Process.Start(psi);

StreamWriter sw = p.StandardInput;
StreamReader sr = p.StandardOutput;

sw.WriteLine("Hello world!");
sr.Close(); 
```

[有关MSDN](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.standardinput(vs.71).aspx)的更多信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-30T14:32:03.090

下面会触发与应用程序相关的控制台窗口数量，并将控制台的数量和参数存储在字符串字典中，然后循环以生成所需数量的衍生控制台应用程序。如果只产生一个当然，你只需要过程的东西。

```
//Start looping dic recs and firing console
foreach (DictionaryEntry tests in steps)
{
    try
    {
        Process runCmd = new Process();
        runCmd.StartInfo.FileName = CONSOLE_NAME;
        runCmd.StartInfo.UseShellExecute = true;
        runCmd.StartInfo.RedirectStandardOutput = false;
        runCmd.StartInfo.Arguments = tests.Value.ToString();

        if (cbShowConsole.Checked)
        {
            runCmd.StartInfo.CreateNoWindow = true;
            runCmd.StartInfo.WindowStyle = ProcessWindowStyle.Normal;
        }
        else
        {
            runCmd.StartInfo.CreateNoWindow = false;
            runCmd.StartInfo.WindowStyle = ProcessWindowStyle.Hidden; 
        }
        runCmd.Start();                
    }
    catch (Exception ex)
    {
        string t1 = ex.Message;
    }
} 
```

请注意，这旨在运行隐藏（CreateNoWindow）或可见。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-03-30T13:52:27.867

单个控制台附加到任何给定进程。所以总之你不能。但是有办法“伪装”

# java - JPA @OneToMany 集合和独特的约束

> ID：697238
> 
> 赞同：0
> 
> 时间：2009-03-30T13:39:56.133
> 
> 标签：java, jpa, join, foreign-keys, unique-constraint

我有以下情况：

我有一个充满用户的系统。希望为超过一周左右登录该网站的用户举办竞赛。因此，我需要创建一个新的 Contest 对象，其中包含参赛作品和获胜者。

我创造了这样的东西：

```
private Set<User>;

@OneToMany(cascade = CascadeType.REMOVE, fetch = FetchType.LAZY) 
@JoinTable(name="contest_entries", 
        joinColumns = {@JoinColumn(name = "contest_fk", referencedColumnName="contest_id")},
        inverseJoinColumns = {@JoinColumn(name = "user_fk", referencedColumnName="id")})   
public Set<User> getEntries() {
    return entries;
} 
```

这个想法是一个竞赛可以有多个条目。看起来很简单。它生成以下内容：

```
create table contest (contest_id numeric(19,0) identity not null, primary key (contest_id));
create table contest_entries (contest_fk numeric(19,0) not null, user_fk numeric(19,0) not null, primary key (contest_fk, user_fk));
alter table contest_entries add constraint FK7FBD0C65C4F120C2 foreign key (contest_fk) references contest;
alter table contest_entries add constraint FK7FBD0C656ABC75E3 foreign key (user_fk) references user_profile; 
```

然而，一旦比赛结束，人们的愿望就是举办另一场比赛。当我尝试创建一个新的比赛并让之前输入的用户再次输入时，我得到一个唯一的键约束。查看 DDL 表，确实如此。

所以，从本质上讲，我不能同时进行两场比赛。我也会失去参加比赛的人的历史。那是行不通的。我需要能够在不同的比赛中与相同的用户同时举办两场比赛。

我是 JPA 的新手，所以我必须相信我遗漏了一些明显的东西。系统已经有一个用户表，并且它充满了用户。不希望更改该表结构。关于如何解决这个问题的任何想法？如果重要的话，持久性实现就是 Hibernate。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T13:47:41.607

你实际上有一个多对多的关系。所以你应该使用@ManyToMany 注释。

# c# - 设置 XML 命名空间

> ID：697240
> 
> 赞同：0
> 
> 时间：2009-03-30T13:40:39.563
> 
> 标签：c#, xml

我想创建一个带有 namepace 属性的 xml 文档，如下所示：

```
<MyXmlDoC xmlns="http://abc" xmlns:brk="http://123"> 
```

使用 System.Xml.Linq xml 库，iv 做到了这一点：

```
 public static XAttribute XmlNamepace()
        {
            return new XAttribute(XName.Get("xmlns"), "http://abc");
        }

        public static XAttribute brkNamepace()
        {
            return new XAttribute(XNamespace.Xmlns + "brk", "http://123");
        }

 var rootNode = new XElement("MyXmlDoC",XmlNamepace(),brkNamepace()); 
```

但这会产生此错误：

> 前缀 '' 不能在同一起始元素标记内从 '' 重新定义为 ' [http://abc '](http://abc)

我究竟做错了什么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-01T15:09:10.303

（根据您的回答）您需要使用 rt 命名空间添加 ChildNode，这应该可以：

```
rootNode.Add(new XElement(rt + "ChildNode", "Hello")); 
```

# c# - 为什么 1.0f + 0.0000000171785715f 返回 1f？

> ID：697249
> 
> 赞同：3
> 
> 时间：2009-03-30T13:41:25.600
> 
> 标签：c#, .net, floating-point, precision

经过一小时试图在我的代码中查找错误后，我终于找到了原因。我试图向 1f 添加一个非常小的浮点数，但什么也没发生。在试图弄清楚为什么我发现将那个小浮点数添加到 0f 时效果很好。

为什么会这样？这与“数量级”有关吗？这个问题有什么解决方法吗？

提前致谢。

编辑：

更改为双精度或小数目前不是一种选择。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-30T13:45:51.017

因为单精度（32 位）浮点值的精度约为小数点后 7 位。这意味着您添加的值基本上为零，至少在添加到`1`. 然而，值本身可以毫不费力地存储在浮点数中，因为在这种情况下指数很小。但是要成功地将它添加到`1`您必须使用较大数字的指数......然后零后的数字在四舍五入中消失。

`double`如果您需要更高的精度，您可以使用。在性能方面，这不应该对今天的硬件产生影响，而且内存通常也不会受到您必须考虑每个变量的限制。

**编辑：**正如您所说， using`double`不是一个选项，您可以使用[Kahan summation](http://en.wikipedia.org/wiki/Kahan_summation)，正如[akuhn](https://stackoverflow.com/users/24468/akuhn)在评论中指出的那样。

另一种选择可能是以双精度执行中间计算，然后`float`再次转换为。但是，这只会在有更多操作而不是仅将非常小的数字添加到较大的数字时才有帮助。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-30T13:44:35.857

[浮点运算](http://en.wikipedia.org/wiki/Floating_point#Floating-point_arithmetic_operations)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-30T13:45:47.773

这可能是因为浮点数中精度的位数是恒定的，但指数显然可以变化。

这意味着尽管您可以将小数添加到 0，但您不能期望将其添加到指数不同于 0 的数字，因为剩下的精度位数不足。

你应该阅读[每个计算机科学家应该知道的关于浮点运算的知识](http://docs.sun.com/source/806-3568/ncg_goldberg.html)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-30T13:43:27.687

看起来它与浮点精度有关。如果我是你，我会使用不同的类型，比如`decimal`. 这应该可以解决精度错误。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-30T13:46:25.947

有了`float`，你只能得到**大约七位数的准确度**。所以你的数字会被四舍五入到 1f。如果要存储此类号码，请`double`改用

[http://msdn.microsoft.com/en-us/library/ayazw934.aspx](http://msdn.microsoft.com/en-us/library/ayazw934.aspx)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-12-09T13:05:42.483

除了公认的答案：*如果您需要总结许多小数字和一些较大的数字，您应该使用[Kahan Summation](http://en.wikipedia.org/wiki/Kahan_summation_algorithm)*。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-30T14:05:21.610

如果性能是一个问题（因为你不能使用`double`），那么[二进制缩放/定点](http://en.wikipedia.org/wiki/Binary_scaling)可能是一种选择。`float`s 存储为整数，但按大数（例如 2^16）缩放。中间算术是通过（相对快速的）整数运算完成的。通过除以比例因子，最终答案可以在最后转换回浮点数。

如果目标处理器缺少硬件浮点单元，通常会这样做。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-30T13:46:55.617

您在文字上使用 f 后缀，这将使这些浮点数而不是双精度数。所以你非常小的浮动将在更大的浮动中消失。

# xml - 在 SQL 中搜索 XML 列

> ID：697256
> 
> 赞同：3
> 
> 时间：2009-03-30T13:42:11.260
> 
> 标签：xml, oracle, select

© 有一个 XML 文档来存储 Oracle 数据库中的记录。

表 CourseXML 将包含：

```
Record_Number  int
XML_Type       int
XMLDoc         clob
...etc 
```

我想通过 XML 标记在 XMLDoc 列中进行搜索。XML 文档有一个这样的 XML Schema：

```
<root>
  <UnitID="2" Name="Jerry" SName="Potter"/>
  <UnitID="3" Name="Jim" SName="Carelyn"/>
</root> 
```

我想在 UnitID="2" 中进行搜索，我只想要 Jerry 的 xml 行。我必须如何进行选择语句查询才能获取该 xml 行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T14:10:35.967

您可能必须使用节点位才能使其准确。

```
SELECT
    y.item.value('@UnitID', 'int') AS UnitID,
    y.item.value('@Name', 'varchar(100)') AS [Name],
    y.item.value('@SName', 'varchar(100)') AS [SName]
FROM
    <table>
    CROSS APPLY
    XMLDoc.nodes('/root') AS y(item)
WHERE
    y.item.value('@UnitID', 'int') = 2 
```

编辑：更正代码以使用表，而不是 xml 局部变量

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T05:06:10.197

你有很多方法可以得到它。“gbn”显示了一种方式——另外两种在这里。

如果您想要整个“行”（我假设您会将这些东西放入标签中），请尝试以下操作：

```
select
    xmldoc.query('//node[@UnitID="2"]')
from
    xmltest 
```

如果您只想要标签中的“名称”属性，请使用：

```
select
    xmldoc.value('(//node[@UnitID="2"]/@Name)[1]', 'varchar(20)')
from
    xmltest 
```

如果您需要访问一大堆属性和/或子元素，请使用 gbn 的方法和“CROSS APPLY xmldoc.nodes(....)”。

享受！SQL Server 2005 中的 XML 支持确实非常广泛和有用！

马克

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T13:49:02.337

```
SELECT * FROM CourseXML
WHERE XMLDoc = 'UnitID="2"' 
```

不是吗？还是我误解了什么？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-10-22T18:42:11.247

作为结构，并使用全文搜索。

```
<Root>
  <Tags>
    <TagName>Actividad</TagName>
    <Valor>Actividad 2</Valor>
  </Tags>
  <Tags>
    <TagName>Cliente</TagName>
    <Valor>Alpina</Valor>
  </Tags>
</Root> 
```

```
 select 
     Filename
 from 
 Files
 where 
 CONTAINS(Tags,'Actividad')  and
 CONTAINS(Tags,'Cliente')  and
 Tags.exist('//Tags/Valor/text()[contains(., "Actividad 1")]')  = 1 and
 Tags.exist('//Tags/Valor/text()[contains(., "ADV")]')  = 1 
```

我不建议在 XML 上使用属性，因为无法对属性执行全文搜索（无论 SQL 2008 R2 文档怎么说）。

[请参考这个](http://msdn.microsoft.com/en-us/library/bb522491.aspx)

# vb.net - 如何在 VB.NET 中搜索数组？

> ID：697270
> 
> 赞同：8
> 
> 时间：2009-03-30T13:44:21.490
> 
> 标签：vb.net, arrays

我希望能够有效地在数组中搜索字符串的内容。
例子：

```
dim arr() as string={"ravi","Kumar","Ravi","Ramesh"} 
```

我传递的值为“ra”，我希望它返回 2 和 3 的索引。

如何在 VB.NET 中做到这一点？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-30T13:59:52.310

目前尚不清楚您要如何搜索数组。以下是一些替代方案：

查找包含确切字符串 "Ra" 的所有项目（返回项目 2 和 3）：

```
Dim result As String() = Array.FindAll(arr, Function(s) s.Contains("Ra")) 
```

查找以确切字符串 "Ra" 开头的所有项目（返回项目 2 和 3）：

```
Dim result As String() = Array.FindAll(arr, Function(s) s.StartsWith("Ra")) 
```

查找包含“ra”的任何大小写版本的所有项目（返回项目 0、2 和 3）：

```
Dim result As String() = Array.FindAll(arr, Function(s) s.ToLower().Contains("ra")) 
```

查找以任何大小写版本“ra”开头的所有项目（返回项目 0、2 和 3）：

```
Dim result As String() = Array.FindAll(arr, Function(s) s.ToLower().StartsWith("ra")) 
```

-

如果您没有使用 VB 9+，那么您没有匿名函数，因此您必须创建一个命名函数。

例子：

```
Function ContainsRa(s As String) As Boolean
   Return s.Contains("Ra")
End Function 
```

用法：

```
Dim result As String() = Array.FindAll(arr, ContainsRa) 
```

拥有一个只能与特定字符串进行比较的函数并不总是很有用，因此为了能够指定一个要与之比较的字符串，您必须将它放在一个类中以便在某个地方存储该字符串：

```
Public Class ArrayComparer

   Private _compareTo As String

   Public Sub New(compareTo As String)
      _compareTo = compareTo
   End Sub

   Function Contains(s As String) As Boolean
      Return s.Contains(_compareTo)
   End Function

   Function StartsWith(s As String) As Boolean
      Return s.StartsWith(_compareTo)
   End Function

End Class 
```

用法：

```
Dim result As String() = Array.FindAll(arr, New ArrayComparer("Ra").Contains) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-30T13:49:12.180

```
Dim inputString As String = "ra"
Enumerable.Range(0, arr.Length).Where(Function(x) arr(x).ToLower().Contains(inputString.ToLower())) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-30T14:24:44.933

如果您正在寻找旧版本的 .NET，请使用：

```
Module Module1

    Sub Main()
        Dim arr() As String = {"ravi", "Kumar", "Ravi", "Ramesh"}
        Dim result As New List(Of Integer)
        For i As Integer = 0 To arr.Length
            If arr(i).Contains("ra") Then result.Add(i)
        Next
    End Sub

End Module 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-30T13:54:08.317

如果您想要一个经常重复的高效搜索，请先对数组进行排序 ( `Array.Sort`)，然后使用[`Array.BinarySearch`](http://msdn.microsoft.com/en-us/library/system.array.binarysearch.aspx).

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-03-19T10:17:49.613

检查这个..

```
 string[] strArray = { "ABC", "BCD", "CDE", "DEF", "EFG", "FGH", "GHI" };
        Array.IndexOf(strArray, "C"); // not found, returns -1
        Array.IndexOf(strArray, "CDE"); // found, returns index 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-02-25T16:47:05.983

如果与输入匹配，则比较数组中的属性，然后将某些内容设置为循环当前位置的值，这也是当前查找项的索引。

简单例如。

```
dim x,y,z as integer
dim aNames, aIndexes as array
dim sFind as string
for x = 1 to length(aNames)

    if aNames(x) = sFind then y = x 
```

y 然后是数组中项目的索引，然后循环可用于将这些存储在数组中，因此您将拥有：

```
z = 1
for x = 1 to length(aNames)
    if aNames(x) = sFind then 
        aIndexes(z) = x 
        z = z + 1
    endif 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-30T14:09:07.500

**VB**

```
Dim arr() As String = {"ravi", "Kumar", "Ravi", "Ramesh"}
Dim result = arr.Where(Function(a) a.Contains("ra")).Select(Function(s) Array.IndexOf(arr, s)).ToArray() 
```

**C＃**

```
string[] arr = { "ravi", "Kumar", "Ravi", "Ramesh" };
var result = arr.Where(a => a.Contains("Ra")).Select(a => Array.IndexOf(arr, a)).ToArray(); 
```

- - -详细的 - - -

```
Module Module1

    Sub Main()
        Dim arr() As String = {"ravi", "Kumar", "Ravi", "Ramesh"}
        Dim searchStr = "ra"
        'Not case sensitive - checks if item starts with searchStr
        Dim result1 = arr.Where(Function(a) a.ToLower.StartsWith(searchStr)).Select(Function(s) Array.IndexOf(arr, s)).ToArray
        'Case sensitive - checks if item starts with searchStr
        Dim result2 = arr.Where(Function(a) a.StartsWith(searchStr)).Select(Function(s) Array.IndexOf(arr, s)).ToArray
        'Not case sensitive - checks if item contains searchStr
        Dim result3 = arr.Where(Function(a) a.ToLower.Contains(searchStr)).Select(Function(s) Array.IndexOf(arr, s)).ToArray
        Stop
    End Sub

End Module 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-04-28T08:54:04.173

切勿使用 .ToLower 和 .ToUpper。

我刚刚在土耳其遇到了问题，那里有 4 个“i”字母。使用 ToUpper 时，我得到了错误的“Ì”，但它失败了。

使用不变的字符串比较： Const LNK as String = "LINK" Dim myString = "Link"

不好：如果 myString.ToUpper = LNK 那么...

很好，适用于整个世界： If String.Equals(myString, LNK , StringComparison.InvariantCultureIgnoreCase) Then...

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-03-30T13:52:46.570

这可以解决问题，返回索引为 0、2 和 3 的值。

```
Array.FindAll(arr, Function(s) s.ToLower().StartsWith("ra")) 
```

# javascript - Prototype 框架中的 Javascript 事件层次结构

> ID：697271
> 
> 赞同：1
> 
> 时间：2009-03-30T13:44:25.407
> 
> 标签：javascript, internet-explorer, events, event-handling, prototypejs

*在dom:loaded*和使用 Prototype javascript 框架*加载*之间是否有任何事件需要处理？
我已经使用原型实现了一个预加载器，它看起来像这样：

```
Event.observe(window,"load",preload);
function preload(){
    if($('wrapper'))
        $('wrapper').setStyle({"display":"block"});
    if($('loading'))
        setTimeout('$("loading").fade({duration: 5.0});',4000);
} 
```

然后我有另一个用于列高固定的处理程序，它是：

```
Event.observe(window,"load",function(){ 
    var bottomExtraOffset = (Prototype.Browser.IE) ? 100 : 130;
    if(parseInt($$('.col1')[0].getStyle('height')) > parseInt($$('.col2')[0].getStyle('height')))
        $('wrapper').setStyle({'height' : parseInt($$('.col1')[0].getStyle('height'))+bottomExtraOffset+'px'}); 
    else
        $('wrapper').setStyle({'height' : parseInt($$('.col2')[0].getStyle('height'))+bottomExtraOffset+'px'});
});//observe 
```

它在除 IE 之外的任何浏览器中都非常好用！似乎 IE 没有将第二个处理程序附加到 onload 处理程序列表，所以当第一个处理程序试图获取任何列的高度时，它返回 0 因为它仍然显示为无。

*除了load* & *dom:loaded*之外还有其他事件要处理并让我摆脱这个！？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-30T14:28:55.003

完成 preload() 后，您可以简单地调用第二个函数吗？

或者，如果你不想在 preload() 之后直接调用它，那么你可以做一些事情，比如设置一个标志，然后在 section 函数中设置一个超时，等待第一个完成执行。

如果顺序很重要，您需要在功能之间进行通信。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T15:43:57.850

AFAIK 没有这样的事件，甚至*dom:loaded*事件也是由 Prototype 开发人员实现的，这不是 JS 中的默认事件。您可能希望使用帮助程序来延迟执行第二个处理程序，因此将首先执行第一个处理程序：

```
function foo(){ 
    var bottomExtraOffset = (Prototype.Browser.IE) ? 100 : 130;
    if (parseInt($$('.col1')[0].getStyle('height')) > parseInt($$('.col2')[0].getStyle('height'))) {
        $('wrapper').setStyle({'height' : parseInt($$('.col1')[0].getStyle('height')) + bottomExtraOffset + 'px'}); 
    }
    else {
        $('wrapper').setStyle({'height' : parseInt($$('.col2')[0].getStyle('height')) + bottomExtraOffset + 'px'});
    }
}

function bar() {
  // One msec delay.
  setTimeout(foo, 1);
}

Event.observe(window, "load", bar); // or window.observe("load",bar); 
```

此外，您可以检查用户代理是否像 IE 一样地狱，然后使用此方法，否则使用您所说的方法。

# ssh - 在 solaris 10 上使用兼容 nis 的 ssh

> ID：697275
> 
> 赞同：1
> 
> 时间：2009-03-30T13:45:21.550
> 
> 标签：ssh, solaris, nis

我有一个使用以下配置的带有 ssh 和 NIS 的可工作的 solaris 10 服务器：

```
# /etc/nsswitch.conf
passwd:     files nis
group:      files nis 
```

和

```
# /etc/ssh/sshd_config
 Protocol 2
 Port 22
 ListenAddress ::
 AllowTcpForwarding no
 GatewayPorts no
 X11Forwarding yes
 X11DisplayOffset 10
 X11UseLocalhost yes
 PrintMotd no
 KeepAlive yes
 SyslogFacility auth
 LogLevel info
 HostKey /etc/ssh/ssh_host_rsa_key
 HostKey /etc/ssh/ssh_host_dsa_key
 ServerKeyBits 768
 KeyRegenerationInterval 3600
 StrictModes yes
 LoginGraceTime 600
 MaxAuthTries       6
 MaxAuthTriesLog    3
 PermitEmptyPasswords yes
 PasswordAuthentication yes
 PAMAuthenticationViaKBDInt yes
 PermitRootLogin yes
 Subsystem  sftp    /usr/lib/ssh/sftp-server
 IgnoreRhosts yes
 RhostsAuthentication no
 RhostsRSAAuthentication no
 RSAAuthentication yes 
```

现在，我想切换到兼容模式：

```
# /etc/nsswitch.conf
passwd:     compat
group:      files nis 
```

我添加了一些用户：

```
# /etc/passwd
+luke:x::::: 
```

运行`pwvcon`，然后用户的密码验证`luke`不再起作用（而公钥仍然可以）。

我的设置有问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T15:15:14.033

来自`passwd(4)`：

> 如果 +name 条目具有非空密码 [..]，则该字段的值将覆盖备用命名服务中包含的内容。

您能看看删除 passwd 列中的“x”并再次运行 pwconv 是否有帮助？

编辑：第一个猜测完全错误，请参阅评论，所以这是另一个猜测——我现在不能破坏我的 Sun 配置，抱歉；）

# wpf - 需要帮助处理 Application.xaml 文件中的 DataTemplate 事件

> ID：697276
> 
> 赞同：2
> 
> 时间：2009-03-30T13:45:37.167
> 
> 标签：wpf, event-handling, datatemplate, event-triggers

我的应用程序中有一个包含几个按钮的数据模板。我希望在当前页面（我在许多页面中使用此模板）而不是在 Application.xaml.vb/cs 文件中触发这些按钮的偶数处理程序，因为我希望在每个页面上执行不同的操作。

我希望我很清楚。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T13:56:56.937

您可以使用命令来实现这一点。`Button`在`DataTemplate`执行特定的 s 中有`Command`s：

```
<Button Command="{x:Static MyCommands.SomeCommand}"/> 
```

然后让每个使用该`DataTemplate`处理的视图`Command`：

```
<UserControl>
    <UserCommand.CommandBindings>
         <CommandBinding Command="{x:Static MyCommands.SomeCommand}"
                         Executed="_someHandler"/>
    </UserCommand.CommandBindings>
</UserControl> 
```

**评论后编辑：**`ResourceDictionary`根据[这些说明](https://stackoverflow.com/questions/92100/is-it-possible-to-set-code-behind-a-resource-dictionary-in-wpf-for-event-handli)为您创建代码隐藏后，您可以简单地以通常的方式连接事件：

在`MyResources.xaml`：

```
<ListBox x:Key="myListBoxResource" ItemSelected="_listBox_ItemSelected"/> 
```

然后在`MyResources.xaml.cs`：

```
private void _listBox_ItemSelected(object sender, EventArgs e)
{
    ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-09T08:57:16.253

如果您使用事件而不是命令，那么在您的`Click`事件处理程序中只需编写

```
private void Button_Click(object sender, RoutedEventArgs e)
{
    var dataItem = (FrameworkElement)sender).DataContext;
    // process dataItem
} 
```

# python - 在 Python 中导入

> ID：697281
> 
> 赞同：2
> 
> 时间：2009-03-30T13:46:55.180
> 
> 标签：python, import

在 Python 2.5 中，我通过更改环境变量来导入模块。它有效，但使用 site-packages 无效。是否有另一种方法可以在 C:\Python25 以外的目录中导入模块？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-30T15:26:43.770

途中是[**`PYTHONPATH`**](http://docs.python.org/using/cmdline.html#envvar-PYTHONPATH)环境变量。另一种是[**`sys.path`**](http://docs.python.org/library/sys.html#sys.path)直接通过**`sys.path.append(path)`**或通过定义**`.pth`**文件添加路径并将它们添加到 with [**`site.addsitedir(dirWithPths)`**](http://docs.python.org/library/site.html#site.addsitedir)。路径文件 ( `.pth`) 是简单的文本文件，每行都有一个路径。将读取其中的每个`.pth`文件。`dirWithPths`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-30T13:52:52.530

将位置附加到模块到`sys.path`.

编辑：（为了反驳下面的帖子；-)） `os.path`做了一些完全不同的事情。你需要使用`sys.path`.

```
sys.path.append("/home/me/local/modules") 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-30T14:01:08.360

添加到`PYTHONPATH`环境变量的目录在 之后搜索`site-packages`，因此如果您有一个`site-packages`与您想要的模块同名的模块`PYTHONPATH`，则`site-packages`版本将获胜。此外，您可能需要重新启动解释器和启动它的 shell，以使对环境变量的更改生效。

如果要在运行时将目录添加到搜索路径，而无需重新启动程序，请将目录添加到`sys.path`. 例如：

```
import sys
sys.path.append(newpath) 
```

如果您希望之前搜索新目录`site-packages`，请将目录放在列表的前面，如下所示：

```
import sys
sys.path.insert(0, newpath) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-30T13:53:05.633

`sys.path`是一个列表，您可以在其中附加自定义路径以进行搜索，如下所示：

```
sys.path.append("/home/foo") 
```

# .net - 如何将 ASP.NET Treeview 控件绑定到数据表？

> ID：697285
> 
> 赞同：4
> 
> 时间：2009-03-30T13:47:52.107
> 
> 标签：.net, asp.net, javascript, html

我有这个表结构：
- CategoryID
- CategoryName
- ParentID

我想将此表中的数据加载到树视图控件中，以便能够编辑/删除这些记录。怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T14:07:34.787

有关更多详细信息，请参阅： [如何将数据绑定到 TreeView 控件？](https://stackoverflow.com/questions/372820/how-do-you-databind-to-a-system-windows-forms-treeview-control)（问题是 WinForms，但仍然适用于 ASP.NET）

总而言之，您不能将数据绑定到 TreeView。TreeViews 是分层数据结构，因此没有本机绑定机制。您必须滚动自己的绑定才能执行此操作。

# sql-server - Sql server 2005 页面撕裂，错误 424

> ID：697286
> 
> 赞同：0
> 
> 时间：2009-03-30T13:48:07.143
> 
> 标签：sql-server, sql-server-2005, sql-server-express

我的戴尔电脑出现故障；它是蓝屏。我通过格式化和重新安装我一直在使用的操作系统和其他软件解决了这个问题。然后我恢复了使用 sqlserver 2005 设计的数据库和使用恢复工具的其他文件；Easy Recovery 6.0。

问题是：当我尝试附加恢复的文件（lpdb.mdf）时，它无法附加。操作失败并显示以下消息：

## 标题：Microsoft SQL Server 管理工作室

为服务器“SAPC”附加数据库失败。(Microsoft.SqlServer.Smo)

附加信息：

执行 Transact-SQL 语句或批处理时发生异常。(Microsoft.SqlServer.ConnectionInfo)

* * *

SQL Server 检测到基于逻辑一致性的 I/O 错误：损坏的页面（预期签名：0x55555555；实际签名：0x4c093c91）。它发生在读取文件“F:\Recovered\lpdb_log.LDF”中偏移量 0000000000000000 的数据库 ID 0 中的页面 (0:0) 期间。SQL Server 错误日志或系统事件日志中的其他消息可能会提供更多详细信息。这是威胁数据库完整性的严重错误情况，必须立即纠正。完成完整的数据库一致性检查 (DBCC CHECKDB)。这个错误可能是由许多因素引起的；有关详细信息，请参阅 SQL Server 联机丛书。（Microsoft SQL Server，错误：824）

有谁可以帮助我吗？

我谢谢你！

德杰内。

## 编辑

来自其他封闭问题的 gbn：

嗨，先生，

我尝试了你建议我的方式。问题没有解决。

报错：消息 一个或多个文件与数据库的主文件不匹配。如果您尝试附加数据库，请使用正确的文件重试该操作。如果这是现有数据库，则文件可能已损坏，应从备份中恢复。

有没有我应该尝试的替代解决方案？我要重新设计数据库。请节省我的时间！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T14:04:31.737

1.  你有一个好的备份吗？

2.  鉴于它说页面（0：0），那么我建议您参考第 1 点

3.  使用[紧急模式](http://www.sqlskills.com/BLOGS/PAUL/post/CHECKDB-From-Every-Angle-EMERGENCY-mode-repair-the-very-very-last-resort.aspx)并希望最好。Paul Randall*写了*DBCC CHECKDB...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T22:30:09.150

损坏的页面在日志文件中，因此重命名日志文件并使用 sp_attch_single_file_db 过程附加 mdf 并生成新的事务日志文件。

# iis - 如何在 XP 和 C# 上使用 IIS5.1 调试客户端证书

> ID：697287
> 
> 赞同：0
> 
> 时间：2009-03-30T13:48:14.290
> 
> 标签：iis, ssl, certificate, self-signed

奥拉，

我需要开发一个需要客户端证书的网站（在 C# 中，asp.net 3.5）。我想使用 Visual Studio 对此进行调试。[我已经使用出色的工具SelfSSL](http://support.microsoft.com/kb/840671)设置 IIS 以使用自签名证书我还设置了默认站点以要求 SSL 并要求客户端证书。但我不知道如何创建 IIS 接受的客户端证书。浏览到测试站点时，我收到（预期的）错误：

```
HTTP 403.7 - Forbidden: Client certificate required 
```

如何创建客户端证书？

[更新] 按照 sipwiz 的建议，我使用 makecert 创建了一个证书。但是，IIS 似乎并未将此证书识别为有效的客户端证书。我已导出服务器证书并添加了 -ic (servercert) 开关。这仍然不能解决问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T13:55:02.230

您可以使用 Microsoft 的 makecert 实用程序。

您可能需要调整命令行选项，但类似下面的内容应该可以帮助您入门：

makecert -pe -n "CN=MyName" -a sha1 -eku 1.3.6.1.5.5.7.3.2 -ss my clientcer.cer

编辑：添加了 -eku 参数，看起来 IIS 客户端证书需要它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-10T18:00:38.953

您的任何“客户证书”是否已加载到您的个人证书存储中？

运行 > mmc > 添加/删除管理单元 > 证书 > 我的用户帐户 > 个人 > 证书

这就是 IE 期望客户端证书所在的位置。在那里，IE 会询问您使用哪个证书。

布兰登

# javascript - 变量是否“通过引用”更新？

> ID：697293
> 
> 赞同：3
> 
> 时间：2009-03-30T13:51:37.727
> 
> 标签：javascript, scope

我有以下简单的脚本。

```
<script>
SPC = {
    a : [10],
    b : 10,

    t: function()
    {
        y = this.a;
        z = this.b;
        y[0]++;
        z++;
        alert('this.a[0] = ' + this.a[0] + '\nthis.b = ' + this.b)
    }
}

SPC.t();
SPC.t();
</script> 
```

在浏览器中运行它会显示两个警告框：

这个.a[0] = 11 这个.b = 10

和

这个.a[0] = 12 这个.b = 10

问题是，为什么 this.a[0] 的值会增加？我正在分配“y = this.a”并将“y”的元素更新为“y[0]++;”？

同时，“b”也发生了完全相同的事情：“z = this.b; z++”。然而，“this.b”仍然等于 10。

如何在不影响“this.a”的情况下在本地范围内更改“y[0]”的值？

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-30T13:55:18.953

`a`是一个数组，您只需将对该数组的引用复制到`y`. 您需要将数组`a`的*内容*复制到一个*新数组* `y`中（使用`Array.slice()`(`y = a.slice()`在您的情况下) 是最简单的方法）。

（或者，如果您只需要`a[0]`，您可以设置`y = a[0]`。后续更改`y`不会影响`a[0]`，因为您正在复制该值。）

[有关详细信息，请参阅本文](http://www.hunlock.com/blogs/Mastering_Javascript_Arrays)的“Javascript 数组通过引用分配”和“将数组作为值传递”部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T14:00:07.270

试试[Array.slice()](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Array/slice)函数。

```
y = this.a.slice() 
```

这将创建数组的副本`a`并将其分配给`y`. 所以修改`y`不会影响`a`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T13:59:16.087

您正在将数组 a 和 b 的地址值分配给 y 和 z。因此，y 和 z 成为 a 和 b 的精确副本。而不是将地址值分配给 y 和 z。您只需要获取 a 和 b 的内容值并将它们分配给 y 和 z y = a[0]

z = b[0]

然后是 y++

# sql - 根据变量的类型在 SQL 中进行条件分支

> ID：697295
> 
> 赞同：3
> 
> 时间：2009-03-30T13:52:23.310
> 
> 标签：sql, sql-server, sql-server-2005, tsql

我从可以是整数或 nvarchar 的表中选择一个值。它存储为 nvarchar。我想有条件地调用一个函数，如果它是一个整数（也就是说，如果它可以转换成整数），它将转换这个值，否则我想选择不转换的 nvarchar。

这是命中 SQL Server 2005 数据库。

```
select case
    when T.Value (is integer) then SomeConversionFunction(T.Value)
    else T.Value
end as SomeAlias

from SomeTable T 
```

请注意，我遇到问题的是“（是整数）”部分。提前致谢。

**更新**

检查对伊恩答案的评论。它解释了为什么和什么更好一点。感谢大家的想法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T14:00:41.730

```
 select case
     when ISNUMERIC(T.Value) then T.Value 
     else SomeConversionFunction(T.Value)
 end as SomeAlias 
```

另外，您是否考虑过使用 sql_variant 数据类型？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-30T14:11:44.997

结果集的每一列只能有一个与之关联的类型，如果第一行转换为整数并且后面有字符串，则会出现错误：

消息 245，级别 16，状态 1，行 1 将 nvarchar 值 'word' 转换为数据类型 int 时转换失败。

试试这个看看：

```
create table  testing
(
strangevalue   nvarchar(10)
)

insert into testing values (1)
insert into testing values ('word')
select * from  testing

select
    case
        when ISNUMERIC(strangevalue)=1 THEN CONVERT(int,strangevalue)
        ELSE strangevalue
     END
FROM testing 
```

最好的办法是返回两列：

```
select
    case
        when ISNUMERIC(strangevalue)=1 THEN CONVERT(int,strangevalue)
        ELSE NULL
     END AS StrangvalueINT
    ,case
        when ISNUMERIC(strangevalue)=1 THEN NULL
        ELSE strangevalue
     END AS StrangvalueString
FROM testing 
```

或者您的应用程序可以测试数字并进行特殊处理。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-30T13:57:16.263

您不能有一个有时是整数，有时是字符串的列。返回字符串并在客户端代码中使用 int.TryParse() 检查它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-30T14:00:21.747

[数字](http://msdn.microsoft.com/en-us/library/ms186272(SQL.90).aspx)。但是，这接受 +、- 和小数，因此需要做更多的工作。

但是，您不能将列同时作为两种数据类型：您需要 2 列。

我建议您在客户中处理此问题或使用[ISNUMERIC 替换](http://www.sqlteam.com/forums/topic.asp?TOPIC_ID=59049)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-30T14:00:29.563

IsNumeric 将为您提供帮助。然后，您可以添加一些进一步的代码来检查它是否是整数

例如：

```
select top 10 
    case 
        when isnumeric(mycolumn) = 1 then 
            case 
                when convert(int, mycolumn) = mycolumn then
                    'integer'
                else
                    'number but not an integer'
            end
        else 
            'not a number'
    end 
from mytable 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-30T14:11:19.943

为了澄清其他一些答案，您的 SQL 语句不能在一列中返回不同的数据类型（看起来其他答案是说您不能在一列中存储不同的数据类型 - 你的都是严格的表示）。

因此，如果您使用 ISNUMERIC 或其他函数，则该值将被转换为表中的字符串，如果选择了其他字符串，则无论如何都会返回该字符串。

如果您只选择一个值，那么它可能会返回一个字符串或一个数字，但是您的前端代码将需要能够返回不同的数据类型。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-30T14:14:34.443

只是为了添加一些关于无法在同一列中返回不同数据类型的其他评论......数据库列应该知道它们持有什么数据类型。如果他们不这样做，那应该是一个很大的危险信号，表明您在某处存在设计问题，这几乎可以保证未来的头痛（就像这个）。

# asp.net - 使用 web developer 2008 的简单搜索引擎

> ID：697304
> 
> 赞同：0
> 
> 时间：2009-03-30T13:54:27.910
> 
> 标签：asp.net, sql-server, vb.net, search

我现在正在做一个简单的电子商务网站，只是练习而已

我遇到的问题是如何在网站上进行简单的搜索？

即，如果我想在网站的数据库中搜索“iphone”这个词。

我怎样才能做到这一点？以及如何指定要在其中搜索的列而不是搜索整个表？

我正在使用 Visual Web Developer Express 2008 和 SQL Server 2008

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T14:18:24.067

我可能会简化此操作，但如果您想在指定表中搜索指定的 varchar 列，请执行以下操作：

一。在 SQL Server 中创建一个新的存储过程，该过程采用 @IN_SearchValue 等输入参数。

> 创建过程 SearchProc @IN_SearchParam varchar(200) AS BEGIN SELECT * FROM TableName t WHERE t.ColumnName LIKE '%' + @IN_SearchParam + '%' END

二。在 .Net 中引用此内容。一种可能的选择是使用 SQlConnection 对象和 SqlCommand 对象设置来使用上述过程。已经有很多例子了。

三。将您的结果交付给您的用户！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T14:05:06.900

一种选择是使用 SQL Server 2008 中内置的全文搜索。您可以在[此 Microsoft 站点](http://msdn.microsoft.com/en-us/library/ms142571.aspx)上阅读有关它的更多信息。

简而言之，您指定要用于全文搜索的列（例如“标题”和“文本”列），在数据库中对其进行配置，然后使用常规查询进行全文搜索搜索（参见[此处](http://msdn.microsoft.com/en-us/library/ms142488.aspx)的示例）。

另一种选择是使用像[Lucene.NET](http://incubator.apache.org/lucene.net/)这样的框架进行全文搜索，这肯定需要更多的设置工作，但性能更好，尤其是当您有很多记录要搜索时。

# c# - 当所有表达式都丢失时，C# for 循环会做什么。例如 for(;;) {}

> ID：697307
> 
> 赞同：8
> 
> 时间：2009-03-30T13:55:21.057
> 
> 标签：c#, .net, syntax, for-loop

我只能假设这是一个无限循环。

我可以在 for 循环中省略三个表达式中的任何一个吗？省略时是否每个都有默认值？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-30T13:56:20.103

是的，这是一个无限循环。

例子：

`for (; ;) { }`（又名：螃蟹）

`while (true) { }`

`do { } while (true)`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-30T14:00:15.837

这确实是一个无限循环。

在引擎盖下，编译器/抖动会将其优化为（有效地）一个简单的 JMP 操作。

它实际上也与以下内容相同：

```
while (true)
{
} 
```

（除了这也被优化掉了，因为 while 表达式的 (true) 部分通常需要某种比较，但是在这种情况下，没有什么可比较的。继续循环！）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-30T13:56:42.147

是的，这是一个无限循环。您可以省略这三个表达式中的任何一个，但根据我的经验，它通常是第一个或全部 3 个。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-30T13:57:25.420

这是一个无限循环。实际上，它与此相同：

```
while (true)
{
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-30T14:04:16.840

`for (; ;) { }`是无限循环，你是对的。

如果你想使用它，那么你必须在你的循环体中加入一些条件，以便它可以从循环中退出。

```
for (; ;) 
{
    if (conditionTrue)
        break;
    else
        continue;
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-30T13:57:14.687

没有默认值。什么都没有初始化，什么都没有增加，也没有完成测试。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-30T14:00:18.627

第一部分和第三部分没有默认值（它们默认为空，它会起作用）。条件表达式的默认值`true`将`for(;;)`有效地进行无限循环。（如果默认值应该是`false`，那么拥有这样的构造将毫无用处）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-30T13:56:15.673

就像在 C 和 C++ 中一样，您可以省略这三个中的任何一个，或三个都省略。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-30T18:52:50.297

[Microsoft 的 C# Programmer's Reference](http://msdn.microsoft.com/en-us/library/ch45axte(VS.71).aspx)说：

> for 语句的所有表达式都是可选的；例如，以下语句用于编写无限循环：

```
for (;;) {
   ...
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-30T13:56:58.260

这是一个无限循环:)。

# asp.net - ASP.NET MVC 与 ASP.NET WebForms 的“陷阱”是什么？

> ID：697316
> 
> 赞同：2
> 
> 时间：2009-03-30T13:57:20.040
> 
> 标签：asp.net, asp.net-mvc, webforms

### 有关的：

> [MVC的实际应用|| 何时使用或不使用 MVC](https://stackoverflow.com/questions/292557/practical-application-of-mvc-when-to-use-or-not-use-mvc)

我最近浏览了整个 NerdDinner pdf 并使用最终的 ASP.NEt MVC 构建进行了示例，并且给我留下了深刻的印象。在我开始在我们的开发团队中吹捧它非常棒之前，我还想知道这个新堆栈的一些陷阱或误用。我能否获得关于何时不使用它的大纲或解释？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T13:59:34.370

看看这篇文章：

[MVC的实际应用|| 何时使用或不使用 MVC](https://stackoverflow.com/questions/292557/practical-application-of-mvc-when-to-use-or-not-use-mvc)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T13:59:19.287

使用为带有 MVC 的 ASP.Net webforms 构建的控件可能非常棘手甚至不可能，具体取决于控件。

# python - 如何在 Python 中获取类的文件路径？

> ID：697320
> 
> 赞同：114
> 
> 时间：2009-03-30T13:58:59.647
> 
> 标签：python, class, introspection

给定 Python 中的 C 类，我如何确定该类是在哪个文件中定义的？我需要可以从 C 类或 C 类实例中工作的东西。

我这样做的原因是因为我通常不喜欢将属于同一文件夹的文件放在一起。我想创建一个使用 Django 模板将自身呈现为 HTML 的类。基本实现应根据定义类的文件名推断模板的文件名。

假设我在文件“base/artifacts.py”中放置了一个类 LocationArtifact，那么我希望默认行为是模板名称是“base/LocationArtifact.html”。

* * *

## 回答 #1

> 赞同：157
> 
> 时间：2009-03-30T14:14:55.707

您可以使用[检查](http://docs.python.org/library/inspect.html#inspect.getfile)模块，如下所示：

```
import inspect
inspect.getfile(C.__class__) 
```

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2009-03-30T14:05:42.530

尝试：

```
import sys, os
os.path.abspath(sys.modules[LocationArtifact.__module__].__file__) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-30T14:17:09.977

这对 Django 来说是错误的方法，并且真的很强迫。

典型的 Django 应用程序模式是：

*   **/项目**
    *   **/应用名称**
        *   模型.py
        *   视图.py
        *   **/模板**
            *   索引.html
            *   等等

# sharepoint - 登录到 WSS 3.0 服务器上的 ULS 日志

> ID：697325
> 
> 赞同：5
> 
> 时间：2009-03-30T13:59:45.383
> 
> 标签：sharepoint, wss, wss-3.0

我有一个场景，我只在服务器上安装了 WSS 3.0，我希望能够登录到 ULS 日志。在大多数情况下，我在同一台服务器上安装了 MOSS 2007，并且可以使用类/方法 Microsoft.Office.Server.Diagnostics.PortalLog.LogString 但在这种情况下这不是一个选项。

其他人是否能够成功登录到仅 WSS 服务器上的 ULS 日志？如果没有，您是否使用日志组件而不是 log4net 等，或者您如何记录？强烈建议记录到 ULS 日志。

TIA，马格努斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T19:00:21.730

微软在 MSDN 上用这个[例子记录了它](http://msdn.microsoft.com/en-us/library/aa979522.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-30T17:32:33.273

我将 log4net 与来自 Codeplex 的 ULS LogAppender 一起使用：http: [//splog4net.codeplex.com/](http://splog4net.codeplex.com/)

详细信息在这里： http: [//geekswithblogs.net/dotnetrodent/archive/2008/09/11/125079.aspx](http://geekswithblogs.net/dotnetrodent/archive/2008/09/11/125079.aspx)

log4net 在这里： http: [//logging.apache.org/log4net/index.html](http://logging.apache.org/log4net/index.html)

我发现这是最好的解决方案，因为我记录的位置和方式会随着客户端的变化而变化，而 log4net 允许我非常轻松地重新配置它。

# html - 页面稳定的平均 div 限制是多少？

> ID：697326
> 
> 赞同：3
> 
> 时间：2009-03-30T13:59:50.173
> 
> 标签：html

前段时间我发现[这个网站](http://www.c-point.com/javascript_vector_draw.htm)有一个 API 可以使用 div 在 javascript 中绘制东西。

我尝试使用它，但注意到随着 div 数量的增加，页面的稳定性（尤其是选择、复制、粘贴）降低了。

现在我要编写一个将生成大量 div 的网络应用程序，我想知道它是否会影响它的稳定性。

为了使网页保持稳定并避免超载，可以使用的 div 的平均限制是多少？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T14:28:31.353

浏览器和应用程序特定。我不知道这方面有什么好的指标或资源，而且由于每个 javascript 应用程序在使用 div 方面都是独一无二的，我认为没有硬性限制。

对于某些浏览器上的某些设计，它会是一个较低的数字，而在其他浏览器上相同的设计可能会更高，而不同的设计可能相反。

有几个不同的因素需要考虑：

*   浏览器中的 DOM 处理
*   在浏览器中渲染
*   Javascript引擎
*   浏览器如何连接上述项目、队列事件、触发器等

我相信你会得到好的信息的唯一方法是做一些测试来展示你期望你的应用程序实现的行为。

但是，如果有办法避免额外的 div，那就接受吧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T13:20:10.197

不幸的是，您发现创建大量的 DIV 会为页面添加大量额外的内容并使浏览器不稳定。

在您创建应用程序之前，最好仔细测试不同浏览器对大量 div 的反应。

动态生成类似于您的新 Web 应用程序输出的网页并试验每个 div 的数量并不难。

我预计性能也会有很大差异，具体取决于所使用的浏览器。

# event-handling - 从 VSTO 插件订阅 Outlook 事件

> ID：697333
> 
> 赞同：4
> 
> 时间：2009-03-30T14:00:26.850
> 
> 标签：event-handling, office-2007, visual-studio-addins

我需要以一种方式与 Outlook 进行交互，当在 Outlook 中删除任务时，我会收到通知，如果该任务的正文中包含文本“HELLO”，则显示一个 MessageBox。

我的插件在 VSTO 2005 中，适用于 Office 2007。

我看到实现这一点的唯一方法是订阅 Outlook 事件，但在谷歌几个小时后，我的调查还没有找到解决方案。

谢谢你的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T16:14:17.620

好吧，在谷歌上呆了几次之后，我找到了我要找的那个

[http://social.msdn.microsoft.com/Forums/en-US/vsto/thread/d22810d9-3bab-4825-a54f-a05244c7f819/](http://social.msdn.microsoft.com/Forums/en-US/vsto/thread/d22810d9-3bab-4825-a54f-a05244c7f819/)

那里的答案很简单，描述一个特定的文件夹并订阅它的移动事件

聪明的答案，对我来说很好。

# java - 如何以编程方式找出我的 PermGen 空间使用情况？

> ID：697336
> 
> 赞同：25
> 
> 时间：2009-03-30T14:00:52.090
> 
> 标签：java, memory-leaks, jvm-hotspot, permgen

我正在尝试`java.lang.OutOfMemoryError: PermGen Space`在 Sun 的 Hotspot JVM 上运行时诊断错误，并且想知道我的程序在各个点使用了多少 PermGen 空间。有没有办法以编程方式找出这些信息？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-03-30T14:21:32.883

你可以使用这样的东西：

```
Iterator<MemoryPoolMXBean> iter = ManagementFactory.getMemoryPoolMXBeans().iterator();
while (iter.hasNext())
{
    MemoryPoolMXBean item = iter.next();
    String name = item.getName();
    MemoryType type = item.getType();
    MemoryUsage usage = item.getUsage();
    MemoryUsage peak = item.getPeakUsage();
    MemoryUsage collections = item.getCollectionUsage();
} 
```

这将为您提供所有类型的内存。您对“Perm Gen”类型感兴趣。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-30T14:05:13.047

试试[`ManagementFactory.getMemoryPoolMXBeans()`](http://java.sun.com/javase/6/docs/api/java/lang/management/ManagementFactory.html#getMemoryPoolMXBeans%28%29)。

# asp.net - 从 App_Code 文件夹中的类访问 App_Data 中的文件

> ID：697339
> 
> 赞同：11
> 
> 时间：2009-03-30T14:01:35.270
> 
> 标签：asp.net

在 ASP.Net 中有 app_data 文件夹，用户无法通过 Web 访问该文件夹。我想在这个文件夹中存储一个文件，并使用 App_Code 文件夹中的一个类从这个文件中读取。

请记住，这里的当前工作目录将是“c:\”、“c:\windows\system32\”等目录，而不是应用程序目录。所以像“../App_Data/somefile”这样的东西不起作用。

关于如何以编程方式访问 App_Data 文件夹中的文件，必须有一些简单的东西我忽略了

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-30T14:10:39.897

您可以像这样访问 App_Data 文件夹：

```
string appdatafolder = Path.Combine(HttpContext.Current.Request.PhysicalApplicationPath, "App_Data"); 
```

我意识到这使用了 HttpContext 对象，但是，如果您在自定义 ASP.NET Membership 提供程序中编写此代码（我自己做过很多次），那么使用 HttpContext 对象应该没有问题。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-30T14:07:19.063

您说您无权访问上下文对象，但尚不清楚为什么会这样。

如果您的代码响应请求而运行，那么您可以通过以下方式访问上下文：-

```
HttpContext.Current 
```

如果您无法使用以下方法访问应用程序的根物理路径：-

```
HttpRuntime.AppDomainAppPath 
```

# c++ - 从函数返回一个二维双精度数组

> ID：697343
> 
> 赞同：1
> 
> 时间：2009-03-30T14:03:33.190
> 
> 标签：c++

我有这个类，在某些时候我正在计算一个包含两个双精度数的数组：

```
double* QSweep::computeIntersection(double m1, double b1, double m2, double b2){
double* v=new double[2];

v[0]= (b2-b1)/(m1-m2);
v[1]= (m1*b2-m2*b1)/(m1-m2);

return v;
} 
```

在该类的另一个函数中，我使用这个数组来处理它的值。根据作为参数传输的值，我为这个由两个 daouble 组成的数组获得了几个值。我想将所有这些值保留在两个双精度数组的数组中。我已经尝试了一些方法，但我遇到了 bur 错误、分段错误或所有问题。欢迎任何想法。

提前谢谢你，马达琳娜

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-30T14:06:18.643

如果它们总是两个值，返回 a 不是更合乎逻辑（也更有用）`std::pair<double, double>`吗？这可能会减轻很多痛苦，尤其是与显式内存管理相关的（因为您正在使用`new`/ `delete`）：

```
std::pair<double, double> QSweep::computeIntersection(
    double m1, double b1, double m2, double b2
) {
    return std::make_pair( (b2-b1)/(m1-m2), (m1*b2-m2*b1)/(m1-m2));
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T14:23:58.353

您的另一个选择是更改签名：

```
void QSweep::computeIntersection(double m1, double b1, double m2, double b2, double& return_v0, double& return_v1)
{
    return_v0 = (b2-b1)/(m1-m2);
    return_v1 = (m1*b2-m2*b1)/(m1-m2);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T14:17:15.403

也许你应该有一个叫做 Intersection 的类型，它可以很快完成：

```
typedef std::pair<double, double> Intersection 
```

或者也许那里应该有更明确的东西，因为 pair 的成员是“第一”和“第二”，也许你可能想要更具描述性的东西。

无论如何，您宁愿按值返回这些东西，也不愿返回指向堆分配内存的指针。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T15:31:21.450

您的示例包含的内容不足以回答您关于它为什么崩溃的问题。

下面的示例将确保没有来自未释放指针的内存泄漏，并保持类似的结构。

```
typedef std::pair<double, double> Intersection;
typedef std::vector<Intersection> Plane;

Intersection QSweep::computeIntersection
  ( double m1
  , double b1
  , double m2
  , double b2) 
{
    return Intersection( (b2-b1)/(m1-m2), (m1*b2-m2*b1)/(m1-m2));
}

main() 
{
  Plane plane;
  while( input ){
    plane.push_back( Intersection( ... ) );
  }
} 
```

可能有其他存储方式，例如，当您使用 double 时，您可以使用 calloc 和 realloc 来维持一块内存的正确大小。（到目前为止，不要推荐它给你的例子）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T16:05:19.623

鉴于你所拥有的是一个包含两个双打的数组，我不怀疑有必要在某个时候提高这个数字。就像，如果在某个时候您决定也添加 3d 功能。因此，我宁愿留在数组中。但是没有必要使用动态数组。使用包装在结构中的数组，例如`boost::array`：

```
boost::array<double, 2> QSweep::computeIntersection(
    double m1, double b1, double m2, double b2
) {
    boost::array<double, 2> array = { (b2-b1)/(m1-m2),  (m1*b2-m2*b1)/(m1-m2) };
    return array;
} 
```

然后你可以将它添加到一个包含这些的向量中：

```
typedef std::vector< boost::array<double, 2> > vec_of_2darray_t;
vec_of_2darray_t v;
v.push_back(computeIntersection(a, b, c, d));
// ... 
```

如果您的目标是简单性和可扩展性，这可能是您可以获得的最佳效果。[`boost::array`](http://www.boost.org/doc/libs/1_38_0/doc/html/array.html)是一个非常小而简单的结构。基本上相当于

```
template<typename T, size_t N>
struct array { T data[N]; }; 
```

当然还有几个函数，比如`operator[]`, `begin()`and`end()`和其他东西。但是没有构造函数，因此您可以像我们上面所做的那样像普通数组一样初始化它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-30T14:21:10.183

使用 a`vector`来维护您的双打历史。如果您继续使用双精度数组，以保持它们，请执行以下操作：

```
std::vector<double*> history;
history.push_back(v); 
```

`delete`请注意，当您使用完向量（或单个向量元素）后，您仍然需要每个元素指向的内存。为了解决这个问题，请使用 a`pair`来跟踪您的原始双打数组（如果您只使用两个），或者使用`vector<double>`.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-31T15:20:24.263

谢谢:)，它与 ​​push_back 一起使用每次在新类型向量中获得的值

```
vector <double *>, 
```

马达利娜

# c# - 有效提取大型可枚举的小型随机子集的最佳方法是什么？

> ID：697344
> 
> 赞同：3
> 
> 时间：2009-03-30T14:03:47.277
> 
> 标签：c#, .net, sorting, random

以随机顺序从 IEnumerable<T> 中获取 n 个项目的最佳方法是什么？

我正在编写一个商店 API，需要从有时巨大的项目枚举中提供一小组随机项目。底层可枚举有时是一个数组，有时是所述数组的惰性求值过滤器。

由于我只是从枚举中获取比例较小的项目，因此最好每次都在枚举中使用某种重复随机索引并进行重复检查，而不是使用现有算法对整个列表进行随机排序并获取 top x ， 对？

有更好的想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T14:09:51.147

在另一个答案中，我提供了一种从序列中返回[单个随机元素](https://stackoverflow.com/questions/648196/random-row-from-linq-to-sql/648240#648240)的方法，只使用一次传递。

我*怀疑*这可以很容易地调整为使用循环缓冲区并选择给定大小的随机序列，但是您必须非常小心才能平衡概率。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-06-08T07:17:14.787

这是另一个想法：

```
using System;
using System.Collections.Generic;
using System.Linq;

namespace RandomElements
{
    class Program
    {
        static IEnumerable<int> GetRandomElements(IEnumerable<int> source, int count)
        {
            var random = new Random();
            var length = source.Count();
            var enumerator = source.GetEnumerator();

            if (length < count)
            {
                throw new InvalidOperationException("Seriously?");
            }

            while (count > 0)
            {
                const int bias = 5;
                var next = random.Next((length / bias) - count - bias) + 1; // To make sure we don't starve.
                length -= next;

                while (next > 0)
                {
                    if (!enumerator.MoveNext())
                    {
                        throw new InvalidOperationException("What, we starved out?");
                    }

                    --next;
                }

                yield return enumerator.Current;

                --count;
            }
        }

        static void Main(string[] args)
        {
            var sequence = Enumerable.Range(1, 100);
            var random = GetRandomElements(sequence, 10);

            random.ToList().ForEach(Console.WriteLine);
        }
    }
} 
```

它只需要遍历一次枚举（如果传入一个ICollection，也就是，否则它需要知道长度）。如果遍历枚举或复制所有元素或其他任何内容的成本很高，这可能会很有用。

我不是统计学家、数学家或魔术师，所以不要反对我，但我发现如果没有在第 22 行引入的“偏见”，我觉得它有点想从序列的后端挑选更多。也许有人可以更多地调整概率？如果枚举真的很昂贵，你可以让它更偏向前面。

欢迎评论。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T14:26:43.573

如果您使用[Knuthe Shuffle](http://en.wikipedia.org/wiki/Fisher-Yates_shuffle)，则可以仅对列表的一部分进行随机随机播放。因此，没有必要仅仅为了获得 n 个随机项而对整个列表进行排序。我不知道这是否可以在您的约束范围内有效地完成，因为您仍然需要在应用算法之前将您抓取的内容转换为列表。

本质上，该策略是抓取一个随机项，将其与列表的第一项交换。下次您需要随机元素时，请跳过第一个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T14:29:13.927

如果你事先知道项目的数量，那么在该范围内计算 n 个随机数，然后用这些索引抓取那些是相当简单的。

# .net - 使用 LINQ to SQL 的关系表上的动态 Where 子句

> ID：697345
> 
> 赞同：6
> 
> 时间：2009-03-30T14:03:48.073
> 
> 标签：.net, linq, linq-to-sql, dynamic, where-clause

我需要关于LinqToSql 中**关系表（一对多）的动态 where 子句的帮助。**

用户从页面中选择条件。（用户选择子句有 4 个输入）

***例如 Customer 表中的 CompanyName 和 CompanyTitle 以及 Order 表中的 OrderDate 和 ShipCity。***

但是**用户可以从页面界面中选择其中的一个或多个，**并且将在代码隐藏处生成动态查询并选择 From LinqToSql。

您可以从其他网页提供类似类型的示例。

![替代文字](https://i.stack.imgur.com/nOMC4.jpg)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-31T14:49:38.720

您是否正在寻找类似的东西，在其中定义“基本”查询，然后评估参数以确定 where 子句是否合适？

```
var result = (from x in context.X
              select x);

if(some condition)
{
    result = result.AsQueryable().Where(x => x.companyName == name);
}
if(some other condition)
{
    result = result.AsQueryable().Where(x => x.companyTitle == title);
}

//return result.ToList();
//return result.FirstOrDefault();
//return result.Count(); //etc 
```

我在您的一条评论中注意到您提到您的表没有通过外键连接？我不确定在没有某种参照完整性或关系的情况下如何获得一对多关系？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-30T14:08:51.727

查看 ScottGu 关于[动态 linq 库](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)的博客。我认为这会有所帮助。

下面是一个同时命中客户表和订单表的查询示例：

```
    变种查询 =
    db.客户。
    Where("City = @0 and Orders.Count >= @1", "London", 10).
    OrderBy（“公司名称”）。
    Select("new(CompanyName as Name, Phone)");

```

上面的查询来自[Visual Studio 的 C# 示例](http://msdn.microsoft.com/en-us/bb330936.aspx)。下载并查看 \LinqSamples\DynamicQuery 文件夹，您会发现更多示例。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-31T05:05:47.813

取决于您希望它的动态程度 - 正如其他人已经建议的那样，System.Linq.Dynamic 命名空间添加了一些简洁的功能，用于编写在设计时所涉及的实体/成员（表/列）未知的查询。在这种情况下，听起来所涉及的实体和成员是已知的，您只需要在不同的字段之间交替使用 where 子句标准。这是一个例子：

```
from cust in dc.Customer
join ord in dc.Order on cust.CustomerID equals ord.CustomerID
where (companyName == null || cust.CompanyName == companyName)
  and (companyTitle == null || cust.CompanyTitle == companyTitle)
  and (orderDate == null || ord.OrderDate == orderDate)
  and (shipCity == null || ord.ShipCity == shipCity)
select new {cust, ord} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-23T12:19:50.610

RobS 提供了我认为最有吸引力的解决方案。但是，这是我使用的方法，但后来我意识到它实际上是在完整执行第一个查询（Linq-To-SQL），然后仅使用 LINQ 执行后续的 .Where() 子句。所以这不是一个可行的解决方案，因为整个数据集都会被枚举，然后在内存中被过滤掉。

如果我错了，请纠正我 - 但这是我注意到的。

# outlook - 如何在 Outlook 中访问鼠标事件？

> ID：697358
> 
> 赞同：0
> 
> 时间：2009-03-30T14:05:58.520
> 
> 标签：outlook, vsto, outlook-2007, outlook-addin

有什么方法可以访问 Outlook 2007 中的鼠标事件？我知道您可以访问自定义表单区域的鼠标事件。但是我想访问检查员的鼠标事件。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-10T10:41:56.143

检查员上没有鼠标事件，但它们可能是另一个对您有帮助的事件？从用户的角度来看，您要尝试什么陷阱？

# php - PHP电子邮件数据馈送问题

> ID：697359
> 
> 赞同：0
> 
> 时间：2009-03-30T14:06:08.520
> 
> 标签：php

嗨，我正在尝试从供应商处获取数据馈送。我建立了一个页面并给了他们一个 URL 并告诉他们 httppost csv 数据。

现在我的页面看起来像这样，所以我可以看到我得到的数据是什么样的：

```
$feedData = file_get_contents("php://input");

mail('myemail@gmail.com','data feed from vendor',$feedData); 
```

他们说他们给我发了一些测试数据，我检查了我的电子邮件，我收到了电子邮件，但它是空白的。我不确定是我做错了什么还是他们做错了。

解决这个问题的下一步应该是什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T09:44:23.603

HTTP POST 数据应该存在于`$_POST`. 您应该首先检查这个超全局是否包含任何数据。如果不是，则数据未正确发布到您的 URL。

通过将数据通过电子邮件发送给自己来进行测试是正确的，但是这对于非字符串类型可能会出现问题。您需要确定这`$feedData`是一个字符串并包含数据。

将 var_dump() 与输出缓冲结合使用时，检查变量的类型和内容非常简单。尝试：

```
ob_start();
var_dump($_POST);
$testDump = ob_get_contents();
ob_end_clean();

mail('user@example.com', 'data feed from vendor', $testDump); 
```

测试过程：

1.  将*任何内容发布*到您的 URL 并检查生成的电子邮件是否包含正确的数据。

    如果生成的电子邮件与您期望的不一样，则错误在于您的代码。使用代码，直到测试电子邮件包含根据您发布的数据所期望的内容。

2.  要求供应商发布他们的数据

    检查生成的电子邮件，看看它是否符合您的预期。如果不是，请与供应商核实他们发送的数据的性质——也许您的理解或期望是错误的。重复直到您在测试电子邮件中获得正确的内容。

通过检查测试电子邮件的内容，您可以确定 $_POST 中与您的需求相关的元素，根据需要提取它们并继续开发。

当您的测试电子邮件确实包含您所期望的内容时，请注意 $_POST 内容，以便您可以构建一个相同的 POST 请求，您可以在继续开发时使用该请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T14:15:13.943

检查您使用的是哪种类型，`$feedData`是否符合[要求](http://docs.php.net/manual/en/function.mail.php)。我的猜测是它没有。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T14:17:27.603

http post 数据应该在 $_POST['var'];

尝试这个：

```
mail('myemail@gmail.com','data feed from vendor',var_export($_POST, true)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T14:17:47.400

您是否正在上传文件并使用 php://input 读取它？因为 php://input 不适用于 multipart/form-data

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-31T07:30:12.893

如果您自己托管接收部分，您还可以尝试通过[Wireshark过滤和读取 http 数据包。](http://www.wireshark.org/)

# c - MD5 哈希在服务器上的计算方式不同

> ID：697361
> 
> 赞同：10
> 
> 时间：2009-03-30T14:06:37.020
> 
> 标签：c, linux, macos, md5

我正在运行一些我用 C 编写的代码，它从其他人编写的散列库（md5.c 和 md5.h）中调用 md5 散列功能。我看到的奇怪行为是：

散列工作完美=我散列一个字符串，它得出的确切散列是我已经验证它与多个其他来源的确切散列。

1.  在我的 OSX 机器上编译和运行时，散列功能可以完美运行，并且计算出的散列完全符合其应有的状态。

2.  相同的代码，在基于 Linux 的服务器上上传和编译没有任何更改，它计算不同的（错误的）哈希。

有没有人知道这到底是怎么可能的？过去一周它一直在疯狂，我不明白为什么这甚至是可能的。我还在另一台机器上对其进行了测试，编译并执行，它运行良好。就在我将它上传到服务器时，哈希不再正确。

可以在以下位置找到散列功能文件：http: [//people.csail.mit.edu/rivest/Md5.c](http://people.csail.mit.edu/rivest/Md5.c)

已解决：谢谢大家 这是 64 位架构问题。调试时让我想到这一点真是太烦人了.......

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-30T14:15:02.773

尝试替换（Md5.c 第 41 行）

`typedef unsigned long int UINT4;`

经过

`typedef uint32_t UINT4;`

（如果需要，包括 stdint.h）

在 64 位机器上 long int （通常）是 64 位而不是 32

**编辑**：

我尝试了一个 64 位 opteron 这解决了这个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T14:15:42.693

似乎没有工作的机器是否与其他机器不同（32 位与 64 位）？如果 MD5 实现依赖于机器字长（我没有检查代码），这可能会导致散列不同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T14:15:14.957

不同的编译器可以具有不同级别的标准合规性。如果您遇到不符合标准的编译器，您可能很难看到经过良好测试的代码已被编译为完全不同的工作方式。

也可能发生目标系统是 64 位且代码存在 64 位可移植性问题的情况。

解决问题的唯一方法是调试代码的两个版本的行为不同之处。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T14:15:59.107

抱歉，没有。如果我编译它并在我的 linux x86 机器上运行它，它会产生与 md5sum 实用程序相同的结果：

```
peregrino:$ md5sum csrc/Md5.c
d27fd5f04426a3ccb2390d7517f21b9c csrc/Md5.c
peregrino:$ bin/Md5 csrc/Md5.c
d27fd5f04426a3ccb2390d7517f21b9c csrc/Md5.c

```

在我的 x64 盒子上：

```
圣地亚哥：$ bin/Md5 src/Md5.c
09679964608e3335c5c3e14572373eef src/Md5.c

```

所以它似乎是一个 64 位的问题，而不是一个 linux 的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T14:18:24.497

你确定你是在二进制模式下阅读吗？否则，换行符将在不同的操作系统中以不同的方式转换。

# ruby - Merb 遇到需要宝石的问题

> ID：697362
> 
> 赞同：0
> 
> 时间：2009-03-30T14:06:41.843
> 
> 标签：ruby, rubygems, merb, rmagick

我有 merb 设置，但是当我尝试运行它时，我尝试包含的任何 gem 都会出现问题，例如，我有以下内容：

```
require 'RMagick' 
```

rmagick gem 已安装，并且在 irb 中执行上述操作（在需要`rubygems`按预期工作之后）即使`require 'rubygems'`在我需要 RMagick 之前放置也不能解决问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-30T14:17:57.040

啊哈似乎与我的应用程序下 gems/ 目录中的 frozen(?) gems 混淆了，删除它完全解决了问题。将进一步调查。

# iphone - iPhone 网络应用程序启动屏幕

> ID：697366
> 
> 赞同：14
> 
> 时间：2009-03-30T14:07:43.073
> 
> 标签：iphone, web-applications, fullscreen, iphone-standalone-web-app

我正在开发一个 iPhone 网络应用程序，我正在使用“apple-mobile-web-app-capable”元标记来获得“全屏模式”。当我启动该应用程序时，它会显示我上次加载时离开的页面的图片。看起来应用程序已准备好接收输入，但实际上并没有，这令人困惑。

是否可以更改默认行为并显示空白屏幕，直到准备好接收输入？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-03-04T04:04:34.520

这将为您的 Web 应用程序添加一个启动画面。以下是 iPad（视网膜和非视网膜）、iPhone/iPod Touch（视网膜和非视网膜）和 iPhone 5 所需的尺寸。其中还包括状态栏区域。

[Apple Docs-启动图像](http://developer.apple.com/library/ios/documentation/UserExperience/Conceptual/MobileHIG/LaunchImages.html)、[Apple Docs-图标和图像大小](http://developer.apple.com/library/ios/documentation/UserExperience/Conceptual/MobileHIG/IconMatrix.html#//apple_ref/doc/uid/TP40006556-CH27-SW1)

```
<!-- iPhone (Retina) -->
<link href="http://www.example.com/mobile/images/apple-startup-iPhone-RETINA.jpg" media="(device-width: 320px) and (device-height: 480px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image">

<!-- iPhone 5 -->
<link href="http://www.example.com/mobile/images/apple-startup-iPhone-Tall-RETINA.jpg"  media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image">

<!-- iPad Portrait -->
<link href="http://www.example.com/mobile/images/apple-startup-iPad-Portrait.jpg" media="(device-width: 768px) and (device-height: 1024px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 1)" rel="apple-touch-startup-image">

<!-- iPad Landscape -->
<link href="http://www.example.com/mobile/images/apple-startup-iPad-Landscape.jpg" media="(device-width: 768px) and (device-height: 1024px) and (orientation: landscape) and (-webkit-device-pixel-ratio: 1)" rel="apple-touch-startup-image">

<!-- iPad Portrait (Retina) -->
<link href="http://www.example.com/mobile/images/apple-startup-iPad-RETINA-Portrait.jpg" media="(device-width: 768px) and (device-height: 1024px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image">

<!-- iPad Landscape (Retina) -->
<link href="http://www.example.com/mobile/images/apple-startup-iPad-RETINA-Landscape.jpg" media="(device-width: 768px) and (device-height: 1024px) and (orientation: landscape) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image"> 
```

如果创建与 iPad 兼容的 Web 应用程序，建议同时使用横向和纵向尺寸。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-09-27T02:06:01.347

它必须是 320x460，如果是 320x480，它将无法工作。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-06-24T07:13:22.547

把它放在你的 HEAD 标签之间：

```
<link rel="apple-touch-startup-image" href="image.jpg"> 
```

您使用的图片必须是 JPG 或 PNG，分辨率为 320x460

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-08-03T20:23:12.823

图像必须是 PNG 和 320x460 这仅适用于 iPhone OS 3.0 或更高版本。

# sql - 循环遍历列 SQL

> ID：697367
> 
> 赞同：5
> 
> 时间：2009-03-30T14:08:11.697
> 
> 标签：sql, sql-server, csv, loops

我正在寻找一种方法来循环遍历表的列以生成如下所述的输出。

该表如下所示：

```
ID 名称 OPTION1 OPTION2 OPTION3 OPTION4 OPTION5
1 我的名字 1 1 0 1 1 0
2 我的名字2 0 0 1 0 0

```

输出如下所示：

```
我的名字 1 -> 选项 1、选项 3、选项 4
我的名字 2 -> 选项 3

```

任何这样做的方向都将不胜感激。否则，我想我将不得不使用游标或临时表......数据库引擎是 MSSQL。我在数据库级别进行格式化的原因是将其输出提供给有限的可编程环境。

**更新**：输出可以是任何形式，一个字符串或多行字符串。

**更新**：是否可以通过使用 @str = @str + ... 构建字符串来实现这一点？

**更新**：我改变了输出......这应该更容易。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T15:43:40.283

好吧，如果列数已知，您可以执行以下操作：

```
SELECT  
  MyName + " ->"
  + case OPTION1 when 1 then ' OPTION1' else '' end
  + case OPTION2 when 1 then ' OPTION2' else '' end
  + ...
FROM
 Table 
```

如果在创建查询时列是未知的 - 我可能仍然会使用一些动态创建的 SQL。优点是代码可能执行您想要的操作并且非常简单。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-30T14:16:27.763

您可能想看看 PIVOT Tables。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-30T15:54:08.277

由于您没有深入了解为什么要能够做到这一点的具体需求，我无法确定，但通常当我看到此类问题时，我会想到两件事：

1.  您需要规范化您的数据库。也许“Option1”、“Option2”等没有共同点，但它们也很有可能是您表中的重复组。

2.  在应用程序的显示层处理显示问题 - 即前端，而不是数据库。

正如我所说，也许出于某种特定原因，这些不适用于您的情况，但从我读到的您的问题来看，似乎是这样。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T15:45:41.137

您可以使用系统目录构建动态语句：

[http://msdn.microsoft.com/en-us/library/ms189082.aspx](http://msdn.microsoft.com/en-us/library/ms189082.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-28T05:54:22.547

如果使用数据透视表，您必须确保所有“选项”列具有相同的数据类型和长度。

我建议以下答案：

* * *

```
IF NOT EXISTS( SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME      
 = 'TABLE1' ) 
create table table1
(
   name nvarchar(50),       
   colvalue nvarchar(50)
)
else
  truncate table table1

declare @table nvarchar(50)
set @table = 'yourtable'

declare @column table
(
   ID integer identity,
   colname nvarchar(20)
)

insert into @column
SELECT c.name FROM sys.tables t 
JOIN sys.columns c ON t.Object_ID = c.Object_ID 
WHERE t.Name = @table 
and c.name in ('Option1','Option2','Option3','Option4','Option5')

declare @minID integer, @maxID integer
declare @cmd nvarchar(max)  
declare @col nvarchar(20)
declare @SQLStr nvarchar(max)

select @minID = MIN(ID), @maxID= MAX(ID)
from @column

while @minID <= @maxID
begin
    select @col = colname
    from @column
    where ID = @minID

    set @SQLStr =    
    'insert into table1 (name, colvalue)
    select name,' + @col + '
    from ' + @table + ' 
    where ' + @col + ' <> 0'    

    exec(@SQLStr)

    set @minID = @minID + 1
end

select distinct name, STUFF(
(SELECT  ',' + a.colvalue  AS [text()]
from Table1  a
where a.name = b.name
Order by a.colvalue
for xml PATH('')),1,1,''    ) AS Comments_Concatenated
from Table1 b
group by name, colvalue
ORDER BY name 
```

* * *

您只需通过在插入@column 之前输入您的表名和所需列的列表来修改@table。

无论您是什么数据类型，它都可以正常工作。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-30T14:12:50.767

编辑：

[有没有办法创建一个 MSSQL 函数来将子查询中的多行“连接”到单个分隔字段中？](https://stackoverflow.com/questions/6899/is-there-a-way-to-create-a-mssql-function-to-join-multiple-rows-from-a-subquery-i)

[搜索以前问题的各种解决方案](https://stackoverflow.com/search?q=csv%20sqlserver)

# asp.net - asp.net中的用户会话管理

> ID：697369
> 
> 赞同：0
> 
> 时间：2009-03-30T14:08:33.617
> 
> 标签：asp.net, session

我的客户已经完成了我为他们构建的系统的安全审计。

他们希望它以这样一种方式工作，即如果用户通过 Internet Explorer 登录，当他们通过 Firefox 在同一台机器上（或通过 IE 在另一台机器上）登录时，它会终止第一个会话。

本质上，这意味着将会话信息存储在我想象的数据库中，然后针对它设置一个活动/非活动标志，以便用户 ID、会话 ID、状态（如果用户 ID 具有活动会话），然后终止第一个会话，并创建新会话。

是否有任何内置机制可以使用 .NET 框架执行此操作，或者任何人都可以向我指出一些教程等的方向。

非常感谢，

埃德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T14:23:36.107

首先，在您的用户表中添加一个字段来存储当前使用的会话 ID。可以从您的代码轻松访问此 ID。当用户登录时，存储该 ID。

在每个页面请求上，检查以验证当前会话 ID 是否与用户表中存储的内容相匹配。如果不匹配，则清除当前会话数据并将用户踢回登录屏幕。

这不会阻止用户在 IE 7 中使用多个选项卡，因为 IE7 对每个选项卡使用相同的实例；但它会阻止他们使用多个浏览器实例。

这会起作用的原因是每个浏览器都包含它自己的 cookie 空间。会话根据存储会话 ID 的 cookie 值匹配服务器端，并在每次请求时发送回服务器。

顺便说一句，这不是消除会话劫持的非常有效的方法；这听起来像是安全审计试图阻止的。如果您需要这样做，请更新您的问题，我会更进一步。

**更新**

阻止会话劫持的一种方法是在会话中存储一个随机数并作为浏览器上的 cookie。当下一个请求进来时，验证 cookie 和会话值是否匹配。如果他们不这样做，则重置用户表中的会话 id 变量。这将强制所有会话重新登录。为每个页面请求（发布/获取）创建一个新的随机值。缺点是页面不能加书签；但这可能是可以接受的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T14:25:37.867

我[在博客](http://jberke.blogspot.com/2008/10/limiting-concurent-users-in-aspnet.html)上写了我如何处理这个问题。基本上我们的想法是我们创建一个具有 Guid 的非持久性 cookie。

然后，我们将它与 userId 绑定在服务器上的某个位置（应用程序缓存、数据库等）。然后我们有一个轮询器，它每隔几分钟就会访问一次服务器，如果 cookie 与该值不匹配，我们将用户注销。

# delphi - 同步时间，但忽略时区

> ID：697370
> 
> 赞同：0
> 
> 时间：2009-03-30T14:08:35.753
> 
> 标签：delphi, time, synchronization

我有一个应用程序，我希望它具有同步 Windows 系统时钟的功能，但只设置分钟，除非系统时间是 13:58 并且时间服务器是 14:02，在这种情况下小时应该也被改变。问题是，我不想使用时间服务器小时/天等，因为我希望用户能够将时钟设置为任何时间（无论时区如何），但它仍然可以同步。

例如，即使 Windows 时区是 PST 并且用户在不更改时区的情况下将时钟设置为未来 5 小时，我希望系统能够正确同步，并在未来保持 5 小时。

是否有一种算法可以计算是否应该根据分钟将小时设置为向前还是向后设置一个小时，但不考虑任何时区因素？如果系统是 15:59 而服务器是 16:02，则系统应该设置为 16:02 而不是 15:02（如果它只更改分钟就会这样）。如果系统是15:28，服务器是16:02，系统应该设置为15:02。我已经考虑了一段时间了，但似乎无法理解我将如何去做！

我已经有了获取时间服务器日期和时间的代码，以及系统时间（我使用的是 delphi），所以只需计算如何处理它。

谢谢你的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T14:15:00.590

听起来您真正想要的只是将客户端计算机的 UTC 时间与服务器的 UTC 时间同步，而不管服务器或客户端的时区如何。

您需要找到 API 来获取和设置基于 UTC 的时间。

这*可能*不是您想要的，因为我没有完全理解您的问题，即用户在未来 5 小时内设置他们的机器......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T14:32:59.970

不要忘记有些时区不在小时范围内......如果用户的时钟是 13:30 而服务器是 13:00，你怎么知道用户不是在纽芬兰而不是（比如说) 蒙特利尔。

我认为 Jon 对 UTC 的建议是可行的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-30T14:37:07.603

获取服务器时间，减去N小时，设置本地时间。没有问题。

时间是一个实数。小时、分钟、秒等只是一种演示格式。

如果您必须在计算中包含时区，请使用我的[GpTimezone](http://gp.17slon.com/gp/gptimezone.htm) ( [description](http://17slon.com/blogs/gabr/2008/02/tdm-rerun-3-time-is-simplest-thing.html "时间是最简单的东西") )。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T14:22:28.793

你可以只比较分钟，如果你 > 55 并且系统是 <05，那么增加你的小时。对其他边缘条件也做类似的事情。

# html - 在页面上突出显示 html 时，它会将单词着色为蓝色，但不给它蓝色背景？

> ID：697377
> 
> 赞同：0
> 
> 时间：2009-03-30T14:10:17.027
> 
> 标签：html

我有一个带有一些 html 的简单页面。当我按住并拖动鼠标以突出显示其中的一部分时，例如一个段落，它会将文本的前景色更改为蓝色，它不会像往常一样将前景色更改为白色并将背景色更改为蓝色。有谁知道会导致这种情况的任何事情，例如某个 CSS 设置或其他什么？

如果文本（在这种情况下是段落标签）位于图像上（背景设置为图像），是否会发生这种情况？

有没有办法在突出显示文本时更改文本的突出显示颜色？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-30T14:16:50.290

这正是选择图像的行为。

CSS 不能直接影响这一点；这是浏览器的功能。

**编辑：**您已添加背景设置为图像，但这根本不会影响突出显示。你有示例网址吗？

# c# - 在 WPF 中设置按钮 FlatStyle

> ID：697381
> 
> 赞同：63
> 
> 时间：2009-03-30T14:10:53.937
> 
> 标签：c#, wpf, controls, styles

我刚刚学习了 WPF 中的样式和控件模板如何影响按钮的外观，

我正在尝试设置 Button 的 FlatStyle，在我看到的资源中我找不到任何告诉我如何做到这一点的东西，在 Windows 窗体中这是通过`FlatStyle = Flat`.

在 WPF 中如何做到这一点？

* * *

## 回答 #1

> 赞同：147
> 
> 时间：2009-03-30T14:14:34.320

该类`ToolBar`定义了`Style`使`Button`s 看起来扁平的 a。使用它的一个例子是：

```
<Button Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}"/> 
```

这也适用于`ToggleButton`使用`ToggleButtonStyleKey`.

WPF 允许您完全重新设置控件的样式以使它们看起来像您想要的任何东西，这就是它在控件上没有这样特定`FlatStyle`属性的原因`Button`。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-10-05T10:19:18.620

将以下内容添加到您的窗口/页面资源中：

```
<Style BasedOn="{StaticResource {x:Static ToolBar.ButtonStyleKey}}" TargetType="Button"></Style> 
```

它将平面样式应用于该样式范围内的所有按钮。

# c# - 如何以编程方式处理 telnet 连接延迟？

> ID：697385
> 
> 赞同：1
> 
> 时间：2009-03-30T14:12:13.343
> 
> 标签：c#, telnet, latency, tcpclient, lag

我利用 TcpClient 类来实现 telnet 连接。我不知道的是如何确定响应的结束。似乎一旦 DataAvailable 属性为真，我从 Stream 中读取数据，然后 DataAvailable 临时设置为 false，而缓冲区正在填充另一块数据，但我认为已全部读取并消失。如何确保已阅读所有回复？

您可能会建议我如何更改下面的代码片段以使其正常工作。当我单步执行代码时它可以正常工作，因为有足够的时间来检索整个响应。感谢你的帮助。

```
if (this.Stream.DataAvailable)
{
    readBuffer = new Byte[this.Client.ReceiveBufferSize];
    do
    {
        // read data
        bytes = this.Stream.Read(readBuffer, 0, readBuffer.Length);
        Thread.Sleep(10);
        responseData = String.Concat(responseData, System.Text.Encoding.ASCII.GetString(readBuffer, 0, bytes));

       } while (this.Stream.DataAvailable);

       allDataRead = true;
       break;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T14:19:06.913

对于 Telnet 等应用程序的 TCP 连接，没有传输结束这样的概念。您经常会发现 telnet 客户端在用户输入它们时一次发送每个按键，并且由服务器决定何时采取行动，通常是在它收到换行符时。其他客户端可能会缓冲几个客户端按键并一次全部发送。

从您的应用程序的外观来看，您应该寻找换行符以指示传输结束。

```
do    
{      
     bytes = this.Stream.Read(readBuffer, 0, readBuffer.Length);             
     responseData = String.Concat(responseData, System.Text.Encoding.ASCII.GetString (readBuffer, 0, bytes));       
} while (this.Stream.DataAvailable && !responseData.Contains("\n")); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T14:22:32.320

我认为为此目的使用 DataAvailable 不是一个好主意。你的回应的结尾是你的协议所说的。

最好使用诸如 Read 之类的阻塞调用来读取您的内容，并使用您已建立的任何协议来确定阅读更多内容和阅读量。可能不是您想要的所有数据都返回，因为当您读取所有数据时，Read 不会返回，但是当读取一些数据时，您需要检查读取了多少。

如果您的协议是 Telnet，您可能希望响应接收到的每一个字节，就像您想要回显它或处理命令或其他什么的终端一样。

DataAvailable 可能适合检查调用时 Read 是否会阻塞（它将返回缓冲区中的任何内容），但它会使您的循环不那么简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T14:23:58.447

这是一个实际的远程登录连接，即您是连接到远程登录服务器还是通过“远程登录”您真的是指“TCP/IP 套接字”？

首先判断服务器是否在传输完成时断开连接。如果是这样，您可以简单地阅读直到流结束。否则，如果没有，您将不得不在数据中使用提示来确定读取是否完成。在这方面，不同的协议以不同的方式工作，所以如果你能启发我们了解协议，我们可能会给出更直接的答案。方法通常分为两个阵营：包括在响应开头的字节/字符计数（接收者只需读取那么多字节/字符）或使用标记来分隔响应的结尾（接收者读取直到收到分隔符）。

# xml - 使用 linq to xml 解析 IIS 配置 xml 文档

> ID：697389
> 
> 赞同：0
> 
> 时间：2009-03-30T14:14:17.707
> 
> 标签：xml, linq, linq-to-sql, iis

我正在编写一个小应用程序来查找 IIS 引用的所有文件夹。

为此，我获取 IIS 配置文件并解析 xml 以查找名为 IIsWebVirtualDir 的元素并查找 Path 属性。

这是我的代码

```
XDocument doc = XDocument.Load(xmlPath);

                IEnumerable<XElement> elements = doc.Elements();

                foreach (XElement element in elements)
                {
                    elementCount++;
                    foreach (XAttribute attribute in element.Attributes())
                    {
                        if(attribute.Name == "Path")
                        {
                            pathsFound++;
                            String path = attribute.Value + ",";
                            Console.WriteLine(path);
                            pathsAsStr.Append(path);
                        }
                    }
                } 
```

我也尝试过使用 IEnumerable elements = doc.Elements().Descendants("IIsWebVirtualDir");

代码可以编译，但我从来没有找到超过一个元素。为什么是这样？我究竟做错了什么？

我会附上 xml，但它太大了

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T14:30:02.707

尝试这样的事情：

```
int elementCount = doc.Elements().Count();
var elementsWithPathAttribute = doc.Elements().Where(el => el.Attribute("Path") != null);

/*
    The non lamba version would be
    var elementsWithPathAttribute = from el in doc.Elements()
                                    where el.Attribute("Path") != null
                                    select el;
/*

foreach(XElement element in elementsWithPathAttribute)
{
   //do processing here.
} 
```

另一种方法是这样做：

```
using Syste.Xml.XPath;
using System.Xml.Linq;

//....

var elementsWithPathAttribute = 
    doc.Elements.XPathSelectElements("//*[@Path]") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T14:34:27.923

怎么样：

```
var apps = from element in elements
           where element.Attributes["Path"] != null
           select element; 
```

检索您需要的所有元素。您现在拥有一个包含正确元素的 IEnumerable。

# svn - 从 svn repo 中移除外部依赖

> ID：697394
> 
> 赞同：10
> 
> 时间：2009-03-30T14:14:45.100
> 
> 标签：svn, export, tortoisesvn

我在我的一个存储库中创建了外部依赖项。我犯了一个错误，我想删除其中一个依赖项。

我无法删除该文件夹，因为这会从父项目中删除该文件夹。我正在使用 tortoisesvn-client 并且找不到实现此目的的命令，我从属性列表中删除了外部属性，但它似乎不起作用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-30T14:49:04.283

这些是结论：

*   删除外部属性。
*   更改导致问题的文件夹的名称。
*   更新 repo，文件夹将再次添加为空。
*   现在，删除重命名的文件夹。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-30T14:24:01.083

如果您从项目中删除了该属性，这并不意味着本地工作副本已被删除。只需删除外部依赖项的本地工作副本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T14:20:40.933

如果我理解您的问题，您需要从 externals 属性中删除该文件夹（或者如果这是唯一的文件夹，则删除该属性）并签入您的更改。然后您将能够删除该文件夹，该文件夹现在应该是未版本化的。

# c# - 使用 HyperLinkFields 显示详细信息

> ID：697398
> 
> 赞同：1
> 
> 时间：2009-03-30T14:15:11.963
> 
> 标签：c#, asp.net, url, gridview, hyperlink

我有一个 Web 应用程序 (ASP.NET 2.0 C#)，我在其中将数据从 Oracle 数据库获取到 gridview。我在之前的问题中问过如何将这些数据转换为链接，例如，将我带到详细信息页面。这是我得到的答案：

```
<asp:HyperLinkField DataNavigateUrlFields="ID"
     DataNavigateUrlFormatString="DetailPage.aspx?id={0}"
                        DataTextField="CategoryName" NavigateUrl="DetailPage.aspx" /> 
```

这样做会生成 ID 的链接，一旦我单击它，ID 就会出现在下一页的 URL 中。

我的问题是，我应该如何使用 URL 中的这些数据来实际显示有关该 ID 的信息？我必须对我的代码做些什么吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-30T14:18:49.597

是的，在您后面的代码中，您需要从查询字符串中获取 id，将其发送到数据库，并将返回值连接到显示元素。

如果他们可以从查询字符串中提取参数，您可能可以使用 DataSource 来实现这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T14:19:54.243

在 DetailPage 的页面加载上，使用 QueryString 获取 id

```
if(!IsPostBack)
{
    try
    {
        intMyId = (int)Request.QueryString["id"];
        //Do something with intMyId
    }
    catch(InvalidCastException ex)
    {
       //Record and show error message
    }
} 
```

注意：您需要验证 id 是否是有效的 id，因为攻击者可以将他们想要的任何东西放在那里。还要验证用户是否可以查看 id。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T14:20:07.147

您可以使用查询字符串从您的网址中提取数据..

# c# - 可以制作的最简单的访问计数器是什么？

> ID：697413
> 
> 赞同：1
> 
> 时间：2009-03-30T14:18:00.270
> 
> 标签：c#, asp.net

我想计算对我的整个网站的访问次数（或访问者，而不是页面请求或点击次数）。

我想将每次访问存储在数据库中，以便将来使用这些数据显示一些图形。

此外，我希望它可靠、快速且不会为每个页面请求轮询数据库。所以，我想我应该把一些代码放在某个入口点，但我不知道在哪里，而不是在 Global.asax 事件 AppEndRequest 中。我猜想对 SessionStart 或 SessionEnd 事件进行编码。

我怎样才能制作这个访问柜台？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-30T14:39:05.227

使用谷歌分析或类似的东西。这是最简单的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T14:36:12.643

您可以使用自己的软件或使用现有的日志解析软件来解析现有的服务器日志。我知道 Microsoft 的 Log Parser 能够在需要时将日志转换为 sql。如果日志的格式不理解，解析器可以很容易地扩展为使用简单的 com 对象来执行解析。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T14:23:00.070

您只需要更新数据库的计数器值。您可以使用会话开始并将数据库中的计数器值更新 1..

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T14:36:17.700

请注意，Syed 的建议将跟踪*访问者*的数量，而 Jhonny 的建议将跟踪*页面点击*量。你可能想决定你追求哪一个。

假设您想要访问者，我同意 Syed 的观点，在全局中捕获 Session_Start 并在数据库中增加一个数字。

如果您在数据库中存储额外的信息，您可以获得更多有用的信息 - 例如这样的表：

```
tblVisitor
- SessionID nvarchar(32)
- SessionStart datetime 
```

这可能比仅仅增加一个计数器更好，因为您可以检查*上个月*或*今年*的访问者数量等，还可以获得有关时间使用情况的信息。

但是，您确实要求使用最简单的方法，而一个简单的计数器肯定可以做到这一点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T14:53:00.747

*总的来说，我同意 Rashack 的一般原则，即最好的办法是利用擅长*访问者分析的第三方提供的免费服务。除了 Google Analytics，您可能还想考虑[Quantcast](http://quantcast.com)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-30T16:22:11.297

我希望这有帮助

[http://www.aspnettutorials.com/tutorials/performance/applicationsessionobjects-cs.aspx](http://www.aspnettutorials.com/tutorials/performance/applicationsessionobjects-cs.aspx)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-30T14:26:07.177

我认为您可以在 Global.asax 上放置一个全局变量，在 Application_OnEndRequest 和其他页面上增加它，提供将值保存到数据库的代码，作为一项管理任务。

```
void Application_OnEndRequest(object sender, EventArgs e) {
    int visits;
    if (int.TryParse(Application["visits"], out visits)) {
        visits++;
    } else {
        visits = 1;
    }
    Application["visits"] = visits; 
} 
```

# apache-flex - Adobe Flex：可滚动框

> ID：697414
> 
> 赞同：1
> 
> 时间：2009-03-30T14:18:19.317
> 
> 标签：apache-flex, flex3

如果一个动态大小（即宽度 100%）的框不够大，无法容纳它的内容，我如何让该框编码为可滚动而不是将此责任传递给它的父级。我只希望盒子变得与空间一样大。

即在以下示例中，如果您调整浏览器窗口的大小以使文本框不适合（高度），我如何让 box1 显示滚动条而不是整个应用程序？

```
<?xml version="1.0"?>
<mx:Application
    xmlns:mx="http://www.adobe.com/2006/mxml" width="100%" height="100%">

    <mx:HDividedBox width="100%" height="100%">

        <mx:VBox id="box1" backgroundColor="green" height="100%" verticalScrollPolicy="on" clipContent="true">

            <mx:TextInput width="200"/>

            <mx:TextInput width="200"/>

            <mx:TextInput width="200"/>

            <mx:TextInput width="200"/>

            <mx:TextInput width="200"/>

            <mx:TextInput width="200"/>

        </mx:VBox>

        <mx:Box backgroundColor="red" width="100%" height="100%">

        </mx:Box>

    </mx:HDividedBox>

</mx:Application> 
```

我尝试过使用verticalScrollbarPolicy auto 和on，但这没有用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-20T20:56:02.337

因此，您需要将 vbox 包装在画布中，并将 vbox 设置为其内容的相对高度（通过不设置 height 属性）。出于某种原因，它必须是一个画布，而不是另一个 Box 衍生品。这样你就可以得到你想要达到的效果。

```
<mx:Application
    xmlns:mx="http://www.adobe.com/2006/mxml" width="100%" height="100%" verticalScrollPolicy="off">

   <mx:HDividedBox width="100%" height="100%">

        <mx:Canvas id="box1" backgroundColor="green" height="100%" >

            <mx:VBox >
                <mx:Button width="200" />

                <mx:Button width="200"/>

                <mx:Button width="200"/>

                <mx:Button width="200"/>

                <mx:Button width="200"/>

                <mx:Button width="200"/>
            </mx:VBox>

        </mx:Canvas>

        <mx:Box backgroundColor="red" width="100%" height="100%" />
    </mx:HDividedBox>

</mx:Application> 
```

将尝试找出它必须是画布的原因。它在我的脑海中感觉正确，但发现很难表达。希望很快能给你一个解释。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T16:45:18.560

滚动条不会启动，因为它有足够的空间容纳所有子元素。当容器的高度/宽度对于其所有子项的所有组合高度/宽度而言太小时，容器的滚动条就会出现。这是一个简短的示例：

```
<mx:Application
    xmlns:mx="http://www.adobe.com/2006/mxml" width="100%" height="100%" 
        verticalScrollPolicy="off">

    <mx:HDividedBox width="100%" height="600" verticalScrollPolicy="off">

        <mx:VBox id="box1" backgroundColor="green" height="100" 
                    verticalScrollPolicy="auto" clipContent="true">

            <mx:TextInput width="100%"/>

            <mx:TextInput width="100%"/>

            <mx:TextInput width="100%"/>

            <mx:TextInput width="100%"/>

            <mx:TextInput width="100%"/>

            <mx:TextInput width="100%"/>

        </mx:VBox>

        <mx:Box backgroundColor="red" width="100%" height="100%">

        </mx:Box>

    </mx:HDividedBox>

</mx:Application> 
```

# java - 将文件写入磁盘时锁定文件

> ID：697417
> 
> 赞同：3
> 
> 时间：2009-03-30T14:18:52.623
> 
> 标签：java, file-io, file-locking, java.util.concurrent

我有两个并行运行的独立线程 F1 和 F2（准确地说，是 java.util.concurrent.FutureTask 的两个实例）。

F1 做一些处理，然后将结果复制到一个 XML 文件中。然后，它重复这些步骤，直到它无事可做（创建了许多 XML 文件）。F2 在 F1 输出目录中查找，并获取一个文件，对其进行解析，并对其执行一些处理。

这非常有效，只是有时 F2 从文件中获取截断的 XML 数据。我的意思是不完整的 XML，其中不存在某些 XML 节点。问题是它并不总是可复制的，被截断的文件并不总是相同的。因此，我认为当 F1 正在磁盘上写入一个文件时，F2 正在尝试读取同一个文件。这就是为什么有时我会遇到这种错误。

**我的问题**：我想知道是否有某种机制可以锁定（甚至读取）文件 F1 当前正在写入，直到它完全完成将其写入磁盘，所以 F2 在文件解锁之前将无法读取它. 或者任何其他方式来解决我的问题都将受到欢迎！

F1 以这种方式写入文件：

```
try {
    file = new File("some-file.xml");
    FileUtils.writeStringToFile(file, xmlDataAsString);
} catch (IOException ioe) {
    LOGGER.error("Error occurred while storing the XML in a file.", ioe);
} 
```

F2 以这种方式读取文件：

```
private File getNextFileToMap() {
    File path = getPath(); // Returns the directory where F1 stores the results...
    File[] files = path.listFiles(new FilenameFilter() {
        public boolean accept(File file, String name) {
            return name.toLowerCase().endsWith(".xml");
        }
    });
    if (files.length > 0) {
        return files[0];
    }
    return null;
}

// Somewhere in my main method of F2
...
f = getNextFileToMap();
Node xmlNode = null;
try {
    DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
    DocumentBuilder builder = factory.newDocumentBuilder();
    Document doc = builder.parse(f);
    if (doc != null) {
        xmlNode = doc.getDocumentElement();
    }
} catch (Exception e) {
    LOGGER.error("Error while getting the XML from the file " + f.getAbsolutePath(), e);
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-30T14:23:11.957

你看过[`java.nio.channels.FileLock`](http://java.sun.com/javase/6/docs/api/java/nio/channels/FileLock.html)API吗？

一个更简单的解决方案可能是写入一个不同的文件名（例如 foo.tmp），然后在它准备好时重命名它（例如 foo.xml） - 在大多数操作系统上重命名是原子的（在一个目录中），所以当其他进程看到它应该完成的 XML 文件。这可能比锁定要简单得多。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-30T14:23:05.797

由于您已经`.xml`在 F2 中过滤文件，因此将 F1 输出到`.temp`文件，然后将其重命名`.xml`为最后一步。这样，F2 将忽略 F1 正在制作的文件，直到 F1 完全完成它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-30T14:24:43.763

在公共对象上使用关键字[同步](http://java.sun.com/docs/books/tutorial/essential/concurrency/syncmeth.html)，在这种情况下指向文件的文件对象将是最好的：

```
 class MyFileFactory {
     private static HashMap<string,File> files = new HashMap<String,File>();
     public static File get(String name) {
         if (!files.keyExists(name)) {
              files.put(name, new File(name));
         }
         return files.get(name);
     }
 }

 // Another class
 synchronized(File f = MyFileFactory::get("some-file.xml")) {
      // read or write here
 } 
```

# amazon-ec2 - 亚马逊腻子连接

> ID：697424
> 
> 赞同：1
> 
> 时间：2009-03-30T14:20:47.173
> 
> 标签：amazon-ec2, putty

我正在尝试使用 putty 连接到 Amazon EC2，但亚马逊提供的密钥被拒绝。我销毁了所有实例和所有密钥对。然后我创建了新的，仍然是同样的问题。

有人吗？

谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-30T14:24:40.207

您是否阅读了[有关 PuTTY 的 Amazon 文档附录](http://docs.amazonwebservices.com/AmazonEC2/gsg/2007-01-19/putty.html)？它涉及与 PuTTY 连接必须做的事情，因为：

> PuTTY 本身不支持 Amazon EC2 生成的私有密钥格式。幸运的是，PuTTY 有一个名为 PuTTYgen 的工具，可以将密钥转换为其内部格式。

（顺便说一句，这是搜索“putty ec2”时的第一次点击。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T14:26:47.580

有关如何创建可与 Putty 一起使用的密钥的说明，请参阅此[链接。](http://docs.amazonwebservices.com/AWSEC2/latest/GettingStartedGuide/index.html?putty.html)

# sql - 您如何记住/管理您的 SQL 示例？

> ID：697425
> 
> 赞同：7
> 
> 时间：2009-03-30T14:21:09.530
> 
> 标签：sql, sql-server

我目前有一个 SQLTIPS.sql 文件，它位于我的硬盘上，正在工作。

我将在这个文件中添加任何新的或很好的例子，以编写好的 SQL。现在它变得难以管理，我必须在我自己的文件中搜索细节！

我正在寻找可以在 SQL 企业管理器中快速加载的东西，类似于 Visual Studio IDE 代码片段。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-30T14:25:14.123

我将每个示例片段存储在一个单独的 .sql 文件中，给它一些有意义的名称，最好在顶部添加一些注释。

我使用[Dropbox](https://www.getdropbox.com/)在我正在使用的所有机器上使用它，并使用 Google 桌面搜索我需要的东西（然后适当的评论就派上用场了）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-30T14:25:14.963

SQL Management Studio (SQL2005+) 中有片段。您可以在 SQL 2000 及更高版本上使用 Management Studio

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-30T14:37:14.747

我发现这个 T-SQL Factsheet 是一个很好的 PDF，可以放在你的桌子上！

[有用的 T-SQL 简介](http://www.sqlpass.org/portals/24/SqlServerFactsheet.pdf)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-30T14:38:12.453

我在博客上写了我真正想记住的东西……

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-31T15:53:19.503

在 SQL Server 2005 及更高版本中，您可以创建一个或多个项目并将脚本分组到 SQL Server 项目中。很方便。

或者使用模板资源管理器中的 SQL Server 模板 - 非常有助于让（几乎）每天的脚本触手可及！

马克

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-30T15:37:22.060

我会在 SQL Server Management Studio 中使用模板资源管理器（Ctrl-Alt-T，或查看 | 模板资源管理器）。默认情况下已经有一堆非常好的模板/示例，您可以轻松添加它们，按功能分组等。从那里您可以轻松地将它们拖放到脚本中。资源管理器窗口中甚至还有一个搜索功能（右键单击，搜索）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-30T14:24:02.923

我们有一个 Wiki 设置，其中保存了我们使用的所有 SQL 片段。它可搜索且易于更新。

我还应该说这不会取代我们的源代码控制系统。我们将所有表更改、存储过程等保存在 svn 中。我们将 wiki 用于我们需要经常使用的小脚本来更改数据或在系统中运行临时查询，以及我们想要跟踪的提示和技巧之类的东西。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-30T15:04:25.447

我的 SQL 脚本文件夹中有 SYSTEM SCRIPTS，分类为文件夹（性能、临时数据库、安全性、登录等...）

用有意义的名字命名它们 使用 EditPlus 在里面搜索文本

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-30T14:29:51.210

我创建了一个研究数据库，我将所有的研究/示例资料都保存在那里。请注意所有良好做法，以便您可以快速找到要搜索的内容。不确定是否存在一些有助于管理 SQL 片段的东西。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-30T14:48:15.487

我发现在过去 6 或 7 年左右的时间里，我只是在我的计算机上保存了一个名为“SQL 脚本”的文件夹。我已经将我发现有用或有趣的每一个有用和无用的 SQL 片段都放入其中。我在 CD 上保留了一份副本，我或多或少地更新它以保持最新状态。

我从不费心通过 SSMS 查看片段控制，但我可能不得不尝试一下。我们在这里使用 RedGate 的 SQL Prompt，它有一个片段控制，所以对于我经常使用的东西，比如我的对象搜索脚本，我只需要输入 FINDIT 就可以了。

# asp.net - 在 IIS7 上运行 asp.net Web 应用程序项目引发异常

> ID：697429
> 
> 赞同：1
> 
> 时间：2009-03-30T14:21:39.280
> 
> 标签：asp.net, iis, iis-7

我刚刚将一个网站转换为一个 Web 应用程序项目，我收到了这个错误：

```
System.Security.SecurityException: Request for the permission of type 
'System.Web.AspNetHostingPermission, System, Version=2.0.0.0, 
Culture=neutral, PublicKeyToken=b77a5c561934e089' failed. 
```

有任何想法吗？其他一切在 IIS7 上运行良好。该应用程序需要完全信任，我在 web.config 中进行了设置。我是否需要在 IIS 中的某处为其提供完全信任访问权限？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-05T20:04:14.800

我认为缺少的秘诀是进入应用程序池默认值并设置 Load User Profile = True

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T14:35:30.603

看起来像网站根文件夹的权限。IIS7 工作进程是否配置正确？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-23T18:03:04.460

FullTrust 需要由管理员提供。仅通过在 Web.Config 中进行设置，您无法获得对 ASP.NET 应用程序的完全信任。管理员。将需要在 IIS 管理器中执行此操作。

谢谢。

# c# - 数据绑定子类

> ID：697433
> 
> 赞同：0
> 
> 时间：2009-03-30T14:22:48.090
> 
> 标签：c#, data-binding, subclass

假设我有这 3 个课程：

```
public class ClassParent  
{  
public string TestParent { get; set; }  
}

public class ClassChild1 : ClassParent   
{   
public string TestChild1 { get; set; }   
}

public class ClassChild2 : ClassParent
{  
public string TestChild2 { get; set; }  
} 
```

比如说，我已经创建了很多 ClassChild1 和 ClassChild2 类型的对象，并存储在这个 List 中：
List< ClassParent> _Test;

我想将此列表绑定到 GridView
MyGridView.DataSource=_Test;

这可行，但它只显示网格中的一个字段（ClassParent 类中的 TestParent 属性）。我明白为什么：该列表由“ClassParent”对象组成，因此绑定仅使用该类的属性完成。问题是 ClassChild1 和 ClassChild2 类型的对象继承自 ClassParent。

我的问题是：如果我有一个不同类型的对象列表，但它们都继承自同一个类，我如何将所有属性绑定到网格？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T14:31:38.897

属性必须存在于基类中。否则，您将如何在未定义它们的子类中访问它们？（您希望网格显示`ClassChild2.TestChild1`什么？）

解决此问题以适合您的模型应该工作的一种方法是定义`TestChild1`和`TestChild2`作为`ClassParent`对象的虚拟属性，然后在子项中覆盖它们：

```
public class ClassParent  
{  
    public string TestParent { get; set; }  
    public virtual string TestChild1 { get {return null;}}
    public virtual string TestChild2 { get {return null;}}  
}

public class ClassChild1 : ClassParent   
{   
    public override string TestChild1 { get; set; }   
}

public class ClassChild2 : ClassParent
{  
    public override string TestChild2 { get; set; }  
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T14:31:17.757

您可以手动创建列，而不是从类型推断它们。这样，您可以绑定到您想要的任何属性。

# parsing - 词法分析器/解析器工具

> ID：697442
> 
> 赞同：7
> 
> 时间：2009-03-30T14:24:20.597
> 
> 标签：parsing, antlr, bison, lexer, flex-lexer

哪个词法分析器/解析器生成器对于 C 或 C++ 来说是最好的（最容易使用、最快的）？我现在正在使用 flex 和 bison，但 bison 只处理 LALR(1) 语法。*我正在解析的语言实际上*并不需要无限前瞻，但无限前瞻会使解析*变得*容易得多。我应该尝试 Antlr 吗？可可/R？猎鹿犬？还有什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-09-24T05:53:49.400

**2015 年 1 月 5日更新**：

我的**原始答案**指向一个现已删除的问题：

> [在你推荐什么解析器生成器](https://stackoverflow.com/questions/428892/what-parser-generator-do-you-recommend)中已经有很多关于这个问题的好答案

因此，我从[archive.org 上的已删除答案中](https://web.archive.org/web/20100722103458/https://stackoverflow.com/questions/428892/what-parser-generator-do-you-recommend)获取了项目列表，其中至少有 1 票：

*   [包鼠](http://pdos.csail.mit.edu/~baford/packrat/)
*   [猎鹿犬](http://scottmcpeak.com/elkhound/)
*   [蚂蚁](http://www.antlr.org/)
*   [Boost 的精神](https://web.archive.org/web/20100722103458/https://stackoverflow.com/questions/428892/what-parser-generator-do-you-recommend)部分 (C++)
*   [柠檬](http://www.hwaci.com/sw/lemon/)
*   [黄金解析器](http://goldparser.org/)
*   [DMS 软件工程工具包](http://www.semanticdesigns.com/products/DMS/DMSToolkit.html)（非 FOSS）

我自己已经完成了几个 flex/bison 系统，但现在我会用sqlite 的[Lemon](http://www.hwaci.com/sw/lemon/)替换它们，因为它是一个工具，可重入和线程安全，并且具有基于流/拉的模型。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-20T02:51:08.777

坏消息是大多数真正的计算机语言不是“LALR(1)”，这意味着你必须求助于相当多的黑客才能让 YACC 解析真正的语言。

如果您正在设计 DSL，则可以使用任何 LALR 解析器生成器而不会遇到很多麻烦，因为您可以在解析器生成器发出声音时更改 DSL 的语法。出于同样的原因，LL 解析器生成器也大多在这里工作，但缺少左递归可能是一个真正的痛苦。

如果您喜欢自己的语法，那么 GLR 解析器就是不折不扣的赢家。我们在[DMS Software Reengineering Toolkit](http://www.semanticdesigns.com/Products/DMS/DMSToolkit.html)中使用它们，并为包括 C++ 在内的 30 多种语言构建了生产质量解析器，C++ 有一个民间定理说它几乎不可能解析。民间定理是由使用 LL 和 LALR 解析器来尝试处理 C++ 的人们开始的。GLR 很容易做到。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-15T04:40:17.700

ANTLR 使用 'backtrack' 选项使无限前瞻变得非常容易。它还可能符合您的“最容易使用、最快”的标准，因为它具有 ANTLRWORKS，可让您可视化和调试语法。

另一个优点是，它内置了对构建 AST 的支持，这使得构建 AST 变得非常容易，而这在 bison 中是缺失的。

出版了两本书——“ANTLR: Definitive guide”和“Language design patterns”，它是可用的工具之一。您还有一个非常活跃的邮件列表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T15:59:49.573

我不知道您到底在寻找什么，但我认为 Boost [Xpressive](http://www.boost.org/doc/libs/1_38_0/doc/html/xpressive.html)值得一看...

不完全是解析器生成器，而是处理语法的好工具，我觉得它可以处理奇怪的语法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T16:08:20.880

我一直在使用 GOLD 解析系统 ( [http://www.devincook.com/goldparser](http://www.devincook.com/goldparser) )，结果非常好。我的项目很小，是一个 C 语言的 NC 文件解析系统。但我认为该工具也可以处理更复杂的项目。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-28T01:08:58.430

最新的野牛声称可以通过（实际上）同时进行多个解析来进行无限前瞻。如果您已经对野牛进行了投资，那么可能值得尝试一下，而不是切换到另一个包。

[http://www.gnu.org/software/bison/manual/bison.html#GLR-Parsers](http://www.gnu.org/software/bison/manual/bison.html#GLR-Parsers)

不过，我自己并没有使用过这个功能。

至于其他系统，我使用过 ANTLR。我不是特别喜欢它（文档不是很好，必须手动考虑语法以适应运算符优先级），但它确实有效，而且很多人都发誓它当然值得一看。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-05-16T20:14:59.663

[LRSTAR 9.1](http://lrstar.tech)可以生成 LR(1) 和 LR(*) 解析器。它是一个基于 C++ 的系统，对 Windows 和 Visual Studio 很友好。它创建了表驱动的解析器和表驱动的词法分析器，它们体积小且编译速度快。LRSTAR 解析器可以自动构建 AST。

# c# - 在c#中，当从函数返回字符串时，内存是否被释放？

> ID：697456
> 
> 赞同：1
> 
> 时间：2009-03-30T14:27:01.573
> 
> 标签：c#, .net, clr

这就是我的意思：

```
class mycalss
{
   string myfunc()
   {
      string str="hello";
      return str;
   }
}
...
static void main()
{
   string str2;
   str2=myfunc();
   ...
   ...
} 
```

在这种情况下，垃圾收集器是否有可能因为 str 超出范围而删除 str2 的内容？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-30T14:28:32.570

不会。垃圾检测器会看到 str2 对数据有引用，因此不会收集它。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-30T14:28:27.733

不，这里没有风险。引用将被返回，如果垃圾收集器运行，它将能够在 中看到引用`main`，因此它不会释放字符串。

请注意，即使字符串*有*资格进行垃圾收集，它也不会立即被释放 - 只有在垃圾收集器下一次运行时（甚至更晚，取决于它最终在哪一代）。

请注意，垃圾收集器*可以*收集不再使用的对象，即使变量仍在范围内 - 只要它知道不会再次读取该变量：

```
object x = new object();
Console.WriteLine(x);
// Lots more code not touching x
// The object could be collected at any time here 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-30T14:28:44.143

str 和 str2 都是对一个（字符串）对象的引用。垃圾收集器只会回收剩余引用为零的对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T14:31:20.333

不。只要对相同字符串的引用被保存，在这种情况下由 str2 保存。GC 不会收集它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T14:42:54.593

不，垃圾收集器不会删除字符串的内容，原因有两个：

*   您有对字符串的引用，只要有对对象的任何活动引用，垃圾收集器就不会删除它。

*   它是一个字符串文字，因此它是程序集中的一个常量。它在程序集被加载时创建，在程序集被删除时（即应用程序结束时）被删除。垃圾收集器永远不会删除字符串文字。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-30T14:30:44.017

错误的答案：

String 是不可变的，我相信这意味着在您的示例中，您将在内存中拥有字符串的新副本，因此当 str 被清理时， str2 有自己的数据。

乔恩斯基特的澄清：

不——它们都是对同一个字符串对象的引用。它复制**引用**而不是字符串。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-03-30T14:31:07.697

你会没事的。字符串是值类型。通常，当您返回值类型时，您实际上会获得该对象的*副本*。因此，当`str`变量超出范围并被收集时，您的`str2`变量会很好。

现在，因为这些是我们在这里讨论的*字符串*，而不仅仅是任何普通的值类型，所以还有其他一些事情正在发生。您的“hello”字符串很可能由编译器放入字符串表中，并且您的字符串变量将*引用*表中的同一条目，以避免保留相同字符串的大量副本。

无论哪种方式，不要担心它会被收集。

# linq - 打印出 Linq 表达式树层次结构

> ID：697463
> 
> 赞同：15
> 
> 时间：2009-03-30T14:29:01.070
> 
> 标签：linq, string, expression-trees, dynamic-language-runtime

[动态语言运行时 (DLR)](http://msdn.microsoft.com/en-us/library/dd233052.aspx)有一些非常酷的 表达式代码，包括一些非常好的代码来打印我想要使用的表达式树，以便：

```
int a = 1;
int b = 2;
Expression<Func<int, int>> expression = (c) => a + (b * c)
expression.Evaluate(5, stringBuilder) 
```

输出：

```
(5) => a + (b * c) = 11 Where
     a = 1
     b * c = 10 Where
          b = 2
          c = 5 
```

我在网上找到了一些代码来执行此操作，但发现它仅在表达式不带参数时才有效。

[http://incrediblejourneysintotheknown.blogspot.com/2009/02/displaying-nested-evaluation-tree-from.html](http://incrediblejourneysintotheknown.blogspot.com/2009/02/displaying-nested-evaluation-tree-from.html)

然后我发现了类似方法的 DLR 实现。然而，DLR 有自己的 Expression 类和许多其他标准 C# 类型的自定义实现，所以我有点困惑。任何人都知道我可以如何实现上述？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-31T06:51:13.643

怎么样：

```
using System;
using System.Linq;
using System.Linq.Expressions;
using System.Text;
using System.Text.RegularExpressions;

static class Program
{
    static void Main()
    {
        int a = 1, b = 2;
        StringBuilder sb = new StringBuilder();
        Expression<Func<int, int>> expression = (c) => a + (b * c);
        expression.Evaluate(sb, 5);
        // now fix the capture class names (from a and b)
        string s = sb.ToString();
        s = Regex.Replace(s, @"value\([^)]+\)\.", "");
        Console.WriteLine(s);
    }
    public static void Evaluate(this LambdaExpression expr, StringBuilder builder, params object[] args)
    {
        var parameters = expr.Parameters.ToArray();
        if (args == null || parameters.Length != args.Length) throw new ArgumentException("args");
        Evaluate(expr.Body, 0, builder, parameters, args);
    }
    private static StringBuilder Indent(this StringBuilder builder, int depth)
    {
        for (int i = 0; i < depth; i++) builder.Append("  ");
        return builder;
    }
    private static void Evaluate(this Expression expr, int depth, StringBuilder builder, ParameterExpression[] parameters, object[] args)
    {
        builder.Indent(depth).Append(expr).Append(" = ").Append(Expression.Lambda(expr, parameters).Compile().DynamicInvoke(args));

        UnaryExpression ue;
        BinaryExpression be;
        ConditionalExpression ce;

        if ((ue = expr as UnaryExpression) != null)
        {
            builder.AppendLine(" where");
            Evaluate(ue.Operand, depth + 1, builder, parameters, args);
        }
        if ((be = expr as BinaryExpression) != null)
        {
            builder.AppendLine(" where");
            Evaluate(be.Left, depth + 1, builder, parameters, args);
            Evaluate(be.Right, depth + 1, builder, parameters, args);                   
        }
        else if ((ce = expr as ConditionalExpression) != null)
        {
            builder.AppendLine(" where");
            Evaluate(ce.Test, depth + 1, builder, parameters, args);
            Evaluate(ce.IfTrue, depth + 1, builder, parameters, args);
            Evaluate(ce.IfFalse, depth + 1, builder, parameters, args);
        }
        else
        {
            builder.AppendLine();
        }
    }

} 
```

# php - PHP file_get_contents() 返回“打开流失败：HTTP 请求失败！”

> ID：697472
> 
> 赞同：100
> 
> 时间：2009-03-30T14:31:21.017
> 
> 标签：php, api, query-string, file-get-contents

我在从 PHP 代码调用 url 时遇到问题。我需要使用我的 PHP 代码中的查询字符串调用服务。如果我在浏览器中输入 url，它可以正常工作，但如果我使用 file-get-contents() 进行调用，我会得到：

> 警告：file-get-contents(http://....) 无法打开流：HTTP 请求失败！HTTP/1.1 202 接受...

我正在使用的代码是：

```
$query=file_get_contents('http://###.##.##.##/mp/get?mpsrc=http://mybucket.s3.amazonaws.com/11111.mpg&mpaction=convert format=flv');
echo($query); 
```

就像我说的 - 从浏览器调用，它工作正常。有什么建议么？

我也尝试过使用另一个网址，例如：

```
$query=file_get_contents('http://www.youtube.com/watch?v=XiFrfeJ8dKM'); 
```

这很好用......可能是我需要调用的网址中有第二个`http://`吗？

* * *

## 回答 #1

> 赞同：119
> 
> 时间：2009-03-30T14:52:09.127

尝试使用 cURL。

```
<?php

$curl_handle=curl_init();
curl_setopt($curl_handle, CURLOPT_URL,'http://###.##.##.##/mp/get?mpsrc=http://mybucket.s3.amazonaws.com/11111.mpg&mpaction=convert format=flv');
curl_setopt($curl_handle, CURLOPT_CONNECTTIMEOUT, 2);
curl_setopt($curl_handle, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($curl_handle, CURLOPT_USERAGENT, 'Your application name');
$query = curl_exec($curl_handle);
curl_close($curl_handle);

?> 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-03-30T14:37:54.340

这可能是你的问题吗？

> [注意：如果您要打开带有特殊字符（例如空格）的 URI，则需要使用 urlencode() 对 URI 进行编码。](http://docs.php.net/file_get_contents)

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2011-03-23T07:46:51.437

```
<?php

$lurl=get_fcontent("http://ip2.cc/?api=cname&ip=84.228.229.81");
echo"cid:".$lurl[0]."<BR>";

function get_fcontent( $url,  $javascript_loop = 0, $timeout = 5 ) {
    $url = str_replace( "&amp;", "&", urldecode(trim($url)) );

    $cookie = tempnam ("/tmp", "CURLCOOKIE");
    $ch = curl_init();
    curl_setopt( $ch, CURLOPT_USERAGENT, "Mozilla/5.0 (Windows; U; Windows NT 5.1; rv:1.7.3) Gecko/20041001 Firefox/0.10.1" );
    curl_setopt( $ch, CURLOPT_URL, $url );
    curl_setopt( $ch, CURLOPT_COOKIEJAR, $cookie );
    curl_setopt( $ch, CURLOPT_FOLLOWLOCATION, true );
    curl_setopt( $ch, CURLOPT_ENCODING, "" );
    curl_setopt( $ch, CURLOPT_RETURNTRANSFER, true );
    curl_setopt( $ch, CURLOPT_AUTOREFERER, true );
    curl_setopt( $ch, CURLOPT_SSL_VERIFYPEER, false );    # required for https urls
    curl_setopt( $ch, CURLOPT_CONNECTTIMEOUT, $timeout );
    curl_setopt( $ch, CURLOPT_TIMEOUT, $timeout );
    curl_setopt( $ch, CURLOPT_MAXREDIRS, 10 );
    $content = curl_exec( $ch );
    $response = curl_getinfo( $ch );
    curl_close ( $ch );

    if ($response['http_code'] == 301 || $response['http_code'] == 302) {
        ini_set("user_agent", "Mozilla/5.0 (Windows; U; Windows NT 5.1; rv:1.7.3) Gecko/20041001 Firefox/0.10.1");

        if ( $headers = get_headers($response['url']) ) {
            foreach( $headers as $value ) {
                if ( substr( strtolower($value), 0, 9 ) == "location:" )
                    return get_url( trim( substr( $value, 9, strlen($value) ) ) );
            }
        }
    }

    if (    ( preg_match("/>[[:space:]]+window\.location\.replace\('(.*)'\)/i", $content, $value) || preg_match("/>[[:space:]]+window\.location\=\"(.*)\"/i", $content, $value) ) && $javascript_loop < 5) {
        return get_url( $value[1], $javascript_loop+1 );
    } else {
        return array( $content, $response );
    }
}

?> 
```

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2009-03-30T14:42:58.010

`file_get_contents()`使用`fopen()`包装器，因此它被限制通过[`allow_url_fopen`](http://us2.php.net/manual/en/filesystem.configuration.php#ini.allow-url-fopen "PHP.net：allow_url_fopen")php.ini 中的选项访问 URL。

您将需要更改您的 php.ini 以打开此选项或使用替代方法，即[cURL](http://us2.php.net/curl "PHP.net：卷曲") - 迄今为止最流行的，老实说，完成您尝试做的事情的标准方法。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2017-08-29T04:29:21.993

您基本上需要在请求中发送一些信息。

试试这个，

```
$opts = array('http'=>array('header' => "User-Agent:MyAgent/1.0\r\n")); 
//Basically adding headers to the request
$context = stream_context_create($opts);
$html = file_get_contents($url,false,$context);
$html = htmlspecialchars($html); 
```

这对我有用

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2009-03-30T14:38:23.747

我注意到您的网址中有空格。我认为这通常是一件坏事。尝试使用编码 URL

```
$my_url = urlencode("my url"); 
```

然后打电话

```
file_get_contents($my_url); 
```

看看你是否有更好的运气。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-08-13T14:06:00.147

我遇到了类似的问题，我解析了 youtube 网址。代码是；

```
$json_is = "http://gdata.youtube.com/feeds/api/videos?q=".$this->video_url."&max-results=1&alt=json";
$video_info = json_decode ( file_get_contents ( $json_is ), true );     
$video_title = is_array ( $video_info ) ? $video_info ['feed'] ['entry'] [0] ['title'] ['$t'] : ''; 
```

然后我意识到`$this->video_url`包括空格。我使用`trim($this->video_url)`.

也许它会帮助你。祝你好运

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2020-01-24T11:46:59.713

我遇到了类似的问题。

由于超时！

超时可以这样表示：

```
$options = array(
    'http' => array(
        'header'  => "Content-type: application/x-www-form-urlencoded\r\n",
        'method'  => "POST",
        'content' => http_build_query($data2),
        'timeout' => 30,
    ),
);
$context = stream_context_create($options); $retour =
$retour = @file_get_contents("http://xxxxx.xxx/xxxx", false, $context); 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-30T14:36:07.090

我不确定参数（mpaction，格式）是否是为亚马逊页面或##.##指定的。

尝试[urlencode()](http://php.net/urlencode)网址。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2019-06-07T15:47:20.133

```
$query=file_get_contents('http://###.##.##.##/mp/get?' . http_build_query(array('mpsrc' => 'http://mybucket.s3.amazonaws.com/11111.mpg&mpaction=convert format=flv'))); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-01-20T09:54:48.833

这对我有用……我没有使用 curl。

我能够通过浏览器访问特定的 API url，但是在 file_get_contents 中使用时，它给出了错误“无法打开流”。

**然后，我通过使用urlencoding**对所有双引号进行编码来修改我想要调用的 API URL，并保持其他所有内容不变。

样本格式如下：

$url = 'https://stackoverflow.com/questions'.urlencode('"'.$variable1.'"');

然后使用

文件获取内容（$url）；

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-09-14T15:03:41.143

有同样的问题，但这是一个防火墙问题......一旦我将 API 服务器列入白名单，它就可以正常工作，同时使用 get_file_contents($url) 和上面的 curl 方法......

在发现防火墙规则问题之前浪费了几个小时。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-10-14T03:01:29.457

对我来说，问题是`Content-Length`标题中的值不正确。值太大了，所以 nginx 一直在等待其余未到达的内容。

* * *

## 回答 #14

> 赞同：-5
> 
> 时间：2015-06-15T09:57:08.103

用这个

```
file_get_contents($my_url,null,null); 
```

# embedded - 如何为 Avnet Virtex4 使用 OLED 显示器？

> ID：697477
> 
> 赞同：4
> 
> 时间：2009-03-30T14:33:01.310
> 
> 标签：embedded, fpga, xilinx, virtex

我有一个带 OLED 显示屏的 Avnet ADS-XLX-V4FX-EVL12-G（Virtex4 评估板）。我将 Xilinx EDK 10.1 与 Xilinx Platform Studio 10.1 一起使用，并成功将一些基本应用程序上传到板上（串行通信）。

现在我想使用安装在板上的 OLED 显示器，但我不知道如何开始。我找到了 FX12 的 uCLinux 发行版（[http://www.itee.uq.edu.au/~jwilliams/mblaze-uclinux/Downloads/platforms.html#avnet_lx25](http://www.itee.uq.edu.au/~jwilliams/mblaze-uclinux/Downloads/) ），我尝试按照文档中描述的步骤进行操作。当我尝试将 .img 文件下载到指定地址时，它不起作用。我收到以下错误 MDM Peripheral Not Detected on Hardware。他们说我应该使用 EDK 7.1，但我有 10.1。那会是个问题吗？（我从 10.1 开始使用 xmd.exe）。Xilinx上有一个支持答案（[http://www.xilinx.com/support/answers/20060.htm](http://www.xilinx.com/) ) 我必须重新编译网表，但无法在 10.1 中打开项目文件。

无论如何，你能给我一个资源，在那里我可以找到一些使用 OLED 的基本示例吗？即使点亮一个像素也可能是一个很好的起点......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-31T15:44:24.780

您将需要 2 条信息：

1.  电路板的文档 - 它将向您展示显示器如何连接到 FPGA（即引脚）
2.  如果有用于 OLED 的控制器芯片，您也需要与该芯片接口的文档。您可能需要为接口逻辑使用某种微控制器或基本状态机。

然后，尝试一个小小的“hellow world”设计，让你的 OLED 闪烁。然后，继续做更大的事情。

# ruby-on-rails - 文件上传会杀死 Rails 应用程序和服务器

> ID：697483
> 
> 赞同：-1
> 
> 时间：2009-03-30T14:35:16.110
> 
> 标签：ruby-on-rails, ruby, upload, file-upload

我有一个简单的模型，看起来像这样：

```
def video_file=(input_data)
  unless input_data.to_s.empty?
    newfile = File.open("#{RAILS_ROOT}/public/to_upload/#{self.filename}_vid.f4v", "wb") do |f|
      while buff = input_data.read(4096)
        f.write(buff)
      end
    end
  end
end 
```

这里是 rails 设法显示然后死掉的错误，从字面上看。

```
 ActiveRecord::StatementInvalid in <ControllerName> 
```

为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T14:56:57.680

代替

```
newfile = File.open(path, "wb") do |f|
while buff = input_data.read(4096)
  f.write(buff)
end 
```

和

```
if input_data.respond_to?(:read)
  File.open(path, "wb") { |f| f.write(input_data.read) }
end 
```

# iis - 在修复以外的所有情况下，如何在 InstallShield 中执行某些操作？

> ID：697500
> 
> 赞同：0
> 
> 时间：2009-03-30T14:39:18.207
> 
> 标签：iis, windows-installer, installation, installshield, custom-action

我已配置 InstallShield 设置以在 InstallFiles 操作之前从 IIS 中删除某些 VD。该代码在“OnInstallFilesActionBefore”事件中被调用。这工作正常，除了我不希望在设置正在修复时删除 VD。

我发现[这个页面](http://helpnet.acresso.com/robo/projects/devstudio9helplangref/LangrefEventHandlers.htm)列出了可能的事件；但是，似乎我最好的选择是“OnFirstUIBefore”，它只发生在第一次安装时。不过，在那里这样做似乎并不正确。

我最好向其中一个序列添加一个条件，一个会阻止它在修复期间执行代码的条件？还有其他方法吗？

作为记录，我使用的是 DevStudio v9。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T14:42:36.950

是的，只是添加一个条件，没有错。试试`REMOVE~="ALL" OR NOT Installed`。

# asp.net - 通过 Web 服务访问连接字符串

> ID：697504
> 
> 赞同：6
> 
> 时间：2009-03-30T14:40:25.723
> 
> 标签：asp.net, web-services, connection-string

将连接字符串存储在数据库中的想法是一个不正当的想法，但请先听我说完。我们都知道在 web.config 文件中加密连接字符串是最佳实践，但是如果我们完全跳过 web.config 文件呢？

几个月前，我被要求将数据库从一台服务器移动到另一台服务器。这意味着必须更新访问这些不同数据库的每个程序中的连接字符串。这是 2 年来我第三次不得不将数据库从一台服务器移动到另一台服务器。所以我想到了将连接字符串存储在数据库中，并为每个字符串分配一个 GUID，以便通过 Web 服务访问。无需将连接字符串放在 web.config 中，您只需将连接字符串 GUID 存储在 web.config 中，并引用连接字符串 Web 服务，以便您可以请求该连接字符串。加密可以在应用程序级别完成，连接字符串只是加密存储在数据库中。

我已经创建了一个概念证明，它工作正常（它只是在本地 Intranet 上而不暴露在 Internet 上）。

对我来说好处是显而易见的；例如能够快速更新连接字符串，而无需接触 Web 应用程序。这意味着您可以构建一个仅用于编辑数据库中的连接字符串的 Web 应用程序，DBA 可以在其中自己使用它，因此他们在移动数据库时不必打扰程序员。

但好处不是我感兴趣的。我感兴趣的是这里的每个人对做这样的事情的看法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T14:51:55.523

将连接字符串从主 web.config 中取出，并将它们放在单独的配置文件中。然后，此文件对于您的所有应用程序都是相同的，因此如果它们必须更改，您只需将相同的文件复制并粘贴到所有应用程序文件夹中，而不是单独编辑每个配置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T14:52:58.377

我可以看到的主要缺点是明显的性能损失（如果您随后缓存连接字符串）以及您可能会引入所有应用程序的单点故障（除非您要对该服务进行负载平衡，这将似乎有点矫枉过正）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T14:42:32.207

当您的网络服务更改位置时怎么办？然后，无论如何您都必须更新所有 web.configs。

您的应用程序是在同一台服务器上，还是分布在几台服务器上？您可以编辑机器 web.configs 以包含数据库连接字符串以节省大量重复。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T14:46:40.980

我倾向于做两件事之一。我会将连接存储在 Machine.Config 中，或者我将创建一个仅引用 DB 服务器的新主机名。然后我在hosts文件中放了一条记录。

这样做的好处是，当我从本地机器移动到开发 qa 或生产环境时，我永远不必更改配置文件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-12-29T14:44:19.423

非常有趣的问题。我找到了它，因为我只是有同样的想法。

在我看来，它与 UDDI 非常相似，它为您提供了另一层间接性，可能会增强安全性并提高可维护性（除了单点故障，您无论如何都可以解决）。

当然有 DNS 可以解决主机名的问题，但是有了这样的 Web 服务，你就有了难以置信的可能性，比如根据谁的要求返回不同的连接字符串（取决于即 SSL 证书或用户/通行证或令牌，目录服务，如 AD、LDAP , 用户角色等 - 天空是极限:)

此外，所有连接字符串都将得到适当的保护，并且无法被好奇的用户窥探。

起初，这个想法似乎不合时宜，但我越想，我就越相信企业级公司可以从引入这样的解决方案中受益匪浅。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-04-12T06:34:38.673

我知道我不是唯一一个有这个想法的人。在考虑了各种自定义应用程序和 Intranet 站点（更不用说众多的数据库和服务器）之后，我最近才开始思考它。在我看来，WCF 服务可以或应该以多种方式返回数据库连接信息：连接字符串、实际连接或只是服务器和数据库名称。此外，服务本身应该可能从可用于管理各种连接点的中央辅助数据库和表中获取其信息。例如：给我会计数据库连接，生产或开发等。

# ruby-on-rails - 在 Ruby 中创建 Microsoft Word (.docx) 文档

> ID：697505
> 
> 赞同：50
> 
> 时间：2009-03-30T14:40:57.237
> 
> 标签：ruby-on-rails, ruby, ms-word, documents

有没有一种在 Ruby 应用程序中创建 Word 文档 (.docx) 的简单方法？实际上，就我而言，它是从 Linux 服务器提供的 Rails 应用程序。

类似于[Prawn](http://prawn.majesticseacreature.com/)的 gem，但用于[DOCX](http://en.wikipedia.org/wiki/DOCX)而不是 PDF 会很棒！

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-03-30T17:01:35.383

如前所述，似乎没有任何库可以在 Ruby 中操作 Open XML 文档，但[OpenXML Developer](http://openxmldeveloper.org/)拥有关于 Open XML 文档格式的完整文档。

如果您想要发送为每个用户定制的标准文档（如套用信函）的副本，那么它应该相当简单，因为 DOCX 是一个 ZIP 文件，其中包含目录层次结构中的各个部分。拥有一个 DOCX“模板”，其中包含您想要发送给`all`用户的所有部分和树结构（没有实际内容），然后只需创建包含您想要的用户特定内容的新（或修改现有）片段并注入它在将其发送给用户之前，将其放入 ZIP（DOCX 文件）中。

例如：您可能拥有`document-template.xml`包含*Dear [USER-PLACEHOLDER]: 的*内容。当用户请求该文档时，您将其替换`[USER-PLACEHOLDER]`为用户名，然后将结果添加`document.xml`到`your-template.docx`ZIP 文件（其中将包含您在 Word 文档中所需的所有图像和其他部分）并将该结果文档发送给用户。

请注意，如果您将`.docx`文件重命名为`.zip`它，则可以轻松探索内部部件的结构和格式。您可以使用任何 ZIP 操作工具或以编程方式使用代码轻松删除或替换图像或其他部分。

如果不访问 API 以简化工作，则从原始 XML 生成具有完全自定义内容的全新 Word 文档将非常困难。如果您确实需要这样做，您可以考虑安装[Mono](http://www.mono-project.com/Main_Page)，然后使用 VB.NET、C# 或[IronRuby](http://www.ironruby.net/)使用[Open XML Format SDK 1.0](http://msdn.microsoft.com/en-us/library/bb448854.aspx)创建您的 Open XML 文档。由于您只是使用[Microsoft.Office.DocumentFormat.OpenXml.Packaging 命名空间](http://msdn.microsoft.com/en-us/library/microsoft.office.documentformat.openxml.packaging.aspx)来操作 Open XML 文档，因此它在 Mono 中应该可以正常工作，这似乎支持 SDK 所需的一切。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-07-28T16:39:30.143

也许这颗宝石对你来说很有趣。

[https://github.com/trade-informatics/caracal/](https://github.com/trade-informatics/caracal/)

它像虾，但带有 docx。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-30T18:38:10.910

您可以使用[Apache POI](http://poi.apache.org/)。它是用 Java 编写的，但[作为扩展与 Ruby 集成](http://poi.apache.org/poi-ruby.html)

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-08-20T17:35:10.263

这是一个老问题，但有一个新答案。如果您想将 HTML 文档转换为 Word (docx) 文档，只需使用“htmltoword”gem：

[https://github.com/karnov/htmltoword](https://github.com/karnov/htmltoword)

我不确定为什么会有答案蔓延，每个人都开始发布模板解决方案，但这回答了 OP 的问题。就像 Prawn，除了 Word 而不是 PDF。

**更新：**

还有[pandoc和一个名为](http://johnmacfarlane.net/pandoc/)[docverter](http://www.docverter.com/)的 pandoc的 API 包装器。由于 pandoc 是一个 haskell 库，因此两者的安装都有些复杂。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-03-30T14:43:05.560

我知道如果您将 HTML 文档作为扩展名为 .doc 的 word 文档提供，它会在 Word 中正常打开。只是不要做任何花哨的事情。

**编辑：**这是一个使用经典 ASP 的示例。[http://www.aspdev.org/asp/asp-export-word/](http://www.aspdev.org/asp/asp-export-word/)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-08-22T14:30:17.313

使用与 Grant Wagner 建议的非常相似的技术，我创建了一个 Ruby html to word gem，它应该允许您轻松地从您的 ruby​​ 应用程序输出 Word docx 文件。[您可以在http://github.com/nickfrandsen/htmltoword](http://github.com/nickfrandsen/htmltoword)查看它- 只需传递一个 html 字符串，它就会创建一个相应的 word docx 文件。

```
def show
  respond_to do |format|
    format.docx do
      file = Htmltoword::Document.create params[:docx_html_source], "file_name.docx"
      send_file file.path, :disposition => "attachment"
    end
  end
end 
```

希望你觉得它有用。如果您有任何问题，请随时打开 github 问题。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-02-21T16:25:03.550

披露：我是 docxtemplater 项目的负责人。

我知道您正在寻找一个 ruby​​ 解决方案，但是因为所有其他解决方案只告诉您如何在全球范围内执行此操作，而没有为您提供完全符合您要求的库，所以这里有一个基于 JS 或 NodeJS 的解决方案（两者都适用）

[DocxTemplate 库](https://github.com/edi9999/docxtemplater)

[库的演示](http://javascript-ninja.fr/docxgenjs/examples/demo.html)

您也可以在命令行中使用它：

```
npm install docxtemplater -g

docxtemplater <configFile>

----config.docxFile: The input file in docx format
----config.outputFile: The outputfile of the document 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-07-23T01:20:12.033

这是 Doccy ( [doccyapp.com](https://www.doccyapp.com) ) 有一个 api 的一种方式，它可以做你可以使用的事情。支持 docx、odt 和 pages，如果你喜欢也可以转换为 PDF

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-01T22:52:35.790

除了格兰特的回答，您还可以向 Word 发送“Flat OPC”文件，该文件本质上是解压缩并连接起来的 docx 文件以创建单个 xml 文件。这样，您可以在一个文件中替换 [USER-PLACEHOLDER] 并完成（即不压缩或解压缩）。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-01-30T21:21:08.617

如果有人还在看这个，这篇文章解释了如何使用 XML 数据源。这对我很有效。

[http://seroter.wordpress.com/2009/12/23/populating-word-2007-templates-through-open-xml/](http://seroter.wordpress.com/2009/12/23/populating-word-2007-templates-through-open-xml/)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-02-07T01:51:47.593

查看这个 github 存储库：[https ://github.com/jawspeak/ruby-docx-templater](https://github.com/jawspeak/ruby-docx-templater)

它允许您从 word 模板创建文档。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-03-30T15:06:09.453

如果你在 Windows 上运行，当然，这是一个 WIN32OLE 的问题和 Word COM 对象的一些痛苦。

不过，您很有可能在 *nix 环境中提供服务。Word 2007 使用“ [Microsoft Office Open XML](http://en.wikipedia.org/wiki/Office_Open_XML) ”格式 (*.docx)，可以使用[Microsoft 的相应兼容包](http://office.microsoft.com/en-us/word/HA100444731033.aspx)打开该格式。

一些较新的 Office 应用程序（至少是 2002/XP 和 2003）有[自己的 XML 格式](http://en.wikipedia.org/wiki/Microsoft_Office_XML_formats)，这些格式也可以使用。

遗憾的是，我不知道有任何 Ruby 工具可以让这个过程变得更容易。

如果可以接受，我想我会倾向于使用重命名的 html 文件路径。我刚刚从 WordXP 将文档保存为 HTML，将其重命名为 .doc 并毫无问题地打开它。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-06-09T13:02:52.097

我遇到了同样的问题。不幸的是，我无法操作 xml，因为我的客户应该自己填写模板。而且这样做并不总是可行的（例如，office for mac 不允许这样做）。

为了解决这个问题，我做了一个简单的gem，可以作为嵌入ruby的rtf文档模板：[https ://github.com/eicca/rtf-templater](https://github.com/eicca/rtf-templater)

我对其进行了测试，它可以正常填写报告和文件。但是，对于复杂的循环和条件，格式设置很差。

# c++ - DCOM 服务器调试

> ID：697510
> 
> 赞同：1
> 
> 时间：2009-03-30T14:42:33.910
> 
> 标签：c++, atl

我正在学习 DCOM，我需要调试我创建的一个类，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T14:58:54.977

编写一个最简单的客户端，先执行 CoInitialize()，然后执行 CoCreateInstance()。

在服务器的 DllGetClassObject() 中插入延迟（例如调用 Sleep()） - 使用 ATL，您可以获得完整的源代码。

在客户端调用 CoCreateInstance() 之后，将调试器附加到服务器主机进程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T18:26:49.453

我认为[DebugBreak](http://msdn.microsoft.com/en-us/library/ms679297(VS.85).aspx)可能对此有很大帮助。您只需要在调试版本中添加条件编译行以允许执行此行，调试器就会启动。另一种方法是将调试器附加到进程并在进程中设置断点..

# c# - L2E Web 应用程序的连接字符串

> ID：697512
> 
> 赞同：0
> 
> 时间：2009-03-30T14:42:50.147
> 
> 标签：c#, .net, entity-framework, linq-to-entities, connection-string

我们有一个具有 L2E 对象上下文的类库 (ProjA)。这将用于网站 (ProjB) 和 WCF 服务 (ProjC)。如何在网站 (ProjB) web.config 中指定连接字符串，以便它使用类库项目 (ProjA) 中的资源文件。

```
connectionString="metadata=res://*/db.csdl|res://*/db.ssdl|res://*/db.msl;provider=System.Data.SqlClient;provider connection string=&quot;Data Source=localhost;Initial Catalog=db;Integrated Security=True;MultipleActiveResultSets=True&quot;" providerName="System.Data.EntityClient" 
```

我尝试用 ProjA 全名替换 *，但它无法加载该 dll

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-30T16:35:44.933

* 应该可以正常工作。这意味着“搜索所有加载的程序集”。因此，只要在您尝试实例化 ObjectContext 之前加载库程序集（根据我的经验，这几乎按照定义是正确的），那么就会找到 EDMX。

# sql - T-SQL中等效的拆分函数？

> ID：697519
> 
> 赞同：137
> 
> 时间：2009-03-30T14:45:02.843
> 
> 标签：sql, sql-server, tsql, sql-server-2008

我正在寻找将 '1,2,3,4,5,6,7,8,9,10,11,12,13,14,15...' （逗号分隔）拆分为表格或表格变量.

有没有人有一个函数可以连续返回每一个？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-12-04T12:06:32.343

试试这个

```
DECLARE @xml xml, @str varchar(100), @delimiter varchar(10)
SET @str = '1,2,3,4,5,6,7,8,9,10,11,12,13,14,15'
SET @delimiter = ','
SET @xml = cast(('<X>'+replace(@str, @delimiter, '</X><X>')+'</X>') as xml)
SELECT C.value('.', 'varchar(10)') as value FROM @xml.nodes('X') as X(C) 
```

或者

```
DECLARE @str varchar(100), @delimiter varchar(10)
SET @str = '1,2,3,4,5,6,7,8,9,10,11,12,13,14,15'
SET @delimiter = ','
;WITH cte AS
(
    SELECT 0 a, 1 b
    UNION ALL
    SELECT b, CHARINDEX(@delimiter, @str, b) + LEN(@delimiter)
    FROM CTE
    WHERE b > a
)
SELECT SUBSTRING(@str, a,
CASE WHEN b > LEN(@delimiter) 
    THEN b - a - LEN(@delimiter) 
    ELSE LEN(@str) - a + 1 END) value      
FROM cte WHERE a > 0 
```

这里还有更多相同的方法[如何拆分逗号分隔的字符串？](http://social.msdn.microsoft.com/Forums/en-IE/transactsql/thread/4126a010-6885-4eb0-b79c-c798c90edb85)

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2009-03-30T14:52:36.023

这是一些老式的解决方案：

```
/*
    Splits string into parts delimitered with specified character.
*/
CREATE FUNCTION [dbo].[SDF_SplitString]
(
    @sString nvarchar(2048),
    @cDelimiter nchar(1)
)
RETURNS @tParts TABLE ( part nvarchar(2048) )
AS
BEGIN
    if @sString is null return
    declare @iStart int,
            @iPos int
    if substring( @sString, 1, 1 ) = @cDelimiter 
    begin
        set @iStart = 2
        insert into @tParts
        values( null )
    end
    else 
        set @iStart = 1
    while 1=1
    begin
        set @iPos = charindex( @cDelimiter, @sString, @iStart )
        if @iPos = 0
            set @iPos = len( @sString )+1
        if @iPos - @iStart > 0          
            insert into @tParts
            values  ( substring( @sString, @iStart, @iPos-@iStart ))
        else
            insert into @tParts
            values( null )
        set @iStart = @iPos+1
        if @iStart > len( @sString ) 
            break
    end
    RETURN

END 
```

在 SQL Server 2008 中，您可以使用 .NET 代码实现相同的目的。也许它会工作得更快，但这种方法肯定更容易管理。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2016-03-19T20:54:07.450

您已标记此 SQL Server 2008，但此问题的未来访问者（使用 SQL Server 2016+）可能想了解[`STRING_SPLIT`](https://msdn.microsoft.com/en-gb/library/mt684588.aspx).

有了这个新的内置函数，您现在可以使用

```
SELECT TRY_CAST(value AS INT)
FROM   STRING_SPLIT ('1,2,3,4,5,6,7,8,9,10,11,12,13,14,15', ',') 
```

此功能的一些限制和一些有希望的性能测试结果在[Aaron Bertrand 的这篇博](http://sqlperformance.com/2016/03/t-sql-queries/string-split)文中。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2011-07-06T00:46:28.857

对于熟悉该功能的人来说，这与 .NET 最相似：

```
CREATE FUNCTION dbo.[String.Split]
(
    @Text VARCHAR(MAX),
    @Delimiter VARCHAR(100),
    @Index INT
)
RETURNS VARCHAR(MAX)
AS BEGIN
    DECLARE @A TABLE (ID INT IDENTITY, V VARCHAR(MAX));
    DECLARE @R VARCHAR(MAX);
    WITH CTE AS
    (
    SELECT 0 A, 1 B
    UNION ALL
    SELECT B, CONVERT(INT,CHARINDEX(@Delimiter, @Text, B) + LEN(@Delimiter))
    FROM CTE
    WHERE B > A
    )
    INSERT @A(V)
    SELECT SUBSTRING(@Text,A,CASE WHEN B > LEN(@Delimiter) THEN B-A-LEN(@Delimiter) ELSE LEN(@Text) - A + 1 END) VALUE      
    FROM CTE WHERE A >0

    SELECT      @R
    =           V
    FROM        @A
    WHERE       ID = @Index + 1
    RETURN      @R
END

SELECT dbo.[String.Split]('121,2,3,0',',',1) -- gives '2' 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2013-01-30T09:29:31.073

这是你问的拆分功能

```
CREATE FUNCTION [dbo].[split](
          @delimited NVARCHAR(MAX),
          @delimiter NVARCHAR(100)
        ) RETURNS @t TABLE (id INT IDENTITY(1,1), val NVARCHAR(MAX))
        AS
        BEGIN
          DECLARE @xml XML
          SET @xml = N'<t>' + REPLACE(@delimited,@delimiter,'</t><t>') + '</t>'

          INSERT INTO @t(val)
          SELECT  r.value('.','varchar(MAX)') as item
          FROM  @xml.nodes('/t') as records(r)
          RETURN
        END 
```

像这样执行函数

```
select * from dbo.split('1,2,3,4,5,6,7,8,9,10,11,12,13,14,15',',') 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-11-25T12:41:10.627

```
DECLARE
    @InputString NVARCHAR(MAX) = 'token1,token2,token3,token4,token5'
    , @delimiter varchar(10) = ','

DECLARE @xml AS XML = CAST(('<X>'+REPLACE(@InputString,@delimiter ,'</X><X>')+'</X>') AS XML)
SELECT C.value('.', 'varchar(10)') AS value
FROM @xml.nodes('X') as X(C) 
```

此响应的来源： http: [//sqlhint.com/sqlserver/how-to/best-split-function-tsql-delimited](http://sqlhint.com/sqlserver/how-to/best-split-function-tsql-delimited)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-09T04:34:18.820

我很想挤进我最喜欢的解决方案。结果表将包含 2 列：PosIdx 表示找到的整数的位置；和整数值。

```
 create function FnSplitToTableInt
(
    @param nvarchar(4000)
)
returns table as
return
    with Numbers(Number) as 
    (
        select 1 
        union all 
        select Number + 1 from Numbers where Number < 4000
    ),
    Found as
    (
        select 
            Number as PosIdx,
            convert(int, ltrim(rtrim(convert(nvarchar(4000), 
                substring(@param, Number, 
                charindex(N',' collate Latin1_General_BIN, 
                @param + N',', Number) - Number))))) as Value
        from   
            Numbers 
        where  
            Number <= len(@param)
        and substring(N',' + @param, Number, 1) = N',' collate Latin1_General_BIN
    )
    select 
        PosIdx, 
        case when isnumeric(Value) = 1 
            then convert(int, Value) 
            else convert(int, null) end as Value 
    from 
        Found 
```

它通过使用递归 CTE 作为位置列表来工作，默认情况下从 1 到 100。如果您需要处理超过 100 的字符串，只需使用 'option (maxrecursion 4000)' 调用此函数，如下所示：

```
 select * from FnSplitToTableInt
(
    '9, 8, 7, 6, 5, 4, 3, 2, 1, 0, ' + 
    '9, 8, 7, 6, 5, 4, 3, 2, 1, 0, ' +
    '9, 8, 7, 6, 5, 4, 3, 2, 1, 0, ' +
    '9, 8, 7, 6, 5, 4, 3, 2, 1, 0, ' +
    '9, 8, 7, 6, 5, 4, 3, 2, 1, 0'
) 
option (maxrecursion 4000) 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2014-04-13T17:14:27.367

```
CREATE FUNCTION Split
(
  @delimited nvarchar(max),
  @delimiter nvarchar(100)
) RETURNS @t TABLE
(
-- Id column can be commented out, not required for sql splitting string
  id int identity(1,1), -- I use this column for numbering splitted parts
  val nvarchar(max)
)
AS
BEGIN
  declare @xml xml
  set @xml = N'<root><r>' + replace(@delimited,@delimiter,'</r><r>') + '</r></root>'

  insert into @t(val)
  select
    r.value('.','varchar(max)') as item
  from @xml.nodes('//root/r') as records(r)

  RETURN
END
GO 
```

用法

```
Select * from dbo.Split(N'1,2,3,4,6',',') 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2018-07-22T13:51:25.650

这个简单的 CTE 将提供所需的内容：

```
DECLARE @csv varchar(max) = '1,2,3,4,5,6,7,8,9,10,11,12,13,14,15';
--append comma to the list for CTE to work correctly
SET @csv = @csv + ',';
--remove double commas (empty entries)
SET @csv = replace(@csv, ',,', ',');
WITH CteCsv AS (
    SELECT CHARINDEX(',', @csv) idx, SUBSTRING(@csv, 1, CHARINDEX(',', @csv) - 1) [Value]
    UNION ALL
    SELECT CHARINDEX(',', @csv, idx + 1), SUBSTRING(@csv, idx + 1, CHARINDEX(',', @csv, idx + 1) - idx - 1) FROM CteCsv
    WHERE CHARINDEX(',', @csv, idx + 1) > 0
)

SELECT [Value] FROM CteCsv 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-09-23T18:20:25.630

这是另一个真正没有任何限制的版本（例如：使用 xml 方法时的特殊字符，CTE 方法中的记录数），并且基于对源字符串平均长度为 4000 的 10M+ 记录的测试，它运行得更快。希望这个有帮助。

```
Create function [dbo].[udf_split] (
    @ListString nvarchar(max),
    @Delimiter  nvarchar(1000),
    @IncludeEmpty bit) 
Returns @ListTable TABLE (ID int, ListValue nvarchar(1000))
AS
BEGIN
    Declare @CurrentPosition int, @NextPosition int, @Item nvarchar(max), @ID int, @L int
    Select @ID = 1,
   @L = len(replace(@Delimiter,' ','^')),
            @ListString = @ListString + @Delimiter,
            @CurrentPosition = 1 
    Select @NextPosition = Charindex(@Delimiter, @ListString, @CurrentPosition)
   While @NextPosition > 0 Begin
   Set  @Item = LTRIM(RTRIM(SUBSTRING(@ListString, @CurrentPosition, @NextPosition-@CurrentPosition)))
   If      @IncludeEmpty=1 or LEN(@Item)>0 Begin 
     Insert Into @ListTable (ID, ListValue) Values (@ID, @Item)
     Set @ID = @ID+1
   End
   Set  @CurrentPosition = @NextPosition+@L
   Set  @NextPosition = Charindex(@Delimiter, @ListString, @CurrentPosition)
  End
    RETURN
END 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-10-04T12:50:40.410

```
/* *Object:  UserDefinedFunction [dbo].[Split]    Script Date: 10/04/2013 18:18:38* */
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER FUNCTION [dbo].[Split]
(@List varchar(8000),@SplitOn Nvarchar(5))
RETURNS @RtnValue table
(Id int identity(1,1),Value nvarchar(100))
AS
BEGIN
    Set @List = Replace(@List,'''','')
    While (Charindex(@SplitOn,@List)>0)
    Begin

    Insert Into @RtnValue (value)
    Select
    Value = ltrim(rtrim(Substring(@List,1,Charindex(@SplitOn,@List)-1)))

    Set @List = Substring(@List,Charindex(@SplitOn,@List)+len(@SplitOn),len(@List))
    End

    Insert Into @RtnValue (Value)
    Select Value = ltrim(rtrim(@List))

    Return
END
go

Select *
From [Clv].[Split] ('1,2,3,3,3,3,',',')
GO 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-01-16T12:32:35.650

在这里使用*计数表*是 Jeff Moden 的一个拆分字符串函数（最好的方法）

```
CREATE FUNCTION [dbo].[DelimitedSplit8K]
        (@pString VARCHAR(8000), @pDelimiter CHAR(1))
RETURNS TABLE WITH SCHEMABINDING AS
 RETURN
--===== "Inline" CTE Driven "Tally Table" produces values from 0 up to 10,000...
     -- enough to cover NVARCHAR(4000)
  WITH E1(N) AS (
                 SELECT 1 UNION ALL SELECT 1 UNION ALL SELECT 1 UNION ALL 
                 SELECT 1 UNION ALL SELECT 1 UNION ALL SELECT 1 UNION ALL 
                 SELECT 1 UNION ALL SELECT 1 UNION ALL SELECT 1 UNION ALL SELECT 1
                ),                          --10E+1 or 10 rows
       E2(N) AS (SELECT 1 FROM E1 a, E1 b), --10E+2 or 100 rows
       E4(N) AS (SELECT 1 FROM E2 a, E2 b), --10E+4 or 10,000 rows max
 cteTally(N) AS (--==== This provides the "base" CTE and limits the number of rows right up front
                     -- for both a performance gain and prevention of accidental "overruns"
                 SELECT TOP (ISNULL(DATALENGTH(@pString),0)) ROW_NUMBER() OVER (ORDER BY (SELECT NULL)) FROM E4
                ),
cteStart(N1) AS (--==== This returns N+1 (starting position of each "element" just once for each delimiter)
                 SELECT 1 UNION ALL
                 SELECT t.N+1 FROM cteTally t WHERE SUBSTRING(@pString,t.N,1) = @pDelimiter
                ),
cteLen(N1,L1) AS(--==== Return start and length (for use in substring)
                 SELECT s.N1,
                        ISNULL(NULLIF(CHARINDEX(@pDelimiter,@pString,s.N1),0)-s.N1,8000)
                   FROM cteStart s
                )
--===== Do the actual split. The ISNULL/NULLIF combo handles the length for the final element when no delimiter is found.
 SELECT ItemNumber = ROW_NUMBER() OVER(ORDER BY l.N1),
        Item       = SUBSTRING(@pString, l.N1, l.L1)
   FROM cteLen l
; 
```

推荐自**[Tally OH！改进的 SQL 8K “CSV 拆分器”功能](http://www.sqlservercentral.com/articles/Tally+Table/72993/)**

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-08-15T17:16:03.167

[这个博客](http://beyondrelational.com/modules/2/blogs/28/posts/10300/xquery-lab-19-how-to-parse-a-delimited-string.aspx)提供了一个在 T-SQL 中使用 XML 的非常好的解决方案。

这是我根据该博客提出的函数（根据需要更改函数名称和结果类型转换）：

```
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE FUNCTION [dbo].[SplitIntoBigints]
(@List varchar(MAX), @Splitter char)
RETURNS TABLE 
AS
RETURN 
(
    WITH SplittedXML AS(
        SELECT CAST('<v>' + REPLACE(@List, @Splitter, '</v><v>') + '</v>' AS XML) AS Splitted
    )
    SELECT x.v.value('.', 'bigint') AS Value
    FROM SplittedXML
    CROSS APPLY Splitted.nodes('//v') x(v)
)
GO 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-04-06T03:05:32.770

```
CREATE Function [dbo].[CsvToInt] ( @Array varchar(4000)) 
returns @IntTable table 
(IntValue int)
AS
begin
declare @separator char(1)
set @separator = ','
declare @separator_position int 
declare @array_value varchar(4000) 

set @array = @array + ','

while patindex('%,%' , @array) <> 0 
begin

select @separator_position = patindex('%,%' , @array)
select @array_value = left(@array, @separator_position - 1)

Insert @IntTable
Values (Cast(@array_value as int))
select @array = stuff(@array, 1, @separator_position, '')
end 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-05-12T20:06:54.837

这对我很有用[https://www.sqlshack.com/the-string-split-function-in-sql-server/](https://www.sqlshack.com/the-string-split-function-in-sql-server/)

在对这个主题进行了两个小时的研究之后，这是最简单的解决方案（不使用 XML 等）。

你应该只记得在 from 之后使用 string_split。

```
DROP TABLE IF EXISTS #Countries
GO
DROP TABLE IF EXISTS #CityList
GO
CREATE TABLE #Countries
(Continent VARCHAR(100),
Country VARCHAR(100))
GO
CREATE TABLE #CityList
(Country VARCHAR(100),
City VARCHAR(5000))
GO
INSERT INTO  #Countries
VALUES('Europe','France'),('Europe','Germany') 

INSERT INTO #CityList
VALUES('France','Paris,Marsilya,Lyon,Lille,Nice'), ('Germany','Berlin,Hamburg,Munih,Frankfurt,Koln')

SELECT 
CN.Continent,CN.Country,value
FROM #CityList CL CROSS APPLY string_split(CL.City,',')  INNER JOIN 
#Countries CN ON  CL.Country = CN.Country

DROP TABLE IF EXISTS #Countries
GO
DROP TABLE IF EXISTS #CityList 
```

* * *

## 回答 #16

> 赞同：-4
> 
> 时间：2014-01-11T06:03:27.090

你在 sql server 中写这个函数，问题就解决了。

[http://csharpdotnetsol.blogspot.in/2013/12/csv-function-in-sql-server-for-divide.html](http://csharpdotnetsol.blogspot.in/2013/12/csv-function-in-sql-server-for-divide.html)

# math - 为什么我的图像旋转算法不起作用？

> ID：697520
> 
> 赞同：4
> 
> 时间：2009-03-30T14:45:41.747
> 
> 标签：math, image, image-processing

### 尝试 1 和 2：

*注意：*删除了减少问题大小的第一次尝试。有关以前的尝试，请参阅社区 wiki。

### 尝试 3：

根据模糊华夫饼的示例，我已经实现了以下内容，但似乎无法正常工作。有什么想法我可能做错了吗？

```
ImageMatrix ImageMatrix::GetRotatedCopy(VDouble angle)
{
    // Copy the specifications of the original.
    ImageMatrix &source = *this;
    ImageMatrix &target = CreateEmptyCopy();

    double centerX = ((double)(source.GetColumnCount()-1)) / 2;
    double centerY = ((double)(source.GetRowCount()-1)) / 2;

    // Remember: row = y, column = x
    for (VUInt32 y = 0; y < source.GetRowCount(); y++)
    {
        for (VUInt32 x = 0; x < source.GetColumnCount(); x++)
        {
            double dx = ((double)x) - centerX;
            double dy = ((double)y) - centerY;

            double newX = cos(angle) * dx - sin(angle) * dy + centerX;
            double newY = cos(angle) * dy + sin(angle) * dx + centerY;

            int ix = (int)round(newX);
            int iy = (int)round(newY);

            target[x][y][0] = source[ix][iy][0];
        }
    }

    return target;
} 
```

有了这个原型矩阵...

```
1 2 1 
0 0 0 
-1 -2 -1 
```

...prototype.GetRotatedCopy(0)（这是正确的）...

```
1 2 1 
0 0 0 
-1 -2 -1 
```

...prototype.GetRotatedCopy(90)（不正确）...

```
-2 0 0 
-2 0 2 
0 0 2 
```

...prototype.GetRotatedCopy(180) （不正确 - 但有点合乎逻辑？） ...

```
0 -1 -2 
1 0 -1 
2 1 0 
```

...prototype.GetRotatedCopy(270)（不正确 - 为什么这与 0 旋转相同？） ...

```
1 2 1 
0 0 0 
-1 -2 -1 
```

### 解决方案：

正如 Mark Ransom 所指出的，我应该使用弧度，而不是度数；我已将我的代码调整如下：

```
ImageMatrix ImageMatrix::GetRotatedCopy(VDouble degrees)
{
    // Copy the specifications of the original.
    ImageMatrix &source = *this;
    ImageMatrix &target = CreateEmptyCopy();

    // Convert degree measurement to radians.
    double angle = degrees / 57.3;

    // ... rest of code as in attempt #3 ... 
```

感谢您的所有帮助！

```
1 2 1 
0 0 0 
-1 -2 -1 

1 2 1 
0 0 0 
-1 -2 -1 

-1 0 1 
-2 0 2 
-1 0 1 

-1 -2 -1 
0 0 0 
1 2 1 

1 0 -1 
2 0 -2 
1 0 -1 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T15:41:30.867

除非我读错了，否则该算法似乎围绕点 0,0 旋转，这不是您想要的。也许您需要在插入之前将 height/2 和 width/2 添加到行和列值。

```
for (int y = 0; y < 10; y++) { 
   for (int x = 0; x < 10; x++) { 
      VUInt32 newX = (cos(angle) * (x-5)) - (sin(angle) * (y-5)); 
      VUInt32 newY = (sin(angle) * (x-5)) + (cos(angle) * (y-5)); 
      target[newY][newX][0] = source[y][x][0]; 
   } 
} 
```

这基本上将旋转中心从左上角调整到图像的中心。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-31T18:10:48.360

这是我编写的一个完整示例：我认为您可能没有使用过弧度（我们都应该使用并喜欢它）。我将新坐标保留在双打中，这似乎使它不那么挑剔。请注意，我没有做我应该做的边界检查，但我很懒。

如果您需要更快的旋转，您总是可以像这个[例子](http://www.codeproject.com/KB/graphics/rotatebyshear.aspx)一样使用剪切。

```
#include <math.h>
#include <stdio.h>

#define SIZEX 3
#define SIZEY 3

int source[SIZEX][SIZEY] = {
  { 1, 0, 0 },
  { 0, 1, 0 },
  { 0, 0, 1 }
};

int target[SIZEX][SIZEY];

int main () {
  double angle = M_PI/2.0;

  memset(target,0,sizeof(int)*SIZEX*SIZEY);

  double centerX = ((double)(SIZEX-1))/2.0;
  double centerY = ((double)(SIZEY-1))/2.0;

  for (int y = 0; y < SIZEY; y++) {
    for (int x = 0; x < SIZEX; x++) {
        double dx = ((double)x)-centerX;
        double dy = ((double)y)-centerY;
        double newX = cos(angle)*dx-sin(angle)*dy+centerX;
        double newY = cos(angle)*dy+sin(angle)*dx+centerY;

        int ix = (int) round(newX);
        int iy = (int) round(newY);
        target[x][y] = source[ix][iy];
    }
  }

  for (int i=0;i<SIZEY;i++) {
    for (int j=0;j<SIZEX;j++) {
      printf("%d ", target[j][i]);
    }
    printf("\n");
  } 
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-31T19:23:39.107

简短的回答：你做错了。

这本质上是插值中的一个问题，您处理它的方式引入了不连续性。从根本上说，这是因为旋转格子（您的图像放置在其上的规则网格）不会导致在同一个格子上进行另一个采样，除非是非常特殊的情况。

顺便说一句，没有一种正确的方法可以做到这一点，但是在速度和准确性以及可以对原始信号（图像）假设的内容方面存在各种权衡。

那么你的设计参数是什么？您是否需要非常快速或非常准确？你想如何处理混叠？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-30T14:50:16.730

您的 newRow 和 newColumn 公式已切换。请记住，行 = y 和列 = x。

[回转](http://en.wikipedia.org/wiki/Rotation_(mathematics))

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-30T14:56:34.063

问题是您的内存访问超出范围。

旋转后，您的 NewRow 和 NewColumn 可能大于图像的原始宽度/高度。他们甚至可能是负面的。如果你不关心这个事实，你最终会得到垃圾数据（最好的情况）或崩溃。

处理此问题的最常见方法是忽略所有此类像素。您还可以钳制或环绕有效间隔。这是一个填充或平铺效果。

这里显示的是忽略外部像素。

```
int width = 10;
int height = 10;
for (int row = 0; row < height; row++)
{
        for (int column = 0; column < width; column++)
        {
                int newRow = (cos(angle) * row) - (sin(angle) * column);
                int newColumn = (sin(angle) * row) + (cos(angle) * column);

                if ((newRow >=0) && (newRow < width) && 
                   (newColumn >=0) && (newColumn < height))
                {
                  target[row][column][0] = source[newRow][newColumn][0];
                }
        }
} 
```

# c# - 同步服务 Ado.net 冲突解决

> ID：697524
> 
> 赞同：0
> 
> 时间：2009-03-30T14:46:51.090
> 
> 标签：c#, ado.net, syncservices

是否可以使用 ado.net 的同步服务解决客户端冲突？例如，使用客户端插入服务器插入，更新客户端的表 ID（在客户端），tks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-02-13T21:25:15.280

在服务器端，您可以执行以下操作：

```
Partial Public Class NorthwindCacheServerSyncProvider
    Private Sub ApplyChangeFailedEvent(…) Handles Me.ApplyChangeFailed
        Dim clientChanges As DataTable = e.Conflict.ClientChange
        Dim serverChanges As DataTable = e.Conflict.ServerChange
        ' Code to resolve conflict 
           If (clientChanges.Rows(0)("ModifiedDate") > _
               serverChanges.Rows(0)("ModifiedDate") Then e.Action =                      ApplyAction.RetryWithForceWrite 
           End If 
```

您不能在客户端上执行此操作，但是，您可以拦截应用更改事件并采取适当的措施，就像这样......

```
Partial Public Class NorthwindCacheClientSyncProvider
    Private Sub ApplyingChangesEvent(…) Handles Me.ApplyingChanges
        Dim clientChanges As DataSet = e.Changes 
```

# version-control - 最简单的版本控制系统

> ID：697526
> 
> 赞同：8
> 
> 时间：2009-03-30T14:48:09.120
> 
> 标签：version-control

我想建立一个源代码控制系统：

1.  联网，因此用户可以在工作或路上访问它
2.  不需要提供共享，锁模式就足够了
3.  只有三个用户，他们永远不会使用相同的代码
4.  我们没有系统管理员，对该领域的知识也不多，因此设置和配置必须非常简单。
5.  将安装在 Windows 服务器上
6.  开源或免费

请提出建议。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-30T15:12:18.067

最*简单*的系统就是我们这里所说的“Hey Chris”系统。我们有一个每个人都可以安装的网络驱动器，如果你想编辑一些东西，你应该“嘿，克里斯，你在处理 blahblah.cpp 吗？” 克里斯说“不”。然后您编辑 blahblah.cpp，并将其粘贴回共享驱动器...如果您想要版本，只需每晚备份网络驱动器即可。

我从来没有说过这是最好的系统，只是最简单的。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-30T14:51:14.433

[SVN](http://subversion.tigris.org/)涵盖了所有这些，并且很容易设置。

Wrt第2点，共享往往比锁定更好，因为文件被某人锁定，然后去度假/死亡/等。需要由某人解锁，然后才能由其他开发人员处理。SVN 支持“开箱即用”的共享。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-30T15:16:51.237

[Mercurial](http://www.selenic.com/mercurial)或[Git](http://git-scm.com/)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-30T14:52:45.147

尝试[颠覆 (svn)](http://subversion.tigris.org/)。

编辑：Rich 打败了我=D。是的，正如他指出的那样，共享比锁定更好。听起来您是 SourceSafe 用户。这些是我从 SourceSafe 搬出时试图解决的同一组问题 =)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-30T15:03:32.470

我只能将我的声音添加到“使用颠覆”合唱中。但是您还询问了**简单的安装和管理**。

为此，我将指向您[VisualSVN Server](http://www.visualsvn.com/server/)。它是 Windows 上易于使用的服务器安装。它是免费的。

或者，如果您想进行手动设置（可能是因为您不想使用与 visualsvn 服务器捆绑的 apache），请遵循 Jeff 的[Setting up Subversion on Windows](https://blog.codinghorror.com/setting-up-subversion-on-windows/)。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-09-25T13:11:13.947

我知道的最简单的版本控制系统是**Revision Control System RCS**。它是一个命令行实用程序，可在 Linux 系统上开箱即用。它的用法很简单。

**第一的。**在当前目录中，创建一个存放 RCS 信息的目录：

```
$ mkdir RCS 
```

**第二。**将文件存储（签入）到 RCS：

```
$ ci -t-"My notes" notes.txt 
```

原始文件被删除。

**第三。**从 RCS 恢复（签出）原始文件：

```
$ co -u notes.txt 
```

**第四。**根据需要编辑文件，现在可以随时恢复：

```
$ vim notes.txt 
```

RCS 还可以处理二进制文件，并支持对文件进行许多后续更改。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-30T14:53:16.613

我推荐[Tortoise SVN](https://tortoisesvn.net/)。SVN 是一个易于在 Windows 上设置和使用的源代码控制环境，而 Tortoise 是与 Windows 资源管理器集成的附加组件。

尽管使用简单，但它允许不同的人处理同一个文件并合并他们的更改。即使那“不可能发生”我预测在某些时候你会很高兴它以这种方式工作。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-30T15:46:34.910

我真的很喜欢 Git 和[GitHub](http://github.com)。Git 很好，因为每个开发人员都可以签入并查看历史记录，即使他们处于离线状态（例如，在飞机上或在某个偏远的地方），然后在他们重新在线时将他们的更改推送到中央存储库。GitHub 作为中央存储库工作得非常非常好，并且包含许多非常方便的工具，用于查看和评论其他人的签到。

您每天使用的基本命令归结为：

```
git add .
git commit -m "this is a note"
git pull origin master
git push 
```

Git 可以很好地处理大多数冲突，而且速度非常快，因为整个存储库都在每台机器上。

[Kyle Cordes 写了一篇](http://kylecordes.com/2008/03/22/git-windows-works/)关于 Windows 入门的博客文章。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2020-06-06T09:24:50.857

我很惊讶没有人推荐[Fossil](https://www.fossil-scm.org)版本控制系统。它检查所有提问者的要求。它稳定且简单，仅包含一个独立的可执行文件，允许使用 UI 轻松管理并且仅使用 HTTP(s)。是的，在 Windows 上运行。

此外，它还提供了一个不错的 Web 界面，还可以管理错误跟踪和 wiki。

它是由 SQLite 人制作（和使用）的，这对我来说是可靠性的保证。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-30T15:06:52.820

[Darcs](http://darcs.net)提供了所有这些以及更多。它是一个分布式版本控制系统，可以更轻松地访问路上的数据。您可以通过电子邮件或 ssh 发送/接收补丁（类似于修订）。

我最喜欢 darcs 的一点是它非常冗长。它真的试图帮助你。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-30T15:35:41.533

很多关于 SVN 的建议，但我不确定我是否会从管理员的角度称其为“最简单”。您仍然需要设置服务器 IIRC。相比之下，像 Mercurial 这样的 DVCS 并没有区分“存储库”和“工作副本”。要将某些东西放在服务器上（可以是您具有文件共享访问权限的任何文件夹），您只需将其“推送”到那里即可。

你还提到在路上工作。DVCS 在这方面特别擅长。您的笔记本电脑将拥有整个历史记录，因此您只需要在想要推送或拉取时触摸服务器，而不仅仅是进行差异或检查历史记录。

# javascript - iframe 的动态高度

> ID：697528
> 
> 赞同：6
> 
> 时间：2009-03-30T14:48:51.147
> 
> 标签：javascript, html, iframe

我目前正在使用 iframe 的现有网站（叹气！），这些使用起来非常痛苦，而且我在让 iframe 的高度与 HTML 内容的高度成比例时遇到问题。

我尝试了一些在互联网上漂浮的不同脚本片段，但没有一个对我有用。我真的很想使用 jQuery 来做到这一点，但这不是一个选项，因为 IT 想要保持页面加载的大小。

有谁知道这样做的好方法，以一种适用于 FF 和 IE 6+ 的方式？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T14:56:23.750

您应该能够简单地设置高度和宽度参数 - 因为它们都是 iframe dom 元素的有效属性。

```
function resize(width, height) {
  var frame = document.getElementById('my_iframe');
  frame.width = width;
  frame.height = height;
} 
```

当然，这仅适用于您尝试从其父元素（具有实际 iframe 标签的文档）调整 iframe 的大小。如果您尝试从 iframe（iframe 加载的文档）内调整 iframe 的大小，则需要调用父元素的公共函数来执行调整大小。

在 iframe 中： `parent.resize(600, 800);`

# c# - 谁将 app.config 复制到 app.exe.config？

> ID：697529
> 
> 赞同：16
> 
> 时间：2009-03-30T14:48:56.453
> 
> 标签：c#, .net, visual-studio, monodevelop

我正在编写一个游戏开发 IDE，它创建和编译 .NET 项目（我在过去几年一直在研究）并且正在更新它以生成不仅适用于 Windows/Visual Studio 的输出，还用于 Linux/MonoDevelop（.NET 的一个非常简单的过程，但仍需要一些调整）。

作为其中的一部分，我发现有必要开始生成一个 app.config 文件作为其中的一部分，以将依赖的 DLL 名称映射到具有 <dllmap> 元素的 Linux 依赖项名称。我对谁负责将 app.config 文件复制到输出名称 app.exe.config 感到困惑。在 Visual Studio 项目中，app.config 的构建操作似乎通常设置为“无”，其设置表明它不会被复制到任何地方，但是当 Visual Studio 编译项目时，它会生成 app.exe.config (虽然我有时发现这是不可靠的）。当我使用 MSBuild 构建由 IDE 生成的解决方案文件时（用于调试目的），MSBuild 将 app.config 复制到 app.exe.config。但是当我使用 CSharpCodeProvider.CompileAssemblyFromFile 编译项目时，它（自然）不会 t 喜欢将配置文件作为源代码包含在内（“app.config(1,1) : error CS0116: A namespace does not directly contain members such as fields or methods”），当然它不会将其复制到当我不将其作为输入时输出。将 app.config 独立复制到 app.exe.config 是我的责任，还是有更标准的方法？

获取第一个 *.config 文件是硬连线吗？在我的 IDE 中，可以想象 app.config 文件将被重命名或添加另一个文件（就像在 Visual Studio 中一样）。对我来说，IDE 对配置文件有这个秘密操作似乎很奇怪（我认为 MonoDevelop 在这方面的行为类似，因为我也找不到配置文件的特殊操作）。我什至不知道它如何选择此秘密操作适用的文件。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-30T14:51:29.877

C# 编译器根本不关心配置文件。构建环境（MSBuild 和 VS）将负责自己复制该文件。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-03-30T13:24:55.617

命令：

1.  项目目录中的第一个具有无构建操作的 app.config 文件
2.  项目目录中的第一个带有内容构建操作的 app.config 文件
3.  第一个具有无构建操作的 app.config 文件，位于子目录中
4.  第一个带有内容构建操作的 app.config 文件，位于子目录中

msbuild/xbuild 还允许您通过设置 $(AppConfig) 属性来覆盖它。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-08-30T13:00:09.283

一个稍微技术性的答案 - 您的项目`Microsoft.CSharp.targets`通过 csproj 文件中的这个键引用：

```
<Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" /> 
```

`c:\Windows\Microsoft.NET\Framework\v4.0.30319\Microsoft.Common.targets`根据您的框架版本，此文件将解析为类似的内容。

在它里面你有这个部分可以完成工作：

```
 <!--
    ============================================================
                                        _CopyAppConfigFile

    Copy the application config file.
    ============================================================
    -->
  <Target
      Name="_CopyAppConfigFile"
      Condition=" '@(AppConfigWithTargetPath)' != '' "
      Inputs="@(AppConfigWithTargetPath)"
      Outputs="@(AppConfigWithTargetPath->'$(OutDir)%(TargetPath)')">

    <!--
        Copy the application's .config file, if any.
        Not using SkipUnchangedFiles="true" because the application may want to change
        the app.config and not have an incremental build replace it.
        -->
    <Copy
        SourceFiles="@(AppConfigWithTargetPath)"
        DestinationFiles="@(AppConfigWithTargetPath->'$(OutDir)%(TargetPath)')"
        OverwriteReadOnlyFiles="$(OverwriteReadOnlyFiles)"
        Retries="$(CopyRetryCount)"
        RetryDelayMilliseconds="$(CopyRetryDelayMilliseconds)"
        UseHardlinksIfPossible="$(CreateHardLinksForAdditionalFilesIfPossible)"
            >

      <Output TaskParameter="DestinationFiles" ItemName="FileWrites"/>

    </Copy>

  </Target> 
```

App.Config 文件似乎是作为环境变量传递的（它应该存在，但是谁设置的，​​我不知道）：

```
<ItemGroup>
  <AppConfigWithTargetPath Include="$(AppConfig)" Condition="'$(AppConfig)'!=''">
    <TargetPath>$(TargetFileName).config</TargetPath>
  </AppConfigWithTargetPath>
</ItemGroup> 
```

**编辑：**有关如何选择 app.config，请参阅此答案 - [https://stackoverflow.com/a/40293508/492336](https://stackoverflow.com/a/40293508/492336)。

> app.config 的处理是特殊的，它是按名称处理的，构建过程会按照这个顺序选择 app.config 文件：
> 
> *   选择在主项目中设置的值 $(AppConfig)。
> *   在与项目相同的文件夹中选择@(None) App.Config。
> *   选择与项目相同的文件夹中的@(Content) App.Config。
> *   在项目的任何子文件夹中选择@(None) App.Config。
> *   在项目的任何子文件夹中选择@(Content) App.Config。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T15:09:24.047

我认为 MSBuild 负责复制。如果您会挖掘库存 .target 文件，那么您可能会找到相应的指令。VS 本身不会复制。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-31T09:09:12.640

另请注意，Visual Studio 确实验证了配置文件。

# apache - Apache 和 mod_mono 不能一起玩

> ID：697535
> 
> 赞同：1
> 
> 时间：2009-03-30T14:51:23.747
> 
> 标签：apache, mono, centos

我试图让 Mono 在 CentOS 5 上工作，但到目前为止还没有取得太大的成功。这就是我所做的：

```
> yum install mono-web
> yum install xsp
> yum install mod_mono
> echo ":CLR:M::MZ::/usr/bin/mono:" > /proc/sys/fs/binfmt_misc/register 
```

确保 /etc/httpd/conf/httpd.conf 中存在以下行：

```
Include conf.d/*.conf 
```

确保 /etc/httpd/conf.d/mod_mono.conf 存在并且看起来像这样：

```
<IfModule !mod_mono.c>
    LoadModule mono_module /usr/lib/httpd/modules/mod_mono.so

    AddType application/x-asp-net .aspx
    AddType application/x-asp-net .asmx
    AddType application/x-asp-net .ashx
    AddType application/x-asp-net .asax
    AddType application/x-asp-net .ascx
    AddType application/x-asp-net .soap
    AddType application/x-asp-net .rem
    AddType application/x-asp-net .axd
    AddType application/x-asp-net .cs
    AddType application/x-asp-net .config
    AddType application/x-asp-net .Config
    AddType application/x-asp-net .dll
    DirectoryIndex index.aspx
    DirectoryIndex default.aspx
    DirectoryIndex Default.aspx

    <Location /mono-ctrl>
        SetHandler mono-ctrl
    </Location>
</IfModule> 
```

创建 /etc/httpd/conf.d/mono-vhost.conf 并插入以下内容：

```
<VirtualHost *>
    DocumentRoot /var/www/html
    Alias /demo /usr/local/lib/xsp/test
    MonoApplications "/demo:/usr/local/lib/xsp/test"
    MonoServerPath /usr/bin/mod-mono-server2

    <Location /demo>
        SetHandler mono
    </Location>
</VirtualHost> 
```

最后：

```
> apachectl restart 
```

然后我浏览到[http://my.server.ip.address/demo/index.aspx](http://my.server.ip.address/demo/index.aspx)，希望看到一个 ASPx 页面；相反，我的浏览器提示我下载该文件。Apache 错误日志中没有任何内容。

我有其他网站通过 PHP 在这个盒子上运行，它们运行良好，所以我很确定这只是 mod_mono 很奇怪，但对于我的生活，我无法弄清楚问题是什么。如果有人能指出我正确的方向，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-22T11:45:08.390

最终在以下教程的帮助下让它工作：

[http://blog.palehorse.net/2008/11/06/my-adventures-installing-mono-20-on-centos-4-to-work-with-apache-via-mod_mono/](http://blog.palehorse.net/2008/11/06/my-adventures-installing-mono-20-on-centos-4-to-work-with-apache-via-mod_mono/)

虽然它适用于 CentOS 4，但它在 CentOS 5.x 上也同样适用。:)

# ssis - 忽略 SSIS 中执行包任务的错误

> ID：697538
> 
> 赞同：8
> 
> 时间：2009-03-30T14:51:59.643
> 
> 标签：ssis

在 SSIS 包中，我有一个 For Loop Container 任务，其中 EvalExpression 设置为 true（以便它永远运行）。如果 For 循环容器内的任何任务失败，则包必须失败——执行包任务（调用子包）除外。如果失败，那么父包应该转移到下一个任务。

我尝试将 Execute Package 任务的 MaximumErrorCount 设置为 0，但这没有帮助。我尝试将 For Loop Container 任务的 MaximumErrorCount 设置为 0，但这忽略了 For Loop Container 任务中所有任务的错误。

知道如何在 For 循环容器中仅忽略执行包任务上的错误。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-24T18:20:13.273

更好的方法是转到执行包任务的 OnError 处理程序并将系统变量“Propogate”设置为 false。这将阻止错误向上冒泡到您的循环容器。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-30T16:32:34.143

答案是对应该导致包停止的所有任务使用 FailPackageOnFailure 属性，并将 For Loop Container 任务的 MaximumErrorCount 设置为 0。

我在这里得到了答案：http: [//www.microsoft.com/communities/newsgroups/en-us/default.aspx?&query=Ignore +errors+on+Execute+Package+task+in+SSIS&lang=en&cr=&guid= &sloc=en-us&dg=microsoft.public.sqlserver.dts&p=1&tid=6406db48-a2cb-4b0d-a124-4892e976a583](http://www.microsoft.com/communities/newsgroups/en-us/default.aspx?&query=Ignore+errors+on+Execute+Package+task+in+SSIS&lang=en&cr=&guid=&sloc=en-us&dg=microsoft.public.sqlserver.dts&p=1&tid=6406db48-a2cb-4b0d-a124-4892e976a583)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-01-22T22:07:18.460

1.  转到顶部的“事件处理程序”
2.  在左侧选择所需的“可执行文件：”
3.  转到顶部的“事件处理程序”
4.  在中间单击“单击此处为可执行文件'xxx'创建'OnError'事件处理程序
5.  转到“包资源管理器”，找到新创建的 'OnError' 事件 -> 变量 -> 传播
6.  在属性中将值更改为“false”
7.  完毕

# c# - 如何使用 C# 中的 MS DIA SDK？

> ID：697541
> 
> 赞同：8
> 
> 时间：2009-03-30T14:52:14.697
> 
> 标签：c#, .net, debugging, dia-sdk

我正在尝试使用 C# 中的 Microsoft[调试接口访问 SDK](http://msdn.microsoft.com/en-us/library/x93ctkx8(VS.80).aspx)。这是随 Visual Studio 安装的，但文档似乎没有提到您如何从 C# 中使用它。

我在互联网上找到了示例代码，但没有关于如何链接到 DIA SDK 的信息。即我不能将它作为一个程序集导入。我认为我不必将它包含到托管 C++ 应用程序中并将其用作 COM（那将是地狱）。

有一个IDL文件，这是正确的方法吗？如果是这样，怎么做？

* * *

**编辑：**以下将创建类型库以用作引用的程序集。粘贴到批处理文件中。

```
call "%VS80COMNTOOLS%\vsvars32.bat"
midl /I "%VSINSTALLDIR%\DIA SDK\include" "%VSINSTALLDIR%\DIA SDK\idl\dia2.idl" /tlb dia2.tlb
tlbimp dia2.tlb 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-30T15:09:07.620

您需要先将 IDL 转换为 typelib：

就像是：

```
midl /I "%VSINSTALLDIR%\DIA SDK\include" dia2.idl /tlb dia2.tlb
tlbimp dia2.tlb 
```

然后你可以导入tlb。

我从来没有这样使用过 DIA SDK，所以不知道它有多友好。您还可以考虑直接从托管 C++ 程序集中使用它，并为您需要的功能提供托管接口。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-01-09T01:00:16.060

以前的说明有效，但需要一些更新。VSINSTALLDIR 不再存在（并且当您安装了多个 VS 版本时会模棱两可），所以我概括并更正了这些说明。这是一个 VS 2015 版本：

```
"%VS140COMNTOOLS%..\..\VC\vcvarsall.bat" amd64
set DIASDK=%VS140COMNTOOLS%..\..\DIA SDK
midl /I "%DIASDK%\include" "%DIASDK%\idl\dia2.idl" /tlb dia2.tlb
tlbimp dia2.tlb 
```

更改 VS140 以匹配您尝试使用的任何版本。

这创建了 dia2lib.dll，我将其添加为参考 - 右键单击​​参考，添加参考，浏览，找到该文件。它有效，我现在可以构建和运行符号排序。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-07-25T19:31:22.293

如果有人对路径有疑问，这对我来说适用于 VS 2017。

1.  打开 x86_x64 Cross Tools 命令提示符（**在管理员模式下**从 start/programs/Visual Studio 2017 开始）

2.  `cd C:\Program Files (x86)\Microsoft Visual Studio\2017\Professional`

3.  `midl /I "C:\Program Files (x86)\Microsoft Visual Studio\2017\Professional\DIA SDK\idl";"C:\Program Files (x86)\Microsoft Visual Studio\2017\Professional\DIA SDK\include" dia2.idl /tlb dia2.tlb`

4.  `tlbimp dia2.tlb`

现在`Dia2Lib.dll`在`C:\Program Files (x86)\Microsoft Visual Studio\2017\Professional`文件夹中。

在 C# 代码中使用它我得到了未注册的 dll 异常！我不得不跑

`C:\Program Files (x86)\Microsoft Visual Studio\2017\Professional\DIA SDK\bin>regsvr32 msdia140.dll`

解决这个问题

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-12-17T03:21:14.207

我已经成功使用 C# 中的 DIA，而无需使用 Visual Studio 2019 手动构建类型库或从源代码导入库。如果注册了 COM 服务器，则可以简单地将 COM 引用添加到 csproj，如下所示：

```
<ItemGroup>
  <COMReference Include="Dia2Lib.dll">
    <WrapperTool>tlbimp</WrapperTool>
    <VersionMinor>0</VersionMinor>
    <VersionMajor>2</VersionMajor>
    <Guid>106173a0-0173-4e5c-84e7-e915422be997</Guid>
    <Lcid>0</Lcid>
    <Isolated>false</Isolated>
  </COMReference>
</ItemGroup> 
```

这是因为 COM 服务器 dll 实际上将类型库作为资源嵌入其中。

也可以使用 Visual Studio UI 添加引用，方法是打开项目，右键单击 Dependencies->Add COM Reference...，然后搜索“dia”。如果 COM 服务器已注册，则名为“dia 2.0 类型库”的条目应该可用。

假设您的架构是 AMD64 并且您安装了 Visual Studio 2019 Enterprise，请按如下方式注册两个所需的 COM 服务器。可以更改路径以匹配您的特定安装和体系结构。这必须在提升的命令提示符下完成（右键单击并以管理员身份运行）。

```
regsvr32 /s "C:\Program Files (x86)\Microsoft Visual Studio\2019\Enterprise\DIA SDK\bin\msdia140.dll"
regsvr32 /s "C:\Program Files (x86)\Microsoft Visual Studio\2019\Enterprise\DIA SDK\bin\amd64\msdia140.dll" 
```

当然必须安装 DIA SDK，这可以通过运行 Visual Studio Installer 来完成，为您的安装选择“修改”，然后选择“使用 C++ 进行桌面开发”并安装。

# internationalization - 如何迭代地使用 xgettext 更新 .po 文件进行翻译

> ID：697542
> 
> 赞同：4
> 
> 时间：2009-03-30T14:52:31.467
> 
> 标签：internationalization, gettext, xgettext

我正在考虑使用[xgettext](http://www.gnu.org/software/hello/manual/gettext/xgettext-Invocation.html)来帮助翻译大型代码库，我有两个问题：

*   如果我每种语言都有一个 .po 文件，是否有一种简单的方法可以使用代码库的单个 xgettext 扫描来更新它们，或者我必须为每种语言运行一次 xgettext？
*   [如果我使用poedit](http://www.poedit.net/)将目标语言添加到 .po 文件头，xgettext 似乎会用默认头文件覆盖它。我怎样才能阻止这个？

也许我使用了错误的工具，在这种情况下，欢迎提出建议。我想要的是能够扫描代码并使用任何新字符串更新 .po 文件，但保持任何标题信息不变。

编辑：我知道 poedit 可以扫描代码，但我希望找到一个命令行应用程序来执行扫描以更轻松地自动化该过程。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-30T16:02:41.283

是的，基本上你使用错误的工具。

`xgettext`提取标签并创建模板文件。（例如 *.pot 文件）

该[`msgmerge`](http://www.gnu.org/software/hello/manual/gettext/msgmerge-Invocation.html)命令使用 .pot 文件中的更改更新 .po 文件。

我们制定了更新 .po 文件的规则，如下所示：

```
%.en.po : %.pot
    -[ -e $@ ] && msgmerge --width=110 --update $@ $<
    [ -e $@ ] || cp $< $@ 
```

# matlab - 从 MATLAB 中的文本文件加载值

> ID：697544
> 
> 赞同：2
> 
> 时间：2009-03-30T14:52:42.887
> 
> 标签：matlab, variables, matrix, file-io, text-files

我想从文本文件中加载变量。

例如，我的文本文件`varA`、`varB`和`varC`.

在 MATLAB 中，我想给这些变量赋值，这样每个变量都是一个 2x2 矩阵。

因此，从包含上述信息的文本文件中，我将得到一个如下所示的矩阵：

```
[ 1 2 3 4 5 6;
  1 2 3 4 5 6] 
```

这可能吗？

我添加了第二个示例以尝试使事情更清楚一些。

我的文本文件 text.txt 看起来像这样

```
x1 x2 x3 
```

在 MATLAB 中，我的 .m 文件为这些变量提供了值，例如

```
x1 = [1 1; 1 1]
x2 = [2 2; 2 2]
x3 = [3 3; 3 3] 
```

所以，当我导入我的文本文件时，我会得到

```
a = (textfile)
a = [1 1 2 2 3 3 ; 1 1 2 2 3 3] 
```

我基本上尝试在一个非常巨大的问题（[旅行商问题](http://en.wikipedia.org/wiki/Travelling_salesman_problem)（TSP）类型）上调整[遗传算法（GA）。](http://en.wikipedia.org/wiki/Genetic_algorithm)问题是我拥有的每个变量都是一个矩阵，交叉、适应度和变异代码变得非常复杂。而且我也遇到了随机开始人口的问题。

我想从 256 个列表中随机选择 30 个变量，这样变量只能选择一次。然而，每个变量在无法更改的 2*2 矩阵中都有自己的特定值。

我想使用 randperm 然后`x`在每个值之前放一个使它们成为变量而不是值的...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-30T15:10:21.050

如果文本文件中的数据如下所示（字符串以空格分隔）：

```
x1 x2 x3 ... 
```

[您可以使用TEXTSCAN](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/textscan.html)将字符串读入元胞数组，如下所示：

```
fid = fopen('file.txt','r');
A = textscan(fid,'%s');
fclose(fid);
A = A{:}; 
```

**A**现在将字符串存储在一个元胞数组中：**{'x1'; 'x2'; 'x3'; ...}** . 现在，要从这些字符串之一中创建一个变量并为其分配一个值，我将使用[ASSIGNIN](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/assignin.html)：

```
assignin('base',A{1},[1 2; 1 2]); 
```

这将在基础工作区中创建一个变量**x1**并将其赋值为**[1 2; 1 2]**。第一个参数可以是 'base' 或 'caller' 以在 MATLAB 基础工作区或调用者函数的工作区中创建变量。您将对**A**中的每个字符串名称重复此操作，并为其提供您想要的任何值。

* * *

**替代选项：**

这是我上面给你的另一个答案。上述答案解决了您在问题中提出的具体问题。*这个*答案为您提供了一个完全不同的选择，可能会避免按照您在问题中描述它们的方式做事，并且希望它会让您的事情变得更容易......

如果我理解您的问题，您基本上有 256 个 2×2 矩阵，并且您想随机选择其中的 30 个。这些 2×2 矩阵中的每一个听起来都像是存储在自己的变量（**x1**到**x256**）中。相反，我建议将所有 256 个矩阵存储在一个变量中作为 3-D 数组：

```
xArray = zeros(2,2,256);     % Initialize all matrices as [0 0; 0 0]
xArray(:,:,1) = [1 1; 2 2];  % This enters a value for the first matrix 
```

或单元格数组：

```
xArray = cell(1,256);    % Initializes an empty array of cells
xArray{1} = [1 1; 2 2];  % Enters a value for the first matrix 
```

您必须先初始化所有值。然后，如果您想随机选择 30 个值，接下来可以使用[RANDPERM](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/randperm.html)随机化 3-D 数组的第三维顺序或元胞数组的顺序：

```
startOrder = 1:256;              % The default order of the matrices
index = randperm(256);           % Randomly order the numbers 1 to 256
xArray = xArray(:,:,index);      % For a 3-d array
xArray = xArray(index);          % For a cell array 
```

然后只需使用**xArray**中的前 30 个条目进行计算（而不是像以前那样使用单个变量）：

```
x = xArray(:,:,1);  % Puts the first matrix from the 3-D array in x
x = xArray{1};      % Puts the first matrix from the cell array in x 
```

您可以不断重复使用 RANDPERM 来不断生成新的随机矩阵数组。如果您必须跟踪正在使用的原始矩阵，则必须在随机化**xArray**后添加此行：

```
startOrder = startOrder(index); 
```

现在**startOrder**的条目将告诉您矩阵的原始位置。例如，如果 startOrder 中的第一个数组条目是 40，则**xArray**的第一个位置的矩阵最初是您在初始化 xArray 时输入的第 40**个****矩阵**。

希望这可以帮助！

# javascript - 使用 JavaScript Prototype 库遍历所有选择元素

> ID：697551
> 
> 赞同：12
> 
> 时间：2009-03-30T14:54:19.467
> 
> 标签：javascript, loops, prototypejs, html-select

我如何（如果可能）使用 Prototype 库遍历页面上的所有选择元素并访问该元素？在文档中，我很容易找到引用具有某些 id、类名等的元素的快捷方式，但没有引用具有某些标签名称的元素。

如果 Prototype 无法做到这一点，我们将不胜感激使用 JQuery 或其他 JS 库的示例。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-30T14:56:12.690

查看[此页面中](http://prototypejs.org/doc/latest/dom/dollar-dollar/)的第一个示例：

```
$$('select').each(function() {
    //
}); 
```

本质上，该`$$`函数需要一个 CSS 选择器，而标签名称是一个完全有效的选择器。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-30T15:05:18.847

一个 jQuery 示例，用于多样性：

```
$('select').each(function() {
    var selectedOption = $(this).find('option:selected');
    alert('Value: ' + selectedOption.val() + ' Text: ' + selectedOption.text());
}); 
```

这将遍历页面中的所有s，并提醒每个`select`s 上选定的文本和值。`option``select`

# security - 如果从外部来源获得，除字符串之外的其他数据类型是否可能有害？

> ID：697553
> 
> 赞同：3
> 
> 时间：2009-03-30T14:55:02.520
> 
> 标签：security, string, types, code-injection

这是一个众所周知的事实，您不能信任用户输入。如果这些输入未经过滤使用，它们甚至可能是一个安全问题。XSS 和 SQL 注入是使用未经过滤的用户输入（或输入，可以由用户更改）可能出现的问题。

为避免此类问题，您必须控制所有可能受外部资源影响的字符串。Perl 通过它的 'Taint-mode' 支持这一点。

我所知道的问题都是由操纵的字符串引起的。你知道来自外部影响操纵的整数、浮点数等安全问题的例子吗？或者可以假设这种数据类型是安全的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T15:08:18.310

最终，无论您最终是否转换它们，所有值都作为字符串传递给您的程序。所有这些都应该被视为潜在的有害因素，而不仅仅是这个原因。

例如，如果将非数字字符放在数字字段中，则会出现解析错误。如果你在没有预料到的地方放了一个零，你可能会得到除以零的错误。如果您输入的值比预期的要大得多，或者在未预期的情况下输入负数，或者其他任何数量的东西，您可能会得到某种错误。系统错误很可能会泄露比您想要的更多的信息。例如，在 ASP.NET 应用程序中，如果未打开自定义错误，则您的站点使用的数据库连接信息、物理路径信息或有关第三方库的信息可能会在默认错误消息中泄露。

字符串可能比其他值更容易出现问题，但所有用户输入都应该被视为潜在有害的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T15:09:06.560

不，您可能会因接受来自外部来源的号码而遇到安全问题。如果外部源在（比如说）一个数组中为您提供了您需要处理的许多元素，那么大量、盲目信任的元素可能会通过分配足够的内存导致速度减慢或内存耗尽而导致拒绝服务。相反，如果您接受过低的数字并盲目地继续读取比分配存储空间更多的元素，则可能导致堆栈或堆覆盖。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T15:09:06.653

安全与否的不是数据类型——而是下面的代码决定了这一点。

也就是说，字符串通常会由于缓冲区溢出或针对某些底层解释器（SQL 或某些脚本语言）的注入式攻击而引起问题。显然，您不会从数字类型变量中看到这类问题。

您**可能**会发生与不良外部值相关的错误，这些错误可能会导致诸如拒绝服务攻击之类的事情。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T17:32:55.527

你永远不应该相信任何跨越`trust boundary`.

> 当一个组件不信任边界另一侧的组件时，就会出现信任边界。运行在不同特权级别的元素之间总是存在信任边界，但有时运行在相同特权级别的不同组件之间存在信任边界。
> 
> [威胁建模，再一次](http://blogs.msdn.com/larryosterman/archive/2007/08/30/threat-modeling-once-again.aspx)- 拉里奥斯特曼

如[Microsoft 安全开发生命周期 (SDL)](http://www.microsoft.com/downloads/details.aspx?FamilyID=2412c443-27f6-4aac-9883-f55ba5b01814&displaylang=en)[博客上](http://blogs.msdn.com/sdl/)[的新威胁建模过程](http://blogs.msdn.com/sdl/archive/2007/10/01/the-new-threat-modeling-process.aspx)中所述，Larry Osterman关于威胁建模的[系列](http://blogs.msdn.com/larryosterman/archive/2005/01/13/352357.aspx)[文章（](http://blogs.msdn.com/larryosterman/archive/2005/05/10/416132.aspx)[在此处更新）](http://blogs.msdn.com/larryosterman/archive/2007/08/30/threat-modeling-once-again.aspx)[进行](http://blogs.msdn.com/larryosterman/archive/2005/01/17/354588.aspx)了扩展，并通过他的[威胁建模再次演示，展示 PlaySound 威胁模型帖子](http://blogs.msdn.com/larryosterman/archive/2007/09/17/threat-modeling-again-presenting-the-playsound-threat-model.aspx)，任何地方数据跨越了识别可能威胁所需的信任边界。

# linq - LinqToSQL 和 Linq 一样吗？

> ID：697554
> 
> 赞同：7
> 
> 时间：2009-03-30T14:55:20.507
> 
> 标签：linq, nhibernate, orm, data-access

我只是在阅读有关 Linq to SQL 已停产的信息。有一段时间我完全推迟了学习 Linq。即使在 asp.net 上，当我上次检查时，他们的数据访问教程也在使用表适配器和 bll 类。然后是 linq 教程。现在我已经阅读了这篇文章并且实体框架是新的发展方向，这是否意味着我已经阅读了一年半的所有 Linq“东西”，它有多棒等等，就是这一切刚走了？似乎从来没有人决定以正确的方式做事，或者至少是一些使用 MS 产品的标准方式。我知道你不能说一种方法对所有事情都是正确的。但是，在这种特殊情况下，我不明白为什么不能对数据访问进行一些解决。

或者，Linq To SQL 只是 Linq 的 ORM 部分？如果我想使用 ORM，我现在究竟会学到什么？我在 StackOverflow 上读过几篇文章，但没有一篇能真正帮助我知道该怎么做。

似乎 nHibernate 可能比 Microsoft 的任何选择都好。是的，我知道还有其他人（亚音速，以及在各种 SO 问题中提到的其他人。）

谢谢你。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-30T15:00:03.117

不。

LINQ to SQL 构建在 LINQ 之上，这是 .NET 3.5 Framework 中基本的附加语言功能之一。

从技术上讲，其他 ORM 可以实现自己的 LINQ 系统，例如，NHibernate 已经有了 LINQ to NHibernate。这是在框架中提供的之上，例如 LINQ to XML、LINQ to Objects 等。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-30T15:02:19.820

实体框架当然并不意味着 LINQ 会消失 - 实体框架本身就是一个 LINQ 提供者！

LINQ 是一个完整的技术集合，不仅如此 - 它是一种您也可以为您自己的数据提供者实现的*模式。*

LINQ to SQL 只是该模式的一个示例。对于它的价值，我认为 LINQ to SQL 正在被淡化而不是真正消失，但我们会看到......

我个人首先发现 LINQ to Objects 是最有用的 LINQ 提供程序 :)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-30T14:59:44.663

Linq to sql 只是众多 linq 提供程序之一（有 linq to db4o、linq to starcounter、linq to objects、linq to ado 等等）。实体框架有自己的 linq 提供者，称为 linq to enteties。您阅读 linq 的这一年并没有丢失。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-30T14:59:42.900

Linq 不仅仅是 Linq-to-SQL。例如，像 Linq-to-Objects 和 Linq-to-XML 这样的东西是该技术的一部分。

我怀疑他们会离开！手指交叉。;-)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-30T15:00:46.063

LINQ 并没有消失。LINQ to SQL 也没有，但它不是 Microsoft 的数据访问战略平台，它是实体框架。EF 使用 LINQ to Entities，因此如果您花时间学习 LINQ，它仍然有效且有用。

不过，LINQ 并不是一种特定于产品的技术。很容易利用（几乎）所有类型的集合的功能和灵活性。例如。

```
List<MyType> myList = new List<MyType>();
// populate the list here
var filteredResults = from o in myList
                      where o.property == "hello world"
                      select o; 
```

是（概念上）有效的，即使这里的代码示例有缺陷。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-30T15:29:46.260

LINQ 是一个用于处理数据序列的库。它非常棒。这些数据序列可以是任何实现 IEnumerable 的数据，也可以是适配器提供的任何序列。

Linq to SQL 是一个适配器，它允许 SQL 数据库提供与 LINQ 兼容的数据序列。

还有一个 Linq to XML，它是一个适配器，可让您将 XML 文档视为数据序列，从而允许 LINQ 处理它。

LINQ 只是一种查询语言，它非常擅长它的功能。它与数据库或 SQL 无关。为了能够轻松处理内存中的集合，绝对值得学习。

# vba - Access 2007：如何获取 Treeview 复选框的 onclick 事件？

> ID：697558
> 
> 赞同：4
> 
> 时间：2009-03-30T14:56:25.497
> 
> 标签：vba, ms-access-2007

我有一个 Access 2007 表单，它使用启用了复选框的 ActiveX Treeview 控件。我想在单击复选框后运行一些自定义代码，但我似乎找不到任何类型的“onclick”或“onchecked”事件。

有谁知道如何在 Access 2007 中执行此操作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T15:07:38.700

答案很简单，但绝对没有很好的记录。

手动将 NodeCheck 事件添加到您的模块。这里的关键是“属性”窗口对您没有帮助。您需要手动输入代码。

```
Private Sub tv1_NodeCheck(ByVal Node As Object)
    'VBA goes here
End Sub 
```

# c - 如何将目录从源树复制到二叉树？

> ID：697560
> 
> 赞同：74
> 
> 时间：2009-03-30T14:56:34.623
> 
> 标签：c, copy, cmake

将目录从源代码树复制到二叉树。例如：如何将 www 复制到 bin 文件夹。

```
work
├─bin
└─src
    ├─doing
    │  └─www
    ├─include
    └─lib 
```

谢谢。

* * *

## 回答 #1

> 赞同：140
> 
> 时间：2010-02-01T16:37:34.270

从 2.8 版开始，[file 命令](https://cmake.org/cmake/help/v3.6/command/file.html)有一个 copy 参数：

```
file(COPY yourDir DESTINATION yourDestination) 
```

注意：

> 相对输入路径是相对于当前源目录评估的，相对目标是相对于当前构建目录评估的

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2009-03-30T15:39:56.737

在 CMake 2.8 中，使用[`file(COPY ...)`](http://www.cmake.org/cmake/help/v2.8.10/cmake.html#command:file)命令。

对于较旧的 CMake 版本，此宏将文件从一个目录复制到另一个目录。如果您不想替换复制文件中的变量，请更改 configure_file`@ONLY`参数（例如更改为`COPYONLY`）。

```
# Copy files from source directory to destination directory, substituting any
# variables.  Create destination directory if it does not exist.

macro(configure_files srcDir destDir)
    message(STATUS "Configuring directory ${destDir}")
    make_directory(${destDir})

    file(GLOB templateFiles RELATIVE ${srcDir} ${srcDir}/*)
    foreach(templateFile ${templateFiles})
        set(srcTemplatePath ${srcDir}/${templateFile})
        if(NOT IS_DIRECTORY ${srcTemplatePath})
            message(STATUS "Configuring file ${templateFile}")
            configure_file(
                    ${srcTemplatePath}
                    ${destDir}/${templateFile}
                    @ONLY)
        endif(NOT IS_DIRECTORY ${srcTemplatePath})
    endforeach(templateFile)
endmacro(configure_files) 
```

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2014-12-09T10:50:28.383

由于没有人提到`cmake -E copy_directory`自定义目标，这就是我使用的：

```
add_custom_target(copy-runtime-files ALL
    COMMAND ${CMAKE_COMMAND} -E copy_directory ${CMAKE_SOURCE_DIR}/runtime-files-dir ${CMAKE_BINARY_DIR}/runtime-files-dir
    DEPENDS ${MY_TARGET}) 
```

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2009-06-07T21:11:18.227

该`configure`命令仅在`cmake`运行时复制文件。另一种选择是创建一个新目标，并使用 custom_command 选项。这是我使用的一个（如果您多次运行它，则必须修改该`add_custom_target`行以使其对每个调用都是唯一的）。

```
macro(copy_files GLOBPAT DESTINATION)
  file(GLOB COPY_FILES
    RELATIVE ${CMAKE_CURRENT_SOURCE_DIR}
    ${GLOBPAT})
  add_custom_target(copy ALL
    COMMENT "Copying files: ${GLOBPAT}")

  foreach(FILENAME ${COPY_FILES})
    set(SRC "${CMAKE_CURRENT_SOURCE_DIR}/${FILENAME}")
    set(DST "${DESTINATION}/${FILENAME}")

    add_custom_command(
      TARGET copy
      COMMAND ${CMAKE_COMMAND} -E copy ${SRC} ${DST}
      )
  endforeach(FILENAME)
endmacro(copy_files) 
```

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2009-03-31T01:58:47.417

使用 execute_process 并调用 cmake -E。如果你想要一个深拷贝，你可以使用`copy_directory`命令。更好的是，您可以`symlink`使用 create_symlink 命令创建一个（如果您的平台支持）。后者可以这样实现：

```
execute_process(COMMAND ${CMAKE_COMMAND} -E create_symlink ${CMAKE_SOURCE_DIR}/path/to/www
                                                           ${CMAKE_BINARY_DIR}/path/to/www) 
```

来自：[http ://www.cmake.org/pipermail/cmake/2009-March/028299.html](http://www.cmake.org/pipermail/cmake/2009-March/028299.html)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-10-08T08:33:40.637

谢谢！这是使用一堆 add_custom_target 和 add_custom_command 的真正有用的建议。我编写了以下函数以在我的项目中随处使用。也是指定安装规则。我主要用它来导出接口头文件。

```
#
# export file: copy it to the build tree on every build invocation and add rule for installation
#
function    (cm_export_file FILE DEST)
  if    (NOT TARGET export-files)
    add_custom_target(export-files ALL COMMENT "Exporting files into build tree")
  endif (NOT TARGET export-files)
  get_filename_component(FILENAME "${FILE}" NAME)
  add_custom_command(TARGET export-files COMMAND ${CMAKE_COMMAND} -E copy_if_different "${CMAKE_CURRENT_SOURCE_DIR}/${FILE}" "${CMAKE_CURRENT_BINARY_DIR}/${DEST}/${FILENAME}")
  install(FILES "${FILE}" DESTINATION "${DEST}")
endfunction (cm_export_file) 
```

用法如下所示：

```
cm_export_file("API/someHeader0.hpp" "include/API/")
cm_export_file("API/someHeader1.hpp" "include/API/") 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-02-01T16:41:52.097

根据赛斯约翰逊的回答；为了更方便而写：

```
# Copy files
macro(resource_files files)
    foreach(file ${files})
        message(STATUS "Copying resource ${file}")
        file(COPY ${file} DESTINATION ${Work_Directory})
    endforeach()
endmacro()

# Copy directories
macro(resource_dirs dirs)
    foreach(dir ${dirs})
        # Replace / at the end of the path (copy dir content VS copy dir)
        string(REGEX REPLACE "/+$" "" dirclean "${dir}")
        message(STATUS "Copying resource ${dirclean}")
        file(COPY ${dirclean} DESTINATION ${Work_Directory})
    endforeach()
endmacro() 
```

# c++ - C++ 中的工厂方法模式实现：作用域、指针与引用

> ID：697564
> 
> 赞同：1
> 
> 时间：2009-03-30T14:57:14.093
> 
> 标签：c++, design-patterns

我一直在[Wikipedia](http://en.wikipedia.org/wiki/Factory_method_pattern)上查看示例 C++ 工厂方法模式，并且有几个问题：

1.  由于工厂方法是静态的，这是否意味着新创建的对象不会超出范围并在工厂方法退出时调用析构方法？

2.  为什么返回指针而不是引用？这是严格的偏好问题，还是其中的一些重要原因？

**编辑1：**我想得越多，返回的引用和指针都将保留在范围内，因为它们是在方法之外引用的。因此，不会在任何一个上调用析构函数。所以这是一个偏好问题。不？

**编辑 2：**我在返回的引用上打印出析构函数调用，并且在程序退出之前它不会打印。因此，除非有进一步的反馈，否则我现在将使用参考。这样我就可以使用“。” 返回对象上的运算符。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-30T15:02:28.307

1.  静态方法是一种无需工厂实例即可调用的方法。这与新创建对象的生命周期无关。您可以使用非静态方法取得同样的成功。工厂方法通常不需要来自同一类的现有对象的任何数据，因此不需要现有实例，这就是为什么工厂方法通常是静态的。

2.  您将使用*new*创建工厂将返回的对象。通常通过指针返回它们。这明确表明它是一个新对象，调用者必须注意它的生命周期。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-30T15:06:12.073

我认为理解内存管理存在更大的问题。工厂方法是在堆上分配项目（使用新的）。堆上的项目永远不会被自动回收（现代桌面操作系统在进程终止时除外）。您所描述的行为是针对堆栈上的项目，当您离开本地范围时，它们会被回收。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-30T15:03:21.690

如果您返回对对象的引用，当方法超出范围时，该引用将变为无效。这不会发生在指针上，因为没有调用析构函数。

确实，当值超出范围时，静态会进行修改，但前提是变量声明为静态，而不是方法声明为静态。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-30T15:09:31.707

**您的 Wiki 链接说错了。**

不应该有任何静态方法。您可以将工厂方法视为创建对象的模板方法模式。此方法不接收任何“名称”参数并始终创建相同类型的对象。

> 通常，设计从使用工厂方法（不太复杂、更可定制、子类激增）开始，然后随着设计人员发现需要更多灵活性的地方而向抽象工厂、原型或构建器（更灵活、更复杂）发展。[GoF，第 136 页]

下面的例子`Business::makeObject`是**工厂方法**

```
class ObjectBase
{
public:
    virtual void action() = 0;
    virtual ~ObjectBase(){};
};

class ObjectFirst : public ObjectBase
{
public:
    virtual void action(){ std::cout << "First"; }
};

class ObjectSecond : public ObjectBase
{
public:
    virtual void action(){ std::cout << "Second"; }
};

class Business
{
public:
    void SendReport()
    {
        std::auto_ptr< ObjectBase > object(makeObject());
        object->action();
    }
    virtual ~Business() { }
protected:
    virtual ObjectBase* makeObject() = 0;
};

class BusinessOne: public Business
{
public:
protected:
    virtual ObjectBase* makeObject()
    {
        return new ObjectFirst();
    }
};

class BusinessTwo: public Business
{
public:
protected:
    virtual ObjectBase* makeObject()
    {
        return new ObjectSecond();
    }
};

int main()
{
    std::auto_ptr<Business> business( new BusinessTwo() );
    business->SendReport();

    return 0;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-30T15:08:10.510

1.  不。静态方法 - 与类命名空间中的全局函数几乎相同，并且可以访问私有静态变量；
2.  指针的使用是在堆中创建对象的问题。它们在堆中创建对象的对象生命周期比创建函数范围更长；

**编辑：**
我认为**维基百科 -**在 c++ 示例中是错误的。
我们在示例中 - 与类图或此处的实现不同（[http://www.apwebco.com/gofpatterns/creational/FactoryMethod.html](http://www.apwebco.com/gofpatterns/creational/FactoryMethod.html)）

如果您从最受信任的来源阅读模式会更好，例如：Design Patterns: Elements of Reusable Object-Oriented Software。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-30T15:12:23.587

关键字 static 在方法和变量上意味着不同的东西。在示例中的方法上，这意味着它是全局类，您不需要类的实例来调用它。

要动态创建新对象，您需要使用 new，或者“技巧”是将临时对象分配给引用。将临时对象分配给某个点不会使该对象保持活动状态。

因此，您可以执行以下操作，但通常不会这样做，因为您通常希望保留从工厂创建的许多东西，然后您必须复制它们，而不是简单地将指针保存在列表中。

```
class PizzaFactory {
public:
    static Pizza& create_pizza(const std::string& type) {
        if (type == "Ham and Mushroom")
            return HamAndMushroomPizza();
        else if (type == "Hawaiian")
            return HawaiianPizza();
        else
            return DeluxePizza();
    }
};

const Pizza &one = create_pizza(""); // by ref
Pizza two = create_pizza("");  // copied 
```

*编辑* 对不起代码中的错误 - 将缺少的 const 添加到 ref。

通常，临时对象只持续到它出现的完整表达式的结尾。但是，C++ 故意指定将临时对象绑定到堆栈上对 const 的引用会将临时对象的生命周期延长到引用本身的生命周期

# asp.net - 格式化 SSRS 报告以使其在 Firefox 中看起来不那么糟糕

> ID：697568
> 
> 赞同：1
> 
> 时间：2009-03-30T14:58:20.703
> 
> 标签：asp.net, sql-server, reporting-services, reporting

我有一个 SSRS 报告，我正在动态写入 HTML 页面。该报告在 IE 中看起来很棒，但在 Firefox 中没有保留其格式。

我对此进行了一些研究，发现我可以在我的所有矩阵数据字段中插入矩形，这将保持格式。在我看来，这似乎需要做很多工作，我确信有人以前已经更优雅地解决了。

我也试过弄乱矩阵的 CanGrow 和 CanShrink 属性。没有帮助。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T16:14:55.950

很好的讨论[here](http://forums.asp.net/p/1232493/2228181.aspx)和[here](http://forums.asp.net/p/1174296/1973791.aspx#1973791)

该讨论的一些亮点：

*   尝试设置 CanGrow = false; 对于文本框。
*   是显示器的问题吗？随着宽度和高度的丢失？看看这个[线程](http://forums.asp.net/p/1194312/2063445.aspx#2063445)
*   CSS文件入口如下：

**在 css 文件中进行此更改**

```
/* Fix report IFRAME height for Firefox */
.DocMapAndReportFrame
{
 min-height: 860px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T19:42:29.297

只需在 Pages > ReportViewer.aspx 中将表单高度设置为 95%

# algorithm - 如何优先更新哪个提要（在众多提要中）？

> ID：697583
> 
> 赞同：0
> 
> 时间：2009-03-30T15:01:51.287
> 
> 标签：algorithm

假设我有 500 个 RSS 提要需要不断更新，但不想每分钟检查全部 500 个。什么方法或算法可以最好地确定哪些提要应该更新，而其他提要留待以后使用？

假设我可以并且将保存历史数据/统计信息，并且即使在同一个提要中更新频率也会有所不同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T15:05:03.997

好吧，你自己部分回答了你的问题。

使用现有统计数据根据更新率确定提要的优先级。保持统计数据本身更新，因此它会根据更新频率的变化进行自我调整。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T15:07:00.323

您正在描述*优先级调度*的非常常见的问题。有很多可能的方法，但这里有一个简化的版本。

*   设计一个*优先级函数*来确定更新特定提要的重要性。（例如，如果一个特定的提要刚刚更新了一段时间，并且它的历史更新率很低，那么它的优先级可能会很低。）
*   然后将提要放入[**优先队列**](http://en.wikipedia.org/wiki/Priority_queue)中。
*   当您需要做更多工作时，请从队列中获取最高优先级的提要。
*   为确保每个人都有机会更新，请定期提升一段时间未更新的提要的优先级。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T18:11:09.757

如果你想要我高端的方法，你可以这样工作。为 RSS 提要选择概率模型，例如更新之间的时间遵循连续概率分布，例如[指数分布](http://en.wikipedia.org/wiki/Exponential_distribution)。对于每个 RSS 提要，使用[最大似然](http://en.wikipedia.org/wiki/Maximum_likelihood)基于该提要的更新历史来估计各个分布的参数的方法。现在您有了一个概率模型，您可以使用它来计算任何特定 RSS 提要在任何特定时间都有可用更新的概率。每当您有时间段可用于检查一个流上的更新时，请检查具有最高概率可用新数据的那个。例如，指数概率是无记忆的，这意味着如果您检查提要是否有更新并且没有更新，则它有更新的概率将在检查时“重置”为 0%，然后会向上增长从那里开始，在不久的将来优先考虑其他提要而不是这个提要。

# php - PHP中的ASCII到DEC

> ID：697586
> 
> 赞同：-1
> 
> 时间：2009-03-30T15:03:04.890
> 
> 标签：php

将 DEC 转换为 ASCII：

$ascii=chr($t);

我需要一个将 ASCII 转换为 DEC 的代码。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-30T15:05:13.247

[http://www.php.net/manual/en/function.ord.php](http://www.php.net/manual/en/function.ord.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T15:08:31.333

不知道你应该有什么样的输入/输出，但可能是这样的：

```
function ascii_to_dec($str)
{
  for ($i = 0, $j = strlen($str); $i < $j; $i++) {
    $dec_array[] = ord($str{$i});
  }
  return $dec_array;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T15:33:38.920

该[`ord`函数](http://docs.php.net/ord)将单个字节转换为其整数值 (0 ≥ *i* ≥ 255)，而不仅仅是 ASCII 字符集的 128 个字符。

# winapi - 如何从 ActiveX 控件中的 VS_VERSION_INFO 获取信息

> ID：697590
> 
> 赞同：0
> 
> 时间：2009-03-30T15:03:46.447
> 
> 标签：winapi, visual-c++, activex

有没有办法从同一个应用程序中的 VS_VERSION_INFO（例如 FILEVERSION）中提取信息？我知道，您可能正在考虑以下路径：
1\. GetModuleFileName(...)
2\. GetFileVersionInfoSize(...)
3\. GetFileVersionInfo(...)
4\. VerQueryValue(...)
但是！有一个“扭曲”：我需要制作 activex 控件来提取它自己的版本。因此 GetModuleFileName 不会返回正确的文件名，它将是父应用程序名称，因此版本信息也将来自父应用程序，而不是 activex 控件。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T17:27:29.457

这是最终为我工作的代码（是的，它适用于 MFC ActiveX 控件）：

```
CString modFilename;
if(GetModuleFileName(AfxGetInstanceHandle(), modFilename.GetBuffer(MAX_PATH), MAX_PATH) > 0)
{
    modFilename.ReleaseBuffer(MAX_PATH);
    DWORD dwHandle = 0;
    DWORD dwSize = GetFileVersionInfoSize(modFilename, &dwHandle);
    if(dwSize > 0)
    {
        LPBYTE lpInfo = new BYTE[dwSize];
        ZeroMemory(lpInfo, dwSize);
        if(GetFileVersionInfo(modFilename, 0, dwSize, lpInfo))
        {
            //// Use the version information block to obtain the FILEVERSION.
                            //// This will extract language specific part of versio resources. 040904E4 is English(US) locale, 
                            //// it should match to your project
            //UINT valLen = MAX_PATH;
            //LPVOID valPtr = NULL;
            //if(::VerQueryValue(lpInfo, 
            //  TEXT("\\StringFileInfo\\040904E4\\FileVersion"),
            //  &valPtr,
            //  &valLen))
            //{
            //  CString valStr((LPCTSTR)valPtr);

            //  AfxMessageBox(valStr);
            //}

                            //// This will extract so called FIXED portion of the version info
            UINT valLen = MAX_PATH;
            LPVOID valPtr = NULL;
            if(::VerQueryValue(lpInfo, 
                TEXT("\\"),
                &valPtr,
                &valLen))
            {
                VS_FIXEDFILEINFO* pFinfo = (VS_FIXEDFILEINFO*)valPtr;

                // convert to text
                CString valStr;
                valStr.Format(_T("%d.%d.%d.%d"), 
                    (pFinfo->dwFileVersionMS >> 16) & 0xFFFF,
                    (pFinfo->dwFileVersionMS) & 0xFFFF,
                    (pFinfo->dwFileVersionLS >> 16) & 0xFFFF,
                    (pFinfo->dwFileVersionLS) & 0xFFFF
                    );

                AfxMessageBox(valStr);
            }
        }
        delete[] lpInfo;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T15:13:11.153

在第 1 步，您可以调用 GetModuleFileName 并传入 DLL 的 hModule。你在 DllMain() 中得到 hModule：

```
extern "C"
BOOL WINAPI DllMain(HINSTANCE hInstance, DWORD dwReason, LPVOID /*lpReserved*/)
{
    if (dwReason == DLL_PROCESS_ATTACH)
    {
        DWORD length = ::GetModuleFileName(hInstance, fullFilename, MAX_PATH);
        // ...
    }
} 
```

# c - 在 C 局部范围内使用 static 关键字来运行

> ID：697591
> 
> 赞同：2
> 
> 时间：2009-03-30T15:04:15.197
> 
> 标签：c, static

这两者有什么区别吗？如果是这样，究竟有什么区别？假设它们在一个可能被多次调用的 C 函数中。

1.  在同一个语句中声明和赋值

    `static uint32_t value = x;` `// x varies and may be passed into function.`

2.  在一个语句中声明并在下一个语句中分配。

    `static uint32_t value`;

    `value = x; // x varies`;

仅在第一次声明/初始化时更新`value`，甚至在后续调用时更新。

我对 (1) 的理解是，它仅在第一次执行该行时设置，因此即使`x`在下一次执行该行时更改，`value`也将保持不变。我不确定（2），但对两者的澄清将非常有帮助

编辑：编译器 ARM（ADS1.20）。编辑：到目前为止给出的答案中关于（2）的后续问题。声明（不是赋值）是在每次调用时重复还是只是第一次？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-30T15:06:15.660

第一个不应该编译；静态变量需要一个常量初始化器。

`value`每次调用该函数时都会设置第二个，因此不需要一开始就设置它`static`。

如果第一个符号是正确的——比如初始化`value`为 1——那么它会在程序启动时初始化一次，然后只在代码更改它时才取新值。第二个符号仍然`value`在每次调用函数时设置，因此使使用`static`毫无意义。（好吧，如果你足够努力，你可以设计第二个版本使用静态的场景。例如，如果函数返回一个指向它的指针，然后其他代码会修改它，那么它可能是需要的，但那是极端深奥，将是一种非常糟糕的“代码气味”。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T15:06:56.207

1 只执行一次，但 2 的值每次都会重新分配。静态变量只*初始化*一次。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-30T15:09:24.907

这些是非常不同的声明。

第一个是声明一个静态局部变量并给它一个初始值（这实际上不应该编译，因为 x 不是常量）。这只会在函数每次执行之前发生一次。这几乎肯定是您想要的初始化。

第二个声明是在每次调用函数时更新值。如果您希望变量始终以相同的值启动函数，这是正确的方法。但是，如果这确实是您想要的，那么为什么要使用静态呢？只需使用局部变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T15:08:16.437

你的直觉是对的。在第二个示例中，每次调用该方法时值都设置为 x。如果您只希望静态变量运行一次，则需要在*一个语句中对其进行初始化和声明。*

如果您总是希望 value 具有值 x，请不要将其声明为静态。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-01T16:56:23.527

编译时，第一个将被放入“.data”部分，数据被初始化，而第二个将被放入“.bss”部分，数据未初始化。

使用 readelf -S xx.o 可以检查编译目标文件的节大小。

示例 1：静态 int i；

```
void test(){
    i = 2; 
} 
```

例2：</p>

```
 static int i=1;

void test(){
    i = 2; 
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-26T13:28:19.317

伙计们 - 在 C 中，第一个声明是完全合法的。它将编译，并可用于初始化该值。您可以组合第二个声明中的代码行，以确保它在每次后续函数执行时都得到更新。这很常用，特别是在内存和资源比计算机或分布式应用程序更稀缺的嵌入式程序中。

使用静态的原因是为了确保变量具有在整个程序执行期间持续的数据生命周期，同时限制它仅访问声明静态的函数，或者如果静态声明位于文件顶部，则访问文件中的任何函数文件，否则每次退出函数都会丢失数据。这是一种很好的编程实践，可以避免无意中访问必须保护和限制的数据对象。该注释仅适用于 C 编程语言，不要误以为它适用于 C++（在某些情况下适用）或 JAVA。Java中的静态具有完全不同的含义。从我在这个线程中读到的内容，似乎很少有人理解关键字 static 在 C 中的工作原理，并且混淆了关键字 static 形式其他语言在 C 中应用。在 C 中，

# subsonic - 从 Subsonic.Select 调用 SQL 函数

> ID：697593
> 
> 赞同：0
> 
> 时间：2009-03-30T15:04:32.437
> 
> 标签：subsonic

我在亚音速论坛上问了以下问题，但似乎只得到了一个回复，所以我想我也应该在这里发帖，看看是否有人可以进一步了解这个问题......

我希望使用选择工具（或查询工具）通过 SubSonic 创建以下 SQL 语句。它使用一个名为“SPLIT()”的自定义函数：

> SELECT * FROM VwPropertyList
> WHERE VwPropertyList.idCreatedBy = 123
> AND VwPropertyList.idCounty = 45
> **AND 29 IN (SELECT Item FROM SPLIT(DistrictGroupList, ','))**

（此 SQL 的最后一部分使用了 SPLIT 函数）

我的亚音速等效项如下所示...

> 将 mySelect 调暗为新 SubSonic.Select
> mySelect.From(VwPropertyList.Schema)
> mySelect.Where(VwPropertyList.Columns.IdCreatedBy).IsEqualTo(123)
> mySelect.And(VwPropertyList.Columns.IdCounty).IsEqualTo(45)
> **mySelect.And(29 ).In(New SubSonic.Select("Item").From("SPLIT(" & VwPropertyList.Columns.DistrictGroupList & ", ',')"))**

由于最后一部分，这不起作用..如何将“ **AND 29 IN (SELECT Item FROM SPLIT(DistrictGroupList, ','))** ” 添加到我的 Subsonic.Select 中？

我从亚音速论坛得到的回复建议我取消 Subsonic.Select 并用硬编码的 InlineQuery() 语句替换.. 比如：

> Dim SQL as String = "Select " & VwPropertyList.Columns.Item
> SQL = SQL & " From " & VwPropertyList.Schema.TableName
> SQL = SQL & " Where " & VwPropertyList.Columns.IdCreatedBy & " = @CreatedBy "
> SQL = SQL & " And " & VwPropertyList.Columns.IdCounty & " = @County "
> SQL = SQL & " And @DistrictGroup IN (Select Item From SPLIT(DistrictGroupList,',')"
> 
> Items = SubSonic.InlineQuery().ExecuteTypedList(Of MyItem)(SQL, 123,45,29)

如果可能的话，我更喜欢使用 SubSonic.Select，以便我可以利用分页功能等。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T18:25:33.047

您可以按照 John 的建议进行操作，也可以使用我们的 InlineQuery 编写 SQL - 它允许您编写原始 SQL 并传入参数：

var qry=new InlineQuery("SELECT * FROM table WHERE column=@param",value)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T15:56:23.093

您可以尝试像这样使用原始查询对象（2.1 之前）（未经测试，来自内存）：

```
Query q = new Query(VwPropertyList.Schema.TableName);
q.WHERE("29 IN (SELECT Item FROM SPLIT(DistrictGroupList, ','))");

// pass q.ExecuteReader() to the Load() method of your view. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T21:28:36.960

我建议您在寻找分页时使用原始 Query 对象。内联查询没有任何允许分页的方法。

如果您绝对想使用 Subsonic.Select 您可以将这两个想法结合起来并运行内联查询以获取值列表，然后使用常规 Subsonic.Select 并将检索到的值传递给选择案例，但是您将制作两个前往分贝。

在旁注中，我更喜欢阅读使用流畅界面编写的 Subsonic.Select 语句，即

SubSonic.Select.AllColumnsFrom() .Where(VwPropertyList.Columns.IdCreatedBy).IsEqualTo(123) .And(VwPropertyList.Columns.IdCounty).IsEqualTo(45) .ExecuteAsCollection();

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T16:56:03.097

感谢您的回复。

我最终做了 InlineQuery 并且只是重新编写了通常由 Subsonic.Select 生成的分页代码......不是最好的解决方案，但它似乎工作。

如果我能做这样的事情会很好：

> Dim s As New SubSonic.Select
> s.From(VwPropertyList.Schema)
> sWhere(VwPropertyList.Columns.IdCreatedBy).IsEqualTo(123)
> sAnd(VwPropertyList.Columns.IdCounty).IsEqualTo(45)
> **s.And(29).In( New InlineQuery("(SELECT Item FROM SPLIT(DistrictGroupList, ','))"))**

# java - 如何将 BIRT 与 Python 集成

> ID：697594
> 
> 赞同：3
> 
> 时间：2009-03-30T15:05:01.780
> 
> 标签：java, python, reporting, birt

有人试过吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T01:00:17.600

你在说什么样的集成？

如果你想调用一些 BIRT API，我想它可以从 Jython 完成，因为 Jython 可以调用任何 Java API。

如果您不需要调用 BIRT API，那么您可以从 BIRT 报告服务器（一个 tomcat 应用程序）获取带有 http 请求的 birt 报告。

# javascript - ASP.NET MVC，包括 Javascript 中的 ASP

> ID：697604
> 
> 赞同：3
> 
> 时间：2009-03-30T15:06:55.410
> 
> 标签：javascript, asp.net-mvc

是否可以将 ASp.NET 标签放在我的 javascript 中，它位于单独的脚本文件中。例如，我有以下

```
 $.getJSON("/Postcode/GetAddressResults/" + $get("SearchPostcode").value, null, function(data) { 
```

我想变成它，但它不喜欢 ASP 标签！

```
var action = "<%=Url.Content('~/Postcode/GetAddressResults/')%>" + $get("SearchPostcode").value
        $.getJSON(action, null, function(data) { 
```

但是这似乎不起作用，我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T15:15:20.600

向您的母版页添加一个元标记以保存来自主机的当前应用程序路径的值（~ 代表的位）。

在您的 Javascript 中创建一个函数，该函数将使用元标记内容解析带有 ~ 前缀的路径。

**编辑**

根据要求示例：-

将此代码放在您的母版页的头部：-

```
 <meta id="meta.AppDomainAppVirtualPath"
    name="AppDomainAppVirtualPath" value="<%=HttpRuntime.AppDomainAppVirtualPath%>" /> 
```

在您的 javascript 中包含此功能：-

```
function resolveUrl(url)
{
    if (url.charAt(0) == "~")
    {
        if (!resolveUrl.appPath)
        {
           var meta = document.getElementById('meta.AppDomainAppVirtualPath');
           resolveUrl.appPath = meta ? meta .getAttribute("content") : '/';
        }

        if (resolveUrl.appPath == '/')
            return url.slice(1, url.length;
        else
            return resolveUrl.appPath + url.slice(1, url.length);
    }
    else
    {
        return url;
    }
} 
```

现在您的代码行是：-

```
$.getJSON(resolveUrl("~/Postcode/GetAddressResults/") + $get("SearchPostcode").value, null, function(data) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T15:09:54.747

如果您的 JavaScript 在一个单独的脚本文件中，那么它不会被 ASP.NET 处理，因此这些标签也不会被处理。您需要将它们内联在 ASP.NET 页面中才能正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T15:12:02.840

不，你不能。您可以将视图中的路径公开给 javascript，但不能直接在外部 javascript 文件中。

@David M 内联整个事情并不是真的需要，您可以内联动态部分并将另一部分硬编码。

问候，彼得

# perl - 在 Perl 下使用 Selenium 进行测试时如何制作漂亮的报告？

> ID：697609
> 
> 赞同：3
> 
> 时间：2009-03-30T15:07:29.450
> 
> 标签：perl, selenium

Selenium 有一些不错的附加库，只要您使用 Java 编写测试，例如[LoggingSelenium](http://loggingselenium.sourceforge.net/)。但是，如果您使用 Perl 编写，这些将不可用。您通常如何进行适当的报告，可能在每个重要步骤之后使用屏幕截图等？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T03:32:33.357

不是一个理想的答案，但您看过[CPAN 上的 Java 模块](http://search.cpan.org/~metzzo/Java-4.7/Java.pm)吗？然后，您可以使用原始的 Java Selenium 库（例如 LoggingSelenium）来进行报告。您需要使用 CPAN Java 模块提供的 jar 运行 Java 服务器（但如果您已经在使用 Selenium...）

您还可以尝试[Java::Import](http://search.cpan.org/~rusekd/Java-Import-0.03/lib/Java/Import.pm)，这可能避免运行服务器的需要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-29T12:59:35.710

[TAP::Formatter::HTML](http://search.cpan.org/~spurkis/TAP-Formatter-HTML/)生成[漂亮的 html 报告](http://www.spurkis.org/TAP-Formatter-HTML/test-output.html)。不过，它不做截图。

# crystal-reports - ADO.Net 数据集的性能问题

> ID：697611
> 
> 赞同：0
> 
> 时间：2009-03-30T15:07:38.793
> 
> 标签：crystal-reports

我真的很想知道您在使用 ADO.Net 数据集（从 SQL 调用存储过程）和 Crystal Reports 方面的经验，我知道大约需要 2-4 秒

```
CrystalDecisions.CrystalReports.Engine.ReportDocument document = new CrystalDecisions.CrystalReports.Engine.ReportDocument();
document.Load(file); 
```

但是每个 tableadapter 的负载如何呢？还有另一种使用 Crystal Reports 的方法吗？也许与 LINQ

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-08T18:17:37.950

我已经将数据集与 Crystal 一起使用。一般来说，我不喜欢让 Crystal Reports 获取它自己的数据，因为我们在打开太多与数据库的连接时遇到了错误。我通常创建一个数据集并将其序列化为带有架构的 XML，并将 xml 文件用作 ADO.Net“数据库”用于设计目的，然后在运行时我将数据集分配给报告

```
Dim rd As New ReportDocument
        rd.Load("SomeReport.rpt")
        rd.Database.Tables(0).SetDataSource(dataset) 
```

# c - 智能类型定义

> ID：697618
> 
> 赞同：8
> 
> 时间：2009-03-30T15:08:28.417
> 
> 标签：c, performance, types, typedef

我一直在嵌入式编程中使用 typedef 来避免常见错误：

`int8_t`- 8 位有符号整数
`int16_t`- 16 位有符号整数
`int32_t`- 32 位有符号整数
`uint8_t`- 8 位无符号整数
`uint16_t`- 16 位无符号整数
`uint32_t`- 32 位无符号整数

最近的嵌入式缪斯（第 177 期，尚未在网站上）向我介绍了拥有一些特定于性能的 typedef 很有用的想法。 [该标准](http://www.opengroup.org/onlinepubs/009695399/basedefs/stdint.h.html)建议使用 typedef 来指示您想要具有最小大小的最快类型。

例如，可以使用 声明一个变量`int_fast16_t`，但它实际上会`int32_t`在 32 位处理器或`int64_t`64 位处理器上实现，因为它们将是那些平台上至少 16 位的最快类型。在 8 位处理器上`int16_t`，满足最小大小要求的位数。

在我想知道之前从未见过这种用法

*   您是否在任何项目中看到过这一点，无论是嵌入式的还是其他的？
*   有什么可能的理由避免在 typedef 中进行这种优化？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T15:09:53.110

从 C99 中查看[stdint.h 。](http://en.wikipedia.org/wiki/Stdint.h)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-30T15:18:33.900

> 例如，可以使用 int_fast16_t 声明一个变量，但它实际上会在 32 位处理器上实现为 int32_t，或在 64 位处理器上实现为 int64_t，因为这些类型在这些平台上是至少 16 位的最快类型

这就是 int 的用途，不是吗？您是否可能很快就会遇到 8 位 CPU，而这还不够？

你能*记住*多少种独特的数据类型？

它是否提供了如此多的额外好处，以至于每当我创建一个简单的整数变量时，是否值得将要考虑的类型数量有效地加倍？

我什至很难想象它可能会被一致使用。

有人将编写一个返回 a 的函数`int16fast_t`，然后其他人将出现并将该变量存储到 a`int16_t`中。

这意味着在*快速*变体实际上有益的模糊情况下，它可能会改变代码的行为。它甚至可能导致编译器错误或警告。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-30T15:14:56.217

我会避免这种 typedef 的主要原因是它允许类型对用户撒谎。以 int16_t 与 int_fast16_t 为例。两种类型名称都将值的大小编码到名称中。这在 C/C++ 中并不少见。我个人使用特定于大小的 typedef 来避免我自己和其他阅读我的代码的人感到困惑。我们的大部分代码必须在 32 位和 64 位平台上运行，许多人不知道平台之间的各种大小规则。像 int32_t 这样的类型消除了歧义。

如果我没有阅读您问题的第 4 段，而只是看到了类型名称，我会认为这是具有快速 16 位值的特定场景的方式。而且我显然错了:(。对我来说，这违反了“不要让人们感到惊讶”的编程规则。

也许如果它的名称中有另一个区别动词、字母、首字母缩略词，它就不太可能使用户感到困惑。也许 int_fast16min_t ？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-31T03:19:32.560

当我查看 时`int_fast16_t`，我不确定它将在其中运行的 CPU 的本机宽度，这可能会使事情变得复杂，例如`~`运算符。

```
int_fast16_t i = 10;
int_16_t j = 10;

if (~i != ~j) {
  // scary !!!
} 
```

不知何故，我想根据处理器的本机宽度随意使用 32 位或 64 位。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T15:13:25.287

我其实不太喜欢这种东西。

我已经看过很多次了（事实上，我们甚至在我目前的工作地点也有这些类型定义）......在大多数情况下，我怀疑它们的真正用处......它让我觉得为了改变而改变...... .（是的，我知道一些内置插件的大小可能会有所不同）......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-30T15:42:39.147

我通常使用 size_t，它恰好是最快的地址大小，这是我在嵌入时采用的传统。它从未在嵌入式圈子中引起任何问题或混乱，但当我开始在 64 位系统上工作时，它实际上开始给我带来问题。

# java - OS X的java执行路径中的空格

> ID：697621
> 
> 赞同：9
> 
> 时间：2009-03-30T15:08:46.467
> 
> 标签：java, runtime, escaping, space

在 OS X 上，我正在尝试 .exec 某些东西，但是当路径包含空格时，它不起作用。我试过用引号包围路径，转义空间，甚至使用\u0020。

例如，这有效：

```
Runtime.getRuntime().exec("open /foldername/toast.sh"); 
```

但如果有空间，这些都不起作用：

```
Runtime.getRuntime().exec("open /folder name/toast.sh");

Runtime.getRuntime().exec("open \"/folder name/toast.sh\"");

Runtime.getRuntime().exec("open /folder\\ name/toast.sh");

Runtime.getRuntime().exec("open /folder\u0020name/toast.sh"); 
```

想法？

编辑：转义的反斜杠......仍然没有工作。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-30T15:22:47.917

[在Sun 的论坛](http://forums.sun.com/thread.jspa?threadID=5366547&tstart=1)上有一个关于这个问题的总结......似乎是一个非常普遍的问题，不仅限于 OS X。

线程中的最后一篇文章总结了建议的解决方案。本质上，使用`Runtime.exec`采用`String[]`数组的形式：

```
String[] args = new String[] { "open", "\"/folder name/toast.sh\"" }; 
```

或（论坛建议这也可以）

```
String[] args = new String[] { "open", "folder name/toast.sh" }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T15:13:18.610

试试这个：

```
Runtime.getRuntime().exec("open /folder\\ name/toast.sh"); 
```

“\”只会在字符串中放一个空格，但“\”会在字符串中放一个“\”，它将传递给shell，shell会转义空格。

如果这不起作用，请将参数作为数组传递，每个参数一个元素。这样壳就不会参与进来，你也不需要奇怪的逃跑。

```
Runtime.getRuntime().exec(new String[]{"open", "/folder name/toast.sh"}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-07T20:18:13.463

Paul 的选项有效，但您仍然必须像这样逃避空格：

```
Runtime.getRuntime().exec(new String[]{"open", "/folder\\ name/toast.sh"}); 
```

使用 String 数组的糟糕之处在于每个参数及其选项必须在它们自己的元素中。例如，您不能这样做：

```
Runtime.getRuntime().exec(new String[]{"executable", "-r -x 1", "/folder\\ name/somefile"}); 
```

但必须像这样指定它：

```
Runtime.getRuntime().exec(new String[]{"executable", "-r", "-x", "1", "/folder\\ name/somefile"}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-01-16T00:15:51.150

在 Kotlin 中，我能够使用模板字符串转义空格。

```
private const val chromeExec = "/Applications/Google 
Chrome.app/Contents/MacOS/Google Chrome"
Runtime.getRuntime().exec(arrayOf("$browserExec", url)) 
```

# silverlight - 为什么我从 Expression Blend 复制到 Silverlight VS 项目的动画只运行一次？

> ID：697625
> 
> 赞同：2
> 
> 时间：2009-03-30T15:09:13.703
> 
> 标签：silverlight, xaml, animation, expression-blend

在我的 Silverlight 应用程序中，我希望不同的文本从正确的颜色不断变化并变得更小**重复飞入。**动画**第一次**通过循环工作，但不是后续时间。

这是我所做的：

(1) 我进入**Expression blend**，使用“创建故事板”工具创建动画。

然后 (2)**将 StoryBoard**块复制到我的 XAML：

```
<UserControl x:Class="TestWeb124.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    Width="800" Height="600">
    <UserControl.Resources>
        <Storyboard x:Key="FadeTextIn">
            <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="OutputText" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.X)">
                <SplineDoubleKeyFrame KeyTime="00:00:01.5000000" Value="-111" KeySpline="0,0,0,1"/>
            </DoubleAnimationUsingKeyFrames>
            <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="OutputText" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.Y)">
                <SplineDoubleKeyFrame KeyTime="00:00:01.5000000" Value="-88" KeySpline="0,0,0,1"/>
            </DoubleAnimationUsingKeyFrames>
            <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="OutputText" Storyboard.TargetProperty="(TextBlock.FontSize)">
                <SplineDoubleKeyFrame KeyTime="00:00:01.5000000" Value="14" KeySpline="0,0,0,1"/>
            </DoubleAnimationUsingKeyFrames>
            <ColorAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="OutputText" Storyboard.TargetProperty="(TextBlock.Foreground).(SolidColorBrush.Color)">
                <SplineColorKeyFrame KeyTime="00:00:00" Value="#FFC24343"/>
                <SplineColorKeyFrame KeyTime="00:00:01.5000000" Value="#FF000000" KeySpline="0,0,0,1"/>
            </ColorAnimationUsingKeyFrames>
        </Storyboard>
    </UserControl.Resources>

    <Grid x:Name="LayoutRoot" Background="White">
        <StackPanel Margin="20">
            <TextBlock Height="57" Margin="190,90,133,0" VerticalAlignment="Top" Text="This is a test." TextWrapping="Wrap" FontSize="36" RenderTransformOrigin="0.5,0.5" x:Name="OutputText" Foreground="#FF000000">
            <TextBlock.RenderTransform>
                <TransformGroup>
                    <ScaleTransform/>
                    <SkewTransform/>
                    <RotateTransform/>
                    <TranslateTransform/>
                </TransformGroup>
            </TextBlock.RenderTransform>
            </TextBlock>
        </StackPanel>
    </Grid>
</UserControl> 
```

然后（3）在我后面的代码中运行一个计时器循环。动画第**一次效果很好，但随后没有动画**：

```
public void Each_Tick(object o, EventArgs sender)
{
    if (_secondsElapsed % 5 == 0 || _secondsElapsed == 0)
    {
        OutputText.Text = String.Format("{0}", _customerFirstNames.ElementAt(_customerNodeIndex));
        Storyboard fadeTextIn = (Storyboard)Resources["FadeTextIn"];
        fadeTextIn.Begin();
        _customerNodeIndex++;
        if (_customerNodeIndex > _customerFirstNames.Count() - 1) _customerNodeIndex = 0;
    }
    _secondsElapsed++;
} 
```

看来我需要**重新设置下一段**应该飞行的新文本的位置。**我怎么做？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T13:39:13.953

```
 <Storyboard x:Name="FadeTextIn">
            <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="OutputText" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.X)">
                <SplineDoubleKeyFrame KeyTime="00:00:00" Value="0" KeySpline="0,0,0,1"/>
                <SplineDoubleKeyFrame KeyTime="00:00:01.5000000" Value="-111" KeySpline="0,0,0,1"/>
            </DoubleAnimationUsingKeyFrames>
            <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="OutputText" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[3].(TranslateTransform.Y)">
                <SplineDoubleKeyFrame KeyTime="00:00:00" Value="0" KeySpline="0,0,0,0"/>
                <SplineDoubleKeyFrame KeyTime="00:00:01.5000000" Value="-88" KeySpline="0,0,0,1"/>
            </DoubleAnimationUsingKeyFrames>
            <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="OutputText" Storyboard.TargetProperty="(TextBlock.FontSize)">
                <SplineDoubleKeyFrame KeyTime="00:00:00" Value="36" KeySpline="0,0,0,0"/>
                <SplineDoubleKeyFrame KeyTime="00:00:01.5000000" Value="14" KeySpline="0,0,0,1"/>
            </DoubleAnimationUsingKeyFrames>
            <ColorAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="OutputText" Storyboard.TargetProperty="(TextBlock.Foreground).(SolidColorBrush.Color)">
                <SplineColorKeyFrame KeyTime="00:00:00" Value="#FFC24343"/>
                <SplineColorKeyFrame KeyTime="00:00:01.5000000" Value="#FF000000" KeySpline="0,0,0,1"/>
            </ColorAnimationUsingKeyFrames>
        </Storyboard> 
```

Storyboard 所做的是获取一个元素，然后对其属性的操作进行动画处理。这就是为什么它第二次运行时元素已经具有目标属性，因此通过为动画的开始添加一个关键帧，将值设置为初始值，您的动画将很好地重复。

# c# - 如何在 C# 中与 Windows Media Player 交互

> ID：697628
> 
> 赞同：0
> 
> 时间：2009-03-30T15:09:24.967
> 
> 标签：c#, .net, windows, windows-media-player

我需要将 Windows Media Player 与我的应用程序同步。我想在 ListBox 中实时显示 WMP 正在播放的当前歌曲，并在 WMP 更改歌曲时进行更新。我该如何实施？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T15:33:36.970

在 Google 中的一些嗅探给了我这个：[http](http://brandon.fuller.name/archives/hacks/nowplaying/wmp/#overview) ://brandon.fuller.name/archives/hacks/nowplaying/wmp/ ，看起来您需要为 WMP 编写一个插件，将信息公开给您的应用程序。根据您的需要/成本，该页面上的插件可能会完成这项工作！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T15:18:40.593

轮询 HKEY_CURRENT_USER\SOFTWARE\Microsoft\MediaPlayer\Player\RecentFileList\File 可能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T15:34:26.670

我们使用单例服务通过 Windows Media 库 (wmp.dll) 和 .NET Remoting 控制了 Windows Media Player。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-25T15:29:08.463

看这里： [如何在 C# 中与 Windows Media Player 交互](https://stackoverflow.com/questions/56478/how-to-interact-with-windows-media-player-in-c/764856#764856)

# deployment - 您如何将可点击的 url 打包到您的应用程序中？

> ID：697634
> 
> 赞同：0
> 
> 时间：2009-03-30T15:10:32.670
> 
> 标签：deployment, cross-platform, cross-browser

前段时间我问了一个[类似的问题](https://stackoverflow.com/questions/141251/windows-url-links-that-point-to-same-address-when-copied-over-or-deleted)，但没有得到满意的答案，所以我想知道一个人是否可以采取不同的方法。

创建可以与应用程序一起部署的 Web 链接的格式是什么？一个可能会显示在开始菜单中的应用程序供应商网站的链接。

它应该适用于任何现代操作系统和任何现代浏览器（即> = IE6，尽管我不确定这是一个相关问题）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T19:25:55.990

没有跨平台的方法可以做到这一点。

*   兼容 Freedesktop 的系统可以使用 xdg-open
*   Mac 用户可以使用 open
*   Debian 衍生产品可以使用 sensible-browser（或通常安装 xdg-open）
*   Windows 用户可以使用 *.url 文件
*   或者，当然，您可以实现 xdg-open 并将其与您的应用程序一起打包到没有它的系统上
*   或者实现您自己的完全不同的实用程序并将其与正确的文件相关联

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T19:38:43.447

不同平台的格式不同。

在 Windows 上，您可以使用`.url`文件。[这是](http://www.cyanwerks.com/file-format-url.html)格式的说明。您也可以通过将 URL 拖到桌面或文件夹中来创建一个。一个简单的例子：

```
[InternetShortcut]
URL=http://stackoverflow.com/ 
```

在 Mac 上，您还可以通过将 URL 拖到桌面来创建 URL 文件。该格式似乎是一个带有`.webloc`扩展名的文件，其中包含一个包含 a 的plist [，](http://en.wikipedia.org/wiki/Property_list)`dict`将密钥映射`URL`到相关 URL：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" 
    "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <key>URL</key>
    <string>http://stackoverflow.com/</string>
</dict>
</plist> 
```

# wpf - DependencyProperty：VS找不到绑定的源

> ID：697637
> 
> 赞同：1
> 
> 时间：2009-03-30T15:10:52.437
> 
> 标签：wpf, wpf-controls

我正在尝试将 Forderground 依赖属性绑定到我的 UIControl，以便它以用户希望的颜色绘制。由于 myUiControl.Foderground 自动完成，我想我可以像这样将它绑定到 XAML 文件中：

```
{Binding ElementName=rootControl, Path=Forderground} 
```

调试 VS 时说它找不到与此 DependencyProperty 绑定的源。但我不知道为什么会这样。

另外，如何在调试时列出对象的所有依赖属性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-30T17:35:30.670

您能否确认您的“rootControl”元素在 xaml 标记中的定义早于您的 Binding 持有者？通常绑定绑定到较早声明的元素。

如果您的意思是在调试时使用 ImmediateWindow 和 IntelliSense，那么每个依赖属性元数据通常都有公共静态访问修饰符。例如，您可以键入“控制”。并观察所有相应的依赖属性、路由事件和附加属性成员。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-01T22:41:02.573

更新：如果以下内容对您来说还不够，请尝试下载此[示例](http://employees.claritycon.com/lroth/SO_Binding_Question.zip)并查看它。

ElementName 需要设置为根控件的“x:Name”，Path 需要设置为要绑定到的根元素上的属性。如果没有名称，它将找不到您所指的元素（因此出现初始错误），并且没有 Path 它不会绑定到正确的属性（在运行时检查您的输出是否有错误）。

试试这个：

```
<Window x:Class="WpfApplication1.Window1"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
Title="Window1" Height="300" Width="300">
<Grid x:Name="root" Background="Green">
    <Button Background="White" Margin="100">
        <TextBlock Background="{Binding ElementName=root, Path=Background}" Text="TESTING TESTING"/>
    </Button>
</Grid> 
```

# javascript - FF 2.0.x 中的脚本加载参数

> ID：697647
> 
> 赞同：1
> 
> 时间：2009-03-30T15:14:36.110
> 
> 标签：javascript, firefox

大家好，

我正在尝试使用以下代码在页面上显式加载 effects.js 和 builder.js Scriptaculous 库：

```
<script type="text/javascript" src="/javascripts/scriptaculous.js?load=builder,effects"></script> 
```

这就像 FF 3.0.x、IE7 和 Opera 9.6.x 中的魅力一样。但是，它在 Firefox 2.0.x 中不起作用。库永远不会被加载。为了让它们在 FF 2.0.x 中加载，我必须使用两个额外的 <script /> 标签显式引用它们，即：

```
<script type="text/javascript" src="/javascripts/scriptaculous.js?load=builder,effects"></script>
<script type="text/javascript" src="/javascripts/builder.js"></script>
<script type="text/javascript" src="/javascripts/effects.js"></script> 
```

有谁知道 FF 2.0 和 3.0 之间的差异是什么导致了这种行为？我的问题有更好的解决方案吗？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T15:58:49.513

我今天喝了太多咖啡，所以我想我会试试这个。

一种可能性是**scriptaculous.js中的****load**函数没有正确处理以包含作为参数传递给它的库**(scriptaculous.js?load=builder,effects)**。

 ****尝试输入警报以查看是否正在输入 scriptaculous.js 中的加载函数，如果是，则该过程可能没有执行它在 FF2 上应该执行的操作：

```
load: function() {
    alert('In the load function!');
    ...rest of code here... 
```

如果不是，那么（也许）firefox 2 不想执行加载。

加载的最后一部分似乎完成了包含其他库的工作：

```
$A(document.getElementsByTagName("script")).findAll( function(s) {
      return (s.src && s.src.match(/scriptaculous\.js(\?.*)?$/))
    }).each( function(s) {
      var path = s.src.replace(/scriptaculous\.js(\?.*)?$/,'');
      var includes = s.src.match(/\?.*load=([a-z,]*)/);
      (includes ? includes[1] : 'builder,effects,dragdrop,controls,slider,sound').split(',').each(
       function(include) { Scriptaculous.require(path+include+'.js') });
    }); 
```

从上面的代码中，我可以看到**include**变量应该解析出库名称，看看它是否被分配了任何东西，用类似的东西替换它：

```
var includes = s.src.match(/\?.*load=([a-z,]*)/);
alert(includes[0] + ' ' + includes[1]); 
```

这应该让您更好地了解正在发生的事情。虽然这是一个有趣的小问题，但我肯定会采用您提出的解决方案：

```
<script type="text/javascript" src="/javascripts/scriptaculous.js"></script>
<script type="text/javascript" src="/javascripts/builder.js"></script>
<script type="text/javascript" src="/javascripts/effects.js"></script> 
```

# javascript - 在 Firefox 中使用 javascript 获取控件属性

> ID：697654
> 
> 赞同：0
> 
> 时间：2009-03-30T15:16:03.703
> 
> 标签：javascript, firefox, gridview

我正在尝试访问控件的属性，虽然它`IE6`在 FF3 中效果很好，但它失败了。我正在做：

```
alert(document.getElementById(gridViewCtlId).style.display);
alert(document.getElementById(gridViewCtlId).style); 
```

第一个显示空白弹出窗口，而第二个显示`'undefined'`。

我愿意

```
alert(document.getElementById(gridViewCtlId).id); 
```

我得到了盒子的正确ID以及：

```
alert(document.getElementById(gridViewCtlId)); 
```

我在 HTML 表格中得到了它。

这在 IE 中非常有效，但在 FF 中无效。我需要做什么才能使此功能正常运行？

编辑：gridViewCtlId 定义为：

```
var gridViewCtlId = '<%=GridView.ClientID%>'; 
```

这是完整的代码：

```
var itemVisible= '<%=ItemVisible.ClientID%>';

function onGridViewRowSelected(rowIdx)
{
    alert(document.getElementById(gridViewCtlId).style.display);
    alert(document.getElementById(gridViewCtlId).style);
    if (document.getElementById(gridViewCtlId).disabled == false)
    {
        alert("hi1");
        var selRowCCA = getSelectedRow(rowIdx);
        if (curSelRow != null)
        {   
            alert("hi2");
            var previousRow = getSelectedRow(previousRowIndx);

            var CountIdx = previousRowIndx % 2;
            if (document.getElementById(itemVisible) == null)
            {
                if (CountIdx == 0)
                {
                    alert("hi");
                    previousRow.style.backgroundColor = 'Silver';
                }
                else
                {
                    previousRow.style.backgroundColor = 'White';
                }
            }
        }

        if (null != selRow)
        {
            alert("new");
            previousRowIndx = rowIdx;
            curSelRow = selRow;
            selRow.style.backgroundColor = 'Red';
        }
    }
} 
```

这几乎是一个 onClick，我必须调用该函数将其恢复为原始颜色（使用交替颜色行）。IE，这工作正常。如果我做第一个警报

```
alert(document.getElementById(gridViewCtlId).disabled); 
```

我会得到真或假。之所以这样，是因为有人要在文本框中输入某些内容，而第一个`gridview`将根据其中的内容进行填充`textbox`。然后，当有人在第一个 gridview 中选择某些东西时，它将`gridview`被禁用，然后填充第二个。所以我在检查`gridview`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-30T15:51:24.163

```
<div id="test">
</div>
<script type="text/javascript">
var gridViewCtlIdCCA = 'test';
alert(document.getElementById(gridViewCtlIdCCA).style);
</script> 
```

Firefox 2 和 3 中的警报`[object CSSStyleDefintion]`。

如果`.style`未定义，`.style.display`将产生错误，不会警告空对话框（除非您正在捕获`window.onerror`）。

您能否创建一个演示该问题的[SSCCE 。](http://sscce.org/)有关 SSCCE 的更多信息，请[点击此处](http://mindprod.com/jgloss/sscce.html)。

# strongly-typed-dataset - TableAdapter 只返回选定的列？(VS2008)

> ID：697657
> 
> 赞同：2
> 
> 时间：2009-03-30T15:17:18.897
> 
> 标签：strongly-typed-dataset, tableadapter

（VS2008）我正在尝试在 Typed DataSet 中配置 TableAdapter 以仅从它所基于的表的主架构返回列的某个子集，但它始终返回具有空白值的整个架构（所有列）在我省略的列中。

TableAdpater 具有来自向导的默认 Fill 和 GetData() 方法，它们包含表中的每一列，这很好。然后，我添加了一个名为 GetActiveJobsByCustNo(CustNo) 的新参数化查询方法，并且我只在 SQL 查询中包含了我真正希望在此表视图中出现的几列。

但是，它再次返回主表模式中的所有列，而我省略的列的值为空。

我想要这个的原因是，我可以只取回几列，以便在 ASP.NET GridView 中使用带有 AutoGenerateColumns 的表视图。它给了我架构中的每一列，我的演示文稿 GridView 包含更多我想向用户展示的列。而且，我想避免必须在 GridView 中声明列。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T16:45:47.967

当您将新查询添加到给定的 TableAdapter 时，它将假定它所附加到的架构，这就是您获得不需要的列的空白值的原因。

由于您提到已经创建了该过程，您需要做的是使用服务器资源管理器连接到数据库，然后简单地将存储过程拖到您的 XSD 工作区中。这将创建一个单独的 QueryAdapter，它只包含您指定的列（仍然是强类型），您可以使用该 QueryAdapter 与您的 GridView 绑定/交互。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T16:40:48.867

是否在返回表中所有行的另一个查询中使用了强类型数据集？

您可以做的是使用强类型数据集创建一个数据视图，并为您的 DataGridView 公开一个数据表。

我不确定你的要求是什么，但这个例子应该可以帮助你：

```
DataView dv = new DataView(ds.<Your_Table>);

// This will create a new data table with the same name,
// But with only two columns from the original table.
// This could then be bound to your data grid. 
DataTable dt = dv.ToTable(false,
                          ds.<Your_Table>.<Your_Column1Column>.ColumnName,
                          ds.<Your_Table>.<Your_Column1Column>.ColumnName); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-15T02:57:52.660

在绑定到 Gridview 之前，只需在运行时删除不需要的列。毕竟底层类仍然只是一个 DataTable。

# asp.net - ASP.Net 母版页和文件路径问题

> ID：697660
> 
> 赞同：79
> 
> 时间：2009-03-30T15:18:16.723
> 
> 标签：asp.net, javascript, jquery, runatserver

我正在尝试在我的母版页中添加对 jQuery 的脚本引用，以便它适用于任何页面。目前看起来像这样

```
<script type="text/javascript" src="jquery.js"></script> 
```

问题是路径总是相对于正在执行的 aspx 页面，所以这只有在“jquery.js”文件位于同一文件夹中时才有效。为了使它起作用，我必须将行更改为：

```
<script type="text/javascript" src="../../jquery.js"></script> 
```

这显然不太理想，因为它仅适用于距根文件夹两层深的页面。如果我尝试以下操作，IIS 会引发有关意外字符的错误。

```
<script runat="server" type="text/javascript" src="~/jquery.js"></script> 
```

有任何想法吗？

**编辑：**我也忘了提到脚本必须在 head 标签中

当前的最佳答案在我将其添加到我的母版页时会引发“ *ASP.NET Ajax 客户端框架无法加载。 ”错误。*它是从 javascript 而不是 .Net 编译器抛出的。如果我将 ScriptManager 移动到应该在的 head 部分，我会收到一个关于 ScriptManager 需要位于表单标记内的编译错误。

第三个答案从编译器抛出“*路径中的非法字符。 ”异常*

**编辑 2：**当我将该行添加到我的 head 标签时，我从 IIS 收到此错误。

*无法修改 Controls 集合，因为该控件包含代码块（即 <% ... %>）*

**已解决：**我从下面的答案中获取了编辑后的响应并将其放入*asp:ContentPlaceHolder*元素中

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2009-03-30T15:22:49.833

您可以使用[`ScriptManager`](http://msdn.microsoft.com/en-us/library/system.web.ui.scriptmanager.aspx)：

```
<asp:ScriptManager ID="ScriptManager1" runat="server">
    <Scripts>
        <asp:ScriptReference Path="~/jquery.js" />
    </Scripts>
</asp:ScriptManager> 
```

**编辑：**如果你在你的部分*绝对*需要这个`<head>`，你可以这样做：

```
<head>
    <script type="text/javascript" 
        src="<%= Page.ResolveClientUrl("~/jquery.js") %>"></script>
</head> 
```

**编辑2：**根据评论，如果您观察到

> 无法修改 Controls 集合，因为该控件包含代码块（即 <% ... %>）

您可能需要更改以上内容以使用数据绑定语法：

```
<head>
    <script type="text/javascript" 
        src="<%# Page.ResolveClientUrl("~/jquery.js") %>"></script>
</head> 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-11-16T10:14:00.390

尝试`<%#`而不是`<%=`在头部分下的母版页中

```
<script type="text/javascript" 
        src="<%# ResolveUrl("~/YourScriptFolder/YourJQueryOrJavascript.js") %>">
</script> 
```

然后在`Page_Load`事件下的母版页面的代码后面

```
Page.Header.DataBind(); 
```

现在您可以使用 jQuery 和 JavaScript 以及 CSS，只需更改`ResolveUrl`要处理 CSS、JavaScript、jQuery 的文件的路径。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-03-30T15:26:42.163

如果你不去我们 asp:ScriptManager 或绝对路径，那么你可以这样做：

```
<script runat="server" type="text/javascript" 
  src='<%= Page.ResolveUrl("~/jquery.js") %>'></script> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-08-31T12:58:31.750

我不知道你们是否找到了解决问题的方法。我遇到了同样的问题，并且想弄清楚为什么我使用的插件会出现“jQuery is undefined”错误。我尝试了从互联网上获得的所有解决方案，但一点运气都没有。

但是，突然间我的脑海中闪过一些东西，可能是脚本文件应该是有序的。所以，我将 jquery 引用移到了第一个位置，一切都开始像魅力一样工作。

请记住，如果您使用任何带有 jquery 的插件，请确保使用以下设置对这些字段的引用的顺序。

1.  对 jquery 库的引用
2.  参考其他后续插件库等等……

例如：

1.  "脚本 src="js/jquery-1.3.2.min.js" 类型="文本/javascript"...
2.  "脚本 src="js/jqDnR.min.js" 类型="文本/javascript"...
3.  "脚本 src="js/jquery.jqpopup.min.js" 类型="文本/javascript"...
4.  "脚本 src="js/jquery.bgiframe.min.js" 类型="文本/javascript"...

始终确保您必须首先放置 jquery 引用，然后是后续库。

希望这可以解决您的问题，尤其是在您使用 MasterPages 时。非常奇怪的是，当您不使用 MasterPages 时，无论您使用什么顺序，它都能正常工作，但当您使用时，它会以某种方式要求正确的顺序。

祝你好运，编码愉快，

文森特·德索萨

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-08-11T07:23:11.243

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-11-11T05:44:04.647

对于任何页面的文件的绝对路径，请使用以下内容：

```
<script type="text/javascript" src="<%= Page.ResolveClientUrl("~/jquery.js") %>"></script> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-30T15:21:37.090

```
<script type="text/javascript" src="/full/path/to/jquery.js"></script> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-30T15:24:20.203

如果此脚本标记直接进入浏览器，那么您不太可能在那里替换您网站的根目录。至少不在服务器上。这样你就可以：

1.  将站点部署到域名的根目录并使用绝对路径（最简单的解决方案）。
2.  使用服务器控制插入此链接。
3.  在将生成的 HTML 发送到客户端之前对其进行预处理（使用 HttpResponse.Filter）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-30T15:40:06.923

您还可以使用 <base> HTML 标签：

```
<base href="http://www.domain.com"></base> 
```

然后标题部分中的所有链接都相对于基地址：

```
<script type="text/javascript" src="scripts/jquery.js"></script> 
```

当您有多个发布目标时，它通常很有用，例如本地开发 Web 服务器、演示服务器等。您只需替换该基本 URL。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-11-12T05:05:21.297

```
<body>
<script language="javascript" src='<%= this.ResolveClientUrl("~/full/path/to/jquery.js") %>' type="text/javascript"></script>
</body> 
```

# javascript - 通过javascript发送网页

> ID：697663
> 
> 赞同：3
> 
> 时间：2009-03-30T15:19:57.500
> 
> 标签：javascript, html, email

我想通过 javascript 通过电子邮件发送网页。它足以打开 Outlook 新邮件选项。我尝试在 html 中移动一个我正在使用 mailto: 选项。实际上我正在尝试创建一个动态电子邮件模板并希望以 html 格式发送该模板。

它显示错误“注释行参数无效。验证您正在使用的开关”请给我解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-30T15:31:08.020

Javascript 无法发送电子邮件。你最好的选择是`<a href="mailto:foo@bar.com">e-mail me</a>`语法。大多数浏览器都支持一个约定，允许您设置各种属性的内容。

```
<a href="mailto:foo@bar.com?subject=Hi&body=hello%2C+there%21">e-mail me</a> 
```

它必须是 URL 编码的，据我所知，没有可靠的方法来传递 HTML。您必须假设纯文本电子邮件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T18:34:40.480

您确实需要服务器的帮助来简化此操作。

1) 让**服务器**向生成所需 HTML 的页面发出 XMLHTTP 请求。抓住它，让它成为邮件正文。

*   或者 -

2）抓取innerHTML，将其隐藏`textarea`并发布回服务器。使用邮件正文中的已发布表单字段。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-10T19:19:20.663

您需要在服务器端执行此操作，而不是客户端。Outlook 不会允许您控制使用模板所需的控制权。并且有充分的理由 - 您不希望网站控制您的 Outlook 并发送电子邮件。

如果您可以告诉我们您使用的是什么服务器，我们可以向您展示如何在服务器端发送电子邮件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-10T19:15:54.863

有一些安全限制会阻止它直接工作。是的，如果你特别想要 Outlook，你可以开始使用 ActiveX——但这很繁琐，并且限制了某些操作系统、安装和安全设置。

最好使用 mailto: URL。这是跨平台的，并支持任何默认邮件客户端。

# c++ - 在 Windows 下使用共享内存。如何传递不同的数据

> ID：697664
> 
> 赞同：2
> 
> 时间：2009-03-30T15:20:02.383
> 
> 标签：c++, windows, shared-memory

我目前尝试使用 Windows [CreateFileMapping](http://msdn.microsoft.com/en-us/library/aa366551.aspx)机制来实现一些进程间通信。我知道我需要先用 CreateFileMapping 创建一个文件映射对象，然后再用 MapViewOfFile 创建一个指向实际数据的指针。然后，该示例使用 CopyMemory 将数据放入映射文件。

在我的应用程序中，我有一个图像缓冲区（1 MB 大），我想将其发送到另一个进程。所以现在我查询一个指向图像的指针，然后将整个图像缓冲区复制到映射文件中。但我想知道这是否真的有必要。难道不能只在共享内存中复制一个指向图像缓冲区数据的实际指针吗？我尝试了一下，但没有成功。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-30T15:25:20.827

不同的进程有不同的地址空间。如果您将一个进程中的有效指针传递给另一个进程，它可能会指向第二个进程中的随机数据。因此，您将不得不复制所有数据。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-30T15:29:17.760

我**强烈**建议您使用[Boost::interprocess](http://www.boost.org/doc/libs/1_38_0/doc/html/interprocess.html)。它有很多好东西来管理这类东西，甚至包括一些特殊的仅限 Windows 的功能，以防您需要与使用特定 Win32 功能的其他进程进行互操作。

最重要的是使用[偏移指针](http://www.boost.org/doc/libs/1_38_0/doc/html/interprocess/offset_ptr.html)而不是常规指针。偏移指针基本上是相对指针（它们存储指针所在位置与所指事物所在位置之间的差异）。这意味着即使两个指针映射到不同的地址空间，只要映射结构相同，就可以了。

我已经使用了各种带有偏移智能指针的复杂数据结构，它就像一个魅力。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-21T03:56:34.747

共享内存并不意味着发送和接收数据。它是为无违规的进程数创建的内存。为此，您必须遵循一些机制，例如锁，以便数据不会损坏。

在过程 1 中：

`CreateFileMapping()`：它将使用最后一个参数中提供的名称创建共享内存块，如果它不存在并返回一个句柄（您可以称它为指针），如果成功。

`MapViewOfFile()`：它在进程地址空间中映射（包括）这个共享块并返回一个句柄（同样你可以说一个指针）。

使用`MapViewOfFile()`仅由返回的此指针，您可以访问该共享块。

在过程 2 中：

`OpenFileMapping()`: 如果共享内存块是由 成功创建的`CreateFileMapping()`，则可以使用相同的名称（用于创建共享内存块的名称）。

`UnmapViewOfFile()`：它将取消映射（您可以从该进程地址空间中删除共享内存块）。当您使用完共享内存（即访问、修改等）后，请调用此函数。

`Closehandle()`：最后要从进程中分离共享内存块，使用参数调用它，句柄由 OpenFileMapping() 或 CreateFileMapping() 返回。

尽管这些函数看起来很简单，但如果未正确选择标志，则行为会很棘手。如果您希望读取或写入共享内存，请`PAGE_EXECUTE_READWRITE`在`CreateFileMapping()`.

每当您希望在创建成功后访问共享内存时，请使用`FILE_MAP_ALL_ACCESS`in `MapViewOfFile()`。

最好在其中指定`FALSE`（不要从父进程继承句柄），`OpenFileMapping()`因为这样可以避免混淆。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-29T10:40:19.607

对于 Windows，您*可以获得*共享内存以在 2 个进程上使用**相同的地址。**它可以通过多种技术实现。

使用[MapViewOfFileEx](http://msdn.microsoft.com/en-us/library/aa366763(VS.85).aspx)，这是 MSDN 的重要专家。

> 如果提供了建议的映射地址，如果指定地址有足够的地址空间，则文件将映射到指定地址（向下舍入到最接近的 64K 边界）。如果没有足够的地址空间，函数就会失败。
> 
> 通常，建议的地址用于指定文件应在多个进程中映射到同一地址。这要求地址空间区域在所有涉及的进程中都可用。在用于映射的区域中不能进行其他内存分配，包括使用 VirtualAlloc 或 VirtualAllocEx 函数来保留内存。
> 
> 如果 lpBaseAddress 参数指定基本偏移量，则如果指定的内存区域尚未被调用进程使用，则函数成功。系统不确保相同的内存区域可用于其他 32 位进程中的内存映射文件。

另一种相关技术是使用带有标记为 Read + Write + Shared 部分的 DLL。在这种情况下，操作系统几乎会为您和任何其他加载 DLL 的进程执行 MapViewOfFileEx 调用。

您可能必须将您的 DLL 标记为固定加载地址，而不是可重定位等。自然。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T15:28:52.970

您可以使用指针编组。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-30T15:37:26.990

如果可能，最好将图像数据直接加载/生成到共享内存区域。这消除了内存副本并将其直接放在需要的位置。当它准备好时，您可以向另一个进程发出信号，将偏移量分配到数据开始的共享内存中。

# xml - 如何在 XSLT 中将元素属性转换为元素名称？

> ID：697669
> 
> 赞同：3
> 
> 时间：2009-03-30T15:21:29.027
> 
> 标签：xml, xslt, transform, xml-attribute

我将链接以转换具有以下属性的“名称”属性的 XML：

```
<books>
  <book name="TheBumperBookOfXMLProgramming"/>
  <book name="XsltForDummies"/>
</books> 
```

放入名为 name 属性中的元素中：

```
<books>
  <TheBumperBookOfXMLProgramming/>
  <XsltForDummies/>
</books> 
```

使用 XSLT。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T15:24:25.883

您可以使用以下名称创建元素`xsl:element`：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet 
     version="1.0" 
     xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" indent="yes"/>

  <xsl:template match="/">
    <books>
      <xsl:apply-templates />
    </books>

  </xsl:template>

  <xsl:template match="book">
    <xsl:element name="{@name}" />
  </xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-30T15:30:03.967

```
<xsl:template match="book">
   <xsl:element name="{@name}">
       <xsl:copy-of select="@*[name()!='name'] />
   </xsl:element>
</xsl:template> 
```

`<book>`这也会复制未命名为“名称”的任何属性

```
<book name="XsltForDummies" id="12" /> 
```

会变成

```
<XsltForDummies id="12 /> 
```

# sql - 带有可选“WHERE”参数的存储过程

> ID：697671
> 
> 赞同：42
> 
> 时间：2009-03-30T15:21:42.347
> 
> 标签：sql, mysql, sql-server, oracle

我有一个表单，用户可以在其中指定各种参数来挖掘一些数据（状态、日期等）。

我可以生成一个查询：

```
SELECT * FROM table WHERE:
status_id = 3
date = <some date>
other_parameter = <value> 
```

等等。每个`WHERE`都是可选的（我可以选择所有带有`status = 3`的行，或者带有 的所有行`date = 10/10/1980`，或者带有`status = 3 AND date = 10/10/1980`等的所有行）。

给定大量参数，都是可选的，组成动态存储过程的最佳方法是什么？

我正在研究各种数据库，例如：MySQL、Oracle 和 SQLServer。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-03-30T15:25:29.343

实现此目的的最简单方法之一：

```
SELECT * FROM table 
WHERE ((@status_id is null) or (status_id = @status_id))
and ((@date is null) or ([date] = @date))
and ((@other_parameter is null) or (other_parameter = @other_parameter)) 
```

等等。这完全消除了动态 sql 并允许您搜索一个或多个字段。通过消除动态 sql，您消除了有关 sql 注入的另一个安全问题。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-30T15:26:12.323

像这样创建您的程序：

```
CREATE PROCEDURE [dbo].[spXXX]
    @fromDate datetime = null,
    @toDate datetime = null,
    @subCode int = null
as
begin
set NOCOUNT ON
/* NOCOUNT limits the server feedback on select results record count */
SELECT
    fields...
FROM
    source
WHERE
    1=1
--Dynamic where clause for various parameters which may or may not be passed in.
and ( @fromDate is null or [dateField] >= @fromDate)
and ( @toDate is null or [dateField] <= @toDate)
and ( @subCode is null or subCode= @leaveTypeSubCode)
order by fields... 
```

这将允许您使用 0 个参数、所有参数或任何 # 个参数来执行该过程。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-08T10:11:43.770

这是我使用的风格：

**t-sql**

```
SELECT    *        
FROM    table        
WHERE     
status_id    =    isnull(@status_id ,status_id)     
and    date    =    isnull(@date ,date )     
and    other_parameter    =    isnull(@other_parameter,other_parameter) 
```

**甲骨文**

```
SELECT    *        
FROM    table        
WHERE     
status_id    =    nval(p_status_id ,status_id)     
and    date    =    nval(p_date ,date )     
and    other_parameter    =    nval(p_other_parameter,other_parameter) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-11-30T16:47:00.207

一种可读且可维护的方法（甚至可与 JOIN/APPLY 一起使用）：

```
where 
      (@parameter1 IS NULL OR your_condition1)
  and (@parameter2 IS NULL OR your_condition2) 
-- etc 
```

然而，在大多数大表（甚至更多使用 JOIN/APPLY）上这是一个坏主意，因为您的执行计划不会忽略 NULL 值并产生大量性能漏洞（例如：扫描所有表以搜索 NULL 值）。

SQL Server 中的一种迂回方式是在查询中使用 WITH(RECOMPILE) 选项（自 SQL 2008 SP1 CU5 (10.0.2746) 起可用）。

实现这一点（性能方面）的最佳方法是使用 IF ... ELSE 块，每个组合都有一个。也许这很累，但您将获得最佳性能，并且您的数据库设置无关紧要。

如果您需要更多详细信息，可以查找 KM。[*在这里*](https://stackoverflow.com/questions/3415582/how-can-i-use-optional-parameters-in-a-t-sql-stored-procedure)回答。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-30T15:25:48.080

你可以做类似的事情

```
WHERE 
(
 ParameterA == 4 OR ParameterA IS NULL
)

AND
(
 ParameterB == 12 OR ParameterB IS NULL
) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-30T15:28:45.623

如果您想避免动态构建 SQL 字符串（通常最好避免），您可以通过将 where 子句中的每个标准与默认值进行比较，在存储过程中执行此操作，这相当于“忽略”。例如：

```
select * from Table where
   (@Col1 IS NULL OR Col1 = @Col1) /*If you don't want to filter in @col, pass in NULL*/
   AND
   (@Col2 IS NULL OR Col2 = @Col2) 
```

# windows-mobile - 如何在 Windows Mobile 中弹出键盘？

> ID：697676
> 
> 赞同：2
> 
> 时间：2009-03-30T15:23:48.660
> 
> 标签：windows-mobile, compact-framework

我正在尝试复制以下行为（WM6）。

转到设置 -> 关于 -> 设备 ID。设备名称文本框获得焦点，导致屏幕键盘弹出。

我希望能够在我的应用程序中做同样的事情，最好是在托管代码中。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-30T16:21:05.233

屏幕键盘位于 Microsoft.WindowsCE.Forms 命名空间中。

添加一个项目引用，您将拥有可用的 InputPanel 控件，将其中一个添加到您的表单中，然后在您的代码中。

```
private void txtField_GotFocus(object sender, EventArgs e)
{
     //Enabled == show
     inputPanel.Enabled = true;
}

private void txtField_LostFocus(object sender, EventArgs e)
{
     inputPanel.Enabled = false;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T20:24:19.577

我要补充一点，您还需要为您的项目实例化 Microsoft.WindowsCE.Forms.InputPanel 类的实例（除了添加对[TreeUK](https://stackoverflow.com/users/29553/treeuk)所指出的命名空间的引用之外）。

最简单的方法是在设计模式下将 InputPanel 控件拖到 Windows 窗体上。无论您如何命名 InputPanel 实例，您在表单字段的事件处理程序中都会引用该实例。

# internet-explorer - IE6 PNG透明度

> ID：697682
> 
> 赞同：24
> 
> 时间：2009-03-30T15:24:28.457
> 
> 标签：internet-explorer, png, internet-explorer-6, transparency

如何修复 IE6 中背景图像的 PNG 透明度错误？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-30T15:40:25.190

[我喜欢David Cilley](http://www.atalasoft.com/cs/blogs/davidcilley)前段时间写的这个 Javascript 解决方案。它不受兼容浏览器的影响，可以与您想要的任何后端一起使用。不过，它仍然需要一个空白的 gif 图像。

将这些函数添加到您的 HTML Header 或其他现有 .js 包括：

```
<script type="text/javascript">
    function fixPngs(){
    // Loops through all img tags   
        for (i = 0; i < document.images.length; i++){
            var s = document.images[i].src;
            if (s.indexOf('.png') > 0)  // Checks for the .png extension
                fixPng(s, document.images[i]);
        }
    }

    function fixPng(u, o){
        // u = url of the image
        // o = image object 
        o.src = 'images/spacer.gif';  // Need to give it an image so we don't get the red x
        o.style.filter = "progid:DXImageTransform.Microsoft.AlphaImageLoader(src='" + u + "', sizingMethod='scale')";
    }   
</script> 
```

将以下条件注释放在底部（页脚部分，就在 </body> 之前）：

```
<!--[if lte IE 6]>
    <script language="javascript" type="text/javascript">
        //this is a conditional comment that only IE understands. If a user using IE 6 or lower 
         //views this page, the following code will run. Otherwise, it will appear commented out.
        //it goes after the body tag so it can fire after the page loads.
        fixPngs();
    </script> 
<![endif]--> 
```

要更全面地解决 IE6 异常，请尝试[IE7 Javascript 库](http://code.google.com/p/ie7-js/)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-30T15:25:56.830

使用这个： http: [//www.twinhelix.com/css/iepngfix/](http://www.twinhelix.com/css/iepngfix/)

这也适用于 IE 5.5，但不适用于 IE 的 mac 版本或更早版本的 IE。

我在很少的网站上使用过它，并且没有遇到任何问题。

有时在 PNG 周围会出现一个丑陋的灰色框，直到脚本启动。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-30T15:35:31.770

使用[PNG 行为](http://webfx.eae.net/dhtml/pngbehavior/pngbehavior.html)。

ie6.css：

```
img {
   behavior: url("pngbehavior.htc");
} 
```

page.html：

```
<!--[if IE 6]> 
  <link rel="stylesheet" type="text/css" href="ie6.css" />
<![endif]--> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-12-13T22:52:33.503

我要去这里取死灵法师徽章。:)

这并不完全是一个修复程序，而是我不时使用的一种方便的解决方法，以支持 IE6 上的透明度，而根本不需要任何额外的代码。它并不总是符合要求，但经常符合要求。

这个想法是，在大多数情况下，无论如何您都需要在固定颜色背景上显示您的 PNG。PNG 文件可以具有指定的背景颜色，IE6 将支持它。您所做的是获得[TweakPNG](http://entropymine.com/jason/tweakpng/)实用程序并打开您的 PNG 文件。在那里您将能够添加一个`bKGD`块，它指定所需的背景颜色。只需输入显示 PNG 所需的颜色，即可完成。

注意事项 - PNG 文件通常包含一些值以补偿不同的显示设备。可能有诸如预期的色彩空间、色度、伽马等之类的东西。这些本身并不坏，但 IE 以某种方式误解了它们，结果是 PNG 显示的比应有的更暗（或者 IE 可能是唯一做对的人？我不记得了……）

无论如何，如果您希望每个浏览器都以相同的方式显示您的 PNG，您应该使用上述实用程序删除这些块。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-30T15:26:20.310

twinhelix [png修复](http://www.twinhelix.com/css/iepngfix/)应该可以帮助你

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-30T15:26:57.610

例如[Dean Edwards 的 ie7.js](http://dean.edwards.name/IE7/)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-30T15:39:38.500

您可以勇敢地简单地声明您的网站在 IE6 上可能无法很好地呈现。也许不是最具商业头脑的方法，但如果我们让 IE6 死掉，我们会帮自己一个忙（甚至是微软）。当然，由于大量的在线活动发生在安装了 IE6 的公司机器上，这不会很快发生。:(

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-03T17:27:20.090

请注意，AlphaImageLoader 转换可能会使[IE6 死锁](http://blogs.cozi.com/tech/2008/03/transparent-pngs-can-deadlock-ie6.html)。

使用[PNG8s](http://blogs.cozi.com/tech/2008/03/transparent-pngs-can-deadlock-ie6.html)而不是常规的 PNG32s。您被限制为 256 种颜色和 1 位 alpha 透明度，但它比随机死锁浏览器要好。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-03-16T22:26:35.767

1.在文档的头块内添加 IE6 的条件 css：

```
<!--[if (IE 6)]>
    <link rel="stylesheet" type="text/css" href="locationOfyourCss/ie6.css"/>
<![endif]-->
```

2.在您的元素中分配类名：

```
 <td class = yourClassName> 
```

3.在ie6.css中，应用过滤器。您必须指定宽度和高度。将背景图像设置为 clear.cache.gif，如果没有这些属性，过滤器将无法工作：

```
 .yourClassName{
    width:8px;
    height:22px;
    background: url("locationOfBlankImage/clear.cache.gif");
    filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='filePath/imageName.png', sizingMethod='scale');
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-12-15T17:15:05.357

我正在做的一个项目中我正在做的是从 Paul Irish 的[HTML5 Boilerplate](https://github.com/paulirish/html5-boilerplate)中获得灵感，并将条件样式分配给*整个页面*。他在[这里](http://paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ "这里")详细介绍了它，但简单地说，这个想法是在您网站上每个页面的 HTML 中添加条件检查，应用于 body 标记。像这样：

```
<!--[if lt IE 7 ]> <body class="ie6 pageStyle"> <![endif]-->
<!--[if IE 7 ]>    <body class="ie7 pageStyle"> <![endif]-->
<!--[if IE 8 ]>    <body class="ie8 pageStyle"> <![endif]-->
<!--[if IE 9 ]>    <body class="ie9 pageStyle"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <body class="pageStyle"> <!--<![endif]--> 
```

IE 浏览器会读取这些注释并应用这些样式。其他浏览器会忽略它。这样做的好处是您可以设计符合标准的网站，使用 PNG 等等。然后，在您的 CSS 中，在标准样式之后添加其他样式，为 IE 浏览器提供所需的样式。例如，我正在研究的一种样式使用 PNG 背景图像。为了让这个在 ie6 中玩得更好，我可以使用 javascript/htc 来替换它们，应用那里的许多 hack 之一。或者我可以这样做：

```
.someStyle {
    background: url(/images/someFile.png) no-repeat; 
background-position: -0px -280px;

}

.ie6 .someStyle {
   background: url(/images/someFile.gif) no-repeat; 
background-position: -0px -280px;

} 
```

通过向我的 ie6 用户提供 GIF，没有占用 CPU 的解决方法过程，如果您曾经在可能运行 ie6 的那种 POS 机上进行过测试，这实际上是一个非常大的问题。而且，我并没有为拥有漂亮浏览器的优秀用户放弃任何品质。

它确实需要两个单独的文件，但我认为它比大多数实现更简洁。此外，使用 .ie6 .whatever 代替单独的 ie6.css 文件，可以使您的修复紧挨着它们所应用的样式，我发现它更简洁且更易于使用。它还鼓励您随时考虑 ie6 用户，而不是完成您的设计然后惊恐地回头

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-03-16T22:32:41.333

这是一篇关于这个问题的[好文章。](http://24ways.org/2007/supersleight-transparent-png-in-ie6)总之，它提供了一个名为 SuperSleight 的 JS 库。我过去曾使用过它并取得了相当大的成功。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-08-28T17:52:32.780

好的，我对 html/js 几乎是新手，但我认为我必须稍微更改 Rob Allen 的答案来解决两个问题：

1.  AlphaImageLoader() 正在改变我的图像的纵横比，所以我需要在图像加载*后恢复原始大小。*
2.  如果从 html 末尾调用 fixPngs()，则在加载文档之后但在加载所有图像之前调用。

所以我改变了我的 fixPngs() 只附加一个事件：

```
function fixPngs() {
  // Loops through all img tags
  for(i = 0; i < document.images.length; i++) {
    var u = document.images[i].src;
    var o = document.images[i];

    if(u.indexOf('.png') > 0) {
      o.attachEvent('onload', fixPng);
      o.src = u;
    }
  }
} 
```

fixPngs() 仍然从 html 的末尾被调用：

```
<!--[if lte IE 6]>
  <script language="javascript" type="text/javascript">
    // Do this after the page loads
    fixPngs();
  </script>
<![endif]--> 
```

fixPng() 现在获取调用者，分离事件，保存原始尺寸，调用 AlphaImageLoader() 并最终恢复尺寸：

```
// u = url of the image
// o = image object
function fixPng(e) {
  var caller = e.target            ||
               e.srcElement        ||
               window.event.target ||
               window.event.srcElement;
  var u = caller.src;
  var o = caller;

  if(!o || !u)
    return;

  // Detach event so is not triggered by the AlphaImageLoader
  o.detachEvent('onload', fixPng);

  // Save original sizes
  var oldw = o.clientWidth;
  var oldh = o.clientHeight;

  // Need to give it an image so we don't get the red x
  o.src          = 'images/spacer.gif';
  o.style.filter = "progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+ u +"', sizingMethod='scale')";

  // Restore original sizes
  if(o.style) {
    o.style.width  = oldw +"px";
    o.style.height = oldh +"px";
  }
} 
```

我是不是过度杀戮了？

# iphone - 帮助在 TableView 中插入新部分

> ID：697683
> 
> 赞同：5
> 
> 时间：2009-03-30T15:25:11.670
> 
> 标签：iphone, ios, cocoa-touch, uitableview, insert

每个人都在写关于删除部分的文章。好吧，我似乎无法添加一个。

目前，我正在尝试这样（失败并出现 NSInternalInconsistencyException）：

```
UITableView *tv = (UITableView *) self.tableView;

if ([tv numberOfSections] == 1)
{
     [tv beginUpdates];
     [tv insertSections:[NSIndexSet indexSetWithIndex:0] withRowAnimation:UITableViewRowAnimationTop];

     NSLog(@"Inserted.. Brace for impact.");
     [tv endUpdates];
}

NSLog(@"Section count after update: %d", [tv numberOfSections]); // Never reached 
```

如果我是正确的，插入索引为 0 的部分应该将其放在顶部，将所有其他部分向下碰撞，对吗？好吧，如果我在 insertSections 之后立即写出 numberOfSections，则节数似乎没有变化。

有任何想法吗？

约翰

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-08T06:43:27.193

是的，谢谢你们俩。

经过一番折腾，我终于设法让它工作了。这是您的两个建议的结合。从未插入新数据，但我也不必增加插入的第一项的行数，而只需增加第二项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T15:29:37.417

您是否还更新了数据源？您不能只更新表视图而不更新基础数据。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-30T15:34:12.850

您需要更新[UITableViewDataSource](https://developer.apple.com/documentation/uikit/uitableviewdatasource?language=objc)类的[numberOfSectionsInTableView](https://developer.apple.com/documentation/uikit/uitableviewdatasource/1614860-numberofsectionsintableview)消息。

# javascript - 为什么使用 .post 和 hide("slide") 时会出现 jQuery 语法错误？

> ID：697694
> 
> 赞同：0
> 
> 时间：2009-03-30T15:26:45.830
> 
> 标签：javascript, jquery, syntax

完成 .post 之后，我想用左幻灯片隐藏第一个 div，然后用右幻灯片显示第二个 div。我的右滑轨工作正常，然后我去尝试放入左滑轨，但我把它弄坏了。

```
if(hasError == false) {
    $.post("/process-email-signups",{email_address: email_addressVal},
        function(data){
            $("#email_signup_form").hide("slide", { direction: "left" }, 1000); 
                function() {
            $("#thank_you_message").show("slide", { direction: "right" }, 1000);
                });
            }
        );
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T15:28:38.463

你那里有一个无关的功能块。试试这个：

```
function(data){
                $("#email_signup_form").hide("slide", { direction: "left" }, 1000); 

                $("#thank_you_message").show("slide", { direction: "right" }, 1000);

                }
        ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-30T15:28:36.263

我不确定额外的函数（）在做什么，也许尝试删除它？

```
if(hasError == false) {
    $.post("/process-email-signups",{email_address: email_addressVal},
        function(data){
                $("#email_signup_form").hide("slide", { direction: "left" }, 1000); 
                $("#thank_you_message").show("slide", { direction: "right" }, 1000);
        }
    );
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T15:30:17.100

```
if(hasError == false) {
    $.post("/process-email-signups", {email_address: email_addressVal},
        function(data){
                $("#email_signup_form").hide("slide", { direction: "left" }, 1000); 
                $("#thank_you_message").show("slide", { direction: "right" }, 1000);
        }
    );
} 
```

# java - 帮助解决 java j2me 中的 RecordStore 更新问题？

> ID：697697
> 
> 赞同：0
> 
> 时间：2009-03-30T15:27:03.973
> 
> 标签：java, java-me

我有这段代码，我已将其缩短为我认为会影响结果的最重要的位，但基本上我有一个关于字节的错误。我不知道为什么，因为我借用了代码，所以这段代码在不同的程序中工作。这意味着使用检索按钮从记录存储中提取数据，然后在使用更新按钮进行更改时更新它，但我无法让它运行。

有人可以帮助或指向一个有用的更新记录存储教程吗？

谢谢

```
private RecordStore rs;

    Update = new Form("Update");
    Update.addCommand(new Command("Home", Command.BACK, 0));       
    cmRetrieve = new Command("Retrieve", Command.SCREEN, 1);
    cmUpdate = new Command("Update", Command.SCREEN, 2);
    tfRecID = new TextField("Record ID:", "", 8, TextField.NUMERIC);
    txtName = new TextField("Name of Event: ", null, 15, TextField.ANY);

    Update.append(tfRecID);
    Update.append(txtName);
    Update.addCommand(cmRetrieve);
    Update.addCommand(cmUpdate);
    Update.setCommandListener(this);

    String str;
    byte bytes[];
    int recID;

else
    if (c.getLabel().equals("Retrieve"))
    {
            recID = Integer.parseInt(tfRecID.getString());
            bytes = rs.getRecord(recID);
            str = new String(bytes);
            int idx = str.indexOf(";");
            txtName.setString(str.substring(0, idx));

    }
    else
    if(c.getLabel().equals("Update"))
    {
            recID = Integer.parseInt(tfRecID.getString());
            str = txtName.getString() + ":";
            bytes = str.getBytes();
            rs.setRecord(recID, bytes, 0, bytes.length);

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-31T14:02:43.480

[http://developers.sun.com/mobility/midp/articles/databaserms/](http://developers.sun.com/mobility/midp/articles/databaserms/)提供了一个很好的关于 RMS 的教程。

从我在不运行代码的情况下可以看到，传递给的结束索引`setRecord`是不正确的。你需要改变：

```
rs.setRecord(recID, bytes, 0, bytes.length); 
```

至：

```
rs.setRecord(recID, bytes, 0, bytes.length-1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-22T04:03:17.093

我不认为这是个问题。rs.setRecord(recID, bytes, 0, bytes.length); 最后一个参数是字节长度

# wpf - WPF 数据网格性能

> ID：697701
> 
> 赞同：35
> 
> 时间：2009-03-30T15:27:55.827
> 
> 标签：wpf, performance, datagrid

我正在使用 WPF Toolkit 数据网格，目前它的滚动速度非常慢。网格有 84 列和 805 行。（包括 3 个固定列和标题是固定的。）水平和垂直滚动都非常慢。虚拟化已打开，我已在 xaml 中显式启用列虚拟化和行虚拟化。有什么需要注意的可以真正影响性能，例如绑定方法，或者每个单元格模板中的 xaml 是什么？

需要注意的一件事是我在创建数据网格时动态添加列。那会影响什么吗？（我还同时动态创建了单元格模板，以便我的绑定设置正确。）

下面是生成的大多数单元格的模板代码。基本上对于我需要动态添加的列（其中大部分），我遍历我的列表并使用 AddColumn 方法添加列，另外我动态构建模板以便绑定语句正确索引集合中的正确项目对于该列。模板不太复杂，只有两个 TextBlock，但我确实在每个上绑定了四个不同的属性。通过将绑定更改为 OneWay，我似乎能够挤出更多性能：

```
 private void AddColumn(string s, int index)
    {
        DataGridTemplateColumn column = new DataGridTemplateColumn();
        column.Header = s;
        //Set template for inner cell's two rectangles
        column.CellTemplate = CreateFactViewModelTemplate(index);
        //Set Style for header, ie rotate 90 degrees
        column.HeaderStyle = (Style)dgMatrix.Resources["HeaderRotateStyle"];
        column.Width = DataGridLength.Auto;
        dgMatrix.Columns.Add(column);
    }

    //this method builds the template for each column in order to properly bind the rectangles to their color
    private static DataTemplate CreateFactViewModelTemplate(int index)
    {
        string xamlTemplateFormat =
            @"<DataTemplate xmlns=""http://schemas.microsoft.com/winfx/2006/xaml/presentation""
            xmlns:x=""http://schemas.microsoft.com/winfx/2006/xaml"">
            <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition />
                <ColumnDefinition />
            </Grid.ColumnDefinitions>
            <TextBlock Grid.Column=""0"" MinHeight=""10"" MinWidth=""10"" HorizontalAlignment=""Stretch"" Padding=""3 1 3 1"" TextAlignment=""Center"" Foreground=""{Binding Path=FactViewModels[~Index~].LeftForeColor,Mode=OneWay}"" Background=""{Binding Path=FactViewModels[~Index~].LeftColor,Mode=OneWay}"" Text=""{Binding Path=FactViewModels[~Index~].LeftScore,Mode=OneWay}"" />
            <TextBlock Grid.Column=""1"" MinHeight=""10"" MinWidth=""10"" HorizontalAlignment=""Stretch"" Padding=""3 1 3 1"" TextAlignment=""Center"" Foreground=""{Binding Path=FactViewModels[~Index~].RightForeColor,Mode=OneWay}"" Background=""{Binding Path=FactViewModels[~Index~].RightColor,Mode=OneWay}"" Text=""{Binding Path=FactViewModels[~Index~].RightScore,Mode=OneWay}"" />
            </Grid>
            </DataTemplate>";

        string xamlTemplate = xamlTemplateFormat.Replace("~Index~", index.ToString());

        return (DataTemplate)XamlReader.Parse(xamlTemplate);
    } 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-30T15:51:22.947

由于我看不到您的源代码，因此很难为您提供帮助。特别是因为 WPF 应用程序的性能受到很多因素的影响。有关注意事项的一些提示，请参阅[优化 WPF 应用程序性能](http://msdn.microsoft.com/en-us/library/aa970683.aspx)。是的 - 每个单元格中使用什么 xaml 非常重要。因为通常性能问题归结为“元素太多”。你知道我认为一个 TextBox 是 30 个单独的元素吗？我建议您使用[WPF 的性能分析工具](http://msdn.microsoft.com/en-us/library/aa969767.aspx)来了解有关您的特定问题的更多信息。尽量减少您正在使用的元素数量（例如，在适当的情况下从 TextBox 切换到 TextBlock）。

此外，您还必须检查您尝试使用该应用程序的任何 PC 上是否存在性能问题。也许您正在使用的 PC 迫使 WPF 进入基于软件的渲染。或者你正在使用任何 BitmapEffects 吗？

编辑：
查看您的代码，我建议您更改

`column.Width = DataGridLength.Auto;`

到一个合理的固定宽度，因为数据网格不必在每次发生变化（如添加行，甚至滚动）时动态地​​重新计算宽度。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2011-09-14T07:55:41.447

DataGrid 性能问题的一般提示：我遇到了 DataGrid 的问题，在该问题中，在调整窗口大小、列排序等之后需要几秒钟才能刷新，并且在这样做时锁定了窗口 UI（1000 行，5 列）。

它归结为 WPF 大小计算的问题（错误？）。我将它放在 RowDefinition Height="Auto" 的网格中，这导致渲染系统在运行时尝试通过测量每一列和每一行的大小来重新计算 DataGrid 的大小，大概是通过填充整个网格（据我了解）。它应该以某种方式智能地处理这个问题，但在这种情况下它不是。

快速检查这是否是相关问题是在测试期间将 DataGrid 的 Height 和 Width 属性设置为固定大小，然后再次尝试运行。如果您的性能恢复，永久修复可能是以下选项之一：

*   将包含元素的大小更改为相对 (*) 或固定值
*   将 DataGrid 的 MaxHeight 和 MaxWidth 设置为比正常使用时更大的固定值
*   尝试使用不同大小调整策略的另一种容器类型（Grid、DockPanel 等）

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-11-29T12:29:34.397

在我的一个项目中，以下网格样式设置导致了主要的性能问题：

```
 <Style  TargetType='{x:Type controls:DataGrid}'>
    <Setter Property='ScrollViewer.CanContentScroll' Value='False' />
    ... 
```

当我删除 ScrollViewer.CanContentScroll 设置时，性能问题就消失了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-21T14:19:39.033

您是否安装了任何类型的平板电脑（通过 USB 或平板电脑）？

使用平板电脑时，我在 WPF 数据网格中发现了一个性能错误。我发布了一个视频，MS[在此线程中确认了它](http://wpf.codeplex.com/Thread/View.aspx?ThreadId=41964)

干杯，乔恩

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-11-23T14:25:51.033

我有一个案例，我的底层对象只有 setter 的属性。通过在集合中实现 ITypedList 并通过单个对象上的 TypeDescriptionProvider/ICustomTypeDescriptor 可以访问相同的属性。删除属性或添加 getter 解决了性能问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-03T06:40:45.240

在这种情况下，我建议的一件事是查看您如何应用样式以及每个单元格上的样式。如果它具有复杂的视觉树，则应用的样式确实会降低性能。

您还可以在最新的 WPF Datagrid 上尝试延迟滚动选项。

# .net - 使用 .Net OnSerializingAttribute 更改变量名称？

> ID：697706
> 
> 赞同：2
> 
> 时间：2009-03-30T15:29:04.077
> 
> 标签：.net, serialization, .net-2.0, obfuscation

为了混淆应用程序代码但仍然能够使用序列化来保存应用程序数据，我想将所有序列化成员的名称映射到自定义序列化名称。我知道我可以通过实现 ISerizableInterface 来实现这一点，但在 MSDN 中，他们建议使用 OnDeserializedAttribute、OnSerializingAttribute、OnSerializedAttribute 和 OnDeserializingAttribute 进行序列化。所以我想使用 OnSerializingAttribute 来重命名我的成员。问题是我找不到明确确定序列化成员的名称的方法。

是否可以使用 OnSerializingAttribute 显式定义序列化名称？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T15:40:38.870

我认为自定义序列化和 ISerializable 接口将是您情况下最有效的方式。[在此处](http://msdn.microsoft.com/en-us/library/ty01x675(VS.71).aspx)查看示例。此外[，这里](http://social.msdn.microsoft.com/Forums/en-US/netfxremoting/thread/22273542-504c-4510-9173-216c889f0540/#)还有一个关于您提到的 ISerializable 和序列化属性的很好的讨论线程。

我想说，如果你想完全控制格式，你应该使用自定义序列化程序，如果你想响应（反）序列化流程，属性是最好的选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T19:21:47.840

（**编辑**：我决定把它写成一篇[博客文章](http://marcgravell.blogspot.com/2009/03/obfuscation-serialization-and.html)，因为我已经多次看到它很有用）

在为此使用[protobuf-net](http://code.google.com/p/protobuf-net/)之前，我已经有用户；这使用 Google 的密集二进制“协议缓冲区”线路格式，其中不包括线路上的任何名称 - 只是数字。这意味着：

*   名字没有暴露在电线上
*   运行时类中的名称是“DateOfBirth”还是“a1v”都没有关系

这通过将整数标签分配给成员（属性或字段）来工作 - 例如：

```
[ProtoMember(4)]
public DateTime DateOfBirth {get;set;} 
```

序列化中仅使用“4”，但（重要的是）您不需要维护大量序列化代码。`ISerializable`如果您需要使用远程处理，也可以很容易地挂接，如果您愿意，还可以使用 WCF 挂钩。

披露：我是作者，所以我有偏见 - 但该工具是免费的，所以你不会因为看而失去任何东西;-p

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-29T16:03:30.107

如果您使用的是 .NET4 或 .NET4.5，您可以定义自己的 DataContractResolver 来重命名属性，但使用`[DataMember(...)]`属性中命名的压缩会更简单

# c++ - 为什么这个 Blitz++ 代码不能编译？

> ID：697711
> 
> 赞同：0
> 
> 时间：2009-03-30T15:29:48.523
> 
> 标签：c++, templates, linear-algebra, blitz++, expression-templates

我是闪电战++新手。到目前为止，一切都很好，但我有点困惑为什么下面代码中的注释行无法编译

```
error: conversion from ‘blitz::_bz_tinyMatExpr<blitz::_bz_tinyMatrixMatrixProduct<double, double, 3, 3, 3, 3, 1, 3, 1> >’ to non-scalar type ‘const m33’ requested 
```

我在 Debian/Lenny (g++ 4.3.2, Blitz 0.9)。这是代码：

```
#include <blitz/blitz.h>
#include <blitz/array.h>
#include <blitz/matrix.h>
#include <blitz/matexpr.h>
#include <blitz/tinymat.h>
#include <blitz/tinymatexpr.h>
#include <blitz/tinyvec.h>
#include <blitz/tinyvec-et.h>
#include <blitz/vector.h>
#include <blitz/vector-et.h>

typedef blitz::TinyVector<double,3> v3;
typedef blitz::TinyMatrix<double,3,3> m33;

int main(int,char**)
{
  const m33 a;
  const m33 b;
  m33 c;c=blitz::product(a,b);  // Compiles OK
  //const m33 d=blitz::product(a,b);  // Fails to compile.
  return 0;
} 
```

我确实喜欢被约束，所以很高兴知道是否有办法让它工作（到目前为止，Blitz++ 的经验表明，这可能只是选择正确的包括... ）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T18:06:56.977

我看过 Blitz++ 的源代码。令人惊讶的是，TinyMatrix**没有**模板构造函数，但有一个模板 = 运算符。这意味着你不能做你想做的事。所以我建议忘记你的矩阵是*const*。或者找到另一种方法，例如创建一个非常量矩阵，将其作为 const 引用作为函数的参数传递。

现在，只是为了好玩，事实是你可以复制模板 operator=() 代码并在 blitz/tinymat.h 中创建一个新的模板构造函数，但我不会！如果你**真的**想，这里是如何：

```
// Turn the following code...

template<typename T_expr>
TinyMatrix<T_numtype, N_rows, N_columns>&
operator=(_bz_tinyMatExpr<T_expr> expr)
{
    // USEFUL CODE
    return *this;
}

// ...into this :
template<typename T_expr>
TinyMatrix(_bz_tinyMatExpr<T_expr> expr)
{
    // USEFUL CODE
} 
```

并且您的代码可以编译（并且可能有效）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-07T17:15:36.807

```
//const m33 d=blitz::product(a,b);  // Fails to compile.
const m33 d;
const_cast<m33>(d) = blitz::product(a,b); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T15:53:49.260

抱歉，不知道闪电战，但有些想法可能会有所帮助。

blitz::TinyMatrix 是否有适当的构造函数？
也许尝试其他形式的复制构造函数

```
const m33 d( blitz::product(a,b) ); 
```

应用标准的 const 关键字真的合适吗？也许你可能需要

```
typedef blitz::TinyMatrix<const double,3,3> const_m33;
typedef blitz::ConstTinyMatrix<double,3,3> const_m33; 
```

# vba - 从 VBA 访问气球提示

> ID：697714
> 
> 赞同：1
> 
> 时间：2009-03-30T15:30:06.290
> 
> 标签：vba, balloon, popup-balloons

如何使用 VBA 访问任务托盘区域中的气球提示？我正在寻找一些简单的方法来显示甚至可能与用户交互。

我正在使用 Windows XP 和 MS Access 2003。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T15:40:37.810

不在任务托盘中，但一种方法是使用办公室助理。

请参阅[使用 Office 助手替代显示和检索用户输入](http://msdn.microsoft.com/en-us/library/aa163981(office.10).aspx#odc_offtips_topic10)

# c# - ASP.net 页面中的 WCF 客户端

> ID：697720
> 
> 赞同：1
> 
> 时间：2009-03-30T15:31:27.020
> 
> 标签：c#, asp.net, wcf, page-lifecycle

任何人都可以建议从 ASP.net 页面使用 WCF 服务的良好模式吗？似乎如果 Client(:ServiceModel.ClientBase) 的生命周期没有得到适当的控制，我们就会抛出 PipeException。它目前作为 Page 类的一个字段存在，但在每个页面请求时都被重新实例化，而不被清理（.Close 方法）。

我怀疑这个问题可以改写为“管理 ASP.net 页面中的有限资源”，并且可能与 ASP.net 页面的生命周期更相关。我是 ASP.net 的新手，所以我对此的理解有点薄。

TIA。

编辑：一些代码（没什么大不了的！）

```
public partial class Default : Page
{
    //The WCF client... obviously, instantiating it here is bad,
    //but where to instantiate, and where to close?
    private readonly SearchClient client = new SearchClient();

    protected void Page_Load(object sender, EventArgs e)
    { 
```

第二次编辑：以下会更好吗？

```
public partial class Default : Page
{
    private SearchClient client;

    protected void Page_Unload(object sender, EventArgs e)
    {
        try
        {
            client.Close();
        }
        catch
        {
            //gobbled
        }
    }

    protected void Page_Load(object sender, EventArgs e)
    {
        client= new SearchClient();
        //..... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T03:08:03.903

我同意迈克尔的观点，如果可能的话，将其抽象到另一层。

但是，如果您要从您的 aspx 页面调用它，我只需创建一个单独的方法来调用它，返回其结果并进行清理。通过将所有代码集中在一个地方来保持代码整洁。请记住在您的 finally 块中进行处理，并且必须将 wcf 代理强制转换为 IDisposable 才能进行处理。

例如：

```
void Page_Load(object sender, EventArgs e)
{
  if(!IsPostBack)
  {
      RemoteCall();
  }
}

void RemoteCall()
{
 var client = new SearchClient();
 try
 {
     var results = client.Search(params);
     clients.Close();
 }
 catch(CommunicationException cex)
 {
   //handle
 }
 catch(Exception ex)
 {
   //handle
 }
 finally
 {
     ((IDisposable)client).Dispose();
 }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T16:18:44.660

通常，您不应直接从表示层调用外部服务。它产生了两个问题：首先，性能（池化、扩展等），其次，如果您需要进行身份验证，它会产生安全风险（DMZ 中的身份验证代码是错误的。

即使您没有应用程序层，您也应该考虑将服务调用重构为表示层中的私有服务。这将允许您将服务的生命周期与页面的生命周期分离（正如您所说，这是有问题的）。

# php - 我可以使用一个暴露的过滤器来过滤不同页面上的多个块视图吗？

> ID：697728
> 
> 赞同：0
> 
> 时间：2009-03-30T15:34:26.110
> 
> 标签：php, drupal, views, drupal-5

我在一个页面上有四个块视图（称为“信息”页面），它们按邻近度过滤，为我提供与一个特定过滤位置相关的四条信息。

我希望能够创建一个带有暴露邻近过滤器的介绍页面，执行该过滤器时会将我带到（信息）页面，并同时过滤在介绍页面上输入的接近度的四个视图。

我怎样才能做到这一点？我是 php 新手，但正在学习....愿意努力工作！

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T16:26:43.970

如果您在 Drupal 6 中使用视图，答案是肯定的——有一些重要的警告。

与 Drupal 中的普通表单不同，视图的公开过滤器值以 $_GET 参数而不是 $_POST 的形式出现。这意味着您可以通过将 ?filter=value&filter2=value2 etc... 附加到当前 URL 来填充公开的过滤器。

更重要的是，如果同一页面上的多个视图在 URL 中查找相同的过滤器键，它们都将使用传入的过滤器值。您需要配置每个视图的公开过滤器列表，以确保它们都使用相同的过滤器列表，并为传入值使用相同的“键”列表。如果您希望过滤器表单只出现一次，您可能还需要进行一些巧妙的处理——默认情况下，视图会希望它出现在每个视图上，但是每个视图都有一个选项可以将其暴露的过滤器移动到一个块中; 这样做并且不启用暴露的过滤器块有效地隐藏了视图的暴露过滤器小部件，同时如果过滤器通过 URL 进入，则保持过滤器处于活动状态。

总结一下：确保所有四个视图都具有相同的公开过滤器列表，并且对过滤器使用相同的“键”。隐藏除一个视图之外的所有视图上暴露的过滤器小部件。到那时，它应该可以工作。

# delphi - IPv6 地址的算术运算（大整数）

> ID：697731
> 
> 赞同：4
> 
> 时间：2009-03-30T15:35:10.537
> 
> 标签：delphi, network-programming, math, int128

我正在使用以下形式的 IPv6 地址：

FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF

在内部，我将它们存储在一个数组中：

```
TIp6Bytes = array [0..15] of Byte; 
```

我需要以多种方式操作 IPv6 地址，包括加法、除法、乘法等。有人能提出一个好的方法吗？

我想我应该提到我正在使用 Delphi 2009

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-31T01:17:08.533

Jes Klinke 在[这里](http://users.cybercity.dk/~dko5442/bignum.pas)为 Pascal 编写了一个 bignum 单元。

免责声明：我个人没有使用过这个库。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-05T14:47:25.323

在尝试了许多建议后，我找不到一个可以满足我所有需求并且没有错误的库。我更加努力地搜索并找到了 Alex Ciobanu 的一个相对较新的库，它无缝地执行 BigIntegers（和 Big Cardinals），允许您以与操作普通整数、红雀等相同的方式操作它们。

除了 BigIntegers，该库还提供了许多非常有用的特性。从自述文件：

*   一组通用集合类（List、Dictionary、HashSet 等）。
*   日期/时间功能全部组合在几个结构中（某种程度上等同于 .NET 的 DateTime 结构）
*   类型支持概念，为每个内置的 Delphi 类型定义一组默认的“支持类”（用作集合中的默认值）。可以为您的自定义数据类型注册自定义“类型支持”类。
*   **BigCardinal 和 BigInteger 数据类型。**
*   Delphi中的智能指针

该库正在积极开发中。其实作者在一天之内就修复了我发现的一个小bug。

[您可以在Alex 的](http://alex.ciobanu.org/?page_id=162)博客上阅读有关该库的更多信息，并从[Google 代码](http://code.google.com/p/delphilhlplib/)下载 DeHL 。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-07-27T07:34:06.150

我曾经编写了一个[IPv4 和 IPv6 转换单元，](https://github.com/NLDelphi/NLDUtils/blob/main/IPTypes.pas)其中包括用于这两种 IP 地址类型的自定义变体类型。

例如，对于这些 Variant 类型，以下示例算术和转换是可能的：

```
procedure TForm1.Button1Click(Sender: TObject);
var
  I4: TIPv4;
  I6: TIPv6;
  V1, V2, V3, V4: Variant;
begin
  I4 := StrToIPv4('192.0.2.128');
  I6 := IPv4ToIPv6(I4);
  V1 := VarIPv6Create('2001:db8:85a3:0:0:8a2e:0370:7334');
  V2 := IPv6ToVar(I6);
  V3 := V1 - V2;
  V4 := V1 or V2;
  if V3 < V4 then
    Log(V3 + ' is smaller than ' + V4);
  if V2.Equals('::ffff:192.0.2.128') or V2.IsZero then
    Log('OK');
  Log('V1 = ' + V1.AsStringOutwritten);
  Log('V2 = ' + V2.AsURL);
  Log('V3 = ' + V3.AsStringCompressed);
  V4.Follow;
end;

procedure TForm1.Log(const S: String);
begin
  Memo.Lines.Add(S);
end; 
```

自定义变体类型确实非常强大。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T15:47:29.820

我想说，如果您可以加法，那么您可以使用它来使用加法进行减法、乘法和除法。我应该假设溢出将被简单地忽略吗？

我似乎记得一种使用 XOR 添加面向位变量的方法。我现在正在寻找那个答案。

希望这将为您指明正确的方向。如果我能找到那个 XOR 代码，我会为你发布它。

这里是： 按位运算 排他析取常用于按位运算。示例：1 xor 1 = 0 1 xor 0 = 1 1110 xor 1001 = 0111（这相当于没有进位的加法）

参考是： [http ://www.absoluteastronomy.com/topics/Exclusive_disjunction](http://www.absoluteastronomy.com/topics/Exclusive_disjunction)

# python - 以良好的形式将 XML 处理成 MySQL

> ID：697741
> 
> 赞同：0
> 
> 时间：2009-03-30T15:38:06.117
> 
> 标签：python, xml, xslt, parsing

我需要每天将不同格式的 XML 文档处理成 MySQL 数据库中的记录。我需要的每个 XML 文档中的数据都散布着大量我不需要的数据，而且每个文档的节点名称都不同。例如：

来源#1：

```
<object id="1">
    <title>URL 1</title>
    <url>http://www.one.com</url>
    <frequency interval="60" />
    <uselessdata>blah</uselessdata>
</object>
<object id="2">
    <title>URL 2</title>
    <url>http://www.two.com</url>
    <frequency interval="60" />
    <uselessdata>blah</uselessdata>
</object> 
```

来源#2：

```
<object">
    <objectid>1</objectid>
    <thetitle>URL 1</thetitle>
    <link>http://www.one.com</link>
    <frequency interval="60" />
   <moreuselessdata>blah</moreuselessdata>
</object>
<object">
    <objectid>2</objectid>
    <thetitle>URL 2</thetitle>
    <link>http://www.two.com</link>
    <frequency interval="60" />
    <moreuselessdata>blah</moreuselessdata>
</object> 
```

...我需要对象的 ID、间隔和 URL。

我对方法的想法是：

1.) 有一个单独的函数来解析每个 XML 文档并从该函数中迭代地创建 SQL 查询

2.）有一个单独的函数解析每个文档并迭代地将每个对象添加到我自己的对象类中，并通过类方法完成 SQL 工作

3.) 使用 XSLT 将所有文档转换为通用 XML 格式，然后为该文档编写解析器。

XML 文档本身并没有那么大，因为大多数都在 1MB 以下。我预计它们的结构不会经常变化（如果有的话），但随着时间的推移，我很有可能需要添加和删除更多来源。我对所有想法持开放态度。

另外，很抱歉，如果上面的 XML 示例被破坏了……它们并不是非常重要，只是一个粗略的想法，表明每个文档中的节点名称是不同的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T15:54:49.837

使用 XSLT 是多余的。我喜欢方法（2），它很有意义。

使用 Python，我会尝试为每种文档类型创建一个类。该类将从 dict 继承并在`__init__`解析给定文档时使用“id”、“interval”和“url”填充自身。

那么 main 中的代码将非常简单，只需使用适当的文档实例化这些类（也是 dicts）的实例，然后将它们作为普通 dicts 传递。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T15:55:56.667

我已经成功使用变体第三种方法。但我一直在处理的文件要大得多。如果它是一个矫枉过正与否，那真的取决于你对 XSLT 的流利程度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T16:46:54.937

如果您的各种输入格式是明确的，您可以这样做：

```
<xsl:template match="object">
  <object>
    <id><xsl:value-of select="@id | objectid" /></id>
    <title><xsl:value-of select="title | thetitle" /></title>
    <url><xsl:value-of select="url | link" /></url>
    <interval><xsl:value-of select="frequency/@interval" /></interval>
  </object>
</xsl:template> 
```

对于您的示例输入，这会产生：

```
<object>
  <id>1</id>
  <title>URL 1</title>
  <url>http://www.one.com</url>
  <interval>60</interval>
</object>
<object>
  <id>2</id>
  <title>URL 2</title>
  <url>http://www.two.com</url>
  <interval>60</interval>
</object>
<object>
  <id>1</id>
  <title>URL 1</title>
  <url>http://www.one.com</url>
  <interval>60</interval>
</object>
<object>
  <id>2</id>
  <title>URL 2</title>
  <url>http://www.two.com</url>
  <interval>60</interval>
</object> 
```

但是，可能有比使用 XSLT 更快的方法来获得可用的结果。只需衡量每种方法的速度有多快，以及对您的感觉有多“丑陋”。我倾向于说 XSLT 是处理 XML 的更优雅/可维护的解决方案。YMMV。

如果您的输入格式不明确并且上述解决方案产生错误的结果，则需要一种更明确的方法，如下所示：

```
<xsl:template match="object">
  <object>
    <xsl:choose>
      <xsl:when test="@id and title and url and frequency/@interval">
        <xsl:apply-templates select="." mode="format1" />
      </xsl:when>
      <xsl:when test="objectid and thetitle and link and frequency/@interval">
        <xsl:apply-templates select="." mode="format2" />
      </xsl:when>
    </xsl:choose>
  </object>
</xsl:template>

<xsl:template match="object" mode="format1">
  <id><xsl:value-of select="@id" /></id>
  <title><xsl:value-of select="title" /></title>
  <url><xsl:value-of select="url" /></url>
  <interval><xsl:value-of select="frequency/@interval" /></interval>
</xsl:template>

<xsl:template match="object" mode="format2">
  <id><xsl:value-of select="objectid" /></id>
  <title><xsl:value-of select="thetitle" /></title>
  <url><xsl:value-of select="link" /></url>
  <interval><xsl:value-of select="frequency/@interval" /></interval>
</xsl:template> 
```

# jquery - IE中的jQuery动画分层问题

> ID：697743
> 
> 赞同：0
> 
> 时间：2009-03-30T15:39:08.890
> 
> 标签：jquery, internet-explorer, jquery-animate

如果您将鼠标悬停在`<img>`“hiddenPanel”`<div>`上，就会出现。这在 FF 和其他浏览器中运行良好，但在 IE 中`<div>`出现在 'content' 后面`<div>`。我试过 z-indexing 无济于事。还有其他人有这个问题吗？

`<div>`（另外，出于布局原因，我不会在“内容”之后移动代码）

编辑：更多代码；jQuery / HTML / CSS ...

## jQuery

```
 /* Column Left #1 */      
    $('.columnLeft_spec1_panel').hide().css('opacity','0.0');
    $('.columnLeft_spec1').mouseover( function() { $('.columnLeft_spec1_panel').animate({ width: '337px', height: '234px', opacity: 1.0 }, 1250 ); });
    $('.columnLeft_spec1_panel').mouseout( function() { $('.columnLeft_spec1_panel').animate({ width: '1px', height: '1px', opacity: 0.0 }, 1250 ); }); 
```

## html

```
<div class="columnLeft">
  <img runat="server" src="~/images/pc_blocks_columnLeft_spec1.gif" class="columnLeft_spec1" alt="" />
  <a runat="server" href="~/" class="columnLeft_spec1_panel">&nbsp;</a>
  <img runat="server" src="~/images/pc_blocks_columnLeft_spec2.gif" class="columnLeft_spec2" alt="" />
  <a runat="server" href="~/" class="columnLeft_spec2_panel">&nbsp;</a>
</div>

<div class="columnRight">
  <img runat="server" src="~/images/pc_blocks_columnRight_spec1.gif" class="columnRight_spec1" alt="" />
  <a runat="server" href="~/" class="columnRight_spec1_panel">&nbsp;</a>
</div>

<asp:ContentPlaceHolder ID="main" runat="server"></asp:ContentPlaceHolder>

<div class="subnav">
  <asp:ContentPlaceHolder ID="subnav" runat="server"></asp:ContentPlaceHolder>
</div>

<div class="content">
  <div class="leftPanel">
    <asp:ContentPlaceHolder ID="leftPanel" runat="server"></asp:ContentPlaceHolder>
  </div>
  <div class="midPanel">
     <asp:ContentPlaceHolder ID="midPanel" runat="server"></asp:ContentPlaceHolder>
  </div>
  <div class="rightPanel">
    <asp:ContentPlaceHolder ID="rightPanel" runat="server"></asp:ContentPlaceHolder>
  </div>
</div> 
```

## CSS

```
 /* CONTENT
    ======================================================================*/
    .content {
      position:relative;
      height:auto; width:800px; _width:795px;
      margin:5px 5px 0px 90px; padding:20px 10px;
      min-height:250px; z-index:0;
      background:#FFF;
    }
    .leftPanel, .midPanel { float:left; }
    .rightPanel { float:left; }

    .content .leftPanel {
      height:auto; width:150px;
    }
    .content .midPanel {
      height:auto; width:375px;
      border-right:solid 1px #78A22F;
      padding:0px 30px 30px 30px;
    }
    .content .rightPanel {
      height:auto; width:180px;
      padding:0px 0px 0px 20px;
    }

    /* COLUMNS
    ======================================================================*/
    .columnLeft, .columnRight {
      height:245px; width:85px;
      background:#EEEEEE;
      margin-top:5px; position:relative;
    }
    .columnLeft {
      float:left; background:url(../images/pc_blocks_columnLeft.gif) no-repeat;
    }
    .columnLeft .columnLeft_spec1 {
      position:absolute;
      top:0px; right:0px;
    }
    .columnLeft .columnLeft_spec1_panel {
      display:none; background:url(../images/pc_columnLeft_spec1.jpg) no-repeat;
      position:absolute; z-index:5;
      left:0px;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T16:03:52.357

建议：检查你的CSS！有些事情在 FF 中运行良好，但在 IE 中您必须重做大部分事情，因为我们都知道 IE 在遵循 W3C 标准时是一个大问题。

这是我做的一个演示：

```
$(document).ready(function () 
    {
        $(".hoverMe").mouseover(function ()
        {
            $(".hiddenPanel").fadeIn('slow');
        }).mouseout(function ()
        {
            $(".hiddenPanel").fadeOut('slow');
        });
    }); 
```

这是html：

```
<img class="hoverMe" alt="HOVER ME" /> <div class="hiddenPanel" style="display: none; color: blue; font-size: 20px; font-weight: bold;">This is the hidden panel</div> 
    <div class="content" style="color: red;">
        Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s</div> 
```

您还可以试用上面的代码[演示](http://www.bogdanconstantinescu.com/jquery/ie-animate.html)，它可以按预期在 IE 中运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T15:53:14.333

内容 div 是否包含 Flash 文件？

如果是，那么你需要检查[这个问题](https://stackoverflow.com/questions/524838/why-is-my-flash-animation-overlaying-my-div-position)，它有你的解决方案。

如果您可以发布您的 jQuery 代码和您正在使用的 CSS，那将有很大帮助。

# iphone - iPhone/Safari：有没有办法在加载时停止调整页面大小？

> ID：697748
> 
> 赞同：5
> 
> 时间：2009-03-30T15:40:17.453
> 
> 标签：iphone, safari, resize

这是一个很长的镜头，但我希望有一种方法可以阻止 iPhone 在加载时调整页面大小。问题是，如果它是一个需要大量刷新的站点（比如一个论坛），那么用户每次刷新都必须调整该页面的大小会变得有点陈旧。

有没有办法强制 Safari/IPhnone 在不涉及用户更改设置的刷新时不最小化站点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-30T15:49:58.177

您可以使用一个元标记来限制 iPhone 的视口：

```
<meta name="viewport" content="width=320" /> 
```

来自 Apple 的开发者文档：

> 使用`viewport`元标记来改进您的 Web 内容在 iPhone 上的呈现。通常，您使用视口元标记来设置视口的宽度和初始比例。例如，如果您的网页小于 980 像素，那么您应该设置视口的宽度以适合您的 Web 内容。如果您正在设计一个特定于 iPhone 的 Web 应用程序，则将宽度设置为设备的宽度。

有一个常量可以用于 iPhone 的设备宽度：`width=device-width`.

不确定此链接是否有效，但您可以在[Apple Developer 网站上阅读有关 Mobile Safari 和 viewport 标签的更多信息](https://developer.apple.com/library/archive/documentation/AppleApplications/Reference/SafariWebContent/UsingtheViewport/UsingtheViewport.html)

# c++ - 是否可以拆分 SWIG 模块进行编译，但在链接时重新加入？

> ID：697749
> 
> 赞同：9
> 
> 时间：2009-03-30T15:40:18.980
> 
> 标签：c++, python, swig

大约两年前，当我第一次实现我们的 SWIG 绑定时，我遇到了这个问题。一旦我们暴露了大量代码，我们就到了 SWIG 会输出 C++ 文件的地步，编译器无法处理它们。我可以解决这个问题的唯一方法是将接口拆分为多个模块并分别编译它们。

这有几个缺点：

• 每个模块都必须了解其他模块的依赖关系。我有一个脚本来生成处理这方面的接口文件，但它增加了额外的复杂性。

• 每个附加模块都会增加动态链接器加载代码所需的时间。我添加了一个导入所有子模块的**init** .py 文件，这样代码被拆分的事实对用户来说是透明的，但始终可见的是加载时间长。

我目前正在审查我们的构建脚本/构建过程，我想看看我是否能找到比我现在更好的解决方案来解决这个问题。理想情况下，我将拥有一个包含所有包装代码的共享库。

有谁知道我如何使用 SWIG 实现这一目标？我已经看到了一些用 Ruby 为特定项目编写的自定义代码，其中的输出经过后处理以使其成为可能，但是当我查看 Python 包装器的可行性时，它看起来并不那么容易。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-01-11T13:40:45.343

我刚刚对 TCL 库做了等效的 hack：我使用了几个 SWIG 模块，生成了几个 .cpp 文件，这些文件在几个 .o 文件中编译，但将它们全部编译到一个 .so 文件中，该文件由单个 TCL“加载”命令加载。

这个想法是创建一个顶级 swig 模块（Top），它调用所有子模块（Sub1 和 Sub2）的初始化函数：

```
%module Top
%header %{
  extern "C" {
    SWIGEXPORT int Sub1_Init(Tcl_Interp *);
    SWIGEXPORT int Sub2_Init(Tcl_Interp *);
  }
%}
%init %{
    if (Sub1_Init(interp) != TCL_OK) {return TCL_ERROR;}
    if (Sub2_Init(interp) != TCL_OK) {return TCL_ERROR;}
%} 
```

子模块文件中没有什么特别之处。我最终得到了文件 Top.so，因此我使用命令“load ./Top.so”从 TCL 加载

我不知道python，但可能很相似。不过，您可能需要了解如何加载 python 扩展。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T16:59:19.493

如果正确拆分，模块不一定需要与其他模块具有相同的依赖关系——这只是编译所必需的。如果你适当地分解事物，你可以拥有没有循环依赖的库。使用多个库的问题在于，默认情况下，SWIG 静态声明其运行时代码，因此，将对象从一个模块传递到另一个模块时出现问题。您需要启用 SWIG 运行时代码的共享版本。

从文档（SWIG 网页文档链接已损坏）：

> 运行时函数对于每个 SWIG 生成的模块都是私有的。也就是说，运行时函数是用“静态”链接声明的，并且仅对该模块中定义的包装函数可见。这种方法的唯一问题是，当在同一个应用程序中使用多个 SWIG 模块时，这些模块通常需要共享类型信息。对于 SWIG 必须收集和共享有关跨模块边界的继承关系的信息的 C++ 程序尤其如此。

查看您下载的文档中的该部分（第 16.2 节 SWIG 运行时代码），它将为您提供有关如何启用此功能的详细信息，以便在从一个模块传递到另一个模块时可以正确处理对象。

FWIW，我没有使用过 Python SWIG，但做过 Tcl SWIG。

# parsing - ANTLR 中的树解析器是什么，我是否被迫编写一个？

> ID：697755
> 
> 赞同：6
> 
> 时间：2009-03-30T15:41:03.533
> 
> 标签：parsing, programming-languages, antlr, grammar

我正在为 ANTLR 中的一小部分 C 语言编写一个词法分析器/解析器，它将在 Java 环境中运行。我是语言语法领域的新手，在许多 ANTLR 教程中，他们创建了一个 AST - 抽象语法树，我是否被迫创建一个，为什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-30T16:00:43.113

使用 ANTLR 创建 AST 已包含在语法中。您不必这样做，但对于更复杂的要求，它是一个非常好的工具。这是您可以使用的树构造[教程](http://www.antlr.org/wiki/display/ANTLR3/Tree+construction)。

基本上，在解析源代码时使用 ANTLR，您有几个选择。您可以使用语法中的重写规则生成代码或 AST。[AST](http://en.wikipedia.org/wiki/Abstract_syntax_tree)基本上是源代码的内存表示。从那里，你可以做很多事情。

ANTLR 有很多东西。如果你还没有，我建议你买[这本书](http://www.pragprog.com/titles/tpantlr/the-definitive-antlr-reference)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-30T18:02:15.300

我在创建 ANTLR 的 Terence Parr 在 jGuru 上找到了[这个问题的答案。](http://www.jguru.com/faq/view.jsp?EID=818959)[我从这里](http://www.jguru.com/faq/view.jsp?EID=818959)链接的网站复制了这个解释：

只有简单的、所谓的语法导向翻译可以通过解析器中的操作来完成。这些类型的翻译只能吐出结构，这些结构是在解析中已经看到的信息的函数。树解析器允许您遍历中间形式并操作该树，在几个翻译阶段逐渐将其变形为最终形式，可以轻松地打印回新的翻译。

想象一个简单的翻译问题，您想打印一个标题为“有 n 个项目”的 html 页面，其中 n 是您在输入流中找到的标识符的数量。ids 必须打印在标题之后，如下所示：

```
<html>
<head>
<title>There are 3 items</title>
</head>
<body>
<ol>
<li>Dog</li>
<li>Cat</li>
<li>Velociraptor</li>
</body>
</html> 
```

从输入

```
Dog
Cat
Velociraptor 
```

那么，通过语法中的简单操作，如何计算标题？你不能不阅读整个输入。好的，现在我们知道我们需要一个中间形式。最好的通常是我发现的 AST，因为它记录了输入结构。在这种情况下，它只是一个列表，但它证明了我的观点。

好的，现在您知道除了简单的翻译之外，树对于任何事情都是一件好事。给定一个 AST，你如何从中获得输出？想象一下简单的表达式树。一种方法是使树中的节点成为特定类，如 PlusNode、IntegerNode 等。然后你只需要求每个节点打印出来。对于输入，3+4 你会有树：

+ | 3 -- 4

和班级

```
class PlusNode extends CommonAST {
  public String toString() {
    AST left = getFirstChild();
    AST right = left.getNextSibling();
    return left + " + " + right;
  }
}

class IntNode extends CommonAST {
  public String toString() {
    return getText();
  }
} 
```

给定一个表达式树，您可以使用 t.toString() 将其转换回文本。那么，这有什么问题？似乎工作得很好，对吧？它似乎在这种情况下运行良好，因为它很简单，但我认为，即使对于这个简单的示例，树语法也更具可读性，并且是对您在 PlusNode.toString() 中编码的内容的形式化描述。

```
expr returns [String r]
{
    String left=null, right=null;
}

: #("+" left=expr right=expr) {r=left + " + " + right;}
| i:INT                       {r=i.getText();}
; 
```

请注意，特定类（“异构 AST”）方法实际上在 toString() 中手动为 #(+ INT INT) 编码了一个完整的递归下降解析器。作为解析器生成器的人，这应该让你畏缩。;)

异构 AST 方法的主要缺点是它不能方便地访问上下文信息。在递归下降解析器中，您的上下文很容易访问，因为它可以作为参数传入。通过查看语法，您还可以准确地知道哪个规则可以调用哪个其他规则（例如，这个表达式是 WHILE 条件还是 IF 条件？）。上面的 PlusNode 类存在于一个分离的、孤立的世界中，它不知道谁会调用它的 toString() 方法。更糟糕的是，程序员无法通过读取它来判断它将在哪个上下文中被调用。

总之，向输入解析器添加操作适用于非常简单的翻译，其中：

1.  输出结构的顺序与输入顺序相同
2.  所有构造都可以从解析到需要吐出它们的信息中生成

除此之外，您还需要一个中间形式——AST 通常是最好的形式。使用语法来描述 AST 的结构类似于使用语法来解析输入文本。像 ANTLR 这样的领域特定高级语言的形式化描述比手动编码的解析器更好。树语法中的动作具有非常清晰的上下文，并且可以方便地访问从调用规则传递的信息。使用树语法来操作树进行多遍翻译的翻译也更容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T16:04:10.170

我认为**AST**的创建是可选的。[抽象语法树](http://en.wikipedia.org/wiki/Abstract_syntax_tree)对于解析程序的语义分析等后续处理很有用。

只有您可以决定是否需要创建一个。如果您的唯一目标是语法验证，那么您不需要生成一个。在[javacc](https://javacc.dev.java.net/)（类似于 ANTLR）中有一个名为[JJTree的](https://javacc.dev.java.net/doc/JJTree.html)*实用程序*，它允许生成 AST。所以我想这在 ANTLR 中也是可选的。

# internet-explorer - 如何从 Powershell 访问 Internet Explorer 运行实例的经典 Internet Explorer COM 自动化对象？

> ID：697759
> 
> 赞同：3
> 
> 时间：2009-03-30T15:43:29.067
> 
> 标签：internet-explorer, dom, com, powershell

如何访问 Internet Explorer 运行实例的经典 Internet Explorer COM 自动化对象？也就是说，如果我在多个窗口中打开 Internet Explorer，如何从 Powershell 中将对应于这些窗口之一的 COM 对象与 Powershell 中的变量相关联？我最接近的方法是通过 get-process 获取进程“iexplore”和“ieuser”。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-30T16:49:42.497

通常，要获得对现有对象上的 COM 接口的访问权限，您将使用运行对象表。不幸的是，Internet Explorer 不会将自己注册到运行对象表中——但是，这为我们提供了一些有用的 Google 搜索结果。

例如，谷歌搜索“运行对象表”“Internet Explorer”找到了我[如何连接到 Internet Explorer 的运行实例，](http://www.jose.it-berater.org/smfforum/index.php?topic=121.0%3Bwap2)该实例提供了一个（VBScript？）示例，演示了 ShellWindows 对象的使用。

将此示例快速“脏”（无错误检查！）转换为 PowerShell 脚本为我们提供：

```
$shellapp = New-Object -ComObject "Shell.Application"
$ShellWindows = $shellapp.Windows()
for ($i = 0; $i -lt $ShellWindows.Count; $i++)
{
  if ($ShellWindows.Item($i).FullName -like "*iexplore.exe")
  {
    $ie = $ShellWindows.Item($i)
    break
  }
}
$ie.navigate2("http://stackoverflow.com") 
```

# linux - GDB 远程调试错误

> ID：697763
> 
> 赞同：7
> 
> 时间：2009-03-30T15:44:13.060
> 
> 标签：linux, debugging, gdb, virtual-machine

我试图在 x86_64 suse linux 上远程调试一个 32 位应用程序，但得到这个“远程寄存器格式错误”的错误。

我启动 gdbserver 作为监听端口 12345 (gdbserver localhost:12345 my_prog)

这是错误：

```
$ gdb
GNU gdb 6.6
Copyright (C) 2006 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "x86_64-suse-linux".
(gdb) target remote <ip>:12345
Remote debugging using <ip>:12345
Remote register badly formatted: T0506:0000000000000000;07:80b8bcff00000000;10:4028f0f700000000;
here: 0000000;07:80b8bcff00000000;10:4028f0f700000000;
(gdb) 
```

这是调试服务器机器（uname -a）：

Linux 服务器 2.6.16.60-0.31-smp #1 SMP Tue Oct 7 16:16:29 UTC 2008 x86_64 x86_64 x86_64 GNU/Linux

这是调试客户端机器（uname -a）：

Linux 客户端 2.6.16.54-0.2.5-default #1 Mon Jan 21 13:29:51 UTC 2008 x86_64 x86_64 x86_64 GNU/Linux

两台机器都在虚拟机中运行（VMWare）。gdbserver 二进制文件从客户端机器复制到服务器机器。

（我远程调试是因为调试服务器上的运行时环境类似于生产环境，并且不包含任何开发工具、对源代码的访问等）

欢迎任何建议。

**更新：**通过在 gdb 中发出以下命令，这对我有用：

设置架构 i386:x86-64

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T16:38:36.780

也许您需要`set architecture i386`在`(gdb)`提示符下执行类似的操作？`show architecture`连接到远程目标后会说什么？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-04T22:03:12.103

一个 64 位的 GDB 可以直接调试 32 位和 64 位的劣质进程（我相信这叫做多架构支持）。

不是这样`gdbserver`：它不支持多架构调试。

您需要一个`gdbserver`与目标架构相匹配的，并且`gdb`与`gdbserver`. 从源代码构建它们，使用`--target=i686`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T17:15:06.210

也许你已经检查过了，但是这里有： - 在 64 位机器上，你有它的 32 位库（libc 等）吗？- 您是否尝试过使用“-nx”（无初始化文件）开关运行 gdb？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T22:17:49.933

1）您需要为您的目标机器和主机（适合您的情况下的目标机器的机器）提供合适的 gdbserver。

假设我想从 x86 主机调试 ppc 目标：

我的目标需要一个 ppc 可执行 gdbserver。

我的主机上需要一个用于 powerpc 的 x86 可执行 gdb。

设置完这些内容后，如果您使用共享库，则必须在连接到目标之前从主机 gdb 执行以下操作：

设置 solib-absolute-prefix $ELDK_PREFIX/eldk-4.2-ppc_4xx/$CROSS_COMPILE

目录 $ELDK_PREFIX/eldk-4.2-ppc_4xx/$CROSS_COMPILE

否则主机 gdb 会疯狂地尝试为 x86 加载共享库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-12-18T12:31:34.190

我认为您需要使用目标程序的副本在主机上运行 gdb。即，如果您`gdbserver myprog`在目标机器上运行，则需要复制`myprog`到主机并运行`gdb myprog`.

这样，主机上的 gdb 将自动从可执行文件中获取架构。像这样在主机上运行 gdb 也会加载符号，没有它你会得到未解析的符号（问号）。

# javascript - 纯 CSS 最小高度标题，绝对定位 DIV 中的最大高度主体

> ID：697767
> 
> 赞同：0
> 
> 时间：2009-03-30T15:45:57.190
> 
> 标签：javascript, html, css, css-tables

我有一个 HTML 编辑器小部件，我希望它出现在一个绝对定位、固定大小的 DIV 中。但是，我事先不知道 DIV 的绝对大小，它可能会发生变化，就像用户调整窗口大小一样。

编辑器自然具有控件和可编辑区域。每个都有自己的 DIV。我希望控件占用尽可能多的空间，并希望可编辑区域填充其余空间。

如果我使用表格，这非常容易实现。我只是关闭边框、填充和边距，然后将每个 DIV 放入自己行中的一个单元格中，并可能在控件 DIV 上摆弄 max-height 。这是它的样子：

[基表 http://img407.imageshack.us/img407/8435/table1.png](http://img407.imageshack.us/img407/8435/table1.png)

[带有窗口的同一张桌子以另一种方式调整大小 http://img264.imageshack.us/img264/6438/table2p.png](http://img264.imageshack.us/img264/6438/table2p.png)

请注意，可编辑部分占用了尽可能多的空间，而不会导致出现滚动条。

我已经对各种 CSS 示例进行了修改，如果没有在调整大小时运行一些 JavaScript 以使可编辑的 DIV 成为父级的高度减去控件的高度，似乎没有任何效果。

当然，我可以让父 DIV 具有 display:table，子 DIV 包含在 display:table-row DIV 中，并且它们本身具有 display:table-cell，但是......嗯......在这种情况下，它与使用 TABLE、TR 和 TD，但为了 CSS 纯度，丑陋十倍。（何苦？）

那么，不直接使用 display:table & friends，也不是 TABLE/TR/TD，也不是 JavaScript，有没有一种纯 CSS 的方式来做到这一点？换句话说，有没有一种纯 CSS 的说法，DIV1 占用尽可能少的垂直空间，DIV2 占用父元素内剩余的垂直空间？

如果没有，我已经准备好停止订阅“纯 CSS”的心态。在开发人员或最终用户几乎没有受益的情况下，这让我感到非常悲痛。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T16:02:01.737

这个问题说明了我最近看到很多人面临的一个问题：遵守“仅将表格用于表格数据”的规则，或者只使用表格并完成 1/3 的工作。这甚至是一个艰难的决定这一事实证明了我们都变得多么疯狂。忘记标准，使用表格，干脆利落地完成它。如果 W3C 对此有疑问，他们可以在创建更好的替代方案后立即投诉。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T18:18:21.083

你只有这么多选择。如果您想要在不使用表格的情况下进行类似表格的行为，请使用 display:table 并让自己选择稍后改变主意。这样，虽然标记（主观）更丑陋，但对我来说更有意义：您最终会得到更多元素，但不会被锁定在特定布局中。

如果您不关心标记，请扣动扳机并使用表格。这在短期内会更容易。

我的问题：如果您不想使用 JavaScript，您将如何实现编辑器控件？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T15:56:01.657

据我所知，使用百分比作为宽度/高度应该可以正常工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T16:41:10.380

我会第二次perfectDay的答案，但我会要求你发疯并尝试描述你希望它看起来像什么。也许使用 ascii-art 或图形链接，所以我们知道您希望我们帮助您实现什么布局。

我还要补充一点，我最近（再次）没有睡觉，所以......如果我错过了一个明显的超清晰描述你希望我们帮助你实现什么，你有我最诚挚的歉意。:)

# python - 抽象id3标签、m4a标签、flac标签之间的转换

> ID：697776
> 
> 赞同：14
> 
> 时间：2009-03-30T15:49:59.567
> 
> 标签：python, bash, mp3, m4a

我正在寻找一种在 python 或 bash 中易于使用的资源，例如，mp3 文件 X 和 m4a 文件 Y 并说“将 X 的标签复制到 Y”。

Python 的“诱变剂”模块通常非常适合处理标签，但没有跨越不同类型标签的“艺术家领域”的抽象概念；我想要一个处理所有繁琐位并知道字段名等价的库。对于并非所有标签系统都可以表达的东西，我可以接受信息丢失或最佳猜测。

（用例：我将无损文件编码为 mp3，然后使用 mp3 进行收听。每个月左右，我希望能够使用我对 mp3 所做的任何标签更改来更新“主”无损文件。我我厌倦了在格式之间的实现差异上踌躇不前。）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-30T22:04:09.823

我需要这个确切的东西，我也很快意识到诱变剂不是一个足够遥远的抽象来做这种事情。幸运的是，mutagen 的作者在他们的媒体播放器[QuodLibet](http://code.google.com/p/quodlibet/)中需要它。

我不得不深入研究 QuodLibet 的源代码以了解如何使用它，但是一旦我理解了它，我就编写了一个名为**sequitur**的实用程序，它旨在成为一个等效于**ExFalso**（QuodLibet 的标记组件）的命令行。它使用这种抽象机制并提供一些附加的抽象和功能。

如果您想查看源代码，[这里是最新 tarball 的链接](http://jeremycantrell.com/files/python-qlcli.tar.gz)。该包实际上是一组三个命令行脚本和一个用于与 QL 交互的模块。如果你想安装整个东西，你可以使用：

```
easy_install QLCLI 
```

关于 exfalso/quodlibet（以及随之而来的 sequitur）要记住的一件事是它们实际上正确地实现了音频元数据，这意味着所有标签都支持多个值（除非文件类型禁止它，但这样做的并不多）。所以，做类似的事情：

```
print qllib.AudioFile('foo.mp3')['artist'] 
```

不会输出单个字符串，但会输出字符串列表，例如：

```
[u'The First Artist', u'The Second Artist'] 
```

您可以使用它来复制标签的方式类似于：

```
import os.path
import qllib  # this is the module that comes with QLCLI

def update_tags(mp3_fn, flac_fn):
    mp3 = qllib.AudioFile(mp3_fn)
    flac = qllib.AudioFile(flac_fn)
    # you can iterate over the tag names
    # they will be the same for all file types
    for tag_name in mp3:
        flac[tag_name] = mp3[tag_name]
    flac.write()

mp3_filenames = ['foo.mp3', 'bar.mp3', 'baz.mp3']

for mp3_fn in mp3_filenames:
    flac_fn = os.path.splitext(mp3_fn)[0] + '.flac'
    if os.path.getmtime(mp3_fn) != os.path.getmtime(flac_fn):
        update_tags(mp3_fn, flac_fn) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-03T07:42:52.620

这是一些示例代码，我编写的一个脚本，用于使用 Quod Libet 的音乐格式类（不是诱变剂的！）在文件之间复制标签。要运行它，只需执行`copytags.py src1 dest1 src2 dest2 src3 dest3`，它会将 sec1 中的标签复制到 dest1（在删除 dest1 上的任何现有标签之后！），依此类推。请注意黑名单，您应该根据自己的喜好对其进行调整。黑名单不仅可以防止某些标签被复制，还可以防止它们在目标文件中被破坏。

需要明确的是，Quod Libet 的与格式无关的标记不是诱变剂的功能；它是在诱变剂*之上实现的。*因此，如果您想要与格式无关的标记，则需要使用`quodlibet.formats.MusicFile`来打开文件而不是`mutagen.File`.

现在可以在这里找到代码：[https ://github.com/DarwinAwardWinner/copytags](https://github.com/DarwinAwardWinner/copytags)

如果您还想同时进行转码，请使用：[https ://github.com/DarwinAwardWinner/transfercoder](https://github.com/DarwinAwardWinner/transfercoder)

对我来说一个关键的细节是 Quod Libet 的音乐格式类期望 QL 的配置被加载，因此`config.init`我的脚本中的行。没有它，我在加载或保存文件时会遇到各种错误。

我已经用“标准”标签和任意标签测试了这个脚本在 flac、ogg 和 mp3 之间进行复制。到目前为止，它运行良好。

至于我没有使用 QLLib 的*原因*，它对我不起作用。我怀疑它遇到了和我一样的配置相关错误，但是默默地忽略了它们，只是没有写标签。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-08-16T21:00:29.290

我有一个 bash 脚本可以做到这一点，[atwat-tagger](https://gist.github.com/1150146)。它支持 flac、mp3、ogg 和 mp4 文件。

```
usage: `atwat-tagger.sh inputfile.mp3 outputfile.ogg` 
```

我知道您的项目已经完成，但是通过搜索引擎找到此页面的人可能会发现它很有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T17:42:59.263

您可以编写一个简单的应用程序，将每种格式的每个标签名称映射到“抽象标签”类型，然后很容易从一种转换到另一种。您甚至不必知道所有可用的类型 - 只需知道您感兴趣的那些。

在我看来，这像是周末项目类型的时间投资，可能更少。玩得开心，我不介意看看你的实现，甚至使用它——如果你当然不介意发布它:-)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-11T21:38:10.393

还有tagpy，它似乎运作良好。

# iphone - iPhone 应用商店。客户提交问题

> ID：697777
> 
> 赞同：1
> 
> 时间：2009-03-30T15:50:18.147
> 
> 标签：iphone

我正在写一份申请，将由我的客户提交。我不想给他们我的源代码，我该怎么办？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-30T16:00:21.647

您只需要按照 iPhone Program Portal 上的[文档](http://developer.apple.com/iphone/download.action?path=/iphone/iphone_developer_program_user_guide/iphone_developer_program_user_guide__standard_program_v2.4.pdf)中的描述向他们提供二进制输出。然后，他们将这个二进制文件连同元数据一起上传到 iTunes Connect（该文档中也有详细说明）。

必须使用从程序门户获得的应用商店分发证书编译二进制文件。如果您的客户没有提供这些，那么您的申请将不被接受。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-07-08T10:57:45.543

转到 build/distribution-iphoneos/ 里面你有 .app 文件压缩它，压缩文件将被发送到客户端。

希望它可以帮助你。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-07-22T07:52:21.753

这些是在 Apple 分发许可证下构建 iPhone 应用程序并将其上传到 App Store 所需的以下步骤。

1.  在 Mac 机器中从**Keychain Access**创建**CSR 。**以Finder>>应用程序>>实用程序>>钥匙串访问访问钥匙串访问。在创建分发证书时上传此 CSR。 **Apple 许可证只能有一个 Apple 分发证书。**

*****   下载分发证书。打开钥匙串访问。以Finder>>应用程序>>实用程序>>钥匙串访问访问钥匙串访问。安装下载的分发证书。右键单击分发证书并选择**“导出证书”**并在目标库>>钥匙串中另存为个人交换证书 (.p12) 格式。

    *   对于每个**新应用程序**，我们需要在**一个 Apple 分发证书**下创建**新的配置文件。** 对于每个**新的 Provisioning Profile**，我们需要创建一个**新的 App Id。** 所以我们需要创建一个 Adhoc 和 Appstore 配置文件。

    *******   **Adhoc** Provisioning Profile 用于**在 Apple 设备中测试应用程序。** * *Appstore* * Provisioining Profile 用于**将应用程序上传到 appstore。** 下载相应的配置文件并双击配置文件进行安装。删除所有以前的配置文件，只**保留新安装的配置文件。**

    *   通过选择 Code Signing Entity 作为新安装的 Provisioning Profile 来构建应用程序。********** 

 ****6 将**ApplicationName.app.zip**文件作为二进制文件上传到**Application loader**中，同时将应用程序上传到 appstore。

参考：**https ://developer.apple.com**

我相信这会对你有所帮助。

# java - Spring MVC，从请求中生成表单支持对象？

> ID：697778
> 
> 赞同：5
> 
> 时间：2009-03-30T15:50:21.030
> 
> 标签：java, hibernate, spring-mvc

我正在使用 Spring MVC 2.5，并且试图从 GET 请求中加载一个 JSTL 表单对象。我有 Hibernate POJO 作为我的支持对象。

请求中有一个页面指向另一个具有类 ID（行主键）的页面。该请求看起来像“newpage.htm?name=RowId”。这将进入一个带有表单支持对象的页面，

上面的新页面将对象的字段加载到可编辑字段中，并填充了行的现有值。这个想法是，您应该能够编辑这些字段，然后将它们保存回数据库。

此页面的视图看起来像这样

```
<form:form commandName="thingie">
    <span>Name:</span>
    <span><form:input path="name" /></span>
    <br/>
    <span>Scheme:</span>
    <span><form:input path="scheme" /></span>
    <br/>
    <span>Url:</span>
    <span><form:input path="url" /></span>
    <br/>
    <span>Enabled:</span>
    <span><form:checkbox path="enabled"/></span>
    <br/>

    <input type="submit" value="Save Changes" />
</form:form> 
```

控制器里面有这个，

```
public class thingieDetailController extends SimpleFormController {

    public thingieDetailController() {    
        setCommandClass(Thingie.class);
        setCommandName("thingie");
    }

    @Override
    protected Object formBackingObject(HttpServletRequest request) throws Exception {
        Thingie thingieForm = (Thingie) super.formBackingObject(request);

        //This output is always null, as the ID is not being set properly
        logger.debug("thingieForm.getName(): [" + thingieForm.getName() + "]");
        //thingieForm.setName(request.getParameter("name"));
        SimpleDAO.loadThingie(thingieForm);

        return thingieForm;
    }

    @Override
    protected void doSubmitAction(Object command) throws Exception {            
        Thingie thingie = (Thingie) command;
        SimpleDAO.saveThingie(thingie);
    }
} 
```

正如您从注释代码中看到的那样，我尝试从请求中手动设置对象 ID（本例为名称）。然而，当我尝试将数据保存在表单中时，Hibernate 抱怨对象被不同步。

```
org.hibernate.StaleObjectStateException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect) 
```

这个错误似乎对整个会话有影响，它停止了对我的整个 Web 应用程序的工作，不断地抛出上面看到的过时对象状态异常。

如果熟悉 Spring MVC 的人可以帮助我或提出解决方法，我将不胜感激。

**编辑：**
会话工厂代码。

```
private static final SessionFactory sessionFactory;
private static final Configuration configuration = new Configuration().configure();

static {
    try {
        // Create the SessionFactory from standard (hibernate.cfg.xml) 
        // config file.
        sessionFactory = new AnnotationConfiguration().configure().buildSessionFactory();
    } catch (Throwable ex) {
        // Log the exception. 
        System.err.println("Initial SessionFactory creation failed." + ex);
        throw new ExceptionInInitializerError(ex);
    }
}

public static SessionFactory getSessionFactory() {
    return sessionFactory;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-08-17T16:39:47.213

使用 Spring MVC + hibernate 的主要缺陷之一是自然的方法是使用 hibernate 域对象作为表单的支持对象。Spring 将根据默认名称绑定请求中的任何内容。这无意中包含了诸如 ID 或名称（通常是主键）或其他正在设置的休眠托管属性之类的内容。这也使您容易受到形式注入。

为了在这种情况下安全，您必须使用以下内容：

```
protected void initBinder(HttpServletRequest request, ServletRequestDataBinder binder) 
throws Exception {
 String[] allowedFields = {"name", "birthday"}
 binder.setAllowedFields(allowedFields);
} 
```

并明确将允许的字段设置为仅表单中的字段，并排除主键，否则最终会一团糟！！！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-30T15:58:49.793

要回答您的直接问题，您遇到的 Hibernate 问题与以下事件序列有关：

1.  一个 Hibernate 会话在`formBackingObject`
2.  使用会话 A，您将 Thingie 对象加载到`formBackingObject`
3.  您返回 Thingie 对象作为结果`formBackingObject`
4.  当您返回 Thingie 对象时，会话 A 已关闭，但 Thingie 仍与其链接
5.  当`doSubmitAction`被调用时，支持对象的相同实例`Thingie`作为命令传递
6.  打开一个新的 Hibernate 会话（称为会话 B）
7.  您尝试使用会话 B 保存 Thingie 对象（最初使用会话 A 打开）

Hibernate 在这一点上对会话 A 一无所知，因为它已关闭，因此您会收到错误消息。好消息是你不应该那样做，正确的方法会完全绕过这个错误。

该`formBackingObject`方法用于在显示表单之前用数据填充表单的命令对象。根据您更新的问题，听起来您只是想显示一个填充了来自给定数据库行的信息的表单，并在提交表单时更新该数据库行。

看起来您已经有一个模型类供您记录；`Record`我将在此答案中称其为班级）。您还有该`Record`课程的 DAO，我将其称为`RecordDao`. 最后，您需要一个`UpdateRecordCommand`类作为您的支持对象。`UpdateRecordCommand`应该使用以下字段和 setter/getter 定义：

```
public class UpdateRecordCommand {
  // Row ID of the record we want to update
  private int rowId;
  // New name
  private int String name;
  // New scheme
  private int String scheme;
  // New URL
  private int String url;
  // New enabled flag
  private int boolean enabled;

  // Getters and setters left out for brevity
} 
```

然后使用以下代码定义您的表单：

```
<form:form commandName="update">
  <span>Name:</span>
  <span><form:input path="name" /></span><br/>
  <span>Scheme:</span>
  <span><form:input path="scheme" /></span><br/>
  <span>Url:</span>
  <span><form:input path="url" /></span><br/>
  <span>Enabled:</span>
  <span><form:checkbox path="enabled"/></span><br/>
  <form:hidden path="rowId"/>
  <input type="submit" value="Save Changes" />
</form:form> 
```

现在你定义了你的表单控制器，它将填充表单`formBackingObject`并处理更新请求`doSubmitAction`。

```
public class UpdateRecordController extends SimpleFormController {

  private RecordDao recordDao;

  // Setter and getter for recordDao left out for brevity

  public UpdateRecordController() {    
      setCommandClass(UpdateRecordCommand.class);
      setCommandName("update");
  }

  @Override
  protected Object formBackingObject(HttpServletRequest request)
      throws Exception {
    // Use one of Spring's utility classes to cleanly fetch the rowId
    int rowId = ServletRequestUtils.getIntParameter(request, "rowId");

    // Load the record based on the rowId paramrter, using your DAO
    Record record = recordDao.load(rowId);

    // Populate the update command with information from the record
    UpdateRecordCommand command = new UpdateRecordCommand();

    command.setRowId(rowId);
    command.setName(record.getName());
    command.setScheme(record.getScheme());
    command.setUrl(record.getUrl());
    command.setEnabled(record.getEnabled());

    // Returning this will pre-populate the form fields
    return command;
  }

  @Override
  protected void doSubmitAction(Object command) throws Exception {
    // Load the record based on the rowId in the update command
    UpdateRecordCommand update = (UpdateRecordCommand) command;
    Record record = recordDao.load(update.getRowId());

    // Update the object we loaded from the data store
    record.setName(update.getName());
    record.setScheme(update.getScheme());
    record.setUrl(update.getUrl());
    record.setEnabled(update.setEnaled());

    // Finally, persist the data using the DAO
    recordDao.save(record);
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T15:55:26.853

您的问题可能与分离的对象有关。因为您的 DAO 已在 Hibernate 会话之外进行了修改，所以您需要在保存之前将对象重新附加到 Hibernate 会话。您可以通过在使用 Merge() 或 update() 保存之前显式地将对象带入会话来执行此操作。对两者进行试验，并阅读这些操作的文档，因为它们会根据数据对象的结构产生不同的效果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T21:19:46.870

发生的事情是 ?name=rowId 以某种方式弄乱了表单帖子。一旦我将其更改为不反映对象中参数的名称，一切正常。无需更改 DAO 或控制器代码。

感谢大家的回答。它帮助我缩小了正在发生的事情的范围。

# wcf - 从 MS-SQL 读取 BLOBS 的自定义流 - 我应该如何处理连接？

> ID：697779
> 
> 赞同：0
> 
> 时间：2009-03-30T15:50:42.187
> 
> 标签：wcf, connection, stream

我有一个自定义流，我将它与 WCF 一起用于数据库中的大型 BLOB。它以块的形式读取数据。

处理流连接的最佳方法是什么？我应该在施工时打开它还是在每次读取卡盘时打开/关闭它？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T15:53:22.787

*   [大型 BLOB 和 UPDATETEXT (ADO.NET)](http://msdn.microsoft.com/en-us/library/3517w44b.aspx)
*   [流式处理 BLOB (ADO.NET)](http://msdn.microsoft.com/en-us/library/4f5s1we0.aspx)
*   [使用二进制大对象 (BLOB)](http://www.c-sharpcorner.com/UploadFile/Ashush/UsingBlobs03222008142343PM/UsingBlobs.aspx)
*   [大数据和流](http://msdn.microsoft.com/en-us/library/ms733742.aspx)式传输(WCF)

SQL Server 2008 中的 Filestream 会将文件保存在文件系统上，从而为您提供使用公共文件系统 API 的流式处理能力以及优于普通 BLOB 的性能。

从帖子 - 经验法则：

数据 > 256K - 考虑文件流
数据 < 256K - 继续使用 BLOB

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T16:05:44.817

我会将整个 blob 加载到内存流中，然后让 WCF 处理 Streaming 和 Chunking。您可以在 transportBindings 中启用流式传输，或查看使用 MTOM。

```
[ServiceContract]
public class ContentService
{
  [OperationContract]
  public Stream GetBlob(int id)
  {
    byte[] myBlob = GetBytesFromDatabase();
    return new MemoryStream(myBlob);
  }
} 
```

如果您使用 SQL Server 2008，请尝试将流直接发送到 WCF 客户端

```
[ServiceContract]
public class ContentService
{
  [OperationContract]
  public Stream GetBlob(int id)
  {
    return GetStreamFromDatabase(id);
  }
} 
```

[请参阅有关使用 WCF 流式传输消息的](http://msdn.microsoft.com/en-us/library/ms731913.aspx)链接

# actionscript-3 - 如何在 flex 3 中的 Label 或文本中使用删除线？

> ID：697785
> 
> 赞同：1
> 
> 时间：2009-03-30T15:52:55.097
> 
> 标签：actionscript-3, apache-flex, flex3

如何在 flex 3 中的 Label 或文本中使用删除线？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T05:37:03.160

我需要同样的东西，并最终在某种程度上简化了 mediagreenhouse 解决方案：

```
package
{
    import flash.text.TextLineMetrics;
    import mx.core.mx_internal;
    import mx.controls.Label;

use namespace mx_internal;

public class StrikeLabel extends Label
{

    public function StrikeLabel()
    {
        super();
    }

    override protected function updateDisplayList(unscaledWidth:Number, unscaledHeight:Number):void
    {
        super.updateDisplayList( unscaledWidth, unscaledHeight );

        if( textField )
        {
            var metrics : TextLineMetrics = textField.getLineMetrics( 0 );
            var y : int = ( metrics.ascent * 0.66 ) + 2;

            graphics.clear();
            graphics.lineStyle( 1, getStyle( "color" ), 1 );
            graphics.moveTo( 0, y );
            graphics.lineTo( metrics.width, y );
        }
    }
}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T16:00:03.490

您可以使用[Flex Gumbo SDK](http://opensource.adobe.com/wiki/display/flexsdk/Download+Flex+4/)[`TextGraphic`](http://livedocs.adobe.com/flex/gumbo/langref/mx/graphics/TextGraphic.html)中的一个（[在 Flex Builder 3 中使用 beta Gumbo SDK](http://blog.flexexamples.com/2008/08/02/using-the-beta-gumbo-sdk-in-flex-builder-3/)）。

[来源](http://blog.flexexamples.com/2008/10/24/creating-strikethrough-text-on-a-textgraphic-control-in-flex-gumbo/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-31T02:01:13.373

根据您的确切需要，您可能可以对标签进行子类化，覆盖 updateDisplayList，然后在文本中间画一条线。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T06:41:03.413

此处为Flex 3 示例：http: [//flexsnippets.mediagreenhouse.com/?p=46](http://flexsnippets.mediagreenhouse.com/?p=46)

# perl - 如何在 Perl 中限制 CGI 文件上传中的文件类型？

> ID：697789
> 
> 赞同：1
> 
> 时间：2009-03-30T15:54:04.580
> 
> 标签：perl, cgi, file-upload

我正在使用 CGI 来允许用户上传一些文件。我只是希望能够上传 .txt 或 .csv 文件。如果用户上传任何其他格式的文件，那么我希望能够发出错误消息。

我看到这可以通过javascript完成：http: [//www.codestore.net/store.nsf/unid/DOMM-4Q8H9E](http://www.codestore.net/store.nsf/unid/DOMM-4Q8H9E)

但是有没有更好的方法来实现这一点？Perl 中是否有一些功能允许这样做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-30T16:01:00.677

您链接到的网站上的免责声明很重要：

> 注意：这并不完全是万无一失的，因为人们可以在上传文件之前轻松更改文件的扩展名，或者做一些其他的诡计，例如“LoveBug”病毒。

如果你真的想这样做，让用户上传文件，然后使用[File::MimeInfo::Magic](http://search.cpan.org/perldoc?File::MimeInfo::Magic)（或`file(1)`UNIX 实用程序）之类的东西来猜测实际的文件类型。如果您不喜欢该文件类型，请删除该文件并向用户显示错误消息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-30T17:47:19.207

> 我只是希望能够上传 .txt 或 .csv 文件。

听起来很容易，不是吗？它不是。然后还有一些。

简单的方法是在将文件存储到文件系统之前测试文件是否以“.txt”或“.csv”结尾。在您让用户提交的文件名靠近文件系统的任何位置之前，这应该是对文件名允许包含的内容进行更深入验证的一部分。

因为在某些平台（尤其是 Windows）上，关于文件名中可以​​包含什么内容的规则很复杂，所以通常最好使用已知良好的名称和扩展名独立创建自己的文件名。

在任何情况下，都不能保证浏览器会向您发送一个具有可用名称的文件，即使确实如此，也不能保证该名称的末尾会有“.txt”或“.csv”，即使它是文本或 CSV 文件。（某些平台根本不使用扩展名进行文件输入。）

虽然您可以尝试嗅探文件的内容以查看它可能是什么类型，但这是非常不可靠的。例如：

```
<html>,<body>,</body>,</html> 
```

可以是纯文本、CSV、HTML、XML 或各种其他格式。最好让用户明确控制他们正在上传的文件类型（或每种类型使用一个文件上传字段）。

现在这里是它变得非常讨厌的地方。假设您已接受上传并将其存储为 /data/mygoodfilename.txt，并且 Web 服务器正确地将其作为 Content-Type 'text/plain' 提供。您认为浏览器将其解释为什么？纯文本？你应该很幸运。

问题是浏览器（主要是 IE）不信任您的 Content-Type 标头，而是嗅探文件的内容以查看它是否看起来像其他东西。将上述代码片段作为纯文本提供，IE 会很乐意将其视为 HTML。这可能是一个大问题，因为 HTML 可以包含将接管用户对站点的访问的客户端脚本（跨站点脚本攻击）。

此时，您可能很想在服务器端嗅探文件，例如使用“文件”命令来检查它不包含“<html>”。但这注定要失败。'file' 命令不会像 IE 那样嗅探所有相同的 HTML 标签，并且其他浏览器无论如何都会以不同的方式嗅探。准备一个“文件”声称不是 HTML 的文件非常容易，但 IE 仍会将其视为它（具有安全灾难影响）。

**诸如“文件”之类的内容嗅探方法只会给您一种错误的安全感。**这是用于松散猜测文件类型的便利工具，而*不是*有效的安全措施。

在这一点上，你最后绝望的可能性是：

*   从单独的主机名提供所有用户上传的文件，以便脚本注入攻击无法窃取您的主站点的凭据；

*   通过 CGI 包装器提供所有用户上传的文件，添加标题“Content-Disposition：附件”，以便浏览器不会尝试直接显示它们；

*   只接受来自受信任用户的上传。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-30T23:22:16.810

在 unix 上，最简单的方法是建议使用 JRockway。如果不在 unix 上，那么您的选择是有限的。您可以检查文件扩展名并检查内容以进行验证。我假设您只需要“* 分隔值”文本文件的特定情况。因此，其中一个 Text::CSV::* 模块可能有助于验证文件是您要求的类型。

此操作的安全性是另一个蜡球。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T00:52:28.903

***尝试这个：***

```
$file_name = "file.txt";

$file_cmd  = "file \"$file_name"\";

$file_type = `$file_cmd`;

return 0 unless($file_type =~ /(ASCII|text)/i) 
```

# wpf - 绑定到 UserControl 中声明的 Storyboard 的属性

> ID：697793
> 
> 赞同：0
> 
> 时间：2009-03-30T15:54:47.387
> 
> 标签：wpf, binding, storyboard

我正在努力解决仅在窗口资源区域内声明时才有效的绑定。一旦我将声明移动到 UserControl 的资源区域，绑定就会失败。没有错误消息，但是当滑块（源）的值更改时，值不会更新。我想在 UserControl 的 VSM 状态之一中使用情节提要。

有人可以告诉我为什么会发生这种情况，并希望如何解决它？

我尝试在此处粘贴我的 xaml，但该网站没有接缝以允许消息中的 xml 标签。

问候

雅科

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-30T22:44:03.533

仅设置 Storyboard.TargetProperty（而不是 .Target 或 .TargetName）并将情节提要指向代码中的对象：

```
Dim SB as Storyboard = Me.FindResource("Storyboard_name_goes_here")
TargetObject.BeginStoryboard(SB, HandoffBehavior.Compose) 
```

希望这可以帮助...

# internationalization - 服务器或浏览器中的国际化

> ID：697796
> 
> 赞同：1
> 
> 时间：2009-03-30T15:55:21.520
> 
> 标签：internationalization, ria

您将如何使用 i18ning 丰富的 Web 应用程序？

你会在服务器或浏览器中国际化。您对此有何经验？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T15:57:16.257

在服务器端执行此操作，否则（除其他外）您的网站不会向搜索引擎显示国际化。这将使国际用户很难找到您的网站。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T15:58:54.367

您想在服务器端处理它。浏览器无法更改处理国际化最终需要执行的编码类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T17:55:04.617

> 你会在服务器或浏览器中国际化。

是的。

当然，您需要在服务器端工作。如果您有创建用户可见文本的客户端 JavaScript，您还需要对其进行本地化，这通常是一项单独的任务。例如。让服务器端编写一个 <script src> 指向不同的脚本文件，具体取决于语言，该脚本包含文本字符串的查找，然后可以由逻辑脚本查阅。

# c# - 在 OpenCV 中不使用 CvSaveImage 将 IplImage 转换为 JPEG

> ID：697801
> 
> 赞同：3
> 
> 时间：2009-03-30T15:56:08.210
> 
> 标签：c#, image-processing, opencv

我希望将 IplImage 转换为内存中的 JPEG 图像（以便将其作为 M-JPEG 帧通过套接字流式传输）。我知道我可以为此使用 CvSaveImage，它创建一个 jpeg 文件，我再次读取它，然后通过网络传输它。我希望避免这种额外的磁盘读写操作以加快操作。有什么见解吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-03T18:49:57.023

看看[这个问题](https://stackoverflow.com/questions/801199/opencv-to-use-in-memory-buffers-or-file-pointers)。我不确定如何在 C# 中使用该解决方案，但也许它可以提供帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-10T16:05:56.207

如果您的标签是正确的并且这是在 C# 中，那么您应该查看 OpenCVSharp。

[http://code.google.com/p/opencvsharp/](http://code.google.com/p/opencvsharp/)

有了它你可以做...

```
IplImage ipl = new IplImage("foo.png", LoadMode.Color);
Bitmap bitmap = ipl.ToBitmap(); 
```

我还发现了一个使用 VC++.NET 的例子

```
//IplImage -> Bitmap
void Fill_Bitmap(Bitmap* bitmap, IplImage* image){
    int nl= image->height;
    int nc= image->width * image->nChannels;
    int step= image->widthStep;
    unsigned char* data=reinterpret_cast<unsigned char*>(image->imageData);
    for(int i=0; i<nl; i++){
        for(int j=0; j<nc; j+= image->nChannels){
            bitmap->SetPixel(j/3,i,Color::FromArgb(data[j],data[j+1],data[j+2]));
        }
        data+= step;
    }

};

Assume that in your main function:

void main(){
    ...
    imRGB=cvCreateImage( cvSize(col,row), 8, 3 );
    Tbitmap=new Bitmap(col,row,PixelFormat::Format24bppRgb);
    ...
    Fill_Bitmap(Tbitmap,imRGB);
} 
```

祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-25T04:58:14.490

很简单

从内存缓冲区加载文件所需的只是一个不同的 src 管理器 (libjpeg)。我在 Ubuntu 8.10 中测试了以下代码。

```
/******************************** First define mem buffer function bodies **************/
/*
 * memsrc.c
 *
 * Copyright (C) 1994-1996, Thomas G. Lane.
 * This file is part of the Independent JPEG Group's software.
 * For conditions of distribution and use, see the accompanying README file.
 *
 * This file contains decompression data source routines for the case of
 * reading JPEG data from a memory buffer that is preloaded with the entire
 * JPEG file.  This would not seem especially useful at first sight, but
 * a number of people have asked for it.
 * This is really just a stripped-down version of jdatasrc.c.  Comparison
 * of this code with jdatasrc.c may be helpful in seeing how to make
 * custom source managers for other purposes.
 */

/* this is not a core library module, so it doesn't define JPEG_INTERNALS */
include "jinclude.h"
include "jpeglib.h"
include "jerror.h"

/* Expanded data source object for memory input */

typedef struct {
  struct jpeg_source_mgr pub;   /* public fields */

  JOCTET eoi_buffer[2];     /* a place to put a dummy EOI */
} my_source_mgr;

typedef my_source_mgr * my_src_ptr;

/*
 * Initialize source --- called by jpeg_read_header
 * before any data is actually read.
 */

METHODDEF(void)
init_source (j_decompress_ptr cinfo)
{
  /* No work, since jpeg_memory_src set up the buffer pointer and count.
   * Indeed, if we want to read multiple JPEG images from one buffer,
   * this *must* not do anything to the pointer.
   */
}

/*
 * Fill the input buffer --- called whenever buffer is emptied.
 *
 * In this application, this routine should never be called; if it is called,
 * the decompressor has overrun the end of the input buffer, implying we
 * supplied an incomplete or corrupt JPEG datastream.  A simple error exit
 * might be the most appropriate response.
 *
 * But what we choose to do in this code is to supply dummy EOI markers
 * in order to force the decompressor to finish processing and supply
 * some sort of output image, no matter how corrupted.
 */

METHODDEF(boolean)
fill_input_buffer (j_decompress_ptr cinfo)
{
  my_src_ptr src = (my_src_ptr) cinfo->src;

  WARNMS(cinfo, JWRN_JPEG_EOF);

  /* Create a fake EOI marker */
  src->eoi_buffer[0] = (JOCTET) 0xFF;
  src->eoi_buffer[1] = (JOCTET) JPEG_EOI;
  src->pub.next_input_byte = src->eoi_buffer;
  src->pub.bytes_in_buffer = 2;

  return TRUE;
}

/*
 * Skip data --- used to skip over a potentially large amount of
 * uninteresting data (such as an APPn marker).
 *
 * If we overrun the end of the buffer, we let fill_input_buffer deal with
 * it.  An extremely large skip could cause some time-wasting here, but
 * it really isn't supposed to happen ... and the decompressor will never
 * skip more than 64K anyway.
 */

METHODDEF(void)
skip_input_data (j_decompress_ptr cinfo, long num_bytes)
{
  my_src_ptr src = (my_src_ptr) cinfo->src;

  if (num_bytes > 0) {
    while (num_bytes > (long) src->pub.bytes_in_buffer) {
      num_bytes -= (long) src->pub.bytes_in_buffer;
      (void) fill_input_buffer(cinfo);
      /* note we assume that fill_input_buffer will never return FALSE,
       * so suspension need not be handled.
       */
    }
    src->pub.next_input_byte += (size_t) num_bytes;
    src->pub.bytes_in_buffer -= (size_t) num_bytes;
  }
}

/*
 * An additional method that can be provided by data source modules is the
 * resync_to_restart method for error recovery in the presence of RST markers.
 * For the moment, this source module just uses the default resync method
 * provided by the JPEG library.  That method assumes that no backtracking
 * is possible.
 */

/*
 * Terminate source --- called by jpeg_finish_decompress
 * after all data has been read.  Often a no-op.
 *
 * NB: *not* called by jpeg_abort or jpeg_destroy; surrounding
 * application must deal with any cleanup that should happen even
 * for error exit.
 */

METHODDEF(void)
term_source (j_decompress_ptr cinfo)
{
  /* no work necessary here */
}

/*
 * Prepare for input from a memory buffer.
 */

GLOBAL(void)
jpeg_memory_src (j_decompress_ptr cinfo, const JOCTET * buffer, size_t bufsize)
{
  my_src_ptr src;

  /* The source object is made permanent so that a series of JPEG images
   * can be read from a single buffer by calling jpeg_memory_src
   * only before the first one.
   * This makes it unsafe to use this manager and a different source
   * manager serially with the same JPEG object.  Caveat programmer.
   */
  if (cinfo->src == NULL) { /* first time for this JPEG object? */
    cinfo->src = (struct jpeg_source_mgr *)
      (*cinfo->mem->alloc_small) ((j_common_ptr) cinfo, JPOOL_PERMANENT,
                  SIZEOF(my_source_mgr));
  }

  src = (my_src_ptr) cinfo->src;
  src->pub.init_source = init_source;
  src->pub.fill_input_buffer = fill_input_buffer;
  src->pub.skip_input_data = skip_input_data;
  src->pub.resync_to_restart = jpeg_resync_to_restart; /* use default method */
  src->pub.term_source = term_source;

  src->pub.next_input_byte = buffer;
  src->pub.bytes_in_buffer = bufsize;
} 
```

那么用法就很简单了。您可能需要将 SIZEOF() 替换为 sizeof()。找一个标准的解压例子。只需将“jpeg_stdio_src”替换为“jpeg_memory_src”即可。希望有帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-28T16:16:44.697

使用 CxImage [http://www.codeproject.com/KB/graphics/cximage.aspx](http://www.codeproject.com/KB/graphics/cximage.aspx)

# php - 优化 LAMP 网站以提高速度的最佳实践？

> ID：697802
> 
> 赞同：21
> 
> 时间：2009-03-30T15:56:22.920
> 
> 标签：php, mysql, optimization, lamp

我想知道在 LAMP 堆栈上构建典型站点时，如何优化它以获得最佳加载时间。我正在描绘一个典型的数据库驱动站点。

这是一个高级外观，可能会引起问题，让我将其分解为堆栈的每一层。

L - 在系统级别，（设置和文件系统）你可以做些什么来提高速度？我能想到的一件事是图像大小，这里的压缩可以帮助优化任何东西吗？

A - Web 服务器中必须有大量与站点速度相关的设置。不是我的强项。可能很大程度上取决于同时运行的站点数量。

M - MySQL 在数据库驱动的站点中，数据库性能是关键。是否有更好的规范化方法，即使用链接表？Web 开发人员通常只制作类似于 1NF 的简单单片表，这会影响性能。

P - 除了像缓存这样的性能提升设置，程序员可以做些什么来影响高水平的性能？我真的很想知道 MVC 设计方法是否比快速而肮脏的方法更能提高性能。其他简单的技巧，比如会话比 cookie 更快，会很有趣。

显然，你必须深入了解细节，找出让你慢下来的代码。我也意识到许多站点具有许多不同的性能特征，但是让我们假设一个典型的站点具有更多的读取然后写入。

我只是想知道我们是否可以汇编一堆最佳实践并完全期望人们将其他问题联系起来，以便我们可以有效地制定一份清单。

我的目标是看看除了性能方面的常见问题之外，我们是否还能看到一些你可能不会想到的奇怪事情，以及最佳实践总结。

所以我的问题是，如果您从头开始，您将如何*确保*您的 LAMP 站点快速运行？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-03-30T17:37:39.963

以下是我在 LAMP 应用程序中经常设置的一些个人必做事项。

*   为 apache 安装 mod_deflate，不要使用 PHP 的 gzip 处理程序。mod_deflate 将允许您压缩静态内容，如 javascript/css/static html，以及通常的动态 PHP 输出，这是您在代码中不必担心的一件事。

*   小心 .htaccess 文件！为应用程序中的目录启用 .htaccess 文件意味着 Apache 必须不断扫描文件系统，寻找 .htaccess 指令。将指令放在主配置或虚拟主机配置中要好得多，它们会在其中加载一次。任何时候您都可以通过将目录级访问文件移动到主配置文件中来摆脱它，从而节省磁盘访问时间。

*   准备应用程序的数据库层以使用某种连接管理器（我对大多数应用程序使用单例）。这并不难做到，减少应用程序打开的数据库连接数可以节省资源。

*   如果您认为您的应用程序会看到大量负载，那么 memcached 可以创造奇迹。在编写代码时请记住这一点……也许有一天，您将从 memcached 中获取它们，而不是动态创建对象。一点远见将使实施变得轻松。

*   一旦您的应用程序启动并运行，请将 MySQL 的慢查询时间设置为一个较小的数字，并认真监控慢查询日志。这将向您显示问题查询的来源，并允许您在查询和索引成为问题之前对其进行优化。

*   对于认真的性能调整者，您将需要从源代码编译 PHP。从包安装会安装许多您可能永远不会使用的库。由于 PHP 环境被加载到 Apache 线程的每个实例中，当存在 50 个 Apache 线程时，即使来自额外库的 5MB 内存开销也会很快变成 250MB 的内存丢失。我保留了我在[此处](http://www.phpvs.net/articles/blakes-centos-lamp-server-guide/php/#Install-PHP)构建 PHP 时使用的标准 ./configure 行的列表，我发现它适合我的大多数应用程序。缺点是如果你最终需要一个库，你必须重新编译 PHP 才能得到它。分析您的代码并在开发环境中对其进行测试，以确保您拥有所需的一切。

*   缩小你的 Javascript。

*   准备将静态内容（例如图像和视频）移动到非动态 Web 服务器。编写代码，以便将来轻松配置图像和视频的任何 URL 以指向另一台服务器。针对静态内容优化的 Web 服务器可以轻松地提供比动态内容服务器快数十甚至数百倍的服务。

这就是我能想到的。谷歌搜索 PHP 最佳实践会发现很多关于如何编写更快/更好的代码的技巧（例如：`echo`比 更快`print`）。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-30T19:07:03.523

首先，要认识到绩效是一个迭代的过程。您不会一次构建 Web 应用程序，启动它，然后再也不使用它。相反，您从小处着手，并随着站点的增长解决性能问题。

现在，到细节：

1.  轮廓。确定您的瓶颈。这是最重要的一步。您需要将精力集中在获得最佳结果的地方。您应该有某种监控解决方案（如 cacti 或 munin），让您了解服务器上发生的事情
2.  缓存，缓存，缓存。您可能会发现数据库访问是您在后端的最大瓶颈——但您应该自己验证这一点。幸运的是，您可能会发现您的大量流量是针对一小部分资源的。您可以将这些资源缓存在 memcached 之类的东西中，从而为自己节省数据库命中，并提高后端性能。
3.  正如其他人在上面提到的，请查看 YDN 性能规则。考虑拿起[随附的书](http://oreilly.com/catalog/9780596529307/)。这将帮助您提高前端性能
4.  安装[PHP APC](http://php.net/apc)，并确保它配置了足够的内存来保存所有编译的 PHP 字节码。我们最近发现我们的 APC 安装没有足够的内存；给它足够的工作将我们的 CPU 时间减少一半，磁盘活动减少 10%
5.  确保您的数据库表已正确索引。这与监控慢查询日志密切相关。

以上将使您走得很远。也就是说，如果您已经完成了上述操作，即使是一个相当重的 db 站点也应该能够在单个规格适中的服务器上的首页 digg 中存活下来。

您最终会遇到默认 apache 配置无法始终跟上传入请求的情况。当你碰到这堵墙时，有两件事要做：

1.  如上，简介。监控您的 apache 活动——您应该知道在任何给定时间有多少活动连接，以及当您突然流量激增时活动连接的最大数量
2.  考虑到这一点来配置 apache。这是我见过的最好的 apache 配置指南：[Practical mod_perl 第 11 章](http://modperlbook.org/html/Chapter-11-Tuning-Performance-by-Tweaking-Apache-s-Configur.html)
3.  尽可能多地减轻 apache 的负担。Apache 过于繁重，无法有效地提供静态内容。您应该使用更轻量级的反向代理（如 squid）或网络服务器（lighttpd 或 nginx）来提供静态内容，并接管将字节喂给慢速客户端的工作。这让 Apache 做它最擅长的事情：执行你的代码。同样，mod_perl 的书很好地[解释了这一点](http://modperlbook.org/html/12-5-Adding-a-Proxy-Server-in-httpd-Accelerator-Mode.html)。

一旦你走到这一步，这主要是一个缓存更多的问题，并密切关注你的数据库。最终，您将超出单个服务器。首先，您可能会添加更多前端盒，所有这些都由单个数据库服务器提供支持。然后你将不得不开始分散你的数据库负载，可能是通过分片。有关此增长过程的出色概述，请参阅[此实时日志演示](http://www.slideshare.net/vishnu/livejournals-backend-a-history-of-scaling)

要更深入地了解上述大部分内容，请查看Flickr 成名的 Cal Henderson 的[Building Scalable Web Sites 。](http://oreilly.com/catalog/9780596102357/)谷歌有[部分图书可供试阅](http://books.google.com/books?id=gXmatd2suh4C&pg=PA235&dq=0596102356&ei=5xfRScSqG4fqkwTy9_ihAQ)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-30T16:40:17.353

我已经使用[MysqlTuner](http://wiki.mysqltuner.com/MySQLTuner)对我的 mysql 服务器进行性能分析，它对谷歌搜索的进一步问题提供了很好的洞察力，并提出了自己的建议

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-30T16:50:04.070

您可能会发现有用的资源是[YDN 性能规则集](http://developer.yahoo.com/performance/rules.html)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-30T16:55:40.017

不要忘记您的用户将远离您的服务器数千英里，并下载数十个文件以呈现单个页面的事实。这种延迟以及在浏览器中呈现页面的开销可能大于您收集信息和生成页面所花费的时间。

请参阅 Yahoo Developer Network 上有关[加快网站速度的最佳实践](http://developer.yahoo.com/performance/rules.html)的页面，以及[YSlow 工具](http://developer.yahoo.com/yslow/)以了解网站下载的哪些部分需要时间。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-30T19:05:19.940

不要忘记为您的文件系统关闭 atime！

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-12-09T13:37:25.923

我建议使用[Jet Profiler for MySQL](http://www.jetprofiler.com/)来查找任何错误查询。我已经在我的几个网站上成功地使用了它。真的很有帮助，而且比慢查询日志更容易消化。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-30T16:06:52.067

我建议从[http://highscalability.com/开始](http://highscalability.com/)

至于你的建议：

压缩图像，绝对没有。文件系统调整的类型，是的，这可能会产生一些影响，但影响很小。但实际上最好是使用内存反向代理，甚至更好的 CDN。

对于 Apache，基本上只加载您需要的模块。不要加载其他任何东西。与 PHP 一样，您只能使用分叉 MPM，重要的是要保持苗条。至于最佳设置，您必须针对特定应用程序、硬件等进行微调。如果您有足够的 CPU，建议您使用 mod_deflate。服务器可以更快地向客户端发送数据，它可以更快地开始处理下一个请求。

# tomcat - 何时为直接 Tomcat 放弃 Java EE 容器（即 JBoss）

> ID：697805
> 
> 赞同：2
> 
> 时间：2009-03-30T15:57:41.450
> 
> 标签：tomcat, jboss

目前我们部署到 JBoss 4.2，因为这是部署在我们集群上的应用服务器。该应用程序目前仅通过 JNDI 和 JBossWeb 的嵌入式 Tomcat 和几个 JBoss 的 Tomcat 阀（特别是 RewriteValve，我们自己做起来不难）使用 JBoss 的连接池处理。

JBoss 对我来说似乎有点矫枉过正，我们应该切换到直接的 Tomcat 还是继续使用 JBoss 有什么好处？Tomcat 与 Eclipse 的集成是否更好？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-30T16:09:04.840

如果您不使用 JBoss 的任何高级功能并且您不打算使用，那么使用纯嵌入式 Tomcat 可能会更好。这样，如果在 Tomcat 中找到安全修复程序，您可以只升级一个嵌入式组件并继续前进。JBoss 明显更大，因此更难升级。

如果您在 JBoss 中使用的只是 JMS 或 JNDI 或其他可以作为单独的 3rd 方组件轻松嵌入到 Tomcat 中的东西，那么请务必放弃 JBoss 并仅迁移到嵌入式 Tomcat。

什么时候应该坚持使用 JBoss？使用 JBoss 让您的生活变得如此轻松，升级 JBoss 的额外工作是值得的。这对很多人来说都是正确的。听起来您的情况并非如此。

就与 Eclipse 更好地集成而言，我希望两者都能与 Eclipse 很好地集成。我使用 MyEclipse，它同时支持 JBoss 和 Tomcat。所以这可能取决于 Eclipse 的版本和您使用的插件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T05:12:42.240

如果您只需要 JMS，并且如果您不需要应用程序服务器管理的事务提供程序来处理不仅仅是 JDBC 的事务（例如跨越 JMS + JDBC 的事务），我会选择 Tomcat 或 Jetty。

虽然您可以在 JBoss 之类的应用程序服务器之外执行 JTA 和 JMS，但我尝试让 JTA 在 Tomcat 下跨越 JMS 和 JDBC 的经历非常复杂。也许它是 ActiveMQ 的早期版本，但它确实在一个非常重要的项目中占用了数月时间。对于像 JBoss 这样的 Java EE 服务器提供的基础架构，特别是有一些话要说。当您确实需要带有 XADataSources 的 JTA 时。试图用独立组件重新创建它是令人困惑的。

顺便说一句，如果你有选择的话，我会考虑 Jetty 而不是 Tomcat。

至于 Tomcat 和 Eclipse 的集成，这里有很多选择。我使用（有点自定义）插件调用 Sysdeo Tomcat Plugin for Eclipse。标准方法是使用 WTP 之类的东西。我使用 Sysdeo Tomcat 插件，因为它的开销似乎最低。另一种选择是只使用 Jetty Eclipse 插件——同样，我发现 Jetty 在几乎所有可能的方面都比 Tomcat 更可取。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T16:09:10.613

您追求的是哪种与 Eclipse 的集成？我相信有一些插件可以进行某种集成（例如[Sysdeo Eclipse Tomcat Launcher 插件](http://www.eclipsetotale.com/tomcatPlugin.html)），但我总是发现如果需要的话，在调试模式下启动 Tomcat 是最简单的——而且这很容易。

至于是否值得坚持使用 JBoss：如果您不需要该功能，则可能不值得。在 Tomcat 中进行连接池的方法有很多，具体取决于您还使用什么。（例如，如果您使用 Hibernate 和 Spring，则各种连接池都可以在其中很好地工作。）

尽管如此，Tomcat 还是提供了自己的 JNDI 实现 - 根据[Tomcat 5.5 文档](http://tomcat.apache.org/tomcat-5.5-doc/jndi-resources-howto.html)。

拥有一个合理的“精简和平均”堆栈有很多话要说——不是在性能方面，而是在理解应用程序内发生的事情和简化部署方面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-31T04:57:24.557

根据你想要做什么，你也可以考虑 Jetty。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T20:28:53.473

你可以试试这个：[http://www.atomikos.com/Publications/J2eeWithoutApplicationServer](http://www.atomikos.com/Publications/J2eeWithoutApplicationServer) - 如果您需要 Web 层，请结合轻量级 Web 容器和 Wicket。

这些组合将在 Java/Java EE 中为您提供前所未有的生产力。

HTH 家伙

# asp.net - 会话超时后 Session_Start 后立即调用 ASP.NET Session_End

> ID：697816
> 
> 赞同：3
> 
> 时间：2009-03-30T15:59:50.230
> 
> 标签：asp.net, session-timeout

我有 Session_Start 和 Session_End 事件的处理程序。当我第一次启动应用程序时，一切正常。如果我离开会话并且发生标准超时，我会观察我的 Session_End 抛出。我期待这种行为。

假设我在超时后回来并刷新页面。Session_Start 方法运行，但随后 Session_End 方法立即运行。我预计 Session_Start 和 Session_End 之间还有 15 分钟的空闲时间。

会有什么问题？

编辑：是的，相同的会话 ID。

编辑 2： Cookie 看起来应该在会话结束时过期。不知道为什么我不断得到这个 Session_Start/Session_End 循环。我也尝试过从 Session_End 调用 Session.Abandon()，但没有奏效。这也在 ASP.NET 开发服务器上运行。我还没有在真正的 IIS 服务器上尝试过。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-03-04T13:45:32.707

回答有点晚了，但它可能对遇到同样问题的其他用户有用.. 我经历过与您看到的相同的行为：`Session_Start()`并且`Session_End()`在第一次超时后为每个请求调用并且 SessionID 始终是相同的：

1.  我用 ASP.NET 4.0 运行了相同的代码，问题就消失了。

2.  作为 ASP.NET 2.0/3.5 中的一种解决方法，只需将任何内容放入会话集合 ( `Session["dummy"] = "dummy"`) 中，`Session_Start()`就会`Session_End()`正常运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T16:23:43.603

.Net 用他们的会话 cookie 做了一些时髦的事情，尤其是。与表单身份验证结合使用。我只是在猜测，但我认为客户端挂在 cookie 上，并且即使在其无效之后也将其重新发送到服务器，这（我在这里猜测）可能会触发会话的重新启动，此时它会识别出它的无效并将其丢弃，从而导致会话结束。

尝试：

1.  确保您的 cookie 设置为正确过期
2.  调用 Session.Abandon() 和 FormsAuthentication.SignOut()

不确定这是否有帮助，但 FWIW。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-18T18:24:56.600

对于任何有同样问题的人。Alex B 给出的答案救了我。

这不再发生在 4.0 上，但是如果您在 Session_Start 处理程序内的 Session 中放置一些东西，这会切断 Session_Start -> Session_End 循环，您甚至不必删除 cookie。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T16:12:10.153

您能否验证事件是否针对相同的会话 ID 触发？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-08-28T01:08:47.143

这是这个[问题](https://stackoverflow.com/questions/2236129/asp-net-large-number-of-session-start-with-same-session-id)的副本。

这是因为 ASP.NET 2.0/3.5 根据会话是否在使用来处理会话的方式。在正常情况下，它不会尝试在第一次使用会话之前保持会话，因此不会发出会话 cookie（如果它不存在）。第一次使用会话时*，*会在服务器上创建会话并发出会话 cookie。

现在，当先前的会话重新启动但未使用时，ASP.NET 会有点混乱。它试图立即放弃未使用的（重新启动的）会话，因为它不是必需的，这会引发早期的 Session_End。但是，它不会删除预先存在的会话 cookie，因此每个后续请求都会重复该序列，重新启动然后终止会话，直到 cookie 被删除或会话被使用。

在 .Net 4.0 中，这种行为发生了变化，在这种情况下不再触发事件。

# c - 如何让 gcc 吐出从流程图到源代码行号的映射

> ID：697817
> 
> 赞同：10
> 
> 时间：2009-03-30T15:59:55.267
> 
> 标签：c, gcc, call-graph

给定一个 C 文件，gcc 能否吐出所有发生的函数调用的列表，以及调用本身和函数声明的文件名和行号？

我知道 gcc 以某种方式使用 -g 保留了这些信息（调试器依赖它），并且它可以使用 -dr 转储控制流图（但没有文件名或行号）；但是是否有一个现成的工具可以获取 gcc 输出并执行我想要的操作？

我想要这样一个工具来使用 gcc 的原因是，这将允许我将它与大多数基于 gcc 的软件附带的标准构建系统一起使用（例如 ./configure && make），即使在工具依赖于自己的预处理器的情况下也是如此和/或解析器是适应的主要麻烦。我已经知道几个这样的工具，例如ctags。所以这个问题是[问题 525899](https://stackoverflow.com/questions/525899/how-to-know-line-numbers-of-local-declarations-loops-in-a-c-function)的后续问题。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-30T17:21:31.657

试试 gcc 选项`-fdump-tree-fixupcfg-lineno`。

它将以一种可以使用相对简单的词法分析器或任何正则表达式引擎轻松解析的方式“漂亮地打印”解析 AST（带有行号）。只需找到所有以 '=' 开头并后跟 '(' 的非关键字 - 这将是函数调用。

所有复杂的表达式将被分成几行，因此不会有两个函数调用出现在一行上。

采取简单的程序：

```
#include <stdio.h>
#include <stdlib.h>
#include <math.h>

#define PI (3.1415926536)

int main(int argc, char *argv[]) {
    double  angle = PI / 2.0;
    printf("Sine = %lf, cosine = %lf\n", sin(angle), cos(angle));
    return EXIT_SUCCESS;
} 
```

编译它，`-fdump-tree-fixupcfg-lineno`你会得到这样的东西：

```
main (argc, argv)
{
  double angle;
  int D.3381;
  double D.3380;
  double D.3379;

  # BLOCK 2, starting at line 8
  # PRED: ENTRY (fallthru)
  [test.c : 8] angle = 1.57079632680000003119857865385711193084716796875e+0;
  [test.c : 9] D.3379 = [test.c : 9] cos (angle);
  [test.c : 9] D.3380 = [test.c : 9] sin (angle);
  [test.c : 9] printf (&"Sine = %lf, cosine = %lf\n"[0], D.3380, D.3379);
  [test.c : 10] D.3381 = 0;
  return D.3381;
  # SUCC: EXIT

} 
```

你不会得到任何复杂的表达式——只有赋值和函数调用，没有 CPP 宏，很容易解析。循环和条件不会使它变得更加困难。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-30T16:24:43.587

Valgrind 和 KCacheGrind 似乎是一个很好的工具：

```
valgrind --tool=callgrind --dump-instr=yes ./your_binary 
```

这将为您提供一个名为 callgrind.out.pid 的文件，您可以使用 KCacheGrind 打开该文件。这会让你看到很多信息，比如调用图、文件名......

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-12-11T16:52:27.857

您可以尝试[Treehydra](https://developer.mozilla.org/en/Treehydra)，这是一个 GCC 插件，可让您在编译期间以只读方式访问 GCC 内部代码表示。（但是，构建起来有点麻烦，我不确定它会比 -fdump-* 提供更好的结果。）

# flash - Netstream() 循环问题

> ID：697827
> 
> 赞同：0
> 
> 时间：2009-03-30T16:01:41.613
> 
> 标签：flash, actionscript-2, for-loop

我正在预加载 4 部 flv 电影并隐藏它们，当我翻转 videobutton 电影剪辑时，我希望 flv 视频淡入并开始播放。我有这个工作代码，但我觉得它写得很糟糕。

```
var videos:Array = new Array(
'ltp_video-low1.flv',
'ltp_video-low1.flv',
'ltp_video-low1.flv',
'ltp_video-low1.flv'
);

function videoOver(buttonMC,video,stream) {
    buttonMC.onRollOver = function() {
    stream.pause(false);
    video.attachVideo(stream);
    fadeIn(video);
    };
}

function videoOut(buttonMC,video,stream) {
    buttonMC.onRollOut = function() {
    fadeOut(video);
    stream.pause();
    };
}

for (var i:Number=1; i<=4; i++) {
    this['connection'+i] = new NetConnection();
    this['connection'+i].connect(null);
    this['stream'+i] = new NetStream(this['connection'+i]);
    this['stream'+i].play(videos[i-1]);
    videoOver(this['videobutton'+i],this['video'+i],this['stream'+i]);
    videoOut(this['videobutton'+i],this['video'+i],this['stream'+i]);
} 
```

相反，我想要这样的东西：但这不起作用，我认为 attachVideo() 有问题。

```
for (var i:Number = 1; i<=4; i++) {
    this['connection'+i] = new NetConnection();
    this['connection'+i].connect(null);
    this['stream'+i] = new NetStream(this['connection'+i]);
    this['stream'+i].play('ltp_video-low1.flv');
    this['videobutton'+i].i = i;
    this['videobutton'+i].onRollOver = function() {
        this['stream'+this.i].pause(false);
        this.attachVideo(['stream'+this.i]);
        fadeIn(['video'+this.i]);
    };
    this['videobutton'+i].onRollOut = function() {
        this['stream'+this.i].pause();
        this.attachVideo(['stream'+this.i]);
        fadeOut(['video'+this.i]);
    };
} 
```

这是所有代码：

```
// Import TweenLite
import gs.*;
import gs.easing.*;

// Creates the fade functions
function fadeIn(video) {
    TweenLite.to(video,0.5,{_alpha:100, ease:Regular.easeOut});
}
function fadeOut(video) {
    TweenLite.to(video,0.5,{_alpha:0, ease:Regular.easeOut});
}

// Parses the Flashvars into arrays
var titles:Array = (_level0.titleVars) ? _level0.titleVars.split(',') : [];
var urls:Array = (_level0.urlVars) ? _level0.urlVars.split(',') : [];

// Sets the mouse action
function SetMouseAction(indexNumber, buttonMC, arrowMC, dynamicTF, linkURL):Void {
    buttonMC.colorText = dynamicTF;
    buttonMC.onRollOver = function() {
        TweenLite.to(arrowMC,0.2,{_x:"2", _alpha:80, ease:Back.easeOut, tint:0x7cb0b7});
        this.colorText.textColor = 0x7cb0b7;
        // Fixes the Flash bug with button over each other
        if (indexNumber == 1 || indexNumber == 2 || indexNumber == 3) {
            stream1.pause(false);
            fadeIn(video1);
        }
        if (indexNumber == 4 || indexNumber == 5 || indexNumber == 6) {
            stream2.pause(false);
            fadeIn(video2);
        }
        if (indexNumber == 7 || indexNumber == 8 || indexNumber == 9) {
            stream3.pause(false);
            fadeIn(video3);
        }
        if (indexNumber == 10 || indexNumber == 11 || indexNumber == 12) {
            stream4.pause(false);
            fadeIn(video4);
        }
    };
    buttonMC.onRollOut = function() {
        TweenLite.to(arrowMC,0.2,{_x:37, _alpha:100, ease:Back.easeOut, tint:0xFFFFFF});
        this.colorText.textColor = 0xffffff;
    };
    buttonMC.onRelease = function() {
        if (linkURL) {
            getURL(linkURL);
        }
    };
}

// Loops trough all the MC
for (var i:Number = 1; i<=12; i++) {
    SetMouseAction(i,this["link"+i],this["arrow"+i],this["text"+i],urls[i-1]);
    this["text"+i].text = titles[i-1];
}

var videos:Array = new Array('ltp_video-low1.flv', 'ltp_video-low1.flv', 'ltp_video-low1.flv', 'ltp_video-low1.flv');

function videoOver(buttonMC, video, stream) {
    buttonMC.onRollOver = function() {
        stream.pause(false);
        video.attachVideo(stream);
        fadeIn(video);
    };
}

function videoOut(buttonMC, video, stream) {
    buttonMC.onRollOut = function() {
        fadeOut(video);
        stream.pause();
    };
}

for (var i:Number = 1; i<=4; i++) {
    this['connection'+i] = new NetConnection();
    this['connection'+i].connect(null);
    this['stream'+i] = new NetStream(this['connection'+i]);
    this['stream'+i].play(videos[i-1]);
    videoOver(this['videobutton'+i],this['video'+i],this['stream'+i]);
    videoOut(this['videobutton'+i],this['video'+i],this['stream'+i]);
}

/*
for (var i:Number = 1; i<=4; i++) {
    this['connection'+i] = new NetConnection();
    this['connection'+i].connect(null);
    this['stream'+i] = new NetStream(this['connection'+i]);
    this['stream'+i].play('ltp_video-low1.flv');
    this['videobutton'+i].i = i;
    this['videobutton'+i].onRollOver = function() {
        this['stream'+this.i].pause(false);
        this.attachVideo(['stream'+this.i]);
        fadeIn(['video'+this.i]);
    };
    this['videobutton'+i].onRollOut = function() {
        this['stream'+this.i].pause();
        this.attachVideo(['stream'+this.i]);
        fadeOut(['video'+this.i]);
    };
}
*/ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T18:11:42.550

在您的原始代码中，您有：

```
function videoOver(buttonMC,video,stream) {
  buttonMC.onRollOver = function() {
    stream.pause(false);
    video.attachVideo(stream);
    fadeIn(video);
  };
}

videoOver(this['videobutton'+i],this['video'+i],this['stream'+i]); 
```

在这种情况下，正在对视频对象调用 attachVideo。

我没有在您的代码中看到声明视频对象的位置，但我假设它在那里。

在第二段代码中，您正在执行以下操作：

```
this['videobutton'+i].onRollOver = function() {
  this['stream'+this.i].pause(false);
  this.attachVideo(['stream'+this.i]);
  fadeIn(['video'+this.i]);
}; 
```

因此，在 videobutton 对象上调用 attachVideo，而不是在 video 对象上。

另外，我认为对流的引用不会起作用，因为您的这个变量将是视频按钮，据我所知，它没有定义该值（函数（）中的“this”引用} 与它之外的 this 引用不同）。

我认为对 fadeIn 的调用也可能无法正常工作，因为我认为范围会被搞砸。

* * *

这是可能有用的东西。我根本没有测试过它，但希望你能明白我正在尝试什么。

```
for (var i:Number = 1; i<=4; i++) {
  this['connection'+i] = new NetConnection();
  this['connection'+i].connect(null);
  this['stream'+i] = new NetStream(this['connection'+i]);
  this['stream'+i].play('ltp_video-low1.flv');
  this['videobutton'+i].i = i;
  setHandlers(i);
}

function onVideoButtonRollOver(i:Number):Void {
  this['stream' + i].pause(false);
  this.attachVideo(this['stream' + i]);
  this.fadeIn(this['video' + i]);
}

function onVideoButtonRollOut(i:Number):Void {
  this['stream' + i].pause();
  fadeOut(this['video' + i]);
}

function setHandlers(i:Number):Function {
  this['videobutton'+i].scope = this;
  // This essentially fixes the scope issue.  The value of i is retained
  // properly due to the property of closures.
  this['videobutton'+i].onRollOver = function() {
    this.scope.onVideoButtonRollOver.apply(this.scope, [i]);
  }
  this['videobutton'+i].onRollOut = function() {
    this.scope.onVideoButtonRollOut.apply(this.scope, [i]);
  }
} 
```

虽然我对此并不满意。我认为可能应该重构代码，以便每个组有一个对象，其中包含“流”、“连接”等成员。我认为这会使事情变得更清晰，因为您不必经常引用到索引。

# c# - Sys.InvalidOperationException：处理程序必须是函数

> ID：697831
> 
> 赞同：3
> 
> 时间：2009-03-30T16:03:12.983
> 
> 标签：c#, .net, javascript, tabs, ajaxcontroltoolkit

我有一个包含 TabContainer 的网页

```
<%@ Register Assembly="AjaxControlToolkit" Namespace="AjaxControlToolkit" TagPrefix="cc1" %>
...
....
<form id="form1" runat="server">
    <asp:ScriptManager ID="sm1" runat="server"></asp:ScriptManager>
    <cc1:TabContainer runat="server" ID="tbcTabContainer" OnClientActiveTabChanged="ChangeTab()"></cc1:TabContainer>
</form> 
```

它调用了一个 js 函数，该函数目前什么都不做。

```
<script  type="text/javascript">
function ChangeTab()
{
    alert('Sucesss');
}
</script> 
```

在我的页面加载后面的代码中，我创建了几个选项卡面板并将它们添加到容器中。现在，我的问题是，当我更改选项卡时，会显示 javascript 警报框，但是一旦我关闭它，我就会收到错误消息

Microsoft JScript 运行时错误：Sys.InvalidOperationException：处理程序必须是函数。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-30T16:07:06.763

您需要从属性中删除括号...

改变

```
OnClientActiveTabChanged="ChangeTab()" 
```

到

```
OnClientActiveTabChanged="ChangeTab" 
```

只是为了澄清，当您添加括号时，它是一个文字方法调用，而没有括号，它是对该方法的引用，这些分配的工作方式类似于期望委托（方法引用）的回调。相反，它正在获取方法调用并将在原始 eval 上执行（因为它是一个调用），然后在尝试正确调用时失败，因为它不是实际的方法引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T16:09:19.440

通常，您只需要提供要调用的函数名称，因此“ChangeTab()”实际上应该只是“ChangeTab”。

此外，该函数应在技术上实现正确的签名，这类似于服务器端事件处理程序：ChangeTab(sender, e)....

# css - 溢出：带边距的自动

> ID：697832
> 
> 赞同：2
> 
> 时间：2009-03-30T16:03:23.793
> 
> 标签：css

我有一个简单`<ul>`的位置固定，高度设置为 100% 并溢出到自动。当窗口的高度小于无序列表的高度时，这允许我滚动。

唯一的问题是我希望无序列表距离页面顶部 30px。当滚动条出现时，`<ul>`实际上缺少滚动条的底部，此外，由于上边距，滚动条的底部也丢失了。

这是一些示例标记：

```
<div id="sidebar">
  <ul>
    <li>Test1</li>
    <li>Test1</li>
    <li>Test1</li>
    <li>Test1</li>
    <li>Test1</li>
    <li>Test1</li>
    <li>Test1</li>
    <li>Test1</li>
    <li>Test1</li>
    <li>Test1</li>
  </ul>
</div> 
```

和 CSS

```
div#sidebar {
    width:148px;
    height:100%;
    overflow:auto;
    position:fixed;
    margin-top:30px;
} 
```

任何想法如何解决这个怪癖？

**编辑：**啊，忘了添加位置：固定

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-30T16:07:34.547

这个想法是让 30px 在除高度 100% 元素之外的元素上，因为边距和 100% 加在一起以创建最终元素高度（并且：100% + 30px > 100%）。通过在包含的 div 上放置填充，您可以获得相同的效果。

尝试这个。

```
<div id="container">
<div id="sidebar">
  <ul>
    <li>Test1</li>
    <li>Test1</li>
    <li>Test1</li>
    <li>Test1</li>
    <li>Test1</li>
    <li>Test1</li>
    <li>Test1</li>
    <li>Test1</li>
    <li>Test1</li>
    <li>Test1</li>
  </ul>
</div>
</div>

div#container {
    padding-top:30px;
}
div#sidebar {
    width:148px;
    height:100%;
    overflow:auto;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T16:17:49.843

正如乔尔所说，边距+高度加在一起，所以你应该使用一个容器。

另外，请记住任何可能的外边距或填充。这应该可以完美运行（在 IE7 + Opera 10 上测试），前提是您没有任何其他标记打扰：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js"></script>

        <style type="text/css">
            html, body{
                height: 100%;
                padding: 0;
                margin: 0;
            }
            .container {
                padding-top: 30px;
                width:148px;
            }
            #sidebar{
                margin: 0;
                width:148px;
                height:100%;
                overflow:auto;
                background: red;
            }
        </style>

    </head>
    <body>
        <div class="container">
            <ul id="sidebar">
                <li>...</li>
            </ul>
        </div>
    </body>
</html> 
```

# javascript - 显示高分辨率图像

> ID：697836
> 
> 赞同：0
> 
> 时间：2009-03-30T16:04:06.833
> 
> 标签：javascript, html, css

我有一个非常高分辨率的图像（例如[这个](http://www.digitalfishlibrary.org/library/ViewImage.php?id=1751)）需要查看。

我想将其放入浏览器屏幕或让用户滚动图片（不更改图像）。

有什么好的方法来做这些事情？我猜有一种方法可以使用 CSS（使用宽度/高度）或 Javascript 来做到这一点。我只是想知道使用 CSS/Javascript 的其他一些解决方案或最佳解决方案是什么。

另一种实现这一点的好方法是使用某种类型的控件，允许用户放大/缩小并在高分辨率图片周围移动。我应该为此使用 GoogleMaps API 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-30T16:15:29.660

我还没有尝试过，但这里有一个例子： http: [//www.visual-blast.com/javascript/panoramic-photoviewer-in-javascript/](http://www.visual-blast.com/javascript/panoramic-photoviewer-in-javascript/) 另外，只是谷歌开源照片管理的一些例子和想法。另一种选择是使用闪光灯。使用嵌入式闪存模块执行此操作很简单。如果您需要想法，也可能有一些开源 Flash 照片查看器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T16:43:20.857

为了适应浏览器窗口，你可以使用这个：

```
 var yourImage = document.getElementById('imageid');   
 yourImage.style.width = window.innerWidth+"px"; 
```

或遍历所有图像

```
var yourImages = document.getElementsByTagName('img');
for(var i = 0; i < yourImages.length;i++){    
     yourImages[i].style.width = window.innerWidth+"px";   
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T22:38:24.060

最好的方法是使用免费的 Google Maps API。使用众多瓷砖切割机之一来切割您的图像，然后像 Google 地图一样显示您的高分辨率照片 - 人们可以放大、缩小和平移。像这样切割你的形象也更难被盗！

[阅读这篇博文了解更多信息](http://blog.makezine.com/archive/2009/01/use_google_maps_to_view_highres_pho.html?CMP=OTC-0D6B48984890)

# ruby-on-rails - Rails 中的多态关联

> ID：697840
> 
> 赞同：0
> 
> 时间：2009-03-30T16:04:55.130
> 
> 标签：ruby-on-rails, associations, polymorphic-associations

多态关联在 Rails 中是如何工作的？他们的优势是什么？有没有办法`belongs_to`通过运行迁移来添加方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T16:08:03.843

Ryan 有一个关于这个的[railscast非常好。](http://railscasts.com/episodes/154-polymorphic-association)

Belongs_to 不是您添加到迁移中的东西，而是将其添加到模型中。在迁移中，您必须添加外键列。例如，如果您有一个属于某个用户的帖子模型，您可以将 user_id 列添加到迁移中的 post activerecord 中。然后你添加

```
 belongs_to :user 
```

分别在后模型中。然后，rails 将在后台发挥作用，为您提供用户模型中的代理集合。

# php - 允许的 MIME 文件类型的 PHP 上传代码问题

> ID：697850
> 
> 赞同：1
> 
> 时间：2009-03-30T16:06:57.403
> 
> 标签：php, image-processing, image-manipulation, file-upload

我在 PHP 中有一个文件（图像）上传脚本，用于上传和调整图像大小......它使用简单的 MIME 类型和大小验证，因此只允许 jpg 图像和 1MB 最大文件大小。

我最近发现了一个问题。当我尝试使用脚本上传 .avi 文件时，脚本会像处理正确的 MIME 类型和大小一样处理文件，然后什么也不做，只是将我带回上传表单而没有任何错误消息。（而不是显示“文件太大”消息）。

我的意思是，如果我尝试上传 .gif 或 .txt 或其他内容，我会得到一个错误，正如预期的那样。如果我尝试上传任何大于 1MB 的文件，我会得到一个错误，正如预期的那样。只有当我尝试上传超过 1MB 的 .avi 文件时，我才没有收到任何错误......好吧，这里是代码的第一部分：

```
// define a constant for the maximum upload size
define ('MAX_FILE_SIZE', 1024000);

if (array_key_exists('upload', $_POST)) {
// define constant for upload folder
define('UPLOAD_DIR', 'C:/Wamp/www/Version-1.4/posters_uploaded/');

// replace any spaces in original filename with underscores. At the same time, assign to a simpler variable
$file = str_replace(' ', '_', $_FILES['image']['name']);

// convert the maximum size to KB
$max = number_format(MAX_FILE_SIZE/1024, 1).'kb';
// create an array of permitted MIME types
$permitted = array('image/jpeg','image/pjpeg');
// begin by assuming the file is unacceptable
$sizeOK = false;
$typeOK = false;

// check that file is within the permitted size
if ($_FILES['image']['size'] > 0 && $_FILES['image']['size'] <= MAX_FILE_SIZE) {
    $sizeOK = true;
}
// check that file is of a permitted MIME type
foreach ($permitted as $type) {
    if ($type == $_FILES['image']['type']) {
        $typeOK = true;
    break;
    }
}

if ($sizeOK && $typeOK) {
    switch($_FILES['image']['error']) {
        case 0: // ................... 
```

我只是在修改构建 PHP 代码，所以我不是专家......有什么建议吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T16:13:01.740

[http://us3.php.net/manual/en/features.file-upload.common-pitfalls.php](http://us3.php.net/manual/en/features.file-upload.common-pitfalls.php)

看起来你的`upload_max_filesize`ini设置太低了。当您上传非常大的文件（例如 AVI 视频）时，这不会导致显示错误。

您看到文本文件和 .jpg 图像错误的原因可能是因为这些文件的大小大于 1 MB，但低于您`upload_max_filesize`在*php.ini*中的设置。

如果您无法直接访问*php.ini*文件，请尝试`echo`获取 的值并查看该值是什么。`ini_get("max_upload_filesize")`

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T16:15:15.853

在这条线之上：

```
if ($_FILES['image']['size'] > 0 && $_FILES['image']['size'] <= MAX_FILE_SIZE) {
        $sizeOK = true;
} 
```

把这个：

```
echo '<pre>' . printr($_FILES) . </pre>; 
```

这将向您显示 FILES 数组中的内容，并且应该使调试变得非常简单。尝试上传 AVI 并将上述行添加到您的脚本中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T16:29:36.070

我还建议您不要相信哑剧类型。有时人们将 .png 或 .gif 文件重命名为 .jpg，或者他们可能故意上传不正确的文件。使用 getimagesize 检查这些是否是有效的 jpeg 图像。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T16:51:45.720

正如上面提到的 john Rasch，任何高于 php.ini max_upload_filesize 的文件都不会被处理。所以你将没有机会为你测试错误。您必须假设它没有上传并验证它是否是。

* * *

既然我更好地了解了您的情况，我认为您可以这样做：

```
// at the top of your script
$upload_success = FALSE;

// when successfully detected upload
$upload_success = TRUE;

// if successful upload code is never run
$display_error = "File not uploaded, may be too large a file, "
.    "please upload less than 1MB"
;
print $display_error; 
```

* * *

要点是：

您不能总是检测到太大的上传文件，因为它们在比脚本运行位置更深的级别被切断。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T22:16:10.497

不要忘记，在上传文件时，在 php.ini 中实际上需要注意两个指令。一个是upload_max_filesize，另一个是post_max_size。通常，post_max_size 至少应该等于并且可能大于upload_max_filesize。无论您设置什么upload_max_filesize，您都不能上传大于post_max_size 的文件。

AVI 文件与您在允许的数组中列出的 mime 类型不匹配。完成 $sizeOK 和 $typeOK 检查后，检查它们保存的值以及脚本如何处理这些值。这可能是脚本行为的关键。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-03-06T07:37:29.747

使用 $_FILES['image']['type'] 检查 MIME 是不可靠的，它是基于客户端的标头，可以被欺骗。查看 fileinfo 扩展名以根据实际内容检查 MIME。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-03-03T21:22:14.237

八年后，对于像我这样的任何人来说，在上传之前用 PHP 检查图像 MIME 类型的答案都跌跌撞撞的简短回答：

```
if (exif_imagetype($file['tmp_name']) != IMAGETYPE_JPEG) {
    $file['error'] = 'Your picture must be jpg.';
} 
```

来自手册： http: [//php.net/manual/en/function.exif-imagetype.php](http://php.net/manual/en/function.exif-imagetype.php)

# c# - 我的重载应该有多明确？

> ID：697858
> 
> 赞同：1
> 
> 时间：2009-03-30T16:08:47.617
> 
> 标签：c#, parameters, constructor, wrapper, overloading

我正在为 C# 的 jquery 插件构建一个包装器，我不喜欢 [Optional] 的使用，因为它不像它所说的那样“可选”（这意味着你仍然必须声明那个 System.Missing 库）所以我决定使用重载方法。我想给用户很多定制，但我不确定我的重载应该有多明确。我应该根据参数的重要性来分解它还是对每个场景都进行重载。

*   超载的足迹是什么？*   会不会降低效率？*   在 OOP 方面是否不受欢迎？

PS我正在调用基类的构造函数并且必须使用`base(param1, param2, ...)`方法，但我也想使用`this(param1, param2, ...`）而不是必须在每个场景中初始化我的成员变量，有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T16:17:59.420

**令人困惑的 API 是图书馆消费者的永恒祸根。**根据您提供的界面，让人们可以轻松甚至微不足道地决定他们想要做什么。如果他们必须从冗长的重载函数列表中进行选择，那可能是太多的认知开销。此外，值得注意的是，C# 4 将支持可选参数和命名参数，因此您的`System.Missing`问题会自行消失。

> 在 OOP 方面是否不受欢迎？

OOP 支持**[单一职责原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)**或 SRP。如果您有一个包含许多这些函数的类，每个类都有许多重载，这表明它可能做的太多了。

> 会不会降低效率？

如果同一个方法有很多重载，则*静态*解析每个函数调用需要更长的时间（即，“哪个方法使用这个名称是正确的？”）。但是，如果它们是非虚拟调用，则不会对性能产生*运行时*影响——也就是说，编译器可以静态地知道某些东西将是什么类型。不过，无论哪种方式，我认为这不应该是你的激励因素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T16:38:06.050

如果您有很多参数并且需要可扩展，请考虑使用包含您的参数的类。

例如

```
public class FileOptions
{
  public bool Indented { get; set; }
  public string Namespace { get; set; }
  public System.Text.Encoding Encoding { get; set; }
}

public void Save(string fileName, FileOptions options) { ... }

// usage:

obj.Save("a.xml", new FileOptions { Indented=true });
obj.Save("b.xml", new FileOptions { Namespace="urn:foo", Encoding=System.Text.Encoding.UTF8 }); 
```

# php - 如何抵消系统时间来测试我的 PHP 函数？

> ID：697863
> 
> 赞同：0
> 
> 时间：2009-03-30T16:09:58.707
> 
> 标签：php, time, strtotime

我正在编写一个函数来计算时间是否在工作日的上午 9 点到下午 5 点之间。然后，它会根据今天的营业时间是否已经结束或（如果在午夜之后）即将开始，告诉您下一个工作日的开始时间（如果当前是非营业时间）。

到目前为止一切都很顺利，并且创建了我可以使用的最易读的代码`strtotime()`——但是你如何测试`strtotime()`呢？

有没有办法临时更改系统时间以进行测试？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T16:13:05.517

只需使用`strtotime()`的可选第二个参数，给它一个特定的时间戳来使用。如果您不提供第二个参数，它将使用当前时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T16:38:51.150

strtotime 接受第二个参数，将时间设置为您想要的任何时间，而不是当前时间

int strtotime ( 字符串 $time [, int $now ] )

$time 是模仿的格式

$now 是生成日期的时间戳

如果现在提供它会覆盖当前时间。

例如在 3 月 30 日星期一下午 6 点进行测试，无论程序何时运行

```
$format = '2009-03-30 18:00'
$timestamp = mktime(18,0,0,3,30,2009);
strtotime($format,$timestamp); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T19:06:55.037

看看[这个页面](http://php.net/strtotime)，这就是你所需要的。:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-29T19:46:34.067

要测试 strtotime，您可以使用[http://www.teststrtotime.com](http://www.teststrtotime.com)（按 Enter 提交表单，该按钮现在似乎坏了）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T16:15:50.550

为什么不只是一个具有 strtotime() 输入值数组的单元测试？

```
...
  test( strtotime("now") );
  test( strtotime("10 September 2000") );
  test( strtotime("+1 day") );
  test( strtotime("+1 week") );
  test( strtotime("+1 week 2 days 4 hours 2 seconds") );
  test( strtotime("next Thursday") );
  test( strtotime("last Monday") ); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-30T19:25:31.653

你甚至不需要为 strtotime() 使用第二个参数；

```
// $now = time( ); // use this once testing is finished
$now = strtotime( '03/15/2009 14:53:09' ); // comment this line once testing is complete

testTime( $now ); 
```

# python - 困境：我应该学习 Seaside 还是 Python 框架？

> ID：697866
> 
> 赞同：9
> 
> 时间：2009-03-30T16:11:14.990
> 
> 标签：python, frameworks, seaside

我知道这有点主观，但是，如果你设身处地为我着想，**你会花时间在学习上吗？**

我想编写一个网络应用程序，它可以安全地处理数量相对较少的人们的私人数据，几千条几 Kb 的记录，但需要保持安全的东西，地址，电话号码等。我已经完成了几个网络项目在 PHP/MYSQL 中并已经决定，虽然它很方便，但我真的不喜欢 PHP，也不想在其中做另一个大型项目......

因此，我认为我最好学习一些新东西，所以我正在考虑 2 个选项（尽管如果你有建议，我会很乐意招待其他人）。我在决定时遇到了可怕的麻烦。他们看起来都很投入，所以不要只是跳进去，可能会浪费几天的时间来加快速度，让他们两个都做出明智的选择，我想我会来这里征求一些意见。

所以我正在考虑的两个选择是......

**PYTHON Web 框架之一**- TurboGears 似乎很受好评？优点：在我尝试过的所有语言中，Python 是我最喜欢的。有很多框架可供选择，在过去的几年里，我做了很多非 web python 编码。缺点：有很多选择，所以很难选择！需要运行单个服务器进程？还是 mod_python？我不喜欢的声音。我喜欢的是进程分离和划分的概念，即如果一个用户帐户被盗用，攻击者将无法利用系统的其余部分。我不清楚python解决方案能在多大程度上处理这个问题。

**把它写成一个 SEASIDE 应用程序**我猜它在一个吱吱作响的应用程序服务器上运行？Adv：据我所知，这将允许对用户进行良好的划分，因为每个人都有自己的小型私有 VM，独立于其他用户的所有系统，从安全性、扩展性和冗余的角度来看，这听起来很棒。Dis：自从 15 年前的 Uni 以来，我没有做过任何 Smalltalk，那时我也从未深入研究过它。我看不到海边或许多使用它的项目的入门级帮助。我怀疑设置服务器以运行它是困难的，原因相同，不是因为它本质上很难，而是因为在线帮助会更少，并且假设你已经对 Sqeak/Smalltalk 相当熟悉了。

那么，人们是怎么想的呢？我能否通过 Python 框架有效地获得我所追求的那种强大的分离和划分？在将用户彼此隔离方面，Seaside 是否和我想的一样好？在安全方面，我可能会变得更好，坚持使用我最熟悉的语言，这样我就不会犯任何 n00b 错误，或者 Seaside 是否值得扩展学习曲线并证明从长远来看更安全、更易于理解和可维护? 归根结底，这不是一个生死攸关的决定，如果我从一个开始然后讨厌它，我总是可以保释，所以请不要让所有的圣言战争开始燃烧任何人！;-)

为这得到的任何回复欢呼，

罗杰：）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-30T16:26:44.750

忘记 mod_python，有[WSGI](http://www.python.org/dev/peps/pep-0333/)。

我会推荐[Django](http://www.djangoproject.com/)。它可以在任何[WSGI](http://www.python.org/dev/peps/pep-0333/)服务器上运行，有很多可供选择。有用于 Apache的[mod_wsgi 、](http://code.google.com/p/modwsgi/) [wsgiref](http://docs.python.org/library/wsgiref.html) - Python 中包含的参考实现[等等](http://wsgi.org/wsgi/Servers)。[Google App Engine](http://code.google.com/appengine/)也是WSGI，包括 Django。

Django 非常流行，它的社区正在迅速发展。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-30T19:28:25.283

免责声明：我真的不喜欢 PHP，Python 很好，但在我的书中并没有接近 Smalltalk。但我是一个有偏见的 Smalltalker。关于海边/吱吱声的一些答案：

问：我猜它在一个吱吱作响的应用服务器上运行？

Seaside 在几个不同的 Smalltalks 中运行（VW、Gemstone、Squeak 等）。Smalltalk 国家并没有真正使用术语“应用服务器”。:)

问：据我所知，这将允许对用户进行良好的划分，因为每个人都有自己的小型私有 VM，独立于其他用户的所有系统，从安全性、扩展性和冗余的角度来看，这听起来很棒。

是的，每个用户都有自己的 WASession，用户看到的所有 UI 组件都是该会话中服务器端的实例。因此，会话之间的状态共享是您必须明确执行的操作，通常是通过 db。

问：自从 15 年前的 Uni 以来，我没有做过任何 Smalltalk，那时我也从未深入研究过它。我看不到海边或许多使用它的项目的入门级帮助。

Smalltalk 很容易上手，Seaside 上有一本免费的在线书籍。

问：我怀疑设置服务器以运行它是困难的，原因相同，不是因为它本身就很难，而是因为在线帮助会更少，并且假设您已经相当熟悉 Sqeak/Smalltalk。

不，不难。:) 其实很琐碎。大量帮助 - Seaside ml、freenode 上的 IRC 等。

问：Seaside 在将用户彼此隔离方面是否和我想的一样好？

我会这么说。

问：在安全方面，我是否会更好，坚持使用我最熟悉的语言，这样我就不会犯任何 n00b 错误，或者 Seaside 是否值得扩展学习曲线并证明在长跑？

支持 Seaside 恕我直言的杀手锏是真正的组件模型。它真的非常适合复杂的 UI 和维护。如果您害怕学习“不同的东西”（但是我猜您甚至不会首先考虑它），那么我会警告您。但如果你不害怕，那么你可能会喜欢它。

此外 - Squeak（或 VW）是一个真正令人敬畏的开发环境 - 调试实时 Seaside 会话，在调试器中更改代码并恢复等。它很震撼。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-30T16:23:23.370

我会说看看[Django](http://www.djangoproject.com)。它是一个 Python 框架，具有独立于托管操作系统的现成身份验证系统，这意味着妥协仅限于被妥协的应用程序（除非对托管 Python 进程的 Web 服务器进行一些利用）。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-30T20:47:44.903

我自己也进入了海边，但在很多方面都很难上手，这与可以极快上手的 smalltalk 无关。挑战在于您确实受到保护，无法直接编写 html。

我发现在大多数框架中，当您陷入如何做某事时，总是可以通过使用模板来解决它。您稍后可能会发现此解决方案会导致问题变得清晰，实际上框架中内置了更好的解决方案，但是您能够从该问题继续前进，直到您学会了正确的方法。

Seaside 没有模板，所以你没有那个拐杖。没有任何问题永远困扰着我，但有些问题比我希望的要花更长的时间来解决。另一面是你最终会更快地学习海滨方法，因为你不能作弊。

如果您决定走海边路线，请不要害怕在 squeakfoundation.org 上发布到海边邮件列表。一开始我觉得它很吓人，因为由于流量低，你在那里看不到很多初学者的问题，但人们愿意帮助那里的初学者。

还有一些海边的开发者会定期监控 stackoverflow。祝你好运。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-22T09:59:02.913

你看过**www.nagare.org**吗？

一个专门用于 Web 应用程序而不是网站的框架。

它基于 Seaside 概念，但您使用 Python 进行编程（nagare 部署了一个名为 Stackless Python 的 Python 发行版以使延续工作正常进行）。

像 Seaside 一样，它会自动生成 HTML，但还可以根据需要使用模板。

它最近由[http://www.net-ng.com/](http://www.net-ng.com/)开源，他们自己在 zope 和 plone 等高质量 Web 框架中提供 Web 应用程序/站点方面拥有多年经验。

我现在正在自己研究它，看看它是否符合我的需求，所以不能告诉你我对它的看法。如果你看，请给你的反馈。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-30T16:21:45.153

在考虑 Smalltalk Web 框架时，请同时查看[Aida/Web](http://www.aidaweb.si)。Aida 具有内置的安全性，包括用户/组/角色管理和强大的访问控制，可以在您的情况下为您提供很多帮助。这样，您可以在一个图像中的用户级别实现足够安全的用户分离。但如果你真的想要，你也可以通过运行许多图像将它们分开。但这会增加维护，如果值得，我会三思而后行。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-15T15:04:25.660

我自己在玩 Seaside，发现[本教程](http://seaside.gemstone.com/tutorial.html)对于深入了解框架的功能非常宝贵。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-30T16:25:41.557

我想你已经总结了很多优点和缺点。*Seaside 设置起来*并不难（我已经为各种项目安装了两次），但使用它肯定会影响你的工作方式——除了重新学习语言之外，你可能还需要调整很多关于你的工作流程。

它还取决于其他两个因素

*   如果其他人最终会维护它，那么你会更幸运地找到 Python 程序员
*   如果您正在做一个高度有状态的网站，Seaside 将击败我见过的任何其他框架。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-07-07T16:55:01.530

现在有一[本关于 Seaside 的在线书籍](http://book.seaside.st/book)可以完成[前面指出的教程](http://seaside.gemstone.com/tutorial.html)。

# c++ - 为什么不为函数返回的对象调用析构函数？

> ID：697868
> 
> 赞同：18
> 
> 时间：2009-03-30T16:11:38.267
> 
> 标签：c++, memory-management, destructor

我在想，当一个函数将堆栈上的一个对象返回给调用函数时，调用函数会获取原始对象的副本，但是一旦堆栈展开，就会调用原始对象的析构函数。但是在下面的程序中，析构函数只被调用一次。我预计它会被调用两次。

```
#include <iostream>

class MyClass
{
public:
  ~MyClass() { std::cout << "destructor of MyClass" << std::endl; }
};

MyClass getMyClass()
{
  MyClass obj = MyClass();
  return obj;   // dtor call for obj here?
}

int main()
{
  MyClass myobj = getMyClass();
  return 0;  // Another dtor call for myobj.
} 
```

但是“MyClass 的析构函数”只打印一次。我的假设是错误的还是这里发生了其他事情？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-30T16:12:55.877

这是允许编译器优化副本的特殊情况：这称为[命名返回值优化](http://blogs.msdn.com/slippman/archive/2004/02/03/66739.aspx)(NRVO)。基本上，编译器为调用站点上的返回对象分配内存，并让函数直接填充该内存，而不是在被调用站点创建对象并将其复制回来。现代编译器会尽可能地定期执行此操作（在某些情况下，这并不容易，因为函数中有多个返回路径会返回*不同*的实例）。

# c# - C# ToString 继承

> ID：697874
> 
> 赞同：3
> 
> 时间：2009-03-30T16:13:36.483
> 
> 标签：c#, polymorphism

我有一个问题（这是我的错，我只是无法发现我做错了什么）“ToString”没有调用正确的方法......

```
public class ClassA
{
   public override ToString()
   {
      return "Hello, I'm class A.";
   }
}

public class ClassB : ClassA
{
   public override ToString()
   {
       return "Hello, I'm class B.";
   }
}

ClassB myClassB = new ClassB();
List<ClassA> myClassAList = new List<ClassA>();

myClassAList.Add((ClassA) myClassB);
ClassA tempClassA = myClassAList[0];
Console.WriteLine(tempClassA.ToString()); 
```

我从“ClassB”而不是“ClassA”得到“ToString”我做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-30T16:17:00.780

你没有做错任何事——这就是多态虚拟方法的工作方式。当您将 ClassB 放入 ClassA 引用的集合时，它仍然是 ClassB 对象。如果对象确实属于 ClassB，则调用 .ToString() 将始终找到 ClassB.ToString()。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-30T16:18:23.117

您在 ClassB 中覆盖 ToString 而不是将其隐藏在原始方法中，这将导致被覆盖的方法优先。你能做的是..

```
public class ClassA
{
    public override string ToString()
    {
        return "Hello, I'm class A.";
    }
}

public class ClassB : ClassA
{
    public new string ToString()
    {
        return "Hello, I'm class B.";
    }
}

...

List<ClassA> theList = new List<ClassA>
{
    (ClassA)new ClassB(),
    (ClassA)new ClassB()
};

ClassA a = theList[0];
Console.WriteLine(a.ToString());

// OR... 

Console.WriteLine(new ClassA().ToString());  // I'm Class A
Console.WriteLine(new ClassB().ToString());  // I'm Class B
Console.WriteLine(((ClassA)new ClassB()).ToString()); // I'm Class A 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-30T16:16:30.080

ToString 是一个虚拟方法，变量的类型是什么并不重要，实际对象的类型是什么很重要。

如果该方法不是虚拟的，则调用将转到编译器将知道的方法，即 ClassA ToString 方法。

虚拟方法通过查找表实现，绑定到对象类型。由于变量“tempClassA”中的对象实际上是 ClassB 类型的对象，因此使用 ClassB 的查找表，因此使用该类的 ToString 方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-30T16:18:49.810

你得到了正确的结果。您将 ClassB 的一个实例添加到您的列表中；即使您将其视为ClassA。因此，调用虚拟ToString方法时，会导致调用ClassB的ToString；因为那是您正在使用的实际对象。

# java - Javac标志禁止原始类型？

> ID：697879
> 
> 赞同：10
> 
> 时间：2009-03-30T16:15:21.440
> 
> 标签：java, generics, javac

是否可以传递任何 Java 编译器标志来告诉编译器不允许使用原始类型？也就是说，对于任何泛型类，让编译器强制使用参数化版本，否则抛出编译错误？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-30T16:34:18.617

JDK7 (b38) 引入[`-Xlint:rawtypes`](http://bugs.sun.com/view_bug.do?bug_id=6747671). 如上所述，`-Xlint:unchecked`警告未经检查的转换。

javac 团队的 Maurizio Cimadamore 写了一篇关于它的[博客](http://blogs.oracle.com/mcimadamore/entry/diagnosing_raw_types)文章。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-30T16:16:44.837

您可以在 Eclipse 中将原始类型的使用配置为警告或错误。

它位于 Preferences / Java / Compiler / Errors and Warnings / Generic types / Usage of a raw type。

`javac`据我所知，没有这样`-Xlint:all`的东西 - 即使你没有收到类似的警告：

```
ArrayList x = new ArrayList(); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-30T16:21:27.010

您可以通过以下方式警告您：

-Xlint：未选中

这将在某些（但不是全部）缺少泛型的情况下产生警告。

```
import java.util.ArrayList;
import java.util.List;

public class Main
{
    public static void main(final String[] argv)
    {
        List list = new ArrayList(); // no warning at all

        list.add("Hello"); // warning will be on this line
    }
} 
```

给出警告后，您可以返回并修复代码以将泛型添加到声明中。

不理想，如果我没记错的话，它仍然无法捕捉到所有内容。

# linq - LINQ to XML 问题

> ID：697884
> 
> 赞同：0
> 
> 时间：2009-03-30T16:16:11.093
> 
> 标签：linq

我的要求是检索与主机名匹配的节点（例如 machine1），但我总是没有得到任何结果。请让我知道问题是什么？

我在这里先向您的帮助表示感谢！！！

```
XDocument configXML = XDocument.Load("the below xml");

var q = from s in configXML.Descendants("lcsetting")
    where ((string)s.Element("host") == hostName)                        
    select s; 
```

实际的xml：

```
<lcsettings>
  <lcsetting env="prod">
    <hosts usagelogpath="">
      <host>machine1</host>
      <host>machine2</host>
      <host>machine3</host>
    </hosts>
  </lcsetting>
  <lcsetting env="qa">
    <hosts usagelogpath="">
      <host>machine4</host>
      <host>machine5</host>
      <host>machine6</host>
    </hosts>
  </lcsetting>
  <lcsetting env="test">
    <hosts usagelogpath="">
      <host>machine7</host>
      <host>machine8</host>
      <host>machine9</host>
    </hosts>
  </lcsetting>
</lcsettings> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T16:22:22.467

您正在寻找`host`直接在 lcsetting 下的元素 - 这不会发生，因为`hosts`层次结构中两者之间总是存在一个元素。您还使用`Element`了而不是`Elements`，这意味着只会返回具有正确名称的第一个元素。

您可以`Descendants`再次使用而不是`Element`... 但您需要更改条件。就像是：

```
var q = from s in configXML.Descendants("lcsetting")
        where s.Descendants("host").Any(host => host.Value == hostName)
        select s; 
```

或者，您可以让您的查询查找`host`元素，然后在每种情况下获取祖父元素：

```
var q = from host in configXML.Descendants("host")
        where host.Value == hostName
        select host.Parent.Parent; 
```

（这假设一个宿主元素每个 只会出现一次`lcsetting`；如果不是这种情况，您可以添加对 的调用`Distinct`。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T16:22:46.943

“主机”不是“lcsetting”的孩子。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T16:23:49.407

那是因为您的 lcsetting 下方有一个 <hosts> 标签，其中包含您的 <host> 标签。<host> 不是 <lcsetting> 的直接子级。

此查询将起作用：

```
var q = from s in configXML.Descendants("lcsetting").SelectMany(lcSetting => lcSetting.Descendants("host"))
        where s.Name == "host" && s.Value == hostName
        select s; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T16:24:31.027

您正在选择后代 lcsetting，但随后尝试检查低于其两级的元素主机。Element() 函数仅引用 1 级深的子元素。我建议将其更改为：

```
XDocument configXML = XDocument.Load("the below xml");
var q = from s in configXML.Descendants("lcsetting") 
        where s.Descendants("host").SingleOrDefault(e => e.Value == hostname) != null
        select s; 
```

# .net - 在运行时注册类型

> ID：697894
> 
> 赞同：1
> 
> 时间：2009-03-30T16:17:40.297
> 
> 标签：.net, inversion-of-control, unity-container, ioc-container, cag

我试图弄清楚如何在运行时使用统一注册一个类型。有什么建议么？

基本上我希望能够做到这一点：

```
Container.
   RegisterType(Of IMyInterface)(
            Type.GetType("Fully Qualified Type Name")) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T16:31:00.310

使用 RegisterType 的非泛型重载。

```
IUnityContainer container = new UnityContainer();
container.RegisterType(typeof(IMyInterface), Type.GetType("FQTN")); 
```

方法的非泛型版本采用简单的类型实例并进行反射，所以这应该做你想要的。用 C# 而不是 VB 编写代码，但你明白了……

# wcf - WCF 服务行为生命周期

> ID：697897
> 
> 赞同：2
> 
> 时间：2009-03-30T16:18:05.863
> 
> 标签：wcf

在 WCF 生命周期中何时加载服务行为？他们能坚持多久？我必须回收我的服务主机以重新应用服务行为还是动态检测到它们？生命周期变量是否基于服务主机的类型（Self、Windows 服务、IIS、WAS）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T17:37:14.427

如果您正在管理配置文件中的行为，那么它们会在 WCF 服务加载时加载。您需要重新启动服务，以使对服务行为的任何更改反映在实际服务中。由于 WCF 与主机无关，因此无论使用何种介质（WAS、WinSvc、IIS 等），服务主机行为都是相同的

# python - 如何向 Django 站点中的匿名用户发送会话消息？

> ID：697902
> 
> 赞同：6
> 
> 时间：2009-03-30T16:19:00.883
> 
> 标签：python, django, session, django-views

我经常使用以下方式在我的 Django 应用程序视图中向登录用户显示有关用户操作的消息：

```
request.user.message_set.create("message to user") 
```

我怎么能为匿名（未登录）用户做同样的事情？匿名用户没有 request.user ，但 Django 文档说使用“会话”中间件可以执行与上述代码相同的操作。链接到会话中间件的 Django 文档声称这是可能的，但我无法从会话文档中找到如何做到这一点。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-30T20:45:38.233

这就是我所做的，使用上下文处理器：

`project/application/context.py`（检查消息并将它们添加到上下文中）：

```
def messages(request):
    messages = {}
    if 'message' in request.session:
        message_type = request.session.get('message_type', 'error')
        messages = {'message': request.session['message'],
                    'message_type': message_type}
        del request.session['message']
        if 'message_type' in request.session:
            del request.session['message_type']
    return messages 
```

`project/settings.py`（将上下文添加到`TEMPLATE_CONTEXT_PROCESSORS`）：

```
TEMPLATE_CONTEXT_PROCESSORS = (
    "django.core.context_processors.request",
    "django.core.context_processors.debug",
    "django.core.context_processors.media",
    "django.core.context_processors.auth",
    "project.application.context.messages",  
) 
```

使用上述方法`messages`，每个请求都会调用该函数，并且它返回的任何内容都将添加到模板的上下文中。有了这个，如果我想给用户一个消息，我可以这样做：

```
def my_view(request):
    if someCondition:
        request.session['message'] = 'Some Error Message' 
```

最后，在模板中，您可以检查是否有要显示的错误：

```
{% if message %}
    <div id="system_message" class="{{ message_type }}">
        {{ message }}
    </div>
{% endif %} 
```

消息类型仅用于根据它是什么来设置样式（“错误”、“通知”、“成功”）以及设置方式，您一次只能为用户添加 1 条消息，仅此而已我真的需要，所以它对我有用。它可以很容易地更改以允许多条消息等。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-30T16:48:33.340

将数据直接存储在会话中，它是一个类似dict的对象。然后在视图/模板中，检查该值。

更多信息在这里：

[http://docs.djangoproject.com/en/dev/topics/http/sessions/#using-sessions-in-views](http://docs.djangoproject.com/en/dev/topics/http/sessions/#using-sessions-in-views)

您还可以创建一个中间件类来检查每个请求的会话对象，并在那里进行构建/拆除。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-01T08:56:30.183

请参阅[http://code.google.com/p/django-session-messages/](http://code.google.com/p/django-session-messages/)直到启用基于会话的消息的补丁登陆 Django 树（正如我最近看到的，它被标记为 1.2，所以没有希望快速添加.. .)。

另一个具有类似功能的项目是 Django Flash ( [http://djangoflash.destaquenet.com/](http://djangoflash.destaquenet.com/) )。

# ado.net - 同步服务 Ado.net 定义范围 ID

> ID：697903
> 
> 赞同：0
> 
> 时间：2009-03-30T16:19:07.623
> 
> 标签：ado.net, resolution, conflict, syncservices

有没有一种方法可以使用 ado.net 的同步服务来定义用于在客户端数据库中的表中插入的 id 范围？同步服务对这种情况有任何预测的支持吗？tks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-13T05:03:37.817

我认为同步服务永远不会提供这样的功能。如果您需要这样做，您必须覆盖/向同步提供程序提供您自己的插入命令。

# .htaccess - .htaccess !-f 规则不起作用

> ID：697909
> 
> 赞同：13
> 
> 时间：2009-03-30T16:21:32.767
> 
> 标签：.htaccess, mod-rewrite

多年来，我一直在为我的 CMS 使用简单的 mod_rewrite 规则，现在正在制作一个新版本，我发现 rewriteCond 没有意义 - 我有标准的“如果不是文件”，但我仍然看到正在评估重写规则，即使他们不应该这样做。我的重写代码：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^/]+)$ index.php?page=$1
RewriteRule ^([^/]+)/([^/]+)$ index.php?page=$1&var=$2 
```

我加载 /page/var 并且它作为 index.php?page=page&var=var 工作正常，但我尝试加载 /css/file.css 并且它加载 index.php?page=css&var=file.css 即使 /css /file.css***是***一个文件，因此甚至不应该评估整个重写部分。

我从未见过 htaccess 明显违背自己的逻辑，有人可以帮我解决这个问题吗？有没有人遇到过这样的事情？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-30T16:37:05.460

`RewriteCondition`s 仅适用于下一条规则。你要这个：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^/]+)$ index.php?page=$1

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^/]+)/([^/]+)$ index.php?page=$1&var=$2 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-09-25T01:29:38.363

如果您使用的是 Apache 2.2，那么您必须阅读以下内容：

[http://amandine.aupetit.info/135/apache2-mod_rewrite/](http://amandine.aupetit.info/135/apache2-mod_rewrite/)

剧透：你需要写的实际上是：

```
RewriteCond %{DOCUMENT_ROOT}%{REQUEST_FILENAME} !-f
RewriteCond %{DOCUMENT_ROOT}%{REQUEST_FILENAME} !-d
RewriteCond %{DOCUMENT_ROOT}%{REQUEST_FILENAME} !-l 
```

默克。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-30T16:34:38.773

嗯，这应该工作。

尝试在 .htaccess 中设置以下道具：

```
RewriteLog /var/log/rewrite.log
RewriteLogLevel 3 
```

调试您的请求。完成后请记住重置此值，否则您最终会得到一个已满的硬盘驱动器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-30T16:39:09.790

也许使用`RewriteLog`和`RewriteLogLevel`调试它在做什么？

（来自[http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html](http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html)）

# programming-languages - What languages are used for real time systems programming?

> ID：697916
> 
> 赞同：26
> 
> 时间：2009-03-30T16:22:47.037
> 
> 标签：programming-languages, real-time

I didn't find any useful information about programming languages for real time systems. All I found was [Real Time Systems and Programming Languages: Ada 95, Real-Time Java and Real-Time C/POSIX](https://rads.stackoverflow.com/amzn/click/com/0201729881) ([some pdf here](http://www.cs.york.ac.uk/rts/books/RTSBookThirdEdition.html)), which seems to talk about extensions of Java and C for real times systems (I don't have the book to read). Also, the book was published in 2001, and the information may be obsolete now.

So, I'm dubious whether these languages are used in real world applications, or if real time systems in the real world are made in other languages, like DSLs.

If the second option is true for you, what are the outstanding characteristics of the language you use?

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2010-06-26T05:44:11.037

I am an avionics software engineer. I was able to participate in several development projects. The languages I used in those projects are: C, C++, and Real-time Java.

C is great. C++ is not so bad but C/C++ require strict coding standards for the safety considerations such as DO-178B.

I think Real-time Java is the way to go but I don't see many avionics applications, yet.

Korean jet trainer T-50 will have a mission computer running RT Java application serving HUD and MFD displays, and all of the mission critical functions.

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-04-10T02:12:00.860

The Real-Time Specification for Java now has several commercial-grade implementations:

*   Sun's [JavaRTS](http://www.oracle.com/technetwork/java/javase/tech/index-jsp-139921.html)
*   IBM's [WebSphere Real-Time](http://www-01.ibm.com/software/webservers/realtime/)
*   Aonix [PERC](http://www.aonix.com/perc.html)
*   aicas [JamaicaVM](http://www.aicas.com/sites/jamaica.html)
*   Apogee [Aphelion](http://www.apogee.com/jre.html)

These products span the continuum from compilation to native code (Aonix) to J2ME (aicas, apogee), to full J2SE (Sun, IBM). Most, if not all, have seen deployments in small numbers of safety- or mission-critical systems, but momentum is building. Examples include [Eglin AFB's space surveillance radar modernization](http://eon.businesswire.com/portal/site/eon/permalink/?ndmViewId=news_view&newsId=20080414105422&newsLang=en) and the US Navy's use of RTSJ in the [DDG-1000/Zumwalt destroyer](http://www.prismtechnologies.com/section-item.asp?id=865). Sun also claims deployment in the financial transaction processing domain.

If you are interested in RTSJ, I suggest Peter Dibble's [Real-Time Platform Programming](https://rads.stackoverflow.com/amzn/click/com/0130282618), or Professor Wellings' [Concurrent and Real-Time Programming in Java](http://www.cs.york.ac.uk/rts/books/CRTJbook.html).

On a related note, there is also work underway to provide a Safety-Critical profile for the Java programming language, built as a subset of RTSJ. Also, an expert group has formed to explore a Distributed RTSJ DRTSJ, but the work is stalled.

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-03-30T17:10:30.510

The book covers use of Ada 95, the Java Real-Time System and realtime POSIX extensions (programmed in C). None of these is directly a domain specific language.

Ada 95 is a programming language commonly used in the late 90s and (AFAIK) still widely used for realtime programming in defence and aerospace industries. There is at least one DSL built on top of Ada - [SparkAda](http://www.praxis-his.com/sparkada/) - which is a system of annotations which describe system characteristics to a program verification tool.

[This interview](http://www.oracle.com/technetwork/articles/javase/bollella-qa2-135140.html) of April 6, 2006 indicates some of the classes and virtual machine changes which make up the Java Real-Time System. It doesn't mention any domain specific language extensions. I haven't come across use of Java in real-time systems, but I haven't been looking at the sorts of systems where I'd expect to find it (I work in aerospace simulation, where it's C++, Fortran and occasionally Ada for real-time in-the-loop systems).

[Realtime POSIX](http://www.unix.org/version2/whatsnew/realtime.html) is a set of extensions to the POSIX operating system facilities. As OS extensions, they don't require anything specific in the language. That said, I can think of one C based DSL for describing embedded systems - [SystemC](http://en.wikipedia.org/wiki/SystemC) - but I've no idea if it's also used to generate the embedded systems.

Not mentioned in the book is [Matlab](http://www.mathworks.com/), which in the last few years has gone from a simulation tool to a model driven development system for realtime systems. Matlab/Simulink is, in effect, a DSL for linear programming, state machines and algorithms. Matlab can generate [C](http://www.mathworks.com/products/rtw/) or [HDL](http://www.mathworks.com/products/slhdlcoder/?s_cid=HP_FP_SL_HDLCoder) for realtime and embedded systems. It's very rare to see an avionics, EW or other defence industry real-time job advertised which doesn't require some Matlab experience. (I don't work for Matlab, but it's hard to over emphasis how ubiquitous it really is in the industry)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-30T16:32:43.537

Real time applications can be made in almost any language. The environment (operating system, runtime and runtime libraries) must however be compliant to real time constraints. In most cases real-time means that there's always a deterministic time in which something happens. Deterministic time being ussually a very low time value in the microseconds/milliseconds range.

Real time systems depend solely on this criteria, as the specificiations usually say something like 'Every x (period of time) (do something | check something)'. Usually this happens if the system interfaces with external sensors and controls life-saving or life-threatening systems.

I was working on an in-car navigation and infotainment system developed mostly in C/C++ with an operating system configured specifically to meet the real-time constraints to provide real-time navigation and media playback.

But this is not all to real-time systems: Usually the selection of algorithms in the entire system is made to have deterministic runtimes according to the Big-O notation, mostly using linear or constant time. Everything else is considered non-deterministic and thus not useable for real-time systems.

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-03-30T16:38:46.377

All of the real-time systems I have worked with were predominantly written in C with some bits of assembler, or written mostly in assembler with little bits of C. (Depending on whether we're talking the 90s and beyond, or the 80s, respectively.) However, some of the real-time systems I've worked with have used -- not exactly DSLs -- special homegrown code generators.

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2014-09-07T10:59:13.687

### Real-time oriented language?

## What is real-time

First we have to define what *real-time* mean.

Of course depending on how your tool will work against the physical environment *pure real-time* couldn't be effectively done, mostly because there will be a lot of third party dependencies.

If you are building embed stuff by using microcontrollers like [arduino](http://arduino.cc/), the language to use will be limited by the hardware, but with more complex stuff like [Raspberry Pi](http://www.raspberrypi.org/), the language choice is very wide.

### Granularity

This is depending on what you are measuring, if you're working with:

*   *weather temperatures*, one read each 10 minute could be enough
*   *people height or weight*, one or maybe four read by day
*   *server status*, between 1 second for fine debugging to approx 1 hour for quiet unimportant secondary server.
*   *atomic collision count*: something finer...

### Event based reading

The right (better) way for collecting data is based on *value change event*... whenever the device do permit it.

Your tool have to not *poll* values from device, but the device have to send values to your tool, when they change.

This could be done by using an *hardware interrupt* trigger or by using port protocole like *RS-232* staying listening on some serial port, for sample.

### Monitoring environment

The last thing to be warned is *how legitimate user will interact with*.

If you're building embed standalone device, like *robot*, you may use graphic libraries to interact with touch screen.

If you're building web based monitor, you may have to keep in mind that the client could be an old *800x600* monochrome screen, using poor internet connection and small processor... But depending on final goal if you may interact with clients, you could ensure strong hardware and strong internet connections. Anyway you have to watch for connexion loosing and event for communication delay between server and client. There is mostly third party dependencies.

## Which programming language?

From there, the language choice is wide and clearly depend on

*   your knowledge.
*   granularity requested (by using event-based too, of course)
*   the amount of time you have to build the tool (money;)
*   delay, co-workers...
*   kind of device
*   kind of monitoring
*   some other political reasons

You could build real-time monitoring engine by using [bash](/questions/tagged/bash "show questions tagged 'bash'") and [sql](/questions/tagged/sql "show questions tagged 'sql'") only, I've seen sophisticated engines that was built under [postgresql](/questions/tagged/postgresql "show questions tagged 'postgresql'") only... I've personally built a web based, solar energy monitor by using [perl](/questions/tagged/perl "show questions tagged 'perl'"), [mysql](/questions/tagged/mysql "show questions tagged 'mysql'") and [javascript](/questions/tagged/javascript "show questions tagged 'javascript'").

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-01-02T17:20:26.300

I cannot believe no one has mentioned LabVIEW programming language which is widely used for Real-time safety-critical systems. It has extensive libraries and well-known design patterns for architecturing and implementing for RT systems.

Also National Instruments makes various hardware (cRIO, PXI and etc) which are designed for real-time applications.

We use LabVIEW for Fracking (Hydraulic Fracturing) which is used in safe-critical environments.

By the way, LabVIEW is also used for non-RT applications too.

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-02-09T08:43:34.610

PLCs run ladder and fbd code which is really a real-time dsl in the sense that your options are so limited that it is difficult to program in a way that would result in unpredictable runtime performance

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-08-15T18:36:32.773

A really purposeful application of the C language to real-time programming - and all related issues (such as parallel programming) - is offered by my Kickstarter [http://www.kickstarter.com/projects/767046121/crawl-space-computing-with-connel](http://www.kickstarter.com/projects/767046121/crawl-space-computing-with-connel) It is called "Wide Programming" and I've been doing it most of my life. The rewards include a software library and a book - designed to be useful.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-02-02T16:48:12.933

the company I've been working for since 2003 has been developing and deploying a Scada/Mes platform. Original implementation started in 1993, used Modula2 on OS/2\. Later (1998) it was ported to Ada95 and Windows. Currently (2019) we use Ada compiler by AdaCore. Our system was ported and has been deployed to 32/64 Windows, HPUX, OpenVMS (and lately even to Raspberry). We have multiple installation in central Europe (gas industry, refineries, factories, power plants). We feel Ada's features give our system a high degree of reliability and prevents a lot of errors that would easily occour if we used languages like C. See also my blog [https://www.ipesoft.com/en/blog/what-language-is-the-d2000-written](https://www.ipesoft.com/en/blog/what-language-is-the-d2000-written)

# big-o - “O(1) 访问时间”是什么意思？

> ID：697918
> 
> 赞同：152
> 
> 时间：2009-03-30T16:22:51.547
> 
> 标签：big-o

我已经看到这个术语“O(1) 访问时间”曾经表示“快速”，但我不明白它是什么意思。我在同一上下文中看到的另一个术语是“O(n) 访问时间”。有人可以用简单的方式解释这些术语的含义吗？

> **也可以看看**
> 
> *   [什么是大 O 符号？你用它吗？](https://stackoverflow.com/questions/133008/what-is-big-o-notation-do-you-use-it)
> *   [八岁的Big-O？](https://stackoverflow.com/questions/107165/big-o-for-eight-year-olds)

* * *

## 回答 #1

> 赞同：195
> 
> 时间：2009-03-30T16:25:42.880

您将需要阅读复杂性顺序。

[http://en.wikipedia.org/wiki/Big_O_notation](http://en.wikipedia.org/wiki/Big_O_notation)

简而言之，O(1) 意味着无论集合中的数据量如何，它都需要一个恒定的时间，例如 14 纳秒或三分钟。

O(n) 意味着它所花费的时间与集合的大小成线性关系，因此两倍大小的集合将花费两倍的时间。您可能不想将一百万个对象放入其中之一。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2009-03-30T16:25:09.107

从本质上讲，这意味着无论您的收藏中的项目数量很少还是非常多（在您的硬件限制内），在您的收藏中查找一个值都需要相同的时间

O(n) 意味着查找一个项目所需的时间与集合中的项目数成正比。

典型的例子是数组，无论它们的大小如何，都可以直接访问；链表，必须从头开始按顺序遍历才能访问给定的项目。

通常讨论的另一个操作是插入。一个集合可以是 O(1) 的访问，但 O(n) 的插入。实际上，数组具有这种行为，因为要在中间插入一个项目，您必须通过将每个项目复制到以下插槽中来将其向右移动。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2009-03-30T16:25:18.623

O(1) 表示访问某物的时间与集合中的项目数无关。

O(N) 意味着访问项目的时间与集合中项目的数量 (N) 成正比。

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2010-01-08T19:19:34.483

当前回答这个问题的每个答案都告诉您，这`O(1)`意味着恒定时间（无论测量发生什么；可能是运行时间、操作次数等）。这是不准确的。

说运行时是`O(1)`意味着存在一个常数`c`，使得运行时在 之上`c`，与输入无关。例如，返回`n`整数数组的第一个元素是`O(1)`：

```
int firstElement(int *a, int n) {
    return a[0];
} 
```

但是这个功能`O(1)`也是：

```
int identity(int i) {
    if(i == 0) {
        sleep(60 * 60 * 24 * 365);
    }
    return i;
} 
```

这里的运行时间以 1 年为界，但大多数时间运行时间约为纳秒。

说运行时是`O(n)`意味着存在一个常数`c`，使得运行时以 为界`c * n`，其中`n`测量输入的大小。例如，`n`通过以下算法在未排序的整数数组中查找特定整数的出现次数是`O(n)`：

```
int count(int *a, int n, int item) {
    int c = 0;
    for(int i = 0; i < n; i++) {
        if(a[i] == item) c++;
    }
    return c;
} 
```

这是因为我们必须遍历数组，一次检查每个元素。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2009-03-30T16:41:06.557

O(1) 不一定意味着“快速”。这意味着它花费的时间是恒定的，而**不是**基于函数输入的大小。常数可以是快的或慢的。O(n) 意味着函数所花费的时间将与函数输入的大小成正比变化，用 n 表示。同样，它可能快也可能慢，但随着 n 大小的增加，它会变慢。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2019-03-11T09:26:51.563

Here is a simple analogy; Imagine you are downloading movies online, with O(1), if it takes 5 minutes to download one movie, it will still take the same time to download 20 movies. So it doesn't matter how many movies you are downloading, they will take the same time(5 minutes) whether it's one or 20 movies. A normal example of this analogy is when you go to a movie library, whether you are taking one movie or 5, you will simply just pick them at once. Hence spending the same time.

However, with O(n), if it takes 5 minutes to download one movie, it will take about 50 minutes to download 10 movies. So time is not constant or is somehow proportional to the number of movies you are downloading.

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2009-03-30T16:25:35.877

它被称为[大 O 表示法](http://en.wikipedia.org/wiki/Big_O_notation)，描述了各种算法的搜索时间。

O(1) 意味着最坏情况下的运行时间是恒定的。在大多数情况下，这意味着您实际上不需要搜索集合，您可以立即找到要搜索的内容。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2009-03-30T16:26:17.857

“大 O 表示法”是表达算法速度的一种方式。`n`是算法正在处理的数据量。`O(1)`这意味着，无论有多少数据，它都会在恒定时间内执行。`O(n)`意味着它与数据量成正比。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2016-08-29T18:51:22.953

`O(1)`无论数据集 n 为何，始终同时执行。O(1) 的一个示例是 ArrayList 使用索引访问其元素。

`O(n)`也称为线性顺序，性能将线性增长，并与输入数据的大小成正比。O(n) 的一个示例是在随机位置插入和删除 ArrayList。由于随后在随机位置的每次插入/删除都会导致 ArrayList 中的元素向其内部数组左移以保持其线性结构，更不用说创建新数组和从旧数组复制元素新阵列会占用昂贵的处理时间，因此会损害性能。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-03-30T16:27:34.607

基本上，O(1) 意味着它的计算时间是恒定的，而 O(n) 意味着它将线性地取决于*输入*的大小 - 即遍历数组有 O(n) - 只是循环 - 因为它取决于数量项目，同时计算两个普通数之间的最大值有 O(1)。

维基百科也可能有帮助：[http ://en.wikipedia.org/wiki/Computational_complexity_theory](http://en.wikipedia.org/wiki/Computational_complexity_theory)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-03-30T16:36:56.427

区分 O(1) 和 O(n) 的最简单方法是比较数组和列表。

对于数组，如果你有正确的索引值，你可以立即访问数据。（如果你不知道索引并且必须遍历数组，那么它就不再是 O(1) 了）

对于列表，无论您是否知道索引，您总是需要遍历它。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-03-30T16:25:18.217

这意味着访问时间是恒定的。无论您是从 100 条记录还是 100,000 条记录中访问，检索时间都是相同的。

相反，O(n) 访问时间表明检索时间与您正在访问的记录数成正比。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-03-30T16:25:23.910

这意味着访问需要恒定的时间，即不依赖于数据集的大小。O(n) 意味着访问将线性地取决于数据集的大小。

O 也称为大 O。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-03-30T17:08:51.467

Cormen、Leiserson、Rivest 和 Stein 的《算法导论：第二版》在第 44 页上说

> 由于任何常数都是 0 次多项式，我们可以将任何常数函数表示为 Theta(n^0) 或 Theta(1)。然而，后一种表示法是一种轻微的滥用，因为不清楚哪个变量趋于无穷大。我们将经常使用符号 Theta(1) 来表示常数或关于某个变量的常数函数。...我们用 O(g(n))... 表示函数集 f(n) 使得存在正常数 c 和 n0 使得 0 <= f(n) <= c*g(n)对于所有 n >= n0。...请注意，f(n) = Theta(g(n)) 意味着 f(n) = O(g(n))，因为 Theta 表示法比 O 表示法强。

如果算法在 O(1) 时间内运行，则意味着渐近不依赖于任何变量，这意味着存在至少一个正常数，当乘以 1 时大于函数的渐近复杂度（~runtime）对于超过一定数量的 n 值。从技术上讲，这是 O(n^0) 时间。

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2010-01-08T18:56:50.397

O(1) 表示随机访问。在任何随机存取存储器中，访问任何位置的任何元素所花费的时间都是相同的。这里时间可以是任何整数，但唯一要记住的是在第 (n-1) 个或第 n 个位置检索元素所花费的时间将是相同的（即常数）。

而 O(n) 取决于 n 的大小。

* * *

## 回答 #16

> 赞同：-4
> 
> 时间：2012-07-27T08:21:43.687

在我看来，

O(1) 表示一次执行一个操作或指令的时间是一个，在算法的时间复杂度分析中为最佳情况。

# sql - SQL 存储过程中注释的性能影响

> ID：697941
> 
> 赞同：16
> 
> 时间：2009-03-30T16:27:04.627
> 
> 标签：sql, sql-server, performance, stored-procedures

最近在我的日常工作中被告知，关于我们的存储过程的任何评论都不能存在于存储过程中，而必须使用扩展属性。

过去我们用过这样的东西。

```
/*
 * NOTE: Auto-Generated Procedure DO NOT MODIFY
 */
CREATE PROCEDURE dbo.MyProc
AS
SELECT *
FROM MyTable
GO 
```

这样，任何人在 SSMS 中打开程序时都会看到注释，其他评论也存在于程序中以记录我们的流程。现在我不知道有任何性能/内存问题。但是，我们有些人坚持这样做。

我无法找到任何文档来证明或否认此类评论存在性能和/或内存问题。

所以我的问题是，有没有人知道任何可以证明或否认这一点的文件？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-30T16:31:54.147

它只会稍微减慢存储过程的编译速度，而且这种情况不应该经常发生。

基本上，这听起来像是在吓唬人。考虑到评论的有用程度（适度），我要求*有证据*表明评论会损害绩效。对我来说，这听起来像是一个荒谬的政策。

（任何时候有人声称性能是一个很好的一般规则 -*特别是*如果他们建议您为了假定的性能增益而牺牲可读性或其他一些积极属性时，要求提供证据。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-30T16:38:26.017

文本（包括注释）存储在 SQL 2005+ 中的 sys.sql_modules 中。所以它增加了系统表的大小。

在编译生成计划时，注释被忽略：它们是注释。就像任何合理的语言一样......？

但是，在某些情况下，[调试注释](http://social.msdn.microsoft.com/Forums/en-US/transactsql/thread/38591987-1ff2-4f5b-b1ee-1300c7c039cb/)显然仍然可以被解析并影响事物。

这是我不久前看到的，但忽略了它（并搜索了这个答案）。

# python - 使用 Python 解析 .h 文件以获取注释的简单方法？

> ID：697945
> 
> 赞同：4
> 
> 时间：2009-03-30T16:27:45.420
> 
> 标签：python, parsing, lexer

**如何使用Python**以简单的方式解析用**C编写的****.h**文件以获取**注释**和实体名称？

 ******我们假设进一步将内容写入已经开发的word文件。

源注释使用简单的标记样式规则进行格式化。注释标签用于轻松区分一个实体注释与其他实体注释和非文档注释。评论可以是多行形式。每个评论都直接关注实体定义：

```
//ENUM My comment bla bla bla bla bla bla bla bla bla bla bla bla bla bla bla
//     could be multi-line. Bla bla bla bla bla bla bla bla bla.
enum my_enum
{
    //EITEM My enum item 1.
    //      Just could be multi-line too.
    MY_ENUM_ITEM_1,

    //EITEM My enum item 2
    MY_ENUM_ITEM_2,
};

//STRUCT My struct
struct my_struct {

    //MEMBER struct member 1
    int m_1_;
};

//FUNC my function 1 description.
//     Could be multi-line also.
//INPUT  arg1 - first argument
//RETURN pointer to an allocated my_struct instance.
my_struct* func_1(int arg1); 
```

此解析的结果应该是代码和注释树。

如何在**不使用第三方库的情况下**快速完成？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-30T16:41:01.613

这已经完成了。好几次了。

这是一个用 Python 编写的 C 语言解析器。从这个开始。

[http://wiki.python.org/moin/SeeGramWrap](http://wiki.python.org/moin/SeeGramWrap)

其他解析器。

[http://wiki.python.org/moin/LanguageParsing](http://wiki.python.org/moin/LanguageParsing)

[http://nedbatchelder.com/text/python-parsers.html](http://nedbatchelder.com/text/python-parsers.html)

您可能可以下载任何 ANSI C Yacc 语法并将其重新加工成 PLY 格式，而不会有太多麻烦，并将其用作起点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-30T17:10:54.833

这是一个快速而肮脏的解决方案。它不会处理字符串中的注释，但因为这仅适用于不应该成为问题的头文件。

```
S_CODE,S_INLINE,S_MULTLINE = 范围 (3)
f = 打开 (sys.argv[1])
状态 = S_CODE
评论 = ''
i = iter (lambda: f.read (1), '')
而真：
    尝试：
        c = i.next ()
    除了停止迭代：
        休息
    如果状态 == S_CODE：
        如果 c == '/'：
            c = i.next ()
            如果 c == '*'：
                状态 = S_MULTLINE
            elif c == '/'：
                状态 = S_INLINE
    elif 状态 == S_INLINE：
        评论 += c
        如果 c == '\n'：
            状态 == S_CODE
    elif 状态 == S_MULTLINE：
        如果 c == '*'：
            c = i.next ()
            如果 c == '/'：
                评论 += '\n'
                状态 = S_CODE
            别的：
                评论 += '*%s' % c
        别的：
            评论 += c
打印评论

```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-30T16:34:05.857

也许[shlex 模块](http://docs.python.org/library/shlex.html)会做？

如果没有，还有一些更强大的替代方案： [http ://wiki.python.org/moin/LanguageParsing](http://wiki.python.org/moin/LanguageParsing)

# c# - 使用 C# 进行字符串连接

> ID：697950
> 
> 赞同：0
> 
> 时间：2009-03-30T16:30:21.153
> 
> 标签：c#, string

我有一个输入字符串：

“风险管理、投资组合管理、投资规划”

如何将此字符串转换为：

“风险管理”+“投资组合管理”+“投资规划”

谢谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-30T16:31:56.970

## 拆分和修剪

```
 // include linq library like this:
 // using System.Linq;
 // then

"test1, test2".Split(',').Select(o => o.Trim()); 
```

或者

```
"test1, test2".Split(',').Select(o => o.Trim()).ToArray(); // returns array 
```

和

```
"test1, test2".Split(',').Select(o => "\"" + o.Trim() + "\"")
.Aggregate((s1, s2) => s1 + " + " + s2);

// returns a string: "test1" + "test2" 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-30T16:32:38.513

使用`Split()`方法：

```
string[] phrases = s.Split(','); 
```

现在您有了一个包含每个逗号分隔值的字符串数组。

要删除空格，请`Trim()`在每个字符串上使用该方法（感谢 John Feminella）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-30T16:33:49.303

```
var results = from s in string.Split("risk management, portfolio management, investment planning", new char[] { ',' })
              select s.Trim(); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-30T16:34:42.983

你不能[`String.Split()`](http://msdn.microsoft.com/en-us/library/system.string.split.aspx)在你的情况下使用，因为你有一个逗号，然后是一个空格。所以你的字符串看起来像 { `"risk management"`, `" portfolio management"`, `" investment planning"`}。相反，使用[`Regex.Split`](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regex.split.aspx)：

```
string[] investmentServices = Regex.Split(inputString, ", "); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-30T16:33:35.063

如果要拆分输入，可以使用 string.Split，使用逗号作为分隔符，或者更好的 "," 考虑逗号后的空格，

```
string[] array = inputString.Split(", "); 
```

但是，您可能希望将字符串中的逗号替换为加号，这也是您可以实现的方法：

```
inputString = inputString.Replace(", ", "\" + \""); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-30T16:45:26.327

您的问题不清楚您是要替换`','`for`'+'`还是简单的`split`.

以下是两种可能性：

```
string s = "risk management, portfolio management, investment planning";

string transformedString = s.Replace(", ", "\" + \"");

string[] parts = s.Split(new [] {", "}, StringSplitOptions.None); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-30T16:34:21.690

实际上，您似乎正在尝试执行拆分，而不是串联。

如果您希望获取该输入字符串并将其转换为包含“风险管理”、“投资组合管理”和“投资计划”的三个字符串，则使用`string.Split(inputString, ',')`，然后在使用时从结果数组中修剪每个字符串。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-30T16:39:40.600

你的意思不是很清楚。如果您需要访问 CSV 值，那么这将分别输出每个值...

```
string input = "risk management, portfolio management, investment planning";
string[] words = text.Split(new Char[] {','});
foreach(string word in words)
{
  Console.WriteLine(word.Trim());
}
//risk management
//portfolio management
//investment planning 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-31T04:15:49.617

回复 Jhonny D. Cano（对不起，没有 50 代表发表评论。）

您的第一个建议

> 字符串[] 数组 = inputString.Split(", ");

不起作用，因为您不能在字符串上拆分。最接近的可能重载是 char[]，因此您必须将其写为...

> 字符串[] 数组 = inputString.Split(", ".ToCharArray());

# delphi - 保存和堆栈溢出

> ID：697972
> 
> 赞同：0
> 
> 时间：2009-03-30T16:34:23.873
> 
> 标签：delphi, pointers, save, delphi-7, stack-overflow

我在 Delphi 中保存不同的大型数据库类型时遇到问题。它包含一个 TItem 的数组 [1..3500]，而 TItem 又包含两个数组 [1..50] 和 [1..20]。除非我将变量设置为指针并使用下面的 GetMem、FreeMem 命令，否则我会出现堆栈溢出，但是我无法保存它。代码如下。

```
procedure TDatabase.SaveDB;  
var  
 TempDB: ^TSaveDB;  
 K, X: integer;  
 sComment, sTitle, sComposer, sISDN, sCategory: string;  
begin  
GetMem(TempDB, SizeOf(TSaveDB));  

TempDB.CatCount := fCategoryCount;  
TempDB.ItemCount := fItemCount;  

for K := 1 to fCategoryCount do  
 TempDB.Categories[K] := fCategories[K];  

for K := 1 to fItemCount do  
 begin  
  fItems[K].ReturnSet(sTitle, sComposer, sCategory, sISDN, sComment);  
  with TempDB.Items[K] do  
   begin  
    Title := sTitle;  
    Composer := sComposer;  
    Category := sCategory;  
    ISDN := sISDN;  
   end;  

  TempDB.Items[K].Comments[1] := Copy(sComment, 1, 255);  
   Delete(sComment, 1, 255);  
  TempDB.Items[K].Comments[2] := Copy(sComment, 1, 255);  
   Delete(sComment, 1, 255);  
  TempDB.Items[K].Comments[3] := Copy(sComment, 1, 255);  
   Delete(sComment, 1, 255);  
  TempDB.Items[K].Comments[4] := Copy(sComment, 1, 255);  
   Delete(sComment, 1, 255);  

  TempDB.Items[K].KeyWCount := fItems[K].GetKeyCount;  

  for X := 1 to fItems[K].GetKeyCount do  
   TempDB.Items[K].Keywords[X] := fItems[K].GetKeywords(X);  
 end;

AssignFile(DBSave, fSaveName);  
 Rewrite(DBSave);  
  Write(DBSave, TempDB);  
Closefile(dBSave);  

FreeMem(TempDB, sizeof(TSaveDB));  
end; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T17:01:38.160

使用 GetMem 或 SetLength 或 TList/TObjectList 并一次将一个 TSaveDB 写入文件。或者更改文件类型并使用 BlockWrite 一次将其全部写入。甚至更好：使用 TFileStream。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T16:57:49.433

您的问题出在“写”语句中。用任意指针做事会导致各种奇怪的行为。如果你使用 TFileStream 而不是当前的方法重写它，你会容易得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-31T04:07:42.023

扩展梅森的答案：

*永远不要*读或写指针，句号。要想从中获得任何合理的结果将需要很大的运气，而在现实世界中，当您不只是再次运行程序时，成功的几率会从无穷小降到零。

相反，您需要读取和写入指针指向的内容。

另请注意，任何长度未在声明中命名的字符串都是指针，除非您在使“字符串”变为“字符串 [255]”的兼容模式下运行——此模式的存在仅用于与非常当这是我们仅有的字符串时编写的旧代码。

由于您似乎只是将整个内容写出来，因此没有理由玩具有固定大小记录的游戏。只需将每个字段写入流，在写入字符串本身之前写入字符串的长度，以便您可以正确加载它。该文件将更小，并且没有任何内容被截断。

此外，正如他所说，使用 tFileStream。旧格式用于保留在磁盘上的记录文件，在这种情况下没有理由使用它。

# c# - 如何舍入小数输出？

> ID：697977
> 
> 赞同：2
> 
> 时间：2009-03-30T16:35:55.757
> 
> 标签：c#, decimal-point

使用 C#，我想将小数格式化为仅显示两个小数位，然后我将取该小数并将其减去另一个小数。我希望能够做到这一点，而不必先将其转换为字符串进行格式化，然后再将其转换回小数。很抱歉，我忘记指定这一点，但我不想四舍五入，我只想去掉最后一个小数点。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-30T16:46:33.207

如果不想四舍五入，可以使用 Decimal.Truncate。不幸的是，它只能截断所有小数。要解决这个问题，您可以乘以 100，截断并除以 100，如下所示：

```
decimal d = ...;
d = Decimal.Truncate(d * 100) / 100; 
```

如果你做的次数足够多，你可以创建一个扩展方法

```
public static class DecimalExtensions
{
  public static decimal TruncateDecimal(this decimal @this, int places)
  {
    int multipler = (int)Math.Pow(10, places);
    return Decimal.Truncate(@this * multipler) / multipler;
  }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-30T16:41:46.417

您可以使用：`Math.Round(number,2);`将数字四舍五入到小数点后两位。

有关示例，请参见[Math.Round 的此特定重载](http://msdn.microsoft.com/en-us/library/zy06z30k.aspx)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-30T16:38:52.037

[Math.Round 方法（十进制，Int32）](http://msdn.microsoft.com/en-us/library/zy06z30k.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-30T16:39:00.337

你不想格式化它，但要舍入它。试试 Math.Round 函数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-30T16:39:22.957

看看[Math.Round](http://msdn.microsoft.com/en-us/library/system.math.round.aspx)

# c - 用于计算无符号字符中“1”位数的 C 代码

> ID：697978
> 
> 赞同：9
> 
> 时间：2009-03-30T16:36:49.937
> 
> 标签：c, hammingweight

我需要 C 代码来返回 C 中 unsigned char 中 1 的数量。如果不明显，我需要解释为什么它可以工作。我发现了很多 32 位数字的代码，但对于 unsigned char 却没有多少。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-30T17:07:42.437

```
const unsigned char oneBits[] = {0,1,1,2,1,2,2,3,1,2,2,3,2,3,3,4};

unsigned char CountOnes(unsigned char x)
{
    unsigned char results;
    results = oneBits[x&0x0f];
    results += oneBits[x>>4];
    return results
} 
```

有一个数组知道 0 到 15 的位数。将每个半字节的结果相加。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-30T16:42:35.070

相同的代码适用于无符号字符。循环测试它们的所有位。看到[这个](http://graphics.stanford.edu/~seander/bithacks.html#CountBitsSetNaive)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-30T17:28:05.103

[HACKMEM](http://www.inwap.com/pdp10/hbaker/hakmem/hacks.html#item167)在 3 次操作中有这个算法（大致翻译为 C）：

```
bits = (c * 01001001001ULL & 042104210421ULL) % 017; 
```

（`ULL`是强制 64 位算术。它是需要的，只是勉强......这个计算需要 33 位整数。）

实际上，您可以用 替换第二个常量`042104210021ULL`，因为您只计算 8 位，但它看起来不太对称。

这是如何运作的？逐位考虑`c`，并记住`(a + b) % c = (a % c + b % c) % c`, 和`(a | b) == a + b`iff `(a & b) == 0`。

```
 (c * 01001001001ULL & 042104210421ULL) % 017
  01   01001001001                01         1
  02   02002002002       02000000000         1
  04   04004004004          04000000         1
 010  010010010010            010000         1
 020  020020020020               020         1
 040  040040040040      040000000000         1  # 040000000000 == 2 ** 32
0100 0100100100100        0100000000         1
0200 0200200200200           0200000         1 
```

如果您没有可用的 64 位算术，您可以分成`c`半字节并执行每一半，进行 9 次操作。这仅需要 13 位，因此使用 16 位或 32 位算术将起作用。

```
bits = ((c & 017) * 0421 & 0111) % 7 + ((c >> 4) * 0421 & 0111) % 7;

(c * 0421 & 01111) % 7
 1   0421      01    1
 2  01042   01000    1
 4  02104    0100    1
 8  04210     010    1 
```

例如，如果`c == 105 == 0b11001001`，

```
c == 0100
   |  040
   |  010
   |   01 == 0151
* 01001001001001ULL == 0100100100100
                     |  040040040040
                     |  010010010010
                     |   01001001001 == 0151151151151
& 0421042104210421ULL ==  0100000000
                       | 04000000000
                       |      010000
                       |          01 ==   04100010001
% 017                                == 4

c & 017      ==            8 | 1           ==                   011
011 * 0421   ==     8 * 0421 | 1 * 0421    == 04210 | 0421 == 04631
04631 & 0111 == 04210 & 0111 | 0421 & 0111 ==   010 | 01   ==   011
011 % 7      == 2

c >> 4       ==            4 | 2            ==                     06
06 * 0421    ==     4 * 0421 | 2 * 0421     == 02104 | 01042 == 03146
03146 & 0111 == 02104 & 0111 | 01042 & 0111 ==  0100 | 01000 == 01100
01100 % 7    == 2

2 + 2 == 4 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-30T16:42:35.837

请参阅 bit twiddling hacks 页面： http: [//graphics.stanford.edu/~seander/bithacks.html#CountBitsSetKernighan](http://graphics.stanford.edu/~seander/bithacks.html#CountBitsSetKernighan)

有很多很好的解决方案。

此外，这个函数在其最简单的实现中是相当微不足道的。你应该花时间学习如何做到这一点。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-30T16:43:19.967

对于像 unsigned char 这样小的整数，您可以使用小型查找表获得最佳性能。

我知道你提到的人口计数算法。它们通过对小于寄存器中存储的整数的多个字进行算术运算来工作。

这种技术称为 SWAR ( [http://en.wikipedia.org/wiki/SWAR](http://en.wikipedia.org/wiki/SWAR) )。

有关更多信息，我建议您查看骇客喜悦网站：www.hackersdelight.org。他有示例代码并写了一本书详细解释了这些技巧。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-30T16:50:53.977

正如已经回答的那样，计数位的标准方法也适用于无符号字符。

例子：

```
 unsigned char value = 91;
int bitCount = 0;
while(value > 0)
{
    if ( value & 1 == 1 ) 
        bitCount++;
    value >>= 1;
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-30T16:43:56.143

unsigned char 是一个“数字”，就像 32 位浮点数或整数是一个“数字”一样，编译器认为它们代表的是什么变化。

如果你把一个 char 想象成它的位：

01010011（8位）；

您可以通过执行以下操作来计算设置位：

取值，假设 x，取 x % 2，余数将为 1 或 0。也就是说，取决于 char 的字节序，最左边或最右边。将余数累积在一个单独的变量中（这将是设置位的结果数量）。

然后 >>（右移）1 位。

重复，直到 8 位已被移位。

从我的伪代码实现 c 代码应该很简单，但基本上

```
public static int CountSetBits(char c)
{
    int x = 0;
    int setBits = 0;
    while (x < 7)
    {
       setBits = setBits + c % 2;
       c = c >> 1;
       x = x + 1;
    }
} 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2016-03-15T19:29:15.510

根据 Ephemient 的帖子，我们有没有分支的 8 位版本。它是十六进制表达式。

```
typedef unsigned char       UINT8;
typedef unsigned short      UINT16;
typedef unsigned long long  UINT64;
int hammingWeight8( const UINT8& c)
{
    return ( c* 0x8040201ULL & 0x11111111)%0xF;
} 
```

应用两次，我们有一个 16bits 的版本，需要 9 次操作。

```
int hammingWeight16( const UINT16& c)
{
    return ((c & 0xFF)* 0x8040201ULL & 0x11111111)%0xF + 
             ((c >> 8)* 0x8040201ULL & 0x11111111)%0xF;
} 
```

在这里，我编写了一个 16 位版本的变体，它需要 64 位寄存器和 11 个操作。它似乎并不比上一个好，但它只是使用了 1 模运算。

```
int hammingWeight16( const UINT16& c)
{
    UINT64  w;
    w= (((( c* 0x8000400020001ULL)>> 3) & 0x1111111111111111)+14)%0xF;
    return (c!=0)*(w+1+(c==0xFFFF)*15);
} 
```

# asp.net - 表单身份验证 - 如何验证非活动用户的用户名和密码？

> ID：697996
> 
> 赞同：2
> 
> 时间：2009-03-30T16:39:41.210
> 
> 标签：asp.net, forms-authentication

我正在为允许用户注册但不活动的应用程序使用表单身份验证。我们将通过蜗牛邮件发送激活码（长篇故事），用户可以返回该信息并激活他们的帐户。

我想创建一个页面，用户可以返回并输入他们的用户名、密码和生成的密钥来激活帐户。我存储在另一个表中的密钥，我计划生成它。我在使用非活动帐户验证用户名和密码时遇到问题。我试过 Membership.ValidateUser(username,password) 但它失败了，但如果我激活帐户，它就可以工作。

关于如何检查的想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-30T16:42:46.850

先激活账户。

如果您在电子邮件中向他们发送激活码，则有一个匿名访问页面，该页面从电子邮件接收激活码（可能通过查询字符串），激活帐户，并将他们重定向到激活表单身份验证的登录页面（假设用户名和密码已经创建）。

如果访问代码无效且失败，您可以选择停用该帐户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-30T16:45:37.577

我不会设置 IsActive = false。那是为了禁用帐户，防止任何类型的登录。相反，我没有看到让他们能够登录的问题。我会使用会员角色来指定何时验证用户。即“已验证”。

如果他们尚未激活帐户并尝试登录，您只需检查他们是否具有已验证角色。如果没有，将他们重定向到“您的帐户尚未激活。请等待蜗牛邮件”的页面。或“请在下方输入您的验证码”。信息。

当他们最终从蜗牛邮件中输入正确的验证码时，您只需将他们添加到已验证角色。

这使您可以控制允许他们登录并“检查”他们的帐户状态。并且，解决了您的 IsActive 问题。

# sql - 用于生成给定数据的 SQL 查询

> ID：697997
> 
> 赞同：-1
> 
> 时间：2009-03-30T16:39:51.520
> 
> 标签：sql

我有一个名为 student 的表，有两列：

```
JoinDate DATE
EmployeeName STRING 
```

表格内容如下：

```
EmployeeName    | JoinDate
----------------+-----------------
jaison          | 1-jan-2008
robin           | 2-feb-2008
binoy           | 3-mar-2008
rahul           | 4-feb-2008 
```

我希望根据此表准备以下输出：包含 4 列的表，名称为 jan、feb、mar、april。在这些月份中的每个月份下方，计数为 1、2、1、0。这些计数代表当月加入的员工人数（1 月 1 日员工、2 月 2 日员工、3 月 1 日员工、4 月 0 日员工）

你能给我所需的 SQL 查询吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-31T05:06:55.673

这会奏效，有人知道其他方法吗？

```
SELECT Sum([1]) AS Jan, Sum([2]) AS Feb, Sum([3]) AS Mar, Sum([4]) as Apr,
       Sum([5]) as May, Sum([6]) as Jun, Sum([7]) as Jul, Sum([8]) as Aug,
       Sum([9]) as Sep, Sum([10]) as Oct, Sum([11]) as Nov, Sum([12]) as Dec
FROM (SELECT Month(Join_Date) as Mon FROM student) ps
PIVOT
    (Count(Mon) FOR Mon IN 
        ([1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12])
    ) AS pvt
GROUP BY [1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T16:48:42.373

以下查询将为您提供一个包含两列（月份和总计）的结果集，其中月份是月份名称，总计是当月加入的人数：

```
SELECT MONTHNAME(`join_date`) AS `month`, COUNT(*) AS `total` GROUP BY MONTHNAME(`join_date`); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-02T06:18:35.907

这也将起作用

```
Create table [sample] (Employeename varchar(50), join_date smalldatetime)
insert into [sample] values('Ganesh','01/26/2008')
insert into [sample] values('Ramesh','02/26/2008')
insert into [sample] values('Dinesh','03/26/2008')
insert into [sample] values('Suresh','01/26/2008')

Select * from [sample]

SELECT 'Students Admission by Monthwise' ,[1] AS january,[2] AS february,[3] AS March,[4] AS April
FROM( 
        SELECT  Employeename,
                Month(join_date) monthname 
        FROM    [sample]
    ) A
PIVOT
(
    COUNT(Employeename)
    FOR monthname in
        ([1],[2],[3],[4])
) AS PVT 
```

# .net - 更改类型化数据集的连接字符串

> ID：697998
> 
> 赞同：0
> 
> 时间：2009-03-30T16:40:17.353
> 
> 标签：.net, connection-string, strongly-typed-dataset

我在一个项目中创建了一个类型化的数据集，并将其移至另一个项目。它在设置文件中创建的原始连接字符串类似于“myconnectionstring2”。当我将它移动到新项目时，我进入项目设置文件并创建了一个名为“myconnectionstring”的连接字符串。我试图让键入的数据集使用我的新连接字符串，但生成的代码仍在寻找 "myconnectionstring2" 。在哪里更改设置？我似乎无法在类型化的数据集属性中找到它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-30T16:46:02.987

我找到了。您必须单击设计器中的“xxxTableAdapter”才能访问连接字符串设置。您可以为数据集中的每个表适配器指定不同的连接字符串。我的问题是我正在寻找一个数据集/顶级连接字符串属性。*************************