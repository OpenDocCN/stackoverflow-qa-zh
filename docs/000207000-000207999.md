# StackOverflow 问答 000207000-000207999

# python - 类属性和实例属性有什么区别？

> ID：207000
> 
> 赞同：144
> 
> 时间：2008-10-16T00:23:41.787
> 
> 标签：python, attributes, member-variables

之间是否有任何有意义的区别：

```
class A(object):
    foo = 5   # some default value 
```

对比

```
class B(object):
    def __init__(self, foo=5):
        self.foo = foo 
```

如果您要创建大量实例，这两种样式在性能或空间要求上是否有任何差异？阅读代码时，您是否认为这两种样式的含义有很大不同？

* * *

## 回答 #1

> 赞同：158
> 
> 时间：2008-10-16T01:26:53.000

存在显着的*语义*差异（超出性能考虑）：

*   **当在实例上定义属性时**（这是我们通常所做的），可以引用多个对象。**每个都获得该属性的一个完全独立的版本**。
*   **当在 class 上定义属性时**，只有一个底层对象被引用，因此如果对该类的不同实例的操作都尝试设置/（追加/扩展/插入/等）该属性，则：
    *   如果属性是**内置类型**（如 int、float、boolean、string），则对一个对象的操作将覆盖（clobber）该值
    *   如果属性是**可变类型**（如列表或字典），我们将得到不必要的泄漏。

例如：

```
>>> class A: foo = []
>>> a, b = A(), A()
>>> a.foo.append(5)
>>> b.foo
[5]
>>> class A:
...  def __init__(self): self.foo = []
>>> a, b = A(), A()
>>> a.foo.append(5)
>>> b.foo    
[] 
```

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2008-10-16T08:16:28.370

不同之处在于类上的属性由所有实例共享。实例上的属性对该实例是唯一的。

如果来自 C++，则类上的属性更像是静态成员变量。

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2015-12-07T03:59:08.480

这是一篇非常好的[帖子](http://www.toptal.com/python/python-class-attributes-an-overly-thorough-guide)，总结如下。

```
class Bar(object):
    ## No need for dot syntax
    class_var = 1

    def __init__(self, i_var):
        self.i_var = i_var

## Need dot syntax as we've left scope of class namespace
Bar.class_var
## 1
foo = MyClass(2)

## Finds i_var in foo's instance namespace
foo.i_var
## 2

## Doesn't find class_var in instance namespace…
## So look's in class namespace (Bar.__dict__)
foo.class_var
## 1 
```

并以视觉形式

[![在此处输入图像描述](https://i.stack.imgur.com/zRHzx.png)](https://i.stack.imgur.com/zRHzx.png)

**类属性赋值**

*   如果通过访问类来设置类属性，它将覆盖*所有实例的值*

    ```
    foo = Bar(2)
    foo.class_var
    ## 1
    Bar.class_var = 2
    foo.class_var
    ## 2 
    ```

*   如果通过访问实例来设置类变量，它将*仅覆盖该实例*的值。这实质上覆盖了类变量并将其转换为一个实例变量，直观地，*仅适用于该实例*。

    ```
    foo = Bar(2)
    foo.class_var
    ## 1
    foo.class_var = 2
    foo.class_var
    ## 2
    Bar.class_var
    ## 1 
    ```

**你什么时候使用类属性？**

*   *存储常量*。由于类属性可以作为类本身的属性进行访问，因此通常可以很好地使用它们来存储类范围的、特定于类的常量

    ```
    class Circle(object):
         pi = 3.14159

         def __init__(self, radius):
              self.radius = radius   
        def area(self):
             return Circle.pi * self.radius * self.radius

    Circle.pi
    ## 3.14159
    c = Circle(10)
    c.pi
    ## 3.14159
    c.area()
    ## 314.159 
    ```

*   *定义默认值*。作为一个简单的例子，我们可以创建一个有界列表（即，一个只能包含一定数量或更少元素的列表）并选择默认上限为 10 个项目

    ```
    class MyClass(object):
        limit = 10

        def __init__(self):
            self.data = []
        def item(self, i):
            return self.data[i]

        def add(self, e):
            if len(self.data) >= self.limit:
                raise Exception("Too many elements")
            self.data.append(e)

     MyClass.limit
     ## 10 
    ```

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2014-10-29T23:32:51.803

由于此处评论中的人和标记为 dups 的其他两个问题中的人们似乎都以同样的方式对此感到困惑，我认为值得在[Alex Coventry 的](https://stackoverflow.com/a/207128/908494).

Alex 正在分配一个可变类型的值，如列表，这一事实与事物是否共享无关。我们可以通过`id`函数或`is`运算符看到这一点：

```
>>> class A: foo = object()
>>> a, b = A(), A()
>>> a.foo is b.foo
True
>>> class A:
...     def __init__(self): self.foo = object()
>>> a, b = A(), A()
>>> a.foo is b.foo
False 
```

[（如果你想知道为什么我使用`object()`而不是，说，`5`那是为了避免遇到我不想在这里讨论的另外两个问题；由于两个不同的原因，完全单独创建`5`的 s 最终可能成为number 的相同实例`5`。但完全单独创建`object()`的 s 不能。）]

* * *

那么，为什么`a.foo.append(5)`在 Alex 的示例中会影响`b.foo`，而`a.foo = 5`在我的示例中却没有？好吧，试试`a.foo = 5`Alex 的例子，注意它也不影响`b.foo`那里*。*

`a.foo = 5`只是成为`a.foo`一个名字`5`。这不会影响`b.foo`, 或任何其他`a.foo`用于引用旧值的名称。* 我们正在创建一个隐藏类属性的实例属性有点棘手，** 但是一旦你明白了，没有什么复杂的了发生在这里。

* * *

希望现在 Alex 使用列表的原因很明显：您可以更改列表这一事实意味着更容易显示两个变量命名同一个列表，也意味着在实际代码中了解您是否有两个列表或同一个列表的两个名称。

* * *

[* 来自像 C++ 这样的语言的人的困惑是，在 Python 中，值不存储在变量中。值本身就存在于值域中，变量只是值的名称，而赋值只是为值创建一个新名称。如果有帮助，请将每个 Python 变量视为 a`shared_ptr<T>`而不是 a `T`。]

[** 有些人通过使用类属性作为实例可能设置或未设置的实例属性的“默认值”来利用这一点。这在某些情况下可能很有用，但也可能令人困惑，所以要小心。]

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-06-22T08:27:20.127

还有一种情况。

类和实例属性是**Descriptor**。

```
# -*- encoding: utf-8 -*-

class RevealAccess(object):
    def __init__(self, initval=None, name='var'):
        self.val = initval
        self.name = name

    def __get__(self, obj, objtype):
        return self.val

class Base(object):
    attr_1 = RevealAccess(10, 'var "x"')

    def __init__(self):
        self.attr_2 = RevealAccess(10, 'var "x"')

def main():
    b = Base()
    print("Access to class attribute, return: ", Base.attr_1)
    print("Access to instance attribute, return: ", b.attr_2)

if __name__ == '__main__':
    main() 
```

以上将输出：

```
('Access to class attribute, return: ', 10)
('Access to instance attribute, return: ', <__main__.RevealAccess object at 0x10184eb50>) 
```

**通过类或实例访问相同类型的实例返回不同的结果！**

我在[c.PyObject_GenericGetAttr 定义](https://docs.python.org/2/c-api/object.html#c.PyObject_GenericGetAttr)中找到了，还有一篇很棒[的帖子](https://medium.com/stepping-through-the-cpython-interpreter/how-does-attribute-access-work-d19371898fee)。

## 解释

> 如果在组成的类的字典中找到该属性。对象 MRO，然后检查正在查找的属性是否指向数据描述符（这只不过是实现`__get__`和`__set__`方法的类）。如果是，则通过调用`__get__`数据描述符的方法来解析属性查找（第 28-33 行）。

# linux - 什么是 tcpdump 单线转储与给定子字符串匹配的 TCP 流？

> ID：207001
> 
> 赞同：2
> 
> 时间：2008-10-16T00:24:45.340
> 
> 标签：linux, unix, networking, tcpdump

是否有一个快速的 tcpdump 单行​​程序可以打印出与特定子字符串匹配的 TCP 流——或者，如果这并不容易，那么只打印出与子字符串匹配的单个 TCP*数据包*怎么样？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-16T01:23:48.920

最好的选择是使用[ngrep](http://ngrep.sourceforge.net/)而不是 tcpdump。Ngrep 旨在完全满足您的需求。

# php - 如何在 PHP 中使用 switch case 'or'

> ID：207002
> 
> 赞同：254
> 
> 时间：2008-10-16T00:25:14.140
> 
> 标签：php, switch-statement, case

有没有办法在 PHP 开关中使用“或”运算符或等效运算符？

例如，像这样：

```
switch ($value) {

    case 1 || 2:
        echo 'the value is either 1 or 2';
        break;
} 
```

* * *

## 回答 #1

> 赞同：546
> 
> 时间：2008-10-16T00:26:55.370

```
switch ($value)
{
    case 1:
    case 2:
        echo "the value is either 1 or 2.";
    break;
} 
```

这被称为“穿过”案例块。该术语存在于大多数实现 switch 语句的语言中。

* * *

## 回答 #2

> 赞同：146
> 
> 时间：2012-11-29T20:31:35.587

如果您必须使用`||`with`switch`那么您可以尝试：

```
$v = 1;
switch (true) {
    case ($v == 1 || $v == 2):
        echo 'the value is either 1 or 2';
        break;
} 
```

如果不是，您的首选解决方案将是

```
switch($v) {
    case 1:
    case 2:
        echo "the value is either 1 or 2";
        break;
} 
```

问题是这两种方法在处理大型案件时都效率不高......想象一下`1`这`100`会完美地工作

```
$r1 = range(1, 100);
$r2 = range(100, 200);
$v = 76;
switch (true) {
    case in_array($v, $r1) :
        echo 'the value is in range 1 to 100';
        break;
    case in_array($v, $r2) :
        echo 'the value is in range 100 to 200';
        break;
} 
```

* * *

## 回答 #3

> 赞同：58
> 
> 时间：2008-10-16T01:55:55.657

我不会重新发布其他答案，因为它们都是正确的，但我只是补充一点，您不能将 switch 用于更“复杂”的语句，例如：测试一个值是否“大于 3”，“在 4 到 6" 之间，等等。如果你需要做这样的事情，坚持使用`if`语句，或者如果有特别强烈的需要，`switch`那么可以从后到前使用它：

```
switch (true) {
    case ($value > 3) :
        // value is greater than 3
    break;
    case ($value >= 4 && $value <= 6) :
        // value is between 4 and 6
    break;
} 
```

但正如我所说，我个人会在`if`那里使用一个声明。

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2012-12-06T06:17:15.277

在本文中尝试以下示例：http: [//phpswitch.com/](http://phpswitch.com/)

**可能的开关情况：**

（一世）。***一个简单的 switch 语句***

switch 语句奇妙而神奇。它是一种语言，允许您在值的不同选项之间进行选择，并根据设置的值运行不同的代码段。

每个可能的选项都由 switch 语句中的 case 给出。

**例子 ：**

```
switch($bar)
{
    case 4:
        echo "This is not the number you're looking for.\n";
        $foo = 92;
} 
```

(二)。***分隔代码块***

switch 的主要警告是每个 case 都会运行到下一个 case，除非你用 break 来停止它。如果将上面的简单案例扩展到涵盖案例 5：

**例子 ：**

```
case 4:
    echo "This is not the number you're looking for.\n";
    $foo = 92;
    break;

case 5:
    echo "A copy of Ringworld is on its way to you!\n";
    $foo = 34;
    break; 
```

(iii)。***对多个案例使用失败***

因为 switch 会一直运行代码直到找到中断，所以很容易采用 fallthrough 的概念并在多个情况下运行相同的代码：

**例子 ：**

案例2：

```
case 3:
case 4:
    echo "This is not the number you're looking for.\n";
    $foo = 92;
    break;

case 5:
    echo "A copy of Ringworld is on its way to you!\n";
    $foo = 34;
    break; 
```

(四)。***高级切换：条件案例***

PHP 的开关不仅允许您打开特定变量的值：您可以使用任何表达式作为其中一种情况，只要它为要使用的情况提供值。例如，这是一个使用 switch 编写的简单验证器：

**例子 ：**

```
switch(true)
{
    case (strlen($foo) > 30):
        $error = "The value provided is too long.";
    $valid = false;
    break;

    case (!preg_match('/^[A-Z0-9]+$/i', $foo)):
        $error = "The value must be alphanumeric.";
    $valid = false;
    break;

    default:
    $valid = true;
    break;
} 
```

我认为这可以帮助您解决问题。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2008-10-16T00:27:41.483

尝试

```
switch($value) {
    case 1:
    case 2:
        echo "the value is either 1 or 2";
        break;
} 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2012-12-05T14:51:36.780

我建议你通过*[开关](http://php.net/manual/en/control-structures.switch.php)*（手动）。

```
switch ($your_variable)
{
    case 1:
    case 2:
        echo "the value is either 1 or 2.";
    break;
} 
```

**解释**

就像您要为其执行单个语句的值一样，您可以将它放在没有*中断*的情况下，就像直到或除非找到中断一样。它将继续执行代码，如果发现*中断*，它将从*开关*盒中出来。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2020-11-26T17:20:04.703

## 匹配表达式 (PHP 8)

PHP 8[引入](https://www.php.net/manual/en/control-structures.match.php)了一个新的`match`表达式，它类似于`switch`但具有更短的语法和以下区别：

*   不需要`break`陈述
*   使用逗号组合条件
*   返回一个值
*   有严格的类型比较
*   要求比较详尽（如果没有找到匹配项，`UnhandledMatchError`将抛出 a）

例子：

```
match ($value) {
  0 => '0',
  1, 2 => "1 or 2",
  default => "3",
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-12-03T10:17:14.580

使用此代码：

```
switch($a) {
    case 1:
    case 2:
        .......
        .......
        .......
        break;
} 
```

块被调用为 1 和 2。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-12-04T17:42:11.803

请注意，您还可以使用闭包将开关的结果（使用早期返回）分配给变量：

```
$otherVar = (static function($value) {
    switch ($value) {
        case 0:
            return 4;
        case 1:
            return 6;
        case 2:
        case 3:
            return 5;
        default:
            return null;
    }
})($i); 
```

当然，这种做法已经过时，因为这正是[_dom93](https://stackoverflow.com/a/65026643/633864)答案中指出的新 PHP 8[匹配函数的目的。](https://www.php.net/manual/en/control-structures.match.php)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-12-05T06:46:39.750

```
switch ($value) 
{
   case 1:
   case 2:
      echo 'the value is either 1 or 2';
   break;
} 
```

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2018-04-03T07:39:27.887

[http://php.net/manual/en/control-structures.switch.php](http://php.net/manual/en/control-structures.switch.php) 示例

```
$today = date("D");

    switch($today){

        case "Mon":

        case "Tue":

            echo "Today is Tuesday or Monday. Buy some food.";

            break;

        case "Wed":

            echo "Today is Wednesday. Visit a doctor.";

            break;

        case "Thu":

            echo "Today is Thursday. Repair your car.";

            break;

        default:

            echo "No information available for that day.";

            break;

    } 
```

* * *

## 回答 #12

> 赞同：-4
> 
> 时间：2011-06-11T01:14:48.553

最好的方法可能是请求。此外，这可以更容易和清晰地使用。

例子：

```
<?php 
$go = $_REQUEST['go'];
?>
<?php if ($go == 'general_information'){?>
<div>
echo "hello";
}?> 
```

而不是使用不能很好地与 PHP 一起工作的函数，尤其是当您在 HTML 中使用 PHP 时。

# c# - 用于处理扫描问卷的 .Net 组件？

> ID：207011
> 
> 赞同：0
> 
> 时间：2008-10-16T00:27:21.717
> 
> 标签：c#, image-processing, components, image-scanner

我希望将扫描作为一种从我的桌面应用程序（反馈管理应用程序）中收集纸质问卷反馈的方式。

问卷使用勾号或十字标记以及自由文本完成。问卷是使用应用程序的设计器设计的。

我正在寻找一个能够挑选出响应并允许我将它们与问题编号联系起来的组件，这样我就可以将反馈保存到数据库中，进行汇总和分析。

查看一些调查软件公司，他们似乎通过现成的扫描软件（如 Remark [http://www.gravic.com/remark/officeomr/](http://www.gravic.com/remark/officeomr/) ）提供扫描功能。除了成本问题之外，是否有理由更喜欢 Remark 之类的东西而不是（某种）通过使用组件来滚动你自己的东西？

非常感谢您对 .Net 组件以及 Remark 类型软件的体验的想法。

非常感谢

AbsFabs

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T03:51:59.590

最终，成本*是*这里的重要因素，它有多种形式。

*   获取组件与构建自己的组件的成本
*   维护组件的成本与持续的许可/合同成本
*   尝试解决已购买组件中的缺陷的时间成本
*   ETC

真的，任何赞成或反对的关系都与成本有关。主要的权衡是采购成本与灵活性。第三方解决方案几乎总是更便宜，但从来没有真正像您自己构建的解决方案那样灵活。您必须为通过自己的解决方案获得的收益分配某种价值，并将其与商业解决方案的价格进行权衡。（你当然可以为自己做这件事的学习体验赋予价值）。

我不知道您是在为营利性公司、非营利性公司工作，还是这是一个学术项目。但无论如何，将时间或金钱花在经济上效率较低的解决方案上会花费你金钱或机会（能够转移到另一个项目，或者在这个项目中投入更多）。

我对 Remark 没有亲身经历，但多次面临这个决定。根据我的经验，我通常会发现，来自知名开发商的商业组件完全符合我的需求，比本土解决方案更有价值。您将获得经过良好测试的代码，这些代码将直接放入您的应用程序中，让您继续迎接下一个挑战。

# c# - 如何使用 c# 打开 google chome 窗口（仅页面）

> ID：207014
> 
> 赞同：1
> 
> 时间：2008-10-16T00:28:58.453
> 
> 标签：c#

我想使用谷歌浏览器作为控件。

我认为 Enso 这样做是因为他们的文件夹中有一个名为 chrome 的目录...

也许有一个谷歌浏览器工具包，SDK

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T02:14:37.507

许多应用程序都有名为 Chrome 的文件夹。这些术语是指用于所有不同 GUI 小部件的装饰和排列。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T00:57:08.427

google chrome 是一个应用程序，而不是您可以创建为控件的窗口或directX。
但是，您可以像有人已经提到的那样托管 WebKit 控件。您可以使用具有 WebKit 小部件的 QT 轻松做到这一点。
一个名为“chrome”的文件夹可以表示任意数量的东西。“chrome”是浏览器 UI 的总称。Firefox 在其代码库中也有“chrome”这个词。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T00:31:42.427

Google Chrome 浏览器基于 Safari 使用的 WebKit。不过，Chrome 使用了不同的 JS 引擎。我不认为托管 WebKit 将是一项微不足道的任务。[http://webkit.org/](http://webkit.org/)

# math - 如何自然淡出音量？

> ID：207016
> 
> 赞同：17
> 
> 时间：2008-10-16T00:29:49.123
> 
> 标签：math, audio

我已经尝试过在大约半秒的时间内使用 sigmoid 和对数淡出音量来缓冲暂停和停止，并防止我的音乐应用程序中出现爆音。

然而，这些听起来都不“自然”。我的意思是，他们听起来很糟糕。就像一个业余工程师负责录音机一样。

我知道耳朵在音量方面是对数的，或者至少，两倍的功率并不意味着两倍的音量。音量衰减有什么神奇的公式吗？谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-16T00:36:56.877

我年轻的时候花了很多时间为我学校的广播电台做音乐录音、现场音乐会和 DJ，我可以告诉你的一件事是，你褪色的地方也很重要。

只要没有人声，在歌曲结束时淡入或淡出前奏听起来很自然，但是其中一些计算机化广播电台会在一首歌中的任何地方淡入淡出，以制作下一个广告插播......我不认为有一种方法可以让这听起来不错。

无论如何，我也会回答你问的问题......用于调整音频电平的对数衰减通常称为“音频锥度”。这是一篇很好的文章，描述了与我们现在用于娱乐的电子设备相关的人类听觉生理学。请参阅： [http](http://tangentsoft.net/audio/atten.html) ://tangentsoft.net/audio/atten.html 。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-16T00:46:33.520

您需要确保淡出的末端在波形中的“零交叉”处。

半秒是相当快的。您可能只想延长时间，除非它必须那么快。一般2、3秒比较自然。

更多的时间，它应该与音乐的节拍率，并在节奏的自然点结束。尝试获取歌曲的 BPM（这可以粗略计算），并在该时间间隔内淡出等于全音符或半音符。

您也可以尝试在淡出时降低播放速度。这将提供更自然的黑胶唱片或磁带听起来停止/暂停。线性降低播放速度，同时在 1 秒内以对数方式降低音量。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-16T14:48:06.957

如果您只是想在暂停或停止播放时获得干净的声音，那么根本不需要淡入淡出 - 只需找到一个零交叉点并停在那里（或更现实地，只需用静音填充最终缓冲区的其余部分）。正如您所注意到的，当用户希望声音立即停止时淡出听起来不自然，因为结果与动作分离。

停在零交叉点的原因是，零是音频停止时的稳态值，因此两种状态之间的过渡是无缝的。如果您在最后一个样本的幅度较大时停止播放，那么当音频硬件重构模拟信号时，您实际上是在将瞬变引入音频中，这将作为爆裂声和/或咔嗒声听到。

另一种方法是非常快地衰减到零（~< 10mS），它有效地实现了与过零技术相同的效果。

# php - 为什么我的 MySQL 导出到 CSV 时会出现 HTML？

> ID：207019
> 
> 赞同：1
> 
> 时间：2008-10-16T00:31:02.740
> 
> 标签：php, mysql, csv

我知道以前有人问过这个问题，但我遇到了一个问题。

奇怪的是，当我执行这个函数时，它包含了您选择执行该函数的链接的页面的 html。

```
function exportCSV($table) {
    $result = mysql_query("SHOW COLUMNS FROM ".$table."");
    $i = 0;
    if (mysql_num_rows($result) > 0) {
        while ($row = mysql_fetch_assoc($result)) {
            $csv_output .= $row['Field']."; ";
            $i++;
        }
    }
    $csv_output .= "\n";

    $values = mysql_query("SELECT * FROM ".$table."");
    while ($rowr = mysql_fetch_row($values)) {
        for ($j=0;$j<$i;$j++) {
            $csv_output .= $rowr[$j]."; ";
        }
        $csv_output .= "\n";
    }

    $filename = $file."_".date("Y-m-d_H-i",time());
    header("Content-type: application/vnd.ms-excel");
    header("Content-disposition: csv" . date("Y-m-d") . ".csv");
    header( "Content-disposition: filename=".$filename.".csv");
    print $csv_output;
    exit;
} 
```

有谁知道为什么它会在 csv 文件中包含 HTML？ [替代文字 http://i35.tinypic.com/16i9oxi.jpg](http://i35.tinypic.com/16i9oxi.jpg)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T00:49:49.283

我的猜测是，无论请求的页面如何，您都有某种模板可以生成相同的 HTML 页眉和页脚。在调用 exportCSV 函数之前的某个时间，会生成标头。

您没有显示输出的底部，但我敢打赌页脚也在那里，因为我怀疑在函数退出后流控制将继续处理该代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T00:38:03.847

php 不是我真正的东西，但似乎你需要在写出你的内容之前清除响应流。在达到此功能之前，也许还有其他东西正在将 html 写入流？像模板或母版页或类似的东西？

HTML 内容看起来像一个典型的标题/导航栏。如果有其他内容会自动包含您需要为此路线禁用的内容？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T00:40:35.497

您在某处遇到了控制流问题 - 似乎 html 头部和导航默认包含在任何页面中，包括生成 CSV 的页面中。一种解决方案是检查 CSV 请求，如果是这种情况，请不要包含 html 代码，另一种解决方案是使用输出缓冲，然后在输出 CSV 数据之前丢弃所有先前的输出。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T00:43:25.210

我建议在方法开始时将 csv_output 变量初始化为空字符串。您在方法中的所有操作都是串联的，因此您可能会带来一些旧数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-16T01:01:49.197

请考虑到您正在向全世界展示潜在的敏感数据。你有十几个人现在已经公布了他们的电子邮件和街道地址。

# c++ - MFC 中的 OnKillFocus() 覆盖在奇数时间触发

> ID：207021
> 
> 赞同：3
> 
> 时间：2008-10-16T00:32:18.807
> 
> 标签：c++, events, mfc, overriding, onkillfocus

我需要知道我的窗口何时失去输入焦点，所以我重载了 CWnd 的 OnKillFocus() 方法。

但是，当我关注另一个应用程序（alt+tab），甚至最小化窗口时，它不会调用此方法。但是当我将其从最小化中恢复时，它确实会调用该方法。这些是它触发此方法的预期时间吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T14:17:05.037

如果您需要确保在关闭应用程序时收到通知，我认为您将需要一个 CWnd::OnActivateApp() 处理程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T14:23:08.923

OnKillFocus() 通常只用于具有获得焦点概念的控件 - 按钮、编辑框、列表框等。通常 CWnd 不接受焦点，所以你不能依赖它 - 我很惊讶你完全明白了。

除了`WM_ACTIVATEAPP`上面提到的之外，`WM_ACTIVATE`在同一应用程序中的窗口之间切换时，您可能想要捕获。

# iphone - UIImageView 未显示在 UITableView 标题中

> ID：207022
> 
> 赞同：4
> 
> 时间：2008-10-16T00:34:53.980
> 
> 标签：iphone, cocoa-touch, uitableview

我的问题是我似乎无法从我的包中获取图像以正确显示。此方法位于控制 tableview 的视图控制器中。*headerView*与 .nib 文件中的 tableview 一起加载，并包含一些加载得很好的 UILabel（未显示）。有任何想法吗？

```
- (void)viewDidLoad {
    [super viewDidLoad];

    [[self view] setTableHeaderView:headerView];
    NSBundle *bundle = [NSBundle mainBundle];
    NSString *imagePath = [bundle pathForResource:@"awesome_lolcat" ofType:@"jpeg"];
    UIImage *image = [UIImage imageWithContentsOfFile:imagePath];
    imageView = [[UIImageView alloc] initWithImage:image];
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-16T02:27:25.657

首先，您需要确定您的图像是否正确加载。获取图像最快的方法是使用 UIImage 便捷方法 +[UIImage imageNamed: rawImageName]。

另外，这是一个 UITableViewController 吗？（不清楚，但暗示）。

imageView 在哪里使用？您在底部附近创建它，但似乎没有对它做任何事情。您可能想要创建图像视图，为其分配图像，然后将其作为子视图添加到 headerView。

```
 //this assumes that headerView is an already created UIView, perhaps an IBOutlet

   UIImage     *image = [UIImage imageNamed: @"awesome_lolcat.jpeg"];
   UIImageView *imageView = [[UIImageView alloc] initWithImage: image];
   [headerView addSubview: [imageView autorelease]];
   [[self view] setTableHeaderView: headerView]; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-16T13:29:37.487

如果您已经创建了一个插座并将其连接到 Interface Builder 中的视图，则应该使用该视图，而不是动态创建 UIImageView。

```
 //this assumes that headerView is an already created UIView, perhaps an IBOutlet
   //also, imageViewOutlet is an IB outlet hooked up to a UIImageView, and added as
   //a subview of headerView.

   //you can also set the image directly from within IB
   imageViewOutlet.image = [UIImage imageNamed: @"awesome_lolcat.jpeg"];
   [[self view] setTableHeaderView: headerView]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T11:41:14.400

以编程方式添加子视图，但它没有正确链接到 Interface Builder 中的*UIImageView*。我创建的视图（我认为）正确链接到我的*UITableViewController*中的 UIView 插座，但是当我初始化我的 imageView 时，它会创建一个新视图，而不是将图像放在我已经创建的视图中。

感谢您的回答。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-03T05:48:20.637

请参阅[http://developer.apple.com/library/ios/#samplecode/TableViewUpdates/Introduction/Intro.html](http://developer.apple.com/library/ios/#samplecode/TableViewUpdates/Introduction/Intro.html) 它将在部分标题上显示 UIImageview。

# delphi - Delphi 7中的“重命名控件”？

> ID：207024
> 
> 赞同：2
> 
> 时间：2008-10-16T00:35:16.007
> 
> 标签：delphi, refactoring

跟进[这个](https://stackoverflow.com/questions/189893/is-there-any-way-to-get-code-folding-in-delphi-7)问题，我正在研究一个写得不是很好的大型 Delphi 7 代码库。

我正在看这样的代码，作为一个小例子：

```
 if FMode=mdCredit then begin
    Panel8.Caption:='Credit';
    SpeedButton3.Enabled:=false;
    SpeedButton4.Enabled:=false;
    SpeedButton5.Enabled:=false;
    SpeedButton5.Enabled:=false;
    SpeedButton6.Visible:=False;
    SpeedButton10.Visible:=False;
  end; 
```

其次是另外 6 个非常相似的块。整件事情都是这种风格。所以我认为如果控件命名合理，这将更容易阅读。

我可以只使用全局搜索和替换，但是当多个表单使用相同的名称时我会遇到问题，而且我必须小心在 SpeedButton1 之前更改（例如）SpeedButton10。

是否有一些插件能够为我执行“智能”重命名？

**编辑：**
抱歉，我之前应该提到过这一点：我尝试了 GExperts 和 Castalia 的“重命名组件”功能，但它们似乎都是在最初将组件添加到表单时使用的。

他们不会在代码中进行搜索+替换，也不会重命名现有事件 (SpeedButtonXClick() -> cmdCreditClick())。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-16T01:13:55.540

不完全是一个插件，但您可以使用最新版本的 Delphi 之一和其中的重构功能。也许您可以使用免费的[Turbo Edition](http://www.turboexplorer.com/)。. .

您可以尝试使用[ModelMaker](http://www.modelmakertools.com/) for Delphi 7。它具有可能对您有用的重构支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T00:43:35.677

最近 Delphi 版本中的[重命名符号重构将跨项目中的单元工作。](http://conferences.codegear.com/article/32128#RenameSymbol)既然您说 Delphi 7，我想这对您没有帮助，而且在过去我刚刚使用过[TextPad](http://www.textpad.com)，这是一个很棒的编辑器（与许多其他编辑器一样）可以跨文件进行强大的搜索/替换（有或没有确认）。

高温高压

编辑：克雷格的权利 - GExperts 会这样做，[Castalia](http://twodesks.com/castalia/refactoring.html)也会这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T00:44:26.817

我认为[GExperts](http://www.gexperts.org/)有这样的搜索和替换功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T01:13:17.710

不知道它是否适用于您的情况，但您可以尝试在具有重构功能的更高版本的 Delphi 中加载您的项目，并使用它来更改组件名称，同时处理所有依赖项。然后你只需要做一个差异，看看有什么改变。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-20T14:13:16.820

为什么不使用同步编辑？它是 IDE 的一部分（至少在 2006 年以上）：

> 同步编辑功能可让您同时编辑选定代码中的相同标识符。例如，在包含三个 label1 匹配项的过程中，您可以只编辑第一个匹配项，所有其他匹配项将自动更改。（抄自 BDS2006 帮助）

您将不得不首先重命名您的组件，但它消除了大部分的痛苦。我更喜欢在将组件添加到表单时重命名组件的 GExperts 向导，但正如您所指出的，它仅在将组件添加到表单时才有效，并且不涉及代码中组件的单独使用。首先重命名组件的原因是，当您选择整个代码块进行重命名时，它不会在 dfm 文件中进行适当的更改......只是您本地选择的代码块。

要使用该功能，请选择您的整个实现块，然后按下装订线中的按钮，该按钮有两支铅笔由一条线“链接”...然后按 Tab 直到您获得要编辑的第一个...当您更改它的名称，它将在您的源文件的其余部分全局更改。完成后按 ESC。

# database - 我的 Oracle 10gr2 检查约束有什么问题？尝试强制执行日期范围

> ID：207025
> 
> 赞同：3
> 
> 时间：2008-10-16T00:36:47.470
> 
> 标签：database, oracle, constraints, date

我想对日期范围强制执行 CHECK 约束，以使 BIRTH_DATE 列中的所有日期都小于明天且大于或等于 100 年前。我在 CHECK 约束中尝试了这个表达式：

```
BIRTH_DATE >= (sysdate - numtoyminterval(100, 'YEAR')) AND BIRTH_DATE < sysdate + 1 
```

但我收到错误“ORA-02436：在 CHECK 约束中错误指定日期或系统变量”

有没有办法使用 CHECK 约束而不是触发器来实现这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-16T11:01:37.443

至于 Oracle 为何做出此限制：检查约束必须始终评估为 TRUE，即使对于更新也是如此。如果您将 99 岁的人添加到数据库中，然后尝试在 2 年后更新此人的电子邮件地址（例如），您将收到检查约束违规。

如果合适的话，你可以做的是有另一个默认为 SYSDATE 的列 CREATED_DATE，并进行约束：

```
BIRTH_DATE >= (CREATED_DATE - numtoyminterval(100, 'YEAR')) 
AND BIRTH_DATE < CREATED_DATE + 1 
```

但是，如果您真的只想在 INSERT 时执行检查，请在数据库触发器或 API 代码中执行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-16T01:05:04.840

检查约束表达式必须是确定性的，因此这种滑动日期范围在检查约束中是不可执行的。来自[SQL 参考](http://download.oracle.com/docs/cd/B28359_01/server.111/b28286/clauses002.htm#SQLRF01111)

> 检查约束条件不能包含以下结构：
> 
> ```
> * Subqueries and scalar subquery expressions
> * Calls to the functions that are not deterministic (CURRENT_DATE, 
> ```
> 
> CURRENT_TIMESTAMP、DBTIMEZONE、LOCALTIMESTAMP、SESSIONTIMEZONE、SYSDATE、SYSTIMESTAMP、UID、USER 和 USERENV）

# c# - 从集合中删除项目的最佳方法

> ID：207038
> 
> 赞同：74
> 
> 时间：2008-10-16T00:43:46.690
> 
> 标签：c#, collections

一旦项目已知，但不是它的索引，从 C# 中的集合中删除项目的最佳方法是什么？这是一种方法，但充其量似乎是不雅的。

```
//Remove the existing role assignment for the user.
int cnt = 0;
int assToDelete = 0;
foreach (SPRoleAssignment spAssignment in workspace.RoleAssignments)
{
    if (spAssignment.Member.Name == shortName)
    {
        assToDelete = cnt;
    }
    cnt++;
}
workspace.RoleAssignments.Remove(assToDelete); 
```

我真正想做的是找到要按属性（在本例中为名称）删除的项目，而无需遍历整个集合并使用 2 个附加变量。

* * *

## 回答 #1

> 赞同：138
> 
> 时间：2008-10-16T01:04:31.347

如果 RoleAssignments 是 a`List<T>`您可以使用以下代码。

```
workSpace.RoleAssignments.RemoveAll(x =>x.Member.Name == shortName); 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-10-16T00:50:48.597

如果您想通过其中一个属性访问集合的成员，您可以考虑使用`Dictionary<T>`or`KeyedCollection<T>`代替。这样您就不必搜索您要查找的项目。

否则，您至少可以这样做：

```
foreach (SPRoleAssignment spAssignment in workspace.RoleAssignments)
{
    if (spAssignment.Member.Name == shortName)
    {
        workspace.RoleAssignments.Remove(spAssignment);
        break;
    }
} 
```

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2008-10-16T04:33:47.430

@smaclell 在对 @sambo99 的评论中询问为什么反向迭代更有效。

*有时*它更有效。假设您有一个人员列表，并且您想要删除或过滤所有信用等级 < 1000 的客户；

我们有以下数据

```
"Bob" 999
"Mary" 999
"Ted" 1000 
```

如果我们要向前迭代，我们很快就会遇到麻烦

```
for( int idx = 0; idx < list.Count ; idx++ )
{
    if( list[idx].Rating < 1000 )
    {
        list.RemoveAt(idx); // whoops!
    }
} 
```

在 idx = 0 我们删除`Bob`，然后将所有剩余的元素向左移动。下一次通过循环 idx = 1，但 list[1] 现在`Ted`不是`Mary`. 我们最终会`Mary`错误地跳过。我们可以使用一个while循环，我们可以引入更多的变量。

或者，我们只是反向迭代：

```
for (int idx = list.Count-1; idx >= 0; idx--)
{
    if (list[idx].Rating < 1000)
    {
        list.RemoveAt(idx);
    }
} 
```

已删除项目左侧的所有索引都保持不变，因此您不会跳过任何项目。

如果您获得要从数组中删除的索引列表，则同样的原则也适用。为了保持直截了当，您需要对列表进行排序，然后从最高索引到最低索引删除项目。

现在您可以使用 Linq 并以直接的方式声明您正在执行的操作。

```
list.RemoveAll(o => o.Rating < 1000); 
```

* * *

对于这种删除单个项目的情况，向前或向后迭代不再有效。您也可以为此使用 Linq。

```
int removeIndex = list.FindIndex(o => o.Name == "Ted");
if( removeIndex != -1 )
{
    list.RemoveAt(removeIndex);
} 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2013-04-17T11:16:29.827

如果是，`ICollection`那么您将没有`RemoveAll`方法。这是一个可以做到这一点的扩展方法：

```
 public static void RemoveAll<T>(this ICollection<T> source, 
                                    Func<T, bool> predicate)
    {
        if (source == null)
            throw new ArgumentNullException("source", "source is null.");

        if (predicate == null)
            throw new ArgumentNullException("predicate", "predicate is null.");

        source.Where(predicate).ToList().ForEach(e => source.Remove(e));
    } 
```

基于： http: [//phejndorf.wordpress.com/2011/03/09/a-removeall-extension-for-the-collection-class/](http://phejndorf.wordpress.com/2011/03/09/a-removeall-extension-for-the-collection-class/)

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-10-16T01:12:02.780

对于简单的 List 结构，最有效的方法似乎是使用 Predicate RemoveAll 实现。

例如。

```
 workSpace.RoleAssignments.RemoveAll(x =>x.Member.Name == shortName); 
```

原因是：

1.  Predicate/Linq RemoveAll 方法在 List 中实现，并且可以访问存储实际数据的内部数组。它将移动数据并调整内部数组的大小。
2.  RemoveAt 方法的实现非常慢，并且会将整个底层数据数组复制到一个新数组中。这意味着反向迭代对 List 没用

如果您在 c# 3.0 之前的时代无法实现这一点。您有 2 个选项。

*   易于维护的选项。将所有匹配项复制到一个新列表中，然后交换基础列表。

例如。

```
List<int> list2 = new List<int>() ; 
foreach (int i in GetList())
{
    if (!(i % 2 == 0))
    {
        list2.Add(i);
    }
}
list2 = list2; 
```

或者

*   棘手的稍微快一点的选项，它涉及在列表中的所有数据不匹配时将其向下移动，然后调整数组的大小。

如果您非常频繁地从列表中删除内容，那么[HashTable](http://msdn.microsoft.com/en-us/library/system.collections.hashtable.aspx) (.net 1.1) 或[Dictionary](http://msdn.microsoft.com/en-us/library/xfhwa508.aspx) (.net 2.0) 或[HashSet](http://msdn.microsoft.com/en-us/library/bb359438.aspx) (.net 3.5) 等其他结构可能更适合此目的。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-10-16T01:05:28.583

集合是什么类型的？如果是列表，您可以使用有用的“RemoveAll”：

```
int cnt = workspace.RoleAssignments
                      .RemoveAll(spa => spa.Member.Name == shortName) 
```

（这适用于 .NET 2.0。当然，如果您没有较新的编译器，则必须使用“delegate (SPRoleAssignment spa) { return spa.Member.Name == shortName; }” 而不是 nice lambda 语法。）

如果它不是列表，但仍然是 ICollection，则另一种方法：

```
 var toRemove = workspace.RoleAssignments
                              .FirstOrDefault(spa => spa.Member.Name == shortName)
   if (toRemove != null) workspace.RoleAssignments.Remove(toRemove); 
```

这需要 Enumerable 扩展方法。（如果你被困在 .NET 2.0 上，你可以复制 Mono 的）。如果它是一些无法获取项目但必须获取索引的自定义集合，则其他一些 Enumerable 方法（例如 Select）会为您传递整数索引。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-09-13T01:04:03.757

这是一个很好的方法

[http://support.microsoft.com/kb/555972](http://support.microsoft.com/kb/555972)

```
 System.Collections.ArrayList arr = new System.Collections.ArrayList();
        arr.Add("1");
        arr.Add("2");
        arr.Add("3");

        /*This throws an exception
        foreach (string s in arr)
        {
            arr.Remove(s);
        }
        */

        //where as this works correctly
        Console.WriteLine(arr.Count);
        foreach (string s in new System.Collections.ArrayList(arr)) 
        {
            arr.Remove(s);
        }
        Console.WriteLine(arr.Count);
        Console.ReadKey(); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-02-17T20:00:27.310

这是我的通用解决方案

```
public static IEnumerable<T> Remove<T>(this IEnumerable<T> items, Func<T, bool> match)
    {
        var list = items.ToList();
        for (int idx = 0; idx < list.Count(); idx++)
        {
            if (match(list[idx]))
            {
                list.RemoveAt(idx);
                idx--; // the list is 1 item shorter
            }
        }
        return list.AsEnumerable();
    } 
```

如果扩展方法支持引用传递，它看起来会简单得多！用法：

```
var result = string[]{"mike", "john", "ali"}
result = result.Remove(x => x.Username == "mike").ToArray();
Assert.IsTrue(result.Length == 2); 
```

编辑：确保列表循环即使在通过减少索引（idx）删除项目时仍然有效。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-16T05:26:38.227

根据您使用收藏的方式，您可以采取另一种方法。如果您一次下载作业（例如，当应用程序运行时），您可以即时将集合转换为哈希表，其中：

短名称 => SPRoleAssignment

如果您这样做，那么当您想通过短名称删除项目时，您需要做的就是按键从哈希表中删除该项目。

不幸的是，如果您大量加载这些 SPRoleAssignments，那么就时间而言，这显然不会更具成本效益。如果您使用的是 .NET Framework 的新版本，其他人提出的关于使用 Linq 的建议会很好，但否则，您必须坚持使用的方法。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-16T14:14:23.297

这里有很多好的回应；我特别喜欢 lambda 表达式……非常干净。然而，我没有指定 Collection 的类型是失职的。这是一个 SPRoleAssignmentCollection（来自 MOSS），它只有 Remove(int) 和 Remove(SPPrincipal)，而不是方便的 RemoveAll()。所以，我已经决定了，除非有更好的建议。

```
foreach (SPRoleAssignment spAssignment in workspace.RoleAssignments)
{
    if (spAssignment.Member.Name != shortName) continue;
    workspace.RoleAssignments.Remove((SPPrincipal)spAssignment.Member);
    break;
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-05-07T19:44:17.717

要在遍历集合时执行此操作而不是修改集合异常，这是我过去采用的方法（注意原始集合末尾的 .ToList() ，这会在内存中创建另一个集合，那么你可以修改现有的集合）

```
foreach (SPRoleAssignment spAssignment in workspace.RoleAssignments.ToList())
{
    if (spAssignment.Member.Name == shortName)
    {
        workspace.RoleAssignments.Remove(spAssignment);
    }
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-09-04T17:26:11.207

类似于 Dictionary Collection 的观点，我已经做到了这一点。

```
Dictionary<string, bool> sourceDict = new Dictionary<string, bool>();
sourceDict.Add("Sai", true);
sourceDict.Add("Sri", false);
sourceDict.Add("SaiSri", true);
sourceDict.Add("SaiSriMahi", true);

var itemsToDelete = sourceDict.Where(DictItem => DictItem.Value == false);

foreach (var item in itemsToDelete)
{
    sourceDict.Remove(item.Key);
} 
```

**注意：** 上面的代码将在 .Net 客户端配置文件（3.5 和 4.5）中失败，一些查看者提到它在 .Net4.0 中对他们来说是失败的，并且不确定是哪些设置导致了问题。

因此，用下面的代码 (.ToList()) 替换 Where 语句，以避免该错误。“收藏已修改；枚举操作可能无法执行。”</p>

```
var itemsToDelete = sourceDict.Where(DictItem => DictItem.Value == false).ToList(); 
```

每 MSDN 从 .Net4.5 开始，客户端配置文件已停止使用。[http://msdn.microsoft.com/en-us/library/cc656912(v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/cc656912(v=vs.110).aspx)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-01-25T10:05:32.883

首先保存您的项目，而不是删除它们。

```
var itemsToDelete = Items.Where(x => !!!your condition!!!).ToArray();
for (int i = 0; i < itemsToDelete.Length; ++i)
    Items.Remove(itemsToDelete[i]); 
```

您需要`GetHashCode()`在您的 Item 类中覆盖。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-04-23T11:52:59.140

最好的方法是使用 linq。

示例类：

```
 public class Product
    {
        public string Name { get; set; }
        public string Price { get; set; }      
    } 
```

LINQ查询：

```
var subCollection = collection1.RemoveAll(w => collection2.Any(q => q.Name == w.Name)); 
```

`collection1`如果`Name`匹配任何元素`Name`，则此查询将删除所有元素`collection2`

记得使用：`using System.Linq;`

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-07-26T07:18:04.633

如果你有一个`List<T>`，那么`List<T>.RemoveAll`是你最好的选择。没有比这更有效的了。在内部，它使阵列一次移动，更不用说它是 O(N)。

如果你得到的只是一个`IList<T>`或一个，`ICollection<T>`你大致有这三个选项：

```
 public static void RemoveAll<T>(this IList<T> ilist, Predicate<T> predicate) // O(N^2)
    {
        for (var index = ilist.Count - 1; index >= 0; index--)
        {
            var item = ilist[index];
            if (predicate(item))
            {
                ilist.RemoveAt(index);
            }
        }
    } 
```

或者

```
 public static void RemoveAll<T>(this ICollection<T> icollection, Predicate<T> predicate) // O(N)
    {
        var nonMatchingItems = new List<T>();

        // Move all the items that do not match to another collection.
        foreach (var item in icollection) 
        {
            if (!predicate(item))
            {
                nonMatchingItems.Add(item);
            }
        }

        // Clear the collection and then copy back the non-matched items.
        icollection.Clear();
        foreach (var item in nonMatchingItems)
        {
            icollection.Add(item);
        }
    } 
```

或者

```
 public static void RemoveAll<T>(this ICollection<T> icollection, Func<T, bool> predicate) // O(N^2)
    {
        foreach (var item in icollection.Where(predicate).ToList())
        {
            icollection.Remove(item);
        }
    } 
```

选择 1 或 2。

如果要执行的删除操作较少（即谓词在大多数情况下为假），则 1 在内存上会更轻且更快。

如果您要执行更多删除操作，则 2 会更快。

3 是最干净的代码，但在 IMO 中表现不佳。同样，这一切都取决于输入数据。

有关一些基准测试详细信息，请参阅[https://github.com/dotnet/BenchmarkDotNet/issues/1505](https://github.com/dotnet/BenchmarkDotNet/issues/1505)

# java - Node 的 ArrayList 可以包含非 Node 类型吗？

> ID：207045
> 
> 赞同：0
> 
> 时间：2008-10-16T00:48:52.063
> 
> 标签：java

Node 的 ArrayList 可以包含非 Node 类型吗？

有没有一种非常肮脏的方法可以通过类型转换来做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-16T00:51:45.943

是的，但是如果您尝试像访问节点一样访问非节点元素，则会出现类转换异常。泛型在 (for) 运行时被丢弃。

例如：

```
import java.util.*;
import java.awt.Rectangle;

public class test {
    public static void main(String args[]) {
        List<Rectangle> list = new ArrayList<Rectangle>();
        /* Evil hack */
        List lst = (List)list;

        /* Works */
        lst.add("Test");

        /* Works, and prints "Test" */
        for(Object o: lst) {
            System.err.println(o);
        }

        /* Dies horribly due to implicitly casting "Test" to a Rectangle */
        for(Rectangle r: list) {
            System.err.println(r);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T00:59:10.030

鉴于：

```
 List<Node> nodelist = new ArrayList<Node>();
  Object toAdd = new Object(); 
```

然后：

```
 ((List) nodelist).add(toAdd); 
```

或者

```
 ((List<Object>) nodelist).add(toAdd); 
```

会做黑客。伊克。我觉得脏。但是，您不应该这样做。如果您确实需要混合类型，请执行以下操作：

```
 List<Object> mixedList = new ArrayList<Object>(list);
  mixedList.add(toAdd); 
```

该解决方案至少会向其他人表明他们必须注意 Object 的任何子类都可以在列表中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T00:59:56.847

假设您使用 Generic 来拥有一个 ArrayList，您可以使用反射将非 Node 添加到其中，因为在运行时不会保留类型信息。

取决于您如何从 ArrayList 中获取对象，您可能会遇到 ClassCastException。

如果您确实需要 ArrayList 中的非特定类型，那么为什么不直接使用它而不使用 Generic？

# c++ - 对于不遵循 libNAME.so 命名约定的库，如何在没有 -l 或硬编码路径的情况下使用 GCC 链接？

> ID：207069
> 
> 赞同：50
> 
> 时间：2008-10-16T00:58:54.197
> 
> 标签：c++, c, gcc, linker, shared-libraries

我有一个共享库，我希望使用 GCC 链接可执行文件。共享库的名称不是 libNAME.so 形式的非标准名称，因此我不能使用通常的 -l 选项。（它恰好也是一个 Python 扩展，因此没有“lib”前缀。）

我可以将库文件的路径直接传递给链接命令行，但这会导致库路径被硬编码到可执行文件中。

例如：

```
g++ -o build/bin/myapp build/bin/_mylib.so 
```

有没有办法链接到这个库而不导致路径被硬编码到可执行文件中？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2008-11-11T15:42:23.237

有一个“：”前缀，允许您为您的库提供不同的名称。如果你使用

```
g++ -o build/bin/myapp -l:_mylib.so other_source_files 
```

应该在您的路径中搜索 _mylib.so。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T01:40:43.083

如果您可以在调用 g++ 时将共享库复制到工作目录，那么这应该可以：

```
g++ -o build/bin/myapp _mylib.so other_source_files 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T01:41:49.430

如果您使用的是 Unix 或 Linux，我认为您可以在您想要库的目录中创建指向库的符号链接。

例如：
`ln -s build/bin/_mylib.so build/bin/lib_mylib.so`

然后您可以使用`-l_mylib`

[`http://en.wikipedia.org/wiki/Symbolic_link`](http://en.wikipedia.org/wiki/Symbolic_link)

# .net - 没有 Windows Media Player 10+ 的 WPF 中的媒体支持？

> ID：207081
> 
> 赞同：4
> 
> 时间：2008-10-16T01:03:02.300
> 
> 标签：.net, wpf, windows, wmp, ms-media-foundation

我想知道是否可以在没有 Windows 媒体播放器 10 或 11 的情况下部署 Windows Media Foundation？

这是上下文。我有一个在企业环境中运行的 WPF 应用程序。WPF 需要 Windows Media Foundation 来支持富媒体。Windows Media Foundation 是通过 Windows 媒体播放器 10 和 11 分发的。WMP 10/11 的公司发布时间表太遥远了，我等不及了。但是因为我不需要整个播放器基础设施，只需要媒体基础，我想知道是否有办法只部署那个组件。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-16T22:53:46.150

Media Foundation 是一种仅限 Vista 的技术，据我了解，它应该在未来取代 DirectShow。WPF 需要 WMP v10+ 的原因是 milcore 在内部使用了 WMP OCX。WMP v10+ OCX 功能允许 milcore 使用增强型视频渲染器 (EVR)，而后者又使用自定义演示器直接渲染到 D3D 表面并最终在 WPF 中渲染。在 Vista 中，如果支持媒体（即 WMV 文件），WMP 将使用 DirectShow 上的媒体基础路径。

我确实有另一种选择。我的项目[“WPF MediaKit”](https://github.com/Sascha-L/WPF-MediaKit)。我有一个名为 MediaUriElement 的 WPF 控件，它类似于 MediaElement。它根本不需要 WMP。不利的一面是它确实使用了仅在 .NET 3.5 SP1 中可用的 D3DImage 类。

# url - Stripes：所有通过 StripesDispatcher 解析并转发到预编译 JSP 的 URL

> ID：207090
> 
> 赞同：2
> 
> 时间：2008-10-16T01:06:00.500
> 
> 标签：url, servlets, web.xml, stripes, urlbinding

是否可以通过查看动作 bean 上的 @UrlBinding 注释并将这些动作 bean 转发到预编译的 JSP/servlet 而不需要定义和维护 <servlet> <servlet- web.xml 中的映射> 对？基本上，我只想维护 @UrlBinding 注释作为可用 webapp 路径的唯一决定因素。

也许有一种方法可以将 Jasper 指向我的 servlet 所在的位置并自动加载它们，而无需显式定义每一个？

实现这一点的特定方式并不重要，只是我离开了显式 servlet web.xml 依赖项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-09T03:11:50.950

也许我不明白你的问题，但我会试一试。AFAIK 是 Stripes 应用程序的 web.xml 中唯一需要使用 @URLBinding 作为 Web 应用程序中 URL 的“真实来源”的映射：

```
<filter>
    <filter-name>StripesFilter</filter-name>
    <filter-class>net.sourceforge.stripes.controller.StripesFilter</filter-class>
    <init-param>
        <param-name>ActionResolver.Packages</param-name>
        <param-value>com.your.action.beans.package</param-value>
    </init-param>
    <init-param>
        <param-name>Extension.Packages</param-name>
        <param-value>com.your.extension.packages</param-value>
        </param-value>
    </init-param>
</filter> 
```

...

```
<servlet>
    <servlet-name>DispatcherServlet</servlet-name>
    <servlet-class>net.sourceforge.stripes.controller.DispatcherServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
</servlet> 
```

...

```
<filter-mapping>
    <filter-name>StripesFilter</filter-name>
    <servlet-name>DispatcherServlet</servlet-name>
    <dispatcher>REQUEST</dispatcher>
    <dispatcher>FORWARD</dispatcher>
</filter-mapping>

<servlet-mapping>
    <servlet-name>DispatcherServlet</servlet-name>
    <url-pattern>*.do</url-pattern>
</servlet-mapping> 
```

这样，当您添加/删除操作 bean 和/或 JSP 时，无需更改 web.xml 中的任何内容。

# asp.net - 创建新网站时如何将 IIS6 默认设置为 .Net 2.0？

> ID：207111
> 
> 赞同：1
> 
> 时间：2008-10-16T01:18:41.597
> 
> 标签：asp.net, configuration, iis-6

当我在 IIS6 上创建网站时，它默认 ASP.NET 版本为 1.1。有没有办法让版本默认为 2.0？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T01:22:43.510

[问题已经问过了。](https://stackoverflow.com/questions/64279/how-do-you-tell-iis-6-to-set-the-net-version-to-20-not-11-when-new-sites-are-cr)

# svn - 在版本控制中管理品牌软件

> ID：207131
> 
> 赞同：3
> 
> 时间：2008-10-16T01:29:32.340
> 
> 标签：svn, version-control

我目前正在使用颠覆来管理我的源代码，并且我已经到了需要为我正在为客户开发的软件打上烙印的地步。所有品牌都在项目资源中处理，因此更改客户的外观非常简单。我遇到的问题是在源存储库中维护软件的品牌版本。现在它是一个单独的分支，但是当尝试将更改从主干合并到品牌分支时，它很高兴地覆盖了品牌资源文件。

什么是保持这些差异的好方法，但仍然能够轻松检查为主干构建或使用自定义资源文件的构建构建发布所需的一切？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T01:36:15.697

您可以将品牌发布作为一个单独的 repo，使用 vanilla 分支作为外部。

另一种方法是将所有内容保存在一个分支中，并让构建过程完成选择要使用的品牌特定文件的工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T01:37:33.573

您需要将品牌作为核心技术的包装，这就是我所知道的所有其他项目的做法。

但是，如果您从一开始就没有这样考虑这个项目，您可能需要一两个星期来重构所有内容。

理想情况下，您不应该需要该分支，但无论如何拥有它都是一个好主意，这只是为了合理的工程原则并保护您客户的代码稳定性。如前所述，品牌应该可以在编译时或运行时使用某种包装来完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T01:53:41.887

好吧，您可以使用合并集，只合并一系列提交，或者您可以将品牌资源文件保存在分支根目录的单独目录中？然后在合并时，只需选择根目录中的目录，不包括品牌目录。

我喜欢只合并一系列提交，因为这样可以避免吹走分支上的新工作。但是，如果您需要合并所有内容，您可以将您的项目移动到子目录（例如：“Source”）并将品牌移动到第二个子目录。然后在 Eclipse 或任何你可以选择从主干/源合并到分支/源的东西中。

例如：

这个：
/svn/proj/trunk/a
/svn/proj/trunk/b
/svn/proj/trunk/c
/svn/proj/trunk/d/e/f/branding

变成这样：
/svn/proj/trunk/source/a
/svn/proj/trunk/source/b
/svn/proj/trunk/source/c

/svn/proj/branch/branding
/svn/proj/branch/source/a
/svn/proj/branch/source/b
/svn/proj/branch/source/c

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T01:35:14.217

品牌应该是顶级项目，项目的核心部分是子项目（或依赖项，取决于您的项目继承模型）。在 subversion 中，您可以使用 externals 将核心产品源代码包含在顶层产品中，也可以构建核心产品并使用顶层项目来创建最终的“程序集”。

# java - 手动更改后恢复数据库记录

> ID：207143
> 
> 赞同：1
> 
> 时间：2008-10-16T01:36:19.660
> 
> 标签：java, mysql, tomcat5.5, hibernate3

**问题已解决：**谢谢大家，请参阅下面的答案。

我有一个在 Tomcat 5.5 中运行的网站，它使用 Hibernate3 连接到 MySQL5 数据库。

一个记录只是拒绝保留对其执行的任何更改。如果我以编程方式更改记录，则值将恢复为以前的值。

如果我手动修改数据库中的记录，这些值将恢复（似乎一旦 webapp 访问它们）。

我尝试停止 Tomcat 并手动更改值，然后再次启动 Tomcat。检查数据库，在 Tomcat 启动 webapp 后值保持不变，但一旦我加载站点就会再次恢复。

我还尝试删除 webapp 和 .ser 缓存文件的 Tomcat 工作文件夹。

我还检查了正在恢复的值的代码，但找不到它们。

我只在这张专辑中注意到了这一点。

**编辑：**我刚刚使用 hibernate.show_sql=true 查看了 Hibernate 的 SQL 输出。我的行所在的表记录了一个更新查询。有谁知道如何解决？列到实际值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T02:33:20.137

您可以暂时启用 mysql 查询日志记录并准确查看哪些 sql 语句更改了该值。由于您说它在服务器启动后立即更改，您应该能够很快找出该语句。

[http://dev.mysql.com/doc/refman/5.0/en/query-log.html](http://dev.mysql.com/doc/refman/5.0/en/query-log.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T15:51:46.843

要回答您的问题：

> 有谁知道如何解决？列到实际值？

你可以用[p6spy](http://www.p6spy.com/)做到这一点。[此处](http://swik.net/Spring/Spring%27s+corner/Integrate+P6Spy+with+Spring/vq6)提供了有关如何在 Spring 应用程序中进行设置的说明。

但是，我认为这些说明中有一个错误，他们称为 p6spy.log 的文件实际上应该是名称 p6spy.properties。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T01:45:52.557

它越来越接近万圣节，所以你必须期待这种事情（加上它只是一个满月），但我会继续寻找网络应用程序中的罪魁祸首......它必须在那里。我会立即在 webapp 源代码中搜索几个值：

*   正在更改的记录的 ID。
*   写入记录的值。

祝你好运......这些可以找到真正的熊！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T01:46:31.090

这闻起来有点像启动时触发的测试用例，它将行修改为测试前的预期。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-16T02:19:16.703

在更新之前添加一个触发器，检查行 ID，如果它与您的魔法行匹配，则引发 SQL 错误。然后检查生成的堆栈跟踪，遍历代码并找到更新行的部分。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-16T22:09:00.013

感谢大家的帮助。所有的建议都派上用场追踪它。

我已经设法找出导致它的原因。糟糕的数据库设计、多个数据模型和 Hibernate 导致了一些讨厌的东西。另一个表存储了值，并且该类正在扩展具有相同值的基类。

是时候考虑做一些标准化了。

# javascript - 在 Asp.net MVC 母版页中设置正文的 OnLoad 属性

> ID：207150
> 
> 赞同：3
> 
> 时间：2008-10-16T01:40:50.617
> 
> 标签：javascript, asp.net-mvc, master-pages

我有一个使用包含一些需要使用正文的 OnLoad 执行的 javascript 的母版页的视图。仅针对某些视图在我的 MasterPage 上设置 OnLoad 的最佳方法是什么？

我尝试过的想法是将 javascript 函数的名称作为 ViewData 传递。但我真的不希望我的控制器必须了解页面上的 javascript。我真的不喜欢这种方法...

```
<body onload="<%=ViewData["Body_OnLoad"]%>">
<asp:ContentPlaceHolder ID="MainContent" runat="server" /> 
```

编辑 - 我想一个想法是使用 jQuery 的文档就绪事件来代替......

还有其他想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-26T20:45:41.667

现在 JQuery 正式成为 ASP.NET MVC 的一部分，我建议使用它。它很小，可以为您的应用程序增加大量价值。

我建议添加包含 Intellisense 注释的 Mustafa 的 JQuery 版本：

[jquery-1.2.6-intellisense.js](http://www.mustafaozcan.net/en/file.axd?file=jquery-1.2.6-intellisense.js)

然后将它添加到您的 Scripts 文件夹（MVC Beta 1 中的新功能），并像这样引用它：

```
<script language="javascript" type="text/javascript" src="../../Scripts/jquery-1.2.6-intellisense.js"></script> 
```

在您的代码中，您现在可以添加如下函数：

```
$(document).ready(function() {
   // do stuff when DOM is ready
}); 
```

由于您提到您只希望它发生在某些视图中，因此您可以在母版页中添加一个占位符，如下所示：

```
<asp:contentplaceholder id="JavascriptPlaceholder" runat="server"></asp:contentplaceholder> 
```

然后在您的视图中，您可以选择将代码放在那里，也可以不放。

这将进入头部

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-31T10:56:45.490

博客中的解决方案：[在 ASP.net 2.0 MasterPages 中使用 body onload](http://blog.thewightstuff.net/blog/2007/03/using-body-onload-with-aspnet-20.html)

```
**MasterPage.master**

<head>
<asp:ContentPlaceHolder runat="server" id="Headers">
</asp:ContentPlaceHolder>
<script language=javascript>
   function mp_onload() {
     if(window.body_onload != null)
     window.body_onload();
   }
</script>
</head>
<body onload="mp_onload();">

**Default.aspx**

<asp:Content ID="Content2" ContentPlaceHolderID="Headers" Runat="Server">
<script language="javascript">
   function body_onload()
   {
       //do something
   }
</script>
</asp:Content> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-16T03:58:58.577

我一直在我当前的 MVC 项目中使用以下模式，到目前为止，它似乎对我的 .js 工作非常有效......

在我的母版页中，我加载了我希望在所有内容页面中使用的标准脚本文件（jquery.js、global.js、jquery-plugins、.css 文件等）。然后，我在我的母版页中定义所需的任何事件（onLoad、onSave 等）。我创建的每个内容页面都有自己的 .js 文件与之关联，我在内容 .aspx 页面中加载该脚本文件。任何需要在内容页面之间以不同方式实现的 .js 事件都在单独的内容 .js 文件中处理。所以基本上我的母版页有一组 .js 函数，我的内容页脚本将实现这些函数。现在我只是将这些模板 .js 函数签名存储在一个文件中，然后将它们复制并粘贴到我需要创建的每个新 content.js 文件中。但是，我'

回顾一下：

MasterPage.Master 加载：jquery.js、global.js、plugins.js

ContentPage 加载：ContentPage.js

Global.js 包含母版页调用的函数，这些函数不会在内容页面之间更改，以及任何其他全局例程函数。

每个 ContentPage.js 都为内容页面实现它自己的函数，以及母版页调用的具有不同行为的函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T02:01:24.210

无论如何，您绝对应该使用 jQuery 或其他 JavaScript 框架。

让您的控制器将某种状态指示器传递给您的视图，但不传递特定于视图的内容，例如 JavaScript 函数的名称。将状态指示器映射到 JavaScript 函数名称取决于您的视图。

# c# - 如何使用 LINQ to XML 访问列中的 XML 数据？

> ID：207157
> 
> 赞同：0
> 
> 时间：2008-10-16T01:43:17.837
> 
> 标签：c#, xml, linq-to-sql, linq-to-xml

我在表的列中有这个 XML：

```
<keywords>
  <keyword name="First Name" value="|FIRSTNAME|" display="Jack" />
  <keyword name="Last Name" value="|LASTNAME|" display="Jones" />
  <keyword name="City" value="|CITY|" display="Anytown" />
  <keyword name="State" value="|STATE|" display="MD" />
</keywords> 
```

我通过以下方式使用 LINQ to SQL 从该表中获取记录：

```
GeneratedArticle ga = db.GeneratedArticles.Single(p => p.GeneratedArticleId == generatedArticleId); 
```

那行得通，我得到了我的 GeneratedArticle 对象就好了。

我想浏览一下 ArticleKeywords 字段中的数据，即 XML。我开始这样做：

```
var keywords = from k in ga.ArticleKeywords.Elements("Keywords")
                    select k;

            foreach (var keyword in keywords)
            {
             //what goes here?   
            } 
```

我不能 100% 确定我是否正确获取了这些数据。我需要有关正确语法的帮助，以从我的 XML 字段中获取值和显示。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-20T20:41:55.803

再一次让我感到惊讶的是，人们甚至没有尝试他们的答案，而且当他们不工作时人们仍然投票。.Elements 将获取当前根的元素列表，这不是关键字。

同样使用 .Attributes["X"] 的那个甚至不编译你需要使用 () 当然再次它会在“keywords”而不是“keyword”的每个实例上运行

你可以使用

```
var keywords = from kw in ga.ArticleKeywords.Element("keywords").Elements() 
```

或者

```
var keywords = from kw in ga.ArticleKeywords.Element("keywords").Elements("keyword") 
```

或（这将获得所有关键字元素，无论级别如何）

```
var keywords = from kw in ga.ArticleKeywords.Descendants("keyword") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T02:16:05.150

这是一个示例代码：

要读取关键字，我们需要调用*Elements(" **keyword** ")*而不是*Elements(" **keywords** ")*，因为*关键字*是根节点。

```
// IEnumerable sequence with keywords data
var keywords = from kw in ga.ArticleKeywords.Elements("keyword")
               select new {
                   Name = (string)kw.Attribute("name"),
                   Value = (string)kw.Attribute("value"),
                   Display = (string)kw.Attribute("display")
               };

foreach (var keyword in keywords)
{
    var kw = "Name: " + keyword.Name + 
             " Value: " + keyword.Value + 
             " Display: " + keyword.Display;
    Console.WriteLine(kw);
} 
```

您可以使用*foo.Attribute("bar").Value*获取属性值，但如果缺少属性，此方法会抛出异常。获取属性值的安全方法是*(string)foo.Attribute("bar")* -如果缺少属性，它会给你*null*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T02:13:14.123

我认为这样的事情会起作用

```
var keywordData = from k in ga.ArticleKeywords.Elements("Keywords")
                  select new { Value = k.Attributes["value"].Value,
                               Display = k.Attributes["display"].Value}; 
```

这将为您提供一个匿名类型的 IEnumerable，其中包含一个 Value 和一个 Display 属性。根据您的操作，您可以轻松地将匿名类型替换为具体类型。

# powershell - 我可以在输出期间使用 Select-Object/Export-CSV 转换对象属性吗？

> ID：207166
> 
> 赞同：6
> 
> 时间：2008-10-16T01:50:53.530
> 
> 标签：powershell

我正在使用 Quest AD cmdlet，尤其是 Get-QADUser，从 AD 中提取用户列表并仅返回一些属性。没问题，很简单，但我想在导出到 CSV 之前转换属性之一（parentContainerDN）。

```
Get-QADUser -name "Froosh" | Select-Object logonName,homeDrive,parentContainerDN | Export-CSV C:\Temp\File.csv 
```

这当然可行，但是 parentContainerDN 又长又不整齐。在将其传递给 Export-CSV 之前，是否有一种简单的方法可以用 parentContainerDN.Name 替换它？

我会对命令行解决方案或脚本片段感到满意。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-16T01:59:58.987

有一种特殊的语法可以在 select-object 中创建动态属性。试试这个（为清楚起见添加了包装）：

```
get-qaduser -name "hamilmat" 
    | select-object logonName, homeDrive, 
        @{Name="containerName"; Expression={$_.parentContainerDN.Name}} 
    | export-csv ... 
```

# .net - 将 Delphi 7 应用程序迁移到 .NET

> ID：207169
> 
> 赞同：7
> 
> 时间：2008-10-16T01:51:14.340
> 
> 标签：.net, delphi, migration

有关如何在 Visual Studio 2005 中将现有的 Delphi 7 业务应用程序迁移到 .NET 2.0 的任何建议？

Visual Studio 2005 已被购买，该公司希望摆脱 Borland/Codegear 工具。

该应用程序是单个客户端服务器可执行文件，利用许多第 3 方 UI 控件和 Crystal 报表 10 进行报告。

UI 中的 Delphi 类型以及许多 SQL Server 2000 存储过程中分布着广泛的业务逻辑。将大部分存储的 proc 逻辑移动到 .NET 类中是另一个目标。

为了减少对客户的影响，如果可能的话，最好采用逐个方法而不是完全重写/转换。提前致谢。

[更新] 有没有人有任何经验，好的，坏的或丑陋的，使用托管 VCL 来处理这种类型的场景？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-16T02:33:47.860

这听起来对我来说是一个[非常糟糕的主意](http://www.joelonsoftware.com/articles/fog0000000069.html)。

您的产品在 .NET 中是否有任何技术优势，或者成为 Microsoft 商店主要是出于政治决定？对于客户端-服务器，Delphi 很难被击败。我用过VS2005/8，它在Win32开发上真的真的真的没有Delphi那么好。但是，如果您打算在以后迁移到 Web，那么 VS 具有明显的优势。

如果顽固的商业人士只是拒绝再使用 Delphi，那么 KiwiBastard 是正确的，IMO。首先转换为 Delphi.NET，然后从那里迁移到 VS2005。或者 2010 年，因为那是一个更现实的时间表 :)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-16T03:03:24.523

我在一家公司工作，该公司大约在 2007 年从 Delphi 迁移到 WPF/.Net。我们尝试了一个接一个的方法。这很痛苦。我们总是在互操作中遇到细微的错误。从 Delphi 调用 WPF 或 Winforms 并返回是痛苦的。如果您的应用程序的各种 UI 控件和窗口经常相互调用，我认为您将经历重大的成长痛苦。

如果你有能力一次完成整个转换，我会去的。如果没有，请拆分应用程序中独立或与应用程序其余部分交互最少的部分。

我还建议跳入 .Net 2008。您为什么要选择一项已有近 4 年历史的技术（VS 2005）？我认为在.Net 3.5 非常稳定的情况下选择跳入.Net 2.0 是一个非常非常糟糕的商业决定。我向管理层提出.Net 2.0 的唯一正当理由是支持Windows 2000。你还有Win2k 的客户吗？转换完成后，您还会有 Win2k 上的客户吗？您是否有无法迁移到 XP 或 Vista 的客户？Win2k 不支持 .Net 3.0 和 3.5。这是我能想到的唯一缺点。

.Net 3.5 和 C# 2008 为您的公司提供了显着的优势。与 C# 2.0 相比，您拥有许多可以加快开发时间的语言功能。你有 WPF，它比 Winforms 优越得多。我认为您可以开发与 WPF 在 Winforms 中获得的相同的战舰灰色 Windows，更快地开发它们，并且当您想要一些吸引眼球的时候，您将使用一种可以轻松提供它的技术。如果您正在为这种转换学习一个新的窗口平台，为什么不投资学习新东西呢？

另外，请告诉我您实际上并没有购买 VS 2005。您可以以大致相同的成本购买[MSDN 通用](http://msdn.microsoft.com/en-us/subscriptions/default.aspx)许可证，并获得 Microsoft 制造的所有与开发相关的产品。从第 3 方购买，您将获得很好的折扣。

对不起，如果我是负面的。真诚地，祝您迁移顺利。当我想到不得不放弃 .Net 3.5 中的所有好东西时，我只是有闪回。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-16T16:45:06.627

我之前曾在一家公司工作，该公司想从 Delphi 转换为 C#.NET，因为 .NET 非常*酷炫*。他们引入了更多具有丰富 C# 经验的开发人员，最终将应用程序移植到 C# 花费了开发人员两倍的 3 倍时间，然后它确实在 Delphi 中首次编写它，但额外的投资回报率非常低（一些在此过程中添加了新功能）。此外，客户对应用程序性能或 UI 不满意。

一个又一个案例研究表明，[重写是一个坏主意](http://www.joelonsoftware.com/articles/fog0000000069.html)。（给[kogus](https://stackoverflow.com/users/672/kogus)的帽子小费）

如果您必须迁移到 .NET（是的，我知道，您没有做出决定，*信息较少*的人做了决定），那么我建议您使用[Delphi for .NET](http://www.codegear.com/products/radstudio)或[RemObjects Oxygene](http://www.remobjects.com/oxygene)。后者是一个 Visual Studio 插件。但即使[是 RemObjects Oxygene 的首席软件架构师 marc hofman](http://blogs.remobjects.com/blogs/mh)也表示“仅仅因为”将完美运行的应用程序迁移到 .NET 是一个坏主意。

如果你可以等待 Delphi Prism，它也是一个 Visual Studio 插件，预计将在今年晚些时候推出。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-16T01:57:58.553

零碎的转换意味着将本机 Delphi 代码更改为使用 COM，以便 .NET 端可以与 Delphi 共存（或者可能使用其他一些技术 - 很难说）

如果可以的话，首先将应用程序转换为 Delphi.NET 可能会更容易，那么至少 .NET 位将能够更轻松地进行通信。

只是一个想法。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-18T20:46:26.900

远离 CodeGear/Borland 工具基本上消除了任何基于 Delphi .NET 的解决方案和对应用程序的完全重写。

我希望我在下面的回答对您的决定有所帮助。

根据经验（与一群人一起重写了 Delphi 应用程序），可以归结为以下两种选择之一。

但首先要警告：您将至少花费编写当前 Delphi 应用程序所需的全部开发工作量。

在我们的案例中，这种努力是有必要的，因为旧的 Delphi 应用程序（实际上是 Kylix）由于各种原因而终止了生命周期。我们的重写包括两部分：用有限的额外功能重写，然后是很多额外的功能（第一部分的设计已经考虑了第二部分）。

回到你的选择：

1- 在 Visual Studio 中用 C# 或 VB.NET 完全重写

2-通过使用来自 RemObjecs 的 Oxygene 部分重用现有的 Delphi 业务层代码（一个 Visual Studio 插件，其语法与 Delphi 语法非常相似）。CodeGear 将很快提供 Prism（可能在 2008 年底之前），它也将集成到 Visual Studio 中。

因为 .NET 数据访问和 UI 与 Delphi 完全不同，所以您必须从头开始（对于场景 1 和 2）。与 Visual Studio 2005 相比，Visual Studio 2008 提供了很多优势。

没有逐步进行这种迁移的事情，因为您在这里进行了完整的平台更改，所以这是一种全有或全无的方法。

这两种情况都需要相当长的时间（即使您有 Delphi 经验，让自己熟悉 .NET 世界也需要时间）。

Visual Studio 可以与 Crystal Reports 交互，并且与 SQL Server 配合得很好。

由于 Visual Studio 2008 提供了很多好处（不仅是 .NET 3.5，而且还提高了生产力），因此您最好继续这样做。在 UI 方面，您需要在 WinForms（又名 Windows 窗体）和 Windows Presentation Foundation（又名 WPF）之间做出平衡的选择。

如果它是一对一的重写，您可能希望坚持使用 WinForms，因为它对您所拥有的内容很熟悉。您可能需要使用一些 3rd 方组件来启动您的 UI；DevExpress 是一个不错的选择，因为它们在 Delphi 和 Visual Studio 中有类似的组件。

但是，如果您想追求未来的视觉效果，那么您可能会考虑 WPF。准备好在这里比 WinForms 更陡峭的学习曲线，因为它与您习惯的非常不同。

如果您决定继续使用 Delphi，您可能需要研究 VCL for Web（又名 IntraWeb）和 Delphi 2009（自 6 年前宣布 Delphi 7 以来，Delphi 世界发生了很大变化）。

祝您选择顺利！

——杰伦

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-21T15:38:06.167

我建议从 RemObjects 看 Hydra。它基本上为您提供了 com 接口，并为您的 Delphi 和 .Net 应用程序之间的接口提供了一个观察者模式。您可以在 Delphi 应用程序内的面板上显示 .Net 表单。这提供了一个很好的迁移路径，您可以在将功能迁移到 .Net 时一点一点地替换您的 Delphi 代码。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-11-03T08:41:05.177

John Brant、Don Roberts 等人发表了一份科学报告，将 150 万行的 Delphi 项目成功转换为 C#。他在 AST 上编写了一个 Delphi 解析器、一个 C# 生成器和许多转换规则。逐渐扩展规则集，进行日常构建，大量单元测试，以及一些困难的 Delphi 部分的重写，使他有了一个 4 人的团队，其中一些原始开发人员具有深厚的 Delphi 和 C# 知识，可以迁移软件在 18 个月内。John Brant 和 Don Roberts 作为重构浏览器和 SmaCC 编译器构建工具包的原始开发人员，您不太可能走得那么快。

尽管这是一项重大投资，但它与“原始开发项目的规模不同”。作者指出，正如 Jeroen 所指出的那样，直接重写，无需工具或使用单次工具，很可能会导致这种情况，尤其是在考虑到新需求的情况下。

作者在为不同项目留在同一平台上的同时进行了大规模重构，完全取代了持久性基础设施。这可能与基于旧（BDE？）的项目有关。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-16T07:57:10.060

对我来说，问题是：您将使用哪种语言？我确实希望 C# 而不是 VB.Net。（由于这个用例中的所有尴尬政治，这无论如何都不清楚。）

接下来你可能会听到有一些转换器可以帮助你做到这一点。我们刚刚对此类转换器（Delphi 7 到 C#）进行了评估，非常棒！失望的。

我可以建议妥协吗？德尔福棱镜怎么样？它是VS2008中的Delphi。当然，您仍然拥有 Delphi 和 Codegear，但您也拥有 VS（正如您的公司所期望的那样）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-16T02:03:17.780

只有您才能真正决定是否可以使用逐件方法。例如，应用程序是否可以轻松拆分，或者所有表单与所有业务逻辑的耦合过于紧密。从技术上讲这是可能的，但这一切都取决于代码库的结构。

# grails - 一个视图中的两个域对象

> ID：207185
> 
> 赞同：3
> 
> 时间：2008-10-16T02:03:00.760
> 
> 标签：grails

例如，当调用 list 方法时，两个域对象可以显示在同一页面上吗？

[http://APP_NAME/foo/list](http://APP_NAME/foo/list)

* * *

```
def list = {
    if(!params.max) params.max = 10
    [ fooList: Foo.list( params ) ]
    [ barList: Bar.list( params ) ]  // Only the last one is returned.

} 
```

* * *

在视图页面上，两个表都将显示在页面上。

```
<g:each in="${fooList}" status="i" var="foo"> ... </g:each>
 <g:each in="${barList}" status="i" var="bar"> </g:each>

```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-16T02:13:36.417

很确定您可以在最后一行返回多个内容：

[ fooList：Foo.list（参数），barList：Bar.list（参数）]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T07:06:51.940

接受的答案中的逗号是正确的，您可以删除 // 行。

# sql - SQL Server 2008 地理空间查询

> ID：207189
> 
> 赞同：3
> 
> 时间：2008-10-16T02:07:57.020
> 
> 标签：sql, sql-server, geospatial

SQL Server 2008 具有新的地理数据类型。我想知道的一件事是，如果我有一个带有地理编码地址的表，我可以编写一个查询来显示一定距离内的所有记录。例如，许多网站都可以选择搜索特定距离（例如 50 英里）内的项目，并且如果 SQL 2008 开箱即用地提供此功能，他们希望这样做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-16T09:36:02.653

这正是[空间索引](http://www.rtreeportal.org/)旨在支持的查询类型。 [此博客条目](http://blogs.msdn.com/isaac/archive/2007/05/16/sql-server-spatial-support-an-introduction.aspx)提供了包含此类查询的快速介绍。

# sql-server - Sql Server 字符串到日期的转换

> ID：207190
> 
> 赞同：205
> 
> 时间：2008-10-16T02:08:51.683
> 
> 标签：sql-server, tsql, datetime, sql-server-2005, string-to-datetime

我想像这样转换一个字符串：

```
'10/15/2008 10:06:32 PM' 
```

到 Sql Server 中的等效 DATETIME 值。

在 Oracle 中，我会这样说：

```
TO_DATE('10/15/2008 10:06:32 PM','MM/DD/YYYY HH:MI:SS AM') 
```

[这个问题](https://stackoverflow.com/questions/202243/custom-datetime-formatting-in-sql-server)意味着我必须将字符串解析为一种[标准格式](http://www.sql-server-helper.com/tips/date-formats.aspx)，然后使用其中一种代码进行转换。对于如此平凡的操作来说，这似乎很可笑。有没有更简单的方法？

* * *

## 回答 #1

> 赞同：335
> 
> 时间：2011-08-24T12:26:05.590

试试这个

```
Cast('7/7/2011' as datetime) 
```

和

```
 Convert(DATETIME, '7/7/2011', 101) 
```

有关详细信息，请参阅[CAST 和 CONVERT (Transact-SQL)](https://msdn.microsoft.com/en-us/library/ms187928(v=sql.90).aspx)。

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2008-10-16T02:30:50.377

通过您的查询处理器运行它。它像这样格式化日期和/或时间，其中之一应该给你你正在寻找的东西。不难适应：

```
Declare @d datetime
select @d = getdate()

select @d as OriginalDate,
convert(varchar,@d,100) as ConvertedDate,
100 as FormatValue,
'mon dd yyyy hh:miAM (or PM)' as OutputFormat
union all
select @d,convert(varchar,@d,101),101,'mm/dd/yy'
union all
select @d,convert(varchar,@d,102),102,'yy.mm.dd'
union all
select @d,convert(varchar,@d,103),103,'dd/mm/yy'
union all
select @d,convert(varchar,@d,104),104,'dd.mm.yy'
union all
select @d,convert(varchar,@d,105),105,'dd-mm-yy'
union all
select @d,convert(varchar,@d,106),106,'dd mon yy'
union all
select @d,convert(varchar,@d,107),107,'Mon dd, yy'
union all
select @d,convert(varchar,@d,108),108,'hh:mm:ss'
union all
select @d,convert(varchar,@d,109),109,'mon dd yyyy hh:mi:ss:mmmAM (or PM)'
union all
select @d,convert(varchar,@d,110),110,'mm-dd-yy'
union all
select @d,convert(varchar,@d,111),111,'yy/mm/dd'
union all
select @d,convert(varchar,@d,12),12,'yymmdd'
union all
select @d,convert(varchar,@d,112),112,'yyyymmdd'
union all
select @d,convert(varchar,@d,113),113,'dd mon yyyy hh:mm:ss:mmm(24h)'
union all
select @d,convert(varchar,@d,114),114,'hh:mi:ss:mmm(24h)'
union all
select @d,convert(varchar,@d,120),120,'yyyy-mm-dd hh:mi:ss(24h)'
union all
select @d,convert(varchar,@d,121),121,'yyyy-mm-dd hh:mi:ss.mmm(24h)'
union all
select @d,convert(varchar,@d,126),126,'yyyy-mm-dd Thh:mm:ss:mmm(no spaces)' 
```

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2011-08-25T00:43:01.247

在 SQL Server Denali 中，您将能够做一些接近您正在寻找的事情。但是您仍然不能只传递任何任意定义的古怪日期字符串并期望 SQL Server 能够适应。这是一个使用您在自己的答案中发布的内容的示例。FORMAT() 函数还可以接受语言环境作为可选参数 - 它基于 .Net 的格式，因此您希望看到的大多数（如果不是全部）标记格式都将存在。

```
DECLARE @d DATETIME = '2008-10-13 18:45:19';

-- returns Oct-13/2008 18:45:19:
SELECT FORMAT(@d, N'MMM-dd/yyyy HH:mm:ss');

-- returns NULL if the conversion fails:
SELECT TRY_PARSE(FORMAT(@d, N'MMM-dd/yyyy HH:mm:ss') AS DATETIME);

-- returns an error if the conversion fails:
SELECT PARSE(FORMAT(@d, N'MMM-dd/yyyy HH:mm:ss') AS DATETIME); 
```

我强烈建议您采取更多控制措施并清理您的日期输入。让人们使用他们想要的任何格式在自由文本表单字段中键入日期的日子现在应该已经过去了。如果有人进入 2011 年 8 月 9 日是 8 月 9 日还是 9 月 8 日？如果您让他们在日历控件上选择日期，则应用程序可以控制格式。无论您如何尝试预测用户的行为，他们总是会想出一种更愚蠢的方式来输入您没有计划的日期。

不过，在 Denali 之前，我认为 @Ovidiu 提供了迄今为止最好的建议……通过实现您自己的 CLR 函数，这可以变得相当简单。然后，您可以根据需要为任意数量的古怪非标准格式编写 case/switch。

* * *

**@dhergert 的更新**：

```
SELECT TRY_PARSE('10/15/2008 10:06:32 PM' AS DATETIME USING 'en-us');
SELECT TRY_PARSE('15/10/2008 10:06:32 PM' AS DATETIME USING 'en-gb'); 
```

结果：

```
2008-10-15 22:06:32.000
2008-10-15 22:06:32.000 
```

您仍然需要首先获得其他重要信息。您不能使用本机 T-SQL 来确定`6/9/2012`是 6 月 9 日还是 9 月 6 日。

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2008-10-29T20:33:16.700

SQL Server (2005, 2000, 7.0) 没有任何灵活甚至不灵活的方式来获取字符串格式的任意结构化日期时间并将其转换为日期时间数据类型。

所谓“任意”，我的意思是“写它的人，虽然可能不是你或我或地球另一端的人，但会认为是直观且完全显而易见的形式。” 坦率地说，我不确定有没有这样的算法。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2018-01-29T09:07:57.973

用这个：

```
SELECT convert(datetime, '2018-10-25 20:44:11.500', 121) -- yyyy-mm-dd hh:mm:ss.mmm 
```

并参考[官方文档](https://msdn.microsoft.com/en-us/library/ms187928(v=sql.90).aspx)中的表格获取转换代码。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2008-10-16T02:29:47.163

对于这个问题，我使用的最佳解决方案是在 Sql Server 2005 中有一个 CLR 函数，它使用 DateTime.Parse 或 ParseExact 函数之一来返回具有指定格式的 DateTime 值。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2011-08-23T14:22:53.310

**简短的回答：**

```
SELECT convert(date, '10/15/2011 00:00:00', 101) as [MM/dd/YYYY] 
```

其他日期格式可在[SQL Server Helper > SQL Server Date Formats中找到](http://www.sql-server-helper.com/tips/date-formats.aspx)

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2019-09-24T20:25:25.713

我花了一分钟才弄清楚这一点，所以在这里以防万一它可能对某人有所帮助：

在 SQL Server 2012 及更高版本中，您可以使用此功能：

```
SELECT DATEFROMPARTS(2013, 8, 19); 
```

以下是我最终提取日期部分以放入此函数的方式：

```
select
DATEFROMPARTS(right(cms.projectedInstallDate,4),left(cms.ProjectedInstallDate,2),right( left(cms.ProjectedInstallDate,5),2)) as 'dateFromParts'
from MyTable 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2020-06-07T04:19:25.647

我知道这是一个邪恶的旧帖子，有很多答案，但很多人认为他们需要将它们分开并将它们重新组合在一起，或者他们坚持认为没有办法隐含地进行 OP 原始要求的转换.

为了查看并希望为其他有相同问题的人提供一个简单的答案，OP 询问如何将 '10/15/2008 10:06:32 PM' 转换为 DATETIME。现在，SQL Server 确实对时间转换有一些语言依赖性，但是如果语言是英语或类似的语言，这将成为一个简单的问题……只需进行转换，不要担心格式。例如（您可以使用 CONVERT 或 CAST）...

```
 SELECT UsingCONVERT = CONVERT(DATETIME,'10/15/2008 10:06:32 PM')
        ,UsingCAST   = CAST('10/15/2008 10:06:32 PM' AS DATETIME)
; 
```

...这会产生以下答案，这两个答案都是正确的。

[![在此处输入图像描述](https://i.stack.imgur.com/gkIZM.png)](https://i.stack.imgur.com/gkIZM.png)

就像他们在电视广告中所说的那样，“但是等等！不要订购！无需额外费用，它可以做得更多！”

让我们看看使用 DATETIME 进行时间转换的真正威力，并部分检查称为 DATETIME2 的错误。查看 DATETIME 可以自动处理而 DATETIME2 不能处理的古怪格式。运行以下代码，看看...

```
--===== Set the language for this example.
    SET LANGUAGE ENGLISH --Same a US-English
;
--===== Use a table constructor as if it were a table for this example.
 SELECT *
        ,DateTimeCONVERT  = TRY_CONVERT(DATETIME,StringDT)
        ,DateTimeCAST     = TRY_CAST(StringDT AS DATETIME)
        ,DateTime2CONVERT = TRY_CONVERT(DATETIME2,StringDT)
        ,DateTime2CAST    = TRY_CAST(StringDT AS DATETIME2)
   FROM (
         VALUES
         ('Same Format As In The OP'    ,'12/16/2001 01:51:01 PM')
        ,('Almost Normal'               ,'16 December, 2001 1:51:01 PM')
        ,('More Normal'                 ,'December 16, 2001 01:51:01 PM')
        ,('Time Up Front + Spaces'      ,'   13:51:01  16 December   2001')
        ,('Totally Whacky Format #01'   ,'  16  13:51:01  December   2001')
        ,('Totally Whacky Format #02'   ,'  16    December 13:51:01  2001  ')
        ,('Totally Whacky Format #03'   ,'  16    December 01:51:01  PM 2001  ')
        ,('Totally Whacky Format #04'   ,' 2001 16    December 01:51:01  PM ')
        ,('Totally Whacky Format #05'   ,' 2001    December 01:51:01  PM  16  ')
        ,('Totally Whacky Format #06'   ,' 2001 16    December  01:51:01 PM  ')
        ,('Totally Whacky Format #07'   ,' 2001 16    December  13:51:01 PM  ')
        ,('Totally Whacky Format #08'   ,' 2001 16  13:51:01 PM  December    ')
        ,('Totally Whacky Format #09'   ,'   13:51:01   PM  2001.12/16 ')
        ,('Totally Whacky Format #10'   ,'   13:51:01   PM  2001.December/16 ')
        ,('Totally Whacky Format #11'   ,'   13:51:01   PM  2001.Dec/16 ')
        ,('Totally Whacky Format #12'   ,'   13:51:01   PM  2001.Dec.16 ')
        ,('Totally Whacky Format #13'   ,'   13:51:01   PM  2001/Dec.16')
        ,('Totally Whacky Format #14'   ,'   13:51:01   PM  2001 . 12/16 ')
        ,('Totally Whacky Format #15'   ,'   13:51:01   PM  2001 . December / 16 ')
        ,('Totally Whacky Format #16'   ,'   13:51:01   PM  2001 . Dec /   16 ')
        ,('Totally Whacky Format #17'   ,'   13:51:01   PM  2001 . Dec .   16 ')
        ,('Totally Whacky Format #18'   ,'   13:51:01   PM  2001 / Dec .   16')
        ,('Totally Whacky Format #19'   ,'   13:51:01   PM  2001 . Dec -   16 ')
        ,('Totally Whacky Format #20'   ,'   13:51:01   PM  2001 - Dec -   16 ')
        ,('Totally Whacky Format #21'   ,'   13:51:01   PM  2001 - Dec .   16')
        ,('Totally Whacky Format #22'   ,'   13:51:01   PM  2001 - Dec /   16 ')
        ,('Totally Whacky Format #23'   ,'   13:51:01   PM  2001 / Dec -   16')
        ,('Just the year'               ,' 2001      ')
        ,('YYYYMM'                      ,' 200112      ')
        ,('YYYY MMM'                    ,'2001 Dec')
        ,('YYYY-MMM'                    ,'2001-Dec')
        ,('YYYY    .     MMM'           ,'2001    .     Dec')
        ,('YYYY    /     MMM'           ,'2001    /     Dec')
        ,('YYYY    -     MMM'           ,'2001    /     Dec')
        ,('Forgot The Spaces #1'        ,'2001December26')
        ,('Forgot The Spaces #2'        ,'2001Dec26')
        ,('Forgot The Spaces #3'        ,'26December2001')
        ,('Forgot The Spaces #4'        ,'26Dec2001')
        ,('Forgot The Spaces #5'        ,'26Dec2001 13:51:01')
        ,('Forgot The Spaces #6'        ,'26Dec2001 13:51:01PM')
        ,('Oddly, this doesn''t work'   ,'2001-12')
        ,('Oddly, this doesn''t work'   ,'12-2001')
        ) v (Description,StringDT)
; 
```

所以，是的……SQL Server 实际上有一种非常灵活的方法来处理各种奇怪的时间格式，并且不需要特殊处理。我们甚至不需要删除添加到 24 小时时间的“PM”。它是“PFM”（纯粹的怪诞魔法）。

事情会有所不同，具体取决于您为服务器选择的语言，但无论哪种方式都可以处理很多。

而这些“自动魔法”转换并不是什么新鲜事。他们走了很长一段路。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-10-16T02:53:39.283

此[页面](http://msdn.microsoft.com/en-us/library/aa226054(SQL.80).aspx)包含对 CONVERT 函数可用的所有指定日期时间转换的一些参考。如果您的价值观不属于可接受的模式之一，那么我认为最好的办法是走 ParseExact 路线。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2012-04-01T15:32:45.073

就个人而言，如果您处理任意或完全不符合条件的格式，只要您提前知道它们是什么或将要成为什么，那么只需使用正则表达式提取您想要的日期部分并形成一个有效的日期/日期时间组件。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2021-10-05T22:16:22.903

##### 2021 年 10 月

这里最受好评的答案是[guravg](https://stackoverflow.com/a/7175369/1657465)和[Taptronic 的](https://stackoverflow.com/a/207232/1657465)。但是，我想做一个贡献。

他们显示的从 0 到 131 的特定格式编号可能会因您的用例而异（请参阅[此处的完整编号列表](https://docs.microsoft.com/en-us/sql/t-sql/functions/cast-and-convert-transact-sql?view=sql-server-ver15#date-and-time-styles)），**输入编号可以是不确定**的，这意味着预期结果日期在不同情况下不一致。此外，出于同样的原因，请避免使用[强制转换字符串方法。](https://stackoverflow.com/a/7175369/1657465)

> 从 SQL Server 2005 及其兼容级别 90 开始，隐式日期转换变得不确定。从级别 90 开始，日期转换依赖于 SET LANGUAGE 和 SET DATEFORMAT。

非确定性值为`0-100`, `106`, `107`, `109`, `113`, `130`. 这可能会导致错误。

* * *

最好的选择是坚持确定性设置，我目前的偏好是`ISO`格式（`12`、`112`、`23`、`126`），因为它们似乎是 IT 人员用例最标准的。

```
Convert(varchar(30), '210510', 12)                   -- yymmdd
Convert(varchar(30), '20210510', 112)                -- yyyymmdd
Convert(varchar(30), '2021-05-10', 23)               -- yyyy-mm-dd
Convert(varchar(30), '2021-05-10T17:01:33.777', 126) -- yyyy-mm-ddThh:mi:ss.mmm (no spaces) 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-16T02:50:26.717

如果您希望 SQL Server 尝试解决它，只需使用 CAST CAST('whatever' AS datetime) 但是这通常是一个坏主意。会出现国际日期的问题。如您所见，为避免这些问题，您需要使用 ODBC 规范的日期格式。即格式号 120，20 是仅两位数年份的格式。我不认为 SQL Server 具有允许您提供用户给定格式的内置功能。你可以自己写，如果你在网上搜索，甚至可能找到一个。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-02-17T15:35:54.697

在 MSSQL 中将字符串隐式转换为日期时间

```
create table tmp 
(
  ENTRYDATETIME datetime
);

insert into tmp (ENTRYDATETIME) values (getdate());
insert into tmp (ENTRYDATETIME) values ('20190101');  --convert string 'yyyymmdd' to datetime

select * from tmp where ENTRYDATETIME > '20190925'  --yyyymmdd 
select * from tmp where ENTRYDATETIME > '20190925 12:11:09.555'--yyyymmdd HH:MIN:SS:MS 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-12-16T08:14:57.267

您可以使用此代码轻松实现此目的。

选择转换（日期时间，转换（varchar（30），'10/15/2008 10:06:32 PM'，102），102）

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2021-04-13T08:37:51.090

这段代码解决了我的问题：

```
convert(date,YOUR_DATE,104) 
```

如果您正在使用`timestamp`，您可以使用以下代码：

```
convert(datetime,YOUR_DATE,104) 
```

* * *

## 回答 #17

> 赞同：-4
> 
> 时间：2019-11-20T14:09:34.567

```
dateadd(day,0,'10/15/2008 10:06:32 PM') 
```

# javascript - JavaScript 中的 XML

> ID：207193
> 
> 赞同：1
> 
> 时间：2008-10-16T02:11:15.877
> 
> 标签：javascript, xml, schema

我有一个 XML Schema，我在 JavaScript 中对其进行解析，然后将其打包为一个对象以传递给我的一个后端服务器。

架构就像

```
<complexType name='Test'>
    <sequence>  
        <element name='testField' type='string'/>
        <element name='typeSpecificSetting' type='tns:TypeSpecific'/>
    </sequence> 
</complexType>
<complexType name="TypeSpecific">
    <choice>   
         <element name='A' type='tns:ATYPE'/>
         <element name='B' type='tns:BTYPE'/>
         <element name='C' type='tns:CTYPE'/>
         <element name='D' type='tns:DTYPE'/>
    </choice>
</complexType>

<complexType name="ATYPE">
    <element name='testATYPEField' type='string'/>
</complexType>

<complexType name="BTYPE">
     <element name='testBTYPEField' type='string'/>
</complexType> 
```

我正在阅读 xml 架构，然后尝试构建我的请求对象。

```
request = { 
    testField:  t1,
    typeSpecificSetting: t2
} 
```

如何构造请求对象以供选择？根据类型，我必须打包 ATYPE 或 BTYPE 或 CTYPE 或 DTYPE 对象吗？我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T06:53:43.420

由于 typeSpecific 是一种只有一个选择的复杂类型，因此 typeSpecificSetting 属性将是一个包含一个属性的对象，该属性将是 testATYPEField、testBTYPEField、...

```
 request = {
     testField: t1
     typeSpecificSetting: {
         A: { 
             testATYPEField: t2
         }
     }
 } 
```

或者

```
 request = {
     testField: t1
     typeSpecificSetting: {
         B: { 
             testBTYPEField: t2
         }
     }
 } 
```

等等

# css - 在嵌套元素中切换 CSS 属性

> ID：207195
> 
> 赞同：5
> 
> 时间：2008-10-16T02:13:01.583
> 
> 标签：css

在不使用 Javascript 的情况下，有没有办法通过嵌套元素打开和关闭 CSS 属性。

我要解决的问题是我有许多标签和类，它们使一些文本斜体（`<em>`, `<blockquote>`, `<cite>`, `<q>`, `<dfn>`, 和其他一些类），当其中一个在另一个类中时，斜体需要切换。

```
<块引用>
    于是那个人说，<q>那不是来自<cite>麦田里的守望者</cite>，亲爱的
    伙计！</q>，你能相信吗？！
</blockquote>

```

应呈现为：

> *于是那人说：* “那不是*麦田里的守望*者，亲爱的！” *， 你相信吗？！*

我为此得到的 CSS 有点乱：

```
q, em, dfn, cite, blockquote {
    font-style: italic;
}
q q, q em, q dfn, q cite,
em q, em em, em dfn, em cite,
dfn q, dfn em, dfn dfn, dfn cite,
cite q, cite em, cite dfn, cite cite,
blockquote q, blockquote em, blockquote dfn, blockquote cite {
    font-style: normal;
} 
```

...而且我很确定这甚至不会超过一层嵌套（如我的示例所示）。

有没有一种方法可以做到这一点而不必列出标签的每个排列？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-16T04:24:59.943

我不能告诉你哪些浏览器（如果有的话）实现了 CSS3`:not`伪类，但如果我们看到它支持某个时候似乎我们可以做到：

```
q:not(q, em, dfn, cite, blockquote),
em:not(q, em, dfn, cite, blockquote),
dfn:not(q, em, dfn, cite, blockquote),
cite:not(q, em, dfn, cite, blockquote),
blockquote:not(q, em, dfn, cite, blockquote) { font-style: italic; }

```

任何人都猜测浏览器将如何实现这一点，因此它的工作深度可能不会超过 2 个级别（如您的示例）。

除此之外，不幸的是我想不出另一种纯 CSS 解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T02:21:32.937

我将使用为每个排列生成必要的嵌套规则的脚本来管理它。这是我不会发疯维护它的唯一方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-03T18:48:58.627

在 CSS3 中可以有一个简单的解决方案：

```
em {
    font-style: toggle(italic, normal);
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-16T10:16:59.047

你说你有各种各样的元素需要显示为斜体，但是一旦嵌套它们就需要打破以前的斜体。请原谅我这么说，但我真的很想知道一个人是否真的想要这种行为。

请允许我自己解释一下：您有不同的标记，例如引号、引文、强调等。当嵌套使用时，引号内的强调应该与在引号外使用时具有不同的含义。因此，默认的 css 规则适用于下面的所有内容。因此，我不理解将有意义的嵌套标记展平为斜体和非斜体的愿望，因为它隐藏了手头内容的潜在含义（因为类似的格式将应用于文档的不同有意义的部分）。

我的建议是：

*   假设您的标记存在是有原因的，所以保持样式不变。嵌套在块引用中的强调应始终具有其祖先元素的样式，因为这种嵌套是有原因的，并且不应以视觉方式为用户隐藏
*   仔细检查文档的要求，看看你是否真的想要这样的嵌套。如果没有，通用 HTML 编辑器可能不足以满足您的需求，您最好使用验证特定模式的 xml 格式，在您的情况下，该模式将禁止在其他模式中使用某些元素。然后使用 Xopus 或 XmlSpy 等 xml 编辑器来编辑您的文档。

抱歉，如果这不是您问题的直接解决方案，但我希望能够为您提供另一种看待问题的观点，也许可以看到可能根本没有问题。祝你好运！

# delphi - 如何在启动 Delphi 应用程序时捕获修饰键以强制执行某些行为

> ID：207212
> 
> 赞同：4
> 
> 时间：2008-10-16T02:19:49.820
> 
> 标签：delphi, sqlite

我正在使用 SQLite3 数据库在 Delphi 中编写一个应用程序。我希望能够在按住一些修饰键（例如 CTRL + SHIFT）的同时启动应用程序，以发出重新初始化数据库的信号。

如何在持有这些键时捕获应用程序已启动？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-16T04:33:44.543

蒂姆有正确的答案，但你可能需要更多的框架：

```
procedure TForm56.Button1Click(Sender: TObject);
begin
  if fNeedReinit then
    ReinitializeDatabase;
end;

procedure TForm56.FormCreate(Sender: TObject);
begin
  fNeedReinit := False;
end;

procedure TForm56.FormShow(Sender: TObject);
begin
 fNeedReinit := (GetKeyState(VK_SHIFT) < 0) and (GetKeyState(VK_CONTROL) < 0);
end; 
```

使用稍后的事件更改 Button1Click，以检查是否已设置 fNeedReinit。如果您无法捕捉到击键，您还可以在主窗体上设置 KeyPreview。我刚刚测试了上面的代码，它可以工作，但如果你有启动画面等，那么它可能会改变一些事情。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-16T03:47:12.733

```
if (GetKeyState(VK_SHIFT) < 0) and (GetKeyState(VK_CONTROL) < 0) then
  ReinitializeDatabase; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T03:03:43.960

尝试[GetAsyncKeyState](http://msdn.microsoft.com/en-us/library/ms646293(VS.85).aspx)、[GetKeyState](http://msdn.microsoft.com/en-us/library/ms646301(VS.85).aspx)或[GetKeyboardState](http://msdn.microsoft.com/en-us/library/ms646299(VS.85).aspx) API 函数之一，以在程序启动时读取 ctrl 和 shift 键的当前状态。在启动时添加键盘钩子可能不起作用，因为在您的应用程序有机会安装钩子之前，可能已经发生了 shift 键的按键事件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T02:26:51.773

您必须在应用程序中捕获键盘挂钩。 [请参阅此处](http://www.delphifaq.com/faq/delphi_windows_API/f512.shtml) ，然后在显示主表单之前处理挂钩 - 例如在 dpr 文件中的 CreateForm 和 Run 之前

# php - 没有 SQL 的 PHP 动态分页

> ID：207223
> 
> 赞同：7
> 
> 时间：2008-10-16T02:24:11.560
> 
> 标签：php, pagination

我有一个脚本可以动态调用和显示目录中的图像，最好的分页方式是什么？我希望能够通过脚本中的变量控制每页显示的图像数量。我正在考虑使用 URL 变量（即 - [http://domain.com/page.php?page=1](http://domain.com/page.php?page=1)），但我不确定如何去做。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-16T04:40:38.367

这是我经常用来做分页的功能。希望能帮助到你。

```
function paginate($page, $total, $per_page) {
    if(!is_numeric($page)) { $page = 1; }
    if(!is_numeric($per_page)) { $per_page = 10; }
    if($page > ceil($total / $per_page)) $page = 1;
    if($page == "" || $page == 0) { 
        $page = 1;
        $start = 0;
        $end = $per_page;
    } else {
        $start = ($page * $per_page) - ($per_page);
        $end = $per_page;
    }

    $prev_page = "";
    $next_page = "";
    $all_pages = array();
    $selected = "";
    $enabled = false;

    if($total > $per_page) {
        $enabled = true;
        $prev = $page - 1;
        $prev_page = ($prev == 0) ? 0 : $prev;

        $next = $page + 1;
        $total_pages = ceil($total/$per_page);

        $next_page = ($next <= $total_pages) ? $next : 0;

        for($x=1;$x<=$total_pages;$x++) {
            $all_pages[] = $x;
            $selected = ($x == $page) ? $x : $selected; 
        }
    }

    return array(
        "per_page" => $per_page,
        "page" => $page,
        "prev_page" => $prev_page,
        "all_pages" => $all_pages,
        "next_page" => $next_page,
        "selected" => $selected,
        "start" => $start,
        "end" => $end,
        "enabled" => $enabled
    );
}

// ex: we are in page 2, we have 50 items, and we're showing 10 per page
print_r(paginate(2, 50, 10)); 
```

这将返回：

```
Array
(
    [per_page] => 10
    [page] => 2
    [prev_page] => 1
    [all_pages] => Array
        (
            [0] => 1
            [1] => 2
            [2] => 3
            [3] => 4
            [4] => 5
        )
    [next_page] => 3
    [selected] => 2
    [start] => 10
    [end] => 10
    [enabled] => 1
) 
```

有了所有这些数据，您就可以很好地制作分页链接。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-16T03:01:42.560

分页是有或没有 sql 的相同概念。你只需要你的基本变量，然后你就可以创建你想要的内容。这是一些准代码：

```
$itemsPerPage = 5;

$currentPage = isset($_GET['page']) ? $_GET['page'] : 1;
$totalItems = getTotalItems();
$totalPages = ceil($totalItems / $itemsPerPage);

function getTotalItems() {
// since they're images, perhaps we'll scan a directory of images to determine
// how many images we have in total
}

function getItemsFromPage($page, $itemsPerPage) {
// function to grab $itemsPerPage based on which $page we're on
}

function getPager($totalPages, $currentPage) {
// build your pager
} 
```

希望能帮助您入门！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T04:09:52.720

如果您将图像命名为 01.jpg、02.jpg，则可以更轻松地进行分页。然后使用 glob 将所有图像放入一个数组并对其进行排序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T20:17:59.833

如有疑问，请使用 javascript！这也可能有帮助：[http ://www.webplicity.net/flexigrid/](http://www.webplicity.net/flexigrid/)

可能对类似画廊的应用程序有好处，尽管我从未尝试过:)

# python - 使用异步 (s)ftp 操作连接 GUI 界面

> ID：207230
> 
> 赞同：1
> 
> 时间：2008-10-16T02:30:34.433
> 
> 标签：python, windows, user-interface, ftp, sftp

试图为文件上传实现一个进度对话框窗口，看起来像是[IE 下载对话框](http://www.codinghorror.com/blog/images/ie6-download-ui.png)和[Firefox 下载对话框](http://www.codinghorror.com/blog/images/firefox2-download-ui.png)之间的交叉，在 Windows 上使用 python GUI 库。

1.  python有哪些异步（S）FTP库？理想情况下，我应该能够恢复文件上传并跟踪每个并行文件上传的进度。
2.  如果我在单独的进程中运行每个文件上传，如何获取上传状态并将其显示在进度条对话框中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T03:42:07.860

“ftplib”是 Python 内置的标准 ftp 库。在 Python 2.6 中，它在用于上传的方法中添加了一个回调参数。

该回调是您提供给库的函数；每个完成的块都会调用一次。

您的函数可以向 GUI 发送消息（可能在不同的线程/进程上，使用标准的线程间或进程间通信）告诉它更新其进度条。

[参考](http://docs.python.org/library/ftplib.html "Python 2.6 ftplib 手册")

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T08:38:06.080

如果您想要一个完整的示例，了解如何使用线程和事件来使用 WxPython 使用长时间运行的任务更新您的 GUI，请查看此[页面](http://wiki.wxpython.org/LongRunningTasks)。本教程非常有用，并帮助我执行了与您的程序类似的程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T09:31:54.753

如果您的数据传输在与 GUI 不同的线程中运行，您可以在必须从数据传输线程更新进度条时使用 wx.CallAfter()。

首先，必须使用 CallAfter()，因为不能从子线程调用 wxPython 函数。

其次，这将使数据传输的执行与主线程中的 GUI 分离。

请注意，CallAfter() 仅适用于线程，不适用于单独的进程。在这种情况下，使用 multiprocessing 包应该会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-19T14:14:17.817

如果你不能使用 Python 2.6 的 ftplib，有一家公司提供*商业*解决方案。

Chilkat的[CKFTP2](http://www.chilkatsoft.com/refdoc/pythonCkFtp2Ref.html "CKFTP2 手册")花费数百美元，但承诺与 Python 2.5 一起使用，并提供一个函数调用 get_AsyncBytesSent() 来返回您需要的信息。（我没有看到回调，但它也可能提供回调。）

我没用过这个产品。

还要考虑如果 FTP 被证明太难/太贵，你总是可以切换到 HTTP 上传。Chilkat 有一个免费的 HTTP/HTTPS 上传库。

# python - Python中本地网络的IP地址/主机名列表

> ID：207234
> 
> 赞同：44
> 
> 时间：2008-10-16T02:32:33.820
> 
> 标签：python, networking

如何在 Python 中轻松地从本地网络获取 IP 地址或主机名列表？

最好是多平台的，但它需要先在 Mac OS X 上运行，然后其他的。

**编辑：**本地是指本地网络中的所有**活动**地址，例如`192.168.xxx.xxx`.

因此，如果我的计算机（在本地网络中）的 IP 地址是`192.168.1.1`，并且我有另外三台连接的计算机，我希望它返回 IP 地址`192.168.1.2`、`192.168.1.3`、`192.168.1.4`，可能还有它们的主机名。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-10-16T02:38:02.997

如果“本地”是指在同一网段上，则必须执行以下步骤：

1.  确定自己的 IP 地址
2.  确定自己的网络掩码
3.  确定网络范围
4.  扫描所有地址（除了最低的，这是您的网络地址，最高的，这是您的广播地址）。
5.  使用 DNS 的反向查找来确定响应扫描的 IP 地址的主机名。

或者您可以让 Python 在外部执行 nmap 并将结果通过管道传回您的程序。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-03-02T16:27:29.227

**更新**：该脚本现在位于[github 上](http://github.com/bwaldvogel/neighbourhood)。

我写了一个[小的 python 脚本](https://github.com/bwaldvogel/neighbourhood/blob/master/neighbourhood.py)，它利用了[scapy](http://www.secdev.org/projects/scapy/)的`arping()`。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-16T08:27:41.420

如果您知道您的计算机的名称，您可以使用：

```
import socket
IP1 = socket.gethostbyname(socket.gethostname()) # local IP adress of your computer
IP2 = socket.gethostbyname('name_of_your_computer') # IP adress of remote computer 
```

否则，您将不得不扫描与本地计算机 (IP1) 具有相同掩码的所有 IP 地址，如另一个答案中所述。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2018-02-04T11:58:37.673

我从其他一些线程中收集了以下功能，它在 Ubuntu 中对我有用。

```
import os
import socket    
import multiprocessing
import subprocess
import os

def pinger(job_q, results_q):
    """
    Do Ping
    :param job_q:
    :param results_q:
    :return:
    """
    DEVNULL = open(os.devnull, 'w')
    while True:

        ip = job_q.get()

        if ip is None:
            break

        try:
            subprocess.check_call(['ping', '-c1', ip],
                                  stdout=DEVNULL)
            results_q.put(ip)
        except:
            pass

def get_my_ip():
    """
    Find my IP address
    :return:
    """
    s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
    s.connect(("8.8.8.8", 80))
    ip = s.getsockname()[0]
    s.close()
    return ip

def map_network(pool_size=255):
    """
    Maps the network
    :param pool_size: amount of parallel ping processes
    :return: list of valid ip addresses
    """

    ip_list = list()

    # get my IP and compose a base like 192.168.1.xxx
    ip_parts = get_my_ip().split('.')
    base_ip = ip_parts[0] + '.' + ip_parts[1] + '.' + ip_parts[2] + '.'

    # prepare the jobs queue
    jobs = multiprocessing.Queue()
    results = multiprocessing.Queue()

    pool = [multiprocessing.Process(target=pinger, args=(jobs, results)) for i in range(pool_size)]

    for p in pool:
        p.start()

    # cue hte ping processes
    for i in range(1, 255):
        jobs.put(base_ip + '{0}'.format(i))

    for p in pool:
        jobs.put(None)

    for p in pool:
        p.join()

    # collect he results
    while not results.empty():
        ip = results.get()
        ip_list.append(ip)

    return ip_list

if __name__ == '__main__':

    print('Mapping...')
    lst = map_network()
    print(lst) 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2019-12-30T02:48:32.080

对于 OSX（和 Linux），一个简单的解决方案是使用 os.popen 或 os.system 并运行`arp -a`命令。

例如：

```
devices = []
for device in os.popen('arp -a'): devices.append(device) 
```

这将为您提供本地网络上的设备列表。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2019-07-09T10:05:51.773

我[在 python 文章中找到了这个网络扫描仪](https://www.geeksforgeeks.org/network-scanner-in-python/)并写了这个短代码。它做你想做的！但是，您确实需要知道设备的可访问端口。端口 22 是 ssh 标准和我正在使用的。我想你可以遍历所有端口。一些默认值是：

```
linux: [20, 21, 22, 23, 25, 80, 111, 443, 445, 631, 993, 995]
windows: [135, 137, 138, 139, 445]
mac: [22, 445, 548, 631] 
```

```
import socket

def connect(hostname, port):
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    socket.setdefaulttimeout(1)
    result = sock.connect_ex((hostname, port))
    sock.close()
    return result == 0

for i in range(0,255):
    res = connect("192.168.1."+str(i), 22)
    if res:
        print("Device found at: ", "192.168.1."+str(i) + ":"+str(22)) 
```

* * *

**TheLizzard**编辑：****

 **使用上面的代码并添加线程：

```
from threading import Thread, Lock
from time import perf_counter
from sys import stderr
from time import sleep
import socket

# I changed this from "192.168.1.%i" to "192.168.0.%i"
BASE_IP = "192.168.0.%i"
PORT = 80

class Threader:
    """
    This is a class that calls a list of functions in a limited number of
    threads. It uses locks to make sure the data is thread safe.
    Usage:
        from time import sleep

        def function(i):
            sleep(2)
            with threader.print_lock:
                print(i)

        threader = Threader(10) # The maximum number of threads = 10
        for i in range(20):
            threader.append(function, i)
        threader.start()
        threader.join()

    This class also provides a lock called: `<Threader>.print_lock`
    """
    def __init__(self, threads=30):
        self.thread_lock = Lock()
        self.functions_lock = Lock()
        self.functions = []
        self.threads = []
        self.nthreads = threads
        self.running = True
        self.print_lock = Lock()

    def stop(self) -> None:
        # Signal all worker threads to stop
        self.running = False

    def append(self, function, *args) -> None:
        # Add the function to a list of functions to be run
        self.functions.append((function, args))

    def start(self) -> None:
        # Create a limited number of threads
        for i in range(self.nthreads):
            thread = Thread(target=self.worker, daemon=True)
            # We need to pass in `thread` as a parameter so we
            # have to use `<threading.Thread>._args` like this:
            thread._args = (thread, )
            self.threads.append(thread)
            thread.start()

    def join(self) -> None:
        # Joins the threads one by one until all of them are done.
        for thread in self.threads:
            thread.join()

    def worker(self, thread:Thread) -> None:
        # While we are running and there are functions to call:
        while self.running and (len(self.functions) > 0):
            # Get a function
            with self.functions_lock:
                function, args = self.functions.pop(0)
            # Call that function
            function(*args)

        # Remove the thread from the list of threads.
        # This may cause issues if the user calls `<Threader>.join()`
        # But I haven't seen this problem while testing/using it.
        with self.thread_lock:
            self.threads.remove(thread)

start = perf_counter()
# I didn't need a timeout of 1 so I used 0.1
socket.setdefaulttimeout(0.1)

def connect(hostname, port):
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
        result = sock.connect_ex((hostname, port))
    with threader.print_lock:
        if result == 0:
            stderr.write(f"[{perf_counter() - start:.5f}] Found {hostname}\n")

threader = Threader(10)
for i in range(255):
    threader.append(connect, BASE_IP%i, PORT)
threader.start()
threader.join()
print(f"[{perf_counter() - start:.5f}] Done searching")
input("Press enter to exit.\n? ") 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-08-19T14:52:13.307

尝试：

```
import socket

print ([ip for ip in socket.gethostbyname_ex(socket.gethostname())[2] if not ip.startswith("127.")][:1]) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-10-30T16:10:42.773

我已经完成了以下代码来获取 MAC 已知设备的 IP。这可以进行相应的修改，以通过一些字符串操作来获取所有 IP。希望这会帮助你。

```
#running windows cmd line  statement and put output into a string
cmd_out = os.popen("arp -a").read()
line_arr = cmd_out.split('\n')
line_count = len(line_arr)

#search in all lines for ip
for i in range(0, line_count):
    y = line_arr[i]
    z = y.find(mac_address)

    #if mac address is found then get the ip using regex matching
    if z > 0:
        ip_out= re.search('[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+', y, re.M | re.I) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2022-01-15T19:56:58.993

我刚刚遇到了这个问题。我是这样解决的：

```
import kthread #pip install kthread
from time import sleep
import subprocess

def getips():
    ipadressen = {}
    def ping(ipadresse):
        try:
            outputcap = subprocess.run([f'ping', ipadresse, '-n', '1'], capture_output=True) #sends only one package, faster
            ipadressen[ipadresse] = outputcap
        except Exception as Fehler:
            print(Fehler)
    t = [kthread.KThread(target = ping, name = f"ipgetter{ipend}", args=(f'192.168.0.{ipend}',)) for ipend in range(255)] #prepares threads
    [kk.start() for kk in t] #starts 255 threads
    while len(ipadressen) < 255:
        print('Searching network')
        sleep(.3)
    alldevices = []
    for key, item in ipadressen.items():
        if not 'unreachable' in item.stdout.decode('utf-8') and 'failure' not in item.stdout.decode('utf-8'): #checks if there wasn't neither general failure nor 'unrechable host'
            alldevices.append(key)
    return alldevices

allips = getips() #takes 1.5 seconds on my pc 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-10-16T02:36:34.357

[此问题](https://stackoverflow.com/questions/166506/finding-local-ip-addresses-in-python)中的一个答案可能会对您有所帮助。python似乎有一个与平台无关的版本，但我还没有尝试过。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2016-04-24T09:03:01.377

这是一个小工具**scanip**，可以帮助您获取网络中的所有ip地址及其对应的mac地址（适用于Linux）。

[https://github.com/vivkv/scanip](https://github.com/vivkv/scanip)

# java - 一个团队的 Java 多 IDE 支持

> ID：207237
> 
> 赞同：7
> 
> 时间：2008-10-16T02:33:20.573
> 
> 标签：java, eclipse, ide, netbeans, intellij-idea

什么是允许程序员团队在同一个项目中使用 Netbeans、Eclipse 和 IntelliJ 的最佳方式，从而消除“哪个 IDE 更好”的问题。

哪些文件应该或不应该签入源代码控制？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-16T13:31:07.547

我认为最好的方法是让构建过程独立于 IDE。这意味着您的项目不应依赖任何特定于 IDE 的文件来构建，而应使用外部构建系统，如[Apache Maven](http://maven.apache.org/)、[Apache Ant](http://ant.apache.org)，甚至是制作或自定义脚本。大多数流行的 Java IDE 直接或通过插件支持 Maven。

如果您不想使用外部构建系统，您至少应该使项目尽可能易于设置（即通过为共享库和其他依赖项设置标准文件夹）。过去，当我在具有多个 IDE 的团队中工作时，我花费最多的时间来解决依赖关系，因为构建项目的先决条件会随着时间的推移而发生变化。在最坏的情况下，您甚至可能最终导致开发人员不愿意从版本控制存储库中获取最新版本，因为他们认为设置新项目非常麻烦。

如果您的项目有许多库依赖项，我认为在版本控制存储库中以二进制形式提供这些是一个好主意。这样人们就不必解决依赖关系的所有依赖关系等等，只是为了构建一个项目。但是，这确实要求您有人负责在“官方”二进制文件发生更改时保持最新状态。（这与 Maven 存储库使用的理念几乎相同，但即使不使用 Maven，也可以手动应用这些原则。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-16T02:35:59.257

嗯，这是一个非常自我回答的问题。

不签入源代码控制的文件是与 IDE 本身有关的文件。

让开发人员生成这些文件。

如果您使用 Maven，它可以为您生成 Eclipse 等`.project`文件`.classpath`。一般来说，Eclipse 非常易于使用基本文件结构（使用新`Java Project`选项）。

我认为 Maven 也支持 Netbeans，但不确定 IntelliJ。

Maven 的站点是[maven.apache.org](http://maven.apache.org)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-16T02:50:22.070

对于拥有多个开发人员的每个 IDE，请签入所有支持文件。为什么要在每张桌子上重新发明轮子。

我已经使用许多不同的 IDE 完成了此操作，但我还没有看到文件名冲突。

事实上，即使只有一个开发人员使用特定的 IDE，对支持文件进行版本控制对他/她来说也是有利的，原因与您在开发环境中对其他文件进行版本控制的原因相同：历史记录、差异、注释等。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-16T03:36:21.897

对于 Eclipse，这将是 .classpath 和 .project 文件。

我的团队使用 Maven，并且不鼓励开发人员签入特定于 Eclipse 的文件。因为它们可以从 Maven 生成，所以这些文件是多余的。

此外，检查特定于项目的文件似乎可以节省时间，但由于不同开发人员工作站的差异，它通常会很痛苦，导致浪费时间解决特定于 IDE 的文件中的冲突。解决这个问题的唯一方法是强制每个人都以相同的方式设置他们的环境，这违背了与 IDE 无关的方法。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-16T02:40:59.780

在同一个项目团队中使用多个工具集时有许多注意事项。例如，我的团队有使用 IntelliJ 的 Java 开发人员和使用 eclipse 的大多数前端（JSP/CSS/HTML）开发人员。我们正在将 Eclipse 用户迁移到 IntelliJ，因为我们开发的一些 IntelliJ 插件为我们的环境提供了扩展支持。我们不会为多个平台开发插件，因此我们将全面标准化 IntelliJ。

具体文件方面，我可以和 IntelliJ 谈谈。我们已经签入了 .ipr 文件和 .iml 文件。不要签入 .iws 文件。如果您还有 Eclipse 用户，请将您的 IntelliJ 项目配置为在 .classpath 文件中读取/存储依赖信息并将其提交到您的 VCS。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-16T13:19:41.830

我们有意支持来自同一个 SVN 存储库的多个 IDE。我们的想法是，我们希望确保，如果有新人加入团队或有人必须开始在新机器上工作，我们希望他们能够检查代码库，将其导入 IDE 并立即开始工作-能配置。

这在开发人员端意味着他们不应该将更改*提交到 IDE 文件。*其他所有内容（例如，src、test、lib 等）成为我们通常每天更新和提交的集合。

附带的好处是我们已经完全消除了这里的 IDE 战争：Netbeans 和 Eclipse 人生活在完美的和谐中（斜眼看着 IntelliJ 人，但是嘿...... ;-)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-23T10:51:28.337

有关此主题的更多评论和答案，请参阅[此问题（如何处理不同的 Java IDE 和 svn？）](https://stackoverflow.com/questions/81567/how-do-you-handle-different-java-ides-and-svn)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-23T07:50:56.827

我们重命名 IDE 文件以使用额外的扩展名 .deletethis 或类似名称进行签入。当一个新人签出项目时，他们只需剥离额外的扩展名就可以了。这样，当人们调整他们的环境时，我们可以避免与项目文件的源代码控制冲突。而且您不必担心教育新开发人员不要签入这些文件。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-10-16T06:15:15.650

通常，我会认为这是一个坏主意。我不确定这是一种什么样的环境（也许是开源的？），但支持多个 IDE 真的很糟糕。如果这是不可避免的，我会推荐的一件事是在 ant 脚本中标准化您的构建。如果您有大量依赖项，这可能是在所有平台上获得可预测构建的最简单方法。

如果其中一个 IDE 恰好是 RAD（基于 eclipse），则存在一个名为 .settings 的完整文件夹，您不希望将其包含在 SCM 中。

# .net - 微软替代 Jabber？

> ID：207239
> 
> 赞同：2
> 
> 时间：2008-10-16T02:35:24.050
> 
> 标签：.net, wcf, messaging, xmpp

我的组织正在考虑将 Jabber 用作不可知设备到设备到应用程序消息传递协议。

有谁知道 Jabber 的现有 Microsoft 竞争对手的最佳实践？或者，一个新兴的竞争对手？如果是这样，一个很好的 URL 参考可以帮助您快速开始吗？

Jabber 网站： [http ://www.jabber.org/web/Main_Page](http://www.jabber.org/web/Main_Page)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-16T02:43:59.633

[我真的很喜欢Jabber](http://www.jabber.org/web/Libraries)，对于快速入门，我建议您查看此 Jabber Server 软件列表，[您](http://www.process-one.net/en/ejabberd/)[可以](http://www.jabber.org/web/Servers)使用它来运行您自己的服务器，我对[Jabber.NET](http://code.google.com/p/jabber-net/)库很满意...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-16T03:05:36.030

我可以理解为什么您想用没有其他人使用的专有单一供应商单一平台替代方案来替换每个人都支持的跨平台、标准化协议。或者可能不是。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-16T02:38:01.547

Jabber 是几个东西：可扩展消息传递和存在协议 (XMPP)、jabber 服务器和应用程序以及 jabber 网络的旧名称。

[Windows Communication Foundation](http://msdn.microsoft.com/en-us/library/ms731082.aspx)是一个基于 Web 服务的 API，用于在应用程序之间进行通信？

Office Communicator 是一个使用 SIP/SIMPLE 消息传递协议的应用程序。

你真正需要什么？用于构建应用程序的应用程序或协议/api？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-16T02:38:32.280

我工作的公司刚刚放弃了 Jabber，转而使用 Microsoft Office Communicator，它将与 AD 集成，并指示用户何时因 Exchange 中的会议/约会而无法使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-09T05:09:32.673

查看 Coversant 的 XMPP 服务器/客户端： [Coversant SoapBox Studio](http://www.coversant.com) 他们还有一个 SDK，允许您自定义他们的服务器并构建您自己的客户端。

另一种选择是 AGS-XMPP[链接文本](http://www.ag-software.de) 他们有一组库，可让您创建自己的 XMPP (Jabber) 服务器（非平凡）和客户端。

# c# - 在单声道上运行 WinForm 应用程序的实际成本？

> ID：207255
> 
> 赞同：9
> 
> 时间：2008-10-16T02:44:31.330
> 
> 标签：c#, winforms, mono

我公司有一个在 WinXP 上运行的现有已建立的 WinForm 应用程序。该应用程序使用 DirectSound 进行大量声音处理。

我的公司想评估 Mono，作为 Vista/Win Server 2008 的每个工作站成本的替代方案。

我听说过不同的估计，从“它可以在 Mono 上轻松运行”到“在某些情况下可能需要几个月的重新编码才能让 WinForm 应用程序在 Linux 上与 Mono 一起运行”。

有没有人对此有很好的现实世界经验？一个好的链接参考？在我承诺测试之前，我想有一个更好的想法。

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-16T03:33:24.947

WinForms 部分将很简单，您可能需要做的很少，因为 Mono 现在声称支持 100% Winforms，但是所有 DirectSound 调用都必须重写以使用 Linux 上可用的 API，ALSA 是显而易见的选择。

我在 VS 2005 中编写了小应用程序，并轻松地将它们移植到 Mono。如果您做了很多 P/Invokes，那么您必须考虑到这一点，因为这些可能必须完全重写或重新考虑。

此外，请查看[MOMA](http://www.mono-project.com/MoMA)：“Mono 迁移分析器 (MoMA) 工具可帮助您确定将 .Net 应用程序移植到 Mono 时可能遇到的问题。它有助于查明平台特定调用 (P/Invoke) 和尚不支持的区域Mono 项目。”

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-19T16:08:26.403

Mono 可以帮助您移动托管代码，但它不会帮助您移动音频层。

遗憾的是，.NET 框架没有为音频处理提供全面的 API。它只是提供了一种播放小声音样本的方法，而且它甚至不是很好（参见 Jeroen 关于在 IKVM 下运行 C64 仿真器时出现音频间隙的帖子）。

您将不得不研究哪个 Linux API 最适合您的音频应用程序正在执行的操作。

Lennart Poettering 关于音频的博客文章是一个很好的起点：

[http://0pointer.de/blog/projects/guide-to-sound-apis.html](http://0pointer.de/blog/projects/guide-to-sound-apis.html)

一旦你决定了一个 API，就像在 Windows 中一样，你必须 P/Invoke 适合你的 API。

# c# - 仅当字符串的一部分前面没有某些字符时，如何匹配它？

> ID：207256
> 
> 赞同：4
> 
> 时间：2008-10-16T02:46:41.013
> 
> 标签：c#, .net, regex, negative-lookbehind

我创建了以下正则表达式模式，以尝试匹配以“PRI”或“SEC”结尾的长度为 6 个字符的字符串，除非字符串 =“SIGSEC”。例如，我想匹配 ABCPRI、XYZPRI、ABCSEC 和 XYZSEC，但不匹配 SIGSEC。

```
(\w{3}PRI$|[^SIG].*SEC$) 
```

它非常接近并且可以工作（如果我传入“SINSEC”，它会返回“NSEC”上的部分匹配），但我对它目前的形式没有很好的感觉。此外，我以后可能需要添加除“SIG”之外的更多排除项，并意识到这可能不会很好地扩展。有任何想法吗？

顺便说一句，我在 C# 中使用 System.Text.RegularExpressions.Regex.Match()

谢谢，丰富

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-16T02:50:12.990

假设您的正则表达式引擎支持负前瞻，试试这个：

```
((?!SIGSEC)\w{3}(?:SEC|PRI)) 
```

编辑：一位评论者指出.NET 确实支持负前瞻，所以这应该可以正常工作（谢谢，查理）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T02:59:00.867

为了帮助分解丹的（正确）答案，它的工作原理如下：

```
(           // outer capturing group to bind everything
 (?!SIGSEC) // negative lookahead: a match only works if "SIGSEC" does not appear next
 \w{3}      // exactly three "word" characters
 (?:        // non-capturing group - we don't care which of the following things matched
   SEC|PRI  // either "SEC" or "PRI"
 )
) 
```

一起： ((?!SIGSEC)\w{3}(?:SEC|PRI))

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T02:56:06.160

你可以试试这个：

```
@"\w{3}(?:PRI|(?<!SIG)SEC)" 
```

*   匹配 3 个“单词”字符
*   匹配 PRI 或 SEC（但不是在 SIG 之后，即 SIGSEC 被排除）

> 另外，我以后可能需要添加除“SIG”之外的更多排除项，并意识到这可能无法很好地扩展

使用我的代码，您可以轻松添加另一个异常，例如以下代码不包括 SIGSEC 和 FOOSEC

```
@"\w{3}(?:PRI|(?<!SIG|FOO)SEC)" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-16T09:00:23.337

为什么不使用更具可读性的代码？在我看来，这更易于维护。

```
private Boolean HasValidEnding(String input)
{
    if (input.EndsWith("SEC",StringComparison.Ordinal) || input.EndsWith("PRI",StringComparison.Ordinal))
    {
        if (!input.Equals("SIGSEC",StringComparison.Ordinal))
        {
            return true;
        }
    }
    return false;
} 
```

或在一行中

```
private Boolean HasValidEnding(String input)
{
    return (input.EndsWith("SEC",StringComparison.Ordinal) || input.EndsWith("PRI",StringComparison.Ordinal)) && !input.Equals("SIGSEC",StringComparison.Ordinal);
} 
```

不是我不使用正则表达式，而是在这种情况下我不会使用它们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-16T02:50:55.030

就个人而言，我倾向于使用第二个变量来构建排除列表，然后将其包含到完整的表达式中——这是我过去在构建*任何*复杂表达式时使用的方法。

就像是`exclude = 'someexpression'; prefix = 'list of prefixes'; suffix = 'list of suffixes'; expression = '{prefix}{exclude}{suffix}';`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-16T02:56:03.057

您甚至可能不想在正则表达式中进行排除。例如，如果这是 Perl（我不知道 C#，但你可能会跟着学），我会这样做

```
if ( ( $str =~ /^\w{3}(?:PRI|SEC)$/ ) && ( $str ne 'SIGSEC' ) ) 
```

要清楚。它正在做你想要的：

*   三个单词字符，后跟 PRI 或 SEC，以及
*   这不是 SIGSEC

没有人说您必须将所有内容强制转换为一个正则表达式。

# html - firefox 3 favicons - 如何制作它们？

> ID：207260
> 
> 赞同：1
> 
> 时间：2008-10-16T02:49:19.217
> 
> 标签：html, firefox, favicon

我注意到贝宝显示了一个非常不同的图标，它不仅仅是一个简单的 16x16 图标而且很长？任何人都可以教我吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-16T02:55:03.010

我认为您指的是显示 PayPal 徽标的绿色框，后跟“PayPal, Inc. (US)”。

如果是这样，它不是一个网站图标，而是 Firefox 3 的一项功能，可以显示具有扩展验证 (EV) 的站点。另见[http://news.cnet.com/8301-13554_3-9974672-33.html](http://news.cnet.com/8301-13554_3-9974672-33.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-16T02:55:21.903

那不是网站图标，而是他们使用的 SSL 证书的类型。这是一个[扩展验证 (EV)](http://en.wikipedia.org/wiki/Extended_Validation_Certificate)证书，旨在提供更好的身份验证。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-10-27T22:38:24.137

这简单。在 {title} 标记下，放置此代码。

```
<link rel="shortcut icon" type="image/png" href="images/favicon.png">
```

只需确保网站图标图像小于 100px * 100px。我推荐的网站图标图像大小为 50px * 50px。

# testing - 嵌入式 C++ 项目的代码覆盖率分析

> ID：207267
> 
> 赞同：7
> 
> 时间：2008-10-16T02:52:55.590
> 
> 标签：testing, embedded, code-analysis

我最近开始研究一个非常大的 C++ 项目，在完成 90% 的实现后，我确定他们需要在测试期间展示 100% 的分支覆盖率。该项目托管在嵌入式平台（Green Hills Integrity）上。我正在寻找 StackOverflow 上其他在类似环境中使用过代码覆盖率产品的人的建议和经验。我对有关这些类型的工具的正面和负面评论都感兴趣。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-16T03:11:55.113

100% 的分支机构覆盖率？这是非常必要的，特别是因为某些分支（例如状态机的 case 语句中的默认值）不应该运行。我预计会有*一些*例外情况，如果没有，您可能需要在开始之前了解覆盖测试可以完成和无法完成的任务 - 否则您最终会拉扯头发，或者更糟 - 提供不正确的数据。

大多数嵌入式系统的覆盖测试实际上是在 PC 上执行的。移植代码，在软件中模拟微控制器的某些方面，并运行[Bullseye](http://www.bullseye.com/)或其他类似的 PC 代码覆盖实用程序。这样做的原因是有太多的微控制器和编译器/调试器/测试环境来为每个开发代码覆盖工具。

当针对特定嵌入式平台的代码覆盖工具确实存在时，它们不如为 PC 平台开发的工具强大、可配置、易于使用和无错误。处理器通常不具备执行良好代码覆盖率所需的跟踪能力（没有高端仿真硬件），而无需在固件中插入额外的调试代码，这会产生难以控制的后果和副作用，尤其是在时序问题的情况下实时系统。

只要您可以抽象出特定于硬件的代码（并且由于您正确使用 C++，这应该很容易，对吧？;-D），移植代码并不是非常困难。您将遇到的最大问题是类型，虽然在 C++ 中比在 C 中更好地指定了类型，但仍然会带来一些问题。确保您使用 types.h 或类似设置来明确告诉编译器您使用的每种类型是什么以及应该如何解释它。

之后，你可以去城里测试PC上的核心逻辑。如果您对开发所需的软件仿真感兴趣，您甚至可以测试低级硬件驱动程序，尽管时间问题可能有些麻烦。

诸如[MxVDev](http://www.mrmx.com)之类的软件测试工具会为您执行大量微控制器仿真并帮助解决时序问题，但即使有这样的帮助，您仍然需要做一些工作。

如果您必须在系统本身上执行此操作，则需要为具有覆盖能力的处理器购买仿真器 - 这不是一个便宜的提议（许多仿真器的全套工具和仿真硬件成本超过 3 万美元），但它是在汽车和航空航天工业等高可靠性环境中使用的众多工具之一。

-亚当

免责声明：我为生产 MxVDev 的公司工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-07T07:54:11.123

我们过去曾使用[Cantata](http://www.ipl.com/products/tools/pt400.uk.php)和[vectorcast](http://www.vectorcast.com/)进行单元测试和代码覆盖。我们还使用 Greenhills 工具，这两个工具都可以与 greenhills 开发工具一起使用。我们在 PPC 模拟器上运行大部分测试，并且仅通过 JTAG pod 运行依赖于目标硬件上的硬件的测试。Canatata 和 Vector cast 与 catata 非常相似，只是更易于使用并且功能稍多一些，但小的附加功能会对用户体验产生很大影响。

通常，如果您想实现高水平的分支覆盖率，您需要设计代码以实现可测试性。你测试的越多，你对编写可测试代码的了解就越多。

我们还尝试了 PC 测试与嵌入式测试，因为字节顺序给我们带来了问题，但这只是硬件层的问题。

此外，这些工具已通过 RTCA/DO-178B 标准认证。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-16T07:21:27.187

与 Adam 一样，我们将嵌入式代码移植到基于 PC 的工具上，并在那里进行大部分覆盖和分析。我用过 AutomatedQA AQTime 和 Compuwares DevPartner，这两个都是不错的产品，

如果您必须执行覆盖率，则需要使用覆盖率分析器来创建源的检测版本。有商业和开源工具可以做到这一点，但是 IMO，它增加了很多工作却没有多少收获。

100% 的覆盖率是雄心勃勃的，因为您需要大量的错误注入才能进入所有错误处理程序和异常处理程序。IMO，这在安全带中也比在船上更容易做到。

还值得向任何要求 100% 代码覆盖率的人指出，**100% 代码覆盖率绝不等同于 100% 测试覆盖率**。例如考虑以下功能；

```
int div(int a, int b)
{
return (a/b);
} 
```

100% 的代码覆盖率只需要我们调用一次这个函数，100% 的测试覆盖率需要更多的调用。我自己的测试策略包括开发自动化测试用例以提供可接受的**测试覆盖率**，并使用代码覆盖率工具纯粹作为寻找未测试区域的辅助工具。在某种程度上，这取决于您的测试预算；对我来说，100% 的代码覆盖率对于它所提供的东西来说是昂贵的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-01T10:28:01.323

请参阅[SD C++ 测试覆盖率](http://www.semanticdesigns.com/Products/TestCoverage/CppTestCoverage.html)。这是一系列（分支）测试覆盖工具，适用于各种 C++ 方言（ANSI、GNU、MS...），由于占用空间非常小，并且易于使用，因此即使在实际的嵌入式系统硬件中也能很好地发挥作用导出收集的测试覆盖率数据的方法。有一个 GUI 覆盖率显示，它不依赖于您的实际嵌入式硬件，它还将生成完整的覆盖率报告摘要。

[我是提供这些工具的公司的负责人。]

# asp.net - 如何在构建时将 Silverlight XAP 复制到 clientbin

> ID：207276
> 
> 赞同：24
> 
> 时间：2008-10-16T02:56:18.220
> 
> 标签：asp.net, asp.net-mvc, visual-studio, silverlight, silverlight-2.0

我刚刚开始使用 Silverlight，最近在已建立的解决方案中添加了一个 Silverlight 项目。在这个特定场景中，我的解决方案包括一个现有的 ASP.NET 网站（不是应用程序），Visual Studio 很乐意将我的 Silverlight 应用程序集成到该网站中，我接受了。

所以一切都很好，Silverlight XAP 正在被复制到网站的 ClientBin 目录中。现在我决定启动一个新的 ASP.NET MVC Web 应用程序，它最终将取代旧的（非 MVC）网站。但是我一辈子都无法弄清楚 Visual Studio 修改了什么来让 XAP 在构建时自动出现在网站的 ClientBin 中，这样我就可以在我的 MVC 网站上重现它。

所以我的问题本质上是，让 Visual Studio 将 Silverlight 应用程序的 XAP 自动复制到新添加的 ASP.NET MVC Web 应用程序的手动步骤是什么？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-10-16T09:04:50.550

您可以通过 Web 项目的属性来执行此操作。Visual Studio 的 Silverlight 工具向名为“Silverlight Links”的 Web 项目的属性添加了一个新选项卡。

在此处添加对您的 Silverlight 项目的引用以及所需的文件夹，Visual Studio 将为您制作副本。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-10-16T04:19:53.167

将 XAP 复制到 ClientBin 是一项 MSBuild 任务。如果您使用的是标准 ASP.NET 项目模板，则可以在 Silverlight Link 部分下找到它。

对于其他所有内容，您可能能够找出 MSBuild 任务的名称并将其添加到您的 ASP.NET MVC 项目中。更简单的解决方案可能是在 APS.NET 项目上使用自定义构建后事件来复制文件。

除了将 XAP 文件从 Silverlight 项目的 BIN 目录复制到 Web 应用程序的 ClientBin 之外，没有任何“魔法”发生。它甚至不必位于 ClientBin 目录中 - 您可以将其复制到任何目录或站点的根目录。

**更新：**最近发布的 ASP.NET MVC Beta 1 包括对 Silverlight 项目的支持，因此您可以将其链接到您的 ASP.NET MVC 应用程序，就像您对常规 ASP.NET 应用程序所做的那样。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-07-10T09:59:08.050

转到 Silverlight 应用程序的属性页，选择 Build Events 选项卡，在 Post-Build events 命令行中输入以下行：

```
copy $(TargetDir)*.xap $(SolutionDir)<youar web solution folder name such as app.web>\ClientBin 
```

现在开始，在每次成功构建时，都会自动复制 xap 文件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-09-22T13:25:28.247

这是一篇较旧的帖子，所以它可能已经改变了......在我的 Visual Studio 中的 web 项目下，有一个名为“Silverlight 应用程序”的选项卡。对于您导入到解决方案中的现有项目，那里有一个添加按钮，您可以添加它们并选择将 xap 放置在 ClientBin 或其他任何地方。不确定是否必须安装 SDK 才能拥有此选项卡。我已经安装了，所以你可能需要。我不做MVC，所以对于MVC项目可能会有所不同，我不知道。

# maven-2 - “mvn deploy”到本地仓库和“mvn install”有什么区别？

> ID：207281
> 
> 赞同：99
> 
> 时间：2008-10-16T02:59:41.363
> 
> 标签：maven-2

我的团队使用从使用 Apache 的开发服务器共享的内部团队 maven 存储库。我们还在同一台机器上运行 Continuum CI 服务器。Continuum 中的 Maven 构建以“安装”目标运行，它将最终工件直接复制到共享目录中。

`mvn install`问题是，使用部署目标（mvn-deploy 插件）将文件添加到共享存储库有什么区别？

在我看来，使用`mvn deploy`会带来额外的配置麻烦，但我在某处读到，由于与 maven 的内部工作相关的某种原因，将文件安装到共享存储库中是一个坏主意。

`deploy`更新：我得到和之间的功能差异`install`；实际上，我对在 maven 存储库中创建的文件方面的低级细节更感兴趣。

* * *

## 回答 #1

> 赞同：179
> 
> 时间：2009-03-29T05:41:32.703

肯，好问题。我应该在[权威指南](http://www.sonatype.com/books/maven-book/reference/public-book.html)中更明确地说明差异。“安装”和“部署”在构建中有两个不同的目的。“安装”是指在本地存储库中安装工件的过程。“部署”是指将工件部署到远程存储库的过程。

例子：

1.  当我在我的机器上运行一个大型的多模块项目时，我通常会运行“mvn install”。这将在我的本地存储库中安装所有生成的二进制软件工件（通常是 JAR）。然后，当我在构建中构建单个模块时，Maven 将从本地存储库中检索依赖项。

2.  当需要部署快照或发布时，我将运行“mvn deploy”。运行它会尝试将文件部署到远程存储库或服务器。通常我会部署到存储库管理器，例如[Nexus](http://nexus.sonatype.org)

确实，运行“部署”需要一些额外的配置，你必须在你的 POM 中提供一个 distributionManagement 部分。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-10-16T16:05:17.097

[从 Maven 文档](http://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html)，听起来这只是您将软件包安装到*哪个存储库中的区别：*

*   install - 将包安装到本地存储库中，作为本地其他项目的依赖项
*   部署 - 在集成或发布环境中完成，将最终包复制到远程存储库以与其他开发人员和项目共享。

也许在 CI 服务器的“安装”将其安装到它的本地存储库中存在一些混淆，然后您作为用户正在共享？

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-16T20:34:42.043

“matt b” 是对的，但具体来说，“安装”目标将您构建的目标复制到文件系统上的本地存储库；对于目前不适合整个团队的项目间的小改动很有用。

当您的工作完成时，“部署”目标会将其上传到您的共享存储库，然后可以由项目需要它的其他人共享。

在您的情况下，似乎“安装”用于简化部署的管理，因为 CI 的本地存储库*是*共享存储库。如果 CI 在另一个盒子上，它必须使用“部署”目标。

# powershell - 用于重置网络适配器的命令/Powershell 脚本

> ID：207283
> 
> 赞同：29
> 
> 时间：2008-10-16T03:00:39.567
> 
> 标签：powershell, networking, windows-vista

操作系统：Vista 企业版

当我在家庭网络和办公室网络之间切换时，我总是遇到连接到网络的问题。几乎总是我必须使用“网络和共享中心”中的诊断服务，当我使用重置网络适配器选项时问题得到解决。

这需要很多时间（3-4 分钟），所以我试图找到一个命令或一个 powershell 脚本/cmdlet，我可以直接使用它来重置网络适配器并在每次我必须切换时为自己节省这 5 分钟网络之间。任何指针？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-10-16T05:09:45.517

您可以在 PowerShell 中使用 WMI 来完成此操作。假设有一个设备名称中包含*Wireless*的网络适配器，则一系列命令可能如下所示：

```
$adaptor = Get-WmiObject -Class Win32_NetworkAdapter | Where-Object {$_.Name -like "*Wireless*"}
$adaptor.Disable()
$adaptor.Enable() 
```

请记住，如果您使用 Window 的 Vista 运行它，您可能需要以*管理员*身份运行 PowerShell 。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-11-30T03:56:23.283

Zitrax 的回答：

```
netsh interface set interface "InterfaceName" DISABLED
netsh interface set interface "InterfaceName" ENABLED 
```

是我正在寻找的 99%。但是，她/他遗漏的一条信息是这些命令必须以管理员身份运行。以管理员身份运行 cmd.exe 并键入它们，或者将它们存储在批处理文件中，然后通过右键单击该文件并从上下文菜单中选择“以管理员身份运行”以管理员身份运行该文件。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-16T04:02:03.967

请参阅 The Scripting Guys 的这篇文章[“如何启用或禁用我的网络适配器？”](https://blogs.technet.microsoft.com/heyscriptingguy/2014/01/13/enabling-and-disabling-network-adapters-with-powershell/)

tl/博士：

```
Restart-NetAdapter   -Name "Your Name Here" 
```

您可以使用获取列表

```
Get-NetAdapter 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-16T04:08:39.227

您也可以在 .BAT 或 .CMD 文件中尝试此操作：

```
ipconfig /release
ipconfig /renew
arp -d *
nbtstat -R
nbtstat -RR
ipconfig /flushdns
ipconfig /registerdns 
```

这些命令应该与网络适配器的“诊断和修复”执行相同的操作，但速度要快得多！

让我知道这是否有帮助！联合部队

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2014-03-05T10:00:51.357

什么对我有用：

```
netsh interface show interface 
```

显示对我来说是“以太网2”的接口名称，然后：

```
netsh interface set interface "Ethernet 2" DISABLED
netsh interface set interface "Ethernet 2" ENABLED 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2016-09-07T13:44:32.607

以下命令对我有用（在 Server 2012 R2 上）：

```
Restart-NetAdapter -Name "Ethernet 2" 
```

将“Ethernet 2”替换为适配器的名称。

注意：要创建PS脚本：在记事本中新建一个文档，另存为`script.PS1`，插入上面的行并保存。右键单击该文件 -> 使用 PowerShell 运行。

有关更多信息，请参阅此[技术网](https://technet.microsoft.com/en-us/library/jj130880(v=wps.630).aspx)文章。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-03-30T14:02:41.757

Scott 的帖子启发我编写了一个非常小的 C#/.Net 控制台应用程序，它使用 System.Management。您可以将要重新启动的适配器命名为命令行参数。该代码显示了一些关于处理设备的基础知识，这对其他人也可能有用。

```
using System;
using System.Management;

namespace ResetNetworkAdapter
{
  class Program
  {
    static void Main(string[] args)
    {
      if (args.Length != 1)
      {
        Console.WriteLine("ResetNetworkAdapter [adapter name]");
        Console.WriteLine("disables and re-enables (restarts) network adapters containing [adapter name] in their name");
        return;
      }

      // commandline parameter is a string to be contained in the searched network adapter name
      string AdapterNameLike = args[0];

      // get network adapter node 
      SelectQuery query = new SelectQuery("Win32_NetworkAdapter");
      ManagementObjectSearcher searcher =  new ManagementObjectSearcher(query);
      ManagementObjectCollection adapters = searcher.Get();

      // enumerate all network adapters
      foreach (ManagementObject adapter in adapters)
      {
        // find the matching adapter
        string Name = (string)adapter.Properties["Name"].Value;
        if (Name.ToLower().Contains(AdapterNameLike.ToLower()))
        {
          // disable and re-enable the adapter
          adapter.InvokeMethod("Disable", null);
          adapter.InvokeMethod("Enable", null);
        }
      }
    }
  }
} 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2016-03-19T11:20:20.367

这是我在 PowerShell 版本 5.0.10586.122 Windows 10 Home 上使用的。这需要以管理员身份运行：

`Restart-NetAdapter -Name "ethernet"`

要以管理员身份运行它而无需“关闭 UAC”或“ `R-Click`-> 以管理员身份运行”：（这是一次性任务）

*   将以上`Restart-NetAdapter -Name "ethernet"`内容放入`.ps1`文件
*   创建一个新的快捷方式（`R-Click`在`.ps1`文件上 > 创建快捷方式）
*   在快捷方式上，`R-Click`> 属性 > 快捷方式 > 目标 >（将 Powershell.exe 附加到位置/文件名之前，如下所示。还用双引号（“）将位置/文件名括起来，如下所示。

[![在此处输入图像描述](https://i.stack.imgur.com/JNYTi.png)](https://i.stack.imgur.com/JNYTi.png)

*   在快捷方式上，`R-Click`> 属性 > 快捷方式 > 高级 > “以管理员身份运行”（选中此复选框）

现在每次运行快捷方式时，您只需在 UAC 屏幕上单击“是”，它将重置您在`.ps1`文件中指定的适配器。

要使用 PowerShell（WiFi、LAN 等）获取可用适配器的名称：

`Get-NetAdapter`

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-03-07T10:45:35.890

您还可以使用 Microsoft 实用程序[devcon.exe](http://support.microsoft.com/kb/311272)。

首先，运行`devcon listclass net`以查找您的设备 ID。

然后在此命令中使用此设备 ID：（`devcon restart PCI\VEN_16*`使用`'*'`通配符以避免需要输入整个 ID 字符串）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-04-19T10:44:59.010

您还可以使用 wmic 命令重新启动 NIC：

获取接口ID：

```
C:\>wmic nic get name, index 
```

禁用 NIC（接口 ID：1）：

```
wmic path win32_networkadapter where index=1 call disable 
```

启用 NIC（接口 ID：1）：

```
wmic path win32_networkadapter where index=1 call enable 
```

资料来源：[http ://www.sysadmit.com/2016/04/windows-reiniciar-red.html](http://www.sysadmit.com/2016/04/windows-reiniciar-red.html)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-12-29T21:29:59.340

您也可以尝试`netsh`命令。例子：

```
netsh wlan disconnect && netsh wlan connect [ONE OF YOUR WLAN PROFILES] 
```

您可以使用以下方法获取这些“配置文件”的列表：

```
netsh wlan show profiles 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-07-11T18:55:19.117

ipconfig /flushdns

ipconfig /更新

是我用来刷新连接的 2 个 cmdlet。您不一定需要重新启动路由器以重新获得强信号（我知道重新启动路由器会清除路由器的内存，但事实就是如此）。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-05-30T22:22:57.420

感谢您提供可以使用 netsh 完成的信息。我写了一个简单的“Repair.bat”脚本：

```
@echo off
netsh interface set interface "%1" DISABLED
netsh interface set interface "%1" ENABLED 
```

只需使用 NIC 的名称调用它，重命名为“WLAN”，这样我就没有空格，在 cmd 中键入“修复 WLAN”就可以了。我将把它放到 system32 中并完成它的任务，或者看看如何将它集成到网络上下文菜单中......

# python - 从字符串中提取带括号的 Python 表达式

> ID：207290
> 
> 赞同：1
> 
> 时间：2008-10-16T03:02:27.847
> 
> 标签：python, parsing

我一直想知道编写一些 Python 代码来搜索字符串以查找`${`*expr*`}`形式的子字符串的索引有多难，例如，其中*expr*意味着 Python 表达式或类似的东西。鉴于这样的事情，人们可以很容易地想象用 来检查表达式的语法，用`compile()`来针对特定范围评估它`eval()`，甚至可能将结果替换为原始字符串。人们必须一直做非常相似的事情。

我可以想象使用第三方解析器生成器 [oof] 解决这样的问题，或者通过手动编码某种状态机 [eek]，或者通过说服 Python 自己的解析器以某种方式完成繁重的工作 [hmm]。也许某个地方有一个第三方模板库可以做到这一点。就简单性或执行时间或减少外部依赖而言，限制*expr*的语法可能是一个值得妥协的方案——例如，也许我真正需要的只是与任何具有平衡花括号的*expr匹配的东西。*

你有什么感觉？

## 更新：

非常感谢您迄今为止的回复！回顾我昨天写的东西，我不确定我是否足够清楚我在问什么。模板替换确实是一个有趣的问题，并且可能比我想知道的表达式提取子问题对更多的人有用得多，但我提出它只是作为我的问题的答案如何在现实中有用的一个简单示例生活。其他一些潜在的应用可能包括将提取的表达式传递给语法突出显示；将结果传递给真正的 Python 解析器，并查看或使用解析树进行监视；或者使用提取的表达式序列来构建一个更大的 Python 程序，可能会结合从周围文本中获取的一些信息。

我提到的`${`*expr*`}`语法也是一个例子，实际上我想知道我是否不应该使用`$(`*expr*`)`作为我的例子，因为它使显而易见的方法的潜在缺点`re.finditer(r'$\{([^}]+)\}', s)`更容易理解看。Python 表达式可以（并且经常）包含`)`（或`}`）字符。处理这些案件中的任何一个似乎都可能比它的价值要麻烦得多，但我还不相信这一点。请随时尝试制作这个案例！

在发布这个问题之前，我花了很多时间研究 Python 模板引擎，希望它可以公开我所询问的那种低级功能——即可以在各种上下文中找到表达式的东西，并且告诉我它们在哪里，而不是仅限于查找使用单一硬编码语法嵌入的表达式，始终评估它们，并始终将结果替换回原始字符串。我还没有弄清楚如何使用它们中的任何一个来解决我的问题，但我非常感谢有关更多查看的建议（不敢相信我错过了 wiki 上的精彩列表！）。这些东西的 API 文档往往是相当高级的，而且我对它们中的任何一个都不太熟悉，所以我

谢谢你的耐心！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-16T05:10:29.400

我认为您要问的是能够将 Python 代码插入到要评估的文本文件中。已经有几个模块可以提供这种功能。您可以查看 Python.org[**模板 wiki 页面**](http://wiki.python.org/moin/Templating)以获取完整列表。

一些谷歌搜索还发现了一些您可能感兴趣的其他模块：

*   [texttemplate](http://py-templates.sourceforge.net/texttemplate/index.html)（py-templates 项目的一部分）
*   [模板模块](http://www.embl-heidelberg.de/~chenna/pythonpages/template.html)

如果您出于某种原因真的想自己编写这个，您还可以深入研究这个 Python 食谱解决方案[Yet Another Python Templating Utility (YAPTU)](http://code.activestate.com/recipes/52305/)：

> *“模板化”（将输入文件复制到输出，动态插入 Python 表达式和语句）是一种常见的需求，YAPTU 是一个小而完整的 Python 模块；表达式和语句由任意用户选择的正则表达式标识。*

**编辑**：只是为了它，我为此制作了一个非常简单的代码示例。我确信它有错误，但它至少说明了这个概念的简化版本：

```
#!/usr/bin/env python

import sys
import re

FILE = sys.argv[1]

handle = open(FILE)
fcontent = handle.read()
handle.close()

for myexpr in re.finditer(r'\${([^}]+)}', fcontent, re.M|re.S):
    text = myexpr.group(1)
    try:
        exec text
    except SyntaxError:
        print "ERROR: unable to compile expression '%s'" % (text) 
```

针对以下文本进行测试：

```
This is some random text, with embedded python like 
${print "foo"} and some bogus python like

${any:thing}.

And a multiline statement, just for kicks: 

${
def multiline_stmt(foo):
  print foo

multiline_stmt("ahem")
}

More text here. 
```

输出：

```
[user@host]$ ./exec_embedded_python.py test.txt
foo
ERROR: unable to compile expression 'any:thing'
ahem 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T03:09:11.750

我认为您最好的选择是匹配所有花括号条目，然后检查 Python 本身是否是有效的 Python，[编译器](https://docs.python.org/2/library/compiler.html)对此会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T16:56:42.140

如果您想处理任意表达式，例如`{'{spam': 42}["spam}"]`，则没有成熟的解析器就无法逃脱。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T00:09:51.940

发布此内容后，阅读到目前为止的回复（谢谢大家！），并考虑了一段时间，这是我能想到的最佳方法：

1.  找到第一个`${`。
2.  之后找到下一个`}`。
3.  喂食两者之间的任何东西`compile()`。如果它有效，把叉子插进去，我们就完成了。
4.  否则，通过查找后续出现的`}`. 一旦有东西编译，就返回它。
5.  如果我们用完`}`而无法编译任何东西，请使用最后一次编译尝试的结果来提供有关问题所在的信息。

这种方法的优点：

*   该代码非常简短且易于理解。
*   它非常有效——即使在表达式包含 no 的情况下也是最佳的`}`。最坏的情况似乎也不会太糟糕。
*   它适用于许多包含`${`和/或的表达式`}`。
*   没有外部依赖。事实上，不需要导入*任何东西。*（这让我很惊讶。）

缺点：

*   有时它抓住太多或太少。有关后者的示例，请参见下文。我可以想象一个可怕的例子，你有两个表达式，第一个是微妙的错误，算法最终错误地抓住了整个事物以及介于两者之间的所有内容并将其返回为有效，尽管我无法证明这一点。也许事情并没有我担心的那么糟糕。我不认为通常可以避免误解——问题定义有点滑——但似乎应该可以做得更好，特别是如果人们愿意以简单性或执行时间为代价的话。
*   我没有做过任何基准测试，但我可以想象会有更快的替代方案，尤其是在`}`表达式中涉及很多的情况下。如果有人想将此技术应用于相当大的 Python 代码块，而不仅仅是非常短的表达式，那将是一件大事。

这是我的实现。

```
def findExpr(s, i0=0, begin='${', end='}', compArgs=('<string>', 'eval')):
  assert '\n' not in s, 'line numbers not implemented'
  i0 = s.index(begin, i0) + len(begin)
  i1 = s.index(end, i0)
  code = errMsg = None
  while code is None and errMsg is None:
    expr = s[i0:i1]
    try: code = compile(expr, *compArgs)
    except SyntaxError, e:
      i1 = s.find(end, i1 + 1)
      if i1 < 0: errMsg, i1 = e.msg, i0 + e.offset
  return i0, i1, code, errMsg 
```

这是带有一些doctest格式插图的文档字符串，我没有将其插入上面的函数中间只是因为它很长而且我觉得没有它代码更容易阅读。

```
'''
Search s for a (possibly invalid) Python expression bracketed by begin
and end, which default to '${' and '}'.  Return a 4-tuple.

>>> s = 'foo ${a*b + c*d} bar'
>>> i0, i1, code, errMsg = findExpr(s)
>>> i0, i1, s[i0:i1], errMsg
(6, 15, 'a*b + c*d', None)
>>> ' '.join('%02x' % ord(byte) for byte in code.co_code)
'65 00 00 65 01 00 14 65 02 00 65 03 00 14 17 53'
>>> code.co_names
('a', 'b', 'c', 'd')
>>> eval(code, {'a': 1, 'b': 2, 'c': 3, 'd': 4})
14
>>> eval(code, {'a': 'a', 'b': 2, 'c': 'c', 'd': 4})
'aacccc'
>>> eval(code, {'a': None})
Traceback (most recent call last):
  ...
NameError: name 'b' is not defined

Expressions containing start and/or end are allowed.

>>> s = '{foo ${{"}": "${"}["}"]} bar}'
>>> i0, i1, code, errMsg = findExpr(s)
>>> i0, i1, s[i0:i1], errMsg
(7, 23, '{"}": "${"}["}"]', None)

If the first match is syntactically invalid Python, i0 points to the
start of the match, i1 points to the parse error, code is None and
errMsg contains a message from the compiler.

>>> s = '{foo ${qwerty asdf zxcvbnm!!!} ${7} bar}'
>>> i0, i1, code, errMsg = findExpr(s)
>>> i0, i1, s[i0:i1], errMsg
(7, 18, 'qwerty asdf', 'invalid syntax')
>>> print code
None

If a second argument is given, start searching there.

>>> i0, i1, code, errMsg = findExpr(s, i1)
>>> i0, i1, s[i0:i1], errMsg
(33, 34, '7', None)

Raise ValueError if there are no further matches.

>>> i0, i1, code, errMsg = findExpr(s, i1)
Traceback (most recent call last):
  ...
ValueError: substring not found

In ambiguous cases, match the shortest valid expression.  This is not
always ideal behavior.

>>> s = '{foo ${x or {} # return {} instead of None} bar}'
>>> i0, i1, code, errMsg = findExpr(s)
>>> i0, i1, s[i0:i1], errMsg
(7, 25, 'x or {} # return {', None)

This implementation must not be used with multi-line strings.  It does
not adjust line number information in the returned code object, and it
does not take the line number into account when computing the offset
of a parse error.

''' 
```

# c# - 如何从.Net中的内存映射I/O端口读取？

> ID：207291
> 
> 赞同：3
> 
> 时间：2008-10-16T03:02:50.513
> 
> 标签：c#, .net, memory, pointers, io

.Net 中的标准指针可以做到这一点吗？还是需要求助于 P/invoke？

请注意，我不是在谈论对象引用。我说的是不安全代码中的实际 C# 指针。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-16T03:15:47.213

C# 作为托管和受保护的运行时引擎，不允许低级硬件访问，并且与实际硬件相关的内存位置不可用。

您需要使用端口驱动程序或使用适当的 Windows API 用 C++ 或 C 编写自己的驱动程序，以访问感兴趣的内存映射 I/O 区域。这将在比 C# 程序能力更低的环中运行。

这就是为什么你看不到用 C# 编写的驱动程序的原因，虽然我知道很多人是用 C++ 编写访问例程，但主要的驱动程序逻辑是用 C# 编写的。不过，这很棘手，因为崩溃和重新启动可能会变得很棘手，更不用说同步和计时问题（在 C++ 中，这些问题在较低的环上更为具体，即使 Windows 与实时系统相去甚远）。

-亚当

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-16T04:35:06.413

为了扩展[Adam 的答案](https://stackoverflow.com/questions/207291/how-to-read-from-a-memory-mapped-io-port-in-net#207320)，如果没有内核驱动程序的合作，您甚至无法从 Win32 应用程序执行内存映射 I/O。Win32 应用程序获得的所有地址都是与物理地址无关的虚拟地址。

您要么需要编写一个内核驱动程序来执行您正在谈论的事情，要么安装一个具有 API 的驱动程序，该 API 可以让您针对特定物理地址发出 I/O 请求（这样的驱动程序将非常大安全漏洞等待发生，我想）。我似乎还记得，当一些公司将这样的驱动程序作为开发工具包的一部分来帮助将旧版 DOS/Win16 或任何设备代码移植到 Win32 时，我似乎记得那样。我不记得它的名字，也不知道它是否还在。

# javascript - 什么是最好的多文件 JavaScript / Flash 文件上传器？

> ID：207298
> 
> 赞同：16
> 
> 时间：2008-10-16T03:04:16.907
> 
> 标签：javascript, ajax, flash, file-upload, multifile-uploader

具体来说，我正在寻找基于客户端、JavaScript 和/或 Flash 的多文件上传器。我发现的最接近的是[FancyUpload](http://digitarald.de/project/fancyupload/)。有人有经验吗？如果没有，外面还有什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-16T03:23:32.563

Yahoo 的[YUI Uploader](http://yuilibrary.com/yui/docs/uploader/uploader-dd.html)是您的朋友。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-20T17:45:00.860

[Uploadify](http://www.uploadify.com/)是一个 jQuery / Flash 混合体（如果你不想添加 YUI 来处理上传）。

[演示](http://www.uploadify.com/demo/)

[如何实施](http://www.uploadify.com/documentation/)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-16T03:05:09.510

[SWFUpload](http://swfupload.org/)可能是这方面的主要“竞争对手”。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-16T03:24:53.793

SWFUpload 的替代方案：

*   [YUI 上传器](http://developer.yahoo.com/yui/uploader/)
*   [jqUploader](http://www.pixeline.be/experiments/jqUploader/)（jQuery 插件）
*   [带进度服务器控件的 Flash/AJAX 文件上传](http://weblogs.asp.net/jstengel/archive/2008/04/25/flash-file-upload-server-control.aspx)（基于 ASP .NET）

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-02-24T16:21:34.743

[Plupload](http://www.plupload.com/)似乎很有趣......

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-04-16T19:26:30.340

看起来该字段的新条目是“jQuery 文件上传”：

[维基/文档](https://github.com/blueimp/jQuery-File-Upload/wiki)

[演示页面](http://blueimp.github.com/jQuery-File-Upload/)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-04-07T21:36:21.563

Agile Uploader 现在支持 2.0 版的多个文件。 [http://www.shift8creative.com/projects/agile-uploader/index.html](http://www.shift8creative.com/projects/agile-uploader/index.html)

这是演示的直接链接：http: [//www.shift8creative.com/agile-uploader/examples/all_files.php](http://www.shift8creative.com/agile-uploader/examples/all_files.php)

它允许所有类型的文件，并且可以在上传之前实际调整图像大小，以帮助节省带宽成本和服务器处理能力。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-16T07:20:58.403

我已经使用[FancyUpload](http://digitarald.de/project/fancyupload/)很多次了，这绝对是太棒了。唯一的问题（但我猜对大多数 Flash 上传者来说都是如此）是会话处理——如果您使用会话，您将不得不将会话 ID 传递给 Flash 文件并再次返回。

[digitarald](http://digitarald.de/)（作者）有一个新版本的 FancyUpload 测试版，现在可以与 Flash 10 一起使用（很多其他上传者都没有）。据他介绍，一旦发布，从 FancyUpload2 升级到新版本应该非常简单。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-10-12T20:39:55.123

[具有客户端图像大小调整的 Google Gears 解决方案](http://bitbucket.org/kmike/gearsuploader/)（我的，抱歉做广告）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-12-13T11:39:26.943

[Dropzone](http://www.dropzonejs.com/)为我提供了优雅降级的简单拖放功能。很容易设置。

# java - 在 Eclipse 中安装 [java 库]

> ID：207304
> 
> 赞同：9
> 
> 时间：2008-10-16T03:05:55.673
> 
> 标签：java, eclipse, configuration

我几个小时前刚刚下载了 Eclipse，需要将 Java3D 添加到类路径中。安装它很顺利，但 Eclipse 似乎找不到文档文件夹，因此它可以提供超级 IDE 功能，例如自动完成和方法签名。

虽然我知道如何单独添加它们，但这让我想到了这个问题；在 Eclipse 中安装 Java 库的“正确”方法是什么？我应该遵循一种特殊的目录格式吗？有没有一个插件已经为我做了这个？（答案是[肯定](http://java3d-eclipse.sourceforge.net/)的，但我不知道如何使用它，也不知道它是否合适）。

谢谢！

**编辑1：**在我看来，有人否决了这个问题。我可以问为什么吗？

**编辑 2：**因此，在使用 JAR 之后，似乎为库中的每个 JAR 手动设置文档路径似乎是最不容易出错的方式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-16T03:31:22.517

当您在项目的 LIBRARIES 选项卡中将 .JAR(library) 添加到项目时，您可以选择附加 jar 的 javadoc 目录。

因此，请转到您的项目的“java 构建路径”的 LIBRARIES 选项卡。选择你的罐子。展开 (+) 符号，您将看到可以设置 javadoc。小路。

祝你好运，

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-03-28T01:46:34.163

我想我明白了（和你有同样的问题）。迟到总比不到好。

转到此处 - [http://java3d.java.net/binary-builds.html](http://java3d.java.net/binary-builds.html)并下载文档 zip (j3d-1_5_2-api-docs.zip)。

在您的 HD 上的任何位置提取目录（在 Java3d 文件夹中就可以了）。

将 Jar 的 JavaDoc 列表链接到该文件夹​​（java 构建路径 >> 库 >> 展开 Jar 列表 >> JavaDoc 位置 >> 浏览到文件夹位置，然后验证）。为每个 j3d Jar 执行此操作。

那应该集成 J3D Javadoc。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T04:05:40.200

据我所知（到目前为止还没有使用过 3.4），Eclipse 有两个自动显示 Javadocs 的选项。第一个是附加到 jar 文件的 JavaDoc jar。第二个是将 javadoc 放在源 jar 中，该 jar 附加到 jar 以显示源代码。

如果我没记错的话，一个目录不会提供 javadoc 的自动完成功能。但是，如果您按“F1”，您将能够通过帮助菜单访问 javadoc。

您可以尝试将文档目录放入 jar 文件中，并将其附加到 jar 文件中，看看这是否会欺骗 Eclipse。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T04:11:12.873

我作弊；我所有的 java 项目都是用 maven 构建的，所以我使用 maven 生成一个 eclipse 项目，已经设置了类路径等，并带有一个简单的“mvn eclipse:m2eclipse”。

# c# - MonthCalendar 控件选择范围与 EnableVisualStyles？

> ID：207306
> 
> 赞同：4
> 
> 时间：2008-10-16T03:07:00.693
> 
> 标签：c#, .net, winforms, .net-2.0

我正在使用 MonthCalendar 控件并希望以编程方式选择日期范围。`Application.EnableVisualStyles()`当我这样做时，如果已调用控件，则控件无法正确绘制。根据 MSDN，这是一个已知问题。

> 使用启用视觉样式的 MonthCalendar 将导致 MonthCalendar 控件的选择范围无法正确绘制（来自：http: [//msdn.microsoft.com/en-us/library/system.windows.forms.monthcalendar.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.monthcalendar.aspx)）

除了不打电话之外，真的没有解决办法`EnableVisualStyles`吗？从我的角度来看，这似乎使该特定控件对于一系列应用程序和一个相当明显的疏忽完全无用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-11T11:40:33.343

在寻找相同问题的解决方案时，我首先在这里遇到了这个问题，但后来我发现了[Nicke Andersson](http://nickeandersson.blogs.com/blog/2006/05/_modifying_the_.html)的一篇博客文章。我发现这很有帮助。这是我对尼克的例子所做的：

```
public class MonthCalendarEx : System.Windows.Forms.MonthCalendar
{
    private int _offsetX;
    private int _offsetY;
    private int _dayBoxWidth;
    private int _dayBoxHeight;

    private bool _repaintSelectedDays = false;

    public MonthCalendarEx() : base()
    {
        OnSizeChanged(null, null);
        this.SizeChanged += OnSizeChanged;
        this.DateChanged += OnSelectionChanged;
        this.DateSelected += OnSelectionChanged;
    }

    protected static int WM_PAINT = 0x000F;

    protected override void WndProc(ref System.Windows.Forms.Message m)
    {
        base.WndProc(ref m);
        if (m.Msg == WM_PAINT)
        {
            Graphics graphics = Graphics.FromHwnd(this.Handle);
            PaintEventArgs pe = new PaintEventArgs(
                graphics, new Rectangle(0, 0, this.Width, this.Height));
            OnPaint(pe);
        }
    }

    private void OnSelectionChanged(object sender, EventArgs e)
    {
        _repaintSelectedDays = true;
    }

    private void OnSizeChanged(object sender, EventArgs e)
    {                         
        _offsetX = 0;
        _offsetY = 0;

        // determine Y offset of days area 
        while (
            HitTest(Width / 2, _offsetY).HitArea != HitArea.PrevMonthDate &&
            HitTest(Width / 2, _offsetY).HitArea != HitArea.Date)
        {
            _offsetY++;
        }

        // determine X offset of days area 
        while (HitTest(_offsetX, Height / 2).HitArea != HitArea.Date)
        {
            _offsetX++;
        }

        // determine width of a single day box
        _dayBoxWidth = 0;
        DateTime dt1 = HitTest(Width / 2, _offsetY).Time;

        while (HitTest(Width / 2, _offsetY + _dayBoxHeight).Time == dt1)
        {
            _dayBoxHeight++;
        }

        // determine height of a single day box
        _dayBoxWidth = 0;
        DateTime dt2 = HitTest(_offsetX, Height / 2).Time;

        while (HitTest(_offsetX + _dayBoxWidth, Height / 2).Time == dt2)
        {
            _dayBoxWidth++;
        }
    }

    protected override void OnPaint(PaintEventArgs e)
    { 
        base.OnPaint(e);

        if (_repaintSelectedDays)
        {
            Graphics graphics = e.Graphics;
            SelectionRange calendarRange = GetDisplayRange(false);
            Rectangle currentDayFrame = new Rectangle(
                -1, -1, _dayBoxWidth, _dayBoxHeight);

            DateTime current = SelectionStart;
            while (current <= SelectionEnd)                
            {
                Rectangle currentDayRectangle;

                using (Brush selectionBrush = new SolidBrush(
                    Color.FromArgb(
                        255, System.Drawing.SystemColors.ActiveCaption))) 
                {                    
                    TimeSpan span = current.Subtract(calendarRange.Start); 
                    int row = span.Days / 7; 
                    int col = span.Days % 7; 

                    currentDayRectangle = new Rectangle(
                        _offsetX + (col + (ShowWeekNumbers ? 1 : 0)) * _dayBoxWidth, 
                        _offsetY + row * _dayBoxHeight, 
                        _dayBoxWidth, 
                        _dayBoxHeight);

                    graphics.FillRectangle(selectionBrush, currentDayRectangle); 
                }

                TextRenderer.DrawText(
                    graphics, 
                    current.Day.ToString(), 
                    Font, 
                    currentDayRectangle, 
                    System.Drawing.SystemColors.ActiveCaptionText, 
                    TextFormatFlags.HorizontalCenter | TextFormatFlags.VerticalCenter);

                if (current == this.TodayDate)
                {
                    currentDayFrame = currentDayRectangle;
                }

                current = current.AddDays(1);
            }

            if (currentDayFrame.X > 0)
            {
                graphics.DrawRectangle(new Pen(
                    new SolidBrush(Color.Red)), currentDayFrame);
            }

            _repaintSelectedDays = false;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-06-17T14:05:07.687

这是一个在显示超过一个月时有效的版本（CalendarDimensions != (1,1)），并且还修复了一些其他问题：

```
/// <summary>
/// When Visual Styles are enabled on Windows XP, the MonthCalendar.SelectionRange
/// does not paint correctly when more than one date is selected.
/// See: http://msdn.microsoft.com/en-us/library/5d1acks5(VS.80).aspx
/// "Additionally, if you enable visual styles on some controls, the control might display incorrectly
/// in certain situations. These include the MonthCalendar control with a selection range set...
/// This class fixes that problem.
/// </summary>
/// <remarks>Author: Mark Cranness</remarks>
public class FixVisualStylesMonthCalendar : System.Windows.Forms.MonthCalendar {

    /// <summary>
    /// The width of a single cell (date) in the calendar.
    /// </summary>
    private int dayCellWidth;
    /// <summary>
    /// The height of a single cell (date) in the calendar.
    /// </summary>
    private int dayCellHeight;

    /// <summary>
    /// The calendar first day of the week actually used.
    /// </summary>
    private DayOfWeek calendarFirstDayOfWeek;

    /// <summary>
    /// Only repaint when VisualStyles enabled on Windows XP.
    /// </summary>
    private bool repaintSelectionRange = false;

    /// <summary>
    /// A MonthCalendar class that fixes SelectionRange painting problems 
    /// on Windows XP when Visual Styles is enabled.
    /// </summary>
    public FixVisualStylesMonthCalendar() {

        if (Application.RenderWithVisualStyles
                && Environment.OSVersion.Version < new Version(6, 0)) {

            // If Visual Styles are enabled, and XP, then fix-up the painting of SelectionRange
            this.repaintSelectionRange = true;
            this.OnSizeChanged(this, EventArgs.Empty);
            this.SizeChanged += new EventHandler(this.OnSizeChanged);

        }
    }

    /// <summary>
    /// The WM_PAINT message is sent to make a request to paint a portion of a window.
    /// </summary>
    public const int WM_PAINT = 0x000F;

    /// <summary>
    /// Override WM_PAINT to repaint the selection range.
    /// </summary>
    [System.Diagnostics.DebuggerStepThroughAttribute()]
    protected override void WndProc(ref Message m)
    {
        base.WndProc(ref m);
        if (m.Msg == WM_PAINT
                && !this.DesignMode
                && this.repaintSelectionRange) {
            // MonthCalendar is ControlStyles.UserPaint=false => Paint event is not raised
            this.RepaintSelectionRange(ref m);
        }
    }

    /// <summary>
    /// Repaint the SelectionRange.
    /// </summary>
    private void RepaintSelectionRange(ref Message m) {

        using (Graphics graphics = this.CreateGraphics())
        using (Brush backBrush
                = new SolidBrush(graphics.GetNearestColor(this.BackColor)))
        using (Brush selectionBrush
                = new SolidBrush(graphics.GetNearestColor(SystemColors.ActiveCaption))) {

            Rectangle todayFrame = Rectangle.Empty;

            // For each day in SelectionRange...
            for (DateTime selectionDate = this.SelectionStart;
                    selectionDate <= this.SelectionEnd;
                    selectionDate = selectionDate.AddDays(1)) {

                Rectangle selectionDayRectangle = this.GetSelectionDayRectangle(selectionDate);
                if (selectionDayRectangle.IsEmpty) continue;

                if (selectionDate.Date == this.TodayDate) {
                    todayFrame = selectionDayRectangle;
                }

                // Paint as 'selected' a little smaller than the whole rectangle
                Rectangle highlightRectangle = Rectangle.Inflate(selectionDayRectangle, 0, -2);
                if (selectionDate == this.SelectionStart) {
                    highlightRectangle.X += 2;
                    highlightRectangle.Width -= 2;
                }
                if (selectionDate == this.SelectionEnd) {
                    highlightRectangle.Width -= 2;
                }

                // Paint background, selection and day-of-month text
                graphics.FillRectangle(backBrush, selectionDayRectangle);
                graphics.FillRectangle(selectionBrush, highlightRectangle);
                TextRenderer.DrawText(
                    graphics,
                    selectionDate.Day.ToString(),
                    this.Font,
                    selectionDayRectangle,
                    SystemColors.ActiveCaptionText,
                    TextFormatFlags.HorizontalCenter | TextFormatFlags.VerticalCenter);

            }

            if (this.ShowTodayCircle && !todayFrame.IsEmpty) {
                // Redraw the ShowTodayCircle (square) that we painted over above
                using (Pen redPen = new Pen(Color.Red)) {
                    todayFrame.Width--;
                    todayFrame.Height--;
                    graphics.DrawRectangle(redPen, todayFrame);
                }
            }

        }
    }

    /// <summary>
    /// When displayed dates changed, clear the cached month locations.
    /// </summary>
    private SelectionRange previousDisplayedDates = new SelectionRange();

    /// <summary>
    /// Gets a graphics Rectangle for the area corresponding to a single date on the calendar.
    /// </summary>
    private Rectangle GetSelectionDayRectangle(DateTime selectionDateTime) {

        // Handle the leading and trailing dates from the previous and next months
        SelectionRange allDisplayedDates = this.GetDisplayRange(false);
        SelectionRange fullMonthDates = this.GetDisplayRange(true);
        int adjust1Week;
        DateTime selectionDate = selectionDateTime.Date;
        if (selectionDate < allDisplayedDates.Start 
                || selectionDate > allDisplayedDates.End) {
            // Selection Date is not displayed on calendar
            return Rectangle.Empty;
        } else if (selectionDate < fullMonthDates.Start) {
            // Selection Date is trailing from the previous partial month
            selectionDate = selectionDate.AddDays(7);
            adjust1Week = -1;
        } else if (selectionDate > fullMonthDates.End) {
            // Selection Date is leading from the next partial month
            selectionDate = selectionDate.AddDays(-14);
            adjust1Week = +2;
        } else {
            // A mainline date
            adjust1Week = 0;
        }

        // Discard cached month locations when calendar moves
        if (this.previousDisplayedDates.Start != allDisplayedDates.Start
                || this.previousDisplayedDates.End != allDisplayedDates.End) {
            this.DiscardCachedMonthDateAreaLocations();
            this.previousDisplayedDates.Start = allDisplayedDates.Start;
            this.previousDisplayedDates.End = allDisplayedDates.End;
        }

        Point monthDateAreaLocation = this.GetMonthDateAreaLocation(selectionDate);
        if (monthDateAreaLocation.IsEmpty) return Rectangle.Empty;

        DayOfWeek monthFirstDayOfWeek = (new DateTime(selectionDate.Year, selectionDate.Month, 1)).DayOfWeek;
        int dayOfWeekAdjust = (int)monthFirstDayOfWeek - (int)this.calendarFirstDayOfWeek;
        if (dayOfWeekAdjust < 0) dayOfWeekAdjust += 7;
        int row = (selectionDate.Day - 1 + dayOfWeekAdjust) / 7;
        int col = (selectionDate.Day - 1 + dayOfWeekAdjust) % 7;
        row += adjust1Week;

        return new Rectangle(
            monthDateAreaLocation.X + col * this.dayCellWidth,
            monthDateAreaLocation.Y + row * this.dayCellHeight,
            this.dayCellWidth,
            this.dayCellHeight);

    }

    /// <summary>
    /// Cached calendar location from the last lookup.
    /// </summary>
    private Point[] cachedMonthDateAreaLocation = new Point[13];

    /// <summary>
    /// Discard the cached month locations when calendar moves.
    /// </summary>
    private void DiscardCachedMonthDateAreaLocations() {
        for (int i = 0; i < 13; i++) this.cachedMonthDateAreaLocation[i] = Point.Empty;
    }

    /// <summary>
    /// Gets the graphics location (x,y point) of the top left of the
    /// calendar date area for the month containing the specified date.
    /// </summary>
    private Point GetMonthDateAreaLocation(DateTime selectionDate) {

        Point monthDateAreaLocation = this.cachedMonthDateAreaLocation[selectionDate.Month];
        HitTestInfo hitInfo;
        if (!monthDateAreaLocation.IsEmpty
                && (hitInfo = this.HitTest(monthDateAreaLocation.X, monthDateAreaLocation.Y + this.dayCellHeight))
                    .HitArea == HitArea.Date
                && hitInfo.Time.Year == selectionDate.Year
                && hitInfo.Time.Month == selectionDate.Month) {

            // Use previously cached lookup
            return monthDateAreaLocation;

        } else {

            // Assume the worst (Error: empty)
            monthDateAreaLocation = this.cachedMonthDateAreaLocation[selectionDate.Month] = Point.Empty;

            Point monthDataAreaPoint = this.GetMonthDateAreaMiddle(selectionDate);
            if (monthDataAreaPoint.IsEmpty) return Point.Empty;

            // Move left from the middle to find the left edge of the Date area
            monthDateAreaLocation.X = monthDataAreaPoint.X--;
            HitTestInfo hitInfo1, hitInfo2;
            while ((hitInfo1 = this.HitTest(monthDataAreaPoint.X, monthDataAreaPoint.Y))
                    .HitArea == HitArea.Date
                    && hitInfo1.Time.Month == selectionDate.Month
                || (hitInfo2 = this.HitTest(monthDataAreaPoint.X, monthDataAreaPoint.Y + this.dayCellHeight))
                    .HitArea == HitArea.Date
                    && hitInfo2.Time.Month == selectionDate.Month) {
                monthDateAreaLocation.X = monthDataAreaPoint.X--;
                if (monthDateAreaLocation.X < 0) return Point.Empty; // Error: bail
            }

            // Move up from the last column to find the top edge of the Date area
            int monthLastDayOfWeekX = monthDateAreaLocation.X + (this.dayCellWidth * 7 * 13) / 14;
            monthDateAreaLocation.Y = monthDataAreaPoint.Y--;
            while (this.HitTest(monthLastDayOfWeekX, monthDataAreaPoint.Y).HitArea == HitArea.Date) {
                monthDateAreaLocation.Y = monthDataAreaPoint.Y--;
                if (monthDateAreaLocation.Y < 0) return Point.Empty; // Error: bail
            }

            // Got it
            this.cachedMonthDateAreaLocation[selectionDate.Month] = monthDateAreaLocation;
            return monthDateAreaLocation;

        }
    }

    /// <summary>
    /// Paranoid fudge/wobble of the GetMonthDateAreaMiddle in case 
    /// our first estimate to hit the month misses.
    /// (Needed? perhaps not.)
    /// </summary>
    private static Point[] searchSpiral = {
        new Point( 0, 0),
        new Point(-1,+1), new Point(+1,+1), new Point(+1,-1), new Point(-1,-1), 
        new Point(-2,+2), new Point(+2,+2), new Point(+2,-2), new Point(-2,-2)
    };

    /// <summary>
    /// Gets a point somewhere inside the calendar date area of
    /// the month containing the given selection date.
    /// </summary>
    /// <remarks>The point returned will be HitArea.Date, and match the year and
    /// month of the selection date; otherwise it will be Point.Empty.</remarks>
    private Point GetMonthDateAreaMiddle(DateTime selectionDate) {

        // Iterate over all displayed months, and a search spiral (needed? perhaps not)
        for (int dimX = 1; dimX <= this.CalendarDimensions.Width; dimX++) {
            for (int dimY = 1; dimY <= this.CalendarDimensions.Height; dimY++) {
                foreach (Point search in searchSpiral) {

                    Point monthDateAreaMiddle = new Point(
                        ((dimX - 1) * 2 + 1) * this.Width / (2 * this.CalendarDimensions.Width)
                            + this.dayCellWidth * search.X,
                        ((dimY - 1) * 2 + 1) * this.Height / (2 * this.CalendarDimensions.Height)
                            + this.dayCellHeight * search.Y);
                    HitTestInfo hitInfo = this.HitTest(monthDateAreaMiddle);
                    if (hitInfo.HitArea == HitArea.Date) {
                        // Got the Date Area of the month
                        if (hitInfo.Time.Year == selectionDate.Year
                                && hitInfo.Time.Month == selectionDate.Month) {
                            // For the correct month
                            return monthDateAreaMiddle;
                        } else {
                            // Keep looking in the other months
                            break;
                        }
                    }

                }
            }
        }
        return Point.Empty; // Error: not found

    }

    /// <summary>
    /// When this MonthCalendar is resized, recalculate the size of a day cell.
    /// </summary>
    private void OnSizeChanged(object sender, EventArgs e) {

        // Discard previous cached Month Area Location
        DiscardCachedMonthDateAreaLocations();
        this.dayCellWidth = this.dayCellHeight = 0;

        // Without this, the repaint sometimes does not happen...
        this.Invalidate();

        // Determine Y offset of days area
        int middle = this.Width / (2 * this.CalendarDimensions.Width);
        int dateAreaTop = 0;
        while (this.HitTest(middle, dateAreaTop).HitArea != HitArea.PrevMonthDate
                && this.HitTest(middle, dateAreaTop).HitArea != HitArea.Date) {
            dateAreaTop++;
            if (dateAreaTop > this.ClientSize.Height) return; // Error: bail
        }

        // Determine height of a single day box
        int dayCellHeight = 1;
        DateTime dayCellTime = this.HitTest(middle, dateAreaTop).Time;
        while (this.HitTest(middle, dateAreaTop + dayCellHeight).Time == dayCellTime) {
            dayCellHeight++;
        }

        // Determine X offset of days area
        middle = this.Height / (2 * this.CalendarDimensions.Height);
        int dateAreaLeft = 0;
        while (this.HitTest(dateAreaLeft, middle).HitArea != HitArea.Date) {
            dateAreaLeft++;
            if (dateAreaLeft > this.ClientSize.Width) return; // Error: bail
        }

        // Determine width of a single day box
        int dayCellWidth = 1;
        dayCellTime = this.HitTest(dateAreaLeft, middle).Time;
        while (this.HitTest(dateAreaLeft + dayCellWidth, middle).Time == dayCellTime) {
            dayCellWidth++;
        }

        // Record day box size and actual first day of the month used
        this.calendarFirstDayOfWeek = dayCellTime.DayOfWeek;
        this.dayCellWidth = dayCellWidth;
        this.dayCellHeight = dayCellHeight;

    }

} 
```

我的测试表明 Windows 7 没有绘画问题，我希望 Vista 也没有，所以这只是尝试修复 Windows XP。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-08-10T15:00:25.240

我在上面 Mark Cranness 的代码中发现了一个小问题：在完全禁用视觉样式的 XP 系统上，即使调用 Application.EnableVisualStyles()，Application.RenderWithVisualStyles 也会设置为 False。

因此，在这种情况下，自定义绘制代码根本不会运行。为了修复它，我将 FixVisualStylesMonthCalendar 构造函数的第一行更改为

```
if (Application.VisualStyleState != System.Windows.Forms.VisualStyles.VisualStyleState.NoneEnabled && 
            Environment.OSVersion.Version < new Version(6, 0)) 
```

整个代码在这个答案的底部。

我找不到任何方法来评论答案本身。以下代码的学分归原作者所有 - （如果他或任何人可以验证这个答案并更新它，我很乐意删除这个）

```
/// <summary>
/// When Visual Styles are enabled on Windows XP, the MonthCalendar.SelectionRange
/// does not paint correctly when more than one date is selected.
/// See: http://msdn.microsoft.com/en-us/library/5d1acks5(VS.80).aspx
/// "Additionally, if you enable visual styles on some controls, the control might display incorrectly
/// in certain situations. These include the MonthCalendar control with a selection range set...
/// This class fixes that problem.
/// </summary>
/// <remarks>Author: Mark Cranness - PatronBase Limited.</remarks>
public class FixVisualStylesMonthCalendar : System.Windows.Forms.MonthCalendar
{

    /// <summary>
    /// The width of a single cell (date) in the calendar.
    /// </summary>
    private int dayCellWidth;
    /// <summary>
    /// The height of a single cell (date) in the calendar.
    /// </summary>
    private int dayCellHeight;

    /// <summary>
    /// The calendar first day of the week actually used.
    /// </summary>
    private DayOfWeek calendarFirstDayOfWeek;

    /// <summary>
    /// Only repaint when VisualStyles enabled on Windows XP.
    /// </summary>
    private bool repaintSelectionRange = false;

    /// <summary>
    /// A MonthCalendar class that fixes SelectionRange painting problems 
    /// on Windows XP when Visual Styles is enabled.
    /// </summary>
    public FixVisualStylesMonthCalendar()
    {

        if (Application.VisualStyleState != System.Windows.Forms.VisualStyles.VisualStyleState.NoneEnabled && //Application.RenderWithVisualStyles && 
            Environment.OSVersion.Version < new Version(6, 0))
        {
            // If Visual Styles are enabled, and XP, then fix-up the painting of SelectionRange
            this.repaintSelectionRange = true;
            this.OnSizeChanged(this, EventArgs.Empty);
            this.SizeChanged += new EventHandler(this.OnSizeChanged);
        }
    }

    /// <summary>
    /// The WM_PAINT message is sent to make a request to paint a portion of a window.
    /// </summary>
    public const int WM_PAINT = 0x000F;

    /// <summary>
    /// Override WM_PAINT to repaint the selection range.
    /// </summary>
    [System.Diagnostics.DebuggerStepThroughAttribute()]
    protected override void WndProc(ref Message m)
    {
        base.WndProc(ref m);
        if (m.Msg == WM_PAINT
                && !this.DesignMode
                && this.repaintSelectionRange)
        {
            // MonthCalendar is ControlStyles.UserPaint=false => Paint event is not raised
            this.RepaintSelectionRange(ref m);
        }
    }

    /// <summary>
    /// Repaint the SelectionRange.
    /// </summary>
    private void RepaintSelectionRange(ref Message m)
    {

        using (Graphics graphics = this.CreateGraphics())
        using (Brush backBrush
                = new SolidBrush(graphics.GetNearestColor(this.BackColor)))
        using (Brush selectionBrush
                = new SolidBrush(graphics.GetNearestColor(SystemColors.ActiveCaption)))
        {

            Rectangle todayFrame = Rectangle.Empty;

            // For each day in SelectionRange...
            for (DateTime selectionDate = this.SelectionStart;
                    selectionDate <= this.SelectionEnd;
                    selectionDate = selectionDate.AddDays(1))
            {

                Rectangle selectionDayRectangle = this.GetSelectionDayRectangle(selectionDate);
                if (selectionDayRectangle.IsEmpty) continue;

                if (selectionDate.Date == this.TodayDate)
                {
                    todayFrame = selectionDayRectangle;
                }

                // Paint as 'selected' a little smaller than the whole rectangle
                Rectangle highlightRectangle = Rectangle.Inflate(selectionDayRectangle, 0, -2);
                if (selectionDate == this.SelectionStart)
                {
                    highlightRectangle.X += 2;
                    highlightRectangle.Width -= 2;
                }
                if (selectionDate == this.SelectionEnd)
                {
                    highlightRectangle.Width -= 2;
                }

                // Paint background, selection and day-of-month text
                graphics.FillRectangle(backBrush, selectionDayRectangle);
                graphics.FillRectangle(selectionBrush, highlightRectangle);
                TextRenderer.DrawText(
                    graphics,
                    selectionDate.Day.ToString(),
                    this.Font,
                    selectionDayRectangle,
                    SystemColors.ActiveCaptionText,
                    TextFormatFlags.HorizontalCenter | TextFormatFlags.VerticalCenter);

            }

            if (this.ShowTodayCircle && !todayFrame.IsEmpty)
            {
                // Redraw the ShowTodayCircle (square) that we painted over above
                using (Pen redPen = new Pen(Color.Red))
                {
                    todayFrame.Width--;
                    todayFrame.Height--;
                    graphics.DrawRectangle(redPen, todayFrame);
                }
            }

        }
    }

    /// <summary>
    /// When displayed dates changed, clear the cached month locations.
    /// </summary>
    private SelectionRange previousDisplayedDates = new SelectionRange();

    /// <summary>
    /// Gets a graphics Rectangle for the area corresponding to a single date on the calendar.
    /// </summary>
    private Rectangle GetSelectionDayRectangle(DateTime selectionDateTime)
    {

        // Handle the leading and trailing dates from the previous and next months
        SelectionRange allDisplayedDates = this.GetDisplayRange(false);
        SelectionRange fullMonthDates = this.GetDisplayRange(true);
        int adjust1Week;
        DateTime selectionDate = selectionDateTime.Date;
        if (selectionDate < allDisplayedDates.Start
                || selectionDate > allDisplayedDates.End)
        {
            // Selection Date is not displayed on calendar
            return Rectangle.Empty;
        }
        else if (selectionDate < fullMonthDates.Start)
        {
            // Selection Date is trailing from the previous partial month
            selectionDate = selectionDate.AddDays(7);
            adjust1Week = -1;
        }
        else if (selectionDate > fullMonthDates.End)
        {
            // Selection Date is leading from the next partial month
            selectionDate = selectionDate.AddDays(-14);
            adjust1Week = +2;
        }
        else
        {
            // A mainline date
            adjust1Week = 0;
        }

        // Discard cached month locations when calendar moves
        if (this.previousDisplayedDates.Start != allDisplayedDates.Start
                || this.previousDisplayedDates.End != allDisplayedDates.End)
        {
            this.DiscardCachedMonthDateAreaLocations();
            this.previousDisplayedDates.Start = allDisplayedDates.Start;
            this.previousDisplayedDates.End = allDisplayedDates.End;
        }

        Point monthDateAreaLocation = this.GetMonthDateAreaLocation(selectionDate);
        if (monthDateAreaLocation.IsEmpty) return Rectangle.Empty;

        DayOfWeek monthFirstDayOfWeek = (new DateTime(selectionDate.Year, selectionDate.Month, 1)).DayOfWeek;
        int dayOfWeekAdjust = (int)monthFirstDayOfWeek - (int)this.calendarFirstDayOfWeek;
        if (dayOfWeekAdjust < 0) dayOfWeekAdjust += 7;
        int row = (selectionDate.Day - 1 + dayOfWeekAdjust) / 7;
        int col = (selectionDate.Day - 1 + dayOfWeekAdjust) % 7;
        row += adjust1Week;

        return new Rectangle(
            monthDateAreaLocation.X + col * this.dayCellWidth,
            monthDateAreaLocation.Y + row * this.dayCellHeight,
            this.dayCellWidth,
            this.dayCellHeight);

    }

    /// <summary>
    /// Cached calendar location from the last lookup.
    /// </summary>
    private Point[] cachedMonthDateAreaLocation = new Point[13];

    /// <summary>
    /// Discard the cached month locations when calendar moves.
    /// </summary>
    private void DiscardCachedMonthDateAreaLocations()
    {
        for (int i = 0; i < 13; i++) this.cachedMonthDateAreaLocation[i] = Point.Empty;
    }

    /// <summary>
    /// Gets the graphics location (x,y point) of the top left of the
    /// calendar date area for the month containing the specified date.
    /// </summary>
    private Point GetMonthDateAreaLocation(DateTime selectionDate)
    {

        Point monthDateAreaLocation = this.cachedMonthDateAreaLocation[selectionDate.Month];
        HitTestInfo hitInfo;
        if (!monthDateAreaLocation.IsEmpty
                && (hitInfo = this.HitTest(monthDateAreaLocation.X, monthDateAreaLocation.Y + this.dayCellHeight))
                    .HitArea == HitArea.Date
                && hitInfo.Time.Year == selectionDate.Year
                && hitInfo.Time.Month == selectionDate.Month)
        {

            // Use previously cached lookup
            return monthDateAreaLocation;

        }
        else
        {

            // Assume the worst (Error: empty)
            monthDateAreaLocation = this.cachedMonthDateAreaLocation[selectionDate.Month] = Point.Empty;

            Point monthDataAreaPoint = this.GetMonthDateAreaMiddle(selectionDate);
            if (monthDataAreaPoint.IsEmpty) return Point.Empty;

            // Move left from the middle to find the left edge of the Date area
            monthDateAreaLocation.X = monthDataAreaPoint.X--;
            HitTestInfo hitInfo1, hitInfo2;
            while ((hitInfo1 = this.HitTest(monthDataAreaPoint.X, monthDataAreaPoint.Y))
                    .HitArea == HitArea.Date
                    && hitInfo1.Time.Month == selectionDate.Month
                || (hitInfo2 = this.HitTest(monthDataAreaPoint.X, monthDataAreaPoint.Y + this.dayCellHeight))
                    .HitArea == HitArea.Date
                    && hitInfo2.Time.Month == selectionDate.Month)
            {
                monthDateAreaLocation.X = monthDataAreaPoint.X--;
                if (monthDateAreaLocation.X < 0) return Point.Empty; // Error: bail
            }

            // Move up from the last column to find the top edge of the Date area
            int monthLastDayOfWeekX = monthDateAreaLocation.X + (this.dayCellWidth * 7 * 13) / 14;
            monthDateAreaLocation.Y = monthDataAreaPoint.Y--;
            while (this.HitTest(monthLastDayOfWeekX, monthDataAreaPoint.Y).HitArea == HitArea.Date)
            {
                monthDateAreaLocation.Y = monthDataAreaPoint.Y--;
                if (monthDateAreaLocation.Y < 0) return Point.Empty; // Error: bail
            }

            // Got it
            this.cachedMonthDateAreaLocation[selectionDate.Month] = monthDateAreaLocation;
            return monthDateAreaLocation;

        }
    }

    /// <summary>
    /// Paranoid fudge/wobble of the GetMonthDateAreaMiddle in case 
    /// our first estimate to hit the month misses.
    /// (Needed? perhaps not.)
    /// </summary>
    private static Point[] searchSpiral = {
    new Point( 0, 0),
    new Point(-1,+1), new Point(+1,+1), new Point(+1,-1), new Point(-1,-1), 
    new Point(-2,+2), new Point(+2,+2), new Point(+2,-2), new Point(-2,-2)
};

    /// <summary>
    /// Gets a point somewhere inside the calendar date area of
    /// the month containing the given selection date.
    /// </summary>
    /// <remarks>The point returned will be HitArea.Date, and match the year and
    /// month of the selection date; otherwise it will be Point.Empty.</remarks>
    private Point GetMonthDateAreaMiddle(DateTime selectionDate)
    {

        // Iterate over all displayed months, and a search spiral (needed? perhaps not)
        for (int dimX = 1; dimX <= this.CalendarDimensions.Width; dimX++)
        {
            for (int dimY = 1; dimY <= this.CalendarDimensions.Height; dimY++)
            {
                foreach (Point search in searchSpiral)
                {

                    Point monthDateAreaMiddle = new Point(
                        ((dimX - 1) * 2 + 1) * this.Width / (2 * this.CalendarDimensions.Width)
                            + this.dayCellWidth * search.X,
                        ((dimY - 1) * 2 + 1) * this.Height / (2 * this.CalendarDimensions.Height)
                            + this.dayCellHeight * search.Y);
                    HitTestInfo hitInfo = this.HitTest(monthDateAreaMiddle);
                    if (hitInfo.HitArea == HitArea.Date)
                    {
                        // Got the Date Area of the month
                        if (hitInfo.Time.Year == selectionDate.Year
                                && hitInfo.Time.Month == selectionDate.Month)
                        {
                            // For the correct month
                            return monthDateAreaMiddle;
                        }
                        else
                        {
                            // Keep looking in the other months
                            break;
                        }
                    }

                }
            }
        }
        return Point.Empty; // Error: not found

    }

    /// <summary>
    /// When this MonthCalendar is resized, recalculate the size of a day cell.
    /// </summary>
    private void OnSizeChanged(object sender, EventArgs e)
    {

        // Discard previous cached Month Area Location
        DiscardCachedMonthDateAreaLocations();
        this.dayCellWidth = this.dayCellHeight = 0;

        // Without this, the repaint sometimes does not happen...
        this.Invalidate();

        // Determine Y offset of days area
        int middle = this.Width / (2 * this.CalendarDimensions.Width);
        int dateAreaTop = 0;
        while (this.HitTest(middle, dateAreaTop).HitArea != HitArea.PrevMonthDate
                && this.HitTest(middle, dateAreaTop).HitArea != HitArea.Date)
        {
            dateAreaTop++;
            if (dateAreaTop > this.ClientSize.Height) return; // Error: bail
        }

        // Determine height of a single day box
        int dayCellHeight = 1;
        DateTime dayCellTime = this.HitTest(middle, dateAreaTop).Time;
        while (this.HitTest(middle, dateAreaTop + dayCellHeight).Time == dayCellTime)
        {
            dayCellHeight++;
        }

        // Determine X offset of days area
        middle = this.Height / (2 * this.CalendarDimensions.Height);
        int dateAreaLeft = 0;
        while (this.HitTest(dateAreaLeft, middle).HitArea != HitArea.Date)
        {
            dateAreaLeft++;
            if (dateAreaLeft > this.ClientSize.Width) return; // Error: bail
        }

        // Determine width of a single day box
        int dayCellWidth = 1;
        dayCellTime = this.HitTest(dateAreaLeft, middle).Time;
        while (this.HitTest(dateAreaLeft + dayCellWidth, middle).Time == dayCellTime)
        {
            dayCellWidth++;
        }

        // Record day box size and actual first day of the month used
        this.calendarFirstDayOfWeek = dayCellTime.DayOfWeek;
        this.dayCellWidth = dayCellWidth;
        this.dayCellHeight = dayCellHeight;

    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-09-28T12:54:33.580

你可以试试这段代码：

```
Dim StartDate As Date = New DateTime(2011, 9, 21)
Dim EndDate As Date = New DateTime(2011, 9, 25)
MonthCalendar1.SelectionRange = New SelectionRange(StartDate, EndDate) 
```

了解更多信息：

[http://www.authorcode.com/how-to-select-a-range-of-dates-in-the-monthcalendar-control/](http://www.authorcode.com/how-to-select-a-range-of-dates-in-the-monthcalendar-control/)

[http://www.authorcode.com/how-to-enable-windows-xp-visual-styles-of-net-application/](http://www.authorcode.com/how-to-enable-windows-xp-visual-styles-of-net-application/)

# sql - 父子关系SQL查询

> ID：207309
> 
> 赞同：13
> 
> 时间：2008-10-16T03:08:34.763
> 
> 标签：sql, sql-server-2005, hierarchical-data

我有父子关系的数据库表：

```
NodeId    NodeName    ParentId
------------------------------
1         Node1       0
2         Node2       0
3         Node3       1
4         Node4       1
5         Node5       3
6         Node6       5
7         Node7       2 
```

这里 parentId = 0 表示它是根级节点。现在我想编写一个 SQL 查询，它将返回父类别所有级别的子级。

例如，对于 nodeId = 1，它应该返回 3、4、5、6。

我正在使用 MS SQL Server 2005

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-16T03:17:39.533

```
with [CTE] as (
    select * from [TheTable] c where c.[ParentId] = 1
    union all
    select * from [CTE] p, [TheTable] c where c.[ParentId] = p.[NodeId]
)
select * from [CTE] 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-17T13:56:32.987

您应该考虑将嵌套集模型用于 SQL 数据库中的父子关系。这比尝试将记录的 parentID 存储在这样的表中要好得多，并且使这样的查询更容易。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-06T06:45:19.143

并且只是为了确保它在它自己的父级时有效（否则它将递归直到它中断）：

```
 with [CTE] as (
        select * from [TheTable] c where c.[ParentId] = 1
        union all
        select * from [CTE] p, [TheTable] c where c.[ParentId] = p.[NodeId]
        and c.[ParentId] <> c.[NodeId]
    )
    select * from [CTE] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-01-20T07:52:06.537

```
 WITH Temp_Menu AS
 ( 
  SELECT AM.* from FCB_AccessMenu AM where AM.[ParentId] = 6   

           UNION ALL     

        SELECT AM.* FROM  FCB_AccessMenu AM ,Temp_Menu TM  WHERE AM.[ParentID]=TM.[MenuID]        

  )   

  SELECT * FROM Temp_Menu ORDER BY ParentID 
```

# c++ - 带有函数指针的 C++ 递归遍历

> ID：207312
> 
> 赞同：1
> 
> 时间：2008-10-16T03:10:51.637
> 
> 标签：c++, binary-tree, traversal

```
template <class T>
void BT<T>::inOrder(void (*inOrderPtr)(T&))
 {
     inOrderPtr(inOrder(this->root));
 }
template <class T>
void BT<T>::inOrder(Node<T>* root) const
 {
    if (root->left != NULL)
       inOrder(root->left);
       //something here
    if (root->right != NULL)
       inOrder(root->right);
 } 
```

好的，我正在尝试通过递归创建此遍历。我实际上之前发布了这个问题，但由于我必须使用函数指针，所以我做错了。我不明白我应该做什么。我有调用私有包装的公共包装器......但是公共包装器是带有传入函数的包装器，所以我该怎么办？我觉得自己很迟钝，所以即使有人给我一个小小的暗示，我也相信我会明白的。我只是不知道从这里去哪里。

调用它的代码示例如下：

```
first.inOrder(print_val) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-16T03:17:51.403

这是正确执行此操作的方法，但 Node::GetItem 需要实现以使其 100% 正确：

```
template <class T>
T& Node<T>::GetItem() const
 {
    // TODO - implement getting a T& from a Node<T>
    return m_item; // possible implementation depending on Node's definition
 }

template <class T>
void BT<T>::inOrder(void (*inOrderPtr)(T&))
 {
    inOrder(this->root, inOrderPtr);
 }

template <class T>
void BT<T>::inOrder(Node<T>* root, void (*inOrderPtr)(T&)) const
 {
    if (root->left != NULL)
       inOrder(root->left, inOrderPtr);

    inOrderPtr(root->GetItem());

    if (root->right != NULL)
       inOrder(root->right, inOrderPtr);
 } 
```

# com+ - 调用 COMAdminCatalog.InstallApplication 中的应用程序文件是什么类型

> ID：207327
> 
> 赞同：1
> 
> 时间：2008-10-16T03:18:24.150
> 
> 标签：com+

有没有人使用 COMAdminCatalog.InstallApplication 成功地将应用程序安装到 COM+ 中？如果是这样，您需要将什么类型的文件作为 bstrApplicationFile 参数传递？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T17:42:42.033

.msi 安装程序。ExportApplication 则相反（它从现有应用程序创建一个 .msi 安装程序）

# php - 如何通过 CMS 界面使 Joomla 模板的一部分可编辑？

> ID：207335
> 
> 赞同：0
> 
> 时间：2008-10-16T03:22:29.850
> 
> 标签：php, content-management-system, joomla

标题说明了大部分内容。

我继承了一个 Joomla 站点，客户希望通过 Joomla 后端编辑主模板的一部分（功能类型框）。

我想它确实是一个内容项，它永远不会显示为自己的页面，而是作为所有页面的一部分。

那可能吗？

谢谢。

编辑：通过可编辑，我的意思是作为一段内容，而不是编辑模板 HTML。我几乎不指望非技术用户在所见即所得的文本编辑器中做正确的事情，更不用说更改可能搞砸整个网站的 HTML 代码了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-16T18:45:34.357

自定义 HTML 模块允许您使用所见即所得编辑器在 Joomla 站点上创建、编辑和显示您自己的自由格式 HTML。

在您的管理控制面板中，您可以在下拉导航菜单的“扩展”下找到“模块管理器”。在那里，您可以创建此模块，在模板中选择一个位置来显示它，然后选择应该显示该模块的站点的哪些部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-18T11:54:52.403

您需要内容项模块。

[内容项模块](http://extensions.joomla.org/component/option,com_mtree/task,viewlink/link_id,498/Itemid,35/)

这样，用户可以使用标准内容页面正常添加内容，但作为开发人员，您可以将模块设置为仅将内容显示为模块。上面的模块也有很多选择，你可以设置个人、类别、介绍、主要等等。不要链接到页面或类别，它不会显示在主站点上，只是在模块中:)

joomla 扩展目录充满了很棒的东西。

祝你好运

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-03T15:41:14.890

您可以使用 Joomla 的特殊组件来编辑模板、模板的任何部分、任何标签。查看[dewem 模板编辑器组件](http://dewem.com/en/joomla.phtml)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T04:07:22.443

Joomla 模板始终可以通过后端进行编辑。只需进入扩展->模板管理器->选择您用于编辑它的模板->然后在工具栏中有用于编辑html或css的选项以及许多设计（外观）选项对。那是在 Joomla 1.5 中。

# oracle - 甲骨文 V$OSSTAT

> ID：207337
> 
> 赞同：3
> 
> 时间：2008-10-16T03:22:58.850
> 
> 标签：oracle, statistics

Oracle 视图 V$OSSTAT 包含一些操作统计信息，包括：

*   IDLE_TICKS 处理器空闲的百分之一秒数，所有处理器的总和
*   BUSY_TICKS 处理器忙于执行用户或内核代码的百分之一秒数，所有处理器的总和

我读过的文档并不清楚这些是否被重置。有人知道吗？

我的另一个问题是我想计算出系统正在经历的平均 CPU 负载。为此，我希望我必须去：

```
busy_ticks / (idle_ticks + busy_ticks) 
```

它是否正确？

**11 月 8 日更新**

Oracle 10g r2 在该表中包含一个名为 LOAD 的统计信息。它提供读取值时机器的当前负载。这比使用其他信息要好得多，因为 *_ticks 数据是“自实例开始”而不是当前时间点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-16T13:04:34.793

如果可用，您需要包含“IOWAIT_TICKS”。

> IDLE_TICKS - 处理器空闲的百分之一秒数，所有处理器的总和
> 
> BUSY_TICKS - 处理器忙于执行用户或内核代码的百分之一秒数，所有处理器的总和
> 
> IOWAIT_TICKS - 处理器等待 I/O 完成的百分之一秒数，总领先于所有处理器

这是一个查询。

```
SELECT (select value from v$osstat where stat_name = 'BUSY_TICKS') /
(
   NVL((select value from v$osstat where stat_name = 'IDLE_TICKS'),0) +
   NVL((select value from v$osstat where stat_name = 'BUSY_TICKS'),0) +
   NVL((select value from v$osstat where stat_name = 'IOWAIT_TICKS'),0)
)
FROM DUAL; 
```

在 10.2 及更高版本中，名称 _TICKS 已更改为 _TIME。

当数据库实例关闭时，动态视图中的累积值会被重置。

有关详细信息，请参阅[自动性能统计](http://download.oracle.com/docs/cd/B19306_01/server.102/b14211/autostat.htm#PFGRF02601)信息和[v$OSStat](http://download.oracle.com/docs/cd/B19306_01/server.102/b14237/dynviews_2010.htm)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T20:31:28.573

我不相信我需要包括 USER_TICKS 和 SYS_TICKS。

BUSY_TICKS 的文档指出：

```
"...been busy executing user or kernel code, totalled over all processors" 
```

这表明 BUSY_TICKS 已经包含 USER_TICKS 和 SYS_TICKS。

NICE_TICKS 也是如此 - 它仍然是用户时间（只是较低的优先级）。

不过，包括 IOWAIT_TICKS 似乎是必要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T22:03:11.413

您对 Busy 值是正确的。我检查了我的一个系统，Busy 等于 User + Sys。

我还确认了我系统上一直存在 Busy 和 Idle 帐户（我的系统没有 IOWAIT）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T23:49:54.303

想一想，如果我的目的是了解整体机器负载，我可能会更好地将 IOWAIT_TICKS 包括在分子和分母中，以了解我的工作不可用的 CPU 时间量。

```
SELECT (
(select value from v$osstat where stat_name = 'BUSY_TICKS') +
(select value from v$osstat where stat_name = 'IOWAIT_TICKS'))
/
(
   NVL((select value from v$osstat where stat_name = 'IDLE_TICKS'),0) +
   NVL((select value from v$osstat where stat_name = 'BUSY_TICKS'),0) +
   NVL((select value from v$osstat where stat_name = 'IOWAIT_TICKS'),0)
)
FROM DUAL; 
```

这将确保如果机器的 IO 争用或等待率很高，我不会被误导，并且会通过运行更多作业来增加问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T01:45:25.460

取决于你的观点。知道你在追求什么，我认为你做对了。

# c# - 如何在单元测试期间设置数据结构的内部状态？

> ID：207343
> 
> 赞同：12
> 
> 时间：2008-10-16T03:24:31.483
> 
> 标签：c#, tdd

我正在用 C# 编写一个数据结构（使用[斐波那契堆](http://en.wikipedia.org/wiki/Fibonacci_heap)的优先级队列），我试图将它用作我对 TDD 很陌生的学习经验。

我知道每个测试应该只测试一个类，这样一个单元的失败不会让我与多个测试失败混淆，但是当数据结构的状态很重要时，我不确定如何做到这一点一个测试。

例如，

```
private PriorityQueue<int> queue;

[SetUp]
public void Initialize()
{
    this.queue = new PriorityQueue<int>();       
}

[Test]
public void PeekShouldReturnMinimumItem()
{
    this.queue.Enqueue(2);
    this.queue.Enqueue(1);

    Assert.That(this.queue.Peek(), Is.EqualTo(1));
} 
```

如果其中一个`Enqueue`或`Peek`坏了，这个测试就会失败。

我在想我可以以某种方式让测试手动设置底层数据结构的堆，但我不确定如何在不向世界公开实现的情况下做到这一点。

有一个更好的方法吗？依赖其他部分好吗？

我有一个`SetUp`地方，只是为了简单起见。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-16T03:29:37.200

将类的私有访问器添加到您的测试项目。使用访问器以某种已知的方式设置类的私有属性，而不是使用类方法来这样做。

您还需要在测试类上使用`SetUp`和方法来执行测试之间所需的任何初始化。`TearDown`实际上，我更喜欢在每个测试中重新创建队列，而不是在测试之间重用它以减少测试用例之间的耦合。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-16T03:44:12.600

从理论上讲，您一次只想测试一个功能。但是，如果您的队列只有几个方法（`Enqueue`, `Peek`, `Dequeue`, `Count`），那么您在仅使用一种方法时可以执行的测试类型非常有限。

最好不要过度设计问题，只需创建一些简单的测试用例（例如上面的测试用例）并在此基础上构建以确保适当覆盖各种功能。

我觉得编写涵盖多个功能的测试是合适的，只要你有一些东西在使用的功能之一被破坏时也会破坏。因此，如果你有一个测试套件并且你破坏`Enqueue`了你的所有测试（或者大多数测试都会失败），但你会知道`Enqueue`因为你最简单的测试而破坏了。不应忽视测试与其测试套件的关系。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T03:27:02.523

我认为这没问题，但在您的测试方法开始时清除队列。

# agile - 卡墙+在线卡墙=重复？

> ID：207351
> 
> 赞同：12
> 
> 时间：2008-10-16T03:29:56.357
> 
> 标签：agile, scrum

我不喜欢重复努力。然而，我确实发现在物理卡片墙和在线“计算器”（Excel、一些 scrum 工具）或在线卡片墙（例如 Mingle）上跟踪敏捷迭代进度是有好处的。

我发现团队空间中的实体卡片墙提供了与卡片状态的内在联系……当你完成某件事时物理移动卡片提供了一种在线无法复制的满足感。我能感觉到这张卡片……人们可以看到我走到墙上移动一些东西。

在线工具提供了远程共享和计算进度的强大功能（例如，在 Mingle 中，您可以使用内置工具从真实数据中自动计算燃耗或燃耗，从而节省大量手动执行这些操作的管理时间）。

我很好奇敏捷从业者是否像我一样维护两个跟踪媒体，你如何向那些说“我可以在网上做......为什么我想在卡片墙上做”的人展示物理墙的好处反而？”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T03:59:09.200

我有同样的感觉。在墙上移动实体卡有一些心理上的满足感。从管理角度考虑，我们喜欢统计数据，并且我们希望它们尽可能地自动化。

也许你可以保留两者？使用物理墙作为团队日常工作的主要信息来源。然后，指派一个人（例如，scrum master）在每天结束时将实时状态记录下来并放入 Mingle/Excel。

只要对用户有很好的好处，同时拥有两者，那么您应该会发现两者都很好地并存。找出每个工具的动机是什么。例如：

**物理墙：**

*   即时反应
*   快速视觉
*   身体上的满足

**在线记录：**

*   非常有用的统计数据
*   人们可以根据那里的统计数据获得奖励（例如完成的积分）

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T15:52:26.810

我的团队也为此苦苦挣扎。电子数据使分析和报告变得非常容易，并使签到与积压项目相关联，但在站立期间管理卡片要容易得多。另外，从大墙比小显示器更容易获得项目的“5000 英尺视图”。

无论您做什么，您要么会做*一些*重复的工作，要么会有一个有一些痛点的过程。目标是在重复工作的数量和它提供的价值之间找到平衡。

我们仍在努力寻找平衡 :) 这就是我们所做的：

*   在规划期间，我们将所有内容都放入 OneNote。格式化有点痛苦，但我们正在变得更好。
*   经过规划，我们的 ScrumMaster 将来自 OneNote 的数据输入到 Excel 文档中，以生成我们的燃尽图。然后，他将这些数据导出到 TFS 中，用于关联签到，并进行邮件合并以将每个任务打印在标签上，然后将其贴在便利贴上并添加到墙上。
*   在站立期间，我们在墙上移动便利贴。
*   站立后，ScrumMaster 更新 Excel 文档，生成燃尽更新，并将其发送给团队。

作为一个团队成员，这是非常低摩擦的，但它非常浪费 ScrumMaster 的时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-17T23:29:49.460

我非常喜欢挂在墙上的卡片，原因很简单：
每个人都知道如何使用它们。无需软件培训。
不受网络问题、某人的电脑需要维护等问题的影响，即使在停电的情况下，人们仍然可以更新他们的卡。这听起来像是一个笑话，但是当您由于某种原因无法使用您的 PC 时，有事可做会很好
程序员可以在启动/编译时自由更新卡
一眼就能看到它们
非常适合开会如果您在 scrum 环境中并在办公桌旁召开小型会议。

我喜欢在卡片随着时间和移动器移动时在卡片上记下笔记……以跟踪错误/功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-25T11:22:57.670

每个人都能看到的大墙有一些非常好的地方。我认为我们需要一种在普通厚索引卡上打印的方法，但我没有运气，所以目前是重复的努力。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-06T23:06:04.200

我只是想知道。一个巨大的基于投影仪的触摸墙怎么样。;） 两全其美。这可能会给出一些指示。 [http://johnnylee.net/projects/wii/](http://johnnylee.net/projects/wii/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-04-13T15:21:43.573

[电子卡片墙](http://cardwalls.com)使用 RFID，您可以使用物理墙，数据由您选择的软件控制。当您移动卡片时，软件会相应地更新。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-16T03:41:04.383

交叉链接您的在线和卡片墙。

设置双向复制。方法留给学生作为练习。

从讨论中捕捉白板内容也很方便。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-16T03:59:08.483

我们两者都用，我无法想象用其他任何方式。部分原因可能是我们发现我们的“在线卡片墙”有点笨拙，无法轻松操作，但我们使用物理卡片快速了解开发人员正在做什么，让 QA 知道哪些卡片已准备好进行测试，并让 QA 发布为我们的每周演示准备好的内容。开发区、QA 区和准备演示区是三个物理上截然不同的地方，准备演示区最容易访问。我们还使用实体卡进行最终评分。

我们可以在线完成所有这些吗？是的，它会更快，更容易吗？没门！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-19T21:46:52.337

在 sprint 计划会议之后，我们已经放弃使用卡片（它们被添加到 Rally），因为我们在多个地方进行跟踪没有意义。我们的 scrum master 负责确保人们正确地输入他们的任务并移动它们（这就是每日站立的目的）。在线工具中 5000 英尺的视图比墙上的一堆卡片要好得多，这些卡片只能二维分类（或者如果你堆叠得足够多，可能是三个）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-19T21:56:42.033

我们同时使用卡片墙和[ProjectCards](http://www.projectcards.com)。这对我来说很痛苦，因为我同步了他们两个，但是为本地团队提供反馈是值得的。

我们已经讨论了获得大触摸屏的想法，但我仍然更愿意拥有实体卡。我一直在玩弄的另一个想法是拥有一台打印机，它会在将故事添加到 ProjectCards 时自动打印出索引卡。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-05-20T00:43:24.447

如果你使用 JIRA。 [http://wallsync.net](http://wallsync.net)将为您保持卡片同步...

# finance - 设计个人理财应用

> ID：207367
> 
> 赞同：3
> 
> 时间：2008-10-16T03:44:56.967
> 
> 标签：finance, currency

作为一个附带项目，我正在考虑创建一个个人理财计划。我曾尝试使用 Money 和 Excel 来跟踪我的财务状况，但要么对稳定性不满意，要么缺乏功能。我的问题是，您使用什么工具来跟踪您的个人财务状况？以下是我想达到的一些要求：

1.  稳定的
2.  可以自动从银行免费下载数据
3.  可定制性足以轻松地从选定帐户创建总余额

我正在考虑使用 python 脚本，但实际上并没有比这更进一步。有哪些接口可以自动下载账户信息？

编辑：所以似乎普遍认为有许多开源工具可以修改以满足您的需求。此外，如果愿意花一些钱，许多人似乎对使用 Quicken 感到满意。就在线记录跟踪而言，[薄荷](http://www.mint.com/)似乎是最受欢迎的选择。

我在使用 mint 或 yodlee 等在线系统时遇到的唯一问题是，没有简单的方法可以“批准”银行交易，以便您可以核对收据并查看它们是否与费用相符。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T03:56:20.953

也许与其从头开始并尝试重新创建数万工时的编程工作，您可以尝试一些开源替代方案。如果其中一个足够接近但缺少一两个功能，您可以自己添加。

[这是 50 种开源金融工具的列表](http://www.rewardprograms.org/thefreegeek/features/wide-open-wallet-50-awesome-open-source-financial-tools.html)。

（我没有使用过这些。我自己使用 Quicken，并且非常喜欢它。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-16T03:58:22.557

Lifehacker 刚刚开始[研究在线应用程序](http://lifehacker.com/5063159/battle-of-the-web+based-personal-finance-apps)。

我个人喜欢[薄荷](http://www.mint.com)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-16T05:36:26.633

OFX 是许多银行用来直接与他们沟通的标准。

iBanks for OS X 刚刚添加了这个功能，而且效果很好。

在我所有的各种账户中，我认为 90% 都支持 OFX，我现在像 Quicken 和 Money 一样直接下载到 iBank。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-16T03:56:21.123

你检查过[薄荷](http://www.mint.com/)吗？在“自己滚动”方面，我想你会发现银行没有一致的 API 来下载你的记录——每个都有自己的格式。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-16T04:00:19.883

MS Money 2002 是我开始使用财务软件以及储蓄和关注收入与支出的原因，所以我心中永远对它情有独钟。

但是，我使用 Wesabe 和最近的[Mint](http://www.mint.com)作为在线工具，为我整合了我所有的银行业务。

Mint 让我可以跟踪我的支票、储蓄、抵押和退休账户，并且最近开始允许自定义类别。它还会检查我的信用卡利息与其他优惠（和储蓄/支票），看看我可以在哪里省钱。当然它有所有的报告，所以我可以看到我在杂货和新显示器上花了多少钱。

我喜欢它，因此，如果我是你，我会避免重新实现轮子 - 至少检查几个星期。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-16T05:11:45.637

我使用 OpenOffice.org 电子表格来管理我的小型投资公司。我最初在运行 Windows 时使用 Quickbooks，并在切换到 Ubuntu 时尝试使用 GnuCash，但老实说，我不需要那种级别的功能。

因为我实际上只是将报表中的数据输入到复式系统中，所以我编写了宏来从银行文件中导入数据，并为最后的会计师创建资产负债表、损益表和详细的交易报告。年。

它可以完成我需要做的所有事情，除了跟踪个人投资的状态，但这不是会计目的所必需的——我在另一个电子表格中出于自己的目的进行跟踪。

我的两家银行都允许我为我的交易下载 QIF 文件，并且我有宏来导入它。

我使用专门的会计软件做得很好，我宁愿拥有控制权，也不愿等待需要添加到 GnuCash 的功能。不要误会我的意思，这是一个很好的应用程序，但我的妻子（我相信她是对的，因为 (1) 她是 CA，最重要的是 (2) 她是我的妻子 :-) 说它有一些令人讨厌的限制。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-16T06:10:32.040

我一直在使用[Yodlee MoneyCenter](https://moneycenter.yodlee.com/)，它对我来说很好用。它会自动从银行同步我的数据，对我的交易进行分类，发送有关超支等的电子邮件/短信警报，

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-16T03:51:51.790

我用过的最可靠的会计应用程序是我在 1992 年购买的 Quicken v2。我使用了 11 年到 2003 年，它从来没有崩溃或损坏数据或做任何不寻常的事情，并且完美而简单地执行了它的功能。它没有的功能之一（如果内存服务器我正确的话）是从银行下载。但是，如果您想看到一款可靠、功能齐全且设计精美的会计软件用作您的模板，那么我建议您尝试追踪该版本的 Quicken。它是为 Windows 3.11 设计的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-16T03:59:39.480

我使用 MS Money 大约 12 年。最终，我意识到我所做的只是在从网上下载报表后更正商店名称的拼写。基本上，银行、信用卡公司和经纪公司在为您实时跟踪一切方面做得非常出色。

我并不是要劝阻你继续推进你的项目，但如果你问的是我们在金融工具中寻找什么——这几乎就是我的答案。

也许有人（比如你自己）可以构建一个应用程序，它不仅仅是一个美化的支票簿（比如 Quicken 和 Money），而是一种更方便的方式，可以将银行的所有数据汇总到一个屏幕上（也许是在网络上？） . 没什么太花哨的——只是让我知道我没有多少钱的一种方式。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-09-09T14:07:12.897

有趣的是，我目前也在自己工作。过去使用 Quicken & excel。但我和你有同样的问题。我喜欢将我所有的财务/用户名/密码保存在我自己的电脑上的能力。叫我偏执狂，但我不是在线版本的忠实粉丝。我自己的设置可能已经完成了一半，这意味着我距离完成第一次运行还有大约一年的时间。不过工作还是蛮有趣的。

根据您的清单，这是我认为金融应用程序应该做的事情：

根据您已经设置的内容重命名/分类*（这是我发现大多数其他人缺乏的地方）

以当前的速度向您展示 x 年后您将在哪里*（他们中的任何一个目前都这样做吗？）

看看未来的购买或活动如何符合您的预算*（我也没有见过）

以及所有正常的花里胡哨。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-03-23T19:26:31.903

这是一个较旧的线程，但我偶然发现了它。

@dr_pepper 如果您使用 Yodlee MoneyCenter，您可以单击交易并向其中添加元数据，以记录您是否自己对此进行了核对。这有点小技巧，但是您可以重新调整其中一个复选框（即“可偿还”）的用途，以便在您对交易进行核对时使用它。问题是没有简单的方法来搜索未经检查可报销的交易。但是，每笔交易旁边都有一个视觉通知，告诉您是否添加了额外的元数据。

# vba - MS 字的 VBA

> ID：207375
> 
> 赞同：7
> 
> 时间：2008-10-16T03:50:29.077
> 
> 标签：vba, ms-word

有很多免费资源可以了解 MS Excel 的对象模型，但我没有找到任何全面的资源来获取 MS Word 的类似资源。

您能建议一个免费且全面的资源吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-20T17:53:12.727

我最近学习了 Word 对象模型，我发现以下几页最有帮助。我认为，只要您了解 Word 应用程序（从用户的角度），您需要做的就是充实您对 Word.Range 的理解，并最终充实您对 Word Story Types 的理解。正如其他海报所建议的那样，Word 的 Visual Basic 编辑器中的对象浏览器非常方便浏览任何特定对象的可用属性和方法。

所有 Word VBA 的入口点。按方法、对象、集合等浏览：

*   [Microsoft Word Visual Basic 参考](http://msdn.microsoft.com/en-us/library/aa272078(office.11).aspx)

专门关于使用 Word 范围的有用页面：

*   [使用范围](http://msdn.microsoft.com/en-us/library/aa171380(office.11).aspx)

*   [修改文档的一部分](http://msdn.microsoft.com/en-us/library/aa211943(office.11).aspx)

*   [选择对象](http://msdn.microsoft.com/en-us/library/aa223084(office.11).aspx)

*   [分配范围](http://msdn.microsoft.com/en-us/library/aa211919(office.11).aspx)

Word的故事类型简介：

*   [幕后：Word中的故事](http://blogs.msdn.com/microsoft_office_word/archive/2008/10/02/behind-the-curtain-stories-in-word.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T03:57:12.870

在 VBA 编辑器中，如果您按 F2，就会有一个对象浏览器，它是一个非常方便的参考。您还可以针对特定于 Word 的对象对其进行过滤。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T06:54:11.297

查看 VBA 帮助（连同调试器）帮助我学习了我需要的任何东西。帮助文件非常全面。

# java - 从网页中剥离 HTML 并计算词频？

> ID：207404
> 
> 赞同：4
> 
> 时间：2008-10-16T04:02:37.383
> 
> 标签：java, html, groovy, html-content-extraction, text-extraction

在 Groovy 中，如何抓取网页并移除 HTML 标签等，只留下文档的文本？我希望将结果转储到一个集合中，以便我可以构建一个词频计数器。

最后，让我再次提一下，我想在 Groovy 中执行此操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-16T04:35:58.970

假设您想使用 Groovy（基于 groovy 标记进行猜测）来执行此操作，您的方法很可能是面向 shell 脚本或使用 Java 库的。对于 shell 脚本，我同意 moogs 的观点，使用 Lynx 或 Elinks 可能是最简单的方法。否则，请查看[HTMLParser](http://htmlparser.sourceforge.net/)并查看[处理文件中的每个单词](http://pleac.sourceforge.net/pleac_groovy/filecontents.html)（向下滚动以查找相关代码片段）

您可能无法找到与 Groovy 一起用于 HTML 解析的 Java 库，因为它似乎没有任何 Groovy 库。如果您不使用 Groovy，请发布所需的语言，因为那里有大量的[HTML 到文本工具](http://www.google.com/search?q=html+to+text)，具体取决于您使用的语言。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T16:08:01.710

如果您想要来自 HTML 的标记化单词的集合，那么您不能像 XML 一样解析它（需要是有效的 XML）并获取标签之间的所有文本吗？像这样的东西怎么样：

```
def records = new XmlSlurper().parseText(YOURHTMLSTRING)
def allNodes = records.depthFirst().collect{ it }
def list = []
allNodes.each {
    it.text().tokenize().each {
        list << it
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T04:12:11.140

您可以使用[Lynx Web 浏览器](http://en.wikipedia.org/wiki/Lynx_web_browser)吐出文档文本并保存。

您想自动执行此操作吗？您想要一个单独的应用程序来执行此操作吗？或者您需要帮助将其编码到您的应用程序中吗？它将在哪些平台（Windows 桌面、Web 服务器等）上运行？

# eclipse - 让 Eclipse 用户定期更新插件的最佳方法是什么？

> ID：207407
> 
> 赞同：3
> 
> 时间：2008-10-16T04:04:15.663
> 
> 标签：eclipse, updates

我将分发一个插件，该插件将定期更新功能、错误修复和可下载语料库的更新。

通常的更新站点机制可以正常更新 - 当用户要求时。

问题是（与 MS Office 不同），默认情况下自动更新程序首选项是关闭的，我不想为我的用户更改该默认设置或指望他们更改它。

我可以写一些偶尔检查更新的东西吗？还是定期提示用户？什么是不好的形式，什么是可以接受的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T04:08:31.707

默认情况下，Eclipse 3.4 会自动检查插件更新。当有可用更新时，您将在右下角看到一个弹出窗口。

要配置自动更新，请转到窗口 > 首选项 > 安装更新 > 自动更新

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T04:26:23.590

绝对可靠的方法是确保您的更新具有吸引力。用户将完成剩下的工作

# version-control - 仅在 TFS 中从命令行回滚变更集？

> ID：207412
> 
> 赞同：0
> 
> 时间：2008-10-16T04:06:39.667
> 
> 标签：version-control, tfs

我正在为 TFS 构建一个自动升级实用程序。我想支持的功能之一是回滚最新的更改。我非常了解 Rollback Power Tool，但我的理解是，即使您通过命令行传入变更集，它仍然会为其他操作打开 GUI 界面。

我的想法是遍历我要回滚的分支的变更集历史，创建一个新的工作区，获取上一个之前的变更集的特定版本，然后将其合并到当前工作区，强制从以前的版本解决冲突. 这一切都以自动化方式在服务器上运行，并且工作区是动态创建和删除的。

还有其他建议可以更好地做到这一点吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-16T08:36:17.813

您可以使用 /noprompt 选项来阻止回滚 powertool 弹出 GUI，如果您足够勇敢，还可以使用 /automerge。

# iphone - iphone崩溃记者

> ID：207414
> 
> 赞同：10
> 
> 时间：2008-10-16T04:07:38.433
> 
> 标签：iphone, cocoa-touch

是否可以通过应用程序访问崩溃日志？last.fm 客户端今天向我展示了一个“我们发现了一个崩溃日志”，并带有发送它的选项，所以我认为这一定是可能的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-18T19:42:16.233

这里是我找到的解决方案的描述：[Crash Reporter for iPhone Applications](http://www.restoroot.com/Blog/2008/10/18/crash-reporter-for-iphone-applications/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T10:41:11.493

是的，尽管如果您没有 dSYM 文件和源代码，您可能不会从中获得太多收益：

> 与 iTunes 同步后，崩溃日志应位于以下文件夹之一中：
> 
> 在 Mac OS X 上，它们位于 ~/Library/Logs/CrashReporter/MobileDevice。
> 
> Windows XP：C:\Documents and Settings\Application Data\Apple 计算机\Logs\CrashReporter/
> 
> Windows Vista：C:\Users\AppData\Roaming\Apple 电脑\Logs\CrashReporter/MobileDevice/

（这来自我的应用程序的[帮助页面](http://www.yummyapp.com/2008/09/help.html)。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T13:29:16.583

@stephen 我认为发帖者是在询问一个 iPhone 应用程序在没有访问 Mac/PC 的情况下找到崩溃日志......</p>

我认为答案是——这在 2.0 上是可能的——但 Apple 限制了 2.1，现在阻止你的应用访问日志。:-(

# .net - 在 POS 打印机 C# 上进纸

> ID：207454
> 
> 赞同：6
> 
> 时间：2008-10-16T04:30:29.807
> 
> 标签：.net, printing, point-of-sale

我一直在尝试以编程方式将纸张送入 pos 打印机（Epson TM-U220D）。我遇到的问题是文档的最后一行没有打印出来，而是打印为下一个打印文档的第一行。我尝试了 POS for .NET 发送“ESC|flF”命令，还尝试使用串口发送原始 esc/pos 命令，但它不起作用。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T06:24:40.093

您迟早会需要完整的`ESC/POS Application Programming Guide`. 几年前，我确实从我的 EPSON 经销商那里得到了一份副本。与此同时，我通过谷歌找到了一个链接到`FAQ for ESC/POS`这里： [https ://web.archive.org/web/20111229102746/http://postechgroup.com/updata/support/drivers/EPSON/FAQ_ESCPOS.pdf](https://web.archive.org/web/20111229102746/http://postechgroup.com/updata/support/drivers/EPSON/FAQ_ESCPOS.pdf)

在您的情况下，`LF`控制命令打印打印缓冲区中的数据并根据当前行距输入一行。

`ASCII: LF`

`Hex: 0A`

`Decimal: 10`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T10:48:36.440

你在剪纸吗？如果您正在裁切纸张，则裁纸器的位置高于打印头。因此，您需要在发送 cut 命令之前输入多行。您应该能够使用 5 个换行符 (LF -> Chr(10)) 格式化字符串，发送它们，然后发送 cut 命令。

在 Epson EScPOS 文件中，有 GS V 命令可以在正确的位置进纸和裁切纸张。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T05:27:11.423

如果打印机在 LPT1 上，则向 DOS 发送壳，并提供给 CMD.EXE 或 COMMAND.COM，无论这个 BASIC 表达式的 C# 等价物是什么：

```
"ECHO " & Chr(12) & ">LPT1" 
```

要么将 Chr(12) 附加到输出文本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T06:55:31.153

正如 boost 所说，您需要将换页 / FF / ascii 12 连接到打印机端口。在 C 或 C++ 中，如果您将打印机作为文件打开，这将是

```
fprintf(printerfile,"%c",12); 
```

这些打印机有时会出现问题，即在写入回车之前，实际上并未处理/刷新输出缓冲区。您也可以手动刷新流。所以你会使用

```
fprintf(printerfile,"%c%c",12,13);
fflush(printerfile); 
```

当输出到串行打印机等设备时，一个容易犯的错误是通信和打印与您的主应用程序异步发生。因此，重要的是不要在完成打印后立即关闭打印机端口，因为这会导致最终输出缓冲区的丢失或损坏。

（对不起，这是 C 而不是 .NET，我是那些没有搬过来的 C++ 老前辈之一）

编辑：阅读我的帖子上的 alexandruls 评论，我错了。听起来好像您可能会收到不需要的换页，因为您设置的页面长度不正确，或者默认设置不正确。检查**ESC C n**爱普生命令组来克服这个问题。

# asp.net - 在没有代码隐藏文件的情况下部署 ASP.NET 应用程序如何工作？

> ID：207460
> 
> 赞同：2
> 
> 时间：2008-10-16T04:35:51.543
> 
> 标签：asp.net, deployment

当您将应用程序部署到没有包含代码 (VB/C#) 的所有文件的 IIS 时，事件和所有事情究竟是如何处理的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T04:42:09.877

VB 或 C# 编译器将 App_Code 中的 ASPX 页面和类编译为运行时二进制 DLL。对于 Web 项目，每次构建项目时都会创建 DLL；对于网站，DLL 在 c:\Windows 下的临时文件夹中创建。也许这就是让您感到困惑的地方——在您执行“构建”>“发布网站”步骤之前，您看不到网站的 DLL。

如果您在没有先发布网站的情况下部署网站，它会神秘地运行！这是因为 ASP.NET 进程隐式调用编译器为每个 ASPX 页创建相应的 DLL。

您可以通过在网站开发根目录上的开发人员框上创建一个虚拟目录来证明此行为。[然后使用http://localhost/yourappname/yourpagename.aspx](http://localhost/yourappname/yourpagename.aspx)启动一个页面。它运行！没有DLL！它们位于 C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files 下的项目文件夹中。

有关发布过程的更多信息：http: [//msdn.microsoft.com/en-us/library/1y1404zt (VS.80).aspx](http://msdn.microsoft.com/en-us/library/1y1404zt(VS.80).aspx)

无论哪种情况，一旦编译，ASP.NET 生命周期就会启动并在事件发生时引发事件。有关该过程的更多信息，请参阅这些链接：

[http://msdn.microsoft.com/en-us/library/ms227435.aspx](http://msdn.microsoft.com/en-us/library/ms227435.aspx)

[http://msdn.microsoft.com/en-us/library/ms178472.aspx](http://msdn.microsoft.com/en-us/library/ms178472.aspx)

# c# - 需要帮助为接口选择名称

> ID：207464
> 
> 赞同：5
> 
> 时间：2008-10-16T04:41:16.137
> 
> 标签：c#, .net, naming

我正在重构应用程序中的许多类以使用接口而不是基类。这是我到目前为止创建的接口：

*   ICarryable 由所有 Item 对象实现
*   由所有 Actor 对象实现的 IActable
*   IUseable 由一些 Item 子类实现
*   由一些 Item 子类实现的 IWieldable

您可以看到主要的基类仍然是 Item 和 Actor。它们有一个共同的界面，因为它们都位于地图上，因此它们具有 Location 属性。Map 不应该关心对象是 Actor 还是 Item，所以我想为它创建一个接口。这是界面的样子

```
public interface IUnnameable {
    event EventHandler<LocationChangedEventArgs> LocationChanged;
    Location Location { get; set; }
} 
```

这没问题，但我想不出这个接口叫什么。IMappable 似乎有点蹩脚。有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-16T04:44:40.263

听起来像一个 ILocateable。您可以发现和跟踪其位置的东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-16T04:45:20.947

*   ILocatable
*   伊戈
*   我在某处
*   某处

编辑：

*   名词

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T05:01:16.827

我只会使用[LOLCats](http://icanhascheezburger.com/)表示法。

`ICanHasLocation`

或许

`IHasLocation`

或荒谬的

`ImInYourProgramHavingALocation`

哦，顺便说一句 - 至少有一个 C# 的[Duck Typing](http://www.deftflux.net/blog/page/Duck-Typing-Project.aspx)库，这是一个非常酷的概念。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T07:48:49.737

IWhereYouAtable - 提升移动端

ITwentyable - 你的 20 是多少（10-20 的缩写 - CB 俚语）

说真的，虽然 ILocateable 很好。

# rest - 用于搜索的 RESTful URL 设计

> ID：207477
> 
> 赞同：460
> 
> 时间：2008-10-16T04:51:20.670
> 
> 标签：rest

我正在寻找一种将搜索表示为 RESTful URL 的合理方法。

设置：我有两个模型，汽车和车库，其中汽车可以在车库中。所以我的网址看起来像：

```
/car/xxxx
  xxx == car id
  returns car with given id

/garage/yyy
  yyy = garage id
  returns garage with given id 
```

Car 可以单独存在（因此是 /car），也可以存在于车库中。什么是表示给定车库中所有汽车的正确方法？就像是：

```
/garage/yyy/cars     ? 
```

车库 yyy 和 zzz 的汽车联盟怎么样？

表示搜索具有某些属性的汽车的正确方法是什么？说：给我看所有有 4 门的蓝色轿车：

```
/car/search?color=blue&type=sedan&doors=4 
```

还是应该是 /cars ？

在那里使用“搜索”似乎不合适 - 有什么更好的方式/术语？应该只是：

```
/cars/?color=blue&type=sedan&doors=4 
```

搜索参数应该是 PATHINFO 还是 QUERYSTRING 的一部分？

简而言之，我正在寻找有关跨模型 REST url 设计和搜索的指导。

[更新] 我喜欢贾斯汀的回答，但他没有涵盖多字段搜索案例：

```
/cars/color:blue/type:sedan/doors:4 
```

或类似的东西。我们如何从

```
/cars/color/blue 
```

到多场案例？

* * *

## 回答 #1

> 赞同：467
> 
> 时间：2009-07-04T07:13:55.980

对于搜索，请使用查询字符串。这是完全 RESTful 的：

```
/cars?color=blue&type=sedan&doors=4 
```

常规查询字符串的一个优点是它们是标准的并且被广泛理解，并且它们可以从 form-get 生成。

* * *

## 回答 #2

> 赞同：136
> 
> 时间：2013-03-15T13:10:17.863

**RESTful 漂亮**的URL 设计是关于显示基于结构的资源（类似目录的结构，日期：articles/2005/5/13，对象及其属性，..），斜杠`/`表示层次结构，使用`-id`代替。

#分层结构#我个人更喜欢：

```
/garage-id/cars/car-id
/cars/car-id   #for cars not in garages 
```

如果用户删除该`/car-id`部分，它会带来`cars`预览 - 直观。用户确切地知道他在树中的哪个位置，他在看什么。他从第一眼就知道，车库和汽车是相关的。`/car-id`也表示它属于一起，不像`/car/id`.

#Searching# 搜索 **查询是可以的**，只有你的偏好，应该考虑什么。加入搜索时会出现有趣的部分（见下文）。

```
/cars?color=blue;type=sedan   #most prefered by me
/cars;color-blue+doors-4+type-sedan   #looks good when using car-id
/cars?color=blue&doors=4&type=sedan   #I don't recommend using &* 
```

或者基本上任何不是如上所述的斜线。
公式：`/cars[?;]color[=-:]blue[,;+&]`, * 虽然我不会使用该`&`符号，因为乍一看它从文本中无法识别。

> ***你知道在 URI 中传递 JSON 对象是 RESTful 的吗？***

**选项列表**

```
/cars?color=black,blue,red;doors=3,5;type=sedan   #most prefered by me
/cars?color:black:blue:red;doors:3:5;type:sedan
/cars?color(black,blue,red);doors(3,5);type(sedan)   #does not look bad at all
/cars?color:(black,blue,red);doors:(3,5);type:sedan   #little difference 
```

##可能的功能？## **否定搜索字符串（！）**
搜索任何汽车，但**不是** *黑色*和*红色*：
`?color=!black,!red`
`color:(!black,!red)`

**联合搜索在 id** *1..20*或*101..103*或*999*但**不是***5*
的车库中 搜索具有*3 个*门的*红色*或*蓝色*或*黑色*汽车 然后您可以构建更复杂的搜索查询。（查看[CSS3 属性匹配](http://www.css3.info/preview/attribute-selectors/)以了解匹配子字符串的想法。例如搜索包含 "bar" 的用户。） *******`/garage[id=1-20,101-103,999,!5]/cars[color=red,blue,black;doors=3]`
`user*=bar`*******

 *****#结论#无论如何，这对你来说可能是最重要的部分，因为你可以随心所欲地做，只要记住**RESTful** URI 代表一种易于理解的结构，例如目录`/directory/file`，，，`/collection/node/item`日期`/articles/{year}/{month}/{day}`..和当你省略任何最后一段时，你会立即知道你得到了什么。

所以..，所有这些字符都**允许未编码**：

*   unreserved：`a-zA-Z0-9_.-~`
    *通常允许编码和不编码，两种用途是等效的。*
*   特殊的角色：`$-_.+!*'(),`
*   保留：`;/?:@=&`
    *可以未编码用于它们所代表的目的，否则必须对其进行编码。*
*   不安全：`<>"#%{}|^~[]``
    *为什么不安全以及为什么要编码：[RFC 1738 见 2.2](https://www.rfc-editor.org/rfc/rfc1738)*

另请参阅[RFC 1738#page-20](https://www.rfc-editor.org/rfc/rfc1738#page-20)了解更多字符类。

[RFC 3986 参见 2.2](https://www.rfc-editor.org/rfc/rfc3986)
尽管我之前说过，这里是分隔符的一个常见区别，这意味着有些*“是”*比其他的更重要。

*   通用分隔符：`:/?#[]@`
*   分界线：`!$&'()*+,;=`

**更多阅读：**
层次结构：[见 2.3](https://www.rfc-editor.org/rfc/rfc1738)，[见 1.2.3](https://www.rfc-editor.org/rfc/rfc3986)
[url 路径参数语法](http://doriantaylor.com/policy/http-url-path-parameter-syntax)
[CSS3 属性匹配](http://www.css3.info/preview/attribute-selectors/)
[**IBM：RESTful Web 服务 - 基础**](https://www.ibm.com/developerworks/webservices/library/ws-restful/)
注：RFC 1738 由 RFC 3986 更新

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2009-05-29T15:48:13.683

尽管在路径中包含参数有一些优势，但在 IMO 中，还有一些重要的因素。

*   并非搜索查询所需的所有字符都允许在 URL 中使用。大多数标点符号和 Unicode 字符都需要作为查询字符串参数进行 URL 编码。我正在努力解决同样的问题。我想在 URL 中使用 XPath，但并非所有 XPath 语法都与 URI 路径兼容。因此，对于简单的路径，在驾驶员车门 XML 文档中`/cars/doors/driver/lock/combination`定位 ' ' 元素是合适的。`combination`但`/car/doors[id='driver' and lock/combination='1234']`不是那么友好。

*   基于其中一个属性过滤资源和指定资源之间存在区别。

    例如，由于

    `/cars/colors`返回所有汽车的所有颜色列表（返回的资源是颜色对象的集合）

    `/cars/colors/red,blue,green`将返回红色、蓝色或绿色的颜色对象列表，而不是汽车集合。

    要返回汽车，路径将是

    `/cars?color=red,blue,green`或者`/cars/search?color=red,blue,green`

*   路径中的参数更难阅读，因为名称/值对没有与路径的其余部分隔离，这不是名称/值对。

最后一条评论。我更喜欢`/garages/yyy/cars`（总是复数）到`/garage/yyy/cars`（也许这是原始答案中的错字），因为它避免了改变单数和复数之间的路径。对于加了's'的词，改起来还不错，但是改成`/person/yyy/friends`to就`/people/yyy`显得麻烦了。

* * *

## 回答 #4

> 赞同：36
> 
> 时间：2009-05-29T16:03:41.923

要扩展彼得的答案-您可以使 Search 成为一流的资源：

```
POST    /searches          # create a new search
GET     /searches          # list all searches (admin)
GET     /searches/{id}     # show the results of a previously-run search
DELETE  /searches/{id}     # delete a search (admin) 
```

搜索资源将具有颜色、制造模型、车库状态等字段，并且可以以 XML、JSON 或任何其他格式指定。与 Car and Garage 资源一样，您可以根据身份验证限制对搜索的访问。经常运行相同搜索的用户可以将它们存储在他们的配置文件中，这样就不需要重新创建它们。URL 将足够短，在许多情况下可以通过电子邮件轻松交易。这些存储的搜索可以是自定义 RSS 提要的基础，等等。

当您将搜索视为资源时，使用搜索的可能性有很多。

[这个想法在这个Railscast](http://railscasts.com/episodes/111-advanced-search-form)中有更详细的解释。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2008-10-16T10:52:48.443

贾斯汀的答案可能是要走的路，尽管在某些应用程序中，将特定搜索本身视为资源可能是有意义的，例如，如果您想支持命名保存的搜索：

```
/search/{searchQuery} 
```

或者

```
/search/{savedSearchName} 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2014-10-10T14:23:06.557

我使用两种方法来实现搜索。

1) 最简单的情况，查询关联元素和导航。

```
 /cars?q.garage.id.eq=1 
```

这意味着，查询车库 ID 等于 1 的汽车。

也可以创建更复杂的搜索：

```
 /cars?q.garage.street.eq=FirstStreet&q.color.ne=red&offset=300&max=100 
```

FirstStreet 中所有车库中非红色的汽车（第 3 页，每页 100 个元素）。

2) 复杂查询被认为是创建并且可以恢复的常规资源。

```
 POST /searches  => Create
    GET  /searches/1  => Recover search
    GET  /searches/1?offset=300&max=100  => pagination in search 
```

用于搜索创建的 POST 正文如下：

```
 {  
       "$class":"test.Car",
       "$q":{
          "$eq" : { "color" : "red" },
          "garage" : {
             "$ne" : { "street" : "FirstStreet" }
          }
       }
    } 
```

它基于 Grails（标准 DSL）： http: [//grails.org/doc/2.4.3/ref/Domain%20Classes/createCriteria.html](http://grails.org/doc/2.4.3/ref/Domain%20Classes/createCriteria.html)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-07-20T18:52:20.833

这不是 REST。您不能在 API 中为资源定义 URI。资源导航必须是超文本驱动的。如果你想要漂亮的 URI 和大量的耦合，那很好，但不要称之为 REST，因为它直接违反了 RESTful 架构的约束。

请参阅 REST 的发明者的这篇[文章](http://roy.gbiv.com/untangled/2008/rest-apis-must-be-hypertext-driven)。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2016-01-12T21:49:04.787

此外，我还建议：

```
/cars/search/all{?color,model,year}
/cars/search/by-parameters{?color,model,year}
/cars/search/by-vendor{?vendor} 
```

在这里，`Search`被视为资源的子`Cars`资源。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2017-09-15T14:45:36.833

对于您的情况，这里有很多不错的选择。您仍然应该考虑使用 POST 正文。

查询字符串非常适合您的示例，但如果您有更复杂的内容，例如任意长的项目列表或布尔条件，您可能希望将帖子定义为客户端通过 POST 发送的文档。

这允许对搜索进行更灵活的描述，并避免服务器 URL 长度限制。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-10-06T06:53:25.610

RESTful 不建议在 URL 的 /cars/search 中使用动词不是 RESTful。过滤/搜索/分页 API 的正确方法是通过查询参数。但是，在某些情况下，您可能不得不打破常规。例如，如果您要跨多个资源进行搜索，则必须使用 /search?q=query

您可以通过[http://saipraveenblog.wordpress.com/2014/09/29/rest-api-best-practices/](http://saipraveenblog.wordpress.com/2014/09/29/rest-api-best-practices/)了解设计 RESTful API 的最佳实践

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-04T15:02:54.450

虽然我喜欢贾斯汀的回应，但我觉得它更准确地代表了过滤器而不是搜索。如果我想了解名称以 cam 开头的汽车怎么办？

在我看来，您可以将其构建到处理特定资源的方式中：
/cars/cam*

或者，您可以简单地将其添加到过滤器中：
/cars/doors/4/name/cam*/colors/red， blue,green

就我个人而言，我更喜欢后者，但我绝不是 REST 专家（大约 2 周前才第一次听说它......）

* * *

## 回答 #12

> 赞同：-4
> 
> 时间：2008-10-16T05:03:22.783

我的建议是：

```
/garages
  Returns list of garages (think JSON array here)
/garages/yyy
  Returns specific garage
/garage/yyy/cars
  Returns list of cars in garage
/garages/cars
  Returns list of all cars in all garages (may not be practical of course)
/cars
  Returns list of all cars
/cars/xxx
  Returns specific car
/cars/colors
  Returns lists of all posible colors for cars
/cars/colors/red,blue,green
  Returns list of cars of the specific colors (yes commas are allowed :) ) 
```

编辑：

```
/cars/colors/red,blue,green/doors/2
  Returns list of all red,blue, and green cars with 2 doors.
/cars/type/hatchback,coupe/colors/red,blue,green/
  Same idea as the above but a lil more intuitive.
/cars/colors/red,blue,green/doors/two-door,four-door
  All cars that are red, blue, green and have either two or four doors. 
```

希望这能给你这个想法。本质上，您的 Rest API 应该很容易被发现，并且应该使您能够浏览您的数据。使用 URL 而不是查询字符串的另一个优点是，您可以利用 Web 服务器上存在的本地缓存机制来处理 HTTP 流量。

这是一个描述 REST 中查询字符串弊端的页面的链接：http://web.archive.org/web/20070815111413/http://rest.blueoxen.net/cgi-bin/wiki.pl? [QueryStringsConsideredHarmful](http://web.archive.org/web/20070815111413/http://rest.blueoxen.net/cgi-bin/wiki.pl?QueryStringsConsideredHarmful)

我使用了谷歌的缓存，因为普通页面对我不起作用，这里的链接也是： [http ://rest.blueoxen.net/cgi-bin/wiki.pl?QueryStringsConsideredHarmful](http://rest.blueoxen.net/cgi-bin/wiki.pl?QueryStringsConsideredHarmful)

# matlab - 在另一个数据系列下方绘制一个数据系列

> ID：207485
> 
> 赞同：7
> 
> 时间：2008-10-16T05:00:07.017
> 
> 标签：matlab, plot

当您在 Matlab 中绘制内容时，最近绘制的数据系列将放置在已经存在的内容之上。例如：

```
figure; hold on
plot(sin(linspace(0,pi)),'linewidth',4,'color',[0 0 1])
plot(cos(linspace(0,pi)),'linewidth',4,'color',[1 0 0]) 
```

在这里，红线显示在蓝线的顶部（它们相交的地方）。有什么方法可以设置画线的“深度”，这样你就可以在已经存在的东西*下面*绘制东西？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-10-16T06:38:50.657

使用**uistack**命令。例如：

```
h1 = plot(1:10, 'b');
hold on;
h2 = plot(1:10, 'r'); 
```

将绘制两条线，红线绘制在蓝线的顶部。如果你这样做：

```
uistack(h1); 
```

蓝线将被带到前面。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-16T08:51:39.577

您还可以通过设置当前坐标区的子向量的顺序来完成此操作。如果您执行以下操作：

```
figure; hold on
h1 = plot(sin(linspace(0,pi)),'linewidth',4,'color',[0 0 1]);
h2 = plot(cos(linspace(0,pi)),'linewidth',4,'color',[1 0 0]);
h = get(gca, 'Children'); 
```

你会看到 h 是一个包含 h1 和 h2 的向量。图形堆叠顺序由句柄在 h 中的顺序表示。在此示例中，要反转堆叠顺序，您可以执行以下操作：

```
h = flipud(h);
set(gca, 'Children', h); 
```

# firefox - 更新的 Firefox 扩展 - 仍然显示“未找到更新”。

> ID：207490
> 
> 赞同：1
> 
> 时间：2008-10-16T05:01:43.300
> 
> 标签：firefox, firefox-addon, firefox-3

我正在开发一个新版本的 Firefox 扩展，但在发布它并增加 install.rdf 和 update.rdf 中的 em:version 后，当我单击“查找更新”时，Firefox 报告“未找到更新”。当我在调试的情况下运行它时，控制台中的输出实际上与我不实时更新时看到的相同。

它以带有所有参数的 RDFItemUpdater:checkForUpdates 开始，并以 Addon Update Ended 和状态返回：8。

我使用 McCoy 工具验证了扩展程序已签名，并且具有与旧的相同的 ID，等等。我不确定还有什么可以尝试的。任何意见，将不胜感激。这是与 Firefox 3 一起使用的（并且扩展被标记为与它兼容......这没有改变）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-07T18:44:29.810

我有一个类似的问题，并认为这是由于一个无效的 rdf 文件。你用这个工具检查你的解析了吗？[http://www.w3.org/RDF/Validator/](http://www.w3.org/RDF/Validator/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-26T21:24:08.040

这里有一些对我有帮助的好技巧：[https ://developer.mozilla.org/en/Extension_Versioning,_Update_and_Compatibility](https://developer.mozilla.org/en/Extension_Versioning,_Update_and_Compatibility)

但是，如果扩展被标记为“实验性”，则自动更新功能将不起作用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T05:32:52.850

确保您的 update.rdf 文件使用适当的 Content-Type 提供，即 text/rdf、text/xml 或 application/xml+rdf

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-19T14:48:57.013

如果您最近才更改 update.rdf，则它可能已被缓存。将其加载到浏览器中，然后 Shift-Refresh。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-16T07:06:22.387

有很多事情要搞砸，其中之一是从 AMO 安装扩展，并期望它在您更改 update.rdf 时更新：)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-09T17:10:26.440

我遇到了同样的问题。在我的 update.rdf 中，我的 minVersion 属性中有一个通配符：

> `minVersion="3.0.*"`

删除通配符修复了状态 8：

> `minVersion="3.0"`

更新现在有效（控制台显示状态 1）。这是使用 Firefox 3.0.18。

我的猜测是状态 8 意味着理解文件内容时存在问题（不一定是 RDF 解析问题）。如果您的 minVersion 没有通配符，则可能某处隐藏了无效字符。

# actionscript - var x:* 在 actionscript 中到底是什么意思？

> ID：207494
> 
> 赞同：5
> 
> 时间：2008-10-16T05:04:39.253
> 
> 标签：actionscript

搜索 'var:*' 有点棘手，因为大多数搜索引擎都找不到它。

与 var:Object 相比，我不清楚 var:* 的确切含义

我认为它可以让我在对象上设置任意属性，例如：

```
var x:*  = myObject;
x.nonExistantProperty = "123"; 
```

但这给了我一个错误：

```
Property nonExistantProperty not found on x 
```

* 究竟是什么意思？

**编辑：**我将原始 var:* 修复为正确的 var x:*。失去了我的互联网连接

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-17T00:57:04.073

扩展其他答案，声明带有星号类型的内容与不输入类型*完全相同*。

```
var x:* = {};
var y = {}; // equivalent 
```

但是，是否允许将不存在的属性分配给对象的问题与引用的类型无关，取决于对象是否是动态类的实例。

例如，由于 Object 是动态的，而 String 不是：

```
var o:Object = {};
o.foo = 1; // fine
var a:* = o;
a.bar = 1; // again, fine

var s:String = "";
s.foo = 1; // compile-time error
var b:* = s;
b.bar = 1; // run-time error 
```

请注意，无论您使用哪种引用，您都可以始终为对象分配新属性。同样，您永远不能为 String 分配新属性，但如果您使用类型化引用，那么编译器将捕获该引用，并且对于非类型化引用，编译器不知道是否`b`是动态的，因此错误发生在运行。

顺便说一句，可以在此处找到有关类型星号的文档参考：

> [http://livedocs.adobe.com/labs/air/1/aslr/specialTypes.html#](http://livedocs.adobe.com/labs/air/1/aslr/specialTypes.html#) *

（标记引擎拒绝将其链接起来，因为有星号。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T05:49:18.417

这是一种指定无类型变量的方法，因此您基本上可以为其分配任何类型。编码

```
var x:* = oneTypeObject; 
```

创建变量 x 然后将`oneTypeObject`变量分配给它。您可以为其分配完全不同的类型，如下所示：

```
var x:* = anotherTypeObject; 
```

但是，您仍然不能任意设置或访问属性；它们必须存在于基础类型中（要么 要么`oneTypeObject`）`anotherTypeObject`。

这两种类型可能具有相同名称的属性，这意味着您可以访问或设置该属性，`x`而无需关心底层类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T05:11:38.257

它是“无类型”类型。它只是意味着变量可以是任何类型。基本上和使用这个效果一样：

```
var x = myObject; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-16T05:12:41.343

这意味着没有指定类型，可以与任何类型一起使用。但是，您不能在其上设置随机属性。它的行为就像您设置的任何类型。确切的语法是：

```
var x:*; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-14T20:59:33.287

正如他们之前所说，它是无类型的，因此它可以保存任何类型的数据。但是，您不能在操作中这样对待它。例如，这是有效的代码：

```
var untyped:* = functionThatReturnsSomeValue(); 
```

但如果你再往前走一步，你必须小心，否则你可能会被咬：

```
var name:String = untyped.name; 
```

现在，如果该函数返回的对象恰好是一个具有 id 为“name”的字段的对象，那么您就清楚了。但是，除非您确定确实如此，否则最好使用类型化对象。这样，如果你做了一些可能在运行时抛出错误的事情，编译器会提醒你：

```
(elsewhere)
public class TypedObject()
{
    public var name:String = "";
}

(and the code at hand)
var typed:TypedObject = functionThatReturnsTypedObject();
var name:String = typed.name; 
```

# c++ - C++ 二叉搜索树通过递归插入

> ID：207496
> 
> 赞同：0
> 
> 时间：2008-10-16T05:05:14.060
> 
> 标签：c++, insert, binary-tree

所以我的代码如下。我没有收到任何错误，它将所有内容都放在节点中就好了。但是根据我的调试语句，每次插入任何东西时，它都会找到根。我不确定这是否正确。但是根据作业的输出文件，当涉及到树的高度、遍历时，我的答案是不同的，而且我的叶子计数功能仍然存在问题。另一个故事。

根据调试语句，看起来一切都在他们应该的地方进行。但我想我可能需要新鲜的眼睛。我根本看不到我的遍历会如何改变，因为这实际上只是我在哪里处理应该影响中序、前序和后序的节点的问题。

```
template <class T>
void BT<T>::insert(const T& item)
 {
    Node<T>* newNode;
    newNode = new Node<T>(item);
    insert(root, newNode);
 }

template <class T>
void BT<T>::insert(struct Node<T> *&root, struct Node<T> *newNode)
 {
    if (root == NULL)
       {
          cout << "Root Found" << newNode->data << endl;
          root = newNode;
       }
    else
        {
           if (newNode->data < root->data)
              {
              insert(root->left, newNode);
              cout << "Inserting Left" << newNode-> data << endl;
              }
           else
               {
               insert(root->right, newNode);
               cout << "Inserting Right" << newNode->data << endl;
               }
        }
 } 
```

我的高度函数如下，以防我的插入实际上很好。

```
template <class T>
int BT<T>::height() const
{
   return height(root);
}

  template <class T>
  int BT<T>::height(Node<T>* root) const
   {
   if (root == NULL)
      return 0;
   else 
      {
      if (height(root->right) > height(root->left))
         return 1 + height(root-> right);
      return 1 + height(root->left);
      }
   } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-16T05:10:58.820

您需要更改调试语句的措辞

真的应该读（不是根节点）

```
 cout << "Leaf Node Found" << newNode->data << endl; 
```

只有当它第一次被调用时它才是根节点，之后任何使用 node->left 或 node->right 的调用都会使它成为一个中间节点。

要写 height() 我会这样做：

```
template <class T>
int BT<T>::height(Node<T>* root) const
{
    if (root == NULL) {return 0;}

    return 1 + max(height(root->left),height(root->right));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T06:18:20.057

您需要从您的根初始化为 null 开始。此外，您正在传递 *&node in; 它应该是*节点。否则，您将传递一个指向地址的指针（或引用，我不确定在这种情况下哪个，但两者都不会正确）。您应该传递指向 Node in 的指针，而不是引用。

```
template <class T>
void BT<T>::BT() 
{ root = 0;}

template <class T>
void BT<T>::insert(const T& item)
 {
    Node<T>* newNode;
    newNode = new Node<T>(item);
    insert(root, newNode);
 }

template <class T>
void BT<T>::insert(struct Node<T> *root, struct Node<T> *newNode)
{
 /*stuff*/
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T06:51:00.537

@Vlion：
它应该是指向左/右/根指针的指针（即双指针），因此发布的代码是正确的，尽管有些不清楚。

@Doug：
考虑更改您的插入功能：

```
template <class T>
void BT<T>::insert(struct Node<T>** root, struct Node<T>* newNode)
 {
    if (*root == NULL)
       {
          cout << "Root Found" << newNode->data << endl;
          *root = newNode;
       } 
```

它清楚地表明您将更改作为第一个参数传递的指针（或者更确切地说，其地址将作为第一个参数传递的指针）的意图。这将有助于避免诸如刚刚发生的混淆。

对此 insert() 的调用，例如：

```
insert(&root, newNode); 
```

还将反映您更改指针值的意图。不过，这是一个风格问题，所以如果你不想改变，我无法争辩。

* * *

至于检查这棵树是否“正确”，为什么不把它画出来自己看看呢？类似于以下内容：

```
template class<T>
void printTree(struct Node<T>* node, int level=0)
{
    if (!node) {
        for (int i=0; i<level; ++i)
            cout << "  ";
        cout << "NULL" << endl;

        return;
    }

    printTree(node->left, level+1);

    for (int i=0; i<level; ++i)
        cout << "  ";
    cout << node->data << endl;

    printTree(node->right, level+1);
} 
```

（未经测试的代码）

# c# - 如何为 SharePoint 中的单个 Web 部件设置完全信任？

> ID：207497
> 
> 赞同：0
> 
> 时间：2008-10-16T05:06:44.227
> 
> 标签：c#, sharepoint, web-parts, full-trust

我希望为单个 Web 部件设置完全信任，这可能吗？manifest.xml 也许？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T07:32:58.567

据我记得manifest.xml 是正确的，并且您指定了CodeAccessSecurity。

这篇文章有关于它的详细描述 [http://www.dotnetmafia.com/blogs/dotnettipoftheday/archive/2007/07/05/how-to-configure-code-access-security-for-a-web-part。 aspx](http://www.dotnetmafia.com/blogs/dotnettipoftheday/archive/2007/07/05/how-to-configure-code-access-security-for-a-web-part.aspx)

当您部署解决方案时，您可以使用 -allowCasPolicies 标志来部署它

我不确定我是否想在 GAC 中添加一个 webpart

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T05:18:20.677

您是否尝试在 GAC 中注册程序集？这是让任何程序集完全信任您的机器的首选方法：

```
gacutil.exe \i C:\Path\To\Dll.dll 
```

希望有帮助。如果我误解了你的问题，请告诉我。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T07:04:31.947

您可以使用以下方法将 CAB 打包的 Web 部件安装到 GAC

```
STSADM -o addwppack -filename yourwebpart.cab -globalinstall 
```

如果您使用 WSP 包，您需要在 manifext.xml 文件中设置属性

```
<Assembly Location="yourassembly.dll" DeploymentTarget="GlobalAssemblyCache"> 
```

并打电话

```
STSADM -o AddSolution -filename yourwebpart.wsp

STSADM -o DeploySolution -name yourwebpart.wsp -allcontenturls -immediate -force -allowGacDeployment 
```

当然，如果可以的话，您不应该真正安装到 GAC，设置 CAS 是首选方式。

# java - 有没有办法告诉 Maven 在哪里放置工件？

> ID：207498
> 
> 赞同：6
> 
> 时间：2008-10-16T05:07:39.840
> 
> 标签：java, maven-2, cygwin

我在 m2eclipse 插件、windows 命令行和我的 cygwin 命令行中同时运行 maven。

cygwin 的 bash shell 将工件转储到 cygwin /home/me/.m2 目录中

但 m2eclipse & windows shell（在 vista 上）使用 /Users/me/Documents/.m2

是否可以告诉 mvn 命令使用一个中央 .m2 目录？

谢谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-16T05:59:59.377

当然，有几种方法。最典型的是在您的 settings.xml 文件中指定：

*   [http://maven.apache.org/settings.html](http://maven.apache.org/settings.html)

> ```
> <settings xmlns="http://maven.apache.org/POM/4.0.0"
>   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
>   xsi:schemaLocation="http://maven.apache.org/POM/4.0.0
>                       http://maven.apache.org/xsd/settings-1.0.0.xsd">
>   <localRepository>/my/secret/repository</localRepository>
> </settings> 
> ```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-16T06:11:06.423

对于 Cygwin，创建一个名为 ~/.mavenrc 的文件并将以下文本放入其中：

```
MAVEN_OPTS="-Dmaven.repo.local=c:\documents and settings\user\.m2\repository"
export MAVEN_OPTS 
```

或者，您可以在 /etc/.mavenrc 下创建文件

另一种选择是在 Windows 下的 .m2 和 cygwin 配置文件之间创建[NTFS 连接。](http://technet.microsoft.com/en-us/sysinternals/bb896768.aspx)

# c# - DataGridView 锁定在继承的 UserControl 上

> ID：207504
> 
> 赞同：13
> 
> 时间：2008-10-16T05:11:22.253
> 
> 标签：c#, .net, winforms, inheritance

我有一个用户控件，上面有一些预定义的控件（组框、按钮、数据网格视图），这些控件被标记为受保护，组件变量也被标记为受保护。

然后我想从这个基本 UserControl 继承到另一个 UserControl，但是 DataGridView 总是锁定在设计器中。

我怀疑这可能与实现 ISupportInitilize 的 DataGridView 有关。

```
public class BaseGridDetail : UserControl 
```

定义了一个 DataGridView 控件（等）。

```
public class InheritedDetail : BaseGridDetail 
```

DataGridView 控件被锁定

有没有人知道如何在继承后使此控件在设计器中可用？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-16T05:40:51.927

从外观上看，DataListView（和其他一些控件）不支持视觉继承。[这里记录了](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=116457)一个连接问题，看起来不太乐观。

其他表单控件也记录了类似的问题，例如[flowlayoutpanel](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=119442)。

我无法找到强制视觉继承的方法。

[这是关于connect](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=110787)的官方回答：“对于这个特定版本，DataGridView 并非设计用于视觉继承。我们在计划未来版本时会牢记您的建议”这是 2006 年 5 月 26 日。

更新：发现[这篇博文可能有答案](http://dotnetengineer.wordpress.com/2008/06/27/visual-inheritance-using-datagridview/)

编辑：我无法验证博客文章的声明。看起来[可能是这个问题的最新消息](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=284335)

看起来您仍然可以在运行时操作 DataListView，因此您可以设置视觉属性（和其他设置）。这不是一个很好的妥协。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2010-09-06T06:08:35.263

[1] 创建您的自定义用户控件

[2] 使您的自定义 userControl 使用以下 Inherited DataGridView：

```
[Designer(typeof System.Windows.Forms.Design.ControlDesigner))]
public class InheritedDataGridView : DataGridView { } 
```

[3] 从您的自定义 UserControl 和 viola 继承！

[4] 哦，别忘了添加“System.Design”dll

享受。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-09-16T15:40:31.967

将数据网格添加到面板控件，并将面板和数据网格的修饰符设置为受保护。这将您继承的所有表单设计时访问网格的属性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-16T05:17:12.350

我留下了答案，但重新阅读了您的问题并决定将其删除。

您尝试在继承的控件中修改的 DataGridView 是什么？是柱子？我已经能够通过在我的基本 UserControl 中设置一个受保护的方法并将网格的列集合传递给它来做到这一点，如下所示：

```
// in base UserControl
public BaseGridDetail()
{
    InitializeComponent();

    InitGridColumns(dataGridView1.Columns);
}

protected virtual void InitGridColumns(DataGridViewColumnCollection columns)
{
    columns.Clear();
} 
```

现在您的派生控件可以简单地覆盖该方法，如下所示：

```
// in InheritedDetail
protected override void InitGridColumns(DataGridViewColumnCollection columns)
{
    base.InitGridColumns(columns);
    // add my own custom columns
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2016-07-12T00:55:49.903

将属性更改为定义的 [private] 到 [protected] 在 xx.designer.cs 中定义，它最初是机器生成的代码。

例如

```
 private System.Windows.Forms.Button btnSave; 
```

到

```
 protected System.Windows.Forms.Button btnSave; 
```

并重建它。

然后您可以更改继承控件的属性。

# emacs - 在 Emacs 中关闭当前缓冲区的按键顺序是什么？

> ID：207510
> 
> 赞同：78
> 
> 时间：2008-10-16T05:15:30.527
> 
> 标签：emacs

如果我单击 File -> Close，它会像我想要的那样关闭缓冲区，但不会列出键映射。什么是键映射？

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2012-08-23T18:48:57.400

您可以使用 `C-x k`终止当前缓冲区。请参阅[Emacs 手册](http://www.gnu.org/software/emacs/manual/html_node/emacs/Kill-Buffer.html)。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2008-10-16T06:44:38.303

BKB已经给出了正确答案。只想添加`C-h b`列出适用于当前缓冲区的键绑定

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2013-07-30T01:17:37.773

`Help`好吧，您可以使用命令 ( `C-h`)查看任何功能的快捷方式。

按，然后像在模式`C-h``w`中一样键入命令名称。`M-x`

* * *

例如（在您的情况下）：

1.  按`C-h``w`
2.  键入命令的名称：（`kill-buffer`您也可以使用制表符/空格来自动完成 :)）
3.  按`RET`

* * *

希望有帮助:)

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2014-10-27T17:11:23.277

问题询问如何杀死*当前*缓冲区。使用`M-x kill-this-buffer`. 在我的 Emacs 上，它映射到`s-k`. 击键次数越少越好！

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2020-09-19T19:16:07.050

1.  `C-x k`杀死当前缓冲区。
2.  `C-x 0`关闭当前窗口。
3.  `C-x 1`关闭所有其他窗口。

# algorithm - 员工排班算法

> ID：207512
> 
> 赞同：9
> 
> 时间：2008-10-16T05:17:35.377
> 
> 标签：algorithm, scheduling, rostering

我们正在着手对员工排班系统进行一些研发，我知道有一些建议的算法，例如模因算法等，但我在网上找不到任何其他信息。

有谁知道任何可以更好地解释这些算法的研究期刊或伪代码？

谢谢，德文

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-16T05:39:23.833

这是一个有用的文件：

[护士排班的模因算法 (pdf)](http://www.cs.nott.ac.uk/~exo/docs/publications/ISCIS05_MAforNR.pdf)

它包含一点理论和伪代码。

调度问题是 NP 难题，通常使用遗传算法 (GA) 来解决。[你可以从维基百科文章](http://en.wikipedia.org/wiki/Genetic_algorithm)
开始学习 GA

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-16T07:03:15.490

您可能还想查看一种称为“模拟退火”的技术。与遗传算法一样，它使用评估函数来确定候选解决方案的质量——但候选解决方案的生成往往更简单。在某些情况下，每种类型的算法都能提供更好的结果——从谷歌的一项简短调查来看，感觉基因具有优势，但退火会更快地实施。

这是一份比较论文（针对不同的域，而不是调度）： [http ://www.ee.utulsa.edu/~tmanikas/Pubs/gasa-TR-96-101.pdf](http://www.ee.utulsa.edu/~tmanikas/Pubs/gasa-TR-96-101.pdf)

我们在大型调度应用程序中使用了模拟退火，并且效果很好。

老实说，如果员工数量少于 40 人，我会建议提供花名册的可视化表示并让用户最终确定时间表。也许您会使用一种算法来生成一个候选时间表，然后让用户使用它。您仍然可以使用评估功能来检查用户的工作并就他们的解决方案的好坏提供反馈。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-16T06:17:35.770

在设置花名册时间表时需要考虑很多很多问题，所以 aku 关于遗传算法的提示是最好的。

您需要一个良好的评估函数来确定此类算法的花名册质量，您可以而且应该考虑以下事项（但不限于）：

*   你用这个名册解决了工作量问题吗？（即，您是否始终有足够的人在工作？）
*   如果没有，你能承受后果吗？（对于医院，您可能需要将午餐推迟 15 分钟，以便有足够的人吃，或者只是及时将其稍微拖出来）
*   考虑到每个人的轮班*稳定性*，他们的休息日，他们是否有规律地在周末休息
*   名册合法吗？考虑到当地法规之类的事情，这些规定例如一个班次和另一个班次之间必须经过多少时间（停机时间），每个人在给定的时间间隔内可以工作多少时间（天、周、月）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-22T12:41:18.563

不久前，我阅读了[这些](http://www.cmis.csiro.au/or/rostering/railtex.htm)人的排班算法论文。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-26T00:26:54.343

或使用 [OR](http://www.scienceofbetter.org/what/index.htm) ;)

# javascript - 有没有办法在浏览器中“热交换”JavaScript 代码？

> ID：207513
> 
> 赞同：17
> 
> 时间：2008-10-16T05:17:39.167
> 
> 标签：javascript, debugging, frameworks

是否有任何工具可以让您在执行网页时“热交换”JavaScript 内容？

我正在寻找类似于 HotSpot 为 Java 所做的事情，一种无需重新加载整个页面即可“热部署”新 JS 代码的方法。

那里有类似的东西吗？

**澄清以防人们不理解“热交换”，如*lock*所示：**

“热交换”是指允许我更改页面本身及其 .js 文件中包含的部分代码。

然后这个框架会检测到变化——无论是自动还是通过我的一些指示——并动态地重新加载代码，避免新的服务器端发布（重新加载）。

这种方法将简化调试和错误修复，因为您不需要重新加载页面并从头开始重新开始交互。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-16T08:25:45.450

有趣的想法:)

我写了以下书签：

```
function reload(){var scripts=document.getElementsByTagName("script");var head=document.getElementsByTagName("head")[0];var newScripts=[];var removeScripts=[];for(var i=0;i<scripts.length;i++){var parent=scripts[i].parentNode;if(parent==head&&scripts[i].src){var newScript={};newScript.src=scripts[i].src;newScript.innerHTML=scripts[i].innerHTML;newScripts.push(newScript);removeScripts.push(scripts[i]);}}for(var i=0;i<removeScripts.length;i++){head.removeChild(removeScripts[i]);}for(var i=0;i<newScripts.length;i++){var script=document.createElement("script");script.src=newScripts[i].src;script.type="text/javascript";script.innerHTML=newScripts[i].innerHTML;head.appendChild(script);}} 
```

将其添加到新书签的位置，它将重新加载 <head> 中引用的所有 javascript。不确定这在实践中效果如何，但值得一试:) 我想你在编写脚本的方式上必须非常小心，以免将内容多次添加到页面正文中，等等。也许对'reload="true"' 属性的支持可能很有用，这样你就可以只将你的库标记为可重新加载。

完整来源：

```
function reload() {
    var scripts = document.getElementsByTagName("script");
    var head = document.getElementsByTagName("head")[0];
    var newScripts = [];
    var removeScripts = [];
    for(var i=0; i < scripts.length; i++) {
        var parent = scripts[i].parentNode;
        if(parent == head && scripts[i].src) {
            var newScript = {};
            newScript.src = scripts[i].src;
            newScript.innerHTML = scripts[i].innerHTML;
            newScripts.push(newScript);
            removeScripts.push(scripts[i]);
        }
    }

    for(var i=0; i < removeScripts.length; i++) {
        head.removeChild(removeScripts[i]);
    }

    for(var i=0; i < newScripts.length; i++) {
        var script = document.createElement("script");
        script.src = newScripts[i].src;
        script.type = "text/javascript";
        script.innerHTML = newScripts[i].innerHTML;
        head.appendChild(script);
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-16T10:51:32.177

因为我有一个类似的问题要解决，所以我写了一个小的 js lib 来热交换 javascript、css 和图像文件。它当然是 github 上的开源：[hotswap.js](https://github.com/geo-at-github/hotswap.js)

希望能帮助到你。

**更新**：我在这里附上了完整的库源。要使用它，只需将内容复制到文件中（例如：hotswap.js）并将脚本标签插入您的网站，如下所示：

```
<script src="hotswap.js"></script> 
```

接口：

```
// refresh .js files
hotswap.refreshAllJs(arrExcludedFiles);
hotswap.refreshJs(arrIncludedFiles);

// refresh .css files
hotswap.refreshAllCss(arrExcludedFiles);
hotswap.refreshCss(arrIncludedFiles);

// refresh images
hotswap.refreshAllImg(arrExcludedFiles);
hotswap.refreshImg(arrIncludedFiles);

// show a gui (this is optional and not required for hotswap to work) (Click on the "H").
hotswap.createGui();

// Examples:
// refresh all .js files
hotswap.refreshAllJs();

// refresh main.css only
hotswap.refreshCss( ["main.js"] );

// refresh all images (img tags) except "dont-refreh-me.png".
hotswap.refreshAllImg( ["dont-refreh-me.png"] ); 
```

完整源代码（v. 0.2.0）：

我不得不删除所有评论以使其低于 30000 字符的答案限制。我知道内联 html + css 很难看，但我想将其保留在单个 .js 文件中。

```
(function() {
    var root = this;
    var previousHotswap = root.hotswap;
    var hotswap = function()
    {
        if (!(this instanceof hotswap))
        {
            return new hotswap();
        }
        else
        {
            return this;
        }
    };
    root.hotswap = hotswap();
    hotswap.prototype.VERSION = '0.2.0';
    hotswap.prototype.RND_PARAM_NAME = 'hs982345jkasg89zqnsl';
    hotswap.prototype.FILE_REMOVAL_DELAY = 400;
    hotswap.prototype.CSS_HTML_PREFIX = 'hs982345jkasg89zqnsl';
    hotswap.prototype._prefix = false;
    hotswap.prototype._prefixCache = [];
    hotswap.prototype._guiCache = {};
    hotswap.prototype._guiGuiRefreshInterval = null;
    hotswap.prototype._guiHtml = '' +
        '<style type="text/css">'+
        '    #PREFIX'+
        '    {'+
        '        display: block;'+
        '        position: fixed;'+
        '        top: 20%;/*distance from top*/'+
        '        right: 0;'+
        '        z-index: 99999;'+
        '        width: 20em;'+
        '        height: auto;'+
        '        color: black;'+
        '        background-color: #666666;'+
        '        font-family: Verdana, sans-serif;'+
        '        font-size: 0.8em;'+
        '        -webkit-box-shadow: 0 0px 0.3em 0.1em #999999;'+
        '        -moz-box-shadow: 0 0px 0.3em 0.1em #999999;'+
        '        box-shadow: 0 0px 0.3em 0.1em #999999;'+
        '    }'+
        '    #PREFIX.mini'+
        '    {'+
        '        width: 2.9em;'+
        '        height: 2.9em;'+
        '        overflow:hidden;'+
        '    }'+
        '    #PREFIX.mini .PREFIX-header input, #PREFIX.mini .PREFIX-list, #PREFIX.mini .PREFIX-footer'+
        '    {'+
        '        display:none;'+
        '    }'+
        '        #PREFIX.mini .PREFIX-header div'+
        '    {'+
        '        display: block;'+
        '        width: 100%;'+
        '        height: 100%;'+
        '    }'+
        '    #PREFIX input'+
        '    {'+
        '        font-size: 1.0em;'+
        '        border: 0.1em solid #999999;'+
        '        border-radius: 0.2em;'+
        '        padding: 0.2em 0.1em;'+
        '        }'+
        '    #PREFIX .PREFIX-header'+
        '    {'+
        '        height: 2.4em;'+
        '        overflow:hidden;'+
        '        padding: 0.4em;'+
        '        color: white;'+
        '        background-color: black;'+
        '        }'+
        '    #PREFIX .PREFIX-header input'+
        '    {'+
        '        width: 83.5%;'+
        '        height: 1.6em;'+
        '    }'+
        '    #PREFIX .PREFIX-header div'+
        '    {'+
        '        position: absolute;'+
        '        top:0;'+
        '        right:0;'+
        '        width: 14.5%;'+
        '        height: 1.6em;'+
        '        line-height: 1.4em;'+
        '        text-align: center;'+
        '        font-size: 2em;'+
        '        font-weight: bold;'+
        '        cursor: pointer;'+
        '    }'+
        '    #PREFIX .PREFIX-header div:hover'+
        '    {'+
        '        background-color: #444444;'+
        '    }'+
        '    #PREFIX .PREFIX-list'+
        '    {'+
        '        width: 100%;'+
        '        height: 22em;'+
        '        overflow: auto;'+
        '    }'+
        '    #PREFIX ul'+
        '    {'+
        '        list-style-type: none;'+
        '        list-style-position: inside;'+
        '        padding: 0;'+
        '        margin: 0.5em 0.5em 1.2em 0.5em;'+
        '    }'+
        '    #PREFIX ul li'+
        '    {'+
        '        margin: 0.3em;'+
        '        padding: 0.5em 0.5em;'+
        '        color: white;'+
        '        background-color: #717171;'+
        '        font-size: 0.9em;'+
        '        line-height: 1.5em;'+
        '        cursor: pointer;'+
        '    }'+
        '    #PREFIX ul li:hover'+
        '    {'+
        '        background-color: #797979;'+
        '    }'+
        '    #PREFIX ul li.template'+
        '    {'+
        '        display: none;'+
        '    }'+
        '    #PREFIX ul li.active'+
        '    {'+
        '        background-color: black;'+
        '    }'+
        '    #PREFIX ul li.PREFIX-headline'+
        '    {'+
        '        color: white;'+
        '        background-color: transparent;'+
        '        text-align: center;'+
        '        font-weight: bold;'+
        '        cursor: default;'+
        '    }'+
        '    #PREFIX .PREFIX-footer'+
        '    {'+
        '        padding: 0;'+
        '        margin:0;'+
        '        background-color: #444444;'+
        '    }'+
        '    #PREFIX .PREFIX-footer ul'+
        '    {'+
        '        margin: 0;'+
        '        padding: 0.5em;'+
        '    }'+
        '    #PREFIX .PREFIX-footer ul li'+
        '    {'+
        '        color: white;'+
        '        background-color: black;'+
        '        font-size: 1.0em;'+
        '        border-radius: 0.5em;'+
        '        text-align: center;'+
        '        height: 2.2em;'+
        '        line-height: 2.2em;'+
        '    }'+
        '    #PREFIX .PREFIX-footer ul li input.PREFIX-seconds'+
        '    {'+
        '        text-align: center;'+
        '        width: 2em;'+
        '    }'+
        '    #PREFIX .PREFIX-footer ul li:hover'+
        '    {'+
        '        background-color: #222222;'+
        '        }'+
        '    #PREFIX .PREFIX-footer ul li.inactive'+
        '    {'+
        '        background-color: #666666;'+
        '        cursor: default;'+
        '    }'+
        '    </style>'+
        '    <div id="PREFIX" class="mini">'+
        '        <div class="PREFIX-header">'+
        '            <input id="PREFIX-prefix" placeholder="prefix" type="text" name="" />'+
        '            <div id="PREFIX-toggle">H</div>'+
        '        </div>'+
        '        <div class="PREFIX-list">'+
        '            <ul id="PREFIX-css">'+
        '                <li class="PREFIX-headline">CSS</li>'+
        '                <li class="template"></li>'+
        '            </ul>'+
        '            <ul id="PREFIX-js">'+
        '                <li class="PREFIX-headline">JS</li>'+
        '                <li class="template"></li>'+
        '            </ul>'+
        '            <ul id="PREFIX-img">'+
        '                <li class="PREFIX-headline">IMG</li>'+
        '                <li class="template"></li>'+
        '            </ul>'+
        '        </div>'+
        '        <div class="PREFIX-footer">'+
        '            <ul>'+
        '                <li id="PREFIX-submit-selected">refresh selected</li>'+
        '                <li id="PREFIX-submit-start">refresh every <input  class="PREFIX-seconds" type="text" value="1" /> sec.</li>'+
        '                <li id="PREFIX-submit-stop" class="inactive">stop refreshing</li>'+
        '                <li id="PREFIX-submit-refresh-list">refresh list</li>'+
        '            </ul>'+
        '        </div>'+
        '    </div>';
    var
        xGetElementById       = function(sId){ return document.getElementById(sId) },
        xGetElementsByTagName = function(sTags){ return document.getElementsByTagName(sTags) },
        xAppendChild          = function(parent, child){ return parent.appendChild(child) },
        xCloneNode            = function(node){ return document.cloneNode(node) },
        xCreateElement        = function(sTag){ return document.createElement(sTag) },
        xCloneNode            = function(ele, deep){ return ele.cloneNode(deep) },
        xRemove = function(ele)
        {
            if( typeof ele.parentNode != "undefined" && ele.parentNode )
            {
                ele.parentNode.removeChild( ele );
            }
        },
        xAddEventListener = function(ele, sEvent, fn, bCaptureOrBubble)
        {
            if( xIsEmpty(bCaptureOrBubble) )
            {
                bCaptureOrBubble = false;
            }
            if (ele.addEventListener)
            {
                ele.addEventListener(sEvent, fn, bCaptureOrBubble);
                return true;
            }
            else if (ele.attachEvent)
            {
                return ele.attachEvent('on' + sEvent, fn);
            }
            else
            {
                ele['on' + sEvent] = fn;
            }
        },
        xStopPropagation = function(evt)
        {
            if (evt && evt.stopPropogation)
            {
                evt.stopPropogation();
            }
            else if (window.event && window.event.cancelBubble)
            {
                window.event.cancelBubble = true;
            }
        },
        xPreventDefault = function(evt)
        {
            if (evt && evt.preventDefault)
            {
                evt.preventDefault();
            }
            else if (window.event && window.event.returnValue)
            {
                window.eventReturnValue = false;
            }
        },
        xContains = function(sHaystack, sNeedle)
        {
            return sHaystack.indexOf(sNeedle) >= 0
        },
        xStartsWith = function(sHaystack, sNeedle)
        {
            return sHaystack.indexOf(sNeedle) === 0
        },
        xReplace = function(sHaystack, sNeedle, sReplacement)
        {
            if( xIsEmpty(sReplacement) )
            {
                sReplacement = "";
            }
            return sHaystack.split(sNeedle).join(sReplacement);
        },
        xGetAttribute = function(ele, sAttr)
        {
            var result = (ele.getAttribute && ele.getAttribute(sAttr)) || null;
            if( !result ) {
                result = ele[sAttr];
            }
            if( !result ) {
                var attrs = ele.attributes;
                var length = attrs.length;
                for(var i = 0; i < length; i++)
                    if(attrs[i].nodeName === sAttr)
                        result = attrs[i].nodeValue;
            }
            return result;
        },
        xSetAttribute = function(ele, sAttr, value)
        {
            if(ele.setAttribute)
            {
                ele.setAttribute(sAttr, value)
            }
            else
            {
                ele[sAttr] = value;
            }
        },
        xGetParent = function(ele)
        {
            return ele.parentNode || ele.parentElement;
        },
        xInsertAfter = function( refEle, newEle )
        {
            return xGetParent(refEle).insertBefore(newEle, refEle.nextSibling);
        },
        xBind = function(func, context)
        {
            if (Function.prototype.bind && func.bind === Function.prototype.bind)
            {
                return func.bind(context);
            }
            else
            {
                return function() {
                    if( arguments.length > 2 )
                    {
                        return func.apply(context, arguments.slice(2));
                    }
                    else
                    {
                        return func.apply(context);
                    }
                };
            }
        },
        xIsEmpty = function(value)
        {
            var ret = true;
            if( value instanceof Object )
            {
                for(var i in value){ if(value.hasOwnProperty(i)){return false}}
                return true;
            }
            ret = typeof value === "undefined" || value === undefined || value === null || value === "";
            return ret;
        },
        xAddClass = function(ele, sClass)
        {
            var clazz = xGetAttribute( ele, "class" );
            if( !xHasClass(ele, sClass) )
            {
                xSetAttribute( ele, "class", clazz + " " + sClass );
            }
        },
        xRemoveClass = function(ele, sClass)
        {
            var clazz = xGetAttribute( ele, "class" );
            if( xHasClass(ele, sClass) )
            {
                xSetAttribute( ele, "class", xReplace( clazz, sClass, "" ) );
            }
        },
        xHasClass = function(ele, sClass)
        {
            var clazz = xGetAttribute( ele, "class" );
            return !xIsEmpty(clazz) && xContains( clazz, sClass );
        };
    hotswap.prototype._recreate = function( type, xcludedFiles, xcludeComparator, nDeleteDelay, bForceRecreation )
    {
        if( typeof nDeleteDelay == "undefined")
        {
            nDeleteDelay = 0;
        }

        if( typeof bForceRecreation == "undefined")
        {
            bForceRecreation = false;
        }

        var tags = this._getFilesByType(type, xcludedFiles, xcludeComparator);
        var newTags = [];
        var removeTags = [];
        var i, src, detected, node, srcAttributeName;
        for(i=0; i<tags.length; i++)
        {
            node = tags[i].node;
            srcAttributeName = tags[i].srcAttributeName;
            var newNode = {
                node: null,
                oldNode: node,
                parent: xGetParent(node)
            };
            if( bForceRecreation )
            {
                newNode.node = xCreateElement("script");
            }
            else
            {
                newNode.node = xCloneNode(node, false);
            }
            for (var p in node) {
                if (node.hasOwnProperty(p)) {
                    newNode.node.p = node.p;
                }
            }
            src = xGetAttribute( node, srcAttributeName );
            xSetAttribute( newNode.node, srcAttributeName, this._updatedUrl(src) );
            newTags.push(newNode);
            removeTags.push(node);
        }
        for(var i=0; i < newTags.length; i++) {
            xInsertAfter(newTags[i].oldNode, newTags[i].node);
        }
        if( nDeleteDelay > 0 )
        {
            for(var i=0; i < removeTags.length; i++) {
                xSetAttribute(removeTags[i], "data-hotswap-deleted", "1");
            }

            setTimeout( function() {
                for(var i=0; i < removeTags.length; i++) {
                    xRemove(removeTags[i]);
                }
            }, nDeleteDelay);
        }
        else
        {
            for(var i=0; i < removeTags.length; i++) {
                xRemove(removeTags[i]);
            }
        }
    };
    hotswap.prototype._reload = function( type, xcludedFiles, xcludeComparator )
    {
        var tags = this._getFilesByType(type, xcludedFiles, xcludeComparator);
        var i, src, node, srcAttributeName;
        for(i=0; i<tags.length; i++)
        {
            node = tags[i].node;
            srcAttributeName = tags[i].srcAttributeName;
            // update the src property
            src = xGetAttribute( node, srcAttributeName );
            xSetAttribute( node, srcAttributeName, this._updatedUrl(src) );
        }
    };
    hotswap.prototype._getFilesByType = function( type, xcludedFiles, xcludeComparator )
    {
        var files;
        switch(type)
        {
            case "css":
                files = this._getFiles(
                    "css",
                    "link",
                    function(ele)
                    {
                        return (xGetAttribute(ele, "rel") == "stylesheet" || xGetAttribute(ele, "type") == "text/css");
                    },
                    "href",
                    xcludedFiles,
                    xcludeComparator
                )
                break;

            case "js":
                files = this._getFiles(
                    "js",
                    "script",
                    function(ele)
                    {
                        return (xGetAttribute(ele, "type") == "" || xGetAttribute(ele, "type") == "text/javascript");
                    },
                    "src",
                    xcludedFiles,
                    xcludeComparator
                )
                break;

            case "img":
                files = this._getFiles(
                    "img",
                    "img",
                    function(ele)
                    {
                        return (xGetAttribute(ele, "src") != "");
                    },
                    "src",
                    xcludedFiles,
                    xcludeComparator
                )
                break;
        }

        return files;
    }
    hotswap.prototype._getFiles = function( type, tagName, tagFilterFunc, srcAttributeName, xcludedFiles, xcludeComparator )
    {
        if( typeof xcludedFiles == "undefined" || !xcludedFiles)
        {
            xcludedFiles = [];
        }

        if( typeof xcludeComparator == "undefined" || !xcludeComparator)
        {
            xcludeComparator = false;
        }

        var fileNodes = [];
        var tags = xGetElementsByTagName(tagName);
        var src, detected, node;
        for(var i=0; i<tags.length; i++) {
            node = tags[i];
            src = xGetAttribute(node,[srcAttributeName]);
            if( xIsEmpty( xGetAttribute(node, "data-hotswap-deleted") ) )
            {
                if(src && tagFilterFunc(node))
                {
                    detected = false;
                    for(var j=0; j<xcludedFiles.length; j++) {
                        if( xContains(src,xcludedFiles[j]) )
                        {
                            detected = true;
                            break;
                        }
                    }
                    if( detected == xcludeComparator )
                    {
                        fileNodes.push({
                            type: type,
                            node : node,
                            tagName : tagName,
                            srcAttributeName : srcAttributeName
                        });
                    }
                }
            }
        }

        return fileNodes;
    };
    hotswap.prototype._updatedUrl = function( url, getCleanUrl )
    {
        var cleanUrl;
        if( typeof getCleanUrl == "undefined")
        {
            getCleanUrl = false;
        }
        url = cleanUrl = url.replace(new RegExp("(\\?|&)"+this.RND_PARAM_NAME+"=[0-9.]*","g"), "");
        var queryString = "", randomizedQueryString = "";
        if( xContains(url, "?") )
        {
            if(xContains(url, "&" + this.RND_PARAM_NAME))
            {
                queryString = url.split("&" + this.RND_PARAM_NAME).slice(1,-1).join("");
            }
            randomizedQueryString = queryString + "&" + this.RND_PARAM_NAME + "=" + Math.random() * 99999999;
        }
        else
        {
            if(xContains(url, "?" + this.RND_PARAM_NAME))
            {
                queryString = url.split("?" + this.RND_PARAM_NAME).slice(1,-1).join("");
            }
            randomizedQueryString = queryString + "?" + this.RND_PARAM_NAME + "=" + Math.random() * 99999999;
        }
        var foundAt = -1;
        if( !xIsEmpty( this._prefixCache ) )
        {
            for(var i=0; i<this._prefixCache.length; ++i)
            {
                if( !xIsEmpty(this._prefixCache[i]) && foundAt < 0 )
                {
                    for(var h=0; h<this._prefixCache[i].length; ++h)
                    {
                        if( this._prefixCache[i][h] == cleanUrl + queryString )
                        {
                            cleanUrl = this._prefixCache[i][0];
                            foundAt = i;
                            break;
                        }
                    }
                }
            }
        }

        var prefixHistory = [cleanUrl + queryString];
        var applyPrefix = true;
        if( prefixHistory[0].match( new RegExp('^[A-Za-z0-9-_]+://') ) )
        {
            applyPrefix = false;
        }
        var prefix = this._prefix;
        if( !xIsEmpty(this._prefix) && this._prefix )
        {
            prefixHistory.push( this._prefix + cleanUrl + queryString );
            if(foundAt >= 0)
            {
                this._prefixCache[foundAt] = prefixHistory;
            }
            else
            {
                this._prefixCache.push( prefixHistory );
            }
        }
        else
        {
            prefix = "";
        }
        if( !applyPrefix )
        {
            prefix = "";
        }
        url = prefix + cleanUrl + randomizedQueryString;

        return (getCleanUrl) ? (cleanUrl + queryString) : url;
    }
    hotswap.prototype.refreshAllJs = function( excludedFiles )
    {
        if( typeof excludedFiles == "undefined" || !excludedFiles)
        {
            excludedFiles = []
        }
        excludedFiles.push("hotswap.js");

        this._recreate( "js", excludedFiles, false, 0, true );
    };
    hotswap.prototype.refreshJs = function( includedFiles )
    {
        this._recreate( "js", includedFiles, true, 0, true );
    };
    hotswap.prototype.refreshAllCss = function( excludedFiles )
    {
        this._recreate( "css", excludedFiles, false, this.FILE_REMOVAL_DELAY );
    };
    hotswap.prototype.refreshCss = function( includedFiles )
    {
        this._recreate( "css", includedFiles, true, this.FILE_REMOVAL_DELAY );
    };
    hotswap.prototype.refreshAllImg = function( excludedFiles )
    {
        this._reload( "img", excludedFiles, false );
    };
    hotswap.prototype.refreshImg = function( includedFiles )
    {
        this._reload( "img", includedFiles, true );
    };
    hotswap.prototype.setPrefix = function( prefix )
    {
        this._prefix = prefix;
        var gui = xGetElementById(this.CSS_HTML_PREFIX + "_wrapper");
        if( gui )
        {
            if( !xIsEmpty(this._prefix) && this._prefix )
            {
                xGetElementById(this.CSS_HTML_PREFIX+"-prefix").value = this._prefix;
            }
            else
            {
                xGetElementById(this.CSS_HTML_PREFIX+"-prefix").value = "";
            }
        }
    }
    hotswap.prototype.getPrefix = function()
    {
        return this._prefix;
    }
    hotswap.prototype.createGui = function( nDistanceFromTopInPercent )
    {
        if( xIsEmpty(nDistanceFromTopInPercent) )
        {
            nDistanceFromTopInPercent = 20;
        }
        var gui = xGetElementById(this.CSS_HTML_PREFIX + "_wrapper");
        if( gui )
        {
            xRemove(xGetElementById(this.CSS_HTML_PREFIX + "_wrapper"));
        }
        gui = xCreateElement("div");
        xSetAttribute( gui, "id", this.CSS_HTML_PREFIX + "_wrapper" );
        var guiHtml = xReplace( this._guiHtml, "PREFIX", this.CSS_HTML_PREFIX );
        guiHtml = xReplace( guiHtml, '20%;/*distance from top*/', nDistanceFromTopInPercent+'%;/*distance from top*/' );
        gui.innerHTML = guiHtml;
        xAppendChild( xGetElementsByTagName("body")[0], gui );
        if( !xIsEmpty(this._guiCache) )
        {
            this._guiCache = {};
        }
        this._guiCreateFilesList();
        if( !xIsEmpty(this._prefix) && this._prefix )
        {
            xGetElementById(this.CSS_HTML_PREFIX+"-prefix").value = this._prefix;
        }
        var self = this;
        xAddEventListener( xGetElementById(this.CSS_HTML_PREFIX+"-toggle"), "click", function(evt)
        {
            var gui = xGetElementById(self.CSS_HTML_PREFIX);
            if( xHasClass(gui, "mini") )
            {
                xRemoveClass( gui, "mini" );
            }
            else
            {
                xAddClass( gui, "mini" );
            }
        });
        xAddEventListener( xGetElementById(this.CSS_HTML_PREFIX+"-prefix"), "blur", function(evt)
        {
            self._guiPrefixChanged(evt.target);
        });
        xAddEventListener( xGetElementById(this.CSS_HTML_PREFIX+"-submit-selected"), "click", function(evt)
        {
            self._guiRefreshSelected()
        });
        xAddEventListener( xGetElementById(this.CSS_HTML_PREFIX+"-submit-start"), "click", function(evt)
        {
            if( xGetAttribute(evt.target, "class") != this.CSS_HTML_PREFIX+"-seconds" )
            {
                var input, nSeconds = 1;
                var children = evt.target.children;
                for(var i=0; i<children.length; ++i)
                {
                    if( xGetAttribute(children[i], "class") == this.CSS_HTML_PREFIX+"-seconds" )
                    {
                        nSeconds = children[i].value;
                    }
                }

                self._guiRefreshSelected();
                self._guiRefreshStart( nSeconds );
            }
        });
        xAddEventListener( xGetElementById(this.CSS_HTML_PREFIX+"-submit-stop"), "click", function(evt)
        {
            self._guiRefreshStop();
        });
        xAddEventListener( xGetElementById(this.CSS_HTML_PREFIX+"-submit-refresh-list"), "click", xBind(self.guiRefreshFilesList,self) );
    }

    hotswap.prototype._guiCreateFilesList = function()
    {
        this._guiCache.files = [];
        this._guiCache.activeFiles = {
            "css" : [],
            "js" : [],
            "img" : []
        };

        var self = this;
        var createFilesList = function(list, files)
        {
            var i, j, r, clone, template, file, fileName, nodesToRemove = [];
            for(j=0; j<list.children.length; ++j)
            {
                if( xHasClass( list.children[j], "template" ) )
                {
                    template = list.children[j];
                }
                else
                {
                    if( !xHasClass( list.children[j], self.CSS_HTML_PREFIX + "-headline" ) )
                    {
                        nodesToRemove.push(list.children[j]);
                    }
                }
            }
            for(r=0; r<nodesToRemove.length; ++r)
            {
                xRemove( nodesToRemove[r] );
            }
            for(i=0; i<files.length; ++i)
            {
                file = files[i];
                clone = xCloneNode( template );
                xRemoveClass( clone, "template" );
                fileName = self._updatedUrl( xGetAttribute( file.node, file.srcAttributeName ), true );
                if( !xContains(self._guiCache.files,fileName) )
                {
                    self._guiCache.files.push(fileName);
                    clone.innerHTML = fileName;
                    xAppendChild( list, clone );
                    xAddEventListener( clone, "click", (function(type, fileName){
                        return function(evt){
                            xStopPropagation(evt);
                            xPreventDefault(evt);
                            self._guiClickedFile(evt.target, type, fileName);
                        };
                    })(file.type, fileName)
                    );
                }
            }
        }

        createFilesList( xGetElementById(this.CSS_HTML_PREFIX+"-css"), this._getFilesByType("css") );
        createFilesList( xGetElementById(this.CSS_HTML_PREFIX+"-js"), this._getFilesByType("js", ["hotswap.js"]) );
        createFilesList( xGetElementById(this.CSS_HTML_PREFIX+"-img"), this._getFilesByType("img") );
    }
    hotswap.prototype.deleteGui = function()
    {
        var gui = xGetElementById(this.CSS_HTML_PREFIX + "_wrapper");
        if( gui )
        {
            xRemove(xGetElementById(this.CSS_HTML_PREFIX + "_wrapper"));
        }
    }
    hotswap.prototype._guiPrefixChanged = function(ele)
    {
        if( ele )
        {
            this.setPrefix(ele.value);
        }
    },

    hotswap.prototype._guiClickedFile = function( ele, sType, sFileName )
    {
        var activeFiles = this._guiCache.activeFiles[sType];
        if( xContains( activeFiles, sFileName ) )
        {
            xRemoveClass(ele, "active");
            activeFiles.splice( activeFiles.indexOf(sFileName), 1 )
        }
        else
        {
            xAddClass(ele, "active");
            activeFiles.push( sFileName );
        }
    },

    hotswap.prototype._guiRefreshSelected = function()
    {
        var activeFiles = this._guiCache.activeFiles;
        if( activeFiles['css'].length > 0 )
        {
            this.refreshCss( activeFiles['css'] );
        }
        if( activeFiles['js'].length > 0 )
        {
            this.refreshJs( activeFiles['js'] );
        }
        if( activeFiles['img'].length > 0 )
        {
            this.refreshImg( activeFiles['img'] );
        }
    },

    hotswap.prototype._guiRefreshStart = function( nSeconds )
    {
        if( this._guiGuiRefreshInterval !== null )
        {
            this._guiRefreshStop();
        }
        var self = this;
        this._guiGuiRefreshInterval = setInterval( xBind(this._guiRefreshSelected, this), nSeconds * 1000 );
        xAddClass( xGetElementById(this.CSS_HTML_PREFIX+"-submit-start"), "inactive" );
        xRemoveClass( xGetElementById(this.CSS_HTML_PREFIX+"-submit-stop"), "inactive" );
    },

    hotswap.prototype._guiRefreshStop = function()
    {
        if( this._guiGuiRefreshInterval !== null )
        {
            clearInterval(this._guiGuiRefreshInterval);
        }
        this._guiGuiRefreshInterval = null;
        xRemoveClass( xGetElementById(this.CSS_HTML_PREFIX+"-submit-start"), "inactive" );
        xAddClass( xGetElementById(this.CSS_HTML_PREFIX+"-submit-stop"), "inactive" );
    }

    hotswap.prototype.guiRefreshFilesList = function()
    {
        this._guiCreateFilesList();
    }

}).call(this); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T05:25:09.480

我对 HotSport 不熟悉，但如果您谈论的是动态加载 JavaScript，是的，您可以这样做。[MooTools](http://mootools.net/docs/Plugins/Assets)允许您这样做，[jQuery](http://plugins.jquery.com/node/1834)、[Prototype](http://www.magichatdevelopment.com/content/blog/article.php?id=4)、[Dojo](http://api.dojotoolkit.org/jsdoc/dojo/1.2/dojo.io.script)和[YUI](http://developer.yahoo.com/yui/get/)也是如此，我相信大多数其他框架也可以这样做。您也可以使用[本机 JavaScript](http://ajaxpatterns.org/On-Demand_Javascript)来实现。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-16T05:29:05.383

我确定这里没有太多人知道​​你所说的热交换是什么意思，但正如 virtuosiMedia 所说，mootools 允许这样做，如果你不那么信任 mootools，那么 jquery 有一个相同的插件，如果你不想要框架，你总是可以通过添加这些脚本dom

但我确定您不允许更改您已经定义的头级脚本，因为通过 DOM 动态添加的任何脚本都只是正文级

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-09-22T08:01:27.310

您可以使用 RequireJS 前端模块系统轻松地热重载 JavaScript 代码，我最近写了一篇关于它的文章（2015 年 9 月）

[https://medium.com/@the1mills/hot-reloading-with-react-requirejs-7b2aa6cb06e1](https://medium.com/@the1mills/hot-reloading-with-react-requirejs-7b2aa6cb06e1)

您基本上删除了 AMD 模块的缓存，RequireJS 将从文件系统中获取新的缓存。

诀窍是使用 websockets（socket.io 工作正常）告诉浏览器文件已更改，并删除缓存并重新请求文件。

其余信息在文章中

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-16T05:23:09.827

如果您想对*整个*JavaScript 文件执行此操作，请参阅[**此问题**](https://stackoverflow.com/questions/203113)以获得足够相似的内容，您应该能够了解该想法的基础知识。

# asp.net - 静态方法的缺点是什么？

> ID：207521
> 
> 赞同：9
> 
> 时间：2008-10-16T05:21:07.943
> 
> 标签：asp.net, oop

在网站业务层中使用静态方法与实例化一个类然后在该类上调用方法有什么缺点？两种方式的性能如何？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-16T05:25:43.223

性能差异可以忽略不计。

使用静态方法的缺点是它变得不太可测试。当依赖关系以静态方法调用表示时，您不能用模拟/存根替换这些依赖关系。如果所有依赖项都表示为接口，其中实现被传递到组件中，那么您可以使用组件的模拟/存根版本进行单元测试，然后将真正的实现（可能与 IoC 容器挂钩）用于真正的部署。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-16T05:40:26.093

Jon Skeet 是对的——性能差异将是微不足道的......

话虽如此，如果您正在构建企业应用程序，我建议使用 Microsoft 和许多其他软件公司所支持的传统分层方法。让我简单解释一下：

我将使用 ASP.NET，因为我最熟悉它，但这应该很容易转化为您可能使用的任何其他技术。

应用程序的表示层将由用于显示的 ASP.NET aspx 页面和用于“过程控制”的 ASP.NET 代码隐藏组成。这是谈论单击提交时发生的事情的一种奇特方式。我要转到另一个页面吗？有验证吗？我需要将信息保存到数据库吗？之后我该去哪里？

过程控制是表示层和业务层之间的联络点。该层分为两部分（这就是您的问题所在）。构建这一层最灵活的方法是拥有一组业务逻辑类（例如，PaymentProcessing、CustomerManagement 等），其中包含 ProcessPayment、DeleteCustomer、CreateAccount 等方法。这些将是静态方法。

当从流程控制层调用上述方法时，它们将处理业务对象（例如，客户、发票、付款等）的所有实例化并应用适当的业务规则。

您的业​​务对象将处理与您的数据层的所有数据库交互。也就是说，他们知道如何保存他们包含的数据……这类似于 MVC 模式。

那么——这样做有什么好处呢？好吧，您仍然可以获得多个级别的可测试性。您可以测试您的 UI，您可以测试业务流程（通过使用适当的数据调用业务逻辑类），您可以测试业务对象（通过手动实例化它们并测试它们的方法。您还知道，如果您的数据模型或者对象发生变化，你的 UI 不会受到影响，只有你的业务逻辑类需要改变。另外，如果业务逻辑发生变化，你可以在不影响对象的情况下更改这些类。

希望这个对你有帮助。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-16T05:43:29.380

性能方面，使用静态方法避免了对象创建/销毁的开销。这通常是不重要的。

它们应该仅在方法采取的操作与状态无关的情况下使用，例如，对于工厂方法。创建一个对象实例只是为了实例化另一个对象实例是没有意义的:-)

String.Format()、TryParse() 和 Parse() 方法都是静态方法有意义的好例子。它们总是执行相同的操作，不需要状态并且相当普遍，因此实例化不太有意义。

另一方面，在没有意义的情况下使用它们（例如，必须将所有状态传递给方法，例如，使用 10 个参数），会使一切变得更复杂、更难维护、更难读、更难测试，正如 Jon 所说. 我认为这与业务层或代码中的其他任何地方无关，仅在情况合理时才使用它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T05:33:44.453

如果该方法使用静态数据，这实际上将在您的 Web 应用程序的所有用户之间共享。

纯代码，除了所有系统中静态方法的常见问题之外，没有真正的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-19T10:27:01.347

1.  可测试性：静态依赖项的可测试性较差
2.  线程：您可能会遇到并发问题
3.  设计：静态变量就像全局变量

# eclipse - 如何让 Eclipse 识别 Java EE jar 文件以便 Servlet 可以编译？

> ID：207541
> 
> 赞同：5
> 
> 时间：2008-10-16T05:37:14.087
> 
> 标签：eclipse, servlets, jakarta-ee, jar

我正在设置我的 Java EE 版本的 Eclipse 来编译 Servlet。我有 Eclipse 说“HttpServlet”无法解决的问题，因为它找不到 Java EE jar 文件。

我正在使用 Windows XP。我已经启动并运行了 Tomcat 6.0。我认为最简单的解决方案是链接到 Tomcat 安装中的 servlet-api.jar 文件。

我将它添加到 Windows CLASSPATH 环境变量中。现在看起来像这样：.;C:\Program Files\Java\jre1.6.0_04\lib\ext\QTJava.zip;C:\Program Files\Apache Software Foundation\Tomcat 6.0\lib\servlet-api.jar

那没有用。难道我做错了什么？

什么是最好的解决方案？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-16T06:07:53.933

您可以将 servlet-api.jar 文件添加到项目属性中。从项目层次结构中右键单击项目名称-> 属性-> Java 构建路径-> 库选项卡。从那里，将 servlet-api.jar 添加为外部 jar 文件。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-09T12:49:18.187

首先通过转到新建 -> 服务器 -> 服务器来添加 Tomcat 服务器。然后右键单击您的项目，单击“构建路径”->“配置构建路径”。单击添加库 -> 服务器运行时并选择您添加的 Tomcat 服务器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-16T06:04:51.647

有几件事要检查：

您是否将项目创建为“动态 Web 项目”（通过 New->Project...->Web->Dynamic Web Project）？

您应该有一个 Web App Librairies 目录，其中包含：

*   网络应用程序库
*   JRE 系统库
*   Apache Tomcat vx.y

您是否在“Window -> Preferences... -> Server -> Installed Runtimes”中选择了服务器？

你有一个 TOMCAT_HOME 在 Prefereces -> Java -> Build Path -> Classpath 变量指的是你的tomcat安装的主目录吗？尝试将其添加到您的项目类路径中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-16T18:50:07.387

Eclipse 不使用 CLASSPATH 环境变量或任何其他环境变量（除了可能要查找要运行的 VM）。这样做会使从同一机器和安装完全针对不同的虚拟机和服务器（如果不是不可能的话）变得困难。使用的 jar 列表完全基于项目的 Java 构建路径。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-16T18:55:10.450

对于常规的 java 项目，您可以执行以下操作：

1.  在 Eclipse 项目中创建一个名为“lib”的文件夹。
2.  将 servlet jar 添加到 lib 文件夹。
3.  右键单击导航器视图中的 servlet jar 文件并选择“添加到构建路径”。

对于更复杂的项目，我建议使用 Maven+m2eclipse。

# windows-mobile - 如何以编程方式关闭 Windows Mobile 设备

> ID：207542
> 
> 赞同：3
> 
> 时间：2008-10-16T05:37:18.517
> 
> 标签：windows-mobile, compact-framework

我想使用 Compact framework 2.0、Windows mobile 5.0 SDK 以编程方式关闭 Windows Mobile 设备。

问候，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-16T12:25:53.077

从您的应用程序中执行此操作可能不是一个好主意 - 设备有一个电源按钮是有原因的，关闭应用程序可能会导致用户困惑和沮丧。

如果您必须这样做，并且您使用的是 Windows Mobile 5.0 或更高版本，您可以像这样 P/Invoke [ExitWindowsEx](http://msdn.microsoft.com/en-us/library/bb416523.aspx)：

```
[Flags]
public enum ExitFlags
{
  Reboot = 0x02,
  PowerOff = 0x08
}

[DllImport("coredll")]
public static extern int ExitWindowsEx(ExitFlags flags, int reserved);

...

ExitWindowsEx(ExitFlags.PowerOff, 0); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-13T10:51:04.167

`OpenNetCF.WindowsCE.PowerManagement`类具有挂起和软重置的方法。它甚至有硬件重置的方法！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-21T11:47:27.217

ExitWindowsEx API 需要注意的另一件事是，仅 Windows Mobile Standard（即智能手机）而不是 Windows Mobile Professional（Pocket PC）设备支持关机。

[请参阅 MSDN 上的ExitWindowsEx 文档](http://msdn.microsoft.com/en-us/library/bb416523.aspx)中有关EWX_POWEROFF 标志的特别说明。我已经有几年没有在 Pocket PC 上尝试过 API，但我很确定这仍然是游戏的状态。

相反，您可能希望使用电源管理 API 将设备置于较低的电源状态，例如挂起或无人值守模式。您试图通过以编程方式关闭设备来实现什么？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T06:24:35.397

“普通”Windows API 具有 ExitWindowsEx() 函数。你可能想看看这个。然而，它似乎是[OEM 依赖](http://www.themssforum.com/Compact/ExitWindowsEx/)的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-16T06:55:18.347

从我读到的（几年前的现在）Windows CE 实际上并没有设计为这样关闭，只是进入暂停的低功耗状态。请记住它适用于移动/智能手机，因此它们总是要打开的。

ExitWindowsEx 函数可能对您有用，但是：

*   它是本机功能，而不是 .Net / Compact Framework。
*   OEM 必须实现所需的功能才能使其有用。
*   该功能仅存在于 Windows Mobile 5.0 或更高版本的操作系统上，并不意味着它存在于所有 Windows CE 设备上。

> 仅从工作中的个人角度来看，我们已经为基于 Windows CE 的操作系统实现了我们自己的关闭和重启工具。我们必须为此编写大量代码，所以我不希望这种关闭功能存在于所有操作系统上。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-04-29T08:21:43.793

我有不同的 API 重启和关机（关机）方式，虽然它有一个不确定是什么的问题。

私有枚举SetSystempowerstateAdeaction
{
Power_State_On = 0x00010000，
POWER_STATE_SOOFT = 0x00020000，
POWER_STATE_SUSPEND = 0x00200000，
POWER_FORCE_RESET
= 0x00800000
}

[DLLIMPORT（“coredll.dll”，setlasterror = true）]
static extern int setsystempowerstate（String psstate，int状态flags，int选项）;

// 关闭
//**虽然我不确定它为什么会重启**??
SetSystemPowerState(null, (int)SetSystemPowerStateAction.POWER_STATE_OFF, (int)SetSystemPowerStateAction.POWER_FORCE);

// 重启
SetSystemPowerState(null, (int)SetSystemPowerStateAction.POWER_STATE_RESET, (int)SetSystemPowerStateAction.POWER_FORCE);

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-10-14T03:28:33.903

我尝试了这2个代码，成功关闭了掌上电脑

```
Process.Start("cmd", "/c shutdown.exe")
<br/>
Me.Close() 
```

# php - 获取对 POST 的跨站点 JSON 响应的最佳实践？

> ID：207554
> 
> 赞同：5
> 
> 时间：2008-10-16T05:44:13.747
> 
> 标签：php, javascript, ajax, json, mod-rewrite

我正在使用具有多个子域的 Intranet。我可以控制每个子域，因此跨站点请求的安全性不是问题。我有带有 JSON 响应的 PHP 脚本，我想从多个子域调用而不重复。对于 GET 请求，我可以使用 AJAX 和 JSONP 执行此操作，但这不适用于 POST 请求。我看到了一些替代方案，但似乎都不是很好：

*   以最小的响应发布到本地子域上的副本，然后使用 JSONP 从中央位置获取完整响应
*   使用 JSON POST 和 GET 到本地子域上的副本
*   使用 mod_rewrite 在后端使用带有中央脚本的本地 URL 和 JSON
*   使用符号链接在后端使用带有中央脚本的本地 URL 和 JSON

我错过了一些更简单的东西吗？你会在这里做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-16T07:20:29.263

您可以在服务器端编写一个简单的反射器。向每个域添加一个脚本，将您的 ajax 请求简单地传递到相应的域。该脚本可以非常简单（1 或 2 行代码），避免您的跨站点脚本问题，并且意味着您不需要在现有脚本中复制复杂的业务逻辑。

它会给您的服务器带来额外的工作，但这对您来说可能不是问题。

我可以在我管理的网站上找到的最接近的示例代码如下。在这里，我们需要能够在 HTTPS 连接上使用 Googles Chart API（它还不支持）。解决方案是添加以下脚本来传递调用...

```
<?php
// Set header so our output looks like a PNG
header("Content-Type: image/png");

// Reflect the image from googles chart API
echo file_get_contents('http://chart.apis.google.com/chart?'.$_SERVER['QUERY_STRING']);
?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-11T12:45:30.557

看看这个[https://developer.mozilla.org/En/HTTP_access_control](https://developer.mozilla.org/En/HTTP_access_control)页面。您需要的所有东西 - 将标头添加到所有接受发布请求的脚本中。例子：

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T06:45:40.423

在这种情况下，我使用 REST 方法。搜索 google 以获取有关 REST 的更多信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-29T05:16:38.470

如果它们都是同一个域的子域，您可以将此代码添加到每个页面：

```
document.domain = 'domain.com'; 
```

然后，只需使用普通的 xmlHttpRequest。

# java - 向 Java Swing 应用程序添加自我更新功能的最佳方式是什么？

> ID：207557
> 
> 赞同：12
> 
> 时间：2008-10-16T05:49:23.267
> 
> 标签：java, swing

我正在尝试找出一种将自我更新功能添加到我正在开发的 Java/Swing 应用程序中的方法。

基本上我有一堆带有额外功能的 jar 文件，当他们更改时，可以将它们重新部署给已安装的用户。没什么复杂的，只需检查是否发布了新版本，通过 HTTP 下载它们，然后选择性地向用户提供重新启动应用程序。

我看了一下webstart，它可以工作。但是这个特殊的应用程序在类加载和 GC 内存设置方面做了一些时髦的事情，这些设置看起来不像是通过 webstart 支持的，或者至少会使事情复杂化。（这是 JMeter 的调整版本）

我还沿着添加这个插件处理程序[http://swing-fx.blogspot.com/2008/06/add-auto-update-and-plugins-to-your.html](http://swing-fx.blogspot.com/2008/06/add-auto-update-and-plugins-to-your.html)的道路前进，但它非常 alpha，并试图对你在 alpha 版本中遇到的常见错误做太多事情。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-16T06:30:25.523

我做了同样的事情。但那是很久以前的事了，所以今天可能有更好的工具。

我发现我需要的是一个装载机。加载程序主程序在类路径中没有应用程序 jar。如果需要，它首先下载更新，然后使用类路径中的应用程序 jar 创建自定义类加载器，并调用应用程序主类的 main 方法。这不是很复杂。IIRC 我需要这样做，因为如果 jar 已经在类路径中，它们就不能在 windows 中被覆盖。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-16T06:55:01.403

6 年前，我们有一个可以自我更新的摇摆应用程序。就像你建议的那样，

1）它通过http下载了最新的jar，
2）将它们复制到一个文件夹中。
3）由于swing应用程序是使用.BAT文件启动的，在用户说YES后，我们将关闭swing应用程序并在更新文件夹中查找任何文件。如果是，则启动另一个 .BAT 文件以将新 JAR 复制到所需目录。
4）然后重新启动摇摆应用程序。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-16T18:04:11.210

更新、插件、关注点分离等正是[OSGi](http://www.osgi.org)的意义所在——你可能想看看这个。它不会免费（阅读：初始学习曲线陡峭，特别是当您当前使用类加载技巧时）至少有很好的开源实现（felix - 请参阅[felix.apache.org](http://felix.apache.org)，Equinox - 请参阅[www.eclipse。组织](http://www.eclipse.org)和其他）

对于这些实现，可以使用自动更新器 - 如果您正确编写模块，则可以在运行时更新而无需重新启动。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-16T09:05:56.163

我相信您应该再次查看 Java WebStart，或者至少详细说明您认为会导致问题的“时髦类加载”（因为它也可能导致此处提出的任何解决方案出现问题）。

IIRC，您可以使用 Java WebStart ( [http://java.sun.com/j2se/1.5.0/docs/guide/javaws/developersguide/syntax.html#resources](http://java.sun.com/j2se/1.5.0/docs/guide/javaws/developersguide/syntax.html#resources) ) 设置命令行参数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-16T11:45:17.700

我肯定会首先尝试 Webstart。即使是使用 Webstart 的早期 Eclipse RCP 应用程序，我们也已经取得了很大的成功，而且您可能找不到比使用 OSGI 框架 (Eclipse Equinox) 更时髦的类加载问题了。

您能否在有关类加载方法的问题中提供更多详细信息？

关于 GC 和其他 VM 设置：这些很容易在 Webstart 用于启动应用程序的 JNLP（Java 网络启动协议）文件中指定。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-16T20:46:00.370

The Java Web Start is good choice. The GC stuff is not important. Classloading could be problem. But when you got trusted by user you can grant AllPermisions and you will be able to do custom classloading. Maybe it will be good to reconsider funky stuff with classloading. It is really necessary? Or look at NetBeans. There should be found inspiration for auto-update.

# eclipse - Eclipse 和 JSP：java.lang.NoSuchMethodError：javax.servlet.jsp.tagext.TagAttributeInfo。 (Ljava/lang/String;ZLjava/lang/String;ZZ)V

> ID：207565
> 
> 赞同：6
> 
> 时间：2008-10-16T06:07:23.917
> 
> 标签：eclipse, jsp, eclipse-3.4

我正在使用带有 WTP 3.0.2 的 Eclipse 3.4 并运行一个相当大的动态 Web 项目。我已经设置了项目，以便我可以在[http://127.0.0.1:8080/share/](http://127.0.0.1:8080/share/)访问它，但每当我这样做时，我都会收到以下错误：

```
  java.lang.NoSuchMethodError: javax.servlet.jsp.tagext.TagAttributeInfo.(Ljava/lang/String;ZLjava/lang/String;ZZ)V
  在 org.apache.jasper.compiler.TagLibraryInfoImpl.createAttribute(TagLibraryInfoImpl.java:572)
  在 org.apache.jasper.compiler.TagLibraryInfoImpl.createTagInfo(TagLibraryInfoImpl.java:401)
  在 org.apache.jasper.compiler.TagLibraryInfoImpl.parseTLD（TagLibraryInfoImpl.java:248）
  在 org.apache.jasper.compiler.TagLibraryInfoImpl.(TagLibraryInfoImpl.java:162)
  在 org.apache.jasper.compiler.Parser.parseTaglibDirective（Parser.java:423）
  在 org.apache.jasper.compiler.Parser.parseDirective（Parser.java:492）
  在 org.apache.jasper.compiler.Parser.parseElements(Parser.java:1552)
  在 org.apache.jasper.compiler.Parser.parse(Parser.java:126)
  在 org.apache.jasper.compiler.ParserController.doParse(ParserController.java:211)
  在 org.apache.jasper.compiler.ParserController.parse(ParserController.java:100)
  在 org.apache.jasper.compiler.Compiler.generateJava(Compiler.java:155)
  在 org.apache.jasper.compiler.Compiler.compile(Compiler.java:295)
  在 org.apache.jasper.compiler.Compiler.compile(Compiler.java:276)
  在 org.apache.jasper.compiler.Compiler.compile(Compiler.java:264)
  在 org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:563)
  在 org.apache.jasper.servlet.JspServletWrapper.service（JspServletWrapper.java:303）
  在 org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:314)
  在 org.apache.jasper.servlet.JspServlet.service(JspServlet.java:264)
  在 javax.servlet.http.HttpServlet.service(HttpServlet.java:853)
  在 org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:269)
  在 org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:188)
  在 org.apache.catalina.core.StandardWrapperValve.invoke（StandardWrapperValve.java:213）
  在 org.apache.catalina.core.StandardContextValve.invoke（StandardContextValve.java:172）
  在 org.apache.catalina.core.StandardHostValve.invoke（StandardHostValve.java:127）
  在 org.apache.catalina.valves.ErrorReportValve.invoke（ErrorReportValve.java:117）
  在 org.apache.catalina.core.StandardEngineValve.invoke（StandardEngineValve.java:108）
  在 org.apache.catalina.connector.CoyoteAdapter.service（CoyoteAdapter.java:174）
  在 org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:875)
  在 org.apache.coyote.http11.Http11BaseProtocol$Http11ConnectionHandler.processConnection(Http11BaseProtocol.java:665)
  在 org.apache.tomcat.util.net.PoolTcpEndpoint.processSocket(PoolTcpEndpoint.java:528)
  在 org.apache.tomcat.util.net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:81)
  在 org.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:689)
  在 java.lang.Thread.run（未知来源）

```

由于以上文件都不是我自己的，因此很难指出问题的原因。任何想法从哪里开始寻找？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-16T06:31:04.573

我最终回答了我自己的问题：问题是我添加到 Tomcat 的必要 JAR 中有一个冲突的 servlet.jar。当我删除它时，错误消失了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T06:20:50.553

您是否在“Preferences->Tomcat->Advanced->Tomcat base”中设置了 Tomcat 路径？

尝试清理该路径（恢复默认配置），并检查是否能解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-18T09:31:22.343

很可能是eclipse中的tomcat插件导致了冲突问题，我设法通过获取相同版本的jar文件并在eclipse中的tomcat插件中覆盖它来解决问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-13T12:18:33.403

我有类似的问题，我通过确保我的应用程序正在使用的类路径中有正确版本的**servlet.jar来解决这个问题，并且我在类路径中保留了旧的****J2EE.jar**文件，这导致了主要问题。因此，我将它从类路径中删除以确保它默认使用文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-03-02T09:20:42.267

我在运行 Eclipse Helios 时遇到了同样的问题，Maven 处理依赖项并使用 Jetty 作为网络服务器。更新到 Spring 3.1 后，我突然遇到了这个问题，但只是在我的本地开发机器上。

我首先删除了本地 maven 存储库中的 spring 和 jetty 文件夹并更新了依赖项，但这并没有改善情况。

然后我只是删除了码头附带的 servlet-api 和 servlet-api-2.5 文件夹（但保留了其他所有内容），我让它工作了。

所有人都为类路径的魔力欢呼。

# .net - 防止 Visual Studio 自动创建“混合平台”解决方案配置

> ID：207566
> 
> 赞同：83
> 
> 时间：2008-10-16T06:07:35.087
> 
> 标签：.net, visual-studio

如何防止 Visual Studio 2008 自动创建“混合平台”和“任何 CPU”解决方案配置？我们有“Win32”和“x64”配置，开发人员需要在它们之间进行选择。但是，只要有人对解决方案进行任何更改，VS 就会自动创建“混合平台”，这似乎是默认配置。这会导致很多问题，因为在此配置中没有选择一些新项目或选择了错误的项目配置等。我只是想阻止它这样做并自己管理解决方案配置。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-16T15:56:19.907

我们在 Visual Studio 2005 项目中看到了类似的问题，我们希望为 Win32 配置和许多不同的智能设备平台/配置组合构建这些项目。

在任意时间，每个平台都会自动生成每个配置，无论它是否有效，这会增加我们约 50 个项目文件的大小并导致大量工作来解决问题。

当我们打开配置管理器对话框时，它总是会发生，有时（但不总是）会在更改配置的项目设置时发生。在后一种情况下，它似乎与在项目设置对话框中操作平台和配置下拉菜单有关。

我们将其归档为 Visual Studio 问题；MSFT 将其关闭为“不会修复”。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-08-25T22:23:43.903

我一直在处理同样的问题。我同意这是一团糟。我已经看到了两种可行的处理方法——它们都不是你真正想要的。

1.  通过转到配置选择器并选择编辑手动删除它创建的配置...
2.  默认情况下（至少如果我从 VS 2010 中的新解决方案开始）并开始创建新项目（类库和应用程序），您最终会为您的解决方案平台使用任何 CPU、混合平台和 x86。Visual Studio 似乎在向任何 CPU 和混合平台添加新类库（因为它们默认为任何 CPU 目标构建）并向混合平台和 x86（因为 x86 目标的默认构建）添加新应用程序方面做得很好，并将新的类库和新的应用程序放到混合平台上。因此，混合平台最终成为一个不错的默认设置，因为它构建了一切。我不确定为什么它没有为您添加新项目到混合平台

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-08-20T09:55:27.143

您可以在源代码管理的提交挂钩中过滤您的 .sln 文件。因此，如果您在 .sln 文件中检查它，并且项目文件可能会得到修复。开源 Chromium 项目实现了这样的过滤器。

# gcc - gcc 链接器问题

> ID：207575
> 
> 赞同：4
> 
> 时间：2008-10-16T06:12:39.400
> 
> 标签：gcc, build, linker, shared-libraries

我正在尝试制作一个包装 libpurple 的库（您无需了解有关 libpurple 的任何信息即可在此处提供帮助）。Libpurple 反过来加载“插件”，这些“插件”只是通过 dlopen 之类的东西访问的 .so。这些插件依次回调 libpurple 中的函数。

我可以很好地构建我的库，但是当它调用适当的 libpurple init 函数并且 libpurple 尝试加载插件时，我收到如下错误：

> 符号查找错误：/usr/local/lib/purple-2/autoaccept.so：未定义符号：purple_user_dir

Purple_user_dir 是 libpurple 中定义的函数。当我构建一个链接到 libpurple 的程序（不是库）时，没有问题。我试过使用 -export-dynamic ，但这似乎没有帮助。这是我的构建命令：

```
gcc -export-dynamic -I/usr/local/include/libpurple -I/usr/include/python2.5 -DH\
AVE_CONFIG_H -I. -DSTANDALONE -DBR_PTHREADS=0 -DDATADIR=\"/usr/local/share\" -D\
LIBDIR=\"/usr/local/lib/purple-2/\" -DLOCALEDIR=\"/usr/local/share/locale\" -DS\
YSCONFDIR=\"/usr/local/etc\" -Wall  -Waggregate-return -Wcast-align -Wdeclarati\
on-after-statement -Wendif-labels -Werror-implicit-function-declaration -Wextra\
 -Wno-sign-compare -Wno-unused-parameter -Winit-self -Wmissing-declarations -Wm\
issing-noreturn -Wmissing-prototypes -Wpointer-arith -Wundef -Wp,-D_FORTIFY_SOU\
RCE=2 -pthread -I/usr/include/glib-2.0 -I/usr/lib/glib-2.0/include   -I/usr/inc\
lude/dbus-1.0 -I/usr/lib/dbus-1.0/include -I/usr/include/glib-2.0 -I/usr/lib/gl\
ib-2.0/include   -I/usr/include/libxml2   -g -g -O2 -c -o spurple.o spurple.c

gcc -shared -g -O2 -Wl,--export-dynamic -pthread 
../../libpurple/.libs/libpurple.so -o spurple.so spurple.o 
-Wl,--export-dynamic  /usr/local/lib/libpurple.so 
-ldbus-glib-1 -ldbus-1 /usr/lib/libgobject-2.0.so /usr/lib/libgmodule-2.0.so 
-ldl /usr/lib/libgthread-2.0.so -lrt /usr/lib/libglib-2.0.so 
/usr/lib/libxml2.so -lm -lpython2.5 -lutil -lpthread -lnsl -lresolv 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T13:30:37.987

只是在黑暗中拍摄，但是您在构建应用程序时与运行它时是否有不同的 LD_LIBRARY_PATH 环境变量？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T06:55:07.567

我会尝试使用[ldd](http://www.computerhope.com/unix/uldd.htm)和[nm](http://unixhelp.ed.ac.uk/CGI/man-cgi?nm) unix 命令来查找包装器和包装库中的符号。

# svn - 在颠覆中移动目录

> ID：207588
> 
> 赞同：3
> 
> 时间：2008-10-16T06:29:50.487
> 
> 标签：svn, version-control

我继承了一个如下所示的颠覆回购：

[https://foo/product/src](https://foo/product/src)

我想让它更像：

*   [https://foo/product/trunk/src](https://foo/product/trunk/src)
*   [https://foo/product/tags](https://foo/product/tags)
*   [https://foo/product/branches](https://foo/product/branches)

将 ./src 移动到 ./trunk/src 会保留历史记录吗？我还想确保其他开发人员不会因为我这样做而诅咒我..这样做会产生意想不到的后果吗？我希望开发人员只做一个简单的 repo 目录重定位。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-16T06:37:03.670

是的，在 Subversion 中执行移动操作将保留受影响文件的所有历史记录。完成此操作后，每个开发人员都必须运行[`svn switch`](http://svnbook.red-bean.com/en/1.5/svn.ref.svn.c.switch.html)命令将他们的工作副本指向`src`. 您应该与其他开发人员协调这一点，并确保没有人在他们的工作副本中有任何待处理的更改，因为以后清理这些会很烦人。

如果您想对此进行试验，我建议您进行转储并恢复到新的存储库中，这样您就可以在沙箱中进行试验，而不会影响其他人。然后，您可以进行移动并确保保留所有历史记录，并更新测试工作副本，以便确保[`svn switch`](http://svnbook.red-bean.com/en/1.5/svn.ref.svn.c.switch.html)执行您期望的操作。

# c# - 使用 C# 获取字段的大小（以字节为单位）

> ID：207592
> 
> 赞同：63
> 
> 时间：2008-10-16T06:31:12.420
> 
> 标签：c#, reflection, byte

我有一个类，我想检查它的字段并最终报告每个字段占用多少字节。我假设所有字段都是 Int32、字节等类型。

如何轻松找出该字段占用多少字节？

我需要类似的东西：

```
Int32 a;
// int a_size = a.GetSizeInBytes;
// a_size should be 4 
```

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2008-10-16T06:39:29.593

你不能，基本上。它将取决于填充，这很可能基于您正在使用的 CLR 版本和处理器等。假设对象没有对其他对象的引用，则更容易计算出对象的总大小：创建一个大数组，使用[GC.GetTotalMemory](http://msdn.microsoft.com/en-us/library/system.gc.gettotalmemory.aspx)作为基点，用对您类型的新实例的引用填充数组，然后再次调用 GetTotalMemory。将一个值与另一个值分开，然后除以实例数。您可能应该事先创建一个实例，以确保没有新的 JITted 代码对数字有贡献。是的，它听起来很老套——但我以前用过它，效果很好。

就在昨天，我还在想为此编写一个小助手类是个好主意。让我知道你是否有兴趣。

编辑：还有另外两个建议，我想同时解决它们。

首先，[sizeof](http://msdn.microsoft.com/en-us/library/eahchzkf.aspx)运算符：这仅显示该类型在抽象中占用了多少空间，没有对其进行填充。（它包括结构内的填充，但不包括应用于另一种类型中该类型变量的填充。）

接下来，[Marshal.SizeOf](http://msdn.microsoft.com/en-us/library/5s4920fa.aspx)：这仅显示编组后的非托管大小，而不是内存中的实际大小。正如文档明确指出的那样：

> 返回的大小实际上是非托管类型的大小。对象的非托管和托管大小可以不同。对于字符类型，大小受应用于该类的 CharSet 值的影响。

再一次，填充可以产生影响。

只是为了澄清我关于填充相关的意思，请考虑以下两个类：

```
class FourBytes { byte a, b, c, d; }
class FiveBytes { byte a, b, c, d, e; } 
```

在我的 x86 机器上，FourBytes 的一个实例占用 12 个字节（包括开销）。FiveBytes 的一个实例占用 16 个字节。唯一的区别是“e”变量——那么它需要 4 个字节吗？嗯，有点……有点不是。很明显，您可以从 FiveBytes 中删除任何单个变量以将大小恢复到 12 个字节，但这并不意味着*每个*变量都占用 4 个字节（考虑删除所有变量！）。单个变量的成本在这里并不是一个很有意义的概念。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-10-16T06:37:08.273

根据受访者的需要，Marshal.SizeOf 可能会或可能不会给您想要的东西。（在 Jon Skeet 发布他的答案后编辑）。

```
using System;
using System.Runtime.InteropServices;

public class MyClass
{
    public static void Main()
    {
        Int32 a = 10;
        Console.WriteLine(Marshal.SizeOf(a));
        Console.ReadLine();
    }
} 
```

请注意，正如 jkersch 所说，可以使用 sizeof，但不幸的是只能用于值类型。如果你需要一个类的大小，Marshal.SizeOf 是要走的路。

Jon Skeet 阐述了为什么 sizeof 和 Marshal.SizeOf 都不是完美的。我猜被问者需要决定他的问题是否可以接受。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-10-25T13:09:23.663

从 Jon Skeets 在他的回答中的食谱中，我试图制作他所指的助手类。欢迎提出改进建议。

```
public class MeasureSize<T>
{
    private readonly Func<T> _generator;
    private const int NumberOfInstances = 10000;
    private readonly T[] _memArray;

    public MeasureSize(Func<T> generator)
    {
        _generator = generator;
        _memArray = new T[NumberOfInstances];
    }

    public long GetByteSize()
    {
        //Make one to make sure it is jitted
        _generator();

        long oldSize = GC.GetTotalMemory(false);
        for(int i=0; i < NumberOfInstances; i++)
        {
            _memArray[i] = _generator();
        }
        long newSize = GC.GetTotalMemory(false);
        return (newSize - oldSize) / NumberOfInstances;
    }
} 
```

用法：

应该使用生成 T 的新实例的 Func 创建。确保不会每次都返回相同的实例。例如，这会很好：

```
 public long SizeOfSomeObject()
    {
        var measure = new MeasureSize<SomeObject>(() => new SomeObject());
        return measure.GetByteSize();
    } 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-11-14T03:33:19.237

我不得不将其一直归结为 IL 级别，但我最终通过一个非常小的库将这个功能引入了 C#。

[您可以在bitbucket](https://bitbucket.org/earlz/datastructures/src/4d07aca5ecdf7bf96f46992fa063e80cffda1e3d/BareMetal?at=default)获得它（BSD 许可）

示例代码：

```
using Earlz.BareMetal;

...
Console.WriteLine(BareMetal.SizeOf<int>()); //returns 4 everywhere I've tested
Console.WriteLine(BareMetal.SizeOf<string>()); //returns 8 on 64-bit platforms and 4 on 32-bit
Console.WriteLine(BareMetal.SizeOf<Foo>()); //returns 16 in some places, 24 in others. Varies by platform and framework version

...

struct Foo
{
  int a, b;
  byte c;
  object foo;
} 
```

基本上，我所做的是围绕`sizeof`IL 指令编写一个快速的类方法包装器。该指令将获取对对象的引用将使用的原始内存量。例如，如果您有一个 数组`T`，那么该`sizeof`指令会告诉您每个数组元素相隔多少字节。

这与 C# 的运算符极为不同`sizeof`。一方面，C# 只允许纯值类型，因为实际上不可能以静态方式获取其他任何东西的大小。相反，该`sizeof`指令在运行时级别工作。因此，无论在此特定实例期间对类型的引用将使用多少内存，都将返回。

[您可以在我的博客](http://lastyearswishes.com/blog/view/50a30d3bd1f1a5234323b198)上看到更多信息和更深入的示例代码

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-10-25T07:39:19.853

它可以间接完成，无需考虑对齐。引用类型实例的字节数等于服务字段大小 + 类型字段大小。服务字段（32x 每个占用 4 个字节，64x 8 个字节）：

1.  系统块索引
2.  指向方法表的指针
3.  +可选（仅适用于数组）数组大小

因此，对于没有任何文件的类，他的实例在 32x 机器上占用 8 个字节。如果是具有一个字段的类，则在同一个类实例上引用，所以，这个类需要（64x）：

Sysblockindex + pMthdTable + 类参考 = 8 + 8 + 8 = 24 字节

如果是值类型，它没有任何实例字段，因此 in 只取他的字段大小。例如，如果我们有一个带有一个 int 字段的结构，那么在 32x 机器上它只需要 4 个字节的内存。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-16T06:36:31.393

如果您有类型，请使用 sizeof 运算符。它将以字节为单位返回类型的大小。例如

Console.WriteLine(sizeof(int));

将输出：

4

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-11-07T17:02:08.920

# System.Runtime.CompilerServices.Unsafe

利用`System.Runtime.CompilerServices.Unsafe.SizeOf<T>() where T: unmanaged`

*（当不在 .NET Core 中运行时，您需要安装该 NuGet 包）*

[文档](https://docs.microsoft.com/en-us/dotnet/api/system.runtime.compilerservices.unsafe.sizeof)指出：

> 返回给定类型参数的对象的大小。

它似乎`sizeof`像[Earlz 解决方案](https://stackoverflow.com/a/13372626/5185376)一样使用 IL 指令。（[来源](https://stackoverflow.com/questions/47922524/whats-the-difference-between-sizeoft-and-unsafe-sizeoft)）

该`unmanaged`约束在 C# 7.3 中是新的

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-11-14T23:00:37.913

您可以使用方法重载作为确定字段大小的技巧：

```
public static int FieldSize(int Field) { return sizeof(int); }
public static int FieldSize(bool Field) { return sizeof(bool); }
public static int FieldSize(SomeStructType Field) { return sizeof(SomeStructType); } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-03-28T21:09:33.367

最简单的方法是： `int size = *((int*)type.TypeHandle.Value + 1)`

我知道这是实现细节，但 GC 依赖于它，它需要尽可能接近方法表的开始以提高效率，并考虑到 GC 代码的复杂程度，以后没人敢更改它。事实上，它适用于 .net framework+.net core 的每个次要/主要版本。（目前无法测试 1.0）
如果您想要更可靠的方法，请在动态程序集中发出一个结构，该结构`[StructLayout(LayoutKind.Auto)]`具有完全相同的字段以相同的顺序，使用[sizeof](https://docs.microsoft.com/en-us/dotnet/api/system.reflection.emit.opcodes.sizeof?view=netframework-4.7.2) IL 指令获取其大小。您可能希望在 struct 中发出一个静态方法，该方法仅返回此值。然后为对象头添加 2*IntPtr.Size。这应该给你确切的价值。
但是，如果您的类派生自另一个类，则需要分别找到基类的每个大小并再次添加它们 + 2*Inptr.Size 作为标题。您可以通过获取带有`BindingFlags.DeclaredOnly`标志的字段来做到这一点。

# plugins - Eclipse 更新站点 url 的休眠工具插件是什么？

> ID：207596
> 
> 赞同：0
> 
> 时间：2008-10-16T06:35:48.977
> 
> 标签：plugins, eclipse-plugin, hibernate-tools

或者这可能是手动安装的唯一交易。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-16T06:39:24.757

废话 - 它是[http://download.jboss.org/jbosstools/updates/stable](http://download.jboss.org/jbosstools/updates/stable)

# c# - 尝试部署 Web 部件时出错

> ID：207599
> 
> 赞同：2
> 
> 时间：2008-10-16T06:36:45.527
> 
> 标签：c#, sharepoint, web-parts

我刚刚编写了一个新的 Web 部件，现在当我尝试在我的非开发服务器上部署它们时出现此错误：

> 默认命名空间“ [http://schemas.microsoft.com/WebPart/v2](http://schemas.microsoft.com/WebPart/v2) ”是为基本 Web 部件属性保留的命名空间。自定义 Web 部件属性需要唯一的命名空间（通过属性上的 XmlElementAttribute 或类上的 XmlRootAttribute 指定）。

我正在将 Web 部件写入 CAB 文件并使用以下命令部署它们：

```
stsadm -o addwppack -filename web_part_name.CAB -url http://your_url_here -globalinstall -force 
```

一切正常，直到我尝试添加 Web 部件，然后我在弹出窗口中收到此错误。它在我的开发虚拟机上工作得很好......？

任何想法将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-02T17:03:01.687

好吧，看起来您的 webpart 定义文件 si 不知何故损坏了。我这样做是将webpart放入页面然后导出。您可以通过打开 webpart 画廊来做到这一点，它可以位于根网站集的网站设置中并在那里添加您的 webpart。

之后，只需将 webpart 放置到任何页面并在 webpart 设置中使用导出按钮。这将根据您的 webpart 生成 .webpart 或 .dwp 文件（.webpart 是“新”定义，由 MOSS 2007 原生的 webparts 使用，.dwp 用于较旧的 webparts，但这取决于您编写 webpart 的方式）

然后只需将导出的文件包含到您的项目中即可。这种方法至少对我有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T07:28:47.200

这里有点有根据的猜测，但无论如何：-

首先检查您的 Web 部件中是否有这样的 XmlRoot 属性

```
[XmlRoot(Namespace = "Your.Namespace")]
public class YourWebPart: WebPart
{
... 
```

和自定义属性上的 XmlElement 属性

```
 [DefaultValue(0)]
    [WebPartStorage(Storage.Shared)]
    [Browsable(false)]
    [XmlElement(ElementName = "YourProperty")]
    public Int64 YourProperty
    {         
       ...
    } 
```

当 .NET 尝试对 .DWP 文件中的数据进行消毒并在 Web 部件中设置自定义属性时，会发生此错误。

我怀疑该错误可能与命名空间冲突无关，因为 SharePoint 有时倾向于退回到可能是红鲱鱼的错误消息。

我会首先检查您的 .dwp 文件。您是否在那里设置了任何自定义属性，如果有，请删除它们并重新测试。

将 Web 部件代码中的自定义属性一一注释掉，并在每一步重新测试。

我想你会发现其中一个是导致问题的原因——下一个问题到底是为什么！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T07:33:50.640

您是否将您的 webpart 打包为 .webpart 文件？

如果是这种情况，您必须使用新的 v3 命名空间。要使用 v2，您必须将其打包为 .dwp 文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-28T15:24:24.787

是的，您的 Web 部件定义文件（*.dwp 或 *.webpart）可能不正确。把它贴在这里，应该很快就能找到错误。

# java - 来自组件的包装异常

> ID：207608
> 
> 赞同：0
> 
> 时间：2008-10-16T06:41:45.347
> 
> 标签：java, exception

存在这种类型的异常系统，其中组件抛出特定于组件的异常。例如，所有数据访问类都抛出`DataAccessException`.

在这种风格中，我经常发现自己不得不捕获并重新抛出组件特定的异常，因为被调用的方法被定义为`throws Exception`：

```
try {
    int foo = foo();
    if (foo != expectedValue) {
        throw new ComponentException("bad result from foo(): " + foo);
    }
    bar();
}
catch (ComponentException e) { 
    throw e; 
}
catch (Exception e) { 
    throw new ComponentException(e); 
} 
```

你发现自己也在做同样的事情吗？你觉得丑吗？

这个问题不是关于这种风格的有效性，而是在这种风格的约束范围内。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T06:58:34.033

那真是丑陋得要命。我认为，对于这种丑陋的风格没有太多可评论的了。如果您已经拥有使用原因处理不同问题的所有代码，那将起作用。就是这样使用

```
try {
  componentCall();
} catch (ComponentException e) {
  Throwable t = e.getCause();
  //Handle each possible cause
} 
```

与其他方式相比，可维护性更差且更令人困惑，主要的一点是我认为使用它没有任何优势。

鉴于您被限制使用它，我至少会尽量避免无论有无原因都抛出 ComponentException，这使得它比它需要的更加混乱，在您的示例中，我将添加一个 InvalidFooException 并添加它作为通用 ComponentException 的原因。

```
try {
    int foo = foo();
    if (foo != expectedValue) {
        throw new InvalidFooException("bad result from foo(): " + foo);
    }
    bar();
}
catch (Exception e) { 
    throw new ComponentException(e); 
} 
```

[getCause()](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Throwable.html#getCause())旨在用于仅与因果关系而不是语义相关[的异常链。](http://java.sun.com/docs/books/tutorial/essential/exceptions/chained.html)

如果您需要它们区分不同的异常（例如，SQLExecutionException 应该通过与 AccessDeniedException 不同的操作来纠正），那么您的方法不适用（因为在每个 catch 中强制使用 getCause() 以查看需要做什么done 很糟糕，除了在前面捕获正确的异常之外没有任何好处）。

如果所有调用类所要做的就是报告错误并取消，那么包装可能没问题，但我不会这样做，因为它几乎没有什么好处，如果你以后需要区分会让你重写很多东西。

有用的是为相同类型的异常创建[异常层次结构，如下所示：](http://java.sun.com/docs/books/tutorial/essential/exceptions/creating.html)

如果 DataAccessException 是根，那么您可以例如有 DataSourceUnavailableException、InvalidDataSourceException、InvalidDataException，然后您可以决定仅捕获父级（如果操作相同）或分别捕获每个异常。

顺便说一句，为什么你需要这样做？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T08:49:47.817

这样做可能会不那么难看（如果函数 foo() 是声明抛出异常的函数）：

```
int foo;
try {
    foo = foo();
}
catch (Exception e) { 
    throw new ComponentException(e); 
}
if (foo != expectedValue) {
    throw new ComponentException("bad result from foo(): " + foo);
}
bar(); 
```

# javascript - 你最喜欢的兼容 Prototype 框架的 JavaScript 日期选择器是什么？

> ID：207613
> 
> 赞同：7
> 
> 时间：2008-10-16T06:50:47.450
> 
> 标签：javascript, ruby-on-rails, user-interface

每个答案请一个图书馆，以便人们可以单独投票。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T07:00:03.623

[日历日期选择](http://code.google.com/p/calendardateselect/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-16T07:20:17.780

[日期](http://stephencelis.com/projects/timeframe)范围视觉选择的时间范围...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-16T07:06:04.597

[jQuery 的 UI.DatePicker](http://ui.jquery.com/repository/latest/demos/functional/#ui.datepicker)

*（通过 JQuery.noConflict() 兼容原型）*

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-16T08:45:38.810

[Scal](http://scal.fieldguidetoprogrammers.com/)是一个基于 Prototype JS 库的简单的 javascript 日历/日期选择器。

要创建日历，只需使用基本元素和更新回调以及可选参数创建一个 scal 实例：

```
var cal = new scal('samplecal', updateelement, {
  oncalchange: function(d) {
    alert('Calendar Change: ' + d.format('yyyy-mm-dd'));
  }
}); 
```

查看[演示](http://scal.fieldguidetoprogrammers.com/scal-v02-documentation/scal-demo)及其[食谱](http://scal.fieldguidetoprogrammers.com/scal-v02-documentation/scal-cookbook)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-16T08:23:08.120

[Date.js](http://www.datejs.com/)非常酷，尽管从技术上讲它本身并不是一个日期选择器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-16T07:05:31.383

[雅虎！UI 库：日历](http://developer.yahoo.com/yui/calendar/)

> “日历组件是一个 UI 控件，它使用户能够从呈现在单月或多月界面中的图形日历中选择一个或多个日期。日历完全通过脚本生成，无需任何页面刷新即可导航。”
> 
> “您会发现日历控件是对任何日期选择交互的有用且易于实现的增强；您可能还会发现日历的基础类是开始更复杂的直观组织日期界面的好地方-标记信息（如约会、照片、事件等）。”

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-16T09:26:47.260

ExtJS 与 Prototype 配合得很好，并且有一个小部件会不断地被其​​社区扩展。DatePicker 就是其中之一。

演示：[http ://www.lubber.de/extjs/datepickerplus/](http://www.lubber.de/extjs/datepickerplus/)

# asp.net - 如何诊断 IIS 致命通信错误问题

> ID：207617
> 
> 赞同：15
> 
> 时间：2008-10-16T06:52:35.370
> 
> 标签：asp.net, debugging, iis

我有一个客户在 ASP.NET 1.1 中使用 IIS 和我们开发的应用程序。星期一，连续 4 次出现以下错误：

> 为应用程序池“xxxx”提供服务的进程与万维网发布服务发生了致命的通信错误。进程 ID 为“yyyy”。数据字段包含错误号。

关于如何诊断这个的任何想法？[我发现](http://blogs.msdn.com/david.wang/archive/2005/08/29/HOWTO_Understand_and_Diagnose_an_AppPool_Crash.aspx)的唯一链接是关于安装低级调试工具，但在进行这种低级分析之前，我会知道是否有人有更好的想法或合适的替代方案。

问题（据我所见）是客户环境中的问题，因为相同的应用程序安装在至少 20 或 30 台不同服务器上的其他客户站点上，并且不会发生问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-10-27T17:50:52.933

在 IIS 7 上遇到了同样的问题，除了一份很长的报告外，几乎没有什么报告都能正常工作，而且它从未在 IIS7 上工作过（在低规格服务器上很好）。

在应用程序池的高级设置中的 IIS7 上，我**将“启用 32 位应用程序”设置为 true**，并且一切正常

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-02-26T09:09:36.650

我得到了同样的错误，这里有一些更多的细节：

运行：Windows Server 2003、IIS 6.0 / ASP 3.0、2.13 GHz、1 GB 内存

我的网站处于测试阶段，所以我几乎没有任何访问者访问该网站。

根据事件查看器的说法，我每 3 分钟收到 3 次此警告，然后它会停止几个小时。

然后有时我会收到错误：

**为应用程序池“DefaultAppPool”提供服务的进程意外终止。进程 ID 为“3900”。进程退出代码为“0x800703e9”。**

紧随其后的是：

**由于服务于该应用程序池的进程中的一系列故障，应用程序池“DefaultAppPool”被自动禁用。**

然后在浏览网站时会导致“服务不可用”消息。

在阅读了太多关于此问题的帖子后，我执行了以下步骤：

1.  我读到它可能是注册表访问权限，所以我安装了一个监视器并跟踪所有 W3SVC Access Denied 错误并授予许可

2.  我读到 0x800703e9 错误意味着堆栈溢出导致 w3wp.exe 崩溃，我应该安装调试工具并尝试获取内存转储。我这样做了，但没有得到任何转储，所以我安装了一个新的调试工具，但还没有崩溃。

我的网站正在做一些数据挖掘，这让服务器很忙。

结论：

1.  我不知道那里发生了什么......但我知道我的服务器机器的资源速度很慢，所以我要升级并重新安装它，我确信它会解决问题。 ..

2.  这个问题一直在发生，即使我的 .net 代码空闲，因此它是服务器的问题，而不是我的代码。

3.  我认为第一个警告**“服务应用程序池的进程......”** 每隔一段时间就会发生一次，并且时不时会导致应用程序池重新启动，因此附加调试器无济于事 - 进程不断重新启动并且调试器不再有效...我认为 0x800703e9 错误（导致服务不可用）可能在应用程序池重新启动时发生，我猜它需要大量资源并且由于我的机器太慢它得到 0x800703e9 ...如前所述，这是一个堆栈溢出，但我认为它是由资源不足引起的，而不是由无休止的递归引起的。

4.  我认为微软声称是问题的“注册表访问权”是无稽之谈，但我没有得到“服务不可用”，因为它可能会有所帮助（以为我仍然收到警告**“服务应用程序池的进程……”**）。

希望这可以帮助某人...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-15T20:01:14.890

将网站部署到客户端的 Web 服务器时，我遇到了同样的问题。[这篇 Microsoft 支持文章](http://support.microsoft.com/kb/885654)说：

“如果 NT AUTHORITY\NETWORK SERVICE 帐户没有对所需注册表项的权限，则可能会出现此问题。”

解决方法是：“将权限设置为所需的注册表项，然后重新启动 IIS 6.0”。

链接的文章有执行此操作的步骤。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-12T17:56:14.057

我相信您已经知道这一点，但应用程序池仅包含 1.1 应用程序，对吗？我不记得当池因尝试混合框架而死亡时出现的错误（例如 Server Unavailable），但它比我想象的更常见，所以我会仔细检查。

虽然不太可能，但它是从某个地方开始的。

编辑：[这篇](http://support.microsoft.com/kb/885654)知识库文章也有您描述的与注册表权限相关的错误消息，客户端运行的是什么版本的 IIS？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-10-28T07:32:34.083

一个更流行的原因（如我的情况） - Windows 日志之一已满。

# .net - .NET 应用程序是否不受经典指针错误的影响？

> ID：207631
> 
> 赞同：5
> 
> 时间：2008-10-16T06:57:26.000
> 
> 标签：.net

是否存在一些文章或证据表明 .NET 应用程序不受低级错误的影响？

我说的是我们可以在 C++ 应用程序中看到的经典指针错误、内存溢出、来自英特尔[DEP](http://en.wikipedia.org/wiki/NX_bit)的问题等等。

我说的是不使用“不安全”代码的 .NET 应用程序，根据我在这种情况下的经验，唯一的问题可能是内存泄漏或经典编码错误（如堆栈溢出），但我从未见过低水平误差。

有人可以对此发表评论吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-16T07:18:11.933

我会说，通过设计一个纯 .NET 托管的安全应用程序不受攻击，但是......

1.  这只是设计使然
2.  该应用程序也不会执行任何有用的工作——要做到这一点，它必须与一些非托管代码进行互操作——需要大量努力来确保 BCL 不受漏洞利用，但是......

    一种。您仍然可以编写代码来非常有效地破坏您的硬盘驱动器并以此向地球发送垃圾邮件。

    湾。您还可以调用旨在执行您可以从 .NET 应用程序构建的任意本机代码的代码

通常，它不受指针错误和 exec [data] 类型问题的影响，但 .NET 不能不受堆栈或内存溢出的影响——有几个内存泄漏点（无限复活和大对象堆）。

也许这就是您正在寻找的：

“C# 和 .NET CLR 的类型安全” [ftp://ftp.inf.ethz.ch/pub/publications/diss/th17003.pdf](http://ftp://ftp.inf.ethz.ch/pub/publications/diss/th17003.pdf)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T07:05:57.373

尽管托管环境使您的代码不会在内存分配和无效指针方面产生任何低级错误，但如果您的代码使用任何反过来使用操作系统资源的类（例如文件），仍然存在低级错误的风险流、网络连接、线程、Windows 句柄和 COM 对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T07:11:43.430

我个人没有遇到任何与内存管理或芯片组相关的事情，但我看到很多完全出乎意料的异常来自 COMesque 情况（LDAP 是一个糟糕的例子，可能是文件或数据库 i/o），你可能没有声明或者觉得您正在调用“不安全”代码，但仍然遇到您无法控制的低级问题，这些问题只返回晦涩的错误代码......
堆栈溢出很容易。.NET 中没有任何东西可以防止无限递归。有时你会争分夺秒地判断你是先得到堆栈溢出还是在你不断增加的东西中出现值溢出，但是哦，如果你不注意退出条件，它就会发生！
除了一些我什至无法想象的非常疯狂的特殊情况之外，我认为您不可能或至少很有可能遇到您理所当然地处理的大多数低级错误在 C++ 中。
大多数 .NET 内存泄漏发生在有人手动处理垃圾并且不了解 .NET 垃圾收集系统的工作原理时。但是您必须小心使用外部资源的任何事情。但是，我能想到的任何东西要么实现 IDisposable，要么需要 unsafe 关键字。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T07:13:50.647

内存溢出？

首先回答你的问题，当你失忆时，你失忆了。页面文件将提供帮助，直到它们达到最大大小，或者直到磁盘分区已满（当您的磁盘空间不足时，您的磁盘空间不足）。

其次，一堆 .Net 类通过生成内存溢出异常来报告错误，而不是说出真正的问题是什么。这使得调试很痛苦。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-16T07:26:50.433

.NET 中仍然可能存在内存泄漏。它们不经常发生，但是对于足够复杂的对象模型，很容易让一些对象坐在那里，这些对象早就应该由 GC 处理掉。
关于内存问题，.NET 使不犯非托管代码的常见错误变得更容易，但它仍然远未免疫。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-20T20:28:03.557

在非托管框架中，主要存在三种与指针相关的错误：

*   索引超出其分配空间的指针
*   未能释放不再需要的指针
*   使用目标已被释放的指针

像 C++ 这样的语言可以很好地解决第一个问题，并且在不需要使用`new`和的情况下可以很大程度上解决其他两个问题`delete`。`new`但是，如果不使用and ，很多事情都无法完成`delete`，并且使用这些会产生后两个问题发生的可能性。如果偶尔出现第二个问题，该程序可能会继续存在。在最坏的情况下，它会（可能逐渐）耗尽内存。然而，第三个问题要严重得多。不正确地使用目标已被释放的指针会导致肆无忌惮的恶作剧——实际上不知道结果会发生什么。

GC 管理框架的存在主要是为了解决第三个问题。它们通常也解决了第一个问题，但对于该目的不是必需的。他们还设法主要解决了第二个问题，但也没有必要“主要”解决该问题。然而，对于第三个问题，他们将“大部分解决”变成了“完全解决”，至少就 C++ 中可能发生的肆无忌惮的恶作剧而言。托管框架不会阻止代码尝试使用超过其使用寿命结束的对象，但它可以控制这种尝试的效果。

# workflow - 工作流规则集对话框

> ID：207633
> 
> 赞同：2
> 
> 时间：2008-10-16T06:58:03.270
> 
> 标签：workflow, workflow-foundation, rules

我们能否以某种方式扩展 RuleSetDialog 类并在我们的 Windows 应用程序中托管？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-16T10:21:59.177

您不能扩展 RuleSetDialog 类（因为它是密封的），但您可以在您的应用程序中托管它：

*   [RuleSetDialog 类](http://msdn.microsoft.com/en-us/library/system.workflow.activities.rules.design.rulesetdialog.aspx)
*   [托管工作流规则设计器](http://melgrubb.spaces.live.com/blog/cns!A44BB98A805C8996!182.entry)
*   [通过 Windows Workflow Foundation 的规则引擎](http://blogs.vertigo.com/personal/dbritton/Blog/Lists/Posts/Post.aspx?List=c3cd45fa-ec9d-4874-bfe3-5c6ffe78629a&ID=16)
*   [在 WF RuleSetDialog 中过滤 Intellisense 列表](http://jonkruger.com/blog/2008/02/03/filtering-intellisense-lists-in-the-wf-rulesetdialog/)
*   [泛型类型的 Windows Workflow Foundation 规则](http://blogs.microsoft.co.il/blogs/bursteg/archive/2007/04/04/11369.aspx)
*   [调整 RuleSetDialog 以调整大小](http://blog.tfanshteyn.com/2007/08/tweaking-rulesetdialog-to-resize.html)
*   [PowerShell 规则引擎：操作方法技术细节](http://igorshare.wordpress.com/2008/02/15/powershell-rules-engine-how-to-technical-details/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-25T15:40:57.880

虽然确实不完全支持扩展对话框，但您*可以*摆脱一些自定义。在以前的项目中，我能够在运行时隐藏和重新排列一些对话框控件。

```
var dialog = new RuleSetDialog(activityType, null, ruleset);
dialog.Controls["headerTextLabel"].Visible = false;
dialog.Controls["pictureBoxHeader"].Visible = false;

...

var ruleGroupBox = dialog.Controls["ruleGroupBox"];
ruleGroupbox.Top -= 46;

... etc. 
```

启动反射器并四处寻找。没有什么可以阻止您隐藏和移动控件来自定义它。您甚至可以将控件添加到组框，重新连接按钮处理程序，或者根据自己的喜好完全重新排列表单。这有点手动，但可以完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-22T15:44:31.913

你可以通过一点点hack来完全做到这一点：将智能文本框内部控件与 System.Workflow.Activities.Rules.Design 命名空间分开......然后你几乎可以用它做任何事情。分离在这里意味着通常的：创建一个包装器（恰好是一个文本框控件的适配器），在解决一些依赖项之后实例化（最坏的情况是您可以隐藏原始规则编辑器、解析器等......）。

# java - 如何对使用 ProcessBuilder 和 Process 的 Java 方法进行单元测试？

> ID：207636
> 
> 赞同：14
> 
> 时间：2008-10-16T07:01:30.517
> 
> 标签：java, unit-testing, mocking, jmockit

我有一个 Java 方法，它使用 ProcessBuilder 启动一个进程，并将其输出通过管道传输到一个字节数组中，然后在进程完成时返回它的字节数组。

伪代码：

```
ProcessBuilder b = new ProcessBuilder("my.exe")
Process p = b.start();
... // get output from process, close process 
```

对这种方法进行单元测试的最佳方法是什么？我还没有找到模拟 ProcessBuilder 的方法（它是最终的），即使使用非常棒的[JMockit](http://jmockit.org)，它也会给我一个 NoClassDefFoundError：

```
java.lang.NoClassDefFoundError: test/MockProcessBuilder
    at java.lang.ProcessBuilder.<init>(ProcessBuilder.java)
    at mypackage.MyProcess.start(ReportReaderWrapperImpl.java:97)
    at test.MyProcessTest.testStart(ReportReaderWrapperImplTest.java:28) 
```

有什么想法吗？

* * *

**答案**- 正如 Olaf 建议的那样，我最终将这些行重构为一个界面

```
Process start(String param) throws IOException; 
```

我现在将这个接口的一个实例传递给我想要测试的类（在它的构造函数中），通常使用带有原始行的默认实现。当我想测试时，我只需使用接口的模拟实现。就像一个魅力，虽然我想知道我是否在这里过度接口......

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-16T07:33:20.763

保护自己免受被嘲笑的课程。为执行您真正想要的操作（例如隐藏完全涉及外部进程的事实）或仅为 Process 和 ProcessBuilder 创建一个接口。

您不想测试 ProcessBuilder 和 Process 是否有效，只是您可以使用它们的输出。当您创建一个接口时，一个简单的实现（可以轻松检查）委托给 ProcessBuilder 和 Process，另一个实现模拟这种行为。稍后，您甚至可能拥有另一个实现，无需启动另一个进程即可满足您的需要。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-21T22:51:50.700

使用较新版本的 JMockit (0.98+)，您应该能够轻松地模拟 JRE 类，例如 Process 和 ProcessBuilder。因此，无需仅为测试创建接口......

完整示例（使用 JMockit 1.16）：

```
public class MyProcessTest
{
    public static class MyProcess {
        public byte[] run() throws IOException, InterruptedException {
            Process process = new ProcessBuilder("my.exe").start();
            process.waitFor();

            // Simplified example solution:
            InputStream processOutput = process.getInputStream();
            byte[] output = new byte[8192];
            int bytesRead = processOutput.read(output);

            return Arrays.copyOf(output, bytesRead);
        }
   }

    @Test
    public void runProcessReadingItsOutput(@Mocked final ProcessBuilder pb)
        throws Exception
    {
        byte[] expectedOutput = "mocked output".getBytes();
        final InputStream output = new ByteArrayInputStream(expectedOutput);
        new Expectations() {{ pb.start().getInputStream(); result = output; }};

        byte[] processOutput = new MyProcess().run();

        assertArrayEquals(expectedOutput, processOutput);
    }
} 
```

# php - PHP开发环境最佳实践

> ID：207642
> 
> 赞同：13
> 
> 时间：2008-10-16T07:05:26.860
> 
> 标签：php, eclipse, ide

当涉及到 PHP 开发环境时，有很多选择，您必须自己将它们拼凑在一起。

我想知道是否有人提出了他们认为的理想设置，可以让您摆脱困境并让您发展。

现在我从命令行使用 vim 和 svn。我编写脚本来管理构建，但我正在考虑研究 Phing。

我喜欢 vim，但我正在认真考虑使用 PHP 插件尝试 Eclipse，因为我认为它使常见的 SVN 选项更容易一些（在项目中移动文件）。

支持数据库持续集成的东西将是一个主要的优势！

更新：只是想强调以前的路线。我意识到一些框架会对此有所帮助，但我不使用框架。是否有一些简单的模块（是否包含在 IDE 中）可以让我轻松地将我的数据库模式/数据绑定到颠覆修订，让我回滚和转发、标记、分支等？

对编辑以外的事情有什么意见吗？例如：构建、管理登台/生产/开发环境、自动化测试和基于 SVN 提交构建等。理想情况下，我们可以将这篇文章作为“Go to Whoah”来建立专业的 PHP 团队开发环境。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-16T07:23:43.670

我建议使用完整的特色 IDE，例如 PDT（eclipse PHP 项目），它为您提供：调试（使用 Xdebug 或 ZendDebugger）

SVN/CVS 非常方便的集成

数据库集成（DTP 插件）

等等，基于 PDT 和 eclipse 插件的功能

如果你有一些钱可以花，我认为 Zend Studio For eclipse 值得。它为您提供更好的调试、PHPUnit 集成、ZendFramewrok 支持、重构和远程系统支持（ftp、ssh 等）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-16T08:02:43.857

我正在尝试使用[Netbeans 6.5 PHP 捆绑包](http://download.netbeans.org/netbeans/6.5/beta/)，并且非常喜欢它。我发现在其中进行调试比在 Eclipse PDT 中进行调试要简单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T07:28:29.353

我也很喜欢 vim，曾经和你使用相同的环境进行开发。这些天来，尽管我发现带有用于 SVN 集成的 Subclipse 的 Eclipse PDT 非常宝贵。XDebug 也很棒——不再`var_dump();exit;`用于调试。

迁移到 Eclipse 的 vim 粉丝的最佳插件之一：[viPlugin](http://www.satokar.com/viplugin/)。在 Eclipse 中进行 vi 键绑定非常值得支付令牌许可费。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-17T16:10:56.820

如果您在命令行中工作，使用[Git 的 SVN 模块](http://git-scm.com/docs/git-svn)可以减轻大部分 SVN 的痛苦——它会自动处理删除和移动。

GUI 前端（kgit 或 qgit）提供了一个非常直观的历史浏览器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-04T15:12:17.070

我个人喜欢 AptanaStudio 预打包所有出色的 Eclipse 模块的方式，您需要拥有一个非常流畅的 PHP 开发环境

# asp.net - 如何处理 VB 脚本中的错误

> ID：207646
> 
> 赞同：1
> 
> 时间：2008-10-16T07:06:29.540
> 
> 标签：asp.net, vbscript

我有一个 VB 脚本。我需要将错误信息记录在一个文件中。我需要记录所有信息，例如错误号错误描述以及错误发生在哪个子例程中。

请提供一些代码

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T10:04:26.780

如果您使用的是 VBScript，则可以使用[FileSystemObject](http://www.w3schools.com/asp/asp_ref_filesystem.asp)和[Error对象。](http://www.devguru.com/technologies/vbscript/QuickRef/err.html)

将以下内容粘贴到 error.vbs 中并运行它。它会抛出一个错误，然后将详细信息记录到名为 c:\errors.log 的文件中

```
Option Explicit

On Error Resume Next ' Potential error coming up
Dim MyArray(5)
MyArray(7) = "BWA HA HA"
If Err.Number <> 0 Then
    LogError(Err)
    Err.Clear
End If
On Error Goto 0 ' Stop looking for errors 

Sub LogError(Details)
    Dim fs : Set fs = CreateObject("Scripting.FileSystemObject")
    Dim logFile : Set logFile = fs.OpenTextFile("c:\errors.log", 8, True)
    logFile.WriteLine(Now() & ": Error: " & Details.Number & " Details: " & Details.Description)
End Sub 
```

如果您使用的是 ASP 页面，那么您可以使用[ASPError](http://msdn.microsoft.com/en-us/library/ms524942.aspx)来获取有关错误的更详细信息，例如行号等（请记住将 CreateObject 替换为 Server.CreateObject）。

**编辑：** 要获取导致 .vbs 脚本中错误的行号，您可以将其作为参数添加到子例程中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-20T11:05:15.517

VBScript 不支持错误 goto 标签。以下代码将永远无法工作-：

On Error GoTo HandleError '' on error 将代码跳转到指定信号

暗淡 aa = 15 / 0

GoTo Finish '' 跳过错误

处理句柄错误：

暗淡消息集

msg = Err.Description & vbCrLf & Err.Number

MsgBox msgFinish:'' sciprt 结束

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-12-05T01:13:06.903

将您的整个子程序或函数放在一个 do 循环（或其他循环）中。将错误处理放在 do 循环之外

```
private sub BucketList()
do while 1=1
  ClimbMountain(top)
    if err.Number <> 0 then exit do
  SwimOcean(deep)
    if err.Number <> 0 then exit do
  GiveErrorHandlingToVBS(isNeverGoingToHappen)
    if err.Number <> 0 then exit do

  exit do
loop

'Error Handler
if err.Number <> 0 then
  'handle error
end if

end sub 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2008-10-16T07:35:02.103

对于 VBScript 中的错误处理，使用“On Error”子句。有3种方法，如何处理错误：

*   On Error Resume Next '' 忽略错误
*   On Error GoTo 0 '' 删除错误处理
*   On Error GoTo HandleError '' on error 将代码跳转到指定信号

样品：

```
On Error Resume Next '' ignore errors
SomeIgnorableFunction()

On Error GoTo 0 '' removes error ignoring
SomeImportantFunction()

On Error GoTo HandleError '' on error will code jump to specified signal
Dim a
a = 15 / 0

GoTo Finish '' skips error handling

HandleError:
Dim msg
Set msg = Err.Description & vbCrLf & Err.Number
MsgBox msg

Finish:
'' there is end of sciprt 
```

# logging - .NET Compact Framework 的日志库？

> ID：207650
> 
> 赞同：3
> 
> 时间：2008-10-16T07:08:40.127
> 
> 标签：logging, compact-framework, log4net, nlog

任何支持 .NET 紧凑框架的好的日志库？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-16T07:13:06.500

log4net 是一个不错的选择，我将它用于所有项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T07:25:14.620

Nlog 也是如此。紧凑型网络中有一些功能不可用（例如开箱即用的异常实例记录）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T07:11:37.737

log4net实际上支持compact framework 1.0，会试试看！

[在这里](http://logging.apache.org/log4net/release/framework-support.html)阅读更多

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T12:03:45.363

[NLog](http://sourceforge.net/project/showfiles.php?group_id=116456&package_id=128559)还支持 .NET Compact Framework。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-03T00:44:24.870

Log4net 是最好的选择，但它没有 Zip 日志功能。

# java - 商业 Java 静态分析工具与免费的相比如何？

> ID：207652
> 
> 赞同：34
> 
> 时间：2008-10-16T07:10:02.620
> 
> 标签：java, open-source, static-analysis, commercial-application

我熟悉一些可用于 Java 的免费静态分析工具，例如 FindBugs 和 PMD。我想知道的是 Klocwork 和 Coverity 等商业产品如何与这些产品相抗衡。他们的优势和劣势是什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-31T22:06:36.630

我们使用一套开源和商业静态分析工具。不同的工具会发现不同类型的错误，其中一些针对较低的误报率进行了调整，但可能会遗漏一些真正的问题。

根据我的经验，Findbugs 在发现真正的问题方面做得很好，尤其是当你按照他们的团队建议关注正确性错误时。最近 Findbugs 的开发人员也添加了一些基本的安全漏洞检查。Coverity 的误报率很低，尤其是在您不打开他们的实验检查器的情况下，Coverity Prevent 包含一个用于趋势/集群分析的良好跟踪数据库。我还不相信他们的线程检查器（静态或动态）工作 - 至少他们没有发现任何对我们感兴趣的东西。Klocwork Developer for Java 返回更高的误报率，但我们发现它们具有这些工具中最强的安全检查。因此，这取决于您的优先级是质量检查（Findbugs、Coverity）还是安全漏洞分析（Klocwork 或 Fortify）。

最近与 NIST 进行的一个名为“SATE：静态分析工具展示”的项目审查了各种不同的工具及其基本方法。 [https://samate.nist.gov/index.php/SATE.html](https://samate.nist.gov/index.php/SATE.html) 以及其他对该项目的引用，例如 OWASP。一般的发现是，不同的工具有不同的优势和劣势，所以如果你想彻底完成工作，可以使用多个。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-16T08:04:35.117

我建议您尝试使用开源软件质量管理工具[SONAR ，该工具致力于持续分析和测量源代码质量。](http://sonar.codehaus.org/)该软件从代码分析工具中获取结果，整合结果并让您访问用户友好的界面。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-16T07:36:33.050

您肯定会在*商业*静态分析工具中找到的一个功能（至少在 2008 年，在 OP 时代，您不会在免费软件分析工具中轻易找到）是报告：***随着时间的推移***
**测量软件质量趋势**

 *正如这个[关于代码度量](https://stackoverflow.com/questions/195887/what-is-the-fascination-with-code-metrics#195932)的问题所解释的那样，任何静态代码分析本身并不总是有意义的，因为您可以：

*   太多“缺陷”无法修复
*   报告的缺陷类别过多

您需要能够进行一些分类，并且您需要检查特定缺陷是否随着时间的推移越来越少地发生，以帮助您确定要修复的优先级。

对于具有数千个类的遗留项目尤其如此：您不会像这样在没有*充分*理由的情况下修复许多文件的缺陷。这个原因可以从免费软件工具所找不到的良好报告和趋势分析中推断出来。

* * *

更新：从 2012 年（4 年后）开始，Sonar（现在在 2018 年命名为“ [SonarQube](https://www.sonarqube.org/) ” [）在其 4.x 和 5.x 系列中的“历史信息”（又名“时间机器”）](https://docs.sonarqube.org/display/SONARQUBE53/Historical+Information)。请注意，[SonarQube 6.1](https://docs.sonarqube.org/display/SONAR/Release+6.1+Upgrade+Notes)（2016 年 9 月）中删除了
这些[项目仪表板：请参阅](https://jira.sonarsource.com/browse/SONAR-7915)[此线程](https://groups.google.com/d/msg/sonarqube/Ir1sE6OVW40/64rLvZJFDAAJ)。 这些仪表板需要[通过自定义页面](https://docs.sonarqube.org/display/DEV/Creating+a+Page)手动重新创建。[SonarQube 6.5](https://groups.google.com/d/msg/sonarqube/1ThRpLMAw1s/CLJBZV9rAQAJ)使用活动页面恢复了一些仪表板，该页面获取（几个预定义的和一个可自定义的）图表来显示项目的演变。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-22T14:04:39.613

我没有使用 Findbugs 或 PMD 的直接经验，但遇到很多人将它们与 Klocwork 和 Coverity 进行比较。

我对反馈的一般看法是：

Findbugs 和 PMD 更“工具化”。您将在桌面上运行的东西的类型。它发现了广泛的潜在问题，但往往是嘈杂的，这意味着误报和“我不在乎”的品种。它确实找到了一些好东西。我听到关于其长期使用的不同反馈。有些人认为免费工具的投资回报率是无限的，但是误报确实要付出代价。

毫不奇怪，花钱的 Klocwork 和 Coverity 往往更面向解决方案，也可以更好地扩展以与团队合作，拥有更高效、更易于使用的 UI，而且噪音更小。似乎他们的分析正在进行更深入的检查，因此如果您进行并排比较，则会得出更好的结果。在整个团队中采用工具时，您会对使用工具产生不同程度的热情，而噪音因素是阻碍广泛采用的一个大问题。当然还有一些事情，比如有支持来支持你，等等。

一般来说，由于 Findbugs 和 PMD 是免费的，因此您将其视为第一选择。许多公司看到了价值并选择 Coverity 或 Klocwork 作为长期解决方案，尽管我也看到运行 Findbugs 和 PMD。他们倾向于找到不同的东西，所以如果你的目标是尽可能多地找到和修复，最好将两者结合起来。

披露：我为 Coverity 的合作伙伴 Code Integrity Solutions (codeintegritysolutions.com) 工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-16T07:18:56.660

这是商业分析工具列表：[http ://en.wikipedia.org/wiki/List_of_tools_for_static_code_analysis#Java_2](http://en.wikipedia.org/wiki/List_of_tools_for_static_code_analysis#Java_2)

Coverity 有几个工具： http:
[//www.coverity.com/html/coverity-readiness-manager-java.html](http://www.coverity.com/html/coverity-readiness-manager-java.html)：这应该与 findbugs 和 PMD 相当，但具有更好的展示

防止： http: [//www.coverity.com/html/prevent-for-java.html](http://www.coverity.com/html/prevent-for-java.html)：低误报。

线程分析器： http: [//www.coverity.com/html/coverity-thread-analyzer-java.html](http://www.coverity.com/html/coverity-thread-analyzer-java.html)：这是大多数开源工具所没有的。

# delphi - Vista中的文字转语音

> ID：207653
> 
> 赞同：5
> 
> 时间：2008-10-16T07:10:46.473
> 
> 标签：delphi, windows-vista, text-to-speech

我通过在 2000/NT/XP 中使用 Delphi 创建 OLE 对象来做到这一点，如下所示：

```
Voice := CreateOLEObject('SAPI.SpVoice');
Voice.speak(...) 
```

但这在 Vista 中不起作用，我怎样才能让我的程序在 Vista 中简单地说一些文本？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-16T08:00:19.180

我刚刚尝试使用以下代码（Vista Home Premium 上的 D2009），它可以工作！

```
unit Unit1;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls, ComObj;

type
  TForm1 = class(TForm)
    Button1: TButton;
    procedure Button1Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}

procedure TForm1.Button1Click(Sender: TObject);
var
  Voice: Variant;
begin
  Voice := CreateOLEObject('SAPI.SpVoice');
  Voice.speak('Hello World');
end;

end. 
```

仅供参考，Brian Long有[一篇关于在 Delphi 编程中使用语音的好论文...](http://www.blong.com/Conferences/DCon2002/Speech/SAPI51/SAPI51.htm)

* * *

**（非常）延迟更新：**

为什么它可能无法在 Vista 中运行并在 IDE 之外给出 EZeroDivide 异常，请参阅另一个 SO 问题：[Delphi SAPI Text-To-Speech](https://stackoverflow.com/questions/3032739/delphi-sapi-text-to-speech)

# c++ - 以二进制模式将 utf16 写入文件

> ID：207662
> 
> 赞同：12
> 
> 时间：2008-10-16T07:17:39.830
> 
> 标签：c++, unicode, utf-16

我正在尝试以二进制模式将 wstring 写入文件，但我认为我做错了。这是我尝试过的：

```
ofstream outFile("test.txt", std::ios::out | std::ios::binary);
wstring hello = L"hello";
outFile.write((char *) hello.c_str(), hello.length() * sizeof(wchar_t));
outFile.close(); 
```

在例如 Firefox 中打开 test.txt 并将其编码设置为 UTF16，它将显示为：

嘿嘿嘿</p>

谁能告诉我为什么会这样？

**编辑：**

在十六进制编辑器中打开文件我得到：

```
FF FE 68 00 00 00 65 00 00 00 6C 00 00 00 6C 00 00 00 6F 00 00 00 
```

看起来我因为某种原因在每个字符之间得到了两个额外的字节？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-16T12:56:58.117

在这里，我们遇到了很少使用的语言环境属性。如果您将字符串输出为字符串（而不是原始数据），您可以让语言环境自动神奇地进行适当的转换。

**注意**此代码不考虑 wchar_t 字符的 edianness。

```
#include <locale>
#include <fstream>
#include <iostream>
// See Below for the facet
#include "UTF16Facet.h"

int main(int argc,char* argv[])
{
   // construct a custom unicode facet and add it to a local.
   UTF16Facet *unicodeFacet = new UTF16Facet();
   const std::locale unicodeLocale(std::cout.getloc(), unicodeFacet);

   // Create a stream and imbue it with the facet
   std::wofstream   saveFile;
   saveFile.imbue(unicodeLocale);

   // Now the stream is imbued we can open it.
   // NB If you open the file stream first. Any attempt to imbue it with a local will silently fail.
   saveFile.open("output.uni");
   saveFile << L"This is my Data\n";

   return(0);
} 
```

文件：UTF16Facet.h

```
 #include <locale>

class UTF16Facet: public std::codecvt<wchar_t,char,std::char_traits<wchar_t>::state_type>
{
   typedef std::codecvt<wchar_t,char,std::char_traits<wchar_t>::state_type> MyType;
   typedef MyType::state_type          state_type;
   typedef MyType::result              result;

   /* This function deals with converting data from the input stream into the internal stream.*/
   /*
    * from, from_end:  Points to the beginning and end of the input that we are converting 'from'.
    * to,   to_limit:  Points to where we are writing the conversion 'to'
    * from_next:       When the function exits this should have been updated to point at the next location
    *                  to read from. (ie the first unconverted input character)
    * to_next:         When the function exits this should have been updated to point at the next location
    *                  to write to.
    *
    * status:          This indicates the status of the conversion.
    *                  possible values are:
    *                  error:      An error occurred the bad file bit will be set.
    *                  ok:         Everything went to plan
    *                  partial:    Not enough input data was supplied to complete any conversion.
    *                  nonconv:    no conversion was done.
    */
   virtual result  do_in(state_type &s,
                           const char  *from,const char *from_end,const char* &from_next,
                           wchar_t     *to,  wchar_t    *to_limit,wchar_t*    &to_next) const
   {
       // Loop over both the input and output array/
       for(;(from < from_end) && (to < to_limit);from += 2,++to)
       {
           /*Input the Data*/
           /* As the input 16 bits may not fill the wchar_t object
            * Initialise it so that zero out all its bit's. This
            * is important on systems with 32bit wchar_t objects.
            */
           (*to)                               = L'\0';

           /* Next read the data from the input stream into
            * wchar_t object. Remember that we need to copy
            * into the bottom 16 bits no matter what size the
            * the wchar_t object is.
            */
           reinterpret_cast<char*>(to)[0]  = from[0];
           reinterpret_cast<char*>(to)[1]  = from[1];
       }
       from_next   = from;
       to_next     = to;

       return((from > from_end)?partial:ok);
   }

   /* This function deals with converting data from the internal stream to a C/C++ file stream.*/
   /*
    * from, from_end:  Points to the beginning and end of the input that we are converting 'from'.
    * to,   to_limit:  Points to where we are writing the conversion 'to'
    * from_next:       When the function exits this should have been updated to point at the next location
    *                  to read from. (ie the first unconverted input character)
    * to_next:         When the function exits this should have been updated to point at the next location
    *                  to write to.
    *
    * status:          This indicates the status of the conversion.
    *                  possible values are:
    *                  error:      An error occurred the bad file bit will be set.
    *                  ok:         Everything went to plan
    *                  partial:    Not enough input data was supplied to complete any conversion.
    *                  nonconv:    no conversion was done.
    */
   virtual result do_out(state_type &state,
                           const wchar_t *from, const wchar_t *from_end, const wchar_t* &from_next,
                           char          *to,   char          *to_limit, char*          &to_next) const
   {
       for(;(from < from_end) && (to < to_limit);++from,to += 2)
       {
           /* Output the Data */
           /* NB I am assuming the characters are encoded as UTF-16.
            * This means they are 16 bits inside a wchar_t object.
            * As the size of wchar_t varies between platforms I need
            * to take this into consideration and only take the bottom
            * 16 bits of each wchar_t object.
            */
           to[0]     = reinterpret_cast<const char*>(from)[0];
           to[1]     = reinterpret_cast<const char*>(from)[1];

       }
       from_next   = from;
       to_next     = to;

       return((to > to_limit)?partial:ok);
   }
}; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-16T07:47:34.183

我怀疑 sizeof(wchar_t) 在您的环境中为 4 - 即它正在写出 UTF-32/UCS-4 而不是 UTF-16。这肯定是十六进制转储的样子。

这很容易测试（只需打印出 sizeof(wchar_t)），但我很确定这是怎么回事。

要从 UTF-32 wstring 转换为 UTF-16，您需要应用适当的编码，因为代理对开始发挥作用。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-09-20T07:45:14.523

如果您使用`C++11`标准，这很容易（因为有很多额外的包含`"utf8"`可以永远解决这个问题）。

但是如果你想使用旧标准的多平台代码，你可以使用这种方法来编写流：

1.  [阅读有关流的 UTF 转换器的文章](http://www.codeproject.com/Articles/38242/Reading-UTF-8-with-C-streams)
2.  `stxutif.h`从上面的来源 添加到您的项目
3.  以 ANSI 模式打开文件并将 BOM 添加到文件的开头，如下所示：

    ```
    std::ofstream fs;
    fs.open(filepath, std::ios::out|std::ios::binary);

    unsigned char smarker[3];
    smarker[0] = 0xEF;
    smarker[1] = 0xBB;
    smarker[2] = 0xBF;

    fs << smarker;
    fs.close(); 
    ```

4.  然后打开文件`UTF`并在那里写下你的内容：

    ```
    std::wofstream fs;
    fs.open(filepath, std::ios::out|std::ios::app);

    std::locale utf8_locale(std::locale(), new utf8cvt<false>);
    fs.imbue(utf8_locale); 

    fs << .. // Write anything you want... 
    ```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-22T11:16:56.130

在使用 wofstream 和上面定义的 utf16 方面的 Windows 上失败，因为 wofstream 将值 0A 的所有字节转换为 2 个字节 0D 0A，这与您如何传递 0A 字节，'\x0A'，L'\x0A'， L'\x000A'、'\n'、L'\n' 和 std::endl 都给出相同的结果。在 Windows 上，您必须以二进制模式使用 ofstream（不是 wofsteam）打开文件，并像在原始帖子中一样写入输出。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-09T02:59:52.570

提供的`Utf16Facet`不适`gcc`用于大字符串，这是对我有用的版本...这样文件将保存在`UTF-16LE`. 对于`UTF-16BE`，只需将 and 中的赋值反转`do_in`，`do_out`例如`to[0] = from[1]`and`to[1] = from[0]`

```
#include <locale>
#include <bits/codecvt.h>

class UTF16Facet: public std::codecvt<wchar_t,char,std::char_traits<wchar_t>::state_type>
{
   typedef std::codecvt<wchar_t,char,std::char_traits<wchar_t>::state_type> MyType;
   typedef MyType::state_type          state_type;
   typedef MyType::result              result;

   /* This function deals with converting data from the input stream into the internal stream.*/
   /*
    * from, from_end:  Points to the beginning and end of the input that we are converting 'from'.
    * to,   to_limit:  Points to where we are writing the conversion 'to'
    * from_next:       When the function exits this should have been updated to point at the next location
    *                  to read from. (ie the first unconverted input character)
    * to_next:         When the function exits this should have been updated to point at the next location
    *                  to write to.
    *
    * status:          This indicates the status of the conversion.
    *                  possible values are:
    *                  error:      An error occurred the bad file bit will be set.
    *                  ok:         Everything went to plan
    *                  partial:    Not enough input data was supplied to complete any conversion.
    *                  nonconv:    no conversion was done.
    */
   virtual result  do_in(state_type &s,
                           const char  *from,const char *from_end,const char* &from_next,
                           wchar_t     *to,  wchar_t    *to_limit,wchar_t*    &to_next) const
   {

       for(;from < from_end;from += 2,++to)
       {
           if(to<=to_limit){
               (*to)                               = L'\0';

               reinterpret_cast<char*>(to)[0]  = from[0];
               reinterpret_cast<char*>(to)[1]  = from[1];

               from_next   = from;
               to_next     = to;
           }
       }

       return((to != to_limit)?partial:ok);
   }

   /* This function deals with converting data from the internal stream to a C/C++ file stream.*/
   /*
    * from, from_end:  Points to the beginning and end of the input that we are converting 'from'.
    * to,   to_limit:  Points to where we are writing the conversion 'to'
    * from_next:       When the function exits this should have been updated to point at the next location
    *                  to read from. (ie the first unconverted input character)
    * to_next:         When the function exits this should have been updated to point at the next location
    *                  to write to.
    *
    * status:          This indicates the status of the conversion.
    *                  possible values are:
    *                  error:      An error occurred the bad file bit will be set.
    *                  ok:         Everything went to plan
    *                  partial:    Not enough input data was supplied to complete any conversion.
    *                  nonconv:    no conversion was done.
    */
   virtual result do_out(state_type &state,
                           const wchar_t *from, const wchar_t *from_end, const wchar_t* &from_next,
                           char          *to,   char          *to_limit, char*          &to_next) const
   {

       for(;(from < from_end);++from, to += 2)
       {
           if(to <= to_limit){

               to[0]     = reinterpret_cast<const char*>(from)[0];
               to[1]     = reinterpret_cast<const char*>(from)[1];

               from_next   = from;
               to_next     = to;
           }
       }

       return((to != to_limit)?partial:ok);
   }
}; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-16T07:30:13.517

您应该在[WinHex](http://www.download.com/WinHex/3000-2352_4-10057691.html)等十六进制编辑器中查看输出文件，以便查看实际的位和字节，以验证输出实际上是 UTF-16。把它贴在这里，让我们知道结果。这将告诉我们是责怪 Firefox 还是你的 C++ 程序。

但在我看来，您的 C++ 程序可以正常工作，而 Firefox 没有正确解释您的 UTF-16。UTF-16 要求每个字符占用两个字节。但是 Firefox 打印的字符数量是它应该打印的两倍，因此它可能试图将您的字符串解释为 UTF-8 或 ASCII，通常每个字符只有 1 个字节。

当您说“编码设置为 UTF16 的 Firefox”时，您是什么意思？我怀疑这项工作是否有效。

# linq - ExpressionType.Quote

> ID：207679
> 
> 赞同：11
> 
> 时间：2008-10-16T07:23:55.353
> 
> 标签：linq, expression

这个 UnaryExpression 的用途是什么，应该如何使用？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-25T22:46:42.860

它接受一个`Expression`对象并将其与另一个`Expression`. 例如，如果你有一个 lambda 表达式，在树中使用它会创建一个 lambda 表达式，但使用它引用会在输出中产生一个 lambda 表达式。

```
method                                 | resulting object                   | after compile
--------------------------------------------------------------------------------------------------
Expression.Lambda(...                  | Expression of lambda               | Lambda
Expression.Quote(Expression.Lambda(... | Expression of expression of lambda | Expression of lambda 
```

# ide - 最好的移动应用程序开发工具/环境？

> ID：207690
> 
> 赞同：4
> 
> 时间：2008-10-16T07:30:42.097
> 
> 标签：ide, java-me, mobile

我想开发一个移动应用程序，它能够访问它运行的移动设备的所有功能（相机、文件、电话和网络连接）。我打算构建一系列应用程序，每个应用程序都有一个特定的功能要执行，而不是一个具有大量功能集的单个应用程序。我的编程背景是 C、C# 和 Web 应用程序。

用于执行此操作的最佳工具集是什么？我已经研究过使用 NetBeansIDE 创建一个使用 LWUIT 的 Java ME 应用程序——这看起来很有希望，但是有什么警告呢？

我想瞄准尽可能多的移动设备。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-16T15:19:20.170

J2ME 是面向大众的方式，无论是在消费者市场还是在商业市场。从消费者的角度来看，世界上大多数手机都支持 J2ME。从商业角度来看，世界上大多数智能手机都支持 J2ME。

诺基亚拥有全球智能手机市场（以及整个市场）40% 的份额。紧随其后的是黑莓，占有 13% 的份额。两者在他们的设备上都有 J2ME 的标准实现（尽管 Blackberry 也有 Java 的专有版本）。最重要的是，大多数运行 Windows Mobile 的设备也带有 JVM（我最近开发了一款游戏，最初针对的是索尼爱立信 W810i，它在我的 HTC Tilt 的 JVM 上完美运行）。再加上 Android 有一个 Java SDK 的事实，而您真正错过的唯一部分是仅限 BREW 的手机和 iPhone。

我不是 J2ME 的大力支持者。我只知道在过去 3 年中，所有其他移动平台都从我的生活中消失了，因为公司只针对行业的 J2ME 部分在财务上是有意义的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-21T22:08:10.043

您面临着移动开发的常见主要问题：仅使用一种编程语言针对尽可能多的手机意味着使用 J2ME，这并不能完全让您访问手机的所有功能。

大多数开放式手机都将支持 J2ME，但不同的手机制造商以不同的方式实现它，而且整体上的碎片化是巨大的。不幸的是，大多数开放式手机（可以安装第三方应用程序的手机）只允许您使用 J2ME 进行开发

唯一的好消息是，您只打算编写小型应用程序将大大缓解碎片问题。

J2ME 在文件系统访问方面也有很大的限制，完全缺乏电话 API，与系统应用程序管理的交互非常差......

为了获得全部功能，您始终需要使用您所针对的开放平台的本机技术，无论是 Android、iPhone、Symbian OS、Brew、Windows Mobile 或 Palm OS 手机的几种变体。它们中的每一个都有自己的原生技术。

用多种不同的语言多次编写您的应用程序，代价高昂，既需要大量目标手机，又需要访问每款手机的全部功能。

我本人是一名 Symbian/J2ME 资深人士，鉴于您所陈述的背景和目标，我怀疑您正在尝试学习移动技术。因此，我会厚颜无耻地插入我的书，这是对 Symbian 开发生态系统的介绍：

[http://www.amazon.com/Quick-Recipes-Symbian-Smartphone-Development/dp/0470997834/](https://rads.stackoverflow.com/amzn/click/com/0470997834)

祝你好运

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T08:00:08.993

如果您的主要目标是进入**消费市场**，Java 2 Micro Edition (J2ME) 可能是您最好的选择。所有流行的手机（来自诺基亚、索尼爱立信、三星）都安装了 Java 虚拟机。例如，如果你看看 Google，他们正在用 Java 开发他们所有的移动应用程序（如 Gmail 和 Google 地图）。

如果您的目标是**商业客户**，我认为 Microsoft .NET Compact Framework 是您的最佳选择。Windows Mobile 操作系统在商业市场中占有重要地位，主要是因为 Outlook Mobile 及其与 Exchange 的集成。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-11-08T23:01:40.107

我恭敬地不同意福斯塔。

如果你想接触大众，网络是你最好的选择。编写一个可以在数百万台设备上运行的简单 Web 应用程序要容易得多。

最好的一点是您可以轻松地更新您的应用程序并**每天通过 Web 改善用户体验**。

# c# - 如何使用详细查询在 C# 中查询 excel 文件

> ID：207693
> 
> 赞同：4
> 
> 时间：2008-10-16T07:32:58.987
> 
> 标签：c#, excel

以下代码完美地将电子表格中的数据返回到网格中

```
[
        string excelConnectString = "Provider = Microsoft.Jet.OLEDB.4.0;" +
            "Data Source = " + excelFileName + ";" +
            "Extended Properties = Excel 8.0;";

        OleDbConnection objConn = new OleDbConnection(excelConnectString);
        OleDbCommand objCmd = new OleDbCommand("Select * From [Accounts$]", objConn);

        OleDbDataAdapter objDatAdap = new OleDbDataAdapter();
        objDatAdap.SelectCommand = objCmd;
        DataSet ds = new DataSet();
        objDatAdap.Fill(ds);
        fpDataSet_Sheet1.DataSource = ds;//fill a grid with data
] 
```

我正在使用的电子表格具有从 A 命名的列，依此类推（只是标准列名），工作表名称是 Accounts。

我的查询有问题...

```
 [OleDbCommand objCmd = new OleDbCommand("Select * From [Accounts$]", objConn);] 
```

我怎样才能使查询字符串像这样......

```
"Select <columnA>,<columnB>,SUM<columnG> from [Accounts$] group by <columnA>,<columnB>" 
```

..以便它返回此查询的结果

注意：A 列是工作表上的 A，B 列是工作表上的 B，G 列是工作表上的 G

其他可能的替代方案：

1.  我将该 excel 的数据传播到 DataTable 对象中，如何查询 DataTable 对象
2.  我读到了一个 DataView 对象，它可以获取一个表并返回根据 ( `<dataviewObject>.RowFilter = "where..."`) 操作的表，但我不知道如何使用我想要的查询。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-07T17:28:10.993

你想要类似的东西：

```
 SELECT Sum([NameOfFieldAsPerHeader]) FROM [Accounts$] 
```

或者

```
 SELECT [ForExampleEmployeeID], Sum([NameOfFieldAsPerHeader]) FROM [Accounts$]
 GROUP BY [ForExampleEmployeeID] 
```

或者

```
 SELECT [ForExampleEmployeeID], Year([SomeDate]), Sum([NameOfFieldAsPerHeader]) 
 FROM [Accounts$]
 GROUP BY [ForExampleEmployeeID], Year([SomeDate]) 
```

或者

```
 SELECT [ForExampleEmployeeID], Year([SomeDate]), Sum([NameOfFieldAsPerHeader]) 
 FROM [Accounts$]
 WHERE Year([SomeDate])>2000
 GROUP BY [ForExampleEmployeeID], Year([SomeDate]) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-07T17:05:28.497

如果你不想**分组，**那么 DataTable 类有一个名为**Compute**的方法 ，它执行几个 SQL 函数。
支持以下函数： **COUNT、SUM、MIN、MAX、AVG、STDEV、VAR**。

```
string salary = empTable.Compute("SUM( Salary )", "").ToString();
string averageSalaryJan = empTable.Compute("AVG( Salary )", "Month = 1").ToString();
// Assuming you have month stored in Month column and Salary stored in Salary column 
```

您可以探索的其他替代方案是：

1.  您可以使用 Microsoft 知识库文章[HOW TO：Implement a DataSet GROUP BY Helper Class in Visual C# .NET](http://support.microsoft.com/kb/326145)

2.  如果您使用的是 .NET 3.5，您可以使用 Linq 参考：[LINQ DataTable Query - Group Aggregation](http://weblogs.asp.net/wenching/archive/2008/05/16/linq-datatable-query-group-aggregation.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-11T18:56:41.597

在您的示例中，是否`SUM`代表潜在的列名或 SQL 函数？

您是否尝试获取您的查询，以便能够像在 SQL 查询中`Column A, B, C, D, etc...`一样从 Excel 工作表中引用？`ColumnA, ColumnB, ColumnC, ColumnD, etc...`

我想我的意思是：你想把你的`query`写成这样： `Select ColumnA, ColumnB, ColumnC from [Accounts$]`，而不是这样： `Select * from [Accounts$]`？

如果是这样，您可以将列标题放在 Excel 工作表的第一行，并将它们视为`connection string`. 为此，请使您的`connection string`行如下所示：

```
excelConnectString = "Provider = Microsoft.Jet.OLEDB.4.0;" + "Data Source = " 
+ excelFileName + ";" + "Extended Properties = Excel 8.0; HDR=Yes;"; 
```

不同的是`HDR=Yes`扩展属性部分中的部分。一旦您能够通过使用列名来引用 Excel 工作表中的列，您应该能够使用 DataTable 的`Select`方法，`DataView's RowFilter property`正如您所提到的。

这是否有助于甚至解决您的问题？

# php - 用于 PHP 开发的出色 Eclipse 设置

> ID：207696
> 
> 赞同：6
> 
> 时间：2008-10-16T07:34:29.607
> 
> 标签：php, javascript, eclipse, ide

我使用 Eclipse PDT、Subclipse、viPlugin 和 JSEclipse 进行 PHP 和 JavaScript 开发。这给了我一个相当不错的环境，但我想知道还有什么可能更好。

您在 Eclipse 中安装了哪些插件来创建使用 PHP 和 JavaScript 进行开发的出色设置？您觉得哪些功能最有用？哪些不太好，什么可以解决它们？

有没有人使用比 Eclipse + PDT 或 Netbeans 更稳定和/或更全功能的东西？Komodo IDE 如何比较？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-16T11:25:48.190

没有，我将 Netbeans 用于 PHP，这是非常有前途的。你应该试试看 ;）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T10:59:02.613

嗨，我一直在使用具有一些不错功能的 phpeclipse。

但我目前主要使用的是 aptana 插件，它适用于大多数版本和风格的 eclipse。它允许您创建丰富的互联网应用程序，并针对 ajax 革命！

你可以在这里很好地了解如何将其插入 [http://www.aptana.com/docs/index.php/Plugging_Aptana_into_an_existing_Eclipse_configuration](http://www.aptana.com/docs/index.php/Plugging_Aptana_into_an_existing_Eclipse_configuration)

安装后，我还插入了 adobe air sdk 插件，并在大约 1 小时内创建了一个快速的 adobe air 应用程序。www.sitepoint.com 有一些关于创建空中应用程序的好文章。

而且，如果您想知道 php 的位置很好，因为我在我所做的大多数事情后面都使用了 php，所以它都链接在一起。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T11:21:29.633

[AnyEdit](http://andrei.gmxhome.de/anyedit/)用于批量格式化文本（将结束线、制表符更改为空格等）和用于 SVN 集成的[Subclipse 。](http://subclipse.tigris.org/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-01T00:31:01.223

dbviewer 用于管理数据库和处理查询。我也喜欢 mylyn 和 tasktop 与 bugzilla/trac 一起管理项目。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-09T06:52:56.640

木卫三

*   dltk javascript
*   颠覆性 - 我猜比 subclipse 好得多
*   wtp - 用于 css/xml
*   rse-ftp

我唯一担心的是 pdt 不再具有 F3 功能，它将打开包含您要查找的声明的文件。

对于欧罗巴

*   wickedshell - 命令行

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-16T12:19:09.067

Aptana（用于 Javascript 开发）作为插件和 IDE 存在。我作为 IDE 使用，带有 PHP 的 aptana 插件。

或者我使用 PDT-All-in-one：有 HTML & CSS 插件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-16T20:29:42.443

我为 Eclipse 使用 Eclipse PDT + SubEclipse + Aptana 插件。Aptana 的 JS 编辑器相当不错。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-10-14T08:03:06.263

查看[适用于 PHP 的 nWire](http://www.nwiresoftware.com/products/nwire-php)：它是一个新的 PDT 插件，可实现实时代码可视化、导航和搜索。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-10-31T13:28:31.983

*   Afae 编辑器，主要是因为主题，有一个颜色选择器等。
*   bzrEclipse，因为我用的是 bazaar vcs

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-12-30T23:42:42.633

Aptana Studio 最近放弃了他们的付费产品，现在完全开放。它可选支持 subversion、CVS、Git 和几个 javascript 库（jquery、ext、prototype 等），以及 PHP、python 和 Rails。

值得注意的是，如果您过去尝试过 Aptana 并且不喜欢他们开发的内部 php 编辑器，那么他们现在已经放弃它而支持 PDT。

我已经使用 Aptana 进行了一段时间的大型项目开发，但我还没有发现任何遗漏。

# html - 在没有菜单栏的浏览器中显示 PDF 文档

> ID：207703
> 
> 赞同：1
> 
> 时间：2008-10-16T07:40:37.350
> 
> 标签：html, pdf

我有一个显示网页和 pdf 文档的触摸屏信息亭。我可以删除菜单栏吗？用户不得具有“保存”、“打印”等功能。

更新

[flickr 上的随机屏幕截图](http://flickr.com/photos/23021917@N05/2209106577/)- 我指的是控制 PDF 的打印、后退/前进、缩放栏 - 而不是浏览器菜单。抱歉没有具体说明。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T08:42:26.303

好的 - 您应该能够在 pdf 文档本身中设置大部分内容。

这来自 Acrobat Pro 9 中的菜单：文件 -> 属性 -> 初始视图

那里有一些选项：隐藏菜单栏、工具栏、窗口控件

这在 acrobat 中已经存在了一段时间，所以大多数版本都应该这样做。

如果您有正确的库，也可以通过编程方式设置这些，但最容易下载 acrobat 演示。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T11:25:07.240

OpenOffice 还具有隐藏控件和禁止打印的选项：
`File->Export as PDF->User Interface`
不幸的是，您无法修改当前 PDF。您必须有一个 Word 或 OOorg 文档才能导出。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-10T08:20:28.270

你真的应该为此使用[PDF 打开参数](http://www.adobe.com/content/dam/Adobe/en/devnet/acrobat/pdfs/pdf_open_parameters.pdf "PDF 打开参数")。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T08:05:33.820

关于在 Kiosk 模式下使用 IE7 的良好讨论：http: [//samanathon.com/internet-explorer-7s-kiosk-mode/](http://samanathon.com/internet-explorer-7s-kiosk-mode/)

* * *

如果您可以选择 Firefox，请参阅此插件：

> [R-kiosk](https://addons.mozilla.org/en-US/firefox/addon/1659)
> 
> *Real Kiosk 是 Firefox 2.0 - 3.0 扩展，默认为全屏，禁用所有菜单、工具栏、键盘命令和右键菜单。Alt+Home 仍可带您回家*

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-16T08:20:32.103

如果您正在运行带有 .net 框架的机器，您可以将一个带有嵌入式 Web 浏览器控件的 Windows 窗体应用程序组合在一起，从而为您提供更多控制权（它们如何在没有工具栏或右键单击的情况下从 pdf 返回？）

但是我使用过的最快的选项（做了几个触摸屏）只是在信息亭模式下使用 IE，这很容易通过命令行开关完成，并将其设置为在 Windows 启动时全屏运行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-29T18:54:56.383

创建pdf文件时需要pdf专业版来执行此操作，文件-属性-初始视图选中“隐藏菜单栏”和“隐藏工具栏”保存

祝你好运

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-03-16T10:10:45.300

或者只是使用这个开源组件并摆脱 acrobat reader

[http://flexpaper.devaldi.com/](http://flexpaper.devaldi.com/)

# java - 如何在eclipse中调试一系列Aspect？

> ID：207717
> 
> 赞同：0
> 
> 时间：2008-10-16T07:52:08.543
> 
> 标签：java, eclipse, aspectj

我有一系列在某些情况下正在执行但在其他情况下没有执行的方面。堆栈通常看起来像这样，不提供上下文信息。似乎也没有我可以启用的任何日志记录。感谢您对此的任何帮助。

```
GeneratedMethodAccessor163.invoke(Object, Object[]) line: not available 
DelegatingMethodAccessorImpl.invoke(Object, Object[]) line: 25  
Method.invoke(Object, Object...) line: 585  
AspectJAroundAdvice(AbstractAspectJAdvice).invokeAdviceMethodWithGivenArgs(Object[]) line: 566  
AspectJAroundAdvice(AbstractAspectJAdvice).invokeAdviceMethod(JoinPoint, JoinPointMatch, Object, Throwable) line: 556   
AspectJAroundAdvice.invoke(MethodInvocation) line: 57   
Cglib2AopProxy$CglibMethodInvocation(ReflectiveMethodInvocation).proceed() line: 173    
ExposeInvocationInterceptor.invoke(MethodInvocation) line: 89   
Cglib2AopProxy$CglibMethodInvocation(ReflectiveMethodInvocation).proceed() line: 185    
Cglib2AopProxy$DynamicAdvisedInterceptor.intercept(Object, Method, Object[], MethodProxy) line: 652 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T05:15:10.143

如果您安装了[AspectJ 开发工具](http://www.eclipse.org/ajdt/)(AJDT)，它是 eclipse 的一个插件，那么您可以在调试器中单步调试各个方面。

# javascript - 计算跨浏览器 iframe 高度

> ID：207720
> 
> 赞同：16
> 
> 时间：2008-10-16T07:54:38.537
> 
> 标签：javascript, jquery, iframe

**在我的 javascript 体验中，最困难的问题之一是iframe height**的正确（即“跨浏览器”）计算。在我的应用程序中，我有很多动态生成的 iframe，我希望它们都在加载事件结束时执行一种自动调整大小来调整它们的高度和宽度。

在**高度**计算的情况下，我最好的解决方案如下（在 jQuery 的帮助下）：

```
function getDocumentHeight(doc) {
  var mdoc = doc || document;
  if (mdoc.compatMode=='CSS1Compat') {       
      return mdoc.body.offsetHeight;
  }
  else {
    if ($.browser.msie)
      return mdoc.body.scrollHeight;
    else  
      return Math.max($(mdoc).height(), $(mdoc.body).height());
  }
} 
```

我搜索了互联网没有成功。我还测试了雅虎库，它有一些文档和视口尺寸的方法，但并不令人满意。我的解决方案效果不错，但有时它会计算出更高的高度。我已经研究并测试了大量关于 Firefox/IE/Safari 中文档高度的属性：`documentElement.clientHeight, documentElement.offsetHeight, documentElement.scrollHeight, body.offsetHeight, body.scrollHeight, ...` 此外，jQuery 在各种浏览器中的调用也没有连贯的行为`$(document.body).height(), $('html', doc).height(), $(window).height()`

我不仅在加载事件结束时调用上述函数，而且在动态插入的 DOM 元素或隐藏或显示元素的情况下调用。这种情况有时会破坏仅在加载事件中有效的代码。

有人有真正的跨浏览器（至少是 Firefox/IE/Safari）解决方案吗？一些提示或提示？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-16T12:20:35.443

尽管我喜欢您的解决方案，但我一直发现 IFRAME 比它们的价值更麻烦。

为什么 ？1、尺码问题。2\. iframe 需要担心 src 属性。即绝对路径。3\. 页面的额外复杂性。

我的解决方案 - 通过 AJAX 调用动态加载的 DIV。DIV 将自动调整大小。尽管 AJAX 代码需要 javascript 工作（可以通过框架完成），但它们与站点所在的位置相关。3 是一个清洗，你在页面中交易复杂性到 javascript。

而不是 <IFRAME ...> 使用 <DIV id="mystuff" />

执行 ajax 调用以用数据填充 mystuff div 并让浏览器担心它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-11-30T22:10:38.277

这已经有一段时间没有被接受的答案了，所以我想贡献我经过一些研究后最终得到的解决方案。**这是跨浏览器和跨域的（例如，当 iframe 指向来自不同域的内容时）**

我最终使用了包装在[jQuery 插件](http://benalman.com/projects/jquery-postmessage-plugin/)中的 html5 的消息传递机制，这使得它与使用各种方法的旧浏览器兼容（其中一些在这个线程中描述）。

最终解决方案非常简单。

**在主机（父）页面上：**

```
// executes when a message is received from the iframe, to adjust 
// the iframe's height
    $.receiveMessage(
        function( event ){
            $( 'my_iframe' ).css({
                height: event.data
            });
    });

// Please note this function could also verify event.origin and other security-related checks. 
```

**在 iframe 页面上：**

```
$(function(){

    // Sends a message to the parent window to tell it the height of the 
    // iframe's body

    var target = parent.postMessage ? parent : (parent.document.postMessage ? parent.document : undefined);

    $.postMessage(
        $('body').outerHeight( true ) + 'px',
        '*',
        target
    );

}); 
```

我已经在 XP 和 W7 上的 Chrome 13+、Firefox 3.6+、IE7、8 和 9、OSX 和 W7 上的 safari 上对此进行了测试。;)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-04-02T12:34:44.893

由于在您的示例中您正在访问IFRAME*内*的文档，我猜您是在谈论了解文档的高度而不是框架本身的高度。此外，这意味着内容来自您自己的网站，并且您可以控制其内容。

那么，为什么不简单地在内容周围放置一个 DIV，然后使用该 DIV 的 clientHeight 呢？

您在 IFRAME 中加载的代码：

```
...
<body>
  <div id="content">
  ...
  </div>
</body> 
```

父文档：

```
 function getDocumentHeight(mdoc) {
    return mdoc.getElementById("content").clientHeight;
 } 
```

顺便说一句，您的示例函数的这一部分没有意义，因为“文档”没有引用 IFRAME： `var mdoc = doc || document;`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-14T19:16:03.453

我发现这个解决方案适用于 ie 6+、ff 3.5+、safari 4+。我正在创建 iframe 并将其附加到文档中。以下代码在 jQuery 的 load 事件结束后执行一些其他 dom 操作。由于加载事件中发生了额外的 dom 操作，因此我需要超时。

```
// sizing - slight delay for good scrollheight
setTimeout(function() {
   var intContentHeight = objContentDoc.body.scrollHeight;
   var $wrap = $("#divContentWrapper", objContentFrameDoc);
   var intMaxHeight = getMaxLayeredContentHeight($wrap);
   $this.height(intContentHeight > intMaxHeight ? intMaxHeight : intContentHeight);

   // animate
   fireLayeredContentAnimation($wrap);
}, 100); 
```

我需要考虑一些尺寸限制，这就是 getMaxLayeredContentHeight 调用正在为我检查的内容。希望有帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T21:23:39.450

这是一个似乎有效的解决方案。基本上，在大多数情况下，scrollHeight 是正确的值。但是，在 IE（特别是 6 和 7）中，如果内容只是包含在文本节点中，则不会计算高度，而是默认为 CSS 中设置的高度或 iframe 上的“高度”属性。这是通过反复试验发现的，因此值得一试。

```
function getDocumentHeight(doc) {
  var mdoc = doc || document; 
  var docHeight = mdoc.body.scrollHeight;

  if ($.browser.msie) {
      // IE 6/7 don't report body height correctly.  
      // Instead, insert a temporary div containing the contents.

      var child = $("<div>" + mdoc.body.innerHTML + "</div>", mdoc);
      $("body", mdoc).prepend(child);
      docHeight = child.height();
      child.remove();
  }

  return docHeight;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-04-04T11:43:28.800

[这是一个脚本](http://home.comcast.net/~jscheuer1/side/iframe_ssi_iv/)，它根据 iFrame 内部的高度调整 iFrame 的大小。

# c# - 将两个接口合二为一

> ID：207721
> 
> 赞同：0
> 
> 时间：2008-10-16T07:54:51.377
> 
> 标签：c#, .net, oop

正如我在前面的问题中提到的，我正在重构我正在从事的项目。现在，一切都取决于其他一切。一切都被分离到我早期创建的命名空间中，但我认为我的分离方法不是很好。我试图消除对象依赖于另一个对象的不同命名空间中的另一个对象的情况。

我这样做的方式是将我的项目（游戏）划分为几个程序集：

```
GameName.Engine
GameName.Rules
GameName.Content
GameName.Gui 
```

该`GameName.Engine`程序集包含一堆接口，因此程序的其他部分不需要依赖任何特定的实现。例如，我有一个`GameName.Engine.ICarryable`主要由`GameName.Content.Item`类（及其子类）实现的接口。我还有一个对象允许 an`Actor`拿起一个`ICarryable`: `PickupAction`。`Previously`，它需要一个项目，但这暴露了不必要的方法和属性，它实际上只需要拾取和携带它所需的方法。这就是我创建`ICarryable`界面的原因。

现在这一切都很好，所以我的问题。`GameName.Gui`应该只依赖于`GameName.Engine`，而不是任何实现。在里面`GameName.Gui`我有一个`MapView`显示 a`Map`和它上面的任何`IRenderable`对象的对象。

`IRenderable`基本上只是一个暴露图像和一些描述对象的字符串的接口。但是，MapView 也需要对象来实现`ILocateable`，所以它可以看到它的位置，并知道它何时通过一个事件`LocationChanged`, inside发生变化`ILocateable`。

这两个接口都是由`Item`和`Actor`对象实现的。其中，再次定义在`GameName.Content`. 由于它需要两个接口，我有两个选择：

1.  使`GameName.Gui`依赖`GameName.Content`和需要一个（和的`Entity`基类）。`Item``Actor`

2.  在里面制作一个如下所示的界面`GameName.Engine`：

    ```
    interface ILocateableRenderable : ILocateable, IRenderable
    {
    } 
    ```

    然后让 my`Actor`和`Item`objects 实现该接口而不是单独实现两个。

有人对哪种方法最好有任何建议吗？创建一个没有方法或属性的接口是否合适，只强制实现其他两个接口？

*澄清：`MapView`适用于`Map`由`Entity`对象组成的 a 。我不想将`Entity`对象暴露给`MapView`，它只需要知道它们的位置 ( `ILocateable`) 以及如何渲染它们 ( `IRenderable`)。*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T08:13:02.103

您似乎有两个相互矛盾的要求：

> 在 GameName.Gui 里面我有一个**MapView 对象，它显示**了一个 Map 和它上面的**任何 IRenderable**对象。

和

> 但是，**MapView 还需要对象来实现 ILocateable**，因此它可以通过 ILocateable 内的事件 LocationChanged 看到它的位置并知道它何时发生变化。

所以，如果 MapView 只需要 IRenderable，那么它应该接受 IRenderable，然后检查该类是否也实现了 ILocateable。在这种情况下使用它的方法。

```
public void Whatever(IRenderable renderable)
{
   if (renderable is ILocateable)
   {
      ((ILocateable) renderable).LocationChanged += myEventHandler;
   }

   // Do normal stuff
} 
```

另一方面，如果你总是需要它是 ILocateable 和 IRenderable，那么你真的应该以两种方式之一创建派生接口

```
interface IMappable: IRenderable, ILocateable {}

public void Whatever(IMappable mappable)
{
   mappable.LocationChanged += myEventHandler;

   // Do normal stuff
} 
```

或者

```
interface IRenderable: ILocateable
{
  // IRenderable interface
}

public void Whatever(IRenderable renderable)
{
   renderable.LocationChanged += myEventHandler;

   // Do normal stuff
} 
```

取决于您的代码目前的情况。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T09:21:47.410

在所有情况下，IRenderable 对象也必须实现 ILocateable，所以我正在做@Sklivvz 建议的事情并使 IRenderable 实现 ILocateable：

```
public interface IRenderable : ILocateable
{
  // IRenderable interface
} 
```

这种模式在 .NET 中被大量使用。例如，ICollection 接口实现了 IEnumerable，同时添加了其他方法。这与上述代码的作用直接相似。

谢谢@Sklivvz。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T08:06:23.100

您可能会考虑，但我想我不是该领域的专家，将引擎分成两部分，一个渲染器和一个位置管理器。然后，您可以将 ILocateable 对象添加到后者，将 IRenderable 对象添加到前者。但是，如果您认为这没有任何意义和/或过于复杂，那么创建此合并界面似乎还不错。另一种选择可能是向 ILocateable 和 IRenderable 添加一个超级接口，例如 IGameObject，您将在引擎类中接受该接口，然后检查将对象分派到地图、位置对象或两者的确切类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T08:28:22.353

选项 2 违反了[接口隔离原则](http://www.objectmentor.com/resources/articles/isp.pdf)。基本上，客户端不应该看到它不需要的方法......没有胖接口。如果一个对象不能只实现这些接口中的任何一个，那么您应该将它们组合成一个接口。但是，如果让一个对象只是 ILocatable 而不必是 IRenderable 是有意义的，那么请保持接口不同。我看不出有什么问题。

您可以创建一个默认基类（同时实现两者）来派生，以防您发现这是常见/80% 的场景

# database - 寻找关于分布式系统中记录锁定的建议

> ID：207724
> 
> 赞同：0
> 
> 时间：2008-10-16T07:57:24.773
> 
> 标签：database, concurrency, locking

在记录锁定方面，我们正在尝试为我们的团队提供推荐的设计模式。典型的思想流派是这样的： 1\. 用户从列表中选择一条记录 2\. 用用户 ID 锁定记录 3\. 加载锁定的记录记录（没有锁定，然后有人打败它）。

我是否遗漏了什么，或者这似乎是唯一的方法？（（在我们的例子中，乐观锁定对于最终用户来说会很麻烦和困惑。编辑通常是相当大量的。））

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-16T09:08:26.830

可能使您的解决方案管理变得密集的细节是在崩溃或连接故障后摆脱锁定。这就是乐观锁定和悲观锁定之间的权衡的真正所在。当乐观锁定失败时手动合并或重做编辑是一件痛苦的事情，但是在悲观和持久锁定模型崩溃后清理会产生自己的麻烦（因为任何在 90 年代支持 Pervasive 支持的会计系统用户的人都会详细地告诉你机会）

一个答案是使用 RDBMS 的机制来管理事务和并发：使用 SELECT FOR UPDATE 或任何适合您的环境和隔离级别的语法来获取记录。如果您的客户端之一崩溃或断开连接，事务将回滚并释放锁。

在网络等无连接环境或连接丢失和频繁恢复的环境中，具有会话超时的基于会话的模型也可以工作：

*   如果记录是过期会话，则尝试清除记录上的现有锁定
*   尝试将记录锁定到 sessionid（如果上一步失败则失败）
*   选择锁定的记录（如果上一步失败则不返回记录）

因此，当会话到期时，锁会被释放。崩溃后不必手动删除锁，并且对客户端/连接问题有一定的容忍度。不过，编码确实需要更多的工作。

# c++ - 模板化超类链接问题

> ID：207730
> 
> 赞同：2
> 
> 时间：2008-10-16T08:00:58.820
> 
> 标签：c++, templates

我正在尝试创建一个带有模板化超类的 C++ 类。这个想法是，我可以很容易地从许多具有相似特征的超类中创建许多相似的子类。

我将有问题的代码提炼如下：

`template_test.h`：

```
template<class BaseClass>
class Templated : public BaseClass
    {
public:
    Templated(int a);
    virtual int Foo();
    };

class Base
    {
protected:
    Base(int a);
public:
    virtual int Foo() = 0;
protected:
    int b;
    }; 
```

`template_test.cpp`：

```
#include "template_test.h"

Base::Base(int a)
    : b(a+1)
    {
    }

template<class BaseClass>
Templated<BaseClass>::Templated(int a)
    : BaseClass(a)
    {
    }

template<class BaseClass>
int Templated<BaseClass>::Foo()
    {
    return this->b;
    } 
```

`main.cpp`：

```
#include "template_test.h"

int main()
    {
    Templated<Base> test(1);
    return test.Foo();
    } 
```

`Templated<Base>::Templated(int)`当我构建代码时，我得到链接器错误，说`Templated<Base>::Foo()`找不到符号。

一个快速的谷歌建议添加以下内容`main.cpp`将解决问题：

```
template<> Templated<Base>::Templated(int a);
template<> int Templated<Base>::Foo(); 
```

但这并不能解决问题。添加行`main.cpp`也不起作用。（虽然，有趣的是，将它们添加到两者都会导致链接器出现“多重定义的符号”错误，因此它们必须在做某事......）

*但是*，将所有代码放在一个源文件中确实可以解决问题。虽然这对于上面的点头示例来说是可以的，但如果我被迫将全部内容放在一个 cpp 文件中，我正在查看的实际应用程序将很快变得难以管理。

有谁知道我正在做的事情是否可能？（如何）我可以解决我的链接器错误吗？

我会假设我可以将所有方法都设置为`class Templated`inline 并且这会起作用，但这似乎也不理想。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-16T08:07:22.083

对于模板类，定义必须可用于使用它的每个翻译单元。定义可以放在单独的文件中，通常带有`.inl`或`.tcc`扩展名；头文件`#include`是底部的那个文件。因此，即使它在一个单独的文件中，它仍然`#include`是每个翻译单元的 d ；它不能是独立的。

因此，对于您的示例，重命名`template_test.cpp`为`template_test.inl`（或`template_test.tcc`，或其他），然后将`#include "template_test.inl"`（或其他）放在 的底部`template_test.h`，就在`#endif`包含守卫的之前。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T14:12:11.257

问题是当你的模板文件被编译时，编译器不知道它需要为什么类型生成代码，所以它不知道。

然后当你链接时，main.cpp 说它需要这些函数，但它们从未编译到目标文件中，所以链接器找不到它们。

其他答案显示了以可移植方式解决此问题的方法，实质上是将模板化成员函数的定义放在您实例化该类实例的位置可见 - 通过显式实例化或将实现放入从 main.cpp #included 的文件。

You may also want to read your compiler's documentation to see how they recommends setting things up. I know the IBM XLC compiler has some different settings and options for how to set these up.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T08:11:24.683

[C++ FAQ-lite 涵盖了这一点](http://www.parashift.com/c++-faq-lite/templates.html#faq-35.13)，并有几种方法可以绕过它。

您不必使所有方法都“内联”，但您应该在 template_test.h 中定义方法主体，而不是在 template_test.cpp 中。

一些编译器可以处理这种拆分，但您必须记住，在某一层面上，[模板就像宏](https://stackoverflow.com/questions/180320/are-c-templates-just-macros-in-disguise)。为了让编译器为您的特定模板生成模板，它需要手边有模板源。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-16T08:31:02.210

当编译器编译 main.cpp 时，它看到类定义有成员函数声明，但没有成员函数定义。它只是假设在某处必须有“模板化”构造函数和 Foo 实现的定义，因此它遵循链接器在链接时找到它。

您的问题的解决方案是将 Templated 的实现放入 template.h 中。

例如

```
template<class BaseClass>
class Templated : public BaseClass
    {
public:
    Templated(int a) : BaseClass(a) {}
    virtual int Foo() { return BaseClass::b; }
    }; 
```

有趣的是，我可以通过将它放在 template_test.cpp 的末尾来链接您的代码。

```
void Nobody_Ever_Calls_This()
{
    Templated<Base> dummy(1);
} 
```

现在编译器可以找到要链接的 Templated 实例。我不建议将此作为一种技术。其他一些文件可能想要创建一个

```
Templated<Widget> 
```

然后您必须向 template_test.cpp 添加另一个显式实例化。

# unix - 相当于内存检查的时间

> ID：207734
> 
> 赞同：5
> 
> 时间：2008-10-16T08:04:33.150
> 
> 标签：unix, statistics

我们可以`time`在 unix 环境中使用来查看某件事花了多长时间...

```
shell> time some_random_command
real    0m0.709s
user    0m0.008s
sys     0m0.012s 
```

是否有记录进程的内存使用情况的等价物？

特别是我对峰值分配感兴趣。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-16T12:30:44.517

检查手册页的时间。您可以指定可以输出内存信息的格式字符串。例如：

```
>time -f"mem: %M" some_random_command
内存：NNNN
```

将在其生命周期内输出进程的最大驻留集大小，以千字节为单位。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T12:29:51.493

不能用ps吗？eg`ps v <pid>`将返回内存信息。

# asp.net - authentication mode=Forms - 那么为什么我会收到 Windows 登录提示？

> ID：207737
> 
> 赞同：0
> 
> 时间：2008-10-16T08:05:05.473
> 
> 标签：asp.net

我在我的 asp.net web.config 中将身份验证模式设置为表单，但是当我浏览到该网站时仍然收到 Windows 登录提示。

是否可以在其他地方设置身份验证模式，例如在 IIS 中？我的网站在 IIS 6 上运行。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-16T08:14:02.727

这可能是因为运行网站的用户不允许访问正在服务的文件夹的权限

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T08:12:31.840

我遇到了将身份验证设置为表单并将目录安全设置为允许匿名的问题，但是某些资源（在我的特定情况下为图像）没有适当的权限来允许匿名用户读取它们。

效果是提示用户登录以便可以显示图形，然后显示表单并且用户（再次）使用预期的表单登录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T08:29:28.653

听起来像windows权限问题。

Windows 权限将始终覆盖您在 aspnet 中设置的任何内容。

我将首先查看 IIS 管理员中的“匿名访问”权限，然后按照自己的方式处理文件系统。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T08:42:23.230

您已在 IIS 管理员中配置匿名访问，但 IIS 用户无权访问文件系统，默认登录对话框以 Windows 用户身份进行身份验证。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-16T09:19:57.197

碰巧，我不在时，一位同事将我的机器更新为 .NET Framework 3.5 SP1。所以我编译了我的项目并发布到没有安装 SP1 的服务器上，并且发生了上述情况。

我已经在服务器上安装了 SP1，它现在工作正常。

感谢您的输入。

只是为了澄清：登录弹出是因为应用程序由于以下描述的问题而无法加载文件：http: [//geekswithblogs.net/LessonsLeared/archive/2008/08/21/hidden-surprises-in- .net-3.5-service-pack-1.aspx](http://geekswithblogs.net/LessonsLeared/archive/2008/08/21/hidden-surprises-in-.net-3.5-service-pack-1.aspx)

# graphics - 从多边形网格中寻找唯一边的算法

> ID：207744
> 
> 赞同：7
> 
> 时间：2008-10-16T08:08:16.467
> 
> 标签：graphics, geometry, polygon, mesh, edge-detection

我正在寻找一种好的算法，它可以从一组多边形数据中为我提供独特的边缘。在这种情况下，多边形由两个数组定义。一个数组是每个多边形的点数，另一个数组是顶点索引列表。

我有一个正在运行的版本，但是当达到超过 500,000 个多边形时性能会变慢。我的版本遍历每个面并将每个边的排序顶点添加到 stl::set。我的数据集将主要是三角形和四边形，并且大多数边将被共享。

有没有更聪明的算法呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-16T08:15:07.420

只是为了澄清，你想要这样的多边形列表：

```
A +-----+ B
   \    |\
    \ 1 | \
     \  |  \
      \ | 2 \
       \|    \
      C +-----+ D 
```

然后不是这样的边缘：

```
A - B -+
B - C  +- first polygon
C - A -+

B - D -+
D - C  +- second polygon
C - B -+ 
```

那么您要删除重复的 B - C 与 C - B 边缘并共享它吗？

您的算法遇到了什么样的性能问题？我想说一个具有合理哈希实现的集合应该执行得很好。另一方面，如果您的哈希对数据不是最佳的，您将遇到很多可能严重影响性能的冲突。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-16T08:16:32.067

是
使用双哈希映射。
每条边都有两个索引 A，B。假设 A > B。
第一个顶级哈希映射将 A 映射到另一个哈希映射，该哈希映射又将 B 映射到某个值，该值表示您想要的关于每条边的信息。（或者如果您不需要保留边缘信息，则只是一个布尔值）。
本质上，这创建了一个由哈希映射组成的两级树。

要在这个结构中查找一个边，你需要更大的索引，在顶层查找它并最终得到一个哈希映射。然后取较小的索引并在第二个哈希图中查找它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-17T17:44:39.517

你俩都是对的。使用良好的哈希集已使性能远远超出所需水平。我最终滚动了我自己的小哈希集。

边的总数将在 N/2 和 N 之间。N 是网格中唯一顶点的数量。所有共享边都是 N/2，所有唯一边都是 N。从那里我分配一个 uint64 缓冲区并将我的索引打包到这些值中。使用一小组独特的表格，我可以快速找到独特的边缘！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-10T12:21:21.783

这是 Blender 中使用的边缘散列的 C 实现，正是为了从面快速创建边缘，可能会为其他人制作自己的边缘提供一些提示。

[http://gitorious.org/blenderprojects/blender/blobs/master/blender/source/blender/blenlib/intern/edgehash.c](http://gitorious.org/blenderprojects/blender/blobs/master/blender/source/blender/blenlib/intern/edgehash.c)

[http://gitorious.org/blenderprojects/blender/blobs/master/blender/source/blender/blenlib/BLI_edgehash.h](http://gitorious.org/blenderprojects/blender/blobs/master/blender/source/blender/blenlib/BLI_edgehash.h)

这使用 BLI_mempool， [https: //gitorious.org/blenderprojects/blender/blobs/master/blender/source/blender/blenlib/intern/BLI_mempool.c](https://gitorious.org/blenderprojects/blender/blobs/master/blender/source/blender/blenlib/intern/BLI_mempool.c)

[https://gitorious.org/blenderprojects/blender/blobs/master/blender/source/blender/blenlib/BLI_mempool.h](https://gitorious.org/blenderprojects/blender/blobs/master/blender/source/blender/blenlib/BLI_mempool.h)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-03T21:40:28.867

首先，您需要确保您的顶点是唯一的。也就是说，如果您只想在某个位置有一条边。然后我使用这个数据结构

`typedef std::pair<int, int> Edge;`

`Edge sampleEdge;`

`std::map<Edge, bool> uniqueEdges;`

边包含按排序顺序构成边的顶点索引。因此，如果 sampleEdge 是由索引号为 12 和 5 的顶点组成的边，则 sampleEdge.first = 5 和 sampleEdge.12

然后你可以做

`uniqueEdges[sampleEdge] = true;`

对于所有的边缘。uniqueEdges 将保存所有独特的边缘。

# datamapper - 数据映射器模式

> ID：207758
> 
> 赞同：19
> 
> 时间：2008-10-16T08:16:28.277
> 
> 标签：datamapper

到目前为止，我一直在我的所有 c# 数据库驱动应用程序中使用活动记录。但是现在我的应用程序需要将我的持久性代码从我的业务对象中分离出来。我已经阅读了很多关于 Martin Fowler 的数据映射模式的帖子，但我对这种模式的了解仍然非常有限。

让我们使用以下示例：

如果我有 2 个表 - Customer 和 CustomerParameters。CustomerParameters 表包含用于创建新客户的默认客户值。

然后我必须创建一个CustomersMapper 类来处理所有的Customer 持久性。然后，我的 Customer 和 CustomersList 类将与此映射器类协作以保存客户数据。

我有以下问题：

1.  如何在不违反某些业务规则的情况下将原始数据传输到我的客户类和从我的客户类到映射器？DTO?

2.  在我的 Mapper 类中使用 SaveAll 和 LoadAll 方法来更新和加载多个客户的数据是否可以接受？如果是这样，在 SaveAll 的情况下，映射器如何知道何时更新或插入数据？

3.  Customer 映射器类是否也负责从 CustomerParameters 表中检索默认值，还是创建一个 CustomerParameters 映射器会更好？

AO/R 映射器工具实际上并不在这里。我使用的数据库是事务性的，需要我编写自己的映射器模式。

任何想法和意见将不胜感激。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-09T18:44:54.017

肖恩我会这样回答你的问题：

广告 1) Mapper 负责创建 Customer 对象。您的 Mapper 对象将具有类似 RetrieveById 方法（例如）。它将接受一个 ID 并以某种方式（这不是 Mapper 对象的责任）构造有效的 Customer 对象。反过来也是一样。当您使用有效的 Customer 对象调用 Mapper.Update 方法时，Mapper 对象负责确保所有相关数据都被持久化（在适当的情况下 - 数据库、内存、文件等）

ad 2) 正如我上面提到的，retrieve/persist 是 Mapper 对象上的方法。它有责任提供这样的功能。因此 LoadAll、SaveAll（可能传递一个值对象数组）是有效的 Mapper 方法。

广告 3) 我会说是的。但是您可以将 Mapper 对象的各个方面分成单独的类（如果您想要/需要）：默认值、规则验证等。

我希望它有所帮助。我真的建议/推荐您阅读 Martin Fowler 的《[企业应用程序架构模式》](https://rads.stackoverflow.com/amzn/click/com/0321127420)一书。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-09T20:25:57.380

您可以查看 iBATIS.NET 作为 NHibernate 的替代品。它也是一个 O/R 工具，但我发现它比 NHibernate 更易于使用。

[http://ibatis.apache.org/](http://ibatis.apache.org/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T08:26:19.097

我建议您在尝试自己实现 Data Mapper 模式之前先看一下 O/R-mapper 工具。它将为您节省大量时间。O/R-mapper 的一个流行选择是[NHibernate](http://www.nhibernate.org)。

# architecture - 使用 RabbitMQ 排队的架构评论？

> ID：207761
> 
> 赞同：1
> 
> 时间：2008-10-16T08:17:41.783
> 
> 标签：architecture, erlang, queue, rabbitmq, message-queue

我基本上需要一种能够对消息进行排队的排队技术。这些消息随后将作为 SMS 文本传输。RabbitMQ 似乎很适合在我掩盖了 api 之后。

我目前的架构计划：

1.  客户端在 RabbitMQ 中排队消息。
2.  另一个守护进程将从 RabbitMQ 读取消息并将这些消息发送到第 3 方 SMS 网关。守护程序应该能够产生多个侦听器线程。
3.  我计划使用 Ubuntu Hardy 在 slicehost.com 上托管所有内容。

你预见到这个设计有什么问题吗？由于我对 Erlang 有粗略的了解，因此我不知道如何在生产环境中运行它。如果您对 Erlang 或 RabbitMQ 有任何经验，我想听听您的战争故事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T19:23:26.120

关于 Erlang 战争故事，今年在维多利亚举行的函数式编程商业用户 (CUFP) 研讨会上给出了一些不错的故事：

[在雅虎开发 Erlang](http://cufp.galois.com/2008/slides/GerakinesNick.pdf)

[Erlang 中的广告服务](http://cufp.galois.com/2008/slides/IppolitoBob/slides.html)

第二天在 Erlang Workshop 上：

[IMAP 协议的命令式和功能实现](http://www.erlang.org/workshop/2008/Sess21.pdf)

研讨会的感觉是，虽然 Erlang 绝不是主流，但现在已经在初创公司和大公司中充分传播，使用它来获取商业利益可以被视为一个相当安全的赌注。参加 Erlang 研讨会的公司大约有一半在招聘。

查看[erlang.org](http://www.erlang.org)网站，尤其是[Erlang 邮件列表](http://www.erlang.org/mailman/listinfo/erlang-questions)。它容纳所有类型，从新手到经验丰富的专业人士。

# python - 是否有任何支持 Python 3 语法的 IDE？

> ID：207763
> 
> 赞同：6
> 
> 时间：2008-10-16T08:21:22.087
> 
> 标签：python, syntax, ide, python-3.x

我最近看到了一个公告和[文章](http://www.linux.com/feature/150399)，概述了第一个[Python 3.0](http://www.python.org/download/releases/3.0/)候选版本的发布。我想知道是否有任何支持其语法的商业、免费、开源等 IDE。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-16T16:23:17.870

Python 3与 Python 2.x并**没有什么不同。**就语法*本身*而言，实际上需要由解析器以不同方式处理的事情，唯一的主要变化是用函数替换`print`语句。`print`

Python 的大部分特性都可以通过自省（在线帮助、方法完成、函数签名等）轻松探索，因此没有理由任何 Python IDE 都需要进行重大更改才能与 Python 3.0 一起使用。我预计 IDLE 和 SPE 以及其他开源 IDE 将在最终版本之前支持它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-16T08:34:56.117

Komodo 5 beta 1 于 2008 年 10 月发布，最初支持 Python 3，但我认为我还没有将它用于生产代码。

鉴于 Python 3 仍然是一个非常早期的候选版本，您可能很难在 IDE 中找到成熟的支持。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-07-12T10:23:46.260

[PyDev](http://pydev.org) for Eclipse 确实支持 3.0。您可以在插件设置中配置多个解释器。

在项目属性中，您可以设置：

*   项目类型（Python、Jython、IronPython）
*   语法版本（2.1、2.2、2.3、2.4、2.5、2.6、3.0）。

*（撰写本文时的 PyDev 版本：1.4.7。）*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-16T08:27:02.670

可以得到**PyDev。**来自[http://pydev.sourceforge.net](http://pydev.sourceforge.net)。它是 Eclipse 的插件，非常方便。更不用说旧的和值得信赖的 Eclipse 的好处了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-16T19:06:20.850

Emacs + python.el 仍然比我尝试过的其他任何东西都要好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-07-12T02:03:37.650

[Pyscripter](http://code.google.com/p/pyscripter/)是 Windows 上完美的 Python IDE；它甚至与新发布的 Python 3.1 兼容。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-08-19T20:21:26.447

如果您安装 Geany，则它可以与 python 3 一起使用，然后：

> sudo gedit /usr/share/geany/filetypes.python

将最后两行更改为：

编译器=python3 -c“导入py_compile；py_compile.compile('%f')”

run_cmd=python3 "%f"

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-28T23:47:33.187

我可以说，在发布这篇文章时（2009 年 4 月 28 日，版本 0.8.4h），*SPE 没有*[正确](http://pythonide.blogspot.com/ "固相萃取")处理一些 python3 语法——特别是异常处理。例如，以下代码被标记为错误（令人恼火的是，每当保存文件时就会跳转到）：

 *```
except urllib.error.URLError as e:
        if hasattr(e, 'reason'):
        #... 
```

# c++ - 如何用非平凡的初始值填充向量？

> ID：207768
> 
> 赞同：15
> 
> 时间：2008-10-16T08:25:41.813
> 
> 标签：c++, stl

我知道如何用非平凡的初始值填充 std::vector，例如序列号：

```
void IndexArray( unsigned int length, std::vector<unsigned int>& v )
{
    v.resize(length);
    for ( unsigned int i = 0; i < length; ++i )
    {
        v[i] = i;
    }
} 
```

但这是一个for循环。**有没有一种优雅的方法可以使用 stl 功能（而不是**使用 Boost）用更少的代码行来做到这一点？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-16T08:28:10.187

您可以使用生成算法来获得更通用的填充容器的方法：

```
#include <iostream>
#include <algorithm>
#include <vector>

struct c_unique {
   int current;
   c_unique() {current=0;}
   int operator()() {return ++current;}
} UniqueNumber;

int main () {
  vector<int> myvector (8);
  generate (myvector.begin(), myvector.end(), UniqueNumber);

  cout << "\nmyvector contains:";
  for (vector<int>::iterator it=myvector.begin(); it!=myvector.end(); ++it)
    cout << " " << *it;

  cout << endl;

  return 0;
} 
```

[这是从cplusplusreference](http://www.cplusplus.com/reference/algorithm/generate.html)无耻地提升和编辑的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-16T11:13:18.090

我通常会`std::generate`加上一个简单的生成器：

```
template <typename T>
struct gen {
    T x;
    gen(T seed) : x(seed) { }

    T operator ()() { return x++; }
};

generate(a.begin(), a.end(), gen<int>(0)); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-16T08:39:03.940

如果您使用的是 SGI STL（或衍生产品，例如 STLPort），您可以使用[`iota`](http://www.sgi.com/tech/stl/iota.html). :-)

```
void IndexArray(unsigned int length, vector<unsigned int>& v)
{
    vector<unsigned int>(length).swap(v);
    iota(v.begin(), v.end(), 0);
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-16T12:00:09.243

[adobe.ASL](http://stlab.adobe.com/group__iota.html)中还有一个`iota()`函数，（还有一个[value_iterator](http://stlab.adobe.com/classadobe_1_1value__iterator.html)）。在 boost 中，有一个[count_iterator](http://www.boost.org/doc/libs/1_36_0/libs/iterator/doc/counting_iterator.html)，我怀疑还有其他一些方法可以在 boost 中动态生成数字序列。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-04-04T15:22:28.167

我知道这已经得到解答，但我更喜欢算法库中的“填充”函数，因为它对我来说似乎更直观：

```
// fill algorithm example
#include <iostream>
#include <algorithm>
#include <vector>
using namespace std;

int main () {
  vector<int> myvector (8);                       // myvector: 0 0 0 0 0 0 0 0

  fill (myvector.begin(),myvector.begin()+4,5);   // myvector: 5 5 5 5 0 0 0 0
  fill (myvector.begin()+3,myvector.end()-2,8);   // myvector: 5 5 5 8 8 8 0 0

  cout << "myvector contains:";
  for (vector<int>::iterator it=myvector.begin(); it!=myvector.end(); ++it)
    cout << " " << *it;

  cout << endl;

  return 0;
} 
```

这也无耻地从[cplusplusreference](http://www.cplusplus.com/reference/algorithm/fill/)中取消了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-16T17:01:21.273

如果你有一个 C 风格的数组，你可以使用 std:copy，例如，

```
int c_array[] = {3,4,5};

const int* pbegin = &c_array[0];
const size_t c_array_size = sizeof(c_array) / sizeof(c_array[0]);
const int* pend  = pbegin + c_array_size;

std::vector<int> v;
v.reserve(c_array_size);
std::copy(pbegin, pend, std:back_inserter(v)); 
```

# jquery - jQuery 最好的富文本编辑器是什么？

> ID：207774
> 
> 赞同：54
> 
> 时间：2008-10-16T08:27:29.610
> 
> 标签：jquery, richtextbox

Stackoverflow 网站上的类似这样的东西会很好！

或者与 jQuery $() 标签不冲突的非 jQuery 的东西会很棒。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-02-01T20:04:59.837

我很惊讶没有人提到**[markitup](http://markitup.jaysalvat.com/home/)**：

*标记！是一个基于 jQuery 库的 JavaScript 插件。它允许您将任何文本区域变成标记编辑器。Html、Textile、Wiki Syntax、Markdown、BBcode 甚至您自己的标记系统都可以轻松实现。*

![替代文字](https://farm4.static.flickr.com/3498/3858805498_e52286c88c.jpg)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-16T13:08:24.067

对我来说， [markitup](http://markitup.jaysalvat.com/home/ "标记") 是一个出色的编辑器。它将富文本作为标记编辑器，并允许您使用不同的标准：html、wiki、UBB 等……它还非常容易地允许插件。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2010-05-04T01:02:41.657

恕我直言，tinyMce 和 ckeditors 太臃肿了。我已经尝试了很多不同的编辑器，它们都是 jquery 插件，我觉得最好的一个是 HtmlBox。它非常小 = 14Kb 缩小（没有图标）并且不显眼。

我已经尝试了所有这些：1\. Avidan 编辑器 2\. Wymeditor 3\. ueditor 4\. RTE Jquery 5\. jwysiwyg (GNU2) 6\. jhtml area (Microsoft public license) 7\. htmlbox (mit license) 8\. TinyMCE (gnu) 9\. Ckeditor（以及FCKeditor）

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-09-09T18:05:38.710

CLEditor 是一个开源的 jQuery 插件，它提供了一个轻量级（仅超过 9K 的图标）、全功能、跨浏览器、可扩展、所见即所得的 HTML 编辑器，可以轻松添加到任何网站。[http://premiumsoftware.net/cleditor](http://premiumsoftware.net/cleditor)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-02-01T20:29:25.263

我个人使用 FCK，因为 Tiny MCE 不能很好地处理 html 编辑，html 中的小改动会产生很多 unececary html 标签。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-10-16T09:04:06.120

对于完整的 html（而不是 WMD 样式 b / i / a），我通常使用[http://www.fckeditor.net/](http://www.fckeditor.net/)。定制可能有点麻烦，但一旦到位就可靠。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-16T13:18:21.973

*   [WYMeditor](http://www.wymeditor.org/)（所见即所得）是一个 jQuery 插件。
*   [jWysiwyg](http://code.google.com/p/jwysiwyg/)是一种功能少得多的替代方案

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-10-16T13:21:12.810

我真的很喜欢 Yahoo 的[YUI 富文本编辑器](http://developer.yahoo.com/yui/editor/)。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-12-05T23:43:55.557

在这里你可以找到 10 个 jquery 和非 jquery 文本编辑器： [www.queness.com](http://www.queness.com/post/212/10-jquery-and-non-jquery-javascript-rich-text-editors)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-12-29T07:39:25.267

大规模杀伤性武器看起来不错。太糟糕了，它不使用 jquery 框架。TinyMce 非常大，可能会减慢页面加载速度。

看看这篇文章： [http ://www.queness.com/post/212/10-jquery-and-non-jquery-javascript-rich-text-editors](http://www.queness.com/post/212/10-jquery-and-non-jquery-javascript-rich-text-editors)

希望能帮助到你

-Towfiq I。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-11-11T06:57:02.433

我个人在我们的项目中使用 TinyMCE，易于集成和使用。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2010-11-24T16:39:08.750

背书：TinyMCE 是成熟的、积极维护的和有据可查的。它很容易扩展并在编辑时生成体面、有效的 XHTML。由于这些原因，过去三年我一直在应用程序中使用它。我已经尝试过上面提到的所有其他编辑器，但我一直在使用 TinyMCE。其他编辑器做得不够，或者功能扩展的速度太陡峭（YUI 编辑器除外）。

批评：TinyMCE 不会与 ASP.Net ScriptManager 和 UpdatePanel 控件 100% 顺利地互操作（TinyMCE 脚本没有错）。所有 TinyMCE 脚本的总大小加起来可以超过 1 MB，但在使用时会根据需要加载插件脚本。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-05-24T18:21:00.530

Markupit 最适合我，在这里找到了仅基于 jQuery 的富文本编辑器的列表：http: [//smashingwall.com/tools/jquery-rich-text-editors/](http://smashingwall.com/tools/jquery-rich-text-editors/)

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2011-01-31T20:15:28.847

我会说最好的非.jQuery 和 $() 无冲突的是 Dojo Toolkit 中的 dijit.Editor。看看[这里](http://dojotoolkit.org/reference-guide/dijit/Editor.html#dijit-editor)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2011-09-30T17:27:36.890

[WYM](http://www.wymeditor.org) Editor 可能是一个合理的解决方案。它生成 XHTML 严格的 W3C XHTML 希望对您有所帮助。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2012-09-17T13:26:19.667

[Aloha Editor](http://www.aloha-editor.org/ "Aloha Editor") is an upcoming HTML inplace editor. Its customizable as well to write our own plugins.

FYI: Drawback is that it has ~1MB of js file, if all the features are required. But, could be reduced by removing unwanted plugins.

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-01-14T16:06:34.377

Tiny MCE 是最好的恕我直言 - 我已经厌倦了很多，Tiny 拥有最好的功能，易于创建内容模板，易于设置在编辑器中显示和用于显示的 CSS，非常大的 API，很棒的皮肤等...

# iphone - 您如何设置 Eclipse 以进行 iPhone 开发（而不是 Xcode）？

> ID：207785
> 
> 赞同：51
> 
> 时间：2008-10-16T08:33:25.433
> 
> 标签：iphone, eclipse, macos

虽然我在为 iPhone 开发时越来越熟悉 Xcode，但有时我只是希望我有一个更好的 IDE，比如 Eclipse。

所以我想知道是否有人知道如何将 iPhone 项目迁移到 Eclipse，是否值得？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-16T10:33:26.033

XCode 在很多工作中主要使用标准的 Unix 工具。iPhone 应用程序是使用 GCC 4.0 编译的，它使用 gdb 进行调试，因此应该可以设置 Eclipse 以至少编译应用程序。

如果您查看“项目信息”窗格的“构建”部分（选择项目，点击 XCode 中的“信息”按钮，从顶部选择“构建”选项卡），您可以看到许多选项。

我不确定将文件复制到模拟器并附加调试器以进行测试运行需要什么，跳过所有的环节可能不值得，Apple 可能需要 XCode 生成的构建来接受应用程序进入应用商店。

对于常规代码编辑，您可能在 Eclipse 中工作得相当好，然后切换到 XCode 进行交互式调试。

大多数现有的 Eclipse 插件似乎都面向开发人员的 iPhone 感知 Web 应用程序，所以我不确定您是否会在那里获得任何帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-16T09:04:36.213

据我所知，您不能使用 Eclipse 或任何其他 IDE 为 iPhone 开发。Apple 仅支持 XCode，这在未来不会改变。所以我认为你必须习惯 XCode。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-08-28T21:24:02.610

在游戏后期，但您可能想用 JetBrains 的 AppCode 来踢轮胎，最终成为 xCode 的全功能替代品......并且与 IntelliJ 非常相似（GUI、工作流程等......）。到目前为止，它仍然是早期采用者，它可以很好地执行一些任务。我仍然使用 xCode 来配置构建选项和定位设备，但这最终会得到解决。

问候

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-03-25T08:40:26.880

交叉编译使您能够在 Eclipse 上开发 iPhone 应用程序 [http://www.youtube.com/watch?v=TG-NIt2O5J8](http://www.youtube.com/watch?v=TG-NIt2O5J8)

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2011-05-17T16:32:56.250

Eclipse 中没有支持 Apple IOS 应用程序开发的插件，但在 windows 上，您可以使用 Adob​​e CS5 进行开发。这是 Adob​​e 的强大工具之一，您可以在其中开发 Windows 上的 .ipa 应用程序，但在开始使用 Adob​​e CS5 开发 IOS 应用程序之前，您需要准备一些东西

# apache - 在 MAMP 启动时停止密码提示

> ID：207786
> 
> 赞同：22
> 
> 时间：2008-10-16T08:33:28.193
> 
> 标签：apache, macos, localhost, mamp

我在 Mac 上使用 MAMP pro 进行开发。当我启动 MAMP 时，如果我使用端口 80，它会提示我输入密码。如果我使用更高的端口，它不会提示我，但我必须在 URL 中附加端口号（例如 dev.local:8888 ）。有谁知道如何使它在使用标准端口时不提示输入密码？谢谢你。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2010-07-31T20:25:00.463

我整理了一个应用程序，即使在端口 80 上，也可以在没有密码请求的情况下启动/停止 MAMP 的 Apache 和 MySQL。它将密码存储在 Keychain 中，因此您只需输入一次。它也有一个漂亮的图标！

下载：[http ://www.46palermo.com/blog/run-mamp-without-password-easy-way/](http://www.46palermo.com/blog/run-mamp-without-password-easy-way/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-05T17:10:04.637

根据 living-e 代表的说法，他们正在考虑添加一个选项以将密码存储在钥匙串中：

[http://forum.webedition.de/phpBB/viewtopic.php?f=4&t=5517&p=12019](http://forum.webedition.de/phpBB/viewtopic.php?f=4&t=5517&p=12019)

更新：我缠着 Living-e 支持并让他们将其作为功能请求添加到他们的错误跟踪器中。链接在这里：http: [//qa.living-e.de/tracker/view.php](http://qa.living-e.de/tracker/view.php?id=3648) ?id=3648 （需要注册）如果你想关注它。

另一个更新：仍在关注这个问题。看起来 living-e 移动了他们的错误跟踪器，这个问题的新链接是：

[http://bugs.mamp.info/view.php?id=3652](http://bugs.mamp.info/view.php?id=3652)

它是德语，但谷歌翻译是：

> 何时启动和停止服务器，如果端口被用作低 1024th，则需要管理员密码 如果我们可以从 OS X 钥匙串/钥匙圈获取密码，让他们自己避免烦人的弹出广告。

或者说德语的人的翻译是：

> 当服务器启动/停止时，它每次都会询问管理员密码。如果它可以从 OS X Keychain / Keyring 获取密码，就可以避免烦人的弹出窗口。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-24T10:31:11.440

正如在[Macworld](http://hints.macworld.com/article.php?story=20100421070605258)上发现的并且汤姆在另一个答案中已经提到的那样，有一种使用 applescript 的方法！缺点是您必须以纯文本形式保存您的用户凭据。

1.  打开 AppleScript 编辑器
2.  输入以下代码替换`YOURPASSWORD`并`YOURUSERNAME`使用您的用户凭据
3.  将其保存为应用程序。您可能会勾选`run-only`以防止其他用户阅读纯文本作为一项小的安全措施

> ```
> do shell script "/Applications/MAMP/bin/startApache.sh &" password "YOURPASSWORD" user name "YOURUSERNAME" with administrator privileges
> do shell script "/Applications/MAMP/bin/startMysql.sh > /dev/null 2>&1" 
> ```

正确的文件路径可能存在问题，因为 MAMP 在某些版本中显然已更改`startmySQL.sh`为`startMysql.sh`，因此请仔细检查它是否不起作用！

您可以将新应用程序放在登录项（系统偏好设置 -> 用户和组 -> 登录项）中，这样 Apache 服务器和 MySQL 会自动启动，甚至不会在启动时显示 MAMP-App（静默启动）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-10-24T11:18:02.517

响应发布的命令：

1) 在端口 > 1024 上运行 MAMP

在 MAMP（nginx、apache、mysql）上运行端口范围高于 1024 的所有服务器允许您登录的 Mac OS X 帐户启动服务，因此在这种情况下不会要求您输入密码。任何在端口 1024 以下运行的服务器在执行时都需要 root 权限。

2) chmod -R a+w /tmp

此命令将递归遍历 /tmp 中的所有文件和子文件夹，并使它们对当前用户可写。当 MAMP 启动时，服务器会在此目录中创建临时文件。

此外，如果您决定要在端口 1024 以下运行服务器并希望使用不以纯文本形式存储密码的 applescript 解决方案，请参阅此链接[applescript password with keychain](https://stackoverflow.com/a/14599727/5626384)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-11-10T09:29:32.347

我现在使用[这两个applescripts](http://forum.mamp.info/viewtopic.php?t=634)来启动/停止MAMP，你可以保存启动脚本是一个登录项，所以当我启动时它总是启动。这确实意味着以纯文本形式存储您的密码，因为我是唯一一个使用这台机器的人，我可以忍受它，这比每天至少输入密码三次要好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-06-21T14:42:44.893

我将 apache 绑定到端口 8080，然后使用从 80 到 8080 的端口转发

```
sudo ipfw add 100 fwd 127.0.0.1,8080 tcp from any to any 80 in 
```

对我有用，但我正在努力使上述脚本永久化。到目前为止，我没有尝试过任何东西，所以我只是在重新启动后在终端中运行上面的命令。但是您可以在没有密码的情况下自由启动和停止 MAMP，并使用没有 :8080 或 :8888 的 URL。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-16T08:40:34.357

这是一个安全问题，MacOS 具有 UNIX 传统，如安全性（=Good Thing）。这就是 MacOS 一直要求输入密码的原因。据我所知，你对此无能为力。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-08-16T16:23:41.477

1) 在端口 > 1024 上运行 MAMP

2) chmod -R a+w /tmp

# c# - 使用实体框架/休眠与 sql2008 地理数据类型

> ID：207789
> 
> 赞同：1
> 
> 时间：2008-10-16T08:35:25.070
> 
> 标签：c#, sql-server-2008, geography

我正在使用 sql express 2008 和 vs2008，用 c# 编写。

我有一个带有 Geography 列的 db 表，我需要将我收集的 gps 数据放入其中。当我尝试为此表创建实体框架映射时，它只是忽略了该列，并发出一些关于无法映射此类列类型的警告。然后我查看了 nHibernate.Spatial 项目，但它似乎只翻译几何类型，而不是地理。那里没有运气。有人告诉我，我可以使用将 Geography 转换为 VarBinary 的视图，然后在创建的实体类中添加另一个将二进制反序列化回 Geography 的属性。我想这将适用于从数据库中读取数据，但我还需要将这些行插入到我的数据库中，并且我无法将行添加到视图中。我可以使用其他一些技巧来轻松地在我的 c# 代码中从我的数据库中读取和写入地理数据吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T23:18:34.490

我对 EF 了解不多，但 NHibernate 允许您使用`IUserType`. [Ray Houston 的博客](http://www.lostechies.com/blogs/rhouston/archive/2008/03/23/mapping-strings-to-booleans-using-nhibernate-s-iusertype.aspx)上有一些关于它的内容。

根据[Ayende 的示例，我已经成功地使用它来创建一个使用 XmlSerialization 到 Xml 字段的类型](http://ayende.com/78/section.aspx/download/98)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-06T20:57:05.400

此时 Entity Framework v1 不支持 SQL UDT - 2008 Spacial 类型为 UDT。

您可以使用 WKB (byte[]/varbinary) 存储您的 long/lat 数据。

附带说明一下，在 Microsoft MIX09 下一个版本（1.5 CTP）期间，我没有注意到对 UDT 的任何支持。也许我错过了什么。

# asp.net - ASP.Net AJAX 使用 $get('myId') 之类的语法，这是标准的 Javascript 还是 JQuery？

> ID：207791
> 
> 赞同：1
> 
> 时间：2008-10-16T08:36:58.500
> 
> 标签：asp.net, javascript, jquery, asp.net-ajax

它看起来不像基本的 javascript，但我也不能使用`$('myId')`. 这个或类似的功能是否记录在任何地方？

由于我不想进入的原因，我无法使用像 JQuery 这样的第三方库，但是如果一些强大的 javascript 扩展带有 asp，那么我想了解它们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-16T08:40:19.443

$get 是（现已弃用的）ms ajax 核心 javascript 库中的一个函数。将来他们将使用 jquery，因此 $get 将只是 $('#myid') 所以我不明白你对不使用 jQuery 的感受，MS 决定采用 OpenSource 并将其与 Visual Studio 捆绑在一起，查看 Scott Gu 和Hanslemans 在他们的博客上发布公告。

ms ajax $get('foo') 和 jQuery $('#someID') 都只是原生 javascript document.getElementById('bla') 的缩短包装器

ms ajax 文档[http://www.asp.net/ajax/documentation/](http://www.asp.net/ajax/documentation/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T11:14:51.550

需要记住的是，MS AJAX 的 $get() 函数返回与 document.getElementById() 相同的内容，而 JQuery 的 $() 函数返回具有不同属性和方法的特殊对象。虽然它们用于选择 DOM 中的元素，但由于 jQuery 的框架和大量可用的插件，$() 的功能要强大得多。

就采用等而言，Visual Studio 2008 和 Adob​​e 的 Dreamweaver CS4（我认为 CS3 也是如此）都具有集成 jQuery 的能力。虽然您被禁止使用 3rd 方库，但我希望您能够证明重新发明轮子或其他人已经完成的管道代码可能非常昂贵......特别是如果 3rd党图书馆是免费的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T08:58:23.713

$() 和 $get() 是简单的函数，它们返回一个对象集合和许多调用它们的方法。

您可以定义自己的 $：

```
 function $()
{
    alert('foo');
} 

$(); 
```

会提醒“foo”。

正如 redsquare 所指出的，jQuery 将很快与 Visual Studio 一起发布，因此您可以向您的管理层（我认为，这是您被禁止使用它的唯一原因）出售它不再是“第三方”： -)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-10T11:17:27.350

看看这个。 [http://msdn.microsoft.com/en-us/library/cc165447(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/cc165447%28v=vs.100%29.aspx) 共有 7 种快捷方式方法，分别是 $addHandler、$addHandlers、$clearHandlers、$create、$find、$获取和 $removeHandler

# flash - 你能推荐一个用于 OS X 的 Shockwave Flash (SWF) 到“电影”转换库吗？

> ID：207792
> 
> 赞同：-1
> 
> 时间：2008-10-16T08:37:33.303
> 
> 标签：flash, macos, video, format-conversion

我已经以各种方式在 Google 上搜索过了，而且不乏软件可以做到这一点。由于这是我不太可能再做的事情，我更喜欢免费的解决方案，但如果最好的解决方案需要，我也愿意付费。

我是一个相当熟练的多语言软件开发人员，所以如果有人知道可以做到这一点的库（并且可用于 OS X），我“自己动手”没有问题。

我有大量 SWF 文件用于我正在参加的培训课程，我想将它们转换为 H.264 以在我的 Apple TV 上使用，这样我就可以更轻松地在电视上观看它们。这必须是**Mac OS X**软件，与 Intel Leopard 机器兼容。

我不介意必须转换为中间格式，但直接转到 H.264 肯定会很好。

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-06-28T22:47:41.970

[Handbrake](http://handbrake.fr/)以 FLV 文件为源，可以转换为 h264。它是免费的，依赖于 VLC（在 Mac 上再次提供 64 位版本，因此您可以使用 Handbrake 64）并且可以管理处理队列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T09:18:46.637

你应该看看我经常使用的[ffmpegx ，它非常适合我的需求。](http://www.ffmpegx.com/)

但它看起来无法转换 .swf - 但请确保您应该尝试一下。它是免费软件。

打招呼

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T09:40:40.040

由于 Flash 是一种交互式、代码驱动的格式（即不像视频那样线性），您通常不能只转换为视频格式。即使您的 swf 是线性动画，仍然可能有 ActionScript 代码控制动画。

这对您来说意味着您只需要对 swf 进行良好的视频/音频捕获，您可以使用您选择的任何免费屏幕捕获软件（您可能需要一台快速的计算机）。

# xml - 将路径传递给模板

> ID：207793
> 
> 赞同：0
> 
> 时间：2008-10-16T08:38:03.397
> 
> 标签：xml, xslt

是否可以将诸如主题/名称之类的路径传递给模板，然后使用在模板中传递的路径作为路径而不是文本字符串。我发现路径被视为文本而不是路径。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T14:43:00.180

有一个 EXSLT 扩展函数`dyn:evaluate()`将字符串值计算为 XPath 表达式并返回结果（例如节点集）——请参阅[EXSLT 参考页](http://exslt.org/dyn/functions/evaluate/index.html)。根据该页面，libxslt、Xalan-J 和 4XSLT 实现了该功能。Saxon 也实现了它，但在它自己的名称空间中而不是在 EXSLT 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T03:17:08.067

我取决于你想做什么。如果路径指向 xml 文件，那么您可以使用 document(filename) 语法将文件的内容放入 xsl 变量中。

```
<xsl:varialble name="myvar" select="document(somepath)/somenode" /> 
```

请注意，首先该文件存在，其次要注意最新解析器中的 msxml 安全设置，默认情况下限制您访问其他文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T09:01:26.670

XPath 或 XSLT 中没有路径数据类型，所以没有。你想对这个参数执行什么样的操作？获取有关路径指向的文件的信息？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T19:58:28.937

Saxon 实现了扩展函数[saxon:evaluate()](http://saxonica.com/documentation/extensions/functions/evaluate.html)和[saxon:evaluate-node()](http://saxonica.com/documentation/extensions/functions/evaluate-node.html)。

# c - 是什么导致这个整数指针重新分配崩溃？

> ID：207800
> 
> 赞同：3
> 
> 时间：2008-10-16T08:41:01.580
> 
> 标签：c, pointers

我是 C 新手，我有这个问题。为什么以下代码会崩溃：

```
int *a = 10;
*a = 100; 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-10-16T08:46:36.700

因为您正在尝试将 100 写入内存位置 0x0000000A，这可能未分配给您的程序。那是，

```
int *a = 10; 
```

并不意味着指针'a'将指向内存中值为10的位置。这意味着它指向内存中的地址10（0x0000000A）。然后，您想在该地址中写入一些内容，但您没有这样做的“权利”，因为它没有被分配

您可以尝试以下方法：

```
int *a = malloc(sizeof(int));
*a = 100; 
```

这会奏效，尽管效率极低。如果您只需要一个 int，则应该将其放入[堆栈，而不是堆](https://stackoverflow.com/questions/24891/c-memory-management)。在 32 位架构上，指针的长度为 32 位，而 int 的长度也为 32 位，因此指向 int 的指针结构占用（[至少](https://stackoverflow.com/questions/197839/is-there-any-way-to-determine-the-size-of-a-c-array-programmatically-and-if-not#197872)）8 个字节的内存空间，而不是 4 个。我们甚至还没有提到缓存问题。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-16T08:45:38.107

您需要将指针分配给*内存位置*，而不是任意值 (10)。

```
int cell = 10;
int *a = &cell; // a points to address of cell
*a = 100;       // content of cell changed 
```

请参阅[我](https://stackoverflow.com/questions/205911/any-tools-to-catch-silly-mistakes-in-c-code#205965)对另一个问题的回答，关于小心*C*。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-16T09:00:52.163

对于建议使用它为 int 分配内存的所有答案，我想建议对 malloc() 的使用稍作改变。代替：

```
a = malloc(sizeof(int)); 
```

我建议不要重复变量的类型，因为编译器知道这一点并手动重复它会使代码更加密集，并引入错误风险。如果您稍后将声明更改为例如

```
long *a; 
```

如果不更改分配，您最终会分配错误的内存量（在一般情况下，在 32 位机器上`int`并且`long`通常大小相同）。国际海事组织，最好使用：

```
a = malloc(sizeof *a); 
```

这只是表示“a 指向的类型的大小”，在这种情况下`int`，这当然是完全正确的。如果像上面那样改变声明中的类型，这一行仍然是正确的。如果您更改赋值左侧的变量名称，仍然存在风险，但至少您不再不必要地重复信息。

另请注意，`sizeof`在实际对象（即变量）上使用它时不需要括号，只需要类型名称，它看起来像强制转换表达式。`sizeof`不是函数，而是运算符。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-16T08:45:49.433

因为你从来没有为 a 分配任何内存。您刚刚为指向 a 的指针分配了一些堆栈空间。

```
int *a = NULL;

a = malloc (sizeof (int));

如果（一个！= NULL）
{
*a =10；
}

```

将工作。

或者，您可以提供一些现有变量的地址，这也可以。

IE

```
int a* = NULL；
诠释 b = 10;

a = &b;

```

这现在意味着做类似的事情

```
*a = 100;

```

还将 b 设置为 == 100

看看这个： [http ://home.netcom.com/~tjensen/ptr/pointers.pdf](http://home.netcom.com/~tjensen/ptr/pointers.pdf)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-16T08:46:33.753

下一行，

```
int *a = 10; 
```

定义一个指向整数**a**的指针。然后将指针 a*指向*内存位置 10。

下一行，

```
*a = 100; 
```

将值 100 放入 a 指向的内存位置。

问题是：

1.  你不知道 a 指向哪里。（你不知道内存位置 10 的值）
2.  无论 a 指向何处，您都可能无权更改该值。它可能是其他一些程序/进程的内存。你这个贼！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-16T08:45:49.933

因为您声明了一个指向 int 的指针，**所以将指针**初始化为 10（一个地址），然后尝试为该地址处的一个 int 赋值。由于地址 10 的内存不属于您的进程，因此您会崩溃。这应该有效：

```
int *a;
a = malloc(sizeof(int));
*a = 10;
printf("a=%i\n", *a);
free(a); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-16T08:46:00.820

这段代码甚至可以编译吗？10 不能转换为`int *`，除非你像这样转换它：

```
int *a = (int *) 10;
*a = 100; 
```

在这种情况下，您尝试将 100 写入 10 处的内存地址。这通常不是有效的内存地址，因此您的程序会崩溃。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-16T08:46:52.253

它可能会崩溃，因为您将指针分配给您无权访问的内存部分，然后您为该内存位置分配了一些值（不允许这样做！）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-16T09:23:14.083

好的，今天试图给出最简单的解释，同时试图给你更详细的图片。让我们添加一些括号好吗？

```
(int*) a = 10;
(*a) = 100; 
```

您尝试将四个字节写入地址范围 [10-13]。您的程序的内存布局通常开始较高，因此您的应用程序不会意外覆盖它可以并且仍然起作用的任何内容（例如，来自 .data、.bss 和堆栈）。所以它最终会崩溃，因为地址范围尚未分配。

指针指向内存位置，C 静态类型定义指针的类型。尽管您可以轻松地覆盖指针。简单地：

```
(void*) v = NULL; 
```

在这里，我们更进一步。什么是空指针？它只是指向地址 0 的指针。

您还可以为指针提供结构类型：

```
struct Hello {
    int id;
    char* name;
};

...

struct Hello* hello_ptr = malloc(sizeof Hello);
hello_ptr->id = 5;
hello_ptr->name = "Cheery"; 
```

好的，什么是malloc？Malloc 分配内存并返回一个指向已分配内存的指针。它具有以下类型签名：

```
void* malloc(size_t size); 
```

如果您没有保守的垃圾收集器，您的内存很可能最终不会被自动释放。因此，如果您想从刚刚分配的内存中恢复使用，您必须执行以下操作：

```
free(hello_ptr); 
```

您所做的每个 malloc 中都有一个大小标签，因此您无需说明您为 free 例程指向的块的大小。

好的，还有一件事，字符串在内存中是什么样子的？例如，类似于“Cheery”的那个。简单的回答。它是一个以零结尾的字节数组。

```
0.1.2.3.4.5\. 6
C h e e r y \0 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-16T09:26:51.363

你也可以这样写：

```
int* a = 10;
*a = 100; 
```

注意第一行的不同间距。这不是流行的风格，但我个人认为它更清晰。它对编译器具有完全相同的含义。

然后，大声朗读：

```
"Pointer-to-int 'a' becomes 10"
"Value-pointed-to-by 'a' becomes 100" 
```

代入实际值：

```
"Value-pointed-to-by 10 becomes 100" 
```

...您意识到 10 不太可能指向您可以使用的一块内存。

您几乎永远不会分配给带有文字的指针：

```
int* ptr = (int*)10;  // You've guessed at a memory address, and probably got it wrong
int* ptr = malloc(sizeof(int)); // OS gives you a memory address at runtime 
```

我想可能有一些*非常*低级的工作，您可以直接指定绝对内存地址。例如内核实现？

# mysql - 管理大量数据和图像

> ID：207801
> 
> 赞同：4
> 
> 时间：2008-10-16T08:41:45.150
> 
> 标签：mysql, sql-server, oracle, postgresql, gis

我的问题与此处发布的其他朋友相似……我们正在尝试开发一个应用程序，该应用程序支持基于巴拉圭土地登记处的可能 TB 级信息，其中包含图像和正常数据。

问题是我们希望尽可能地降低运营成本，因为这就像公司之间的竞争，因此我们想使用免费数据库....我已经阅读了很多关于它的信息但我仍然很困惑。我们必须意识到要使用它的人是政府人员，因此数据库必须同时易于管理。

你会推荐我什么？

塔努非常

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T12:31:46.887

MySQL 甚至 SQLite 已经有了空间索引，所以没有问题。

要存储数据文件，您可以使用 BLOB 字段，但存储为文件通常会更好（并且更容易优化）。要保留与数据库记录相关的文件，您可以将完整路径（或 URL）放在 varchar 字段中，或者将图像存储在由记录 ID 计算的路径中。

要轻松扩展到多 TB 存储，请从一开始就计划使用多台服务器。如果数据以读取为主，一个简单的方法是将图像存储在不同的主机上，每个主机都有一个静态 HTTP 服务器，并且数据库记录每个图像的位置。然后为数据库放置一个 webapp 前端，其中每个图像的 URL 直接指向适当的存储服务器。这样，您就可以继续添加存储，而不会在“中央”服务器上造成瓶颈。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T12:54:47.153

听起来图像文件将占用您大量的存储空间。不要将它们存储在数据库中，只需将文件位置详细信息存储在数据库中。

（如果您想通过 Internet 访问，请尝试[Amazon Storage](http://aws.amazon.com/s3/)。它不是免费的，但非常便宜，并且他们为您处理可扩展性。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-16T08:53:03.083

[Postgresql](http://www.postgresql.org/)、[SQL Server 2008](http://www.microsoft.com/SQL/default.mspx)和[任何最新版本的 Oracle](http://www.oracle.com/database/index.html)都具有空间索引、表分区和 BLOB，并且能够充当大型地理数据库的后端。您可能还想查看两个开源 GIS 应用程序：[GRASS](http://grass.itc.it/)和[QGIS](http://www.qgis.org/)，与编写定制应用程序相比，它们可能支持用更少的修改工作来做您想做的事情。两者都可以使用 Postgresql 和其他数据库后端。

至于支持，任何商业或开源数据库都需要有能力的 DBA 的关注，如果你想让它在 TB 大小的数据库上运行良好。我认为您不会摆脱纯最终用户支持的模式——尝试这样做不太可能奏效。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-16T13:50:35.153

关于使用 B/C/LOB 的另一个注意事项，因为我一直被通过在数据库中存储在内部而被指数级数据库增长所困扰。

如何将 GIS 地图存储在单独的服务器上，然后将区域的 LAT/LONG“形状”存储在数据库中。GIS 可以单独更新，而无需将图像存储在主数据库中。

对管理员来说更小。备份成本更低。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-24T15:43:32.317

使用 ESRI 的图像服务器。您不需要数据库来提供图像。它非常易于使用。它还可以处理文件及其快速并处理许多图像格式。此外，它还可以即时进行图像处理并支持许多客户端。AutoCAD、Microstation、ArcMap、ArcIMS、ArcServer...等。

[图像服务器](http://www.esri.com/software/arcgis/serverimage/index.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-16T10:28:51.330

虽然不符合您的免费标准，但我强烈建议您考虑使用 SQL Server 2008，因为此版本中的两个 Gfeature 可能会有所帮助：

*   FILESTREAM - 允许您将二进制图像存储在文件系统中，而不是在数据库本身中。这将使您的数据库更易于管理，同时仍然允许您以通常的方式查询数据。

*   地理数据类型 - 对地理空间（纬度/经度）数据类型的支持可能对您的解决方案非常有价值。

祝你好运！

# php - 将 Google 搜索查询转换为 PostgreSQL“tsquery”

> ID：207817
> 
> 赞同：4
> 
> 时间：2008-10-16T08:48:14.093
> 
> 标签：php, postgresql, parsing, full-text-search, google-search

如何将 Google 搜索查询转换为可以提供 PostgreSQL 的 to_tsquery() 的内容？

如果那里没有现有的库，我应该如何用 PHP 之类的语言解析 Google 搜索查询？

例如，我想采用以下 Google-ish 搜索查询：

```
("used cars" OR "new cars") -ford -mistubishi 
```

并将其转换为对 to_tsquery() 友好的字符串：

```
('used cars' | 'new cars') & !ford & !mistubishi 
```

我可以用正则表达式捏造这个，但这是我能做的最好的。是否有一些强大的词法分析方法来解决这个问题？我也希望能够支持扩展搜索运算符（例如 Google 的 site: 和 intitle:），它们将适用于不同的数据库字段，因此需要与 tsquery 字符串分开。

更新：我意识到，使用特殊运算符，这将成为 Google 到 SQL WHERE 子句的转换，而不是 Google 到 tsquery 的转换。但是 WHERE 子句可能包含一个或多个 tsqueries。

例如，谷歌风格的查询：

```
((color:blue OR "4x4") OR style:coupe) -color:red used 
```

应该产生这样的 SQL WHERE 子句：

```
WHERE to_tsvector(description) MATCH to_tsquery('used')
  AND color <> 'red'
  AND ( (color = 'blue' OR to_tsvector(description) MATCH to_tsquery('4x4') )
    OR style = 'coupe'
  ); 
```

我不确定正则表达式是否可以实现上述操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T17:31:33.850

老实说，我认为正则表达式是处理这种事情的方法。同样，这是一个有趣的练习。下面的代码非常典型——事实上，你会看到我什至没有实现词法分析器本身——我只是伪造了输出。我想继续它，但我今天没有更多的空闲时间。

此外，在支持其他类型的搜索运算符等方面，这里肯定还有很多工作要做。

基本上，这个想法是对某种类型的查询进行词法分析，然后将其解析为一种通用格式（在本例中为 QueryExpression 实例），然后将其呈现为另一种类型的查询。

```
<?php

ini_set( "display_errors", "on" );
error_reporting( E_ALL );

interface ILexer
{
    public function execute( $str );
    public function getTokens();
}

interface IParser
{
    public function __construct( iLexer $lexer );
    public function parse( $input );
    public function addToken( $token );
}

class GoogleQueryLexer implements ILexer
{
    private $tokenStack = array();

    public function execute( $str )
    {
        $chars = str_split( $str );
        foreach ( $chars as $char )
        {
            //  add to self::$tokenStack per your rules
        }

        //'("used cars" OR "new cars") -ford -mistubishi'
        $this->tokenStack = array(
                '('
            ,   'used cars'
            ,   'or new cars'
            ,   ')'
            ,   '-ford'
            ,   '-mitsubishi'
        );
    }

    public function getTokens()
    {
        return $this->tokenStack;
    }
}

class GoogleQueryParser implements IParser
{
    protected $lexer;

    public function __construct( iLexer $lexer )
    {
        $this->lexer = $lexer;
    }

    public function addToken( $token )
    {
        $this->tokenStack[] = $token;
    }

    public function parse( $input )
    {
        $this->lexer->execute( $input );
        $tokens = $this->lexer->getTokens();

        $expression = new QueryExpression();

        foreach ( $tokens as $token )
        {
            $expression = $this->processToken( $token, $expression );
        }

        return $expression;
    }

    protected function processToken( $token, QueryExpression $expression )
    {
        switch ( $token )
        {
            case '(':
                return $expression->initiateSubExpression();
                break;
            case ')':
                return $expression->getParentExpression();
                break;
            default:
                $modifier   = $token[0];
                $phrase     = substr( $token, 1 );
                switch ( $modifier )
                {
                    case '-':
                        $expression->addExclusionPhrase( $phrase );
                        break;
                    case '+':
                        $expression->addPhrase( $phrase );
                        break;
                    default:
                        $operator   = trim( substr( $token, 0, strpos( $token, ' ' ) ) );
                        $phrase     = trim( substr( $token, strpos( $token, ' ' ) ) );
                        switch ( strtolower( $operator ) )
                        {
                            case 'and':
                                $expression->addAndPhrase( $phrase );
                                break;
                            case 'or':
                                $expression->addOrPhrase( $phrase );
                                break;
                            default:
                                $expression->addPhrase( $token );
                        }
                }
        }
        return $expression;
    }
}

class QueryExpression
{
    protected $phrases = array();
    protected $subExpressions = array();
    protected $parent;

    public function __construct( $parent=null )
    {
        $this->parent = $parent;
    }

    public function initiateSubExpression()
    {
        $expression = new self( $this );
        $this->subExpressions[] = $expression;
        return $expression;
    }

    public function getPhrases()
    {
        return $this->phrases;
    }

    public function getSubExpressions()
    {
        return $this->subExpressions;
    }

    public function getParentExpression()
    {
        return $this->parent;
    }

    protected function addQueryPhrase( QueryPhrase $phrase )
    {
        $this->phrases[] = $phrase;
    }

    public function addPhrase( $input )
    {
        $this->addQueryPhrase( new QueryPhrase( $input ) );
    }

    public function addOrPhrase( $input )
    {
        $this->addQueryPhrase( new QueryPhrase( $input, QueryPhrase::MODE_OR ) );
    }

    public function addAndPhrase( $input )
    {
        $this->addQueryPhrase( new QueryPhrase( $input, QueryPhrase::MODE_AND ) );
    }

    public function addExclusionPhrase( $input )
    {
        $this->addQueryPhrase( new QueryPhrase( $input, QueryPhrase::MODE_EXCLUDE ) );
    }
}

class QueryPhrase
{
    const MODE_DEFAULT = 1;
    const MODE_OR = 2;
    const MODE_AND = 3;
    const MODE_EXCLUDE = 4;

    protected $phrase;
    protected $mode;

    public function __construct( $input, $mode=self::MODE_DEFAULT )
    {
        $this->phrase = $input;
        $this->mode = $mode;
    }

    public function getMode()
    {
        return $this->mode;
    }

    public function __toString()
    {
        return $this->phrase;
    }
}

class TsqueryBuilder
{
    protected $expression;
    protected $query;

    public function __construct( QueryExpression $expression )
    {
        $this->query = trim( $this->processExpression( $expression ), ' &|' );
    }

    public function getResult()
    {
        return $this->query;
    }

    protected function processExpression( QueryExpression $expression )
    {
        $query = '';
        $phrases = $expression->getPhrases();
        $subExpressions = $expression->getSubExpressions();

        foreach ( $phrases as $phrase )
        {
            $format = "'%s' ";
            switch ( $phrase->getMode() )
            {
                case QueryPhrase::MODE_AND :
                    $format = "& '%s' ";
                    break;
                case QueryPhrase::MODE_OR :
                    $format = "| '%s' ";
                    break;
                case QueryPhrase::MODE_EXCLUDE :
                    $format = "& !'%s' ";
                    break;
            }
            $query .= sprintf( $format, str_replace( "'", "\\'", $phrase ) );
        }

        foreach ( $subExpressions as $subExpression )
        {
            $query .= "& (" . $this->processExpression( $subExpression ) . ")";
        }
        return $query;
    }
}

$parser = new GoogleQueryParser( new GoogleQueryLexer() );

$queryBuilder = new TsqueryBuilder( $parser->parse( '("used cars" OR "new cars") -ford -mistubishi' ) );

echo $queryBuilder->getResult(); 
```

# sql-server-2005 - SQL Server 2005 中数据库加密的最佳实践

> ID：207819
> 
> 赞同：8
> 
> 时间：2008-10-16T08:49:26.180
> 
> 标签：sql-server-2005, encryption

我需要开发一个将数据存储在 SQL Server 2005 数据库中的应用程序（应用程序本身将是 WCF 服务或 Asp.Net Web 服务）。

现在，这些数据是高度机密的，我需要将其以加密形式存储在数据库中。

所以，我想知道这方面的最佳实践是什么。我知道 SQL Server 内置了一些加密功能。是否有“傻瓜”类型的资源，以便我可以快速开始。

或者，我在想我可以在我的 C# 代码中而不是在数据库中加密/解密——也许有一个层可以在数据访问层之上处理这个问题（这是个好主意）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T09:57:34.297

查看[此链接](http://blogs.technet.com/keithcombs/archive/2005/11/24/sql-server-2005-data-encryption.aspx)以获取有关示例的良好介绍。

我认为在应用程序中进行数据加密更好，因为在这种情况下传输的数据已经加密。否则，您必须在应用程序和数据库服务器之间使用安全通道。

这取决于你的需要，我会说。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T11:22:00.007

您是否考虑过在[文件系统](http://en.wikipedia.org/wiki/BitLocker_Drive_Encryption)级别加密数据？

它仅适用于 Windows 2008/Vista，但它应该能够满足您的需求，这正是它的设计目的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T18:20:55.693

在决定加密方法之前，您需要访问系统的哪些部分易受攻击。如果存在未经授权访问数据库的可能性，您的应用程序是否存在同样的威胁？有人可以通过 Reflector 运行您的代码，并确定使用了哪些方法来加密和解密。您可以使用代码混淆器在一定程度上减轻这种风险。如果这种担忧不是风险，那么您可能会发现在应用程序级别加密数据更容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-07T15:01:01.733

根据应用程序的不同，加密需要在几个不同的地方进行。例如，使用信用卡信息的消费者网站需要对网络连接进行加密，以防止中间人攻击或窥探。当数据存储在数据库中时，您需要对数据进行加密，以便低级别的销售代表无法读取和访问客户的信用卡信息，如果您在此之外，您可能还需要执行列级加密作为适当的权限。担心有一天您的数据中心的管理员可能会窃取您的一份备份，然后您需要实施 TDE 来在磁盘级别加密数据。

加密有性能开销，尤其是 CPU 使用率，更重要的是开销取决于用于加密的算法。

# .net - 如何从自定义操作强制回滚设置？

> ID：207823
> 
> 赞同：2
> 
> 时间：2008-10-16T08:50:26.960
> 
> 标签：.net, installation, setup-project

我正在.NET 中创建安装程序并使用自定义操作来控制安装。现在我需要检查某些条件，并根据这些条件我必须继续安装或回滚安装。

如何从自定义操作中强制回滚设置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T08:56:53.687

这里有两个资源（这将回答你的问题）：

*   [http://community.installshield.com/showthread.php?t=141844](http://community.installshield.com/showthread.php?t=141844)
*   [http://www.installsite.org/pages/en/isnews/200108/](http://www.installsite.org/pages/en/isnews/200108/)

# javascript - 如何在 JSDT 大纲视图中指示 public/protected/private 成员？

> ID：207824
> 
> 赞同：1
> 
> 时间：2008-10-16T08:50:34.040
> 
> 标签：javascript, eclipse, ide, jsdt

[用于 Eclipse 的Javascript 开发人员工具](http://wiki.eclipse.org/index.php/ATF/JSDT)(JSDT) 提供了 Javascript 类的漂亮大纲视图，它们旁边有一个小符号表示可见性。

查看*Preferences->Javascript->Appearance->Members Sort Order*，它似乎能够指示一个方法是公共的、私有的还是受保护的，但我都使用“默认”标记，一个蓝色三角形。

有谁知道它如何确定使用哪个符号？我尝试过使用 Javadoc 和 JSDoc 格式的注释。我的私有方法以前导下划线开头，这也没有给出提示。

没什么大不了的，只是很高兴知道...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-12T00:32:43.987

似乎它只是一个标准的基于 Java 的设置树（在许多插件中使用），但没有真正实现 JS[私有成员](http://javascript.crockford.com/private.html)的东西。哦，我们可以希望它保留以供将来使用:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T00:51:20.133

*在 JavaScript 中没有将方法设为私有、公共*或*受保护*的语法方式，它严格依赖于方法的定义位置（范围）。

*标记*方法的隐私是另一回事，实际上并没有标准。我只听说过私人成员的“下划线”。所以也许 JSDT 没有实现这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T06:27:55.063

我相信`@private`JSDoc 支持注释。不确定它有多标准，或者 JSDT 是否支持/强制执行它。

由于 JSDT 是 JDT 接口的重新实现，它可能只是尽可能地重用 JDT 的私有/受保护/公共模型，而没有实际的方法来标记字段/方法以进行访问控制。

# vb.net - 有没有关于 VB.Net 项目文件结构的好的文档？

> ID：207825
> 
> 赞同：0
> 
> 时间：2008-10-16T08:51:01.560
> 
> 标签：vb.net, file, documentation, project, specifications

我需要开始弄乱一个 vb.net(vs2008) 项目文件，并且我想要一个参考，理想情况下，它是规范。

任何链接都会非常有帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T09:30:38.657

嗬！正如我应该知道的那样……VB.Net 项目只不过是一个 MSBuild 文件。

详细信息 -> [http://msdn.microsoft.com/en-us/library/ms171452.aspx](http://msdn.microsoft.com/en-us/library/ms171452.aspx)

# java - 在 Java 6 中用于同时访问列表的最佳方法

> ID：207829
> 
> 赞同：7
> 
> 时间：2008-10-16T08:52:25.847
> 
> 标签：java, collections, concurrency

我有一个被多个线程访问的 List 对象。更新列表的主要是一个线程，在某些情况下是两个线程。根据正在处理的用户请求的数量，可以从该列表中读取一到五个线程。该列表不是要执行的任务队列，它是同时检索和更新的域对象的列表。

现在有几种方法可以使对该列表的访问成为线程安全的：
- 使用同步块
- 使用普通*锁*（即读写操作共享相同的锁）
- 使用 ReadWriteLock *-*
使用新的*ConcurrentBLLABLBA*集合类之一

**我的问题：**
考虑到关键部分通常不包含很多操作（主要是添加/删除/插入或从列表中获取元素），最佳的使用方法是什么？
你能推荐另一种方法，上面没有列出吗？

**一些限制**
- 最佳性能至关重要，内存使用量不大
- 它必须是有序列表（当前在*ArrayList*上同步），尽管不是排序列表（即不使用 Comparable 或 Comparator 排序，而是根据插入顺序）
-列表很大，最多包含 100000 个域对象，因此使用 CopyOnWriteArrayList 之类的东西是不可行
的 - 写入/更新关键部分通常非常快，执行简单的添加/删除/插入或替换（设置​​）
- 读取操作将主要执行一个 elementAt(index) 调用大部分时间，虽然一些读取操作可能会进行二进制搜索，或者 indexOf(element)
- 没有对列表进行直接迭代，尽管像 indexOf(..) 这样的操作将遍历列表

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T09:32:59.760

您必须使用顺序列表吗？如果映射类型结构更合适，您可以使用`ConcurrentHashMap`. 使用列表，a`ReadWriteLock`可能是最有效的方法。

编辑以反映 OP 的编辑：对插入顺序进行二进制搜索？您是否在二进制搜索中存储时间戳并将其用于比较？如果是这样，您可以使用时间戳作为键，并`ConcurrentSkipListMap`作为容器（维护键顺序）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T08:58:14.463

阅读线程在做什么？如果他们正在迭代列表，那么您确实需要确保在整个迭代过程中没有人接触列表，否则您可能会得到非常奇怪的结果。

如果您可以准确定义所需的语义，则应该可以解决该问题 - 但您可能会发现您需要编写自己的集合类型才能正确有效地完成它。或者，[CopyOnWriteArrayList](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/CopyOnWriteArrayList.html)可能已经足够好 - 如果可能很昂贵。基本上，你越能约束你的要求，它就越有效率。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T10:05:14.233

我不知道这是否是解决问题的可行方案，但是......对我来说，使用数据库管理器来保存大量数据并让它管理事务是有意义的

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-16T15:09:04.590

我[赞同 Telcontar](https://stackoverflow.com/questions/207829/best-approach-to-use-in-java-6-for-a-list-being-accessed-concurrently#208009)对数据库的建议，因为它们实际上是为管理这种规模的数据和线程之间的协商而设计的，而内存中的集合则不是。

您说数据在服务器上的数据库中，客户端上的本地列表是为了用户界面。您不需要一次将所有 100000 个项目保留在客户端上，或者对其执行如此复杂的编辑。在我看来，您在客户端上想要的是数据库上的轻量级缓存。

编写一个缓存，一次只存储客户端上的当前数据子集。此客户端缓存不对自己的数据执行复杂的多线程编辑；相反，它将所有编辑内容提供给服务器，并监听更新。当服务器上的数据发生变化时，客户端会简单地忘记旧数据并重新加载它。只允许一个指定线程读取或写入集合本身。这样，客户端只需镜像服务器上发生的编辑，而不需要复杂的编辑本身。

是的，这是一个相当复杂的解决方案。它的组成部分是：

*   用于加载一系列数据的协议，例如项目 478712 到 478901，而不是整个数据
*   用于接收有关更改数据的更新的协议
*   一个缓存类，通过它们在服务器上的已知索引存储项目
*   属于与服务器通信的缓存的线程。这是写入集合本身的唯一线程
*   属于该缓存的线程，在检索数据时处理回调
*   UI 组件实现的接口，以允许它们在加载数据时接收数据

乍一看，这个缓存的骨骼可能看起来像这样：

```
class ServerCacheViewThingy {
    private static final int ACCEPTABLE_SIZE = 500;
    private int viewStart, viewLength;
    final Map<Integer, Record> items
            = new HashMap<Integer, Record>(1000);
    final ConcurrentLinkedQueue<Callback> callbackQueue
            = new ConcurrentLinkedQueue<Callback>();

    public void getRecords (int start, int length, ViewReciever reciever) {
        // remember the current view, to prevent records within
        // this view from being accidentally pruned.
        viewStart = start;
        viewLenght = length;

        // if the selected area is not already loaded, send a request
        // to load that area
        if (!rangeLoaded(start, length))
            addLoadRequest(start, length);

        // add the reciever to the queue, so it will be processed
        // when the data has arrived
        if (reciever != null)
            callbackQueue.add(new Callback(start, length, reciever));
    }

    class Callback {
        int start;
        int length;
        ViewReciever reciever;
        ...
    }

    class EditorThread extends Thread {

        private void prune () {
            if (items.size() <= ACCEPTABLE_SIZE)
                return;
            for (Map.Entry<Integer, Record> entry : items.entrySet()) {
                int position = entry.key();
                // if the position is outside the current view,
                // remove that item from the cache
                ...
            }
        }

        private void markDirty (int from) { ... }

        ....
    }

    class CallbackThread extends Thread {
        public void notifyCallback (Callback callback);
        private void processCallback (Callback) {
            readRecords
        }
    }
}

interface ViewReciever {
    void recieveData (int viewStart, Record[] records);
    void recieveTimeout ();
} 
```

显然，您必须自己填写很多细节。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-23T15:32:34.703

您可以使用实现同步的包装器：

```
import java.util.Collections;
import java.util.ArrayList;

ArrayList list = new ArrayList();
List syncList = Collections.synchronizedList(list);

// make sure you only use syncList for your future calls... 
```

这是一个简单的解决方案。在诉诸更复杂的解决方案之前，我会先尝试一下。

# forms - 在基于 Windows 窗体的应用程序中使用默认浏览器重定向到链接

> ID：207830
> 
> 赞同：1
> 
> 时间：2008-10-16T08:52:28.030
> 
> 标签：forms, redirect, hyperlink

我不使用： Process.Start(String, String) 打开链接。但每次浏览器打开新标签页或新窗口时都会打开链接。有没有办法在最新打开的页面中打开链接？只是重定向，没有新标签或新窗口？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T08:57:46.943

这实际上不是由您（程序员）决定，而是由用户决定：某些浏览器可以选择此设置。您不应该尝试修改用户选择的浏览器行为。

我团队中的某个人在我们正在编写的即时通讯应用程序中做过一次，没有先征求其他意见。用户对我们的应用程序不断覆盖他们打开的页面感到非常恼火。

# java - 在 Java 中解析许多复杂的命令行参数的最佳方法是什么？

> ID：207831
> 
> 赞同：9
> 
> 时间：2008-10-16T08:52:56.003
> 
> 标签：java, command-line

我在 Python 中使用了 getopt，并希望在 Java 中也有类似的东西。

请说明您的答案比其他答案更好的原因。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-16T09:28:48.193

[共享 CLI](http://commons.apache.org/cli/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-16T09:36:45.087

我使用[Jewelcli](http://jewelcli.sourceforge.net/index.html)，它非常好。

您还可以[在此处](http://furiouspurpose.blogspot.com/2008/07/command-line-parsing-libraries-for-java.html)找到有关不同可用库的讨论。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-16T09:56:35.360

[https://github.com/kohsuke/args4j](https://github.com/kohsuke/args4j) -- 有相当不错的功能加上 MIT 许可证

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-10-13T18:31:52.360

查看 Java 简单参数解析器。非常成熟且功能完整的 Java 参数解析器。[JSAP](http://martiansoftware.com/jsap/)

# file-io - gmail如何处理文件附件？

> ID：207833
> 
> 赞同：1
> 
> 时间：2008-10-16T08:53:35.953
> 
> 标签：file-io

当我在 gmail 撰写屏幕中选择要附加的文件时，它会自动将文件上传到服务器而无需刷新页面。我通过 FireBug 查看了 html 源代码，并没有看到 iframe。他们如何上传附件？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T08:57:31.967

[这里](http://www.sajithmr.com/upload-files-like-gmail/)有一个例子和小文章。

# asp.net - ReportViewer 控件不允许导出

> ID：207836
> 
> 赞同：1
> 
> 时间：2008-10-16T08:54:49.367
> 
> 标签：asp.net, reporting-services, reportviewer

1) 我在链接到 ServerReport 的页面上有一个 ReportViewer 控件（我使用的是 ASP.NET 2.0）。报告显示正常，但“导出”链接存在但已禁用，并且“选择格式”下拉列表（在 Reporting Services 中查看报告时通常可见）不存在。有任何想法吗？ShowExportControls 属性设置为 true。

2) 另外，当我单击 ReportViewer 控件中的打印图标时，IE 会询问我是否要安装“Microsoft SQL Server”。我单击安装，然后它会显示一个消息框，显示“无法加载客户端打印控件”。我正在使用 IE7 和 Vista。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T09:51:42.983

第一部分我不知道，但第二部分可以是用于打印的 ActiveX。当您按下该打印按钮时，它会调用客户端计算机上的 ActiveX 控件以进行打印。

如果客户端计算机上尚未安装此控件，则如果您有足够的权限，则会下载并安装它。所以是权限管理。

尝试以管理员用户身份登录并尝试打印。如果一切顺利，您可以注销并以标准用户身份登录并再次打印。它适用于我们在 XP+IE6 和 XP+IE7 上。最后，我们使用 SCCM 将控件安装到所有机器上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T12:09:46.807

谢谢比里。我认为第 2 部分可能是 Vista UAC / Admin 问题。

我找到了第 1 部分的解决方案 - 这并不理想 - 但它有效。我发现“选择格式”下拉列表在 Firefox 中可见，但在 IE7 中不可见。我查看了源代码，发现 DDL 存在于 HTML 中，但内联样式中的宽度设置为 96%，由于某种原因，这导致 DDL 不可见！

我不得不在我的 .aspx 页面上使用一点 Javascript（在 ReportViewer 控件之后）：

```
<script type="text/javascript" language="javascript" >
    var elem = document.getElementById("ctl00_cphContentPlaceHolder_ReportViewer1_ctl01_ctl05_ctl00")

    if (elem) {
        elem.style.width = 160;
    }
</script> 
```

注意我正在使用母版页，并且 DDL 在 ASP.NET 控件的深处，因此是讨厌的字符串 - 您必须自己在代码中找到 DDL 的 Id。

希望这可能对某人有所帮助！

# c# - 向 Linq-to-SQL 对象添加功能以执行常见选择

> ID：207837
> 
> 赞同：2
> 
> 时间：2008-10-16T08:55:12.720
> 
> 标签：c#, .net, linq-to-sql

在[上一个问题](https://stackoverflow.com/questions/190524/mapping-computed-properties-in-linq-to-sql-to-actuall-sql-statements)中，我询问了如何在 linq to sql 对象中创建“计算属性”。那里提供的答案对于该特定案例来说已经足够了，但现在我在另一个案例中遇到了类似的障碍。

我有一个数据库，其中包含必须通过多个**Steps的****Items**。我想在我的数据库中有一个函数来检索我可以构建的项目的当前步骤。例如：

 **```
var x = db.Items.Where(item => item.Steps.CurrentStep().Completed == null); 
```

获取当前步骤的代码是：

```
Steps.OrderByDescending(step => step.Created).First(); 
```

因此，我尝试向**EntitySet<Step>**添加一个扩展方法，该方法返回一个**Step**，如下所示：

```
public static OrderFlowItemStep CurrentStep(this EntitySet<OrderFlowItemStep> steps)
{
    return steps.OrderByDescending(o => o.Created).First();
} 
```

但是当我尝试在顶部执行查询时，我收到一条错误消息，指出*CurrentStep()*函数没有转换为 SQL。有没有办法以任何方式将此功能添加到 Linq-to-SQL，还是我每次都必须手动编写查询？我试图先写出整个查询，但它很长，如果我改变获取项目的活动步骤的方式，我必须再次检查所有代码。

我猜 CurrentStep() 方法必须返回某种 Linq 表达式，但我不知道如何实现它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-19T17:53:52.150

问题是 CurrentStep 是一种正常的方法。因此，表达式包含对该方法的调用，自然 SQL 不能执行任意 .NET 方法。

您需要将代码表示为表达式。我在这里有一个深入的例子：http: [//www.atrevido.net/blog/2007/09/06/Complicated+Functions+In+LINQ+To+SQL.aspx](http://www.atrevido.net/blog/2007/09/06/Complicated+Functions+In+LINQ+To+SQL.aspx)

不幸的是，C# 3.0 编译器有一个巨大的遗漏，您无法生成对表达式的调用。（即，你不能写“x => MyExpression(x)”）。解决它需要您手动编写表达式，或者使用委托作为占位符。Jomo Fisher 有一篇关于[操作表达式树](http://blogs.msdn.com/jomo_fisher/archive/2007/05/23/dealing-with-linq-s-immutable-expression-trees.aspx)的有趣帖子。

在没有实际完成的情况下，我可能会采用的方法是让 CurrentStep 函数采用您要添加的谓词（“Completed == null”）。然后，您可以创建一个完整的 Expression> 谓词以移交给 Where。我很懒，所以我将使用String和Char做一个示例（String包含Chars，就像Item包含Steps）：

```
using System;
using System.Linq;
using System.Linq.Expressions;

class Program {
    static void Main(string[] args) {
        Console.WriteLine(StringPredicate(c => Char.IsDigit(c)));
        var func = StringPredicate(c => Char.IsDigit(c)).Compile();
        Console.WriteLine(func("h2ello"));
        Console.WriteLine(func("2ello"));
    }

    public static Expression<Func<string,bool>> StringPredicate(Expression<Func<char,bool>> pred) {
        Expression<Func<string, char>> get = s => s.First();
        var p = Expression.Parameter(typeof(string), "s");
        return Expression.Lambda<Func<string, bool>>(
            Expression.Invoke(pred, Expression.Invoke(get, p)),
            p);
    }
} 
```

所以“func”是通过使用StringPredicate创建一个Expression来创建的。例如，我们编译它以在本地执行它。在您的情况下，您会将整个谓词传递给“Where”，以便将其转换为 SQL。

“get”表达式是您放置“扩展”内容（OrderByWhatever、First 等）的地方。然后将其传递给给您的谓词。

如果它看起来很复杂，请不要担心；一开始有点像。如果您以前没有做过这种事情，那将需要一些时间（我第一次做这种事情时，花了好几个小时才把它做好：|.. 现在稍微容易一些）。另外，正如我所提到的，您可以编写一个辅助方法来为您重写（因​​此您不需要直接使用 Expression.Whatever 方法），但我没有看到任何示例，也没有真正还需要它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T20:14:32.897

查看[我](/questions/209924/switch-statement-in-linq#210051)对“ [linq 中的 switch 语句](/questions/209924/switch-statement-in-linq)”的回答，看看这是否为您指明了正确的方向......

我在那里演示的技术是让我克服可怕的“没有转换为 SQL”错误的技术。

# network-protocols - IPv6 对应用程序开发和设计有什么好处/影响？

> ID：207838
> 
> 赞同：4
> 
> 时间：2008-10-16T08:55:37.043
> 
> 标签：network-protocols, ipv6

关于 IPv6 以及即将从 IPv4 切换到 IPv6 的报道很多。我对 IPv6 有一些了解，但我经常想知道 IPv6 对应用程序开发和设计（具体而言）有多大影响？

IPv6 是否提供了一些我们今天还没有的有形/众所周知的好处？

我知道 Windows Vista 和 Server 2008 支持开箱即用的 IPv6，现在有没有人在使用（或在设计时考虑到 IPv6），如果是，有什么好处？我们是否应该在当前和未来的项目中考虑 IPv6？

是否有任何支持 IPv6 的应用程序的 *好例子？*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-18T15:38:59.480

恐怕亚伦的回答是非常不正确的。是的，UI 更改将是必要的，但任何使用传统套接字 API 的代码也可能需要进行大量更改以支持 IPv6。

大多数旧代码使用特定的“地址族”常量 ( `AF_INET`) 和特定的数据结构 ( `struct sockaddr_in`)。任何仍在使用的代码实际上都停留在 IPv4 领域。

较新的代码应该使用现代 API 调用，例如`getaddrinfo()`能够为协议、地址族（即`AF_INET6`）、地址等返回正确的值，而不管远程主机使用 IPv4 还是 IPv6（或两者）。

它有点长，但这里有一个来自 Linux 手册页的代码示例，用于`getaddrinfo`. 请注意该调用如何获取潜在远程地址的完整列表，并依次尝试每个地址，直到成功：

```
 memset(&hints, 0, sizeof(struct addrinfo));
         hints.ai_family = AF_UNSPEC;    /* Allow IPv4 or IPv6 */
         hints.ai_socktype = SOCK_DGRAM; /* Datagram socket */
         hints.ai_flags = 0;
         hints.ai_protocol = 0;          /* Any protocol */

         s = getaddrinfo(hostname, service, &hints, &result);
         if (s != 0) {
             fprintf(stderr, "getaddrinfo: %s\n", gai_strerror(s));
             exit(EXIT_FAILURE);
         }

         /* getaddrinfo() returns a list of address structures.
            Try each address until we successfully connect(2).
            If socket(2) (or connect(2)) fails, we (close the socket
            and) try the next address. */

         for (rp = result; rp != NULL; rp = rp->ai_next) {
             sfd = socket(rp->ai_family, rp->ai_socktype,
                          rp->ai_protocol);
             if (sfd == -1)
                 continue;

             if (connect(sfd, rp->ai_addr, rp->ai_addrlen) != -1)
                 break;                  /* Success */

             close(sfd);
         }

         if (rp == NULL) {               /* No address succeeded */
             fprintf(stderr, "Could not connect\n");
             exit(EXIT_FAILURE);
         }

         freeaddrinfo(result);           /* No longer needed */ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-16T10:31:49.967

起初不多。对于大多数桌面和 Web 应用程序，从 IPv4 到 v6 的切换应该是透明的。

但最终，使用 IPv6 简化的网络模型的应用程序将变得更加普遍。例如，大多数用户都在 NAT 之后，因此网状网络仅适用于技术受众。任何不得不在他的路由器上为 P2P 软件打开端口的人都知道这不是他妈妈可以使用的东西。

IPv6 也使流媒体和广播变得更容易。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-16T17:09:15.923

它会影响您输入 IP 地址的任何软件的 UI 设计，因为您需要让它们在 IPv4 和 IPv6 输入之间进行选择。不过很明显。

我的理解是，其他方面不会有太大变化。大多数程序都使用操作系统提供的网络设施，因此当数据返回应用程序时，所有寻址和传输复杂性都已消除。当然，有些应用程序会受到更大的影响，但那些将是直接与网络一起工作的应用程序……而不是典型的业务线应用程序。

您需要查看您的应用程序在[OSI 模型](http://en.wikipedia.org/wiki/OSI_model)中的位置。我认为 IP 地址是第 3 层的一部分，因此，如果您在该层之上，您就会从操作系统的更改中抽象出来。

一件可能很糟糕的事情是旧游戏，您在其中输入要连接的玩家的 IP 地址（帝国时代、星际争霸等）。似乎除非某种 IPv4-IPv6 隧道，该游戏的功能将被破坏。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-18T15:18:53.887

所有现代网络浏览器（Chrome、IE、Safari 和 Firefox）都支持 IPv6。同样支持 IPv6 的是 µTorrent。

# java - 如何防止 Eclipse 在启动时挂起？

> ID：207843
> 
> 赞同：230
> 
> 时间：2008-10-16T08:57:39.673
> 
> 标签：java, eclipse, eclipse-3.3

我正在使用 Eclipse 3.3（“Europa”）。周期性地，Eclipse 需要非常长的时间（也许永远）才能启动。我可以在 Eclipse 日志中看到的唯一内容是：

```
    !ENTRY org.eclipse.core.resources 2 10035 2008-10-16 09:47:34.801
    !MESSAGE 工作区退出前一个会话中未保存的更改；刷新工作区以恢复更改。

```

谷歌搜索显示[有人建议](http://dev.zhourenjian.com/blog/2007/11/07/eclipse-freezing-on-start.html)我删除该文件夹：

```
workspace\.metadata\.plugins\org.eclipse.core.resources\.root\.indexes 
```

这似乎没有帮助。

没有从一个新的工作区开始（我不想做的事情，因为我需要几个小时才能正确设置我的所有项目），有没有办法让 Eclipse 正常启动？

* * *

## 回答 #1

> 赞同：268
> 
> 时间：2009-04-15T15:35:10.263

这可能不是您问题的确切解决方案，但就我而言，我使用[SysInternals Procmon](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)跟踪 Eclipse 轮询的文件，并发现 Eclipse 不断轮询我的一个项目的相当大的快照文件。删除它，一切都开始正常（尽管工作区处于上次启动时的状态）。

删除的文件是：

```
<workspace>\.metadata\.plugins\org.eclipse.core.resources\.projects\<project>\.markers.snap 
```

* * *

## 回答 #2

> 赞同：236
> 
> 时间：2009-07-05T16:36:23.287

尝试：

1.  cd 到**<工作区>\.metadata\.plugins\org.eclipse.core.resources**
2.  remove the file ***.snap** (or **.markers** in Indigo)

* * *

## 回答 #3

> 赞同：57
> 
> 时间：2012-09-21T10:28:04.877

In my case (Juno) I had to do this:

```
find $WORKSPACE_DIR/.metadata/.plugins/org.eclipse.core.resources/.projects \
-name .indexes -exec rm -fr {} \; 
```

That did the trick.

Initially I thought it was a problem with Mylyn (I experienced these freezes after I started using its generic web connector), but the problem appeared even after uninstalling the connector, and even deleting the .mylyn directories.

Edit: I also managed to restart eclipse by deleting just one file:

```
rm $WORKSPACE_DIR/.metadata/.plugins/org.eclipse.e4.workbench/workbench.xmi 
```

That worked fine, without any indexes involved. Only the workbech, which I personally don't mind that much.

* * *

## 回答 #4

> 赞同：38
> 
> 时间：2008-10-16T11:15:53.263

您可以尝试先从`Eclipse`该`-clean`选项开始。

在 Windows 上，您可以将`-clean`选项添加到 eclipse 的快捷方式中。您可以在从命令行`Linux`启动时简单地添加它。`Eclipse`

* * *

## 回答 #5

> 赞同：35
> 
> 时间：2011-03-31T18:28:25.097

This one works for me:

Another, and a bit better workaround which apparently works:

1.  Close `Eclipse`.
2.  Temporary move offending project somewhere out of the workspace.
3.  Start `Eclipse`, wait for workspace to load (it should).
4.  Close `Eclipse` again.
5.  Move the project back to workspace.

Source: [Eclipse hangs while opening workspace after upgrading to GWT 2.0/Google app engine 1.2.8](https://stackoverflow.com/questions/1958640/eclipse-hangs-while-opening-workspace-after-upgrading-to-gwt-2-0-google-app-engin/2241198#2241198)

* * *

## 回答 #6

> 赞同：31
> 
> 时间：2014-03-21T12:07:31.547

I used `eclipse -clean -clearPersistedState` and that worked for me.

**Warning:** This may remove all projects from the workspace.

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2010-11-06T15:12:14.147

I had a similar problem with a rather large workspace in 3.5 and no .snap-files anywhere to be seen. "`Windows` -> `Preferences` -> `General` -> Startup and Shutdown -> Refresh workspace on startup" seems to be a workspace-related setting and so I couldn't change it for the workspace that was causing the hang.

Running `eclipse` with the command line parameter -refresh and then changing the setting seems to do the trick.

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2010-12-27T16:30:09.013

I also had luck with removing the *.snap files. Mine were located in a different directory than mentioned in the posts (below).

```
<eclipse workspace>/.metadata/.plugins/org.eclipse.core.resources/.projects 
```

Consequently, the following unix cmd did the trick:

```
find <eclipse_workspace>/.metadata/.plugins/org.eclipse.core.resources/.projects  -name "*.snap" -exec rm -f {} \; 
```

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2013-01-17T04:22:43.830

I tried all of the answers in this thread, and none of them worked for me -- not the snap files, not moving the projects, none of them.

What did work, oddly, was moving all projects and the .metadata folder somewhere else, starting Eclipse, closing it, and then moving them all back.

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2010-07-14T11:40:05.413

Since I don't have a .snao or .prefs file in *.metadata.plugins\org.eclipse.core.resources* folder (running on OS X), what did the trick for me was copy the .project folder to old.project, start Eclipse, and check

> Windows -> Preferences -> General -> Startup and Shutdown -> Refresh workspace on startup

as proposed by matt b. After that, I closed Eclipse, renamed the folder old.projects back to .projects and after that everything worked fine again.

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2011-02-16T15:46:43.537

I did this:

1.  cd to .metadata.plugins\org.eclipse.core.resources
2.  remove the file .snap
3.  Noticed the Progress tab was doing something every few seconds..it seemed stuck
4.  Exit eclipse (DO NOT FILE|RESTART HERE OR YOU HAVE TO GO BACK TO STEP 1 AGAIN)
5.  Open eclipse again.

Using `-refresh` or `-clean` when starting eclipse did not help.

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2014-10-13T20:35:24.243

On Mac OS X, you start Eclipse by double clicking the Eclipse application. If you need to pass arguments to Eclipse, you'll have to edit the eclipse.ini file inside the Eclipse application bundle: select the Eclipse application bundle icon while holding down the Control Key. This will present you with a popup menu. Select "Show Package Contents" in the popup menu. Locate eclipse.ini file in the Contents/MacOS sub-folder and open it with your favorite text editor to edit the command line options.

add: "-clean" and "-refresh" to the beginning of the file, for example:

```
-clean
-refresh
-startup
../../../plugins/org.eclipse.equinox.launcher_1.3.0.v20130327-1440.jar
--launcher.library 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2010-10-07T09:15:32.123

Check that the Workspace Launcher hasn't opened on your TV or some other second monitor. It happened to me. The symptoms look the same as the problem described.

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-10-16T19:03:52.133

> Windows -> 首选项 -> 常规 -> 启动和关闭

被`Refresh workspace on startup`检查了吗？

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-08-12T16:36:16.047

I just had problems with Eclipse starting up. It was fixed by deleting this file:

rm org.eclipse.core.resources.prefs

I found in .settings

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2016-12-05T20:15:59.150

UFT causing issues with RDz (Eclipse based) after install These suggestions will allow to work around this situation even with the environment variables in place and with corresponding values.

**Note**: Conflicting application will not be recognized in a java context because it is being excluded from the java support mechanism.

1.  Impact: Excludes Add-ins support from hooking to conflicting application executable via Windows Registry Editor Requirement: The application must be started by an EXE file, except Java.exe/Javaw.exe/jpnlauncher.exe

***Instructions***:

a. Locate the executable filename of the application conflicting with add-in(s) support. Either use the Task Manager or the Microsoft Process Explorer.

b. Open Windows Registry Editor.

c. Navigate to: HKEY_LOCAL_MACHINE\SOFTWARE\Mercury Interactive\JavaAgent\Modules For 32bits applications on Windows x64: HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Mercury Interactive\JavaAgent\Modules

d. Create a DWORD value with the name of the conflicting software executable filenmae and set the value to 0.

[![Updated Registry](https://i.stack.imgur.com/HKZmK.png)](https://i.stack.imgur.com/HKZmK.png)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2018-03-06T02:27:19.827

Removing *.snap (mine is *.markers), --clean-data or move workspace folder seems all did not work for me.

As my eclipse stopped working after I installed and switched my keyborad input to HIME, I went back to fctix and it worked.

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2011-09-09T16:48:35.293

I had no snap files. Going through the help menu installation list, at least 90% of my plugins had the uninstall button deactivated so I could not handle it through there. Under startup/shutdown most of plugins were not listed. Instead, I had to manually remove items from my plugins folder. Wow, the startup time is much faster for me now. So if everything else does not work and you have plugins that are disposable, this could be the ultimate solution to use.

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2012-10-31T14:42:33.333

Unfortunately, none of these solutions worked for me. I ended up having to create a new workspace, then imported the existing projects into the new workspace. Unfortunately, you lose your preferences when doing so (so, remember to export your settings anytime you change them!)

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2013-04-30T19:00:32.053

I had a very similar problem with eclipse (Juno) on Fedora 18\. In the middle of debugging an Android session, eclipse ended the debug session. I attempted to restart eclipse but it kept haning at the splash screen. I tried the various suggestions above with no success. Finally, I checked the adb service (android debug bridge):

```
# adb devices
List of devices attached 
XXXXXX offline 
```

I know the android device was still connected but it reported it offline. I disconnected the device and shut down the adb service:

```
# adb kill-server 
```

Then I waited a few seconds and re-started the adb service:

```
# adb start-server 
```

And plugged my android back in. After that, eclipse started up just fine.

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2013-09-15T08:07:00.917

no need to delete entire metadata file. just try deleting the **.snap** file from org.eclipse.core.resources on your workspace folder

```
ex. E:\workspaceFolder\.metadata\.plugins\org.eclipse.core.resources 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2013-12-07T00:56:30.233

Watch out for zero-byte .plugin **files** in the {WORKSPACE-DIR}/.metadata/.plugins folder. I just deleted one in there and it fixed my freezing issues.

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2014-03-20T12:39:03.310

What worked for me was this-- On Ubuntu

1.  Ctrl+F1
2.  ps -e
3.  kill -9 for process ids of eclipse, java and adb

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2014-03-26T10:10:54.413

In my case similar symptoms were caused by some rogue git repository with a ton of junk system files.

Universal remedy, as mentioned above, is to use Process Monitor to discover offending files. It's useful to set the following 2-line filter:

*   Process Name **is** *eclipse.exe*
*   Process Name **is** *javaw.exe*

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2014-07-28T21:25:15.207

I had a similar problem after I updated eclipse on Mavericks. Eventually I found that in the eclipse plugins directory the com.google.gdt.eclipse.login jar had version numbers at the end. I removed the version number from the name and it all started fine :)

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2014-11-03T18:50:30.307

Also look at [http://www.lazylab.org/197/eclipse/eclipse-hanging-on-startup-repair-corrupt-workspace/](http://www.lazylab.org/197/eclipse/eclipse-hanging-on-startup-repair-corrupt-workspace/)

99% Recommended Solution works.... (i.e. Removing .snap file) But if it did not worked then we have to try to remove indexes folder and further workbench folder.

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2015-05-18T08:59:59.083

This may help

In your eclipse,

1) Go to Help

2) Click Eclipse marketplace

3) search - optimizer

install "optimizer for eclipse"

![enter image description here](https://i.stack.imgur.com/4MA4p.png)

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2015-10-26T03:46:50.290

In Ubuntu `eclipse -clean -refresh` worked for me for Eclipse 3.8.1

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2016-01-08T13:26:49.517

It can also be caused by [this](https://bugs.eclipse.org/bugs/show_bug.cgi?id=475368) bug, if you're having Eclipse 4.5/4.6, an Eclipse Xtext plugin version older than v2.9.0, and a particular workspace configuration.

The workaround would be to create a new workspace and import the existing projects.

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2016-01-13T12:10:26.577

Well, I had similar behaviour while starting eclipse over X11\. I forgot to tick the enable X11 forwarding in my putty.

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2016-01-18T04:55:30.490

In my case deleting the .metadata folder of the workspace worked. I am using Eclipse Luna service Release 2.

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2018-01-15T13:32:09.063

my solution is to remove this dir:

```
workspace/.metadata/.plugins/org.eclipse.e4.workbench 
```

what is did was first remove (move it to a save place) all from .metadata. eclipse started all new (all my settings gone). then i added bit by bit back into the .metadata dir until it dit not work again. this way i found i only had to remove this dir. And now Eclipse started with all my settings still in place.

it seems that in the file in this dir the windows which should be opened on startup are listed and some how it could not find one off them so it hung. why i'm unclear because the file which in complained about in the logging was on my filesystem.

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2018-03-19T15:22:32.480

My freeze on startup issue seemed to be related to the proxy settings. I saw the username\password dialog on startup, but Eclipse froze whenever I tried to click ok, cancel, or even just click away from the dialog. For a time, I was seeing this authentication pop-up with no freeze issue.

To fix it, I started eclipse using a different workspace, which thankfully didn't freeze on me. Then I went to `Window --> Preferences --> General --> Network Connections`. I edited my HTTP Proxy entry and unchecked `"Requires Authentication"`. Then I started my original problematic workspace, which launched this time without freezing. Success!

I had no further issues when I re-opened my workspace, and was able to re-enable authentication without having a problem. I didn't see the username\password pop-up anymore on start-up, so there's a chance my authentication info was FUBAR at the time.

Using: MyEclipse, Version: 2016 CI 7, Build id: 14.0.0-20160923

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2018-07-07T00:14:13.080

I did a lot of these solutions and none seemed to work for me. What finally *did* work was to restart my Mac. Duh. I noticed that my jconsole also seemed to be stuck which made me immediately go for a restart because it seemed to be Java related as opposed to Eclipse specifically.

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2020-07-28T17:47:39.053

> JAVA VERSION COULD BE PROBLEM:

I tried few answers given above. But it didnot work. But meanwhile I was trying them it clicked to me that I switched the java version for some other stuff & forgot to switch back.

Once I jumped back to the previous version. Eclipse started working for me.

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2021-01-08T00:10:34.767

The freezing / deadlock can also be caused by this bug on GTK3 + Xorg

[https://bugs.eclipse.org/bugs/show_bug.cgi?id=568859](https://bugs.eclipse.org/bugs/show_bug.cgi?id=568859)

Can be workarounded by using Wayland session, although in my case Eclipse fails to detect reasonable font for some reason and looks like this:

[![screenshot](https://i.stack.imgur.com/CesKI.png)](https://i.stack.imgur.com/CesKI.png)

Related:

[https://www.reddit.com/r/swaywm/comments/bkzeo7/font_rendering_really_bad_and_rough_in_gtk3/](https://www.reddit.com/r/swaywm/comments/bkzeo7/font_rendering_really_bad_and_rough_in_gtk3/)

[https://www.reddit.com/r/swaywm/comments/kmd3d1/webkit_gtk_font_rendering_on_wayland/](https://www.reddit.com/r/swaywm/comments/kmd3d1/webkit_gtk_font_rendering_on_wayland/)

# linux - 从“ps”获取完整结果

> ID：207848
> 
> 赞同：9
> 
> 时间：2008-10-16T08:58:43.760
> 
> 标签：linux, unix, command-line, process, ps

如何获得 *nix 命令“ **ps** ”的全宽结果？
我知道我们可以指定类似的东西，`--cols 1000`但无论如何我可以列并打印出所有内容吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-16T09:04:44.497

试试`ps -w -w aux`。-w 选项将输出设置为宽，并且执行两次会使宽度不受限制。“辅助”部分使其显示更多信息，并且是（afaik）非常标准的使用模式。这当然取决于平台，以上适用于 Linux 上的 procps 版本 3.2.7。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-16T09:15:21.387

`w`如果您使用的是 BSD-style ，请指定该选项两次`ps`。例如，`ps auwwx`。使用 System V 时应用了一组不同的选项`ps`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-16T09:36:57.537

ps 有两种不同的选项语法；基于 SysV 的标准 POSIX 和 BSD 之一。在 linux 上使用的 GNU ps 支持这两者，它可以做到这一点，因为 POSIX 选项前面有破折号而 BSD 没有，以及它在普通 GNU --long-option-name 中的一些自己的选项风格。

无论如何，要获得 POSIX 样式的所有进程是 -e，在 BSD 中是 ax（a 包括其他用户的进程，x 包括没有控制终端的进程，即守护进程）。

没有一个选项可以使它包含所有列。有大量可能的列。POSIX 选项 -f、-F 和 -L 都导致它显示不同的额外列集，BSD 选项 u 也是如此（因此另一个答案中提到的“ps aux”是一个非常常见的命令）。

如果您真的想要更多的列，则必须使用 -o（或 o）选项明确命名您想要的列。有关列表，请参见手册页。您可以使用大约一百个不同的名称，但其中一些是重复的，而另一些则以不同的方式显示相同的信息。

# silverlight - 如何创建具有两个内容区域的 Silverlight 控件

> ID：207851
> 
> 赞同：0
> 
> 时间：2008-10-16T09:00:25.237
> 
> 标签：silverlight

我想创建一个具有两个内容区域的 Silverlight 2 控件。标题和 MainContent。所以控制将是：

```
<StackPanel>
<TextBlock Text=" CONTENT1 "/>
<Content with CONTENT2 "/>
</StackPanel> 
```

当我使用控件时，我应该能够使用：

```
<MyControl Text="somecontent">main content </MyControl> 
```

如何创建这样的控件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-16T09:16:59.057

您可以使用[ContentProperty](http://msdn.microsoft.com/en-us/library/system.windows.markup.contentpropertyattribute.aspx)属性轻松完成此操作。

然后你可以将你的代码定义为：

```
[ContentProperty("Child")]
public partial class MyControl: UserControl
{
    public static readonly DependencyProperty ChildProperty = DependencyProperty.Register("Child", typeof(UIElement), typeof(MyControl), null);

    public UIElement Child
    {
        get { return (UIElement)this.GetValue(ChildProperty); }
        set
        {
            this.SetValue(ChildProperty, value);
            this.content.Content = value;
        }
    } 
```

这将做的是您的标签 ( `<MyControl Text="somecontent">main content </MyControl>`) 中的任何默认内容 - 将被设置为您班级的 Child 属性。然后，一旦设置好，您就可以将其分配给您喜欢的任何控件。

**编辑：**

您可以拥有任意数量的内容，但您只能拥有 1 个自动内容（通过 ContentProperty 属性指定）。如果你想要两个，你可以这样做：

```
<MyControl>
  <MyControl.Content1>Hello World</MyControl.Content1>
  <MyControl.Content2>Goodbye World</MyControl.Content2>
</MyControl> 
```

您所要做的就是确保您的代码中具有匹配的依赖项属性。然后在设置属性时，只需将其分配给 XAML 中的父内容控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-16T09:15:50.417

您想要的是 WPF HeaderedContentControl 的 Silverlight 版本，您可以在这里尝试一下。[http://leeontech.wordpress.com/2008/03/11/headeredcontentcontrol-sample/](http://leeontech.wordpress.com/2008/03/11/headeredcontentcontrol-sample/)

# java - 用于读取 Microsoft 媒体服务器 (MMS) 流的 Java 库

> ID：207854
> 
> 赞同：3
> 
> 时间：2008-10-16T09:01:21.493
> 
> 标签：java, streaming

我想知道是否有可用的 Java 库来读取 Microsoft 媒体服务器 ( [MMS](http://en.wikipedia.org/wiki/Microsoft_Media_Server) ) 流。

谢谢，

道格拉斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-17T12:46:22.270

谷歌搜索显示：

*   [早在 2002 年， JavaMMS 就](http://javamms.sourceforge.net/)只有一个“0.5 - 初始版本”
*   Velocity Reviewers 论坛早在 2004 年就讨论了 [Java MMS 库]，这导致了
*   [sdp.ppona.com](http://sdp.ppona.com/)一个下载彩信流的工具，里面有一个故事：
*   [微软终于发布了它的彩信协议规范！](http://sdp.ppona.com/news2008.html), 2008 年 2 月
*   [[MS-MMSP]：微软媒体服务器 (MMS) 协议规范](http://msdn.microsoft.com/en-us/library/cc234711.aspx)

看起来有人制作 Java MMS 库的时机已经成熟。;-)

我有使用[mplayer](http://www.mplayerhq.hu/)转储 MMS 流的良好经验。稍微摆弄一下并找到正确的命令行选项。[all-streaming-media.com](http://all-streaming-media.com/record-video-stream/record-streaming-video-windows-media-and-real-video.htm#MPlayer)建议使用：

> mplayer.exe -dumpstream mms://somehost.com/somedirectory/somefile.wmv

使用 -dumpfile 选项命名转储流：

> mplayer -dumpstream -dumpfile somefile.wav mms://somehost.com/somedirectory/somefile.wmv

# service - 服务和/或商品

> ID：207856
> 
> 赞同：1
> 
> 时间：2008-10-16T09:01:34.847
> 
> 标签：service, commodity

我们在编写程序时是在创建服务，还是它们是商品？

我们的程序（动作）为用户提供一些服务，我们是否像洗窗工？或者：我们是否像木匠一样，我们的程序（产品）被他们的新主人出售和使用？

或者这应该从不同的方面来看待：编程是一种服务，而产生的程序是一种产品？

以上对以下问题有直接影响：复制无权使用的软件是盗窃还是欺诈？盗窃是指从另一个人的财产中实际移走有价物品；欺诈是以导致受害者经济损失的方式表示虚假（这里的表示是您对复制权的假设）。

它还影响到因果责任问题：如果你写的破解密码的程序被别人用来抢劫银行：你是共犯吗？如果您的程序是一项服务，那么可以说您是；如果是商品，那么您“应该”清楚。

或者：每个程序是否应该被视为一个独特的实例，纯粹基于该程序发起者的意图，是否应该将其视为服务或商品？还是应该使用用户的意图？

这如何反映在开源世界中，那里有许多看似侵犯商业权利的程序可用，例如：复制保护和 DRM 规避？

（每次我们编写代码时，这都会影响我们所有人。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-16T10:01:04.337

其实两者都是。

有时您销售的产品只是有效。它是一种商品。例如，记事本程序是一种商品，您与它的作者没有任何关系。大多数小工具都属于这一类。

有时，您会为特定用户开发定制应用程序，或者将现有产品与他们的旧应用程序集成，并对其进行调整以适应他们的特定情况。这绝对是一项服务，您通常与客户建立长期关系。大多数“*大*”/昂贵的程序都属于这一类。您可以购买 MS SharePoint Server 许可证作为商品，但在大多数情况下，您很可能还会购买某人的服务以使其为您工作。

# sql - 数据库：“TEXT”字段的效率是否低于“varchar”？

> ID：207867
> 
> 赞同：9
> 
> 时间：2008-10-16T09:06:10.687
> 
> 标签：sql, variables, performance

在 SQL 数据库中使用 TEXT 是否比使用 varchar 效率低？

如果是，为什么？

如果不是，为什么你不总是使用 TEXT？

我在这里没有针对特定的数据库，但 oracle 可能是最相关的，尽管我暂时在 MySQL 上进行测试作为概念证明的一部分。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-16T09:08:59.450

从微软[这里](http://msdn.microsoft.com/en-us/library/ms187993.aspx)

> 在 Microsoft SQL Server 的未来版本中，将删除 ntext、text 和 image 数据类型。避免在新的开发工作中使用这些数据类型，并计划修改当前使用它们的应用程序。请改用 nvarchar(max)、varchar(max) 和 varbinary(max)。

当您使用`varchar(max)`over text 时，您可以在`WHERE`子句中使用它，因为它们与较小的对应物相同，`varchar,nvarchar and varbinary`. 下面是应该使用什么而不是应该使用什么的小列表：

*   使用 varchar(max) 代替文本
*   使用 nvarchar(max) 代替 ntext
*   使用 varbinary(max) 代替图像

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T12:06:07.627

[PostgreSQL 文档说](http://www.postgresql.org/docs/current/static/datatype-character.html)：

> 提示：这三种类型之间没有性能差异，除了在使用空白填充类型时增加了存储大小，以及在存储到长度受限的列时需要几个额外的周期来检查长度。虽然 character(n) 在其他一些数据库系统中具有性能优势，但在 PostgreSQL 中没有这样的优势。在大多数情况下，应改为使用文本或字符变化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T09:12:16.417

简短的回答是：是的，它们的效率较低。

更长，更复杂的答案是：

是的，它们可能效率较低。这取决于您使用的 DBMS 以及表的大小等。TEXT 字段是可变宽度的，因此 DBMS 在尝试查找记录时必须做更多的工作。这对性能的影响程度与 DBMS 的总体效率、它存储的有关表行的数据量以及它是否优化固定长度的表成正比。

我知道 MySQL 在固定长度的表行上工作得更快，但你必须告诉它该表可以首先被视为固定长度的表。我真的没有任何与其他 DBMS 相关的实际经验来关联实际数字。但是在有很多（读取一百万或更多）记录的表上，它可以产生显着的差异。不过，较小的桌子几乎没有实际差异。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-16T09:12:17.023

您需要具体说明您正在谈论的数据库。我相信至少在某些数据库中，TEXT 存储为与表本身分开的 CLOB（仅包含一个引用）。这会导致表更小（好），但在获取时会进行额外的查找，并且可能会缓存未命中（坏）。

可能也有索引和查询的含义，但同样取决于您使用的特定 RDBMS。

# perl - 如何在 Pod 和 perldoc 中使用 Unicode 字符？

> ID：207871
> 
> 赞同：24
> 
> 时间：2008-10-16T09:08:26.750
> 
> 标签：perl, unicode, documentation, internationalization, perldoc

我需要在我的 perl 文档中使用 utf-8 字符。如果我使用：

```
perldoc MyMod.pm 
```

我看到奇怪的字符。如果我使用：

```
pod2text MyMod.pm 
```

一切安好。

我使用 Ubuntu/Debian。

```
$ locale
LANG=de_DE.UTF-8
LC_CTYPE="de_DE.UTF-8"
LC_NUMERIC="de_DE.UTF-8"
LC_TIME="de_DE.UTF-8"
LC_COLLATE="de_DE.UTF-8"
LC_MONETARY="de_DE.UTF-8"
LC_MESSAGES="de_DE.UTF-8"
LC_PAPER="de_DE.UTF-8"
LC_NAME="de_DE.UTF-8"
LC_ADDRESS="de_DE.UTF-8"
LC_TELEPHONE="de_DE.UTF-8"
LC_MEASUREMENT="de_DE.UTF-8"
LC_IDENTIFICATION="de_DE.UTF-8"
LC_ALL=de_DE.UTF-8 
```

是否有关于在 Pod 中使用特殊字符的 HowTo？

这是一个使用德语变音符号“Just a Test: äöüßÄÖ”的小例子：

```
$ perldoc perl/MyMod.pm
<standard input>:72: warning: can't find character with input code 159
<standard input>:72: warning: can't find character with input code 150
MyMod(3)              User Contributed Perl Documentation             MyMod(3)

NAME
        MyMod.pm - Just a Test: Ã¤Ã¶Ã¼ÃÃÃ

perl v5.10.0                      2008-10-16                          MyMod(3) 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-16T14:04:48.463

用作文件中的第一个 POD 指令，并使用`=encoding utf-8`相当新的`perldoc`（例如来自 5.10-maint）。然后它应该工作。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-16T10:32:46.957

找到这张 RT 票.... [http://rt.cpan.org/Public/Bug/Display.html?id=39000](http://rt.cpan.org/Public/Bug/Display.html?id=39000)

这个“错误”似乎是在 Perl 5.10 中引入的，也许需要使用这个 pod2man --utf8 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-17T08:38:12.990

perldoc -t MyMod.pm

从 perldoc 手册：

-t Display pod using pod2text instead of Pod::Man and groff (-t is the default on win32 unless -n is specified)

# visual-studio - Visual Studio 2008 安装项目不再生成 Setup.exe

> ID：207877
> 
> 赞同：3
> 
> 时间：2008-10-16T09:10:01.537
> 
> 标签：visual-studio, installation, setup.exe

我有一个 Visual Studio 2008 安装项目，在过去编译时会在输出目录中生成一个 Setup.exe 以及 .msi 输出文件。现在它不再生成我真正需要的 Setup.exe。

我是否在没有意识到的情况下更改了项目设置？我如何让它再次生成它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T10:27:27.823

尝试打开项目属性，单击先决条件按钮并选中“创建安装程序以安装先决条件组件”。

这适用于 Visual Studio 2005，不确定它是否适用于 Visual Studio 2008。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T10:05:28.770

1，转到文件菜单>单击添加>新项目>现在出现“添加新项目”对话框。

2.选择“其他项目类型”并单击“设置和部署”项目，选择“设置项目”在名称文本框中输入项目名称最后单击确定。

3.新项目出现在解决方案资源管理器中，例如您给名称“MyEXE”..它将以该名称显示。

4.右键单击MyEXE > 去查看> 点击“文件系统”</p>

5.在应用程序文件夹用户桌面用户程序菜单三个文件夹下可以看到“TargetMachine上的文件系统”

6.选择应用程序文件夹并右键单击添加>项目输出>选择主输出

7.  选择用户桌面 Richt 单击第二个窗口>单击创建新快捷方式>从应用程序文件夹中选择输出文件>将文件名从主输出名称更改为 MyEXE

下一个>>

同样的程序也遵循用户的程序菜单

8.如果要更改exe的制造商名称，只需右键单击项目进入属性

根据您的要求更改属性

9.最后构建新项目成功构建项目后myEXE(Setup)会出现在Application Debug或Release文件夹中(取决于属性设置)

EXE 可用@此位置

当您想在客户端计算机上安装 EXE 时，您应该在该 mc 上安装 .NET Framework，因为为 .NET Framework 2.0 版编写的应用程序和控件需要在计算机上安装 .NET Framework Redistributable Package 2.0 版应用程序或控件运行的位置。

# c# - Cookie 在 ASP.net 中失去价值

> ID：207878
> 
> 赞同：14
> 
> 时间：2008-10-16T09:10:13.753
> 
> 标签：c#, asp.net, cookies

我有以下设置cookie的代码：

```
 string locale = ((DropDownList)this.LoginUser.FindControl("locale")).SelectedValue;
  HttpCookie cookie = new HttpCookie("localization",locale);
  cookie.Expires= DateTime.Now.AddYears(1);
  Response.Cookies.Set(cookie); 
```

但是，当我尝试读取 cookie 时，值为 Null。cookie 存在。如果检查，我永远不会通过以下内容：

```
 if (Request.Cookies["localization"] != null && !string.IsNullOrEmpty(Request.Cookies["localization"].Value)) 
```

帮助？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2008-10-16T09:17:35.313

回邮后检查是否完成？如果是这样，您应该改为从 Request 集合中读取 cookie。

cookie 通过将它们添加到 Response.Cookies 中持久保存到浏览器，并从 Request.Cookies 中读回。

添加到 Response 的 cookie 只有在页面在同一个请求上时才能读取。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2010-10-11T22:03:32.023

The most likely answer is seen on [this post](https://stackoverflow.com/questions/456807/asp-mvc-cookies-not-persisting/590258#590258)

> When you try to check existence of a cookie using Response object rather than Reqest, ASP.net automatically creates a cookie.

**Edit:** As a note, I ended up writing software that needed to check the existence of cookies that ASP.NET makes a nightmare due to their cookie API. I ended up writing a conversion process that takes cookies from the request and makes my state object. At the end of the request I then translate my state object back to cookies and stuff them in the response (if needed). This alleviated trying to figure out if cookies are in the response, to update them instead, avoiding creating of pointless cookies etc.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T09:26:46.417

您是否厌倦了“请求”集合而不是“响应”集合？

```
if (Request.Cookies["localization"] != null && !string.IsNullOrEmpty(Request.Cookies["localization"].Value))

```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-07T11:23:29.970

I had a similar problem, I couldn't read cookies on postback. The issue for me was that I checked the Secure property of the cookie to true. It is said that when the Secure property of the cookie is turned on, it causes the cookie to be transmitted only if the connection uses the Secure Sockets Layer. I am not sure, however, how I was able to see the cookie in the browser the first time, but not on postback, considering that I wasn't transmitting over SSL. Anyhow, turning the cookie.Secure to false, solved the problem, and had cookies read on postback.

Sorry if this doesn't have to do anything with your issue, I wanted to share this, because I spent some time looking how to resolve this.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-09-27T17:16:17.860

I think I know the answer.

Just REMOVE the action attribute in your `<form>` tag.

make it look like this: `<form id="form1" runat="server">`

instead of this: `<form id="form1" action="DisplayName.aspx" runat="server">`

You should then use `Response.Redirect("DisplayName.aspx");` in your code.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-16T11:25:03.997

试试这个片段 -

```
string locale = ((DropDownList)this.LoginUser.FindControl("locale"))
                                                    .SelectedValue;  
HttpCookie myCookie = new HttpCookie("localization");
Response.Cookies.Add(myCookie);
myCookie.Values.Add("locale", locale);
Response.Cookies["localization"].Expires = DateTime.Now.AddYears(1); 
```

& to read it -

```
if (Request.Cookies["localization"] != null)
{
   HttpCookie cookie = Request.Cookies["localization"];
   string locale = cookie.Values["locale"].ToString();
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-16T14:29:17.133

if you're compiling in debug mode, turn on tracing for the pages in question and make sure the cookie is in the request collection. Set trace in the @page directive in the aspx file.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-20T21:24:32.787

Would add this as a comment to Chris Marisic's answer but I don't have that privelage :-(

Further to what Chris said in his edit about removing cookies from the request, to be able to read the newly created cookies value in a postback I ended up doing

```
Private Sub SetPageSize(ByVal pageSize As Integer)

    ' Set cookie value to pageSize
    Dim pageSizeCookie As HttpCookie = New HttpCookie(pageSizeCookieName)
    With pageSizeCookie
        .Expires = Now.AddYears(100)
        .Value = pageSize.ToString
    End With

    ' Add to response to save it
    Me.Response.Cookies.Add(pageSizeCookie)

    ' Add to request so available for postback
    Me.Request.Cookies.Remove(pageSizeCookieName)
    Me.Request.Cookies.Add(pageSizeCookie)

End Sub 
```

The Request.Cookies.Remove and Request.Cookies.Add lines making it work on postbacks

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-10-16T09:54:54.770

使用 Response.Cookies.Add(cookie); 而不是 Response.Cookies.Set(cookie);

# c++ - 隐藏以前添加到 Qt TabWidget 的选项卡

> ID：207881
> 
> 赞同：6
> 
> 时间：2008-10-16T09:11:10.350
> 
> 标签：c++, qt

我有一个对话框，其中包含一个 Qt TabWidget，其中添加了许多选项卡。

我想隐藏其中一个选项卡。

```
_mytab->hide() 
```

不起作用。我不想只从 .ui 文件中删除选项卡及其所有小部件，因为其他代码依赖于选项卡中的小部件。但是，在生成的 uic_mydialog.cpp 中生成选项卡代码但不知何故不是 ::insertTab 会很好。在 ui 文件中设置 hidden 属性也不起作用。

我正在使用 Qt 3.3

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-16T13:00:29.887

我遇到了同样的问题。我正在使用以下方法。

现在这里是数据。

> genTab 是我的 QTabWidget 的名称
> 
> tabX 是我要删除的选项卡的名称。

（请注意，这是选项卡小部件中的第二个选项卡。因此，我将使用“1”作为索引来引用此选项卡）

删除和添加的代码如下。

```
ui.genTab->removeTab(1); // removes the tab at the index 1 which is the second tab from left

ui.genTab->insertTab(1, ui.tabX, "<Name of TabX>"); // The tab is added back. 
```

在这里，请注意，如果您在设计时静态添加选项卡，则很容易做到这一点。因为我们将有一个与选项卡关联的对象名称，因此我们可以使用 ui.tabX 来引用它。根据您的说法，在您的情况下，选项卡确实是在设计时静态添加的。

但是，如果您要动态添加选项卡，那么您可能必须在列表中维护选项卡，然后为已删除的选项卡创建另一个列表。

但是第一个解决方案很可能对您有用。希望这可以帮助。

-阿琼

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-16T12:53:44.270

我会使用 QTabDialog::r​​emovePage(QWidget* pTabPage) ，它不会删除你想要的 pTabPage。

```
_myTabDlg->removePage(_mytab); 
```

我正在使用它，它工作正常！

# c# - 在 C# 中从序列化 XML 加载对象的最佳实践

> ID：207888
> 
> 赞同：0
> 
> 时间：2008-10-16T09:13:01.343
> 
> 标签：c#, .net, serialization, xml-serialization

问候，

我有一个可以从文件构造的特定对象，例如：

```
public class ConfigObj
{
     public ConfigObj(string loadPath)
     {
          //load object using .Net's supplied Serialization library
          //resulting in a ConfigObj object
          ConfigObj deserializedObj = VoodooLoadFunction(loadpath); 

          //the line below won't compile
          this = thisIsMyObj; 
     }
} 
```

从本质上讲，我想说“好的，现在我们刚刚反序列化了这个对象，这就是我们实际上的对象。” 有几种方法可以做到这一点，我想知道哪种方法被认为是最佳实践。我的想法是：

*   构建一个 copy-into-me 函数，逐个字段复制对象。这是当前的实现，我很确定这是一个可怕的想法，因为每当将新成员添加到对象时，我还需要记住将其添加到“复制到我”功能中，并且没有办法可以维护.
*   为 ConfigObj 类构建一个静态方法，该方法充当加载对象的事实上的构造函数。这听起来好多了，但不是最佳实践。

不过，我对两者中的任何一个都不完全满意。这里公认的最佳实践是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T09:21:18.830

您的第二个选项是所谓的[工厂方法](http://en.wikipedia.org/wiki/Factory_method_pattern)，是一种常见的设计技术。如果您确实使用了这种技术，您可能会发现在实际加载类之前需要知道要加载的类的类型。如果遇到这种情况，您可以使用更高级别的工厂类型，它查看流并为适当类型的类调用工厂方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T09:30:01.217

使用静态方法而不是构造函数没有任何问题。事实上，它有[很多优点](https://stackoverflow.com/questions/194496/static-method-or-instance-constructor)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T09:15:38.547

我总是使用静态方法。通常它是一种被加载的层次结构，因此只有根对象需要该方法。在 .NET 框架（例如 Graphics.FromImage）中，这并不是一种不寻常的方法，因此对于您的类的用户来说应该没问题。

# java - 递归而不是多循环

> ID：207889
> 
> 赞同：3
> 
> 时间：2008-10-16T09:13:50.453
> 
> 标签：java, recursion, loops, combinatorics

我希望这种方法适用于任何给定数量的参数，我可以通过代码生成来做到这一点（有很多丑陋的代码），它可以通过递归来完成吗？如果是这样怎么办？我理解递归，但我不知道如何写这个。

```
private static void allCombinations(List<String>... lists) {
    if (lists.length == 3) {
        for (String s3 : lists[0]) {
            for (String s1 : lists[1]) {
                for (String s2 : lists[2]) {
                    System.out.println(s1 + "-" + s2 + "-" + s3);
                }
            }
        }
    }
    if (lists.length == 2) {
        for (String s3 : lists[0]) {
            for (String s1 : lists[1]) {
                    System.out.println(s1 + "-" + s3);
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T09:31:53.333

这是一个简单的递归实现：

```
private static void allCombinations(List<String>... lists) {
  allCombinations(lists, 0, "");
}

private static void allCombinations(List<String>[] lists, int index, String pre) {
  for (String s : lists[index]) {
    if (index < lists.length - 1) {
      allCombinations(lists, index + 1, pre + s + "-");
    }else{
      System.out.println(pre + s);
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T09:24:28.387

你特别需要它是递归的吗？我会让它成为非递归的，但仍然不是特殊情况：

```
public static void allCombinations(List<String>... lists) {
    int[] indexes = new int[lists.length];

    while (incrementIndexes(lists, indexes)) {
        StringBuilder builder = new StringBuilder();
        for (int i=0; i < indexes.length; i++) {
            if (i != 0) {
                builder.append("-");
            }
            builder.append(lists[i].get(indexes[i]));
        }
        System.out.println(builder);
    }
}

private static boolean incrementIndexes(List<String>[] lists, int[] indexes) {
    for (int depth = indexes.length-1; depth >= 0; depth--) {
        indexes[depth]++;
        if (indexes[depth] != lists[depth].size()) {
            return true;
        }
        // Overflowed this index. Reset to 0 and backtrack
        indexes[depth] = 0;
    }
    // Everything is back to 0\. Finished!
    return false;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T10:08:03.527

这是一个广义的递归版本。它抱怨在测试代码中创建未经检查的通用数组，但置换代码本身是可以的：

```
import java.util.*;

public class Test
{
    public interface Action<T> {
        void execute(Iterable<T> values);
    }

    public static void main(String[] args) {
        List<String> first = Arrays.asList(new String[]{"1", "2", "3"});
        List<String> second = Arrays.asList(new String[]{"a", "b", "c"});
        List<String> third = Arrays.asList(new String[]{"x", "y"});
        Action<String> action = new Action<String>() {
            @Override public void execute(Iterable<String> values) {
                 StringBuilder builder = new StringBuilder();
                 for (String value : values) {
                     if (builder.length() != 0) {
                         builder.append("-");
                     }
                     builder.append(value);
                 }
                 System.out.println(builder);
            }
        };
        permute(action, first, second, third);
    }

    public static <T> void permute(Action<T> action, Iterable<T>... lists) {
        Stack<T> current = new Stack<T>();
        permute(action, lists, 0, current);
    }

    public static <T> void permute(Action<T> action, Iterable<T>[] lists,
        int index, Stack<T> current) {
        for (T element : lists[index]) {
            current.push(element);
            if (index == lists.length-1) {
              action.execute(current);
            } else {
              permute(action, lists, index+1, current);
            }
            current.pop();
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T10:50:19.727

这是我基于 Rasmus 解决方案的具有正确排序的递归解决方案。它仅在所有列表大小相同时才有效。

```
import java.util.Arrays;
import java.util.List;

public class Test {

        public static void main(String[] args) {
        List<String> first = Arrays.asList(new String[]{"1", "2", "3"});
        List<String> second = Arrays.asList(new String[]{"a", "b", "c"});
        List<String> third = Arrays.asList(new String[]{"x", "y", "z"});
        allCombinations (first, second, third);
        }

        private static void allCombinations(List<String>... lists) {
              allCombinations(lists, 1, "");
        }

        private static void allCombinations(List<String>[] lists, int index, String pre) {
            int nextHop = hop(index, lists.length-1);
          for (String s : lists[index]) {
            if (index != 0) {
              allCombinations(lists, nextHop, pre + s + "-");
            } else System.out.println(pre + s);
          }
        }
        private static int hop(int prevIndex, int maxResult){
            if (prevIndex%2 == 0){
                return prevIndex-2;
            } else {
                if (prevIndex == maxResult) 
                    return prevIndex-1;
                int nextHop = prevIndex+2;
                if (nextHop > maxResult){
                    return maxResult;
                } else return nextHop;
            }
        }

} 
```

允许不同大小列表的“正确排序”解决方案必须从最后一个列表开始并向后工作到第一个列表（lists [0]），将元素附加到“pre”字符串的开头或结尾并将其传递下去。同样，第一个列表将打印结果。我已经编码了，但是午餐已经准备好了，女朋友开始不喜欢 stackoverflow...

# c# - C#/.NET：检测程序是作为服务运行还是作为控制台应用程序运行

> ID：207896
> 
> 赞同：27
> 
> 时间：2008-10-16T09:16:11.180
> 
> 标签：c#, .net, service

我有一个可以作为控制台应用程序和服务运行的 C#/.NET 程序。目前我给它一个命令行选项来作为控制台应用程序启动，但我想避免这种情况。

是否可以以编程方式检测我的程序是否作为服务启动？

如果它是纯 Win32，我可以尝试使用 StartServiceCtrlDispatcher 作为服务启动，如果它返回 ERROR_FAILED_SERVICE_CONTROLLER_CONNECT，则返回到控制台，但 System.ServiceProcess.ServiceBase.Run() 如果失败，则会弹出一个错误对话框，然后返回而不会发出错误信号到程序。

有任何想法吗？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2010-02-18T10:39:31.080

[Environment.UserInteractive](http://msdn.microsoft.com/en-us/library/system.environment.userinteractive.aspx) will do the magic.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-16T09:47:19.340

拉斯穆斯， [这是前面的问题](https://stackoverflow.com/questions/200163/am-i-running-as-a-service#200183)。

从答案看来，最流行的方法是使用简单的命令行选项，或尝试在 try catch 块中访问控制台对象（在服务中，控制台未附加到进程并尝试访问它会引发异常） .

或者，如果您在测试/调试服务时遇到问题，请将代码移动到单独的 dll 程序集中并创建单独的测试工具（winforms/console 等）。

（刚刚注意到乔纳森在问题的末尾添加了他的解决方案。）

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-10-14T19:04:26.197

Might want to try SessionId property of the Process object. In my experience SessionId is set to 0 if the process is running a service.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-16T09:26:37.697

我没有尝试过，但[Process.GetCurrentProcess](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.getcurrentprocess.aspx)可能会有所帮助 - 在控制台模式下，进程名称将与可执行文件相同，而我希望（再次，请检查！）作为服务运行时情况会有所不同。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-06-01T14:40:27.537

```
[DllImport("kernel32.dll", SetLastError = true)]
static extern IntPtr GetStdHandle(int nStdHandle);
const int STD_OUTPUT_HANDLE = -11;

IntPtr iStdOut = GetStdHandle(STD_OUTPUT_HANDLE);

if (iStdOut == IntPtr.Zero)

{    
    app.RunAsWindowsService = true;

}

// Run as Service
if (runAsWindowsService)                                
{
     // .....
     ServiceBase.Run(myService);
}
else 
{
    // Run as Console
    // Register Ctrl+C Handler...
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-04-26T13:19:37.907

Using the ParentProcessUtilities struct from [this answer](https://stackoverflow.com/a/3346055/620178) about finding a parent process, you can do this:

```
static bool RunningAsService() {
    var p = ParentProcessUtilities.GetParentProcess();
    return ( p != null && p.ProcessName == "services" );
} 
```

Note that the process name for the parent process does not include the extension ".exe".

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-02-18T11:09:31.130

I don't know if this will work, but you may want to try using PInvoke with [this](http://www.codeguru.com/cpp/w-p/win32/article.php/c1437/) code and checking if the parent is "services.exe".

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-07-31T23:48:23.500

I ended up detecting whether or not I was in a console application by checking [Console.IsErrorRedirected](http://msdn.microsoft.com/en-us/library/system.console.iserrorredirected.aspx). It returned "false" for console apps, and "true" for the non-console apps I tested. I could have also used [IsOutputRedirected](http://msdn.microsoft.com/en-us/library/system.console.isoutputredirected.aspx).

I imagine there are circumstances where these will not be accurate, but this worked well for me.

# .net - nHibernate，我可以映射到没有每对象行映射的表吗？

> ID：207899
> 
> 赞同：1
> 
> 时间：2008-10-16T09:18:38.837
> 
> 标签：.net, nhibernate, database-design

我有一个数据库，其中包含一个看起来有点像这样的表：

属性 ID、实体 ID、值

PropertyId 和 EntityId 是组合的主键。每个实体都分布在几行中，其中每一行都包含实体的一个属性。我无法控制这个数据库，所以我必须使用它。

是否可以使用 NHibernate 将此表中的实体映射到单个对象？我只需要从这张表中阅读，这可能会让事情变得更容易一些。还是我最好只使用 DataReaders 并自己进行映射？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-16T09:46:26.113

还没有完全做到这一点，但您可以使用自定义 SQL 查询来定义您的实体（不同的 entityid，以及任何实体级别的属性），请参见[此处](http://www.hibernate.org/hib_docs/nhibernate/1.2/reference/en/html_single/#querysql-load)。

尽管我可以看到您可能希望将属性/值映射到实体对象的属性。这可能意味着需要进一步查询以手动填充它们——这可能意味着您的数据读取器路线是最好的。

如果您对它们成为实体的集合感到高兴，那应该没问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-17T16:20:14.960

我不记得确切的语法，但 a`map`会这样做：

```
<map name='Values' table='EntityPropertyValue'>
  <key column='EntityId'  />
  <index-many-to-many class='Person' column='PersonId' />
  <element column='Value' type='object' />
</map> 
```

# .net - 当用户取消添加过程时，如何删除正在添加的 DataGridView 行？

> ID：207901
> 
> 赞同：1
> 
> 时间：2008-10-16T09:18:59.647
> 
> 标签：.net, winforms, datagridview

我有一个数据绑定`DataGridView`。当添加新行并且用户按下`Esc`我想删除整行时。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-16T09:50:36.137

实际上很容易

```
private void dataGridView1_KeyPress(object sender, KeyPressEventArgs e)
{
    if (e.KeyChar == (char)27)
    {
        if (dataGridView1.Rows.Count > 0)
        {
            dataGridView1.Rows.RemoveAt(dataGridView1.Rows.Count - 1);
            MessageBox.Show("Last row deleted!");
        }
        e.Handled = true;
    }
} 
```

**但请记住：**

> 除非 DataGridView 数据绑定到支持更改通知并允许删除的 IBindingList，否则无法以编程方式删除行

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-09-08T12:59:59.853

如果要从 DataGrid 中删除行，则必须使用 BindingSource 而不是列表，否则在执行此操作时会出现异常。

尝试这个：

```
public partial class YourForm : Form {

  private BindingSource _source = new BindingSource();

  public YourForm() {
    List<Model> list = _service.GetList();
    _source.DataSource = list;
    _grid.DataSource = _source;
  }
} 
```

现在您可以使用您的数据源，并且网格会自行运行。不要忘记在每次更改后调用 _grid.Refresh()。

干杯，

安德烈·卡鲁奇

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-25T13:27:04.007

`DataGridView`除非数据绑定到`IBindingList`支持更改通知并允许删除的行，否则无法以编程方式删除行。

# visual-studio-2005 - 在 Visual Studio 中如何最好地处理巨大的源代码文件

> ID：207902
> 
> 赞同：6
> 
> 时间：2008-10-16T09:19:17.760
> 
> 标签：visual-studio-2005, code-generation, resharper

我正在开发一个大量使用代码生成的项目。它生成的一些文件包含超过 25 万行代码。VS (2K5) 处理得不太好，但 R# (4.01) 每两分钟左右就会抛出一个内存不足异常。

**将它们拆分为部分类/单独的文件在短期内不是一种选择，尽管可能会在以后。**

是否有任何巧妙的 IDE 技巧来处理这个问题？

编辑：所以人们立即（非常明智地）说“没有那么大的文件”并建议将其分解为较小文件的方法。

这很好，但我正在执行一项有时间限制的任务，环顾四周并决定要优化什么。我的问题非常具体地是“如何在 IDE 中轻松查看异常大的文件”，而不是“如何重构项目”。出于问题的目的，请想象该文件是只读的。:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-16T10:02:41.587

I would at least change huge files extention to something like *.cpp_gen* or *.cpp_huge* to remove syntax highlighting, outlining etc. and then reassign build tool back to *C/C++ compiler tool* for them.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-16T15:15:15.793

Seems like this R# tool (is that Resharper?) is the problem. Can you disable it? Otherwise, changing the file type for the generated code might make sense - presumably, you aren't going to be doing major editing on those files, so losing syntax coloring and other features specific to source files wouldn't be an issue.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-16T09:26:21.630

哇！

25 万行代码？

你不应该从机器的角度思考，而应该从人类的角度思考。假设您想将该代码传递给其他人，您能看到时间来查看代码的作用吗？

设计模式是用来处理这些问题的，尝试从小处着手，重构它，然后更深入并开始应用更多的 DP

您将拥有越来越少的代码行，是的，最好的技巧之一是根据它的建议分成几个文件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-16T09:29:01.530

假设您不是手动编辑生成的代码。（=坏主意！！）

您可以将生成的文件放在从命令行编译的单独解决方案中，然后从您正在处理的项目中引用这些 dll。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-16T12:10:30.767

Is the problem when you open the file for editing in Visual Studio? I've noticed that VS editor can be quite slow and inefficient on large files. Also, you could try turning off certain options, e.g. word-wrapping kills my machine for some reason.

Otherwise you could use something else like Textpad with syntax highlighting installed to edit the problematic large source file... not as nice, for sure.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-16T15:32:41.577

Don't use visual studio. There is too much going on in VS.

Since the file is read only, you wont be using any IDE features (Intellisense, Refactoring tools, formatting).

You will probably get better performance using a simpler application, such as notepad++ for simply viewing the file. Notepad++ will do standard language highlighting if you like color.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-16T09:25:43.487

您不能在编译时分解文件并使用预处理器将它们重新组合在一起吗？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-16T09:34:26.760

必须有可能以某种方式将这些文件的大块分组到单独的库中。然后，您将它们分成几个项目。试过这个？您的源代码/项目的当前结构是什么？

# python - 有没有带有观察点的免费 python 调试器？

> ID：207904
> 
> 赞同：8
> 
> 时间：2008-10-16T09:21:17.707
> 
> 标签：python, debugging, pdb, watchpoint

pdb 和 winpdb 似乎都缺少这个（对我而言）必不可少的功能。我看到一些东西暗示 WingIDE 有它，但我更喜欢免费的解决方案，如果我必须付费，我更愿意为比 Wing 更好的东西付费。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-16T10:44:52.267

你应该看看[Eric4](http://eric-ide.python-projects.org/)

这是一个非常好的带有内置调试器的 Python IDE。调试器具有全局变量、局部变量和观察点的视图。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-16T09:49:47.697

请看看 pydev 在 Eclipse 提供什么...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-16T10:04:30.383

看看[PyScripter](http://mmm-experts.com/Products.aspx?ProductID=4)。它有一个集成的调试器、监视窗口等等。它是开源的，并[在此处](http://pyscripter.googlepages.com/)开发。

高温高压

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-16T16:55:21.660

可惜python本身自带的标准pdb模块还不支持watchpoints。

此处描述：[http ://wiki.python.org/moin/PdbImprovments](http://wiki.python.org/moin/PdbImprovments)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-23T19:06:19.410

内置 pdb.py 的这种重新实现具有观察点。

[http://morepypy.blogspot.com/2008/06/pdb-and-rlcompleterng.html](http://morepypy.blogspot.com/2008/06/pdb-and-rlcompleterng.html)

我试过了，但粗略的尝试无法让它工作。

# jsp - 带有struts的jsp useBean

> ID：207907
> 
> 赞同：1
> 
> 时间：2008-10-16T09:22:30.653
> 
> 标签：jsp, forms, struts, javabeans

我对此很陌生，所以请放轻松。

我试图开始工作的代码是：

```
<jsp:useBean id="EJD" class= "MoverDetailForm" scope="application"/>
<jsp:setProperty name="EJD" property="empFDJoiningDate" param="empFDJoiningDate" />

<% String empFDJoiningDate = EJD.getEmpFDJoiningDate();
out.print("please work" + empFDJoiningDate); %> 
```

empFDJoiningDate 返回“null”，所以我认为它找不到 MoverDetailFom.java？

这确实存在

```
public class MoverDetailForm extends AbstractCandidateForm {

private String empFDJoiningDate;

/**
 * @return Returns the empFDJoiningDate.
 */
public String getEmpFDJoiningDate() {
    return empFDJoiningDate;
}
/**
 * @param empName The empName to set.
 */
public void setEmpFDJoiningDate(String empFDJoiningDate) {
    this.empFDJoiningDate = empFDJoiningDate;
} 
```

任何建议将不胜感激。我被困住了！

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T12:47:26.963

看起来好像您没有为 empFDJoiningDate 属性设置值。param 属性将尝试将 bean 上的属性设置为请求参数。您是否有一个包含名为 empFDJoiningDate 的字段的表单提交到此页面？

您应该使用这样的静态值进行测试：

```
<jsp:useBean id="EJD" class= "MoverDetailForm" scope="application"/>
<jsp:setProperty name="EJD" property="empFDJoiningDate" value="My Static Value" /> 
```

如果打印出*我的静态值*，则问题出在参数上。您可以使用 url 上的查询字符串很容易地测试参数。假设您的 jsp 页面被命名为 mypage.jsp。然后构造一个这样的 url：*mypage.jsp?empFDJoiningDate=TestThis*并使用这个 url 在浏览器中请求您的页面。

# sql-server - 两个 MS SQL Server 2005 之间的分布式事务

> ID：207924
> 
> 赞同：0
> 
> 时间：2008-10-16T09:27:27.773
> 
> 标签：sql-server, sql-server-2005, tsql, transactions, msdtc

我需要在两个 MS SQL Server 2005 之间进行 DISTRIBUTED TRANSACTION，它会丢弃一个错误，即 NO ACTIVE TRANSACTION IS PRESENT 或类似这样的事情。DTCTESTER 程序丢弃事务无法完成的错误。btw 135 端口在防火墙上打开。

也许有人知道有什么问题，或者有什么建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-20T17:47:16.983

[KB 954950](http://support.microsoft.com/kb/954950/)看起来像问题，补丁在 SP2 后的修补程序中

# project-management - 如何保持业务支持团队的积极性？

> ID：207925
> 
> 赞同：4
> 
> 时间：2008-10-16T09:28:24.013
> 
> 标签：project-management

在我的职业生涯中，我注意到开发新功能的开发人员通常比那些负责故障排除和修复错误的开发人员更快乐。

保持业务支持愉快的好技巧？以不损害团队士气的方式组织业务支持？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-16T09:51:55.760

如果我们开始假设新功能开发人员更快乐的原因是他们感到主动或可控，并且故障排除人员是被动的并被用户推动，那么一个答案会浮现在脑海中：

为那些对修复进行故障排除的人创建一个模型，以将这些从点修复概括为针对一类问题的广泛、一致的修复。这使他们处于创建新代码（即使不是新功能）的境地，他们可以通过思考问题并预测和避免问题，而不是玩打地鼠游戏。

在快速移动的环境中，还可以通过让人们遵循他们的功能从新开发到修复和发布，并希望进入该功能的第 2 版，来轮换工作描述。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-16T09:55:10.353

我们的组织有大量的支持工作，我们在这个问题上遇到了非常严重的问题。如果你做得不好，支持团队的动力可能会随着时间的推移呈指数下降。

对我们有用的原则是：

1.  选择合适的人。有些人更乐于做新事物。有些人实际上更适合一份稳定而严肃的工作。这意味着您应该有两个团队 - 一个用于开发，一个用于支持。*开发人员*只停留在已完成的项目上，直到他们将知识传递给*支持者*。
2.  选择合适的领导者。良好的组织在这里成败。一个好的领导会帮助组织与产品用户的良好关系，同时会关心他的团队。
3.  旋转。我们尝试将支持人员留在项目中不到 2 年的时间，然后将他们转移到新的领域。这有助于保持适当的士气，并确保他们的技能不会生锈。
4.  与客户的关系。确保支持团队知道他们的价值。客户/用户应该偶尔拜访团队，或者团队应该去现场与用户进行面对面的交流（友好的晚餐或午餐也会有所帮助）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-16T09:48:22.287

我也见过这个。我能想到的方法很少：

**1\. 考虑选择过程。**

不是每个人都有相同的职业抱负。虽然有些人总是渴望为最新的技术和具有挑战性的项目工作，但也有一些人满足于稳定的工作环境。选择具有正确 KSA（知识、技能、态度）的人始终是良好的人事匹配的核心。在这种情况下，您只需要在 Attitude 部分施加更多压力。

**2\. 选择合适的领导**

团队领导在控制团队的动力和士气方面起着至关重要的作用。与团队领导和高层管理人员必须有一个开放和坦诚的沟通渠道。理想情况下，高层管理人员应该成为正式组织结构图中团队的所有者。团队领导应积极尝试培养适合团队性质的团队文化。

**3\. 奖励**

课程外奖励是管理动机问题的关键工具。只要确保获得奖励的人明白，在决定奖励时也考虑了工作的性质。如果这一点没有得到解决，这个人在感知内部公平时很可能不会考虑这个因素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-26T18:04:25.707

按照贝尔的建议，考虑让新开发人员或初级开发人员在修复问题上大吃一惊。根据他们的表现和能力，将他们从维护团队提升到功能团队。

健康的竞争也是一个很好的动力，但必须设法保持积极的影响。

# java - 使用 Java 处理简单 2D 图形的最佳 API

> ID：207938
> 
> 赞同：13
> 
> 时间：2008-10-16T09:33:11.490
> 
> 标签：java, graphics, java-2d

我不确定使用 Java 进行简单 2d 图形的最佳 api 是什么。我知道`java.awt.Graphics2D`是标准，但它被替换了吗？Swing 是 Java GUI 应用程序的新 API，但对于我想要的东西来说似乎有点沉重。我真正想要的是 C [SDL library](http://libsdl.org/)之类的东西。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-16T09:56:08.230

[Java 2D](http://docs.oracle.com/javase/tutorial/2d/)（`Graphics2D`和朋友）确实是我所知道的最佳选择。Swing 实际上是在 Java 2D 之上实现的，所以是的，如果您想要非 GUI 类型的图形，Java 2D 是最好的选择。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-11-29T08:35:19.943

如果您想在构建游戏时尽可能减少工作量（或者即使不是），请使用[http://slick.cokeandcode.com/](http://slick.cokeandcode.com/)

更新：链接已更改为[http://slick.ninjacave.com/](http://slick.ninjacave.com/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-09-23T15:01:46.017

可以在此处找到与 SDL 的 Java 绑定：

[http://sdljava.sourceforge.net/](http://sdljava.sourceforge.net/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-11-29T08:37:43.550

[Processing.org](http://processing.org/)有一些很好的易于使用的 2D 东西（和 3D）。它有一个[PApplet](http://dev.processing.org/reference/core/javadoc/processing/core/PApplet.html)类，它从 AWT 实现 Applet 以及一堆有用的操作，并且与[Java2D](http://java.sun.com/products/java-media/2D/index.jsp)一起工作得很好。

如果你只是想弄乱 2d 图形，它有一个“画板 IDE”，如果你只是想试验它，你不需要把它放在你的 java IDE 中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-02-12T06:06:21.303

[Piccolo](http://code.google.com/p/piccolo2d/)是绘制图形的好选择。它是一个支持可缩放用户界面的 2D 图形工具包。适用于 Java 和 .Net。

# python - 实现 ftps 的 Python 模块

> ID：207939
> 
> 赞同：9
> 
> 时间：2008-10-16T09:33:39.070
> 
> 标签：python, ftps

我想知道是否有人可以将我指向 python 的免费 ftps 模块。

我是 python 的新手，但这是我工作项目需要的东西。我需要一个 ftps 客户端来连接到第 3 方 ftps 服务器。

谢谢，

大卫。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-16T12:00:12.503

我相信您可以使用 Twisted 通过简单地使用其 FTP 实现来实现 FTPS，但将[`FTPClient.connectFactory`](http://twistedmatrix.com/trac/browser/trunk/twisted/protocols/ftp.py?rev=24609#L2186)属性更改为使用[`connectSSL`](http://twistedmatrix.com/documents/8.1.0/api/twisted.internet.interfaces.IReactorSSL.connectSSL.html)而不是`connectTCP`.

你确定你想要FTPS吗？ [SFTP 是一种不同的、更好的、更流行的协议](http://geekswithblogs.net/bvamsi/archive/2006/03/23/73147.aspx)：Twisted 也包含[一个 SFTP 实现](http://twistedmatrix.com/trac/browser/trunk/twisted/conch/ssh/filetransfer.py?rev=24609)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-12-26T18:54:21.043

Python 2.7.1 版中的 ftplib 模块具有您需要的所有功能，包括 TLS 支持。

[http://docs.python.org/library/ftplib.html#module-ftplib](http://docs.python.org/library/ftplib.html#module-ftplib)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-18T20:16:09.363

[M2Cypto](http://chandlerproject.org/bin/view/Projects/MeTooCrypto)有一个 FTPS 模块。从[文档](http://eikkitoivonen.net/m2crypto/api/M2Crypto.ftpslib-module.html)中：

```
>>> from M2Crypto import ftpslib
>>> f = ftpslib.FTP_TLS()
>>> f.connect('', 9021)
'220 spinnaker.dyndns.org M2Crypto (Medusa) FTP/TLS server v0.07 ready.'
>>> f.auth_tls()
>>> f.set_pasv(0)
>>> f.login('ftp', 'ngps@')
'230 Ok.'
>>> f.retrlines('LIST')
-rw-rw-r--   1 0        198          2326 Jul  3  1996 apache_pb.gif
drwxrwxr-x   7 0        198          1536 Oct 10  2000 manual
drwxrwxr-x   2 0        198           512 Oct 31  2000 modpy
drwxrwxr-x   2 0        198           512 Oct 31  2000 bobo
drwxr-xr-x   2 0        198         14336 May 28 15:54 postgresql
drwxr-xr-x   4 100      198           512 May 16 17:19 home
drwxr-xr-x   7 100      100          3584 Sep 23  2000 openacs
drwxr-xr-x  10 0        0             512 Aug  5  2000 python1.5
-rw-r--r--   1 100      198           326 Jul 29 03:29 index.html
drwxr-xr-x  12 0        0             512 May 31 17:08 python2.1
'226 Transfer complete'
>>> f.quit()
'221 Goodbye.'
>>> 
```

或者，如果您想尽量减少对第三方模块的使用，您应该能够使用内置（对 Python）SSL 支持来继承标准库的[ftplib .FTP 类。](http://docs.python.org/library/ftplib.html#module-ftplib)不过， M2Crypto （或[Twisted](http://twistedmatrix.com/trac/)，如果你想这样做的话）是更简单的解决方案。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-16T10:19:31.630

[Twisted](http://twistedmatrix.com/trac/wiki/TwistedProject)似乎在*conch*子项目下实现了一些 FTPS（基于 SSL 的 FTP）。我不是扭曲专家，但[Glyph](https://stackoverflow.com/users/13564/glyph)，*扭曲*的人本人，在这个网站上列出。也许通过他对另一个问题的[回答](https://stackoverflow.com/questions/80617/asychronous-programming-in-python-twisted#81456)，您可以找到更多详细信息（祝您好运）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-03-21T18:47:59.497

至于服务器实现，您可以查看 pyftpdlib： [http](http://code.google.com/p/pyftpdlib/) ://code.google.com/p/pyftpdlib/ 它包括一个实现工作 FTPS 服务器的演示脚本： [http ://code.google.com/p/ pyftpdlib/source/browse/trunk/demo/tls_ftpd.py](http://code.google.com/p/pyftpdlib/source/browse/trunk/demo/tls_ftpd.py)

至于客户端实现，我提供了一个补丁，它将包含在 python 2.7 和 3.2 中。 [http://bugs.python.org/issue2054](http://bugs.python.org/issue2054)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-16T09:36:43.403

我自己没有尝试过（是的，我只是使用谷歌并点击了一些链接），但[http://www.lag.net/paramiko/](http://www.lag.net/paramiko/)似乎是推荐的解决方案。粗略一看，它是纯 Python 中的 SSH 实现，它允许为 FTP 之类的东西建立隧道。

更新：一位评论者指出我混淆了 sftp 和 ftps，抱歉。我仍然建议至少简要调查一下 Paramiko，看看它是否符合要求。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-17T02:38:30.297

我找不到适用于 Windows 的免费 sftp 客户端，所以我最终使用 python 的 subprocess 模块包装了 Putty 的 PSFTP。如果我知道的话，我可能会使用 Glyph 提到的扭曲实现。

无论如何，如果您有兴趣，请访问：

[http://code.google.com/p/psftplib/](http://code.google.com/p/psftplib/)

# java - 为什么 AbstractQueuedSynchronizer 在获取锁时会中断

> ID：207946
> 
> 赞同：1
> 
> 时间：2008-10-16T09:37:04.523
> 
> 标签：java, multithreading, concurrency, locking

我正在查看 java.uti.concurrent.locks.AbstractQueuedSynchronizer 的源代码，acquire() 方法看起来像这样 -

```
 public final void acquire(int arg) {
    if (!tryAcquire(arg) &&
        acquireQueued(addWaiter(Node.EXCLUSIVE), arg))
        Thread.currentThread().interrupt();
} 
```

为什么它会中断调用acquire()的线程？如果在线程 run() 方法中的某处进行了检查，那么它可能会在调用 acquire() 之后通过，这可能是不可取的和没有想到的？

有人想弄清楚为什么上面的代码会这样做吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-16T09:44:34.197

如果您阅读 Javadoc `acquiredQueued`，您会注意到如果线程在等待时被中断，它会返回 true。因此，调用`selfInterrupt`（就像在 OpenJDK 源代码中调用的那样）是将中断传播到调用线程，否则会被吞没。

# java - 如何获得依赖于平台的换行符？

> ID：207947
> 
> 赞同：571
> 
> 时间：2008-10-16T09:37:05.883
> 
> 标签：java, cross-platform, newline, eol

如何在 Java 中获得依赖于平台的换行符？我不能`"\n"`到处使用。

* * *

## 回答 #1

> 赞同：743
> 
> 时间：2012-06-07T18:05:42.250

Java 7 现在有一个[`System.lineSeparator()`](http://docs.oracle.com/javase/8/docs/api/java/lang/System.html#lineSeparator--)方法。

* * *

## 回答 #2

> 赞同：654
> 
> 时间：2008-10-16T09:39:26.937

您可以使用

```
System.getProperty("line.separator"); 
```

获取行分隔符

* * *

## 回答 #3

> 赞同：374
> 
> 时间：2008-10-16T18:45:40.893

除了 line.separator 属性，如果您使用 java 1.5 或更高版本以及**String.format**（或其他**格式化**方法），您可以`%n`使用

```
Calendar c = ...;
String s = String.format("Duke's Birthday: %1$tm %1$te,%1$tY%n", c); 
//Note `%n` at end of line                                  ^^

String s2 = String.format("Use %%n as a platform independent newline.%n"); 
//         %% becomes %        ^^
//                                        and `%n` becomes newline   ^^ 
```

有关更多详细信息，请参阅[Java 1.8 API for Formatter](http://docs.oracle.com/javase/8/docs/api/java/util/Formatter.html)。

* * *

## 回答 #4

> 赞同：43
> 
> 时间：2008-10-16T18:49:15.550

如果您尝试将换行符写入文件，您可以简单地使用 BufferedWriter 的[newLine()](http://java.sun.com/javase/6/docs/api/java/io/BufferedWriter.html#newLine())方法。

* * *

## 回答 #5

> 赞同：31
> 
> 时间：2013-04-25T14:48:48.980

这也是可能的：`String.format("%n")`.

或者`String.format("%n").intern()`节省一些字节。

* * *

## 回答 #6

> 赞同：22
> 
> 时间：2012-03-28T16:33:54.407

[commons-lang](http://commons.apache.org/proper/commons-lang/)库有一个可用的常量字段，称为[SystemUtils.LINE_SEPARATOR](http://commons.apache.org/proper/commons-lang/javadocs/api-3.1/org/apache/commons/lang3/SystemUtils.html#LINE_SEPARATOR)

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2015-09-29T11:20:31.210

```
StringBuilder newLine=new StringBuilder();
newLine.append("abc");
newline.append(System.getProperty("line.separator"));
newline.append("def");
String output=newline.toString(); 
```

上面的代码片段将有两个由新行分隔的字符串，而与平台无关。

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2012-01-20T12:24:21.707

如果您正在使用实例写入文件，请使用该`BufferedWriter`实例的`newLine()`方法。它提供了一种独立于平台的方式来在文件中写入新行。

* * *

## 回答 #9

> 赞同：-4
> 
> 时间：2012-12-05T08:53:13.207

避免使用 String + String 等附加字符串，请改用 StringBuilder。

```
String separator = System.getProperty( "line.separator" );
StringBuilder lines = new StringBuilder( line1 );
lines.append( separator );
lines.append( line2 );
lines.append( separator );
String result = lines.toString( ); 
```

# linux - 相当于 %~dp0 在 sh

> ID：207959
> 
> 赞同：17
> 
> 时间：2008-10-16T09:46:59.247
> 
> 标签：linux, shell, batch-file

我正在使用 sh 将一些 Windows 批处理文件转换为 Unix 脚本。我有问题，因为某些行为取决于批处理文件中可用的 %~dp0 宏。

有没有 sh 相当于这个？有什么方法可以获取执行脚本所在的目录吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-16T10:13:28.710

问题（对您而言）`$0`是它被设置为用于调用脚本的任何命令行，而不是脚本本身的位置。这会使获取包含脚本的目录的完整路径变得困难，而脚本是您从`%~dp0`Windows 批处理文件中获得的。

例如，考虑以下脚本`dollar.sh`：

```
#!/bin/bash
echo $0 
```

如果你运行它，你会得到以下输出：

```
# ./dollar.sh
./dollar.sh
# /tmp/dollar.sh
/tmp/dollar.sh 
```

因此，要获取脚本的完全限定目录名称，我执行以下操作：

```
cd `dirname $0`
SCRIPTDIR=`pwd`
cd - 
```

这工作如下：

1.  `cd`使用命令行中的相对或绝对路径到脚本的目录。
2.  获取此目录的绝对路径并将其存储在`SCRIPTDIR`.
3.  使用“”返回上一个工作目录`cd -`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-16T09:48:02.413

是的你可以！它在争论中。:)

看着

```
${0} 
```

将其与

```
{$var%Pattern}
Remove from $var  the shortest part of $Pattern that matches the back end of $var. 
```

你想要的只是

```
${0%/*} 
```

我推荐[Advanced Bash Scripting Guide](http://tldp.org/LDP/abs/html/) （这也是上述信息的来源）。特别是关于[将 DOS 批处理文件转换为 Shell 脚本](http://tldp.org/LDP/abs/html/dosbatch.html)的部分 可能对您有用。:)

如果我误解了你，你可能需要将它与“pwd”的输出结合起来。因为它只包含调用脚本的路径！尝试以下脚本：

```
#!/bin/bash
called_path=${0%/*}
stripped=${called_path#[^/]*}
real_path=`pwd`$stripped
echo "called path: $called_path"
echo "stripped: $stripped"
echo "pwd: `pwd`"
echo "real path: $real_path 
```

不过，这需要一些工作。我推荐使用 Dave Webb 的方法，除非那是不可能的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-17T14:37:58.130

在 linux 下的 bash 中，您可以使用以下命令获取命令的完整路径：

```
readlink /proc/$$/fd/255 
```

并获取目录：

```
dir=$(dirname $(readlink /proc/$$/fd/255)) 
```

这很丑陋，但我还没有找到另一种方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-16T15:57:53.303

我试图找到来自另一个脚本的脚本的路径。这就是我的问题，当采购文本只是被复制到调用脚本中时，所以 $0 总是返回有关调用脚本的信息。

我找到了一个解决方法，它只适用于 bash，$BASH_SOURCE 总是有关于它被引用的脚本的信息。即使脚本是来源的，它也会正确解析为原始（来源）脚本。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-16T09:49:06.840

尝试这个：

```
${0%/*} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-06-19T05:40:12.953

This should work for bash shell:

```
dir=$(dirname $(readlink -m $BASH_SOURCE)) 
```

Test script:

```
#!/bin/bash
echo $(dirname $(readlink -m $BASH_SOURCE)) 
```

Run test:

```
$ ./somedir/test.sh 
/tmp/somedir
$ source ./somedir/test.sh 
/tmp/somedir
$ bash ./somedir/test.sh 
/tmp/somedir
$ . ./somedir/test.sh 
/tmp/somedir 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-12-24T23:07:58.083

这是一个*脚本*可以在执行或获取时获取shell文件的真实路径。
在**bash、zsh、dash、sh**中测试。

顺便说一句：你应该自己清理冗长的代码。

```
#!/usr/bin/env bash

_ORIGINAL_PWD_=$(pwd)

if test -n "$BASH" ; then _SH_FILE_RUN_PATH_=${BASH_SOURCE[0]}
elif test -n "$TMOUT"; then _SH_FILE_RUN_PATH_=${.sh.file}
elif test -n "$ZSH_NAME" ; then _SH_FILE_RUN_PATH_=${(%):-%x}
# Use lsof,tr,tail,sed to retrieve path
else _SH_FILE_RUN_PATH_=$(lsof -p $$ -Fn0 | tr -d '\0' | tail -1 | sed 's/^[^\/]*//g')
fi

echo "\$0: $0"
echo "\$_: $_"
echo "\$BASH: $BASH"
echo "\$TMOUT: $TMOUT"
echo "\$ZSH_NAME: $ZSH_NAME"
echo "\${0##*/}: ${0##*/}"

echo "EXECUTING FILE PATH: $_SH_FILE_RUN_PATH_"

cd "$(dirname "$_SH_FILE_RUN_PATH_")" || return
_SH_FILE_RUN_BASENAME_=$(basename "$_SH_FILE_RUN_PATH_")

# Iterate down a (possible) chain of symlinks as lsof of macOS doesn't have -f option.
while [ -L "$_SH_FILE_RUN_BASENAME_" ]
do
    _SH_FILE_REAL_PATH_=$(readlink "$_SH_FILE_RUN_BASENAME_")
    cd "$(dirname "$_SH_FILE_REAL_PATH_")" || return
    _SH_FILE_RUN_BASENAME_=$(basename "$_SH_FILE_REAL_PATH_")
done

# Compute the canonicalized name by finding the physical path
# for the directory we're in and appending the target file.
_SH_FILE_REAL_DIR_=$(pwd -P)
_SH_FILE_REAL_PATH_=$_SH_FILE_REAL_DIR_/$_SH_FILE_RUN_BASENAME_
echo "EXECUTING REAL PATH: $_SH_FILE_REAL_PATH_"
echo "EXECUTING FILE DIR: $_SH_FILE_REAL_DIR_"

cd "$_ORIGINAL_PWD_" || return
echo "CURRENT PWD: $(pwd)" 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-08-28T21:18:07.687

正确答案是： [如何确定脚本的位置？我想从同一个地方读取一些配置文件。](http://mywiki.wooledge.org/BashFAQ/028)

> 重要的是要认识到，在一般情况下，**这个问题没有解决方案**。您可能听说过的任何方法以及将在下面详述的任何方法都有缺陷，并且仅在特定情况下有效。首先，不要依赖脚本的位置，尽量避免这个问题！
> 
> 在我们深入研究解决方案之前，让我们澄清一些误解。重要的是要了解： **您的脚本实际上没有位置**！无论字节最终来自哪里，**都没有“一条规范路径”。**绝不。$0 不是您问题的答案。如果您认为是这样，您可以停止阅读并编写更多错误，或者您可以接受并继续阅读。...

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-16T10:02:03.833

我之前试过$0，即：

> 目录名 $0

它只是返回“。” 即使脚本是由另一个脚本提供的：

> . ../somedir/somescript.sh

# sql - 在 PostgreSQL 中查看错误

> ID：207964
> 
> 赞同：18
> 
> 时间：2008-10-16T09:48:42.927
> 
> 标签：sql, postgresql, pgadmin

我在 PostgreSQL 数据库中有一个大型查询。查询是这样的：

```
SELECT * FROM table1, table2, ... WHERE table1.id = table2.id... 
```

当我将此查询作为 sql 查询运行时，它会返回所需的行。

但是当我尝试使用相同的查询来创建视图时，它会返回一个错误：

“错误：列“id”指定了多次。”

（我在执行查询时使用 pgAdminIII。）

我猜会发生这种情况，因为结果集将有多个名为“id”的列。有没有办法解决这个问题，而无需在查询中写入所有列名？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-10-16T10:02:59.073

发生这种情况是因为视图将有两个 id 命名的列，一个来自 table1，一个来自 table2，因为 select *.

您需要在视图中指定您想要的 id。

```
SELECT table1.id, column2, column3, ... FROM table1, table2 
WHERE table1.id = table2.id 
```

该查询有效，因为它可以具有相同名称的列...

```
postgres=# select 1 as a, 2 as a;
 a | a
---+---
 1 | 2
(1 row)

postgres=# create view foobar as select 1 as a, 2 as a;
ERROR:  column "a" duplicated
postgres=# create view foobar as select 1 as a, 2 as b;
CREATE VIEW 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-09-29T17:25:49.803

如果只有连接列是重复的（即具有相同的名称），那么您可以摆脱更改：

```
select *
from a, b
where a.id = b.id 
```

到：

```
select *
from a join b using (id) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-15T03:08:06.577

如果您来到这里是因为您尝试使用类似的函数`to_date`并收到“多次定义”错误，请注意您需要为函数使用列别名，例如：

```
to_date(o.publication_date, 'DD/MM/YYYY') AS publication_date 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2008-10-16T13:59:09.003

语言中没有内置的方法来解决它（坦率地说，* 通常是一种不好的做法，因为它可能会导致潜在缺陷随着表模式的变化而出现 - 你可以做 table1.*, table2.acolumn, tabl2.bcolumn如果你想要一个表的所有并有选择地从另一个表中选择），但如果 PostgreSQL 支持 INFORMATION_SCHEMA，你可以执行以下操作：

```
DECLARE @sql AS varchar

SELECT @sql = COALESCE(@sql + ', ', '') 
    + '[' + TABLE_NAME + '].[' + COLUMN_NAME + ']'
    + CHAR(13) + CHAR(10)
FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_NAME IN ('table1', 'table2')
ORDER BY TABLE_NAME, ORDINAL_POSITION

PRINT @sql 
```

并粘贴结果以节省大量输入。当然，您需要手动为具有相同名称的列设置别名。如果您愿意（但我不这样做），您还可以编码生成唯一名称：

```
SELECT @sql = COALESCE(@sql + ', ', '') 
    + '[' + TABLE_NAME + '].[' + COLUMN_NAME + '] '
    + 'AS [' + TABLE_NAME + '_' + COLUMN_NAME + ']'
    + CHAR(13) + CHAR(10)
FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_NAME IN ('table1', 'table2')
ORDER BY TABLE_NAME, ORDINAL_POSITION 
```

# c++ - 使用堆栈将成员变量重置为其原始值的一般方法？

> ID：207965
> 
> 赞同：2
> 
> 时间：2008-10-16T09:49:00.850
> 
> 标签：c++, callstack

我遇到了一个类实例函数，它需要临时更改一个类实例变量，然后在函数完成时恢复它。该函数到处都有返回语句，并且在每次返回之前都有一个恢复语句。这对我来说似乎很乱，更不用说抛出异常时的可怕了。

作为改进，我使用内部类定义提出了这种概括。这是一个示例驱动程序（类恢复器）。

```
class Unwind {
private:
  bool b_active_; ///< the thing I want to be restored
  template<typename T>
  class restorer {
    T* ref_;
    T save_;
  public:
    restorer(T* perm) : ref_(perm), save_(*ref_) {};
    ~restorer() { *ref_ = save_; }
  };
public:
  Unwind() : b_active_(false) {};
  void a() { out("a in"); b(); out("a end"); }
  void b() {
    out("b in");
    {
      restorer<bool> trust_in_the_stack(&b_active_); // "restorer" created on the stack
      b_active_ = true; // change b_active_ only while "within" b()
      c();
      out("b inner end");
    }
    out("b end");
  }
  void c() { out("c in"); d(); out("c end"); }
  void d() { out("d in"); cout << "deepest" << endl; out("d end"); }
  void out(const std::string& msg) {
    std::cout << msg << ": " << b_active_ << std::endl;
  }
};

int main() { Unwind u; u.a(); return 0; } 
```

使用 g++ 4.2.3 (-Wall) 的输出是：

```
一个在：0
乙在：0
中：1
内径：1
最深
d 结束：1
c结束：1
b 内端：1
b结束：0
结束：0

```

这是我对“b end”的期望。

我觉得在 Unwind 类中定义类恢复器有助于阻止滥用。

我的问题是，是否有一种通用且更安全的方法来做到这一点？我担心一生的问题。

编辑：请假设没有线程，但堆栈上的“下游”方法会根据此 b_active_ 标志更改行为。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-16T10:59:23.593

我同意 Adam Pierce 的观点，并且认为您应该更喜欢引用而不是指针：

```
template<typename T>
class restorer {
   T& ref_;
   T save_;
public:
   restorer(T& perm) : ref_(perm), save_(ref_) {};
   ~restorer() { ref_ = save_; }
}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-16T10:19:44.063

我喜欢恢复器模板，但我可能会将模板放在 Unwind 类之外，甚至放在单独的头文件中，以便将来其他类可以重用它。这也会使它更具可读性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T10:14:32.610

我也会这样做。这样，如果函数由于某种原因抛出或提前返回，您的 Restorer 对象将被销毁并且变量重置为原始值。真正的问题是，为什么需要在函数返回时恢复一个变量？对象是否从多个线程中使用？

量子皮特

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-01T04:21:19.933

我根据评论对示例进行了更多修改，并将其作为社区 Wiki 答案而不是编辑问题。

```
/// c++ code sample
#ifndef UTIL_RESTORER_HPP
#define UTIL_RESTORER_HPP

namespace Utility {

/// A Restorer instance ("inst") uses the stack to restore a saved
/// value to the named variable when the instance "inst" goes out of
/// scope.
/// 
/// Restorer is designed to be an auto variable, not allocated on any
/// other memory resource like a heap or in-place.
template<typename T>
class restorer {
  T& ref_;
  T  save_;
public:
  restorer(T& perm) : ref_(perm), save_(perm) {}
  ~restorer() { ref_ = save_; }
};

}//NAMESPACE
#endif//UTIL_RESTORER_HPP 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-08-24T14:36:02.627

请注意这个旧线程的未来读者，而不是这样使用它：

```
 restorer<bool> trust_in_the_stack(&b_active_); 
```

当我使用 C++11 时，我定义了：

```
 #define restorer_macro(var) restorer<decltype(var)> restorer_##named{var}; 
```

所以现在使用如下：

```
 restorer_macro(b_active_); 
```

这避免了知道类型和命名对象，因此它一直持续到范围结束。当然，您可能更喜欢重命名宏“restorer”，然后重命名类，例如“restorer_container”。

# java - 如何在 Eclipse 中使用 Vista 的 SuperFetch？

> ID：207967
> 
> 赞同：2
> 
> 时间：2008-10-16T09:49:27.777
> 
> 标签：java, eclipse, windows-vista

Vista 的 SuperFetch 可以很好地与安装的应用程序一起使用，但它似乎不适用于 Eclipse，它只是复制到一个目录中。

有谁知道如何纠正这个？还是根本不可能？

[我希望这个不会因为“与编程无关”而被关闭，因为我需要在我的机器上使用 Eclipse 进行编程；-)]

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-16T13:28:22.903

由于**[SuperFetch](http://blogs.technet.com/askperf/archive/2007/03/29/windows-vista-superfetch-readyboost.aspx)**分析您启动的应用程序，它应该选择 eclipse.exe 和 - 更重要的是 - 由 eclipse.exe 创建的底层 javaw.exe 进程

因此，即使按说没有安装而黯然失色，我认为 SuperFetch 至少应该了解 Java 进程的使用。

您是否在[%SystemRoot%\Prefetch 目录](http://readerszone.com/operating-system/windows/windows-vista-windows-operating-system/superfetch-performance-enhancing-features-in-windows-vista.html)中看到 javaw （不应为空[或清空](http://www.edbott.com/weblog/archives/000024.html)）？

# 3d - 如何从平面相交的 3D 几何图形中提取 2D 切片？

> ID：207971
> 
> 赞同：2
> 
> 时间：2008-10-16T09:51:25.043
> 
> 标签：3d, geometry, 2d, geometry-slice

最近，我们的团队面临着在平面和一些 3D 几何体（三角形集）之间构建 2D 切片的任务。谷歌并没有像我们希望的那样有帮助，所以我们把注意力转向这里，看看是否有人遇到过这个问题并提供可能的解决方案。也需要链接。

找到交点本身并不是一项艰巨的任务，但确保正确生成三角形并使用正确的角构成是与我们一起玩艰难的游戏。我们只是缺乏从任意模型构建三角形的数学/理解。

如果您在理解我们正在尝试做的事情时遇到问题，请想象一下这种情况：

将兔子模型加载到程序中。接下来，“激光”穿过太空，将兔子切成两半。激光切割的那个薄片就是我们想要生成的切片。它应该是一个二维三角形集。如果激光不适合你（没有双关语），想想刀，飞机，任何能在飞机上切东西的东西。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-13T00:22:03.173

如果您未绑定任何特定软件，请在 ParaView (paraview.org) 或 ParaViewGeo (paraviewgeo.mirarco.org) 中打开您的数据集。

两者都有一个名为 Slice 的过滤器，它完全符合您的要求，并且都允许您将数据保存回来。

ParaViewGeo 支持勘探/采矿/地质行业常用的数据格式（GoCad、DataMine 等），这是这两款软件之间唯一真正的区别。

这些软件包中还有许多其他可用的过滤器，您可能会觉得有趣，例如剪辑（将您的兔子切成两半并查看其中的一半）和阈值（假设您为兔子的某些部分分配了值，例如区域 id 之类的）耳朵、鼻子、眼睛、脚等，您可以设置“阈值”，以便只留下这些部分以供查看）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T11:08:50.550

我真的不知道你所说的“角落组合”是什么意思，但我想这是为了获得不太尖锐的三角形。

我还想您的问题可以抽象为轮廓的三角剖分？

如果是这样，我相信你可以在网上找到很多方法。

我会尝试的一种方法是：

1.  用点填充轮廓。点的密度应反映轮廓上点的密度。更好的是，当您离开中心时，密度应该会降低。
2.  使用 Delaunay 三角剖分进行三角剖分（[QHull](http://www.qhull.org)提供了高效的实现）

对于第一点，飞镖算法应该可以解决问题，并使用可变密度来优化第二步。这意味着：您投掷“飞镖”以找到您的积分，但如果飞镖最终离它的邻居太近，您将其移除并扔一个新的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-16T12:32:50.490

平面和三角形的交点是线段或什么都不是（忽略三角形正好在平面内的退化情况）。

所以你的激光/刀扫描/切片兔子模型三角形的结果是线段的集合。我不确定您如何/为什么期望得到一个“二维三角形集”。

如果您想获取由这些线段形成的（可能是非凸的）多边形并用三角形“填充”它们，[CGAL 的多边形工具](http://www.cgal.org/Manual/3.3/doc_html/cgal_manual/Partition_2/Chapter_main.html)可能会完成这项工作（我的猜测是该页面上的几张图片是什么就像你想要达到的目标）。

# c++ - 如何轻松地将 C++ 枚举映射到字符串

> ID：207976
> 
> 赞同：132
> 
> 时间：2008-10-16T09:53:27.377
> 
> 标签：c++, templates, enums

我正在使用的一些库头文件中有一堆枚举类型，我想要一种将枚举值转换为用户字符串的方法 - 反之亦然。

RTTI 不会为我这样做，因为“用户字符串”需要比枚举更具可读性。

蛮力解决方案将是一堆这样的函数，但我觉得这有点太像 C 了。

```
enum MyEnum {VAL1, VAL2,VAL3};

String getStringFromEnum(MyEnum e)
{
  switch e
  {
  case VAL1: return "Value 1";
  case VAL2: return "Value 2";
  case VAL1: return "Value 3";
  default: throw Exception("Bad MyEnum");
  }
} 
```

我有一种直觉，认为有一个使用模板的优雅解决方案，但我还不能完全理解它。

**更新：**感谢您的建议-我应该明确说明枚举是在第三方库标头中定义的，所以我不想更改它们的定义。

我现在的直觉是避免使用模板并执行以下操作：

```
char * MyGetValue(int v, char *tmp); // implementation is trivial

#define ENUM_MAP(type, strings) char * getStringValue(const type &T) \
 { \
 return MyGetValue((int)T, strings); \
 }

; enum eee {AA,BB,CC}; - exists in library header file 
; enum fff {DD,GG,HH}; 

ENUM_MAP(eee,"AA|BB|CC")
ENUM_MAP(fff,"DD|GG|HH")

// To use...

    eee e;
    fff f;
    std::cout<< getStringValue(e);
    std::cout<< getStringValue(f); 
```

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2008-10-16T10:02:47.857

如果您希望将枚举名称本身作为字符串，请参阅[这篇文章](https://stackoverflow.com/questions/201593/is-there-a-simple-script-to-convert-c-enum-to-string#201792)。否则， a`std::map<MyEnum, char const*>`会很好地工作。（将字符串文字复制到地图中的 std::strings 毫无意义）

对于额外的语法糖，这里是如何编写一个 map_init 类。目标是允许

```
std::map<MyEnum, const char*> MyMap;
map_init(MyMap)
    (eValue1, "A")
    (eValue2, "B")
    (eValue3, "C")
; 
```

该函数`template <typename T> map_init(T&)`返回一个`map_init_helper<T>`. `map_init_helper<T>`存储一个 T&，并定义了平凡的`map_init_helper& operator()(typename T::key_type const&, typename T::value_type const&)`. （`*this`从`operator()`允许链接`operator()`，如`operator<<`在`std::ostream`s 上）

```
template<typename T> struct map_init_helper
{
    T& data;
    map_init_helper(T& d) : data(d) {}
    map_init_helper& operator() (typename T::key_type const& key, typename T::mapped_type const& value)
    {
        data[key] = value;
        return *this;
    }
};

template<typename T> map_init_helper<T> map_init(T& item)
{
    return map_init_helper<T>(item);
} 
```

由于函数和助手类是模板化的，因此您可以将它们用于任何地图或类似地图的结构。即它还可以添加条目到[`std::unordered_map`](http://en.cppreference.com/w/cpp/container/unordered_map)

如果您不喜欢编写这些帮助程序，boost::assign 提供了开箱即用的相同功能。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2008-12-04T11:10:55.050

MSalters 解决方案是一个很好的解决方案，但基本上是重新实现`boost::assign::map_list_of`. 如果你有boost，可以直接使用：

```
#include <boost/assign/list_of.hpp>
#include <boost/unordered_map.hpp>
#include <iostream>

using boost::assign::map_list_of;

enum eee { AA,BB,CC };

const boost::unordered_map<eee,const char*> eeeToString = map_list_of
    (AA, "AA")
    (BB, "BB")
    (CC, "CC");

int main()
{
    std::cout << " enum AA = " << eeeToString.at(AA) << std::endl;
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2008-10-16T09:57:18.150

从另一种形式自动生成一种形式。

资源：

```
enum {
  VALUE1, /* value 1 */
  VALUE2, /* value 2 */
}; 
```

生成：

```
const char* enum2str[] = {
  "value 1", /* VALUE1 */
  "value 2", /* VALUE2 */
}; 
```

如果枚举值很大，则生成的表单可以使用 unordered_map<> 或康斯坦丁建议的模板。

资源：

```
enum State{
  state0 = 0, /* state 0 */
  state1 = 1, /* state 1 */
  state2 = 2, /* state 2 */
  state3 = 4, /* state 3 */

  state16 = 0x10000, /* state 16 */
}; 
```

生成：

```
template <State n> struct enum2str { static const char * const value; };
template <State n> const char * const enum2str<n>::value = "error";

template <> struct enum2str<state0> { static const char * const value; };
const char * const enum2str<state0>::value = "state 0"; 
```

例子：

```
#include <iostream>

int main()
{
  std::cout << enum2str<state16>::value << std::endl;
  return 0;
} 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-11-26T14:32:38.747

我建议混合使用[X-macros 是最好的解决方案](https://stackoverflow.com/questions/201593/is-there-a-simple-script-to-convert-c-enum-to-string#201792)和以下模板函数：

借用[marcinkoziukmyopenidcom](https://stackoverflow.com/users/27909/marcinkoziukmyopenidcom)和扩展

```
enum Colours {
#   define X(a) a,
#   include "colours.def"
#   undef X
    ColoursCount
};

char const* const colours_str[] = {
#   define X(a) #a,
#   include "colours.def"
#   undef X
    0
};

template <class T> T str2enum( const char* );
template <class T> const char* enum2str( T );

#define STR2ENUM(TYPE,ARRAY) \
template <> \
TYPE str2enum<TYPE>( const char* str ) \
    { \
    for( int i = 0; i < (sizeof(ARRAY)/sizeof(ARRAY[0])); i++ ) \
        if( !strcmp( ARRAY[i], str ) ) \
            return TYPE(i); \
    return TYPE(0); \
    }

#define ENUM2STR(TYPE,ARRAY) \
template <> \
const char* enum2str<TYPE>( TYPE v ) \
    { \
    return ARRAY[v]; \
    }

#define ENUMANDSTR(TYPE,ARRAY)\
    STR2ENUM(TYPE,ARRAY) \
    ENUM2STR(TYPE,ARRAY)

ENUMANDSTR(Colours,colours_str) 
```

颜色.def

```
X(Red)
X(Green)
X(Blue)
X(Cyan)
X(Yellow)
X(Magenta) 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2014-05-01T08:20:01.813

我记得在 StackOverflow 上的其他地方回答过这个问题。在这里重复一遍。基本上它是一个基于可变参数宏的解决方案，并且非常易于使用：

```
#define AWESOME_MAKE_ENUM(name, ...) enum class name { __VA_ARGS__, __COUNT}; \
inline std::ostream& operator<<(std::ostream& os, name value) { \
std::string enumName = #name; \
std::string str = #__VA_ARGS__; \
int len = str.length(); \
std::vector<std::string> strings; \
std::ostringstream temp; \
for(int i = 0; i < len; i ++) { \
if(isspace(str[i])) continue; \
        else if(str[i] == ',') { \
        strings.push_back(temp.str()); \
        temp.str(std::string());\
        } \
        else temp<< str[i]; \
} \
strings.push_back(temp.str()); \
os << enumName << "::" << strings[static_cast<int>(value)]; \
return os;} 
```

要在您的代码中使用它，只需执行以下操作：

```
AWESOME_MAKE_ENUM(Animal,
    DOG,
    CAT,
    HORSE
);
auto dog = Animal::DOG;
std::cout<<dog; 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-04-10T12:36:45.927

我使用我在下面复制的[这个解决方案：](https://stackoverflow.com/a/29561365/4622991)

```
#define MACROSTR(k) #k

#define X_NUMBERS \
       X(kZero  ) \
       X(kOne   ) \
       X(kTwo   ) \
       X(kThree ) \
       X(kFour  ) \
       X(kMax   )

enum {
#define X(Enum)       Enum,
    X_NUMBERS
#undef X
} kConst;

static char *kConstStr[] = {
#define X(String) MACROSTR(String),
    X_NUMBERS
#undef X
};

int main(void)
{
    int k;
    printf("Hello World!\n\n");

    for (k = 0; k < kMax; k++)
    {
        printf("%s\n", kConstStr[k]);
    }

    return 0;
} 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2019-02-03T15:55:05.647

我花了更多时间研究这个我想承认的话题。幸运的是，有很多很棒的开源解决方案。

这是两种很棒的方法，即使（还）不够广为人知，

[**wise_enum**](https://github.com/quicknir/wise_enum)

*   用于 C++11/14/17 的独立智能枚举库。它支持您期望从 C++ 中的智能枚举类中获得的所有标准功能。
*   限制：至少需要 C++11。

[**更好的枚举**](https://github.com/aantron/better-enums)

*   具有简洁语法的反射式编译时枚举库，位于单个头文件中，并且没有依赖项。
*   限制：基于宏，不能在类中使用。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-10-16T10:00:41.467

如果您想获取`MyEnum` *variables*的字符串表示形式，那么模板不会削减它。模板可以专门用于编译时已知的整数值。

但是，如果这是您想要的，请尝试：

```
#include <iostream>

enum MyEnum { VAL1, VAL2 };

template<MyEnum n> struct StrMyEnum {
    static char const* name() { return "Unknown"; }
};

#define STRENUM(val, str) \
  template<> struct StrMyEnum<val> { \
    static char const* name() { return str; }};

STRENUM(VAL1, "Value 1");
STRENUM(VAL2, "Value 2");

int main() {
  std::cout << StrMyEnum<VAL2>::name();
} 
```

这很冗长，但会捕获与您所提出的错误类似的错误-您的错误`case VAL1`是重复的。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2020-02-11T12:59:24.620

我知道我迟到了，但对于所有来访问这个页面的人来说，你可以试试这个，它比那里的所有东西都容易，而且更有意义：

```
namespace texs {
    typedef std::string Type;
    Type apple = "apple";
    Type wood = "wood";
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-03-20T23:40:14.630

我多次需要此功能来调试/分析其他人的代码。为此，我编写了一个 Perl 脚本，它生成一个具有多个重载`toString`方法的类。每个`toString`方法都接受一个`Enum`作为参数并返回`const char*`。

当然，脚本本身并不解析 C++ 中的枚举，而是使用 ctags 生成符号表。

Perl 脚本在这里： [http ://heinitz-it.de/download/enum2string/enum2string.pl.html](http://heinitz-it.de/download/enum2string/enum2string.pl.html)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-10-16T10:02:19.700

我很想拥有一张地图 m - 并将其嵌入到枚举中。

设置 m[MyEnum.VAL1] = "Value 1";

一切都完成了。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2014-03-07T16:22:26.557

这是仅使用一行宏命令自动获取枚举上的 << 和 >> 流运算符的尝试...

定义：

```
#include <string>
#include <iostream>
#include <stdexcept>
#include <algorithm>
#include <iterator>
#include <sstream>
#include <vector>

#define MAKE_STRING(str, ...) #str, MAKE_STRING1_(__VA_ARGS__)
#define MAKE_STRING1_(str, ...) #str, MAKE_STRING2_(__VA_ARGS__)
#define MAKE_STRING2_(str, ...) #str, MAKE_STRING3_(__VA_ARGS__)
#define MAKE_STRING3_(str, ...) #str, MAKE_STRING4_(__VA_ARGS__)
#define MAKE_STRING4_(str, ...) #str, MAKE_STRING5_(__VA_ARGS__)
#define MAKE_STRING5_(str, ...) #str, MAKE_STRING6_(__VA_ARGS__)
#define MAKE_STRING6_(str, ...) #str, MAKE_STRING7_(__VA_ARGS__)
#define MAKE_STRING7_(str, ...) #str, MAKE_STRING8_(__VA_ARGS__)
#define MAKE_STRING8_(str, ...) #str, MAKE_STRING9_(__VA_ARGS__)
#define MAKE_STRING9_(str, ...) #str, MAKE_STRING10_(__VA_ARGS__)
#define MAKE_STRING10_(str) #str

#define MAKE_ENUM(name, ...) MAKE_ENUM_(, name, __VA_ARGS__)
#define MAKE_CLASS_ENUM(name, ...) MAKE_ENUM_(friend, name, __VA_ARGS__)

#define MAKE_ENUM_(attribute, name, ...) name { __VA_ARGS__ }; \
    attribute std::istream& operator>>(std::istream& is, name& e) { \
        const char* name##Str[] = { MAKE_STRING(__VA_ARGS__) }; \
        std::string str; \
        std::istream& r = is >> str; \
        const size_t len = sizeof(name##Str)/sizeof(name##Str[0]); \
        const std::vector<std::string> enumStr(name##Str, name##Str + len); \
        const std::vector<std::string>::const_iterator it = std::find(enumStr.begin(), enumStr.end(), str); \
        if (it != enumStr.end())\
            e = name(it - enumStr.begin()); \
        else \
            throw std::runtime_error("Value \"" + str + "\" is not part of enum "#name); \
        return r; \
    }; \
    attribute std::ostream& operator<<(std::ostream& os, const name& e) { \
        const char* name##Str[] = { MAKE_STRING(__VA_ARGS__) }; \
        return (os << name##Str[e]); \
    } 
```

用法：

```
// Declare global enum
enum MAKE_ENUM(Test3, Item13, Item23, Item33, Itdsdgem43);

class Essai {
public:
    // Declare enum inside class
    enum MAKE_CLASS_ENUM(Test, Item1, Item2, Item3, Itdsdgem4);

};

int main() {
    std::cout << Essai::Item1 << std::endl;

    Essai::Test ddd = Essai::Item1;
    std::cout << ddd << std::endl;

    std::istringstream strm("Item2");
    strm >> ddd;

    std::cout << (int) ddd << std::endl;
    std::cout << ddd << std::endl;
} 
```

虽然不确定这个方案的局限性......欢迎评论！

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2013-11-22T00:05:57.877

您的回答启发了我自己编写一些宏。我的要求如下：

1.  仅将枚举的每个值写入一次，因此无需维护双重列表

2.  不要将枚举值保存在稍后#included 的单独文件中，这样我就可以将它写在我想要的任何地方

3.  不要替换枚举本身，我仍然希望定义枚举类型，但除此之外，我希望能够将每个枚举名称映射到相应的字符串（不影响遗留代码）

4.  对于那些巨大的枚举，搜索应该很快，所以最好不要使用 switch-case

这段代码创建了一个带有一些值的经典枚举。此外，它创建为 std::map ，它将每个枚举值映射到它的名称（即 map[E_SUNDAY] = "E_SUNDAY" 等）

好的，现在是代码：

*EnumUtilsImpl.h*：

```
map<int, string> & operator , (map<int, string> & dest, 
                               const pair<int, string> & keyValue) {
    dest[keyValue.first] = keyValue.second; 
    return dest;
}

#define ADD_TO_MAP(name, value) pair<int, string>(name, #name) 
```

*EnumUtils.h* // 这是您在需要执行此操作时要包含的文件，您将使用其中的宏：

```
#include "EnumUtilsImpl.h"
#define ADD_TO_ENUM(name, value) \
    name value

#define MAKE_ENUM_MAP_GLOBAL(values, mapName) \
    int __makeMap##mapName() {mapName, values(ADD_TO_MAP); return 0;}  \
    int __makeMapTmp##mapName = __makeMap##mapName();

#define MAKE_ENUM_MAP(values, mapName) \
    mapName, values(ADD_TO_MAP); 
```

*MyProjectCodeFile.h* // 这是一个如何使用它来创建自定义枚举的示例：

```
#include "EnumUtils.h*

#define MyEnumValues(ADD) \
    ADD(val1, ), \
    ADD(val2, ), \
    ADD(val3, = 100), \
    ADD(val4, )

enum MyEnum {
    MyEnumValues(ADD_TO_ENUM)
};

map<int, string> MyEnumStrings;
// this is how you initialize it outside any function
MAKE_ENUM_MAP_GLOBAL(MyEnumValues, MyEnumStrings); 

void MyInitializationMethod()
{ 
    // or you can initialize it inside one of your functions/methods
    MAKE_ENUM_MAP(MyEnumValues, MyEnumStrings); 
} 
```

干杯。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2020-08-05T12:29:06.380

通过使用指定的数组初始值设定项，您的字符串数组独立于枚举中元素的顺序：

```
enum Values {
    Val1,
    Val2
};

constexpr string_view v_name[] = {
    [Val1] = "Value 1",
    [Val2] = "Value 2"
} 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-10-16T10:00:09.003

在标题中：

```
enum EFooOptions
 {
FooOptionsA = 0, EFooOptionsMin = 0,
FooOptionsB,
FooOptionsC,
FooOptionsD 
EFooOptionsMax
};
extern const wchar* FOO_OPTIONS[EFooOptionsMax]; 
```

在 .cpp 文件中：

```
const wchar* FOO_OPTIONS[] = {
    L"One",
    L"Two",
    L"Three",
    L"Four"
}; 
```

警告：不要处理错误的数组索引。:) 但是您可以在从数组中获取字符串之前轻松添加一个函数来验证枚举。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2014-09-24T10:33:01.763

```
typedef enum {
    ERR_CODE_OK = 0,
    ERR_CODE_SNAP,

    ERR_CODE_NUM
} ERR_CODE;

const char* g_err_msg[ERR_CODE_NUM] = {
    /* ERR_CODE_OK   */ "OK",
    /* ERR_CODE_SNAP */ "Oh, snap!",
}; 
```

以上是我的简单解决方案。它的一个好处是控制消息数组大小的“NUM”，它还可以防止越界访问（如果您明智地使用它）。

您还可以定义一个函数来获取字符串：

```
const char* get_err_msg(ERR_CODE code) {
    return g_err_msg[code];
} 
```

在我的解决方案之外，我发现以下一个非常有趣。它通常解决了上述同步问题。

幻灯片在这里： [http ://www.slideshare.net/arunksaha/touchless-enum-tostring-28684724](http://www.slideshare.net/arunksaha/touchless-enum-tostring-28684724)

此处代码： [https ://github.com/arunksaha/enum_to_string](https://github.com/arunksaha/enum_to_string)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2012-09-14T09:52:16.167

我只是想用宏展示这个可能的优雅解决方案。这并不能解决问题，但我认为这是重新思考问题的好方法。

```
#define MY_LIST(X) X(value1), X(value2), X(value3)

enum eMyEnum
    {
    MY_LIST(PLAIN)
    };

const char *szMyEnum[] =
    {
    MY_LIST(STRINGY)
    };

int main(int argc, char *argv[])
{

std::cout << szMyEnum[value1] << value1 <<" " <<  szMyEnum[value2] << value2 << std::endl;

return 0;
} 
```

- - 编辑 - -

经过一些互联网研究和一些自己的实验后，我得出了以下解决方案：

```
//this is the enum definition
#define COLOR_LIST(X) \
  X( RED    ,=21)      \
  X( GREEN  )      \
  X( BLUE   )      \
  X( PURPLE , =242)      \
  X( ORANGE )      \
  X( YELLOW )

//these are the macros
#define enumfunc(enums,value) enums,
#define enumfunc2(enums,value) enums value,
#define ENUM2SWITCHCASE(enums) case(enums): return #enums;

#define AUTOENUM(enumname,listname) enum enumname{listname(enumfunc2)};
#define ENUM2STRTABLE(funname,listname) char* funname(int val) {switch(val) {listname(ENUM2SWITCHCASE) default: return "undef";}}
#define ENUM2STRUCTINFO(spacename,listname) namespace spacename { int values[] = {listname(enumfunc)};int N = sizeof(values)/sizeof(int);ENUM2STRTABLE(enum2str,listname)};

//here the enum and the string enum map table are generated
AUTOENUM(testenum,COLOR_LIST)
ENUM2STRTABLE(testfunenum,COLOR_LIST)
ENUM2STRUCTINFO(colorinfo,COLOR_LIST)//colorinfo structur {int values[]; int N; char * enum2str(int);}

//debug macros
#define str(a) #a
#define xstr(a) str(a)

int main( int argc, char** argv )
{
testenum x = YELLOW;
std::cout << testfunenum(GREEN) << "   " << testfunenum(PURPLE) << PURPLE << "  " << testfunenum(x);

for (int i=0;i< colorinfo::N;i++)
std::cout << std::endl << colorinfo::values[i] <<  "  "<< colorinfo::enum2str(colorinfo::values[i]);

  return EXIT_SUCCESS;
} 
```

我只是想发布它，也许有人会发现这个解决方案很有用。不需要模板类，不需要 c++11，也不需要 boost，所以这也可以用于简单的 C。

---- EDIT2 ----

当使用超过 2 个枚举时，信息表会产生一些问题（编译器问题）。以下解决方法有效：

```
#define ENUM2STRUCTINFO(spacename,listname) namespace spacename { int spacename##_##values[] = {listname(enumfunc)};int spacename##_##N = sizeof(spacename##_##values)/sizeof(int);ENUM2STRTABLE(spacename##_##enum2str,listname)}; 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2021-06-02T19:37:00.480

```
#include <vector>
#include <string>

//Split one comma-separated value string to vector
std::vector<std::string> split(std::string csv, char separator){/*trivial*/}

//Initializer
#define ENUMIFY(name, ...)                                                                               \
  struct name                                                                                             \
  {                                                                                                       \
    enum Enum                                                                                       \
    {                                                                                                     \
      __VA_ARGS__                                                                                         \
    };                                                                                                    \
    static const std::vector<std::string>& Names()                                                        \
    {                                                                                                     \
      const static std::vector<std::string> _{split(#__VA_ARGS__, ',')}; \
      return _;                                                                                           \
    };                                                                                                    \
  }; 
```

宣言：

```
ENUMIFY(States, INIT, ON, OFF, RUNNING) 
```

然后所有枚举都可用，加上它们的字符串被矢量化：

```
std::string enum_str = States::Names()[States::ON]; 
```

另一种选择是直接使用静态向量而不使用函数包装器。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-06-08T19:35:19.637

看看以下语法是否适合您：

```
// WeekEnd enumeration
enum WeekEnd
{
    Sunday = 1,
    Saturday = 7
};

// String support for WeekEnd
Begin_Enum_String( WeekEnd )
{
    Enum_String( Sunday );
    Enum_String( Saturday );
}
End_Enum_String;

// Convert from WeekEnd to string
const std::string &str = EnumString<WeekEnd>::From( Saturday );
// str should now be "Saturday"

// Convert from string to WeekEnd
WeekEnd w;
EnumString<WeekEnd>::To( w, "Sunday" );
// w should now be Sunday 
```

如果是这样，那么您可能想查看这篇文章：
[http ://www.gamedev.net/reference/snippets/features/cppstringizing/](http://www.gamedev.net/reference/snippets/features/cppstringizing/)

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-11-26T13:41:10.987

我最近在供应商库（Fincad）上遇到了同样的问题。幸运的是，供应商为所有枚举提供了 xml 文档。我最终为每个枚举类型生成了一个映射，并为每个枚举提供了一个查找函数。此技术还允许您拦截枚举范围之外的查找。

我确信 swig 可以为您做类似的事情，但我很高兴提供用 ruby​​ 编写的代码生成工具。

这是代码示例：

```
std::map<std::string, switches::FCSW2::type> init_FCSW2_map() {
        std::map<std::string, switches::FCSW2::type> ans;
        ans["Act365Fixed"] = FCSW2::Act365Fixed;
        ans["actual/365 (fixed)"] = FCSW2::Act365Fixed;
        ans["Act360"] = FCSW2::Act360;
        ans["actual/360"] = FCSW2::Act360;
        ans["Act365Act"] = FCSW2::Act365Act;
        ans["actual/365 (actual)"] = FCSW2::Act365Act;
        ans["ISDA30360"] = FCSW2::ISDA30360;
        ans["30/360 (ISDA)"] = FCSW2::ISDA30360;
        ans["ISMA30E360"] = FCSW2::ISMA30E360;
        ans["30E/360 (30/360 ISMA)"] = FCSW2::ISMA30E360;
        return ans;
}
switches::FCSW2::type FCSW2_lookup(const char* fincad_switch) {
        static std::map<std::string, switches::FCSW2::type> switch_map = init_FCSW2_map();
        std::map<std::string, switches::FCSW2::type>::iterator it = switch_map.find(fincad_switch);
        if(it != switch_map.end()) {
                return it->second;
        } else {
                throw FCSwitchLookupError("Bad Match: FCSW2");
        }
} 
```

似乎您想采用另一种方式（枚举到字符串，而不是字符串到枚举），但这应该是微不足道的。

-惠特

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-10-09T09:23:57.670

那么相当可移植的 Enum 类实现呢？
*为了便于理解，它没有进行太多优化。*

```
#define FOREACH_FRUIT(item) \
        item(apple)   \
        item(orange)  \
        item(grape, 5)   \
        item(banana)  \ 
```

无需重复或更新定义副本。

```
class EnumClass
{
#define GENERATE_ENUM(ENUM, ...) ENUM,
#define GENERATE_STRINGS(STRING, ...) { #STRING, ##__VA_ARGS__ },
#define GENERATE_SIZE(...) + 1
public:
    enum Enum {
        FOREACH_FRUIT(GENERATE_ENUM) // apple, orange, grape, banana,
    } _;
    EnumClass(Enum init)
    {
        _ = init; // grape(2)
        _EnumItem build[itemsNo] = { FOREACH_FRUIT(GENERATE_STRINGS) }; // _EnumItem build[itemsNo] = { { "apple"  }, { "orange"  }, { "grape",5 }, { "banana"  }, };
        int pos = 0;
        for (int i = 0; i < itemsNo; i++)
        {
            items[i].Name = build[i].Name;
            if (0 == build[i].No) {
                items[i].No = pos;
                for (int j = i; j--;)
                {
                    if (items[j].No == pos)
                        throw "Existing item # !";
                }
                pos++;
            }
            else {
                int destPos = build[i].No;
                if (destPos < pos) {
                    for (int j = 0; j < i; j++)
                    {
                        if (items[j].No == destPos)
                            throw "Existing item # !";
                    }
                }
                items[i].No = destPos;
                pos = destPos + 1;
            }
        }
    }
    operator int()
    {
        return items[_].No;
    }
    operator char*()
    {
        return items[_].Name;
    }
    EnumClass& operator ++(int)
    {
        if (_ == itemsNo - 1) {
            throw "Out of Enum options !";
        }
        _ = static_cast<EnumClass::Enum>(_ + 1);
        return *this;
    }
    EnumClass& operator --(int)
    {
        if (0 == _) {
            throw "Out of Enum options !";
        }
        _ = static_cast<EnumClass::Enum>(_ - 1);
        return *this;
    }
    EnumClass operator =(int right)
    {
        for (int i = 0; i < itemsNo; i++)
        {
            if (items[i].No == right)
            {
                _ = static_cast<EnumClass::Enum>(i);
                return *this;
            }
        }
        throw "Enum option does not exist !";
    }
    EnumClass operator =(char *right)
    {
        for (int i = 0; i < itemsNo; i++)
        {
            if (!strcmp(items[i].Name, right))
            {
                _ = static_cast<EnumClass::Enum>(i);
                return *this;
            }
        }
        throw "Enum option does not exist !";
    }
protected:
    static const int itemsNo = FOREACH_FRUIT(GENERATE_SIZE); // + 1 + 1 + 1 + 1; 
    struct _EnumItem {
        char *Name;
        int No;
    } items[itemsNo]; // { Name = "apple" No = 0 }, { Name = "orange" No = 1 } ,{ Name = "grape" No = 5 } ,{ Name = "banana" No = 6 }

#undef GENERATE_ENUM
#undef GENERATE_STRINGS
#undef GENERATE_SIZE
}; 
```

现在您可以执行任何常见操作 + 检查定义和运行时操作：

```
int main()
{
    EnumClass ec(EnumClass::grape);
    ec = "banana"; // ec {_=banana (3)...}
    ec--; // ec {_=grape (2)...}
    char *name = ec;
    int val = ec; // 5
    printf("%s(%i)", name, val); // grape(5)
    return 0;
} 
```

printf 问题...“[从技术上讲，编译器不知道需要哪种类型。](https://stackoverflow.com/questions/34064593/what-operator-to-overload-when-class-is-passed-as-argument-to-printf) ”

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2019-08-23T01:47:05.547

这个正确的旧混乱是我基于 SO 的点点滴滴的努力。for_each 必须扩展以支持超过 20 个枚举值。在 Visual Studio 2019、clang 和 gcc 上对其进行了测试。c++11

```
#define _enum_expand(arg) arg
#define _enum_select_for_each(_,_0, _1, _2,_3,_4, _5, _6,_7,_8,_9,_10,_11,_12,_13,_14,_15,_16,_17,_18,_19,N, ...) N
#define _enum_for_each_0(_call, arg0,arg1,...)
#define _enum_for_each_1(_call, arg0,arg1) _call(arg0,arg1)
#define _enum_for_each_2(_call, arg0,arg1, ...) _call(arg0,arg1)  _enum_expand(_enum_for_each_1(_call,arg0, __VA_ARGS__))
#define _enum_for_each_3(_call, arg0,arg1, ...) _call(arg0,arg1)  _enum_expand(_enum_for_each_2(_call,arg0, __VA_ARGS__))
#define _enum_for_each_4(_call, arg0,arg1, ...) _call(arg0,arg1)  _enum_expand(_enum_for_each_3(_call,arg0, __VA_ARGS__))
#define _enum_for_each_5(_call, arg0,arg1, ...) _call(arg0,arg1)  _enum_expand(_enum_for_each_4(_call,arg0, __VA_ARGS__))
#define _enum_for_each_6(_call, arg0,arg1, ...) _call(arg0,arg1)  _enum_expand(_enum_for_each_5(_call,arg0, __VA_ARGS__))
#define _enum_for_each_7(_call, arg0,arg1, ...) _call(arg0,arg1)  _enum_expand(_enum_for_each_6(_call,arg0, __VA_ARGS__))
#define _enum_for_each_8(_call, arg0,arg1, ...) _call(arg0,arg1)  _enum_expand(_enum_for_each_7(_call,arg0, __VA_ARGS__))
#define _enum_for_each_9(_call, arg0,arg1, ...) _call(arg0,arg1)  _enum_expand(_enum_for_each_8(_call,arg0, __VA_ARGS__))
#define _enum_for_each_10(_call, arg0,arg1, ...) _call(arg0,arg1) _enum_expand(_enum_for_each_9(_call,arg0, __VA_ARGS__))
#define _enum_for_each_11(_call, arg0,arg1, ...) _call(arg0,arg1) _enum_expand(_enum_for_each_10(_call,arg0, __VA_ARGS__))
#define _enum_for_each_12(_call, arg0,arg1, ...) _call(arg0,arg1) _enum_expand(_enum_for_each_11(_call,arg0, __VA_ARGS__))
#define _enum_for_each_13(_call, arg0,arg1, ...) _call(arg0,arg1) _enum_expand(_enum_for_each_12(_call,arg0, __VA_ARGS__))
#define _enum_for_each_14(_call, arg0,arg1, ...) _call(arg0,arg1) _enum_expand(_enum_for_each_13(_call,arg0, __VA_ARGS__))
#define _enum_for_each_15(_call, arg0,arg1, ...) _call(arg0,arg1) _enum_expand(_enum_for_each_14(_call,arg0, __VA_ARGS__))
#define _enum_for_each_16(_call, arg0,arg1, ...) _call(arg0,arg1) _enum_expand(_enum_for_each_15(_call,arg0, __VA_ARGS__))
#define _enum_for_each_17(_call, arg0,arg1, ...) _call(arg0,arg1) _enum_expand(_enum_for_each_16(_call,arg0, __VA_ARGS__))
#define _enum_for_each_18(_call, arg0,arg1, ...) _call(arg0,arg1) _enum_expand(_enum_for_each_17(_call,arg0, __VA_ARGS__))
#define _enum_for_each_19(_call, arg0,arg1, ...) _call(arg) _enum_expand(_enum_for_each_18(_call,arg0, __VA_ARGS__))
#define _enum_for_each(arg, ...) \
    _enum_expand(_enum_select_for_each(_, ##__VA_ARGS__, \
    _enum_for_each_19, _enum_for_each_18, _enum_for_each_17, _enum_for_each_16, _enum_for_each_15, \
    _enum_for_each_14, _enum_for_each_13, _enum_for_each_12, _enum_for_each_11, _enum_for_each_10, \
    _enum_for_each_9,  _enum_for_each_8,  _enum_for_each_7,  _enum_for_each_6,  _enum_for_each_5,  \
    _enum_for_each_4,  _enum_for_each_3,  _enum_for_each_2,  _enum_for_each_1,  _enum_for_each_0)(arg, ##__VA_ARGS__))

#define _enum_strip_args_1(arg0) arg0
#define _enum_strip_args_2(arg0, arg1) arg0, arg1
#define _enum_make_args(...) (__VA_ARGS__)

#define _enum_elem_arity1_1(arg) arg,
#define _enum_elem_arity1( ...) _enum_expand(_enum_elem_arity1_1 __VA_ARGS__)
#define _enum_elem_arity2_1(arg0,arg1) arg0 = arg1,
#define _enum_elem_arity2( ...) _enum_expand(_enum_elem_arity2_1 __VA_ARGS__)

#define _enum_elem_select_arity_2(_0, _1, NAME,...) NAME
#define _enum_elem_select_arity_1(...) _enum_expand(_enum_elem_select_arity_2(__VA_ARGS__, _enum_elem_arity2,_enum_elem_arity1,_))
#define _enum_elem_select_arity(enum_type,...) _enum_expand(_enum_elem_select_arity_1 __VA_ARGS__)(__VA_ARGS__)

#define _enum_str_arity1_1(enum_type,arg) { enum_type::arg,#arg },
#define _enum_str_arity1(enum_type,...) _enum_expand(_enum_str_arity1_1 _enum_make_args( enum_type, _enum_expand(_enum_strip_args_1 __VA_ARGS__)))
#define _enum_str_arity2_1(enum_type,arg,value) { enum_type::arg,#arg },
#define _enum_str_arity2(enum_type, ...) _enum_expand(_enum_str_arity2_1 _enum_make_args( enum_type, _enum_expand(_enum_strip_args_2 __VA_ARGS__)))
#define _enum_str_select_arity_2(_0, _1, NAME,...) NAME
#define _enum_str_select_arity_1(...) _enum_expand(_enum_str_select_arity_2(__VA_ARGS__, _enum_str_arity2,_enum_str_arity1,_))
#define _enum_str_select_arity(enum_type,...) _enum_expand(_enum_str_select_arity_1 __VA_ARGS__)(enum_type,__VA_ARGS__)

#define error_code_enum(enum_type,...)  enum class enum_type {              \
    _enum_expand(_enum_for_each(_enum_elem_select_arity,enum_type, ##__VA_ARGS__))};  \
    namespace _ ## enum_type ## _detail { \
        template <typename> struct _ ## enum_type ## _error_code{ \
            static const std::map<enum_type, const char*> enum_type ## _map; \
        }; \
            template <typename T> \
            const std::map<enum_type, const char*> _ ## enum_type ## _error_code<T>::enum_type ## _map = { \
                _enum_expand(_enum_for_each(_enum_str_select_arity,enum_type,  ##__VA_ARGS__)) \
        }; \
    } \
    inline const char* get_error_code_name(const enum_type& value) { \
        return _ ## enum_type ## _detail::_ ## enum_type ## _error_code<enum_type>::enum_type ## _map.find(value)->second; \
    } 

error_code_enum(myenum,
    (one, 1),
    (two)
); 
```

产生以下代码

```
enum class myenum { 
    one = 1,
    two,
};
namespace _myenum_detail {
    template <typename>
    struct _myenum_error_code {
        static const std::map<myenum, const char*> myenum_map;
    };
    template <typename T>
    const std::map<myenum, const char*> _myenum_error_code<T>::myenum_map = {
        { myenum::one, "one" }, 
        { myenum::two, "two" },
    };
}
inline const char* get_error_code_name(const myenum& value) { 
    return _myenum_detail::_myenum_error_code<myenum>::myenum_map.find(value)->second; 
} 
```

真是太可惜了，你不得不用预处理器跳起来，用世界上最常用的编程语言之一来做这件事……

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2021-11-09T11:39:02.337

这是我的解决方案，我参考了其他一些设计，但我的更完整和使用更简单。

```
// file: enum_with_string.h
#pragma once

#include <map>
#include <string>
#include <vector>

namespace EnumString {

template <typename T>
static inline void split_string_for_each(const std::string &str,
                                         const std::string &delimiter,
                                         const T &foreach_function,
                                         ssize_t max_number = -1) {
  ssize_t num = 0;
  std::string::size_type start;
  std::string::size_type end = -1;
  while (true) {
    start = str.find_first_not_of(delimiter, end + 1);
    if (start == std::string::npos) break;  // over

    end = str.find_first_of(delimiter, start + 1);

    if (end == std::string::npos) {
      foreach_function(num, str.substr(start));
      break;
    }
    foreach_function(num, str.substr(start, end - start));
    ++num;

    if (max_number > 0 && num == max_number) break;
  }
}

/**
 * Strip function, delete the specified characters on both sides of the string.
 */
inline std::string &strip(std::string &s,
                          const std::string &characters = " \t\r\n") {
  s.erase(0, s.find_first_not_of(characters));
  return s.erase(s.find_last_not_of(characters) + 1);
}

static inline std::map<int, std::string> ParserEnumDefine(
    const std::string &define_str) {
  int cur_num = 0;
  std::string cur_item_str;
  std::map<int, std::string> result_map;
  split_string_for_each(define_str, ",", [&](int num, const std::string &str) {
    split_string_for_each(
        str, "=",
        [&](int num, const std::string &str) {
          if (num == 0) cur_item_str = str;
          if (num == 1) cur_num = std::stoi(str);
        },
        2);
    result_map.emplace(cur_num, strip(cur_item_str));
    cur_num++;
  });
  return result_map;
}

}  // namespace EnumString

/**
 * Example:
 * @code
 * @endcode
 */
#define ENUM_WITH_STRING(Name, ...)                                     \
  enum class Name { __VA_ARGS__, __COUNT };                             \
  static inline const std::string &to_string(Name value) {              \
    static const auto map = EnumString::ParserEnumDefine(#__VA_ARGS__); \
    static const std::string cannot_converted =                         \
        "Cannot be converted to string";                                \
    int int_value = (int)value;                                         \
    if (map.count(int_value))                                           \
      return map.at(int_value);                                         \
    else                                                                \
      return cannot_converted;                                          \
  } 
```

你可以像这样使用它：

```
#include <iostream>
#include "enum_with_string.h"
ENUM_WITH_STRING(Animal, dog, cat, monkey = 50, fish, human = 100, duck)
int main() {
  std::cout << to_string(Animal::dog) << std::endl;
  std::cout << to_string(Animal::cat) << std::endl;
  std::cout << to_string(Animal::monkey) << std::endl;
  std::cout << to_string(Animal::fish) << std::endl;
  std::cout << to_string(Animal::human) << std::endl;
  std::cout << to_string(Animal::duck) << std::endl;
} 
```

我有一个[github 要点](https://gist.github.com/ShawnFeng0/722d5307341d4b669f02cf08a4bf51c0)。

# python - 如何启用 MySQL 客户端自动重新连接 MySQLdb？

> ID：207981
> 
> 赞同：42
> 
> 时间：2008-10-16T09:56:05.827
> 
> 标签：python, mysql

我遇到了 PHP 的做法：

```
my_bool reconnect = 1;
mysql_options(&mysql, MYSQL_OPT_RECONNECT, &reconnect); 
```

但是 MySQLdb (python-mysql) 没有运气。

有人可以提供线索吗？谢谢。

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2009-06-11T18:38:11.413

我通过创建一个包装该`cursor.execute()`方法的函数解决了这个问题，因为这就是引发`MySQLdb.OperationalError`异常的原因。上面的另一个示例暗示它是`conn.cursor()`引发此异常的方法。

```
import MySQLdb

class DB:
  conn = None

  def connect(self):
    self.conn = MySQLdb.connect()

  def query(self, sql):
    try:
      cursor = self.conn.cursor()
      cursor.execute(sql)
    except (AttributeError, MySQLdb.OperationalError):
      self.connect()
      cursor = self.conn.cursor()
      cursor.execute(sql)
    return cursor

db = DB()
sql = "SELECT * FROM foo"
cur = db.query(sql)
# wait a long time for the Mysql connection to timeout
cur = db.query(sql)
# still works 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2015-03-29T15:48:28.950

我对提议的解决方案有疑问，因为它没有捕获异常。我不确定为什么。

`ping(True)`我用我认为更简洁的语句解决了这个问题：

```
import MySQLdb
con=MySQLdb.Connect()
con.ping(True)
cur=con.cursor() 
```

从这里得到它：http: [//www.neotitans.com/resources/python/mysql-python-connection-error-2006.html](http://www.neotitans.com/resources/python/mysql-python-connection-error-2006.html)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-16T20:11:18.427

如果您使用的是 ubuntu Linux，则在 python-mysql 包中添加了一个补丁，该补丁增加了设置相同 MYSQL_OPT_RECONNECT 选项的能力（请参见[此处](https://launchpad.net/ubuntu/hardy/+source/python-mysqldb/1.2.2-5)）。我还没有尝试过。

[不幸的是，由于与自动连接和转换（此处](https://launchpad.net/ubuntu/+source/python-mysqldb)描述）发生冲突，该补丁后来被删除。

该页面的评论说： 1.2.2-7 发表于 2008-06-19 intrepid-release

python-mysqldb (1.2.2-7) 不稳定；紧迫性=低

[ Sandro Tosi ] * debian/control - 描述中的列表项目行以 2 个空格开头，以避免在网页上重新格式化（关闭：#480341）

[ Bernd Zeimetz ] * debian/patches/02_reconnect.dpatch: - 删除补丁：Storm 中的评论解释了问题：

```
 # Here is another sad story about bad transactional behavior. MySQL
    # offers a feature to automatically reconnect dropped connections.
    # What sounds like a dream, is actually a nightmare for anyone who
    # is dealing with transactions. When a reconnection happens, the
    # currently running transaction is transparently rolled back, and
    # everything that was being done is lost, without notice. Not only
    # that, but the connection may be put back in AUTOCOMMIT mode, even
    # when that's not the default MySQLdb behavior. The MySQL developers
    # quickly understood that this is a terrible idea, and removed the
    # behavior in MySQL 5.0.3\. Unfortunately, Debian and Ubuntu still
    # have a patch right now which *reenables* that behavior by default
    # even past version 5.0.3. 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2018-07-06T09:53:56.503

我需要一个与 Garret 类似的解决方案，但`cursor.execute()`因为我想让我`MySQLdb`处理所有逃避责任。包装器模块最终看起来像这样（下面的用法）：

```
#!/usr/bin/env python

import MySQLdb

class DisconnectSafeCursor(object):
    db = None
    cursor = None

    def __init__(self, db, cursor):
        self.db = db
        self.cursor = cursor

    def close(self):
        self.cursor.close()

    def execute(self, *args, **kwargs):
        try:
            return self.cursor.execute(*args, **kwargs)
        except MySQLdb.OperationalError:
            self.db.reconnect()
            self.cursor = self.db.cursor()
            return self.cursor.execute(*args, **kwargs)

    def fetchone(self):
        return self.cursor.fetchone()

    def fetchall(self):
        return self.cursor.fetchall()

class DisconnectSafeConnection(object):
    connect_args = None
    connect_kwargs = None
    conn = None

    def __init__(self, *args, **kwargs):
        self.connect_args = args
        self.connect_kwargs = kwargs
        self.reconnect()

    def reconnect(self):
        self.conn = MySQLdb.connect(*self.connect_args, **self.connect_kwargs)

    def cursor(self, *args, **kwargs):
        cur = self.conn.cursor(*args, **kwargs)
        return DisconnectSafeCursor(self, cur)

    def commit(self):
        self.conn.commit()

    def rollback(self):
        self.conn.rollback()

disconnectSafeConnect = DisconnectSafeConnection 
```

使用它很简单，只有初始连接不同。根据您的 MySQLdb 需要使用包装器方法扩展类。

```
import mydb

db = mydb.disconnectSafeConnect()
# ... use as a regular MySQLdb.connections.Connection object

cursor = db.cursor()

# no more "2006: MySQL server has gone away" exceptions now
cursor.execute("SELECT * FROM foo WHERE bar=%s", ("baz",)) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-11-04T22:01:44.417

您可以将连接的提交和关闭分开......这并不可爱，但它确实做到了。

```
class SqlManager(object):
 """
 Class that handle the database operation
 """
 def __init__(self,server, database, username, pswd):

      self.server = server
      self.dataBase = database
      self.userID = username
      self.password = pswd

def Close_Transation(self):
      """
      Commit the SQL Query
      """
      try:
        self.conn.commit()
      except Sql.Error, e:
        print "-- reading SQL Error %d: %s" % (e.args[0], e.args[1])

 def Close_db(self):
    try:
        self.conn.close()
    except Sql.Error, e:
        print "-- reading SQL Error %d: %s" % (e.args[0], e.args[1])

 def __del__(self):
    print "close connection with database.."
    self.conn.close() 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-17T01:50:49.520

我在使用 MySQL 和 Python 时遇到了类似的问题，对我有用的解决方案是将 MySQL 升级到 5.0.27（在 Fedora Core 6 上；您的系统可能在不同版本下也能正常工作）。

我尝试了很多其他的东西，包括修补 Python 库，但是升级数据库要容易得多，而且（我认为）是一个更好的决定。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-06-26T12:36:18.580

除了 Liviu Chircu 解决方案...将以下方法添加到 DisconnectSafeCursor：

```
def __getattr__(self, name):
    return getattr(self.cursor, name) 
```

并且像“lastrowid”这样的原始光标属性将继续工作。

* * *

## 回答 #8

> 赞同：-4
> 
> 时间：2008-10-16T20:15:17.047

您也可以自己使用代码解决掉线问题。

一种方法是：

```
import MySQLdb

class DB:
    conn = None

    def connect(self):
        self.conn = MySQLdb.connect()

    def cursor(self):
        try:
            return self.conn.cursor()
        except (AttributeError, MySQLdb.OperationalError):
            self.connect()
            return self.conn.cursor()

db = DB()
cur = db.cursor()
# wait a long time for the Mysql connection to timeout
cur = db.cursor()
# still works 
```

# video - 加入 MP4 和/或 3GP 文件的 Windows（理想情况下 .NET 可调用）API？

> ID：207987
> 
> 赞同：1
> 
> 时间：2008-10-16T09:57:51.690
> 
> 标签：video, transcoding

我正在开发我们的后端编码器服务，该服务进行了大量的视频转码和极少量的视频文件连接。

转码是使用适用于 Windows 的 On2 Flix 引擎完成的，该引擎运行良好，但不幸的是它无法加入文件（至少据我所知 - 帮助和支持都不是非常有用的信息）。我现在对此很满意。

目前，加入是使用 LEADTOOLS 多媒体软件完成的，坦率地说，这是可怕的。它是单线程的并且需要 STA，因为它使用消息泵，这对于服务器应用程序来说并不完全理想。此外，安装会用自己的 eval 负载覆盖我们所有工作的编解码器，并且没有办法避免这种情况。

理想情况下，我正在寻找一种 API 来替换 LEADTOOLs Multimedia 的 API，它可以加入 3GP 和/或 MP4 文件。成本不是太大的问题。有人有什么建议吗？

我知道理想的解决方案是在这里编写我们自己的工具，但我们打算在 WMF 中执行此操作并且尚未完全过渡到 Win2008，因此我们需要几个月的临时解决方案。

**更新：**

我应该指出，编码绝不是我的专业领域，而且我从来没有过多地处理非托管代码对行业来说相对较新（7 年）。我也没有太多时间，因为我的日常工作是服务层/编码器团队的开发主管，该团队仅由我和另一个人组成，所以我们根本没有太多时间花在编码器上.

像 Flix 引擎这样已经处理了很多底层复杂性的东西比我正在寻找的东西要多于必须根据输入/输出文件类型等进行不同调用的低级 API。

如果您确实有任何建议，那么如果您可以向我指出一些文档以了解它们的使用方式等，那将非常有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-16T10:00:41.933

FFMPEG 的 libavcodec 和 libavformat 是你的朋友。它们用途广泛，基本上比其他任何东西都支持更多，并且实际上是多媒体支持和操作的跨平台标准。

您还可以尝试 MP4box 的库 GPAC，它是一个 MP4 特定的库，比 FFMPEG 的 API 更强大，但（给定名称）仅对处理 MP4 和 3GP 文件有用。

另外，如果您使用 Flix 进行转码，您是否考虑过升级到更现代的东西？FLV1 和 VP6 对于 Flash 视频来说是相当糟糕的格式；现在 Flash 支持 H.264，真的没有理由继续使用这种过时的（而且，对于 VP6，价格昂贵）格式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T04:37:04.303

对于 x264：您可以简单地调用可执行文件本身，或者您可以包含库本身并通过其 API（encoder_open 等）调用它。使用 .NET 可能会更困难；作为一个 C 程序，它的 API 是围绕 C 构建的，尽管我知道 Windows 和 Linux 上的 C 和 C++ 程序都已经构建了调用 API。

There's no real advantage to one over the other for a simple program: either way, x264 only takes a single type of input (raw YV12 video) and spits out a single type of output (H.264 elementary streams, or in the case of the CLI app, it can also mux MP4 and Matroska).

If you need an all-in-one solution, ffmpeg can do the job, as it can automatically handle decoding and pass on the encoding to libx264\. If you need more specific assistance, drop by #x264 on Freenode IRC.

# .net - 如何指定主题默认字体的粗体版本？

> ID：207994
> 
> 赞同：1
> 
> 时间：2008-10-16T10:00:30.453
> 
> 标签：.net, c++, visual-studio, winforms

我在 Windows 窗体中遇到跨主题兼容性问题。如果您没有为 windows 窗体上的控件设置字体，它将使用具有正确字体和大小的系统字体。如果你想让字体**加粗**，它会在你正在编程的当前主题的其余系统字体值中硬编码。例如：

```
System::Windows::Forms::Label^ label1 = gcnew System::Windows::Forms::Label();

this->label1->AutoSize = true;
this->label1->Location = System::Drawing::Point(9, 12);
this->label1->Name = L"lblExample";
this->label1->Size = System::Drawing::Size(44, 13);
this->label1->TabIndex = 3;
this->label1->Text = L"Example Text"; 
```

如果我然后通过属性编辑器更改它的属性，以便粗体 = true，它会在这一行中添加：

```
this->label1->Font = (gcnew System::Drawing::Font(L"Microsoft Sans Serif", 8.25F, System::Drawing::FontStyle::Bold, System::Drawing::GraphicsUnit::Point, static_cast<System::Byte>(0))); 
```

有没有办法使用默认字体，但使其粗体？

更进一步，有没有一种使用系统字体的方法，但将大小放大 3 或 4 点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T10:01:28.343

啊，我想我找到了答案：

```
this->label1->Font = gcnew System::Drawing::Font(this->label1->Font, FontStyle::Bold); 
```

但这现在打破了设计师的观点:(

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-16T15:37:41.130

您可以将修改后的字体初始化直接放在构造函数中的 InitializeComponent 调用之后。

此外，您可以使用众多构造函数之一来更改大小。

```
InitializeComponent();

label1->Font = gcnew System::Drawing::Font(
    label1->Font->FontFamily, 
    label1->Font->SizeInPoints + 4, 
    FontStyle::Bold,
    GraphicsUnit::Point); 
```

这将使设计视图不会混淆......但您也无法在设计视图中看到它。***********