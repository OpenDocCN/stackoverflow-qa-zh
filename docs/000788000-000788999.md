# StackOverflow 问答 000788000-000788999

# algorithm - kd-tree 是否适合 4D 时空数据（x,y,z,time）？

> ID：788005
> 
> 赞同：8
> 
> 时间：2009-04-25T01:01:49.330
> 
> 标签：algorithm, math, search, data-structures, multidimensional-array

我想使用数据结构对时空数据（x、y、z、时间）进行排序。

目前，处理算法搜索一组 4D (x,y,z,time) 点，给定球面 (3d) 空间半径和线性 (1d) 时间半径，标记每个点，哪些其他点在这些半径内。原因是处理后，我可以在 O(1) 时间内询问任何 4D 点的所有邻居。

然而在一些常见的空间和时间半径配置中，算法的第一次运行大约需要 12 个小时。信不信由你，与我们行业中的现有产品相比，这实际上速度很快。不过，我想帮助加快初始运行速度，所以我想知道：**[kd-tree](http://en.wikipedia.org/wiki/Kd_tree)****是否适合 4D 时空数据？**

请注意，我**不是**在寻找最近邻搜索或 k-最近邻搜索的实现。

**更多信息：**

一个示例数据集有 450,000 个 4D 点。

一些数据集是时间密集的，因此按时间排序肯定会节省处理时间，但仍会导致许多距离检查。

时间由 Excel 样式的日期表示，典型范围在 30,000-39,000（大约）之间。空间范围有时是较高的值，有时是较低的值，但每个空间坐标之间的范围与时间相似（例如 maxX-minX ~ maxT-minT）。

**更多信息：**

我想我会添加一些稍微不相关的数据，以防有人处理过类似的数据集。

基本上，我正在处理表示由多个传感器记录和证实的时空事件的数据。涉及错误，因此仅包括满足错误阈值的事件。

这些数据集的时间跨度介于 5-20 年的数据之间。

对于真正的旧数据（> 8 年），事件通常在空间上非常密集，原因有两个：1）当时可用的传感器相对较少，2）传感器被放置在一起，以便附近的事件可以正确以低误差证实。可以记录更多事件，但它们的错误太高

对于较新的数据（<8 年），事件通常非常时间密集，原因恰恰相反：1）通常有许多传感器可用，2）传感器以固定间隔放置在更远的距离上。

因此，通常不能说数据集只有时间密集或空间密集（仅包含新数据的数据集除外）。

**结论**

我显然应该在这个网站上问更多问题。

我将在接下来测试几个解决方案，其中包括 4d kd-tree、3d kd-tree，然后是时间距离检查（由 Drew Hall 建议），以及我拥有的当前算法。另外，有人建议我使用另一种称为 TSP（时间空间分区）树的数据结构，它使用八叉树作为空间，在每个节点上使用 bsp 作为时间，所以我也可以对其进行测试。

假设我记得，我一定会发布一些关于不同时间/空间半径配置的分析基准。

谢谢大家

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-25T02:57:32.250

要扩展我对上述答案的评论：

根据文献，kd-trees 需要具有欧几里得坐标的数据。它们可能不是绝对必要的，但它们肯定就足够了：保证所有坐标都是欧几里得，确保了正常的空间规则适用，并且可以通过它们的位置轻松划分点并建立树结构。

时间有点奇怪。根据狭义相对论的规则，当您使用时间坐标时，您使用的是 Minkowski 度量，而不是标准的欧几里得度量。这会导致各种问题（其中最严重的是破坏了“同时性”的含义），并且通常使人们害怕时间坐标。然而，这种恐惧并不是有根据的，因为除非你*知道*你正在研究物理学，否则你的时间坐标几乎可以肯定在实践中实际上*是*欧几里得。

坐标是欧几里得意味着什么？它应该独立于所有其他坐标。说时间是欧几里得坐标意味着您可以回答“这两点在时间上是否靠近？”这个问题。*只看*他们的时间坐标，而忽略任何额外的信息。很容易看出为什么*没有*该属性可能会破坏按坐标值划分点的方案；如果两个点可以具有完全不同的时间坐标，但仍被认为是“时间上接近”，那么按时间坐标对它们进行排序的树就不会很好地工作。

欧几里得时间坐标的一个示例是在单个一致的时区（如 UTC 时间）中指定的任何时间。如果你有两个时钟，一个在纽约，一个在东京，你知道如果你有两个标记为“12:00 UTC”的测量值，那么它们是同时进行的。但是如果测量是在当地时间进行的，所以一个说“纽约时间 12:00”，一个是“东京时间 12:00”，你必须使用有关城市位置和时区的额外信息来计算两次测量之间经过了多少时间。

因此，只要您的时间坐标始终如一地测量和健全，它将是欧几里得，这意味着它可以在 kd-tree 或类似的数据结构中正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T01:17:09.290

您还没有真正提供足够的信息来回答这个问题。

但是可以肯定的是，通常 kd-trees 非常适合 4（或 5 或 6 或...）维数据 --- 如果空间（或在您的情况下为空间/时间）分布适合 kd-tree 分解. 换句话说，这取决于（听起来很熟悉？）。

kd-trees 只是空间分解的一种方法，它适用于某些局部搜索。当你进入更高的维度时，维度问题的诅咒当然会抬头，但 4d 并不算太糟糕（你可能至少需要几百点）。

为了知道这是否适合您，您必须分析一些其他标准。近似 NN 搜索是否足够好（这很有帮助）。树平衡可能很昂贵吗？等等

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-25T01:24:18.277

如果您将索引存储在按时间维度排序的点上，您不能先在 1-d 时间维度中执行初始修剪，从而减少距离计算的次数吗？（或者这是过于简单化了？）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-25T01:51:22.347

如果您的数据相对时间密集（并且空间相对稀疏），最好在空间维度上使用 3d kd-tree，然后简单地拒绝感兴趣的时间窗口之外的点。这将解决您的混合空间/时间度量问题，但代价是稍微复杂一点的点结构。

# continuous-integration - CI 是否需要 CI-Server

> ID：788010
> 
> 赞同：4
> 
> 时间：2009-04-25T01:10:36.047
> 
> 标签：continuous-integration

持续集成是否需要 CI 服务器？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-25T01:14:22.323

为了促进持续集成，您需要自动化构建、分发和部署过程。这些步骤中的每一个都可以在没有任何专门的 CI 服务器的情况下进行。可以通过文件通知和其他低级机制来协调这些活动；但是，协调这些步骤的数据库驱动后端（CI-Server）极大地增强了系统的可靠性、可扩展性和可维护性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-25T01:27:13.713

您不需要专用服务器，但某种构建机器是无价的，否则没有一个中央位置始终可以构建和测试代码。尽管您可以使用开发人员机器模拟这种影响，但存在与该机器上正在更改的代码重叠的风险。

顺便说一句，我使用的是 Hudson，它的重量很轻——不需要太多就可以了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-25T02:43:13.157

使用专用机器很重要，这样您才能获得独立验证，而不会损坏。

对于小型项目，它可以是一台非常基本的机器，所以不要让硬件成本让你失望。您的壁橱里可能有一台足够好的旧机器。

您还可以通过使用虚拟机来避免使用专用*硬件。*最好的办法是找到一台正在做其他事情但负载不足的服务器，然后将 VM 放在上面。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-28T15:54:37.877

在我听说过“持续集成”这个词之前（这是在 2002 年或 2003 年），我编写了一个连接到 cvs 的夜间构建脚本，获取了主项目和五个较小的子项目的干净副本，构建了所有jars via ant 然后通过使用 tomcat ant 任务的第二个 ant 脚本构建和重新部署一个 WAR 文件。

它在晚上 7 点通过 cron 运行，并发送带有一堆附加输出文件的电子邮件。我们在整个项目的 7 个月中都使用了它，并且在接下来的 20 个月的维护和改进中一直在使用它。

它工作得很好，但我更喜欢 hudson 而不是 bash 脚本、cron 和 ant。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-25T03:26:00.667

如果项目中有多个开发人员，则确实需要一台单独的机器。

如果您使用的是 .NET 技术堆栈，这里有一些提示：

1.  [CruiseControl.Net](http://confluence.public.thoughtworks.org/display/CCNET/Welcome+to+CruiseControl.NET)相当轻量级。这就是我们使用的。您可能可以在您的开发机器上运行它而没有太多麻烦。
2.  除非您有 Visual Studio 安装项目，否则无需安装或运行 Visual Studio。相反，您可以使用名为[MSBuild](http://msdn.microsoft.com/en-us/library/0k6kkbsd.aspx)的免费命令行构建工具。

# javascript - 在 Javascript 中，我可以在带有标签的文本上获得确切的坐标（到处都是子节点吗？）

> ID：788011
> 
> 赞同：2
> 
> 时间：2009-04-25T01:12:11.237
> 
> 标签：javascript, dom, text

请参见下面的示例：它在表格中显示文本行（这是有充分理由的，但这不是这里的问题）。

基本上，我需要的只是一个函数，当我点击链接时，alert() 是*文本选择的完美坐标。*通过完美坐标，我的意思是：选择开始的行号，选择结束的行号（这两个是微不足道的，我只是使用`<td>`id中的数字，选择开始的偏移量，偏移量的选择结束。

所以，如果我选择

> 第一行，它包含文本
> 这是第二行

我收到一条警报，上面写着：

> 选择从第 1 行开始，偏移 12
> 选择在第 2 行结束，偏移 18

如果文本是纯文本，那么使用 getRange() 将非常容易（我不需要 Internet Explorer 兼容性，因此适用于 FireFox、Chrome 和 Safari 的 getRange() 可以）。这里的问题是`<span>, <strong> and <em>`标签无处不在，而且每个标签都是一个新的 childNode。所以 getRange() 不起作用。

我还没有找到忽略标记的方法。似乎没有简单的方法可以做到这一点。但我不是 Javascript 专家，也许有一个技巧可以忽略（或使函数表现得好像它忽略了）文本中的标签。

`<a href="javacript: magicCode();">Select some text in the table then click here</a>
<table>
<tr>
<td id="content1">This <span class="one">is the</span> first line <span class="two">and it contains</span> text</td>
</tr>
<tr>
<td id="content2">This is the <span class="three">second line and it contains text</span></td>
</tr>
<tr>
<td id="content3"><span class="four">This is <span class="five">the third</span> line and it</span> contains text</td>
</tr>
<tr>
<td id="content4">This is <strong>the fourth <em>line</em> and it</strong> contains text</td>
</tr>
<tr>
<td id="content5">This is the fifth line and it contains text</td>
</tr>
</table>`

谁能帮我写我的magicCode()？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-29T17:12:46.537

您可以使用该`.textContent`属性仅获取没有 HTML 的文本值。`.innerText`您可以通过检查并使用它（如果存在）来轻松使其在所有浏览器中工作，否则使用`.textContent`. `innerText`适用于 IE 并`textContent`适用于 Firefox/Chrome 等。

这是一个示例：

```
 var content = document.getElementById('content1');
 if(content.innerText){
   alert(content.innerText);
 }else{
   alert(content.textContent);
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-30T13:29:06.420

您可能想研究使用 canvas 标签来生成文本；对于您的项目来说，它可能有点复杂和过度。

Bespin 是一个完全使用 canvas 标签创建的代码编辑器。我没有查看源代码，所以我无法告诉您他们如何设法呈现文本和模拟文本选择。

[https://bespin.mozilla.com/](https://bespin.mozilla.com/)

# asp.net - asp:ImageButton 不触发 onclick 事件

> ID：788018
> 
> 赞同：10
> 
> 时间：2009-04-25T01:18:51.033
> 
> 标签：asp.net, webforms, master-pages, onclick, imagebutton

我有一个使用母版页、几个RequiredFieldValidators 和Web Toolkit 自动完成扩展器的页面。以下代码仅显示页面的最低限度：

```
<%@ Page Language="C#" 
    AutoEventWireup="true"  
    CodeFile="Login.aspx.cs" 
    MasterPageFile="~/master.master" 
    Inherits="Login" %>

<asp:Content id="Content1" 
    contentplaceholderid="ContentPlaceHolder1" 
    runat="server">
    <asp:UpdatePanel ID="pnlUpdate" runat="server">
        <ContentTemplate>
            <div>
                <asp:ImageButton class="submitButton" 
                    imageurl="images/button_submit.gif" 
                    id="btnSubmit" 
                    runat="server" 
                    onclick="btnSubmit_ServerClick"/>
            </div>
        </ContentTemplate>
    </asp:UpdatePanel>
</asp:Content> 
```

代码隐藏：

```
protected void btnSubmit_ServerClick
      (object sender, ImageClickEventArgs e)
{
    //breakpoint here does not get hit
} 
```

该`<form runat="server">`标记位于母版页中。上面的代码不会触发 onclick 事件。如果我摆脱母版页并向页面添加表单标签，它就可以工作。是否不支持母版页中的表单标签，或者这应该以某种方式工作？ [替代文字 http://digitalcopy.warnerbros.com/images/mainmenu.gif?provider=00079&disc=03403AAA-1D20-47F2-91FA-5EE632832659](http://digitalcopy.warnerbros.com/images/mainmenu.gif?provider=00079&disc=03403AAA-1D20-47F2-91FA-5EE632832659)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-25T05:52:57.053

您还可以检查您的 ImageButton 是否不会触发验证。如果它确实将其 CausesValidation 属性设置为 false（当然，如果它有意义的话）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-09T21:03:13.590

我的解决方案是将 ImageButton 的 CausesValidation 设置为 false。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-08-25T22:56:07.080

我有一个类似的问题（不同的场景）。我使用`Page.RegisterRequiresRaiseEvent(ImageButton)`并且我的 onclick 事件开始触发。为什么我需要这样做？我不知道。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-03-07T18:22:04.510

`ib.ID = i + ":" + j;`

应该改为

```
ib.ID = i.toString()+":"+j.toString(); 
```

如果它仍然不起作用，请尝试使用 StringBuilder 来构建 ID 并稍后将其分配给 ib.ID 属性

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-09-16T21:41:04.287

我对图像按钮有类似的问题，并找到了根本原因。您正在使用

" `ib.ID = i + ":" + j;`"

作为 的 ID `ImageButton`，“ `:`”是非法名称，因为您正在以编程方式创建它，ASP.NET 允许创建它。

在运行时，如果您查看页面的 HTML 源代码，您将看到特殊字符被忽略或替换为“ `_`”。因此页面无法找到正确的控件，因此事件不会触发。尝试用纯文本更改名称，该事件将触发。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-08-22T10:31:04.323

这是对我有用的解决方案

如果您通过数据绑定控件进行绑定，则使用 OnCommand attr 而不是 OnClick attr

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-02T19:15:53.043

在我的网页上，我在更新面板包含的表内动态创建图像按钮。按钮由以下代码创建：

```
for (int i = 0; i < 15; i++)
    {
        TableRow tr = new TableRow();
        for (int j = 0; j < 20; j++)
        {
            TableCell tc = new TableCell();
            ImageButton ib = new ImageButton();
            ib.Click += new ImageClickEventHandler(ImageButton1_Click);
            ib.ImageUrl = "../img/defaultCell.jpg";
            ib.ID = i + ":" + j;
            tc.Controls.Add(ib);
            tc.Width = 25;
            tc.Height = 25;
            tr.Cells.Add(tc);
        }
        GameTable.Rows.Add(tr);
    } 
```

}

图片按钮不会触发点击事件。但是，如果“ib.ID = ...”行被注释掉，他们会这样做！这种单一的交替似乎解决了所有问题。我不知道为什么。如果有人可以解释这一点，并告诉我如何触发事件以保持设置按钮 ID 的能力，我将非常感谢

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-09-16T21:48:04.850

确保使用**OnClick**而不是**onClick**

您的更新面板可能会干扰回发。在没有 UpdatePanel 的情况下尝试它，看看这是否是罪魁祸首。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-03-12T06:40:46.137

我遇到了同样的问题，我正在动态创建一个 ImageButton 并且单击该事件没有触发。因此，我在 if (IsPostBack) 中创建了 Image 按钮。现在它工作正常。即使页面被刷新，ImageButton 也会被保留。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-25T01:25:12.987

您必须在某处以 runat=server 的形式拥有控件，它可以在母版页或 .aspx 文件中。仔细检查母版页表单标记是否为 runat=server

AutoEventWireup 是允许您使用的语法的属性。仔细检查母版页、WebForm 中的设置，也可以在 web.config 中进行设置。

如果这不起作用，您可以随时对其进行显式编码（我更喜欢）

```
<script runat=server>

protected override void OnInit(EventArgs e)
    {
        btnSubmit.Click += delegate(object sender, EventArgs e1)
        {

        };
        base.OnInit(e);
    }

</script> 
```

UpdatePanel 也可能会引发服务器端事件，因此请尝试不使用 UpdatePanel。而且我确信您在母版页中有一个 ScriptManager

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-25T03:04:45.430

从您提供的代码中，您似乎缺少`<asp:scriptmanager>`页面中的代码。您必须执行以下操作之一：

1.  `<asp:scriptmanagerproxy>`在页面上和`<asp:scriptmanager>`母版页上都有。
2.  在您`<asp:scriptmanager>`的页面上有`<asp:scriptmanager>`，在母版页上没有。

就个人而言，我建议`<form>`在母版页上放置标签，但这是个人喜好。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-25T04:01:41.113

您可以随时尝试取出 UpdatePanel 并查看它是否有效。我通常在没有 UpdatePanel 的情况下开始，让一切按照我想要的方式工作，然后添加 UpdatePanel 并调试任何导致的问题。

MasterPage 中的表单对我有用，所以@Keltex 提到的 ScriptManager/ScriptManagerProxy 可能是一个问题，尽管我有时会忘记它们并且通常会侥幸逃脱。

使用 UpdatePanel，按钮的单击事件将通过 Javascript 处理，因此您可以获取 FireBug 或等效项（取决于浏览器）并跟踪实际发生的情况。它是否因验证而绊倒而您没有看到它？某处是否存在 JS 错误（控制工具包并不总是完美的）？该页面实际上是否完全回发而只是没有点击事件处理程序？

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-07-23T21:12:23.690

我认为这可能与您在创建和分配事件处理程序后重新分配 id 的事实有关？

您甚至需要分配ID吗？- 无论如何，这肯定是为你完成的吗？- 真正删除 'ib.ID = i + ":" + j;'

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-04-04T11:59:39.697

我遇到了同样的问题，即`OnClick`ImageButton 的事件没有触发。但实际的问题是，在形式层面，我有 `onSubmit="return false;"`

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-12-19T22:22:33.960

我刚刚解决了启用 OutputCache 的类似问题。从 更改`asp:ImageButton`为 时`asp:Button`，事件被正确触发。OutputCache可能`asp:ImageButton`有一些错误。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2015-05-20T11:15:24.940

在上述建议都对我不起作用之后，我通过调用 OnInit() 中的按钮创建又做了一次尝试。这解决了我的问题，现在 OnClick 事件正在触发。

# mysql - 是否有与 Postgresql 的“美元引号字符串常量”等效的 mySQL？

> ID：788022
> 
> 赞同：4
> 
> 时间：2009-04-25T01:20:45.023
> 
> 标签：mysql

在 postgresql 中，可以使用“美元引号字符串常量”来避免在常量字符串中转义单引号：

没有美元引用的字符串常量：

```
'Jeff''s table' 
```

使用美元引用的字符串常量：

```
$$Jeff's table$$ 
```

是否有 MySQL 等价物？

编辑时：我不是在寻找清理输入的方法，而是在寻找一种使生成 sql 的查询更易于阅读的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T01:26:33.747

不，因为它真的不起作用。攻击者只是在他们的注入尝试中添加了一对美元符号。

处理这个问题的正确方法是使用真实查询参数的系统，这样参数值*永远不会*直接替换到查询字符串中。这通常对性能也更好，因为数据库可以更好地缓存执行计划，您最终不会动态构建字符串，这在现代语言中往往很慢。

没有过多的连接语句也极大地提高了代码的可读性。而不是这个：

```
sql = "SELECT * FROM MyTable WHERE Column1=$$" + somevarialbe + "$$ AND Column2=$$" + OtherVariable"; 
```

就是这样：

```
sql = "SELECT * FROM MyTable wHERE Column1=@Value1 AND Column2=@Value2"; 
```

* * *

嗯...好的，我现在可以看到此功能的一些有限实用程序。

想象一个带有存储过程的票务跟踪系统来获取开放票。您实际上可能将文字“open”硬编码到查询的 where 子句中。并不是说这将是一个好的设计——工单状态应该在一个带有它自己的密钥的表中，这样您就可以硬编码密钥而不是文本。但它为一些有效且更复杂的事情播下了种子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T16:56:33.093

您可以将字符串括在双引号中，例如

```
"Jeff's table" 
```

注意：如果这不起作用，则表示您已`ANSI_QUOTES`打开 SQL 模式。[MySQL 文档](http://dev.mysql.com/doc/refman/5.6/en/string-literals.html)说：

> 如果`ANSI_QUOTES`启用 SQL 模式，则字符串文字只能在单引号内引用，因为双引号内引用的字符串被解释为标识符。

# iis-7 - 让站点在 IIS 7 问题中运行

> ID：788025
> 
> 赞同：0
> 
> 时间：2009-04-25T01:23:28.480
> 
> 标签：iis-7

这让我发疯了。我正在尝试在我们的开发服务器上设置一个网站，并以特定的 URL 名称 www.mystpidsite.com 为例。mystupidsite 与开发服务器的名称不同。

1) 为我在 IIS 中创建的网站指定一个特定的 url

2）运行它并使用该网址访问它

我有：

1) 在 Server 2008 的 IIS 7 中创建了一个新站点

2) 尝试通过我设置为所需 url 和端口 8888 的站点名称来访问它。因此，如果我们希望它是 www.mystupidsite.com，我在 IIS 7 中将网站名称设置为 mystupidsite。

3）我什至尝试在 IIS 7 中的 mystupidsite 下创建一个同名的应用程序。

该服务器绝对可以从我的本地 PC 在网络上访问和 ping，我们在这台新服务器上安装了其他东西。我需要创建一个应用程序还是仅仅在 IIS 7 中创建网站就足够了？我在我制作的网站中将IP指定为服务器的IP。

对于网站绑定中的主机名，我输入了 www.mystupidsite.com

当我尝试通过 www.mystupidsite.com 访问该站点时，它找不到它，并且开发服务器上的 IIS7 中的站点正在运行。它在我们的开发服务器 HyperV 实例上运行。其他一切都很好。我只是想了解如何通过名称设置获取特定的 url。

我需要在服务器上的主机文件中添加一些东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T01:52:24.807

您将无法在您的开发盒上拥有一个站点来回答 mystpidsite.com 和 mystupidsite.com 域名。

除非您已注册域并且您的域的名称服务器将该名称定向到您的开发机器，否则 IIS 只会响应网络上的机器名称或机器的 IP 地址（除了 127.0.0.1 和 localhost ）。

在这种情况下，您唯一能做的就是在您机器上的两个不同端口上设置两个站点，并从[http://localhost:80](http://localhost:80)和[http://localhost:8888](http://localhost:8888)（或网络计算机）访问它们名称等效）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T01:32:20.003

当您输入“nslookup www.mystupidsite.com”时会发生什么？你得到虚拟服务器的IP地址了吗？

您是否在服务器上启用了 windows 防火墙？如果是这样，您是否为端口 8888 添加了例外？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-25T01:56:35.907

添加默认绑定（无主机头/空白）并尝试通过 IP 访问它

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-25T01:57:24.717

使用 www.mystupidsite.com 时，您需要在 dns 中有一个条目才能访问服务器

因为您的站点在备用端口上运行，您应该能够通过[http://your-server-IP-address:8888访问它](http://your-server-IP-address:8888)

如果您想使用主机名在本地测试它并且无权访问 dns，您可以将适当的条目添加到本地计算机上的主机文件（c:\windows\system 32\drivers\etc\hosts）

# c - 十六进制到十进制转换 [K&R 练习]

> ID：788026
> 
> 赞同：6
> 
> 时间：2009-04-25T01:23:38.777
> 
> 标签：c, kernighan-and-ritchie

我正在学习 C，但我无法弄清楚其中一个 K&R 练习，清单：

> 练习 2-3，编写函数 `htoi(s)`，将一串十六进制数字（包括可选的`0x`or `0X`）转换为其等效的整数值。允许的数字是`0`through `9`、`a`through`f`和`A` through `F`。

我想我需要在这里做一些递归，我只是猜想我对编号类型及其各种转换方法等不太了解。

有人能给我一些关于如何最好地理解它的指示吗，我不是在找人握着我的手，而是引导我找到一种正确理解的方法，这样我就可以尽可能以最优雅的形式写出来，而不是和`printf("%x", skill);`

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-25T01:27:28.270

递归不是必需的。您只需在字符串上向后循环（即从单位列开始），将单个数字转换乘以它的基数位置乘数求和。这是伪代码，不处理可选的 0x 前缀（并且不检查溢出的可能性）：

```
long total = 0;
long multiplier = 1;
for (int i = string.length - 1; i >= 0 i--)
{
   digit = ConvertSingleHexDigittoInt(string[i]);
   total += digit * multiplier;
   multiplier *= 16;
} 
```

我把 ConvertSingleHexDigittoInt() 的简单实现留给了你 :)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-25T01:38:14.653

米奇的基本想法是对的，但让我们更详细地了解一下。

十六进制数字只是以 16 为基数，这意味着数字（从右到左）的值为

位数×16 ⁰（即1）
位数×16 ¹（即16）
位数×16 ²（256）

等等。因此，例如，0xE 是 14。

您需要的是从字符串的*右端开始的循环。*假设字符串是 s，length(s) 是字符串的长度。在伪代码中，你想要

```
value = 0
r = 1   // ask yourself "what values does r take as this proceeds?"
for i from length(s)-1 to 0   // Ask yourself "why length(s)-1?"
   value = value + (digitval(s[i])*r)
   // get ready for the next digit
   r = r * 16 
```

`digitval(char c)`需要是一个函数，将“0123456789ABCDEF”中的 checact 转换为 0 到 15（含）之间的值。我将把它作为练习留下，并给出一个提示：“数组”。

小心一个额外的问题；因为你可能有一个前导的“0”或“0x”，所以你需要确保你处理这些情况。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-25T02:14:11.883

对于那些熟悉数学的人来说，从左到右处理字符串更简单，并且可以说更具可读性。该战略正在意识到，例如，`1234 = (((1 x 10) + 2) x 10 + 3) x 10 + 4`

换句话说，当您从左到右处理每个数字时，将前一个总数乘以基数，有效地将其“向左移动”一个位置，然后添加新数字。

```
long decFromHexStr(const char *hexStr)
{
    int i;
    long decResult = 0;  // Decimal result

    for (i=0;  i < strlen(hexStr);  ++i)
    {
        decResult = 16 * decResult + decFromHexChar(hexStr[i]);
    }
    return decResult;
} 
```

有经验的程序员可能会使用指针来遍历字符串，而不是将其视为数组：

```
long decFromHexStr(const char *pHex)
{
    long decResult = 0;

    while (*pHex != '\0')
    {
        decResult = 16 * decResult + decFromHexChar(*pHex++);
    }
    return decResult;
} 
```

既然你在学习，那么学习编码风格并决定你是否觉得它有帮助是值得的，这样你就会尽早养成良好的习惯。

玩得开心！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-25T02:32:59.140

十六进制数实际上是什么意思？让我们以**15FA 为例**。它的意思是

```
1 * 16^3 + 5 * 16^2 + 15 * 16^1 + 10 * 16^0 
```

请注意，**A**代表 10，**B**代表11，依此类推，直到**F**代表 15。16^0 也等于 1。

所以我们需要做的就是计算上面表达式的值！最简单的方法可能是按以下顺序进行：

```
10 * 1
15 * 16
5  * 256   //256  = 16 * 16
1  * 4096  //4096 = 16 * 16 * 16 
```

如果有更多的数字，这可以继续下去。您真正需要的只是一个循环和几个变量。

还有另一种方法可以通过分解上述表达式来解释，如下所示：

```
((1 * 16 + 5) * 16 + 15) * 16 + 10 
```

如果您愿意，请尝试每种方法。

**更多高级信息：**

基本上，计算机的所有数字和计算都使用以 2 为底（也称为二进制）。甚至字符串“1A6DC0”也用 1 和 0 编码，最终在屏幕上显示为字母和数字。

有时您可以利用计算机使用二进制的事实，但通常您不需要考虑它。

例如，当你这样做时

```
x = (11 + y) * 6; 
```

您*不必担心*11 和 6 在某个阶段会表示为一系列高电压和低电压。它就像您期望的那样工作。十进制（我们使用的数字系统）和二进制之间的转换是一个简单的过程，计算机可以轻松完成，因此它们会自动为我们执行此操作，以使我们的工作更轻松。

但是，在十六进制和二进制之间进行转换时，有一个捷径。由于四个二进制数字与单个十六进制数字相同，因此您可以简单地将每个十六进制数字*单独*转换为二进制，然后将它们串在一起。

例如，**15FA**会像这样扩展：

```
1 -> 0001
5 -> 0101
F -> 1111
A -> 1010
15FA -> 0001 0101 1111 1010 
```

请注意，这通常不能直接完成，并且通常涉及逻辑或和位移（`|`和`<<`）。好玩的东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-25T06:55:06.343

试着用我粗鲁的英语解释:(

我的代码（假设所有输入都是正确的。避免防御性编程）

```
#include <stdio.h>

enum { SZ = 11 };

unsigned int htoi(const char *s);

int main()
{

  char buff[SZ];  //Max 11 char: 0x XX XX XX XX '\0' (2 + 8 + 1)

  while(fscanf(stdin, "%s", buff) != EOF)
    printf("%X\n", htoi(buff) ); 

  return 0;
}

unsigned int htoi(const char *s)
{
  unsigned int i, r = 0;

  for(i = (s[1] == 'x') ? 2 : 0; s[i] != '\0'; i++)
    r = ( r << 4 ) +  ( (s[i] > '9') ? 0x9 : 0x0 ) + ( s[i] & 0xF );

  return r;
} 
```

好的，首先，赋值 r = 0。然后，当我们开始 for-bucle 时，我们给索引变量 i 一个初始值。我们必须检查字符串是否为 0x 格式。我们只需要检查位置 1 就可以知道我们是否正在处理具有 0x 格式的输入字符串或没有它。

现在，我们有一个指向第一个正确字符的索引！对于每个迭代，我们向左移动 4 位。我们获得 4 个零。添加新十六进制数字的完美间隙！例子：

```
Input: 0xBE1234

Is s[1] == 'x' ? true then i = 2;
r = 0;

iter 1: r = 0x0; r = 0x0; r = 0xB;
iter 2: r = 0xB; r = 0xB0; r = 0xBE;
iter 3: r = 0xBE; r = 0xBE0; r = 0xBE1;
iter 4: r = 0xBE1; r = 0xBE10; r = 0xBE12;
iter 5: r = 0xBE12; r = 0xBE120; r = 0xBE123;
iter 6: r = 0xBE123; r = 0xBE1230; r = 0xBE1234 
```

可能这有点复杂：

```
 r = ( r << 4 ) + ( (s[i] > '9') ? 0x9 : 0x0 ) + ( s[i] & 0xF ); 
```

首先，我们替换 4 位，与每 16 位乘法相同，但效率更高。然后，我们查看是否有一个大于 '9' 的 ASCII 字符。如果这是真的，我们正在与 A、B、C、D、E、F 或 a、b、c、d、e、f 合作。请记住，我们假设我们有正确的输入。好的，现在看一下 ASCII 表：

```
A = 0100 0001  -  a = 0110 0001
...
F = 0100 0110  -  f = 0110 0110 
```

但我们想要这样的东西：

```
A = 0000 1010  -  a = 0000 1010
...
F = 0000 1111  -  f = 0000 1111 
```

我们怎么做？置换后，我们用掩码 s[i] & 0xF 清除 4 个最高有效位：

```
s[2] == 'B' == 0100 0010
s[2] & 0xF == 0000 0010 
```

并添加 9 以适应整数值（仅在 { 'A'...'F', 'a' ... 'f' } 中的 s[i] 的情况下）

```
s[2] & 0xF + 0x9 = 0000 0010 + 0000 1001 = 0000 1011 (0xB) 
```

最后，我们添加位移的 r 值并分配给 r。第二次迭代的执行顺序（s[3]）：

```
r == 0xB, s[3] == 'E' == 0100 0101 (start iter 2)
(r << 4) == 0xB0, s[3] == 'E' == 0100 0101 (displacement r << 4 )
(r << 4) == 0xB0, (s[3] & 0xF + 0x9) == 0000 1110 == 0xE (clear most significant bits of s[3] and add 0x9)
r = (r << 4) + ( s[3] & 0xF + 0x9 ) == 0xBE == 1011 1110 (add all and assign to r) 
```

如果我们有一个像 s[4] 这样的数字字符会发生什么？

```
s[4] == '1' == 0011 0001
s[4] & 0xF == 0000 0001 
```

位移 r 四个位置，加 0（无），加上逻辑运算的结果 s[i] & 0xF 最后，赋值给 r。

```
r == 0xBE, s[4] == '1' == 0011 0001 (start iter 3)
(r << 4) == 0xBE0, s[4] == '1' == 0011 0001 (displacement r << 4 )
(r << 4) == 0xBE0, (s[4] & 0xF + 0x0) == 0000 0001 (clear most significant bits of s[4] and add 0)
r = (r << 4) + s[4] & 0xF == 0xBE1 == 1011 1110 0001 (add all and assign) 
```

请记住，我们移动 4，因此我们不会对数字位进行网格划分，因为我们添加了具有四个零间隙的较低有效位。

PD：我保证提高我的英语以便更好地解释，对不起。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-25T01:55:24.690

传统方法从左到右转换。累加器在开始时设置为零，并在将每个新数字的等效值添加到循环之前乘以 16。

对于`htoi()`需要带有可选前导的十六进制数字的函数`0x`，首先跳过这些字符（如果存在）。直接检查`s[0]`and的值`s[1]`可能是那里最清晰的方法。

如果您知道数字是 ASCII 格式，那么您可以使用和之类的表达式`s[i] - '0'`将`s[i] - 'A' + 10`第 i 个数字转换为其整数值。

为了理智，您可能想将整个事情折叠到一个案例中。

**编辑：**更改`*s`为`s[i]`与从本练习的角度来看指针来自未来的观察保持一致。

请注意，还有其他几种方法可以将单个数字转换为值。例如，您可以在所有数字的向量中查找它们（类似于`strchr("0123456789ABCDEF",s[i])`），构建一个由字符代码索引的单个查找表，其中每个位置的每个数字的值（`digitvalue[s[i]]`after`int digitvalue[256]`已适当初始化），使用`switch (s[i])`带有 a 的语句`case`按照另一个答案中的建议为每个可能的数字添加标签，或者按照我上面的建议使用范围检查和算术。需要考虑的是选择哪个，以及为什么。请注意，这可能不是一个显而易见的选择，如果 ASCII 不是您选择的字符集，则最佳答案可能会有所不同。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-25T03:53:41.567

我可能没有做出很大的贡献，上面有很好的答案。但我会试一试。

正如其他人在我之前所做的那样，我将留下一些功能供您实现。

```
int htoi(const char* x)
{

        unsigned int current_position;/*current position is to be defined*/
        int prefixed=0;                                                         
        int dec=0;
        char* y = x;

        if (x && x+1 && (*(x+1)=='x' || *(x+1)=='X')){  /*Is 0x or 0X prefix present?*/
                prefixed= PREFIXED;             
        }

        if (prefixed) y+=2; /*Jumps over 0x or 0X*/     

        while (*y){
                /*getPos(const char*) and singleHexToDec(const char*,unsigned int) functions to be implemented*/
                current_position=getPos(y);
                dec+=singleHexToDec(y,current_position); 
        }
        return dec;
} 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-04-25T01:53:28.517

昨天我写了一个这样的函数。你可以在下面看到我的代码。

```
/* Converting a hex string to integer, assuming the heading 
   0x or 0X has already been removed and pch is not NULL */
int hex_str_to_int(const char* pch) {

    int value = 0;
    int digit = 0;

    for (; *pch; ++pch) {

        if (*pch >= '0' && *pch <= '9') {
            digit = (*pch - '0');
        } else if (*pch >= 'A' && *pch <= 'F') {
            digit = (*pch - 'A' + 10);
        } else if (*pch >= 'a' && *pch <= 'f') {
            digit = (*pch - 'a' + 10);
        } else {
            break;
        }

        // Check for integer overflow
        if ((value *= 16) < 0 || (value += digit) < 0) {
            return INT_MAX;
        }
    }

    return value;
} 
```

这是测试代码：

```
int main(void) {

    printf("%d %d\n", hex_str_to_int("0"), 0x0);
    printf("%d %d\n", hex_str_to_int("A"), 0xA);
    printf("%d %d\n", hex_str_to_int("10"), 0x10);
    printf("%d %d\n", hex_str_to_int("A1"), 0xA1);
    printf("%d %d\n", hex_str_to_int("AB"), 0xAB);
    printf("%d %d\n", hex_str_to_int("100"), 0x100);
    printf("%d %d\n", hex_str_to_int("1A2"), 0x1A2);
    printf("%d %d\n", hex_str_to_int("10A"), 0x10A);
    printf("%d %d\n", hex_str_to_int("7FFFFFF"), 0x7FFFFFF);
    printf("%d %d\n", hex_str_to_int("7FFFFFF1"), 0x7FFFFFF1);
    printf("%d %d\n", hex_str_to_int("7FFFFFF2"), 0x7FFFFFF2);
    printf("%d %d\n", hex_str_to_int("7FFFFFFE"), 0x7FFFFFFE);
    printf("%d %d\n", hex_str_to_int("7FFFFFFF"), 0x7FFFFFFF);
    printf("%d %d\n", hex_str_to_int("80000000"), 0x7FFFFFFF + 1);
    printf("%d %d\n", hex_str_to_int("80000001"), 0x7FFFFFFF + 2);

    printf("%d %d\n", hex_str_to_int("10AX"), 0x10A);   
    printf("%d %d\n", hex_str_to_int("203!"), 0x203);

    return 0;
} 
```

它输出以下值：

```
0 0
10 10
16 16
161 161
171 171
256 256
418 418
266 266
134217727 134217727
2147483633 2147483633
2147483634 2147483634
2147483646 2147483646
2147483647 2147483647
2147483647 -2147483648
2147483647 -2147483647
266 266
515 515 
```

# browser - 什么是用户代理？

> ID：788036
> 
> 赞同：2
> 
> 时间：2009-04-25T01:28:00.030
> 
> 标签：browser, user-agent

我看到许多 Web 开发工具可以让我改变这个叫做**用户代理**的东西。它是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-25T01:35:50.103

用户代理不会改变 Safari 呈现页面的方式，它只是改变 Safari 在发出 HTTP 请求和调用`navigator.userAgent`JavaScript 时所伪装的浏览器。一些网页服务器和网页上的一些 JavaScript 会根据用户代理改变他们的行为（这通常是一个坏主意），所以有时如果网页服务器给你一个页面说“对不起，你的浏览器不受支持” ，您可能希望将您的用户代理更改为 IE，以查看它是否真的有效，即使他们不支持它。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-05-03T05:07:42.907

也许我遗漏了一些东西，但是，这两个答案都没有真正*回答*最初的问题—— *“什么是用户代理？”* .

**答：**在万维网的上下文中，用户代理只是代表用户联系网络服务器的程序。大多数用户代理都是通用浏览器。搜索引擎蜘蛛很少。

**略长的答案：** [http ://en.wikipedia.org/wiki/User_agent](http://en.wikipedia.org/wiki/User_agent)

在您的问题的上下文中 - 工具允许我们更改的内容 -**用户代理**是指`user-agent`客户端程序随每个请求发送的 HTTP 标头以标识自己。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-25T01:36:24.957

用户代理切换不是“模式”，它所做的只是让 Safari 报告 IE/Firefox/etc 用户代理——因此 navigator.userAgent 将报告不同浏览器的 UA。

这仅在您考虑支持 safari（或一般的 webkit）并希望排除用户代理检查作为“不兼容”的原因时才真正有用

# process - 用于并行计算的 CPU 卡？

> ID：788040
> 
> 赞同：2
> 
> 时间：2009-04-25T01:33:04.697
> 
> 标签：process, parallel-processing, cpu

我记得前段时间读到，系统有 cpu 卡来增加额外的处理能力来进行大规模并行化。任何人都有这方面的经验和任何资源来研究项目的硬件和软件方面？这项技术是否不如传统集群？是不是更有权力意识？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-25T01:42:37.373

有两个很酷的选择。一种是 Mitch 提到的 GPU 的使用。另一种是获得具有多核 Cell 处理器的 PS/3。

您还可以设置多台廉价的主板 PC 并运行 Linux 和 Beowulf。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-25T01:41:32.447

您是否查看过各种[GPU 计算](http://www.nvidia.com/object/GPU_Computing.html)选项。[Nvidia](http://en.wikipedia.org/wiki/Nvidia_Tesla_Personal_Supercomputer)（可能还有其他公司）正在提供基于利用显卡功能的个人超级计算机。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-25T03:37:57.767

GPGPU 可能是发烧友最实用的选择。但是，DSP 是另一种选择，例如德州仪器、飞思卡尔、模拟设备和恩智浦半导体制造的那些。当然，其中大多数可能更多地针对工业用户，但您可能会研究[Storm-1](http://www.streamprocessors.com/streamprocessors/Home/Products/Storm-1Series.html)系列 DSP，其中一些价格应该低至每件 60 美元。

数据并行的另一个选择是物理处理单元，如 Nvidia（以前的 Ageia）PhysX。这些协处理器最明显的用途是用于游戏，但它们也用于科学建模、密码学和其他矢量处理应用程序。

[ClearSpeed 附加处理器](http://en.wikipedia.org/wiki/ClearSpeed)是另一种可能性。这些基本上是为 HPC 应用程序设计的 SIMD 协处理器，因此它们可能超出您的价格范围，但我只是在这里猜测。

所有这些建议都基于数据并行性，因为我认为这是最具潜力的领域。通过简单地利用矢量处理和更专业的 SIMD 指令集，*许多*当前 CPU 密集型应用程序可以在低得多的时钟速率（并且使用更少的功率）下更快地执行。

确实，大多数计算机用户只需要英特尔凌动处理器即可满足他们的大多数休闲计算需求：电子邮件、浏览网页和播放音乐/视频。而对于另外 10% 的实际确实需要大量处理能力的计算任务，通用标量处理器通常并不是完成这项工作的最佳工具。

即使是大多数确实有严重处理需求的人，也只需要它来进行范围很窄的应用；物理学家不需要能够播放最新 FPS 的 PC；音响工程师不需要进行科学建模或进行统计分析；并且图形设计师不需要进行数字信号处理。具有高度专业化指令集的特定领域矢量处理器（如用于游戏的现代 GPU）将能够比高功率通用 CPU 更有效地处理这些任务。

集群计算无疑对核研究等许多高端工业应用非常有用，但我认为矢量处理对普通人来说有更多的实际用途。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-08T16:21:38.153

OpenCL - 是跨不同供应商和处理器类型、单核、多核、显卡、单元等进行 HPC 计算的行业范围标准......请参阅[http://en.wikipedia.org/wiki/OpenCL](http://en.wikipedia.org/wiki/OpenCL)。

这个想法是，使用简单的代码库，您可以使用机器上的所有备用处理能力，而不管处理器类型如何。

Apple 已在其下一个版本的 Mac OS X 中实施了这一标准。nVIDIA、ATI、Intel 等也将提供该标准。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T14:40:42.830

[Mercury Computing](http://en.wikipedia.org/wiki/Mercury_Computer_Systems)提供了一个[Cell Accelerator Board](http://www.mc.com/products/boards/accelerator_board2.aspx)，它是一个带有 Cell 处理器的 PCIe 卡，运行 Yellow Dog Linux 或 Mercury 的 YDL 风格。Fixstars 提供更强大的 Cell PCIe 板，称为[GigaAccel](http://www.fixstars.com/en/products/gigaaccel180/index.html)。我打电话给 Mercury，他们说他们的板子大约 5000 美元，没有软件。我猜 GigaAccel 的价格要贵一倍。

我发现使用了其中一个 Mercury 板，但它没有附带电源线，所以我还不能使用它，很遗憾。

# silverlight - 免费/付费 Silverlight 视频播放器？

> ID：788060
> 
> 赞同：1
> 
> 时间：2009-04-25T01:53:07.723
> 
> 标签：silverlight, xaml, video, skins

我正在寻找一些漂亮的silverlight 视频播放器，可以在网站上使用。类似于这个关于 Flash 的问题：[https](https://stackoverflow.com/questions/167072/free-paid-flash-video-players) ://stackoverflow.com/questions/167072/free-paid-flash-video-players ，我正在寻找一些好的 Silverlight 皮肤。

有什么好的资源吗？我知道：

*   [http://www.longtailvideo.com/players/jw-wmv-player/](http://www.longtailvideo.com/players/jw-wmv-player/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-25T03:47:36.403

1.  [微软媒体平台播放器框架](http://smf.codeplex.com/releases/view/88970)
2.  [CodePlex 上的 Silverlight 2 视频播放器](http://sl2videoplayer.codeplex.com/)
3.  [Silverlight Tools for Visual Studio](http://www.microsoft.com/downloads/details.aspx?FamilyId=c22d6a7b-546f-4407-8ef6-d60c8ee221ed&displaylang=en)中的 ASP.Net MediaPlayer 控件有一些可以自定义的内置皮肤

# jquery - jQuery if then else 使用 URL parser 插件，一定有更优雅的解决方案

> ID：788068
> 
> 赞同：5
> 
> 时间：2009-04-25T01:58:12.703
> 
> 标签：jquery, url, parsing

这是我在这个相当有趣的网站上的第一篇文章，所以如果这已经在其他地方讨论过（如果有的话，我找不到）。

我正在使用此处找到的 JQuery URL 解析器插件：[http ://projects.allmarkedup.com/jquery_url_parser/](http://projects.allmarkedup.com/jquery_url_parser/)

我可以让它做我想做的事，但代码效率很低。单击相关标题时，我会打开一组隐藏的 div。我正在使用 URL 解析器，因此如果从另一个页面单击链接，则相关的 div 是可见的。

我的代码如下所示：

```
if 
(jQuery.url.attr('anchor') == 'question1'){
    $('#answer1').show();
}
else if
(jQuery.url.attr('anchor') == 'question2'){
    $('#answer2').show();
}
else if
(jQuery.url.attr('anchor') == 'question3'){
    $('#answer3').show();
}
else if
(jQuery.url.attr('anchor') == 'question4'){
    $('#answer4').show();
}
else if
(jQuery.url.attr('anchor') == 'question5'){
    $('#answer5').show();
}
else if
(jQuery.url.attr('anchor') == 'question6'){
    $('#answer6').show();
}
else if
(jQuery.url.attr('anchor') == 'question7'){
    $('#answer7').show();
}
else if
(jQuery.url.attr('anchor') == 'question8'){
    $('#answer8').show();
}; 
```

正如你所看到的，这是相当冗长的。我真正想要做的是获取 URL 末尾的数字并将其附加到#answer，这样事情就会更加紧凑。我试图将 (jQuery.url.attr('anchor') 的结果分配给一个变量，但我在完成此操作时遇到了一些麻烦。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-25T01:59:54.807

```
var match = jQuery.url.attr('anchor').match(/^question([0-9]+)$/);
if (match && match.length > 0) {
    $('#answer' + match[1] ).show();
} 
```

更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T02:37:55.197

对于这样的代码，您也可以在一行中执行此操作。

```
$('#answer' + $.url.attr('anchor').match(/question(\d+)|(.*)/)[1]).show(); 
```

现在，这种技术可能需要一些解释。基本上，您在这里所做的是试图找到一个包含 question(n) 的字符串，其中 'question(n)' 是第一个匹配项，而 (n) 是第二个匹配项。现在，如果没有找到，那么“ `|(.*)`”表示“或任何东西”，并且由于它包含在 () 中，所以 .* 任何东西都是第一个匹配项和第二个匹配项。

匹配成功，您正在调用

```
$('answer' + '1').show(); 
```

如果匹配失败，您正在调用

```
$('answer' + '').show();  // where $('answer' + '').length == 0 
```

什么都不做。

如果您想对它不区分大小写，请使用它作为您的正则表达式。

```
/question(\d+)|(.*)/i 
```

# jquery - jQuery 和 Wordpress

> ID：788071
> 
> 赞同：0
> 
> 时间：2009-04-25T02:02:03.630
> 
> 标签：jquery, wordpress

有人知道如何让 jQuery api 与 Wordpress 一起使用吗？我知道你可以在函数模板中添加一个动作，但是这个特定的主题模板不允许我添加它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T02:19:39.517

添加 jQuery 的最简单方法是使用 Google Ajax 库 API

```
<script src="http://www.google.com/jsapi"></script>
<script>
  google.load("jquery", "1");
</script> 
```

在您的主模板页面的 <head> 部分添加这些行，您应该可以立即使用 jQuery。

（我相信这需要您拥有对博客的 FTP 访问权限，或者至少可以访问主题编辑器，以便您可以自己编辑主要的 PHP 主题页面）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T16:20:08.293

你看到什么样的错误？`<?php wp_head(); ?>`您是否也在标题中调用 ？您是否还链接`< wp_enqueue_script('jquery'); ?>` ，它也加载 jquery？

# c# - WPF 与网络摄像头集成

> ID：788075
> 
> 赞同：1
> 
> 时间：2009-04-25T02:05:52.577
> 
> 标签：c#, wpf, webcam

如何集成 PictureBox 以通过 WPF 显示视频？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-25T16:28:37.090

也试试[WPF MediaKit](http://wpfmediakit.codeplex.com/)。WPF MediaKit 有一个 VideoCaptureElement 控件，用于支持网络摄像头！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-25T02:26:47.237

您可能不想使用 PictureBox 在 WPF 中显示图像，因为它是一个 Windows 窗体控件，因此受到互操作限制。

要在 WPF 中显示图像，请使用 Image 元素。通常将其 Source 设置为 BitmapImage，其 UriSource 是位图文件的 URI（可能位于文件系统上）。（如果这是与网络摄像头交互的更简单方法，您可以使用其他 ImageSource 类型。）

要显示视频，请使用 MediaElement 元素。要显示视频文件，请将 MediaElement 的 Source 属性设置为视频的 URI（也可能在文件系统上）。如果您需要从网络摄像头中提取图像以形成视频，则需要在“时钟模式”下使用 MediaElement，这在 MSDN 的 MediaElement 类主题中进行了描述。另请参阅 WPF SDK ( [http://msdn.microsoft.com/en-us/library/aa970915.aspx](http://msdn.microsoft.com/en-us/library/aa970915.aspx) ) 中的“多媒体概述”。

# c++ - 在 QTreeWidget 中插入时自动排序

> ID：788080
> 
> 赞同：2
> 
> 时间：2009-04-25T02:15:05.737
> 
> 标签：c++, qt, sorting, qtreewidget

我有一个插入项目的 QTreeWidget，用户可以选择一列对其进行排序。在插入项目时，它们只是被附加到末尾，而不是自动完成排序。如果我单击标题以在升序/降序之间切换，它将对当前项目进行排序。

我想我可以调用 sortItems() 并使用从 sortColumn() 返回的列，但是我看不到如何查看用户是在进行升序还是降序排序。

我不担心这样做的效率，所以我不想等到插入完成后再进行排序。我想要一个实时排序的列表。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-25T03:12:11.713

如果你的树小部件被称为treeWidget，你应该能够调用header()方法，它来自QTreeWidget的父QTreeView，然后来自QHeaderView类的sortIndicatorOrder()：

```
treeWidget->header()->sortIndicatorOrder() 
```

有了这个，你就知道了用户当前的排序顺序，你可以根据这个在插入上应用你的排序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-25T03:03:51.780

我没有用于测试的设置，但根据文档，这应该会导致在插入项目时进行排序。

```
...
treeWidget.sortByColumn(0, Qt::AscendingOrder); // column/order to sort by
treeWidget.setSortingEnabled(true);             // should cause sort on add 
```

Qt 建议不要这样做，因为这会降低性能，并说您应该在所有添加完成后启用排序。希望这可以帮助。

# python - 使用 python 和 sql 进行 Web 开发

> ID：788083
> 
> 赞同：1
> 
> 时间：2009-04-25T02:19:50.983
> 
> 标签：python

我需要建立一个具有以下功能的网站：1）我们预计每日流量较少的用户论坛 2）用户创建个人资料的数据库后端，他们可以登录并上传媒体（图片）3）用户可以使用他们的个人资料从在线库存中购买内容 4) 为在线库存创建网页、购物车等 5) 安全的在线信用卡处理

我对 python 非常熟悉，但对 python web 框架并不熟悉。我确实知道一些 SQL。我如何开始开发这样的东西？Django 是一个不错的选择吗？

本身与编程无关：您建议我在哪里获得具有此类应用程序域名的网络托管？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-25T02:25:12.077

[Django](http://www.djangoproject.com/)就是为这种事情而生的。看看这个。

至于托管，[djangofriendly.com](http://www.djangofriendly.com)是一个很好的资源。我以前使用[过 WebFaction](http://www.webfaction.com/?affiliate=paolob)，我非常喜欢让 Django 与他们一起使用以及他们出色的客户服务是多么容易。如果您要使用共享托管路线，则价格合理。

如果您希望加快所描述的某些任务，您应该查看[Pinax](http://pinaxproject.com/)和[Django Pluggables](http://djangoplugables.com/)。由于 Django 应用程序的设置方式，将应用程序插入项目非常容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T03:12:48.203

您可以尝试[Pylons](http://www.pylonshq.com/)轻量级 Web 框架。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-25T02:48:37.857

您的要求使[pinax](http://pinaxproject.com/)听起来像一个库，如果您走 django 路线，您可能想研究一下。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-25T16:37:33.307

Google App Engine 将免费提供托管以及 Django 和 db..

# python - 如何优化此 Python 代码以生成所有单词距离为 1 的单词？

> ID：788084
> 
> 赞同：32
> 
> 时间：2009-04-25T02:20:26.533
> 
> 标签：python, optimization, python-2.x, levenshtein-distance, word-diff

分析显示这是我编写的一个小文字游戏代码中最慢的部分：

```
def distance(word1, word2):
    difference = 0
    for i in range(len(word1)):
        if word1[i] != word2[i]:
            difference += 1
    return difference

def getchildren(word, wordlist):
    return [ w for w in wordlist if distance(word, w) == 1 ] 
```

笔记：

*   `distance()`被调用超过 500 万次，其中大部分来自 getchildren，它应该获取单词列表中与`word`恰好相差 1 个字母的所有单词。
*   wordlist 被预先过滤为仅包含包含相同数量字母的单词，`word`因此可以保证`word1`并且`word2`具有相同数量的字符。
*   我对 Python 相当陌生（3 天前开始学习它），所以对命名约定或其他样式的评论也很感激。
*   对于单词表，使用“2+2lemma.txt”文件获取[12dict 单词表](http://downloads.sourceforge.net/wordlist/12dicts-5.0.zip)

结果：

谢谢大家，结合不同的建议，我现在让程序运行速度提高了两倍（除了我在询问之前自己进行的优化，所以速度比我最初的实现提高了大约 4 倍）

我用两组输入进行了测试，我将它们称为 A 和 B

**优化 1：迭代 word1,2 的索引**... from

```
for i in range(len(word1)):
        if word1[i] != word2[i]:
            difference += 1
    return difference 
```

**迭代字母对**使用**`zip(word1, word2)`**

```
for x,y in zip (word1, word2):
        if x != y:
            difference += 1
    return difference 
```

输入 A 的执行时间从 11.92 到 9.18，输入 B 的执行时间从 79.30 到 74.59

优化 2：除了距离方法（我在其他地方仍然需要 A* 启发式）之外，还添加了一种单独的方法

```
def is_neighbors(word1,word2):
    different = False
    for c1,c2 in zip(word1,word2):
        if c1 != c2:
            if different:
                return False
            different = True
    return different 
```

输入 A 的执行时间从 9.18 到 8.83，输入 B 的执行时间从 74.59 到 70.14

优化3：这里的大赢家是使用`izip`而不是`zip`

输入 A 的执行时间从 8.83 到 5.02，输入 B 的执行时间从 70.14 到 41.69

我可能会更好地用较低级别的语言编写它，但我现在对此感到满意。谢谢大家！

再次编辑：更多结果使用 Mark 的方法检查第一个字母不匹配的情况使其从 5.02 -> 3.59 和 41.69 -> 29.82 下降

在此基础上并**合并`izip`而不是`range`**，我最终得到了这个：

```
def is_neighbors(word1,word2):
    if word1[0] != word2[0]:
        return word1[1:] == word2[1:]
    different = False
    for x,y in izip(word1[1:],word2[1:]):
        if x != y:
            if different:
                return False
            different = True
    return different 
```

挤压得更多，使时间从 3.59 -> 3.38 和 29.82 -> 27.88

甚至更多的结果！

尝试 Sumudu 的建议，即我**生成一个与“word”相差 1 个字母的所有字符串的列表，然后检查哪些字符串在 wordlist**中，而不是 is_neighbor 函数，我最终得到了这个：

```
def one_letter_off_strings(word):
    import string
    dif_list = []
    for i in xrange(len(word)):
        dif_list.extend((word[:i] + l + word[i+1:] for l in string.ascii_lowercase if l != word[i]))
    return dif_list

def getchildren(word, wordlist):
    oneoff = one_letter_off_strings(word)
    return ( w for w in oneoff if w in wordlist ) 
```

最终速度变慢了（3.38 -> 3.74 和 27.88 -> 34.40），但看起来很有希望。起初我认为我需要优化的部分是“one_letter_off_strings”，但分析显示并非如此，而且慢的部分实际上是

```
( w for w in oneoff if w in wordlist ) 
```

我想如果我切换“oneoff”和“wordlist”并在我正在寻找两个列表的交集时以另一种方式进行比较，是否会有任何区别。我用**字母上的 set-intersection**替换它：

```
return set(oneoff) & set(wordlist) 
```

砰！3.74 -> 0.23 和 34.40 -> 2.25

这真是令人惊讶，与我最初的幼稚实现的总速度差异：23.79 -> 0.23 和 180.07 -> 2.25，比原来的实现快大约 80 到 100 倍。

如果有人有兴趣，我会发表博客文章[来描述程序](http://davy8.wordpress.com/2009/04/25/detour-into-python-and-optimizations/)并[描述所做的优化](http://davy8.wordpress.com/2009/04/26/detour-into-python-and-optimizations-part-2/)，包括此处未提及的优化（因为它位于不同的代码部分中）。

**大辩论：**

好的，我和 Unknown 正在进行一场大辩论，您可以在[他的回答](https://stackoverflow.com/questions/788084/how-can-i-optimize-this-python-code/788090#788090)的评论中阅读。他声称，如果将其移植到 C 中，使用原始方法（使用 is_neighbor 而不是使用集合）会更快。我尝试了 2 个小时来获得我编写的 C 模块来构建和可链接，但在尝试后没有太大成功按照[这个](http://superjared.com/entry/anatomy-python-c-module/)和[这个](http://www.dalkescientific.com/writings/NBN/c_extensions.html)例子，看起来这个过程在Windows中有点不同？我不知道，但我放弃了。无论如何，这是程序的完整代码，文本文件来自[12dict单词列表](http://downloads.sourceforge.net/wordlist/12dicts-5.0.zip)使用“2+2lemma.txt”文件。对不起，如果代码有点乱，这只是我一起破解的。此外，我忘记从单词列表中删除逗号，因此这实际上是一个错误，您可以保留它以进行相同的比较，或者通过在 cleanentries 的字符列表中添加逗号来修复它。

```
from itertools import izip
def unique(seq):  
    seen = {} 
    result = [] 
    for item in seq: 
        if item in seen:
            continue 
        seen[item] = 1 
        result.append(item) 
    return result
def cleanentries(li):
    pass
    return unique( [w.strip('[]') for w in li if w != "->"] )
def distance(word1, word2):
    difference = 0
    for x,y in izip (word1, word2):
        if x != y:
            difference += 1
    return difference
def is_neighbors(word1,word2):
    if word1[0] != word2[0]:
        return word1[1:] == word2[1:]
    different = False
    for x,y in izip(word1[1:],word2[1:]):
        if x != y:
            if different:
                return False
            different = True
    return different
def one_letter_off_strings(word):
    import string
    dif_list = []
    for i in xrange(len(word)):
        dif_list.extend((word[:i] + l + word[i+1:] for l in string.ascii_lowercase if l != word[i]))
    return dif_list

def getchildren(word, wordlist):
    oneoff = one_letter_off_strings(word)
    return set(oneoff) & set(wordlist)
def AStar(start, goal, wordlist):
    import Queue
    closedset = []
    openset = [start]
    pqueue = Queue.PriorityQueue(0)
    g_score = {start:0}         #Distance from start along optimal path.
    h_score = {start:distance(start, goal)}
    f_score = {start:h_score[start]}
    pqueue.put((f_score[start], start))
    parent_dict = {}
    while len(openset) > 0:
        x = pqueue.get(False)[1]
        if x == goal:
            return reconstruct_path(parent_dict,goal)
        openset.remove(x)
        closedset.append(x)
        sortedOpen = [(f_score[w], w, g_score[w], h_score[w]) for w in openset]
        sortedOpen.sort()
        for y in getchildren(x, wordlist):
            if y in closedset:
                continue
            temp_g_score = g_score[x] + 1
            temp_is_better = False
            appended = False
            if (not y in openset): 
                openset.append(y)
                appended = True
                h_score[y] = distance(y, goal)
                temp_is_better = True
            elif temp_g_score < g_score[y] :
                temp_is_better = True
            else :
                pass
            if temp_is_better:
                parent_dict[y] = x
                g_score[y] = temp_g_score
                f_score[y] = g_score[y] + h_score[y]
                if appended :
                    pqueue.put((f_score[y], y))
    return None

def reconstruct_path(parent_dict,node):
     if node in parent_dict.keys():
         p = reconstruct_path(parent_dict,parent_dict[node])
         p.append(node)
         return p
     else:
         return []        

wordfile = open("2+2lemma.txt")
wordlist = cleanentries(wordfile.read().split())
wordfile.close()
words = []
while True:
    userentry = raw_input("Hello, enter the 2 words to play with separated by a space:\n ")
    words = [w.lower() for w in userentry.split()]
    if(len(words) == 2 and len(words[0]) == len(words[1])):
        break
print "You selected %s and %s as your words" % (words[0], words[1])
wordlist = [ w for w in wordlist if len(words[0]) == len(w)]
answer = AStar(words[0], words[1], wordlist)
if answer != None:
    print "Minimum number of steps is %s" % (len(answer))
    reply = raw_input("Would you like the answer(y/n)? ")
    if(reply.lower() == "y"):
        answer.insert(0, words[0])
        print "\n".join(answer)
    else:
        print "Good luck!"
else:
    print "Sorry, there's no answer to yours"
reply = raw_input("Press enter to exit") 
```

我留下了 is_neighbors 方法，即使它没有被使用。这是建议移植到 C 的方法。要使用它，只需将 getchildren 替换为：

```
def getchildren(word, wordlist):
    return ( w for w in wordlist if is_neighbors(word, w)) 
```

至于让它作为 C 模块工作，我并没有那么远，但这就是我想出的：

```
#include "Python.h"

static PyObject *
py_is_neighbor(PyObject *self, Pyobject *args)
{
    int length;
    const char *word1, *word2;
    if (!PyArg_ParseTuple(args, "ss", &word1, &word2, &length))
        return NULL;

    int i;
    int different = 0;
    for (i =0; i < length; i++)
    {
        if (*(word1 + i) != *(word2 + i))
        {
            if (different)
            {
                return Py_BuildValue("i", different);
            }
            different = 1;
        }
    }
    return Py_BuildValue("i", different);
}

PyMethodDef methods[] = {
    {"isneighbor", py_is_neighbor, METH_VARARGS, "Returns whether words are neighbors"},
    {NULL, NULL, 0, NULL}
};

PyMODINIT_FUNC
initIsNeighbor(void)
{
    Py_InitModule("isneighbor", methods);
} 
```

我使用以下方法对此进行了分析：

> python -m cProfile "Wordgame.py"

记录的时间是AStar方法调用的总时间。快速输入集是“诗歌诗人”，而长输入集是“诗人诗歌”。不同机器之间的时间显然会有所不同，因此如果有人最终尝试这样做，请按原样比较程序的结果，以及与 C 模块的比较。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-25T07:38:18.173

如果您的单词列表很长，从“单词”生成所有可能的 1 个字母差异，然后检查列表中的哪些可能会更有效？我不知道任何 Python，但应该有一个合适的数据结构用于 wordlist 允许日志时间查找。

我建议这样做是因为如果您的单词长度合理（约 10 个字母），那么您只会寻找 250 个潜在单词，如果您的单词列表大于几百个单词，这可能会更快。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-25T02:30:29.147

`distance`当您真正只关心距离 = 1 时，您的函数正在计算总距离。大多数情况下，您会在几个字符内知道它 >1，因此您可以提前返回并节省大量时间。

除此之外，可能还有更好的算法，但我想不出。

**编辑：**另一个想法。

您可以制作 2 种情况，具体取决于第一个字符是否匹配。如果不匹配，则单词的其余部分必须完全匹配，您可以一次性测试。否则，请按照您所做的类似方式进行操作。您甚至可以递归地执行此操作，但我认为这不会更快。

```
def DifferentByOne(word1, word2):
    if word1[0] != word2[0]:
        return word1[1:] == word2[1:]
    same = True
    for i in range(1, len(word1)):
        if word1[i] != word2[i]:
            if same:
                same = False
            else:
                return False
    return not same 
```

**编辑2：**我已经删除了检查字符串是否相同长度的检查，因为你说它是多余的。在我自己的代码和 MizardX[提供](https://stackoverflow.com/questions/788084/how-can-i-optimize-this-python-code/788113#788113)的 is_neighbors 函数上运行[Ryan 的测试](https://stackoverflow.com/questions/788084/how-can-i-optimize-this-python-code/788168#788168)，我得到以下信息：

*   原始距离（）：3.7秒
*   My DifferentByOne()：1.1 秒
*   MizardX 的 is_neighbors()：3.7 秒

**编辑3：（**可能在这里进入社区维基领域，但是......）

尝试使用 izip 而不是 zip 对 is_neighbors() 的最终定义：2.9 秒。

这是我的最新版本，仍然是 1.1 秒：

```
def DifferentByOne(word1, word2):
    if word1[0] != word2[0]:
        return word1[1:] == word2[1:]
    different = False
    for i in range(1, len(word1)):
        if word1[i] != word2[i]:
            if different:
                return False
            different = True
    return different 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-25T02:41:49.370

```
from itertools import izip

def is_neighbors(word1,word2):
    different = False
    for c1,c2 in izip(word1,word2):
        if c1 != c2:
            if different:
                return False
            different = True
    return different 
```

或者也许内联`izip`代码：

```
def is_neighbors(word1,word2):
    different = False
    next1 = iter(word1).next
    next2 = iter(word2).next
    try:
        while 1:
            if next1() != next2():
                if different:
                    return False
                different = True
    except StopIteration:
        pass
    return different 
```

并重写`getchildren`：

```
def iterchildren(word, wordlist):
    return ( w for w in wordlist if is_neighbors(word, w) ) 
```

*   [`izip(a,b)`](http://docs.python.org/library/itertools.html#itertools.izip)`a`从和中返回值对的迭代器`b`。
*   [`zip(a,b)`](http://docs.python.org/library/functions.html#zip)`a`返回和的对列表`b`。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-25T03:25:37.377

人们主要是通过尝试编写一个更快的函数来解决这个问题，但可能还有另一种方式..

> “距离”被调用超过 500 万次

为什么是这样？也许更好的优化方法是尝试减少对 的调用次数`distance`，而不是减少几毫秒的`distance's`执行时间。没有看到完整的脚本就无法判断，但是优化特定功能通常是不必要的。

如果这是不可能的，也许你可以把它写成一个 C 模块？

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-25T03:14:32.177

使用相同参数调用距离函数的频率是多少？一个简单的实现优化是使用[memoization](http://code.activestate.com/recipes/466320/)。

您可能还可以创建某种字典，其中包含冻结的字母集和相差一个的单词列表，并在其中查找值。该数据结构可以通过 pickle 存储和加载，也可以在启动时从头开始生成。

短路评估只会在您使用的单词很长时给您带来收益，因为您使用的汉明距离算法基本上是 O(n)，其中 n 是单词长度。

我对 timeit 进行了一些实验，以获得一些可能具有说明性的替代方法。

# 时间结果

## 您的解决方案

```
d = """\
def distance(word1, word2):
    difference = 0
    for i in range(len(word1)):
        if word1[i] != word2[i]:
            difference += 1
    return difference
"""
t1 = timeit.Timer('distance("hello", "belko")', d)
print t1.timeit() # prints 6.502113536776391 
```

## 一个班轮

```
d = """\
from itertools import izip
def hamdist(s1, s2):
    return sum(ch1 != ch2 for ch1, ch2 in izip(s1,s2))
"""
t2 = timeit.Timer('hamdist("hello", "belko")', d)
print t2.timeit() # prints 10.985101179 
```

## 捷径评估

```
d = """\
def distance_is_one(word1, word2):
    diff = 0
    for i in xrange(len(word1)):
        if word1[i] != word2[i]:
            diff += 1
        if diff > 1:
            return False
    return diff == 1
"""
t3 = timeit.Timer('hamdist("hello", "belko")', d)
print t2.timeit() # prints 6.63337 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-25T02:27:44.787

好吧，如果差异为 2 或更多，您可以先中断循环。

你也可以改变

```
for i in range(len(word1)): 
```

到

```
for i in xrange(len(word1)): 
```

因为 xrange 按需生成序列，而不是一次生成整个数字范围。

您也可以尝试比较字长，这样会更快。另请注意，如果 word1 大于 word2，您的代码将不起作用

在那之后你可以在算法上做的事情不多，也就是说，通过将该部分移植到 C 中，你可能会发现更多的加速。

**编辑 2**

试图解释我对 Sumudu 算法的分析与逐个字符验证差异的比较。

当您有一个长度为 L 的单词时，您将生成的“相差一个”单词的数量将是 25L。我们从现代计算机上的集合实现中知道，搜索速度大约是**log(n) base 2**，其中 n 是要搜索的元素数。

看到你测试的 500 万个单词中的大部分**都不**在集合中，大多数时候，你会遍历整个集合，这意味着它真的变成了**log(25L)**而不仅仅是 log(25L)/2。（这是假设集合的最佳情况，逐个字符串比较等同于逐个字符比较）

现在我们来看看确定“逐个不同”的时间复杂度。如果我们假设您必须检查整个单词，那么每个单词的操作数变为**L**。我们知道大多数单词很快就会相差 2。并且知道大多数前缀只占单词的一小部分，我们可以从逻辑上假设您大部分时间会被**L/2**或一半单词打破（这是一个保守的估计）。

所以现在我们绘制两个搜索的时间复杂度，L/2 和 log(25L)，并记住，**这甚至考虑到字符串匹配与字符匹配相同的速度**（非常有利于集合）。您有方程 log(25*L) > L/2，可以简化为 log(25) > L/2 - log(L)。从图中可以看出，使用 char 匹配算法应该更快，直到达到*非常*大的 L。

![替代文字](https://imgur.com/27AUC.png)

> 另外，我不知道您是否指望优化中的差异为 2 或更多，但从马克的回答中，我已经打破了 2 或更多的差异，实际上，如果第一个字母的差异，它在第一个字母之后中断，即使进行了所有这些优化，更改为使用集合只是将它们从水中吹走。不过我有兴趣尝试你的想法

我是这个问题中第一个建议打破 2 或更多差异的人。问题是，Mark 对字符串切片的想法（如果 word1[0] != word2[0]: return word1[1:] == word2[1:]）只是将我们正在做的事情放到 C 中。你怎么样认为*word1[1:] == word2[1:]*是计算出来的？就像我们正在做的一样。

> 我看了你的解释几次，但我不太明白，你介意再深入解释一下吗？此外，我对 C 不是很熟悉，过去几年我一直在使用高级语言（最接近的是 6 年前在高中学习 C++

至于制作C代码，我有点忙。我相信您将能够做到这一点，因为您以前用 C 编写过。您也可以尝试 C#，它可能具有类似的性能特征。

**更多解释**

这是对Davy8的更深入的解释

```
def getchildren(word, wordlist):
    oneoff = one_letter_off_strings(word)
    return set(oneoff) & set(wordlist) 
```

您的 one_letter_off_strings 函数将创建一组 25L 字符串（其中 L 是字母数）。

从单词表中创建一个集合将创建一组 D 字符串（其中 D 是字典的长度）。通过从中创建一个交集，您**必须**遍历每个**oneoff**并查看它是否存在于**wordlist**中。

此操作的时间复杂度在上面详细说明。此操作的效率低于将您想要的单词与 wordlist 中的每个单词**进行****比较**。Sumudu 的方法是 C 语言而不是算法的优化。

**更多解释2**

> 总共只有 4500 个单词（因为在传递给算法之前，单词列表已经预先过滤了 5 个字母的单词），与 125 个单字母单词相交。似乎您说的交集是 log(smaller) 或者换句话说 log(125, 2)。将此与再次假设您所说的进行比较，在比较 L/2 字母中的单词中断时，我会将其四舍五入为 2，即使对于 5 个字母的单词，它更有可能是 3。这种比较进行了 4500 次，所以 9000。log(125,2) 大约是 6.9，log(4500,2) 大约是 12。让我知道我是否误解了你的数字。

要创建 125 个单字母单词与 4500 个字典的交集，您需要进行 125 * 4500 次比较。这不是 log(125,2)。假设字典是预先排序的，最好是 125 * log(4500, 2)。*集合没有神奇的捷径。*您还在这里逐个字符串而不是逐个字符进行比较。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-25T02:44:00.177

对于这样一个具有如此大的性能影响的简单函数，我可能会制作一个 C 库并使用[ctypes](http://docs.python.org/library/ctypes.html)调用它。reddit 的一位创始人声称，他们使用这种技术使网站的速度提高了 2 倍。

您也可以在此功能上使用[psyco](http://psyco.sourceforge.net/)，但要注意它会占用大量内存。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-25T02:29:48.227

我不知道它是否会显着影响您的速度，但您可以先将列表理解转换为生成器表达式。它仍然是可迭代的，所以在使用上应该没有太大的不同：

```
def getchildren(word, wordlist):
    return [ w for w in wordlist if distance(word, w) == 1 ] 
```

到

```
def getchildren(word, wordlist):
    return ( w for w in wordlist if distance(word, w) == 1 ) 
```

主要问题是列表推导会在内存中构建自身并占用相当多的空间，而生成器将动态创建您的列表，因此无需存储整个内容。

此外，根据未知的答案，这可能是一种更“pythonic”的写距离（）的方式：

```
def distance(word1, word2):
    difference = 0
    for x,y in zip (word1, word2):
        if x == y:
            difference += 1
    return difference 
```

但是当 len (word1) != len (word2) 时，它的意图令人困惑，在 zip 的情况下，它只会返回与最短单词一样多的字符。（这可能是一种优化......）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-25T02:48:35.030

试试这个：

```
def distance(word1, word2):
  return sum([not c1 == c2 for c1, c2 in zip(word1,word2)]) 
```

另外，你的游戏有链接吗？我喜欢被文字游戏摧毁

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-25T04:55:54.303

我首先想到的是：

```
from operator import ne

def distance(word1, word2):
    return sum(map(ne, word1, word2)) 
```

它很有可能比人们发布的其他函数更快，因为它没有解释循环，只是调用 Python 原语。它足够短，您可以合理地将其内联到调用者中。

对于您的更高级别的问题，我会研究为度量空间中的相似性搜索而开发的数据结构，例如[本文](http://www.citeulike.org/user/vi_z/article/3243208)或[这本书](http://www.nmis.isti.cnr.it/amato/similarity-search-book/)，我都没有读过（他们是在搜索我读过的论文时出现的）但不记得了）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-08-19T17:41:47.787

对于这个片段：

```
for x,y in zip (word1, word2):
    if x != y:
        difference += 1
return difference 
```

我会用这个：

```
return sum(1 for i in xrange(len(word1)) if word1[i] == word2[i]) 
```

提供的代码将遵循相同的模式...

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-10-14T20:54:28.553

其他人只关注显式距离计算，而没有做任何关于构建距离 1 候选的事情。**[您可以通过使用称为Trie](https://stackoverflow.com/search?q=%5Bpython%5D+trie)**的著名数据结构将**隐式距离计算**与**生成所有距离为 1 的相邻词**的任务合并来进行改进。Trie 是一个链表，其中每个节点代表一个字母，“next”字段是一个最多包含 26 个条目的 dict，指向下一个节点。

这是伪代码：为给定的单词迭代遍历 Trie；在每个节点将所有距离为 0 和距离为 1 的邻居添加到结果中；保持距离计数器并减少它。您不需要递归，只需一个查找函数，它需要一个额外的 distance_so_far 整数参数。

通过为长度为 3、长度为 4、长度为 5 等单词构建单独的尝试，可以获得 O(N) 空间增加的额外速度的小权衡。

# iphone - UIButton 延迟状态更改

> ID：788085
> 
> 赞同：19
> 
> 时间：2009-04-25T02:22:22.503
> 
> 标签：iphone

我在 a 中有一个`UIButton`子视图`UITableViewCell`。

触摸此按钮时，用户必须按住按钮约半秒钟，按钮的图像才能变为`UIControlStateHighlighted`图像。

这意味着如果用户只是像通常情况下那样点击按钮，则永远不会显示突出显示的状态。

为什么会发生这种情况，我该如何解决？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2011-11-29T08:02:36.523

我刚遇到这个问题，看到这个问题还没有关闭。折腾了一段时间后，我找到了解决办法。

现在您可以通过关闭 delaysContentTouches 或取消选中 tableview 上的“延迟内容触摸”框来解决此问题。

唯一的负面影响是用户将无法点击按钮并启动滚动手势。但是，如果用户尝试从本身不接受触摸的任何地方开始滚动，则行为应该与以前相同。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-22T18:12:53.570

等待大卫霍奇的回答。

我只想添加一种方法来消除 David 已经描述的“唯一的负面影响”：如果您开始在 UIScrollView 中的 UIcontrol 内滚动且 delayContentTouches=NO，滚动将不起作用。

**解决方案** 子类 UIScrollView （或 UITableView 作为原始问题）并覆盖：

```
-(BOOL) touchesShouldCancelInContentView:(UIView *)view {   
return YES; 
} 
```

UIScrollView/UITableView 中的 UIControls 将在点击时立即更改其状态，并且即使在某些 UIControl 上开始触摸，滚动视图也将能够滚动。奇迹般有效。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-12-31T06:36:00.470

问题是您的 UIButton 在 UITableView 内。这意味着表格视图必须确定您的点击是滑动还是只是针对按钮的点击。表格视图必须延迟向 UIButton 发送消息，直到它知道用户不打算滑动并因此滚动视图而不是按下按钮。

如果您不需要表格视图，请摆脱 UITableView。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-04-22T22:52:49.730

I just change the image from within the target action method:

```
[sender setBackgroundImage:[UIImage imageNamed:@"highlighted-image.png"] forState:UIControlStateNormal]; 
```

It changes the background image instantly.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-25T21:17:16.630

编辑：在对问题的误解后完全重写

UIButton 的一种思考方式是设置屏幕区域的简写方式，该区域可以响应各种瞬时触摸事件，它做出的响应由 UIControl 的 Target-Action 系统定义，用于将消息传递给其他对象。

`UIControlEventTouchDown`听起来像你需要回应的那个。只要有人在您的按钮内部触摸，它就会被触发 - 这就是 SMS 中的“联系信息”按钮的作用。

UIButton* myButton = [[UIButton buttonWithType:UIButtonTypeRoundedRect]; // 设置标题、框架等 [myButton addTarget:self action:@selector(myButtonWasPressed) forControlEvents: UIControlEventTouchDown]; [myMainView addSubView:myButton];

将向运行此代码的对象发送`-(void)myButtonWasPressed`消息（理想情况下，您查看控制器）。然后，`myButtonWasPressed`您可以添加新视图或执行您喜欢的任何操作。SMS 应用程序使用导航控制器推送视图控制器以显示联系人信息。

如果这仍然不能解决您的问题，您将不得不发布一些代码以便更深入地了解问题所在。

# apache-flex - 在表示模型中处理客户端域对象状态

> ID：788087
> 
> 赞同：0
> 
> 时间：2009-04-25T02:23:59.070
> 
> 标签：apache-flex, design-patterns, dns, presentation-model

我目前正在使用演示模型模式构建 Flex/PHP 项目的客户端。

**我想要实现的目标：**
我目前有一个视图显示有关名为 Node.js 的域对象的不可编辑信息。根据节点是否可编辑以及用户是否具有正确的权限，可以在其中更改此对象的附加视图可用。一旦用户决定“保存更改”，所做的任何更改才会提交给服务器。如果对 NodeA 进行了更改并且用户导航到不同的 NodeB 而不保存它们，则 NodeA 将恢复到其原始状态。

**设计：**
我有一个信息视图的 PM，其中包含对当前节点的引用。编辑视图的 PM 是从这个 info PM 扩展而来的，添加了对包装的 Node 对象进行更改的方法。两个 PM 都注入了​​相同的节点引用，并且 info/edit 视图中的所有字段都通过它们的 PM 绑定到节点。

**问题：**
当用户对 NodeA 进行更改但没有提交时，我似乎想不出一个优雅的解决方案来恢复到原始状态。基本上，到目前为止我想到的是在编辑 PM 上保存单独的值副本，或者克隆创建一个新的节点引用，或者通过一组相同的节点属性。在这两个中，前者似乎是更好的主意，因为 Node 已经包含域逻辑，但我想知道创建唯一域对象的克隆是否是一种不好的做法，即使它在有限的范围内使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T14:40:15.850

我通过将原始数据存储在值对象（“VO”）的 XML 属性中来处理类似情况，并在需要 VO 时重置所有其他属性值。

因此，当第一次需要查看它时，我会获取 XML：

```
<Node>
    <prop1>value</prop1>
    <prop2>value</prop2>
    <prop3>value</prop3>
    <prop4>value</prop4>
</Node> 
```

当我在结果处理程序中检索 XML 时，我做的第一件事是创建我的 VO 的实例，并设置 XML 属性，然后在单独的类中调用公共函数来设置 VO 的属性：

```
private function getNodeResultHandler(event:ResultEvent):void
{
    var myNode:Node = new Node();

    myNode.xmlData = new XML(event.result);

    nodeUtils.setNodeProperties(myNode);
}

public class nodeUtils
{
    public function setNodeProperties(node:Node):void
    {
        var nodeXmlData:XML = node.xmlData;

        myNode.prop1 = nodeXmlData.prop1;

        myNode.prop2 = nodeXmlData.prop2;

        myNode.prop3 = nodeXmlData.prop3;

        myNode.prop4 = nodeXmlData.prop4;
    }
} 
```

然后，每当您将视图切换到编辑模式时，您都会调用相同的函数将属性重置为存储在 XML 中的值。

您唯一需要做的另一件事是在用户提交对 VO 的更改时重置该 XML。我通常通过在 Save and Get 上以相同格式传回 VO 的数据来处理这个问题，然后像上面一样保存 XML。

我通常在 Cairngorm MVC 应用程序中执行此操作，因此我有事件/命令链来处理所有这些，但您可以将此功能放在任意数量的类中，或者放在 VO 类本身中，以您最容易维护的为准。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T05:22:11.510

每个视图都应该有它自己的 Presentation Model 类的实例。如果用户在移动到另一个视图时没有保存它，只需将其保存在内存中。克隆通过更复杂的过程完成了基本相同的事情。

# ruby-on-rails - Rails has_and_belongs_to_many 跨 3 个表连接

> ID：788092
> 
> 赞同：2
> 
> 时间：2009-04-25T02:29:33.347
> 
> 标签：ruby-on-rails, join, many-to-many

我有三个模型：列表、类别和站点。列表和网站之间存在多对多关系，列表和类别之间存在多对多关系。因此，一个列表属于一个或多个站点和一个或多个类别（一个列表可以出现在多个站点和多个类别上）。

给定一个站点 ID 和一个类别 ID，我想要一组所有列表。我了解如何从站点 id (listings = site.listings) 中获取列表以及如何从类别 id (listings = category.listings) 中获取列表，但是如何从列表中获取列表集的三重连接站点 ID 和类别 ID？

sql看起来像（输入sit_id和cat_id）： select l.name from Listings l, categories_listings cl, listings_sites, ls where cl.category_id = cat_id and ls.site_id = sit_id and cl.listing_id = l.id and ls .listing_id = l.id

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-25T09:10:50.307

您可能需要执行 has_many :through 并通过将 belongs_to 指定给父表来定义模型中的连接表。

```
课堂作业：作业
  结尾
  类项目：作业
  结尾

```

这个 [link][1] 也可能有帮助。

干杯和好运。

[1]：帮助？[Rails：has_many :through 还是 has_many_and_belongs_to？](https://stackoverflow.com/questions/472227/rails-hasmany-through-or-hasmanyandbelongsto)

# mysql - MySQL在Group By查询中选择错误的列值

> ID：788095
> 
> 赞同：2
> 
> 时间：2009-04-25T02:31:23.497
> 
> 标签：mysql, database, select, group-by

这是我遇到的一个真正的 MySQL 查询问题。

我正在编写的游戏中有一张高分表。高分数据库记录名称、级别和达到的分数。数据库中有许多近乎重复的内容。例如：

```
Name | Level | Score | Timestamp (key)
Bob    2       41    | 1234567.890
Bob    3       15    | 1234568.890
Bob    3       20    | 1234569.890
Joe    2       40    | 1234561.890
Bob    3       21    | 1234562.890
Bob    3       21    | 1234563.890 
```

我想返回一个“达到的最高水平”高分列表，输出类似于：

```
Name | Level | Score
Bob    3       21
Joe    2       40 
```

我目前使用的 SQL 查询是：

```
SELECT *, MAX(level) as level 
FROM highscores 
GROUP BY name
ORDER BY level DESC, score DESC
LIMIT 5 
```

然而，这并不完全奏效。“Score”字段输出似乎总是从组中随机抽取，而不是获取所达到的最高级别的相应分数。例如：

```
Name | Level | Score
Bob    3       41
Joe    2       40 
```

Bob 在第 3 级时从未得到 41 分！我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T02:50:43.873

您需要使用子查询来提取分数。

```
select distinct
    name, 
    max(level) as level,
    (select max(score) from highscores h2 
        where h2.name = h1.name and h2.level = h1.level) as score
from highscores h1 
group by name 
order by level desc, score desc 
```

干杯，

埃里克

让我感到恼火的是，当我发布答案时，我没有花时间解释为什么会出现这种情况，所以这里是：

当您拉回所有内容 (*)，然后是最大级别时，您将得到的是按顺序排列的每条记录，加上一个带有最大级别的列。请注意，您没有按分数进行分组（这会给您 Bob 2 41 和 Bob 3 21 - 我们的朋友 Bob 的两条记录）。

那么，我们到底该如何解决这个问题呢？你需要做一个子查询来额外过滤你的结果，这就是 (select max(score)...) 是什么。现在，对于读取 Bob 的每一行，您将获得他的最高级别 (3)，以及他在该级别的最高分数 (21)。但是，无论 Bob 有多少行，这仍然给了我们（例如，如果他有 5 行，您将得到 Bob 3 21 的 5 行）。要将其限制为仅最高分，我们需要在 select 语句中使用 DISTINCT 子句以仅返回唯一行。

更新：正确的 SQL（不能评论 le dorfier 的帖子）：

```
SELECT h1.Name, h1.Level, MAX(h1.Score)
    FROM highscores h1
    LEFT OUTER JOIN highscores h2 ON h1.name = h2.name AND h1.level < h2.level
    LEFT OUTER JOIN highscores h3 ON h1.name = h3.name AND h2.level = h3.level AND h1.score < h3.score
    WHERE h2.Name IS NULL AND h3.Name IS NULL
    GROUP BY h1.Name, h1.Level 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T03:42:51.890

这是有效的。

SELECT h1.Name, h1.Level, h1.Score
FROM highscores h1
LEFT JOIN highscores h2 ON h1.name = h2.name AND h1.level < h2.level
LEFT JOIN highscores h3 ON h1.name = h3.name AND h1。 level = h3.level AND h1.score < h3.score 其中
h2.id 为空且 h3.id 为空

您正在寻找该用户没有更高级别的级别/分数，并且该级别没有更高的分数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-25T07:51:47.940

有趣的问题。这是另一个解决方案：

```
SELECT hs.name, hs.level, MAX(score) AS score
FROM highscores hs
INNER JOIN (
  SELECT name, MAX(level) AS level FROM highscores GROUP BY name
) hl ON hl.name = hs.name AND hl.level = hs.level
GROUP BY hs.name, hs.level; 
```

就个人而言，我觉得这最容易理解，我的直觉是数据库执行起来会相对高效。

我最喜欢上面的查询，但只是为了好玩……我发现下面的查询以一种笨拙的方式很有趣。假设分数不能超过 99999...

```
SELECT name, level, score
FROM highscores hs
INNER JOIN (
  SELECT name, MAX(level * 100000 + score) AS hfactor
  FROM highscores GROUP BY name
) hf ON hf.hfactor = hs.level * 100000 + hs.score AND hf.name = hs.name; 
```

# asp.net - ASP.NET 如何从 input type='image' 控件中删除 'style' 属性？

> ID：788096
> 
> 赞同：4
> 
> 时间：2009-04-25T02:32:40.093
> 
> 标签：asp.net, css, attributes

我正在使用 asp:ImageButton 服务器控件；我将 CssClass 属性设置为我的 CSS 样式，我在其中定义了边框：实心 1px 红色；

.NET**自动**呈现内联“样式”属性，如下所示：

```
 style="border-width:0px;" 
```

Q1。我可以删除自动内联“样式”吗？例如在 PreRender 上可能检查 HTML 并编辑它？我已经尝试过 Attributes.Remove("style") 但这不起作用（奇怪的是也不会出错），而且我记得在某处读过我只能删除我手动添加的属性。

我的解决方法是在 aspx 页面中分配 BorderWidth=1px 属性，但是如果无论如何（自动！）Bug 或 Feature 都将覆盖它，那么提供 CssClass 属性有什么意义呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-25T02:55:49.350

他们这样做的原因是由于 HTML 的遗留问题，其中图像在有`<a>`标签包装时默认有边框。在大多数情况下，人们不想要这些边界，这就是 ASP.NET 这样做的原因。为了解决这个问题，您可以在样式表中执行以下操作（假设您正在设置`cssclass='redborderbutton'`）：

```
.redborderbutton img
{
  border:solid 1px red !important;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T03:10:10.050

您可以使用 HTML 服务器控件。

```
<input id="Image1" runat="server" name="ImageButton1" src="images\image.jpg" type="image" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-25T02:55:20.273

渲染后，您可以使用 JQuery 将其删除。

```
$(document).ready(function() { $("img").removeAttr('style'); } 
```

用 css 样式选择器替换“img”——但保留引号。

实际上，我在 asp.net 中经常这样做以“修复”asp.net 的默认呈现

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-17T19:22:31.260

ASP 是有史以来最骇人听闻的标签集。即使边框是“遗留的”，也可以在 CSS 中解决。

# delphi - 将带逗号的字符串转换为浮点数

> ID：788098
> 
> 赞同：12
> 
> 时间：2009-04-25T02:33:02.807
> 
> 标签：delphi, regional

是否有内置的 Delphi 函数可以将诸如 '3,232.00' 之类的字符串转换为浮点数？StrToFloat 由于逗号而引发异常。或者是先去掉逗号然后再做 StrToFloat 的唯一方法？

谢谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-25T06:56:36.620

你知道吗，那个'。是小数分隔符，',' 是千位分隔符（总是）？如果是这样，那么您应该填写 TFormatSettings 记录并将其传递给 StrToFloat。

```
FillChar(FS, SizeOf(FS), 0);
... // filling other fields
FS.ThousandSeparator := ',';
FS.DecimalSeparator := '.';
V := StrToFloat(S, FS); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-25T03:26:27.873

下面是我使用的。可能有更有效的方法，但这对我有用。简而言之，不，我不知道有任何内置的 delphi 函数可以将包含逗号的字符串浮点数转换为浮点数

```
{~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  safeFloat

  Strips many bad characters from a string and returns it as a double.
}
function safeFloat(sStringFloat : AnsiString) : double;
var
  dReturn : double;

begin
  sStringFloat := stringReplace(sStringFloat, '%', '', [rfIgnoreCase, rfReplaceAll]);
  sStringFloat := stringReplace(sStringFloat, '$', '', [rfIgnoreCase, rfReplaceAll]);
  sStringFloat := stringReplace(sStringFloat, ' ', '', [rfIgnoreCase, rfReplaceAll]);
  sStringFloat := stringReplace(sStringFloat, ',', '', [rfIgnoreCase, rfReplaceAll]);
  try
    dReturn := strToFloat(sStringFloat);
  except
    dReturn := 0;
  end;
  result := dReturn;

end; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-25T02:37:47.710

尝试：`StrToFloat(StringReplace('3,232.00', ',', '')` 在进行转换之前应该去掉逗号。

在 C# / VB.NET 我使用会使用类似的东西`decimal.convert("3,232.00", ",", "");`

我知道在不去掉多余字符的情况下无法进行转换。事实上，我的库中有一个特殊的函数可以去掉逗号和货币符号。所以一个真正的电话`MyConverer.decimalConverter("$3,232.00");`

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-07-21T20:09:03.543

```
function StrToFloat_Universal( pText : string ): Extended;
const
   EUROPEAN_ST = ',';
   AMERICAN_ST = '.';
var
  lformatSettings : TFormatSettings;
  lFinalValue     : string;
  lAmStDecimalPos : integer;
  lIndx           : Byte;
  lIsAmerican     : Boolean;
  lIsEuropean     : Boolean;

begin
  lIsAmerican := False;
  lIsEuropean := False;
  for lIndx := Length( pText ) - 1 downto 0 do
  begin
    if ( pText[ lIndx ] = AMERICAN_ST ) then
    begin
      lIsAmerican := True;
      pText := StringReplace( pText, ',', '', [ rfIgnoreCase, rfReplaceAll ]);  //get rid of thousand incidental separators
      Break;
    end;
    if ( pText[ lIndx ] = EUROPEAN_ST ) then
    begin
      lIsEuropean := True;
      pText := StringReplace( pText, '.', '', [ rfIgnoreCase, rfReplaceAll ]);  //get rid of thousand incidental separators
      Break;
    end;
  end;
  GetLocaleFormatSettings( LOCALE_SYSTEM_DEFAULT, lformatSettings );
  if ( lformatSettings.DecimalSeparator = EUROPEAN_ST ) then
  begin
    if lIsAmerican then
    begin
      lFinalValue := StringReplace( pText, '.', ',', [ rfIgnoreCase, rfReplaceAll ] );
    end;
  end;
  if ( lformatSettings.DecimalSeparator = AMERICAN_ST ) then
  begin
    if lIsEuropean then
    begin
      lFinalValue := StringReplace( pText, ',', '.', [ rfIgnoreCase, rfReplaceAll ] );
    end;
  end;
  pText  := lFinalValue;
  Result := StrToFloat( pText, lformatSettings );
end; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-26T13:12:13.050

我使用了一个能够处理“，”和“。”的函数。作为十进制分隔符...：

```
function ConvertToFloat(aNr: String; aDefault:Integer): Extended;
var
  sNr, s3R, sWhole, sCent:String;
  eRC:Extended;
begin
  sNr:=ReplaceStr(sNr, ' ', '');

  if (Pos('.', sNr) > 0) or (Pos(',', sNr) > 0) then
  begin
    // Get 3rd character from right
    s3R:=LeftStr(RightStr(sNr, 3), 1);
    if s3R <> DecimalSeparator then
    begin
      if not IsNumber(s3R) then
      begin
        s3R := DecimalSeparator;
        sWhole := LeftSr(sNr, Length(sNr) - 3);
        sCent := (RightStr(sNr, 2);
        sNr := sWhole + DecimalSeparator + sCent;
      end
      else
        // there are no decimals... add ',00'
        sNr:=sNr + DecimalSeparator + '00';
    end;
    // DecimalSeparator is present; get rid of other symbols
    if (DecimalSeparator = '.') and (Pos(',', sNr) > 0) then sNr:=ReplaceStr(sNr, ',', '');
    if (DecimalSeparator = ',') and (Pos('.', sNr) > 0) then sNr:=ReplaceStr(sNr, '.', '');
  end;

  eRc := StrToFloat(sNr);
end; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-25T06:06:40.000

当我的用户需要输入“科学”值（例如“1,234.06mV”）时，我遇到了同样的问题。这里有一个逗号、一个乘数 (m=x0.001) 和一个单位 (V)。我创建了一个“宽”格式转换器例程来处理这些情况。布赖恩

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-07-23T21:06:42.910

我的功能：

```
function StrIsFloat2 (S: string;  out Res: Extended): Boolean;
var
  I, PosDecimal: Integer;
  Ch: Char;
  STrunc: string;
  liDots, liComma, J: Byte;
begin
  Result := False;
  if  S = ''
  then  Exit;
  liDots := 0;
  liComma := 0;
  for  I := 1 to Length(S)  do  begin
    Ch := S[I];
    if  Ch = FormatSettings.DecimalSeparator  then  begin
      Inc (liDots);
      if  liDots > 1  then  begin
        Exit;
      end;
    end
    else if  (Ch = '-') and (I > 1) then  begin
      Exit;
    end
    else if Ch = FormatSettings.ThousandSeparator then begin
      Inc (liComma);
    end
    else if not CharIsCipher(Ch) then  begin
      Exit;
    end;
  end;
  if liComma > 0 then begin
    PosDecimal := Pos (FormatSettings.DecimalSeparator, S);
    if PosDecimal = 0 then
      STrunc := S
    else
      STrunc := Copy (S, 1, PosDecimal-1);
    if STrunc[1] = '-' then
      Delete (S, 1, 1);
    if Length(STrunc) < ((liComma * 3) + 2) then
      Exit;
    J := 0;
    for I := Length(STrunc) downto 1 do begin
      Inc(J);
      if J mod 4 = 0 then
        if STrunc[I] <> FormatSettings.ThousandSeparator then
          Exit;
    end;
    S := ReplaceStr (S, FormatSettings.ThousandSeparator, '');
  end;
  try
    Res := StrToFloat (S);
    Result := True;
  except
    Result := False;
  end;
end; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-12-12T08:19:55.620

使用 Foreach 循环

```
 public static float[] ToFloatArray()
    {
     string pcords="200.812, 551.154, 232.145, 482.318, 272.497, 511.752";

      float[] spiltfloat = new float[pcords.Split(',').Length];
        int i = 0;
        foreach (string s in pcords.Split(','))
        {
           spiltfloat[i] = (float)(Convert.ToDouble(s));
            i++;
        }
        return spiltfloat;
    } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-12-12T08:23:22.937

使用 lemda 表达式将字符串逗号分隔为浮点数组

```
public static float[] ToFloatArrayUsingLemda()
    {
        string pcords="200.812, 551.154, 232.145, 482.318, 272.497, 511.752";
        float[] spiltfloat = new float[pcords.Split(',').Length];

        string[] str = pcords.Split(',').Select(x => x.Trim()).ToArray();

        spiltfloat = Array.ConvertAll(str, float.Parse);
        return spiltfloat;
    } 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2021-08-01T10:35:01.350

**过程 Edit1Exit(Sender: TObject);** **开始** edit1.Text:=stringreplace(edit1.Text,'''','',[rfReplaceAll]);
如果不是 IsValidDecimal( maskedit1.Text ) 然后
开始
showmessage('输入的小数 -> '+edit1.Text+' <- 格式错误');
编辑1.SetFocus；
结尾;
**结尾;**

**函数 IsValidDecimal(S:string):boolean;** **VAR** FS：TFormatSettings；
DC：变体；
**开始** //FS := TFormatSettings.Create('it-IT');
FS := TFormatSettings.Create('en-EN');
尝试
DC:=StrToFloat ( S, FS );
结果：=真；
除了
e:exception do
result:=false;
结尾;

**结尾;** 

# .net - 套接字似乎在外部网络上出现问题

> ID：788099
> 
> 赞同：0
> 
> 时间：2009-04-25T02:34:57.357
> 
> 标签：.net, sockets

我有一个与服务器通信并充当客户端和真实服务器之间的代理的 Windows 服务。客户端数据被发送到服务器，服务器的数据返回给客户端。以上两个是完全独立的，因为它们在单独的线程上运行。

以下是步骤：-

1.  侦听器接受的套接字
2.  线程 1 - 从服务器接收数据并将其发送到客户端
3.  线程 2 - 从客户端接收数据并将其发送到服务器

这在本地网络上连续几个小时没有问题（如果客户端和服务器在同一台机器或同一本地网络上）

当客户端在不同的网络上时，问题就出现了。我的服务器在一个 Win2003 服务器上监听并且有一个公共 IP。当客户端尝试使用公共 IP + 端口连接到此服务器时，会建立连接，但很快就会断开连接并抛出 SocketException（10053 - 连接被本机上的软件中止）。这台机器上没有运行防病毒客户端，并且windows防火墙已关闭。

**更新

该服务在客户端服务器上运行，我不太确定任何其他防火墙。该服务在我的 Win2003 服务器上运行良好，客户端在我的网络上，但在不同的服务器上出现问题，客户端在不同的网络上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T02:42:48.307

我要做的第一件事是在两个盒子上运行 WireShark，看看到底发生了什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T02:07:45.543

问题出在 Windows XP SP2 本身。我尝试从 Windows Server 2003 或 Vista 连接客户端，它工作正常。以下链接解释了该问题：http: [//support.microsoft.com/kb/938566](http://support.microsoft.com/kb/938566)

我还尝试更新到 SP3 并应用上述修补程序，但它对我没有帮助。但无论如何，该链接解释了 Windows XP 的问题，并且客户端在 Server 2003 和 Vista 上运行良好。

# javascript - 如何使用 jQuery 将选中复选框的值添加到 textarea？

> ID：788100
> 
> 赞同：1
> 
> 时间：2009-04-25T02:35:52.253
> 
> 标签：javascript, jquery, html, checkbox, text

如何使用 jQuery 删除从未选中 ( )时`textarea`获取的文本，并在选中时再次添加？`input_one``one_1 one_3 one_4``textarea`

代码如下：

```
<div id="input_one">
  <input type="checkbox" value="one">
  <input type="checkbox" value="one_1">
  <input type="checkbox" value="one_2">
  <input type="checkbox" value="one_3">
  <input type="checkbox" value="one_4">
</div>
<div id="input_two">
  <input type="checkbox" value="two_1">
  <input type="checkbox" value="two_2">
  <input type="checkbox" value="two_3">
  <input type="checkbox" value="two_4">
  <input type="checkbox" value="two_5">
</div>    
<textarea id="get_checked"></textarea> 
```

例如 textarea 值应该是`one one_3 two_4`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-10-11T16:04:38.010

您可以`checked`使用选择器选择复选框[`:checked`](https://api.jquery.com/checked-selector/)，并使用[`.map()`](http://api.jquery.com/jquery.map/)它的值替换复选框数组的项目。

```
$("#input_one :checkbox, #input_two :checkbox").change(function() {   
    var text = $("#input_one :checked, #input_two :checked").map(function() {
        return this.value;
    }).get().join(" ");
    $("#get_checked").val(text);
}); 
```

```
$(":checkbox").change(function() {   
    var text = $(":checked").map(function() {
        return this.value;
    }).get().join(" ");
    $("#get_checked").val(text);
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<div id="input_one">
    <input type="checkbox" value="one" />
    <input type="checkbox" value="one_1" />
    <input type="checkbox" value="one_2" />
    <input type="checkbox" value="one_3" />
    <input type="checkbox" value="one_4" />
</div>
<div id="input_two">
    <input type="checkbox" value="two_1" />
    <input type="checkbox" value="two_2" />
    <input type="checkbox" value="two_3" />
    <input type="checkbox" value="two_4" />
    <input type="checkbox" value="two_5" />
</div>
<textarea id="get_checked"></textarea>
```

正如您在[问题](https://stackoverflow.com/q/788100/5104748)中所说，结果文本按空格分隔。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-31T12:37:56.507

希望这可以帮助

```
function updateTextArea() {
    var allVals = [];
    $('#input_one :checked,#input_two :checked').each(function () {
        allVals.push($(this).val());
    });
    $('#get_checked').val(allVals);
}
$(function () {
    $('#input_one input,#input_two input').click(updateTextArea);
}); 
```

[jsfiddle](http://jsfiddle.net/sCFkQ/)

# wpf - WPF 与网络摄像头集成并旋转视频

> ID：788101
> 
> 赞同：-1
> 
> 时间：2009-04-25T02:36:15.733
> 
> 标签：wpf, video, webcam, rotation, flip

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T02:41:00.977

显示视频后（请参阅[上一个问题](https://stackoverflow.com/questions/788075/wpf-integrating-with-web-cam)），将显示元素的 LayoutTransform 或 RenderTransform 设置为合适的 RotateTransform。如果您希望翻转视频，请使用具有负比例的 ScaleTransform。如果您希望两者都做，请使用包含 ScaleTransform 和 RotateTransform 的 TransformGroup。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-19T14:04:50.900

查看 WPF [MediaKit](http://wpfmediakit.codeplex.com/)，其中包含用于网络摄像头的代码。您可以使用标准 WPF 转换来进行旋转。

# python - Blender-蟒蛇

> ID：788102
> 
> 赞同：3
> 
> 时间：2009-04-25T02:36:16.513
> 
> 标签：python, blender

如何将 Blender 指向我安装的 python 版本

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-26T04:57:45.900

马克，您的 Blender 版本应该使用与其接口的特定 Python 版本进行编译——这就是您需要在您的机器上安装的 Python 版本。当 Python 2.5 相当新并且 Blender 仍然在分发 2.4 时，同样的问题浮出水面——参见[http://www.blender.org/forum/viewtopic.php?t=11063](http://www.blender.org/forum/viewtopic.php?t=11063)；我怀疑你可能会遇到完全相同的问题。您的 Blender 在开始时会给出“使用 Python 2.x 编译”形式的什么消息？这应该是你安装 Python 的线索（当然，除非你想从源代码重新编译 Blender 以支持你最喜欢的 Python 版本！）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-08-20T21:28:23.550

Blender 2.5x 现在捆绑了它自己的 python，这是未修改的，仅包含在其中，因此用户不必匹配他们的系统版本的 python。

如果你删除这个 python/ 目录，blender 将在系统上寻找 python，匹配它编译的版本。（3.2、3.3 等，次要版本都是相互兼容的）。

如果你想指向一个非标准的 python 路径，你可以设置 PYTHONHOME 环境变量——python 记录了它是如何工作的（没有特定于搅拌机的）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-25T03:01:19.277

就个人而言，我正在设置我的 PATH 环境变量，以便 Blender 会首先找到最合适的 Python 版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-12-09T18:21:39.543

1.打开你的搅拌机应用程序；

**2.转到脚本**的寡妇屏幕布局（从Blender窗口顶部）

3.在**控制台**下python脚本会看到你的python版本，看看我的输出：

```
PYTHON INTERACTIVE CONSOLE 3.5.1 (default, Feb 17 2016, 17:09:19) [MSC v.1800 64 bit (AMD64)]
>>> 
```

# c# - asp.net mvc 应用程序也可以有 Web 服务吗？

> ID：788103
> 
> 赞同：8
> 
> 时间：2009-04-25T02:36:30.287
> 
> 标签：c#, asp.net, asp.net-mvc, web-services

我有一个 asp.net mvc 应用程序，现在我需要添加一个 Web 服务来配合它。什么是最好的解决方案？只需创建一个新的 Web 服务项目并将其添加到我的解决方案中，然后使用不同的 url 将其部署到同一个 Web 服务器？我希望它成为 mvc 应用程序的一部分，只是因为我有我所有的数据库代码。

任何建议，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-25T04:07:13.080

没有理由不添加 Web 服务项目。

您声明所有数据库代码都在您的 MVC 项目中。我强烈建议您将其从那里删除到一个单独的类库项目中。这第三个项目将被 Web 服务和 MVC 应用程序使用。

我还强烈建议您不要将 ASMX Web 服务用于任何新开发。

仅使用 WCF，除非您别无选择。有一种误解认为 WCF 服务不执行 SOAP - 他们执行，并且 WCF 已经取代了 ASMX。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-25T02:56:28.990

Web 服务可能意味着基于肥皂的 Web 服务或 RESTful Web 服务。我想不出为什么您不能简单地将 asmx 文件添加到您的项目并开展业务。那是基于肥皂的路线。如果您想变得非常酷，尽管您可以从控制器操作中简单地返回 xml，并在 MVC 框架上实现一个 RESTful 解决方案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-25T04:12:53.707

如果您想使用常规的 ASP.NET asmx Web 服务，那当然是可能的。这是[Scott Hanselman 的一个示例，](http://www.hanselman.com/blog/PlugInHybridsASPNETWebFormsAndASPMVCAndASPNETDynamicDataSideBySide.aspx)它可以满足您的要求，并且它引入了一些其他 ASP.NET 技术以作为很好的衡量标准。

您所要做的就是 File -> New Item -> Web Service，它应该像 Mvc 项目中的常规 ASP.NET 应用程序一样工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-25T07:58:45.753

我认为这里有几件事。

您确实可以将 Web 服务添加到 MVC 应用程序。您甚至可以考虑将 Web 服务标识为脚本服务，以使类似 REST 的操作更容易通过 javascript 执行。由于您的情况，这可能不是必需的。

我认为关于底层架构有一个更强有力的问题。如果您将 Web 服务与您的 mvc 应用程序一起放置，因为您的数据库代码已经存在......应该是吗？现在可能是稍微抽象一下数据层的好时机。但是，如果您正在处理一个相对较小的项目并且不需要灵活性，那么当然可以直接添加一个 Web 服务。我想它真正归结为解决您的应用程序的真正需求。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-25T02:40:31.917

MVC 建立在 asp.net 框架上。您应该能够在同一个项目中包含 Web 服务。我还没有这样做，但我知道您可以在同一个项目中将 asp.net 表单应用程序与 MVC 应用程序结合起来。Web 服务也应该如此。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-25T02:51:06.150

除非您的应用程序非常小，否则我建议您为应用程序的每个逻辑部分创建不同的项目。一个很好的起点是为其中的每一个都有一个项目：

*   域对象
*   数据访问
*   网页服务
*   UI（您的 ASP.NET MVC 应用程序）

这提供了与您的架构相对应的清晰分离并支持重用。

# ruby-on-rails - 查找没有关联 has_many 对象的所有对象

> ID：788106
> 
> 赞同：5
> 
> 时间：2009-04-25T02:37:39.770
> 
> 标签：ruby-on-rails, activerecord, associations

在我的在线商店中，如果订单处于“授权”状态并且还没有任何关联的发货，则该订单已准备好发货。现在我正在这样做：

```
class Order < ActiveRecord::Base
    has_many :shipments, :dependent => :destroy

    def self.ready_to_ship
        unshipped_orders = Array.new
        Order.all(:conditions => 'state = "authorized"', :include => :shipments).each do |o|
            unshipped_orders << o if o.shipments.empty?
        end
        unshipped_orders
    end
end 
```

有没有更好的办法？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-17T00:27:16.107

在 Rails 3 中使用 AREL

```
Order.includes('shipments').where(['orders.state = ?', 'authorized']).where('shipments.id IS NULL') 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-25T09:16:13.413

您还可以使用正常的 find 语法查询关联：

```
Order.find(:all, :include => "shipments", :conditions => ["orders.state = ? AND shipments.id IS NULL", "authorized"]) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-25T07:38:27.613

一种选择是在 Order 上设置 shipping_count，它会根据您附加的货件数量自动更新。那你就

```
Order.all(:conditions => [:state => "authorized", :shipment_count => 0]) 
```

或者，您可以使用一些 SQL 来弄脏您的手：

```
Order.find_by_sql("SELECT * FROM
  (SELECT orders.*, count(shipments) AS shipment_count FROM orders 
    LEFT JOIN shipments ON orders.id = shipments.order_id 
    WHERE orders.status = 'authorized' GROUP BY orders.id) 
  AS order WHERE shipment_count = 0") 
```

在使用它之前测试它，因为 SQL 不完全是我的包，但我认为它接近正确。我让它适用于我的生产数据库（即 MySQL）上类似的对象排列。

请注意，如果您没有关于 orders.status 的索引，我强烈建议您这样做！

查询的作用：子查询获取所有处于授权状态的订单的所有订单计数。外部查询过滤器仅列出发货计数为零的查询。

可能还有另一种方法可以做到这一点，有点违反直觉：

```
"SELECT DISTINCT orders.* FROM orders 
  LEFT JOIN shipments ON orders.id = shipments.order_id
  WHERE orders.status = 'authorized' AND shipments.id IS NULL" 
```

获取所有已授权且在发货表中没有条目的订单；）

# html - 邮件收件箱的 CSS

> ID：788109
> 
> 赞同：0
> 
> 时间：2009-04-25T02:38:25.540
> 
> 标签：html, css

我对 CSS 完全陌生。但是我正在编写一个邮件收件箱，它就像您的典型电子邮件收件箱一样，其中包含 3 列，分别是 From、Subject、Received。

我可以得到一些基本的 CSS 来正确格式化这些数据（对齐、列等），我可以从中构建。

也欢迎任何很酷的有趣设计。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-25T03:12:45.707

我觉得这是`<table>`布局实际上是正确布局的少数场景之一。考虑浮动 div 来执行这种样式布局是件好事，但事实是您正在显示一个数据，这是剩下的标签`table`的唯一有效用途。`<table>`这也为您提供了均匀分布的列的好处。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-25T02:45:21.780

您可以在 SmashingMagazine 上找到几乎所有基于网格的设计来帮助您入门：

> [http://www.smashingmagazine.com/2007/04/14/designing-with-grid-based-approach/](http://www.smashingmagazine.com/2007/04/14/designing-with-grid-based-approach/)

这里有很多 CSS 布局供您选择：

> [http://layouts.ironmyers.com/](http://layouts.ironmyers.com/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-25T19:28:31.213

您正在尝试显示表格数据，因此应该真正使用表格。

尽管您也可以使用 div 实现相同的目的，并将它们全部朝相同的方向浮动，如下所示

```
<style>
.clear {clear:both}
#wrapper {width:500px; padding:2px; border:5px solid #000;}
#wrapper .row {border:1px solid #000;}
#wrapper .col {min-width:100px; border-right:1px solid #000; float:left;}
</style>

<div id="wrapper">
    <div class="row">
        <div class="col">From</div>
        <div class="col">Subject</div>
        <div class="col">Date</div>
        <div classs="clear"></div>
    </div>
</div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-25T02:41:56.030

这是我相信的一些三列布局：

*   [http://www.alistapart.com/articles/holygrail](http://www.alistapart.com/articles/holygrail)
*   [http://designshack.co.uk/gallery/layout/3column/](http://designshack.co.uk/gallery/layout/3column/)（这个有一些灵感的例子）
*   [http://matthewjamestaylor.com/blog/perfect-3-column.htm](http://matthewjamestaylor.com/blog/perfect-3-column.htm)

老实说，虽然这些“可以”工作，但您可能正在寻找使用表格。*喘气*是的，一个表，一个表是放置带有重复列的表格数据的最语义正确的选择。当然，也有很多 Javascript 选择来处理表格数据。[Flexigrid 是一个值得考虑的好方法。](http://www.flexigrid.info/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-26T09:49:17.210

我几乎不得不同意这些`<table>`建议，因为事实就是如此。*或者*你可以认为它是一个`<ol>`，也许。

我不确定什么样的“酷”设计适合电子邮件收件箱，因为它们中的大多数会破坏用户的期望，或者我只是不够聪明，无法重新设计功能性 UI。另外我认为大多数返工都会改变 MVC 的控制层，而不是 M 或 V。

话虽如此......也许类似于 iTunes 的艺术家/专辑的新演示文稿可以工作？但我不得不建议这是一个坏主意。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-05T03:08:47.697

根据我创建收件箱的经验，您应该根据需要截断长主题行，以便列宽不会移动等。

```
$message = "WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW";
if(strlen($message) > 10)
$message = substr($message, 0, 10);
echo $message."..."; 
```

这将显示主题`WWWWWWWWWW...`。

# javascript - 在表格行鼠标悬停时显示表格单元格

> ID：788131
> 
> 赞同：4
> 
> 时间：2009-04-25T02:54:01.900
> 
> 标签：javascript, jquery

我有一张看起来像这样的桌子。

```
<table>
  <thead>
    <tr>
      <th>Foo</th>
      <th>Bar</th>
    </tr>
  </thead>
  <tbody>
    <tr class="data">
      <td>Info here</th>
      <td><a href"/url_here" class="edit">Edit</a></td>
    </tr>
    <tr class="data">
      <td>More here</th>
      <td><a href"/url_here" class="edit">Edit</a></td>
    </tr>
  </tbody>
</table> 
```

当您将鼠标悬停在 . 我尝试了几种方法来做到这一点，但一直遇到同样的问题。假设我只是以错误的方式思考这个问题。

这是我目前拥有的。

```
$('a[class*=edit]').hide(); 

$('tr[class*=data]').bind("mouseover", function(e) {
  $(e.target).closest('a[class*=edit]').addClass("selected");
  $('a[class*=selected]:first').show();
}).mouseout(function() {
  $('a[class*=selected]').hide();
  $('a[class*=edit]').removeClass("selected");
}) 
```

现有代码的问题是它不会添加选定的类，除非您将鼠标直接悬停在编辑链接上。就像我上面提到的那样，当您将鼠标悬停在该行中的任意位置时，我需要它来添加选定的类。我也只希望它显示该特定行的编辑链接。

将我的头发拉出几个小时，任何帮助将不胜感激，我知道这可能是愚蠢的。谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-25T03:15:50.630

一些东西：

*   如果您想设置特定元素的样式，您传递给神奇的`$()`jQuery 函数的字符串可以等同于您可以放入 CSS 样式表中的字符串。除了不是很清楚之外，您现在使用选择器的方式效率极低。例如，使用`=*`选择器试图在类属性中的`edit` *任何位置查找带有字符串的所有链接。*所以与一类的链接`abceditabc`会匹配。这使得 jQuery 在试图找到这些不存在的链接时做的工作比必要的要多得多。可接受的用法是使用选择器字符串，例如`a.edit`哪个 jQuery 可以快速确定它是什么以及如何获取它。
*   每当您像正在做的那样进行事件绑定时，`this`指的是事件当前在函数内部被执行的元素。除非您正在执行事件委托，否则您不会真正使用`e.target`.
*   您的代码仅在鼠标悬停在链接上时才有效的原因是，每当您将鼠标悬停在不同的单元格 上时`e.target`，它都是同级 td。`closest`没有能力然后遍历该 td，到 tr，到下一个 td 到链接。即使这样做了，您也可能希望避免这种情况，因为这不是必需的。这与第二点有关，因为简单地查找从表格行下来的链接要容易得多。

所以，记住这些事情，你可以重写你所拥有的：

```
$(function() {
    $('a.edit').hide(); // hide all links with a class of edit
    // act upon all table rows with a class of data
    $('tr.data').hover(function() {
        // at this point, 'this' is the table row that is being hovered
        // we can use the find function to locate the link with a class of edit
        // then add a class to it and show it.
        $(this).find('a.edit').addClass("selected").show();
    }, function() {
        // the second argument of the hover function is what should happen
        // when the mouse hovers out of the table row. In this case, we want
        // to find the link again, remove the class, and hide it.
        $(this).find('a.edit').removeClass("selected").hide();
    });
}); 
```

您可以看到此代码作用于您在[此处](http://jsbin.com/iguro)发布的 HTML 的代码。在 FF，IE 上为我工作。

一些进一步的建议：

*   始终打开[jQuery 文档](http://docs.jquery.com/Main_Page)。它非常擅长解释事物的运作方式。
*   在调试 jQuery 时习惯使用 Firefox/ [Firebug 。](http://getfirebug.com/)当您想准确查看正在选择的内容时，在选择器内部使用`console.log(this);`是一项不可低估的功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T03:00:01.430

尝试这样的事情，假设我的逻辑是正确的。

```
$(document).ready(function() {
  $('a.edit').hide(); 
  $('tr.data').hover(function() {  
    $(this).addClass("selected").find('a.edit').show();
  }, function() {  
    $(this).removeClass("selected").find('a.edit').hide();
 });
}): 
```

您的特定错误很可能与您正在使用[`closest`](http://docs.jquery.com/Traversing/closest)向上遍历树的方法有关。

**更新：**您的代码不起作用的另一个可能原因是您没有使用 jquery document.ready 功能。我已经用它更新了我的代码。

# oracle - 第一次提交后 sqlldr 损坏了我的主键

> ID：788136
> 
> 赞同：0
> 
> 时间：2009-04-25T02:56:15.013
> 
> 标签：oracle, sql-loader

在我的 ctl 文件中第一次提交后，Sqlldr 正在破坏我的主键索引。在第一个之后，无论我在控制文件中将行值设置为什么，我都会得到：

```
ORA-39776: fatal Direct Path API error loading table PE_OWNER.CLINICAL_CODE
ORA-01502: index 'PE_OWNER.CODE_PK' or partition of such index is in unusable state
SQL*Loader-2026: the load was aborted because SQL Loader cannot continue. 
```

我正在使用 Oracle 数据库和客户端 11.1.0.6.0。

我知道这个问题不是由于重复的行，因为如果我将 rows 指令设置为一个巨大的值，那么在 sqlldr 对整个文件进行一次提交后索引不会损坏。这为我提供了一种解决方法，但它仍然有点令人担忧......

感谢任何人都可以提供的任何指导。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T01:54:54.427

我在生产表上使用的 SQL*Loader 不多，但根据我的阅读，您需要使用常规加载。

来自[SQL*Loader 文档](http://download.oracle.com/docs/cd/B28359_01/server.111/b28319/ldr_modes.htm#g1023818)

> **何时使用常规路径负载**
> 
> 如果加载速度对您来说最重要，您应该使用直接路径加载，因为它比传统路径加载更快。但是，对直接路径加载的某些限制可能要求您使用常规路径加载。在以下情况下，您应该使用常规路径加载：
> 
> ```
> * When accessing an indexed table concurrently with the load, or when
>   applying inserts or updates to a nonindexed table concurrently with the
>   load 
> ```
> 
> 要使用直接路径加载（并行加载除外），SQL*Loader 必须具有对表的独占写入访问权和对任何索引的独占读/写访问权。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-07T14:06:19.427

我认为问题在于 Oracle 没有时间重建相关表上的索引，因此我将批量提交大小增加到大于我正在导入的记录数的数字。

这解决了这个问题。

# ruby - 您是否必须为 JRuby 和 MRI 进行重复的 gem 安装？

> ID：788137
> 
> 赞同：2
> 
> 时间：2009-04-25T02:56:25.857
> 
> 标签：ruby, installation, jruby, gem

我安装了 JRuby 和 Ruby (MRI)。看来我需要安装两次 gems - 每个平台一次。这是必要的还是我做错了？在我为 MRI 安装 rails gem 之后，我应该将 JRuby 指向它，还是我也需要调用：“jruby -S gem install rails”

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-25T10:28:33.663

您需要为您拥有的每个不同的 ruby​​ 安装安装 gems。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-26T03:58:45.243

如果您设置 GEM_HOME，您可以共享您的 gem 安装。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T05:23:24.117

一些gem 针对特定平台，例如Mongrel（有一个MRI 平台和一个JRuby 平台）。此外，JRuby 不能使用具有本机扩展（即 C 代码）的 gem，除非它们使用 FFI（大多数还没有）。

就我个人而言，我对 MRI 和 JRuby 有单独的 gem 存储库。在尝试追查问题时，一点点额外的麻烦值得高枕无忧。

很容易看到每个 repo 安装了什么：

```
jruby -S gem list --local 
```

对比

```
gem list --local 
```

你甚至可以编写一个 ruby​​ 脚本来同步一个 gem 列表到另一个，但是你必须小心平台特定的 gem ......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-08-22T17:10:23.453

我在创建我的 gem 时遇到了这个问题，[jimmy_jukebox](https://github.com/JamesLavin/jimmy_jukebox)，但是让我的 gem 可以同时工作。

首先，JRuby 不处理`fork...exec`（甚至错误地回复`Process.respond_to?(:fork)`），所以我不得不`rescue NotImplementedError`使用它`Spoon.spawnp`来代替。

然后，我（在我的 gem 的 /bin 目录中）创建了配对的可执行文件 --`play_jukebox`和`jplay_jukebox`; 和`load_jukebox`-`jload_jukebox`每个都有正确的 shebang 线（`/usr/bin/env ruby`或`/usr/bin/env jruby`）。

我很想知道更好的方法。但我宁愿在单个 gem 中处理所有内容，也不愿维护和分发多个 gem。

# java - Spring DatasourceTransaction Manager 问题

> ID：788144
> 
> 赞同：0
> 
> 时间：2009-04-25T03:01:56.997
> 
> 标签：java, mysql, spring, transactionmanager

```
final DataSource ds = DataSourceLocator.getInstance()
    .getDataSource(sg.cmpl.starhub.lprs.Constants.APP_KEY);
final DataSourceTransactionManager txManager = new DataSourceTransactionManager();
txManager.setDataSource(ds);

final DefaultTransactionDefinition def = new DefaultTransactionDefinition();
def.setIsolationLevel(TransactionDefinition.ISOLATION_READ_COMMITTED);
final TransactionStatus status = txManager.getTransaction(def);

Connection conn = null;
PreparedStatement ps = null;

try {

    /***************************************************************************/
    conn = DataSourceUtils.getConnection(ds);
    ps = conn.prepareStatement(sql);
    ps.execute();
    /***************************************************************************/

    txManager.commit(status);

} catch (Exception e) {
    txManager.rollback(status);
} 
```

我的事务管理器逻辑有问题吗？看起来很不稳定。当我插入新数据时，第一次似乎保存，后来我在 mysql 数据库中找不到数据。请帮忙。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-08T22:49:41.193

假设您有特殊原因想要进行编程连接和事务管理，我建议您查看 Spring`JdbcTemplate`并将其用法包装在`TransactionTemplate`.

但是，正如前面的评论中所述，您应该尽量避免程序化事务管理，而是使用注释 ( `@Transactional`) 或 XML 配置 (`TransactionProxyFactoryBean`或`<tx:advice/>`)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T10:14:37.707

是的，有问题。这不是春天的方式。您不应该将提交/回滚逻辑放在这样的代码中。当您可以在配置中以声明方式执行此操作时，优势就来了。

查看[Spring 事务参考文档](http://static.springframework.org/spring/docs/2.5.x/reference/transaction.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-24T18:14:44.693

附带说明：根据 Spring 文档，如果提交操作因 TransactionException 而失败，则回滚已经被调用，并且在 catch 块中再次调用它会触发 IllegalTransactionStateException。

# vb.net - .NET 默认属性错误

> ID：788150
> 
> 赞同：6
> 
> 时间：2009-04-25T03:06:56.533
> 
> 标签：vb.net, properties, default

我有一个 VB.NET 项目，我可以在其中使用索引遍历字典对象的键和值集合：

```
 MyDictionary.Keys(idx)
MyDictionary.Values(idx) 
```

当此代码从测试项目中取出并放入实际项目中时，我收到以下错误：

> > 'System.Collections.Generic.Dictionary(Of Double, String).KeyCollection' 不能被索引，因为它没有默认属性。

和

> > 'System.Collections.Generic.Dictionary(Of Double, String).ValueCollection' 无法被索引，因为它没有默认属性。

这是使用 VB.NET 和 VS 2008。我不知道从一个项目到下一个项目会有什么不同会导致此错误。测试是一个控制台应用程序，程序是一个 winforms 应用程序。

什么条件会导致这些集合的默认属性发生变化？

**编辑**- 感谢您提供所有告诉我如何遍历字典的答案。然而，这些答案并**不能**回答我为什么可以在一个项目而不是另一个项目中使用索引的问题。我是否应该无法将代码从一个 .net 项目复制并粘贴到另一个项目并使其工作相同？而且，不，选项严格，不是问题的原因。

**编辑**- 尝试重现我所看到的：

*   使用 VS 2008 创建一个新的 VB.NET 控制台应用程序
*   将以下代码复制并粘贴到模块中：

```
 Imports System.Collections
Imports System.Collections.Generic

Module Module1

    Public dtf As Dictionary(Of Double, String)

    Public Sub BuildDictionary()

        dtf = New Dictionary(Of Double, String)

        dtf.Add(1.0, "1")
        dtf.Add(0.0, "0")

    End Sub

    Public Sub Search()
        For idx As Integer = 0 To dtf.Keys.Count - 1
            If dtf.Keys(idx) = 0 Then
                Exit Sub
            End If
        Next
    End Sub

    Sub Main()

    End Sub

End Module 
```

在子搜索中显示“dtf.Keys(idx) = 0”的行中，将光标放在右括号和退格之后，您应该会得到一个工具提示，上面写着“<Extension> ElementAtOrDefault(index as Integer) as Double - **index:**要检索的索引的从零开始的元素。

我没有在我的其他项目中得到这个。即使看起来我有相同的参考和设置。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-25T03:10:37.617

KeyCollection 没有实现这样的索引器，您必须通过 MyDictionary.Keys 进行枚举。

C＃

```
foreach(double key in MyDictionary.Keys)
 Console.Write( MyDictionary[ key ] ) 
```

VB

```
For Each key As Double in MyDictionary.Keys
   Console.Write( MyDictionary( key )
Next key 
```

使用 for(;i++;) 循环不是通过哈希表（字典）的正确方法，因为它不是数组，它实际上没有数组索引的概念（数组 [索引]）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-25T13:17:58.340

我敢打赌，你的真实项目`OPTION STRICT ON`和所有项目一样，并且你的测试项目已经关闭了它。这就是为什么您的测试项目中没有出现编译器错误的原因。

**编辑：**海报说他对这两个项目都有 OPTION STRICT ON。这使得这更有趣。

我仍然认为造成这种差异的最可能原因是，在一种情况下，编译器编译了代码并看到了错误；但在另一种情况下，编译器没有编译代码。这是同一台机器上同一版本的 Visual Studio 吗？两种情况下的 .NET Framework 版本相同吗？

例如，它们是否都是同一类型的项目，它们都是控制台应用程序吗？我问是因为 ASP.NET 网站“项目”通常在调用代码之前不会尝试编译代码。如果您的测试项目是这样一个“项目”，并且您没有实际测试代码（也就是说，如果您没有实际进入此代码并看到它工作），那么您可能会假设您可以按 F5 意味着所有代码都已编译，而没有。

我接下来的想法是看看 MyDictionary 在这两种情况下是否真的属于同一类型。

除此之外，如果您真的需要知道为什么会发生这种情况，我会复制“真实”项目，并开始将其更改为越来越像测试项目。起初这可能是大规模删除的问题。我会一直更改它，直到发现问题，或者直到两者相同。

**编辑 2：**默认控制台项目导入 System.Linq 命名空间（请参阅项目属性中的“参考”选项卡）。此导入将 ElementAtOrDefault 扩展方法引入范围。此扩展方法扩展了 IEnumerable(Of T); 在您的情况下 IEnumerable(Of Double)，这是 Keys 属性实现的。

让我吃惊的是 VB.NET 会自动应用这种扩展方法。在 C# 中，需要显式命名该方法。

如果您删除 System.Linq 的 Import，您会发现您的测试应用程序得到与生产应用程序相同的错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-25T03:14:14.703

Dictionary(Of TKey,TValue) 的 Keys 和 Values 属性没有索引器属性。它们是 ICollection 与 IList 的实现，因此不支持通过索引进行访问。如果要遍历字典，最好的方法是 For Each 循环。

```
For Each pair in MyDictionary
  Dim key = pair.Key
  Dim value = pair.Value
Next 
```

**编辑**

您是否检查以确保两个项目中都引用了 System.Core，并且您有 System.Linq 的项目级导入？这是我能想到的唯一一件事，它会在 ElementAtOrDefault 中产生差异，ElementAtOrDefault 是 system.Core 内部的一种方法。

我仍然有点困惑，为什么该方法会被绑定到一个简单的索引器。要去调查那个

# javascript - Firebug 调试问题

> ID：788152
> 
> 赞同：3
> 
> 时间：2009-04-25T03:07:32.943
> 
> 标签：javascript, asp.net-mvc, firebug

我正在尝试调试使用 JQuery 的 MVC 应用程序。

首先，我有 1.3.3 版的 Firebug，我设置了 Break on All Errors 选项，并添加了一个故意的错误，但它并没有打破错误。

其次，在我激活了具有 javascript 函数的东西并放入断点然后让它继续之后，如果我重新激活该函数，它将不再命中该断点。

第三，您可以将监视表达式放入 JQuery 语句中，因为我有，并且它在监视列表窗口中显示未定义。

马尔科姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T04:38:28.823

据我所知，Firefox 的一个较新补丁破坏了 Firebug 的 javascript 调试。您可以尝试升级到 1.4 alpha ( [http://getfirebug.com/](http://getfirebug.com/) )，但这会导致其他问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T04:44:27.390

另一件需要注意的事情是，有时它可以让你在任何给定的行上放置一个断点，但根据我的经验，只有当行号变为绿色时，你才能依赖该断点工作。

我在一次修复它时来回禁用和重新启用firebug，但我经常不得不终止firefox.exe进程。无论如何，当行号为绿色时，您最好先调试一次，然后再禁用并重新启用（至少那是我的浏览器的行为）。

# apache-flex - 从过滤的 ArrayCollection 中删除项目

> ID：788156
> 
> 赞同：2
> 
> 时间：2009-04-25T03:10:19.770
> 
> 标签：apache-flex, filterfunction

在设置了 filterFunction 的 ArrayCollection 上调用 getItemIndex 时遇到了一些问题。

我做了类似`myAC.removeItemAt(myAC.getItemIndex(myObject))`的事情，当没有应用过滤时它工作正常。应用过滤后，getItemIndex 似乎在每种情况下都返回 -1。

有没有人遇到过这个？从过滤的 ArrayCollection 中删除项目的最佳方法是什么？

非常感谢。

埃文

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-25T03:38:47.407

您的过滤器究竟过滤掉了什么？如果您已过滤掉所有内容，getItemIndex 应该返回 -1。

您是否希望删除应用过滤器后仍然可见的项目？如果您仍想删除已过滤掉的项目，您可以暂时禁用过滤器：

```
var filter:Function = ac.filterFunction;
ac.fiterFunction = null;
ac.refresh();

// remove item

ac.filterFunction = filter;
ac.refresh(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-26T14:28:38.133

我想你会发现 ArrayCollection 中有一个源对象。您看到的是应用了排序或过滤器的基础数据视图。您真的想从底层源对象中删除。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-25T03:21:52.673

每当我在 Flex 中处理从 ArrayCollection 中添加和删除项目时，我总是保留原始 ArrayCollection 的副本。任何添加或删除项目都会发生在该原始副本上。

对原始文件进行更改后，我会将其移至过滤列表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-26T03:24:11.770

是的，所以我确实发现我正在更改对象的属性 - 将其过滤掉 - 在尝试删除它之前。当然，在那种情况下我会得到-1。我的错。

最终同意了你的建议，斯蒂格勒。似乎工作正常，但似乎应该有一种不那么骇人听闻的方式来处理这种事情。也许您可以传递给 removeItemAt 的参数，让您可以访问未过滤的集合。

无论如何，感谢你们两位的回复。非常感激。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-18T13:09:54.403

直接从源中删除

```
arrayCollection.source.splice(i, 1) 
```

# algorithm - 液化过滤器/iwarp

> ID：788160
> 
> 赞同：5
> 
> 时间：2009-04-25T03:12:05.693
> 
> 标签：algorithm, image-processing

我正在尝试在 Photoshop 中构建类似液化过滤器的东西。我一直在阅读图像失真代码，但我正在努力找出什么会产生类似的效果。我能找到的最接近的参考是 Gimp 中的 iWarp 过滤器，但它的代码根本没有注释。

我也看过像 ImageMagick 这样的地方，但他们在这方面没有任何东西

任何指针或算法描述将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-16T21:48:40.953

对不起，如果我让这听起来有点简单，我不确定你对 gfx 编程了解多少，甚至你正在使用什么技术（我自己会用 HLSL 来做）。

我解决这个问题的方法是生成一个纹理，其中包含 r/g 通道中 x/y 坐标的偏移量。那么一个像素的输出颜色就是：
Texture inputImageTexturedistortionMap
colour
(x,y)=inputImage(x+distortionMap(x,y).R,y+distortionMap(x,y).G)
（说实话这不太对，直接使用颜色作为偏移量意味着你只能表示正向量，减去 0.5 很简单，这样你就可以表示负向量）

现在剩下的唯一问题是如何生成这个失真图，这完全是一个不同的问题（任何图像都会产生某种失真，显然，处理适当的液化效果非常复杂，我会把它留给某人更有资格）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-10T16:09:56.417

我认为通过改变网格来液化工作。
想象一下每个像素都是由它在网格上的位置定义的。
现在，当用户单击某个位置并移动鼠标时，他正在更改网格位置。
新的网格再次被投影到用户的 2D 可视空间中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-24T14:22:51.577

查看[本教程](http://geekofficedog.blogspot.com/2015/01/liquify-effect-hello-swirl-2.html)，了解使用 Javascript 实现液化过滤器的方法。基本上，在教程中，效果是将像素笛卡尔坐标转换`(x, y)`为极坐标`(r, α)`，然后应用`Math.sqrt`在`r`.

# html - 重新填充表驱动下拉

> ID：788179
> 
> 赞同：0
> 
> 时间：2009-04-25T03:22:59.723
> 
> 标签：html, jsp

**设想：**

1.  用户通过从下拉列表中选择他/她的状态来填写我的 JSP 表单。（下拉列表是从数据库中填充的）

2.  用户在我的表单上点击“下一步”以转到下一页。

3.  用户通过在我的表单上点击“返回”返回上一页。

**问题：**

State 字段不会重新填充用户选择的内容。

**问题：**

您如何使用用户选择的内容重新填充该字段？（我尝试使用 http 会话）。我在下面包含了我的代码：

**当前代码：**

```
 <td><select name="State" tabindex="6">
                <option>--</option>
                <% for(int i=0; i<stateDDL.size()-1; i++){  
            String state = stateDDL.get(i).toString();
            i++;
            String stateVal = stateDDL.get(i).toString();%>
                <option value=<%=stateVal%>><%=state%></option>
                <%
            } %>
            </select></td> 
```

注意*：stateVal 表示正在发送到数据库的值（即“AL”） state 表示用户在下拉菜单中看到的字符串（即“Alabama”）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-25T04:39:16.950

将 javascript 与第二页的反向链接一起使用。就像是

```
<a href="history.back(-1);return false;">back</a> 
```

我注意到 stateDDL 列表的使用。您应该使用 getter 和 setter getCode() 和 getName() 定义一个具有两个属性 code 和 name 的 State 类。然后您可以创建 State 对象并将其放入列表中。您的代码在 jsp 中将如下所示。

```
<% for (int i = 0; i < stateDDL.size(); i++) {
    State state = stateDDL.get(i);
%>
    <option value=<%=state.getCode()%>><%=state.getName()%></option>
<% } %> 
```

# iphone - iPhone：检测 uiscrollview 上的双击

> ID：788183
> 
> 赞同：1
> 
> 时间：2009-04-25T03:26:50.650
> 
> 标签：iphone

除了子类化之外，是否有一种简单的方法来检测 UIScrollView 中的 UIImageView 上的双击？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-07T21:40:12.370

我创建了 ZoomScrollView 类（UIScrollView 的一个插入式子类），它可以帮助您拦截来自滚动视图的任何触摸，并且如果您想要这样做，还可以处理双击缩小框。

在[github.com/andreyvit/ScrollingMadness/](http://github.com/andreyvit/ScrollingMadness/)上获取它（自述文件包含对两个 UIScrollView 技巧及其背后的推理的详细描述）。

当然，如果您不想缩放，而只是想拦截双击某个内部图像视图，那么子类化是您的朋友。（另一种方法是将视图控制器附加到该图像视图或其在 UIScrollView 中的一个父视图，然后控制器将成为响应者链的一部分，并且能够处理触摸。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T10:52:42.480

查看`UIImageView.h`（在`UIKit`框架内）没有公共委托方法或其他方法可以让您知道图像视图是否已被双击。你可能不得不子类化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-07T14:38:42.283

答案是不。

[http://developer.apple.com/library/ios/#samplecode/ScrollViewSuite/Introduction/Intro.html](http://developer.apple.com/library/ios/#samplecode/ScrollViewSuite/Introduction/Intro.html)

下载示例代码（顶部的下载链接）。看看苹果是怎么做到的。

再见。

# networking - 如何在不使用 NTP、PTP 的情况下计算单向数据包延迟

> ID：788185
> 
> 赞同：3
> 
> 时间：2009-04-25T03:28:43.437
> 
> 标签：networking

我正在寻找一种方法来计算分组交换网络中的单向延迟。我不想使用 NTP 或 PTP（网络时间协议，精确时间协议）。

考虑以下场景：

Host-1 将数据包发送到 Host-2。两个主机都有不同的时钟频率，并且主机位于不同的国家。

数据包可能是 UDP/TCP/Layer 2 帧。

有没有办法同步两台主机的时钟频率，从而计算单向延迟。

现在你们如何在不依赖时序协议的情况下计算单向延迟。我正在寻找一些通用公式来做到这一点。

我非常感谢这个问题的答案。

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-25T19:47:06.113

你不能。测量单向延迟**需要**同步时钟（而 NTP 通常不足以完成这项任务，需要独立同步到可靠时钟）。

阅读[RFC 4656](http://www.ietf.org/rfc/rfc4656.txt)了解血淋淋的细节。有两种可用的实现，C 中的[OWAMP和 Java 中的](http://e2epi.internet2.edu/owamp/)[Jowamp](http://www.av.it.pt/jowamp/)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-25T03:34:46.137

同步时钟正是 [S]NTP 旨在完成的任务。如果有更简单的方法，协议会更简单。您可以在没有它们的情况下近似 RTT，但很难做到单向延迟。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-30T02:53:28.143

参考`UTP`bittorrent，它计算qdelay，不需要两边同步，但是，它可能不是你想要的。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-04-25T04:37:00.170

我用[iperf](http://sourceforge.net/projects/iperf)来做这样的网络测试。通过查看他们的操作方式，您可能会有所了解。

# html - 如何为“float：left”和“float：right”div制作“文本溢出：省略号”？

> ID：788186
> 
> 赞同：5
> 
> 时间：2009-04-25T03:28:45.700
> 
> 标签：html, css, css-float

我有一个网页设计要求，要有这样的标题：

```
+-------------------------------------------------------------+
| +---------------------+  +-------++------------------------+|
| | float left DIV A    |  | DIV C || float right DIV B      ||
| +---------------------+  +-------++------------------------+|
+-------------------------------------------------------------+ 
```

标题有 3 个部分：Div A、B、C。DIV A 向左浮动，而 DIV B 和 C 向右浮动。DIV A 和 DIV B 可能包含长文本。因此溢出的文本被截断为省略号。DIV C 有短文本，其内容不应被截断。

我试图使 HTML 如下所示：

```
<html>
    <head>
        <style>
            .header
            {
                width: 100%;
                border: 2px red;
                overflow: hidden;
            }
            .DivA
            {
                float: left;
            }
            .DivC
            {
                float: right;
                white-space:nowrap;
            }
            .DivB
            {
                float: right;
            }
            .clear
            {
                clear: both;
            }
            .DivA, .DivB
            {
                width: 40%;
                overflow: hidden;
                text-overflow: ellipsis;
                white-space: nowrap;
            }
        </style>
    </head>
    <body>
        <div class="header">
            <div class="DivA">
                Hello world 1 Hello world 2 Hello world 3
                Hello world 1 Hello world 2 Hello world 3
                Hello world 1 Hello world 2 Hello world 3
            </div>
            <div class="DivB">
                Good bye Good bye
                Good bye Good bye
                Good bye Good bye
            </div>
            <div class="DivC">
                No Ellipsis
            </div>
            <div class="clear">
            </div>
        </div>
    </body>
</html> 
```

text-overflow:ellipsis 仅在 DIV A 和 DIV B 具有宽度时才有效（在我的情况下，我将它们设置为 45%）。

但是，DIV C 存在一个问题。由于 DIV C 的宽度在不同的本地化中可能会有所不同，因此我们不能明确设置它的宽度。缩小浏览器窗口时，可以将 div C 换行到下一行。这看起来很糟糕。

有没有办法让DIV A和DIV B分别用溢出省略号向左和向右浮动，同时DIV C可以适应它的最佳宽度？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T17:23:42.603

您需要在这里做的是对 div#c 应用与 div#a 和 div#b 的宽度相匹配的边距

以下面为例；

```
<style>
.DivA {width:250px; float:left;}
.DivB {width:150px; float:right;}
.DivC {margin-left:260px; margin-right:160px;}
</style>

<div class="DivA" />
<div class="DivB" />
<div class="DivC" /> 
```

你会注意到我为每个宽度添加了额外的 10px，这只是为了让元素之间有更多的间距，当然你也需要理想地清除这些。

然后，这将为您提供两侧的两个固定列和一个占用任何可用空间的中心元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T12:09:29.157

这个很旧（09'），但我会回答那些像我一样来自搜索的人。

由于 A 和 B 各占 40%，因此 C 的最大值为 20%，因为标头为 100%。所以添加`max-width:20%;`它，C不会进入下一行。但是，当浏览器窗口变窄时，文本将在需要时换行。

如果您不想要这种行为，您可以添加`white-space: nowrap;`这将使 C 文本与 B 中的文本重叠。

见[http://jsfiddle.net/fxLVQ/](http://jsfiddle.net/fxLVQ/)

# php - Mod重写和PHP

> ID：788188
> 
> 赞同：1
> 
> 时间：2009-04-25T03:32:08.983
> 
> 标签：php, .htaccess, mod-rewrite, url-rewriting

我正在尝试使用 mod_rewrite 将页面重定向到带有一些变量的页面（用于将它们与 PHP 一起使用`$_GET`）。

举一个几行的例子：

*   当用户输入`/c/stg`时，它会重定向到`item_show.php?id=$1&f=1`（`f`页码在哪里）。
*   当用户进入`/c/stg/2`时，它会重定向到带有`show.php?id=$1&f=$2`.

我认为我的文件中没有错误或滥用这些内容，但是，这就是我想要的：

我希望用户`/`*`string`*直接输入当然是我们`item_show.php?id=$1&f=1`的*字符串*......`$1`

 *`/c/`但是，当我通过从中删除部分来更改我的文件时，`RewriteRule`它开始在所有其他目录中给出错误并且不读取任何文件（`my.css`），即使我已经定义了一个`RewriteCond %{REQUEST_FILENAME} !-f`...

你有什么建议吗？或者我怎样才能用任何方法使这个系统成为可能？

```
Options FollowSymLinks
RewriteEngine On

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

#user
RewriteRule ^u/([^/]+)/?$ profile.php?username=$1 [L,NC]

#marked
RewriteRule ^marked/([^/]+)/?$ item_marked.php?id=$1 [L,NC]

#content
RewriteRule ^c/([^/]+)/?$ item_show.php?id=$1&f=1 [L,NC]
RewriteRule ^c/([^/]+)/([^/]+)/?$ item_show.php?id=$1&f=$2 [L,NC] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T08:39:35.563

`RewriteCond`指令只属于以下第一个`RewriteRule`指令。因此，在您的情况下，这两个`RewriteCond`指令仅适用于第一个`RewriteRule`指令，而不适用于其他指令。

但是，如果请求可以映射到现有文件或目录，则可以使用此中止规则退出重写过程：

```
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L] 
```

这将导致仅在请求不能直接映射到现有文件或目录时才测试以下规则。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T20:49:39.207

如果仅将 RewriteCond 传递给第一个 RewriteRule，我错了吗？

试试这个：

```
Options FollowSymLinks
RewriteEngine On

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

#user
RewriteRule ^u/([^/]+)/?$ profile.php?username=$1 [L,NC]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
#marked
RewriteRule ^marked/([^/]+)/?$ item_marked.php?id=$1 [L,NC]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
#content
RewriteRule ^c/([^/]+)/?$ item_show.php?id=$1&f=1 [L,NC]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^/]+)/([^/]+)/?$ item_show.php?id=$1&f=$2 [L,NC] 
```

干杯，

# python - 拥有 book.publisher 和 book.author 时如何获取 publisher.authors？

> ID：788192
> 
> 赞同：1
> 
> 时间：2009-04-25T03:35:18.803
> 
> 标签：python, django

刚从 Djangobook 教程中使用 Books 应用程序示例，您可以通过多对多关系将 Book 与 Author 相关，以及与 Publisher 相关的 Book。您可以使用 p.book_set.all() 获得与出版商关联的一组书籍，但是您需要做什么才能获得与出版商关联的一组作者（通过已出版的书籍）？

这是 [models.py：http://pastie.org/457781](http://pastie.org/457781)

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-25T04:43:43.833

像这样的东西：

```
publisher = Publisher.objects.get(...)
authors = Author.objects.filter(book__publisher=publisher).distinct() 
```

# windows - 为什么 sqlite 1.2.3 gem 可以正确安装 MRI 而不是 JRuby？

> ID：788195
> 
> 赞同：2
> 
> 时间：2009-04-25T03:39:15.237
> 
> 标签：windows, ruby, installation, rubygems, jruby

如果我打电话：

```
gem install sqlite3-ruby --v 1.2.3 
```

它适用于 MRI

但如果我打电话：

```
jruby -S gem install sqlite3-ruby --v 1.2.3 
```

它说它正在尝试构建一个本机扩展（适用于 Windows）并且失败了。

为什么 JRuby 和 MRI 处理宝石的方式不同？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-04T05:28:18.580

C 代码必须使用 FFI 的 JRuby gems。FFI 是一个相当新的东西，大多数使用 C 的 ruby​​ gem 不使用它（实际上我不知道有任何使用它）。

[http://blog.headius.com/2008/10/ffi-for-ruby-now-available.html](http://blog.headius.com/2008/10/ffi-for-ruby-now-available.html)

无论如何，对于 jruby 下的 SQLite3，你不需要这个 - 使用这个：

```
jruby -S gem install jdbc-sqlite3 
```

或者如果运行轨道：

```
jruby -S gem install activerecord-jdbcsqlite3-adapter 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-25T10:27:26.940

因为任何构建本地扩展的东西都是用 C 编译的，而且我相信 JRuby 与这些用 C 编写的东西不兼容，尽管我不了解这方面的技术原因。

# wpf - 如何覆盖在运行时创建的 wpf 控件中的应用程序样式

> ID：788203
> 
> 赞同：0
> 
> 时间：2009-04-25T03:48:47.600
> 
> 标签：wpf, wpf-controls, styles

我试图在运行时创建一个 WPF 控件，但我不知道如何让它忽略来自 App.xml 资源的样式。我尝试将样式设置为 null 并将 OverridesDefaultStyle 设置为 true 但没有运气。应用程序设置将前景设置为白色，我似乎无法明确将其设置为其他任何内容。

```
 Label tb = new Label();
        tb.OverridesDefaultStyle = true;
        tb.Style = null;
        tb.Foreground = new SolidColorBrush(Colors.Black);
        this.Children.Add(tb); 
```

**编辑：**出于某种原因，我永远无法让标签工作，但是当我切换到文本框时，它工作正常。

谢谢你的回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T04:07:08.353

以下几乎相同的代码对我有用：

```
 Label l = new Label();
  l.Content = "Fie!!!";
  l.Style = null;
  l.OverridesDefaultStyle = true;  // not required, see below
  l.Foreground = new SolidColorBrush(Colors.Blue);
  ((Grid)Content).Children.Add(l); 
```

然而，从实验来看，如果你在设置 Style*之后设置 OverridesDefaultStyle = true，它就可以正常工作。*但是如果你在设置 Style*之前*设置了 OverridesDefaultStyle ，那就错了。（不，我不知道为什么会发生这种情况！ **grin**）所以将 OverridesDefaultStyle 设置器移到 Style 设置器之后，或者（因为它不是您想要的效果所必需的），只需将其删除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T08:38:38.497

您所要做的就是设置`Style`阻止`null`它继承。然后你可以设置`Foreground`任何你喜欢的：

```
var tb = new TextBlock() { Text = "Hello" };
tb.Style = null;
tb.Foreground = Brushes.Blue;
this.Children.Add(tb); 
```

如果这对您不起作用，我建议您完全采取其他措施。

PS。使用`Brushes.Black`而不是创建自己的`SolidColorBrush`. 不仅更干净，刷子也会结冰。您的代码创建了一个未冻结的画笔，效率较低。您也可以通过调用`Freeze()`刷子自己冻结它。

# database - 项目编号方案

> ID：788216
> 
> 赞同：1
> 
> 时间：2009-04-25T04:12:58.807
> 
> 标签：database

我正在处理一个需要将文档与客户帐户相关联的项目。每个文档都必须有一个唯一的标识符。我正在研究的方案是 AAA-#### 格式。标识符的字母数字部分将允许使用三个字母跟踪日期（将删除元音以防止淫秽或冒犯性词语）。该计划有效期约为 21 年，一天提供不超过 9999 份文件。前两个字符捕获一年中的连续日期，使用字母表中的 21 个字母（删除元音）产生 21^2，这足以捕获一年中的某一天。最后一个字母数字字符表示年份。这再次将计划限制为 21 年。我想知道是否有人实施了类似类型的方案以及使用了哪些技术。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T04:35:36.630

如果同一个用户上传同一个文件怎么办？我没有看到你在这里自动增加任何东西。您有固定宽度要求吗？我已经实现了一个类似的方案，但我删除了元音并简单地将纪元时间附加到文件名中。如果您将文件名输入到数据库中，您可以依靠它来创建和自动增加唯一标识符。所以你的问题变成了如何将他们的文件名转换为固定宽度的标识符？我建议允许用户自己选择标识符并使​​用数据库来检查唯一性。将用户限制在固定宽度的文本字段是程序员在世界其他地方施加的一种糟糕的做法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T06:20:19.670

一年中的哪一天取决于时区。如果您的用户跨越多个时区，您的命名方案可能不起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-25T19:30:48.587

如果不是按年递增最后一个字母，而是使用所有三个来表示日期并从固定日期开始计数，则可以使其有效期为 25 年，而不是 21 年。

# c# - C#：在扩展方法中验证“this”参数的最佳实践

> ID：788218
> 
> 赞同：6
> 
> 时间：2009-04-25T04:17:54.147
> 
> 标签：c#, exception, extension-methods, argument-validation

假设我有一个扩展方法

```
public static T TakeRandom<T>(this IEnumerable<T> e)
{
    ... 
```

为了验证论点 e，我应该：

A) if (e == null) throw new NullReferenceException()
B) if (e == null) throw new ArgumentNullException("e")
C) 不检查 e

共识是什么？

我的第一个想法是始终验证参数，因此抛出了 ArgumentNullException。话说回来，既然 TakeRandom() 变成了 e 的一个方法，或许它应该是一个 NullReferenceException。但是如果它是 NullReferenceException，如果我尝试在 TakeRandom() 中使用 e 的成员，无论如何都会抛出 NullReferenceException。

也许我应该使用 Reflector 并找出框架的作用。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-25T04:33:05.873

您应该抛出 ArgumentNullException。您正在尝试进行参数验证，因此应该抛出一个针对参数验证调整的异常。NullReferenceException 不是参数验证异常。这是一个运行时错误。

不要忘记，扩展方法只是底层的静态方法，可以这样调用。虽然在扩展方法上抛出 NullReferenceException 表面上看起来是有意义的，但对于静态方法这样做是没有意义的。无法确定方法中的调用约定，因此 ArgumentException 是更好的选择。

此外，您永远不应该明确抛出 NullReferenceException。这应该只由 CLR 抛出。当显式抛出通常仅由 CLR 抛出的异常时，会出现细微的差异。

这也接近于以下内容的欺骗

*   [来自扩展方法的 ArgumentNullException 或 NullReferenceException？](https://stackoverflow.com/questions/463302/argumentnullexception-or-nullreferenceexception-from-extension-method)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-25T04:21:56.540

为了与 Enumerable LINQ 运算符保持一致，请抛出 ArgumentNullException（而不是 NullReferenceException）。

我会在 TakeRandom 方法中进行验证，因为堆栈跟踪将清楚地表明它是 TakeRandom 哪些对象被赋予空参数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-25T07:17:23.670

也许我疯了，但既然这是一个论点，我会抛出一个 ArgumentNullException ：/

不过，一般的经验法则是尽可能抛出派生自 System.ApplicationException 的异常。NullReferenceException 是框架/CLR 会抛出的东西。

[http://msdn.microsoft.com/en-us/library/system.exception(VS.71).aspx](http://msdn.microsoft.com/en-us/library/system.exception(VS.71).aspx)

> 基类 Exception 下存在两类异常：
> 
> 从 SystemException 派生的预定义公共语言运行时异常类。从 ApplicationException 派生的用户定义的应用程序异常类。

# php - 如何连接到 Magento 中的数据库？

> ID：788221
> 
> 赞同：5
> 
> 时间：2009-04-25T04:23:04.023
> 
> 标签：php, magento

我正在尝试构建一个简单的 Magento 模块，该模块需要在每个页面请求开始时连接到数据库。所有表都需要对其进行访问。我一直在拔头发，试图了解如何做到这一点。我能想到的最好的办法是我需要在`config.xml`我的模块文件中设置它，但究竟该命令是什么/如何使用它，我无法弄清楚。

有人可以指导我或告诉我如何做到这一点吗？`config.php`如果不是，那么包含手动连接到数据库的自定义文件是否太糟糕了？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-27T02:54:23.893

您是否尝试使用资源模型或实体？这是使用原始 SQL 查询表的方法，但您需要知道表名。

```
$w = Mage::getSingleton('core/resource')->getConnection('core_write');
$result = $w->query('select entity_id from catalog_product_entity');

if (!$result) {
    return false;
}

$row = $result->fetch(PDO::FETCH_ASSOC);
if (!$row) {
    return false;
} 
```

尝试所有模型时，您可以使用

```
$products = Mage::getModel('catalog/product')->getCollection();

$products->addAttributeToFilter('entity_id', array('in' => array(1,2)));

$products->addAttributeToSelect('*');
$products->load();

foreach ($products as $_prod) {
   var_dump($_prod->getData());
} 
```

我对我的自定义模块使用第二种方法，它对我来说效果很好，希望这个答案有帮助:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-07T21:53:25.237

没有的对象`addAttributeToFilter`呢？我已经尝试了几个小时按名称加载角色对象，但没有任何效果。唯一可能的方法是加载，如果不是莫名其妙的，它会完美地工作

```
if (!intval($value) && is_string($value)) {
   $field = 'role_id';
} 
```

in `Mage_Admin_Model_Mysql4_Role::load`，这只会导致无法使用字符串值进行过滤。

Magento 的`Rube Goldberg`架构...

# jquery - jQuery中的表格行号和列号

> ID：788225
> 
> 赞同：144
> 
> 时间：2009-04-25T04:25:13.787
> 
> 标签：jquery

如何使用 jQuery 获取单击的表格单元格的行号和列号，即

```
$("td").onClick(function(event){
   var row = ...
   var col = ...
}); 
```

* * *

## 回答 #1

> 赞同：222
> 
> 时间：2009-04-25T05:31:40.897

您可以在给定的上下文中使用[Core/index](http://docs.jquery.com/Core/index)函数，例如您可以检查 TD 在其父 TR 中的索引以获取列号，您可以检查表上的 TR 索引以获取行号：

```
$('td').click(function(){
  var col = $(this).parent().children().index($(this));
  var row = $(this).parent().parent().children().index($(this).parent());
  alert('Row: ' + row + ', Column: ' + col);
}); 
```

[在此处](http://jsbin.com/eyeyu/edit)查看运行示例。

* * *

## 回答 #2

> 赞同：122
> 
> 时间：2011-03-07T21:39:04.320

```
$('td').click(function() {
    var myCol = $(this).index();
    var $tr = $(this).closest('tr');
    var myRow = $tr.index();
}); 
```

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2012-08-10T04:15:09.093

点击获取列索引：

```
$(this).closest("td").index(); 
```

点击获取 ROW INDEX：

```
$(this).closest("tr").index(); 
```

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2009-04-25T05:32:50.597

在我的脑海中，一种方法是抓取所有以前的元素并计算它们。

```
$('td').click(function(){ 
    var colIndex = $(this).prevAll().length;
    var rowIndex = $(this).parent('tr').prevAll().length;
}); 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-04-25T04:31:40.417

您可以在创建表格时在单元格中输出该数据吗？

所以你的桌子看起来像这样：

```
<table>
  <thead>...</thead>
  <tbody>
    <tr><td data-row='1' data-column='1'>value</td>
      <td data-row='1' data-column='2'>value</td>
      <td data-row='1' data-column='3'>value</td></tr>

  <tbody>
</table> 
```

那么这将是一件简单的事情

```
$("td").click(function(event) {
   var row = $(this).attr("data-row");
   var col = $(this).attr("data-col");
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-25T05:20:54.760

最好将点击处理程序绑定到整个表，然后使用 event.target 来获取点击的 TD。这就是我可以在凌晨 1 点 20 分添加的所有内容

# opengl - 有人可以解释我如何使用 Quanternions 像 FPS 一样使用鼠标环顾四周吗？

> ID：788226
> 
> 赞同：3
> 
> 时间：2009-04-25T04:25:14.160
> 
> 标签：opengl, camera, glut, quaternions

昨天我问：[简单地调用 Pitch 和 Yaw 怎么会导致相机滚动？](https://stackoverflow.com/questions/784445/how-could-simply-calling-pitch-and-yaw-cause-the-camera-to-eventually-roll)

基本上，我发现是因为“Gimbal Lock”，如果你俯仰+偏航，你将不可避免地产生滚动效果。有关更多信息，您可以阅读该问题。

我正试图阻止这种情况发生。当您在普通的 FPS 射击游戏中环顾四周时，您的相机不会到处滚动！

这是我当前的被动鼠标功能：

```
int windowWidth = 640;
int windowHeight = 480;

int oldMouseX = -1;
int oldMouseY = -1;

void mousePassiveHandler(int x, int y)
{
    int snapThreshold = 50;

    if (oldMouseX != -1 && oldMouseY != -1)
    {
        cam.yaw((x - oldMouseX)/10.0);
        cam.pitch((y - oldMouseY)/10.0);

        oldMouseX = x;
        oldMouseY = y;

        if ((fabs(x - (windowWidth / 2)) > snapThreshold) || (fabs(y - (windowHeight / 2)) > snapThreshold))
        {
            oldMouseX = windowWidth / 2;
            oldMouseY = windowHeight / 2;
            glutWarpPointer(windowWidth / 2, windowHeight / 2);
        }
    }
    else
    {
        oldMouseX = windowWidth / 2;
        oldMouseY = windowHeight / 2;
        glutWarpPointer(windowWidth / 2, windowHeight / 2);
    }

    glutPostRedisplay();

} 
```

这会导致相机根据鼠标移动进行俯仰/偏航（同时将光标保持在中心）。我还在[这里](http://pastebin.com/m20d2b01e)发布了我原来的相机课程。

该线程中的某个人建议我使用四元数来防止这种效果发生，但在阅读了关于它们的[维基百科页面](http://en.wikipedia.org/wiki/Quaternions_and_spatial_rotation)后，我根本不了解它们。

如何在我的 OpenGL/Glut 应用程序中创建四元数，这样我就可以正确地让我的“相机”环顾四周而不会出现不必要的滚动？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T04:35:50.187

一个简单的基于四元数的相机，设计用于 gluLookAt。

[http://www.gamedev.net/reference/articles/article1997.asp](http://www.gamedev.net/reference/articles/article1997.asp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-20T20:41:23.323

保持你的三角洲变化低以避免这种情况（即<45度）

只需计算一个带有每帧旋转的小“增量”矩阵，将其折叠到每帧的相机矩阵中。（折叠的意思是：cam = cam * delta）

如果长时间运行，可能会出现一些数值错误，因此需要重新正交化。（如果这似乎发生了，请查看）

这是在玩东西时避免云台锁定的最简单方法。等你熟练了，剩下的就懂了。

至于四元数，只需为它们找到一个可以将它们转换为旋转矩阵的好的库，然后使用相同的技术（计算 delta quat，乘以 main quat）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-25T04:45:07.437

我会用[极坐标](http://en.wikipedia.org/wiki/Polar_coordinates)表示一切。维基百科页面应该让你开始。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-25T06:03:12.850

对于这种简单的情况，您实际上并不需要四元数，您需要将航向和俯仰输入到 3 维矩阵计算中：

1.  使用带有 Y 轴旋转的航向值来计算 MY

2.  使用在 X 轴上旋转的俯仰值来计算 MX

3.  对于每个点 P，计算 R = MX * MY * P

计算可以通过两种方式完成：

1.  T = MY * P，然后 R = MX * T

2.  T = MX * MY，然后 R = T * P

第一种方法较慢但一开始更容易编码，第二种方法更快，但您需要编写矩阵矩阵乘法函数。

附言。有关矩阵，请参见[http://en.wikipedia.org/wiki/Rotation_matrix#Dimension_three](http://en.wikipedia.org/wiki/Rotation_matrix#Dimension_three)

# c# - 即使 AllowDBNull = False，数据集也允许 Null 值？

> ID：788227
> 
> 赞同：2
> 
> 时间：2009-04-25T04:28:16.697
> 
> 标签：c#, visual-studio-2008, strongly-typed-dataset

我使用 VS2008 数据集设计器设计了一个数据集。在其中一个数据表中，我将大多数列的“AllowDBNull”属性设置为 False。但是，如果我为这些列创建一个包含空值的 DataRow，则该数据表会接受该行，而不会出现任何错误。

我不明白这里的东西吗？请指教。谢谢你。

**然而，编辑**Mike Spross 的出色解释提出了另一个问题。如果它们是 System.DBNull，我们如何检查文本字段？令人惊讶的是，DataSet 没有将字符串 "" 视为 System.DBNull 并引发异常。或者不是吗？

**编辑**我想我已经找到了问题和原因。在将值填充到该行之前，我正在初始化 DataTable 的新行。在初始化行时，字符串的默认值，即 "" 可能会被填充到该列中。我想就这样？有什么想法吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-25T06:18:37.040

**简短的回答是：**

`System.DBNull.Value != null`

**更长的答案是：**

在 C# 中，`NULL`SQL 中值的概念由类的`Value`属性表示`System.DBNull`。在处理数据库时，更熟悉的 C#`null`实际上并不意味着“空值”。

当您将数据库列设置为 时`null`，ADO.NET 将将该列初始化为该列的默认值（例如，将一`int`列初始化为 0）。也就是说，使用`null`实际上会导致非空值最终出现在数据库中，因此您不会收到错误消息。

如果您改为将数据库列设置为`System.DBNull.Value`，则该列实际上将设置为`NULL`。这种情况`AllowDBNulls == false`会阻止你这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-25T11:08:03.443

关于您的“奖金”;-) 问题：NULL（无字符串）和“”（空字符串）是两个不同的东西。所以区别对待他们是完全合理的。是 null 和 DBNull 之间的区别把事情搞砸了。如果在设计 ADO.NET 时可以使用可空类型，事情可能会容易得多。但在 .NET 2.0 之前，没有办法表示例如“空整数”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-25T05:04:03.800

您是否正在为这些列准确分配 NULL 值或空字符串？如果您不为列分配任何值，它将默认为 NULL（如果未施加 DEFAULT 约束）。否则，您可以通过执行以下操作分配 NULL 值 -

```
ds.Tables[0].Rows[0]["Col"] = null; 
```

如果您将空字符串分配给这些列，则它不等于 NULL。

如果您在已标记为 NOT NULLABLE 的列中有 NULL 值，则会引发错误 -

> 列“Col1”不允许空值。

编辑：

通过 NOT NULLABLE，我的意思是 AllowDBNull = false。

您的代码似乎正确。您可以尝试修剪文本吗？

这是整个代码 -

```
DataTable dt = new DataTable();

DataColumn column = new DataColumn("Col1");
column.AllowDBNull = false;
dt.Columns.Add(column);

DataRow dr = dt.NewRow();
dr["Col1"] = null;

dt.Rows.Add(dr); 
```

# c# - 为什么服务器上的 Java 和客户端上的 C# 是一个流行的选择？

> ID：788231
> 
> 赞同：7
> 
> 时间：2009-04-25T04:32:12.397
> 
> 标签：c#, java, client-server

我见过一些例子，其中的架构是服务器端有 java，客户端有 c# - 是什么让这种组合如此出色？为什么两边的 .net 都不是更好的选择（或者事实上，两边都是 java？）

后来补充：在很多情况下，java托管在windows服务器本身上，我认为是通过tomcat（不是100%肯定）——这里的动机是什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-25T05:06:48.007

Java 经常在后端使用（并已成为事实上的标准），原因有很多：

*   Java 可以透明地运行在各种操作系统上，从 Windows 开发工作站到专用的 unix 服务器。
*   Java 强制执行模块化、面向对象的编码方法，这允许（希望）编写大型系统而不会变得难以管理。（这也适用于 C#/.NET，但不适用于其他后端语言，例如 Perl 或 Python）
*   Java 经常用于后端系统（一种语言在特定应用程序中越流行，该语言中针对该特定应用程序的成熟库和工具就越有可能出现）

C# 具有用于在 Windows 中设计 UI 的出色工具和库。Java 独立于操作系统 (OS) 的性质为操作系统 UI 的特定怪癖提供了较少的工具，而 C# 是由 Microsoft 设计和维护的，目的是编写 Windows 应用程序。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-25T05:01:57.940

好吧，在很多情况下，两端都使用 .NET（我猜 Java 也是如此）。但我对 Java-server/.NET-client 架构背后的动机的猜测是，该应用程序将 Unix 作为服务器操作系统，出于成本或可靠性原因，或者因为它需要适应现有的 Unix 服务器环境（例如工作与现有的 Unix 应用程序密切相关），但将 Windows 作为客户端平台。（我认为在 Windows 也被用作服务器平台的情况下，Java 可能不太常见；虽然没有数据支持这一点。）

如果假设是 Unix 服务器操作系统，那么 Java 是一个非常高效的选择，它受到许多库的良好支持，但拥有更大的开发人员基础（至少在“企业”环境中），并且比 Perl 等替代品更“管理”认可、Ruby 或 Python。

相反，.NET 更适合 Windows 客户端，因为它对构建 Windows GUI 有更好的支持。这不仅仅是工具：Java GUI API 本身（例如 Swing）往往更喜欢跨平台的相似性，而不是原生的外观和感觉，因此往往会导致应用程序看起来或行为不像 Windows 应用程序。（我在这里概括一下——对不起！）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-25T04:47:49.050

像 JSON 这样的数据交换格式使得连接两侧的系统是相同的低级技术变得不那么重要了。

Java 是一种经过良好测试和支持的服务器语言，而 C# 具有用于构建 GUI 的出色工具。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-25T07:15:46.527

Java 被认为更成熟，这对于服务器来说是一个很好的属性，而 C# 与 windows 和 office 具有更好的集成/相似的外观和感觉（客户喜欢）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-25T07:58:34.163

大多数服务器都是基于 Windows 或 *nix 的。所以在服务器上，Java 或 .NET/C#（通过 *nix 上的 mono）都非常好。

Java 对不同的客户端设备有更好的支持，但在许多方面，这种要求正在被大多数客户端更好的 HTML 支持所取代——至少对于在线设备是这样。

对于已安装的客户端应用程序，可以说 Java 具有更好的可移植性——但随着 Compact Framework、Micro Framework、Silverlight 等，.NET 正在迎头赶上。

就个人而言（由于工作角色），我*主要*关心服务器上的内容；.NET/C# 从未让我失望——但我不是 Java 开发人员，所以无法直接对比。从开源项目的工作中，我知道有一个很好的社区在服务器上使用 mono。

在客户端，像 WPF 这样的工具提供了一流的 GUI 体验，.NET 对 winforms 的支持对常规 Windows 应用程序很有用。但是由于许多 WPF 架构与 Silverlight 通用（Moonlight 作为 *nix 等的单双胞胎），这也允许在非 Windows 客户端上使用体验。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-25T18:20:08.957

就Java而言，有两件事

1.  Linux。它可靠且便宜。企业使用大量 Linux for Java 的众多原因之一是因为他们不必在 Patch Tuesday 之后重新启动机器。
2.  热点。它是现代世界的奇迹之一——惊人的表现。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-25T18:46:16.103

Fortyrunner，我还没有看到热点 JVM 会击败 MS CLR 的单一基准测试。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-26T07:21:22.247

在服务器端，Java 已被证明是健壮且可扩展的，并且可以在 .NET 梦寐以求的平台上使用。因此，如果您想要硬件中的最多选择，Java 是一个很好的选择——这包括具有许多 CPU 的非常大的机器以及许多集群的廉价 x86 机器。

如果服务器端有 .NET，则必须使用 Windows，而 Windows 在硬件方面根本无法很好地扩展。

# apache - 有没有地方可以下载 AIX mod_jk 二进制文件？

> ID：788248
> 
> 赞同：0
> 
> 时间：2009-04-25T04:47:54.120
> 
> 标签：apache, tomcat, aix, binaries

我需要在 AIX 上将 tomcat 与 apache 放在一起，但[http://www.apache.org/dist/tomcat/tomcat-connectors/jk/binaries/aix](http://www.apache.org/dist/tomcat/tomcat-connectors/jk/binaries/aix)中没有任何内容，并且谷歌搜索不成功。我最终从源代码构建了它（很痛苦，因为在这家大公司安装编译器时存在官僚作风）。

但是这个二进制下载不应该存在于某个地方吗？为什么他们只有一个空目录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T21:44:25.060

我的猜测是他们没有 AIX 或 FreeBSD（也不存在）机器来做这件事。也许你可以自愿建造？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-08T14:48:34.933

AIX 不是唯一被忽视的平台。

自从将 mod_proxy_ajp 引入 apache-2.2 的主要源代码以来，对 mod_jk 项目的普遍兴趣和支持似乎已经减少

该模块执行与 mod_jk 基本相同的功能，不需要额外安装。

我从[http://gnome.bullfreeware.com/aixtoolbox/RPMS/ppc/apache/](http://gnome.bullfreeware.com/aixtoolbox/RPMS/ppc/apache/)获得的 apache-2.2 版本也包含这个模块。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T16:04:58.950

是否有理由获取二进制文件而不编译它？您可以从 apache 的 svn 获取所有源代码。

# events - 用 C++/CLI 类事件包装 boost::function

> ID：788250
> 
> 赞同：0
> 
> 时间：2009-04-25T04:50:05.583
> 
> 标签：events, boost, c++-cli

我试图弄清楚如何用 C++/CLI 类事件包装非托管类的 boost::function 成员（用作事件回调）。我无法控制非托管类。我所能做的就是弄清楚如何正确编写 C++/CLI 类。

这是示例非托管类：

```
class X
{
public:
    boost::function<void (double)> XChanged;;

    void Set(double x)
    {
        XChanged(x)
    }
}; 
```

我尝试了很多事情，但我一直遇到问题。我敢肯定这比看起来要容易。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-08-19T18:44:21.967

CLI 可能不允许您将 boost::function 声明为静态成员。使其成为指针：

`boost::function<void(double> *XChanged;`

然后在构造函数和终结器中分配/取消分配并使用 (*XChanged)(arg); 调用它

# php - PHP 的富文本编辑器 - MySQL Web 应用程序

> ID：788262
> 
> 赞同：4
> 
> 时间：2009-04-25T05:02:22.527
> 
> 标签：php, editor, richtext

我有一个 PHP Web 应用程序，我需要一个富文本编辑器（带有基本格式选项）供我的用户在门户中输入数据。

谁能告诉我该怎么做？由于我将数据保存在 mysql DB 中，数据库保存部分是否会有任何变化

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-25T06:13:44.617

FCKeditor 非常好，而且使用起来很轻松。页面加载时一些简单的 javascript 调用，它会神奇地用 RTE 替换 textareas。再加上它在一直回到 IE5.5 的浏览器上运行良好。假设您已经准备好应对来自 textareas 的 HTML，那么您的数据库应该不会受到影响...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-25T07:32:40.823

或者可能来自雅虎用户界面库的 RTE（富文本编辑器）？

[雅虎编辑。](http://developer.yahoo.com/yui/editor/)

我认为这可能有一些好处：

*   来自 yahoo 的托管（快速、优化）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-02T03:05:19.920

Spaw 编辑器由于某种原因没有更新，所以我切换到[PHP 的可爱编辑器](http://phphtmledit.com/)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-25T05:09:46.533

你应该去[FCKEditor](http://www.fckeditor.net/ "FCK编辑器")。

你也可以看看[这些](http://blog.webdistortion.com/2008/03/09/9-of-the-best-rich-text-editors-reviewed/)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-25T05:11:33.660

我推荐你[FCKEditor](http://www.fckeditor.net/)，它很容易[与 PHP 集成](http://docs.fckeditor.net/FCKeditor_2.x/Developers_Guide/Integration/PHP)......

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-25T05:17:36.577

有许多不同的选项，最流行的是[TinyMCE](http://tinymce.moxiecode.com/)和[FCKEditor](http://www.fckeditor.net/)。我建议为你喜欢的人买点[东西](http://www.geniisoft.com/showcase.nsf/WebEditors)，但他们都应该以表单等形式提交有效的 html。最大的区别可能在于你[验证输入](http://www.phpro.org/tutorials/Validating-User-Input.html)以防止 XSS 攻击的方式（你需要允许“安全 html”在表单提交；[这](http://htmlpurifier.org/)看起来很有希望）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-25T06:26:47.503

我喜欢[tinymce](http://tinymce.moxiecode.com/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-25T07:04:47.567

要使用任何 RTF 样式编辑器，您必须将要存储文本的字段设置为 LongText 数据类型。

TinyMCE 和 FCKEditor 都很好，它们都将文本格式信息存储为 HTML 标签。

在这两种情况下，插入图形和/或 Flash 都需要您先将内容上传到使用它们的界面，然后再插入。

我们观察到，与我们系统上的 FCKEditor 相比，TinyMCE 的加载速度似乎更快。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-25T08:43:19.827

我已经审查了许多这样的系统，并发现，就像上面的许多海报一样，FCKEditor 和 TinyMCE 是最好的。我选择 FCK，因为它具有内置的文件/图像上传支持 - 你必须为模块付费才能在 TinyMCE 上实现这一点。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-25T09:20:51.890

我从未尝试过，但[MarkitUp！](http://markitup.jaysalvat.com/home/)看起来很棒。它建立在 jQuery 库之上。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-25T14:40:02.030

几年来，我们一直在使用**SPAW**编辑器，您可以通过 PHP 而不是 JavaScript 来处理和编码（因此它是服务器端编码视角而不是客户端）。

我们发现它具有**极强的可扩展性和可定制性**。

如果你想看看，这里是链接： [http ://www.spaweditor.com/](http://www.spaweditor.com/ "http://www.spaweditor.com/")

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-04-25T23:58:41.670

[**Nicedit**](http://nicedit.com/)是一个易于使用且轻量级 (~25KB) 的所见即所得 Javascript 编辑器。

您可以自定义要在工具栏中显示的样式和按钮。

您还可以扩展它，使用 AJAX 保存数据，生成有效的 XHTML，创建多个编辑器，上传图像，BBCode 等等......

我将它与 jQuery 一起使用，我对结果非常满意

它是开源的 :) 具有 MIT 许可证

# ruby - 您如何在线拆分电子邮件？

> ID：788272
> 
> 赞同：1
> 
> 时间：2009-04-25T05:11:50.460
> 
> 标签：ruby, email

我正在使用 Rails 的 Fetcher 插件检索电子邮件。它做得很好。但是我试图在换行符上拆分电子邮件的正文，但它似乎只是一个很长的行。

将电子邮件分成多行的最佳方式（在 Ruby 中）是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T05:37:59.820

听起来你需要一个自动换行算法。这是我在[ruby​​-talk 邮件列表中](http://74.125.95.132/search?q=cache:LvsQtRALJMYJ:blade.nagaokaut.ac.jp/cgi-bin/scat.rb/ruby/ruby-talk/10655)找到的一种简短而巧妙的 Ruby 自动换行方式（链接指向 Google 的缓存，因为该站点似乎已关闭）：

```
puts $<.read.gsub(/\t/,"     ").gsub(/.{1,50}(?:\s|\Z)/){($& + 
5.chr).gsub(/\n\005/,"\n").gsub(/\005/,"\n")} 
```

这是一个包含在方法中的稍微漂亮的版本：

```
def wordwrap(str, columns=80)
  str.gsub(/\t/, "     ").gsub(/.{1,#{ columns }}(?:\s|\Z)/) do
    ($& + 5.chr).gsub(/\n\005/, "\n").gsub(/\005/, "\n")
  end
end 
```

# ios - 在 iOS 模拟器上测试时出错：无法向引导服务器注册

> ID：788277
> 
> 赞同：370
> 
> 时间：2009-04-25T05:15:21.217
> 
> 标签：ios, xcode, ios-simulator

当单击 UIAlertView 的按钮时崩溃时，我正在模拟器上测试我的应用程序。我在那里停止了调试，对代码进行了一些更改并再次构建了应用程序。现在，当我运行应用程序时，我在控制台中收到此错误

> **无法向引导服务器注册 com.myApp.debug。错误：未知错误代码。这通常意味着该进程的另一个实例已经在运行或挂在调试器中。程序收到信号：“SIGABRT”。**

我尝试从模拟器中删除该应用程序，进行干净的构建，但当我尝试运行该应用程序时仍然出现此错误。

我应该怎么做才能再次在我的模拟器上运行该应用程序？

* * *

## 回答 #1

> 赞同：242
> 
> 时间：2011-10-22T16:14:46.327

**状态：**最近出现在 Mac OS 10.8 和 Xcode 4.4 中。

**tl; dr：**这可能发生在两种情况下：在设备上运行时和在模拟器上运行时。在设备上运行时，断开并重新连接设备似乎可以解决问题。

[迈克·阿什建议](http://www.mikeash.com/pyblog/solving-simulator-bootstrap-errors.html)

```
launchctl list|grep UIKitApplication|awk '{print $3}'|xargs launchctl remove 
```

这并不总是有效。事实上，它从未对我有用，但在某些情况下它显然有效。就是不知道是什么情况。所以值得一试。

否则，解决此问题的唯一已知方法是重新启动用户启动。重新启动会做到这一点，但有一种不那么激烈/更快的方法。您需要创建另一个管理员用户，但您只需执行一次。当事情发生变化时，以您自己的身份注销，以该用户身份登录，然后杀死属于您的主要用户的 launchd，例如，

```
sudo kill -9 `ps aux | egrep 'user_id .*[0-9] /sbin/launchd' | awk '{print $2}'` 
```

将您的主要用户名替换为`user_id`. 以您的普通用户身份再次登录会让您恢复正常状态。有点痛苦，但不如完全重启。

**细节：**

Lion/Xcode 4.2 开始更频繁地发生这种情况。（就我个人而言，在那个组合之前我从未见过它。）

该错误似乎在launchd中，当调试器停止调试而不杀死它时，它继承了应用程序进程作为子进程。这通常由应用程序变为僵尸发出信号，进程状态为 Z in ps。

核心问题似乎出在在 launchd 中实现的引导名称服务器中。这（据我了解）将应用程序 ID 映射到马赫端口。当错误被触发时，应用程序会死掉，但不会从引导服务器的名称服务器映射中清除，因此引导服务器拒绝允许应用程序的另一个实例以相同的名称注册。

希望（请参阅评论）强制启动`wait()`僵尸可以解决问题，但事实并非如此。核心问题不是僵尸状态（这就是为什么一些僵尸是良性的），而是引导名称服务器，并且没有已知的方法可以清除这个短于杀死 launchd 的问题。

看起来这个 bug 是由 Xcode、gdb 和用户 launchd 之间的错误触发的。我只是通过在 iphone 模拟器中运行一个应用程序来重复楔子，让它在 gdb 中停止，然后进行构建并运行到 ipad 模拟器。它似乎对切换模拟器很敏感（iOS 4.3/iOS 5、iPad/iPhone）。当我经常切换模拟器时，它不会一直发生，但相当频繁。

在您登录时杀死 launchd 会搞砸您的会话。注销并重新登录不会杀死用户launchd；OS X 保留现有的进程。重新启动会解决问题，但这很痛苦。上面的说明更快。

我已经向 Apple FWIW 提交了一个错误。rdar://10330930

* * *

## 回答 #2

> 赞同：162
> 
> 时间：2009-04-25T05:21:47.737

尝试退出并重新启动模拟器？如果“情况更糟”，您可以随时尝试重新启动：根据我的经验，这应该可以解决它。

* * *

## 回答 #3

> 赞同：70
> 
> 时间：2011-11-12T12:19:01.550

我发现我已经开始遇到 Lion + Xcode 4.2 的这个问题。我在 Xcode 4.3 中也遇到过这个问题。

我已经尝试了所有建议，但除了完全重新启动之外，它们都没有奏效。

以下是您确定是否需要快速重启的方法。

列出你所有的僵尸进程：

```
ps -el | grep 'Z' 
```

如果您看到您的应用程序列为僵尸进程，则需要重新启动计算机。错误消息指出“这通常意味着该进程的另一个实例已经在运行或挂在调试器中”。好吧，Xcode 正在检测这个你无法杀死的僵尸进程。然后，您可以修复它的唯一方法是重新启动系统。:(

**编辑，20120823：**我对僵尸进程有一些更好的了解，所以我想更新这个答案。当父进程未在终止的子进程上调用 wait()（等待进程更改状态）时，将创建 Zombie 进程。您不能直接在 Zombie 进程上运行“kill”，但如果您杀死父进程，则 Zombie 子进程将被“收割”并从进程表中删除。

我很长一段时间没有看到这个问题，所以没有检查过这个场景中的父进程是什么。杀死父进程的替代方法是重新启动系统。:)

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2010-07-21T00:46:56.040

我刚刚遇到这种情况：我只在我的设备上收到错误，模拟器工作正常。我最终不得不重置我的设备并且错误消失了。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2009-08-07T18:30:48.407

我最近经常遇到这个问题。什么可以防止这种情况发生？注销并解决问题但是..经常这样做很烦人。

编辑：

我刚刚找到原因。我在 ApplicationWillTerminate 方法中有一个错误。因此，当我单击 Xcode 窗口上的停止按钮时，应用程序无法正确终止并开始挂起。

检查活动监视器以查看您的应用程序是否在列表中。如果可能，强制退出。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2012-03-21T00:42:58.327

如果您发现问题是由于僵尸进程引起的：

```
ps-el | grep 'Z'
```

（如之前的评论[https://stackoverflow.com/a/8104400/464289](https://stackoverflow.com/a/8104400/464289)）并且只想立即解决问题，您可以这样做而无需重新启动或杀死任何东西。只需重命名您的项目目标可执行文件：

1.  单击左侧窗格中的项目
2.  在中间窗格中选择**构建设置**
3.  在“**包装**”下，将“**产品名称**”从**$(TARGET_NAME) 更改为 $(TARGET_NAME).1**

简单的！

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2011-11-05T14:45:24.113

好吧，没有答案，但至少还有一个测试要做。打开终端并运行以下命令：“ps-Ael | grep Z”。如果您收到两个条目，一个是“（clang）”，另一个是您的应用程序或公司名称，那么您将被淹没 - 重新启动。

如果您是开发人员，请输入一个简短的错误并告诉 Apple 必须重新启动是多么烦人，并提及他们可以将此错误复制到我刚刚输入的“rdar://10401934”。

大卫

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2011-04-13T20:31:47.623

重置 iOS 模拟器为我修复了错误。尽管这将删除您在模拟器中拥有的所有应用程序，但它可以解决问题而无需重新启动机器。

您可以通过执行以下操作重置您的 iOS 模拟器：

1) 转到主屏幕最左侧 Apple () 徽标旁边的“iOS 模拟器”菜单。
2) 选择“重置内容和设置...”。
3) 阅读弹出消息，如果您同意点击“重置”，否则点击“不重置”。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2011-11-29T17:57:35.993

1.  关闭模拟器
2.  停止应用程序在 xCode 中运行。
3.  打开**Activity Monitor**并搜索使用您的**App NAME****运行的进程**。
***   在活动监视器中终止此进程*   重建你的项目，你应该准备好了**

 *** * *

## 回答 #10

> 赞同：4
> 
> 时间：2011-11-10T00:39:08.060

我遇到了@jyap 提到的僵尸进程的问题。清除它们的唯一方法是重新启动。但是，我注意到我在同一个项目上工作的朋友会遇到同样的问题，但可以在不创建僵尸进程的情况下杀死模拟器。我完全卸载了 Xcode 并重新安装了它，虽然我仍然收到错误，但它不会创建僵尸进程，所以我不必重新启动。

在我这样做之前，我使用了这个非常丑陋的解决方法：更改您的应用程序 ID 并再次运行。您最终会在模拟器中获得应用程序的垃圾副本，但您可以推迟重新启动一段时间。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2012-01-10T11:16:07.713

这个错误经常发生在我身上，几乎每次我在模拟器中测试应用程序时，都会迫使我重新启动。

如果您想完成一些工作，这里有一个解决方法：

*   在项目导航器中单击您的项目
*   前往**目标**->**信息**
*   为应用程序添加密钥*不在后台运行*并设置为`YES`.

这意味着当您在模拟器中按下主页按钮或退出模拟器时，应用程序不会挂起。

不要忘记在分发之前更改此设置！把它放在你的发布清单上:)

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2012-02-28T08:43:57.187

如果在 iPhone 上测试时发生这种情况。重启手机就好了。据我所知，手机或模拟器仍然认为有一个应用程序正在运行，所以当它最后一次运行时，它没有正确终止，要么是代码中的错误，要么是手机/模拟器只是想要一个呻吟。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2012-03-12T02:24:28.010

在 iPhone 4 上调试我的应用程序时出现此错误。硬重启 iPhone 解决了我的问题。（关闭iPhone的电源挂了...）

我的 mac 上没有任何僵尸进程，重新启动 mac 并没有解决问题。

也许这个错误可以在模拟器和实际设备上表现出来？？？

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2012-10-27T19:13:48.947

重启设备，成功！:D

谢谢大家的好建议。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2010-12-17T15:57:56.763

我刚遇到这个错误。我尝试重新启动模拟器和 Xcode，但我的项目只有在清理和构建后才能再次运行。不知道是什么原因造成的。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2011-08-19T22:43:46.890

我有一个递归设置器，它吹过堆栈并杀死了我的应用程序，以至于我不得不启动我的 iPad。可以通过代码中的修复来证明这一点。

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2011-10-17T12:06:12.197

我有同样的问题并通过执行以下操作解决了

*   从设备中删除应用程序，
*   断开设备与 Mac 的连接，
*   关闭并重新打开设备，
*   退出并重新启动 Xcode，
*   戒烟工具，
*   最后，再次清理并构建。

我还做了一件事，因为 Xcode 被配置为使用 iOS 5.0 而我的项目使用的是 iOS 4.3

*   删除所有框架并再次添加它们。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2012-02-03T20:02:41.120

**原因**

在之前运行的应用程序完全停止之前在模拟器中运行您的应用程序。

**修复**

等到您看到停止按钮再次激活，然后再运行。

（我使用的是 Xcode 4.2.1。当我升级到 OS X Lion 时，这个问题经常发生）。

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2012-02-07T15:08:42.180

替代解决方法：

*   给你的应用一个新的标识符。如果它叫 com.foobar.myapp，就叫它 com.foobar.myapp01

您会丢失应用程序中的所有数据，因为就 iPhone 模拟器而言，它实际上是一个正在运行的新应用程序。这可能会也可能不会比重新启动更烦人 - 只是想将其添加到列表中。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2011-07-06T09:03:46.153

通过在删除应用程序后重新启动我的手机，然后将其重建干净并再次运行来修复。现在工作正常。

奇怪的。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2012-01-16T02:05:32.257

我的问题不需要重建或重新安装，在我的情况下，尝试在 iPhone 上运行应用程序时出现错误。模拟器工作正常。

解决方法：删除手机应用程序，冷重启手机，现在一切正常。

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2012-05-02T23:02:56.750

在 Lion 上使用 Xcode 4.2.1 对我来说发生了很多事情。更新到 4.3.2，它不再发生。很高兴他们修好了。

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2012-05-07T21:19:45.340

Mike Ash[发布了一个](http://www.mikeash.com/pyblog/solving-simulator-bootstrap-errors.html)不需要重启的解决方案（上帝保佑他！）。赶紧跑：

```
launchctl list|grep UIKitApplication|awk '{print $3}'|xargs launchctl remove 
```

> 上面的命令列出了所有已启动的作业，搜索名称中带有 UIKitApplication 的作业（这将是与您的应用程序相对应的作业），提取名称，并告诉 launchd 摆脱该作业。

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2012-06-10T01:35:40.820

我认为这是由于在按下 Xcode 中的停止按钮之前在 iPhone 上强制退出您的应用程序造成的。有时，当您在 Xcode 中按下停止按钮时，如果应用程序挂起，则需要额外的时间才能退出应用程序。但是请耐心等待，它最终会在大多数情况下退出。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2011-09-07T02:27:07.703

您可以在函数或选项卡中分配变量。如果您的函数或选项卡退出，它将解除分配。所以你必须声明它的成员变量或全局变量。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2012-01-29T06:49:00.243

我一直收到这个错误，直到我不再信任“运行”对话框中的“停止”按钮。现在我总是在尝试运行之前在工具栏中点击停止，我还没有遇到任何僵尸进程。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2011-02-09T18:22:17.650

哦，我的 - 我尝试了上面和其他帖子中列出的所有内容。重新安装 Xcode，重新启动我的机器，将所有丢失的文件复制到正确的文件夹中......最终我备份了我的 iphone，擦除并恢复它，它工作了！

我认为阅读和解决此问题的原因可能是断开了我的 iphone white 的连接，它正在使用捕获泄漏的性能工具运行。或者类似的东西。

啊啊啊，大大的松了一口气。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2013-02-22T14:55:23.380

在最坏的情况下**，重置**iOS 模拟器的内容和设置，在我的情况下，大多数时候，与模拟器一起退出 XCode，总是对我有用 XCode4.6（经常被挂起）

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2014-02-21T11:53:56.947

在我的情况下，我曾经遇到过这种问题，这就是我所做的

1.  从模拟器中删除应用程序。
2.  删除派生数据文件夹。
3.  通过选择产品菜单 - clean 在项目中执行清理操作
4.  重置模拟器。
5.  退出 Xcode。
6.  如果项目工作正常，请立即尝试运行该项目，否则转到第 7 步
7.  重复从 1 到 5 的所有步骤，然后重新启动机器。

在大多数情况下，我让它在第 6 步极端情况下运行，我不得不重新启动我的机器。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2014-12-29T02:35:42.047

这个错误曾经发生在旧版本的 iOS 模拟器中，因为另一个正在关闭的设备中的旧作业实例可能会与新实例发生冲突。

iOS 6.0 及更高版本不应遇到此类问题，因为 iOS 6.0 引入了引导子集的使用，而 iOS 7.0 引入了与主机引导服务器完全隔离的专用引导服务器 (launchd_sim) 的使用。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2015-02-21T15:14:32.937

**如果您正在从命令行运行测试**（使用`xcodebuild test`），请确保正在运行的模拟器与您希望在其上运行测试的设备匹配。

您可能正在运行使用 iPhone 5 的命令行测试。如果您一直在 XCode 广告中运行 iPhone 6 然后运行命令行测试，有时 iPhone 6 将保持运行，您需要手动选择 iPhone 5 设备，然后运行再次测试。

# javascript - 将 .onKeyUp 和 .onChange 与 Javascript DOM 对象一起使用

> ID：788290
> 
> 赞同：2
> 
> 时间：2009-04-25T05:27:18.690
> 
> 标签：javascript, dom, javascript-events

我一直在玩的一些 Javascript/DOM 代码有一个奇怪的问题。我正在尝试将 .onKeyUp 和 .onChange 事件/方法分配给文本输入，如下所示：

```
form.elements["article"].onkeyup = "alert('test');"; 
```

奇怪的是，使用该方法进行分配什么都不做，我不得不手动使用：

```
form.elements["article"].setAttribute("onkeyup", "alert('test');"); 
```

我在这里错过了什么吗？我已经使用了我之前提到的第一种方法，并且效果很好。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-25T05:35:54.910

试试这个：

```
form.elements["article"].onkeyup = function() { alert("test"); }; 
```

史蒂夫

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-25T05:36:58.387

您需要分配一个函数，而不是一个字符串。例如：

```
form.elements["article"].onkeyup = function(){alert('test');}; 
```

我知道唯一会接受一个字符串并对其进行评估（除了`eval`）是`setTimeout`and `setInterval`。

# jquery - 引用 Jquery 语句和调试

> ID：788295
> 
> 赞同：1
> 
> 时间：2009-04-25T05:33:31.250
> 
> 标签：jquery, visual-studio-2008, debugging

VS2008。

我有一个 MVC 应用程序，我为正在构建的控件动态呈现 html。

我已经编写了一些 javascript 并放入了一个 .js 文件。

我的母版页引用了我的 jquery js 文件。

然后用户控件调用我的代码来呈现 html。

我的 js 文件使用 JQuery。

当我调试时，在即时窗口中打印语句时出现“未定义”错误。

这是因为我的 js 文件没有引用 Jquery JS 文件吗？

如果是这样我如何引用它？

马尔科姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-25T05:39:34.730

如果你不引用 jQuery，那么是的。

确保将其包含在：

```
<script type="text/javascript" src="/dhtml/jquery-1.3.1.min.js"></script> 
```

即时窗口用于服务器端代码。

为 javascript 输出获取 firefox 插件的 Firebug 并检查 console.log 功能

没有 Firebug 的 jQuery 很痛苦

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T06:10:04.703

马尔科姆，

确保您的 jquery 引用正在解析 - 您可以使用[firebug](http://getfirebug.com/)，或者您可以在 Web 服务器启动时测试 url。我绝对同意在进行 JS/UI 开发时必须使用[firebug ！](http://getfirebug.com/)

加载页面时查找脚本参考...您可以将 url 复制出来并通过粘贴到浏览器中进行测试...例如，如果您在网站的 url ( [http://localhost:1234/](http://localhost:1234/)上查看源代码) 并查看：

```
<script type="text/javascript" src="scripts/jquery-1.3.2.js"></script> 
```

在浏览器中输入[http://localhost:1234/scripts/jquery-1.3.2.js](http://localhost:1234/scripts/jquery-1.3.2.js)，查看是否收到JS内容（或者提示下载）。

希望这可以帮助。

赛斯

# vb.net - Windows 窗体中的自动换行 (vb.net)

> ID：788311
> 
> 赞同：3
> 
> 时间：2009-04-25T05:56:22.227
> 
> 标签：vb.net, winforms, word-wrap

如何在 Visual Basic .NET 2005 中使用 DrawString 创建自动换行效果？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-25T06:21:20.403

[http://www.informit.com/guides/content.aspx?g=dotnet&seqNum=286](http://www.informit.com/guides/content.aspx?g=dotnet&seqNum=286)

> 您可以通过将 RectangleF 对象传递给 DrawString 方法来在矩形中绘制文本。GDI+ 将环绕文本以使其适合指定的矩形。例如：

```
Dim s As String = "This string will be wrapped in the output rectangle"
Dim rectf As New RectangleF(10, 100, 200, 200)
grf.DrawString(s, myFont, Brushes.Red, rectf) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-25T06:26:12.590

[如果您为Graphics.DrawString](http://msdn.microsoft.com/en-us/library/aa984365(VS.71).aspx)方法的重载提供一个矩形，它会将文本包装在矩形内。

```
Overloads Public Sub DrawString(String, Font, Brush, RectangleF) 
```

# email - 我可以有两个邮件服务器用于不同的电子邮件吗

> ID：788313
> 
> 赞同：0
> 
> 时间：2009-04-25T06:02:15.707
> 
> 标签：email, hosting, dns, mailsettings

我有一个注册域名，其中电子邮件由 Windows Live 管理中心处理，我的域有一条 mx 记录。我还可以随时修改 dns 记录。我们在 Windows Live 中为我的域注册了大约 20 封电子邮件。例如 user1@example.com、user2@example.com 等。

一些用户想进入谷歌应用程序帐户，因为他们说其中有很多功能，因此我认为我的组织中需要多个邮件服务器。

如果我有权更改 dns 和 mx 记录，我是否可以将一些电子邮件重定向到 windows live 和一些谷歌应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T08:07:58.057

因此，您希望同一域的不同用户访问不同的邮件服务器？

您不能通过操纵 DNS 记录来做到这一点 - 邮件将被传递到您的 MX 记录为域定义的服务器，而无需参考用户名。

但是，没有什么能阻止该邮件服务器成为一个应用程序，该应用程序根据收件人的用户名将邮件转发到其他几个服务器......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T08:04:59.780

这不能在 DNS 中完成 - 邮件路由仅在域部分完成。

您需要安排所有邮件到达一个中心位置，然后根据收件人进行转发。

请注意，尽管任何体面的邮件服务器都应该能够做到这一点，但这并非完全无关紧要。这是因为在某些情况下（cc: 等），转发需要导致*两个*副本被转发，即，如果有多个收件人并且他们并不都在同一个服务上。

# cocoa - Cocoa：如何使控件不可见？

> ID：788314
> 
> 赞同：2
> 
> 时间：2009-04-25T06:02:37.700
> 
> 标签：cocoa, controls

在我的应用程序中，我有一些控件，例如 NSButton 和 NSTextfield，我想将其变为不可见。我知道我可以在 Interface Builder 中做到这一点，但我需要在代码中做到这一点。

我仍然没有找到需要发送给控件的正确消息。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-25T06:20:12.917

```
[myView setHidden:YES]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-28T15:01:15.063

实际上，这也会禁用控件。如果您希望控件仍然有效，例如对于 NSButton，则可以使用 [button setTransparent:YES]。

# silverlight - 放大银光

> ID：788317
> 
> 赞同：0
> 
> 时间：2009-04-25T06:06:22.327
> 
> 标签：silverlight, zooming

我已经使用 kit3D 动态创建了一个 3D 结构（基本上是一个图像）。但是，我只想缩放整个结构的一小部分。我的整个图像一次全部加载，所以我不考虑使用深度缩放。无论如何，我可以在silverlight中仅缩放动态生成图像的一部分吗？

谢谢你，拉姆亚

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T10:09:06.487

您可以使用 Scale RenderTransform 来增加图像的大小，然后使用剪辑仅显示其中的一部分，从而产生缩放效果。

或者，您可以使用[Silverlight 工具包中的 ViewBox](http://silverlight.codeplex.com/Wiki/View.aspx?title=Silverlight%20Toolkit%20Overview%20Part%201&ANCHOR#Viewbox)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T06:35:16.140

这个[例子](http://weblogs.asp.net/palermo4/archive/2008/04/14/video-magnify-a-portion-of-a-photo-using-silverlight-1-0.aspx)可能会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-25T14:56:28.603

我会为此使用 MultiScaleTileSource。这是一个基于回调的系统 - 它在用户缩放或平移时从您实现的函数中请求 Deep Zoom 磁贴。

这是一些[示例代码](http://weblogs.asp.net/jeff/archive/2008/10/26/conquering-deep-zoom-part-2-serving-tiles-custom-multiscaletilesource.aspx)，这是一个[完整的工作示例，可以从 Virtual Earth 动态提取地图图块](http://www.codeplex.com/deepearth)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T17:29:29.583

[在http://www.silverenlightenment.com/](http://www.silverenlightenment.com/)上有一个使用 silverlight 3 和 Virtual Earth 的示例

# linq-to-sql - 插入新记录时如何获取主键值？

> ID：788320
> 
> 赞同：7
> 
> 时间：2009-04-25T06:09:46.560
> 
> 标签：linq-to-sql

我正在使用 LINQ-to-SQL 类。它有一个方法 object.InsertOnSubmit() 。但它返回 void 所以我可以在插入记录后获取主键值。

我想要最近插入记录的主键值。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-25T06:45:17.177

是（假设它是一个身份字段）。

单独调用 InsertOnSubmit 不会将插入发送到数据库。您需要调用 SubmitChanges 以便将当前数据上下文实例中的任何更改发送到数据库。

调用 SubmitChanges 后，您可以从调用 InsertOnSubmit 时使用的实例访问值。Linq to sql 将在执行插入时为您填充这些值（在 SubmitChanges 期间发生）

检查这个例子：http: [//msdn.microsoft.com/en-us/vbasic/bb737920.aspx#dynid](http://msdn.microsoft.com/en-us/vbasic/bb737920.aspx#dynid)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-25T06:49:46.230

简而言之，你不需要。对象本身已更新。

```
 public void Add(Person person)
    {
        using (MyEntities context = new MyEntities())
        {
            Context.Persons.InsertOnSaveChanges(person);
            Context.SaveChanges();
        }
    }

    public void Foo()
    {
        Person p = new Person { name = "John", age = 20 }
        Add(p);
        Int32 id = p.id;  // id contains the newly inserted object's id
    } 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-25T06:54:17.843

这是一个如何工作的示例：

```
var dc = new MyDataContext();
var cust = new Customer{FirstName="John", LastName="Smith"};
dc.Customer.InsertOnSubmit(cust);
dc.SubmitChanges();
//after SubmitChanges(), the Id is filled from the database
var customerPrimaryKey = cust.Id; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-25T06:14:36.830

如果模型设置正确，应该在受影响的对象（您刚刚插入的对象）上自动设置 PK。

HTH。

赛斯

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-25T06:20:13.667

调用 InserOnSubmit() 后，主键值将设置为您表对象中的对应字段。您可以简单地访问该属性以获取主键。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-25T06:16:47.433

插入记录后，您是否在数据上下文中调用 SubmitChanges()？除非您这样做，否则不会评估变更集。

# ios - 如何禁用/启用 UITextField 中的返回键？

> ID：788323
> 
> 赞同：76
> 
> 时间：2009-04-25T06:10:23.720
> 
> 标签：ios, objective-c, xcode, cocoa-touch

有没有办法以编程方式启用或禁用返回键`UIKeyboard`？我能找到的最接近的是[`enablesReturnKeyAutomatically`](http://developer.apple.com/iPhone/library/documentation/UIKit/Reference/UITextInputTraits_Protocol/Reference/UITextInputTraits.html#//apple_ref/occ/intfp/UITextInputTraits/enablesReturnKeyAutomatically)，但这只会告诉是否要禁用它。

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2012-07-08T11:57:42.360

也许以下代码段会有所帮助：

```
textfield.enablesReturnKeyAutomatically = YES; 
```

这在 iPhone SDK 中的 UITextInputTraits 中公开可用。使用这个，当文本字段中没有可用的输入文本时，返回键将被禁用。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2017-09-01T15:52:12.950

您可以覆盖`UITextField`的`hasText`属性来实现这一点：

```
class CustomTextField : UITextField {
    override public var hasText: Bool {
        get {
            return evaluateString(text)
        }
    }
} 
```

在哪里`evaluateString(_ text: String?) -> Bool`检查您需要的输入标准，例如字符数。

当然，这只能与`enablesReturnKeyAutomatically = true`set on the结合使用`UITextField`。

我知道我的答案既不及时也不是用 Objective-C 编写的，但鉴于我无法在其他任何地方找到答案，而且这个问题经常在其他线程中被提及，我认为这里是最好的地方发表它。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2013-12-14T01:18:17.430

`UITextField`的`enablesReturnKeyAutomatically`属性可以在 Interface Builder 中设置，只需选择文本字段并打开属性检查器。正如 Tharindu 所说，这将根据是否输入任何文本自动启用和禁用返回键。

![在此处输入图像描述](https://i.stack.imgur.com/JSno4.png)

当然，如果您需要在代码中更改它，您仍然可以使用`nameTextField.enablesReturnKeyAutomatically = true`.

**编辑以解决反对票：**

否则，没有官方方法可以启用和禁用命令中的返回键。我建议不要尝试使用私有 API 来完成此操作。或者，您可以使用[`textFieldShouldReturn:`](https://developer.apple.com/library/ios/documentation/UIKit/Reference/UITextFieldDelegate_Protocol/#//apple_ref/occ/intfm/UITextFieldDelegate/textFieldShouldReturn:)委托方法并将您的条件/验证放在那里并做出相应的响应。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-27T16:44:40.570

一个好主意是创建一个文件以从任何地方访问此类。这是代码：

**UIKeyboard.h**

```
#import <UIKit/UIKit.h> 

@interface UIApplication (KeyboardView)

    - (UIView *)keyboardView; 

@end 
```

**UIKeyboard.m**

```
#import "UIKeyboard.h"

@implementation UIApplication (KeyboardView)

- (UIView *)keyboardView
{
    NSArray *windows = [self windows];
    for (UIWindow *window in [windows reverseObjectEnumerator])
    {
        for (UIView *view in [window subviews])
        {
            if (!strcmp(object_getClassName(view), "UIKeyboard"))
            {
                return view;
            }
        }
    }

    return nil;
}

@end 
```

现在你可以从你自己的类中导入和访问这个类：

```
#import "UIKeyboard.h"

    // Keyboard Instance Pointer.
    UIView *keyboardView = [[UIApplication sharedApplication] keyboardView]; 
```

**您可以在此处找到此类的完整文档：http:** [//ericasadun.com/iPhoneDocs/_u_i_keyboard_8h-source.html](http://ericasadun.com/iPhoneDocs/_u_i_keyboard_8h-source.html)

**您可以在这里找到更多信息：http:** [//cocoawithlove.com/2009/04/showing-message-over-iphone-keyboard.html](http://cocoawithlove.com/2009/04/showing-message-over-iphone-keyboard.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-12-16T16:36:14.000

让我建议一个不需要子类化的有点hacky的解决方案。

```
extension UITextFieldDelegate {
    func setReturnKeyState(for textField: UITextField, isEnabled: Bool, delay: Double? = nil) {
        textField.enablesReturnKeyAutomatically = false
        if textField.delegate != nil {
            if let delay = delay {
                DispatchQueue.main.asyncAfter(deadline: .now() + delay) {
                    textField.setValue(isEnabled, forKeyPath: "inputDelegate.returnKeyEnabled")
                }
            } else {
                textField.setValue(isEnabled, forKeyPath: "inputDelegate.returnKeyEnabled")
            }
        }
    }
} 
```

**使用实际样本**

定义任何条件，例如：

```
private func validateInput(_ string: String?) -> Bool {
    (string?.count ?? 0) > 3
} 
```

调用`setReturnKeyState`委托方法，例如：

```
func textFieldDidBeginEditing(_ textField: UITextField) {
    setReturnKeyState(for: textField, isEnabled: validateInput(textField.text), delay: 0.1) // A bit hacky it needs delay here
}

func textField(_ textField: UITextField, shouldChangeCharactersIn range: NSRange, replacementString string: String) -> Bool {
    if var text = textField.text, let range = Range(range, in: text) {
        text.replaceSubrange(range, with: string)
        setReturnKeyState(for: textField, isEnabled: validateInput(text))
    }
    return true
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-08-25T21:54:38.667

**我对[重复问题](https://stackoverflow.com/questions/30425464/grey-out-return-key-programmatically)的回答，复制过来**：

所有其他解决方案都没有回答这个问题。OP 希望将键盘上的返回按钮“变灰”，作为给用户的视觉信号。

这是我的解决方案，适用于 iOS 13。您可能需要针对其他 iOS 版本稍微修改解决方案。

首先，我扩展`UITextFieldDelegate`.

```
func getKeyboard() -> UIView?
    {
        for window in UIApplication.shared.windows.reversed()
        {
            if window.debugDescription.contains("UIRemoteKeyboardWindow") {
                if let inputView = window.subviews
                    .first? // UIInputSetContainerView
                    .subviews
                    .first // UIInputSetHostView
                {
                    for view in inputView.subviews {
                        if view.debugDescription.contains("_UIKBCompatInputView"), let keyboard = view.subviews.first, keyboard.debugDescription.contains( "UIKeyboardAutomatic") {
                            return keyboard
                        }
                    }
                }

            }
        }
        return nil
    } 
```

然后，每当我需要禁用“return”键时，我们可以这样做（替换`delegate`为您的委托对象的变量名）：

```
if let keyboard = delegate.getKeyboard(){
    keyboard.setValue(text == nil, forKey: "returnKeyEnabled")
} 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2018-05-10T19:59:49.870

这是一种可从记录的 API 中获得的技术，但在禁用回车键时它不提供视觉反馈。

```
- (void)setup {
    // Or in init
    self.textField.delegate = self;
}

// <UITextFieldDelegate>
- (BOOL)textFieldShouldReturn:(UITextField *)textField {
    // substitute your test here
    return [textField.text rangeOfString:@"@"].location != NSNotFound;
} 
```

此处的其他答案可用于

```
[textField addTarget:self
              action:@selector(validateTextField:)
    forControlEvents:UIControlEventEditingChanged]; 
```

在用户键入时提供动态视觉反馈。

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2019-07-22T08:23:01.737

尝试使用 UITextField！接收这个字符串，然后返回就消失了！

# scheduling - 在共享主机上调度

> ID：788325
> 
> 赞同：2
> 
> 时间：2009-04-25T06:11:41.313
> 
> 标签：scheduling, shared-hosting

我正在共享托管服务器上编写调度应用程序。到目前为止，我的日程安排似乎不必比每天更精细，但以后可能会改变。理想情况下，我想使用 Windows 主机，所以我用 .NET 编写我的应用程序，但我愿意使用 PHP+*nix 主机。

在共享托管环境（阅读：便宜）中，如何编写可以按计划发生通知的应用程序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-25T06:20:43.710

你想要类似[cron 的工作](http://en.wikipedia.org/wiki/Cron)吗？

史蒂夫

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-25T06:27:09.407

在 *nix 系统上，您将要使用`cron`. 它的使用示例，每天凌晨 3:20 开始一个进程：

```
echo "20 3 * * * /path/to/run-my-job.sh" | crontab 
```

**编辑**：要回答对另一个回复的评论中提出的问题，这取决于共享主机；[其中](http://he.net/hosting.html)[许多](http://wiki.dreamhost.com/index.php/Crontab) 允许您运行 cron 作业[。](http://help.godaddy.com/topic/67/article/3549)

# php - 使用 PHP 和验证码减少垃圾邮件的最佳实践是什么？

> ID：788328
> 
> 赞同：2
> 
> 时间：2009-04-25T06:14:03.120
> 
> 标签：php, captcha

我的网站有以下代码来发送电子邮件。

```
if($_SESSION["captcha"]==$_POST["captcha"])
{

$msg="Require Services :\t$_POST[service]\n";
$msg="Name :\t$_POST[name]\n";
$msg.="Company Name :\t$_POST[co_name]\n";
$msg.="Address :\t$_POST[address]\n";
$msg.="Mobile :\t$_POST[mobile]\n";
$msg.="Phone :\t$_POST[phone]\n";
$msg.="E-mail :\t$_POST[email]\n";
$msg.="Message :\t$_POST[message]\n";

$subject=$_POST[subject];
$to="info@sriramtrade.com,rajm_123@rediffmail.com";
$headers="From: $_POST[email] < $_POST[email]> \n";
$headers .= "Reply-To: $_POST[email]\n\n";

mail($to,$subject,$msg,$headers);}

?> 
```

即使在使用验证码减少垃圾邮件后，我仍然会收到很多垃圾邮件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T08:26:36.343

添加一个新的输入字段，将其标记为“请留空”，使用 CSS 将其隐藏，如果该字段已填写，则忽略该帖子。像这样：

```
<style type='text/css'>
#other_email_label, #other_email {
    display: none;
}
</style>
...
<form action='mail'>
<label id='other_email_label' for='other_email'>Please leave blank:</label>
<input type='text' name='other_email' id='other_email'>
...
</form> 
```

因此人类不会看到该字段（除非他们关闭了 CSS，在这种情况下他们会看到标签并将其留空）但垃圾邮件机器人会填写它。任何填充该字段的帖子必须来自垃圾邮件机器人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T06:25:38.317

我不确定这是否是您的问题的原因，但您应该`$_SESSION["captcha"]`在该文件中取消设置，以便用户必须在每封电子邮件中输入一次验证码。现在的方式是，他们可以在提交表单后点击刷新，并快速发送任意数量的电子邮件。

# c# - 从代码隐藏将参数传递给 JavaScript 函数

> ID：788330
> 
> 赞同：11
> 
> 时间：2009-04-25T06:16:46.530
> 
> 标签：c#, javascript, .net, asp.net, code-behind

我想从一个 aspx 控件调用一个 javascript 函数。例如，假设我有：

```
<html xmlns="http://www.w3.org/1999/xhtml">
    <head runat="server">
<title>Untitled Page</title>
<script type="text/javascript">
    function test(x, y)
    {

    }
</script>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:Button ID="Button1" runat="server" Text="Button"
         onclick="Button1_Click"/>
    </div>
    </form>
</body>
</html> 
```

在后面的代码中：

```
protected void Button1_Click(object sender, EventArgs e)
{
    // do stuff (really going to a database to fill x and y)
    int[] x = new int[] { 1, 2, 3, 4, 5 };
    int[] y = new int[] { 1, 2, 3, 4, 5 };

    // call javascript function as test(x,y);
} 
```

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-25T06:22:55.623

如果您使用的是 ScriptManager 或任何 Ajax 控件/异步回发，请查看[ScriptManager.RegisterStartupScript方法。](http://msdn.microsoft.com/en-us/library/system.web.ui.scriptmanager.registerstartupscript.aspx)

编辑：

实际上，您想要的功能可能是[ScriptManager.RegisterClientScriptBlock](http://msdn.microsoft.com/en-us/library/system.web.ui.scriptmanager.registerclientscriptblock.aspx)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-25T06:23:09.807

您可以使用[Page.ClientScript.RegisterStartupScript](http://msdn.microsoft.com/en-us/library/system.web.ui.clientscriptmanager.registerstartupscript.aspx)方法。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-26T05:08:35.110

我发现的其他一些事情：

您不能直接传入数组，例如：

```
this.Page.ClientScript.RegisterClientScriptBlock(this.GetType(), "xx",   
"<script>test("+x+","+y+");</script>"); 
```

因为这调用了 x 和 y 的 ToString() 方法，它返回“System.Int32[]”，显然 Javascript 不能使用它。我必须将数组作为字符串传递，例如“[1,2,3,4,5]”，所以我编写了一个辅助方法来进行转换。

此外，this.Page.ClientScript.RegisterStartupScript() 和 this.Page.ClientScript.RegisterClientScriptBlock() 之间存在差异 - 前者将脚本放在页面底部，我需要它才能访问控件（如 document.getElementByID）。RegisterClientScriptBlock() 在呈现标签之前执行，所以如果我使用该方法，我实际上会得到一个 Javascript 错误。

[http://www.wrox.com/WileyCDA/Section/Manipulating-ASP-NET-Pages-and-Server-Controls-with-JavaScript.id-310803.html](http://www.wrox.com/WileyCDA/Section/Manipulating-ASP-NET-Pages-and-Server-Controls-with-JavaScript.id-310803.html)很好地涵盖了两者之间的差异。

这是我想出的完整示例：

```
// code behind
protected void Button1_Click(object sender, EventArgs e)
{
    int[] x = new int[] { 1, 2, 3, 4, 5 };
    int[] y = new int[] { 1, 2, 3, 4, 5 };

    string xStr = getArrayString(x); // converts {1,2,3,4,5} to [1,2,3,4,5]
    string yStr = getArrayString(y);

    string script = String.Format("test({0},{1})", xStr, yStr);
    this.Page.ClientScript.RegisterStartupScript(this.GetType(),
    "testFunction", script, true);
    //this.Page.ClientScript.RegisterClientScriptBlock(this.GetType(),
    //"testFunction", script, true); // different result
}
private string getArrayString(int[] array)
{
    StringBuilder sb = new StringBuilder();
    for (int i = 0; i < array.Length; i++)
    {
        sb.Append(array[i] + ",");
    }
    string arrayStr = string.Format("[{0}]", sb.ToString().TrimEnd(','));
    return arrayStr;
}

//aspx page
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title>Untitled Page</title>
    <script type="text/javascript">
    function test(x, y)
    {
        var text1 = document.getElementById("text1")
        for(var i = 0; i<x.length; i++)
        {
            text1.innerText += x[i]; // prints 12345
        }
        text1.innerText += "\ny: " + y; // prints y: 1,2,3,4,5

    }

    </script>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:Button ID="Button1" runat="server" Text="Button"
         onclick="Button1_Click" />
    </div>
    <div id ="text1"> 
    </div>
    </form>
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-04-29T08:11:06.233

**包括脚本管理器**

**函数背后的代码**

```
ScriptManager.RegisterStartupScript(this, this.GetType(), "HideConfirmBox", "javascript:HideAAConfirmBox(); ", true); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-25T06:38:45.477

```
Response.Write("<scrip" + "t>test(" + x + "," + y + ");</script>"); 
```

分解 script 关键字，因为 VStudio / asp.net 编译器不喜欢它

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-01-09T05:23:01.173

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title>Call java script function on Code behind</title>
    <script  type="text/javascript">
    function abc()
    {
        var a=20;
        var b=30;
        alert("you enter"+a+":"+b);
    }
    </script>
</head> 
```

cs代码

```
protected void Page_Load(object sender, EventArgs e)
{
    TextBox2.Attributes.Add("onkeypress", "return abc();");
} 
```

试试这个

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-25T06:35:51.710

我认为您想在回发后执行javascript服务器端而不是在浏览器中，对吗？

据我所知，这是不可能的

如果您只想在回发后执行它，您可以执行以下操作：

```
this.Page.ClientScript.RegisterClientScriptBlock(this.GetType(), "xx", "<script>test("+x+","+y+");</script>"); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-06-10T10:10:55.953

如果您对在***服务器上***[处理 Javascript 感兴趣，有一个名为Jint](http://jint.codeplex.com/)的新开源库，它允许您执行服务器端 Javascript。基本上它是一个用 C# 编写的 Javascript 解释器。我一直在测试它，到目前为止它看起来很有希望。

以下是该网站的描述：

> 与其他脚本引擎的区别：
> 
> Jint 不同，因为它不使用 CodeDomProvider 技术，该技术在后台使用编译，因此由于无法卸载已编译的程序集而导致内存泄漏。此外，使用这种技术可以防止像 JavaScript 那样使用动态类型变量，从而使您的脚本具有更大的灵活性。相反，Jint 嵌入了它自己的解析逻辑，并真正解释了脚本。Jint为此目的使用著名的 ANTLR ( [http://www.antlr.org ) 库。](http://www.antlr.org)由于它使用 Javascript 作为其语言，因此您不必学习一门新语言，事实证明它对于脚本目的非常强大，并且您可以使用多个文本编辑器进行语法检查。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-03-24T16:07:52.517

```
 <head>
    <script type="text/javascript">

        function test(x, y) 
        {
            var cc = "";
            for (var i = 0; i < x.length; i++) 
            {
                cc += x[i]; 
            }
            cc += "\ny: " + y; 
            return cc;
        }

    </script>

</head>

<body>

    <form id="form1" runat="server">

        <asp:Button ID="Button1" runat="server" Text="Button"   />

        <p>
             <asp:TextBox ID="TextBox1"  Name="TextBox1"  runat="server" AutoPostBack="True"  TextMode="MultiLine"></asp:TextBox>
        </p>

    </form>
</body>

protected void Page_Load(object sender, EventArgs e)
{
    int[] x = new int[] { 1, 2, 3, 4, 5 };
    int[] y = new int[] { 1, 2, 3, 4, 5 };

    string xStr = getArrayString(x); // converts {1,2,3,4,5} to [1,2,3,4,5]
    string yStr = getArrayString(y);

    string script = String.Format(" var y = test({0},{1}) ; ", xStr, yStr);
    script += String.Format("  document.getElementById(\"TextBox1\").value = y  ");

    this.Page.ClientScript.RegisterStartupScript(this.GetType(),  "testFunction", script, true);
  //  this.Page.ClientScript.RegisterClientScriptBlock(this.GetType(), "testFunction", script, true); // different result
}

private string getArrayString(int[] array)
{
    StringBuilder sb = new StringBuilder();
    for (int i = 0; i < array.Length; i++)
    {
        sb.Append(array[i] + ",");
    }
    string arrayStr = string.Format("[{0}]", sb.ToString().TrimEnd(','));
    return arrayStr;
} 
```

# gdi+ - 为什么 Image.FromFile 有时会保持文件句柄打开？

> ID：788335
> 
> 赞同：22
> 
> 时间：2009-04-25T06:18:56.743
> 
> 标签：gdi+, filehandle

我在 ASP.NET 应用程序中的 .NET 中的 GDI+ 中进行了大量图像处理。

我经常发现 Image.FromFile() 保持文件句柄打开。

为什么是这样？在不保留文件句柄的情况下打开图像的最佳方法是什么。

*   注意：我没有做任何愚蠢的事情，比如让 Image 对象到处乱放——即使我是，我也不希望文件句柄保持活动状态

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-07-09T17:23:03.627

我经历了与该线程上的其他一些海报相同的旅程。我注意到的事情：

1.  在释放文件句柄时使用 Image.FromFile 似乎是不可预测的。**在所有情况下，调用 Image.Dispose() 都不会释放文件句柄。**

2.  如果您在 FileStream 上调用 Dispose() 或按照 Kris 的建议将整个内容包装在 Using {} 语句中，则使用 FileStream 和 Image.FromStream 方法可以工作，并释放文件的句柄。但是，如果您随后尝试将 Image 对象保存到流中，Image.Save 方法将引发异常**"A generic error occurred in GDI+"**。大概 Save 方法中的某些内容想了解原始文件。

3.  史蒂文的方法对我有用。我能够删除内存中带有 Image 对象的原始文件。我还能够将图像保存到流和文件中（我需要做这两件事）。我还能够保存到与原始文件同名的文件中，如果您使用 Image.FromFile 方法，这是不可能的（我觉得这很奇怪，因为这肯定是最有可能的用例，但是嘿.)

所以总结一下，像这样打开你的图像：

```
Image img = Image.FromStream(new MemoryStream(File.ReadAllBytes(path))); 
```

然后，您可以随意操作它（以及原始文件）。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-04-25T06:45:09.800

我有同样的问题，并诉诸使用读取文件

`return Image.FromStream(new MemoryStream(File.ReadAllBytes(fileName)));`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-25T16:20:24.923

Image.FromFile 保持文件句柄打开，直到图像被释放。从[MSDN](http://msdn.microsoft.com/en-us/library/stf701f5.aspx)：

“在处理图像之前，文件保持锁定状态。”

使用 Image.FromStream，你就不会有问题了。

```
using(var fs = new FileStream(filename, FileMode.Open, FileAccess.Read))
{
    return Image.FromStream(fs);
} 
```

**编辑：（**一年后）

上面的代码是危险的，因为它是不可预测的，在某个时间点（关闭文件流之后）你**可能会**得到可怕的**"A generic error occurred in GDI+"**。我会将其修改为：

```
Image tmpImage;
Bitmap returnImage;

using(var fs = new FileStream(filename, FileMode.Open, FileAccess.Read))
{
    tmpImage = Image.FromStream(fs);
    returnImage = new Bitmap(tmpImage);
    tmpImage.Dispose();
}

return returnImage; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-25T06:53:25.847

确保您正确处置。

```
using (Image.FromFile("path")) {} 
```

using 表达式是

```
IDisposable obj;
try { }
finally 
{
    obj.Dispose();
} 
```

@Rex 在 Image.Dispose 的情况下，它在 Dispose() 中调用 GdipDisposeImage extern / 本机 Win32 调用。

IDisposable 用作释放非托管资源的机制（哪些文件句柄是）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-04-25T11:20:39.307

我还尝试了您的所有提示（ReadAllBytes、FileStream=>FromStream=>newBitmap() 来制作副本等），它们都奏效了。但是，我想知道，如果你能找到更短的东西，并且

```
using (Image temp = Image.FromFile(path))
{
    return new Bitmap(temp);
} 
```

似乎也可以工作，因为它处理文件句柄以及原始图像对象并创建一个新的位图对象，该对象独立于原始文件，因此可以保存到流或文件中而不会出错。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-25T06:32:31.063

我不得不将手指指向垃圾收集器。如果您受到垃圾收集的摆布，那么离开它并不是真正的问题。

这个人也有类似的[抱怨](http://bytes.com/groups/net-c/757587-image-file-release-handle)……他找到了一种使用 FileStream 对象而不是直接从文件加载的解决方法。

```
public static Image LoadImageFromFile(string fileName)
{
    Image theImage = null;

    fileStream = new FileStream(fileName, FileMode.Open, FileAccess.Read);
    {
        byte[] img;
        img = new byte[fileStream.Length];
        fileStream.Read(img, 0, img.Length);
        fileStream.Close();
        theImage = Image.FromStream(new MemoryStream(img));
        img = null;
    } 
```

...

这似乎是一个完整的黑客......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-07-12T20:13:13.413

如上所述，Microsoft 解决方法会在加载多个图像后导致 GDI+ 错误。Steven 上面提到的我的 VB 解决方案是

```
picTemp.Image = Image.FromStream(New System.IO.MemoryStream(My.Computer.FileSystem.ReadAllBytes(strFl))) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-12-06T02:43:53.297

我刚刚遇到了同样的问题，我试图将多个单页 TIFF 文件合并到一个多部分 TIFF 图像中。我需要使用`Image.Save()`和“Image.SaveAdd()”：[https ://msdn.microsoft.com/en-us/library/windows/desktop/ms533839%28v=vs.85%29.aspx](https://msdn.microsoft.com/en-us/library/windows/desktop/ms533839%28v=vs.85%29.aspx)

在我的情况下，解决方案是为每个图像调用“.Dispose()”，一旦我完成它们：

```
' Iterate through each single-page source .tiff file
Dim initialTiff As System.Drawing.Image = Nothing
For Each filePath As String In srcFilePaths

    Using fs As System.IO.FileStream = File.Open(filePath, FileMode.Open, FileAccess.Read)
        If initialTiff Is Nothing Then
            ' ... Save 1st page of multi-part .TIFF
            initialTiff = Image.FromStream(fs)
            encoderParams.Param(0) = New EncoderParameter(Encoder.Compression, EncoderValue.CompressionCCITT4)
            encoderParams.Param(1) = New EncoderParameter(Encoder.SaveFlag, EncoderValue.MultiFrame)
            initialTiff.Save(outputFilePath, encoderInfo, encoderParams)
        Else
            ' ... Save subsequent pages
            Dim newTiff As System.Drawing.Image = Image.FromStream(fs)
            encoderParams = New EncoderParameters(2)
            encoderParams.Param(0) = New EncoderParameter(Encoder.Compression, EncoderValue.CompressionCCITT4)
            encoderParams.Param(1) = New EncoderParameter(Encoder.SaveFlag, EncoderValue.FrameDimensionPage)
            initialTiff.SaveAdd(newTiff, encoderParams)
            newTiff.Dispose()
        End If
    End Using

Next

' Make sure to close the file
initialTiff.Dispose() 
```

# sql-server-2005 - 为什么存储过程更改时 OLE DB 数据源不更新元数据？

> ID：788346
> 
> 赞同：0
> 
> 时间：2009-04-25T06:23:23.847
> 
> 标签：sql-server-2005, ssis

我正在从 SSIS 中的 OLE DB 数据源调用存储过程。为什么 SSIS 看不到我对存储过程所做的更改？似乎有关存储过程的元数据缓存在某处。它被缓存了吗？如果是这样，我如何强制 SSIS 查看我对存储过程所做的更改？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-25T12:34:38.943

问题可能不在于 SSIS 没有看到您的更改；而是您正在更改的内容对 SSIS 不可见。

要澄清这个非常令人困惑的答案，请尝试以下操作：将 OLE DB 数据源拖到某个数据流上。将其连接到具有相同参数等的相同存储过程。检查输出列的元数据。

如果它们是您所期望的，那么问题是 SSIS 没有看到您的更改。如果这是答案，我会感到惊讶——如果有的话，SSIS对于查看元数据的变化（尤其是在 2005 版本中）*过于*挑剔。

如果您没有看到您期望的元数据，那么您将不得不编辑您的帖子，并提供有关您的存储过程的更多详细信息。但我可以说一般来说，无论是 SSIS 还是任何其他软件都不能在所有情况下确定结果集的形状。我相信他们使用 SET FMTONLY 命令来安排查询“不是真的”执行。相反，它们的所有参数都被传递为 NULL。当所有参数为 NULL 或默认值时出现的结果集是 SSIS 将看到的结果集。如果您有一个复杂的 SP，它根据输入返回不同形状的结果集，那么这可能就是问题所在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-15T20:58:15.373

要重新生成元数据，只需删除流管（红色和绿色），然后重新添加它们。这是我发现这个问题的最简单的解决方案。

# windows - 如何在 localhost Windows 上释放我的端口 80？

> ID：788348
> 
> 赞同：140
> 
> 时间：2009-04-25T06:24:27.337
> 
> 标签：windows, xampp, windows-xp, localhost, port

我安装了 XAMPP 1.6.8，但由于某种原因它不起作用。后来意识到80端口不是空闲的或者没有监听。我怎样才能释放它或让它免费？

非常感谢！

* * *

## 回答 #1

> 赞同：132
> 
> 时间：2013-04-26T18:52:19.850

那个痛苦已经为我解决了。我发现接管 80 端口的是 http api 服务。我在cmd中写道：

```
net stop http 
```

询问我“以下服务将停止，您要继续吗？” 按 y

它实际上停止了许多服务。

然后写了`localhost`，wallah，Apache 在 80 端口上启动并运行。
希望这会有所帮助

**重要提示**：Skype 默认使用端口 80，您可以在 Skype 选项 > 高级 > 连接中更改此设置 - 并取消选中“使用端口 80”

* * *

## 回答 #2

> 赞同：70
> 
> 时间：2009-04-25T06:46:06.740

`netstat -ano`

这将显示正在侦听端口 80 的进程的 PID。之后，打开任务管理器 -> 进程选项卡。从`View -> Select Columns`菜单中，启用该`PID`列，您将看到侦听端口 80 的进程的名称。

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2009-04-25T06:32:16.180

`netstat -a -b`

应该告诉你什么程序绑定到端口 80

* * *

## 回答 #4

> 赞同：43
> 
> 时间：2012-07-21T22:39:43.143

之前遇到过这个问题

如果您看到任务管理器（启用 PID 视图后），您会发现 PID=4 是“NT 内核和系统正在使用的端口 80；”

只是去

1.  控制面板
2.  程式
3.  打开/关闭 Windows 功能
4.  检查是否检查了`World wide web services`下`IIS`

如果是这样，请取消选中并再次 netstat（或 TCPVIEW）以查看 80 是否空闲。

* * *

## 回答 #5

> 赞同：37
> 
> 时间：2013-08-09T09:41:10.713

在提升的命令提示符下使用**netstat -bano**查看哪些应用正在侦听哪些端口。

但通常以下应用程序在 Windows 中使用端口 80。

1.  IIS
2.  万维网出版服务
3.  IIS 管理服务
4.  SQL Server 报告服务
5.  Web 部署代理服务

如果正在运行，请停止上面的应用程序并检查！！！

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2009-04-25T06:28:16.143

使用[TcpView](http://technet.microsoft.com/en-us/sysinternals/bb897437.aspx)查找监听端口的进程并关闭该进程。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-04-25T06:37:52.750

尝试

```
netstat -anb -p tcp 
```

显示端口和进程

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2011-01-21T10:55:48.067

其他尝试的选项是停止 SQL Server Reporting Services。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2015-03-06T21:38:03.013

在命令行中输入“netstat -ano”。我看到它显示了本地地址端口 0.0.0.0:80 的内容。

我的问题是因为我在端口 80 上有 SQL Server Reporting Services。所以我按照这些说明将端口号从 80 更改为 81：

[http://seankilleen.com/2012/11/how-to-stop-sql-server-reporting-services-from-using-port-80-on-your-server-field-notes/](http://seankilleen.com/2012/11/how-to-stop-sql-server-reporting-services-from-using-port-80-on-your-server-field-notes/)

这是我更改 SQL Server Reporting Services 的端口号后的命令行图片：

![在此处输入图像描述](https://i.stack.imgur.com/6uW5l.png)

如果您仍然遇到同样的问题，请阅读此论坛：

[http://forum.wampserver.com/read.php?2,66196,66233#REPLY](http://forum.wampserver.com/read.php?2,66196,66233#REPLY)

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2015-02-06T19:01:27.573

您可以使用`net stop http`它将显示正在使用的进程。大多数万维网服务正在使用

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2019-10-13T17:22:11.103

我试图`nginx`从这里安装 - [http://nginx.org/en/docs/windows.html](http://nginx.org/en/docs/windows.html)

转到[http://localhost/](http://localhost/) 会显示一些东西，至少是一个正确的“未找到”消息
这是因为 80 是默认端口，它被其他进程占用。

现在运行以下命令：

```
net stop http

    // Above command stopped below services  
    // - SSDP Discovery  
    // - Print Spooler  
    // - BranchCache  
    // - Function Discovery Resource Publication  
    // - Function Discovery Provider Host 
```

现在，访问[http://localhost/](http://localhost/) 将失败并显示链接页面消息损坏。

主进程是`BranchCache`
这个进程，停止后，将在几秒钟后重新启动。
所以我们需要尽快运行其他我们需要的命令，下面是一个例子：

```
// this will stop
net stop http

// immeidately run other command you want to
start nginx 
```

现在，去[http://localhost/](http://localhost/) 给了我：

```
Welcome to nginx! 
```

希望有帮助。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2009-04-25T06:27:28.610

这只是一个猜测，但由于端口 80 是 HTTP 的常规端口，您的系统上可能正在运行一个网络服务器。IIS 是否处于活动状态？

如果您正在运行 IIS，您可能正在运行 Web 场服务。这就是杀死我的xampp的原因。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2014-05-11T15:46:20.473

Skype 喜欢使用端口 80 并阻止 IIS。那是我的问题。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2015-07-25T09:10:36.157

我也有同样的问题。`net stop http`没有帮助，并且未选中 Windows 控制面板中*IIS下的**万维网服务*选项。所以在 XAMPP 控制面板中，我只检查了 Apache 开始按钮附近的 Svc 复选框（将 Apache 安装为服务）并重新启动 Windows。现在每次 Windows 启动时，Apache 都会自动启动并在任何其他服务之前占用端口 80。为我工作！

 ** * *

## 回答 #15

> 赞同：3
> 
> 时间：2018-04-01T11:29:24.647

侦听端口 80 的已知 Windows 服务

从服务管理器（运行：services.msc）中，停止并禁用这些已知绑定到端口 80 的 Windows 服务。

双击服务，将“启动类型”更改为“禁用”...</p>

1.  SQL Server 报告服务 (ReportServer)
2.  Web 部署代理服务 (MsDepSvc)
3.  分支缓存 (PeerDistSvc)
4.  同步共享服务 (SyncShareSvc)
5.  万维网发布服务 (W3SVC)
6.  Internet 信息服务器（WAS、IISADMIN）

Skype 也使用端口 80 作为默认设置，您可以取消选中它。

您可能会或可能不会安装并运行其中一些服务。

在我的情况下，“SQL Server Reporting Services”正在打开端口 80。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2021-01-22T21:18:27.747

## 以编程方式识别真实过程

### （当进程ID显示为4时）

像往常一样，这里的答案需要一定程度的交互性。

问题是当某些东西通过 HTTP.sys 进行监听时；然后，PID 始终为 4，并且正如大多数人所发现的那样，您需要一些工具来找到真正的所有者。

以下是如何以编程方式识别违规进程。没有 TcpView 等（与那些工具一样好）。是否依赖 netsh；但是，问题通常与 HTTP.sys 有关。

```
$Uri = "http://127.0.0.1:8989"    # for example

# Shows processes that have registered URLs with HTTP.sys
$QueueText = netsh http show servicestate view=requestq verbose=yes | Out-String

# Break into text chunks; discard the header
$Queues    = $QueueText -split '(?<=\n)(?=Request queue name)' | Select-Object -Skip 1

# Find the chunk for the request queue listening on your URI
$Queue     = @($Queues) -match [regex]::Escape($Uri -replace '/$')

if ($Queue.Count -eq 1)
{
    # Will be null if could not pick out exactly one PID
    $ProcessId = [string]$Queue -replace '(?s).*Process IDs:\s+' -replace '(?s)\s.*' -as [int]

    if ($ProcessId)
    {
        Write-Verbose "Identified process $ProcessId as the HTTP listener. Killing..."
        Stop-Process -Id $ProcessId -Confirm
    }
} 
```

最初发布在这里：[https ://stackoverflow.com/a/65852847/6274530](https://stackoverflow.com/a/65852847/6274530)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2020-08-11T13:53:48.273

我遇到了同样的问题，并通过在文件中进行了一些小的更改来修复它，`httpd.conf`这可以通过单击配置按钮和 Apache 选项来获得。

我所做的更改是将listen 80替换为listen 8080。

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2014-01-31T19:38:22.380

对我来说，当我在我的 Windows 8 计算机上托管 VPN 连接时，这个问题就开始了。

***只需从“控制面板\网络和 Internet\网络连接”*中删除连接即可解决问题。**

# grails - 在 Grails 中跨多个请求跟踪变量

> ID：788349
> 
> 赞同：2
> 
> 时间：2009-04-25T06:25:17.757
> 
> 标签：grails

对于用 Grails 编写的 web 应用程序，我想跟踪当前用户帐户。此外，帐户名称应显示为 url 的一部分。

1）将变量保留在会话中 2）通过帐户参数传递变量

目前我正在试验选项 2，它允许我创建像[http://app.com/accountname/controller](http://app.com/accountname/controller)这样的 URL 。缺点是对于每个 URL，我都必须将帐户名作为变量传递。这是乏味且容易出错的。

这两个选项中的任何一个更可取吗？Grails 中是否有更好的方法来实现这一点？

问候，延斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-25T06:42:29.667

我一直在使用会话变量来跟踪用户的帐户。

即：`session.user = userAccount;`。

你可以在你的登录控制器中设置它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T06:35:26.343

跟踪用户的更好方法可能是设置 cookie。它将随每个请求一起发送到服务器，您可以轻松阅读它。为什么需要帐户名作为 URL 的一部分？我想不出将*当前*用户帐户放在 URL 中的充分理由。当有人复制并粘贴链接，而其他人关注它时会发生什么？你能提供更多关于你想要做什么的细节吗？

# iphone - UIPickerView - 第一行选择不调用 didSelectRow

> ID：788357
> 
> 赞同：22
> 
> 时间：2009-04-25T06:29:10.757
> 
> 标签：iphone, uitextfield, uipickerview

`UIPickerView`我有一个`UIView`和一个`UITextField`。我让用户从选择器中选择一个值或在文本字段中输入一个自定义值。

当用户从选择器中选择任何选项时，变量值会被很好地更改（在`pickerView:didSelectRow:inComponent:`）方法中。但是如果用户没有在选择器上选择任何值（因为他们想选择已经选择的第一个选项），则不会调用此方法并且选择不会反映在变量中。

我尝试将变量的默认值设置为选择器中的第一个选项。但在这种情况下，当用户编辑文本字段时，变量将具有文本字段的文本。现在，如果用户决定再次选择第一个值，则新值不会反映在变量中。

我该如何克服呢？谢谢。

这是相关代码

在我`viewDidLoad`的这个语句中`selectText`，默认情况下将选择器的第一个选项设置为

```
[self setSelectText:[myArray objectAtIndex:0]]; 
```

**textFieldShouldReturn**

```
- (BOOL)textFieldShouldReturn:(UITextField *)txtField{
    [txtField resignFirstResponder];
    [self setSelectText:txtField.text];
    return YES;
} 
```

**PickerViewDelegate 的 didSelectRow**

```
- (void)pickerView:(UIPickerView *)pickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component
{
    // report the selection to the UI label
    [self setSelectText:[myArray objectAtIndex:[pickerView selectedRowInComponent:0]]];
} 
```

当用户编辑文本然后决定他毕竟要使用选择器的第一个值时，就会出现问题。在这种情况下，他们将关闭键盘并单击选择器的第一个选项（已被选中）。此操作不会调用`didSelectRow`，因此 selectText 的值不会更改。

为了让用户能够更改 的值`selectText`，他们首先必须从选择器中选择一些其他值，然后选择第一行。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-04-25T20:06:54.850

每次使用此代码进行选择时，而不是“推送”选择器的值：

```
- (void)pickerView:(UIPickerView *)pickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component 
```

当用户单击按钮（或您正在使用的其他事件）时，您应该使用类似于以下内容的“拉动它”：

```
- (void)myAction:(id)sender
{

    NSInteger row = [myPicker selectedRowInComponent:0];
    selectedText = [myArray objectAtIndex:(NSUInteger)row];

} 
```

清除文本：`UITextField`该类提供了一个用于清除当前文本的内置按钮。因此，如果用户不想要该文本，他可以丢弃它。

```
myTextField.clearButtonMode = UITextFieldViewModeAlways; 
```

所以在脚本中，你会检查是否`TextField`有一个值，如果它确实有一个值你使用 TextField，如果它没有一个值，你从`Picker`.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2017-03-15T15:20:51.737

您可以直接调用委托的方法，如

```
picker.delegate?.pickerView?(picker, didSelectRow: 0, inComponent: 0) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-02-03T11:55:49.030

```
-(void)textFieldDidBeginEditing:(UITextField *)textField
{
    // Only for the text field with the picker
    if (textField == self.yourTextField && [textField length]!=0)
    {
        // Select the first row programmatically 
        [self.categoriesPicker selectRow:0 inComponent:0 animated:YES];
        // The delegate method isn't called if the row is selected programmatically
        [self pickerView:self.categoriesPicker didSelectRow:0 inComponent:0];
    }

}

- (void)pickerView:(UIPickerView *)pickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component
{
    //Do all the stuff to populate the TextField
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-25T19:57:54.730

您可以在实例化 UIPickerView 后立即以编程方式选择一行吗？

```
int firstRow = 0;
int firstOptionIndex = 0;
[myPickerView selectRow:firstRow inComponent:firstOptionIndex animated:NO]; 
```

最后一行将触发您的`pickerView:didSelectRow:inComponent`委托方法。

换句话说，这应该设置变量的值，无论你在哪里存储它（`NSArray`？不清楚）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-06-18T07:23:48.113

当用户选择列表中的第一项时，要克服在 UIPickerView 中未调用 didSelectRow 的问题，您可以使用 UITapGestureRecognizer。（Swift 中的代码示例）

```
self.txtTransType = self.makeTextField(self.transType, placeHolder: "Check-in or Check-out")
self.txtTransType?.addTarget(self, action: "txtTransTypeEditing:", forControlEvents: UIControlEvents.EditingDidBegin)

func makeTextField(text: String?, placeHolder: String) -> UITextField {
    var textField = UITextField(frame: CGRect(x: 140, y: 0, width: 220.00, height: 40.00));
    textField.placeholder = placeHolder
    textField.text = text
    textField.borderStyle = UITextBorderStyle.Line
    textField.secureTextEntry = false;
    textField.delegate = self
    return textField
}

func txtTransTypeEditing(sender: UITextField) {
    var ttPickerView:UIPickerView = UIPickerView()
    ttPickerView.dataSource = self
    ttPickerView.delegate = self
    sender.inputView = ttPickerView

    let recognizer = UITapGestureRecognizer(target: self, action:Selector("handleTransTypePickerTap:"))
    recognizer.delegate = self
    ttPickerView.addGestureRecognizer(recognizer)
}

func handleTransTypePickerTap(recognizer: UITapGestureRecognizer) {
    let ttPickerView = recognizer.view as! UIPickerView
    let row = ttPickerView.selectedRowInComponent(0)
    self.txtTransType!.text = self.transTypeData[row]
} 
```

使用以下链接[UIGestureRecognizer Tutorial: Getting Started](http://www.raywenderlich.com/76020/using-uigesturerecognizer-with-swift-tutorial) to get tap recognitionr to work (需要添加 UIGestureRecognizerDelegate) 和以下代码

```
class TransactionViewController: UIViewController, UITextFieldDelegate,UIPickerViewDataSource,UIPickerViewDelegate, UIGestureRecognizerDelegate  { }

func gestureRecognizer(UIGestureRecognizer,
    shouldRecognizeSimultaneouslyWithGestureRecognizer:UIGestureRecognizer) -> Bool {
        return true
} 
```

# java - 警告：[unchecked] 未经检查的转换

> ID：788359
> 
> 赞同：9
> 
> 时间：2009-04-25T06:30:20.070
> 
> 标签：java

我收到以下警告：

```
warning:[unchecked] unchecked conversion
[javac]found:java.util.List
[javac] required:java.util.List<edu.fullerton.cs476s09.espressobar.jpa.espressobar_milk>
return query.getResultList(); 
```

可能的问题和可能的解决方案是什么？我正在使用以下代码：

```
@Stateless
@Remote(Order.class)
//@EntityListeners(MyListener.class)
public class OrderBean implements Order
{ 
    /**
     * The entity manager object, injected by the container
     */

    @PersistenceContext

    private EntityManager manager;

    public List<espressobar_milk> listMilk() 
    {
        Query query = manager.createQuery("SELECT m FROM espressobar_milk m");
        return query.getResultList();
    }...
.....
..} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-01-09T15:37:48.190

I am using EJB 3.1 and I had the same problem. I found another solution:

```
TypedQuery<espressobar_milk> query = manager.createQuery("SELECT m FROM espressobar_milk m", espressobar_milk.class);         
return query.getResultList(); 
```

This solves the unchecked conversation warning (you don't need the @SuppressWarnings annotation anymore).

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-25T06:37:45.387

好吧，我们没有`Query`这里有什么的细节，但大概它的`getResultList`方法返回一个 raw `List`。基本上，编译器不能确定由返回的列表`getResultList`是否只包含 的实例`espressobar_milk`（它比这稍微微妙一些，但我们暂时将其留在那里）。

您可以尝试使其成为强类型，可能通过更改`Query`类，或者您可以使用注释方法

```
@SuppressWarnings("unchecked") 
```

如果您确信它是正确的，但没有办法实现编译时安全。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-25T16:47:30.913

看起来您正在使用[Hibernate](http://hibernate.org/)，它目前正在实现 JPA 1.0（希望 Hibernate 在发布时会实现 JPA 2.0。（[Toplink](http://www.oracle.com/technology/products/ias/toplink/index.html)目前是 JPA 2.0 的参考实现））。Hibernate 没有使用任何 java 1.5 特性，因此没有可用的通用集合。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-25T08:08:08.523

大概是因为

```
return query.getResultList(); 
```

is`List`和 not `List< E >`，正如预期的那样 ( `List< espressobar_milk >`)。[ [http://java.sun.com/j2se/1.5.0/docs/api/java/util/List.html](http://java.sun.com/j2se/1.5.0/docs/api/java/util/List.html) ] 这就是它显示警告的原因。在任何情况下，您都可以使用以下命令抑制此警告：

```
@SuppressWarnings ( "unchecked" )
public List<espressobar_milk> listMilk() 
{
    Query query = manager.createQuery("SELECT m FROM espressobar_milk m");
    return query.getResultList();
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-25T08:49:49.827

未经检查的转换警告通常来自 Java 的泛型类型擦除机制。这个想法是使用泛型的代码可以与不使用泛型的代码协作（实际上，生成的代码省略了泛型类型）。

但是，当您尝试将泛型“附加”到非泛型列表时，您也会收到此警告（因为这与会抛出 ClassCastException 的基于类的转换不同）。在这种情况下，尝试将牛奶类型附加到 getResultList 返回的非通用列表会产生错误。

阅读[Java 泛型教程](http://java.sun.com/docs/books/tutorial/java/generics/erasure.html)以获取更多信息。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-11-29T17:54:50.847

```
@SuppressWarning ( "unchecked" ) 
```

应该：

```
@SuppressWarnings("unchecked") 
```

# sorting - 批评这个深夜，菜鸟 Haskell 代码

> ID：788361
> 
> 赞同：7
> 
> 时间：2009-04-25T06:31:03.530
> 
> 标签：sorting, functional-programming, haskell

我正在学习[Real World Haskell](http://book.realworldhaskell.org/)，目前正在做第 3 章末尾的练习。

我采取了一种不同寻常的方法：**尽管我知道他们尚未涵盖的一些语言功能会对我有所帮助，但我仍在尝试*仅*使用他们明确涵盖的内容来进行这些练习。**为什么？真的只是为了好玩。感觉就像它迫使我给我的大脑一些额外的递归练习。

所以我刚刚完成了如下练习：**“创建一个函数，根据每个子列表的长度对列表列表进行排序。（您可能需要查看 Data.List 模块中的 sortBy 函数。）”**

现在，他们提出了有关 Data.List 模块的提示。但是他们没有说在哪里可以找到参考文档，关于如何导入东西等等。所以我决定*推出自己的排序*，看看我是否能做到。我使用了冒泡排序，因为它是最简单的算法。

结果如下。我想让你的 Haskell 大师来批评它……但请**记住以下警告：** *如果你提出改进建议，请基于 Real World Haskell 第 3 章所涵盖的语言特性（或者你猜的那些特性）可能无需费心查找）。我**知道**有很多很棒的语言特性等着我，它们可以让我把这段代码做得更好，但现在的具体挑战是用迄今为止所涵盖的“原始”特性来做到这一点。*

我确信在某些情况下我会伸手去抓我的肘部，在递归和模式匹配可以为我做更多事情时使用显式控制流的情况等等。我相信代码可能是也变得更短且更具可读性。我敢打赌，有一些我不知道的好习惯可以与我限制自己使用的原始语言功能一起使用。这些是我希望收到的提示。

这可能是任何语言中我引以为豪的最丑陋的代码（至少，我记得）。我的第一次尝试是用一种函数式语言，而不是“Hello, world”类型的东西。现在你要打败它了:)。请温柔一点，但我期待着一些深刻的见解。谢谢。

```
areListsEqual :: (Eq a) => [a] -> [a] -> Bool

areListsEqual [] [] = True
areListsEqual [] _  = False
areListsEqual _ []  = False

areListsEqual xs ys = (head xs == head ys)  && (areListsEqual (tail xs) (tail ys))

charlieSort :: (Eq a) => [[a]] -> [[a]]

charlieSort [] = []
charlieSort (x:xs) | null xs = [x]
charlieSort xs | (length xs) >= 2 = if(not (areListsEqual xs wip))
                    then charlieSort wip 
                    else wip
                    where
                      first = head xs
                      second = head (tail xs)
                      theRest = drop 2 xs
                      swapPairIfNeeded a b = if(length a >= length b) 
                          then [second, first]
                          else [first, second]
                      modifiedPair = swapPairIfNeeded first second
                      wip = (take 1 modifiedPair) ++ charlieSort ( (drop 1 modifiedPair) ++ theRest) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-25T08:21:48.850

I would first and foremost start using pattern-matching.

```
areListsEqual :: Eq a => [a] -> [a] -> Bool
areListsEqual [    ] [    ] = True
areListsEqual [    ] _      = False
areListsEqual _      [    ] = False
areListsEqual (x:xs) (y:ys) = x == y && areListsEqual xs ys 
```

Note how much more readable this is, when `head` and `tail` is avoided.

```
charlieSort :: Eq a => [[a]] -> [[a]]
charlieSort    [                    ] = []
charlieSort    [x                   ] = [x]
charlieSort xs@(first:second:theRest)
  | areListsEqual xs wip              = wip
  | otherwise                         = charlieSort wip
  where
  swapPairIfNeeded a b
    | length a >= length b = [second,first]
    | otherwise            = [first,second]
  modifiedPair = swapPairIfNeeded first second
  wip = take 1 modifiedPair ++ charlieSort (drop 1 modifiedPair ++ theRest) 
```

I changed the `if`-`then`-`else` to a guard for slightly improved readability (YMMV). Instead of checking that the list has at least two elements with a call to `length` we use pattern-matching, which also allows us to name `first`,`second`,`theRest` directly. The `name @ pattern` pattern both matches the input against `pattern` *and* names the whole input as `name`.

Now, I want to avoid using `take` and `drop` for extracting the two elements of `modifiedPair`, so the last two lines are changed into

```
 [shorter,longer] = swapPairIfNeeded first second
  wip = [shorter] ++ charlieSort ([longer] ++ theRest) 
```

where you could write the last line as

```
 wip = shorter : charlieSort (longer : theRest) 
```

if you preferred. But why should `swapPairIfNeeded` return the `shorter` and the `longer` of the `first` and `second` list in a *list* ? Why not use a pair like

```
 swapPairIfNeeded a b
    | length a >= length b = (second,first)
    | otherwise            = (first,second)
  (shorter,longer) = swapPairIfNeeded first second 
```

? In most circumstances, it is better to use tuples for fixed number of values (possibly of differing types) and to use lists for variable number of values (necessarily of same type). But it seems strange that `swapPairIfNeeded` compares its arguments `a` and `b`, but then returns `first` and `second` anyway. In this case, instead of letting it return `a` and `b` in a pair, I will remove `swapPairIfNeeded` altogether instead :

```
 (shorter,longer)
    | length first >= length second = (second,first)
    | otherwise                     = (first,second) 
```

"unfolding" the body of `swapPairIfNeeded` into the definition of `(shorter,longer)`.

So now the code of `charlieSort` looks like

```
charlieSort :: Eq a => [[a]] -> [[a]]
charlieSort    [                    ] = []
charlieSort    [x                   ] = [x]
charlieSort xs@(first:second:theRest)
  | areListsEqual xs wip              = wip
  | otherwise                         = charlieSort wip
  where
  (shorter,longer)
    | length first >= length second = (second,first)
    | otherwise                     = (first,second)
  wip = shorter : charlieSort (longer : theRest) 
```

Finally, I should remark that `charlieSort` doesn't really implement bubble-sort, because the recursive call to `charlieSort` will not only make one "bubble-up" pass along the list, but also fully sort the list `longer : theRest`, so that all that has to be done after this recursive call (before returning one "level up") is to possibly percolate `shorter` to its rightful place.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-25T22:32:35.823

Charlie: I'll confine myself to a single critique: **never use `head`, `tail`, or `length` if you can use pattern matching**:

```
areListsEqual [] [] = True
areListsEqual (x:xs) (y:ys) = x == y && areListsEqual xs ys
areListsEqual _ _   = False 
```

I can't follow your sort algorithm (and it would be courteous of you to reformat your question so as to eliminate the horizontal scroll bar), but I'd rewrite the first three lines like this:

```
charlieSort []  = []
charlieSort [x] = x
charlieSort (x1:x2:xs) = if ... 
```

(P.S. All uses of `head` and `tail` can be rewritten using pattern matching, and beginners should do so. Not all uses of `length` can be replaced by pattern matching, but common noob codes like `length xs == 0` or `length xs >= 2` can and should be rewritten.)

(P.P.S. Even experienced Haskell programmers seldom use 'head'. Less than two-tenths of one percent of source lines in the Glasgow Haskell compiler mention 'head', and eyeballing those mentions, roughly half are in string literals or comments. That's approximately one use of 'head' for every 1500 lines of code.)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-25T07:07:50.277

You don't need the `areListsEqual` function. You can compare lists with the `(==)` function. And I'd use a quicksort rather than bubblesort. Here's a solution that I think uses only what you should have learned so far.

```
charlieSort :: (Eq a) => [[a]] -> [[a]]
charlieSort []     = []
charlieSort (x:xs) = charlieSort (filter (cmpLen (>) x) xs) ++ [x] ++
                     charlieSort (filter (cmpLen (<=) x) xs)
   where filter _ [] = []
         filter p (x:xs) = (if (p x) then (x:) else id) (filter p xs)
         cmpLen f x y = f (length x) (length y) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-25T07:18:04.587

I'm on chapter 8, so I'm no old hand, but I'd prefer

```
areListsEqual x:xs y:ys = (x == y) && (areListsEqual xs ys)
areListsEqual [] [] = True
areListsEqual _ _ = False 
```

It seems a bit more in line with Haskell style.

Similarly,

```
charlieSort [] = []
charlieSort (x:[]) = [x]
charlieSort (x1:x2:xs) = blah blah 
```

swapPairIfNeed works as is because you only call it with first and second as its arguments (in that order), but you probably meant

```
swapPairIfNeed a b = if (length a >= length b)
    then [b, a]
    else [a, b] 
```

In fact, I prefer the third case of charlieSort to look like

```
charlieSort (x1:x2:xs) = if not (areListsEqual x1:x2:xs wip)
                         then charlieSort wip
                         else wip
    where swapPairIfNeeded a b = if (length a >= length b)
                                 then (b, a)
                                 else (a, b)
          wip = f (swapPairIfNeeded first second)
          f (a, b) = a : (charlieSort b:xs) 
```

I think this was all covered by chapter 3.

Now, let's examine the algorithm. Even holding ourselves to bubble sort, there's no need to check the whole list after sorting. Instead, we can swap the first two elements if necessary, then sort the tail of the list. If the head is shorter than the head of the sorted tail, we're done.

```
charlieSort (x1:x2:xs) = if (length a <= length (head sortedTail))
                         then a : sortedTail
                         else charlieSort (a : sortedTail)
    where sortedTail = charlieSort (b:xs)
          (a, b) = if (length x1 >= length x2)
                   then (x2, x1)
                   else (x1, x2) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-25T11:32:31.310

You claim that bubble sort is the easiest sorting algorithm, but that's not quite the case here. Bubble sort is great for arrays, where you index into them linearly. For Haskell's linked lists, insertion sort is actually much prettier to look at.

Let's start with the `insert` function:

```
winsert :: [a] -> [[a]] -> [[a]]
winsert x [] = [x]
winsert x (y:ys)
    | length x < length y = x : y : ys
    | otherwise = y : winsert x ys 
```

*   If the list is empty, put `x` into it
*   If the list isn't empty:
    *   If `x < y`, then `x` belongs at the front of the list
    *   Otherwise, the head of the list is `y`, and the tail is made of up `x` being inserted somewhere into `ys`.

Next, we have the actual sorting function:

```
wsort :: [[a]] -> [[a]]
wsort [] = []
wsort [x] = [x]
wsort (x:xs) = winsert x (wsort xs) 
```

*   If the list is empty, return it
*   If the list has only one item, it doesn't need to be sorted
*   If the list is longer than that, sort `xs`, then insert `x` into the now sorted `xs`

Interestingly, by modifying `winsert` to take a function as an argument (in place of `length`), `wsort` could be used to sort based on all kinds of criteria. Try making one that sort a list of lists based on the sum of each sublist.

# asp.net - 通过 ASP.NET 基于 DOS 的打印

> ID：788363
> 
> 赞同：2
> 
> 时间：2009-04-25T06:31:44.060
> 
> 标签：asp.net, printing

那么我的情况是这样的：

我在服务器上以文本文件的形式生成报告，需要在点阵打印机上使用 DOS 模式打印。我想避免 Windows 打印，因为它太慢了。ASP.NET 中有没有一种方法可以通过它执行基于 DOS 的打印，因为它最适合点阵打印机。我已经搜遍了网络，但找不到任何解决方案或指示。是否有任何机构有任何他们可能已经实施或偶然发现的指针/解决方案。

此应用程序是基于 Web 的应用程序。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-25T07:00:13.367

如果我理解正确，一种选择是执行一个批处理文件，该文件将从 ASP.NET 进行实际打印。从[这里开始](http://codebetter.com/blogs/brendan.tompkins/archive/2004/05/13/13484.aspx)：（显然，您可以省略一些将输出写入页面的代码）

```
// Get the full file path
string strFilePath = “c:\\temp\\test.bat”;

// Create the ProcessInfo object
System.Diagnostics.ProcessStartInfo psi = new System.Diagnostics.ProcessStartInfo("cmd.exe");
psi.UseShellExecute = false; 
psi.RedirectStandardOutput = true;
psi.RedirectStandardInput = true;
psi.RedirectStandardError = true;
psi.WorkingDirectory = “c:\\temp\\“;

// Start the process
System.Diagnostics.Process proc = System.Diagnostics.Process.Start(psi);

// Open the batch file for reading
System.IO.StreamReader strm = System.IO.File.OpenText(strFilePath); 

// Attach the output for reading
System.IO.StreamReader sOut = proc.StandardOutput;

// Attach the in for writing
System.IO.StreamWriter sIn = proc.StandardInput;

// Write each line of the batch file to standard input
while(strm.Peek() != -1)
{
  sIn.WriteLine(strm.ReadLine());
}

strm.Close();

// Exit CMD.EXE
string stEchoFmt = "# {0} run successfully. Exiting";

sIn.WriteLine(String.Format(stEchoFmt, strFilePath));
sIn.WriteLine("EXIT");

// Close the process
proc.Close();

// Read the sOut to a string.
string results = sOut.ReadToEnd().Trim();

// Close the io Streams;
sIn.Close(); 
sOut.Close();

// Write out the results.
string fmtStdOut = "<font face=courier size=0>{0}</font>";
this.Response.Write(String.Format(fmtStdOut,results.Replace(System.Environment.NewLine, "<br>"))); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T12:25:45.847

BobbyShaftoe 的回答是正确的。这是它的迂腐版本：

```
public static void CreateProcess(string strFilePath)
{
    // Create the ProcessInfo object
    var psi = new ProcessStartInfo("cmd.exe")
                  {
                      UseShellExecute = false,
                      RedirectStandardOutput = true,
                      RedirectStandardInput = true,
                      RedirectStandardError = true,
                      WorkingDirectory = "c:\\temp\\"
                  };

    // Start the process
    using (var proc = Process.Start(psi))
    {
        // Attach the in for writing
        var sIn = proc.StandardInput;

        using (var strm = File.OpenText(strFilePath))
        {
            // Write each line of the batch file to standard input
            while (strm.Peek() != -1)
            {
                sIn.WriteLine(strm.ReadLine());
            }
        }

        // Exit CMD.EXE

        sIn.WriteLine(String.Format("# {0} run successfully. Exiting", strFilePath));
        sIn.WriteLine("EXIT");

        // Read the sOut to a string.
        var results = proc.StandardOutput.ReadToEnd().Trim();

        // Write out the results.
        string fmtStdOut = "<font face=courier size=0>{0}</font>";
        this.Response.Write(String.Format(fmtStdOut,results.Replace(System.Environment.NewLine, "<br>")));
    }
} 
```

# database - 本地数据库是否有任何选项，例如用于 j2me 的 Sqlite - CLDC 设备？

> ID：788397
> 
> 赞同：12
> 
> 时间：2009-04-25T06:50:10.100
> 
> 标签：database, java-me, cldc

本地数据库是否有任何选项，例如用于 j2me 的 Sqlite - CLDC 设备？PerstLite 和 OpenBaseMovil 都在双重许可下。是否有任何开源选项？或者，开发应用程序的任何替代方式。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-21T18:08:08.603

来自[J2ME 中的数据库列表](http://www.coderanch.com/t/230853/Java-Micro-Edition/Mobile/List-Database-J-ME)：
[Apache Derby](http://db.apache.org/derby/) - 一个开源关系数据库 / 大约 2 兆字节的
[Java DB](http://developers.sun.com/javadb/) - Sun 支持的 Apache Derby 数据库分布 / 占用空间为 2.5 MB
[Floggy](http://floggy.sourceforge.net/) - 用于 J2ME/MIDP 应用程序的免费对象持久性框架 / 11k API
[J2MEMicroDB](http://morfeo.upc.es/crom/mod/wiki/view.php?id=16&page=Qu%E8+%E9s+J2MELSDATALIB&gid=0&uid=0) -用于 J2ME 的免费对象持久性框架
[mDrawer](http://sourceforge.net/projects/mdrawer/) - 具有 DES 加密的 J2ME 通用数据库程序
[RMS DB 类](http://sourceforge.net/projects/rms-db-class/)- 提供对手机 RMS 数据库系统的轻松访问的 J2ME 类
[Micro DB](http://sourceforge.net/projects/microdb/) - 在 J2ME 平台中实现关系数据库

对于少量数据，您也可以使用[kXML](http://kxml.sourceforge.net/kxml2/) + [miniXPath](http://minixpath.sourceforge.net/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-01-19T10:02:35.950

我认为弗洛吉很有希望。它经常更新，并且有很好的文档。在 Apache 许可下发布。

# asp.net - asp.net mvc 作为一个宁静的服务和一个应用程序？

> ID：788398
> 
> 赞同：1
> 
> 时间：2009-04-25T06:52:17.630
> 
> 标签：asp.net, asp.net-mvc, architecture, rest

目前我正在研究 asp.net mvc 中的小型应用程序。它是某种本地化工具。我们的客户登录我们的应用程序，他们可以翻译他们使用的应用程序中显示的术语。它是这样发生的：

1.  登录本地化网站
2.  查找并翻译某些术语，例如“目录”应用程序中按钮的标题
3.  启动该应用程序（例如，来自 2\. 的“目录”应用程序）并通过 Web 服务，他们使用已翻译的术语更新本地数据库

这是我们的旧解决方案，效果很好。但是现在，我正在重构 asp.net mvc 中的翻译工具应用程序，我想，为什么我们在 mvc 和 Web 服务中有单独的逻辑（加倍）？为什么我们不能只使用 mvc 作为 Web 服务...这样我只有一个逻辑（获取元素和更新），我们不需要创建 wcf Web 服务或其他东西。最重要的是，我没有依赖 dll 的网格桌面应用程序，其中我有这个逻辑。

现在的问题。除了视图和 JsonResults 之外，我可以从 mvc 中的控制器获得什么……我可以直接获取我的对象的集合吗？

或者更简单的问题，我如何将 asp.net mvc 用作 Web 服务。你的经验是什么？

欢呼马尔科

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T07:10:34.777

这真的取决于你的需求。您当然可以将 ASP.NET MVC 应用程序用作数据服务，但听起来您应该将共享代码整理到一个公共库中，并在两个应用程序中引用该库。Web 服务项目提供的某些东西纯粹作为控制器操作会更加困难。（反序列化、wsdl等...）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T10:03:32.760

这实际上取决于什么会消耗您的 Web 服务。

例如：jQuery 可以很好地使用 JsonResults，因为我可以从一个操作中返回复杂的对象（包括集合、数组、嵌套对象等），并让 jQuery 将其反序列化回 javascript 对象，以便在客户端浏览器中使用。当然，您在序列化过程中会失去类型安全性，但这在大多数基于 REST/SOAP 的 Web 服务中是非常可预期的。如果您确实需要消费应用程序的类型安全，请坚持使用 WCF（或类似的）。

我只需创建一个标志以将操作返回为 Json。我注意到一些网站是这样做的。假设你有这个动作：

```
 public ActionResult GetPeople()
    {
        IList<Person> result = svc.GetPeople();

        return View(result);
    } 
```

..此操作的结果通常会呈现到某些视图中。这很好，但是如果您想将该操作用作 Web 服务，您可以简单地将其更改为：

```
 public ActionResult GetPeople(string ajax)
    {
        IList<Person> result = svc.GetPeople();

        if (Convert.ToBoolean(ajax))
            return Json(result);
        else
            return View(result);
    } 
```

..因此，如果您的消费应用程序不介意序列化的 Json，那么不要像这样调用 GET 请求`http://domain.com/controller/GetPeople`（因为浏览器会获取视图），您只需像这样添加 ajax 标志`http://domain.com/controller/GetPeople?ajax=true`以返回 Json。更合适的标志可能是 'json' 而不是 'ajax' - 'ajax' 很常见，因为此方法用于支持下层浏览器的操作，这些操作可以选择使用 ajax 调用。

我一直在考虑将其添加到我的 mvc 应用程序中，但我不喜欢使用此标志修改每个操作并添加更多 if 语句的想法。我的想法是创建一个自定义属性来装饰您想要此功能的操作，并且该属性动态添加额外的标志并有条件地将模型数据返回为 Json 而不是最初指定的。搏一搏。

# cross-compiling - 指向 NSPR/DIST 目录的 Spidermonkey

> ID：788407
> 
> 赞同：0
> 
> 时间：2009-04-25T06:56:38.493
> 
> 标签：cross-compiling, spidermonkey, nspr

我一直在尝试交叉编译 Spidermonkey，但遇到了`prtypes.h`(NSPR) 无法识别的问题。我已经尝试修改`Makefile.ref`//以指向所需的 NSPR/DIS 目录`config.mk`。`jsconfig.mk`我一定错过了一些基本步骤，因为它仍然无法使事情正常进行。您对如何正确修改生成文件以将我的蜘蛛猴指向正确的 NSPR 库有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-03-29T16:02:59.817

你可能已经解决了你的问题，但仍然......

`make JS_DIST=dir JS_THREADSAFE=1 -f Makefile.ref`

`dir`是安装 nspr 的位置，我认为它必须是其目录的**完整路径**（如 /usr/local/nspr 或 /home//mozilla/nsprpub/dist 如果未安装），否则它可能会出现一些问题修改spidermonkey 的makeif。

[https://developer.mozilla.org/en/SpiderMonkey/JSAPI_Reference/JS_THREADSAFE](https://developer.mozilla.org/en/SpiderMonkey/JSAPI_Reference/JS_THREADSAFE)

# database - 地理定位数据库是如何组装的？

> ID：788408
> 
> 赞同：12
> 
> 时间：2009-04-25T06:56:56.353
> 
> 标签：database, geolocation, privacy

我不是在问要使用什么地理定位服务或如何使用它们。

我在问，这些公司怎么知道每个 IP 地址在哪里？是否存在侵犯隐私的行为？

我查看了维基百科页面，他们只能说使用 WHOIS 服务，这显然根本不起作用：我的 IP 归在另一个州上市的公司所有。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T07:09:13.173

ISP 的逻辑位置以及 ARIN 知道网络分配的位置有很多事情要做。

他们还可以根据路由器确定您的位置。

在命令/终端窗口中运行它：tracert google.com

我相信你可以在你的 tracert 中看到一些基于位置的信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-25T08:42:43.900

许多此类数据库似乎是从区域互联网注册机构（RIPE、ARIN 等）持有的“whois”数据库中提取的。

这些在域名“whois”查找中是*不一样的，它们专门与 IP 地址相关。*

此类数据提取是对其数据库版权的非法侵犯，并且严格违反其条款和条件。

请参阅[按 IP 进行地理查找的工作原理？](https://stackoverflow.com/questions/274308/how-does-geographic-lookup-by-ip-work)更多细节。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-26T09:28:42.893

让我打个比方，每辆车都有一个唯一的号码，可以从制造商那里识别它，公司有一份所有汽车的清单，这些汽车发往世界各地的每个市长经销商，每个经销商都有几个经销商他们分配一组汽车进行销售，每个经销商都将汽车销售给最终客户。所以理论上，如果制造商想知道世界在哪里是一辆汽车，他不必问，因为他知道它降落在哪个国家。

将其转换为 IP，每家出售公共 IP 地址的公司都有谁拥有它的记录，并且他们通常将 1000 个批量赠送给 ISP（电话号码曾经是这样的）。例如，我可以通过查看前 2 个组来告诉您 IP 是否来自我的国家。另一方面，托管服务提供商和数据中心以相同的方式工作，他们几乎总是知道机器的物理位置，最后但并非最不重要的一点是，进行跟踪会将跃点跳到最近的位置（理论上，因为您可以强制跟踪是什么你想要的）IP 到盒子，这意味着如果你之前有一个跃点，你可以猜出位置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-25T07:26:04.570

这些公司为数据付费。

有很多方法可以获得这些数据（并非都是非法的），一种简单的方法是，例如，提供免费服务，鼓励您提供一些关于您的实际位置的信息，例如[DslReports](http://www.dslreports.com/data)。一旦他们知道一个 IP 并且 ISP 很容易关联来自同一区域的其他 IP。

正如您[在此处](http://www.dslreports.com/whois)看到的，一家公司推荐另一家公司，这样您就可以看到联系。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-03-15T05:01:33.040

我想知道同样的事情。查看 Google 项目经理 Ken Norton 对 Google 如何获取地理位置数据的回应：[http ://www.quora.com/How-does-Google-keep-its-geolocation-database-updated-with-new- MAC 地址](http://www.quora.com/How-does-Google-keep-its-geolocation-database-updated-with-new-MAC-addresses)。

# silverlight - Silverlight 中的动态控制模板

> ID：788409
> 
> 赞同：1
> 
> 时间：2009-04-25T06:57:26.417
> 
> 标签：silverlight

我正在尝试使 Silverlight 中的按钮使用控件模板来更改其外观。

我需要在代码中动态执行此操作（而不是 xaml 标记）。Button 对象有一个 Template 属性，您可以为其分配一个 ControlTemplate。

但是如何将 UI 元素填充到 ControlTemplate 中？（在 WPF 中，有一个 VisualTree 属性，但在 Silverlight 中不存在这样的属性）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T12:08:01.257

我不确定这是否有帮助，但以防万一。要在代码后面（不是 XAML）中使用控件模板创建按钮，我已经这样做了：

1.  从 xml 定义加载控件模板（下面是源链接）

    ```
     byte[] bytes = ReadBytesFromStream("BestBuyRemix.BL.buttontemplate.xml");
        string buttonTemplate = "";
        UTF8Encoding encoding = new UTF8Encoding();
        buttonTemplate = encoding.GetString(bytes.ToArray(), 0, (int)bytes.Length); 
    ```

2.  创建按钮并将其添加到可视化树（在本例中为包装面板）

string onebutton = string.Format(buttonTemplate, mnu.CatItemName, mnu.CatItemImage, "{StaticResource buttonStyle1}", "{StaticResource CatItemNameBlock}", "{StaticResource ThumbNailPreview}", ictr.ToString()); ictr += 1;

```
 Button bt = (Button)XamlReader.Load(onebutton);
        bt.Tag = mnu.CatItemPageUri;
        bt.Click += new RoutedEventHandler(bt_Click);

        Wrappable.Children.Add(bt); 
```

我在我的博客上写了一篇关于 Best Buy Remix API 的文章，它使用它在详细信息页面中构建产品列表。它有一个指向 Silverlight 源的链接。如果你有兴趣。
[博文链接](http://www.faxt.com/blog/post/2009/01/ReMix2c-a-new-API-from-Best-Buy.aspx)

# python - 检查python脚本是否正在运行

> ID：788411
> 
> 赞同：118
> 
> 时间：2009-04-25T06:59:10.950
> 
> 标签：python, process, daemon

我有一个 python 守护程序作为我的 web 应用程序的一部分运行/如何快速检查（使用 python）我的守护程序是否正在运行，如果没有，启动它？

我想这样做来修复守护程序的任何崩溃，因此脚本不必手动运行，它会在调用后立即自动运行，然后继续运行。

如果我的脚本正在运行，我如何检查（使用 python）？

* * *

## 回答 #1

> 赞同：168
> 
> 时间：2011-10-13T17:36:26.663

在 Linux 系统上很方便的一种技术是使用域套接字：

```
import socket
import sys
import time

def get_lock(process_name):
    # Without holding a reference to our socket somewhere it gets garbage
    # collected when the function exits
    get_lock._lock_socket = socket.socket(socket.AF_UNIX, socket.SOCK_DGRAM)

    try:
        # The null byte (\0) means the socket is created 
        # in the abstract namespace instead of being created 
        # on the file system itself.
        # Works only in Linux
        get_lock._lock_socket.bind('\0' + process_name)
        print 'I got the lock'
    except socket.error:
        print 'lock exists'
        sys.exit()

get_lock('running_test')
while True:
    time.sleep(3) 
```

它是原子的，并且可以避免在您的进程收到 SIGKILL 时出现锁定文件的问题

您可以[在文档中阅读`socket.close`](https://docs.python.org/2/library/socket.html#socket.socket.close)垃圾收集时套接字会自动关闭的信息。

* * *

## 回答 #2

> 赞同：107
> 
> 时间：2009-04-25T17:37:56.267

将 pidfile 放到某处（例如 /tmp）。然后你可以通过检查文件中的PID是否存在来检查进程是否正在运行。干净关闭时不要忘记删除文件，并在启动时检查它。

```
#/usr/bin/env python

import os
import sys

pid = str(os.getpid())
pidfile = "/tmp/mydaemon.pid"

if os.path.isfile(pidfile):
    print "%s already exists, exiting" % pidfile
    sys.exit()
file(pidfile, 'w').write(pid)
try:
    # Do some actual work here
finally:
    os.unlink(pidfile) 
```

然后，您可以通过检查 /tmp/mydaemon.pid 的内容是否是现有进程来检查进程是否正在运行。Monit（上面提到的）可以为您执行此操作，或者您可以编写一个简单的 shell 脚本来使用 ps 的返回码为您检查它。

```
ps up `cat /tmp/mydaemon.pid ` >/dev/null && echo "Running" || echo "Not running" 
```

为了获得额外的功劳，您可以使用 atexit 模块来确保您的程序在任何情况下（当被杀死、引发异常等）都清理其 pidfile。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2015-10-09T17:55:11.447

[pid](https://pypi.python.org/pypi/pid/)库可以做到这一点。

```
from pid import PidFile

with PidFile():
  do_something() 
```

它还将自动处理 pidfile 存在但进程未运行的情况。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2010-11-27T10:41:19.593

当然，Dan 的例子不会像它应该的那样工作。

事实上，如果脚本崩溃、出现异常或没有清理 pid 文件，脚本将运行多次。

我建议基于另一个网站的以下内容：

这是为了检查是否已经存在一个锁文件

```
\#/usr/bin/env python
import os
import sys
if os.access(os.path.expanduser("~/.lockfile.vestibular.lock"), os.F_OK):
        #if the lockfile is already there then check the PID number
        #in the lock file
        pidfile = open(os.path.expanduser("~/.lockfile.vestibular.lock"), "r")
        pidfile.seek(0)
        old_pid = pidfile.readline()
        # Now we check the PID from lock file matches to the current
        # process PID
        if os.path.exists("/proc/%s" % old_pid):
                print "You already have an instance of the program running"
                print "It is running as process %s," % old_pid
                sys.exit(1)
        else:
                print "File is there but the program is not running"
                print "Removing lock file for the: %s as it can be there because of the program last time it was run" % old_pid
                os.remove(os.path.expanduser("~/.lockfile.vestibular.lock")) 
```

这是我们将 PID 文件放入锁定文件的代码的一部分

```
pidfile = open(os.path.expanduser("~/.lockfile.vestibular.lock"), "w")
pidfile.write("%s" % os.getpid())
pidfile.close() 
```

此代码将检查 pid 与现有正在运行的进程相比的值，避免重复执行。

我希望它会有所帮助。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-04-25T07:16:06.637

在 UNIX 上有非常好的重启进程的包。有一个关于构建和配置它的很棒的教程是[monit](http://www.cyberciti.biz/tips/howto-monitor-and-restart-linux-unix-service.html)。通过一些调整，您可以获得可靠的成熟技术来保持您的守护进程。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2018-04-27T13:11:47.250

我的解决方案是检查在 windows 和 ubuntu linux 上测试的进程和命令行参数

```
import psutil
import os

def is_running(script):
    for q in psutil.process_iter():
        if q.name().startswith('python'):
            if len(q.cmdline())>1 and script in q.cmdline()[1] and q.pid !=os.getpid():
                print("'{}' Process is already running".format(script))
                return True

    return False

if not is_running("test.py"):
    n = input("What is Your Name? ")
    print ("Hello " + n) 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-04-25T07:05:50.670

有无数种选择。一种方法是使用系统调用或 python 库为您执行此类调用。另一种是简单地产生一个过程，如：

```
ps ax | grep processName 
```

并解析输出。很多人选择这种方法，在我看来这不一定是一个坏方法。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2017-06-06T18:21:29.343

遇到这个老问题，我自己正在寻找解决方案。

使用[psutil](https://github.com/giampaolo/psutil)：

```
import psutil
import sys
from subprocess import Popen

for process in psutil.process_iter():
    if process.cmdline() == ['python', 'your_script.py']:
        sys.exit('Process found: exiting.')

print('Process not found: starting it.')
Popen(['python', 'your_script.py']) 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-26T07:36:54.317

我是管理守护进程的[超级](http://supervisord.org)粉丝。它是用 Python 编写的，因此有很多关于如何与 Python 交互或扩展它的示例。出于您的目的，[XML-RPC 过程控制 API](http://supervisord.org/manual/current/api.process-control.html)应该可以很好地工作。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-10-02T00:09:37.410

试试这个其他版本

```
def checkPidRunning(pid):        
    '''Check For the existence of a unix pid.
    '''
    try:
        os.kill(pid, 0)
    except OSError:
        return False
    else:
        return True

# Entry point
if __name__ == '__main__':
    pid = str(os.getpid())
    pidfile = os.path.join("/", "tmp", __program__+".pid")

    if os.path.isfile(pidfile) and checkPidRunning(int(file(pidfile,'r').readlines()[0])):
            print "%s already exists, exiting" % pidfile
            sys.exit()
    else:
        file(pidfile, 'w').write(pid)

    # Do some actual work here
    main()

    os.unlink(pidfile) 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-09-04T10:21:17.737

与其开发你自己的 PID 文件解决方案（它比你想象的有更多的微妙之处和极端情况），不如看看[supervisord——](http://supervisord.org/)这是一个过程控制系统，它可以很容易地围绕现有的 Python 包装作业控制和守护进程行为脚本。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-06-12T15:31:37.570

其他答案非常适合 cron 作业之类的事情，但是如果您正在运行守护程序，则应该使用[daemontools](http://cr.yp.to/daemontools.html)之类的东西对其进行监视。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-02-28T18:27:36.293

```
ps ax | grep processName 
```

如果你在 pycharm 中的调试脚本总是退出

```
pydevd.py --multiproc --client 127.0.0.1 --port 33882 --file processName 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-08-08T05:48:24.443

试试这个：

```
#/usr/bin/env python
import os, sys, atexit

try:
    # Set PID file
    def set_pid_file():
        pid = str(os.getpid())
        f = open('myCode.pid', 'w')
        f.write(pid)
        f.close()

    def goodby():
        pid = str('myCode.pid')
        os.remove(pid)

    atexit.register(goodby)
    set_pid_file()
    # Place your code here

except KeyboardInterrupt:
    sys.exit(0) 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-09-22T08:30:38.970

这是更有用的代码（检查是否正是 python 执行脚本）：

```
#! /usr/bin/env python

import os
from sys import exit

def checkPidRunning(pid):
    global script_name
    if pid<1:
        print "Incorrect pid number!"
        exit()
    try:
        os.kill(pid, 0)
    except OSError:
        print "Abnormal termination of previous process."
        return False
    else:
        ps_command = "ps -o command= %s | grep -Eq 'python .*/%s'" % (pid,script_name)
        process_exist = os.system(ps_command)
        if process_exist == 0:
            return True
        else:
            print "Process with pid %s is not a Python process. Continue..." % pid
            return False

if __name__ == '__main__':
    script_name = os.path.basename(__file__)
    pid = str(os.getpid())
    pidfile = os.path.join("/", "tmp/", script_name+".pid")
    if os.path.isfile(pidfile):
        print "Warning! Pid file %s existing. Checking for process..." % pidfile
        r_pid = int(file(pidfile,'r').readlines()[0])
        if checkPidRunning(r_pid):
            print "Python process with pid = %s is already running. Exit!" % r_pid
            exit()
        else:
            file(pidfile, 'w').write(pid)
    else:
        file(pidfile, 'w').write(pid)

# main programm
....
....

os.unlink(pidfile) 
```

这是字符串：

```
ps_command = "ps -o command= %s | grep -Eq 'python .*/%s'" % (pid,script_name) 
```

如果“grep”成功，则返回 0，并且进程“python”当前正在以脚本名称作为参数运行。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-04-27T08:09:49.883

**一个简单的例子，如果你只是在寻找一个进程名称是否存在：**

```
import os

def pname_exists(inp):
    os.system('ps -ef > /tmp/psef')
    lines=open('/tmp/psef', 'r').read().split('\n')
    res=[i for i in lines if inp in i]
    return True if res else False

Result:
In [21]: pname_exists('syslog')
Out[21]: True

In [22]: pname_exists('syslog_')
Out[22]: False 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-03-05T23:18:58.743

我一直在寻找这个问题的答案，就我而言，我认为这是一个非常简单且非常好的解决方案（因为不可能存在误报，我猜 - TXT 上的时间戳怎么能如果程序不这样做，则更新）：

--> 根据您的需要，在某个时间间隔内继续在 TXT 上写入当前时间戳（这里每半小时是完美的）。

如果您检查时 TXT 上的时间戳相对于当前时间戳已过时，则程序存在问题，应该重新启动它或您更喜欢做什么。

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2012-07-12T18:29:35.883

考虑以下示例来解决您的问题：

```
#!/usr/bin/python
# -*- coding: latin-1 -*-

import os, sys, time, signal

def termination_handler (signum,frame):
    global running
    global pidfile
    print 'You have requested to terminate the application...'
    sys.stdout.flush()
    running = 0
    os.unlink(pidfile)

running = 1
signal.signal(signal.SIGINT,termination_handler)

pid = str(os.getpid())
pidfile = '/tmp/'+os.path.basename(__file__).split('.')[0]+'.pid'

if os.path.isfile(pidfile):
    print "%s already exists, exiting" % pidfile
    sys.exit()
else:
    file(pidfile, 'w').write(pid)

# Do some actual work here

while running:
  time.sleep(10) 
```

我建议使用此脚本，因为它只能执行一次。

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2013-06-14T20:35:09.400

使用 bash 查找具有当前脚本名称的进程。没有额外的文件。

```
import commands
import os
import time
import sys

def stop_if_already_running():
    script_name = os.path.basename(__file__)
    l = commands.getstatusoutput("ps aux | grep -e '%s' | grep -v grep | awk '{print $2}'| awk '{print $2}'" % script_name)
    if l[1]:
        sys.exit(0); 
```

要测试，请添加

```
stop_if_already_running()
print "running normally"
while True:
    time.sleep(3) 
```

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2018-06-21T17:38:54.847

这是我在 Linux 中用来避免启动脚本（如果已经运行）的方法：

```
import os
import sys

script_name = os.path.basename(__file__)
pidfile = os.path.join("/tmp", os.path.splitext(script_name)[0]) + ".pid"

def create_pidfile():
    if os.path.exists(pidfile):
        with open(pidfile, "r") as _file:
            last_pid = int(_file.read())

        # Checking if process is still running
        last_process_cmdline = "/proc/%d/cmdline" % last_pid
        if os.path.exists(last_process_cmdline):
            with open(last_process_cmdline, "r") as _file:
                cmdline = _file.read()
            if script_name in cmdline:
                raise Exception("Script already running...")

    with open(pidfile, "w") as _file:
        pid = str(os.getpid())
        _file.write(pid)

def main():
    """Your application logic goes here"""

if __name__ == "__main__":
    create_pidfile()
    main() 
```

这种方法在不依赖外部模块的情况下效果很好。

# asp.net - 通过 ASP.NET 创建 PDF 文件

> ID：788412
> 
> 赞同：1
> 
> 时间：2009-04-25T07:00:03.757
> 
> 标签：asp.net, pdf

通过 Crystal Reports 以外的 ASP.NET 应用程序创建 PDF 文件需要什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T07:01:31.727

您可以使用 iText#，它基于类似的 Java 项目。

[http://itextsharp.sourceforge.net/](http://itextsharp.sourceforge.net/)

您不需要将 Crystal Reports 与此结合使用。如果您需要更强大（但价格昂贵）的东西，我已经使用它在复杂的 PDF 中取得了巨大成功：

[http://www.pdflib.com/](http://www.pdflib.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T07:02:34.140

一个可能的库是[iTextSharp](http://itextsharp.sourceforge.net/)。显然，iText 是一笔巨大的交易，但我在使用 iTextSharp 处理某个需求时并没有真正看到它，但那是几年前的事了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-25T07:05:34.727

最简单的方法是使用第三方库。我过去使用过 ASPOSE.PDF，效果很好。

[http://www.aspose.com/categories/file-format-components/aspose.pdf-for-.net-and-java/default.aspx](http://www.aspose.com/categories/file-format-components/aspose.pdf-for-.net-and-java/default.aspx)

我还尝试了 PDF Sharp，它是开源的，但没有那么灵活。

[http://pdfsharp.com/PDFsharp/](http://pdfsharp.com/PDFsharp/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-25T07:05:57.987

[这里](http://csharp-source.net/open-source/pdf-libraries)有几个开源选项。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-09-24T11:50:31.460

```
protected void btnReport_Click(object sender, EventArgs e)

{

    showReport();

}

private void showReport()

{

    DataTable dat = Reports.getPartyWiseJobStatusReport(Convert.ToInt16(ddlDivName.SelectedValue), Convert.ToInt16(ddlJobGroup.SelectedValue), Convert.ToInt16(ddlProjectStatus.SelectedValue));

    ReportDocument rptdoc = new ReportDocument();

    string path = Server.MapPath("~/Reports/rptPartyWiseJobStatus.rpt");

    rptdoc.Load(path);

    rptdoc.SetDataSource(dat);

    //rptdoc.SetParameterValue(0, ddlDivName.SelectedItem.Text);
    //ExportOptions exportOpts1 = rptdoc.ExportOptions;
    rptdoc.ExportOptions.ExportFormatType = ExportFormatType.PortableDocFormat;

    rptdoc.ExportOptions.ExportDestinationType = ExportDestinationType.DiskFile;

    rptdoc.ExportOptions.DestinationOptions = new DiskFileDestinationOptions();

    ((DiskFileDestinationOptions)rptdoc.ExportOptions.DestinationOptions).DiskFileName = Server.MapPath("~/Reports/rptPartyWiseJobStatus.pdf");

    rptdoc.Export();

    rptdoc.Close();

    rptdoc.Dispose();

    Response.ClearContent();

    Response.ClearHeaders();

    Response.ContentType = "application/pdf";

    Response.AppendHeader("Content-Disposition", "attachment; filename=rptPartyWiseJobStatus.pdf");

    Response.WriteFile("~/Reports/rptPartyWiseJobStatus.pdf");

    Response.Flush();

    Response.Close();

    File.Delete(Server.MapPath("~/Reports/rptPartyWiseJobStatus.pdf"));

} 
```

公共静态数据表 getPartyWiseJobStatusReport（Int16 DivisionID，Int16 JobGroup，Int16 ProjectStatus）

{ string _procName = "sp_T_Proposal_SelectPartyWiseJobStatus";

```
 DataTable dt1 = new DataTable();

    Database objDatabase = DatabaseFactory.CreateDatabase();

    DbCommand objDbCommand = objDatabase.GetStoredProcCommand(_procName);

    objDatabase.AddInParameter(objDbCommand, "@DivisionID", DbType.Int16, DivisionID);

    objDatabase.AddInParameter(objDbCommand, "@JobGroup", DbType.Int16, JobGroup);

    objDatabase.AddInParameter(objDbCommand, "@ProjectStatus", DbType.Int16, ProjectStatus);

    using (IDataReader dr = objDatabase.ExecuteReader(objDbCommand))

    {

        dt1.Load(dr);

    }

    return dt1;

} 
```

# java-me - 如何在 JavaME - CLDC 应用程序中实现通知服务？

> ID：788424
> 
> 赞同：0
> 
> 时间：2009-04-25T07:05:51.963
> 
> 标签：java-me, cldc

如何在 JavaME - CLDC 应用程序中实现通知服务，适用于 40 系列和 60 系列手机？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-25T08:37:30.793

你能对通知服务更清楚一点吗？如果您的意思是在收到短信等事件时做某事。您可以查看推送注册表。但是，某些手机可能希望构建已签名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T08:46:51.910

通知服务就像，如果发生任何消息/事件，通知图标将被更改，单击它将打开带有最近更新的应用程序。就像桌面上可用的通知服务一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-29T04:35:18.413

据我所知，CLDC 或 Java ME 并没有为您提供做您期望做的事情的工具。

# algorithm - 一种无拷贝的数组栈算法

> ID：788428
> 
> 赞同：1
> 
> 时间：2009-04-25T07:09:10.960
> 
> 标签：algorithm, optimization, actionscript, flashlite

我有一个 flashlite3 应用程序，其导航由用户可以向左或向右无限浏览的图标组成。

我现在使用的基本算法有效（并且对于这个项目来说已经足够了）但是，部分解决方案取决于图标数组的副本。根据数组中项目的数量和/或元素内容的大小，此解决方案可能会变得效率较低。我对可以在可扩展和高效的同时实现相同目标的解决方案或算法（使用任何语言）感兴趣。

下面是 setter 函数中用于改变“_selectedItem”属性的部分相关代码，其中：

1.  评估当前的“_selectedItem”和新的“_value”
2.  基于步骤 1 pop,unshifts right 或 shift,pops left
3.  重复步骤 2，直到与“_selectedItem”匹配的图标位于数组的中心

此代码使用 3 个数组运行：

1.  [静态] 位置数组。有 5 个图标，一次可见 3 个，所以位置 0 是舞台外，位置 1 是 1/3，位置 2 是 1/2 ..
2.  实例化图标时会创建 2 个数组：_viewArray 和 _icons。_viewArray 的顺序模仿了要显示的顺序，_icons 被单独保留并用于循环条件检查

///动作脚本2///

```
 public function set selectedItem(value:Number)
    {
        var w=Stage.width;

        if(value > _icons.length-1)
        {
            value=0;
        }else if(value < 0)
        {
            value=_icons.length-1;
        }

        if(value > _selectedIndex)
        {
            while(_viewArray[Math.floor(_icons.length*.5)] != _icons[value])
            {
                var element;
                element=_viewArray.pop();
                _viewArray.unshift(element);
            }
        }else if(value < _selectedIndex)
        {
            while(_viewArray[Math.floor(_icons.length*.5)]!=_icons[value])
            {
                var element;
                element=_viewArray.shift();
                _viewArray.push(element);
            }           
        }

        for(var i:Number=0;i<_viewArray.length;i++)
        {
            if(i>=1 && i<= _icons.length-2)
            {
                _viewArray[i]._visible=true;
            }else
            {
                _viewArray[i]._visible=false;
            }
            Tweener.addTween(_viewArray[i],{_x:positions[i],_alpha:80,time:.5,transition:'elasticIn'})
        }

        Tweener.addTween(_icons[(_viewArray.length*.5)-1],{_alpha:100,time:.0,transition:'elasticIn'});
        Tweener.addTween(_selectedServiceIndicator,{_alpha:0,time:.3,transition:'elasticIn',onComplete:function() {Tweener.addTween(this,{_alpha:100,time:.2,transition:'elasticIn'});}});

        var eventObject:Object = {target:this, type:'SelectedItemChange'};
        eventObject.value=value;

        for(var key in _serviceData[value])
        eventObject[key]=_serviceData[value][key];

        dispatchEvent(eventObject);
        _selectedIndex=value;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T16:39:03.990

为什么 _viewArray 的每个元素都必须实际存储图标，而不仅仅是 _icons 数组的索引？这样，您只需存储一次图标，而 _viewArray 仅存储它们的呈现顺序。

# c# - IntPtr 到 Uint32？C＃

> ID：788431
> 
> 赞同：0
> 
> 时间：2009-04-25T07:10:47.443
> 
> 标签：c#, intptr

我需要调用[VirtualAllocEx](http://www.pinvoke.net/default.aspx/kernel32/VirtualAllocEx.html)并返回 IntPtr。我调用该函数来获取一个空地址，这样我就可以在那里编写我的代码库（这是在另一个进程中）。

如何将结果转换为 UInt32，以便最近可以使用该地址调用 WriteProcessMemory()？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T07:15:06.687

当您调用 WriteProcessMemory 时，您应该为地址传递一个 IntPtr 而不是 UInt32（因为 WriteProcessMemory 需要一个指针，而不是整数）。因此，您应该能够直接使用 VirtualAllocEx 返回的 IntPtr，而无需将其转换为 UInt32。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T07:34:19.197

我相信你可以用 (uint)ptr 投射它（如果它不能很好地投射，请先尝试 ptr.ToInt32() 或 ToInt64() 。至少我不知道这种方法有任何问题，没有使用它 - 太多了。鉴于 UInt32 的范围比 Int32 更大，并且在非负方面与 Int64 相同，它应该足够好。

虽然不确定 Int32 在 64 位架构上的行为方式。糟糕的是，我认为 IntPtr 的原因是提供独立于平台的方式来存储指针。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-25T07:43:00.847

您的 WriteProcessMemory 的 DLlImport 不正确，基地址是一个指针，因此应将其定义为 IntPtr。

[MSDN](http://msdn.microsoft.com/en-us/library/ms681674(VS.85).aspx)

您需要修复您的 DllImport 语句。

# java - 您可以将 int 数组传递给 java 中的泛型方法吗？

> ID：788433
> 
> 赞同：6
> 
> 时间：2009-04-25T07:13:38.593
> 
> 标签：java, generics

我正在玩一些代码 katas 并试图同时更好地理解 java 泛型。我有这个小方法，可以打印我喜欢看到的数组，我有几个辅助方法，它们接受一个“事物”数组和一个索引，并返回索引上方或下方的“事物”数组（它是一种二分搜索算法）。

两个问题，

#1 我可以避免在 splitBottom 和 splitTop 中转换为 T 吗？感觉不对，或者我想错了（不要告诉我使用 python 或其他东西.. ;)）

#2 我必须编写单独的方法来处理原始数组还是有更好的解决方案？

```
public class Util {

    public static <T> void print(T[] array) {
        System.out.print("{");
        for (int i = 0; i < array.length; i++) {
            System.out.print(array[i]);
            if (i < array.length - 1) {
                System.out.print(", ");
            }
        }
        System.out.println("}");
    }

    public static <T> T[] splitTop(T[] array, int index) {
        Object[] result = new Object[array.length - index - 1];
        System.arraycopy(array, index + 1, result, 0, result.length);
        return (T[]) result;
    }

    public static <T> T[] splitBottom(T[] array, int index) {
        Object[] result = new Object[index];
        System.arraycopy(array, 0, result, 0, index);
        return (T[]) result;
    }

    public static void main(String[] args) {

        Integer[] integerArray = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10};
        print(integerArray);
        print(splitBottom(integerArray, 3));
        print(splitTop(integerArray, 3));

        String[] stringArray = {"one", "two", "three", "four", "five", "six", "seven", "eight", "nine", "ten"};
        print(stringArray);
        print(splitBottom(stringArray, 3));
        print(splitTop(stringArray, 3));

        int[] intArray = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10};
        // ???
    }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-25T07:24:02.937

泛型不会以一致的方式处理基元。这是因为泛型不像 C++ 中的模板，它只是对单个类的编译时添加。

编译泛型时，您最终会使用上面示例中的 Object[] 作为实现类型。如 int[] 和 byte[] 等，不要扩展 Object[] 即使涉及的代码相同，也不能互换使用它们（再次泛型不是模板）

唯一的类 int[] 和 Object[] 共享是 Object。您可以将上述方法 Object 编写为类型（参见 System.arraycopy、Array.getLength、Array.get、Array.set）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-25T07:36:20.627

> 1 我可以避免在 splitBottom 和 splitTop 中转换为 T 吗？感觉不对，或者我想错了（不要告诉我使用 python 或其他东西.. ;)）

你不仅不能避免它，而且你不应该这样做。在 Java 中，不同类型的数组实际上是不同的运行时类型。作为 an 创建的数组`Object[]`不能分配给 AnythingElse[] 的变量。那里的转换不会立即失败，因为在泛型中类型 T 被擦除，但是稍后当代码尝试将它用作您承诺的Something []时，它会抛出 ClassCastException ，但事实并非如此。

解决方案是使用`Arrays.copyOf...`Java 6 及更高版本中的方法，或者如果您使用的是早期版本的 Java，则使用反射来创建正确类型的数组。例如，

T[] 结果 = (T[])Array.newInstance(array.getClass().getComponentType(), size);

> 2 我必须编写单独的方法来处理原始数组还是有更好的解决方案？

最好编写单独的方法。在 Java 中，原始类型数组与引用类型数组是完全分开的；并且没有很好的方式与他们一起工作。

可以使用反射同时处理两者。反射具有适用于原始数组`Array.get()`和`Array.set()`引用数组的方法。但是，这样做会失去类型安全性，因为原始数组和引用数组的唯一超类型是`Object`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-25T07:25:05.193

问题 1：强制转换数组不像您期望的那样工作。String 是 Object，但 String 数组不是 Object 数组。

尝试使用类似的东西：

```
public static <T> T[] splitTop(T[] array, int index) {
    T[] result = Arrays.copyOfRange(array, index + 1, array.length);
    return result;
} 
```

问题 2：对于基元数组，我的函数显然也不起作用。没有优雅的解决方案 - 例如查看 Arrays 库，它对于每个原始数组类型都有几个基本相同的方法的副本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-25T07:45:44.537

Java 不允许以类型安全的方式构造泛型数组。请改用通用序列类型（例如`java.util.List`，例如）。

这是我使用通用容器类编写测试程序的方法[`fj.data.Stream`](http://code.google.com/p/functionaljava/source/browse/trunk/src/main/fj/data/Stream.java)：

```
import fj.data.Stream;
import static fj.data.Stream.range;

// ...

public int[] intArray(Stream<Integer> s) {
  return s.toArray(Integer.class).array()
}

public static void main(String[] args) {
  Stream<Integer> integerStream = range(1, 10);
  print(intArray(integerStream));
  print(intArray(integerStream.take(3)));
  print(intArray(integerStream.drop(3)));

  // ...
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-25T08:54:00.177

您要完成的工作有两个问题。

首先，您正在尝试使用原始类型，它们实际上并不从 Object 继承。这会把事情搞砸。如果您确实需要这样做，请显式使用 Integer 而不是 int 等。

第二个也是更大的问题是 Java 泛型具有类型擦除。这意味着在运行时，您实际上无法引用泛型的类型。这样做是为了让您可以混合支持泛型和非泛型支持的代码，最终（恕我直言）成为 Java 开发人员头疼的主要来源，并证明泛型从一开始就应该在 Java 中使用。我建议您阅读[教程](http://java.sun.com/docs/books/tutorial/java/generics/erasure.html)中关于它的部分，它将使这个问题更清楚。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-02-04T12:47:21.780

您可能必须将原语包装到相应的集合中。

I also suggest to take a look to Trove primitive collections ([http://trove.starlight-systems.com](http://trove.starlight-systems.com)). This is unrelated to your generics question, but may be quite interesting.

# blackberry - 应用程序未部署在黑莓模拟器上

> ID：788442
> 
> 赞同：5
> 
> 时间：2009-04-25T07:18:49.110
> 
> 标签：blackberry, simulator, blackberry-os-v4.5

我尝试在黑莓模拟器 8100 上部署 .cod、.alx.jar 文件；该应用程序没有部署在手机上。我正在为 Eclipse 使用 Blackberry 插件。我该如何解决这个问题？

请帮忙

* * *

**更新**

你好，谢谢你的回复。我正在尝试按照您建议的方式运行应用程序。

每次运行任何项目时都需要设置新的运行配置吗？

构建配置的默认值应该是什么？[调试、私有或发布]

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-27T01:26:56.990

将 .cod 文件复制到模拟器的目录（所有其他 .cod 文件所在的目录）并重新启动模拟器即可。

可能虽然您想从 Eclipse 自动部署。如果这对您不起作用，有几件事需要检查：

检查项目是否已为 BlackBerry 激活 - 从项目的右键单击菜单中，确保选中为 BlackBerry 激活。

如果这已经被选中（当你创建一个新的 BB 项目时默认是这样），那么有时显式地构建项目就可以了：从 Project 菜单中，选择 Build Active BlackBerry Simulation

编辑：在回应下面的一些评论时，我想到了别的东西。您选择的配置可能与您的问题有关（BlackBerry -> Build Configurations）。JDE 插件中的配置不会影响生成的代码，但*会*影响为 BlackBerry 激活的项目。如果您切换配置，您的项目可能会变为未激活状态。
由于它不影响代码，我通常只选择一种配置并在整个调试和发布过程中坚持使用它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-08-18T23:14:58.500

您可能在 PATH 中缺少“jar”。如果是这样，eclipse BB 插件会静默失败，您的应用程序不会被推送到您的模拟器插件目录。要在 Eclipse 中查看此失败，请选择“Project > Build Active BlackBerry Simulation”。

如果您的路径中没有 jar，那么您将看到：

```
I/O Error: Cannot run program "jar": CreateProcess error=2, The system cannot find the file specified rapc executed for the project 
```

因此，如果您的 JDK 在这里：

```
C:\Sun\SDK\jdk\bin 
```

然后将其附加到系统环境的 PATH 变量中，然后重新运行“Build Active BlackBerry Simulation”，您应该会看到：

```
rapc executed for the project [YOUR PROJECT] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-12-02T00:30:48.400

这里有几个想法：

1）如果您有任何构建错误，那么应用程序将不会部署到模拟器。Eclipse 编译器（红色下划线的编译错误）不同于为模拟器创建二进制文件的“rapc”编译器。我听说过 Eclipse 构建似乎可以工作，但 rapc 编译失败的情况 - 检查控制台以获取详细的 rapc 输出（这可能不像正常的 Eclipse 构建错误）。

2) 在 Eclipse 菜单中，打开 BlackBerry -> Configure BlackBerry Workspace。

在 BlackBerry JDE 下选择 Code Signing 并确保选中三个 RIM 复选框。未选择这些时，我遇到了编译错误。

在 BlackBerry JDE 下选择已安装的组件。选择使用组件包 4.7.0，因为我听说 4.5.0 模拟器有问题。

您应该删除您发布的所有这些额外答案，否则您可能会被否决 - 它们应该是评论而不是答案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-30T15:38:09.383

检查您的模拟器是否设置为在启动模拟器之前清理文件系统/配置。模拟器可以这样设置。如果您停用它，该应用程序不应消失。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-08-31T05:09:21.983

对于未来的读者，这个问题还有另一种可能性。检查您的工作台项目目录（文件夹）中的 ProjectName.err 文件。这可能会提供一个线索，说明为什么您的构建会静默失败并因此无法部署。就我而言，这是一个“错误！907”，我添加到项目中的新图标太大了。在 Eclipse 3.4.1 中绝对没有其他迹象表明我的构建存在问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-05-23T06:50:07.370

刚刚遇到了同样的问题：项目编译得很好，但没有部署在任何设备或任何模拟器上，即使调试器说它是附加的！问题来自位于项目的 ./src 目录中的 .zip 文件，将其删除或移动到其他地方解决了这种情况。我希望我没有在这样一个愚蠢的问题上花费 2 多个小时：/

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-01-08T20:27:34.927

我知道这很旧，但是您也必须通过右键单击项目菜单来执行“生成 ALX”选项，否则它不会部署，至少它不适合我。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-06-14T21:28:13.997

我又遇到了同样的问题，这里发布的答案都没有对我有用。

我到处玩，终于让它工作了。问题是输出文件名**包含连字符 ('-')**。在 BlackBerry 应用程序描述符的 Build 部分更改此名称就可以了。

我的意思是，开发人员必须多么愚蠢才能漏掉这种错误。没有报告错误，为什么首先拒绝带有连字符的名称？把我两个小时的 RIM“开发者”还给我！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-07-14T13:42:33.373

我有同样的问题。原因是在标题中使用了“ **ü ”字符。**

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-08-03T11:25:52.533

我今天一直面临这个问题，但是有一个 MIDlet 项目。原来是我忘记在 BlackBerry Application Descriptor (BlackBerry_App_Descriptor.xml) 中指定“主 MIDlet 类的名称”。一旦我指定它，应用程序就会正确出现在模拟器上。

# xhtml - 为我的网站寻找一个简单、轻便的 xhtml 编辑器（例如 wmd 等）

> ID：788443
> 
> 赞同：1
> 
> 时间：2009-04-25T07:20:43.893
> 
> 标签：xhtml

现在，我在我的网站上使用 WMD，但最近我一直需要处理它的代码，并且由于代码晦涩难懂（没有选项卡、var 名称，例如 _1、_2），提供的代码几乎无法阅读ETC）。现在，我假设该代码具有非模糊版本，但无处可寻。（例如，我需要能够提供 RTL 支持，并修复一些错误）

我找到了 WYMeditor，但那是 JQ，我的网站与 Mootools 一起使用（我知道它们可以很好地一起玩，但那会失去亮点）

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T08:08:35.217

stack-overflow 团队将 WMD 代码反向工程为非混淆形式以进行更改；您应该直接向他们发送电子邮件并询问它 - 链接位于每个 SO 页面的底部。

# c# - 动态识别字段控制属性

> ID：788444
> 
> 赞同：1
> 
> 时间：2009-04-25T07:23:09.163
> 
> 标签：c#, .net, field

我有一个应用程序，其中必须捕获用户的操作，例如“最小化窗口”、“关闭窗口”、“单击按钮”……。而那些字段控件（如按钮、关闭图标、最小化图标...）可以在任何应用程序中，并且必须动态识别

有没有办法在 C# 中做到这一点？？？

非常感谢任何有用的指针。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-25T07:49:19.397

对于任意应用程序？嗯....棘手。我怀疑 Win32（而不是托管代码）将是做到这一点的方法——而且要正确地做很多工作。不过，有一些工具可以做到这一点——比如几年前像 Cyrano Robot 这样的脚本/测试工具（我不知道该产品是否仍然“活跃”）。

# actionscript - 可以在 actionscript 中使用“while 循环”来监视事件调度吗？

> ID：788447
> 
> 赞同：0
> 
> 时间：2009-04-25T07:25:57.267
> 
> 标签：actionscript

我正在创建一个动作脚本库。我正在调用一些 API 来解析一些 xml 并让我得到结果。解析完成后，它会分派一个 Event.COMPLETE。我想监视此事件是否在诸如“while（eventnotdispatched）”之类的某个while循环中分派，这可能吗？我知道另一种方法是添加事件监听器。但请让我知道其他事情是否可能。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-25T07:45:44.537

不，这是不可能的。Actionscript 是单线程的。因此，当您在 while 循环中等待时，这是唯一运行的线程，而您正在等待的进程永远无法完成。这就是为什么所有事情都是通过事件完成的，所以这就是你应该使用的。如果您在等待某事完成时需要定期更新您的显示...再次使用事件。创建一个 Timer 对象，该对象每隔一段时间生成一个 TIMER 事件，并使用它来进行更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T07:38:36.503

编辑： Davr 是对的，你不能像这样使用 while 循环。你需要一个计时器。

是的，可以进行轮询。但是您仍然需要创建一个事件侦听器。它会像这样工作：

```
private var loadCompleted = false;
private var timer:Timer= new Timer(1);

private function onInitCompleted(event:Event):void
{

    timer.addEventListener(TimerEvent.TIMER, timerHandler);
    timer.start();
}

private function loadCompleteEventHandler(event:Event):void
{
    loadCompleted = true;
    ...
}

private function timerHandler()
{
    if(!loadCompleted)
    {
        ... // stop the timer or something.
        timer.stop();
    }
} 
```

请注意，这是非常糟糕的代码。我永远不会在生产中使用它，因为 Actionscript 是一种事件驱动语言。您绝对没有理由需要这样做。无论您尝试做什么，都可以使用另一种更简单的方法来完成。告诉我你想用这个来完成什么，我会提出一个更好的解决方案。

抱歉大喊大叫，太晚了，我困了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-25T07:39:48.623

这样做意味着在底层异步模型（与回调一起使用）上强制执行同步模型。

你到底想达到什么目的，为什么不使用回调？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-28T20:32:46.803

我同意关于这可能是一个坏主意的说法，而 while 循环在 ActionScript 中肯定不会以这种方式工作。但是，您可能有正当理由去做您正在尝试做的事情。只有你可以防止坏代码。我不会评判，我只会回答你的问题。

首先，我要做一个假设，您真正想要做的是监视一个属性，并且由于某种原因，该对象的 API 在该属性更改时不会调度事件。我做出这个假设是因为如果您有可用的事件，我假设您只会使用该事件。

所以......你有一个对象奇怪的**XmlObj ，其****加载**的属性默认为**false** ，但在加载XML 时变为**true 。**

在这种情况下，稍微修改一下 CookieOfFortune 发布的代码实际上可以工作。您不需要**loadCompleteEventHandler**函数（无论如何都没有附加），并且在计时器处理程序中，您只需检查**if( WeirdXmlObj.loaded )**，然后根据需要进行分支。

啊，但可能有一个更简单的方法，这取决于你在做什么。如果你有一个方便的显示对象。（即有意义的东西，而不仅仅是一些随机对象。）您可以将代码附加到舞台的 EnterFrame 事件，而不是使用计时器。

**myDisplayObject.stage.addEventListner(Event.ENTER_FRAME,frameEnterHandler);**

有几点需要注意：

1.  您甚至不需要进入舞台级别，所有显示对象都支持 EnterFrame 事件，但它是附加事件侦听器的好地方。

2.  您确实应该将函数调用的内容保持在最低限度。特别是，实际的**frameEnterHandler**函数应该只做**if(weatherXmlObj.loaded)**检查。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-27T15:28:51.973

您正试图规避事件驱动编程，这不是一个好主意。当有人从较旧的模型接近并且还没有一个好的参考框架来欣赏事件驱动编程的优雅时，通常会出现这种情况。

事件是你的朋友。他们工作得很好。您的 loadCompleteHandler 就是所需要的。想要做点别的回应吗？在该处理程序中添加调用：

```
private function loadCompletedHandler(event:Event):void
{
    waitingObject.fileWasLoadedSoGoDoThatThing();
} 
```

没有必要让它比这更复杂。不需要信号量或循环来检查信号量。不必要的环境信号量可能会破坏可以保护您免受不必要的副作用的封装。

# c# - C#：查找当前进程

> ID：788450
> 
> 赞同：0
> 
> 时间：2009-04-25T07:28:40.943
> 
> 标签：c#

如何在不使用系统进程的情况下获取当前正在运行的应用程序？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-25T07:35:56.573

这取决于你在寻找什么。如果您对调用您的程序集感兴趣，那么您可以使用[GetCallingAssembly](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.getcallingassembly.aspx)。您也可以使用[GetExecutingAssembly](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.getexecutingassembly.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T08:54:45.447

```
System.Diagnostics.Process.GetProcesses("MACHINEHAME") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-25T15:36:23.127

这里有点误解。在任何给定的机器上都可以有多个当前正在运行的进程。考虑机器有多个 CPU 的情况。有可能，而且事实上很可能，每个 CPU 都至少有一个单独的线程在其上运行。很有可能在任何给定时间机器上当前运行的进程数将接近系统上的处理器数。

在单个处理器的情况下，获取当前正在运行的进程的行为是多余的。它只是您的应用程序。

如果您想在不使用 Process 类的情况下调查当前机器上运行的进程，您可以 PInvoke 进入 Process32First 和 Process32Next 系统调用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-25T16:10:13.123

如果您使用的是 .NET，无论您最终使用何种机制，请务必注意 .NET 代码访问安全性。阅读 MSDN 文档以查看您正在使用的类、方法是否需要完全信任。如果您的应用程序应该在部分信任或特权较低的信任环境中运行，这可能是一个问题。

# java - Eclipse Web 工具平台 (WTP) 与 NetBeans - 用于 Java Web 开发的 IDE

> ID：788453
> 
> 赞同：4
> 
> 时间：2009-04-25T07:32:27.987
> 
> 标签：java, eclipse, netbeans

在进行 JSP、JSPX 等 Java Web 开发时。

1.  您认为 Eclipse 或 NetBeans 是什么 IDE？
2.  它的优点和缺点是什么？

就开发 Web 应用程序（例如网站、Web 服务等）而言，哪个更好。我正在考虑使用 NetBeans，因为它已经捆绑了一些允许您创建和测试 Web 应用程序的功能。但是选择 Eclipse WTP 有充分的理由吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-25T08:16:59.673

从微观角度看，Netbeans 是一个更加一致的产品，某些部分更加完善，例如更新管理器。我相信你会在那里找到你需要的一切。

Eclipse 有时不太稳定，因为仍然有很多工作要做，而且插件系统充其量是可用的。Eclipse 会更快，因为它使用 SWT，它使用本地代码创建 UI（因此，它看起来也更漂亮）。

从宏观的角度来看，我相信你已经听说了最近甲骨文收购 Sun 的消息。好吧，我只是说我很确定 Netbeans 对 Oracle 的优先级很低。另一方面，Eclipse 有 big blue (IBM) 支持它。因此，从长远来看，如果您不想陷入死胡同，请选择 Eclipse。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-07-16T16:22:55.793

我同时使用了 Eclipse 和 NetBeans。比起 Eclipse，我更喜欢 NetBeans。从 Java 编辑器的角度来看，两者都具有出色的上下文相关帮助和通常的好处。

在设置其他团队成员可以打开和使用的项目时，Eclipse 很糟糕。我们有一个大项目（大约 60 万行代码），组织在许多文件夹中。Eclipse 不允许您包含项目根文件夹之外的源代码。一切都必须在项目根文件夹下。通常您希望拥有单独的项目并能够在它们之间建立依赖关系。构建完成后，您会将它们签入源代码管理。Eclipse 的问题是项目（即.classpath 文件）依赖项保存在用户的工作区文件夹中。如果你想看看这个文件夹，你会发现很多文件读起来像*org.eclipse.**等等。这意味着您不能将这些文件放在源代码管理中。我们有 20 个步骤的说明表供某人在每次从源代码管理开始新结帐时阅读。我们最终没有使用它的默认项目管理东西（即类路径文件等）。相反，我们提出了一个 Ant 构建文件并从 Eclipse 内部启动它。那是笨拙的方式。如果你必须跳过这么多圈，IDE 基本上就失败了。

我敢打赌 Eclipse 项目管理是由从未使用过 IDE 的人设计的。许多 IDES 允许您使用不同的配置来运行代码（发布、调试、使用 JDK 1.5 发布等）。他们让您将这些内容保存为项目文件的一部分。团队中的每个人都可以使用它们而无需大的学习曲线。您可以在 Eclipse 中创建配置，但不能将它们保存为项目文件的一部分（即它不会进入您的源代码控制）。我在 6 个月的时间里完成了六次新的结账工作。我厌倦了在每次新结账时重新创建它们。

另一方面，NetBeans 按预期工作。它没有这个项目管理的噩梦。

我听说过有关 IntelliJ 的好消息。如果您刚开始，请使用 NetBeans。

我的 2 美分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-25T07:53:20.713

我主要使用 Netbeans 进行开发，可以说它在提供我需要的大部分功能方面非常出色。代码补全，一键编译部署，甚至版本控制。如果您需要核心中没有的功能，您还可以从各种插件中进行选择。就我而言，Eclipse 有一个非常相似的功能集，尽管我没有详细使用它。

但是，netbeans 存在严重的内存问题，并且对可用内存要求很高，我看到它在重复部署我的应用程序进行调试后消耗了 400-500MB 的内存。除此之外，我说 Netbeans 相当快（如果内存足够的话）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-28T12:18:15.980

Eclipse 的 Aptana 是我几个月前使用的，但后来改为 NetBeans。它的功能较少，但经过 2 小时的定制，开箱即用的东西几乎与 Aptana 相同。每个软件都有一些减速和内存泄漏，一些烦人的代码验证错误。

但是 NetBeans 在代码完成方面更好，很少变慢，可以管理 1 mb 的 javascript 文件。这就是我从 Aptana for Eclipse 更改为 NetBeans 的原因。

我以前使用的其他 Eclipse 工具缺少默认情况下在 Aptana 和 NetBeans 中的东西。尽管我使用了一些插件，但我不喜欢为了获得可用程序而在 IDE 上进行数天的黑客攻击。

为了我：

NetBeans +

日食 -

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-04-05T00:39:12.817

根据我自己的经验，虽然 Eclipse 为您提供了大量的插件，但并不总能保证满足您的期望。我对 Eclipse 插件有很多问题，从 Eclipse 本身的不同版本到插件的多个插件先决条件。

NetBeans 中的插件很容易安装，但是是的，它没有 Eclipse 的那么多。

在使用 Eclipse 时感觉笨拙也促使我转向 NetBeans。虽然 SWT 是一个不错的 GUI，但与 NetBeans Swing 相比，它的加载时间需要相当长的一段时间。但是，请注意，当且仅当您使用 Windows 平台时，NetBeans 才会感觉良好。显然，Linux 中的 Swing（至少在 Ubuntu 10.10 上）会受到打击。每次我在项目管理器中单击一个文件时，它都会尝试重命名它。但只有在 Linux 中使用 NetBeans 时才会发生这种情况。

我转向 NetBeans 的另一点是项目管理窗口。在 Eclipse 中，它很糟糕，不能按我的预期工作。如果您曾经使用过 Visual Studios IDE 项目/解决方案视图，NetBeans 是最接近它的一种。

两者都消耗大量内存。更糟糕的是，从休眠/睡眠模式唤醒机器后，Swing GUI 需要很长时间才能加载。不是开玩笑。一直发生在我身上。

无论如何，这纯粹是我的意见。希望这可以帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-25T08:10:37.097

去 Eclipse 无限插件（免费）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-08-28T14:11:48.123

长期以来，我一直是 Eclipse 的粉丝。特别是当我开发插件和Android程序时。现在我必须使用 maven 构建系统和 tomcat（Web 应用程序）来处理一些项目，并且发现 Eclipse 太复杂而无法加载和调试，并且更改无法从任何 jsp 文件中获取效果。Netbeans 在这方面非常聪明。使用 Netbeans 甚至使用 Tomcat webapp 进行调试也很容易。所以我搬到了Netbeans。

至少就目前而言，对于 Web 应用程序开发，我猜 Netbeans 是最好的。

Eclipse for Mac 中的自动完成对我来说也是一场噩梦。我无法让它与 Ctrl+Space 一起使用，因为默认情况下它是 Sptolight/Keyboard 更改的快捷方式。我还没有在 mac 上使用 netbeans，但我会尝试。

对于 GUI，WindowBuilder 或 Jigloo，总是在 Mac 中迷恋。从这个意义上说，Netbeans GUI 设计器更好。

# java - 在客户端监听套接字（Android）

> ID：788455
> 
> 赞同：1
> 
> 时间：2009-04-25T07:33:40.587
> 
> 标签：java, android, networking, sockets

我想在客户端有一个套接字的侦听器。我使用的是 Java 的 Android。我正在使用 TCP/IP，但我不想在客户端循环。

有什么方法可以做到这一点，还是我必须有自己的聆听机制？

任何帮助，将不胜感激。谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-25T08:21:15.887

`Thread`Android 是 Java，如果要对传入数据进行异步处理，则必须打开一个新的。请注意正确同步线程之间的所有通信。

# asp.net - 加密 web.config 后出错

> ID：788459
> 
> 赞同：4
> 
> 时间：2009-04-25T07:36:19.410
> 
> 标签：asp.net, vb.net, encryption, web-config

我加密了我的 web.config 的 AppSettings 部分，在我的机器上对其进行了测试并且它工作，但是当我上传到在线使用它时它给了我一个错误：

> 配置错误描述：处理服务此请求所需的配置文件期间发生错误。请查看下面的具体错误详细信息并适当地修改您的配置文件。
> 
> 解析器错误消息：无法使用提供程序“DataProtectionConfigurationProvider”解密。来自提供者的错误消息：密钥在指定状态下无效。（来自 HRESULT 的异常：0x8009000B）

```
Line 24: <appSettings configProtectionProvider="DataProtectionConfigurationProvider">
Line 25:  <EncryptedData> 
```

我使用以下子加密：

```
Private Sub ProtectSection(ByVal sectionName As String, ByVal provider As String)
        Dim config As Configuration = WebConfigurationManager.OpenWebConfiguration(Request.ApplicationPath)

        Dim section As ConfigurationSection = config.GetSection(sectionName)

        If section IsNot Nothing AndAlso Not section.SectionInformation.IsProtected Then
            section.SectionInformation.ProtectSection(provider)
            config.Save()
        End If
    End Sub 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-25T08:06:01.260

您需要发布已解密的部分。用于加密/解密的密钥是特定于机器的。

要在线加密配置部分，请调用 global.asax 的 Application_Start() 中的 ProtectSection() 方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T08:10:56.630

您需要设置 MachineKey

.net 加密使用 MachineKey 作为加密/解密的种子

[http://msdn.microsoft.com/en-us/library/w8h3skw9.aspx](http://msdn.microsoft.com/en-us/library/w8h3skw9.aspx)

您需要生成一个密钥并在两台机器上使用它。您也不能只使用自动生成它。

如果可以的话，更容易在服务器上上传未加密和手动加密，否则你需要完全相同的 MachineKey

# jquery - 使用 ajax 调用时如何拦截与 jQuery 的链接？

> ID：788463
> 
> 赞同：11
> 
> 时间：2009-04-25T07:38:31.963
> 
> 标签：jquery, ajax

我可能正在做一些愚蠢的事情。但是，如果我有一个正常的链接，例如：

```
<div id="changeMe"></div>
<a href="/Not/Intercepted" id="interceptMe">A link</a> 
```

我将一个 jQuery click 事件附加到链接中，如下所示：

```
$('#interceptMe').click(function() {
  $('#changeMe').text('Changed');
  return false;
}); 
```

一切都很顺利。该页面不会**被**重定向到 /Not/Intercepted，我认为这是正确的。

现在...

我在点击事件中引入了一个像 $.get 这样的 ajax 调用，现在我的页面将被错误地重定向到该页面，这实际上覆盖了 ajax 调用。

```
$('#interceptMe').click(function() {
  $.get('/Ajax/Call', goesIn, function(comesOut) {
  $('#changeMe').html(comesOut);
    }, "html");
  return false;
}); 
```

有没有办法让 jQuery 或 javascript 仍然拦截链接点击，所以它不会转到 href 页面？我想为那些没有启用 javascript 的用户保留 href。蒂亚！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-25T08:03:33.793

而不是返回 false，使用 ....

```
$("#interceptMe").click(function(event){

    event.preventDefault();

    // Ajax here

    return false; //for good measure
}); 
```

[http://docs.jquery.com/Events/jQuery.Event#event.preventDefault.28.29](http://docs.jquery.com/Events/jQuery.Event#event.preventDefault.28.29)

我在 IE 上遇到了很多问题，尤其是不听返回 false。显然其他人也是如此[http://coffeeandpaste.blogspot.com/2009/02/javascript-onclick-return-false-does.html](http://coffeeandpaste.blogspot.com/2009/02/javascript-onclick-return-false-does.html)

# c# - GIS 查找由表示为长纬度集合的多边形所包含的点（长纬度）

> ID：788469
> 
> 赞同：2
> 
> 时间：2009-04-25T07:40:16.640
> 
> 标签：c#, sql-server-2005, gis

我正在尝试查找所有具有 long/lats 的数据项，这些数据项包含在由 long lats 数组组成的多边形中，这些数据项可能是很多点。我知道您可以使用 SQL 2008 中的新地理空间数据类型来执行此类操作，但我使用的是 SQL 2005 和 C#。这最好在数据库端还是在 C# 中完成。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T07:48:23.360

如果在 T-SQL 中完成，这听起来会让人头疼（尽管这或多或少是什么？）。当然，这取决于多边形的复杂性和数据项的定位方式，但通常最简单且效率适中的方法可能是在 C# 中进行一些初始计算，从而以非常粗略的方式限制数据项。所以像下面这样。

1.  在 C# 中计算多边形的粗略边界。
2.  从 SQL 服务器获取这些边界内的所有内容。
3.  在 C# 中进行最终的准确过滤。

当然，性能取决于您计算初始边界的能力。我会先从一个简单的边界矩形开始，看看性能是否足够。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T13:55:10.170

我为 SQL2000 编写了一些代码来执行此操作。它使用“角度”方法来确定一个点是否位于多边形内。

一、GetAngle用户定义函数：

```
ALTER Function [dbo].[GetAngle](
@Ax Decimal(8,5), 
@Ay Decimal(8,5), 
@Bx Decimal(8,5), 
@By Decimal(8,5), 
@Cx Decimal(8,5), 
@Cy Decimal(8,5)) 
```

开始时返回浮点数

```
Declare @dot_product Float
Declare @cross_product Float

Declare @BAx Decimal(8,5)
Declare @BAy Decimal(8,5)
Declare @BCx Decimal(8,5)
Declare @BCy Decimal(8,5)

--' Get the vectors' coordinates.
Set @BAx = Sign(@Ax - @Bx) * dbo.CalculateDistance(@Ax, @Ay, @Bx, @Ay)
Set @BAy = Sign(@Ay - @By) * dbo.CalculateDistance(@Ax, @Ay, @Ax, @By)
Set @BCx = Sign(@Cx - @Bx) * dbo.CalculateDistance(@Cx, @Cy, @Bx, @Cy)
Set @BCy = Sign(@Cy - @By) * dbo.CalculateDistance(@Cx, @Cy, @Cx, @By)

--' Calculate the dot product.
Set @dot_product = @BAx * @BCx + @BAy * @BCy

--' Calculate the Z coordinate of the cross product.
Set @cross_product = @BAx * @BCy - @BAy * @BCx

--' Calculate the angle.
return ATn2(@cross_product, @dot_product) 
```

结尾

* * *

接下来我假设有一个纬度/经度对的表变量和一个序列号（指示 LAT/LONG 对定义多边形的顺序）。重要的是，此表中的第一个点与表中的最后一个点相同。

另外，我有几个最小和最大纬度和经度的变量。这有效地创建了一个边界框，以便我可以快速消除不在多边形边界的矩形区域内的点。

```
Select  Address.AddressId
From    @Temp As A
        Inner Join @Temp As B
            On A.SequenceNumber = B.SequenceNumber - 1
        Inner Join Address
            On Address.XCoord Between @MinLongitude And @MaxLongitude
            And Address.YCoord Between @MinLatitude And @MaxLatitude
Group By Address.AddressId
Having Abs(Sum(dbo.GetAngle(A.Longitude, A.Latitude, Address.XCoord, Address.YCoord, B.Longitude, B.Latitude))) > 3.14 
```

# c - 附加到一个进程是否会使其行为不同？

> ID：788478
> 
> 赞同：2
> 
> 时间：2009-04-25T07:47:53.610
> 
> 标签：c, debugging

虽然我知道调试版本和发布版本之间的区别，但我很好奇将调试器附加到进程（构建版本或调试）是否会更改处理行为？

作为参考，我正在 HP 11.31 Itanium 上进行开发，但仍然对一般情况感到好奇。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-25T08:22:29.613

[http://en.wikipedia.org/wiki/Heisenbug#Heisenbug](http://en.wikipedia.org/wiki/Heisenbug#Heisenbug)

当然，附加调试器会改变时间（这可能会改变例如线程竞争条件），而且一些系统调用可以检测是否附加了调试器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T07:53:52.333

当然可以，具体取决于平台和调试方法。例如，[在 Windows 上调试时](http://www.securityfocus.com/infocus/1893)，实际上有[IsDebuggerPresent](http://msdn.microsoft.com/en-us/library/ms680345(VS.85).aspx)函数。如前所述，可以绕过功能，但还有其他方法。所以基本上，这很复杂。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-25T08:40:18.587

是的，当附加调试器时，Windows 数据结构中的很多东西都会发生变化。它改变了内存的分配/释放方式，它在堆栈上添加了额外的管家代码和“标记”（曾经注意到新分配的内存中的 F00D 值）事实上，反调试器使用许多更改来检测应用程序是否正在调试。

在解释性语言（Java、.NET）中，运行时在调试器下运行时通常会生成不同的机器指令，以帮助它捕获和显示异常、显示原始代码等。它通常也会在附加调试器时生成未优化的代码.

其中一些更改会影响软件的行为方式，并可能导致由优化或极其精细的时序依赖性引起的复杂瞬态错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-25T07:55:24.437

是的，我经常发现将调试器附加到进程会立即使错误消失，只是当我在发布模式下编译我的应用程序时它们才会重新出现。不幸的是，我通常不能真正要求我的所有用户打开调试器来运行我的应用程序，所以这可能会非常令人沮丧。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-25T10:07:09.860

要记住的另一件事是，对于多线程应用程序，附加调试器肯定会产生非常不同的结果。这些是被称为“Heisenbugs”的东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-09T23:31:58.593

当然，在多线程应用程序中，附加调试器会产生不同的结果。但是，与线程无关的代码呢？

我已经看到附加了调试器的发布版本没有问题。但是，当没有附加调试器时，它就会出现问题。
如果它首先启动并附加了调试器，它也会显示相同的问题。

# c++ - delete[] 提供了一个修改后的新指针。未定义的行为？

> ID：788482
> 
> 赞同：5
> 
> 时间：2009-04-25T07:50:57.880
> 
> 标签：c++, memory-management, new-operator, standards-compliance

在同行代码审查会议期间，我看到了如下一些代码：

```
char *s = new char[3];
*s++ = 'a';
*s++ = 'b';
*s++='\0';
delete []s; // this may or may not crash on some or any day !! 
```

首先，我知道在标准 C++ 中，指向过去的数组大小是可以的，尽管访问它会导致未定义的行为。所以我相信最后一行`*s++='\0'`很好。但如果我没记错的话，C++ 标准要求`delete`应该提供与`new`返回相同的指针。

我相信这意味着返回的指针不能被篡改。我想这是因为可能会在可能使用`new`的返回地址之前保留一些家政信息。`delete`移动`new`'d 指针可能会使其无法访问。

它是未定义的行为还是实现定义的或未指定的？任何人都可以确认这一点吗？最好通过指向 C++ 标准中的正确位置。

[在免费提供的 C++ 标准草案 (Draft_SC22-N-4411.pdf) 的草案版本中，详细信息在第 5.3.5 节中。我是从 Bjarne 的主页上得到的。]

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-25T07:59:03.787

来自 C++ 标准，第 5.3.5/2 节：

> delete 的操作数的值应该是从前一个数组 new 表达式产生的指针值。如果不是，则行为未定义

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-25T07:54:12.940

是的，你必须 delete[] new 给你的原始指针；在这种情况下，这将是指向数组头部的指针，而不是尾部。这里的代码正在删除一些其他未指定的随机对象。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-01T03:21:08.430

是的，回想一下这通常是如何实现的：new 真正调用 malloc，它返回一个指向 的指针`(void*)(&(((int*)p)[1]))`，其中 p 是分配的内存的实际开始，第一个 int 是我们返回的实际内存的大小。

我们返回的指针是实际分配的内存中的一个 sizeof(int) （或任何对齐要求）。我们把我们的物体放在那里，让实际尺寸不受干扰。

然后，当该指针传递给 delete 时，delete 将它传递给 free，free 会在传递的指针*之前*查找一个 int ，以找到返回的大小。

传回我们得到的东西之外的东西意味着 free 认为正在传回任意数量的实际内存，它会相应地搞砸空闲列表。

同样，这是它*通常*的实现方式，而不是需要如何实现 new、delete、malloc 或 free。

# c# - LINQ 加入以查找不在列表中的项目

> ID：788485
> 
> 赞同：5
> 
> 时间：2009-04-25T07:53:32.397
> 
> 标签：c#, linq

如何跨可查询和不可查询数据使用 LINQ？

使用下面的代码，我想得到一个未选中用户的列表，即 allUsers 中未选中的每个人。

```
public IQueryable<CompanyUser> FindAllUsersNotAssignedTothisCompany(int companyID)
{
    var allUsers = Membership.GetAllUsers();
    var selected = db.CompanyUsers.Where(c => c.CompanyID == companyID);
    ...?
} 
```

我实际上想要一个适合在 DropDownList (ASP.NET MVC) 中使用的用户 ID 和名称列表

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-25T07:58:33.803

假设两者`allUsers`和`selected`属于同一类型，您可以使用**[except](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.except.aspx)**

```
public IQueryable<CompanyUser> FindAllUsersNotAssignedTothisCompany(int companyID)
{
    var allUsers = Membership.GetAllUsers();
    var selected = db.CompanyUsers.Where(c => c.CompanyID == companyID);
    return allUsers.Except(selected);
} 
```

但是，如果 db.CompanyUsers 已经拥有所有用户，那么您只需要检索没有相关 companyID 的用户：

```
return db.CompanyUsers.Where(c => c.CompanyID != companyID); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-07T11:36:54.537

在一行中尝试：

```
db.CompanyUsers.Where(c => !allUsers.Any(d=> d.CompanyID == a.companyID))).ToList(); 
```

# visual-c++ - 在 VC++ 中读取 RichTextBox

> ID：788494
> 
> 赞同：0
> 
> 时间：2009-04-25T07:58:42.320
> 
> 标签：visual-c++, richtextbox, user-input

`RichTextBox`我必须从VC++ 中逐个字符地读取文本。我需要一个类似`getch`or的函数`getche`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-25T08:06:57.340

如果您想在用户**输入文本时阅读文本，则**必须附加到“按键向上/向下”或“文本更改”事件（取决于您别有用心）。

# sqlite - 通过网络共享的 Sqlite

> ID：788517
> 
> 赞同：46
> 
> 时间：2009-04-25T08:17:46.037
> 
> 标签：sqlite

有没有人有在局域网（Windows 或 Linux）上的 SMB 共享上运行 Sqlite 数据库的实际经验？

从[文档](http://www2.sqlite.org/cvstrac/wiki?p=SqliteNetwork)中可以清楚地看出，这并不是共享 Sqlite 数据库的最快方式。

明显的警告是它可能很慢，而且 Sqlite 一次只支持单个线程写入数据库。因此，您的并发性会降低很多，因为您的数据库更新现在将阻塞数据库更长时间（当数据通过网络传输时，数据库将被锁定）。

对于我的应用程序，我想共享的数据量相当小，并且写入不是太频繁（最多每隔几秒写入几次）。

我应该注意什么？这能行吗？

我知道这不是 Sqlite 的设计目的，我对基于 Postgres/MySql/Sql Server 的解决方案不太感兴趣，因为我试图以最少的依赖项使我的应用程序尽可能轻巧。

相关链接：

从[sqlite 邮件列表中](http://www.mail-archive.com/sqlite-users@sqlite.org/msg37281.html)，我想一个大问题是 SMB（Windows 或 linux）上的文件锁 API 有多不可靠

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-04-25T09:11:20.713

我对基于文件的数据库（即那些没有数据库服务器进程的数据库）的经验可以追溯到 20 多年前，如果您尝试共享它们，它们最终将*不可避免地*遭到破坏。我强烈建议您再次查看 MySQL。

请注意，我没有选择 SQLite - 我自己使用它，而不是作为共享数据库。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2018-04-20T19:04:00.920

您要求获得真实世界的经验。这里有一些：

SQLite 锁定是健壮的，假设底层（网络）文件系统也是健壮的。从历史上看，这是一个糟糕的假设。最近的操作系统让它变得更好。

如果您遵守规则，您最大的问题将是数据库连续“锁定”数分钟的情况。例如，如果网络丢弃了来自读取器的“解锁”请求，您可能无法写入，直到锁定到期。如果作家的“解锁”丢失，您将无法阅读。（说句公道话，普通文件也会遇到同样的问题。）

在为数据库禁用“机会锁定”（客户端级文件缓存）的良好可靠网络上，您会遇到更少的问题。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-25T08:41:58.893

好吧，我不是伟大的 sqlite 专家，但我相信记录/表的锁定可能无法正常工作，并且可能导致数据库损坏。因为没有单一的服务器维护中央锁定，不同机器上的两个 sqlite dll 实例通过网络共享相同的文件可能根本无法正常工作。如果在同一台机器上打开数据库，sqlite 可能会使用操作系统提供的文件级锁定来保持完整性，但我怀疑它是否在网络共享上正常工作。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2014-12-13T10:10:31.423

> “如果您有许多客户端程序通过网络访问公共数据库，您应该考虑使用客户端/服务器数据库引擎而不是 SQLite。SQLite 将在网络文件系统上工作，但由于与大多数网络文件系统相关的延迟，性能将不是很好。此外，许多网络文件系统实现的文件锁定逻辑包含错误（在 Unix 和 Windows 上）。如果文件锁定不能正常工作，两个或多个客户端程序可能会修改同一部分“

来自[https://www.sqlite.org/whentouse.html](https://www.sqlite.org/whentouse.html)

这也适用于任何类型的基于文件的数据库，例如`Microsoft Access`

# javascript - 如何使用 jQuery 在 2 种 CSS 颜色之间切换？

> ID：788518
> 
> 赞同：0
> 
> 时间：2009-04-25T08:19:15.673
> 
> 标签：javascript, jquery

当我单击页面上某处的按钮时，我希望一串文本将颜色从默认更改为#c30，并且当我再次单击该按钮时它会更改回默认值。

我的代码如下所示：

```
$("#button").click(function() {
    var anno = $(#text);
    if (anno.css('color') == '#c30') {
        anno.css('color', '');
    } else {
        anno.css('color', '#c30');
    }

}); 
```

但它似乎不适用于FF3。虽然在 IE 中工作。任何的想法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-25T08:39:56.543

我会尝试尽可能地分离表现细节，即更改元素所属的类，并将颜色信息留在单独的样式表中。

```
$("#button").click(function() {
        $("#text").toggleClass('somethingDescriptive');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T08:26:00.727

如果您使用命名颜色，这将起作用。

```
$("#button").click(function(){
      $("#text").css('color', $("#text").css('color') == 'white' ? 'black' : 'white');    
}); 
```

十六进制值没有。

无论如何，这是一种不好的方法，我同意这里投票最多的答案。因此，经过一些研究，我更新了我的答案。

```
<style type="text/css">
     .color1 { color:#fff; }
     .color2 { color:#000; } 
</style>
<script>
    $("#button").click(function(){
          $("#text").toggleClass('color1').toggleClass('color2');
    });
</script?

<div class="color1">Text</div> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-25T08:27:51.893

颜色 #c30 转换为 #cc3300 - 这就是它不起作用的原因。

# asp.net-mvc - 使用另外两个层扩展成员配置文件 - asp.net mvc

> ID：788523
> 
> 赞同：1
> 
> 时间：2009-04-25T08:22:02.470
> 
> 标签：asp.net-mvc

我有一个与配置文件相关的建模问题。首先，我研究过使用 SQLTableProvider 并使用内置的分析系统，但觉得它们不合适。所以，话虽如此，我有一个会员计划，每个人都有一个个人资料，然后那个人可以将他们的个人资料升级为个人（附加字段）或公司帐户（再次附加字段）。

所以我想，使用 Profile 基类，然后为公司帐户和个人帐户继承该基类。然而，当谈到在 MVC 中实现这一点时，我遇到了障碍。

由于公司或个人编辑页面都有效地更新了基本配置文件表以及同一页面中的个人/公司表。我将如何在模型（当前通过 LinqToSQL 生成）以及视图级别实现这一点？

抱歉，如果这不是很清楚，很难解释！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T20:55:55.650

如果您使用的是 Linq to SQL，那么您已经有了一个模型。Linq 根据您的数据库为您生成实体和集合。生成的模型是一个浅层模型，但非常可靠且可行。Linq to SQL 模型可以通过分部类进行扩展，允许您增强实体或上下文本身以获得附加功能。

控制器可以直接针对生成的模型工作，并根据需要将实体或实体集合传递给视图。

我建议，对于您似乎正在尝试做的事情，您可能会考虑根本不使用内置的配置文件提供程序系统。asp.net 中的配置文件提供程序适用于简单的个性化内容，但不适用于联系信息等具体数据。还要记住，配置文件提供者系统倾向于将对象数据作为序列化字符串存储在数据库中......这使得从管理工具等获取配置文件数据变得非常困难。在您需要多个用户的个人资料信息（例如使用管理员用户编辑器）的任何情况下，性能很快就会成为一个问题。

当您存储重要的个人详细信息（例如您提到的内容）时，您真正存储的是“帐户详细信息”而不是“用户配置文件”。您可以扩展成员资格提供程序以公开您的其他详细信息，但我通常发现滚动我自己的数据模型和访问逻辑来处理其他帐户信息要容易得多。

我的经验法则是：如果仅在数据所属用户提出请求期间需要该信息，则该信息将放入配置文件中。如果我需要在另一个用户的请求期间读取一个用户的数据，或者如果我需要一个不同用户的数据“列表”，那么它不会进入 asp.net 配置文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T13:37:00.213

您是指诸如选择在每个页面上查看多少项目以及选择一些样式表之类的设置吗？

```
public class Profile
{
    int? ItemsPerPage { get; set; }
    string PreferredStyleSheet { get; set; }
} 
```

公司选择一些对用户有用的值，除非用户为自己选择了一些其他值。这就是你的想法吗？

* * *

在那种情况下：我不知道如何在 ASP.NET 配置文件中一起做，但是数据库中的以下表怎么样：

```
TABLE Setting
(
    SettingID int NOT NULL,
    SettingName varchar(32) NOT NULL,
    DefaultValue nvarchar(128) NULL
)
TABLE CompanySetting
(
    CompanySettingID int NOT NULL,
    RefSettingID int NOT NULL,
    RefCompanyID int NOT NULL,
    SettingValue nvarchar(128) NOT NULL
)
TABLE UserSetting
(
    UserSettingID int NOT NULL,
    RefSettingID int NOT NULL,
    RefUserId uniqueidentifier NOT NULL,
    SettingValue nvarchar(128) NOT NULL
) 
```

然后为当前用户做一些连接。如果没有给出用户设置，则取公司设置；如果没有给出公司设置，则取默认值。

# windows-vista - 用于运行应用奇数天的 Vista 批处理

> ID：788531
> 
> 赞同：0
> 
> 时间：2009-04-25T08:32:11.710
> 
> 标签：windows-vista, batch-file

我已经阅读了所有关于节省时间的内容，并且我不想为我的 IM 应用程序创建一个不会在奇数日子运行的快捷方式。可以在 Windows Vista 批处理中吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T08:41:26.197

您可以尝试使用[Windows 任务计划程序](http://technet.microsoft.com/en-us/appcompat/aa906020.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T09:40:05.697

我对批处理文件很生疏，但我认为你想用伪代码做的是：

```
if %DAY% mod 2 = 0 then run 
```

（%DAY% 应该返回当月的某一天，但请记住，这不会在 31 日或 1 日运行，因此有时您会连续两天在没有应用程序的情况下卡住）

# java - 如何使用 -Dmaven.test.skip 控制 Maven Jetty 插件的执行

> ID：788532
> 
> 赞同：2
> 
> 时间：2009-04-25T08:32:39.463
> 
> 标签：java, maven-2, jetty

我正在使用[Jetty](http://www.mortbay.org)和[Selenium](http://seleniumhq.org/)来自动化我的[Maven 2](http://maven.apache.org)中的一些单元测试。我们真的只想将这些测试作为 CI 构建的一部分运行，并希望通过`-Dmaven.test.skip`属性来控制它。

我找不到将其应用于 Jetty 插件执行的方法。我错过了一些明显的东西吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T15:25:53.823

关于此功能的功能请求已经修复，现在您可以通过设置`jetty.skip`属性跳过 jetty 插件执行：

```
$ mvn -Djetty.skip=true 
```

也可以看看：

*   [http://wiki.eclipse.org/Jetty/Feature/Jetty_Maven_Plugin#Skipping_execution_of_jetty](http://wiki.eclipse.org/Jetty/Feature/Jetty_Maven_Plugin#Skipping_execution_of_jetty)
*   [http://jira.codehaus.org/browse/JETTY-1051](http://jira.codehaus.org/browse/JETTY-1051)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-25T21:21:58.693

maven.test.skip 属性是 surefire 插件用来决定是否应该跳过的属性。jetty 插件根本不关心这个属性。这样做的唯一方法是将您的 jetty 插件执行移动到配置文件中，并在 maven.test.skip 属性为 false 时尝试[激活它。](http://maven.apache.org/pom.html#Activation)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-25T13:46:58.427

见[http://docs.codehaus.org/display/JETTY/Maven+Jetty+Plugin](http://docs.codehaus.org/display/JETTY/Maven+Jetty+Plugin)

# c# - Eric Lippert 的挑战“comma-quibbling”，最佳答案？

> ID：788535
> 
> 赞同：23
> 
> 时间：2009-04-25T08:37:10.030
> 
> 标签：c#, programming-languages, puzzle

我想让这个挑战引起 stackoverflow 社区的注意。原来的问题和答案都[在这里](http://blogs.msdn.com/ericlippert/archive/2009/04/15/comma-quibbling.aspx)。BTW，如果你以前没有关注过，你应该尝试阅读 Eric 的博客，这是纯粹的智慧。

**概括：**

编写一个函数，它接受一个非空 IEnumerable 并返回一个具有以下特征的字符串：

1.  如果序列为空，则结果字符串为“{}”。
2.  如果序列是单个项目“ABC”，则结果字符串为“{ABC}”。
3.  如果序列是两个项目序列“ABC”、“DEF”，则结果字符串为“{ABC 和 DEF}”。
4.  如果序列有两个以上的项目，比如“ABC”、“DEF”、“G”、“H”，那么结果字符串是“{ABC, DEF, G and H}”。（注意：没有牛津逗号！）

正如您所看到的，甚至我们自己的 Jon Skeet（是的，众所周知，[他可以同时在两个地方](https://stackoverflow.com/questions/305223/jon-skeet-facts)）发布了一个解决方案，但他的（恕我直言）并不是最优雅的，尽管您可能无法击败它表现。

你怎么看？那里有很多不错的选择。我真的很喜欢涉及选择和聚合方法的解决方案之一（来自 Fernando Nicolet）。Linq 非常强大，花一些时间来应对这样的挑战会让你学到很多东西。我稍微扭曲了它，让它更高效更清晰（通过使用 Count 并避免 Reverse）：

```
public static string CommaQuibbling(IEnumerable<string> items)
{
    int last = items.Count() - 1;
    Func<int, string> getSeparator = (i) => i == 0 ? string.Empty : (i == last ? " and " : ", ");
    string answer = string.Empty;

    return "{" + items.Select((s, i) => new { Index = i, Value = s })
                      .Aggregate(answer, (s, a) => s + getSeparator(a.Index) + a.Value) + "}";
} 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-04-25T19:52:20.810

效率低下，但我认为清楚。

```
public static string CommaQuibbling(IEnumerable<string> items)
{
    List<String> list = new List<String>(items);
    if (list.Count == 0) { return "{}"; }
    if (list.Count == 1) { return "{" + list[0] + "}"; }

    String[] initial = list.GetRange(0, list.Count - 1).ToArray();
    return "{" + String.Join(", ", initial) + " and " + list[list.Count - 1] + "}";
} 
```

如果我在维护代码，我更喜欢这个而不是更聪明的版本。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-04-25T08:53:33.797

这种方法怎么样？纯粹累积 - 没有回溯，并且只迭代一次。对于原始性能，我不确定您是否会在使用 LINQ 等方面做得更好，无论 LINQ 答案可能有多“漂亮”。

```
using System;
using System.Collections.Generic;
using System.Text;

static class Program
{
    public static string CommaQuibbling(IEnumerable<string> items)
    {
        StringBuilder sb = new StringBuilder('{');
        using (var iter = items.GetEnumerator())
        {
            if (iter.MoveNext())
            { // first item can be appended directly
                sb.Append(iter.Current);
                if (iter.MoveNext())
                { // more than one; only add each
                  // term when we know there is another
                    string lastItem = iter.Current;
                    while (iter.MoveNext())
                    { // middle term; use ", "
                        sb.Append(", ").Append(lastItem);
                        lastItem = iter.Current;
                    }
                    // add the final term; since we are on at least the
                    // second term, always use " and "
                    sb.Append(" and ").Append(lastItem);
                }
            }
        }
        return sb.Append('}').ToString();
    }
    static void Main()
    {
        Console.WriteLine(CommaQuibbling(new string[] { }));
        Console.WriteLine(CommaQuibbling(new string[] { "ABC" }));
        Console.WriteLine(CommaQuibbling(new string[] { "ABC", "DEF" }));
        Console.WriteLine(CommaQuibbling(new string[] {
             "ABC", "DEF", "G", "H" }));
    }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-25T10:04:06.497

如果我对需要第一个/最后一个信息的流做了很多工作，我会有扩展名：

```
[Flags]
public enum StreamPosition
{
   First = 1, Last = 2
}

public static IEnumerable<R> MapWithPositions<T, R> (this IEnumerable<T> stream, 
    Func<StreamPosition, T, R> map)
{
    using (var enumerator = stream.GetEnumerator ())
    {
        if (!enumerator.MoveNext ()) yield break ;

        var cur   = enumerator.Current   ;
        var flags = StreamPosition.First ;
        while (true)
        {
            if (!enumerator.MoveNext ()) flags |= StreamPosition.Last ;
            yield return map (flags, cur) ;
            if ((flags & StreamPosition.Last) != 0) yield break ;
            cur   = enumerator.Current ;
            flags = 0 ;
        }
    }
} 
```

然后最简单的（不是最快的，需要一些更方便的扩展方法）解决方案将是：

```
public static string Quibble (IEnumerable<string> strings)
{
    return "{" + String.Join ("", strings.MapWithPositions ((pos, item) => (
       (pos &  StreamPosition.First) != 0      ? "" : 
        pos == StreamPosition.Last   ? " and " : ", ") + item)) + "}" ;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-10-12T00:44:00.727

这里作为 Python 单线

```
 >>> f=lambda s:"{%s}"%", ".join(s)[::-1].replace(',','dna ',1)[::-1]
>>> f([])
'{}'
>>> f(["ABC"])
'{ABC}'
>>> f(["ABC","DEF"])
'{ABC and DEF}'
>>> f(["ABC","DEF","G","H"])
'{ABC, DEF, G and H}' 
```

这个版本可能更容易理解

```
 >>> f=lambda s:"{%s}"%" and ".join(s).replace(' and',',',len(s)-2)
>>> f([])
'{}'
>>> f(["ABC"])
'{ABC}'
>>> f(["ABC","DEF"])
'{ABC and DEF}'
>>> f(["ABC","DEF","G","H"])
'{ABC, DEF, G and H}' 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-25T09:15:23.853

这是一个简单的 F# 解决方案，它只进行一次前向迭代：

```
let CommaQuibble items =
    let sb = System.Text.StringBuilder("{")
    // pp is 2 previous, p is previous
    let pp,p = items |> Seq.fold (fun (pp:string option,p) s -> 
        if pp <> None then
            sb.Append(pp.Value).Append(", ") |> ignore
        (p, Some(s))) (None,None)
    if pp <> None then
        sb.Append(pp.Value).Append(" and ") |> ignore
    if p <> None then
        sb.Append(p.Value) |> ignore
    sb.Append("}").ToString() 
```

（编辑：事实证明这与 Skeet 的非常相似。）

测试代码：

```
let Test l =
    printfn "%s" (CommaQuibble l)

Test []
Test ["ABC"]        
Test ["ABC";"DEF"]        
Test ["ABC";"DEF";"G"]        
Test ["ABC";"DEF";"G";"H"]        
Test ["ABC";null;"G";"H"] 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-25T10:10:46.047

**免责声明**：我以此为借口来玩弄新技术，所以我的解决方案并没有真正满足 Eric 最初对清晰度和可维护性的要求。

**朴素的枚举器解决方案** （我承认这个`foreach`变体是优越的，因为它不需要手动弄乱枚举器。）

```
public static string NaiveConcatenate(IEnumerable<string> sequence)
{
    StringBuilder sb = new StringBuilder();
    sb.Append('{');

    IEnumerator<string> enumerator = sequence.GetEnumerator();

    if (enumerator.MoveNext())
    {
        string a = enumerator.Current;
        if (!enumerator.MoveNext())
        {
            sb.Append(a);
        }
        else
        {
            string b = enumerator.Current;
            while (enumerator.MoveNext())
            {
                sb.Append(a);
                sb.Append(", ");
                a = b;
                b = enumerator.Current;
            }
            sb.AppendFormat("{0} and {1}", a, b);
        }
    }

    sb.Append('}');
    return sb.ToString();
} 
```

**使用 LINQ 的解决方案**

```
public static string ConcatenateWithLinq(IEnumerable<string> sequence)
{
    return (from item in sequence select item)
        .Aggregate(
        new {sb = new StringBuilder("{"), a = (string) null, b = (string) null},
        (s, x) =>
            {
                if (s.a != null)
                {
                    s.sb.Append(s.a);
                    s.sb.Append(", ");
                }
                return new {s.sb, a = s.b, b = x};
            },
        (s) =>
            {
                if (s.b != null)
                    if (s.a != null)
                        s.sb.AppendFormat("{0} and {1}", s.a, s.b);
                    else
                        s.sb.Append(s.b);
                s.sb.Append("}");
                return s.sb.ToString();
            });
} 
```

**使用 TPL 的解决方案**

该解决方案使用生产者-消费者队列将输入序列提供给处理器，同时在队列中保留至少两个缓冲的元素。一旦生产者到达输入序列的末尾，就可以对最后两个元素进行特殊处理。

事后看来，没有理由让消费者异步操作，这将消除对并发队列的需要，但正如我之前所说，我只是以此为借口来玩新技术:-)

```
public static string ConcatenateWithTpl(IEnumerable<string> sequence)
{
    var queue = new ConcurrentQueue<string>();
    bool stop = false;

    var consumer = Future.Create(
        () =>
            {
                var sb = new StringBuilder("{");
                while (!stop || queue.Count > 2)
                {
                    string s;
                    if (queue.Count > 2 && queue.TryDequeue(out s))
                        sb.AppendFormat("{0}, ", s);
                }
                return sb;
            });

    // Producer
    foreach (var item in sequence)
        queue.Enqueue(item);

    stop = true;
    StringBuilder result = consumer.Value;

    string a;
    string b;

    if (queue.TryDequeue(out a))
        if (queue.TryDequeue(out b))
            result.AppendFormat("{0} and {1}", a, b);
        else
            result.Append(a);

    result.Append("}");
    return result.ToString();
} 
```

为简洁起见省略了单元测试。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-02T17:30:25.943

我是连环逗号的粉丝：我吃，开枪，然后离开。

我一直需要解决这个问题，并且已经用 3 种语言（虽然不是 C#）解决了它。我将通过编写适用于 any 的方法来调整以下解决方案（在[Lua](http://www.lua.org)中，不将答案括在花括号中）：`concat``IEnumerable`

```
function commafy(t, andword)
  andword = andword or 'and'
  local n = #t -- number of elements in the numeration
  if n == 1 then
    return t[1]
  elseif n == 2 then
    return concat { t[1], ' ', andword, ' ', t[2] }
  else
    local last = t[n]
    t[n] = andword .. ' ' .. t[n]
    local answer = concat(t, ', ')
    t[n] = last
    return answer
  end
end 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-22T20:04:43.247

这不是很好的可读性，但它可以很好地扩展到数千万个字符串。我正在一个旧的 Pentium 4 工作站上开发，它在大约 350 毫秒内完成了 1,000,000 个平均长度为 8 的字符串。

```
public static string CreateLippertString(IEnumerable<string> strings)
{
    char[] combinedString;
    char[] commaSeparator = new char[] { ',', ' ' };
    char[] andSeparator = new char[] { ' ', 'A', 'N', 'D', ' ' };

    int totalLength = 2;  //'{' and '}'
    int numEntries = 0;
    int currentEntry = 0;
    int currentPosition = 0;
    int secondToLast;
    int last;
    int commaLength= commaSeparator.Length;
    int andLength = andSeparator.Length;
    int cbComma = commaLength * sizeof(char);
    int cbAnd = andLength * sizeof(char);

    //calculate the sum of the lengths of the strings
    foreach (string s in strings)
    {
        totalLength += s.Length;
        ++numEntries;
    }

    //add to the total length the length of the constant characters
    if (numEntries >= 2)
        totalLength += 5;  // " AND "

    if (numEntries > 2)
        totalLength += (2 * (numEntries - 2)); // ", " between items

    //setup some meta-variables to help later
    secondToLast = numEntries - 2;
    last = numEntries - 1;

    //allocate the memory for the combined string
    combinedString = new char[totalLength];
    //set the first character to {
    combinedString[0] = '{';
    currentPosition = 1;

    if (numEntries > 0)
    {
        //now copy each string into its place
        foreach (string s in strings)
        {
            Buffer.BlockCopy(s.ToCharArray(), 0, combinedString, currentPosition * sizeof(char), s.Length * sizeof(char));
            currentPosition += s.Length;

            if (currentEntry == secondToLast)
            {
                Buffer.BlockCopy(andSeparator, 0, combinedString, currentPosition * sizeof(char), cbAnd);
                currentPosition += andLength;
            }
            else if (currentEntry == last)
            {
                combinedString[currentPosition] = '}'; //set the last character to '}'
                break;  //don't bother making that last call to the enumerator
            }
            else if (currentEntry < secondToLast)
            {
                Buffer.BlockCopy(commaSeparator, 0, combinedString, currentPosition * sizeof(char), cbComma);
                currentPosition += commaLength;
            }

            ++currentEntry;
        }
    }
    else
    {
        //set the last character to '}'
        combinedString[1] = '}';
    }

    return new string(combinedString);
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-10-09T09:31:05.297

另一个变体 - 为了代码清晰起见，将标点符号和迭代逻辑分开。并且还在考虑性能。

按要求使用纯 IEnumerable/string/ 和列表中的字符串不能为空。

```
public static string Concat(IEnumerable<string> strings)
{
    return "{" + strings.reduce("", (acc, prev, cur, next) => 
               acc.Append(punctuation(prev, cur, next)).Append(cur)) + "}";
}
private static string punctuation(string prev, string cur, string next)
{
    if (null == prev || null == cur)
        return "";
    if (null == next)
        return " and ";
    return ", ";
}

private static string reduce(this IEnumerable<string> strings, 
    string acc, Func<StringBuilder, string, string, string, StringBuilder> func)
{
    if (null == strings) return "";

    var accumulatorBuilder = new StringBuilder(acc);
    string cur = null;
    string prev = null;
    foreach (var next in strings)
    {
        func(accumulatorBuilder, prev, cur, next);
        prev = cur;
        cur = next;
    }
    func(accumulatorBuilder, prev, cur, null);

    return accumulatorBuilder.ToString();
} 
```

F# 肯定看起来好多了：

```
let rec reduce list =
    match list with
    | []          -> ""
    | head::curr::[]  -> head + " and " + curr
    | head::curr::tail  -> head + ", " + curr :: tail |> reduce
    | head::[] -> head

let concat list = "{" + (list |> reduce )  + "}" 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-03-23T05:53:45.050

迟到：

```
public static string CommaQuibbling(IEnumerable<string> items)
{
    string[] parts = items.ToArray();
    StringBuilder result = new StringBuilder('{');
    for (int i = 0; i < parts.Length; i++)
    {
        if (i > 0)
            result.Append(i == parts.Length - 1 ? " and " : ", ");
        result.Append(parts[i]);
    }
    return result.Append('}').ToString();
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-25T08:56:03.340

```
public static string CommaQuibbling(IEnumerable<string> items)
{
  int count = items.Count();
  string answer = string.Empty;
  return "{" + 
      (count==0)  ?  ""  :  
         (  items[0] + 
             (count == 1 ? "" :  
                 items.Range(1,count-1).
                     Aggregate(answer, (s,a)=> s += ", " + a) +
                 items.Range(count-1,1).
                     Aggregate(answer, (s,a)=> s += " AND " + a) ))+ "}";
} 
```

它被实现为，

```
if count == 0 , then return empty,
if count == 1 , then return only element,
if count > 1 , then take two ranges, 
   first 2nd element to 2nd last element
   last element 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-04-25T09:25:56.310

跳过复杂的聚合代码并在构建后清理字符串怎么样？

```
public static string CommaQuibbling(IEnumerable<string> items)    
{
    var aggregate = items.Aggregate<string, StringBuilder>(
        new StringBuilder(), 
        (b,s) => b.AppendFormat(", {0}", s));
    var trimmed = Regex.Replace(aggregate.ToString(), "^, ", string.Empty);
    return string.Format(
               "{{{0}}}", 
               Regex.Replace(trimmed, 
                   ", (?<last>[^,]*)$", @" and ${last}"));
} 
```

更新：正如评论中所指出的，这不适用于带有逗号的字符串。我尝试了其他一些变体，但没有明确的字符串可以包含什么规则，我将遇到真正的问题，将任何可能的最后一项与正则表达式匹配，这对我来说是一个很好的教训，了解它们的局限性。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-04-25T10:19:56.337

这是我的，但我意识到它与 Marc 的非常相似，在事物的顺序上有一些细微差别，并且我还添加了单元测试。

```
using System;
using NUnit.Framework;
using NUnit.Framework.Extensions;
using System.Collections.Generic;
using System.Text;
using NUnit.Framework.SyntaxHelpers;

namespace StringChallengeProject
{
    [TestFixture]
    public class StringChallenge
    {
        [RowTest]
        [Row(new String[] { }, "{}")]
        [Row(new[] { "ABC" }, "{ABC}")]
        [Row(new[] { "ABC", "DEF" }, "{ABC and DEF}")]
        [Row(new[] { "ABC", "DEF", "G", "H" }, "{ABC, DEF, G and H}")]
        public void Test(String[] input, String expectedOutput)
        {
            Assert.That(FormatString(input), Is.EqualTo(expectedOutput));
        }

        //codesnippet:93458590-3182-11de-8c30-0800200c9a66
        public static String FormatString(IEnumerable<String> input)
        {
            if (input == null)
                return "{}";

            using (var iterator = input.GetEnumerator())
            {
                // Guard-clause for empty source
                if (!iterator.MoveNext())
                    return "{}";

                // Take care of first value
                var output = new StringBuilder();
                output.Append('{').Append(iterator.Current);

                // Grab next
                if (iterator.MoveNext())
                {
                    // Grab the next value, but don't process it
                    // we don't know whether to use comma or "and"
                    // until we've grabbed the next after it as well
                    String nextValue = iterator.Current;
                    while (iterator.MoveNext())
                    {
                        output.Append(", ");
                        output.Append(nextValue);

                        nextValue = iterator.Current;
                    }

                    output.Append(" and ");
                    output.Append(nextValue);
                }

                output.Append('}');
                return output.ToString();
            }
        }
    }
} 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-04-25T11:04:05.730

我非常喜欢乔恩的回答，但那是因为它很像我解决问题的方式。我没有在这两个变量中专门编码，而是在 FIFO 队列中实现了它们。

这很奇怪，因为我只是假设会有 15 个帖子都做了完全相同的事情，但看起来我们是唯一这样做的两个。哦，看看这些答案，Marc Gravell 的答案也非常接近我们使用的方法，但他使用的是两个“循环”，而不是坚持价值观。

但是所有这些使用 LINQ 和正则表达式以及加入数组的答案看起来就像是疯话！:-)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-04-25T12:23:05.213

我不认为使用一个好的旧数组是一种限制。这是我使用数组和扩展方法的版本：

```
public static string CommaQuibbling(IEnumerable<string> list)
{
    string[] array = list.ToArray();

    if (array.Length == 0) return string.Empty.PutCurlyBraces();
    if (array.Length == 1) return array[0].PutCurlyBraces();

    string allExceptLast = string.Join(", ", array, 0, array.Length - 1);
    string theLast = array[array.Length - 1];

    return string.Format("{0} and {1}", allExceptLast, theLast)
                 .PutCurlyBraces();
}

public static string PutCurlyBraces(this string str)
{
    return "{" + str + "}";
} 
```

我使用数组是因为该`string.Join`方法以及是否有可能通过索引访问最后一个元素。扩展方法在这里是因为 DRY。

我认为性能损失来自`list.ToArray()`and`string.Join`调用，但我希望这一段代码易于阅读和维护。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-04-25T19:26:16.007

我认为 Linq 提供了相当可读的代码。这个版本在 0.89 秒内处理了一百万个“ABC”：

```
using System.Collections.Generic;
using System.Linq;

namespace CommaQuibbling
{
    internal class Translator
    {
        public string Translate(IEnumerable<string> items)
        {
            return "{" + Join(items) + "}";
        }

        private static string Join(IEnumerable<string> items)
        {
            var leadingItems = LeadingItemsFrom(items);
            var lastItem = LastItemFrom(items);

            return JoinLeading(leadingItems) + lastItem;
        }

        private static IEnumerable<string> LeadingItemsFrom(IEnumerable<string> items)
        {
            return items.Reverse().Skip(1).Reverse();
        }

        private static string LastItemFrom(IEnumerable<string> items)
        {
            return items.LastOrDefault();
        }

        private static string JoinLeading(IEnumerable<string> items)
        {
            if (items.Any() == false) return "";

            return string.Join(", ", items.ToArray()) + " and ";
        }
    }
} 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-04-27T19:18:01.267

您可以使用没有 LINQ 的 foreach、委托、闭包、列表或数组，并且仍然具有可理解的代码。使用 bool 和字符串，如下所示：

```
public static string CommaQuibbling(IEnumerable items)
{
    StringBuilder sb = new StringBuilder("{");
    bool empty = true;
    string prev = null;
    foreach (string s in items)
    {
        if (prev!=null)
        {
            if (!empty) sb.Append(", ");
            else empty = false;
            sb.Append(prev);
        }
        prev = s;
    }
    if (prev!=null)
    {
        if (!empty) sb.Append(" and ");
        sb.Append(prev);
    }
    return sb.Append('}').ToString();
}
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-04-27T20:27:43.487

```
public static string CommaQuibbling(IEnumerable<string> items)
{
   var itemArray = items.ToArray();

   var commaSeparated = String.Join(", ", itemArray, 0, Math.Max(itemArray.Length - 1, 0));
   if (commaSeparated.Length > 0) commaSeparated += " and ";

   return "{" + commaSeparated + itemArray.LastOrDefault() + "}";
} 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2010-10-02T20:16:10.770

这是我的提交。稍微修改了签名以使其更通用。使用 .NET 4 功能（`String.Join()`using `IEnumerable<T>`），否则适用于 .NET 3.5。目标是使用具有显着简化逻辑的 LINQ。

```
static string CommaQuibbling<T>(IEnumerable<T> items)
{
    int count = items.Count();
    var quibbled = items.Select((Item, index) => new { Item, Group = (count - index - 2) > 0})
                        .GroupBy(item => item.Group, item => item.Item)
                        .Select(g => g.Key
                            ? String.Join(", ", g)
                            : String.Join(" and ", g));
    return "{" + String.Join(", ", quibbled) + "}";
} 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2010-10-02T20:43:22.767

有几个非 C# 的答案，并且原始帖子确实要求任何语言的答案，所以我想我会展示另一种 C# 程序员似乎没有触及的方法：DSL！

```
(defun quibble-comma (words)
  (format nil "~{~#[~;~a~;~a and ~a~:;~@{~a~#[~; and ~:;, ~]~}~]~}" words)) 
```

精明的人会注意到 Common Lisp 并没有真正`IEnumerable<T>`内置，因此`FORMAT`这里只能在适当的列表上工作。但如果你做了一个`IEnumerable`，你当然也可以扩展`FORMAT`工作。（Clojure 有这个吗？）

此外，任何阅读这篇文章的有*品味*的人（包括 Lisp 程序员！）都可能会被`"~{~#[~;~a~;~a and ~a~:;~@{~a~#[~; and ~:;, ~]~}~]~}"`那里的文字所冒犯。我不会声称它`FORMAT`实现了一个*好的*DSL，但我确实相信拥有*一些*强大的 DSL 来组合字符串是非常有用的。正则表达式是一种强大的 DSL，用于将字符串分开，并且`string.Format`是一种用于将字符串组合在一起的 DSL（某种），但它非常弱。

我想每个人都在写这类东西。为什么还没有一些内置的通用 DSL 呢？我认为我们最接近的是“Perl”，也许。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2011-01-25T21:06:38.647

只是为了好玩，使用 C# 4.0 中的新 Zip 扩展方法：

```
private static string CommaQuibbling(IEnumerable<string> list)
{
    IEnumerable<string> separators = GetSeparators(list.Count());
    var finalList = list.Zip(separators, (w, s) => w + s);
    return string.Concat("{", string.Join(string.Empty, finalList), "}");
}

private static IEnumerable<string> GetSeparators(int itemCount)
{
    while (itemCount-- > 2)
        yield return ", ";

    if (itemCount == 1)
        yield return " and ";

    yield return string.Empty;
} 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2011-01-28T14:50:44.600

```
return String.Concat(
    "{",
    input.Length > 2 ?
        String.Concat(
            String.Join(", ", input.Take(input.Length - 1)),
            " and ",
            input.Last()) :
    String.Join(" and ", input),
    "}"); 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2012-08-15T05:26:56.653

我试过使用foreach。请让我知道你的意见。

```
private static string CommaQuibble(IEnumerable<string> input)
{
    var val = string.Concat(input.Process(
        p => p,
        p => string.Format(" and {0}", p),
        p => string.Format(", {0}", p)));
    return string.Format("{{{0}}}", val);
}

public static IEnumerable<T> Process<T>(this IEnumerable<T> input, 
    Func<T, T> firstItemFunc, 
    Func<T, T> lastItemFunc, 
    Func<T, T> otherItemFunc)
{
    //break on empty sequence
    if (!input.Any()) yield break;

    //return first elem
    var first = input.First();
    yield return firstItemFunc(first);

    //break if there was only one elem
    var rest = input.Skip(1);
    if (!rest.Any()) yield break;

    //start looping the rest of the elements
    T prevItem = first;
    bool isFirstIteration = true;
    foreach (var item in rest)
    {
        if (isFirstIteration) isFirstIteration = false;
        else
        {
            yield return otherItemFunc(prevItem);
        }
        prevItem = item;
    }

    //last element
    yield return lastItemFunc(prevItem);
} 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2013-10-14T20:45:34.150

以下是基于[http://blogs.perl.org/users/brian_d_foy/2013/10/comma-quibbling-in-perl.html](http://blogs.perl.org/users/brian_d_foy/2013/10/comma-quibbling-in-perl.html)上的回复用 Perl 编写的几个解决方案和测试代码。

```
#!/usr/bin/perl

use 5.14.0;
use warnings;
use strict;
use Test::More qw{no_plan};

sub comma_quibbling1 {
   my (@words) = @_;
   return "" unless @words;
   return $words[0] if @words == 1;
   return join(", ", @words[0 .. $#words - 1]) . " and $words[-1]";
}

sub comma_quibbling2 {
   return "" unless @_;
   my $last = pop @_;
   return $last unless @_;
   return join(", ", @_) . " and $last";
}

is comma_quibbling1(qw{}),                   "",                         "1-0";
is comma_quibbling1(qw{one}),                "one",                      "1-1";
is comma_quibbling1(qw{one two}),            "one and two",              "1-2";
is comma_quibbling1(qw{one two three}),      "one, two and three",       "1-3";
is comma_quibbling1(qw{one two three four}), "one, two, three and four", "1-4";

is comma_quibbling2(qw{}),                   "",                         "2-0";
is comma_quibbling2(qw{one}),                "one",                      "2-1";
is comma_quibbling2(qw{one two}),            "one and two",              "2-2";
is comma_quibbling2(qw{one two three}),      "one, two and three",       "2-3";
is comma_quibbling2(qw{one two three four}), "one, two, three and four", "2-4"; 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2018-08-15T20:34:08.503

距离上一篇文章还不到十年，所以这是我的变化：

```
 public static string CommaQuibbling(IEnumerable<string> items)
    {
        var text = new StringBuilder();
        string sep = null;
        int last_pos = items.Count();
        int next_pos = 1;

        foreach(string item in items)
        {
            text.Append($"{sep}{item}");
            sep = ++next_pos < last_pos ? ", " : " and ";
        }

        return $"{{{text}}}";
    } 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2020-08-29T21:49:53.347

在一份声明中：

```
public static string CommaQuibbling(IEnumerable<string> inputList)
{
    return
        String.Concat("{",
            String.Join(null, inputList
                .Select((iw, i) =>
                    (i == (inputList.Count() - 1)) ? $"{iw}" :
                        (i == (inputList.Count() - 2) ? $"{iw} and " : $"{iw}, "))
                    .ToArray()), "}");
} 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2020-08-29T23:38:53.633

`.NET Core`我们可以利用SkipLast和[TakeLast](https://docs.microsoft.com/en-us/dotnet/api/system.linq.enumerable.skiplast?view=netcore-3.1) [。](https://docs.microsoft.com/en-us/dotnet/api/system.linq.enumerable.takelast?view=netcore-3.1)

```
public static string CommaQuibblify(IEnumerable<string> items)
{
    var head = string.Join(", ", items.SkipLast(2).Append(""));
    var tail = string.Join(" and ", items.TakeLast(2));
    return '{' + head + tail + '}';
} 
```

[https://dotnetfiddle.net/X58qvZ](https://dotnetfiddle.net/X58qvZ)

# apache-flex - Flex Bipmapdata 和滚动画布

> ID：788540
> 
> 赞同：1
> 
> 时间：2009-04-25T08:38:52.770
> 
> 标签：apache-flex, actionscript-3, canvas, capture

我有一个画布，它是一个绘图区。此画布可以水平和垂直滚动。

我正在尝试制作**整个画布**的屏幕截图，其中包括可见部分和滚动部分。

```
var bmd:BitmapData = new BitmapData(board.width, board.height, false, 0xffffff);
bmd.draw(board); 
```

这只会显示画布的可见部分及其滚动条：/

你会如何解决这样的问题？在这种情况下，使用 board.width + board.horizo​​ntalScrollPosition 不会有帮助。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T08:52:39.633

我认为你最好的选择是嵌套画布。一个画布是固定大小，包含较小的可滚动区域，另一个是完整的画布。就像是

```
<mx:Canvas id="boardContainer" width="800" height="600">
  <mx:Canvas id="board" width="800" height="1200" />
</mx:Canvas> 
```

这样，您就可以引用未蒙版的画布，并且您应该能够获取整个区域的 bitmapData。

# vb.net - vb.net 运行命令的问题

> ID：788545
> 
> 赞同：0
> 
> 时间：2009-04-25T08:41:16.307
> 
> 标签：vb.net

以下运行应用程序将不起作用

```
 Private Sub RunApplication(ByVal ProgName As String)
        // String of text as a command to execute with the command line interpreter
        Dim strApplication As String = "cmd.exe/c"
        Dim ProcessID As Integer
        strApplication = strApplication & " " & ProgName & " > C:\tool.tmp"

        // Execute the command but hide it from the user
        Shell(strApplication, AppWinStyle.Hide, True)

        // View the Output in notepad.exe
        ProcessID = Shell("notepad.exe C:\tool.tmp", AppWinStyle.NormalFocus)
        AppActivate(ProcessID) 
```

任何建议将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T08:45:02.303

放一个空格“cmd.exe/c”应该是“cmd.exe /c”

# ruby - 是否有更短的方法来要求 ruby 中同一目录中的文件？

> ID：788550
> 
> 赞同：57
> 
> 时间：2009-04-25T08:43:41.963
> 
> 标签：ruby, path, require

是否有更短的方法来要求位于同一目录中的文件（作为正在执行的脚本）？

```
require File.expand_path(File.dirname(__FILE__) + '/some_other_script') 
```

我读到了`require "my_script"`，`require "./my_script"`实际上会加载两次脚本（ruby 不会识别它实际上是同一个脚本），这就是为什么`File.expand_path`推荐的原因：如果每次需要脚本时都使用它，那么它只会被加载一次。

在我看来，像 Ruby 这样简洁的语言似乎没有更短的解决方案。例如，python 就是这样：

```
import .some_other_module_in_the_same_directory 
```

我想我可以猴子补丁`require`......但这只是邪恶的！;-)

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2011-10-22T19:40:16.113

从 ruby​​ 1.9 开始，您可以使用`require_relative`.

检查最新的文档[或](https://ruby-doc.org/core/Kernel.html#method-i-require_relative)`require_relative`其他[版本](https://ruby-doc.org/)的核心 API。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-26T13:01:17.500

只需要`filename`.

`filename`是的，如果您将其指定为and ，它将导入两次`./filename`，所以不要这样做。您没有指定`.rb`，所以不要指定路径。我通常将我的大部分应用程序逻辑放到一个文件中`lib`，然后在其中有一个`bin`看起来像这样的脚本：

```
#!/usr/bin/env ruby

$: << File.join(File.dirname(__FILE__), "/../lib")
require 'app.rb'
App.new.run(ARGV) 
```

另一个优点是，如果加载应用程序逻辑没有自动开始执行它，我发现更容易进行单元测试。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-25T12:55:53.170

即使您从其他目录运行脚本，上述内容也将起作用。但是，在同一目录中，您引用的较短形式按预期工作，至少对于 ruby​​ 1.9 不会导致双重要求。

# testa.rb

```
puts "start test A"
require 'testb'
require './testb'
puts "finish test A" 
```

# 测试b.rb

```
puts "start test B"
puts "finish test B" 
```

运行“ruby testa.rb”将导致：

```
start test A
start test B
finish test B
finish test A 
```

然而，更长的形式甚至可以在另一个目录中工作（例如 ruby​​ somedir/script.rb）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-25T13:56:32.650

把它放在一个标准库目录中（某个地方已经在你的默认 loadpath 中`$:`）：

```
# push-loadpath.rb
if caller.first
  $: << File.expand_path(File.dirname(caller.first))
end 
```

然后，这应该工作

```
% ls /path/to/
bin.rb lib1.rb lib2.rb #...
% cat /path/to/bin.rb
load 'push-loadpath.rb'
require 'lib1'
require 'lib2'
#... 
```

`caller`让你访问当前的调用堆栈，并告诉你什么文件和在哪里，所以`push-loadpath.rb`用它来添加文件到加载`load`路径。

请注意，您应该`load`使用文件而不是文件，`require`因此可以多次调用主体（每次要更改加载路径时调用一次）。

或者，您可以将主体包裹在一个方法中，

```
# push-loadpath.rb
def push_loadpath
  $: << File.expand_path(File.dirname(caller.first))
end 
```

这将允许您`require`使用它，并以这种方式使用它：

```
% ls /path/to/
bin.rb lib1.rb lib2.rb #...
% cat /path/to/bin.rb
require 'push-loadpath'
push_loadpath
require 'lib1'
require 'lib2'
#... 
```

# batch-file - 查找 USB 驱动器号

> ID：788554
> 
> 赞同：0
> 
> 时间：2009-04-25T08:47:25.247
> 
> 标签：batch-file

我需要获取 USB 笔式驱动器的驱动器号。命令 CHDIR >drive.txt 为我提供驱动器号 L:。如何在批处理文件中的变量中读取/获取此信息“L:”而不带引号

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-22T22:19:23.580

这是从任何驱动器获取 USB 驱动器号的方法。

```
@echo off

for /F "usebackq tokens=1,2,3,4 " %%i in (`wmic logicaldisk get caption^,description^,drivetype 

2^>NUL`) do (

if %%l equ 2 (
echo %%i is a USB drive.
)
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T09:15:24.010

`chdir`伪变量也可以使用任何输出`%CD%`。所以你已经有了一个包含该信息的变量。

否则，您可以使用`for`：

```
for /f "delims=" %%x in ('chdir') do set "drive=%%x" 
```

但我认为`%CD%`要容易得多:-)

**编辑：**你已经用引号说了。变量中不会有任何引号，除非您希望它们在其中。

至于尾随反斜杠：您可以使用以下内容代替`%CD%`：

```
%CD:~0,-1% 
```

这将扩展`%CD%`并删除最后一个字符，您知道它是反斜杠。

不过，仅当您位于该驱动器的根目录中时才有效。否则你也可以使用

```
for %%x in (%cd%) do @set drive=%%~dx 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-19T16:28:14.240

在您的批次中使用类似：

```
set Drive=%cd:~0,2% 
```

会产生**L:**的内容，如您所问，如果这是脚本所在的当前目录，则在您使用它时。如果批处理中有一些 popd/pushd、cd 等，请在使用时小心。剩下的由你决定

提供您将如何使用它（可能是您的批次的一部分）将有助于获得更好的答案。我们只能猜测。我认为，原因在于答案中的几个**for循环。**可能不需要，但我们在猜测。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-05-02T15:28:57.560

```
for %%a in (d e f g h i j k l m n o p q r s t u v w x y z) do vol %%a: 2>nul |find "NAME OF THE USB" >nul && 
set drv=%%a:
%drv% 
```

这是我用来在我的 USB 上找到字母的东西

*   只需将“USB 名称”更改为 USB 的名称

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-25T10:27:15.147

由于`cd`将输出如下内容：

```
c:\documents and settings\pax 
```

您只需要使用`"\"`作为分隔符的第一个字段，如下所示：

```
for /f "delims=\" %d in ('cd') do set curdrv=%d 
```

`curdrv`这将为`c:`上述输出设置环境变量。

如果在 cmd 文件中运行，请不要忘记使用双 % (%%d) 变体。

# c# - SQL Server 和消息队列

> ID：788558
> 
> 赞同：6
> 
> 时间：2009-04-25T08:51:38.903
> 
> 标签：c#, sql, sql-server

我正在尝试构建一个可靠的消息服务，或者至少我会这样描述它。

这是我的问题：我有一个表，我将数据插入到这个表中，我至少有两个从这个表中选择数据的应用程序。但是，我需要一种可靠的方法让两个不同的应用程序在任何给定时间都不会选择相同的行。

我将如何编写保证不会选择其他应用程序最近选择的相同行的事务或选择语句。

我不是 SQL Server 专家，但我希望有类似的东西。

从表中选择工作，这将使应用程序独占访问某些行。然后应用程序将处理这些行。一些行被删除，一些行返回到数据库。

我主要担心的是，如果应用程序无法完成其处理，SQL Server 最终会超时并将签出的数据返回到应用程序数据池。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-25T08:55:58.113

为每条记录添加一个“正在处理”标志，该标志以“原子”方式设置。

SO上有几个问题和许多答案，与此非常相似：

[如何在某些 SQL 行上运行进程时锁定它们？](https://stackoverflow.com/questions/46034/how-do-i-lock-certain-sql-rows-while-running-a-process-on-them)

[消息系统中针对表的队列](https://stackoverflow.com/questions/255794/queues-against-tables-in-messaging-systems)

[在 mysql 中实现消息队列表的最佳方法是什么](https://stackoverflow.com/questions/423111/whats-the-best-way-of-implementing-a-messaging-queue-table-in-mysql)

[从 SQL Server 向 MSMQ 发布消息](http://support.microsoft.com/kb/555070)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-10-05T07:08:57.140

this is quite an old question and probably the author's problem is long gone now but there's a little SQL trick that solves it and can be useful to others: the 'readpast' hint. With readpast sql select will skip locked rows in a query. What you want is to grab first unlocked row and immediately lock it so no one else will get it:

```
select top 1 * 
from messages with(readpast, updlock) 
order by id 
```

This will select and lock the first free message in the table and so no one else will be able to modify it. Actually I'm using the same approach in SQL-based message bus: [http://http://code.google.com/p/nginn-messagebus/](http://http://code.google.com/p/nginn-messagebus/) and it works very smoothly (sometimes faster than MSMQ)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-25T09:28:19.703

看看[SQL Server Service Broker](http://msdn.microsoft.com/en-us/library/bb522893.aspx)，它就是为这类问题而设计的。

如果需要队列，请使用队列。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-25T20:23:11.813

将“已抓取”列添加到消息表中。每个人都可以尝试用一条 SQL 语句来抓取一行：

```
UPDATE m
SET grabbed = 1
FROM messages m
WHERE id = @myid
and grabbed = 0 
```

After this, if @@ROWCOUNT is 1, the row is yours. Otherwise, somebody else grabbed the row before you.

SQL Server Broker or MSMQ or MQSeries introduce massive complexity and maintenance overhead. Be sure the operations guy that's receiving your stuff agrees before you start using it.

# active-directory - “Exchange Legacy Distinguished Name”和“Active Directory Distingushed Name”有什么区别？

> ID：788559
> 
> 赞同：4
> 
> 时间：2009-04-25T08:52:12.833
> 
> 标签：active-directory, exchange-server, dn

我对这两个术语有点困惑：“**传统专有名称**”（Legacy DN）和“**专有名称**”（DN）。

第一个术语***Legacy DN***似乎仅适用于 Exchange，而后一个***DN***仅用于 Active Directory。

它们显然不是相同的格式：

DN 就像：*CN=Morgan Cheng, OU= SomeOrg, DC=SomeCom, DC=com*

LegacyDN 就像：*/o=SomeDomain/ou=SomeGroup/cn=Recipients/cn=Morgan Cheng*

我仍然不清楚到底有什么区别。它们是完全不同的两种东西吗？或者只是以两种不同的形式表示的相同信息？

还有，为什么叫“**遗产**”？如果它是遗产，那么一定是新的，对吧？

希望一些AD和Exchang专家能给我一些意见。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T14:35:07.440

在 Exchange 5.5 中，Exchange 为帐户和邮箱分配了专有名称 (Obj-Dist-Name)。当 Active Directory 出现时，Exchange 2000 及更高版本将改用其专有名称。为了保持向后兼容性，从 Exchange 5.5 迁移到 Exchange 2000 会将旧 DN 转移到 ActiveDirectory 的 legacyExchangeDN 属性中。

一些应用程序继续引用 Obj-Dist-Name。为了保持与这些应用程序的兼容性，更高版本的 Exchange 会合成一个 legacyExchangeDN 值，即使对于尚未从 Exchange 5.5 迁移的对象也是如此。RUS 会自动将其设置为某个值，显然与您的情况下的 distinctName 值相同。

“新”方式（自 2000 年以来）是通过专有名称而不是 Obj-Dist-Name 来引用对象。

# sqlite - Sqlite3：插入时禁用主键索引？

> ID：788568
> 
> 赞同：14
> 
> 时间：2009-04-25T08:57:40.603
> 
> 标签：sqlite, indexing, insert, primary-key

我有一个 Sqlite3 数据库，其中包含一个表和一个由两个整数组成的主键，我正在尝试向其中插入大量数据（即大约 1GB 左右）

我遇到的问题是，创建主键还隐式创建了一个索引，在我的情况下，在几次提交后，它会使插入陷入困境（那是因为数据库文件在 NFS 上.. *sigh*）。

所以，我想以某种方式暂时禁用该索引。到目前为止，我最好的计划是删除主键的自动索引，但是 SQLite 似乎不喜欢它，如果我尝试这样做会引发错误。

我的第二个最佳计划是应用程序在网络驱动器上制作数据库的透明副本，进行修改然后将其合并回来。请注意，与大多数 SQlite/NFS 问题相反，我不需要访问并发。

做这样的事情的正确方法是什么？

**更新：**

我忘了指定我已经在使用的标志：

```
PRAGMA synchronous = OFF
PRAGMA journal_mode = OFF
PRAGMA locking_mode = EXCLUSIVE
PRAGMA temp_store = MEMORY 
```

**更新2：** 我实际上是分批插入项目，但是下一批的提交速度比前一批慢（我假设这与索引的大小有关）。我尝试批量处理 10k 到 50k 元组，每个元组是两个整数和一个浮点数。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-26T13:07:57.187

1.  您不能删除嵌入式索引，因为它是行的唯一地址。
2.  将您的 2 个整数键合并为单个长键 = (key1<<32) + key2; 并将其设置为 youd 模式中的 INTEGER PRIMARY KEY（在这种情况下，您将只有 1 个索引）
3.  为新数据库设置页面大小至少 4096
4.  删除除主索引之外的任何其他索引
5.  按 SORTED 顺序填写数据，使主键增长。
6.  重用命令，不要每次都从字符串创建
7.  将页面缓存大小设置为您剩余的内存（请记住，缓存大小是页数，而不是字节数）
8.  每 50000 个项目提交一次。
9.  如果您有其他索引 - 仅在表中所有数据之后创建它们

如果您能够合并密钥（我认为您使用的是 32 位，而 sqlite 使用的是 64 位，所以这是可能的）并按排序顺序填充数据我敢打赌您将填写您的第一个 Gb，其性能与第二个相同，并且两者都有会足够快。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-25T10:38:14.777

您是否将`INSERT`每个新的交易作为单独的交易进行？

如果您批量使用[`BEGIN TRANSACTION`](http://www.sqlite.org/lang_transaction.html)和`INSERT`行，那么我认为索引只会在每个事务结束时重建。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-25T10:56:35.733

请参阅[fast-bulk-inserts-in-sqlite3](https://stackoverflow.com/questions/364017/faster-bulk-inserts-in-sqlite3)。

# iphone - iphone中的RSA加密-解密

> ID：788569
> 
> 赞同：14
> 
> 时间：2009-04-25T08:59:27.947
> 
> 标签：iphone, cryptography, rsa, keychain

我正在开发 Iphone 应用程序。我使用了 Security/Security.h 框架的 SecKeyGeneratePair 方法。我将公钥和私钥作为 SecKeyRef 对象。我可以访问密钥或将其值打印到控制台吗？我可以从中获取 NSString 或 NSData 对象吗？当我使用 NSLog 打印控制台的密钥时，我得到了 . 我们可以通过网络将这些关键对象传递给可能在 java 中的其他应用程序吗？我们可以在 iphone 应用程序中加密一些文本，将其发送到服务器，使用发送的密钥解密服务器端的文本吗？

**编辑添加** 感谢 Alex Reynolds 的快速回复。在 RSA 加密的情况下，我必须首先生成一个密钥对，该密钥对采用 SecKeyRef 对象的形式。然后我们将该引用传递给 SecKeyEncrypt 和 SecKeyDecrypt 方法。当我在本地加密和解密时，它工作得很好，但是如果我尝试将密钥和加密数据发送到服务器并在服务器（java 实现）端解密，我无法将 SecKeyRef 对象作为密钥值传递给服务器。在java中，我们必须以字符串或字节数组格式获取字符串以传递给加密方法。我们可以访问存储在对象 SecKeyRef（即 NSCFType 对象）中的数据吗？这是一个结构 __SecKey。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-25T10:00:35.117

考虑使用 NSData 来获取字符串值，并且在通过网络传递时可能使用 Base64 或某种其他形式的编码（然后从 Base64 解码为 Java 中的任何内容）。

下面是一些可以帮助您入门的代码示例。我在这里做一个 HMAC-SHA1 签名（'digest'），但你的 RSA 案例的总体思路是相同的：

```
#import <Foundation/NSString.h>
#import <CommonCrypto/CommonHMAC.h>
#import <CommonCrypto/CommonDigest.h>

@interface NSString (NSStringAdditions)

+ (NSString *) base64StringFromData:(NSData *)data length:(int)length;
- (NSString *) base64StringWithHMACSHA1Digest:(NSString *)secretKey;

@end

-------------------------------------------

#import "NSStringAdditions.h"

static char base64EncodingTable[64] = {
  'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P',
  'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', 'a', 'b', 'c', 'd', 'e', 'f',
  'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v',
  'w', 'x', 'y', 'z', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '+', '/'
};

@implementation NSString (NSStringAdditions)

- (NSString *) base64StringWithHMACSHA1Digest:(NSString *)secretKey {
  unsigned char digest[CC_SHA1_DIGEST_LENGTH];
  char *keyCharPtr = strdup([secretKey UTF8String]);
  char *dataCharPtr = strdup([self UTF8String]);

  CCHmacContext hctx;
  CCHmacInit(&hctx, kCCHmacAlgSHA1, keyCharPtr, strlen(keyCharPtr));
  CCHmacUpdate(&hctx, dataCharPtr, strlen(dataCharPtr));
  CCHmacFinal(&hctx, digest);
  NSData *encryptedStringData = [NSData dataWithBytes:digest length:CC_SHA1_DIGEST_LENGTH];

  free(keyCharPtr);
  free(dataCharPtr);

  return [NSString base64StringFromData:encryptedStringData length:[encryptedStringData length]];
}

+ (NSString *) base64StringFromData: (NSData *)data length: (int)length {
  unsigned long ixtext, lentext;
  long ctremaining;
  unsigned char input[3], output[4];
  short i, charsonline = 0, ctcopy;
  const unsigned char *raw;
  NSMutableString *result;

  lentext = [data length]; 
  if (lentext < 1)
    return @"";
  result = [NSMutableString stringWithCapacity: lentext];
  raw = [data bytes];
  ixtext = 0; 

  while (true) {
    ctremaining = lentext - ixtext;
    if (ctremaining <= 0) 
       break;        
    for (i = 0; i < 3; i++) { 
       unsigned long ix = ixtext + i;
       if (ix < lentext)
          input[i] = raw[ix];
       else
          input[i] = 0;
    }
    output[0] = (input[0] & 0xFC) >> 2;
    output[1] = ((input[0] & 0x03) << 4) | ((input[1] & 0xF0) >> 4);
    output[2] = ((input[1] & 0x0F) << 2) | ((input[2] & 0xC0) >> 6);
    output[3] = input[2] & 0x3F;
    ctcopy = 4;

    switch (ctremaining) {
      case 1: 
         ctcopy = 2; 
         break;
      case 2: 
         ctcopy = 3; 
         break;
    }

    for (i = 0; i < ctcopy; i++)
       [result appendString: [NSString stringWithFormat: @"%c", base64EncodingTable[output[i]]]];

    for (i = ctcopy; i < 4; i++)
       [result appendString: @"="];

    ixtext += 3;
    charsonline += 4;

    if ((length > 0) && (charsonline >= length))
      charsonline = 0;

    return result;
 }

 @end 
```

# apache-flex - Flex 可折叠字段组控制

> ID：788575
> 
> 赞同：0
> 
> 时间：2009-04-25T09:07:17.990
> 
> 标签：apache-flex, controls, sidebar

我正在尝试在 Flex 应用程序中制作一个侧面板，该面板将包含选定对象的一堆属性。属性的数量可能会变得庞大，但它们都属于某些特定类别。

为此，我正在寻找一种类似于可折叠字段组的弹性控件。或者像一次可以有多个打开面板的手风琴。你知道，我在哪里可以得到一个？

**更新：**我想要以下页面上的第二个示例：http: [//extjs.com/deploy/dev/examples/form/dynamic.html](http://extjs.com/deploy/dev/examples/form/dynamic.html)

谢谢，阿尔特姆。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-08-02T22:40:15.470

[http://www.flexdownloads.com/#view=detail;vstr1=19](http://www.flexdownloads.com/#view=detail;vstr1=19)

就是你要找的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T09:54:36.317

在我看来，您正在寻找某种树组件。Flex 实际上有其中之一，您可能应该看看它。

这是查看 flex 中包含哪些控件的好链接[http://examples.adobe.com/flex3/componentexplorer/explorer.html](http://examples.adobe.com/flex3/componentexplorer/explorer.html)

# activerecord - 无法在 has_many 关系中定义 :joins 条件？

> ID：788582
> 
> 赞同：0
> 
> 时间：2009-04-25T09:13:03.110
> 
> 标签：activerecord, join, has-many, conditional-statements

我有一个关系表：

```
create_table "animal_friends", :force => true do |t|
    t.integer  "animal_id"
    t.integer  "animal_friend_id"
    t.datetime "created_at"
    t.datetime "updated_at"
    t.integer  "status_id",        :default => 1
  end 
```

将动物与其他动物联系起来。在 SQL 中检索关联的最佳方法是：

```
SELECT animals.* 
from animals join animal_friends as af 
  on animals.id = 
    case when af.animal_id = #{id} then af.animal_friend_id else af.animal_id end 
WHERE #{id} in (af.animal_id, af.animal_friend_id) 
```

而且我找不到用这个在rails中创建适当的has_many关系的方法。显然，没有办法为 has_many 提供加入条件。

我目前正在使用 finder_sql ：

```
has_many :friends, :class_name => "Animal", :finder_sql => 'SELECT animals.* from animals join animal_friends as af on animals.id = case when af.animal_id = #{id} then af.animal_friend_id else af.animal_id end ' +
 'WHERE #{id} in (af.animal_id, af.animal_friend_id) and status_id = #{Status::CONFIRMED.id}' 
```

但是这种方法有一个很大的缺点，就是打破了activerecord的魔法。例如 ：

```
@animal.friends.first 
```

将无限制地执行finder_sql，获取数千行，然后获取数组的第一个（并失去几个宝贵的*秒*/请求）。

我想这是 AR 中缺少的功能，但我想先确定一下 :) 谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-26T06:11:31.580

您可以使用视图在数据库级别解决此问题，无论如何这都是正确的方法。

```
CREATE VIEW with_inverse_animal_friends (
  SELECT id,
         animal_id,
         animal_friend_id,
         created_at,
         updated_at,
         status_id
    FROM animal_friends
   UNION
  SELECT id,
         animal_friend_id AS animal_id,
         animal_id AS animal_friend_id,
         created_at,
         updated_at,
         status_id
    FROM animal_friends
) 
```

如果您不想让有两种关系的朋友重复输入，您可以这样做：

```
CREATE VIEW unique_animal_friends (
  SELECT MIN(id), animal_id, animal_friend_id, MIN(created_at), MAX(updated_at), MIN(status_id)
    FROM
   (SELECT id,
           animal_id,
           animal_friend_id,
           created_at,
           updated_at,
           status_id
      FROM animal_friends
     UNION
    SELECT id,
           animal_friend_id AS animal_id,
           animal_id AS animal_friend_id,
           created_at,
           updated_at,
           status_id
      FROM animal_friends) AS all_animal_friends
  GROUP BY animal_id, animal_friend_id
) 
```

如果有两个冲突的状态，您将需要一种方法来决定使用哪个 status_id。我选择了 MIN(status_id) 但这可能不是你想要的。

在 Rails 中，您现在可以这样做：

```
class Animal < ActiveRecord::Base
  has_many :unique_animal_friends
  has_many :friends, :through => :unique_animal_friends
end

class UniqueAnimalFriend < ActiveRecord::Base
  belongs_to :animal
  belongs_to :friend, :class_name => "Animal"
end 
```

这是我的想法，没有经过测试。此外，您可能需要一些插件来处理 rails 中的视图（例如“redhillonrails-core”）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-26T18:00:02.777

有一个插件可以满足您的需求。

[这里](http://www.dweebd.com/ruby/has_many-with-arguments/)有一篇关于它的帖子。

[这里](http://alexle.net/archives/235)有一个替代方案。

两者都允许您执行加入条件并且只是使用延迟初始化。所以你可以使用动态条件。我觉得前者更漂亮，但如果您不想安装插件，可以使用后者。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-25T12:04:40.920

在活动记录中创建多对多关系的两种方法是 has_and_belongs_to_many 和 has_many :through。 [该网站](http://blog.hasmanythrough.com/2006/4/20/many-to-many-dance-off)批评了两者之间的差异。您不必使用这些方法编写任何 SQL。

# iphone - 单击按钮并加载导航控制器

> ID：788590
> 
> 赞同：4
> 
> 时间：2009-04-25T09:17:09.060
> 
> 标签：iphone, button, uinavigationcontroller

一个非常简单的问题：我的 iPhone 应用程序在 MainWindow.xib 中有一个按钮。当我按下该按钮时，应该加载一个新视图。该视图将包含一个不错的导航控制器。我怎样才能做到这一点？

我找到的所有信息都是关于直接从导航控制器启动的应用程序。单击按钮后，我需要加载导航控制器。

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T09:24:01.710

另一种解决方法是简单地将导航栏隐藏在根控制器中：

```
- (void) viewDidLoad {
  ...
  if (![self.navigationController isNavigationBarHidden])
    [self.navigationController setNavigationBarHidden:YES animated:NO];
  ...
} 
```

这样，你就有了一个漂亮、干净的根控制器，没有导航栏。

当您单击根控制器中的按钮时，您只需推入一个新视图并取消隐藏导航栏：

```
- (IBAction) pushAnotherView:(id)sender {
  AnotherViewController *anotherViewController = [[AnotherViewController alloc] initWithNibName:@"AnotherViewController" bundle:nil];
  [self.navigationController pushViewController:anotherViewController animated:YES];
  if ([self.navigationController isNavigationBarHidden])
    [self.navigationController setNavigationBarHidden:NO animated:YES];
  [anotherViewController release];
} 
```

如果您有一些通知或其他操作将您带回根视图控制器，只需再次隐藏通知栏：

```
- (void) viewWillAppear:(BOOL)animated {
  if (![self.navigationController isNavigationBarHidden])
    [self.navigationController setNavigationBarHidden:YES animated:YES];
  [super viewWillAppear:animated];
} 
```

# asp.net - LINQ 和 dbml 文件

> ID：788591
> 
> 赞同：0
> 
> 时间：2009-04-25T09:18:44.687
> 
> 标签：asp.net, linq

与 LINQ 和 dbml 文件有什么关系吗？有人说在项目中使用 Linq。实际上，该项目包含一个 dbml 文件，在那个 .cs 文件中，一个 dbml.layout 和设计器生成的代码。实际上符号类似于

```
var numQuery =
            from num in numbers
            where (num % 2) == 0
            select num; 
```

我在这个项目中没有找到任何类似的语法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T09:25:30.273

DBML 文件代表 LINQ to SQL 项目的数据模型 - 它用于为各种实体生成 C# 代码。

您提供的代码是一个 LINQ*查询*。我当然希望在使用 DBML 文件的应用程序中看到 LINQ 查询，但它们略有不同。特别是，我不希望在 DBML 文件本身或从它生成的 C# 代码中看到查询。查询将在*使用*这些实体的代码中。

# php - 从 Zend Framework 应用程序向数百个收件人发送电子邮件的最佳方法是什么？

> ID：788596
> 
> 赞同：16
> 
> 时间：2009-04-25T09:22:57.313
> 
> 标签：php, email, zend-framework, smtp, mailing-list

我正在尝试为我的应用程序实现一个邮件列表系统。我目前正在使用它作为我的交通工具，循环浏览我的订阅者列表，并向每个`Zend_Mail_Transport_Smtp('localhost')`订阅者发送一个新的。`Zend_Mail`但是，我注意到脚本完成所需的时间会随着订阅者数量的增加而增加。

我确信必须有更专业的方法来做到这一点，包括电子邮件排队。我想理想的方法是让用户填写表格，点击发送，然后立即得到回复说正在发送电子邮件，而不是等待数百封电子邮件完成发送。

我知道这`Zend_Mail`不会进行任何排序邮件排队。有这方面经验的人可以给我概述一下如何做到这一点吗？我对cron/crontab/cronjobs一无所知，所以如果涉及到，请解释一下过程。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-25T14:21:03.557

*注意：当我第一次阅读您的问题时，我以为它一次会说数十万封电子邮件。当我仔细检查时，我注意到它实际上说的是数百到数千。我现在懒得更改我的帖子，所以这里有一些警告：根据我的经验，你可能可以在没有商业工具的情况下正常运行到 40K 左右。在大约 10K 时，您将希望遵循“最小”列表，以防止当您开始达到更大的列表大小时出现重大痛苦。我确实建议立即实施它。*

我之前说过，发送电子邮件有两个方面：

1.  技术方面——基本上所有关于 smtp 协议、电子邮件格式、DNS 记录等的 RFC。这有点复杂但可以解决。
2.  神奇的一面——电子邮件传递管理是巫术。你会感到沮丧，事情会无缘无故地中断，你会考虑离开另一份不涉及电子邮件的工作。

我建议不要编写自己的批量发件人。我确信 PHP 可以做得很好，但您可能应该把时间花在其他地方。我过去使用并推荐的两个产品是 Strongmail 和 PowerMTA。请注意——它们的价格很高，但我几乎可以保证，从长远来看，你会花更多的钱来构建自己的解决方案。

在 PHP 中编写自己的代码时会遇到的一个问题是节流/焦油点蚀。在您发送一些消息以减慢您的速度并阻止您发送垃圾邮件后，邮件服务器将开始添加 sleep(30)。

通常，这些商业批量发件人运行 SMTP 协议进行排队。您将继续使用 Zend_Mail，但对其进行硬编码以连接到您的服务器。它会尽可能快地将邮件排队，然后使用它自己的引擎将邮件发送到他们的目的地。

在 100K 列表中，您将不得不采用电子邮件最佳实践。至少，您需要：

*   SPF 记录，也可能是 DKIM
*   用于分段流量的多个 IP — 有 3 个 IP，一个用于您信任的质量地址，一个用于中等风险 IP 地址，一个用于高风险 IP 地址。这种设计有助于最大程度地降低将邮件发送给最佳客户的风险。
*   用于发送 IP 地址的正确反向 DNS
*   使用来自 AOL、hotmail、yahoo 和其他公司的反馈循环来处理垃圾邮件投诉
*   退订和退回管理 - 确保您正在修剪这些地址
*   打开/点击跟踪也很重要——如果您是 A 列表上的客户没有打开您的电子邮件，您需要将它们降级到 B 列表等等。这很重要，因为 ISP 会将不活动的帐户变成蜜罐。Hotmail 以此而闻名。

最后，如果您真的很想发送电子邮件，您将需要一些其他工具，例如 Return Path。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-05-07T02:36:36.253

为了使用 PHP 可靠地发送大量电子邮件，您必须使用排队机制。正如其他人所建议的，使用队列的过程如下所示：

*   遍历您的一组用户，为每个用户创建一封电子邮件，并可能自定义内容
*   将每个邮件对象传递给队列，这将延迟发送电子邮件直到稍后
*   在某种 cron 脚本中，一次发送几百个队列的内容。*注意：您需要通过查看日志来调整您发送的电子邮件数量，以了解实际发送过程中返回的错误。如果您尝试发送太多，我注意到它达到了邮件传输将不再接受连接的地步（我正在使用 qmail）*

您可以使用一些库来执行此操作，[PEAR Mail Queue](http://pear.php.net/package/Mail_Queue/)（带有 Mail_Mime）和 SwiftMailer 都允许您创建和排队电子邮件。到目前为止，Zend Mail 只提供电子邮件的创建，而不是排队（稍后会详细介绍）。

我主要有使用[PEAR Mail Queue](http://pear.php.net/package/Mail_Queue/)的经验，并且有一些问题。如果您尝试将大量电子邮件排队（例如，循环超过 20,000 个用户并尝试在合理的时间内让他们进入队列），则使用 Mail Mime 的引用打印编码实现非常慢。您可以通过切换到 base64 编码来加快速度。

至于 Zend Mail，您可以编写一个 Zend Mail Transport 对象，将您的 Zend Mail 对象放入 PEAR 邮件队列。我已经成功地做到了这一点，但是需要花点时间才能做到这一点。为此，扩展 Zend Mail Transport Abstract，实现 _sendMail 方法（您将在此将 Zend Mail 对象放入邮件队列）并将传输对象的实例传递给 Zend Mail 对象的 send() 方法或通过 Zend Mail::setDefaultTransport()。

最重要的是，您可以通过多种方式做到这一点，但这需要代表您进行一些研究和学习。然而，这是一个非常可以解决的问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-25T12:29:59.220

来自 PHP.net 文档。

> 注意：值得注意的是，mail() 函数不适合循环处理大量电子邮件。此函数为每封电子邮件打开和关闭一个 SMTP 套接字，效率不高。
> 对于发送大量电子邮件，请参阅 » [PEAR::Mail](http://pear.php.net/package/Mail)和 » [PEAR::Mail_Queue](http://pear.php.net/package/Mail_Queue)包。

Zend Mail 类可能非常好（Zend 的大部分东西都很好）但是如果你想要其他选择。他们来了。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-05-26T00:07:49.063

使用 Zend_Queue 将电子邮件放入队列中以进行异步后台处理。您将需要一个 cron 作业来在后台处理队列。

```
protected function _enqueueEmail(WikiEmailArticle $email)
{
    static $intialized = false; 

    if (!$initialized) {

        $this->_initializeMailQueue("wikiappwork_queue");
        $initialized = true;
    }

    $this->_mailQueue->send(serialize($email));  
}
protected function _initializeMailQueue()
{
    /* See: 1.) http://framework.zend.com/manual/en/zend.queue.adapters.html and
     *      2.) Zend/Queue/Adapter/Db/mysql.sql. 
     */

 $ini = Zend_Controller_Front::getInstance()->getParam('bootstrap')
                                            ->getOptions(); 

     $queueAdapterOptions =    array( 'driverOptions' => array(
    'host' => $ini['resources']['multidb']['zqueue']['host'],
    'username' => $ini['resources']['multidb']['zqueue']['username'],
    'password' => $ini['resources']['multidb']['zqueue']['password'],
    'dbname' => $ini['resources']['multidb']['zqueue']['dbname'],
    'type' => $ini['resources']['multidb']['zqueue']['adapter'] ),
    'name' => $ini['resources']['multidb']['zqueue']['queueName'] );

    $this->_mailQueue = new Zend_Queue('Db', $queueAdapterOptions);

 } 
```

然后对于 cron 作业，像这样的脚本

```
<?php
use \Wiki\Email\WikiEmailArticle;

// Change this define to correspond to the location of the wikiapp.work/libary
define('APPLICATION_PATH', '/home/kurt/public_html/wikiapp.work/application');

set_include_path(implode(PATH_SEPARATOR, array(
     APPLICATION_PATH . '/../library',
     get_include_path(),
 )));

// autoloader (uses closure) for loading both WikiXXX classes and Zend_ classes.
spl_autoload_register(function ($className) { 

  // Zend classes need underscore converted to PATH_SEPARATOR
  if (strpos($className, 'Zend_' ) === 0) {

        $className = str_replace('_', '/', $className );   
  }

  $file = str_replace('\\', '/', $className . '.php');

  // search include path for the file.
  $include_dirs = explode(PATH_SEPARATOR, get_include_path());

  foreach($include_dirs as $dir) {

    $full_file = $dir . '/'. $file;

    if (file_exists($full_file)) { 

        require_once $full_file; 
        return true; 
    }
  }

  return false; 
 }); 

// Load and parese ini file, grabing sections we need.
$ini = new Zend_Config_Ini(APPLICATION_PATH . 
                          '/configs/application.ini', 'production');

$queue_config = $ini->resources->multidb->zqueue;

$smtp_config = $ini->email->smtp;

$queueAdapterOptions =  array( 'driverOptions' => array(
                                        'host'      => $queue_config->host,
                    'username'  => $queue_config->username,
                    'password'  => $queue_config->password,
                    'dbname'    => $queue_config->dbname,
                    'type'      => $queue_config->adapter),
                'name' => $queue_config->queuename);

$queue = new Zend_Queue('Db', $queueAdapterOptions);

$smtp = new Zend_Mail_Transport_Smtp($smtp_config->server, array(
                'auth'      => $smtp_config->auth,
        'username'  => $smtp_config->username,
        'password'  => $smtp_config->password,
        'port'      => $smtp_config->port,
        'ssl'       => $smtp_config->ssl
        ));

Zend_Mail::setDefaultTransport($smtp);

$messages = $queue->receive(10); 

foreach($messages as $message) {

        // new WikiEmailArticle.     
    $email = unserialize($message->body);

        try {

            $email->send();

        }  catch(Zend_Mail_Exception $e) {

               // Log the error?
               $msg = $e->getMessage();
               $str = $e->__toString();
               $trace =  preg_replace('/(\d\d?\.)/', '\1\r', $str);
        } // end try

$queue->deleteMessage($message);

} // end foreach 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-25T12:49:58.923

尽管像其他人所指出的那样避免使用 mail() ，但您应该可以将 PHP 用于数千个收件人。我已经看到一些为大量邮件（超过 100,000 个收件人）设计的系统开始绕过标准邮件功能并尝试更直接地使用 MTA。即使那样，我也不清楚这是必需的。

使电子邮件专业化更多的是确保格式良好（尽可能使用 HTML 和纯文本），人们可以轻松取消订阅，正确处理退回邮件，邮件服务器具有所有正确的 DNS 记录，并且服务器配置没有t 违反任何主要黑名单系统的规则。在数百甚至数千条消息中，您编写应用程序所用的语言并不是主要因素。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-25T18:37:10.867

我在 php 中实现了一个批量邮件程序，其中每封电子邮件都是针对个人定制的。这并不难，也不需要太长时间。我使用[了 swiftmailer](http://swiftmailer.org)和 cron。Zend Mail 也可能没问题。我从 PEAR 邮件队列开始，但邮件排队太慢了。

排队邮件的过程是这样的：

1.  创建电子邮件模板并为将替换独特内容的区域添加占位符（或使用模板引擎）。
2.  在一个循环中，用任何唯一内容替换占位符，将生成的电子邮件内容、主题、地址、批次 ID 和可选的优先级值插入到数据库表中。

我使用 cron 作业来发送批量电子邮件。cron 时间间隔和每批发送的电子邮件数量很重要，因为我在一个有限制的共享主机上。cron 作业调用的脚本只能由 cron 访问。该脚本从按批次 ID 排序的表中读取 x 封电子邮件，并且可以选择优先级。如果成功发送电子邮件，则将其从数据库队列中删除。如果无法发送电子邮件，它将保留在队列中，并为该记录增加一个计数器。如果计数器超过设定的数字，则该电子邮件将从队列中删除。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-25T09:47:41.420

Zend Mail 类看起来不错，而且使用简单，它还允许您发送纯文本和 HTML 版本的电子邮件，这在电子邮件营销中非常重要。

如果您熟悉框架工作，我会坚持使用它。

向大量人员发送电子邮件时要考虑的重要事项是：

*   您的网络服务器能否在打开电子邮件时处理图像请求 + 访问您网站的人在服务器上的负载。

如果答案是否定的或您不确定，那么使用 apache benchmark 应该可以帮助您解决问题。如果您仍然不确定，最好批量发送电子邮件（可以使用 crontab 定时）以分散负载。

我希望这有帮助。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-26T00:57:45.163

我用[**Swiftmailer**](http://swiftmailer.org/)开发了一个时事通讯管理系统，它很容易实现。它支持SMTP，加密，附件，批量发送，...

# development-environment - 使用 Mini/Parallels 虚拟环境进行开发？

> ID：788597
> 
> 赞同：0
> 
> 时间：2009-04-25T09:23:10.060
> 
> 标签：development-environment, virtualization

我运行 Vista Business 的主要 Windows 开发 PC 运行时间有点长，我正在考虑更换。它是带有 24" 和 19" 显示器的双屏幕设置。我的笔记本电脑是相当新的 Macbook，我使用 Parallels 在其上安装 Virtual XP 系统已经有一段时间了，给我留下了深刻的印象。

新的 Mac Mini 似乎支持双屏，我想知道用完全规格的（4Gb 内存，2.3Ghz 处理器）Mac mini 替换 PC 盒并安装 Parallels VM 环境进行开发。从表面上看，这有很多吸引人的地方——清洁的开发环境等，但我很感激任何采取类似方法的人的建议——它对于一般的日常开发工作是否可行且足够强大？

我的具体开发要求是我所有的客户主要是基于 PC 的，而且我的三分之二以上的开发工作现在都是基于 Web 的。不过，我确实有几个旧版 Delphi 6 系统（我正在考虑升级 Delphi 2009）和一个 .Net 1.1 Windows Mobile 应用程序。我也有相当多的 Access/SQL Server 应用程序我需要照顾，所有这些通常直接在客户端计算机上编码，并且很少需要在本地复制，但它会很有用。未来还有基于 Win32 的开发的可能性，我倾向于使用 3D 和 OpenGL 技术做很多事情。对于非编码应用程序，我也经常在 PC 上运行和使用 Maya 和 Photoshop。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-19T05:19:23.533

几个月前我买了一台铝制 MacBook，为了有 4 个演出而获得了额外的内存，我已经使用 VMWare Fusion 成功地虚拟化了具有 3D 加速功能的 Windows XP。我目前正在使用 PHP 和 Javascript 开发 Web 应用程序，其他一些使用 Java 的项目并在 XNA 3.1 上玩了一下，都在我的 MacBook 上。所以，如果这对我有用，它也对你有用！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T09:42:48.420

您可能不想通过 Parallels 的模拟视频适配器进行大量图形工作。

# asp.net-mvc - asp.net-mvc 中的 FCKEditor

> ID：788601
> 
> 赞同：3
> 
> 时间：2009-04-25T09:25:00.163
> 
> 标签：asp.net-mvc, fckeditor

如何在 MVC 应用程序中添加 FCKEditor？

如何在 FCKEditor 中显示模型中的数据库值？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-27T04:36:46.860

那个 CodeProject 网站并不理想。它要求你做很多不必要的代码。您真正需要做的就是包含正确的 javascript 文件：

然后，在页面中，以任意数量的不同方式呈现 FCKEditor。我更喜欢替换文本区域：

```
window.onload = function()
{
    var oFCKeditor = new FCKeditor( 'content' ) ;
    oFCKeditor.ReplaceTextarea() ;
} 
```

此时，编辑器应该可以正常加载。您可能需要编辑 fckeditor 配置文件以获得所需的标准化行为。然而，在这一点上，一切都应该正常工作。您的 FCKEditor 实例的行为就像另一个表单字段，当您在服务器端从它获取值时，您可以这样对待它。

创建服务器端 api 以供它使用也非常容易。我创建了一个fckeditor控件，你只需要实现GetFolders、GetFoldersAndFiles和GetFiles。这些只需要几行代码，就可以为您提供几乎所有需要的功能。

我认为使用 MVC 集成/自定义 fckeditor 比在经典 ASP.NET 上更容易。

# css - 我正在尝试创建一个具有 div 和 css 样式的网站，我想要做的是将 2 个部门放在另一个之上，但居中于页面中间，因此顶部框将被称为容器，底部框将被称为快速链接 我试图实现的一个示例是http://www.whirlpool.net.au/ 所以我有两个 di 问问题 paul 问问题 2009-04-25T09:44:05.657 497 次 This question shows research effort; it is useful and clear 1 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 我正在尝试创建一个具有 div 和 css 样式的网站，我想要做的是将 2 个部门放在另一个之上，但居中于页面中间，因此顶部框将被称为容器，底部框将被称为快速链接 我试图实现的一个示例是http://www.whirlpool.net.au/ 所以我有两个 div 框顶部容器将包含所有页面信息，底部将具有外部样式以使编辑链接更容易因为它将被放置在网站的每个页面上，但我不确定是否可以这样？ 两个 div 的宽度都为 900px，容器的高度为 0 auto；所以它随着放置在里面的内容而增长。快速链接 div 的高度为 60 像素，并且当里面的内容增长或缩小时，显然会在容器框下的页面上下移动。 我用过 <stlye type="text/css"> .container{<br> position:absolute: <br> left: 50%;<br> width: 900px;<br> height: 0 auto;<br> top: 0%;<br> margin-left: -450px;<br> } .quicklinks{<br> position:static; <br> left: 50%;<br> width: 900px; <br> height: 60px; <br> margin-left: -450px; <br> } </style> </head> <body> <div class="container"></div><br> <div class"quicklinks"></div><br> </div> </body> <br> </html> 上面的代码会将容器框带到页面的最中心，但快速链接 div 将位于其顶部，我需要它位于其下方。 <stlye type="text/css"> .container{<br> width: 900px;<br> height: 0 auto;<br> top: 0%;<br> } .quicklinks{<br> position:static; <br> width: 900px; <br> height: 60px; <br> } </style> </head> <body> <div class="container"></div><br> <div class"quicklinks"></div><br> </div> </body> <br> </html> 上面的这段代码会将快速链接 div 带到容器下方，但两者都将位于左上角，我可以让它看起来像它在中心，但我希望它能够在每个浏览器中找到中心。 所以有人可以帮忙吗？ 我是否使用正确的脚本编写方式来实现这一目标，如果是这样 我错过了什么来纠正这个问题？ 干杯保罗 为 innerHTML 设置大值时提高性能的方法 我正在尝试对节点的 innerHTML 设置一个巨大的（200K）响应。目标是在 Internet Explorer 6 中获得比 2.7 秒更好的时间。 有任何想法吗？ csslayouthtml 4 3 回答 3 This answer is useful 2 我使用了您的最佳示例并正确拼写了样式，并还分配了类快速链接。 然后 margin:auto 对两个 div 都有效。我还删除了位置：静态，认为不需要它。 .container{ width: 900px; height: 0 auto; top: 0%; margin: auto; } .quicklinks{ width: 900px; height: 60px; margin: auto; } 菲尔 于 2009-04-25T10:09:54.940 回答 This answer is useful 1 这是一个相当简单的任务，您需要做的就是设置 margin:0 auto; 对于两个 div，这将使它们都居中。 下面的代码示例是一个非常简单的示例。 <style> .box {width:900px; margin:10px auto; padding:10px; border:5px solid #000;} </style> <div class="box">Top Box</div> <div class="box">Bottom Box</div> 实现此目的的更好方法是使用包含 DIV 来固定宽度和中心 <style> .container {width:900px; margin:0 auto; padding:10px; border:5px solid #99cc00; } .box {margin-top:10px; padding:10px; border:5px solid #000;} </style> <div class="container"> <div class="box">Top Box</div> <div class="box">Bottom Box</div> </div> 于 2009-04-25T17:10:08.597 回答 This answer is useful 1 为了达到这个效果，你需要这样的东西 body {text-align:center;} #wrapper {margin-left:auto;margin-right:auto; text-align:left;width:900px;} #container{} #quicklinks{} <div id="wrapper"> <div id="container"> </div> <div id="quicklinks"> </div> </div> 一旦您确定了页面宽度并使用包装器居中，div 的默认行为是显示在另一个之下。 于 2009-04-25T10:08:35.940 回答 Related 1 python - learnpython.org 模块练习 2 ms-word - 使用 OpenXml 替换 Word 中的书签内容 1 ruby - 如何在 irb 上使用特定的 gem 版本？ 1 java - 在远程系统上运行 ant 构建文件 3 php - Warning: mysql_connect(): Access denied 1 matlab - 在一个向量中查找相同日期的块，并对另一个向量中的相应数据块进行平均 1 excel - 在excel中使用连接和解码 1 r - R tm stemCompletion 生成 NA 值 1 javascript - 如何检测 iframe 内容元素的加载请求？ 0 android - dlopen .so 库与 jni，ndk 在 android 项目中 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：788613
> 
> 赞同：1
> 
> 时间：
> 
> 标签：css, layout, html

我正在尝试创建一个具有 div 和 css 样式的网站，我想要做的是将 2 个部门放在另一个之上，但居中于页面中间，因此顶部框将被称为容器，底部框将被称为快速链接

我试图实现的一个示例是[http://www.whirlpool.net.au/](http://www.whirlpool.net.au/) 所以我有两个 div 框顶部容器将包含所有页面信息，底部将具有外部样式以使编辑链接更容易因为它将被放置在网站的每个页面上，但我不确定是否可以这样？

两个 div 的宽度都为 900px，容器的高度为 0 auto；所以它随着放置在里面的内容而增长。快速链接 div 的高度为 60 像素，并且当里面的内容增长或缩小时，显然会在容器框下的页面上下移动。

我用过

```
<stlye type="text/css">

.container{<br>
position:absolute: <br>
left: 50%;<br>
width: 900px;<br>
height: 0 auto;<br>
top: 0%;<br>
margin-left: -450px;<br>
}

.quicklinks{<br>
position:static; <br>
left: 50%;<br>
width: 900px; <br>
height: 60px; <br>
margin-left: -450px; <br>
}
</style>

</head>

<body>

<div class="container"></div><br>
<div class"quicklinks"></div><br>
</div>

</body> <br>
</html> 
```

上面的代码会将容器框带到页面的最中心，但快速链接 div 将位于其顶部，我需要它位于其下方。

```
<stlye type="text/css">

.container{<br>
width: 900px;<br>
height: 0 auto;<br>
top: 0%;<br>
}

.quicklinks{<br>
position:static; <br>
width: 900px; <br>
height: 60px; <br>
}
</style>

</head>

<body>

<div class="container"></div><br>
<div class"quicklinks"></div><br>
</div>

</body> <br>
</html> 
```

上面的这段代码会将快速链接 div 带到容器下方，但两者都将位于左上角，我可以让它看起来像它在中心，但我希望它能够在每个浏览器中找到中心。

所以有人可以帮忙吗？

1.  我是否使用正确的脚本编写方式来实现这一目标，如果是这样
2.  我错过了什么来纠正这个问题？

干杯保罗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T10:09:54.940

我使用了您的最佳示例并正确拼写了样式，并还分配了类快速链接。

然后 margin:auto 对两个 div 都有效。我还删除了位置：静态，认为不需要它。

```
.container{
  width: 900px;
  height: 0 auto;
  top: 0%;
  margin: auto;
}

.quicklinks{
  width: 900px; 
  height: 60px; 
  margin: auto; 
} 
```

菲尔

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T17:10:08.597

这是一个相当简单的任务，您需要做的就是设置 margin:0 auto; 对于两个 div，这将使它们都居中。

下面的代码示例是一个非常简单的示例。

```
<style>
    .box {width:900px; margin:10px auto; padding:10px; border:5px solid #000;}
</style>

<div class="box">Top Box</div>
<div class="box">Bottom Box</div> 
```

实现此目的的更好方法是使用包含 DIV 来固定宽度和中心

```
<style>
    .container {width:900px; margin:0 auto; padding:10px; border:5px solid #99cc00; }
    .box {margin-top:10px; padding:10px; border:5px solid #000;}
</style>
<div class="container">
    <div class="box">Top Box</div>
    <div class="box">Bottom Box</div>
</div> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-25T10:08:35.940

为了达到这个效果，你需要这样的东西

```
body {text-align:center;}
#wrapper {margin-left:auto;margin-right:auto; text-align:left;width:900px;}
#container{}
#quicklinks{}

<div id="wrapper">
  <div id="container">
  </div>
  <div id="quicklinks">
  </div>
</div> 
```

一旦您确定了页面宽度并使用包装器居中，div 的默认行为是显示在另一个之下。

# javascript - 为 innerHTML 设置大值时提高性能的方法

> ID：788614
> 
> 赞同：11
> 
> 时间：2009-04-25T09:44:15.767
> 
> 标签：javascript, html, performance, dom

我正在尝试对节点的 innerHTML 设置一个巨大的（200K）响应。目标是在 Internet Explorer 6 中获得比 2.7 秒更好的时间。

有任何想法吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-25T10:28:57.250

这不会让它更快地发生，但它会阻止浏览器锁定用户；当这种情况发生在后台时，他们可以继续使用该页面：

```
function asyncInnerHTML(HTML, callback) {
    var temp = document.createElement('div'),
        frag = document.createDocumentFragment();
    temp.innerHTML = HTML;
    (function(){
        if(temp.firstChild){
            frag.appendChild(temp.firstChild);
            setTimeout(arguments.callee, 0);
        } else {
            callback(frag);
        }
    })();
} 
```

使用它：

```
var allTheHTML = '<div><a href="#">.............</div>';
asyncInnerHTML(allTheHTML, function(fragment){
    myTarget.appendChild(fragment); // myTarget should be an element node.
}); 
```

这种技术将比普通技术花费更长的时间，**`innerHTML`**但用户将能够继续使用您的网站而不会注意到延迟。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-25T11:48:36.717

首先，我会确保您的 HTML 尽可能简单。尽可能少的结构标记。到处使用 CSS，包括它的级联特性，这样你就不会到处设置类属性等等。

然后尝试对每个浏览器的最佳方法进行一些进一步的研究。例如，有些通过构建 DOM 对象做得更好，有些将其全部设置为单个非树 DOM 节点的 innerHTML，然后将其添加到树中，等等。我建议您阅读[Quirksmode.org 的 Benchmark - W3C DOM vs. innerHTML](http://www.quirksmode.org/dom/innerhtml.html) .

您还可能希望使用 JimmyP 建议的脚本来添加块，因此浏览器 UI 似乎不会挂起。虽然，您不希望将其拆分太多，否则当您不需要它们时，您将不必要地触发过多的页面刷新。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-25T15:39:11.933

为什么不将响应带入 json 格式并在客户端进行处理，例如[，](http://www.olx.com/cars-cat-378)每次更改任何导航选项时都会驱动大量数据，并且所有行都由客户端呈现。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-25T12:02:21.720

使用大型 HTML 有效负载时，您将面临 IE 6 中“操作中止”错误的风险。花一些时间查看以下 StackOverflow 问题，因为该错误是由使用 innerHTML 更新 DOM 引起的，并且迄今为止，MS 还没有完整的修复到位：

[为什么 Asp.net 在 ie7 中会导致操作中止错误？](https://stackoverflow.com/questions/266585/why-does-asp-net-cause-the-operation-aborted-error-in-ie7)

[从脚本动态将DIV附加到正文时如何克服IE Bug？](https://stackoverflow.com/questions/551511/how-to-overcome-ie-bug-when-dynamically-attaching-div-to-body-from-script)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-25T15:31:34.213

使 HTML 尽可能简单，或者使用尽可能短的元素/属性名称的 XML。

带有 CSS 的样式（不要将 XML 与 XSLT 一起使用，这最终可能会导致解析/构建速度更慢）。

不幸的是，不同浏览器对 XML 的处理是不兼容的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-25T19:00:43.430

确保您的 JSON/HTML/纯文本尽可能简单。最简单的解决方案是减少工作量，但如果您确实需要流式传输 200k，请确保对浏览器的传输进行压缩，这应该可以在您的应用程序和/或 Web 服务器中进行配置。Gzip'ping 内容（假设您使用的是对 AJAX 友好的服务）确实有帮助，尤其是对于简单的文本。

看看其他可以简化的循环等，但听起来确保数据准备就绪并确保数据可以有效地通过线路发送将是最大的帮助。

如果 IE 是异常值并且所有其他浏览器都运行良好，您可能需要继续前进。你能做的只有这么多，但我怀疑这不是主要问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-25T09:54:41.123

我听说这`innerText`比 IE 快两倍`innerHTML`。虽然不确定是否属实，但可能值得一试。

```
if (window.ActiveXObject) { // we're using IE
    document.getElementById('myElement').innerText = 'Bla bla bla bla';
    // or create a textnode:
    var txt = document.createTextNode('Lorem ipsum');
    document.getElementById('myElement').appendChild(txt);
} else {
    // other code here
} 
```

**更新**：请注意，如果您想修改 的 HTML `myElement`，请不要使用`innerText`- HTML 将以纯文本形式显示，就像您使用`&lt;`and一样`&gt;`。

# struts2 - 如何将链接作为附加列放在显示标签中以将其重定向到struts2的动作类

> ID：788617
> 
> 赞同：1
> 
> 时间：2009-04-25T09:51:35.297
> 
> 标签：struts2

我正在通过显示标签显示对象详细信息。现在我想要一个页面中的链接，用户可以通过该链接删除或编辑该特定记录，所以我想要一个以对象 id 作为值并将其传递给操作类的链接。或任何其他方式，以便我可以删除或编辑特定记录提前谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-05-25T06:37:13.593

```
<display:table name="sessionScope.searchResults"
    cellpadding="1" uid="sr" pagesize="50" cellspacing="1" size="50"
    defaultorder="ascending" sort="list" style="width:850"
     id="row">
    <display:column media="html"
    title="Delete"
    style="text-align:center">
    <s:url id="deleteUrl" action="deleteLink.action">
    <s:param name="objectId" value="#attr.row.OBJECT_ID" />
    </s:url>
    <s:a href="%{deleteUrl}">
         Delete
    </s:a>
</display:column>

</display:table> 
```

**OBJECT_ID**是当前行对象的 ID，将 id 发送到您的操作类加载带有 id 的对象并执行您想做的任何事情。

您将在删除图像上获得一个超链接，单击删除会将您发送到**deleteLink.action**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T06:46:06.630

看一下 display:column，你可以使用 href 和 paramId 将唯一 id 传递给 url 以删除特定记录。

# c# - 具有泛型类型参数的 DynamicMethod

> ID：788618
> 
> 赞同：8
> 
> 时间：2009-04-25T09:51:49.833
> 
> 标签：c#, reflection, reflection.emit, dynamicmethod

是否可以使用泛型类型参数定义 DynamicMethod？MethodBuilder 类具有 DefineGenericParameters 方法。DynamicMethod 有对应的吗？例如，是否可以使用 DynamicMethod 创建具有像给定打击一样的签名的方法？

```
void T Foo<T>(T a1, int a2) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-25T11:59:21.090

这似乎是不可能的：正如你所看到的，它`DynamicMethod`没有`DefineGenericParameters`方法，它继承`MakeGenericMethod`自它的`MethodInfo`基类，它只是 throws `NotSupportedException`。

几种可能性：

*   使用定义一个完整的动态程序集`AppDomain.DefineDynamicAssembly`
*   自己做泛型，`DynamicMethod`为每组类型参数生成一次

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-26T04:35:17.147

实际上有一种方法，它并不完全通用，但你会明白的：

```
public delegate T Foo<T>(T a1, int a2);

public class Dynamic<T>
{
    public static readonly Foo<T> Foo = GenerateFoo<T>();

    private static Foo<V> GenerateFoo<V>()
    {
        Type[] args = { typeof(V), typeof(int)};

        DynamicMethod method =
            new DynamicMethod("FooDynamic", typeof(V), args);

        // emit it

        return (Foo<V>)method.CreateDelegate(typeof(Foo<V>));
    }
} 
```

你可以这样称呼它：

```
Dynamic<double>.Foo(1.0, 3); 
```

# java - Google Web Toolkit：PHP 应用程序的 RichTextArea 安装

> ID：788620
> 
> 赞同：3
> 
> 时间：2009-04-25T09:52:33.857
> 
> 标签：java, gwt

Google Web Toolkit 具有 gwt-RichTextArea，一个简单但有效的所见即所得编辑器。现在我想在我的 PHP 应用程序中使用这个编辑器，但不知道如何实现它。我不确定，但似乎只有在使用 JAVA 时才能实现。告诉我我错了！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T09:57:35.593

在 GWT 中创建的所有内容最终都会编译为 HTML、javascript 和 CSS，因此即使您的应用程序使用 PHP，您也可以使用此控件。但是您需要了解 Java 才能创建带有`RichTextToolbar`控件的初始 GWT 应用程序，然后可以将其编译为 Javascript。

如果您是 GWT 新手，请参阅[本指南](http://code.google.com/webtoolkit/gettingstarted.html)，如果您也是 Java新手，请参阅本[教程。](http://java.sun.com/docs/books/tutorial/)

# javascript - 如何使用 javascript 创建书签按钮？

> ID：788626
> 
> 赞同：1
> 
> 时间：2009-04-25T09:59:46.383
> 
> 标签：javascript, email

如何创建一个将整个页面作为电子邮件发送的书签按钮。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-25T10:38:20.237

页面的 HTML 内容很难发送，您可以使用它在电子邮件中发送页面的文本，如下所示 -

```
if (document.all)
    window.open("mailto:email@email.com?body=" + document.body.innerText); //For IE
else
    window.open("mailto:email@email.com?body=" + document.body.textContent); //For FF et al. 
```

书签将是 -

```
"javascript:if (document.all) window.open('mailto:email@email.com?body=' + document.body.innerText); else window.open('mailto:email@email.com?body=' + document.body.textContent);" 
```

编辑：为此，您必须创建一个链接，并且必须右键单击它并单击“添加到收藏夹”。

```
<a href="javascript:if (document.all) window.open('mailto:email@email.com?body=' + document.body.innerText); else window.open('mailto:email@email.com?body=' + document.body.textContent);">Bookmark This</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T06:39:19.617

我稍微处理了你的问题，用 jquery ($('html').html()) 完成了它，一切似乎都很好。但是 .. 在我尝试通过电子邮件发送整个内容之后它没有工作。当我知道它为什么不起作用时，我笑了 - 网址太长了，伙计，软件无法打开它。甚至在硬编码字符串上进行了测试 - 简短的内容可以很好地打开邮件客户端，而长时间则没有。

算了。

如果你想用 javascript 阅读 html，你可以做到，但你必须通过邮寄将它发送到你的服务器并从那里邮寄。欢呼

附言。尝试一些测试简短的 html 内容，然后尝试一个完整的休闲网页

```
$(document).ready(function(){           
        $("#testlink").click(function() {
            $('#trick').text($("html").html().replace(/[\r\n]+/g, "%0A"));
            window.open('email@email.com?body='+$('#trick').html(), 'email', '');
        }); 
    }); 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-04-25T10:33:27.847

将这样的内容放在 HTML 文档的 head 部分，或者更好的是，跳过脚本标签和

把它放在一个外部文件中，然后在 head 部分链接到它：

```
<script language="JavaScript" type="Text/Javascript"><!-- // 
var url = " "; //u can add ur url
var pageName = "Client side programming"; 
function bookmark() { 
if (window.external) { 
window.external.AddFavorite(url, pageName)   
} 
else { 
alert("Sorry! Your browser doesn't support function. 
Use the bookmark option in your browser instead."); 
} 
} // --></script> 
```

这在您的 HTML 文档的正文部分中的某处：

```
<input type="button" name="Bookmark this page" onclick="bookmark()" />

or...

Simple link:
<a
href="javascript:bookmark()">Click here to bookmark this page
</a> 
```

# spring - 使用验证器在 Spring SimpleFormController 上保留请求参数

> ID：788630
> 
> 赞同：0
> 
> 时间：2009-04-25T10:05:14.233
> 
> 标签：spring, validation, portlet, liferay

我希望我能正确解释这一点。我正在使用 Spring 为 Liferay 开发一个 portlet。这是一个插板系统。所以我有一个视图（Jsp），它显示了某个 pinboard 条目的详细信息，给定了它的 id。此外，还有一个指向 AddCommentController 的链接，用于向用户当前正在观看的 pinboard 条目添加新评论。AddCommentController 扩展了 Spring 的 SimpleFormController 并且还附加了一个验证器：

```
<bean id="addCommentController" class="com.lifepin.controllers.AddCommentController" parent="lifePinControllerTemplate">
    <property name="formView" value="addComment" />
    <property name="successView" value="viewEntryDetail" />
    <property name="validator" ref="commentValidator"/>
</bean> 
```

验证器非常简单，如下所示：

```
public class CommentValidator implements Validator {

    public boolean supports(Class clazz) {
        return clazz.equals(Comment.class);
    }

    public void validate(Object obj, Errors validationError) {
        ValidationUtils.rejectIfEmptyOrWhitespace(validationError, "content", "err.content.empty", "This value is required");
    }

} 
```

现在用户可以输入评论的视图有两个按钮，保存和取消。这是相应网址的两个生成器。

```
<portlet:actionURL var="actionUrl">
    <portlet:param name="action" value="addComment"/>
    <portlet:param name="pinboardEntryId" value="${param.pinboardEntryId}"/>
</portlet:actionURL>

<portlet:renderURL var="cancelUrl">
    <portlet:param name="action" value="viewPinboardEntry"/>
    <portlet:param name="pinboardEntryId" value="${param.pinboardEntryId}"/>
</portlet:renderURL> 
```

在 AddCommentController 的 onSubmitAction 中，我读出了参数（参见上面的第一个 actionURL）并将其传递给 pinboard 条目详细视图中的 ActionResponse st，我可以再次加载条目并显示它。

```
public class AddCommentController extends SimpleFormController{
   ...
   @Override
   protected void onSubmitAction(ActionRequest request, ActionResponse response, Object command, BindException bindException)
            throws Exception {

      long pinboardEntryId = PortletRequestUtils.getLongParameter(request, ParameterNameConstants.PINBOARDENTRY_ID, -1);
      ...
   }
   ...
} 
```

这一切都很好，除非发生验证错误。在这种情况下，我从 URL 中丢失了“pinboardEntryId”参数，并且我没有任何方法可以在 CommentValidator 中读取该参数以再次将其传递给响应，因为我没有任何 PortletRequest 或响应。

现在我通过将 id 存储在会话中并从那里检索它来解决这个问题。但是，我想问一下你们中的一些人是否有无需使用会话的替代解决方案。我很确定有一个。

谢谢，
朱里

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-10-13T13:32:08.470

一个更简单的解决方案是设置 renderParameters 属性。renderParameters 属性是 SimpleFormController 将始终转发的参数名称数组。例如：

```
 <bean id="addCommentController" class="...">
         ....
         <property name="renderParameters">
           <list>
             <value>pinboardEntryId</value>
           </list>
         </property>
    </bean> 
```

这将导致每次都传递“pinboardEntryId”参数而无需任何附加代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-30T19:45:39.100

`showForm(..)`再次调用验证错误。您可以覆盖此方法并`Request`根据需要进行操作`Response`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T09:21:48.960

我首先尝试了 Oliver Gierke 建议的 showForm(..) 方法（感谢您的反馈），但这并没有达到预期的效果。showForm(..) 想要返回一个我不想关心的新 ModelAndView，因为这应该由 onSubmitAction(...) 完成。

正确的方法是覆盖

```
@Override
protected void processFormSubmission(ActionRequest request, ActionResponse response, Object command, BindException errors){
  ...
} 
```

在那里，所有需要的信息都可用。我现在可以使用 BindingException 检查是否存在验证错误`errors.hasErrors()`。如果是这种情况，我可以读取所需的参数并将它们转发到响应以将它们再次显示在表单上。否则我只是调用`onSubmitAction(..)`，传递所需的参数，例如我在 processFormSubmission 中可用的请求、响应等。

# .net - 桌面单声道应用和 MVC/MVP 框架

> ID：788632
> 
> 赞同：4
> 
> 时间：2009-04-25T10:07:36.257
> 
> 标签：.net, model-view-controller, mono, mvp

我正在为我的第一个单声道应用程序寻找一个 MVC/MVP（最好是 mvp）框架。那里似乎没有太多，但我发现了以下内容：

[http://www.mvcsharp.org/](http://www.mvcsharp.org/) [http://desktoprails.osl.ull.es/doku.php](http://desktoprails.osl.ull.es/doku.php)

我已经研究了一段时间，而 MVC# 似乎更接近我想要的。

问题是 MVC# 似乎是一个 .net 项目，并不是专门为单声道设计的（与桌面导轨相反），所以我不能 100% 确定它将如何与单声道一起播放。此外，它在 Microsoft 公共许可证 (MsPL) 下，我不确定该许可证与我打算使用的其他组件（如 gpl/mit/apache/etc）一起使用的效果如何。

因此，如果有人对这些单声道框架中的任何一个有任何经验并且可以回答这些问题中的任何一个，我将不胜感激任何反馈。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T15:18:33.280

你可以在 Mono 上使用 ASP.NET MVC Framework，也就是说

*   您可以使用 Apache2 和 mod_mono 托管它
*   您可以在 Linux 或 MacOS 上使用 MonoDevelop 开发它（现在支持 ASP.NET MVC）（您可能需要为此安装 ASP.NET MVC 插件，但这很容易）当然这仅适用于 Web 应用程序，而不适用于桌面应用程序。

# asp.net-mvc - 如何本地化 ASP.NET MVC + Spark 应用程序？

> ID：788635
> 
> 赞同：2
> 
> 时间：2009-04-25T10:09:16.487
> 
> 标签：asp.net-mvc, localization, globalization, spark-view-engine

我正在使用 Spark 视图引擎，并且想要本地化网站。为“常规”MVC 视图引擎描述的方法不起作用。有人已经这样做了吗？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-05T11:38:38.497

[spark 发布包](http://sparkviewengine.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=24940#DownloadId=62392)中包含一些示例项目，其中之一称为“国际化”。自从我刚开始使用 Spark 以来，我自己还没有看过，但它似乎是您正在寻找的东西。

# sql-server - 如果从一个存储过程中调用另一个设置较低事务隔离级别的存储过程，可以吗？

> ID：788636
> 
> 赞同：3
> 
> 时间：2009-04-25T10:09:46.423
> 
> 标签：sql-server, stored-procedures, transactions, transaction-isolation

我有一堆实用程序，它们只是检查数据库中的某些条件并返回一个标志结果。这些过程以 READ UNCOMMITTED 隔离级别运行，相当于 WITH NOLOCK。

我还有更复杂的过程，它们以 SERIALIZABLE 隔离级别运行。他们也碰巧有这些相同的支票。

所以我决定从那些复杂的过程中调用这些检查过程，而不是复制检查代码。

基本上它看起来像这样：

```
CREATE PROCEDURE [dbo].[CheckSomething]
AS
    SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED

    BEGIN TRANSACTION

    -- Do checks

    COMMIT TRANSACTION 
```

和

```
CREATE PROCEDURE [dbo].[DoSomethingImportant]
AS
    SET TRANSACTION ISOLATION LEVEL SERIALIZABLE

    BEGIN TRANSACTION

    EXECUTE [dbo].[CheckSomething]

    -- Do some work

    COMMIT TRANSACTION 
```

这样做可以吗？临时激活的较低隔离级别会以某种方式破坏较高级别的保护，还是一切都完美安全？

编辑：执行顺利，没有任何错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-25T12:46:55.437

SQL Server 2005的[全部内容都在这里。一个片段：](http://msdn.microsoft.com/en-us/library/ms173763.aspx)

> 当您将事务从一个隔离级别更改为另一个时，更改后读取的资源将根据新级别的规则受到保护。更改前读取的资源继续按照上一级的规则进行保护。例如，如果事务从 READ COMMITTED 更改为 SERIALIZABLE，则更改后获取的共享锁现在将保留到事务结束。
> 
> 如果在存储过程或触发器中发出 SET TRANSACTION ISOLATION LEVEL，则当对象返回控制权时，隔离级别将重置为调用对象时有效的级别。例如，如果在批处理中设置 REPEATABLE READ，然后批处理调用将隔离级别设置为 SERIALIZABLE 的存储过程，则当存储过程将控制权返回给批处理时，隔离级别设置将恢复为 REPEATABLE READ。

在这个例子中：

*   每个隔离级别都应用于存储过程的范围
*   DoSomethingImportant 锁定的资源保留在 SERIALIZABLE 下
*   CheckSomething 使用的资源是 READ UNCOMMITTED

# vb.net - 如何在 vb.net 中将属性设为公开获取但私有设置？

> ID：788638
> 
> 赞同：3
> 
> 时间：2009-04-25T10:10:12.147
> 
> 标签：vb.net

我只是在一些 C# 代码中偶然发现了这个......：

```
public Foo     Foo    { get; private set; } 
```

我怎样才能在vb中做同样的事情？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-25T10:13:05.523

当然（摸额头）……：

```
Public Property Foo() As Foo
    Get
        ...
    End Get
    Private Set(ByVal value As Foo)
        ...
    End Set
End Property 
```

我没想过把 private 关键字放在那里......

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-25T10:13:45.320

VB.NET 没有像 C# 3.0 那样的自动属性。在 VB 中，等价于：

```
 Private _Foo As SomeType
    Public Property Foo() As SomeType
        Get
            Return _Foo
        End Get
        Private Set(ByVal value As SomeType)
            _Foo = value
        End Set
    End Property 
```

# macos - 在 dylib 中设置字符集符号

> ID：788649
> 
> 赞同：2
> 
> 时间：2009-04-25T10:16:59.180
> 
> 标签：macos, dylib

我使用旧的 Powerbook G4。尝试更新 macports (sudo port -d selfupdate) 时存在以下错误。

dyld：惰性符号绑定失败：找不到符号：_locale_charset 引用自：/usr/bin/rsync 预期在：/usr/lib/libiconv.2.dylib

dyld：找不到符号：_locale_charset 引用自：/usr/bin/rsync 预期在：/usr/lib/libiconv.2.dylib

如何设置 Symbol _locale_charset？有人有好主意吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T17:03:29.220

既不`/usr/bin/rsync`是也不`/usr/lib/libiconv.2.dylib`是 MacPorts 的一部分。可能您已将系统副本替换为`rsync`与您的 OS X 版本不兼容的另一个副本。尝试重新安装它。

# sql-server-2005 - MS SQL Server 2005 - 不区分大小写的密码问题

> ID：788650
> 
> 赞同：1
> 
> 时间：2009-04-25T10:18:54.293
> 
> 标签：sql-server-2005

我正在检查 MS SQL SERVER 2005 中的一个过程中的登录用户名和密码。由于 SQL Server 2005 不区分大小写，即使用户提供的是小写密码而不是大写密码，系统也允许登录。

我应该怎么办？？Sql Server 2005 中是否有任何可以检查相同的命令？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-25T10:24:58.163

使用区分大小写的排序规则 - 例如

```
...where Password = @password COLLATE SQL_Latin1_General_CP1_CS_AS 
```

是的，您不应该真正将纯文本密码存储在数据库中！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T10:25:10.037

**永远不要**存储纯文本密码！存储密码的*哈希值*并进行比较。您可以使用[HashBytes()](http://msdn.microsoft.com/en-us/library/ms174415.aspx)函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-25T10:23:53.750

SQL Server 2005 仅在默认排序规则下使用不区分大小写的比较。您不应该以明文形式存储密码。您应该使用相当安全的散列算法对它们进行散列并存储散列。（也许您也应该真正使用盐值，但让我们从散列开始）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-25T10:25:50.673

使用区分大小写的[排序规则](http://msdn.microsoft.com/en-us/library/ms184391(SQL.90).aspx)进行比较，例如：

```
SELECT
  Id
FROM
  UserTable
WHERE
  UserName = @UserName
  AND Password = @Password COLLATE SQL_Latin1_General_Cp1_CS_AS 
```

使用与密码列的字符集匹配的排序规则。

一个不同的注释 - 您确定要在数据库中存储*明文密码吗？*当涉及到安全决策时，这在前 5 大注意事项中名列前茅。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-04-25T10:30:48.760

在某些情况下，您可能希望存储明文密码，因此我不会重复其他人的建议，尽管它通常是合理的。

除了设置排序规则之外，您还可以像这样使用 varbinary 技巧：

```
WHERE
  CAST(Password as varbinary(20)) = CAST(@Password as varbinary(20)) AND
  CAST(Username as varbinary(20)) = CAST(@Username as varbinary(20)) 
```

以上也将导致区分大小写的搜索 - 只需记住将 varbinary 长度设置为与字段长度相同。

为避免索引扫描，您还可以包括不区分大小写的搜索 - 这将进行索引搜索并在之后执行 varbinary 搜索：

```
WHERE
  Password = @Password AND
  Username = @Username AND
  CAST(Password as varbinary(20)) = CAST(@Password as varbinary(20)) AND
  CAST(Username as varbinary(20)) = CAST(@Username as varbinary(20)) 
```

# asp.net-mvc - ASP.NET MVC 图像参数缓存

> ID：788656
> 
> 赞同：1
> 
> 时间：2009-04-25T10:25:17.680
> 
> 标签：asp.net-mvc

我有一个控制器操作，它重新调整 ImageResult（扩展 ActionResult）。当这个动作方法第一次被参数值 N 调用时，其他后续调用都将具有相同的参数值 N，而它们的参数不同。我猜这在某种程度上与 ASP.NET MVC 中的参数缓存有关。

因此，无论参数值如何，调用动作返回的图像总是相同的。有没有解决的办法？

也许它与直接写入响应有关？这是我的图像结果：

```
 public class ImageResult : ActionResult  
{  
    public Image Image  
    {  
        get; set;  
    }  

    public ImageFormat ImageFormat  
    {  
        get; set;  
    }  

    private static Dictionary FormatMap  
    {  
        get; set;  
    }  

    static ImageResult()  
    {  
        CreateContentTypeMap();  
    }  

    public override void ExecuteResult(ControllerContext context)  
    {  
        if (Image == null) throw new ArgumentNullException("Image");  
        if (ImageFormat == null) throw new ArgumentNullException("ImageFormat");  

        context.HttpContext.Response.Clear();  
        context.HttpContext.Response.ContentType = FormatMap[ImageFormat];  

        Image.Save(context.HttpContext.Response.OutputStream, ImageFormat);  
    }  

    private static void CreateContentTypeMap()  
    {  
        FormatMap = new Dictionary  
        {  
            { ImageFormat.Bmp,  "image/bmp"                },  
            { ImageFormat.Gif,  "image/gif"                },  
            { ImageFormat.Icon, "image/vnd.microsoft.icon" },  
            { ImageFormat.Jpeg, "image/Jpeg"               },  
            { ImageFormat.Png,  "image/png"                },  
            { ImageFormat.Tiff, "image/tiff"               },  
            { ImageFormat.Wmf,  "image/wmf"                }  
        };  
    }  
} 

```

和控制器动作：

```
 public ActionResult GetCalendarBadge(DateTime displayDate)
{
    var bmp = SomeBitmap();
    var g = Graphics.FromImage(bmp);

    //GDI+ to draw the image.

    return new ImageResult { Image = bmp, ImageFormat = ImageFormat.Png };
} 

```

和查看代码：

```
 <% foreach(var item in this.Model.News) { %>  
      <%= Html.Image<NewsController>(o => o.GetCalendarBadge(item.DisplayDate), 75, 75)%>
<% } %> 

```

还尝试添加这两个避免缓存，但没有任何反应：

```
 context.HttpContext.Response.Cache.SetNoStore();  
  context.HttpContext.Response.Expires = 0;  
  context.HttpContext.Response.AppendHeader("Pragma", "no-cache"); 

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-25T10:40:46.957

我认为该行为是通过操作上的缓存属性“选择加入”的。

您绝对确定您的数据访问层正在正常工作吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T11:04:22.023

发现问题了！这是由于使用 Windsor IoC 并将控制器注册/解析为 Singleton（这是默认行为）。将生活方式更改为 Transient 解决了该问题（以及其他问题）。

请参阅[此处](http://blog.hightech.ir/2009/04/using-windsor-ioc-in-aspnet-mvc.html)了解更多信息。

# iphone - Rendering UIView with its children

> ID：788662
> 
> 赞同：22
> 
> 时间：2009-04-25T10:29:14.613
> 
> 标签：iphone, uiview, rendering

I have a `UIView` that has an image and some buttons as its subviews. I'd like to get a "snapshot" image of it using `renderInContext`, or other method.

```
[clefView.layer renderInContext:mainViewContentContext]; 
```

If I pass it my `UIView` (as above) then I get a blank bitmap. None of the children are rendered into the bitmap.

If I pass it the child view that is the image, then I get an image of that bitmap, and, unsurprisingly, none of its siblings (buttons).

I was sort of hoping that `renderInContext` would take the image and all it's visible children and render it into a bitmap. Has anyone have any ideas how to do this?

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-04-25T10:58:58.473

Try something like this:

```
UIGraphicsBeginImageContext(clefView.bounds.size);
[clefView.layer renderInContext:UIGraphicsGetCurrentContext()];
UIImage *resultingImage = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-18T10:42:57.327

The simple 4-line version didn't work for me. I have a UIView (with sublayers), and a child UITextView. I can render the UIView into the UIImage OK, but the child UITextView does not get rendered.

My simple solution is as follows:

```
CGRect rect = [view bounds];
UIGraphicsBeginImageContextWithOptions(rect.size, YES, 0.0f);
CGContextRef context = UIGraphicsGetCurrentContext();

[view.layer renderInContext:context];
for (UIView *sv in view.subviews)
{
    CGContextTranslateCTM(context, sv.frame.origin.x, sv.frame.origin.y);
    [sv.layer renderInContext:context];
    CGContextTranslateCTM(context, -sv.frame.origin.x, -sv.frame.origin.y);
}

UIImage *capturedImage = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext(); 
```

Note that the simple use of CGContextTranslateCTM assumes the child views have no transform other than translation. Also I'm assuming the child views are entirely contained within the parent view frame.

# c# - 我需要锁定列表吗？C＃

> ID：788674
> 
> 赞同：4
> 
> 时间：2009-04-25T10:41:20.590
> 
> 标签：c#, multithreading, locking

我用默认值填充了几个 list<> ，将它们粘贴到一个结构中，然后将该结构传递给几个线程。每个线程都有不同的范围，因此线程 1 将访问列表 [0 到 199] 线程 2 将访问 [200 - 400] 等。我需要锁吗？我什么时候需要它？我可以使用我的多个线程访问列表，而无需使用锁。但是如果我的主线程想要*读取*列表中的数据（从不写）我需要一个锁吗？我确定我不知道，但我想在实施之前问一下。

-编辑-

谢谢各位，回答了我的问题。（只要有人不反驳当前的答案，我稍后会接受）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-25T10:44:48.087

如果您不修改集合，则根本不需要锁定。

如果您想使用其中一个线程修改集合，您可能需要查看[ReaderWriterLock](http://msdn.microsoft.com/en-us/library/system.threading.readerwriterlock.aspx)。

彼得的评论值得注意。正如上面的 MSDN 链接所指出的，如果您使用的是 .NET 3.5 ，则应该考虑使用[ReaderWriterLockSlim类。](http://msdn.microsoft.com/en-us/library/system.threading.readerwriterlockslim.aspx)然而，这个想法是一样的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-25T10:44:27.540

如果您绝对确定您没有修改实际列表（添加项目、删除项目等），则不需要锁定。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-25T10:46:46.893

如果你不写，你就不需要锁。但是，如果您在其他线程中写入，那么您应该有一个锁。即使这些线程仅访问特定范围，如果您将节点添加到可能导致问题的列表中。如果您没有更改列表结构，而只是更改节点中的任何内容，那么我认为没有问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-26T02:36:41.620

In your struct object, I would at least mark the variable as ReadOnly and maybe the new ReadOnlyCollection

```
public struct MyStruct
{
    private readonly ReadOnlyCollection<int> _myInts;

    public MyStruct(ReadOnlyCollection<int> ints)
    {
        _myInts = ints;
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-25T11:38:14.913

您是否考虑过使用数组？只要您不在两个线程中访问相同的索引，数组就是线程安全的。此外，如果您不更改大小，它会更快。

# nhibernate - 在 NHibernate 中，我如何映射一个对象以仅检索它的子对象，但在创建或更新时忽略它们？

> ID：788675
> 
> 赞同：0
> 
> 时间：2009-04-25T10:41:53.710
> 
> 标签：nhibernate, nhibernate-mapping

在创建对象或将对象更新到数据库时，如何将此对象映射为仅检索下面的集合并完全忽略它？

```
 <bag name="children"  table="tb_parent_child" lazy="false">
  <key column="parentID"/>
  <one-to-many class="Child"/>
</bag> 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-25T17:29:39.843

将级联属性设置为无：

```
 <bag name="children"  table="tb_parent_child" lazy="false" cascade="none">
     <key column="parentID"/>
     <one-to-many class="Child"/>
 </bag> 
```

应该做到这一点。有关级联选项的描述，请参阅此[博客条目](http://ayende.com/Blog/archive/2006/12/02/NHibernateCascadesTheDifferentBetweenAllAlldeleteorphansAndSaveupdate.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T11:06:13.040

为什么不将lazy设置为true？基本上不会这样吗？也可能将级联设置为“无”？

# c# - 使用 C# 程序自动完成 HTML 表单

> ID：788684
> 
> 赞同：2
> 
> 时间：2009-04-25T10:52:45.820
> 
> 标签：c#, html, console

我想编写一个 C# 程序（纯粹用于教育目的），它会自动完成驻留在指定 URL 的 HTML 表单。问题是我不知道这是否可能或我该如何开始？我想下载 HTML，将其解析为表单元素的名称，然后使用必要的参数在该 URL 上进行 GET。这是一个好主意吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-25T11:12:05.930

见[`System.Net.WebRequest`](http://msdn.microsoft.com/en-us/library/system.net.webrequest.aspx)。您可以使用它来发出 GET 请求，其中变量编码在 URL 中，或 POST 请求，其中变量进入请求正文。表单的 HTML 源代码将告诉您要发出哪种类型的请求。

如果表单的结构没有改变，您将不需要在运行时下载或解析表单本身：您可以在构建 GET 或 POST 请求时在程序中对变量名称进行硬编码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-25T11:15:24.253

您的一般想法是正确的，尽管通常 HTML 表单将执行返回服务器的 POST 而不是 GET。有关提供参数的 C# 中 Web 请求的示例代码，请参阅[此问题。](https://stackoverflow.com/questions/524525/how-to-login-to-html-form-using-post-vars-in-c-net)特别注意告诉你添加 request.Method = "POST"; 的评论 因为这会改变来自 GET 的请求。（您可以通过查看其开始标记中的方法来判断表单是 GET 还是 POST。这个：

```
<form id="form" action="..." method="post"> 
```

是一个 POST 表单。没有声明的方法意味着它是一个 GET）

更复杂的问题是解析 HTML 以查找元素。这是一个棘手的问题，因为 HTML 标准的松散性意味着您不能简单地将其视为 XML 文档并以这种方式进行解析，相反，您必须想出一种更宽容的方法。在这个网站上有一些关于如何做到这一点的问题（[例如这个](https://stackoverflow.com/questions/56107/what-is-the-best-way-to-parse-html-in-c)），这是一个常见的问题，所以谷歌无疑会给你一些线索。

如果我正在处理这个问题，我会先让 Web 请求使用已知的表单（这样你就可以跳过解析），一旦你对从服务器发送和检索数据感到满意，就担心这部分。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-25T12:54:11.893

WatiN 会为您执行此操作，它会自动执行 IE 以进行测试。但我用它来筛选刮东西。它运作良好。

[http://watin.sourceforge.net/](http://watin.sourceforge.net/)

```
[Test] 
public void SearchForWatiNOnGoogle()
{
 using (IE ie = new IE("http://www.google.com"))
 {
  ie.TextField(Find.ByName("q")).TypeText("WatiN");
  ie.Button(Find.ByName("btnG")).Click();

  Assert.IsTrue(ie.ContainsText("WatiN"));
 }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-25T11:56:18.523

[Dave Ward](http://encosia.com/2008/06/26/use-jquery-and-aspnet-ajax-to-build-a-client-side-repeater/)写了一篇很棒的文章，主要围绕使用 AJAX 回发到页面方法。这个想法是将响应对象序列化为 JSON 并使用 jQuery 显示在客户端上。这篇文章写得很好，有一个很好的例子，可以应用于你的情况。

如果你通读这篇文章，你会发现你的想法与他的策略是一致的。Dave 的站点有许多很酷的文章，它们融合了 Asp.net、AJAX 和使用 jQuery 和 Javascript 的客户端技术。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-25T12:17:59.843

听起来像是涉及表单提交的屏幕/网络抓取。您可能想查看我对[这个问题](https://stackoverflow.com/questions/519387/writing-a-c-program-that-scans-ecommerce-website-and-extracts-products-pictures/)的回答。

# c# - 控制台应用问题

> ID：788685
> 
> 赞同：1
> 
> 时间：2009-04-25T10:54:24.117
> 
> 标签：c#, .net, console-application

我在想为什么当我创建控制台应用程序并“转换”主方法以与创建 Windows 窗体项目时自动生成的主方法相同时，控制台仍然出现在屏幕上：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading;
using System.Globalization;
using System.Windows.Forms;

namespace Chapter16
{
    static class Program
    {
        [STAThread]
        static void Main()
        {
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);

            Application.Run(new CultureTest());
        }
    }
} 
```

此代码与位于 Windows 窗体应用程序的 Program.cs 中的代码相同。问题是控制台仍然出现在屏幕上，这在 windows 窗体项目中不是这种情况。这是为什么？

亲切的Regadrs PK

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-25T10:55:11.523

您应该将项目属性中的目标类型设置为“Windows 应用程序”。这相当于`/target:winexe`编译器开关。它将改变`subsystem`in 二进制标头以告诉 Windows 不要打开 shell 窗口。

# ruby - Ruby 元编程在线教程

> ID：788689
> 
> 赞同：28
> 
> 时间：2009-04-25T10:56:57.167
> 
> 标签：ruby, metaprogramming

我刚刚开始学习 Ruby，并且对基础知识有了很好的了解。我一直听说 Ruby 做得很好的一件很酷的事情是元编程，但我读过的教程都没有涵盖这一点。搜索谷歌我似乎只能找到付费的 ruby​​ 元编程屏幕投射。

那么，我在哪里可以找到一个好的 Ruby 元编程在线教程呢？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-25T12:46:16.890

上面的文章确实提到了这一点，但为了清楚起见，我会发布它：http: [//viewsourcecode.org/why/hacking/seeingMetaclassesClearly.html](http://viewsourcecode.org/why/hacking/seeingMetaclassesClearly.html)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-27T03:27:14.330

如果您准备花一点钱，那么[The Pragmatic Programmers](http://www.pragprog.com)网站上有一个关于 Ruby 对象模型和元编程的优秀截屏系列。它不是很贵，而且是一个非常全面的系列，涵盖了很多很酷的东西，每一分钱都值得。

我需要再看一遍以尝试理解一些概念，然后我可以成为很酷的元人群之一:)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-01-16T11:46:01.093

此链接以非常系统的方式解释了 Ruby 元编程的各种概念（单例、动态编程等）。

[http://ruby-metaprogramming.rubylearning.com/](http://ruby-metaprogramming.rubylearning.com/)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-02-11T21:35:48.840

这2本书应该让你...

Matz 和 Flanagan 的“Ruby 编程语言”。

Paolo Perrota 的“元编程 Ruby：像 Ruby 专家一样的程序”

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-02T13:34:50.533

您可以查看[http://rubymonk.com/learning/books/2-metaprogramming-in-ruby](http://rubymonk.com/learning/books/2-metaprogramming-in-ruby) - 这是我们在 RubyMonk.com 上发布的第二本关于 Ruby 编程的免费书籍。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-07-13T09:29:05.363

我很惊讶没有人提到 Code School。他们的“Ruby Bits Part 2”课程遵循与优秀书籍“Eloquent Ruby.”的后半部分类似的材料，并带有一组很好的交互式测试来帮助您深入了解这些材料。

链接： http: [//www.codeschool.com/courses/ruby-bits-part-2](http://www.codeschool.com/courses/ruby-bits-part-2)

级别：

1.  块、过程和 Lambda
2.  动态类和方法
3.  了解自我
4.  缺少方法 5 和 6\. DSL

订阅费用为每月 20 美元（您还可以访问他们所有的其他课程），但对我来说这是完全值得的。

# java - 我应该使用全局变量还是在 java 中传递变量？

> ID：788693
> 
> 赞同：3
> 
> 时间：2009-04-25T10:59:58.203
> 
> 标签：java, global-variables, argument-passing

我正在创建一个基于 2d 瓷砖的 sim 游戏。我有一个二维的 gridSquares 数组，可以从许多不同的类和方法中访问和更改。我应该每次都传递二维的 gridSquares 数组，还是将其设为全局？哪个是最佳实践？

我在想，是否可以选择创建一个只包含一组所有类都可以扩展的变量的类？这是一个好主意还是坏主意/不是好习惯？

我对java还是很陌生，所以我还在学习很多东西！

提前致谢。

相对

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-25T12:20:28.387

您不应该根据数据结构进行设计。Java 是一种面向对象的语言。尝试将您的问题视为对象交互。它不是二维数组；它是一个 Board 对象。将操作其状态的行为构建到问题中，并隐藏您碰巧选择了二维数组的事实。

我没有制定董事会的所有细节，但它会像这样开始：

```
public class Board
{
    // This is what you're passing around now; Board hides it.
    // Square is the abstraction of a position on the Board
    private Square[][] grid;

    public Board(int nRows, int nCols)        
    {
       this.grid = new Square[nRows][];
       for (int i = 0; i < this.grid[i].length; ++i)
       {
           this.grid[i] = new Square[nCols];
       }
    }

    // Now add methods for adding Pieces to the Board, rules for moving them, etc.
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-25T11:13:30.340

将它们传递给构造函数并将它们保存在成员变量中。

如果您从太多地方访问它们，您可能会遇到设计问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-25T11:13:05.117

如果您*确定*您只有一个“二维网格正方形数组”，您可以始终使用单例模式，本质上使其成为全球性的。

虽然有支持和反对的争论，但您可能会发现有一天您希望能够预加载地图，但是单例会妨碍（无法创建单例的第二个实例）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-25T11:08:09.120

如果您绝对需要，在包含网格的类 (A) 中将网格声明为公共的，然后静态导入 A 类 ( `import static A;`)。这将使您能够在不扩展 A 类的情况下与网格交互，至少。

您的代码不应该从太多地方访问网格。考虑重构您的代码以避免不得不从各处操作网格。分开你的顾虑。就像你提到的，使用继承绝对不是一个好主意。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-25T12:35:56.353

我会推荐它使其成为静态但创建一个明确的类来从中读取数据，比如 GridSquaresAcessor。在这个类中，您编写访问数组的所有方法。更好的是，使其成为此类的私有静态字段，以避免任何其他代码以此类未定义的方式进行操作。

在每个需要访问数组的类中，您可以将一个 GridSquaresAcessor 作为参数传递给构造函数，并将其存储在局部变量中。

我个人不喜欢单例，因为它们使测试代码变得非常困难......

如果您的代码是多线程的，请确保使二维数组同步。

# javascript - JavaScript字符串替换方法中的斜杠而不是引号

> ID：788694
> 
> 赞同：1
> 
> 时间：2009-04-25T11:01:02.710
> 
> 标签：javascript, replace

他们为什么使用

**/**

代替

**'**

在 JavaScript 字符串替换（）？例如：

```
document.write(str.replace(/hi/, "hey")); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-25T11:06:51.120

因为 // 表示一个正则表达式，它是一个比简单的 Replace("x","y") 更强大的字符串搜索/替换版本

而且还支持简单的模式。

```
var a = "xxx";
var b = a.replace(/x/,'y');
alert( b ); //alerts "yxx" 
```

添加 g 修饰符来替换 globaly 将是：

```
b = a.replace(/x/g,'y');
alert(b); //alerts "yyy" 
```

您还可以添加 i 修饰符以使其不区分大小写。

```
var a = "XXX";
b = a.replace(/x/gi,'y');
alert(b); // alerts "yyy"; 
```

[https://developer.mozilla.org/En/Core_JavaScript_1.5_Guide/Regular_Expressions](https://developer.mozilla.org/En/Core_JavaScript_1.5_Guide/Regular_Expressions)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-25T11:16:29.337

[JavaScript 方法`replace()`](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Objects/String/replace)允许将纯字符串和[RegExp 对象](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/RegExp)作为搜索部分。

在您的示例中，使用了正则表达式（[RegExp 文字语法](https://developer.mozilla.org/en/Core_JavaScript_1.5_Guide/Creating_a_Regular_Expression)），尽管纯字符串就足够了。

# design-patterns - DDD - 工厂方法和依赖注入

> ID：788697
> 
> 赞同：0
> 
> 时间：2009-04-25T11:01:26.657
> 
> 标签：design-patterns, domain-driven-design

我有点卡在一个设计上。我是 DDD 的新手，想就如何解决这个问题发表意见。

我有一个货币值对象，它需要访问存储库以获取其他数据以使课程完整。问题（或设计问题）是只能通过工厂方法创建 Currency 的新实例。

```
public class Currency
{
  internal Currency() {}

  public string Name { get; set; }

  public static Currency CreateCurrencyFromAlphaCode(string alphaCode)
  {
    Currency cur = new Currency();
    //Needs repository to set name etc
    return cur;
  }

  public static Currency CreateCurrencyFromCountryCode(string countryCode)
  {
    Currency cur = new Currency();
    //Needs repository to set name etc
    return cur;
  }

  public static Currency CreateCurrencyFromCountryName(string countryName)
  {
    Currency cur = new Currency();
    //Needs repository to set name etc
    return cur;
  }

} 
```

我认为如果我需要将存储库注入构造函数，那么它会使工厂方法毫无意义吗？

```
public class Currency
{
  public Currency(IRepoistory repository)
  {

  }
} 
```

考虑到对存储库的依赖，我应该如何设计这个类——我必须在每个工厂方法上创建一个参数来接受存储库吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-25T11:18:51.047

你为什么不把货币建设移到货币类别之外呢？我不喜欢这个名字，但你可以试试 CurrencyBuilder。它可能看起来像这样：

```
public class CurrencyBuilder {
  private IRepository repository;

  public CurrencyBuilder() : this(new DefaultRepository()) {
  }

  public CurrencyBuilder(IRepository repository) {
    this.repository = repository;
  }

  public Currency FromCountryCode(string countryCode) {
    string currencyName = repository.GetCurrencyNameByCode(countryCode);
    if (currencyName == null)
      throw new CurrencyCodeException(countryCode + " not found");

    Currency c = new Currency();
    c.Name = currencyName;

    return c;
  }
} 
```

使用此设置，当您调用“new CurrencyBuilder()”时，它将使用您的默认存储库实例。但是，为了测试，您可以将模拟存储库传递给构造函数。

希望能有所帮助，并坚持下去。对于它的价值，这不是一个很好的例子，DI 会有很大帮助。因此，如果您对完成这项任务感到不满意，请不要立即放弃 DI。当你对它越来越熟悉时，它的用处就会越来越明显。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-26T03:03:05.283

我[也在 DDD 列表](http://tech.groups.yahoo.com/group/domaindrivendesign/message/12281)中回复了您提出的问题，但我也会在这里重复我的担忧。

我认为您在这里混淆了工厂和存储库的角色。

例如，您的方法`CreateCurrencyFromAlphaCode`实际上看起来应该是，例如，`FindCurrencyByAlphaCode`它们应该存在于存储库中，而不是工厂中。工厂用于创建持久层中*尚不*存在的对象（或用于从已从持久层接收的数据中实例化对象）。

此外，您`AlphaCode`实际上听起来像一个身份，因此，如果您确实想继续从持久层中检索货币，那么我建议您`Currency`很可能不是值对象，而是实体。

如果不了解您的领域的更多信息，很难知道这是否是一个正确的设计决策。我倾向于认为 duffymo 的响应会更好地为您服务，然后您就不必担心每次都从数据存储中获取数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-25T11:17:34.887

如果不了解更多有关应用程序上下文的信息，则很难确定，如果这稍微偏离目标，请原谅我，但您的设计似乎存在两个潜在问题。

首先，您将依赖项注入到可能将在您的域层中使用的类中。将依赖项注入域层或域层的依赖项通常被视为应用程序某处设计缺陷的症状。

其次，您的货币对象承担着两个责任。首先它是一种货币（显然），其次它负责创造货币。

要解决这些问题，您能否将货币类中的工厂方法分解为应用程序的“更高”层？如果是这样，您可能会发现一切都开始变得更容易，因为您可以毫无问题地将存储库依赖项注入工厂。这可能意味着重构您的域层代码，以便您在其中传递“现成的”货币，而不是货币代码、国家代码等，但我认为这本身并不是一件坏事。域层大概应该关心“货币”，而不一定关心“货币代码”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-25T11:47:01.757

如果“存储库”的意思是“关系数据库”，我不确定它是否应该是您的首选。毕竟，[货币代码的数量](http://www.iso.org/iso/support/currency_codes_list-1.htm)是相对静态的。它们不会经常更改，因此我认为您不必每次创建数据库时都必须支付往返数据库的费用。

我想知道从数据库或文本文件启动时加载的静态数据结构是否是更有效的选择。这也会减少一种依赖。

# python - 在python中查找子字符串

> ID：788699
> 
> 赞同：5
> 
> 时间：2009-04-25T11:02:51.053
> 
> 标签：python, regex, algorithm, substring

你能帮我在每次出现时获取两个字符之间的子字符串吗

例如，要在所有出现的给定示例序列中获取“Q”和“E”之间的所有子字符串：

```
ex: QUWESEADFQDFSAEDFS 
```

并找到具有最小长度的子字符串。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-25T11:14:49.650

```
import re
DATA = "QUWESEADFQDFSAEDFS"

# Get all the substrings between Q and E:
substrings = re.findall(r'Q([^E]+)E', DATA)
print "Substrings:", substrings

# Sort by length, then the first one is the shortest:
substrings.sort(key=lambda s: len(s))
print "Shortest substring:", substrings[0] 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-26T04:21:40.947

RichieHindle 是对的，除了

```
substrings.sort(key=len) 
```

是一种比冗余 lambda 更好的表达方式；-)。

如果您使用的是 Python 2.5 或更高版本， min(substrings, key=len) 实际上会为您提供一个最短的字符串（第一个，如果多个字符串与“最短”相关联）比排序和获取 [ 0]th 元素，当然。但如果您坚持使用 2.4 或更早版本，RichieHindle 的方法是最好的选择。

# ruby-on-rails - 在回复电子邮件的每行开头插入 >

> ID：788701
> 
> 赞同：2
> 
> 时间：2009-04-25T11:04:09.317
> 
> 标签：ruby-on-rails, email, reply

在我的 Rails 应用程序中，我有一个邮件部分，我想`>`在回复消息时在每行的开头附加一个字符。`>`挑战是，根据文本框的宽度，鉴于文本块不包含回车符，我如何知道何时插入字符。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T16:00:47.077

我没有 Rails 答案，但我建议切断所有 > 75 个字符的行。

这是大多数（正确的）电子邮件客户端的行为方式。也不要忘记设置 In-Reply-To: 和 References: 标题。

# java - 用于 Web 服务客户端存根的 XmlBeans 与 Axis

> ID：788702
> 
> 赞同：1
> 
> 时间：2009-04-25T11:04:42.513
> 
> 标签：java, web-services

有没有人对为什么在调用 Web 服务时 XmlBeans 可能比 Axis 更受青睐有任何亲身经历？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-25T12:43:18.847

我认为您不能使用[XmlBeans](http://xmlbeans.apache.org/)来调用 WebServices。XmlBeans 将创建一组表示 XML 模式 (XSD) 中遇到的数据类型的 Java 类。从技术上讲，您可以使用这些类来调用 WebServices，但您必须自己处理 SOAP 协议本身。

另一方面，[AXIS将从 WSDL 创建一堆 Java 类，并且还将创建 STUB 用于通过 SOAP 协议连接到远程服务。](http://ws.apache.org/axis/)

因此，如果您打算进行 WebService 调用，请选择 Axis 或任何其他 WebService 客户端技术，例如新 SUN（我应该说 Oracle？）SDK[中](https://jax-ws.dev.java.net/)默认包含的技术，这样您就不必处理与 JVM 本身以外的外部依赖项。[这](http://java.sun.com/developer/technicalArticles/J2SE/jax_ws_2/)是一个关于如何使用 Java 6 进行 JAX-WS 的很好的教程。

我过去经常使用 Axis，现在我几乎完全改用 JAX-WS。

# c++ - 在 C++ 中的 main() 之前初始化向量

> ID：788703
> 
> 赞同：7
> 
> 时间：2009-04-25T11:04:59.970
> 
> 标签：c++, stl, static, vector

我希望能够在 main 之前初始化一个大小为“SIZE”的向量。通常我会做

```
static vector<int> myVector(4,100);

int main() {

    // Here I have a vector of size 4 with all the entries equal to 100

} 
```

但问题是我想将向量的第一项初始化为某个值，另一个初始化为另一个值。

是否有捷径可寻？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-25T11:09:01.740

试试这个：

```
static int init[] = { 1, 2, 3 };
static vector<int> vi(init, init + sizeof init / sizeof init[ 0 ]); 
```

另请参阅[`std::generate`](http://en.cppreference.com/w/cpp/algorithm/generate)（如果您想在函数中初始化）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-25T11:15:17.013

或者只是创建一个函数并调用它：

```
std::vector<int> init()
{
  ...
}

static std::vector<int> myvec = init() 
```

也许效率有点低，但这对你来说可能并不重要，并且使用 C++0x 并移动它会非常快。

如果您想避免复制（对于 C++03 及更早版本），请使用智能指针：

```
std::vector<int>* init() { 
    return new std::vector<int>(42);
}

static boost::scoped_ptr<std::vector<int>> myvec(init()); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-26T15:28:43.417

C++0x 将允许标准容器的初始化列表，就像聚合一样：

```
std::vector<int> bottles_of_beer_on_the_wall = {100, 99, 98, 97}; 
```

显然还不是标准，但据称它受到 GCC 4.4 的支持。我在 MSVC 中找不到它的文档，但 Herb Sutter 一直在说他们的 c++0x 支持领先于委员会......

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-25T11:09:32.613

您可以使用[Boost 的逗号分隔列表](http://www.boost.org/doc/libs/1_38_0/libs/assign/doc/index.html#intro)。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-04-25T11:09:11.210

有点hackish，但你可以这样做：

```
struct MyInitializer {
   MyInitializer() {
       myVector[0]=100;
       //...
   }
} myInitializer;  // This object gets constructed before main() 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-04-25T11:32:51.963

这是替代解决方案：

```
#include <vector>                  
static std::vector<int> myVector(4,100);

bool init()
{
    myVector[0] = 42;      
    return true;
}

bool initresult = init();

int main()                  
{
    ;
} 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-27T08:58:16.700

我建议最好使用本地静态，而不是使用全局。由于向量的初始化发生在输入 main 之前，因此抛出的任何异常都不会被 main 捕获。例如说你有一个类型，当它被构造时可能会抛出异常：

```
class A {
public:
  A() { 
    // ... code that might throw an exception
  }
}; 
```

对于下面的初始化，main 体中的 try/catch 不会捕捉到构造函数抛出的异常，所以你的程序会直接死掉，你甚至可能无法使用调试器来查找原因！

```
std::Vector<A> v(5, A());  // May throw an exception here not caught by main

int main () {
  try {
     // Exception for 'v' not handled here.
  }
  catch (...) {
  }
} 
```

从构造函数捕获异常的另一种方法是使用本地静态 - 使用此[答案](https://stackoverflow.com/questions/788703/initializing-a-vector-before-main-in-c/788721#788721)建议的技术进行初始化。

```
std::Vector<A> init ();  // Returns a vector appropriately initialized

std::vector<A> & getV () {
  static std::vector<A> cache = init();
  return cache;
}

int main () {
  try {
     getV().at[0];    // First call to getV - so initialization occurs here!
  }
  catch (...) {
  }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-25T11:25:27.207

用一个类包装它：

```
class SpecialVector
{
  public:
    SpecialVector()
    {
      myVector[0] = 1;
      myVector[1] = 4;
      // etc.
    }
    const vector<int> & GetVector() const
    {
      return myVector;
    }
  private:
    vector<int> myVector;
 };
 static SpecialVector SpVec;

 int main() {
 } 
```

# javascript - 通过javascript从HTML中获取选定的文本？

> ID：788704
> 
> 赞同：1
> 
> 时间：2009-04-25T11:05:40.577
> 
> 标签：javascript

我有一个带有格式化文本的页面和一个工具栏（带有点击事件的图像）。其中一个工具命令是“标记黄色”。*（文本必须是只读的并且是格式化的。）*

我尝试使用`document.getSelection()`and `window.getSelection()`，但它们似乎仅适用于输入字段。

另一个问题是，当我单击工具栏时，我的选择会丢失。

如何在不丢失选择的情况下获取选定的文本？

## 解决方案：

线索是使用`onmousedown=""` or jQuery:`.mousedown()`函数来避免丢失选择。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T11:14:20.557

这是[使用 Javascript 获取文本选择的](http://www.codetoad.com/javascript_get_selected_text.asp)方法。

# iphone - 如何在 Objective-C 中编写一个函数，我可以在我的 iPhone 应用程序中的任何对象上使用它？

> ID：788706
> 
> 赞同：7
> 
> 时间：2009-04-25T11:06:20.327
> 
> 标签：iphone, objective-c, function

我想创建一个传递对象的函数。然后，这个函数应该为我打印出一些信息。

像：

```
analyzeThis(anyObject); 
```

我知道方法，但不知道如何制作函数。据我了解，一个函数在所有方法和类中都可以全局工作，对吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-25T11:26:02.247

`myLibraryFunctions.m`您可以像使用 C 编写的任何其他函数一样执行此操作。因此，如果您将函数定义在名为`myLibraryFunctions.h`，然后只需确保它们与目标文件链接（如果您只是创建一个文件来容纳您的“全局”函数并将它们的头文件包含在您的任何源文件中，那么大部分这将在 Xcode 中为您完成）访问它。然后定义它：

```
void analyzeThis(id anyObject);

void analyzeThis(id anyObject) {
    NSLog(@"Object %p: %zu, %@", anyObject, malloc_size(anyObject), anyObject);
} 
```

但实际上，您可以在函数中编写任何您想要的内容。这些函数不必是任何类定义或类似内容的一部分。在这种情况下，它们与 C 中的完全相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T21:29:32.043

您是否尝试重新实现 NSObject 的描述方法？如果您发送 NSObject 消息，它将返回一个包含有关自身信息的字符串。您可以覆盖 -(NSString*)description 并向此字符串添加更多信息。

如果你这样做，你会发现神奇的事情发生了——例如，当你在调试器中打印一个数组对象时，它会迭代数组的所有成员并打印它们的描述。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-25T21:41:10.923

有两种方法可以做到这一点：

*   编写一个全局函数，就像在 C 中一样
*   创建一个 NSObject 类别，在其中实现一个方法，然后该方法可用于所有以 NSObject 作为祖先的类。

# python - 如何使用 Python 与 MSN 协议交互？

> ID：788715
> 
> 赞同：0
> 
> 时间：2009-04-25T11:11:28.677
> 
> 标签：python, msn

我正在尝试使用 Python 连接到 MSN 网络。我进行了一些搜索，似乎[http://blitiri.com.ar/p/msnlib/](http://blitiri.com.ar/p/msnlib/)和[http://msnp.sourceforge.net/](http://msnp.sourceforge.net/)是可用的图书馆。然而，两者看起来都很旧，还有其他我可以使用的最新库吗？

重复：[MSN 与 Python](https://stackoverflow.com/questions/490929/msn-with-python)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T11:25:42.620

我可能在这里喋喋不休，但我认为[Python Twisted](http://twistedmatrix.com)有一个 msn 的协议实现。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-25T11:28:29.180

libpurple 在[http://developer.pidgin.im/wiki/WhatIsLibpurple](http://developer.pidgin.im/wiki/WhatIsLibpurple)

是驱动 pidgin 的库，允许您连接到 MSN 和其他人，不确定是否有 python 包装器。

# svn - 在 Subversion 中列出带有特定签入消息的文件和修订

> ID：788728
> 
> 赞同：0
> 
> 时间：2009-04-25T11:18:51.590
> 
> 标签：svn, message, commit

在 SVN 中，有没有办法根据提交消息列出文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-25T11:28:05.470

“svn log | grep ...”可能是命令行中最简单的方法。TortoiseSVN 可以直接在日志消息中搜索。

# asp.net - 想用任何带有 ASP.NET 的免费 HTML 编辑器在我的网站上创建一个新闻部分

> ID：788729
> 
> 赞同：0
> 
> 时间：2009-04-25T11:19:31.310
> 
> 标签：asp.net

我有一个带有新闻和文章部分的网站。我正在使用 Access for Database。我获得了用于 HTML 编辑器的 FCKEditor。我可以将基于 HTML 的文本保存到我的数据库中，但我无法在 datalist 控件中正确显示它。我必须使用什么从 DB.Datalist 显示这个保存的文本是一个不错的选择？或者我在哪里可以学习为我的网站制作动态文章和新闻部分？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-25T12:34:59.117

如果您要保存 HTML 以使其呈现，只需将其分配给 Literal 控件的 text 属性。DataList 用于显示您可以通过查询从数据库中获取的项目集合。

# php - 如何更改脚手架代码并在 CakePHP 中使用希伯来语本地化我的应用程序？

> ID：788731
> 
> 赞同：2
> 
> 时间：2009-04-25T11:22:43.097
> 
> 标签：php, cakephp, crud, scaffolding

我已经开始学习如何在兼职工作中使用 CakePHP 框架。我决定在这个框架中构建我的一个个人项目来进行一些实践。

1.  我有一些使用`Cake bake`命令创建的模型，并添加了自动 CRUD 支持（它为所有相关操作添加到控制器`var $scaffold`中。我想编辑这些操作，但我没有对生成的代码的引用。（正如我之前所说，它将脚手架成员添加到控制器，仅此而已。）如何编辑这些操作？

2.  我想用希伯来语构建我的应用程序，我需要将所有生成的错误消息和状态更改为希伯来语（以及在脚手架中生成的那些）。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-25T12:04:38.190

1.  再次使用“cake bake”来烘焙你的控制器和视图。

2.  阅读[http://book.cakephp.org/view/162/Localizing-Your-Application](http://book.cakephp.org/view/162/Localizing-Your-Application)

# algorithm - 找到点之间最小距离的最快方法

> ID：788733
> 
> 赞同：3
> 
> 时间：2009-04-25T11:25:28.970
> 
> 标签：algorithm, geometry

我有一组 2D 点，需要找到最快的方法来确定哪一对点的距离最短。

执行此操作的最佳方法是什么？我的方法是用快速排序对它们进行排序，然后计算距离。这将是 O(nlogn + n) = O(nlogn)。

是否可以在线性时间内完成？

谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-25T11:41:03.520

[它实际上是](http://en.wikipedia.org/wiki/Closest_pair_problem)：

> **最接近点对问题**或最接近点**对问题**是[计算几何](https://en.wikipedia.org/wiki/Computational_geometry)问题：给定度量空间中的*n*个点，找到它们之间距离最小的一对点...
> 
> 在假设[地板函数](https://en.wikipedia.org/wiki/Floor_function)可在恒定时间内计算的计算模型中，问题可以在 O( *n* log log *n* ) 时间内解决。如果我们允许随机化与 floor 函数一起使用，问题可以在 O( *n* ) 时间内解决。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-12-02T12:11:46.273

如果您可以从每个点探测出一个恒定的量并使用迭代加深 DFS，那么您永远不会检查比两个最近点更远的距离......并且由于您不依赖于失败的传递，您永远不需要重新计算ID DFS 倾向于的方式。

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2009-04-25T11:36:45.107

**否。 O** ( *n* ^ 2 )中所有点之间的最小距离，因为您必须将每个点与其他点进行比较。从技术上讲，它是*n* * *n* / 2 因为你只需要填充必须填充一半的矩阵。

有更快的算法用于找到给定点的最近邻居。不幸的是，您必须对每个点都执行此操作才能找到最接近的两个点。

# c - “警告：返回使指针从没有强制转换的整数”在C中是什么意思？

> ID：788752
> 
> 赞同：3
> 
> 时间：2009-04-25T11:38:28.143
> 
> 标签：c, compiler-warnings, gcc-warning

我正在用 C 编写一个简单的函数，其目的是获取一个 6 位数字，计算出前 3 位，并在此基础上返回一个“r”、“w”或“o”。

但是，当我编译时，我收到此警告：'return 从指针中生成整数而不进行强制转换'。然后，当我运行程序时，我发现该函数正在返回一个奇怪的字符，它绝对不是我所追求的三个字符之一。

这里发生了什么？提前致谢。

这是我的功能：

```
char
readorwrite(int opcode)
{
    if (opcode >> 3 == 4) {
        return "r";
    } else if (opcode >> 3 == 5) {
        return "w";
    } else {
        return "o";
    }
} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-25T11:41:55.670

问题是“r”、“w”和“o”是字符串常量，这意味着它们的实际类型是char[]或char*。这意味着您的函数实际上将 s 指针返回到一个以零结尾的字符串。对于单个字符，您应该改用“r”、“w”和“o”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-25T11:42:23.157

您返回 a `const char *`，即指向内存中存储字符串“o”的位置的指针，而您应该返回 char 'o'

# c# - 确定文件身份的算法（优化）

> ID：788761
> 
> 赞同：6
> 
> 时间：2009-04-25T11:47:48.947
> 
> 标签：c#, optimization, identity

对此问题的进一步说明：[确定文件身份的算法](https://stackoverflow.com/questions/456175/algorithm-for-determining-a-files-identity)

**回顾**：我正在寻找一种廉价的算法来确定在绝大多数时间都有效的文件身份。

我继续实施了一种算法，该算法为每个文件提供了一个“*非常独特*”的哈希值。

我的算法的工作方式是：

*   对于小于某个阈值的文件，我使用完整文件内容作为身份哈希。

*   对于大于阈值的文件，我会随机抽取 N 个 X 大小的样本。

*   我将文件大小包含在散列数据中。（意味着所有不同大小的文件都会产生不同的哈希值）

问题：

*   我应该为 N 和 X 选择什么值（我应该取多少个随机样本，大小是多少？）我选择了 4 个 8K 的样本，但无法验证算法。我发现快速增加样本量会降低算法的速度（因为搜索非常昂贵）

*   数学一：我的文件需要有多大的不同才能让这个算法崩溃。（具有相同长度的 2 个不同文件最终具有相同的哈希值）

*   优化一：有什么方法可以优化我的具体实现以提高吞吐量（我似乎能够在我的系统上每秒处理大约 100 个文件）。

*   这个实现看起来合理吗？你能想到任何现实世界的例子，这会失败吗？（我的重点是媒体文件）

相关信息：

[我实现的算法](http://gist.github.com/101591)

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T12:16:13.013

我会避免这样的解决方案。我认为两个媒体文件在压缩格式的对应位置具有相同的大小和相同的数据可能几乎是不可能的。但是，如果您必须处理未压缩的图像或波形文件，则无法检测到小的本地更改的可能性会增加。

所以我认为你应该真正散列整个文件。虽然这看起来很昂贵，但如果您可以访问所有文件，则可能不会 - 例如，如果您构建文件服务器或类似的东西。您可以逐步构建哈希。

如果您看到具有唯一文件长度的新文件，只需存储文件长度即可。如果添加了另一个具有相同长度的文件，则逐块计算两个文件的哈希值，直到它们不同。存储文件长度、哈希以及文件的多少块包含在哈希中。每当您检测到匹配的文件长度和散列并且您还没有散列整个文件时，您可以通过添加更多块来扩展散列。

关于表演的一些想法。对于小文件，相同文件长度的机会非常高 - 没有那么多不同的小文件长度。但是散列小文件并不昂贵。

对于较大的文件，文件长度冲突的机会随着可能的文件长度越来越多而下降。对于不同的媒体文件，它们在标题之外直接不同的可能性非常大，因此您只需要对文件开头的一小部分进行哈希处理。

最后，您一定会检测到不同的文件（哈希冲突除外），因为如果需要，您将对整个文件进行哈希处理。

**更新**

对于电影，我认为文件长度实际上是独一无二的，但是重新编码以适应给定介质的文件可能会使这个想法无效 - (S)VCD 电影都将在大约 CD-ROM 容量的小文件长度范围内。

但是对于一般的电影文件，我只会从文件中间散列一个块（可能是 512 字节）。两部不同的电影在同一位置具有相同的图像和声音？除了您操纵文件以使此测试失败之外，几乎不可能。但是您可以轻松地生成文件以使所有确定性采样策略失败 - 所以这并不重要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T12:33:21.867

*   始终在哈希中包含第一个和最后一个文件块。

这是因为它们很可能因文件而异。如果您考虑 BMP，它可能具有相当标准的标头（例如 800x600 图像、24 位、空余），因此您可能希望稍微过冲标头以获取差异化数据。问题是标题的大小差异很大。

最后一个块用于将数据附加到原始文件的文件格式。

*   读入您使用的文件系统原生的大小块，或至少可被 512 整除。
*   始终以可被块大小整除的偏移量读取块。
*   如果您对相同大小的文件获得相同的文件，请对其进行深度扫描（散列所有数据）并记住文件路径以不再扫描它。

即便如此，除非你很幸运，否则你会错误地将某些文件识别为相同的（例如 SQL Server 数据库文件，它是 1:1 的备份副本，仅在几次插入之后；除了 SS 确实写入时间戳......）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-25T12:16:47.630

1.  不要向后搜索并使用 FILE_FLAG_SEQUENTIAL_SCAN（在 Windows 上）打开文件。
    （选择 X 个随机数，然后对它们进行排序）。
2.  为了寻求更远，预读缓存中通常有一些数据。
3.  如果您有大文件，请将您的分区格式化为具有大扇区大小。
4.  您为 Id 返回一个 Guid，必须哈希算法需要超过 128 位。

# c# - C# 字节转换

> ID：788762
> 
> 赞同：1
> 
> 时间：2009-04-25T11:48:03.627
> 
> 标签：c#

当涉及到字节对话时，我感到非常困惑。

我需要做两次转换：

1.我们有一个byte[]数组{ 0x30, 0x31, 0x32, 0x33, 0x34, 0x35 };

如何将其转换为字符串，以便得到“30 31 32 33 34 35”。

2.我们有相同的byte[]数组

现在我需要将其转换为 ASCII（0x30 = 0, 0x31 = 1, 0x32 = 2 等等）

完成后，我应该得到“012345”。

如何进行两种转换？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-25T11:51:33.230

```
var bytearr = new byte[] { 0x30, 0x31, 0x32, 0x33, 0x34, 0x35 };
var str = bytearr.Select(x => x.ToString("x2"));
var ascii = bytearr.Select(x => (char)x); 
```

如果您希望输出为单个`string`（而不是`IEnumerable`s），您可以执行以下操作：

```
var str = String.Join(" ", bytearr.Select(x => x.ToString("x2")).ToArray());
var ascii = new string(bytearr.Select(x => (char)x).ToArray()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T12:33:24.127

1.  这会将数字格式化为十六进制，其中包含空格：

    字符串 r1 = String.Join(" ", array.Select(n => n.ToString("x2")).ToArray());

2.  这会将字节转换为 ASCII：

    字符串 r2 = Encoding.ASCII.GetString(array);

# asp.net-mvc - 如何将蒙版放入文本框中？

> ID：788767
> 
> 赞同：4
> 
> 时间：2009-04-25T11:54:09.947
> 
> 标签：asp.net-mvc

应用程序是 asp.net MVC。

我想使用掩码为日期放置一个文本框。

请参阅此[ajax 控件](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/MaskedEdit/MaskedEdit.aspx)以获得确切的想法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-25T13:40:43.590

jQuery [Masked Input Plugin](http://digitalbush.com/projects/masked-input-plugin/)做得非常好。

# perl - 如何让 mod_perl 在更改时重新加载源文件？

> ID：788770
> 
> 赞同：2
> 
> 时间：2009-04-25T11:56:36.477
> 
> 标签：perl, apache, mod-perl

我正在使用`mod_perl`Web开发。我不想`mod_perl`每次修改 Perl 模块时都重新启动。

我遇到了一个建议使用该`Apache::Reload`模块的解决方案，我从 CPAN 安装了这个模块，进行`httpd.conf`了相应的修改并添加`use Apache::Reload`到我的 Perl 模块中，如文档中所述。

我尝试了“重新加载所有模块”方法，也尝试了在触摸文件时重新加载特定模块的方法，但两者都无法正常工作。

请问是否有人知道`mod_perl`可能阻止此工作的任何其他配置（或任何其他因素）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-09-24T12:46:59.190

我使用 Perrin Harkins 通过 PerlMonks 提供的这个解决方案：

“将 MaxRequestsPerChild 设置为 1，然后在*child*中加载任何可能发生变化的模块，而不是在 parent 中加载（显然仅适用于开发环境）。每个请求都会到达一个新的 child 服务器，这将重新加载所有可能发生变化的模块。”

来自“在运行的 Web 服务器中查看模块更改的更好方法” - [http://www.perlmonks.org/bare/?node_id=794860](http://www.perlmonks.org/bare/?node_id=794860)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-12-18T10:40:31.823

考虑使用 Plack 直接或通过具有 PSGI 驱动程序的框架之一编写您的应用程序。然后，在调试时，使用如下`plackup`工具：

```
$ plackup --server Apache2 -r --app /path/to/your_app.psgi 
```

plackup 文档有更多详细信息，即`.psgi`文件的外观，您的框架文档也应该有所帮助。这是一个使用 Catalyst::Engine::PSGI 的示例

```
# app.psgi
use strict;
use MyApp;

MyApp->setup_engine('PSGI');
my $app = sub { MyApp->run(@_) }; 
```

# algorithm - 对于动态离散节点流控制，什么是好的局部启发式？

> ID：788771
> 
> 赞同：0
> 
> 时间：2009-04-25T11:56:57.380
> 
> 标签：algorithm, flow-control

假设您有一组节点。有些节点是生产者，有些是消费者，有些是路由器。每个节点都有一个最大吞吐量，它定义了它每天可以接受的最大单位数，以及它每天可以发送的最大单位数（在这种情况下，接受和发送不会相互干扰）。每个节点还具有单元存储容量，允许它们处理流量变化。此外，每个节点最多只能与最多 8 个附近节点（在一个平面上）进行外连接，并且相同的限制适用于内连接。

我已经有一个启发式算法，给定一个图表，枚举节点并完成将单元推送到后续节点的足够好的工作。它枚举每个节点，向每个目标节点发送 max(ceil(remaining-sendable-units/remaining-following-nodes), remaining-receivable-units-at-receiver)。

现在我需要一种方法来自动查看节点，并决定图形拓扑应该是什么以获得足够好的流量。我的基本想法是为每个节点分配一个“责任”，最初相当于他们消耗了多少单位。然后将一条边从 n1 添加到 n2 会将 n2 的一些责任交给 n1。但我很快发现节点可以消耗的数量和节点可以接受的数量之间的差异混淆了算法并让我陷入困境。

*编辑* 每个生产者/消费者消耗的数量会随时间变化（低于某个最大值），并且可以添加或删除节点。

有什么简单的想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-25T12:32:16.453

如果您正在寻找“稳态”解决方案，即每天沿给定边缘发生相同流量的解决方案，那么节点上不能有任何资源“储存”（因为这意味着每个储存都在继续以稳定的速度增长，最终变得无限大）。

[所以在这种情况下，我们可以忽略每个节点的存储容量，这个问题与最大流量问题](http://en.wikipedia.org/wiki/Maximum_flow_problem)非常相似，可以在多项式时间内*精确*地解决，没有太大的难度。Wikipedia 链接建议了多种算法——我建议从 Ford-Fulkerson 开始，这并不难实现（其他的可能更容易，但我自己还没有实现）。

要真正将您的问题转化为 Max Flow 问题，您需要做一件事：Max Flow 处理*跨边*流的约束，而不是*节点*上的约束。要将您的“节点吞吐量”约束转换为“边缘吞吐量”约束，只需将每个节点变成 3 个连接成一条线的节点（1 -> 2 -> 3），节点 1 和 2 之间的边的容量等于“节点的“输入容量”，节点 2 和 3 之间的边的容量等于节点的“输出容量”。然后确保节点的所有输入都连接到节点 1，并且所有输出都连接到节点 3。

正如我所说，这将为您提供“稳态”解决方案。通过预先指定天数并利用存储容量，您*可能*可以设计一种策略，在该天数内为您提供更多吞吐量，尽管我怀疑比我更聪明的人可以证明即使这不是可能的。在任何情况下，如果您希望每天在每条边上都有相同的流量，那么您无法比 Max Flow 解决方案做得更好。

# linux - Pthreads 作为 UNIX 中同时控制台输入的标准解决方案？

> ID：788776
> 
> 赞同：0
> 
> 时间：2009-04-25T12:02:29.943
> 
> 标签：linux, multithreading, pthreads

我得到了一个使用 ncurses 为 Linux 编写简单聊天客户端的评估。聊天有两个窗口：一个显示其他客户端所说的内容，另一个处理用户输入。

这里让我感到困惑的是如何处理不断来自套接字并同时等待用户输入的数据。我想到的唯一一个解决方案是使用 pthreads，但我觉得我错过了更合适的东西。

有什么建议么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-25T12:05:14.913

您可以查看`select(2)`系统调用并阅读有关多路复用 IO 的信息。

# java - 如何使用java nio编写完整的服务器客户端通信

> ID：788786
> 
> 赞同：7
> 
> 时间：2009-04-25T12:10:01.000
> 
> 标签：java, sockets, nio

我是java NIO的新手。我必须使用 Java NIO 编写一个简单的服务器客户端通信程序。

是否有任何示例程序或任何链接我可以去哪里？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-29T03:58:03.163

**Apache Mina**
[http://mina.apache.org](http://mina.apache.org)
Apache MINA 是一个网络应用程序框架，帮助用户轻松开发高性能和高扩展性的网络应用程序。

**xSocket**
[http://xsocket.org/](http://xsocket.org/)
xSocket 是一个易于使用的基于 NIO 的库，用于构建高性能、高度可扩展的网络应用程序。

**JBoss Netty**
[http://netty.io/](http://netty.io/)
Netty 项目致力于提供异步事件驱动的网络应用程序框架和工具，用于快速开发可维护的高性能和高可扩展性协议服务器和客户端。

**Sun MicroSystem 的 Grizzly**
[https://grizzly.java.net/](https://grizzly.java.net/)
Grizzly 框架旨在帮助开发人员利用 Java NIO API。Grizzly 的目标是帮助开发人员使用 NIO 构建可扩展且强大的服务器。

**NIO 框架**
[http://nioframework.sourceforge.net](http://nioframework.sourceforge.net)
NIO 框架是一个基于 NIO 的库，它隐藏了普通 NIO 的大部分复杂性。使用 NIO 框架，您可以实现高性能 Java 网络应用程序，而无需处理 NIO 的所有令人讨厌的细节。

**QuickServer**
[http://www.quickserver.org](http://www.quickserver.org)
QuickServer 是一个开源 Java 库/框架，用于快速创建健壮的多客户端 TCP 服务器应用程序。QuickServer 提供了对 ServerSocket、Socket 和其他网络和输入输出类的抽象，它简化了强大网络服务器的创建。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-25T13:00:00.397

你可以看看[Apache Mina](http://mina.apache.org/)。如果你只想学习java NIO，我可能有点难以掌握。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-25T15:25:02.157

*在名为sample*的目录下查看您的 JDK

 ** * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-25T12:48:02.813

如果你的应用程序使用 HTTP，我相信你应该看看[Apache HttpComponents ，当然。](http://hc.apache.org/)可下载的图书馆档案中提供了几个示例。请注意，httpcore、httpcore-nio 和 httpclient 是项目的一部分。

干杯。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-25T14:20:01.563

您应该查看可用的在线教程。[使用 Java NIO 构建高度可扩展的服务器](http://www.onjava.com/pub/a/onjava/2004/09/01/nio.html)看起来特别重要。

IBM 有一个[教程](http://www.ibm.com/developerworks/java/edu/j-dw-java-nio-i.html)（需要注册），而 Sun 有一些 NIO 不同功能的简单[示例](http://java.sun.com/j2se/1.4.2/docs/guide/nio/example/index.html)（不仅仅是客户端/服务器 API）

# java - 为什么这超出了 Java 构造函数和静态初始化程序中的 65,535 字节限制？

> ID：788787
> 
> 赞同：9
> 
> 时间：2009-04-25T12:10:48.080
> 
> 标签：java, jls

**免责声明：我意识到我可以在运行时在 Java 中生成它，这是在对某些代码进行性能测试时非常特殊的情况所需要的。我找到了一种不同的方法，所以现在这只是一种好奇心，而不是任何实际的东西。**

我尝试了以下作为静态字段，作为实例字段，并直接在构造函数中初始化。每次 eclipse 都通知我“构造函数 TestData() 的代码超过了 65535 字节限制”或“静态初始化程序的代码超过了 65535 字节限制”。

有 10,000 个整数。如果每个 int 是 4 个字节（32 位），那不是 40,000 个字节吗？除了仅仅构造数组的数据之外，真的有超过 25,0000 字节的开销吗？

数据是用这个小python生成的：

```
#!/usr/bin/python

import random;
print "public final int[] RANDOM_INTEGERS = new int[] {";
for i in range(1,10000):
    print str(int(random.uniform(0,0x7fffffff))) + ",";
print "};"; 
```

这是一个小样本：

```
public final int[] RANDOM_INTEGERS = new int[] {
    963056418, 460816633, 1426956928, 1836901854, 334443802, 721185237, 488810483,
    1734703787, 1858674527, 112552804, 1467830977, 1533524842, 1140643114, 1452361499,
    716999590, 652029167, 1448309605, 1111915190, 1032718128, 1194366355, 112834025,
    419247979, 944166634, 205228045, 1920916263, 1102820742, 1504720637, 757008315,
    67604636, 1686232265, 597601176, 1090143513, 205960256, 1611222388, 1997832237,
    1429883982, 1693885243, 1987916675, 159802771, 1092244159, 1224816153, 1675311441,
    1873372604, 1787757434, 1347615328, 1868311855, 1401477617, 508641277, 1352501377,
    1442984254, 1468392589, 1059757519, 1898445041, 1368044543, 513517087, 99625132,
    1291863875, 654253390, 169170318, 2117466849, 1711924068, 564675178, 208741732,
    1095240821, 1993892374, 87422510, 1651783681, 1536657700, 1039420228, 674134447,
    1083424612, 2137469237, 1294104182, 964677542, 1506442822, 1521039575, 64073383,
    929517073, 206993014, 466196357, 1139633501, 1692533218, 1934476545, 2066226407,
    550646675, 624977767, 1494512072, 1230119126, 1956454185, 1321128794, 2099617717,
    //.... to 10,0000 instances 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-25T12:53:34.377

以下是使用 {1000001, 1000002, 1000003} 初始化数组的字节码：

```
 5  iconst_3
 6  newarray int [10]
 8  dup
 9  iconst_0
10  ldc <Integer 1000001> [12]
12  iastore
13  dup
14  iconst_1
15  ldc <Integer 1000002> [13]
17  iastore
18  dup
19  iconst_2
20  ldc <Integer 1000003> [14]
22  iastore
23  putfield net.jstuber.test.TestArrayInitializingConstructor.data : int[] [15] 
```

所以对于这个小数组，每个元素需要 5 个字节的 Java 字节码。对于更大的数组，数组索引和常量池中的索引都将使用 3 个字节用于大多数元素，这导致每个数组元素使用 8 个字节。因此，对于 10000 个元素，您必须期望大约 80kB 的字节码。

用 16 位索引初始化大数组的代码如下所示：

```
2016  dup
2017  sipush 298
2020  ldc_w <Integer 100298> [310]
2023  iastore
2024  dup
2025  sipush 299
2028  ldc_w <Integer 100299> [311] 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-25T12:28:03.580

数组字面量被翻译成用值填充数组的字节码，因此每个数字需要更多字节。

为什么不将该数据移出到您在类加载时加载的静态初始化程序块中的资源中呢？这可以通过使用轻松完成`MyClass.class.getClassLoader().getResourceAsStream()`。无论如何，这似乎是它所属的地方。

或者更好的是，使用可用的 Java 工具在静态初始化程序块中创建随机值。如果您需要可重复的“随机”数字，那么只需`Random`每次使用固定但随机选择的数字为实例播种。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-25T12:19:52.803

除了整数的值之外，构造函数和初始化程序还需要包含用于将整数加载到数组中的 JVM 指令。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-25T15:28:32.943

一种更简单、更实用的方法是将数字以二进制格式或文本形式存储在文件中。

我不知道什么 java 以这种方式初始化数组，但它不能有效地初始化大型数组。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-25T12:18:48.407

我认为字符的代码大小超过 65535。不是 10000 个整数占用的内存。

* * *

## 回答 #6

> 赞同：-5
> 
> 时间：2009-04-25T12:15:44.420

我认为这可能是用字母数字表示这些整数所需的内存量。我认为这个限制可能适用于代码本身，因此，每个 int，例如：1494512072 实际上需要 10 个字节（每个数字一个），而不是仅用于 int32 的 4 个字节。

# user-interface - 开发 Web 应用程序与桌面应用程序相比有哪些好处和挑战？

> ID：788788
> 
> 赞同：19
> 
> 时间：2009-04-25T12:11:51.840
> 
> 标签：user-interface

我遇到了经理们的一些问题，因为他们认为（直观地）创建桌面应用程序比创建 Web 应用程序更容易（因为您的限制较少）。但在我看来，由于一些原因，这更加困难：

*   桌面应用程序的文献远小于网络应用程序
*   编码面板和按钮比使用声明性方法 (HTML) 更难
*   http 的无状态特性迫使您以请求/响应的方式重新思考

我正在寻找关于 GUI 与桌面应用程序的可靠推理。我坚信桌面更难开发，因为我有一些工具包的经验，但如果有人愿意做出其他回应，请随时为你的推理奠定基础。

* * *

**编辑**：我恢复了我的原始问题，因为有人对其进行了编辑并且它丢失了原始内容。如果有人选择编辑问题，请发表一些有意义的评论，这样我至少可以知道为什么某些部分被更改了。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-25T14:50:06.513

大多数答案（到目前为止，无论如何）似乎都集中在选择实施的难易程度。应用程序（桌面或基于 Web 的类似应用程序）的全部目标是为最终用户服务。*这*应该是讨论的起点。

在大多数情况下，Web 应用程序根本无法提供与桌面应用程序一样丰富的交互体验。由于可用的小部件、网络延迟、您的应用程序窗口（通常）必须位于另一个应用程序中等等，存在太多限制。

话虽如此，很多时候界面不需要大量的小部件，网络延迟不是什么大问题，在浏览器窗口内运行是一个优势。gmail 和堆栈溢出是不需要特别丰富的界面的基于 Web 的应用程序的主要示例。

因此，在尝试决定使用哪种技术时，首先要考虑用户。他们需要高性能、丰富的用户界面吗？他们是否需要能够毫不费力地通过网络与其他人共享他们的数据？这是他们每天使用八小时的应用程序还是只是随便使用的应用程序？他们会主要使用它来编辑本地文件还是与网络上的人协作？

对于那些说“网络应用程序总是更好”的人，让我问你一个问题：想想你每天使用的工具。您的文本编辑器、编程 IDE、浏览器、电子邮件客户端。其中哪些是网络应用程序？可能没有，除了您的电子邮件客户端。您不希望使用基于 Web 的 IDE 来编写软件（或写一本书，或进行严肃的图像处理）是有原因的。

这一切都归结为用户以及他们的目标是什么。有时他们的需求最好使用基于 Web 的 UI 来满足，有时使用桌面 UI。有时两者都可以。当然，您还需要权衡诸如分发和更新、跨平台可用性等选项，但这一切都始于用户及其目标。如果您专注于满足您的最终用户，答案可能会变得相当明显。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-25T12:16:54.993

恕我直言，Web 开发压力更大……您必须与 Internet Explorer 不符合标准、连接速度慢、奇怪的 css 行为、浏览器漏洞作斗争。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-25T13:22:07.973

大多数时候，开发 Web 应用程序要容易得多，并且会导致一个大问题 - 部署和推出新版本，消失了。

您不必处理不同的操作系统版本、安装的库、注册表、COM 等。您有不同的浏览器要处理，但这没什么大不了的。

我无法想象每个月将桌面应用程序部署到 2-3 百万个客户——这在网站上运行良好。

就Web开发的开发而言，您拥有：

*   更短的执行路径
*   管理较少的状态
*   您几乎不必自己处理并行性
*   需要管理的资源少很多或没有 - 没有操作系统句柄

唯一的缺点是设置开发机器通常需要更多时间，并且 Web 应用程序的调试更难。以目前的工具状态，调试不再是什么大问题。

所以如果可能的话，总是更喜欢网络应用程序。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-25T16:36:52.730

两者之间存在相当多的差异，这会带来挑战或好处。对于网络应用程序：

*   **状态**- HTTP 请求没有状态，需要通过跨所有请求或 cookie 传递会话变量来管理。这是 Web 应用程序的开销，而 ASP.NET 经常因大量会话数据而受到攻击。
*   **集中**式 - 将更改推送到 Web 应用程序就像更新服务器上的位一样容易，而桌面应用程序必须向所有用户推出补丁。集中的性质也使得分析等变得更容易。这是一个很大的方便。我记得 GMail 曾在 4 小时内修复了一个安全漏洞。相比之下，仍然有大量易受攻击的未打补丁的 Windows 机器。
*   **架构**- 胖服务器、瘦客户端使 Web 应用程序平台不可知。它还有助于管理余额……例如，表格排序、错误检查、数学计算或图形（例如在闪存的情况下）可以根据资源分配在客户端或服务器上完成。由于瘦客户端，这意味着可以彻底检修服务器而不影响客户端。这种级别的灵活性真的很方便。
*   **安全**性 - 桌面应用程序在受信任的环境中运行，当 Web 应用程序在沙盒环境中运行时，它们可以自由地做任何事情，这使得它们对客户端而言本质上更安全。但是，Web 应用程序需要一些配置，因为它与证书、activex 控件等有关。
*   **版本控制**- 桌面应用程序的版本控制成本要高得多。这又回到了推出变更的更乏味的过程。再说一次，增加主要版本号意味着通过用户升级增加收入。在 Web 应用程序中，版本控制主要是针对开发人员自己的，并且进行小的迭代增强要容易得多。这就是桌面应用程序仍然遵循瀑布式开发周期的原因，因为推出更改的成本很高，而且您必须在第一时间得到它。桌面应用程序也有向后兼容的成本，例如支持 Windows 98、XP 和 Vista 或支持较旧的处理器、驱动程序等。
*   **环境**- Web 应用程序在可预测的环境中运行，这又非常方便。IE/FF/Opera 等之间存在跨浏览器开发问题，但测试和调试比在具有不同图形处理器、防病毒软件或构建的桌面系统上运行复杂的应用程序要容易得多。
*   **响应性**- 由于回发，Web 应用程序的响应速度较慢，但​​ AJAX 使这变得更容易和更有趣。

我确信我还遗漏了许多其他要点，但这是我对 Web 应用程序开发的偏颇回答。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-25T12:15:08.163

我认为网络更难，你必须担心状态、网络，并更加关注加载、安全等事情。浏览器兼容性、AJax、CSS 的噩梦怎么样？

OTOH 因为桌面的边界较少，所以在设计方面可能会稍微困难一些，因为你有更多的能力——不过我不同意这一点。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-25T12:15:59.863

我认为每个人都有自己的巨大复杂性，这使他们面临独特的挑战，并且根据您问的人，您会得到不同的答案。Web 程序员可能认为桌面应用程序比 Web 项目更难，仅仅是因为不熟悉这种媒介。

桌面用户可能会发现 Web 应用程序更难编写代码，因为他们必须考虑 CSS 和使用 AJAX 协议进行通信的更多设计问题。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-25T12:16:50.843

我非常怀疑 web 程序员需要了解 winapi。我说 GUI 编程需要更多时间来学习。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-25T12:16:53.590

*根据我的*经验， Web 开发更难，你没有轻松维护状态的奢侈；再加上你必须处理格式问题（css很棒，但很难掌握）。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-25T12:43:41.543

我在日常工作中同时从事这两项工作，老实说，开发桌面应用程序的唯一正当理由是因为用户不会一直保持联系。

分发/维护桌面应用程序的问题始终取决于用户，而无需用户参与即可调试 Web 应用程序。这绝不应该被最小化，因为调试爱达荷州的一个用户没有其他用户有的缺陷可能会花费过多的时间。

两者的发展采取了不同的心态。Web本质上是无状态的，而桌面是有状态的。在两者之间切换时，我经常感到沮丧，因为我习惯了一种，然后在另一种中尝试相同的模式/技术，但它失败了。

最终，这取决于您要解决的问题。如果你不能建立一个网络服务器，那么你的选择是有限的。如果您希望用户在西弗吉尼亚州的诡计中使用它，那么您几乎没有选择。

问题中的更多信息会有所帮助，因为这个问题几乎无法涵盖。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-04-25T12:48:36.820

哇，到目前为止，我对答案感到惊讶。我已经做过这两个，过去的桌面和现在几乎所有的网络。我发现 Web 开发更容易开发，更容易支持，更容易推出和部署。

如果有可能在网络上进行，我永远不会选择在桌面上开发一些东西。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-04-25T13:22:29.390

桌面应用程序是要走的路。当前的 Web 技术（HTML、Javascript、HTTP 等）在设计时从未考虑到应用程序。它是为文档而设计的。你会感觉到你写的每一行代码。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-04-25T12:17:25.303

使用桌面应用程序，您不必像在 Web 上那样处理应用程序状态等问题。HTTP 是一种无状态协议，因此开发人员的工作是确定如何为用户会话维护应用程序的当前状态。桌面可以使用 TCP/IP 并保持与服务器的连接。

使用网络，创建引人注目的用户界面非常容易，因为您可以使用 Javascript、Flash 等添加动画。当应用程序以数据为中心并且应用程序状态是一个问题时，开发人员的工作量会更大。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-04-26T07:37:25.313

这一切都取决于：

1.  您的开发人员体验如何？
2.  您需要做什么类型的应用程序？

还有——你所说的网络应用程序是什么？Silverlight 或 Flash 应用程序都可以这样完成，您可以从桌面或浏览器使用它。今天的 Ajax 应用程序与桌面应用程序没有太大区别，但是使用 DHTML 开发不太简单的东西要困难得多（即使您正在使用像 jQuery 甚至 GWT 这样的框架）。

假设 HTML 或 DHTML 作为 Web 应用程序：

我在 web/ajax 和桌面开发方面花了很多年，我的经验是一样的——我做过很多复杂的 web 应用程序和桌面应用程序。拥有良好的 C# 工具包和工具以及足够的经验，我可以在相同或更短的时间内创建比 Web 更好的桌面应用程序。但是某些类型的应用程序不能作为桌面应用程序来完成，因为需要将它们作为 Web 应用程序来完成。

**桌面开发更简单的原因：**

1.  语言类型安全，代码提示
2.  代码性能 x10-1000 + 性能分析器
3.  无需检查所有浏览器中的所有内容
4.  带有堆栈跟踪、编辑和继续的信息异常
5.  能够使用多线程（如果您知道如何使用它）
6.  代码的整体可预测性和稳定性
7.  RAD 工具

长期以来，Web 应用程序的几个优点是：

1.  GUI 框架 - HTML+CSS
2.  用户上手更容易
3.  搜索引擎可以找到应用程序的内容

现在我们都有强大的 GUI 框架，例如用于 WPF/Silverlight 应用程序的 XAML。Silverlight/Flash 应用程序（我将其视为桌面应用程序）可以涵盖第二点。第三个可以为 RIA 完成，但需要一些努力（同样适用于 ajax 应用程序）。

If you're targeting something simple and don't know modern desktop/ria development tools and techniques that might be another good reason for developing web application. But as I've said - I hope it would be something simple.

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-04-25T13:39:38.353

这两种应用程序都有优点和缺点。例如，Web 应用程序可能需要考虑不同的浏览器，并且在 Web 中获得可用的 UI 比在 Windows 窗体中更难。但是，Web 应用程序也确实有一些优势。首先想到的是部署，无需担心不同的平台（只是不同的浏览器 - 是的，为不同的平台开发比为不同的浏览器开发更难）。

# iframe - Thickbox 如何显示另一个页面，例如登录页面？

> ID：788795
> 
> 赞同：0
> 
> 时间：2009-04-25T12:16:17.257
> 
> 标签：iframe, thickbox

我问这个是因为我想在 iframe 中显示一个页面，并且在单击 iframe 内容中的任何链接时，它应该在同一个 iframe 中显示它。

检查这个[网站](http://www.samisite.com/test-csb2nf/id82.htm)。看看 iframe 如何让我浏览其他网站。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T12:22:26.773

这没什么特别的，这就是 iframe 的工作方式。

但是，如果这些网站中的任何一个有

```
<a href="LINK" target="_top">text</a> 
```

它将脱离 iframe 并加载到主页中。

我知道无法阻止 iframe 使用 target=_top 链接接管您的窗口。您不能从父窗口修改 iframe 中其他人的内容，谈论交叉框架存在安全问题，阻止您这样做。

使用Thickbox 只需加载您的html 文件并确保您不要在任何要保留在iframe 中的thage 页面中定位=_top。

因此，使用一些 jQuery 从ThickBox 的示例中复制和粘贴：

```
<script>
  var height = 300;
  var width  = 300;
  $(function(){
     $("#execute").click(function(){
         $("#link1").attr('href',$('#go').val() + "?height=" + height *"&width=" + width).trigger('click');
     });
  });
</script>

<input type="text" name="go" id="go" />
<button id="execute">Go >></button>

<a id="link1" href="ajaxOverFlow.html?height=300&width=300" title="add a caption to title attribute / or leave blank" class="thickbox">Scrolling content</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T12:37:53.757

[Facebox](https://github.com/defunkt/facebox)插件将以厚盒方式拉入远程页面。

# visual-studio - 最佳 Visual Studio 2008 调试教程？

> ID：788807
> 
> 赞同：3
> 
> 时间：2009-04-25T12:23:20.173
> 
> 标签：visual-studio, debugging

VS 2008（更准确地说是 C#）有没有好的调试教程？我在网上找到了很多资源，但它们仍然缺乏全面的、循序渐进的方法。你有什么建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-25T12:53:33.267

看看这些[系列](http://blogs.msdn.com/brunoterkaly/archive/2009/02/08/the-art-of-debugging-a-developer-s-best-friend-intro-lesson-1.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-25T12:44:07.830

这些并不是 Visual Studio 2008 特有的，但在使用 VS2008 进行开发时，它们的信息肯定仍然有效。

为了让您立即开始，请查看[Tess Ferrandez](http://blogs.msdn.com/tess/)，她有很棒的“入门”实验室。这些可能会逐步解决您的需求，并且是基于场景的。

当您寻找更多详细信息时，请阅读 John Robbins [“调试 Microsoft .NET 2.0 应用程序”](https://rads.stackoverflow.com/amzn/click/com/0735622027)的副本。John 涵盖了相当多的 Visual Studio IDE 功夫，这可能正是您想要的。

如果这还不够，而且你不介意你的大脑融化，你可以拿起Mark Russinovich 和 David Solomon的[“Microsoft Windows Internals (4th Edition): Microsoft Windows Server 2003, Windows XP, and Windows 2000”](https://rads.stackoverflow.com/amzn/click/com/0735619174) . 看起来他们在 2009 年 6 月发布了更新版本。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-25T12:27:03.720

MSDN 为 Visual Studio 中的应用程序开发提供了全面的资源 -[构建、调试和测试](http://msdn.microsoft.com/en-us/library/d8k88a0k.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-25T12:44:29.000

有几本书涵盖了 Visual Studio 和 .NET 调试的更高级用法。其中一些包括对更高级场景的 WinDBG 的覆盖。

我从中学到很多东西的是 John Robbins（MS Press）的“调试 Microsoft® .NE​​T 2.0 应用程序”。

# security - 用于保护网站（使用 SSL）时，数字证书如何工作？

> ID：788808
> 
> 赞同：21
> 
> 时间：2009-04-25T12:24:57.767
> 
> 标签：security, ssl, certificate

请帮助我了解这个过程是如何进行的。我了解 Web 浏览器包含证书颁发机构 (CA) 的根证书，例如 verisign、Entrust、Comodo .. 等，但是当用户访问安全页面时究竟会发生什么？Web 浏览器是否向 CA 的服务器发送请求以验证证书，或者它只是使用 CA 的根证书（在浏览器中）来验证证书？

我使用了一些 HTTP 嗅探器并登录到 gmail（登录页面是安全的），但没有看到请求转到除 google 以外的任何网站，这是否意味着它只使用 CA 的根证书？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-25T12:33:51.317

证书颁发机构颁发使用*私钥*签名的证书。您的浏览器存储了一组受信任的 CA的相应*公钥。*当您收到安全交易请求时，您的浏览器会使用公钥检查证书的根（由您连接的主机提供），以确保它确实由匹配的私钥签名。

主机存储由受信任的第三方 (CA) 签名的证书，您的浏览器存储同一第三方的公钥。当交易开始时，主机只需要出示该证书供您的浏览器进行验证。受信任的第三方无需进行交易时间干预。

这与 PGP 等系统不同，在这种系统中，您必须联系第三方才能获得与您通信的任何人的公钥。这些系统的工作方式可能不同，因为使用 PGP 您正在加密/解密数据。有了证书，您所做的就是验证身份。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-04-12T14:17:51.810

Web 浏览器有它信任的根证书列表。这些是 CA 的公钥。浏览器表示您可以相信这些 CA 的私钥实际上是私有的，并且任何已被其中一个私钥加密的内容（包括所谓的 Web 服务器证书）确实来自 CA。

该证书包含 Web 服务器的公钥和 Web 服务器的地址（和公司名称等），由 CA 的私钥加密。当网站所有者从 CA 购买证书时，此加密完成一次。之后，网站所有者将证书保存在手边，以便在您发出 https 请求时发送给您。由于您的浏览器能够使用 CA 的公钥（已经在您的机器上）来解密 Web 服务器发送的证书，并在解密的证书中看到该证书包含与 https 服务主机匹配的主机地址，浏览器断定主机的公钥（使用 CA 的公钥解密）是真实的。网络主机通常发出的证书可能仍然来自一些随机欺骗主机的人，

然后，您可以发送使用主机公钥加密的数据（例如您的信用卡号），并且只有主机的私钥才能解密您的数据。交易期间无需与 CA 进行通信。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-25T12:39:12.723

这取决于您的浏览器/操作系统配置。基本上，浏览器或操作系统都有一个受信任的根权限列表（Mozilla 有自己的列表，IE 使用 Windows 的列表）。

当 SSL 握手发生时，会检查站点证书以查看它是否由受信任的机构之一签名，以及服务器名称是否与证书中的名称匹配。

接下来会发生什么取决于浏览器或操作系统配置。CA 具有撤销列表功能（它可以是一个大列表或一个单独的服务 (OCSP)，您可以在其中询问证书是否仍然有效）。如果您的浏览器/操作系统被配置为检查这一点，那么这个额外的步骤将会发生。

Firefox 和 Windows 将默认检查 OCSP 服务是否可用，默认情况下都不检查 CRL 列表。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-25T12:31:10.560

CA 签署 Web 服务器证书。由于浏览器已经拥有 CA 公钥（在根证书中），它可以在不访问 CA 的情况下验证其真实性。唯一需要 CA 访问权限的就是检查证书是否被吊销。

# flash - 将 youtube 视频 ID 从视频提要传递到 Flash

> ID：788810
> 
> 赞同：0
> 
> 时间：2009-04-25T12:25:46.157
> 
> 标签：flash, actionscript-2, youtube-api

我正在为我的荣誉项目开发一个 Flash Web 应用程序 (Actionscript 2.0)，但在嵌入 youtube 视频时遇到了麻烦。基本上，用户根据所选符号选择带有特定标签的 youtube api 查询符号，然后从前 30 个视频中挑选一个随机视频。我使用以下代码进行此工作：

```
on (release) {
url="http://gdata.youtube.com/feeds/api/videos?q=danger+passion&orderby=published&start-index="+random(30)+"&max-results=1&v=2"
getURL(url);
} 
```

但这只是显示一个带有 youtube 视频链接的网页。

这是我将用作播放器基础的代码：

```
// create a MovieClip to load the player into
var ytplayer:MovieClip = _root.createEmptyMovieClip("ytplayer", 1);

// create a listener object for the MovieClipLoader to use
var ytPlayerLoaderListener:Object = {
onLoadInit: function() {
// When the player clip first loads, we start an interval to
// check for when the player is ready
loadInterval = setInterval(checkPlayerLoaded, 250);
}
};

var loadInterval:Number;

function checkPlayerLoaded():Void {
// once the player is ready, we can subscribe to events, or in the case of
// the chromeless player, we could load videos
if (ytplayer.isPlayerLoaded()) {
ytplayer.addEventListener("onStateChange", onPlayerStateChange);
ytplayer.addEventListener("onError", onPlayerError);
clearInterval(loadInterval);
}
}

function onPlayerStateChange(newState:Number) {
trace("New player state: "+ newState);
}

function onPlayerError(errorCode:Number) {
trace("An error occurred: "+ errorCode);
}

// create a MovieClipLoader to handle the loading of the player
var ytPlayerLoader:MovieClipLoader = new MovieClipLoader();
ytPlayerLoader.addListener(ytPlayerLoaderListener);

// load the player
ytPlayerLoader.loadClip("http://www.youtube.com/v/pv5zWaTEVkI", ytplayer); 
```

谁能帮我从提要中获取视频的 ID（例如：pv5zWaTEVkI）？或者如何从 Flash 发送查询，该查询将返回视频 url/id，而不是 feed 的 url。任何帮助将不胜感激，因为我很快就会介入。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T12:35:45.323

您得到的不是网页，而是[RSS 提要。](http://gdata.youtube.com/feeds/api/videos?q=danger+passion&orderby=published&start-index=1&max-results=1&v=2)

如果您只想要 youtube 视频 ID，您可以拆分您得到的字符串`watch?v=`，视频字符串应该由第一个字符组成，直到 '（逗号）

```
href='http://www.youtube.com/watch?v=aFyfbcZqdck' /><link 
```

您可以通过拆分此字符串来练习。

# c++ - 编写一个简单的解析器

> ID：788814
> 
> 赞同：12
> 
> 时间：2009-04-25T12:29:42.483
> 
> 标签：c++, parsing, dsl

我需要为一种领域特定语言编写一个简单的解析器。
它需要具有适当的运算符评估顺序的基本算术和调用可以重载的底层环境函数的语法。
编写这样一个解析器的最简单方法是什么？有什么东西我可以开箱即用地适应或使用吗？我正在用 C++ 编写。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-25T12:35:24.263

看看[Boost Spirit](http://spirit.sourceforge.net/distrib/spirit_1_8_5/libs/spirit/doc/quick_start.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-07-15T00:15:00.837

请参阅 MetaII 解析器技术。本教程将引导您完成所有内容：

[http://www.bayfronttechnologies.com/mc_tutorial.html](http://www.bayfronttechnologies.com/mc_tutorial.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-25T12:31:52.273

[ANTLR](http://www.antlr.org/)会帮助你很多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-25T12:33:08.387

我用[Ragel](http://www.complang.org/ragel/)解析了一些数据。它对我来说效果很好。

# c# - 从不同的线程调用

> ID：788828
> 
> 赞同：0
> 
> 时间：2009-04-25T12:35:57.897
> 
> 标签：c#, winforms, invoke

我不敢相信，这在我的其他应用程序中有效，但在这个具有类似结构的应用程序中 - 它没有！

```
 public string ListAdd
    {
        set
        {
            if (listView1.InvokeRequired)
            {
                this.Invoke((MethodInvoker)delegate
                {
                    listView1.Items.Add(value);
                });
            }
            else
            {
                listView1.Items.Add(value);
            }
        }
    } 
```

我这样称呼它：

```
 var formz = Form.ActiveForm as Form1;
        if (formz != null)
            formz.ListAdd = "asdasdasdasd"; 
```

如果我从通过 TCP 接收数据包的函数（我想把它放在 listView 上）调用它 - 什么都不会发生，但是如果我在初始化 WinSock 的同一个类中调用它 - 它可以工作。

问题可能出在哪里？

**编辑：** 我刚刚调试了应用程序，formz 在我调用它的地方为空（接收函数）。为什么它在那里为空，但在其他任何地方都没有？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T13:18:39.930

我不认为它会解决您的问题，但是您是否考虑过使用以下模式进行调用？我认为它更具可读性。创建此扩展方法。

```
public static class ControlExtension
{
   public static void ThreadSafeInvoke(this Control control, MethodInvoker method)
   {
      if (control != null)
      {
         if (control.InvokeRequired)
         {
            control.Invoke(method);
         }
         else
         {
            method.Invoke();
         }
      }
   }
} 
```

然后你可以像这样执行线程安全的方法调用。

```
Form form = new Form();

form.ThreadSafeInvoke(() => form.Text = "ThreadSafeInvoke"); 
```

或者一次打多个电话。

```
form.ThreadSafeInvoke(() =>                 
{
   form.Text = "ThreadSafeInvoke";
   form.Visible = true;
   form.WindowState = FormWindowState.Maximized;
}); 
```

**更新**

所以问题显然`Form.ActiveForm`又回来了`null`。

1.  通话时没有活动表格。
2.  该线程无权获取活动表单 - [MSDN](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.activeform(loband).aspx)声明[UIPermission](http://msdn.microsoft.com/en-us/library/system.security.permissions.uipermission.aspx)是必需的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T12:47:21.567

如果 ActiveForm 返回 null，那么您可能没有活动表单，或者它不是 Form1 类型。您正在使用“as Form1”，因此如果您有一个处于活动状态的 Form2，则 formz 将设置为 null。

您可以将 formz 传递给函数而不是调用 ActiveForm 吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-06-08T07:26:25.423

检查您是否处于调试模式；如果是这样，则返回的*活动表单*值将为空。

# database - 如何在分片数据库中创建唯一的行 ID？

> ID：788829
> 
> 赞同：6
> 
> 时间：2009-04-25T12:37:40.887
> 
> 标签：database, sharding

在非分片数据库中，我可以只使用自动增量来生成唯一 ID 来引用特定行。

我想对我的数据库进行分片，比如分成 12 个分片。现在，当我插入特定分片时，自动增量 ID 不再是唯一的。

想听听任何人处理这个问题的经验。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-25T12:41:14.250

几种方法

1）给每个分片自己的ID，并使用复合键

2) 给每个分片自己的 ID 并为每个分片设置 ID 范围

3) 使用全局唯一 ID - GUID

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-25T12:48:01.720

我用来解决这类问题的两种方法：

*   GUID：易于实现，但可以创建更大的表和索引。
*   ID 域：我提出了这个术语，但基本上它意味着将整数类型的 32（或 64）位分为两部分，顶部代表一个域。用于域的位数取决于您想要支持的域数与您希望单个域引入的记录数。在这种方法中，您为每个分片分配一个域。不利的一面是数据库（我知道）不直接支持这种方法，您需要自己编码 ID 分配。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-25T12:43:21.107

1）你可以两行（一个表示ID，第二个表示数据库ID）

2) 使用指南

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-28T06:31:05.673

我有同样的困境。我想我会选择一个 redis 解决方案。我将使用[redis-cloud.com 之](http://redis-cloud.com/)类的服务来生成唯一 ID。所以我仍然可以对插入到我的分片表中的每个数据使用 bigint。IT 将是连续的，因此不会发生页面拆分。此外，分页现在很容易做到。它解决了我的友好 URL 问题，因为我不想在 URL 中使用 GUID。此外，Redis 云是一个可扩展的解决方案，非常可靠并且具有自动故障转移功能。

我不需要决定拆分数据的范围，我只需在主键上使用 MD5 哈希在分片之间平均划分数据。对于 HA，我决定使用 Amazon RDS 进行简单的时间点备份/恢复和复制。

我认为 Flickr 使用了相同的技术，但他们有两个生成器，一个用于奇数，另一个用于偶数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-02-03T06:42:29.997

将数据库保持在[一致的哈希循环](https://www.toptal.com/big-data/consistent-hashing)中会有所帮助。这样，您可以确保每个 db 只需要处理一定范围的 id(s)。所以没有两个数据库会有任何共同的ID。这也解决了从系统中添加和删除数据库的问题。

# iphone - iPhone - 如何获取用户的日期格式

> ID：788833
> 
> 赞同：2
> 
> 时间：2009-04-25T12:38:13.150
> 
> 标签：iphone, cocoa-touch, locale

我如何知道用户喜欢什么日期格式？有没有办法从手机的本地设置中读取它？用户是否喜欢以“dd/mm/yyyy”或“mm/dd/yyyy”格式读取日期？

先感谢您。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-09-03T08:53:09.850

使用 NSDateFormatter，但设置样式（不是格式），使其使用用户的区域设置格式。

例如，创建一个 NSDateFormatter 并对其进行配置

```
[dateFormatter setDateStyle:NSDateFormatterShortStyle]; 
```

（对于 mm/dd/yy 类型的日期，在其他国家是 dd/mm/yy）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-25T12:46:22.443

> CFDateFormatter 定义了几种日期和时间格式样式——短、中、长和完整。它还定义了一种“无”样式，您可以使用它来抑制组件的输出。“使用日期格式样式”中说明了样式的使用。日期和时间样式没有指定确切的格式——它们取决于区域设置、用户首选项设置和操作系统版本。如果您想要精确的格式，请使用 CFDateFormatterSetFormat 函数更改格式字符串，如“使用日期格式字符串”中所示。</p>

[CFDateFormatter](http://developer.apple.com/iphone/library/documentation/CoreFoundation/Conceptual/CFDataFormatting/Articles/dfCreatingCFDateFormatters.html)

应该做的伎俩。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-26T10:34:22.533

你真的想知道确切的格式，还是只是根据它在 NSDate 和 NSString 对象之间进行转换？如果是后者，那么 NSDateFormatter 就是你的人选，它会根据用户的喜好自动生成正确的格式。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-09-03T09:03:33.867

以防万一您需要在格式化日期之前进行区域设置，您需要使用 NSLocale，如下所示：

```
NSLocale *locale = [NSLocale currentLocale]; 
```

这包含有关当前语言环境设置的大量信息 - 阅读文档以获取详细信息。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-09-30T13:42:18.210

要知道用户喜欢哪种格式：我使用了 [[dateFormatter locale] localeIdentifier] 。如果它返回 en_US，则表示日期为 mm/dd/yyyy 格式，否则为 dd/mm/yyyy 格式。dateFormatter 是 NSDateFormatter 类的一个实例。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-01-22T01:03:20.730

Vishwa，美国不是唯一使用“mm/dd/yyy”格式的国家，“dd/mm/yyyy”也不是唯一的选择。

有关更多信息，请参阅[http://en.wikipedia.org/wiki/Calendar_date#List_of_the_world_locations_by_date_format_in_use](http://en.wikipedia.org/wiki/Calendar_date#List_of_the_world_locations_by_date_format_in_use)。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-08-07T11:48:23.360

从 iOS 6 开始，您可以使用“localizedStringFromDate”

```
NSString*localizedDate = [NSDateFormatter localizedStringFromDate:[NSDate date] dateStyle:NSDateFormatterShortStyle timeStyle:NSDateFormatterShortStyle]; 
```

# java - 仅从密封 JARS 加载的 Java 插件框架

> ID：788834
> 
> 赞同：1
> 
> 时间：2009-04-25T12:38:36.360
> 
> 标签：java, encryption, plugins, frameworks, cryptography

我希望在运行时加载 JAR，但如果 JAR 既没有签名也没有密封，我希望加载失败。我知道 Java JCE 在加载新的加密算法时具有此功能。是否有任何插件框架已经支持此功能？否则，最好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T12:45:03.477

OSGi 有一个定义明确的逻辑安全模型来加载签名的 jars（不知道密封的）。尽管 OSGi 不仅仅是一个插件框架，但您会发现需要进行大量重构工作。

非常值得努力 :)

# java - Java中的WaitForMultipleObjects

> ID：788835
> 
> 赞同：4
> 
> 时间：2009-04-25T12:38:58.950
> 
> 标签：java, concurrency

在Java（v6）中实现WaitForMultipleObjects的Win32等价物最优雅的方法是什么。一个线程正在休眠，直到发生几个事件之一。当这种情况发生时，我想处理它并重新入睡。不需要数据，只需一个事件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-25T12:56:31.263

这真的取决于你想用它做什么，但你可以做一些简单的事情，比如使用等待/通知方法，或者你可以使用 java.util.concurrency 包中的结构。后者将是我个人的选择。您可以轻松地设置一个 BlockingQueue，您可以让生产者将事件对象放入其中，而消费者则阻止删除事件。

```
// somewhere out there
public enum Events {
  TERMINATE, DO_SOMETHING, BAKE_SOMETHING
}

// inside consumer
Events e;
while( (e = queue.take()) != TERMINATE ) {
  switch(e) {
    case DO_SOMETHING:
      // blah blah
  }
}

// somewhere else in another thread
Events e = BAKE_SOMETHING;
if( queue.offer(e) )
   // the queue gladly accepted our BAKE_SOMETHING event!
else
   // oops! we could block with put() if we want... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T13:28:42.870

您可以使用**java.util.concurrent**包提供的**CountDownLatch**对象

 **[http://rajendersaini.wordpress.com/2012/05/10/waitformultipleobject-in-java/](http://rajendersaini.wordpress.com/2012/05/10/waitformultipleobject-in-java/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-25T12:55:27.193

~~只需猜测 Object.wait()、Object.notify() 和 Object.notifyAll() 就足够了。~~

# java - 基于身份的加密和开源

> ID：788844
> 
> 赞同：0
> 
> 时间：2009-04-25T12:46:15.627
> 
> 标签：java, encryption, cryptography, aes, jce

我最近遇到了基于身份的加密 (IBE) 的概念，这似乎是一个新颖的想法。但是，我没有注意到密码学社区中有很多人试图找到破解它的方法。我错了吗？

同样，我相信除非你能真正分发开源实现，让黑帽人群可以攻击它，否则它可能没有优点？

我想我想了解整个社区在使用这种方法时的经验，以及将其整合到您的应用程序和分发中有多容易？

（编辑：这是一篇关于基于 ID 的加密的[维基百科文章。）](http://en.wikipedia.org/wiki/Identity_based_encryption)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-25T17:22:49.923

我不清楚你想问什么，所以我将编造几件事，然后回答。让我知道我是否暖和起来

首先，“基于身份的加密”与其说是一种加密方案，不如说是一种密钥管理方案。在任何公共/私人（或技术上的“非对称”）加密中，都有两个密钥。其中一个用于加密，一个用于解密，并且它们具有特殊属性，即如果您知道其中一个，则构建另一个仍然是指数级困难（或被认为是指数级困难）。因此，例如，我可以使用我的私钥加密给你的一封信；我发布了我的公钥。如果您可以使用公钥解密这封信，您就可以确定我是真正发送它的人。这是数字签名方案的核心思想。

问题是您必须有一种方法来生成和管理这些密钥，这很困难，因为该方案仅与您对私钥的保护一样好。有许多方法可以做到这一点。

基于 ID 的加密试图通过提出特殊算法来简化此[密钥管理](http://en.wikipedia.org/wiki/Key_management)问题，这些算法从已知的公共信息（例如电子邮件地址）构造私钥。要以一种仍然难以弄清楚私人方面的方式做到这一点，您需要有一个受信任的实体，该实体根据他们知道的其他一些秘密构造私钥。因此，要与知道您的电子邮件地址的人建立联系。您去受信任的提供商并要求生成私钥。您想与之通信的人知道您使用的提供者，并从该提供者那里获得*主公钥*。

现在，您要发送给的人可以从您的 ID 生成公共端，除了来自提供商的一些主密钥信息外，什么都不知道；关键永远是传输方向。

换句话说，它看起来像这样：Alice 想要向 Bob 发送加密的电子邮件。他们都信任提供者汤姆。

*   Alice 使用她的电子邮件地址“alice@example.com”向 Tom 发送请求，并取回私钥*P。*有一个对应的公钥*p*，但*汤姆没有将它发送给任何人。*
*   Bob 向 Tom 发送请求并获取 Tom 的*主公钥* *m*。
*   Alice 用她的私钥加密她的消息“x”，得到 {"x"} *P*。（该符号只是“消息“x”“包装”或使用密钥*P*加密。）然后 Alice 将该消息发送给 Bob。
*   Bon 使用他对 Alice 的电子邮件地址和 Tom 的主密钥*m*的了解，并计算。*p=f* ("alice@example.com", *m* )。现在他应用解密decrypt({"x")P, p) 和噗，Alice 的消息出来了。

这些方案的问题在于它简化了一些关键管理问题，但只是在一定程度上。你仍然需要生成密钥，更糟糕的是，你必须**真正**信任 Tom，因为他无所不知：他可以生成你的私钥，并用它加密，让任何消息看起来像是来自你。这意味着它创建了一个固有的密钥托管方案；可以找到你的私钥。

在某些方面这很好；它处理丢失钥匙的问题。但出于大多数原因，人们想要使用加密，这很糟糕。现在有人可以传唤汤姆，或者只是殴打他，然后获取您的私人数据。

结果是，仅基于 ID 的加密是一个不错的想法，但并没有很大的市场。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-25T18:09:11.417

查理走在正确的轨道上，但我想强调其他几点。（我的评论是根据查理的答案的一个更早的、更短的版本写的。）IBE 与其说是一种加密方法，不如说是一种密钥管理方案，它的密钥管理方法扫除了地毯下的重要问题。尝试使用身份作为基础是充满问题的，因为无论是在网络上还是在物理世界中，都没有真正好的解决方案来验证电子应用程序中的身份。如果没有一个好的身份解决方案，一旦你强调他们所依赖的身份，这些 IBE 计划就会落空。

我见过的大多数 IBE 系统的任何技术细节都真正转向“信任提供者”，当你真正关心它时，它不会扩展并且不会提供真正的安全性。提供者努力通过网络建立身份，然后充当受信任的第三方，为每个人持有加密密钥。依赖受信任的第三方有许多已知的弱点。

现代密码学就是寻找不必依赖第三方的方法。Web of trust 是一种方法，主要缺点是它将密钥管理留给最终用户，而且密钥管理成本很高。依赖证书颁发者是另一种方法，但很明显，颁发者是受信任的第三方。几年前，所有浏览器都信任的主要问题之一破产了，并被一个明显不值得信任的玩家从破产中收购，这清楚地表明该方案的弱点是证书链的根源.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-25T23:39:13.573

基于身份的加密在开源项目中很难实现，尤其是那种不仅像自由一样免费，而且像啤酒一样免费的加密。如前所述，整个系统依赖于受信任的第三方来发布密钥。这需要购买和维护昂贵的硬件和软件基础设施。此外，它还给颁发密钥的一方带来了很多责任。使用该系统的人会期望发行人在出现问题时承担责任（他们会）；这种责任并不便宜，而且对于开源项目来说通常是不可行的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-25T15:34:09.730

你有什么特别的计划吗？“基于身份的加密”是一个相当广泛的术语。

但无论如何，你可能没有看到这么多的关注，因为它本身在密码学上并不那么特别。密码学的一般原则仍然适用，例如加密密钥中有多少位熵？如果要在基本上无限期使用相同的密钥，那么基于大量明文/密文的碰撞攻击和其他攻击的风险是什么......？

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-01-03T19:11:36.573

试试看。[_](https://sourceforge.net/projects/jpair/) 好的和简单的解决方案。

# c# - Resharper 将对象更改为接口

> ID：788848
> 
> 赞同：4
> 
> 时间：2009-04-25T12:46:52.240
> 
> 标签：c#, visual-studio, refactoring

我有一个升级的 3rd 方库，曾经有一个名为 Foo 的对象，现在它是一个名为 IFoo 的接口

将 Foo 的所有用法和声明更改为 IFoo 的最佳方法是什么

我尝试进行查找/替换，但这也影响了 FooBar 到 IFooBar （我不想要）

想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-25T13:13:07.497

它绝对适用于 R# 4.5。

1.  右键单击您的 Foo 类。
2.  在可能的情况下选择重构/使用基本类型..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T16:23:36.943

正如其他人所说，ReSharper 可以满足您的要求。

顺便说一句，一定要获取并打印出 ReSharper 键盘快捷键。有两种变体：[Visual Studio 方案](http://www.jetbrains.com/resharper/docs/ReSharper40DefaultKeymap.pdf)和[IDEA 方案](http://www.jetbrains.com/resharper/docs/ReSharper40DefaultKeymap2.pdf)（我认识的大多数人都使用 IDEA 方案）。

但是您真正需要知道的只有两个键盘组合：重构：Ctrl+alt+R 从此处导航：Ctrl+alt+G 或 Alt+'（取决于键盘方案）

这将使您获得许多最有价值的 ReSharper 功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-25T12:49:57.660

您应该能够右键单击 Foo 引用并选择“重构此”-> 重命名，它将更改它可以找到的所有引用。从未使用 3rd 方库执行此操作，但可以在其他地方工作。

# resources - Applet 从不同的域加载 jar；从 jar 加载资源（例如图像）时出现问题

> ID：788854
> 
> 赞同：2
> 
> 时间：2009-04-25T12:49:03.280
> 
> 标签：resources, applet, load, dns

我有一个沙盒小程序，但这不应该有所作为。

Applet 由 2 个罐子组成。如果我将两个文件都托管在同一个 domain1 上，一切都很好。由于某些特殊情况，我需要将 jar2 托管在不同的 domain2 上。

在小程序标签中，我列出了两个文件 archive="jar1.jar, [http://domain2.com/jar2.jar](http://domain2.com/jar2.jar) "。

首先，它似乎工作得很好。两个罐子都已加载，一切正常。尽管如此，只要我尝试从其中一个 jar 中访问资源（如图像），就会出现问题。

如何从我的 jar 中获取资源？我首先通过获取资源位置的 URL 来获取资源：

公共静态 URL getURL(String name) {return ResUtils.class.getResource(path);}

如果我在 domain1 上托管两个 jar，则此方法返回一个 URL。当托管在两个域上时，getURL(...) 返回 NULL，然后在获取资源时导致异常：

```
Caused by: java.lang.IllegalArgumentException: input == null!
    at javax.imageio.ImageIO.read(Unknown Source) 
```

我猜 ResUtils.class.getResource 使用它的 Classloader 返回一个 URL。出于某种原因，在两个域上托管两个 jar 时，添加对 getRessource() 的调用返回 NULL。

所以我的问题是：

*   为什么 getURL 返回 NULL？

Java 插件是否旨在禁止在不同域中托管这些 jar？当我将 jars 托管在不同的域上时，如何加载我的资源？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T16:43:26.350

尝试这样的事情：

```
 ClassLoader cl = Thread.currentThread().getContextClassLoader();
      URL url = cl.getResource("imagename.gif");
      System.out.println("URL is: " + url);
      ImageIcon icon = new ImageIcon(url); 
```

使用上下文类加载器通常是从 jar 文件加载图像的最佳方式。

Edit1：顺便说一句，我很惊讶第一个建议没有奏效。如果我没记错的话，Thread.currentThread().getContextClassLoader() 建议应该给你一个类加载器的引用，这个类加载器可以从任一 jar 文件中找到资源。

Edit2：在这种情况下，上述方法均无效。好奇心战胜了我，所以我不得不尝试一下。插件类加载器似乎太混乱了，无法从托管在另一台服务器上的 jar 文件加载资源，即使加载类没有问题。我发现手动方法**确实**可以加载如下资源：

```
 String manualString = "jar:http://spider.grunt.webhop.net/clubjar.jar!/club.gif";
  URL manualURL = new URL(manualString);
  BufferedImage buf = ImageIO.read(manualURL);
  System.out.println("manual buf: " +buf); 
```

对我来说，这看起来像是插件类加载器的错误。我们应该能够使用类加载器 getResource() 或 getResourceAsStream() 方法来定位有效资源。在这种情况下并非如此。ImageIO 类可以读取我们的手动 URL，但类加载器不能给我们一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T18:22:41.183

Thread.currentThread().getContextClassLoader(); 不能解决我的问题。

我所有的资源都在同一个“res”文件夹/包中——与获取它们的类相同：ResUtils（参见下面的源代码）。

如果来自 domain1 的 jar1 中的类调用 ResUtils.getImageIcon("trash.gif"); getURL(...) 返回一个 URL： url -> jar: [http://domain1/bun.jar!/res/trash.gif](http://domain1/bun.jar!/res/trash.gif)

如果来自 domain2 的 jar2 中的类调用 ResUtils.getImageIcon("trash.gif"); getURL(...) 返回一个 NULL： url -> null

```
package res;

public class ResUtils {
       private static final String PATH =  "/" + (ResUtils.class.getPackage().getName().replace(".", "/")) + "/";
         public static URL getURL(String name)  {return ResUtils.class.getResource(PATH + name);}
          public static ImageIcon getImageIcon(String name) {
           return new ImageIcon(getBufferedImage(name));
       }

       public static BufferedImage getBufferedImage(String name) {
           try {
               URL url = getURL(name);
               return ImageIO.read(url);
           } catch (Exception e) {
               e.printStackTrace();
               return new BufferedImage(10,10, BufferedImage.TYPE_INT_RGB);
           }
       }
} 
```

# c# - 查找/替换命名空间或文件夹中的所有文件

> ID：788856
> 
> 赞同：1
> 
> 时间：2009-04-25T12:49:58.517
> 
> 标签：c#, visual-studio, refactoring

我知道我可以通过搜索进行查找/替换：

*   当前文件
*   当前的项目
*   当前解决方案

有没有办法通过搜索当前命名空间或当前文件夹来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-25T12:56:24.760

我假设您使用的是 Visual Studio。要替换文件夹中的文件，只需打开“查找和替换”对话框，然后按“查找范围：”部分中的“...”按钮。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T12:51:28.717

有点，在 ReSharper 中，您可以使用“类视图”窗口来重命名命名空间，但除此之外……我认为您不走运。除非有我不知道的 VS 插件。

# java - 如何在 displaytag 中创建链接？

> ID：788860
> 
> 赞同：4
> 
> 时间：2009-04-25T12:51:07.127
> 
> 标签：java, struts2, displaytag

我想用struts2在显示标签中创建编辑、删除链接。我该怎么做？如果有人知道请帮助我....

我正在这样做。

```
<display:column property="id" title="ID" href="details.jsp" paramId="id" /> 
```

但链接不会转到 details.jsp 。它不会去任何地方。可能的原因是什么

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-27T14:59:22.433

你可以像这样在标签中写你的东西：

```
<display:table id="row" >
    <display:column property="id" title="ID" paramId="id"  > 
        <a href="details.jsp?${row.id}">Details</a>
    </display:column>
</display:table> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-28T05:29:31.813

它由以下代码完成。

```
<display:column  title="Edit">
                    <s:url id="updateUrl" action="marketing/update.action">
                        <s:param name="id" value="#attr.countrylist.id" />
                    </s:url>
                    <s:a href="%{updateUrl}" theme="ajax"  targets="countrylist">Update</s:a>
                </display:column> 
```

感谢所有的答案

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-07T23:46:25.693

您还可以为表创建一个装饰器并让它生成链接。请参阅以下其他论坛上的示例：http: [//sourceforge.net/forum/message.php ?msg_id=4119964](http://sourceforge.net/forum/message.php?msg_id=4119964)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-25T14:38:56.133

您可能必须更具体才能获得更好的答案。是理解struts2还是显示标签有问题？ [本教程](http://displaytag.sourceforge.net/1.2/tut_links.html)介绍如何在显示标签库中创建链接。

如果 struts 2 是问题，那么你可以让你的问题更具体，我们会看看我们能做什么。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-05-17T18:02:28.577

```
<display:table id="listaProgramas" name="programas" uid="tb" 
                                        pagesize="10" export="false" requestURI="/paginarProgramas.do"
                                        class="ui-widget ui-widget-content">

                                    <display:column title="Fecha de creaci&#243;n" property="fechaCreacionFormato" sortable="true"/>
                                    <display:column title="Fecha de modificaci&#243;n" property="fechaModificacionFormato" sortable="true"/>
                                    <display:column title="Empresa" property="nombreGrupoEmpresa"/>
                                    <display:column title="Usuario" property="codUsuarioCreacion"/>
                                    <display:column title="Estado" property="estadoPrograma.descripcion" />
                                    <%if(pageContext.getAttribute("tb") != null && ((Programa)pageContext.getAttribute("tb")).getEstadoPrograma().getId().equals(Constantes.ID_ESTADO_PROGRAMA_PENDIENTE)){ %>
                                    <display:column title="Modificar/Copiar" value="Modificar" url="/modificarCopiarPrograma.do" paramId="idPrograma" paramProperty="id"  style="text-align:center;"/>  
                                    <%}%> 
                                    <%if(pageContext.getAttribute("tb") != null && ((Programa)pageContext.getAttribute("tb")).getEstadoPrograma().getId().equals(Constantes.ID_ESTADO_PROGRAMA_CERRADO)){ %>
                                        <display:column title="Modificar/Copiar" value="Copiar" url="/modificarCopiarPrograma.do" paramId="idPrograma" paramProperty="id" style="text-align:center;"/>                                       
                                    <%}%>
                                    <display:column title="Reporte Financiero" value="XLS" url="/generarExcel.do" paramId="idPrograma" paramProperty="id" style="text-align:center;">
                                    <img src="image/excel.gif" alt="Descargar Excel"></img>
                                    </display:column>                                     
                                    <display:column title="Reporte Financiero PDF" value="PDF" url="/downloadPDF.do" paramId="idPrograma" paramProperty="id" style="text-align:center;">
                                    <img src="image/excel.gif" alt="Descargar Excel"></img>
                                    </display:column>
                                    </display:table> 
```

# php - PHP 文本解析和/或制作自己的语言？

> ID：788872
> 
> 赞同：3
> 
> 时间：2009-04-25T12:56:25.430
> 
> 标签：php, parsing, nlp, dsl

一直在谷歌搜索而没有找到太多东西，所以有没有人知道一个类或库可以帮助你解析任何类型的语言，比如[域特定语言](http://en.wikipedia.org/wiki/Domain-specific_programming_language)（我正在创建一个，所以我在语法和格式方面很灵活可以）进入PHP代码或一些有用的结构或类层次结构或......？在这一点上任何事情都会发生。:)

我想尝试将文本文件解析为标记，构建一个小的语法和语法库来表达诸如[Business Natural Languages](http://bnl.jayfields.com/01_introduction.html)之类的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T13:50:32.430

如果你对 BNF 风格的输入语法感到满意，你应该看看：

[http://pear.php.net/PHP_ParserGenerator](http://pear.php.net/PHP_ParserGenerator)

或者

[http://pear.php.net/PHP_LexerGenerator](http://pear.php.net/PHP_LexerGenerator)

他们生成的 PHP 代码有点令人不安，但它可以工作，并且是一些解析器任务的良好开端。

# html - 什么是多部分 HTTP POST 以及如何制作它？（抄写）

> ID：788877
> 
> 赞同：9
> 
> 时间：2009-04-25T12:59:27.077
> 
> 标签：html, http

我正在尝试将文件上传到 scribd。它说：“要上传的文件的内容。这需要表示为多部分 HTTP POST 的一部分”..

任何人都知道他们对此的意思吗？

它应该看起来像这样：[http://api.scribd.com/api?method=docs.upload&file=THE](http://api.scribd.com/api?method=docs.upload&file=THE) MULTIPART-HTTP-POST&api_key=API-KEY ？

非常感谢，如果这是错误的地方问这样的问题很抱歉:)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-25T13:05:19.433

这是一种将 POST 请求中的数据分解为不同离散类型的方法。它也经常用于将电子邮件分成多个具有 mime 类型的附件。[您可以在此处](http://en.wikipedia.org/wiki/MIME#Multipart_messages)阅读有关 MIME 的更多信息（特别是关于多部分 POST 请求）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-27T10:17:55.997

多部分 MIME 格式的 HTML 表单版本的相关 RFC 是[RFC 1867](https://www.rfc-editor.org/rfc/rfc1867)

# apache-flex - Flex Child Canvas 提出一个 Canvas 和调整大小的问题

> ID：788881
> 
> 赞同：0
> 
> 时间：2009-04-25T13:00:11.677
> 
> 标签：apache-flex, actionscript-3, resize, canvas

我有一个带有滚动策略的画布 A，A 有一个独特的子画布 B，它没有滚动。

A 是 B 的容器，它是一个类似白板的工具。

如果我不设置 B 的宽度和高度，他将根据 A 大小调整大小，直到 A 具有滚动条的某个点，这是良好的行为。

但是，由于每当我动态添加或移动元素时，B 画布似乎都会动态调整大小，所以它会变得有点慢。

我可以通过将 100% 的百分比宽度和高度设置为 B 来解决它，当我执行

```
 var bmd:BitmapData = new BitmapData(
                B.width, B.height, false, 0xffffff
            );
 bmd.draw(B); 
```

B 实际上是 A 视图（带有滚动条）。

如果我删除百分比高度和宽度，它将是预期的整个画布。

完美的是保持百分比高度和宽度，而子宽度小于父 A 宽度。当 B 宽度变得比 A 大时，百分比宽度应该停止。

我应该在 B 的哪个函数中处理这样的代码？是 updatelist() 吗？

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-25T15:13:15.943

如果您只使用像素值并减去滚动条的宽度，可能会更容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-14T12:42:15.513

我遇到过同样的问题;

我解决了它监听一个事件（创建或其他事件（调整大小......）后的creationComplete），并根据measuredWidth设置我的组件宽度

myContainer.width = myContainer.measuredWidth

这对我有用，希望它可以帮助你:)

# c# - 这两个字符串有什么区别？

> ID：788882
> 
> 赞同：1
> 
> 时间：2009-04-25T13:01:23.640
> 
> 标签：c#, string, nunit, culture

使用 nUnit 测试特定文化的输出（货币格式），但我们得到以下结果。

```
 Fail: Formatting currency amount
  String lengths are both 11\. Strings differ at index 2.
  Expected: "12 765,87 €"
  But was:  "12 765,87 €"
  -------------^ 
```

我们看不到字符串之间的区别。我们的预期结果使用“空格”字符。

我们可以在接受的结果中放入不同的空格字符以通过测试吗？

顺便说一句，测试的文化是 fr-FR。

编辑：感谢亚当，您对 unicode 字符很满意。我们已经改变了我们的预期结果，现在每个单元测试都通过了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-25T13:03:48.500

它们可能是不同类型的空间。Unicode 有很多不同的[空格字符](http://en.wikipedia.org/wiki/Whitespace_(computer_science))。通过将字符转换为整数来查看索引 2 处的代码点以获得答案。

**编辑**

作为对您的评论的回应，代码点 160 是一个[不间断的空格](http://en.wikipedia.org/wiki/Non-breaking_space)。您可以[将其直接输入](http://en.wikipedia.org/wiki/Unicode_input)到源代码中（例如，Windows 数字键盘上的 Alt+0160），或使用转义序列：

```
// U+20AC is the Unicode code point for the euro sign
string expected = "12\u00A0765,87 \u20AC"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T13:14:09.880

很可能它是一个空白字符，但不是空格，以避免标签等在启用自动换行时将数字分成两部分。

# c# - C# 控制台问题

> ID：788883
> 
> 赞同：1
> 
> 时间：2009-04-25T13:02:13.247
> 
> 标签：c#, .net, visual-studio-2008, console, getter

考虑这个类：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace Game.Items
{
    class Item
    {
        private string name;
        public string Name
        {
            get { return this.name; }
        }

        private string description;
        public string Description
        {
            get { return this.description; }
        }

        public Item(string name, string description)
        {
            this.name = name;
            this.description = description;
        }

        public override string ToString()
        {
            return this.name;
        }
    }
} 
```

然后我创建一个像这样的新对象：

```
Item item1 = new Item("Item1", "Description..."); 
```

现在的问题是，我无法使用 getter 方法访问对象的属性，即这不起作用：

```
Console.WriteLine(item1.Name);
Console.WriteLine(item1.Description);
Console.ReadLine(); 
```

“不起作用”是指当我单击“开始调试”时，控制台窗口出现但什么都没有，它是空白的。但是，这很好用：

```
Console.WriteLine(item1); // ToString()
Console.ReadLine(); 
```

我究竟做错了什么？

理查德

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-25T13:04:38.437

对我来说很好：

```
using System;

namespace Application
{
    class Test
    {
        static void Main()
        {
            Item item1 = new Item("Item1", "Description...");
            Console.WriteLine(item1.Name);
            Console.WriteLine(item1.Description);
        }
    }
} 
```

（你的班级也在那里。）

当您说“这不起作用”时，究竟出了什么问题？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T13:08:26.040

您是否在与包含“项目”的项目不同的项目中工作主类？如果是这样，那么

*   参考其他项目
*   将您的项目类标记为公开

    ```
    public class Item {
        // your code
    } 
    ```

或者您可以尝试通过这种方式访问​​，看看问题是否与命名空间有关

```
Console.WriteLine(Application.item1.Name);
Console.WriteLine(Application.item1.Description); 
```

另外，请在执行后暂停，否则您的控制台窗口将不显示任何内容

```
Console.ReadLine(); 
```

还要检查 using 子句，根据最后一条评论，然后您必须在尝试使用 Item 类的文件顶部使用 using 子句

```
using Game; 
```

# html - 为什么这个“清除：两者”不能防止包装？

> ID：788885
> 
> 赞同：2
> 
> 时间：2009-04-25T13:03:12.463
> 
> 标签：html, css

我想一个`DIV`with`clear:both`样式可以使其包含 DIV 的父级不换行，但下面的 HTML 似乎不能以这种方式工作。

如果浏览器窗口很窄，第二个`DIV` `"OK OK"`仍然会换行到下一行。

```
<div style="overflow: hidden;">
  <div style="float: left; overflow: hidden; white-space: nowrap">
    Hello world 1 Hello world 2 Hello world 3
  </div>
  <div style="float: left; overflow: hidden; white-space: nowrap">
    OK OK OK OK OK OK OK OK
  </div>
  <div style="clear: both;">
  </div>
</div>
```

我错过了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-25T13:32:14.580

我认为您可能误解了“清除”属性。它不具体控制包装，它控制之后浮动元素的放置。上面的 html 中没有任何内容阻止第二个 div 流到下一行。

这是关于清除元素的一个很好的概要： [http ://www.builderau.com.au/program/css/print.htm?TYPE=story&AT=339278136-339028392t-320002011c](http://www.builderau.com.au/program/css/print.htm?TYPE=story&AT=339278136-339028392t-320002011c)

为了使布局不流动，您可能必须在容器 div 上指定硬宽度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T13:29:54.133

因为两个内部 div 是向左浮动的，所以当浏览器窗口变得太窄时它们会自动换行。我建议您在外部 div 上指定一个宽度（您有溢出：隐藏的那个）。这样两个内部 div 可以浮动，但是当浏览器缩小时它们不会换行。

```
 <div style="overflow: hidden; width: 600px;">
            <div style="float: left; overflow: hidden; white-space: nowrap">
                     Hello world 1 Hello world 2 Hello world 3
                </div>
            <div style="float: left; overflow: hidden; white-space: nowrap">
                            OK OK OK OK OK OK OK OK
                </div>
            <div style="clear: both;">
            </div>
    </div> 
```

如果你想要更多的控制，你可能必须在 IE 中使用表达式来实现最小宽度黑客；最小宽度：在 FF 中工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-01T06:31:32.603

为您的样式添加两个新属性，它将起作用！

> ```
> text-align: left;
>     width: 1010px; 
> ```

```
 <div style="float: left; overflow: hidden; white-space: nowrap;
                  text-align: left;width: 1010px;">
                  Hello world 1 Hello world 2 Hello world 3
                 </div>

                <div style="clear: both;">
                </div>
                <div style="float: left; overflow: hidden; white-space: nowrap;
                         text-align: left;width: 1010px;">
                        OK OK OK OK OK OK OK OK
                       </div>
                       <div style="clear: both;">
                        </div>
                        </div> 
```

# asp.net-mvc - 使用 ASP.NET MVC 进行 HTML.Encode 本地化

> ID：788890
> 
> 赞同：0
> 
> 时间：2009-04-25T13:06:06.733
> 
> 标签：asp.net-mvc, encoding, localization

如何转义本地化字符串编码：

```
<%= Html.Encode("ÆØÅ") %> from rendering  &#198;&#216;&#197; 
```

还有另一种编码本地化字符串的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T13:15:49.580

这被编码了两次 - 你在 HtmlHelper 调用中使用它吗？

```
// this will display&#198;&#216;&#197; as Html.TextBox encodes the
// value passed to it so it's encoded twice in this line
<%=Html.TextBox("sdfsdf", Html.Encode("ÆØÅ"))%><br />

// this will display ÆØÅ
<%= Html.Encode("ÆØÅ") %><br />

// As will this
<%=Html.TextBox("sdfsdf", "ÆØÅ")%><br /> 
```

# matlab - 使用 GUIDE 的 MATLAB GUI：列表框问题

> ID：788891
> 
> 赞同：1
> 
> 时间：2009-04-25T13:07:18.803
> 
> 标签：matlab, user-interface, button, listbox, matlab-guide

我正在创建一个包含两个 uicontrol 对象的 MATLAB GUI：一个按钮和一个列表框。我使用按钮将文件名添加到列表框中。当我从 m 文件运行 GUI 时，它工作正常。仅当我运行 .fig 文件本身时才会出现问题。这是回调代码和错误：

```
function add_file_Callback(hObject, eventdata, handles)
% hObject    handle to add_file (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)
%gets input file(s) from user

[input_file,pathname] = uigetfile( ...
       {'*.jpg;*.tif;*.png;*.gif;*.bmp;*.pgm'}, ...
        'Select files', ... 
        'MultiSelect', 'on');

%if file selection is cancelled, pathname should be zero
%and nothing should happen
if pathname == 0
    return
end

%gets the current data file names inside the listbox

inputFileNames = get(handles.img_list,'String');

%if they only select one file, then the data will not be a cell
%if more than one file selected at once,
%then the data is stored inside a cell
if iscell(input_file) == 0

    %add the most recent data file selected to the cell containing
    %all the data file names
    inputFileNames{end+1} = input_file;

%else, data will be in cell format
else
    %stores full file path into inputFileNames
    for n = 1:length(input_file)
        %notice the use of {}, because we are dealing with a cell here!
        inputFileNames{end+1} = input_file{n};
    end
end

%updates the gui to display all filenames in the listbox
set(handles.img_list,'String',inputFileNames);

%make sure first file is always selected so it doesn't go out of range
%the GUI will break if this value is out of range
set(handles.img_list,'Value',1);

% Update handles structure
guidata(hObject, handles); 
```

错误：

```
Error in ==> Texture_Classification_GUI>add_file_Callback at 154
inputFileNames = get(handles.img_list,'String');

Error in ==> gui_mainfcn at 95
        feval(varargin{:});

Error in ==> Texture_Classification_GUI at 42
    gui_mainfcn(gui_State, varargin{:});

??? Error using ==> Texture_Classification_GUI('add_file_Callback',gcbo,[],guidata(gcbo))
Attempt to reference field of non-structure array.

??? Error while evaluating uicontrol Callback 
```

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-25T17:09:58.173

*“运行无花果文件本身*”是什么意思？GUIDE 创建两个文件：一个`m-file`和一个`.fig`文件（例如`my_guide_app.m`和`my_guide_app.fig`）。你用类似的`.fig`东西打开`openfig`吗？这不起作用，因为`m-file`需要设置创建句柄结构的数字打开功能。因此，要运行使用 GUIDE 制作的 GUI，必须调用`m-file`来启动应用程序，而不仅仅是打开`.fig`文件。

如果我误解了您关于打开`.fig`文件的声明，请告诉我，因为可能还有其他问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-10T07:47:12.600

我猜需要在 GUIDE 中初始化列表框。如果你用 1 个选项初始化它，它将是一个 char 数组，如果你用超过 1 个选项初始化它，它将是一个元胞数组。因此，您也必须在那里进行类似的检查（iscell）；然后添加新选项。

# python - 使用 msn 协议运行 twisted.words 示例时出现问题

> ID：788902
> 
> 赞同：5
> 
> 时间：2009-04-25T13:16:29.733
> 
> 标签：python, twisted, msn, twisted.words

我目前正在尝试使用 Twisted 库专门扭曲的单词来尝试与 MSN 交互。但是，当我运行 twisted 提供的示例脚本时，我得到一个错误。具体来说，错误在这里[http://i42.tinypic.com/wl945w.jpg](http://i42.tinypic.com/wl945w.jpg)。该脚本可以在这里[http://twistedmatrix.com/projects/words/documentation/examples/msn_example.py](http://twistedmatrix.com/projects/words/documentation/examples/msn_example.py)找到。

平台是带有 Python 2.6 的 Vista

编辑：完整输出：

```
Email (passport): mypassport@hotmail.com
Password: ******
2009-04-25 10:52:49-0300 [-] Log opened.
2009-04-25 10:52:49-0300 [-] Starting factory <twisted.internet.protocol.ClientFactory instance at 0x9d87e8c>
2009-04-25 10:52:55-0300 [Dispatch,client] Starting factory <twisted.words.protocols.msn.NotificationFactory instance at 0x9e28bcc>
2009-04-25 10:52:55-0300 [Dispatch,client] Stopping factory <twisted.internet.protocol.ClientFactory instance at 0x9d87e8c>
2009-04-25 10:52:55-0300 [Notification,client] Unhandled Error
    Traceback (most recent call last):
      File "/usr/local/lib/python2.5/site-packages/twisted/python/log.py", line 84, in callWithLogger
        return callWithContext({"system": lp}, func, *args, **kw)
      File "/usr/local/lib/python2.5/site-packages/twisted/python/log.py", line 69, in callWithContext
        return context.call({ILogContext: newCtx}, func, *args, **kw)
      File "/usr/local/lib/python2.5/site-packages/twisted/python/context.py", line 59, in callWithContext
        return self.currentContext().callWithContext(ctx, func, *args, **kw)
      File "/usr/local/lib/python2.5/site-packages/twisted/python/context.py", line 37, in callWithContext
        return func(*args,**kw)
    --- <exception caught here> ---
      File "/usr/local/lib/python2.5/site-packages/twisted/internet/selectreactor.py", line 146, in _doReadOrWrite
        why = getattr(selectable, method)()
      File "/usr/local/lib/python2.5/site-packages/twisted/internet/tcp.py", line 460, in doRead
        return self.protocol.dataReceived(data)
      File "/usr/local/lib/python2.5/site-packages/twisted/protocols/basic.py", line 238, in dataReceived
        why = self.lineReceived(line)
      File "/usr/local/lib/python2.5/site-packages/twisted/words/protocols/msn.py", line 651, in lineReceived
        handler(params.split())
      File "/usr/local/lib/python2.5/site-packages/twisted/words/protocols/msn.py", line 827, in handle_USR
        d = _login(f.userHandle, f.password, f.passportServer, authData=params[3])
      File "/usr/local/lib/python2.5/site-packages/twisted/words/protocols/msn.py", line 182, in _login
        reactor.connectSSL(_parsePrimitiveHost(nexusServer)[0], 443, fac, ClientContextFactory())
    exceptions.TypeError: 'NoneType' object is not callable

2009-04-25 10:52:55-0300 [Notification,client] Stopping factory <twisted.words.protocols.msn.NotificationFactory instance at 0x9e28bcc> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-25T13:59:35.933

由于 MSN 涉及 SSL 连接，因此您必须安装 pyOpenSSL 才能使用它。好像你可能不知道。不过，这不是 Twisted 报告这种缺失依赖项的好方法。我建议在 Twisted 问题跟踪器中提交一张票，以改进此报告。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-25T13:57:27.390

## 发生了什么

当您尝试调用 None 的对象时，您会遇到此异常。看一下这个 ：

```
>>> a = str
>>> a() # it's ok, a string is a callable class
''
>>> a = None
>>> a() # it fails, None a special Singleton not meant to be called

Traceback (most recent call last):
  File "<pyshell#4>", line 1, in <module>
    a()
TypeError: 'NoneType' object is not callable 
```

## 你可以做什么

你不能这样猜，所以你需要做一些调试。

显然，最后一行 (refactor.connectSSL...) 包含三个对象调用，其中一个对象是 None。

如果您不喜欢调试器，您可以做的第一件事是获取该行的每个元素并在其之前添加：

```
assert object1 is None 
assert object2 is None 
```

然后您将获得异常的来源。之后，检查为什么这个对象设置为无。您可能必须检查文档以查看在哪种情况下某些可能已初始化它的方法返回 None。

愿力...

# c - 在 C 中有效地使用 goto 进行错误管理？

> ID：788903
> 
> 赞同：101
> 
> 时间：2009-04-25T13:17:09.763
> 
> 标签：c, exception-handling, error-handling, goto

这个问题实际上是不久前在programming.reddit.com上[有趣讨论的结果。](http://www.reddit.com/r/programming/comments/8cx8m/error_handling_in_c_you_are_going_to_fail_in_a/)它基本上归结为以下代码：

```
int foo(int bar)
{
    int return_value = 0;
    if (!do_something( bar )) {
        goto error_1;
    }
    if (!init_stuff( bar )) {
        goto error_2;
    }
    if (!prepare_stuff( bar )) {
        goto error_3;
    }
    return_value = do_the_thing( bar );
error_3:
    cleanup_3();
error_2:
    cleanup_2();
error_1:
    cleanup_1();
    return return_value;
} 
```

这里的使用`goto`似乎是最好的方法，导致所有可能性中最干净和最有效的代码，或者至少在我看来是这样。*在Code Complete*中引用 Steve McConnell 的话：

> goto 在分配资源、对这些资源执行操作、然后释放资源的例程中很有用。使用 goto，您可以清理代码的一部分。goto 减少了您忘记在检测到错误的每个地方释放资源的可能性。

对这种方法的另一种支持来自[本节中的](http://www.xml.com/ldd/chapter/book/ch02.html#buierr)*Linux 设备驱动程序*一书。

你怎么看？这种情况`goto`在 C 中是否有效？您是否更喜欢其他方法，这些方法会产生更复杂和/或效率更低的代码，但要避免`goto`？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2009-04-26T05:05:34.880

FWIF，我发现您在问题示例中给出的错误处理习语比迄今为止答案中给出的任何替代方法都更具可读性和更容易理解。虽然`goto`一般来说是一个坏主意，但当以简单统一的方式完成时，它对于错误处理很有用。在这种情况下，即使它是 a `goto`，它也以定义明确且或多或少结构化的方式使用。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-04-25T14:13:03.887

作为一般规则，避免 goto 是一个好主意，但是当 Dijkstra 第一次写“GOTO 被认为是有害的”时普遍存在的滥用行为现在甚至没有成为大多数人的想法。

您概述的是错误处理问题的通用解决方案-只要仔细使用它，我就可以了。

您的特定示例可以简化如下（步骤 1）：

```
int foo(int bar)
{
    int return_value = 0;
    if (!do_something(bar)) {
        goto error_1;
    }
    if (!init_stuff(bar)) {
        goto error_2;
    }
    if (prepare_stuff(bar))
    {
        return_value = do_the_thing(bar);
        cleanup_3();
    }
error_2:
    cleanup_2();
error_1:
    cleanup_1();
    return return_value;
} 
```

继续这个过程：

```
int foo(int bar)
{
    int return_value = 0;
    if (do_something(bar))
    {   
        if (init_stuff(bar))
        {
            if (prepare_stuff(bar))
            {
                return_value = do_the_thing(bar);
                cleanup_3();
            }
            cleanup_2();
        }
        cleanup_1();
    }
    return return_value;
} 
```

我相信，这相当于原始代码。这看起来特别干净，因为原始代码本身非常干净且组织良好。通常，代码片段没有那么整洁（尽管我接受他们应该如此的论点）；例如，传递给初始化（设置）例程的状态通常比显示的多，因此也有更多的状态要传递给清理例程。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2011-06-14T15:27:22.040

我很惊讶没有人提出这个替代方案，所以即使这个问题已经存在了一段时间，我还是会添加它：解决这个问题的一个好方法是使用变量来跟踪当前状态。`goto`这是一种无论是否用于获得清理代码都可以使用的技术。像任何编码技术一样，它有利也有弊，并且不会适用于所有情况，但如果您选择一种风格，则值得考虑 - 特别是如果您想避免`goto`最终没有深度嵌套`if`的 s。

基本思想是，对于每个可能需要采取的清理行动，都有一个变量，我们可以根据其值判断是否需要进行清理。

我将`goto`首先显示版本，因为它更接近原始问题中的代码。

```
int foo(int bar)
{
    int return_value = 0;
    int something_done = 0;
    int stuff_inited = 0;
    int stuff_prepared = 0;

    /*
     * Prepare
     */
    if (do_something(bar)) {
        something_done = 1;
    } else {
        goto cleanup;
    }

    if (init_stuff(bar)) {
        stuff_inited = 1;
    } else {
        goto cleanup;
    }

    if (prepare_stuff(bar)) {
        stufF_prepared = 1;
    } else {
        goto cleanup;
    }

    /*
     * Do the thing
     */
    return_value = do_the_thing(bar);

    /*
     * Clean up
     */
cleanup:
    if (stuff_prepared) {
        unprepare_stuff();
    }

    if (stuff_inited) {
        uninit_stuff();
    }

    if (something_done) {
        undo_something();
    }

    return return_value;
} 
```

与其他一些技术相比，这样做的一个优点是，如果初始化函数的顺序发生了变化，仍然会发生正确的清理——例如，使用`switch`另一个答案中描述的方法，如果初始化的顺序发生了变化，那么`switch`必须非常仔细地编辑以避免试图清理一些实际上并没有被初始化的东西。

现在，有些人可能会争辩说这种方法增加了很多额外的变量——在这种情况下确实如此——但在实践中，现有变量通常已经跟踪或可以跟踪所需的状态。例如，如果实际是对或`prepare_stuff()`的调用，则可以使用保存返回的指针或文件描述符的变量 - 例如：`malloc()``open()`

```
int fd = -1;

....

fd = open(...);
if (fd == -1) {
    goto cleanup;
}

...

cleanup:

if (fd != -1) {
    close(fd);
} 
```

现在，如果我们另外使用变量跟踪错误状态，我们可以`goto`完全避免，并且仍然可以正确清理，而不会出现随着我们需要的更多初始化而越来越深的缩进：

```
int foo(int bar)
{
    int return_value = 0;
    int something_done = 0;
    int stuff_inited = 0;
    int stuff_prepared = 0;
    int oksofar = 1;

    /*
     * Prepare
     */
    if (oksofar) {  /* NB This "if" statement is optional (it always executes) but included for consistency */
        if (do_something(bar)) {
            something_done = 1;
        } else {
            oksofar = 0;
        }
    }

    if (oksofar) {
        if (init_stuff(bar)) {
            stuff_inited = 1;
        } else {
            oksofar = 0;
        }
    }

    if (oksofar) {
        if (prepare_stuff(bar)) {
            stuff_prepared = 1;
        } else {
            oksofar = 0;
        }
    }

    /*
     * Do the thing
     */
    if (oksofar) {
        return_value = do_the_thing(bar);
    }

    /*
     * Clean up
     */
    if (stuff_prepared) {
        unprepare_stuff();
    }

    if (stuff_inited) {
        uninit_stuff();
    }

    if (something_done) {
        undo_something();
    }

    return return_value;
} 
```

同样，对此有潜在的批评：

*   难道所有这些“如果”不会影响性能吗？否 - 因为在成功的情况下，无论如何您都必须进行所有检查（否则您不会检查所有错误情况）；并且在失败的情况下，大多数编译器会将失败`if (oksofar)`检查的顺序优化为单次跳转到清理代码（GCC 肯定会这样做） - 并且在任何情况下，错误情况通常对性能不太重要。
*   这不是又增加了一个变量吗？在这种情况下是的，但通常`return_value`变量可以用来扮演`oksofar`在这里扮演的角色。如果你构建你的函数以一致的方式返回错误，你甚至可以`if`在每种情况下避免第二个：

    ```
    int return_value = 0;

    if (!return_value) {
        return_value = do_something(bar);
    }

    if (!return_value) {
        return_value = init_stuff(bar);
    }

    if (!return_value) {
        return_value = prepare_stuff(bar);
    } 
    ```

    像这样编码的优点之一是一致性意味着原始程序员忘记检查返回值的任何地方都会像拇指一样突出，从而更容易找到（那一类）错误。

所以 - 这是（但）另一种可用于解决此问题的样式。正确使用它可以生成非常干净、一致的代码——就像任何技术一样，如果使用不当，它最终会产生冗长且令人困惑的代码:-)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-04-25T13:25:21.023

关键字的问题`goto`大多被误解了。这不是普通的邪恶。您只需要注意使用每个 goto 创建的额外控制路径。很难推理您的代码及其有效性。

FWIW，如果您查看 developer.apple.com 教程，他们会采用 goto 方法来处理错误。

我们不使用 goto。更高的重要性放在返回值上。异常处理是通过`setjmp/longjmp`- 尽你所能。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-25T13:32:41.770

goto 语句在道德上没有任何问题，就像 (void)* 指针在道德上存在问题一样。

这完全取决于您如何使用该工具。在您提出的（微不足道的）案例中，案例语句可以实现相同的逻辑，尽管开销更大。真正的问题是，“我的速度要求是多少？”

goto 的速度非常快，特别是如果您小心确保它编译为短跳转。非常适合注重速度的应用。对于其他应用程序，使用 if/else + case 来承受开销以提高可维护性可能是有意义的。

请记住：goto 不会杀死应用程序，开发人员会杀死应用程序。

更新：这是案例示例

```
int foo(int bar) { 
     int return_value = 0 ; 
     int failure_value = 0 ;

     if (!do_something(bar)) { 
          failure_value = 1; 
      } else if (!init_stuff(bar)) { 
          failure_value = 2; 
      } else if (prepare_stuff(bar)) { 
          return_value = do_the_thing(bar); 
          cleanup_3(); 
      } 

      switch (failure_value) { 
          case 2: cleanup_2(); 
          case 1: cleanup_1(); 
          default: break ; 
      } 
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-26T01:09:20.940

GOTO 很有用。这是您的处理器可以做的事情，这就是您应该有权访问它的原因。

有时你想在你的函数中添加一些东西，而单 goto 让你很容易做到这一点。可以节省时间。。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-27T19:53:49.887

**我个人是[“编写安全关键代码的 10-10 条规则的力量”的](http://spinroot.com/p10/)追随者。**

我将包含该文本中的一个小片段，说明我认为关于 goto 的一个好主意。

* * *

**规则：将所有代码限制为非常简单的控制流结构——不要使用 goto 语句、setjmp 或 longjmp 结构以及直接或间接递归。**

**基本原理：更简单的控制流转化为更强大的验证能力，并且通常会提高代码的清晰度。**递归的消除可能是这里最大的惊喜。但是，如果没有递归，我们可以保证有一个非循环的函数调用图，它可以被代码分析器利用，并且可以直接帮助证明所有应该有界的执行实际上都是有界的。（请注意，此规则并不要求所有函数都有一个返回点——尽管这通常也简化了控制流。不过，有足够多的情况，早期错误返回是更简单的解决方案。）

* * *

禁止使用 goto**似乎很糟糕**，但是：

**如果这些规则一开始看起来很严厉，**请记住，它们的目的是让检查代码成为可能，而实际上你的生活可能取决于其正确性：用于控制你所驾驶的飞机、核电站的代码距离您居住的地方或将宇航员送入轨道的航天器几英里。**这些规则就像你车上的安全带：最初它们可能有点不舒服，但过了一段时间，它们的使用变成了第二天性，不使用它们变得难以想象。**

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-06-06T16:25:56.123

一般来说，我认为可以最清楚地编写一段代码这一事实是程序流程可能比通常期望的更复杂`goto`的*症状。*以奇怪的方式组合其他程序结构以避免使用`goto`将试图治疗症状，而不是疾病。如果没有，您的特定示例可能不会很难实现`goto`：

```
  做 {
    .. 设置仅在提前退出的情况下才需要清理的东西1
    如果（错误）中断；
    做
    {
      ..设置在提前退出时需要清理的thing2
      如果（错误）中断；
      // ***** 见关于这一行的文字
    } 而（0）；
    ..清理东西2；
  } 而（0）；
  ..清理东西1；

```

但是如果清理只应该在函数失败时发生，则`goto`可以通过`return`在第一个目标标签之前放置 a 来处理这种情况。上面的代码需要`return`在标有`*****`.

在“即使在正常情况下也进行清理”的场景中，我认为使用 of`goto`比`do`/构造更清晰，因为目标标签本身实际上比and /构造`while(0)`更能喊出“看我” 。对于“仅在错误时进行清理”的情况，从可读性的角度来看，语句最终必须处于最糟糕的位置（返回语句通常应该在函数的开头，或者在“看起来像”结束）; 在目标标签之前有一个比在“循环”结束之前有一个更容易满足该条件。`break``do``while(0)``return``return`

顺便说一句，我有时`goto`用于错误处理的一种情况是在一个`switch`语句中，当多个案例的代码共享相同的错误代码时。尽管我的编译器通常足够聪明，可以识别出多个案例以相同的代码结尾，但我认为更清楚地说：

```
REPARSE_PACKET：
  开关（包[0]）
  {
    案例 PKT_THIS_OPERATION：
      如果（问题条件）
        转到 PACKET_ERROR；
      ... 处理 THIS_OPERATION
      休息;
    案例 PKT_THAT_OPERATION：
      如果（问题条件）
        转到 PACKET_ERROR；
      ... 处理 THAT_OPERATION
      休息;
    ...
    案例 PKT_PROCESS_CONDITIONALLY
      如果 (packet_length < 9)
        转到 PACKET_ERROR；
      if (packet_condition 涉及数据包[4])
      {
        数据包长度-= 5；
        memmove（数据包，数据包+5，数据包长度）；
        转到 REPARSE_PACKET；
      }
      别的
      {
        数据包[0] = PKT_CONDITION_SKIPPED；
        数据包[4] = 数据包长度；
        数据包长度 = 5；
        packet_status = READY_TO_SEND；
      }
      休息;
    ...
    默认：
    {
     数据包错误：
      packet_error_count++；
      数据包长度 = 4；
      数据包[0] = PKT_ERROR；
      packet_status = READY_TO_SEND；
      休息;
    }
  }   

```

虽然可以`goto`用. _ _ _ 此外，虽然可以从使用 的任何地方复制代码，并且编译器可能会写出重复的代码一次并用跳转到该共享副本来替换大多数出现的地方，但使用更容易注意到地方它对数据包的设置略有不同（例如，如果“有条件执行”指令决定不执行）。`{handle_error(); break;}``do``while(0)``continue``goto``PACKET_ERROR``goto PACKET_ERROR``goto`

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-10-31T15:41:47.233

我同意问题中给出的相反顺序的 goto 清理是在大多数功能中清理事物的最干净的方式。但我也想指出，有时候，无论如何你都希望你的函数清理干净。在这些情况下，我使用以下变体 if ( 0 ) { label: } 惯用语去正确的清理过程点：

```
int decode ( char * path_in , char * path_out )
{
  FILE * in , * out ;
  code c ;
  int len ;
  int res = 0  ;
  if ( path_in == NULL )
    in = stdin ;
  else
    {
      if ( ( in = fopen ( path_in , "r" ) ) == NULL )
        goto error_open_file_in ;
    }
  if ( path_out == NULL )
    out = stdout ;
  else
    {
      if ( ( out = fopen ( path_out , "w" ) ) == NULL )
        goto error_open_file_out ;
    }

  if( read_code ( in , & c , & longueur ) )
    goto error_code_construction ;

  if ( decode_h ( in , c , out , longueur ) )
  goto error_decode ;

  if ( 0 ) { error_decode: res = 1 ;}
  free_code ( c ) ;
  if ( 0 ) { error_code_construction: res = 1 ; }
  if ( out != stdout ) fclose ( stdout ) ;
  if ( 0 ) { error_open_file_out: res = 1 ; }
  if ( in != stdin ) fclose ( in ) ;
  if ( 0 ) { error_open_file_in: res = 1 ; }
  return res ;
 } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-25T13:49:09.157

在我看来，`cleanup_3`应该进行清理，然后调用`cleanup_2`. 同样，`cleanup_2`应该进行清理，然后调用 cleanup_1。似乎任何时候你都这样做`cleanup_[n]`，这`cleanup_[n-1]`是必需的，因此它应该是方法的责任（例如，`cleanup_3`如果不调用就永远不能调用它`cleanup_2`，并且可能导致泄漏。）

鉴于这种方法，您只需调用清理例程，而不是 goto，然后返回。

不过，这种`goto`方法并没有*错*或*不好*，只是值得注意的是，它不一定是“最干净”的方法（恕我直言）。

如果您正在寻找最佳性能，那么我认为该`goto`解决方案是最好的。然而，我只希望它与少数性能关键的应用程序（例如，设备驱动程序、嵌入式设备等）相关。否则，这是一个优先级低于代码清晰度的微优化。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-05-29T07:50:45.720

我认为这里的问题对于给定的代码是错误的。

考虑：

1.  do_something()、init_stuff() 和 prepare_stuff() 似乎知道它们是否失败，因为在这种情况下它们返回 false 或 nil。
2.  设置状态的责任似乎是这些函数的责任，因为没有直接在 foo() 中设置状态。

因此：do_something()、init_stuff() 和 prepare_stuff() 应该**自己进行清理**。有一个单独的 cleanup_1() 函数在 do_something() 之后进行清理打破了封装的理念。这是糟糕的设计。

如果他们自己进行清理，那么 foo() 就变得非常简单。

另一方面。如果 foo() 实际上创建了自己的需要拆除的状态，那么 goto 将是合适的。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-09-30T08:51:21.543

这是我的首选：

```
bool do_something(void **ptr1, void **ptr2)
{
    if (!ptr1 || !ptr2) {
        err("Missing arguments");
        return false;
    }
    bool ret = false;

    //Pointers must be initialized as NULL
    void *some_pointer = NULL, *another_pointer = NULL;

    if (allocate_some_stuff(&some_pointer) != STUFF_OK) {
        err("allocate_some_stuff step1 failed, abort");
        goto out;
    }
    if (allocate_some_stuff(&another_pointer) != STUFF_OK) {
        err("allocate_some_stuff step 2 failed, abort");
        goto out;
    }

    void *some_temporary_malloc = malloc(1000);

    //Do something with the data here
    info("do_something OK");

    ret = true;

    // Assign outputs only on success so we don't end up with
    // dangling pointers
    *ptr1 = some_pointer;
    *ptr2 = another_pointer;
out:
    if (!ret) {
        //We are returning an error, clean up everything
        //deallocate_some_stuff is a NO-OP if pointer is NULL
        deallocate_some_stuff(some_pointer);
        deallocate_some_stuff(another_pointer);
    }
    //this needs to be freed every time
    free(some_temporary_malloc);
    return ret;
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-01-19T10:50:40.983

然而，旧的讨论......如何使用“箭头反模式”并稍后将每个嵌套级别封装在静态内联函数中？代码看起来很干净，它是最佳的（启用优化时），并且没有使用 goto。简而言之，分而治之。下面是一个例子：

```
static inline int foo_2(int bar)
{
    int return_value = 0;
    if ( prepare_stuff( bar ) ) {
        return_value = do_the_thing( bar );
    }
    cleanup_3();
    return return_value;
}

static inline int foo_1(int bar)
{
    int return_value = 0;
    if ( init_stuff( bar ) ) {
        return_value = foo_2(bar);
    }
    cleanup_2();
    return return_value;
}

int foo(int bar)
{
    int return_value = 0;
    if (do_something(bar)) {
        return_value = foo_1(bar);
    }
    cleanup_1();
    return return_value;
} 
```

在空间方面，我们在堆栈中创建了三倍的变量，这并不好，但是在这个简单的例子中，当使用 -O2 从堆栈中删除变量并使用寄存器进行编译时，这会消失。我从上面的块中`gcc -S -O2 test.c`得到的是以下内容：

```
 .section    __TEXT,__text,regular,pure_instructions
    .macosx_version_min 10, 13
    .globl  _foo                    ## -- Begin function foo
    .p2align    4, 0x90
_foo:                                   ## @foo
    .cfi_startproc
## %bb.0:
    pushq   %rbp
    .cfi_def_cfa_offset 16
    .cfi_offset %rbp, -16
    movq    %rsp, %rbp
    .cfi_def_cfa_register %rbp
    pushq   %r14
    pushq   %rbx
    .cfi_offset %rbx, -32
    .cfi_offset %r14, -24
    movl    %edi, %ebx
    xorl    %r14d, %r14d
    xorl    %eax, %eax
    callq   _do_something
    testl   %eax, %eax
    je  LBB0_6
## %bb.1:
    xorl    %r14d, %r14d
    xorl    %eax, %eax
    movl    %ebx, %edi
    callq   _init_stuff
    testl   %eax, %eax
    je  LBB0_5
## %bb.2:
    xorl    %r14d, %r14d
    xorl    %eax, %eax
    movl    %ebx, %edi
    callq   _prepare_stuff
    testl   %eax, %eax
    je  LBB0_4
## %bb.3:
    xorl    %eax, %eax
    movl    %ebx, %edi
    callq   _do_the_thing
    movl    %eax, %r14d
LBB0_4:
    xorl    %eax, %eax
    callq   _cleanup_3
LBB0_5:
    xorl    %eax, %eax
    callq   _cleanup_2
LBB0_6:
    xorl    %eax, %eax
    callq   _cleanup_1
    movl    %r14d, %eax
    popq    %rbx
    popq    %r14
    popq    %rbp
    retq
    .cfi_endproc
                                        ## -- End function

.subsections_via_symbols 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-03-25T17:07:12.783

是的，它是 C 中异常的有效和最佳实践。任何语言的所有错误处理机制都只是从错误跳转到处理，如 goto 到标签。但请考虑将标签放在 goto 之后的执行流程中并且在同一范围内。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2011-11-17T19:51:23.880

我更喜欢使用以下示例中描述的技术...

```
struct lnode *insert(char *data, int len, struct lnode *list) {
    struct lnode *p, *q;
    uint8_t good;
    struct {
            uint8_t alloc_node : 1;
            uint8_t alloc_str : 1;
    } cleanup = { 0, 0 };

    // allocate node.
    p = (struct lnode *)malloc(sizeof(struct lnode));
    good = cleanup.alloc_node = (p != NULL);

    // good? then allocate str
    if (good) {
            p->str = (char *)malloc(sizeof(char)*len);
            good = cleanup.alloc_str = (p->str != NULL);
    }

    // good? copy data
    if(good) {
            memcpy ( p->str, data, len );
    }

    // still good? insert in list
    if(good) {
            if(NULL == list) {
                    p->next = NULL;
                    list = p;
            } else {
                    q = list;
                    while(q->next != NULL && good) {
                            // duplicate found--not good
                            good = (strcmp(q->str,p->str) != 0);
                            q = q->next;
                    }
                    if (good) {
                            p->next = q->next;
                            q->next = p;
                    }
            }
    }

    // not-good? cleanup.
    if(!good) {
            if(cleanup.alloc_str)   free(p->str);
            if(cleanup.alloc_node)  free(p);
    }

    // good? return list or else return NULL
    return (good? list: NULL); 
```

}

来源： http: [//blog.staila.com/ ?p=114](http://blog.staila.com/?p=114)

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2012-06-06T08:16:12.737

我们使用[**`Daynix CSteps`**](https://github.com/daynix/bricklets/wiki/CSteps-bricklet-documentation)库作为init 函数中“ **goto 问题”的另一种解决方案。**
见[这里](http://www.daynix.com/index.php?option=com_content&view=article&id=62&Itemid=71)和[这里](https://github.com/daynix/bricklets/wiki/CSteps-bricklet-documentation)。

# java - 在struts url标签中传递参数的问题

> ID：788909
> 
> 赞同：2
> 
> 时间：2009-04-25T13:20:11.223
> 
> 标签：java, struts

```
<display:column property="id" sortable="true" 
    paramId="id" paramProperty="id" titleKey="adminList.id"/>

<display:column property="username" sortable="true" titleKey="adminList.username"/>
<display:column property="password" sortable="true" titleKey="adminList.password"/>
<display:column>
   <s:url id="removeUrl" action="remove">
    <s:param name="id" value="37" />
    </s:url>
<s:a href="%{removeUrl}" theme="ajax" targets="adminList">Remove</s:a>

 </display:column>
</display:table> 
```

当我将执行此代码时，该语句

```
<s:param name="id" value="37" /> 
```

将完美执行，但我无法在 struts 动作类中获得该值。如果我通过

```
<s:param name="id" value="adminList.id" /> 
```

那么它什么也不会通过

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T14:22:52.787

很难说到底出了什么问题，但我可以猜到：

如果您没有在 struts 操作中获取值，请检查您是否有一个名为 id 的属性以及在操作类中定义的 gettId() 和 settId() 方法。Struts 将尝试按名称填充参数中的所有属性。您正在传递一个名为 id 的参数。

问题的第二部分是您没有正确访问该变量。尝试这个：

```
 <s:param name="id" value="#attr.adminList.id" /> 
```

假设 adminList 是对象的名称而不是您的集合的名称？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T14:13:52.857

adminlist 是一个实际的对象或集合吗（我只是在看名称来做出这个假设）。检查 adminList 是否真的在 ValueStack 上，尝试打印出来。`<s:property value="%{adminList}"/>`如果你没有看到它，你还没有完成将它放在值堆栈上的工作。但是假设id对象的实际名称是id，比如int id；并且该 id 对象具有适当的 getter，public int getId(); 然后它应该可以正常工作。

# linux - 使用 Gzip 单独压缩多个文件

> ID：788920
> 
> 赞同：35
> 
> 时间：2009-04-25T13:28:36.240
> 
> 标签：linux, unix, compression, gzip

我有几个如下所示的目录：

```
dir1/
  |_foo.txt
  |_bar.txt
dir2/
  |_qux.txt
  |_bar.txt 
```

对于每个目录，我想将其中的文件压缩为 *.gz 格式，然后删除未压缩的文件。所以最后我们希望得到这样的东西：

```
 dir1/
   |_foo.gz
   |_bar.gz
 dir2/
   |_qux.gz
   |_bar.gz 
```

有没有一种简单的 Unix 方法可以做到这一点？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-04-25T13:34:11.830

```
gzip */*.txt 
```

但是每个文件的扩展名都是 .txt.gz，因为 gzip 使用它来知道原始文件名。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-25T13:38:03.223

gzip -r 目录 1 目录 2

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-04-27T07:29:28.520

即使您有子目录，以下内容也将起作用。例如 dir1/dir2/.../foo.txt

```
find . -type f -name "*.txt" -exec gzip {} \; 
```

# c# - 报告（免费 || 开源）Winforms 中 Crystal Reports 的替代品

> ID：788923
> 
> 赞同：40
> 
> 时间：2009-04-25T13:30:06.020
> 
> 标签：c#, winforms, reporting

在我的 winforms 项目中，我正在寻找一个类似于 Crystal Report 的免费或开源解决方案，它允许我打印和 PDF 化数据集的内容。¿ 有什么建议或想法吗？

我需要一些简单但快速的东西，Crystal 对我来说似乎很慢。提前致谢。

我知道这个[问题](https://stackoverflow.com/questions/586239/are-there-any-open-source-alternatives-to-crystal-reports)，但在我看来，只有与 java 相关的答案

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-08T21:06:38.720

如果您想替换 Crystal Reports ，我建议您使用[fyiReporting](http://www.fyireporting.com/)（[Forked and Moved Now Current as of 2012 ）工具。](http://reportingcloud.sourceforge.net/)我使用过 fyiReporting 和 Crystal，不得不说我更喜欢 fyiReporting（尽管他们的网站是 ghetto）。

选择fyiReporting的理由

1.  如果您想替换 Crystal，那么您已经习惯了拥有报表设计器。FyiReporting 有自己的 GUI，就像用于创建和运行报表的 Crystal Reports 一样（您可以创建和分发报表而无需构建应用程序）。

2.  FyiReports 允许您将报告导出为 PDF、excel 和 mht（静态网页），仅举几例。

3.  FyiReports 是基于 xml 的，因此可以将报告定义保存在数据库中并随时更改。

4.  如果您使用的是 .Net，FyiReporting 有一个 Web 和 Windows 窗体控件，用于在您的应用程序中嵌入报表（很像水晶报表）。我对 Java 不太确定，因为我是一个 .Net 人。

无论如何，试试 FyiReports。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-05-12T14:47:29.480

你总是可以自己动手。我在我们的项目中摆脱了 Crystal Reports，因为目前，如果不将每个人都升级到 XP，我们就无法更新旧报表，因为我们是在 VS 2008 中开发的，而新的 CR 不支持 Win2K。此外，CR 需要大约 30 秒来构建和加载报告，我的是即时的。

我编写[了自己的 XML 序列化](https://stackoverflow.com/questions/721537/streaming-xml-serialization-in-net/721591#721591)程序，并构建了从 List<T>s、DataTables 等填充的自定义对象、序列化对象、将其加载到 XmlDocument、附加 XSLT 样式表并将其写入目录包含该 XSLT 文件和任何 CSS 和图像。然后，当 XML 文件在用户浏览器中打开时，XSLT 文件将其转换为 HTML/CSS。

我也可以将其加载到 WebBrowser 控件中，并使用其中一个免费的 PDF 库将其转换为 PDF 并打印。有关更多详细信息，请参阅这些线程：

*   [使用 CSS 在 iTextSharp 中从 HTML 渲染 PDF](https://stackoverflow.com/questions/430280/render-pdf-in-itextsharp-from-html-with-css)
*   [在 ASP.NET 中将 HTML 转换为 PDF 时保持 CSS 样式](https://stackoverflow.com/questions/415535/maintain-css-styling-when-converting-html-to-pdf-in-asp-net)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-08T05:07:53.870

您可以在本地模式下使用[MS Report Viewer](http://www.gotreportviewer.com/)或开源[fyiReporting RDL 项目](http://www.fyireporting.com/)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-12T14:55:21.820

您可以使用 Visual Studio 中提供的[RDLC 文件](http://msdn.microsoft.com/en-us/library/ms252067(VS.80).aspx)来定义报表布局。[您可以使用ReportViewer 控件](http://msdn.microsoft.com/en-us/library/microsoft.reporting.winforms.reportviewer.aspx)查看 rdlc 。

两者都随 Visual Studio 开箱即用。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-12T14:53:53.727

如果您使用的是 Sql Server（任何版本，甚至是 express），那么您可以安装 Sql Server Reporting Services。这允许通过 Visual Studio 插件或通过浏览器控件创建报告，并且可以以各种格式（包括 PDF）导出报告。您可以通过包含的 winforms 报告查看器控件查看报告，或利用所有内置生成的 Web 内容。

如果您习惯在 Visual Studio 中使用数据集，那么学习曲线一点也不陡峭。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-09T04:43:30.340

JasperReports：http: [//jasperforge.org](http://jasperforge.org)。

openreports：[http](http://oreports.com/) ://oreports.com/ 用于托管 jasper 文件。

不是专门的报告工具，而是 displaytag 是一个简单的 java 标签，可以发出 csv、xls 和 pdf。

[http://displaytag.sourceforge.net/1.2/](http://displaytag.sourceforge.net/1.2/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-07T16:20:14.947

1.  [逻辑报告](http://www.freereporting.com/)
2.  [单报告](http://www.monoreport.com/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-13T15:47:07.293

你可以尝试实现这样的事情：http: [//www.codeproject.com/KB/cs/reporting__windowsforms.aspx](http://www.codeproject.com/KB/cs/reporting__windowsforms.aspx)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-13T18:52:14.587

MS 的免费 SQL Server 2008 Express（带有高级服务）看起来包括报告服务。

[http://www.microsoft.com/express/sql/download/](http://www.microsoft.com/express/sql/download/)

报告功能与完整版有何不同：http: [//msdn.microsoft.com/en-us/library/ms365166.aspx](http://msdn.microsoft.com/en-us/library/ms365166.aspx)

编辑：我不知道这是否适用于 winforms，但它看起来仍然有用。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-09T04:19:44.250

[BIRT](http://www.eclipse.org/birt/phoenix/)，[Eclipse](http://www.eclipse.org) *商业智能和报告工具*是开源的。

> BIRT 是一个基于 Eclipse 的开源报告系统，它与您的 Java/J2EE 应用程序集成以生成引人注目的报告。BIRT 提供核心报告功能，例如报告布局、数据访问和脚本。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-09T22:57:22.780

免费试用唠叨的横幅... DevExpress XtraReports 和 XRCharts。非常好的开发工具，强大的支持，经验之谈。

# c# - 如何插入数据？

> ID：788930
> 
> 赞同：0
> 
> 时间：2009-04-25T13:32:57.603
> 
> 标签：c#, ms-access, ado.net

如何使用 C# 将数据插入到具有内部连接的 Access 数据库的多个表中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T12:36:47.190

我同意这个问题很模糊，但暗示了 ACE/Jet 引擎经常被问到的问题，“如果我可以`INNER JOIN`在两个表之间创建一个，我可以`INSERT`用一个 SQL 语句进入两个表吗？” 通常紧随其后的是限定符，“......如果表之间存在`FOREIGN KEY`（访问 = 具有强制引用完整性的关系），是否可以将被引用表中生成的`INDENTITY`/AutoNumber 编号自动添加到引用表中？”

*这些*问题的答案是肯定的：创建一个`VIEW`带有`INNER JOIN`（或等价物）的列，包括`IDENTITY`列和引用列的列，`IDENTITY`然后省略列及其引用列。`INSERT INTO``VIEW``IDENTITY`

这是 ANSI-92 查询模式语法的一个简单示例（我假设您使用的是 OLE DB）：

```
CREATE TABLE TableA
(
   ID IDENTITY NOT NULL UNIQUE, 
   a_col INTEGER NOT NULL
)
;

CREATE TABLE TableB
(
   ID INTEGER NOT NULL UNIQUE
      REFERENCES TableA (ID),  
   b_col INTEGER NOT NULL
)
;

CREATE VIEW TestAB
(
   a_ID, a_col, 
   b_ID, b_col
)
AS 
SELECT A1.ID, A1.a_col, 
       B1.ID, B1.b_col
  FROM TableA AS A1
       INNER JOIN TableB AS B1
          ON A1.ID = B1.ID
;

INSERT INTO TestAB (a_col, b_col) VALUES (55, 99)
; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T13:42:54.507

我假设加入你的意思是与另一个表的外键的关系。连接是指查询而不是表。

您可以简单地进行多次插入，根据需要对每个表进行一次插入，将记录添加到父表，获取刚刚添加的新记录的键，然后使用该 ID 对任何子表进行插入，这将是外键在子表中。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-25T13:36:42.680

我不知道它是否适用于 Access，但您可以尝试：

```
INSERT INTO table (col1, col2, col3)
SELECT t1.col1, t1.col2, t2.col3
FROM table1 t1
INNER JOIN table2 t2 ON t1.Id = t2.Id 
```

如果您需要在各种表上执行此操作，请执行各种插入，JET Engine 不允许在单个语句上进行多个查询，根据[这里](https://stackoverflow.com/questions/770614/running-multiple-sql-statements-in-the-one-operation)

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-04-25T14:07:19.300

根据我的经验，没有标准的方法，但是有解决方法，但是这些方法取决于您的表/数据库的结构。

我不确定 Access 是否支持触发器、SP 和函数。我相信不，因此如果属实，以下解决方法无效。

1.  您可以在子表上使用触发器，但如果您有一个会失败的外键约束，因为您最终可能会在父表中不存在的子表中插入值。在 parent 上设置触发器是没有用的，因为您不能将参数传递给触发器。

2.  另一种解决方法可能是您从前端应用程序调用存储过程，并从该存储过程调用多个插入语句。但是，从您的问题中，我推断这不是您愿意做的，因为问题说“来自单个插入语句”。

3.  另一种解决方法是类似于触发方法，即定义一个函数，您可以从插入查询中调用一个函数。从函数中的 with 将数据插入到子表中。但是，如果存在任何完整性约束，那么您最终可能会遇到与触发器相同的问题。因为函数将在您的插入发生之前首先运行。

4.  另一种方法是；创建一个表，它是您所需表中字段的联合（作为参考，我们将其称为根表）。然后，您为该表上的插入定义触发器。现在在此根表中插入记录，并在触发器中在所需表中插入适当的字段。（您需要在触发器中使用事务以实现原子性）。

假设你有一个表结构liek emp(empid,name); empContacts(contactid,empid,number); empAddress(addressId,empid,address); 所以你创建另一个表，它是 emp 和 empContacts 字段的联合，将其命名为 Rootemp(empid,name,contactid,number,addressId,address);

为该表创建一个触发器，并从触发器内将记录插入到事务中的 emp、empContacts 和 empAddress 表中。

然而，这是一种解决方法，因为您可以从前端看到您正在调用单个插入语句，但是数据库仍在调用多个插入。

这可能不是最佳选择，因为解决方法永远不必。

PS：emp、empContact 和 empAdress 的例子可能不是一个非常聪明的例子，但我希望它确实传达了信息。

# jquery - ScriptSharp 能为我的工具包带来哪些优势？

> ID：788933
> 
> 赞同：20
> 
> 时间：2009-04-25T13:34:22.810
> 
> 标签：jquery, ria, script#

目前我们使用 jQuery 为我们的应用程序添加 RIA 优点，但最近我们一直在将 Coveo 搜索引擎实施到我们的 Sharepoint 门户中，并发现在他们的产品中使用了 ScriptSharp。ScriptSharp 能带来什么？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-25T15:46:40.183

我们说话时我正在使用 ScriptSharp，大约 2-3 周前发现了它。老实说，我喜欢它。原生 Javascript 是一个挑战，而 DOM 模型让客户端编程更加糟糕。然后我在大约六个月前发现了 jQuery，我认为这是天赐之物。jQuery 提高了我的工作效率，但我仍然经常使用 jQuery，因为您仍然需要编写、调试和调整 Javascript。

输入 ScriptSharp。它比 jQuery 提高了我的工作效率，并极大地减少了我的头痛。我能看到的最大优势是 C# 和 Visual Studio 的强大功能*在您编写代码时是您的。* 这股力量不容小觑。***现在，在编译时***消除了过去需要数小时才能调试的琐碎的 Javascript 错误。 代码行数可能是 jQuery 的两倍，但生产力要高得多，所以谁在乎呢？您基本上只是编写代码，编译/测试/调试周期要少得多。小时变成分钟。

我会说最初让 ScriptSharp 与 Microsoft AJAX 一起工作是相当困难的，直到我了解到您必须采取一个**非常重要的步骤**才能使用它。在我知道这件事之前，我把头发拔了好几天。（我相信这在 ScriptSharp 的 61 页 PDF 自述文件中有记录，但*很*容易掩盖它。）关键是选择项目类型“网站内的 Script# 类库”（或“MS Ajax 类库内一个网站") 创建 ScriptSharp 库时。这会将 ScriptSharp 项目放在网站的 Bin/Scripts 目录中，并且 -***非常重要***的是- 将编译后的输出定向到该目录，而不是 ScriptSharp 项目的默认“bin”目录。

```
Web Site or Application directory\
   Bin\ 
      Scripts\           <-- "..\\" config setting sends .js files here.
         ScriptSharp Project directory\
            Bin\         <-- will not be used at run time
               Debug\    <-- will not be used at run time 
```

简而言之，我发现这个项目很有价值。我将编写我自己的 HOW-TO（在我的情况下涉及使用 Web 用户控件）关于如何将所有内容绑定在一起，并在此处发布一个 URL。现在我已经弄清楚了 ScriptSharp，它使我在 RIA 开发中的工作效率很高。如果它更明显，并且只有 CodePlex 站点仍然存在。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-04-25T16:15:35.543

在我上一家公司，我非常广泛地使用 Script#。我设法编写了一些很酷的控件（实际上是一个完整的客户端 MVC 堆栈），这是我无法用我的 javascript 知识完成的。但是，出于几个原因，我不会再次使用它

*   该项目是闭源的，支持不是很好（自从论坛关闭以来几乎不存在）。当您深入使用它时会有很多烦恼，如果您有来源，可以解决这些烦恼。您在 s# 代码上投入的资金越多，这就会成为一个越来越大的问题。
*   它仅限于 .NET 2.0 的一个子集，即便如此，它也是一个泄漏的抽象
*   最近 Javascript 单元测试和 VS intellisense for javascript 变得更好了，因此静态类型的重要性有所降低
*   使用它限制了我对 jquery 和 javascript 的学习

js 的工具只会越来越好，直到 Script# 开源为止，它一直处于停滞状态。

如果您对交叉编译感兴趣，还可以查看[http://jsc.sourceforge.net/](http://jsc.sourceforge.net/)项目，它可以让您使用 .net 3.5 并编译为 JS、Java、Flash 甚至 PHP！不确定生成的代码的效率如何......

编辑：有一个名为 JSIL 的新项目，它还将 .net 代码重写为 JS

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-26T08:27:13.070

jsc 编译器项目支持以下场景：

*   用于浏览器的 C# 到 MSIL 到 JavaScript
*   适用于 AppJet 的 C# 到 MSIL 到 JavaScript
*   C# 到 MSIL 到 PHP5 用于托管解决方案
*   用于浏览器小程序的 C# 到 MSIL 到 Java
*   C# 到 MSIL 到 Java 的应用程序
*   C# 到 MSIL 到 Java for JavaCard
*   C# 到 MSIL 到 C99，用于本机存根应用程序
*   C# 到 MSIL 到 ActionScript3 for Flash 9
*   C# 到 MSIL 到 Adob​​e Alchemy C for Flash 9
*   C# 到 MSIL 到 C# 2.0

通过一些努力，Visual Basic 也可以用作源语言。即使 GWT 和 Script# 这样做，jsc 编译器也不会读取您的源代码。我的编译器会读取您的 IL。

jsc编译器是

*   一个实验项目
*   一个人的努力
*   已经相当有用了。
*   3岁。
*   等待捐赠以优化编译时间和输出本身

最新的示例是等离子动画，其中可以在这些平台之间使用[单个](http://jsc.svn.sourceforge.net/viewvc/jsc/examples/actionscript/FlashPlasma/) [实现：](http://jsc.svn.sourceforge.net/viewvc/jsc/examples/actionscript/FlashPlasma/FlashPlasmaEngine/Plasma.cs?view=markup)

*   [闪光 10](http://jsc.sourceforge.net/examples/web/FlashPlasma/FlashPlasma.htm)
*   [Java Applet](http://jsc.sourceforge.net/examples/web/FlashPlasma/FlashPlasmaApplet.htm)（通过画布元素）
*   [JavaScript](http://jsc.sourceforge.net/examples/web/FlashPlasma/FlashPlasmaDocument.htm)
*   Windows 窗体
*   Windows 演示基础

[![闪光等离子](https://i.stack.imgur.com/8apCv.png)](https://i.stack.imgur.com/8apCv.png)
[（来源：[sourceforge.net](http://jsc.sourceforge.net/examples/web/FlashPlasma/assets/FlashPlasma/Preview.png)）]

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-25T13:38:12.677

[Script sharp Prototype：微软的 GWT](http://www.ajaxlines.com/ajax/stuff/article/script_sharp_prototype_microsofts_gwt.php)

根据此页面：

*   具有自然结构的干净语言。
*   更容易重构和探索。
*   生成文档的能力。
*   能够轻松自定义脚本代码。

我不确定我是否同意所有这些，但无论如何这就是推销。似乎它带有一些 OO 功能。意见如下：正如我在其他时候提到的，Java 和 C# 开发人员似乎想要抛弃 Javascript 的原型/非类型化方面，因为他们不喜欢以这种方式编写代码。无类型的原型语言有它们的位置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-12-22T09:40:18.810

我想分享我的 Script# 的 jQuery 包装类。您现在可以在 Script# 项目中访问和使用 jQuery 的强大功能。

从这里获取： [http ://www.springsys.com/blog/](http://www.springsys.com/blog/)

# c# - 如果表单不活动，如何调用？

> ID：788939
> 
> 赞同：1
> 
> 时间：2009-04-25T13:37:05.037
> 
> 标签：c#, winforms

到目前为止，我使用此方法调用：

```
 public string AddText
    {
        set
        {
            if (listView1.InvokeRequired)
            {
                this.Invoke((MethodInvoker)delegate
                {
                    Textbox.text += value + "\n";
                });
            }
            else
            {
                Textbox.text += value + "\n";
            }
        }
    } 
```

这就是问题所在：

```
 var form = Form.ActiveForm as Form1;
    if (form != null)
        form.AddText = "Test"; 
```

我正在编写一个分析数据包的分析器。我不能一直关注表单，因为我必须对应用程序执行操作。我正在编写这个分析器来获取一个数据包，以便我可以分析它。

如果我触摸要分析 Form.ActiveForm 的应用程序，则返回 null。

有没有一种方法可以调用并设置文本框以添加文本，即使表单不在所有内容之上？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T22:14:00.487

我认为问题的根源在于您的数据包分析器和主窗体之间的紧密耦合。数据包分析器不应该知道任何关于活动表单的信息，甚至根本不需要知道任何表单。它使事情难以维护，因为它仅在某些时候已经不真实的非常特定的情况下工作。

您可以扭转问题，并从正在分析数据包的类中引发事件。这为您提供了更好的封装，因为现在数据包分析器不需要了解应用程序的其余部分。您可以创建自己的事件参数，也可以重复使用诸如 System.Diagnostics.DataReceivedEventArgs 之类的事件参数。然后您的表单可以接收 DataReceived 事件并调用它自己的 AddText 以调用回主线程，无论表单是否可见，它都会起作用。

至少这会起作用，但它是一个阻塞调用，因此数据包分析器线程将停止，直到表单完全处理事件并且返回到主线程的编组调用返回。如果 paket 率不是很高，那没关系，但通常您不希望停止通信线程以等待主线程更新文本框。另一种方法是使用数据包分析器中的 StringBuilder 记录文本，并通过线程安全的公共属性公开它（累积的文本，而不是 StringBuilder）。或者，如果您需要分离单独的消息，那么您可以将它们添加到 List 例如，并让线程安全属性返回一个累积消息的数组。然后，您的表单可以使用计时器以适合您的应用程序的任何速率轮询分析器以获取新的记录数据，并且仅在表格可见时。它不会更新得那么快，但对分析器线程的影响几乎为零，如果它在两次更新之间合并 StringBuilder 或 List 中的许多消息而不是与每个单个数据包连接到 Text 属性，它应该整体上运行得更快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T16:15:39.227

您可以通过表单的 OnActivation 事件为此使用工作单元模式。

在您的 AddText 方法中放入“if active form”检查。如果表单未处于活动状态，请将文本放入列表以供稍后使用。

然后，处理表单的 OnActivation 事件，如果列表有值，则将它们推回 AddText。然后，当表单被激活时（当表单获得焦点时会发生这种情况），文本将被填充。

即使 OnActivation 部分不起作用，这种通用模式也应该可以解决问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T11:27:29.050

如果您无法调用问题，那么您的答案是使用**SynchronizationContext**它始终在 Application.Run 线程上可用。因此，请执行以下操作：

在表单 OnLoad 中，将 SynchronizationContext.Current 保存到任何地方的静态字段。之后，您可以轻松地在 GUI 线程中使用 Post 或 Send 方法进行同步或异步调用。

此处描述：http: [//msdn.microsoft.com/en-us/library/system.threading.synchronizationcontext.aspx](http://msdn.microsoft.com/en-us/library/system.threading.synchronizationcontext.aspx)

好文章在这里： http: [//www.codeproject.com/KB/cpp/SyncContextTutorial.aspx](http://www.codeproject.com/KB/cpp/SyncContextTutorial.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-26T11:45:09.350

把问题分成两部分。`Trace.TraceInformation()`使用并实现处理显示方面的 TraceListener记录您的文本。

通过这种方式，您可以将日志输出重定向到文件、Windows EventLog、UI 或其他任何内容，只需在配置文件中添加一个条目即可。您不必只选择一个。如果有帮助，您可以执行上述所有操作。

这是一个如此平凡且常见的问题，因此用于实现 a 的 MSDN 示例`TraceListener`正是您所需要的。

# c++ - 如何同步EXE/DLL文件的SVN版本和版本资源？

> ID：788940
> 
> 赞同：12
> 
> 时间：2009-04-25T13:37:16.440
> 
> 标签：c++, svn, resources, build-automation

假设我有一些构建 exe 或 dll 文件的 C++ 项目。该项目已签入 SVN 存储库。我想自动将来自 SVN 的修订与嵌入在我的 exe/dll 文件中的版本资源同步，即版本应该类似于**$major.$minor.$svn_revision**。
关于如何实现这一目标的任何想法？是否有现成可用的解决方案？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-25T13:40:18.647

如果您安装了 TortoiseSVN，那么会安装一个程序，`SubWCRev`.

如果在您的文件中，您有以下值：

```
$WCREV$ 
```

然后，如果您执行以下操作，它将被最高提交的修订号替换：

```
SubWCRev .\ yourfile.txt.template yourfile.txt 
```

这将从 复制`yourfile.txt.template`，进行替换，然后写入`yourfile.txt`。

请注意，您还可以使用许多其他宏，如果您在`SubWCRev`没有任何参数的情况下执行，它会将它们全部列出在控制台上。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-07-17T13:56:54.157

这是很大的帮助，谢谢。如果它对任何人有任何帮助，我已经为 Visual Studio 2008 改进了它。

1/ 在每个项目中创建一个 /Build 文件夹

2/ 将 AssemblyInfo.cs 作为 AssemblyInfo.cs.txt 复制到 Build 文件夹，将 Build Action 设置为“None”

3/ 编辑 AssemblyInfo.cs.txt 以具有如下版本属性：

```
[assembly: AssemblyVersion("2.0.0.$WCREV$")]
[assembly: AssemblyFileVersion("2.0.0.$WCREV$")] 
```

4/ 在 Prebuild 事件中添加了以下内容：

```
SubWCRev $(SolutionDir) $(ProjectDir)\Build\AssemblyInfo.cs.txt $(ProjectDir)\Properties\AssemblyInfo.cs 
```

这在您每次编译时都有效。

我在 Visual Studio 2008 中使用 VisualSVN/TortoiseSVN 和 VisualSVN 服务器。

**更新：**

我的同事刚刚更新了他的工作副本，AssemblyInfo.cs 有冲突。似乎很明显。我已使用 VisualSVN 将其从 SVN 中排除以解决此问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-12-03T16:58:53.733

Program.X 的答案效果很好。不过，我想补充一点，如果您在提交更改之前构建可执行文件，则修订版将比正在运行的代码的实际修订版号少一。为了缓解这种情况，您可以将版本设置为

```
"2.0.$WCREV$.$WCMODS?1:0$" 
```

That will put a 1 on the end if there are any local modifications, and 0 if not. So if you look at your executable later and see 2.0.54.1, you know it's probably actually revision 55.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-25T14:30:10.993

您可能想要查看[Subversion 属性](http://svnbook.red-bean.com/en/1.5/svn.advanced.props.html)和[Subversion 关键字](http://svnbook.red-bean.com/en/1.5/svn.advanced.props.special.keywords.html)。他们没有解决资源问题，因为他们总是包含那个该死的`$KeywordName: ...$` 部分。自定义属性确实提供了一种很好的方法，可以让元数据在批处理文件中可用，而不能。

无论如何，几年前我寻找资源问题的解决方案并没有找到。因此，我们创建了自己的本土解决方案。我们更改了 RC 文件以包含在构建过​​程中生成的头文件。RC 依赖于标头，并且标头具有自定义构建规则，该规则调用批处理文件来生成标头。以下代码段将从`svn info`.

```
SET rootdir=%1
SET svnrev=0
PUSHD "%rootdir%"
FOR /F "tokens=1-4 delims=: " %%I IN ('svn info') DO (
    IF /I {%%I}=={rev} SET svnrev=%%L
)
(ECHO./*
 ECHO. * version-stamp.h - repository version information
 ECHO. */
 ECHO.#ifndef VERSION_STAMP_H
 ECHO.#define VERSION_STAMP_H
 ECHO.#define REPOSITORY_VERSION %svnrev%
 ECHO.#endif) > include\version-stamp.h
POPD 
```

然后我们创建了一个组件特定的版本标记头，名称`component-info.h`如下：

```
#ifndef component_info_h
#define component_info_h
#include "product-info.h"
#include "version-stamp.h"

#define VERS_MAJOR 1
#define VERS_MINOR 2
#define VERS_PATCH 3
#define VERS_BUILD REPOSITORY_VERSION

#define MY_COMPONENT_NAME "TPS Report Generator"    
#define MY_VERSION_NUMBER VERS_MAJOR,VERS_MINOR,VERS_PATCH,VERS_BUILD
#define MY_VERSION_STRING VERSION_STRING(VERS_MAJOR,VERS_MINOR,VERS_PATCH,VERS_BUILD)

#endif 
```

最后，我们有一个产品线版本文件，它定义了名为的产品信息`product-info.h`：

```
#ifndef product_info_h
#define product_info_h

#define PROD_VERS_MAJOR 0
#define PROD_VERS_MINOR 1
#define PROD_VERS_PATCH 0
#define PROD_VERS_BUILD 0

#define VSTR1(s) #s
#define VSTR(s) VSTR1(s)
#define VERSION_STRING(a,b,c,d) VSTR(a) "." VSTR(b) "." VSTR(c) "." VSTR(d) "\0"

#define MY_COMPANY_NAME         "IniTech\0"
#define MY_COPYRIGHT            "Copyright ©2009 " MY_COMPANY_NAME
#define MY_PRODUCT_NAME         "\0"
#define MY_PRODUCT_VERSION_NUM  PROD_VERS_MAJOR,PROD_VERS_MINOR,PROD_VERS_PATCH,PROD_VERS_BUILD
#define MY_PRODUCT_VERSION_STR  VERSION_STRING(PROD_VERS_MAJOR,PROD_VERS_MINOR,PROD_VERS_PATCH,PROD_VERS_BUILD)
#endif 
```

然后，您的资源文件`component-info.h`在适当的位置（例如`FILEVERSION MY_VERSION_NUMBER`）包含并使用各种定义。这种结构在整个版本冲压过程中给了我们很大的灵活性和可追溯性。它从批处理文件中的一个简单块发展成为这个多层次的怪物，但在过去的几年里它对我们来说效果很好。

我很难相信还没有人找到更好的方法来做到这一点。再说一次，我已经很多年没有调查过了。我假设您可以添加一个自定义`.rules`文件，该文件定义一个处理此问题的自定义工具。

# delphi - 根据是否存在声明外部函数

> ID：788949
> 
> 赞同：4
> 
> 时间：2009-04-25T13:40:39.020
> 
> 标签：delphi, function, external, gettickcount

我想从名为 GetTickCount64 的 kernel32.dll 库中声明一个外部函数。据我所知，它仅在 Vista 和更高版本的 Windows 中定义。这意味着当我如下定义函数时：

```
function GetTickCount64: int64; external kernel32 name 'GetTickCount64'; 
```

由于应用程序启动时产生的错误，我肯定无法在以前版本的 Windows 上运行我的应用程序。

有解决该问题的方法吗？假设我不想在它不存在时包含该函数，然后在我的代码中使用一些替代函数。怎么做？是否有任何编译器指令会有所帮助？我猜定义必须被这样的指令包围，而且我还必须在使用 GetTickCount64 函数的任何地方使用一些指令，对吧？

您的帮助将不胜感激。提前致谢。

马吕斯。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-25T13:51:58.540

声明该类型的函数指针，然后在运行时使用[`LoadLibrary`](http://msdn.microsoft.com/en-us/library/ms684175.aspx)or[`GetModuleHandle`](http://msdn.microsoft.com/en-us/library/ms683199.aspx)和加载该函数[`GetProcAddress`](http://msdn.microsoft.com/en-us/library/ms683212.aspx)。您可以在 Delphi 源代码中找到该技术的几个示例；查看*TlHelp32.pas*，它加载[ToolHelp 库](http://msdn.microsoft.com/en-us/library/ms686837.aspx)，旧版本的 Windows NT 上不提供该库。

```
interface

function GetTickCount64: Int64;

implementation

uses Windows, SysUtils;

type
   // Don't forget stdcall for API functions.
  TGetTickCount64 = function: Int64; stdcall;

var
  _GetTickCount64: TGetTickCount64;

// Load the Vista function if available, and call it.
// Raise EOSError if the function isn't available.
function GetTickCount64: Int64;
var
  kernel32: HModule;
begin
  if not Assigned(_GetTickCount64) then begin
    // Kernel32 is always loaded already, so use GetModuleHandle
    // instead of LoadLibrary
    kernel32 := GetModuleHandle('kernel32');
    if kernel32 = 0 then
      RaiseLastOSError;
    @_GetTickCount := GetProcAddress(kernel32, 'GetTickCount64');
    if not Assigned(_GetTickCount64) then
      RaiseLastOSError;
  end;
  Result := _GetTickCount64;
end; 
```

# flash - Flash 在 Internet Explorer 上覆盖厚框

> ID：788951
> 
> 赞同：1
> 
> 时间：2009-04-25T13:40:57.350
> 
> 标签：flash, overlay, z-index, thickbox, wmode

这是我的代码：

我的页面上有一个 Flash 幻灯片。我使用thickbox登录，但是当有人点击登录时，flash会覆盖thickbox。

我已经设法解决了 Firefox 上的问题，但在 Internet Explorer 上似乎没有任何效果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-08-17T08:55:41.887

**Trey**的答案适用于页面上的所有 Flash 项目。

tb_remove 函数的代码

```
$('object').each(function(){ this.style.display=this.regDisplay; }) 
```

应该放在里面

```
j("#TB_window").fadeOut("fast",function(){
...
}); 
```

这样它只会在淡出之后出现，而不是立即出现......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-12-12T21:02:10.817

简单的方法。仅在 IE9 和 Firefox 上测试。

[玛尼的解决方案](http://manisheriar.com/blog/flash_objects_and_z_index)

1.  将您的 Flash 内容包装在一个 div 中
2.  添加到您的对象标签
3.  在嵌入标签中设置 wmode="transparent"
4.  使用 css 为您的 div 设置位置和 z-index（不要设置负 z-index 值，因为它会使您的 flash 消失）

**CSS**

```
#flash {
position: relative; /*or absolute*/
z-index: 0;
} 
```

**XHTML**

```
<div id="flash">
<object ...>
  <param name="wmode" value="transparent">
  <embed ... wmode="transparent">
</object>
</div> 
```

而且，用 Mani 的话说……就是这样！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-25T19:53:38.360

花费者是正确的，但他没有解释太多。wmode 是嵌入 swf 时在 html 中设置的属性，需要将其设置为透明。因此，如果您使用 AC_RunActiveContent 您将`"wmode", "transparent"`作为参数添加到嵌入函数，或者在 swfoject 中添加`so.addVariable("wmode", "transparent");`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-02T14:30:52.740

我对以下 flash 对象有同样的问题：

```
<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0" width="690" height="400" id="tech" align="middle">
          <param name="allowScriptAccess" value="sameDomain" />
          <param name="movie" value="banner/banner.swf?xml_path=banner/slides.xml" />
          <param name="quality" value="high" />
          <param name="wmode" value="opaque" />
          <embed src="banner/banner.swf?xml_path=banner/slides.xml" quality="high" width="690" height="400" name="tech" align="middle" allowScriptAccess="sameDomain" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer"  />                                                             

        </object> 
```

请注意这行`<param name="wmode" value="opaque" />` 这是使其工作的关键。

希望它可以帮助你。

再见

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-25T13:52:47.197

您需要使用以下属性之一以使 Flash 位于 DOM“内部”而不是其上方。

wmode=透明 - 或 - wmode=不透明

带有破坏许多功能的缺点。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-11-26T00:20:53.047

好的，在网上搜索了 2 天的答案后，我发现了一个纯 JS 函数，可以在所有浏览器中修复它！

你去：

```
function fix_flash() {
    // loop through every embed tag on the site
    var embeds = document.getElementsByTagName('embed');
    for (i = 0; i < embeds.length; i++) {
        embed = embeds[i];
        var new_embed;
        // everything but Firefox & Konqueror
        if (embed.outerHTML) {
            var html = embed.outerHTML;
            // replace an existing wmode parameter
            if (html.match(/wmode\s*=\s*('|")[a-zA-Z]+('|")/i))
                new_embed = html.replace(/wmode\s*=\s*('|")window('|")/i, "wmode='transparent'");
            // add a new wmode parameter
            else
                new_embed = html.replace(/<embed\s/i, "<embed wmode='transparent' ");
            // replace the old embed object with the fixed version
            embed.insertAdjacentHTML('beforeBegin', new_embed);
            embed.parentNode.removeChild(embed);
        } else {
            // cloneNode is buggy in some versions of Safari & Opera, but works fine in FF
            new_embed = embed.cloneNode(true);
            if (!new_embed.getAttribute('wmode') || new_embed.getAttribute('wmode').toLowerCase() == 'window')
                new_embed.setAttribute('wmode', 'transparent');
            embed.parentNode.replaceChild(new_embed, embed);
        }
    }
    // loop through every object tag on the site
    var objects = document.getElementsByTagName('object');
    for (i = 0; i < objects.length; i++) {
        object = objects[i];
        var new_object;
        // object is an IE specific tag so we can use outerHTML here
        if (object.outerHTML) {
            var html = object.outerHTML;
            // replace an existing wmode parameter
            if (html.match(/<param\s+name\s*=\s*('|")wmode('|")\s+value\s*=\s*('|")[a-zA-Z]+('|")\s*\/?\>/i))
                new_object = html.replace(/<param\s+name\s*=\s*('|")wmode('|")\s+value\s*=\s*('|")window('|")\s*\/?\>/i, "<param name='wmode' value='transparent' />");
            // add a new wmode parameter
            else
                new_object = html.replace(/<\/object\>/i, "<param name='wmode' value='transparent' />\n</object>");
            // loop through each of the param tags
            var children = object.childNodes;
            for (j = 0; j < children.length; j++) {
                try {
                    if (children[j] != null) {
                        var theName = children[j].getAttribute('name');
                        if (theName != null && theName.match(/flashvars/i)) {
                            new_object = new_object.replace(/<param\s+name\s*=\s*('|")flashvars('|")\s+value\s*=\s*('|")[^'"]*('|")\s*\/?\>/i, "<param name='flashvars' value='" + children[j].getAttribute('value') + "' />");
                        }
                    }
                }
                catch (err) {
                }
            }
            // replace the old embed object with the fixed versiony
            object.insertAdjacentHTML('beforeBegin', new_object);
            object.parentNode.removeChild(object);
        }
    }
} 
```

现在您可以在页面使用 jQuery 加载时运行：

```
 $(document).ready(function () {
            fix_flash();    
 } 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-02-26T00:08:08.990

在thickbox.js 文件中你可以使用这个：

搜索 tb_show 函数并将其添加到“catch”之前的“try”末尾：

`$('object').each(function(){ this.regDisplay=this.style.display; this.style.display='none'; })`

和

`$('#TB_window object').each(function(){ this.style.display=this.regDisplay; })`

搜索 tb_remove 函数，并在返回之前添加：

`$('object').each(function(){ this.style.display=this.regDisplay; })`

# c++ - 如果我的应用程序内存不足怎么办？

> ID：788953
> 
> 赞同：1
> 
> 时间：2009-04-25T13:41:45.790
> 
> 标签：c++, memory-management

如果我调用 new() 时我的应用程序内存不足，我会得到异常，而 malloc() 我会得到 0 指针。

但是如果我用一些局部变量调用一个方法呢？它们也占用内存。有没有办法为“正常”变量保留内存？因此，即使 new() 抛出异常，我也可以捕获它，修复内容并仍然像往常一样调用方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-25T13:56:08.360

您的数据以以下三种方式之一进行分配：

*   静态分配的数据（静态成员或全局变量）是在应用启动时分配的，这意味着它们不会成为真正的问题。
*   堆栈分配的数据在堆栈上分配（惊喜！）堆栈是为局部变量和函数堆栈帧留出的内存区域。如果那里的空间用完，则不确定会发生什么。一些实现可能会检测到它并给您访问冲突/分段错误，而其他实现只会让您覆盖堆数据。无论如何，没有办法检测到这一点，因为一般来说，没有办法处理它。如果你的堆栈空间用完了，你就无能为力了。你甚至不能调用一个函数，因为这会占用堆栈空间。
*   调用 new/malloc 时使用堆分配的内存。在这里，您有一种机制来检测内存不足的情况，因为您可能能够处理它。（而不是分配 200mb，你也许可以用 100mb 凑合，只是在中途交换数据）

除非您执行一些繁重的递归，否则您通常不应该用完堆栈空间。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-25T13:48:53.277

C++ 语言不提供任何为局部变量保留内存的机制。您的特定 C++ 实现和/或操作系统可能会提供一些增加总堆栈大小的方法，但这通常不是必需的。

另请注意，如果对 new 的调用确实失败了，您实际上几乎无法从中恢复。许多人（包括我）不再费心检查新的故障。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-25T13:44:23.880

New 从堆中分配内存，但本地变量通常在堆栈上 - 这可能会溢出，但不太可能，具体取决于您的平台。你能提供更多细节吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-25T13:50:56.640

编译器知道每个堆栈需要多少内存。但是，足够多的堆栈（由递归引起）会使您的程序崩溃——可能没有其他方法可以解决这个问题。

该标准有一个有趣的附件，称为**实施数量**。这是非规范性的（信息性），因此不应被视为绝对真理，而是为您提供一个公平的想法。

# javascript - 如何使用 jQuery 获取 img 网址？

> ID：788957
> 
> 赞同：11
> 
> 时间：2009-04-25T13:43:12.760
> 
> 标签：javascript, jquery

`src`是否可以使用 jQuery 或 JavaScript 在当前 DOM 中获取图像的实际 URL（而不是属性值）？

即检索“example.com/foo.jpg”而不是“foo.jpg”（考虑`<base>`元素）

任何其他有趣的属性，例如 mime 类型、文件大小，或者最重要的是，实际的二进制数据呢？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-25T13:59:43.750

我想知道 jQuery 是否正在使用`.getAttribute()`- 使用 .src 似乎总是给出绝对 URL：

```
<img src="foo.jpg" id="i">

<script>
var img = document.getElementById('i');

alert(img.getAttribute('src')); // foo.jpg
alert(img.src);                 // http://..../foo.jpg
</script> 
```

要获取其余信息，您可以使用 AJAX 请求并查看发送的标头和数据吗？

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-08-03T11:10:25.297

***$(你的 IMG 选择器).attr('src');***

例如，如果我们有一个`<img src='bla-bla.jpg' id='my_img'>`

然后我们会做：

```
$('#my_img').attr('src'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-27T11:30:08.420

简单的

```
$("#my_img").src; 
```

只是它解决了问题

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-08T06:49:03.303

```
var img = $('img');
alert(img.attr('src')); // foo.jpg
var fullpath = window.location.host + img.attr('src');
alert(fullpath); // http://example.com/foo.jpg 
```

# c# - 为什么我必须在结构的构造函数中分配所有字段？

> ID：788958
> 
> 赞同：4
> 
> 时间：2009-04-25T13:43:59.387
> 
> 标签：c#, initialization

### 复制：

> [为什么必须使用非默认构造函数初始化 C# 结构中的所有字段？](https://stackoverflow.com/questions/721246/c-struct-ctor-issues)

* * *

如果在结构的构造函数中

```
internal struct BimonthlyPair
{
    internal int year;
    internal int month;
    internal int count;    

    internal BimonthlyPair(int year, int month)
    {
        this.year = year;
        this.month = month;
    }
} 
```

我没有初始化一个字段（在这种情况下是计数）我收到一个错误：

> 在将控制权返回给调用者之前，必须完全分配字段“计数”

但是，如果我分配所有字段，包括在这种情况下的计数，类似于

```
this.year = year;
this.month = month;
this.count = 0; 
```

错误消失了。

我认为发生这种情况是因为当有人创建新的结构对象时，C# 不会初始化结构字段。**但为什么？**据我所知，它在其他一些上下文中初始化变量，那么为什么结构是不同的风景呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-25T13:58:34.047

当您使用默认构造函数时，可以隐式保证结构的整个值都被清除。

当您创建自己的构造函数时，您继承了该保证，但没有强制执行它的代码，因此您需要确保整个结构具有值。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-25T13:53:19.550

我无法回答为什么。但是你可以使用 :this() 来修复它。

```
internal struct BimonthlyPair
{
    internal int year;
    internal int month;
    internal int count;

    internal BimonthlyPair(int year, int month)
        : this()  // Add this()
    {
        this.year = year;
        this.month = month;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-25T13:56:14.350

因为，与存储在堆中的类不同，结构是值对象，将保存在堆栈中。这与在使用之前分配局部变量的原理相同。

# asp.net-ajax - 使用 Asp.net ajax 就地编辑

> ID：788964
> 
> 赞同：2
> 
> 时间：2009-04-25T13:48:16.490
> 
> 标签：asp.net-ajax, scriptaculous, ajaxcontroltoolkit

我正在寻找一种在我的网络表单应用程序上执行就地编辑的方法。这是使用 scriptaculous 的此行为的链接：[http](http://wiki.github.com/madrobby/scriptaculous/ajax-inplaceeditor) ://wiki.github.com/madrobby/scriptaculous/ajax-inplaceeditor ）

我正在使用 .Net Ajax 工具包。

有谁知道我该怎么做？？？

谢谢，

尼古拉斯。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-25T14:55:01.243

我已经使用 encosia.com 上的教程来做到这一点。这很容易，他有更多关于如何在基本功能之外发展功能的文章：

[http://encosia.com/2007/08/23/seamless-inline-text-editing-with-aspnet-ajax/](http://encosia.com/2007/08/23/seamless-inline-text-editing-with-aspnet-ajax/)

# python - 如何反转矩形行进的方向？

> ID：788966
> 
> 赞同：1
> 
> 时间：2009-04-25T13:48:57.970
> 
> 标签：python, collision-detection

我对编程很陌生，因为它只是作为一门学科引入我的学校，我需要一些帮助。我的任务是制作三个球（矩形图像）在屏幕周围弹跳并相互弹开的动画。我的三个球和墙壁的反弹都很好，但我不知道如何让它们相互反弹。任何帮助将不胜感激，我当前的代码如下：

```
import pygame
import random
import sys

if __name__ =='__main__':

    ball_image1 = 'beachball1.jpg'
    ball_image2 = 'beachball2.jpg'
    ball_image3 = 'beachball3.jpg'
    bounce_sound = 'thump.wav'
    width = 800
    top = 600
    x = 0
    y = 0
    background_colour = 0,0,0
    caption= 'Bouncing Ball animation'
    velocity1 = [-1,-1]
    velocity2 = [-1,1]
    velocity3 = [1,-1]
    pygame.init ()
    frame = pygame.display.set_mode ((width, top))
    pygame.display.set_caption (caption)
    ball1= pygame.image.load (ball_image1). convert()
    ball2= pygame.image.load (ball_image2). convert()
    ball3= pygame.image.load (ball_image3). convert()
    ball_boundary_1 = ball2.get_rect (center=(random.randint(50, 750),random.randint(50, 550)))
    ball_boundary_2 = ball2.get_rect (center=(random.randint(50, 750),random.randint(50, 550)))
    ball_boundary_3 = ball2.get_rect (center=(random.randint(50, 750),random.randint(50, 550)))
    sound = pygame.mixer.Sound (bounce_sound)
    while True:
        for event in pygame.event.get():
            print event 
            if event.type == pygame.QUIT: sys.exit(0)
        if ball_boundary_1.left < 0 or ball_boundary_1.right > width:
            sound.play()
            velocity1[0] = -velocity1[0]
        if ball_boundary_1.top < 0 or ball_boundary_1.bottom > top:
            sound.play()
            velocity1[1] = -velocity1[1]
        if ball_boundary_2.left < 0 or ball_boundary_2.right > width:
            sound.play()
            velocity2[0] = -velocity2[0]
        if ball_boundary_2.top < 0 or ball_boundary_2.bottom > top:
            sound.play()
            velocity2[1] = -velocity2[1]
        if ball_boundary_3.left < 0 or ball_boundary_3.right > width:
            sound.play()
            velocity3[0] = -velocity3[0]
        if ball_boundary_3.top < 0 or ball_boundary_3.bottom > top:
            sound.play()
            velocity3[1] = -velocity3[1]

        ball_boundary_1 = ball_boundary_1.move (velocity1)
        ball_boundary_2 = ball_boundary_2.move (velocity2)
        ball_boundary_3 = ball_boundary_3.move (velocity3)
        frame.fill (background_colour)
        frame.blit (ball1, ball_boundary_1)
        frame.blit (ball2, ball_boundary_2)
        frame.blit (ball3, ball_boundary_3)
        pygame.display.flip() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-25T14:02:19.750

当两个物体“碰撞”时，它们基本上存在于同一个物理空间中，因此您必须检查这一点。在 2d 中，这很好也很容易，尤其是对于矩形。基本上编写一个名为“overlap”的函数，如果两个球发生碰撞，它会返回一个真值。例如：

```
for (i = 0; i < numberOfBalls; i++) {
    for (j = i+1; j < numberOfBalls; j++) {
        if (overlap (ball_rect[i], ball_rect[j])) {
            // you will need to write this reverse velocity code differently
            // to comply with the code above but I recommend that the balls 
            // go in an array with three elements so that you can index 
            // them. (Useful in for loops as seen above)
            ball_xvelocity[i] *= -1;
            ball_xvelocity[j] *= -1;
            ball_yvelocity[i] *= -1;
            ball_yvelocity[j] *= -1;
        }
    }
} 
```

我将把重叠功能留给你，但你应该谷歌“矩形碰撞检测”，你会发现如何。你会发现它真的没有那么可怕，并且会让你相信你可以研究和学习编程概念。

NB 具体没有给出python代码。因为这是家庭作业，所以你的工作就是写答案。对不起，只是一个 SO 政策。希望这可以帮助。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-07T09:22:54.687

正如我的讲师在我对此的特别评估中添加的那样，

> 一旦第二个球在框架周围弹跳，添加一些代码来改变球碰撞时的方向。PyGame 提供了一个函数，允许您检测两个 Rect 对象之间是否发生了碰撞。该函数名为colliderect，调用方式如下。如果两个 Rect 对象被命名为 ball_boundary_1 和 ball_boundary_2，您可以检查是否有碰撞：
> 
> ```
> if ball_boundary_1.colliderect(ball_boundary_2):
> 
>     # alter the direction of the balls with the usual method 
> ```

因此，这将用于检查“是否”发生碰撞，返回 True，并运行一些代码来反转速度。祝你好运，：我自己还没有真正做到这一点，我正要尝试一下

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-25T14:06:40.097

好吧，您实际上在提供的代码中有一些线索。检测球是否在墙上反弹的方法是检查球的顶部边界是否小于 0，这意味着它已经触及顶部边界并且需要反弹，因此您需要改变方向。

所以代码：

```
if ball_boundary_1.top < 0 or ball_boundary_1.bottom > top:
        sound.play()
        velocity1[1] = -velocity1[1] 
```

如果球在地板或天花板上反弹，基本上会改变球的垂直运动。

因此，要修改它，您需要问自己，如果两个球相互弹跳意味着什么……这意味着它们的边界以多种方式重叠。因此，例如，您可以检查球 1 的左侧或右侧是否在球 2 的水平尺寸内，并且球 1 的顶部或底部是否在球 2 的垂直尺寸内，然后两个球接触，因此改变两者的速度球。

# robots.txt - Robots.txt 阻止访问所有 https:// 页面

> ID：788974
> 
> 赞同：3
> 
> 时间：2009-04-25T13:54:07.960
> 
> 标签：robots.txt

阻止对任何机器人对 https:// 页面的所有访问的语法是什么？我有一个旧网站，现在没有 SSL，我想阻止对所有 https:// 页面的访问

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-25T14:11:32.253

我不知道它是否有效，如果机器人`robots.txt`对不同的协议使用/请求不同。`robots.txt`但是您可以通过 HTTPS 为请求提供不同的请求。

因此，当`http://example.com/robots.txt`被要求时，您交付正常的`robots.txt`. 当`https://example.com/robots.txt`被要求时，你提供`robots.txt`不允许一切的东西。

# javascript - IDE for JavaScript development

> ID：788978
> 
> 赞同：58
> 
> 时间：2009-04-25T13:56:17.953
> 
> 标签：javascript, ide

What do you suggest for JS development IDE. Is there something similar to VisualStudio IDE, so I can run/debug my application in it?

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2010-06-11T13:05:11.177

At JetBrains we've just developed lightweight [HTML/Javascript/CSS IDE WebStorm](http://www.jetbrains.com/webstorm/) that includes very smart JavaScript Editor with DOM-based autocompletion and HTML5 API support. It allows you to debug(breakpoints supported) and run your scripts directly from IDE.

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-04-25T13:58:49.617

A few options:

*   Visual Studio 2008 (including VWD Express, [http://blog.berniesumption.com/software/how-to-debug-javascript-in-internet-explorer/](http://blog.berniesumption.com/software/how-to-debug-javascript-in-internet-explorer/))
*   Adobe Dreamweaver CS4
*   Notepad++ (or any other text editor), Firefox and Firebug

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-04-25T15:05:12.140

I think IntellJ's JavaScript support is excellent, just like everything else that they do.

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-04-25T14:30:59.023

**Netbeans 6.x and Firefox+Firebug**

In the past I used **Aptana** Standalone or as a Eclipse plugin. The Pro version has some nice addons like the embedded IE (to the always embedded Firefox) and debugging support for both browsers. I found after hours of testing, that Suns **Netbeans** is the best PHP and Python IDE for Windows and Linux. I was surprised that also Javascript support can hold the candle to Aptana. So Netbeans is my recommendation (not only for Javascript).

Give it a try, its free!

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-04-25T14:00:33.030

I've found [Aptana Studio](http://www.aptana.com/) to be good.

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-04-25T16:23:40.393

I tend to recommend more and more [Netbeans](http://www.netbeans.org/features/javascript/index.html) ~~that has not been proposed yet~~ (I am blind sometimes). Netbeans is developed by Sun and support not only Java but also a few other languages (PHP,Ruby,Python, Javascript).

I use it for a while now and I am very satisfied. It is fast, provides code completion and integrates easily major JS libraries (Prototype, YUI). It has also a debugger that you can tied to FF or IE.

Try it you won't be disappointed!

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-04-25T16:12:45.783

[Komodo IDE](http://www.activestate.com/komodo/) (or the [free Komodo Edit](http://www.activestate.com/komodo_edit/) if you can live without an integrated debugger) are pretty nice.

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2010-12-18T09:51:06.033

Here's a good list of IDEs you can use for writing JavaScript:

[http://www.programmerfish.com/top-8-ide-integrated-development-environment-for-java-script-html5-ajax/](http://www.programmerfish.com/top-8-ide-integrated-development-environment-for-java-script-html5-ajax/)

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2011-04-06T14:23:11.330

Nowadays I am using JetBrains' PHPStorm and I can easily say, this is the best editor I've ever tried. Comes with lots of features that I have not seen at other editors like,

*   find a word in a directory (grep equivalent)
*   extended and useful intellisense feature with multiple files and parent classes
*   internal GIT support
*   a tree view for application structure
*   an awesome version history support that works with GIT and your local history. This is very useful when you want to take a look at a GIT untracked file, you can see all history details of the file for weeks.
*   with a great addon named CSSXFire that works with Firebug and tracks the CSS changes and import them to editor and allows you easily reproduce the same changes that you've done in Firebug CSS Console. This is really awesome
*   another useful feature is, when you want to delete or rename a file, editor searches the file has been used in this directory and notifies you. This is called `safe-refactor`
*   intellisense for files, while you typing a css background-image, a src or an href attribute

Sometimes I deal with PHP so I prefer PHPStorm, so Front End Developers should prefer WebStrorm that is specialized for us.

I think, every FE Developer should try PHPStorm or WebStorm with Firefox and Firebug.

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-04-25T16:15:03.767

I tried few IDE last week and NetBeans is my winner. It got silent upload option for file upload in background. And very good code completion, folding, etc.

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2012-10-25T15:19:28.753

Here is my experience with the applications based on Extjs in UI with Java as server side language. I am a big supporter of open source technologies/products.

I so far I have used Eclipse, Netbeans, Webstorm and notepad++ with some added plugins.

And I feel Netbeans is best in terms of Syntax highlighting and formating. It recognizes missing commas, global variables, duplicate keys for object literals in a very impressive way.

Almost similar things can be achieved by adding some pligins like Spket in eclipse too, but it asks for licence when you go for advance level of settings.

If you are not so much concern about an integrated environment with web server then Web storm is best in all the aspects, but the biggest drawback of it is, "Its paid". ( Even if it asks for 1000 Rs ).

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-04-25T14:29:25.160

Firebug and a good syntax highlighting text editor is about the best combo. It's not necessary to add in much else. With just this combo you get:

*   Ability to set breakpoints
*   Inspect objects
*   Traverse the DOM
*   Alter CSS rules on the fly
*   See network traffic/responses
*   Evaluate and substitute code on the fly in production

And there are tools which add on to Firebug:

*   [YSlow](http://developer.yahoo.com/yslow/) - Determine "why" your page is slow
*   [Fireunit](http://fireunit.org/) - Run unit tests

One of the advantage of Javascript development is that it's flexible and you can get instantaneous feedback while developing. I see no reason to get in the way of that by adding an IDE which includes a "deployment" step.

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2011-03-11T15:14:20.253

Notepad++ comes with built-in javascript syntax highlighting and [JSlint](http://sourceforge.net/projects/jslintnpp/) plugin is very handy. IMHO for debugging there is nothing better than Chrome developer tools or Firebug.

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2013-09-02T09:36:11.490

This page reviews the most advanced Javascript IDEs (in terms of refactoring and intellisense anyway) :

[http://blue-walrus.com/2013/08/review-javascript-ides/](http://blue-walrus.com/2013/08/review-javascript-ides/)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-04-25T14:14:33.447

Eclipse and JSEclipse plugin and of course Firefox + Firebug the ultimate duo. You'll find this development setup satisfactory.

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-04-25T16:16:44.357

Aptana is a great IDE as it will provide intelli-sense for CSS, javascript, html, java, etc. The debugger gives you the choice to run in FF or IE and is a full featured debugger. The community edition allows you to run a server side javascript as well. A very solid and feature rich platform for free.

# perl - Windows (XP) / Unix (Solaris) 上的 Perl 脚本配置和相对路径实现

> ID：788983
> 
> 赞同：3
> 
> 时间：2009-04-25T13:57:48.497
> 
> 标签：perl, configuration-files, relative-path

你好，

我在某种程度上遇到了关于 perl 脚本开发的难题。我使用标准（基本）Perl 安装编写了一个小的 Perl 脚本。我有以下设置：

C:\MyScript\perl.pl
C:\MyScript\configuration\config.ini
C:\MyScript\output\output.txt

这是 perl.pl 源：

```
$config      = '/configuration/config.ini';
$conf        = Config::IniFiles->new( -file => $config_file );
$output_dir  = conf->val('output', 'out_dir');
$output_file = "$output_dir/output.txt";

open (out, ">$output_file") || die ("It's not your day mate!");
print out "This is a test...";
close out; 
```

这是 config.ini 的内容：

```
[output]
output_dir = C:\MyScript\output 
```

我遇到的问题是第二行（$conf）似乎无法在该位置打开文件。因为我将在 Windows 和 unix 环境中使用这个脚本（不安装任何附加模块），所以我想知道如何解决这个问题？我希望创建一个可以通过 config.ini 文件完全配置的脚本。但是，该配置仅在我提供绝对路径时才有效，如下所示：

```
$config = 'C:\MyScript\configuration\config.ini'; 
```

但是由于这将被部署到几个不同的环境中，所以修改脚本源是不可能的。你们会推荐什么？应该如何处理这种情况？

非常感谢任何帮助和/或建议。

万事如意，MC

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-25T14:03:27.233

问题在于 $config 分配行 -

```
$config      = '/configuration/config.ini'; 
```

由于前导“/”，这将从根目录搜索 config.ini，将路径解释为绝对路径而不是相对路径。尝试将其更改为

```
$config      = './configuration/config.ini'; 
```

不过，这仅在您从“MyScript”目录执行 perl 脚本时才有效。在这种情况下查看 FindBin 模块，或者您可以操纵 $0 变量来获取您的 perl 脚本路径。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-26T18:28:30.257

这是一个始终知道哪个是您的当前目录并使用您的其他目录的解决方案

```
use strict;
use warnings;
use FindBin;
use File::Spec;
use Cwd;
BEGIN {
    $ENV{APP_ROOT} = Cwd::realpath(File::Spec->rel2abs($FindBin::Bin)) ;
}
#now you know your script directory, 
#no matter from where your script is called
#if you have Modules specific for your script which are in 
#a dir "lib" in the same dir as your script is
use lib  (
"$ENV{APP_ROOT}/lib",
);
my $config      = $ENV{APP_ROOT} . '/configuration/config.ini';
#Here is your script
#...
$output_file = "$ENV{APP_ROOT}/$output_dir/output.txt"; 
```

所有模块都来自 CORE 发行版，因此您已安装它们。请注意，Windows 接受“/”斜杠，因此您也可以在那里使用它们。

干杯。

# sql - 从左外连接获取不同的行

> ID：788984
> 
> 赞同：23
> 
> 时间：2009-04-25T13:58:28.353
> 
> 标签：sql, sql-server, sql-server-2005, linq-to-sql

我正在构建一个动态生成 sql 以搜索特定表的行的应用程序（这是主要的域类，如 Employee）。

共有三个表Table1、Table2和Table1Table2Map。Table1 与Table2 是多对多关系，通过Table1Table2Map 表映射。但由于 Table1 是我的主表，因此关系实际上就像一对多。

我的应用程序生成一个 sql，它基本上给出了一个包含所有这些表的行的结果集。select 子句和 join 不会更改，而 where 子句是基于用户交互生成的。无论如何，我不想在我的结果集中重复 Table1 的行，因为它是结果显示的主表。现在生成的查询是这样的：

```
select distinct Table1.Id as Id, Table1.Name, Table2.Description from Table1
left outer join Table1Table2Map on (Table1Table2Map.Table1Id = Table1.Id)
left outer join Table2 on (Table2.Id = Table1Table2Map.Table2Id) 
```

为简单起见，我排除了 where 子句。问题是当 Table2 中有多个行时，即使我已经说过 Table1.Id 的不同，结果集也有 Table1 的重复行，因为它必须选择 Table2 中的所有匹配行。

更详细地说，考虑对于 Id = 1 的 Table1 中的一行，Table1Table2Map 中有两行 (1, 1) 和 (1, 2) 将 Table1 映射到 Table2 中 ID 为 1, 2 的两行。上述查询返回这种情况下的重复行。现在我希望查询只返回一次 ID 为 1 的 Table1 行。这是因为 Table2 中只有一行类似于 Table1 中相应条目的活动值（此信息在 Mapping 表中）。有没有办法可以避免得到 Table1 的重复行。

我认为我试图解决问题的方式存在一些基本问题，但我无法找出它是什么。提前致谢。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-04-25T14:01:32.807

尝试：

```
left outer join (select distinct YOUR_COLUMNS_HERE ...) SUBQUERY_ALIAS on ... 
```

换句话说，不要直接连接表，连接限制您连接的行的子查询。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-02-25T10:54:14.697

您可以使用 `GROUP BY` on `Table1.Id`，这将摆脱多余的行。您无需担心加入方面的任何机制。

我在一个巨大的查询中提出了这个解决方案，这个解决方案对查询时间没有太大影响。

注意：我在被问到 3 年后才回答这个问题，但这可能会对我相信的人有所帮助。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-01T02:09:48.210

您可以将左连接重写为外部应用，以便您可以使用 top 1 和 order by，如下所示：

```
select Table1.Id as Id, Table1.Name, Table2.Description 
from Table1
outer apply (
   select top 1 *
   from Table1Table2Map
   where (Table1Table2Map.Table1Id = Table1.Id) and Table1Table2Map.IsActive = 1
   order by somethingCol 
) t1t2
outer apply (
   select top 1 *
   from Table2
   where (Table2.Id = Table1Table2Map.Table2Id)
) t2; 
```

请注意，没有“top”或“order by”的外部应用与左外部连接完全相同，它只是为您提供了更多控制权。（交叉应用相当于一个内连接）。

你也可以使用 row_number() 函数做类似的事情：

```
 select * from (
      select distinct Table1.Id as Id, Table1.Name, Table2.Description,
        rowNum = row_number() over ( partition by table1.id order by something )
      from Table1
      left outer join Table1Table2Map on (Table1Table2Map.Table1Id = Table1.Id)
      left outer join Table2 on (Table2.Id = Table1Table2Map.Table2Id)
 ) x
 where rowNum = 1; 
```

如果 IsActive 标志可以将您的其他表缩小到一行，则大多数情况不适用，但它们可能对您有用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-25T14:21:40.187

详细说明一点：您说 Table1 中的每一行在 Table2 中只有一个“活动”行。该行是否未标记为活动，以便您可以将其放在 where 子句中？或者在用户提供的动态条件中是否有一些魔法来确定什么是活动的，什么不是。

如果您不需要从 Table2 中选择任何内容，则解决方案相对简单，因为您可以使用 EXISTS 函数，但是由于您已将 TAble2.Description 放在子句中，因此我假设情况并非如此。

基本上是什么将 Table2 中的相关行与不相关的行区分开来？它是活动标志还是动态条件？第一排？这就是你应该如何删除重复项。

[DISTINCT 子句往往被过度使用](https://stackoverflow.com/questions/621884/database-development-mistakes-made-by-appdevelopers/621891#621891)。这可能不是这里的情况，但听起来你可能试图用 DISTINCT 破解你想要的结果，而不是解决真正的问题，这是一个相当普遍的问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-25T14:37:02.457

您必须在您的加入中包含活动子句（并且不需要不同）：

```
select Table1.Id as Id, Table1.Name, Table2.Description from Table1
left outer join Table1Table2Map on (Table1Table2Map.Table1Id = Table1.Id) and Table1Table2Map.IsActive = 1
left outer join Table2 on (Table2.Id = Table1Table2Map.Table2Id) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-25T14:09:18.500

如果要显示 table2 中的多行，则会显示 table1 中的重复数据。如果您愿意，可以在 table2 上使用聚合函数（IE Max，Min），这将消除 table1 中的重复行，但也会隐藏 table2 中的一些数据。

另请参阅我对问题[#70161](https://stackoverflow.com/questions/701161/sql-query-with-unique-column-value/701613#701613)的回答以获取更多说明

# executable - 有没有统一执行程序和调用函数的系统？

> ID：788987
> 
> 赞同：3
> 
> 时间：2009-04-25T13:58:51.003
> 
> 标签：executable, elf, function-calls

我希望能够从 shell 执行以下一项或多项操作： - 从程序调用任何函数，不仅是 main - 传递不仅是字符串的参数（不仅是 argv） - 让程序不仅返回 int （main 的返回代码） - 将返回值分配给 shell 级变量，以便能够将它们传递给其他程序

你明白了。例如，python toplevel 允许 python 程序这样做。C++呢？还是Linux上允许这样做的ELF替代品？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T14:04:49.057

如果您正在寻找执行此操作的操作系统 - vxWorks shell/C 解释器会执行此操作。

但是，它是 vxWorks - 一个实时操作系统（无 GUI）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-25T14:05:32.877

想出一个允许您从动态库（如 Windows 下的 DLL）中按名称调用某些函数的应用程序并不难，前提是这些函数只接受有限的参数类型选择，如整数、浮点数和固定字符串。

然而，对于大多数 C++ 程序来说，这还不够。例如，假设您的 C++ 函数将动态字符串的 std::map 作为参数接收到套接字 - 您将如何创建映射，更不用说它在 shell 中的内容了？

但是，如果您可以放弃 C++，那么有一种语言兼操作系统可以完全按照您的建议执行 - Smalltalk。如果您对这种范例感兴趣，请查看免费软件[Squeak 。](http://www.squeak.org/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-25T14:57:27.243

Windows下有RUNDLL32调用DLL函数，例如

```
RUNDLL32.EXE USER32.DLL,SwapMouseButton 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-25T15:35:25.873

你看过[c-repl](http://neugierig.org/software/c-repl/)吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-25T14:10:32.303

该系统必须被完全解释，对吧？你怎么知道你正在调用的东西的函数签名？

# asp.net - 带有 ASP.NET 中继器和 Checkbox Aync 回发问题的 UpdatePanel

> ID：788999
> 
> 赞同：2
> 
> 时间：2009-04-25T14:04:29.290
> 
> 标签：asp.net, asynchronous, updatepanel

我在这里有一个相当烦人的问题

我无法让我的 CheckBox CheckedChange 事件触发、捕获或任何失败的事件：

ASPX 代码

```
<asp:UpdatePanel runat="server" ID="udp_Lists" UpdateMode="Always">
<ContentTemplate>
    <asp:Repeater ID="rep_showings" runat="server">
        <HeaderTemplate>
        </HeaderTemplate>
        <ItemTemplate>
            <div class="div_assignment">
                <div class="div_assignment_text">
                    <asp:LinkButton runat="server" ID="lnk_show_task" OnClick="lnk_show_task_Click" CommandArgument='<%# Eval("Id") %>' Text='<%# Eval("TaskTitle") %>'></asp:LinkButton>
                </div>
                <div class="div_assignment_checkbox">
                    <asp:CheckBox runat="server" ID="chk_handle" AutoPostBack="true" OnCheckedChanged="chk_handle_Changed" ToolTip='<%# Eval("Id") %>' />
                </div>
            </div>
        </ItemTemplate>
        <FooterTemplate>
        </FooterTemplate>
    </asp:Repeater>
</ContentTemplate>
<Triggers>
</Triggers> 
```

`"chk_handle_Changed"`永远无法达到Code behind 功能。Linkbutten 完美运行。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-25T15:04:28.337

我看了一下你的问题。我使用了以下代码：

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!IsPostBack)
    {
        this.rep_showings.DataSource = new object[] { new { Title = "title", ID = "id" } };
        this.rep_showings.DataBind();
    }
}

protected void chk_handle_Changed(object source, EventArgs e)
{
    Trace.Write("here");
}

protected void lnk_show_task_Click(object source, EventArgs e)
{
    Trace.Write("here 2");
}

protected void rep_showings_ItemCommand(object source, RepeaterCommandEventArgs e)
{ } 
```

上面的代码有效。我认为您可能会在每次回发时重新绑定您的转发器 - 我通过删除 Page_Load() 中的“if (!IsPostBack)”语句对此进行了测试，并且我能够重现您描述的有问题的行为。

如果可能，应避免在每次回发时重新绑定控件。填充控件后，ViewState 会处理它的数据，因此除非数据发生变化，否则您可能不应该一直重新绑定它。*******