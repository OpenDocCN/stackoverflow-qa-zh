# StackOverflow 问答 000811000-000811999

# .net - 寻找一些网络摄像机来编程

> ID：811000
> 
> 赞同：0
> 
> 时间：2009-05-01T11:09:04.060
> 
> 标签：.net, video, networking, camera

我正在寻找可以针对以下功能进行编程的网络摄像机，

1.  可以将摄像头插入网线，即可独立拍摄视频，无需插入电脑即可使用；
2.  我可以远程控制相机，例如控制它的开始/停止/方向；
3.  我可以进行一些基本的设置工作，例如设置存储录制视频的位置，另一个例子是我可以设置一些视频参数，比如比特率。

任何建议使用哪种类型的相机和什么软件 SDK？.Net 代码/解决方案赞赏。:-)

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T11:28:03.720

如果你有现金……看看[Rovio](http://www.meetrovio.com/)。我认为它带有一个完整的 API，在你完成项目后你会有一个很酷的玩具可以玩。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T11:14:38.807

您可能想看看这个： [http ://www.hanselman.com/blog/WindowsVistaSideBarGadgetForAirLinkWebCam.aspx](http://www.hanselman.com/blog/WindowsVistaSideBarGadgetForAirLinkWebCam.aspx)

不确定是否能够控制相机本身，但对一些与网络摄像头相关的接口进行了基本介绍。

# javascript - JQuery URL 事件监听器

> ID：811003
> 
> 赞同：0
> 
> 时间：2009-05-01T11:11:45.427
> 
> 标签：javascript, jquery, html, events, listener

我试图让 JQuery 根据链接 ID 选择器突出显示一个元素

例如

> ```
> <a href="#thisid">Goto Element with ID name</a> 
> ```

突出显示下面的元素。

> ```
> <div id="thisid" class="isNowHighlighted">FooIsCoolButNotBetterThenBar</div> 
> ```

Iv 尝试搜索相关插件，但没有任何乐趣。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T11:20:20.023

所以你只想添加一个类？

```
jQuery('a[href^=#]').click(function(){
    var id = this.hash.replace('#','');
    $('#' + id).addClass('isNowHighlighted');
}); 
```

* * *

编辑：

回答您的评论；您可以在页面加载时执行相同的操作：

```
$(document).ready(function(){
    if (window.location.hash) {
        $('#' + window.location.hash.replace('#','')).addClass('isNowHighlighted');
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T11:35:28.803

由于#thisId 不是锚，它有点毫无意义，所以我会这样做：

```
<a data-highlight="thisid" href="#">Goto ..</a>

$('a[data-highlight]').click(function(event){
    $('#' + $(this).data('highlight')).addClass('isNowHighlighted');
    event.preventDefault();
}); 
```

# asp.net - Global.asax 没有为发布版本触发

> ID：811005
> 
> 赞同：4
> 
> 时间：2009-05-01T11:12:40.120
> 
> 标签：asp.net, global-asax

我们的一个应用程序具有一种机制，可以在遇到一定程度的异常时自动向我们的帮助台发送电子邮件。一个特殊的异常 NullReferenceException 引起了一些问题，我相信它是由 IIS 回收和丢失会话引起的。为了证明这一点，我想记录应用程序何时启动/停止/回收，并在 global.asax 文件中添加了一些代码来执行此操作。在调试模式下运行，日志消息被写出，一切看起来都很好。当我切换到发布构建时，问题就出现了，这会触发 Web 部署项目构建到 IIS 中配置的文件夹。

当我导航到应用程序时，未调用 ApplicationStart 方法，因为未创建日志文件并且未更新事件日志。当我重新启动 IIS 时，ApplicationEnd 也会发生同样的情况，即不会创建日志。

为什么它适用于调试版本而不是发布版本？我已经玩了好几个小时了，这让我发疯了。

提前致谢

**[编辑]：我不是 100% 确定发生了什么，但它现在似乎正在工作。我想也许我们用于记录的程序集在 ApplicationStart 执行时可能没有加载，所以我删除了所有代码，只是在方法中创建了一个文本文件。看哪，文件已创建！所以我添加了一个 if(logger != null) 类型检查来尝试输出一些诊断信息，但没有写出任何内容。所以我尝试了 try/catch 并写了一个空白文件“exception.txt”，如果抛出异常但仍然没有创建文件 - 尽管生成了事件日志和预期的日志文件！我很困惑！**

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-13T11:07:23.550

我们遇到了这个问题，解决方案是缺少**PrecompiledApp.config**文件。如果没有它，global.asax 事件不会在 IIS6 下使用 ISAPI 过滤器触发，并且*rewritten.aspx*方法记录在 blog.codeville.net 上。我们在部署之前使用 msbuild 预编译站点。

当我们的构建停止工作时，我们在这个问题上摸索了几个小时。原来，在强迫性的管家模式下，我已经从源代码管理中删除了这个文件，因为我认为它是多余的。重新添加它可以解决问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-01T11:20:06.827

如果您要发布应用程序，请检查**PrecompiledApp.config**文件。如果您从已发布的站点文件夹中删除该文件，事件将停止触发。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T11:18:39.700

我会确保在记录空引用异常时记录逻辑没有遇到某种权限问题。您是否具有访问正在写入日志的位置的适当权限？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-05T06:21:52.790

如果您需要避开**PrecompiledApp**文件并发布**Global.asax**，请转到发布并移动到底部的设置选项卡并取消选中**发布期间的预编译**。

爱的形象会帮助你 [![在此处输入图像描述](https://i.stack.imgur.com/Uy0mq.jpg)](https://i.stack.imgur.com/Uy0mq.jpg)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-12-17T11:19:24.823

我们尝试了很多东西。

1.  [Global.asax 未发布且事件未在 Global.asax 中触发](https://stackoverflow.com/q/12890068/1184435)
2.  [为什么 Global.asax 事件没有在我的 ASP .NET 网站中触发？](https://stackoverflow.com/q/1028187/1184435)
3.  [global.asax 在本地计算机上工作，但在我发布到服务器后不起作用](https://stackoverflow.com/q/3647556/1184435)
4.  [ASP.NET MVC 应用程序中的 Global.asax 之谜](https://sbrakl.wordpress.com/2014/08/28/mystery-of-global-asax-in-asp-net-mvc-application/)

我们还尝试将以下文件放入`root`和`bin`目录中。

1.  **App_global.asax.dll**和**App_global.asax.compiled**文件
2.  **预编译的App.config**

都没有用！

为了触发全局事件，对于我们的 asp.net 2.0 网站，我们必须使用 raw`Global.asax`而不是dll。`pre-compiled`

希望这对某人有帮助！干杯! 快乐编码！:D

# xslt - 使用 xslt 的查询字符串

> ID：811006
> 
> 赞同：2
> 
> 时间：2009-05-01T11:12:49.683
> 
> 标签：xslt, url

是否可以使用 xslt 访问查询字符串？

我有一个网址，例如

www.example.com/page.aspx?k=aa&lang=en

我想做类似的事情

如果 lang = en

```
<div>displaly stuff</div> 
```

别的

```
 <div>display other stuff</div> 
```

你能告诉我如何使用 xslt 做到这一点吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-01T13:42:39.137

> 是否可以使用 xslt 访问查询字符串？

**是的，如果查询字符串作为参数传递**。

**下面的代码显示访问查询字符串不需要扩展函数**。它可以作为（全局）参数传递。这是首选，因为它减少了对扩展的需求，并导致代码更清晰、更易读。

然后可以执行标记化（使用[**`tokenize()`**](http://www.w3.org/TR/xpath-functions/#func-tokenize)XSLT 2.0 或 XSLT 1.0 中的功能，使用[**FXSL 1.x**](http://fxsl.sf.net)[**`str-split-to-words`**](http://fxsl.cvs.sourceforge.net/viewvc/fxsl/fxsl-xslt2/f/strSplit-to-Words.xsl?view=markup)的模板或自写的递归标记化模板。）[](http://fxsl.sf.net)

 ****XSLT 1.0 解决方案**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:ext="http://exslt.org/common"
>

   <xsl:import href="strSplit-to-Words.xsl"/>

   <xsl:output indent="yes" omit-xml-declaration="yes"/>
     <xsl:param name="pQString" select=
     "'?login=userId&amp;tag=XSLT&amp;lang=en&amp;level=expert'"
     />

    <xsl:template match="/">
    <xsl:variable name="vwordNodes">
      <xsl:call-template name="str-split-to-words">
        <xsl:with-param name="pStr" select="$pQString"/>
        <xsl:with-param name="pDelimiters" 
                  select="'?&amp;'"/>
      </xsl:call-template>
    </xsl:variable>

    <xsl:variable name="vLang" select=
      "substring-after(ext:node-set($vwordNodes)/*
                             [starts-with(.,'lang=')]
                               [last()],
                       'lang='
                      )
      "/>

      <xsl:value-of select="concat('lang = ', $vLang)"/>
    </xsl:template>
</xsl:stylesheet> 
```

**当上述转换应用于任何 XML 文档（将不使用）时，会产生所需的结果**：

```
lang = en 
```

**请注意** *FXSL 1.x`str-split-to-words`模板的使用和 EXSLT`ext:node-set()`扩展功能*的使用。

**XSLT 2.0 解决方案**：

```
<xsl:stylesheet version="2.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:xs="http://www.w3.org/2001/XMLSchema">

   <xsl:output indent="yes" omit-xml-declaration="yes"/>

     <xsl:param name="pQString" as="xs:string" select=
     "'?login=userId&amp;tag=XSLT&amp;lang=en&amp;level=expert'"
     />

    <xsl:template match="/">
      <xsl:variable name="vLang" as="xs:string" select=
      "substring-after(
                       tokenize($pQString, '\?|&amp;')
                                 [starts-with(.,'lang=')]
                                    [last()],

                       'lang='
                       )
      "/>

      lang = "<xsl:sequence select='$vLang'/>"
    </xsl:template>
</xsl:stylesheet> 
```

**当执行上述 XSLT 2.0 转换时，它会产生正确的结果**：

```
 lang = "en" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T11:17:51.887

不在本机 XSLT 中，但您可以编写扩展对象来处理本机 XSLT 范围之外的复杂功能，例如，在您的 XSLT 中，您可以将命名空间插入到样式表中，例如

```
xmlns:ex="my:Qs" 
```

然后打电话

```
<xsl:variable name="qs" select="my:Qs('parameterName')"/> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T11:29:23.747

不，因为 XSLT 不是独立运行的编译代码。它是一种用于转换 XML 数据的技术，它被一些 XSLT 处理器调用。

因此，您可以将必要的变量数据作为参数提供给 XSLT 处理器。

# cvs - 如何查找新添加到 cvs 目录的文件列表

> ID：811007
> 
> 赞同：1
> 
> 时间：2009-05-01T11:12:56.750
> 
> 标签：cvs

如何查找新添加到 cvs 目录的文件列表

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T12:30:26.283

使用 cvs history 命令可以获得很多信息，如果你知道所有的小参数，你也可以限制获得的信息。

```
cvs history -a -x A 
```

将为您提供已添加文件的所有历史记录（-a 适用于所有用户，-x A 仅提供有关已添加文件的信息），如果您为本地目录添加 -w 标志，则可以限制更多。很难完成“新鲜”的要求，因为没有具体的选择。如果您已标记模块，则更容易找到返回标记的历史记录，只需使用 -t TAGNAME 参数，您将拥有自该标记以来所有添加的文件：

```
cvs history -a -x A -t TAGNAME 
```

或者您可以使用 -D DATE 参数获取自某个日期以来添加的所有文件：

```
cvs history -a -x A -D DATE 
```

还有很多其他选项，如果您需要更多，请查看完整文档：[history command documentation](http://ximbiot.com/cvs/manual/cvs-1.11.23/cvs_16.html#SEC144)

# asp.net - 如何使用 linq 创建通用数据上下文

> ID：811011
> 
> 赞同：0
> 
> 时间：2009-05-01T11:14:24.343
> 
> 标签：asp.net, datacontext, generics

我如何在 linq 上创建通用数据上下文意味着如果数据库更改我不必更改 linq 数据上下文上的任何内容。

请注明代码或链接

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T11:19:17.500

如果您需要这种级别的动态查询，LINQ 可能是错误的技术。LINQ 的主要优点之一是静态类型——这通常是一个优点。在你的代码中拼错一列，你会得到一个编译时错误，而不是运行时错误。

但是，如果您需要能够在不重新编译的情况下处理对数据库模式的任意更改，那么您将与 API 作斗争。改为使用标准 ADO.NET（DataReaders、DataAdapters 等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T11:17:39.983

我认为这在 VS2008 中不受支持。你必须重建你的 .dbml

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T21:48:30.950

我想你想写一个业务层。这通常是您如何让您的应用程序依赖于特定的 DAL。

# c - 如何将基于 C 的语言添加到 GCC

> ID：811022
> 
> 赞同：4
> 
> 时间：2009-05-01T11:18:35.333
> 
> 标签：c, objective-c, gcc, language-design, objective-c-runtime

如果我想修改或添加我自己的 C 扩展，并将它们添加到 GCC C 编译器，我需要做什么？我不想提议对语言进行更改，我想知道 C 编译器实际上是如何工作的。

我查看了 GCC 的源代码，它看起来好像 Objective-C 被实现为一个简单的解析器，它生成引用修改后的运行时库的代码，然后对于基于 C 的所有内容，它使用常规C 编译器。我没有深入研究它，所以我可能不在正确的轨道上。

例如，我想在 Objective-C 中添加我自己的关键字，只是为了好玩。我想添加一些看起来很容易实现的东西，比如也许`@assert`. 我想要的只是`@assert`调用一个我将添加到 Objective-C 运行时的函数：

```
objc_runtime_assert (__FILE__, __LINE__, expression, "string version of expression"); 
```

显然，无论如何我都可以将其实现为函数调用和宏，但我想了解 C 源代码的解析和编译阶段，也许我可以将自己的扩展添加到语言中以供自己使用。

我看过的源代码一直是指“树”，并且有很多很多宏可以执行操作或从这些树中获取信息。

是否有任何文档可以深入解释这类事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T11:35:27.303

这些树很可能是[抽象语法树 (AST)](http://en.wikipedia.org/wiki/Abstract_syntax_tree)，任何编译器书籍都会教授这一点。[龙书](http://en.wikipedia.org/wiki/Compilers:_Principles,_Techniques,_and_Tools)是一本非常经典的书，在我上`The essence of compilers`过Robin Hunter的课上，ISBN 0-13-727835-7。您还应该能够通过一些好的搜索词（编译器设计、AST、词法分析、自上而下的解析、自下而上的解析、语义分析、LL、LR）找到来自不同学院和大学的大量材料*。*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T18:51:30.657

这取决于您是否已经熟悉一般的编译器。如果没有，从[龙书](http://en.wikipedia.org/wiki/Dragon_Book)开始。如果是，那么 GCC 已经为您准备了一些文档：

1.  [GCC 内部手册](http://en.wikipedia.org/wiki/Dragon_Book)
2.  [GCC Wiki](http://gcc.gnu.org/wiki/)，特别是[Getting Started](http://gcc.gnu.org/wiki/GettingStarted)页面包含许多信息，包括 GCC 树。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T12:29:47.737

这取决于你是如何做的——但你可能想寻找 D 编程语言的 GCC 实现—— [GCD](http://www.digitalmars.com/d/archives/D/gnu/)。这是一项正在进行中的工作，但它是在 GCC 框架中实现的完整语言，但（到目前为止）没有得到 GCC 团队的认可。GCD 的经历可能是有益的。

# winforms - 没有太多 HWND 的拆分容器

> ID：811023
> 
> 赞同：1
> 
> 时间：2009-05-01T11:18:35.597
> 
> 标签：winforms, splitter

我需要使用拆分容器来安排我的一些控件，以便一个拆分容器嵌套在另一个容器中。我发现`SplitContainer`该类的每个实例本身都是 a`Control`并且带有两个实例，`SplitterPanel`其中的两个实例也是一个控件。

例如，在下图中，我使用 2 个`SplitContainer`实例仅安排了 3 个控件（HWND 8、9 和 5），但由于使用`SplitContainer`.

[![拆分容器](https://i.stack.imgur.com/sSjvv.png)](https://i.stack.imgur.com/sSjvv.png)
[（来源：[googlepages.com](http://agnel.kurian.googlepages.com/splitcontainer.PNG)）]

除此之外，子控件必须使用`Parent.Parent.Parent...`ad nauseum 才能到达其父窗体（是的，我可以使用`FindForm`）。有一个更好的方法吗？

**编辑：**拆分器需要调整大小

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T11:31:56.173

您可以使用 TableLayoutPanel 在其中将底部控件 ColumnSpan 设置为两个。

您可以在代码中执行此操作

```
this.tableLayoutPanel.SetColumnSpan(this.button1, 2); 
```

或者使用设计器中的属性窗口。

# asp.net - 实体框架身份列不起作用

> ID：811029
> 
> 赞同：0
> 
> 时间：2009-05-01T11:20:16.530
> 
> 标签：asp.net, entity-framework, identity-column

我对实体框架相当陌生，并且正在构建我的第一个 MVC 应用程序。我正在为一个简单的实体实现一个创建视图，但是，我遇到了（SQL Express 2005）标识列主键的问题。据我了解，框架应该处理 Identity 列并让 SQL 数据库生成 ID 值。

当我尝试使用创建视图保存而不设置 ID 值时，我收到“需要值”错误。如果我为 ID 指定任何值，它会使用数据库中的 Identity 值保存回数据库 - 即。而不是我指定的值，所以一旦 T-SQL 到达那么远，显然是正确生成的。

Identity 属性在数据库中的 ID 列上设置，StoreGeneratedPattern 在模型中设置为“Identity”（见下文）：-

属性名称="ID" Type="int" Nullable="false" StoreGeneratedPattern="Identity"

我错过了什么吗？如何告诉模型此列不需要值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T15:55:50.923

谜团已揭开。看来问题是我的命名约定始终使用“ID”作为 ID 列的列名的结果。

当我打电话时

[http://.../空缺/创建](http://.../Vacancy/Create)

路由引擎将其作为

行动=创造；编号 = ""

来自 MapRoute "{controller}/{action}/{id}"

将模型中的标识列名称更改为“VacancyID”，瞧，一切正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T22:28:15.287

我会创建一个自定义路线，这就是它们的用途......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T14:06:06.070

您没有说“需要值”错误来自何处。客户端模型中的整数值将默认为零，因此总会有一个值。没有看到堆栈，我的猜测是错误来自其他地方。当你看到错误时查看堆栈，并找出你的应用程序的哪个部分正在提升它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-29T16:43:08.170

如果您不想更改数据库架构，可以添加不带 id 参数的路由规则

```
routes.MapRoute(
   "Create",
   "{controller}/Create",
    new { action = "Create" }
); 
```

# c# - Winforms 组件的父/所有者

> ID：811036
> 
> 赞同：3
> 
> 时间：2009-05-01T11:24:46.847
> 
> 标签：c#, winforms

从嵌入在表单中的自定义 Winforms 组件中，如何获取父/所有者控件？

我有一个 IContainer 并且 Site 属性不为空，但我不知道如何到达“真正的”父级。

（这是[这个问题](https://stackoverflow.com/questions/807757/winforms-control-action-after-it-is-fully-initialized)的后续，atm 我正在尝试向父母 VisibleChanged 添加一个处理程序，但这不是我第一次面对这个问题）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-18T22:24:11.747

不理想，但试试这个......

将用户控件更改为组件类（在代码编辑器中），构建解决方案并删除所有有错误的代码（与用户控件相关但在组件中不可用，因此调试器会抱怨它）

将用户控件改回用户控件类...

现在它可以识别名称和父属性，但将组件显示为不可见，因为它不再可设计。

# jquery-ui - jQuery 可拖动和溢出问题

> ID：811037
> 
> 赞同：78
> 
> 时间：2009-05-01T11:24:48.703
> 
> 标签：jquery-ui, drag-and-drop

当我从设置为溢出的容器 div 中拖动一个 div 时，我产生了不希望的效果：滚动。

我找到了其他人遇到问题的示例，但我一直无法找到解决方案

[粘贴箱示例](http://pastebin.me/49c793a050bcd)

发生的情况是滚动只是增加了，如果您想拖动到可滚动 div 内的目的地，我可以明白为什么这将是理想的行为，但我希望能够将其移出滚动控制。

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2010-12-29T00:48:11.660

我有一个类似的问题，可以在两个溢出自动 div 之间进行拖动。在前面的答案的帮助下，我发现这种组合对我有用（Safari 5.0.3、jquery-1.4.4、jquery-ui-1.8.7）：

```
appendTo: 'body',
containment: 'window',
scroll: false,
helper: 'clone' 
```

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2009-05-01T11:57:05.020

追加到

元素，SelectorDefault:'parent'

appendTo 选项传递或选择的元素将在拖动过程中用作可拖动助手的容器。默认情况下，助手被附加到与可拖动对象相同的容器中。

代码示例 使用指定的 appendTo 选项初始化可拖动对象。

```
$('.selector').draggable({ appendTo: 'body' }); 
```

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2009-05-06T11:22:52.410

当然要注意文档

[http://docs.jquery.com/UI/Draggable#option-scroll](http://docs.jquery.com/UI/Draggable#option-scroll)

> ### 滚动
> 
> **类型：**布尔
> **默认值：** `true`
> 如果设置为`true`，容器在拖动时自动滚动。

所有进入这里的人，从我的错误中吸取教训，RT(F)M！！！

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2011-09-01T05:31:55.203

它的克隆解决方案有效，但有两个问题。

首先：克隆被附加到正文中。根据您的 css，您的元素可以更改样式，因为在它开始之前，它位于另一个元素内部，并且在拖动过程中，它将直接位于 body 元素上。

第二：有时元素必须移动，并且克隆让对象在那里。

所以，这个问题的解决方案是：

```
$('.selector').draggable({
    helper: 'clone',
    start: function(){
        $(this).hide();             
    },
    stop: function(){
        $(this).show()
    }
}); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-01-22T03:20:04.870

设置滚动选项不会阻止子项隐藏在溢出区域中。我想出了一个使用 helper 选项的工作循环。看看这个：

[http://pastebin.me/164f0a4073496563fe3179ddcec5fd6d](http://pastebin.me/164f0a4073496563fe3179ddcec5fd6d)

这里还引用了我发表的另一篇文章：

[jquery ui可拖动元素在滚动div之外不能“拖动”](https://stackoverflow.com/questions/2098387/jquery-ui-draggable-elements-not-draggable-outside-of-scrolling-div/2099100#2099100)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-02-04T20:56:01.027

您还可以指定不想包含的元素类型。

```
<div class="draggable"> 
    <h2>This will drag the div</h2>
    <ul>
       <li>This won't drag the div</li>
    </ul>
</div> 
```

应用此取消属性以忽略指定子元素中的事件

```
$('.draggable').draggable({cancel : 'ul'}); 
```

# asp.net - ASP.NET 中的向导控件 - 如何将 NextButton Causesvalidation 属性设置为 false

> ID：811040
> 
> 赞同：1
> 
> 时间：2009-05-01T11:27:59.087
> 
> 标签：asp.net, controls, wizard

我已经尝试在代码和标记中设置它，但是当单击下一步按钮时，页面被验证，我想防止这种情况发生并控制何时应该进行验证，何时不进行。任何建议或代码示例将不胜感激

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-01T13:20:55.257

`WizardStep`最简单的方法是从要跳过验证的地方删除所有验证器控件。

但是，如果您需要高级功能，则需要手动设置`CausesValidation`Next/Previous 按钮的属性。`StepNavigationTemplate`ASP.NET 向导控件不公开可让您直接访问 NavigationTemplate 中的控件的属性，也不公开任何属性以访问 NavigationTemplate。所以，我们需要依靠`FindControl`方法来完成所有的搜索。

我在研究这个问题时发现的一条方便的信息是，在运行时，它是一个名为“StepNavigationTemplateContainerID”`StepNavigationTemplate`的内部 ASP.NET 类型。`StepNavigationTemplateContainer`这使我能够找到`StepNavigationTemplate`下一个按钮。

代码如下：

* * *

```
protected void Wizard1_ActiveStepChanged(object sender, EventArgs e)
{
  int step = Wizard1.ActiveStepIndex;

  // Disable validation for Step 2\. (index is zero-based)
  if (step == 1)
  {
    ToggleValidation(false);
  }
  else  // Enable validation for subsequent steps.
  {  
    ToggleValidation(true);
  }
}

private void ToggleValidation(bool flag)
{
  WebControl stepNavTemplate = this.Wizard1.FindControl("StepNavigationTemplateContainerID") as WebControl;
  if (stepNavTemplate != null)
  {
    Button b = stepNavTemplate.FindControl("StepNextButton") as Button;
    if (b != null)
    {
      b.CausesValidation = flag;
    }
  }
} 
```

# windows - 操作系统可以告诉我何时创建新文件吗？

> ID：811042
> 
> 赞同：6
> 
> 时间：2009-05-01T11:28:55.883
> 
> 标签：windows, linux, file, operating-system

我想知道何时在特定目录上创建了新文件，而不是不时扫描目录。

我知道有一种方法可以让操作系统告诉我的程序创建了一个新文件。它是如何工作的？

如前所述，这与 [如何通知 C/C++ 中的文件/目录更改有相似之处，最好使用 POSIX](https://stackoverflow.com/questions/61253/how-to-be-notified-of-file-directory-change-in-c-c-ideally-using-posix)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-01T11:36:08.940

取决于哪个操作系统。

在 Windows 上，基本 API 是[Directory Change Notifications](http://msdn.microsoft.com/en-us/library/aa365261(VS.85).aspx)。

由于您在标签中提到 Linux，这将是[inotify API](http://linux.die.net/man/7/inotify)。

要添加到 OS X 答案，从 10.5 开始，您需要[FSEvents API](http://developer.apple.com/documentation/Darwin/Conceptual/FSEvents_ProgGuide/)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-01T11:37:16.317

在 Linux 下，查看[Inotify](http://en.wikipedia.org/wiki/Inotify)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-01T11:39:26.623

[如何在 C/C++ 中收到文件/目录更改的通知，最好使用 POSIX](https://stackoverflow.com/questions/61253/how-to-be-notified-of-file-directory-change-in-c-c-ideally-using-posix)

或者在stackoverflow中搜索inotify你会得到很多想法

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-01T15:24:17.193

[FAM](http://oss.sgi.com/projects/fam/)在所有 UNIX 上提供一致的文件监视界面。在 Linux 上，后端守护程序可能会被[Gamin](http://www.gnome.org/~veillard/gamin/)替换，但与 FAM 链接的程序可以与 Gamin 正常工作。（在幕后，FAM 可能正在使用轮询，而 Gamin 可能正在使用 inotify 或 dnotify 或 kqueue，但您不必担心实现。）

OS X.5 有[FSEvents](http://developer.apple.com/documentation/Darwin/Conceptual/FSEvents_ProgGuide/Introduction/Introduction.html)，这是非常不同的，因为它监视整个系统而不是指定的文件和目录，但也可以满足您的需求。

在 Windows 上，请参阅[Find(First|Next|Close)ChangeNotification 或 ReadDirectoryChanges](http://msdn.microsoft.com/en-us/library/aa365261.aspx)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-01T11:35:49.097

FileSystemWatcher 就是答案——它以递归方式工作。

[这里](http://www.albahari.com/nutshell/ch13.aspx)有一个例子（搜索 FileSystemWatcher）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-01T11:30:56.800

在 Windows 上使用 .Net（不确定 Linux/mono），您可以使用 FileSsytemWatcher 来监视新文件并在创建它们时引发事件。

来自 MSDN：

> 使用 FileSystemWatcher 监视指定目录中的更改。您可以监视指定目录的文件和子目录的变化。您可以创建一个组件来监视本地计算机、网络驱动器或远程计算机上的文件。

[MSDN 页面](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-01T11:33:17.403

对于 Mac OS X，此功能是 Spotlight API 的一部分。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-01T11:37:17.190

Windows API 提供了用于监视文件系统的工具 - 这里有一个示例[http://msdn.microsoft.com/en-us/library/aa365261%28VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/aa365261%28VS.85%29.aspx)

# javascript - 在后台生成pdf

> ID：811049
> 
> 赞同：0
> 
> 时间：2009-05-01T11:33:47.963
> 
> 标签：javascript, ajax, asp-classic

我有一个经典的 asp 页面，它生成一个 PDF 提供给浏览器。我想做的是有一个加载页面，它在完成后将 PDF 加载到后台，然后将其提供给浏览器，本质上是添加一个漂亮的页面，向用户指示正在发生的事情。

我看过雅虎进度条之类的东西，但我没有看到任何提供 pdf 的方法。

有人有什么建议吗？我敢肯定这一定是以前做过的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T11:39:21.740

对于这种情况，我找到了一个使用 iframe 的解决方案。这不是经典的asp，但我不明白为什么它不起作用。这是我找到的[文章。](http://encosia.com/2007/10/03/easy-incremental-status-updates-for-long-requests/)

**编辑：添加代码。**

您的应用程序调用的容器页面：

```
<head runat="server">
    <script language="javascript" type="text/javascript">
        function BuildPDF() {
            var iframe = document.createElement("iframe");
            iframe.src = "BuildPDF.asp?" + <whatever args you need>;
            iframe.style.display = "none";
            document.body.appendChild(iframe);
        }

        function UpdateProgress(message) {
            document.getElementById('txtStatus').value = message;
        }

        function SetDisplayFileName(fileName) {
            var viewFrame = document.createElement("iframe");
            viewFrame.id = "viewFrame";
            viewFrame.src = "WhateverTheNameOfYourPDFViewASPPageAndArgs";
            viewFrame.style.width = '100%';
            viewFrame.style.height = document.documentElement.clientHeight - 20;
            document.body.appendChild(viewFrame);
        }

        function ResizeFrame() {
            var viewFrame = document.getElementById("viewFrame");
            viewFrame.style.height = document.documentElement.clientHeight - 20;
        }
    </script>
</head>
<body onload="BuildPDF();" onresize="ResizeFrame();">
    <form id="form1" runat="server">
    <input type="text" id="txtStatus" style="width:80%; font-family: Tahoma, Verdana; font-size: small; font-weight: bold;" readonly="readonly" />
    <br />    
    </form>
</body> 
```

然后，在 BuildPDF.asp 的某个地方，您有一个类似这样的函数，您可以随时调用它来更新状态消息：

```
function UpdateProgress(message)
    Response.Write("<script>parent.UpdateProgress('" & message & "');</script>")
    Response.Flush()
end function 
```

您在“viewFrame”中引用的页面是流式​​传输 ContentType“application/pdf”的页面。同样，我在 ASP.Net 中做了这个，但我看不出它为什么不能在经典 ASP 中工作。

# asp.net - 如何让复选框在 ASP.NET 中工作

> ID：811059
> 
> 赞同：0
> 
> 时间：2009-05-01T11:36:45.150
> 
> 标签：asp.net, vb.net, checkbox

我正在使用在 VB.NET 1.1 框架中开发的旧 Web 应用程序。我遇到了复选框问题。

我的复选框有以下代码：

```
<asp:TemplateColumn HeaderText="Reviewed">
<ItemStyle HorizontalAlign="Center" VerticalAlign="Middle" />
<ItemTemplate>
<asp:checkbox ID="chkAppRev" Runat="server" 
    OnCheckedChanged="onCheckChange" AutoPostBack="True" />  
</ItemTemplate>
</asp:TemplateColumn> 
```

这是我的`OnCheckChanged`活动：

```
Public Sub onCheckChange(ByVal sender As Object, ByVal e As EventArgs)
    Dim strSQL As String = String.Empty
    Dim inbox As CheckBox = CType(sender, CheckBox)
    Dim dgItem As DataGridItem = CType(inbox.NamingContainer, DataGridItem)
    Dim conn As OleDb.OleDbConnection = New OleDb.OleDbConnection(ConfigurationSettings.AppSettings("CONNECTIONSTRING"))
    Try
        '--update checkbox field on record in database
        conn.Open()
        If inbox.Checked = True Then
            strSQL = "Update AppUserJobs Set AppChecked=1 " & _
            "Where AppUserId=" & Convert.ToInt32(dgItem.Cells(9).Text) & 
 " and JobId=" & Convert.ToInt32(dgItem.Cells(10).Text)

        Else
            strSQL = "Update AppUser Set AppChecked=0 " & _
            "Where AppUserId=" & Convert.ToInt32(dgItem.Cells(9).Text) & 
" and JobId=" & Convert.ToInt32(dgItem.Cells(10).Text)
        End If

        Dim cmd As OleDb.OleDbCommand = New OleDb.OleDbCommand(strSQL, conn)
        Dim intRec As Integer = cmd.ExecuteNonQuery()
        conn.Close()
    Catch ex As Exception
    Finally
        If (conn.State = ConnectionState.Open) Then
            conn.Close()
        End If
    End Try
    BindData()
End Sub 
```

这一切正常，直到我在 asp 代码和另一种方法中添加另一个复选框`oncheckchanged`，它似乎只是跳过了查询。

有谁知道我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T12:33:38.973

您在代码中有一个很大的禁忌：它默默地捕获异常并将其丢弃。

该方法中的某处存在某种异常，但是当您丢弃有关它的所有信息时，没有任何提示说明出了什么问题。可能是一些引用为空，但没有任何信息告诉您是哪一个，很难发现问题。

删除这一行，这样异常就不会被默默地掩埋：

```
Catch ex As Exception 
```

或者在它之后放置一些实际处理异常的代码。在这种情况下，您应该更改该行，以便您不会捕获基类`Exception`，而是捕获一些更具体的异常类，例如`SqlException`.

有了一些关于异常发生位置的信息，就有可能发现问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T12:00:31.270

您是否确保输入了 Runat="server" 和 AutoPostBack="True" 标签？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T12:46:25.340

可以肯定的是，您的代码中是否有错字？

**oncheckchanged**或**oncheckchange**

--

另外，“我在 asp 代码中添加了另一个复选框**和另一个 oncheckchanged 方法**”是什么意思？你真的创建了另一个处理程序吗？

# language-agnostic - 用不到 10 行的简单代码，你能做的最酷的事情是什么？帮助我启发初学者！

> ID：811074
> 
> 赞同：406
> 
> 时间：2009-05-01T11:45:47.497
> 
> 标签：language-agnostic

我正在寻找你可以用几行简单的代码做的最酷的事情。我相信你可以用[Haskell 用 15 行写一个 Mandelbrot 集，](http://mcfunley.com/cs/blogs/dan/archive/2007/12/25/1532.aspx)但很难理解。

**我的目标是启发学生编程很酷**。

我们*知道*编程很酷，因为你可以创造任何你想象的东西——它是终极的创意出路。我想激励这些初学者，让他们尽可能多地克服早期学习障碍。

现在，我的理由是自私的。我正在为 60 名半工程半商科专业的学生教授*计算机入门课程；*所有新生。他们是来自贫困高中的学生。根据我过去的经验，这个群体通常分为以下几类：一些[摇滚明星](http://www.google.com/#hl=en&safe=off&q=Rockstar+Programmers&fp=WnpED7D_IvM)，一些非常努力并且*有点*得到它的人，一些非常努力但*几乎没有*得到它的人，以及一些不在乎的人。我想尽可能有效地接触到尽可能多的这些群体。这是我如何使用计算机程序进行教学的示例：

> 这是我正在寻找的一个示例：一个 1 行 VBS 脚本，让您的计算机与您交谈：
> 
> ```
> CreateObject("sapi.spvoice").Speak InputBox("Enter your text","Talk it") 
> ```
> 
> 我可以用它来演示操作顺序。我会展示代码，让他们玩弄它，然后解释说那一行发生了很多事情，但是计算机可以理解它，因为它知道规则。然后我会向他们展示这样的东西：
> 
> ```
> 4(5*5) / 10 + 9(.25 + .75) 
> ```
> 
> 你可以看到我首先需要做的是（5*5）。然后我可以乘以 4。现在我已经创建了对象。除以 10 与调用 Speak 相同 - 在我有对象之前我不能说话，在我有 100 之前我不能除以。然后在另一边我首先创建一个 InputBox，其中包含一些关于如何显示它的说明. 当我在输入框中按 Enter 键时，它会评估或“返回”我输入的任何内容。（提示：'oooooo' 发出有趣的声音）所以当我说 Speak 时，右侧就是要说的内容。我从 InputBox 中得到它。
> 
> 所以当你在一条线上做几件事时，比如：
> 
> ```
> x = 14 + y; 
> ```
> 
> 您需要注意事物的顺序。首先我们添加 14 和 y。然后我们将结果（它的计算结果或返回值）放入 x 中。

这就是我的目标，有一堆这些很酷的例子来演示和教授课程，同时他们也很开心。我在我的室友身上试过这个例子，虽然我可能不会把它作为第一课，但她喜欢它并学到了一些东西。

一些很酷的[数学程序可以制作](http://reference.wolfram.com/legacy/v5/Tour/WritingProgramsInMathematica.html)易于理解的漂亮图形或形状，这些都是好主意，我将研究这些。这里有一些[复杂](http://www.25lines.com/)的动作脚本示例，但有点太高级了，我不会教 Flash。你还有什么其他想法？

* * *

## 回答 #1

> 赞同：339
> 
> 时间：2009-05-08T02:04:23.530

在地址栏中（在浏览器中）输入此代码，然后按 Enter。然后就可以编辑网页的所有内容了！

```
javascript:document.body.contentEditable='true'; document.designMode='on'; void 0 
```

那是我所知道的最酷的“单线”=）

* * *

## 回答 #2

> 赞同：201
> 
> 时间：2009-05-01T11:50:14.477

当我第一次写这个。

```
10 PRINT "What is your name?"
20 INPUT A$
30 PRINT "Hello " A$
40 GOTO 30 
```

把人给吓跑了！电脑记住了他们的名字！

编辑：只是为了补充这一点。如果你能说服新程序员这是他们能做的最酷的事情，他们就会成为优秀的程序员。现在，你几乎可以用一行代码做任何你想做的事情来运行别人编写的库。我个人对此完全不满意，并且认为教它没有什么好处。

* * *

## 回答 #3

> 赞同：180
> 
> 时间：2009-05-01T12:22:34.803

### PHP - Sierpinski 垫圈又名 Triforce

好的，这是 15 行代码，但结果很棒！这就是我小时候让我抓狂的那种东西。这是来自 PHP 手册：

```
$x = 200;
$y = 200;

$gd = imagecreatetruecolor($x, $y);

$corners[0] = array('x' => 100, 'y' =>  10);
$corners[1] = array('x' =>   0, 'y' => 190);
$corners[2] = array('x' => 200, 'y' => 190);

$red = imagecolorallocate($gd, 255, 0, 0); 

for ($i = 0; $i < 100000; $i++) {
  imagesetpixel($gd, round($x),round($y), $red);
  $a = rand(0, 2);
  $x = ($x + $corners[$a]['x']) / 2;
  $y = ($y + $corners[$a]['y']) / 2;
}

header('Content-Type: image/png');
imagepng($gd); 
```

![谢尔宾斯基垫片](https://i.stack.imgur.com/OlUK5.png)

* * *

## 回答 #4

> 赞同：105
> 
> 时间：2009-05-01T14:35:14.407

微软有[Small Basic](http://msdn.microsoft.com/en-us/beginner/ff384126.aspx)，一个“儿童”的 IDE。

```
pic = Flickr.GetRandomPicture("beach")
Desktop.SetWallpaper(pic) 
```

它专门用于展示编程的酷炫程度。

* * *

## 回答 #5

> 赞同：83
> 
> 时间：2009-05-01T12:57:38.387

我倾向于认为人们会对与他们的生活相关或与他们的生活相关的东西印象深刻。我会尝试将我的 10 行代码基于他们知道和理解的东西。以 Twitter 及其 API 为例。为什么不使用这个 API 来构建一些很酷的东西。以下 10 行代码将从 Twitter 返回“公共时间线”，并将其显示在控制台应用程序中...

```
using (var xmlr = XmlReader.Create("http://twitter.com/statuses/public_timeline.rss"))
    {
        SyndicationFeed
            .Load(xmlr)
            .GetRss20Formatter()
            .Feed
            .Items        
            .ToList()
            .ForEach( x => Console.WriteLine(x.Title.Text));
    } 
```

我的代码示例可能不适合您的学生。它用 C# 编写并使用 .NET 3.5。因此，如果您要教他们 PHP、Java 或 C++，这将毫无用处。然而，我的观点是，通过将您的 10 行代码与“酷、有趣且与学生相关的东西”相关联，您的示例也会变得酷、有趣且相关。

祝你好运！

[是的，我知道我遗漏了几行 using 语句和 Main 方法，但我猜这 10 行不必是字面上的 10 行]

* * *

## 回答 #6

> 赞同：80
> 
> 时间：2009-05-01T15:09:31.283

这是一个 Python telnet 服务器，它会询问用户名并向他们打招呼。这看起来很酷，因为您正在通过网络从另一台计算机与您的程序进行通信。

```
from socket import *
s=socket(AF_INET, SOCK_STREAM)
s.bind(("", 3333))
s.listen(5)
while 1:
   (c, a) = s.accept()
   c.send("What is your name? ")
   name = c.recv(100)
   c.send("Hello "+name)
   c.close() 
```

* * *

## 回答 #7

> 赞同：78
> 
> 时间：2009-05-07T17:55:11.770

我的孩子们用一个快速的 VB 脚本来操作 Microsoft Agent 角色，得到了很好的回应。对于那些不熟悉 MS Agent 的人来说，它是一系列可以通过 COM 接口操作的动画屏幕角色。您可以在[Microsoft Agent](http://www.microsoft.com/downloads/details.aspx?familyid=E11BF712-7862-45BA-826D-44AE3A11836F&displaylang=en)下载页面下载代码和字符。

以下几行会让梅林角色出现在屏幕上，飞来飞去，敲击屏幕引起你的注意，打招呼。

```
agentName = "Merlin"
agentPath = "c:\windows\msagent\chars\" & agentName & ".acs"
Set agent = CreateObject("Agent.Control.2")

agent.Connected = TRUE
agent.Characters.Load agentName, agentPath
Set character = agent.Characters.Character(agentName)

character.Show

character.MoveTo 500, 400
character.Play "GetAttention"
character.Speak "Hello, how are you?"
Wscript.Sleep 15000
character.Stop
character.Play "Hide" 
```

您可以使用许多其他命令。查看[http://www.microsoft.com/technet/scriptcenter/funzone/agent.mspx](http://www.microsoft.com/technet/scriptcenter/funzone/agent.mspx)了解更多信息。

**编辑 2011-09-02** 我最近发现 Windows 7 上没有本地安装 Microsoft Agent。但是，它[在此处](http://www.microsoft.com/products/msagent/main.aspx)作为单独的下载提供。我没有对此进行测试，因此无法验证它是否运行。

* * *

## 回答 #8

> 赞同：68
> 
> 时间：2009-05-02T04:14:09.040

我认为这些天成为一名计算机教育工作者很困难。我是。我们面临着越来越激烈的艰苦战斗。我们的学生是非常老练的*用户*，要打动他们需要付出很多努力。他们有很多工具可供他们使用，这些工​​具可以做惊人的事情。

10行代码的简单计算器？*为什么？我为此准备了 TI-86。*

将特殊效果应用于图像的脚本？*这就是 Photoshop 的用途。Photoshop 只需 10 行就可以完成任何你能做的事情。*

翻录 CD 并将文件转换为 MP3 怎么样？*呃，我已经从 BitTorrent 获得了 50,000 首歌曲。它们已经是 MP3 格式。我在我的 iPhone 上播放它们。谁还买CD？*

为了向精明的用户介绍编程，您必须找到以下内容：

a) 适用于他们觉得有趣和酷的事情，并且 b) 做了他们还不能做的事情。

假设您的学生已经可以使用最昂贵的软件。他们中的许多人确实拥有完整版的 Adob​​e CS5.5（零售价：2,600 美元；实际价格：免费），并且可以轻松获得通常会超出您部门预算的任何应用程序。

*但他们中的绝大多数人不知道这些“计算机的东西”是如何工作的。*

他们是一群非常有创造力的人：他们喜欢创造东西。他们只是想能够做或做一些他们的朋友做不到的事情。他们想要一些可以吹嘘的东西。

以下是我发现与我的学生产生共鸣的一些事情：

*   **HTML 和 CSS。**他们从中了解 MySpace 主题的工作原理并可以对其进行自定义。
*   **混搭。**他们都见过它们，但不知道如何创建它们。看看[雅虎！管道](http://pipes.yahoo.com)。有很多可教的时刻，例如 RSS、XML、文本过滤、映射和可视化。完成的 mashup 小部件可以嵌入到网页中。
*   **艺术品。**看看[上下文无关艺术](http://contextfreeart.org)。递归和随机化是制作精美图片的关键。
*   **评书。**[借助Alice](http://alice.org)等易于使用的 3D 编程环境，只需拖放即可轻松创建高质量、引人入胜的故事。

这些都不涉及传统意义上的任何编程。但他们确实利用了强大的库。我认为它们是一种不同的编程。

* * *

## 回答 #9

> 赞同：63
> 
> 时间：2009-05-01T11:57:37.563

我发现一个最喜欢的（在 GWBASIC 中）是：

```
10 input "What is your name ";N$
20 i = int(rnd * 2)
30 if i = 0 print "Hello ";N$;". You are a <fill in insult number 1>"
40 if i = 1 print "Hello ";N$;". You are a <fill in insult number 2>" 
```

我发现初学者有一些需要修正的概念。

*   计算机不会读懂你的想法。
*   计算机一次只做一件事，即使它们做的如此之快，似乎一下子就完成了。
*   计算机只是愚蠢的机器，只做他们被告知的事情。
*   计算机只能识别某些事物，而这些事物就像积木一样。
*   一个关键概念是变量是包含一个值并且其名称与该值不同的东西。
*   编辑程序的时间和程序运行的时间之间的区别。

祝你的课好运。我相信你会做得很好。

PS我相信你明白，除了材料和技能，你也在教一种态度，这同样重要。

* * *

## 回答 #10

> 赞同：62
> 
> 时间：2009-08-11T20:05:49.860

这个 C 代码可能被混淆了，但我发现它非常强大

```
#include <unistd.h>
float o=0.075,h=1.5,T,r,O,l,I;int _,L=80,s=3200;main(){for(;s%L||
(h-=o,T= -2),s;4 -(r=O*O)<(l=I*I)|++ _==L&&write(1,(--s%L?_<L?--_
%6:6:7)+"World! \n",1)&&(O=I=l=_=r=0,T+=o /2))O=I*2*O+h,I=l+T-r;} 
```

这是结果......只有 3 行......一种分形`Hello World`......

```
WWWWWWWWWWWWWWWWooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo
WWWWWWWWWWWWWWooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo
WWWWWWWWWWWWWooooooooooooooooorrrrrrrrrrrrrrrrrrrrroooooooooooooooooooooooooooo
WWWWWWWWWWWoooooooooooorrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrooooooooooooooooooooo
WWWWWWWWWWooooooooorrrrrrrrrrrrrrrrrrrrrrrllllld!!ddllllrrrrrrooooooooooooooooo
WWWWWWWWoooooooorrrrrrrrrrrrrrrrrrrrrrllllllldd!oWW!!dllllllrrrrroooooooooooooo
WWWWWWWoooooorrrrrrrrrrrrrrrrrrrrrrlllllllldddd!orro!o!dllllllrrrrrrooooooooooo
WWWWWWooooorrrrrrrrrrrrrrrrrrrrrllllllllldddd!WorddddoW!ddllllllrrrrrrooooooooo
WWWWWoooorrrrrrrrrrrrrrrrrrrrrlllllllllddd!!!o!!!   !dWW!ddddllllrrrrrrrooooooo
WWWWooorrrrrrrrrrrrrrrrrrrrllllllllldd!!!!WWWoo      WloW!!!ddddllrrrrrrrrooooo
WWWWoorrrrrrrrrrrrrrrrrrrlllllllddddWldolrrlo!Wl     r!dlooWWWoW!dllrrrrrrroooo
WWWoorrrrrrrrrrrrrrrrrlllllddddddd!!Wdo  l!               rdo!l!r!dlrrrrrrrrooo
WWoorrrrrrrrrrrrrrrlllddddddddd!!!!oolWW                       lW!ddlrrrrrrrroo
WWorrrrrrrrrrrrllld!!!!!dddd!!!!WWrd !                        rlW!ddllrrrrrrrro
Worrrrrrrllllllddd!oooWWWoloWWWWoodr                           drrWdlllrrrrrrrr
Worrrlllllllldddd!WolWrr!!dWWWlrrldr                            ro!dlllrrrrrrrr
Wrrllllllllddddd!WWolWr        oWoo                              r!dllllrrrrrrr
Wlllllllldddd!!odrrdW            o                              lWddllllrrrrrrr
Wlddddd!!!!!WWordlWrd                                          oW!ddllllrrrrrrr
olddddd!!!!!WWordlWrd                                          oW!ddllllrrrrrrr
Wlllllllldddd!!odrrdW            o                              lWddllllrrrrrrr
Wrrllllllllddddd!WWolWr        oWoo                              r!dllllrrrrrrr
Worrrlllllllldddd!WolWrr!!dWWWlrrldr                            ro!dlllrrrrrrrr
Worrrrrrrllllllddd!oooWWWoloWWWWoodr                           droWdlllrrrrrrrr
WWorrrrrrrrrrrrllld!!!!!dddd!!!!WWrd !                        rlW!ddllrrrrrrrro
WWoorrrrrrrrrrrrrrrlllddddddddd!!!!oolWW                       lW!ddlrrrrrrrroo
WWWoorrrrrrrrrrrrrrrrrlllllddddddd!!Wdo  l!               rdo!l!r!dlrrrrrrrrooo
WWWWoorrrrrrrrrrrrrrrrrrrlllllllddddWldolrrlo!Wl     r!dlooWWWoW!dllrrrrrrroooo
WWWWooorrrrrrrrrrrrrrrrrrrrllllllllldd!!!!WWWoo      WloW!!!ddddllrrrrrrrrooooo
WWWWWoooorrrrrrrrrrrrrrrrrrrrrlllllllllddd!!!o!!!   WdWW!ddddllllrrrrrrrooooooo
WWWWWWooooorrrrrrrrrrrrrrrrrrrrrllllllllldddd!WorddddoW!ddllllllrrrrrrooooooooo
WWWWWWWoooooorrrrrrrrrrrrrrrrrrrrrrlllllllldddd!orro!o!dllllllrrrrrrooooooooooo
WWWWWWWWoooooooorrrrrrrrrrrrrrrrrrrrrrllllllldd!oWW!!dllllllrrrrroooooooooooooo
WWWWWWWWWWooooooooorrrrrrrrrrrrrrrrrrrrrrrllllld!!ddllllrrrrrrooooooooooooooooo
WWWWWWWWWWWoooooooooooorrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrooooooooooooooooooooo
WWWWWWWWWWWWWooooooooooooooooorrrrrrrrrrrrrrrrrrrrroooooooooooooooooooooooooooo
WWWWWWWWWWWWWWooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo
WWWWWWWWWWWWWWWWooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo
WWWWWWWWWWWWWWWWWWWoooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo
WWWWWWWWWWWWWWWWWWWWWoooooooooooooooooooooooooooooooooooooooooooooooooooooooooo 
```

* * *

## 回答 #11

> 赞同：44
> 
> 时间：2009-05-01T12:26:38.930

如何证明您可以使用任何 Web 浏览器并在地址栏中输入 JavaScript 并获取代码以执行？

编辑：转到包含大量图像的页面并在地址栏中尝试此操作：

```
javascript:R=0; x1=.1; y1=.05; x2=.25; y2=.24; x3=1.6; y3=.24; x4=300; y4=200; x5=300; y5=200; DI=document.images; DIL=DI.length; function A(){for(i=0; i<DIL; i++){DIS=DI[ i ].style; DIS.position='absolute'; DIS.left=Math.sin(R*x1+i*x2+x3)*x4+x5; DIS.top=Math.cos(R*y1+i*y2+y3)*y4+y5}R++ }setInterval('A()',5); void(0) 
```

* * *

## 回答 #12

> 赞同：37
> 
> 时间：2009-05-01T14:59:15.333

您可以制作一个选择随机数的应用程序。你必须猜测它。如果你错了，它会说：更高或更低。如果你猜对了，这是一个很好的消息。

给学生玩很酷。

没有适当错误检查的简单 Python 版本：

```
import random

while input('Want to play higher/lower? ').lower().startswith('y'):
    n = random.randint(1, 100)
    g = int(input('Guess: '))

    while g != n:
        print('  %ser!' % (g > n and 'low' or 'high'))
        g = int(input('Guess: '))

    print('  Correct! Congratulations!') 
```

[Erik](https://stackoverflow.com/users/16942/erik)建议*计算机*应该猜出这个数字。这也可以在 10 行代码内完成（尽管现在缺乏适当的错误检查更加严重：超出范围的有效数字会导致无限循环）：

```
while input('Want to let the pc play higher/lower? ').lower().startswith('y'):
    n = int(input('Give a number between 1 and 100: '))
    lo, hi, guess, tries = 1, 100, 50, 1

    while guess != n:
        tries += 1
        lo, hi = (guess + 1, hi) if guess < n else (lo, guess - 1)
        guess = (lo + hi) // 2

    print('Computer guessed number in %d tries' % tries) 
```

* * *

## 回答 #13

> 赞同：26
> 
> 时间：2009-05-01T14:18:24.667

回到高中的计算机课上，我和几个朋友教全班如何使用 Delphi 编程。该课程主要集中在使用 Pascal 进行编程，因此 Delphi 是一个很好的下一步。我们展示了 Delphi 的事件驱动性质及其 RAD 功能。在课程结束时，我们向全班展示了一个示例应用程序，并要求他们重现它。应用程序用两个按钮*Yes*和*No*询问“*你喝醉了吗？* ” 。...我想你知道接下来会发生什么...No按钮在鼠标悬停时改变了位置，*几乎*不可能点击。

 ***学生和老师都玩得很开心。

该程序只需要几行用户编写的代码和一个简单的公式来计算按钮的移动位置。我认为其他学生都没有弄清楚，但有一些学生很接近。

* * *

## 回答 #14

> 赞同：23
> 
> 时间：2009-05-15T17:26:17.723

当我第一次想到 bash forkbomb 时，我觉得它真的很甜。如此简单，但它可以做的事情很整洁：

```
:(){ :|:& };: 
```

* * *

## 回答 #15

> 赞同：22
> 
> 时间：2009-05-04T01:23:32.010

这是作弊，甚至一点也不简单，但我曾经使用 Allegro 图形库用 20 行 C++ 编写了一个射击游戏。*一条线*是什么没有真正的标准，但它是不久前的，它纯粹是为了好玩。它甚至有粗糙的声音效果。

这是它的样子：

[20 行 http://img227.imageshack.us/img227/8770/20linesxx0.png](http://img227.imageshack.us/img227/8770/20linesxx0.png)

这是代码（**应该**编译）：

```
bool inside(int x, int y, int x2, int y2) { return (x>x2&&x<x2+20&&y>y2&&y<y2+10); }
int main() {
  BITMAP* buffer;
  float px,shotx,shoty,monstars[8],first,rnd,pressed,points = 0, maxp = 0;
  unsigned char midi[5] = {0xC0,127,0x90,25,0x54}, plgfx[] = {0,0,0,10,3,10,3,5,6,5,6,10,8,12,10,10,10,5,13,5,13,10,16,10,16,0,13,0,13,2,3,2,3,0,0,0}, mongfx[] = {0,0, 10,5, 20,0, 17,8, 15,6, 10,16, 5,6, 3,8, 0,0};
  allegro_init(), set_color_depth(32), set_gfx_mode(GFX_AUTODETECT_WINDOWED,320,240,0,0), install_timer(), install_keyboard(),  install_mouse(), buffer = create_bitmap(320,240),srand(time(NULL)),install_sound(DIGI_AUTODETECT, MIDI_AUTODETECT,""),clear_to_color(buffer,makecol32(100,100,255));
    while ((pressed=(!key[KEY_Z]&&pressed)?0:pressed)?1:1&&(((shoty=key[KEY_Z]&&shoty<0&&pressed==0?(pressed=1?200:200):first==0?-1:shoty)==200?shotx=px+9:0)==9999?1:1) && 1+(px += key[KEY_LEFT]?-0.1:0 + key[KEY_RIGHT]?0.1:0) && 1+int(px=(px<0?0:(px>228?228:px))) && !key[KEY_ESC]) {
    rectfill(buffer,0,0,244,240,makecol32(0,0,0));
    for(int i=0;i<8;i++) if (inside(shotx,shoty,i*32,monstars[i])) midi_out(midi,5);
        for (int i=0; i<8; monstars[i] += first++>8?(monstars[i]==-100?0:0.02):-100, points = monstars[i]>240?points-1:points, monstars[i]=monstars[i]>240?-100:monstars[i], points = inside(shotx,shoty,i*32,monstars[i])?points+1:points, (monstars[i] = inside(shotx,shoty,i*32,monstars[i])?shoty=-1?-100:-100:monstars[i]), maxp = maxp>points?maxp:points, i++) for (int j=1; j<9; j++) line(buffer,i*32+mongfx[j*2 - 2],monstars[i]+mongfx[j*2-1],i*32+mongfx[j*2],monstars[i]+mongfx[j*2+1],makecol32(255,0,0));
    if (int(first)%2000 == 0 && int(rnd=float(rand()%8))) monstars[int(rnd)] = monstars[int(rnd)]==-100?-20:monstars[int(rnd)]; // randomowe pojawianie potworkow
    if (shoty>0) rectfill(buffer,shotx,shoty-=0.1,shotx+2,shoty+2,makecol32(0,255,255)); // rysowanie strzalu
    for (int i=1; i<18; i++) line(buffer,px+plgfx[i*2 - 2],200-plgfx[i*2-1],px+plgfx[i*2],200-plgfx[i*2+1],makecol32(255,255,0));
    textprintf_ex(buffer,font,250,10,makecol32(255,255,255),makecol32(100,100,255),"$: %i   ",int(points)*10);
    textprintf_ex(buffer,font,250,20,makecol32(255,255,255),makecol32(100,100,255),"$$ %i   ",int(maxp)*10);
    blit(buffer, screen, 0, 0, 0, 0, 320,240);
  }
} END_OF_MAIN() 
```

* * *

## 回答 #16

> 赞同：21
> 
> 时间：2009-05-01T15:06:05.160

在这个时代，JavaScript 是展示如何使用一些非常基本的工具（例如记事本）进行编程的绝佳方式。

对于任何想要让他们的朋友惊叹的人来说，jQuery 效果是一个很好的起点！

在这一个中，只需单击页面的空白区域。

```
<html>
<head>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script>
$(document.body).click(function () {
  if ($("#pic").is(":hidden")) {
    $("#pic").slideDown("slow");
  } else {
    $("#pic").slideUp();
  }
});
</script>
</head>
<body><img id="pic" src="http://www.smidgy.com/smidgy/images/2007/07/26/lol_cat_icanhascheezburger.jpg"/>
</body>
</html> 
```

* * *

## 回答 #17

> 赞同：20
> 
> 时间：2009-05-01T11:55:25.447

[您可能会考虑类似Robocode](http://robocode.sourceforge.net/)之类的东西，其中大量编码被抽象出来，您基本上只是告诉机器人该做什么。一个简单的 10 行函数可以让机器人做很多事情，并且结果非常直观易懂。

也许 Robocode 本身不适合这项任务，但这种东西是一种将书面代码与计算机上的视觉动作联系起来的好方法，而且当你需要给出示例时，它会很有趣。

```
public class MyFirstJuniorRobot extends JuniorRobot {
 public void run() {
  setColors(green, black, blue);
  // Seesaw forever
  while (true) {
   ahead(100); // Move ahead 100
   turnGunRight(360); // Spin gun around
   back(100); // Move back 100
   turnGunRight(360); // Spin gun around
  }
 }
 public void onScannedRobot() {
  turnGunTo(scannedAngle);
  fire(1);
 }
 public void onHitByBullet() {
  turnAheadLeft(100, 90 - hitByBulletBearing);
 }
} 
```

* * *

## 回答 #18

> 赞同：18
> 
> 时间：2009-05-11T06:07:25.483

所以有一天，我决定我已经受够了。我*会*学钢琴。看到像 Elton John 这样的人对键盘如此精通，我确信这就是我想做的事情。

实际上学习钢琴是一个巨大的失望。即使在完成了八级钢琴课之后，我仍然对我弹奏钢琴的心理形象与我最初享受这项活动的想象有多么不同感到印象深刻。

然而，我真正享受的是我仅仅三个等级的乐理基础。我学习了音乐的构造。我终于能够从表演书面音乐的世界走向自己创作音乐。随后，我就可以开始玩我想玩的东西了。

* * *

不要试图让新程序员，尤其是年轻程序员眼花缭乱。“少于十行简单代码”的整个概念似乎引发了一种“给我看一些*聪明*的东西”的情绪。

您可以向新程序员展示一些聪明的东西。然后，您可以教同一个程序员如何复制这种“性能”。但这并不是让他们迷上编程的原因。教他们基本知识，让他们自己合成自己聪明的十行代码。

我将向新程序员展示以下 Python 代码：

```
input = open("input.txt", "r")
output = open("output.txt", "w")

for line in input:
    edited_line = line
    edited_line = edited_line.replace("EDTA", "ethylenediaminetetraacetic acid")
    edited_line = edited_line.replace("ATP", "adenosine triphosphate")
    output.write(edited_line) 
```

*我意识到我不需要分配`line`给`edited_line`. 但是，这只是为了让事情清楚，并表明我没有编辑原始文档。*

在不到十行的时间内，我已经详细说明了一个文档。当然，还要确保向新程序员展示所有可用[的字符串方法。](http://docs.python.org/library/stdtypes.html#string-methods "Python 文档：字符串方法")更重要的是，我展示了我可以做的三件非常有趣的事情：变量赋值、循环、文件 IO 和标准库的使用。

我想你会同意这段代码不会让人眼花缭乱。事实上，这有点无聊。不——实际上，这很无聊。但是向新程序员展示该代码，看看该程序员是否不能在一周内（如果不是当天的话）将该脚本的每个部分重新调整为更有趣的东西。当然，这会让你反感（也许使用这个脚本来制作一个简单的 HTML 解析器），但其他一切都需要时间和经验。

* * *

## 回答 #19

> 赞同：17
> 
> 时间：2009-05-01T20:50:05.693

像大多数其他评论者一样，我开始编写代码来解决数学问题（或者为我设计的非常糟糕的游戏创建图形——比如印第安纳琼斯大战僵尸）。

真正让我开始（在数学和编程方面）是从基于文本、选择你自己的冒险风格的游戏......到更多基于图形的游戏。我开始为方格纸着色和绘制像素，直到我进入几何学……并发现了如何使用方程来绘制曲线和直线、框等。

我的观点是，我*真的*可以进入像处理（[http://processing.org/](http://processing.org/)）这样的典型程序看起来像这样的东西：

```
void setup() 
{
  size(200, 200); 
  noStroke();
  rectMode(CENTER);
}

void draw() 
{   
  background(51); 
  fill(255, 204);
  rect(mouseX, height/2, mouseY/2+10, mouseY/2+10);
  fill(255, 204);
  int inverseX = width-mouseX;
  int inverseY = height-mouseY;
  rect(inverseX, height/2, (inverseY/2)+10, (inverseY/2)+10);
} 
```

对我来说，这是未来的“标志”。

有一些简单的“hello world”示例可以快速让某人绘制和更改代码，并查看事情如何中断以及可以创建哪些奇怪的“意外”......一直到更高级的交互和分形创建......

* * *

## 回答 #20

> 赞同：15
> 
> 时间：2009-05-01T16:01:38.117

您可以使用用[AutoIt](http://www.autoitscript.com/autoit3/index.shtml)编写的脚本，它模糊了使用传统应用程序和编程之间的界限。

例如，一个脚本打开记事本并让他们自己的计算机在其中和通过消息框侮辱他们，然后不留下任何行为的痕迹：

```
Run("notepad.exe")
WinWaitActive("Untitled - Notepad")
Send("You smell of human.")
Sleep(10000)
MsgBox(0, "Humans smell bad", "Yuck!")
WinClose("Untitled - Notepad")
WinWaitActive("Notepad", "Do you want to save")
Send("!n") 
```

* * *

## 回答 #21

> 赞同：13
> 
> 时间：2009-05-01T19:27:37.700

我记得当我第一次开始编码循环时，我总是印象深刻。您编写 5 到 10 行代码（或更少）并打印出数百行（或您指定的多少行）。（我首先学习的是 PHP 和 Java）。

```
for( int i = 0; i < 200; i++ )
{
   System.out.println( i );
} 
```

* * *

## 回答 #22

> 赞同：13
> 
> 时间：2009-05-02T08:06:40.543

我认为一个学生入门的好地方可能是[Greasemonkey](http://en.wikipedia.org/wiki/Greasemonkey)。userscripts.org 上有数千个示例脚本，非常好的阅读材料，其中一些非常小。Greasemonkey 脚本会影响网页，如果不进行操作，学生已经熟悉使用这些网页。Greasemonkey 本身提供了一种非常简单的方法来在测试时编辑和启用/禁用脚本。

例如，这里是“Google Two Columns”脚本：

```
result2 = '<table width="100%" align="center" cellpadding="10" style="font-size:12px">';
gEntry = document.evaluate("//li[@class='g'] | //div[@class='g'] | //li[@class='g w0'] | //li[@class='g s w0']",document,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null);
for (var i = 0; i < gEntry.snapshotLength; i++) {
  if (i==0) { var sDiv = gEntry.snapshotItem(i).parentNode.parentNode; }
  if(i%2 == 0) { result2 += '<tr><td width="50%" valign="top">'+gEntry.snapshotItem(i).innerHTML+'</td>'; }
  if(i%2 == 1) { result2 += '<td width="50%" valign="top">'+gEntry.snapshotItem(i).innerHTML+'</td></tr>'; }
}
sDiv.innerHTML = result2+'</table>';

if (document.getElementById('mbEnd') !== null) { document.getElementById('mbEnd').style.display = 'none'; } 
```

* * *

## 回答 #23

> 赞同：10
> 
> 时间：2009-05-01T20:41:40.970

这是一个非常基本的基于文​​本的 C# 程序，可以模拟老虎机的旋转动作。它不包括不同的获胜几率或现金支出，但这对学生来说可能是一个很好的练习。

对不起，它超过10行。

```
string[] symbols = new[] { "#", "?", "~" }; // The symbols on the reel
Random rand = new Random();

do
{
    string a="",b="",c="";

    for( int i = 0; i < 20; i++ )
    {
        Thread.Sleep( 50 + 25 * i ); // slow down more the longer the loop runs

        if( i < 10 )
            a = symbols[rand.Next( 0, symbols.Length )];

        if( i < 15 )
            b = symbols[rand.Next( 0, symbols.Length )];

        c = symbols[rand.Next( 0, symbols.Length )];

        Console.Clear();
        Console.WriteLine( "Spin: " + a + b + c );
    }

    if( a == b && b == c )
        Console.WriteLine( "You win. Press enter to play again or type \"exit\" to exit" );
    else
        Console.WriteLine( "You lose. Press enter to play again or type \"exit\" to exit" );
}
while( Console.ReadLine() != "exit" ); 
```

* * *

## 回答 #24

> 赞同：9
> 
> 时间：2009-05-01T11:55:30.157

书签怎么样？它将向他们展示如何在不需要任何开发工具的情况下操作他们每天使用的东西（互联网）。

* * *

## 回答 #25

> 赞同：9
> 
> 时间：2009-05-01T12:36:16.720

使用[Tcl](http://en.wikipedia.org/wiki/Tcl)，您有一个简单的文本编辑器，其中包含大约 12 行代码的保存按钮（但没有打开，这将需要另外 8 行代码）。它适用于所有标准平台：

```
pack [frame .toolbar] -side top -fill x
pack [button .save -text save -command save] -in .toolbar -side left
pack [scrollbar .vsb -orient vertical -command [list .text yview]] -side right -fill y
pack [text .text -wrap word -yscrollcommand [list .vsb set]] -side left -fill both -expand true
proc save {} {
    set filename [tk_getSaveFile]
    if {$filename ne ""} {
        set f [open $filename w]
        puts $f [.text get 1.0 end-1c]
        close $f
    }
} 
```

我意识到目标是 10 行，所以如果你想坚持到 10 行或更少，没有加载或保存的简单文本编辑器只有两行。这还不算太破旧。

```
pack [scrollbar .vsb -orient vertical -command [list .text yview]] -side left -fill y
pack [text .text -wrap word -yscrollcommand [list .vsb set]] -side left -fill both -expand true 
```

在您选择的平台上使用“wish *filename* ”执行上述任一代码块。Wish 带有大多数 *nix 和 mac，但您必须为 windows 手动安装它。

更进一步，两行脚本也可以用 python 编写，虽然它需要 8 行，但仍低于 10 行目标：

```
from Tkinter import *
root=Tk()
text = Text(wrap="word")
sb = Scrollbar(orient="vertical", command=text.yview)
text.configure(yscrollcommand=sb.set)
sb.pack(side="right", fill="y")
text.pack(side="left", fill="both", expand=True)
root.mainloop() 
```

* * *

## 回答 #26

> 赞同：8
> 
> 时间：2009-05-01T12:21:48.910

如果您负担得起硬件，使用 Arduino 板 + 处理将产生一些非常酷的东西，尽管对于可能对编程完全不感兴趣的人来说它可能有点先进。

* * *

## 回答 #27

> 赞同：8
> 
> 时间：2009-05-15T17:44:29.393

我最近在一篇文章“我写过[的最短、最有用的程序”中写到了这一点。](http://softwareplusplus.wordpress.com/2009/05/04/the-shortest-most-useful-program-that-i-have-ever-written/)

总结：我在 1996 年写了一个 3 行的 VB6 应用程序，我仍然每天都在使用它。一旦 exe 被放入“Send-to”文件夹中。它使您可以右键单击资源管理器中的文件并将该文件的完整路径发送到剪贴板。

```
Public Sub Main()   
    Clipboard.SetText Command$   
End Sub 
```

* * *

## 回答 #28

> 赞同：7
> 
> 时间：2009-05-01T16:43:26.957

有趣的是，您提到了 Mandelbrot 集，因为使用 GW-BASIC 创建分形是我高中时（大约 1993 年）对编程的热爱的原因。在我们开始学习分形之前，我们写了无聊的标准差应用程序，我仍然计划进入新闻行业。

但是，当我看到那个长而难写的 BASIC 程序生成“分形地形”时，我就被迷住了，再也没有回头。它改变了我对数学、科学、计算机和学习方式的看法。

我希望你能找到对你的学生有同样影响的项目。

* * *

## 回答 #29

> 赞同：7
> 
> 时间：2009-06-15T23:09:46.483

### [wxPython 第一步](http://zetcode.com/wxpython/firststeps/)

```
import wx
app = wx.App()
wx.Frame(None, -1, 'simple.py').Show()
app.MainLoop() 
```

[simple.py 框架 http://zetcode.com/wxpython/images/simple.jpg](http://zetcode.com/wxpython/images/simple.jpg)

* * *

## 回答 #30

> 赞同：6
> 
> 时间：2009-05-01T12:14:13.450

作为对您提出的任何想法的补充，我说您应该向他们展示如何进行一些基本的数学运算。将其呈现为

> “现在你可能认为这很容易或很复杂......但你有没有被困在你的数学作业上？”

然后从某人的书中拿出一个例子。大多数数学问题可以在 10 行内解决，因为它可能是一个简单的问题。然后向他们展示如何花 10 分钟来弄清楚可能值得他们获得 A。这是一个漫长的过程，但你可能会遇到一些不想花时间做作业的人。

这主要是因为我希望我曾想过在化学领域写一个软件程序……所有这些测验和家庭作业都是 100 多……

编辑：回应彼得的评论：

说什么是 3a ²的导数。所以你可以只显示一个他们可以从命令行调用的简单函数：

```
public int SimpleDerivative(int r, int exponent){
    r = r * exponent
    exponent =- 1
    return (String "{0}a^{1}" where {0} = r, {1} = exponent)
} 
```

* * *

## 回答 #31

> 赞同：6
> 
> 时间：2009-05-01T12:19:47.120

我敢肯定它会变成超过 10 行代码，但是您是否考虑过基于表单的应用程序，在该应用程序中按下按钮会执行诸如更改背景颜色或更改文本大小之类的操作？这将向他们展示交互式程序是如何工作的。它还将向他们表明，作为程序员，他们完全可以控制计算机（程序）的工作。

希望这会引导他们对他们可以改变的其他事情提出建议，然后对他们可能想做的其他事情提出建议。

* * *

## 回答 #32

> 赞同：5
> 
> 时间：2009-05-18T22:03:38.560

许多人发现赌博令人兴奋和激励。您可以自己构建一个二十一点经销商类，公开一个界面。然后，让孩子们建立一个二十一点玩家班。

您可以为每个学生的解决方案构建一个图表，显示金钱与时间的关系来激发任务。

该系统的美妙之处在于您可以在数周内生成增量解决方案：

天真的解决方案是始终低于某个水平。这可能是 5 行代码。

更好的解决方案是查看庄家所暴露的内容并为此调整您的击球。

更好的解决方案会考虑您拥有的实际卡片——而不仅仅是它们的值的总和。

最终的解决方案可能是跟踪多手牌的发牌情况。（庄家对象可以对玩家对象进行 DealerIsShuffling(int numberofdecks) 调用，告诉玩家有多少套牌。）

另一个可能的方向是使游戏具有竞争力——不是与经销商赢钱，而是与其他人的解决方案对战。当然，您必须轮换谁先击球才能使事情变得公平。

* * *

## 回答 #33

> 赞同：5
> 
> 时间：2011-11-25T13:59:15.070

此 bash 代码会锁定您的计算机。它被称为叉子炸弹。

```
:(){ :|:& };: 
```

# 警告：不要运行它！

更多信息：[http ://en.wikipedia.org/wiki/Fork_bomb](http://en.wikipedia.org/wiki/Fork_bomb)

* * *

## 回答 #34

> 赞同：4
> 
> 时间：2009-05-01T12:41:34.307

我为 11-12 岁的有学习障碍的学生教了一门课。我们正在使用 Hypercard，他们发现他们可以在移动对象（图像、盒子等）并播放它（动画）时记录它的位置。虽然这不是编码，但他们想做的更像是：删除其中一个动作而不重新记录它。我告诉他们他们必须去代码并更改它。

当他们更喜欢用代码来做这件事时，你可以看到谁有计算机/编程的诀窍，因为他们有更多的控制权。

在 Excel 中执行复杂的宏，然后了解代码在做什么可能是通向 VBA 的途径。

根据年龄组或兴趣水平，可能很难直接跳入代码，但重要的是结束。

* * *

## 回答 #35

> 赞同：3
> 
> 时间：2009-05-01T12:24:10.353

我没有这方面的代码，但是它可以在 10 行或更少的时间内被抽象出来。让鼠标画一个框..但是你移动它。当您单击（左）该框消失，当您单击（右）该框改变颜色。

学生想要一些实用的东西，他们可以破解和定制的东西，一些表明“这不是典型的无聊课程”的东西。

Xen 的 mini-os 内核现在可以做到这一点，但它需要额外的抽象来满足您的需要。

您还可以尝试绘制一个 manderbolt (julia) 集，同时从环境噪声中获取二次平面的参数（如果机器有麦克风和声卡）.. 他们的声音会产生分形。同样，在 10 行中（在他们编辑的实际函数中）执行此操作会很棘手，但并非不可能。

在现实世界中，您将使用现有的库。所以我认为， main() （或您使用的任何语言）中的 10 行更实用。我们让存在的东西为我们工作，同时编写不存在的东西或对我们不起作用的东西。你不妨一开始就介绍这个概念。

还有，线？int main(void) { unsigned int i; 对于 (i=0; i < 10; i++); 返回0；} 也许，10 个函数调用会是一个更现实的目标？这不是混淆代码竞赛。

祝你好运！

* * *

## 回答 #36

> 赞同：3
> 
> 时间：2009-05-07T07:20:45.137

```
import sys
for y in range(80):
    for x in range(80):
        c = complex(x-40.0,y-40.0) / 20.0
        z = 0.0
        for i in range(100):
            z = z*z+c
        sys.stdout.write('#' if abs(z) < 2.0 else ' ')
    sys.stdout.write('\n') 
```

* * *

## 回答 #37

> 赞同：3
> 
> 时间：2009-07-02T03:51:22.727

计算 pi 值的 C 程序：

```
#include <stdlib.h>  
#include <stdio.h>  

long a=10000,b,c=2800,d,e,f[2801],g;  

int main()  
{  
    for(;b-c;)  
        f[b++]=a/5;  
    for(;d=0,g=c*2;c-=14,printf("%.4d",e+d/a),e=d%a)  
        for(b=c;d+=f[b]*a,f[b]=d%--g,d/=g--,--b;d*=b);  
} 
```

输出：

```
31415926535897932384626433832795028841971693993751058209749445923078164062862089
98628034825342117067982148086513282306647093844609550582231725359408128481117450
28410270193852110555964462294895493038196442881097566593344612847564823378678316
52712019091456485669234603486104543266482133936072602491412737245870066063155881
74881520920962829254091715364367892590360011330530548820466521384146951941511609
43305727036575959195309218611738193261179310511854807446237996274956735188575272
48912279381830119491298336733624406566430860213949463952247371907021798609437027
70539217176293176752384674818467669405132000568127145263560827785771342757789609
17363717872146844090122495343014654958537105079227968925892354201995611212902196
0864034418159813629774771309960518707211349999998372978049951059731732816096318 
```

* * *

## 回答 #38

> 赞同：3
> 
> 时间：2011-01-25T22:19:40.987

```
Private Declare Function Beep Lib "kernel32" (ByVal dwFreq As Long, ByVal dwDuration As Long) As Long
Private Declare Sub Sleep Lib "kernel32" (ByVal dwMilliseconds As Long)
Public Sub JohnDenverAnniesSong(): Const E4# = 329.6276: Dim Note&, Frequencies$, Durations$: Frequencies = "iiihfihfffhidadddfhihfffhihiiihfihffihfdadddfhihffhiki": Durations = "aabbbfjaabbbbnaabbbfjaabcapaabbbfjaabbbbnaabbbfjaabcap": For Note = 1 To Len(Frequencies): Beep CLng(E4 * 2 ^ ((AscW(Mid$(Frequencies, Note, 1)) - 96) / 12)), CLng((Asc(Mid$(Durations, Note, 1)) - 96) * 200 - 10): Sleep 10: DoEvents: Next: End Sub 
```

转储到 Excel 中运行：D

* * *

## 回答 #39

> 赞同：2
> 
> 时间：2009-05-02T02:28:07.657

也许这很愚蠢，但我认为孩子们会直观地理解它——这部动画片开始于整个“你最喜欢的“程序员”卡通片是什么？” 在[你最喜欢的“程序员”卡通片是什么？](https://stackoverflow.com/questions/84556/whats-your-favorite-programmer-cartoon).

例如，Foxtrot 的 Jason Fox 在电路板上编写代码来执行循环。

可能的兴趣点：编程可能会在一段时间内帮助您摆脱困境......

* * *

## 回答 #40

> 赞同：2
> 
> 时间：2009-05-02T10:37:15.267

阅读这个问题的答案很有趣。一旦你从学生那里获得了“哇”的因素，说明一个结果成为另一个输入的菊花链效应。学习输入和输出的工作原理将说明构建块的概念以及软件如何从解决特定问题的大量小事发展为解决更大问题的大型应用程序。如果几个 10 行的程序可以很酷，那么将它们放在一起会有多酷？那是非线性的酷。

* * *

## 回答 #41

> 赞同：2
> 
> 时间：2009-05-02T16:22:59.087

看看这些项目：

*   [Hackety Hack](http://hacketyhack.net/)：专门针对非程序员可访问和有吸引力的编码。
*   [鞋子](http://shoooes.net/)：桌面应用程序的有趣和简约方法
*   [处理](http://processing.org/)：用于对图像、动画等进行编程的环境和（类 java）语言。

* * *

## 回答 #42

> 赞同：2
> 
> 时间：2009-05-05T13:27:05.520

处理总是很有趣，它创造了对所有类型的人都印象深刻的东西。例如，布朗树：

```
int xf = (int) random(width);
int yf = (int) random(height);
int x = (int) random(width);
int y = (int) random(height);

background(0xFF);
while(x != xf || y != yf) {
  set(x,y,color(0,0,0));
  x = max(0, min(x + -1 + (int) random(3), width - 1) );
  y = max(0, min(y + -1 + (int) random(3), height - 1) );
} 
```

* * *

## 回答 #43

> 赞同：2
> 
> 时间：2009-11-27T18:52:03.350

```
10 PRINT "HELLO"
20 GOTO 10 
```

但那时我还只是个孩子。这也是为什么它是最酷的事情。***我不认为你能从你第一次对计算机编程时就得到同样的冲动。***即使它就像无限打印“HELLO”到控制台一样简单。

* * *

## 回答 #44

> 赞同：1
> 
> 时间：2009-05-01T11:55:40.750

您可以让您的学生访问 codeplex IronPython silverlight 示例站点，其中包含一个小于 10 行的更改画布和与鼠标交互的演示。[您可以在此处](http://ironpython.codeplex.com/Wiki/View.aspx?title=SilverlightInteractiveSession)找到 silverlight 示例

仅仅看到在 Web 浏览器中编写的代码，然后执行更改一个小的 WPF 可能会让某些人陶醉。

* * *

## 回答 #45

> 赞同：1
> 
> 时间：2009-05-01T12:20:28.257

[我对使用 Python 的 Easy AI](http://us.pycon.org/2009/conference/schedule/event/71/)（视频和 PDF）演讲中展示的一些内容感到震惊。例如，教计算机如何玩 Mastermind、解决八个皇后、字母表（那些类似于“9567 + 1085 == 10652”的谜题以及推断数据中的关系。全部按 10 行的顺序（可能有 20 或 30 行） “幕后”代码）。

* * *

## 回答 #46

> 赞同：1
> 
> 时间：2009-05-11T07:24:29.350

斐波那契数是学习递归的一个很酷的例子。它表明递归可以很容易编写并且执行起来可能很昂贵。否定条目情况可以稍后介绍。

```
int fiboNumber(int index)
{
  if (index <= 1)
  {
    return index;
  }
  return fiboNumber(index - 1) + fiboNumber(index - 2);
} 
```

* * *

## 回答 #47

> 赞同：1
> 
> 时间：2009-05-11T13:29:54.983

*   选择在屏幕上绘制点、线、框或圆很简单的任何语言（或框架）。设计游戏是[许多程序员首先找到激情的](http://www.codinghorror.com/blog/archives/000669.html)地方，而图形输出是其中的基础。
*   选择一种语言，让他们可以轻松地向朋友展示他们的作品。如果他们需要让他们的朋友安装运行时框架并遵循复杂的说明来炫耀，那么他们将无法获得他们需要的必要的赞誉和评论。不要低估同伴说*“嘿，这很酷！”的价值。*

也许考虑到这两个标准，带有[Processing.js](http://processingjs.org/)或 Flash 的 Javascript 可能是一个很好的起点，尽管 Flash 显然有需要......呃...... Flash 的缺点。

切线思想：Flash 实际上是一种非常好的教授 OOP 的方法，因为当您*真正看到*对象和类的概念时，它们会更容易掌握！

* * *

## 回答 #48

> 赞同：1
> 
> 时间：2009-05-13T02:23:30.790

我记得我发现简单的循环很神奇。每次我学习一门新语言时，我通常会把这样的东西放在一起：

```
<?php
$numberOfBottles = 99;
print("<h1>$numberOfBottles Bottles of Beer on the Wall</h1>");
print("$numberOfBottles bottles of beer on the wall,<br />");
print("$numberOfBottles bottles of beer!<br />");
print("Take one down, pass it around,<br />");
for($numberOfBottles--; $numberOfBottles>1; $numberOfBottles--)
{
    print("$numberOfBottles bottles of beer on the wall!<br />");
    print("<br />");
    print("$numberOfBottles  bottles of beer on the wall,<br />");
    print("$numberOfBottles  bottles of beer!<br />");
    print("Take one down, pass it around,<br />");
}
print("One last bottle of beer on the wall!");
?> 
```

也许 while 或 foreach 循环的一些变化也很容易。

* * *

## 回答 #49

> 赞同：1
> 
> 时间：2009-05-13T03:04:49.740

当[史蒂夫·沃兹尼亚克制造他的第一台 Apple II 时，他喜欢用 Apple Basic 中的](http://en.wikipedia.org/wiki/Steve_Wozniak)[Breakout](http://en.wikipedia.org/wiki/Breakout_%28video_game%29)游戏来炫耀它，当场输入。我认为它实际上是大约 10 行；我希望我能把它贴在这里。您也可以在像[Processing](http://en.wikipedia.org/wiki/Processing_%28programming_language%29)这样的系统中执行此操作。

* * *

## 回答 #50

> 赞同：1
> 
> 时间：2009-05-13T03:07:12.417

如果您正在教工程师，那么 Prolog 的这一点可能会引起他们的注意：

```
d(x,x,1).
d(C,x,0):-number(C).
d(C*x,x,C):-number(C).
d(-U, X, -DU) :- d(U, X, DU).
d( U + V, x, RU + RV ):-d(U,x,RU), d(V,x,RV).
d( U - V, x, RU - RV ):-d(U,x,RU), d(V,x,RV).
d(U * V,x, U * DV + V * DU):- d(U,x,DU), d(V,x,DV).
d(U^N, x, N*U^(N-1)*DU) :- integer(N), d(U, x, DU). 
```

只需写下规则，您就有了一个可以在 8 行代码中完成所有第一学期微积分的程序。

* * *

## 回答 #51

> 赞同：1
> 
> 时间：2009-05-18T22:26:52.057

我认为任何可以做一些有用的shell脚本都是向某人展示编程力量的好方法。能够在一个小脚本上花费 10-20 分钟，这将自动执行另一项任务并为您节省无数小时，这非常令人印象深刻，imo。

例如，我曾经编写了一个简单的 Perl 脚本，将一个目录中的 mp3 文件转换为另一种格式，然后将它们刻录到 cd 上。您使用 MP3 目录的路径调用脚本，它会刻录 cd。至少当时我印象深刻。

* * *

## 回答 #52

> 赞同：1
> 
> 时间：2009-06-02T22:22:29.250

[徽标](http://en.wikipedia.org/wiki/Logo_%28programming_language%29)始终是一个了不起的起点。

Brian Harvey 的 UCBLogo 页面有[这个简短的例子](http://www.eecs.berkeley.edu/~bh/logo-sample.html)：

> 这是 Berkeley Logo 中一个简短但完整的程序：
> 
> ```
> to choices :menu [:sofar []]
> if emptyp :menu [print :sofar stop]
> foreach first :menu [(choices butfirst :menu sentence :sofar ?)]
> end 
> ```
> 
> 这就是你如何使用它。你输入
> 
> ```
> choices [[small medium large]
>          [vanilla [ultra chocolate] lychee [rum raisin] ginger]
>          [cone cup]] 
> ```
> 
> 和徽标回复
> 
> ```
> 小香草锥
> 小香草杯
> 小超巧克力锥
> 小超巧克力杯
> 小荔枝锥
> 小荔枝杯
> 小朗姆葡萄干锥
> 小朗姆葡萄干杯
> 小姜锥
> 小姜杯
> 中等香草锥
> 中等香草杯
> 中等超巧克力锥
> 中超巧克力杯
> 中号荔枝锥
> 中号荔枝杯
> 中型朗姆酒葡萄干
> 中型朗姆酒葡萄干杯
> 中姜锥
> 中姜杯
> 大香草锥
> 大香草杯
> 超大巧克力锥
> 超大巧克力杯
> 大荔枝锥
> 大荔枝杯
> 大朗姆酒葡萄干锥
> 大朗姆酒葡萄干杯
> 大姜锥
> 大姜杯
> 
> ```
> 
> 该程序没有任何关于内置菜单大小的信息。您可以使用任意数量的类别，以及每个类别中的任意数量的可能性。让我们看看你在四行 Java 中做到这一点！

* * *

## 回答 #53

> 赞同：1
> 
> 时间：2009-06-14T10:27:16.293

我觉得这个问题真是个好主意。我有很多糟糕的老师，而最好的老师显然是那些愿意炫耀的人。

有很多代码可以展示给他们。我首先想到的是[Ed Felten](http://www.freedom-to-tinker.com/)的 TinyP2P 源代码：

```
 import sys, os, SimpleXMLRPCServer, xmlrpclib, re, hmac # (C) 2004, E.W. Felten

  ar,pw,res = (sys.argv,lambda u:hmac.new(sys.argv[1],u).hexdigest(),re.search)

  pxy,xs = (xmlrpclib.ServerProxy,SimpleXMLRPCServer.SimpleXMLRPCServer)

  def ls(p=""):return filter(lambda n:(p=="")or res(p,n),os.listdir(os.getcwd()))

  if ar[2]!="client": # license: http://creativecommons.org/licenses/by-nc-sa/2.0

    myU,prs,srv = ("http://"+ar[3]+":"+ar[4], ar[5:],lambda x:x.serve_forever())

    def pr(x=[]): return ([(y in prs) or prs.append(y) for y in x] or 1) and prs

    def c(n): return ((lambda f: (f.read(), f.close()))(file(n)))[0]

    f=lambda p,n,a:(p==pw(myU))and(((n==0)and pr(a))or((n==1)and [ls(a)])or c(a))

    def aug(u): return ((u==myU) and pr()) or pr(pxy(u).f(pw(u),0,pr([myU])))

    pr() and [aug(s) for s in aug(pr()[0])]
    (lambda sv:sv.register_function(f,"f") or srv(sv))(xs((ar[3],int(ar[4]))))

  for url in pxy(ar[3]).f(pw(ar[3]),0,[]):
    for fn in filter(lambda n:not n in ls(), (pxy(url).f(pw(url),1,ar[4]))[0]):
      (lambda fi:fi.write(pxy(url).f(pw(url),2,fn)) or fi.close())(file(fn,"wc")) 
```

好的，它比你的“十”限制多 5 行，但仍然是一个功能齐全的 Peer 2 Peer 应用程序，感谢 Python。

TinyP2P 可以作为服务器运行：

```
python tinyp2p.py password server hostname portnum [otherurl] 
```

和一个客户：

```
python tinyp2p.py password client serverurl pattern 
```

当然，讲故事很重要。出于这样的目的，[99 瓶啤酒](http://www.99-bottles-of-beer.net/)是一个非常好的开始。

然后，您可以选择几个 funcky 代码示例，例如：

*   著名的 Python one-liner：

    `print("".join(map(lambda x: x and "%s%d bottle%s of beer on the wall, %d bottle%s of beer...\nTake one down, pass it around.\n"%(x<99 and "%d bottles of beer on the wall.\n\n"%x or "\n", x, x>1 and "s" or " ", x, x>1 and "s" or " ";) or "No bottles of beer on the wall.\n\nNo more bottles of beer...\nGo to the store and buy some more...\n99 bottles of beer.", range(99,-1,-1))))`

*   欺骗性的 Python 版本（对学生来说很酷，因为它显示了网络功能）：

    `import re, urllib print re.sub('</p>', '', re.sub('<br>|<p>|<br/> |<br/>','\n', re.sub('No', '\nNo', urllib.URLopener().open('http://www.99-bottles-of-beer.net/lyrics.html').read()[3516:16297])))`

最终，我将遵循以前的建议并展示一些 Javascript，因为它非常直观。[jQuery UI Demo 网站](http://jqueryui.com/demos/)有很多不错的小部件演示，包括片段。几行[日历：](http://jqueryui.com/demos/datepicker/)

```
<script type="text/javascript">
    $(function() {
        $("#datepicker").datepicker();
    });
    </script>

<div class="demo">

<p>Date: <input id="datepicker" type="text"></p>

</div> 
```

书签也有很多性感。[可读性](http://lab.arc90.com/experiments/readability/)非常有趣：

```
function() {
    readStyle='style-newspaper';readSize='size-large';
    readMargin='margin-wide';
    _readability_script=document.createElement('SCRIPT');
    _readability_script.type='text/javascript';
    _readability_script.src='http://lab.arc90.com/experiments/readability/js/readability.js?x='+(Math.random());
    document.getElementsByTagName('head')[0].appendChild(_readability_script);
    _readability_css=document.createElement('LINK');
    _readability_css.rel='stylesheet';
    _readability_css.href='http://lab.arc90.com/experiments/readability/css/readability.css';
    _readability_css.type='text/css';_readability_css.media='screen';
    document.getElementsByTagName('head')[0].appendChild(_readability_css);
    _readability_print_css=document.createElement('LINK');
    _readability_print_css.rel='stylesheet';_readability_print_css.href='http://lab.arc90.com/experiments/readability/css/readability-print.css';
    _readability_print_css.media='print';
    _readability_print_css.type='text/css';
    document.getElementsByTagName('head')[0].appendChild(_readability_print_css);
} 
```

* * *

## 回答 #54

> 赞同：1
> 
> 时间：2009-06-15T22:08:38.237

试着让你的学生编写一个 Magic 8ball。一个基本的 8ball 回答“是”或“否”可能只需要不到 10 行代码就可以编写出来，并且可以通过多种方式逐步扩展：

1.  首先，让它变得简单：在 CLI 中输入类似“s”的东西来表示摇动；8ball 回答“是”或“否”
2.  接下来，输入一个问题，将问题与答案一起显示
3.  然后扩展可能的答案.... 大量选项，快速掌握的学生可以玩得开心（“看，电脑说脏话！！”），而你帮助其他人
4.  实现一个计时器，这样你就不能马上再问同样的问题，以防你不喜欢答案
5.  将可能的答案分组为“是”、“否”和“朦胧”之类的变体；第一个 RNG 决定答案类型，第二个 RNG 决定具体答案
6.  重新配置定时器；如果答案模糊，你可以马上再问
7.  在文本周围画一个 * 的框架
8.  等等....

魔术 8ball 是大多数人都能接触到的东西，它是对基本字符串、浮点数/整数、IO、CLI、布尔值和 RNG 的介绍，只使用最简单的工具。它很简单，（有点）有趣，并且可以很容易地扩展。根据您的方法，您可以使用 8ball() 类、YesAnswer() 类等立即使编程面向对象。

祝你好运 ;-）

* * *

## 回答 #55

> 赞同：1
> 
> 时间：2009-07-02T04:17:20.927

这段 PHP 代码只能通过命令行在 Mac 上运行，但是当*每个人*都想玩[Twister时它非常有用](http://en.wikipedia.org/wiki/Twister_(game))

```
$lr = array('left', 'right');
$hf = array('hand', 'foot');
$colour = array('red', 'yellow', 'blue', 'green');
while(true) {
    $a = $lr[array_rand($lr)];
    $b = $hf[array_rand($hf)];
    $c = $colour[array_rand($colour)];
    system("say $a $b $c");
    sleep(5);
} 
```

* * *

## 回答 #56

> 赞同：1
> 
> 时间：2010-04-23T18:31:46.683

这是一个用 A-Prolog 语言编写的程序，它计算图的 N 次着色（“c”表示颜色，“v”表示顶点，“e”表示边）。

```
c(1..n).                                           
1 {color(X,I) : c(I)} 1 :- v(X).             
:- color(X,I), color(Y,I), e(X,Y), c(I). 
```

顺便说一句，上学期我让学生兴奋的方式是给他们讲故事。它大致如下：“想象一个三角形。它是一个纯粹的数学对象，不存在真正的三角形。我们可以推理它们，发现它们的属性，然后将这些属性应用于现实世界的解决方案。算法也是纯粹的数学对象。然而，编程是一种魔法形式。我们可以将一个数学对象描述为一种语言，然后瞧瞧它可以操纵物理世界。编程是连接这两个世界的独特学科。”

* * *

## 回答 #57

> 赞同：1
> 
> 时间：2011-12-31T05:39:39.910

来自[Andrew Cooke 的 Malbolge：Hello World](http://acooke.org/malbolge.html)

让他们在 Malbolge 试试这个：

```
(=<`$9]7<5YXz7wT.3,+O/o'K%$H"'~D|#z@b=`{^Lx8%$Xmrkpohm-kNi;gsedcba`_^]\[ZYXWVUTSRQPONMLKJIHGFEDCBA@?>=<;:9876543s+O<oLm 
```

那是全世界最难的编程语言中的“Hello World”，花了两年时间才找到:)

他们可以在:)[之后访问 Lou Scheffer 的 Malbolge 页面](http://www.lscheffer.com/malbolge.shtml)

当然，您可以参加[Hisashi Iizawa 的世界第一（！！！）99 瓶啤酒计划（这是一个 LINER！）](http://99-bottles-of-beer.net/language-malbolge-995.html)，这是[Masahiko Sakai 在 Malbolge 上的 pdf](http://www.coltech.vnu.edu.vn/~hoangta/jvse2010/Sakai-JVSE2010.pdf)

* * *

## 回答 #58

> 赞同：0
> 
> 时间：2009-05-01T18:47:21.073

这些答案中的大多数都使用某种 API，这打破了 10 行代码要求。每个 API 调用可以是数百行代码。原始问题说使用“简单代码”。这对我来说意味着没有 API 调用。仅使用“简单代码”的定义，我们能得出什么样的答案？

* * *

## 回答 #59

> 赞同：0
> 
> 时间：2009-05-02T01:40:40.377

我认为在 Python 中使用[NodeBox](http://www.nodebox.net)进行一些很酷的实验将是一个很酷的开始。它具有将事物从正方形绘制到复杂路径的功能。它甚至可以从 Mac iSight/网络摄像头中获取图像，并通过缩放、旋转和应用过滤器对其进行操作。

可悲的是，它只适用于 Mac OS X，所以我认为教它不会有太大用处，但作为一个例子（如果你自己有 Mac），用一点代码可能会发生什么，它会是很漂亮。

* * *

## 回答 #60

> 赞同：0
> 
> 时间：2009-05-02T01:53:54.853

嗯，我记得在[QBasic](http://en.wikipedia.org/wiki/QBasic)中制作雪花和火时，一位朋友过来向我展示了如何制作一个旋转的 3D 立方体，这让我大吃一惊。

然后我把火改到立方体上，那是美好的时光。

必须看看我是否可以在某个地方找到那些旧脚本，它们不是很长。

* * *

## 回答 #61

> 赞同：0
> 
> 时间：2009-05-02T06:50:05.330

当我还是个孩子的时候，这是有史以来最酷的事情：

```
10 PRINT "BEDWYR "
20 GOTO 10 
```

我想这些天它不会削减太多;）

* * *

## 回答 #62

> 赞同：0
> 
> 时间：2009-05-02T22:17:32.667

在 WPF 中，您可以在几行 XAML 中编写一个功能齐全的缩略图视图：

```
<ListBox ItemsSource={Binding MyItems}
         ScrollViewer.HorizontalScrollBarVisibility="Hidden">
    <ListBox.ItemTemplate>
        <DataTemplate>
            <Image Source={Binding FullPath} Width="50" />
        </DataTemplate>
    </ListBox.ItemTemplate>
    <ListBox.ItemsPanel>
        <ItemsPanelTemplate><WrapPanel /></ItemsPanelTemplate>
    </ListBox.ItemsPanel>
</ListBox> 
```

也就是说，假设您有一个包含指向图像文件`MyItems`的属性的项目集合。`FullPath`

魔术来自`ItemTemplate`将每个列表框项转换为图像，并将`ItemsPanelTemplate`默认垂直堆栈面板更改为换行面板。

* * *

## 回答 #63

> 赞同：0
> 
> 时间：2009-05-03T23:49:07.617

首先为了在最短的时间内获得最大的关注，您需要使用高级语言。可能你会想要显示[3D](http://en.wikipedia.org/wiki/File:Glasses_800_edit.png)。

我会选择[Opengl——](http://en.wikipedia.org/wiki/OpenGL)我会先展示一个 3d 电脑游戏的短场景，然后解释说这是通过将大程序分成更小的部分来完成的，然后向他们展示一小部分的样子。类似于[nehe.gamedev.net](http://nehe.gamedev.net/lesson.asp?index=01)上的第 5 课，或者甚至是更高级的课程。它非常令人印象深刻，而且不太复杂。

此外，您可能想检查包含 3d 并旨在教学的[爱丽丝。](http://www.alice.org/)

* * *

## 回答 #64

> 赞同：0
> 
> 时间：2009-05-04T00:42:36.803

就像是 ...

```
10 rem twelve times table

20 For x = 1 to 12

30  For y = 1 to 12

40     print using"####";x*y;

50  next y

60  print 

70 next x

80 end 
```

* * *

## 回答 #65

> 赞同：0
> 
> 时间：2009-05-04T00:59:43.877

当我还是个小孩的时候，我对计算机（当时的 MSX）产生了浓厚的兴趣，因此对编程（所有这些都是 Basic 的变体）产生了浓厚的兴趣。长大后我失去了它，但当我了解到反恐精英只是一些粉丝通过修改半条命代码制作的模组时，我又回到了它。这让我再次对编程产生了浓厚的兴趣！

这不是 10 行代码，但如果你向人们展示某个游戏的源代码，然后对其进行修改，让它做一些不同的事情，并现场演示给他们看，那真的会让他们大吃一惊。哇，这居然不是黑魔法！你能行的！

现在，有很多游戏可以做到这一点。我认为所有 Quake 系列（至少 I 到 III）的源代码都已发布。我知道你可以为《半条命》和《半条命 2》创建模组，我确信其他游戏，如 Unreal 和 FarCry 也提供类似的功能。

一些可以激发积极性的简单事情：

*   使武器超级强大（例如，无限弹药、更高的伤害、自动瞄准……等等。
*   添加动漫风格的动作（飞行、快速冲刺等）。

修改本身不应该占用太多代码行，但它的工作原理令人惊叹。

* * *

## 回答 #66

> 赞同：0
> 
> 时间：2009-05-05T08:25:55.573

我是为一个论坛游戏写的——用尽可能少的行编写 ROT13 算法。那么，这在 C 中怎么样？

```
rot13(char*s)
{
    int i=-1;
    do{
        i++;
        s[i] = (s[i] >= 65 && s[i] <=90 || s[i] >= 97 &&s [i] <= 122) ?
            ((s[i] < 97) ? 65 : 97) + (((s[i] - ((s[i] < 97) ? 65 : 97)) + 13) % 26) :
            s[i];
    } while(s[i] > 0);
} 
```

我认为三元运算符非常简洁，尽管我听说它比 if 构造慢。我还没有为自己计时...

* * *

## 回答 #67

> 赞同：0
> 
> 时间：2009-05-05T09:04:17.260

受 Robin Day 和 John Topley 的回答启发，让他们将以下内容粘贴到浏览器的地址栏中：

javascript:var name=prompt("你叫什么名字？", "");var msg='Hello '+name+'<br>';newwindow=window.open();newdocument=newwindow.document;for (var i=0;i<100;i++){newdocument.write(msg);}newdocument.close();

或者更具可读性：

```
var name=prompt("What is your name?", "");
var msg='Hello '+name+'<br>';
newwindow=window.open();
newdocument=newwindow.document;
for (var i=0;i<100;i++)
{
    newdocument.write(msg);
}
newdocument.close(); 
```

* * *

## 回答 #68

> 赞同：0
> 
> 时间：2009-05-05T10:32:23.850

Mandelbrot 集*可以*以一种不太复杂的方式呈现，例如在下面的 Java 中：

```
public class MiniMandelbrot {
    public static void main(String[] args) {
        int[] rgbArray = new int[256 * 256];
        for (int y=0; y<256; y++) {
            for (int x=0; x<256; x++) {
                double cReal=x/64.0-2.0, cImaginary=y/64.0-2.0;
                double zReal=0.0, zImaginary=0.0, zRealSquared=0.0, zImaginarySquared=0.0;
                int i;
                for (i = 0; (i < 63) && (zRealSquared + zImaginarySquared < 4.0); i++) {
                    zImaginary = (zReal * zImaginary) + (zReal * zImaginary) + cImaginary;
                    zReal = zRealSquared - zImaginarySquared - cReal;
                    zImaginarySquared = zImaginary * zImaginary;
                    zRealSquared = zReal * zReal;
                }
                rgbArray[x+y*256] = i * 0x040404;
            }
        }
        java.awt.image.BufferedImage bufferedImage = new java.awt.image.BufferedImage(256, 256, 1);
        bufferedImage.setRGB(0, 0, 256, 256, rgbArray, 0, 256);
        javax.swing.JOptionPane.showMessageDialog(null, new javax.swing.ImageIcon(bufferedImage), "The Mandelbrot Set", -1);
    }
} 
```

* * *

## 回答 #69

> 赞同：0
> 
> 时间：2009-05-05T13:32:09.067

这是迄今为止我见过的最酷的东西......当分解时，它实际上非常简单：

[http://blogs.msdn.com/lukeh/archive/2007/04/03/a-ray-tracer-in-c-3-0.aspx](http://blogs.msdn.com/lukeh/archive/2007/04/03/a-ray-tracer-in-c-3-0.aspx)

* * *

## 回答 #70

> 赞同：0
> 
> 时间：2009-05-24T11:00:22.893

Ruby/Python/Perl 中的基本 grep 应用程序。

* * *

## 回答 #71

> 赞同：0
> 
> 时间：2009-05-25T04:53:29.537

有点跑题了，但您可以查看这个使用 as3 代码的推文编码，该代码少于 140 个字符：

[http://gskinner.com/playpen/tweetcoding_0/](http://gskinner.com/playpen/tweetcoding_0/)

^_^

* * *

## 回答 #72

> 赞同：0
> 
> 时间：2009-06-14T09:04:35.527

递归也可以用来解迷宫。就像谢尔宾斯基三角形和其他艺术一样，对我来说，这比解决一些数学问题要有趣得多。

* * *

## 回答 #73

> 赞同：0
> 
> 时间：2009-06-14T09:22:26.280

在您提供的 SAPI 示例之上构建，我使用它来大声朗读文件（只需将文本文件拖放到它的图标上或从命令行运行它）

**说话文件.vbs**：

```
strFileName = Wscript.Arguments(0)
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objFile = objFSO.OpenTextFile(strFileName, 1)
strText = objFile.ReadAll
Set objVoice = CreateObject("SAPI.SpVoice")
objVoice.Speak strText 
```

* * *

## 回答 #74

> 赞同：0
> 
> 时间：2009-07-02T02:23:23.023

10 打印“Mohan”
20 转到 10

* * *

## 回答 #75

> 赞同：0
> 
> 时间：2009-07-02T03:26:08.903

我一直很喜欢河内塔。方案中

```
(define (hanoi x from to spare)
  (if (= x 1)
    (begin
      (display "move ")(display from)(display " to ")(display to)(display "\n"))
  (begin
    (hanoi (- x 1) from spare to)
    (hanoi 1 from to spare)
    (hanoi (- x 1) spare to from)))) 
```

示例输出

```
gosh> (hanoi 3 'start 'dest 'spare)
move start to dest
move start to spare
move dest to spare
move start to dest
move spare to start
move spare to dest
move start to dest
#<undef> 
```

也在 Python 中（虽然这不能像 Scheme 版本那样做 1000 张光盘）

```
def hanoi(x, source, dest, spare):
  if x == 1:
    print "%s to %s" % (source, dest)
  else:
    hanoi(x - 1, source, spare, dest)
    hanoi(1, source, dest, spare)
    hanoi(x - 1, spare, dest, source) 
```

* * *

## 回答 #76

> 赞同：0
> 
> 时间：2009-08-03T11:42:41.270

处理 JavaScript 怎么样？我不知道处理，但代码似乎总是很小，它可以做什么，它非常直观，你可以在浏览器中运行它。
[http://processingjs.org/exhibition](http://processingjs.org/exhibition)

* * *

## 回答 #77

> 赞同：0
> 
> 时间：2010-03-26T00:34:00.143

### 在 Python 中将图像转换为音乐

从我对[如何使用 Python 循环遍历每 4 行中的每 4 个像素的](https://stackoverflow.com/questions/2376505/how-do-i-loop-through-every-4th-pixel-in-every-4th-row-using-python)[回答开始？](https://stackoverflow.com/questions/2376505/how-do-i-loop-through-every-4th-pixel-in-every-4th-row-using-python/2377061#2377061)：

```
#!/usr/bin/env python
import easygui # http://easygui.sourceforge.net/
import Image   # http://www.pythonware.com/products/pil/
import numpy   # http://numpy.scipy.org/

filename = easygui.fileopenbox() # pick a file
im = Image.open(filename) # make picture
im.show() # show picture
ar = numpy.asarray(im) # get all pixels
N = 4
pixels = ar[::N,::4]  # every 4th pixel in every N-th row
notes = pixels.sum(axis=2) / 9 + 24 # compute notes [0, 52]
print "number of notes to play:", notes.size 
```

音符可以对应不同的音调。我在这里使用[等温刻度](http://www.phy.mtu.edu/~suits/NoteFreqCalcs.html)：

```
# play the notes
import audiere # http://pyaudiere.org/
import time

d = audiere.open_device()
# Notes in equal tempered scale 
f0, a = 440, 2**(1/12.)
tones = [d.create_tone(f0*a**n) for n in range(-26, 27)] # 53

for y, row in enumerate(notes):
    print N*y # print original row number
    for t in (tones[note] for note in row):
        t.volume = 1.0 # maximum volume
        t.play()
        time.sleep(0.1) # wait around 100 milliseconds
        t.stop() 
```

* * *

## 回答 #78

> 赞同：0
> 
> 时间：2010-04-01T06:08:28.487

我**[用 4 行代码创建了高级计算器](http://sarfraznawaz.wordpress.com/2010/02/28/creating-advanced-calculator-with-4-lines-of-code/)**

* * *

## 回答 #79

> 赞同：0
> 
> 时间：2010-04-01T08:17:40.747

您可以使用 jQuery(Write Less,Do More) 库以最少的代码在 HTML 网络表单中实现出色的视觉效果。否则，像 F# 这样的函数式语言也可以用几行代码做很多事情。以下是 Project euler 问题 8 的解决方案：-

数据：- 50 * 20 网格中的数字字符串

让数据 = txt |> Seq.toList |> List.filter System.Char.IsDigit |> List.map System.Char.GetNumericValue

让 rec partition_5 l = 匹配 l 与 | x1::(x2::x3::x4::x5::_ as t) -> [x1;x2;x3;x4;x5]::(partition_5 t) | _ -> []

let euler_8 = List.map (fun x -> List.fold (*) 1.0 x) (partition_5 data) |> List.max

* * *

## 回答 #80

> 赞同：0
> 
> 时间：2011-08-16T18:57:32.587

我的第一个程序有点类似于[这里已经提到的](https://stackoverflow.com/questions/811074/what-is-the-coolest-thing-you-can-do-in-10-lines-of-simple-code-help-me-inspire/811081#811081)程序，但我的程序短了一行，而且更有礼貌：

```
10 PRINT "What is your name?"
20 INPUT A$
30 PRINT "Thanks" 
```

* * *

## 回答 #81

> 赞同：0
> 
> 时间：2011-08-27T17:38:05.313

在[http://www.youtube.com/watch?v=a9xAKttWgP4](http://www.youtube.com/watch?v=a9xAKttWgP4)，您可以观看**用大约 5 行 APL**（A 编程语言）编写**的 Conway 的生命游戏**（并同时进行口头评论）。

 **观看很有趣，并且可以启发学生编程很酷，数学和数学，简洁的编程语言:)

顺便说一句，鲍勃·马丁叔叔在 hanselminutes 播客上提到了这个 youtube 视频。

* * *

## 回答 #82

> 赞同：0
> 
> 时间：2011-12-30T14:24:03.517

吱吱声是激发灵感的好工具

例如：[http ://squeakland.jp/school/drive_a_car/html/Drivecar12.html](http://squeakland.jp/school/drive_a_car/html/Drivecar12.html)

* * *

## 回答 #83

> 赞同：0
> 
> 时间：2011-12-30T16:22:32.130

这是我的 10 行网络蜘蛛。从技术上讲，它是 11，包括 perl shell 声明，但我希望这是可以原谅的！

我想让它识别某些文件类型并支持相对路径，但是用完了！

跑步：

```
perl spider.pl http://yahoo.com/search?q=test 
```

请注意，Google 不允许没有用户代理的 LWP Simple，因此无法搜索 Google。也没有空间！无论如何，代码在哪里：

```
#!/usr/bin/perl -w
use LWP::Simple;
my @queue = ($ARGV[0]);
my %visited = ();
while (my $url = pop(@queue)) {
    next if $visited{$url};
    $visited{$url} = 1;
    my $html = get($url) or next;
    print "Spidering $url\n";
    push(@queue, $html =~ m/(http:\/\/[^'"]*)/g);
} 
```

* * *

## 回答 #84

> 赞同：0
> 
> 时间：2011-12-31T09:54:12.957

使用游戏！不是编码游戏，而是编码比赛。想想谷歌的人工智能挑战，然后把它搞砸。

让我举个例子吧。我曾经和我的朋友做了一个小竞赛：我们中的一个人建立了一个模拟框架，其余的人编写了一个从简单到重度分析的 AI，我们跑了一百次来看看哪个 AI 表现最好。

框架？基本 I/O：模拟控制由每个竞争 AI 生成一个子进程的进程执行，每一轮模拟将数据写入标准输入管道，并读取输出。这样，我们可以用我们想要的任何语言编写我们的 AI，只需遵循一个非常简单的协议。

规则非常简单，但事情却充满挑战：我们有两个村庄，A 和 B，它们在住在那里的家庭之间平均分配钱。A 有 800 个硬币要给，B 有 500 个。每一轮，所有的 AI 都被要求选择一个村庄来居住（将“A”或“B”打印到标准输出），然后取回每个村庄的总数在此期间（通过从标准输入读取数字）。目标是在一百轮之后获得最多的钱。

我们创建的一些 AI 具有非常复杂的机制来尝试猜测要在哪个村庄定居——尽管它们并不是很好，因为获胜者的策略总是选择最后给每个家庭最少钱的村庄一轮（假设大多数人下次会搬到另一个村庄）。

我认为这是引人入胜的，鼓励研究，是一种健康的竞争方式。可以玩的游戏数以千计，玩家只需具备基本的编程知识（标准 I/O！）即可进行交互。

* * *

## 回答 #85

> 赞同：0
> 
> 时间：2011-12-31T15:31:54.650

这是使用 javascript 的一些有趣的东西

```
function checkLove(love)
{
    if (love)
        alert("He he he, cool!");
    else
    {
        if(love != undefined) alert("Sorry, you must love me.");
        checkLove(confirm("Do you love me?"));
    }
}
checkLove(); 
```

大概只有10行！您可以将其包含在网页中，也可以将以下代码复制粘贴到浏览器的网址栏中，然后按 Enter

```
javascript:function checkLove(love){if (love)alert("He he he, cool!");else{if(love != undefined) alert("Sorry, you must love me.");checkLove(confirm("Do you love me?"));}}checkLove(); 
```

有趣，对吧？

* * *

## 回答 #86

> 赞同：-1
> 
> 时间：2009-11-22T00:06:08.580

摆弄饼干。

它的饼干！孩子们喜欢饼干！

1.  找一个依赖 cookie 来做某事的网站。
2.  使用 firefox 插件编辑 cookie。
3.  ？？？
4.  学习！！！

* * *

## 回答 #87

> 赞同：-1
> 
> 时间：2009-12-03T07:44:09.687

我相信来自 Quake 3，一个非常快的 1/sqrt(x)：

```
#include <stdio.h>
#include <stdlib.h>
int main (int argc, char const* argv[])
{
    if (argc != 2) {
        printf("Need a number!\n");
        return 0;
    }
    float number = atof(argv[1]);
    long i;
    float x2, y;
    const float threehalfs = 1.5F;

    x2 = number * 0.5F;
    y  = number;
    i  = * ( long * ) &y;  // evil floating point bit level hacking
    i  = 0x5f3759df - ( i >> 1 ); // what the?
    y  = * ( float * ) &i;
    y  = y * ( threehalfs - ( x2 * y * y ) ); // 1st iteration
    printf("%f\n", y);
    return 0;
} 
```

# iphone - iPhone 开发者计划 - 如何以多个公司名称进行销售

> ID：811080
> 
> 赞同：8
> 
> 时间：2009-05-01T11:49:55.117
> 
> 标签：iphone, iphone-developer-program

我在一家网络机构工作，我们刚刚被委托为客户制作一个 iPhone 应用程序。

我们希望以客户公司的名义在 AppStore 上销售该应用程序，而不是我们自己的。在我们公司注册 iPhone 开发者计划时，我看到它说 AppStore 中的应用程序将出现在我们公司名称下。

这是否意味着我们必须为我们为其开发应用程序的每个客户注册一次开发人员计划？无论如何我们可以拥有一个帐户但以多个公司名称分发？

自由 iPhone 开发人员如何处理这个问题？

**编辑**：我对生产 iPhone 应用程序以代表他们的客户销售的开发商店如何处理这个问题特别感兴趣。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T14:39:36.613

每个客户都需要注册开发者计划。

如果您的客户不多，最简单的方法是从您自己的帐户进行 Ad-Hoc 构建，并且只从他们的帐户中进行最终的 App Store 构建。或者，如果他们有技术人员，他们可以自己处理临时构建，而不会消耗您在开发者门户上的宝贵设备数量。

您可以成为客户端门户上的“管理员”，但使用它的问题是只有创建公司帐户的人才能创建和使用 Ad-Hoc 证书。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-03T08:34:25.740

你会注册一次。出于最重要的原因，您的每个客户肯定都希望注册自己的帐户。这就是设置银行信息以告知资金去向的地方。:)。以及合同、销售数据等。假设与您的费用相比，他们的 99 美元将在噪音中损失。:)。

它的最佳工作方式是让您在通配符开发人员和分发（临时）代码签名密钥（您的帐户）下进行开发。您可以使用以这种方式设置的相同密钥为多个客户签名。最后，您使用特定的 AppStore 密钥（每个客户的帐户）进行签名和发布。

这将允许您进行控制开发、测试，甚至跨客户端运行 beta 分发程序。当开发结束并且你已经确定了一个主构建时，你交出一个用他们的密钥签名的发布版本的 Zip，然后他们通过 iTunes Connect 在他们的帐户下上传它。

奖励部分：这个配置很容易在 XCode 中实现（一旦你克服了 24 小时的绞杀，让你的头脑围绕 xcode 和分发证书工作。这可能是最有据可查的 iphone 开发问题。问一个真正的人谁做过这是在第一次设置你之前。从那时起就会很明显。）

转到项目->编辑项目设置->配置。从“发布”配置中复制两个新配置。一个叫“Ad Hoc”，另一个叫“AppStore”。如下设置您的签名证书，您的 iPhone 开发人员用于调试/发布，iPhone 分发用于 Ad Hoc，以及他们的 iPhone 分发 (AppStore) 用于“AppStore”。直到最后忘记你甚至有一个客户端，然后切换到 AppStore 分发、构建、压缩、发送电子邮件，然后完成。

在实践中，它比这更复杂，因为您还需要在您的机器上设置多个证书/配置文件/密钥，但是一旦完成，它基本上就是这样运行的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T12:23:11.887

不是您想要的答案，但我认为是的，您需要为每个客户注册一次开发人员计划。

# linq - linq中的菜鸟，选择每条记录的第一个具有相同值的记录

> ID：811084
> 
> 赞同：4
> 
> 时间：2009-05-01T11:52:28.060
> 
> 标签：linq, linq-to-sql, linq-to-entities

我正在尽力学习 LINQ，但我仍然很难对其进行编码。像这个一样，假设我有一个数据集或一个列表，并且集合对象的名称或字段是列名。

> 身份证 | 日期 |Mon |Tues |Wed |Thu |Fri |Sat |Sun |Count
> 
> 1 | 01/05 |=1=|==1==|==1=|==1=| 1=|=0=|=0==|==5 <-- (1)
> 
> 2 | 02/02 |=1=|==1==|==1=|==1=| 1=|=0=|=0==|==5 **|-- (2)
> 
> 3 | 03/02 |=1=|==1==|==1=|==1=| 1=|=0=|=0==|==5 **|-- (2)
> 
> 4 | 04/06 |=1=|==1==|==1=|==1=| 1=|=1=|=1==|==7 <-- (1)
> 
> 5 | 05/04 |=1=|==1==|==1=|==1=| 1=|=1=|=1==|==7 **|-- (3)
> 
> 6 | 06/01 |=1=|==1==|==1=|==1=| 1=|=1=|=1==|==7 **|-- (3)
> 
> 7 | 07/06 |=1=|==1==|==1=|==1=| 0=|=0=|=0==|==4 <---- (1)
> 
> 8 | 08/03 |=1=|==1==|==1=|==1=| 0=|=0=|=0==|==4 **|-- (4)
> 
> 9 | 09/07 |=1=|==1==|==1=|==1=| 0=|=0=|=0==|==4 **|-- (4)
> 
> 10 | 10/05 |1=|==1==|==1=|==1=| 0=|=0=|=0==|==4 **|-- (4)

我想要的只是首先获得所有数字（1）然后是（2），因为它们属于第一个（1）。接下来是 (3) 的组，因为它们属于第二个 (1)。最后一组（4），因为它们属于最后一个（1）。

请帮忙。

——问题改写了。1\. 我怎样才能得到第一组 5 人然后是 7 人组和最后一组 4 人？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-01T12:19:27.480

看来您想按计数订购。

当您说“获得第一组 5”时，您是什么意思 - 您想要获得什么数据？

**澄清后**更新****

 **假设

```
public class Row
{
    public int ID{get;set;}
    public string Date{get;set;}
    public int Count{get;set;}
}

Row r1 = new Row{ID=1, Date="01/01/01", Count=5};
Row r2 = new Row{ID=2, Date="01/02/01", Count=5};
Row r3 = new Row{ID=3, Date="01/03/01", Count=5};
Row r4 = new Row{ID=4, Date="01/04/01", Count=7};
Row r5 = new Row{ID=5, Date="01/05/01", Count=7};
Row r6 = new Row{ID=6, Date="01/06/01", Count=7};
Row r7 = new Row{ID=7, Date="01/07/01", Count=4};
Row r8 = new Row{ID=8, Date="01/08/01", Count=4};
Row r9 = new Row{ID=9, Date="01/09/01", Count=4};
Row r10 = new Row{ID=10, Date="01/01/01", Count=4};

List<Row> rows = new List<Row>{r1,r2,r3,r4,r5,r6,r7,r8,r9,r10}; 
```

然后

```
// We will assign results of our query to this variable
var result = 

// rows is a generic list of Row objects
rows                  

   // This splits the list into seperate categories organised by Count
   // After the GroupBy, we have an IEnumerable<IGrouping<Int32, Row>> - that is, a collection of collections of items sharing a common key (in this case Count)
   .GroupBy(r=>r.Count)  // r is of type Row

    // Now we are simply selecting the first item of each subgroup.
   .Select(g=>g.First()) // g is IGrouping<Int32,Row>, g.First() is of type Row
   ; 
```

给

```
 ID    Date        Count
    1    01/01/01    5
    4    01/04/01    7
    7    01/07/01    4 
```

# .net - 如何使用 ASP.NET MVC 处理多个表单输入字段

> ID：811087
> 
> 赞同：2
> 
> 时间：2009-05-01T11:53:58.260
> 
> 标签：.net, asp.net, asp.net-mvc

我正在编写一个调查应用程序，并且我有一个可能有数百个输入字段的表单。我将如何编写控制器来处理此表单？我不能将每个输入指定为控制器的参数，这是不现实的。

我发现了 MVCToolkit 和 UpdateFrom() 方法，但这是正确的方法吗？如果是这样，我将如何在我的应用程序中安装 MVCToolkit？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T12:12:04.703

您也可以接受集合作为 Action 中的参数。

```
public ActionResult TheAction (string[] answers) {

} 
```

网页：

```
<input type="text" name="answers[0]" value="" />
<input type="text" name="answers[1]" value="" />
<input type="text" name="answers[2]" value="" />
<!--and so on --> 
```

默认模型绑定器将使用表单中输入的值自动填充您的操作中的答案数组。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T12:00:03.063

它实际上比这简单得多。您只需要使用一个名为`FormCollection`.

```
public ActionResult MyFormUpdate (int id, FormCollection form) {
    // do form updates
} 
```

# c++ - 在向量中存储重复字符串时节省内存？

> ID：811088
> 
> 赞同：4
> 
> 时间：2009-05-01T11:53:59.303
> 
> 标签：c++, string, memory, vector

我正在使用 C++，它是 STL。我有一个大 (100MB+) 文本文件。该文件只有很多“单词”（由空格分隔的字符串），例如：

```
sdfi sidf ifids sidf assd fdfd fdfd ddd ddd 
```

我需要将这些“单词”中的每一个放在一个向量中：

```
vector<string> allWordsInFile; 
```

因此，对于我从文件中读取的每个单词，我都会：

```
allWordsInFile.push_back(word); 
```

该文件有很多重复的单词，我正在寻找节省内存的方法。每个单词都需要在向量中的正确位置表示。如果我可以只列出向量之外的所有单词，然后在向量中放置一个引用，那就太好了，但据我所知，不可能将引用放入向量中。然后我想只存储指向单词的指针，但是每个单词的长度太短了，我认为它不会有太大的不同？（在我的系统上，每个指针是 4 个字节，大多数字符串的大小可能大致相同）。

有人可以建议另一种方法来解决这个问题吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-01T12:10:35.380

[boost::flyweight](http://www.boost.org/doc/libs/1_38_0/libs/flyweight/doc/tutorial/index.html)在这里看起来很有用。

事实上，[教程示例](http://www.boost.org/doc/libs/1_38_0/libs/flyweight/doc/tutorial/basics.html)显示`boost::flyweight<std::string>`用于压缩数据库中名称的重复项。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T12:54:43.090

嗯，你真正想做的就是所谓的压缩。

霍夫曼编码在这里可能会做得很好。您进行一次扫描以构建单词的频率表，然后应用 Huffman 算法为每个单词附加一个符号。然后你用适当的顺序组成一排代表单词的位。这行位可以被视为您的“低内存向量”。

霍夫曼编码的本质让你可以在任何你想要的位置访问符号（没有符号是另一个符号的前缀），这里的问题是访问时间将是 O(n) 有一些优化可以减少访问时间但是只有通过一个常数因素，没有什么可以阻止它成为 O(n) 并且仍然保留少量内存使用。如果您想了解可以完成的优化，请给我留言。

**缺点：**

1.  在构建了编码的单词之后，在 O(n) 中的访问，你必须线性扫描符号直到你到达适当的位置。
2.  这个想法的实现一点也不简单，而且会耗费你大量的时间。

**编辑**：写这篇文章时我没有想到的一件事，你必须拿着查找表。所以这可能只有在你有**很多****重复**的单词时才有效。

霍夫曼编码： [http ://en.wikipedia.org/wiki/Huffman_coding](http://en.wikipedia.org/wiki/Huffman_coding)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-01T12:05:39.103

如果您没有很多单词，则可以将单词存储在外部数组中，并将相应的索引存储在单词向量中。根据有多少唯一字，每个字只能有 1 个（最多 256 个字）或 2 个（最多 65536 个字）字节。

如果您需要速度，可以使用 std::map 在 log(n) 时间内查找字符串的索引（而不是遍历外部数组）

例如最大。65536个独特的词

```
vector<short> words
map<string,short> index
vector<string> uniqueWords
cindex = 0
for all words
    read the word
    if index[word] does not exist
        index[word] = cindex++
        uniqueWords.push_back(word)
    words.push_back(index[word]); 
```

要检索原始单词，只需在 uniqueWords 中查找即可。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-01T12:06:13.550

一种方法是存储一个仅包含唯一字符串的向量。然后，“单词”列表只是一个整数向量，作为唯一字符串数组的索引。这将以较慢的文件读取速度为代价节省内存，因为您必须在 uniques 数组中为每个新单词进行某种线性扫描。然后，您可以使用映射作为唯一字符串数组的索引 - 如果在集合中找不到新单词，那么您知道将单词添加到唯一字符串列表的末尾。嘿，想想看，你甚至不需要矢量，因为地图就是为了这个目的：

```
typedef map<string, int> UniqueIndex;
UniqueIndex uniqueIndex;

typedef vector<int> WordsInFile;
WordsInFile wordsInFile;

for (each word in the file)
{
  UniqueIndex::const_iterator it=uniqueIndex.find(word);
  int index; // where in the "uniqueIndex" we can find this word
  if (it==uniqueIndex.end())
  {
    // not found yet
    index=uniqueIndex.size();
    uniqueIndex[word]=index;
  }
  else
    index=it.second;
  wordsInFile.push_back(index);
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-01T12:02:23.823

由于您的字符串通常大约为 4 个字节，因此简单地创建另一个级别的间接将无济于事，因为指针的大小是 4 个字节（在 x86 上，或者更糟糕的是 x64 上的 8 个字节）。基于 int 的索引的大小也是 4 个字节。

**分部加载：**

您可以考虑按部分加载文件以节省内存。仅根据他们想要找到的单词位置加载您需要的内容。

您可以扫描文件一次以建立索引。该索引将存储每 10 个单词的起始位置（10 个任意选择）。

然后，如果您想访问单词 11，您将计算 11 除以 10 以获得该组的起始位置在索引中的位置，并寻找找到的起始位置。然后计算 11 模 10 以找出要从该索引中读取多少单词以获得所需的单词。

此方法不会尝试消除存储重复字符串，但它将您需要使用的 RAM 限制为仅索引的大小。您可以将上面的“每 10 个单词”调整为“每 X 个单词”以减少内存消耗。因此，您在 RAM 中使用的大小将仅为 (num_words_in_file/X)*sizeof(int) ，这比将整个文件存储在 RAM 中的大小要小得多，即使您只存储了每个唯一字符串一次。

**在没有额外空格的情况下访问每个单词：**

如果您用某个字符填充每个单词，以使每个单词的大小相同，则在读入时忽略填充字符。您可以访问确切的单词，而无需额外的通过阶段来构建索引，并且几乎没有额外的空间.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-01T13:36:47.730

您需要指定需要在向量上快速执行哪些操作，否则无法设计出合适的解决方案。您需要主要是随机访问，还是主要是顺序访问？随机访问可以接受什么样的性能？

为了说明我的观点：存储数据的一种方法是使用 LZMA 或其他好的压缩库简单地压缩它们。然后当你需要访问某个元素时，你解压，一旦解压不再需要它们就丢弃解压数据。这样的存储将非常节省空间，顺序访问将相当快，但随机访问时间将非常糟糕。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-10T22:28:31.723

在另一个答案中指出你之后`boost::flyweight`，我想仔细看看字符串容器的相对效率，flyweights和用指针联合四个字符的“核选项”（下面的代码中的类“sillystring”）。

代码注释：

*   使用 g++ 4.3.3 和 boost 1.38.0 在 32 位 Debian/squeeze 上工作
*   使用`std::deque`而不是`std::vector`因为向量的大小加倍行为（cf deques 块）如果测试用例最近恰好加倍，则会（可以说）给人一种低效率的误导印象。
*   “sillystring”使用指针的 LSB 来区分指针用例和本地字符用例。这应该可以工作，除非你的 malloc 在奇数字节边界上分配（在这种情况下代码会抛出）（当然在我的系统上没有看到这个；YMMV）。在任何人觉得有必要指出之前，是的，我确实认为这个可怕的危险黑客代码而不是轻易选择的选项。

结果因字长分布而异，但对于分布“(2D6+1)/2”（峰值为 4，但长度为 1 到 6），效率（定义为实际内存消耗与需要存储的实际字符数）为：

*   12.4%`deque<string>`
*   20.9%`deque<flyweight<string> >`
*   43.7%`deque<sillystring>`

如果您*所有*的单词都是 4 个字符（`const int length=4;`在单词生成器中更改为），这是 sillystring 的理想情况，那么您会得到：

*   14.2%`deque<string>`
*   77.8%`deque<flyweight<string> >`
*   97.0%`deque<sillystring>`

所以flyweight肯定是一个快速的改进，但你可以通过利用你的单词适应指针大小的空间并避免额外的堆开销来做得更好。

这是代码：

```
// Compile with "g++ -O3 -o fly fly.cpp -lpthread"
// run "./fly 0 && ./fly 1 && ./fly 2" 

#include <boost/flyweight.hpp>
#include <boost/format.hpp>
#include <boost/random.hpp>
#include <cstring>
#include <deque>
#include <fstream>
#include <iostream>
#include <sstream>
#include <string>
#include <vector>

#include <sys/types.h>
#include <unistd.h>

#define THROW(X,MSG) throw X(boost::str(boost::format("%1%: %2%") % __PRETTY_FUNCTION__ % MSG))

struct random_word_generator
{
  random_word_generator(uint seed)
    :_rng(seed),
     _length_dist(1,6),
     _letter_dist('a','z'),
     _random_length(_rng,_length_dist),
     _random_letter(_rng,_letter_dist)
  {}
  std::string operator()()
  {
    std::string r;
    const int length=(_random_length()+_random_length()+1)/2;
    for (int i=0;i<length;i++) r+=static_cast<char>(_random_letter());
    return r;
  }
private:
  boost::mt19937 _rng;
  boost::uniform_int<> _length_dist;
  boost::uniform_int<> _letter_dist;
  boost::variate_generator<boost::mt19937&,boost::uniform_int<> > 
    _random_length;
  boost::variate_generator<boost::mt19937&,boost::uniform_int<> > 
    _random_letter;
};

struct collector
{
  collector(){}
  virtual ~collector(){}

  virtual void insert(const std::string&)
    =0;
  virtual void dump(const std::string&) const
    =0;
};

struct string_collector
  : public std::deque<std::string>, 
    public collector
{
  void insert(const std::string& s)
  {
    push_back(s);
  }
  void dump(const std::string& f) const
  {
    std::ofstream out(f.c_str(),std::ios::out);
    for (std::deque<std::string>::const_iterator it=begin();it!=end();it++)
      out << *it << std::endl;
  }
};

struct flyweight_collector 
  : public std::deque<boost::flyweight<std::string> >, 
    public collector
{
  void insert(const std::string& s)
  {
    push_back(boost::flyweight<std::string>(s));
  }
  void dump(const std::string& f) const
  {
    std::ofstream out(f.c_str(),std::ios::out);
    for (std::deque<boost::flyweight<std::string> >::const_iterator it=begin();
         it!=end();
         it++
         )
      out << *it << std::endl;
  }
};

struct sillystring
{
  sillystring()
  {
    _rep.bits=0;
  }
  sillystring(const std::string& s)
  {
    _rep.bits=0;
    assign(s);
  }
  sillystring(const sillystring& s)
  {
    _rep.bits=0;
    assign(s.str());
  }
  ~sillystring()
  {
    if (is_ptr()) delete [] ptr();
  }
  sillystring& operator=(const sillystring& s)
  {
    assign(s.str());
  }
  void assign(const std::string& s)
  {
    if (is_ptr()) delete [] ptr();
    if (s.size()>4)
      {
        char*const p=new char[s.size()+1];
        if (reinterpret_cast<unsigned int>(p)&0x00000001)
          THROW(std::logic_error,"unexpected odd-byte address returned from new");
        _rep.ptr.value=(reinterpret_cast<unsigned int>(p)>>1);
        _rep.ptr.is_ptr=1;
        strcpy(ptr(),s.c_str());
      }
    else
      {
        _rep.txt.is_ptr=0;
        _rep.txt.c0=(s.size()>0 ? validate(s[0]) : 0);
        _rep.txt.c1=(s.size()>1 ? validate(s[1]) : 0);
        _rep.txt.c2=(s.size()>2 ? validate(s[2]) : 0);
        _rep.txt.c3=(s.size()>3 ? validate(s[3]) : 0);
      }
  }
  std::string str() const
  {
    if (is_ptr())
      {
        return std::string(ptr());
      }
    else
      {
        std::string r;
        if (_rep.txt.c0) r+=_rep.txt.c0;
        if (_rep.txt.c1) r+=_rep.txt.c1;
        if (_rep.txt.c2) r+=_rep.txt.c2;
        if (_rep.txt.c3) r+=_rep.txt.c3;
        return r;
      }
  }
private:
  bool is_ptr() const
  {
    return _rep.ptr.is_ptr;
  }
  char* ptr()
  {
    if (!is_ptr())
      THROW(std::logic_error,"unexpected attempt to use pointer");
    return reinterpret_cast<char*>(_rep.ptr.value<<1);
  }
  const char* ptr() const
  {
    if (!is_ptr()) 
      THROW(std::logic_error,"unexpected attempt to use pointer");
    return reinterpret_cast<const char*>(_rep.ptr.value<<1);
  }
  static char validate(char c)
  {
    if (c&0x80)
      THROW(std::range_error,"can only deal with 7-bit characters");
    return c;
  }
  union
  {
    struct
    {
      unsigned int is_ptr:1;
      unsigned int value:31;
    } ptr;
    struct
    {
      unsigned int is_ptr:1;
      unsigned int c0:7;
      unsigned int :1;
      unsigned int c1:7;
      unsigned int :1;
      unsigned int c2:7;      
      unsigned int :1;
      unsigned int c3:7;      
    } txt;
    unsigned int bits;
  } _rep;
};

struct sillystring_collector 
  : public std::deque<sillystring>, 
    public collector
{
  void insert(const std::string& s)
  {
    push_back(sillystring(s));
  }
  void dump(const std::string& f) const
  {
    std::ofstream out(f.c_str(),std::ios::out);
    for (std::deque<sillystring>::const_iterator it=begin();
         it!=end();
         it++
         )
      out << it->str() << std::endl;
  }
};

// getrusage is useless for this; Debian doesn't fill out memory related fields
// /proc/<PID>/statm is obscure/undocumented
size_t memsize()
{
  const pid_t pid=getpid();
  std::ostringstream cmd;
  cmd << "awk '($1==\"VmData:\"){print $2,$3;}' /proc/" << pid << "/status";
  FILE*const f=popen(cmd.str().c_str(),"r");
  if (!f)
    THROW(std::runtime_error,"popen failed");
  int amount;
  char units[4];
  if (fscanf(f,"%d %3s",&amount,&units[0])!=2)
    THROW(std::runtime_error,"fscanf failed");
  if (pclose(f)!=0)
    THROW(std::runtime_error,"pclose failed");
  if (units[0]!='k' || units[1]!='B')
    THROW(std::runtime_error,"unexpected input");
  return static_cast<size_t>(amount)*static_cast<size_t>(1<<10);
}

int main(int argc,char** argv)
{
  if (sizeof(void*)!=4)
    THROW(std::logic_error,"64-bit not supported");
  if (sizeof(sillystring)!=4) 
    THROW(std::logic_error,"Compiler didn't produce expected result");

  if (argc!=2)
    THROW(std::runtime_error,"Expected single command-line argument");

  random_word_generator w(23);

  std::auto_ptr<collector> c;
  switch (argv[1][0])
    {
    case '0':
      std::cout << "Testing container of strings\n";
      c=std::auto_ptr<collector>(new string_collector);
      break;
    case '1':
      std::cout << "Testing container of flyweights\n";
      c=std::auto_ptr<collector>(new flyweight_collector);
      break;
    case '2':
      std::cout << "Testing container of sillystrings\n";
      c=std::auto_ptr<collector>(new sillystring_collector);
      break;
    default:
      THROW(std::runtime_error,"Unexpected command-line argument");
    }

  const size_t mem0=memsize();

  size_t textsize=0;
  size_t filelength=0;
  while (filelength<(100<<20))
    {
      const std::string s=w();
      textsize+=s.size();
      filelength+=(s.size()+1);
      c->insert(s);
    }

  const size_t mem1=memsize();
  const ptrdiff_t memused=mem1-mem0;

  std::cout 
    << "Memory increased by " << memused/static_cast<float>(1<<20)
    << " megabytes for " << textsize/static_cast<float>(1<<20)
    << " megabytes text; efficiency " << (100.0*textsize)/memused << "%"
    << std::endl;

  // Enable to verify all containers stored the same thing:
  //c->dump(std::string(argv[1])+".txt");

  return 0;
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-01T12:36:47.250

如果您有可能不使用向量 - 另一种可能性，类似于上面的某些解决方案，但只有一个结构而不是两个结构，将单词映射到整数列表，每个整数代表位置，以及每次阅读单词时递增的计数变量：

```
 int count = 0;
   Map<String, List<Integer>> words = new HashMap<String, List<Integer>>(); 
```

然后它类似于（Java 类型的伪代码）：

```
 for (word : yourFile) {
      List<Integer> positions = words.get(word);
      if (values == null) {
         positions = new ArrayList<Integer>();
      }
      positions.add(++count);
      words.put(word, positions);
   } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-01T13:10:10.383

首先，我们应该知道字符串是什么样的：

如果“大多数字符串是 4 个字母”并且文件是 100MB，那么

a）必须有很多重复项，也许你最好存储*不在*数组中的字符串（特别是如果你可以忽略这种情况），但这不会给你它们在向量中的位置。

b）也许有一种方法可以从 ascii 8 位（假设它确实是 ASCII）（8X4=32）压缩到 20 位（5x4），每个字母使用 5 位，并且有一些花哨的位可以减少大小的向量。请运行数据样本并查看文件中确实有多少不同的字母，也许某些字母组非常丰富以至于为它们分配一个特殊值（在 8 位序列中的 32 个选项中）是有意义的。实际上，如果我是正确的，如果大多数单词都可以转换为 20 位表示，那么只需要一个 3MB 的数组来存储所有单词及其字数 - 并分别处理 >4 个字符（假设 3 个字节是对于字数来说足够了，它应该，也许 2 个字节就足够了：可以使它动态化，总共使用 2MB）

c）另一个不错的选择是，我认为上面有人说过，只需将字符串与字母连接起来并在其上运行压缩器，坏事是 cpu 负载和它可能需要压缩//解压缩的临时内存。除此之外应该工作得很好

d）如果你真的想最小化使用的内存，也许你想使用你的磁盘：对单词进行排序（如果没有足够的内存，你可以使用磁盘），然后一个接一个地创建一个带有单词的临时文件，那将做顺序访问。然后，您可以创建单词的一次性树状表示，其叶子包含文件中单词的相对地址以进行随机访问，并将其“序列化”到磁盘。最后，由于大多数单词的长度为 4 个字符，因此只需 5 个跃点，您就可以在不使用任何 ram 的情况下获得文件中任何字母的位置，可以这么说。您还可以将树的前 2 或 3 层缓存在 ram 中，这将是轻量级的，以将 4 个字符的单词的跳跃减少到 2 或 3 跳。然后你可以使用一些小内存来缓存最常用的单词，并做各种细节来加快访问速度。

已经很晚了，希望我是有道理的...

PD。谢谢大家的评论

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-01T12:04:26.347

我认为使用这样的东西可以节省内存：

```
struct WordInfo
{
    std::string m_word;
    std::vector<unsigned int> m_positions;
};

typedef std::vector<WordInfo> WordVector;

First find whether the word exists in WordVector

If no,
    create WordInfo object and push back into WordVector
else
    get the iterator for the existing WordInfo
    Update the m_positions with the position of the current string 
```

# c# - 嵌套类和递归

> ID：811098
> 
> 赞同：1
> 
> 时间：2009-05-01T11:57:47.580
> 
> 标签：c#, reflection, class, recursion, nested

说我有这两个课

```
public class Container
{
    public string name { get; set; }
    public Inner Inner { get; set; }
}

public class Inner
{
    public string text { get; set; }
    public Inner2 Innert2 { get; set; }
}

public class Inner2 {} 
```

我将如何去，给定一个类的`Container`实例找到所有嵌套的类实例。只关心类而不是字符串等。

需要是通用的，这样如果 Inner 有一个类它仍然可以工作。此外，如果有一个`List<>`或`IEnumerable`一个类，它也需要找到它们。

干杯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T12:06:23.533

使用反射将是要走的路。这是一个简单的代码片段，可以让您获取类的属性，如果属性不是值类型，则递归调用自身。显然，如果您想要 Enums 或 IEnumerable 成员的特定行为，则需要添加它。

```
public void FindClasses(object o)
{
    if (o != null)
    {
        Type t = o.GetType();
        foreach(PropertyInfo pi in t.GetProperties())
        {
            if(!pi.PropertyType.IsValueType)
            {
                // property is of a type that is not a value type (like int, double, etc).
                FindClasses(pi.GetValue(o, null));
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T12:15:35.990

如果您的示例中的代码是这样的，您的问题将起作用：

```
public class Container
{
    public string name { get; set; }
    public Inner Inner { get; set; }
}

public class Inner
{
    public string text { get; set; }
    public List<Inner> MoreInners { get; set; }
} 
```

在这种情况下，您可以使用外部迭代器类来完成工作，或者将递归直接构建到 Container 类中。我会做后者：

```
public class Container
{
    public string name { get; set; }
    public Inner Inner { get; set; }

    public List<Inner> SelectAllInner()
    {
        List<Inner> list = new List<Inner>();
        SelectAllInner(Inner, list);
        return list;
    }

    private void SelectAllInner(Inner inner, List<Inner> list)
    {
        list.Add(inner);
        foreach(Inner inner in MoreInners)
            SelectAllInner(inner, list);
    }
}

public class Inner
{
    public string text { get; set; }
    public List<Inner> MoreInners { get; set; }
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-01T12:03:15.723

您想通过反射递归循环对象图

[http://msdn.microsoft.com/en-us/library/ms173183(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms173183(VS.80).aspx)

# oop - 过程式编程可以使用对象吗？

> ID：811099
> 
> 赞同：2
> 
> 时间：2009-05-01T11:58:04.193
> 
> 标签：oop, procedural

我在 StackOverFlow 上看到了许多不同的主题，讨论过程和面向对象编程之间的差异。问题是：如果程序使用一个对象，它仍然可以被认为是程序性的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T12:00:34.140

是的，*很多*早期的 Java 就是这样。你有一群 C 程序员进入 Java 是因为它很“热”，他们没有在 OOP 中思考。很多大类有很多静态方法，很多 RTTI in case 语句，大量使用`instanceof`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T12:02:03.963

GLib 具有[GObject](http://library.gnome.org/devel/gobject/unstable/chapter-intro.html#id2751431)，它是用纯 C 实现的面向对象编程。虽然您可以构建一个开始“感觉”像 OOP 的 API，但它仍然只是没有实际类的纯“C”代码（从编译器的角度来看）。如果你走得够远，以至于你开始实现面向对象的设计模式，那么无论它是用什么语言编写的，我都会称它为 OOP。这完全取决于代码的感觉以及你必须如何思考如何针对它进行编写。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T12:03:32.777

过程式编程与您如何构建程序和为您的领域建模有关。仅仅因为在某些时候您实例化了一个对象，并不能单独使您的程序面向对象（即面向对象）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T12:01:48.427

区别完全是主观的。例如，如果您使用状态传递对 C 库进行编码，您正在实现某种“告诉”模式，将状态作为对象。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T12:06:32.503

类可以被视为超类型。当我们从 VB3 转换到 VB6 时，我们的第一遍是查找我们使用的所有类型，然后查找所有以该类型为参数的子例程和函数。我们将它们移到类定义中，删除参数，然后进行测试，保持原始控制流不变

然后我们重构了我们的控制流以使用各种模式和面向对象的技术。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T12:13:19.273

面向对象的核心是关于如何将问题分解为更小的部分，以及这些部分如何协同工作。这是关于哲学的。使用OO语言并不一定意味着用它编写的程序就是OO；使用支持开箱即用的常见 OO 概念的语言来执行 OO 会更容易。

回答这个问题：“如果程序使用一个对象，它仍然可以被认为是程序性的吗？” - 这取决于您对对象和过程编程的定义是什么。但在我看来，答案是响亮的“是”。“对象”只是 OO 哲学的一部分，“在应用程序的某个地方”使用它们并不意味着您正在做 OO。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-01T12:13:31.130

你的问题的答案是，是的。例如。我有一个旧的 php 遗留页面要维护。大多数代码都是程序性的，但我认为如果我将 Zend Framework 插入现有的东西并编写一些我自己的类来替换一些旧代码，那么可以更容易地维护一些东西。通常，此应用程序仍以主要程序方式编写和运行，但有时会实例化和使用一个类或另一个类。我想程序和面向对象之间没有明确的界限。你可以做得更干净或更不干净。如果您的应用程序的大小和复杂性没有足够的层数，您最终也会自动获得更多的程序代码......

# .net - WPF WBA (XBAP) versus Silverlight

> ID：811121
> 
> 赞同：17
> 
> 时间：2009-05-01T12:07:33.327
> 
> 标签：.net, wpf, silverlight, xbap, browser

I'm looking into creating a system / site which includes a website. I would like to get the benefits of WPF, and WBA seems to be a good avenue of doing this. Silverlight on the other hand is also good for accomplishing this goal, with the difference that WBA provides more options and power than Silverlight.

What are the benefits / losses that come with using WBA versus Silverlight? Is WBA only supported in IE?

Any insight would be very helpful.

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-05-01T12:25:42.817

I assume you mean XBAP (XAML Browser Application) with WBA?

Silverlight and XBAP are pretty similar to each other but they do have some major differences. The largest of these is most likely the fact that XBAPs run on top of the full .Net framework while Silverlight uses a stripped down version of the CLR and class libraries. This results in Silverlight lacking some of the features that WPF has which are available in XBAPs.

Also it is worth understanding that XBAPs are technically ClickOnce applications and as such they are installed to the user's computer. This happens automatically and the user doesn't necessarily understand that - but at least for me, if I saw a XBAP loading from a random web site, I would most likely cancel it and go to another site.

XBAPs also require IE or Firefox and the .Net framework they are built for. Silverlight requires only the Silverlight player which is available for IE, Firefox and Safari and works on Windows and OSX and is much smaller than the full .Net framework in terms of download size.

This said, I prefer XBAPs if I know that the limitations are not an issue. If I was developing an application for intranet use, I'd go with a XBAP as it provides more versatile framework. If the application was to be deployed in the internet, I'd use Silverlight to reach as many users as possible.

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-01T12:45:21.177

I assume that by WBA you mean [XAML Browser Application](http://en.wikipedia.org/wiki/XAML_Browser_Applications) (XBAPs), which are WPF applications that run in a web browser.

The advantages can be summarised as follows:

## XBAP

*   XBAP applications have the full CLR and entire .NET Framework 3.0/3.5 avilable to them, whereas Silverlight apps only have the reduced Silverlight CLR and its own lightweight version of the .NET Framework/WPF (though it's not strictly called WPF .
*   Can run in full-trust mode with a bit of configuration. (See [this MSDN blog post](http://blogs.msdn.com/karstenj/archive/2005/11/29/498061.aspx).) Silverlight permissions are heavily restricted for obvious reasons.

## Silverlight

*   Can run cross-platform. (On Windows and Mac using the official Microsoft implementation and on Linux using Moonlight. Moonlight support is complete for Silverlight 1.0 but only partially implemented for Silverlight 2.0.)
*   Can run in all major browsers. (IE 6/7/8, Firefox 3, Safari. There are even reports of some success with Google Chrome.) XBAPs on the other hand can only run in IE (using .NET 3.0) or IE and Firefox (.NET 3.5).

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T12:27:00.160

Yes, WBA (XBAP) is only supported in IE and Firefox (with a [plugin](https://addons.mozilla.org/en-US/firefox/addon/1419)), and only on the Windows operating system. The Silverlight toolset is mostly a subset of WPF, so with WBA you will have access to more tools. Check out this [link](http://cincomsmalltalk.com/userblogs/runarj/blogView?showComments=true&title=Windows+Presentation+Foundation+(WPF)+and+Silverlight&entry=3366522423) on it.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T12:25:12.990

Silverlight is cross platform and cross browser. WPF WBA is Windows only and IE only.

# federated-identity - Simple Claims Transformation for an RP-STS in Geneva Framework

> ID：811127
> 
> 赞同：3
> 
> 时间：2009-05-01T12:12:14.017
> 
> 标签：federated-identity, geneva-framework, claims-based-identity

After reading the MSDN article ([http://msdn.microsoft.com/en-us/magazine/2009.01.genevests.aspx](http://msdn.microsoft.com/en-us/magazine/2009.01.genevests.aspx)) on implementing a Custom STS using the Microsoft Geneva Framework I am a bit puzzled about one of the scenarios covered there. This scenario is shown in figure 13 of the above referenced article.

My questions are around how does the RP initiate the call to the RP-STS in order to pass on the already obtained claims from the IP-STS? How does the desired method DeleteOrder() get turned into a Claim Request for the Action claim from the RP-STS which responds with the Action claim with a value Delete which authorizes the call? I also think the figure is slightly incorrect in that the interaction between the RP-STS and the Policy Engine should have the Claims and arrows the other way around.

I can see the structure but it's not clear what is provided by Geneva/WCF and what has to be done in code inside the RP, which would seem a bit odd since we could not protect the DeleteOrder method with a PrincipalPermission demand for the Delete "permission" but would have to demand a Role first then obtain the fine-grained claim of the Delete Action after that point.

If I have missed the point (since I cannot find this case covered easily on the Web), then apologies!

Thanks in advance.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T16:36:46.437

I asked the same question on the Geneva Forum at [http://social.msdn.microsoft.com/Forums/en/Geneva/thread/d10c556c-1ec5-409d-8c25-bee2933e85ea?prof=required](http://http:social.msdn.microsoft.com/Forums/en/Geneva/thread/d10c556c-1ec5-409d-8c25-bee2933e85ea?prof=required "MS Geneva Forum") and got this reply:

Hi Dokie,

I wondered this same thing when I read that article. As I've pondered how such a scenario would be implemented, I've come up w/ two ideas:

1.  The RP is actually configured to require claims from the RP-STS; the RP-STS requires a security token from the IP-STS. As a result, when the subject requests a resource of the RP, it bounces him to the RP-STS who bounces him to the IP-STS. After authenticating there, he is bounced back to the RP-STS, the identity-centric claims are transformed into those necessary to make an authorization decision and returned to the RP.

2.  The RP is configured to have an interceptor (e.g., an AuthorizationPolicy if it's a WCF service) that grabs the call, sees the identity-centric claims, creates an RST (using the WSTrustClient), passes it to the RP-STS, that service expands the claims into new one that are returned to the RP, and the RP makes an authorization decision.

I've never implemented this, but, if I were going to, I would explore those two ideas further.

HTH!

* * *

Regards,

Travis Spencer

So I will try option 2 first and see if that works out then formulate an answer here.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-05-11T11:46:44.620

I've got situation one working fine. In my case AD FS is the Identity Service and a custom STS the Resource STS.

All webapp's use the same Resource STS, but after a user visits an other application the Identity releated claims are not addad again by the AD FS since the user is already authenticated. How can I force or request the basic claims from the AD FS again?

I've created a call to the AD FS with ActAs, now it returns my identification claims. Remember to enable a Delegation allowed rule for the credentials used to call the AD FS.

```
string stsEndpoint = "https://<ADFS>/adfs/services/trust/2005/usernamemixed";
     var trustChannelFactory = new WSTrustChannelFactory(new UserNameWSTrustBinding(SecurityMode.TransportWithMessageCredential), stsEndpoint);

     trustChannelFactory.Credentials.UserName.UserName = @"DELEGATE";
     trustChannelFactory.Credentials.UserName.Password = @"PASSWORD";

     trustChannelFactory.TrustVersion = TrustVersion.WSTrustFeb2005;

     //// Prepare the RST.
     //var trustChannelFactory = new WSTrustChannelFactory(tokenParameters.IssuerBinding, tokenParameters.IssuerAddress);
     var trustChannel = (WSTrustChannel)trustChannelFactory.CreateChannel();

     var rst = new RequestSecurityToken(RequestTypes.Issue);

     rst.AppliesTo = new EndpointAddress(@"https:<RPADDRESS>");

     // If you're doing delegation, set the ActAs value.
     var principal = Thread.CurrentPrincipal as IClaimsPrincipal;
     var bootstrapToken = principal.Identities[0].BootstrapToken;

     // The bootstraptoken is the token received from the AD FS after succesfull authentication, this can be reused to call the AD FS the the users credentials
     if (bootstrapToken == null)
     {
        throw new Exception("Bootstraptoken is empty, make sure SaveBootstrapTokens = true at the RP");
     }

     rst.ActAs = new SecurityTokenElement(bootstrapToken);

     // Beware, this mode make's sure that there is no certficiate needed for the RP -> AD FS communication
     rst.KeyType = KeyTypes.Bearer;

     // Disable the need for AD FS to crypt the data to R-STS
     Scope.SymmetricKeyEncryptionRequired = false;

     // Here's where you can look up claims requirements dynamically.
     rst.Claims.Add(new RequestClaim(ClaimTypes.Name));
     rst.Claims.Add(new RequestClaim(ClaimTypes.PrimarySid));

     // Get the token and attach it to the channel before making a request.
     RequestSecurityTokenResponse rstr = null;
     var issuedToken = trustChannel.Issue(rst, out rstr);
     var claims = GetClaimsFromToken((GenericXmlSecurityToken)issuedToken);

 private static ClaimCollection GetClaimsFromToken(GenericXmlSecurityToken genericToken)
  {
     var handlers = FederatedAuthentication.ServiceConfiguration.SecurityTokenHandlers;
     var token = handlers.ReadToken(new XmlTextReader(new StringReader(genericToken.TokenXml.OuterXml)));
     return handlers.ValidateToken(token).First().Claims;
  } 
```

# .net - Regex.Replace：如何使用 $groups 后跟数字

> ID：811128
> 
> 赞同：22
> 
> 时间：2009-05-01T12:12:41.927
> 
> 标签：.net, regex

使用 Regex::Replace 我们可以使用 $1, $2, ... 来匹配相应的组。但是我怎样才能使用 $1 后跟数字。例如用 678 替换 6？

```
 Regex::Replace(text, "(6)", '$178'); 
```

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-05-01T12:17:44.020

您需要使用替代语法：

```
Regex::Replace(text, "(6)", "${1}78"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T12:17:33.537

看来我可以使用 $`

```
Regex::Replace(text, "(6)", '$1$`78'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T12:17:47.763

您可以使用反向引用来捕获命名组并将该命名组替换为您想要的任何内容。 [查看此链接](http://www.regular-expressions.info/named.html)

# optimization - 如何减小 swf 文件大小

> ID：811129
> 
> 赞同：1
> 
> 时间：2009-05-01T12:13:02.237
> 
> 标签：optimization, flex3, flash, filesize, reduce

如何减小我的 flex 应用程序的文件大小。它大约 900kb 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T12:18:41.380

您可以通过在您的 flex 项目上实现 rsl 并将其拆分为模块来实现这一点，以了解实现文件大小优化的详细信息。

查看这篇文章：[优化 Flex SWF 文件大小性能加载](https://web.archive.org/web/20140723200345/http://askmeflash.com/article/9/optimize-flex-swf-filesize-performance-loading)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-18T14:42:50.607

文章没有提到的一个易于实现的解决方案是使用一个工具来缩小您的 as3 代码，作为部署编译过程的一部分。

在包含大量代码和少量图像的项目中，我已经看到这将文件大小减少了一半以上。有几个开源工具包可以做到这一点，我发现 SecureSWF 是最可靠的。

# asp.net - 如何在我的域模型中实现 ASP.NET 成员资格提供程序

> ID：811137
> 
> 赞同：20
> 
> 时间：2009-05-01T12:17:04.710
> 
> 标签：asp.net, architecture, asp.net-membership

在一个网站中，我需要整合会员资格和身份验证。所以我想使用 ASP.NET Membership 的功能，但我还有其他自定义的东西，“用户”必须这样做。

所以我坐在这里，拿着我的铅笔和纸，为我的领域模型画线……我怎样才能最好地利用 ASP.Net 成员资格，同时扩展它来满足我的需要？

我是否应该创建一个从 MembershipUser 继承的类并使用我自己的属性和方法对其进行扩展（并将其保存在单独的表中）。或者我应该让 MembershipUser 成为我的自定义用户/客户对象的一个​​属性？

有什么好的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-01T12:43:04.927

我已经考虑过了，有两种方法看起来很合适（当然还有更多方法可以让它发挥作用）。

## 自定义会员提供者

您将成员资格提供者更改为使用您自己的并使用您的用户对象来存储所有信息。

这个问题是它涉及到很多已经被 Asp.Net 很好处理的东西的重新实现。好消息是您有一个包含所有详细信息的用户对象。

## 从会员用户链接到您的用户

使用这种方法，您将使用原始的成员资格提供程序来处理用户名和密码，但是您可以通过使用服务将您自己的用户对象与此用户对象链接到用户名之类的东西。

设置起来非常简单，您只需要创建一个可以像这样使用的服务：

```
string userName = "Jon Skeet";
User user = new UserManagementServices().GetUserByUserName(userName); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-19T19:30:21.057

我最终编写了自己的会员提供程序，现在已经在 3 个单独的解决方案中实现了它。它比将用户链接到会员用户（我也尝试过）非常简单且优雅得多。

读这个...：

[为 ASP.NET 网站安全创建自定义成员资格提供程序](http://davidhayden.com/blog/dave/archive/2007/10/11/CreateCustomMembershipProviderASPNETWebsiteSecurity.aspx)

如果您想了解更多信息，请观看[此视频（附源代码）](http://www.asp.net/learn/videos/video-189.aspx)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-01T12:35:43.727

我已经扩展了 MembershipUser 并创建了我自己的 SqlMembershipProvider 版本来映射到我现有的域，并且它现在在生产中运行良好。

MembershipUser 本质上是我的 User 表的视图。我的扩展 MembershipUser 类包括配置文件/帐户样式的属性，而不是使用有点脆弱的默认 SqlProfileProvider 系统。

我无法使用现有的成员资格表或存储过程，但我自己编写了。例如，SqlMembershipProvider 使用 GUID 作为不透明键，但生产系统使用普通的旧 int。所有日期也是UTC等。

所有额外的用户功能都是通过用户域而不是通过成员资格方法访问的。

HTH。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-11-07T15:25:38.423

我目前正在阅读 CoDe Magazine 的[Microsoft ASP.NET 2.0 Membership API Extended](http://www.code-magazine.com/article.aspx?quickid=0703071&page=1)文章，该文章解释了如何通过围绕现有类编写包装器来扩展成员资格 API。主要好处是您可以保留所有开箱即用的功能，而不必像实现自定义提供程序时那样重写自己的功能。提供源代码。

# asp.net - ASP .NET：在 aspx 页面中使用多个 gridview 进行打印时分页

> ID：811138
> 
> 赞同：2
> 
> 时间：2009-05-01T12:17:31.820
> 
> 标签：asp.net, gridview, printing-web-page

这是问题：

我们在一个 aspx 页面中有一个包含许多网格视图的报告。但是，当我们打印它们时，它们的分页不正确，正如人们所期望的那样。

我找到了一个库，可以在单个分页符中正确创建分页符。但是，再一次，它不知道其他网格视图，因此如果最后一个网格视图在页面中间结束，则下一个网格视图的第一页将被破坏。

我们如何使用正确的打印分页打印这些多个网格视图？

我找到的库：http: [//www.codeproject.com/KB/custom-controls/GridViewPrinting.aspx](http://www.codeproject.com/KB/custom-controls/GridViewPrinting.aspx)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T20:01:08.373

如果您希望每个 GridView 在新页面上打印，您可以将每个 GridView 包装在一个 div 中，并将每个 div 的“page-break-after”css 属性设置为“always”。所以，它可能看起来像：

```
<div style="page-break-after:always;">
    <asp:GridView ID="GridView1" runat="server">
    ...
    </asp:GridView>
</div> 
```

省略最后一个 GridView 上的“page-break-after”属性，这样您就不会打印额外的页面。

# wcf - 出现故障后在 WCF 中重用客户端类

> ID：811142
> 
> 赞同：9
> 
> 时间：2009-05-01T12:17:54.923
> 
> 标签：wcf

我将 WCF 用于客户端服务器系统。当我在服务器上添加对 IService 的服务引用时，会生成一个代理类 ServiceClient。我的代码如下所示：

```
ServiceClient client = new ServiceClient();
try
{
    client.Operation1();
}
catch(Exception ex)
{
    // Handle Exception
}
try
{
    client.Operation2();
}
catch(Exception ex)
{
    // Handle Exception
} 
```

问题是如果第一次调用出现通信异常，客户端的状态会变成Faulted，不知道怎么重新打开才能进行第二次调用。有没有办法重新打开它？还是我应该创建一个新实例并替换实例（这似乎不是一种优雅的方式）？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-01T12:47:22.030

一旦 ICommunicationObject（您的 WCF 客户端对象）处于故障状态，“重新打开”它的唯一方法是创建一个新的。

```
ServiceClient client = new ServiceClient();
try
{
    client.Operation1();
}
catch(Exception ex)
{
    if (client.State == CommunicationState.Faulted)
    {
            client.Abort();
            client = new ServiceClient();
    }
}
try
{
    client.Operation2();
}
catch(Exception ex)
{
   // Handle Exception
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-01T12:52:32.423

如果在第一次调用时出现导致故障状态的通信异常，则基本上必须“重新创建”WCF 客户端代理。在您的示例中，我可能会执行以下操作：

```
if (client.State == CommunicationState.Faulted)
    client = new ServiceClient(); 
```

如果连接出现故障，这将允许您“重新打开”连接。这似乎有点矫枉过正，但如果您在客户端遇到通信异常，则可能还有其他事情发生（即：服务器死机？服务器没有响应？）

祝你好运

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-01T14:01:12.710

同意最后一个答案，一旦失败，你需要中止。我们使用 lambdas 和如下方法的组合来执行此操作：

```
 public static void Use<TServiceInterface>(TServiceInterface proxy, Action handler)
  {
     Type proxyType = typeof(TServiceInterface);
     IClientChannel channel = (IClientChannel)proxy;

     try
     {
        handler();

        _logSource.Log(LogLevel.Debug, string.Format("Closing client channel for '{0}' ...", proxyType.Name));

        channel.Close();

        _logSource.Log(LogLevel.Debug, string.Format("Client channel for '{0}' closed.", proxyType.Name));
     }
     catch
     {
        if (channel.State == CommunicationState.Faulted)
        {
           _logSource.Log(LogLevel.Debug, string.Format("Aborting client channel for '{0}' ...", proxyType.Name));

           channel.Abort();

           _logSource.Log(LogLevel.Debug, string.Format("Client channel for '{0}' aborted.", proxyType.Name));
        }
        else
        {
           _logSource.Log(LogLevel.Debug, string.Format("Closing client channel for '{0}' ...", proxyType.Name));

           channel.Close();

           _logSource.Log(LogLevel.Debug, string.Format("Client channel for '{0}' closed.", proxyType.Name));
        }

        throw;
     }
  } 
```

这是对 .net 上已有解决方案的轻微修改，但它非常适合处理代理。然后，您可以将多个服务调用放在同一个 lambda 表达式中，并将其传递给方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T12:38:47.700

这很可能是由服务器端未处理的异常引起的。默认情况下，WCF 运行时会终止您的服务实例并将通道置于故障状态以防出现未处理的异常并且您无法再通过该通道进行通信。因此，您将需要与该服务建立一个新会话。您应该在服务器端捕获异常并通过引发 FaultException 或定义 FaultContract 来发送肥皂故障。您还可以使用 returnUnknownExceptionsAsFaults 服务行为。

# php - 从 MySQL 读取单个记录的简单方法

> ID：811153
> 
> 赞同：57
> 
> 时间：2009-05-01T12:23:20.513
> 
> 标签：php, mysql

PHP 从 MySQL 数据库中读取单个记录的最佳方法是什么？例如：

```
SELECT id FROM games 
```

我试图在旧问题中找到答案，但没有运气。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2011-01-05T06:50:55.837

```
$id = mysql_result(mysql_query("SELECT id FROM games LIMIT 1"),0); 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-05-01T12:31:44.003

```
$link = mysql_connect('localhost','root','yourPassword')
mysql_select_db('database_name', $link);
$sql = 'SELECT id FROM games LIMIT 1';
$result = mysql_query($sql, $link) or die(mysql_error());
$row = mysql_fetch_assoc($result);
print_r($row); 
```

ChrisAD 回答中缺少一些东西。连接到 mysql 后，选择数据库至关重要，并且`die()`语句允许您查看发生的错误。

小心它只有在数据库中有 1 条记录时才有效，因为否则您需要添加`WHERE id=xx`或类似的东西才能**只**获得一行而不是更多。您也可以访问您的 id`$row['id']`

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-05-01T12:41:27.677

使用[PDO](http://php.net/pdo)，您可以执行以下操作：

```
$db = new PDO('mysql:host=hostname;dbname=dbname', 'username', 'password');

$stmt = $db->query('select id from games where ...');
$id = $stmt->fetchColumn(0);
if ($id !== false) {
    echo $id;
} 
```

您显然还应该检查`PDO::query()`执行查询是否正常（通过检查结果或告诉 PDO 引发异常）

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2012-09-17T23:42:02.973

假设您正在使用自动递增的主键，这是做事的正常方式，那么您可以访问您放入数据库的最后一行的键值：

```
$userID = mysqli_insert_id($link); 
```

否则，您必须了解有关您要查找的行的更多详细信息，例如电子邮件地址。在不知道您的表结构的情况下，我们无法更具体。

无论哪种方式，要限制您的`SELECT`查询，请使用`WHERE`如下语句：（通用示例）

```
$getID = mysqli_fetch_assoc(mysqli_query($link, "SELECT userID FROM users WHERE something = 'unique'"));
$userID = $getID['userID']; 
```

（具体例子）或者更具体的例子：

```
$getID = mysqli_fetch_assoc(mysqli_query($link, "SELECT userID FROM users WHERE userID = 1"));
$userID = $getID['userID']; 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-05-01T14:08:17.000

警告！您的 SQL 不是一个好主意，因为它将选择所有行（没有 WHERE 子句假定“WHERE 1”！）如果您有大量行，则会阻塞您的应用程序。（1在1时选择1,000行有什么意义？）因此，仅选择一行时，请确保指定限制子句：

```
$sql = "SELECT id FROM games LIMIT 1";  // Select ONLY one, instead of all
$result = $db->query($sql);
$row = $result->fetch_assoc();
echo 'Game ID: '.$row['id']; 
```

这种差异要求 MySQL*只*选择第一个匹配的记录，因此对表进行排序很重要，否则您应该使用 WHERE 子句。但是，与获取每条记录并输出第一行相比，查找一条记录所需的内存和时间要少得多。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2016-09-23T21:50:07.340

使用 LIMIT 1。它很容易。

```
$rows = $db->query("select id from games LIMIT 1");
$row  =  $rows->fetch_object();
echo $row->id; 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2016-04-04T06:35:31.240

面向对象风格的另一个答案。为我找到了这个解决方案：

```
$id = $dbh->query("SELECT id FROM mytable WHERE mycolumn = 'foo'")->fetch_object()->id; 
```

只返回一个 id。验证您的设计是否能确保您得到正确的设计。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-01T14:29:47.527

最简单的方法是使用[`mysql_result`](http://www.php.net/mysql_result). 我从其他答案中复制了下面的一些代码以节省时间。

```
$link = mysql_connect('localhost','root','yourPassword')
mysql_select_db('database',$link);
$sql = 'SELECT id FROM games'
$result = mysql_query($sql,$link);

$num_rows = mysql_num_rows($result);

// i is the row number and will be 0 through $num_rows-1
for ($i = 0; $i < $num_rows; $i++) {
    $value = mysql_result($result, i, 'id');
    echo 'Row ', i, ': ', $value, "\n";
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-01T12:26:03.737

首先你连接到你的数据库。然后构建查询字符串。然后启动查询并存储结果，最后使用其中一种 fetch 方法从结果中获取所需的行。

```
$link = mysql_connect('localhost','root','yourPassword')
mysql_select_db('database',$link);
$sql = 'SELECT id FROM games'
$result = mysql_query($sql,$link);

$singleRow = mysql_fetch_array($result) 
echo $singleRow; 
```

编辑：很抱歉，忘记了数据库连接。现在加了

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-01T12:37:18.980

除了使用 PHP 从数据库中检索单个记录的一些常用方法之外，“最佳方式”如下所示：

### 用 mysqli

```
$sql = "SELECT id, name, producer FROM games WHERE user_id = 1";
$result = $db->query($sql);
$row = $result->fetch_row(); 
```

### Zend 框架

//表类里面

```
$select = $this->select()->where('user_id = ?', 1);  
$row = $this->fetchRow($select); 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-05-01T20:51:35.690

我真的很喜欢[ezSQL 数据库库](http://www.woyano.com/view/213/Download-ezSQL-Database-Class-204)的理念，它将原生 SQL 方法封装在一个更易于使用的界面中。

从数据库中获取单个值很简单：

```
 $id = $db->get_var("SELECT id FROM games WHERE ..."); 
```

它还可以轻松获取单行、列或一组行。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-01-09T13:23:15.393

```
mysqli_report(MYSQLI_REPORT_ERROR | MYSQLI_REPORT_STRICT);
$db = new mysqli('localhost', 'tmp', 'tmp', 'your_db');  
$db->set_charset('utf8mb4');

if($row = $db->query("SELECT id FROM games LIMIT 1")->fetch_row()) { //NULL or array
    $id = $row[0];
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-08-15T15:41:55.187

我同意**mysql_result**是从 MySQL 结果集中检索一个单元格内容的简单方法。小代码：

```
$r = mysql_query('SELECT id FROM table') or die(mysql_error());
if (mysql_num_rows($r) > 0) {
    echo mysql_result($r); // will output first ID
    echo mysql_result($r, 1); // will ouput second ID
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-09-20T20:01:51.400

首先：**创建连接**

```
$conn =  new mysqli('localhost', 'User DB', 'Pass DB', 'Table name'); 
```

然后获取记录目标：

```
$query = "SELECT id FROM games LIMIT 1"; // for example query
$result = $conn->query($query); // run query
if($result->num_rows){ //if exist something
    $ret = $result->fetch_array(MYSQLI_ASSOC); //fetch data
}else{
    $ret = false;
}
var_dump($ret); 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-12-10T01:49:21.440

使用 PHP List 从 MySQL 数据库中获取单个记录的简单方法

SQL 查询是`SELECT user_name from user_table WHERE user_id = 6`

上述查询的 PHP 代码是

```
$sql_select = "";
$sql_select .= "SELECT ";
$sql_select .= "  user_name ";
$sql_select .= "FROM user_table ";
$sql_select .= "WHERE user_id = 6" ;

$rs_id = mysql_query($sql_select, $link) or die(mysql_error());
list($userName) = mysql_fetch_row($rs_id); 
```

> **注意**：列表概念应该适用于单行获取而不是多行

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-11-22T15:22:15.457

如果最后通过添加优化 SQL 会更好`LIMIT 1`：

`$query = "select id from games LIMIT 1";`

* * *

**所以答案是** *（适用于 php 5.6.3）*：

如果要获取第一行的第一项（即使它不是 ID 列）：

```
queryExec($query) -> fetch_array()[0]; 
```

如果您想获取第一行（来自数据库的单个项目）

```
queryExec($query) -> fetch_assoc(); 
```

如果你想从第一行得到一些确切的列

```
queryExec($query) -> fetch_assoc()['columnName']; 
```

或需要修复查询并使用第一种书面方式:)

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2013-04-30T00:00:12.077

假设您要计算现有表中的行数：

使用 mysql_result 仅将一个参数设置为“0”

像这样：

```
$string = mysql_result(
          mysql_query("SELECT COUNT(*) FROM database_name.table_name ")
,0); 
```

将 ( ` ) 放在 database_name 和 table_name 周围

```
var_dump($string);

// string(1) "5" //if it only has 5 records in the table 
```

注意：如果您查询其他内容，例如

```
SELECT * FROM database.table LIMIT 1 
```

并且该表有多个列，那么您将不会`array()`在您的 var_dump 中得到一个，您只会得到第一列

* * *

## 回答 #18

> 赞同：-2
> 
> 时间：2013-12-31T09:41:25.973

```
function getSingleRow($table, $where_clause="", $column=" * ",$debug=0) {
    $SelectQuery = createQuery($table, $where_clause, $column);

    $result = executeQuery($SelectQuery,$debug);
    while($row = mysql_fetch_array($result)) {
        $row_val = $row;
    }
    return $row_val;
} 
```

* * *

## 回答 #19

> 赞同：-2
> 
> 时间：2017-04-14T23:10:33.037

```
$results = $mysqli->query("SELECT product_code, product_name, product_desc, product_img_name, price FROM products WHERE id = 1"); 
```

* * *

## 回答 #20

> 赞同：-2
> 
> 时间：2017-07-10T17:43:20.807

我可以使用以下方法得到结果：

```
$resu = mysqli_fetch_assoc(mysqli_query($conn, "SELECT * FROM employees1 WHERE pkint =58"));
echo ( "<br />". $resu['pkint']). "<br />" . $resu['f1'] . "<br />" . $resu['f2']. "<br />" . $resu['f3']. "<br />" . $resu['f4' ]; 
```

* * *

employees 1 是表名。pkint 是主键 ID。f1,f2,f3,f4 是字段名称。$resu 是结果的变量快捷方式。以下是输出：

```
<br />58
<br />Caroline
<br />Smith
<br />Zandu Balm 
```

# google-app-engine - Google App Engine - 一个用于不同域和应用程序的数据存储

> ID：811166
> 
> 赞同：16
> 
> 时间：2009-05-01T12:32:11.957
> 
> 标签：google-app-engine

以某种方式可以访问一个数据存储吗？或者从不同的域访问一个应用程序。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2010-01-04T17:54:26.563

App Engine 最近添加了对称为模块的功能的支持*（文档：[go](https://developers.google.com/appengine/docs/go/modules/)、[python](https://developers.google.com/appengine/docs/python/modules/)、[java](https://developers.google.com/appengine/docs/java/modules/)）*

> App Engine 模块（或以下简称为“模块”）是一项功能，可让开发人员将大型应用程序分解为可以共享有状态服务并以安全方式进行通信的逻辑组件。处理客户请求的应用程序可能包含单独的模块来处理其他任务：
> 
> *   来自移动设备的 API 请求
> *   内部的，类似管理员的请求
> *   后端处理，例如计费管道和数据分析

当您创建新模块时，App Engine 将创建一个与模块名称对应的 url。如果您只有一个模块，则名称为`default`. 例如

*   http://**默认**.myapp.appspot.com
*   http://**移动前端**.myapp.appspot.com
*   http://**我的模块**.myapp.appspot.com

使用[Domain masking](https://developers.google.com/appengine/docs/python/modules/)，您可以直接从：

*   www.myapp.com => http://**默认**.myapp.appspot.com
*   www.myapp-mobile.com => http:// **mobile‑frontend** .myapp.appspot.com
*   www.example.com => http:// **my-module** .myapp.appspot.com

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-01T12:52:54.327

每个应用程序都有自己的数据存储和内存缓存（在该应用程序的所有版本之间共享）。现在似乎不可能在应用程序之间共享数据存储（除非您为此提供一些 Web 服务），但这将是一个不错的功能，所以也许您应该~~提交一个功能请求，让 Google~~ [投票支持它](http://code.google.com/p/googleappengine/issues/detail?id=1300)。

至于域，您可以将您的应用与[Google Apps 管理的域](http://code.google.com/intl/de/appengine/articles/domains.html)相关联。同一个应用程序的多个域应该没有问题（SSL 证书除外）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-01T13:13:52.247

应用程序的每个版本都由同一个数据存储支持。如果您想限制单个请求的访问，您需要在模型中添加一个字段以强制执行该限制。如果您想走那么远，那么数据存储 API 中有此类事情的低级挂钩。

是的，您可以将单个 App Engine 应用程序添加到多个域 - 即使在多个应用程序帐户中。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-09-30T10:25:22.843

Kyle 的解决方案会奏效，但 App Engine 从未设计为以这种方式使用。因此，如果您将应用程序构建为依赖于这种设置，而 Google 出于任何原因进行了限制，那么您将被搞砸。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-10-30T13:42:12.877

您可以使用[命名空间 Java API进行多租户](http://code.google.com/appengine/docs/java/multitenancy/)

# python - 如何在 Django 中手动分配图像字段

> ID：811167
> 
> 赞同：20
> 
> 时间：2009-05-01T12:32:16.870
> 
> 标签：python, django, django-models

我有一个具有 ImageField 的模型。如何手动为其分配图像文件？我希望它像任何其他上传的文件一样对待它......

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-01T13:13:40.390

请参阅[django.core.files.File的 django 文档](http://docs.djangoproject.com/en/dev/ref/files/file/#django.core.files.File.save)

其中 fd 是一个打开的文件对象：

```
model_instance.image_field.save('filename.jpeg', fd.read(), True) 
```

# .net - 移动紧凑型框架中的替代输入 - 按钮和设备键盘

> ID：811174
> 
> 赞同：1
> 
> 时间：2009-05-01T12:34:41.640
> 
> 标签：.net, vb.net, windows-mobile, compact-framework

好的，我有正在工作的代码（在此之后发布），但在我扩展它之前，我想把它扔在这里，看看可能有更好的方法来做我正在做的事情。

问题：SIP 面板很糟糕——有时我只需要在移动应用程序中输入数字或字母——我的大多数用户最终不是使用手写笔而是使用手指，所以我需要在屏幕上创建大按钮，每个按钮都有一个数字或填写他们当前正在处理的任何文本框的字母。它还需要同时接受来自设备键盘的输入。

我当前的代码：

代码顶部：

```
'setup a object to hold the current input box  
Public currentInputBox As TextBox  

'setup the user for input into a text box  
currentInputBox = LadingOrderQtyTextBox  
ladingOrderQtyTextbox.Focus()

'Routine to handle the numeric screen button '0'  
Private Sub Button4_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button4.Click  
    currentInputBox.Text = currentInputBox.Text & "0"  
    'Make sure to move to the end of the text...  
    currentInputBox.SelectionStart = currentInputBox.Text.Length  
    'give focus back  
    currentInputBox.Focus()  
End Sub 
```

这确实有效，但是它需要我手动跟上用户当前正在处理的文本框......也许没有办法解决这个问题？

无论如何，我很期待小组的想法......

另外......有没有更好的方法在这里发布代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T14:36:38.820

获得正确行为的最佳方法是[创建](http://blogs.msdn.com/windowsmobile/archive/2005/02/10/370355.aspx)具有您想要的功能的自定义 SIP。这将允许您喜欢任何“模式”，以及所需的按钮布局、大小等。

# language-agnostic - 将应届计算机毕业生引入程序员

> ID：811177
> 
> 赞同：2
> 
> 时间：2009-05-01T12:36:36.690
> 
> 标签：language-agnostic

应届毕业生在开始他的第一份编程工作时应该接受哪些关键的实践概念教育？您应该期望他/她多长时间才能高效并实际交付您期望的代码？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-01T12:45:09.977

源代码控制和测试

让他们首先检查代码并编写单元测试，了解它的内容，然后从那里开始。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-01T12:51:08.013

是的，这是一个主观问题。我们已经完成了几次暑期和校内实习，并聘请了 CS 领域的应届毕业生。

如果我们从一个知道的学生开始：

*   一种面向对象的语言（Java、C#、VB.NET、C++）
*   如何启动编译器/调试器
*   如何使用我们的源代码控制

然后给定一个具有先决条件的定义问题域（例如，对于最近的实习生，问题域是“使用自描述条形码将自动生成的注释元数据添加到 TIFF 文件”），因此学生需要知道

*   如何生成和解析 XMP
*   如何将元数据读/写到 TIFF（我们有相应的工具）
*   如何从条形码扫描仪读取
*   编写单元测试

我们在一周内看到了进展，在一个月内看到了演示代码。这一切都在意料之中。我主要让他自己工作，但介入并纠正了他的一些风格和编码实践。

其中重要的部分是如何设定和实现目标。我把重要的部分弄得很清楚（即需求），把不太重要的部分留给他设计。毕竟，谁愿意一直按数字画画呢？为了设定目标，我通常会尝试遵循 SMART 指南。一个好的目标是

*   具体的
*   可衡量的
*   可实现的
*   实际的
*   及时

项目有一个良好的沟通反馈循环非常重要。在这方面我们有些欠缺。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-01T13:05:19.040

不要假设任何事情。

我在没有源代码控制的情况下通过了大学。测试是使用调试器单步执行代码。任何任务都不需要文书工作。

这三件事对于生产级代码至关重要。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-01T12:56:26.563

只是我的想法和经历：

导师。指派一名高级或首席程序员来指导他们。不是每个人都适合这种任务，一个好的导师会有所作为。我们为每位新程序员分配了一名导师——无论他们编码多长时间——只是为了让新员工熟悉我们的系统。

从小处着手。根据您的组织/团队/等的配置方式，让新毕业生开始一些小型维护项目，导师审查他们的代码并指导他们。

让他们在您的商店工作的开发环境中接受培训——期望他们对几种语言有所了解，但他们的大部分开发经验将与学校项目有关——而不是完全可靠的生产代码。他们需要一个坚实的基础才能在您使用的环境中工作。

代码审查和最佳实践——给他们指导并确保他们遵守——如果你没有在内部使用最佳实践，那就开始吧。当涉及大型开发团队时，会产生巨大的差异。经常审查代码——这不必是一大群开发人员开会——一对一的审查、非正式的检查等都能创造奇迹。

开发合作环境 - 让开发人员交流和集思广益 - 让他们有机会讨论可能与手头代码无关的想法和想法 - 他们将相互依赖，而不是在立方体农场和生产中种植植物质量会更高。允许他们阅读与他们的手艺相关的博客和网站——比如这个、编码恐怖、黑客新闻等。支持他们去当地的用户组和开发者大会。

生产力？这取决于个人——一些新毕业生永远不会成为高效的程序员，但可能会成为高效的分析师或经理——有些人会成为一门外的代码机器，但会迅速产生 1000 行维护噩梦般的代码，而 20 行就足够了。我想说一个刚从学校毕业的程序员应该在 6 到 8 个月内变得富有成效——也就是说，与普通程序员一样，能够为你的产品开发一个新项目，设计和实现它，并且能够处理所需的任何维护任务。获得生产所需的经验需要时间——这些经验只能来自在生产环境中的实际开发。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-01T12:46:04.763

第一：如果您是应届毕业生或熟练的开发人员 - 您总能获得新的经验。因此，开发人员应该随时准备学习。

对于这个问题：如果您的开发团队实践测试驱动开发，首先应该向他展示如何编写测试以及它如何有用。

大一新生自然应该会使用版本控制，所以如果他没有版本控制方面的技能，应该对此做一个简短的介绍。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-01T13:32:02.330

以下是我发现对应届毕业生和有经验的新员工很重要的一些事情：

*   积极主动地将他们纳入企业文化，不要以为他们会自己适应
*   让他们参加会议，即使他们只是来听
*   鼓励他们在适当的时候在会议中互动
*   将他们的想法视为糟糕的想法时要小心我已经看到这会阻止人们在以后提及好想法

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-01T16:27:52.127

由于很少有学校需要或依赖源代码控制，因此我将首先使用源代码控制。真正坐下来解释如何使用您使用的产品以及为什么需要它。然后至少在第一个月，确保经常检查以确保他们正在使用它。

接下来是基本的数据库技能。我还没有看到任何人真正了解如何查询数据库。

第三是介绍你的数据库和代码库，解释事情是如何完成和组织的，以及为什么。

第四，测试程序和策略，包括如何进行代码审查、单元测试、QA 等。测试也不是大多数学生需要担心的事情。

第五，如果可能的话，指派一位导师，新人可以向某人寻求建议，询问有关公司基础的问题。您可能还需要有人向他们介绍职业行为的基本知识。在着装、出勤等方面可以接受什么。

# regex - 在 AssemblyInfo.vb 中更改 AssemblyVersion 的正则表达式

> ID：811184
> 
> 赞同：0
> 
> 时间：2009-05-01T12:41:20.640
> 
> 标签：regex, vb.net

我正在尝试从 AssemblyInfo.vb 文件中获取版本号，并将其替换为我选择的数字。

```
Dim text as string = string.empty
Using sr As New StreamReader("C:\foo\AssemblyInfo.vb")
    text = sr.ReadToEnd()
    Dim fileVerReg As New Regex("^[^']*(AssemblyVersion[(""].)([^""]*)")
    Dim m As Match = fileVerReg.Match(text)
    If m.Success Then
         MsgBox(m.Groups(2).Value)
    End If
 End Using 
```

这只是让我尝试获取版本，理想情况下我需要进行替换。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T12:53:53.840

尝试以下 VS 插件[Versioning Controlled Build](http://www.codeproject.com/KB/macros/versioningcontrolledbuild.aspx)，它比正则表达式好得多。我在我的开发机器和构建机器上都使用它（目前都是 VS 2008，但以前在 VS 2005 上使用过）。

# visual-sourcesafe - 在拇指驱动器上使用工作目录时如何安全使用 VSS？

> ID：811186
> 
> 赞同：0
> 
> 时间：2009-05-01T12:41:32.293
> 
> 标签：visual-sourcesafe, usb-flash-drive, visual-sourcesafe-2005

我知道将代码放入 VSS 通常与将钱放入 Bernard Madoff 经营的共同基金一样安全，但我没有放弃它进行颠覆的奢侈。

也就是说，我需要能够在两台机器上编写代码，我正在考虑将代码签出到闪存拇指驱动器。

有人提前知道我应该/不应该做什么来避免失去工作吗？我是否需要确保驱动器号保持不变？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T12:43:50.323

与您将其签出到机器内的已安装驱动器上应该没有什么不同。就操作系统而言，拇指驱动器就像您的硬盘一样，只是速度较慢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T12:51:30.397

我不知道你问的具体问题。我怀疑如果您在两台机器之间保持驱动器号一致会很好。我会质疑你是否真的需要从两台机器上访问 VSS。

但是，如果您担心可能会丢失工作，对我来说，在您完成计算机 A 的工作后检查您的更改会更有意义，这样您就可以检查计算机 B 上的文件，反之亦然反之亦然。否则，这意味着您将在拇指驱动器上进行未签入的更改，这些更改很容易在传输过程中丢失。

您应该为您的项目创建一个专用分支，这样您就可以签入部分完成的更改，而不会破坏其他任何人的构建。

# vim - 如何将 ^M 换行符转换为在 vim 中打开的文件中的“正常”换行符？

> ID：811193
> 
> 赞同：507
> 
> 时间：2009-05-01T12:44:09.590
> 
> 标签：vim, line-breaks

vim 显示在以 ^M 结尾的每一行

我如何用“正常”换行符替换它？

* * *

## 回答 #1

> 赞同：599
> 
> 时间：2009-05-01T12:48:40.217

# 命令

```
:%s/<Ctrl-V><Ctrl-M>/\r/g 
```

where`<Ctrl-V><Ctrl-M>`表示类型`Ctrl`+`V`然后`Ctrl`+ `M`。

# 解释

```
:%s 
```

替换，% = 所有行

```
<Ctrl-V><Ctrl-M> 
```

^M 字符（Ctrl-V 是 Vim 写 Ctrl ^ 字符的方式，Ctrl-M 在正则表达式后面写 M，产生 ^M 特殊字符）

```
/\r/ 
```

换行 ( `\r`)

```
g 
```

并在全球范围内进行（不仅仅是在线上的第一次出现）。

* * *

## 回答 #2

> 赞同：424
> 
> 时间：2009-05-01T12:47:21.890

在 Linux 和 Mac OS 上，以下工作，

```
:%s/^V^M/^V^M/g 
```

where`^V^M`表示类型`Ctrl`+ `V`，然后是`Ctrl`+ `M`。

[注意：在 Windows 上，您可能希望使用`^Q`而不是`^V`，因为默认情况下`^V`映射到粘贴文本。]

* * *

## 回答 #3

> 赞同：186
> 
> 时间：2009-05-01T12:57:04.253

在`vim`中，查看文件格式 — DOS 或 Unix：

~~`:set filetype=unix`~~

`:set fileformat=unix`

该文件将被写回，没有回车（CR，^M）字符。

* * *

## 回答 #4

> 赞同：149
> 
> 时间：2014-04-02T15:30:11.437

这是唯一对我有用的东西：

> :e ++ff=dos

在以下位置找到它：http: [//vim.wikia.com/wiki/File_format](http://vim.wikia.com/wiki/File_format)

* * *

## 回答 #5

> 赞同：120
> 
> 时间：2012-09-27T04:46:16.440

我在**MacVim**中看到的使用 BBEdit 创建的文件显示的是一堆`^M`换行符，而不是常规的换行符。以下字符串替换解决了这个问题 - 希望这会有所帮助：

```
:%s/\r/\r/g 
```

这很有趣，因为我用相同的字符替换换行符，但我想 Vim 只需要一个新的 \r 才能正确显示。我很想知道为什么这有效的潜在机制。

* * *

## 回答 #6

> 赞同：35
> 
> 时间：2012-03-07T04:01:20.707

首先，用于`:set ff?`确定您的文件的文件格式。

我想可能是这样`unix`，那么问题是您的文件是通过`fileformat=dos`将“^M^J”添加到行尾来创建的，但读取时`flieformat=unix`只从行尾删除了“^J”，而将“^M”留在那里。

只需`:e ++ff=dos`在 Vim 命令行中输入即可将文件格式从 unix 更改为 dos。它应该可以解决问题。如果没有，`:%s/\r//g`应该可以帮助你。

* * *

## 回答 #7

> 赞同：29
> 
> 时间：2011-04-25T19:36:57.733

为了让 ^M 字符匹配，我必须直观地选择它，然后使用操作系统复制到剪贴板命令来检索它。您可以通过在尝试替换命令之前搜索字符来测试它。

```
/^M 
```

应该选择第一条坏线

```
:%s/^M/\r/g 
```

将用回车替换所有错误的 ^M。

这是基于 gvim 7 的 MacVim 中的函数。

***编辑：***

在我的 Windows 10 机器上再次遇到这个问题，它有 Ubuntu for Windows，我认为这会导致 vim 的文件格式问题。在这种情况下，将 ff 更改为 unix、mac 或 dos 只是将 ^M 更改为 ^J 并再次返回。

这种情况下的解决方案：

```
:%s/\r$/ /g
:%s/ $//g 
```

我走这条路的原因是因为我想确保我的文件是非破坏性的。我本可以，`:%s/\r$//g`但那样会直接删除回车，并且可能会产生意想不到的结果。相反，我们将单个 CR 字符（此处为 ^M 字符）转换为空格，然后删除行尾的所有空格（无论如何，这对我来说都是一个理想的结果）

很抱歉恢复了一个早已被回答的老问题，但似乎有一些混乱正在发生，我想我会帮助解决其中的一些问题，因为这在谷歌搜索中排名很高。

* * *

## 回答 #8

> 赞同：22
> 
> 时间：2014-05-10T18:51:21.637

这些都不适合我，所以我尝试了这个，它有效：

类型`:%s/`

按`CTRL-V``CTRL-M`

类型`//g`

按`Enter`

所以 Vim 中的整体命令应该看起来像`:%s/^M//g`

这是做什么的：（`:%s`查找和替换）`/^M/`（那个符号）`/`（没有字符）`g`（全局）。

* * *

## 回答 #9

> 赞同：18
> 
> 时间：2009-05-01T12:47:02.717

^M 由`Ctrl`+`V`和检索`M`，所以这样做

```
s/^M//g 
```

* * *

## 回答 #10

> 赞同：16
> 
> 时间：2015-10-06T19:46:01.050

无需使用 Ctrl： `:%s/\r$//`

* * *

## 回答 #11

> 赞同：14
> 
> 时间：2014-11-07T07:30:16.000

对我有用的简单事情

```
dos2unix   filename 
```

* * *

## 回答 #12

> 赞同：14
> 
> 时间：2015-01-03T04:08:16.727

我用 sed 做到了这一点：

`sed -i -e 's/\r/\n/g' filename`

* * *

## 回答 #13

> 赞同：10
> 
> 时间：2014-07-11T12:47:32.050

怎么样： `:%s/\r//g` 这对我完全有用。

这样做只是为了清除所有行的行尾，它删除了 ^M 就是这样。

* * *

## 回答 #14

> 赞同：9
> 
> 时间：2017-04-22T15:04:25.437

这个问题还有很多其他的答案，但是，以下最适合我，因为我需要一个命令行解决方案：

```
vim -u NONE -c 'e ++ff=dos' -c 'w ++ff=unix' -c q myfile 
```

解释：

*   不加载任何 .vimrc 文件，打开`myfile`
*   运行`:e ++ff=dos`以强制重新加载整个文件作为 dos 行结尾。
*   运行`:w ++ff=unix`以使用 unix 行结尾写入文件
*   退出 vim

* * *

## 回答 #15

> 赞同：8
> 
> 时间：2017-04-04T15:55:11.897

`Ctrl`+`M`最小化我的窗口，但`Ctrl`+`Enter`实际上插入了一个`^M`字符。我还必须确保`Ctrl`在两次按下之间不要松开按键。

所以对我来说解决方案是：

```
:%s/<Ctrl-V><Ctrl-Enter>/\r/g 
```

where`<Ctrl-V><Ctrl-Enter>`表示**按住** `Ctrl`，按下并释放`V`，按下并释放`Enter`，**然后释放** `Ctrl`。

## 如果您正在处理 Windows 生成的文件

上述解决方案会在现有行之间添加一个额外的行，`\r`因为`^M`.

为防止这种情况，您希望删除`^M`字符而不替换它们。

```
:%s/<Ctrl-V><Ctrl-Enter>//g 
```

where`%`表示“在此缓冲区中”，`s`表示“替换”，`/`表示“（找到）以下模式，”`<Ctrl-V><Ctrl-Enter>`表示要按下以获取`^M`字符的键（见上文），`//`表示“没有任何内容”（或者，“使用模式在这两个斜杠之间，它是空的”），并且`g`是一个**标志**，意思是“全局”，而不是一行中的第一次出现。

* * *

## 回答 #16

> 赞同：7
> 
> 时间：2016-11-30T20:30:26.980

这对我有用：

1.  将文件格式设置为 unix（`\n`行尾）
2.  保存文件

所以在 vim 中：

```
:set ff=unix
:w 
```

* * *

## 回答 #17

> 赞同：7
> 
> 时间：2016-12-04T02:53:34.143

就我而言，

上面没有任何效果，我有一个 CSV 文件从我的 mac 复制到 Linux 机器，我使用了上述所有命令，但除了下面的命令之外没有任何帮助

```
tr "\015" "\n" < inputfile > outputfile 
```

我有一个文件，其中 ^M 字符被夹在行之间，如下所示

```
Audi,A4,35 TFSi Premium,,CAAUA4TP^MB01BNKT6TG,TRO_WBFB_500,Trico,CARS,Audi,A4,35 TFSi Premium,,CAAUA4TP^MB01BNKTG0A,TRO_WB_T500,Trico, 
```

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2009-05-01T13:10:59.447

或者，有一些名为 dos2unix 和 unix2dos 的开源实用程序可以执行此操作。在 linux 系统上，它们可能是默认安装的；对于 Windows 系统，您可以从[http://www.bastet.com/](http://www.bastet.com/)下载它们。

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2014-08-04T10:07:26.063

```
sed s/^M//g file1.txt > file2.txt 
```

其中 ^M 是通过同时按下 3 个键来键入的，`ctrl + v + m`

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2012-09-25T12:29:04.520

如果文件是在 windows 上创建的，则使用 dos2unix 实用程序，如果文件是在 mac 上创建的，则使用 mac2unix 实用程序。:)

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2015-06-10T10:45:49.653

使用以下命令之一：

```
:%s/\r//g 
```

或者

```
:%s/\r\(\n\)/\1/g 
```

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2013-12-06T09:18:44.970

为了**节省击键**，您可以通过将其放置在映射中来避免键入`Ctrl`++ 。只需打开一个包含 ^M 字符的文件，将其拉出，然后将其粘贴到 .vimrc 中这样的行中：`V``Ctrl``M`

```
nnoremap <Leader>d :%s/^M//g<CR> 
```

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2014-04-18T01:09:34.283

这对我有用：

```
:% s/\r\n/\r 
```

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2019-01-22T15:04:37.180

要`sed`在 MacOS 上使用，请执行以下操作：

```
sed -i.bak $'s/\r//' <filename> 
```

**说明：**这里的`$'STRING'`语法与 bash shell 相关。Mac 不`\r`视为特殊字符。通过引用命令字符串，`$''`您告诉 shell 替换为 ANSI-C 标准中指定`\r`的实际字符。`\r`

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2014-04-03T23:16:46.813

这些建议都没有对我有用，因为我在`^M`使用 vim 和 eclipse 时设法获得了大量的换行符。我怀疑我遇到了一个外部案例，但以防万一它对我做过的任何人有所帮助。

```
:%s/.$//g 
```

它解决了我的问题

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2015-04-30T05:42:40.017

```
:g/^M/s// /g 
```

如果你输入`^M`使用`Shift+6 Caps+M`它不会接受。

您需要输入`ctrl+v ctrl+m`.

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2016-07-20T11:03:07.320

`^M`给出不需要的换行符。为了解决这个问题，我们可以使用`sed`如下命令：

```
sed 's/\r//g' 
```

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2017-05-26T12:37:31.167

只需`set binary`在您的 .vimrc 中删除！

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2020-12-02T09:20:12.033

在 Solaris 上：

> :%s/<CTRL+V><CTRL+M>//g

那是：

> :%s/^M//g

这意味着：

*   % = 所有行，
*   s = 替代品，
*   ^M = 您想要替换的内容
*   // = 替换为空
*   g = 全局（不仅是第一次出现）

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2020-12-03T17:52:38.377

在 VIM 的命令模式下：

```
:e ++ff=dos | setl ff=unix | up 
```

`e ++ff=dos`- 强制以`dos`格式打开文件。

`setl ff=unix`- 将文件转换为`unix`格式。

`up`- 仅在修改后保存文件。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2011-04-25T23:06:30.440

" 这个函数保存了跳转列表

```
fun! Dos2unixFunction()
let _s=@/
let l = line(".")
let c = col(".")
try
    set ff=unix
    w!
    "%s/\%x0d$//e
catch /E32:/
    echo "Sorry, the file is not saved."
endtry
let @/=_s
call cursor(l, c)
endfun
com! Dos2Unix keepjumps call Dos2unixFunction() 
```

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2013-01-21T16:28:24.217

我花了一个下午的时间与 \n ctrl-v 012 （两者都为我提供null）苦苦挣扎。一直在这个线程中工作，直到我到达 metagrapher 的位置。

`\r`对我来说很好！

```
/),/s/),/)\r/g 
```

变成了这样：

> 黑名单额外：i386 (0.4.1, 0.4.1+nmu1), libmount1:i386 (2.20.1-5.1, 2.20.1 -5.2), libblkid1:i386 (2.20.1-5.1, 2.20.1-5.2) , libapt-pkg4.12:i386 (0.9.7.4, 0.9.7.5), nmap:i386 (6.00-0.1, 6.00-0.2), libsane-common:i386 (1.0.22-7.3,

变成这样的东西：

> 26 libwv-1.2-4:i386 (1.2.9-3, 自动)
> 27 openjdk-6-jre-headless:i386 (6b24-1.11.4-3, 自动)
> 28 jed:i386 (0.99.19-2.1)

魔法。我非常感激

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2013-03-17T16:39:39.850

或者，您可以使用此命令修复换行符，而不是使用 vim

```
fromdos <filename.txt> 
```

希望能帮助到你！

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2014-07-28T15:59:05.923

以上都不适合我。（替换 \r, ^M, ctrl-v-ctrl-m ）我使用复制和粘贴将我的文本粘贴到一个新文件中。

如果您有干扰的宏，您可以`:set paste`在粘贴操作之前和`:set nopaste`之后尝试。

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2015-08-14T00:54:03.753

在 vim 中，使用命令：

> :%s/\r\n/\r/g

您要搜索和替换的位置：

> \r\n

进入

> \r

和

> /G

适用于全球

请注意，这与@ContextSwitch 的答案相同，但带有 gobal 标志

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2016-11-16T12:37:56.660

在串行控制台上，所有 vi 和 sed 解决方案都不适合我。我不得不：

```
cat inputfilename | tr -d '\r' > outputfilename 
```

* * *

## 回答 #37

> 赞同：-1
> 
> 时间：2017-01-17T12:45:20.800

在 Windows 中时，请尝试`:%s/<C-Q><C-M>/g`

# javascript - 小字符串的快速开源校验和

> ID：811195
> 
> 赞同：25
> 
> 时间：2009-05-01T12:44:51.897
> 
> 标签：javascript, string, base64, checksum, base32

对于小字符串（20-500 个字符），我需要一个快速校验和（尽可能快）。

我需要源代码，而且一定很小！（最大约 100 LOC）

如果它可以在 Base32/64 中生成字符串。（或类似的东西）这将是完美的。基本上校验和不能使用任何“坏”字符..你知道..通常的 (){}[].,;:/+-\| ETC

*澄清*

它可能是强/弱，这并不重要，因为它仅用于幕后目的。

它不需要包含原始字符串的所有数据，因为我只会与生成的校验和进行比较，我不希望有任何类型的“解密”。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2010-07-18T18:33:11.733

schnaader的实现确实很快。这是在Javascript中：

```
function checksum(s)
{
  var chk = 0x12345678;
  var len = s.length;
  for (var i = 0; i < len; i++) {
      chk += (s.charCodeAt(i) * (i + 1));
  }

  return (chk & 0xffffffff).toString(16);
} 
```

使用谷歌浏览器，这个函数只需要 5 毫秒来运行 1 兆字节的字符串，而使用 crc32 函数则需要 330 毫秒。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-01T13:08:52.510

用 C 语言快速实现，我这边没有版权，所以你可以随意使用它。但是请注意，这是一个非常弱的“校验和”，所以不要将它用于严肃的事情:) - 但这就是你想要的，不是吗？

这将返回一个 32 位整数校验和，编码为包含其十六进制值的字符串。如果校验和功能不能满足您的需求，您可以将`chk += ((int)(str[i]) * (i + 1));`行更改为更好的（fe 乘法、加法和按位旋转会更好）。

编辑：按照hughdbrown的建议和[他链接的答案之一](https://stackoverflow.com/questions/3388029/strlen-function/3388126#3388126)，我更改了`for`循环，因此它不会`strlen`在每次迭代时调用。

```
#include <stdio.h>
#include <stdlib.h>
#include <string>

char* hextab = "0123456789ABCDEF";

char* encode_int(int i) {
  char* c = (char*)malloc(sizeof(char) * 9);

  for (int j = 0; j < 4; j++) {
    c[(j << 1)] = hextab[((i % 256) >> 4)];
    c[(j << 1) + 1] = hextab[((i % 256) % 16)];

    i = (i >> 8);
  }
  c[8] = 0;

  return c;
}

int checksum(char* str) {
  int i;
  int chk = 0x12345678;

  for (i = 0; str[i] != '\0'; i++) {
    chk += ((int)(str[i]) * (i + 1));
  }

  return chk;
}

int main() {
  char* str1 = "Teststring";
  char* str2 = "Teststring2";

  printf("string: %s, checksum string: %s\n", str1, encode_int(checksum(str1)));
  printf("string: %s, checksum string: %s\n", str2, encode_int(checksum(str2)));

  return 0;
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-01T13:18:20.723

这是 CRC32 的 Javascript 实现：

```
function crc32 ( str ) {
    // http://kevin.vanzonneveld.net
    // +   original by: Webtoolkit.info (http://www.webtoolkit.info/)
    // +   improved by: T0bsn
    // -    depends on: utf8_encode
    // *     example 1: crc32('Kevin van Zonneveld');
    // *     returns 1: 1249991249

    str = utf8_encode(str);
    var table = "00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D";

    var crc = 0;
    var x = 0;
    var y = 0;

    crc = crc ^ (-1);
    for( var i = 0, iTop = str.length; i < iTop; i++ ) {
        y = ( crc ^ str.charCodeAt( i ) ) & 0xFF;
        x = "0x" + table.substr( y * 9, 8 );
        crc = ( crc >>> 8 ) ^ x;
    }

    return crc ^ (-1);
} 
```

在[kevin.vanzonneveld.net上找到](http://kevin.vanzonneveld.net/techblog/article/javascript_equivalent_for_phps_crc32/)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-01T13:06:38.053

几乎任何你能想出的算法都能满足你的标准。例如

```
CHECKSUM = SUM( i=0 .. input.length, input[i] ) 
```

使其“坏字符安全”

```
CHECKSUM = 'A' + SUM( i=0 .. input.length, input[i] ) MODULO 26 
```

试图通过增加输出域来减少冲突次数的尝试

```
# Assume BASE64[ ] is the safe output alphabet array.
TMP = SUM( i=0 .. input.length, input[i] ) MODULO 2^24
FOR I = 0..3
    CHECKSUM[I] = BASE64[TMP MODULO 64]
    TMP = TMP / 64 
```

通过计算不同排列的不同值来进一步减少碰撞次数的解决方案

```
# Assume BASE64[ ] is the safe output alphabet array.
TMP = SUM( i=0 .. input.length, i*input[i] ) MODULO 2^24
FOR I = 0..3
    CHECKSUM[I] = BASE64[TMP MODULO 64]
    TMP = TMP / 64 
```

一般来说，如果输入足够随机且足够稀疏（当然，“足够”在每种情况下有所不同），所有这些变化都会表现得很好

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-01T13:05:33.767

它是 207 行，但它是 md5 的 javascript 实现：

[http://www.webtoolkit.info/javascript-md5.html](http://www.webtoolkit.info/javascript-md5.html)

将其与 javascript base64 结合起来：

[http://www.webtoolkit.info/javascript-base64.html](http://www.webtoolkit.info/javascript-base64.html)

这些脚本是完全独立的，因此它们有一些冗余（例如 UTF-8 编码/解码），可以很容易地使它们通用。

**编辑：**在同一个站点上，您可以找到一个 javascript crc32：

[http://www.webtoolkit.info/javascript-crc32.html](http://www.webtoolkit.info/javascript-crc32.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-01T12:51:54.360

只使用 javascript 你可以使用这个 crc 函数：[http ://www.webtoolkit.info/javascript-crc32.html](http://www.webtoolkit.info/javascript-crc32.html)

```
/**
*
*  Javascript crc32
*  http://www.webtoolkit.info/
*
**/

function crc32 (str) {

    function Utf8Encode(string) {
        string = string.replace(/\r\n/g,"\n");
        var utftext = "";

        for (var n = 0; n < string.length; n++) {

            var c = string.charCodeAt(n);

            if (c < 128) {
                utftext += String.fromCharCode(c);
            }
            else if((c > 127) && (c < 2048)) {
                utftext += String.fromCharCode((c >> 6) | 192);
                utftext += String.fromCharCode((c & 63) | 128);
            }
            else {
                utftext += String.fromCharCode((c >> 12) | 224);
                utftext += String.fromCharCode(((c >> 6) & 63) | 128);
                utftext += String.fromCharCode((c & 63) | 128);
            }

        }

        return utftext;
    };

    str = Utf8Encode(str);

    var table = "00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D";

    if (typeof(crc) == "undefined") { crc = 0; }
    var x = 0;
    var y = 0;

    crc = crc ^ (-1);
    for( var i = 0, iTop = str.length; i < iTop; i++ ) {
        y = ( crc ^ str.charCodeAt( i ) ) & 0xFF;
        x = "0x" + table.substr( y * 9, 8 );
        crc = ( crc >>> 8 ) ^ x;
    }

    return crc ^ (-1);

}; 
```

在 php 中，您可以使用带有 md5 哈希的一行来完成，在长度为 20 - 500 的字符串上，它应该非常快

```
$hash_code = md5($string_to_hash); 
```

这里有更多信息：[http ://us.php.net/md5](http://us.php.net/md5)

另外，如果你想选择你的哈希算法，你可以使用 hash php 函数：[http ://us.php.net/manual/en/function.hash.php](http://us.php.net/manual/en/function.hash.php)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-01T12:57:59.463

您正在寻找的是一种为字符串创建哈希码的算法。在 C# 中：

```
byte[] bytesToHash = Encoding.UTF8.GetBytes(stringToHash);
HashAlgorithm sha = new SHA1CryptoServiceProvider();
byte[] hash = sha.ComputeHash(dataArray);
string result = Convert.ToBase64String(hash); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-01T13:10:17.013

md5sum、sha1sum、sha224sum、sha256sum、sha384sum、sha512sum 可用于大多数 *nix 发行版

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-09-16T16:26:34.873

这似乎有点晚了，并且部分偏离了主题......我在基于 JS 和 PHP 的应用程序中使用了 joelpt的[schnaader 解决方案](https://stackoverflow.com/a/811277/336311)[的 JS 实现。](https://stackoverflow.com/a/3276730/336311)而且，我认为 PHP 实现也可能对其他人有所帮助。

```
function checksum($s) {
    $chk = 0x12345678;
    $len = mb_strlen($s);
    for ($i = 0; $i < $len; $i++) {
        $chk += (mb_ord(mb_substr($s, $i, 1)) * ($i + 1));
    }
    return dechex($chk & 0xffffffff);
}

if (!function_exists('mb_ord')) {
    // Shim from https://stackoverflow.com/a/1365610/336311
    function mb_ord($string) {
        mb_internal_encoding('UTF-8');
        // mb_language('Neutral');
        // mb_detect_order(['UTF-8', 'ISO-8859-15', 'ISO-8859-1', 'ASCII']);

        $result = unpack('N', mb_convert_encoding($string, 'UCS-4BE', 'UTF-8'));

        if (is_array($result)) {
            return $result[1];
        }
        return ord($string);
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-08-26T13:00:27.207

在现代（非 IE）浏览器中工作，必须在 HTTPS 上：

[https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/digest](https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/digest)

```
const text = `Lorem ipsum dolor sit amet, consectetur adipiscing elit. In nec elit a justo rhoncus blandit. Aenean commodo sem in mattis fermentum. Phasellus pellentesque tortor lectus, a sodales quam cursus in. Aliquam lorem velit, faucibus id nisi sed, tristique tempor odio. Donec sit amet neque non nunc dictum gravida. Vestibulum in suscipit urna, ac porttitor enim. Integer ultrices feugiat justo vel gravida. Cras viverra laoreet lobortis. Mauris non pharetra purus. Aenean sed elementum justo. Vivamus libero enim, consequat eu convallis in, lacinia ut mi. Curabitur eget diam id augue tincidunt tempus ac eu nisi. Sed dui leo, rhoncus vel egestas non, tempor a magna.

Donec congue vehicula nunc sed vestibulum. Interdum et malesuada fames ac ante ipsum primis in faucibus. Donec sodales scelerisque ullamcorper. Sed iaculis aliquet consectetur. Donec vel purus sodales, interdum velit eget, ultricies arcu. Nullam eu lorem vel sem aliquam congue eu ut felis. Praesent auctor vitae massa venenatis bibendum. Morbi a aliquet enim. Mauris ac nisi lacus. Etiam nec sollicitudin nibh. Sed maximus tortor eget lectus maximus, quis ultrices justo faucibus. Suspendisse potenti. Fusce id consequat mi.

Donec cursus, orci vel malesuada porttitor, nisi orci volutpat ipsum, eget pretium nisl est a lorem. Curabitur et egestas tortor, vel mattis tellus. Suspendisse eget nunc varius, pharetra velit sit amet, viverra est. Pellentesque a vehicula risus, eu tincidunt justo. Sed nec ligula a eros sagittis rhoncus. Vestibulum a nulla erat. Nulla facilisi. Aenean elit diam, scelerisque quis sollicitudin non, feugiat a lorem.

Aliquam lacinia mi diam, ut aliquet libero placerat at. Pellentesque sit amet neque varius, pharetra nunc ac, egestas justo. Fusce at dapibus felis, et imperdiet felis. Nullam fringilla mi ut lorem imperdiet cursus. Morbi venenatis, justo vel efficitur euismod, dui lacus tincidunt neque, vel vestibulum velit lectus et velit. Sed non dolor libero. Vivamus nec ligula a nisl eleifend sollicitudin at id nisl. Sed in vestibulum nisi, sed vestibulum nunc. Donec volutpat eu nisi nec venenatis.

Sed rhoncus ut nisl a tristique. Integer lacus massa, congue fringilla mollis in, pretium vitae lorem. Vivamus porttitor quam nisl, vitae suscipit ante egestas at. Ut sed enim vel ante congue euismod sit amet a elit. Phasellus sed placerat nunc. Aenean turpis tortor, convallis eget leo a, fringilla fringilla nisi. Maecenas euismod sapien ut massa ultricies interdum. Donec suscipit dolor dolor.`;

async function digestMessage(message) {
  // encode as (utf-8) Uint8Array
  const msgUint8 = new TextEncoder().encode(message);
  // hash the message
  const hashBuffer = await crypto.subtle.digest('SHA-256', msgUint8);
  // convert buffer to byte array
  const hashArray = Array.from(new Uint8Array(hashBuffer));
  // convert bytes to hex string
  const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
  return hashHex;
}

const digestBuffer = digestMessage(text)
  .then(digestBuffer => console.log(digestBuffer));
```

以上大约需要4.5ms，一个短句和这个长句没有区别。没有尝试很长的字符串。

# assertions - 在 4GL 中实现断言

> ID：811198
> 
> 赞同：3
> 
> 时间：2009-05-01T12:45:08.777
> 
> 标签：assertions, progress-4gl, webspeed

使用 Progress 4GL 或 WebSpeed实现[断言](http://en.wikipedia.org/wiki/Assertion_(computing))的最佳方式是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T10:22:09.457

经过一番考虑，这里是我对问题的解决方案。它的工作基于以下假设：开发环境 propath 不同于测试和生产环境，并且始终重新编译代码以供测试或生产使用：

```
&IF PROPATH MATCHES '*development*' &THEN 
&SCOPED-DEFINE ASSERTION   {1} {2} {3} {4} {5} {6} {7} {8} {9} {10} ~
{11} {12} {13} {14} {15} {16} {17} {18} {19} {20} ~
{21} {22} {23} {24} {25} {26} {27} {28} {29} {30} ~
{31} {32} {33} {34} {35} {36} {37} {38} {39} {40} ~
{41} {42} {43} {44} {45} {46} {47} {48} {49} {50} ~
{51} {52} {53} {54} {55} {56} {57} {58} {59} {60} ~
{61} {62} {63} {64} {65} {66} {67} {68} {69} {70} ~
{71} {72} {73} {74} {75} {76} {77} {78} {79} {80} 

 IF NOT ({&ASSERTION}) THEN 
     MESSAGE "Failed assertion {&ASSERTION} in" PROGRAM-NAME(1).

 IF ({&ASSERTION}) = ? THEN 
     MESSAGE "Unknown value as a result of assertion {&ASSERTION} in" 
              PROGRAM-NAME(1).

&ENDIF 
```

该代码旨在避免任何副作用，并且在任何执行环境（GUI 或 ChUI、WebSpeed、AppServer、批处理等）中都能很好地工作。

1) 将代码保存为名为“assert”的文件（不带任何扩展名）。

2) 将文件放入PROPATH 指向的目录中。

3) 样品用法：

```
{assert valid-handle(hProc)}
{assert i > 0 and i <= 100}
{assert cExtra begins ‘opt’}  /* note the single quotes */
{assert dtEnd > = dtStart} 
```

作为一种变体，可以通过在测试和生产环境中只有一个空的包含文件来完全避免依赖 propath，开发版本将变为：

```
&SCOPED-DEFINE ASSERTION   {1} {2} {3} {4} {5} {6} {7} {8} {9} {10} ~
{11} {12} {13} {14} {15} {16} {17} {18} {19} {20} ~
{21} {22} {23} {24} {25} {26} {27} {28} {29} {30} ~
{31} {32} {33} {34} {35} {36} {37} {38} {39} {40} ~
{41} {42} {43} {44} {45} {46} {47} {48} {49} {50} ~
{51} {52} {53} {54} {55} {56} {57} {58} {59} {60} ~
{61} {62} {63} {64} {65} {66} {67} {68} {69} {70} ~
{71} {72} {73} {74} {75} {76} {77} {78} {79} {80} 

 IF NOT ({&ASSERTION}) THEN 
     MESSAGE "Failed assertion {&ASSERTION} in" PROGRAM-NAME(1).

 IF ({&ASSERTION}) = ? THEN 
     MESSAGE "Unknown value as a result of assertion {&ASSERTION} in" 
              PROGRAM-NAME(1). 
```

一个额外的提示是向您选择的编辑器添加一个自动文本宏，该宏将自动扩展为 {assert }。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-05T14:27:18.903

由于 Progress 没有对断言的本地处理，但我想出的最好的方法是：

```
IF NOT <assertion> THEN
RUN assertionFailed.p. 
```

assertionFailed.p 可以给程序员发电子邮件，或者记录条件并优雅地退出。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T17:23:04.643

鉴于断言通常从最终代码中省略，我建议使用预处理器路线。您可能会执行以下操作，将其设置为两个包含文件。当您将其编译到生产环境时，请确保 debugalert.i 为空。assert.i 可以被编辑来做任何你喜欢的消息，停止，电子邮件等......

要设置断言，您只需遵循格式 {assert.i &condition=}

* * *

/* assert.i */ {debugalert.i}

&IF 定义（调试） <> 0 &THEN

如果不是 {&CONDITION} 则执行：

```
MESSAGE THIS-PROCEDURE:FILENAME "ERROR...{&CONDITION}" 
    VIEW-AS ALERT-BOX.
/* add code to email message etc.. or stop */ 
```

结尾。

＆万一

* * *

/* debugalert.i 在测试或开发环境中关闭断言删除此语句 */

全局定义调试器(&G)

* * *

/* 在您的测试代码中，您只需执行以下操作：*//*测试断言 */

DEF VAR h_ct AS INT NO-UNDO INIT 10。

{assert.i &CONDITION="h_ct = 8"}

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-09-27T13:44:14.400

OpenEdge 11.6 将单元测试引入了 ABL 世界。它松散地基于 JUnit 原则。因此，断言现在是包的一部分。更多信息在文档中：[https ://documentation.progress.com/output/ua/OpenEdge_latest/index.html#page/pdsoe/overview-of-ablunit-testing-framework.html](https://documentation.progress.com/output/ua/OpenEdge_latest/index.html#page/pdsoe/overview-of-ablunit-testing-framework.html)

# asp.net - 如何查询强类型数据表

> ID：811210
> 
> 赞同：1
> 
> 时间：2009-05-01T12:47:52.497
> 
> 标签：asp.net, datatable, dataset, strong-typing

我有一个新闻门户。

对于这个门户，我有一个带有“新闻”表和以下列（NewsID、CategoryID、NewsTitle、NewsText、DateAdded、ImagePath、TotalRead、NewsType、isActive）的数据库

我使用数据集文件 (.xsd)，对于这个，我有一个查询，它将最近 3 天的新闻返回到我编码的自定义类中，名为 HHNews。

HHNews 类有一个函数，它返回一个强类型数据表，其中包括我上面提到的查询的结果。

主页有不同的新闻部分。这些是；- 标题（5 项） - 子标题（4 项） - 每个新闻类别的最后 5 条新闻……（类别如：体育、地方新闻、经济、

对于主页，我检索从类返回的数据表。现在我想查询这个数据表并构建我上面提到的部分.. 例如

如果我的数据表被称为“dt”，那么有没有办法像 sql 一样查询这个 dt，例如“select TOP(5) NewsID, NewsTitle, NewsText from dt where NewsType = 0” *- 0 代表标题？*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T12:50:23.520

如果您使用的是 .NET 3.5，则可以使用[LINQ to DataSet 。](http://msdn.microsoft.com/en-us/vbasic/bb688086.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T12:58:08.587

如果您不在 .NET 3.5 中，则可以基于 DataTable 对象创建一个 DataView，然后在 DataView 上设置 RowFilter 属性。例如：

```
DataView myDV = new DataView(dt);
myDV.RowFilter = "NewsType = 0"; 
```

然后，您只能捕获 DataView 中的前 5 行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T12:58:42.270

绝对地。您可以像 Dave Cluderay 提到的那样[使用 LINQ 。](http://msdn.microsoft.com/en-us/vbasic/bb688086.aspx)例如，要检索您的标题，您可以运行：

```
var myDataTable = dt.AsEnumerable();
var headlines = myDataTable.Where(t => t.NewsID == 0).Take(5); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T12:54:49.703

您可以使用默认视图来过滤数据表，如下所示：

dt.DefaultView.RowFilter = "NewsType = 0";

不知道如何获得前 5 名！？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T13:17:06.717

如果您不在 3.5 中，则可以在对表格进行排序后使用简单的 for 循环来获取前 5 行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T13:24:50.083

Datatable上有一个Select方法，不要以为有办法限制返回的数量。我喜欢 LINQ 方式，但只是另一种选择....但限制可能会忽略这一点。

```
dt.Select("NewsType = 0"); 
```

# php - Html 表单提交 - 未发送 ajax 生成的下拉值

> ID：811211
> 
> 赞同：1
> 
> 时间：2009-05-01T12:48:21.513
> 
> 标签：php, html, ajax

我有一个嵌入在 html/smarty 模板代码中的表单。在表单内有一个下拉框，其中包含从 db 填充的选项。如果您更改选项，它会使用 ajax 通过 onChange 事件调用 php 脚本，该 ajax 会创建/填充 2 个进一步的下拉菜单。这部分工作正常，但是如果您提交整个表单（涉及原始下拉列表和 2 个进一步动态创建的下拉列表），则在 2 个动态创建的下拉列表的情况下，键值对根本不会发送到浏览器，尽管它们在里面标签也是如此。换句话说，它只发送包含模板本身的值，而不是通过 ajax 生成到“txtHint1”中的值。

谢谢

html/模板形式：

```
<table border="0" width="600">
<tr>
<form name='form1' id='form1' method='get' action=''>
<td width="80"><h4><b>Source 1:</b></h4></td>
<td>
<select name='host_selection' onChange="showDatet(this.value,'txtHint1')">
{foreach from=$hostlist item="entry"}
<option value={$entry.host}>{$entry.host}</option>
{/foreach}
</select>
</td>
<td>
<div id="txtHint1">
</div>
</td>
</tr>
<tr>
<td>
<button type='submit' name='Submit'>COMPARE!</button>
</td>
<td>
<input type='hidden' name='op' value='hid' />
</td>
</form>
</tr>
</table> 
```

通过 ajax 调用的 php 代码的一部分：

```
echo "<select name='datet_selection" . $fieldID . "'>Test</option>";
foreach ($x->sql->record as $temp) {
    echo "<option value='" . $temp['datet'] . "'>" . $temp['datet'] . "</option>";
}
echo "</select>"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T13:04:14.657

这可能无法解决整个问题，但您动态呈现的下拉菜单似乎格式不正确。改变：

```
echo "<select name='datet_selection" . $fieldID . "'>Test</option>"; 
```

至

```
echo "<select name='datet_selection" . $fieldID . "'><option>Test</option>"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T16:49:53.600

我认为你还需要一个......所以你会想要：

```
echo "<select name='datet_selection" . $fieldID . "'><option>Test</option></select>"; 
```

# debugging - 使用 Progress 4GL 防止调试代码投入生产？

> ID：811213
> 
> 赞同：1
> 
> 时间：2009-05-01T12:48:52.527
> 
> 标签：debugging, progress-4gl, webspeed

使用 Progress 4GL 时，如何防止大量调试代码意外泄漏到生产环境中？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-12T11:38:40.710

我通常只是发布一个特殊事件——调试消息。在我的开发环境中，应用程序中有一个菜单项，它将启动一个窗口，该窗口可以在任何地方订阅调试消息并显示任何生成的消息。所以我可以在我的代码中插入调试消息，然后如果我想查看这些消息就打开窗口。如果我忘记整理调试代码，那么实时用户将看不到任何消息，尽管我仍然可以打开调试窗口来查看发生了什么。

（这个的 webspeed 版本只会将输出写入 OS 文件）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-05T14:11:23.853

如果您的测试数据库和生产数据库具有不同的名称，您可以使用以下代码：

```
IF DBNNAME = "TESTDB" THEN
DO:
  <DEBUG CODE>
END. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T02:38:34.683

与我关于断言的其他答案类似，您可以设置一个包含在包含调试标志的生产站点上将为空的包含。在开发站点上，您只需要定义值，以便您的调试代码包含在您的程序中。

通过将代码包装在预处理器中，当您将其编译到生产站点上时，编译器将完全省略调试代码。

&if 定义（调试）<> 0 &then
`&endif`

 `You would then use the "&global-define debug" in versions of the code you want to contain the debug code. Not defining "debug" should cause the compiler to omit the code.

* * *

/* debug.i omit the following on production */

&GLOBAL-DEFINE DEBUGALERT

* * *

/* test.p */ {debug.i}

DEF VAR h_ct AS INT NO-UNDO

DO h_ct = 1 TO 10:

&IF DEFINED( DEBUGALERT ) <> 0 &THEN` 

```
 MESSAGE "debug message" h_ct.
    <debug code goes here> 
```

＆万一

结尾。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-07T13:58:44.163

解决方案基于以下假设：开发环境具有唯一的 propath 条目，在其他环境中不可用，并且在移动时重新编译代码：

```
&IF DEFINED(DEBUGGING) = 0 &THEN
    &IF PROPATH MATCHES '*development*' &THEN 
        &GLOBAL-DEFINE DEBUGGING TRUE
    &ELSE
        &GLOBAL-DEFINE DEBUGGING FALSE
        &MESSAGE Remove debugging: search for DEBUG within the code. 
    &ENDIF        
&ENDIF                                

&IF DEFINED(DEBUGGING_STARTED) = 0 &THEN
    &GLOBAL-DEFINE DEBUGGING_STARTED TRUE
    IF {&DEBUGGING} THEN
    DO:
&ELSE
    END.
    &UNDEFINE DEBUGGING_STARTED
&ENDIF 
```

**用法**

将文件作为“调试”（不带扩展名）保存到 propath 指向的目录，然后：

```
{debug}

 /* some debugging code here */

{debug/} 
```

# c# - 由于 WPF 应用程序中的显示属性而处理不同的字体大小？

> ID：811217
> 
> 赞同：1
> 
> 时间：2009-05-01T12:51:20.553
> 
> 标签：c#, wpf, fonts

我的小组正在 WPF 中构建一个编辑器类型的应用程序。我们注意到的一件事是，在我的 WinXP 机器上，以“windows 经典风格”主题运行，按钮上的文本非常合适。然而，在我朋友的机器上，他使用“windows xp 风格”主题运行，字体更大，所以按钮上的文本在底部被剪裁。

有没有办法很好地处理这个问题，比如自动调整控件大小以适应文本？

我犹豫要手动调整按钮的大小以适应他的布局，因为其他任何人都可以通过显示属性和辅助功能选项进行完全不同的设置。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T13:24:27.293

WPF 按钮*将*自动调整大小以适应给定的内容，但是它只会在它位于不强制大小的容器内并且其大小尚未手动设置时才会这样做。为了证明这与以下代码片段中的字体大小有关：

```
<Grid>
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*"/>
        <ColumnDefinition Width="Auto"/>
        <ColumnDefinition Width="*"/>
    </Grid.ColumnDefinitions>
    <Grid.RowDefinitions>
        <RowDefinition Height="*"/>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="*"/>
    </Grid.RowDefinitions>
    <Button
        Grid.Column="1"
        Grid.Row="1"
        FontSize="24"
        Content="QWERTY"/>
</Grid> 
```

我猜你的按钮没有调整大小，因为你限制了它们。要解决此问题，您需要决定如何调整它们的大小（如果它们只是盲目地增长，当元素重叠时这可能会非常复杂）并且如果提供的面板类型都没有执行您正在寻找的增长行为，那么您可能需要写你自己的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T13:22:01.340

您是否使用 Width 和 Height 属性对元素大小进行了硬编码？在 WPF 中，推荐的方法是使用多个布局容器。

下面是一个网格示例，它在底部放置两个按钮，在顶部放置一个文本框。

```
<Grid>
    <Grid.RowDefinitions>
        <!-- TextBox row with unspecified height. -->
        <RowDefinition Height="*"/>

        <!-- Button row with automated height so it resizes to
             fit the content -->
        <RowDefinition Height="Auto" />
    </Grid.RowDefinitions>

    <!-- Textbox on first row. -->
    <TextBox Margin="3" Name="textBox1" Grid.Row="0" AcceptsReturn="True" />

    <!-- StackPanel which lays the two buttons at the bottom horizontally.
         RightToLeft is specified so that the first button appears on right.
         -->
    <StackPanel Grid.Row="1" HorizontalAlignment="Right"
                Orientation="Horizontal" FlowDirection="RightToLeft">

        <!-- The buttons. Only padding and margin are hardcoded so these
             can resize to the contents -->
        <Button Padding="3" Margin="3">OK</Button>
        <Button Padding="3" Margin="3">Cancel</Button>
    </StackPanel>
</Grid> 
```

# php - Php Db 架构图创建者

> ID：811219
> 
> 赞同：0
> 
> 时间：2009-05-01T12:51:40.663
> 
> 标签：php, database, graphics, schema

想知道是否有任何 php 脚本需要一个 sql 数据库并以图表方式显示整个事情（以及关系）？类似于大多数 mysql 工具为桌面提供的工具。

非常感谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T13:37:08.137

也许这可以帮助您[构建实体关系图软件](http://www.trap17.com/index.php/freeware-entity-relationship-diagram-software_t4351.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T17:39:40.893

寻找 FabForce DbDesigner。 [http://fabforce.net/dbdesigner4/](http://fabforce.net/dbdesigner4/)

# c# - 如何创建线程？

> ID：811224
> 
> 赞同：66
> 
> 时间：2009-05-01T12:52:42.393
> 
> 标签：c#, multithreading

下面的方法是我想在该线程中完成的：

```
public void Startup(int port,string path)
{
    Run(path);
    CRCCheck2();
    CRCCheck1();
    InitializeCodeCave((ushort)port);
} 
```

我尝试了我能找到的谷歌搜索，但没有任何效果

```
public void Test(int port,string path)
{
    Thread t = new Thread(Startup(port,path));
}

public void TestA(int port,string path)
{
    Thread t = new Thread(Startup);
    t.Start (port,path);
} 
```

两者都不编译，怎么办？

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2009-05-01T13:05:21.317

以下方法有效。

```
// The old way of using ParameterizedThreadStart. This requires a
// method which takes ONE object as the parameter so you need to
// encapsulate the parameters inside one object.
Thread t = new Thread(new ParameterizedThreadStart(StartupA));
t.Start(new MyThreadParams(path, port));

// You can also use an anonymous delegate to do this.
Thread t2 = new Thread(delegate()
{
    StartupB(port, path);
});
t2.Start();

// Or lambda expressions if you are using C# 3.0
Thread t3 = new Thread(() => StartupB(port, path));
t3.Start(); 
```

这些示例的启动方法具有以下签名。

```
public void StartupA(object parameters);

public void StartupB(int port, string path); 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2015-12-21T13:07:43.557

**更新** 目前建议的启动任务的方法是简单地使用 Task.Run()

```
Task.Run(() => foo()); 
```

请注意，此方法被描述为启动任务的最佳方式，[请参见此处](https://stephencleary.com/book/)

**上一个答案**

我喜欢 System.Threading.Tasks 中的任务工厂。你可以这样做：

```
Task.Factory.StartNew(() => 
{
    // Whatever code you want in your thread
}); 
```

请注意，任务工厂为您提供了额外的便利选项，例如*ContinueWith*：

```
Task.Factory.StartNew(() => {}).ContinueWith((result) => 
{
    // Whatever code should be executed after the newly started thread.
}); 
```

另请注意，任务与线程的概念略有不同。它们非常适合 async/await 关键字，请参见[此处](https://blog.stephencleary.com/2012/02/async-and-await.html)。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-01T12:57:02.850

您要运行的方法必须是[`ThreadStart`Delegate](http://msdn.microsoft.com/en-us/library/system.threading.threadstart.aspx)。请查阅 MSDN 上的[`Thread`文档](http://msdn.microsoft.com/en-us/library/system.threading.thread.aspx)。请注意，您可以从一个闭包开始创建您的两个参数。就像是：

```
var t = new Thread(() => Startup(port, path)); 
```

请注意，您可能想要重新访问您的方法可访问性。如果我看到一个类以这种方式在它自己的公共方法上启动一个线程，我会有点惊讶。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-01T13:12:00.350

您的示例失败，因为 Thread 方法采用一个或零个参数。要在不传递参数的情况下创建线程，您的代码如下所示：

```
void Start()
{
    // do stuff
}

void Test()
{
    new Thread(new ThreadStart(Start)).Start();
} 
```

如果要将数据传递给线程，则需要将数据封装到单个对象中，无论是您自己设计的自定义类，还是字典对象或其他对象。然后，您需要使用*ParameterizedThreadStart*委托，如下所示：

```
void Start(object data)
{
    MyClass myData = (MyClass)myData;
    // do stuff
}

void Test(MyClass data)
{
    new Thread(new ParameterizedThreadStart(Start)).Start(data);
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-01T12:59:03.687

```
public class ThreadParameter
        {
            public int Port { get; set; }
            public string Path { get; set; }
        }

Thread t = new Thread(new ParameterizedThreadStart(Startup));
t.Start(new ThreadParameter() { Port = port, Path = path}); 
```

使用端口和路径对象创建一个对象并将其传递给 Startup 方法。

# programming-languages - 哪些库是必不可少的？

> ID：811233
> 
> 赞同：0
> 
> 时间：2009-05-01T12:56:57.653
> 
> 标签：programming-languages

如果你转向一种新的编程语言，如果你要继续使用这种语言，你认为哪些库必须得到支持？

我对特定库（例如，应该存在 libXYZ 的绑定）和类别（例如，应该存在正则表达式库）都感兴趣。

作为对此的延伸，哪些破坏交易的功能或设计决策（语言级别或库级别）会说服您切换到另一种语言或忽略它？您当前的主要语言是否很好地支持这些？如何改进它们？

除了语法、平台支持、效率和范式之外，我很想听听人们认为对于他们选择编程语言最重要的是什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T13:02:35.160

字符串处理在今天仍然是必不可少的。所以无论是语言还是标准库都应该有一套很好的字符串处理特性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T13:22:19.577

一个强大的类似 xUnit 的库。

网络服务支持

XML 处理

数据库连接库

网络库

线程库

一个文件 IO 库

在框架方面：

丰富的 GUI 库

一个 AJAX 库

应用服务器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T13:11:33.937

几十年前它并不那么重要，但对网络的支持非常重要。

至少像 HTTP 这样的高级东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T13:25:11.410

我一直使用的东西只是基本的东西，比如集合、网络和 I/O 的东西。而且我希望该语言能够直接支持它，而不是通过向其添加库。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T13:26:13.700

一个坚实的数学库有很大帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-01T13:41:53.583

*   常用表达
*   日志记录和其他诊断
*   密码学
*   集合（列表/地图/堆栈/等）

# visual-studio - 测试项目转换

> ID：811244
> 
> 赞同：1
> 
> 时间：2009-05-01T12:58:52.050
> 
> 标签：visual-studio, tdd

我道歉。这部分是咆哮，部分是问题。

对于咆哮：亲爱的 MS 开发人员，他们在 CodePlex 上发布 MVC 项目并将他们的网站专用于使用 TDD 的 MVC：我喜欢向您学习并感谢您提供的示例，但并不是每个人都有 Pro。我厌倦了无法加载这些东西的测试项目部分，因为使用标准，它超过了 [with Nunit] 的大多数需求。它很烦人。

现在，对于这个问题。:-)

是否有工具可以将这些单元测试项目转换为 Studio Standard 可以打开的 proj 文件，以便我至少可以编译和查看代码？

--

PS 亲爱的微软：不包括所有版本的 Studio 的单元测试就够了。这很愚蠢。测试不仅仅是“企业”或“专业”功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T13:04:47.120

在大多数情况下，测试框架之间的切换只是搜索/替换的一种情况。如果 csproj 没有加载，只需创建一个新项目文件并将代码文件拖入并在之后修复它们（连同引用一起）。例如，TestDriven.NET（或 NUnit 控制台）对仅将 dll/exe 作为测试项目感到非常满意。

也许是痛苦，但不一定是大问题。

如果你想将 NUnit 与 MVC 一起使用，[这里](http://msdn.microsoft.com/en-us/library/dd381614.aspx)和[这里](http://vishaljoshi.blogspot.com/2008/02/aspnet-mvc-test-framework-integration.html)都有简短的说明- 我不知道（尚未测试）它们是否适用于标准。

# c# - 抽象类、构造函数和 Co

> ID：811247
> 
> 赞同：7
> 
> 时间：2009-05-01T13:00:04.277
> 
> 标签：c#, constructor, abstract-class

好吧，我正在尝试重用一部分 C# 代码。这是一个带有 UDP 服务器的抽象类，可以在这里看到：

[http://clutch-inc.com/blog/?p=4](http://clutch-inc.com/blog/?p=4)

我创建了一个这样的派生类：

```
public class TheServer : UDPServer
{
    protected override void PacketReceived(UDPPacketBuffer buffer)
    {
    }

    protected override void PacketSent(UDPPacketBuffer buffer, int bytesSent)
    {
    }
} 
```

在我的应用程序中，我创建了一个派生类的实例，如下所示：

```
TheServer serv = new TheServer(20501);
serv.Start(); 
```

但是我有错误，我真的不明白为什么。请帮忙。

1.  “TheProject.TheServer”不包含采用“1”参数的构造函数
2.  'TheProject.UDPServer.Start()' 由于其保护级别而无法访问
3.  “TheProject.UDPServer”不包含采用“0”参数的构造函数

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-01T13:05:34.547

构造函数在 C# 中不会被继承。您将不得不手动链接它们：

```
public TheServer(int port) 
 : base(port)
{
} 
```

此外，如果 Start 受到保护，您将必须创建某种调用它的公共方法：

```
public void StartServer()
{
    Start();
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-01T13:04:26.967

您的派生类需要添加一个单参数构造函数，并将其委托给基类：

```
 public TheServer(int port) : base(port) {} 
```

此外，该`Start`方法受到保护。你需要自己的：

```
public void StartMe(){base.Start();} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T13:08:38.093

这些错误实际上有相当简单的原因：

1.  您尚未在派生类 ( `TheServer`) 中定义构造函数。构造函数（当然与方法不同）不会自动继承，因此您需要声明与父类中的构造函数匹配的构造函数，并使用以下内容将它们链接在一起：

    ```
    public TheServer(int port) : base(port)
    {
        // Your code here.
    }

    public TheServer() : base()
    {
        // Your code here.
    } 
    ```

2.  该`Start`方法`protected`在基`UDPServer`类 ( ) 中声明。要么将基类中的访问修饰符更改为`public`，要么在需要时找出一种从派生类调用方法的方法（后者必须是 的作者打算的`UDPServer`）。

3.  与 1 相同的原因，除了这是指默认（无参数）构造函数。

希望有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T13:03:19.013

您没有使用一个参数定义 TheServer 构造函数，因此您不能调用 TheServer(20501); 您没有为 UDPServer 定义零参数构造函数，但您定义了一个带有一个参数的构造函数。您在 TheServer 中的两种方法受到保护，因此出现 #2 错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T13:05:36.450

1.  和 3。

向 TheServer 添加一个构造函数，该构造函数调用（UDPServer 的）基本构造函数；像这样的东西：

```
public TheServer(int port) : base(port) {} 
```

2 检查方法 Start on UDPServer：它是受保护的。这意味着只有该类的子类才能调用它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T13:06:06.277

```
public class TheServer 
{   
    public TheServer():base(port) {
    }    
}

var myServer = new TheServer(1337).Brings().All().The().Boys().to().The().Yard() 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-01T13:06:19.893

您需要将代码发布到您的 Abstract 类，但完全猜测，

您`ctor`的 UDPServer 类中有一个尚未在 TheServer 类中实现的...您需要类似...

```
public TheServer(int port) : base(port)
{
   ... specifics
} 
```

而且您还忘记了覆盖 TheServer 类中的 Start() 方法，但它在基础类中标记为私有...您的基础类应该具有类似...

```
//In UDPServer
protected void Start()
{
   //Code to start
}

//In TheServer
protected void StartTheServer()
{
   base.Start();
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-01T13:40:04.883

而且，对于它的价值，我建议使用：

```
UDPServer serv = new TheServer(20501);
serv.start(); 
```

或者，也许更通用的是 Server。取决于您需要在 serv 上调用什么方法。

# java - 如何在 Swing 中使用拖放来获取文件路径？

> ID：811248
> 
> 赞同：48
> 
> 时间：2009-05-01T13:00:54.727
> 
> 标签：java, swing, drag-and-drop

我的*Swing*`JTextField`应用程序中有一个保存选择要使用的文件的文件路径。目前我有一个用来填充这个值的。但是，我想为用户添加将文件拖放到此文件的功能，并让它将该文件的文件路径放入其中，而不是始终使用.*`JFileChooser``JTextField``JTextField``JFileChooser`*

 *如何才能做到这一点？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-05-01T13:18:58.477

首先，您应该查看[Swing DragDrop 支持](http://java.sun.com/docs/books/tutorial/uiswing/dnd/intro.html)。之后，针对不同操作系统的小技巧很少。一旦你把事情搞定，你将处理 ​​drop() 回调。在此回调中，您需要检查 Transferable 的 DataFlavor。

对于 Windows，您只需检查[DataFlavor.isFlavorJavaFileListType()](http://java.sun.com/javase/6/docs/api/java/awt/datatransfer/DataFlavor.html#isFlavorJavaFileListType())，然后像这样获取您的数据

```
List<File> dropppedFiles = (List<File>)transferable.getTransferData(DataFlavor.javaFileListFlavor) 
```

对于 Linux（可能还有 Solaris），DataFlavor 有点棘手。您需要制作自己的 DataFlavor 并且 Transferable 类型会有所不同

```
nixFileDataFlavor = new DataFlavor("text/uri-list;class=java.lang.String");
String data = (String)transferable.getTransferData(nixFileDataFlavor);
for(StringTokenizer st = new StringTokenizer(data, "\r\n"); st.hasMoreTokens();)
{
    String token = st.nextToken().trim();
    if(token.startsWith("#") || token.isEmpty())
    {
         // comment line, by RFC 2483
         continue;
    }
    try
    {
         File file = new File(new URI(token))
         // store this somewhere
    }
    catch(...)
    {
       // do something good
       ....
    }
} 
```

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2012-02-02T11:12:48.653

如果您不想花太多时间研究这个相对复杂的主题，并且您使用的是 Java 7 或更高版本，这里有一个快速示例，说明如何接受带有 a`JTextArea`作为放置目标的放置文件：

```
JTextArea myPanel = new JTextArea();
myPanel.setDropTarget(new DropTarget() {
    public synchronized void drop(DropTargetDropEvent evt) {
        try {
            evt.acceptDrop(DnDConstants.ACTION_COPY);
            List<File> droppedFiles = (List<File>)
                evt.getTransferable().getTransferData(DataFlavor.javaFileListFlavor);
            for (File file : droppedFiles) {
                // process files
            }
        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }
}); 
```

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2011-12-10T11:24:50.687

有一个示例程序包含一个类，可用于促进文件和文件夹的拖放：

[http://www.iharder.net/current/java/filedrop/](http://www.iharder.net/current/java/filedrop/)

我在 Windows 7 和 Ubuntu 10.10 上对此进行了测试，它似乎在这两种环境中都运行良好。

要使用它，您可以在代码中添加如下内容：

```
 JPanel  myPanel = new JPanel();
  new  FileDrop( myPanel, new FileDrop.Listener()
  {   public void  filesDropped( java.io.File[] files )
      {   
          // handle file drop
          ...
      }   // end filesDropped
  }); // end FileDrop.Listener 
```

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2016-09-09T15:54:11.730

我知道这是一个老问题，但目前的答案都有些过时了：

*   从 JDK 1.6 开始，“TransferHandler”类应该与新的（覆盖的）方法一起使用
*   对 Linux 的支持变得更好，无需自定义处理

这适用于 Linux (KDE5) 和 Windows 7：

```
final class FileDropHandler extends TransferHandler {
    @Override
    public boolean canImport(TransferHandler.TransferSupport support) {
        for (DataFlavor flavor : support.getDataFlavors()) {
            if (flavor.isFlavorJavaFileListType()) {
                return true;
            }
        }
        return false;
    }

    @Override
    @SuppressWarnings("unchecked")
    public boolean importData(TransferHandler.TransferSupport support) {
        if (!this.canImport(support))
            return false;

        List<File> files;
        try {
            files = (List<File>) support.getTransferable()
                    .getTransferData(DataFlavor.javaFileListFlavor);
        } catch (UnsupportedFlavorException | IOException ex) {
            // should never happen (or JDK is buggy)
            return false;
        }

        for (File file: files) {
            // do something...
        }
        return true;
    }
} 
```

在任何组件上使用它

```
myComponent.setTransferHandler(new FileDropHandler()); 
```

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2010-06-01T15:46:20.610

这对我有用。我像这样使用它（scala）：

```
def onDrop(files: List[java.io.File]): Unit = { ... }

    val lblDrop = new Label {
      peer.setTransferHandler(new FileDropHandler(onDrop))
      border = EtchedBorder
    }

class FileDropHandler(val onDrop: List[java.io.File] => Unit) extends javax.swing.TransferHandler {
      import javax.swing.JComponent
      import java.awt.datatransfer.{Transferable, DataFlavor}
        import java.net.URI
    import java.io.File

    val stdFileListFlavor = DataFlavor.javaFileListFlavor
    val nixFileListFlavor = new DataFlavor("text/uri-list;class=java.lang.String")

    override def canImport(comp: JComponent, flavors: Array[DataFlavor]): Boolean =
        flavors.exists(flavor =>
            (flavor == stdFileListFlavor) ||
            (flavor == nixFileListFlavor)
        )

    override def importData(comp: JComponent, t: Transferable): Boolean = {

        val flavors = t.getTransferDataFlavors()

        val files = if (flavors.exists(_ == stdFileListFlavor)) {
            val data = t.getTransferData(stdFileListFlavor)
            importStdFileList( data )
        } else if (flavors.exists(_ == nixFileListFlavor)) {
            val data = t.getTransferData(nixFileListFlavor)
            importNixFileList( data )
        } else List()

        onDrop( files )

        !files.isEmpty
    }

    private def importStdFileList(data: Any): List[File] = {
      data.asInstanceOf[List[File]] //XXX NOT TESTED
    }

    private def importNixFileList(data: Any): List[File] = {

        def clean(rawLine: String): Option[String] = {
            val line = rawLine.trim
            if   (line.length == 0 || line == "#") None
            else                                   Some(line)
        }

        def asURI(line: String): Option[URI] = {
            try   { Some(new URI(line)) }
            catch { case e:Exception => println(e); None }
        }

        def asFile(uri: URI): Option[File] = {
            try   { Some(new File(uri)) }
            catch { case e:Exception => println(e); None }
        }

        data.asInstanceOf[java.lang.String].split("\n")
     .toList flatMap clean flatMap asURI flatMap asFile
    }
} 
```

# wpf - WPF 可调整大小的画布

> ID：811250
> 
> 赞同：2
> 
> 时间：2009-05-01T13:01:13.980
> 
> 标签：wpf, canvas, resize

我需要实现一个`Canvas`根据它的大小来缩放它的内容。我知道有`Viewbox`，它可以缩放其中的所有内容。但是我不能使用它，因为某些元素具有固定大小并且无法缩放。

另外，如何将 的大小绑定`Canvas`到父元素（例如可调整大小的窗口）。windows有sizeToContent，我希望大小正好相反。此外，画布使用一些基于托管元素大小的绘图，如何触发重绘以及如何确保它仅在获得有效（或最小）大小时才绘制？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T13:08:36.440

如果您没有为画布指定任何宽度或高度，它会自动使用所有可用空间。这是因为默认设置`VerticalAlignment`为.`HorizontalAlignment``Stretch`

你所说的画布是什么意思，它根据它的大小来缩放它的内容而不缩放所有的内容，因为有些内容是固定的？

**评论后更新**

如果您的绘图算法已经将内容缩放到画布的高度和宽度，那么您需要做的就是调整画布大小以适合我认为的区域？在这种情况下，只需删除硬编码的高度/宽度值，画布就会调整大小以适应容器。

在此之后，您可能需要在绘图算法中使用 ActualHeight/ActualWidth 而不是 Height/Width。ActualHeight/ActualWidth 返回布局容器将为您的画布提供的值，因此这些值表示画布所用的值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T13:15:31.527

[我想你可以在我的伦敦地铁演示](http://kentb.blogspot.com/2008/08/london-underground-wpf-demo.html)中找到所有问题的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-11-02T19:49:50.427

我是从记忆中做的，但如果我没记错的话，一个窗口使用面板或画布作为它的 ControlTemplate（其中包含 ContentPresenter）的一部分，这意味着直接放置在窗口中的画布将有自动调整大小的问题就像在其他地方一样。有一些基本的方法可以解决这个问题。

1 编写一个新的 ControlTemplate 供您的 Window 使用。:(
2 将您的内容直接放在窗口中，而不是在窗口内的画布中。：/
3 进行名称绑定。:)

```
<MyWindow x:Name="topWindow">
    <Canvas x:Name="topCanvas" Width="{Binding ElementName=topWindow, Path=ActualWidth}" Height="{Binding ElementName=topWindow, Path=ActualHeight}">
        ...Content...
    </Canvas>
</MyWindow> 
```

（碰巧，我经常以这种方式在 Canvases 中绑定网格，因此我可以轻松地为从一个网格位置移动到另一个网格位置的项目设置动画。）

# git - 如何在维护历史记录的同时将单个目录从 git 存储库移动到新存储库？

> ID：811251
> 
> 赞同：110
> 
> 时间：2009-05-01T13:01:24.400
> 
> 标签：git, git-submodules

我继承了一个 git 存储库，其中包含不同目录中的多个项目。我想将存储库拆分为新的单独存储库，每个项目一个，然后让主存储库将项目包含为子模块。如果可能的话，我想在保持各个项目的修订历史的同时完成所有这些工作。

我可以为每个项目克隆存储库并每次删除所有其他项目，但是有更好的方法来避免在每个新项目存储库中都有克隆的历史记录吗？

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2009-05-01T13:39:42.170

你可以用它[`git filter-branch`](http://git-scm.com/docs/git-filter-branch)来改写一个项目的历史。从文档中：

> 要重写存储库，使其看起来好像 foodir/ 是其项目根目录，并丢弃所有其他历史记录：
> 
> ```
> git filter-branch --subdirectory-filter foodir -- --all 
> ```

为您的存储库制作多个副本，为您要拆分的每个子目录执行此操作，然后您应该得到您正在寻找的内容。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-11-27T18:33:36.790

要将文件夹导出为新存储库，您需要：

1.  克隆要导出的文件夹所在的存储库。
2.  在您的托管服务提供商上创建一个空存储库作为 GitHub，以存储导出的文件夹。
3.  打开克隆的存储库文件夹并运行以下命令：

    ```
    git subtree push --prefix=YourFolderNameToExport https://github.com/YourUserName/YourNewCleanRepoName master 
    ```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T13:30:03.957

git 的重点是历史通过散列父提交体现在每个提交中。您可以将提交（这本质上是 svn-importer 的工作方式）“重播”到一个新的存储库中，并且只保留每个子项目。然而，这会破坏提交哈希的含义。如果你对此没有任何问题，那就这样吧。

在过去，我只是克隆它并继续前进。这使事情变得更大，但磁盘空间很便宜；我的时间很昂贵。

我也不知道有什么工具可以拼接出一个目录。我想你可以在目录上 git-log 找到所有提交，然后用 git-fast-export 之类的东西重放提交？

# sharepoint - SharePoint：将版本化列表导出到 Excel 时出现问题

> ID：811255
> 
> 赞同：0
> 
> 时间：2009-05-01T13:03:30.977
> 
> 标签：sharepoint, excel, export

我在 SharePoint 中有一个启用了版本控制的列表。此列表包含一个多行文本列，用于存储有关列表项的注释。“导出到 Excel”功能有效并生成所有列表项的电子表格，但是，每个列表项仅包含注释列中的最新条目。我希望此导出包含导出中所有笔记的完整历史记录。

有谁知道这个问题的解决方案？

谢谢，

帕特里克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T13:48:43.443

您的 Notes 多行文本字段将“将更改附加到现有文本”设置为“是”。如果您希望开箱即用的导出到 excel 功能导出所有文本，则必须将此值设置为否。

如果选择是，则每个更改都存储在每个列表项的版本中，因此当您导出到 excel 时，它只是最新版本。

# nhibernate - 外键约束阻止 NHibernate 保存子记录

> ID：811266
> 
> 赞同：2
> 
> 时间：2009-05-01T13:05:47.307
> 
> 标签：nhibernate

我有两张桌子：

## 支持票

SupportTicketID
SupportTicketDate

## SupportTicketNote

SupportTicketNoteID
SupportTicketNoteDate
SupportTicketID

使用外键约束，所以我没有任何未关联的注释...在 sql 中该约束正常工作。

在我的 SupportTicket 类上，我有一个 IList SupportTicketNotes 属性并将其映射为一个包（可能真的应该是一个集合，但目前这并不重要）。负载工作得很好。问题是如果我新建一个 SupportTicket，新建一个 SupportTicketNote，将注释添加到工单并保存工单。NHibernate 正在插入 SupportTicket，然后插入 SupportTicketNote，SupportTicketID 为零，这当然会因为 FK 约束而崩溃。如果我删除约束，它将以零的 SupportTicketID 插入，然后返回并使用正确的 ID 值对 SupportTicketNote 进行更新......但这似乎......错误。我可能在映射中做些什么导致这种情况？

**更新以包括对子对象的多对一映射**

这是我当前对 SupportTicket 的映射：

```
<bag name="_supportTicketNotes" table="SupportTicketNotes" access="field" cascade="save-update" inverse="true" >
  <key column="SupportTicketID" foreign-key="FK_SupportTicketNotes_supporttickets" ></key>
  <one-to-many class="NhibernateSample.DomainModel.SupportTicketNote, NhibernateSample.DomainModel" />
</bag> 
```

这是我的 SupportTicketNote 映射（注意我的 SupportTicketNote 类同时具有 SupportTicketID 和 SupportTicket 对象属性）：

```
 <many-to-one name="SupportTicket"   class="NhibernateSample.DomainModel.SupportTicket, NhibernateSample.DomainModel"   column="SupportTicketId" cascade="all"/> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T14:48:45.467

我还没有看到你的完整映射，但我首先想到的是[文档](https://www.hibernate.org/hib_docs/nhibernate/1.2/reference/en/html_single/#collections-onetomany)中的这一部分：

> *非常重要的注意事项*：如果声明了关联的`<key>` 列，NHibernate 在创建或更新关联时可能会导致违反约束。为防止此问题，*您必须使用*与标记为 的多值端（集合或包）的双向关联。请参阅本章后面对双向关联的讨论。`<one-to-many>``NOT NULL`*`inverse="true"`*

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T16:15:48.597

您如何在 SupportTicketNote 上映射父 SupportTicket 属性？将 SupportTicketNote 添加到集合时是否设置了 SupportTicket 属性？我几乎总是遵循这种模式：

```
public class SupportTicket
{
    private IEnumerable<SupportTicketNote> _notes = new List<SupportTicketNote>();

    public IEnumerable<SupportTicketNote> Notes
    {
        get { return _notes; }
    }

    public void AddNote(SupportTicketNote note)
    {
        note.SupportTicket = this;
        _notes.Add(note)
    }

    public void RemoveNote(SupportTicketNote note)
    {
        note.SupportTicket = null;
        _notes.Remove(note)
    }
} 
```

编辑添加：您的 SupportTicketNote 映射看起来错误。它应该与 SupportTicket 是多对一的，并且您根本不应该映射 SupportTicketId。我使用[Fluent NHibernate](http://fluentnhibernate.org/)已经有一段时间了，但我认为 XML 映射应该如下所示：

```
<many-to-one name="SupportTicket"
   class="NhibernateSample.DomainModel.SupportTicket, NhibernateSample.DomainModel"
   column="SupportTicketId" cascade="all"/> 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-05-01T13:27:24.633

您需要以这样一种方式编写您的函数，即新 SupportTicket 的持久性发生在您添加 SupportTicketNote 之前

例如

```
SupportTicket st = new SupportTicket();
SupportTicketNote stn = new SupportTicketNote();

///Code to set properties on both objects

st.Save();
st.SupportTicketNotes.Add(stn);
st.Save(); 
```

# javascript - 如何从 iframe 中打印 pdf？

> ID：811272
> 
> 赞同：1
> 
> 时间：2009-05-01T13:07:16.320
> 
> 标签：javascript, jquery, pdf, iframe, printing

在[cbjsonline.com](http://cbjsonline.com/for-patients/forms)，我正在尝试使用 javascript 在 iframe 中自动打印 pdf。

目前，我的代码是 - （连接到打开 iframe 的链接的 onclick） -`document.getElementById('fancy_frame').onload = setTimeout('window.print()',2500);`

有什么建议么？此方法仅适用于 safari。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T17:24:59.087

尝试将函数指针传递给 setTimeout，而不是通过 eval 的表达式。

```
document.getElementById('fancy_frame').onload = setTimeout( printWindow, 2500 );

// implemented in the HTML that is loaded in 'fancy_frame'
function printWindow()
{
    window.print();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-28T20:18:10.593

好的，我决定让用户打印页面。我认为带有 PDF 的 iFrame 在尝试使用 javascript 打印时变化太大。如果有人想试试这个，这是我推荐的。使用 jquery load，它检查资产，而不仅仅是加载，而不是 onload 处理程序，因为 adobe reader 的延迟在不同的计算机上差异很大。另外，在打印之前尝试命名和聚焦 iframe（按名称，所以 iframe.print()，而不是 window.print()），这样它就不会尝试打印您当前所在的页面。对这个应用程序使用 scribd ipaper 查看器可能是一个更好的主意。

# objective-c - 为什么便利构造函数或对象工厂必须关心释放对象？

> ID：811290
> 
> 赞同：0
> 
> 时间：2009-05-01T13:13:53.293
> 
> 标签：objective-c, memory-management, autorelease

实际上，如果您使用名称中带有“new”、“create”、“alloc”或“copy”的方法，那么您有责任释放返回给您的对象。但是：为什么这些方法会调用 -autorelease？这不会导致“过度释放”对象吗？

假设我从这样的方法中获取该对象，然后我调用 -release 。该对象在 Autorelease Pool 中，并且引用计数为 0。当 Autorelease Pool 被释放时，接下来会发生什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-01T13:23:46.717

便利构造函数的名称中没有任何这些词（例如，[NSMutableArray 数组]），因此按照惯例，它们返回自动释放的对象。确实具有表明它们返回保留对象的单词之一的方法不会调用自动释放，因此您问题的部分前提是不正确的。

如果您自己释放从便利构造函数返回的对象（没有显式保留它们），那么它们将被过度释放，您的应用程序可能会崩溃。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T13:26:15.557

对不起@所有人！我想，我在明亮的阳光下坐得太久了。当然，这些便捷方法拥有它们创建的对象的所有权，因为它们在开始时的某个时间点调用 -alloc。而且-alloc 方法本身不会调用-alloc，因为它已经是-alloc。就是这样。

想过删掉这个问题，但也许其他人也像我一样在阳光下坐了太久。所以这可能会有所帮助。

# c# - 如何在给定类名的情况下获取用户定义的对象类型？

> ID：811294
> 
> 赞同：1
> 
> 时间：2009-05-01T13:15:01.713
> 
> 标签：c#, generics

如果我将用户定义对象的类名作为字符串，我如何在通用函数中将其用作对象的类型？

SomeGenericFunction(objectID);

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T13:23:35.657

如果您有一个字符串，那么首先要做的是使用`Type.GetType(string)`, 或（最好）`Assembly.GetType(string)`获取`Type`实例。从那里，您需要使用反射：

```
Type type = someAssembly.GetType(typeName);
typeof(TypeWithTheMethod).GetMethod("SomeGenericFunction")
          .MakeGenericMethod(type).Invoke({target}, new object[] {objectID}); 
```

`{target}`实例方法和`null`静态方法的实例在哪里。

例如：

```
using System;
namespace SomeNamespace {
    class Foo { }
}
static class Program {
    static void Main() {
        string typeName = "SomeNamespace.Foo";
        int id = 123;
        Type type = typeof(Program).Assembly.GetType(typeName);
        object obj = typeof(Program).GetMethod("SomeGenericFunction")
            .MakeGenericMethod(type).Invoke(
                null, new object[] { id });
        Console.WriteLine(obj);
    }
    public static T SomeGenericFunction<T>(int id) where T : new() {
        Console.WriteLine("Find {0} id = {1}", typeof(T).Name, id);
        return new T();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T13:20:37.940

查看 System.Type.GetType() 方法 - 提供完全限定的类型名称，然后返回相应的 Type 对象。然后，您可以执行以下操作：

```
namespace GenericBind {
    class Program {
        static void Main(string[] args) {
            Type t = Type.GetType("GenericBind.B");

            MethodInfo genericMethod = typeof(Program).GetMethod("Method");
            MethodInfo constructedMethod = genericMethod.MakeGenericMethod(t);

            Console.WriteLine((string)constructedMethod.Invoke(null, new object[] {new B() }));
            Console.ReadKey();
        }

        public static string Method<T>(T obj) {
            return obj.ToString();
        }
    }

    public class B {
        public override string ToString() {
            return "Generic method called on " + GetType().ToString();
        }
    }
} 
```

# iphone - 是否可以通过互联网在两个移动设备 (iPhone) 之间连接套接字？

> ID：811298
> 
> 赞同：11
> 
> 时间：2009-05-01T13:16:17.157
> 
> 标签：iphone, sockets, tcp, p2p

是否可以通过互联网在两个移动设备 (iPhone) 之间连接套接字？

我正在尝试发现每个设备的 IP 并直接连接。我知道它可以用 Bonjour 来完成，但这只适用于本地网络。我需要通过互联网在两个设备之间建立高速连接。

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-01T13:35:12.337

如果你有两个 IP 并且它们都是可路由的，那么应该是可能的。我不确定 3G 网络提供的 IP 是否可路由。如果您使用的是 WIFI，那么您获得的 IP 几乎可以肯定是不可路由的。假设你有一个可路由的 IP，它应该是可能的。

诀窍就是发现其他设备的 IP。最好的方法可能是让每台设备在您的应用程序启动时向 Web 服务注册其 IP，然后查询该服务以查找其他设备的 IP。

当应用程序关闭或 IP 更改时，管理“取消注册”IP 可能会有点棘手，但它应该是可行的。

预计到达时间：

如果您有一个他们都可以连接的服务器，您应该能够使用该服务器实现一个解决方案（即没有电话实际上直接相互连接）。这将避免电话具有可路由 IP 的问题。

至于如何将套接字桥接在一起 - 您的服务器程序基本上可以像老式电话交换机操作员一样工作。您将在服务器软件中内置某种注册和发现协议，允许电话向服务器注册自身，查询当前连接到服务器的其他电话的列表，指示它想与哪个电话交谈，并接受来自其他手机的连接。

一旦它知道谁想与谁交谈，您的服务器软件就会通过从一部手机的套接字读取数据并将该数据写入另一部手机的套接字来将两者连接在一起。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T13:31:45.933

只是一个建议，但如果你能让他们每个人都连接到第三个站点，那么你就会知道每个人的地址。将电话 A 的地址发送到电话 B（和/或电话 B 到电话 A），然后让它们按照您认为合适的方式连接。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T14:42:19.040

你看过 3.0 的所有功能了吗？特别是对等网络（其存在是公开的）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T15:16:48.600

WiFi路由器通常具有称为“端口触发”的功能，它允许内部主机（在本例中为iPhone）通知路由器他们希望将特定端口上的连接转发给它们。我不知道 iPhone 是否支持这个协议。

对于 IP 查找，如果提前知道两个主机，则可以考虑使用 DynamicDNS，或者如果不知道，则如上所述使用自定义 Web 服务（即朋友交换主机名与陌生人相互发现）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-06-16T18:05:51.870

这是一个旧线程，但我刚刚遇到它。您可以使用 STUN 服务器（或 NAT-PMP）获取公共 IP 地址/端口组合，然后将其发送到另一部手机。只要您在第一台设备上打开一个监听端口，那么您的第二台设备就可以直接使用您在 SMS 中发送给它的 publi IP 地址/端口直接连接（SMS 推送注册表可以自动唤醒您在第二台设备上的应用程序以做这个）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-09-16T01:35:00.817

我在开发的应用程序中遇到了这个问题。我试图从 iPhone 连接到 PC 手机卡。问题是 AT&T 不支持 iPhone 的移动终端，因此 AT&T 网络上的两部手机在物理上不可能相互连接。这直接来自 AT&T 天线工程师。

我可以通过将 iPhone VPN 连接到服务器然后连接到 PC 手机卡来实现此功能，但除此之外，它无法正常工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-01T18:53:39.373

我有一种非常强烈的感觉（但没有证据）iPhone 地址将无法路由。当然这实际上取决于运营商，但 AT&T 给出 10.xxx 地址。

Apple 有使用 Bonjour 在支持 UnPnP 的 WiFi 路由器上实现端口映射的[示例（桌面）代码。](http://developer.apple.com/samplecode/PortMapper/index.html)

# asp.net - ASP.NET MVC 模型绑定和动作参数

> ID：811300
> 
> 赞同：2
> 
> 时间：2009-05-01T13:16:32.647
> 
> 标签：asp.net, asp.net-mvc

假设我有一个控制器动作定义为：

```
public ActionResult(MyModel model, string someParameter) 
{
    // do stuff
} 
```

我有一个 MyModel 类型的自定义模型绑定器，并且视图中有一个名为“SomeParameter”的表单字段未绑定到模型。ASP.NET MVC 如何知道将 的值`Request.Form["SomeParameter"]`作为“someParameter”参数的值传递给操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T13:53:42.590

ASP.NET 使用反射来确定要调用的正确方法并构建要传递的参数。它基于 FormCollection 数组执行此操作。基本上它会看到 model.* Keysin ，`FormCollection["someParameter"]`它会先尝试`Action(model,someParameter)`然后`Action(model)`再`Action()`. 因为它找到了一个带有模型和一些参数参数的动作，所以它会尝试将它们转换为参数类型。

但是默认情况下，它会盲目地这样做，这会带来一些安全风险，[这篇博客文章对此](http://dotnet.dzone.com/news/aspnet-mvc-think-before-you-bi)进行了更详细的介绍。

如果有人可以发布一个链接，该链接更详细地描述了模型绑定是如何在幕后完成的，那就太好了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T13:40:45.803

因为除非您另外指定，否则默认模型绑定器将用于 someParameter。默认模型绑定器完全按照您的描述进行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-23T22:29:40.430

Phil Haack 有一篇关于[方法如何成为行动](http://www.codethinked.com/ASPNET-MVC-Think-Before-You-Bind)的帖子，解释了这个解决方案是如何发生的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-23T23:17:40.740

听起来你需要一个模型活页夹。这些允许您定义表单数据如何绑定到模型参数。您可以在以下位置阅读有关它们的更多信息：

[ASP.NET MVC Preview 5 和表单发布方案](http://weblogs.asp.net/scottgu/archive/2008/09/02/asp-net-mvc-preview-5-and-form-posting-scenarios.aspx)

[如何使用 ASP.NET MVC Modelbinder](http://weblogs.asp.net/melvynharbour/archive/2008/08/29/how-to-use-the-asp-net-mvc-modelbinder.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-30T07:22:43.410

最简单的方法之一是在页面上使用与操作方法中的输入参数同名的 Html 项目。EX）在视图中我们有：

```
 <input name="refNo" type="text"> 
```

然后在 Action 方法中：

```
 public ActionResult getOrders(string refNo) 
```

因此，它只是将“refNo”的值绑定到“getOrders”操作的输入参数。

# php - 是否可以编写一个使用 Unicode 的优秀 PHP 应用程序？

> ID：811306
> 
> 赞同：1
> 
> 时间：2009-05-01T13:18:37.837
> 
> 标签：php, python, web-applications, unicode

我的下一个 Web 应用程序项目将广泛使用 Unicode。我通常使用 PHP 和 CodeIgniter，但 Unicode 并不是 PHP 的强项之一。

有没有一个 PHP 工具可以帮助我让 Unicode 在 PHP 中正常工作？

还是我应该借此机会研究 Python 等替代方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T13:23:20.790

一旦确保在进入和退出时进行编码和解码，PHP 就可以很好地处理 unicode。如果要存储在数据库中，请确保 html 页面、Web 服务器、编辑器和数据库之间的语言编码和字符集映射匹配。

如果整个应用程序处处使用 UTF-8，则无需解码。唯一需要解码的时候是当您在另一个不在网络上的字符集中输出数据时。输出html时，可以使用

```
htmlentities($var, ENT_QUOTES, 'UTF-8'); 
```

以获得正确的输出。在大多数情况下，标准函数会破坏字符串。邮件功能也是如此。

[http://developer.loftdigital.com/blog/php-utf-8-cheatsheet](http://developer.loftdigital.com/blog/php-utf-8-cheatsheet)是一个非常好的使用 UTF-8 的资源

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T14:23:51.660

PHP 6的主要特性之一*将与 UNICODE 支持紧密集成。*

**在 PHP 5 中实现 UTF-8。** 由于 PHP 字符串是面向字节的，Unicode 文本唯一实用的编码方案是 UTF-8。技巧是 [从 PHp Architect Magazine 得到它]：

*   以 UTF-8 显示 HTML 页面
*   将 PHP 脚本转换为 UTF-8
*   将网站内容、后端数据库等转换为 UTF-8
*   确保没有 PHP 函数损坏 UTF-8 文本

> 查看[http://www.gravitonic.com/talks/](http://www.gravitonic.com/talks/)
> PHP UTF 8 备忘[单](http://developer.loftdigital.com/blog/php-utf-8-cheatsheet)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T15:24:05.727

PHP 大多不知道字符集并将字符串视为字节流。这真的不是什么大问题，但你必须自己做一些工作。

一般的经验法则是您应该在任何地方使用相同的字符集。如果你在任何地方都使用 UTF-8，那么你就在那里 99%。只要确保你不混合字符集，因为那样它会变得非常复杂。UTF-8 唯一不能正常工作的是字符串操作，它需要在字符级别上操作。例如。`strlen`等`substr`。您应该使用支持 UTF-8 的版本来代替这些版本。多[字节字符串扩展](http://www.php.net/mbstring)为您提供了这一点。

有关需要确保字符集设置正确的地方的清单，请查看：

[http://developer.loftdigital.com/blog/php-utf-8-cheatsheet](http://developer.loftdigital.com/blog/php-utf-8-cheatsheet)

有关更多信息，请查看：

[http://www.phpwact.org/php/i18n/utf-8](http://www.phpwact.org/php/i18n/utf-8)

# ruby-on-rails - 有什么方法可以查看哪个路由匹配来自 Rails 中浏览器的请求？

> ID：811314
> 
> 赞同：2
> 
> 时间：2009-05-01T13:21:12.510
> 
> 标签：ruby-on-rails, debugging, routes

在我的**routes.rb**文件中，我有许多路线。我想知道哪一个与用户可能提出的任何请求相匹配。

例如，在 routes.rb 你有以下路线：

```
map.connect ":controller/:action"
map.connect ":controler/:action/:id"

```

如果我有一个名为**a**的控制器和一个名为**first**的操作，当用户访问**[http://whatever/a/first](http://whatever/a/first)**时，我希望看到选择了**:controller/:action**路由。

我可以为任何请求这样做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T13:32:27.243

如果你只想知道你在哪个控制器/动作中，控制器提供`controller_name`和`action_name`方法。所以你可能会做这样的事情：

```
# in application_controller.rb
before_filter :set_where_am_i
def set_where_am_i
  @where_am_i = "#{controller_name}/#{action_name}"
end

# in views/layouts/application.erb, somewhere in your html
# (here I choose the <title>)

<head><title>Here: <%= @where_am_i %></title> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T13:31:55.950

我能找到的最接近的东西是在日志文件中。您将看到每个请求与哪个控制器的哪个操作匹配。你会看到这样的东西：

```
参数：{"action"=>"show", "id"=>"2", "controller"=>"mycontroller"}

```

从那里开始，应该很容易，对吧？

# html - Ajax 表单验证

> ID：811339
> 
> 赞同：0
> 
> 时间：2009-05-01T13:30:01.600
> 
> 标签：html, ajax

我使用 ajax/php 创建了一个表单验证。每个文本框都使用不同的文件进行验证，例如 username_ajax.php。一旦信息被检查为正常，它就会在屏幕上回显（“用户名正常”）。一旦所有文本框都“确定”，我无法弄清楚如何允许用户只按下提交按钮。任何帮助将不胜感激，谢谢。

我的代码（对不起，很长）：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Sign-up</title>
</head>
<script type="text/javascript">

   function username(username)
{
    var httpRequest;
    make_request()
    function stateck() 
        {
            if(httpxml.readyState==4)
            {
            document.getElementById    ("user_div").innerHTML=httpxml.responseText;
            }
        } 

    httpxml.onreadystatechange=stateck;
    user_url="ajax_username.php?username=" + username.value;
    httpxml.open("GET",user_url,true);
    httpxml.send(null);
}

function email(email)
{
    var httpRequest;
        make_request()
        function stateck() 
        {
            if(httpxml.readyState==4)
            {
            document.getElementById("email_div").innerHTML=httpxml.responseText;
            }
        }

    httpxml.onreadystatechange=stateck;
    email_url="ajax_email.php?value=" + email.value;
    httpxml.open("GET",email_url,true);
    httpxml.send(null);
}

function confirm(password,conpassword)

{
    var httpRequest;
    make_request()
    function stateck()
    {
            if(httpxml.readyState==4)
            {
            document.getElementById("conpass_div").innerHTML=httpxml.responseText;
            }
        }
    httpxml.onreadystatechange=stateck;
    conpassword_url="ajax_password.php?password=" + password.value + "&conpassword=" + conpassword.value;
    httpxml.open("GET",conpassword_url,true);
     httpxml.send(null);
}

</script>

<body>
<div id="user_div"></div>
<div id="conpass_div"></div>
<div id="email_div"></div>
<form id="form" name="form" method="post" action="">
<label>Username<br />
      <input type="text" name="username" id="username" onBlur="check_username(username)">
       <br />
<br />
    </label>

  <label>Password<br />
    <input type="password" name="password" id="password" onBlur="check_confirm     (password,conpassword);">
   </label>    

  <label><br />
    <br />
    Confirm Password<br />
    <input type="password" name="conpassword" id="conpassword" onBlur="check_confirm(password,conpassword);">
   <br />
   <br />
  </label>    

<label>Email<br />
<input type="text" name="email" id="email" onblur="check_email(email)" />
  <p>
  <p>
  <label>
         <input type="submit" name="button" id="button" value="Submit" onclick="return false;" />
       </label>
    </p>
</form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T13:51:36.290

将提交按钮设置为禁用，直到所有输入都得到验证。

要进行此检查，在检查完任何输入后，检查是否所有其他输入都已经过验证。您需要创建一个全局数组来保存哪些输入是有效的。

请注意，即使您正在执行此验证，您也应该在实际提交表单后重新进行验证，因为恶意用户仍然可以发送无效的输入数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T14:02:04.533

您需要有状态标志和检查例程..

从禁用输入按钮开始：

```
<input type="submit" name="submit" id="button" disabled> 
```

基本上..

```
var userNameOk;
var passwordOk;
var emailOk;

function checkCanSubmit() {
  if (userNameOk && passwordOk && emailOk) {
    document.getElementById("button").disabled= false;
  else
    document.getElementById("button").disabled= true;
} 
```

然后，您将修改每个检查函数的匿名方法以更新正确的状态标志并调用 checkCanSubmit() 方法；

```
function stateck() 
    {
            if(httpxml.readyState==4)
            {
              if (httpxml.response.Text == "whateverisvalid") {
                emailOk = true;
              } else {
                emailOk = false;
              }
              checkCanSubmit();
              document.getElementById("email_div").innerHTML=httpxml.responseText;
            }
    } 
```

顺便说一句，我会质疑您在查询字符串上发送用户名和密码的事实.. 让全世界都可以看到.. 它将存储（可能永远）任意数量的路由器日志、嗅探器、代理服务器..和您的网络服务器日志文件。

有没有更好/更清洁/更智能的方法来做到这一点？

# java - 有没有办法保存包含节点和边的图形对象？

> ID：811344
> 
> 赞同：1
> 
> 时间：2009-05-01T13:31:16.073
> 
> 标签：java, serialization

我试过使用标准的序列化类型的东西，比如：

```
 FileOutputStream f_out;
try {
    f_out = new FileOutputStream("MAOS.data");
     ObjectOutputStream  obj_out = new ObjectOutputStream (f_out);       
     obj_out.writeObject(s);
     obj_out.flush();
     obj_out.close();

} catch (FileNotFoundException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} catch (IOException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} ; 
```

但问题似乎是，如果我的对象 s 包含任何递归，我会得到堆栈溢出。如果 s 是一个包含节点和边的图（节点知道边是为了传播激活，而边知道节点是出于同样的原因），那么它就会堆栈溢出。如果我完全去掉边缘，并且只有节点知道它们应该传播激活的节点，同样的事情也会发生！我什至可以尝试保存图形知道的节点的 ArrayList，堆栈再次溢出！

我很沮丧！

图表并不奇怪和神秘，肯定有人想在我面前保存一张。我在这里看到了一些关于将它们保存为 XML 文件的信息……但如果我的问题是递归性，即使我以不同的方式保存它，我是否还会遇到同样的问题？我只是想不出你怎么能在没有联系的情况下制作图表！

我只是做错了，还是这个对象序列化没有我想象的那么强大？还是我需要放弃保存图表的想法？

-珍妮

编辑，巨大的堆栈跟踪的一部分：

```
Exception in thread "main" java.lang.StackOverflowError
    at java.io.ObjectStreamClass.getPrimFieldValues(Unknown Source)
    at java.io.ObjectOutputStream.defaultWriteFields(Unknown Source)
    at java.io.ObjectOutputStream.writeSerialData(Unknown Source)
    at java.io.ObjectOutputStream.writeOrdinaryObject(Unknown Source)
    at java.io.ObjectOutputStream.writeObject0(Unknown Source)
    at java.io.ObjectOutputStream.writeObject(Unknown Source)
    at java.util.ArrayList.writeObject(Unknown Source)
    at sun.reflect.GeneratedMethodAccessor1.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at java.io.ObjectStreamClass.invokeWriteObject(Unknown Source)
    at java.io.ObjectOutputStream.writeSerialData(Unknown Source)
    at java.io.ObjectOutputStream.writeOrdinaryObject(Unknown Source)
    at java.io.ObjectOutputStream.writeObject0(Unknown Source)
    at java.io.ObjectOutputStream.defaultWriteFields(Unknown Source)
    at java.io.ObjectOutputStream.writeSerialData(Unknown Source)
    at java.io.ObjectOutputStream.writeOrdinaryObject(Unknown Source)
    at java.io.ObjectOutputStream.writeObject0(Unknown Source)
    at java.io.ObjectOutputStream.writeObject(Unknown Source)
    at java.util.ArrayList.writeObject(Unknown Source)
    at sun.reflect.GeneratedMethodAccessor1.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at java.io.ObjectStreamClass.invokeWriteObject(Unknown Source)
    at java.io.ObjectOutputStream.writeSerialData(Unknown Source)
    at java.io.ObjectOutputStream.writeOrdinaryObject(Unknown Source)
    at java.io.ObjectOutputStream.writeObject0(Unknown Source)
    at java.io.ObjectOutputStream.defaultWriteFields(Unknown Source)
    at java.io.ObjectOutputStream.writeSerialData(Unknown Source)
    at java.io.ObjectOutputStream.writeOrdinaryObject(Unknown Source)
    at java.io.ObjectOutputStream.writeObject0(Unknown Source)
    at java.io.ObjectOutputStream.writeObject(Unknown Source)
    at java.util.ArrayList.writeObject(Unknown Source)
    at sun.reflect.GeneratedMethodAccessor1.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at java.io.ObjectStreamClass.invokeWriteObject(Unknown Source)
    at java.io.ObjectOutputStream.writeSerialData(Unknown Source)
    at java.io.ObjectOutputStream.writeOrdinaryObject(Unknown Source)
    at java.io.ObjectOutputStream.writeObject0(Unknown Source)
    at java.io.ObjectOutputStream.defaultWriteFields(Unknown Source)
    at java.io.ObjectOutputStream.writeSerialData(Unknown Source)
    at java.io.ObjectOutputStream.writeOrdinaryObject(Unknown Source)
    at java.io.ObjectOutputStream.writeObject0(Unknown Source)
    at java.io.ObjectOutputStream.writeObject(Unknown Source)
    at java.util.ArrayList.writeObject(Unknown Source)
    at sun.reflect.GeneratedMethodAccessor1.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at java.io.ObjectStreamClass.invokeWriteObject(Unknown Source)
    at java.io.ObjectOutputStream.writeSerialData(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T13:55:57.310

这些结构最好像这样保存：

```
collection of nodes, each node has a unique ID
collection of edges, each edge has two node IDs (or however many nodes an edge connects to) 
```

不使用任何递归。在读取节点时，创建一个按 ID 索引的节点字典。然后在阅读时使用字典来修复边缘。ID 不需要是对象的运行时结构的一部分，它们只需要在写入/读取流时在数据流中是唯一的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T14:33:32.883

您可以使用支持将图形序列化为 ML 格式的文本文件的[JGraphT](http://www.jgrapht.org/)库。[GraphMLExporter Javadoc](http://www.jgrapht.org/javadoc/org/jgrapht/ext/GraphMLExporter.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T13:34:36.083

Java 序列化可以处理任意图（尽管不一定非常有效）。问题可能在于`writeObject`. 也许一部分堆栈跟踪可能会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T14:19:21.920

您应该考虑的一种有用的序列化格式是[JSON](http://www.json.org/java/index.html)，其中字典（如@Skizz 所建议）很容易表示：

> JSONObject 是名称/值对的无序集合。它的外部形式是一个用大括号括起来的字符串，名称和值之间用冒号分隔，值和名称之间用逗号分隔。内部形式是一个对象，它具有 get() 和 opt() 方法，用于按名称访问值，以及 put() 方法，用于按名称添加或替换值。这些值可以是以下任何类型：Boolean、JSONArray、JSONObject、Number 和 String，或 JSONObject.NULL 对象。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T14:53:28.437

Java 序列化能够处理循环引用（我假设这就是您所说的递归），但是这里描述的大图存在一个已知[问题](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4152790)。

不要让文章的日期让你失望，只需关注它之后的评论链。

看来您将不得不使用另一种序列化技术来完成此操作。已经提到了几个，一些[性能指标](http://code.google.com/p/thrift-protobuf-compare/wiki/Benchmarking?ts=1237772203&updated=Benchmarking)给 JSON 高分。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-05-01T13:34:19.233

嗯。一种解决方案是将其制成 java bean 并使用`XMLEncoder`/ `XMLDecoder`。这是我过去用来保存和加载类的解决方案。

# java - 如何使用相同的查询向 Sql 数据库插入和更新多行？

> ID：811345
> 
> 赞同：1
> 
> 时间：2009-05-01T13:31:42.813
> 
> 标签：java, sql, mysql

我的表中有唯一列的计数器。现在我有列名（唯一）和计数器（包含一些整数值）的列表。我知道可以插入多行，我只是可以进行包含列表中所有这些项目的查询，但问题是如果唯一字段中已经有数据。

在那种情况下，已经有这个名称并且它具有计数器值，在这种情况下，我需要将现有的计数器值相加以添加值并更新该行。有没有办法用一个 Sql 查询来完成这一切？我使用 MySQL 数据库和 Java。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T13:42:20.370

插入重复密钥更新

是您要查找的语法。

见[这里](http://www.mysqlperformanceblog.com/2006/05/29/insert-on-duplicate-key-update-and-summary-counters/)。

# asp.net - 好的编程建议

> ID：811349
> 
> 赞同：-1
> 
> 时间：2009-05-01T13:32:13.110
> 
> 标签：asp.net

我的一个朋友写了一个网站，里面有很多用户控件和页面。

这些页面包含许多标签、隐藏值和用户控件。根据用户请求，他启用和禁用这些控件。在每个网络表单页面加载中，他都在循环`Request.form.allkeys`并比较每个控件。基于该比较，他正在启用和禁用网络表单上的控件。

我不知道这是否是一种好的编程习惯。

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T13:36:30.913

我曾经继承过这样的网站。写它的人一定是个受虐狂。

**这是一种设计网站的可怕方式。** 何时显示/隐藏内容、何时处理来自哪些字段的输入的复杂性太多了。维护变得不可能，因为一个微小的修改可能会产生可怕的后果。

更好的方法是将常见行为隔离到单个页面中。如果该页面很复杂，则取该页面的核心部分并将其制成用户控件。将 UI 分解为逻辑部分，然后在页面上将它们拼凑在一起。

您的页面代码应该非常简单。隐藏/显示特定字段的逻辑是业务逻辑，应尽可能用代码表达。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T13:37:00.350

我不是一个网络开发者，但我知道这在桌面应用程序世界中会被认为是非常糟糕的做法，我真的怀疑它在网络世界中有很大的不同。

考虑在发生特定操作时仅启用和禁用相关控件，可能使用更多 MVC（或者现在是 MVVM？）方法。您朋友的应用程序逻辑与表示逻辑紧密耦合，因此如果需要更改其中任何一个，可能会在整个系统中产生连锁反应。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T13:45:20.190

我从未听说过在使用 Web 控件时解析表单 post 值。当我使用传统的 ASP 时，那将是我的毒药，但对于 Web 控件则不然。

至于将大量功能包装到一个页面中，这可能是个坏主意。拥有用户控件对于对相关 UI 功能块进行分组，甚至对于隐藏一个部分是有意义的，但对于拉入和拉出整个“页面”而言，意义不大。只是有不同的页面。

此外，如果在同一个页面中混合如此多的功能的原因是使用相关代码，那么将相关代码移动到所有代码隐藏都可以使用的库中。回到用户控件，将它们用于重复出现的 UI 元素，这些元素可以在任何页面中使用。

# asp.net - 使用 [WebMethod] 转义 JSON 响应

> ID：811353
> 
> 赞同：4
> 
> 时间：2009-05-01T13:32:32.017
> 
> 标签：asp.net, web-services, json, asmx

以下代码的 JSON 响应被错误地转义，如下所述。

我的网络方法是这样的：

```
 [WebMethod (Description="doc here")]
    [ScriptMethod(ResponseFormat=ResponseFormat.Json)] 
    public string responseMyObject() {
            if (!Setup()) return "";

            ...
            Proxy pu = new Proxy(...);
...

            string toReturn = JavaScriptConvert.SerializeObject(pu.getMyObject());
            Console.WriteLine(toReturn);
            return toReturn;
    } 
```

从控制台我得到：

```
{"field1":vaule1,"field2":value2} 
```

来自 JS：

```
$.ajax({
    type: "POST",
    url: "/myapi/myClass.asmx/responseMyObject",
    data: "{}",
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: function(msg) {
                    var object = msg.d;
                    alert(object.field1);
    }
}); 
```

问题是在 HTTP 响应标头中，我可以看到 JSON 响应错误地（？）以下列方式转义：

```
{"d":"{\"field1\":value1,\"field2\":value2}"} 
```

奇怪的是控制台打印很好（但还没有封装在 {d: ...}

```
{"field1":value1,"field2":value2} 
```

使用类似的代码，如果我调用返回基本类型（无对象）的 [WebMethod]，则 JSON 响应是可以的。喜欢：

{“d”：8080}

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T13:51:12.330

```
[WebService]
[ScriptService]
public class MyWebService : WebService
{    

  [WebMethod (Description="doc here")]    
  [ScriptMethod( UseHttpGet=false, ResponseFormat=ResponseFormat.Json)]     
  public MyObjectType responseMyObject() 
  {
      Proxy pu = new Proxy(...);

      return pu.GetMyObject();
  }

} 
```

您不需要 JSON 序列化程序，使用 ScriptService 属性对其进行标记使其能够序列化 JSON。您正在对 JSON 进行预序列化，然后再次对其进行序列化:(

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T13:43:55.203

为什么要调用 JavaScriptConvert.SerializeObject？

您不能将方法的返回类型更改为 pu.getMyObject() 返回的类型，然后框架将完成其余的工作吗？

换句话说...

```
[WebMethod (Description="doc here")]    
[ScriptMethod(ResponseFormat=ResponseFormat.Json)]     
public MyObjectType responseMyObject() 
{
    Proxy pu = new Proxy(...);

    ...

    return pu.GetMyObject();
} 
```

目前我认为您正在将您的对象序列化为 JSON 格式，然后，当您从该方法返回时，框架正在将该字符串（包含 JSON 格式的数据）序列化为 JSON 格式。

# language-agnostic - 属性和实例变量有什么区别？

> ID：811354
> 
> 赞同：8
> 
> 时间：2009-05-01T13:32:52.077
> 
> 标签：language-agnostic, properties, instance-variables, glossary

我想我一直在互换/错误地使用这些术语！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-01T13:38:31.783

Iain，这基本上是一个术语问题，尽管与此问题相关的“语言不可知”标签，但与语言/环境非常相关。

为了设计讨论，属性和实例变量可以互换使用，因为这个想法是属性是描述对象的数据项。

在谈论特定语言时，这两者可能会有所不同。例如，在 C# 中，属性实际上是返回对象的函数，而实例变量是类的非静态成员变量。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T14:37:45.183

Hershi 认为这是特定于语言的，这是正确的。但要添加到语言特定答案的线索：

在python中，实例变量是实例的属性，（通常）在实例的字典中引用的东西。这类似于 Java 中的成员或实例变量，除了一切都是公共的。

属性是 getter/setter 方法的快捷方式，*看起来就像一个实例变量*。因此，在以下类定义中（根据 Guido 的[新样式对象 manifesto](http://www.python.org/download/releases/2.2.3/descrintro/)修改）：

```
class C(object):

    def __init__(self):
        self.y = 0

    def getx(self):
        if self.y < 0: return 0
        else: return self.y

    def setx(self, x):
        self.y = x

    x = property(getx, setx)

>>> z = C()
>>> z.x = -3
>>> print z.x
0
>>> print z.y
-3
>>> z.x = 5
>>> print z.x
5
>>> print z.y
5 
```

`y`是 的实例变量`z`，`x`是属性。（通常，在定义属性的地方，有一些技术用于隐藏关联的实例变量，以便其他代码不会直接访问它。）python 中属性的好处是设计者不必四处走动抢先封装所有实例变量，因为将来通过将实例变量转换为属性的封装不应破坏任何现有代码（除非代码利用您的封装试图修复的漏洞，或依赖类检查或其他一些元数据-编程技术）。

所有这些都是一个很长的答案，说在设计层面，谈论属性是件好事。您可能需要执行哪种类型的封装是不可知的。我想这个原则与语言无关，但确实适用于 python 之外的语言。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-01T18:33:53.850

在目标 c 中，属性是一个实例变量，它可以利用重载的点运算符来调用它的 setter 和 getter。所以 my.food = "cheeseburger" 实际上被解释为 [my setFood:"cheeseburger"]。这是另一种定义绝对与语言无关的情况，因为objective-c 定义了@property 关键字。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-01T13:35:07.423

用 C# 完成的代码示例

```
public class ClassName
{
   private string variable;

   public string property
   {
      get{ return variable; }
      set { variable = value; }
   }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T13:48:15.363

也许那是因为你最初来自 C++ 对吧？！在我的学生时代，我有教授一直在说班级属性或班级属性。自从我进入 Java C# 世界以来，我开始听到有关成员的消息。类成员、实例成员...

然后属性出现！在 Java 和 .NET 中。所以我认为你最好称它为成员。无论它们是实例成员（或者你称之为实例变量）还是类成员......

干杯!

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-01T14:05:17.833

一个属性可以，我想大多数情况下，返回一个实例变量，但它可以做更多的事情。您可以将逻辑放在属性中，聚合值或更新其他实例变量等。我认为最好避免这样做。逻辑应该进入方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-01T13:41:28.000

在 Java 中，我们有一个叫做[JavaBeans Properties](http://java.sun.com/docs/books/tutorial/javabeans/properties/index.html)的东西，但这基本上是一个实例变量，它的 getter 和 setter 遵循一定的命名模式。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-01T13:42:35.737

另外，在像 C# 这样的语言中，属性本质上是一个 get 和 set 函数。因此，除了获取/设置之外，它还可以具有运行的自定义逻辑。实例变量无法做到这一点。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-01T14:22:37.183

属性是与对象关联的某种数据。例如，圆的一个属性是它的直径，另一个是它的面积。

实例变量是存储在对象中的一段数据。它不一定需要直接与属性对应。例如（呵呵），圆可以将其半径存储在实例变量中，并根据该半径计算其直径和面积。这三个仍然是属性，但只有半径存储在实例变量中。

某些语言具有“一流”属性的概念。这意味着对于客户端应用程序，该属性看起来和使用起来就像一个实例变量。也就是说，不是写类似的东西，而是`circle.getDiameter()`写`circle.diameter`，而不是写，而不是`circle.setRadius(5)`写`circle.radius = 5`。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-01T17:06:08.070

与给出的其他答案相比，我*确实*认为成员变量和与语言无关的属性之间存在有用的区别。

这种区别在面向组件的编程中最为明显，它在任何地方都很有用，但在图形 UI 中最容易理解。在这种情况下，我倾向于将组件的设计时配置视为操纵对象的“属性”。例如，我通过设置文本输入字段的属性来选择文本输入字段的前景色和背景色、边框样式和字体。虽然这些属性*可以*在运行时更改，但通常不会。在运行时，代表字段内容的一组不同的变量更有可能被读取和写入。我将此信息视为组件的“状态”。

为什么这种区分有用？在创建将组件连接在一起的抽象时，通常只需要公开“状态”变量。回到文本字段示例，您可以声明一个提供对当前内容的访问的接口。但是控制组件外观和感觉的“属性”只定义在具体的实现类上。

# c++ - 在 C++ 中设置 FourCC 值

> ID：811361
> 
> 赞同：6
> 
> 时间：2009-05-01T13:34:36.630
> 
> 标签：c++, fourcc

我想在 C++ 中设置一个[FourCC](http://en.wikipedia.org/wiki/FourCC)值，即一个无符号的 4 字节整数。

我想显而易见的方法是#define，例如

```
#define FOURCC(a,b,c,d) ( (uint32) (((d)<<24) | ((c)<<16) | ((b)<<8) | (a)) ) 
```

接着：

```
uint32 id( FOURCC('b','l','a','h') ); 
```

你能想到的最优雅的方式是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-01T13:41:07.737

您可以使用以下方法使其成为编译时常量：

```
template <int a, int b, int c, int d>
struct FourCC
{
    static const unsigned int value = (((((d << 8) | c) << 8) | b) << 8) | a;
};

unsigned int id(FourCC<'a', 'b', 'c', 'd'>::value); 
```

通过一些额外的努力，您可以在编译时检查传入的每个数字是否在 0 到 255 之间。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-01T14:46:38.903

```
uint32_t FourCC = *((uint32_t*)"blah"); 
```

为什么不是这个？

编辑：int-> uint32_t。

不，它不会将 char** 转换为 uint32_t。它将 (char*) 转换为 (uint32_t*)，然后取消引用 (uint32_t*)。不涉及字节序，因为它将 uint32_t 分配给 uint32_t。唯一的缺陷是对齐方式，并且我没有明确指出 32 位类型。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-12-15T11:36:36.613

通过使用 C++11 constexpr，您可以编写如下内容：

```
constexpr uint32_t fourcc( char const p[5] )
{
    return (p[0] << 24) | (p[1] << 16) | (p[2] << 8) | p[3];
} 
```

然后将其用作：

```
fourcc( "blah" ); 
```

优点：

*   更具可读性，
*   如果字符串参数在编译时已知，则函数在编译时进行评估（无运行时开销）。
*   不依赖于字节序（即参数的第一个字符将始终位于fourcc 的最高有效字节中）。

缺点：

*   需要 c++11（或更高版本）编译器。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-01T13:37:56.620

或者对内联函数做同样的事情

```
inline uint32_t FOURCC(uint8_t a, uint8_t b, uint8_t c, uint8_t d)
{
     return ( (uint32) (((d)<<24) | (uint32_t(c)<<16) | (uint32_t(b)<<8) | uint32_t(a)) )
} 
```

并避免宏的头痛，但否则你的方法对我来说看起来不错。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-01T14:00:37.767

如果我没记错的话，您可以只使用多字符字符常量，对吗？

```
unsigned int fourCC = 'blah'; 
```

这在 ANSI/ISO 规范中是完全有效的，尽管有些编译器会抱怨一点。这就是过去在旧版 Macintosh API 中处理资源类型的方式。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-01T13:37:55.933

我认为您的算法没有任何问题。但是对于这样的事情，我只会写一个函数而不是宏。宏有很多隐藏的功能/问题会随着时间的推移而困扰您。

```
uint FourCC(char a, char b, char c, char d) { 
  return ( (uint32) (((d)<<24) | ((c)<<16) | ((b)<<8) | (a)) );
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-01T14:07:02.197

假设 Windows（因为 FOURCC 是一个 Windows 概念），Win API 已经提供了[mmioStringToFOURCC](http://msdn.microsoft.com/en-us/library/ms712189(VS.85).aspx)和[mmioFOURCC](http://msdn.microsoft.com/en-us/library/ms712167(VS.85).aspx)。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-01T14:26:21.013

如果不需要编译时常量，也许最简洁的是

```
unsigned int FourCCStr(const char (&tag)[5])
{
    return (((((tag[3] << 8 ) | tag[2]) << 8) | tag[1]) << 8) | tag[0];
}

#define FOURCC(tag) FourCCStr(#tag)

unsigned int id(FOURCC(blah)); 
```

这仅根据需要接受四个字符的标签。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-01T13:38:13.780

而不是#define，我可能会放置几乎相同的代码并依赖编译器来内联它。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-08-22T13:34:01.307

怎么样：

```
#if BYTE_ORDER == BIG_ENDIAN
#define FOURCC(c0,c1,c2,c3) ((uint32) ((((uint32)((uint8)(c0)))<<24) +(((uint32)((uint8)(c1)))<<16)+ (((uint32)((uint8)(c2)))<<8) + ((((uint32)((uint8)(c3)))))) 
#else
#if BYTE_ORDER == LITTLE_ENDIAN
#define FOURCC(c3,c2,c1,c0) ((uint32) ((((uint32)((uint8)(c0)))<<24) +(((uint32)((uint8)(c1)))<<16)+ (((uint32)((uint8)(c2)))<<8) + ((((uint32)((uint8)(c3)))))) 
#else
#error BYTE_ORDER not defined
#endif
#endif 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-12-21T04:24:11.587

如今，使用 constexpr 和 c++17 有更好的解决方案（可能更早，不确定）。我不确定它是否完全跨平台，但它适用于 Visual Studio 和 XCode。

首先，您需要一个包装函数来将函数转换为编译时值：

```
template <class TYPE, TYPE VALUE> constexpr TYPE CompileTimeValue() { return VALUE; } 
```

然后你需要一个 constexpr 函数将短字符串转换为整数：

```
template <class UINT, UInt32 IS_LITTLE_ENDIAN> constexpr UINT MakeCCFromNullTerminatedString(const char * string)
{
    UINT cc = 0;

    UINT shift = 1;

    if (IS_LITTLE_ENDIAN)
    {
        shift = (sizeof(UINT) == 8) ? (0xFFFFFFFFFFFFFFull + 1) : 0xFFFFFF + 1;
    }

    while (UINT c = *string++)
    {
        c *= shift;

        cc |= c;

        if (IS_LITTLE_ENDIAN)
        {
            shift /= 256;
        }
        else
        {
            shift *= 256;
        }
    }

    return cc;
} 
```

然后包装在宏中，同时拥有 4 字节和 8 字节字符常量，以及小端和大端变体（如果你愿意的话）......

```
#define ID32(x) CompileTimeValue<UInt32,MakeCCFromNullTerminatedString<UInt32,0>(x)>() 
#define ID64(x) CompileTimeValue<UInt64,MakeCCFromNullTerminatedString<UInt64,0>(x)>()
#define CC32(x) CompileTimeValue<UInt32,MakeCCFromNullTerminatedString<UInt32,1>(x)>()
#define CC64(x) CompileTimeValue<UInt64,MakeCCFromNullTerminatedString<UInt64,1>(x)>() 
```

一些测试来验证..

```
ASSERT(CC32("test") == 'test');

UInt32 v = CC32("fun");

UInt32 test;

switch (v)
{
case CC32("fun"):
    test = 1;
    break;

case CC32("with"):
    test = 2;
    break;

case CC32("4ccs"):
    test = 3;
    break;
} 
```

未完成边界溢出检查，但可能可以添加编译时断言。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-05-01T15:51:30.713

```
uint32 fcc(char * a)
{   
    if( strlen(a) != 4)
        return 0;       //Unknown or unspecified format

    return 
    (
            (uint32) 
            ( 
                ((*(a+3))<<24) |
                ((*(a+2))<<16) |
                ((*(a+1))<<8) | 
                (*a)
            )       
    );
} 
```

# apache-flex - Flex：当数据提供者更新时，组合框失去焦点？

> ID：811363
> 
> 赞同：1
> 
> 时间：2009-05-01T13:35:02.243
> 
> 标签：apache-flex

似乎 ComboBox 在其 dataProvider 更新后会丢失其选定项，即使相同的选定项仍在 dataProvider 中。它们转换回被选中的第一个项目。有没有办法防止这种情况发生？因此，如果相同的对象在 dataProvider 中，它会保持相同的对象被选中，并且只有在所选对象不在更新的 dataProvider 中时才恢复到第一个索引？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T14:16:39.007

如果 ComboBox 丢失其选定项，则意味着 dataProvider 未更新 - 它已被替换。如果将 ComboBox 绑定到 ArrayCollection，然后将项目添加到 AC，则 ComboBox 会更新而不会丢失其 selectedItem。

有时您必须替换 dataProvider，在这种情况下，您必须侦听 updateComplete-event 并重置 selectedItem。你可以试试这段代码：

```
<mx:Script>
    <![CDATA[
        import mx.controls.ComboBox;
        import mx.events.ListEvent;
        import mx.events.FlexEvent;
        import mx.collections.ArrayCollection;

        [Bindable]
        private var dp:ArrayCollection = new ArrayCollection(["Item 1", "Item 2", "Item 3"]);

        private var selectedItem:*;
        private var dataProvider:*;

        private function onChange(event:ListEvent):void {
            selectedItem = (event.currentTarget as ComboBox).selectedItem;
        }
        private function onUpdateComplete(event:FlexEvent):void {
            trace(event);
            var cb:ComboBox = event.currentTarget as ComboBox;
            if(dataProvider == null || cb.dataProvider != dataProvider) {
                if(selectedItem != null && cb.selectedItem != selectedItem) cb.selectedItem = selectedItem;
                if(cb.selectedIndex < 0) cb.selectedIndex = 0;
                dataProvider = cb.dataProvider;
            }
        }

        private function extendDP():void {
            dp.addItem("Item " + (dp.length +1));
            var ac:ArrayCollection = new ArrayCollection(dp.source);
            dp = ac;
        }

        private function reduceDP():void {
            dp.removeItemAt(dp.length -1);
            var ac:ArrayCollection = new ArrayCollection(dp.source);
            dp = ac;
        }
    ]]>
</mx:Script>

<mx:VBox>
    <mx:ComboBox dataProvider="{dp}" change="onChange(event)" updateComplete="onUpdateComplete(event)" />
    <mx:Button label="Extend dp" click="extendDP()" />
    <mx:Button label="Reduce dp" click="reduceDP()" />
</mx:VBox> 
```

它创建一个 ComboBox 并将其绑定到 ArrayCollection。这两个按钮添加和删除集合中的项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T14:06:14.213

好吧，我能够用这个类扩展 ComboBox，它只查找选定的标签并与来自新 dataProvider 的标签进行比较。它似乎工作，虽然有点临时。我希望有一个可扩展的解决方案。

```
package
{
    import mx.controls.ComboBox;
    import mx.collections.ArrayCollection;

    public class SelectionKeepingComboBox extends ComboBox
    {
        public function SelectionKeepingComboBox()
        {
            super();
        }

        override public function set dataProvider(value:Object):void
        {
            var curSelectedLabel:String;
            if(this.selectedItem)
            {
                curSelectedLabel = this.selectedLabel;
            }

            super.dataProvider = value;

            if(curSelectedLabel == null)
            {
                return;
            }

            var dp:Array;
            if(this.dataProvider is ArrayCollection)
            {
                dp = this.dataProvider.toArray();
            }
            else
            {
                dp = this.dataProvider as Array;
            }
            for(var i:uint = 0; i<dp.length; i++)
            {
                var obj:Object = dp[i];
                var dpLabel:String = obj.label;
                if(dpLabel == curSelectedLabel)
                {
                    this.selectedItem = obj;
                }   
            }
        }

    }
} 
```

# wxwidgets - XRCed 学习资源？

> ID：811378
> 
> 赞同：0
> 
> 时间：2009-05-01T13:37:59.850
> 
> 标签：wxwidgets, xrc

我见过很多人说[XRCed](http://xrced.sourceforge.net/)非常强大，“如果你学会了如何使用它”。不幸的是，关于它的文档很少，现在SF.net主页上的许多链接都是404。

我能找到的最好的是[XRCed Tutorial](http://wiki.wxpython.org/XRCed%20Tutorial)，但是它太原始了 - 那么，有人知道我在哪里可以找到更好的文档吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-06T05:29:16.613

只是一个建议；你试过[wxFormBuilder](http://wxformbuilder.org/)吗？XRCed 似乎有点过时了（有一段时间没有更新了），它和 wxFB 做的事情是一样的。我在几个项目中使用 wxFB 已经有一段时间了，它可以挽救生命。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T11:30:12.347

除了已经提到的 wxFormBuilder，我[还将加入 wxGlade](http://wxglade.sourceforge.net/)。虽然我更喜欢 wxFormbuilders GUI，但我发现可用的小部件缺少它。所以我根据它提供的小部件数量转移到 wxGlade。

两者都可以创建 XRC 文件（以及其他一些代码，如 C++ 和 python），我认为两者都得到了积极维护。我认为 XRCed 自 2007 年以来就没有更新过。

为了便于使用，我会选择 wxFormBuilder。如果您想使用各种不同的小部件，目前，请使用 wxGlade。我不知道 wxFormbuilder 是否计划在他们未来的版本中加入 ToggleButtons 等。它不在我正在使用的那个...

# ms-access - 在我的应用程序中使用 Microsoft Access

> ID：811386
> 
> 赞同：-1
> 
> 时间：2009-05-01T13:40:07.253
> 
> 标签：ms-access, mfc

我正在编写一个使用 Microsoft Access 存储数据的 C++/MFC 应用程序。我希望使用它会适合我的目的：以小、轻量级的方式来保存应用程序的数据。

我问自己的问题是：如果我使用 Access 作为 DB，客户端的机器是否需要安装 Microsoft Access 才能使用我的软件？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T13:43:38.633

您只是想使用 Access 文件 (*.mdb)，还是想在您的应用程序中嵌入 Access Active Object？

如果您只想使用它的文件格式，则只需要安装 ODBC 驱动程序，而不是整个应用程序。

但是，如果您想使用 ActiveX 将 Access UI 嵌入到您的应用程序中，则需要安装完整的 Access。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T13:49:47.497

通过 Wikipedia 上的[Microsoft 数据访问组件页面](http://en.wikipedia.org/wiki/Microsoft_Data_Access_Components#Which_Version_do_I_have.3F)，它在表中指出，从 Windows 2000 的初始版本开始，默认包含 Microsoft Access 的[ODBC 驱动程序。](http://en.wikipedia.org/wiki/Odbc#Microsoft_ODBC)换句话说，您应该可以放心地假设您的程序现在在任何 Windows PC 上读取 MS Access 数据库都没有问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T20:56:02.527

这里的问题是混杂使用“Access”来表示“Jet MDB”。如果你有一个*Access*数据库，它就是一个 Access 应用程序，带有 UI 对象（表单/报告/等），要运行它，你必须安装 Access 或 Access 运行时。

不过，很明显，您只是在使用 Jet MDB 来存储数据，在这种情况下，从 2000 年开始，您需要的所有东西都已经安装在每个版本的 Windows 上，因为 Jet 是作为操作系统的一部分安装的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T13:49:58.590

Francis 是正确的，但是您可能想看看更强大的数据库选择。 [SQLite](http://www.sqlite.org/ "SQLite")、[SQL Server Compact Edition](http://www.microsoft.com/Sqlserver/2008/en/us/compact.aspx "SQL Server 精简版")或[Firebird](http://www.firebirdsql.org/ "火鸟")都是 MS Access 的良好替代品，可满足简单、轻量级、简单的 RDBMS 需求。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T13:50:42.020

您不需要 Access 来使用 Access 数据库 - 您可以为此使用 ODBC。但是，如果您也在考虑 XML，我建议您没有对您试图解决的问题进行足够深入的分析 - XML 和 Access 等数据库几乎没有任何共同点。

# visual-studio-2008 - TFS 自定义 - Team Foundation Server 问题

> ID：811388
> 
> 赞同：3
> 
> 时间：2009-05-01T13:40:41.357
> 
> 标签：visual-studio-2008, notificationservices

我们有一个流程，当开发人员更改或添加数据库脚本并将其签入项目时。在部署时，发布管理器需要知道哪些工作项已针对它签入了数据库脚本。有没有一种方法可以让我们在 TFS 中查询或创建自定义报告，以获取在变更集中具有特定文件扩展名 (.sql) 的文件的工作项列表。这样，发布经理将获得一份工作项列表，然后她可以将这些工作项提供给 DBA 进行分析、检查并应用于服务器。

我们正在使用 TFS 2008。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-06T22:23:25.120

安装最新的电动工具。然后你可以运行这个快速的 Powershell 脚本：

```
Get-TfsItemHistory $/project/*.sql -r -version D6/1/2009~ | 
    %{ $_.workitems } | %{ $_.id } | select -unique | sort 
```

（根据需要调整项目名称和日期）

虽然这对于人工辅助代码审查非常有用，但我强烈警告不要使用它来实际构建部署脚本。如果开发人员忘记将他的签入与工作项相关联，或者如果他之前签入了他的错误修复所依赖的 SQL 文件，那么您将推出一组不一致的更改。最好让您在测试环境中使用的部署脚本尽可能地匹配您的生产部署。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-07T00:27:13.717

您是否查看过新的[GDR R2 数据库项目](http://www.microsoft.com/downloads/details.aspx?FamilyID=bb3ad767-5f69-4db9-b1c9-8f55759846ed&displaylang=en)（Visual Studio 2008 团队版的免费下载）？

这种类型的项目最初是 Visual Studio 数据库版本的一部分。

它能够从现有数据库中导入模式、执行模式比较、支持多个目标（系统测试、UAT、生产等）、执行 TSQL 静态代码分析以及生成独立的部署工件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T18:54:14.353

我不是报告作者，但我认为您可能可以从 tfswarehouse 生成自定义报告，您可以在其中过滤扩展。但这只是一个假设。

也许您可以编写一个自定义签入策略，根据文件扩展名向适当的人发送电子邮件。这似乎是使用策略的一种非常繁重且不恰当的方式，但它可能会起作用。

只是一些没有可验证数据支持的想法。:D

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-08T14:49:29.877

您可以利用构建事件并让它指向您的自定义 Web 服务，该服务可以检查应用的变更集列表。这可以反过来对 TFS 进行查找以获取文件名，然后可以生成工作项。这意味着对 TFS API 的了解，但它们是不言自明的。这些事件是通过警报编辑器配置的，我相信它是 TFS 电动工具的一部分。我现在有这样的东西，它可以汇总已完成的工作并更新我们的外部时间跟踪系统。

# asp.net - 为什么 IIS7 将特定的 XHTML 页面视为 XML 页面？

> ID：811391
> 
> 赞同：1
> 
> 时间：2009-05-01T13:41:18.703
> 
> 标签：asp.net, iis

当我尝试访问一个页面时，出现如下错误，但我可以查看完整的源代码，**源代码没有问题**，我不知道为什么 IIS7 告诉我的浏览器 XHTML 页面是 XML？（不是我的浏览器的问题，因为我让我的朋友测试，他得到了同样的结果）

> XML 解析错误：格式不正确 位置： [http](http://www.xxxx.com/xxx.htm) : //www.xxxx.com/xxx.htm 第 44 行，第 239 列：

奇怪的是，重新启动 IIS7 后，该页面再次运行良好，但可能几个小时后，另一个页面会得到完全相同的错误。这个问题让我抓狂...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T13:50:58.697

XHTML*是*XML。这就是重点。它应该`application/xhtml+xml`由网络服务器发送，但如果 IE 遇到该内容类型，它仍然会抛出一个合适的。然而，这是网络服务器发送 XHTML 数据的正确方式。

如果您的 XHTML 文件不能被解析为有效的 XML，那么它也不是有效的 XHTML，并且与 HTML 不同，浏览器会产生错误，就像您看到的那样。XHTML 标准要求它这样做，而不是像 HTML 解析器那样尝试解释一些格式错误的标签汤。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-19T16:50:50.930

进入 INETMGR 中的 mime-types 部分并将 .xhtml 添加为 application/xhtml+xml 这是 IIS 将使用该文件类型提供的正确 mime-type，否则它会提取注册表中配置的任何内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-19T22:54:47.520

您遇到的问题听起来像是您的 Web 服务器正在将您的 XHTML 页面作为 XML 提供，但您的页面没有被验证为 XML。换句话说，您有一段违反 XML 规则的网页代码，例如缺少结束标记、错误属性等。

上面所有的海报都是正确的......如果你使用 XHTML，它应该作为 XML 交付。但是，如果您想删除错误，并且无法修复网页，您唯一的选择是删除在您的 Web 服务器中作为 XML 设置发送的 XHTML。

# asp.net - 授权问题 - 匿名用户无法访问 .jpeg 或 .css

> ID：811396
> 
> 赞同：7
> 
> 时间：2009-05-01T13:42:19.793
> 
> 标签：asp.net, forms, forms-authentication

我的 web.config 文件中有这个：

```
<authentication mode="Forms">
      <forms loginUrl="login.aspx" defaultUrl="Venues.aspx" />
    </authentication>
    <authorization>
      <deny users="?" />
      <allow users="*" />
</authorization> 
```

我只想允许经过身份验证的用户访问我的页面。问题是，我第一次进入登录页面时，我的页面上没有任何图像或样式。我认为这是因为我拒绝访问`.jpeg`and`.css`文件。我想我可以在 IIS 中解决这个问题，但我只是在 Dev 中。我只有VS 2008，没有IIS。

我是否可以允许访问`imgs`web.config 中匿名用户的目录？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-01T13:53:39.233

您可以允许某些目录（直接在 下`<configuration>`）：

```
<location path="images">
    <system.web>
        <authorization>
            <allow users="?"/>
        </authorization>
    </system.web>
</location> 
```

此外，您可能需要包括 WebResource.axd

```
<location path="WebResource.axd">
    <system.web>
        <authorization>
            <allow users="?"/>
        </authorization>
    </system.web>
</location> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T13:53:19.343

我认为这是 Visual Studio 中的一个已知错误 - 当您不使用 IIS 时，Visual Studio 会错误地阻止登录页面上的 CSS 文件。

请参阅此处：
[来自 tomtech999 的博客文章](http://tomtech999.wordpress.com/2006/06/28/advanced-forms-authentication/)

在 IIS 中运行时应该没问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-10-25T23:00:35.820

同样，如果您希望 Microsoft 的 ReportViewer 控件在您的网页上工作，您需要添加以下内容：

```
<location path="Reserved.ReportViewerWebControl.axd">
  <system.web>
    <authorization>
      <allow users="*"/>
    </authorization>
  </system.web>
</location> 
```

在尝试让 2010 版报表查看器工作时，这对我来说是个问题。（幸运的是，只用了 70 亿年才发现问题的根源。）

# c# - 带有可删除元素的 C# 堆栈

> ID：811400
> 
> 赞同：1
> 
> 时间：2009-05-01T13:42:29.323
> 
> 标签：c#, .net, data-structures

我需要一个还允许删除元素的堆栈结构。我在 .Net 框架中找不到类似的东西。哪种结构为我实现这一点提供了最好的基础？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-01T13:46:17.427

我会使用 LinkedList，因为它具有 AddFirst（Push）和 RemoveFirst（Pop）的方法。但是它也有一个简单的 Remove 方法，可以用来在中间删除。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T13:46:17.380

也许一个`LinkedList<T>`？不过，您必须自己包装它才能将其视为`Stack<T>`。当然，你可以只使用`List<T>`- 但你必须承担从中间删除的成本......

就像是：

```
using System;
using System.Collections.Generic;
class MyStack<T> {
    private readonly LinkedList<T> list = new LinkedList<T>();
    public void Push(T value) {
        list.AddLast(value);
    }
    public int Count { get { return list.Count; } }
    public T Pop() {
        LinkedListNode<T> node = list.Last;
        if(node == null) throw new InvalidOperationException();
        list.RemoveLast();
        return node.Value;
    }
    public bool Remove(T item) {
        return list.Remove(item);
    }
} 
```

使用您需要的任何其他方法/同步/等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T13:45:15.743

```
System.Collections.Generic.List<T> 
```

或者

```
System.Collections.Generic.LinkedList<T> 
```

视情况而定。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T13:45:59.317

好吧，任何类似列表的结构都可以用作堆栈。您只需将项目推到最后即可。

如果需要删除堆栈中间的项目，可以使用内置的泛型 List 的 RemoveAt()。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T13:48:15.363

删除元素是指删除不在堆栈顶部的项目吗？

一种方法是使用列表，然后使用扩展方法来实现类似堆栈的行为（在记事本中编码，对任何小错误深表歉意）。然后您还可以进行特殊处理（如果列表为空，您可能想返回 null 或抛出异常，可能您想确保该项目不在列表中，等等。

```
public static void Push<T>(this IList<T> list, T item)
{
    list.InsertAt(0, item);
}

public static T Pop<T>(this IList<T> list)
{
    if(list.Count > 0)
    {
        T value = list[0];
        list.RemoveAt(0);
        return value;
    }
    // handle error
} 
```

# php - 如何缩短 URL 查询参数？

> ID：811403
> 
> 赞同：1
> 
> 时间：2009-05-01T13:43:03.037
> 
> 标签：php, friendly-url

我的脚本正在生成一个很长的 URL，就像下面的一样，我想知道如何使用算法或技术来缩短它？

这是长 URL： [http ://example.com/script.php?param1=value1¶m2=value2¶m3=value3¶m4=value4¶m5=value5](http://example.com/script.php?param1=value1&param2=value2&param3=value3&param4=value4&param5=value5)

我想把它缩短成这样： [http ://example.com/script.php?p=430x2920](http://example.com/script.php?p=430x2920)

如何在不缓存数据库的原始链接的情况下做到这一点？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T13:45:02.110

将静态值添加到`$_SESSION[]`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T14:00:14.150

您可以使用 post 作为您的值。但是，如果您真的需要 url 中的所有信息，我认为您应该开始实施 url 重写......[这](http://www.webconfs.com/url-rewriting-tool.php)是重写的开始。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T14:01:44.847

如果您不想使用数据库来存储缩短（散列）URL 的查找表，那么您必须设计某种函数来将缩短的 URL 转换为全长 URL。

换句话说，您的完整 URL 必须具有可以压缩成较短的属性。

例如我可以压缩以下 URL

`http://example.com/script.php?param1=saffron&param2=sierra&param3=4`

进入

`http://example.com/script.php?p=p1.sa_p2.si_p3:4`

如果我知道 param1 和 param2 只接受某些关键字，而 param3 只接受数字。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T14:17:30.223

您总是可以只使用带有分隔符的单个参数，然后将其拆分回代码中。

[http://example.com/script.php?p=1x2x3x4x5](http://example.com/script.php?p=1x2x3x4x5)

用 x 或任何你想要的不是作为分隔符的可能值的一部分。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T13:58:02.530

*   使用[RESTful](http://en.wikipedia.org/wiki/Representational_State_Transfer)接口，而不是一堆查询参数。

*   存储将在服务器上的会话中持续存在的值，由会话 cookie 键入。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T14:02:08.137

计算出完整的可能值集，并提出一种编码/解码它们的双向算法。

例如，如果您有 3 个参数并且它们只是单个数字整数，那么您可以使用 ?123 代替 ?param1=1¶m2=2¶m3=3 并将查询字符串按每个字符拆分以获取每个参数。

不过，这有多大可能完全取决于您期望什么样的值。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-01T17:32:28.383

我通常会做这样的事情来减少参数：

你的链接：

```
http://example.com/script.php?param1=value1&param2=value2&param3=value3&param4=value4&param5=value5 
```

我最喜爱的：

```
http://example.com/script.php?params=value1,value2,value3,value4,value5 
```

或 [http://example.com/script.php?params=value1|value2|value3|value4|value5](http://example.com/script.php?params=value1|value2|value3|value4|value5)

# vba - 从粘贴的文本中删除¶（pilcrow）

> ID：811404
> 
> 赞同：2
> 
> 时间：2009-05-01T13:43:25.203
> 
> 标签：vba, string, text, character-encoding, carriage-return

用户正在将 Lotus Notes 中的文本粘贴到我的 VBA 应用程序中。然后将其存储在 Access 中。有时粘贴的文本包括我假设的回车，当粘贴到单行表单控件中时，在应用程序的表单中显示为¶。

但是，由于这不会粘贴到 VBE，我无法将其添加到我的 SQL 事务非法字符列表中。我尝试过陷印`Chr(10)`，`Chr(13)`甚至是 pilcrow 符号`Chr(182)`，但没有任何东西可以检测和删除这个字符。

除此之外，该符号不会引起任何问题，它只是一个显示的东西。

有什么办法可以检测到这个字符并将其从字符串中剥离？

编辑：我已经做了一些测试，并让应用程序告诉我最右边字符的字符代码是什么，并确认它是`Chr(10)`- 将尝试不同的策略并将其作为例外处理。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T14:10:37.103

将此作为正常字符串清理的例外处理，并从任何字符串中修剪掉 CR/LF。最后比我想象的要简单，但它确实让我难倒了一段时间。

# asp.net-mvc - 尝试使用 TeamCity 构建 asp.net mvc Web 应用程序时出错

> ID：811417
> 
> 赞同：16
> 
> 时间：2009-05-01T13:46:13.620
> 
> 标签：asp.net-mvc, msbuild, teamcity

我有一个正在开发的 Asp.Net MVC Web 应用程序。我在我的开发工作站上安装了 TeamCity，并且一直在运行 CI 构建。一切正常。我想将 TeamCity 从我的机器上移到刚刚交付的新开发/构建服务器上。我不想将 Visual Studio 安装到构建服务器上。但似乎 msbuild 无法构建 Web 应用程序项目。

> E:\TeamCity\buildAgent\work\48e528785fe346fa\src\Web\Web.csproj(489, 11): 错误 MSB4019: 导入的项目 "C:\Program Files\MSBuild\Microsoft\VisualStudio\v9.0\WebApplications\Microsoft .WebApplication.targets”未找到。确认声明中的路径正确，并且该文件存在于磁盘上。

我在谷歌上找到了一些点击，但没有什么可以接受的。建议要么安装 Visual Studio，要么将某些目录从 Visual Studio 复制到服务器等。

我可以做些什么来让 TeamCity 在开发/构建服务器上构建我的项目。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-01T13:49:20.853

看起来复制文件[肯定会奏效](http://social.msdn.microsoft.com/Forums/en-US/tfsbuild/thread/db5d2ec9-ee15-4de3-abe6-688d81a36461)。你试过了吗？将 .targets 文件视为 MSBuild 将如何工作的一系列定义。

# c# - VB 中的预格式化文本-vb 中的 C#@ 等价物是什么？

> ID：811422
> 
> 赞同：8
> 
> 时间：2009-05-01T13:46:57.037
> 
> 标签：c#, .net, vb.net

这可能真的很明显，我很密集。在 C# 中，我可以这样做：

```
string = @"this is 
            some preformatted 
            text"; 
```

我如何在VB中做到这一点？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-01T13:49:34.377

没有一个。

在 C# 中，您可以执行类似“这以新行结束\n。”的操作，但在 VB 中没有这样的概念，您有预定义的变量可以为您处理“这以新行结束” & vb新行

因此，字符串文字 (@"something\n") 没有意义，因为在 VB 中它无论如何都会被解释为字面意思。

VB .NET 的问题是语句在行尾被视为终止，所以你不能这样做

```
Dim _someString as String = "Look at me
  I've wrapped my string
    on multiple lines" 
```

您被迫在每一行终止您的字符串并使用下划线表示您希望继续您的语句，这使您执行类似的操作

```
Dim _someString as String = "Look at me " & vbNewLine &_
   "*** add indentation here *** I've wrapped my string " & vbNewLine &_
   vbTab & " on multiple lines" '<- alternate way to indent 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-08-28T14:28:07.713

就像其他人说的那样，没有 @ 运算符，所以如果您进行繁重的字符串操作，请使用**String.Format**

恕我直言，这个

```
Dim text As String = String.Format("this is {0} some preformatted {0} text", Environment.Newline) 
```

比这更具可读性

```
Dim text As String = "this is" & Environment.NewLine _
                 & " some preformatted" & Environment.NewLine _
                 & " text" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-01T13:52:14.107

我不认为你可以在 VB 中做到这一点。你所要做的：

```
Dim text As String = "this is" & Environment.NewLine _
                     & " some preformatted" & Environment.NewLine _
                     & " text" 
```

编辑：正如评论中所建议的，用 Environment.NewLine 替换了 VB 特定的 vbNewLine

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-01T14:28:55.233

实际上你可以在 vb.net 中做到这一点。您使用称为 XML Literals 的东西。

```
Dim mystring = <string>this is
 some preformatted
 text</string>.Value 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T13:52:41.733

VB 对于字符串操作很弱。没有预格式化或内联转义字符。任何特殊字符都需要附加到字符串中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-02T11:51:34.107

您可能想试试 Alex Papadimoulis 的“ [Smart Paster](http://weblogs.asp.net/alex_papadimoulis/archive/2004/05/25/Smart-Paster-1.1-Add-In---StringBuilder-and-Better-C_2300_-Handling.aspx) ”插件。它允许您将字符串“作为 StringBuilder”粘贴到 C# 或 VB 代码中。

# gcc - GCC MIPS-32 调用约定/栈帧定义

> ID：811424
> 
> 赞同：10
> 
> 时间：2009-05-01T13:47:27.347
> 
> 标签：gcc, embedded, mips, ecos

MIPS-32 处理器架构似乎没有明确的标准化堆栈框架和 C 语言调用约定（寄存器使用等）。也就是说，似乎完全取决于汇编器/编译器工具链来定义自己的堆栈框架和调用约定。我一直在努力寻找 GCC 编译器用于 MIPS-32 指令集的约定的明确参考。我专门在 Cygwin 上使用 GCC 交叉编译器，它针对在 eCos 开源内核的嵌入式环境中使用的 MIPS-32 内核。

任何对有关该领域 GCC for MIPS-32 的权威文档的参考将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-01T14:35:39.710

[这个关于RedHat Linux](http://www.cygwin.com/ml/binutils/2003-06/msg00436.html)的 MIPS EABI 的参考有帮助吗？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-01T14:43:38.443

你是对的，这有点乱，而且记录不充分。我会推荐：

*   [http://math-atlas.sourceforge.net/devel/assembly/mipsabi32.pdf](http://math-atlas.sourceforge.net/devel/assembly/mipsabi32.pdf)
*   Dominic Sweetman 的“查看 MIPS 运行”
*   检查编译器生成的反汇编代码以检查与上述参考的差异。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-01T14:30:38.133

我不喜欢 MIPS，但也许这个[MIPS ABI 历史](https://www.linux-mips.org/wiki/MIPS_ABI_History)参考可能会有所帮助。

# asp.net-mvc - 如何通过名称获取控制器类型

> ID：811426
> 
> 赞同：0
> 
> 时间：2009-05-01T13:47:34.710
> 
> 标签：asp.net-mvc

> **可能重复：**
> [如何从 url 或路由数据中获取控制器类型和操作信息？](https://stackoverflow.com/questions/2690779/how-can-i-get-controller-type-and-action-info-from-a-url-or-from-route-data)

我有一个控制器名称及其操作名称的列表。我需要做的是从这些操作的自定义属性中读取值。问题是似乎没有简单的方法来获取控制器类型（剩下的很容易。） ASP.NET MVC 框架在 .NET 中具有此功能`DefaultControllerFactory`，但在框架本身之外无法访问它。重新发明轮子并自己实现它看起来不是一个好主意，特别是因为 MVC 框架有控制器类型的缓存，我需要复制它。有没有更好的解决方案？

* * *

更新。[访问 ASP.NET MVC 应用程序中的控制器/操作列表](https://stackoverflow.com/questions/790464)描述了一个类似但不同的问题。我不需要确定可以执行哪些控制器/动作，我需要获取单个控制器的类型。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T14:37:38.100

由于您已经有一个类型名列表，因此使用反射来翻阅程序集、检索类型并迭代操作，检查感兴趣的属性是否存在，这可能是最直接的方法。我没有在 ASP.Net MVC 中进行足够的爬网，以了解是否有办法从 MVC 中的控制器缓存中提取类型信息......

或者，如果您可以向缓存请求每种控制器类型的对象（并且 ASP.Net MVC 控制器，或者更具体地说，您的控制器足够便宜，可以构造，或者构造和缓存，对我来说是未知的），检索每个系统中的控制器和检索它们的类型可能更直接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T13:57:39.553

我不太清楚您需要在哪里执行此操作。如果您需要在 MVC 应用程序中执行此操作，那么您可以实现自己的控制器工厂并将您的代码放在那里，使用以控制器类型为键的缓存存储结果 - 例如：

```
public class CustomControllerFactory : DefaultControllerFactory
{
  protected override IController GetControllerInstance(Type controllerType)
  {
    // do something with controller attributes on controllerType here the
    // first time a controller is seen and store the results in a
    // static cache keyed on the controller type

    return base.GetControllerInstance(controllerType);
  }
} 
```

然后在应用程序启动时注册该 ControllerFactory（例如在 global.asax 中）：

```
ControllerBuilder.Current.SetControllerFactory(new CustomControllerFactory()); 
```

或者，您可以简单地使用反射来查找程序集中以“Controller”结尾的所有类并在那里运行您的代码 - 同样，我不清楚您需要在哪里发生这种情况。

# c# - 动态呈现控件，从字符串/XML 文件中确定类型？

> ID：811436
> 
> 赞同：1
> 
> 时间：2009-05-01T13:49:46.047
> 
> 标签：c#, asp.net, xml

在 ASP.NET 应用程序中，我想动态呈现几个控件，它们的属性来自 XML 文档。这是踢球者：我希望能够动态确定控件的类型。因此，在我的 XML 文档中，我有这样的内容：

```
 <control>
    <id>myControl1</id>
    <type>CheckBox</type>
    <text>Text For This Control</text>
    </control> 
```

只要我手动将新控件实例化为复选框，我就可以让一切正常工作……但我似乎无法弄清楚如何将其设为复选框，而不是文本框或其他基于 XML 信息...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T14:30:38.490

您可能希望能够控制超出 Control 类型的输出。我的建议：

```
public interface IControlProvider {
    public Control GetControl(XmlElement controlXml);
};

public class ControlProviderFactory : IControlProvider {
    private Dictionary<string,IControlProvider> providers = new Dictionary<string,IControlProvider>();

    public ControlProviderFactory() {
        //Add concrete implementations of IControlProvider for each type
    }

    public Control GetControl(XmlElement controlXml) {
        string type = (controlXml.SelectSingleNode("type") as XmlElement).InnerText;
        if(!providers.ContainsKey(type) throw new Exception("No provider exists for " + type);
        return providers[type].GetControl(controlXml);
    }
} 
```

您还可以添加一个 ReflectionControlProvider 作为未注册类型的后备，并让它在遇到未知的提供者类型时使用 Activator.CreateInstance 而不是抛出异常。这样，您就可以在特定的渲染控制和动态创建方面获得最大的灵活性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T13:58:54.010

您可以`Dictionary<string, Type>`创建有效类型，也可以使用 . 按名称创建实例`Activator.CreateInstance`。

# c++ - 您在 Windows 上使用哪些日志记录工具？

> ID：811438
> 
> 赞同：4
> 
> 时间：2009-05-01T13:49:49.667
> 
> 标签：c++, windows, logging

我正在考虑向应用程序添加日志记录，并且正在考虑使用 Kiwi syslogd 和免费软件库 (clSyslog) 将日志记录消息发送到守护程序。我简要地查看了 log4c，发现用 VC++ 编译它会比我花更多的时间。

您使用和推荐哪些工具来记录消息？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T13:55:11.010

自己动手——这对跨平台的东西特别有用。你可以看看[Boost.Log](http://sourceforge.net/projects/boost-log)。请注意，这在提交时被拒绝，因此不是标准分发的一部分。AFAIK，作者有计划重写这个。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-01T13:54:04.273

[Windows 事件日志](http://msdn.microsoft.com/en-us/library/aa385780(VS.85).aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-01T15:05:49.420

在 C++ 中，我使用了很多[log4cxx](http://logging.apache.org/log4cxx/index.html) .. 不明白为什么编译有问题，像冠军一样工作。它带来了很多好处。仅举几例 - 您可以将日志语句重定向到 syslog 或 Windows 事件日志，而无需接触您的代码库 - 只需更改配置即可。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-01T14:03:35.700

我喜欢[Poco](http://pocoproject.org/) :: [LogStream](http://pocoproject.org/docs/Poco.LogStream.html)。`log4j`它是一个框架，但它确实有一个非常好的日志记录层，就配置而言，它的行为类似等等，但使用 STL 来实现。相当不错。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-01T14:07:54.583

我以前使用过[John Torjo 的](http://www.torjo.com) [日志框架](http://www.torjo.com/log2/index.html)（版本 1 - 不是 2）。它工作得很好，所以我认为第二个版本也会如此。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-01T21:28:17.380

我是 NLog [http://www.nlog-project.org/的超级粉丝](http://www.nlog-project.org/)

# python - 当连接中断时，读取由 urllib2 生成的流永远不会恢复

> ID：811446
> 
> 赞同：8
> 
> 时间：2009-05-01T13:51:52.640
> 
> 标签：python, urllib2

在尝试使我的一个 python 应用程序在连接中断的情况下更加健壮时，我发现调用 urllib2 生成的 http-stream 的读取函数可能会永远阻止脚本。

我认为读取函数将超时并最终引发异常，但是当连接在读取函数调用期间中断时，情况并非如此。

以下是会导致问题的代码：

```
import urllib2

while True:
    try:
        stream = urllib2.urlopen('http://www.google.de/images/nav_logo4.png')
        while stream.read(): pass
        print "Done"
    except:
        print "Error" 
```

（如果您尝试使用该脚本，您可能需要多次中断连接，然后才能达到该脚本永远无法恢复的状态）

我通过 Winpdb 观看了脚本，并截取了脚本永远无法恢复的状态（即使网络再次可用）。

[Winpdb http://img10.imageshack.us/img10/6716/urllib2.jpg](http://img10.imageshack.us/img10/6716/urllib2.jpg)

有没有办法创建一个即使网络连接中断也能继续可靠工作的python脚本？（我宁愿避免在额外的线程中这样做。）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-01T14:57:26.103

尝试类似：

```
import socket
socket.setdefaulttimeout(5.0)
   ...
try:
   ...
except socket.timeout:
   (it timed out, retry) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T14:32:14.243

好问题，我真的很想找到答案。我能想到的唯一解决方法是使用[python 文档](http://docs.python.org/library/signal.html#example)中解释的信号技巧。在您的情况下，它将更像：

```
import signal
import urllib2

def read(url):
    stream = urllib2.urlopen(url)
    return stream.read()

def handler(signum, frame):
    raise IOError("The page is taking too long to read")

# Set the signal handler and a 5-second alarm
signal.signal(signal.SIGALRM, handler)
signal.alarm(5)

# This read() may hang indefinitely
try:
    output = read('http://www.google.de/images/nav_logo4.png')
except IOError:
    # try to read again or print an error
    pass

signal.alarm(0)          # Disable the alarm 
```

# php - 什么 PHP ORM 最像 NHibernate？

> ID：811452
> 
> 赞同：3
> 
> 时间：2009-05-01T13:53:20.890
> 
> 标签：php, nhibernate, orm

我第一次考虑在 PHP 中使用 ORM。到目前为止，我的 PHP 项目还很小，而 ORM 似乎有点矫枉过正。

我真的很喜欢 NHibernate，所以我希望那里有一个适用于 PHP 的 ORM，它可以工作并且配置类似于 NHibernate。如果有一个像 Fluent NHibernate 这样的流畅界面，那就更好了。

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-01T14:40:07.797

我建议你看看[Doctrine ORM](http://www.doctrine-project.org/)。Doctrine 可以使用 YAML 生成您的表到 PHP 类的映射，这类似于 NHibernate 使用 XML 的映射。Doctrine 还提供命令行工具来重建数据层的各个方面，基于对架构、模型本身或您正在抽象的数据库表的更改。

我只真正看过NHibernate，没有使用它。所以我不会声称确切地知道这两个 ORM 实现交叉的程度。我敢肯定，快速浏览他们的[文档](http://www.doctrine-project.org/documentation/manual/1_1/en)会帮助您得出更好的结论。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-05-05T07:51:02.077

基于 Hibernate 的[Doctrine 项目。](http://www.doctrine-project.org/)

# java - 如何在 Hibernate 中级联删除？

> ID：811453
> 
> 赞同：0
> 
> 时间：2009-05-01T13:53:21.123
> 
> 标签：java, hibernate, mapping

我有一个课程对象。课程对象有一组教程和一组应用程序。当我删除课程对象时，我希望删除相关的教程和应用程序集。我的 course.hbm 如下，我的 application.hbm 包含

```
<property name="appdatetime" type="timestamp">
    <column name="appdatetime" length="19" />
</property>
<property name="appstatus" type="java.lang.Integer">
    <column name="appstatus" />
</property>
<property name="apptype" type="java.lang.Integer">
    <column name="apptype" />
</property>

<many-to-one name="course" column="cid"/>
<many-to-one name="employee" column="empid" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T13:59:31.047

在您的课程对象中，您需要在我认为将是一个袋子或类似的内部一对多的东西上设置级联选项。

```
<bag name="Tutorials" cascade="all-delete-orphan">
   <key column="someId" />
   <one-to-many class="Tutorial" not-found="ignore" /> 
```

希望这可以帮助。

# logging - 是否可以访问 S60 设备上的某种系统错误日志？

> ID：811458
> 
> 赞同：0
> 
> 时间：2009-05-01T13:54:32.540
> 
> 标签：logging, mobile, symbian, s60

这是我在这个很棒的新（对我而言）程序员网站上的第一张照片，我希望有人能够启发我一些:)

有谁知道是否可以在 s60 设备上访问某种错误日志？我能找到的唯一相关的是最近发送/接收的数据包和调用的日志......模拟器不是一个选项，因为我需要测试不同的 WAP-Push 场景，我的问题是有时什么都不会发生在当我的手机收到推送消息时，我可以在稀疏日志中看到我收到了某种短信……但没有错误或什么也没有。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-02T16:46:49.373

Symbian OS 上没有单一的系统错误日志。当然，有一个系统记录器，但是每个组件/子系统记录到不同的位置，并且对于如何/是否可以启用记录有不同的策略。不幸的是，IIRC 消息传递组件仅在调试版本中写入日志文件，这对生产设备没有帮助。

如果设备在接收 WAP-Push 消息时什么都不做，则很可能是格式错误的有效负载（或者接收端口上可能没有观察者）。

可能值得发布您的确切问题 WRT 消息并查看是否有人可以提供帮助？

# asp.net - UpdatePanel 完整回发

> ID：811459
> 
> 赞同：4
> 
> 时间：2009-05-01T13:54:39.967
> 
> 标签：asp.net, ajax, updatepanel, postback

您好，这里是场景。

我有 .aspx 页面和 updatepanel 像这样

```
<asp:UpdatePanel id="uPanelMain" runat="server">
    <ContentTemplate>
        <uc:Calendar id="ucCalendar" runat="server" Visible="true" />
       <uc:Scoring id="ucScoring" runat="server" Visible="false" />
   </ContentTemplate> 
```

首先加载控件 ucCalendar，它包含一个像这样的网格

```
<asp:DataGrid CssClass="grid" ID="gridGames" runat="server" AutoGenerateColumns="False" HeaderStyle-CssClass="gridHeader" ItemStyle-CssClass="gridScoringRow"  
            GridLines="None" ItemStyle-BackColor="#EEEEEE" AlternatingItemStyle-BackColor="#F5F5F5"
            OnEditCommand="doScoreGame" OnDeleteCommand="doEditGame" OnCancelCommand="printLineup" OnItemDataBound="gridDataBound">
   <Columns>
        <asp:TemplateColumn >
            <ItemTemplate>
                <asp:CheckBox ID="chkDelete" runat="server" />
            </ItemTemplate>
        </asp:TemplateColumn>
        <asp:BoundColumn DataField="idGame" Visible="false" />
        <asp:BoundColumn DataField="isClose" Visible="false" />
        <asp:TemplateColumn HeaderText="Status">
            <ItemTemplate>
                <asp:Image ID="imgStatus" runat="server" ImageUrl="~/img/icoX.png" alt="icoStatus" />
            </ItemTemplate>
        </asp:TemplateColumn>
        <asp:TemplateColumn>
            <ItemTemplate>
                <asp:LinkButton ID="linkScore" runat="server" CommandName="Edit" Text="Score" />
            </ItemTemplate>
        </asp:TemplateColumn>
   </Columns>
</asp:DataGrid> 
```

因此，当我单击“linkBut​​ton”时，userControl 的代码隐藏调用 .aspx 中的公共方法，如下所示：

从用户控件

```
 protected void doScoreGame(object sender, DataGridCommandEventArgs e)
    {
        ((GM)this.Page).showScoring(null, null);
    } 
```

从 .aspx 页面

```
public void showScoring(object sender, EventArgs e)
{
    removeLastLoadedControl();
    ucScoring.Visible = true;
} 
```

所以，问题来了：

当我更改 ucScoring 控件的可见属性时，会发生两次回发。

第一次回发很好，它由 updatePanel 处理。

第二次回发是完整的回发，我真的不明白为什么会这样。

我真的迷路了，请帮助！

谢谢

垫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-08T04:07:11.367

您正在手动触发 UpdatePanel 不知道的事件。您需要将该事件绑定到您的控件并注册它：

```
ScriptManager.RegisterAsyncPostBack(ucScoring); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T14:35:55.937

我很好奇 removeLastLoadedControl() 方法中发生了什么。

# database - Delphi - 网络 ODBC 数据库 (MS Access)

> ID：811460
> 
> 赞同：1
> 
> 时间：2009-05-01T13:54:48.997
> 
> 标签：database, delphi, ms-access, networking

我有一个使用 MS Access 的数据库程序。时候到了，我需要把它变成一个客户端/服务器应用程序。该方案背后的思想是：服务器持有数据库，一个或多个客户端需要同时访问它。该程序仍然需要在 Ms Access 下运行（因为移植 DB 和重写应用程序是不可能的）。

老实说，我不太喜欢的另一种方案是让客户端从服务器请求数据库文件，通过 LAN 传输它并在本地访问它......但是客户端可以对其进行更改，因此它是无效的。

现在我的问题是：这是实现这一点的正确方法。以及如何访问网络数据库？让它共享，或者有什么方法可以使用 Indy 等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T14:05:56.663

像 Access 这样的基于文件的数据库本质上是单用户的。您可以分享它们，但您正在向一个充满腐败数据库和痛苦的世界敞开大门。如果您有一个多用户应用程序，则需要一个基于服务器的多用户数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T14:06:10.640

如果您使用带有 Delphi 的 ODBC 控件的数据库，则无需担心移植 AP 和 DB（嗯，可能需要修复一些小问题）。ODBC 使所有 DB 使用相同的接口，因此您可以简单地将数据源名称 (DSN) 连接字符串更改为使用 acc/pw 登录的远程服务器，然后一切都应该工作。即使您更改对其他 ODBC 系统（如 MySQL）的访问，它也可以正常工作，只需少量 SQL 命令更改。

所以回到你的问题。当您的用户增长大于 2 时，在服务器上使用文件肯定会失败。在多个用户同时访问数据库时，您将需要数据库端的事务（或原子）行为，这是 Access 所缺乏的。只有真正的数据库服务器，如 MySQL 或 MSSQL 或 Oracle/DB2/... 才能做到这一点。

不要共享单个数据库文件。使用真正的数据库服务器，除非您只有一个客户端。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T16:53:32.970

要共享访问数据库，只需将 *.MDB 文件放入网络共享并通过网络打开它。我将这种技术用于最多约 15 个网络用户，超出此范围或有大量流量的位置，我推送到 SQL Server。

迁移到 SQLServer 是一项非常简单的任务，特别是如果您使用 dbGO 组件 (ADO)，因为只需将连接字符串更改为指向 SQL Server 实例。这种转换我遇到的唯一问题是布尔字段。在 access 中，这些字段的内部表示为 0 或 -1，而在 SQL Server 中，它们的内部表示为 0 或 1。在 Access 中，它们解析为布尔值，而在 SQL Server 中则没有。例如，以下查询在 SQL Server 中失败：

```
SELECT * FROM TABLE WHERE BOOLFIELD 
```

它必须重写为：

```
SELECT * FROM TABLE WHERE BOOLFIELD <> 0 
```

我所有的其他查询都能正常工作……除了日期/时间，我建议将其作为参数传递并让驱动程序处理翻译。

转换过程相当简单。使用迁移工具将您的访问数据库迁移到 SQL Server，然后使用 SQL Server 脚本数据库为您生成脚本。将此脚本提供给您的客户进行部署，在每个位置自己执行，或者编写一个程序来解析和执行从文件中读取的每个命​​令。

[您可以使用OpenDataSource](http://msdn.microsoft.com/en-us/library/ms179856.aspx)方法通过 SQLServer 将数据从一个数据库迁移到另一个数据库，然后从您的访问数据库执行插入操作。

```
INSERT INTO TABLE FROM 
  OpenDataSource('Microsoft.Jet.OLEDB.4.0','Access.mdb')...TABLE 
```

另一种选择是进入 n 层。如果您有 Delphi 的企业版，那么使用 TClientDatasets 并编写一些服务器函数将系统迁移到真正的 n 层解决方案并不难。当然，里程将在很大程度上取决于应用程序的当前布局以及系统的复杂程度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T14:02:29.713

为什么移植数据库必然涉及重写应用程序？

使用[SQL Server 迁移助手](http://www.microsoft.com/sqlserver/2008/en/us/migration.aspx)将您的 MS Access 数据库迁移到 SQL Server 怎么样？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T14:34:26.907

我的解决方案：使用 RemObjects SDK 之类的东西来定义应用程序调用以从数据库中获取数据的接口。你可能有一个数据模块或已经定义了所需调用的东西，但它可以帮助你整理你的应用程序。然后，您可以使用您的应用程序远程访问数据，并且仍然可以访问 Access 数据库。当它适合时，您可以将数据迁移到其他东西，而根本不必更改客户端，因为它们现在使用接口并且不关心实现。

他们还做一个远程数据访问系统，但我回避它，因为它不符合我的需要。不过可能值得一看。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T16:02:12.263

有时从一个数据库移动到另一个数据库非常容易。我很容易从 Access 迁移到 Firebird（我认为 Firebird对于 Delphi 比 MySQL[更好）](http://www.itexto.net/devkico/?p=398)

我使用的工具：http: [//www.clevercomponents.com/products/dbcomparer/dbcomparer.asp](http://www.clevercomponents.com/products/dbcomparer/dbcomparer.asp)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-05T04:15:19.123

如果您的用户广泛分布在 Internet 上并且您不想使用文件共享，则一种选择是使用[EQL Data](http://eqldata.com/)来保持数据库的多个副本同步。它还有助于在网络上发布表格。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-07T08:14:02.120

我正在检查 MSSQL Server，2005 和 2008 都需要 .NET 框架才能工作。还有哪些与 ADO 兼容的其他数据库系统可用（不是基于文件的数据库）

# reporting-services - 对应列的行组的 SSRS 总和

> ID：811464
> 
> 赞同：0
> 
> 时间：2009-05-01T13:56:23.737
> 
> 标签：reporting-services

我有一个报告，其中包含客户 MembershipLength 的行组（1 年帐户、2 年帐户等），然后是客户状态（活动、非活动等）行的子组，然后我有客户类型的列。

最终，我想添加一个列来计算相应客户类型的小计百分比。但是，如果我将其分解并尝试获取客户类型的行组的总和，我只能获得两种客户类型。我只想要相应客户类型的 MembershipLength 客户计数。

`=Sum(Fields!ZO.Value,"matrix1_MembershipLength")`当我只需要相应列时，将为我提供两种客户类型的总数`matrix1_CustomerType`

[我在此处](http://social.msdn.microsoft.com/Forums/en-US/sqlreportingservices/thread/89fc0656-5042-4aa1-8d7a-eb4ab6974a90?prof=required)的 MSDN 论坛上发布了相同的问题，但还没有得到我正在寻找的答案。但是，这可能会更好地说明这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T14:28:27.403

尝试这个：

```
=sum(iif(Fields!CustType.Value="VIP",1,0))/count(Fields!CustomerName) 
```

没有更清晰的解释，这就是我能弄清楚的。

# fortran - 什么是 Fortran 保留字/变量 ACCY？

> ID：811469
> 
> 赞同：0
> 
> 时间：2009-05-01T13:58:17.913
> 
> 标签：fortran

我试图查看一些非常古老的 FORTRAN 代码并遇到以下语句：

```
IF (XKJ.GT.ACCY) THEN 
```

我查看了整个代码，没有找到“ **ACCY** ”的声明。我假设它是一个内置变量/常量/函数，但无法找到定义。我“用谷歌搜索”它并遇到了其他具有类似表达式的 FORTRAN 示例（但没有 ACCY 的定义）。

自从我查看 FORTRAN 代码以来已经 20 年了。有人知道' **ACCY** '是什么吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-01T14:24:05.027

毫无疑问，它是一个变量，具有用于测量浮点计算的“准确性”——由于某些浮点数的不精确表示，它可能会漂移。在 Fortran 中，除非您使用编译器选项（或 IMPLICIT 语句）来打开此功能，否则不必声明变量。以 AH 和 OZ 开头的变量自动被视为 REAL 变量（IN 是整数）。有问题的编译器可能会将变量的内存清零，也可能不会清零，所以除非它被分配到某个地方——通常是一个 COMMON 块——它可能是零或某个任意值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T14:21:50.853

从技术上讲，Fortran 中没有保留/关键字。尽管将关键字定义为标识符会使事情变得非常混乱。在我看来，这听起来/看起来像是被隐含地定义了，这是它的第一次使用，其中 ACCY 为 0。

定义此代码片段的子例程是否定义了[IMPLICIT NONE](http://en.wikibooks.org/wiki/Fortran_2003)？如果没有，打开它并查看编译器是否将 ACCY 标记为未定义。如果它被标记，你就会知道为什么在其他地方找不到它:)

# iphone - 从 UIViewController 加载 UINavigationController 作为子视图

> ID：811478
> 
> 赞同：7
> 
> 时间：2009-05-01T13:59:03.467
> 
> 标签：iphone, objective-c, uiview, uinavigationcontroller, subview

我是 iPhone 开发的新手。我想构建一个应用程序，它首先有一个 UIViewController，它会有一个按钮。现在点击按钮，它会加载一个 UINavigation 控制器。这是我的接近方式：

1.  我创建了一个 UIViewController 类，在那里我拿了一个

    ```
    -(IBAction) PressMeFunc:(id) sender 
    ```

    用于按下按钮。

2.  然后我创建了一个 UIView xib 文件。我在 IB 中完成了所需的步骤。

3.  然后在 AppDelegate 中，我将 ViewController 的实例添加为窗口的子视图。

到此为止还可以。

接下来，如何在按下按钮时加载导航控制器？

我知道如何从基于窗口的应用程序构建一个 navigationController 项目，但是我很难将 NavigationController 作为 UIView 的子视图。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-01T16:55:03.637

NavigationController 旨在在使用时接管屏幕，因此您必须决定如何管理从原始 ViewController 到 NavigationController 的转换。您可以使用 presentModalViewController 执行此操作，或者通过处理删除原始视图并以编程方式交换 NavigationController 来执行此操作。

这是以编程方式设置 NavigationController[的 Apple 文档。](http://developer.apple.com/library/ios/featuredarticles/ViewControllerPGforiPhoneOS/index.html)

代码看起来像这样（来自 Apple 的文档）：

```
GroupsController *groupsController = [[[GroupsController alloc] initWithNibName:nil bundle:nil] autorelease];
UINavigationController *navigationController =
[[UINavigationController alloc] initWithRootViewController:groupsController]; 
```

现在，一旦您创建了 NavigationController，并将其第一个视图控制器添加到其中，您需要过渡到它。您可以使用 CATransitions 或使用

```
[myViewController presentModalViewController: navigationController]; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-07-04T13:12:25.047

您不应该将 UIViewController 的（包括导航）视图作为子视图添加到由另一个视图控制器管理的视图中。

这是相关阅读： http: [//blog.carbonfive.com/2011/03/09/abusing-uiviewcontrollers/](http://blog.carbonfive.com/2011/03/09/abusing-uiviewcontrollers/)

在您的情况下，您可以做的是从*窗口*中删除视图控制器的视图，然后将导航控制器的视图添加到窗口中。

```
[viewController.view removeFromSuperview];
[window addSubview:navigationController.view]; 
```

您也可以按照此处的建议将其添加为模态视图控制器，或者您可以将第一个视图控制器设置为导航控制器，然后在该导航控制器的堆栈上，推送第二个导航控制器：

```
[navigationController pushViewController:secondNavigation animated:NO]; 
```

编辑：嘿刚刚注意到我正在回答一个 09 问题

**编辑#2：这可能与 iOS 5 和他们添加的 UIViewController 容器无关，仍然没有机会检查它，但如果你正在阅读这个答案，你可能想要。**

# vb.net - 通过 Oracle ODBC 连接使用参数

> ID：811481
> 
> 赞同：2
> 
> 时间：2009-05-01T13:59:43.760
> 
> 标签：vb.net, oracle, odbc

我使用 Microsoft ODBC for Oracle 驱动程序成功连接到 Oracle 10g DB。

没有参数的常规查询可以正常工作，但参数化查询的行为就像没有传入参数一样。

前任。

```
--this works fine
Select * from tbl1 where column1 = 'test'

--this doesn't
select * from tbl1 where column1 = ?

--odbc string parameter 'test' 
```

这是我的连接字符串的样子：

```
"Driver={Microsoft ODBC for Oracle}; " & _
 "CONNECTSTRING=(DESCRIPTION=" & _
 "(ADDRESS=(PROTOCOL=TCP)" & _
 "(HOST=" & pstrServer & ")(PORT=" & pintPort.ToString & "))" & _
 "(CONNECT_DATA=(SERVICE_NAME=" & pstrPhysicalName & "))); " & _
 "uid=" & pstrUserName & ";pwd=" & pstrPassword & ";" 
```

我正在向我的 ODBC 命令添加参数，如下所示：

```
arrOdbcParam(index) = New OdbcParameter("@paramName", paramValue)

...

cmd.Parameters.AddRange(arrOdbcParam) 
```

原谅部分复制的，有点伪代码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-01-19T10:47:26.613

这里有点死灵，但由于我刚刚遇到了类似的问题，所以它是如何与 Centura SQLBase 的 ODBC 驱动程序一起工作的：

```
OdbcCommand com = con.CreateCommand();
com.CommandText = @"
  SELECT  thing
  FROM    table
  WHERE   searchInt = ? AND searchDat = ?";
com.Parameters.Add(new OdbcParameter("", OdbcType.Int)).Value = 12345;
com.Parameters.Add(new OdbcParameter("", OdbcType.DateTime)).Value = DateTime.Now;
OdbcDataReader reader = com.ExecuteReader(); 
```

这将在“table”中搜索“searchInt”中值为 12345 和“serachDat”中的今天日期的记录。
注意事项：

*   参数标记为`?`SQL 命令中的
*   参数不需要名称，但位置（和正确的类型）很重要

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T07:15:08.373

ODBC 参数（由符号 标记`?`）由位置绑定，因此您必须确保`OdbcParameter`以正确的顺序添加 s。他们的名字并不重要，但我建议`paramName`不要`@`使用 SQL Server（或者更确切地说，Microsoft）特定的名称格式。

您也可以尝试使用 Oracle 参数格式，Microsoft ODBC for Oracle 驱动程序应该可以识别该格式，并允许您按名称进行绑定（虽然不是 100% 确定这一点）：

*   在您的查询中替换`?`为。`:paramName`
*   命名你的参数`paramName`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T14:22:38.947

尝试使用“:paramName”而不是“paramName”。

# windows - ActiveX 的 dll 注册的替代方法是什么

> ID：811490
> 
> 赞同：2
> 
> 时间：2009-05-01T14:02:31.663
> 
> 标签：windows, activex, dllregistration

我最近开始工作的一个应用程序必须注册两个 dll，“因为 ActiveX”。

这使得在您的机器上存在多个版本的应用程序变得很困难 - 例如已安装的产品版本，以及最新开发源的调试和发布版本。

ActiveX 注册的替代方法是什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-02T04:00:23.507

如果您的应用程序加载 ActiveX 对象，则有几个选项。如果您使用的是 XP 或更新版本，则第一个选项是使用带有 Manifest 文件的免注册 COM，如[MSDN](http://msdn.microsoft.com/en-us/library/fh1h056h.aspx)上所述。这个想法是在清单文件而不是注册表中声明您的 COM (ActiveX) 组件。因此，对于 MyApp.exe，使用以下内容创建 MyApp.exe.manifest（使用您的 DLL 文件名和 CLSID）：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0">
  <assemblyIdentity type="win32" name="MyApp_ActiveX" version="1.0.0.1" 
        processorArchitecture="x86" publicKeyToken="0000000000000000" />

  <file name="MyActiveX.dll">
    <comClass clsid="{0000000-0000-0000-0000-000000000000}" threadingModel="Both" />
  </file>
</assembly> 
```

DougN 提到的另一个选项是滚动您自己的 CoCreateInstance() 来创建对象。下面的 C++（加上 ATL）代码应该这样做（从内存中去，所以仔细检查代码）：

```
typedef int (__stdcall *LPDLLGETCLASSOBJECT)(REFCLSID, REFIID, void**);

// LoadInterface() - Load COM Interface from DLL without using registry.
//
// USAGE:   
//   HMODULE hModule = 0;
//   CComPtr<IMyActiveX> pActiveX;
//   if(SUCCEEDED(LoadInterface("C:\\Debug\\MyActiveX.dll", CLSID_MyActiveX, IID_IMyActiveX, (void**)&pActiveX, &hModule)))
//   {
//      // TODO: use pActiveX
// 
//      // caller must call FreeLibrary(hModule) when done
//      pActiveX = 0;
//      FreeLibrary(hModule); 
//   }
//
HRESULT LoadInterface(LPCTSTR pDllPath, REFCLSID rClsid, REFIID riid, LPVOID* ppv, HMODULE *pModule)
{
    if(pModule == 0 || ppv == 0) return E_POINTER;
    HMODULE hModule = LoadLibrary(pDllPath);
    if(hModule == 0) return E_FAIL;

    HREUSLT hr = E_POINTER;
    CComPtr<IClassFactory> classFactory;
    LPDLLGETCLASSOBJECT pGetClassObject = (LPDLLGETCLASSOBJECT)GetProcAddress(hModule, "DllGetClassObject");
    if(pGetClassObject)
    {
        hr = pGetClassObject(rClsid, IID_IClassFactory, (void**)&classFactory);
        if(SUCCEEDED(hr))
        {
            hr = classFactory->CreateInstance(0, riid, (void**)ppv);
            if(SUCCEEDED(hr))
            {
                *pModule = hModule;
                return S_OK;
            }
        }
    }

    // unload library on error
    if(hModule)  
    {
        FreeLibrary(hModule);
    }
    return hr;
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T14:11:00.690

没有我能想到的。这就是 COM（因此是 ActiveX）背后的全部原理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T14:15:55.827

如果您控制加载 ActiveX 控件的代码，并且没有其他人需要加载它，您可以跳过注册并手动处理您自己的 CreateInstance 调用：LoadLibrary，获取指向 Factory 对象的指针，然后直接创建实例。

大约 10 年前在一个项目上做过，效果很好。

但是，如果您不能这样做（也许您不控制调用 CreateInstance 的代码），那么只需创建两个批处理文件并将它们放在您的桌面上：一个用于注册 Debug，另一个用于注册 Release DLL。然后来回切换变得非常容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T18:39:01.373

[您可以使用ProgID](http://blogs.msdn.com/larryosterman/archive/2006/01/10/511279.aspx)对 ActiveX 控件进行版本控制。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-06T01:27:47.003

我不认为 .bat 解决方案一定很糟糕。大多数简单的 ActiveX 控件都是自注册/注销的。但它仍然限制您一次运行调试版本或发布版本，而不是同时运行两者。

这是一个大问题（它是“DLL Hell”的本质），也是.NET 和Java 流行的很大一部分原因。

我相信 .NET 可以利用并行共享，这是 Windows 2000 和 Windows 98 SE 引入的一项功能。我不认为你需要 .NET 来使用它（你没有说你在做 COM 互操作）。

[在http://msdn.microsoft.com/en-us/library/ms811700.aspx](http://msdn.microsoft.com/en-us/library/ms811700.aspx)上的 MSDN 上有一篇有点长的文章，“在应用程序中实现并行组件共享”，它建议创建一个 .local 文件。我不完全清楚它是如何工作的，但我认为这是正确的方法。

# c# - 从 PHP 使用基于 REST 的 WCF 服务的最佳实践是什么？

> ID：811497
> 
> 赞同：0
> 
> 时间：2009-05-01T14:05:32.123
> 
> 标签：c#, php, wcf, rest

我们有一个用 PHP 构建的网站，并试图使其能够与将用 WCF 编写的几个服务进行通信，并遵循 Web 服务的 REST 样式架构。

有人有最佳实践吗？问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T14:34:57.717

顺便说一句，WCF/C# 方面完全无关紧要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T14:52:09.657

我会考虑将 WCF 组件配置为使用 basicHTTPBinding。请注意，可以配置 WCF 组件，这样您就根本无法使用 PHP 访问它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T15:10:40.843

您可以使用它[`file_get_contents`](http://www.php.net/file_get_contents)来检索资源。如果你需要操作它，你可以使用[curl 扩展](http://www.php.net/curl)。Curl 还支持各种形式的身份验证。

您还需要一个解析器来处理资源。这将取决于内容类型，但 XML 是一种通用格式，可以使用[simplexml 扩展名进行解析](http://www.php.net/manual/en/book.simplexml.php)

# c# - C# File.Delete，文件被另一个进程使用

> ID：811502
> 
> 赞同：6
> 
> 时间：2009-05-01T14:06:16.413
> 
> 标签：c#, error-handling

我在尝试删除图像文件时遇到问题。我总是收到一条错误消息：IOExeption 未处理。访问被拒绝，因为该文件正在被另一个进程使用。

我不知道这可能是什么过程以及如何解决它。

```
私人无效组合框3_SelectedIndexChanged（对象发送者，EventArgs e）
        {            
            专辑专辑 = GetAlbum(comboBox1.SelectedIndex);
            照片照片 = GetPhoto(comboBox1.SelectedIndex, comboBox3.SelectedIndex);           

            txtPhotoPath.Text = Directory.GetCurrentDirectory() + "\\" + photo.SPath;

            lblExtention.Text = 照片.SExtention;
            txtPhotoTitle.Text = 照片.STitle;
            pctrbFoto.Image = Image.FromFile(foto.SPath).GetThumbnailImage(GetWitdth(photo.SPath, GetHeight(photo.SPath, 150)), GetfHeight(photo.SPath, 150), null, new IntPtr());
        }

私人无效btnChangePhoto_Click（对象发送者，EventArgs e）
{
            专辑专辑 = GetAlbum(comboBox1.SelectedIndex);
            照片照片 = GetPhoto(comboBox1.SelectedIndex, comboBox3.SelectedIndex);

            File.Delete("相册\\图片\\" + photo.STitle + foto.SExtention);

            photo.SExtention = lblExtention.Text;
            photo.STitle = txtPhotoTitel.Text;
            Photo.SPath = txtPath.Text;

            File.Copy(photo.SPath, "Albums\\Images\\" + photo.STitle + photo.SExtention);

}
```

谢谢，文森特

* * *

感谢大家的帮助。

我用过这个，现在效果很好

* * *

您的进程是使用文件的进程，您需要将 image 设置为 null 使用如下内容：

var img = Image.FromFile(foto.SPath).GetThumbnailImage(GetWitdth(photo.SPath, GetHeight(photo.SPath, 150)), GetfHeight(photo.SPath, 150), null, new IntPtr());

pctrbFoto.Image = img;

img = null;

GC.Collect();

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T14:10:02.143

我要查看的第一个区域是您的 GetPhoto 方法。您是否有尚未关闭的 StreamReader？确保如果您在删除之前对文件执行任何类型的 I/O，请先关闭这些连接。GetPhoto() 方法有什么作用？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T14:12:41.013

首先，您需要确定打开文件的是*您的*应用程序还是其他应用程序。

您可以使用 Mark Russinovich 的 Process Explorer 查看哪个程序打开了特定文件或目录。它是 Windows Sysinternals 系列优秀实用程序的一部分，每个程序员/IT 专业人员都应该使用（或至少知道）。

你可以在这里得到它：[http ://technet.microsoft.com/en-us/sysinternals/bb896653.aspx](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-01T14:15:30.010

您在哪里获得缩略图使用：

```
using(Image img = Image.FromFile(foto.SPath))
{
  pctrbPhoto. Image = img.GetThumbnailImage(
  GetWitdth(photo.SPath, GetHeight(photo.SPath, 150)), 
  GetfHeight(photo.SPath, 150), null, new IntPtr()); 
} 
```

而是确保在您完成源图像后处理（关闭）它。

他们以你的方式拥有它，从文件加载的图像会一直存在，直到垃圾收集器决定释放它，这可能需要一段时间。

使用 FromFile 加载的图像包含从打开加载它们的文件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-01T14:13:48.703

当您调用`Image.FromFile`时`comboBox3_SelectedIndexChanged`，也许还有其他地方，您不会处理该`Image`对象。因此，您的程序正在使用该文件。

每次打开时都需要 Dispose 图像。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-01T14:20:17.313

您的进程是使用文件的进程，您需要将 image 设置为 null 使用如下内容：

```
using(var img = Image.FromFile(foto.SPath).GetThumbnailImage(GetWitdth(photo.SPath, GetHeight(photo.SPath, 150)), GetfHeight(photo.SPath, 150), null, new IntPtr()))
  pctrbFoto.Image = img; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-01T14:14:55.987

当所有其他方法都失败时，您可以使用[MoveFileEx](http://msdn.microsoft.com/en-us/library/aa365240(VS.85).aspx)在下次重新启动时删除该文件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-01T14:13:48.517

您可以使用 Unlocker 程序告诉您哪些程序已锁定文件

**注意：**已删除 Unlocker 程序的链接 - 包含恶意软件。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-09-28T15:35:44.770

...但是，如果您的应用程序在网络托管计划上运行？您不能在共享服务器中运行任何软件。

我尝试过使用 dispose() 和其他选项，但我无法删除像 Vinzcent 这样的文件。

马尔迪托 IIS :@

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-12-17T12:33:38.427

**尝试从同一软件删除/修改以前保存的文件时会出现此问题。我通过添加以下代码解决了它：**

```
System.GC.Collect(); 
System.GC.WaitForPendingFinalizers();

File.Delete(MyFile); 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2018-06-13T13:08:20.140

我曾经使用过**thestar**和**Sadegh**之类的东西，但在某些情况下它不起作用/没有帮助，所以我找到了一个不同的解决方案，我已经在[这里发布了它](https://stackoverflow.com/questions/22769029/filestream-to-open-an-image-system-unauthorizedaccessexception-access-to-the-p/50837932#50837932)

代码仍然在这里（观看链接和问题后，您可能会更好地理解它）：

```
 var imageAsByteArray = File.ReadAllBytes(imagePath);

   // I use as example a pictureBox:
   pictureBox1.Image = byteArrayToImage(imageAsByteArray);

   // Or/and safe/copy/replace it:
   File.WriteAllBytes(picture_Path, imageAsByteArray); 
```

您也可以立即删除（新）图片！（如果你想）

# c# - 从绑定源获取行数据绑定到列表框

> ID：811506
> 
> 赞同：0
> 
> 时间：2009-05-01T14:07:46.657
> 
> 标签：c#, .net, data-binding, listbox

我有一个像这样的列表框：

```
list.DataSource = bindingSource;
list.DisplayMember = "column_name"; 
```

稍后我想`ID`从`DataSet`with中获取所选项目`bindingSource.Current`。我以前用`bindingNavigator`and做过这个`bindingSource`， where`Current`返回 a `DataRowView`，所以我可以转换它，我就完成了：

```
Int32.Parse(((DataRowView)bindingSource.Current)["id"].ToString()) 
```

但在这种情况下`Current`返回一个`DataViewManagerListItemTypeDescriptor`对象，我不能转换它。

任何想法将不胜感激！

丹尼尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T14:12:39.347

`list.SelectedItem`应包含所选行的`DataRowView`. 那么你就可以：

```
var row = (MyRowType)((DataRowView)list.SelectedItem).Row; 
```

# asp.net-mvc - 如何在我的 ASP.NET MVC 项目中获得“添加控制器”和“添加视图”菜单选项？

> ID：811510
> 
> 赞同：3
> 
> 时间：2009-05-01T14:08:56.500
> 
> 标签：asp.net-mvc

我手动将 ASP.NET MVC 添加到现有的 WebForms 应用程序...感谢 [本教程](http://www.packtpub.com/article/mixing-asp.net-webforms-and-asp.net-mvc)。

但是，现在我没有菜单选项（右键单击 Controllers 文件夹或 Views 文件夹时）来显示“添加控制器”或“添加视图”对话框。我在创建一个全新的 MVC 项目时确实有这个。如何让 Visual Studio 意识到我在这个混合项目中使用 MVC？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-01T14:36:37.277

从技术上讲，控制器只是放在控制器文件夹中的 .CS 文件，而视图只是放在视图文件夹中的 .ASPX 文件。您的控制器类需要从基控制器类继承，您的 ASPX 页面需要从 System.Web.Mvc.ViewPage 继承。

至于在菜单中获取这些项目，请尝试打开项目文件并用这个替换 projecttypeguids 标记。

```
<ProjectTypeGuids>{603c0e0b-db56-11dc-be95-000d561079b0};{349c5851-65df-11da-9384-00065b846f21};{fae04ec0-301f-11d3-bf4b-00c04f79efbc}</ProjectTypeGuids> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-10-17T12:44:48.933

为了修复您的机器，请访问[http://www.microsoft.com/en-us/download/details.aspx?id=41532](http://www.microsoft.com/en-us/download/details.aspx?id=41532)的 URL并确保安装“ASP.NET 和 Web Tools 2013.1 for Visual Studio 2012”和“ASP.NET 和 Web 框架 2013.1 - Visual Studio 2012”。

安装后，您应该将它们都放在已安装的程序列表中。

有关更多详细信息，您可以查看此 URL：http: [//blogs.msdn.com/b/webdev/archive/2013/11/18/announcing-release-of-asp-net-and-web-tools-2013-1 -for-visual-studio-2012.aspx](http://blogs.msdn.com/b/webdev/archive/2013/11/18/announcing-release-of-asp-net-and-web-tools-2013-1-for-visual-studio-2012.aspx)。

项目类型 GUID 只是一种解决方法。但是在你安装这些之后它会自动被删除。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-22T16:46:32.317

我遇到了同样的问题，除了我从一个 Asp.Net MVC 项目开始干净利落。不知道为什么会这样。虽然我完全了​​解控制器是什么（Harv），但我仍然希望上下文相关菜单选项提供的自动生成功能。在编辑控制器文件时，CS 菜单没有出现在解决方案资源管理器或文档窗口中，根据 Walther 视频，他只需右键单击 Index 方法，然后获得一个创建视图的 cs 菜单选项，一个添加视图对话框窗口. 哦，顺便说一句，我的项目指南与您提供的指南相同，因此没有帮助。

谢谢，柏辽兹

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-11-05T16:07:41.550

什么都不做，只更新你的 MVC 项目版本。在 Nuget 包管理器控制台中触发此命令。

> 更新包 Microsoft.AspNet.Mvc

重新启动您的视觉工作室项目。

也不要忘记这一点。为了解决这个错误

> 通过安全透明方法“WebMatrix.WebData.PreApplicationStartCode.Start()”尝试

安装包 -Id Microsoft.AspNet.WebHelpers

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-10-28T15:20:20.600

我在 Visual Studio Enterprise 2015 update1 中遇到了这个问题，并通过安装最新更新得到了解决。

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2009-05-01T15:54:06.217

ASP.NET MVC 更喜欢约定而不是配置，所以除了 Harv 的回答之外，真的没有其他办法可以设置它。您必须右键单击名为 Controllers 的文件夹和名为 Views 的文件夹才能获得这些选项。

# php - 何时发送 HTTP 状态码？

> ID：811513
> 
> 赞同：4
> 
> 时间：2009-05-01T14:10:29.523
> 
> 标签：php, http, header, http-headers

目前在我的 PHP 脚本中，当他/她尝试访问不存在或不属于该用户的内容时，我将用户重定向到自定义 404 未找到错误页面。像这样：

```
header('Location: http://www.mydomain.com/error/notfound/');
exit; 
```

我意识到上面的 header() 调用默认发送一个 302 重定向状态码。

但是，我不明白什么时候应该发送 404 not found 状态码。在我重定向用户之前？或者当我显示*/error/notfound/*页面时？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-01T14:21:48.903

你应该这样做：

```
header("HTTP/1.0 404 Not Found");
include 'error.php';
die(); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-01T14:20:50.120

您根本不会将 404 错误作为重定向执行。

您真正想要做的是发送 404 状态标头，然后将当前输出替换为 404 页面的正文。

有多种方法可以做到这一点，这在很大程度上取决于您网站的结构。MVC 应用程序通常使用转发来处理它。我见过其他抛出异常的系统，然后注册的异常处理程序负责显示 404 页面。

无论如何，粗略的步骤是

1.  确定内容无效
2.  中断当前执行
3.  清除任何输出，如果有的话。
4.  发送 404 状态头
5.  发送404页面内容

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T14:18:11.517

您不能同时使用 404 和 Location:。位置仅对某些响应有效（201 和 3xx）

但是，您可以将自定义 HTML 页面作为 404 响应的正文发送。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T16:40:44.963

来自 php.net：

> 有两个特殊情况的标头调用。第一个是以字符串“HTTP/”（大小写不重要）开头的标头，用于确定要发送的 HTTP 状态代码。例如，如果您已将 Apache 配置为使用 PHP 脚本来处理丢失文件的请求（使用 ErrorDocument 指令），您可能希望确保您的脚本生成正确的状态代码。

```
<?php
header("HTTP/1.0 404 Not Found");
?> 
```

[http://us.php.net/manual/en/function.header.php](http://us.php.net/manual/en/function.header.php)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T14:23:12.970

您应该发送一个 404 HTTP 状态代码。浏览器和[爬虫](http://googlewebmastercentral.blogspot.com/2008/08/farewell-to-soft-404s.html)明白这一点。您可能还希望包含一个更友好的错误页面来解释发生了什么，包括用于搜索您的站点的表单、Soundex 链接等。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T14:23:39.863

“重定向”和“未找到”是不同的概念。

可以找到哪个文件？
[http://www.mydomain.com/error/notfound/](http://www.mydomain.com/error/notfound/)
或
[http://www.mydomain.com/not_exist.html](http://www.mydomain.com/not_exist.html)

“ [http://www.mydomain.com/not_exist.html](http://www.mydomain.com/not_exist.html) ”页面应该有一个 404 标题和“页面未找到”内容。

快速修复可能是：

```
header("HTTP/1.0 404 Not Found");
readfile('http://www.mydomain.com/error/notfound/');
exit; 
```

但这需要 2 个 apache 请求并且有点讨厌。

# perl - Perl 中未初始化的哈希键的默认值是否为零？

> ID：811515
> 
> 赞同：8
> 
> 时间：2009-05-01T14:10:43.080
> 
> 标签：perl, hash, default-value

我有类似于以下的 Perl 代码：

```
# -- start --

my $res;

# run query to fetch IPv6 resources
while( my $row = $org_ip6_res->fetchrow_arrayref )
{
    if( $row->[4] =~ /PA/ ) {
        $res->{ipv6}{pa}{$row->[2]}++;
    } elsif( $row->[4] eq 'PI' ) {
        $res->{ipv6}{pi}{$row->[2]}++;
    }
}

# -- stop -- 
```

`$res`在迭代查询结果之前从未设置过任何一点，但代码运行得很好。

当我在每个值之前放置打印语句时，在这两种情况下我都会得到空白，但如果打印语句是在应用增量之后出现的，我会得到 >= 1 的值，具体取决于组织拥有多少 IPv6 资源。

我的问题是，我是否认为这意味着 Perl 中未初始化的哈希键的值自动为零？

抱歉，如果它是一个新手问题，但我只是不熟悉这样的构造，即`$hashref->{foo}->{bar}++` 尚未明确分配值的地方`$hashref->{foo}->{bar}`。提前致谢！

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-01T14:28:49.477

该值不会自动为零。该值最初是未定义的。然而，如果你把它当作一个数字来对待（例如，应用`++`到它上面），那么 Perl 就会把它当作零来对待。如果你把它当作一个字符串来对待（例如，应用`.`到它），那么 Perl 就会把它当作一个空字符串来对待。

来自`perldoc perlsyn`，在“声明”下：

> 您需要在 Perl 中声明的唯一内容是报告格式和子例程（有时甚至不需要子例程）。一个变量保存未定义的值（“undef”），直到它被分配一个定义的值，它不是“undef”。当用作数字时，“undef”被视为0；当用作字符串时，它被视为空字符串，“”；当用作未分配给的引用时，它被视为错误。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-01T15:11:35.053

为了详细说明 Telemachus 的帖子，未初始化的值将是未定义的。结构的深层部分是[自动激活](http://perldoc.perl.org/perllexwarn.html#Category-Hierarchy)的。这是一个方便的功能，可以自动为您创建数据结构。当你想要它时，自动激活非常棒，但当你想要阻止它时，它可能会很痛苦。网上有很多关于理解自动生存的教程、文章和帖子。

所以给定一个未定义的`$ref`and `$ref->{ipv6}{pa}{'foo'}++`，`$ref`将被赋值为：

```
$ref = { 
     ipv6 => { 
          pa => { 
              foo => undef
          }
     }
}; 
```

然后 undef 将被递增，因为 undef 计数为 0，所以我们得到 0++，即 1。对于最终结果：`ref->{ipv6}{pa}{'foo'} == 1`。

如果您启用了警告，（您这样做`use warnings;`，不是吗？）当您对这些未定义的值进行操作时，您将收到“未初始化的值”警告。如果增加未初始化的值是所需的行为，那么您可以在代码的有限部分上关闭所需的警告组：

```
use strict;
use warnings;
my $res;

// run query to fetch IPv6 resources
while( my $row = $org_ip6_res->fetchrow_arrayref )
{   no warnings 'uninitialized';
    if( $row->[4] =~ /PA/ ) {
        $res->{ipv6}{pa}{$row->[2]}++;
    } elsif( $row->[4] eq 'PI' ) {
        $res->{ipv6}{pi}{$row->[2]}++;
    }
} 
```

[您可以在perllexwarn](http://perldoc.perl.org/perllexwarn.html#Category-Hierarchy)中找到警告层次结构。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-01T14:34:44.423

它基本上是未定义的，但是当你增加它时它被视为零。

Perl 用语中的术语是“autovivified”。

您可能想要做的是使用[exists 关键字](http://perldoc.perl.org/functions/exists.html)：

```
$res->{ipv6}{pa}{$row->[2]}++ if exists($res->{ipv6}{pa}{$row->[2]}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-01T18:03:27.667

没有未初始化的哈希*键*之类的东西。可以未初始化的是特定键的*值。*哈希值只是一个标量值；它与类似的变量没有什么不同`$foo`。

您的示例中有几个不同的 Perl 功能在交互。

最初`$res`是未定义的（即它具有值`undef`）。当您使用未初始化的值作为散列引用时（如 中`$res->{ipv6}...`），Perl 将其“自动激活”为一个。也就是说，Perl 创建一个匿名散列并用`undef`对新散列的引用替换 的值。每次您使用结果值作为参考时，此过程都会（无声地）重复。

最终，您以自己的方式自动激活到`$res->{ipv6}{pa}{$row->[2]}`，这是未定义的。请记住，这只是一个标量值，例如`$foo`. 行为和说的一样

```
my $foo;
$foo++; 
```

当您使用未定义的值时，Perl 会做一些特殊的事情。如果将它们用作数字，Perl 会将它们转换为 0。如果将它们用作字符串，Perl 会将它们转换为 ''（空字符串）。在大多数情况下，如果您启用了警告（您应该这样做），您将收到“使用未初始化的值...”警告。不过，[自增](http://perldoc.perl.org/perlop.html#Auto-increment-and-Auto-decrement)运算符 ( `++`) 是一种特殊情况。为方便起见，它在递增值之前默默地将值从转换为`undef`。`0`

# c# - 如何使用 shell 的默认处理程序打开文件？

> ID：811521
> 
> 赞同：30
> 
> 时间：2009-05-01T14:13:38.203
> 
> 标签：c#, .net, winforms

我们的客户端（一个 winforms 应用程序）包括一个文件浏览器。我希望用户能够使用 shell 的默认处理程序打开选定的文件。我怎么做？我读过我应该使用 Win32 API 而不是注册表，但我更喜欢只涉及 .NET 的解决方案。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-05-01T14:18:14.840

编辑：更新，更简单的答案。

您确实可以使用`Process.Start(filename)`. 这是在[文档中`Process.Start`](http://msdn.microsoft.com/en-us/library/53ezey2s.aspx)指定的：

> 通过指定文件名来启动进程类似于在 Windows“开始”菜单的“运行”对话框中键入信息。因此，文件名不需要代表可执行文件。它可以是扩展名与系统上安装的应用程序相关联的任何文件类型。例如，如果您将文本文件与记事本等编辑器关联，则文件名可以具有 .txt 扩展名；如果您将 .doc 文件与诸如 Microsoft Word 的文字处理工具关联，则文件名可以具有 .doc。同样，与“运行”对话框可以接受带有或不带有 .exe 扩展名的可执行文件名相同的方式，.exe 扩展名在 fileName 参数中是可选的。例如，您可以将 fileName 参数设置为“Notepad.exe”

编辑：原始的，复杂的答案：

如果您`Process.Start`将该文件用作“可执行文件”并指定`UseShellExecute = true`它就可以工作。例如：

```
using System;
using System.Diagnostics;

class Test
{
    static void Main()
    {
        ProcessStartInfo psi = new ProcessStartInfo("test.txt");
        psi.UseShellExecute = true;
        Process.Start(psi);
    }
} 
```

这将在记事本中打开 test.txt。

事实上，`UseShellExecute=true`它是默认值，但由于它绝对是必需的，我喜欢明确指定它以使读者更清楚。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-01T14:17:44.717

不确定是否可以

```
System.Diagnostics.Process.Start(filePath); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2021-04-21T22:16:12.983

由于这个问题是谷歌的第一个结果，我正在为 .NET Core 和 .NET 5 向上添加这个更新的答案。您将需要添加`UseShellExecute = true`.

```
Process.Start(new ProcessStartInfo(filePath) { UseShellExecute = true }); 
```

使用 .NET Framework 比以前更麻烦，但您可以将其包装在自定义方法中：

```
 public static void OpenFile(string filePath) 
        => Process.Start(new ProcessStartInfo(filePath) { UseShellExecute = true }); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-01T14:25:33.510

System.Diagnostics.Process 为 shell32.ShellExecute 提供了 .Net 原生包装器。

有关这两种 API 的讨论，请参阅[PInvoke.Net ，以及 MSDN 上的](http://www.pinvoke.net/default.aspx/shell32.ShellExecute)[MSDN](http://msdn.microsoft.com/en-us/library/53ezey2s.aspx)文档。

# c# - C# DataGridView AutoSizeRowsMo de 问题

> ID：811528
> 
> 赞同：2
> 
> 时间：2009-05-01T14:15:28.963
> 
> 标签：c#, winforms, datagridview, .net-2.0

我有一个 DataGridView，我以编程方式向其中添加数据。我将 AutoSizeRowsMo​​de 设置为 AllCells，并将 RowsDefaultCellStyle 上的 WrapMode 设置为 True。如果我向 DataGridView 添加多行行，它会显示得很好（自动缩放行以显示多行）。但是，如果我隐藏具有多行数据的列（以便留下的列只有单行数据），则行调整为单行，但是当我重新显示隐藏列时，行不会调整大小。如果我调整表格大小，那么行将更正。

以下代码显示了我如何切换列的可见性： notificationDataGridView.Columns[1].Visible = !notificationDataGridView.Columns[1].Visible;

谁能帮我解决这个问题？我已经尝试了我能想到的所有 Invalidate 和 Refresh 组合。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T14:33:52.913

好的，我不知道这是否是 DataGridView 中的错误或其他什么，但这里有一个 hack 让它工作。调用后：

```
notificationDataGridView.Columns[1].Visible = !notificationDataGridView.Columns[1].Visible; 
```

添加这两行代码：

```
notificationDataGridView.DefaultCellStyle.WrapMode = DataGridViewTriState.NotSet;
notificationDataGridView.DefaultCellStyle.WrapMode = DataGridViewTriState.True; 
```

不要问我为什么，但这似乎有效。如果有人有更好的解决方案，请发布！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-16T15:35:59.570

我遇到了行高未正确调整大小的类似问题。在我的 DataGridView 中，我使用 CellFormatting 事件将自定义数据写入 DataGridViewTextBoxColumn，它在相关列上有 AutoSizeRowsMo​​de=AllCells 和 DefaultCellStyle.WrapMode=DataGridViewTriState.True。我在该列的单元格文本中使用 \r\n 来添加额外的行。在更改数据以向其中一行添加额外的行后，它没有调整大小，因此没有显示我添加的额外行。我尝试了上述解决方法试图强制它重新绘制行高，但它没有用。不过，以下讨厌的解决方法确实对我有用：

```
dataGridView.Width++;
dataGridView.Width--; 
```

奇怪的是，这种技巧只能通过重置宽度而不是高度来起作用。

# python - 如何在 Tkinter 消息窗口中自动滚动

> ID：811532
> 
> 赞同：14
> 
> 时间：2009-05-01T14:16:00.897
> 
> 标签：python, qt, qt4, tkinter, ipython

我编写了以下类，用于在额外的窗口中生成“监控”输出。

1.  不幸的是，它不会自动向下滚动到最近的一行。怎么了？
2.  因为我对 Tkinter 和 ipython 也有问题：qt4 的等效实现会是什么样子？

这是代码：

```
import Tkinter
class Monitor(object):
  @classmethod
  def write(cls, s):
    try:
      cls.text.insert(Tkinter.END, str(s) + "\n")
      cls.text.update()
    except Tkinter.TclError, e:
      print str(s)
  mw = Tkinter.Tk()
  mw.title("Message Window by my Software")
  text = Tkinter.Text(mw, width = 80, height = 10)
  text.pack() 
```

用法：

```
Monitor.write("Hello World!") 
```

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-05-01T14:50:48.380

`cls.text.see(Tkinter.END)`在调用 insert 之后添加一条语句。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-07-19T14:53:24.870

对于那些可能想尝试绑定的人：

```
def callback():
    text.see(END)
    text.edit_modified(0)
text.bind('<<Modified>>', callback) 
```

小心点。正如@BryanOakley 指出的那样，修改后的虚拟事件只被调用一次，直到它被重置。考虑如下：

```
import Tkinter as tk

def showEnd(event):
    text.see(tk.END)
    text.edit_modified(0) #IMPORTANT - or <<Modified>> will not be called later.

if __name__ == '__main__':

    root= tk.Tk()

    text=tk.Text(root, wrap=tk.WORD, height=5)
    text.insert(tk.END, "Can\nThis\nShow\nThe\nEnd\nor\nam\nI\nmissing\nsomething")
    text.edit_modified(0) #IMPORTANT - or <<Modified>> will not be called later.
    text.pack()
    text.bind('<<Modified>>',showEnd)

    button=tk.Button(text='Show End',command = lambda : text.see(tk.END))
    button.pack()
    root.mainloop() 
```

# static - Windows平台上的静态库问题

> ID：811534
> 
> 赞同：0
> 
> 时间：2009-05-01T14:16:12.487
> 
> 标签：static

关于windows平台静态库的两个问题，

1.  如何检查 lib 是否是静态库（例如，DLL 的导入库或其他不是合法静态库文件的格式，即使文件名具有 .lib 扩展名）；
2.  构建静态库时如何检查是否使用了MT或MD标志？

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T14:20:21.667

你的问题2很简单。`dumpbin`VC中的工具可以简单地做到这一点：

```
dumpbin /directives your_static_lib.lib 
```

[然后通过MSVC 运行时库列表](http://msdn.microsoft.com/en-us/library/abx4dbyh(VS.71).aspx)检查依赖库名称

# jquery - 如何将 CSS 主题仅应用于特定的 jQuery-UI 元素？

> ID：811545
> 
> 赞同：12
> 
> 时间：2009-05-01T14:18:37.053
> 
> 标签：jquery, css, jquery-ui

我已经用我自己的 CSS 主题构建了一个网站。我正在使用 jQuery UI“选项卡”小部件，但没有来自 jQuery-UI 的 CSS。

现在，我正在尝试在我的一个页面中添加“日期选择器”小部件。如果我可以重用 jQuery-UI 默认主题就好了。

问题是日期选择器主题也适用于我的标签 CSS。例如，“ui-widget”css 属性适用于日期选择器和选项卡元素。

我似乎找不到将css属性仅应用于日期选择器的方法。我看不到仅适用于日期选择器 DIV 的“超级选择器”。

处理这个问题的最佳方法是什么？

* * *

[编辑] [datepicker](http://jqueryui.com/demos/datepicker/)小部件确实是问题所在。我无法应用特定于它的 CSS 样式。这是弹出的DIV的起始代码：

```
<div style="position: absolute; top: 300.4px; left: 149px; display: block;" id="ui-datepicker-div" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all ui-helper-hidden-accessible"><div class="ui-datepicker-header ui-widget-header ui-helper-clearfix ui-corner-all"> 
```

因此，我无法添加超级选择器。[如果日期选择器小部件支持CSS 范围](http://www.filamentgroup.com/lab/using_multiple_jquery_ui_themes_on_a_single_page/)，那就太好了。但事实并非如此。我被困在手动编辑 jQuery CSS 文件中。

日期选择器当前正在[重构](http://wiki.jqueryui.com/Datepicker)。希望新代码能解决这个问题。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-04-19T18:43:25.603

```
$(window).load(function() {
   $('#ui-datepicker-div').addClass('CSS-Scope-Class');
}); 
```

.addClass [()](http://api.jquery.com/addClass/ "。裹（）") jQuery 函数会将必要的类添加到日期选择器中，以供主题样式表拾取。

我不得不附加到窗口的加载事件而不是文档的就绪事件，因为那时还没有插入日期选择器。

注意：在将日期选择器添加到 DOM 和应用新类之间会有一个小的延迟，这意味着在页面完成加载时日期选择器可能会显示为无样式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-01T14:23:10.567

您可以在此处使用主题滚轮自定义主题[http://jqueryui.com/themeroller/](http://jqueryui.com/themeroller/)

使用 Firebug 的检查 DOM 功能找到您要设置样式的项目，以定位您要选择的类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-05-11T09:39:30.757

尝试：`$('#cmsContent').css('margin', '0');`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T14:45:51.467

我在使用日期选择器和手风琴时遇到了同样的问题。我想要 datepicker 的新样式，但不想要手风琴。我采取了简单的方法，我复制了 ui.theme.css 的相关部分，并在所有样式前面添加了 .ui-datepicker。这仅针对日期选择器，而单独保留所有其他 UI 插件。

我不确定这是否是最好的方法，但它适用于我的目的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T15:21:52.657

我可能会遗漏一些东西，但你不能只向你的日期选择器对象添加一个类并选择它吗？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-09-05T08:05:32.357

简单地向 datepicker div 添加一个 css 类对我来说不起作用，我必须像这样围绕它创建另一个 div：

```
$("#ui-datepicker-div").wrap('<div class="CSS-Scope-Class" />'); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-12-15T15:37:23.763

这对我有用

```
$("#ui-datepicker-div").wrap("<div class='Your-CSS-Scope-Class'></div>"); 
```

# bash - 在编辑器中加载 egrep 的结果 (vim/emacs/gedit)

> ID：811546
> 
> 赞同：1
> 
> 时间：2009-05-01T14:18:59.377
> 
> 标签：bash, shell, grep

在 egrep 命令之后，我得到了一些文件，例如

```
egrep -l -r '(this|that|those)' * 
```

这将列出大约 20 个文件。我不想手动打开每个文件，有没有办法将结果从`grep`, 直接重定向到编辑器，以便编辑器向我打开这些文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T14:33:39.513

```
egrep -l 'pattern' * | xargs $EDITOR 
```

`$EDITOR`显然，应该设置为您选择的编辑器。

OTOH 说 editor 可能有一个较短的非大写名称，因此您只需直接输入即可。

我，我整天都在这样做：

```
ack --ruby -l 'pattern' | xargs mate 
```

（也采取比¹`ack`更酷的提示，默认情况下进行递归文件匹配，每种文件类型都有过滤器）^(`egrep`)

* * *

¹冷却器是指真正的`perl`正则表达式。

# iphone - 是否可以说名称包含 new、alloc、create 或 copy 的方法不会自动释放它们创建的对象？

> ID：811547
> 
> 赞同：2
> 
> 时间：2009-05-01T14:19:05.663
> 
> 标签：iphone, objective-c, cocoa-touch, memory-management, uikit

据我所知，只有“方便”方法返回带有 -autorelease 的创建对象，因此接收者不负责该对象的内存。但是因为Apple说当你使用一个名称由“new”、“alloc”、“create”或“copy”组成的方法时，你有责任释放方法返回的对象，我认为这些方法应该不 -autorelease 这些对象。否则，它们将是“方便的”，只要接收者不保留接收到的对象，他就根本不负责。我做对了吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-01T16:15:21.953

标题中的问题的答案是肯定的，但是：

> 只有“方便”方法返回带有 -autorelease 的创建对象

这绝对不是真的。*假定没有任何一个标记词（或有特定文档另有说明）的任何*方法都将返回一个您没有保留引用的对象。便利构造函数当然属于这一类，但 Cocoa 中的大多数其他方法也是如此。

返回一个你不负责释放的对象是 Cocoa 中的规则，而不是例外。

[这在Apple 关于 Cocoa 内存管理的在线文档](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/MemoryMgmt/MemoryMgmt.html)中有非常清楚的说明；你真的应该彻底阅读这些文件。您在本网站上提出的许多问题都已在该网站上得到解答，并且是权威来源。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-02T05:50:47.483

经验法则是您拥有（因此必须释放）您拥有的任何对象

*   alloc（使用以“alloc”或“new”开头的方法*）
*   复制（使用任何包含“复制”一词的方法）
*   明确地保留自己

*new 将 alloc 和 init 组合成一个方法。

便捷方法返回自动释放的对象。这些在您接收它们的方法的范围内有效，并且可以传递回调用方法（通常）。如果您想保留它们更长的时间，则需要保留它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T14:46:06.223

那是对的。官方的说法是在[Apple 的开发者网站](http://developer.apple.com/documentation/CoreFOundation/Conceptual/CFMemoryMgmt/Concepts/Ownership.html#//apple_ref/doc/uid/20001148-103029)This is for CoreFoundation，但它也适用于 Cocoa。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T14:47:51.100

几乎。

我不认为“创建”是 Apple 指南中定义的关键字之一。

否则你的逻辑是正确的。该方法返回的对象不被该方法的类保留。

```
NSObject *obj = [[someClass alloc]init]; // you are responsible
NSObject *obj = [someClass someConvenientMethod]; // the object is auto-released, you do not own this object 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T02:03:09.853

查看 Apple 关于[对象所有权和处置的文档](http://developer.apple.com/library/mac/ipad/#documentation/Cocoa/Conceptual/MemoryMgmt/Articles/MemoryMgmt.html)

# python - Sqlite 和 Python——使用 fetchone() 返回字典？

> ID：811548
> 
> 赞同：29
> 
> 时间：2009-05-01T14:19:06.943
> 
> 标签：python, database, sqlite, dictionary

我在 python 2.5 中使用 sqlite3。我创建了一个如下所示的表：

```
 create table votes (
      bill text,
      senator_id text,
      vote text) 
```

我用这样的东西访问它：

```
v_cur.execute("select * from votes")
row = v_cur.fetchone()
bill = row[0]
senator_id = row[1]
vote = row[2] 
```

我想做的是让 fetchone （或其他方法）返回一个字典，而不是一个列表，这样我就可以按名称而不是位置来引用该字段。例如：

```
bill = row['bill'] 
senator_id = row['senator_id']
vote = row['vote'] 
```

我知道你可以用 MySQL 做到这一点，但有人知道如何用 SQLite 做到这一点吗？

谢谢！！！

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2010-03-26T19:51:49.847

在 sqlite3 中实际上有一个选项。`row_factory`将连接对象的成员更改为`sqlite3.Row`：

```
conn = sqlite3.connect('db', row_factory=sqlite3.Row) 
```

或者

```
conn.row_factory = sqlite3.Row 
```

这将允许您通过名称——字典样式——或索引来访问行元素。这比创建自己的解决方法要有效得多。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-05-01T14:37:46.850

我过去这样做的方式：

```
def dict_factory(cursor, row):
    d = {}
    for idx,col in enumerate(cursor.description):
        d[col[0]] = row[idx]
    return d 
```

然后你在你的连接中设置它：

```
from pysqlite2 import dbapi2 as sqlite
conn = sqlite.connect(...)
conn.row_factory = dict_factory 
```

这适用于 pysqlite-2.4.1 和 python 2.5.4。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-01-29T02:29:29.200

我最近在使用 sqlite3.Row() 时尝试做类似的事情。虽然 sqlite3.Row() 非常适合提供类字典接口或类元组接口，但当我使用 **kwargs 在行中管道时它不起作用。因此，需要一种快速将其转换为字典的方法。我意识到只需使用 itertools 就可以将 Row() 对象转换为字典。

蟒蛇2：

```
db.row_factory = sqlite3.Row
dbCursor = db.cursor()
dbCursor.execute("SELECT * FROM table")
row = dbCursor.fetchone()

rowDict = dict(itertools.izip(row.keys(), row)) 
```

或者在 Python 3 中，更简单地说：

```
dbCursor = db.cursor()
dbCursor.execute("SELECT * FROM table")
row = dbCursor.fetchone()
rowDict = dict(zip([c[0] for c in dbCursor.description], row)) 
```

同样，您可以使用 dbCursor.fetchall() 命令并将整个行集转换为 for 循环中的字典列表。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-01T14:35:38.680

当然，让自己成为一个 DictConnection 和 DictCursor，如[http://trac.edgewall.org/pysqlite.org-mirror/wiki/PysqliteFactories](http://trac.edgewall.org/pysqlite.org-mirror/wiki/PysqliteFactories)中的解释和所示。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-04T09:33:33.360

我知道你不是在问这个，但为什么不直接使用 sqlalchemy 为数据库构建一个 orm？然后你可以做类似的事情，

```
 entry = model.Session.query(model.Votes).first()
print entry.bill, entry.senator_id, entry.vote 
```

作为额外的奖励，您的代码将很容易移植到替代数据库，并且连接和诸如此类的东西将免费管理。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-09-22T20:06:19.530

我用过这个：

```
def get_dict(sql):
    return dict(c.execute(sql,()).fetchall()) 
```

然后你可以这样做：

```
c = conn.cursor()
d = get_dict("select user,city from vals where user like 'a%'"); 
```

现在`d`是一个字典，其中键`user`和值是`city`。这也适用于`group by`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-07-18T13:01:25.467

简单的解决方案，初始化一个游标对象：

```
cursor = conn.cursor(buffered = True, dictionary = True) 
```

另外一个选项：

```
cursor = conn.cursor(MySQLdb.cursors.DictCursor) 
```

其余代码：

```
query = "SELECT * FROM table"
cursor.execute(query)
row = cursor.fetchone() 
```

来源： [mysql.connector.cursor](https://dev.mysql.com/doc/connector-python/en/connector-python-api-mysqlcursor.html)，[MySQLdb.cursors.DictCursor](http://mysql-python.sourceforge.net/MySQLdb-1.2.2/public/MySQLdb.cursors.DictCursor-class.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-08-27T10:35:46.790

我使用这样的东西：

```
class SqliteRow(object):
    def __init__(self):
        self.fields = []

    def add_field(self, name, value):
        self.fields.append(name)
        setattr(self, name, value)

    def to_tuple(self):
        return tuple([getattr(self, x) for x in self.fields]) 
```

有了这个：

```
def myobject_factory(cursor, row):
    myobject= MyObject()
    for idx, col in enumerate(cursor.description):
        name, value = (col[0], row[idx])

        myobject.add_field(name, value)
    return myobject 
```

`MyObject()`是一个继承自 的类`SqliteRow`。SqliteRow 类是我希望通过查询返回的每个对象的基类。每列都成为一个属性并记录到`fields`列表中。函数`to_tuple`用于将整个对象更改为适合查询的形式（只需传递整个对象并忘记）。

获取该函数的不同类类型。您需要创建一个工厂对象，它将根据字段列表生成对象（例如：带有 { some_unique_value_made_of_fields: class} 的 dict ）

这样我就得到了一个简单的 ORM。

# database - 有问题的数据模式，性能方面

> ID：811554
> 
> 赞同：0
> 
> 时间：2009-05-01T14:20:13.633
> 
> 标签：database, performance, design-patterns, scaling

断言：当数据量变得非常大（例如，数十或数百 TB）时，SQL 数据库的性能会下降。这意味着当数据库增长时，对于大多数中小型数据库来说合理的数据库设计中的某些模式会崩溃。对于（一个相当普遍的）示例，有一种趋势是远离设计完全（或者说，BCNF）规范化的数据模型，因为必要的连接会严重影响性能。另请参阅[此问题](https://stackoverflow.com/questions/173726/when-and-why-are-database-joins-expensive)

我的问题是：您是否知道任何数据库模式，尽管在典型数据库中是合理的，但对于 huuuge 数据库（尤其是 SELECT 查询**）而言（性能方面）会崩溃？**是否有替代策略可以在没有这些性能问题的情况下实现相同（数据方面）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T20:22:28.200

首先想到的是将文件作为 blob 存储在数据库中。我见过许多系统开始时相当小，例如在单个 blob 数据表中低于 10GB，然后随着它们的增长开始达到上限。您可以通过正确构建解决方案来减轻一些损害，但一般来说，我认为在数据库中存储文件的模式会随着大小的增加而崩溃。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T14:23:48.100

身份列？！

包含大量数据和大量插入/删除事务的巨大表可能会发生这种情况。

编辑：好的。重新阅读您的问题。对于包含很多行的表中的插入，**索引**可能是巨大的**性能瓶颈。**

# asp.net - 如何让我的 RadioButtonList 垂直堆叠显示？

> ID：811562
> 
> 赞同：2
> 
> 时间：2009-05-01T14:21:05.753
> 
> 标签：asp.net, radiobuttonlist

`RadioButtonList`我的.aspx 页面上有一个，我将它加载到代码隐藏中。

我怎样才能让它垂直显示？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-01T14:24:35.650

```
RepeatDirection=Vertical 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T14:31:02.857

将重复方向更改为垂直。如果您在以您想要的方式呈现时遇到问题，您可能还想查看使用 RepeatLayout=Flow。通常，我会使用 RepeatLayout=Flow 并分配一个 CssClass 来处理样式。

# iphone - iPhone 游戏开发者——你的工具链是什么样的？

> ID：811567
> 
> 赞同：19
> 
> 时间：2009-05-01T14:22:22.893
> 
> 标签：iphone, opengl-es, build-process

例如：

*   源代码控制：git + adobe drive
*   3d：谷歌草图 -> *.dae -> 搅拌机 -> *.obj
*   2d：photoshop/illustrator -> *.png
*   音频：大胆-> *.caf
*   代码：ArgoUML、Xcode、Textmate
*   测试：OCUnit
*   构建：耙子，Xcode

随意提及您认为很棒的任何其他工具:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T21:48:03.527

git、github、Xcode、Interface Builder、Photoshop、Illustrator、TextMate、通过[Behavior](http://github.com/robrix/behaviour/)进行单元测试（在 github 上）、自定义 3D 软件、自定义音频软件。

这篇文章的好主意，我喜欢它！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T19:59:15.650

源代码控制：Subversion 2d：Adobe Fireworks 音频：QuickTime Pro、Audacity、afconvert 代码：Xcode 游戏设计：OmniGraffle，Pages 工具：Python

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T20:02:26.843

XCode、Emacs、GarageBand 和 Subversion。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-12T09:41:17.213

这是我的，

*   源代码控制：git + Dropbox
*   3d：搅拌机-> *.dae
*   2d: gimp -> *.tga
*   音频：目前没有音频:(
*   设计和代码：jEd、Xcode、Emacs
*   测试：谷歌测试
*   构建：CMake，Xcode

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T16:18:13.537

我使用 git、github、Lighthouse、Xcode/Interface Builder 和 Photoshop。我也使用 TextMate 来记笔记，如果你想计算的话。

# internet-explorer - 如何创建在 IE 和 Firefox 中都可以使用的 file:// 超链接？

> ID：811570
> 
> 赞同：10
> 
> 时间：2009-05-01T14:23:10.520
> 
> 标签：internet-explorer, firefox, hyperlink

在我的文档网页中，我经常需要提供指向存储在 Intranet 上的位置、文件和应用程序 (.xbap) 的链接。

在 IE 中，这适用于格式如下的 URL：

```
<a href="file://///company.org/ProjectA/StatsReport">Go to folder</a>
<a href="file://///company.org/ProjectA/Readme.txt">Download file</a>
<a href="file://///company.org/ProjectA/Dashboard.xbap">Run xbap</a> 
```

这些链接在 IE 下都可以正常工作，但在 Firefox 中却不行。

有谁知道我如何格式化上述链接以在 IE 和 Firefox 中工作？

**编辑** 如果我将它们放在本地文件中，上面的链接实际上可以工作。当它们是网络上 html 文件的一部分（不在我的机器上）时，它们仅在 Firefox 中停止工作。Firefox 中必须有某种安全设置来阻止来自外部内容的 file:/// 链接工作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T14:26:50.513

只需使用

```
file:/// 
```

据我所知，适用于 IE、Firefox 和 Chrome。

有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/aa767731(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa767731(VS.85).aspx)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-06-04T13:55:24.757

> 文件协议
> 打开本地或网络驱动器上的文件。
> 
> 句法
> 
> ```
> Copy
>  file:///sDrives[|sFile]
> Tokens 
> ```
> 
> sDrives
> 指定本地或网络驱动器。
> 
> sFile
> 可选。指定要打开的文件。如果省略 sFile 并且访问驱动器的帐户有权浏览目录，则会显示可访问文件和目录的列表。
> 
> 评论
> 
> 文件协议和 sDrives 参数可以省略，只替换为驱动器号和文件位置的命令行表示。例如，要浏览 My Documents 目录，可以将文件协议指定为 file:///C|/My Documents/ 或 C:\My Documents。此外，单个“\”相当于指定主本地驱动器上的根目录。在大多数计算机上，这是 C:。
> 
> 从 Microsoft Internet Explorer 3.0 或更高版本开始提供。
> 
> 注意 Internet Explorer 6 Service Pack 1 (SP1) 不再允许从 Internet 区域浏览本地计算机。例如，如果 Internet 站点包含指向本地文件的链接，则当用户单击该链接时，Internet Explorer 6 SP1 会显示一个空白页面。以前版本的 Windows Internet Explorer 遵循指向本地文件的链接。
> 
> 例子
> 
> 下面的示例演示了四种使用 File 协议的方法。
> 
> 复制
> 
> ```
> //Specifying a drive and a file name. 
> 
> file:///C|/My Documents/ALetter.html
> 
> //Specifying only a drive and a path to browse the directory. 
> 
> file:///C|/My Documents/
> 
> //Specifying a drive and a directory using the command line representation of the directory location. 
> 
> C:\My Documents\
> 
> //Specifying only the directory on the local primary drive. 
> 
> \My Documents\ 
> ```

[http://msdn.microsoft.com/en-us/library/aa767731](http://msdn.microsoft.com/en-us/library/aa767731)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-21T15:18:42.257

至少对于 Chrome，（我不了解 Firefox）您可以将浏览器中 URL 左侧的图标拖动到桌面上的文件夹位置，它将创建一个充当 Internet 快捷方式的文件。

我不知道文件格式是否通用，但 Chrome 似乎知道如何处理它。

生成的文件是一个`.url`文件，包含以下内容：

`[InternetShortcut] URL=http://www.accordingtothescriptures.org/prophecy/353prophecies.html`

您可以将 URL 替换为您想要的任何内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-22T13:26:02.957

将以下链接粘贴到直接在链接按钮单击事件下，否则使用javascript调用函数后面的代码

```
Protected Sub lnkOpen_Click(ByVal sender As Object, ByVal e As EventArgs) 
    System.Diagnostics.Process.Start(FilePath)
End Sub 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-10T08:16:15.977

如果其他人在文件 URI 中使用时发现此主题- 如果主机名是 Internet Explorer，则`localhost`行为完全不同- 如果您使用实际主机名，它可以正常工作（来自受信任的站点/内联网区域）。`localhost``127.0.0.1`

IE 和 FF-IE 之间的另一大区别是 uri 之类的很好，`file://server/share/file.txt`但 FF 需要额外的斜杠`file:////server/share/file.txt`。

# c# - 在 C# 中拦截 WebBrowser 发出的请求

> ID：811587
> 
> 赞同：8
> 
> 时间：2009-05-01T14:27:18.047
> 
> 标签：c#, http, request, browser

是否可以拦截控件发出的所有请求`WebBrowser`？

我想修改每个请求的请求 URI（包括对图像、脚本、样式表等的请求）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T19:09:07.150

有一个名为“ [BeforeNavigate2](http://msdn.microsoft.com/en-us/library/aa768326(VS.85).aspx) ”的事件在发出任何请求之前被调用。您可以使用它来修改传出请求。

# java - 如何在 Java 中通过 SSL 调用 Web 服务？

> ID：811590
> 
> 赞同：1
> 
> 时间：2009-05-01T14:28:39.993
> 
> 标签：java, web-services, ssl

我最近一直在开发一个 C# 应用程序，它通过 SSL 调用 Web 服务并使用 ServerCertificateValidationCallback 事件的委托来处理证书安全性，如下所示：

```
 System.Net.ServicePointManager.ServerCertificateValidationCallback += delegate(object certsender, X509Certificate certificate, X509Chain chain, SslPolicyErrors sslPolicyErrors)
        {
            bool validationResult = false;

            // if there are no SSL validation errors
            if (sslPolicyErrors == SslPolicyErrors.None)
            {
                validationResult = true;
            }

            return validationResult;
        }; 
```

现在我需要在 Java 中做同样的事情，这就是我卡住的地方——我已经用谷歌搜索了一段时间，并没有真正找到一个直接的答案。如何在 Java 中处理 SSL 证书验证？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T14:34:39.433

最近的java版本为你做。只需指向一个 HTTPS URL (https://)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T14:53:37.220

Apache HTTPClient 是处理 URL 以外的任何事情的最佳方式。这是[SSL 指南](http://hc.apache.org/httpclient-3.x/sslguide.html)。

# apache-flex - 为 Text 组件 (Flex/Actionscript) 查找鼠标所在的单词

> ID：811595
> 
> 赞同：1
> 
> 时间：2009-05-01T14:29:42.363
> 
> 标签：apache-flex, actionscript, text, rollover

是否有可能（如果可以）找出光标/鼠标在 < mx:Text > 组件上移动时所在的单词？因此，例如，当用户沿着一个句子（在文本组件内）移动鼠标时，每个单词都会随着它们的移动而突出显示（我知道您可以在按下鼠标按钮时突出显示 - 但我不希望这样做）。

感谢您提供任何信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-02T13:26:26.157

这是一种方法：您需要创建自己的组件来扩展 mx:Text 组件。我`MyText`在这个例子中使用过。这是完整的代码`MyText`：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Text xmlns:mx="http://www.adobe.com/2006/mxml" mouseMove="onMouseMove(event)" initialize="init()">
    <mx:Script>
        <![CDATA[

            // Text formats
            private var normalTextFormat:TextFormat;
            private var highlightTextFormat:TextFormat;

            // Saved word start and end indexes
            private var wordStartIndex:int = -1;
            private var wordEndIndex:int = -1;

            private function init():void
            {
                normalTextFormat = textField.getTextFormat();
                normalTextFormat.color = 0;
                highlightTextFormat = textField.getTextFormat();
                highlightTextFormat.color = 0xFF0000;
            }

            private function onMouseMove(event:MouseEvent):void
            {
                // Clear previous word highlight
                textField.setTextFormat(normalTextFormat, wordStartIndex, wordEndIndex);

                var charIndexUnderMouse:int = textField.getCharIndexAtPoint(event.localX, event.localY);
                wordStartIndex = charIndexUnderMouse;
                wordEndIndex = charIndexUnderMouse;

                // Find start of word
                while (text.charAt(wordStartIndex) != " " && wordStartIndex > 0)
                {
                    wordStartIndex--;
                }

                // Find end of word
                while (text.charAt(wordEndIndex) != " " && wordEndIndex < text.length)
                {
                    wordEndIndex++;
                }

                // Highlight character
                textField.setTextFormat(highlightTextFormat, wordStartIndex, wordEndIndex);
            }
        ]]>
    </mx:Script>

</mx:Text> 
```

它通过访问 Text 组件内的 TextField 对象的方法，找到鼠标坐标下的字符索引，然后找到该字符所属的单词来工作。这是一个简单的示例，您可能需要对其进行更详细的说明以供实际使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T15:19:25.113

您需要使用 TextSnapshot 类。您可以从 textSnapshot 属性的文本控件中获取它。TextSnapshot 有一个 hitTestTextNearPos() 函数，您可以使用它来确定用户的鼠标靠近哪个字符。

```
...
var startIndex:Number;
...

private function textMouseMoveHandler(event:MouseEvent):void
{
    var snapshot:TextSnapshot = text.textSnapshot;
    var index = snapshot.hitTestTextNearPos(event.x, event.y);

    snapshot.setSelected(startIndex, index, true);
}

// I do not know how you want to begin the selection, so I put it here in the MouseEnter event.
private function textMouseEnterHandler(event:MouseEvent):void
{

    var snapshot:TextSnapshot = text.textSnapshot;
    startIndex = snapshot.hitTestTextNearPos(event.x, event.y);
} 
```

不知道你想如何处理开始选择，但类似的东西应该可以。

# javascript - 为什么dojo网格需要json数据源中的name列

> ID：811596
> 
> 赞同：1
> 
> 时间：2009-05-01T14:29:45.013
> 
> 标签：javascript, json, dojo

在以下示例中，仅当 json 数据包含名称列时才会在网格中显示数据 -> 第一个网格显示数据，第二个不显示。

为什么会这样？

**index.html：** 道场网格

```
 <link rel="stylesheet" type="text/css" href="http://ajax.googleapis.com/ajax/libs/dojo/1.3/dijit/themes/tundra/tundra.css" />
    <link rel="stylesheet" type="text/css" href="http://ajax.googleapis.com/ajax/libs/dojo/1.3/dojo/resources/dojo.css" />
    <link rel="stylesheet" type="text/css" href="http://ajax.googleapis.com/ajax/libs/dojo/1.3/dojox/grid/_grid/tundraGrid.css">
    <script type="text/javascript" 
            src="http://ajax.googleapis.com/ajax/libs/dojo/1.3/dojo/dojo.xd.js" 
            djConfig="parseOnLoad: true, isDebug: true">
    </script>

    <script type="text/javascript">
      dojo.require("dojo.parser");
      dojo.require("dojox.grid.Grid");
      dojo.require("dojo.data.ItemFileReadStore");
    </script>

  </head>
  <body class="tundra">
   <span dojoType="dojo.data.ItemFileReadStore" 
            jsId="withNameStore" 
            url="WithNameColumn.json"
            clearOnClose="true">
    </span>
    <table id="withNameGrid"
           dojoType="dojox.grid.Grid" 
           store="withNameStore"
           clientSort="true"
           style="width: 20em; height: 20em;">
        <thead>
           <tr>
              <th field="ID" >ID</th>
              <th field="test">Test</th>
           </tr>
        </thead>
    </table>
    <span dojoType="dojo.data.ItemFileReadStore" 
          jsId="withoutNameStore" 
          url="WithoutNameColumn.json"
          clearOnClose="true">
    </span>
    <table id="withoutNameGrid" 
           dojoType="dojox.grid.Grid" 
           store="withoutNameStore"
           clientSort="true"
           style="width: 20em; height: 20em;">
        <thead>
           <tr>
              <th field="ID" >ID</th>
              <th field="test">Test</th>
           </tr>
        </thead>
    </table>
  </body>
</html> 
```

**WithNameColumn.json：**

```
{
  "identifier":"ID",
  "label":"test",
  "items":
    [{"ID":2,"name":"name1","test":"dog"},
     {"ID":3,"name":"name2","test":"cat"},
     {"ID":4,"name":"name3","test":"mouse"}]
} 
```

**没有NameColumn.json：**

```
{
  "identifier":"ID",
  "label":"test",
  "items":
    [{"ID":2,"test":"dog"},
     {"ID":3,"test":"cat"},
     {"ID":4,"test":"mouse"}]
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-25T08:13:58.877

只需向您的元素添加一个查询属性。像这样：

<table query="{ID:'*'}" ...>

这是因为它会在从数据存储请求数据时执行查询

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T05:41:10.080

不需要名称列，但您确实需要数据存储中的属性和网格中的列名称之间的映射。这是在定义网格“布局”时完成的，“布局”中的“字段”属性是数据存储中列的名称（准确的属性名称）和“布局”中的“名称”属性' 是网格中的列名。

```
gridLayout = [{
  defaultCell: {
    width: 8,
    editable: true,
    type: dojox.grid.cells._Widget,
    styles: 'text-align: right;'
  },
  rows: [{
      name: 'Id',
      field: 'id',
      editable: false /* Can't edit ID's of dojo.data items */
    },
    {
      name: 'Date',
      field: 'col8',
      width: 10,
      type: dojox.grid.cells.DateTextBox,
      formatter: formatDate,
      constraint: {
        formatLength: 'long',
        selector: "date"
      }
    },
    {
      name: 'Priority',
      styles: 'text-align: center;',
      field: 'col1',
      type: dojox.grid.cells.ComboBox,
      options: ["normal", "note", "important"],
      width: 10
    },
    {
      name: 'Mark',
      field: 'col2',
      width: 3,
      styles: 'text-align: center;',
      type: dojox.grid.cells.CheckBox
    },
    statusCell,
    {
      name: 'Message',
      field: 'col4',
      styles: '',
      width: 10,
      type: dojox.grid.cells.Editor,
      editorToolbar: true
    },
    {
      name: 'Amount',
      field: 'col5',
      formatter: formatCurrency,
      constraint: {
        currency: 'EUR'
      },
      widgetClass: dijit.form.CurrencyTextBox
    },
    {
      name: 'Amount',
      field: 'col5',
      formatter: formatCurrency,
      constraint: {
        currency: 'EUR'
      },
      widgetClass: dijit.form.HorizontalSlider,
      width: 10
    }
  ]
}]; 
```

# asp.net - 制图和数据处理

> ID：811601
> 
> 赞同：1
> 
> 时间：2009-05-01T14:31:52.310
> 
> 标签：asp.net, charts, data-mining

虽然这里有一些关于 .net 图表控件的线程，但我正在开始新线程，因为我可能正在寻找一些高级数据操作（也许这会属于数据挖掘，但我不确定）以及图表。

我被要求研究原型和关键绩效指标 (KPI) 系统。基本上，我们在数据库中有大量销售数据，我们想在这些数据中绘制/绘制各种关系。例如，我们在 2008 年 1 月提高了价格，将每个月的销售额与上一年的销售额进行比较并显示在图表中。

该数据库尚不存在 - 我们将从各种其他数据库中提取数据，因此将从头开始创建新数据库。目前我有一些 excel 格式的示例数据和一种在 excel 中创建的原型。

我想可能有两种方法可以解决这个问题：

1.  手动创建我需要的所有查询并将数据提供给 .net 图表控件。

或者

2.  是否有一些现成的数据操作/挖掘工具可以在提取数据中的关系方面做很多繁重的工作。不知道这种事情是否存在？（虽然我知道我试图为我的论文构建这样的东西 - 这是令人难以置信的废话！）

一个相关的注意事项是，Dundas 图表和 Microsoft asp.net 图表工具做同样的事情。在堆栈溢出的线程中，有人声称实际上有同样的事情，MS 买了 dundas 吗？有没有理由购买登打士而不是使用免费的 MS 图表控件？

对此的任何建议将不胜感激。提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T14:46:43.850

微软在他们的产品中使用了相当多的 Dundas 技术。例如，SQL Server 报告服务中的图表来自 Dundas，ASP.NET 图表中的图表控件也是如此。[您可以从 SSRS 团队的博主那里](http://blogs.msdn.com/alexgor/)阅读有关控件并有效使用它们的更多信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-29T02:48:05.980

听起来像是标准统计软件包的工作，例如 SAS、SPSS-PASW（以前称为 Clementine）、R、Stata 或 S-Plus。
虽然拥有某种框架来构建您的数据挖掘方法是有用的（并且在科学上更合理），但您可以在这些程序中实现例程，同时对您期望找到的内容（或您期望如何找到它）保持不可知论：

[http://www.sas.com/technologies/analytics/datamining/](http://www.sas.com/technologies/analytics/datamining/)

您可以将您的数据从您的数据库导入或查询到这些程序中的任何一个，并且这些程序中的大多数都包含让您可以直接查询大量数据库的例程（例如，SQL、mySQL、PostGreSQL），从而使您能够自动化处理不受惩罚地提取、数据挖掘和可视化/图形化您的数据。

# sql-server-2005 - SQL Server 插入数据的转储

> ID：811603
> 
> 赞同：2
> 
> 时间：2009-05-01T14:32:17.783
> 
> 标签：sql-server-2005, dump

是否有免费工具可让您将 MS-SQL Express (2005) 表的数据（而不是结构）作为 INSERT 语句转储到平面文件中？

[这个](http://www.sqlmaestro.com/products/sqlite/maestro/help/05_05_00_sql_dump/)商业产品似乎符合我的想法。我尝试使用[SqlDump](http://sqldump.sourceforge.net/)，但我的完整服务器名称不适合其 SQL Server Name 字段。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T16:34:29.627

你需要做的是

1.  在管理工作室中右键单击您的数据库
2.  选择任务 -> 生成脚本
3.  选择要从中获取数据的表
4.  在下一步中单击高级并将“脚本的数据类型”设置为仅数据（或您需要的任何内容）

适用于 sql servver 2008 r2。在以前版本的 sql server 中，它类似于您设置为 true 的“脚本数据”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T15:34:05.093

tablediff 是 MS SQL Server 附带的免费工具。只要您的源是要从中生成插入的表，并且您有另一个要生成插入的空表，它就会准确地创建您正在寻找的文件。

BCP 可能是移动数据实用程序的更好选择 - 但它不会像您正在寻找的那样生成实际的 DML 插入语句。

我还要查看数据库发布向导。我没有使用过它，但它应该能够为您的模式和数据编写脚本——并且您可以从那里将它生成的脚本剪切为您正在寻找的内容。

有关 tablediff 实用程序的更多信息，请参阅[此链接](http://msdn.microsoft.com/en-us/library/ms162843.aspx)。

请参阅[此链接](http://www.microsoft.com/downloads/details.aspx?familyid=56E5B1C5-BF17-42E0-A410-371A838E570A&displaylang=en)以下载数据库发布向导。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T14:39:12.980

我认为[这](http://vyaskn.tripod.com/code/generate_inserts.txt)对你有用，但你必须为每张桌子运行它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T14:58:46.863

我知道这不是您的想法，建议的工具看起来很有希望，但如果数据从一个 SQL Server 传输到另一个 SQL Server，则使用[bcp](http://msdn.microsoft.com/en-us/library/ms162802(SQL.90).aspx)是一种低开销的替代方案。下面的重要选项包括用于保留身份信息的 -E 和用于使用本机格式的 -n。执行第一条语句将构建一个批处理文件以将所有数据转储到文件中，第二条语句将创建 bcp ins。

```
Select 'bcp ' + Table_Catalog  + '..' + 
Table_Name + ' out ' + Table_Name 
+ '.bcp  -S ServerName -U userid -P password -n '
from information_schema.tables 
where table_type = 'BASE TABLE'

Select 'bcp ' + Table_Catalog  + '..' + Table_Name 
+ ' in .\' + Table_name + 
'.bcp  -S .\ -U userid -P password -n -E '
from information_schema.tables 
where table_type = 'BASE TABLE' 
```

样本输出

bcp 输出命令

```
bcp master..tblDepartments out tblDepartments.bcp  -S ServerName -U
userid -P password -n 
```

bcp 在命令中

```
bcp master..tblDepartments in .\tblDepartments.bcp  -S .\ 
-U userid -P password -n -E 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T14:39:22.307

这应该这样做[http://sourceforge.net/projects/vwg-ent-man](http://sourceforge.net/projects/vwg-ent-man)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-17T11:35:42.007

试用免费的[SSMS 工具包](http://www.ssmstoolspack.com/)，它是 SSMS 和 SSMS Express 的插件。它使您能够为表、dte 整个数据库或仅为查询结果生成插入脚本。

# javascript - BNF 中的 JavaScript for 循环

> ID：811604
> 
> 赞同：0
> 
> 时间：2009-05-01T14:32:25.180
> 
> 标签：javascript, parsing, bnf

我正在为 JavaScript 编写 BNF，它将用于生成该语言的词法分析器和解析器。但是，我想要一些关于如何设计 for 循环的想法。这是我当前 BNF 的简化版本：

```
[...]
VarDecl. Statement ::= "var" Identifier "=" Expr ";"
ForLoop. Statement ::= "for" "(" Expr ";" Expr ";" Expr ")"
[...] 
```

如您所见，示例中有两个语句，变量声明和 for 循环。有很多不同的表达式，但*没有*一个表达式也是语句。

现在的问题是这段 JavaScript 代码不会通过解析器：

```
for (var x = 3; [...]; [...]) 
```

这是因为变量声明不是表达式。

你对如何解决这个问题有什么想法？我可以想到几个方法，但我不想妨碍你自己的想法，所以在此不提。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T14:51:02.263

网上有一些例子，在一个[ANTLR ECMAScript 语法](http://www.antlr.org/grammar/1153976512034/ecmascriptA3.g)中你可以找到这个结构：

```
iterationStatement:
'do' statement 'while' LPAREN expression RPAREN SEMI
| 'while' LPAREN expression RPAREN statement
| 'for' LPAREN (
    (expressionNoln)? SEMI (expression)? SEMI (expression)? RPAREN statement
    | 'var' variableDeclarationListNoln SEMI (expression)? SEMI (expression)? RPAREN statement
    | leftHandSideExpression 'in' expression RPAREN statement   
    | 'var' variableDeclarationNoln 'in' expression RPAREN statement
    )
; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T14:46:04.397

您应该可以在那里放置任何“简单”语句（即 vardecl、表达式、void 函数调用等）。简单地说，我的意思是任何不是复合语句的东西（即带有额外的花括号，例如 if/else/for/function 等）。

# delphi - Kylix 做错了什么？

> ID：811605
> 
> 赞同：9
> 
> 时间：2009-05-01T14:32:34.773
> 
> 标签：delphi, cross-platform

随着所有关于 Delphi 团队致力于跨平台开发的讨论，不断出现的一种情绪是，“我希望他们这次做对了，不像 Kylix。” Kylix 出现时我并没有真正注意到它，因为当时的 Linux 还没有现在那么成熟，而且它也不是我感兴趣的操作系统。所以现在它又开始成为一个问题，我发现自己想知道，Kylix 做错了什么，CodeGear 这次如何做得更好？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-01T15:18:31.310

至于 CodeGear 这次可以在哪些方面做得更好：

*   需要有一种更抽象的方式在对话框中布置控件，而不是 VCL 现在使用的基于像素的东西。这在已经具有高 DPI 设置或非标准字体的 Windows 上崩溃了，对于多平台程序来说会更糟。以[wxWidgets 中的 sizer 类](http://docs.wxwidgets.org/stable/wx_sizeroverview.html)为例，或者 GTK、Java 或 QT 中的布局类/管理器——它们在改变字体或控件大小方面都做得更好。作为另一个优势，这可以透明地工作，控件中的翻译文本更短或更长。

*   仅使库 Unicode。理想情况下，会有一个特殊的字符串类，在 Windows 内部使用 UCS-16，但在 Linux 和 Mac OS X 上使用 UTF-8。程序应该能够使用平台原生 Unicode 编码，而不是被迫进行转换每个文件系统访问或屏幕输出。但也许他们已经在 Delphi 2009 的 Unicode 字符串更改中放弃了那个。

*   GUI 应在所有平台上使用本机控件，以获得正确的外观**和**感觉。这将是 Windows 上的标准控件，Mac 上的 Cocoa 和 Linux 上最好使用 GTK 或 QT，具体取决于桌面是 GNOME 还是 KDE。

*   远程调试器需要成为一流的工具，而不是像现在这样充满错误和半隐藏的东西。不同平台的开发经常发生在虚拟机中，有时只能远程访问机器。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-01T14:35:03.690

Kylix 有两件事不利于它：桌面上的 Linux 还没有被广泛接受，而且 Kylix 本身非常昂贵。加上 Kylix 有问题的质量（尤其是第一个版本），你就有了答案。

如果 CodeGear 想在 Linux 上做另一个版本的 Delphi，他们应该只看[Lazarus](http://en.wikipedia.org/wiki/Lazarus_(software))。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-02T09:40:49.990

我当时（现在仍然）从事 Free Pascal Unix RTL，它在 Kylix 之前在 *nix 上做过 Pascal，我们从第一个 beta 版本开始就密切关注它。所以可以说我对 Kylix 的兴衰有着很好的独特视角。

一个主要问题是它不适合服务器应用程序的使用，这是人们当时在 Linux 上做的主要事情，但恕我直言，这并不能解释失败。

虽然还有其他各种问题（Wine、部署、非常以 Linux/x86 为中心，所以很难移植到“下一个”*nix，Borland 没有足够的推动它），我仍然认为 Kylix 失败的事实更多地证明了Linux 在当时的困境不是由 Kylix 问题直接导致的。其中一些（如长期二进制 API 稳定性）尚未修复。

**不过，它应该工作**，因为它明显领先于其他人，并且可行，如果需求真的存在，人们会加紧（有些人有，我们仍然在 FPC 名单上每月获得人转换大型 Kylix 代码库）。

面向服务器的版本可能会更受欢迎，他们在单一来源的东西上营销有点过于强烈（这错误地提高了期望），但仍然应该使用 GUI 原则，恕我直言，我责怪 Linux 和 Linux市场。太快了，市场太炒作了，还没有准备好在 Windows 模型之后进行商业化。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-18T03:23:52.327

在我看来，跨平台原生和托管（VM）对 Delphi 有好处；然而，在实施之前需要深思熟虑。（通常，Turbo Pascal 版本是，IMO ......尽管 Delphi 语言的一些添加不是；举例来说，您不能在接口中声明要读取和/或只写入的属性，而无需声明什么属性的来源是，必须在接口中声明的字段或方法。IE 它是/是个好主意……但他们忘记了完全分离接口/实现。）

所以，IMO，需要的是：

1 - 一个 VCL-/TurboVision-/GeneralPurpose 类库，设计为独立于平台。（VCL 确实是面向对象层次结构的一个很好的例子；就像 turbo-vision [当时]......电视也非常有趣地引入和使用了流。）所以，重申一下：

a）一个良好的面向对象的可见组件层次结构......也许还包含比当前像素更“百分比”/相对/矢量图形的方案。（从而补偿屏幕分辨率差异。）

b）“知道”如何初始化和释放其包含的对象的对象（尽管指向对象的指针将被豁免，因为我们希望能够“共享”对象），因此设置构造函数来初始化和析构函数不需要释放包含的对象。{IE，优化常见情况。}

c) 应该实现 TList、TStringList 等非可视组件……尽管添加了 ADT，例如 Stack、Queue、PriorityQueue、Heap、Tree 和 BTree。不过，作为个人要求，我们可以将它们设为基于 1 而不是基于 0 吗？我问这个是因为在搜索它们时，最好让 0 “未找到”，并且在使用无符号数字时将正数作为索引，这与 ShortStrings 的风格非常相似。这还具有不会像使用有符号数那样将最大允许大小约束减半的优点。

d) 对象应该能够在尽可能低的级别上发送和发送/删除自己到一个流中，以便在另一端进行重建。{可能难以实施；但是 TurboVision API 使用它的注册方案来做到这一点......涉及 RTTI 应该会更容易一些。}

e) 前面提到的 ADT 还应该有一个镜像通用接口 heirchy，这样像 TStringList 这样的东西会给你一个字符串列表，其匹配对象属性是 TIntergerObject 类型的对象。

f) 容器类型，如堆栈或 StringList 也应该知道它们包含的类型；以及它们是否同质。

g) 可继承和泛化的非可视对象树上的解析器对象子树（可能“吃掉”BNF 并相应地解析输入......本身就是一个巨大的项目。

我知道这是一项艰巨的任务，而且工作量很大。然而，回报也将是巨大的。JVM 可以是一个 Stack 对象和一个解析器对象，它将源代码转换为要推送到堆栈上的适当对象...... Forth 编译器/解释器可以以相同的方式实现，具有多个堆栈和一个 Forth 解析器对象. 您显然会看到这是领先的：在基础上拥有一个通用且通用的 ADT 库，并在此基础上构建框架，RAD 工作室的下一次迭代可能会一举成为 .NET 的“任何语言”的竞争对手想法，但也适用于后端的多个架构。（是的，存在大小和字节序问题，但高级语言的想法是让程序员摆脱这些问题，除非他特别关注这些问题；

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T14:43:31.907

Kylix 刚问世时我就买了它——它运行非常缓慢，看起来很笨重，实际上只支持几个特定版本的 Linux。坦率地说，那里有更好的 Linux 工具。但我认为任何人都越来越难以通过销售开发工具赚钱，无论平台如何——免费的替代品非常好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T14:36:41.300

尝试向习惯于免费获得工具和软件的人收取 600 美元的费用可能不是一个明智的决定！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-01T14:38:58.330

他们在这么多不同的发行版本上创建可靠的部署也遇到了很多麻烦。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-22T21:34:28.417

我讨厌 Kylix 和 VCL for Web (Intraweb) 的地方在于它们的组件看起来像标准组件......

VCL 本身非常通用（句柄除外）...所以我希望拥有相同的源代码、相同的 pas、dfm、dpr .... 并通过选择编译器选项来选择要构建的平台，或者甚至对于具有相同源文件的每个平台都有不同的 dpr。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2013-08-06T18:42:38.177

Linux 还没有准备好处理商业级软件。最值得注意的问题是缺乏二进制兼容性。那时适用，现在仍然适用。

Danny Thorpe，Delphi/Kylix R&D，早在 2001 年就写了一篇情绪化的文章：
[问题：Linux 库不能失败](http://edn.embarcadero.com/article/27847)

# .net - 使用“aiueo”顺序对日文文本进行排序

> ID：811606
> 
> 赞同：1
> 
> 时间：2009-05-01T14:32:39.703
> 
> 标签：.net, sorting, cultureinfo

我正在尝试使用“aiueo”顺序对一些日本商店名称进行排序

有谁知道是否有算法可以做到这一点

我写了一个比较器如下，但我相信 ja-jp 文化使用 Unicode 排序

```
internal class JewellerComparer : IComparer<string>
    {
        private readonly string _culture;

        public JewellerComparer(string culture)
        {
            _culture = culture;
        }

        public int Compare(string x, string y)
        {
            // no culture specified in constructor
            if (string.IsNullOrEmpty(_culture))
                return x.CompareTo(y);

            // otherwise to a culture sensitive comparison
            return string.Compare(x, y, false, new CultureInfo(_culture));
            //new CultureInfo(0x00010411); // ja-JP Japanese - Japan Default: 0x00000411 Unicode: 0x00010411 
        }
    } 
```

有人对如何做到这一点有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-11-08T20:51:13.473

就在这里。您所需要的只是一个区域感知排序。我既不是 Java 专家也不是用户，但是我会在 C 中使用 strcoll 和 qsort 结合使用。

或者，可以尝试使用 libicu（还有一个 java 绑定），如果它提供一些排序，我不确定它是否尊重语言环境。

# rename - 将所有文件名截断为 255 个字符的命令

> ID：811607
> 
> 赞同：0
> 
> 时间：2009-05-01T14:33:16.440
> 
> 标签：rename, ntfs, filenames, ext3, fat32

NTFS 目录在 bash shell 中打开。什么命令会递归地将目录中的所有文件名截断到 ext3 所需的 255 个字符限制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T14:47:48.810

如果您有权访问 Windows shell，则可以使用：

```
@echo off
setlocal EnableDelayedExpansion

REM  loop over all files in the cwd
for /f %%a in ('dir /a-d /b') do (
   REM  store this filename in a variable so we can do substringing
   set ThisFileName=%%a
   REM  now take a substring
   set ThisShortFileName=!ThisFileName:~0,255!
   REM  finally, the rename:
   echo ren %%a !ThisShortFileName!
)

:EOF
endlocal 
```

（注意：我在重命名命令之前添加了一个回显，以便您可以在实际运行之前直观地验证它是否有效。适用于我的盒子。）

我敢肯定，现在在 *nix 机器上的人可以为 bash 制作类似的脚本，但我被困在 Windows 世界:)

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-07T18:00:01.963

假设 shell 位于 NTFS 目录中，因为它是 PWD：

> `for f in *; do mv $f ${f:0:255}; done`

类似于 Dave 的基于 sed 的版本，但避免了每个文件的 exec。由于最大命令行限制，将在一个非常大的目录上爆炸，并且不执行子目录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T14:47:46.750

```
$ cat truncname 
#!/bin/bash
# requires basename, dirname, and sed
mv $1 `dirname $1`/`basename $1 | sed 's/^\(.\{0,255\}\).*/\1/'`
$ chmod a+x truncname 
$ find . -exec ./truncname {} \; 
```

# pdf - 如何计算从 TTF 开始的 PDF？

> ID：811608
> 
> 赞同：7
> 
> 时间：2009-05-01T14:33:25.427
> 
> 标签：pdf, truetype

PDF 规范定义了一个名为 '（撇号）的文本运算符。定义是它写出一些文本，并根据当前的前导状态移动到下一行。可以使用 TL 运算符设置当前领先状态。如果您知道它们应该垂直间隔多少，这使得编写文本行变得非常容易：

```
16 里拉
/F1 12 时间
（第 1 行）'
（第 2 行）'
（第 3 行）'
（第 4 行）'

```

我没有为此使用任何库，因为这是一个学习练习。我编写了一些代码来直接解析 TTF 文件并提取字符宽度以及 PDF FontDescriptor 字典所需的其他项目。

我一直在阅读 TTF 文件格式规范，以试图找出行高的位置或如何计算它，但我没有运气。

假设我有以下给定：

*   字体大小。
*   TTF 文件中的所有相关值（Ascender、Descender、Line Gap 等）

如何计算从 TTF 开始的 PDF？

*编辑*

似乎 TTF 文件中的 Line Gap 值有助于计算 PDF 行距，但某些字体并未为其提供合理的值（例如，Windows 上的 Courier New）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-09T01:41:16.020

By no means am I the least bit knowledgeable about fonts, or have a definite answer, but I figured I'd post some links regarding some information I found regarding the topic.

The [Microsoft OpenType Specification](http://www.microsoft.com/typography/otspec/recom.htm) (see the Baseline To Baseline Distances section, toward the bottom) defines leading as being equal to the LineGap.

The Apple [Text System Overview](http://developer.apple.com/documentation/Cocoa/Conceptual/TextArchitecture/Concepts/TextSystemFeatures.html) states that:

> Space added during typesetting between lines of type is called leading, after the slugs of lead used for that purpose in traditional metal-type page layout. (Leading is sometimes also called linegap.)

So, according to these links, LineGap is not just used to calculate the leading, but actually is the leading.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T17:12:10.363

我不完全确定您要做什么，但听起来您想在 pdf 文档中嵌入真字体。如果是这样，你为什么不只使用乳胶？

[http://www.radamir.com/tex/ttf-tex.htm](http://www.radamir.com/tex/ttf-tex.htm)

# database - 防止多个数据库之间的重复键

> ID：811613
> 
> 赞同：1
> 
> 时间：2009-05-01T14:34:08.437
> 
> 标签：database, primary-key, sybase

我的情况是，我们发布了一个新版本的软件，它将使用与旧版本不同的数据库（架构中的重大变化）。新旧系统都将投入生产将有相当长的一段时间，我们需要确保在两个数据库之间生成唯一 ID（我们不希望数据库 A 中有一行具有与数据库 B) 中的行相同的 ID。数据库是 Sybase。

我想出的可能的解决方案：

1.  使用支持非常大的数字的数据类型并为每个数字分配一个范围，希望它们永远不会溢出。
2.  对一个数据库使用负值，对另一个数据库使用正值。
3.  添加一个标识数据库的附加列，并使用该列和当前 ID 的组合作为键。
4.  哭。

我还能做什么？是否有更优雅的解决方案，以某种方式让两个数据库协同工作？我相信这两个数据库将在同一台服务器上，如果这很重要的话。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T14:37:03.000

在这种情况下，GUID 或全局唯一 ID 可以是方便的主键。我相信 Sybase 支持他们。

编辑：尽管如果您的整个数据库已经基于整数主键，那么切换到 GUID 可能不是很实用 - 在这种情况下，只需对数据库之间的整数空间进行分区，正如 GWLlosa 和其他人所建议的那样。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-01T14:38:19.207

我已经看到这种情况发生了几次。在我参与的那些上，我们只是为旧的分配了足够大的 ID 空间（因为它已经运行了一段时间，并且我们知道它使用了多少键，我们可以计算它还有多少键'd need for a specified 'lifespan') and start the "ID SEQUENCE" of the new database above that.

我建议不要使用任何其他技巧，因为它们都需要更改“旧版”应用程序，这是我认为没有必要承担的风险。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-01T14:39:25.320

在您的情况下，我会考虑使用唯一标识符（GUID）作为数据类型。[当您使用系统函数`newid()`](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.help.ase_15.0.blocks/html/blocks/blocks177.htm)创建它们时，它们被认为是唯一的。

```
CREATE TABLE customer (
   cust_key UNIQUEIDENTIFIER NOT NULL
            DEFAULT NEWID( ),
   rep_key VARCHAR(5),
   PRIMARY KEY(cust_key)) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-01T14:37:11.253

使用 # 预播新数据库，该 # 大于合并之前旧数据库将达到的值。

我过去曾这样做过，并且记录量相当低，因此我以 200,000 作为初始记录数开始了我的新数据库。然后到时候，我只是将所有旧记录迁移到新系统中。

完美解决！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-01T14:37:11.940

GUID 专为这种情况而设计。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-01T14:39:50.747

如果您将在每个数据库上创建相似数量的新项目，您可以在一个数据库上尝试**偶数 id**，在另一个数据库上尝试**奇数 id**。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-01T14:39:33.243

使用 UNIQUEIDENTIFIER 数据类型。我知道它可以在 MS SQL Server 中工作，据我在谷歌搜索中看到的，Sybase 支持它。

[http://www.ianywhere.com/developer/product_manuals/sqlanywhere/0902/en/html/dbrfen9/00000099.htm](http://www.ianywhere.com/developer/product_manuals/sqlanywhere/0902/en/html/dbrfen9/00000099.htm)

# c# - C#：'is' 关键字并检查 Not

> ID：811614
> 
> 赞同：316
> 
> 时间：2009-05-01T14:34:26.843
> 
> 标签：c#, casting, keyword

这是一个愚蠢的问题，但是您可以使用此代码来检查某些东西是否是特定类型...

```
if (child is IContainer) { //.... 
```

有没有更优雅的方法来检查“NOT”实例？

```
if (!(child is IContainer)) { //A little ugly... silly, yes I know...

//these don't work :)
if (child !is IContainer) {
if (child isnt IContainer) { 
if (child aint IContainer) { 
if (child isnotafreaking IContainer) { 
```

是的，是的……愚蠢的问题……

**因为对代码的外观有一些疑问**，所以它只是在方法开头的简单返回。

```
public void Update(DocumentPart part) {
    part.Update();
    if (!(DocumentPart is IContainer)) { return; }
    foreach(DocumentPart child in ((IContainer)part).Children) {
       //...etc... 
```

* * *

## 回答 #1

> 赞同：324
> 
> 时间：2009-05-01T14:35:46.980

```
if(!(child is IContainer)) 
```

是唯一的运营商（没有`IsNot`运营商）。

您可以构建一个扩展方法来完成它：

```
public static bool IsA<T>(this object obj) {
    return obj is T;
} 
```

然后用它来：

```
if (!child.IsA<IContainer>()) 
```

你可以按照你的主题：

```
public static bool IsNotAFreaking<T>(this object obj) {
    return !(obj is T);
}

if (child.IsNotAFreaking<IContainer>()) { // ... 
```

* * *

### 更新（考虑到 OP 的代码片段）：

由于您实际上是在之后转换值，因此您可以`as`改用：

```
public void Update(DocumentPart part) {
    part.Update();
    IContainer containerPart = part as IContainer;
    if(containerPart == null) return;
    foreach(DocumentPart child in containerPart.Children) { // omit the cast.
       //...etc... 
```

* * *

## 回答 #2

> 赞同：116
> 
> 时间：2009-05-01T14:47:02.540

你可以这样做：

```
object a = new StreamWriter("c:\\temp\\test.txt");

if (a is TextReader == false)
{
   Console.WriteLine("failed");
} 
```

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2019-01-23T20:15:53.770

## C# 9.0 中的新功能

[https://devblogs.microsoft.com/dotnet/welcome-to-c-9-0/#logical-patterns](https://devblogs.microsoft.com/dotnet/welcome-to-c-9-0/#logical-patterns)

```
if (part is not IContainer)
{
    return;
} 
```

## 原始答案

这还没有被提及。它有效，我认为它看起来比使用更好`!(child is IContainer)`

```
if (part is IContainer is false)
{
    return;
} 
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2020-05-28T06:16:42.973

C# 9（与 .NET 5 一起发布）包括逻辑模式`and`,`or`和`not`，这使我们可以更优雅地编写它：

```
if (child is not IContainer) { ... } 
```

同样，此模式可用于检查 null：

```
if (child is not null) { ... } 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-05-01T14:38:01.220

为什么不只使用 else ？

```
if (child is IContainer)
{
  //
}
else
{
  // Do what you want here
} 
```

它的整洁它熟悉和简单吗？

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-05-01T14:45:38.987

你拥有它的方式很好，但你*可以*创建一组扩展方法来制作“一种更优雅的方式来检查'NOT'实例。”

```
public static bool Is<T>(this object myObject)
{
    return (myObject is T);
}

public static bool IsNot<T>(this object myObject)
{
    return !(myObject is T);
} 
```

然后你可以写：

```
if (child.IsNot<IContainer>())
{
    // child is not an IContainer
} 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-05-01T14:38:45.523

丑陋的？我不同意。唯一的另一种方式（我个人认为这是“丑陋”）：

```
var obj = child as IContainer;
if(obj == null)
{
   //child "aint" IContainer
} 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-05-01T16:34:49.643

扩展方法`IsNot<T>`是扩展语法的好方法。记住

```
var container = child as IContainer;
if(container != null)
{
  // do something w/ contianer
} 
```

比做类似的事情表现更好

```
if(child is IContainer)
{
  var container = child as IContainer;
  // do something w/ container
} 
```

在您的情况下，您从该方法返回时并不重要。换句话说，注意不要同时检查类型，然后立即进行类型转换。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-05-01T14:41:59.743

该`is`运算符计算为布尔结果，因此您可以做任何您本来可以在布尔上做的事情。要否定它，请使用`!`运算符。您为什么要为此使用不同的运算符？

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2018-03-07T16:12:02.190

虽然这并不能避免括号的问题，但为了人们通过 Google 到达这里，应该提到存在更新的语法（从 C# 7 开始）以使其余代码更简洁：

```
if (!(DocumentPart is IContainer container)) { return; }
foreach(DocumentPart child in container.Children) {
    ... 
```

这避免了双重转换、空检查以及在可能为空的范围内有一个可用的变量。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-05-01T14:40:48.093

虽然 IS 运算符通常是最好的方法，但您可以在某些情况下使用另一种方法。您可以使用 as 运算符并测试是否为空。

```
MyClass mc = foo as MyClass;
if ( mc == null ) { }
else {} 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2021-09-08T00:49:47.747

会用这个

如果（！（对象是汽车））{

}

* * *

## 回答 #13

> 赞同：-3
> 
> 时间：2014-04-23T16:43:14.337

```
if (child is IContainer ? false : true) 
```

# sybase - 什么相当于 SQSH 中的“显示表”

> ID：811616
> 
> 赞同：15
> 
> 时间：2009-05-01T14:34:29.760
> 
> 标签：sybase, sqsh

如何让 sqsh 告诉我哪些表可用？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-04T01:35:16.267

对你有用`sp_tables`吗？您是否在创建查询时尝试完成制表符？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-01T14:56:54.793

在[本网站](http://infolab.stanford.edu/~ullman/fcdb/aut96/sy-intro.html)的一些帮助和一些试验和错误之后：

```
 select table_name from systable
 go 
```

够痛苦的，`sp_help`在我的版本中不存在。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-05-23T08:00:43.400

较新的版本使用 sysobjects：

```
SELECT name FROM sysobjects WHERE type = 'U'; 
```

问候，

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-29T02:45:37.147

我对系统表不熟悉。您正在运行什么风格的 Sybase？也许是 ASA？

请查找附加的 sqsh 函数（您可以将其放入您的 .sqshrc），该函数演示了对 ASE（自适应服务器企业）目录表的一些查询以及 Ed Barlow 系统存储过程库[http://www.edbarlow.com的使用/gem/procs_only/index.htm](http://www.edbarlow.com/gem/procs_only/index.htm)找出数据库中的对象。

```
# sp__helptext 或 sp__revtable 的简写
\func -x ?
  IF EXISTS (SELECT * FROM sysobjects WHERE name = \\'${1}\\')
       开始
       声明 @type VARCHAR(3)
       SELECT @type = type FROM sysobjects WHERE name = \\'${1}\\'
       IF @type IN (\\'U\\')
          执行 sp__revtable ${1}
       别的
          执行 sp__helptext ${1}
        结尾
   别的
       -- 如果在 sysobjects 中未找到完全匹配，则默认为 sp__ls（可以列出部分匹配项）
       执行 sp__ls ${1}
   去
\完毕

```

# model-view-controller - 用于 Java EE Web 应用程序的简单 MVC？

> ID：811632
> 
> 赞同：1
> 
> 时间：2009-05-01T14:37:06.040
> 
> 标签：model-view-controller, jakarta-ee, struts

Web 开发的 MVC 方法的目标之一是分离模型、视图和控制器。

假设在类似 Java EE Struts 的环境中，您将 Struts Action 与控制器、Java bean 与模型、JSP 和/或 ActionForm 与视图相关联。

我的问题是，您倾向于在哪里执行任何逻辑来填充 JSP 上的数据。将任何类型的逻辑或处理放在视图 ActionForm 中似乎是不好的做法，而将任何类型的逻辑放在 JSP 中是非常糟糕的。

您是否包含一个“管理器”类来在视图表单中向用户显示数据之前对其进行操作。

这是一个简单的例子。您从数据库中取出名字，姓氏，然后您需要调整格式（将所有大写字符串转换为混合大小写）。在该字符串到达​​ JSP 视图之前操作该字符串的逻辑是否会将该逻辑添加到管理器类中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T14:41:42.350

如果它的逻辑只与视图有关（在您的示例中，使数据看起来“漂亮”），那么我会将它放在视图中。但是，如果您稍后要保存修改后的数据，那么它应该在业务层中。不过，总的来说，我倾向于在视图和控件（您的 Manager 类）之间保留一层，它只关心显示问题和输入的高级验证，而不是复杂的业务规则（确保非常糟糕的数据永远不会到达业务层）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T14:41:51.663

这在很大程度上取决于您使用的框架。我认为这种事情应该在视图中完成，但具体如何去做会有所不同。

如果您使用的是 JSP，那么编写自定义标签库来做您想做的事情可能是有意义的——因此它与实际的 HTML 是分开的，但仍在“视图”中。

所以，你会有类似的东西：

```
<td><mytag:mixedCase value="${user.firstname}" /></td> 
```

等等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T14:57:59.907

对于简单的表示问题，例如大写字符串，我会将其放在 JSP 中。对于更复杂的业务逻辑，我会把它放在模型类中。您不想让您的控制器与业务逻辑混淆。将其放入模型的另一个优点是可以进行单元测试。

# c++ - Windows 线程等待方法

> ID：811641
> 
> 赞同：13
> 
> 时间：2009-05-01T14:38:42.420
> 
> 标签：c++, multithreading

我正在创建一个线程类来封装 Windows 线程方法。我正在尝试创建一种方法，使应用程序在退出应用程序之前等待线程完成。如果我使用 while 循环和布尔标志，它可以工作，但显然它会增加我的 CPU 使用率，而且并不理想。

你会用什么方法来等待一个线程的完成？我并不是真的在这里寻找代码，只是要研究的领域。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-05-01T14:40:36.797

使用 CreateThread 获取线程句柄后，将其传递给 Win32 API [WaitForSingleObject](http://msdn.microsoft.com/en-us/library/ms687032.aspx)：

```
WaitForSingleObject(threadhandle, INFINITE); 
```

如果您不使用 CreateThread （因为您使用了另一个线程包），或者您的线程可能始终处于活动状态......

然后你仍然可以使用 WaitForSingleObject。只需先使用 Win32 API [CreateEvent](http://msdn.microsoft.com/en-us/library/ms682396(VS.85).aspx)创建一个事件，然后等待使用 WaitForSingleObject 设置该事件。在您的线程结束时使用[SetEvent](http://msdn.microsoft.com/en-us/library/ms686211(VS.85).aspx)设置事件，您可以使用[ResetEvent](http://msdn.microsoft.com/en-us/library/ms685081(VS.85).aspx)重置事件。

大多数线程包都有自己的方式来等待线程。就像在[boost::thread](http://www.boost.org/doc/libs/1_38_0/doc/html/thread.html)中一样，您可以使用 .join() 或[boost::condition。](http://www.boost.org/doc/libs/1_34_0/doc/html/boost/condition.html)

# sql-server - 如何在紧急模式下设置数据库？

> ID：811644
> 
> 赞同：4
> 
> 时间：2009-05-01T14:38:48.270
> 
> 标签：sql-server, database

我的数据库已停止。我什么都做不了，选择，更新，什么都没有。有人告诉我将数据库设置为紧急模式，但我不知道怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T15:53:36.497

我找到了解决方案：ALTER DATABASE dbName SET Emergency

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T14:43:28.240

我认为这仅适用于服务器数据库，或者不是？

在 SQL 文档中是这样的查询：

```
set emergency mode "databasename" 
```

试试！cos' 我这里只有 SQL Server Express Edition

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-27T18:48:41.603

如果您的数据库处于可疑模式，则必须将该数据库保持在紧急模式（以获得对该数据库的访问权限）。

```
alter database datasename set emergency 
```

然后运行 ​​DBCC 语句为：

```
dbcc chedkdb(DBname,repair_rebuild) with no_infomsgs 
```

如果这不起作用，则将数据库保持在如下所示的单用户模式并运行 checkdb 语句

```
alter database DBname set single_user
dbcc checkdb(DBname,repair_allow_data_loss) with no_infomsgs 
```

如果成功，现在通过

```
alter database DBname set multi_user 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-13T10:48:18.807

```
USE [master] GO
-- Method 1: I use this method
EXEC sp_attach_single_file_db @dbname='TestDb',
@physname=N'C:\Program Files\Microsoft SQL Server\MSSQL10.MSSQLSERVER\MSSQL\DATA\TestDb.mdf'
GO
-- Method 2:
CREATE DATABASE TestDb ON
(FILENAME = N'C:\Program Files\Microsoft SQL Server\MSSQL10.MSSQLSERVER\MSSQL\DATA\TestDb.mdf')
FOR ATTACH_REBUILD_LOG
GO 
```

# linux - Linux 与 Solaris 上的线程性能

> ID：811647
> 
> 赞同：4
> 
> 时间：2009-05-01T14:39:19.390
> 
> 标签：linux, performance, multithreading, solaris, pthreads

这篇 Linux 杂志文章[http://www.linux-mag.com/id/792](http://www.linux-mag.com/id/792)解释了与商业 Unix（如 Solaris）相比，Linux 中线程实现方式的不同。总之，Linux 使用用户线程到内核线程的一对一映射，而 Solaris 使用多对多映射。该文章暗示这可能会给 Solaris 带来性能优势，尤其是在线程之间切换时。在我花时间测试之前，有人已经做过了吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-01T14:54:08.497

过去人们认为 M:N 线程是个好主意，但每个人都在转向 1:1 线程；它具有较低的开销，并且在 SMP 环境中工作得更好。我相信在[Solaris 9](https://web.archive.org/web/20090305012246/http://www.sun.com/software/whitepapers/solaris9/multithread.pdf)中， Solaris 从 M:N 线程转变为 1:1 线程。您链接到的那篇文章似乎是 2001 年的，所以它有点过时了（它只是订阅者，所以我无法阅读它）。

# open-source - 像 Cofundos 这样的项目对推动开源编程有用吗？

> ID：811653
> 
> 赞同：2
> 
> 时间：2009-05-01T14:39:51.573
> 
> 标签：open-source, currency, cofundos

[Cofundos](http://cofundos.org/)是一个项目，您可以在其中为要在开源程序中完成的任务付费。如果开发人员解决了这个任务，他就会赚到钱。这是推动开源软件的好方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T19:42:34.823

不。

Joel Spolsky[谈到](http://www.youtube.com/watch?v=NWHfY_lvKIQ)了在为 Stack Overflow 等网站做贡献的情况下，人们免费做他们永远不会为付费做的事情的现象。人们有各种各样的理由免费做事：

*   帮助朋友或社会。
*   声望和认可。
*   爱好或消遣。
*   建立简历。
*   了解他们周围的世界。

当您提供金钱时，它要么破坏了做某事的目的（“如果我得到报酬，那不是一种爱好——这是一份工作。”）或降低做这件事的内在价值（“我不是在帮助社会——我是帮助我。”）。开源贡献也是如此。

人们**确实**因开源工作而获得报酬。但通常由使用开源软件并需要某些功能和修复的公司提供。有时他们是全职的，但通常只是提交错误修复或功能，以便将其带到下一个版本。但发生这种情况是因为该项目对公司有用。

所以“推动”开源的更好方法是使用开源。如果项目缺少功能，您需要自己添加或找其他人添加。任何直接为某项功能提供资金的方案都可能行不通。如果确实添加了该功能，它将由想要获得报酬的人而不是想要更好的软件的人添加。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T14:44:11.033

好吧，如果您绝对需要程序中的新功能并且您不能做出贡献，那么当然可以。否则我不明白你为什么不这样做。你自己做会学到更多。

# php - 如何在我的 CakePHP 编辑器中突出显示 HTML 语法？

> ID：811656
> 
> 赞同：2
> 
> 时间：2009-05-01T14:40:20.730
> 
> 标签：php, cakephp, syntax-highlighting, notepad++, aptana

我使用 Notepad++ 和 Aptana 来编辑我的 CakePHP 代码？有什么方法可以为 CakePHP 的 .ctp 模板文件获得基本的 html 语法高亮显示？没有任何着色对我来说要困难得多。有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-01T15:14:28.573

**在 Aptana 编辑器中配置**

> 引用自 aptana 文档

1.  从 Window 菜单中，选择 Preferences...，然后选择 General > Editors > File Associations。
2.  添加适当的文件类型。
3.  在文件类型列表旁边，单击添加按钮。
4.  在新文件类型弹出窗口中，输入适当的文件扩展名（例如“ *.ctp”或“* .thtml”）。
5.  单击确定将新文件类型添加到列表中。
6.  将新文件类型与 Aptana 相关联。
7.  在文件类型列表中，选择您刚刚添加的文件类型。
8.  在 Editor Associations 列表旁边，单击 Add 按钮。
9.  在编辑器选择弹出窗口中，选择要与文件类型关联的编辑器。
10.  单击确定添加编辑器。
11.  新的现在与指定的文件类型相关联。
12.  单击“确定”应用您的更改并关闭“首选项”窗口。

***看看这个[链接](http://www.aptana.com/docs/index.php/Using_Aptana_with_PHP,_ASP,_and_other_non-HTML_files)***

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T14:56:42.390

您可能只需要在菜单栏中选择 Language -> Html。您可以在 Settings -> Style Configurator -> Html 中设置关联

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T14:56:42.407

设置 -> 样式器配置器 -> 语言：HTML -> 用户分机：ctp

完毕 ：-）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-02T07:36:56.357

我学到的另一个小技巧.....在 Aptana 中完成一些基本的语法：

1.  右键单击您的项目，选择属性
2.  转到“Project Natures”选项卡并确保单击 PHP 组件（如果没有单击它，请关闭属性窗口并重新打开它）
3.  接下来我们将点击“PHP Buildpath”并选择“External Folders”选项卡
4.  添加一个平面简CakePHP安装的位置

让 Aptana 重新分析项目和 viola....您已经完成了一些语法。它并不完美……但总比没有好！

# asp.net - 在 ASP.NET Ajax TabContainer 中设置活动选项卡会导致整个容器消失

> ID：811657
> 
> 赞同：5
> 
> 时间：2009-05-01T14:40:30.353
> 
> 标签：asp.net, asp.net-ajax, ajaxcontroltoolkit, tabcontainer

我有一个使用[ASP.NET Ajax Control Toolkit TabContainer](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/Tabs/Tabs.aspx)的 ASP.NET 页面。在这种情况`Page_Load`下，我会根据提供给页面的数据隐藏一些选项卡。然后，我想根据（可选）查询字符串参数的值使其中一个选项卡处于活动状态。

所以我有：

```
protected void Page_Load ( object sender, EventArgs e )
{
    if ( !this.IsPostBack )
    {
        // Tabs with no data are hidden in here
        LoadDataIntoTabs();

        PreselectCorrectTab();
    }
}

private void PreselectCorrectTab ()
{
    if ( ctlTabContainer.Visible )
    {
        if ( !string.IsNullOrEmpty( Request.QueryString[ "tabIndex" ] ) )
        {
            int tabIndex = 0;

            if ( int.TryParse( Request.QueryString[ "tabIndex" ], out tabIndex ) )
            {
                if ( ( ctlTabContainer.Tabs.Count > tabIndex ) && ctlTabContainer.Tabs[ tabIndex ].Visible )
                {
                    ctlTabContainer.ActiveTabIndex = tabIndex;
                }
            }
        }
    }
} 
```

如果我点击带有`tabIndex`查询字符串参数集的页面，整​​个选项卡容器就会消失。

奇怪的是，如果我更改`LoadDataIntoTabs()`为**不**隐藏不包含任何数据的选项卡，一切都会按您的预期进行（即在页面呈现时选择了正确的选项卡）。

有任何想法吗？

* * *

**编辑**

根据要求，以下是更多详细信息：

```
private void LoadDataIntoTabs ()
{
    LoadPendingWidgetsTab();
    LoadDataIntoTab2();
    LoadDataIntoTab3();
    // etc...
}

private void LoadPendingWidgetsTab ()
{
    IList<Widget> pendingWidgets = GetAllPendingWidgets();

    if ( ( pendingWidgets != null ) && ( pendingWidgets.Count > 0 ) )
    {
        tbpPendingWidgets.Visible = true;
        tbpPendingWidgets.HeaderText = String.Format( "Pending Widgets ({0})", pendingWidgets.Count );

        grdPendingWidgets.DataSource = pendingWidgets;
        grdPendingWidgets.DataBind();
    }
    else
    {
        tbpPendingWidgets.Visible = false;
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-03-10T15:39:25.987

尝试通过 ActiveTab 设置所需的选项卡，例如：

`ctlTabContainer.ActiveTab = tbpPendingWidgets;`

如果将第一个选项卡设置为，`Visible=false`则必须通过 ActiveTab 设置下一个可见选项卡页。

我正在使用 AjaxControlToolkit Release 30930（2009 年 9 月）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-04-12T15:38:33.797

这对我有用：
手动重置索引、可见性和活动选项卡。

```
 tabcontainer.ActiveTab = tabname
 tabcontainer.Visible = True
 tabcontainer.ActiveTabIndex = 2 
```

在我没有尝试设置活动选项卡的另一种情况下，我不得不重置 `tabcontainer.ActiveTabIndex = 0`.

所以我把两者放在一起，它起作用了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-12T06:59:35.673

这很简单而且效果很好，试试这个

为选项卡容器中使用的每个选项卡分配选项卡索引，例如....

然后`<cc1:TabContainer ID="TabContainer1" runat="server">`

`<cc1:TabPanel ID="tab1" runat="server" TabIndex="0">` //你的面板 `</cc1:TabPanel>` `<cc1:TabPanel ID="tab2" runat="server" TabIndex="1">` //你的面板 `</cc1:TabPanel>`

`</cc1:TabContainer>`

在cs页面中编写此代码

`TabContainer1.ActiveTabIndex = 1;`

# c# - 访问当前在 Outlook 2007 中选择的文本

> ID：811658
> 
> 赞同：2
> 
> 时间：2009-05-01T14:40:32.350
> 
> 标签：c#, .net, outlook, outlook-2007, outlook-addin

我想创建 C# Outlook 插件来自动化在我的错误跟踪系统 (Jira) 中添加邮件片段作为评论的过程。

要创建评论，我需要提取当前选定的文本。我设法以一种棘手的方式为电子邮件窗口做到这一点（在[本文](http://social.msdn.microsoft.com/forums/en-US/vsto/thread/505e309a-dfe5-407c-ad6b-929178944d3b)之后）。但我没有找到任何方法来访问预览窗口中的当前选择。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T17:39:18.897

似乎没有公开的方式来访问 Outlook 2007 的阅读窗格中的选定文本。

我找到的最合理的[解决方案是发送“CTRL-c”并阅读复制的文本。](http://www.eggheadcafe.com/conversation.aspx?messageid=31435029&threadid=31416437)但它并不总是有效，因为必须选择阅读窗格中的邮件查看器，这并不总是正确的。

# sql-server - SQL Server 集群中有多个“默认”实例？（AKA 多个集群实例，无需实例名称即可连接）

> ID：811667
> 
> 赞同：0
> 
> 时间：2009-05-01T14:41:40.507
> 
> 标签：sql-server, database-cluster

我在一个主动/主动集群上设置多个 SQL 实例，在我们现有的 SQL 集群上，集群名称是 SQLCLUSTER，但我们以 SQLCLUSTERINST1\Instance1、SQLCLUSTERINST2\Instance2 等方式访问这些实例。因为每个实例都有自己的无论如何IP和网络名称，我可以在每个网络名称上安装SQL作为“默认”实例吗？我真的很想访问我的实例而不必提供实例名称（即，而不是上面的，只是 SQLCLUSTERINST1、SQLCLUSTERINST2 等），但我对 SQL 的理解是，即使在集群中，实例名称也是必需的，即使 IP 已经唯一标识了一个实例。

有谁知道我能不能做到这一点？我即将安装第一个实例，如果不需要，我想在开始将它们作为命名实例安装之前得到答案。当只有实例集群名称可以唯一地按原样标识 sql 实例时，必须提供实例集群名称和实例名称才能连接到服务器，这似乎是多余的，并且可能是不必要的。我希望每个集群组有一个默认实例（因为它们共享一个 IP），但不是每个集群。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T14:56:46.447

您只能在主动/被动集群中使用默认实例。这样做的原因是因为您不能在同一台服务器上安装多个默认实例，集群需要在集群的每个节点上安装一个实例以支持故障转移。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-10T20:12:55.780

我最终找到了解决此问题的方法。当我在集群上安装命名实例时，我可以使用每个 DNS 名称上的端口 1433 访问它们，因此我不必提供实例名称来连接，这正是我所追求的。

为了实现这一点，我必须修改侦听器配置以强制每个实例在其专用 IP 上侦听端口 1433，而不是仅仅依赖动态端口和 SQL 浏览器。

我已经[在我的博客上详细说明了步骤](http://www.trycatchfinally.net/2009/05/Accessing-a-clustered-SQL-Server-instance-without-the-instance-name)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-07T11:46:08.647

好主意。我还没有阅读您的博客文章，但我怀疑限制围绕注册表项或目录结构。请记住，每个节点只有一个用于 SQL Server 的注册表配置单元。有一个注册表项列出了盒子上的实例。这是一个空格分隔的列表。我很确定该列表中必须有不同的值，因此，您不能拥有多个 MSSQLSERVER 实例。默认实例的内部实例名称是 MSSQLSERVER。所以我认为，如果没有别的，那就是你的限制。但是，我确实认为您对所有涉及的实例都使用端口 1433 有一个绝妙的想法。干得好，感谢分享。我想我可能会在下一个集群上自己尝试一下！

# python - 如何创建锁定的 Python 环境？

> ID：811670
> 
> 赞同：4
> 
> 时间：2009-05-01T14:41:58.057
> 
> 标签：python, windows, security, excel

我负责开发一个大型 Python/Windows/Excel 应用程序，该应用程序由一家在世界各地设有办事处的金融机构使用。最近，一个国家/地区的法规发生了变化，因此我们被告知我们需要创建一个“锁定”版本的发行版。

在与我的外国同行进行了一些令人沮丧的对话之后，他们似乎担心有人可能会滥用他们计算机上的 python 解释器来生成可能用于规避安全性的非标准应用程序。

我最初的建议只是取消对 python.exe 和 pythonw.exe 的执行权限：我们的应用程序作为 Excel 插件工作，它只使用 Python DLL。这些 exe 文件从未实际使用过。

我的对手仍然担心有人可能会针对 Python DLL 进行调用——黑客可以利用“exec”函数，例如从另一种编程语言或能够调用 Windows DLL 中的函数的虚拟机（例如 VBA）。

我们可以做些什么来防止我们想要安装的 DLL 被滥用？在这一点上，我没有想法了。我需要找到一种方法来确保 Python 只会运行我们授权的程序。

当然，这个问题有一个荒谬的元素：由于计算机都有 Excel 和 Word，它们都有 VBA，这是一种众所周知的脚本语言，在功能上与 Python 相当。

当 Excel 的 VBA 完全开放时，担心 python 显然是没有意义的，但这是公司政治，而且我的团队提议使用 Python，所以我们需要证明我们的东西可以相当安全。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-01T14:51:10.050

“相当安全”被任意定义为“比 Excel 和 VBA 更安全”。

你赢不了那场战斗。因为争吵是为了错误的事情。任何人都可以使用任何 EXE 或 DLL。

你需要以不同的方式定义“锁定”——以一种你可以成功的方式。

您需要将“锁定”定义为“无法更改 .PY 文件”或“我们可以审核对 .PY 文件的所有更改”。如果您将比赛场地转移到您可以控制的地方，那么您获胜的机会很小。

获取法规——不要相信其他人会为您解释它们。

绝对确定法规的要求——不要听别人的解释。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T14:55:23.220

可悲的是，Python 以这种方式不是很安全，这是众所周知的。它的动态特性与标准操作系统功能上的非常薄的层相结合，使其难以锁定。通常最好的选择是确保运行应用程序的用户拥有有限的权限，但我认为这不切实际。另一种方法是在虚拟机中运行它，其中潜在的损害至少仅限于该环境。

如果做不到这一点，了解 Python 的 C API 的人可以为您构建一个定制的 .dll，明确限制特定 Python 解释器的范围，审查导入和文件写入等，但这需要彻底检查您需要的功能和事后不需要和一些同样彻底的测试。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-01T15:04:23.527

一个想法是在 .NET 上的 AppDomain 中运行 IronPython。[在此处](http://tav.espians.com/a-challenge-to-break-python-security.html)查看 David W. 的评论。

此外，您可以导入一个模块来限制解释器写入文件。它被称为[安全灯](http://tav.espians.com/a-challenge-to-break-python-security.html)。

您可以使用它，并指出即使是 Python 的发明者也无法破坏该模块的安全性！（超过两次。）

我知道写入文件并不是您担心的唯一安全问题。但是你被要求做的是愚蠢的，所以希望问你的人会看到“安全的 Python”并感到满意。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-02T08:39:10.310

遵循[geordi](http://www.xs4all.nl/~weegen/eelis/geordi/#faq)方式。

每个可疑程序都在其自己的入狱帐户中运行。监视来自进程的系统调用（我知道如何在 Windows 中执行此操作，但这超出了此问题的范围）并在需要时终止进程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-02T08:30:46.727

我同意您应该检查法规以了解它们的实际要求。如果你真的需要一个“锁定”的 Python DLL，这里有一种方法可以做到。这可能需要一段时间，而且不容易做到正确。顺便说一句，由于这是理论上的，我正在挥手完成从大量到微不足道的工作:-)。

想法是修改 Python.DLL，使其仅导入已由您的私钥签名的 .py 模块。它通过使用公钥和代码签名来验证这一点，该代码签名隐藏在您通过编码签名工具添加到您信任的每个 .py 的变量中。

因此你有：

1.  从 Python 源代码构建私有构建。
2.  在您的构建中，更改导入语句以在导入时检查每个模块上的代码签名。
3.  创建一个代码签名工具，对您使用的所有模块进行签名并断言是安全的（也称为可信代码）。像 __code_signature__ = "ABD03402340"; 但在每个模块的 __init__.py 文件中是加密安全的。
4.  创建用于签署代码的私钥/公钥对并保护私钥。
5.  您可能不想签署任何具有 exec() 或 eval() 类型功能的模块。

如果您可以使用 IronPython，.NET 的代码签名模型在这里可能会有所帮助。

我不确定这是一个好主意，但最终你可以断言你的 Python.DLL 构建只会运行你用你的私钥签名的代码。

# javascript - jquery .get/.post 在 ie 7 或 8 上不起作用，在 ff 中工作正常

> ID：811672
> 
> 赞同：3
> 
> 时间：2009-05-01T14:42:15.297
> 
> 标签：javascript, jquery, ajax

我基本上在一个页面上有这个：

```
<script type="text/javascript">
function refresh_context() {
    $("#ajax-context").html("Searching...");
    $.get("/ajax/ldap_search.php", {cn: $("#username").val()}, function(xml) {
        $("#ajax-context").html($("display", xml).text());
        $("#context").val($("context", xml).text());
    }, 'xml');
}
$(document).ready(function() {
    $("#username").blur(refresh_context);
});
</script>

<input type="text" name="username" id="username" maxlength="255" value="" />
<input type="hidden" name="context" id="context" value=""/>
<div id="ajax-context"></div> 
```

它应该做的（并且在 Firefox 上很好）是当您在#username 字段中输入用户名时，它将运行 /ajax/ldap_search.php?cn=$username，它会在我们公司的 ldap 中搜索用户名并返回它原始上下文和上下文的格式化版本，如下所示：

```
<result>
    <display>Staff -&gt; Accounting -&gt; John Smith</display>
    <context>cn=jsmith,ou=Accounting,ou=Staff,ou=Users,o=MyOrg</context>
</result> 
```

格式化版本（显示）转到 div #ajax-context 并转到隐藏的输入 #context。（另外， -> 实际上是 - "& gt ;" （没有空格））。

但是，在 IE 上，div 停留在“正在搜索...”上，并且隐藏的输入值保持空白。

我已经尝试了 .get 和 .post 都没有工作。我确定它在 .get 上失败了，因为如果我尝试这个，我什至不会收到警报：

```
$.get("/ajax/ldap_search.php", {cn: $("#username").val()}, function() {
    alert("Check");
}); 
```

此外，IE 不会给我任何脚本错误。

编辑：添加了“$(document).ready(function() {”，.blur 已经在我的代码中，但我忘记在我的帖子中包含它。

编辑 2：请求正在发送并且 apache2 正在接收它：

```
10.135.128.96 - - [01/May/2009:10:04:27 -0500] "GET /ajax/ldap_search.php?cn=i_typed_this_in_IE HTTP/1.1" 200 69 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-01T16:38:24.533

问题出在 ldap_search.php 文件中。我有这个（基于我在某人的博客上读到的一个例子）：

```
header("content-type:application/xml-xhtml;charset=utf-8"); 
```

它实际上需要这样才能让 IE 正确读取它：

```
header("content-type:application/xml;charset=utf-8"); 
```

上帝，我讨厌 IE。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-01T14:47:56.983

尝试改变：

```
$("#username").blur(refresh_context); 
```

到：

```
$(function(){
    $("#username").blur(refresh_context);
}); 
```

这将推迟分配`blur`事件，直到加载整个页面。

### 编辑：

会不会是`>`在 XML 的文本中使用？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T14:53:02.727

将您的类型设置为“xml”

jQuery.get（网址，[数据]，[回调]，[类型]）

```
$.get("/ajax/ldap_search.php", {cn: $("#username").val()}, function() {
    alert("Check");
},'xml'); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T14:53:00.310

你能查出 Ajax 请求是否被触发了吗？

您可以使用[Web Development Helper](http://projects.nikhilk.net/WebDevHelper/)或[Fiddler](http://www.fiddler2.com/fiddler2/)来记录 Ajax 请求。

作为一般的良好做法，您应该将任何访问 DOM 的 jQuery 代码包含在一个`$(document).ready`函数中。这将确保在加载整个 DOM 之前它不会执行，尽管在这种情况下，如果 div 更改为“正在加载...”，它看起来不会导致问题

```
<script type="text/javascript">
function refresh_context() {
    $("#ajax-context").html("Searching...");
    $.get("/ajax/ldap_search.php", {cn: $("#username").val()}, function(xml) {
        $("#ajax-context").html($("display", xml).text());
        $("#context").val($("context", xml).text());
    }, "xml"); // As pointed out, you should specify the return type
}
$(document).ready(function() {
    $("#username").blur(refresh_context);
});
</script> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T15:46:02.367

您可能希望将[$.get](http://docs.jquery.com/Ajax/jQuery.get#urldatacallbacktype)调用更改为[$.ajax](http://docs.jquery.com/Ajax/jQuery.ajax#options)调用，这样您就可以设置错误处理程序来查看出错的原因。

我记得，这样做是这样的：

```
$.ajax({
    type: 'GET',
    url: "/ajax/ldap_search.php",
    data: {cn: $("#username").val()},
    success: function(response) { /* do something here */ },
    error: function(xhr, type, exception) { alert("Error: " + type); }
}) 
```

异常对象也应该有更多关于错误的细节。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-09-09T10:50:25.627

我有同样的问题，但不是 xml - 我有简单的 html 作为 ajax-return。标头（“内容类型：文本；字符集=utf-8”）；是解决方案。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-06-03T14:45:29.797

不工作：

```
$.post("/welcome/add_mail", function(data){
       alert('ok');   
}); 
```

适用于 IE7 中的基本 url：

```
$.post("http://localhost/welcome/add_mail", function(data){
       alert('ok');   
}); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-01T14:47:23.520

通常使用 $.get/$.post 你必须指定返回类型。这使 jquery 更容易 a) 识别它要查找的内容并 b) 为您解码。

这可能会有所帮助。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-01T16:06:24.033

而不是 $("display", xml).text()

也许试试： $(xml).find("display").text()

你能看到响应是什么，还是只是超时？你能看到发送了哪些参数吗？如果没有，请扩展您的：

```
function refresh_context() {
    $("#ajax-context").html("Searching...");
    $.get("/ajax/ldap_search.php", {cn: $("#username").val()}, function(xml) {
        $("#ajax-context").html($("display", xml).text());
        $("#context").val($("context", xml).text());
    }, "xml"); // As pointed out, you should specify the return type
} 
```

到

```
function refresh_context() {
    $("#ajax-context").html("Searching...");
    $.get("/ajax/ldap_search.php", {cn: $("#username").val()}, function(xml) {
        var displayXml = $("display", xml).text();
        $("#ajax-context").html(displayXml);
        var contextXml = $("context", xml).text();
        $("#context").val(contextXml);
    }, "xml"); // As pointed out, you should specify the return type
} 
```

然后调试脚本。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-04-14T20:29:21.590

我有一个类似的问题，但加载 JSON。$.ajax 修复对我有用，但我也发现在我的情况下它与 URL 有关。当我使用：

```
$.getJSON('',{ ajax: "addressPicker",OID:pickIDNo,s:pickVal}, function(data) { 
```

我会得到一个无声的响应，但是当我用 '?' 替换空 URL '' 时 有效。在您的情况下，URL 存在，但它可能对 URL 很挑剔。

# edi - 正反图

> ID：811675
> 
> 赞同：1
> 
> 时间：2009-05-01T14:42:32.923
> 
> 标签：edi

有没有办法调用 gentran 服务器通过批处理脚本将 EDI 837 文件转换为自定义格式。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T21:00:44.450

我已经好几年没有使用 GENTRAN:Server 了，所以请原谅我的任何模糊之处。

我认为有一个名为 unattend.exe 的可执行文件可用于执行会话文件。我相信您可以从这样的批处理文件中调用它：

c:\*路径名*\unattend.exe c:\*会话文件路径名*\ *sessionname* .ses

更新的版本可能有更好的东西，但这可能值得一试。

# c# - 以编程方式获取内容文件和主要输出

> ID：811691
> 
> 赞同：4
> 
> 时间：2009-05-01T14:46:49.717
> 
> 标签：c#, installation, setup-project

出于某种原因，我们有一个脚本可以创建批处理文件，以将我们编译的程序集、配置文件和各种其他文件 XCOPY 到我们的 beta 测试人员的网络共享中。我们确实有安装程序，但有些没有运行安装程序所需的权限，或者它们是通过 Citrix 运行的。

如果你一提到 XCOPY 和 Citrix 就吐得满桌都是，那就以此为借口早点回家吧。别客气。

该代码目前有数百行，例如：

```
CreateScripts(basePath, "Client", outputDir, FileType.EXE | FileType.DLL | FileType.XML | FileType.CONFIG); 
```

过去情况更糟，有 20 个 int 参数（每种文件类型一个）表示是否将该文件类型复制到输出目录。

这数百行创建了具有数千行 XCOPY 行的上传/下载批处理文件。在我们的设置项目中，我们可以引用诸如“来自客户端的主要输出”和“来自客户端的内容文件”之类的内容。我希望能够通过非设置项目以编程方式执行此操作，但我不知所措。

显然，MS 使用 API 或解析 .csproj 文件来做到这一点。我该怎么做呢？我只是在寻找一种方法来获取任何设置类别的文件列表，即：

*   初级输出
*   本地化资源
*   内容文件
*   文档文件

**编辑**：我有一个像哈斯建议的设置项目，它是我正在寻找的一半。唯一不能成为完美解决方案的问题是多个项目依赖于它们自己的文件夹中的相同程序集，并且安装程序只会复制一次文件。

例子：

项目 Admin、Client 和 Server 都依赖 ExceptionHandler.dll，Admin 和 Client 都依赖 Util.dll，而 Server 不依赖。这就是我要找的：

*   行政
    *   管理员程序
    *   管理员.exe.config
    *   异常处理程序.dll
    *   实用程序.dll
*   客户
    *   客户端.exe
    *   客户端.exe.config
    *   异常处理程序.dll
    *   实用程序.dll
*   服务器
    *   服务器.exe
    *   服务器.exe.config
    *   异常处理程序.dll

由于引用的程序集都是相同的，我得到的是：

*   行政
    *   管理员程序
    *   管理员.exe.config
    *   异常处理程序.dll
    *   实用程序.dll
*   客户
    *   客户端.exe
    *   客户端.exe.config
*   服务器
    *   服务器.exe
    *   服务器.exe.config

当客户端或服务器找不到它所期望的两个 DLL 之一时，这会导致 FileNotFoundException。

我是否缺少设置属性以使其始终复制输出，即使它在另一个项目的输出中的其他地方重复？

**再次编辑**：所有引用的 DLL 都设置为“复制本地”，并且一直如此。我找到了一篇关于[使用 NAnt 和 XSLT 获取文件列表的](http://pwigle.wordpress.com/tag/continuous-integration/)不错的文章，因此正如 neouser99 建议的那样，这也可能是一个可能的解决方案。

**接受的解决方案**：我几乎回到了我开始的地方。所有 .exe 和 .dll 输出都放在安装项目中的“bin”目录中，松散地打包。其他每个应用程序文件夹包含该目录中可执行文件的快捷方式。

现在的不同之处在于，我将向安装程序添加一个自定义操作以使用反射，枚举每个可执行输出的依赖项，并将 .exe 和 .dll 文件复制到单独的目录中。有点痛苦，因为我只是假设有一种方法可以通过一些设置库以编程方式检测将包含哪些文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T15:04:37.410

为什么不使用另一个安装项目，只需将“包文件”设置设置为松散未压缩文件（安装项目-> 属性）？然后共享文件夹..或其他东西。

编辑：

我明白了，您有 3 个文件夹用于输出。但是安装项目只检测到 ExceptionHandler.dll 和 Util.dll 一次，所以它只会选择第一个文件夹并将其放入其中。

你可以为每个项目做一个设置项目——也许有点烦人..

如果您在同一解决方案中有这些项目，您可以通过“添加文件”或“添加程序集”或“添加项目输出”添加文件，手动将 dll 添加到缺少程序集的项目中。（我怀疑是这种情况）。

或者只是将它们全部转储到一个输出目录中......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T15:34:55.123

尽管它被设计为构建工具，但您可能会发现[NAnt](http://nant.sourceforge.net/)在您所谈论的内容中非常有用。您可以定义的任务（构建、复制、移动、删除等）允许非常细粒度的文件查找，直至一般的完整文件夹。如果您还将 NAnt 纳入您的构建过程，我认为您会发现它在更多方面有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-05T21:20:58.173

过去对我有用的另一种方法是添加共享资源（程序集、DLL 或项目）作为对每个管理、服务器和客户端项目的引用。然后打开每个项目中引用项的属性面板，并将“复制本地”设置为 true。

现在，当您构建项目时，每个项目都会将其自己的 Assembly 实例复制到其输出文件夹中。

这也应该导致以这种方式添加的共享组件被复制到安装包中的每个输出文件夹中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-09T07:49:34.213

一种完全不同的方法可能是将它们设置为网络共享上的符号链接。符号链接基本上是一种快捷方式，文件系统隐藏了它是快捷方式的事实，因此所有其他应用程序实际上都认为该文件已被复制（[http://en.wikipedia.org/wiki/ NTFS_symbolic_link](http://en.wikipedia.org/wiki/NTFS_symbolic_link)）。

这种方法的一个优点是文件会在文件更改时立即更新，而不仅仅是在您构建项目时。因此，例如，当您使用文本编辑器保存其中一个配置文件时，会立即应用更新。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-10T19:57:33.497

以下 MSBuild 脚本部分可以构建您的 SLN 文件（您可以将其替换为 .csproj），并将报告已构建的所有项目（Dlls、EXE）的列表。

```
 <MSBuild Projects="MySolution.sln" Targets="Clean; Rebuild" Properties="Configuration=$(BuildMode);">
    <Output TaskParameter="TargetOutputs"
                ItemName="AssembliesBuilt" />
    </MSBuild> 
```

现在，这并不能真正解决您的问题，但它会为您提供已构建的所有内容的列表。你也有 copylocal，所以你可能只需要 AssembiesBuild 并从那里复制所有 DLL 和 .CONFIG 文件。

例子：

AssembliesBuild = c:\myproj\something1\build.dll

你会去 c:\myproj\something1\ 并简单地搜索所有 *.dll 和 *.config 文件并包含它们。如果你安装了 MSBuild 或 powershell，你可以很容易地做到这一点。要从 MSBuild 输出 XCOPY 脚本，我认为您需要安装 MSBuild contrib projct。

# python - Python 超时

> ID：811692
> 
> 赞同：10
> 
> 时间：2009-05-01T14:46:54.770
> 
> 标签：python, multithreading, timeout

我一直在到处寻找一个好的超时脚本，如果它的活动时间超过 X 秒，它可以杀死一个线程，但是我看到的所有示例都存在并不总是停止线程的缺陷。使用 thread.join(x) 最终破坏了它作为线程的目的。

我发现的唯一体面的例子是[函数调用超时，](https://stackoverflow.com/questions/492519/timeout-on-a-python-function-call)而且它并非没有缺陷..

有谁知道更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T16:17:48.997

请参阅我对 python 的回答[：如何在多线程中发送数据包，然后线程自行终止](https://stackoverflow.com/questions/605013/python-how-to-send-packets-in-multi-thread-and-then-the-thread-kill-itself/605865#605865)- 有一个带有 InterruptableThread 类的片段和在超时后终止另一个线程的示例 - 正是你想要的。

在 activestate也有类似的[Python 配方](http://code.activestate.com/recipes/473878/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T15:03:09.800

我知道这可能不是您想要的，但是您是否考虑过信号方法？ [函数调用超时](https://stackoverflow.com/questions/492519/timeout-on-a-python-function-call/494273#494273) [http://docs.python.org/library/signal.html#example](http://docs.python.org/library/signal.html#example)

您可以在线程执行开始时设置警报信号，然后在信号处理程序中停止线程。

# c# - 从枚举加载单选按钮列表时，如何在每个单选按钮旁边显示文本？

> ID：811693
> 
> 赞同：4
> 
> 时间：2009-05-01T14:47:00.900
> 
> 标签：c#, asp.net, radiobuttonlist

我正在从枚举（垂直显示）加载单选按钮列表。我需要显示描述每个单选按钮选择的文本。我正在将它加载到代码隐藏中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T15:19:00.573

我最近发现 Enum 类有很多方面的用途越来越多，其中之一就是 GetNames 方法。此方法返回指定枚举中所有名称的字符串数组。

此代码假定您的页面上有一个名为RadioButtonList1 的**RadioButtonList**。

```
public enum AutomotiveTypes
{
    Car,
    Truck,
    Van,
    Train,
    Plane
}

public partial class _Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        string[] automotiveTypeNames = Enum.GetNames(typeof(AutomotiveTypes));

        RadioButtonList1.RepeatDirection = RepeatDirection.Vertical;

        RadioButtonList1.DataSource = automotiveTypeNames;
        RadioButtonList1.DataBind();
    }
} 
```

试一试，看看它是否对你有用。

干杯!

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T14:50:23.403

您应该能够在控件上使用 .Text 属性。

[http://www.w3schools.com/ASPNET/control_radiobutton.asp](http://www.w3schools.com/ASPNET/control_radiobutton.asp)

编辑：

实际上我认为错过了这个问题，我相信这就是你要找的

```
For Each val As [Enum] In [Enum].GetValues(GetType(YourEnum))
        Radio Button Add Logic Here
Next 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T14:54:02.630

有几个想法是要么拥有一个将描述字符串映射到枚举值的字典，要么你可以[用一个属性来装饰你的枚举值](http://lostinloc.com/tag/c/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-14T09:40:48.363

我有一个小库，相同的代码等，它提供了一个很好的接口，用于为此目的在枚举上使用属性。

[http://daniel-mcadam.com/blog/2009/11/05/User-Display-Text-For-Enums.aspx](http://daniel-mcadam.com/blog/2009/11/05/User-Display-Text-For-Enums.aspx)

# mysql - 如果其他记录不匹配，MySQL 选择记录

> ID：811706
> 
> 赞同：0
> 
> 时间：2009-05-01T14:50:10.177
> 
> 标签：mysql

我有一张桌子，每人每件衣服都有一条记录

所以

```
peter, jumper,blue
peter,trousers,green
sue,dress,green
peter,jumper,red
gordon,jumper,green 
```

我想写一个查询来选择所有有绿色套头衫的人，但前提是他们没有其他颜色套头衫

所以在上述情况下，它只会选择戈登而不是贪婪的老彼得

那可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T14:58:12.277

这应该有效，但未经测试。语法也可能有点不对劲，因为我脑子里仍然有 Firebird SQL，但你应该明白一般的想法：

```
SELECT *
FROM myTable AS t1
WHERE t1.clothing = 'jumper' AND t1.color = 'green' 
AND NOT EXISTS(SELECT *
               FROM myTable AS t2
               WHERE t2.person = t1.person AND t2.clothing = 'jumper'
               AND t2.color <> 'green') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T14:58:32.137

我得跑去开会了，但一份 CASE 声明可能对你有所帮助。

[MySQL CASE 语句](http://dev.mysql.com/doc/refman/5.0/en/case-statement.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T15:03:09.147

```
SELECT *
FROM MyTable t1
WHERE Color = 'green'
AND NOT EXISTS (
    SELECT 1 
    FROM MyTable
    WHERE Color <> 'green'
    AND PersonName = t1.PersonName
) 
```

# java - java中的导入问题？

> ID：811710
> 
> 赞同：1
> 
> 时间：2009-05-01T14:51:07.367
> 
> 标签：java, eclipse, import

我在我的一个 java 应用程序中遇到了导入问题。

我从一个 Eclipse 项目中提取了一个有效的 JSP，从该项目中提取了所有类并将其放入一个新项目中。

在新项目中，我已导入从原始生成的 jar 文件，并将 jsp 代码粘贴到新的 JSP 文档中。

我收到“无法解决导入 XX 错误”。

任何人都知道如何诊断这一点，一切似乎都井井有条。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T14:56:07.867

我偶尔会遇到这样的问题。尝试删除 JAR、重建并再次添加 JAR。这应该解决它。

这是一个 Eclipse 错误。

编辑：上面的答案是假设 jar 实际上在构建路径上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T14:53:04.350

当您说“我已导入 jar 文件”时，您的意思是您已复制它或将其放入类路径中？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T14:57:07.100

添加 Jar 文件而不是 Import 时，右键单击项目并选择“添加外部库”或“添加外部 Jar”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T15:00:27.640

听起来您导入的 jar 没有出现在您的构建路径中。尝试右键单击项目，选择 Build Path > Add External Archives...

这应该在项目构建路径中引用您的 jar。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T15:41:53.623

检查 Jar 内部（只需从构建路径打开它）并查看路径是否正确。如果您将 foo.Bar 作为 foo/Bar.class 以外的其他东西，那可能就是它。

# c++ - C++如何在.exe中编译dll

> ID：811720
> 
> 赞同：8
> 
> 时间：2009-05-01T14:52:51.060
> 
> 标签：c++, dll, compilation

我正在创建一个 c++ 程序，但我希望能够只向用户提供一个 .exe 文件。但是，我正在使用具有一些 dll 的库（curl 等）。是否可以将这些 dll 编译到 .exe 文件中？

我使用 Code::Blocks 和 mingw。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-01T15:33:03.693

为了实现这一点，您将需要[静态链接](http://en.wikipedia.org/wiki/Static_linking)。这要求您的所有库（以及它们递归依赖的库）都需要作为静态库提供。请注意，可执行文件的大小会很大，因为它将携带来自这些静态库的所有代码。这就是为什么首先发明了共享库 (DLL)，以便能够在应用程序之间共享公共代码。但是，这在 windows 上并不总是[那么好用](http://en.wikipedia.org/wiki/Dll_hell)。

我认为您可能真正想要的是[安装](http://en.wikipedia.org/wiki/Windows_installer)可执行文件及其所有依赖库的安装程序。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-01T17:02:32.010

2002 年的 DDJ 中有一篇文章可能有你想要的：

*   [Thiadmer Riemersma 在您的 EXE 中打包 DLL](http://www.ddj.com/windows/184416443)

基本上，它结合了使用 MSVC 的“延迟加载”功能链接到 DLL 并将 DLL 打包为 EXE 中的嵌入式资源的组合。然后，当第一次调用其中一个导出时，会在运行时自动提取 DLL。

我没有使用过这种技术，所以我无法评论它的效果如何，但它确实看起来是一个巧妙的想法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-01T14:57:10.907

您可以使用[ILMerge](http://research.microsoft.com/en-us/people/mbarnett/ilmerge.aspx)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-01T15:36:06.697

我曾经遇到过[dll2lib](http://www.binary-soft.com/dll2lib/dll2lib.htm)实用程序。有趣的一块，虽然很贵。它允许您将几乎任何 dll 转换为静态库，稍后可以将其与您的应用程序链接以生成可靠的 exe。IIRC，免费版将在从此类生成的库中输入函数时显示某些通知（MessageBox）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-01T15:19:21.260

您需要一些特殊的打包工具，例如[XBundler](http://www.oreans.com/xbundler.php)。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-12-17T15:59:15.890

如果你真的需要完成这个，你可以使用这个很棒的库，它允许你从内存中加载一个 DLL。我用它从资源中读取 DLL 并为我加载它。

[https://github.com/fancycode/MemoryModule](https://github.com/fancycode/MemoryModule)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-01-11T21:34:39.237

我是 C++ 和 CODE::BLOCKS 的新手（大约一周后），我遇到了同样的问题。答案很好，但是对于像我这样的完整菜鸟来说，并没有解释如何实施它们。（就像告诉一个穴居人将钥匙放在点火器中。“什么是钥匙？什么是点火器”？）经过足够的探索，我编译（不是双关语）这个解决方案：

在 CODE::BLOCKS 菜单（我有 v20.03）上，单击“设置”，然后单击“编译器...”。

在左侧，单击“全局编译器设置”（默认）。

在“编译器设置选项卡”下，选中以下复选框：
    **静态 libgcc [-static-libgcc]**
    **静态 libstdc++ [-static-libstdc++]**

在“链接器设置”选项卡下，在“其他链接器选项：”框中输入以下内容：
    **-static -lpthread**

单击“确定”，您就成功了！您编译的 C++ EXE 可以独立运行。

我已经通过编译我的几个课程项目来尝试这个并且它有效。它增加了大约 2.3MB 的 EXE 大小。没有承诺这将适用于您的所有项目，只是到目前为止它对我有用。

 **更新，2021-01-12 - 缩小你的 EXE！：**

在“编译器设置”选项卡中，向下滚动到“优化”并检查：
        **从二进制文件中删除所有符号（最小化大小）[-s]**

这将我编译的一个 EXE 文件从 2354k 缩小到 820k！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-01T15:19:50.400

一般来说，没有。DLL 有一些非常重要的特殊行为，例如在加载它们时获取 Loader Lock 并在这些点调用 DllMain。虽然理论上的链接器可以安排从应用程序 main() 调用每个 DllMain，但它不会在 Loaded Lock 下发生。此加载程序锁受操作系统控制。此外，DLL 通过它们的 DLLMain 收到新线程的通知，这也几乎是不可能伪造的。

# c++ - 为什么 Visual C++ 编译器在这里调用错误的重载？

> ID：811724
> 
> 赞同：3
> 
> 时间：2009-05-01T14:53:16.377
> 
> 标签：c++, visual-c++, operator-overloading, temporary

为什么 Visual C++ 编译器在这里调用错误的重载？

我有一个 ostream 的子类，用于定义格式化缓冲区。有时我想创建一个临时的并立即使用通常的 << 运算符将一个字符串插入其中，如下所示：

```
M2Stream() << "the string"; 
```

不幸的是，程序调用 operator<<(ostream, void *) 成员重载，而不是 operator<<(ostream, const char *) 非成员重载。

我编写了下面的示例作为测试，我在其中定义了自己的 M2Stream 类来重现问题。

我认为问题在于 M2Stream() 表达式会产生一个临时的，这会导致编译器更喜欢 void * 重载。但为什么？事实证明，如果我为非成员重载 const M2Stream & 设置第一个参数，我会感到模棱两可。

另一个奇怪的事情是，如果我首先定义一个 const char * 类型的变量然后调用它，而不是文字 char 字符串，它会调用所需的 const char * 重载，如下所示：

```
const char *s = "char string variable";
M2Stream() << s; 
```

就好像文字字符串的类型与 const char * 变量不同！他们不应该是一样的吗？当我使用临时和文字字符字符串时，为什么编译器会调用 void * 重载？

```
#include "stdafx.h"
#include <iostream>
using namespace std;

class M2Stream
{
public:
    M2Stream &operator<<(void *vp)
    {
        cout << "M2Stream bad operator<<(void *) called with " << (const char *) vp << endl;
        return *this;
    }
};

/* If I make first arg const M2Stream &os, I get
\tests\t_stream_insertion_op\t_stream_insertion_op.cpp(39) : error C2666: 'M2Stream::operator <<' : 2 overloads have similar conversions
        \tests\t_stream_insertion_op\t_stream_insertion_op.cpp(13): could be 'M2Stream &M2Stream::operator <<(void *)'
        \tests\t_stream_insertion_op\t_stream_insertion_op.cpp(20): or 'const M2Stream &operator <<(const M2Stream &,const char *)'
        while trying to match the argument list '(M2Stream, const char [45])'
        note: qualification adjustment (const/volatile) may be causing the ambiguity
*/
const M2Stream & operator<<(M2Stream &os, const char *val)
{
    cout << "M2Stream good operator<<(const char *) called with " << val << endl;
    return os;
}

int main(int argc, char argv[])
{
    // This line calls void * overload, outputs: M2Stream bad operator<<(void *) called with literal char string on constructed temporary
    M2Stream() << "literal char string on constructed temporary";

    const char *s = "char string variable";

    // This line calls the const char * overload, and outputs: M2Stream good operator<<(const char *) called with char string variable
    M2Stream() << s;  

    // This line calls the const char * overload, and outputs: M2Stream good operator<<(const char *) called with literal char string on prebuilt object
    M2Stream m;
    m << "literal char string on prebuilt object";
    return 0;
} 
```

输出：

```
M2Stream bad operator<<(void *) called with literal char string on constructed temporary
M2Stream good operator<<(const char *) called with char string variable
M2Stream good operator<<(const char *) called with literal char string on prebuilt object 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-01T15:09:48.583

编译器正在做正确的事情：`Stream() << "hello";`应该使用`operator<<`定义的成员函数。因为临时流对象不能绑定到非 const 引用而只能绑定到 const 引用，所以`char const*`不会选择处理的非成员运算符。

正如您在更改该运算符时所看到的那样，它就是这样设计的。您会产生歧义，因为编译器无法决定使用哪些可用的运算符。`operator<<`因为所有这些都是在设计时考虑到临时拒绝非会员的。

那么，是的，字符串文字的类型与 a 不同`char const*`。字符串文字是 const 字符的数组。但这在你的情况下并不重要，我认为。我不知道`operator<<`MSVC++ 的重载增加了什么。允许添加更多的重载，只要它们不影响有效程序的行为。

为什么`M2Stream() << s;`即使第一个参数是非常量引用也能工作...嗯，MSVC++ 有一个扩展，允许非常量引用绑定到临时对象。将警告级别设置为级别 4 以查看有关它的警告（类似于“使用非标准扩展...”）。

现在，因为有一个成员 operator<< 接受 a `void const*`，并且 a`char const*`可以转换为它，所以将选择该运算符并输出地址，因为这就是`void const*`重载的目的。

我在您的代码中看到您实际上有`void*`重载，而不是`void const*`重载。好吧，字符串文字可以转换为`char*`，即使字符串文字的类型是`char const[N]`（其中 N 是您输入的字符数）。但是这种转换已被弃用。字符串文字转换为`void*`. 在我看来，这是 MSVC++ 编译器的另一个扩展。但这可以解释为什么字符串文字的处理方式与`char const*`指针不同。这就是标准所说的：

> 不是宽字符串文字的字符串文字（2.13.4）可以转换为“pointer to char”类型的右值；宽字符串文字可以转换为“指向 wchar_t 的指针”类型的右值。无论哪种情况，结果都是指向数组第一个元素的指针。仅当存在显式适当的指针目标类型时才考虑这种转换，而不是当一般需要从左值转换为右值时。[注意：此转换已弃用。见附件 D。]

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-01T15:12:46.050

第一个问题是由怪异而棘手的 C++ 语言规则引起的：

1.  通过调用构造函数创建的临时值是**右值**。
2.  右值不能绑定到非常量引用。
3.  但是，右值对象可以调用非常量方法。

正在发生的事情是`ostream& operator<<(ostream&, const char*)`，一个非成员函数，尝试将`M2Stream`您创建的临时对象绑定到非常量引用，但失败了（规则 #2）；but`ostream& ostream::operator<<(void*)`是一个成员函数，因此可以绑定到它。在没有该`const char*`功能的情况下，它被选为最佳重载。

我不确定为什么 IOStreams 库的设计者决定`operator<<()`为`void*`一个方法而不是`operator<<()`为`const char*`，但事实就是这样，所以我们需要处理这些奇怪的不一致。

我不确定为什么会出现第二个问题。您是否在不同的编译器中获得相同的行为？它可能是编译器或 C++ 标准库错误，但我将把它作为最后手段的借口——至少看看你是否可以`ostream`先用常规方法复制该行为。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T15:04:19.783

问题是您使用的是临时流对象。将代码更改为以下内容，它将起作用：

```
M2Stream ms;
ms << "the string"; 
```

基本上，编译器拒绝将临时绑定到非 const 引用。

关于第二点关于为什么当你有一个“const char *”对象时它会绑定，我认为这是 VC 编译器中的一个错误。但是，我不能肯定地说，当您只有字符串文字时，会转换为“void *”并转换为“const char *”。当您拥有“const char *”对象时，第二个参数不需要转换 - 这可能是 VC 允许非 const ref 绑定的非标准行为的触发器。

我相信 8.5.3/5 是涵盖这一点的标准部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T15:03:29.830

我不确定您的代码是否应该编译。我认为：

```
M2Stream & operator<<( void *vp ) 
```

应该：

```
M2Stream & operator<<( const void *vp ) 
```

其实多看代码，相信你所有的问题都归结为const。以下代码按预期工作：

```
#include <iostream>
using namespace std;

class M2Stream
{
};

const M2Stream & operator<<( const M2Stream &os, const char *val)
{
    cout << "M2Stream good operator<<(const char *) called with " << val << endl;
    return os;
}

int main(int argc, char argv[])
{
    M2Stream() << "literal char string on constructed temporary";

    const char *s = "char string variable";

    // This line calls the const char * overload, and outputs: M2Stream good operator<<(const char *) called with char string variable
    M2Stream() << s;  

    // This line calls the const char * overload, and outputs: M2Stream good operator<<(const char *) called with literal char string on prebuilt object
    M2Stream m;
    m << "literal char string on prebuilt object";
    return 0;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T16:16:06.413

您可以使用这样的重载：

```
template <int N>
M2Stream & operator<<(M2Stream & m, char const (& param)[N])
{
     // output param
     return m;
} 
```

作为额外的奖励，您现在知道 N 是数组的长度。

# http - ActiveMQ 5.2.0 + REST + HTTP POST = java.lang.OutOfMemoryError

> ID：811732
> 
> 赞同：4
> 
> 时间：2009-05-01T14:54:51.910
> 
> 标签：http, post, activemq, out-of-memory

首先，我是 JMS 和 ActiveMQ 的新手。

我一直在研究一种消息传递解决方案，作为消息生产者的中间件，该消息生产者将通过 HTTP POST 将 XML 消息插入队列。生产者是用 C++ 编写的现有系统，无法修改（因此 Java 和 C++ API 已出局）。

使用“演示”示例和一些试验和错误，我拼凑了一个我想要做的工作示例（在 Windows 框中）。

我在“webapps”下的测试目录中配置的 web.xml 指定从生产者接收到的 HTTP POST 消息将由 MessageServlet 处理。

我在“activemq.xml”中为文本应用添加了一行（“ow”是测试应用目录）：

我创建了一个测试脚本来将消息“插入”到运行良好的队列中。

我遇到的问题是，当我继续通过 REST/HTTP POST 插入消息时，ActiveMQ 使用的内存消耗和线程数继续增加（当我有及时的消费者以及缓慢或不存在的消费者时会发生这种情况）。

当内存消耗达到 250MB 左右并且线程数超过 5000（如 Windows 任务管理器中所示）时，ActiveMQ 崩溃，我在日志中看到：

线程“ActiveMQ Transport Initiator：vm://localhost#3564”中的异常 java.lang.OutOfMemoryError：无法创建新的本机线程

就好像 Jetty 正在生成一个新线程来处理每个 HTTP POST，并且该线程永远不会死亡。

我确实看过这个页面：

[http://activemq.apache.org/javalangoutofmemory.html](http://activemq.apache.org/javalangoutofmemory.html)

并尝试过，但这并没有解决问题（尽管我也没有完全理解更改的含义）。

有没有人有任何想法？

谢谢！

*   布鲁斯·罗斯

PS - 我在下面包含了“测试消息生产者”python 脚本，以了解它的价值。我创建了 100 条消息的批次，并继续从命令行手动运行脚本，同时在任务管理器中观察 ActiveMQ 的内存消耗和线程数。

```
def foo():
    import httplib, urllib

    body = "<?xml version='1.0' encoding='UTF-8'?>\n \
    <ROOT>\n \
        [snip: xml deleted to save space]
    </ROOT>"

    headers = {"content-type": "text/xml",
               "content-length": str(len(body))}

    conn = httplib.HTTPConnection("127.0.0.1:8161")
    conn.request("POST", "/ow/message/RDRCP_Inbox?type=queue", body, headers)
    response = conn.getresponse()
    print response.status, response.reason
    data = response.read()
    conn.close()
## end method definition

## Begin test code
count = 0;

while(count < 100):
    # Test with batches of 100 msgs
    count += 1
    foo() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-13T09:14:57.820

该错误不是由 ActiveMQ 直接引起的，而是由 Java 运行时引起的。看看这里：

[http://activemq.apache.org/javalangoutofmemory.html](http://activemq.apache.org/javalangoutofmemory.html)

如何为 Java HEAP 增加内存。关于为什么会发生这种情况以及您可以采取哪些措施来防止这种情况，还有一些有趣的东西。ActiveMQ 非常好，但需要在配置文件中到处进行一些自定义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-25T12:49:35.043

您可能希望将以下内容添加到 URL 的查询字符串中：
`JMSDeliveryMode=persistent`

否则，根据定义（阅读“默认情况”），消息将保存在 AMQ 的内存中。

# asp.net - 使 CustomValidator 与 ValidationSummary 消息框一起工作的优雅方式

> ID：811734
> 
> 赞同：19
> 
> 时间：2009-05-01T14:55:01.473
> 
> 标签：asp.net, customvalidator, validationsummary

我以前遇到过这个问题，但从来没有完全解决过。我有一个包含多个验证器和一个 CustomValidator 的表单。

```
<asp:Label ID="lblMemberNum" runat="server" Text="Membership #:" CssClass="LabelMedium"  ></asp:Label>
<asp:TextBox ID="txtMemberNum" runat="server" CssClass="TextBox" ></asp:TextBox>
<asp:RequiredFieldValidator ID="rfvMemberNum" SetFocusOnError="True" runat="server"
    ControlToValidate="txtMemberNum" ErrorMessage="[ Membership # ] is required"
    CssClass="ValidationMessage" Display="Dynamic" >*</asp:RequiredFieldValidator>
<asp:RegularExpressionValidator ID="revMemberNum"  Display="Dynamic" runat="server" 
    ControlToValidate="txtMemberNum" CssClass="ValidationMessage" 
    ErrorMessage="[ Membership # ] can only contain letters" 
    ValidationExpression="^([a-zA-Z\d]+)$" >*</asp:RegularExpressionValidator>
<asp:CustomValidator ID="cvMemberNum" runat="server" 
    CssClass="ValidationMessage" Display="Dynamic"
    ControlToValidate="txtMemberNum" ValidateEmptyText="false"
    OnServerValidate="cvMemberNum_Validate" 
    ErrorMessage="This membership number is already registered">*</asp:CustomValidator>

<asp:ValidationSummary ID="ValidationSummary1" runat="server" 
    CssClass="ValidationMessage" 
    ShowMessageBox="True" ShowSummary="False" /> 
```

在服务器端：

```
protected void cvMemberNum_Validate(object source, ServerValidateEventArgs args)
{
    try
    {
        args.IsValid  = (!CampaignRegistration.IsMemberRegistered(args.Value));
    }
    catch
    {
        args.IsValid = false;
    }
} 
```

我的问题是：ValidationSummary 从不显示来自 CustomValidator 的消息。这个问题在很多地方都被问过，但我还没有看到满意的答案。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-01T15:00:04.100

尝试在所有验证器和 ValidationSummary 中使用 ValidationGroup 属性。

**编辑：**另一种可能性可能是服务器验证码

```
args.IsValid = (!CampaignRegistration.IsMemberRegistered(args.Value)); 
```

如果`CampaignRegistration.IsMemberRegistered(args.Value)`返回假，“！” 使它成为真的，因此使它有效。我认为你应该摆脱“！” 如下：

```
args.IsValid = CampaignRegistration.IsMemberRegistered(args.Value); 
```

**更新：**为了使 ValidationSummary 在消息框中显示您的自定义验证器消息，您需要拥有[ClientValidationFunction](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.customvalidator.clientvalidationfunction.aspx)代码。如果您只需要显示摘要而不显示弹出窗口，则不需要。

```
<asp:CustomValidator ID="cvMemberNum" runat="server" 
    CssClass="ValidationMessage" Display="Dynamic"
    ControlToValidate="txtMemberNum" ValidateEmptyText="false"
    OnServerValidate="cvMemberNum_Validate"
    ClientValidationFunction = "ClientValidate"  
    ErrorMessage="This membership number is already registered">*</asp:CustomValidator>
   //JavaScript Code.
   function ClientValidate(source, args)
   {         
      args.IsValid = false; //you need to add validation logic here
   } 
```

**更多：**如果你不想做客户端验证，试试这个技巧来显示警报。对您的 CustomValidator ServerValidate 方法进行此更改：

```
protected void cvMemberNum_Validate(object source, ServerValidateEventArgs args)
{
    bool isValid = true;
    try
    {
        isValid  = (!CampaignRegistration.IsMemberRegistered(args.Value));
    }
    catch
    {
        isValid = false;
    }
    args.IsValid = isValid;

    if(!isValid)
    {
       if(!Page.IsClientScriptBlockRegistered("CustomValidation")) 
         Page.RegisterClientScriptBlock("CustomValidation", "<script>alert('This membership number is already registered');</script>"); 

    }

} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-01T16:24:29.950

[ShowMessageBox](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.validationsummary.showmessagebox.aspx)选项完全是客户端的，因此它只会评估您是否在[CustomValidator上设置了](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.customvalidator.aspx)[ClientValidationFunction](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.customvalidator.clientvalidationfunction.aspx)。

您还可以通过注册发出警报的脚本来伪造它，因此当您从服务器验证返回时，它会提示错误消息。这可以在 ServerValidate 方法中注册（每个[@Jose Basilio](https://stackoverflow.com/questions/811734/elegant-way-to-make-customvalidator-work-with-validationsummary-messagebox/811761#811761)），或者您可以在 PreRender 事件期间调用以下方法来注册一个包含页面上所有无效验证器的弹出窗口：

```
 /// <summary>
    /// Registers a script to display error messages from server-side validation as the specified <see cref="UserControl"/> or <see cref="Page"/> loads from a postback.
    /// </summary>
    /// <remarks>
    /// Must be called in the PreRender if used to validate against the Text property of DNNTextEditor controls, otherwise Text will not be populated.
    /// Must set the ErrorMessage manually if using a resourcekey, otherwise the resourcekey will not have overridden the ErrorMessage property.
    /// </remarks>
    /// <param name="ctrl">The <see cref="UserControl"/> or <see cref="Page"/> which is being posted back.</param>
    /// <param name="validationGroup">The validation group against which to validate.</param>
    public static void RegisterServerValidationMessageScript(TemplateControl ctrl, string validationGroup)
    {
        if (ctrl != null && ctrl.Page.IsPostBack)
        {
            ctrl.Page.Validate(validationGroup);
            if (!ctrl.Page.IsValid)
            {
                StringBuilder errorMessage = new StringBuilder("<script language='javascript'>alert('");
                for (int i = 0; i < ctrl.Page.Validators.Count; i++)
                {
                    IValidator validator = ctrl.Page.Validators[i];
                    if (!validator.IsValid)
                    {
                        errorMessage.Append("- " + validator.ErrorMessage);
                        if (i < ctrl.Page.Validators.Count - 1)
                        {
                            errorMessage.Append(@"\r\n");
                        }
                    }
                }

                errorMessage.Append("');</script>");
                ctrl.Page.ClientScript.RegisterStartupScript(typeof(IValidator), "validationAlert", errorMessage.ToString(), false);
            }
        }
    } 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-09-06T14:32:18.890

我最近遇到了同样的问题。当 ServerValidate 声明验证失败时，ValidationSummary 未显示来自 CustomValidator 的 ErrorMessage。由于默认情况下（正如我的小逆向工程所示）验证摘要在回发时呈现客户端，我只是添加了一个脚本，用于检查文档加载/异步回发完成的所有验证器，并为失败的验证组触发验证摘要创建：

```
$(document).ready(function () {
    var displayAlert = function () {
        if (typeof Page_Validators == 'undefined') return;

        var groups = [];
        for (i = 0; i < Page_Validators.length; i++)
            if (!Page_Validators[i].isvalid) {
                if (!groups[Page_Validators[i].validationGroup]) {
                    ValidationSummaryOnSubmit(Page_Validators[i].validationGroup);
                    groups[Page_Validators[i].validationGroup] = true;
                }
            }
    };

    displayAlert();

    Sys.WebForms.PageRequestManager.getInstance().add_endRequest(
                    function () {
                        displayAlert();
                    });
}
); 
```

在我的场景中，我在父页面上嵌套了带有验证器、更新面板和验证摘要的用户控件。

[更多细节在这里。](http://saplin.blogspot.com/2010/09/validationsummary-and-displaying-error.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-01T15:12:20.903

你应该写一个属性

`ValidationGroup="ValidationSummary1"`

在您的案例中的每个验证器上。

还要检查您的页面是否有

```
AutoEventWireup="true" 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-08-03T09:47:46.747

这对我有用：

```
<asp:CustomValidator runat="server" ID="cv" 
ClientValidationFunction="ValidateFunction"
ErrorMessage="Default error
message">*</asp:CustomValidator>

<script type="text/javascript">
function ValidateFunction(sender, args) 
{

var msg ='';
var formValid = true;

[various checks setting msg and formValid]

if (msg.length > 0) { sender.errormessage = msg; }
args.IsValid = formValid;

}
</script> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-10-26T15:28:20.323

当 javascript 被禁用并且`ValidationSummary`不显示`errorMessage`. `CustomValidator`这是必需的，因为如上所述的注入脚本或警报将不起作用。

添加一个新的 Validator 控件，我们将其命名为`CustomValidatorProxy`，将其`ControlToValidate`属性设置为窗体上的任何一个控件，然后`EnableClientScript=false`.

在`ServerValidate`事件处理程序中执行您的自定义验证，如果验证失败，则将 and 的属性设置为`IsValid`false并类似地设置这两个属性。 `CustomValidator``CustomValidatorProxy``ErrorMessage`

如果通过了验证，请`ServerValidate`确保将 IsValid 属性`CustomValidatorProxy`设置为 true。

如果在Page`CustomValidatorProxy`之前，ServerValidate 处理程序将覆盖在验证值后返回的属性值，并且您的from your将显示在.`CustomValidator``ValidatorCollection``IsValid``CustomValidatorProxy``ControlToValidate``ErrorMessage``CustomValidator``ValidationSummary`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-04-11T16:08:05.370

bduke 的 RegisterServerValidationMessageScript 是在“伪造”，但事实并非如此。它确实解决了问题。每个 Utility 命名空间都需要这个函数。

# python - 是什么导致了这个 Genshi 的模板语法错误？

> ID：811737
> 
> 赞同：0
> 
> 时间：2009-05-01T14:55:32.567
> 
> 标签：python, syntax-error, genshi

Genshi 模板引发以下错误：

> TemplateSyntaxError：指令表达式`"${item.error}"`中的语法无效`"choose"`

错误指定的模板代码部分如下（*'feed' 是传递给模板的字典列表*）：

```
<item py:for="item in feed">
<py:choose error="${item.error}">
    <py:when error="0">
        <title>${item.something}</title>
    </py:when>
    <py:otherwise>
        <title>${item.something}</title>
    </py:otherwise>
</py:choose>
</item> 
```

基本上， item.error 包含 a`'0'`或 a `'1'`，我想要基于它的输出。我不确定错误在哪里 - 任何帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-21T17:44:08.477

[文档](http://genshi.edgewall.org/wiki/Documentation/0.5.x/xml-templates.html#id2)可能没有说明这一点，但是需要调用该属性`test`（就像在他们的示例中一样）而不是`error`.

```
<item py:for="item in feed">
<py:choose test="item.error">
    <py:when test="0">
        <title>${item.something}</title>
    </py:when>
    <py:otherwise>
        <title>${item.something}</title>
    </py:otherwise>
</py:choose>
</item> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T18:49:34.843

我从未使用过 Genshi，但根据我找到的文档，您似乎正在尝试在模板指令参数中使用内联 Python 表达式语法，这似乎是不必要的。试试这个：

```
<item py:for="item in feed">
<py:choose error="item.error">
    <py:when error="0">
        <title>${item.something}</title>
    </py:when>
    <py:otherwise>
        <title>${item.something}</title>
    </py:otherwise>
</py:choose>
</item> 
```

# javascript - 如何让 jquery 完全并行执行动画？

> ID：811750
> 
> 赞同：7
> 
> 时间：2009-05-01T14:57:47.223
> 
> 标签：javascript, jquery, jquery-ui

我正在尝试在 jquery 中创建一个类似于[jquery 的手风琴插件](http://jqueryui.com/demos/accordion/)的手风琴小部件，不同之处在于我希望句柄出现在它们各自的内容下方而不是上方。我的手风琴的工作原理是降低打开内容部分的高度，同时增加点击内容部分的高度。我在[这里](http://cobradragon.com/~adam/accordion/)发布了一个例子。我的问题是动画不是在完全相同的时间开始的，并且由于第二个动画开始之前的轻微延迟而出现了明显的“跳跃”。

Scriptaculous 有一个名为[Effect.Parallel](http://wiki.github.com/madrobby/scriptaculous/effect-parallel)的函数，它允许您创建一组动画效果并并行执行它们。不幸的是，我似乎找不到与 jquery 类似的东西。

有没有办法可以在 jquery 中的单独 div 上运行精确的并行动画？

编辑：我对编码这个手风琴小部件的替代方法很感兴趣。因此，如果人们认为还有其他方法可行，我对此持开放态度。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-07T15:33:07.837

还有一个答案，希望我的最后一个......

不幸的是，John Resig 的 syncAnimate 方法对于我想做的手风琴式动画来说还不够。虽然它在 Firefox 上运行良好，但我无法让它在 IE 或 Safari 上顺利运行。

话虽如此，我决定硬着头皮编写自己的动画引擎来执行简单的并行动画。类代码使用 jquery 函数，但不是 jquery 插件。另外，我只设置它来做大小/位置动画，这就是我所需要的。

```
ParallelAnimations = function(animations, opts){
    this.init(animations, opts);
};

$.extend(ParallelAnimations.prototype, {
    options: {
        duration: 250
    },
    rules: {},

    init: function(animations, opts){
        // Overwrite the default options
        $.extend(this.options, opts);

        // Create a set of rules to follow in our animation
        for(var i in animations){
            this.rules[i] = {
                element: animations[i].element,
                changes: new Array()
            };

            for(var style in animations[i].styles){

                // Calculate the start and end point values for the given style change
                var from = this.parse_style_value(animations[i].element, style, "");
                var to = this.parse_style_value(animations[i].element, style, animations[i].styles[style]);

                this.rules[i].changes.push({
                    from: from,
                    to: to,
                    style: style
                });
            }
        }

        this.start()
    },

    /*
     * Does some parsing of the given and real style values
     * Allows for pixel and percentage-based animations
     */
    parse_style_value: function(element, style, given_value){
        var real_value = element.css(style);

        if(given_value.indexOf("px") != -1){
            return {
                amount: given_value.substring(0, (given_value.length - 2)),
                unit: "px"
            };
        }

        if(real_value == "auto"){
            return {
                amount: 0,
                unit: "px"
            };
        }

        if(given_value.indexOf("%") != -1){
            var fraction = given_value.substring(0, given_value.length - 1) / 100;

            return {
                amount: (real_value.substring(0, real_value.length - 2) * fraction),
                unit: "px"
            };
        }

        if(!given_value){
            return {
                amount: real_value.substring(0, real_value.length - 2),
                unit: "px"
            };
        }
    },

    /*
     * Start the animation
     */
    start: function(){
        var self = this;
        var start_time = new Date().getTime();
        var freq = (1 / this.options.duration);

        var interval = setInterval(function(){
            var elapsed_time = new Date().getTime() - start_time;

            if(elapsed_time < self.options.duration){
                var f = elapsed_time * freq;

                for(var i in self.rules){
                    for(var j in self.rules[i].changes){
                        self.step(self.rules[i].element, self.rules[i].changes[j], f);
                    }
                }
            }
            else{
                clearInterval(interval);

                for(var i in self.rules){
                    for(var j in self.rules[i].changes)
                        self.step(self.rules[i].element, self.rules[i].changes[j], 1);
                }
            }
        }, 10);
    },

    /*
     * Perform an animation step
     * Only works with position-based animations
     */ 
    step: function(element, change, fraction){

        var new_value;
        switch(change.style){
            case 'height':
            case 'width':
            case 'top':
            case 'bottom':
            case 'left':
            case 'right':
            case 'marginTop':
            case 'marginBottom':
            case 'marginLeft':
            case 'marginRight':
                new_value = Math.round(change.from.amount - (fraction * (change.from.amount - change.to.amount))) + change.to.unit;
                break;
        }

        if(new_value)
            element.css(change.style, new_value);
    }
}); 
```

那么原来的 Accordion 类只需要在 animate 方法中修改就可以使用新的调用。

```
Accordion = function(container_id, options){
    this.init(container_id, options);
}

$.extend(Accordion.prototype, {
    container_id: '',
    options: {},
    active_tab: 0,    
    animating: false,
    button_position: 'below',
    duration: 250,
    height: 100,

    handle_class: ".handle",
    section_class: ".section",

    init: function(container_id, options){
        var self = this;
        this.container_id = container_id;
        this.button_position = this.get_button_position();

        // The height of each section, use the height specified in the stylesheet if possible
        this.height = $(this.container_id + " " + this.section_class).css("height");

        if(options && options.duration)    this.duration = options.duration;
        if(options && options.active_tab)  this.active_tab = options.active_tab;

        // Set the first section to have a height and be "open"
        // All the rest of the sections should have 0px height
        $(this.container_id).children(this.section_class).eq(this.active_tab)
            .addClass("open")
            .css("height", this.height)
            .siblings(this.section_class)
            .css("height", "0px");

        // figure out the state of the handles
        this.do_handle_logic($(this.container_id).children(this.handle_class).eq(this.active_tab));

        // Set up an event handler to animate each section
        $(this.container_id + " " + this.handle_class).mouseover(function(){

            if(self.animating)
                return;

            self.animate($(this));
        });
    },

    /*
     * Determines whether handles are above or below their associated section
     */     
    get_button_position: function(){
        return ($(this.container_id).children(":first").hasClass(this.handle_class) ? 'above' : 'below');
    },

    /*
     * Animate the accordion from one node to another
     */ 
    animate: function(handle){
        var active_section = (this.button_position == 'below' ? handle.prev() : handle.next());    
        var open_section = handle.siblings().andSelf().filter(".open");

        if(active_section.hasClass("open"))
            return;

        this.animating = true;

        // figure out the state of the handles
        this.do_handle_logic(handle);

        // Close the open section
        var arr = new Array();
        arr.push({
            element: open_section,
            styles: {
                "height": "0px"
            }
        });
        arr.push({
            element: active_section,
            styles: {
                "height": this.height
            }
        });
        new ParallelAnimations(arr, {duration: this.duration});

        var self = this;
        window.setTimeout(function(){
            open_section.removeClass("open");
            active_section.addClass("open");
            self.animating = false;
        }, this.duration);
    },

    /*
     * Update the current class or "state" of each handle
     */ 
    do_handle_logic: function(handle){
        var all_handles = handle.siblings(".handle").andSelf();
        var above_handles = handle.prevAll(this.handle_class);
        var below_handles = handle.nextAll(this.handle_class);

        // Remove all obsolete handles
        all_handles
            .removeClass("handle_on_above")
            .removeClass("handle_on_below")
            .removeClass("handle_off_below")
            .removeClass("handle_off_above");

        // Apply the "on" state to the current handle
        if(this.button_position == 'below'){
            handle
                .addClass("handle_on_below");
        }
        else{
            handle
                .addClass("handle_on_above");
        }

        // Apply the off above/below state to the rest of the handles
        above_handles
            .addClass("handle_off_above");

        below_handles
            .addClass("handle_off_below");
    }
}); 
```

HTML 仍然以相同的方式调用：

```
<html>
<head>
    <title>Parallel Accordion Animation</title>
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="ui.js"></script>
    <script type="text/javascript">
    $(document).ready(function(){
        new Accordion("#accordion");
    });
    </script>
    <style type="text/css">
    #accordion{
        position: relative;
    }
    #accordion .handle{
        width: 260px;
        height: 30px;
        background-color: orange;
    }
    #accordion .section{
        width: 260px;
        height: 445px;
        background-color: #a9a9a9;
        overflow: hidden;
        position: relative;
    }
    </style>
</head>
<body>

<div id="accordion">
    <div class="section"><!-- --></div>
    <div class="handle">handle 1</div>
    <div class="section"><!-- --></div>
    <div class="handle">handle 2</div>
    <div class="section"><!-- --></div>
    <div class="handle">handle 3</div>
    <div class="section"><!-- --></div>
    <div class="handle">handle 4</div>
    <div class="section"><!-- --></div>
    <div class="handle">handle 5</div>
</div>

</body>
</html> 
```

我将来可能会添加一些内容： - 排队动画 - 其他类型样式（颜色等）的动画

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T18:22:21.257

John Resig 发布了一个[同步动画示例](http://ejohn.org/files/sync/)（没有说明，请单击彩色框）。弄清楚如何将其应用于您的控件可能需要一些工作，但这可能是一个很好的起点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T19:54:53.000

这并不能解决并行运行的动画，但是它可以在没有抖动的情况下重现您的预期行为。我将部分放在手柄内以减少动画的数量。您可以使用 andSelf() 使代码更小，但会更难阅读。您将需要进行一些样式调整。

```
<html>
<head>
    <title>Accordion Test</title>
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript">

    $(document).ready(function(){
        $("#accordion .handle").click(function(){
            var open = $(this).parent().children(".section, .open");
            var active = $(this);

            if (!active.hasClass("open"))
            {
                if (active.hasClass("up"))
                {
                  console.log("up");
                  active.animate({top:"+=100"}).removeClass("up");
                  active.nextAll(".handle").andSelf().filter(".up").animate({top:"+=100"}).removeClass("up");
                  $(".section", active).slideUp();
                  $(".section", active.nextAll()).slideUp();
                  $(".section", active.prev()).slideDown();
                }
                else
                {
                  active.prevAll(".handle").not(".up").animate({top:"-=100"}).addClass("up");
                  $(".section", active.prev()).slideDown();
                }

                open.removeClass("open");
                active.addClass("open");
            }
        });
    });

    </script>
    <style type="text/css">
        #accordion{
            width: 200px;
            position:relative;
        }
        #accordion .section{
            width: 196px;
            margin-left: 2px;
            height: 100px;
            background-color: #b9b9b9;
            display:none;
        }
        #accordion .handle{
            width: 200px;
            height: 30px;
            background-color: #d9d9d9;
            border: 1px solid black;
            cursor: pointer;
            cursor: hand;
            position: absolute;
        }
        #accordion .handle .header {
            height: 30px;
        }
    </style>
</head>
<body>

<div id="accordion">
    <div id="s1" class="section open" style="display:block">This is section 1</div>

    <div class="handle open" style="top:100;">
      <div class="header">handle 1</div>
      <div class="section">This is section 2</div>
    </div>

    <div class="handle" style="top:130;">
      <div class="header">handle 2</div>
      <div class="section">This is section 3</div>
    </div>

    <div class="handle" style="top:160;">
      <div class="header">handle 3</div>
      <div class="section">This is section 4</div>
    </div>

    <div class="handle" style="top:190;">
      <div class="header">handle 4</div>
      <div class="section">This is section 5</div>
    </div>

    <div class="handle" style="top:220;">
      <div class="content">handle 5</div>
    </div>
</div>

</body>
</html> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-04-29T08:03:22.900

感谢 Adam Plumb 为并行动画提供了一个非常好的解决方案。不过我有一个小问题，那就是它以某种方式保存了早期动画中的角色，我通过在将规则添加到 init 函数之前将规则设置为 {} 来解决这个问题。不过，它可能可以以更好的方式完成。我还添加了一个在动画完成时调用的回调函数。

```
ParallelAnimations = function(animations, opts){
    this.init(animations, opts);
};

$.extend(ParallelAnimations.prototype, {
    options: {
        duration: 250,
        callback: null
    },
    rules: {},

    init: function(animations, opts){
        // Overwrite the default options
        $.extend(this.options, opts);

        // Create a set of rules to follow in our animation
        this.rules = {}; // Empty the rules.
        for(var i in animations){
            this.rules[i] = {
                element: animations[i].element,
                changes: new Array()
            };

            for(var style in animations[i].styles){

                // Calculate the start and end point values for the given style change
                var from = this.parse_style_value(animations[i].element, style, "");
                var to = this.parse_style_value(animations[i].element, style, animations[i].styles[style]);

                this.rules[i].changes.push({
                    from: from,
                    to: to,
                    style: style
                });
            }
        }

        this.start()
    },

    /*
     * Does some parsing of the given and real style values
     * Allows for pixel and percentage-based animations
     */
    parse_style_value: function(element, style, given_value){
        var real_value = element.css(style);

        if(given_value.indexOf("px") != -1){
            return {
                amount: given_value.substring(0, (given_value.length - 2)),
                unit: "px"
            };
        }

        if(real_value == "auto"){
            return {
                amount: 0,
                unit: "px"
            };
        }

        if(given_value.indexOf("%") != -1){
            var fraction = given_value.substring(0, given_value.length - 1) / 100;

            return {
                amount: (real_value.substring(0, real_value.length - 2) * fraction),
                unit: "px"
            };
        }

        if(!given_value){
            return {
                amount: real_value.substring(0, real_value.length - 2),
                unit: "px"
            };
        }
    },

    /*
     * Start the animation
     */
    start: function(){
        var self = this;
        var start_time = new Date().getTime();
        var freq = (1 / this.options.duration);

        var interval = setInterval(function(){
            var elapsed_time = new Date().getTime() - start_time;

            if(elapsed_time < self.options.duration){
                var f = elapsed_time * freq;

                for(var i in self.rules){
                    for(var j in self.rules[i].changes){
                        self.step(self.rules[i].element, self.rules[i].changes[j], f);
                    }
                }
            }
            else{
                clearInterval(interval);

                for(var i in self.rules){
                    for(var j in self.rules[i].changes)
                        self.step(self.rules[i].element, self.rules[i].changes[j], 1);
                }
                if(self.options.callback != null) {
                    self.options.callback(); // Do Callback
                }
            }
        }, 10);
    },

    /*
     * Perform an animation step
     * Only works with position-based animations
     */ 
    step: function(element, change, fraction){

        var new_value;
        switch(change.style){
            case 'height':
            case 'width':
            case 'top':
            case 'bottom':
            case 'left':
            case 'right':
            case 'marginTop':
            case 'marginBottom':
            case 'marginLeft':
            case 'marginRight':
                new_value = Math.round(change.from.amount - (fraction * (change.from.amount - change.to.amount))) + change.to.unit;
                break;
        }

        if(new_value)
            element.css(change.style, new_value);
    }
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T18:33:40.823

我认为你的问题不是时间而是像素的分数划分。如果您尝试此代码，它对于句柄 1 和 2 看起来很流畅，但在 Firefox 3 中则不然，但在 chrome 中仍然看起来很跳跃。

```
 active
    .animate({ height: "100px" })
    .siblings(".section")
    .animate({ height: "0px" }); 
```

您是否考虑过将元素的位置设为静态或绝对？如果您只移动两个元素的位置，则不必担心其他元素的跳跃。给我一秒钟，我会试着举个例子。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-06T15:03:40.040

*更新：我不再使用 John Resig 的 syncAnimate 插件。请参阅我稍后的答案以获得最终解决方案*

我只是想提供我在项目中使用的最终工作解决方案。它使用 John Resig 编写的[syncAnimate 插件](http://ejohn.org/files/sync/)（由 Corbin March 发布）。

此代码将：

*   阅读和使用 CSS 中的部分高度
*   允许您通过选项对象设置动画持续时间和默认活动部分。
*   自动检测手柄相对于截面的位置并进行相应调整。因此，您将句柄移动到标记中某个部分的上方或下方，而不必更改 js 代码。

**HTML**

```
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="ui.js"></script>

<script type="text/javascript">
$(document).ready(function(){
    new Accordion("#accordion", {active_tab: 0});
});
</script>
<style type="text/css">
#accordion .handle{
    width: 260px;
    height: 30px;
    background-color: orange;
}
#accordion .section{
    width: 260px;
    height: 445px;
    background-color: #a9a9a9;
    overflow: hidden;
    position: relative;
}

</style>

<div id="accordion">
    <div class="section">Section Code</div>
    <div class="handle">handle 1</div>

    <div class="section">Section Code</div>
    <div class="handle">handle 2</div>

    <div class="section">Section Code</div>
    <div class="handle">handle 3</div>

    <div class="section">Section Code</div>
    <div class="handle">handle 4</div>

    <div class="section">Section Code</div>
    <div class="handle">handle 5</div>
</div> 
```

**ui.js**

```
Accordion = function(container_id, options){
    this.init(container_id, options);
}

$.extend(Accordion.prototype, {
    container_id: '',
    options: {},
    active_tab: 0,    
    animating: false,
    button_position: 'below',
    duration: 250,
    height: 100,

    handle_class: ".handle",
    section_class: ".section",

    init: function(container_id, options){
        var self = this;
        this.container_id = container_id;
        this.button_position = this.get_button_position();

        // The height of each section, use the height specified in the stylesheet if possible
        this.height = $(this.container_id + " " + this.section_class).css("height");

        if(options && options.duration)    this.duration = options.duration;
        if(options && options.active_tab)  this.active_tab = options.active_tab;

        // Set the first section to have a height and be "open"
        // All the rest of the sections should have 0px height
        $(this.container_id).children(this.section_class).eq(this.active_tab)
            .addClass("open")
            .css("height", this.height)
            .siblings(this.section_class)
            .css("height", "0px");

        // figure out the state of the handles
        this.do_handle_logic($(this.container_id).children(this.handle_class).eq(this.active_tab));

        // Set up an event handler to animate each section
        $(this.container_id + " " + this.handle_class).mouseover(function(){

            if(self.animating)
                return;

            self.animate($(this));
        });
    },

    /*
     * Determines whether handles are above or below their associated section
     */     
    get_button_position: function(){
        return ($(this.container_id).children(":first").hasClass(this.handle_class) ? 'above' : 'below');
    },

    /*
     * Animate the accordion from one node to another
     */ 
    animate: function(handle){
        var active_section = (this.button_position == 'below' ? handle.prev() : handle.next());    
        var open_section = handle.siblings().andSelf().filter(".open");

        if(active_section.hasClass("open"))
            return;

        this.animating = true;

        // figure out the state of the handles
        this.do_handle_logic(handle);

        // Close the open section
        open_section
            .syncAnimate(active_section, {"height": "0px"}, {queue:false, duration:this.duration}, '')
            .removeClass("open");

        // Open the new section
        active_section
            .syncAnimate(open_section, {"height": this.height}, {queue:false, duration:this.duration}, '')
            .addClass("open");

        var self = this;
        window.setTimeout(function(){
            self.animating = false;
        }, this.duration);
    },

    /*
     * Update the current class or "state" of each handle
     */ 
    do_handle_logic: function(handle){
        var all_handles = handle.siblings(".handle").andSelf();
        var above_handles = handle.prevAll(this.handle_class);
        var below_handles = handle.nextAll(this.handle_class);

        // Remove all obsolete handles
        all_handles
            .removeClass("handle_on_above")
            .removeClass("handle_on_below")
            .removeClass("handle_off_below")
            .removeClass("handle_off_above");

        // Apply the "on" state to the current handle
        if(this.button_position == 'below'){
            handle
                .addClass("handle_on_below");
        }
        else{
            handle
                .addClass("handle_on_above");
        }

        // Apply the off above/below state to the rest of the handles
        above_handles
            .addClass("handle_off_above");

        below_handles
            .addClass("handle_off_below");
    }
}); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-09-24T17:20:16.847

您不能在具有适当队列和范围的 jquery 中执行并行效果。Scriptaculous 在队列和范围方面做得很好，而另一方面，jQuery 有 .queue 和 .animate ，它们基本上是无用的组合。jQuery 开箱即用的唯一好处是在 dom 上推送一些样式属性，而 Scriptaculous 涵盖了所有可能的效果。

您需要使用 Scriptaculous，而 John Resig 应该重新考虑 jQuery.fx，他应该在使用 scripty2.com 时看看它。

# .net - 如何将单元测试与集成测试分开？

> ID：811755
> 
> 赞同：1
> 
> 时间：2009-05-01T14:58:38.220
> 
> 标签：.net, unit-testing, integration-testing

我是测试和模拟的新手。我正在尝试测试一个执行计算、调用 DAL 并更新数据库以及管理事务的业务逻辑类。我正在使用模拟来进行单元测试，但是完全集成测试如何适应所有这些。我基本上有完全相同的测试，但使用真正的 DAL 还是我做一些完全不同的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T15:02:21.520

差不多。要知道的重要一点是，单元测试（在 TDD 中）与测试无关，而与设计有关。您创建单元测试以将每个单个代码组件的设计决策合并到自动验证系统中；以便系统的每个部分都符合其设计。这样，您可以依赖每个组件而不是依赖其他组件的未指定功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T15:16:35.353

您几乎可以按照自己的想法来思考它。但是，如果您愿意，您可以添加额外的步骤并进行流程测试。在测试中，您有单元测试、CSC 测试和 CSCI 测试。您正在进行单元测试和 CSCI 测试。CSC 测试本质上是一种流程测试，您可以在其中测试流程的功能，然后再将其放入整个应用程序中。例如，您有一个工作应用程序并为该应用程序编写了一个新功能。您首先对代码进行单元测试。如果一切正常，那么您可以独立测试新功能。如果一切正常，那么您将其与应用程序放在一起并一起测试所有内容。

如果它们涵盖了功能，它们都可以是相同的测试。不过，您可能需要在测试中越深入，就需要扩展测试。

# java - 如何保证集合中项目的顺序

> ID：811758
> 
> 赞同：1
> 
> 时间：2009-05-01T14:58:51.950
> 
> 标签：java, jpa, eclipselink

我有一个对象列表，列表中的每个对象都有一个位置，除非明确更改，否则该位置可能不会改变，换句话说，对象在队列中。我应该在我的实体类中使用什么集合来存储这些对象以及该集合应该如何注释？

我目前有这个

```
@Entity
class Foo {
  ...
  @OneToMany(mappedBy = "foo", cascade = CascadeType.ALL)
  List<Bar> bars = new ArrayList<Bar>();
  ...
} 
```

如果纯粹使用 JPA 无法做到这一点，我将使用 EclipseLink 作为我的 JPA 提供程序，因此如果没有其他帮助，EclipseLink 特定的注释就可以了。

编辑：请注意，问题不在于 Java 不会保留订单，我知道大多数集合都会这样做，问题是我不知道 JPA 保留订单的聪明方法。有一个订单 ID 并通过它进行查询订单是可能的，但在我的情况下，维护订单 ID 很费力（因为用户界面允许重新排序项目），我正在寻找一种更智能的方法来做到这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T15:03:57.647

如果您希望在往返 SQL 之后对其进行排序，则应在实体本身内提供某种排序 ID - SQL 自然是面向集合而不是面向列表的。然后，您可以在取回它们后进行排序，或者确保您的查询也指定了排序。

如果你给实体一个自动生成的整数 ID，这*可能会*起作用，但我不想保证。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-01T16:34:11.517

按照 Jon 的建议，使用排序 ID，然后在 @OneToMany 下方添加 @OrderBy 注释。这将按指定字段对任何查询进行排序。

例如，如果您向 Bar 添加一个名为“sortId”的新字段，Foo 将如下所示：

```
@Entity
class Foo {
  ...
  @OneToMany(mappedBy = "foo", cascade = CascadeType.ALL)
  @OrderBy("sortId ASC")
  List bars = new ArrayList();
  ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T15:08:27.277

你可以

1.  在创建之前对列表进行排序
2.  创建后对列表进行排序
3.  使用在插入时执行排序的集合。树图，树集

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T15:09:42.563

链表在java中实现了Queue接口，允许你在中间添加东西...

TBH 大部分系列都是订购的，不是吗...

检查文档，大多数人说它们是否被订购。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T15:14:09.573

值得尝试 LinkedList 而不是 ArrayList，但是，正如 Jon 所说，您需要找到一种持久化订单信息的方法。

如果您需要 List，则在转换为 List 时，解决方案可能涉及向每个条目发出订单号并将其存储为 SortedMap。

但是，如果您将集合存储为 LinkedList，ORM 可能足够聪明，可以为您完成所有转换。

# c# - 如何链接不同的表格？

> ID：811762
> 
> 赞同：2
> 
> 时间：2009-05-01T15:00:07.563
> 
> 标签：c#, winforms, show, showdialog

我在第一个问题中得到了很大的帮助，希望有人会告诉我或将我推荐给有关此主题的较早问题。

**我想链接不同的表单，例如单击第一个按钮并打开**第二个表单。基本上，我将为手机功能（例如 SMS、CALL 等）制作一个菜单，所以如果我单击呼叫新表格打开，要求拨打电话等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T15:04:21.093

```
var otherForm = new Form2();
otherForm.ShowDialog(); // To show a modal dialog, or...
otherForm.Show();  // To show it as a non-modal window 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T15:06:20.683

```
void SomeInitializationFunction() {
      button.Click += new System.EventHandler(buttonClick);
}

private void buttonClick(object sender, System.EventArgs e)
{
    using(GetNumberForm getNumberForm = new GetNumberForm())
    {
        if(DialogResult.OK == getNumberForm.ShowDialog())
        {
            string phoneNumber = getNumberForm.PhoneNumber;
            // do something with the user input.
        }
    }
} 
```

# .net - HTTP 400：在 URL 中检测到无效字符。IIS解码URL太早？这里发生了什么？

> ID：811763
> 
> 赞同：5
> 
> 时间：2009-05-01T15:00:07.563
> 
> 标签：.net, http, url, iis-7

所以我有这个网址： [http ://test.com/afolder/who-else-wants-to-make-horror-movies%3f/](http://test.com/afolder/who-else-wants-to-make-horror-movies%3f/)

这是 URL 编码版本： [http ://test.com/afolder/who-else-wants-to-make-horror-movies?/](http://test.com/afolder/who-else-wants-to-make-horror-movies?/)

但是 IIS7 抛出 400：

> HTTP 错误 400.0 - 错误请求 ASP.NET 在 URL 中检测到无效字符。

但是，如果我正确编码了 URL，为什么会这样做呢？

我对其他 URL 编码的字符也有同样的问题，比如 '/' 这是 '%2f' 但是当 .net 解析处理程序时，它会在解码 URL 之后这样做，然后更改有效路径 grrrr。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-01T17:22:01.510

看起来 x64 上的 IIS7 存在一些问题....不确定这是否是您的问题：

[http://blogs.iis.net/rakkimk/archive/2008/10/10/asp-net-2-0-x64-you-may-get-http-400-bad-request-or-error-as-提到-kb-932552-或-826437.aspx](http://blogs.iis.net/rakkimk/archive/2008/10/10/asp-net-2-0-x64-you-may-get-http-400-bad-request-or-error-as-mentioned-in-kb-932552-or-826437.aspx)

# matlab - 需要视频处理工具

> ID：811775
> 
> 赞同：-1
> 
> 时间：2009-05-01T15:02:24.593
> 
> 标签：matlab, video, editing

我有一个 2giga mpeg 文件，里面有跑步、慢跑、走路等的人。我将在图像分类项目中使用它，但我需要根据每个人的每个动作来分割视频。

例如; 视频中有 25 个人按顺序重复这些动作

第一人 - 跑 - 走

第二人称

-跑步 -步行

并继续......

我想要的是为每个人提供 2 个不同的 mpeg 文件，例如；firstperson_runs.mpeg firstperson_waves.mpeg

所以我需要一个工具来将大文件拆分成这些文件。分道扬镳是时候了。

如; 选择 t1：动作开始 选择 t2：动作结束 从大文件中为间隔 t1 和 t2 创建一个新视频

当然我会为每个视频选择时间间隔。

操作系统：Winxp专业版

如果matlab能做到，能描述一下吗？有什么帮助吗？？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T15:12:37.343

我想有很多工具可以在没有 MATLAB 的情况下执行此操作，但如果您*真的*想使用 MATLAB，我会在 MathWorks File Exchange 上查看这些提交：

*   [Gerald Dalley 的用于 Matlab 的 videoIO 工具箱](http://www.mathworks.com/matlabcentral/fileexchange/15224)
*   [Micah Richert 的 mmread](http://www.mathworks.com/matlabcentral/fileexchange/8028)
*   David Foti 的[mpgread](http://www.mathworks.com/matlabcentral/fileexchange/308)和[mpgwrite](http://www.mathworks.com/matlabcentral/fileexchange/309)

**编辑：**

正如[M456](https://stackoverflow.com/questions/811775/need-for-tool-for-video-processing/815595#815595)所提到的，您还可以使用内置函数[MMREADER](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/mmreader.html)为您的电影文件创建一个多媒体阅读器对象（然后使用[READ](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/read.html)方法从中读取选定的电影帧）。但是，我不知道这个函数是在哪个版本的 MATLAB 中引入的。它在 7.7 和 7.8 版本中（分别为 R2008b 和 R2009a），但在 7.1 版本中没有。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-02T20:55:31.287

Matlab can do such video split operations. There are two built in functions (*aviread* and *mmreader*) for reading video files. Both will create objects which contain the individual frames of the video. You can save these as separate frames or make a new video out of by using *avifile*.

# javascript - ASP.NET Post-Back 和 window.onload

> ID：811777
> 
> 赞同：0
> 
> 时间：2009-05-01T15:02:55.700
> 
> 标签：javascript

我有一个函数可以检查某些输入字段是否已更改：

```
var somethingchanged = false;
$(".container-box fieldset input").change(function() {
   somethingchanged = true;
}); 
```

还有一个等待`window.onload`并触发它的函数：

```
window.onbeforeunload = function(e) {
    if (somethingchanged) {
        var message = "Fields have been edited without saving - continue?";
        if (typeof e == "undefined") {
            e = window.event;
        }
        if (e) { 
             e.returnValue = message;
        }
        return message;
    }
} 
```

但是如果我编辑一些字段并点击保存按钮，事件就会触发，因为有一个回发并且字段已经被编辑。无论如何，这个事件不会在单击保存按钮时触发？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T15:06:47.610

当我执行此模式时，页面上有一个 showDirtyPrompt。然后，每当发生我不想通过脏检查的操作时，我只需将变量设置为 false。您可以在按钮的客户端单击事件中执行此操作。

这样做的好处是可能存在您不想提示的其他情况，例如，您可能有其他按钮来执行其他回发的用户。这样，您的脏检查功能就不必检查几个按钮，您可以翻转责任。

```
<input type="button" onclick="javascript:showDirtyPrompt=false;".../>

function unloadHandler()
{
   if (showDirtyPrompt)
   { 
    //have your regular logic run here
   }
   showDirtyPrompt=true;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T15:04:41.060

是的。检查单击的按钮是否不是保存按钮。所以它可能是这样的

```
if ($this.id.not("savebuttonID")) {
    trigger stuff
} 
```

# c++ - c++优化

> ID：811794
> 
> 赞同：4
> 
> 时间：2009-05-01T15:06:37.327
> 
> 标签：c++, optimization, performance

我正在处理一些现有的 c++ 代码，这些代码似乎写得不好，而且经常被调用。我想知道是否应该花时间更改它，或者编译器是否已经在优化问题。

我正在使用 Visual Studio 2008。

这是一个例子：

```
void someDrawingFunction(....)
{
  GetContext().DrawSomething(...);
  GetContext().DrawSomething(...);
  GetContext().DrawSomething(...);
  .
  .
  .
} 
```

这是我的做法：

```
void someDrawingFunction(....)
{
  MyContext &c = GetContext();
  c.DrawSomething(...);
  c.DrawSomething(...);
  c.DrawSomething(...);
  .
  .
  .
} 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-01T15:11:34.697

不要猜测你的程序在哪里花费时间。 **首先**分析以找到您的瓶颈，然后优化这些。

至于`GetContext()`，这取决于它的复杂程度。如果它只是返回一个类成员变量，那么编译器很可能会内联它。如果`GetContext()`必须执行更复杂的操作（例如在表中查找上下文），编译器可能不会内联它，并且您可能希望只调用它一次，就像在您的第二个片段中一样。

如果您使用的是 GCC，您还可以使用[属性](http://gcc.gnu.org/onlinedocs/gcc/Function-Attributes.html#index-g_t_0040code_007bpure_007d-function-attribute-2256)`GetContext()`标记函数。这将允许它执行更多优化，例如[公共子表达式消除](http://en.wikipedia.org/wiki/Common_subexpression_elimination)。[`pure`](http://gcc.gnu.org/onlinedocs/gcc/Function-Attributes.html#index-g_t_0040code_007bpure_007d-function-attribute-2256)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-01T15:09:51.750

如果您确定这是性能问题，请更改它。如果 GetContext 是一个函数调用（与宏或内联函数相反），那么编译器将不得不每次都调用它，因为编译器不一定能看到它在做什么，因此，编译器可能会赢不知道它可以消除呼叫。

当然，您需要确保 GetContext 始终返回相同的内容，并且这种“优化”是安全的。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-01T15:42:29.193

如果第二种方式在逻辑上是正确的，即多次调用 GetContext() 不会影响您的程序逻辑，即使您对其进行分析并证明也没有性能差异，我也会采用第二种方式这样，下一个查看此代码的开发人员就不会再问同样的问题了。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-01T15:12:17.173

显然，如果 GetContext() 具有副作用（I/O、更新全局变量等），那么建议的优化将产生不同的结果。

所以除非编译器能以某种方式检测到 GetContext() 是纯的，否则你应该自己优化它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T16:50:40.993

如果您想知道编译器做了什么，请查看汇编代码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-04T16:53:09.090

这是一个如此简单的改变，我会去做。
解决它比辩论它更快。

但你真的有问题吗？
仅仅因为它经常被调用并不意味着它被太频繁地调用。
如果它看起来质量上是小猪，请[对其进行采样](https://stackoverflow.com/questions/375913/what-can-i-use-to-profile-c-code-in-linux/378024#378024)以查看其花费的时间。
很有可能这*不是*您所猜到的。

# asp.net - 对 UNC 共享 DB 文件的 ASP.NET 应用程序访问可用作 IIS 虚拟目录，但不能用作 IIS 网站

> ID：811798
> 
> 赞同：0
> 
> 时间：2009-05-01T15:07:21.413
> 
> 标签：asp.net, iis-6, integrated-security

这个要死我了。我有一个使用集成安全性的 ASP.net (2.0 Framework) 应用程序。IIS 已正确设置，并且可以作为默认网站之外的虚拟目录正常工作。我的 OLEDB 连接 (Jet 4.0) 工作正常，并通过网络共享 (\GIS1\GIS Server - PublicWorks_StreetSigns) 连接到数据库文件。

但是，当我创建一个 IIS“网站”并将其指向完全相同的主目录时，我得到一个错误......

从 DBF 获取数据时出错。'\GIS1\GIS Server - PublicWorks_StreetSigns' 不是有效路径。

我是否必须在网站上做一些不同于默认网站的虚拟操作才能完成这项工作？我已经根据网站设置对虚拟设置进行了三次检查，一切都是一样的。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-01T16:03:44.057

我会检查为每个网站提供服务的应用程序池的身份。我的猜测是应用程序池的默认身份没有对该路径的权限。

# eclipse-rcp - asyncExec 事件何时开始？

> ID：811799
> 
> 赞同：0
> 
> 时间：2009-05-01T15:07:52.287
> 
> 标签：eclipse-rcp

我正在尝试创建一个用于开发插件的基本应用程序。我不需要工作台。

在 title1 对话框下方会显示，但 title2 不会。

需要做什么才能显示第二个？

```
public class BareBonesApp extends AbstractApplication
{
    public Object start(IApplicationContext context) throws Exception
    {
        Display display = PlatformUI.createDisplay();

        MessageDialog.openWarning(null, "title1", "message1");

        display.asyncExec(new Runnable()
        {
            public void run()
            {
                MessageDialog.openWarning(null, "title2", "message2");
            }
        });

        return null;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-29T09:40:58.057

Display 对应该运行同步、异步或在特定时间 (Display.timerExec) 的可运行程序有不同的队列。当 Display.readAndDispatch 已调度所有事件时，首先执行同步队列中的可运行对象，然后清空异步队列，然后执行到期的 timerExec 可运行对象。

Display.syncExec 和 Display.asyncExec 之间的唯一区别是 syncExec 方法等待 Display 线程执行 runnable。Display.asyncExec 只是将可运行对象排队并继续。

因此，如果“title2”从未出现，我认为您的应用程序没有运行显示循环：

```
Display display = new Display(); // this thread should be the only one that creates a display instance
while (someCondition) {
  if (!display.readAndDispatch())
    display.sleep();
} 
```

# asmx - 何时使用页面方法与创建 Web 服务？

> ID：811809
> 
> 赞同：5
> 
> 时间：2009-05-01T15:10:26.600
> 
> 标签：asmx, pagemethods

我们的团队正在尝试找出一些使用 pagemethods 与创建实际 asmx Web 服务的指南。在我看来，pagemethods 主要用于特定于页面的一次性类型调用，其中 asmx 旨在表示更多可重用的操作和服务集。这听起来正确吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T16:33:34.297

是的。如果您打算让多个应用程序使用某些东西，那么将其创建为单独的服务是明智的，这样您就不会在应用程序之间重复代码，并且如果必须在一个地方进行更改，您也必须进行更改。

简单的例子，假设你有一个身份验证需求，并且你有 2 个应用程序、一个 Web 和一个窗口。如果用户群是相同的，那么在 Web 应用程序中创建一个身份验证代码/页面，转到你的 windows 应用程序，然后重新做同样的事情是没有意义的。原因是，如果要改hash码怎么办，比如你得去web改，然后去windows改，还要重新部署window，现在有服务就去服务更改它，现在一切都适用于新模型，还有一个很大的优点，您不必重新部署 Windows 应用程序。

这就是所有的人...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T16:39:06.530

即使您只在一个页面上工作并且所讨论的功能只在该页面上使用，有时最好将功能移动到单独的 Web 服务以提高性能。我最近在一个页面上工作，该页面将对单个页面方法进行数百次调用。当我将其移至 Web 服务时，我注意到性能有了巨大的提高，这仅仅是因为您没有处理页面的整个生命周期。但是，如果您正在做一些小事情，请使用页面方法来保持一切简单。

**更新**： ArmedMonkey 是正确的，页面方法不会经历页面生命周期。

# text-to-speech - System.Speech.Synthesis 和 TTSEngine 的西班牙语语音

> ID：811816
> 
> 赞同：1
> 
> 时间：2009-05-01T15:12:00.000
> 
> 标签：text-to-speech, speech-synthesis

我已经成功地让 System.Speech.Synthesis 以任意声音 Anna 和 Sam 阅读英文文本。我的下一个任务是本地化我的应用程序，以便正确地向我们的说西班牙语的客户阅读西班牙语文本。

但是，我不认为我在问正确的问题，因为我在文档、论坛、小组或技术文章中找不到任何关于如何做到这一点的明确解释。

第一：我说 SpeechSynthesizer 类或任何其他 Text-To-Speech 对象上没有设置是否正确？换句话说，是否只需要安装正确的声音，以西班牙“口音”阅读？

第二：如何做到这一点？我已经看到我尝试安装的西班牙语库的链接，但我永远无法在我的 Windows XP 语音控制面板或我的应用程序的 GetInstalledVoices() 调用中看到这些新声音。

我正在使用 .Net 3.5 SP 1 和一个 Windows XP SP3，而我的代码正在使用 Visual Studio 2..8。

如果我缺少详细信息，请告诉我。

我将不胜感激任何帮助。五

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T15:24:57.097

以前做过这个。。

您需要做的第一件事是获得西班牙语“语音字体”..

见[http://www.naturalvoices.att.com/](http://www.naturalvoices.att.com/)

您需要做的下一件事是将您的文本从英语翻译成西班牙语。

然后，您使用西班牙语语音字体将您的西班牙语翻译传递到 TTS 引擎。

```
Speaker.SelectVoice("<voiceName>"); 
```

# database - 使用 VB .NET 从 1 个数据库中使用 Select 语句插入另一个数据库

> ID：811825
> 
> 赞同：0
> 
> 时间：2009-05-01T15:14:32.783
> 
> 标签：database, vb.net, select, insert

我目前正在编写一个 VB .NET 应用程序，我试图在其中打开 1 个数据库，创建一个 select 语句，然后使用 Microsoft Access 数据库 2003 将结果发布到另一个数据库文件中。

代码似乎在语句处停止执行`cmdJetDB.ExecuteNonQuery()`

我正在使用以下代码：

```
Dim conn1 As OleDbConnection = New OleDbConnection("Provider=Microsoft.Jet.OLEDB.4.0; Data source=C:\Sample.mdb")

Dim conn2 As OleDbConnection = New OleDbConnection("Provider=Microsoft.Jet.OLEDB.4.0; Data source=C:\db2.mdb")
conn1.Open()
conn2.Open()
Dim mySelectQuery As String 
mySelectQuery = "SELECT Sample.LANE_ADDR, Sample.LANE_DT, Sample.LANE_TM, Sample.LANE_SPEED FROM (Sample) WHERE ((Sample.LANE_ADDR) = '164.909' OR (Sample.LANE_ADDR) = '164.909' AND Sample.LANE_DT BETWEEN #4/4/2003# AND #4/5/2003#)"
Dim cmdJetDB As New OleDbCommand(mySelectQuery, conn1)
cmdJetDB.ExecuteNonQuery()

Dim cmdInsert As String
cmdInsert = "Insert INTO Table1 (Sample.LANE_ADDR, Sample.LANE_TM,Sample.LANE_SPEED) VALUES ('164.909', '00:12:30' , '30' )"
Dim cmdJetDB2 As New OleDbCommand(cmdInsert, conn2)
cmdJetDB2.ExecuteNonQuery()

conn2.Close()
conn1.Close() 
```

问：我没有做什么。我打开了两个连接，陈述了我的两个 SQL 语句，但它仍然无法正常工作。我真的需要让这个应用程序正常工作。请帮忙.........

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T15:18:01.903

`ExecuteNonQuery`不能用于`SELECT`从数据库中填充内容。您应该`ExecuteReader`在循环中使用并使用结果来**设置语句的参数**，`INSERT`然后`ExecuteNonQuery`在该循​​环中运行。从您编写的代码中，您希望这些值应该如何填充到`INSERT`语句中？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T16:27:04.030

这里有一个建议，

如果您要检索的列与您要插入的列具有相同的类型（基本上您没有进行任何转换和/或转换），请执行一个执行此操作的查询。

```
INSERT INTO TestTable2
SELECT * FROM TestTable1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T15:18:34.617

1.  您`SELECT`用于尝试返回行，但随后调用`ExecuteNonQuery()`，它不返回任何内容。你会想`ExecuteReader()`改用。
2.  稍后您可能会遇到另一个错误，因为您正在`INSERT`进入“Table1”但试图引用“Sample”中的字段。

也与错误无关，但您没有对语句中的数据执行任何操作以在`SELECT`语句中使用它`INSERT`。

# java - 我应该把 JUnit 测试放在哪里？

> ID：811827
> 
> 赞同：53
> 
> 时间：2009-05-01T15:15:49.037
> 
> 标签：java, unit-testing, junit

我有 2 个关于组织单元测试的问题。

1.  我是否必须将测试放在与测试类相同的包中，还是可以在不同的包中组织测试？

    例如，如果我有**有效性**和**其他**测试，将它们分成不同的包是否正确，即使它们属于同一类？

2.  模拟类和存根类呢？我应该将它们与仅包含测试的包分开，还是将它们放在一起？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-05-01T15:20:46.483

我们执行 JUnit 测试用例的方式是将它们放在同一个包中，但放在不同的根目录中。由于我们使用 Maven，因此我们只使用标准位置，使结构类似于以下内容。

```
src/main/java/com/foo/Bar.java
src/test/java/com/foo/BarTest.java 
```

显然，结构还有更多内容，但这让我们可以将测试与主线代码分开构建，但仍然可以访问受保护的类等。对于不同类型的测试，这是非常主观的。当我们开始我们的测试工作（不幸的是在开发之后开始）时，我试图让事情变得相当孤立。不幸的是，当我们达到 500 多个测试用例点时，它很快就变成了一场噩梦。从那以后，我试图做更多的整合。这导致需要维护的代码量减少。不过，正如我所说，这是非常主观的。

至于仅测试代码，我们将其保存在一个单独的`com.foo.test`包中，该包仅驻留在`src/test/java`树中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-02T16:13:29.853

我也倾向于将我的测试放在同一个包中，但在不同的根目录下。这允许我在测试包中的其他内容时测试包私有类或访问打包私有类。它们保存在单独的目录树中，以允许将它们从部署结果中排除（特别是要确保测试代码不会意外进入生产代码）。然而，最重要的是适合你的情况。

就每个生产类有多少测试类而言，我所看到的理论是你为每个夹具编写一个测试类，即每个设置结构。在许多情况下，每个生产类与一个测试类相同（或足够接近），但我有时会为一个给定的生产类编写更多测试类（特别是相等测试往往是分开的），偶尔会写一个测试类对于一组（相关）生产类（例如，用于测试策略模式）。

大多数情况下，我不太担心理论，但会根据需要重新进行测试，以将重复降至最低。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-01T15:46:29.370

保持相同的包允许您对仅通过测试访问的代码使用包私有可见性。

关于使用单独的根目录，这是一个很好的做法。它对我们来说也有一个优势，因为我们使用 IDEA，IDEA 认识到生产代码不能引用测试代码。

就保持它们分开而言，在单元级别为每个生产类拥有一个且只有一个测试类具有很大的威力。当然，作为重构的一部分，在生产中创建了一些根本没有测试类的类，这很好，但是当您想知道什么测试测试某个类时，有一个约定说 ClassNameTest 是 ClassName 的测试很有帮助。

不过，TestNG 对这种范式比 JUnit 友好得多。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-01T15:19:58.637

测试类应该在不同的包中，当你打包发布时，更容易将它们与生产代码分开。我通常在这些包中保留很多测试绒毛，各种模拟，配置，场景......但是当你构建时 - 它没有得到它。在某些情况下，即使在不同的项目中也保留测试内容是个好主意。依靠。

# xml - 如何在 XML Schema 中使元素成为其自身的子元素？

> ID：811833
> 
> 赞同：6
> 
> 时间：2009-05-01T15:17:50.063
> 
> 标签：xml, schema, nested

我希望能够拥有同一父元素的任意级别的嵌套子元素，例如：

```
<path expr="/">
  <path expr="usr">
    <path expr="bin">
      <path expr="X11" />
    </path>
  </path>
  <path expr="var" />
</path> 
```

我正在编写 XML Schema 文件，我不知道如何在模式中表示这种父/子关系：这就是我所拥有的，但这不是有效的模式定义：

```
 <xs:element name="path">
            <xs:complexType>
              <xs:sequence>
                <xs:element ref="path" minOccurs="0" />
              </xs:sequence>
              <xs:attribute name="expr" type="xs:string" use="required" />
            </xs:complexType>
          </xs:element> 
```

更新：感谢您的回复。我试过了，我收到以下错误：此上下文不支持“w3.org/2001/XMLSchema:complexType”元素。我应该提到，我所描述的路径层次结构本身就是一个名为 application 的元素的子元素，因此整个结构类似于：

```
<application name="test">
  <path expr="/">
    <path expr="usr">
      <path expr="bin">
        <path expr="X11" />
      </path>
    </path>
    <path expr="var" />
  </path>
</application> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-01T15:29:34.417

以下应该可以解决问题。XSD 标准很难直接使用，我总是使用像[Liquid XML Studio](http://www.liquid-technologies.com/XmlStudio/Free-Xsd-Editor.aspx)这样的编辑器。

```
<?xml version="1.0" encoding="utf-8" ?>
<!--Created with Liquid XML Studio - Developer Pro Edition 7.1.1.1206 (http://www.liquid-technologies.com)-->
<xs:schema elementFormDefault="qualified" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="Path" type="PathType" />
  <xs:complexType name="PathType">
    <xs:sequence>
      <xs:element minOccurs="0" maxOccurs="unbounded" name="Path" type="PathType" />
    </xs:sequence>
    <xs:attribute name="expr" type="xs:string" use="required" />
  </xs:complexType>
</xs:schema> 
```

[![替代文字](https://i.stack.imgur.com/4Jh5K.png)](https://i.stack.imgur.com/4Jh5K.png)
[（来源：[liquid-technologies.com](http://www.liquid-technologies.com/images/blogs/stackoverflow/PathExample.png)）]

XSD 有效。对于您描述的新 XML，您需要将其更改为如下所示。

```
<?xml version="1.0" encoding="utf-8" ?>
<!--Created with Liquid XML Studio - Developer Pro Edition 7.1.0.1135 (http://www.liquid-technologies.com)-->
<xs:schema elementFormDefault="qualified" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="Application">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="path" type="PathType" />
      </xs:sequence>
      <xs:attribute name="name" type="xs:string" />
    </xs:complexType>
  </xs:element>
  <xs:complexType name="PathType">
    <xs:sequence>
      <xs:element minOccurs="0" maxOccurs="unbounded" name="path" type="PathType" />
    </xs:sequence>
    <xs:attribute name="expr" type="xs:string" use="required" />
  </xs:complexType>
</xs:schema> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T16:02:06.430

就我个人而言，我更喜欢[RelaxNG](http://en.wikipedia.org/wiki/RelaxNG)而不是 XML Schema。可能值得您花时间尝试一下。

# java - PHP 中是否有与 Java 的 DisplayTag 等效的库？

> ID：811844
> 
> 赞同：1
> 
> 时间：2009-05-01T15:20:05.220
> 
> 标签：java, php, csv

在 Java/JSP 领域很长一段时间以来，我一直使用[Display Tag](http://displaytag.sourceforge.net/1.2/)库来生成一个表格，该表格允许您对表格进行排序，并将表格导出为 CSV 文件。

我可以使用的 PHP 库中有这样的东西吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-07T00:06:53.100

根据我的搜索，答案似乎是否定的。我也想要一个——爱显示标签。

如果您想要一个仅 php 的解决方案，[Structures_DataGrid](http://pear.php.net/package/Structures_DataGrid)似乎是最好的解决方案。这是[一篇关于它](http://devzone.zend.com/article/3019)的文章。这处理分页和排序，但不处理导出。也不确定它的支持程度。

另一个答案似乎是使用 javascript 进行分页和排序，并推出您自己的 php 导出功能。

Web 的状态与创建 displaytag 时的状态有很大不同（即，AJAX 支持丰富的工具集），所以我不确定是否会完全替代。当您可以在客户端上进行排序和分页时，为什么要通过调用服务器来进行排序和分页？

这是一个支持分页和排序的[jquery 插件](http://tablesorter.com/docs/example-pager.html)，还有[另一个](http://code.google.com/p/jq-ingrid/)——你需要做的就是让你的 php 正确生成表格。

至于 CSV 导出，那里有大量的片段。这是我[觉得不错的一个](http://snipplr.com/view/2234/export-mysql-query-results-to-csv/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T16:51:06.530

据我所知，PHP 不能动态更改页面（用于对表格进行排序等）。您可能需要使用 javascript 之类的东西。我知道 jquery 有一个表排序库。

PHP 可以做 CSV 输出。链接到查询数据库并使用 header() 函数输出 csv 文件的页面 -[像这样](http://snipplr.com/view/2234/export-mysql-query-results-to-csv/)。Stackoverflow 也有几个 [类似的解决方案](https://stackoverflow.com/questions/125113/php-code-to-convert-a-mysql-query-to-csv)。

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T16:57:37.763

我认为有一种方法可以在 PHP 中处理 CSV。它是 fputcsv()。它不会对表格或类似的东西进行排序，它只是将数组转换为一行 csv。

这是 PHP 网站上的链接：http: [//us.php.net/manual/en/function.fputcsv.php](http://us.php.net/manual/en/function.fputcsv.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T17:12:07.900

您可以尝试使用像 -- [http://www.aaronharp.com/2008/08/30/php-scaffold-class/](http://www.aaronharp.com/2008/08/30/php-scaffold-class/)或 -- cakephp 这样的脚手架。我不认为有一个包含的功能可以做到这一点。

# java - 设置由数据库生成的 JPA 时间戳列？

> ID：811845
> 
> 赞同：78
> 
> 时间：2009-05-01T15:20:06.577
> 
> 标签：java, jpa, persistence, annotations, timestamp

`DATETIME`在我的 SQL Server 2000 数据库中，我有一个类型为`lastTouched`设置`getdate()`为默认值/绑定的时间戳（在函数中而不是数据类型中）列。

我正在使用 Netbeans 6.5 生成的 JPA 实体类，并在我的代码中有这个

```
@Basic(optional = false)
@Column(name = "LastTouched")
@Temporal(TemporalType.TIMESTAMP)
private Date lastTouched; 
```

但是，当我尝试将对象放入我得到的数据库时，

```
javax.persistence.PersistenceException: org.hibernate.PropertyValueException: not-null property references a null or transient value: com.generic.Stuff.lastTouched 
```

我尝试将 to 设置`@Basic`为`(optional = true)`，但这会引发异常，指出数据库不允许列`null`的值`TIMESTAMP`，这是设计上不允许的。

```
ERROR JDBCExceptionReporter - Cannot insert the value NULL into column 'LastTouched', table 'DatabaseName.dbo.Stuff'; column does not allow nulls. INSERT fails. 
```

我以前让它在纯 Hibernate 中工作，但我已经切换到 JPA 并且不知道如何告诉它这个列应该在数据库端生成。请注意，我仍然使用 Hibernate 作为我的 JPA 持久层。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-05-01T18:57:02.813

我通过将代码更改为

```
@Basic(optional = false)
@Column(name = "LastTouched", insertable = false, updatable = false)
@Temporal(TemporalType.TIMESTAMP)
private Date lastTouched; 
```

因此在生成 SQL 插入时会忽略时间戳列。不确定这是否是解决此问题的最佳方法。欢迎反馈。

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2010-06-24T06:20:15.483

我意识到这有点晚了，但我已经成功地用注释时间戳列

```
@Column(name="timestamp", columnDefinition="TIMESTAMP DEFAULT CURRENT_TIMESTAMP") 
```

这也应该与`CURRENT_DATE`and一起使用`CURRENT_TIME`。我将 JPA/Hibernate 与 Oracle 一起使用，所以是 YMMV。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2017-12-29T09:27:50.570

```
@Column(nullable = false, updatable = false)
@CreationTimestamp
private Date created_at; 
```

这对我有用。 [更多信息](https://www.thoughts-on-java.org/persist-creation-update-timestamps-hibernate/)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2020-01-06T10:31:58.310

添加`@CreationTimestamp`注释：

```
@CreationTimestamp
@Column(name="timestamp", nullable = false, updatable = false, insertable = false)
private Timestamp timestamp; 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-04-28T03:22:26.023

对于我只关心最后一次修改行的情况，我使用 JPA2.0 和 MySQL 5.5.10 可以很好地工作。MySQL 将在第一次插入时创建一个时间戳，并且每次在该行上调用 UPDATE。（注意：如果我关心 UPDATE 是否确实进行了更改，这将是有问题的）。

此示例中的“时间戳”列就像“最后一次触摸”列.x`

下面的代码使用单独的列“版本”进行乐观锁定。

```
private long version;
private Date timeStamp

@Version
public long getVersion() {
    return version;
}

public void setVersion(long version) {
    this.version = version;
}

// columnDefinition could simply be = "TIMESTAMP", as the other settings are the MySQL default
@Column(name="timeStamp", columnDefinition="TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP")
@Temporal(TemporalType.TIMESTAMP)
public Date getTimeStamp() {
    return timeStamp;
}

public void setTimeStamp(Date timeStamp) {
    this.timeStamp = timeStamp;
} 
```

（注意：@Version 不适用于 MySQL“DATETIME”列，其中 Entity 类中的属性类型为“Date”。这是因为 Date 生成的值精确到毫秒，但是 MySQL 没有存储毫秒，所以当它对数据库中的内容和“附加”实体进行比较时，它认为它们有不同的版本号）

[从 MySQL 手册中关于 TIMESTAMP](http://dev.mysql.com/doc/refman/5.5/en/timestamp.html)：

```
With neither DEFAULT nor ON UPDATE clauses, it is the same as DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP. 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-02-15T19:49:37.033

我不认为每个数据库都有自动更新时间戳（例如 Postgres）。所以我决定在我的代码中的任何地方手动更新这个字段。这将适用于每个数据库：

```
thingy.setLastTouched(new Date());
HibernateUtil.save(thingy); 
```

使用触发器是有原因的，但对于大多数项目来说，这不是其中之一。触发器可以让您更深入地了解特定的数据库实现。

**MySQL 5.6** .28 (Ubuntu 15.10, OpenJDK 64-Bit 1.8.0_66) 似乎非常宽容，不需要任何超越

```
@Column(name="LastTouched") 
```

**MySQL 5.7** .9 (CentOS 6, OpenJDK 64-Bit 1.8.0_72) 仅适用于

```
@Column(name="LastTouched", insertable=false, updatable=false) 
```

不是：

```
FAILED: removing @Temporal
FAILED: @Column(name="LastTouched", nullable=true)
FAILED: @Column(name="LastTouched", columnDefinition="TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP") 
```

我的其他系统信息（在两个环境中都相同）

*   休眠实体管理器 5.0.2
*   休眠验证器 5.2.2
*   mysql-connector-java 5.1.38

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2020-01-10T15:36:12.947

如果你用`@DynamicInsert`例如标记你的实体

```
@Entity
@DynamicInsert
@Table(name = "TABLE_NAME")
public class ClassName implements Serializable  { 
```

Hibernate 将生成没有`null`值的 SQL。然后数据库将插入自己的默认值。这确实会影响性能，请参阅 [Dynamic Insert][1]。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2020-03-09T17:47:48.760

我将这个发布给人们在使用 MySQL 和 Java Spring Boot JPA 时寻找答案，就像@immanuelRocha 说的那样，在 Spring 中只有 @CreationTimeStamp 到 @Column，并且在 MySQL 中将默认值设置为“CURRENT_TIMESTAMP”。

在 Spring 中只添加以下行：

```
@Column(name = "insert_date")
@CreationTimestamp
private Timestamp insert_date;
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2020-08-25T09:47:14.953

如果您在**Java 8 和 Hibernate 5 或 Spring Boot JPA**中进行开发，那么直接在您的 Entity 类中使​​用以下**注解。**Hibernate 从 VM 获取当前时间戳，并将日期和时间插入数据库。

```
public class YourEntity {

    @Id
    @GeneratedValue
    private Long id;

    private String name;

    @CreationTimestamp
    private LocalDateTime createdDateTime;

    @UpdateTimestamp
    private LocalDateTime updatedDateTime;

    …
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2020-01-31T06:02:46.110

这也适用于我： -

```
@Temporal(TemporalType.TIMESTAMP)   
@Column(name = "CREATE_DATE_TIME", nullable = false, updatable = false, insertable = false, columnDefinition = "TIMESTAMP DEFAULT CURRENT_TIMESTAMP")
public Date getCreateDateTime() {
    return createDateTime;
}

public void setCreateDateTime(Date createDateTime) {
    this.createDateTime = createDateTime;
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-06-17T10:36:28.507

```
@Column(name = "LastTouched", insertable = false, updatable = false, columnDefinition = "TIMESTAMP default getdate()")
@Temporal(TemporalType.TIMESTAMP)
private Date LastTouched;`enter code here` 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2019-09-16T07:10:31.793

这对我有用：

```
@Column(name = "transactionCreatedDate", nullable = false, updatable = false, insertable = false, columnDefinition = "TIMESTAMP DEFAULT CURRENT_TIMESTAMP") 
```

# asp.net - 会员从 ID 切换到电子邮件

> ID：811847
> 
> 赞同：2
> 
> 时间：2009-05-01T15:20:52.847
> 
> 标签：asp.net, email, login, asp.net-membership, membership

目前我有一个使用唯一 ID 登录的站点（asp.net 3.5）。如果可能，我将需要将其切换为使用电子邮件。我将创建所有新帐户，这样我就可以清除会员表并导入所有用户信息。

我们正在从部门的通用登录切换到个人帐户。

任何正确方向的链接或指针将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T16:10:25.427

所以这是你应该做的。如果您正在创建一个完整的用户群，只需清除当前用户群并告诉用户使用电子邮件创建新用户，只要您在输入表单上验证您将是好的。现在如果你已经有一个用户群，那就有点复杂了。首先验证每个当前用户都有一个有效的不同电子邮件，然后您必须更改 aspnet_Users 表上的 2 列，这些列是 UserName 和 LoweredUserName。如果第一步正确，那应该很简单，只需为每个 aspnetMembership 行执行一个循环，获取列 Email 并设置为 UserName，然后将列 LoweredEmail 设置为 LoweredUserName。

呸呸呸呸！

现在您已将其全部迁移到新模型，对于新条目，请确保输入表单将 UserName 验证为电子邮件，因为您可以使用 RegEx。

# asp.net - AS3 从 aspx 页面检索 xml

> ID：811850
> 
> 赞同：1
> 
> 时间：2009-05-01T15:22:14.687
> 
> 标签：asp.net, xml, actionscript-3

我是训练轮上的 AS3 菜鸟...

我有一个 XML Loader 类，它正在使用 test.xml 文件做它应该做的事情，但是我需要闪存来读取由 aspx 文件写入的 xml。

所以我尝试了：

```
var urlRequest:URLRequest = new URLRequest("../xml/CaseStudyFlashAssets.aspx"); 
```

我收到错误 #1090（我收集是因为 aspx 不是 xml 并且它不喜欢它）

谁能帮我找到由aspx文件编写的xml？

谢谢

米奇

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T15:50:07.893

从 WebForm 提供 xml 的一个常见问题是在实际 xml 之前出现换行符。当我在 .Net 中生成 xml 时，我通常使用通用处理程序而不是 WebForm。这样，您可以更好地控制输出。当我必须使用 WebForm 时（在某些情况下使用 CMS 时，让数据返回的最简单方法是扩展一个继承 Page 的基类），我在后面的代码中完成所有工作：

```
XmlDocument doc = new XmlDocument();
//build the document
Response.Clear();
Response.ContentType = "text/xml";
Response.Write(doc.OuterXml);
Response.Flush();
Response.End(); 
```

这样， .aspx 文件中的所有垃圾都将从响应中删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T15:25:47.797

您的 ASPX 页面中的 XML 格式是否正确？您是否将`ContentType`ASPX 页面上的属性设置为`text/xml`？

# java - 如何在 Java 中逐个字符地读取输入？

> ID：811851
> 
> 赞同：56
> 
> 时间：2009-05-01T15:22:17.400
> 
> 标签：java, character, tokenize

我习惯了 c-style `getchar()`，但似乎 java 没有可比性。我正在构建一个词法分析器，我需要逐个字符地读取输入。

我知道我可以使用扫描仪扫描令牌或行并逐个字符地解析令牌，但这对于跨越多行的字符串来说似乎很笨拙。有没有办法从 Java 的输入缓冲区中获取下一个字符，或者我应该直接使用 Scanner 类？

输入是文件，而不是键盘。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-05-01T15:25:10.387

使用[Reader.read()](http://java.sun.com/javase/6/docs/api/java/io/Reader.html#read())。返回值 -1 表示流结束；否则，转换为*char*。

此代码从文件参数列表中读取字符数据：

```
public class CharacterHandler {
    //Java 7 source level
    public static void main(String[] args) throws IOException {
        // replace this with a known encoding if possible
        Charset encoding = Charset.defaultCharset();
        for (String filename : args) {
            File file = new File(filename);
            handleFile(file, encoding);
        }
    }

    private static void handleFile(File file, Charset encoding)
            throws IOException {
        try (InputStream in = new FileInputStream(file);
             Reader reader = new InputStreamReader(in, encoding);
             // buffer for efficiency
             Reader buffer = new BufferedReader(reader)) {
            handleCharacters(buffer);
        }
    }

    private static void handleCharacters(Reader reader)
            throws IOException {
        int r;
        while ((r = reader.read()) != -1) {
            char ch = (char) r;
            System.out.println("Do something with " + ch);
        }
    }
} 
```

上面代码的坏处是它使用了系统的默认字符集。尽可能选择已知的编码（如果可以选择，最好是 Unicode 编码）。有关更多信息，请参阅[Charset](http://java.sun.com/javase/6/docs/api/java/nio/charset/Charset.html)类。*（如果你觉得受虐，你可以阅读[这个字符编码指南](http://illegalargumentexception.blogspot.com/2009/05/java-rough-guide-to-character-encoding.html)。）*

*（您可能需要注意的一件事是补充 Unicode 字符 - 那些需要存储两个 char 值的字符。有关更多详细信息，请参阅[Character](http://java.sun.com/javase/6/docs/api/java/lang/Character.html)类；这是一个可能不适用于家庭作业的边缘情况。）*

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-05-01T16:32:27.573

结合其他人关于指定字符编码和缓冲输入的建议，我认为这是一个非常完整的答案。

假设您有一个`File`代表您要读取的文件的对象：

```
BufferedReader reader = new BufferedReader(
    new InputStreamReader(
        new FileInputStream(file),
        Charset.forName("UTF-8")));
int c;
while((c = reader.read()) != -1) {
  char character = (char) c;
  // Do something with your character
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-01T18:32:35.257

另一种选择是不逐个字符地读取内容——将整个文件读入内存。如果您需要多次查看字符，这很有用。一种简单的方法是：

```
 /** Read the contents of a file into a string buffer      */
    public static void readFile(File file, StringBuffer buf)
        throws IOException
    {
    FileReader fr = null;
    try {
      fr = new FileReader(file);
      BufferedReader br = new BufferedReader(fr);
      char[] cbuf = new char[(int) file.length()];
      br.read(cbuf);  
      buf.append(cbuf);
      br.close();
    }
    finally {
      if (fr != null) {
        fr.close();
      }
    }
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-01T16:00:53.547

将输入流包装在缓冲读取器中，然后使用 read 方法一次读取一个字节，直到流结束。

```
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class Reader {

    public static void main(String[] args) throws IOException {

        BufferedReader buffer = new BufferedReader(
                 new InputStreamReader(System.in));
        int c = 0;
        while((c = buffer.read()) != -1) {
            char character = (char) c;          
            System.out.println(character);          
        }       
    }   
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T15:30:08.457

如果您使用`BufferedReader`. 这个缓冲的阅读器比阅读器快，所以你可以包装它。

```
BufferedReader reader = new BufferedReader(new FileReader(path));
reader.read(char[] buffer); 
```

这将 line 读入 char 数组。你有类似的选择。看文档。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-01T15:38:55.627

将您的阅读器包装在[BufferedReader](http://java.sun.com/javase/6/docs/api/java/io/BufferedReader.html)中，该缓冲区维护一个缓冲区，从而可以更快地进行整体读取。然后，您可以使用 read() 读取单个字符（您需要转换）。您还可以使用 readLine() 获取整行，然后将其分成单个字符。BufferedReader 还支持标记和返回，所以如果需要，可以多次读取一行。

一般来说，您希望在实际使用的任何流之上使用 BufferedReader 或 BufferedInputStream，因为它们维护的缓冲区将使多次读取更快。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-08-13T00:42:42.140

如果我是你，我只会使用扫描仪并使用“.nextByte()”。你可以把它转换成一个字符，你很好。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-01-21T11:05:03.910

在 java 5 中添加了新功能，即 Scanner 方法，它可以在 java 中逐个字符地读取输入。

例如; 使用 Scanner 方法 import java.util.Scanner; 在主要方法之后：定义

扫描仪 myScanner = new Scanner(System.in); //用于读取字符

char 任何东西=myScanner.findInLine(".").charAt(0);

你任何东西都存储单个字符，如果你想要更多阅读更多字符声明更多对象，如任何东西1，任何东西2......你的答案的更多示例请检查你的手（复制/粘贴）

```
 import java.util.Scanner;
     class ReverseWord  {

    public static void main(String args[]){
    Scanner myScanner=new Scanner(System.in);
    char c1,c2,c3,c4;

    c1 = myScanner.findInLine(".").charAt(0);
        c2 = myScanner.findInLine(".").charAt(0);
    c3 = myScanner.findInLine(".").charAt(0);
    c4 = myScanner.findInLine(".").charAt(0);

    System.out.print(c4);
    System.out.print(c3);
    System.out.print(c2);
    System.out.print(c1);
    System.out.println();

   }
  } 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2018-03-03T02:54:35.170

这将从文件中每行打印 1 个字符。

```
 try {

        FileInputStream inputStream = new FileInputStream(theFile);
        while (inputStream.available() > 0) {
            inputData = inputStream.read();
            System.out.println((char) inputData);

        }
        inputStream.close();
    } catch (IOException ioe) {
        System.out.println("Trouble reading from the file: " + ioe.getMessage());
    } 
```

# multithreading - 线程化多个异步调用

> ID：811855
> 
> 赞同：6
> 
> 时间：2009-05-01T15:23:31.610
> 
> 标签：multithreading, silverlight

我的 Silverlight 应用程序的一部分需要来自三个服务请求的数据。到目前为止，我一直在链接请求，以便一个完成另一个开始......直到链的末端我对数据做我需要做的事情。

现在，我知道那不是最好的方法（！）。我一直在查看[AutoResetEvent](http://msdn.microsoft.com/en-us/library/system.threading.autoresetevent.aspx)（链接到 MSDN 示例）以线程化然后同步结果，但似乎无法让它与异步服务调用一起使用。

有没有人有任何理由怀疑这种方法或这种方法是否可行？代码示例感激地收到！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-01T16:38:11.493

看看这个例子：

一旦两个服务都返回，将触发 Completed 事件并将“完成”打印到调试输出。关键是等待 AutoResetEvents 发生在后台线程中。

* * *

```
public partial class MainPage : UserControl
{
    public MainPage()
    {
        InitializeComponent();

        Completed += (s, a) => { Debug.WriteLine("done"); };

        wrk.DoWork += (s, a) =>
            {
                Start();
            };

        wrk.RunWorkerAsync();
    }
    public event EventHandler Completed;

    private void Start()
    {
        auto1.WaitOne();
        auto2.WaitOne();

        Completed(this, EventArgs.Empty);
    }

    public AutoResetEvent auto1 = new AutoResetEvent(false);
    public AutoResetEvent auto2 = new AutoResetEvent(false);

    BackgroundWorker wrk = new BackgroundWorker();

    private void Button_Click(object sender, RoutedEventArgs e)
    {
        ServiceReference1.Service1Client clien = new SilverlightAsyncTest.ServiceReference1.Service1Client();

        clien.DoWorkCompleted += new EventHandler<SilverlightAsyncTest.ServiceReference1.DoWorkCompletedEventArgs>(clien_DoWorkCompleted);
        clien.DoWork2Completed += new EventHandler<SilverlightAsyncTest.ServiceReference1.DoWork2CompletedEventArgs>(clien_DoWork2Completed);

        clien.DoWorkAsync();
        clien.DoWork2Async();
    }

    void clien_DoWork2Completed(object sender, SilverlightAsyncTest.ServiceReference1.DoWork2CompletedEventArgs e)
    {
        Debug.WriteLine("2");
        auto1.Set();
    }

    void clien_DoWorkCompleted(object sender, SilverlightAsyncTest.ServiceReference1.DoWorkCompletedEventArgs e)
    {
        Debug.WriteLine("1");
        auto2.Set();
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-08-12T13:10:21.943

可以使用每个异步方法返回的 IAsyncResult 中的 WaitHandle 来完成。

代码很简单。在 Silverlight 中，我只需执行 10 次服务调用，即可将项目添加到 ListBox。我将等到所有服务调用结束后才将另一条消息添加到列表中（这必须在不同的线程中运行以避免阻塞 UI）。另请注意，必须通过 Dispatcher 将项目添加到列表中，因为它们会修改 UI。有很多 lamdas，但很容易理解。

```
 public MainPage()
        {
            InitializeComponent();
            var results = new ObservableCollection<string>();
            var asyncResults = new List<IAsyncResult>();
            resultsList.ItemsSource = results;
            var service = new Service1Client() as Service1;

            1.To(10).Do(i=>
                asyncResults.Add(service.BeginDoWork(ar =>
                    Dispatcher.BeginInvoke(() => results.Add(String.Format("Call {0} finished: {1}", i, service.EndDoWork(ar)))),
                    null))
            );

            new Thread(()=>
            {
                asyncResults.ForEach(a => a.AsyncWaitHandle.WaitOne());
                Dispatcher.BeginInvoke(() => results.Add("Everything finished"));
            }).Start();
        } 
```

只是为了帮助测试，这就是服务

```
public class Service1
    {
        private const int maxMilliSecs = 500;
        private const int minMillisSecs = 100;
        [OperationContract]
        public int DoWork()
        {
            int millisSecsToWait = new Random().Next(maxMilliSecs - minMillisSecs) + minMillisSecs;
            Thread.Sleep(millisSecsToWait);
            return millisSecsToWait;
        }
    } 
```

# java-me - 在 J2ME 中将 png 图像解析为多个 png 图像

> ID：811861
> 
> 赞同：0
> 
> 时间：2009-05-01T15:25:31.120
> 
> 标签：java-me

谁能告诉我如何在 J2ME 中将 png 图像解析为许多 png 图像？我想编写一个代码来获取图像并给出许多具有相同像素的图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T15:38:46.440

你的意思是你想把它剪成更小的图像？

1.  加载图像。

2.  转换为位图。

3.  将任意矩形编码为 PNG。

4.  保存PNG。

不幸的是，我对使用 J2ME 库的图像处理一无所知。

[这是我在 J2ME 中加载 PNG 时搜索的内容。](http://www.java2s.com/Code/Java/J2ME/ViewPng2.htm)

使用它，您将能够看到使用的 API 调用，并按照`import`列表，您将获得使用的类。看看那些类的方法，你可能会想出你需要的东西。

我这样做主要是因为您有紧急情况，但坦率地说，您可以自己搜索这个，*或者*提出一个更清晰的问题，这会导致更了解 J2ME 图像处理的人帮助您。

只是不要惊慌，深呼吸，谷歌搜索你需要的东西，你会没事的。

# .net - .NET Applet 和 IE 中嵌入的 ActiveX 控件有什么区别

> ID：811868
> 
> 赞同：3
> 
> 时间：2009-05-01T15:27:01.537
> 
> 标签：.net, internet-explorer, activex, applet

我在网上看到了一些关于 .Net 小程序的文章，我想知道它与 activex 控件（使用 .Net 语言创建）有何不同？（澄清一下，这是关于在网络浏览器中运行的小程序）

（有什么区别：用 .Net 语言编写的 ActiveX 控件称为 .Net Applets？）

使用其中一个有什么优势吗？

另外，微软将这项技术称为什么？（在 MSDN 上搜索并没有找到任何称为 .Net Applets 的内容！）

ps：据我所知，ActiveX 控件需要注册 COM，而 .Net 小程序则不需要。此外，在网页中，activeX 控件是使用它们的 CLSID 来引用的，而 .NET 小程序似乎是通过全名（路径、dll 名称、命名空间和类）来引用的

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T16:02:53.870

ActiveX 控件只是简单的 COM 对象，它们至少实现了 IUnknown。最新版本的 IE 也开始要求对象实现 IObjectSafety。为了做任何有用的事情，对象还需要实现一些其他的 Ole 接口，例如 IDispatch、IOleObject 等。对象需要可以通过 CoCreateInstance() 创建，这意味着您必须以某种方式在注册表中[注册](http://blogs.msdn.com/larryosterman/archive/2006/01/05/509731.aspx)它. 您不必在标签中使用 guid，如果您注册一个 ，也可以使用[AppId 。](http://blogs.msdn.com/larryosterman/archive/2006/01/04/509436.aspx)

您还可以编写一些托管代码并使其在 IE 中运行。工作方式是 CLR 在安装时注册一个[MIME 过滤器](http://msdn.microsoft.com/en-us/library/aa767916(VS.85).aspx#About_Pluggable_MIME)。然后，当 IE 看​​到您正在发送适当的 mime 类型的内容时，它会将代码交给 CLR 处理。CLR 将代码沙箱化到只授予 Internet 权限的范围内，因此它不能执行框架公开的所有操作。您必须检查特定文档以了解在此安全区域中可以做什么和不可以做什么。

一些取舍：

易于安装：ActiveX 控件要求您将所有内容打包到一个带有 .INI 文件的 .CAB 文件中，该文件以相当隐秘的方式描述了安装要求。如果您必须为您的模块（例如 ATL/MFC dll 或其他第三方模块）安装额外的依赖项，它会变得非常棘手。使用 .net 模块，您只需使用正确的 MIME 类型发送它，但您必须确保您的用户拥有正确的框架版本（您可以通过网站上的用户代理字符串检查）。

安全性：ActiveX 控件只是运行在用户系统上的本机代码，因此理论上它们可以为所欲为。在实践中，LoRIE 在许多情况下都会限制它，您必须对注册表和文件系统访问等事情进行一系列特殊处理（请参阅[了解和在保护模式下工作](http://msdn.microsoft.com/en-us/library/bb250462.aspx)）。

线程：由于 ActiveX 控件在浏览器 UI 线程上运行，因此您必须确保不在该线程上执行长时间阻塞操作，因此您必须自己进行线程处理。如果您的长阻塞操作操作 DOM，您必须自己编组 IHTMLxxx 接口，使用[GIT](http://msdn.microsoft.com/en-us/library/ms678517(VS.85).aspx)或 COM 编组[函数](http://msdn.microsoft.com/en-us/library/ms693316.aspx)。我不确定 .net 小程序是否在浏览器 UI 线程上运行，但我确定在 C# 中更容易处理。

浏览器对象：如果你想在你的托管扩展中使用 IE / Shell 对象，你大部分时间都必须自己编写互操作，因为框架不能很好地将这些接口包装在托管对象中。请参阅[http://pinvoke.net](http://pinvoke.net)以获得一些入门帮助。

兼容性：在同一进程中托管不同版本的运行时存在问题。直到最近，这根本不可能，但我认为在 3.x 版本中，它已经开始在一定程度上成为可能。结果是，如果您以 .net 2.0 为目标，而其他人已经将 .net 1.0 作为其浏览器扩展的一部分加载，那么您就输了。通常 IE 和 Windows Shell 不支持托管扩展。这个 .net 应用程序 MIME 过滤器可能是一个明显的例外，但请注意可能存在潜在问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T15:39:01.477

“ActiveX 控件（使用 .Net 语言创建）”和“.NET 小程序”都是“IE 中托管的 .NET 程序集”的俚语。

事实上，.NET 程序集可以托管在各种应用程序中。看：

[创建 .NET 公共语言运行时的主机](http://www.codeproject.com/KB/COM/simpleclrhost.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T15:31:16.363

ActiveX 控件没有与 .NET 小程序相同的安全限制，这可能是优势或劣势，具体取决于您想要做什么。.NET 小程序通常更易于开发，您使用 VB6 或 C++ 创建的 ActiveX。

# php - PHP中的多维数组

> ID：811869
> 
> 赞同：3
> 
> 时间：2009-05-01T15:28:05.670
> 
> 标签：php, arrays

如何将项目添加到多维数组中？基本上我正在制作一个应用程序来计算人们在超市购买了什么以及购买了多少。

> 苏买了 2 桶黄油和 1 支牙膏
> 
> 约翰买了 1 个桃子和 1 个香蕉。

我认为数组看起来像这样

```
$sue[butter] = array(); 
$sue[butter][] = 2;
$sue[toothpaste] = array(); 
$sue[toothpaste][] = 1;
$john[peach] = array(); 
$john[peach][] = 1;
$john[banana] = array(); 
$john[banana][] = 1; 
```

我目前的代码只能记录商品和商品数量。

```
public $items = array();

public function AddItem($product_id)
{
    if (array_key_exists($product_id , $this->items))
    {
        $this->items[$product_id] = $this ->items[$product_id] + 1;
    } else {
        $this->items[$product_id] = 1;
    }
} 
```

我只是不知道如何将其放入每个人的数组中。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T15:32:28.250

如果不这样做，您可能会发现封装到一个类中更容易。例如，让每个人成为一个类，然后赋予他们属性。

一旦进入多维数组，维护代码就变得更加困难。

例如（这是伪代码）：

```
class Customer {
    //this is an array of FoodItem objects.
    private $foodItems[];

    // any other methods needed for access here
}

class FoodItem {
    //could be a String, or whatever it needs to be
    private $itemType;

    //the number of that item purchased
    private $numPurchased;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T15:32:42.897

嗯，可能我这里没看到多维？

```
$sue = array();
$sue['butter'] = 2;
$sue['toothpaste'] = 1;

$john = array();
$john['peach'] = 1;
$john['banana'] = 1; 
```

我认为您展示的功能适用于上述功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T16:41:49.893

您不需要像在此处那样创建另一个数组来保存项目的数量：

```
$sue[butter] = array(); 
$sue[butter][] = 2; 
```

我认为这样的事情会起作用：

```
$customers[sue][butter] = 2; 
$customers[sue][toothpaste] = 1; 
$customers[john][peach] = 1; 
$customers[john][banana] = 1; 
```

这样您就可以创建一组客户名称。然后在每个客户阵列中，您都有他们的产品阵列。然后每个产品都包含客户购买的该产品的数量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T15:42:19.973

```
$data = array();
$data["persons"] = array("Sue","John");
$data["articles"] = array("butter","toothpaste","peach","banana");

$data["carts"] = array();

$data["carts"][0][0] = 2; // sue's 2 butter packets
$data["carts"][0][1] = 1; // sue's 1 tooth paste

$data["carts"][1][2] = 1; // john's peach
$data["carts"][1][3] = 1; // john's banana 
```

# iis-6 - ASP.NET routing on IIS 6

> ID：811871
> 
> 赞同：18
> 
> 时间：2009-05-01T15:28:23.237
> 
> 标签：iis-6, asp.net-routing

I have created a basic site using [ASP.NET](http://en.wikipedia.org/wiki/ASP.NET) routing according to Mike Ormond's example "Using ASP.NET routing Independent of MVC". This works fine on my local machine running the built-in web server.

However, when I deploy it to my server ([Windows Server 2003](http://en.wikipedia.org/wiki/Windows_Server_2003), [IIS](http://en.wikipedia.org/wiki/Internet_Information_Services) 6, ASP.NET 3.5 SP1) it just shows a 404 error.

I have read somewhere that I am meant to set up wildcard routing. How can I do this?

What other configuration changes needs to be done to make it work on my server?

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-01T15:30:49.080

You will find some good information on Steve Sanderson’s blog post "[Deploying ASP.NET MVC to IIS 6](http://blog.codeville.net/2008/07/04/options-for-deploying-aspnet-mvc-to-iis-6/)."

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-05-01T15:50:30.437

On the server, open IIS:

1.  Right-click on the site/virtual directory, select properties
2.  Goto the Home Directory/Virtual Directory tab, click Configuration (near the bottom)
3.  Near the bottom again, click the insert button
4.  Enter **C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\aspnet_isapi.dll**
5.  Alternate: Enter **C:\WINDOWS\Microsoft.NET\Framework\v4.0.30319\aspnet_isapi.dll** for ASP.NET 4.0
6.  **Uncheck** the "Verify that file exists" button, click Okay and close all the dialogues

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-01T15:35:46.760

You can find the "official" discussion of wildcard mappings on [TechNet here](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/5c5ae5e0-f4f9-44b0-a743-f4c3a5ff68ec.mspx?mfr=true) but I like Phil Haack's walkthrough that you can [find here](http://haacked.com/archive/2008/11/26/asp.net-mvc-on-iis-6-walkthrough.aspx). Don't worry about the fact that it's a discussion of setting up [ASP.NET MVC](http://en.wikipedia.org/wiki/ASP.NET_MVC_Framework), just look for the section titled "IIS6 Extension-less URLs" - that set up applies to both MVC and using routing with a classic [web form](http://en.wikipedia.org/wiki/Form_%28web%29) application.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-24T16:03:56.603

Under IIS 6 64 bit, make sure that the path under 4.) points to **C:\WINDOWS\Microsoft.NET\Framework64\v2.0.50727\aspnet_isapi.dll**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-11-24T06:24:56.497

Url rewriting can help you to solve the problem. I've implemented solution allowing to deploy MVC application at any IIS version even when virtual hosting is used. [http://www.codeproject.com/KB/aspnet/iis-aspnet-url-rewriting.aspx](http://www.codeproject.com/KB/aspnet/iis-aspnet-url-rewriting.aspx)

# asp.net - 如果从 SQL 返回一个 DataSet 重复的命名列会发生什么？

> ID：811883
> 
> 赞同：0
> 
> 时间：2009-05-01T15:31:18.813
> 
> 标签：asp.net, sql, dataset

我正在创建存储过程，它可以从多个表中带回我需要的一堆数据，但是这些表共享一些重复的列名。它在 SQL 中运行良好，但我想知道一旦我将它们作为 DataSet 中的 DataRows 访问时会发生什么以及如何区分它们。有人知道吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-01T15:33:38.527

它应该通过附加一个数字来自动重命名它们。例如，`COLUMN_NAME`、`COLUMN_NAME1`和`COLUMN_NAME2`。但是，这充其量很难维护，并且以后可能会引起麻烦。

为避免这种情况，您可能希望使用列别名（AS 关键字）自己指定名称：

```
SELECT t1.myColumn AS t1_col, t2.myColumn AS t2_col
FROM t1, t2 
```

# html - 对于包含 HTML 片段的文件，我应该使用什么扩展名？

> ID：811887
> 
> 赞同：35
> 
> 时间：2009-05-01T15:32:36.720
> 
> 标签：html

文件名上的“.html”后缀意味着该文档包含`html`、`head`和`body`标签。

我有一些文件，每个文件都包含一个`div`或两个元素，但没有`html`或`body`标签。文件内容是格式良好的 HTML 片段，因为它们可以插入到`body`兼容 HTML 文档的标签中，并且仍然是兼容的。（它们不包含“ `<% %>`”标记，不包含 PHP 代码等。）但是片段文件本身不符合 HTML，所以我想给它一个不同的命名约定。

一些“文件扩展名”站点包含“.PHT”条目并将其描述为“部分超文本文件”。这听起来很有希望，但我找不到任何关于来源、预期文件格式或使用它的应用程序的额外解释。此外，许多相同的站点将“.phtml”和“.phtm”（似乎是 .pht 后缀的较长版本）标识为 PHP 文件——如前所述，我的文件不是 PHP 文件。

我应该使用“.pht”作为后缀吗？有更合适的命名约定吗？

编辑：我想将片段文件与同一目录中的完整 HTML 文档区分开来。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-01T15:34:25.123

我会使用`.inc`（意思是包含文件）或`.txt`.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-02T11:04:10.070

我一般使用`.inc`或`.tpl`扩展。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-01T15:39:33.287

由于这些文件实际上是用超文本标记语言编写的，我认为给它们提供 .html 扩展名是非常有效的。考虑将*目录*称为“divs”或“panels”、“forms”等...

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-05-30T06:28:35.033

如果为片段选择扩展名，那么选择代码编辑器认为是 html 的扩展名是有意义的，这样您就可以获得所有突出显示的优点。

Atom 编辑器对 html[使用以下内容](https://github.com/atom/language-html/blob/master/grammars/html.cson)`.ejs`： , `.htm`, `.html`, `.kit`, `.shtml`, `.tmpl`, `.tpl`,`.xhtml`而 Scite 编辑器使用：`.asp`, `.cfm`, `.hta`, `.htm`, `.html`, `.htd`, `.jsp`, `.htt`, `.shtml`, `.tpl`, 和`.xhtml`. 选择两者都使用的一个，看看它是否也由您选择的编辑器定义。

对于模板，我使用 .tpl 并使用百分比和感叹号设置第一行：

```
%!
<followed by rest of file here> 
```

因为这`%!`会导致 Chrome 和 Firefox 默认将文件视为文本。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-01T15:36:48.770

我通常使用`.inc`（包含文件）或`.shtml`（共享 HTML）。不过，我从来没有听说过`.pht`。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-10-31T21:42:10.123

根据定义`.html`，或者`.htm`是包含 HTML 的文件，无论版本如何。没有官方规范提到它们应该包含完整的 HTML 文档定义，只是它们应该包含 HTML。

XHTML 是一个不同的球类游戏，因为它必须包含经过验证的内容，因此需要完整的格式良好的 XHTML 文档。

我`.html`在一个单独的文件夹中使用并组织了带有 HTML 片段的文件，但是我的编辑器尊重它们不必是完整文档并且不会产生任何警告的事实。

要区分同一目录中的差异，您可以将`.htm`其用于部分内容和`.html`完整文档，反之亦然。

或者，您可以为扩展添加前缀，例如`file.partial.html`或`file.p.html`

如果您的编辑器产生警告，则可能需要查看您的特定编辑器参考资料（帮助文件、网站、支持论坛等）以寻求解决方案，这实际上可能使用了另一个扩展名，例如`.tpl`or `.inc`。

编辑 - 忘记写 XML：HTML 是 XML，所以你可以使用`.xml`扩展，注意事项是：

1.  你可能不会得到 HTML 类型提示
2.  有效的 xml 文件需要`<?xml version="1.0"?>`作为第一行，因此包含进程可能会将此行插入不需要的位置。
3.  仅支持一个容器对象，因此您需要一个或类似的元素包含所有内容，因此文档的根目录中`<div>`不能有两个。`<div>`

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-01T16:30:17.737

另一个扩展名“.fhtml”似乎被一些过时的 Macromedia 产品使用，并且至少有[一个其他软件包](http://www.centerkey.com/dsi/manual.html)使用它来表示“片段 HTML”。

有一个先例很好，但不幸的是，.fhtml 后缀也用于表示嵌入了[因子](http://factorcode.org/)代码的 HTML 模板。这样的暧昧很​​烦人。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-01T15:54:49.053

我以前只见过“.phtml”扩展名，但我从未使用过它。我总是使用“.html”，就像任何其他“.html”文件一样。就像 MasterPeter 说的文件是用 HTML 编写的，所以我认为它是正确的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-02T04:15:39.630

我使用“公司”。我看不出有任何理由担心这样的事情。只要您从目录列表中的文件中受益并且不会感到困惑，就可以随意调用它。

我不使用“inc”的一个示例是当包含内部包含时，例如您的外部页面包含导航包含，然后包含第三个文件。在这种情况下，您必须保留服务器期望扩展名用于服务器解析文件的任何内容。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-12-03T23:48:31.147

我使用“.i.html”，它对我来说涵盖了大部分基础，并且是独一无二的。似乎工作。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-03-07T15:44:26.633

我用过：

*   `.htm`为片段。
*   `.html`如果它是一整页。

有时我会考虑使用`htmlf`for 片段，例如在 JSP 中您可以`.jsp`使用完整页面和`.jspf`片段。

# .net - 如何在 .net 项目中使用 Reg-Free COM 作为 vb6 dll 引用？

> ID：811894
> 
> 赞同：5
> 
> 时间：2009-05-01T15:34:20.913
> 
> 标签：.net, com, vb6, regfreecom

我一直在尝试解决这个问题很长时间，但似乎没有任何效果。

我有一个用 vb6 编写的 COM DLL。我在 .net 中添加了对此 DLL 的引用，并将引用上的“隔离”和“复制本地”属性设置为 true。显然，这应该启用无注册 com。

但它不起作用。如果我在另一台计算机上尝试，或者使用 regsvr32 取消注册 DLL，尝试访问 DLL 会引发异常（本质上是说所需的 com 类不存在）。DLL 和清单文件与 EXE 位于同一文件夹中，但显然它完全忽略了它们。

我究竟做错了什么？我已经阅读了大量关于此的零散文章，但没有一篇能给我一个可行的解决方案。我已经修补了视觉工作室，但无济于事。我已经对 make-my-manifest 进行了少量修改，但它不起作用（即使在测试项目中也是如此）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-24T16:29:23.003

我在非 ui 线程上创建和使用 com 类。显然，vb6 DLL 上的 Reg-Free com 在这种情况下不起作用。此测试代码显示它：

```
Private Sub RunTest() Handles Button1.Click
    Try
        Dim x As New RegTestProject.RegTestCall
        MsgBox(x.RegTestFunction())
    Catch ex As Exception
        MsgBox(ex.ToString)
    End Try
End Sub

Private Sub RunThreadedTest() Handles Button2.Click
    'fails if reg-free COM is used'
    Dim t As New Threading.Thread(AddressOf RunTest)
    t.Start()
End Sub 
```

当我使用正常注册的 DLL 运行它时，两个测试都成功了。如果我使用 reg-free com，即使正常测试仍然成功，线程测试也会失败。看起来这将是一个巨大的痛苦来解决。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T15:54:20.303

我很确定，当您以这种方式引用 COM 组件时，每次构建时都会导入 COM 组件。这意味着 COM 组件必须以传统方式在将构建项目的每台机器上注册。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T15:52:15.190

这是一个描述使用免费注册 com 互操作的[链接。](http://blogs.msdn.com/junfeng/archive/2006/04/20/579748.aspx)如果您已经这样做了，请发布您的清单文件。你可能有错别字。

**编辑**

只是想在应用程序第一次在新机器上运行时注册 dll 可能更简单。免注册 com interopt 仅适用于 Windows XP 和更新版本，因此如果您的目标是任何恐龙，它将无法正常工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-01T19:42:55.760

[这是 MSDN文章中](http://msdn.microsoft.com/en-us/library/ms973913.aspx)有关无注册 COM的[故障排除](http://msdn.microsoft.com/en-us/library/ms973913.aspx#rfacomwalk_topic10)部分的摘录。抱歉，如果您已经看过它。好消息是您已经完成了这些步骤。它建议在 Windows Server 2003 中重现该问题（可能使用[Virtual PC](http://www.microsoft.com/windows/virtual-pc/default.aspx)？），然后事件日志应该会有所帮助。

> 首先让...您的客户使用已注册的服务器；然后注销服务器并验证您的错误消息是否符合您的预期；最后......制作和部署清单文件。这样，您的故障排除工作......将仅限于清单文件的结构（以及如果您选择这样做，则正确嵌入程序集清单）。
> 
> 在解决免注册 COM 问题时，**Windows Server 2003 上的事件查看器**是您的朋友……在系统事件日志中查找来自 COM 服务器的事件。我不建议您查看 Windows XP 事件日志……它总是包含一条消息……这无助于识别问题。

# .net - 如何将智能感知添加到我的应用程序中？

> ID：811905
> 
> 赞同：10
> 
> 时间：2009-05-01T15:38:17.080
> 
> 标签：.net, intellisense, syntax-highlighting, code-editor

我们在我们的一个产品中拥有专有的宏语言，通过我们的 Windows 软件进行编辑。我想添加智能感知，但我不知道如何去做（至少在没有完全重新发明轮子的情况下不会）。是否有任何示例代码或 3rd 方包至少可以让我开始？它不一定是免费的。

该应用程序使用 .NET，用 C# 编写。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T15:49:20.313

有一篇关于将智能感知添加到您自己的应用程序的 CodeProject 文章：[DIY Intellisense](http://www.codeproject.com/KB/cs/diy-intellisense.aspx?df=100&forumid=31360&exp=0&select=727059)

它应该给你一个好的开始。

*如果您真的*想深入研究实现，还可以深入研究开源包： [#develop（SharpDevelop 的缩写）是用于 C#、VB.NET 和 Boo 项目的免费 IDE](http://www.icsharpcode.net/OpenSource/SD/)

# algorithm - 客户端-服务器游戏算法

> ID：811906
> 
> 赞同：16
> 
> 时间：2009-05-01T15:38:43.773
> 
> 标签：algorithm, game-loop

对于单机游戏，基本的游戏循环是（来源：维基百科）

```
while( user doesn't exit )
  check for user input
  run AI
  move enemies
  resolve collisions
  draw graphics
  play sounds
end while 
```

但是如果我开发类似客户端-服务器的游戏，比如 Quake、Ragnarock、Trackmania 等，会怎样？

游戏的客户端和服务器部分的循环/算法是什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-01T15:51:06.003

会是这样的

客户：

```
while( user does not exit )
    check for user input
    send commands to the server
    receive updates about the game from the server
    draw graphics
    play sounds
end 
```

服务器：

```
while( true )
    check for client commands
    run AI
    move all entities
    resolve collisions
    send updates about the game to the clients
end 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-01T16:25:31.820

客户：

```
connect to server
while( user does not exit && connection live)
    check for user input
    send commands to the server
    estimate outcome and update world data with 'best guess'
    draw graphics
    play sounds
    receive updates about the game from the server
    correct any errors in world data
    draw graphics
    play sounds
end 
```

服务器：

```
while( true )
    check for and handle new player connections
    check for client commands
    sanity check client commands
    run AI
    move all entities
    resolve collisions
    sanity check world data
    send updates about the game to the clients
    handle client disconnects
end 
```

对客户端命令和世界数据的健全性检查是为了消除任何由故意作弊（移动太快，穿过墙壁等）或延迟（穿过客户端认为打开的门，但服务器知道）引起的任何“不可能”情况已关闭等）。

为了处理客户端和服务器之间的延迟，客户端必须对接下来会发生什么做出最好的猜测（使用它的当前世界数据和客户端命令）——然后客户端必须处理它所预测会发生的任何差异以及服务器后来告诉它实际发生的事情。通常这将足够接近以至于玩家不会注意到差异 - 但如果延迟很明显，或者客户端和服务器不同步（例如由于作弊），那么客户端将需要在以下情况下进行突然更正它从服务器接收数据。

还有很多关于将这些进程的部分拆分为单独的线程以优化响应时间的问题。

最好的开始方法之一是从一个拥有活跃改装社区的游戏中获取一个 SDK——深入研究它的工作原理将很好地概述应该如何完成它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-01T16:06:02.990

这真的不是一个简单的问题。在最基本的层面上，您可以说网络提供的数据与原始循环的 MoveEnemies 部分提供的数据相同。因此，您可以简单地将循环替换为：

```
while( user doesn't exit )
  check for user input
  run AI
  send location to server
  get locations from server
  resolve collisions
  draw graphics
  play sounds
end while 
```

但是，您需要考虑延迟，因此您真的不想通过调用网络来暂停主循环。为了克服这个问题，经常会看到网络引擎位于第二个线程上，尽可能快地从服务器轮询数据并将对象的新位置放入共享内存空间中：

```
while(connectedToNetwork)
    Read player location
    Post player location to server
    Read enemy locations from server
    Post enemy locations into shared memory 
```

然后你的主循环看起来像：

```
while( user doesn't exit )
  check for user input
  run AI
  read/write shared memory
  resolve collisions
  draw graphics
  play sounds
end while 
```

这种方法的优点是您的游戏循环将尽可能快地运行，但来自服务器的信息只有在完成与服务器之间的完整发布后才会更新。当然，您现在遇到了跨线程共享对象以及随之而来的锁等乐趣的问题。

在服务器端，循环大致相同，每个玩家有一个连接（通常每个玩家也在一个单独的线程上，因此一个人的延迟不会影响其他人）对于每个连接它将运行一个循环，如

```
while (PlayerConnected)
    Wait for player to post location
    Place new location in shared memory 
```

当客户端机器请求敌人的位置时，服务器从共享内存块中读取所有其他玩家的位置并将其发回。

这是一个非常简化的概述，还有更多的调整可以提高性能（例如，服务器将敌人的位置发送给客户端而不是客户端请求它们可能值得），你需要决定在哪里做出某些逻辑决策（客户是因为自己有最新的位置而被枪杀，还是服务器停止作弊）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-01T15:51:30.793

客户端部分基本相同，除了替换

```
run AI
move enemies
resolve collisions 
```

和

```
upload client data to server
download server updates 
```

服务器只是这样做：

```
while (game is running)
{
    get all clients data
    run AI
    resolve collisions
    udpate all clients
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-01T15:51:32.727

您可以使用几乎相同的东西，但大多数逻辑将在服务器上，您可以将计时器、声音、图形和其他 UI 组件放在客户端应用程序上。任何业务规则（AI、运动）都进入服务器端。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-03-26T20:30:03.330

一篇非常有用且我认为值得阅读的相关论文是：[Client-Server Architectures](https://docs.google.com/viewerng/viewer?url=http://classstudio.com/papers/professional_papers/mmorpg/gamepaper_final.pdf)

我读了它，从中学到了很多东西，很有意义。通过将游戏分成战略定义的组件或层，您可以创建更易于维护的架构。该程序比您描述的传统线性程序模型更容易编码，并且更健壮。

这个思考过程出现在之前的一篇文章中，关于使用“共享内存”在程序的不同部分之间进行对话，从而克服了具有单线程和逐步游戏逻辑的限制。

你可以花几个月的时间研究完美的架构和程序流程，阅读一篇论文并意识到你一直在找错树。

tldr; 阅读。

# c# - 从 ASPX 页面读取 Flash 中的 XML

> ID：811911
> 
> 赞同：0
> 
> 时间：2009-05-01T15:39:35.643
> 
> 标签：c#, asp.net, xml, flash, actionscript-3

我创建了一个动态创建 xml 字符串并将其发布回客户端的 aspx 页面。

```
 protected void Page_Load(object sender, EventArgs e)
    {
        Response.Clear();
        Response.ContentType = "text/xml";
        Response.ContentEncoding = Encoding.UTF8;

        var flashAssets = Asset.GetScrollingFlashAssets();

        var xmlResponse = new StringBuilder(@"<?xml version=""1.0"" encoding=""UTF-8"" ?><assets>");
        flashAssets.ForEach(asset => xmlResponse.Append(@"<asset>handlers/ImageHandler.ashx?liAssetID=" + asset.AssetID + "</asset>"));
        xmlResponse.Append("</assets>");
        Response.Write(xmlResponse.ToString());
    } 
```

它创建了有效的 XML，当我将此代码保存到静态 .xml 文件时，闪存可以很好地读取它，但是当它尝试从 ASPX 读取它时，它失败并显示“1090 XML 解析器故障：元素格式错误”。

我没有打开http压缩。

闪码。

```
//---------loading the external xml file-------
var urlRequest:URLRequest = new URLRequest("../xml/CaseStudyFlashAssets.aspx");
var urlLoader:URLLoader = new URLLoader();
var myXML:XML = new XML();
var xmlList:XMLList;
myXML.ignoreWhitespace = true;
urlLoader.addEventListener(Event.COMPLETE,fileLoaded);
urlLoader.load(urlRequest); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T15:55:52.700

听起来当 flash 调用 aspx 页面时，它得到的响应与您预期的不同，请尝试使用此 fileLoaded 函数：

```
public function fileLoaded(event:Event):void{
     trace('urlLoader.data is ' + urlLoader.data);
     try{
          var xmlData:XML = XML(urlLoader.data);
     } catch (e:Error) {
          trace('Error creating XML: ' + e);
     }
} 
```

这应该有希望给你一些关于出了什么问题的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T15:48:21.393

尝试使用这个

```
"<![CDATA[" and ends with "]]>" 
```

# html - 自动链接到 URL

> ID：811913
> 
> 赞同：1
> 
> 时间：2009-05-01T15:39:48.357
> 
> 标签：html

基本上目前我有：

```
http://link.com - plain text 
```

我想：

```
<a href="http://link.com">http://link.com</a> 
```

是否可以自动添加' `a href`'？

如果是这样，我应该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T15:50:06.757

是的，您可以在加载时使用 javascript 解析您的文本。通过使用适当的正则表达式，只需将每个链接替换为锚定链接版本。

```
text.replace(**link regular expression**, "<a href=\"$1\">$1</a>"); 
```

**注意**：语法可能不正确，但您明白了。

# silverlight - ActiveX 小程序死了吗？

> ID：811914
> 
> 赞同：5
> 
> 时间：2009-05-01T15:39:52.973
> 
> 标签：silverlight, activex

ActiveX 小程序作为 Microsoft 支持的技术是否已死？

使用 Microsoft 技术创建极其丰富的 Internet 应用程序的 ActiveX 替代方案有哪些？（Silverlight 不适合我，因为它不能让我访问串行端口 - 或者是吗？）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-01T15:43:31.653

当然，您仍然可以制作 ActiveX 应用程序，但要知道它们只能与 Internet Explorer 一起使用，除非其他浏览器的用户安装了托管插件，否则这些插件并不是那么好。

无论哪种情况，需要访问串行端口的 Web 应用程序？您确定使用桌面应用程序不是更好吗？一个简单的刷新，你就切断了那个串行端口。

并非所有应用程序都属于浏览器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-05-04T12:42:19.327

ActiveX 作为技术是非常活跃的，并且会在未来很多年里继续存在。但是它在互联网上的使用已经死了。ActiveX 只能在 Windows 独立应用程序中使用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T15:49:24.463

如果您想通过可以访问串行端口的 Web 浏览器启动应用程序，一种选择是使用带有 JavaFX 的 Java Web Start 作为富接口 API，并使用 Java Communications 来访问串行端口。最后你也可以得到一个跨平台的应用程序。

或者，如果您绝对受限于使用 Microsoft 工具，则只需使用您喜欢的 Windows 工具包编写本机应用程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-11-12T19:30:36.417

自 2015 年起，ActiveX 已成为一种死技术，即使是制造商也不再有兴趣继续使用它。这是要读的[东西。](https://mashable.com/2015/05/11/microsoft-edge-security/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-01T15:51:51.540

不，Silverlight 从一开始就被设计为完全沙盒化，没有办法绕过它（感谢上帝）。

如果您需要这种访问方式，但正在寻找一种简单的部署方式，我建议您构建一个 Clickonce 应用程序。有限制，因为我认为默认情况下它们不是完全信任，但这是你能得到的最好的。如果您需要打印，这也将是唯一简单的途径（除非您愿意往返于服务器以生成 PDF 文件）。

如果您需要直接访问某些硬件（例如带有现金抽屉、收据打印机等的 POS 软件），您需要使用“桌面”。Clickonce 可以为您提供一些部署选项，XBAP 可以为您提供“浏览器体验”，但您将不得不根据您的“硬件访问需求”做出妥协。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-01T15:55:52.670

编辑：我没有注意到原始问题中的 Silverlight 排除。我的评论它并不适用。对不起！

我还不知道我是否会称 ActiveX 已死，但如果您计划基于此技术构建应用程序，我会谨慎。我的建议是使用[Silverlight](http://silverlight.net/)。这提供了 ActiveX 控件中通常需要的大部分功能，但使用了较新的 .NET 技术。

有很多关于使用 Silverlight 进行媒体播放的讨论，但它具有许多强大的功能，也可用于创建业务线应用程序。事实上[，DotNetRocks 上](http://www.dotnetrocks.com/default.aspx?showNum=441)有一个很棒的播客节目，它讨论了这个确切的主题。

这里还有一些链接可能会为您指明正确的方向： [Microsoft Silverlight 入门](http://silverlight.net/GetStarted/) [Silverlight 2 和](http://weblogs.asp.net/scottgu/archive/2008/11/16/update-on-silverlight-2-and-a-glimpse-of-silverlight-3.aspx)Scott Guthrie的 Silverlight 3 一瞥

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-12-11T17:19:26.057

据我所知，Silverlight 4 仍然无法让您直接访问串行端口，但它*确实*让您现在可以访问任何本地网络摄像头和麦克风。您可能还可以在浏览器外运行 Silverlight 4，它使您可以访问 COM 对象，并且您可以编写一个快速而简单的 COM 对象来包装串行端口访问。也就是说，我也同意上面人们所说的并非所有应用程序都属于浏览器的说法。

# java - 将 JPanel 导出为矢量图形

> ID：811916
> 
> 赞同：6
> 
> 时间：2009-05-01T15:40:17.717
> 
> 标签：java, swing, graphics, awt, vector-graphics

我想将我的 JPanel 中的图像导出为矢量图形文件，以便可以以高于屏幕的分辨率对其进行编辑和打印。本质上，我希望`paint()`使用将绘图命令保存到矢量图形文件中的目标 Graphics 来调用它的函数。

有什么好的，简单的方法可以做到这一点？推荐什么库？哪种矢量格式最好，为什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-01T15:56:09.237

查看[Java EPS Graphics2D 包](http://www.jibble.org/epsgraphics/)。

> 许多 Java 程序使用 Graphics2D 在屏幕上绘制内容，虽然将输出保存为 png 或 jpeg 文件很容易，但将其导出为 EPS 以包含在文档或纸张中会有点困难。
> 
> 这个包使整个过程变得非常简单，因为您可以像使用 Graphics2D 对象一样使用 EpsGraphics2D 对象。唯一的区别是所有实现的方法都会创建 EPS 输出，这意味着可以调整您绘制的图表的大小，而不会导致您在调整基于像素的图像（例如 JEPG 和 PNG 文件）大小时可能看到的任何锯齿状边缘。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-01T15:46:26.810

Apache [Batik](http://xmlgraphics.apache.org/batik/)将让您绘制到 Graphics2D 对象的专门实现，然后导出为可缩放矢量图形 (.svg) 文件。然后，您可以使用支持 SVG 的浏览器查看/处理/打印它（Firefox 会自然处理它，ISTR、IE 和其他人可以使用插件）。

请参阅[SVGGraphics2D](http://xmlgraphics.apache.org/batik/javadoc/org/apache/batik/svggen/SVGGraphics2D.html)对象（[此处](http://xmlgraphics.apache.org/batik/using/svg-generator.html)记录的过程）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-01T17:29:51.727

Pierre 提到的 Java EPS 看起来不错，但如果不是，您可能还想查看[FreeHEP Vector Graphics](http://java.freehep.org/vectorgraphics)。编写以允许在高能物理领域重用 Java，它包括一个矢量图形包，通过 Graphics2D 的实现完成。多年来，我们一直使用它非常成功地出口 EPS。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-11-01T11:26:30.863

我可以推荐[VectorGraphics2D](http://trac.erichseifert.de/vectorgraphics2d/)库 (LGPL)。虽然它不支持 Graphics2D 的所有功能，但我成功地将它用于我的项目。它为各种矢量文件格式提供 java.awt.Graphics2D 的实现。它只是将所有绘制操作导出到 EPS、SVG 或 PDF 文件。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-09-29T13:54:09.407

为具有相同需求的人提供的附加库：

*   对于 SVG，JFreeSVG 位于[http://www.jfree.org/jfreesvg/](http://www.jfree.org/jfreesvg/)
*   对于 PDF，OrsonPDF 位于[http://object-refinery.com/orsonpdf/index.html](http://object-refinery.com/orsonpdf/index.html)

这两个 GPLv3 都通过在[JFreeChart](http://www.jfree.org/jfreechart/)和[Orson Charts](http://object-refinery.com/orsoncharts/index.html)中的广泛使用进行了很好的测试。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-02-05T21:33:14.603

FreeHEP 似乎工作得很好，尽管它似乎不再被维护并且它的错误和论坛页面都消失了。只需几行，您就会得到一个弹出对话框，可以将任何组件保存为各种可扩展和常规图像格式。我们有一些具有挑战性的图像，使用 alpha 通道、旋转文本、由曲线界定的区域，并且它们保存得很好，使用 VectorGraphics2D 效果更好。

到目前为止，我看到的唯一问题是 jpeg 保存，我的所有图像都是黑色的。鉴于 png 可以工作，加上所有矢量模式，这对我们来说并不是很重要，但我相信这对某些人来说是个问题。

我必须添加这么多代码才能保存在所有这些模式中：

```
public static void showImage(Component comp) 
{
    try
    {
        ExportDialog export = new ExportDialog();
        export.showExportDialog( null, "Export view as ...", comp, "export" );
        System.err.println("Image save complete");

    }
    catch(Exception e)
    {
        e.printStackTrace();
    }
} 
```

还必须添加一堆库 jar。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-01T15:47:41.973

这基本上是不可能直接实现的，因为低级 java api 根据光栅（像素）工作，并且从不以矢量格式存储。（检查 java.awt.Graphics 的 API 以了解我的意思）。

有一些通用程序可以将光栅转换为矢量格式，这是我在快速搜索中找到的：http: [//autotrace.sourceforge.net/index.html](http://autotrace.sourceforge.net/index.html)

因此，使用这样的程序，您可以将问题分成两个较小的问题：

1.  将您的 JPanel 转换为位图或文件 ( [http://www.jguru.com/faq/view.jsp?EID=242020](http://www.jguru.com/faq/view.jsp?EID=242020) )
2.  对文件运行自动跟踪。

# html - 源文本包含简单的 HTML。如何在 MS Word 中简单地格式化文本？

> ID：811917
> 
> 赞同：0
> 
> 时间：2009-05-01T15:40:43.877
> 
> 标签：html, performance, formatting, automation, ms-word

我继承了一个项目，该项目将基本的 HTML 格式（即 - `<`b `>`、`<`i`>`标签）存储在数据库中并将其写入 Word 文档。这是我的第一个 Word 自动化作业，所以要温柔！

目前，有一个复杂的函数在文档完成后运行，用于搜索和替换这些标签。但是，由于这是在文档完成后运行的，因此在运行时确定的任何逻辑（即 - 在此处插入分页符）都可能导致灾难性的结果。例如，如果我有一大块粗体文本，这个粗体文本会占用更多空间并将换行符推到下一页，从而导致页面大部分为空白。

我相信解决此问题的方法是格式化来自数据库的文本，以便定位逻辑正确。我不想多次调用这个复杂的过程，因为它很耗时，而且我们的最终用户需要这个文档尽快。

有没有一种简单的方法可以将 HTML 格式的文本写入 Word 文档，而无需查找和替换每个支持的标签？我认为 Word 中会有一些东西可以自动处理这个问题。如果您能指出正确的方向，请提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T16:02:33.963

试试这个：

首先，将要插入的 HTML 保存为普通的“.htm”文件。

然后使用 Range 对象及其[InsertFile 方法](http://msdn.microsoft.com/en-us/library/bb217015.aspx)在任何给定位置插入“.htm”文件：

```
Dim r As Range

Set r = ActiveDocument.Range
r.InsertFile FileName:=TempFilePath, Link:=False, ConfirmConversions:=False 
```

Word 应该足够智能以处理 HTML 并自行完成所有格式转换。使用 CSS 来控制格式的更精细部分。

完成后删除“.htm”文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T16:04:46.173

也许您可以调用嵌入式 IE (IWebBrowser2) 来布局文本，然后作为富文本复制到剪贴板，最后作为富文本（格式化）粘贴到 Word。

# javascript - Selenium 在表单字段的 javascript 末尾添加奇怪的字符

> ID：811921
> 
> 赞同：1
> 
> 时间：2009-05-01T15:42:11.300
> 
> 标签：javascript, selenium

我正在尝试设置一个字段来预填充一组独特的字符，以便我可以自动生成测试帐户。由于系统的设置方式，名称字段必须是唯一的，并且不能包含数字字符。

我把这个 selenium 代码放在一起，它可以工作 99%，但是在好的代码末尾留下了额外的垃圾字符。

```
javascript{stringtime=''; 
nowtime=new Date().getTime().toString(); 
for ( var i in nowtime ) 
  { stringtime+=String.fromCharCode(parseInt(nowtime[i])+65 ); }; 
'test' + stringtime + '\0'} 
```

结果：testBCEBBJCBFBBAI + 一堆不会复制到这里的字符。它们看起来像一个盒子里的 4 个零。

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T15:51:44.600

排除末尾的 '\0' 字符，它显示在一个？，在 Selenium 中，我认为它的 javascript 引擎在处理 for(var i in nowtime) 时遇到了问题。试试这样：

```
javascript{
  stringtime= '';
  nowtime=new Date().getTime().toString();
  for(var i = 0; i < nowtime.length; i++){
    stringtime += String.fromCharCode(parseInt(nowtime[i])+65);
  }
  stringtime;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T15:49:22.687

这些字符是您的字体无法复制的标准 ASCII 之外的字符。这些数字表示它是哪个字符。如果它有 4 个零，那么它就是`\0`你最后添加的那个字符。我不懂语言，但看起来你不需要那种语言。

您的随机数生成器也有一点缺陷。看看这里：

[http://www.mediacollege.com/internet/javascript/number/random.html](http://www.mediacollege.com/internet/javascript/number/random.html)

# iphone - 在 iPhone 模拟器中从硬盘读取文件

> ID：811924
> 
> 赞同：6
> 
> 时间：2009-05-01T15:42:37.833
> 
> 标签：iphone, objective-c, cocoa-touch, file, ios-simulator

是否可以将文件（从我的正常文件系统）读取到在 iPhone 模拟器上运行的 iPhone 应用程序中？

我知道 iPhone 本身没有（用户可访问的）文件系统，但这只是用于测试，并且只会在模拟器中运行。

该文件将是一个文本文件，可以在应用程序运行时进行编辑，每次调用方法时都会读取该文件。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-01T16:11:31.493

是的，你可以，它在哪里并不重要。加载时只需给它一个绝对路径名（Xcode 在运行模拟器时不会识别不同的工作目录）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T15:57:26.783

是的，如果您的文件位于您的应用文件夹中，则可以这样做 ~/Library/Application Support/iPhone Simulator/User/Applications/ [您的应用文件夹] /Documents

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T15:45:07.877

不，您的应用程序在手机上的自己的沙箱中运行。不允许在它之外读取或写入。

编辑：我认为 CiNN 是正确的。只要您的代码保留在模拟器上，您就不会在处理本地驱动器上的文件时遇到问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-02T13:58:48.907

我个人认为最简单的方法是在模拟器中的 Safari 中输入“file:///”，如果那是您要找的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-02T14:18:08.023

还应该注意的是，您可以反过来执行此操作——您可以从硬盘驱动器中获取应用程序在模拟器中创建的文件。这是检查结果（数据、图像等）的好方法，无需在应用程序中构建数据“查看器”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-28T20:33:50.047

仅供参考，“较新”的 sds 版本将执行此操作...搜索 iPad，您会找到它。（出于显而易见的原因，我不能在这里提供更多细节）祝你好运。

# c - memcmp C 实现 - 这个有任何逻辑错误

> ID：811926
> 
> 赞同：-2
> 
> 时间：2009-05-01T15:43:06.070
> 
> 标签：c

memcmp C 实现 - 这个有任何逻辑错误吗？

我正在寻找 memcmp() 的实现，我找到了这个代码片段，但它清楚地标记了代码片段存在 1 个逻辑错误。你能帮我找出逻辑错误吗？

基本上，我用不同的输入针对 memcmp() 的 string.h 库实现测试了这段代码，但预期的输出总是与函数的库版本相同。

这是代码片段：

```
#include <stdio.h>
#include <string.h>

int memcmp_test(const char *cs, const char *ct, size_t n)
{
  size_t i;   

  for (i = 0; i < n; i++, cs++, ct++)
  {
    if (*cs < *ct)
    {
      return -1;
    }
    else if (*cs > *ct)
    {
      return 1;
    }
    else
    {
      return 0;
    }
  }
} 

int main()
{
    int ret_val = 20; //initialize with non-zero value 

    char *string1 = "china";
    char *string2 = "korea";

    ret_val = memcmp_test(string1,string2,5); 

    printf ("ret_val is = %d",ret_val);

    getchar();
    return 0;
} 
```

我用两个示例字符串运行程序，程序将在比较两个字符串的第一个字符后返回。在上述情况下，ret_val 为 -1。

上述代码片段应符合的 memcmp() 定义为：

“C”库函数 memcmp 的定义是 int memcmp(const char *cs, const char *ct, size_t n)

比较 cs 的前 n 个字符和 ct 的前 n 个字符。如果 cs < ct，则返回 < 0。如果 cs > ct，则返回 > 0。如果 cs == ct，则返回 0。

肯定有逻辑错误，你能帮我找到它吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-01T15:48:11.830

正如现在所写的那样，此代码将仅测试输入的第一个字节。需要将其`else return 0`移出循环，`return 0`最后离开：

```
 for (i = 0; i < n; i++, cs++, ct++)
  {
    if (*cs < *ct)
    {
      return -1;
    }
    else if (*cs > *ct)
    {
      return 1;
    }
  }
  return 0;
 } 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-01T15:47:39.740

我想既然`char`签名是实现定义的，你可以进行比较`unsigned`：

```
int memcmp_test(const char *cs_in, const char *ct_in, size_t n)
{
  size_t i;  
  const unsigned char * cs = (const unsigned char*) cs_in;
  const unsigned char * ct = (const unsigned char*) ct_in;

  for (i = 0; i < n; i++, cs++, ct++)
  {
    if (*cs < *ct)
    {
      return -1;
    }
    else if (*cs > *ct)
    {
      return 1;
    }
  }
  return 0;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-01T15:45:55.550

看看你的 for 循环。它只检查一个字符。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-01T15:46:34.160

严格来说，签名是错误的。[正确](http://www.opengroup.org/onlinepubs/000095399/functions/memcmp.html)的是：

```
int memcmp(const void *s1, const void *s2, size_t n); 
```

您的代码比较`c`并`k`发现`c`小于`k`尽职地返回-1。但是，如果这两个相等，您将得到不正确的结果，因为您提前返回。

如果您阅读文档，您会发现：

> 非零返回值的符号应由在被比较的对象中不同的第一对字节（均解释为类型无符号字符）的值之间的差异符号确定

这基本上意味着您通过返回保留符号的东西来做正确的事情 `('c' - 'k')`。

可以在[此处](http://www.openmash.org/lxr/source/compat/memcmp.c?c=tcl8.3)找到更简单的实现。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-01T15:48:28.163

返回0；仅在比较第一个字符后发生。它应该放在循环之外。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-05-09T14:38:34.083

这个片段非常适合我！！

```
#include <stdio.h>
#include <string.h>

int memcmp_test(const char *cs, const char *ct, size_t n)
{
 size_t i;   

 for (i = 0; i < n; i++, cs++, ct++)
 {
if (*cs < *ct)
{
  return -1;
}
else if (*cs > *ct)
{
  return 1;
}
}

  return 0;  
  } 
int main()
{
int ret_val = 20; //initialize with non-zero value 
const char *string1 = "DWgaOtP12df0";
const char *string2 = "DWGAOTP12DF0";
ret_val = memcmp_test(string1,string2,5);
printf ("ret_val is = %d",ret_val);
getchar();
return 0;
} 
```

# sql-server - SQL Server 2005/2008 国际实时可用性

> ID：811928
> 
> 赞同：0
> 
> 时间：2009-05-01T15:44:05.867
> 
> 标签：sql-server, database, replication, data-synchronization

我的公司最近在新加坡开设了办事处。我使用 SQL Server 2005 后端开发我们内部用于管理公司的 Web 应用程序。由于从新加坡通过网络访问速度较慢，我们向他们运送了一个服务器，该服务器将托管 Web 应用程序和数据库的本地副本，我们希望保持他们的本地版本的数据库与我们的同步。美国应用程序和新加坡应用程序都可以读取/写入数据。

合并复制是解决这个问题的正确方法吗？这是我一直在调查的路径，它似乎最适合我们想要的。SQL Server 2008 中有更好的东西吗？您为国际合作实施了哪些类型的数据库可用性解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T16:56:03.070

如果两个位置的某些人必须更新任何数据，则合并复制是一种可行的方法。但...

在以下情况下，我可以推荐使用点对点复制：

*   Office1（美国？）只需要更新/删除 Office1 应用程序插入的记录。

*   Office2（新加坡）只需要更新/删除由 Office2 应用程序插入的记录。

两个办事处都可以查询所有数据。

Quote: 在对等复制中，您需要了解的最基本概念是每台服务器都包含所有数据，但每台服务器只负责更新自己的数据子集。因此，每台服务器都携带相同的模式，并且每台服务器都是其他服务器上发生的所有更改的订阅者，同时也是其自己更改数据的发布者。当一台服务器上的数据发生变化时，这些变化会传递给对等网络中的所有订阅者。每个服务器都包含和更新特定于其地理位置的数据，并且还可以查看来自其他位置的所有数据。对等复制的一个关键部分是每个服务器负责更改自己的数据集，并且没有其他位置可以更改该数据集中的任何数据。如果违反此规则，数据可能会在两个地方更改，

您可以在这里找到更多信息： [http ://www.sqlmag.com/Article/ArticleID/49241/sql_server_49241.html](http://www.sqlmag.com/Article/ArticleID/49241/sql_server_49241.html)

[http://technet.microsoft.com/en-us/magazine/2006.07.insidemsft.aspx](http://technet.microsoft.com/en-us/magazine/2006.07.insidemsft.aspx)

[http://www.sql-server-performance.com/articles/dba/peer-to-peer_replication_p1.aspx](http://www.sql-server-performance.com/articles/dba/peer-to-peer_replication_p1.aspx)

如何实施。

必须从您必须复制的两个位置更新的表，例如：

```
TableOrders1 (OrderID int IDENTITY(1,2) NOT NULL, Col1 int, Col1 nvarchar(), etc.) 
TableOrders2 (OrderID int IDENTITY(2,2) NOT NULL, Col1 int, Col1 nvarchar(), etc.) 
```

然后使用点对点复制将数据从 TableOrders1 发送到 Office2，将数据从 TableOrders2 发送到 Office1，依此类推……</p>

要查询数据，您可以创建一个视图。

# mysql - innodb 和 XtraDB 之间有明显的区别吗？

> ID：811930
> 
> 赞同：2
> 
> 时间：2009-05-01T15:44:17.080
> 
> 标签：mysql, innodb, xtradb

今天在 serverfault 上我读到了 XtraDB。我读到它是 innoDB 的一个分支，并且很奇怪差异有多大？如果我尝试一下，我会注意到这种变化还是你认为它只是浪费时间？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-08-29T04:13:51.630

XtraDB 旨在成为替代品。大多数增强功能要么属于更好的诊断，要么属于改进的可扩展性。

您可以在 Percona 博客上查看增强列表： [http ://www.percona.com/docs/wiki/percona-xtradb:patch:start](http://www.percona.com/docs/wiki/percona-xtradb:patch:start)

试试 XtraDB 看看也没什么坏处。如果您不喜欢它，文件格式不会改变（除非您启用额外的撤消槽），因此很容易切换回来。

# linux - 什么是 Tomcat 在 Linux 上的 DNS 等价物？

> ID：811939
> 
> 赞同：-2
> 
> 时间：2009-05-01T15:46:53.050
> 
> 标签：linux, dns, amazon-ec2

我正在为我们的服务器迁移到 Amazon EC2，需要尝试内部 DNS 选项。我正在 DNS 区域中寻找相当于 Tomcat（一个众所周知的易于使用的标准 servlet 容器）。BIND 是我唯一熟悉的名字，但我想知道是否还有其他“更好”的选择，或者我应该选择那个。

我们的服务器目前正在运行 CentOS。

这最终将成为一个生产环境，因此需要稳定的软件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T15:51:08.860

BIND 是常用的名称服务器软件，但也有[djbdns](http://cr.yp.to/djbdns.html "djbdns")和其他一些软件。

如果你走 BIND 路线，我还必须推荐这本书 DNS 和 BIND，它在当时对我有很大帮助。不过，考虑到 BIND 的最新更新，我希望它已经更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T16:01:39.990

我建议使用 Bind，尽管一开始的语法有点吓人。当我第一次学习 Bind 时，我使用了本指南：http: [//tldp.org/HOWTO/DNS-HOWTO.html](http://tldp.org/HOWTO/DNS-HOWTO.html)

还有其他选项，例如 PowerDNS，如果您使用的是大型环境，您可能需要考虑使用 LDAP 作为后端。

在 CentOS 上，最简单的方法可能是使用 yum 安装 bind，然后通过上面的指南。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-02T00:23:21.437

我推荐 BIND ，因为它是最好的文档和最容易理解的，以及[NSD](http://www.nlnetlabs.nl/projects/nsd/)，因为它很好而且免费。

特别是，NSD*只是*一个权威的名称服务器，因此不必像其他试图提供所有不同 DNS 功能的服务器那样携带繁琐的东西。

我真的不能推荐 djbdns - 尽管它现在在公共领域，但作者只是拒绝实现标准 DNS 协议的许多部分（例如 AXFR）。

# visual-studio-2008 - 2005 年打开 C# 2008

> ID：811940
> 
> 赞同：3
> 
> 时间：2009-05-01T15:47:30.617
> 
> 标签：visual-studio-2008, visual-studio-2005

我的家用电脑上有 Visual C# 2008，但在学校的电脑上有 2005。是否有补丁或我可以下载的东西以便能够在 2005 上运行 2008 文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T21:30:33.210

您还可以查看降级应用程序：http: [//mises.org/Community/blogs/misestech/archive/2008/02/28/visual-studio-2008-to-2005-downgrade-utility.aspx](http://mises.org/Community/blogs/misestech/archive/2008/02/28/visual-studio-2008-to-2005-downgrade-utility.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-01T15:50:13.417

您的大部分代码应该可以正常工作。在 Visual Studio 2005 中不起作用的东西是 C# 3 中的任何新功能，因为这些语言功能需要 C# 3 编译器。

以下是 C# 3 无法使用 C# 2 编译器构建的内容的非详尽列表：

> lambda 表达式
> 自动实现的属性
> 对象初始化器
> 集合初始化器
> 扩展方法
> 部分方法
> 隐式类型 局部变量
> 匿名类型

（请随时扩展此列表...）

也许最好的办法是在学校下载[Visual C# 2008 Express Edition](http://www.microsoft.com/express/vcsharp/)（如果可以的话），这样您就可以自由地共享整个项目。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-01T15:52:28.577

我知道的最快的事情是创建一个新的空 VS 2005 项目，然后右键单击它，选择“添加现有项目...”，然后从 VS 2008 项目中选择所有代码。就像 Andrew 说的，只要你不使用 3.0 或更高版本的东西，它应该编译得很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T15:57:19.860

**如果您是学生，您可以**去[Microsoft Dreamspark](https://www.dreamspark.com/default.aspx)并免费获得**Visual Studio 2005 Professional**吗？它将与您的升级版本（VS2008）并行运行。这样，当您在家编辑项目时，您可以在学校继续处理它们，并且项目文件仍然兼容。

 **否则，Visual Studio 版本之间的解决方案文件不会向下兼容。您最好的选择是在 VS2005 中创建一个新项目，添加源文件，然后“替换”任何引用 .NET 3.0 或 .NET 3.5 的代码。但是如果你在VS2008中继续编辑，你每次回学校都要重复这个过程。呸。

# c++ - /MT 和 /MD 构建崩溃，但仅在未附加调试器时：如何调试？

> ID：811951
> 
> 赞同：9
> 
> 时间：2009-05-01T15:49:16.460
> 
> 标签：c++, visual-studio, visual-studio-2005, boost

我有一个小型单线程 C++ 应用程序，使用 Visual Studio 2005 编译和链接，它使用 boost（crc、program_options 和 tokenizer）、少量 STL 和各种其他系统头文件。

（其主要目的是读取 .csv 并生成自定义二进制 .dat 和成对的 .h 声明“解释”.dat 格式的结构。）

该工具在调试器外部运行时崩溃（NULL 访问冲突），仅在发布时。例如，按 F5 不会导致工具崩溃，而 Ctrl-F5 会。当我重新附加调试器时，我得到了这个堆栈：

```
ntdll.dll!_RtlAllocateHeap@12()  + 0x26916 bytes    
csv2bin.exe!malloc(unsigned int size=0x00000014)  Line 163 + 0x63 bytes C
csv2bin.exe!operator new(unsigned int size=0x00000014)  Line 59 + 0x8 bytes C++
>csv2bin.exe!Record::addField(const char * string=0x0034aac8)  Line 62 + 0x7 bytes  C++
csv2bin.exe!main(int argc=0x00000007, char * * argv=0x00343998)  Line 253   C++
csv2bin.exe!__tmainCRTStartup()  Line 327 + 0x12 bytes  C 
```

它崩溃的线路是一个看起来有点无害的分配：

```
pField = new NumberField(this, static_cast<NumberFieldInfo*>(pFieldInfo)); 
```

...我不相信它已经到达构造函数，它只是在跳转到构造函数之前分配内存。到崩溃时，它还执行了数十次此代码，通常在一致（但不可疑）的位置。

使用 /MTd 或 /MDd（调试运行时）编译时问题消失，使用 /MT 或 /MD 时问题又回来了。

NULL 是从堆栈中加载的，我可以在内存视图中看到它。_RtlAllocateHeap@12 + 0x26916 字节似乎是一个*巨大*的偏移量，就像进行了不正确的跳转。

我已经尝试`_HAS_ITERATOR_DEBUGGING`过调试版本，但没有发现任何可疑之处。

在 Record::addField 的开头和结尾删除 HeapValidate 会显示一个 OK 堆，直到它崩溃。

这曾经有效——我不完全确定从现在到我们上次编译该工具（可能是几年前，可能在较旧的 VS 下）之间发生了什么变化。我们尝试了旧版本的 boost (1.36 vs 1.38)。

在返回手动调查代码或将其提供给 PC-Lint 并梳理其输出之前，有什么关于如何有效调试的建议吗？

[如果您在评论中请求信息，我很乐意用更多信息更新问题。]

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-01T15:55:48.770

一个鲜为人知的区别是运行是否附加调试器是操作系统调试堆（另请参阅[为什么我的代码在附加调试器时运行缓慢](https://stackoverflow.com/questions/1060337/why-does-my-stl-code-run-so-slowly-when-i-have-the-debugger-ide-attached/1060929#1060929)？）。您可以使用环境变量 _NO_DEBUG_HEAP 关闭调试堆。您可以在计算机属性或 Visual Studio 的项目设置中指定此设置。

关闭调试堆后，即使附加了调试器，您也应该看到相同的崩溃。

也就是说，请注意内存损坏可能很难调试，因为损坏的真正原因（如某些缓冲区溢出）可能与您看到的症状（崩溃）相去甚远。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T17:22:54.817

new 或 malloc 内部崩溃通常表明 malloc 实现的（内部）结构已损坏。这大部分时间是通过写过去的分配（缓冲区溢出）来完成的。然后在下一次调用 new 或 malloc 时，应用程序崩溃，因为内部结构现在包含无效数据。

检查您是否可以覆盖任何以前分配的空间。

如果您的应用程序是可移植的，您可以尝试在 Linux 上构建它并在[Valgrind](http://en.wikipedia.org/wiki/Valgrind)下运行它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-01T19:43:12.983

一旦我在环境中有 _NO_DEBUG_HEAP=1 ，[应用程序验证器对于解决这个问题非常有用，请在此处查看接受的答案：](http://www.microsoft.com/downloads/details.aspx?FamilyID=c4a25ab9-649d-4a1b-b4a7-c9d8b095df18&displaylang=en)[查找上次释放内存的位置？](https://stackoverflow.com/questions/691794/finding-where-memory-was-last-freed)

可能还值得一提[pageheap](http://support.microsoft.com/kb/286470)，这是我在查看 Application Verifier 时发现的。看起来它涵盖了一些类似的领域。

（仅供参考，这是一个单字符缓冲区溢出：

```
m_pEnumName = (char*)malloc(strlen(data) /* missing +1 here */);
strcpy(m_pEnumName, data); 
```

...还有一个不`strcpy`直接使用的可笑的好论据。）

# .net - 如何在 ASP.NET MVC 中记录未处理的异常？

> ID：811958
> 
> 赞同：7
> 
> 时间：2009-05-01T15:50:17.817
> 
> 标签：.net, asp.net, asp.net-mvc, exception, global-asax

这是我在 Global.asax.vb 中尝试做的事情：

```
Public Class MvcApplication
    Inherits System.Web.HttpApplication

    Shared Sub RegisterRoutes(ByVal routes As RouteCollection)
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}")
        routes.MapRoute( _
            "Error", _
            "error.html", _
            New With {.controller = "Error", _
                      .action = "FriendlyError"} _
        )
        ...
        'other routes go here'
        ...
    End Sub

    Sub Application_Start()
        RegisterRoutes(RouteTable.Routes)
    End Sub

    Sub Application_Error(ByVal sender As Object, ByVal e As EventArgs)
        ...
        'code here logs the unhandled exception and sends an email alert'
        ...
        Server.Transfer("http://www.example.com/error.html")
    End Sub

End Class 
```

但是那个 Server.Transfer 失败了：

> `Invalid path for child request 'http://www.example.com/error.html'. A virtual path is expected.`

我该如何解决？或者，我有什么更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-01T15:57:11.030

我刚刚在 Scott Hanselman 的名为 ELMAH 的博客上找到了这个，[它](http://www.hanselman.com/blog/ELMAHErrorLoggingModulesAndHandlersForASPNETAndMVCToo.aspx)是[一个](http://www.raboof.com/projects/Elmah/)错误记录器/处理程序，您可以使用它而无需更改代码。您可能想研究一下，因为它似乎与 MVC 很好地配合使用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T16:04:20.123

[ELMAH](http://code.google.com/p/elmah/)是一个出色的错误处理程序，用于捕获未处理的异常。它通过 HttpModules 无缝插入到您的 Web 应用程序中，并具有各种通知和日志记录选项。

**特征：**

*   SQL、XML、SQLite、InMemory 日志记录
*   电子邮件通知
*   RSS订阅
*   详细的！记录异常
*   易于集成
*   错误信号 - 在为用户“死得好”的同时向错误处理程序发出信号

仅供参考，所以使用 ELMAH，尽管是分叉版本。这是最好的[架构解释](http://msdn.microsoft.com/en-us/library/aa479332.aspx)和[设置教程](http://dotnetslackers.com/articles/aspnet/ErrorLoggingModulesAndHandlers.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T15:54:59.660

您必须指定一个虚拟路径，即相对于应用程序库的路径（即没有应用程序外部的路径），例如： Server.Transfer("error.html") 或 Server.Transfer("/error.html ") 或 Server.Transfer("~/error.html")

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-01T16:20:30.397

默认情况下，ASP.NET MVC 应用程序有一个视图 Shared/Error.aspx，继承自

```
System.Web.Mvc.ViewPage<System.Web.Mvc.HandleErrorInfo> 
```

如果您的控制器使用属性 [HandleError]，则所有异常将继续冒泡，直到被捕获，并且它们最终会出现在该页面上。

我只是添加了一个内联 Page_Load （在这种情况下有效，因为它是行尾）：

```
<script runat="server">
  Sub Page_Load(ByVal Sender As System.Object, ByVal e As System.EventArgs)
    MyExceptionHandlerService.LogException("exceptionsource", this.Model.Exception)
  End Sub
</script> 
```

之后，友好的“对不起……”信息。看起来 ELMAH 确实更强大，但对于我的需要，这已经足够了。

# shoes - 如何在鞋子的流槽中获得垂直对齐？

> ID：811968
> 
> 赞同：2
> 
> 时间：2009-05-01T15:52:01.807
> 
> 标签：shoes, vertical-alignment

插槽中的默认垂直对齐`flow`显然是顶部对齐元素。这是一个示例：

```
Shoes.app (:title => "Vertical Alignment", :width => 300, :height => 150) do
  background "#DFA"
  flow :margin => 30 do
    title "BIG"
    tagline "MEDIUM"
    inscription "SMALL"
  end
end 
```

如何让`flow`插槽居中对齐其元素而不计算`:rise`每个元素的值？我本来期望插槽的垂直对齐样式和`flow`插槽的水平对齐样式`stack`，但我没有看到类似的东西。我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T16:15:49.907

据我所知，垂直对齐没有风格。水平对齐在堆栈中很有用：

```
Shoes.app (:title => "Horizontal Alignment", :width => 300, :height => 150) do
  background "#DFA"
  stack :margin => 30 do
    title "BIG", :align => 'center'
    tagline "MEDIUM", :align => 'center'
    inscription "SMALL", :align => 'center'
  end
end 
```

请记住，鞋子仍然是一项正在进行的工作，所以 _why 最终可能会解决它。

# c++ - 使用 COM 搜索 Outlook 联系人？

> ID：811974
> 
> 赞同：1
> 
> 时间：2009-05-01T15:53:47.510
> 
> 标签：c++, com, outlook, atl, wtl

我想在我的 ATL/WTL 应用程序中添加对搜索本地 Outlook 联系人的支持。有谁知道 Outlook COM 接口（Office 2003 或更高版本）允许您搜索联系人？我已经有了 LDAP 查找支持，但用户也希望能够搜索他们的私人联系人。

欢迎任何信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T17:23:33.350

要访问联系人，您首先必须使用应用程序的 GetNamespace 函数获取一个命名空间对象，将“MAPI”作为命名空间名称传递。

然后使用命名空间的 GetDefaultFolder 函数，它为您提供了一个包含 Items 属性的 MAPIFolder 接口。

接下来，您对项目调用 Find 函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T20:43:46.770

您必须使用 MAPI 才能获得访问权限

在这里您可以找到 MAPI 包装器

[http://www.codeproject.com/KB/IP/CMapiEx.aspx](http://www.codeproject.com/KB/IP/CMapiEx.aspx)

你也应该使用 Outlookspy，它非常有用的插件可以向你展示大多数 MAPI 接口和 Outlook 对象模型

您应该从 MSDN 阅读有关 MAPI 函数的更多信息

[http://msdn.microsoft.com/en-us/library/aa142548(EXCHG.65).aspx](http://msdn.microsoft.com/en-us/library/aa142548(EXCHG.65).aspx)

# c# - 上传时加密文件内容

> ID：811988
> 
> 赞同：0
> 
> 时间：2009-05-01T15:56:55.117
> 
> 标签：c#, asp.net, encryption

我正在使用 asp.net 的 FileUpload 控件将 word 文件上传到服务器。我想加密这个文件的内容（使用我们的自定义加密 API），然后将其保存在服务器中。我如何做到这一点？我的方法应该是什么？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-01T16:14:39.550

无论您在服务器端做什么，请务必意识到，当数据通过网络传输时，它不会使用您的自定义 API 进行加密。您需要使用 ssl 连接上传文件，以确保数据传输安全。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-01T16:01:11.987

如果你有自己的自定义加密API，你应该使用它来加密一个临时文件，然后上传临时加密结果，上传完成后将其删除。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-01T16:01:26.243

FileUpload 控件为您提供文件的句柄。从文件流中读取数据，对其进行加密并将其写入 FileStream。如果加密过程是 CPU 密集型和/或花费大量时间，请将文件保存在临时目录中并启动一个新线程来读取文件、加密其内容、将其保存到新文件并删除临时文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-01T16:05:13.927

也许您应该将自己的加密器编写为应用程序，然后在服务器上解密该文件本文可以帮助您：[文件加密/解密](http://www.codeproject.com/KB/security/fileencryptdecrypt.aspx)

# java - 如何创建一个弹出busy标签并且在执行时可以取消的任务？

> ID：811998
> 
> 赞同：2
> 
> 时间：2009-05-01T16:00:53.970
> 
> 标签：java, user-interface, swing, concurrency

我正在使用 swing 用 java (1.6) 编写应用程序。我目前在我的程序内容区域的 JXLayer 上有一个 JXBusyLabel，它充当忙碌指示器。我想提供一种方法，让与我一起工作的其他人创建一个在执行时会弹出繁忙标签的任务。问题是，任务必须是可取消的。展示我想要的功能的最佳方式是什么？

我提出的一些想法：

1.  对 setBusy() 的原始访问
    这对我来说显然是最简单的，但需要用户了解并理解摆动线程问题。
2.  public <T> Future<T> execute(Callable<T>)
    将可调用对象包装在一个 FutureValue 中，该 FutureValue 在单独的线程上运行（）并返回该 FutureValue。那么问题就变成了，如何跟踪所有生成的 FutureValue 以及如何确保它们可以被取消。（例如 cancel(true) 总是取消）

我以前从未在 Java 中使用过并发包，当我“学习”Java 时它也不存在。因此，我对实现此功能的全新和不同方式持开放态度。

编辑：澄清我的问题。我知道 SwingWorker。我只是从未使用过它。我想知道的是：
给定一个 Callable（Java 版本的闭包？）我怎么能：

1.  将 call() 的值返回给没有阻塞的用户（我想我需要为此使用 Future）
2.  告诉 JXLayer 锁定（启动painter），执行提供的可调用对象，然后解锁 JXLayer（停止painter）
3.  确保无论哪个线程调用我的 busyExec() 函数，GUI 都保持响应并且后台任务完成。（注意：如果我返回某种 Future 对象并且他们在事件线程上调用 get()，它可以/将阻塞，这没关系）

我想我的主要绊脚石是如何实现#2。我应该让busyExec() 分离一个新线程，直到没有后台任务正在运行？我应该尝试某种队列。是否已经有一个对象可以为我完成这一切？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T16:08:03.560

( [`SwingWorker`](http://java.sun.com/javase/6/docs/api/javax/swing/SwingWorker.html)Java 6) 实现[`Future`](http://java.sun.com/javase/6/docs/api/java/util/concurrent/Future.html)，因此它似乎能够通过该[`cancel`](http://java.sun.com/javase/6/docs/api/javax/swing/SwingWorker.html#cancel(boolean))方法取消任务。

[有关Java 教程的](http://java.sun.com/docs/books/tutorial/index.html)`SwingWorker`更多信息：

*   [课程：Swing 中的并发性](http://java.sun.com/docs/books/tutorial/uiswing/concurrency/index.html)
    *   [工作线程和 SwingWorker](http://java.sun.com/docs/books/tutorial/uiswing/concurrency/worker.html)
    *   [取消后台任务](http://java.sun.com/docs/books/tutorial/uiswing/concurrency/cancel.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-06T01:30:32.210

好的。对于任何对此感兴趣的人，我目前正在使用它来实现我的请求。

我有一个采用 Callable<T> 的方法。然后它创建一个 FutureTask<T>，这将作为一个 Future<T> 返回给调用者。JXBusyLabel 和 JXLayer 被告知开始绘制并锁定 ui。FutureValue 和 Thread（见下文）在一个特殊列表中排队。创建一个 Runnable：调用 FutureTask 上的 run()，从列表中删除 FutureValue（和线程），如果列表为空，则解锁 JXLayer 并停止 JXBusyLabel。此 Runnable 在具有正常优先级的新线程中启动。

当用户点击取消按钮时。列表被迭代，并且 FutureTasks 都被取消并从列表中删除，如果它们可以被取消的话。首先尝试取消（假），然后取消（真）。如果这两种方法都失败了，则会提示用户一个警告，询问他们是否要 Thread.stop() 任务并解释这可能会使应用程序不稳定。如果是，则停止（）运行任务的线程。这可能会导致应用程序关闭。在所有情况下，UI 都是解锁的。

其他团队成员的文档声明他们必须知道任务可以被终止。在 isDone() 为真之前，他们不能调用 get()。他们被明确告知，这基本上会迫使他们阻塞，直到任务完成或取消。所以他们不能从事件调度线程中调用它。

仍然欢迎其他解决方案

# mercurial - 将 DVCS 与 Visual Source Safe 相结合

> ID：811999
> 
> 赞同：16
> 
> 时间：2009-05-01T16:00:54.717
> 
> 标签：mercurial, visual-sourcesafe, dvcs, visual-sourcesafe-2005

我被迫在工作中使用 Visual Source Safe 2005。我想将它与 DVCS 结合起来，这样我就可以在本地签入文件，而不会在出现错误或无法编译时干扰我的同事。

在我对 Mercurial 的尝试中，它可以工作，但会导致一些奇怪的问题。也就是说，它认为其他人已经签出了我签出的文件。

以下是我应该如何管理它的想法：

1.  禁用自动结帐。
2.  在 Mercurial 本地工作
3.  当我准备好推送我的更改时...
    1.  克隆我的 Mercurial 存储库。
    2.  更新我的 Visual Source Safe 存储库
    3.  使用 Mercurial 拉取并合并两个存储库。
    4.  将所有内容检查到 Visual Source Safe。

这听起来合理吗？我总是听到关于 VSS 的坏消息，这是否只是要求我亲眼看到这些问题？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-04T21:53:43.453

布拉斯科

我发现了同样的问题。我想更改文件并在需要时合并它们，而不是等待其他开发人员解锁它。对我有用的解决方案是：

1）获取一个VSS项目的最新版本（我把所有VSS项目都放在vss下）：

```
c:\vss\projectA 
```

2A) 使用 Mercurial 初始化

```
cd vss\projectA
C:\vss\projectA>hg init 
```

2B）将项目克隆到可以随意更改的地方

```
hg clone vss\projectA myProjects\projectA 
```

3) 从 VSS 副本中获取最新更改（如果您来自 1 和 2，请跳过）

```
C:\myProjects\projectA>hg pull
C:\myProjects\projectA>hg update
(solve conflicts if any) 
```

4) 随意使用克隆版本。稍后，将您的工作推送到 vss 副本：

```
C:\myProjects\projectA>hg push
(don't run hg update yet, wait for VSS latestes version) 
```

5) 现在，将所有文件签出到 VSS 项目

6) 在 VSS 项目上运行“hg update”以将您的更改合并到最新的 VSS 更改。

```
C:\vss\projectA>hg update
(if there are conflicts, resolve them) 
```

7) 提交更改

```
C:\vss\projectA>hg commit 
```

8) 执行 VSS 签入（将锁释放给其他人）返回第 3 步。然后永远重复第 3-8 步... ;-)

通过这种方式，您可以使用良好的版本控制系统，同时仍然能够与遗留项目“对话”。您还可以享受：a）锁定文件没问题 b）您可以与知道如何使用 Hg 的其他人共享您的存储库 c）制作分支等

请注意首先更新/解决冲突，测试然后执行 VSS 签入

干杯，路易斯*************