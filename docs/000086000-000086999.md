# StackOverflow 问答 000086000-000086999

# delphi - 在Delphi中，你怎么能以不同的形式以不同的货币显示货币数据类型呢？

> ID：86002
> 
> 赞同：7
> 
> 时间：2008-09-17T18:10:52.200
> 
> 标签：delphi, finance

我需要编写一个 Delphi 应用程序，从数据库中的各种表中提取条目，不同的条目将使用不同的货币。因此，我需要为每种货币数据类型（$、英镑、欧元等）显示不同的小数位数和不同的货币字符，具体取决于我加载的项目的货币。

有没有办法几乎在全球范围内更改货币，即表格中显示的所有货币数据？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-17T20:31:42.860

即使使用相同的货币，您也可能必须以不同的格式显示值（例如分隔符），因此我建议您将 LOCALE 而不是货币仅与您的值相关联。
您可以使用一个简单的整数来保存 LCID（区域设置 ID）。
请参阅此处的列表：http: [//msdn.microsoft.com/en-us/library/0h88fahh.aspx](http://msdn.microsoft.com/en-us/library/0h88fahh.aspx)

然后显示值，使用类似：

```
function CurrFormatFromLCID(const AValue: Currency; const LCID: Integer = LOCALE_SYSTEM_DEFAULT): string;
var
  AFormatSettings: TFormatSettings;
begin
  GetLocaleFormatSettings(LCID, AFormatSettings);
  Result := CurrToStrF(AValue, ffCurrency, AFormatSettings.CurrencyDecimals, AFormatSettings);
end;

function USCurrFormat(const AValue: Currency): string;
begin
  Result := CurrFormatFromLCID(AValue, 1033); //1033 = US_LCID
end;

function FrenchCurrFormat(const AValue: Currency): string;
begin
  Result := CurrFormatFromLCID(AValue, 1036); //1036 = French_LCID
end;

procedure TestIt;
var
  val: Currency;
begin
  val:=1234.56;
  ShowMessage('US: ' + USCurrFormat(val));
  ShowMessage('FR: ' + FrenchCurrFormat(val));
  ShowMessage('GB: ' + CurrFormatFromLCID(val, 2057)); // 2057 = GB_LCID
  ShowMessage('def: ' + CurrFormatFromLCID(val));
end; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-17T18:46:16.810

我会使用 SysUtils.CurrToStr(Value: Currency; var FormatSettings: TFormatSettings): string;

我会设置一个 TFormatSettings 数组，每个位置都配置为反映您的应用程序支持的每种货币。您需要为每个数组位置设置 TFormat 设置的以下字段：CurrencyString、CurrencyFormat、NegCurrFormat、ThousandSeparator、DecimalSeparator 和 CurrencyDecimals。

# java - 测量来自 Servlet 的总网络传输时间

> ID：86008
> 
> 赞同：1
> 
> 时间：2008-09-17T18:11:54.770
> 
> 标签：java, tomcat, servlets, time, sockets

我如何衡量客户等待请求的时间。

在服务器端很容易，例如通过过滤器。但是如果我们想计算包括延迟和数据传输在内的总时间，那就很难了。

是否可以访问底层套接字以查看请求何时完成？还是有必要做一些javascript技巧？也许通过浏览器和服务器之间的时钟同步？这个任务有任何预制的javascript吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T18:27:36.810

如果您想从浏览器测量它以模拟任何客户端请求，您可以在 firebug 中查看 net 选项卡，以查看下载每个页面所需的时间和下载顺序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T18:46:57.107

您可以包装 HttpServletResponse 对象和 HttpServletResponse 返回的 OutputStream。当输出开始写入时，您可以设置 startDate，当它停止（或刷新等）时，您可以设置 stopDate。

这可用于计算将所有数据流式传输回客户端所需的时间长度。

我们在我们的应用程序中使用它，并且这些数字看起来很合理。

编辑：您可以在 ServletFilter 中设置开始日期以获取客户端等待的时间长度。我给了你将输出写入客户端所需的时间长度。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T18:28:51.640

您无法完全从服务器端知道客户端必须等待多长时间。你需要一些 JavaScript。

您不想同步客户端和服务器时钟，这太过分了。只需测量客户端发出请求和完成显示响应之间的时间。

如果客户端是 AJAX，这很容易：调用 new Date().getTime() 以获取发出请求的时间（以毫秒为单位），并将其与解析结果后的时间进行比较。然后在后台将此时间信息发送到服务器。

对于非 AJAX 应用程序，当用户单击请求时，使用 JavaScript 将当前时间戳（从客户端的角度）与查询一起发送到服务器，并在结果页面被重新加载。在该页面的 onLoad 处理程序中，测量总经过的时间，然后将其发送回服务器 - 使用 XmlHttpRequest 或在向服务器发出的下一个请求附加额外参数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T18:26:57.857

您可以设置一个 0 字节的套接字发送缓冲区（我并不完全推荐这样做），这样当您对 HttpResponse.send() 的阻塞调用时，您可以更清楚地了解最后一个字节何时离开，但不包括旅行时间. ***Ekk——***即使提到它，我也感到不安。您可以使用连接器特定设置在 Tomcat 中执行此操作。（[Tomcat 6 连接器文档](http://tomcat.apache.org/tomcat-6.0-doc/config/http.html)）

或者您可以提出某种 javascript 时间戳方法，但我不希望设置客户端时钟。必须多次调用 Web 服务器。

*   时间戳查询
*   真正的要求
*   报告数据

这种方法将涵盖延迟，尽管您仍然有一些抖动差异。

嗯......你有一个有趣的问题。:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-18T08:50:12.040

查看由 netflix 开发的[Jiffy-web](http://code.google.com/p/jiffy-web/)，让他们更准确地查看总页面 -> 页面渲染时间

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-09T08:41:53.717

我有同样的问题。但是这篇[JavaOne Paper](http://www.javaworld.com/javaworld/jw-11-2008/jw-11-measuring-client-response.html?page=1)确实帮助我解决了这个问题。我会要求你通过它，它基本上使用 javascript 来计算时间。

# ruby-on-rails - 在您的应用程序和源代码管理中存储 SASS 生成的 CSS 的最佳方法是什么？

> ID：86018
> 
> 赞同：21
> 
> 时间：2008-09-17T18:12:51.603
> 
> 标签：ruby-on-rails, haml, sass

如果您在 Rails 应用程序中使用 HAML 和 SASS，那么您在 public/stylesheet/*.sass 中定义的任何模板都将编译为 *.css 样式表。从您的代码中，您可以使用 stylesheet_link_tag 按名称提取资产，而无需担心扩展。

许多人不喜欢将生成的代码或编译的代码存储在版本控制中，而且 public/ 目录不应该包含您不发送到浏览器的元素也是有道理的。

在 Rails 项目中布置 SASS 资源时，最好遵循的模式是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-27T04:49:01.920

[compass](http://github.com/chriseppstein/compass)框架建议将您的sass 样式表放在 app/stylesheets 下，将编译后的 css 放在 public/stylesheets/compiled 中。

您可以通过将以下代码添加到您的 environment.rb 来配置它：

```
Sass::Plugin.options[:template_location] = {
  "#{RAILS_ROOT}/app/stylesheets" => "#{RAILS_ROOT}/public/stylesheets/compiled"
} 
```

如果您使用 compass 框架，它会在您安装它时为您设置此配置。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-17T19:02:45.477

我总是在“public/stylesheets/sass/*.sass”中对所有样式表进行版本控制，并为已编译的样式设置一个排除过滤器：

```
/public/stylesheets/*.css 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-19T01:50:16.800

老实说，我喜欢在版本控制中使用我编译的 SASS 样式表。它们很小，只有在您的 .sass 文件更改时才会更改，并且让它们与您的应用程序的其余部分一起部署意味着 SASS 编译器永远不需要在生产中触发。

另一个优点（尽管很小）是，如果您不使用页面缓存，则您的 rails 进程不需要对您的`public_html`目录具有写访问权限。因此，对您的服务器的利用可能是邪恶的。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-19T22:13:08.910

有点相关，但在 capistrano 部署期间重新生成 CSS 是个好主意。这个回调钩子就是这样做的：

```
after "deploy:update_code" do
  rails_env = fetch(:rails_env, "production")
  run "#{release_path}/script/runner -e #{rails_env} 'Sass::Plugin.update_stylesheets'"
end 
```

**更新**：现代版本的 Haml/Sass 不再需要这样做。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T18:22:06.947

如果我可以管理它，当我为项目选择 HAML/SASS 时，我喜欢将我的所有样式存储在 SASS 模板中，并且我将删除 application.css 和 scaffold.css。然后我将SASS放在public/stylesheets/sass中，并将/public/stylesheets/*.css添加到.gitignore中。

如果我必须结合使用 SASS 和基于 CSS 的资产，那就有点复杂了。处理此问题的最简单方法是在样式表目录中生成生成的 CSS 的输出子目录，然后在 .gitignore 中排除该子目录。然后，在您的视图中，您必须知道您正在使用哪种样式类型（SASS 或 CSS），因为您必须选择 public/stylesheets/foo 样式表或 public/stylesheets/sass-out/foo 样式表。

如果您必须走第二条路线，请构建一个帮助器来抽象出 sass-out 子目录。

# excel - 如何在 VBA 中为 Excel 或 Access 项目使用 VisualBasic-Express 中的类？

> ID：86027
> 
> 赞同：1
> 
> 时间：2008-09-17T18:13:22.943
> 
> 标签：excel, dll, com-interop, vba

我将我的 VB-Express 代码保存为 .dll 并使用 regasm 注册它并制作了一个 .tlb 文件。

但是当我尝试在 Excel 模块中运行它的函数时，我得到：**运行时错误“453”：在 kernel32 中找不到 DLL 入口点 RegisterServiceProcess**

我错过了哪一步？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-18T09:08:25.117

请参阅[http://richnewman.wordpress.com/2007/04/15/a-beginner](http://richnewman.wordpress.com/2007/04/15/a-beginner)的 s-guide-to-calling-a-net-library-from-excel/ 或更好地尝试 ExcelDNA（[http:// groups.google.com/group/ExcelDna](http://groups.google.com/group/ExcelDna) )

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T21:55:06.497

我认为您正在创建一个 .Net dll 并试图从面向 COM 的环境 (VBA) 中调用它，如果没有帮助，这将无法工作。如果我猜对了，那么您需要研究 .Net 的 COM 互操作元素：Google 提供了许多看起来很有希望的链接，其中之一就是[这篇文章](http://www.codeproject.com/KB/COM/nettocom.aspx)。

它看起来有点不愉快，但我希望这种肮脏可以藏在某个地方......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T18:44:00.717

试试这篇 Microsoft 知识库文章：[Can't Run Macro That Calls 16-bit DLL in 32-bit MS Excel](http://support.microsoft.com/kb/131525)。

您是否具有访问 DLL 的适当权限？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-18T13:29:43.677

感谢大家的投入，你帮助我更进一步。遵循您提供的指南后，我得到：**运行时错误：'-2147024894' (80070002)'：找不到文件或程序集名称 AssemblyName 或其依赖项之一。**

但我可以用这个[Workaround 解决](http://support.microsoft.com/kb/948461)这个问题。

# asp.net - 使用 Reflector 反编译的 ASP.NET 取得了多大的成功？

> ID：86030
> 
> 赞同：0
> 
> 时间：2008-09-17T18:13:42.380
> 
> 标签：asp.net, decompiling, reflector

我刚刚完成了一个小项目，需要对预编译但不再受支持的 ASP.NET 网站进行更改。代码很丑，但在编译之前就很丑了，我印象深刻的是一切似乎仍然正常。

需要进行一些编辑，例如删除控制声明，因为它们被放入生成的文件中，并且与反编译的基类发生冲突，但几个小时没有解决任何问题。

现在我只是好奇有多少其他人在这方面取得了多大的成功。我实际上想写一篇关于定义逆向工程过程（如果不是自动化的话）的 CodeProject 文章。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T18:50:11.030

由于 .NET 平台中存在所有编译器糖，如果没有极其复杂的反编译器，您将无法将二进制文件反编译为原始代码。例如，编译器在后台创建类来处理外壳。自动化这种事情似乎是一项艰巨的任务。但是，处理预期的问题只是为了让它编译可能是可编写脚本的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-18T08:21:59.110

> > Will：由于 .NET 平台中存在的所有编译器糖

幸运的是，这个特定的应用程序非常简单，但我不希望反编译成原始代码，只是让代码像原始代码一样工作，或者甚至可以深入了解原始代码的工作原理，以允许“拼接”新代码.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-12T21:45:04.363

我必须做类似的事情，而且我实际上比拥有代码更快乐。它可能花费了我更少的时间，但是编译器优化后的代码质量可能比原始代码更好。所以是的，如果它是一个简单的应用程序，做逆向工程相对简单；另一方面，我想避免将来不得不这样做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-12T21:58:29.047

如果它是用 .NET 1.1 或 .NET 2.0 编写的，那么您将比使用 VS 2008 编译器编译的任何东西都更成功，主要是因为新语言修订版（Lambda、匿名类等）带来的语法糖.

只要代码*没有被*混淆，那么您应该能够使用反射器来获得可行的代码，如果您将其放入 VS 中，您应该立即在反射代码中发现*错误。*

请注意以 开头的变量/方法`<>`，我看到很多（特别是在反映 .NET 3.5 时）。

你能做的最糟糕的事情是将它全部导出到VS，点击编译并确定有多少错误并从中进行调用。

但是，如果这是一个足够简单的项目，您应该能够从反射器进行逆向工程，至少使用反射器来了解代码在做什么的一般要点，然后自己重​​新编码。

# asp.net - 如何在 SharePoint 文档库中将 Microsoft Word 文档设为“只读”？

> ID：86033
> 
> 赞同：1
> 
> 时间：2008-09-17T18:13:49.180
> 
> 标签：asp.net, visual-studio-2008, sharepoint

如何使打开的“只读”成为 SharePoint 文档库中的唯一选项？

使用 Word 2003 或 2007 并将文档另存为模板或将文件属性修改为“只读”时，不会阻止修改 SharePoint 文档库中的文件。将文档库权限修改为只允许“只读”访问也不起作用。有效的是使用 SharePoint URL 链接列表来访问外部服务器目录中的文件，但这会破坏使用 SharePoint 文档库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T18:29:17.460

我不知道您是否可以强制只读成为唯一选项，但您可以实现自己的事件处理程序来覆盖 ItemUpdating 事件。只需取消更新，任何更改都将被丢弃。

[Sahil 展示了一个非常基本的事件处理程序，它在此处](http://blah.winsmarts.com/2006-7-Sharepoint_2007__List_Events_Practical_Example__Creating_a_rigged_survey.aspx)执行取消操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T20:25:23.797

事件处理程序有效，但我找到了一个更简单的解决方法。

如果您“签出”文件并使其处于签出状态，则没有其他人可以选择编辑该文件。这仍然不理想，但是对于强制文档为“只读”它是有效的。

# c++ - 作为 C++ 类的成员启动线程的最佳方式？

> ID：86046
> 
> 赞同：16
> 
> 时间：2008-09-17T18:15:37.290
> 
> 标签：c++, pthreads

我想知道启动作为 C++ 类成员的 pthread的*最佳方法？*我自己的方法如下作为答案......

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-09-17T18:41:56.977

这可以通过使用 boost 库来简单地完成，如下所示：

```
#include <boost/thread.hpp>

// define class to model or control a particular kind of widget
class cWidget
{
public:
void Run();
}

// construct an instance of the widget modeller or controller
cWidget theWidget;

// start new thread by invoking method run on theWidget instance

boost::thread* pThread = new boost::thread(
    &cWidget::Run,      // pointer to member function to execute in thread
    &theWidget);        // pointer to instance of class 
```

笔记：

*   这使用了一个普通的类成员函数。无需添加额外的静态成员来混淆您的类接口
*   只需在启动线程的源文件中包含 boost/thread.hpp 即可。如果您刚开始使用 boost，那么所有其余的大而令人生畏的软件包都可以忽略不计。

在 C++11 中，你可以做同样的事情，但不需要提升

```
// define class to model or control a particular kind of widget
class cWidget
{
public:
void Run();
}

// construct an instance of the widget modeller or controller
cWidget theWidget;

// start new thread by invoking method run on theWidget instance

std::thread * pThread = new std::thread(
    &cWidget::Run,      // pointer to member function to execute in thread
    &theWidget);        // pointer to instance of class 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-09-17T18:27:15.017

我通常使用类的静态成员函数，并使用指向类的指针作为 void * 参数。然后该函数可以执行线程处理，或者使用类引用调用另一个非静态成员函数。然后，该函数可以引用所有类成员，而不会使用笨拙的语法。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-09-17T18:32:30.277

您必须使用 void* 参数引导它：

```
A级
{
  静态无效*静态线程过程（无效*arg）
  {
    return reinterpret_cast<A*>(arg)->ThreadProc();
  }

  无效* ThreadProc（无效）
  {
    // 做东西
  }
};

...

pthread_t 线程；
pthread_create(&theThread, NULL, &A::StaticThreadProc, this);
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-17T20:28:55.130

我使用了上述三种方法。当我第一次在 c++ 中使用线程时，我使用了*静态成员函数*，然后是*友元函数*，最后是*BOOST 库*。目前我更喜欢BOOST。在过去的几年里，我已经成为了 BOOST 的偏执狂。

BOOST 之于 C++，就像 CPAN 之于 Perl。:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-11T16:29:02.867

boost 库提供了一种复制机制，有助于将对象信息传输到新线程。在另一个 boost 示例中， boost::bind 将使用指针进行复制，该指针也只是被复制。因此，您必须注意对象的有效性，以防止出现悬空指针。如果你实现 operator() 并提供一个复制构造函数并直接传递对象，你不必关心它。

一个更好的解决方案，可以避免很多麻烦：

```
#include <boost/thread.hpp>

class MyClass {
public:
        MyClass(int i);
        MyClass(const MyClass& myClass);  // Copy-Constructor
        void operator()() const;          // entry point for the new thread

        virtual void doSomething();       // Now you can use virtual functions

private:
        int i;                            // and also fields very easily
}; 
```

* * *

```
MyClass clazz(1);
// Passing the object directly will create a copy internally
// Now you don't have to worry about the validity of the clazz object above
// after starting the other thread
// The operator() will be executed for the new thread.
boost::thread thread(clazz);             // create the object on the stack 
```

另一个 boost 示例在堆上创建线程对象，尽管这样做没有意义。

# linux - 为什么 Imake 将 Imakefile 中的某些单词解释为数值？

> ID：86047
> 
> 赞同：1
> 
> 时间：2008-09-17T18:15:42.937
> 
> 标签：linux, unix, makefile

我发现很难找到任何现有的文档。我试图找出的是为什么 Imake 会在生成的 Make-file 中将诸如`unix`,`linux`或数字 1 之类的词解释为？`i386`我敢肯定它是指示您是否在该系统上的功能。我一直没能找到这是某个地方的#define 集，所以这是内置的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T23:27:38.693

imake 通过运行 C 预处理器 cpp 来生成 Makefile，它通常具有各种内置定义。您可以通过运行获取列表

```
gcc -E -dM emptyfile.c 
```

# svn - 如何忽略 Subversion 中的文件？

> ID：86049
> 
> 赞同：693
> 
> 时间：2008-09-17T18:15:55.807
> 
> 标签：svn, command

如何忽略 Subversion 中的文件？

另外，如何找到不受版本控制的文件？

* * *

## 回答 #1

> 赞同：784
> 
> 时间：2008-09-17T18:16:07.227

（此答案已更新以匹配 SVN 1.8 和 1.9 的行为）

你有2个问题：

# 将文件标记为已忽略：

“忽略文件”是指该文件即使“未版本化”也不会出现在列表中：您的 SVN 客户端将假装该文件在文件系统中根本不存在。

忽略的文件由“文件模式”指定。SVN 的在线文档中解释了文件模式的语法和格式：http: [//svnbook.red-bean.com/nightly/en/svn.advanced.props.special.ignore.html](http://svnbook.red-bean.com/nightly/en/svn.advanced.props.special.ignore.html) “Subversion 中的文件模式”。

从 1.8 版（2013 年 6 月）及更高版本开始，Subversion 支持 3 种不同的方式来指定文件模式。以下是带有示例的摘要：

## 1 - 运行时配置区 -`global-ignores`选项：

*   这是一个**仅限客户端的**设置，因此您的`global-ignores`列表不会被其他用户共享，它适用于您在计算机上结帐的所有存储库。
*   此设置在您的运行时配置区域文件中定义：
    *   Windows（基于文件）-`C:\Users\{you}\AppData\Roaming\Subversion\config`
    *   Windows （基于注册表）-`Software\Tigris.org\Subversion\Config\Miscellany\global-ignores`和.`HKLM``HKCU`
    *   Linux/Unix -`~/.subversion/config`

## 2 -`svn:ignore`在目录（不是文件）上设置的属性：

*   这存储在 repo 中，因此其他用户将拥有相同的忽略文件。类似于如何`.gitignore`工作。
*   `svn:ignore`应用于目录并且是非递归的或继承的。将排除与文件模式匹配的父目录的任何文件或*直接子目录。*
*   虽然 SVN 1.8 添加了“继承属性”的概念，但`svn:ignore`属性本身在非直接后代目录中被忽略：

    ```
    cd ~/myRepoRoot                             # Open an existing repo.
    echo "foo" > "ignoreThis.txt"                # Create a file called "ignoreThis.txt".

    svn status                                  # Check to see if the file is ignored or not.
    > ?    ./ignoreThis.txt
    > 1 unversioned file                        # ...it is NOT currently ignored.

    svn propset svn:ignore "ignoreThis.txt" .   # Apply the svn:ignore property to the "myRepoRoot" directory.
    svn status
    > 0 unversioned files                       # ...but now the file is ignored!

    cd subdirectory                             # now open a subdirectory.
    echo "foo" > "ignoreThis.txt"                # create another file named "ignoreThis.txt".

    svn status
    > ?    ./subdirectory/ignoreThis.txt        # ...and is is NOT ignored!
    > 1 unversioned file 
    ```

    （因此文件`./subdirectory/ignoreThis`不会被忽略，即使 " `ignoreThis.txt`" 应用于`.`repo 根目录）。

*   因此，要递归应用忽略列表，您必须使用`svn propset svn:ignore <filePattern> . --recursive`.

    *   这将在每个子目录上创建属性的副本。
    *   如果子目录中的`<filePattern>`值不同，则子目录的值会完全覆盖父目录，因此没有“加法”效果。
    *   因此，如果您更改了`<filePattern>`root `.`，那么您必须更改它`--recursive`以覆盖子目录和后代目录。
*   我注意到命令行语法是违反直觉的。

    *   我开始假设您会通过键入类似的内容来忽略 SVN 中的文件，`svn ignore pathToFileToIgnore.txt`但这不是 SVN 的忽略功能的工作方式。

## 3-`svn:global-ignores`财产。需要 SVN 1.8（2013 年 6 月）：

*   这类似于`svn:ignore`，除了它使用 SVN 1.8 的“继承属性”功能。
*   与 相比`svn:ignore`，文件模式会自动应用于每个后代目录（不仅仅是直接子目录）。
    *   这意味着不需要设置`svn:global-ignores`标志`--recursive`，因为继承的忽略文件模式在继承时会自动应用。
*   运行与上一个示例相同的命令集，但`svn:global-ignores`改用：

    ```
    cd ~/myRepoRoot                                    # Open an existing repo
    echo "foo" > "ignoreThis.txt"                       # Create a file called "ignoreThis.txt"
    svn status                                         # Check to see if the file is ignored or not
    > ?    ./ignoreThis.txt
    > 1 unversioned file                               # ...it is NOT currently ignored

    svn propset svn:global-ignores "ignoreThis.txt" .
    svn status
    > 0 unversioned files                              # ...but now the file is ignored!

    cd subdirectory                                    # now open a subdirectory
    echo "foo" > "ignoreThis.txt"                       # create another file named "ignoreThis.txt"
    svn status
    > 0 unversioned files                              # the file is ignored here too! 
    ```

## 对于 TortoiseSVN 用户：

这整个安排让我感到困惑，因为 TortoiseSVN 的术语（在他们的 Windows 资源管理器菜单系统中使用）最初误导了我——我不确定忽略菜单的“递归添加”、“添加 *”和“添加”的意义是什么选项。我希望这篇文章解释了忽略功能如何与 SVN 属性功能相关联。也就是说，我建议使用命令行来设置被忽略的文件，这样您就可以了解它是如何工作的，而不是使用 GUI，并且只有在您熟悉命令行之后才使用 GUI 来操作属性。

# 列出被忽略的文件：

该命令`svn status`将隐藏被忽略的文件（即匹配 RGA`global-ignores`模式、匹配直接父目录`svn:ignore`模式或匹配任何前导目录`svn:global-ignores`模式的文件。

使用该`--no-ignore`选项查看列出的这些文件。忽略的文件的状态为`I`，然后将输出通过管道传输`grep`到仅显示以“I”开头的行。

命令是：

```
svn status --no-ignore | grep "^I" 
```

例如：

```
svn status
> ? foo                             # An unversioned file
> M modifiedFile.txt                # A versioned file that has been modified

svn status --no-ignore
> ? foo                             # An unversioned file
> I ignoreThis.txt                  # A file matching an svn:ignore pattern
> M modifiedFile.txt                # A versioned file that has been modified

svn status --no-ignore | grep "^I"
> I ignoreThis.txt                  # A file matching an svn:ignore pattern 
```

达达！

* * *

## 回答 #2

> 赞同：94
> 
> 时间：2013-10-25T15:20:08.293

使用以下命令创建不在版本控制文件下的列表。

```
svn status | grep "^\?" | awk "{print \$2}" > ignoring.txt 
```

然后编辑该文件以**仅保留您实际上要忽略的文件**。然后使用这个忽略文件中列出的文件：

```
svn propset svn:ignore -F ignoring.txt . 
```

注意行尾的点。它告诉 SVN 该属性正在当前目录中设置。

删除文件：

```
rm ignoring.txt 
```

最后提交，

```
svn ci --message "ignoring some files" 
```

然后，您可以通过以下方式检查哪些文件被忽略：

```
svn proplist -v 
```

* * *

## 回答 #3

> 赞同：69
> 
> 时间：2014-08-26T09:15:15.887

# .gitignore 类似的方法

您可以忽略 .gitignore 之类的文件或目录。只需创建要忽略的目录/文件列表的文本文件并运行以下代码：

```
svn propset svn:ignore -F ignorelist.txt . 
```

或者，如果您不想使用文本文件，可以这样做：

```
svn propset svn:ignore "first
 second
 third" . 
```

[来源：Karsten's Blog - Set svn:ignore for multiple files from command line](http://kthoms.wordpress.com/2011/04/21/set-svnignore-for-multiple-files-from-command-line/)

* * *

## 回答 #4

> 赞同：51
> 
> 时间：2008-09-17T18:35:59.800

如果您使用[TortoiseSVN](http://tortoisesvn.net/)，请右键单击文件，然后选择**TortoiseSVN / 添加到忽略列表**。这会将文件/通配符添加到`svn:ignore`属性中。

`svn:ignore`当您签入文件时将被检查，匹配的文件将被忽略。我有以下 Visual Studio .NET 项目的忽略列表：

```
bin obj
*.exe
*.dll
_ReSharper
*.pdb
*.suo 
```

**你可以在TortoiseSVN/Properties**的上下文菜单中找到这个列表。

* * *

## 回答 #5

> 赞同：40
> 
> 时间：2017-07-26T21:37:07.383

好像没有人提到它...

```
svn propedit svn:ignore . 
```

然后编辑文件的内容以指定要忽略的模式，退出编辑器就完成了。

* * *

## 回答 #6

> 赞同：22
> 
> 时间：2014-03-25T20:06:07.597

我找到了文章 *[.svnignore Example for Java](http://sethholloway.com/svnignore-example-for-java/)*。

示例： .svnignore 用于 Ruby on Rails，

```
/log

/public/*.JPEG
/public/*.jpeg
/public/*.png
/public/*.gif

*.*~ 
```

在那之后：

```
svn propset svn:ignore -F .svnignore . 
```

.gitignore 的示例。您可以使用 .svnignore

[https://github.com/github/gitignore](https://github.com/github/gitignore)

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2011-03-01T13:54:11.303

使用 propedit 时，请确保没有任何尾随空格，因为这将导致文件从忽略列表中排除。

如果您在 linux 上使用 tab-autocomplete 创建文件开头，这些会自动插入：

```
svn propset svn:ignore 'file1
file2' . 
```

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2013-02-28T22:56:22.990

此外，如果你使用 Tortoise SVN，你可以这样做：

1.  在上下文菜单中选择“TortoiseSVN”，然后选择“属性”
2.  在出现的窗口中单击“新建”，然后单击“高级”
3.  在“属性名”对面出现的窗口中选择或输入“svn:ignore”，在“属性值”对面输入所需的文件名或文件夹名或文件掩码（在我的情况下是“*/target”），单击“应用递归属性"
4.  行。行。
5.  犯罪

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2015-05-29T11:54:16.650

另一种解决方案是：

```
svn st | awk '/^?/{print $2}' > svnignore.txt && svn propget svn:ignore >> svnignore.txt && svn propset svn:ignore -F svnignore.txt . && rm svnignore.txt 
```

或逐行

```
svn st | awk '/^?/{print $2}' > svnignore.txt 
svn propget svn:ignore >> svnignore.txt 
svn propset svn:ignore -F svnignore.txt . 
rm svnignore.txt 
```

它能做什么：

1.  从 svn 获取状态文件
2.  保存所有文件**？**到文件“svnignore.txt”
3.  获取已经被忽略的文件并将它们附加到文件“svnignore.txt”
4.  告诉 svn 忽略“svnignore.txt”中的文件
5.  删除文件

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2017-01-11T09:49:16.777

1.  cd ~/.subversion
2.  打开配置
3.  找到像“global-ignores”这样的行
4.  像这样设置忽略文件类型： global-ignores = *.o *.lo *.la *.al .libs *.so *.so.[0-9]* *.pyc *.pyo 88 *.rej *~ #* # 。 #* .*.swp .DS_Store node_modules 输出

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2016-12-01T01:07:29.557

[bkbilly 答案](https://stackoverflow.com/a/30528955/7724)的更具可读性的版本：

```
svn st | awk '/^?/{print $2}' > svnignore.txt
svn propget svn:ignore >> svnignore.txt
svn propset svn:ignore -F svnignore.txt .
rm svnignore.txt 
```

它能做什么：

1.  从 svn 获取状态文件
2.  保存所有文件**？**到文件“svnignore.txt”
3.  获取已经被忽略的文件并将它们附加到文件“svnignore.txt”
4.  告诉 svn 忽略“svnignore.txt”中的文件
5.  删除文件

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2019-10-03T10:38:35.280

什么对我有用（*我使用的是 TortoiseSVN v1.13.1* **）**：

 *# 如何忽略 Subversion 中的文件？

1.在文件资源管理器中，右键单击 SVN*项目文件夹名称*
2.单击“SVN 提交...”
3.将出现“提交”窗口
4.**右键单击**要忽略的文件夹/文件
5.单击“添加到忽略列表”
6.选择要忽略的文件夹/文件名

*   有几个选择（我有 4 个），如果您只选择文件夹/文件名，它将被添加到 svn:ignore 列表
*   如果您选择文件夹/文件名，使用（递归），它将被添加到 svn:global-ignores。这是我通常选择的，因为所有子目录都会自动继承此更改。 [![在此处输入图像描述](https://i.stack.imgur.com/oCUtu.png)](https://i.stack.imgur.com/oCUtu.png)

7.将“属性更改”**提交给SVN**

# 另外，如何找到不受版本控制的文件？

在上面的第 3 步之后，单击“显示未版本控制的文件”，如下所示：
[![在此处输入图像描述](https://i.stack.imgur.com/mizOd.png)](https://i.stack.imgur.com/mizOd.png)

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2008-09-17T18:17:40.530

`svn status`会告诉你哪些文件不在 SVN 中，以及发生了什么变化。

查看忽略属性的[SVN 属性](http://svnbook.red-bean.com/en/1.1/ch07s02.html)。

对于所有的 SVN，[红皮书](http://svnbook.red-bean.com/en/1.1/index.html)都是必读的。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2008-09-17T18:18:16.037

您还可以在 SVN 的配置文件中设置全局忽略模式。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2015-03-10T15:54:10.477

[将目录添加到 subversion，并忽略目录内容](http://www.metaltoad.com/blog/adding-directory-subversion-and-ignoring-directory-contents)

```
svn propset svn:ignore '\*.*' . 
```

或者

```
svn propset svn:ignore '*' . 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-09-17T18:19:39.557

在您的工作副本上使用命令**svn status**来显示文件的状态，尚未受版本控制（并且未被忽略）的文件旁边将有一个问号。

至于忽略文件，您需要编辑 svn:ignore 属性，请阅读 http://svnbook.red-bean.com/en/1.5/svn.advanced.props.special.ignore 中的 svnbook 中的忽略未版本控制项一章[。 .html](http://svnbook.red-bean.com/en/1.5/svn.advanced.props.special.ignore.html) _ 这本书还描述了更多关于使用 svn status 的信息。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2018-01-06T11:11:56.730

SVN`ignore`在 TortoiseSVN 中很容易管理。打开 TortoiseSVN 并右键单击文件菜单，然后选择添加到忽略列表。

这将在`svn:ignore`属性中添加文件。当我们签入文件时，那些与之匹配的文件`svn:ignore`将被忽略并且不会提交。

在 Visual Studio 项目中，我们添加了以下要忽略的文件：

```
bin obj
*.exe
*.dll
*.pdb
*.suo 
```

我们正在使用此方法成功管理[Comparetrap的 SVN 上的源代码](http://www.comparetrap.com/)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-06-06T06:00:35.970

1.  打开你使用 JetBrains 产品（即 Pycharm）
2.  然后单击顶部工具栏上的“提交”按钮或使用快捷键“ctrl + k” [screenshot_toolbar](https://i.stack.imgur.com/lwwNN.png)
3.  在提交界面上，将不需要的文件移动到另一个更改列表，如下所示。 [screenshot_commit_change](https://i.stack.imgur.com/bWqNP.png)
4.  下次您只能提交默认更改列表。

# java - 对 Java 的 MP3/声音库有什么好的建议吗？

> ID：86083
> 
> 赞同：44
> 
> 时间：2008-09-17T18:19:10.683
> 
> 标签：java, audio, mp3, signal-processing

我正在寻找图书馆：

*   读取和写入元数据（例如 mp3 和所有文件中的 ID3v2 标签）
*   将压缩转换为原始音频数据，如果可能，将原始音频数据转换为 mp3、ogg、aac、...
*   以数字方式处理音频数据（能量、音色、梅尔频率倒谱系数 - MFCC、FFT、LPC、自相关、小波……）

我已经知道并且不满足于：

*   JMF：来自 Sun，读取 mp3 并将其转换为 WAV。但不读取元数据，也不提供任何高级数字处理功能。
*   [FMJ](http://fmj-sf.net/)：具有相同限制的 JMF 的替代实现。
*   [jAudio](http://jaudio.sourceforge.net/)：不稳定，虽然有潜力，但目前维护得不好。
*   [Marsyas](http://marsyas.sness.net/)：在数字处理中正是我所希望的，但在 C++ 中。也许一些端口/集成已经可用？
*   [JID3](http://jid3.blinkenlights.org/)：元数据的 API，但似乎已经死了（最后一个版本 2005/12/10）。
*   [JLayer](http://www.javazoom.net/javalayer/javalayer.html)：用于阅读和播放的 API，也死了（最后更新 2004/11/28）。
*   [MetaMusic](http://www.routeconverter.de/MetaMusic/) : 程序的 API 很简洁，但没有官方的独立开源项目。因此没有社区，未来的支持和所有......
*   [Light Dev](http://www.lightdev.com/page/61.htm)：一些有趣的功能，但并不完整。

这是我自己的一些调查发现的。我将非常感谢所有的意见、建议、批评......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-17T18:23:58.113

JLayer 应该做你需要的一切。它没有死，它只是稳定的。作者在很久以前就完成了，MP3 格式从那以后就没有太大的变化。你会注意到他的[MP3SPI](http://www.javazoom.net/mp3spi/mp3spi.html)代码库更新了一些。MP3SPI 所做的是将 JLayer 的功能转换为 JavaSound API。因此，您可以获取任何 JavaSound 代码，将 MP3SPI 添加到类路径中，并期望 MP3 文件将开始工作。这很漂亮。:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-11-06T06:01:05.433

你可以试试[Xuggler](http://www.xuggle.com/xuggler)。以下是它在您的测试中的作用：

```
* read and write meta data (for example ID3v2 tags in mp3 and all): 
```

如果底层容器类型在 FFmpeg 中支持元数据，则 Xuggler 支持它。

```
* convert compressed to to raw audio data and if possible raw audio data to mp3, ogg, aac, ... 
```

Xuggler 支持 mp3、ogg（vorbis 或 speex）、speex、vorbis、flac、aac 等。

```
* digitally process the audio data (energy, timbre, Mel Frequency Cepstral Coefficients - MFCC, FFT, LPC, Autocorrelation, Wavelet, ...) 
```

Xuggler 没有 DSP 模块，因此您需要为此找到另一个库。但 Xuggler 会给你原始数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T18:27:25.700

您应该尝试查看[gstreamer-java](http://code.google.com/p/gstreamer-java/)，我已经成功通过它播放媒体，并且应该可以使用它转换音频文件。还有集成到 JMF 中的[JFFMpeg](http://jffmpeg.sourceforge.net/)，我没有过多地研究它，所以我不知道它的功能和状态的总体范围，但它需要更仔细地研究。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-20T14:00:28.700

顺便说一句，我刚刚将我的 MetaMusic 项目移至[http://github.com/cpesch/MetaMusic/](http://github.com/cpesch/MetaMusic/)，因为那里的基础设施要好得多。

# security - OpenID 提供者——是什么阻止了恶意提供者？

> ID：86090
> 
> 赞同：16
> 
> 时间：2008-09-17T18:19:55.237
> 
> 标签：security, openid

所以我喜欢 OpenID 的想法。我在我的网站上支持它，并在任何可能的地方使用它（比如这里！）。但我不清楚一件事。

支持 OpenID 的站点基本上接受任何 OpenID 提供程序，对吗？这如何与想要减少机器人注册的网站一起使用？如何阻止恶意 OpenID 提供者自动设置无限制的机器人 ID？

我有一些想法，并将它们作为可能的答案发布，但我想知道是否有人能看到我错过的明显东西？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-17T18:35:13.403

你混淆了两个不同的东西——识别和授权。仅仅因为您知道某人是谁，并不意味着您必须自动授予他们做任何事情的权限。Simon Willison 在[An OpenID is not an account 中很好地介绍了这一点！](http://blog.simonwillison.net/post/57956829720/account) 更多关于白名单的讨论可以在[使用 OpenID 的社交白](http://blog.simonwillison.net/post/57956830518/whitelisting)名单中找到。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-17T18:39:03.287

对您的问题的简短回答是，“它没有。” OpenID 特意只提供了一种具有集中认证站点的机制；由您决定您个人认为可以接受的 OpenID 提供商。例如，微软[最近决定在其 Healthvault 站点上只允许来自少数几个供应商的 OpenID](http://healthinformaticsblog.com/2008/06/24/healthvault-implements-openid/)。公司可能决定只允许从其 LDAP 支持的接入点登录 OpenID，政府机构可能只接受来自生物特征支持网站的 OpenID，而博客可能只接受 TypePad，因为它们对垃圾邮件的审查非常严格。

OpenID 似乎有很多困惑。它最初的目标只是提供一个标准的登录机制，这样当我需要一个安全的登录机制时，我可以从任何或所有 OpenID 提供者中选择来为我处理。允许任何地方的任何人建立自己的受信任的 OpenID*提供商*从来都不是目标。有效地做第二个是不可能的——毕竟，即使使用加密，你也没有理由不能设置你自己的提供商来安全地撒谎并说它正在验证你想要的任何人。拥有一个单一的、标准化的登录机制本身已经是一大进步。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-17T18:22:29.067

OpenId 只不过是用户在注册您的站点时选择的用户名和密码。您不依赖 OpenId 框架来清除机器人；您的注册系统应该仍然这样做。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-17T18:21:40.380

可能的解决方案 - 您仍然可以要求新 ID 通过 CAPTCHA 测试。就像机器人可以使用虚假/多个电子邮件地址注册到任何站点一样，但那里的“验证”步骤也会失败。

还是我们将不得不开始维护提供商黑名单？考虑到建立一个新的提供者是多么容易，这些不会真的很好用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-17T18:22:52.950

据我所知，OpenID 只处理身份，而不是授权。停止机器人是一个授权问题。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-17T19:10:46.860

请注意，与传统的“每个站点”登录不同，OpenID 为您提供了一个可能超越单个站点的身份。更好的是，这个身份甚至是一个 URI，因此它非常适合与 RDF 一起使用来交换或查询有关身份的任意元数据。

您可以使用 OpenID 执行一些您无法使用新用户的常规用户名执行的操作。

首先你可以做一些简单的白名单操作。如果 *.bigcorp.example 是 Big Corp 员工的 OpenID，并且您知道 Big Corp 不是垃圾邮件发送者，那么您可以将这些 OpenID 列入白名单。这应该适用于半封闭的网站，也许它是一个为当前和过去员工提供的社交网站。

不过更好的是，您可以从使用特定 OpenID 的其他地方进行推断。假设您有一张 OpenID 到 Stackoverflow.com 的信誉值的映射。当有人使用 OpenID 出现在您的网络论坛时，您可以查看他们在 Stackoverflow 上是否有良好的声誉，并跳过这些用户的验证码或试用期。

# c# - 如何禁用 WinForms DataGrid 中的按钮单元格？

> ID：86096
> 
> 赞同：2
> 
> 时间：2008-09-17T18:20:30.303
> 
> 标签：c#, winforms, user-interface

我有一个 WinForms 应用程序，其中包含一个 DataGridView 控件和一列 DataGridViewButtonCell 单元格。当我单击其中一个按钮时，它会启动一个后台任务，我想禁用这些按钮，直到该任务完成。

我可以禁用 DataGridView 控件，但它没有提供按钮被禁用的视觉指示。我希望用户看到按钮被禁用，并在再次启用按钮时注意到任务已经完成。

允许我单独禁用按钮的方法的奖励积分，因此我可以在任务运行时启用其中一个按钮。（请注意，我实际上不能给出奖励积分。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T18:22:18.413

这是迄今为止我找到的最佳解决方案。这篇[MSDN 文章](http://msdn.microsoft.com/en-us/library/ms171619.aspx)提供了添加 Enabled 属性的单元类的源代码。

它工作得相当好，但有两个问题：

1.  在任何单元格上设置 Enabled 属性后，您必须使网格无效。它在示例代码中显示了这一点，但我错过了。
2.  这只是视觉上的变化，设置 Enabled 属性实际上并不会启用或禁用按钮。用户仍然可以点击它。我可以在执行单击事件之前检查启用的属性，但是当用户单击它时，它似乎也弄乱了外观。相反，我只是禁用了整个网格。这对我来说没问题，但我更喜欢一种允许我禁用某些按钮而不禁用整个网格的方法。

[DataGridView FAQ](http://windowsclient.net/downloads/folders/applications/entry1304.aspx)中有一个类似的示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T18:51:37.267

你可以试试这个：

当你点击单元格...

1.  检查具有当前行标识符的进程是否从类级列表中运行；如果是，则退出单元格单击事件。
2.  将行标识符存储在正在运行的进程的类级列表中。
3.  将按钮文本更改为“正在运行...”或适当的内容。
4.  将基本的 RunWorkerCompleted 事件处理程序附加到您的进程（稍后解释）。
5.  调用 backgroundWorker.RunWorkerAsync(rowIdentifier)。

在 DoWork 事件处理程序中...

1.  设置 e.Result = e.Argument （或创建一个将返回参数和所需结果的对象）

在 RunWorkerCompleted 事件处理程序中...

1.  从正在运行的进程列表中删除行标识符（e.Result 是标识符）。
2.  将按钮文本从“正在运行...”更改为“就绪”

# javascript - 如何禁止浏览器的身份验证对话框？

> ID：86105
> 
> 赞同：89
> 
> 时间：2008-09-17T18:22:03.467
> 
> 标签：javascript, ajax, http-authentication

我的 Web 应用程序有一个登录页面，该页面通过 AJAX 调用提交身份验证凭据。如果用户输入了正确的用户名和密码，一切都很好，但如果不是，则会发生以下情况：

1.  Web 服务器确定尽管请求包含格式正确的 Authorization 标头，但标头中的凭据未成功进行身份验证。
2.  Web 服务器返回一个 401 状态代码，并包含一个或多个 WWW-Authenticate 标头，其中列出了支持的身份验证类型。
3.  浏览器检测到我对 XMLHttpRequest 对象的调用的响应是 401，并且响应包括 WWW-Authenticate 标头。然后它会弹出一个身份验证对话框，再次询问用户名和密码。

这一切都很好，直到第 3 步。我不想弹出对话框，我想在我的 AJAX 回调函数中处理 401 响应。（例如，通过在登录页面上显示错误消息。）当然，我希望用户重新输入他们的用户名和密码，但我希望他们看到我友好、令人放心的登录表单，而不是浏览器的丑陋默认身份验证对话框。

顺便说一句，我无法控制服务器，因此不能让它返回自定义状态代码（即 401 以外的代码）。

有什么办法可以抑制身份验证对话框？特别是，我可以在 Firefox 2 或更高版本中取消“需要身份验证”对话框吗？有什么方法可以抑制 IE 6 及更高版本中的 Connect to *[host]*对话框？

* * *

**编辑**
*来自作者的附加信息（9 月 18 日）：*
我应该补充一点，弹出的浏览器身份验证对话框的真正问题是它向用户提供的信息不足。

用户刚刚通过登录页面上的表单输入了用户名和密码，他认为他已经正确输入了它们，并且他点击了提交按钮或回车。他的期望是他将被带到下一页，或者可能被告知他输入的信息有误，应该再试一次。然而，他却看到了一个意想不到的对话框。

*该对话框不*承认他刚刚输入了用户名和密码这一事实。它没有明确说明存在问题并且他应该再试一次。取而代之的是，对话框会向用户显示诸如“网站说：' *[realm]* '”之类的神秘信息。其中*[realm]*是只有程序员才会喜欢的简短领域名称。

Web 浏览器设计者注意：如果对话框本身更加用户友好，没有人会问如何抑制身份验证对话框。我做登录表单的*全部原因是我们的产品管理团队正确地认为浏览器的身份验证对话框很糟糕。*

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2013-11-26T15:31:43.837

我在这里遇到了同样的问题，我公司的后端工程师实施了一种显然被认为是一种好习惯的行为：当对 URL 的调用返回 401 时，如果客户端设置了标头`X-Requested-With: XMLHttpRequest`，则服务器将`www-authenticate`标头放入其回复。

副作用是不会出现默认的身份验证弹出窗口。

确保您的 API 调用将`X-Requested-With`标头设置为`XMLHttpRequest`. 如果是这样，除了根据这个良好实践更改服务器行为之外，别无他法……

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2015-03-16T16:47:25.100

当同时满足以下两个条件时，浏览器会弹出登录提示：

1.  HTTP 状态为 401
2.  `WWW-Authenticate`响应中存在标头

如果您可以控制 HTTP 响应，那么您可以`WWW-Authenticate`从响应中删除标头，并且浏览器不会弹出登录对话框。

如果您无法控制响应，则可以设置代理以`WWW-Authenticate`从响应中过滤掉标头。

据我所知（如果我错了，请随时纠正我），一旦浏览器收到`WWW-Authenticate`标题，就没有办法阻止登录提示。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-09-18T07:55:54.493

我认为这是不可能的——如果你使用浏览器的 HTTP 客户端实现，它总是会弹出那个对话框。我想到了两个黑客：

1.  也许 Flash 以不同的方式处理这个问题（我还没有尝试过），所以让 Flash 电影发出请求可能会有所帮助。

2.  您可以为您在自己的服务器上访问的服务设置一个“代理”，并让它稍微修改身份验证标头，以便浏览器无法识别它们。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2016-10-05T15:13:29.990

我意识到这个问题及其答案已经很老了。但是，我最终来到了这里。也许其他人也会。

如果您有权访问返回 401 的 Web 服务的代码。在这种情况下，只需将服务更改为返回 403（禁止访问）而不是 401。浏览器不会提示输入凭据以响应 403。403 是未经授权的特定资源的经过身份验证的用户的正确代码。这似乎是OP的情况。

从 403 上的 IETF 文档：

**接收到不足以获得访问权限的有效凭据的服务器应该使用 403（禁止访问）状态码进行响应**

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-04T16:41:20.693

在 Mozilla 中，您可以在创建 XMLHttpRequest 对象时使用以下脚本来实现它：

```
xmlHttp=new XMLHttpRequest();
xmlHttp.mozBackgroundRequest = true;
xmlHttp.open("GET",URL,true,USERNAME,PASSWORD);
xmlHttp.send(null); 
```

第二行阻止对话框....

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-17T18:34:20.037

您使用什么服务器技术，是否有用于身份验证的特定产品？

由于浏览器只是在做它的工作，我相信你必须改变服务器端的东西才能不返回 401 状态码。这可以使用自定义身份验证表单来完成，当身份验证失败时，只需再次返回表单。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-30T04:08:14.387

[在 Mozilla 领域，将 XMLHttpRequest ( docs](https://developer.mozilla.org/en/XMLHttpRequest#Attributes) )的 mozBackgroundRequest 参数设置为 true 会抑制这些对话框并导致请求失败。但是，我不知道跨浏览器的支持有多好（包括那些失败请求的错误信息的质量是否跨浏览器非常好。）

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-07-26T09:54:20.633

jan.vdbergh 有道理，如果您可以将服务器端的 401 更改为另一个状态码，浏览器将不会捕获并绘制弹出窗口。另一种解决方案可能是将 WWW-Authenticate 标头更改为另一个自定义标头。我不相信为什么不同的浏览器不支持它，在几个版本的 Firefox 中我们可以使用 mozBackgroundRequest 进行 xhr 请求，但是在其他浏览器中呢？在这里， Chromium 中有一个与此问题相关的有趣[链接。](http://code.google.com/p/chromium/issues/detail?can=2&start=0&num=100&q=&colspec=ID%20Pri%20Mstone%20ReleaseBlock%20OS%20Area%20Feature%20Status%20Owner%20Summary&groupby=&sort=&id=31582)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-05-28T15:57:42.280

我对 MVC 5 和 VPN 也有同样的问题，每当我们在 DMZ 之外使用 VPN 时，我们发现自己必须回答这个浏览器消息。使用.net，我只需使用处理错误的路由

```
<customErrors defaultRedirect="~/Error"  >
  <error statusCode="401" redirect="~/Index"/>
</customErrors> 
```

到目前为止，它一直有效，因为主控制器下的 Index 操作验证了用户。此操作中的视图（如果登录不成功）具有登录控件，我使用这些登录控件通过传递到目录服务的 LDAP 查询来登录用户：

```
 DirectoryEntry entry = new DirectoryEntry("LDAP://OurDomain");
      DirectorySearcher Dsearch = new DirectorySearcher(entry);
      Dsearch.Filter = "(SAMAccountName=" + UserID + ")";
      Dsearch.PropertiesToLoad.Add("cn"); 
```

虽然到目前为止它运行良好，但我必须让您知道我仍在测试它并且上面的代码没有理由运行，因此它可能会被删除......测试目前包括尝试发现第二组的情况的代码有更多用处。同样，这是一项正在进行中的工作，但由于它可能会有所帮助或让你的大脑思考一些想法，所以我决定现在添加它......一旦完成所有测试，我将使用最终结果更新它。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-10-18T00:14:08.870

我正在使用 Node、Express 和 Passport，并且遇到了同样的问题。我通过将`www-authenticate`标头显式设置为空字符串来使其工作。就我而言，它看起来像这样：

```
(err, req, res, next) => {
  if (err) {
    res._headers['www-authenticate'] = ''
    return res.json(err)
  }
} 
```

我希望对某人有所帮助！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-05-24T11:16:30.793

对于那些不喜欢 C# 的人来说，这里`ActionAttribute`是返回`400`而不是`401`, 和 'swallows' Basic auth 对话框。

```
public class NoBasicAuthDialogAuthorizeAttribute : AuthorizeAttribute
{
    protected override void HandleUnauthorizedRequest(AuthorizationContext filterContext)
    {
        base.HandleUnauthorizedRequest(filterContext);
        filterContext.Result = new HttpStatusCodeResult(400);
    }
} 
```

使用如下：

```
[NoBasicAuthDialogAuthorize(Roles = "A-Team")]
public ActionResult CarType()
{
 // your code goes here
} 
```

希望这可以节省您一些时间。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-01-31T08:42:59.177

我最近在为三星 Tizen 智能电视开发网络应用程序时遇到了类似的情况。需要扫描整个本地网络，但很少有 IP 地址返回带有“www-authenticate”标头的“401 Unauthorized”响应。[由于“基本”身份验证类型（ https://developer.mozilla.org/en-US/docs/Web/HTTP/Authentication](https://developer.mozilla.org/en-US/docs/Web/HTTP/Authentication)），它弹出了一个浏览器身份验证弹出窗口，要求用户输入“用户名”和“密码” 。

为了摆脱这种情况，对我有用的简单方法是设置**凭据：“省略”** Fetc Api Call ( [https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch) )。官方文档说：

为了确保浏览器不在请求中包含凭据，请使用凭据：'省略'

```
fetch('https://example.com', {
  credentials: 'omit'
})
```

# apache - 如何设置 FollowSymLinks？

> ID：86119
> 
> 赞同：1
> 
> 时间：2008-09-17T18:23:08.347
> 
> 标签：apache, configuration

我正在尝试让 Apache 遵循指向包含一些大型数据文件的 RAID 阵列服务器的符号链接。我试过修改`httpd.conf`有这样的条目

```
<Directory "/Users/imagine/Sites">
  Options FollowSymLinks
  AllowOverride all
  Order allow,deny
  Allow from all
</Directory> 
```

让 Apache 跟随站点文件夹中的任何符号链接。

我不断收到错误返回，似乎表明我没有任何访问文件的权限。错误是：

> 禁止的
> 
> 您无权访问此服务器上的 /~imagine/imageLibraryTest/videoClips/imageLibraryVideos/imageLibraryVideos/Data13/0002RT-1.mov。

sys 链接文件是该行中的最后一个“imageLibraryVideos”，其中 Data13 是包含该文件的服务器上的子目录。

0002RT-1.mov 文件具有以下权限：

```
-rwxrwxrwx   1 imagine  staff  1138757 Sep 15 17:01 0002RT-1.mov 
```

并且在这条路上：

```
cd /Volumes/ImagineProducts-1/Users/imagine/Sites/imageLibraryVideos/Data13 
```

链接指向：

```
lrwxr-xr-x  1 imagine  staff   65 Sep 15 16:40 imageLibraryVideos -> /Volumes/ImagineProducts-1/Users/imagine/Sites/imageLibraryVideos 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-08-23T00:21:20.243

上周我遇到了同样的问题，解决方案对我来说非常简单。

跑：

```
sudo -i -u www-data 
```

然后尝试逐个目录导航路径。您有时会注意到您无权打开该目录。如果您进入最后一个目录，请检查您是否可以读取该文件（例如带有 head ）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-26T17:39:53.547

您还应该查看绑定挂载而不是符号链接 - 这将允许您在新点重新挂载给定路径。下面是一个例子：

```
mount --rbind /path/to/current/location/somewhere/else /new/mount/point 
```

您还可以编辑您的`fstab`以在启动时执行此操作：

```
/path/to/original /new/path bind defaults,bind 0 0 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T18:25:41.040

查看封闭目录。它们至少需要为 711 模式。 ( `drwx--x--x`)

此外，请查看（或来自和的`/var/log/apache2/error_log`任何连接）以获取可能更详细的错误消息。`ServerRoot``ErrorLog``httpd.conf`

最后，确保在弄乱`httpd.conf`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T18:28:19.677

这是一个权限问题，其中运行您的 Web 服务器的用户对符号链接路径中的必要目录没有读取和/或执行权限。快速简便的检查方法是`su - web-user`（运行 Web 服务器的用户帐户在哪里`web-user`），然后尝试 cd 进入路径并查看文件。当您遇到无权进入的目录时，您必须更改权限和/或所有权，以使其可由 Web 服务器用户帐户访问。

# sql-server - VB6/Microsoft Access/DAO 到 VB.NET/SQL Server... 有建议吗？

> ID：86129
> 
> 赞同：0
> 
> 时间：2008-09-17T18:24:59.280
> 
> 标签：sql-server, vb.net, vb6, dao, vb6-migration

我可以在 VB6/Access 中创建一个 DAO 记录集做任何事情——添加数据、清理数据、移动数据、早上整理数据并将其带到学校。但我什至不知道在 .NET 中从哪里开始。

我从数据库中检索数据没有任何问题，但是当他们需要编辑数据并将其放回时，真实的人会做什么？

在 .NET 和 SQL Server 的相关表中编辑、更新和追加数据的最简单和最直接的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-09-17T18:26:56.577

尝试使用`oledbConnection`,`oledbCommand`和`oledbDataReader`

```
from System.data.oledb 
```

如果您使用的是 sqlserver DB，则使用`SqlConnection`,`sqlCommand`和`sqlDataReader`

```
from System.data.SqlClient 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T18:29:57.893

来自 DAO 的自然进展 IMO 是 ADO.net。我认为你会发现很容易掌握 DAO 的理解/基础。它使用类似于记录集的 DataAdapter 和 DataSet。 [在 ADO.NET 中修改数据](http://msdn.microsoft.com/en-us/library/ms254950(VS.80).aspx)。

我建议您有机会时 研究一下[Linq 。](http://msdn.microsoft.com/en-us/library/bb425822.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T19:51:36.560

[DataSet](http://msdn.microsoft.com/en-us/library/system.data.dataset(VS.71).aspx)类是开始的地方。正如链接文章所说，创建 DataSet、修改它、然后更新数据库的步骤通常是：

1.  使用 DataAdapter 使用来自数据源的数据构建和填充 DataSet 中的每个 DataTable。
2.  通过添加、更新或删除 DataRow 对象来更改单个 DataTable 对象中的数据。
3.  调用 GetChanges 方法以创建第二个 DataSet，该数据集仅包含对数据的更改。
4.  调用 DataAdapter 的 Update 方法，将第二个 DataSet 作为参数传递。
5.  调用 Merge 方法将第二个 DataSet 中的更改合并到第一个中。
6.  调用 DataSet 上的 AcceptChanges。或者，调用 RejectChanges 以取消更改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T23:53:11.020

此处添加 ms-access 作为标签是否有原因？在我看来，这个问题只与 Access 最无关紧要，因为一旦您使用 .NET，Access 就完全不存在了。

# python - 各种 Python 实现的优缺点是什么？

> ID：86134
> 
> 赞同：9
> 
> 时间：2008-09-17T18:25:28.013
> 
> 标签：python

我对 Python 比较陌生，我一直使用标准的 cpython (v2.5) 实现。

不过，我一直想知道其他实现，尤其是 Jython 和 IronPython。是什么让他们变得更好？是什么让他们变得更糟？还有哪些其他实现方式？

我想我正在寻找的是每个实现的摘要和优缺点列表。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-17T18:31:21.510

**如果您迫切需要与在不同平台上编写的现有库进行交互，例如如果您有 100,000 行 Java 并且您只想编写一个 20 行 Python 脚本，那么**Jython**和**IronPython将非常有用。**在我看来，对其他任何东西都不是特别有用，因为由于社区的惰性，它们永远是 CPython 后面的几个版本。**

 ****Stackless**很有趣，因为它支持绿色线程、延续等。有点像 Erlang-lite。

**PyPy**是一个实验性的解释器/编译器，有朝一日可能会取代 CPython，但现在更多的是新想法的试验台。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-18T04:44:08.760

至少对某些人来说，Jython 的另一个好处是[它缺少 GIL](http://zyasoft.com/pythoneering/2008/06/realizing-jython-25.html)（全局解释器锁）并使用 Java 的本机线程。这意味着您可以并行运行纯 Python 代码，这是 GIL 无法做到的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-17T18:33:09.277

此处列出了所有实现：

[https://wiki.python.org/moin/PythonImplementations](https://wiki.python.org/moin/PythonImplementations)

CPython 是“参考实现”，由 Guido 和核心开发人员开发。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T18:30:41.513

优点：访问可用于 JVM 或 CLR 的库。

缺点：两者在功能方面自然落后于 CPython。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T19:00:15.450

IronPython 和 Jython 使用 .NET 或 Java 的运行时环境，随之而来的是即时编译和不同于原始 CPython 的垃圾收集器。由于 JIT，它们可能也比 CPython 更快，但我不确定。

使用 Jython 或 IronPython 的一个缺点是您不能使用本机 C 模块，它们只能在 CPython 中使用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-17T19:26:12.533

[PyPy](http://codespeak.net/pypy/dist/pypy/doc/home.html)是用 RPython 编写的 Python 实现，它是 Python 的一个子集。

RPython 可以翻译成在 VM 上运行，或者与标准 Python 不同，RPython 可以静态编译。

# .net - 在 .NET 中获取默认打印机的最佳方法是什么

> ID：86138
> 
> 赞同：87
> 
> 时间：2008-09-17T18:25:41.760
> 
> 标签：.net

我需要获取默认打印机名称。我将使用 C#，但我怀疑这更像是一个框架问题，而不是特定于语言的。

* * *

## 回答 #1

> 赞同：140
> 
> 时间：2008-09-17T18:32:56.343

我发现最简单的方法是创建一个新`PrinterSettings`对象。它以所有默认值开头，因此您可以检查其*Name*属性以获取默认打印机的名称。

`PrinterSettings`位于命名空间中的 System.Drawing.dll 中`System.Drawing.Printing`。

```
PrinterSettings settings = new PrinterSettings();
Console.WriteLine(settings.PrinterName);
```

或者，您可以使用静态`PrinterSettings.InstalledPrinters`方法获取所有打印机名称的列表，然后设置*PrinterName*属性并检查*IsDefaultPrinter*。我没有尝试过，但文档似乎表明它不起作用。显然*IsDefaultPrinter*仅在未明确设置*PrinterName时为真。*

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2008-09-17T18:54:22.017

另一种方法是使用 WMI（您需要添加对 System.Management 程序集的引用）：

```
public static string GetDefaultPrinterName()
{
    var query = new ObjectQuery("SELECT * FROM Win32_Printer");
    var searcher = new ManagementObjectSearcher(query);

    foreach (ManagementObject mo in searcher.Get())
    {
        if (((bool?) mo["Default"]) ?? false)
        {
            return mo["Name"] as string;
        }
    }

    return null;
} 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-09-17T20:34:30.997

如果您只想要打印机名称根本没有优势。但是 WMI 能够返回一大堆其他打印机属性：

```
using System;
using System.Management;
namespace Test
{
    class Program
    {
        static void Main(string[] args)
        {
            ObjectQuery query = new ObjectQuery(
                "Select * From Win32_Printer " +
                "Where Default = True");

            ManagementObjectSearcher searcher =
                new ManagementObjectSearcher(query);

            foreach (ManagementObject mo in searcher.Get())
            {
                Console.WriteLine(mo["Name"] + "\n");

                foreach (PropertyData p in mo.Properties)
                {
                    Console.WriteLine(p.Name );
                }
            }
        }
    }
} 
```

而不仅仅是打印机。如果您对任何类型的计算机相关数据感兴趣，您可以通过 WMI 获得它。WQL（SQL 的 WMI 版本）也是它的优势之一。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-03-06T16:35:11.087

在这种情况下，我总是使用 System.Printing.LocalPrintServer，它还可以获取打印机是本地的、网络的还是传真的。

```
string defaultPrinter;
using(var printServer = new LocalPrintServer()) {
  defaultPrinter = printServer.DefaultPrintQueue.FullName);
} 
```

或使用静态方法 GetDefaultPrintQueue

```
LocalPrintServer.GetDefaultPrintQueue().FullName 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-08-11T08:24:03.910

也试试这个例子

```
 PrinterSettings printerName = new PrinterSettings();

 string defaultPrinter;

 defaultPrinter = printerName.PrinterName; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-05-15T10:35:19.167

这应该有效：

`using System.Drawing.Printing;`

`PrinterSettings settings = new PrinterSettings(); string defaultPrinterName = settings.PrinterName;`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-11T10:51:39.293

*   1st创建`PrintDialog`对象的一个​​实例。
*   然后调用打印对话框对象并`PrinterName`留空。这将导致 windows 对象返回默认的打印机名称
*   将其写入字符串并在调用打印过程时将其用作打印机名称

代码：

```
Try

    Dim _printDialog As New System.Windows.Forms.PrintDialog

    xPrinterName = _printDialog.PrinterSettings.PrinterName '= "set as Default printer"

Catch ex As Exception
    System.Windows.Forms.MessageBox.Show("could not printed Label.", "Print Error", MessageBoxButtons.OK, MessageBoxIcon.Error)
End Try 
```

# .net - 帮助获得 .Net WinForms 应用程序以支持 Vista Aero Glass

> ID：86143
> 
> 赞同：4
> 
> 时间：2008-09-17T18:26:40.493
> 
> 标签：.net, winforms, windows-vista, aero

有一些技巧可以让 .Net 表单支持玻璃。

我认为这种方法的原始来源在这里：http: [//blogs.msdn.com/tims/archive/2006/04/18/578637.aspx](http://blogs.msdn.com/tims/archive/2006/04/18/578637.aspx)

基本上：

```
//reference Desktop Windows Manager (DWM API)
[DllImport( "dwmapi.dll" )]
static extern void DwmIsCompositionEnabled( ref bool pfEnabled );

[DllImport( "dwmapi.dll" )]
static extern int DwmExtendFrameIntoClientArea( IntPtr hWnd, ref MARGINS pMarInset );

//then on form load
//check for Vista
if ( Environment.OSVersion.Version.Major >= 6 )
{
    //check for support
    bool isGlassSupported = false;
    DwmIsCompositionEnabled( ref isGlassSupported );

    if ( isGlassSupported )
        DwmExtendFrameIntoClientArea( this.Handle, ref margins );
...

//finally on print draw a black box over the alpha-ed area
//Before SP1 you could also use a black form background 
```

最后一步是问题所在 - 在该区域上绘制的任何子控件似乎也将黑色视为 alpha 透明度蒙版。

例如，类区域上的标签条将具有透明文本。

有没有解决的办法？

有没有更简单的方法来做到这一点？

我正在处理的应用程序必须同时在 XP 和 Vista 上运行——我需要它们优雅地降级。这里有什么最佳实践吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T18:30:30.857

确实没有更简单的方法可以做到这一点。.NET Framework（还）未公开这些 API，因此唯一的方法是通过某种互操作（或 WPF）。

至于使用这两个 Windows 版本，您拥有的代码应该没问题，因为在您实际调用该函数之前，运行时不会寻找 DLL 的入口点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T18:33:23.580

丹尼蓝精灵说了算。通过 .NET 框架，您没有对这些 API 的直接“托管”访问权限（几周前我自己尝试过）。

我最终做了一件令人讨厌的事情。使用 GDI+ 创建了我自己的 UI。（按钮、圆形标签等）。无论 Windows 版本如何，它看起来都一样。Win.Forms 真的很丑，但这就是你在 XP < 方面得到的全部。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T18:49:01.500

我想你忘了设置你想成为玻璃的区域的 TransparencyKey。从文章来看，

> 在您的 Windows 窗体应用程序中，您只需将 TransparencyKey 属性设置为您不会在应用程序其他地方使用的颜色（我使用 Gainsboro，原因将在稍后变得明显）。然后，您可以创建一个或多个停靠在表单边缘的面板，并将面板的背景颜色设置为透明度键。现在，当您调用 DwmExtendFrameIntoClientArea 时，只要您设置了适当的透明度键，玻璃就会显示在其边距内。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T18:36:09.080

我不介意非托管调用——这是使用黑盒来模仿 alpha 行为的黑客行为，以及它对顶部某些组件中黑色元素的影响，这就是问题所在。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-09T16:32:21.810

您可以使用的一个便宜的技巧是在您的表单上放置一个透明的面板控件并将您的控件放在上面——黑色将变为黑色。

# programming-languages - 为什么您使用或不使用多语言解决方案来实施？

> ID：86151
> 
> 赞同：4
> 
> 时间：2008-09-17T18:27:51.393
> 
> 标签：programming-languages, polyglot

多语言或多语言解决方案允许您将语言应用于最适合的问题。然而，至少根据我的经验，软件商店倾向于将“超级”语言应用到他们试图解决的问题的各个方面。即使有另一种语言可以简单自然地解决问题，坚持使用这种语言也会带来“地狱或高水位”。为什么您使用或不使用多语言解决方案来实施？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T18:43:39.610

我几乎总是提倡在解决方案空间中使用超过 1 种语言（实际上，超过 2 种，因为 SQL 是众多项目的一部分）。即使客户喜欢具有明确类型和大量人才的语言，我也提倡使用脚本语言进行管理、测试、数据清理等。

多语言的优势归结为“适合工作的工具”。

但是，有一些合理的缺点：

*   更难拥有集体代码所有权（不是每个人都精通所有语言）
*   集成问题（在托管平台中减少）
*   基础设施库的运行时开销增加（这通常很重要）
*   工具成本增加（IDE、分析工具等）
*   从一个切换到另一个时认知“颠簸”。这是一把双刃剑：对于那些精通的人来说，不同的范式是相辅相成的，当其中一个出现问题时，通常会出现“但在 XI 中会用 Z 解决这个问题！” 并且问题很快得到解决。然而，对于那些不太了解范式的人来说，在试图理解“这是什么？”时可能会真正放慢速度。

* * *

我还认为应该说，如果您要使用多种语言，我认为您应该使用具有明显不同方法的语言。我认为通过在一个项目中同时使用 C# 和 VB，您在解决问题方面并没有什么收获。我认为除了您的主流语言之外，您还希望拥有一种脚本语言（小型和一次性任务的高生产力）和一种具有截然不同的认知风格的语言（Haskell、Prolog、Lisp 等）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-07T16:49:32.267

我的雇主的态度一直是使用有效的方法。

这意味着当我们找到一些有用`Perl`的模块（比如实现“本福德定律”的模块`Statistics::Benford`）时，我必须学习如何使用 ActiveState 的`PDK`.

当我们决定在我们的项目中添加区间数学时，我必须学习 Ada 以及如何同时使用`GNAT`和`ObjectAda`.

当需要一个高速字符串库时，我不得不重新学习汇编程序并`MASM32`习惯`WinAsm`.

当我们想要一个 COM DLL `libiconv`（基于 Delphi Inspiration 的代码）时，我重新熟悉了`Delphi`.

当我们想使用 Dr. Bill Poser 的`libuninum`时，我不得不重新学习`C`，以及如何使用`Visual C++`6 的 IDE。

我们仍然在`VB6`and中做原型`VBScript`，因为他们很擅长。

也许在某个时候，我最终会在 Forth、Eiffel 或 D 中做一些事情，或者，上帝保佑我，Haskell（我对语言本身没有任何反对意见，它只是一个*非常*不同的范式。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T18:37:06.210

我很幸运能够在小型项目中工作，并有可能为我的任务建议一种合适的语言。例如，C 作为一种低级语言，将 Lua 扩展为高级/原型设计非常好，在新的嵌入式平台上快速上手。对于任何更大的项目，我总是更喜欢两种语言，一种特定领域的语言适合该特定项目。它为快速尝试新功能增加了很多表现力。

然而，这可能最适合您的敏捷开发方法，而对于更传统的项目，要克服的第一个障碍是选择使用哪种语言，当脚本语言往往立即看起来是“新手”，营销推动力或“严肃性”较少时图片。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-17T18:48:51.047

多语言解决方案的最大问题是涉及的语言越多，就越难找到具有适当技能的程序员。特别是如果任何一种语言甚至有点深奥，或者来自完全不同的设计学校（例如 - 功能与过程与面向对象）。是的，任何优秀的程序员都应该能够学习他们需要的东西，但是管理层通常希望有人能够“一举两得”，无论这多么不切实际。

其他原因包括代码重用、不同语言之间接口的复杂性增加，以及关于特定代码应该属于哪种语言的不可避免的地盘之争。

综上所述，要意识到许多系统在设计上都是多语言的——任何使用数据库的东西都会有 SQL 和其他一些语言。而且通常还涉及到脚本，无论是针对实际代码还是针对构建系统。

我几乎所有的专业编程经验都属于上述类别。通常有一种核心语言（C 或 C++）、不同程度的 SQL、shell 脚本，可能还有一些外围的 perl 或 python 代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T18:33:51.037

我遇到的一个问题是 Visual Studio 不允许在单个项目中混合多种语言，这迫使您将事物抽象为每种语言的单独 DLL，这不一定是理想的。

然而，我怀疑主要原因是认为在许多不同语言之间来回切换会导致程序员效率低下。这是有道理的，我经常在 JavaScript、C#、VBScript 和 VB.NET 之间切换，当我从一种语言切换到另一种语言时，会浪费一些时间，因为我会稍微混合一下我的语法。

尽管如此，肯定还有更多“多语言”解决方案的空间，尤其是超越使用 JavaScript 和任何后端编程语言的解决方案。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-06T23:24:25.263

好吧，现在所有的网络都是多语言的，后面是 Java/PHP/Ruby，前面是 JavaScript……我想到的其他例子——一个用低级语言（C 或 C++）编写的灵活复杂系统，带有嵌入式高级语言（Python、Lua、Scheme）提供定制和脚本接口。Microsoft Office 和 VBA、Blender 和 Python。

一个可以用脚本语言（如 Python）完成的项目，其性能关键或依赖于操作系统的部分用 C 完成。

JVM 和 CLR 都获得了许多新的有趣的脚本语言兼容。Java + Groovy、C# + IRonPython 等。

# flickr - 为什么我需要一个 flickr api 密钥？

> ID：86163
> 
> 赞同：15
> 
> 时间：2008-09-17T18:29:52.670
> 
> 标签：flickr

通读 Flickr API 文档，它一直说我需要一个 API 密钥才能使用他们的 REST 协议。我只是在构建一个照片查看器，从 Flickr 的[公共照片提要](http://www.flickr.com/services/feeds/docs/photos_public/)中收集可用信息（例如，我不打算编写需要 API 密钥的上传脚本）。**我可以通过获取密钥获得任何附加功能吗？**

**更新**我回答了下面的问题

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-09-17T18:34:35.357

> 要使用 Flickr API，您需要有一个应用程序密钥。**我们使用它来跟踪 API 使用情况。**
> 
> 目前，只有在事先获得许可的情况下才允许将 API 用于商业用途。用于商业用途的 API 密钥请求由工作人员审核。如果您的项目是个人的、艺术的、免费的或其他非商业的，请不要索取商业密钥。如果您的项目是商业性的，请提供足够的细节来帮助我们做出决定。谢谢！

[http://www.flickr.com/services/api/misc.api_keys.html](http://www.flickr.com/services/api/misc.api_keys.html)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-19T13:27:47.673

我们设置了一个帐户并获得了一个 API 密钥。问题的答案是，是的，在创建简单的照片查看器之类的东西时**，API 密钥具有高级功能。**[flickr.photos.search](http://www.flickr.com/services/api/flickr.photos.search.html)命令具有比[公共照片提要](http://www.flickr.com/services/feeds/docs/photos_public/)更多的接收图像 rss 提要的功能，例如仅检索自上次提要请求以来的新照片（通过`min_upload_date`属性）或仅搜索“安全照片”。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-17T18:40:32.737

如果您有密钥，他们可以监控您的使用情况并确保一切正常——您低于请求限制等。他们可以将常规与 API 使用情况的统计数据分开。如果他们遇到响应时间问题，他们可以让 API 用户的响应速度稍慢一些，以保持主网站快速响应等。

这些就是他们的好处。

对你的好处？如果你只是写了一个爬虫，它做了一些他们不喜欢经常打他们的事情，他们会毫不客气地阻止你破坏他们的服务条款。

如果您只想击中它几次，则无需钥匙即可逃脱。如果您正在编写一项会在他们的提要中被点击数千次的服务，那么您希望让他们有礼貌地遵守他们的规则。

另外，就像 Dave Webb 所说，API 更好。但这是在旁观者的眼中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T18:32:18.450

Flickr API 非常好用且易于使用，并且比自己抓取提要容易得多。

获取密钥大约需要 2 分钟 - 您在网站上填写表格，然后通过电子邮件将其发送给您。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T18:33:49.587

好吧，他们说您需要一个密钥 - 您需要一个密钥，然后 :-) 公开 API 意味着您可以更轻松地将数据从站点中提取出来，他们希望对此进行控制是可以理解的。它与其他启用 API 的站点几乎相同。

# jsf - 如何提高 RichFaces ScrollableDataTable 控件的性能？

> ID：86171
> 
> 赞同：5
> 
> 时间：2008-09-17T18:30:40.997
> 
> 标签：jsf, richfaces

**首先，一点背景：**

我正在使用 ScrollableDataTable 显示具有 288 行和 8 列（2304 条记录）的数据集，性能还有很多不足之处。重新呈现控件的 AJAX 请求需要将近 20 秒才能完成，而使用 DataTable 控件呈现相同数据时需要 7 秒。

通过 Servlet 过滤器和 JavaScript 捕获的指标表明，几乎所有的处理时间都花在了客户端上。在 19.87 秒的请求中，3.87 秒花费在服务器上……查询和排序数据花费的时间不到 0.6 秒。

切换到 DataTable 控件将请求、响应和呈现周期减少到我在 ScrollableDataTable 中看到的 1/3，但也删除了几个重要功能。

**现在的问题是：**

是否有其他人遇到过 ScrollableDataTable 的性能问题？在具有固定列和两轴滚动的 JSF/RichFaces 中呈现大量表格数据的最有效方法是什么？

**更新：**

我们最终编写了一个自定义控件。对渲染组件和生成的 JavaScript 的完全控制使我们能够实现与 DataTable 相当的响应时间。不过，我同意 Zack 的观点——分页是正确的答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-04T14:48:39.727

瓶颈很可能出现在 JSF 生命周期的“呈现响应”阶段。它试图一次为视图渲染太多组件。

我的建议是使用分页。它应该会显着提高您的性能，因为它一次渲染视图的较小部分。

确保您设置`rich:dataTable`了`rows`属性，并且 - 如果您正在执行任何列过滤 - 确保日期表也具有`reRender="paginator"`paginator 是您的属性`rich:datascroller`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T21:05:20.843

很久以前我遇到过类似的问题，最后写了一个小程序来显示使用 livescript 与页面交互的数据。我的性能问题与您所看到的相同。客户端花了 30 多秒来呈现表格数据，服务器在不到 2 秒的时间内将我的响应转过来。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-08T16:32:07.700

这听起来像是为呈现表格而生成的 javascript 中的错误。您是否在不同的浏览器中尝试过该页面？您正在使用哪个 JSF 实现（RI 或 MyFaces 或其他）？

# perl - CGI.pm 通常在哪里创建临时文件？

> ID：86175
> 
> 赞同：2
> 
> 时间：2008-09-17T18:31:38.250
> 
> 标签：perl, cgi, activestate

在我所有的 Windows 服务器上，除了一台机器，当我执行以下代码来分配一个临时文件夹时：

```
use CGI;
my $tmpfile = new CGITempFile(1);
print "tmpfile='", $tmpfile->as_string(), "'\n"; 
```

变量`$tmpfile`被赋值`'.\CGItemp1'`，这就是我想要的。但在我的一台服务器上，它被错误地设置为`C:\temp\CGItemp1`.

所有服务器都运行 Windows 2003 标准版、IIS6 和 ActivePerl 5.8.8.822（升级到更高版本的 Perl 不是一个选项）。从命令行或在 IIS 中作为 CGI 脚本（其中 scriptmap `.pl`= `c:\perl\bin\perl.exe "%s" %s`）运行脚本时，结果始终相同。

我如何修复这个 Perl 安装并强制它`.\CGItemp1`默认返回“”？

我什至将整个 Perl 文件夹从其中一台工作服务器复制到这台机器上，但没有任何乐趣。

[@Hometoast：](https://stackoverflow.com/questions/86175/where-is-cgi-pm-supposed-to-create-temporary-files/86200#86200)

我检查了 ' `TMP`' 和 ' `TEMP`' 环境变量，`$ENV{TMP}`并且`$ENV{TEMP}`它们是相同的。

从命令行它们指向用户配置文件目录，例如：

> `C:\DOCUME~1\[USERNAME]\LOCALS~1\Temp\1`

当在 IIS 下作为 CGI 脚本运行时，它们都指向：

> `c:\windows\temp`

在 registry key`HKEY_USERS/.DEFAULT/Environment`中，两台服务器都有：

> `%USERPROFILE%\Local Settings\Temp`

ActiveState 的实现`CGITempFile()`显然使用了一种替代机制来确定它应该如何生成临时文件夹。

[@Ranguard：](https://stackoverflow.com/questions/86175/where-is-cgi-pm-supposed-to-create-temporary-files/86993#86993)

真正的问题在于`CGI.pm`模块和附件处理。每当将文件上传到站点时，都`CGI.pm`需要将其临时存储在某个地方。为此，`CGITempFile()`在内部调用`CGI.pm`以分配一个临时文件夹。所以不幸的是我不能使用`File::Temp`. 不管怎么说，还是要谢谢你。

[@克里斯：](https://stackoverflow.com/questions/86175/where-is-cgi-pm-supposed-to-create-temporary-files/86874#86874)

这帮助了很多人。我之前确实快速浏览了`CGI.pm`源代码，但您的建议让我回过头来更加认真地查看它以了解底层算法。我得到了工作，但最奇怪的是服务器上最初没有`c:\temp`文件夹。

为了获得临时修复，我创建了一个`c:\temp`文件夹并为网站的匿名用户帐户设置了相关权限。但是因为这是一个共享框，所以即使临时文件正在被删除，我也不能那样做。长话短说，我将`c:\temp`文件夹重命名为不同的名称，并且神奇地返回了正确的 ' `.\`' 文件夹路径。我还注意到客户在网站上启用了 FrontPage 扩展，这会删除网站文件夹上匿名用户帐户的写入权限，因此需要重新申请此权限。我仍然不知道为什么在这个问题开始时`CGITempFile()`正在返回`c:\temp`，即使该文件夹不存在，以及为什么它神奇地再次开始工作。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-17T19:45:16.887

临时目录的名称保存在 CGI.pm`$CGITempFile::TMPDIRECTORY`的函数中并在函数中初始化。`find_tempdir`CGI.pm 文档中描述了选择临时目录的算法（搜索**-private_tempfiles**）。IIUC，如果服务器上存在 C:\Temp 文件夹，CGI.pm 将使用它。如果签入的目录都不`find_tempdir`存在，则当前目录为“。” 用来。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T19:59:03.047

不是您问题的直接答案，但您是否尝试过使用[File::Temp](http://search.cpan.org/dist/File-Temp/)？

它专为在任何操作系统上工作而设计。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T18:35:16.930

如果您正在运行此脚本，请检查 %TEMP% 环境变量以查看它是否不同。

如果 IIS 正在执行，请检查注册表中 HKEY_USERS/.DEFAULT/Environment 下 TMP 和 TEMP 的值

# sql - 如何在我的数据库中强制执行数据完整性规则？

> ID：86181
> 
> 赞同：3
> 
> 时间：2008-09-17T18:32:30.290
> 
> 标签：sql, sql-server, database, database-design

我正在设计这个类和抽象（MustInherit）类的集合......</p>

![类图](https://web.archive.org/web/20120911004421/http://img396.imageshack.us/img396/1711/nodeclassinheritanceej0.gif)

这是我要存储所有这些的数据库表……</p>

![数据库表](https://web.archive.org/web/20140725060342/http://img179.imageshack.us/img179/3237/nodetablenorootln3.gif)

据 Microsoft SQL Server 数据库所知，这些都是可空的（“允许空值”）列。

但实际上，这取决于存储在那里的类：LinkNode、HtmlPageNode 或 CodePageNode。

规则可能看起来像这样......

![规则表](https://web.archive.org/web/20140725053359/http://img127.imageshack.us/img127/74/datarulesha0.gif)

如何在我的数据库中强制执行此类数据完整性规则？

* * *

更新：关于这个单表设计......

我仍在尝试将最终架构归零。

我最初从许多具有几乎为零的 nullalbe 字段的小表开始。
[哪个是我导航的最佳数据库架构？](https://stackoverflow.com/questions/56981/which-is-the-best-database-schema-for-my-navigation)

我了解了 LINQ to SQL IsDiscriminator 属性。
[在 SQL 中处理一对一关系的最佳方法是什么？](https://stackoverflow.com/questions/57152/whats-the-best-way-to-handle-one-to-one-relationships-in-sql)

但后来我了解到 LINQ to SQL 只支持单表继承。
[LINQ to SQL IsDiscriminator 列不能继承吗？](https://stackoverflow.com/questions/67659/can-a-linq-to-sql-isdiscriminator-column-not-inherit)

现在我试图用一个类和抽象类的集合来处理它。
[请帮助我处理我的 .NET 抽象类。](https://stackoverflow.com/questions/84263/please-help-me-with-my-net-abstract-classes)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T18:35:34.060

每种类型的节点都有一个唯一的表。

为什么不让您正在构建的类强制执行其自身类型的数据完整性？

* * *

**编辑**

在这种情况下，您可以 a) 使用逻辑约束（见下文）或 b) 存储过程进行插入/编辑（无论如何都是一个好主意）或 c) 再次，只需让类强制数据完整性。

C＆B的混合将是我所采取的事件过程。我将为每个节点类型（即 Insert_Update_NodeType）添加/编辑独特的存储过程，并让类在保存数据之前执行数据验证。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T18:46:53.940

对表使用 CHECK 约束。这些允许您使用任何类型的布尔逻辑（包括表中的其他值）来允许/拒绝数据。

从[在线图书](http://msdn.microsoft.com/en-us/library/ms188258.aspx)网站：

> 您可以使用基于逻辑运算符返回 TRUE 或 FALSE 的任何逻辑（布尔）表达式创建 CHECK 约束。对于前面的示例，逻辑表达式是：salary >= 15000 AND Salary <= 100000。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T18:47:18.383

看起来您正在尝试[单表继承模式，这是](http://martinfowler.com/eaaCatalog/singleTableInheritance.html)[企业应用程序架构](https://rads.stackoverflow.com/amzn/click/com/0321127420)模式一书的对象关系结构模式部分涵盖的模式。

如果您希望通过 SQL 表约束强制数据完整性，我会推荐[类表继承](http://martinfowler.com/eaaCatalog/classTableInheritance.html)或[具体表继承模式。](http://martinfowler.com/eaaCatalog/concreteTableInheritance.html)

虽然这不是我的第一个建议，但您仍然可以使用单表继承并通过存储过程强制执行约束。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-17T18:50:15.910

您可以设置一些**插入/更新触发器**。只需检查这些字段是否为*null*或*notnull*，并在需要时拒绝插入/更新操作。如果您想将所有数据存储在同一个表中，这是一个很好的解决方案。

**您还可以为每个类**创建一个唯一的表。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-17T22:17:49.157

就我个人而言，我总是坚持通过触发器或检查约束将数据完整性代码放在表本身上。原因是您不能保证只有用户界面会更新插入或删除记录。您也不能保证有人可能不会在不了解实际数据完整性规则的情况下编写第二个 sp 来绕过原始 sp 中的约束，甚至因为他或她不知道带有规则的 sp 的存在而编写它。表通常受到 DTS 或 SSIS 包、来自用户界面或通过查询分析器或查询窗口的动态查询，甚至是运行代码的计划作业的影响。如果您不将数据完整性代码放在表级别，那么迟早您的数据将不具有完整性。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-17T18:38:06.067

这可能不是你想听到的答案，而是避免逻辑不一致的最好方法，你真的想看看[数据库规范化](http://en.wikipedia.org/wiki/Database_normalization#Normal_forms)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-17T18:40:20.087

我对 SQL Server 不是很熟悉，但我知道使用 Oracle，您可以指定可以用来执行所需操作的约束。我很确定您也可以在 SQL Server 中定义约束。

编辑：我发现这个[链接](http://www.aspfree.com/c/a/Database-Code/Constraints-In-Microsoft-SQL-SERVER-2000/)似乎有很多信息，有点长，但可能值得一读。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-17T18:46:46.577

*[斯蒂芬的](https://stackoverflow.com/questions/86181/how-do-i-enforce-data-integrity-rules-in-my-database#86203)回答是最好的。*但是如果你必须，你可以添加一个检查约束 HtmlOrCode 列和其他需要更改的列。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-08-30T11:41:31.550

在数据库中实施数据完整性 基本上，有四种主要类型的数据完整性：实体、域、引用和用户定义。

实体完整性适用于行级别；域完整性适用于列级别，引用完整性适用于表级别。

1.  实体完整性确保表没有任何重复的行并且是唯一标识的。

2.  域完整性要求一组数据值落在特定范围（域）内才能有效。换句话说，域完整性通过限制数据类型、格式或可能值的范围来定义给定列的允许条目。

3.  参照完整性关注的是保持表之间的关系同步。

@Zack：您还可以查看此博客以阅读有关数据完整性执行的更多详细信息，请点击此处 - [https://www.bugraptors.com/what-is-data-integrity/](https://www.bugraptors.com/what-is-data-integrity/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-17T18:38:13.583

SQL Server 对您的类一无所知。我认为您必须通过使用为您构造/解构所有这些的工厂类来强制执行此操作，并确保您根据类型传递正确的值。

从技术上讲，这不是“在数据库中执行规则”，但我认为这不能在单个表中完成。字段要么接受空值，要么不接受。

另一个想法可能是探索做同样事情的 SQL 函数和存储过程。但是，您不能强制一个字段对于一条记录为 NOT NULL，而对于下一条记录为 NULL。那是您的业务层/工厂工作。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-17T19:19:41.427

你试过[NHibernate](http://www.hibernate.org/343.html)吗？它是比实体框架更成熟的产品。免费。

# php - 检测在 PHP 中关闭的浏览器连接

> ID：86197
> 
> 赞同：7
> 
> 时间：2008-09-17T18:35:11.253
> 
> 标签：php, apache, http, mod-php

有谁知道在执行长脚本期间是否可以检测浏览器是否关闭了连接`PHP`，使用`apache`and时`mod_php`？

例如，在 中`Java`，如果在浏览器关闭后尝试写入它，`HttpOutputStream`将抛出一个`exception`错误 - 或者将对`checkError()`.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-17T18:42:39.580

使用[connection_aborted()](http://us2.php.net/manual/en/function.connection-aborted.php)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T20:12:03.423

至少在 PHP4 中，connection_aborted 和 connection_status 仅在脚本向浏览器发送任何输出后才起作用（使用：flush() | ob_flush()）。也不要指望准确定时的结果。

检查另一边是否还有人在等待是最有用的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T18:46:55.123

[http://nz.php.net/register-shutdown-function](http://nz.php.net/register-shutdown-function)

如果您只是希望脚本在用户终止时终止并处理它，则可能不那么复杂。

（即：如果这是一个冗长的搜索，这将为您节省大量的操作周期）

# java - JSF/Facelets 中的国际化标签

> ID：86202
> 
> 赞同：5
> 
> 时间：2008-09-17T18:35:33.857
> 
> 标签：java, jsf, internationalization, facelets

[Facelets](https://facelets.dev.java.net/)是否具有任何使用 JSF 可以实现的更整洁或更易读的国际化用户界面文本标签的功能？

例如，对于普通的 JSF，使用 h:outputFormat 是一种在消息中插入变量的非常冗长的方法。

*澄清：*我知道我可以添加一个消息文件条目，如下所示：

```
label.widget.count = You have a total of {0} widgets. 
```

并显示这个（如果我正在使用Seam）：

```
<h:outputFormat value="#{messages['label.widget.count']}">
   <f:param value="#{widgetCount}"/>
</h:outputFormat> 
```

但是输出一个句子会很混乱 - 正是这种事情让 JSF 名声不好。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-19T08:31:51.047

由于您使用的是 Seam，因此您可以在消息文件[中使用 EL 。](http://docs.jboss.com/seam/2.1.0.BETA1/reference/en-US/html_single/#d0e13037)

财产：

```
label.widget.count = You have a total of #{widgetCount} widgets. 
```

XHTML：

```
<h:outputFormat value="#{messages['label.widget.count']}" /> 
```

这仍然使用 outputFormat，但不那么冗长。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-18T14:46:45.130

除了 outputFormat 之外，我从未遇到过另一种方法。不幸的是，它非常冗长。

我唯一可以建议的另一件事是在支持 bean 中创建消息，然后输出它而不是 messageFormat。

就我而言，我将 Spring 的 MessageSource 与 JSF 集成（使用[MessageSourcePropertyResolver](http://www.thearcmind.com/confluence/display/SpribernateSF/Spring+JSF+contribution+Round+1+MessageSourcePropertyResolver)）。然后，在您的支持 bean 中获取参数化消息相当容易——您只需要知道您的用户所在的区域设置（同样，我已将区域设置绑定到支持 bean 属性，因此可以通过 JSF 或 Java 访问它）。

我认为参数——尤其是消息中的参数——是 JSF 真正可以做得更好的一件事！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-19T07:35:59.387

我一直在思考这个问题，我突然想到我可能会编写自己的 JSTL 函数，该函数接受消息键和可变数量的参数：

```
<h:outputText value="#{my:message('label.widget.count', widgetCount)}"/> 
```

如果我的消息函数在输出之前对结果进行 HTML 编码，我什至不需要使用 h:outputText

```
#{my:message('label.widget.count', widgetCount)} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-17T23:11:09.247

您可以创建自己的面孔标签库以使其不那么冗长，例如：

```
<ph:i18n key="label.widget.count" p0="#{widgetCount}"/> 
```

然后在您的视图目录中创建标记库：/components/ph.taglib.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE facelet-taglib PUBLIC "-//Sun Microsystems, Inc.//DTD Facelet Taglib 1.0//EN" "https://facelets.dev.java.net/source/browse/*checkout*/facelets/src/etc/facelet-taglib_1_0.dtd">

<facelet-taglib xmlns="http://java.sun.com/JSF/Facelet">
    <namespace>http://peterhilton.com/core</namespace>

    <tag>
        <tag-name>i18n</tag-name>
        <source>i18n.xhtml</source>
    </tag>

</facelet-taglib> 
```

创建/components/i18n.xhtml

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
        xmlns:h="http://java.sun.com/jsf/html"        
    xmlns:f="http://java.sun.com/jsf/core">

    <h:outputFormat value="#{messages[key]}">
            <!-- crude but it works -->
        <f:param value="#{p0}" />
        <f:param value="#{p1}" />
        <f:param value="#{p2}" />
        <f:param value="#{p3}" />
    </h:outputFormat>

</ui:composition> 
```

通过一些研究，您可能会找到一种优雅的方式来传递论点。

现在在 web.xml 中注册你的新标签库

```
<context-param>
<param-name>facelets.LIBRARIES</param-name>
<param-value>
        /components/ph.taglib.xml
    </param-value>
</context-param> 
```

只需添加`xmlns:ph="http://peterhilton.com/core"`到您的视图中，一切就绪！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-07T12:10:33.080

您可以使用接缝插值器：

```
<h:outputText value="#{interpolator.interpolate(messages['label.widget.count'], widgetCount)}"/> 
```

它上面有@BypassInterceptors，所以性能应该没问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-02-16T06:52:58.340

如果插入消息，则可以直接使用 Bean。

```
label.widget.count = You have a total of #{widgetCount} widgets.
label.welcome.message = Welcome to #{request.contextPath}!
label.welcome.url = Your path is ${pageContext.servletContext}. 
```

`${messages['label.widget.count']}`够了。

这个使用 Spring 效果很好：

```
package foo;

import javax.el.ELContext;
import javax.el.ELException;
import javax.el.ExpressionFactory;
import javax.el.ResourceBundleELResolver;
import javax.faces.context.FacesContext;

import org.springframework.web.jsf.el.SpringBeanFacesELResolver;

public class ELResolver extends SpringBeanFacesELResolver {
    private static final ExpressionFactory FACTORY = FacesContext
            .getCurrentInstance().getApplication().getExpressionFactory();
    private static final ResourceBundleELResolver RESOLVER = new ResourceBundleELResolver();

    @Override
    public Object getValue(ELContext elContext, Object base, Object property)
            throws ELException {
        Object result = super.getValue(elContext, base, property);
        if (result == null) {
            result = RESOLVER.getValue(elContext, base, property);
            if (result instanceof String) {
                String el = (String) result;
                if (el.contains("${") | el.contains("#{")) {
                    result = FACTORY.createValueExpression(elContext, el,
                            String.class).getValue(elContext);
                }
            }
        }
        return result;
    }
} 
```

和...

您需要将 EL-Resolver`faces-config.xml`从更改`org.springframework.web.jsf.el.SpringBeanFacesELResolver`为

问候

```
<el-resolver>foo.ELResolver</el-resolver> 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-09-18T13:07:06.697

使用 ResourceBundle 和属性文件。

# c# - 如何有条件地启用 C# ASP.NET 网站中的操作

> ID：86204
> 
> 赞同：1
> 
> 时间：2008-09-17T18:35:37.727
> 
> 标签：c#

使用配置文件，我想让自己能够打开和关闭诸如（第三方）日志记录和使用 C# 网站中的缓存之类的东西。该解决方案不应特别限于日志记录和缓存，而是更通用，因此我也可以将其用于其他事情。

我有一个配置 xml 文件，我可以在其中断言应该打开或关闭日志记录和缓存（它也可能在 Web.Config 中，这不是现在的重点），这将导致例如 a和`bool logging`a或。`bool caching``true``false`

问题是关于这部分的： **我能做的是在每个与日志记录/缓存相关的语句之前加上`if (logging)`and `if (caching)`。有什么更好的编程方法？这类问题也有编程术语吗？也许属性也是一种方法？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-17T18:36:57.550

为什么不直接使用已经存在的 web.config 和 System.Configuration 功能呢？

无论如何，您的 Web 应用程序将在每次页面加载时解析 web.config，因此当您可以在现有配置上定义自己的部分时，拥有另一个 XML 配置文件所涉及的开销似乎过大了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T18:51:47.280

我很好奇你有什么样的日志/缓存语句？如果您有一些类正在执行 WriteLog 或 StoreCahce 或其他什么...为什么不将 if(logging) 放在 WriteLog 方法中。似乎如果您将所有与日志记录缓存相关的方法放入一个类并且该类知道日志记录/缓存是否打开，那么您可以在每个实例中为自己保存一堆 If 语句。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T18:42:03.967

您可以查看 Microsoft Enterprise Library。它具有诸如日志记录和缓存之类的功能。由于您始终包含日志记录代码，但其下方的实际日志记录由设置控制，因此日志记录变得容易。

[http://msdn.microsoft.com/en-us/library/cc467894.aspx](http://msdn.microsoft.com/en-us/library/cc467894.aspx)

您可以在模式和实践组中找到其他很酷的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T18:40:17.107

有关配置缓存的详细信息，请[参阅 http://msdn.microsoft.com/en-us/library/ms178606.aspx](http://msdn.microsoft.com/en-us/library/ms178606.aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T18:41:01.970

我同意 foxxtrot，您想使用 web.config 并添加一个或两个 appsetting 来保存这些值。

然后对于检查的实现，是的，只需使用 if 来查看您是否需要执行该操作。我强烈建议集中您的日志记录类以防止代码重复。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T18:41:14.933

您可以使用依赖注入容器并让它根据配置加载不同的日志记录和缓存对象。如果您想启用日志记录，您可以在配置中指定一个活动的日志记录对象/提供者；如果您想禁用它，您可以让 DI 注入一个“虚拟”日志记录提供程序，该提供程序不记录任何内容但立即返回。

我倾向于使用更简单的设计，例如 @foxxtrot 提出的设计，但是运行时替换实用程序组件是 DI 可以为您做的一件好事，这很好。

# file - File Replication Solutions

> ID：86211
> 
> 赞同：0
> 
> 时间：2008-09-17T18:36:13.497
> 
> 标签：file, filesystems, replication, xcopy, san

Thinking about a Windows-hosted build process that will periodically drop files to disk to be replicated to several other Windows Servers in the same datacenter. The other machines would run IIS, and serve those files to the masses.

The total corpus size would be millions of files, 100's of GB of data. It'd have to deal with possible contention on the target servers, latent links e.g. over a WAN, cold-start clean servers

Solutions I've thought about so far :

*   queue'd system and daemons either wake periodically and copy or run as services.
*   SAN - expensive, complex, more expensive
*   ROBOCOPY, on a timed job - simple but effective. Lots of internal/indeterminate state e.g. where its at in copying, errors
*   Off the shelf repl. software - less expensive than SAN but still expensive
*   UNC shared folders and no repl. Higher latency, lower cost - still need a clustering solution too.
*   DFS Replication.

What else have other folks used?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T18:38:21.120

I've used rsync scripts with good success for this type of work, 1000's of machines in our case. I believe there is an rsync server for windows, but I have not used it on anything other than Linux.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-19T06:52:19.677

Though we do not have these millions of giga of data to manage, we are sending and collecting lots of files overnight between our main company and its agencies abroad. We have been using allwaysync for a while. It allows folders/ftp synchronization. It has a nice interface that allow folders and files analysis and comparisons, and it can be of course scheduled.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-23T15:10:30.373

UNC shared folders and no replication has many downsides, especially if IIS is going to use UNC paths as home directories for sites. Under stress, you will run into [http://support.microsoft.com/default.aspx/kb/810886](http://support.microsoft.com/default.aspx/kb/810886) because of the number of simultaneous sessions against the server sharing the folder. Also, you will experience slow IIS site startups since IIS is going to want to scan/index/cache (depending on IIS version and ASP settings) the UNC folder.

I've seen tests with DFS that are very promising, exhibition none of the above restrictions.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T18:39:49.727

We use ROBOCOPY in my organization to pass files around. It runs very seamlessly and I feel it worth a recommendation.

Additionally, you are not doing anything too crazy. If you are also proficient in perl, I am sure you could write a quick script that will fulfill your needs.

# c++ - 与 *nix 的电话系统接口

> ID：86219
> 
> 赞同：1
> 
> 时间：2008-09-17T18:37:22.637
> 
> 标签：c++, unix, cisco, tapi

有谁知道从 *nix 中的 C/C++ 应用程序与电话系统（想想 Cisco CCM）接口的任何“标准”方式？我过去使用过 MS TAPI，但这只是 Windows，不想走 jTAPI (Java) 路线，这似乎是唯一的选择。

我想监控电话系统以进行记录（所以我知道用户何时拨打电话、接听电话等）。TAPI 擅长这类事情，但我不能成为第一个想要在没有 Windows 服务器的情况下做类似事情的人。

请注意，我需要与现有的 PABX 系统集成 - 特别是 Cisco CCM 和 Nortel BCM。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T20:16:55.343

我有两种电话标准 TAPI 和 CSTA 的经验，据我所知，供应商（例如 Cisco、Nortel、NEC）之间没有关于标准 API 的此类协议。

我建议在您的目标 PBX 平台上查看[SMDR](http://en.wikipedia.org/wiki/Call_detail_record)（站消息详细记录）的可用性，假设不需要呼叫/设备控制。这将允许您以文本流的形式访问 PBX 活动，并且您可以解析数据以进行进一步操作以满足您的目的。

PBX 供应商之间的格式很可能会有所不同，但希望可以将其抽象出来，以便核心应用程序功能可重用。

这可能是一个更便携的选项，再次假设不需要呼叫/设备控制，因为您不依赖供应商在您选择的平台上提供 CTI 连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-18T20:01:34.407

这是对 SMDR 的另一票。我见过的所有电话系统都提供通过电话盒上的串行端口进行 SMDR 记录的选项。只需从串行端口捕获文本并根据需要对其进行解析。

我编写了一个服务器进程来捕获 SMDR 输出，对其进行解析并将结果保存在数据库中，我们的其他应用程序可以使用该数据库来查看每个电话的分机号、电话号码、时间和长度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-31T18:39:59.663

这是一个老问题，但仍然出现在搜索结果中，所以我想我会在这里发布我的解决方案：

我创建了一个小 bash 脚本，通过 telnet 连接到 Panasonic KX PBX，安排它运行`crontab`，并编写我的应用程序代码来获取日志文件并解析它们。

这是我的 bash 脚本：

```
#!/bin/sh

HOST="192.168.0.200"
PORT="2300"
USER="SMDR"
PASS="PCCSMDR"

FILE=/var/smdr/smdr-`date +%F`.log
TS=`date +"%F %T"`

echo "### ${TS}" >> $FILE

(
  echo open $HOST $PORT
  sleep 2
  echo $USER
  sleep 2
  echo $PASS
  sleep 150
  echo "quit"
) | telnet | tee -a $FILE 
```

# perl - 我可以让 Windows 中的 Perl ithreads 并发运行吗？

> ID：86220
> 
> 赞同：2
> 
> 时间：2008-09-17T18:37:45.800
> 
> 标签：perl, multithreading, concurrency

我有一个尝试使用 Perl 线程（使用线程）设置的 Perl 脚本。当我运行简单的测试时，一切正常，但是当我执行我的实际脚本（其中有运行多个 SQL *Plus 会话的线程）时，每个 SQL* Plus 会话按顺序运行（即线程 1 的 sqlplus 运行步骤 1-5，然后线程 2 的 sqlplus运行步骤 6-11 等）。

我以为我明白线程会进行并发处理，但有些不对劲。有什么想法，还是我应该做一些其他的 Perl 魔法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-17T19:20:23.187

几种可能的解释：

1.  您是在多核处理器还是多处理器机器上运行此脚本？如果你只有一个 CPU，任何时候只有一个线程可以使用它。

2.  步骤 1-6 涉及的事务或锁是否会阻止它同时完成？

3.  您确定您正在使用与数据库的多个连接而不是在线程之间共享一个连接吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T18:45:16.640

实际上，您无法保证线程将以何种顺序执行。所以行为（如果不是你所期望的）并不是真正的错误。

我怀疑您在这里进行了某种同步。可能 SQL*Plus 只让我们自己被调用一次？有些程序会这样做...

其他可能性：

*   线程创建和进程创建（您*正在*为 SQL*Plus 创建子进程，不是吗？）比运行线程花费的时间更长，因此线程 1 甚至在线程 2 开始之前就完成了

*   您正在 SQL 脚本中使用强制同步数据库更新的事务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-18T04:02:25.617

检查您的数据库设置。您可能会发现它是以保守的方式设置的。这将导致即使是很小的读取也会阻止对该信息的所有访问。

您可能还需要调用`threads::yield`.

# java - 最佳 Java GUI 编辑器

> ID：86221
> 
> 赞同：4
> 
> 时间：2008-09-17T18:37:59.093
> 
> 标签：java, user-interface, ide, editor

我知道没有什么可以称为最好的 Java IDE（Eclipse、NetBeans 等）。每个人都有自己的专长。

但是当涉及到 GUI 编辑器（可视化编辑器）时，那里有一些有趣的项目；我很想知道哪个是最推荐的。

我不是要一个完整的 IDE，我要的是任何允许我编辑 Java GUI（不一定是 Swing）的 IDE 的 GUI 编辑器或插件。我也对商业替代品持开放态度，它不一定是免费的。

[这个问题](https://stackoverflow.com/questions/26458/ide-for-swing#26514)在某种程度上接近我的问题（在问之前我没有注意到它，但我希望任何搜索类似事物的人都能从这两个问题中受益）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T18:40:30.007

NetBeans 包含的可视化 Swing 编辑器 Matisse 可能是最好的一个。

如果您使用的是 Eclipse，那么 Jigloo（一个插件）可能是最好的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-15T18:01:42.453

It seems you are looking for [jEdit](https://en.wikipedia.org/wiki/JEdit), which oddly seems to be not previous answers.

# objective-c - 为什么我会收到此 Objective-C 错误消息：来自 'objc_object*' 的无效转换

> ID：86244
> 
> 赞同：3
> 
> 时间：2008-09-17T18:40:35.950
> 
> 标签：objective-c, macos

这个错误信息让我难过了一阵子：

> 从 'objc_object* 到 'int' 的无效转换

有问题的行是这样的：

```
int iResult = [MyUtils utilsMemberFunc:param1,param2]; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-17T18:42:17.460

“to”类型是什么并不重要，重要的是您认识到此消息在此上下文中报告未找到 utilsMemberFunc 声明，并且由于 Objective-C 的动态绑定，它假设它返回objc_object* 而不是 utilsMemberFunc 声明返回的类型。

那么为什么它没有找到声明呢？因为使用 ',' 而不是 ':' 来分隔参数。

# linq - Visual Studio 2005 中的 LINQ to SQL

> ID：86262
> 
> 赞同：2
> 
> 时间：2008-09-17T18:43:43.057
> 
> 标签：linq, linq-to-sql, visual-studio-2005

我通常在家里运行 VS 2008，并且内置了 LINQ。在工作中，我们仍在使用 VS 2005，我有机会开始一个我想使用 LINQ to SQL 的新项目。

在做了一些搜索之后，我所能想到的就是必须安装 2006 年 5 月的 LINQ CTP，LINQ 才能在 VS 2005 中工作。

有人知道我需要安装正确的插件或更新以在 VS 2005 中使用 LINQ（最好不必使用上面提到的 CTP）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T18:47:00.427

您可以引用 System.Data.Linq.dll 和 System.Core.dll，并为 C# 3.0 或最新的 VB 编译器设置构建目标，但其他所有内容都必须手动映射（在 LINQ to SQL 中的 VS2005 中没有设计器支持RTM)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T20:48:14.427

使用 May CTP（测试版软件）不再合法。

在不安装 .Net 3.5 的情况下部署 System.Core.dll（以及其他）是不合法的

在 VS2005 中执行 LINQ 的最佳方法是对 LinqToObjects 使用[LINQBridge](http://www.albahari.com/nutshell/linqbridge.html)，并使用简单的表适配器或其他一些数据访问方法将数据放入对象中（用于进一步的内存查询）。

另请注意：LinqToObjects 需要 Func(T) - 本质上是委托类型。LinqToSQL 需要 Expression(Func(T)) - 这是表达式树，如果没有 lambda 语法，则更难构建。

# javascript - 为什么 setInterval 调用带有随机参数的函数？

> ID：86269
> 
> 赞同：3
> 
> 时间：2008-09-17T18:44:19.593
> 
> 标签：javascript, firefox

所以，我看到了一个奇怪的问题。如果我有一个功能

```
// counter wraps around to beginning eventually, omitted for clarity.
var counter; 
cycleCharts(chartId) {
    // chartId should be undefined when called from setInterval
    console.log('chartId: ' + chartId);
    if(typeof chartId == 'undefined' || chartId < 0) {
        next = counter++;
    }
    else {
        next = chartId;
    }
    // ... do stuff to display the next chart
} 
```

该函数可以通过用户操作显式调用，在这种情况下`chartId`作为参数传入，并显示所选图表；或者它可以处于自动播放模式，在这种情况下，它由 a 调用，`setInterval`并由以下内容初始化：

```
var cycleId = setInterval(cycleCharts, 10000); 
```

奇怪的是，`cycleCharts()`即使`chartId`从`setInterval`! `setInterval`甚至没有任何参数可以传递给函数`cycleCharts`，所以我很困惑`chartId`为什么`cycleCharts`从`setInterval`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-17T18:48:50.033

setInterval 提供 cycleCharts 实际时间数据（因此可以计算出它运行的实际时间并用于产生不那么生硬的响应，在动画中最实用）

你要

```
 var cycleId = setInterval(function(){ cycleCharts(); }, 10000); 
```

（这个行为可能没有标准化，所以不要太依赖它）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T18:53:18.383

它告诉你回调被调用晚了多少毫秒。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T18:48:57.397

var cycleId = setInterval(cycleCharts, 10000, 4242);

从第三个参数开始 - 它们被传递到函数中，因此在我的示例中，您将 4242 作为chartId 发送。我知道这可能不是您提出的问题的答案，但它可能是您问题的解决方案？我认为它获得的值只是在传递/调用方法时从堆栈中的任何内容中随机得出的。

# xml - 如何搜索覆盖文件 N 行的 XML 注释？

> ID：86271
> 
> 赞同：0
> 
> 时间：2008-09-17T18:44:33.820
> 
> 标签：xml

我正在尝试查找带有大量注释掉的 xml 的 xml 文件。我想以编程方式搜索超出给定行数的 xml 注释。有没有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-20T15:25:13.937

我不确定行数，但如果你可以使用字符串的长度，这里有一些可以使用 XPath 的东西。

```
static void Main(string[] args)
{
    string[] myFiles = { @"C:\temp\XMLFile1.xml", 
                         @"C:\temp\XMLFile2.xml", 
                         @"C:\temp\XMLFile3.xml" };
    int maxSize = 5;
    foreach (string file in myFiles)
    {
        System.Xml.XPath.XPathDocument myDoc = 
            new System.Xml.XPath.XPathDocument(file);
        System.Xml.XPath.XPathNavigator myNav = 
            myDoc.CreateNavigator();

        System.Xml.XPath.XPathNodeIterator nodes = myNav.Select("//comment()");
        while (nodes.MoveNext())
        {
            if (nodes.Current.ToString().Length > maxSize)
                Console.WriteLine(file + ": Long comment length = " + 
                  nodes.Current.ToString().Length);
        }

    }

    Console.ReadLine();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T18:51:21.727

考虑到 XML 不使用基于行的格式，您可能应该检查字符数。使用正则表达式，您可以创建一个模式来匹配注释前缀并在匹配第一个注释后缀之前匹配最少数量的字符。

[http://www.regular-expressions.info/](http://www.regular-expressions.info/)

以下是在一些初步测试中起作用的模式：

```
<!-- (.[^-->]|[\r\n][^-->]){5}(.[^-->]|[\r\n][^-->])*? --> 
```

它将匹配起始注释前缀和包括换行符在内的所有内容（在 Windows 操作系统上）并且它是惰性的，因此它将在第一个注释后缀处停止。

抱歉，您是正确的，这是一个更新的模式。它显然没有优化，但在某些测试中它似乎解决了您指出的错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T19:36:56.830

我正在使用这个应用程序来测试正则表达式：

[http://www.regular-expressions.info/dotnetexample.html](http://www.regular-expressions.info/dotnetexample.html)

我已经根据一些相当好的数据对其进行了测试，它似乎只删除了评论部分。

# ms-access - Access中连续形式的组合框的自定义行源

> ID：86278
> 
> 赞同：14
> 
> 时间：2008-09-17T18:45:16.843
> 
> 标签：ms-access

我四处搜索，似乎这是 MS Access 的一个限制，所以我想知道其他人找到了哪些创造性的解决方案来解决这个难题。

如果您有一个连续的表单，并且您希望某个字段成为特定于该行的选项的组合框，则 Access 无法交付；组合框行源仅在表单开头查询一次，因此会为表单的其余部分显示错误的选项。

当然，我们都尝试的下一步是使用 onCurrent 事件重新查询组合框，这实际上将选项限制在给定的行中。但是，此时，Access 变得疯狂，并为每一行重新查询*所有*组合框，结果通常是其他行中的选项消失和重新出现，这取决于他们是否选择了对当前记录的行源。

我发现的唯一解决方案是始终列出所有可用的选项。有什么创意答案吗？

**编辑**另外，我应该注意，组合框的原因是将查询作为查找表，需要隐藏和存储真实值，而显示人类可读版本......组合框行中有多个列来源。因此，将限制更改为列表没有帮助，因为不在当前行源查询中的 id 将没有匹配的人类可读部分。

在这种特殊情况下，连续形式很有意义，所以请不要告诉我这是错误的解决方案。我要求任何有创意的答案。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-18T02:20:53.987

我也讨厌 Access，但你必须使用你收到的牌。连续表单在 Access 中是一件很棒的事情，直到您遇到任何常见的复杂性，例如在本例中。

这是我在遇到这种情况时会做的事情（我之前已经实施过类似的解决方法）：

在窗体上放置一个 UNBOUND 组合框。然后为要编辑的字段放置一个 BOUND 文本框。

确保组合框隐藏在文本框后面（不是不可见，只是隐藏）。

在 OnCurrent 事件中，用必要的数据填充列表框。继续并“限制列出”它。

在文本框的 OnEnter 或 OnClick 事件中，为组合框提供焦点。这将把组合框带到最前沿。当焦点离开组合框时，它将再次隐藏自己。

在组合框的 AfterUpdate 事件中，将文本框的值设置为等于组合框的值。

根据您的情况，可能还有一些其他细节需要解决，但这应该或多或少地实现您的目标，而不会增加太多复杂性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T22:01:32.363

使用连续形式..绝对。事实上，您可以使用基于连续表单的出色且直观的用户界面构建整个应用程序。不要听吐司！

您列出所有可用选项的解决方案是正确的。事实上，没有其他干净的解决方案。但是，当您说 Access 疯了时，您就错了。在连续表单上，您可以将每一行视为详细信息部分的一个实例，其中组合框是详细信息部分的所有实例共有的属性。您可以为所有实例更新此属性，但不能为一个特定实例设置它。这就是为什么 Access 必须在组合框中为所有记录显示相同的数据！

如果您需要在此组合框中仅接受特定于记录的值，请使用 beforeUpdate 事件添加控制过程。如果无法接受新值，您可以取消数据更新，恢复字段中的先前值。

您不能将 limitToList 属性设置为“否”，其中隐藏了链接数据（存储在控件中的数据）。这是合乎逻辑的：当链接字段（不可见）保持为空时，机器如何接受新数据行的输入？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T19:41:28.737

您还可以将组合框的值设置为不可编辑的文本字段，然后启动弹出/模态窗口来编辑该值。但是，如果我这样做，我可能倾向于在其中一个窗口中编辑整个记录。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T23:51:03.053

我认为完全不应该谴责 Access 连续表单，但我绝对认为应该避免使用它们来编辑数据。它们非常适合列表，并为您提供比单纯的列表框更多的格式化功能（并且也更容易使用，尽管它们当然不允许多选）。

如果要使用连续表单导航到记录进行编辑，请使用显示详细数据的子表单进行编辑，并将子表单中的 PK 值用于链接字段。这可以通过连续表单来完成，您可以在页眉或页脚中放置详细信息子表单，链接在连续表单后面的表格的 PK 上。

或者，如果您使用连续表单在父表单中显示子数据，则可以将详细信息子表单与对连续子表单中的 PK 的引用链接起来，例如：

```
[MySubForm].[Form]!MyID 
```

那将是链接主属性，而 MyID 将是链接子属性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T11:05:56.567

我们在应用程序中也经常遇到这种情况。我们发现这是一个很好的解决方案：只显示组合框中的所有行。然后，一旦用户在特定行中输入组合框，就调整行源（使用该行的过滤器）。当组合框失去焦点时，您可以重新设置行源以显示所有内容。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-26T23:49:24.800

我有一个比吉利根更简单的方法。看起来工作量很大，但实际上并非如此。我的解决方案需要将我的连续表单作为子表单数据表。在我的子表单上，我有两个查找组合框，以及其他字段，称为设备和制造商。两者都只是在数据源中保存一个 Long Integer 键。制造商需要按设备中选择的内容进行过滤。我过滤 Manufacturer.RowSource 的唯一一次是在 Manufacturer_GotFocus 事件中。

私有子厂商_GotFocus()

```
If Nz(Me.Equipment, 0) > 0 Then
    Me.Manufacturer.RowSource = GetMfrSQL()  '- gets filtered query based on Equipment
Else
    Me.Manufacturer.RowSource = "SELECT MfgrID, MfgrName FROM tblManufacturers ORDER BY MfgrName"
End If 
```

结束子

在 Manufacturer_LostFocus 中，我也将 Manufacturer.RowSource 重置为所有制造商。您需要这样做，因为当您第一次单击子窗体时，所有控件（包括制造商）都会触发 GotFocus 事件，即使您实际上并未更新任何字段。

私有子制造商_LostFocus()

```
Me.Manufacturer.RowSource = "SELECT MfgrID, MfgrName FROM tblManufacturers ORDER BY MfgrName" 
```

结束子

在制造商的输入事件中，您必须检查是否选择了设备，如果没有将焦点设置为设备。

私有子制造商_Enter()

```
If Nz(Me.EquipmentID, 0) = 0 Then
    '-- Must select Equipment first, before selecting Manufacturer
    Me.Equipment.SetFocus
End If 
```

结束子

您还需要重新查询Form_Current 事件中的Manufacturer 组合框（即Me.Manufacturer.Requery），并且您应该将此子表单的Cycle 属性设置为“当前记录”。

看起来很简单，但你还没有完成。您还必须在父表单的 SubForm_Exit 事件中将 Manufacturer.RowSource 重置为所有制造商，以防用户转到制造商组合框但未进行选择并单击父表单上的某处。代码示例（以父形式）：

Private Sub sFrmEquip_Exit（取消为整数）

```
Me.sFrmEquip.Controls("Manufacturer").RowSource = "SELECT MfgrID, MfgrName FROM tblManufacturers ORDER BY MfgrName" 
```

结束子

这里面还有一块不干净。当您单击制造商并在数据表网格中有多行时，当您更改当前行中的制造商时，其他行中的制造商字段将变为空白（组合框下方的数据仍然完好无损）。离开此字段后，其他制造商字段中的文本将重新出现。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-02-13T05:05:03.647

这似乎运作良好。CBOsfrmTouchpoint8 是一个组合框，缩短为下拉方块。CBOsfrmTouchpoint14 是一个构成其余空间的文本框。永不说永不：

```
 Private Sub CBOsfrmTouchpoint8_Enter()  

  If Me.CBOsfrmTouchpoint8.Tag = "Yes" Then  
  CBOsfrmTouchpoint14.SetFocus  
  Me.CBOsfrmTouchpoint8.Tag = "No"  
  Exit Sub  
  End If  

  Me.CBOsfrmTouchpoint8.Tag = "No"  
  Me.CBOsfrmTouchpoint8.RowSource = "XXX"  
  Me.CBOsfrmTouchpoint8.Requery  
  Me.CBOsfrmTouchpoint8.SetFocus  
  End Sub 

  Private Sub CBOsfrmTouchpoint8_GotFocus()  
  Me.CBOsfrmTouchpoint14.Width = 0  
  Me.CBOsfrmTouchpoint8.Width = 3420  
  Me.CBOsfrmTouchpoint8.Left = 8580  
  Me.CBOsfrmTouchpoint8.Dropdown  
  End Sub

  Private Sub CBOsfrmTouchpoint8_LostFocus()  
  Me.CBOsfrmTouchpoint8.RowSource = "XXX"  
  Me.CBOsfrmTouchpoint8.Requery  
  End Sub 

  Private Sub CBOsfrmTouchpoint8_Exit(Cancel As Integer)  
  Me.CBOsfrmTouchpoint14.Width = 3180  
  Me.CBOsfrmTouchpoint8.Width = 240  
  Me.CBOsfrmTouchpoint8.Left = 11760  
  Me.CBOsfrmTouchpoint8.Tag = "Yes"  
  End Sub 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T18:59:57.107

如果您关闭“列表限制”选项，并在更新之前进行一些验证以确认用户可能输入的内容与您提供给他们的列表中的内容相匹配，该怎么办？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-08T15:41:37.820

更好的...

将您的组合框控制源设置为查询中的一列，组合框中的值将被存储在该列中。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-02-12T22:24:21.447

对我来说，我认为最好和最简单的方法是创建一个临时表，其中包含所有绑定字段以及一个是/否字段的额外字段。

然后您将使用此表作为连续的数据源。您可以使用 onLoad 用您想要的数据填充临时表。

我认为之后循环选择很容易，只需一个小循环即可从临时表中读取是/否字段。

我希望这个能帮上忙

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-03-10T18:45:56.103

使用`OnEnter`事件填充组合框，不要使用固定的`rowsource`.

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-01-08T16:19:59.877

我刚刚做过类似的。我的解决方案是使用绑定到查询的固定行源。查询的`WHERE`子句引用表单的控件，即`Client=Forms!frmMain!ClientTextBox`. 仅此一项就会用第一行的数据填充组合框。诀窍是设置一个 ' `On Enter`' 事件，它只是对组合框进行重新查询，例如`ComboBox1.Requery`，这将单独重新查询该组合框，并且只会拖入与该记录行相关的数据。

希望这也对你有用！

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2008-09-17T18:56:12.683

免责声明：我非常讨厌 Access。

不要使用连续形式。他们是你想要完成的事情的红鲱鱼。连续形式是用不同的数据一遍又一遍地重复的相同形式。它已经是 Access 正常操作模式的一个组成部分，因为您不能多次打开同一个表单。您看到的行为是 Access 中的“设计”。这些 ComboBox 控件中的每一个实际上都是同一个控件。你不能在不影响其他人的情况下影响一个人。

基本上，您在这里所做的事情是遇到了 Access 不再适合您的项目的区域（但不能放弃，因为它已经代表了大量的工作）。

这里似乎最有可能的做法是很好地伪造它。对数据运行查询，然后根据结果以编程方式创建表单元素。这是一项相当大量的工作，因为您将自己复制大量 Access 的数据处理功能。

回复编辑：
但实际上，连续形式无法完成您想要的。这就是为什么我建议伪造你自己的连续形式，因为连续形式在它们可以做的事情上有真正的限制。不要太拘泥于某个特定的实现，以至于当它停止工作时你就放不下它。

# c# - 如何在调用 .LoadXml() 之前检查字符串输入中的有效 xml

> ID：86292
> 
> 赞同：44
> 
> 时间：2008-09-17T18:46:35.530
> 
> 标签：c#, .net, xml, exception-handling

我更愿意这样做而不捕获异常`LoadXml()`并将此结果用作我的逻辑的一部分。对于不涉及自己手动解析 xml 的解决方案有什么想法吗？我认为 VB 这个函数的返回值为 false，而不是抛出 XmlException。Xml 输入由用户提供。非常感谢！

```
if (!loaded)
{
     this.m_xTableStructure = new XmlDocument();
     try
     {
          this.m_xTableStructure.LoadXml(input);
          loaded = true;
     }
     catch
     {
          loaded = false;
     }
} 
```

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2008-09-17T18:52:03.990

只需捕获异常。与解析 XML 相比，捕获异常的小额开销被淹没了。

如果您想要该功能（出于风格原因，而不是出于性能考虑），请自行实现：

```
public class MyXmlDocument: XmlDocument
{
  bool TryParseXml(string xml){
    try{
      ParseXml(xml);
      return true;
    }catch(XmlException e){
      return false;
    }
 } 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-17T18:51:03.303

如果您提供自己的 ValidationEventHandler，使用 XmlValidatingReader 将防止异常。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-11-12T05:41:07.100

我无法让 XmlValidatingReader 和 ValidationEventHandler 工作。对于格式不正确的 xml，仍会引发 XmlException。我通过使用反射器查看方法来验证这一点。

我确实需要每秒验证 100 个短 XHTML 片段。

```
public static bool IsValidXhtml(this string text)
{
   bool errored = false;
   var reader = new XmlValidatingReader(text, XmlNodeType.Element, new XmlParserContext(null, new XmlNamespaceManager(new NameTable()), null, XmlSpace.None));
   reader.ValidationEventHandler += ((sender, e) => { errored = e.Severity == System.Xml.Schema.XmlSeverityType.Error; });

   while (reader.Read()) { ; }
   reader.Close();
   return !errored;
} 
```

XmlParserContext 也不起作用。

有人用正则表达式成功吗？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-17T18:56:03.933

如果捕获对您来说太多了，那么您可能需要使用 XML Schema 预先验证 XML，以确保 XML 正常，但这可能比捕获更糟糕。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T18:54:18.553

正如已经说过的，我宁愿捕获异常，但是使用[XmlParserContext](http://msdn.microsoft.com/en-us/library/system.xml.xmlparsercontext.aspx)，您可以尝试“手动”解析并拦截任何异常；但是，除非您每秒解析 100 个 xml 片段，否则为什么不捕获异常呢？

# cvs - 您用来跟踪 CVS 存储库中更改的最有效工具是什么？

> ID：86302
> 
> 赞同：1
> 
> 时间：2008-09-17T18:47:31.440
> 
> 标签：cvs, version-control

我在质量保证部门，并使用 Fisheye 跟踪 CVS 的签入。人们还使用哪些其他选项？

我们有数以万计的文件，并计划“在某个时候”迁移到 Team Foundation Server 的代码管理工具。当我们这样做时，将会有很多可用的信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T19:01:12.017

[ViewVC](http://www.viewvc.org/)为 CVS（或 SVN）提供了一个很好的 Web 界面，并且相当容易设置。但是，它不提供与鱼眼相同的功能。不过，我还没有尝试过使用 SQL DB 后端进行集成，我相信这会增加一些类似鱼眼的功能。

[CVSTrac](http://www.cvstrac.org/)还提供 Web 界面、wiki、票务系统和其他功能。我还没有在我们的存储库中设置它，但它也提供了一些类似鱼眼的功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T18:53:56.463

您可以在每次提交时向您发送一封邮件...查看[CVS Book](http://cvsbook.red-bean.com/cvsbook.html#Commit%20Emails)。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-09-17T18:54:20.863

抱歉，这对 CVS 没有帮助，但我建议切换到 subversion，它旨在替代 CVS。然后，您可以使用[trac](http://trac.edgewall.org/)来跟踪签入，以及管理变更单和文档。在我自己的项目中付出努力是值得的。

但如果你必须使用 CVS，总有[CVSweb](http://www.freebsd.org/projects/cvsweb.html)

# complexity-theory - 您如何防止过于复杂的解决方案或设计？

> ID：86308
> 
> 赞同：13
> 
> 时间：2008-09-17T18:48:42.780
> 
> 标签：complexity-theory, analysis

很多时候，我们发现自己在处理一个问题，却发现所创建的解决方案比问题所需的复杂得多。是否有控制、最佳实践、技术等可以帮助您控制工作场所的复杂情况？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-17T18:49:45.350

让新人来看看。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-17T18:51:21.057

如果它太难测试，你的设计太复杂了。这是我使用的第一个指标。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-17T19:07:39.210

以我的经验，为过于笼统的情况进行设计往往会产生过多的复杂性。

工程文化鼓励对环境做出较少假设的设计；这通常是一件好事，但有些人太过分了。例如，如果您的汽车设计不假设特定的引力，那*可能*会很好，实际上没有人会在月球上驾驶您的汽车，如果他们这样做了，那将无法工作，因为没有氧气可以制造燃料燃烧。

困难的部分是开发“适用于任何星球”设计的人通常被认为是聪明的，所以你可能不得不更加努力地争辩说他的设计*太*聪明了。

了解权衡，以便您可以在好假设和坏假设之间做出决定，将大大有助于避免不必要的复杂设计。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-17T20:03:28.823

以下是一些让设计更简单的想法：

*   阅读一些编程书籍和文章，然后**将**它们应用到您的工作中并编写代码
*   阅读其他人（如开源项目）编写的大量代码（好的和坏的），并学习看看哪些有效，哪些无效
*   构建安全网（单元测试）以启用代码实验
*   使用版本控制来启用回滚，如果这些实验走错了方向
*   [TDD（测试驱动开发）](http://en.wikipedia.org/wiki/Test_Driven_Development)和[BDD（行为驱动开发）](http://en.wikipedia.org/wiki/Behavior_driven_development)
*   改变您的态度，询问您如何做到这一点，**“它只是有效”**（约定优于配置可能会有所帮助；或者询问 Apple 将如何做到这一点）
*   练习（像爵士乐手——用代码即兴演奏，试试[Code Kata](http://codekata.pragprog.com/)）
*   多次编写相同的代码，使用不同的语言，经过一段时间后
*   用新概念学习新语言（如果使用静态语言，则学习动态语言；如果使用过程语言，则学习功能语言；...）[每年一门语言差不多]
*   要求某人审查您的代码并积极询问您如何使您的代码更简单和更优雅（**然后使它**）
*   通过做上述事情来获得多年的收益（时间有助于积极的头脑）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-17T18:52:58.743

我创建了一个设计等，然后我查看它并尝试（积极地）删除所有似乎不需要的东西。如果结果是我稍后在完善设计时需要它，我会将其添加回去。我会在多次迭代中完成此操作，并在进行过程中进行改进。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-17T18:59:38.370

阅读 Michael C. Feathers 的“有效地使用遗留代码”。

关键是，如果您的代码可以工作，并且您需要更改设计，那么没有什么比让您的代码可单元测试，并将您的代码分成更小的部分更好的了。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-17T21:17:35.060

使用测试驱动开发并遵循 Robert C. Martin 的[TDD 三个规则](http://butunclebob.com/ArticleS.UncleBob.TheThreeRulesOfTdd)：

1.  除非是为了通过失败的单元测试，否则您不得编写任何生产代码。
2.  不允许您编写任何足以导致失败的单元测试；编译失败就是失败。
3.  不允许您编写任何超过足以通过一个失败的单元测试的生产代码。

通过这种方式，您不太可能获得很多不需要的代码。您将始终专注于使一件重要的事情发挥作用，并且在复杂性方面永远不会超越自己。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-17T18:58:50.633

**先测试**在这里可能会有所帮助，但它并不适合所有情况。无论如何，它不是灵丹妙药。

**从小**处着手是另一个好主意。你真的需要把所有 10 种设计模式都塞进这个东西吗？首先尝试以“愚蠢的方式”进行操作。不是很切吗？好吧，做“稍微不那么愚蠢的方式”。等等。

**得到它审查**。别人写的，两双眼睛比较好。更好的是两个大脑。你的伴侣可能只是看到了一个简化的空间，或者一个你认为很好的问题区域，因为你花了很多时间来破解它。

**使用精益语言。**诸如 Java 或有时 C++ 之类的语言有时似乎会鼓励令人讨厌的、令人费解的解决方案。简单的事情往往跨越多行代码，你只需要使用 3 个外部库和一个大框架来管理它。考虑使用 Python、Ruby 等——如果不是用于您的项目，那么也可以用于一些私人用途。它可以**改变你的心态**，偏向于简单，并确保简单是可能的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-17T18:52:10.773

一旦你成为一名程序员，这将不可避免地发生。如果您严重低估了工作量或遇到了您的解决方案不起作用的问题，那么请停止编码并与您的项目经理交谈。我总是喜欢带着解决方案去开会，问题是 A，你可以做 x，这需要 3 天，或者我们可以尝试 y，这需要 6 天。不要自己做选择。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-17T18:54:43.187

*   在每一步都与其他程序员交谈。对设计的关注越多，在代码库中变得过于僵化之前，越有可能在早期发现过于复杂的方面。
*   不断地问自己，你将如何使用你目前正在做的任何事情。如果答案是您不确定，请停下来重新考虑您在做什么。
*   我发现记下有关如何潜在地简化我目前正在做的事情的想法很有用。这样，一旦我真正让它工作，就更容易返回并根据需要重构或重做，而不是搞乱甚至还没有功能的东西。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-17T18:55:30.347

这是一个微妙的平衡行为：一方面你不想要设计和实现花费太长时间的东西，另一方面你不想要一个不够复杂的黑客来处理下周的问题，甚至更糟糕的是需要重写以适应。

我发现一些有用的技术：

如果某件事看起来比你想要的更复杂，那么一旦你考虑完它就不要坐下来实施它。在剩下的时间里找点别的事情做。无数次，我最终想到了一个不同的解决方案来解决问题的早期部分，从而消除了后来的许多复杂性。

以类似的方式，让其他人可以反弹想法。确保您可以向他们解释为什么复杂性是合理的！

如果您增加复杂性是因为您认为它在未来是合理的，那么请尝试确定您将来**何时**使用它。如果您不能（实际上）想象需要一年或三年的复杂性，那么现在支付它可能是不合理的。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-17T19:25:08.527

通过将任务序列化为一系列较小的任务来减少您正在使用的数据量。大多数人在编码时只能在脑海中保留六个（正负）条件，因此将其作为实现单元。设计你需要完成的所有任务，然后无情地修改设计，这样你就不必通过模块玩超过六条路径。

这来自 Bendazo 的帖子 - 简化直到变得简单。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-17T20:10:44.253

我问我的客户*为什么*他们需要一些功能。我尝试深入了解他们的请求并确定他们遇到的问题。这通常比我（或他们）想的更简单。

当然，如果您了解客户的工作习惯以及他们必须解决的问题，您可以从一开始就更好地了解他们的问题。如果你“了解他们”了解他们，那么你就会更好地理解他们的演讲。因此，与您的用户建立密切的工作关系。这是工程的零步。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-17T20:49:51.960

花点时间把系统的概念命名好，找到相关的名字，这样系统就比较熟悉了。不要犹豫重命名概念，与你所知道的世界的联系越好，你的大脑就可以更好地使用它。

向那些喜欢干净、简单的解决方案的人征求意见。

仅实现当前项目所需的概念（对未来验证或通用系统的渴望会使您的设计臃肿）。

# visual-studio-2008 - 重新格式化 xml 注释的工具 (Visual Studio 2008)

> ID：86324
> 
> 赞同：0
> 
> 时间：2008-09-17T18:49:46.007
> 
> 标签：visual-studio-2008, macros, xml-comments, add-on

有人知道 VS 2008 的宏或附加组件可以重新格式化 xml 注释吗？旧版本的 VS 有这个非常聪明的 CommentReflower，但我找不到支持 VS 2008 的版本。

有任何想法吗？提前致谢！

马蒂亚斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T18:52:02.600

我过去曾使用过[SlickEdit](http://www.slickedit.com/index.php?option=com_content&task=view&id=389&Itemid=57)工具来帮助保持 XML 注释内联。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T18:52:01.930

我建议看一下 AutoHotKey 以创建一个可以为您执行此操作的小脚本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-10T09:20:48.297

[HyperAddin](http://www.codeplex.com/hyperAddin)有一个 FormatComment 选项，它可能会或可能不会做你想要的。

（我主要使用它来超链接到其他代码位。）

# interface - 设计受 Yahoo Pipes 启发的界面

> ID：86361
> 
> 赞同：13
> 
> 时间：2008-09-17T18:53:39.273
> 
> 标签：interface, widget, graph-theory, yahoo-pipes

我真的很喜欢 Yahoo Pipes 的界面（[http://pipes.yahoo.com/pipes/](http://pipes.yahoo.com/pipes/)），并且想为不同的问题创建一个类似的界面。是否有任何库可以让我创建具有相同基本外观的界面？

我特别喜欢管道的行为方式以及它们不仅仅是直线的方式。

编辑：该应用程序将是基于网络的。我愿意使用 Flash 或 Javascript。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-10T05:45:28.050

WireIt 是一个开源 javascript 库，用于创建像 Yahoo! 这样的 Web 可连线界面！用于数据流应用程序、可视化编程语言或图形建模的管道。Wireit 使用 YUI 库 (2.6.0) 进行 DOM 和事件操作，并使用 excanvas 来支持 IE 的 canvas 标签。它目前支持 Firefox 1.5+、Safari 2.0+、IE 7.0、Opera 9+ 和 Chrome 0.2.x。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-03T01:52:41.120

试试[JSplumb](http://www.jsplumb.org)。

主要结构是 HTML/CSS，连接可以是 SVG/Canvas/VML*

很棒的[文档](http://www.jsplumb.org/doc/usage.html)非常干净的[API](http://www.jsplumb.org/apidocs)和[现场演示](http://www.jsplumb.org/jquery/demo.html)

*可配置或通过检测浏览器的功能自动设置

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T19:41:27.800

据我所知，雅虎！通过在 YUI 中构建 Pipes 并添加超酷的[CANVAS](http://en.wikipedia.org/wiki/Canvas_(HTML_element))标签和[IE 脚本文件](http://excanvas.sourceforge.net/)（直到我今天做了一点挖掘，我才知道它存在）来驱动类似 Visio 的布线，从而[吃掉他们自己的狗粮。](http://en.wikipedia.org/wiki/Eating_one%27s_own_dog_food)如果您在构建像 Pipes 一样强大的东西之前还没有使用过 YUI，那么您需要做大量的学习才能构建像 Pipes 这样强大的东西，但是也许有人已经在 YUI 板上发布了示例，可以让您更接近您需要的地方成为。

我的所有信息都在以下网站上找到：

1.  [YUI博客](http://yuiblog.com/blog/2008/06/23/slicing/)
2.  [网络资源库](http://www.webresourcesdepot.com/how-to-use-canvas-tag-in-internet-explorer/)
3.  [开发者.Mozilla.org](http://developer.mozilla.org/en/Canvas_tutorial)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T19:00:37.523

您没有提及您正在开发的平台，但如果要将其放置在交互式网站上，您可能会通过在 Flash 中进行操作来节省时间。首先查看如何制作可拖动的对象（Google 在此处为您提供帮助），然后以您喜欢的任何方式将它们与线条或曲线连接起来很容易。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T21:03:46.730

以下是我在 YUI 的板上找到的内容：

[http://tech.groups.yahoo.com/group/ydn-javascript/message/30836](http://tech.groups.yahoo.com/group/ydn-javascript/message/30836)

目前似乎没有任何开放的“​​接线部件”库，但 YUI 似乎是一个好的开始。

# vb6 - 这个 VB6 成员变量什么时候销毁？

> ID：86365
> 
> 赞同：8
> 
> 时间：2008-09-17T18:54:06.590
> 
> 标签：vb6

假设我有一个类模块`clsMyClass`，其中一个对象作为成员变量。下面列出了这个非常简单的类的两个完整实现。

实施1：

```
Dim oObj As New clsObject 
```

实施2：

```
Dim oObj As clsObject

Private Sub Class_Initialize()
    Set oObj = New clsObject
End Sub

Private Sub Class_Terminate()
    Set oObj = Nothing
End Sub 
```

这两者在功能上有什么区别吗？特别是生命周期是`oObj`一样的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-17T19:11:36.813

在实现 1 中，clsObject 在使用之前不会被实例化。如果从未使用过，则 clsObject.Class_Initialize 事件将永远不会触发。

在实现 2 中，将在实例化 clsMyClass 的同时创建 clsObject 实例。如果创建了 clsMyClass，将始终执行 clsObject.Class_Initialize。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T18:56:42.620

如果在实现 1 中声明在类内部而不是子类中，则两个示例的范围是相同的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T19:09:34.960

每当垃圾收集确定不再引用所述对象时，对象变量就会被销毁。因此，在您的两个示例中，假设 clsObject 的范围相同，那么您的对象何时被销毁没有区别。

# database - 如何使用 Lucene 最好地搜索数据库？

> ID：86378
> 
> 赞同：7
> 
> 时间：2008-09-17T18:54:47.990
> 
> 标签：database, lucene, integration, hibernate-search

我正在研究针对我们的数据库提供更好搜索功能的机制。它目前是一个巨大的瓶颈（导致长期查询损害我们的数据库性能）。

我的老板想让我研究[Solr](http://lucene.apache.org/solr/)，但仔细观察，似乎我们实际上想要某种与 Lucene 本身的数据库集成机制。

在[Lucene FAQ](http://wiki.apache.org/lucene-java/LuceneFAQ#head-109358021acbfc89456e446740dc2bbf9049950f)中，他们推荐使用[Hibernate Search](http://search.hibernate.org/)、[Compass](http://www.compass-project.org/)和~~[DBSight](http://www.dbsight.net/)~~。

作为我们当前技术堆栈的背景，我们在 Tomcat 上使用直接的 JSP，没有 Hibernate，在其之上没有其他框架……只是针对 DB2 数据库的直接 Java、JSP 和 JDBC。

鉴于此，似乎 Hibernate Search 可能更难以集成到我们的系统中，尽管在这样的集成之后选择使用 Hibernate 可能会很好。

有没有人可以分享使用这些工具之一（或其他类似的基于 Lucene 的解决方案）的经验，这可能有助于选择正确的工具？

它需要是一个 FOSS 解决方案，理想情况下，它将自动（尽管有效）使用来自数据库的更改来管理更新 Lucene，而无需额外努力在进行更改时通知工具（否则，滚动我自己的 Lucene 解决方案似乎只是一样好）。此外，我们有多个应用程序服务器，只有 1 个数据库（+故障转移），因此如果可以轻松无缝地使用来自所有应用程序服务器的解决方案，那就太好了。

我现在正在继续检查这些选项，但利用其他人的经验会非常有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-18T20:29:38.893

When you say "search against a DB", what do you mean?

Relational databases and information retrieval systems use very different approaches for good reason. What kind of data are you searching? What kind of queries do you perform?

If I were going to implement an inverted index on top of a database, as Compass does, I would not use their approach, which is to implement Lucene's `Directory` abstraction with BLOBs. Rather, I'd implement Lucene's `IndexReader` abstraction.

Relational databases are quite capable of maintaining indexes. The value that Lucene brings in this context is its analysis capabilities, which are most useful for unstructured text records. A good approach would leverage the strengths of each tool.

As updates are made to the index, Lucene creates more segments (additional files or BLOBs), which degrade performance until a costly "optimize" procedure is used. Most databases will amortize this cost over each index update, giving you more stable performance.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T21:37:24.823

我对 Compass 有很好的体验。它与 hibernate 有很好的集成，并且可以通过其 GPS 设备[http://www.compass-project.org/docs/1.2.2/reference/html/gps-将通过 hibernate 和 jdbc 所做的数据更改直接镜像到 Lucene 索引jdbc.html](http://www.compass-project.org/docs/1.2.2/reference/html/gps-jdbc.html)。

在所有应用程序服务器上维护 Lucene 索引可能是个问题。如果您有多个应用服务器更新数据库，那么您可能会遇到一些问题，使索引与所有更改保持同步。Compass 现在可能有一个替代机制来处理这个问题。

Alfresco 项目 (CMS) 也使用 Lucene，并具有在服务器之间复制 Lucene 索引更改的机制，这可能有助于处理这些问题。

在 Hibernate Search 真正起步之前，我们就开始使用 Compass，所以我无法提供与它的任何比较。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-09-14T16:51:22.207

LuSql [http://code.google.com/p/lusql/](http://code.google.com/p/lusql/)允许您将 JDBC 可访问数据库的内容加载到 Lucene 中，使其可搜索。它是高度优化和多线程的。我是 LuSql 的作者，下个月将推出一个新版本（使用新的可插入架构重新架构）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T19:07:38.570

对于纯粹的性能提升，搜索 Lucene 肯定会有很大帮助。只索引你关心/需要的东西，你应该很好。如果你愿意，你可以使用 Hibernate 或其他一些东西，但我认为这不是必需的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T19:19:47.573

好吧，似乎 DBSight[不符合 FOSS 要求](http://www.dbsight.net/index.php?q=node/42)，所以除非它是一个绝对出色的解决方案，否则我现在不是一个选择......

# git - 如何让 Git 遵循符号链接？

> ID：86402
> 
> 赞同：250
> 
> 时间：2008-09-17T18:57:36.097
> 
> 标签：git, symlink

我最好是一个用副本替换符号链接的 shell 脚本，还是有另一种方法告诉 Git 遵循符号链接？

PS：我知道这不是很安全，但我只想在少数特定情况下这样做。

* * *

## 回答 #1

> 赞同：164
> 
> 时间：2010-01-16T23:31:39.860

我做了什么来将符号链接中的文件添加到 Git 中（我没有使用符号链接但是）：

```
sudo mount --bind SOURCEDIRECTORY TARGETDIRECTORY 
```

在 Git 管理的目录中执行此命令。`TARGETDIRECTORY`必须在`SOURCEDIRECTORY`安装到它之前创建。

它在 Linux 上运行良好，但在 OS X 上不行！这个技巧也帮助了我使用 Subversion。我用它来包含来自 Dropbox 帐户的文件，网页设计师在那里做他/她的工作。

如果要使此绑定永久化，请将以下行添加到`/etc/fstab`：

```
/sourcedir /targetdir none bind 
```

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2011-04-26T07:33:43.017

为什么不反过来创建符号链接呢？这意味着不是从 Git 存储库链接到应用程序目录，而是以相反的方式链接。

例如，假设我正在安装一个`~/application`需要配置文件的应用程序`config.conf`：

*   我添加`config.conf`到我的 Git 存储库，例如，在`~/repos/application/config.conf`.
*   `~/application`然后我通过运行 创建一个符号链接`ln -s ~/repos/application/config.conf`。

这种方法可能并不总是有效，但到目前为止对我来说效果很好。

* * *

## 回答 #3

> 赞同：55
> 
> 时间：2014-06-18T00:38:15.727

请改用硬链接。这与软（符号）链接不同。所有程序，包括`git`将文件视为常规文件。请注意，可以通过更改源或目标*来修改内容。*

# 在 macOS 上（10.13 High Sierra 之前）

如果您已经安装了 git 和 Xcode，[请安装 hardlink](https://stackoverflow.com/a/5118678/288906)。[它是创建硬链接](https://github.com/selkhateeb/hardlink)的微观工具。

要创建硬链接，只需：

```
hln source destination 
```

### macOS High Sierra 更新

> Apple 文件系统是否支持目录硬链接？
> 
> Apple 文件系统不支持目录硬链接。当您在 macOS 上从 HFS+ 转换为 APFS 宗卷格式时，所有目录硬链接都会转换为符号链接或别名。
> 
> *来自[developer.apple.com 上的 APFS 常见问题解答](https://developer.apple.com/library/content/documentation/FileManagement/Conceptual/APFS_Guide/FAQ/FAQ.html)*

按照[https://github.com/selkhateeb/hardlink/issues/31](https://github.com/selkhateeb/hardlink/issues/31)了解未来的替代方案。

# 在 Linux 和其他 Unix 风格上

该`ln`命令可以建立硬链接：

```
ln source destination 
```

# 在 Windows 上（Vista、7、8、...）

使用[mklink](http://ss64.com/nt/mklink.html)在 Windows 上创建联结：

```
mklink /j "source" "destination" 
```

* * *

## 回答 #4

> 赞同：45
> 
> 时间：2008-09-17T19:03:00.607

**注意：**根据 Git 1.6.1 以来的评论，此建议现已过时。Git 曾经以这种方式行事，现在不再如此。

* * *

Git 默认尝试存储符号链接而不是跟随它们（为了紧凑，这通常是人们想要的）。

但是，当符号链接是目录时，我不小心设法让它在符号链接之外添加文件。

IE：

```
 /foo/
  /foo/baz
  /bar/foo --> /foo
  /bar/foo/baz 
```

通过做

```
 git add /bar/foo/baz 
```

当我尝试它时，它似乎有效。然而，这种行为当时是我不想要的，所以我不能给你更多信息。

* * *

## 回答 #5

> 赞同：29
> 
> 时间：2013-09-09T06:30:49.530

这是一个[预提交挂钩](https://www.kernel.org/pub/software/scm/git/docs/githooks.html)，它用这些符号链接的内容替换索引中的符号链接 blob。

将其放入`.git/hooks/pre-commit`，并使其可执行：

```
#!/bin/sh
# (replace "find ." with "find ./<path>" below, to work with only specific paths)

# (these lines are really all one line, on multiple lines for clarity)
# ...find symlinks which do not dereference to directories...
find . -type l -exec test '!' -d {} ';' -print -exec sh -c \
# ...remove the symlink blob, and add the content diff, to the index/cache
    'git rm --cached "$1"; diff -au /dev/null "$1" | git apply --cached -p1 -' \
# ...and call out to "sh".
    "process_links_to_nondir" {} ';'

# the end 
```

### 笔记

我们尽可能使用符合 POSIX 标准的功能；但是，`diff -a`可能不符合 POSIX 标准。

这段代码中可能有一些错误/错误，即使它经过了一些测试。

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2019-01-10T02:14:59.473

在 macOS 上（我有 Mojave/10.14，`git`版本 2.7.1），使用`bindfs`.

`brew install bindfs`

`cd /path/to/git_controlled_dir`

`mkdir local_copy_dir`

`bindfs </full/path/to/source_dir> </full/path/to/local_copy_dir>`

其他评论暗示了这一点，但其他答案中没有明确提供。希望这可以节省一些时间。

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2018-03-06T19:27:37.500

我厌倦了这里的每个解决方案都过时或需要 root，所以[我制作了一个基于 LD_PRELOAD 的解决方案](https://github.com/Alcaro/GitBSLR)（仅限 Linux）。

它连接到 Git 的内部，覆盖“这是一个符号链接吗？” 函数，允许将符号链接视为其内容。默认情况下，所有指向 repo 外部的链接都是内联的；有关详细信息，请参阅链接。

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2009-01-01T20:31:34.163

很长一段时间以来，我曾经在符号链接之外添加文件。这过去工作得很好，没有做任何特殊安排。由于我更新到 Git 1.6.1，这不再起作用。

您也许可以切换到 Git 1.6.0 来完成这项工作。我希望未来版本的 Git 会有一个标志，`git-add`允许它再次遵循符号链接。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2015-03-04T06:39:40.157

对于 Git 2.3.2+（2015 年第一季度），还有另一种情况是 Git*不再*遵循符号链接：参见[Junio C Hamano (](https://github.com/gitster) [)](https://github.com/gitster)（主要 Git 维护者）的[commit e0d201b](https://github.com/git/git/commit/e0d201b61601e17e24ed00cc3d16e8e25ca68596)[`gitster`](https://github.com/gitster)

### `apply`：不要触摸超出符号链接的文件

> 因为 Git 将符号链接作为符号链接进行跟踪，所以在其前导部分具有符号链接的路径（例如`path/to/dir/file`，`path/to/dir`到其他地方的符号链接在哪里，无论是在工作树的内部还是外部）永远不会出现在有效应用的补丁中, 除非同一个补丁首先删除符号链接以允许在那里创建目录。
> 
> 检测并拒绝这样的补丁。
> 
> 同样，当输入创建符号链接`path/to/dir`然后创建文件`path/to/dir/file`时，我们需要将其标记为错误，而无需`path/to/dir`在文件系统中实际创建符号链接。
> 
> 相反，对于输入中任何在结果中留下路径（即非删除）的补丁，我们通过检查输入中的所有补丁然后检查补丁的目标来检查补丁将创建的结果树的所有前导路径应用程序（索引或工作树）。
> 
> 这样，我们：
> 
> *   `path/to/dir`同时添加符号链接和文件时发现恶作剧或错误`path/to/dir/file`，
> *   同时允许删除符号`link path/to/dir`然后添加文件的有效补丁`path/to/dir/file`。

这意味着，在这种情况下，错误消息不会像 一样是通用的`"%s: patch does not apply"`，而是更具体的：

```
affected file '%s' is beyond a symbolic link 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2010-02-18T22:21:45.053

嗯，`mount --bind`似乎对达尔文不起作用。

有没有人有这样的技巧？

[编辑]

好的，我发现在 Mac OS X 上的答案是进行硬链接。除了该 API 没有通过 公开`ln`，因此您必须使用自己的小程序来执行此操作。这是该程序的链接：

*[在 Mac OS X 中创建目录硬链接](https://stackoverflow.com/questions/1432540/creating-directory-hard-links-in-macos-x)*

享受！

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-08-29T09:31:19.793

[@user252400](https://stackoverflow.com/a/2079380/10126273)建议的另一种实现是使用`bwrap`，一个可以在所有主要发行版中找到的小型 setuid 沙箱 - 通常默认安装。`bwrap`允许您绑定挂载目录*而不* `sudo`绑定它们，并在 git 或您的 shell 退出时自动取消绑定它们。

假设你的开发过程不是太疯狂（见下文），在私有命名空间中启动 bash 并将外部目录绑定到 git 目录下：

```
bwrap --ro-bind / / \
      --bind {EXTERNAL-DIR} {MOUNTPOINT-IN-GIT-DIR} \
      --dev /dev \
      bash 
```

然后做你通常会做的所有事情，比如`git add`,`git commit`等等。完成后，只需退出 bash。干净简单。

注意事项：为防止沙箱逃逸，`bwrap`不允许执行其他 setuid 二进制文件。有关`man bwrap`更多详细信息，请参阅。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2021-05-08T06:22:58.477

**1.**您应该使用硬链接，因为硬链接中所做的更改是由 git 暂存的。

**2.**创建硬链接的语法是**`ln file1 file2`**.

**3.**这里**file1**是你要创建硬链接的文件的位置，**file2**是硬链接的位置。

**4.**我希望这会有所帮助。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-07-29T12:29:46.250

我正在使用 Git 1.5.4.3，如果它有一个斜杠，它就会跟随传递的符号链接。例如

```
# Adds the symlink itself
$ git add symlink

# Follows symlink and adds the denoted directory's contents
$ git add symlink/ 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-08-19T19:37:54.463

从符号链接转换可能很有用。[通过脚本](http://ryans-bliggity-blog.blogspot.com/2006/10/convert-soft-links-to-hard-links.html)链接到 Git 文件夹而不是符号链接。

# asp.net - 在 ASP.Net 日历控件中默认选择当前日期

> ID：86408
> 
> 赞同：19
> 
> 时间：2008-09-17T18:58:39.417
> 
> 标签：asp.net, calendar

假设我有一个带有此日历控件的 aspx 页面：

```
<asp:Calendar ID="Calendar1" runat="server"  SelectedDate="" ></asp:Calendar> 
```

有什么我可以为 SelectedDate 输入的内容，使其默认使用当前日期，而不必使用代码隐藏？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-09-17T19:13:55.073

如果您已经在进行数据绑定：

```
<asp:Calendar ID="Calendar1" runat="server"  SelectedDate="<%# DateTime.Today %>" /> 
```

会做的。这确实需要您在某处进行 Page.DataBind() 调用（或父控件上的数据绑定调用）。如果您不这样做并且您绝对不希望页面上有任何代码隐藏，那么您将必须创建一个包含日历控件并设置其选定日期的用户控件。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-11-09T06:51:13.373

**DateTime.Now**将不起作用，请改用**DateTime.Today**。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2011-07-28T08:40:36.573

我试图让日历默认选择一个日期并为用户突出显示它。但是，我尝试使用上述所有选项，但我只设法设置日历的选定日期。

```
protected void Page_Load(object sender, EventArgs e)
    Calendar1.SelectedDate = DateTime.Today;
} 
```

前面的代码没有突出显示选择，尽管它将 SelectedDate 设置为今天。

但是，选择并突出显示以下代码将正常工作。

```
protected void Page_Load(object sender, EventArgs e)
{
    DateTime today = DateTime.Today;
    Calendar1.TodaysDate = today;
    Calendar1.SelectedDate = Calendar1.TodaysDate;
} 
```

检查此链接： http: [//msdn.microsoft.com/en-us/library/8k0f6h1h (v=VS.85).aspx](http://msdn.microsoft.com/en-us/library/8k0f6h1h(v=VS.85).aspx)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-03T04:34:33.520

有两种方法。

## **后期装订**

```
<asp:Calendar ID="planning" runat="server" SelectedDate="<%# DateTime.Now %>"></asp:Calendar> 
```

## 代码隐藏方式（Page_Load 解决方案）

```
protected void Page_Load(object sender, EventArgs e)
{
    BindCalendar();
}

private void BindCalendar()
{
    planning.SelectedDate = DateTime.Today;
} 
```

尽管如此，我强烈建议通过 BindMyStuff 方式进行。单一入口点更易于调试。但既然你似乎知道你的游戏，你就准备好了。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-07-06T08:21:08.240

我已经用上面的代码尝试过，但没有工作，这是设置在 asp.net 日历控件中选择的当前日期的解决方案

```
dtpStartDate.SelectedDate = Convert.ToDateTime(DateTime.Now.Date);
dtpStartDate.VisibleDate = Convert.ToDateTime(DateTime.Now.ToString()); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-08-12T23:09:12.327

我在 VWD 2010 中也遇到了同样的问题，并且偶然地，我有两个控件。一个在后面的代码中可用，一个不可访问。我认为控件中的语句顺序导致了这个问题。我把'runat'放在'SelectedDate'之前，这似乎解决了它。当我在“SelectedDate”之后放置“runat”时，它仍然有效！不幸的是，我现在不知道为什么它不起作用，也没有得到不起作用的原件。

这些现在都起作用了：-

```
<asp:Calendar ID="calDateFrom" SelectedDate="08/02/2011" SelectionMode="Day" runat="server"></asp:Calendar>
<asp:Calendar runat="server" SelectionMode="Day" SelectedDate="08/15/2011 12:00:00 AM" ID="Calendar1" VisibleDate="08/03/2011 12:00:00 AM"></asp:Calendar>
<asp:Calendar SelectionMode="Day" SelectedDate="08/31/2011 12:00:00 AM" runat="server" ID="calDateTo"></asp:Calendar> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-12-07T21:16:21.820

实际上，我无法在 aspx 中选择日期。以下是在代码中设置选定日期的方法：

```
protected void Page_Load(object sender, EventArgs e)
{
   if (!Page.IsPostBack)
   {
      DateTime dt = DateTime.Now.AddDays(-1);
      Calendar1.VisibleDate = dt;
      Calendar1.SelectedDate = dt;
      Calendar1.TodaysDate = dt;
      ...
    }
 } 
```

在上面的示例中，我需要将默认选择日期设置为昨天。关键是设置TodayDate。否则，所选日历日期始终为今天。

# c# - 在 C# 中创建一个固定宽度的文件

> ID：86413
> 
> 赞同：38
> 
> 时间：2008-09-17T18:59:20.227
> 
> 标签：c#

在 C# 中创建固定宽度文件的最佳方法是什么。我有一堆长度要写出来的字段。说 20,80.10,2 等都左对齐。是否有捷径可寻？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-09-17T19:06:15.577

您可以使用 string.Format 轻松地用空格填充值，例如

```
string a = String.Format("|{0,5}|{1,5}|{2,5}", 1, 20, 300);
string b = String.Format("|{0,-5}|{1,-5}|{2,-5}", 1, 20, 300);

// 'a' will be equal to "|    1|   20|  300|"
// 'b' will be equal to "|1    |20   |300  |" 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-09-17T19:27:22.717

这是我为可配置的固定宽度文件写入模块制作的系统。它配置了一个 XML 文件，相关部分如下所示：

```
<WriteFixedWidth Table="orders" StartAt="1" Output="Return">
  <Position Start="1" Length="17" Name="Unique Identifier"/>
  <Position Start="18" Length="3" Name="Error Flag"/>
  <Position Start="21" Length="16" Name="Account Number" Justification="right"/>
  <Position Start="37" Length="8" Name="Member Number"/>
  <Position Start="45" Length="4" Name="Product"/>
  <Position Start="49" Length="3" Name="Paytype"/>
  <Position Start="52" Length="9" Name="Transit Routing Number"/>
</WriteFixedWidth> 
```

StartAt 告诉程序你的位置是从 0 开始还是从 1 开始。我之所以将其设置为可配置，是因为我会从规范中复制偏移量，并希望配置尽可能与规范相似，而不管作者选择的起始索引是什么。

Position 标签上的 Name 属性是指 DataTable 中列的名称。

以下代码是使用 LINQ-to-XML 为 .Net 3.5 编写的，因此该方法假定它会传递一个具有上述配置的 XElement，您可以在使用`XDocument.Load(filename)`加载 XML 文件后获取它，然后`.Descendants("WriteFixedWidth")`调用`XDocument`对象来获取配置元素。

```
 public void WriteFixedWidth(System.Xml.Linq.XElement CommandNode, DataTable Table, Stream outputStream)
    {
        StreamWriter Output = new StreamWriter(outputStream);
        int StartAt = CommandNode.Attribute("StartAt") != null ? int.Parse(CommandNode.Attribute("StartAt").Value) : 0;

        var positions = from c in CommandNode.Descendants(Namespaces.Integration + "Position")
                        orderby int.Parse(c.Attribute("Start").Value) ascending
                        select new
                        {
                            Name = c.Attribute("Name").Value,
                            Start = int.Parse(c.Attribute("Start").Value) - StartAt,
                            Length = int.Parse(c.Attribute("Length").Value),
                            Justification = c.Attribute("Justification") != null ? c.Attribute("Justification").Value.ToLower() : "left"
                        };

        int lineLength = positions.Last().Start + positions.Last().Length;
        foreach (DataRow row in Table.Rows)
        {
            StringBuilder line = new StringBuilder(lineLength);
            foreach (var p in positions)
                line.Insert(p.Start, 
                    p.Justification == "left" ? (row.Field<string>(p.Name) ?? "").PadRight(p.Length,' ')
                                              : (row.Field<string>(p.Name) ?? "").PadLeft(p.Length,' ') 
                    );
            Output.WriteLine(line.ToString());
        }
        Output.Flush();
    } 
```

该引擎是 StringBuilder，它比将不可变字符串连接在一起要快，尤其是在处理数兆字节的文件时。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-09-17T19:13:17.027

试用 FileHelpers：www.filehelpers.com

这是一个例子： [http ://www.filehelpers.com/quick_start_fixed.html](http://www.filehelpers.com/quick_start_fixed.html)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-17T19:03:27.893

使用 String 类的 .PadRight 函数（用于左对齐数据）。所以：

```
handle.WriteLine(s20.PadRight(20));
handle.WriteLine(s80.PadRight(80));
handle.WriteLine(s10.PadRight(10));
handle.WriteLine(s2.PadRight(2)); 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-17T19:05:38.370

您可以使用[http://www.filehelpers.com/](http://www.filehelpers.com/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-06-13T06:49:53.923

我在字符串上使用了扩展方法，是的，XML 注释可能看起来是 OTT，但如果你希望其他开发人员重新使用......

```
public static class StringExtensions
{

    /// <summary>
    /// FixedWidth string extension method.  Trims spaces, then pads right.
    /// </summary>
    /// <param name="self">extension method target</param>
    /// <param name="totalLength">The length of the string to return (including 'spaceOnRight')</param>
    /// <param name="spaceOnRight">The number of spaces required to the right of the content.</param>
    /// <returns>a new string</returns>
    /// <example>
    /// This example calls the extension method 3 times to construct a string with 3 fixed width fields of 20 characters, 
    /// 2 of which are reserved for empty spacing on the right side.
    /// <code>
    ///const int colWidth = 20;
    ///const int spaceRight = 2;
    ///string headerLine = string.Format(
    ///    "{0}{1}{2}",
    ///    "Title".FixedWidth(colWidth, spaceRight),
    ///    "Quantity".FixedWidth(colWidth, spaceRight),
    ///    "Total".FixedWidth(colWidth, spaceRight));
    /// </code>
    /// </example>
    public static string FixedWidth(this string self, int totalLength, int spaceOnRight)
    {
        if (totalLength < spaceOnRight) spaceOnRight = 1; // handle silly use.

        string s = self.Trim();

        if (s.Length > (totalLength - spaceOnRight))
        {
            s = s.Substring(0, totalLength - spaceOnRight);
        }

        return s.PadRight(totalLength);
    }
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-03-30T08:04:36.810

Darren 对这个问题的回答启发了我使用扩展方法，但我没有扩展，而是`String`扩展了`StringBuilder`. 我写了两个方法：

```
public static StringBuilder AppendFixed(this StringBuilder sb, int length, string value)
{
    if (String.IsNullOrWhiteSpace(value))
        return sb.Append(String.Empty.PadLeft(length));

    if (value.Length <= length)
        return sb.Append(value.PadLeft(length));
    else
        return sb.Append(value.Substring(0, length));
}

public static StringBuilder AppendFixed(this StringBuilder sb, int length, string value, out string rest)
{
    rest = String.Empty;

    if (String.IsNullOrWhiteSpace(value))
        return sb.AppendFixed(length, value);

    if (value.Length > length)
        rest = value.Substring(length);

    return sb.AppendFixed(length, value);
} 
```

第一个默默地忽略太长的字符串并简单地切断它的结尾，第二个通过`out`方法的参数返回切断的部分。

例子：

```
string rest;    

StringBuilder clientRecord = new StringBuilder();
clientRecord.AppendFixed(40, doc.ClientName, out rest); 
clientRecord.AppendFixed(40, rest);
clientRecord.AppendFixed(40, doc.ClientAddress, out rest);
clientRecord.AppendFixed(40, rest); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-17T19:03:21.560

您可以使用 StreamWriter 并在 Write(string) 调用中使用 String.Format() 创建一个字符串，该字符串是给定字段的正确宽度。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-17T19:01:47.523

你不能使用标准文本文件吗？您可以逐行读回数据。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-17T19:02:21.280

使用 String.Format()

[http://msdn.microsoft.com/en-us/library/aa331875.aspx](http://msdn.microsoft.com/en-us/library/aa331875.aspx)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-17T19:02:39.673

尝试使用 myString.PadRight(totalLengthForField, ' ')

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-17T19:03:55.287

你的意思是你想用空格填充右边的所有数字？

如果是这样，[String.PadRight](http://msdn.microsoft.com/en-us/library/system.string.padright.aspx)或[String.Format](http://msdn.microsoft.com/en-us/library/system.string.format.aspx)应该让你走上正轨。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-17T19:04:51.710

您可以使用 ASCIIEncoding.UTF8.GetBytes(text) 将其转换为字节数组。然后将字节数组作为固定大小的记录写入文件。

UTF8 在表示某些字符所需的字节数上有所不同，UTF16 更可预测，每个字符 2 个字节。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-17T19:21:05.340

之前的各种填充/格式化帖子足够有效，但您可能对实现 ISerializable 感兴趣。

[这是一篇关于.NET 中的对象序列化](http://msdn.microsoft.com/en-us/library/ms973893.aspx)的 msdn 文章

# sharepoint - 创建工作流任务会生成“无效的字段名称”错误

> ID：86417
> 
> 赞同：2
> 
> 时间：2008-09-17T18:59:37.137
> 
> 标签：sharepoint, workflow, wss

我有一个自定义（基于代码）的工作流程，通过 .wsp 文件中的功能部署在 WSS 中。工作流配置有自定义任务内容类型（即，Workflow 元素包含 TaskListContentTypeId 属性）。此内容类型的声明包含一个指向自定义任务编辑页面的 FormUrls 元素。

当工作流尝试创建任务时，工作流会引发以下异常：

`Invalid field name. {17ca3a22-fdfe-46eb-99b5-9646baed3f16`

这是 FormURN 网站栏的 ID。我认为 FormURN 仅用于 InfoPath 表单，而不是常规的 aspx 表单...

有谁知道如何解决这个问题，所以我可以在我的工作流程中创建任务？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T19:19:27.870

您是否在工作流程中使用 CreateTaskWithContentTypeId 活动？如果是，则需要确保已将内容类型添加到工作流任务列表中。SharePoint 不会自动添加它们。

奥辛

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T14:46:29.857

事实证明，我错过了两件事：

*   我的自定义内容类型需要添加到工作流任务列表
*   我需要在我的内容类型定义中添加一个空的 FieldRefs 元素；没有它，内容类型不会继承任何工作流任务字段。

# javascript - 为什么选择 JavaScript 而不是标准的浏览器虚拟机？

> ID：86426
> 
> 赞同：168
> 
> 时间：2008-09-17T19:00:12.690
> 
> 标签：javascript

通过托管在浏览器中的标准化虚拟机来支持一组语言（Java、Python、Ruby 等）而不是要求使用专门的语言——实际上是专门的范式——难道没有意义吗？仅用于客户端脚本？

为了澄清这个建议，网页将包含字节码，而不是像 JavaScript 这样的任何高级语言。

由于进化的原因，我理解 JavaScript 只是我们现在必须使用的实用现实，但我更多地考虑的是长期。关于向后兼容性，没有理由不能在一段时间内同时支持内联 JavaScript，当然 JavaScript 可能是浏览器虚拟机支持的语言之一。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-09-17T19:02:43.837

嗯，是。当然，如果我们有一台时间机器，回去并确保许多 Javascript 功能的设计不同将是一种主要的消遣（即，确保设计 IE 的 CSS 引擎的人从未涉足 IT）。但这不会发生，我们现在坚持下去。

我怀疑，随着时间的推移，它将成为网络的“机器语言”，其他设计更好的语言和 API 会编译成它（并迎合不同的运行时引擎缺陷）。

然而，我认为这些“设计更好的语言”中的任何一个都不会是 Java、Python 或 Ruby。尽管 Javascript 可以在其他地方使用，但它是一种 Web 应用程序脚本语言。鉴于这种用例，我们可以做得比这些语言中的任何一种都好。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2010-12-17T09:56:47.993

我认为 JavaScript 是一门很好的语言，但我希望在开发客户端 Web 应用程序时有一个选择。由于遗留原因，我们坚持使用 JavaScript，但有些项目和想法正在寻求改变这种情况：

1.  [Google Native Client](http://code.google.com/p/nativeclient/)：在浏览器中运行本机代码的技术。
2.  [Emscripten](http://kripken.github.io/emscripten-site/) : LLVM 字节码编译器到 javascript。允许 LLVM 语言在浏览器中运行。
3.  想法：浏览器中的 .NET CLI，由 Mono 的创建者：http: [//tirania.org/blog/archive/2010/May-03.html](http://tirania.org/blog/archive/2010/May-03.html)

我认为我们将拥有 JavaScript 很长一段时间，但这迟早会改变。有很多开发者愿意在浏览器中使用其他语言。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2010-12-17T16:28:32.047

回答这个*问题*- 不，这没有意义。

目前，我们拥有的最接近多语言 VM 的是 JVM 和 CLR。这些并不完全是轻量级的野兽，尝试在浏览器中嵌入这种大小和复杂性的东西是没有意义的。

让我们来看看您可以编写一个比现有解决方案更好的新的多语言 VM 的想法。

*   你在稳定性方面落后了。
*   你落后于复杂性（方式，方式，落后，因为你试图概括多种语言）
*   你在收养方面落后了

所以，不，这没有意义。

请记住，为了支持这些语言，您将不得不对它们的 API 进行一些激烈的剥离，删除在浏览器脚本上下文中没有意义的任何部分。这里需要做出大量的设计决策，并且有很大的出错机会。

就功能而言，无论如何我们可能只是*真正*使用 DOM，所以这确实是语法和语言习惯的问题，此时问“这真的值得吗？”确实有意义。

请记住，我们谈论的*唯一内容是客户端脚本，因为服务器端脚本已经可以以您喜欢的任何语言使用。*这是一个相对较小的编程领域，因此引入多种语言的好处是值得怀疑的。

引入哪些语言是有意义的？（警告，主观材料如下）

引入像 C 这样的语言是没有意义的，因为它是为使用金属而设计的，而在浏览器中并没有真正可用的金属。

引入像 Java 这样的语言没有意义，因为无论如何它最好的地方就是 API。

引入像 Ruby 或 Lisp 这样的语言没有意义，因为 JavaScript 是一种非常接近于 Scheme 的强大的动态语言。

最后，哪个浏览器制造商真正想要支持多语言的 DOM 集成？每个实现都会有自己特定的错误。我们已经经历过处理 MS Javascript 和 Mozilla Javascript 之间差异的问题，现在我们想将这种痛苦增加五到六倍？

这没有意义。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2008-09-17T20:40:38.643

在 Windows 上，您可以向 Scripting Host 注册其他语言并将它们提供给 IE。例如，开箱即用地支持 VBScript（尽管它从未获得过广泛的欢迎，因为它在大多数情况下甚至比 JavaScript 更糟糕）。

Python win32 扩展允许人们像这样很容易地将 Python 添加到 IE 中，但这并不是一个好主意，因为 Python 很难沙箱化：许多语言特性都暴露了足够的实现钩子，以允许本应受限制的应用程序爆发.

一般而言，一个问题是，您向浏览器等面向网络的应用程序添加的复杂性越高，出现安全问题的可能性就越大。一堆新语言肯定符合这种描述，而且这些新语言也在快速发展。

JavaScript 是一门丑陋的语言，但通过仔细使用选择性的特性子集，以及来自合适的对象库的支持，它通常可以变得相当容易接受。似乎对 JavaScript 进行增量的、实际的添加是 Web 脚本可能继续前进的唯一方式。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2010-12-17T07:06:40.733

我肯定会欢迎在浏览器中使用独立于标准语言的 VM（我更喜欢使用静态类型语言进行编码）。

（技术上）逐渐可行：第一个主要浏览器支持它，如果当前请求来自兼容的浏览器，服务器可以发送字节码，或者将代码转换为 JavaScript 并发送纯文本 JavaScript。

已经存在一些编译成 JavaScript 的实验性语言，但是拥有一个定义的 VM 将（也许）允许更好的性能。

不过，我承认“标准”部分会非常棘手。此外，关于库的语言特性（例如静态与动态类型）之间也会存在冲突（假设新事物将使用相同的库）。因此，我认为它不会（很快）发生。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2008-09-17T19:10:22.277

如果您觉得自己的手被弄脏了，那么您要么已经被洗脑，要么仍在感受“DHTML 年”的后遗症。JavaScript 非常强大，非常适合它的目的，即编写交互客户端脚本。这就是 JavaScript 2.0 名声不佳的原因。我的意思是，为什么包、接口、类等等，当这些显然是服务器端语言的方面时。JavaScript 作为一种基于原型的语言是很好的，而不是成熟的面向对象。

如果由于服务器端和客户端通信不畅而导致应用程序缺乏无缝性，那么您可能需要重新考虑如何构建应用程序。我曾使用过极其强大的网站和 Web 应用程序，但我从未说过，“嗯，我真的希望 JavaScript 能做到 (xyz)”。如果它可以做到这一点，那么它就不会是 JavaScript —— 它会是 ActionScript 或 AIR 或 Silverlight。我不需要，大多数开发人员也不需要。这些都是不错的技术，但他们试图用技术解决问题，而不是……嗯，解决方案。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2011-07-05T17:31:13.817

我认为标准的 Web VM 并不是那么不可思议。您可以通过多种方式优雅地引入新的 Web VM 标准并提供完整的旧版支持，只要您确保您使用的任何 VM 字节码格式都可以快速反编译为 javascript，并且生成的输出将相当有效（我什至会猜测智能反编译器可能会生成比人类自己生成的任何 javascript 更好的 javascript）。

使用此属性，任何 Web VM 格式都可以轻松地在服务器（快速）、客户端（缓慢，但在您对服务器的控制有限的情况下可能）进行反编译，或者可以通过以下方式预先生成和动态加载对于本身不支持新标准的浏览器，客户端或服务器（最快）。

那些原生支持新标准的浏览器将受益于基于 web vm 的应用程序运行时速度的提高。最重要的是，如果浏览器基于 web vm 标准（即将 javascript 解析为 web vm 标准，然后运行它）来构建其遗留的 javascript 引擎，那么它们不必管理两个运行时，但这取决于浏览器供应商.

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-09-17T19:15:29.987

虽然 Javascript 是唯一一种支持良好的脚本语言，您可以直接从中控制页面，但 Flash 为大型程序提供了一些非常好的功能。最近它具有 JIT 并且还可以动态生成字节码（查看[运行时表达式评估](http://www.sephiroth.it/weblog/archives/2008/04/runtime_expression_evaluation_in_acti.php)的示例，其中他们使用 flash 将用户输入的数学表达式一直编译为原生二进制文件）。Haxe 语言为您提供静态类型推理和字节码生成能力，您可以实现几乎任何您选择的运行时系统。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2016-06-09T09:53:48.460

快速更新这个老问题。

每个断言“网页将包含字节码而不是像 JavaScript 这样的高级语言”的人“不会发生”。

2015 年 6 月，[W3C](https://www.w3.org/community/webassembly/)宣布了[WebAssembly](https://webassembly.github.io)，即

> 一种新的可移植、节省大小和加载时间的格式，适合编译到 Web。

这仍然是实验性的，但在 Firefox nightly 和 Chrome Canary 中已经有一些原型实现，并且已经[有一些演示工作](https://webassembly.github.io/demo/)。

目前，WebAssembly 主要设计为由 C/C++ 生成，然而

> [随着 WebAssembly 的发展，它将支持比 C/C++ 更多的语言，我们希望其他编译器也能支持它](https://github.com/WebAssembly/design/blob/master/FAQ.md#is-webassembly-only-for-cc-programmers)。

我让你仔细看看项目的[官方页面](https://webassembly.github.io)，真是令人兴奋！

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2010-12-17T10:39:05.120

这个问题经常出现。我对此的立场是：

**A）不会发生**，**B）已经在这里。**

原谅，什么？让我解释：

### 广告 A

虚拟机不仅仅是某种通用的魔法设备。大多数虚拟机都针对某种语言和某些语言功能进行了优化。以 JRE/Java（或 LLVM）为例：针对静态类型进行了优化，在实现动态类型或其他 java 最初不支持的东西时肯定存在问题和缺点。

因此，支持许多语言特性（尾调用优化、静态和动态类型、foo bar boo、...）的“通用多用途 VM”将是巨大的、难以实现并且可能更难以优化以获得良好的性能它。但我不是语言设计师或虚拟机大师，也许我错了：这实际上很容易，只是没有人有这个想法吗？嗯嗯嗯

### 广告 B

已经在这里：可能没有字节码编译器/虚拟机，但您实际上并不需要它。afaik javascript已经完成，所以应该可以：

1.  创建一个从语言 X 到 javascript 的翻译器（例如，coffeescript）
2.  在 javascript 中创建一个解释语言 X 的解释器（例如[Brainfuck](http://www.google.at/search?sourceid=chrome&ie=UTF-8&q=javascript+brainfuck+interpreter)）。是的，性能会很糟糕，但是，嘿，不能拥有一切。

### 广告 C

什么？本来就没有C点！？因为还没有……。谷歌 NACL。如果有人能做到，那就是谷歌。只要谷歌让它工作，你的问题就解决了。只是，呃，它可能永远不会起作用，我不知道。上次我读到它时，有一些*非常*棘手的未解决的安全问题。

* * *

**除此之外：**

*   javascript 自 1995 年 = 15 年以来一直存在。尽管如此，今天的浏览器实现仍然不同（尽管至少不再令人难以忍受）。所以，如果你开始新的东西，你可能会有一个在 2035 年左右跨浏览器工作的版本。至少是一个工作子集。这只是细微的不同。并且需要兼容性库和层。不过，不尝试改进是没有意义的。

*   另外，可读的源代码呢？我知道很多公司宁愿不将他们的代码作为“某种”开源服务。就个人而言，如果我怀疑有什么可疑的东西或想从中学习，我很高兴能够阅读源代码。源代码万岁！

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2010-12-17T08:14:18.740

你的推理有一些错误。

1.  标准浏览器中的标准虚拟机永远不会是标准的。我们有 4 个浏览器，而 IE 在“标准”方面存在利益冲突。其他三个发展迅速，但新技术的采用率却很慢。手机上的浏览器，小型设备，......

2.  JS 在不同浏览器中的集成及其过去的历史导致您低估了 JS 的威力。你承诺了一个标准，但不赞成 JS，因为标准在早期没有成功。

3.  正如其他人所说，JS与AIR / .NET / ...等不同。当前版本的 JS 完全符合其目标。

从长远来看，Perl 和 Ruby 可以很好地取代 javascript。然而，这些语言的采用速度很慢，而且众所周知它们永远不会接管 JS。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2010-12-17T11:25:22.393

确实。Silverlight 实际上就是这样 - 基于客户端的 .Net 虚拟机。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2008-09-17T20:08:12.107

你怎么定义最好的？最适合浏览器，还是最适合开发人员？（此外，ECMAScript 与 Javascript 不同，但这是技术性问题。）

我发现 JavaScript 可以同时强大和优雅。不幸的是，我遇到的大多数开发人员都将其视为必要的邪恶，而不是真正的编程语言。

我喜欢的一些功能是：

*   将职能视为一等公民
*   能够随时向任何对象添加和删除功能（用处不大但令人兴奋）
*   它是一种动态语言。

处理起来很有趣，而且已经成立。在它出现时享受它，因为虽然它可能不是客户端脚本的“最佳”，但它肯定是令人愉快的。

我确实同意由于浏览器不兼容而制作动态页面时令人沮丧，但这可以通过 UI 库来缓解。这不应该再针对 JavaScript 本身，就像 Swing 不应该针对 Java。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2010-12-17T13:59:12.987

JavaScript 是浏览器的标准虚拟机。例如，OCaml 和 Haskell 现在都有可以输出 JavaScript 的编译器。限制不是 JavaScript 语言，限制是可通过 JavaScript 访问的浏览器对象，以及用于确保您可以安全运行 JavaScript 而不会损害您的机器的访问控制模型。当前的访问控制非常差，出于安全原因，JavaScript 只允许非常有限地访问浏览器对象。Harmony 项目正在寻求解决这个问题。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2010-12-18T01:09:59.307

这是一个很酷的主意。为什么不更进一步呢？

*   用相同的 VM 语言编写 HTML 解析器和布局引擎（实际上是浏览器中的所有复杂部分）
*   将引擎发布到网络
*   通过声明要使用的布局引擎及其 URL 为页面提供服务

然后我们可以向浏览器添加功能，而不必将新浏览器推送到每个客户端——相关的新位将从网络动态加载。我们还可以发布新版本的 HTML，而无需维护与浏览器中曾经工作的所有内容的向后兼容性的所有荒谬复杂性——兼容性是页面作者的责任。我们还可以尝试使用 HTML 以外的标记语言。而且，当然，我们可以在引擎中编写精美的 JIT 编译器，以便您可以使用任何您想要的语言编写网页脚本。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2010-12-18T14:14:21.230

我欢迎除 javascript 之外的任何语言作为可能的脚本语言。

使用其他语言然后使用 Javascript 会很酷。Java 可能不太适合这些标签，但 Haskell、Clojure、Scala、Ruby、Groovy 等语言会是有益的。

前段时间我来了一个交叉 Rubyscript ... [http://almaer.com/blog/running-ruby-in-the-browser-via-script-typetextruby](http://almaer.com/blog/running-ruby-in-the-browser-via-script-typetextruby)和[http://code.google.com/p/ruby-浏览器内/](http://code.google.com/p/ruby-in-browser/)
仍处于试验阶段且正在进行中，但看起来很有希望。
对于 .Net，我刚刚找到：[http](http://www.silverlight.net/learn/dynamic-languages/) ://www.silverlight.net/learn/dynamic-languages/刚刚找到该网站，但看起来也很有趣。甚至可以在我的[Apple Mac](http://ironpython.net/browser/examples/mushroom/)上使用。

不知道上述为 Javascript 提供替代方案的效果如何，但乍一看它看起来很酷。潜在地，这将允许人们在浏览器的沙箱中本地使用任何 Java 或 .Net 框架。

至于安全性，如果语言在 JVM（或 .Net 引擎）内部运行，VM 将负责安全性，因此我们不必担心——至少对于任何运行的东西我们都不应该担心浏览器内部。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-09-17T19:03:56.080

可能，但要做到这一点，我们需要让主流浏览器支持它们。IE 支持将是最难获得的。之所以使用 JavaScript，是因为它是您唯一可以指望可用的东西。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2008-09-17T22:22:37.227

与我交谈过的绝大多数开发人员都谈到了 ECMAScript 等。人。最终承认问题不在于脚本语言，而在于它暴露的可笑的 HTML DOM。将 DOM 和脚本语言混为一谈是导致 ECMAScript 痛苦和沮丧的常见原因。另外，别忘了，IIS 可以使用 JScript 来编写服务器端脚本，而 Rhino 之类的东西可以让您在 ECMAScript 中构建独立的应用程序。尝试在其中一种环境中使用 ECMAScript 工作一段时间，看看你的意见是否会改变。

这种绝望已经持续了一段时间。我建议您编辑此内容以包含或重新发布特定问题。你可能会对你得到的一些缓解感到惊喜。

一个旧网站，但仍然是一个不错的起点：[Douglas Crockford 的网站](http://javascript.crockford.com)。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2008-10-07T21:35:06.683

好吧，我们已经有了 VBScript，不是吗？等等，只有 IE 支持！
你对VM的好主意也是如此。如果我使用 Lua 编写页面脚本，而您的浏览器没有解析器将其转换为字节码怎么办？当然，我们可以想象一个脚本标签接受一个字节码文件，这甚至会非常有效。
但经验表明，很难为 Web 带来新的东西：采用这样的根本性新变化需要数年时间。有多少浏览器支持 SVG 或 CSS3？

此外，我看不出你在 JS 中发现了什么“脏”。如果由业余爱好者编码，传播在别处复制的不良做法，它可能会很丑陋，但大师们表明它也可以是一种优雅的语言。有点像 Perl：通常看起来像一种混淆语言，但可以使其完全可读。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2010-12-17T14:03:10.830

检查一下[http://www.visitmix.com/Labs/Gestalt/](http://www.visitmix.com/Labs/Gestalt/) - 只要用户安装了 silverlight，您就可以使用 python 或 ruby​​。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2011-01-03T12:42:08.637

这个问题问得好。

这不仅仅是 JS 中的问题，因为它缺乏用于在 JS 中开发大型程序的良好免费 IDE。我只知道一个免费的：Eclipse。另一个不错的是微软的 Visual Studio，但不是免费的。

为什么会是免费的？如果网络浏览器供应商想用在线应用程序（他们想要）替换桌面应用程序，那么他们必须给我们程序员，好的开发工具。您无法使用简单的文本编辑器、JSLint 和内置的 Google Chrome 调试器编写 50,000 行 JavaScript。除非你是个猛男。

当 Borland 在 1987 年为 Turbo Pascal 4.0 制作 IDE 时，这是一场编程革命。24年过去了。可耻的是，在 2011 年，许多程序员仍然不使用代码完成、语法检查和适当的调试器。可能是因为好的 IDE 太少了。

如果 Web 浏览器供应商希望我们构建可以与 Windows、Linux、MacOS、iOS、Symbian 等对抗的应用程序，则为程序员制作适当的（免费）工具符合他们的利益。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2008-09-17T19:13:20.583

实际上，Javascript 是任何浏览器将长期使用的唯一语言，因此虽然使用其他语言会非常好，但我看不到它的发生。

您所说的这种“标准化虚拟机”将非常大，并且需要被所有主要浏览器采用，并且大多数网站仍然会继续使用 Javascript，因为它比许多其他浏览器更适合网站。

您必须在此 VM 中对每种编程语言进行沙箱处理，并减少每种语言对系统的访问量，这需要对语言进行大量更改并删除或重新实现许多功能。而 Javascript 已经考虑到了这一点，并且已经做了很长时间。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2010-12-17T05:54:04.823

也许您正在寻找 Google 的 Native Client。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2010-12-17T21:05:31.553

从某种意义上说，在浏览器中使用像 Javascript 这样更具表现力的语言，而不是像 Java 字节码这样更通用的语言，意味着网络更加开放。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-09-17T19:08:07.727

我认为这**不是那么容易**的问题。我们可以说我们被 JS 困住了，但是 jQuery、Prototype、scriptaculous、MooTools 和所有出色的库真的那么糟糕吗？

请记住，JS 是**轻量级**的，V8、TraceMonkey、SquirrelFish 更是如此——现代浏览器中使用的新 Javascript 引擎。

它也**被证明了**——是的，我们知道它有问题，但我们已经解决了很多问题，比如早期的安全问题。允许您的浏览器运行 Ruby 代码或其他任何东西的映像。安全沙箱必须从头开始。你知道吗？Python 的人已经**失败**了两次。

我认为 Javascript 会随着时间的推移进行**修订和改进**，就像 HTML 和 CSS 一样。这个过程可能很漫长，但在这个世界上，并非一切皆有可能。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2008-10-08T01:02:23.830

我不认为您“理解 JavaScript 只是我们现在必须使用的实用问题”。实际上它是非常强大的语言。您在浏览器中使用 Java 小程序多年，现在它在哪里？

无论如何，您无需“弄脏”即可在客户端上工作。例如，尝试 GWT。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2010-12-17T12:25:47.713

... 你的意思是...

Java 和 Java 小程序 Flash 和 Adob​​e AIR 等。

一般来说，任何 RIA 框架都可以满足您的需求；但是对于每个人来说，使用它都需要付出代价（例如，运行时可在浏览器或/和专有或/以及比纯桌面更少的选项） [http://en.wikipedia.org/wiki/List_of_rich_internet_application_frameworks](http://en.wikipedia.org/wiki/List_of_rich_internet_application_frameworks)

对于使用任何非 Web 语言开发 Web，您需要 GWT：开发 Java，编译为 Javascript

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2010-12-17T15:10:57.397

因为它们都有带有字节码解释器的虚拟机，而且字节码也完全不同。{Chakra(IE)、Firefox (SpiderMonkey)、Safari (SquirrelFish)、Opera(Carakan)。

抱歉，我认为 Chrome (V8) 可以编译成 IA32 机器码。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2020-05-07T15:49:52.830

好吧，考虑到所有浏览器都已经使用了 VM，我认为为 Web 制作 VM 语言并不难。
我认为这将有很大帮助，原因如下：
1\. 由于服务器编译代码，发送的数据量较小，客户端不会浪费时间编译代码。
2\. 由于服务端可以将准备好的代码编译并存储起来，不像客户端尽量缩短快速编译JS的时间，可以更好地优化代码。
3\. 将语言编译成字节码比转译成 JS 要容易得多。

最后一点（正如有人在另一条评论中已经说过的那样），HTML 和 CSS 编译为一种更简单的语言，不确定它是否算作字节码，但您也可以将编译后的 html 和 css 从服务器发送到客户端，这将减少解析和获取时间

* * *

## 回答 #30

> 赞同：-1
> 
> 时间：2008-09-17T22:56:02.873

IMO，JavaScript，语言，不是问题。JavaScript 实际上是一种表达能力很强且功能强大的语言。我认为它的口碑很差，因为它没有经典的 OO 特性，但对我来说，我越喜欢原型槽，我就越喜欢它。

我看到的问题是我们被迫在网络上支持的许多浏览器中的不稳定和不一致的实现。像 jQuery 这样的 JavaScript 库在减轻这种肮脏感方面大有帮助。

* * *

## 回答 #31

> 赞同：-2
> 
> 时间：2008-09-17T19:04:09.077

JavaScript 是您唯一可用的本机标准选项。如果您想要强大的功能，请使用 jQuery，但如果您需要更多功能，请考虑为 Firefox 编写插件？或类似的 IE 等。

* * *

## 回答 #32

> 赞同：-3
> 
> 时间：2008-09-17T19:39:48.680

那么你在浏览器中对所有这些 Python 和 Ruby 做了什么？！

1）。还在编写脚本化的客户端应用程序？好吧，这可以用 JavaScript 很好地完成。

2）。使用套接字编写客户端-服务器应用程序？为什么不直接在没有浏览器的情况下编写它们？

3）。编写独立应用程序？像现在一样做。

# javascript - 重新加载/刷新 iframe 的最佳方法是什么？

> ID：86428
> 
> 赞同：285
> 
> 时间：2008-09-17T19:00:21.987
> 
> 标签：javascript, iframe

我想重新加载一个`<iframe>`使用 JavaScript。到目前为止，我发现的最好方法是将 iframe 的`src`属性设置为自身，但这不是很干净。有任何想法吗？

* * *

## 回答 #1

> 赞同：269
> 
> 时间：2008-09-17T19:36:42.167

```
document.getElementById('some_frame_id').contentWindow.location.reload(); 
```

小心，在 Firefox 中，`window.frames[]`不能按 id 索引，而是按名称或索引

* * *

## 回答 #2

> 赞同：220
> 
> 时间：2010-10-31T06:27:52.583

```
document.getElementById('iframeid').src = document.getElementById('iframeid').src 
```

它将重新加载`iframe`，甚至跨域！通过 IE7/8、Firefox 和 Chrome 测试。

* * *

## 回答 #3

> 赞同：64
> 
> 时间：2011-10-18T15:29:45.067

如果使用 jQuery，这似乎可行：

```
$('#your_iframe').attr('src', $('#your_iframe').attr('src')); 
```

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2017-10-24T04:38:39.570

添加空白空间也会自动重新加载 iFrame。

```
document.getElementById('id').src += ''; 
```

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2008-09-17T19:01:38.753

```
window.frames['frameNameOrIndex'].location.reload(); 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2010-10-08T00:02:34.153

由于[相同的源策略](https://developer.mozilla.org/En/Same_origin_policy_for_JavaScript)，这在修改指向不同域的 iframe 时不起作用。如果您可以针对较新的浏览器，请考虑使用[HTML5 的跨文档消息传递](http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html#crossDocumentMessages)。您可以在此处查看支持此功能的浏览器：http: [//caniuse.com/#feat=x-doc-messaging](http://caniuse.com/#feat=x-doc-messaging)。

如果您不能使用 HTML5 功能，那么您可以遵循此处列出的技巧：http: [//softwareas.com/cross-domain-communication-with-iframes](http://softwareas.com/cross-domain-communication-with-iframes)。该博客条目也很好地定义了问题。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2012-08-01T16:09:38.100

我刚刚在 chrome 中遇到了这个问题，唯一有效的方法是删除和替换 iframe。例子：

```
$(".iframe_wrapper").find("iframe").remove();
var iframe = $('<iframe src="' + src + '" frameborder="0"></iframe>');
$.find(".iframe_wrapper").append(iframe); 
```

很简单，其他答案中没有涉及。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2015-09-23T13:28:29.373

在我的情况下，简单地替换`src`iframe 元素的属性并不令人满意，因为在加载新页面之前会看到旧内容。如果您想提供即时视觉反馈，这会更好：

```
var url = iframeEl.src;
iframeEl.src = 'about:blank';
setTimeout(function() {
    iframeEl.src = url;
}, 10); 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2014-01-28T18:25:50.850

对于新网址

```
location.assign("http:google.com"); 
```

assign() 方法加载一个新文档。

重新加载

```
location.reload(); 
```

reload() 方法用于重新加载当前文档。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2012-09-15T06:58:50.913

对 yajra 帖子的改进......我喜欢这个想法，但讨厌浏览器检测的想法。

我宁愿采取 ppk 的观点，即使用对象检测而不是浏览器检测 ( [http://www.quirksmode.org/js/support.html](http://www.quirksmode.org/js/support.html) )，因为那样你实际上是在测试浏览器的功能并采取相应的行动，而不是你认为浏览器当时的能力。也不需要那么多丑陋的浏览器 ID 字符串解析，也不排除您一无所知的完美功能的浏览器。

因此，与其查看 navigator.AppName，不如做这样的事情，实际测试您使用的元素？（如果你想变得更漂亮，你可以使用 try {} 块，但这对我有用。）

```
function reload_message_frame() {
    var frame_id = 'live_message_frame';
    if(window.document.getElementById(frame_id).location ) {  
        window.document.getElementById(frame_id).location.reload(true);
    } else if (window.document.getElementById(frame_id).contentWindow.location ) {
        window.document.getElementById(frame_id).contentWindow.location.reload(true);
    } else if (window.document.getElementById(frame_id).src){
        window.document.getElementById(frame_id).src = window.document.getElementById(frame_id).src;
    } else {
        // fail condition, respond as appropriate, or do nothing
        alert("Sorry, unable to reload that frame!");
    }
} 
```

这样，您可以根据需要或需要尝试尽可能多的不同排列，而不会导致 javascript 错误，并在所有其他方法都失败时做一些明智的事情。在使用它们之前测试你的对象需要做更多的工作，但是，IMO 可以提供更好和更故障安全的代码。

在 Windows 上的 IE8、Firefox (15.0.1)、Chrome (21.0.1180.89 m) 和 Opera (12.0.2) 中为我工作。

也许我可以通过实际测试重新加载功能做得更好，但这对我来说已经足够了。:)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2018-01-07T17:02:04.127

另一种解决方案。

```
const frame = document.getElementById("my-iframe");

frame.parentNode.replaceChild(frame.cloneNode(), frame); 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2018-05-24T13:57:04.543

现在要在 chrome 66 上进行这项工作，试试这个：

```
const reloadIframe = (iframeId) => {
    const el = document.getElementById(iframeId)
    const src = el.src
    el.src = ''
    setTimeout(() => {
        el.src = src
    })
} 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2010-02-01T09:43:08.290

在使用.Net的IE8中，`iframe.src`第一次设置是可以的，但是`iframe.src`第二次设置是不会提高`page_load`iframed页面的。为了解决它，我使用了`iframe.contentDocument.location.href = "NewUrl.htm"`.

在使用 jQuery 厚框并尝试在厚框 iframe 中重新打开同一页面时发现它。然后它只显示打开的较早页面。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2011-11-29T01:23:12.050

IE 使用 reload，其他浏览器设置 src。（重新加载在 FF 上不起作用）在 IE 7、8、9 和 Firefox 上测试

```
if(navigator.appName == "Microsoft Internet Explorer"){
    window.document.getElementById('iframeId').contentWindow.location.reload(true);
}else {
    window.document.getElementById('iframeId').src = window.document.getElementById('iframeId').src;
} 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2014-05-09T06:51:08.303

如果您使用 Jquery，那么只有一行代码。

```
$('#iframeID',window.parent.document).attr('src',$('#iframeID',window.parent.document).attr('src')); 
```

如果你和同一个父母一起工作，那么

```
$('#iframeID',parent.document).attr('src',$('#iframeID',parent.document).attr('src')); 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2013-07-23T11:08:14.020

如果以上所有方法都不适合您：

```
window.location.reload(); 
```

由于某种原因，这刷新了我的 iframe 而不是整个脚本。也许是因为它被放置在框架本身中，而当您尝试从另一个框架刷新框架时，所有这些 getElemntById 解决方案都有效？

或者我不完全理解这一点并且胡言乱语，无论如何这对我来说就像一个魅力:)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2014-02-07T22:02:48.570

您是否考虑过在 url 上附加一个无意义的查询字符串参数？

```
<iframe src="myBaseURL.com/something/" />

<script>
var i = document.getElementsById("iframe")[0],
    src = i.src,
    number = 1;

//For an update
i.src = src + "?ignoreMe=" + number;
number++;
</script> 
```

它不会被看到，如果您知道参数是安全的，那么它应该没问题。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2017-05-01T08:17:16.083

使用`self.location.reload()`将重新加载 iframe。

```
<iframe src="https://vivekkumar11432.wordpress.com/" width="300" height="300"></iframe>
<br><br>
<input type='button' value="Reload"  onclick="self.location.reload();" />
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2012-05-22T19:06:35.547

```
<script type="text/javascript">
  top.frames['DetailFrame'].location = top.frames['DetailFrame'].location;
</script> 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2014-04-03T22:07:07.173

如果您尝试了所有其他建议，但无法让其中任何一个发挥作用（就像我做不到一样），那么您可以尝试以下可能有用的方法。

**HTML**

```
<a class="refresh-this-frame" rel="#iframe-id-0">Refresh</a>
<iframe src="" id="iframe-id-0"></iframe> 
```

**JS**

```
$('.refresh-this-frame').click(function() {
    var thisIframe = $(this).attr('rel');
    var currentState = $(thisIframe).attr('src');
    function removeSrc() {
        $(thisIframe).attr('src', '');
    }
    setTimeout (removeSrc, 100);
    function replaceSrc() {
        $(thisIframe).attr('src', currentState);
    }
    setTimeout (replaceSrc, 200);
}); 
```

* * *

我最初开始尝试通过 RWD 和跨浏览器测试来节省一些时间。我想创建一个包含一堆 iframe 的快速页面，这些 iframe 被组织成我可以随意显示/隐藏的组。从逻辑上讲，您希望能够轻松快速地刷新任何给定的帧。

我应该注意到我目前正在做的项目，这个测试平台中正在使用的项目，是一个带有索引位置的单页站点（例如 index.html#home）。这可能与为什么我无法获得任何其他解决方案来刷新我的特定框架有关。

话虽如此，我知道这不是世界上最干净的东西，但它适用于我的目的。希望这可以帮助某人。现在，如果我能弄清楚每次 iframe 中有动画时如何防止 iframe 滚动父页面...

**编辑：** 我意识到这不会像我希望的那样“刷新” iframe。它会重新加载 iframe 的初始源。仍然无法弄清楚为什么我无法获得任何其他选择工作..

**更新：** 我无法使用任何其他方法的原因是因为我在 Chrome 中测试它们，而 Chrome 不允许您访问 iframe 的内容（说明：[Chrome 的未来版本是否可能支持 contentWindow /contentDocument 当 iFrame 从本地 html 文件加载本地 html 文件时？](https://stackoverflow.com/questions/10415759/is-it-likely-that-future-releases-of-chrome-support-contentwindow-contentdocumen/15684469#15684469)）如果它不是来自同一位置（据我了解）。经过进一步测试，我也无法在 FF 中访问 c​​ontentWindow。

**修改过的 JS**

```
$('.refresh-this-frame').click(function() {
    var targetID = $(this).attr('rel');
    var targetSrc = $(targetID).attr('src');
    var cleanID = targetID.replace("#","");     
    var chromeTest = ( navigator.userAgent.match(/Chrome/g) ? true : false );
    var FFTest = ( navigator.userAgent.match(/Firefox/g) ? true : false );      
    if (chromeTest == true) {
        function removeSrc() {
            $(targetID).attr('src', '');
        }
        setTimeout (removeSrc, 100);
        function replaceSrc() {
            $(targetID).attr('src', targetSrc);
        }
        setTimeout (replaceSrc, 200);
    }
    if (FFTest == true) {
        function removeSrc() {
            $(targetID).attr('src', '');
        }
        setTimeout (removeSrc, 100);
        function replaceSrc() {
            $(targetID).attr('src', targetSrc);
        }
        setTimeout (replaceSrc, 200);
    }       
    if (chromeTest == false && FFTest == false) {
        var targetLoc = (document.getElementById(cleanID).contentWindow.location).toString();
        function removeSrc() {
            $(targetID).attr('src', '');
        }
        setTimeout (removeSrc, 100);
        function replaceSrc2() {
            $(targetID).attr('src', targetLoc);
        }
        setTimeout (replaceSrc2, 200);
    }
}); 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2017-09-13T14:00:06.787

出于调试目的，可以打开控制台，将执行上下文更改为他想要刷新的帧，然后执行`document.location.reload()`

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2021-09-02T09:58:59.147

## 从 Iframe 内部重新加载

如果您的应用位于 iframe 中，您可以通过替换位置 href 来刷新它：

```
document.location.href = document.location.href 
```

# vb6 - Visual Basic 6 和 UNC 路径

> ID：86435
> 
> 赞同：5
> 
> 时间：2008-09-17T19:00:40.350
> 
> 标签：vb6, unc

我收到来自开发人员的反馈：“Visual Basic (6) 处理 UNC 路径的唯一方法是将其映射到驱动器。” 这是准确的吗？如果是这样，根本问题是什么，除了映射驱动器之外还有其他选择吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-17T19:03:28.033

我们有一个使用 UNC 构建连接字符串的旧版 VB6 应用程序，所以我知道 VB6 可以做到。通常，您会发现权限问题是罪魁祸首。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T19:05:57.450

这是一种有效的方法。

```
Sub Main()

    Dim fs As New FileSystemObject ' Add Reference to Microsoft Scripting Runtime
    MsgBox fs.FileExists("\\server\folder\file.ext")

End Sub 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-19T11:56:31.870

即使是老式的文件处理类型也可以：

```
Open "\\host\share\file.txt" For Input As #1
Dim sTmp
Line Input #1, sTmp
MsgBox sTmp
Close #1 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T19:16:10.700

`Scripting.Runtime`如果您使用的是图书馆，我认为这不是真的。

Oldschool VB 有一些用于文件处理的语言结构。这些都是邪恶的。不要使用它们。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-12-02T17:37:55.343

在 VB6 中，您不能将 CHDrive 用于 UNC 路径。

由于 App.Path 返回一个 UNC 路径，因此尝试使用 ChDrive 到该路径`ChDrive App.Path`会导致错误。

正如微软所说“ChDrive 无法处理 UNC 路径，因此当 App.Path 返回一个时会引发错误”。有关详细信息，请查看[http://msdn.microsoft.com/en-us/library/aa263345(v=vs.60).aspx](http://msdn.microsoft.com/en-us/library/aa263345(v=vs.60).aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-19T02:41:44.443

你在做什么类型的文件 I/O？如果是文本，请考虑使用 FileSystemObject。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-01T03:14:29.753

当以下项目的组合存在时，我观察到 VB6 UNC 路径问题：

*   UNC 指向隐藏的“$”共享
*   服务器名称超过 8 个字符和或具有非标准字符
*   路径的一部分特别长
*   服务器出于性能目的关闭了 8.3 支持

通常是 75 路径文件访问错误或 54。有时这可能与 API 相关，例如上述 UNC 上的 getshortfilename 和 getshortpathname。

除此之外，它们工作得很好......映射路径通常不会出现这些问题，但那些该死的驱动器映射经常断开连接，并且可以随时更改，导致许多支持问题。

# c# - 从头开始创建新的 ASP.NET Web 应用程序的最佳流程是什么？

> ID：86444
> 
> 赞同：5
> 
> 时间：2008-09-17T19:01:46.243
> 
> 标签：c#, asp.net, unit-testing, web-applications

我正在从头开始重新构建我们设计不佳的 Web 应用程序，并希望进入 TDD 并基本上将“做正确的事情”作为一种学习项目。建议使用哪些工具、流程和资源从一开始就“正确”地进行操作？我将作为架构师和开发人员单独工作，并在业务分析师和业务所有者的支持下进行可用性测试和用例。

编辑：现在我们使用 SourceSafe 进行源代码控制，在技术上是否有任何理由让我试图让我们切换到颠覆？

编辑#2：看起来共识是：Cruise Control.NET Subversion（如果我想停止使用 SourceSafe） ASP.NET MVC NUnit 进行单元测试 Resharper

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-17T19:04:42.850

如果您想在开发过程中将单元测试作为高优先级，我强烈建议您查看[MVC for ASP.NET 。](http://weblogs.asp.net/scottgu/archive/2007/11/13/asp-net-mvc-framework-part-1.aspx)听起来它非常适合您尝试做的事情。

我还推荐[CruiseControl.NET](http://confluence.public.thoughtworks.org/display/CCNET/Welcome+to+CruiseControl.NET)用于持续集成（如果您的团队要发展，这很重要）。

当我在小团队工作时，Subversion 是我最喜欢的源代码控制系统。使用[Tortoise SVN](http://tortoisesvn.tigris.org/)进行 Windows 资源管理器集成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T21:57:28.537

对您的源代码控制问题的答案...

从头开始重新设计应用程序可能是一个耗时的项目，除非您已经确切知道将使用哪个并且有设置它的经验，否则我不会浪费时间更改源代码控制。

Visual SourceSafe 完成了这项工作，尤其是在 1 人的努力下，并且它已经到位，因此可以使用它运行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-22T19:28:40.900

If you're about to set up a fresh instance of subversion and continuous integration, starting green from a VSS background, these two free packages will likely save you days (or weeks) of time:

*   [Visual SVN Server](http://www.visualsvn.com/server/) Sets up everything needed for a subversion server, including Windows AD auth and an admin GUI. Free, you may consider supporting their excellent VisualSVN VS addin for source control integration in Visual Studio. Alternatively, can look at [AnkhSVN](http://ankhsvn.open.collab.net/)

*   [TeamCity](http://www.jetbrains.com/teamcity/index.html) A Continuous Integration package (alternative to CruiseControl.NET) from JetBrains (makers of ReSharper, a fantastic tool, as mentioned) which is free for the professional version (up to 20 users and 3 build servers).

These two packages are some of the easiest installs around, challenging VSS itself :-)

Using SVN may take a little adjustment; but with the excellent doco for whichever client you pick (AnkSVN, VisualSVN, TortoiseSVN, or some combination), you'll be fine.

Besides, you know where to find people eager to answer any questions you might have in exchange for Rep ;-)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-22T19:39:57.893

查看[TypeMock](http://www.typemock.com)或[Rhino](http://ayende.com/projects/rhino-mocks.aspx) Mocks 。当您对 Web 应用程序进行单元测试时，Mocking 可以为您节省大量时间和痛苦。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-18T14:22:30.697

我们像您一样重写了我们的网站，并且我们使用 C# 和 MVC。这很棒。我们使用 Microsoft 的 SourceSafe 来控制我们的代码，它工作得很好。由于您是唯一的开发人员，这将取决于您喜欢什么。

Microsoft 的 sourcesafe 允许我们创建一个可以工作的分支，可以保持在源代码控制下，并且我们可以轻松地在两者之间切换。（我真的没有太多使用颠覆，所以我不能评论它。）

我们使用 NUnit 来测试/模拟我们的代码。模仿它们非常容易。我们创建了一个类来保存和读取对象。

保存函数：Stream stream = File.Open(simplePath, FileMode.OpenOrCreate); BinaryFormatter bwriter = new BinaryFormatter(); bwriter.Serialize（流，实际）；

读取函数：Stream stream = File.Open(simplePath, FileMode.Open, FileAccess.Read, FileShare.Read); BinaryFormatter bwriter = new BinaryFormatter(); 对象 returnObject = bwriter.Deserialize(stream);

我们使用 NUnit 来模拟 xml 和 SQL。

祝你好运

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-17T19:05:43.673

我们使用 Visual Studio 2008、Resharper 4.1、用于源代码控制的 Subversion、用于自动构建的 Cruise 控制以及用于我们所有自动化测试的内置单元测试的设置。和 Linq2Sql 用于或映射。除了 VS（显然）和 resharper（太酷了）之外，您可以换掉任何东西，但您可以轻松地使用另一个源控制、映射器或单元测试工具。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-17T19:06:47.167

这里有一些工具可以让工作变得更容易、更安全（谷歌搜索名称将显示相关页面）：

Subversion - 源代码控制
NUnit - 测试框架
CruiseControl.Net - 自动构建

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-17T19:17:51.460

Visual Source safe 具有严格的锁定策略，因此一次只能一个人处理一个文件....CVS 或 subversion 允许多个用户同时处理同一个文件。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-17T19:21:54.790

这里的所有建议都很好，但没有灵丹妙药。您必须查看您的应用程序有多大、有多少用户、如何部署等，以做出您的架构、流程、工具集和其他决策。例如，TDD 是一种很好的方法，但不是“正确地做事”的唯一好方法。另一个，CruiseControl 很棒，但在单个开发人员项目中，它可能有点矫枉过正。

无论你做什么都要保持一致是我最好的建议——如果你使用 TDD，如果你明白我的意思，就使用 TDD。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-18T10:18:55.743

如果您刚刚开始，那么我会尽可能少地进行更改（特别是因为您是唯一的开发人员），所以坚持使用 Sourcesafe。在你的情况下绝对没有问题。

稍后，您可能会关注 MS Team System，或者可能会选择其他 3rd Party 工具。

就个人而言，我不是 Subversion 的粉丝，但我认识到它是整个行业的流行工具。

至于特定于 TDD 的软件，我无法提供任何建议。您是否有首选的 UML 工具或您正在使用的任何正式方法？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-18T10:22:26.250

有一件事要提：在进行任何更改之前，要 100% 确定您了解程序在做什么以及它应该做什么。在了解整个情况之后，一个“糟糕”的软件往往会变得“没那么糟糕”。

Sourcesafe 可以，尤其是对于一个人来说，但是当团队中的 ppl 越来越多时，锁模型会变得很烦人，但是暂时：坚持下去

# c# - 如何在 C# (.NET) 中将文件上传到 SFTP 服务器？

> ID：86458
> 
> 赞同：68
> 
> 时间：2008-09-17T19:02:58.220
> 
> 标签：c#, .net, sftp

是否存在免费的 .NET 库，我可以使用它将文件上传到 SFTP (SSH FTP) 服务器，这会在上传问题时引发异常并允许监控其进度？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-09-17T19:09:38.860

也许你可以编写脚本/控制[winscp](http://winscp.net/)？

**更新：** winscp 现在有[一个 .NET 库](https://winscp.net/eng/docs/library ".NET 库")，可用作支持 SFTP、SCP 和 FTPS的[nuget 包](https://winscp.net/eng/docs/library_install#nuget "nuget包")

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-06-16T23:04:18.503

[以下代码显示了如何使用我们的Rebex SFTP](http://www.rebex.net/sftp.net/)组件将文件上传到 SFTP 服务器。

```
// create client, connect and log in 
Sftp client = new Sftp();
client.Connect(hostname);
client.Login(username, password);

// upload the 'test.zip' file to the current directory at the server 
client.PutFile(@"c:\data\test.zip", "test.zip");

client.Disconnect(); 
```

您可以使用 LogWriter 属性将完整的通信日志写入文件，如下所示。示例输出（来自 FTP 组件，但 SFTP 输出类似）可在[此处](http://forum.rebex.net/questions/242/getlist-throws-an-established-connection-was-aborted-by-the-software-in-your-h)找到。

```
client.LogWriter = new Rebex.FileLogWriter(
   @"c:\temp\log.txt", Rebex.LogLevel.Debug); 
```

或使用以下事件拦截通信：

```
Sftp client = new Sftp();
client.CommandSent += new SftpCommandSentEventHandler(client_CommandSent);
client.ResponseRead += new SftpResponseReadEventHandler(client_ResponseRead);
client.Connect("sftp.example.org");

//... 
private void client_CommandSent(object sender, SftpCommandSentEventArgs e)
{
    Console.WriteLine("Command: {0}", e.Command);
}

private void client_ResponseRead(object sender, SftpResponseReadEventArgs e)
{
    Console.WriteLine("Response: {0}", e.Response);
} 
```

有关详细信息，请参阅[教程](http://www.rebex.net/sftp.net/tutorial-sftp.aspx)或[下载](http://www.rebex.net/sftp.net/download.aspx)试用版并检查[示例](http://www.rebex.net/sftp.net/samples.aspx)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T19:07:32.437

.net 框架内没有解决方案。

[http://www.eldos.com/sbb/sftpcompare.php](http://www.eldos.com/sbb/sftpcompare.php)列出了非免费选项列表。

您最好的免费选择是使用 Granados 扩展 SSH。[http://www.routrek.co.jp/en/product/varaterm/granados.html](http://www.routrek.co.jp/en/product/varaterm/granados.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-17T19:09:06.413

不幸的是，它不在 .NET Framework 本身中。我希望您可以与 FileZilla 集成，但我认为它不会公开接口。我认为他们确实有脚本，但显然不会那么干净。

我在一个执行 SFTP 的项目中使用了 CuteFTP。它公开了一个 COM 组件，我围绕它创建了一个 .NET 包装器。你会发现，关键是权限。它在安装了 CuteFTP 的 Windows 凭据下运行良好，但在其他凭据下运行需要在 DCOM 中设置权限。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-19T02:23:59.143

对于另一个非免费选项，请尝试[edtFTPnet/PRO](http://www.enterprisedt.com/products/edtftpnetpro/overview.html)。它全面支持 SFTP，如果需要还支持 FTPS（当然还有 FTP）。

# c++ - 在 C++ 中触发 COM 事件 - 同步还是异步？

> ID：86474
> 
> 赞同：0
> 
> 时间：2008-09-17T19:04:40.540
> 
> 标签：c++, com, activex, atl

我有一个使用 MS ATL 库编写的 ActiveX 控件，我正在通过`pDispatch->Invoke(..., DISPATCH_METHOD)`. 该控件将由 .NET 客户端使用，我的问题是 - 事件的触发是同步调用还是异步调用？我担心的是，如果是同步的，处理事件的应用程序可能会导致性能问题，除非它立即返回。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-17T19:11:06.593

从生成事件的组件的角度来看，它是同步的。控件的执行线程将调用接收者代码，此时事情超出了它的控制。

接收事件的客户必须确保他们迅速返回。如果他们需要做大量的工作，那么他们应该异步安排。例如，通过发布 Windows 消息或使用单独的线程。

# c# - C# 是否与 JavaScript 的 encodeURIComponent() 等效？

> ID：86477
> 
> 赞同：152
> 
> 时间：2008-09-17T19:05:10.323
> 
> 标签：c#, javascript, .net, windows, encoding

在 JavaScript 中：

```
encodeURIComponent("©√") == "%C2%A9%E2%88%9A" 
```

是否有 C# 应用程序的等价物？为了转义我使用的 HTML 字符：

```
txtOut.Text = Regex.Replace(txtIn.Text, @"[\u0080-\uFFFF]",
    m => @"&#" + ((int)m.Value[0]).ToString() + ";"); 
```

但我不确定如何将匹配转换为 JS 使用的正确十六进制格式。例如这段代码：

```
txtOut.Text = Regex.Replace(txtIn.Text, @"[\u0080-\uFFFF]",
    m => @"%" + String.Format("{0:x}", ((int)m.Value[0]))); 
```

返回 "`%a9%221a"`代替`"©√"`.`"%C2%A9%E2%88%9A"`看起来我需要将字符串拆分为字节或其他内容。

编辑：这是一个 Windows 应用程序，唯一可用的项目`System.Web`是：`AspNetHostingPermission`、、`AspNetHostingPermissionAttribute`和`AspNetHostingPermissionLevel`。

* * *

## 回答 #1

> 赞同：248
> 
> 时间：2010-12-29T00:21:40.270

`Uri.EscapeDataString`或者`HttpUtility.UrlEncode`是转义作为 URL 一部分的字符串的正确方法。

以字符串为例`"Stack Overflow"`：

*   `HttpUtility.UrlEncode("Stack Overflow")`-->`"Stack+Overflow"`

*   `Uri.EscapeUriString("Stack Overflow")`-->`"Stack%20Overflow"`

*   `Uri.EscapeDataString("Stack + Overflow")`--> 也编码`"+" to "%2b"`---->`Stack%20%2B%20%20Overflow`

当用作 URL 的实际部分时，只有最后一个是正确的（与查询字符串参数之一的值相反）

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-09-17T19:06:21.647

`HttpUtility.HtmlEncode`/ 解码
`HttpUtility.UrlEncode`/ 解码

`System.Web`如果您的项目中不可用，您可以添加对程序集的引用

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2011-02-04T20:39:24.290

我尝试为 c# 做 javascript 的 encodeURIComponent 的完全兼容模拟，经过 4 小时的实验，我发现了这个

c#代码：

```
string a = "!@#$%^&*()_+ some text here али мамедов баку";
a = System.Web.HttpUtility.UrlEncode(a);
a = a.Replace("+", "%20"); 
```

结果是： **!%40%23%24%25%5e%26*()_%2b%20some%20text%20here%20%d0%b0%d0%bb%d0%b8%20%d0%bc% d0%b0%d0%bc%d0%b5%d0%b4%d0%be%d0%b2%20%d0%b1%d0%b0%d0%ba%d1%83**

使用 Javascript 的 decodeURLComponent() 解码后；

你会得到这个： **!@#$%^&*()_+ some text here али мамедов баку**

感谢您的关注

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-03-06T18:46:22.697

System.Uri.EscapeUriString() 似乎没有做任何事情，但 System.Uri.Escape **Data** String() 对我有用。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-09-17T19:07:08.040

尝试`Server.UrlEncode()`，或者`System.Web.HttpUtility.UrlEncode()`当您无权访问该`Server`对象时。您还可以使用`System.Uri.EscapeUriString()`来避免添加对`System.Web`程序集的引用。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2013-06-10T08:51:35.723

对于 Windows 应用商店应用程序，您将没有 HttpUtility。相反，您有：

对于 URI，在“？”之前：

*   系统。**Uri.EscapeUriString** ("example.com/Stack Overflow++?")
    *   ->“example.com/Stack%20Overflow++？”

对于 URI 查询名称或值，在“？”之后：

*   系统。**Uri.EscapeDataString**（“堆栈溢出++”）
    *   ->“堆栈%20溢出%2B%2B”

对于[x-www-form-urlencoded](http://www.w3.org/TR/html401/interact/forms.html#h-17.13.4.1)查询名称或值，在 POST 内容中：

*   系统网。**WebUtility.UrlEncode**（“堆栈溢出++”）
    *   ->“堆栈+溢出%2B%2B”

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-09-17T19:06:40.520

您可以使用 System.Web 命名空间中的 Server 对象

Server.UrlEncode、Server.UrlDecode、Server.HtmlEncode 和 Server.HtmlDecode。

编辑：海报补充说，这是一个 Windows 应用程序，而不是人们认为的 Web 应用程序。上面列出的项目可从 System.Web 内的 HttpUtility 类中获得，必须将其添加为对项目的引用。

# asp.net - 带有 UpdatePanel 的 PopupControlExtender 上的 ASP.net ACTK DragPanel Extender 在部分回发后不会拖动

> ID：86479
> 
> 赞同：0
> 
> 时间：2008-09-17T19:05:40.650
> 
> 标签：asp.net, asp.net-ajax, webforms

我在包含 UpdatePanel 的 aspx 页面上有一个面板。

此面板包含 PopUpControl Extender 和 DragPanel Extender。

在初始显示一切正常时，面板会按预期弹出并关闭，并且也可以拖动。

UpdatePanel 中有一个链接按钮，可触发部分回发。我最初想使用图像按钮，但遇到了很多麻烦，所以最终使用了有效的链接按钮。

部分回发完成后，我无法再拖动面板。

我很想听听有关如何解决此问题的建议。

有没有其他人遇到过这个问题？

你对此做了什么？

您是否知道在不使用其他第三方库的情况下完成这种功能组合的任何其他方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-18T21:54:01.750

看看拖动面板扩展器和弹出控件扩展器何时实际扩展您的面板。

那些扩展器很有可能在页面的初始化事件上工作。当更新面板触发并更新您的页面时，扩展的原始 DOM 元素被更新面板的结果替换。这意味着您现在拥有一个不再扩展的控件。

我真的不知道这个问题的简单解决方案。如果您可以在更新面板更新页面并再次扩展面板后挂钩事件，则可能会起作用。

# java - Spring Web Flow 中快照和流存储库的最佳文档是什么？

> ID：86487
> 
> 赞同：2
> 
> 时间：2008-09-17T19:06:40.647
> 
> 标签：java, spring, documentation, spring-webflow

我正在寻找更多更好的关于 Spring Web Flow 中的快照、流存储库和流状态序列化的文档。我发现的可用文档似乎很少。“Spring in Action”没有谈论这个。Spring Web Flow Reference Manual 确实在这里提到了几个标志：

[http://static.springframework.org/spring-webflow/docs/2.0.x/reference/htmlsingle/spring-webflow-reference.html#tuning-flow-execution-repository](http://static.springframework.org/spring-webflow/docs/2.0.x/reference/htmlsingle/spring-webflow-reference.html#tuning-flow-execution-repository)

但并没有真正谈论为什么要更改这些设置、使用模式等。

有人有好的参考吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-19T18:34:53.753

你试过这些书吗？

1.  [http://www.ervacon.com/products/swfbook/index.html](http://www.ervacon.com/products/swfbook/index.html) - 来自 WebFlow 的原作者？
2.  [http://www.amazon.com/Expert-Spring-MVC-Web-Flow/dp/159059584X](https://rads.stackoverflow.com/amzn/click/com/159059584X)

# javascript - 如何使用 RegisterClientScriptBlock 注册 JavaScript？

> ID：86491
> 
> 赞同：3
> 
> 时间：2008-09-17T19:07:01.800
> 
> 标签：javascript, asp.net

ASP.NET 2.0 提供了`ClientScript.RegisterClientScriptBlock()`在 ASP.NET 页面中注册 JavaScript 的方法。

我遇到的问题是当脚本位于另一个目录中时传递脚本。具体来说，以下语法不起作用：

```
ClientScript.RegisterClientScriptBlock(this.GetType(), "scriptName", "../dir/subdir/scriptName.js", true); 
```

[而不是像这个页面](http://msdn.microsoft.com/en-us/library/aa479390.aspx#javawasp2_topic7)所说的那样将代码放入页面中，而是显示`../dir/subdir/script.js`，我的问题是：

以前有没有人处理过这个问题，并找到了一种将javascript放入单独文件中的方法？我会以错误的方式解决这个问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-17T19:11:09.870

你追求的是：

```
ClientScript.RegisterClientScriptInclude(this.GetType(), "scriptName", "../dir/subdir/scriptName.js") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T19:10:55.003

使用：ClientScript.RegisterClientScriptInclude(key, url);

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-09-17T19:07:59.753

您的脚本值必须是完整的脚本，因此请为您的脚本值输入以下内容。

```
<script type='text/javascript' src='yourpathhere'></script> 
```

# javascript - 为什么使用 JavaScript eval 函数是个坏主意？

> ID：86513
> 
> 赞同：562
> 
> 时间：2008-09-17T19:09:54.803
> 
> 标签：javascript, security, eval

eval 函数是一种强大而简单的动态生成代码的方法，那么有哪些注意事项呢？

* * *

## 回答 #1

> 赞同：403
> 
> 时间：2008-09-17T19:17:35.207

1.  不正确使用**eval**会打开您的代码进行注入攻击

2.  **调试**可能更具挑战性（没有行号等）

3.  eval'd 代码执行速度较慢（没有机会编译/缓存 eval'd 代码）

编辑：正如@Jeff Walden 在评论中指出的那样，今天的#3 不如 2008 年那么真实。但是，虽然可能会发生一些编译脚本的缓存，但这将仅限于 eval'd 重复且未修改的脚本。更有可能的情况是，您正在评估每次都经过轻微修改的脚本，因此无法缓存。我们只是说一些 eval'd 代码执行得更慢。

* * *

## 回答 #2

> 赞同：352
> 
> 时间：2008-09-17T20:27:26.350

eval 并不总是邪恶的。有时它是完全合适的。

然而，eval 目前和历史上都被不知道自己在做什么的人大量过度使用。不幸的是，这包括编写 JavaScript 教程的人，在某些情况下，这确实会产生安全后果 - 或者更常见的是简单的错误。所以我们越能在 eval 上打一个问号就越好。每当你使用 eval 时，你都需要彻底检查你在做什么，因为你可能会以一种更好、更安全、更清洁的方式来做这件事。

举一个非常典型的例子，使用存储在变量“potato”中的 id 来设置元素的颜色：

```
eval('document.' + potato + '.style.color = "red"'); 
```

如果上述代码的作者对 JavaScript 对象如何工作的基础知识有所了解，他们就会意识到可以使用方括号代替文字点名，从而无需 eval：

```
document[potato].style.color = 'red'; 
```

...这更容易阅读并且潜在的错误更少。

（但是，一个/真的/知道他们在做什么的人会说：

```
document.getElementById(potato).style.color = 'red'; 
```

这比直接从文档对象中访问 DOM 元素的狡猾的老技巧更可靠。）

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2008-09-17T19:11:45.453

我相信这是因为它可以从字符串执行任何 JavaScript 函数。使用它使人们更容易将恶意代码注入应用程序。

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2008-09-17T19:20:52.470

想到两点：

1.  安全性（但只要您自己生成要评估的字符串，这可能不是问题）

2.  性能：在要执行的代码未知之前，无法进行优化。（关于 javascript 和性能，当然是[Steve Yegge 的演讲](http://steve-yegge.blogspot.com/2008/05/dynamic-languages-strike-back.html)）

* * *

## 回答 #5

> 赞同：25
> 
> 时间：2008-09-17T19:12:59.740

如果您传递 eval 用户输入，这通常只是一个问题。

* * *

## 回答 #6

> 赞同：22
> 
> 时间：2008-09-17T19:28:20.360

将用户输入传递给 eval() 存在安全风险，而且每次调用 eval() 都会创建一个新的 JavaScript 解释器实例。这可能是一种资源消耗。

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2008-09-17T19:12:33.907

主要是，维护和调试要困难得多。这就像一个`goto`. 您可以使用它，但它使发现问题变得更加困难，并且对以后可能需要进行更改的人来说也更加困难。

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2008-09-17T21:23:03.063

需要记住的一件事是，您通常可以使用 eval() 在其他受限环境中执行代码 - 阻止特定 JavaScript 函数的社交网站有时可能会通过在 eval 块中分解它们而被愚弄 -

```
eval('al' + 'er' + 't(\'' + 'hi there!' + '\')'); 
```

因此，如果您希望在可能不允许的地方运行一些 JavaScript 代码（[Myspace](http://en.wikipedia.org/wiki/Myspace)，我正在看着您...），那么 eval() 可能是一个有用的技巧。

但是，由于上述所有原因，您不应该将它用于您自己的代码，因为您可以完全控制它——这只是没有必要的，最好归类到“棘手的 JavaScript hacks”架子上。

* * *

## 回答 #9

> 赞同：13
> 
> 时间：2008-09-17T19:24:41.023

除非您让 eval() 成为动态内容（通过 cgi 或输入），否则它与您页面中的所有其他 JavaScript 一样安全可靠。

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2012-01-03T03:52:47.697

与其他答案一起，我认为 eval 语句不能具有高级最小化。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2008-09-17T19:37:46.187

这是一个可能的安全风险，它有不同的执行范围，而且效率很低，因为它为代码的执行创建了一个全新的脚本环境。有关更多信息，请参见此处：[eval](http://userjs.org/help/tutorials/efficient-code#evalevil)。

不过，它非常有用，并且适度使用可以增加很多好的功能。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2008-09-17T19:13:53.233

除非您 100% 确定要评估的代码来自受信任的来源（通常是您自己的应用程序），否则这是将您的系统暴露于跨站点脚本攻击的可靠方法。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2008-09-17T20:10:08.700

只要您知道您在什么环境中使用它，它不一定那么糟糕。

如果您的应用程序使用`eval()`从[XMLHttpRequest](http://en.wikipedia.org/wiki/XMLHttpRequest)返回到您自己的站点的某个 JSON 创建一个对象，该对象是由您受信任的服务器端代码创建的，那么这可能不是问题。

不受信任的客户端 JavaScript 代码无论如何也做不了那么多。如果您正在执行的事情`eval()`来自合理的来源，那么您很好。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2008-09-17T20:06:41.813

它大大降低了您对安全性的信心。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2010-03-09T14:28:37.937

如果您希望用户输入一些逻辑函数并计算 AND OR，那么 JavaScript eval 函数是完美的。我可以接受两个字符串和`eval(uate) string1 === string2`等。

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2017-05-08T14:06:35.490

如果您发现代码中使用了 eval()，请记住“eval() 是邪恶的”这句话。

此函数接受任意字符串并将其作为 JavaScript 代码执行。如果事先知道有问题的代码（不是在运行时确定），就没有理由使用 eval()。如果代码是在运行时动态生成的，通常有更好的方法来实现不使用 eval() 的目标。例如，仅使用方括号表示法来访问动态属性更好更简单：

```
// antipattern
var property = "name";
alert(eval("obj." + property));

// preferred
var property = "name";
alert(obj[property]); 
```

使用`eval()`也有安全隐患，因为您可能正在执行已被篡改的代码（例如来自网络）。这是处理来自 Ajax 请求的 JSON 响应时的常见反模式。在这些情况下，最好使用浏览器的内置方法来解析 JSON 响应，以确保其安全有效。对于本机不支持的浏览器`JSON.parse()`，您可以使用 JSON.org 中的库。

同样重要的是要记住，将字符串传递给`setInterval()`,`setTimeout()`和`Function()`构造函数在大多数情况下与 using 类似`eval()`，因此应避免使用。

在幕后，JavaScript 仍然需要评估并执行您作为编程代码传递的字符串：

```
// antipatterns
setTimeout("myFunc()", 1000);
setTimeout("myFunc(1, 2, 3)", 1000);

// preferred
setTimeout(myFunc, 1000);
setTimeout(function () {
myFunc(1, 2, 3);
}, 1000); 
```

使用 new Function() 构造函数与 eval() 类似，应谨慎使用。它可能是一个强大的结构，但经常被滥用。如果你绝对必须使用`eval()`，你可以考虑使用 new Function() 代替。

有一个小的潜在好处，因为在 new Function() 中评估的代码将在本地函数范围内运行，因此在被评估的代码中使用 var 定义的任何变量都不会自动成为全局变量。

防止自动全局变量的另一种方法是将 `eval()`调用包装到立即函数中。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-09-17T19:14:49.020

如果您正在执行用户提交的代码，除了可能存在的安全问题外，大多数时候还有一种更好的方法，它不需要在每次执行代码时都重新解析代码。匿名函数或对象属性可以取代 eval 的大多数用途，并且更加安全和快捷。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2008-09-17T19:20:41.830

随着下一代浏览器带有某种 JavaScript 编译器的出现，这可能会成为一个更大的问题。对于这些较新的浏览器，通过 Eval 执行的代码的性能可能不如您的 JavaScript 的其余部分。有人应该做一些分析。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2014-10-08T09:04:57.570

这是一篇关于 eval 以及它如何不是邪恶的好文章： [http ://www.nczonline.net/blog/2013/06/25/eval-isnt-evil-just-misunderstood/](http://www.nczonline.net/blog/2013/06/25/eval-isnt-evil-just-misunderstood/)

> 我并不是说你应该用完并开始在任何地方使用 eval() 。事实上，运行 eval() 的好用例很少。代码清晰度、可调试性和性能肯定存在不容忽视的问题。但是当你遇到 eval() 有意义的情况时，你不应该害怕使用它。尝试先不要使用它，但不要让任何人吓到你认为当 eval() 使用得当时，你的代码更脆弱或更不安全。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2014-10-25T15:17:51.680

eval() 非常强大，可用于执行 JS 语句或计算表达式。但是问题不在于 eval() 的用途，而只是说一些您使用 eval() 运行的字符串如何受到恶意方的影响。最后，您将运行恶意代码。权力伴随着巨大的责任。所以明智地使用它是你正在使用它。这与 eval() 函数关系不大，但这篇文章有很好的信息： http: [//blogs.popart.com/2009/07/javascript-injection-attacks/](http://blogs.popart.com/2009/07/javascript-injection-attacks/) 如果您正在寻找 eval() 的基础知识看这里： [https ://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval)

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2016-01-30T06:34:03.717

JavaScript 引擎在编译阶段执行了许多性能优化。其中一些归结为能够在词法分析时对代码进行本质上的静态分析，并预先确定所有变量和函数声明的位置，以便在执行期间解析标识符所需的工作更少。

但是如果引擎在代码中发现了一个 eval(..)，它本质上必须假设它对标识符位置的所有感知都可能是无效的，因为它无法在词法分析时准确地知道你可以传递给 eval(..) 的代码是什么。修改词法范围，或者您可以传递给的对象的内容，以创建要查询的新词法范围。

换句话说，在悲观的意义上，如果 eval(..) 存在，它所做的大多数优化都是毫无意义的，所以它根本不执行优化。

这说明了一切。

参考 ：

[https://github.com/getify/You-Dont-Know-JS/blob/master/scope%20&%20closures/ch2.md#eval](https://github.com/getify/You-Dont-Know-JS/blob/master/scope%20&%20closures/ch2.md#eval)

[https://github.com/getify/You-Dont-Know-JS/blob/master/scope%20&%20closures/ch2.md#performance](https://github.com/getify/You-Dont-Know-JS/blob/master/scope%20&%20closures/ch2.md#performance)

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2016-11-28T11:04:26.870

这并不总是一个坏主意。以代码生成为例。我最近编写了一个名为[Hyperbars的库，它弥补了](https://github.com/vincentracine/hyperbars)[virtual-dom](https://github.com/Matt-Esch/virtual-dom)和[handlebars](http://handlebarsjs.com/)之间的差距。它通过解析把手模板并将其转换为随后由 virtual-dom 使用的[超脚本来实现这一点。](https://github.com/dominictarr/hyperscript)超脚本首先生成为字符串，然后在返回之前将`eval()`其转换为可执行代码。在这种特殊情况下，我发现`eval()`邪恶与邪恶完全相反。

基本上来自

```
<div>
    {{#each names}}
        <span>{{this}}</span>
    {{/each}}
</div> 
```

对此

```
(function (state) {
    var Runtime = Hyperbars.Runtime;
    var context = state;
    return h('div', {}, [Runtime.each(context['names'], context, function (context, parent, options) {
        return [h('span', {}, [options['@index'], context])]
    })])
}.bind({})) 
```

在这种情况下，性能`eval()`不是问题，因为您只需要解释一次生成的字符串，然后多次重复使用可执行输出。

如果您对此感到好奇，可以查看代码生成是如何实现[的](https://github.com/vincentracine/hyperbars/blob/master/src/hyperbars.js#L131)。

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2018-03-01T11:30:39.323

`eval()`我想说的是，如果您在浏览器中运行的 javascript 中使用它并不重要。*（警告）

所有现代浏览器都有一个开发人员控制台，您可以在其中执行任意 javascript，任何半智能开发人员都可以查看您的 JS 源代码，并将他们需要的任何内容放入开发控制台以执行他们想要的操作。

*只要您的服务器端点对用户提供的值进行了正确的验证和清理，那么在您的客户端 javascript 中解析和评估的内容就无关紧要了。

但是，如果您要问它是否适合`eval()`在 PHP 中使用，答案是**否定**的，除非您将可能传递给您的 eval 语句的任何值**列入白名单。**

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2019-08-13T04:32:18.690

垃圾收集

浏览器垃圾收集不知道是否可以从内存中删除经过评估的代码，因此它只是将其保存到页面重新加载。如果您的用户只是很快就在您的页面上，这还不错，但这对于 webapp 来说可能是一个问题。

这是一个演示问题的脚本

[https://jsfiddle.net/CynderRnAsh/qux1osnw/](https://jsfiddle.net/CynderRnAsh/qux1osnw/)

```
document.getElementById("evalLeak").onclick = (e) => {
  for(let x = 0; x < 100; x++) {
    eval(x.toString());
  }
}; 
```

像上面的代码这样简单的事情会导致少量内存被存储，直到应用程序死掉。当 evaled 脚本是一个巨大的函数并在间隔调用时，情况会更糟。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2015-02-12T18:45:04.167

我不会试图反驳之前所说的任何东西，但我会提供 eval() 的这种用法（据我所知）不能以任何其他方式完成。可能有其他方法可以对此进行编码，也可能有对其进行优化的方法，但这是直接完成的，为了清楚起见，没有任何花里胡哨，以说明 eval 的使用确实没有任何其他替代方案。即：动态（或更准确地说）以编程方式创建的对象名称（与值相反）。

```
//Place this in a common/global JS lib:
var NS = function(namespace){
    var namespaceParts = String(namespace).split(".");
    var namespaceToTest = "";
    for(var i = 0; i < namespaceParts.length; i++){
        if(i === 0){
            namespaceToTest = namespaceParts[i];
        }
        else{
            namespaceToTest = namespaceToTest + "." + namespaceParts[i];
        }

        if(eval('typeof ' + namespaceToTest) === "undefined"){
            eval(namespaceToTest + ' = {}');
        }
    }
    return eval(namespace);
}

//Then, use this in your class definition libs:
NS('Root.Namespace').Class = function(settings){
  //Class constructor code here
}
//some generic method:
Root.Namespace.Class.prototype.Method = function(args){
    //Code goes here
    //this.MyOtherMethod("foo"));  // => "foo"
    return true;
}

//Then, in your applications, use this to instantiate an instance of your class:
var anInstanceOfClass = new Root.Namespace.Class(settings); 
```

编辑：顺便说一句，我不建议（出于迄今为止指出的所有安全原因）您将对象名称基于用户输入。不过，我无法想象你有什么好的理由要这样做。不过，我想我会指出这不是一个好主意:)

# continuous-integration - 有谁知道 CVS 命令行选项来获取上次签到的详细信息？

> ID：86515
> 
> 赞同：5
> 
> 时间：2008-09-17T19:10:13.977
> 
> 标签：continuous-integration, build-automation, cvs

我在 Windows 上使用 CVS（带有 WinCVS 前端），并且希望在构建失败时将上次签入的详细信息添加到来自我们的自动构建过程的电子邮件中，以便更容易修复。

我需要知道已更改的文件、更改它们的用户以及评论。

我一直在尝试制定命令行选项，但似乎从来没有得到准确的结果（要么得到太多的结果，而不是仅仅从一次签入，或者两周前的一些随机签入的详细信息）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T19:14:24.903

CVS 不像其他版本控制系统那样对变更集进行分组；每个文件都有自己独立的版本号和历史记录。这是 CVS 的缺陷之一，它促使人们转向更新的 VC。

也就是说，有一些方法可以实现你的目标。最简单的可能是添加一个提交后挂钩来发送电子邮件或将日志记录到文件中。然后，至少，您可以通过查看电子邮件的发送时间和进行更改的人员将一组提交组合在一起。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T19:14:11.267

CVS 不提供此功能。但是，您可以通过购买[FishEye](http://www.atlassian.com/software/fisheye/)的许可证或使用[CVSTrac](http://www.cvstrac.org)来获得它（注意：我没有尝试过 CVS Trac）。

或者您可以迁移到 SVN，它确实通过原子提交提供了此功能。您可以签入一组文件并将其计为一次提交。在 CVS 中，无论您做什么，每个文件都是一个单独的提交。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-17T19:19:46.340

哇。

我忘记了这有多难。我之前所做的是一个两阶段的过程。

首先，跑步

```
cvs history -c -a -D "7 days ago" |
    gawk '{ print "$1 == \"" $6 "\" && $2 == \"" $8 "/" $7 "\" { print \"" $2 " " $3 " " $6 " " $5 " " $8 "/" $7 "\"; next }" }' > /tmp/$$.awk 
```

收集有关前 7 天内所有签到的信息，并生成一个脚本，该脚本将用于创建已发送电子邮件的一部分。

然后，我在包含损坏文件的目录中搜索 CVS/Entries 文件以获取更多信息。

将两者结合在一起让我能够找到罪魁祸首并向他们发送电子邮件，通知他们他们已经破坏了构建。

抱歉，这个答案并不像我希望的那样完整。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T19:23:11.933

我们通过一个转储更改日志的 perl 脚本来完成此操作，您可以在第二个链接处获得适用于 Windows 的 perl 的免费版本。

[Cvs2Cl 脚本](http://www.red-bean.com/cvs2cl/)

[活动 Perl](http://www.activestate.com/Products/activeperl/index.mhtml "活动 Perl")

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-17T17:12:14.997

我在 CVSROOT 中使用 loginfo 并将该信息写入文件

[http://ximbiot.com/cvs/manual/cvs-1.11.23/cvs_18.html#SEC186](http://ximbiot.com/cvs/manual/cvs-1.11.23/cvs_18.html#SEC186)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T19:17:42.007

“cvs history -a -l”会让你接近吗？为所有用户显示每个项目的最后一个事件...

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-06T10:03:20.893

CVSNT 支持[提交 ID](http://www.cvsnt.org/manual/html/Commit-Identifiers.html)，您可以使用它来代替日志、签出或更新命令中的标签。每组提交的文件（提交在 CVSNT 中是原子的）都会收到自己唯一的 ID。您只需首先通过 cvs log 确定最后签入文件的 commitid（您可以通过 -d"1 hour ago" 或类似方法限制输出），然后查询哪些其他文件具有该 ID。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-06T10:42:30.237

Eclipse 内置了 ChangeSets。您可以通过提交浏览最后的更改（至少是传入的更改，也就是更新）。它通过按作者、提交消息和类似时间戳对提交进行分组来实现这一点。

这也适用于“与/另一个分支或版本比较”，您可以在其中选择分支、标签和日期。通过同步视图图标查看带有“更改集”的弹出菜单，并亲自查看。

编辑：这需要至少作为查看器更改为 Eclipse，但根据您需要比较和分组的频率，它可能不会太糟糕。如果您不想使用更多 - 仅将 Eclipse 用于 CVS。甚至应该可以通过带有所有插件的 rcp 获得一个大小合适的图形 cvs 客户端，但这肯定超出了范围......

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-16T16:12:06.443

这不是一个已解决的问题吗？我认为[CI Matrix](http://confluence.public.thoughtworks.org/display/CC/CI+Feature+Matrix)上支持 CVS 和电子邮件通知的几个工具中的任何一个都可以为您做到这一点。

# ant - 我可以使 Ant 复制任务特定于操作系统吗？

> ID：86526
> 
> 赞同：19
> 
> 时间：2008-09-17T19:11:39.387
> 
> 标签：ant, copy

[我有一个使用“复制”任务](http://ant.apache.org/manual/Tasks/copy.html)执行复制操作的 Ant 脚本。它是为 Windows 编写的，并且有一个硬编码的 C:\ 路径作为 'todir' 参数。我看到 'exec' 任务有一个 OS 参数，是否有类似的方法来基于 OS 分支副本？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-09-17T19:21:47.490

我建议将路径放在属性中，然后根据当前操作系统有条件地设置属性。

```
<condition property="foo.path" value="C:\Foo\Dir">
   <os family="windows"/>
</condition>
<condition property="foo.path" value="/home/foo/dir">
   <os family="unix"/>
</condition>

<fail unless="foo.path">No foo.path set for this OS!</fail> 
```

附带的好处是，一旦它在属性中，您就可以在不编辑 Ant 脚本的情况下覆盖它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-24T12:56:21.077

之前发布的操作系统特定变量的建议将起作用，但很多时候您可以简单地省略“C:”前缀并使用正斜杠（Unix 样式）文件路径，它适用于 Windows 和 Unix 系统。

所以，如果你想将文件复制到 Windows 上的“C:/tmp”和 Unix 上的“/tmp”，你可以使用类似的东西：

```
<copy todir="/tmp" overwrite="true" >
         <fileset dir="${lib.dir}">
             <include name="*.jar" />
         </fileset>
</copy> 
```

如果您确实想要/需要根据操作系统设置条件路径，可以将其简化为：

```
 <condition property="root.drive" value="C:/" else="/">
        <os family="windows" />
    </condition>
    <copy todir="${root.drive}tmp" overwrite="true" >
             <fileset dir="${lib.dir}">
                 <include name="*.jar" />
             </fileset>
    </copy> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T19:18:49.807

您可以使用条件任务分支到不同的复制任务......来自ant手册：

```
<condition property="isMacOsButNotMacOsX">
<and>
  <os family="mac"/>

  <not>
    <os family="unix"/>

  </not>
</and> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T19:18:37.310

您不能使用变量并根据类型分配它吗？你可以把它放在一个`build.properties`文件里。或者您可以使用[条件](http://ant.apache.org/manual/Tasks/condition.html)分配它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T19:20:41.330

声明一个变量，它是您操作的根文件夹。使用该变量为您的文件夹添加前缀，包括在复制任务中。

使用条件基于操作系统设置变量，或将其作为参数传递给 Ant 脚本。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-23T21:44:28.510

Ant-contrib 有 <osfamily /> 任务。这会将操作系统的系列公开给一个属性（您指定的名称）。这可能会有一些好处。

# java - JSF selectItem 标签格式

> ID：86531
> 
> 赞同：4
> 
> 时间：2008-09-17T19:12:46.543
> 
> 标签：java, jsf

试图在这个项目的 xhtml 中保留所有演示文稿，我需要格式化 selectItem 标记中的一些值，这些值具有 BigDecimal 值，并且需要使其看起来像货币。反正有应用`<f:convertNumber pattern="$#,##0.00"/>`Inside a`<f:selectItem>`标签吗？

有什么方法可以做到这一点或不涉及将其推送到java代码中的解决方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T00:00:59.143

在这里做了一些更多的研究之后，我非常确信这对于当前的 JSF 实现是不可能的。只是没有机会改变价值。

[http://java.sun.com/javaee/javaserverfaces/1.2/docs/tlddocs/f/selectItem.html](http://java.sun.com/javaee/javaserverfaces/1.2/docs/tlddocs/f/selectItem.html)

tld 将`itemLabel`属性显示为 a `ValueExpression`，将正文内容显示`<f:selectItem>`为空。因此，这些标签之一中不允许存在任何内容，并且标签必须指向 Java 模型中的逐字值。所以它已经被格式化出来了 Java 模型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-18T00:17:36.763

作为 jsf 的初学者，我遇到了类似的问题，也许我的解决方案很有帮助，也许它不符合“jsf 精神”

我刚刚创建了一个自定义标记库并扩展了类（在我的情况下为 org.apache.myfaces.component.html.ext.HtmlCommandButton）并覆盖了设置器以应用自定义参数。

所以而不是 `<t:commandButton/>`i used `<mytags:commandButton/>`，它就像我想要的那样灵活。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T19:14:58.287

您可以使用该模式设置转换器，但这听起来与您想要的完全相反。

# .net - 使用 .NET 实时读取文件中的更改

> ID：86534
> 
> 赞同：3
> 
> 时间：2008-09-17T19:12:58.290
> 
> 标签：.net, file, filesystemwatcher

我有一个经常更新的 .csv 文件（大约每分钟 20 到 30 次）。我想在将新添加的行写入文件后立即将它们插入数据库。

[FileSystemWatcher](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx)类侦听文件系统更改通知，并且可以在指定文件发生更改时引发事件。问题是 FileSystemWatcher 无法准确确定添加或删除了哪些行（据我所知）。

读取这些行的一种方法是保存和比较更改之间的行数，并读取最后一个更改和倒数第二个更改之间的差异。但是，我正在寻找更清洁（也许更优雅）的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T19:47:08.037

我写了一些非常相似的东西。我使用 FileSystemWatcher 来获取有关更改的通知。然后我使用 FileStream 读取数据（跟踪我在文件中的最后位置并在读取新数据之前寻找该位置）。然后我将读取的数据添加到缓冲区，该缓冲区会自动提取完整的行，然后输出到 UI。

注意：“this.MoreData(..) 是一个事件，其监听器添加到上述缓冲区，并处理完整的行提取。

注意：正如已经提到的，这只有在修改总是添加到文件时才有效。任何删除都会导致问题。

希望这可以帮助。

```
 public void File_Changed( object source, FileSystemEventArgs e )
    {
        lock ( this )
        {
            if ( !this.bPaused )
            {
                bool bMoreData = false;

                // Read from current seek position to end of file
                byte[] bytesRead = new byte[this.iMaxBytes];
                FileStream fs = new FileStream( this.strFilename, FileMode.Open, FileAccess.Read, FileShare.ReadWrite );

                if ( 0 == this.iPreviousSeekPos )
                {
                    if ( this.bReadFromStart )
                    {
                        if ( null != this.BeginReadStart )
                        {
                            this.BeginReadStart( null, null );
                        }
                        this.bReadingFromStart = true;
                    }
                    else
                    {
                        if ( fs.Length > this.iMaxBytes )
                        {
                            this.iPreviousSeekPos = fs.Length - this.iMaxBytes;
                        }
                    }
                }

                this.iPreviousSeekPos = (int)fs.Seek( this.iPreviousSeekPos, SeekOrigin.Begin );
                int iNumBytes = fs.Read( bytesRead, 0, this.iMaxBytes );
                this.iPreviousSeekPos += iNumBytes;

                // If we haven't read all the data, then raise another event
                if ( this.iPreviousSeekPos < fs.Length )
                {
                    bMoreData = true;
                }

                fs.Close();

                string strData = this.encoding.GetString( bytesRead );
                this.MoreData( this, strData );

                if ( bMoreData )
                {
                    File_Changed( null, null );
                }
                else
                {
                    if ( this.bReadingFromStart )
                    {
                        this.bReadingFromStart = false;
                        if ( null != this.EndReadStart )
                        {
                            this.EndReadStart( null, null );
                        }
                    }
                }
            }
        } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T19:23:24.600

是的，FileSystemWatcher 对您的文件内容一无所知。它会告诉您它是否发生了变化等，但不会告诉您发生了什么变化。

你只是添加到文件中吗？帖子中关于是否添加或也可以删除行有点不清楚。假设它们已附加，则解决方案非常简单，否则您将进行一些比较。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T20:25:24.513

我认为您应该使用 NTFS Change Journal 或类似的：

> The change journal is used by NTFS to provide a persistent log of all changes made to files on the volume. For each volume, NTFS uses the change journal to **track information about added, deleted, and modified files**. The change journal is much more efficient than time stamps or file notifications for determining changes in a given namespace.

You can find a [description on TechNet](http://www.microsoft.com/technet/prodtechnol/windows2000serv/reskit/core/fncc_fil_khzt.mspx?mfr=true). You will need to use PInvoke in .NET.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T19:21:12.997

如果当前文本足够小，我会将其保留在内存中，然后使用差异算法检查新文本和以前的文本是否更改。这个库[http://www.mathertel.de/Diff/](http://www.mathertel.de/Diff/)不仅会告诉您发生了一些变化，而且还会告诉您发生了什么变化。因此，您可以将更改的数据插入到数据库中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T19:21:06.383

在我的脑海中，你可以存储最后一个已知的文件大小。检查文件大小，当它发生变化时，打开阅读器。

然后寻找读者到你最后的文件大小，并从那里开始阅读。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T19:23:37.097

您对 FileSystemWatcher 是正确的。您可以侦听创建、修改、删除等事件，但不会比引发它们的文件更深入。

您可以控制文件本身吗？您可以稍微更改模型以将文件用作缓冲区。而不是一个文件，有两个。一个是分期，一个是所有处理输出的总和。从“缓冲区”文件中读取所有行，处理它们，然后将它们插入到另一个文件的末尾，该文件是处理的所有行的总和。然后，删除您处理的行。这样，您文件中的所有信息都处于待处理状态。问题是，如果系统不是写（即也删除行），那么它将无法工作。

# .net - 如何在 clickonce 部署时修改配置文件？

> ID：86539
> 
> 赞同：6
> 
> 时间：2008-09-17T19:13:32.143
> 
> 标签：.net, clickonce

我有一个通过 clickonce 部署的应用程序，但是如何修改部署服务器上的配置文件？我的意思是，一旦产品经过测试，它应该部署在我们的生产服务器中，但是需要修改一些配置参数来消耗生产资源？我听说我们应该使用 MageUI.exe，但仍然不确定。

感谢您的帮助。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-18T15:06:13.103

是的，最好的方法可能是 MageUI。只需使用 MageUI 打开您的清单，单击**保存**，它应该会提示您退出清单。

签署清单时有两种选择。您可以使用自我证书或购买证书。自我证书易于使用，但安装应用程序后，发布者将显示为**Unknown**。如果您购买证书，请使用这些说明创建签署 ClickOnce 清单所需的文件 - [http://www.softinsight.com/bnoyes/CommentView.aspx?guid=78d107d1-3937-4d8d-81d9-73cb6ae18eee](http://www.softinsight.com/bnoyes/CommentView.aspx?guid=78d107d1-3937-4d8d-81d9-73cb6ae18eee)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-03T18:35:08.327

codeConcussion 是正确的——我们一直在为我们的配置更改这样做。要记住的是，如果您正在管理版本，以便用户只有在服务器上有新版本时才能获得新版本的智能客户端，您需要在清单文件中任意增加版本以获取配置更改以再次下载给用户。

当然，这可能很危险，具体取决于您的部署过程对应用程序的版本。对于我们来说，我们使用基于时间的算法，将版本重新设置为 HHMM 后跟的日期（例如，2008.9.23.1317）。这是在我们的构建/部署脚本中完成的，因此我们几乎可以确保我们可以在清单中将版本更改为 2008.9.23.1318，而不必担心使用相同版本的另一个构建。

无论如何，要考虑的事情。

# javascript - 是否有针对 IE6 的 JavaScript PNG 修复程序，允许 CSS 背景定位？

> ID：86545
> 
> 赞同：11
> 
> 时间：2008-09-17T19:14:06.557
> 
> 标签：javascript, css, internet-explorer-6, png, transparency

我已经看到了一些允许 PNG 图像在 Internet Explorer 6 中具有透明度的修复程序，但我还没有找到一个还允许您在 CSS 中设置背景位置的修复程序。如果你使用精灵，它是一个交易破坏者。我求助于使用 GIF（质量不高），根本不使用透明图像，或者为 IE6 提供完全不同的样式表。是否有针对 IE6 的允许 PNG 透明度和背景定位的修复程序？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-17T19:20:06.637

是的。将您的图像转换为使用索引托盘 (png256)。您可以支持透明度（就像 gif 一样），但不能支持 alpha 通道。

您可以使用[Irfanview](http://www.irfanview.com/)和 pngout 插件 pngquant[或](http://www.libpng.org/pub/png/apps/pngquant.html)pngnq[来](http://pngnq.sourceforge.net/)做到这一点。

YUI 性能团队还做了一个[很棒的演示](http://assets.en.oreilly.com/1/event/7/Image%20Optimization_%20How%20Many%20of%20These%207%20Mistakes%20Are%20You%20Making%20Presentation.ppt)，涵盖了许多其他图像优化概念。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-17T19:42:27.457

[这](http://www.micahtischler.com/#mtjs_iepnghandler.js)是最近一个月左右出现的一种新技术。从页面：

> 在此脚本中，支持图像标签，无论是否带有空格分隔符 GIF，并且背景图像 PNG 可以被定位和重复，即使它们小于它们所在的内容元素。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T13:27:21.857

当背景是静态的时，我使用[TweakPNG](http://entropymine.com/jason/tweakpng/)将 PNG 中的背景颜色块更改为正确的颜色（而不是默认的灰色）。任何常规浏览器都会忽略这一点，因为 alpha 通道会覆盖它，但 IE6 及更低版本将使用该颜色而不是 alpha 通道。

这意味着我们在 IE7+ 中具有透明度，而在 IE6 和更低版本中则可以很好地降低。并且所有 css 定位和重复都是可能的（因为没有 hacks！）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-26T15:09:34.153

[DD_belatedPNG.js](http://www.dillerdesign.com/experiment/DD_belatedPNG/)效果很好

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T19:56:47.703

通过利用 IE6 的 alpha 过滤器和 CSS`clip`属性，您实际上可以使用纯 CSS 在 IE6 中获得具有 alpha 透明度的定位背景图像。Julien Lecomte[在他的博客上描述了这项技术](http://www.julienlecomte.net/blog/2007/07/4/)。

请注意，此技术确实会导致每次使用 alpha 过滤器时性能受到影响。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-26T14:09:57.223

[IE PNG Fix v2.0](http://www.twinhelix.com/css/iepngfix/)支持完整的 alpha+ `position`/ `repeat`。

# filesystems - 如何保护我的文件数据免受磁盘损坏？

> ID：86548
> 
> 赞同：2
> 
> 时间：2008-09-17T19:14:15.637
> 
> 标签：filesystems, storage, corruption

最近，我读到一篇题为[“SATA vs. SCSI 可靠性”](http://alumnit.ca/~apenwarr/log/?m=200809#08)的文章。它主要讨论消费级 SATA 驱动器中非常高的位翻转率，并得出结论“您现在无法从特定磁盘读取所有数据的可能性为 56%”。甚至 Raid-5 也无法拯救我们，因为它必须不断地扫描它是否有问题，如果磁盘确实死了，你几乎可以保证在重建的文件系统上有一些翻转的位。

注意事项：

我听说过 Sun 的[ZFS](http://en.wikipedia.org/wiki/ZFS) with [Raid-Z](http://en.wikipedia.org/wiki/Non-standard_RAID_levels#RAID-Z)，但 Linux 和 BSD 的实现仍处于试验阶段。我不确定它是否已准备好迎接黄金时段。

我还阅读了很多关于[Par2](http://en.wikipedia.org/wiki/Parchive)文件格式的内容。似乎与每个文件一起存储一些额外的 % 奇偶校验可以让您从大多数问题中恢复。但是，我不知道在内部执行此操作的文件系统，并且似乎很难管理单独的文件。

备份（编辑）：

我知道备份是最重要的。但是，如果没有进行某种检查，您可能很容易在不知情的情况下向人们发送不良数据。此外，确定哪个备份具有该数据的良好副本可能很困难。

例如，您有一个运行了一年的 Raid-5 阵列，您发现了一个损坏的文件。现在你必须回去检查你的备份，直到你找到一个好的副本。理想情况下，您会转到包含该文件的第一个备份，但这可能很难弄清楚，特别是如果该文件已被多次编辑。更糟糕的是，考虑该文件是否在损坏发生后被附加或编辑。对于 Par2 等块级奇偶校验，仅此一项就足够了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-17T19:34:13.530

那篇文章通过误解来源大大夸大了这个问题。它假设数据丢失事件是独立的，即如果我使用一千个磁盘，并得到五百个错误，那么很可能在五百个磁盘上各有一个。但实际上，任何遇到过磁盘问题的人都知道，一个磁盘上可能有 500 个错误（仍然是磁盘总容量的一小部分），而其他 999 个则没有问题。因此，在实践中，并不是有 56% 的可能性您无法读取所有磁盘，而是可能更像是 1% 或更少，但是这 1% 中的大多数人会发现他们已经丢失了几十个或数百个扇区，即使整个磁盘没有发生故障。

果然，实际实验反映了这种理解，而不是文章中提供的。

基本上这是“中国耳语”的一个例子。此处链接的文章是指另一篇文章，而该文章又间接引用了已发表的论文。该论文说，这些事件当然*不是独立*的，但在向易于消化的博客格式过渡时，这一重要事实就消失了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T19:20:55.620

56% 的机会我看不懂，我对此表示怀疑。我混合使用了 RAID 5 和其他好东西以及良好的备份实践，但是使用 Raid 5 和热备件我从来没有丢失过数据，所以我不确定所有的大惊小怪是什么。如果您要存储奇偶校验信息……那么您正在使用软件创建 RAID 系统，R5 中的磁盘故障会导致奇偶校验，例如检查以取回丢失的磁盘数据，所以……它已经存在。

运行 Raid，备份你的数据，你很好 :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T20:05:53.983

ZFS 是一个开始。许多存储供应商还提供具有额外数​​据保护功能的 520B 驱动器。但是，这只会在数据进入存储结构后立即保护您的数据。如果它在主机级别被损坏，那么无论如何你都会被淹没。

即将出现一些有前途的基于标准的解决方案来解决这个问题。端到端数据保护。

考虑 T10 DIF（数据完整性字段）。这是一个新兴的标准（它是在 5 年前起草的）和一项新技术，但它的崇高目标是解决数据损坏问题。

# c# - Ajax.Net 扩展框架中的 IndexOutOfRangeException

> ID：86549
> 
> 赞同：0
> 
> 时间：2008-09-17T19:14:21.017
> 
> 标签：c#, ajax.net

出于某种原因，当我尝试使用 ScriptService 属性集向 Ajax.net Web 服务发出请求时，在协议类的深处发生了一个我无法控制的异常。有人见过这个吗？

这是确切的消息： System.IndexOutOfRangeException：索引超出了数组的范围。在 System.Web.Services.Protocols.HttpServerType..ctor(Type type) 在 System.Web.Services.Protocols.HttpServerProtocol.Initialize() 在 System.Web.Services.Protocols.ServerProtocol.SetContext(Type type, HttpContext ontext, HttpRequest 请求，HttpResponse 响应）在 System.Web.Services.Protocols.ServerProtocolFactory.Create（类型类型，HttpContext 上下文，HttpRequest 请求，HttpResponse 响应，Boolean& abortProcessing）

谢谢特雷夫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-17T19:32:55.623

在将参数读入 Web 服务方法时，这通常是一个例外……您确定要传递该方法所期望的参数的数量/类型吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-17T19:39:04.407

还要确保为 asp.net ajax 正确设置了 web.config：

[http://www.asp.net/AJAX/Documentation/Live/ConfiguringASPNETAJAX.aspx](https://web.archive.org/web/20080914214955/http://asp.net/ajax/documentation/live/ConfiguringASPNETAJAX.aspx)

# linux - 好的 Linux (Ubuntu) SVN 客户端

> ID：86550
> 
> 赞同：162
> 
> 时间：2008-09-17T19:14:22.517
> 
> 标签：linux, svn

Subversion 在 Windows 上有一个极好的客户端（当然是 Tortoise）。相比之下，我在 Linux 上尝试过的一切都 - 好吧 - 很糟糕......

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2009-04-12T17:08:35.057

*免责声明：很久以前，我是 RabbitVCS（以前称为 NautilusSvn）的开发人员之一。*

如果您使用 Nautilus，那么您可能会对[RabbitVCS](http://rabbitvcs.org/)（前面提到的 Trevor Bramble）感兴趣。它是用 Python 编写的用于 Nautilus 的 TortoiseSVN 的纯粹克隆。虽然仍有很多改进需要改进（尤其是在性能方面），但有些人似乎对此非常满意。

这个名字非常适合这个项目，因为它所指的故事非常准确地描述了开发速度（意思是长时间的小睡）。如果您确实选择开始使用 RabbitVCS 作为您的版本控制客户端，那么您可能不得不亲自动手。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2008-09-17T19:18:02.070

一般来说，我只是使用命令行`svn`，老实说，这是最快和最简单的方法，我建议你尝试一下。
在你忽略这个之前，你可能应该问自己是否真的有任何需要 GUI 的功能，以及你是否更愿意打开一个 GUI 应用程序并下载文件，或者只是输入`svn co svn://site-goes-here.org/trunk`

您可以轻松地`add`, `remove`, `move`, `commit`,`copy`或`update`使用 给出的简单命令来创建文件`svn help`，因此对于大多数用户来说已经足够了。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-07-28T22:28:58.270

首先，我会尽量不要在这里听起来很花哨；）

叹息..人们为什么不让文件资源管理器集成客户端是要走的路？它比打开终端和打字要高效得多。简单的数学运算，~两次鼠标点击与~10+击键。不过，我必须指出，我喜欢命令行，因为我做了大量的管理工作，并且更喜欢尽可能快速和简单地自动化事情。

在 Windows 上被 TortoiseSVN 宠坏了，当我搬到 ubuntu 时，我对缺少类似 tortoisesvn 的集成客户端感到惊讶。对于纯程序员来说，IDE 集成客户端可能就足够了，但对于通用用途，比如图形艺术家或其他随机办公人员，客户端必须集成到标准文件资源管理器中，否则大多数人根本不会使用它.

一些客户的一些想法：

kdesvn，迄今为止我最喜欢的客户端，虽然与 TortoiseSVN 相比有一个巨大的烦恼 - 你必须进入特殊的颠覆布局模式才能获得指示文件状态的覆盖。因此我不会调用 kdesvn 集成。

NautilusSVN，看起来很有希望，但从 0.12 版本开始，它在大型存储库中存在性能问题。我使用存储库，其中工作副本有时可以包含约 50 000 个文件，TortoiseSVN 可以处理这些文件，但 NautilusSVN 不能。所以我希望 NautilusSVN 能尽快得到一个新的优化版本。

RapidSVN 没有集成，但我试了一下。它表现得很奇怪，崩溃了几次。它在大约 20 分钟后被卸载..

我真的希望 NautilusSVN 项目能尽快发布一个新的性能优化版本。

NaughtySVN 看起来可以做得很好，但到目前为止它缺少图标覆盖，并且两年没有发布......所以我会说**NautilusSVN**是我们唯一的希望。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2008-09-17T19:16:48.563

[kdesvn](http://www.alwins-world.de/wiki/programs/kdesvn)可能是你能找到的最好的。

最后我检查了它可能与 konqueror 挂钩，但已经有一段时间了，我已经转向 git :)

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2008-09-17T19:24:53.567

你也可以看看[git-svn](http://git-scm.com/docs/git-svn)，它本质上是一个颠覆的 git 前端。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2008-09-17T19:16:40.717

看我的问题：

### [Linux 最好的颠覆客户端是什么？](https://stackoverflow.com/questions/52105/what-is-the-best-subversion-client-for-linux)

我也同意，Linux 中的 GUI 客户端很糟糕。

我在 Eclipse中使用[subeclipse](http://subclipse.tigris.org) ，在 gnome中使用[RapidSVN 。](http://rapidsvn.tigris.org)

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2008-10-05T11:52:13.320

恕我直言，有一个很棒的 svn gui 客户端 SmartSVN。它是商业项目，但有基础版（100% 功能）可以免费使用，甚至用于商业目的。它是用java编写的，所以它是多平台的（它需要sun-java*包）[http://smartsvn.com](http://smartsvn.com)

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-11-11T21:32:45.973

我想你可以看看**[RabbitVCS](http://rabbitvcs.org/)**

> RabbitVCS 是一组图形工具，旨在提供对您使用的版本控制系统的简单直接的访问。目前，它已集成到 Nautilus 文件管理器中，并且仅支持 Subversion，但我们的目标是整合其他版本控制系统以及其他文件管理器。RabbitVCS 的灵感来自 TortoiseSVN 等。

我正要试一试...看起来很有希望...

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-10-02T20:13:22.937

没有其他人提到它，我一直忘记这个名字，所以我在下次谷歌搜索时为我未来的自己添加这些说明......

目前 pagavcs 似乎是最好的[选择](http://code.google.com/p/pagavcs/)。

你想要这些`.deb`文件之一

> sillyspamfilter://pagavcs.googlecode.com/svn/repo/pool/main/p/pagavcs/

（1.4.33 是我现在安装的，所以如果最新的导致问题，请尝试那个）

安装然后运行

```
nautilus -q 
```

关闭 nautilus，然后再次打开 nautilus，你应该不用注销/关闭就可以了

可悲的是，兔子对我来说只是在大型存储库中窒息，所以无法使用，paga 不会减慢浏览速度，但似乎也没有尝试求助于目录以查看是否有任何变化。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-12-28T05:24:54.090

对于 Ubuntu，您可以使用与 Nautilus 集成的 KDESVN 来获得五个 Tortoise SVN 的感觉。

试试这个[ClickOffline.com：乌龟 SVN 的 Ubuntu 替代品](http://www.clickoffline.com/2008/12/ubuntu-alternatives-for-tortoise-svn-in-linux/)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-17T19:54:45.867

看一看 SVN Work Bench，不错但不完美

> ```
> sudo apt-get install svn-workbench 
> ```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-01-12T06:11:09.160

Nautilus 为 svn 活动提供上下文菜单

```
sudo apt-get install nautilus-script-collection-svn

cp -r /usr/share/nautilus-scripts/Subversion ~/.gnome2/nautilus-scripts/ 
```

欲了解更多信息

[鹦鹉螺上下文菜单](http://doc.es.aau.dk/it_services/30/manage_project_files_using_subversion/graphical_svn_in_ubuntu/)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-04-12T17:14:14.247

如果 TortoiseSVN 真的根深蒂固，你可以尝试通过 WINE 使用它吗？虽然我没试过。

如果做不到这一点，我发现带有 Subversive 的 Eclipse 非常好。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-17T19:20:50.160

我对 kdesvn 非常满意 - 与 konqueror 集成得非常好，就像 trortousesvn 和 windows 资源管理器一样，并且支持 tortoisesvn 的大部分功能。

当然，如果您使用 kubunto 而不是 ubuntu，您将从这种集成中受益。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-02-05T19:03:54.107

我有时使用 kdesvn 直接针对存储库工作。

在通过 Eclipse 处理项目时，我经常使用 Subclipse。

但最重要的是，我使用了好的 ol' CLI。使用一些别名和 bash 脚本来备份它，它确实是使用 svn 的最简洁、最可靠的方法。

我尝试过[NautilusSVN](http://code.google.com/p/nautilussvn/)（与[NaughtySVN 无关](http://naughtysvn.tigris.org/)）和 svn-workbench，发现它们太有问题或缺乏功能。我知道我曾在某个时候尝试过 RapidSVN，但我一定不会因为它被快速卸载而留下深刻印象，但我不记得它的任何内容。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-02-05T19:08:24.783

如果你使用它，NetBeans 有极好的版本控制管理，除了 SVN 之外还有几个客户端。

不过，我建议您学习如何从命令行使用 SVN。CLI 是 Linux 的精神 :)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-07-28T22:39:54.957

如果你使用 eclipse，subclipse 是我用过的最好的。在我看来，这也应该作为独立存在...易于使用，与您在 eclipse 中拥有的代码和项目相关联...非常适合使用 eclipse 并想要 gui 的开发人员。

就个人而言，我更喜欢命令行客户端，适用于 linux 和 windows。

**编辑：**如果您使用 XFCE 及其文件管理器（称为 Thunar），那么有一个插件可以很好地工作。如果我不想打开终端，我只使用那个，它具有所有功能，快速且易于使用。不过，还有一个用于 git 的...

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-11-25T09:07:25.437

作为开发人员，我使用 eclipse + sub-eclipse 客户端（假设您使用 svn 签出一些开发项目并且您将编译它们）。

大多数人不会花太多时间在 svn 操作上，而命令行是最快的方式。

还有一些不错的 GUI 工具：

[http://rabbitvcs.org/](http://rabbitvcs.org/)

或者

[http://www.harecoded.com/nautilus-subversion-integration-tool-execute-svn-commands-with-gnome-scripts-96355](http://www.harecoded.com/nautilus-subversion-integration-tool-execute-svn-commands-with-gnome-scripts-96355)

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-09-18T02:57:05.523

由于您使用的是 Ubuntu，而不是 Kubuntu，因此我假设您使用的是 GNOME。您可能对该链接中描述的[Nautilus Subversion 集成感兴趣。](http://www.harecoded.com/nautilus-subversion-integration-tool-execute-svn-commands-with-gnome-scripts-96355)

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-04-08T19:39:38.577

[Anjuta](http://www.anjuta.org/)有一个与 IDE 集成的内置 SVN 插件。

# ruby-on-rails - Rails 的最佳永久链接

> ID：86558
> 
> 赞同：4
> 
> 时间：2008-09-17T19:15:28.473
> 
> 标签：ruby-on-rails, ruby, seo, permalinks

您认为在 Rails 中（动态）创建 SEO 友好 URL 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-17T19:18:21.647

覆盖`to_param`模型类中的方法，以便将默认数字 ID 替换为有意义的字符串。例如，这个问题在 URL 中使用了**best-permalinking-for-rails 。**

Ryan Bates 有一个[关于这个主题的 Railscast](http://railscasts.com/episodes/63-model-name-in-url)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-17T22:00:53.393

ActiveSupport 在 Rails 中有一个新方法来帮助这个 - String#parameterize。相关的提交在[这里](http://github.com/rails/rails/commit/90366a1521659d07a3b75936b3231adeb376f1a4)；提交消息中给出的示例是 "Donald E. Knuth".parameterize => "donald-e-knuth"

结合 John Topley 提到的 to_param 覆盖，这使得更友好的 URL 更容易。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-18T00:59:28.160

[rsl 的 stringex](http://github.com/rsl/stringex "rsl的字符串")非常棒，认为 permalink_fu 做得对。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-18T02:44:47.487

我主要`to_param`按照 John Topley 的建议使用。

请记住放置索引，以便您在 to_param 中使用的任何内容都可以快速搜索，否则您最终会在每次访问时进行全表扫描。（**不是**性能增强器！）

一个快速的解决方法是将 ID 放在其中的某个地方，在这种情况下 ActiveRecord 将忽略它的其余部分，因为它只是在 id 上搜索。这就是为什么你会看到很多带有[http://example.com/someController/123-a-half-readable-title](http://example.com/someController/123-a-half-readable-title)之类的 URL 的 Rails 站点。

从我使用 Rails 的经验中获得关于这个和其他 SEO 观察的更多细节，你可能会发现我网站上的[这个页面](http://www.bingocardcreator.com/rails-seo-tips.htm)很有用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-22T06:52:15.637

对我来说friendly_id 工作得很好，它也可以生成slug，所以你不需要关心重复的url，也支持范围。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T19:18:47.310

查看 permalink_fu 插件（从 Mephisto 中提取）... Git 存储库[位于此处](http://github.com/technoweenie/permalink_fu/tree/master)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-07-22T10:03:53.503

我制作了一个小而简单的 gem，它可以更容易地覆盖 to_param 方法。可以在[这里](http://github.com/thhermansen/beautify_url/)找到。

# c++ - 内联 C++ 代码

> ID：86561
> 
> 赞同：9
> 
> 时间：2008-09-17T19:15:38.707
> 
> 标签：c++, inline-functions

以下代码有什么不同：

```
class Foo  
{
  inline int SomeFunc() { return 42; }
  int AnotherFunc() { return 42; }
}; 
```

这两个函数都会被内联吗？内联实际上有什么不同吗？关于何时应该或不应该内联代码是否有任何规则？我经常使用`AnotherFunc`语法（例如访问器），但很少`inline`直接指定。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-09-17T19:17:39.730

`inline`关键字本质上是对编译器的提示。使用`inline`并不能保证你的函数*会*被内联，也不能保证它*不会*被内联。您只是让编译器知道，更努力地内联该特定函数可能是一个好主意。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-09-17T19:17:08.203

两种形式都应该以完全相同的方式内联。对于类定义中定义的函数体，内联是隐式的。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-17T19:18:35.530

Sutter 的本周 Guru #33 回答了您的一些问题以及更多问题。

[http://www.gotw.ca/gotw/033.htm](http://www.gotw.ca/gotw/033.htm)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-17T20:58:02.017

```
class Foo  
{
  inline int SomeFunc() { return 42; }
  int AnotherFunc() { return 42; }
}; 
```

两种方式都保证编译相同是正确的。但是，最好不要采用这两种方式。根据[C++ 常见问题解答](http://www.parashift.com/c++-faq-lite/inline-functions.html#faq-9.8)，您应该在类定义中正常声明它，然后在类定义之外，在标头内使用显式*inline*关键字定义它。正如FAQ所描述的，这是因为您想将声明和定义分开以使其他人的可读性（声明相当于“什么”和定义“如何”）。

> 内联实际上有什么不同吗？

是的，如果编译器允许内联请求，那就大不相同了。将内联代码视为宏。在调用它的任何地方，函数调用都会被函数定义中的实际代码替换。如果您内联大型函数，这可能会导致代码膨胀，但是如果函数太大，编译器通常会通过不授予内联请求来保护您免受这种情况的影响。

> 关于何时应该或不应该内联代码是否有任何规则？

我不知道任何硬性+快速的规则，但是如果经常调用并且相对较小，则指导方针是仅内联代码。Setter 和 getter 通常是内联的。如果它位于代码的性能特别密集的区域，则应考虑内联。永远记住，你是用内联来换取可执行文件大小的执行速度。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-17T19:23:03.913

如果您认为自己比编译器更了解， VC++ 支持[__forceinline](http://msdn.microsoft.com/en-us/library/z8y1yy88(VS.71).aspx)和[__declspec(noinline)指令。](http://msdn.microsoft.com/en-us/library/kxybs02x(VS.80).aspx)提示：你可能不知道！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-17T19:23:57.187

内联是编译器提示，并不强制编译器内联代码（至少在 C++ 中）。因此，简短的回答是它是编译器，并且可能取决于您的示例中将发生的情况。大多数优秀的编译器可能会内联两者，特别是由于两个函数的恒定返回的明显优化。

一般来说，内联不是您应该担心的事情。它带来了不必执行机器指令来生成堆栈帧和返回控制流的性能优势。但除了最专业的情况外，我认为这都是微不足道的。

内联在两种情况下很重要。如果您处于实时环境中并且响应速度不够快，则可以使用。二是如果代码分析在一个非常紧凑的循环中显示出明显的瓶颈（即，一个反复调用的子程序），那么内联可能会有所帮助。

特定的应用程序和架构也可能导致您将内联作为优化。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-17T21:36:59.897

如果内联被省略，我发现一些 C++ 编译器（即 SunStudio）会抱怨

```
int AnotherFunc() { return 42; } 
```

所以我建议在这种情况下总是使用 inline 关键字。如果您稍后将该方法实现为实际的函数调用，请不要忘记删除 inline 关键字，这会真正搞乱链接（在 SunStudio 11 和 12 以及 Borland C++ Builder 中）。我建议尽量少使用内联代码，因为当使用调试器单步执行代码时，即使使用“跳过”命令，它也会“进入”内联代码，这可能会很烦人。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-18T01:22:20.477

请注意，在类之外，`inline`在代码中做了一些更有用的事情：通过强制（嗯，有点）C++ 编译器在每次调用函数时生成内联代码，它可以防止同一符号的多个定义（函数签名) 在不同的翻译单元中。

因此，如果您在头文件中内联非成员函数，并将其包含在多个 cpp 文件中，则链接器不会对您大喊大叫。如果函数太大而无法建议内联，请使用 C 方式：在 header 中声明，在 cpp 中定义。

这与代码是否真的内联无关：它允许在头文件中实现样式，这对于短成员函数很常见。

（我想如果编译器需要函数的非内联渲染，它会很聪明，就像模板函数一样，但是......）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-18T04:53:46.537

另外补充一下 Greg 所说的，在执行优化（即`inline`-ing）时，编译器不仅会参考代码中的关键字，还会参考其他命令行参数，以指定编译器应如何优化代码。

# comparison - Visual Studio 2008 速成版中“缺少”什么？

> ID：86562
> 
> 赞同：126
> 
> 时间：2008-09-17T19:15:41.967
> 
> 标签：comparison, visual-studio-express

Visual Studio 2008 速成版中“缺少”什么？

尤其，

*   什么功能不可用？
*   它的使用有什么限制？

* * *

## 回答 #1

> 赞同：163
> 
> 时间：2008-09-17T19:20:49.940

与 Visual Studio Professional 相比，Visual Studio Express 缺乏功能的主要领域：

*   没有加载项/宏
*   缺少一些 Win32 工具
*   没有团队资源管理器支持
*   有限的重构支持
*   调试受到更多限制（特别是服务器开发的问题是没有远程调试）
*   缺乏对设置项目的支持
*   没有报告创建工具
*   没有 Office 开发支持
*   不支持移动平台
*   有限的设计师
*   有限的数据库工具集
*   没有代码分析或测试框架支持
*   不支持 MFC/ATL
*   不支持将 C++ 编译为 64 位图像（解决方法是安装免费的 Windows SDK）

**注意：**人们常说 Express EULA 不允许商业开发 - 这**不是**真的（[Visual Studio Express FAQ Item 7](http://www.microsoft.com/express/support/faq/)）

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2008-09-17T19:45:15.513

microsoft.com 上有一组方便的[比较图表](http://www.microsoft.com/downloads/details.aspx?FamilyID=727BCFB0-B575-47AB-9FD8-4EE067BB3A37&displaylang=en)。

当然，这取决于特定的特快版（因为有几个并且它们具有不同的功能）。您最有可能遇到的限制是源代码控制集成（和 TFS 客户端许可）、调试限制、有限的重构、没有单元测试支持和有限的设计器支持。

为完整起见，以下是 Visual Studio 2008 标准版中的功能列表，但在任何快速版本中都没有：

*   加载项
*   宏和宏 IDE
*   Visual Studio 加载项项目模板
*   VSPackages
*   奇才
*   ATL/MFC 跟踪工具
*   创建 GUID
*   Dotfuscator 社区版
*   错误查找
*   源代码控制集成
*   间谍++
*   团队资源管理器集成
*   Team Foundation Server 客户端访问许可证
*   Visual Studio 2008 图像库
*   加载项/宏安全选项
*   Visual Studio 设置
*   类设计师
*   封装字段重构
*   提取接口重构
*   将局部变量提升为参数重构
*   删除参数重构
*   重新排序参数重构
*   调试转储
*   即时调试
*   小型转储
*   多线程/多进程调试
*   NTSD 命令支持
*   步入 Web 服务调试
*   CAB 项目项目模板
*   合并模块项目模板
*   发布网站实用程序
*   设置项目模板
*   设置向导项目模板
*   智能设备 CAB 项目模板
*   Web 设置项目模板
*   Windows 安装程序部署
*   64 位 Visual C++ 工具
*   从 XML 文档创建 XSD 架构
*   报告应用项目模板
*   Visual Studio 报表设计器
*   Visual Studio 报表向导
*   共享加载项项目模板
*   ASP.NET AJAX 服务器控件扩展器项目模板
*   ASP.NET AJAX 服务器控件项目模板
*   ASP.NET 报告网站项目模板
*   ASP.NET 服务器控制项目模板
*   ASP.NET Web 应用程序项目模板
*   生成本地资源
*   WCF 服务主机
*   WCF 服务库项目模板
*   WF 活动设计器
*   自定义向导项目模板
*   WF 空工作流项目模板
*   MFC ActiveX 控件项目模板
*   MFC 应用程序项目模板
*   MFC DLL 项目模板
*   WF 顺序工作流控制台应用程序项目模板
*   WF 顺序工作流库项目模板
*   WF 顺序工作流服务库项目模板
*   WF 状态机工作流库项目模板
*   WF 状态机工作流程设计器
*   WF 状态机工作流服务库项目模板
*   WCF 联合服务库项目模板
*   适用于 Windows Workflow Foundation 设计器的 Visual Studio 扩展
*   Windows 窗体控件库项目模板
*   Windows 服务项目模板
*   WF 工作流活动库项目模板
*   WPF 自定义控件库项目模板
*   WPF 用户控件库项目模板
*   ASP.NET 服务器控件项模板
*   COM 类项目模板
*   配置文件项模板
*   框架集项目模板
*   接口项模板
*   CLR 安装程序类项模板
*   本地数据库缓存项模板
*   模块定义文件项模板
*   嵌套母版页项目模板
*   ATL 注册脚本项目模板
*   MS 报告项目模板
*   报告向导项目模板
*   .NET 资源文件项模板
*   Win32 资源文件项模板
*   静态发现文件（Web 服务）项模板
*   事务组件项目模板
*   Web 内容表单项模板
*   Windows 脚本宿主项模板
*   Windows 服务项模板
*   XML 模式项模板

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-17T19:18:04.300

[下面是版本对比图](http://msdn.microsoft.com/en-us/vs2005/aa700921.aspx)

编辑：没有意识到这是 2005 年，而不是 2008 年

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-17T19:17:26.657

[Visual Studio 2008 产品比较](http://www.microsoft.com/downloads/details.aspx?FamilyId=727BCFB0-B575-47AB-9FD8-4EE067BB3A37&displaylang=en)

据我所知，它的使用没有限制，但我不是律师。

AviewAnew 指出您可以将 Express Edition 用于商业用途：使用 Visual Studio Express Edition 构建的应用程序没有许可限制。请参阅[常见问题解答](http://www.microsoft.com/express/support/faq/)#7。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-28T13:21:08.487

这些对我来说是最重要的：

*   您不能使用条件设置断点
*   插件支持
*   重构非常有限（重命名、提取方法）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-17T19:23:56.533

[在我看来， MFC](http://en.wikipedia.org/wiki/Microsoft_Foundation_Class_Library)是最重要的缺失的东西。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-17T19:17:22.553

不允许加载项

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-17T20:16:49.650

其他人已经发布了大量列表，但实际上，作为一个主要从事系统编程的人来说，我在使用 express 版本时最怀念的功能是

1.  调试器的线程感知部分，以及

2.  使用内置二进制查看器打开文件的能力。

如果我更频繁地进行 MFC 编程，我可能也会想念对话框设计器。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-28T20:34:08.117

缺少的一个（很高兴拥有）是：

> **源代码控制集成** 支持两个选项：基于源代码控制插件 API（以前称为 MSSCCI API）的源代码控制解决方案，或源代码控制 VSPackage

这一点尤其重要，尤其是当您使用像[Perforce](http://kb.perforce.com/AllPerforceApplications/IntegrationsPerforce/P4sccVisualStudio)这样的系统时，您必须在更改文件之前签出文件，尤其是更改所有团队成员的项目设置。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-17T19:17:55.643

这个[MSDN 文档](http://msdn.microsoft.com/en-us/vs2008/products/cc149003.aspx)应该可以为您提供所需的一切！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-17T19:18:56.013

对于 Visual Studio 2008，Express 版本没有内置的测试功能。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-17T19:36:06.440

[如果您下载Platform SDK](http://en.wikipedia.org/wiki/Microsoft_Windows_SDK)中的库，您可以构建[MFC](http://en.wikipedia.org/wiki/Microsoft_Foundation_Class_Library)应用程序。但是没有对设计对话框的内置支持。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-07T22:02:38.780

*Visual Studio Express中*允许加载项。最值得注意的是直接来自 Microsoft：XNA Game Studio 作为 Visual Studio Express 插件工作。

甚至还有一种项目类型（可能仅在完整的 Visual Studio 中可用），可让您构建自己的 Visual Studio Express 加载项！

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-10-01T06:38:55.247

请注意，目前，您无法在 Express 版本中获得 F#，尽管我认为这可能会在某个时间点发生变化。

有一种解决方法 - 您分别安装[Visual Studio Shell](http://msdn.microsoft.com/en-us/vsx2008/products/bb933751.aspx)和[F# CTP](http://www.microsoft.com/downloads/details.aspx?FamilyID=7bb32f32-9fac-4f34-ad56-b0bda130cf00&displaylang=en)，它们可以一起工作。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-10-16T19:33:04.847

我在 Windows Vista 上使用 Visual Studio Express (C++) 2008（带有 service pack 1）进行调试时遇到了问题。每当我执行诸如 (a) 中断程序、(b) 将焦点从应用程序返回到 IDE、(c) 恢复执行等任何操作时，程序都会挂起大约 30 秒。任务管理器显示“VSExpress.exe”在此期间消耗了整个 CPU。在此期间，Vista 在 IDE 的标题栏中显示“未响应”。

这让我发疯，所以我购买了 Visual Studio Professional 2008 的商业副本（SoftwareSurplus 提供 150 美元），这解决了问题。

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2008-09-17T19:22:41.403

您不能为其中一个创建[Windows 服务](http://en.wikipedia.org/wiki/Windows_service)。

# c# - 链接按钮单击事件未运行处理程序

> ID：86563
> 
> 赞同：1
> 
> 时间：2008-09-17T19:15:47.893
> 
> 标签：c#, events, asp.net-ajax, webforms

我正在使用 AJAX dropdownextender 创建一个自定义下拉列表。在我的下拉面板中，我有我的选项的链接按钮。

```
<asp:Label ID="ddl_Remit" runat="server" Text="Select remit address."
    Style="display: block; width: 300px; padding:2px; padding-right: 50px; font-family: Tahoma; font-size: 11px;" />
<asp:Panel ID="DropPanel" runat="server" CssClass="ContextMenuPanel" Style="display :none; visibility: hidden;">
    <asp:LinkButton runat="server" ID="Option1z" Text="451 Stinky Place Drive <br/>North Nowhere, Nebraska 20503-2343 " OnClick="OnSelect" CssClass="ContextMenuItem" />
    <asp:LinkButton runat="server" ID="Option2z" Text="451 Stinky Place Drive <br/>North Nowhere, Nebraska 20503-2343 " OnClick="OnSelect" CssClass="ContextMenuItem" />
    <asp:LinkButton runat="server" ID="Option3z" Text="451 Stinky Place Drive <br/>North Nowhere, Nebraska 20503-2343 " OnClick="OnSelect" CssClass="ContextMenuItem" />-->
</asp:Panel>
<ajaxToolkit:DropDownExtender runat="server" ID="DDE"
    TargetControlID="ddl_Remit"
    DropDownControlID="DropPanel" /> 
```

这很好用。现在我要做的是动态填充这个下拉列表。这是我最好的尝试：

```
private void fillRemitDDL()
{
    //LinkButton Text="451 Stinky Place Drive <br/>North Nowhere, Nebraska 20503-2343 " OnClick="OnSelect" CssClass="ContextMenuItem"

    DAL_ScanlineTableAdapters.SL_GetRemitByScanlineIDTableAdapter ta = new DAL_ScanlineTableAdapters.SL_GetRemitByScanlineIDTableAdapter();
    DataTable dt = (DataTable)ta.GetData(int.Parse(this.SLID));
    if (dt.Rows.Count > 0)
    {
        Panel ddl = this.FindControl("DropPanel") as Panel;
        ddl.Controls.Clear();
        for (int x = 0; x < dt.Rows.Count; x++)
        {
            LinkButton lb = new LinkButton();
            lb.Text = dt.Rows[x]["Remit3"].ToString().Trim() + "<br />" + dt.Rows[x]["Remit4"].ToString().Trim() + "<br />" + dt.Rows[x]["RemitZip"].ToString().Trim();
            lb.CssClass = "ContextMenuItem";
            lb.Attributes.Add("onclick", "setDDL(" + lb.Text + ")");
            ddl.Controls.Add(lb);
        }
    }
} 
```

我的问题是我无法让事件运行脚本！我已经尝试了上面的代码以及替换

```
lb.Attributes.Add("onclick", "setDDL(" + lb.Text + ")"); 
```

和

```
lb.Click += new EventHandler(OnSelect); 
```

并且

```
lb.OnClientClick = "setDDL(" + lb.Text + ")"); 
```

我正在客户端使用警报测试分支，但一无所获。

编辑：我想尝试添加通用锚，但我想我可以将元素添加到 asp.net 控件。我也不能从服务器代码访问客户端 div 来添加它。我将不得不对事件使用某种控制。我的 setDLL 函数如下：

```
function setDDL(var)
{
    alert(var);
    document.getElementById('ctl00_ContentPlaceHolder1_Scanline1_ddl_Remit').innerText = var;
} 
```

另外我只是在函数调用中取出了字符串变量（即来自

```
lb.Attributes.Add("onclick", "setDDL(" + lb.Text + ")"); 
```

到

```
lb.Attributes.Add("onclick", "setDDL()"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-17T19:26:51.660

我不确定您的 setDDL 方法在您的脚本中做了什么，但如果单击其中一个链接按钮，它应该会触发。我认为你最好只插入一个通用的 html 锚而不是 .net 链接按钮，因为你不会引用服务器端的控件。然后，您可以使用 setDDL 方法处理数据交换。此外，您可能希望引用您在 setDDL 调用中放置的字符串，因为如果您放置不带引号的文字字符串数据，则会导致脚本问题（例如不调用方法+页面错误）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-17T21:02:30.570

Ok, I used Literals to create anchor tags with onclicks on them and that seems to be working great. Thanks alot.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-17T20:04:09.010

添加应该看起来像这样（在字符串周围添加 '' 并添加一个 ; 到 javascript 语句的末尾）。

```
lb.Attributes.Add("onclick", "setDDL('" + lb.Text + "');"); 
```

或者！

在链接按钮上设置[OnClientClick](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.linkbutton.onclientclick.aspx)属性。

# wpf - 设计 WPF 地图控件

> ID：86570
> 
> 赞同：12
> 
> 时间：2008-09-17T19:16:29.733
> 
> 标签：wpf, gis

我正在考虑在 WPF 中制作一个简单的地图控件，并且正在考虑基本地图界面的设计，并且想知道是否有人对此有一些好的建议。

我在想的是使用 ScrollViewer（无滚动条）作为我的“视口”，然后将所有内容堆叠在画布上。从 Z-Index=0 开始，我在想：

1.  用于纬度/经度计算、控制定位、Z-Index 堆叠的基础画布。
2.  多个网格元素来表示不同缩放级别的地图。使用网格使平铺更容易。
3.  使用位置数据映射对象。
4.  地图控件（缩放滑块、概览等）。
5.  带有用于平移和缩放的鼠标移动事件的滚动查看器。

关于我应该如何构建它的任何评论建议？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-17T22:11:53.087

如果您正在寻找一个好的开始，您可以使用[SharpMap](https://github.com/SharpMap/SharpMap)项目提供的代码基础并从那里构建。如果我记得有几个人已经在为 SharpMap 开发 WPF 渲染器，那么您可能还有一些代码可以开始。

我个人在一个 C# 2.0 应用程序中使用了 SharpMap，该应用程序将 GIS 数据与实时 GPS 数据相结合，并且非常成功。SharpMap 为我提供了处理 GIS 数据的转换套件，以及处理更改 GIS 信息的数学基础。将非渲染代码与 WPF 前端一起使用应该相对简单，因为它们已经将表示与数据分开。

*（编辑：添加了有关我如何使用 SharpMap 的更多详细信息）*

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-02T00:53:20.537

这可能是一种迂回的方式，但您可能会在 SilverlightEarth.com 的 javascript 和 XAML 中找到一些有用的东西，[这](http://www.silverlightearth.com/)是一个基于 Silverlight 1.0 的地图瓦片客户端。它可以加载 VE、Google、Yahoo（有一个[DeepZoom 版本](http://www.silverlightearth.com/2/)也可以加载 OpenStreetMap、Moon 和 Mars；但由于它使用 MSI，它在 WPF 3/3.5 前端并没有真正的帮助）。

虽然 javascript 有点杂乱，但您可以清楚地看到它正在创建一个 Silverlight 1.0 Xaml（动态大小）画布，用图块（图像控件）填充它并处理放大/缩小和平移请求。您需要了解所有的 javascript 并将其转换为 C# - XAML 应该主要进入 WPF 不变。我已经[用 Deep Zoom 平铺金字塔](http://conceptdev.blogspot.com/2008/03/deepzoom-in-silverlight-10.html)（和[这里](http://conceptdev.blogspot.com/2008/03/deepzoom-in-silverlight-10-part-deux.html)）测试了这个 Silverlight 1.0，所以这些概念是适用的（即不仅适用于地图）。

我知道这是可行的，因为我自己在[Geoquery2008.com](http://geoquery2008.com/)（[屏幕截图](http://geoquery2008.com/screenshots/072_Across180a.png)）中构建了地图查看器，它是 WPF/c#。不幸的是，Geoquery2008 程序集被混淆了，但您仍然可以通过 DASM/Reflector 收集一些想法或有用的代码。它仍然是一个测试版，所以我不会声称它已经 100% 完成。我并没有真正想过将地图代码分解到一个单独的控件中，但如果另一个没有出现，我可能会调查一下......

顺便说一句，我也从 ScrollViewer 开始，但我计划放弃它并更密切地模仿 javascript，以便在平移/缩放时更容易重用 Image 对象（通过获得比 ScrollViewer 提供的更多控制过程）。

这些关于[Virtual Earth tile 系统](http://msdn.microsoft.com/en-us/library/bb259689.aspx)和[Deep Zoom 文件格式](http://msdn.microsoft.com/en-us/library/cc645077(VS.95).aspx)和相关链接的 MSDN 页面可能也是一个有用的参考。

最后 - 我猜你在这篇文章之后已经看到 DeepZoom/MultiScaleImage 很可能在[.NET 4.0/Studio 2010](http://www.ddj.com/windows/211601295)中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-04T17:02:43.247

不知道你是否使用 ESRI 软件，但我听说那里正在为那里的堆栈开发一个 Silverlight API，所以你可能想要推迟。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T22:02:18.540

您创建 WPF 映射工具的愿望与我的相似，这使我向Silverlight[提出](https://stackoverflow.com/questions/67628/deepzoom-for-wpf)了有关 DeepZoom（又名 MultiScaleImage）的问题。我想要一个 WPF 版本。接受的答案提供了一个非常好的起点的链接（类似于您描述的思考过程）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T23:14:02.940

虚拟地球对[WPF 有好处](http://blogs.msdn.com/devkeydet/archive/2008/06/24/wpf-and-virtual-earth-revisited.aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-01-30T13:35:39.710

它根本不属于我的工作领域，但你可以看看[MapWindow GIS](http://www.mapwindow.org/)，它有一个开源 ActiveX 对象，提供了很多地图和 GIS 功能。这是一篇解释如何将其嵌入 WPF 应用程序的帖子：

[http://www.mapwindow.org/phorum/read.php?13,13484](http://www.mapwindow.org/phorum/read.php?13,13484)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-11-21T10:58:34.580

下载 Bing Maps WPF Control sdk(Microsoft.Maps.MapControl.WPF.dll)。添加为 dll 作为参考，然后如下更改 XAML

**

```
<Window x:Class="WPFTestApplication.InsertPushpin"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:m="clr-namespace:Microsoft.Maps.MapControl.WPF;assembly=Microsoft.Maps.MapControl.WPF"
    Width="1024" Height="768">
    <Grid x:Name="LayoutRoot" Background="White">
        <m:Map CredentialsProvider="INSERT_YOUR_BING_MAPS_KEY" 
               Center="47.620574,-122.34942" ZoomLevel="12">
            <m:Pushpin Location="47.620574,-122.34942"/>
        </m:Map>
    </Grid>
</Window> 
```

**

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T19:51:09.260

主要问题是如何存储和访问要放入地图的项目（假设这不仅仅是图片显示）。查找场景图以获取一些想法。

此外，如果您希望它不仅仅是一个玩具图像查看器，那么纬度到 XY 缩放可以变得“有趣”

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-03-13T06:30:55.783

[Bing Maps Windows Presentation Foundation Control v1](http://blogs.msdn.com/b/surface/archive/2011/08/23/bing-maps-wpf-control-available-today.aspx)是 WPF 中最好的地图控件。

支持瓦片层——您现在可以在地图控件上覆盖自己的瓦片层。
关闭基础图块层——当您不需要/不想使用我们的基础地图图块，而是更喜欢使用您自己的而不将它们覆盖在我们的顶部时，这很有用。控件不会请求减少的图块下载并提高渲染性能。
SSL 支持 – 由于你们中的许多人在安全应用程序中使用 WPF 控件，因此您现在可以通过 SSL 发出磁贴和服务请求而不会出现问题。
隐藏比例尺 - 如果您不想要比例尺（可能您的地图很小并且比例尺使地图混乱），您可以将其关闭。事实上，唯一不能关闭的元素是 Bing 徽标和版权。
新的版权服务——为我们的数据供应商提供准确的版权。额外的惯性 - 现在为鼠标启用惯性，默认情况下为触摸启用。
其他错误修复——感谢对 MSDN 论坛、必应地图博客、电子邮件和 Twitter 的反馈。好找人。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-01-13T14:24:10.887

不要自己构建 - 使用 WPF Bing Maps Control [http://www.bing.com/community/site_blogs/b/maps/archive/2012/01/12/announcing-the-bing-maps-windows-presentation -基础控制-v1.aspx](http://www.bing.com/community/site_blogs/b/maps/archive/2012/01/12/announcing-the-bing-maps-windows-presentation-foundation-control-v1.aspx)

# c++ - 单例：应该如何使用

> ID：86582
> 
> 赞同：309
> 
> 时间：2008-09-17T19:17:39.747
> 
> 标签：c++, design-patterns, singleton

编辑：从另一个问题，我提供了一个答案，其中包含很多关于单身人士的问题/答案的链接：关于单身人士的[更多信息：](https://stackoverflow.com/questions/1008019/c-singleton-design-pattern/1008289#1008289)

所以我读过[单例：好的设计还是拐杖？](https://stackoverflow.com/questions/11831/singletons-good-design-or-a-crutch)
争论仍在继续。

我将单例视为一种设计模式（好的和坏的）。

Singleton 的问题不在于模式，而在于用户（对不起大家）。每个人和他们的父亲都认为他们可以正确地实施一项（根据我所做的许多采访，大多数人都不能）。同样因为每个人都认为他们可以实现正确的单例，所以他们滥用模式并在不合适的情况下使用它（用单例替换全局变量！）。

因此，需要回答的主要问题是：

*   什么时候应该使用单例
*   如何正确实现单例

我对这篇文章的希望是，我们可以在一个地方（而不是必须谷歌和搜索多个站点）收集何时（以及如何）正确使用 Singleton 的权威来源。同样合适的是反使用列表和常见的错误实现，解释为什么它们无法工作以及好的实现它们的弱点。

* * *

所以开始吧：
我会举起手说这是我使用的，但可能有问题。
我喜欢“Scott Myers”在他的书“Effective C++”中对主题的处理

> 使用单例的好情况（不多）：
> 
> *   日志框架
> *   线程回收池

```
/*
 * C++ Singleton
 * Limitation: Single Threaded Design
 * See: http://www.aristeia.com/Papers/DDJ_Jul_Aug_2004_revised.pdf
 *      For problems associated with locking in multi threaded applications
 *
 * Limitation:
 * If you use this Singleton (A) within a destructor of another Singleton (B)
 * This Singleton (A) must be fully constructed before the constructor of (B)
 * is called.
 */
class MySingleton
{
    private:
        // Private Constructor
        MySingleton();
        // Stop the compiler generating methods of copy the object
        MySingleton(MySingleton const& copy);            // Not Implemented
        MySingleton& operator=(MySingleton const& copy); // Not Implemented

    public:
        static MySingleton& getInstance()
        {
            // The only instance
            // Guaranteed to be lazy initialized
            // Guaranteed that it will be destroyed correctly
            static MySingleton instance;
            return instance;
        }
}; 
```

好的。让我们一起得到一些批评和其他实现。
:-)

* * *

## 回答 #1

> 赞同：191
> 
> 时间：2008-09-18T12:43:04.273

回答：

在以下情况下使用单例：

*   您需要在系统中拥有一个且只有一个类型的对象

在以下情况下不要使用单例：

*   你想节省内存
*   你想尝试一些新的东西
*   你想炫耀你知道多少
*   因为其他人都在这样做（参见维基百科中的[货物崇拜程序员）](http://en.wikipedia.org/wiki/Cargo_cult_programming)
*   在用户界面小部件中
*   应该是缓存
*   在字符串中
*   在会话中
*   我可以去一整天

如何创建最佳单例：

*   越小越好。我是一个极简主义者
*   确保它是线程安全的
*   确保它永远不会为空
*   确保它只创建一次
*   懒惰还是系统初始化？满足您的要求
*   有时操作系统或 JVM 会为您创建单例（例如，在 Java 中，每个类定义都是单例）
*   提供析构函数或以某种方式弄清楚如何处理资源
*   使用很少的内存

* * *

## 回答 #2

> 赞同：82
> 
> 时间：2009-04-17T18:47:59.673

单身人士让您能够在一个班级中结合两个不良特征。这在几乎所有方面都是错误的。

单身人士为您提供：

1.  对对象的全局访问，以及
2.  *保证不能创建*超过一个此类对象

 *第一个是直截了当的。全局变量通常很糟糕。除非我们*真的*需要它，否则我们永远不应该让对象全局可访问。

第二个可能听起来很有意义，但让我们考虑一下。您最后一次**意外*创建一个新对象而不是引用现有对象是什么时候？由于这是标记为 C++，让我们使用该语言的示例。你是不是经常不小心写

```
std::ostream os;
os << "hello world\n"; 
```

当你打算写

```
std::cout << "hello world\n"; 
```

当然不是。我们不需要针对这种错误进行保护，因为这种错误不会发生。如果是这样，正确的反应是回家睡 12-20 小时，希望你感觉好些。

如果只需要一个对象，只需创建一个实例。如果一个对象应该是全局可访问的，则将其设为全局对象。但这并不意味着不可能创建它的其他实例。

“只有一个实例是可能的”约束并不能真正保护我们免受可能的错误的影响。但这*确实*使我们的代码很难重构和维护。因为我们经常发现我们*确实*需要不止一个实例。我们*确实*有不止一个数据库，我们*确实*有不止一个配置对象，我们确实需要多个记录器。我们的单元测试可能希望能够在每个测试中创建和重新创建这些对象，举一个常见的例子。

*因此，当且仅当我们需要它提供的两个*特征时才应该使用单例：如果我们*需要*全局访问（这种情况很少见，因为通常不鼓励使用全局变量）**并且**我们*需要*防止任何人**创建**多个实例类（这对我来说听起来像是一个设计问题）。我能看到的唯一原因是如果创建两个实例会破坏我们的应用程序状态 - 可能是因为该类包含许多静态成员或类似的愚蠢。在这种情况下，显而易见的答案是修复该类。它不应该依赖于成为唯一的实例。

如果您需要对对象进行全局访问，请将其设为全局，例如`std::cout`. 但不要限制可以创建的实例数量。

如果您绝对肯定需要将类的实例数限制为一个，并且无法安全地处理创建第二个实例，那么请强制执行。但也不要让它在全球范围内可访问。

如果您确实需要这两个特征，那么 1) 使其成为单例，以及 2) 让我知道您需要它做什么，因为我很难想象这样的情况。

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2008-09-17T19:27:56.633

单例的问题不在于它们的实现。而是它们将两个不同的概念混为一谈，显然这两个概念都不是可取的。

1) 单例提供了一个对象的全局访问机制。尽管在没有明确定义的初始化顺序的语言中，它们可能稍微更线程安全或更可靠，但这种用法在道德上仍然等同于全局变量。它是一个用一些笨拙的语法修饰的全局变量（比如 foo::get_instance() 而不是 g_foo），但它的用途完全相同（整个程序都可以访问单个对象）并且具有完全相同的缺点。

2）单例防止类的多个实例化。很少见，IME，这种特性应该被纳入一个类。这通常是一个更具上下文的事情。许多被认为是唯一的事情实际上只是碰巧是唯一的。IMO 一个更合适的解决方案是只创建一个实例——直到您意识到您需要多个实例。

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2008-09-17T19:26:48.477

模式的一件事：**不要一概而论**。当它们有用时，它们都有所有情况，当它们失败时。

当您必须**测试**代码时，单例可能会令人讨厌。您通常会被该类的一个实例所困扰，并且可以选择在构造函数中打开一扇门或使用某种方法来重置状态等等。

另一个问题是，Singleton 实际上只不过是一个变相的**全局变量**。当你的程序有太多的全局共享状态时，事情往往会倒退，我们都知道。

它可能会使**依赖关系跟踪**变得更加困难。当一切都取决于你的单例时，更难改变它，分成两个，等等。你通常会坚持下去。这也妨碍了灵活性。研究一些**依赖注入**框架来尝试缓解这个问题。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2008-09-17T19:24:58.120

单例基本上让您在语言中拥有复杂的全局状态，否则很难或不可能拥有复杂的全局变量。

Java 尤其使用单例来代替全局变量，因为所有东西都必须包含在一个类中。最接近全局变量的是公共静态变量，它们可以像全局变量一样使用`import static`

C++ 确实有全局变量，但是调用全局类变量的构造函数的顺序是未定义的。因此，单例允许您将全局变量的创建推迟到第一次需要该变量时。

Python 和 Ruby 等语言很少使用单例，因为您可以在模块中使用全局变量。

那么什么时候使用单例是好/坏呢？几乎确切地说，何时使用全局变量是好/坏。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-09-18T12:29:04.667

*Alexandrescu 的Modern C++ Design*有一个线程安全的、可继承的泛型单例。

对于我的 2p 价值，我认为为你的单身人士定义生命周期很重要（当绝对有必要使用它们时）。我通常不会让静态`get()`函数实例化任何东西，并将设置和销毁留给主应用程序的某个专用部分。这有助于突出单例之间的依赖关系——但是，如上所述，最好尽可能避免它们。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-04-17T18:50:59.493

> *   如何正确实现单例

有一个问题我从未见过，我在以前的工作中遇到过。我们有在 DLL 之间共享的 C++ 单例，并且确保类的单个实例的通常机制不起作用。问题是每个 DLL 都有自己的一组静态变量以及 EXE。如果您的 get_instance 函数是内联函数或静态库的一部分，则每个 DLL 都会以自己的“单例”副本结束。

解决方案是确保单例代码仅在一个 DLL 或 EXE 中定义，或者创建一个具有这些属性的单例管理器来打包实例。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-09-17T19:20:13.687

第一个示例不是线程安全的 - 如果两个线程同时调用 getInstance，则该静态将是一个 PITA。某种形式的互斥锁会有所帮助。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-09-25T16:30:14.083

正如其他人所指出的，单例的主要缺点包括无法扩展它们，以及失去实例化多个实例的能力，例如用于测试目的。

单例的一些有用方面：

1.  惰性或预先实例化
2.  对于需要设置和/或状态的对象很方便

但是，您不必使用单例来获得这些好处。您可以编写一个正常的对象来完成这项工作，然后让人们通过工厂（一个单独的对象）访问它。如果需要，工厂可以担心只实例化一个，然后重用它等。此外，如果您对接口而不是具体类进行编程，则工厂可以使用策略，即您可以切换进出接口的各种实现。

最后，工厂适用于 Spring 等依赖注入技术。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-09-17T19:28:22.590

当您在初始化和对象时运行大量代码时，单例非常方便。例如，当您在设置持久性对象时使用 iBatis 时，它必须读取所有配置、解析映射、确保其全部正确等等，然后才能访问您的代码。

如果你每次都这样做，性能会大大降低。在单例中使用它，您只需一次点击，然后所有后续调用都不必这样做。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-09-17T19:33:19.770

单例的真正失败在于它们破坏了继承。除非您有权访问引用 Singleton 的代码，否则您无法派生新类来为您提供扩展功能。因此，除了单例将使您的代码紧密耦合（可通过策略模式修复......也称为依赖注入）这一事实之外，它还将阻止您关闭代码部分的修订（共享库）。

所以即使是记录器或线程池的例子也是无效的，应该用 Strategies 代替。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-04-17T19:09:19.043

大多数人在试图让自己对使用全局变量感觉良好时会使用单例。有合法用途，但在大多数情况下，当人们使用它们时，与全局可访问的事实相比，只能有一个实例这一事实只是一个微不足道的事实。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-08-01T12:41:53.303

因为单例只允许创建一个实例，所以它有效地控制了实例复制。例如，您不需要查找的多个实例 - 例如莫尔斯查找映射，因此将其包装在单例类中是恰当的。并且仅仅因为你有一个类的实例并不意味着你也受到对该实例的引用数量的限制。您可以对实例的调用进行排队（以避免线程问题）并进行必要的更改。是的，单例的一般形式是全局公共的，您当然可以修改设计以创建更多访问受限的单例。我以前没有厌倦过这个，但我确定这是可能的。对于所有评论说单例模式完全邪恶的人，您应该知道这一点：

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-09-17T19:44:56.403

但是当我需要像 Singleton 这样的东西时，我经常最终使用[Schwarz Counter](http://en.wikibooks.org/wiki/More_C%2B%2B_Idioms/Nifty_Counter)来实例化它。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2018-08-11T20:00:27.997

下面是实现线程安全单例模式的更好方法，它在析构函数本身中释放内存。但我认为析构函数应该是可选的，因为当程序终止时，单例实例将被自动销毁：

```
#include<iostream>
#include<mutex>

using namespace std;
std::mutex mtx;

class MySingleton{
private:
    static MySingleton * singletonInstance;
    MySingleton();
    ~MySingleton();
public:
    static MySingleton* GetInstance();
    MySingleton(const MySingleton&) = delete;
    const MySingleton& operator=(const MySingleton&) = delete;
    MySingleton(MySingleton&& other) noexcept = delete;
    MySingleton& operator=(MySingleton&& other) noexcept = delete;
};

MySingleton* MySingleton::singletonInstance = nullptr;
MySingleton::MySingleton(){ };
MySingleton::~MySingleton(){
    delete singletonInstance;
};

MySingleton* MySingleton::GetInstance(){
    if (singletonInstance == NULL){
        std::lock_guard<std::mutex> lock(mtx);
        if (singletonInstance == NULL)
            singletonInstance = new MySingleton();
    }
    return singletonInstance;
} 
```

Regarding the situations where we need to use singleton classes can be- If we want to maintain the state of the instance throughout the execution of the program If we are involved in writing into execution log of an application where only one instance of the file need to be used....and so on. It will be appreciable if anybody can suggest optimisation in my above code.

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-09-17T19:40:26.430

我使用 Singletons 作为面试测试。

当我要求开发人员说出一些设计模式时，如果他们只能说出 Singleton，那么他们不会被雇用。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2017-10-18T20:45:59.063

当我有一个封装大量内存的类时，我发现它们很有用。例如，在我最近开发的一个游戏中，我有一个影响图类，其中包含一组非常大的连续内存数组。我希望在启动时全部分配，在关机时全部释放，我绝对只想要一份副本。我还必须从很多地方访问它。我发现单例模式在这种情况下非常有用。

我确信还有其他解决方案，但我发现这个解决方案非常有用且易于实施。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-17T19:26:16.777

反使用：

过度使用单例的一个主要问题是该模式阻止了替代实现的轻松扩展和交换。无论在何处使用单例，类名都是硬编码的。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-09-17T19:27:22.390

我认为这是C#**最强大的版本：**

```
using System;
using System.Collections;
using System.Threading;

namespace DoFactory.GangOfFour.Singleton.RealWorld
{

  // MainApp test application

  class MainApp
  {
    static void Main()
    {
      LoadBalancer b1 = LoadBalancer.GetLoadBalancer();
      LoadBalancer b2 = LoadBalancer.GetLoadBalancer();
      LoadBalancer b3 = LoadBalancer.GetLoadBalancer();
      LoadBalancer b4 = LoadBalancer.GetLoadBalancer();

      // Same instance?
      if (b1 == b2 && b2 == b3 && b3 == b4)
      {
        Console.WriteLine("Same instance\n");
      }

      // All are the same instance -- use b1 arbitrarily
      // Load balance 15 server requests
      for (int i = 0; i < 15; i++)
      {
        Console.WriteLine(b1.Server);
      }

      // Wait for user
      Console.Read();    
    }
  }

  // "Singleton"

  class LoadBalancer
  {
    private static LoadBalancer instance;
    private ArrayList servers = new ArrayList();

    private Random random = new Random();

    // Lock synchronization object
    private static object syncLock = new object();

    // Constructor (protected)
    protected LoadBalancer()
    {
      // List of available servers
      servers.Add("ServerI");
      servers.Add("ServerII");
      servers.Add("ServerIII");
      servers.Add("ServerIV");
      servers.Add("ServerV");
    }

    public static LoadBalancer GetLoadBalancer()
    {
      // Support multithreaded applications through
      // 'Double checked locking' pattern which (once
      // the instance exists) avoids locking each
      // time the method is invoked
      if (instance == null)
      {
        lock (syncLock)
        {
          if (instance == null)
          {
            instance = new LoadBalancer();
          }
        }
      }

      return instance;
    }

    // Simple, but effective random load balancer

    public string Server
    {
      get
      {
        int r = random.Next(servers.Count);
        return servers[r].ToString();
      }
    }
  }
} 
```

这是**.NET 优化版本**：

```
using System;
using System.Collections;

namespace DoFactory.GangOfFour.Singleton.NETOptimized
{

  // MainApp test application

  class MainApp
  {

    static void Main()
    {
      LoadBalancer b1 = LoadBalancer.GetLoadBalancer();
      LoadBalancer b2 = LoadBalancer.GetLoadBalancer();
      LoadBalancer b3 = LoadBalancer.GetLoadBalancer();
      LoadBalancer b4 = LoadBalancer.GetLoadBalancer();

      // Confirm these are the same instance
      if (b1 == b2 && b2 == b3 && b3 == b4)
      {
        Console.WriteLine("Same instance\n");
      }

      // All are the same instance -- use b1 arbitrarily
      // Load balance 15 requests for a server
      for (int i = 0; i < 15; i++)
      {
        Console.WriteLine(b1.Server);
      }

      // Wait for user
      Console.Read();    
    }
  }

  // Singleton

  sealed class LoadBalancer
  {
    // Static members are lazily initialized.
    // .NET guarantees thread safety for static initialization
    private static readonly LoadBalancer instance =
      new LoadBalancer();

    private ArrayList servers = new ArrayList();
    private Random random = new Random();

    // Note: constructor is private.
    private LoadBalancer()
    {
      // List of available servers
      servers.Add("ServerI");
      servers.Add("ServerII");
      servers.Add("ServerIII");
      servers.Add("ServerIV");
      servers.Add("ServerV");
    }

    public static LoadBalancer GetLoadBalancer()
    {
      return instance;
    }

    // Simple, but effective load balancer
    public string Server
    {
      get
      {
        int r = random.Next(servers.Count);
        return servers[r].ToString();
      }
    }
  }
} 
```

您可以在[dotfactory.com](http://www.dofactory.com/Patterns/PatternSingleton.aspx#_self1)找到此模式。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2011-03-02T13:09:27.017

Meyers 单例模式在大多数情况下都可以很好地工作，并且在某些情况下，寻找更好的东西并不一定值得。只要构造函数永远不会抛出并且单例之间没有依赖关系。

单例是**全局可访问对象**（从现在开始为 GAO）的实现，尽管并非所有 GAO 都是单例。

记录器本身不应该是单例，但理想情况下记录的方式应该是全局可访问的，以便将生成日志消息的位置与记录的位置或方式分离。

延迟加载/延迟评估是一个不同的概念，单例通常也实现它。它有很多自己的问题，特别是线程安全和如果它因异常而失败时的问题，以至于当时看起来是个好主意，结果却不是那么好。（有点像字符串中的 COW 实现）。

考虑到这一点，GOA 可以这样初始化：

```
namespace {

T1 * pt1 = NULL;
T2 * pt2 = NULL;
T3 * pt3 = NULL;
T4 * pt4 = NULL;

}

int main( int argc, char* argv[])
{
   T1 t1(args1);
   T2 t2(args2);
   T3 t3(args3);
   T4 t4(args4);

   pt1 = &t1;
   pt2 = &t2;
   pt3 = &t3;
   pt4 = &t4;

   dostuff();

}

T1& getT1()
{
   return *pt1;
}

T2& getT2()
{
   return *pt2;
}

T3& getT3()
{
  return *pt3;
}

T4& getT4()
{
  return *pt4;
} 
```

它不需要像那样粗略地完成，并且显然在包含对象的已加载库中，您可能需要一些其他机制来管理它们的生命周期。（将它们放在加载库时获得的对象中）。

至于我什么时候使用单例？我将它们用于两件事 - 一个单例表，指示已使用 dlopen 加载了哪些库 - 记录器可以订阅并且您可以向其发送消息的消息处理程序。专门用于信号处理程序。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2014-01-31T03:35:23.977

我仍然不明白为什么单身人士必须是全球性的。

我打算生成一个单例，我将一个数据库作为私有常量静态变量隐藏在类中，并制作利用数据库的类函数，而无需将数据库暴露给用户。

我不明白为什么这个功能会不好。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2018-07-28T17:14:28.567

如果您是创建单例并使用它的人，请不要将其设为单例（这没有意义，因为您可以控制对象的奇点而不使其成为单例）但是当您是开发人员时才有意义库并且您只想向您的用户提供一个对象（在这种情况下，您是创建单例的人，但您不是用户）。

单例是对象，所以将它们用作对象，许多人通过调用返回它的方法直接访问单例，但这很有害，因为您让代码知道对象是单例，我更喜欢将单例用作对象，我传递它们通过构造函数，我将它们用作普通对象，通过这种方式，您的代码不知道这些对象是否是单例，这使得依赖关系更加清晰，它有助于重构......

* * *

## 回答 #23

> 赞同：-1
> 
> 时间：2008-09-17T19:39:40.410

在桌面应用程序中（我知道，现在只有我们恐龙写这些了！）它们对于获得相对不变的全局应用程序设置是必不可少的——用户语言、帮助文件的路径、用户偏好等，否则它们必须传播到每个类和每个对话框中.

编辑 - 当然这些应该是只读的！

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2012-01-07T17:10:33.110

另一种实现

```
class Singleton
{
public:
    static Singleton& Instance()
    {
        // lazy initialize
        if (instance_ == NULL) instance_ = new Singleton();

        return *instance_;
    }

private:
    Singleton() {};

    static Singleton *instance_;
}; 
```

# javascript - Google 地图、Z 索引和下拉 Javascript 菜单

> ID：86604
> 
> 赞同：14
> 
> 时间：2008-09-17T19:19:42.627
> 
> 标签：javascript, html, css, google-maps, z-index

我今天遇到了一个小问题：我有一个 JS 下拉菜单，当我插入 GoogleMap 时...菜单在 Google Map 后面呈现...关于如何利用 Google Map 的 z 索引的任何想法?

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-18T16:34:22.360

如果您的问题发生在 Internet Explorer 中，但它呈现的方式与您在 FireFox 或 Safari 中所期望的方式相同，那么[此链接对于遇到](http://aplus.rs/lab/z-pos/)[类似问题](https://stackoverflow.com/questions/88883/yui-autocomplete-renders-under-other-page-elements-in-ie7)的我来说非常有帮助。

它似乎归结为将元素标记为“位置：相对”的想法。在 CSS 中导致 IE6 和 7 以不直观和反规范的方式将其 z-index 与 HTML 文档中出现在它之前的其他元素相混淆。据说 IE8 的行为“正确”，但我自己没有测试过。

如果您的问题与表单元素有关，Anutron 的建议将非常有帮助`<SELECT>`，但如果您使用 JavaScript 来操作 div 或 uls 以像下拉菜单一样操作，我认为它不会有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T20:14:08.533

请注意，某些浏览器 ( *ahem* IE*ahem) 中的下拉菜单根本无法 zPositioned。如果你想在它上面放置一些东西，你需要使用“iframe shim”来隐藏它或完全隐藏下拉菜单。见：[http ://clientside.cnet.com/wiki/cnet-libraries/02-browser/02-iframeshim](http://clientside.cnet.com/wiki/cnet-libraries/02-browser/02-iframeshim)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-09-15T19:13:55.133

地图已经包含在一个 div 中。给它一个负 z-index 并且它可以工作 - 有一个警告：gmaps 控件不可点击。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-10-02T16:31:11.640

如果您的菜单包含在 div 容器中，例如`#menuWrap`，则将其分配相对位置并赋予其高 z-index.... 例如

```
#menuWrap {
  position: relative;
  z-index: 9999999
} 
```

确保您的地图位于 div 内

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-17T19:26:03.313

尝试将您的菜单 z-index 设置得非常高。[显然](http://archivist.incutio.com/viewlist/css-discuss/79150)，谷歌地图使用的范围是 -9000000 到 9000000。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-17T20:05:15.140

将地图包裹在 DIV 中，为该 DIV 指定 z-index 1。将下拉菜单包裹在 DIV 中并为其赋予更高的值。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-10-25T19:23:24.390

IE给出了问题

每个包含在相对定位 div 中的 div 都会在 IE 中启动一个新的 z-index。IE 解释外部相对 div 的方式是按 html 的顺序。最后定义的位于顶部。无论相对定位的 div 内的 div 的 z-index 是什么。

IE的解决方案：在html中定义最后应该在顶部的div。

（所以 z-index 在 IE 中确实有效，但仅适用于每个持有者 div，每个持有者 div 都独立于其他持有者 div）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-04-28T15:34:42.977

`z-index`（尤其是在 Internet Explorer 7 中）真的不适合我。我尝试了许多不同的高低地图 z 指数组合，但没有任何乐趣。

到目前为止，对我来说最简单/最快的答案是重新安排我的标记/css，以便在我的地图**上方/之前**的标记中列出我的弹出/翻转（字面意思是，在 之前`<div id="map">`），这样我可以让`z-index`保持默认（`auto`）并继续我的 webapp 的更重要的方面；）

希望这可以帮助！

```
<ul id="rollover">
<li><a href="#here">There</a></li>
</ul>
<div id="map">...</div> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-08-22T21:31:36.360

无需为地图和菜单设置 z-index。如果您只是将菜单的 z-index 设置为高于地图，则不一定有效。

将地图 div 的 z-index 设置为 -1。现在菜单将下拉并显示在地图上......但是如果您使用的是包装器，那么地图将不再是交互式的，因为它现在位于包装器后面。

要解决此问题，请在包装 div 中使用 onmouseover 和 onmouseout 函数。确保它们在您的包装器 div 中，而不是在您的地图 div 中。

```
onmouseover="getElementById('map').style.zIndex = '10000';" 

onmouseout="getElementById('map').style.zIndex = '-1';" 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-04-26T14:24:26.110

我创建了一个谷歌风格的下拉菜单并遇到了同样的问题......使用谷歌地图的 V3 api，您只需创建一个控件并将其放置在地图上：

```
map.controls[google.map.ControlPosition.TOP].push(control); 
```

因为它是一个下拉菜单，所以只要确保包含的 div 的 z-index 最高（z=3）然后包含菜单项的下拉部分低于包含的 div（z=0）。

这是一个[例子](http://vislab-ccom.unh.edu/~briana/examples/gdropdown/index.html "谷歌风格下拉 v3 API")。

根据我的经验，您唯一需要使用 shims 的就是插件（例如使用 Google Earth）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-08-13T02:32:37.397

我发现有时无意中忽略声明 !doctype 会在 IE 中导致这种打嗝，而其他浏览器似乎能够很好地协商页面。

# java - 如何正确访问静态成员类？

> ID：86607
> 
> 赞同：4
> 
> 时间：2008-09-17T19:20:06.277
> 
> 标签：java, static

我有两个类，并希望在另一个类中包含一个类的静态实例，并通过第一个类访问第二个类的静态字段。

这样我就可以拥有同名的不同实例。

```
Class A 
{
    public static package1.Foo foo;
}

Class B 
{
    public static package2.Foo foo;
}

//package1
Foo 
{
    public final static int bar = 1;
}

// package2
Foo
{
    public final static int bar = 2;
}

// usage
assertEquals(A.foo.bar, 1);
assertEquals(B.foo.bar, 2); 
```

这可行，但我收到警告“静态字段 Foo.bar 应该以静态方式访问”。有人可以解释为什么会这样并提供“正确”的实现。

我意识到我可以直接访问静态实例，但如果你有一个很长的包层次结构，那就很难看：

```
assertEquals(net.FooCorp.divisions.A.package.Foo.bar, 1);
assertEquals(net.FooCorp.divisions.B.package.Foo.bar, 2); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-17T19:21:29.987

你应该使用：

```
Foo.bar 
```

并不是：

```
A.foo.bar 
```

这就是警告的意思。

原因是*它*`bar`不是. 相反，是全局的，在类上。编译器希望您全局引用它，而不是假装它是实例的成员。*`Foo``bar``Foo`*

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-17T19:24:53.503

只要您只需要访问静态成员，将这两个静态变量放入类中是没有意义的。编译器希望您通过类名前缀访问它们，例如：

```
package1.Foo.bar
package2.Foo.bar 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-17T19:27:12.360

在以下位置创建对象后：

```
public static package1.Foo foo; 
```

它不是以静态方式访问的。您将不得不使用类名，当然还有完整的包名来寻址该类，因为它们在不同的包上具有相同的名称

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T22:06:55.003

我同意其他人的观点，即您可能以错误的方式考虑这一点。顺便说一句，如果您只访问静态成员，这可能对您有用：

```
public class A {
    public static class Foo extends package1.Foo {}
}
public class B {
    public static class Foo extends package2.Foo {}
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T19:27:31.983

确实，Foo 实例可以访问 Foo 的静态字段，但请考虑“静态”一词。至少在这种情况下，这意味着“静态绑定”。由于 A.foo 是 Foo 类型，“A.foo.bar”不会向对象询问“bar”，它会直接进入类。这意味着即使一个子类有一个名为“bar”的静态字段，并且 foo 是该子类的一个实例，它也会得到 Foo.bar，而不是 FooSubclass.bar。因此，通过类名来引用它是一个更好的主意，因为如果您尝试利用继承，您将自食其果。

# language-agnostic - 在 OOP 上下文中正确记录

> ID：86636
> 
> 赞同：8
> 
> 时间：2008-09-17T19:23:07.580
> 
> 标签：language-agnostic, oop, logging

自从我第一次开始学习面向对象编程以来，我一直在努力解决一个问题：应该如何在“正确的”OOP 代码中实现记录器？

我的意思是一个对象，它有一个我们希望代码中的每个其他对象都能够访问的方法；这个方法将输出到控制台/文件/任何东西，我们将使用它来记录——因此，这个对象将是记录器对象。

我们不想将 logger 对象建立为全局变量，因为全局变量不好，对吧？但是我们也不希望在每个对象中调用的每个方法的参数中都传递记录器对象。

在大学里，当我向教授提出这个问题时，他实际上无法给我答案。我意识到实际上有可能实现此功能的包（例如 Java）。不过，我最终要寻找的是如何正确地以 OOP 方式自己实现这一点的知识。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-17T19:26:13.390

您*确实*希望将记录器建立为全局变量，因为全局变量还*不错*。至少，它们本质上并不坏。记录器是正确使用全局可访问对象的一个​​很好的例子。如果您想了解更多信息，请阅读单例设计模式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-17T19:30:06.190

有一些经过深思熟虑的解决方案。有些涉及绕过OO并使用另一种机制（AOP）。

日志记录并不太适合 OO（这没关系，并非所有事情都如此）。如果你必须自己实现它，我建议只在每个类的顶部实例化“Log”：

私人最终日志=新日志（此）；

然后您的所有日志记录调用都是微不足道的： log.print("Hey");

这使得它比单例更容易使用。

让您的记录器找出您传入的类并使用它来注释日志。由于您有一个日志实例，因此您可以执行以下操作：

log.addTag("账单");

并且日志可以为每个条目添加标签账单，以便您可以为您的显示实施更好的过滤。

log4j 和电锯是一个完美的开箱即用的解决方案——如果你不只是学术，使用它们。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-26T22:58:06.563

全局可访问的记录器是测试的痛苦。如果您需要“集中式”日志记录工具，请在程序启动时创建它并将其注入需要日志记录的类/方法中。你如何测试使用这样的方法：

```
public class MyLogger 
{
    public static void Log(String Message) {}
} 
```

你如何用模拟代替它？

更好的：

```
public interface ILog 
{
    void Log(String message);
}

public class MyLog : ILog 
{
    public void Log(String message) {}
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-17T19:25:38.900

我一直使用单例模式来实现日志对象。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-17T19:24:47.343

你可以看看单例模式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-17T19:25:01.960

将记录器创建为单例类，然后使用静态方法访问它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-17T19:26:08.820

我认为您应该为此使用 AOP（面向方面​​的编程），而不是 OOP。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-17T19:26:19.773

在实践中，我认为单例/全局方法可以正常工作。最好全局事物只是一个框架，您可以将不同的侦听器（观察者模式）连接到该框架，例如一个用于控制台输出，一个用于数据库输出，一个用于 Windows EventLog 输出等。

不过要小心过度设计，我发现在实践中，只有全局方法的单个类可以很好地工作。

或者你可以使用你工作的特定框架提供的基础设施。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-17T19:28:59.593

来自 Microsoft 的 Pattern & Practices 组的[Enterprise Library Logging Application Block是在 OOP 环境中实现日志框架的一个很好的例子。](http://msdn.microsoft.com/en-us/library/cc309272.aspx)他们有一些关于他们如何实现日志应用程序块的很棒的文档，并且所有源代码都可供您自己查看或修改。

还有其他类似的实现：[log4net、log4j、log4cxx](http://logging.apache.org/)

他们实现企业库日志记录应用程序块的方式是拥有一个静态`Logger`类，其中包含许多实际执行日志操作的不同方法。如果您正在查看模式，这可能是单例模式的更好用途之一。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-17T19:33:30.940

我完全支持 AOP 和 log4*。这真的帮助了我们。例如，谷歌给了我[这篇文章](http://www.ibm.com/developerworks/rational/library/2782.html)。您可以尝试在该主题上进行更多搜索。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-17T19:34:03.577

（恕我直言）“日志记录”如何发生并不是您的解决方案设计的一部分，它更多的是您碰巧在其中运行的任何环境的一部分——比如 Java 中的系统和日历。

您的“好”解决方案是与任何特定日志记录实现尽可能松散耦合的解决方案，因此请考虑接口。我会在[此处](http://java.sun.com/j2se/1.4.2/docs/guide/util/logging/overview.html#1.0)查看有关 Sun 如何解决此问题的示例，因为他们可能提出了一个非常好的设计并将其全部列出以供您学习！

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-17T19:34:16.553

使用静态类，它的开销最小，并且可以从简单程序集引用中的所有项目类型访问

请注意，单例是等价的，但涉及不必要的分配

如果您使用多个应用程序域，请注意您可能需要一个代理对象才能从主域以外的域访问静态类

此外，如果您有多个线程，您可能需要锁定日志功能以避免交错输出

恕我直言，单独记录是不够的，这就是我写[CALM的原因](http://www.nov8r.com/calm.aspx)

祝你好运！

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-17T19:37:02.680

也许以透明的方式插入日志记录宁愿属于面向方面的编程习语。但我们在这里谈论的是面向对象设计......

在我看来，单例模式可能是最有用的：您可以通过 LoggingService 类的公共静态方法从任何上下文访问 Logging 服务。

尽管这看起来很像一个全局变量，但实际上并非如此：它被适当地封装在单例类中，并不是每个人都可以访问它。这使您即使在运行时也可以更改日志记录的处理方式，但可以保护日志记录的工作不受“vilain”代码的影响。

在我工作的系统中，我们创建了许多 Logging 'singleton'，以便能够区分来自不同子系统的消息。这些可以在运行时打开/关闭，可以定义过滤器，可以写入文件......你可以命名它。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-17T19:39:45.247

我过去通过将日志类的实例添加到需要访问日志的类的基类（或接口，如果语言支持的话）中解决了这个问题。当您记录某些内容时，记录器会查看当前调用堆栈并从中确定调用代码，设置有关记录语句的正确元数据（源方法、代码行（如果可用）、记录的类等）。类有记录器的数量，记录器不需要专门配置可以自动确定的元数据。

这*确实会*增加相当大的开销，因此它不一定是生产日志记录的明智选择，但是如果您以这种方式设计记录器，则可以有条件地禁用记录器的各个方面。

实际上，我大部分时间都使用公共日志记录（我在 java 中做了很多工作），但是我发现上面描述的设计的某些方面是有益的。拥有一个其他人已经花费大量时间调试的健壮日志系统的好处超过了对可以被认为是更清洁的设计的需求（这显然是主观的，特别是考虑到本文缺乏细节）。

我遇到了导致永久内存问题的静态记录器问题（至少，我*认为*这就是问题所在），所以我可能很快会重新访问记录器。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2010-04-09T07:32:47.080

另一种可能的解决方案是使用一个 Log 类来封装日志记录/存储过程。这样你就可以`new Log();`在需要的时候实例化 a 而不必使用单例。

这是我首选的解决方案，因为如果您通过数据库登录，您需要注入的唯一依赖项是数据库。如果您可能正在使用文件，则不需要注入任何依赖项。您还可以完全避免使用全局或静态日志记录类/函数。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2010-08-27T22:29:35.677

为了避免全局变量，我建议创建一个全局 REGISTRY 并在那里注册你的全局变量。

对于日志记录，我更喜欢提供一个单例类或提供一些静态方法进行日志记录的类。

实际上，我会使用现有的日志记录框架之一。

# ruby-on-rails - 如何在 Ruby on Rails 中“漂亮”地格式化 JSON 输出

> ID：86653
> 
> 赞同：715
> 
> 时间：2008-09-17T19:25:17.310
> 
> 标签：ruby-on-rails, ruby, json, pretty-print

我希望我在 Ruby on Rails 中的 JSON 输出“漂亮”或格式正确。

现在，我打电话`to_json`，我的 JSON 都在一条线上。有时这很难看出 JSON 输出流中是否存在问题。

有没有办法配置让我的 JSON “漂亮”或在 Rails 中格式正确？

* * *

## 回答 #1

> 赞同：1108
> 
> 时间：2009-12-01T03:50:35.753

使用`pretty_generate()`内置在更高版本 JSON 中的函数。例如：

```
require 'json'
my_object = { :array => [1, 2, 3, { :sample => "hash"} ], :foo => "bar" }
puts JSON.pretty_generate(my_object) 
```

这让你：

```
{
  "array": [
    1,
    2,
    3,
    {
      "sample": "hash"
    }
  ],
  "foo": "bar"
} 
```

* * *

## 回答 #2

> 赞同：97
> 
> 时间：2013-07-03T18:37:40.910

HTML 中的`<pre>`标签与 一起使用`JSON.pretty_generate`，将在您的视图中呈现漂亮的 JSON。当我杰出的老板给我看这个时，我很高兴：

```
<% if @data.present? %>
   <pre><%= JSON.pretty_generate(@data) %></pre>
<% end %> 
```

* * *

## 回答 #3

> 赞同：81
> 
> 时间：2012-10-23T11:19:27.187

感谢 Rack Middleware 和 Rails 3，您可以为每个请求输出漂亮的 JSON，而无需更改应用程序的任何控制器。我已经编写了这样的中间件片段，并且在浏览器和`curl`输出中得到了很好的打印 JSON。

```
class PrettyJsonResponse
  def initialize(app)
    @app = app
  end

  def call(env)
    status, headers, response = @app.call(env)
    if headers["Content-Type"] =~ /^application\/json/
      obj = JSON.parse(response.body)
      pretty_str = JSON.pretty_unparse(obj)
      response = [pretty_str]
      headers["Content-Length"] = pretty_str.bytesize.to_s
    end
    [status, headers, response]
  end
end 
```

上面的代码应该放在`app/middleware/pretty_json_response.rb`你的 Rails 项目中。最后一步是将中间件注册到`config/environments/development.rb`：

```
config.middleware.use PrettyJsonResponse 
```

**我不建议在`production.rb`**. JSON 解析可能会降低生产应用程序的响应时间和吞吐量。最终，可能会引入额外的逻辑，例如“X-Pretty-Json: true”标头，以按需触发手动 curl 请求的格式化。

（使用 Rails 3.2.8-5.0.0、Ruby 1.9.3-2.2.0、Linux 测试）

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2014-04-11T16:42:29.660

如果你想：

1.  自动美化来自您的应用程序的所有传出 JSON 响应。
2.  避免污染 Object#to_json/#as_json
3.  避免使用中间件解析/重新渲染 JSON (YUCK!)
4.  按照铁路的方式来做！

然后 ... 将 ActionController::Renderer 替换为 JSON！只需将以下代码添加到您的 ApplicationController：

```
ActionController::Renderers.add :json do |json, options|
  unless json.kind_of?(String)
    json = json.as_json(options) if json.respond_to?(:as_json)
    json = JSON.pretty_generate(json, options)
  end

  if options[:callback].present?
    self.content_type ||= Mime::JS
    "#{options[:callback]}(#{json})"
  else
    self.content_type ||= Mime::JSON
    json
  end
end 
```

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2016-06-29T19:01:03.413

看看[真棒打印](https://github.com/awesome-print/awesome_print)。将 JSON 字符串解析为 Ruby 哈希，然后显示`ap`如下：

```
require "awesome_print"
require "json"

json = '{"holy": ["nested", "json"], "batman!": {"a": 1, "b": 2}}'

ap(JSON.parse(json)) 
```

通过以上，您将看到：

```
{
  "holy" => [
    [0] "nested",
    [1] "json"
  ],
  "batman!" => {
    "a" => 1,
    "b" => 2
  }
} 
```

Awesome Print 还会添加一些 Stack Overflow 不会显示的颜色。

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2015-04-16T15:46:52.273

如果您发现`pretty_generate`Ruby 的 JSON 库中内置的选项不够“漂亮”，我建议您使用我自己的[NeatJSON](https://github.com/Phrogz/NeatJSON) gem 进行格式化。

要使用它：

```
gem install neatjson 
```

然后使用

```
JSON.neat_generate 
```

代替

```
JSON.pretty_generate 
```

像 Ruby 一样`pp`，它会在合适的时候将对象和数组保持在一行，但根据需要包装成多个。例如：

```
{
  "navigation.createroute.poi":[
    {"text":"Lay in a course to the Hilton","params":{"poi":"Hilton"}},
    {"text":"Take me to the airport","params":{"poi":"airport"}},
    {"text":"Let's go to IHOP","params":{"poi":"IHOP"}},
    {"text":"Show me how to get to The Med","params":{"poi":"The Med"}},
    {"text":"Create a route to Arby's","params":{"poi":"Arby's"}},
    {
      "text":"Go to the Hilton by the Airport",
      "params":{"poi":"Hilton","location":"Airport"}
    },
    {
      "text":"Take me to the Fry's in Fresno",
      "params":{"poi":"Fry's","location":"Fresno"}
    }
  ],
  "navigation.eta":[
    {"text":"When will we get there?"},
    {"text":"When will I arrive?"},
    {"text":"What time will I get to the destination?"},
    {"text":"What time will I reach the destination?"},
    {"text":"What time will it be when I arrive?"}
  ]
} 
```

它还支持各种[格式选项](https://github.com/Phrogz/NeatJSON#options)，以进一步自定义您的输出。例如，冒号前后有多少个空格？逗号之前/之后？在数组和对象的括号内？您想对对象的键进行排序吗？你想让冒号都排成一行吗？

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2014-04-04T13:31:48.063

将 ActiveRecord 对象转储为 JSON（在 Rails 控制台中）：

```
pp User.first.as_json

# => {
 "id" => 1,
 "first_name" => "Polar",
 "last_name" => "Bear"
} 
```

* * *

## 回答 #8

> 赞同：16
> 
> 时间：2016-08-03T01:50:54.837

使用`<pre>`HTML 代码，`pretty_generate`这是一个很好的技巧：

```
<%
  require 'json'

  hash = JSON[{hey: "test", num: [{one: 1, two: 2, threes: [{three: 3, tthree: 33}]}]}.to_json] 
%>

<pre>
  <%=  JSON.pretty_generate(hash) %>
</pre> 
```

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2014-10-21T16:37:34.797

这是一个中间件解决方案，[由@gertas 这个出色的答案](https://stackoverflow.com/a/13029297/238886)修改而来。这个解决方案不是 Rails 特定的——它应该适用于任何 Rack 应用程序。

这里使用的中间件技术，使用#each，在[ASCIIcasts 151: Rack Middleware](http://asciicasts.com/episodes/151-rack-middleware) by Eifion Bedford 中进行了解释。

此代码位于*app/middleware/pretty_json_response.rb 中*：

```
class PrettyJsonResponse

  def initialize(app)
    @app = app
  end

  def call(env)
    @status, @headers, @response = @app.call(env)
    [@status, @headers, self]
  end

  def each(&block)
    @response.each do |body|
      if @headers["Content-Type"] =~ /^application\/json/
        body = pretty_print(body)
      end
      block.call(body)
    end
  end

  private

  def pretty_print(json)
    obj = JSON.parse(json)  
    JSON.pretty_unparse(obj)
  end

end 
```

要打开它，请将其添加到 config/environments/test.rb 和 config/environments/development.rb：

```
config.middleware.use "PrettyJsonResponse" 
```

正如@gertas 在他的这个解决方案版本中警告的那样，避免在生产中使用它。它有点慢。

使用 Rails 4.1.6 测试。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2017-05-16T11:43:24.810

```
#At Controller
def branch
    @data = Model.all
    render json: JSON.pretty_generate(@data.as_json)
end 
```

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2016-02-17T00:26:30.647

如果您希望在 Rails 控制器操作中快速实现此功能以发送 JSON 响应：

```
def index
  my_json = '{ "key": "value" }'
  render json: JSON.pretty_generate( JSON.parse my_json )
end 
```

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2012-12-23T04:01:27.867

这是我在自己的搜索过程中从其他帖子中得出的解决方案。

这允许您根据需要将 pp 和 jj 输出发送到文件。

```
require "pp"
require "json"

class File
  def pp(*objs)
    objs.each {|obj|
      PP.pp(obj, self)
    }
    objs.size <= 1 ? objs.first : objs
  end
  def jj(*objs)
    objs.each {|obj|
      obj = JSON.parse(obj.to_json)
      self.puts JSON.pretty_generate(obj)
    }
    objs.size <= 1 ? objs.first : objs
  end
end

test_object = { :name => { first: "Christopher", last: "Mullins" }, :grades => [ "English" => "B+", "Algebra" => "A+" ] }

test_json_object = JSON.parse(test_object.to_json)

File.open("log/object_dump.txt", "w") do |file|
  file.pp(test_object)
end

File.open("log/json_dump.txt", "w") do |file|
  file.jj(test_json_object)
end 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2013-11-21T22:08:20.650

我使用了 gem CodeRay，它工作得很好。该格式包括颜色，它可以识别许多不同的格式。

我已经在一个可以用于调试 Rails API 的 gem 上使用它，它工作得很好。

顺便说一句，gem 被命名为 'api_explorer' ( [http://www.github.com/toptierlabs/api_explorer](http://www.github.com/toptierlabs/api_explorer) )

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2015-11-30T07:10:11.683

```
 # example of use:
a_hash = {user_info: {type: "query_service", e_mail: "my@email.com", phone: "+79876543322"}, cars_makers: ["bmw", "mitsubishi"], car_models: [bmw: {model: "1er", year_mfc: 2006}, mitsubishi: {model: "pajero", year_mfc: 1997}]}
pretty_html = a_hash.pretty_html

# include this module to your libs:
module MyPrettyPrint
    def pretty_html indent = 0
        result = ""
        if self.class == Hash
            self.each do |key, value|
                result += "#{key}

: #{[Array, Hash].include?(value.class) ? value.pretty_html(indent+1) : value} `"
            end
        elsif self.class == Array
            result = "[#{self.join(', ')}]"
        end
        "#{result}"
    end

end

class Hash
    include MyPrettyPrint
end

class Array
    include MyPrettyPrint
end` 

            回答 #15

赞同：3

时间：2019-05-23T09:42:08.253

漂亮的打印变体（**Rails**）：

```
my_obj = {
  'array' => [1, 2, 3, { "sample" => "hash"}, 44455, 677778, nil ],
  foo: "bar", rrr: {"pid": 63, "state with nil and \"nil\"": false},
  wwww: 'w' * 74
} 
```

```
require 'pp'
puts my_obj.as_json.pretty_inspect.
            gsub('=>', ': ').
            gsub(/"(?:[^"\\]|\\.)*"|\bnil\b/) {|m| m == 'nil' ? 'null' : m }.
            gsub(/\s+$/, "") 
```

结果：

```
{"array": [1, 2, 3, {"sample": "hash"}, 44455, 677778, null],
 "foo": "bar",
 "rrr": {"pid": 63, "state with nil and \"nil\"": false},
 "wwww":
  "wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww"} 
```

            回答 #16

赞同：2

时间：2015-09-04T18:03:30.563

如果您使用的是[RABL ，您可以按照](https://github.com/nesquena/rabl)[此处](https://github.com/nesquena/rabl/issues/301)所述配置它以使用 JSON.pretty_generate：

```
class PrettyJson
  def self.dump(object)
    JSON.pretty_generate(object, {:indent => "  "})
  end
end

Rabl.configure do |config|
  ...
  config.json_engine = PrettyJson if Rails.env.development?
  ...
end 
```

使用 JSON.pretty_generate 的一个问题是 JSON 模式验证器将不再对您的日期时间字符串感到满意。您可以使用以下方法修复 config/initializers/rabl_config.rb 中的那些：

```
ActiveSupport::TimeWithZone.class_eval do
  alias_method :orig_to_s, :to_s
  def to_s(format = :default)
    format == :default ? iso8601 : orig_to_s(format)
  end
end 
```

            回答 #17

赞同：2

时间：2019-10-23T21:06:44.980

最简单的例子，我能想到：

```
my_json = '{ "name":"John", "age":30, "car":null }'
puts JSON.pretty_generate(JSON.parse(my_json)) 
```

Rails 控制台示例：

```
core dev 1555:0> my_json = '{ "name":"John", "age":30, "car":null }'
=> "{ \"name\":\"John\", \"age\":30, \"car\":null }"
core dev 1556:0> puts JSON.pretty_generate(JSON.parse(my_json))
{
  "name": "John",
  "age": 30,
  "car": null
}
=> nil 
```

            回答 #18

赞同：2

时间：2021-12-01T15:41:09.680

如果要处理 active_record 对象，`puts`就足够了。
例如：

*   没有`puts`

```
2.6.0 (main):0 > User.first.to_json
  User Load (0.4ms)  SELECT  "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1  [["LIMIT", 1]]
=> "{\"id\":1,\"admin\":true,\"email\":\"admin@gmail.com\",\"password_digest\":\"$2a$10$TQy3P7NT8KrdCzliNUsZzuhmo40LGKoth2hwD3OI.kD0lYiIEwB1y\",\"created_at\":\"2021-07-20T08:34:19.350Z\",\"updated_at\":\"2021-07-20T08:34:19.350Z\",\"name\":\"Arden Stark\"}" 
```

*   和`puts`

```
2.6.0 (main):0 > puts User.first.to_json
  User Load (0.3ms)  SELECT  "users".* FROM "users" ORDER BY "users"."id" ASC LIMIT $1  [["LIMIT", 1]]
{"id":1,"admin":true,"email":"admin@gmail.com","password_digest":"$2a$10$TQy3P7NT8KrdCzliNUsZzuhmo40LGKoth2hwD3OI.kD0lYiIEwB1y","created_at":"2021-07-20T08:34:19.350Z","updated_at":"2021-07-20T08:34:19.350Z","name":"Arden Stark"}
=> nil 
```

如果您要处理 json 数据，[JSON.pretty_generate](https://devdocs.io/ruby%7E3/json#method-i-pretty_generate)是一个不错的选择
例子：

```
obj = {foo: [:bar, :baz], bat: {bam: 0, bad: 1}}
json = JSON.pretty_generate(obj)
puts json 
```

输出：

```
{
  "foo": [
    "bar",
    "baz"
  ],
  "bat": {
    "bam": 0,
    "bad": 1
  }
} 
```

如果它在 ROR 项目中，我总是更喜欢使用 gem`pry-rails`来格式化我的代码，`rails console`而不是`awesome_print`太冗长。
示例`pry-rails`：
[![在此处输入图像描述](https://i.stack.imgur.com/qrDLG.png)](https://i.stack.imgur.com/qrDLG.png)
它也有语法高亮。

            回答 #19

赞同：1

时间：2014-04-01T04:05:39.763

我使用以下内容，因为我发现标题、状态和 JSON 输出作为一个集合很有用。调用例程是根据 railscasts 演示文稿中的推荐进行的，网址为：[http ://railscasts.com/episodes/151-rack-middleware?autoplay=true](http://railscasts.com/episodes/151-rack-middleware?autoplay=true)

```
 class LogJson

  def initialize(app)
    @app = app
  end

  def call(env)
    dup._call(env)
  end

  def _call(env)
    @status, @headers, @response = @app.call(env)
    [@status, @headers, self]
  end

  def each(&block)
    if @headers["Content-Type"] =~ /^application\/json/
      obj = JSON.parse(@response.body)
      pretty_str = JSON.pretty_unparse(obj)
      @headers["Content-Length"] = Rack::Utils.bytesize(pretty_str).to_s
      Rails.logger.info ("HTTP Headers:  #{ @headers } ")
      Rails.logger.info ("HTTP Status:  #{ @status } ")
      Rails.logger.info ("JSON Response:  #{ pretty_str} ")
    end

    @response.each(&block)
  end
  end 
```

        language-agnostic - 单例有什么问题？

ID：86654

赞同：-3

时间：2008-09-17T19:25:28.853

标签：language-agnostic, design-patterns, oop, singleton

不要在这个问题上浪费你的时间。跟进：[单身人士有什么不好？](https://stackoverflow.com/questions/137975/what-is-so-bad-about-singletons)

~~请随意在[Singleton](http://en.wikipedia.org/wiki/Singleton_pattern)上抱怨。~~

[单例](http://en.wikipedia.org/wiki/Singleton_pattern)使用不当可能会导致大量油漆。你在使用单例时遇到过什么样的问题？这种模式的常见误用是什么？

在深入研究 Corey 的回答后，我发现了一些关于这个主题的精彩文章。

*   [为什么单身人士有争议](http://code.google.com/p/google-singleton-detector/wiki/WhySingletonsAreControversial)
*   [高性能单例](http://scientificninja.com/advice/performant-singletons)
*   [单身人士是病态的骗子](http://googletesting.blogspot.com/2008/08/by-miko-hevery-so-you-join-new-project.html)
*   [所有单身人士都去哪儿了？](http://googletesting.blogspot.com/2008/08/where-have-all-singletons-gone.html)
*   [单身人士的根本原因](http://googletesting.blogspot.com/2008/08/root-cause-of-singletons.html)

            回答 #1

赞同：3

时间：2008-09-17T19:26:36.760

单例模式本质上没有任何问题。它是一种工具，有时应该使用它。

            回答 #2

赞同：3

时间：2008-09-17T19:31:52.130

有时它可以使您的代码更紧密地与从代码库的不同部分直接按名称引用的单例类耦合。因此，例如，当您需要测试代码的某些部分并且它从代码的不同部分引用单例时，您不能轻易地用模拟对象伪造该依赖项。  

            回答 #3

赞同：1

时间：2008-09-17T20:15:53.677

我没有像其他一些海报那样接触过 Singleton，但我见过的几乎所有实现（在 C# 中）都可以通过静态类/方法实现。我想您可能会争辩说静态类是单例模式的实现，但这不是我所看到的。当人们真正需要的是使用 static 关键字时，我一直看到人们构建和管理这些 Singleton 类/对象。

所以，我不会说单例模式不好。我会说这有点像枪。我不认为枪支不好，但它们肯定会被不当使用。

            回答 #4

赞同：1

时间：2008-09-17T19:27:15.650

我认为一个更合适的问题可能是：在什么情况下使用单例模式不合适？或者你看到了什么使用了不应该使用的单例。

            回答 #5

赞同：1

时间：2008-09-17T19:32:22.830

单例本身并没有什么问题，作为一种模式，它在认识到某些对象只需要一次创建的需要方面起着至关重要的作用。

它经常被用来委婉地使用全局变量，试图绕过全局变量的污名，而这种用法本质上是错误的。如果全局变量恰好是正确的解决方案，则使用单例不会改善它。如果使用全局变量是不正确的（这是相当普遍的），那么将它包装在一个单例中不会使其更正确。

            回答 #6

赞同：0

时间：2008-09-17T19:31:11.990

基本上单例是一种拥有静态数据并假装它不是真正静态的方法。

我当然使用它，但尽量不要滥用它。

            回答 #7

赞同：0

时间：2008-09-17T19:31:40.023

原始 GoF 设计的一个基本问题是析构函数没有受到保护。任何引用单例实例的人都可以自由地销毁单例。

[请参阅 John Vlissides 在他的书“模式孵化”（亚马逊链接](https://rads.stackoverflow.com/amzn/click/com/0201432935)）中更新“杀死一个单身人士” 。

干杯，

抢

            回答 #8

赞同：-1

时间：2008-09-17T19:28:14.167

我看到的大多数单例模式都不是以线程安全的方式编写的。如果写得正确，它们会很有用。

        c# - Inproc 和 stateserver 会话变量的不同 GetHashCode 值

ID：86660

赞同：0

时间：2008-09-17T19:25:51.600

标签：c#, asp.net, session

我最近继承了一个大量使用会话的应用程序，包括在会话中存储大量自定义数据对象。我使用此应用程序的第一个业务点是至少将会话数据从 InProc 移开，并将其卸载到状态服务器或 SQL Server。

在我使所有适当的数据对象可序列化，并将 web.config 更改为使用状态服务之后，一切似乎都工作正常。

但是，我发现这个应用程序使用 GetHashCode() 进行了很多对象比较。当会话是 InProc 时运行良好的方法不再起作用，因为 HashCode 在它们应该匹配时不再匹配。当您知道子对象的原始哈希码时尝试从父对象中查找特定子对象时，似乎就是这种情况

如果我只是将 web.config 改回使用 inproc，它会再次起作用。

有人对从哪里开始有任何想法吗？

编辑：

qbeuek：感谢您的快速回复。关于：

Object 类中 GetHashCode 的默认实现根据内存中的对象地址或类似的东西返回一个哈希值。如果需要进行其他身份比较，则必须同时覆盖 Equals 和 GetHashCode。

我应该提供更多关于他们如何使用它的信息。基本上，它们有一个父数据对象，并且有多个子对象数组。他们碰巧知道他们需要的特定对象的哈希码，因此他们循环通过特定的子对象数组来寻找匹配的哈希码。一旦找到匹配项，他们就会将该对象用于其他工作。

            回答 #1

赞同：2

时间：2008-09-17T19:46:06.777

当你写

使用 GetHashCode() 进行大量对象比较

我觉得这段代码有一些可怕的问题。GetHashCode 方法不保证返回的哈希值在给定两个不同对象的情况下应该是唯一的。就 GetHashCode 而言，它可以为所有对象返回 0 并且仍然被认为是正确的。

当两个对象相同时（Equals 方法返回 true），它们**必须**具有从 GetHashCode 返回的相同值。当两个对象具有相同的哈希值时，它们**可以**是相同的对象（Equals 返回 true），也可以是不同的对象（Equals 返回 false）。

GetHashCode 的结果没有其他保证。

Object 类中 GetHashCode 的默认实现根据内存中的对象地址或类似的东西返回一个哈希值。如果需要进行其他身份比较，则必须**同时**覆盖 Equals 和 GetHashCode。

            回答 #2

赞同：1

时间：2008-09-17T19:38:37.730

覆盖调用此方法的类中的 GetHashCode 方法，并根据唯一的对象属性（如 ID 或所有对象字段）计算哈希码。

            回答 #3

赞同：1

时间：2008-09-17T20:32:12.187

解决方案 1：为所有子对象创建一个唯一 ID，并使用它代替哈希码。

解决方案 2：将 if (a.GetHashCode() == b.GetHashCode()) 替换为 if (a.Equals(b))。

        algorithm - Shutting Yard 算法的反演是什么？

ID：86669

赞同：12

时间：2008-09-17T19:26:23.610

标签：algorithm, parsing

Dijkstra 的[Shutting Yard 算法](http://en.wikipedia.org/wiki/Shunting_yard_algorithm "维基百科：调车场算法")用于解析中缀符号并生成[RPN](http://en.wikipedia.org/wiki/Reverse_Polish_notation "维基百科：逆波兰表示法")输出。

我正在寻找相反的方法，一种将 RPN 转换为高中数学风格的中缀表示法的方法，以便从数据库中表示 RPN 表达式，以便以易于理解的方式为普通用户提供服务。

请节省您的时间，不要自己编写算法，只需向我指出我似乎找不到的教科书示例。从Shunting Yard 算法向后工作，并利用我对符号的了解，我可能能够找到一个解决方案。我只是在寻找一个快速的捷径，所以我不必重新发明轮子。

哦，请不要将其标记为“作业”，我*发誓*我已经离开学校了！;-)

            回答 #1

赞同：7

时间：2008-09-17T19:52:50.457

由于 RPN 也称为后缀表示法，我尝试使用谷歌搜索[“后缀到中缀”](http://www.google.com/search?hl=en&q=convert+%22postfix+to+infix%22&btnG=Search)并得到了很多结果。前几个有代码示例，但我发现[RubyQuiz 条目](http://www.rubyquiz.com/quiz148.html)特别有启发性。

            回答 #2

赞同：6

时间：2008-09-17T19:59:53.217

如果您不担心删除多余的括号，那么下面的 Lisp 代码将起作用：

```
(defun rpn-to-inf (pre)
  (if (atom pre)
      pre
      (cond ((eq (car (last pre)) 'setf)
         (list (rpn-to-inf (first pre)) '= (rpn-to-inf (second pre))))
        ((eq (car (last pre)) 'expt)
         (list (rpn-to-inf (first pre)) '^ (rpn-to-inf (second pre))))
        (t (list (rpn-to-inf (first pre)) 
             (car (last pre)) 
             (rpn-to-inf (second pre))))))) 
```

        oracle - 控制文件中的时间戳

ID：86684

赞同：0

时间：2008-09-17T19:27:33.000

标签：oracle, sql-loader, controlfile

我有一个脚本，它采用表名并通过查询表的所有列/行来生成控制文件。这适用于数字和字符数据，但在时间戳数据上失败，因此我需要调整脚本以将时间戳数据输出到控件中，以便可以正确读取它。

所以本质上，我的问题是如何在控制文件中格式化 TimeStamp 数据，以便可以将其输入到 TimeStamp 列中。

            回答 #1

赞同：0

时间：2008-09-17T19:55:27.003

您需要`to_date`在列列表中使用，如此[处所示](http://www.orafaq.com/wiki/SQL%2ALoader_FAQ#Can_one_modify_data_as_the_database_gets_loaded.3F)。就像是：

```
 LOAD DATA
INFILE *
INTO TABLE some_table
FIELDS TERMINATED BY ","
(  col1
   col2        "to_date(:col2, 'YYYY-MM-DD HH24:MI:SS')"
)
BEGINDATA
foo,2008-09-17 13:00:00
bar,2008-09-17 13:30:05 

```

        linq - 调试 LINQ to SQL SubmitChanges()

ID：86685

赞同：21

时间：2008-09-17T19:27:36.820

标签：linq, linq-to-sql, debugging

我很难尝试调试 LINQ to SQL 并提交更改。

我一直在使用[http://weblogs.asp.net/scottgu/archive/2007/07/31/linq-to-sql-debug-visualizer.aspx](http://weblogs.asp.net/scottgu/archive/2007/07/31/linq-to-sql-debug-visualizer.aspx)，它非常适合调试简单的查询。

我正在使用我的应用程序中的以下代码段在我的项目的 DataContext 类中工作：

```
JobMaster newJobToCreate = new JobMaster();
newJobToCreate.JobID = 9999
newJobToCreate.ProjectID = "New Project";
this.UpdateJobMaster(newJobToCreate);
this.SubmitChanges(); 
```

当我运行 this.SubmitChanges 时，我会发现一些非常奇怪的异常；

```
Index was outside the bounds of the array. 
```

堆栈跟踪去了我无法进入的地方：

```
at System.Data.Linq.IdentityManager.StandardIdentityManager.MultiKeyManager`3.TryCreateKeyFromValues(Object[] values, MultiKey`2& k)
   at System.Data.Linq.IdentityManager.StandardIdentityManager.IdentityCache`2.Find(Object[] keyValues)
   at System.Data.Linq.IdentityManager.StandardIdentityManager.Find(MetaType type, Object[] keyValues)
   at System.Data.Linq.CommonDataServices.GetCachedObject(MetaType type, Object[] keyValues)
   at System.Data.Linq.ChangeProcessor.GetOtherItem(MetaAssociation assoc, Object instance)
   at System.Data.Linq.ChangeProcessor.BuildEdgeMaps()
   at System.Data.Linq.ChangeProcessor.SubmitChanges(ConflictMode failureMode)
   at System.Data.Linq.DataContext.SubmitChanges(ConflictMode failureMode)
   at System.Data.Linq.DataContext.SubmitChanges()
   at JobTrakDataContext.CreateNewJob(NewJob job, String userName) in D:\JobTrakDataContext.cs:line 1119 
```

有没有人有他们使用的任何工具或技术？我错过了一些简单的东西吗？

**编辑**：我已经使用 Slace 的建议设置了 .net 调试，但是 .net 3.5 代码尚不可用：[http ://referencesource.microsoft.com/netframework.aspx](http://referencesource.microsoft.com/netframework.aspx)

**EDIT2**：我已根据 Sirrocco 的建议更改为 InsertOnSubmit，但仍然出现相同的错误。

**EDIT3：**
我已经实现了 Sam 的建议，试图记录生成的 SQL 并捕获 ChangeExceptoinException。这些建议不再阐明，当我的异常被抛出时，我实际上永远不会生成 SQL。

**EDIT4：**
我在下面找到了一个适合我的答案。它只是一个理论，但它解决了我当前的问题。

            回答 #1

赞同：32

时间：2009-04-01T20:59:51.850

我总是发现确切知道在 SubmitChanges() 方法中将哪些更改发送到 DataContext 很有用。

我使用[DataContext.GetChangeSet()](http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.getchangeset.aspx)方法，它返回一个[ChangeSet](http://msdn.microsoft.com/en-us/library/system.data.linq.changeset.aspx)对象实例，其中包含 3 个已添加、修改或删除的只读 IList 对象。

您可以在 SubmitChanges 方法调用之前放置一个断点，并添加一个 Watch（或 Quick Watch），其中包含：

```
ctx.GetChangeSet(); 
```

其中 ctx 是您的 DataContext 的当前实例，然后您将能够跟踪将在 SubmitChanges 调用上生效的所有更改。

            回答 #2

赞同：8

时间：2008-09-19T18:27:27.640

首先感谢大家的帮助，终于找到了。

解决方案是从项目中删除 .dbml 文件，添加一个空白 .dbml 文件，然后使用“服务器资源管理器”中我的项目所需的表重新填充它。

在执行此操作时，我注意到了几件事：

*   系统中有几张表以两个单词和单词之间的空格命名，即“Job Master”。当我将该表拉回 .dbml 文件时，它会创建一个名为“Job_Master”的表，它将用下划线替换空格。
*   在原始的 .dbml 文件中，我的一位开发人员浏览了 .dbml 文件并删除了所有下划线，因此 .dbml 文件中的“Job_Master”将变为“JobMaster”。在代码中，我们可以使用更标准的命名约定来引用该表。
*   我的理论是，在某个地方，从 'JobMaster' 到 'Job Master' 的翻译在进行投影时丢失了，我一直在想出数组越界错误。

这只是一个理论。如果有人能更好地解释它，我很想在这里有一个具体的答案。

            回答 #3

赞同：6

时间：2008-09-18T10:35:32.503

我的第一个调试操作是查看生成的 SQL：

```
JobMaster newJobToCreate = new JobMaster();
newJobToCreate.JobID = 9999
newJobToCreate.ProjectID = "New Project";
this.UpdateJobMaster(newJobToCreate);
this.Log = Console.Out; // prints the SQL to the debug console
this.SubmitChanges(); 
```

第二个是捕获 ChangeConflictException 并查看失败的详细信息。

```
 catch (ChangeConflictException e)
  {
    Console.WriteLine("Optimistic concurrency error.");
    Console.WriteLine(e.Message);
    Console.ReadLine();
    foreach (ObjectChangeConflict occ in db.ChangeConflicts)
    {
      MetaTable metatable = db.Mapping.GetTable(occ.Object.GetType());
      Customer entityInConflict = (Customer)occ.Object;
      Console.WriteLine("Table name: {0}", metatable.TableName);
      Console.Write("Customer ID: ");
      Console.WriteLine(entityInConflict.CustomerID);
      foreach (MemberChangeConflict mcc in occ.MemberConflicts)
      {
        object currVal = mcc.CurrentValue;
        object origVal = mcc.OriginalValue;
        object databaseVal = mcc.DatabaseValue;
        MemberInfo mi = mcc.Member;
        Console.WriteLine("Member: {0}", mi.Name);
        Console.WriteLine("current value: {0}", currVal);
        Console.WriteLine("original value: {0}", origVal);
        Console.WriteLine("database value: {0}", databaseVal);
      }
    }
  } 
```

            回答 #4

赞同：4

时间：2008-09-18T04:30:34.800

您可以为您的 DataContext 创建一个部分类，并使用 Created 或您拥有的部分方法将日志设置到包含在 #if DEBUG 中的 console.out。这将帮助您查看在调试任何实例时执行的查询您正在使用的数据上下文。

在调试 LINQ to SQL 异常时，我发现这很有用..

```
partial void OnCreated()
{
#if DEBUG
      this.Log = Console.Out;
#endif
} 
```

            回答 #5

赞同：2

时间：2008-09-18T03:28:46.150

您上面提到的错误通常是由***指向错误方向的关联***引起的。当手动向设计器添加关联时，这很容易发生，因为与数据建模工具相比，L2S 设计器中的关联箭头指向后方。

如果他们抛出一个更具描述性的异常，那就太好了，也许他们会在未来的版本中。（达米安/马特……？）

            回答 #6

赞同：2

时间：2012-07-17T19:46:09.693

这就是我所做的

```
...
var builder = new StringBuilder();
try
{
    context.Log = new StringWriter(builder);
    context.MY_TABLE.InsertAllOnSubmit(someData);
    context.SubmitChanges();                
}
finally
{
    Log.InfoFormat("Some meaningful message here... ={0}", builder);
} 
```

            回答 #7

赞同：1

时间：2008-09-17T19:29:24.053

一个简单的解决方案可能是在您的数据库上运行跟踪并检查针对它运行的查询 - 过滤当然以整理其他应用程序等访问数据库。

这当然只有在你克服异常时才有帮助......

            回答 #8

赞同：1

时间：2008-09-17T22:47:52.550

VS 2008 能够通过 .NET 框架进行调试（[http://blogs.msdn.com/sburke/archive/2008/01/16/configuring-visual-studio-to-debug-net-framework-source-code .aspx](http://blogs.msdn.com/sburke/archive/2008/01/16/configuring-visual-studio-to-debug-net-framework-source-code.aspx) )

这可能是您最好的选择，您可以看到正在发生的事情以及所有属性在确切时间点的情况

            回答 #9

赞同：1

时间：2008-09-18T04:26:08.943

为什么要在新实例上执行 UpdateJobMaster ？不应该是 InsertOnSubmit 吗？

```
JobMaster newJobToCreate = new JobMaster();
newJobToCreate.JobID = 9999
newJobToCreate.ProjectID = "New Project";
this.InsertOnSubmit(newJobToCreate);
this.SubmitChanges(); 
```

            回答 #10

赞同：1

时间：2009-08-04T18:01:10.307

这几乎肯定不会是每个人的根本原​​因，但我在我的项目中遇到了完全相同的异常 - 并发现根本原因是在构建实体类期间引发了异常。奇怪的是，真正的异常是“丢失”，而是表现为 ArgumentOutOfRange 异常，该异常源自检索对象的 Linq 语句的迭代器。

如果您收到此错误并且您在 POCO 上引入了 OnCreated 或 OnLoaded 方法，请尝试逐步执行这些方法。

            回答 #11

赞同：0

时间：2008-09-17T19:49:43.867

人力资源管理系统。

以 WAG（Wild Ass Guess）为例，在我看来，它就像 LINQ - SQL 试图以某种方式基于 JobMaster 类的创建来查找 ID 不存在的对象。是否存在与该表相关的外键，这样 LINQ to SQL 会尝试获取可能不存在的类的实例？您似乎将新对象的 ProjectID 设置为字符串 - 您真的有一个字符串的 id 吗？如果您尝试将其设置为新项目，则需要创建一个新项目并获取其 ID。

最后，UpdateJobMaster 是做什么的？它可以做一些上面适用的事情吗？

            回答 #12

赞同：0

时间：2008-10-10T17:07:09.953

我们实际上已经停止在我们的大型项目中使用 Linq to SQL 设计器，这个问题是主要原因之一。我们还更改了许多名称、数据类型和关系的默认值，而设计师有时会丢失这些更改。我从来没有找到确切的原因，也无法可靠地重现它。

这与其他限制一起导致我们放弃设计器并手动设计类。当我们习惯了这些模式之后，它实际上比使用设计器更容易。

            回答 #13

赞同：0

时间：2008-10-10T19:38:24.533

我今天早些时候在这里发布了一个类似的问题：[Strange LINQ Exception (Index out of bounds)](https://stackoverflow.com/questions/191690/strange-linq-exception-index-out-of-bounds)。

这是一个不同的用例——这个错误发生在 SubmitChanges() 期间，我的错误发生在一个简单的查询期间，但它也是一个索引超出范围错误。  

在这个问题中交叉发布，以防问题中的数据组合有助于一个好的撒玛利亚人回答:)

            回答 #14

赞同：0

时间：2009-02-10T10:15:29.853

检查 dbml 中的所有“主键”列是否确实与数据库表上的主键相关。我刚刚遇到一种情况，设计人员决定在 dbml 中添加一个额外的 PK 列，这意味着 LINQ to SQL 在保存时无法找到外键的两侧。

            回答 #15

赞同：0

时间：2009-03-20T08:42:54.120

我最近遇到了同样的问题：我所做的是

```
Proce proces = unit.Proces.Single(u => u.ProcesTypeId == (from pt in context.ProcesTypes
                                                                         where pt.Name == "Fix-O"
                                                                         select pt).Single().ProcesTypeId &&
                                                                      u.UnitId == UnitId); 
```

代替：

```
Proce proces = context.Proces.Single(u => u.ProcesTypeId == (from pt in context.ProcesTypes
                                                                     where pt.Name == "Fix-O"
                                                                     select pt).Single().ProcesTypeId &&
                                                                  u.UnitId == UnitId); 
```

其中 context 显然是 DataContext 对象，而“单元”是 Unit 对象的一个​​实例，它是 dbml 文件中的一个数据类。

接下来，我使用“proce”对象在另一个 Data Class 对象的实例中设置属性。可能 LINQ 引擎无法检查我从“proce”对象设置的属性是否在 INSERT 命令中被允许，该命令必须由 LINQ 创建以将其他数据类对象添加到数据库。

            回答 #16

赞同：0

时间：2009-04-15T08:03:35.527

我有同样的非口语错误。

我与表的列有外键关系，它不是表的主键，而是唯一的列。当我将唯一列更改为表的主键时，问题就消失了。

希望这对任何人都有帮助！

            回答 #17

赞同：0

时间：2009-06-05T01:22:57.417

[在对 SO# 237415](https://stackoverflow.com/questions/237415/linq-to-sql/947926#947926)的回答中发布了我对此异常的体验

            回答 #18

赞同：0

时间：2016-07-22T12:07:26.977

我在尝试调试我的 LINQ ChangeConflictException 时遇到了这个问题。最后我意识到问题是我手动向我的 DBML 文件中的表添加了一个属性，但是我忘记设置属性，如**Nullable**（在我的情况下应该是真的）和**服务器数据类型**

希望这可以帮助某人。

            回答 #19

赞同：0

时间：2018-11-20T23:13:48.837

这是很久以前的事了，但我遇到了同样的问题，错误是因为带有 select 语句的触发器。就像是

```
CREATE TRIGGER NAME ON TABLE1 AFTER UPDATE AS SELECT table1.key from table1 
inner join inserted on table1.key = inserted.key 
```

当 linq-to-sql 运行更新命令时，它还会运行一个 select 语句来接收同一查询中自动生成的值，并期望第一条记录集包含“要求”的列，但在这种情况下，第一行是触发器中的 select 语句中的列。所以 linq-to-sql 期待两个自动生成的列，但它只收到一列（数据错误），这导致了这个异常。

        c# - 动态 PDF 或 Word 文档生成的最佳库？

ID：86696

赞同：5

时间：2008-09-17T19:28:30.843

标签：c#, .net, asp.net, pdf, ms-word

我们的 ASP.NET 应用程序必须能够将 Web 内容导出为 PDF 和 Word 文档。

过去，我们使用[Aspose 的](http://www.aspose.com/)库来完成此任务，但我们发现它们在文档构建方面有点太低级了。例如，我们发现自己需要使用形状基元编写基于点的函数来创建项目符号列表。

最好的情况——我们将一个工具指向我们可打印的 css 样式页面，并自动获取包含以相同方式样式的相同内容的 PDF 或 Word 文档。

您是否有使用任何可以完成此任务的工具的良好体验？

            回答 #1

赞同：6

时间：2008-09-18T12:25:38.823

[ITextSharp](http://itextsharp.sourceforge.net/tutorial/index.html)是一个非常简单的 PDF 工具，可与 .Net 一起使用（它是 iText java 项目的一个端口）。免费、开源和相当高的水平，所以这是要点的代码：

```
List overview = new List(false, 10); //false =unordered, true= numbered
overview.Add(new ListItem("This is an item"));
overview.Add("This is another item"); 
```

虽然不做Microsoft Word。

            回答 #2

赞同：1

时间：2008-09-17T19:31:52.940

对于动态 PDF 生成，我们使用了 TallPDF ......效果很好......

            回答 #3

赞同：1

时间：2008-09-18T13:25:52.517

我们倾向于[使用 PrinceXML](http://www.princexml.com/)来创建 PDF 文档，这似乎非常符合我们将 XHTML/CSS 推送到 PDF 中而不需要额外的文档构造的愿望。

            回答 #4

赞同：1

时间：2012-07-19T15:50:47.357

这是我为生成基于模板的报告而编写的一个 .net 库。它很容易生成 RTF 文档。我想您必须将它与另一个库集成以生成 PDF 文档。

在 ntemplates.codeplex.com 上查看 NTemplates

            回答 #5

赞同：0

时间：2008-09-17T19:30:24.723

我不相信他们会自动完成，但我对 SyncFusions 工具集很幸运。

            回答 #6

赞同：0

时间：2008-09-17T19:37:41.257

查看[pdfFactory 开发工具包](http://www.fineprint.com/developers/index.html)。

我自己没有使用过，但来自同一个人的[FinePrint](http://www.fineprint.com/products/fineprint/index.html)工具是 Windows 的最佳工具之一（不再使用 Windows 或 FinePrint）。

            回答 #7

赞同：0

时间：2008-10-06T09:30:47.223

对于生成 Word 文件，我会考虑使用新的 OpenXML 格式。微软为它提供了很好的支持，而且应该相当容易使用。
[样本文章](http://msdn.microsoft.com/en-us/library/bb656295.aspx)

            回答 #8

赞同：0

时间：2009-02-25T07:22:38.797

我们为此使用[www.alt-soft.com Xml2PDF](http://www.alt-soft.com)

        asp.net - 会员群发邮件软件

ID：86697

赞同：2

时间：2008-09-17T19:28:39.610

标签：asp.net

我们有一个 Microsoft 网络堆栈网站，我们有一个成员数据库。

我们想开始向我们的（选择加入的）会员发送群发电子邮件。

我并不*特别*想用一个系统来重新发明轮子，以便提交一个 Web 表单，然后大量发送循环通过数千条记录的电子邮件，而不会超时和超载服务器......

我想我正在寻找像 Mailman 这样的东西，它可以在 Windows（ASP/ASP.NET + SQL Server）后端运行并为我完成工作，并使用合适的 API 来管理订阅者列表并将电子邮件发送到该列表。

请问有什么建议吗？

            回答 #1

赞同：2

时间：2008-10-09T19:08:27.397

我同意 acrosman 的观点，托管电子邮件列表的第三方是一个不错的选择。我发现的一个非常可靠的群发电子邮件网站是[http://mailing-list-services.com/](http://mailing-list-services.com/)。他们做得很好，以确保他们的服务器永远不会被列入黑名单或被标记为垃圾邮件。我用过他们几次，他们的网站设计很糟糕，但他们的服务很棒。他们使用的 Lyris Listmanager 软件具有相当广泛的 API。

            回答 #2

赞同：1

时间：2008-09-17T19:30:37.047

[Advanced Intellect](http://www.advancedintellect.com/productlist.aspx)有一些很棒的工具，比如 aspNetEmail 和 ListNanny。

            回答 #3

赞同：0

时间：2008-10-09T19:00:40.673

除非您经营一家专门从事电子邮件业务的企业，否则我建议您找到一个托管解决方案。随着时间的推移，当您运行自己的服务时，会出现数百个小问题。托管解决方案可以为您节省大量时间和精力（从而节省金钱）。

            回答 #4

赞同：0

时间：2008-09-17T19:33:36.807

（不是推销）
[我的公司](http://www.acsysinteractive.com)提供[邮件管理器](http://www.acsysinteractive.com/product/default.aspx)，但它是一项托管服务。虽然它有一个完整的 API。

            回答 #5

赞同：0

时间：2008-09-17T19:35:49.093

您还可以查看[DotNetNuke](http://www.dotnetnuke.com/)是如何做到这一点的

            回答 #6

赞同：0

时间：2010-07-01T10:01:48.110

MaxBulkMailer 可能是您的解决方案？我工作的组织使用它连接到 www.authsmtp.com，这为我们每月可以发送的一定数量的电子邮件提供积分。您可以导入邮件列表的电子表格或直接点击 SQL 服务器并提取姓名和地址。适用于 Mac 和 Windows。

        .net - CE 5.0 Compact Framework .NET 上的 DataGrid 是否支持编辑？

ID：86710

赞同：3

时间：2008-09-17T19:29:48.423

标签：.net, compact-framework, windows-ce

我正在尝试在 CE 5.0 / .NET CF 2.0 下获得用户可以编辑的 DataGrid。[http://msdn.microsoft.com/en-us/library/ms838165.aspx](http://msdn.microsoft.com/en-us/library/ms838165.aspx)上的文档表明某些环境不支持编辑 -

由于DataGrid控件没有原生支持编辑，需要手动实现

我是否需要实现这个丑陋的例子 - 如图所示，它不能很好地工作？

该文档不清楚哪些 .NET 功能在哪个平台上可用。

            回答 #1

赞同：2

时间：2008-09-17T21:19:56.193

不，它不能直接编辑。MSDN 提供了使用 DataGrid 的示例，包括针对[Pocket PC](http://msdn.microsoft.com/en-us/library/ms229684.aspx)和[Smartphone](http://msdn.microsoft.com/en-us/library/ms229659.aspx)设备的数据编辑建议。对于通用 CE 设备来说，任何一个都是合理的开始，但一般策略是确定哪个单元格处于活动状态并在其上放置一个文本框以进行编辑。

您还可以查看[Eric Hartwell 的 DataGrid 扩展](http://www.ehartwell.com/InfoDabble/DataGrid_extensions_for_the_Compact_Framework)以及[CodeProject 上的 CF 数据网格](http://www.codeproject.com/KB/showcase/DotNetCompactGC.aspx)。

当然，像 Resco 和 ComponentOne 这样的常见嫌疑人也有商业产品。

            回答 #2

赞同：1

时间：2008-09-17T20:21:48.623

不幸的是，DataGrid 不支持编辑。我所做的是使用它来显示只读数据，然后提供一个单独的表单来编辑所选记录。

如果您必须支持在网格布局中进行编辑，那么我会寻找第三方组件。

            回答 #3

赞同：1

时间：2009-08-13T13:32:46.433

[http://msdn.microsoft.com/en-us/library/ms838165.aspx](http://msdn.microsoft.com/en-us/library/ms838165.aspx)

伙计们，它可以完成..只要按照它..完成后它是如此简单;P..

            回答 #4

赞同：1

时间：2014-05-07T09:19:35.263

链接[http://msdn.microsoft.com/en-us/library/ms838165.aspx](http://msdn.microsoft.com/en-us/library/ms838165.aspx)真的很有帮助，但我认为有一个错误。代替

```
DataTable dataTable = (DataTable)grdOrders.DataSource;
DataView dataView = dataTable.DefaultView; 
```

它应该是

```
DataView dataView = (DataView)itemdataentryGrid.DataSource;
DataTable dataTable = dataView.Table; 
```

            回答 #5

赞同：0

时间：2008-09-19T16:42:03.620

是的，在我看来，这是一个笑话。天知道为什么他们从 1.0 开始就这样离开了。在我的第一个 CF 项目中，我认为它是可用的，并花了很长时间实现读写一个，因为我将它放在商定的规范中...... :(

那天我学到了一个非常重要的教训：不要期望 FF 中的任何内容都包含在 CF 中（或者更确切地说，在引用之前检查！）。

        c# - C# 中需要的某种创建模式

ID：86726

赞同：4

时间：2008-09-17T19:32:02.147

标签：c#, .net, design-patterns

我有以下类型：

```
// incomplete class definition
public class Person
{
    private string name;

    public string Name
    {
        get { return this.name; }
    }
} 
```

我希望使用某种专用的控制器/构建器来**创建**和**更新这种类型，但我希望它对****其他类型保持只读**。

该对象还需要在其控制器/构建器每次更新时触发一个事件。

总结一下，根据前面的类型定义骨架：

*   `Person`只能由特定控制器实例化
*   该控制器可以随时**更新**`Person`（`name`字段）的状态
*   发生时需要向世界其他地方`Person`发送**通知**
*   所有其他类型应该只能**读取** `Person`属性

我应该如何实现这个？我在这里谈论的是控制器/构建器，但欢迎所有其他解决方案。

注意：*我可以依赖`internal`修饰符，但理想情况下我所有的东西都应该在同一个程序集中。*

            回答 #1

赞同：5

时间：2008-09-17T19:39:35.013

Create an interface IReadOnlyPerson which exposes only get accessors. Have Person implement IReadOnlyPerson. Store the reference to Person in your controller. Give other clients only the read only version.

This will protect against mistakes, but not fraud, as with most OO features. Clients can runtime cast to Person if they happen to know (or suspect) IReadOnlyPerson is implemented by Person.

**Update, per the comment:**

The Read Only interface may also expose an event delegate, just like any other object. The idiom generally used in C# doesn't prevent clients from messing with the list of listeners, but convention is only to add listeners, so that should be adequate. Inside any set accessor or function with state-changing side effects, just call the event delegate with a guard for the null (no listeners) case.

            回答 #2

赞同：1

时间：2008-09-17T19:48:09.050

我认为`internal`是最简单和最好的方法（这当然涉及多个程序集）。如果不做一些开销密集的堆栈遍历来确定属性设置器中的调用者，您可以尝试：

```
interface IPerson 
{
    Name { get; set; } 
} 
```

并显式实现此接口：

```
class Person : IPerson 
{
    Name { get; private set; }
    string IPerson.Name { get { return Name; } set { Name = value; } } 
} 
```

然后在构建器中执行显式接口转换以设置属性。这仍然不能保护您的实现，也不是一个好的解决方案，尽管它确实在某种程度上强调了您的意图。

在您的属性设置器中，您必须实现事件通知。我自己解决这个问题我不会为每个属性创建单独的事件和事件处理程序，而是创建一个 PropertyChanged 事件并在发生更改时在每个属性中触发它（其中事件参数将包括属性名称、旧值和新值）。

            回答 #3

赞同：1

时间：2008-09-17T20:00:17.537

奇怪的是，虽然我无法更改 Person 对象的名称，但我可以简单地抓住它的控制器并在那里进行更改。这不是保护对象数据的好方法。

但是，尽管如此，这里有一种方法：

```
 /// <summary>
    /// A controlled person.  Not production worthy code.
    /// </summary>
    public class Person
    {
        private string _name;
        public string Name
        {
            get { return _name; }
            private set
            {
                _name = value;
                OnNameChanged();
            }
        }
        /// <summary>
        /// This person's controller
        /// </summary>
        public PersonController Controller
        {
            get { return _controller ?? (_controller = new PersonController(this)); }
        }
        private PersonController _controller;

        /// <summary>
        /// Fires when <seealso cref="Name"/> changes.  Go get the new name yourself.
        /// </summary>
        public event EventHandler NameChanged;

        private void OnNameChanged()
        {
            if (NameChanged != null)
                NameChanged(this, EventArgs.Empty);
        }

        /// <summary>
        /// A Person controller.
        /// </summary>
        public class PersonController
        {
            Person _slave;
            public PersonController(Person slave)
            {
                _slave = slave;
            }
            /// <summary>
            /// Sets the name on the controlled person.
            /// </summary>
            /// <param name="name">The name to set.</param>
            public void SetName(string name) { _slave.Name = name; }
        }
    } 
```

            回答 #4

赞同：1

时间：2008-09-17T19:38:09.137

Use an interface `IPerson` and a nested class:

```
public class Creator
{
    private class Person : IPerson
    {
        public string Name { get; set; }
    }

    public IPerson Create(...) ...

    public void Modify(IPerson person, ...)
    {
        Person dude = person as Person;
        if (dude == null)
            // wasn't created by this class.
        else
            // update the data.
    }
} 
```

            回答 #5

赞同：1

时间：2008-09-17T19:34:31.733

我喜欢有一个只读界面。然后builder/controller/whatever可以直接引用该对象，但是当您将该对象暴露给外部时，您只显示接口。

            回答 #6

赞同：0

时间：2008-09-17T19:41:45.990

Maybe something like that ?

```
public class Person
{
    public class Editor
    {
        private readonly Person person;

        public Editor(Person p)
        {
            person = p;
        }

        public void SetName(string name)
        {
            person.name = name;
        }

        public static Person Create(string name)
        {
            return new Person(name);
        }
    }

    protected string name;

    public string Name
    {
        get { return this.name; }
    }

    protected Person(string name)
    {
        this.name = name;
    }
}

Person p = Person.Editor.Create("John");
Person.Editor e = new Person.Editor(p);
e.SetName("Jane"); 
```

Not pretty, but I think it works. Alternatively you can use properties instead of SetX methods on the editor.

        c++ - 如何最好地缓解触发非增量链接 (MSVS) 的场景

ID：86751

赞同：1

时间：2008-09-17T19:34:23.917

标签：c++, c, linker

虽然增量链接解决了链接所花费的大部分时间，即使对于非常大的项目，我发现 MSVS 中的增量链接器非常随意。（我目前使用的是 2003 atm，很想听听 2005/8 是否解决了这些问题。）我的已知触发器列表包括：

*   更改主 .exe 项目外部的任何内容将触发完整链接
*   添加静态变量有 50% 的机会触发完整链接

这个清单当然不包括在内。我该怎么做才能避免完整链接？

到目前为止，我发现的唯一诊断工具是

*   /test 在链接器命令行选项中

这太可怕了。有哪些解决方案可用于诊断完全重新链接的触发器？

            回答 #1

赞同：1

时间：2008-09-17T19:47:42.247

尽量减少解决方案中的项目数量会使问题好转一些。当然，所有正常的构建加速都将起作用，例如减少包含和缩小 obj 文件的大小。

            回答 #2

赞同：0

时间：2008-09-17T21:05:47.990

我用的是2008；虽然我只将它用于中小型项目，但到目前为止我还没有遇到任何意想不到的完整链接。

我没用过03，但在我看来08似乎比05好得多。

        excel - 使用 MSBuild 更改 .xla 文件

ID：86763

赞同：4

时间：2008-09-17T19:36:00.683

标签：excel, msbuild, build-automation, xla, vba

我正在尝试为我当前的项目创建一个构建脚本，其中包括一个 Excel 插件。加载项包含一个带有文件 modGlobal 和变量 version_Number 的 VBProject。每次构建都需要更改此数字。具体步骤：

1.  使用 Excel 打开 XLA 文档。
2.  切换到 VBEditor 模式。(Alt+F11)
3.  打开 VBProject，输入密码。
4.  打开 modGlobal 文件。
5.  将变量的默认值更改为当前日期。
6.  关闭并保存项目。

我不知道如何自动化这个过程。我能想到的最好的方法是一个 excel 宏或 Auto-IT 脚本。我也可以编写一个自定义的 MSBuild 任务，但这可能会变得……很棘手。还有其他人有其他建议吗？

            回答 #1

赞同：3

时间：2008-09-23T06:56:18.500

处理 XLA 文件版本控制的另一种方法是使用文档属性中的自定义属性。您可以使用 COM 访问和操作，如下所述：http: [//support.microsoft.com/](http://support.microsoft.com/?kbid=224351) ?kbid=224351 。

这样做的好处是：

*   您可以在不打开 XLA 文件的情况下检查版本号

*   您的构建机器上不需要 Excel - 只有 DsoFile.dll 组件

另一种选择是将版本号（可能还有其他配置数据）存储在 XLA 文件中的工作表上。XLA 的用户将看不到该工作表。我过去使用的一种技术是将加载项作为 XLS 文件存储在源代码管理中，然后作为构建过程的一部分（例如在构建后事件中）运行下面的脚本以将其转换为 XLA输出目录。此脚本可以轻松扩展以在保存之前更新工作表中的版本号。就我而言，我这样做是因为我的 Excel 插件使用了 VSTO，而 Visual Studio 不直接支持 XLA 文件。

```
'
'   ConvertToXla.vbs
'
'   VBScript to convert an Excel spreadsheet (.xls) into an Excel Add-In (.xla)
'
'   The script takes two arguments:
'
'   - the name of the input XLS file.
'
'   - the name of the output XLA file.
'
Option Explicit
Dim nResult
On Error Resume Next
nResult = DoAction
If Err.Number <> 0 Then 
    Wscript.Echo Err.Description
    Wscript.Quit 1
End If
Wscript.Quit nResult

Private Function DoAction()

    Dim sInputFile, sOutputFile

    Dim argNum, argCount: argCount = Wscript.Arguments.Count

    If argCount < 2 Then
        Err.Raise 1, "ConvertToXla.vbs", "Missing argument"
    End If

    sInputFile = WScript.Arguments(0)
    sOutputFile = WScript.Arguments(1)

    Dim xlApplication

    Set xlApplication = WScript.CreateObject("Excel.Application")
    On Error Resume Next 
    ConvertFileToXla xlApplication, sInputFile, sOutputFile
    If Err.Number <> 0 Then 
        Dim nErrNumber
        Dim sErrSource
        Dim sErrDescription
        nErrNumber = Err.Number
        sErrSource = Err.Source
        sErrDescription = Err.Description
        xlApplication.Quit
        Err.Raise nErrNumber, sErrSource, sErrDescription
    Else
        xlApplication.Quit
    End If

End Function

Public Sub ConvertFileToXla(xlApplication, sInputFile, sOutputFile)

    Dim xlAddIn
    xlAddIn = 18 ' XlFileFormat.xlAddIn

    Dim w
    Set w = xlApplication.Workbooks.Open(sInputFile,,,,,,,,,True)
    w.IsAddIn = True
    w.SaveAs sOutputFile, xlAddIn
    w.Close False
End Sub 
```

            回答 #2

赞同：1

时间：2008-09-18T01:12:41.857

我不是 100% 确定如何完全按照您的要求进行操作。但猜测你心中的目标有几种可能性。

**1）**将您的部分（或全部）Globals 制作为与 .XLA 一起分发的单独文本文件，我会将其用于外部参考，例如您的应用程序其余部分的版本。在构建时编写并分发，并在 XLA 的负载上读取。

**2）**我猜你正在编写应用程序的主要组件（即：非 XLA 部分）的版本。如果这是真的，为什么要将它存储在您的 XLA 中？为什么不让应用程序的主要部分允许某些版本的 XLA 工作。主应用程序的 1.1 版可以接受来自 XLA 7.1 - 8.9 版的调用。

**3)**如果您只是想更新 XLA，以便将其包含在您的版本控制系统或类似系统中（我在这里猜测），也许只需触摸文件，使其看起来像已更改。

如果它是您控制的应用程序其余部分的版本，我只需将其粘贴在文本文件中并与 XLA 一起分发。

            回答 #3

赞同：0

时间：2008-09-18T13:44:09.367

您可以在 Excel 中以编程方式修改 xla 中的代码。您将需要对“Microsoft Visual Basic for Applications Extensibility..”组件的引用。

[Chip Pearson 的优秀网站](http://www.cpearson.com/excel/vbe.aspx)上的示例应该可以帮助您入门。

        c# - 执行文件io时如何正确处理异常

ID：86766

赞同：19

时间：2008-09-17T19:36:11.870

标签：c#, .net, file-io, exception-handling

我经常发现自己以某种方式与文件进行交互，但是在编写代码之后，我总是不确定它实际上是多么生硬。问题是我不完全确定与文件相关的操作是如何失败的，因此，这是处理期望的最佳方法。

简单的解决方案似乎只是捕获代码抛出的任何 IOExceptions 并向用户提供“无法访问的文件”错误消息，但是否有可能获得更细粒度的错误消息。有没有办法确定文件被另一个程序锁定等错误与由于硬件错误导致数据不可读之间的区别？

鉴于以下 C# 代码，您将如何以用户友好（尽可能提供信息）的方式处理错误？

```
public class IO
{
   public List<string> ReadFile(string path)
   {
      FileInfo file = new FileInfo(path);

      if (!file.Exists)
      {
         throw new FileNotFoundException();
      }

      StreamReader reader = file.OpenText();
      List<string> text = new List<string>();

      while (!reader.EndOfStream)
      {
         text.Add(reader.ReadLine());
      }

      reader.Close();
      reader.Dispose();
      return text;
   }

   public void WriteFile(List<string> text, string path)
   {
      FileInfo file = new FileInfo(path);

      if (!file.Exists)
      {
         throw new FileNotFoundException();
      }

      StreamWriter writer = file.CreateText();

      foreach(string line in text)
      {
         writer.WriteLine(line);
      }

      writer.Flush();
      writer.Close();
      writer.Dispose();
   }
} 
```

            回答 #1

赞同：15

时间：2008-09-18T07:03:21.767

...但是是否有可能获得更细粒度的错误消息。

是的。继续 catch `IOException`，并使用该`Exception.ToString()`方法获取相对相关的错误消息进行显示。请注意，由 .NET Framework 生成的异常将提供这些有用的字符串，但如果您要抛出自己的异常，则必须记住将该字符串插入到`Exception`的构造函数中，例如：

`throw new FileNotFoundException("File not found");`

此外，绝对按照[Scott Dorman](https://stackoverflow.com/users/1559/scott-dorman)的说法，使用该`using`声明。但是，要注意的是，该`using`语句实际上并没有`catch`任何作用，这应该是它应该的方式。例如，您检查文件是否存在的测试将引入可能相当[令人烦恼](http://blogs.msdn.com/ericlippert/archive/2008/09/10/vexing-exceptions.aspx)的竞争条件。把它放在那里对你没有任何好处。所以，现在，对于读者，我们有：

```
try {  
    using (StreamReader reader = file.OpenText()) {  
        // Your processing code here  
    }  
} catch (IOException e) {  
    UI.AlertUserSomehow(e.ToString());  
}
```

简而言之，对于基本的文件操作：

1\. 使用`using`

2，将 using 语句或函数包装在一个`try`/ `catch`that `catch`es中`IOException`

3\. 使用`Exception.ToString()`in your`catch`以获得有用的错误消息

4\. 不要尝试自己检测异常文件问题。让 .NET 为您完成任务。

            回答 #2

赞同：7

时间：2008-09-17T19:43:39.357

您应该更改的第一件事是调用 StreamWriter 和 StreamReader 以将它们包装在 using 语句中，如下所示：

```
using (StreamReader reader = file.OpenText())
{
   List<string> text = new List<string>();
   while (!reader.EndOfStream)
   {
      text.Add(reader.ReadLine());
   }
} 
```

这将为您调用 Close 和 Dispose 并实际将其包装在 try/finally 块中，因此实际编译的代码如下所示：

```
StreamReader reader = file.OpenText();
try
{
   List<string> text = new List<string>();
   while (!reader.EndOfStream)
   {
      text.Add(reader.ReadLine());
   }
}
finally
{
   if (reader != null)
      ((IDisposable)reader).Dispose();
} 
```

这里的好处是即使发生异常，您也可以确保流被关闭。

至于任何更明确的异常处理，它真的取决于你想要发生的事情。在您的示例中，您明确测试文件是否存在并抛出 FileNotFoundException ，这对您的用户来说可能就足够了，但可能还不够。

            回答 #3

赞同：1

时间：2008-09-17T19:49:07.737

*   跳过 File.Exists(); 要么在别处处理它，要么让 CreateText()/OpenText() 提升它。
*   最终用户通常只关心它是否成功。如果失败了，就这么说吧，他不要细节。

我还没有找到一种内置的方法来获取有关 .NET 中失败的原因和原因的详细信息，但是如果您使用 CreateFile 本地化，那么您有成千上万的错误代码可以告诉您出了什么问题。

            回答 #4

赞同：1

时间：2008-09-17T19:52:15.810

我看不出检查文件是否存在并在没有消息的情况下抛出 FileNotFoundException 的意义。框架将抛出​​ FileNotFoundException 本身，并带有一条消息。

您的示例的另一个问题是您应该使用 try/finally 模式或 using 语句来确保即使出现异常也能正确处理一次性类。

我会这样做，如下所示，捕获方法之外的任何异常，并显示异常的消息：

```
public IList<string> ReadFile(string path)
{
    List<string> text = new List<string>();
    using(StreamReader reader = new StreamReader(path))
    {
      while (!reader.EndOfStream)      
      {         
         text.Add(reader.ReadLine());      
      }
    }
    return text;
} 
```

            回答 #5

赞同：0

时间：2008-09-17T19:49:16.237

我会使用 using 语句来简化关闭文件的过程。请参阅[MSDN C# using 语句](http://msdn.microsoft.com/en-us/library/aa664736.aspx)

来自 MSDN：

```
 using (TextWriter w = File.CreateText("log.txt")) {
     w.WriteLine("This is line one");
     w.WriteLine("This is line two");
  }
  using (TextReader r = File.OpenText("log.txt")) {
     string s;
     while ((s = r.ReadLine()) != null) {
        Console.WriteLine(s);
     }
  } 
```

            回答 #6

赞同：0

时间：2008-09-17T19:55:14.897

也许这不是您要寻找的，但请重新考虑您使用的异常处理类型。起初，不应将异常处理视为“用户友好的”，至少只要您将程序员视为用户。

对此的总结可能是以下文章[http://goit-postal.blogspot.com/2007/03/brief-introduction-to-exception.html](http://goit-postal.blogspot.com/2007/03/brief-introduction-to-exception.html)。

        java - 如何在Java中以不区分大小写的方式检查一个字符串是否包含另一个字符串？

ID：86780

赞同：441

时间：2008-09-17T19:37:32.600

标签：java, string

假设我有两个字符串，

```
String s1 = "AbBaCca";
String s2 = "bac"; 
```

我想执行`s2`包含在`s1`. 我可以这样做：

```
return s1.contains(s2); 
```

我很确定这`contains()`是区分大小写的，但是我无法通过阅读文档确定这一点。如果是这样，我想我最好的方法是：

```
return s1.toLowerCase().contains(s2.toLowerCase()); 
```

除了所有这些，还有另一种（可能更好）的方法来实现这一点而不关心区分大小写吗？

            回答 #1

赞同：347

时间：2008-09-17T19:41:55.583

是的，包含区分大小写。您可以使用带有 CASE_INSENSITIVE 标志的 java.util.regex.Pattern 进行不区分大小写的匹配：

```
Pattern.compile(Pattern.quote(wantedStr), Pattern.CASE_INSENSITIVE).matcher(source).find(); 
```

**编辑：**如果 s2 包含正则表达式特殊字符（其中有很多），首先引用它很重要。我已经更正了我的答案，因为这是人们会看到的第一个答案，但是自从马特·奎尔指出这一点后，就投了赞成票。

            回答 #2

赞同：283

时间：2008-09-18T07:48:30.127

[Dave L. 回答的](https://stackoverflow.com/questions/86780/is-the-contains-method-in-java-lang-string-case-sensitive/86832#86832)一个问题是当 s2 包含正则表达式标记时，例如`\d`, 等。

您想在 s2 上调用 Pattern.quote()：

```
Pattern.compile(Pattern.quote(s2), Pattern.CASE_INSENSITIVE).matcher(s1).find(); 
```

            回答 #3

赞同：196

时间：2012-03-05T00:36:51.183

您可以使用

```
org.apache.commons.lang3.StringUtils.containsIgnoreCase("AbBaCca", "bac"); 
```

[Apache Commons](https://en.wikipedia.org/wiki/Apache_Commons)库对于这类事情非常有用。而且这个特定的表达式可能比正则表达式更好，因为正则表达式在性能方面总是很昂贵。

            回答 #4

赞同：137

时间：2014-08-19T08:48:16.603

更快的实现：利用`String.regionMatches()`

使用正则表达式可能相对较慢。如果您只想检查一种情况，它（缓慢）并不重要。但是，如果您有一个数组或包含数千或数十万个字符串的集合，那么事情可能会变得非常缓慢。

下面提出的解决方案不使用正则表达式也不`toLowerCase()`（这也很慢，因为它会创建另一个字符串并在检查后将它们丢弃）。

该解决方案基于似乎未知的[**String.regionMatches()方法。**](http://docs.oracle.com/javase/8/docs/api/java/lang/String.html#regionMatches-boolean-int-java.lang.String-int-int-)它检查 2 个`String`区域是否匹配，但重要的是它还有一个带有方便`ignoreCase`参数的重载。

```
public static boolean containsIgnoreCase(String src, String what) {
    final int length = what.length();
    if (length == 0)
        return true; // Empty string is contained

    final char firstLo = Character.toLowerCase(what.charAt(0));
    final char firstUp = Character.toUpperCase(what.charAt(0));

    for (int i = src.length() - length; i >= 0; i--) {
        // Quick check before calling the more expensive regionMatches() method:
        final char ch = src.charAt(i);
        if (ch != firstLo && ch != firstUp)
            continue;

        if (src.regionMatches(true, i, what, 0, length))
            return true;
    }

    return false;
} 
```

速度分析

这种速度分析并不意味着是火箭科学，只是对不同方法有多快的粗略描述。

我比较了5种方法。

1.  我们的**containsIgnoreCase()**方法。
2.  通过将两个字符串都转换为小写并调用`String.contains()`.
3.  通过将源字符串转换为小写并`String.contains()`使用预缓存的小写子字符串进行调用。这个解决方案已经不那么灵活了，因为它测试了一个预先定义的子字符串。
4.  使用正则表达式（接受的答案`Pattern.compile().matcher().find()`...）
5.  使用正则表达式，但使用预先创建和缓存的`Pattern`. 这个解决方案已经不那么灵活了，因为它测试了一个预定义的子字符串。

结果（通过调用该方法 1000 万次）：

1.  我们的方法：670 毫秒
2.  2x toLowerCase() 和 contains()：2829 毫秒
3.  1x toLowerCase() 和 contains() 缓存子字符串：2446 毫秒
4.  正则表达式：7180 毫秒
5.  缓存的正则表达式`Pattern`：1845 毫秒

结果在表格中：

```
 RELATIVE SPEED   1/RELATIVE SPEED
 METHOD                          EXEC TIME    TO SLOWEST      TO FASTEST (#1)
------------------------------------------------------------------------------
 1\. Using regionMatches()          670 ms       10.7x            1.0x
 2\. 2x lowercase+contains         2829 ms        2.5x            4.2x
 3\. 1x lowercase+contains cache   2446 ms        2.9x            3.7x
 4\. Regexp                        7180 ms        1.0x           10.7x
 5\. Regexp+cached pattern         1845 ms        3.9x            2.8x 
```

与小写和 using 相比，我们的方法**快 4 倍****，**与使用正则表达式相比快 10**倍，**即使预缓存（并且失去检查任意子字符串的灵活性）也快 3 倍。`contains()`****`Pattern`**** *** * *

## 分析测试代码

如果您对分析的执行方式感兴趣，这里是完整的可运行应用程序：

```
import java.util.regex.Pattern;

public class ContainsAnalysis {

    // Case 1 utilizing String.regionMatches()
    public static boolean containsIgnoreCase(String src, String what) {
        final int length = what.length();
        if (length == 0)
            return true; // Empty string is contained

        final char firstLo = Character.toLowerCase(what.charAt(0));
        final char firstUp = Character.toUpperCase(what.charAt(0));

        for (int i = src.length() - length; i >= 0; i--) {
            // Quick check before calling the more expensive regionMatches()
            // method:
            final char ch = src.charAt(i);
            if (ch != firstLo && ch != firstUp)
                continue;

            if (src.regionMatches(true, i, what, 0, length))
                return true;
        }

        return false;
    }

    // Case 2 with 2x toLowerCase() and contains()
    public static boolean containsConverting(String src, String what) {
        return src.toLowerCase().contains(what.toLowerCase());
    }

    // The cached substring for case 3
    private static final String S = "i am".toLowerCase();

    // Case 3 with pre-cached substring and 1x toLowerCase() and contains()
    public static boolean containsConverting(String src) {
        return src.toLowerCase().contains(S);
    }

    // Case 4 with regexp
    public static boolean containsIgnoreCaseRegexp(String src, String what) {
        return Pattern.compile(Pattern.quote(what), Pattern.CASE_INSENSITIVE)
                    .matcher(src).find();
    }

    // The cached pattern for case 5
    private static final Pattern P = Pattern.compile(
            Pattern.quote("i am"), Pattern.CASE_INSENSITIVE);

    // Case 5 with pre-cached Pattern
    public static boolean containsIgnoreCaseRegexp(String src) {
        return P.matcher(src).find();
    }

    // Main method: perfroms speed analysis on different contains methods
    // (case ignored)
    public static void main(String[] args) throws Exception {
        final String src = "Hi, I am Adam";
        final String what = "i am";

        long start, end;
        final int N = 10_000_000;

        start = System.nanoTime();
        for (int i = 0; i < N; i++)
            containsIgnoreCase(src, what);
        end = System.nanoTime();
        System.out.println("Case 1 took " + ((end - start) / 1000000) + "ms");

        start = System.nanoTime();
        for (int i = 0; i < N; i++)
            containsConverting(src, what);
        end = System.nanoTime();
        System.out.println("Case 2 took " + ((end - start) / 1000000) + "ms");

        start = System.nanoTime();
        for (int i = 0; i < N; i++)
            containsConverting(src);
        end = System.nanoTime();
        System.out.println("Case 3 took " + ((end - start) / 1000000) + "ms");

        start = System.nanoTime();
        for (int i = 0; i < N; i++)
            containsIgnoreCaseRegexp(src, what);
        end = System.nanoTime();
        System.out.println("Case 4 took " + ((end - start) / 1000000) + "ms");

        start = System.nanoTime();
        for (int i = 0; i < N; i++)
            containsIgnoreCaseRegexp(src);
        end = System.nanoTime();
        System.out.println("Case 5 took " + ((end - start) / 1000000) + "ms");
    }

} 
```

* * *

## 回答 #5

> 赞同：35
> 
>             
> 
> 时间：2012-01-16T17:29:04.673

一种更简单的方法（不用担心模式匹配）是将两个`String`s 都转换为小写：

```
String foobar = "fooBar";
String bar = "FOO";
if (foobar.toLowerCase().contains(bar.toLowerCase()) {
    System.out.println("It's a match!");
} 
```

* * *

## 回答 #6

> 赞同：19
> 
>             
> 
> 时间：2010-04-15T16:30:39.200

是的，这是可以实现的：

```
String s1 = "abBaCca";
String s2 = "bac";

String s1Lower = s1;

//s1Lower is exact same string, now convert it to lowercase, I left the s1 intact for print purposes if needed

s1Lower = s1Lower.toLowerCase();

String trueStatement = "FALSE!";
if (s1Lower.contains(s2)) {

    //THIS statement will be TRUE
    trueStatement = "TRUE!"
}

return trueStatement; 
```

此代码将返回字符串“TRUE！” 因为它发现你的角色被包含在内。

* * *

## 回答 #7

> 赞同：7
> 
>             
> 
> 时间：2012-10-20T01:53:54.827

您可以使用[正则表达式](http://en.wikipedia.org/wiki/Regular_expression)，它可以工作：

```
boolean found = s1.matches("(?i).*" + s2+ ".*"); 
```

* * *

## 回答 #8

> 赞同：3
> 
>             
> 
> 时间：2014-01-16T05:21:27.177

我做了一个测试，找到一个不区分大小写的字符串匹配。我有一个包含 150,000 个对象的向量，所有对象都以字符串作为一个字段，并希望找到与字符串匹配的子集。我尝试了三种方法：

1.  全部转换为小写

    ```
    for (SongInformation song: songs) {
        if (song.artist.toLowerCase().indexOf(pattern.toLowercase() > -1) {
                ...
        }
    } 
    ```

2.  使用字符串匹配（）方法

    ```
    for (SongInformation song: songs) {
        if (song.artist.matches("(?i).*" + pattern + ".*")) {
        ...
        }
    } 
    ```

3.  使用正则表达式

    ```
    Pattern p = Pattern.compile(pattern, Pattern.CASE_INSENSITIVE);
    Matcher m = p.matcher("");
    for (SongInformation song: songs) {
        m.reset(song.artist);
        if (m.find()) {
        ...
        }
    } 
    ```

计时结果为：

*   未尝试匹配：20 毫秒

*   降低匹配：182 毫秒

*   字符串匹配：278 毫秒

*   正则表达式：65 毫秒

对于这个用例，正则表达式看起来是最快的。

* * *

## 回答 #9

> 赞同：3
> 
>             
> 
> 时间：2014-05-27T14:29:18.177

如果您引入 ICU4j，您可以制作一些对 Unicode 友好的代码。我猜“忽略大小写”对于方法名称是有问题的，因为虽然主要强度比较确实忽略了大小写，但它被描述为依赖于语言环境的细节。但它希望以用户期望的方式依赖于语言环境。

```
public static boolean containsIgnoreCase(String haystack, String needle) {
    return indexOfIgnoreCase(haystack, needle) >= 0;
}

public static int indexOfIgnoreCase(String haystack, String needle) {
    StringSearch stringSearch = new StringSearch(needle, haystack);
    stringSearch.getCollator().setStrength(Collator.PRIMARY);
    return stringSearch.first();
} 
```

* * *

## 回答 #10

> 赞同：3
> 
>             
> 
> 时间：2019-05-04T06:41:13.180

有一个简单简洁的方法，使用正则表达式标志（不区分大小写 {i}）：

```
 String s1 = "hello abc efg";
 String s2 = "ABC";
 s1.matches(".*(?i)"+s2+".*");

/*
 * .*  denotes every character except line break
 * (?i) denotes case insensitivity flag enabled for s2 (String)
 * */ 
```

* * *

## 回答 #11

> 赞同：2
> 
>             
> 
> 时间：2017-12-13T07:36:31.167

```
"AbCd".toLowerCase().contains("abcD".toLowerCase()) 
```

* * *

## 回答 #12

> 赞同：2
> 
>             
> 
> 时间：2021-05-27T06:01:58.780

一种方法是使用 toLowerCase() 或 toUpperCase() 方法将两个字符串转换为小写或大写并进行测试。

```
public class Sample {
   public static void main(String args[]){
      String str = "Hello Welcome to insensitive Container";
      String test = "Java Testing";
      Boolean bool = str.toLowerCase().contains(test.toLowerCase());
      System.out.println(bool);
   }
} 
```

这是使用带有 CASE_INSENSITIVE 标志的 java.util.regex.Pattern 进行不区分大小写匹配的另一种方法。

```
Pattern.compile(Pattern.quote(s2), Pattern.CASE_INSENSITIVE).matcher(s1).find(); 
```

* * *

## 回答 #13

> 赞同：1
> 
>             
> 
> 时间：2008-09-17T19:42:16.550

我不确定您的主要问题是什么，但是是的，.contains 区分大小写。

* * *

## 回答 #14

> 赞同：0
> 
>             
> 
> 时间：2014-02-08T00:36:23.747

```
String container = " Case SeNsitive ";
String sub = "sen";
if (rcontains(container, sub)) {
    System.out.println("no case");
}

public static Boolean rcontains(String container, String sub) {

    Boolean b = false;
    for (int a = 0; a < container.length() - sub.length() + 1; a++) {
        //System.out.println(sub + " to " + container.substring(a, a+sub.length()));
        if (sub.equalsIgnoreCase(container.substring(a, a + sub.length()))) {
            b = true;
        }
    }
    return b;
} 
```

基本上，它是一种需要两个字符串的方法。它应该是不区分大小写的 contains() 版本。使用 contains 方法时，您想查看一个字符串是否包含在另一个字符串中。

此方法采用“sub”字符串并检查它是否等于容器字符串的长度等于“sub”的子字符串。如果您查看`for`循环，您将看到它在容器字符串上的子字符串（即“sub”的长度）中迭代。

每次迭代都会检查容器字符串`equalsIgnoreCase`的子字符串是否是子字符串。

* * *

## 回答 #15

> 赞同：0
> 
>             
> 
> 时间：2015-04-07T07:16:22.753

如果您必须在另一个 ASCII 字符串（例如[URL](http://en.wikipedia.org/wiki/Uniform_resource_locator) ）中搜索 ASCII 字符串，您会发现我的解决方案更好。我已经测试了 icza 的方法和我的速度，结果如下：

*   案例 1 耗时 2788 毫秒 - regionMatches

*   案例 2 耗时 1520 毫秒 - 我的

编码：

```
public static String lowerCaseAscii(String s) {
    if (s == null)
        return null;

    int len = s.length();
    char[] buf = new char[len];
    s.getChars(0, len, buf, 0);
    for (int i=0; i<len; i++) {
        if (buf[i] >= 'A' && buf[i] <= 'Z')
            buf[i] += 0x20;
    }

    return new String(buf);
}

public static boolean containsIgnoreCaseAscii(String str, String searchStr) {
    return StringUtils.contains(lowerCaseAscii(str), lowerCaseAscii(searchStr));
} 
```

* * *

## 回答 #16

> 赞同：0
> 
>             
> 
> 时间：2016-11-09T13:24:46.433

```
import java.text.Normalizer;

import org.apache.commons.lang3.StringUtils;

public class ContainsIgnoreCase {

    public static void main(String[] args) {

        String in = "   Annulée ";
        String key = "annulee";

        // 100% java
        if (Normalizer.normalize(in, Normalizer.Form.NFD).replaceAll("[\\p{InCombiningDiacriticalMarks}]", "").toLowerCase().contains(key)) {
            System.out.println("OK");
        } else {
            System.out.println("KO");
        }

        // use commons.lang lib
        if (StringUtils.containsIgnoreCase(Normalizer.normalize(in, Normalizer.Form.NFD).replaceAll("[\\p{InCombiningDiacriticalMarks}]", ""), key)) {
            System.out.println("OK");
        } else {
            System.out.println("KO");
        }

    }

} 
```

* * *

## 回答 #17

> 赞同：0
> 
>             
> 
> 时间：2019-05-03T09:48:10.963

我们可以使用带有 anyMatch 的流并包含 Java 8

```
public class Test2 {
    public static void main(String[] args) {

        String a = "Gina Gini Protijayi Soudipta";
        String b = "Gini";

        System.out.println(WordPresentOrNot(a, b));
    }// main

    private static boolean WordPresentOrNot(String a, String b) {
    //contains is case sensitive. That's why change it to upper or lower case. Then check
        // Here we are using stream with anyMatch
        boolean match = Arrays.stream(a.toLowerCase().split(" ")).anyMatch(b.toLowerCase()::contains);
        return match;
    }

} 
```

* * *

## 回答 #18

> 赞同：0
> 
>             
> 
> 时间：2019-08-01T21:10:17.873

或者您可以使用一种简单的方法，只需将字符串的大小写转换为子字符串的大小写，然后使用 contains 方法。

* * *

## 回答 #19

> 赞同：-1
> 
>             
> 
> 时间：2010-12-09T11:24:13.947

```
String x="abCd";
System.out.println(Pattern.compile("c",Pattern.CASE_INSENSITIVE).matcher(x).find()); 
```

* * *

## 回答 #20

> 赞同：-1
> 
>             
> 
> 时间：2015-12-03T15:16:30.133

你可以简单地做这样的事情：

```
String s1 = "AbBaCca";
String s2 = "bac";
String toLower = s1.toLowerCase();
return toLower.contains(s2); 
```

# data-structures - Is there a specific name for the node that coresponds to a subtree?

> ID：86790
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-09-17T19:38:37.433
> 
>         
> 
> 标签：data-structures, naming-conventions, tree, class-design, naming

I'm designing a web site navigation hierarchy. It's a tree of nodes.  Nodes represent web pages.

Some nodes on the tree are special.  I need a name for them.

There are multiple such nodes. Each is the "root" of a sub-tree with pages that have a distinct logo, style sheet, or layout. Think of different departments.

[site map with color-coded sub-trees http://img518.imageshack.us/img518/153/subtreesfe1.gif](http://img518.imageshack.us/img518/153/subtreesfe1.gif)

What should I name this type of node?

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2008-09-17T19:40:02.733

How about Root (node with children, but no parent), Node (node with children and parent) and Leaf (node with no children and parent)?

You can then distinguish by name and position within the tree structure (E.g. DepartmentRoot, DepartmentNode, DepartmentLeaf) if need be..

## Update Following Comment from OP

Looking at your question, you said that "some" are special, and in your diagram, you have different nodes looking differently at different levels. The nodes may be different in their design, you can build a tree structure many ways. For example, a single abstract class that *can* have child nodes, if no children, its a leaf, if no parent, its a root but this can change in its lifetime. Or, a fixed class structure in which leafs are a specific class type that *cannot* have children added to them in any way.

IF your design does not need you to distinguish nodes differently depending on their position (relative to the root) it suggests that you have an abstract class used for them all.

In which case, it raises the question, **how is it different?**

If it is simply the same as the standard node everywhere else, but with a bit of styling, how about *StyledNode*? Do you even need it to be seperate (no style == no big deal, it doesn't render).

Since I don't know the mechanics of how the tree is architected, there could possibly be several factors to consider when naming.

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-09-17T19:44:35.953

您要查找的词是“部分”。它是整体的一部分，里面有同样的东西。

所以，你有节点，它有子节点和父节点，你有 SectionNodes，它们是这些特殊子树的根。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-09-17T19:46:37.790

所以，听起来你正在收集类别。节点是该类别的入口点。那么“TopCategoryNode”、“CategoryEntry”怎么样呢？它们下面的东西。或者，如果你想划分更多，比如“CategoryCSS”、“CategoryLayout”等？

这是一种通用的，但您明确表示存在“类别”，并且这些类别确实包含多个子节点或子主题。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-09-17T19:46:49.037

分支 ？

保持树类比，并在这种情况下暗示部门等

考虑类层次结构，Root 可能是 Branch 的一个特例，它是 Node 的一个特例，Leaf 的一个特例。分支/节点的区别是您可以针对您的特殊情况做出的区别。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2008-09-17T19:43:17.127

How about *PageTemplate* to embody the fact that its children have their own layout, CSS etc?

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2008-09-17T19:43:24.303

`AreaNode`

# .net - 如何避免数千个不必要的 ListView.SelectedIndexChanged 事件？

> ID：86793
> 
>         
> 
> 赞同：17
> 
>         
> 
> 时间：2008-09-17T19:38:42.440
> 
>         
> 
> 标签：.net, winforms, listview, selectedindexchanged

如果用户选择 .NET 2.0 ListView 中的所有项目，ListView 将为每个项目触发**SelectedIndexChanged**事件，而不是触发事件以指示*选择*已更改。

如果用户随后单击以选择列表中的一个项目，则 ListView 将为*每个未选择的项目触发***SelectedIndexChanged**事件，然后为单个新选择的项目触发**SelectedIndexChanged**事件，而不是触发一个事件来指示选择已经改变。

 ***如果您在**SelectedIndexChanged**事件处理程序中有代码，则当您开始在列表中有数百/数千个项目时，程序将变得非常无响应。

我考虑过*驻留计时器*等。

但是有没有人有一个很好的解决方案来避免数千个不必要的 ListView。**SelectedIndexChange**事件，什么时候真的会发生**一个事件**？

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2009-06-11T13:11:47.173

伊恩的好解决方案。我把它做成了一个可重用的类，确保正确处理计时器。我还缩短了获取响应速度更快的应用程序的时间间隔。该控件还具有双缓冲以减少闪烁。

```
 public class DoublebufferedListView : System.Windows.Forms.ListView
  {
     private Timer m_changeDelayTimer = null;
     public DoublebufferedListView()
        : base()
     {
        // Set common properties for our listviews
        if (!SystemInformation.TerminalServerSession)
        {
           DoubleBuffered = true;
           SetStyle(ControlStyles.ResizeRedraw, true);
        }
     }

     /// <summary>
     /// Make sure to properly dispose of the timer
     /// </summary>
     /// <param name="disposing"></param>
     protected override void Dispose(bool disposing)
     {
        if (disposing && m_changeDelayTimer != null)
        {
           m_changeDelayTimer.Tick -= ChangeDelayTimerTick;
           m_changeDelayTimer.Dispose();
        }
        base.Dispose(disposing);
     }

     /// <summary>
     /// Hack to avoid lots of unnecessary change events by marshaling with a timer:
     /// http://stackoverflow.com/questions/86793/how-to-avoid-thousands-of-needless-listview-selectedindexchanged-events
     /// </summary>
     /// <param name="e"></param>
     protected override void OnSelectedIndexChanged(EventArgs e)
     {
        if (m_changeDelayTimer == null)
        {
           m_changeDelayTimer = new Timer();
           m_changeDelayTimer.Tick += ChangeDelayTimerTick;
           m_changeDelayTimer.Interval = 40;
        }
        // When a new SelectedIndexChanged event arrives, disable, then enable the
        // timer, effectively resetting it, so that after the last one in a batch
        // arrives, there is at least 40 ms before we react, plenty of time 
        // to wait any other selection events in the same batch.
        m_changeDelayTimer.Enabled = false;
        m_changeDelayTimer.Enabled = true;
     }

     private void ChangeDelayTimerTick(object sender, EventArgs e)
     {
        m_changeDelayTimer.Enabled = false;
        base.OnSelectedIndexChanged(new EventArgs());
     }
  } 
```

请让我知道这是否可以改进。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2008-09-17T20:21:45.457

这是我现在使用的停留计时器解决方案（停留只是意味着“等待一点”）。此代码可能会受到竞争条件的影响，并且可能会出现空引用异常。

```
Timer changeDelayTimer = null;

private void lvResults_SelectedIndexChanged(object sender, EventArgs e)
{
        if (this.changeDelayTimer == null)
        {
            this.changeDelayTimer = new Timer();
            this.changeDelayTimer.Tick += ChangeDelayTimerTick;
            this.changeDelayTimer.Interval = 200; //200ms is what Explorer uses
        }
        this.changeDelayTimer.Enabled = false;
        this.changeDelayTimer.Enabled = true;
}

private void ChangeDelayTimerTick(object sender, EventArgs e)
{
    this.changeDelayTimer.Enabled = false;
    this.changeDelayTimer.Dispose();
    this.changeDelayTimer = null;

    //Add original SelectedIndexChanged event handler code here
    //todo
} 
```

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2014-01-15T11:25:18.840

我知道的老问题，但这似乎仍然是一个问题。

这是我不使用计时器的解决方案。

它在触发 SelectionChanged 事件之前等待 MouseUp 或 KeyUp 事件。如果您以编程方式更改选择，那么这将不起作用，事件不会触发，但您可以轻松添加 FinishedChanging 事件或其他东西来触发事件。

（它还有一些与这个问题无关的东西来停止闪烁）。

```
public class ListViewNF : ListView
{
    bool SelectedIndexChanging = false;

    public ListViewNF()
    {
        this.SetStyle(ControlStyles.OptimizedDoubleBuffer | ControlStyles.AllPaintingInWmPaint, true);
        this.SetStyle(ControlStyles.EnableNotifyMessage, true);
    }

    protected override void OnNotifyMessage(Message m)
    {
        if(m.Msg != 0x14)
            base.OnNotifyMessage(m);
    }

    protected override void OnSelectedIndexChanged(EventArgs e)
    {
        SelectedIndexChanging = true;
        //base.OnSelectedIndexChanged(e);
    }

    protected override void OnMouseUp(MouseEventArgs e)
    {
        if (SelectedIndexChanging)
        {
            base.OnSelectedIndexChanged(EventArgs.Empty);
            SelectedIndexChanging = false;
        }

        base.OnMouseUp(e);
    }

    protected override void OnKeyUp(KeyEventArgs e)
    {
        if (SelectedIndexChanging)
        {
            base.OnSelectedIndexChanged(EventArgs.Empty);
            SelectedIndexChanging = false;
        }

        base.OnKeyUp(e);
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-07-07T02:06:32.610

计时器是最好的整体解决方案。

Jens 的建议的一个问题是，一旦列表中有很多选定项目（数千个或更多），获取选定项目的列表就开始需要很长时间。

与其每次发生 SelectedIndexChanged 事件时都创建一个计时器对象，不如将一个永久性的对象放在设计器的表单上，并让它检查类中的布尔变量以查看它是否应该调用更新函数。

例如：

```
bool timer_event_should_call_update_controls = false;

private void lvwMyListView_SelectedIndexChanged(object sender, EventArgs e) {

  timer_event_should_call_update_controls = true;
}

private void UpdateControlsTimer_Tick(object sender, EventArgs e) {

  if (timer_event_should_call_update_controls) {
    timer_event_should_call_update_controls = false;

    update_controls();
  }
} 
```

如果您只是将信息用于显示目的，例如更新状态栏以显示“X out of Y selected”，则此方法可以正常工作。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2010-09-06T11:53:58.740

标志适用于 Windows 窗体/Web 窗体/移动窗体的 OnLoad 事件。在单选Listview中，不是多选，下面的代码实现起来很简单，并且可以防止多次触发事件。

当 ListView 取消选择第一个项目时，第二个项目是您需要的，并且集合应该只包含一个项目。

在移动应用程序中使用了以下相同的内容，因此某些集合名称可能与使用紧凑框架时有所不同，但适用相同的原则。

注意：确保 OnLoad 并填充您设置要选择的第一个项目的列表视图。

```
// ################ CODE STARTS HERE ################
//Flag  to create at the form level
System.Boolean lsvLoadFlag = true;

//Make sure to set the flag to true at the begin of the form load and after
private void frmMain_Load(object sender, EventArgs e)
{
    //Prevent the listview from firing crazy in a single click NOT multislect environment
    lsvLoadFlag = true;

    //DO SOME CODE....

    //Enable the listview to process events
    lsvLoadFlag = false;
}

//Populate First then this line of code
lsvMain.Items[0].Selected = true;

//SelectedIndexChanged Event
 private void lsvMain_SelectedIndexChanged(object sender, EventArgs e)
{
    ListViewItem lvi = null;

    if (!lsvLoadFlag)
    {
        if (this.lsvMain.SelectedIndices != null)
        {
            if (this.lsvMain.SelectedIndices.Count == 1)
            {
                lvi = this.lsvMain.Items[this.lsvMain.SelectedIndices[0]];
            }
        }
    }
}
################ CODE END HERE    ################ 
```

理想情况下，应将此代码放入 UserControl 中，以便在单个选择 ListView 中轻松重用和分发。这段代码在多选中用处不大，因为该事件按其应有的行为工作。

我希望这会有所帮助。

亲切的问候，

Anthony N. Urwin
 [http://www.manatix.com](http://www.manatix.com)

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2017-02-21T18:44:54.853

您可以使用`async`& `await`：

```
private bool waitForUpdateControls = false;

private async void listView_SelectedIndexChanged(object sender, EventArgs e)
{
    // To avoid thousands of needless ListView.SelectedIndexChanged events.

    if (waitForUpdateControls)
    {
        return;
    }

    waitForUpdateControls = true;

    await Task.Delay(100);

    waitForUpdateControls = false;

    UpdateControls();

    return;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2008-09-17T19:47:53.310

我会尝试将回发绑定到一个按钮，以允许用户提交他们的更改并取消挂钩事件处理程序。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2008-09-17T19:48:10.187

我昨天只是想解决这个问题。我不知道您所说的“驻留”计时器究竟是什么意思，但我尝试实现我自己的版本，等待所有更改完成。不幸的是，我能想到的唯一方法是在一个单独的线程中，事实证明，当您创建一个单独的线程时，您的 UI 元素在该线程中是不可访问的。.NET 引发异常，说明 UI 元素只能在创建元素的线程中访问！因此，我找到了一种方法来优化我对 SelectedIndexChanged 的​​响应，并使其足够快到可以忍受的地方——尽管它不是一个可扩展的解决方案。让我们希望有人有一个聪明的主意来在一个线程中解决这个问题。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2009-06-19T16:51:41.050

也许这可以帮助您在不使用计时器的情况下完成所需的工作：

[http://www.dotjem.com/archive/2009/06/19/20.aspx](http://www.dotjem.com/archive/2009/06/19/20.aspx)

我不喜欢计时器等的用户。正如我在帖子中所说的那样......

希望能帮助到你...

哦，我忘了说，它是 .NET 3.5，我正在使用 linq 中的一些功能来完成“选择更改评估”，如果你可以称之为 oO..

无论如何，如果您使用的是旧版本，则必须使用更多代码来完成此评估... >.<...

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2009-07-07T02:14:11.993

如果列表视图有几百或几千个项目，我建议虚拟化它。

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2009-07-07T08:27:50.520

梅隆 >>>

我们的目标是永远不会处理数百个项目以上的列表，但是......我已经测试了 10.000 个项目的整体用户体验，并且一次选择了 1000-5000 个项目（以及两个 Selected 中的 1000-3000 个项目的变化）并取消选择）...

计算的总持续时间从未超过 0.1 秒，一些最高测量值为 0.04 秒，我发现这么多项目完全可以接受。

在 10.000 个项目中，仅初始化列表需要 10 多秒，所以在这一点上，我会认为其他事情已经开始发挥作用，正如 Joe Chung 所指出的虚拟化。

也就是说，应该清楚的是，代码并不是计算选择差异的最佳解决方案，如果需要，这可以通过各种方式进行很多改进，我专注于用代码理解概念而不是比性能。

但是，如果您遇到性能下降的问题，我对以下一些非常感兴趣：

*   列表中有多少项？

*   一次选择/取消选择多少个元素？

*   事件筹集大约需要多长时间？

*   硬件平台？

*   更多关于使用案例？

*   你能想到的其他相关信息？

否则，帮助改进解决方案并不容易。

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2009-07-07T08:32:09.060

保留`ListView`所有旧控件。

结交`DataGridView`你的朋友，一切都会好起来的：）

* * *

## 回答 #13

> 赞同：0
> 
>             
> 
> 时间：2010-10-28T18:10:59.370

Raymond Chen[有一篇博文（可能）解释了*为什么*会有数千个变更事件](http://blogs.msdn.com/b/oldnewthing/archive/2010/10/28/10081818.aspx)，而不仅仅是一个：

> [当已经有一个非常好的 LVN_ITEMCHANGED 通知时，为什么还有一个 LVN_ODSTATECHANGED 通知？](http://blogs.msdn.com/b/oldnewthing/archive/2010/10/28/10081818.aspx)
> 
>   
>   
> 
> ...通知告诉您指定范围内所有项目的状态已更改
> 
>   。这是为 range 中的所有项目`LVN_ODSTATECHANGED`发送个人的简写。如果您有一个包含 500,000 个项目的 ownerdata 列表视图，并且有人选择了全部，您会很高兴收到一个
>   通知，而
>   不是 50 万个单独的小
>   通知。`LVN_ITEMCHANGED``[iFrom..iTo]``LVN_ODSTATECHANGED``iFrom=0``iTo=499999``LVN_ITEMCHANGED`

我说*可能*解释了原因，因为不能保证 .NET 列表视图是 Listview 公共控件的包装器——这是一个可以随时更改的实现细节（尽管几乎可以肯定永远不会更改）。

提示的解决方案是在虚拟模式下使用 .NET 列表视图，使控件更难使用一个数量级。

* * *

## 回答 #14

> 赞同：0
> 
>             
> 
> 时间：2011-08-10T03:49:02.787

我可能有更好的解决方案。

我的情况：

*   单选列表视图（而不是多选）

*   我想避免在触发取消选择先前选择的项目时处理该事件。

我的解决方案：

*   记录用户在 MouseDown 上单击的项目

*   如果此项不为空且 SelectedIndexes.Count == 0，则忽略 SelectedIndexChanged 事件

代码：

```
ListViewItem ItemOnMouseDown = null;
private void lvTransactions_MouseDown(object sender, MouseEventArgs e)
{
    ItemOnMouseDown = lvTransactions.GetItemAt(e.X, e.Y);
}
private void lvTransactions_SelectedIndexChanged(object sender, EventArgs e)
{
    if (ItemOnMouseDown != null && lvTransactions.SelectedIndices.Count == 0)
        return;

    SelectedIndexDidReallyChange();

} 
```

# objective-c - 在 Objective-C 中连接委托类

> ID：86797
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2008-09-17T19:38:53.500
> 
>         
> 
> 标签：objective-c, cocoa, interface-builder

我的 Interface Builder 文件中有两个控件，每个控件我都在代码中创建了一个单独的委托类（Control1Delegate 和 Control2Delegate）。我在界面生成器中创建了两个“对象”，将它们设为该类型，并将控件作为委托连接到它们。代表们工作得很好。我的问题是，我需要将信息从一位代表分享给另一位代表，但我不确定如何。

做这个的最好方式是什么？将两个代表组合成一个类，或者以某种方式访问​​他们都可以阅读的第三个类？由于我实际上并未在代码中的任何位置初始化该类，因此我不确定如何获取对它的实际实例的引用（如果有它的实际实例），甚至不知道如何访问“主”类该项目随之而来。

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2008-09-17T21:51:37.100

您可以将任一代表的出口添加到另一个代表。有两种方法可以向 IB 中的对象添加插座（假设您使用的是 Xcode/IB 3.0 或更高版本：

1.  如果您还没有为您的委托类生成代码，请选择所需的委托，然后在 IB 检查器中打开“对象身份”选项卡。添加一个 NSObject 类型的“类出口”。然后，您应该能够将此新出口设置给其他代表。当然，您必须为您的委托类生成代码并将生成的源文件添加到您的 Xcode 项目中，然后才能加载 nib。

2.  如果您已经为委托类生成了代码（或向您的 NIB 添加了一个 NSObject 并将其 Class 设置为 Xcode 项目中的现有类），请向委托类添加一个实例变量：

    `IBOutlet id outletToOtherDelegate;`

    只要您的 Xcode 项目处于打开状态（如您的 NIB 窗口左下角的绿色气泡所示），IB 就会自动检测新的插座并允许您将其分配给您的 NIB 中的另一个委托对象。

Cocoa 在 NIB 加载时自动连接这些插座。一旦`awakeFromNib`在您的委托对象的实例上调用，您可能会假设 NIB 中的所有其他对象都已实例化并且所有出口都已连接。但是，您不应该在调用 时假设订单`awakeFromNib`。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-09-17T19:49:26.893

我认为您可以在每个插座上创建插座并交叉绑定它们，以便它们始终拥有相同的数据。如果他们需要共享一个模型对象，那就很整洁了。我实际上不知道该怎么做。我想我曾经在 iPhone 教程中看到过！

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-09-17T19:49:58.530

由于我在工作，目前我面前没有我的 Mac，但是是否可以将一个代表的实例绑定到另一个代表的成员？例如，这类似于将 NSArrayController 绑定到另一个控制器类的成员。

但是，取决于委托类正在做什么，如果任务相似，我可能会将它们组合到一个类中。那将完全消除问题。

# wordpress - Wordpress style.css 模板元素的语法在任何地方都可用吗？

> ID：86800
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-09-17T19:39:00.210
> 
>         
> 
> 标签：wordpress, wordpress-theming, css

我最近开始了 Wordpress 主题的*盛大之旅*，我一直在阅读 Wordpress 文档以了解如何编写主题。[我在这里](http://codex.wordpress.org/Theme_Development)遇到的一件事是该`style.css`文件必须包含特定的标题才能被 Wordpress 引擎使用。他们给出了一个简短的例子，但我无法对`style.css`标题部分必须包含的内容进行任何正式描述。这在 Wordpress 网站上是否存在？如果不能，我们可以在这里描述它吗？

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2008-09-17T19:44:12.943

基于[http://codex.wordpress.org/Theme_Development](http://codex.wordpress.org/Theme_Development)：

以下是样式表前几行的示例，称为样式表标题，用于主题“Rose”：

```
/*   
Theme Name: Rose
Theme URI: the-theme's-homepage
Description: a-brief-description
Author: your-name
Author URI: your-URI
Template: use-this-to-define-a-parent-theme--optional
Version: a-number--optional
Tags: a-comma-delimited-list--optional
.
General comments/License Statement if any.
.
*/ 
```

最简单的主题只包含一个 style.css 文件，如果有的话，还包括图片。要创建这样的主题，您必须通过编辑 style.css 标题注释中的 Template: 行来指定要继承的一组模板以与主题一起使用。例如，如果您希望主题“Rose”从另一个名为“test”的主题继承模板，您可以在 Rose 的 style.css 开头的注释中包含 Template:test。现在“test”是“Rose”的父主题，它仍然只包含一个 style.css 文件和伴随的图像，所有这些都位于目录 wp-content/themes/Rose 中。（请注意，指定父主题将继承该主题的所有模板文件——这意味着子主题目录中的任何模板文件都将被忽略。）

WordPress 需要 style.css 中的注释标题行才能识别主题并将其显示在“设计”>“主题”下的“管理面板”中，作为可用的主题选项以及任何其他已安装的主题。

主题名称、版本、作者和作者 URI 字段由 WordPress 解析，并用于在当前主题信息顶行的当前主题区域中显示该数据，其中作者姓名超链接到作者 URI。描述和标签字段被解析并显示在主题信息的主体中，如果主题有父主题，则该信息也被放置在信息主体中。在可用主题部分中，仅使用主题名称、描述和标签字段。

None of these fields have any restrictions - all are parsed as strings.  In addition, none of them are required in the code, though in practice the fields not marked as optional in the list above are all used to provide contextual information to the WordPress administrator and should be included for all themes.

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-09-17T19:42:40.170

你可能在想这个：

```
/*
THEME NAME: Parallax
THEME URI: http://parallaxdenigrate.net
VERSION: .1
AUTHOR: Martin Jacobsen
AUTHOR URI: http://martinjacobsen.no
*/ 
```

如果我没有离开，Wordpress 会使用此信息显示在管理后端的“激活设计”对话框中。

# java - Why would a "java.net.ConnectException: Connection timed out" exception occur when URL is up?

> ID：86824
> 
>         
> 
> 赞同：91
> 
>         
> 
> 时间：2008-09-17T19:40:57.367
> 
>         
> 
> 标签：java, connection, urlconnection, connectexception

I'm getting a `ConnectException: Connection timed out` with some frequency from my code.  The URL I am trying to hit is up.  The same code works for some users, but not others.  It seems like once one user starts to get this exception they continue to get the exception.

Here is the stack trace:

```
java.net.ConnectException: Connection timed out
Caused by: java.net.ConnectException: Connection timed out
    at java.net.PlainSocketImpl.socketConnect(Native Method)
    at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:333)
    at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:195)
    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:182)
    at java.net.Socket.connect(Socket.java:516)
    at java.net.Socket.connect(Socket.java:466)
    at sun.net.NetworkClient.doConnect(NetworkClient.java:157)
    at sun.net.www.http.HttpClient.openServer(HttpClient.java:365)
    at sun.net.www.http.HttpClient.openServer(HttpClient.java:477)
    at sun.net.www.http.HttpClient.<init>(HttpClient.java:214)
    at sun.net.www.http.HttpClient.New(HttpClient.java:287)
    at sun.net.www.http.HttpClient.New(HttpClient.java:299)
    at sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:796)
    at sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:748)
    at sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:673)
    at sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:840) 
```

Here is a snippet from my code:

```
URLConnection urlConnection = null;
OutputStream outputStream = null;
OutputStreamWriter outputStreamWriter = null;
InputStream inputStream = null;

try {
    URL url = new URL(urlBase);
    urlConnection = url.openConnection();
    urlConnection.setDoOutput(true);

    outputStream = urlConnection.getOutputStream(); // exception occurs on this line
    outputStreamWriter = new OutputStreamWriter(outputStream);
    outputStreamWriter.write(urlString);
    outputStreamWriter.flush();
    inputStream = urlConnection.getInputStream();
    String response = IOUtils.toString(inputStream);
    return processResponse(urlString, urlBase, response);
} catch (IOException e) {
    throw new Exception("Error querying url: " + urlString, e);
} finally {
    IoUtil.close(inputStream);
    IoUtil.close(outputStreamWriter);
    IoUtil.close(outputStream);
} 
```

* * *

## 回答 #1

> 赞同：90
> 
>             
> 
> 时间：2008-09-17T19:48:33.120

连接超时（假设一个本地网络和多个客户端机器）通常是由

a) 途中的某种防火墙，它只是简单地吃掉数据包而不告诉发送者诸如“没有到主机的路由”之类的事情

b) 网络配置错误或线路过载导致丢包

c) 过多的请求使服务器过载

d) 服务器上有少量同时可用的线程/进程，导致所有线程/进程都被占用。这尤其适用于需要很长时间才能运行并且可能与 c) 结合的请求。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：34
> 
>             
> 
> 时间：2008-09-17T20:12:03.343

如果 URL 在同一台机器上的 Web 浏览器中工作正常，则可能是 Java 代码没有使用浏览器用于连接到 URL 的 HTTP 代理。

* * *

## 回答 #3

> 赞同：7
> 
>             
> 
> 时间：2017-05-16T06:52:16.273

错误消息说明了一切：您的连接超时。这意味着您的请求在某些（默认）时间范围内没有得到响应。未收到回复的原因可能是以下之一：

a) IP/域或端口不正确

b) IP/域或端口（即服务）已关闭

c) IP/域的响应时间超过您的默认超时时间

d) 您有防火墙阻止您使用的任何端口上的请求或响应

e）您有一个防火墙阻止对该特定主机的请求

f) 您的互联网访问已关闭

g）您的实时服务器已关闭，即在“rest-API call”的情况下。

请注意，您的 ISP 可能会设置防火墙和端口或 IP 阻止

* * *

## 回答 #4

> 赞同：5
> 
>             
> 
> 时间：2008-09-17T20:34:54.380

我建议在获取输出流之前提高连接超时时间，如下所示：

```
urlConnection.setConnectTimeout(1000); 
```

其中 1000 以毫秒为单位（1000 毫秒 = 1 秒）。

* * *

## 回答 #5

> 赞同：4
> 
>             
> 
> 时间：2008-11-29T15:20:30.150

*   尝试执行 Telnet 以查看任何防火墙问题

*   执行`tracert`/`traceroute`查找跳数

* * *

## 回答 #6

> 赞同：3
> 
>             
> 
> 时间：2017-12-01T14:04:00.483

我解决了我的问题：

```
System.setProperty("https.proxyHost", "myProxy");
System.setProperty("https.proxyPort", "80"); 
```

或`http.proxyHost`...

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2020-04-28T13:59:38.280

> 为什么 URL 启动时会出现“java.net.ConnectException: Connection timed out”异常？

因为 URLConnection (HttpURLConnection/HttpsURLConnection) 不稳定。[您可以在此处](https://stackoverflow.com/questions/3877572)和[此处](https://stackoverflow.com/questions/34704045)阅读有关此内容的信息。我们的解决方案是两件事：

a) 通过设置 ContentLength`setFixedLengthStreamingMode`

b) 捕获任何 TimeoutException 并在失败时重试。

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2014-04-16T03:57:45.297

这可能是 IPv6 问题（主机发布 IPv6 AAAA-Address 并且用户主机认为它已配置为 IPv6，但实际上连接不正确）。这也可能是网络 MTU 问题、防火墙阻塞，或者目标主机可能发布了不同的 IP 地址（随机或基于发起者国家/地区），这些地址并非都可以访问。或类似的网络问题。

除了设置超时和添加好的错误消息（尤其是打印出主机的解析地址）之外，您无能为力。如果您想让它更健壮，请添加重试，并行尝试所有地址，并查看 Java 平台上的名称解析缓存（正面和负面）。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2008-09-17T19:45:37.103

您的 IP/主机有可能被远程主机阻止，特别是如果它认为您对它的打击太大了。

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2016-04-19T18:21:38.827

这发生在我身上的原因是远程服务器只允许某些 IP 地址而不是它自己的 IP，并且我试图从服务器的 URL 呈现图像......所以一切都会停止，显示你的超时错误有...

确保服务器允许其自己的 IP，或者您正在从实际存在的某个远程 URL 呈现内容。

# javascript - Javascript 数组参考

> ID：86849
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-09-17T19:43:16.923
> 
>         
> 
> 标签：javascript, json

如果我有以下情况：

```
{"hdrs": ["Make","Model","Year"],
 "data" : [ 
   {"Make":"Honda","Model":"Accord","Year":"2008"}
   {"Make":"Toyota","Model":"Corolla","Year":"2008"}
   {"Make":"Honda","Model":"Pilot","Year":"2008"}]
} 
```

而且我有一个“hdrs”名称（即“Make”），我如何引用`data`数组实例？似乎`data["Make"][0]`应该工作......但无法获得正确的参考

**编辑** 

很抱歉模棱两可.. 我可以循环`hdrs`获取每个 hdr 名称，但我需要使用每个实例值`hdrs`来查找其中的所有数据元素`data`（不确定这是更好的解释）。我会把它放在一个变量中，`t`因为它是 JSON（感谢重新标记）我希望能够用这样的东西来引用：`t.data[hdrs[i]][j]`

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2008-09-17T19:49:56.703

我不得不稍微改变你的代码：

```
var x = {"hdrs": ["Make","Model","Year"],
         "data" : [ 
           {"Make":"Honda","Model":"Accord","Year":"2008"},
           {"Make":"Toyota","Model":"Corolla","Year":"2008"},
           {"Make":"Honda","Model":"Pilot","Year":"2008"}]
        };

        alert( x.data[0].Make ); 
```

编辑：响应您的编辑

```
var x = {"hdrs": ["Make","Model","Year"],
         "data" : [ 
           {"Make":"Honda","Model":"Accord","Year":"2008"},
           {"Make":"Toyota","Model":"Corolla","Year":"2008"},
           {"Make":"Honda","Model":"Pilot","Year":"2008"}]
        };
var Header = 0; // Make
for( var i = 0; i <= x.data.length - 1; i++ )
{
    alert( x.data[i][x.hdrs[Header]] );
} 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-09-17T19:50:46.717

首先，您忘记了**数据**数组项中的尾随逗号。

尝试以下操作：

```
var obj_hash = {
    "hdrs": ["Make", "Model", "Year"],
    "data": [
        {"Make": "Honda", "Model": "Accord", "Year": "2008"},
        {"Make": "Toyota", "Model": "Corolla", "Year": "2008"},
        {"Make": "Honda", "Model": "Pilot", "Year": "2008"},
    ]
};

var ref_data = obj_hash.data;

alert(ref_data[0].Make);
```

@Kent Fredric：请注意，最后一个逗号不是绝对需要的，但可以让您更轻松地移动行（即，如果您在最后一行之后移动或添加，并且它没有逗号，则必须具体记得加一个）。我认为最好总是有尾随逗号。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-09-17T19:48:38.050

那么，像这样吗？

```
var theMap = /* the stuff you posted */;
var someHdr = "Make";
var whichIndex = 0;
var correspondingData = theMap["data"][whichIndex][someHdr]; 
```

如果我理解正确的话，那应该可以...

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-09-17T19:50:04.350

```
var x = {"hdrs": ["Make","Model","Year"],
 "data" : [ 
   {"Make":"Honda","Model":"Accord","Year":"2008"}
   {"Make":"Toyota","Model":"Corolla","Year":"2008"}
   {"Make":"Honda","Model":"Pilot","Year":"2008"}]
};

x.data[0].Make == "Honda"
x['data'][0]['Make']  == "Honda" 
```

你有你的数组/哈希查找向后:)

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2008-09-17T19:50:55.423

我不确定我是否理解你的问题，但是......

假设上面的 JSON 是 var obj，你想要：

```
obj.data[0]["Make"] // == "Honda" 
```

如果您只想引用第一个标头引用的字段，则类似于：

```
obj.data[0][obj.hdrs[0]] // == "Honda" 
```

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2008-09-17T19:47:50.360

也许试试 data[0].Make

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2008-09-17T19:48:18.563

关闭，你会使用

```
var x = data[0].Make;
var z = data[0].Model;
var y = data[0].Year; 
```

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2008-09-17T19:50:36.330

您显示的代码在语法上不正确；它需要一些逗号。我得到了这个工作：

```
$foo = {"hdrs": ["Make","Model","Year"],
 "data" : [ 
   {"Make":"Honda","Model":"Accord","Year":"2008"},
   {"Make":"Toyota","Model":"Corolla","Year":"2008"},
   {"Make":"Honda","Model":"Pilot","Year":"2008"}]
}; 
```

然后我可以访问数据：  

```
$foo["data"][0]["make"] 
```

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2008-09-17T20:36:48.713

在答案的帮助下（并且在内部和外部循环正确之后）我得到了这个工作：

```
var t = eval( "(" + request + ")" ) ;
for (var i = 0; i < t.data.length; i++) {
 myTable +=    "<tr>";
 for (var j = 0; j < t.hdrs.length; j++) {
  myTable += "<td>" ;
   if (t.data[i][t.hdrs[j]] == "") {myTable += "&nbsp;" ; }
    else { myTable += t.data[i][t.hdrs[j]] ; }
  myTable += "</td>";
 }
 myTable +=    "</tr>";
} 
```

# db2 - DB2 传输组件未正确注册

> ID：86863
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-09-17T19:44:24.610
> 
>         
> 
> 标签：db2, biztalk, biztalk-2006

我正在尝试测试`DB2 adapter`BizTalk **2006**（不是 R2）。

在尝试在应用程序中配置实例时，我收到一条错误消息：

> DB2 传输组件未正确注册

环境是 2 个 BizTalk 服务器共享一个消息框。

DB2 适配器在第一台服务器上运行良好。这是我遇到问题的第二台服务器。

我已经从第一台服务器导出了 .msi 文件，然后将它们安装到第二台服务器上并将它们导入 BizTalk。我使用的所有其他适配器在两台服务器上都可以正常工作。

*   Google 搜索并没有提供很多关于 BizTalk DB2 适配器故障排除的信息。

*   进一步的故障排除表明，用于主机系统的 MS BizTalk 适配器已安装在两台计算机上。但是，它仅在给我问题的机器上配置。

*   我已经取消配置它，但这仍然没有帮助。

*   我已经仔细检查了两台服务器上的 DB2 适配器的 .dll 版本号是否相同，并确保它们已安装在 GAC 中。

*   这些都没有帮助。

以前有没有人遇到过这样的问题，或者指出我在哪里寻找 BizTalk DB2 适配器故障排除指南？

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2008-09-20T04:19:58.730

当出现“已注册”字样时，我想到的是 COM 组件的注册，而不是 .NET 程序集的安装。DB2 适配器使用的底层驱动程序是**Microsoft ODBC Driver for DB2**。您可能需要检查您的 ODBC DSN 控制面板是否显示该特定驱动程序以供您配置 DSN。

我建议重新安装适用于主机系统的适配器包。

# java - 为什么无论配置如何，根记录器都会收集所有日志类型？

> ID：86878
> 
>         
> 
> 赞同：41
> 
>         
> 
> 时间：2008-09-17T19:45:48.477
> 
>         
> 
> 标签：java, logging, log4j

我遇到的问题是，即使我在根标记中将级别指定为 ERROR，指定的附加程序也会将所有级别（调试、信息、警告）记录到文件中，而不管设置如何。我不是 Log4j 专家，因此不胜感激。

我已经检查了 log4j.properties 的类路径（没有），除了 log4j.xml。

这是 log4j.xml 文件：

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE log4j:configuration SYSTEM "log4j.dtd">
<log4j:configuration xmlns:log4j='http://jakarta.apache.org/log4j/'>

    <!-- ============================== -->
    <!-- Append messages to the console -->
    <!-- ============================== -->

    <appender name="console" class="org.apache.log4j.ConsoleAppender">
        <param name="Target" value="System.out" />

        <layout class="org.apache.log4j.PatternLayout">
            <!-- The default pattern: Date Priority [Category] Message\n -->
            <param name="ConversionPattern" value="[AC - %5p] [%d{ISO8601}] [%t] [%c{1} - %L] %m%n" />
        </layout>
    </appender>

    <appender name="logfile" class="org.apache.log4j.RollingFileAppender">
        <param name="File" value="./logs/server.log" />
        <param name="MaxFileSize" value="1000KB" />
        <param name="MaxBackupIndex" value="2" />
        <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern" value="[AC - %-5p] {%d{dd.MM.yyyy - HH.mm.ss}} %m%n" />
        </layout>
    </appender>

    <appender name="payloadAppender" class="org.apache.log4j.RollingFileAppender">
        <param name="File" value="./logs/payload.log" />
        <param name="MaxFileSize" value="1000KB" />
        <param name="MaxBackupIndex" value="10" />
        <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern" value="[AC - %-5p] {%d{dd.MM.yyyy - HH.mm.ss}} %m%n" />
        </layout>
    </appender>

    <appender name="errorLog" class="org.apache.log4j.RollingFileAppender">
        <param name="File" value="./logs/error.log" />
        <param name="MaxFileSize" value="1000KB" />
        <param name="MaxBackupIndex" value="10" />
        <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern" value="[AC - %-5p] {%d{dd.MM.yyyy - HH.mm.ss}} %m%n" />
        </layout>
    </appender>

    <appender name="traceLog"
        class="org.apache.log4j.RollingFileAppender">
        <param name="File" value="./logs/trace.log" />
        <param name="MaxFileSize" value="1000KB" />
        <param name="MaxBackupIndex" value="20" />

        <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern"
                value="[AccessControl - %-5p] {%t: %d{dd.MM.yyyy - HH.mm.ss,SSS}} %m%n" />
        </layout>
    </appender>

    <appender name="traceSocketAppender" class="org.apache.log4j.net.SocketAppender">
        <param name="remoteHost" value="localhost" />
        <param name="port" value="4445" />
        <param name="locationInfo" value="true" />
    </appender>

    <logger name="TraceLogger">
        <level value="trace" /> <!-- Set level to trace to activate tracing -->
        <appender-ref ref="traceLog" />     
    </logger>

    <logger name="org.springframework.ws.server.endpoint.interceptor">
        <level value="DEBUG" />
        <appender-ref ref="payloadAppender" />
    </logger>

    <root>
        <level value="error" />
        <appender-ref ref="errorLog" />
    </root>

</log4j:configuration> 
```

如果我用另一个记录器替换根，那么指定的附加程序根本不会记录任何内容。

```
<logger name="com.mydomain.logic">
    <level value="error" />
    <appender-ref ref="errorLog" />
</logger> 
```

* * *

## 回答 #1

> 赞同：76
> 
>             
> 
> 时间：2010-08-13T08:23:05.957

根记录器位于记录器层次结构的顶部。它在三个方面与众不同：

*   它一直存在，

*   它的级别不能设置为空

*   它无法通过名称检索。

**rootLogger 是所有 appender 的父亲。给定记录器的每个启用的日志记录请求都将转发到该记录器中的所有附加程序以及层次结构中更高的附加程序（包括 rootLogger）**

例如，如果将`console`appender 添加到`root logger`，那么所有启用的日志记录请求将**至少**打印在控制台上。如果另外一个文件附加器被添加到一个记录器，比如说`L`，那么启用的日志记录请求`L`和`L's`子级将打印在一个文件**和**. **可以通过将 additivity 标志设置为 false**`console`来覆盖此默认行为，以便 appender 累积不再是相加的。

 ***来自 log4j 手册*

总结一下：

如果您不想将日志记录事件传播到父记录器（例如 rootLogger），则在这些记录器中将可加性标志添加为 false。在你的情况下：

```
<logger name="org.springframework.ws.server.endpoint.interceptor"
        additivity="false">
        <level value="DEBUG" />
        <appender-ref ref="payloadAppender" />
</logger> 
```

在标准 log4j 配置样式中（我更喜欢 XML）：

```
log4j.logger.org.springframework.ws.server.endpoint.interceptor = INFO, payloadAppender
log4j.additivity.org.springframework.ws.server.endpoint.interceptor = false 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：9
> 
>             
> 
> 时间：2008-09-17T20:12:37.820

使用 -Dlog4j.debug 运行您的程序，以便标准输出获取有关如何配置 log4j 的信息——我怀疑它没有按照您认为的方式配置。

* * *

## 回答 #3

> 赞同：6
> 
>             
> 
> 时间：2008-09-17T20:16:03.973

补充一下 James AN Stauffer 和愤世嫉俗者所说的 - 我敢打赌，除了您希望使用的类路径之外，还有另一个 log4j.xml / log4j.properties 导致 log4j 以它的方式配置自己。

`-Dlog4j.debug`是解决任何 log4j 问题的绝对杀手级方法。

* * *

## 回答 #4

> 赞同：5
> 
>             
> 
> 时间：2008-09-17T19:50:34.283

两件事：检查可加性并决定是否希望由更详细的日志记录级别捕获的日志事件传播到根记录器。

其次，检查根记录器的级别。此外，您还可以在 appender 本身上添加过滤，但这通常不是必需的。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2008-09-17T21:03:33.797

如果您使用的是`log4j.properties`文件，则该文件通常应位于类路径的根目录中，因此请确保它在那里。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2010-05-03T14:58:29.567

这是正确的行为。根记录器就像默认行为一样。因此，如果您不指定任何记录器，它会将根记录器级别作为默认级别，但这并不意味着根记录器级别是您所有日志的级别。

您使用“TraceLogger”记录器或“org.springframework.ws.server.endpoint.interceptor”记录器记录的任何代码将分别使用 TRACE 和 DEBUG 级别记录消息，任何其他代码将使用根记录器使用级别记录消息，即在你的情况下是错误的。

因此，如果您使用 root 以外的 logger，root 日志级别将被该 logger 的日志级别覆盖。要获得所需的输出，请将其他两个日志级别更改为 ERROR。

我希望这是有帮助的。

# java - 在 GWT 中创建一个流体面板来填充页面？

> ID：86901
> 
>         
> 
> 赞同：18
> 
>         
> 
> 时间：2008-09-17T19:48:15.710
> 
>         
> 
> 标签：java, gwt

我想要 GWT 中的面板来填充页面，而无需实际设置大小。有没有办法做到这一点？目前我有以下内容：

```
public class Main  implements EntryPoint
{
    public void onModuleLoad()
    {
        HorizontalSplitPanel split = new HorizontalSplitPanel();
        //split.setSize("250px", "500px");
        split.setSplitPosition("30%");

        DecoratorPanel dp = new DecoratorPanel();
        dp.setWidget(split);

        RootPanel.get().add(dp);
    }

} 
```

使用前面的代码片段，什么都没有显示。是否有我缺少的方法调用？

谢谢。

* * *

**2008 年 9 月 17 日 20:15 更新**  

我在每一侧都放了一些按钮（明确设置它们的大小），但这仍然不起作用。我真的很惊讶没有像 FillLayout 类或 setFillLayout 方法或 setDockStyle(DockStyle.Fill) 或类似的东西。也许这是不可能的？但是像 GWT 一样流行，我认为这是可能的。

**2008 年 9 月 18 日 14:38 更新**  

我尝试将 RootPanel 的宽度和高度设置为 100%，但仍然无法正常工作。不过感谢您的建议，这似乎可能会奏效。还有什么建议吗？？

* * *

## 回答 #1

> 赞同：19
> 
>             
> 
> 时间：2009-06-06T02:23:35.237

Google 在其常见问题解答之一中回答了您问题的主要部分：
 [http ://code.google.com/webtoolkit/doc/1.6/FAQ_UI.html#How_do_I_create_an_app_that_fills_the_page_vertically_when_the_b](http://code.google.com/webtoolkit/doc/1.6/FAQ_UI.html#How_do_I_create_an_app_that_fills_the_page_vertically_when_the_b)

要点是您不能将高度设置为 100%，您必须执行以下操作：

```
final VerticalPanel vp = new VerticalPanel();
vp.add(mainPanel);
vp.setWidth("100%");
vp.setHeight(Window.getClientHeight() + "px");
Window.addResizeHandler(new ResizeHandler() {

  public void onResize(ResizeEvent event) {
    int height = event.getHeight();
    vp.setHeight(height + "px");
  }
});
RootPanel.get().add(vp); 
```

* * *

## 回答 #2

> 赞同：13
> 
>             
> 
> 时间：2012-05-23T15:44:59.970

本的回答很好，但也过时了。在 GWT 1.6 中需要调整大小处理程序，但我们现在是 2.4。您可以使用[DockLayoutPanel](http://google-web-toolkit.googlecode.com/svn/javadoc/2.0/com/google/gwt/user/client/ui/DockLayoutPanel.html)让您的内容垂直填充页面。请参阅使用此面板的[示例邮件应用程序。](http://gwt.google.com/samples/Mail/Mail.html)

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-09-17T19:59:27.837

我认为您需要在拆分的左侧和/或右侧放置一些东西（split.setLeftWidget（widget），split.setRightWidget（widget）或split.add（widget），它将首先添加到左侧，然后右侧），以便显示任何内容。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-09-18T00:00:28.927

在添加小部件之前，尝试将根面板的宽度和/或高度设置为 100%。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2008-09-18T21:13:13.970

面板会自动调整到最小的可见宽度。因此，您必须将添加到 RootPanel 的每个面板的大小调整为 100%，包括您的 SplitPanel。RootPanel 本身不需要调整大小。所以试试：

```
split.setWidth("100%");
split.setHeight("100%"); 
```

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2008-09-19T18:01:14.270

[DecoratorPanel](http://google-web-toolkit.googlecode.com/svn/javadoc/1.5/com/google/gwt/user/client/ui/DecoratorPanel.html)的文档说：

> 如果设置 DecoratorPanel 的宽度或高度，则需要将 middleCenter 单元格的高度和宽度设置为 100%，以便 middleCenter 单元格占用所有可用空间。如果不设置 DecoratorPanel 的宽度和高度，它将紧紧包裹其内容。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-01-18T23:38:42.003

问题是 DecoratorPanel middleCenter 单元格将默认填充您的内容，而 SplitPanel 不允许“100%”样式大小设置。做你想做的事，在你的 CSS 上适当地设置表格的样式：

.gwt-DecoratorPanel .middleCenter { 高度：100%; 宽度：100%；}

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2015-07-21T10:03:42.077

对我来说，如果我只是将宽度设置为

> panel.setWidth("100%");

该面板是一个 VerticalPanel，它只是随机大小，我不知道它来自哪里。但是在我添加以下行之后，@Ben Bederson 的评论对我来说效果很好：

> panel.setWidth(Window.getClientWidth() + "px");

仅此而已，没有别的。谢谢

# php - 在同一页面上打开基于 Javascript 的弹出广告

> ID：86902
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2008-09-17T19:48:18.423
> 
>         
> 
> 标签：php, javascript, html

我拥有一个图像托管网站，并希望每天为每位访问者生成一个弹出窗口。对我来说，最简单的方法是编写一个名为子域的 php 脚本，例如 ads1.sitename.com ads2.sitename.com

不幸的是，我的大多数广告商都希望给我一个 javascript 代码块来使用而不是直接链接，所以我不能只使单个子域标题重定向。我宁愿使用子域这样我可以管理多个广告商而无需更改页面上的任何代码，只需在我的 php 管理页面中进行代码。关于如何将此 jscript 粘贴到页面中的任何想法，因此我无需担心空白 ads1.sitename.com 以及弹出窗口的出现？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-09-17T20:09:26.080

我怀疑你会不会对弹出式广告的帮助感到同情。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-09-17T20:15:13.790

冒着帮助想要部署弹出广告的人的风险（无论如何，由于大多数弹出广告拦截器肯定会失败），为什么你不能让子域加载加载广告商给你的 Javascript 块的页面？

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-09-17T20:17:13.877

在广告代码之后附加一个简单的 window.close() 怎么样？这样他们的弹出窗口就会显示出来，并且您的窗口会整齐地关闭。

我不确定我是否曾经有浏览器抱怨窗口正在关闭。这种方法一直对我有用。（IE、火狐等）

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-01-07T20:55:15.053

嘿，让这家伙放松一下。弹出窗口可能不是很好，但至少他正在尝试减少它们的数量。无论如何，弹出窗口拦截器都会修复大部分问题。在任何情况下，其他人可能会发现这个问题具有更利他的目标（不确定他们如何适应弹出窗口，但是嘿嘿）。

我不太明白你的问题，但这里有一些想法：

*   查看[服务器端包含](http://en.wikipedia.org/wiki/Server_Side_Includes)(SSI) 以轻松地向每个页面添加一个 javascript 块（尽管您也可以使用 PHP[包含](http://php.net/include/)来代替）

*   让您的广告客户在您的 PHP 脚本中进行选择，而不是调用子域

*   解密 javascript 以弄清楚它在做什么，并将修改后的版本放在子域页面中，这样它就不需要额外的弹出窗口。应该不会太难。

# c# - 关于如何构建 HTML Diff 工具的建议？

> ID：86905
> 
>         
> 
> 赞同：11
> 
>         
> 
> 时间：2008-09-17T19:48:19.627
> 
>         
> 
> 标签：c#, html, dom, diff

在[这篇文章](https://stackoverflow.com/questions/48669/are-there-any-tools-out-there-to-compare-the-structure-of-2-web-pages)中，我询问是否有任何工具可以比较 2 个 HTML 页面的结构（不是实际内容）。我问是因为我从我们的设计师那里收到了 HTML 模板，并且经常错过我的实现中小的格式更改。然后我浪费了几个小时的设计师时间来筛选我的页面以找出我的错误。

该线程提供了一些很好的建议，但没有什么符合要求。“那好吧，”我想，“我自己搞一个。我是个中庸的开发者，对吧？”。

好吧，一旦我开始考虑它，我就无法完全弄清楚如何去做。我可以很容易地创建一个数据驱动的网站，或者做一个 CMS 实施，或者整天把文档扔进和扔出 BizTalk。无法开始弄清楚如何比较 HTML 文档。

好吧，当然，我必须阅读 DOM，并遍历节点。我必须将结构映射到某个数据结构（如何？？），然后比较它们（如何？？）。这是我从未尝试过的开发任务。

因此，既然我已经确定了自己知识的弱点，我将面临更大的挑战来解决这个问题。关于如何开始的任何建议？

澄清：实际*内容*不是我想比较的——创意人员用*lorem ipsum*填充他们的页面，我使用真实内容。相反，我想比较结构：

```
<div class="foo">lorem ipsum<div>
```

不同的是

```

<div class="foo"> 
<p>lorem ipsum<p> 
<div>
```

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-09-17T19:54:59.173

DOM 是一种数据结构——它是一棵树。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-09-17T20:13:35.150

通过以下 Perl 脚本运行这两个文件，然后使用 diff -iw 执行不区分大小写、忽略空格的 diff。

```
#! /usr/bin/perl -w

use strict;

undef $/;

my $html = <STDIN>;

while ($html =~ /\S/) {
  if ($html =~ s/^\s*<//) {
    $html =~ s/^(.*?)>// or die "malformed HTML";
    print "<$1>\n";
  } else {
    $html =~ s/^([^<]+)//;
    print "(text)\n";
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-09-17T19:54:20.330

@Mike - 这将比较所有内容，包括页面内容，这不是原始海报想要的。

假设您可以访问浏览器的 DOM（通过编写 Firefox/IE 插件或其他方式），我可能会将所有 HTML 元素放入树中，然后比较这两个树。如果标签名称不同，则节点不同。您可能希望在某个点停止枚举（您可能不关心跨度、粗体、斜体等 - 可能只担心 div？），因为某些标签实际上是内容，而不是结构页。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-09-17T20:56:07.280

如果我要解决这个问题，我会这样做：

1.  为 html 页面计划某种 DOM。从轻量级开始，然后根据需要添加更多。我会为数据结构使用复合模式。即每个元素都有基类类型的子集合。

2.  创建一个解析器来解析 html 页面。

3.  使用解析器将 html 元素加载到 DOM。

4.  页面加载到 DOM 后，您将获得 html 页面结构的分层快照。

5.  继续遍历两边的每个元素，直到 DOM 结束。当您遇到不匹配的元素类型时，您会在结构中找到差异。

在您的示例中，您将仅在一侧加载一个 div 元素对象，在另一侧您将加载一个 div 元素对象，其中加载了 1 个段落元素类型的子元素。启动你的迭代器，首先你将匹配 div 元素，第二个迭代器你将匹配没有任何内容的段落。你有你的结构差异。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2008-09-18T13:06:29.350

我认为上面的一些建议没有考虑到两个页面之间的 HTML 中还有其他标签，这些标签在文本上会有所不同，但生成的 HTML 标记在功能上是等效的。Danimal 以控件 ID 为例。

以下两个标记在功能上是相同的，但如果您只是比较标记，则会显示为不同：

```
<div id="ctl00_TopNavHome_DivHeader" class="header4">foo</div>
<div class="header4">foo</div> 
```

我打算建议 Danimal 编写一个 HTML 翻译，它会查找 HTML 标记并将两个文档转换为两者的简化版本，省略 ID 标记和您指定为不相关的任何其他标记。这可能必须是一项正在进行的工作，因为您忽略某些属性/标签，然后遇到您也想忽略的新属性/标签。

但是，我喜欢使用 XmlSchemaInterface 将其归结为 XML 模式的想法，然后使用理解 XML 规则的 diff 工具。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-06-17T10:14:23.050

请参阅[http://www.semdesigns.com/Products/SmartDifferencer/index.html](http://www.semdesigns.com/Products/SmartDifferencer/index.html)了解由语言语法参数化的工具，并根据语言元素（标识符、表达式、语句、块、方法...... ) 插入、删除、移动、替换或在其上一致地替换标识符。该工具忽略了空格重新格式化（例如，不同的换行符或布局）和语义上无法区分的值（例如，它知道 0x0F 和 15 是相同的值）。这可以使用 HTML 解析器应用于 HTML。

编辑：2009 年 9 月 12 日。我们使用 HTML 编辑器构建了一个实验性 SmartDiff 工具。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2010-07-27T09:46:19.370

[http://www.mugo.ca/Products/Dom-Diff](http://www.mugo.ca/Products/Dom-Diff)

适用于 FF 3.5。我还没有测试过FF 3.6。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2008-09-20T11:35:13.257

我的建议只是这样做的基本方法...当然要解决您提到的问题，必须在此处应用其他规则...在您的情况下，我们得到了匹配的 div 元素，然后应用属性/属性匹配规则和什么不是...

老实说，比较需要应用许多复杂的规则，而不仅仅是一个简单的元素与另一个元素的匹配。例如，如果您有重复项会发生什么。例如，一侧有 1 个 div 元素，另一侧有 2 个 div 元素。你将如何匹配哪些 div 元素匹配在一起？

您会在比较词中发现许多其他复杂的问题。我根据经验说话（我的部分工作是维护我公司的文本比较引擎）。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2008-09-17T20:01:59.890

我不知道任何工具，但我知道有一种简单的方法可以做到这一点：  

*   首先，使用正则表达式工具去除 HTML 文件中的所有文本。您可以使用此正则表达式搜索文本 ( `?<=^|>)[^><]+?(?=<|$`) 并将其替换为空字符串 ( `""`)，即删除所有文本。在此步骤之后，您将拥有所有 HTML 标记标签。有很多免费的正则表达式工具。

*   然后，对原始 HTML 文件重复第一步。  

*   最后，您使用 diff 工具来比较两组 HTML 标记。这将显示一组和另一组之间缺少什么。

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2012-01-06T18:49:16.140

Pretty Diff 可以做到这一点。它只会比较代码结构，而不考虑空格、注释甚至内容的差异。请务必选中“规范化内容和字符串文字”选项。

[http://prettydiff.com/](http://prettydiff.com/)

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2008-09-17T20:39:24.387

这是一个很好的开始。更多澄清/评论：

*   我可能不关心 ID，因为 .net 会破坏它们

*   某些结构将位于中继器或其他此类控件中，因此我最终可能会拥有更多或更少的重复元素

进一步思考：我认为一个好的开始是假设 html 是 XHTML 兼容的。然后我可以推断模式（使用新的 .net XmlSchemaInference 方法），然后区分模式。然后我可以查看差异并考虑它们是否重要。

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2009-09-12T08:37:16.517

看看比比皆是。它有一个 XML 比较功能，可以帮助您。

* * *

## 回答 #13

> 赞同：0
> 
>             
> 
> 时间：2009-09-12T09:01:47.427

您可能还必须考虑“内容”本身可能包含额外的标记，因此`<div>`在进行比较之前可能值得剥离某些元素中的所有内容（例如具有某些 ID 或类的 s）。例如：

```
<div id="mainContent">
<p>lorem ipsum etc..</p>
</div> 
```

和

```
<div id="mainContent">
<p>Here is some real content<img class="someImage" src="someImage.jpg" /></p>
<ul>
<li>and</li>
<li>some</li>
<li>more..</li>
</ul>
</div> 
```

* * *

## 回答 #14

> 赞同：0
> 
>             
> 
> 时间：2010-03-28T04:50:58.003

我会使用（或贡献）`html5lib`它的 SAX 输出。只需快速浏览 2 个 SAX 流以查找不匹配并突出显示整个相应的子树。

* * *

## 回答 #15

> 赞同：-1
> 
>             
> 
> 时间：2009-09-12T08:29:40.087

如果我要这样做，首先我会学习 HTML。(^-^) 然后我会构建一个工具，去除所有实际内容，然后将其保存为文件，以便可以通过 WinDiff（或其他合并工具）进行管道传输。

* * *

## 回答 #16

> 赞同：-2
> 
>             
> 
> 时间：2008-09-17T19:50:02.523

在浏览器中打开每个页面并将它们保存为 .htm 文件。使用windiff比较两者。

# email - 如何修复“501 语法上无效的 HELO 参数”？

> ID：86907
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2008-09-17T19:48:29.453
> 
>         
> 
> 标签：email, exim

我在发送主机和中继主机上都使用 exim，发送主机似乎提供：

```
HELO foo_bar.example.com 
```

回复：

```
501 Syntactically invalid HELO argument(s) 
```

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2008-09-17T19:54:44.820

主机名中的下划线可能有问题？
[http://www.exim.org/lurker/message/20041124.113314.c44c83b2.en.html](http://www.exim.org/lurker/message/20041124.113314.c44c83b2.en.html)

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-09-17T19:59:07.773

下划线实际上在 Internet 主机名中无效，尽管有些人仍然使用它们。一个健全的 DNS 服务器不应该让你有他们的记录。

更改系统的主机名，使其有效，希望这会解决它。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2016-04-26T11:35:34.897

在花了这么多时间试图解决这个问题之后，在我的情况下，这个问题只是白手起家，我最终找到了一个解决方案。在我的例子中，只有部署到 Suse 操作系统的系统突然停止发送电子邮件，而不是那些（相同）在 Ubuntu 上运行的系统。在耗尽并消除了此问题的所有建议[可能性](https://confluence.atlassian.com/confkb/getting-501-syntactically-invalid-helo-argument-error-when-sending-mail-from-confluence-226790155.html)，甚至考虑更改这些机器的操作系统后，我发现发送电子邮件服务以某种方式对主机的主机名是敏感的。在 Ubuntu 机器中，文件 /etc/hosts 只有以下行：

`127.0.0.1 localhost`

停止发送电子邮件的 Suse 机器也是如此。从 Suse 机器编辑 /etc/hosts 到

`127.0.0.1  localhost proplad` 

其中 proplad 是机器的主机名，错误消失了。似乎某些安全策略（可能来自 smtp 服务）使用通过 API 携带的主机名信息，这在 Ubuntu 机器上被忽略，但在 Suse 机器上却没有。希望这对其他人有所帮助，避免在互联网上进行大量研究。  

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2016-06-21T16:43:18.917

迪亚戈的回答帮助我解决了我一直试图弄清楚的问题。

我们的 Suse 操作系统也突然停止工作。尝试了我在这里和谷歌上找到的每一个建议。没有任何效果。尝试将我们的域添加到 etc/hosts 但没有帮助。

使用 hostname 命令获取服务器的主机名。就像 Digao 建议的那样，将该主机名添加到 etc/hosts 文件中。

```
127.0.0.1 localhost susetest 
```

我保存了更改，然后运行 ​​postfix stop，postfix start。现在就像一个魅力。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2008-09-18T01:21:59.683

to 的参数`HELO`应该是主机名或 IP 地址。foo_bar.example.com 既不是 IP 地址也不是主机名（下划线在主机名中是非法的），因此错误消息是正确的，没有什么可修复的。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2012-01-04T07:40:34.830

使用 qmail 我遇到了这个问题。我意识到这是因为之前未完成的安装。

1) 发送电子邮件时，qmail 会用“HELO ...”向其他 SMTP 服务器宣布自己，然后将文件中的内容添加到：`/var/qmail/control/me` 

（有时文件位于`/var/qmail/control/helohost`）

2) 这个文件应该有一个主机名，里面有一个有效的 DNS 条目。

我的没有，`(none)`这就是邮件无法发送的原因。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2021-03-09T12:15:10.150

我发现我的本地开发服务器突然停止发送电子邮件（使用外部 SMTP）并且在我发现的服务器日志中：

> 拒绝来自 cpc96762-*******.net [ **.** .**.68]：语法上无效的参数：127.0.0.1:8888/app_dev.php

127.0.0.1:8888/app_dev.php 是我的本地 URL，我使用的是 Docker、Symfony 和 Swift Mailer。

在我的情况下，唯一有帮助的解决方案是添加参数：

```
local_domain = "localhost" 
```

到我的 Swift Mailer 配置。这解决了所有的问题。

请参阅 Swift Mailer`local_domain`选项的文档：[https ://symfony.com/doc/current/reference/configuration/swiftmailer.html#local-domain](https://symfony.com/doc/current/reference/configuration/swiftmailer.html#local-domain)

# sql - 将 SQL 结果集转换为 XML

> ID：86911
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-09-17T19:48:47.270
> 
>         
> 
> 标签：sql, xml

我正在寻找一种可以将 SQL 结果集序列化和/或转换为 XML 的工具。从 SQL 结果集中简化 XML 生成是简单而微不足道的，但这不是我需要的。

该解决方案必须是数据库中立的，并且只接受常规 SQL 查询结果（不使用 db xml 支持）。该工具的一个特殊挑战是提供与基于行的结果中的任何模式匹配的嵌套 XML。中间步骤太慢而且太浪费——这需要一步完成；没有 RS->object->XML，最好没有 RS->XML->XSLT->XML。由于结果集大、XML 大，它必须支持流式传输。

有什么可以做的吗？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-09-17T19:57:12.227

从来没听说过。我只会自己动手。这并不难做到，也许是这样的：

```
#!/usr/bin/env jruby

import java.sql.DriverManager

# TODO  some magic to load the driver
conn = DriverManager.getConnection(ARGV[0], ARGV[1], ARGV[2])
res = conn.executeQuery ARGV[3]

puts "<result>"
meta = res.meta_data
while res.next
  puts "<row>"

  for n in 1..meta.column_count
    column = meta.getColumnName n
    puts "<#{column}>#{res.getString(n)}</#{column}"
  end      

  puts "</row>"
end
puts "</result>" 
```

**免责声明：**我只是编造了所有这些，我什至懒得假装它有效。:-)

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-09-17T20:09:35.737

在 .NET 中，您可以从任何来源填充数据集，然后它可以为您将其作为 XML 写入磁盘，无论是否带有架构。我不能说大型套装的性能会是什么样的。简单的 ：）

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2008-09-17T20:25:19.490

对于 SQL Server，您确实应该考虑在查询中使用*FOR XML*构造。

如果您使用的是 .Net，只需使用 DataAdapter 来填充数据集。一旦它在数据集中，只需使用它的 .WriteXML() 方法。这打破了您的 DB->object->XML 规则，但这确实是事情的完成方式。您也许可以使用数据阅读器解决问题，但我对此表示怀疑。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2011-09-21T03:28:03.820

另一种选择，取决于您需要输出多少模式，和/或这个解决方案应该是多么动态，是直接从 SQL 语句实际编写 XML，如下面的简单示例所示......

```
SELECT 
    '<Record>' ||
        '<name>' || name || '</name>' ||
        '<address>' || address || '</address>' ||
    '</Record>'
FROM
    contacts 
```

您必须预先添加和附加文档元素，但我认为这个示例很容易理解。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2008-09-17T19:59:54.653

dbunit (www.dbunit.org) 确实从 sql 转到 xml，反之亦然；您可能可以根据需要对其进行更多修改。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2008-09-17T21:56:31.690

从技术上讲，将结果集转换为 XML 文件很简单，不需要任何工具，除非您需要转换数据结构以适应特定的导出模式。通常，结果集获取 XML 文件的顶级元素，然后生成许多包含属性的记录元素，这些元素实际上是记录的字段。

例如，当涉及到 Java 时，您只需要适当的 JDBC 驱动程序来与您选择的 DBMS 连接，以解决数据库独立性要求（通常由 DBMS 供应商提供），以及几行代码来读取结果集并打印出来每个记录，每个字段的 XML 字符串。在我看来，对于普通的 Java 开发人员来说，这并不是一项艰巨的任务。

无论如何，您陈述的目的越具体，您得到的答案就越具体。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2008-09-17T22:00:52.380

在 Java 中，您可能只是用 xml 数据（如实体 bean）填充一个对象，然后使用 XMLEncoder 将其转换为 xml。从那里您可以使用 XSLT 进行进一步转换或使用 XMLDecoder 将其带回对象。

格瑞兹，GHad

PS：有关Object to XML 部分的示例，请参见[http](http://ghads.wordpress.com/2008/09/16/java-to-xml-to-java/) ://ghads.wordpress.com/2008/09/16/java-to-xml-to-java/... 从 DB 到 Object 有多种可能的方式：JDBC、Groovy 数据集或 GORM。Apache Common Beans 可能有助于通过类似反射的方法填充 JavaBeans。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2011-09-21T03:22:35.040

我创建了一个解决此问题的解决方案，方法是使用结果集作为源的邮件合并，以及一个模板，通过该模板将结果集合并以生成所需的 XML。

该模板是标准 XML，带有一个 Header 元素、一个 Footer 元素和一个 Body 元素。在 Body 元素中使用 CDATA 块允许我包含一个完整的 XML 结构，该结构充当每一行的模板。为了在模板中包含来自结果集中的字段，我使用了看起来像这样的标记`<[FieldName]>`。然后对模板进行预解析以隔离标记，以便在操作中，模板在生成正文时从结果集中请求每个字段。

Header 和 Footer 元素仅在输出集的开头和结尾输出一次。正文可以是所需的任何 XML 或文本结构。在您的情况下，听起来您可能有多个模板，每个模板用于您所需的模式。

以上所有内容都封装在一个模板类中，因此在加载模板后，我只需调用`merge()`模板将结果集作为参数传入。

# database - 存储栅格数据的好方法是什么？

> ID：86913
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-09-17T19:49:04.973
> 
>         
> 
> 标签：database, geolocation, time-series, raster

我有各种时间序列数据存储在或多或少的地理参考网格上，例如每 0.2 度的纬度和经度一个值。目前数据存储在文本文件中，因此在第 251 天，您可能会看到：

```
251
 12.76 12.55 12.55 12.34 [etc., 200 more values...]
 13.02 12.95 12.70 12.40 [etc., 200 more values...]
 [etc., 250 more lines]
252
 [etc., etc.] 
```

我想提高抽象级别，提高性能，减少脆弱性（例如，当前代码不能在两个现有代码之间插入一天！）。我们搞砸了 BLOB-y RDBMS 黑客，甚至将文本文件格式的每一行复制为表中的一行（每个时间戳/纬度对一行，每个经度增量一列 - 耶！）。

我们可以去一个“真实的”地理数据库，但是用 lat 和 long 标记每个单独的值的开销似乎令人望而却步。数据的大小和分辨率十年来没有变化，而且不太可能发生变化。

我一直在想把所有东西都放在 NetCDF 文件中，但认为我们需要完全超越文件思维方式——我讨厌我的所有软件都必须从日期中找出文件名，处理多个文件多年，等等。 . 将所有十年（和计数）数据放入单个文件的替代方法似乎也不可行。

有什么好主意或产品吗？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2008-09-18T05:20:25.523

我在这里收集了你的评论：

1.  我想做所有这些“不写我自己的文件 I/O 代码”

2.  我需要从“Java Ruby MATLAB”和“FORTRAN 例程”访问

当你把这些加起来时，你肯定不想要新的文件格式。  **坚持你拥有的那个。**

如果我们可以让您放宽您的第一个要求 - 即，如果您愿意编写自己的文件 I/O 代码，那么您可以选择一些有趣的选项。我会编写 C++ 类，我会使用 SWIG 之类的东西来使您的新类可用于您需要的多种语言。（但我不确定你是否能够使用 SWIG 让你从 Java、Ruby、MATLAB 和 FORTRAN 访问。你可能需要别的东西。我自己不太确定该怎么做。）

您还说，“实际上，如果我必须有文件，我更喜欢文本，因为这样我可以在必要时进入并手动编辑。”

我的信念是，这是一个误导性的陈述。如果您愿意制作自己的文件 I/O 例程，那么您可以做一些非常聪明的事情......作为最终的后备，您可以给自己一个工具，将新文件格式转换为相同的旧文件格式您习惯的文本格式...以及另一个转换回来的工具。我会在我的帖子结束时回到这个...

你说了一些我想表达的东西：

“利用 40 年的数据库优化”

数据库适用于关系数据，而不是栅格数据。您不会利用任何人的数据库**优化**来处理此类数据。您也许可以将数据塞进数据库，但这几乎不是一回事。

**这是我能告诉你的最有用的事情，基于你告诉我们的一切。**  你这样说：

“我对优化时间比 CPU 更感兴趣*，*尽管执行速度很好！”

坦率地说，这将需要工具。别再把它想象成一个文本文件了。开始思考你所做的常见任务，并编写小工具——用任何语言——让这些事情变得微不足道。

如果你的工具结果很糟糕？你猜怎么着 - 这是因为你的平面文本文件是一种粗俗的格式。但那只是我的个人意见。:)

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-09-17T19:55:28.033

我肯定会从文本更改为二进制，但仍将每天保存在一个单独的文件中。您可以以这样一种方式命名它们，即它们之间的插入不会对索引造成任何奇怪，例如通过在文件名中包含日期和可能的时间。例如，如果每个位置有多个字段，您也可以考虑文件结构。从大量时间步长中寻找小块是否常见？在这种情况下，您可能希望将它们存储为包含几天数据的图块。您没有提到如何访问数据，这在如何有效组织数据方面起着重要作用。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-09-17T20:05:26.603

说明：

我很惊讶您将“数据库”添加为标签之一，并将其​​视为一种选择。你为什么这么做？

本质上，您在每个时间步都有一个 2D 单分量浮点图像。您是否同意这种查看数据的方式？

您还提到希望在两个现有的之间插入一天 - 这似乎是一件非常奇怪的事情。为什么你需要这样做？5 月 4 日到 5 月 5 日之间是否有我不知道的新一天？

“压缩”是您关心的事情之一，还是您只是厌倦了平面文件？

浮点数或双精度数是否足以存储您的数据，还是您觉得需要更多的任意精度？

另外，您想使用什么编程语言来访问这些数据？

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-09-17T20:31:45.183

您对如何存储数据的回答完全取决于您将如何处理数据。例如，如果您只需要通过指定日期或日期范围进行检索，那么在数据库中存储为 BLOB 是有意义的。但如果您需要查找具有特定值的记录，则需要做一些不同的事情。

请描述您需要如何访问数据/

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2008-09-18T15:43:37.770

马特，非常感谢，还有 longneck 和 jirv。

这篇文章部分是一个实验，测试stackoverflow话语的质量。如果你们/女孩/外星生命形式具有代表性，我就被卖了。

在这一点上，你已经大大澄清了我的想法。请注意，我可能仍然不一定会*执行*您的建议，但知道我会非常认真地*考虑它。*>;-)

我可能会很好地保持文件格式不变，添加到现有的 C 和/或 Ruby 例程以补充我缺乏的一些低级功能（例如插入缺少的时间步），并在整个事情上挂起一个 HTTP 前端，所以数据可以被任何需要它的盒子以任何当前流行的语言使用。虽然构建这些数据的主要是不变的遗留软件，但我们总是为它找到新的消费者，所以多语言/多计算机的要求（天哪，我忘了那个吗？）适用于阅读方面，而不是写作方面。这也避免了一系列安全问题。

再次感谢各位。

# xml - Unpivot 基于属性的 xml 文档

> ID：86919
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-09-17T19:49:27.783
> 
>         
> 
> 标签：xml, xslt, unpivot

我有一个简单的 xml 文档，如下所示。我需要编写一个 XSLT 转换，该转换基本上基于某些属性“取消透视”该文档。

```
<?xml version="1.0" encoding="utf-8" ?>
<root xmlns:z="foo">
    <z:row A="1" X="2" Y="n1" Z="500"/>
    <z:row A="2" X="5" Y="n2" Z="1500"/>
</root> 
```

这就是我期望的输出 -

```
<?xml version="1.0" encoding="utf-8" ?>
<root xmlns:z="foo">
    <z:row A="1" X="2"  />
    <z:row A="1" Y="n1" />
    <z:row A="1" Z="500"/>
    <z:row A="2" X="5" />
    <z:row A="2" Y="n2"/>
    <z:row A="2" Z="1500"/>
</root> 
```

感谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-09-18T08:23:50.463

这是您需要的完整样式表（因为命名空间很重要）：

```
<xsl:stylesheet version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:z="foo">

<xsl:template match="root">
  <root>
    <xsl:apply-templates />
  </root>
</xsl:template>

<xsl:template match="z:row">
  <xsl:variable name="A" select="@A" />
  <xsl:for-each select="@*[local-name() != 'A']">
    <z:row A="{$A}">
      <xsl:attribute name="{local-name()}">
        <xsl:value-of select="." />
      </xsl:attribute>
    </z:row>
  </xsl:for-each>
</xsl:template>

</xsl:stylesheet> 
```

我更喜欢使用文字结果元素（例如`<z:row>`）而不是`<xsl:element>`属性值模板（`{}`属性值中的 s），而不是`<xsl:attribute>`尽可能地使用它，因为它使代码更短，并且更容易查看您正在生成的结果文档的结构. 其他人更喜欢`<xsl:element>`，`<xsl:attribute>`因为那样一切都是 XSLT 指令。

如果您使用的是 XSLT 2.0，那么有几个语法细节会有所帮助，即`except`XPath 中的运算符和直接在 上使用`select`属性的能力`<xsl:attribute>`：

```
<xsl:stylesheet version="2.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:xs="http://www.w3.org/2001/XMLSchema"
  exclude-result-prefixes="xs"
  xmlns:z="foo">

<xsl:template match="root">
  <root>
    <xsl:apply-templates />
  </root>
</xsl:template>

<xsl:template match="z:row">
  <xsl:variable name="A" as="xs:string" select="@A" />
  <xsl:for-each select="@* except @A">
    <z:row A="{$A}">
      <xsl:attribute name="{local-name()}" select="." />
    </z:row>
  </xsl:for-each>
</xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-09-17T20:09:49.637

```
<xsl:template match="row">
    <row A="{$A}" X="{$X}" />
    <row A="{$A}" Y="{$Y}" />
    <row A="{$A}" Z="{$Z}" />
</xsl:template> 
```

加上明显的样板。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-09-17T20:25:00.583

这更复杂但也更通用：

```
<xsl:template match="z:row">
    <xsl:variable name="attr" select="@A"/>
    <xsl:for-each select="@*[(local-name() != 'A')]">
        <xsl:element name="z:row">
            <xsl:copy-of select="$attr"/>
            <xsl:attribute name="{name()}"><xsl:value-of select="."/></xsl:attribute>
        </xsl:element>
    </xsl:for-each>
</xsl:template> 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-09-17T20:08:36.347

这是一种蛮力的方式：

```
<xsl:template match="z:row">
    <xsl:element name="z:row">
        <xsl:attribute name="A">
            <xsl:value-of select="@A"/>
        </xsl:attribute>
        <xsl:attribute name="X">
            <xsl:value-of select="@X"/>
        </xsl:attribute>
    </xsl:element>
    <xsl:element name="z:row">
        <xsl:attribute name="A">
            <xsl:value-of select="@A"/>
        </xsl:attribute>
        <xsl:attribute name="Y">
            <xsl:value-of select="@Y"/>
        </xsl:attribute>
    </xsl:element>
    <xsl:element name="z:row">
        <xsl:attribute name="A">
            <xsl:value-of select="@A"/>
        </xsl:attribute>
        <xsl:attribute name="Z">
            <xsl:value-of select="@Z"/>
        </xsl:attribute>
    </xsl:element>
</xsl:template>

<xsl:template match="@* | node()">
    <xsl:copy>
        <xsl:apply-templates select="@* | node()"/>
    </xsl:copy>
</xsl:template> 
```

# c# - 编写等于运算符时处理 null 的最佳方法

> ID：86947
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2008-09-17T19:53:03.700
> 
>         
> 
> 标签：c#, operator-overloading, equals

> **可能重复：**
> 
>   [如何在没有无限递归的情况下检查“==”运算符重载中的空值？](https://stackoverflow.com/questions/73713/how-do-i-check-for-nulls-in-an-operator-overload-without-infinite-recursion)

当我为对象重载 == 运算符时，我通常会编写如下内容：

```
 public static bool operator ==(MyObject uq1, MyObject uq2) {
        if (((object)uq1 == null) || ((object)uq2 == null)) return false;
        return uq1.Field1 == uq2.Field1 && uq1.Field2 == uq2.Field2;
    } 
```

如果您不向下转换为对象，则该函数会递归到自身，但我想知道是否没有更好的方法？

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2008-09-17T20:05:03.953

正如微软所说，

> 运算符 == 重载的一个常见错误是使用 (a == b)、(a == null) 或 (b == null) 来检查引用是否相等。相反，这会导致调用重载运算符 ==，从而导致无限循环。使用 ReferenceEquals 或将类型转换为 Object，以避免循环。

所以使用 ReferenceEquals(a, null) || ReferenceEquals(b, null) 是一种可能性，但转换为对象同样好（我相信实际上是等价的）。   

所以是的，似乎应该有更好的方法，但您使用的方法是推荐的方法。

然而，正如已经指出的那样，当覆盖 == 时，你真的应该覆盖 Equals。由于 LINQ 提供程序是用不同的语言编写并在运行时进行表达式解析，即使您自己拥有所有代码，谁知道什么时候您会因为不这样做而感到厌烦。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-09-17T20:03:25.330

@neouser99：这是正确的解决方案，但是缺少的部分是在覆盖相等运算符（运算符 ==）时，您还应该覆盖 Equals 函数并简单地让运算符调用该函数。并非所有 .NET 语言都支持运算符重载，因此是重写 Equals 函数的原因。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2008-09-17T19:55:40.077

ReferenceEquals(object obj1, object obj2)

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2008-09-17T20:38:28.383

只需使用 Resharper 为您创建 Equals 和 GetHashCode 方法。它为此目的创建了最全面的代码。

**更新**
我不是故意发布的——我更喜欢人们使用 Resharper 的功能而不是复制粘贴，因为代码从一个类到另一个类会发生变化。至于在没有 Resharper 的情况下开发 C# - 我不明白你是怎么生活的，伙计。

无论如何，这是一个简单类的代码（由旧版本 Resharper 3.0 生成 - 我有 4.0 在工作，我目前不记得它是否创建相同的代码）

```
public class Foo : IEquatable<Foo>
{
    public static bool operator !=(Foo foo1, Foo foo2)
    {
        return !Equals(foo1, foo2);
    }

    public static bool operator ==(Foo foo1, Foo foo2)
    {
        return Equals(foo1, foo2);
    }

    public bool Equals(Foo foo)
    {
        if (foo == null) return false;
        return y == foo.y && x == foo.x;
    }

    public override bool Equals(object obj)
    {
        if (ReferenceEquals(this, obj)) return true;
        return Equals(obj as Foo);
    }

    public override int GetHashCode()
    {
        return y + 29*x;
    }

    private int y;
    private int x;
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
>             
> 
> 时间：2008-09-17T20:00:13.560

遵循 DB 处理：

```
null == <anything> is always false 
```

* * *

## 回答 #6

> 赞同：-1
> 
>             
> 
> 时间：2008-09-17T20:06:07.383

但是你为什么不创建一个对象成员函数呢？它当然不能在 Null 引用上调用，因此您确定第一个参数不是 Null。

事实上，你失去了二元运算符的对称性，但仍然......

（注意 Purfideas 的回答：如果需要，Null 可能等于 Null 作为数组的哨兵值）

还要考虑 == 函数的语义：有时您*真的*希望能够选择是否测试

*   身份（指向同一个对象）

*   价值平等

*   等价（例如 1.000001 等价于 .9999999 ）

* * *

## 回答 #7

> 赞同：-1
> 
>             
> 
> 时间：2008-09-17T19:58:20.333

```
if ((object)uq1 == null) 
    return ((object)uq2 == null)
else if ((object)uq2 == null)
    return false;
else
    //return normal comparison 
```

This compares them as equal when both are null.

# unix - 网络套接字命令

> ID：86949
> 
>         
> 
> 赞同：-1
> 
>         
> 
> 时间：2008-09-17T19:53:45.167
> 
>         
> 
> 标签：unix, netstat

Unix .....>>netstat -al | grep 8787（将看到端口 8787 上的数据包）

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-09-17T20:22:38.357

这里问题的性质是什么？您是否尝试查看端口 8787 上的数据包？您是否正在寻找侦听端口 8787 的服务？最重要的是，这是一个与编程相关的问题吗？

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2008-10-07T10:48:02.667

如果要查看实际数据包，则需要使用 tcpdump。

使用该`-s`选项来指定您想要查看多少数据包（`0`表示整个数据包）以及`-X`获取 Hex 和 ASCII 转储的选项。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-10-07T10:56:13.477

使用命令

ifconfig -a

来确定您要收听的接口。然后使用

tcpdump -npi eth0 端口 8787

侦听端口，其中 eth0 是您要侦听的接口，您从 ifconfig 命令中识别出该接口。

# .net - 两台机器上的相同源代码产生不同的可执行行为

> ID：86959
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2008-09-17T19:55:25.850
> 
>         
> 
> 标签：.net, datetime, compiler-construction

这是场景：

存储在 SVN 中的 AC# Windows 应用程序项目用于创建可执行文件。通常，构建服务器处理构建过程并定期创建用于测试的构建。在这个特定的例子中，我被要求修改一个特定的构建并创建可执行文件。

我不完全确定构建服务器是否修改了项目文件，但我知道它在用于编译可执行文件的源代码的 SVN 中创建了一个标签。使用该标签，我在第二台机器上检查了代码，这是一台开发机器。然后我在开发机器上编译了源代码。

执行时，在开发机器上编译的应用程序的功能与构建服务器编译的应用程序不完全相同。例如，在测试机器上，应用程序检测到 DateTime Parse execption。但是，构建机器的可执行文件不会引发任何异常。如果我在开发机器上运行可执行文件，则不会引发异常。

所以总而言之，两台机器理论上都使用相同的源代码和项目。

开发机器的可执行文件只能在开发机器上运行。Build 机器的可执行文件适用于每台机器，包括开发机器。

机器的区域设置或时区是否存储在编译的可执行文件中？知道什么可能导致这种行为或如何检查可执行文件以找到可能的差异并纠正它们吗？

不幸的是，我不能拿一台测试机并附加一个调试器。我会尽快。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2008-09-17T19:59:34.717

该应用程序使用运行它的机器的区域设置，看起来这是您的问题。您可以通过将 System.Threading.Thread.CurrentThread.CurrentCulture 和 System.Threading.Thread.CurrentThread.CurrentUICulture 设置为特定值来强制线程使用特定区域性。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2008-09-17T19:59:29.693

两台机器可能具有不同版本的底层 dll，这不是构建过程的一部分。在我们的内部服务器场分发服务时，我已经看到了这种情况。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2008-09-17T19:58:39.087

您可以在调试器下在构建机器上运行程序吗？

如果是这样，那么调试问题 -**无需猜测**。

让开发机器上的调试器捕获异常，在构建机器上的同一位置设置断点。看看两者有什么不同。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2008-09-17T20:01:17.677

我在 XP 上看到不同的“区域和语言选项”会导致这种行为。这些在两台机器上匹配吗？开始 | 设置 | 控制面板 | 区域和语言选项...

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2008-09-17T20:03:19.463

我有几个问题 - 两台机器是否具有相同的区域设置以及您的错误日志在哪里？我希望 ;-) 您处理异常并将其写入磁盘、事件日志......有助于解决此类问题。

正在解析的日期来自哪里？如果它在您的数据库中，则可能您也有错误的数据。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2008-09-17T19:59:40.940

我曾经遇到过类似的问题（C++ 除外）当我比较已编译的可执行文件的大小时，它们相差甚远。不幸的是，经过几天的搜索，我找到的最佳解决方案是卸载 VS05 并重新安装它。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2008-09-17T20:03:14.270

如果我可能会问，您为什么要使用构建服务器来获取 C# 代码？

当我使用 C# 时，它的构建时间几乎不明显（<2s）。应用程序真的那么大吗？

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2008-09-17T21:22:35.203

构建系统可能会制作发布版本，而开发 PC 上的手动构建会制作调试版本。调试版本有更多的错误检查。看看是否可以手动构建发布版本，看看是否仍然存在差异。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2008-09-19T00:49:54.027

如果每个人都在不同的计算机上构建相同的程序，则很少有相同的源代码。您应该始终假设程序是不同的，永远不要期望它们是相同的。在像 linux 这样具有良好包管理器和定期或随机更新的环境中，永远不要期望相同的源代码在同一台计算机上构建相同的程序。语言越高越差。为调试器构建程序与为发布而构建程序截然不同。即使没有调试器，调试器版本也会隐藏在您进入发布版本之前您不会发现的错误。如果您过于依赖调试器环境，您基本上可以调试程序两次。

# emacs - 在 Emacs 中终止临时缓冲区之前如何获得警告？

> ID：86963
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2008-09-17T19:55:29.530
> 
>         
> 
> 标签：emacs

我不止一次因为意外杀死 Emacs 中的临时缓冲区而失去工作。我可以设置 Emacs 在我终止与文件无关的缓冲区时给我一个警告吗？

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2008-09-17T20:07:39.860

创建一个函数，询问您是否确定缓冲区何时已被编辑并且未与文件关联。然后将该函数添加到列表中`kill-buffer-query-functions`。

查看您了解的[Buffer File Name](http://www.gnu.org/software/emacs/manual/html_node/elisp/Buffer-File-Name.html)的文档：

*   当且仅当变量`buffer-file-name`为 nil时，缓冲区才不会访问文件

使用该洞察力编写函数：

```
(defun maybe-kill-buffer ()
  (if (and (not buffer-file-name)
           (buffer-modified-p))
      ;; buffer is not visiting a file
      (y-or-n-p "This buffer is not visiting a file but has been edited.  Kill it anyway? ")
    t)) 
```

然后将函数添加到钩子中，如下所示：

```
(add-to-list 'kill-buffer-query-functions 'maybe-kill-buffer) 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-09-17T20:29:00.573

```
(defun maybe-kill-buffer ()
  (if (and (not buffer-file-name)
           (buffer-modified-p))
      ;; buffer is not visiting a file
      (y-or-n-p (format "Buffer %s has been edited.  Kill it anyway? "
                        (buffer-name)))
    t))

(add-to-list 'kill-buffer-query-functions 'maybe-kill-buffer) 
```

# windows - 更新多 GB 程序的最佳方式（DVD 执行？更新程序软件？）

> ID：86971
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-09-17T19:55:59.467
> 
>         
> 
> 标签：windows, download, dvd, updating

两年前，我们发布了一个数千兆字节的 Windows 应用程序，其中包含大量视频文件。现在，我们正在寻求发布一个重要更新，其中包含大约 1 GB 的新数据和更改数据。

我们目前正在寻找 DVD 配送公司（例如[这些人](http://www.dvd-fulfillment.com/default.asp?ref=600&gclid=CNjuvqXJ45UCFQLGGgodlWYceg)），它们声称能够以 5 美元及以上的价格将 DVD 运送给我们的客户。有没有人有这些公司的经验？

我们还研究了一堆基于网络的“更新程序”软件。不幸的是，这些工具中的大多数都是为小得多的程序设计的。是否有任何库或产品可以很好地处理千兆字节大小的更新？

感谢您的意见！

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-09-17T19:58:35.810

[BITS](http://msdn.microsoft.com/en-us/library/aa362708(VS.85).aspx)是 Microsoft 的一个库，用于使用未使用的带宽逐个下载文件。您基本上可以让您的客户涓流下载新的视频文件。但是，问题是您必须先更新程序才能使用 BITS。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-09-17T20:01:11.250

根据最终用户是谁，您有几个选择：

1.  运送 DVD

    此选项往往相当昂贵，并且可能不是最好的方法，如果您将其运送给不再安装该软件的人怎么办。

2.  HTTP 托管（使用 Akamai 或任何其他 CDN）

    这对其他公司来说效果很好，例如苹果，我也相信微软。

3.  Bittorrent

    它不仅仅用于非法内容，它可以让你卸载一些发送文件的工作量，同时它是一个快速的协议，如果你确保机器播种有正确的文件， bittorrent 协议将确保最终用户获得具有完全相同哈希的相同文件。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2010-02-03T05:06:41.477

您可以使用 rsync 算法：[http ://samba.anu.edu.au/rsync/](http://samba.anu.edu.au/rsync/)

# .net - 避免使用 C++/CLI 属性的双重打击

> ID：86977
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-09-17T19:56:53.520
> 
>         
> 
> 标签：.net, properties, c++-cli

我已经读过（在 Nish Sivakumar 的书**C++/CLI In Action**以及其他地方）你应该在函数调用上使用 __clrcall 装饰器以避免双重重复，以防你知道永远不会从非托管代码调用该方法。Nish 还说，如果方法签名包含任何 CLR 类型，那么 JIT 编译器将自动添加 __clrcall。我不清楚的是在创建 C++/CLI 属性时是否需要包含 __clrcall。从某种意义上说，属性只能从 .NET 语言访问，另一方面，C++/CLI 编译器（我认为）只生成可从托管代码和非托管代码调用的方法（例如 ***_get() ）。那么我是否需要在我的属性上使用 __clrcall 修饰符，如果需要，它在哪里？在 get/set 函数本身上？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2008-09-17T21:37:51.000

@Mike B-感谢有关 ildasm 的提示-我不知道该工具。

看来我误读/误解了 Nish - __clrcall 修饰符和它消除的双重重击问题仅适用于 NATIVE 类的方法。默认情况下，托管类的所有方法都是 __clrcall - 回想起来似乎很明显。

显然 Marcus Heege 的书**Expert C++/CLI**可以[免费下载](http://int6.net/ebook/Expert.Cpp.Cli.NET.pdf)，它在第 215 页有一个很好的表格，总结了调用约定。

# oracle - Mac OSX 上的 Oracle 连接问题：“状态：失败 - 测试失败：Io 异常：网络适配器无法建立连接”

> ID：86987
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2008-09-17T19:58:31.770
> 
>         
> 
> 标签：oracle, macos

我正在使用 Oracle SQL Developer 尝试此操作，并且在 Intel MacBook Pro 上。但我相信其他客户也会发生同样的错误。我可以很好地 ping 托管数据库的服务器，因此它似乎不是实际的网络问题。

另外，我相信我正确填写了连接信息。是这样的：

```
主机 = foo1.com
端口 = 1530
服务器=专用
service_name = FOO
类型 = 会话
方法=基本

```

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2008-09-17T20:39:46.630

当您没有正确的连接参数时，这就是您收到的消息。尤其是 SID，往往会绊倒新来者。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2008-09-17T21:22:42.317

如果您想连接到其他主机上的数据库，那么您需要知道

*   主机名

*   端口号（默认为 1521）

*   SID 名称

如果您收到您在问题中提到的连接错误，那么您没有正确指定主机名或端口号。尝试

```
telnet 主机名 端口号

```

从终端验证您是否可以连接到端口号（默认为 1521） - 如果不能，则端口号可能不正确。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2008-09-23T21:59:32.310

我的问题原来是某种 ACL 问题。我需要通过“受祝福的主机”通过 SSH 隧道进入。我将以下内容放入我的 .ssh/config

```
Host=blessedhost
HostName=blessedhost.whatever.com
User=alice
Compression=yes
Protocol=2
LocalForward=2202 oraclemachine.whatever.com:1521

Host=foo
HostName=localhost
Port=2202
User=alice
Compression=yes
Protocol=2 
```

（我不认为第二块真的有必要。）然后我将oracle连接信息中的主机和端口更改为localhost：2202。

# database - 您如何管理数据库中的“选择列表”

> ID：86992
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2008-09-17T19:58:50.567
> 
>         
> 
> 标签：database

我有一个具有多个“选择列表”实体的应用程序，例如用于填充下拉选择框的选择。这些实体需要存储在数据库中。如何将这些实体保存在数据库中？

我应该为每个选择列表创建一个新表吗？有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2008-09-17T20:05:24.890

在过去，我创建了一个包含列表名称和可接受值的表，然后查询它以显示列表。我还包括一个基础值，因此您可以返回列表的显示值，以及可能更丑陋的绑定值（例如，用于规范化数据的小 int）

```
CREATE TABLE PickList(
    ListName varchar(15),
    Value varchar(15),
    Display varchar(15),
    Primary Key (ListName, Display)
) 
```

如果要手动定义显示顺序，还可以添加 sortOrder 字段。

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2008-09-17T20:10:26.297

这取决于各种事情：

*   如果它们是不可变的且不相关的（想想“美国各州的名称”），则可以提出它们根本不应该存在于数据库中的论点：毕竟它们只是简单地格式化一些更简单的东西（比如分配的两个字符代码）。这具有额外的优势，您不需要往返数据库来获取永远不会更改的内容以填充组合框。

    然后，您可以在代码中使用枚举并在数据库中使用约束。在本地化显示的情况下，您需要为每种文化设置不同的格式，然后您可以使用 XML 文件或其他资源来存储文字。

*   如果它们是关系的（想想“状态 - 首都”），无论哪种方式我都不太相信......但最近我一直在使用 XML 文件、数据库约束和 javascript 来填充。它工作得很好，在数据库上很容易。

*   如果它们不是只读的但很少更改（即通常不能由最终用户更改，而只能由某些编辑器或每日批处理更改），那么我仍然会考虑不将它们存储在数据库中的机会......这将取决于关于具体情况。

*   在其他情况下，存储在数据库中是一种方式（想想 StackOverflow 的标签......它们是“查找”但也可以由最终用户更改）——如果需要，可能会进行一些缓存。它需要一些小心的锁定，但它会工作得很好。

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2008-09-17T20:04:26.030

好吧，你可以这样做：

```
PickListContent

IdList  IdPick  Text  
1       1       Apples
1       2       Oranges
1       3       Pears
2       1       Dogs
2       2       Cats 
```

和可选的..

```
PickList

Id    Description
1     Fruit
2     Pets 
```

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2008-09-17T20:22:40.853

我发现创建单独的表是最好的主意。

我一直在尝试创建一个包含所有选择列表的主表，然后根据类型进行过滤。虽然它有效，但它总是让人头疼。例如，您可能会发现您认为是一个简单的选择列表的东西并不那么简单，并且需要一个额外的字段，您现在是将这些数据拆分到一个额外的表中还是扩展您的主列表？

从数据库的角度来看，拥有单独的表可以更轻松地管理您的关系完整性，并且可以在您不使用应用程序时更轻松地解释数据库中的数据

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2008-09-17T20:02:46.533

我们为每个选择列表遵循了一个新表的模式。例如：

表 FRUIT 具有列 ID、NAME 和DESCRIPTION。

值可能包括：

15000、Apple、

Redfruit 15001、Banana、yellow and yummy 

...  

如果您需要在另一个表中引用 FRUIT，您将调用列 FRUIT_ID 并引用 FRUIT 表中行的 ID 值。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2008-09-17T20:06:14.793

为列表创建一个表，为 list_options 创建一个表。

```
 # Put in the name of the list
 insert into lists (id, name) values (1, "Country in North America");

 # Put in the values of the list
 insert into list_options (id, list_id, value_text) values
   (1, 1, "Canada"),
   (2, 1, "United States of America"),
   (3, 1, "Mexico"); 
```

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2008-09-17T20:18:56.667

两张桌子。如果您尝试将所有内容都塞进一张表中，那么您会破坏规范化（如果您关心的话）。以下是示例：

```
列表
---------------
LIST_ID (PK)
姓名
描述

LIST_OPTION
----------------------------
LIST_OPTION_ID (PK)
LIST_ID (FK)
OPTION_NAME
OPTION_VALUE
MANUAL_SORT

```

列表表只是描述了一个选择列表。list_ 选项表描述了给定列表中的每个选项。因此，您的查询将始终从知道您想要填充哪个选择列表（按名称或 ID）开始，您将其加入 list_ 选项表以提取所有选项。manual_sort 列只是为了以防您想要强制执行特定顺序而不是按名称或值。（顺便说一句，每当我尝试发布带有下划线的“列表”和“选项”字样时，预览窗口会有点古怪。这就是我在那里放一个空格的原因。）

查询看起来像：

```
选择
  b.option_name，
  b.option_value
从
  列出一个，
  list_option b
在哪里
  a.name="国家"
和
  a.list_id = b.list_id
订购
  b.manual_sort asc

```

如果您认为您会在 where 子句中使用它，您还需要在 list.name 上创建一个索引。pk 和 fk 列通常会自动被索引。  

并且请不要为每个选择列表创建一个新表，除非您输入将由应用程序在其他地方使用的“关系相关”数据。您将完全规避数据库提供的关系功能。您最好将选择列表静态定义为基类或属性文件中某处的常量（您选择如何对名称-值对进行建模）。

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2008-09-17T20:22:16.220

首先回答第二个问题：是的，在大多数情况下，我会为每个选择列表创建一个单独的表。特别是如果它们用于完全不同类型的值（例如州和城市）。我使用的一般表格格式如下：

```
id - identity or UUID field (I actually call the field xxx_id where xxx is the name of the table).  
name - display name of the item  
display_order - small int of order to display.  Default this value to something greater than 1 
```

如果您愿意，您可以添加一个单独的“值”字段，但我通常只使用 id 字段作为选择框值。  

我通常使用先按显示顺序排序的选择，然后按名称排序，因此您可以按字母顺序排序，同时仍添加您自己的例外。例如，假设您有一个您想要按字母顺序排列的国家/地区列表，但您可以说美国排在第一位，加拿大排在第二位`"SELECT id, name FROM theTable ORDER BY display_order, name" and set the display_order value for the US as 1, Canada as 2 and all other countries as 9.`

你可以变得更漂亮，比如有一个“活动”标志，这样你就可以激活或停用选项，或者设置一个“x_type”字段，这样你就可以对选项、描述列进行分组，以便在工具提示中使用等。但基本表适用于大多数情况。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2008-09-17T20:01:13.120

根据您的需要，您可以只拥有一个选项表，其中包含一个列表标识符和一个列表值作为主键。

```
select optionDesc from Options where 'MyList' = optionList 
```

然后，您可以使用订单列等对其进行扩展。如果您有一个 ID 字段，这就是您可以参考您的答案的方式......如果它经常更改，您可以将答案值复制到答案表中。

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2008-09-17T20:01:24.400

如果您不介意使用字符串作为实际值，您可以简单地为每个列表赋予不同的 list_id 值并使用以下内容填充单个表：

item_id：整数

list_id：整数

文本：varchar(50)

除非每个列表项需要多个东西，否则似乎最简单

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2008-09-17T20:01:46.503

我们实际上创建了实体来处理**简单的**选择列表。我们创建了一个 Lookup 表，其中包含所有可用的选择列表，以及一个 LookupValue 表，其中包含 Lookup 的所有名称/值记录。  

当我们需要它变得**简单**时，它对我们很有用。

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2008-09-17T20:01:48.267

我以两种不同的方式完成了此操作：1）每个列表的唯一表 2）列表的主表，并提供特定视图

我倾向于更喜欢初始选项，因为它使更新列表更容易（至少在我看来）。

* * *

## 回答 #13

> 赞同：0
> 
>             
> 
> 时间：2008-09-17T20:03:00.760

试着把问题转过来。为什么需要从数据库中提取它？数据不是模型的一部分，但您真的想将其保存在数据库中吗？您可以使用像 linq2sql 或 nhibernate 之类的 OR 映射器（假设您在 .net 世界中），或者根据数据，您可以手动将其存储在每个表中 - 在某些情况下，将其全部放入其中很有意义同一张桌子，但只有在您觉得它非常有意义时才考虑这一点。通常将不同的数据放在不同的表中会使（以后）更容易理解发生了什么。

* * *

## 回答 #14

> 赞同：0
> 
>             
> 
> 时间：2008-09-17T20:04:08.060

这里有几种方法。

1) 每个选择列表创建一个表。每个表都有 ID 和 Name 列；用户选择的值将根据所选项目的 ID 进行存储。

2) 创建一个包含所有选择列表的表。列：ID；列表 ID（或列表类型）；姓名。当您需要填充列表时，请执行查询“选择列表 ID = ... 的所有项目”。这种方法的优点：很容易添加选择列表；缺点：编写分组样式查询有点困难（例如，给我选择值 X 的记录数”。

我个人更喜欢选项 1，它对我来说似乎“更干净”。

* * *

## 回答 #15

> 赞同：0
> 
>             
> 
> 时间：2008-09-17T20:07:11.467

您可以为每个（我的首选）使用单独的表，也可以使用具有类型列的通用选项列表表，您可以使用它从应用程序中进行过滤。一般来说，我不确定一个人是否比另一个人有很大的好处。  

如果您有超过 25 个左右，从组织上讲，使用单表解决方案可能更容易，这样您就不会有多个选项列表表使您的数据库变得混乱。

如果您的列表很长，使用单独的表为每个表使用可能会更好，但如果您的索引等设置正确，这可能可以忽略不计。  

我喜欢使用单独的表，以便如果选项列表中的某些内容发生变化 - 例如它需要和附加属性 - 您可以只更改该选项列表表，而对架构的其余部分几乎没有影响。在单表解决方案中，您要么必须对选项列表数据进行非规范化，将选项列表拉出到单独的表中，等等。在单独的表解决方案中也更容易实施约束。

* * *

## 回答 #16

> 赞同：0
> 
>             
> 
> 时间：2008-09-17T20:10:50.197

这对我们很有帮助：

```
SQL> desc aux_values;
 Name                                      Type
 ----------------------------------------- ------------
 VARIABLE_ID                               VARCHAR2(20)
 VALUE_SEQ                                 NUMBER
 DESCRIPTION                               VARCHAR2(80)
 INTEGER_VALUE                             NUMBER
 CHAR_VALUE                                VARCHAR2(40)
 FLOAT_VALUE                               FLOAT(126)
 ACTIVE_FLAG                               VARCHAR2(1) 
```

“变量 ID”表示数据的类型，如“客户状态”或“缺陷代码”或您需要的任何内容。然后您有几个条目，每个条目都填充了适当的数据类型列。因此，对于一个状态，您将有几个条目，其中填充了“CHAR_VALUE”。******* 
```*****