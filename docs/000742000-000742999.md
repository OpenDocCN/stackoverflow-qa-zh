# StackOverflow 问答 000742000-000742999

# sharepoint - Sharepoint 导入版本错误

> ID：742002
> 
> 赞同：1
> 
> 时间：2009-04-12T16:23:11.670
> 
> 标签：sharepoint, stsadm

我们有一个版本类似于 12.0.4 的 SharePoint 服务器，我们正在尝试导入从另一个 SharePoint 服务器导出的网站集。那里的版本类似于 12.0.0。我们有出口，但我们不再有权访问服务器。我们如何将网站从较低版本导入到较高版本？

我们尝试了 stsadm 导入功能，但这就是我们遇到版本不匹配问题的地方。

有没有人经历过这样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-12T20:01:35.857

查看这篇文章，了解哪些版本号对应于 SharePoint 的哪些更新和补丁的详细列表。

[http://www.mindsharpblogs.com/penny/articles/481.aspx](http://www.mindsharpblogs.com/penny/articles/481.aspx)

你能检查你农场的实际版本号吗？12.0.0.4 对应于 SharePoint 的 RTM 和 Beta 版本。

如果可能的话，让我们知道两端的确切版本号（如果文本在错误中），也许我们可以推荐一个更详细的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-12T17:06:38.370

也许有更好的方法，但这就是我要做的，因为它可以在后台完成，同时做其他事情......

好的，两者都是版本 12，所以这可能只是服务包级别/修补程序等方面的差异。重新设置干净的 SP 环境，没有任何服务包、更新、补丁等。检查版本号。如果低于您的导出，请逐步执行更新，直到版本号完全相同。导入，并且只有在测试您的导入内容之后，才可以选择应用您认为合适的其他更新。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-12T18:34:32.853

而且您也无权访问原始内容数据库？如果确实有，只需从 stsadm 附加内容数据库，它就会即时为您升级数据库。

# hibernate - 如何在 Hibernate/JPA 中为每个持久性单元执行不同的 import.sql？

> ID：742004
> 
> 赞同：2
> 
> 时间：2009-04-12T16:24:12.667
> 
> 标签：hibernate, jpa, import, persistence-unit

我在 JPA/Hibernate 配置中配置了两个持久性单元。现在我需要为每个持久性单元执行不同的 import.sql。如何指定应为每个持久性单元执行哪个 import.sql？根据 Hibernate 文档，我应该将 import.sql 放在类路径中。如果我这样做，import.sql 会在每个持久性单元上执行。我需要以某种方式为每个持久性单元指定不同的 import.sql。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-10-28T23:17:51.757

FWIW，这在 Hibernate 3.6.0.Beta1 中是可能的（参见[HHH-5337](http://opensource.atlassian.com/projects/hibernate/browse/HHH-5337)`hibernate.hbm2ddl.import_files` ），您现在可以使用属性声明要导入的文件：

```
hibernate.hbm2ddl.import_files /mydbload.sql,/mydbload2.sql 
```

因此，您可以为每个持久性单元使用不同的值。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-13T01:33:30.350

当您的应用程序启动时，您可能可以使用 org.hibernate.tool.hbm2ddl.SchemaExport 类手动执行一些操作。

```
SchemaExport schemaExport1 = new SchemaExport(cfg1); // there are various c-tors available
schemaExport1.setInputFile("/import-1.sql");
schemaExport1.create(false, true);

SchemaExport schemaExport2 = new SchemaExport(cfg2);
schemaExport2.setInputFile("/import-2.sql");
schemaExport2.create(false, true); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T11:43:18.773

在我所有的项目中，我只使用一个 import.sql，然后在它旁边创建不同的其他 *.sql（例如：H2_import.sql，sqlServer_import.sql），并根据要使用的持久性单元复制 *.sql 的内容并将其传递到 import.sql

# algorithm - 如何创建 URL 缩短器？

> ID：742013
> 
> 赞同：705
> 
> 时间：2009-04-12T16:29:15.603
> 
> 标签：algorithm, url

我想创建一个 URL 缩短器服务，您可以在其中将长 URL 写入输入字段，该服务将 URL 缩短为“ `http://www.example.org/abcdef`”。

除了 " `abcdef`" 之外，还可以有任何其他包含 6 个字符的字符串`a-z, A-Z and 0-9`。这使得有 56~570 亿个可能的字符串。

我的做法：

我有一个包含三列的数据库表：

1.  id，整数，自增
2.  long, string, 用户输入的长 URL
3.  短、​​字符串、缩短的 URL（或仅六个字符）

然后我会将长 URL 插入表中。然后我会为“”选择自动增量值`id`并构建它的哈希值。然后应将此哈希作为“ `short`”插入。但是我应该建立什么样的哈希？像 MD5 这样的哈希算法会创建太长的字符串。我不使用这些算法，我想。自建算法也可以。

我的点子：

对于 " `http://www.google.de/`" 我得到自动增量 id `239472`。然后我执行以下步骤：

```
short = '';
if divisible by 2, add "a"+the result to short
if divisible by 3, add "b"+the result to short
... until I have divisors for a-z and A-Z. 
```

这可以重复，直到这个数字不再可整除。你认为这是一个好方法吗？你有更好的主意吗？

> [*由于对这个主题的持续兴趣，我已经[在 GitHub 上发布了一个有效的解决方案](https://github.com/delight-im/ShortURL)，其中包含[JavaScript](https://github.com/delight-im/ShortURL/blob/master/JavaScript/ShortURL.js)、[PHP](https://github.com/delight-im/ShortURL/blob/master/PHP/ShortURL.php)、[Python](https://github.com/delight-im/ShortURL/blob/master/Python/shorturl.py)和[Java](https://github.com/delight-im/ShortURL/blob/master/Java/ShortURL.java)的实现。如果您愿意，请添加您的解决方案:)*]

* * *

## 回答 #1

> 赞同：865
> 
> 时间：2009-04-12T16:50:21.747

我会继续你的“将数字转换为字符串”的方法。*但是，如果您的 ID 是素数且大于 52*，您将意识到您提出的算法将失败。

### 理论背景

你需要一个[双射函数](http://en.wikipedia.org/wiki/Bijection) *f*。这是必要的，这样您就可以为您的*f(123) = 'abc'函数找到一个反函数**g('abc') = 123*。这表示：

 **   必须没有*x1, x2（x1 ≠ x2）*会使*f(x1) = f(x2)*，
*   并且对于每个*y*，您必须能够找到一个*x*以便*f(x) = y*。

### 如何将 ID 转换为缩短的 URL

1.  想想我们想要使用的字母表。在你的情况下，那是`[a-zA-Z0-9]`. 它包含*62 个字母*。
2.  采用自动生成的唯一数字键（`id`例如 MySQL 表的自动递增）。

    对于此示例，我将使用 125 [10]（125 以 10 为底）。

3.  现在您必须将 125 [10]转换为 X [62]（以 62 为基数）。

    125 [10] = 2×62 ¹ + 1×62 ⁰ =`[2,1]`

    这需要使用整数除法和取模。一个伪代码示例：

    ```
    digits = []

    while num > 0
      remainder = modulo(num, 62)
      digits.push(remainder)
      num = divide(num, 62)

    digits = digits.reverse 
    ```

    现在将*索引 2 和 1*映射到您的字母表。这就是您的映射（例如使用数组）的样子：

    ```
    0  → a
    1  → b
    ...
    25 → z
    ...
    52 → 0
    61 → 9 
    ```

    使用 2 → c 和 1 → b，您将收到 cb [62]作为缩短的 URL。

    ```
    http://shor.ty/cb 
    ```

### 如何将缩短的 URL 解析为初始 ID

反过来更容易。您只需在字母表中进行反向查找。

1.  e9a [62]将被解析为“字母表中的第 4、61 和 0 个字母”。

    e9a [62] = `[4,61,0]`= 4×62 ² + 61×62 ¹ + 0×62 ⁰ = 19158 [10]

2.  现在找到您的数据库记录`WHERE id = 19158`并进行重定向。

### 示例实现（由评论者提供）

*   [C++](https://gist.github.com/jaytaylor/a11fadf61a869ade0dfe568606b216c8#file-base64-url-shortener-poc-cpp)
*   [Python](https://gist.github.com/778542)
*   [红宝石](https://gist.github.com/1073996)
*   [哈斯克尔](https://gist.github.com/4626401)
*   [C＃](https://gist.github.com/9554733)
*   [咖啡脚本](https://gist.github.com/1158171)
*   [Perl](https://metacpan.org/pod/Short::URL)

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2009-04-12T16:34:42.643

为什么要使用哈希？

您只需将自动增量值简单转换为字母数字值即可。您可以通过使用一些基本转换轻松地做到这一点。假设您的字符空间（AZ、az、0-9 等）有 62 个字符，将 id 转换为 base-40 数字并将字符用作数字。

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2012-07-11T01:30:43.250

```
public class UrlShortener {
    private static final String ALPHABET = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
    private static final int    BASE     = ALPHABET.length();

    public static String encode(int num) {
        StringBuilder sb = new StringBuilder();
        while ( num > 0 ) {
            sb.append( ALPHABET.charAt( num % BASE ) );
            num /= BASE;
        }
        return sb.reverse().toString();   
    }

    public static int decode(String str) {
        int num = 0;
        for ( int i = 0; i < str.length(); i++ )
            num = num * BASE + ALPHABET.indexOf(str.charAt(i));
        return num;
    }   
} 
```

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2009-04-12T17:50:17.717

不是您问题的答案，但我不会使用区分大小写的缩短 URL。它们很难记住，通常不可读（许多字体呈现 1 和 l、0 和 O 以及其他字符非常相似，几乎无法区分）并且容易出错。尝试仅使用小写或大写。

此外，尝试采用一种格式，将数字和字符以预定义的形式混合在一起。有研究表明，人们倾向于比其他形式更好地记住一种形式（想想电话号码，其中数字以特定形式分组）。尝试类似 num-char-char-num-char-char 的方法。我知道这会降低组合，特别是如果你没有大写和小写，但它会更有用，因此更有用。

* * *

## 回答 #5

> 赞同：30
> 
> 时间：2009-04-14T08:02:13.980

我的方法：取数据库 ID，然后[Base36 编码](http://www.stum.de/2008/10/20/base36-encoderdecoder-in-c/)。我不会同时使用大写和小写字母，因为这会使通过电话传输这些 URL 成为一场噩梦，但您当然可以轻松地将功能扩展为 base 62 en/decoder。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2011-11-04T20:10:03.600

这是我的 PHP 5 课程。

```
<?php
class Bijective
{
    public $dictionary = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    public function __construct()
    {
        $this->dictionary = str_split($this->dictionary);
    }

    public function encode($i)
    {
        if ($i == 0)
        return $this->dictionary[0];

        $result = '';
        $base = count($this->dictionary);

        while ($i > 0)
        {
            $result[] = $this->dictionary[($i % $base)];
            $i = floor($i / $base);
        }

        $result = array_reverse($result);

        return join("", $result);
    }

    public function decode($input)
    {
        $i = 0;
        $base = count($this->dictionary);

        $input = str_split($input);

        foreach($input as $char)
        {
            $pos = array_search($char, $this->dictionary);

            $i = $i * $base + $pos;
        }

        return $i;
    }
} 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2018-01-23T03:05:17.340

## ***Node.js 和 MongoDB 解决方案***

因为我们知道 MongoDB 用来创建一个 12 字节的新 ObjectId 的格式。

*   一个 4 字节的值，表示自 Unix 纪元以来的秒数，
*   一个 3 字节的机器标识符，
*   一个 2 字节的进程 ID
*   一个 3 字节的计数器（在您的机器中），从一个随机值开始。

示例（我选择一个随机序列） **a1b2c3d4e5f6g7h8i9j1k2l3**

*   a1b2c3d4 表示自 Unix 纪元以来的秒数，
*   4e5f6g7 代表机器标识符，
*   h8i9 代表进程id
*   j1k2l3 代表计数器，从一个随机值开始。

由于如果我们将数据存储在同一台机器中，计数器将是唯一的，我们可以毫无疑问地得到它，它会重复。

***所以短 URL 将是计数器***，这里是一个代码片段，假设您的服务器运行正常。

```
const mongoose = require('mongoose');
const Schema = mongoose.Schema;

// Create a schema
const shortUrl = new Schema({
    long_url: { type: String, required: true },
    short_url: { type: String, required: true, unique: true },
  });
const ShortUrl = mongoose.model('ShortUrl', shortUrl);

// The user can request to get a short URL by providing a long URL using a form

app.post('/shorten', function(req ,res){
    // Create a new shortUrl */
    // The submit form has an input with longURL as its name attribute.
    const longUrl = req.body["longURL"];
    const newUrl = ShortUrl({
        long_url : longUrl,
        short_url : "",
    });
    const shortUrl = newUrl._id.toString().slice(-6);
    newUrl.short_url = shortUrl;
    console.log(newUrl);
    newUrl.save(function(err){
        console.log("the new URL is added");
    })
}); 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2018-01-25T02:24:22.880

我不断增加数据库中每个域的整数序列，并使用[哈希](http://hashids.org/)将整数编码为 URL 路径。

```
static hashids = Hashids(salt = "my app rocks", minSize = 6) 
```

我运行了一个脚本来查看用完字符长度需要多长时间。对于六个字符，它可以进行`164,916,224`链接，然后最多可达七个字符。Bitly 使用七个字符。五个字符以下对我来说看起来很奇怪。

[Hashids](http://hashids.org/)可以将 URL 路径解码回整数，但更简单的解决方案是使用整个短链接`sho.rt/ka8ds3`作为主键。

这是完整的概念：

```
function addDomain(domain) {
    table("domains").insert("domain", domain, "seq", 0)
}

function addURL(domain, longURL) {
    seq = table("domains").where("domain = ?", domain).increment("seq")
    shortURL = domain + "/" + hashids.encode(seq)
    table("links").insert("short", shortURL, "long", longURL)
    return shortURL
}

// GET /:hashcode
function handleRequest(req, res) {
    shortURL = req.host + "/" + req.param("hashcode")
    longURL = table("links").where("short = ?", shortURL).get("long")
    res.redirect(301, longURL)
} 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2011-01-17T21:35:46.107

您可以散列整个 URL，但如果您只想缩短 id，请按照 marcel 的建议进行操作。我写了这个 Python 实现：

[https://gist.github.com/778542](https://gist.github.com/778542)

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2013-03-08T20:17:28.813

**C#版本：**

```
public class UrlShortener 
{
    private static String ALPHABET = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
    private static int    BASE     = 62;

    public static String encode(int num)
    {
        StringBuilder sb = new StringBuilder();

        while ( num > 0 )
        {
            sb.Append( ALPHABET[( num % BASE )] );
            num /= BASE;
        }

        StringBuilder builder = new StringBuilder();
        for (int i = sb.Length - 1; i >= 0; i--)
        {
            builder.Append(sb[i]);
        }
        return builder.ToString(); 
    }

    public static int decode(String str)
    {
        int num = 0;

        for ( int i = 0, len = str.Length; i < len; i++ )
        {
            num = num * BASE + ALPHABET.IndexOf( str[(i)] ); 
        }

        return num;
    }   
} 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2020-03-17T11:32:46.330

Take a look at [https://hashids.org/](https://hashids.org/) it is open source and in many languages.

Their page outlines some of the pitfalls of other approaches.

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-04-12T17:12:05.453

如果您不想重新发明轮子... [http://lilurl.sourceforge.net/](http://lilurl.sourceforge.net/)

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2011-12-20T10:59:29.433

```
// simple approach

$original_id = 56789;

$shortened_id = base_convert($original_id, 10, 36);

$un_shortened_id = base_convert($shortened_id, 36, 10); 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-11-21T22:21:06.480

```
alphabet = map(chr, range(97,123)+range(65,91)) + map(str,range(0,10))

def lookup(k, a=alphabet):
    if type(k) == int:
        return a[k]
    elif type(k) == str:
        return a.index(k)

def encode(i, a=alphabet):
    '''Takes an integer and returns it in the given base with mappings for upper/lower case letters and numbers 0-9.'''
    try:
        i = int(i)
    except Exception:
        raise TypeError("Input must be an integer.")

    def incode(i=i, p=1, a=a):
        # Here to protect p.                                                                                                                                                                                                                
        if i <= 61:
            return lookup(i)

        else:
            pval = pow(62,p)
            nval = i/pval
            remainder = i % pval
            if nval <= 61:
                return lookup(nval) + incode(i % pval)
            else:
                return incode(i, p+1)

    return incode()

def decode(s, a=alphabet):
    '''Takes a base 62 string in our alphabet and returns it in base10.'''
    try:
        s = str(s)
    except Exception:
        raise TypeError("Input must be a string.")

    return sum([lookup(i) * pow(62,p) for p,i in enumerate(list(reversed(s)))])a 
```

这是我的版本，供需要的人使用。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-04-12T16:35:32.657

为什么不把你的 id 翻译成一个字符串呢？您只需要一个将 0 到 61 之间的数字映射到单个字母（大写/小写）或数字的函数。然后应用它来创建，比如说，4 个字母的代码，你已经覆盖了 1470 万个 URL。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2012-02-13T01:10:44.523

这是一个不错的 PHP URL 编码函数...

```
// From http://snipplr.com/view/22246/base62-encode--decode/
private function base_encode($val, $base=62, $chars='0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ') {
    $str = '';
    do {
        $i = fmod($val, $base);
        $str = $chars[$i] . $str;
        $val = ($val - $i) / $base;
    } while($val > 0);
    return $str;
} 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2012-03-29T21:42:46.827

不知道是否有人会觉得这很有用——它更像是一种“hack n slash”方法，但如果你只想要特定的字符，它很简单而且效果很好。

```
$dictionary = "abcdfghjklmnpqrstvwxyz23456789";
$dictionary = str_split($dictionary);

// Encode
$str_id = '';
$base = count($dictionary);

while($id > 0) {
    $rem = $id % $base;
    $id = ($id - $rem) / $base;
    $str_id .= $dictionary[$rem];
}

// Decode
$id_ar = str_split($str_id);
$id = 0;

for($i = count($id_ar); $i > 0; $i--) {
    $id += array_search($id_ar[$i-1], $dictionary) * pow($base, $i - 1);
} 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2012-04-30T16:17:18.517

您是否故意省略了 O、0 和 i？

我刚刚基于 Ryan 的解决方案创建了一个 PHP 类。

```
<?php

    $shorty = new App_Shorty();

    echo 'ID: ' . 1000;
    echo '<br/> Short link: ' . $shorty->encode(1000);
    echo '<br/> Decoded Short Link: ' . $shorty->decode($shorty->encode(1000));

    /**
     * A nice shorting class based on Ryan Charmley's suggestion see the link on Stack Overflow below.
     * @author Svetoslav Marinov (Slavi) | http://WebWeb.ca
     * @see http://stackoverflow.com/questions/742013/how-to-code-a-url-shortener/10386945#10386945
     */
    class App_Shorty {
        /**
         * Explicitly omitted: i, o, 1, 0 because they are confusing. Also use only lowercase ... as
         * dictating this over the phone might be tough.
         * @var string
         */
        private $dictionary = "abcdfghjklmnpqrstvwxyz23456789";
        private $dictionary_array = array();

        public function __construct() {
            $this->dictionary_array = str_split($this->dictionary);
        }

        /**
         * Gets ID and converts it into a string.
         * @param int $id
         */
        public function encode($id) {
            $str_id = '';
            $base = count($this->dictionary_array);

            while ($id > 0) {
                $rem = $id % $base;
                $id = ($id - $rem) / $base;
                $str_id .= $this->dictionary_array[$rem];
            }

            return $str_id;
        }

        /**
         * Converts /abc into an integer ID
         * @param string
         * @return int $id
         */
        public function decode($str_id) {
            $id = 0;
            $id_ar = str_split($str_id);
            $base = count($this->dictionary_array);

            for ($i = count($id_ar); $i > 0; $i--) {
                $id += array_search($id_ar[$i - 1], $this->dictionary_array) * pow($base, $i - 1);
            }
            return $id;
        }
    }
?> 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2016-07-22T12:16:58.603

```
public class TinyUrl {

        private final String characterMap = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
        private final int charBase = characterMap.length();

        public String covertToCharacter(int num){
            StringBuilder sb = new StringBuilder();

            while (num > 0){
                sb.append(characterMap.charAt(num % charBase));
                num /= charBase;
            }

            return sb.reverse().toString();
        }

        public int covertToInteger(String str){
            int num = 0;
            for(int i = 0 ; i< str.length(); i++)
                num += characterMap.indexOf(str.charAt(i)) * Math.pow(charBase , (str.length() - (i + 1)));

            return num;
        }
}

class TinyUrlTest{

    public static void main(String[] args) {
        TinyUrl tinyUrl = new TinyUrl();
        int num = 122312215;
        String url = tinyUrl.covertToCharacter(num);
        System.out.println("Tiny url:  " + url);
        System.out.println("Id: " + tinyUrl.covertToInteger(url));
    }
} 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2011-03-10T18:34:32.043

这就是我使用的：

```
# Generate a [0-9a-zA-Z] string
ALPHABET = map(str,range(0, 10)) + map(chr, range(97, 123) + range(65, 91))

def encode_id(id_number, alphabet=ALPHABET):
    """Convert an integer to a string."""
    if id_number == 0:
        return alphabet[0]

    alphabet_len = len(alphabet) # Cache

    result = ''
    while id_number > 0:
        id_number, mod = divmod(id_number, alphabet_len)
        result = alphabet[mod] + result

    return result

def decode_id(id_string, alphabet=ALPHABET):
    """Convert a string to an integer."""
    alphabet_len = len(alphabet) # Cache
    return sum([alphabet.index(char) * pow(alphabet_len, power) for power, char in enumerate(reversed(id_string))]) 
```

它非常快并且可以取长整数。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2011-04-22T18:04:44.120

对于一个类似的项目，为了获得一个新的密钥，我在一个[随机字符串生成](http://search.cpan.org/perldoc?String%3a%3aRandom)器周围创建了一个包装函数，该函数调用生成器，直到我得到一个尚未在我的哈希表中使用的字符串。一旦您的名称空间开始变满，此方法会变慢，但正如您所说，即使只有 6 个字符，您也有足够的名称空间可以使用。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2015-03-15T09:42:53.713

我有一个问题的变体，因为我存储了来自许多不同作者的网页，并且需要防止通过猜测发现页面。因此，我的短 URL 为页码的 Base-62 字符串添加了几个额外的数字。这些额外的数字是根据页面记录本身的信息生成的，它们确保 3844 个 URL 中只有 1 个有效（假设为 2 位 Base-62）。[您可以在http://mgscan.com/MBWL](http://mgscan.com/MBWL)上查看概要说明。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2015-12-06T20:50:02.787

很好的答案，我创建了 bjf 的 Golang 实现：

```
package bjf

import (
    "math"
    "strings"
    "strconv"
)

const alphabet = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"

func Encode(num string) string {
    n, _ := strconv.ParseUint(num, 10, 64)
    t := make([]byte, 0)

    /* Special case */
    if n == 0 {
        return string(alphabet[0])
    }

    /* Map */
    for n > 0 {
        r := n % uint64(len(alphabet))
        t = append(t, alphabet[r])
        n = n / uint64(len(alphabet))
    }

    /* Reverse */
    for i, j := 0, len(t) - 1; i < j; i, j = i + 1, j - 1 {
        t[i], t[j] = t[j], t[i]
    }

    return string(t)
}

func Decode(token string) int {
    r := int(0)
    p := float64(len(token)) - 1

    for i := 0; i < len(token); i++ {
        r += strings.Index(alphabet, string(token[i])) * int(math.Pow(float64(len(alphabet)), p))
        p--
    }

    return r
} 
```

托管在 github：[https ://github.com/xor-gate/go-bjf](https://github.com/xor-gate/go-bjf)

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2016-09-19T07:04:10.250

我的 Python 3 版本

```
base_list = list("0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ")
base = len(base_list)

def encode(num: int):
    result = []
    if num == 0:
        result.append(base_list[0])

    while num > 0:
        result.append(base_list[num % base])
        num //= base

    print("".join(reversed(result)))

def decode(code: str):
    num = 0
    code_list = list(code)
    for index, code in enumerate(reversed(code_list)):
        num += base_list.index(code) * base ** index
    print(num)

if __name__ == '__main__':
    encode(341413134141)
    decode("60FoItT") 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2017-01-05T07:22:06.287

这是一个可能 bit.ly 的 Node.js 实现。生成一个高度随机的七字符字符串。

它使用 Node.js 加密来生成高度随机的 25 个字符集，而不是随机选择 7 个字符。

```
var crypto = require("crypto");
exports.shortURL = new function () {
    this.getShortURL = function () {
        var sURL = '',
            _rand = crypto.randomBytes(25).toString('hex'),
            _base = _rand.length;
        for (var i = 0; i < 7; i++)
            sURL += _rand.charAt(Math.floor(Math.random() * _rand.length));
        return sURL;
    };
} 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2017-06-04T03:17:12.583

如需优质的 Node.js / JavaScript 解决方案，请参阅[id-shortener](https://www.npmjs.com/package/id-shortener)模块，该模块经过全面测试并已在生产环境中使用了数月。

它提供了一个高效的 id/URL 缩短器，由默认为**Redis**的可插入存储支持，您甚至可以自定义短 id 字符集以及缩短是否是*幂等*的。这是一个重要的区别，并非所有 URL 缩短器都考虑在内。

关于此处的其他答案，此模块实现了上述 Marcel Jackwerth 出色的公认答案。

该解决方案的核心由以下 Redis Lua[片段](https://github.com/fisch0920/id-shortener/blob/master/lib/storage-redis.js)提供：

```
local sequence = redis.call('incr', KEYS[1])

local chars = '0123456789ABCDEFGHJKLMNPQRSTUVWXYZ_abcdefghijkmnopqrstuvwxyz'
local remaining = sequence
local slug = ''

while (remaining > 0) do
  local d = (remaining % 60)
  local character = string.sub(chars, d + 1, d + 1)

  slug = character .. slug
  remaining = (remaining - d) / 60
end

redis.call('hset', KEYS[2], slug, ARGV[1])

return slug 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2017-11-18T13:05:15.997

在 Scala 中的实现：

```
class Encoder(alphabet: String) extends (Long => String) {

  val Base = alphabet.size

  override def apply(number: Long) = {
    def encode(current: Long): List[Int] = {
      if (current == 0) Nil
      else (current % Base).toInt :: encode(current / Base)
    }
    encode(number).reverse
      .map(current => alphabet.charAt(current)).mkString
  }
}

class Decoder(alphabet: String) extends (String => Long) {

  val Base = alphabet.size

  override def apply(string: String) = {
    def decode(current: Long, encodedPart: String): Long = {
      if (encodedPart.size == 0) current
      else decode(current * Base + alphabet.indexOf(encodedPart.head),encodedPart.tail)
    }
    decode(0,string)
  }
} 
```

使用 Scala 测试的测试示例：

```
import org.scalatest.{FlatSpec, Matchers}

class DecoderAndEncoderTest extends FlatSpec with Matchers {

  val Alphabet = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"

  "A number with base 10" should "be correctly encoded into base 62 string" in {
    val encoder = new Encoder(Alphabet)
    encoder(127) should be ("cd")
    encoder(543513414) should be ("KWGPy")
  }

  "A base 62 string" should "be correctly decoded into a number with base 10" in {
    val decoder = new Decoder(Alphabet)
    decoder("cd") should be (127)
    decoder("KWGPy") should be (543513414)
  }

} 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2018-03-25T18:55:33.800

基于 Xeoncross 类的函数

```
function shortly($input){
$dictionary = ['a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z','A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z','0','1','2','3','4','5','6','7','8','9'];
if($input===0)
    return $dictionary[0];
$base = count($dictionary);
if(is_numeric($input)){
    $result = [];
    while($input > 0){
        $result[] = $dictionary[($input % $base)];
        $input = floor($input / $base);
    }
    return join("", array_reverse($result));
}
$i = 0;
$input = str_split($input);
foreach($input as $char){
    $pos = array_search($char, $dictionary);
    $i = $i * $base + $pos;
}
return $i;
} 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2019-11-14T18:05:14.413

为什么不直接生成一个随机字符串并将其附加到基本 URL？这是在**C#**中执行此操作的一个非常简化的版本。

```
static string chars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890";
static string baseUrl = "https://google.com/";

private static string RandomString(int length)
{
    char[] s = new char[length];
    Random rnd = new Random();
    for (int x = 0; x < length; x++)
    {
        s[x] = chars[rnd.Next(chars.Length)];
    }
    Thread.Sleep(10);

    return new String(s);
} 
```

然后只需将随机字符串添加到 baseURL：

```
string tinyURL = baseUrl + RandomString(5); 
```

**请记住，这是一个非常简化的版本，RandomString 方法可能会创建重复的字符串。在生产中，您需要考虑重复字符串，以确保您始终拥有唯一的 URL。**我有一些代码通过查询我可以共享的数据库表来考虑重复字符串，如果有人感兴趣的话。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2019-12-10T08:27:08.253

这是我的初步想法，还可以多做一些思考，或者做一些模拟，看看效果好不好或者需要改进：

我的答案是记住数据库中的长 URL，并使用 ID`0`来`9999999999999999`（或需要多大的数字）。

但是 ID 0`9999999999999999`可能是个问题，因为

1.  如果我们使用十六进制，甚至 base62 或 base64，它可以更短。（base64 就像 YouTube 使用`A`- `Z` `a`- `z` `0`-`9` `_`和`-`）
2.  如果它从`0`到`9999999999999999`均匀增加，那么黑客可以按顺序访问它们并知道人们互相发送的 URL，所以这可能是一个隐私问题

我们可以完成这个：

1.  有一台服务器分配`0`给`999`一台服务器，服务器 A，所以现在服务器 A 有 1000 个这样的 ID。因此，如果有 20 或 200 台服务器不断需要新 ID，则不必一直要求每个新 ID，而是要求 1000 个 ID 一次
2.  例如，对于 ID 1，反转位。所以 `000...00000001`变成`10000...000`了，所以当转换为base64时，每次都会不均匀地增加ID。
3.  使用 XOR 翻转最终 ID 的位。例如，与`0xD5AA96...2373`（如密钥）进行异或，一些位将被翻转。（只要密钥打开 1 位，它就会翻转 ID 的位）。这将使 ID 更加难以猜测并且显得更加随机

按照这种方案，分配 ID 的单个服务器可以形成 ID，请求分配 ID 的 20 或 200 个服务器也可以形成 ID。分配服务器必须使用锁/信号量来防止两个请求服务器获得相同的批次（或者如果它一次接受一个连接，这已经解决了问题）。所以我们不希望行（队列）太长等待获得分配。这就是为什么一次分配 1000 或 10000 可以解决问题的原因。

# c# - 如何使用 LINQ to SQL 在 DataGridView 中编辑数据库记录？

> ID：742015
> 
> 赞同：0
> 
> 时间：2009-04-12T16:30:25.897
> 
> 标签：c#, linq-to-sql, datagridview

我很接近这个，但我需要一点帮助。我有一个简单的 WinForms 应用程序，它使用 LINQ to SQL 来获取需要从数据库中查看的数据并将其填充到`DataGridView`. 这部分效果很好，但我似乎无法建立的连接是如何在事情发生变化时将数据恢复到数据库中。

这是我到目前为止所拥有的：

```
db = new SiteDataDataContext();
src = new BindingSource();
src.DataSource = GetSitesPendingApproval(); // Returns IQueryable<Site>.
dataGridView1.DataSource = src;
dataGridView1.AllowUserToDeleteRows = true;
dataGridView1.EditMode = DataGridViewEditMode.EditOnEnter; 
```

我有两个我希望能够采取的行动：

1.  当`checkbox`值`boolean`( `IsActive`[ `DataGridView.Columns`7]) 被选中/取消选中时，我希望将更改发送到数据库。
2.  当从 中删除记录时`datagridview`，我希望它也从数据库中删除。

我显然缺少某种绑定、提交、合并、追加或单元格更改事件处理程序，但我无法找出连接以发回更改。如果更容易进行所有更改，然后点击某种提交按钮将其全部发送回来，那也很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-12T16:57:46.207

您是否尝试为 UserDeletingRow 事件添加事件处理程序，该事件使用行上的 id 从数据库中删除该行？

```
private void DataGrid_UserDeletingRow(object sender,
                                           DataGridCommandEventArgs e)
{
    TableCell itemCell = e.Item.Cells[0]; // assumes id is in column 0

    int id = int.Parse(item.Text); // assumes it's non-null

    using (var dc = new SiteDataDataContext())
    {
         var site = dc.Sites.Where(s => s.ID == id).SingleOrDefault();

         if (site != null)
         {
             try
             {
                dc.Sites.DeleteOnSubmit( site );
                dc.SubmitChanges();
                dataGridView1.Bind();
             }
             catch (SqlException)
             {
                e.Cancel = true;
             }
         }
     }
} 
```

如果删除失败，您也可能会提供错误消息，但如何执行取决于您的应用程序。

# c# - 长时间运行的 Windows 服务

> ID：742021
> 
> 赞同：1
> 
> 时间：2009-04-12T16:33:58.977
> 
> 标签：c#, .net, windows-services

伙计们，

我想开发一个长期运行的 Windows 服务（它应该可以正常工作几个月），我想知道这里有什么更好的选择：

1.  在 OnStop 方法中使用 while(true) 循环
2.  使用计时器每 n 秒打勾并触发我的代码
3.  还有其他选择吗？

谢谢伊萨姆

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-12T16:36:39.690

我不会做#1。

我要么做#2，要么在 OnStart 期间分离一个单独的线程来完成实际工作。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-12T16:45:40.620

除了#1
服务经理（或用户，如果他是激活控件的人）期望`OnStart()`并`OnStop()`及时返回。
它通常的做法是启动你自己的线程来保持运行，当然，还要监听一个可能会告诉它停止的事件。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-12T16:41:07.150

可能值得考虑间隔较短的计划任务。节省了编写大量管道代码和处理[Windows 服务计时器](http://blog.realcoderscoding.com/index.php/2008/09/systemthreadingtimer-stops-firing-in-windows-server-2003-sp1/)的特殊性。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-14T07:34:47.337

不要乱用服务控制器代码。如果服务想停止，使用#1 只会让事情变得更糟。顺便说一句，该服务总是会**崩溃**，在这种情况下，您的 while(true) 将无济于事。

如果你真的想拥有一个“*正在运行的 Windows 服务（它应该可以正常运行几个月）* ”，你最好确保在将自己的代码作为服务运行**之前**，使用单元和集成测试对你自己的代码进行了**正确和彻底的测试。**

 *** * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-12T19:10:20.973

我不会推荐#1。

我过去为完全相同的场景/情况所做的是创建一个每 N 秒运行一次的计划任务，启动一个简单地执行以下两件事的小脚本：#1 检查“IsAlreadyRunning”标志（读取来自数据库）#2 如果标志为真，则脚本立即停止结束退出。如果标志为假，则脚本会在新线程中启动一个单独的进程 (exe)（该线程利用服务来执行可能非常短或有时非常长的任务，具体取决于要处理的记录数量）。这个过程当然会设置和重置 IsAlreadyRunning 标志，以确保线程不会启动重叠的操作。我有一项服务已经使用这种方法运行了多年，而且我从来没有遇到过任何问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-12T20:10:55.260

是不是在做一个

# 1 个清理任务，或

# 2 醒来并查看是否需要运行任务

如果它类似于#2，那么使用 MSMQ 会更合适。使用 MSMQ 任务几乎可以立即完成。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-12T16:41:53.437

该类[`System.Threading.Timer`](http://msdn.microsoft.com/en-us/library/system.threading.timer.aspx)似乎适合这种用法。

# .net - 您推荐使用哪个 .NET 库/包装器来嗅探数据包？

> ID：742024
> 
> 赞同：1
> 
> 时间：2009-04-12T16:35:14.967
> 
> 标签：.net, packet-capture, winpcap, sniffing

据我了解.NET 中的所有嗅探库只是 WinpCap 的一个包装器，这没关系。如果您知道任何其他更好的选择，请写为答案。

你用过它们中的任何一个吗？根据您的经验，哪一个是最好的？

*我只在寻找具有商业友好许可证的图书馆，而且商业图书馆只要价格合适就可以了*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-12T17:10:36.033

为什么不使用[Microsoft 网络监视器](https://connect.microsoft.com/site/sitehome.aspx?SiteID=216)？[除了CodePlex](http://www.CodePlex.com/NMParsers)上提供的一组解析器之外，它是免费的、受支持的，并且有一个您可以使用的 API 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-11-12T01:53:15.363

看看[SharpPcap](http://sourceforge.net/projects/sharppcap/)（C# 包装器和数据包解析器或 WinPcap）。

WinPcap 和 SharpPcap 都是在允许再分发的许可下开发的。

# asp.net - 在 Web 表单上使用带有文本框的强类型数据集

> ID：742029
> 
> 赞同：0
> 
> 时间：2009-04-12T16:37:15.227
> 
> 标签：asp.net, strongly-typed-dataset

我想在 Web 表单上使用带有文本框的强类型数据集。我怎样才能做到这一点？干杯米克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-12T19:21:45.143

我真的对这个问题感到困惑，但是如果您使用的是linq，您可以查询数据库然后调用`Singleordefault()`函数返回单个记录，那么您只需这样做

```
TextBox1.Text = SingleRecordQuery().YourDBField; 
```

希望这可以帮助。

# c++ - qpThreads 文档

> ID：742034
> 
> 赞同：1
> 
> 时间：2009-04-12T16:42:34.463
> 
> 标签：c++, documentation

有没有关于 qpThreads 的文档？它与 pthread 有什么不同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-12T17:36:34.850

看起来[qpthread](http://sourceforge.net/projects/qpthread/)已经成为了一个 sourceforge 项目。从 CVS 存储库来看，它在四五年内没有变化，而且似乎不包含任何文档。很有可能，如果您没有文档，那么除了源代码和标头之外，什么都不存在。

出于好奇，我抓住了源代码，它看起来像是一个非常标准的线程实现，它分层在 pthread 之上。最大的区别是 pthreads 是一个 C 风格的接口，而 qpThreads 是一个 OO 接口，更类似于 Java 中的接口。我没有深入研究它，但您可能想查看[java.util.Timer](http://java.sun.com/j2se/1.3/docs/api/java/util/Timer.html)和[java.util.concurrent](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/package-summary.html)之类的接口。一些接口看起来与 qpThreads 提供的非常相似。

您可能想研究用[Boost.thread](http://www.boost.org/doc/libs/1_38_0/doc/html/thread.html)或更新的东西替换它。很有可能你会更幸运地维护它。根据您必须处理的代码量，这应该不难做到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-12T16:50:32.150

粗略看一下 google 搜索结果，qpThreads 似乎是一个不起眼的 C++ 线程类库。pthreads 是一个使用非常广泛的、符合 POSIX 的、多平台线程 C API。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T01:02:02.970

使用库最重要的是确保它们得到积极维护。如果可能，您应该使用一个众所周知且使用量很大的库。这样，如果您有任何问题，您也将有大量的人来提问。

有关更多详细信息，请参阅此类似的 SO 问题： [Good c++ lib for threading](https://stackoverflow.com/questions/596360/good-c-lib-for-threading)（或使用搜索框了解更多信息）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-13T09:37:42.980

终于找到了一些文档。

[Sourceforge qpthreads](http://sourceforge.net/docman/display_doc.php?docid=21185&group_id=100112)

# events - Flex 实际 CreationComplete 事件

> ID：742035
> 
> 赞同：1
> 
> 时间：2009-04-12T16:42:55.150
> 
> 标签：events, apache-flex

如果我想确保组件内的所有嵌套组件都已创建，我应该使用哪个事件？

Creationcomplete 似乎无法以这种方式工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-12T16:46:34.453

这取决于正在使用的（[在此处](https://web.archive.org/web/20090731121621/http://livedocs.adobe.com/flex/3/html/help.html?content=layoutperformance_05.html)[`creationPolicy`](http://livedocs.adobe.com/flex/3/html/layoutperformance_05.html)存档）。请通过提供的链接了解为什么它不能按您期望的方式工作。

# xml - 我是否必须为基于 XML 的服务器-客户端协议声明多个或仅一个命名空间？

> ID：742041
> 
> 赞同：0
> 
> 时间：2009-04-12T16:47:30.567
> 
> 标签：xml, xsd, protocols

我目前正在开发一个客户端-服务器应用程序，我想使用 XML 作为协议。现在，我不太确定声明 XML 名称空间和创建 XML 模式。

不用说服务器和客户端发送不同的东西，即客户端发送请求，服务器响应它们，因此使用不同的标签等等。双方的共同点是发送的 XML 数据是流式的，并且文档的根称为`<stream>`，但是 - 正如我所说 - 中的标签是不同的（每个分别代表请求或响应）。

现在，这是两种不同的 XM 语言吗？我应该为它们中的每一个声明一个命名空间（因此也声明一个 XSD）吗？还是我应该使用一个并添加一个属性“发送者”来定义端（服务器|客户端）？在后一种情况下：那么我如何区分属性值？也就是说，如何在 XSD 中声明哪个标签可以用于什么“发件人”值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-12T17:07:04.483

由于这两个`<stream>`元素的内容不同，所以它们是本地名称相同的两个不同元素，但需要进行不同的验证。这意味着它们必须位于单独的名称空间中，因此必须位于单独的模式中。

但是，如果发送者和接收者元素的`<stream>`内容共享相同的元素或属性，那么您应该添加第三个模式，该模式具有共同的内容。其他两个模式将导入通用模式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-12T17:29:45.660

通常情况下，似乎没有一个正确的答案。

我不知道 `<stream>`对请求和响应使用相同的元素标记（即 ）有什么好处。例如，您可以使用`<request>`和`<response>`作为单独的顶级元素。这可能更有意义，并且还会加强对两种消息类型使用不同名称空间（和模式）的论点。

但是，如果您有充分的理由将`<stream>`其用作请求和响应的顶级标记，那么您**可以**定义一个模式，即`<stream>`一种`union`类型。联合成员将包含适用于请求或响应的元素，但不能同时适用于两者。如果这似乎是正确的做法，这种结构将使两侧保持在同一个命名空间中变得更容易。

如果我看到请求和响应协议是紧密耦合的，我会更倾向于走这条路，这样对一个协议的更改可能也需要对另一个协议进行更改。如果响应集中的信息类型可以随时间（或通过应用程序）改变，那么单独的命名空间会更有意义。

# javascript - HTML 页面中的 VML/SVG 编辑器

> ID：742042
> 
> 赞同：3
> 
> 时间：2009-04-12T16:47:50.800
> 
> 标签：javascript, html, svg, tinymce

在过去的几年里，我已经集成了各种 WYSIWYG HTML 编辑器，但我认为我在这方面遇到了障碍。

我们需要一种让人们编辑文本的方法，该文本在渲染时会变成 VML/SVG，但仍可编辑，具有最少的样式，例如粗体、斜体、字体和大小，并且如果可能的话，能够在画布上的任何位置创建文本区域. Google Docs 在他们的演示文稿编辑器中似乎有一个。类似的东西会起作用〜它非常接近我们正在寻找的东西。

有谁知道这样做的商业或免费编辑器（必须是基于浏览器的），如果没有，有没有人接近这样做，如果有，你的结果是什么。欢迎任何其他信息、链接、建议等 - 我似乎在这个问题上碰了壁。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-01-04T17:15:06.690

您可以尝试[http://svg-edit.googlecode.com/](http://svg-edit.googlecode.com/)虽然我们不会翻译成 VML（我们要求 IE 用户安装 Google Chrome Frame 插件）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-13T16:12:36.557

首先是一个重要的问题：为什么 WYSIWYG 编辑器的输出应该是 VML/SVG？

===

我不知道有任何符合您描述的现有编辑器。你可能需要自己写一个。如果您要自己动手，我有两个建议；其中一个我在能力方面不太自信，另一个我不完全确定性能影响，因为涉及的库数量众多。无论哪种方式，我认为这是两个最好的选择：

1）如果您打算使用 VML/SVG，我知道可以将两者结合在一起的一个库是 RaphaelJS，它具有一定程度的文本支持，但我真的不确定文本的操作程度有多复杂：

*   拉斐尔 JS 库：[http ://raphaeljs.com/index.html](http://raphaeljs.com/index.html)

2) 你可以改用 VML/Canvas 吗？除了新的 canvas-text 库之外，我建议通过 exCanvas 库使用 VML/Canvas（它允许您使用 HTML5 canvas 元素编写代码，该元素会在 IE/Trident 浏览器中自动转换为 VML）。

*   通用画布信息（通用绘图api）： [https ://developer.mozilla.org/en/Canvas_tutorial](https://developer.mozilla.org/en/Canvas_tutorial)
*   exCanvas（画布元素的 IE 兼容层） [http://excanvas.sourceforge.net/](http://excanvas.sourceforge.net/)
*   画布文本（对画布文本支持较差的浏览器的文本特定扩展）： [http ://ajaxian.com/archives/canvas-text-add-text-functions-to-subpar-canvas-implementations](http://ajaxian.com/archives/canvas-text-add-text-functions-to-subpar-canvas-implementations)

# windows - 有没有关于 Windows 中的 makefile 的资料？

> ID：742044
> 
> 赞同：1
> 
> 时间：2009-04-12T16:48:14.233
> 
> 标签：windows, linux, makefile

Windows和Linux中的makefile有什么区别吗？

如果我知道如何在Linux中使用它，是否有必要学习

在 Windows 系统中有什么新东西吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T09:30:44.180

[GnuWin32](http://gnuwin32.sourceforge.net/)的优秀人员已经[为 Windows 构建了](http://gnuwin32.sourceforge.net/packages/make.htm)Gnu make作为本机二进制文件。它运行良好，但由于试图将命名`foo`为 file的目标等同于善意的黑客攻击，确实有一些小怪癖`foo.exe`。GnuWin32 软件包确实包含一份不错的 PDF 手册 IIRC。

我在 XP 和[MinGW](http://www.mingw.org/)项目的 GCC 以及几个不同的嵌入式系统交叉编译器工具链上使用它。MinGW 还提供了 Gnu Make 的原生构建。

我们确实在几个项目中使用了 Cygwin，特别是在一个片上系统供应商提供了一个完整的、工作的工具链和托管在 Cygwin 中的构建环境的项目中。将其迁移到原生 Windows 形状的构建会非常昂贵，并且会更难接受来自供应商的更新。

如果您想主要使用本机 Windows 工具，但需要首先在现有源工具包上运行 configure，那么请查看 MSYS。这最初是由 MinGW 开发人员作为 Cygwin 的一个分支，它打算提供一组最小的类 unix 工具和一个 bash shell，以便 configure 可以在 Windows 上使用。它不像 Cygwin 那样完整，但重量要轻得多。

您会发现 Gnu Make 的手册大部分是正确的。但是，您必须记住，Makefile 的内容不是用单一语言编写的。定义变量和布局依赖树的东西是一种语言。动作的每一行都是一个微型 shell 脚本，使用默认 shell 的语言（在 Windows 上可能是 CMD.EXE 而不是 /bin/sh），每个命令都有选项和参数。

如果您对 *nix 构建环境感到满意，那么 Cygwin 可能是最痛苦的路径。但是 MSYS 通常就足够了，采用目标平台的本机工具有一些话要说，以便您了解用户如何看待 Windows，在这种情况下，MinGW 和 GnuWin32 是方便了解的资源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-12T16:57:44.317

除了[iftrue](https://stackoverflow.com/users/78182/iftrue)之外，微软还有一个`Makefile`基于构建工具的调用，它对传统的基于 *nix 的工具[`nmake`](http://msdn.microsoft.com/en-us/library/dd9y37ha(VS.71).aspx)的语法/语义进行了一些更改。`make`此[页面](http://www.bell-labs.com/project/nmake/faq/gmake.html#compare)列出了一些差异。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-12T16:51:56.250

好吧，如果你下载“ [cygwin](http://www.cygwin.com/) ”，你可以直接在windows上运行“make”工具，但你可能想看看真正的跨平台构建工具，比如“ [cmake](http://www.cmake.org) ”。它就像 make，但它更漂亮一点，并且本质上是跨平台的。

# algorithm - 如何设计一个近似路径解决方案？

> ID：742052
> 
> 赞同：0
> 
> 时间：2009-04-12T16:53:51.817
> 
> 标签：algorithm, search, graph-theory

我正在尝试编写（或扩展现有的）图搜索算法，考虑到无法保证节点将被连接，该算法将让我找到最接近目标节点的路径。

为了提供一个实际的应用，假设我需要从安大略省的布兰普顿到安大略省的汉密尔顿。我知道在我的起点我可能的选择是本地交通、GO 巴士或步行。我知道步行是到达目的地最不受欢迎的方式，所以我先看看 GO 巴士。我知道我可以将 GO 带到靠近汉密尔顿的一个点，但是在那一点上，GO 巴士转向另一个方向，在最近的点是我别无选择的地方（除了步行，但算法只会考虑步行对于短距离，否则它将认为该路线不可行）

使用同样的例子，如果算法发现我可以到达那里的方式更长但让我更接近目标节点（或可能在目标节点），这将是一个更高的加权路径（权重不在它的搜索过程中非常重要，只有当结果交付时，它才会按升序列出离目的地最近的路径）。例如，一辆 GO Bus 可以让我距离目的地节点 3 公里，而 3 辆公共交通巴士可以让我距离目标节点 500m

所以我的问题有两个方面：1）我应该从什么算法开始做类似的事情 2）我如何以编程方式解释如果节点不连接也没关系，这样它就不会只是从节点 A 跳转到节点 R。会从头开始并向后工作来完成这个

**编辑：**我忘了问如何瞄准最佳近似解决方案，因为特别是对于一个大图，这个问题可能会有数百万个解决方案。

谢谢，迈克尔

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-12T17:00:49.100

阅读[A* 算法](http://en.wikipedia.org/wiki/A*_search_algorithm)。它是 Dijkstra 最短路径算法的推广，允许您指定启发式算法，它为两个顶点之间的距离提供下限。在您的情况下，启发式函数将简单地返回欧几里得距离。

运行算法并跟踪具有最佳特征值的顶点，您可以通过从源的图形距离和到目标的欧几里德距离以某种方式计算该顶点。唯一棘手的部分是确定何时终止（除非您想遍历整个图）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-12T17:49:15.740

为什么不能假设所有节点都已连接？在现实世界中，它们通常是，即你总是可以走路或叫出租车等？

在这种情况下，您可以通过以下方式简单地更改模型：每种运输方式都有一个图表。位于同一位置的节点与权重为 0 的边相连（即，如果您在机场或火车站乘汽车下车）。

然后，用运输类型标记每个顶点和边，您可以简单地使用现有的路由算法。哦，顺便说一句：A* 不能很好地扩展到真正的大型网络。要获得 Yahoo/Google/Microsoft Maps 等软件实际会使用的东西，请查看[此处](http://algo2.iti.uni-karlsruhe.de/991.php)。该研究小组的工作包括[DIMACS 最短路径挑战赛](http://www.dis.uniroma1.it/~challenge9/)的获胜者。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-12T17:01:58.443

听起来很像带有额外节点特征的[旅行推销员问题。](http://en.wikipedia.org/wiki/Travelling_salesman_problem)请注意这种类型的问题是[NP Complete](http://en.wikipedia.org/wiki/Np_complete)并且您最好的选择是使用某种近似算法。

# .net - .NET 运行时如何确定两种类型是否相同？

> ID：742053
> 
> 赞同：1
> 
> 时间：2009-04-12T16:54:17.557
> 
> 标签：.net, reflection, types, reflection.emit, .net-internals

我有程序集 A，它（静态地）依赖于程序集 B 中的类型 T（引用类型，一个类）。

我不拥有程序集 A，但我拥有程序集 B。不幸的是，T 是一个真实类型（不是接口），但幸运的是 A 使用反射来发现它的成员。

我希望能够动态创建 B（和 T）。唯一重要的一点是，我需要确保动态创建的“B 和 T”（不是它们的成员）与编译 A 时静态编译的那些“等效”。

1.  我可以使用反射 Emit 来创建 B 和 T。没问题。
2.  我可以将 B.dll 写入磁盘
3.  如果 A 是针对这个 B.dll 编译的，那么我可以动态更改 T，没问题
4.  但是，如果 A 是针对等效项（手写 B 和 T）编译的，则 A 中的 T' 将具有相同的程序集名称和类型名称，但不会被视为与动态创建的相同。

我认为原因是类型上的 GUID 属性。当我将 B.dll 写入磁盘时，T 类型的 GUID 与我可以动态创建的 GUID 相同（即使我更改了它的成员）。但是，“其他等效”的手写类型不共享相同的 GUID。

总之，如果 dll 来自动态创建但不同于静态创建的，则 GUID 是相同的。GUID 每次都是相同的（即使我重新编译）。如果我更改动态类型的内容，则 GUID 是相同的。

运行时如何确定两种类型是否相同？这个 GUID 是如何创建的？它使用这个 GUID 和/或其他东西？是否可以在我的 dimic 程序集中分配此 GUID 以匹配程序集 A 中的 GUID？

可以静态检查此 GUID（我无法使用 Reflector 或 ildasm 看到它）。

注意：假设程序集未签名。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-12T18:20:04.137

.NET 运行时使用程序集名称、版本、强名称（如果存在）以及在某些情况下使用区域性来定位引用的程序集。如果一个程序集 A 引用另一个程序集 B，则如果提到的属性完全相同，则可以将 B 替换为另一个程序集。如果 B 具有强名称，则只有在您拥有用于签署程序集的密钥文件时，您才能创建具有相同强名称的另一个程序集。

AFAIK，Type.GUID 属性仅在您的类型注册为 COM 使用时使用。它适用于 GuidAttribute 类。因此，Type.GUID 与类型的“身份”无关。

您可以在此处阅读有关运行时如何定位程序集的更多信息：http: [//msdn.microsoft.com/en-us/library/yx7xezcf.aspx](http://msdn.microsoft.com/en-us/library/yx7xezcf.aspx)

# iphone - 当苹果谈到“内存”时，它们是什么意思？

> ID：742068
> 
> 赞同：1
> 
> 时间：2009-04-12T17:13:21.583
> 
> 标签：iphone, memory, memory-management

据我了解，记忆总是有两种类型：

*   工作存储

*   “磁盘空间”

那么，当您拥有 16 GB 的 iPhone 时，它​​是否有 16 GB 的工作存储空间？还是 16 GB 的“磁盘空间”？在性能和内存管理方面，Apple 在他的文档中谈论的是哪个“内存”？它看起来像工作存储，但我不确定。实际上，我认为 iPhone 是一块巨大的工作存储砖，因为所有这些东西只是一块坚固的芯片内存（没有硬盘驱动器）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-12T17:19:44.657

iPhone 有 16GB（或 8 个或 4 个，取决于型号）非易失性闪存，即使在关闭电源时也能保持。它还有 128MB 的易失性 DRAM，在关闭电源时会丢失。**相对**差异是：

*   闪存便宜，DRAM 贵
*   闪存慢，DRAM 快
*   闪存是非易失性的，DRAM 是易失性的

闪存本质上类似于硬盘驱动器，只不过它是固态存储器，而不是磁偶极子的旋转盘片。

通常，在 iPhone 开发中，当您谈论内存时，您就是在谈论 DRAM。DRAM 是一种更有限的资源，更容易用完，因为应用程序很容易因为内存管理不善而消耗兆字节。用完闪存要困难得多，因为这样做会涉及将非常大的文件写入文件系统。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-12T18:11:26.857

一种更简单的解释方式：

每部 iPhone 都有 128 MB 的 RAM。您的应用程序通常不能使用超过 ~22 MB 的内存，并且它不**使用**交换文件来扩展 RAM。

宣传的存储容量（4/8/16 GB）是文件系统的“磁盘”空间。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-12T19:05:57.583

构成 iPhone 所宣传的大部分“内存”的闪存是 RAM 和“磁盘空间”的一种混合体，其最重要的特点是：

*   比 RAM 便宜，比硬盘贵
*   顺序传输速率低于 RAM，与硬盘的传输速率大致相同（尽管这实际上取决于闪存的类型和质量）
*   随机访问延迟高于 RAM，但远低于硬盘

从程序员的角度来看，最后一点是最重要的。各种基本的编程技术和令人难以置信的努力都取决于这样一个事实：与计算机中发生的大多数其他事情相比，对硬盘内存的随机访问需要很长时间，因为它涉及物理运动——而这正是你的大部分存储所在。

这基本上意味着在使用闪存而不是硬盘的环境中，您可以摆脱很多绝对会杀死使用硬盘运行的应用程序的狗屎。除了存储量有限之外，没有任何缺点。当然，反过来说，也可能意味着从 iPhone 移植到 PC 上的应用程序可能会表现出糟糕的性能。再说一次，PC 的操作系统可能会通过在更丰富的 RAM 中缓存 HD 访问来隐藏这一点。

# javascript - NOT 的语法——排除 sIFR 中的特定类

> ID：742072
> 
> 赞同：0
> 
> 时间：2009-04-12T17:14:48.490
> 
> 标签：javascript, dom, sifr

我正在尝试 sifr `ul#menu div`，但**排除** `ul#menu div div` 了我已经尝试过的 Novemberborn Tricks 页面上的说明：

[http://wiki.novemberborn.net/sifr3/Tricks](http://wiki.novemberborn.net/sifr3/Tricks)

但一直无法弄清楚语法。我似乎无法让它工作。有谁知道是否可以在不指定要排除的类或 ID 的情况下使用 EXCLUDE 功能？

```
<ul id="menu">
   <li>
      <div>( sIFR THIS! )
         <a>Link 1</a>
      </div>
      <ul>
         <li>
            <div>( DON'T sIFR THIS! )
               <a>Link 1a</a>
            </div>
         </li>
      </ul>
   </li> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-13T20:36:08.170

`ul#menu > li > div`用作选择器。

# php - 设计可扩展的点击/分析系统的最佳方法？

> ID：742073
> 
> 赞同：8
> 
> 时间：2009-04-12T17:16:26.193
> 
> 标签：php, mysql, date, time, analytics

我工作的公司为黑莓平台创建应用程序。

我们一直在研究一个专有的“分析系统”，它允许我们将代码嵌入到我们的应用程序中，并让应用程序在每次运行时向我们的中央服务器报告一些统计数据。目前，系统运行正常；但是它仅处于测试阶段，每小时点击 100-200 次。“命中”会毫无问题地发送到服务器。我们已经构建了一个非常可靠的 API 来处理命中的接受和存储（在 MySQL 数据库中）。我们已经测试了负载，我们应该能够毫无问题地容纳每小时数十万次点击。这不是一个真正的问题。

问题是显示统计数据。我们构建了一个类似于 Mint (haveamint.com) 的显示面板，它显示每小时、过去几天、几个月、几周、几年等的点击量。第一个版本运行直接查询，从命中表中提取数据并即时解释它。这并没有奏效很长时间。我们当前的解决方案是将命中“排队”以进行处理，并且我们每 5 分钟有一个 cron 来处理命中并将它们分类到每小时、每天、每周、每月、每年等的“缓存”中。这非常有效，并且具有令人难以置信的可扩展性；但是，它仅适用于 1 个时区。由于整个公司都可以访问它，我们正在与不同时区的数百名用户打交道。我定义的“今天” 圣何塞与我在伦敦的同事对今天的定义大不相同。由于当前解决方案仅缓存到 1 个时区，因此对于在我们的时区之外检查数据的任何人来说都是一场噩梦。

我们目前解决这个问题的计划是为每个时区创建缓存（总共 40 个）；但是，这意味着我们将数据量乘以 40……这对我来说太可怕了，并且考虑到缓存可能非常大，乘以它听起来是个坏主意；另外，当我们去处理队列时，将它们放入 40 个不同的缓存中需要更多的 CPU 时间。

还有其他人对如何解决这个问题有更好的想法吗？

（对不起这么长的问题......这并不容易解释。谢谢大家！）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-12T17:52:45.620

您提出的解决方案有太多冗余。我建议您将数据存储在至少 30 分钟的存储桶中，而不是每小时存储一次，并将时区标准化为 UTC。

对于 30 分钟的存储桶，如果用户请求从 -4.5 UTC 开始的下午 1 点到下午 2 点的每小时数据，您可以从系统中获取下午 5:30 到下午 6:30 的数据并显示出来。如果您以一小时为增量存储数据，则您无法为时区的用户提供 N + 0.5 小时差异的服务请求。

对于每日数字，您需要汇总 48 个半小时时段。要选择的时段将由用户的时区决定。

当您获得年度数据时会变得很有趣，因为您最终必须汇总 17,520 个半小时的存储桶。为了简化计算，我建议您获取每个 UTC 时间的预聚合年度数据，并减去一年中第一个 4.5 小时的聚合数据，并添加下一年前 4.5 小时的聚合数据。这实际上将全年转移 4.5 小时，而且工作量并不多。从这里开始，您可以进一步调整系统。

编辑：原来加德满都是 +5.45 GMT，所以您需要将数据存储在 15 分钟的存储桶中，而不是 30 分钟的存储桶中。

编辑 2：另一个简单的改进是每年汇总一次，因此您不必每次添加 17,520 个桶，也不需要每个国家/地区的汇总。汇总 1 月 2 日 - 12 月 30 日的年度数据。由于任何两个国家之间的最大时区差异为 23 小时，这意味着您可以获取年度数据（1 月 2 日 - 12 月 30 日）并在前后添加几个桶作为适当的。例如，对于 -5 UTC 时区，您将在 0500 之后的 1 月 1 日添加所有存储桶，在 12 月 31 日添加所有存储桶，并在下一年的 1 月 1 日添加最多 0500 小时。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-12T17:34:43.730

在设计涉及多个时区的软件时，我会说始终将您的日期/时间存储在[UTC](http://en.wikipedia.org/wiki/Coordinated_Universal_Time)中，并在原始时区的另一个字段中存储一个函数，该函数可以花费时间并将其与 UTC/时区相互转换。你会为自己省去很多麻烦来处理白天切换、夏令时、人们从地球另一端查看一个国家的统计数据等不同的情况......

在您的情况下，使用 UTC 缓存并调整要转换为 UTC 的请求应该会有所帮助。不要将统计数据存储为“今天”，将其存储为 00:00:00UTC 到 23:59:59UTC 几个小时，当有人在纽约询问今天的统计数据时，进行转换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-12T17:35:06.023

据我所知，您正在这里寻找数据仓库系统的存储部分（您的报告将是前端）。

实际上，商业系统的做法是您描述的缓存：预先聚合您的表并创建它们的缓存。加速查询的唯一方法是减少数据库系统为它们做的事情。这意味着更少的数据，这反过来意味着迭代数据或索引中的数据更少的时间。

也就是说，我要么提出“40 个缓存解决方案”（真的有超过 24 个时区）。您应该能够通过创建数据副本来简单地并行化排序队列。

另一种方法是按小时粒度缓存，然后将小时聚合为天（如果您的时区需要，则聚合为 30 分钟）。这意味着您以比日常缓存更精细的粒度进行缓存，但比原始数据的粒度更粗。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-12T17:48:20.670

这种数据通常使用循环或循环数据库存储。检查这个[http://www.shinguz.ch/MySQL/mysql_20070223.html](http://www.shinguz.ch/MySQL/mysql_20070223.html)和这个[http://techblog.tilllate.com/2008/06/22/round-robin-data-storage-in-mysql/](http://techblog.tilllate.com/2008/06/22/round-robin-data-storage-in-mysql/)了解如何他们工作以及如何在 MySQL 下实现它

# django - 无法在 Django 中进行从 example.com 到 www.example.com 的域重定向

> ID：742075
> 
> 赞同：1
> 
> 时间：2009-04-12T17:18:29.493
> 
> 标签：django, redirect, proxy, dns

当我浏览到时收到以下消息`example.com`

```
500 - Internal Server Error 
```

当我浏览到`www.example.com`这表明我的网站处于活动状态时，我收到了 404 错误消息。

**如何在没有 .htaccess 的情况下通过 Django 将域重定向从 example.com 到 www.example.com？**

**我的网址.py**

```
 from django.conf.urls.defaults import *

     from django.contrib import admin
     admin.autodiscover()

     urlpatterns = patterns('',
     # Example:
     # (r'^{{ project_name }}/', include('{{ project_name }}.foo.urls')),

     (r'^home/', include('index.html')),

     # Uncomment the admin/doc line below and add 'django.contrib.admindocs' 
     # to INSTALLED_APPS to enable admin documentation:
     (r'^admin/doc/', include('django.contrib.admindocs.urls')),

     (r'^admin/(.*)', admin.site.root),
     ) 
```

**[编辑]**

我从 Djangohosting 得到以下答案：

> 删除 [example.com] 的网站代理，并在 [www.example.com] 网站的别名部分添加 [example.com]。

我不完全确定这意味着什么。

1.  如何删除网站代理`example.com`？
2.  在哪里可以找到网站的别名部分`www.example.com`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-13T03:46:33.353

我不知道它是否能解决你所有的问题，但如果你想通过 django 来做，试试中间件

```
from django.http import HttpResponseRedirect

class WWWRedirectMiddleware(object):
    def process_request(self, request):
        if not request.META['HTTP_HOST'].startswith('www.'):
            return HttpResponseRedirect('http://www.example.com') 
```

请记住，它必须在任何其他中间件之前执行。

基于[这个](http://www.djangosnippets.org/snippets/434/)，没有测试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-12T17:29:37.253

检查[PREPEND_WWW](http://docs.djangoproject.com/en/dev/ref/settings/#prepend-www)设置可能会有所帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-12T17:26:20.117

500 Internal Server 错误可能是由以下行引起的：

```
(r'^home/', include('index.html')), 
```

该`include()`函数是一种包含其他 URL 配置文件的方法，而不是静态 HTML 文件。您必须在给定的 URL (/home) 上充当`index.html`静态[文件](http://docs.djangoproject.com/en/dev/howto/static-files/#howto-static-files)，或者编写一个简单地呈现文件的视图。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-12T17:31:25.750

> 当我浏览到时收到以下消息`example.com`
> 
> 500内部服务器错误
> 
> 当我浏览到`www.example.com`这表明我的网站处于活动状态时，我收到了 404 错误消息。

很可能反过来。500 消息表示您的站点处于活动状态，但出现错误。您必须了解的是，url 的`example.com`/`www.example.com`部分用于查找要连接的*服务器。*当你的 Django 应用程序被调用时，这部分已经完成，所以 Django 没有办法做到这一点。

相反，您希望设置`www`为子域`example.com`并使它们指向同一个地方。请参阅此处的第一个示例： [虚拟主机示例](http://httpd.apache.org/docs/1.3/vhosts/examples.html)

**更新** 我刚刚注意到你说*你的*404 出现了，所以忽略前两句话。无论哪种方式，解决方案都可能是相同的。:-)

# c - 禁止警告：使用 `mktemp' 是危险的

> ID：742089
> 
> 赞同：10
> 
> 时间：2009-04-12T17:37:21.383
> 
> 标签：c, security, gcc, gcc-warning, mktemp

如何抑制来自 gcc 链接器的以下警告：

**警告：使用“mktemp”是危险的，最好使用“mkstemp”**

我确实知道使用它更好，`mkstemp()`但由于某种原因我必须使用`mktemp()`函数。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-12T21:44:25.563

我猜你需要路径，因为你将它传递给一个只接受路径名作为参数而不是文件描述符或`FILE`指针的库。如果是这样，您可以创建一个临时目录`mkdtemp`并将您的文件放在那里，那么实际名称并不重要，因为路径由于目录而已经是唯一的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-12T17:48:45.477

如果您**必须**使用，那么除了从 libc.so.6`mktemp`中删除使用的部分之外，您无法采取任何措施来抑制该警告。`mktemp`

为什么**一定**要使用`mktemp`？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-12T18:53:37.800

两件事情：

*   `mktemp`不是标准功能
*   该警告是在链接器中作为`.gnu.warning.mktemp`部分实现的特殊警告

如果您确实需要写入磁盘，请使用本机 OS API。或`mkstemp()`按照建议。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-12T18:17:42.240

如果您静态链接运行时，那么另一个选项是`mktemp`在目标文件中编写您自己的版本。链接器应该更喜欢您的版本而不是运行时版本。

**编辑**：感谢 Jason Coco 指出了我`mktemp`及其亲属的一个重大误解。现在解决这个问题要容易一些。由于链接器会更喜欢目标文件中的版本，因此您只需`mktemp`按照`mkstemp`.

唯一的困难是清理将返回给您的文件描述符`mkstemp`并使一切线程安全。`atexit`如果您可以限制需要多少临时文件，则可以使用描述符的静态数组和-registered 函数进行清理。如果没有，请改用链表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-14T18:53:31.600

使用`mkstemp`：

```
int fd = mkstemp(template); 
```

在此调用之后，`template`将替换为实际的文件名。您将拥有文件描述符和文件的路径。

# opengl - 如何从不同的线程绘制opengl图形？

> ID：742090
> 
> 赞同：4
> 
> 时间：2009-04-12T17:38:26.233
> 
> 标签：opengl, pthreads

我想制作一个显示一些 3d 图形和命令行的 opengl 应用程序。我想让它们分开线程，因为它们都是繁重的进程。我认为我可以使用 2 个不同的视口来解决这个问题，但我想知道如何处理 opengl 中的线程。

根据我一直在阅读的内容，Opengl 是异步的，从不同的线程调用它的函数可能会有很大的问题。有没有办法可以用来解决这个问题？理想情况下，我想在具有透明效果的 3d 图形之上绘制命令行......（我猜这对于视口是不可能的）

解决方案的便携性很重要。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-12T17:53:12.140

您可以使用 Overlays 实现您想要做的事情。
叠加是一个有点过时的功能，但在大多数设置中仍应支持它。基本上，叠加层是一个单独的 GL 上下文，它与另一个层在同一个窗口中呈现，绘制在具有原始上下文的窗口上绘制的任何内容之上。
你可以在[这里](http://www.opengl.org/resources/faq/technical/contexts.htm)阅读。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-13T03:40:20.390

我认为，与其尝试创建两个线程来绘制到屏幕上，不如使用[MVC 模式](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)并使模型线程安全。然后，您可以有一个线程从模型中获取每一帧的必要信息并将其投射到屏幕上，然后还有另外两个线程，一个用于图形，一个用于命令行，它们只管理模型。

例如，您有一个具有 3D 图形内容的 Simulation 类，然后是一个具有命令行的 CommandLine 类。这些类中的每一个都根本不使用 OpenGL；仅管理数据，例如事物在 3d 空间中的位置，在命令行的情况下，屏幕上的行队列。然后opengl线程可以每帧查询这些类的线程安全函数，以获取必要的信息。例如，它抓取 3d 物体的位置，在屏幕上绘制它们，然后抓取要在命令行上显示的线条并绘制它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-12T17:39:54.810

你不能用 2 个视口来做到这一点。

每个 OpenGL 上下文必须在创建它的同一线程中使用。

可以从两个单独的线程安全地设置和使用两个单独的窗口句柄，每个句柄都有自己的上下文，但不能在一个窗口中设置 2 个视口。

* * *

[OpenSceneGraph](http://www.openscenegraph.org/projects/osg)是一个了解这方面想法的好地方。 它在线程方面做了很多工作，以帮助尝试加快处理速度并在非常大的场景中保持恒定的高帧率。

我已经成功地嵌入了它并从 2 个单独的线程中使用它，但是 OSG 有许多检查来帮助解决这种情况。

# moodle - MOODLE 插件

> ID：742091
> 
> 赞同：0
> 
> 时间：2009-04-12T17:39:08.337
> 
> 标签：moodle, plugins

考虑到 MOODLE 是一个开源项目，如何添加我在[MOODLE中开发的插件？](http://moodle.org)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-12T18:11:55.887

这是将贡献的模块安装到moodle的[文档](http://docs.moodle.org/en/Installing_contributed_modules_or_plugins)。在您的插件可供所有人使用之前，您必须获得批准。如果您想将您的插件添加为核心组件，您应该联系开发团队。确保您遵循贡献代码的[指南](http://docs.moodle.org/en/Development:Guidelines_for_contributed_code)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T11:13:24.407

[由开放大学 ( moodle.org/plugins/view.php?plugin=local_codechecker](http://moodle.org/plugins/view.php?plugin=local_codechecker) )开发的代码检查器插件对于希望为 Moodle 贡献扩展并结合一般编码良好实践的任何人来说都是一个非常宝贵的工具。

我建议将它用于您计划与其他 Moodle 用户共享的任何软件，并使用 moodle.org 上的论坛在开发插件时获得有关 beta 版本和您的概念的一些反馈。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-12T18:11:17.463

检查[贡献代码的指南](http://docs.moodle.org/en/Development:Guidelines_for_contributed_code)。它们应该包括你需要知道的关于为 moodle 项目做贡献的一切。他们描述你必须在他们的 bugtracker 上提交它，等等。如果有进一步的问题，我建议你直接联系 moodle 的人。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T20:34:10.817

Moodle 提供代码指南。

[http://docs.moodle.org/dev/Guidelines_for_contributed_code#How_to_submit_code](http://docs.moodle.org/dev/Guidelines_for_contributed_code#How_to_submit_code)

阅读**如何请求测试/审查您的代码**部分。

特别注意遵循moodle API

[http://docs.moodle.org/dev/Coding](http://docs.moodle.org/dev/Coding)

# c - 试图理解MD5算法

> ID：742096
> 
> 赞同：1
> 
> 时间：2009-04-12T17:44:11.057
> 
> 标签：c, logic, md5

我正在尝试用 MD5 在 C 中做一些事情（后者试图用 SHA1 算法做一些事情）。我的主要问题是我从来没有真正在 C 中做过任何复杂的事情，只是简单的东西（不像指向指针或结构的指针）。

[我在这里得到了 md5 算法。](http://userpages.umbc.edu/~mabzug1/cs/md5/md5.html)

我将文件包含在我`md5.c`的`md5.h`C 项目中（使用代码块），但唯一的问题是我并不真正了解如何使用它。我已经阅读并重新阅读了代码，但我不明白如何使用这些函数将“示例”转换为 MD5 哈希。

我有一段时间没有做过 C 编程（主要是 php），所以我有点迷失了。基本上我要问的是一些使用示例。它们是通过`md5main.c`文件提供的，但我不明白。

我在这里的目标很高吗？我是否应该停止这一切并重新开始阅读 C 书，或者任何人都可以给我一些指示，看看我是否能解决这个问题。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-12T17:52:45.700

你应该停止这一切，重新开始阅读 C 书。

我的经验是，当我尝试学习一门新的编程语言时，同时尝试实现一个复杂的项目是不切实际的。您应该在 C 中进行简单的练习，直到您熟悉该语言，然后处理诸如实现 MD5 或集成现有实现之类的事情。

顺便说一句，阅读代码是一种不同于编写代码的技能。这两种技能之间存在差异，但都需要您很好地理解语言。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-12T18:43:31.303

虽然我同意 Bill 的观点，但如果你想真正了解你在做什么，你应该回到 C 书。但是，为了提供帮助，我修改并注释了 md5main.c 中的一些代码......

```
const char* testData = "12345";  // this is the data you want to hash
md5_state_t state;  // this is a state object used by the MD5 lib to do "stuff"
                    // just treat it as a black box
md5_byte_t digest[16];  // this is where the MD5 hash will go

// initialize the state structure
md5_init(&state);

// add data to the hasher
md5_append(&state, (const md5_byte_t *)testData, strlen(testData));

// now compute the hash
md5_finish(&state, digest);

// digest will now contain a MD5 hash of the testData input 
```

希望这可以帮助！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-12T18:15:40.323

我认为你选择了最糟糕的东西（不是你自己的错）。加密和散列类型算法将尽可能以最奇怪的方式使用语言来完成他们需要快速完成的数学类型。它们几乎肯定会被混淆并且难以理解。另外，您需要陷入数学困境才能真正理解它们。

如果您只想要一个哈希算法，请获得一个众所周知的实现并将其用作黑匣子。不要尝试自己实现它，您几乎肯定会在实现中引入一些加密弱点。

编辑：如果您想要关于加密的好书（或资源），要完全响应，请查看 Bruce Schneier。 [应用密码学](https://rads.stackoverflow.com/amzn/click/com/0471117099)是经典之作。

# php - $this->a->b->c->d 从 php 中的超类调用方法

> ID：742097
> 
> 赞同：1
> 
> 时间：2009-04-12T17:45:11.677
> 
> 标签：php, oop

你好我想在课堂上做点什么

我想做一个超级课，我的所有课都在上面扩展

```
 ____  database class
           /
chesterx _/______  member class
          \
           \_____  another class 
```

我想像这样调用数据库类中的方法

```
$this->database->smtelse();

class Hello extends Chesterx{

  public function ornekFunc(){
     $this->database->getQuery('popularNews');
     $this->member->lastRegistered();
  }

} 
```

当我将我的超类扩展到任何类时，我想用它的父类名调用一个方法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-12T17:51:18.947

我不太清楚你最后一句话是什么意思，但这是完全有效的：

```
class Chesterx{
 public $database, $member;
 public function __construct(){
   $this->database = new database; //Whatever you use to create a database
   $this->member = new member;
 }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-12T19:43:13.670

考虑单例模式——它通常更适合数据库交互。[http://en.wikipedia.org/wiki/Singleton_pattern](http://en.wikipedia.org/wiki/Singleton_pattern)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-12T20:33:35.000

您还可以考虑使用方法来获取子对象 优点是对象在需要之前不会被初始化，并且还提供了更松散耦合的代码，使您可以更轻松地更改数据库的初始化方式。

```
class Chesterx{
   public $database, $member;

   public function getDatabase() {
       if (!$this->database ) {
           $this->database = new database; //Whatever you use to create a database
       }
       return $this->database;
   }

   public function getMember() {
       if (!$this->member) {
           $this->member = new member;
       }
       return $this->member;
   } 
```

}

# c# - 从 C# 在 MySQL 中存储 GUID

> ID：742099
> 
> 赞同：7
> 
> 时间：2009-04-12T17:47:25.837
> 
> 标签：c#, mysql

试图将 Guid 从 C# (.NET) 持久化到 MySQL 数据库中。MySQL 列的类型为 BINARY(16)。关于如何持久化 guid 并稍后将 guid 从 MySQL 取回的任何建议？在这里寻找代码答案:-)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-12T18:33:45.850

弄清楚了。就是这样 ...

数据库架构

```
CREATE TABLE `test` (                                            
     `id` BINARY(16) NOT NULL,                                      
     PRIMARY KEY  (`id`)                                            
) 
```

代码

```
string connectionString = string.Format("Server={0};Database={1};Uid={2};pwd={3}", "server", "database", "user", "password");

Guid orgId = Guid.NewGuid();
Guid fromDb = Guid.Empty;

using (MySqlConnection conn = new MySqlConnection(connectionString))
{
    conn.Open();

    using (MySqlCommand cmd = new MySqlCommand("INSERT INTO test (id) VALUES (?id)", conn))
    {
        cmd.Parameters.Add("id", MySqlDbType.Binary).Value = orgId.ToByteArray();
        cmd.ExecuteNonQuery();
    }

    using (MySqlCommand cmd = new MySqlCommand("SELECT id FROM test", conn))
    {
        using (MySqlDataReader r = cmd.ExecuteReader())
        {
            r.Read();
            fromDb = new Guid((byte[])r.GetValue(0));
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-12T18:41:13.117

显然，`GetGuid()`MySQL .NET Connector v5.2.6+ 中的方法应该是固定的，所以你可以[使用这个例子](http://bugs.mysql.com/bug.php?id=41452)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-21T07:44:14.590

**1）**您可以像@Tim Skauge 那样插入它。但是在选择 .Net 连接器版本时很重要。当我使用 v 5.2.1 时，我只需要这样做：

```
using (MySqlCommand cmd = new MySqlCommand("SELECT id FROM test", conn))
{
    using (MySqlDataReader r = cmd.ExecuteReader())
    {
        r.Read();
        Guid id = (Guid)r[0];
    }
} 
```

这里阅读器本身将二进制值读取为 .NET`Guid`类型。如果你检查它的类型，你可以看到它`r[0]`。但是对于较新的版本，即 6.5.4，我发现类型为`byte[]`.. 即，它将二进制值从 db 获取到其相应的字节数组。所以你这样做：

```
using (MySqlCommand cmd = new MySqlCommand("SELECT id FROM test", conn))
{
    using (MySqlDataReader r = cmd.ExecuteReader())
    {
        r.Read();
        Guid id = new Guid((byte[])r[0]);
    }
} 
```

[您可以在文档](http://dev.mysql.com/doc/refman/5.1/en/connector-net-connection-options.html)中阅读为什么会这样。直接读取 Guid 类型而不是 byte[] 的替代方法是`Old Guids=true`在您的连接字符串中有这一行：

**2）**此外，您可以通过要求 MySQL 进行转换来立即将二进制值读取为字符串，但根据我的经验，这种方法较慢。

插入：

```
using (var c = new MySqlCommand("INSERT INTO test (id) VALUES (UNHEX(REPLACE(@id,'-','')))", conn))
{
    c.Parameters.AddWithValue("@id", Guid.NewGuid().ToString());
    c.ExecuteNonQuery();
} 
```

或者

```
using (var c = new MySqlCommand("INSERT INTO test (id) VALUES (UNHEX(@id))";, conn))
{
    c.Parameters.AddWithValue("@id", Guid.NewGuid().ToString("N"));
    c.ExecuteNonQuery();
} 
```

并选择：

```
using (MySqlCommand cmd = new MySqlCommand("SELECT hex(id) FROM test", conn))
{
    using (MySqlDataReader r = cmd.ExecuteReader())
    {
        r.Read();
        Guid id = new Guid((string)r[0]);
    }
} 
```

您需要注意的一件事是，如果您通过`hex`方法插入 Guid，那么您必须通过该`unhex`方法阅读它。如果您依赖 .NET 的`ToByteArray()`方法插入它们，那么您必须类似地阅读。否则，您将读取不正确的 guid，因为 .NET 有一种根据字节序对字节进行排序的特殊方式。[在 .NET 中插入和阅读 Guids 的上下文中了解它](https://stackoverflow.com/questions/11177514/incorrect-guid-order)

# mysql - 使用 NATURAL JOIN 的视图可更新？

> ID：742101
> 
> 赞同：1
> 
> 时间：2009-04-12T17:48:06.570
> 
> 标签：mysql

我有一个由 id 字段上的 2 个自然连接组成的视图，该字段是引用第一列的第二列的外键和引用第二列的第三列的外键。当我尝试在此视图中插入时，没有错误，但在第一个表中只插入了一行。

我是否必须使用触发器才能使其可更新？

* * *

经过进一步调查，我发现 MySQL 5.1（我使用的版本不支持触发器引用视图）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-12T17:57:18.467

从[http://dev.mysql.com/doc/refman/5.1/en/view-updatability.html](http://dev.mysql.com/doc/refman/5.1/en/view-updatability.html)：

> 对于多表可更新视图，如果插入到单个表中，则 INSERT 可以工作。

听起来不支持通过视图插入多个表。换句话说，您`INSERT`应该只指定单个基表中的列。

# cocoa - CIImage：如何使用 CIAffineTransform？

> ID：742109
> 
> 赞同：0
> 
> 时间：2009-04-12T17:51:46.293
> 
> 标签：cocoa, core-image

我怎样才能使我的`CIImage`有限`CIAffineTransform`，所以我可以把它传递给`NSBitmapImageRep:initWithCIImage`？

总的来说，我想通过 CIAdditionCompositing 叠加两个图像。因为一个图像比另一个图像小，它想先定位它。我认为转换较小的图像是正确的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-12T23:06:24.290

使用裁剪过滤器。

# iphone - 什么最能描述术语“内存足迹”？

> ID：742114
> 
> 赞同：0
> 
> 时间：2009-04-12T17:54:18.550
> 
> 标签：iphone, objective-c, memory-management

在Apple的文档中：“内存足迹”是什么意思？我的应用程序消耗多少内存？有人对这个词有很好的解释吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-12T18:32:42.997

我认为这是一种解释： [链接文本](http://en.wikipedia.org/wiki/Memory_footprint)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-12T20:50:55.567

应用程序的内存占用可以描述为它在使用最多内存时使用了多少内存。

# .net - 参数命名：文件名还是文件名？

> ID：742115
> 
> 赞同：78
> 
> 时间：2009-04-12T17:55:03.260
> 
> 标签：.net, naming-conventions, naming, fxcop

我尝试在我的命名中语法正确*。我一直使用`filename`而不是`fileName`. java 约定似乎也使用了这个，但 FxCop 更喜欢`fileName`.

维基百科上有一个关于它的[讨论](http://en.wikipedia.org/wiki/Talk:Filename#.22File_name.22_vs_.22Filename.22)。我读的越多，我就越觉得我是对的（这很常见！:)）。有没有人有明确的答案，或者这仅仅是主观的东西？

* 我只希望这篇文章没有语法错误！

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-04-12T17:57:13.083

字段和参数建议使用[小写驼峰式。](http://en.wikipedia.org/wiki/CamelCase)

**示例 1**：

```
fileName // for fields, parameters, etc.
FileName // for properties, class names, etc. 
```

通常，`**fileName**`使用而不是`**filename**`；您可以通过阅读 Microsoft 创建的开源内容的源代码来验证这一点，例如[Enterprise Library](http://www.codeplex.com/entlib)。

**原因**：

1.  这背后的**要点**是在这种情况下名称更具可读性。
2.  当在同一方法（类..）中使用多个参数（字段、变量..）并且具有相同前缀“文件”时，这种方法还增加了**一致性，如下所示：**
3.  ...还有其他一些原因，但它们更主观。

**示例 2**：

```
fileName, fileSize... // instead of filename AND filesize 
```

**另见**：

*   维基百科的[命名约定](http://en.wikipedia.org/wiki/CamelCase)
*   MSDN 上的[通用命名约定](http://msdn.microsoft.com/en-us/library/ms229045.aspx)

有关完整的命名约定规则，我建议查看这本书：

*   [Framework Design Guidelines: Conventions, Idioms, and Patterns for Reusable .NET Libraries](https://rads.stackoverflow.com/amzn/click/com/0321545613)
    *(2nd Edition) by Krzysztof，于 2008 年 11 月出版*
    （个人而言，我们不使用本书 100% 的建议，但总体而言有相当不错的指南）

并在[IDesign.net上查看一些东西](http://idesign.net/idesign/DesktopDefault.aspx)

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-04-12T18:01:01.950

`'filename'`假设这个词描述了一个像“cow”或“chair”这样的单一对象，
`'fileName'`假设这是一个复杂的对象，有一个名为文件的对象，并且这个对象描述了该文件的名称。

两种哲学方法，任你选择。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2018-06-22T17:28:11.573

可以用英文写“文件名”或“文件名”。当您将其转换为编码时，大写“n”或不大写“n”可以采用任何一种方式（假设 camelCase 或 PascalCase）。

顺便说一句，你确实在问题中犯了一个语法错误——具有讽刺意味的是，在你表达你希望没有语法错误的句子中。你说，“我只希望这篇文章没有语法错误！” 但是“errors”是复数形式，因此“there's”的“is”代表主谓不一致。

* 我只希望这篇文章没有语法错误！

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-04-12T17:59:57.087

就我而言，

> `thisIsMuchMoreReadable`比 `readingthis`。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-04-12T18:18:12.097

我认为这里的答案涉及两个问题。

*   'FileName' vs 'Filename' （'name' 应该是一个单独的词）

    和

*   'fileName' vs 'FileName'（第一个字符应该小写）。

在大多数情况下，我更愿意将这个词视为一个完整的词“文件名”。我也更喜欢以小写字母开头的变量/方法，以便于代码完成菜单导航。

我想骆驼大小写的问题也在这里，我认为应该用它来区分多词名称。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-04-12T18:05:07.120

FxCop 是一个自动化工具这不是显而易见的答案吗？它认识到“name”是一个单词，因此建议以大写 N 开头。我们碰巧知道“filename”也是一个单词，因此只有第一个 F 应该大写。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-12T18:11:12.910

这里没有真正的对与错。

这纯粹是主观的，并且与您所在的社区完全相关。如果您经常遇到的 FxCop 和 StyleCop 以及 .net 代码使用的是 fileName，那么请使用 fileName。如果它正在使用其他东西，那么就使用它。

您的首要任务可能应该是与您自己的代码中的模式保持一致，然后与您的社区保持一致。

在这种特殊情况下，.net Reflector 使用 fileName 显示了很多 .net 代码，所以我会亲自使用该模式。

如果您在 Java 世界中运行 PMD 和 checkstyle 并且他们的 api 经常使用文件名，那么我会选择这样做。

除了维基百科的命名文章，还有Kernighan 和 Pike*的 The Practice of Programming*。它的第一章涉及很多命名和代码一致性问题。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-04-22T22:01:19.180

文件名 ~ 给以电子方式存储的计算机文件的识别名称，符合操作系统施加的限制，如长度或字符的限制选择。

在过去，这被认为是两个词，但现在被定义为一个词，所以

var 文件名 = ......

如果是两个词

var 文件名 = ....

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-12T20:13:12.007

如果您正在编写 c/c++，则很容易使用人们可以实际阅读的名称；ie filename 很好，yet_another_file_name 也很好（假设您没有将 filename 视为正确的英文单词 - 我通常会这样做）。

见[谷歌编码标准](http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml#Naming)

# php - 关联数组和绑定参数

> ID：742119
> 
> 赞同：1
> 
> 时间：2009-04-12T17:58:39.180
> 
> 标签：php, pdo, mysqli

我对这些功能有点困惑`PDO::prepare`。

我有这样的东西

```
array('user_email'=>'hello@net.com','user_pass'=>'password') 
```

我想把它翻译成这样的东西

```
INSERT INTO user_info (user_email, user_pass) VALUES (hello@net.com, password) 
```

使用带有 PDO 的参数化查询（或 mysqli，我愿意接受建议）。另一个想法——

```
array('uid'=>'10', 'first_name'=>'robert', 'last_name'=>'jones')
array("email", "number") 
```

进入

```
SELECT email, number FROM t1 WHERE uid=10 AND first_name=robert AND last_name=jones 
```

我知道答案在于`PDO::prepare`and `call_user_func_array`，但我对后一个函数的工作原理感到非常困惑，希望能得到解释。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-12T18:06:24.013

我很困惑，也许你也是。这是一个简单的例子：

```
$sth = $dbh->prepare('SELECT * FROM table WHERE id = ? AND date = ?');
$sth->execute(array(150, '2009-04-04'));
$data = $sth->fetchAll(); 
```

或者：

```
$sth = $dbh->prepare("INSERT table VALUES(:foo, :bar)");
$sth->bindParam(":foo", $foo);
$sth->bindParam(":bar", $bar); 
```

或者：

```
$sth = $dbh->prepare("INSERT INTO user_info (user_email, user_pass) VALUES (:email, :pass)");
$sth->execute(array(':email' => 'foo@example.org', ':pass' => '1234')); 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-12T18:09:04.100

PDOStatement::execute() 与参数标记一起使用，因此您必须在调用 PDO::prepare() 之前构造查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-12T18:09:40.340

您不必使用 call_user_func_array()。PDOStatement::execute() 默认采用关联数组。

```
$stmt = $pdo->prepare("SELECT fld FROM tbl WHERE fld=:parameter1 AND fld2=:parameter2");
$stmt->execute(array(":parameter1" => "value1", ":parameter2" => "value2"));
... 
```

[http://se.php.net/manual/en/pdo.prepare.php](http://se.php.net/manual/en/pdo.prepare.php)

# text - 如何在内存不足的环境中找到书中的高频词？

> ID：742125
> 
> 赞同：5
> 
> 时间：2009-04-12T18:02:22.667
> 
> 标签：text, frequency

最近在一次技术面试中，我被要求编写一个程序来查找教科书中的高频词（出现次数最多的词）。该程序的设计方式应该是，它以最少的内存处理整个教科书。性能不是问题。我可以通过编程找到单词的频率，但它消耗了大量的内存。

您如何使此操作占用更少的内存？有什么策略/解决方案？

-斯内哈尔

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-12T18:19:45.243

您可能使用了内存密集型但具有恒定查找时间的哈希表——因此性能/内存的权衡是显而易见的。当你读完这本书时，你就会知道答案。此外，每个单词的递增计数器很快（因为快速哈希表查找）。

光谱的另一端是看第一个单词，然后通读整本书，看看这个单词出现了多少次。这需要最少的内存。然后你对下一个单词做同样的事情并通读整本书。如果该单词出现更多次，则将其添加为顶部单词（或顶部 N 个单词）。当然，这是非常低效的——如果第一个词和第三个词相同，即使你只是对第一个词做了同样的事情，你最终还是会再次阅读整本书。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-12T18:27:26.490

好的，如果您只对出现次数最多的 n 个单词感兴趣，那么一种方法是分两遍，第一遍基于修改后的[Bloom Filter](http://en.wikipedia.org/wiki/Bloom_filter)。不要使用位图来跟踪散列的出现，而是使用整数数组 - 字节、16 位、32 位甚至 64 位，具体取决于您的输入大小。布隆过滤器只是简单地设置与单词的每个散列值相对应的位，您将在数组中的散列索引处增加计数。

这种方法的问题是两个词可能会给出相同的哈希值。因此，您需要进行第二遍忽略单词，除非它们的哈希总和高于某个阈值，从而减少为进行准确计数而需要分配的内存量。

因此，只需为出现的最高哈希值创建一个位图。然后在单词的第二遍中，如果一个单词在位图中的哈希值“命中”，则查找它或将其添加到哈希表并增加其计数。这通过创建仅包含最高出现单词的哈希表来最小化内存使用量。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-12T18:45:02.330

我是物理学家，所以我最喜欢的方法是近似。**您无需阅读整个文本**即可获得最常用的单词。反而：

*   解析一个足够小的块以允许您的内存限制，
*   **跳过**随机数量的文本，
*   重复，结合累积的结果。
*   当列表令人满意地收敛时停止。

如果您对较小的块使用内存高效算法（例如排序），那么您可以获得**比读取每个单词的最有效算法更快的性能**。

**注意**：这确实假设最常见的单词确实在整个文本中出现的频率最高，而不仅仅是在文本中的一个地方。对于英文文本，这个假设是正确的，因为“the”等词的频率贯穿始终。如果您担心此要求，请要求算法至少完成整个文本的一遍。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-12T19:06:06.723

我可能会为此投反对票...

如果文本是英文并且您只想找到前 5 个最常用的单词，那么这是您的程序：

```
print "1\. the\n";
print "2\. of\n";
print "3\. and\n";
print "4\. a\n";
print "5\. to\n"; 
```

运行速度快*，*消耗最少的内存！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-12T18:10:32.707

如果性能真的无关紧要，您可以依次检查每个单词，检查它是否在您的“前 N 个”中，如果不是，计算所有出现的次数。这样你只存储 N 个值。当然，您会多次计算相同的单词，但是，正如您所说，性能不是问题 - 代码将是微不足道的（这通常是可取的 - 所有其他条件都相同）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-12T18:07:35.413

一种方法是首先对列表进行排序。

我们可以在没有大量内存的情况下对单词进行就地排序（以缓慢的性能进行交易）。

然后我们可以有一个简单的计数循环来查找频率最高的单词，而无需将所有内容保存在内存中，因为它们是排序形式的。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-12T18:07:42.480

你的意思是很多进程内存？如果是这样，一种方法是将磁盘用作虚拟内存（也就是编写文件系统包装器）。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-12T18:21:40.513

一种可能的解决方案是使用[trie](http://en.wikipedia.org/wiki/Trie)数据结构来存储与其出现次数相关的所有单词。

其他解决方案可以在这个相关问题的答案中找到：[用于存储单词列表的空间高效数据结构？](https://stackoverflow.com/questions/358240/space-efficient-data-structure-for-storing-a-word-list)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-12T19:06:17.723

像许多好的面试问题一样，这个问题的措辞有点模棱两可/不准确，以迫使受访者提出澄清问题和陈述假设。我认为这里的许多其他答案都很好，因为它们戳穿了这些假设并展示了对全局的理解。

*我*假设文本存储在某处“离线”，但有一种方法可以迭代文本中的每个单词，而不会将整个文本加载到内存中。

然后下面的 F# 代码找到前 N 个单词。它唯一的数据结构是键值对（单词，频率）的映射，并且只保留其中的前N个，因此内存使用量为O（N），很小。运行时间为 O(numWordsInText^2)，虽然很差，但考虑到问题的限制，这是可以接受的。该算法的要点很简单，对于文本中的每个单词，计算它出现的次数，如果它在运行的 best-N 中，则将其添加到列表中并删除之前的最小条目。

请注意，下面的实际程序将整个文本加载到内存中，只是为了方便说明。

```
#light
// some boilerplate to grab a big piece of text off the web for testing
open System.IO 
open System.Net 
let HttpGet (url: string) = 
    let req = System.Net.WebRequest.Create(url) 
    let resp = req.GetResponse() 
    let stream = resp.GetResponseStream() 
    let reader = new StreamReader(stream) 
    let data = reader.ReadToEnd() 
    resp.Close() 
    data 
let text = HttpGet "http://www-static.cc.gatech.edu/classes/cs2360_98_summer/hw1"
let words = text.Split([|' ';'\r';'\n'|], System.StringSplitOptions.RemoveEmptyEntries)
// perhaps 'words' isn't actually stored in memory, but so long as we can 
// 'foreach' over all the words in the text we're good
let N = 5  // how many 'top frequency' words we want to find
let FindMin map =
    // key-value pair with mininum value in a map
    let (Some(seed)) = Map.first (fun k v -> Some(k,v)) map
    map |> Map.fold_left 
        (fun (mk,mv) k v -> if v > mv then (mk,mv) else (k,v)) 
        seed
let Main() =
    let mutable freqCounts = Map.of_list [ ("",0) ]
    for word in words do
        let mutable count = 0
        for x in words do
            if x = word then
                count <- count + 1
        let minStr,minCount = FindMin freqCounts
        if count >= minCount then
            freqCounts <- Map.add word count freqCounts
        if Seq.length freqCounts > N then
            freqCounts <- Map.remove minStr freqCounts
    freqCounts 
    |> Seq.sort_by (fun (KeyValue(k,v)) -> -v) 
    |> Seq.iter (printfn "%A")
Main() 
```

输出：

```
[the, 75]
[to, 41]
[in, 34]
[a, 32]
[of, 29] 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-09-26T20:10:34.567

您可以使用**外部合并排序**和**优先级队列**的组合。合并排序将确保您的内存限制得到遵守，优先队列将保持您的前 K 个搜索。显然，优先级队列必须足够小以适合内存。

*   首先，将输入字符串分成chunk，对每个chunk进行排序并存储到二级存储中（外部排序） - O(n log n)
*   读取每个块和块内，计算单词的频率，所以在这一步结束时，每个块都减少到块内**（唯一的单词 - 频率计数）**。在）
*   开始跨块阅读元素并汇总每个单词。由于块已排序，因此您可以在 O(n) 中完成
*   现在，维护一个包含 K 个元素的最小优先级堆（堆的顶部是堆中的最小元素）。用前 K 个元素填充优先级堆，然后为下一个**(unique word -final count)**填充优先级堆，如果其计数大于堆中的顶部元素，则弹出顶部并推送当前单词。O(n log k)

所以你的最终时间复杂度是**O(n(log k + log n))** -

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-12T19:16:17.043

好吧，如果你想要绝对糟糕的表现......

取书中的第一个单词，数一数它出现了多少次。取书中的第二个单词，数一数它出现了多少次。如果超过最后一个单词，丢弃最后一个单词。等等......你最终会多次计算相同的单词，除非你在某处保留它们的列表，但如果你*真的*想最小化内存，这应该只需要几个整数。应该在 O(n^2) 时间内运行，其中 n 是书中的单词数。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-02-09T07:40:30.513

如何创建一个单词键的二叉树（当您继续从文件中读取单词时）。这有助于在 O(Log(n)) 中搜索已经重复的单词。所以最后你得到了 O(nLog(n)) 的热门词搜索。

基本算法将是

对于文件中的每个单词：

1.  为给定单词创建唯一键（加权 ascii char 例如“bat”可以是 1*'b' + 2*'a' + 3*'c';
2.  将这个词添加到树中。如果单词已经存在，则增加新计数。
3.  将单词和当前计数输入到maintainTop5(word, count)。维护Top5() 维护top5 计数和相关单词的动态列表。

文件末尾有前 5 个单词。

# sifr - 透明度和 SF beta 4

> ID：742129
> 
> 赞同：0
> 
> 时间：2009-04-12T18:05:32.113
> 
> 标签：sifr

我正在使用 Drupal 模块在站点中实现 sirf。我有几个问题...

1.  在测试期间，文本在 Safari 4 beta (win) 中失败，并在应用透明度时呈现绿色背景。毫无疑问是 Safari 或插件问题。发生了一些糟糕的事情，Lightbox 覆盖无法覆盖任何 Flash 对象。我确定你们正在跟踪该错误。

2.  使用 Flash CS4 导出的字体不起作用。不知道为什么，我恢复使用其中一个在线转换网站。我认为FLA是CS3。也许这可以更新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-13T20:35:28.017

Safari 4 / Windows 中的透明度失败绝对是一个 Safari 错误。

您使用的是哪个 sIFR 版本？sIFR 2 电影有 CS 3 格式，我认为 sIFR 3 电影是 Flash 8。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T17:39:21.200

sIRF3 并且不能与 Flash CS4 一起使用（用于编辑）

我遇到了一些问题，即在初始页面加载时未绘制标题。就像在 sIRF 启动之前没有在 html 中绘制标题一样，然后什么也没有出现。

另一个 jQuery 创建阴影在 sIRF 文本之前绘制，然后当页面移动时它们位于错误的位置。

我已经改变了对这个的调用......

```
$('document').ready(function(){
  $('.image-thumbnail img').ready(function(){
    setTimeout( "drawShadow();", 4000) //slow it down to give objects a chance to draw
  });
});

function drawShadow(){
  $('.image-thumbnail').dropShadow({left:2, top:2, blur:2, opacity:0.5});  // Creates new drop shadows
} 
```

我真正需要的是 sIRF 已经完成的信号。知道我该怎么做吗？

# c# - 如何将代码生成合并到 C# 解决方案中？

> ID：742136
> 
> 赞同：1
> 
> 时间：2009-04-12T18:09:45.753
> 
> 标签：c#, visual-studio, build-process, code-generation, thrift

（[这个问题](https://stackoverflow.com/questions/582934/c-code-generation)很相似，但唯一的答案似乎并不能满足我的需求）。

我正在考虑在 C#中使用[Thrift ，并且正在考虑构建过程将如何工作。](http://wiki.apache.org/thrift/)Visual Studio 2008 中的 C# 项目是否支持生成 C# 类的自定义生成操作？

我找到了“自定义工具”选项，但我不确定它是否是我正在寻找的......它只允许设计时使用（不是构建过程不可或缺的，而是右键单击“运行自定义工具” ）。

**更新**

Fionn 建议的预构建事件确实不是最理想的，因为它们没有考虑依赖关系并延长构建过程。此外，它们是从一个中心位置而不是每个文件进行管理的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-12T18:14:46.817

如果您只是将代码生成放在预构建事件中会怎样。

它们位于 Visual Studio 中项目属性的“构建事件”部分。

它们还支持一些宏，如果您使用“Edit Pre-build ...”按钮，您会看到这些宏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T04:05:28.970

正如 Fionn 所提到的，最简单和最安全的选择是在“预构建事件”中包含生成。优点：代码总是正确的，缺点：慢，因为这意味着在每次编译时，您重新生成源代码，然后重建所有依赖项，因为生成的代码已更改。

另一种选择是手动重新生成代码文件，如果您有构建机器/持续集成，则重新构建每个构建的代码文件。优点：如果更改很少，则构建速度更快 缺点：生成的代码过时，以及为了解决问题而浪费数小时的调试时间。

阅读 C# 项目帮助，您似乎需要一个插件来提供您想要的自定义工具操作。但在 C++ 项目中，您可以定义自己的自定义步骤[MS-Help](http://msdn.microsoft.com/en-us/library/hefydhhy(VS.80).aspx)。因此，您可以开发一个 VisualStudio 插件（或找到一个）或将一个 C++ 项目添加到您的解决方案中，并向该项目添加一个自定义构建步骤，然后将输出包含在您的普通 C# 项目中。

' [visual studio custom tool code gen](http://www.google.com/search?q=visual+studio+custom+tool+code+gen) '的第一个谷歌有一个[如何编写你自己的自定义工具](http://www.drewnoakes.com/snippets/WritingACustomCodeGeneratorToolForVisualStudio/)，这将是一个很好的起点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-12T18:21:57.720

[MS Build](http://msdn.microsoft.com/en-us/library/0k6kkbsd.aspx)是高度可配置的。Visual Studio 本身的[扩展性也很强](http://msdn.microsoft.com/en-us/vsx/default.aspx)。您可以使用[CodeDOM](http://msdn.microsoft.com/en-us/library/y2k85ax6.aspx)来发出类。根据您想在自定义 VS 和构建过程中投入多少时间，几乎没有什么是您不能做的。

# java - TreeViolationException 问题

> ID：742140
> 
> 赞同：0
> 
> 时间：2009-04-12T18:11:02.053
> 
> 标签：java, collections

嗨，我在插入二叉树中节点的右侧时遇到了一些麻烦......我只是不明白为什么会发生异常。这是插入的方法：

```
public void attachRight(BinaryTree<T> tree) {
    if (right != null) {
        throw new TreeViolationException();

    }
    if (tree != null) {
        tree.parent = this;
        right = tree;
    }
} 
```

这是我的主要课程中的代码

公共类测试{

```
public static void main(String[] args) {

    /*  the tree to be built                30
     *                                    /    \
     *                                  12     16
     *                                 /  \   /  \
     *                               null  1  2   5
     */

    //Create binary tree and set root to 30
    BinaryTree<Integer> root = new BinaryTree<Integer>();
    root.makeRoot(30);
    //System.out.println(root.getData()); //for verifying only

    //Insert 12 -> left(30)
    root.attachLeft(new BinaryTree<Integer>());
    root.left.setData(12);

    //Insert 16 -> right(30)
    root.attachRight(new BinaryTree<Integer>());
    root.right.setData(16);

    //insert 1 -> right(12)
    root.right.attachRight(new BinaryTree<Integer>());
    root.right.right.setData(1);

    //insert 2 -> left(16)
    root.right.attachLeft(new BinaryTree<Integer>());
    root.right.left.setData(2);

    //insert 5 -> right(16)
    root.right.attachRight(new BinaryTree<Integer>());
    root.right.right.setData(5);

    System.out.println(root.getData());
    System.out.println(root.left.getData());
    System.out.println(root.right.getData());

} 
```

}

我只能插入 30、12 和 16。不知道发生了什么......这是我得到的错误，它发生在 attachRight 方法中

proj5.BinaryTree.attachRight（BinaryTree.java:98）的线程“主”proj5.TreeViolationException 中的异常

TreeViolationException 只是我拥有的一个扩展 RuntimeException 的类

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-12T18:44:43.780

从给出的信息来看，异常应该来自这一行：

```
//insert 5 -> right(16)
root.right.attachRight(new BinaryTree<Integer>()); 
```

因为 root.right.attachRight() 已经在这一行被调用：

```
//insert 1 -> right(12)
root.right.attachRight(new BinaryTree<Integer>()); 
```

并且 root.right 已经有正确的节点。为什么它来得早，现在无法诊断。您应该提供更多信息（例如 BinaryTree 类的完整实现）。

# c# - C# - 什么是超时和失败连接的良好 SQLException 错误处理

> ID：742153
> 
> 赞同：2
> 
> 时间：2009-04-12T18:18:23.907
> 
> 标签：c#, sql, exception, .net-2.0, sqlexception

我将 EntitySpaces 用于所有与数据库相关的编码。作为一个单独的开发人员，我没有时间坐下来为我编写的每个应用程序编写 SQL，因此使用 ES 之类的生成器可以让我脚踏实地，为我节省几天甚至几周的时间。

我通常为我的应用程序使用的每个表编写一系列帮助程序类。我遇到的问题是，我真的不知道处理任何 SQL 超时或失败连接的最佳方法，除了在每个处理返回数据的方法周围粘贴一个 Try-catch。

在 EntitySpaces 中，只有在我运行任何类型的 CRUD 命令时才会构建和执行 SQL 连接。

例如：

```
 public TblUserCollection GetCollection()
    {

        TblUserCollection collection = new TblUserCollection();
        collection.Query.Where(collection.Query.CompanyId == CompanyId);
        collection.Query.OrderBy(collection.Query.FullName, esOrderByDirection.Ascending);
        collection.Query.Load();

        return collection;

    } 
```

当我的助手类被告知将某个公司的用户列表分配给 ComboBox 时，将调用此方法。然后该方法调用它，我将数据分配给列表。我有大约 30 个这样的点，在特定于表的帮助器类中都称为 GetCollection()。

除了将方法编写为：

```
 public TblUserCollection GetCollection()
    {

        try
        {

            TblUserCollection collection = new TblUserCollection();
            collection.Query.Where(collection.Query.CompanyId == CompanyId);
            collection.Query.OrderBy(collection.Query.FullName, esOrderByDirection.Ascending);
            collection.Query.Load();

            return collection;
        }
        catch (System.Data.SqlClient.SqlException ex)
        {
            //
        }

    } 
```

我还可以做些什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-12T18:43:20.600

定义一个基类来处理您的 SQL 错误处理并让您的所有类都执行。TblUserCollection 实现该基类。因此，当您的子类抛出 sql 异常时，您可以让基类通过优雅的退出为您处理它们

您是否尝试过 Subsonic（免费版）和 LLBLGen（商业版）。两者都会为您生成 DAL 和一些 Web 组件。您对 Entityspaces 还满意吗？您的回答将对我自己的项目有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-12T18:27:57.690

这并不能真正回答您的问题，但您可以尝试学习 LINQ。它可以使这个代码：

```
public TblUserCollection GetCollection()
{

    TblUserCollection collection = new TblUserCollection();
    collection.Query.Where(collection.Query.CompanyId == CompanyId);
    collection.Query.OrderBy(collection.Query.FullName, esOrderByDirection.Ascending);
    collection.Query.Load();

    return collection;

} 
```

在我的脑海中更具可读性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-12T18:44:07.807

传统的方法是让异常从您的 GetCollection 方法传播。您通常不想返回可能不完整的集合。

然后也许在您的表示层的顶层，您可以捕获异常并例如为用户提供重试的机会。

# java - Common Lisp 中的类自省

> ID：742154
> 
> 赞同：12
> 
> 时间：2009-04-12T18:18:31.643
> 
> 标签：java, reflection, lisp, common-lisp, introspection

Java 的 java.lang.Class 类有一个 getDeclaredFields 方法，它将返回给定类中的所有字段。Common Lisp 有类似的东西吗？在阅读了成功 Lisp 第 10 章 ( [http://www.psg.com/~dlamkins/sl/chapter10.html](http://www.psg.com/~dlamkins/sl/chapter10.html) ) 中的说明后，我发现了一些有用的功能，例如描述、检查和符号 plist。但他们都没有做 getDeclaredFields 所做的事情。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-12T19:40:13.070

您应该使用 class-slots 和/或 class-direct-slots（两者都来自 CLOS Metaobject Protocol，MOP）。class-slots 返回给定类中存在的所有插槽，而 class-direct-slots 返回在类定义中声明的所有插槽。

不同的 lisp 实现对 MOP 的实现略有不同；使用[更紧密的拖把](http://common-lisp.net/project/closer/closer-mop.html)包来与 MOP 有统一的接口。

例子：

```
(defclass foo ()
  (foo-x))

(finalize-inheritance (find-class 'foo)) ;this is needed to be able to query class slots and other properties. Or, class is automatically finalized when its first instance is created

(class-slots (find-class 'foo))
=> (#<STANDARD-EFFECTIVE-SLOT-DEFINITION FOO-X>)

(slot-definition-name (first (class-slots (find-class 'foo))))
=> FOO-X 
```

例子 ：

```
(defun inspect (( object standard-object))
  (inspect-rec (class-slots (class-of object)) object) )

(defun inspect-rec (slots o)
  ( if(atom slots) ()
   (let ((sn (slot-definition-name (car slots)))) (cons (list sn '=> ( slot-value o sn) )  ( inspect-rec (cdr slots) o))))) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-12T18:27:54.727

我认为您正在寻找[CL 的 MetaObject 协议](http://www.lisp.org/mop/index.html)。

# css - 使用 CSS 边框的 CSS 轮廓

> ID：742163
> 
> 赞同：0
> 
> 时间：2009-04-12T18:25:16.557
> 
> 标签：css, border, outline

可悲的是，IE7 不支持 CSS 大纲，所以我被卡住了使用边框。但是为页面上的任何元素添加边框会占用空间并可能会移动页面。

如果我要添加一个 2px 的边框，那么我设置了一个 -2px 的边距，它仍然不是完美的，因为列表项向左移动，并且“margin:auto”真的很糟糕。

您可以在此处查看示例：

[http://paul.slowgeek.com/nodeSelector/tests/simple.html](http://paul.slowgeek.com/nodeSelector/tests/simple.html)

[http://paul.slowgeek.com/nodeSelector/tests/center1.html](http://paul.slowgeek.com/nodeSelector/tests/center1.html)

例如，如果一个页面有：

```
<div>
    <p>Lorem Ipsum</p>
</div> 
```

然后我做了：

```
<div>
    <p style="border: 5px solid red">Lorem Ipsum</p>
</div> 
```

页面现在将大 10 像素，p 元素将缩进 5 像素。但如果我这样做了：

```
<div>
    <p style="outline: 5px solid red">Lorem Ipsum</p>
</div> 
```

在 firefox 3 中，页面将具有完全相同的高度，并且元素将位于相同的位置。我希望这种行为能够跨浏览器工作。

基本上，如何使用 CSS 边框来获得 CSS 轮廓的效果？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-12T19:14:54.613

如果您担心的是悬停效果，并且您的背景颜色统一，那么只需将元素的非悬停边框设置为背景颜色，然后只需更改悬停时的颜色即可。所以元素总是相同的大小，尽管你必须减少填充来调整边界总是在那里。

所以而不是

```
a p {padding: 10px;}
a:hover {border: 5px solid red;} 
```

采用

```
a p {border: 5px solid white;padding:5px}
a:hover p {border-color: red;} 
```

顺便说一句，如果您在链接或输入以外的任何元素上使用 :hover ，那么在 ie6 中将看不到任何效果，很多人仍在使用它。但是您可以使用 ie7 脚本来解决这个问题：[http ://code.google.com/p/ie7-js/](http://code.google.com/p/ie7-js/)

# .net - .NET 可编程图形匹配？

> ID：742164
> 
> 赞同：1
> 
> 时间：2009-04-12T18:27:23.010
> 
> 标签：.net, graphics, ocr

有谁知道用于读取图像文件并将其与现有图像集进行比较的 .NET 可编程/可用 API？

例如，我有三个字母 A、B 和 C 的图片。然后我复制 A 的图片，并对其进行修改，使其翻转 180 度。我希望能够有一个软件来检测它是否与现有的字母 A 匹配。

我很感激任何帮助！

编辑：将字母 A、B 和 C 替换为苹果、橙子和香蕉的图像。这与其说是识别字母数字字符，不如说是比较形状/图像。

编辑#2：把它想象成一种检测掷骰子结果的方法。想象一个标准的六面凹口模具。当你掷出一个六时，有六个点。它可以以任何方式降落，但我想做的是让相机拍摄模具的照片并将其与控制图像进行比较以检测值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-12T20:02:40.910

您似乎正在研究的（不是双关语）是[计算机视觉](http://en.wikipedia.org/wiki/Computer_vision)研究计划的一部分。您的目标图像到底有什么特点？您是否只在寻找尺寸完全相同但方向不同的模板匹配？轻微的位移会导致精细和倾斜特征的像素模式显着不同。是否应该识别重新调整比例？倾斜的视角怎么办？您的编辑表明您实际上进入了更困难的领域：完整的图像识别需要完整的 AI。您希望从什么角度识别香蕉，在什么光照条件下，以及什么样的香蕉——绿色的、成熟的、因为坐在上面而略微压扁……我希望你明白我的意思！

不要误会我的意思：这很有趣，但需要重型火炮。您可能会发现哪些库可以帮助您处理繁重的线性代数和统计提升，但您需要了解很多才能应用这些库。

对于更轻松的阅读（比较！），我对该领域的介绍伴随着 Hofstadter 的[Gödel、Escher Bach](http://en.wikipedia.org/wiki/G%C3%B6del,_Escher,_Bach)和他关于识别字母形状的[Metamagical themas 。](http://en.wikipedia.org/wiki/Metamagical_Themas)这也让我对排版产生了兴趣：我从来不知道有这么多画小写字母“a”的方法！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-13T07:41:02.777

在您上面的一条评论中，您提到您想使用相机系统检测骰子卷。

有几种方法可以解决这个问题，这里有两种：

1）非常简单的方法。使用霍夫变换对你的骰子面的图片进行圆形检测并计算圆形的数量。您将大致了解骰子上的点数大小，这应该有助于设置霍夫算法。

2) 复杂的方法。获取模具每个面的图像并计算傅立叶变换并提取功率谱（二维然后跨方向折叠）。功率谱将为您提供每个芯片面的签名，与芯片相对于相机的方向无关。您可以将这些特征功率谱与模卷中的功率谱进行比较。最接近的匹配应该是您的点数....

希望这有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-13T13:40:48.900

如果我正确理解您的问题（尤其是编辑 2），您想在来自相机或扫描仪的数字图像中搜索圆形图案。

正如 RobS 已经说过的，霍夫变换和傅里叶谱中的模板匹配是实现此目的的好方法。您可能会发现许多用于霍夫变换或 FFT 的库，但我不确定您是否能够在不真正理解算法的情况下使用其中的一个。例如：标准霍夫变换仅适用于线条，它必须适用于圆形。此外，它需要某种预处理来找到圆的边缘。它有一些参数（内部参数空间的大小），如果您不知道它们的含义，则很难调整它们。

如果您可以对图像进行二值化，即如果您正在寻找的圆形图案比背景明显更亮或更暗，则可能更简单

*   二值化图像
*   将像素的连接区域（即 Blob）分组（例如，使用 Flood-Fill）
*   通过将斑点的某些特征（例如总面积、边界像素数、平均亮度、平均对比度）与您期望的图案类型进行比较来确定斑点是否是您的图案之一

这些子问题（二值化、分割、模式匹配）都不是简单的，甚至一般都不是可以解决的，但是如果您的问题足够简单，您可能只需使用一些非常简单的算法即可。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-12T18:41:31.260

如果你安装了 Office，你可以[使用它的 OCR 组件](http://www.devsource.com/c/a/Languages/Using-The-Office-2007-OCR-Component-in-C/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-13T00:03:46.103

这是一个[开源](http://ir.codeplex.com/)图像识别程序。它处于测试阶段。这对你来说可能是一个开始。从描述：

> 根据图像本身的特征搜索图像，加载图像后搜索速度非常快。显示按相似度排序的结果列表。

您还可以在图像库中搜索重复项。

# .net - 立即注册和转移域以托管 .NET

> ID：742169
> 
> 赞同：0
> 
> 时间：2009-04-12T18:29:24.723
> 
> 标签：.net, hosting, dns

我正在做一个 ASP.NET/SQL Server 合同项目。客户想要展示迄今为止构建的内容，以便在当前未注册的域上为某些第三方演示它。

通常我通过 GoDaddy 注册域名。但是 GoDaddy 在注册后会在您的域上锁定 60 天，所以我也必须让 GoDaddy 托管来演示它。

我想知道是否所有注册商都进行了这种锁定。我想立即注册该域，但可以自由地在明天使用另一家公司托管它。

这有可能吗？我可以在今天向某人注册域名，然后在明天的演示之前将其转移到另一家公司进行托管吗？

有什么建议吗？谢谢！

编辑：所以我应该能够在一家公司注册域，设置托管而不转移域，只需编辑注册商的 DNS 条目以指向托管公司？

我认为锁阻止了我这样做，但听起来锁可能只是用于传输 - 而不是 DNS 更改。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-12T18:32:22.173

为什么您需要在托管的同一家公司注册域？您不能使用 GoDaddy 更改 DNS 设置以指向托管站点吗？我不熟悉 GoDaddy，但如果他们不允许这样做，那就太糟糕了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-12T18:33:21.077

不是所有的注册商都不会做这种锁定。GoDaddy 在服务条款方面非常刻薄。我曾经和他们一起托管过一次，并制作了一个需要在单独的线程（在 ASP.Net 中）中运行某些任务的网站。我创建了它并运行了 2 周，然后他们锁定​​了设施，我的线程被阻塞了。很长一段时间都是地狱。我换了一个主人。

您可能可以使用 resellerclub。我在他们那里购买了一个经销商帐户，现在拥有许多域。如果他们做零售域名销售，我不会这样做。

祝你好运。

编辑：我还意识到锁定只能在域名转移到另一个注册商（即，如果您需要更改注册商（而不是托管），您只能在 60 天后进行。是的，大多数注册商都会这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-10T18:55:38.227

锁定仅适用于转移域或更改所有权。它不会以任何方式影响 DNS。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-07T01:26:20.263

GoDaddy 告诉您“选择加入”了 60 天锁定，这绝对是不真实的。把你的东西交给像 NameCheap 这样的好服务，他们不会自愿去惹他们的客户。即使在告诉 GoDaddy 我需要转移一个域之后，他们也忽略了我，也没有将我指向我“自愿”选择加入的单个屏幕截图或文档。处理它们已经浪费了大量时间。

# java - LongClick 事件也会触发 Click 事件

> ID：742171
> 
> 赞同：14
> 
> 时间：2009-04-12T18:31:59.817
> 
> 标签：java, android, events, event-handling

我使用按钮的 onLongClick 和 onClick 事件来获取用户输入。每当; 用户长按并触发onLongClick事件，同时触发onClick事件。我找不到我的问题。两种方法的代码如下所示：

```
@Override
    public void onClick(View v) {
        switch(((Button) v).getId())
        {
        case R.id.enter:
            EntertheNumber();
            break;
        case R.id.clear:
            CleartheNumber();
            break;
        case R.id.number_zero:
        case R.id.number_one:
        case R.id.number_two:
        case R.id.number_three:
        case R.id.number_four:
        case R.id.number_five:
        case R.id.number_six:
        case R.id.number_seven:
        case R.id.number_eight:
        case R.id.number_nine:
            AddtotheNumber(mEditor, (Button) v);
            break;
        }
@Override
    public boolean onLongClick(View view) {
        if(SMBGuesstheNumber.bDisplayFlagList)
        {
            theActiveButton = (Button) view;
            showDialog(R.id.display_flaglist);
        }
        return false;
    } 
```

实际上，我的项目是开源的。[因此，您可以在http://code.google.com/p/guessthenumber/](http://code.google.com/p/guessthenumber/)找到所有代码

谢谢你。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-04-12T19:12:05.493

我不确定这些事件发生的顺序，但 onLongClick 处理程序返回一个布尔值以指示事件是否已处理。如果您处理了它，您应该返回 true 以便不会调用其他点击事件。我不知道这是否会阻止 onClick() 触发。

您还可以使用 setClickable(boolean) 和 setLongClickable(boolean) 关闭和打开这些事件

[您可以在此处](http://developer.android.com/guide/topics/ui/ui-events.html)找到此信息以及有关 UI 事件的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-10-20T06:13:11.610

这里是关于触摸事件的简要总结： [http ://rxwen.blogspot.com/2010/10/android-touch-event-summary.html](http://rxwen.blogspot.com/2010/10/android-touch-event-summary.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-03T11:16:31.853

LongClick SingleClick 上的解决方案将不起作用：

```
rippleView.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
            //Your code
            }
        });
rippleView.setOnLongClickListener(new View.OnLongClickListener() {
            @Override
            public boolean onLongClick(View v) {
                return true;
            }
        }); 
```

# c# - 可以制作托管（非 GDI）位图吗？

> ID：742172
> 
> 赞同：3
> 
> 时间：2009-04-12T18:32:18.210
> 
> 标签：c#, gdi+

是否可以制作完全托管的代码位图对象？我的理解是 Bitmap 对象是 GDI 对象的包装器 - 这是非托管代码。

我很感兴趣这样做（希望）在处理数千张图像时提高性能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-12T18:40:08.143

Bitmap 对象从来没有问题。

传统的想法是，非托管代码比托管代码稍微快一点，所以奇怪的是，你认为反过来会提高性能......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-12T19:39:30.763

我想推荐查看 Paint.NET 的源代码，但它看起来不再可用了 :(。真可惜，因为它在位图上有很多好东西。但是，我发现了这个：[http://code .google.com/p/paint-mono/](http://code.google.com/p/paint-mono/)，也许它可以帮助你解决你的问题

# sql - Postgres 函数

> ID：742180
> 
> 赞同：2
> 
> 时间：2009-04-12T18:39:34.433
> 
> 标签：sql, postgresql

我需要使用连接进行选择查询。这应该写在一个函数中。我的方法不起作用：

```
CREATE OR REPLACE FUNCTION test2()
RETURNS SETOF record AS'
DECLARE
    r record;
BEGIN
    for r in SELECT * FROM messages_wall INNER JOIN location ON
         messages_wall.id = location.id
         loop
    return next r;
    end loop;
end; '
LANGUAGE 'plpgsql' 
```

错误：返回“记录”的函数需要列定义列表

我应该从 .net 应用程序中调用此函数。我应该如何进行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-06-22T02:41:08.100

`SELECT * FROM test2() AS tabletest2 (id integer, name text);`如果你真的想使用一个函数，但在这种情况下视图更好

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-12T18:59:13.107

代替将表加入您的功能，您可以使用视图。

返回 SETOF **your_view** ;

您可能还必须使用适当的数据类型定义 r ：

```
r your_view%ROWTYPE; 
```

或者

您必须指定字段和数据类型。

```
SELECT * FROM test2() AS fields_1 as INTEGER, fields_2 AS ... ; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-13T01:56:34.570

对于您的示例，在 (PL/pgSQL) 函数中包装连接是不必要的。正如 Luc M 所提到的，视图将是最简单和最快的。

如果您坚持使用函数，但您的下一个选择应该是[SQL 函数](http://www.postgresql.org/docs/current/static/xfunc-sql.html)- 更多信息请[点击此处](http://www.postgresql.org/docs/current/static/xfunc-sql.html#XFUNC-SQL-TABLE-FUNCTIONS)和[此处](http://www.postgresql.org/docs/current/static/xfunc-sql.html#AEN40353)。

# user-interface - 默认全屏还是允许用户在第一次启动时选择默认？

> ID：742182
> 
> 赞同：1
> 
> 时间：2009-04-12T18:40:57.660
> 
> 标签：user-interface, usability

在一个图形密集型应用程序中，要求规定它应该默认为全屏模式，即使应用程序在 Windows 下运行也是如此。我知道很多游戏都会这样做，但我觉得这很烦人。默认的 IMO 应该是在窗口中打开而不是全屏模式。我建议用户第一次运行应用程序时应该选择默认行为。我错了吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-12T18:46:04.167

我会在第一次启动应用程序时遵循要求。我还将提供一种从全屏切换到窗口的简单方法，例如按 ESC（以及返回全屏的另一种方法）。然后我会在退出应用程序时存储该模式，并在下次启动时恢复该模式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-12T18:53:44.477

我认为烦恼因素很大程度上取决于应用程序试图做什么。

如果它是我在 5 个不同的应用程序中工作时可能会启动的一些实用程序，并且它强制我的全屏，那么我会非常恼火。

如果它是一个专门的应用程序，可以帮助我完成给定任务的整个工作流程（这样我从不需要或很少需要同时打开任何其他应用程序），那么全屏实际上可能是一个有效的默认设置。

无论你做什么，只要确保切换启动行为是非常容易发现的。因为无论你走哪条路，你的一些用户都会不同意你的决定。对他们来说，改变他们喜欢的方式应该很容易。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-12T18:45:22.203

在做与您的要求相反的事情之前，我会更改要求。

但是，如何在*安装时*让用户选择呢？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-22T11:46:33.747

首次启动时的窗口应默认为最大比例用户的最佳大小。对于图形密集型功能齐全的应用程序，这很可能是全屏。

至于个人用户对窗口大小的偏好，在我看来，大多数用户直到他们开始使用应用程序并查看他们需要多少屏幕空间以及他们使用多少屏幕后才会知道他们是否想要全屏。窗口与其他窗口一起使用。因此，在安装或首次启动时询问他们想要哪种尺寸可能会很烦人甚至令人困惑。最好将这样的设置放在选项/首选项下。

也许最好的办法是在退出时保存窗口状态。喜欢非最大化的用户因此只需要非最大化（和调整大小）一次然后忘记它。唯一的考虑是有一些方法可以将窗口重置为默认值（例如，Window > Standard Size 菜单项），以便新手用户不小心将窗口调整大小或重新定位到奇怪的东西并且不知道如何恢复它。或者，您可以有一个 Window > Keep Sizes and Positions 菜单项，供用户显式保存跨会话的窗口状态。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-12T19:16:09.417

回到需求编写者那里，询问他们是否考虑过非传统的监视器设置，例如：

*   **30" 或更大的显示器。**您真的希望您的应用程序占用所有屏幕空间吗？
*   **多台显示器。**您将在哪台显示器上运行？用户可以将您的应用程序从一台显示器移动到另一台显示器吗？您的应用程序可以跨越多个显示器吗？
*   **虚拟桌面。**用户可以将您的应用程序从一个桌面移动到另一个桌面吗？他们可以在您的应用程序运行时切换桌面吗？您的应用程序可以跨越多个桌面吗？

这种设置越来越普遍，尤其是大型显示器。IMO，全屏模式（许多旧 Windows 应用程序的默认模式）变得越来越没用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-01T14:01:32.103

向用户展示*最初*选择全屏/与窗口的选项的问题在于他们还没有使用该软件。在没有经验的情况下，他们如何才能决定哪个对他们更好？

我会以提供最佳用户体验的任何模式运行该应用程序，然后在“首选项”中提供一个选项来更改它，并在第二次启动该应用程序时提供提示。

# iphone - 如何创建本地自动释放池以节省内存？

> ID：742196
> 
> 赞同：6
> 
> 时间：2009-04-12T18:49:25.347
> 
> 标签：iphone, memory-management

苹果表示这是节省内存的好主意。在代码中会是什么样子？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-12T21:41:15.167

通常你不需要创建自动释放池，因为系统关心这个。但是，有时您需要这样做。它通常在大循环中。代码如下所示：

```
NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
int i;    
for (i = 0; i < 1000000; i++) {    
  id object = [someArray objectAtIndex:i];
  // do something with object
  if (i % 1000 == 0) {
    [pool release];
    pool = [[NSAutoreleasePool alloc] init];
  }
}
[pool release]; 
```

自动释放池保存为堆栈：如果您创建一个新的自动释放池，它会被添加到堆栈的顶部，并且每个自动释放消息都会将接收者放入最顶层的池中。

# c - 如何检测堆栈溢出的点

> ID：742200
> 
> 赞同：11
> 
> 时间：2009-04-12T18:49:55.327
> 
> 标签：c, linux, gdb, stack-overflow, callstack

我的 C 程序有以下问题： 某处是堆栈溢出。尽管在没有优化和调试器符号的情况下进行编译，但程序会以以下输出退出（在 Linux 上的 gdb 内部或外部）：

程序因信号 SIGSEGV、分段错误而终止。该程序不再存在。

我可以检测到这实际上是堆栈溢出的唯一方法是通过 valgrind 运行程序。有什么办法可以强制操作系统转储调用堆栈跟踪，这将帮助我找到问题？

可悲的是，gdb 也不允许我轻松进入该程序。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-12T19:32:08.830

如果您允许系统转储核心文件，您可以使用 gdb 分析它们：

```
$ ulimit -c unlimited # bash sentence to allow for infinite sized cores
$ ./stack_overflow
Segmentation fault (core dumped)
$ gdb -c core stack_overflow
gdb> bt
#0  0x0000000000400570 in f ()
#1  0x0000000000400570 in f ()
#2  0x0000000000400570 in f ()
... 
```

有时我看到一个生成错误的核心文件有一个不正确的堆栈跟踪，但在大多数情况下，bt 会产生一堆对同一方法的递归调用。

核心文件可能有一个不同的名称，其中可能包含进程 ID，它取决于当前系统中内核的默认配置，但可以使用（以 root 身份运行或使用 sudo）进行控制：

```
$ sysctl kernel.core_uses_pid=1 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-12T18:54:11.900

使用 GCC，您可以尝试以下操作：

> `-fstack-protector`
> 发出额外的代码来检查缓冲区溢出，例如堆栈粉碎攻击。这是通过将保护变量添加到具有易受攻击对象的函数来完成的。这包括调用 alloca 的函数，以及缓冲区大于 8 字节的函数。进入函数时初始化守卫，然后在函数退出时检查。如果保护检查失败，则会打印一条错误消息并退出程序。
> 
> `-fstack-protector-all`
> 与 -fstack-protector 类似，只是所有函数都受到保护。

[http://gcc.gnu.org/onlinedocs/gcc-4.3.3/gcc/Optimize-Options.html#Optimize-Options](http://gcc.gnu.org/onlinedocs/gcc-4.3.3/gcc/Optimize-Options.html#Optimize-Options)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-12T19:15:42.490

当一个程序因 SIGSEGV 而死时，它通常会在 Unix 上转储内核。您可以将该内核加载到调试器中并检查堆栈的状态吗？

# mysql - 如何更改表的默认排序规则？

> ID：742205
> 
> 赞同：204
> 
> 时间：2009-04-12T18:53:10.610
> 
> 标签：mysql, sql, collation

```
create table check2(f1 varchar(20),f2 varchar(20)); 
```

使用默认排序规则创建一个表`latin1_general_ci`；

```
alter table check2 collate latin1_general_cs;
show full columns from check2; 
```

将列的单独排序规则显示为“latin1_general_ci”。

那么alter table命令的作用是什么？

* * *

## 回答 #1

> 赞同：632
> 
> 时间：2011-03-29T07:00:24.037

*要更改包含现有列*的表的默认字符集和排序规则（注意**convert to**子句）：

```
alter table <some_table> convert to character set utf8mb4 collate utf8mb4_unicode_ci; 
```

由于一些评论的提示，编辑了答案：

> 应避免推荐 utf8。它几乎从来都不是你想要的，而且经常会导致意想不到的混乱。utf8 字符集与 UTF-8 不完全兼容。如果你想要 UTF-8，你想要 utf8mb4 字符集。– Rich Remer 2018 年 3 月 28 日 23:41

和

> 这似乎很重要，很高兴我阅读了评论并感谢@RichRemer。Nikki，我认为你应该在你的答案中编辑它，考虑到有多少浏览量。请参阅此处[https://dev.mysql.com/doc/refman/8.0/en/charset-unicode-utf8.html](https://dev.mysql.com/doc/refman/8.0/en/charset-unicode-utf8.html)和此处[MySQL 中的 utf8mb4 和 utf8 字符集有什么区别？](https://stackoverflow.com/q/30074492/772035)– Paulpro 3 月 12 日 17:46

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-04-12T19:05:33.327

MySQL 有 4 级排序规则：服务器、数据库、表、列。如果更改服务器、数据库或表的排序规则，则不会更改每列的设置，而是更改默认排序规则。

例如，如果您更改数据库的默认排序规则，您在该数据库中创建的每个新表都将使用该排序规则，如果您更改表的默认排序规则，您在该表中创建的每一列都将使用该排序规则。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-12T18:58:55.620

它设置表的默认排序规则；如果您创建一个新列，则应与 latin_general_ci 进行整理——我认为。尝试为单个列指定排序规则，看看是否有效。MySQL 在处理这个问题方面有一些非常奇怪的行为。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-09-20T21:28:02.270

可能不仅需要更改 SCHEMA 表

```
ALTER SCHEMA `<database name>`  DEFAULT CHARACTER SET utf8mb4  DEFAULT COLLATE utf8mb4_unicode_ci ; 
```

正如里奇所说 - utf8mb4

（玛丽亚数据库 10）

# javascript - 有人知道 DOM 检查器 javascript 库或插件吗？

> ID：742210
> 
> 赞同：15
> 
> 时间：2009-04-12T18:55:56.030
> 
> 标签：javascript, jquery, html, dom

有人知道 DOM 检查器 javascript 库或插件吗？

我想在我正在创建的网站中使用此代码，我搜索了很多但没有找到我想要的，除了这个：[http ://slayeroffice.com/tools/modi/v2.0/modi_help.html](http://slayeroffice.com/tools/modi/v2.0/modi_help.html)

**更新：** 似乎没有人理解我的问题:(我想找到一个示例或插件来让我实现 DOM 检查器。我不想要一个工具来检查 DOM；我想自己写。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2011-10-07T09:14:31.473

我也在寻找同样的东西，除了[http://slayeroffice.com/tools/modi/v2.0/modi_help.html](http://slayeroffice.com/tools/modi/v2.0/modi_help.html)我发现：[http://www.selectorgadget.com/](http://www.selectorgadget.com/) ( [https:// github.com/iterationlabs/selectorgadget/](https://github.com/iterationlabs/selectorgadget/) )

也遇到了这个[https://github.com/josscrowcroft/Simple-JavaScript-DOM-Inspector](https://github.com/josscrowcroft/Simple-JavaScript-DOM-Inspector)

不幸的是，我还没有找到任何基于 jQuery 的东西。但是“Javascript DOM Inspector”似乎是寻找这种东西的正确关键字。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-12T19:00:16.067

[Firebug Lite](http://getfirebug.com/lite.html)怎么样- 它就像[Firebug](http://getfirebug.com/)，但你将它插入到你的页面中，这样你就可以在大多数浏览器（包括非 FF 浏览器）上调试你的 html、css、Javascript 和 DOM

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-13T01:01:15.733

[Aardvark](http://karmatics.com/aardvark/)是官方的 firefox 扩展，但您也可以将其用作 javascript 库。上述网站中的内联演示是使用 javascript 实现的。深入研究代码，你会发现[loader.js](http://karmatics.com/aardvark/loader.js)正在引导 Aardvark 模块。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-17T15:46:58.947

我找到了这个： [http ://userscripts.org/scripts/review/3006](http://userscripts.org/scripts/review/3006)

这个也很好：

[DOM 鼠标悬停元素选择和隔离](http://snippets.dzone.com/posts/show/4513)

这非常简单，只需几行代码，并给我一些很好的编辑内容并得到我想要的东西。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-04-27T04:25:54.543

最近，我需要使用 JavaScript 开发一个应用程序：当任何用户单击该站点的图像时，它会将图像 URL 发送到特定位置。这是帮助我实现这一目标的文章：[AspBoss - Dom Inspector 的 Javascript 库](http://aspboss.blogspot.com/2011/03/javascript-library-for-dom-inspector.html)

这是[代码](http://userscripts.org/scripts/review/3006)：

```
// DOM Inspector
// version 0.1
// 2006-01-25
// Copyright (c) 2006, Onur Mat
//
// --------------------------------------------------------------------
//
// This user script allows you to interact with elements of a web page
// by moving mouse pointer on a web page and clicking on selected elements.
//
// To install for Firefox, you need Greasemonkey: http://greasemonkey.mozdev.org/
// Then restart Firefox and revisit this script.
// Under Tools, there will be a new menu item to "Install User Script".
// Accept the default configuration and install.
//
// To install for Internet Explorer, you need Turnabout:
// http://www.reifysoft.com/turnabout.php
// See instructions for using Turnabout here:
// http://www.reifysoft.com/turnabout.php
//
// --------------------------------------------------------------------
//
// ==UserScript==
// @name          DOM Inspector
// @namespace     http://www.dominspector.com/
// @description   Inspect DHTML DOM elements interactively
// @include       *
// ==/UserScript==

function DIOnMouseOver(evt)
{
    element = evt.target;   // not IE

    // set the border around the element
    element.style.borderWidth = '2px';
    element.style.borderStyle = 'solid';
    element.style.borderColor = '#f00';
}

function DIOnMouseOut(evt)
{
    evt.target.style.borderStyle = 'none';
}

function DIOnClick(evt)
{
    var selection = evt.target.innerHTML;

    alert('Element is: ' + evt.target.toString() + '\n\nSelection is:\n\n' + selection);
    return false;
}

document.addEventListener("mouseover", DIOnMouseOver, true);
document.addEventListener("mouseout", DIOnMouseOut, true);
document.addEventListener("click", DIOnClick, true); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-12T19:00:22.010

[Firebug](http://getfirebug.com/)是 Firefox 的一个很好的解决方案。您可以浏览页面的 HTML、JavaScript、DOM、网络活动等。Safari 还内置了相当不错的工具（我目前使用的是 Safari 4 beta），尽管我发现在 Firebug 中导航更容易。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-12T19:01:26.970

是的，有很多。例如，Firefox 有**[DOM Inspector](https://addons.mozilla.org/en-US/firefox/addon/6622)**、**[Firebug](https://addons.mozilla.org/en-US/firefox/addon/1843)**和[**X-Ray**](https://addons.mozilla.org/en-US/firefox/addon/1802)。我个人认为 Firebug 是三者中最好的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-12T19:17:02.220

IE8 上的开发者工具

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-12T22:00:10.660

尝试[Backbase 调试器应用程序](http://www.backbase.com/products/enterprise-ajax/development-tools/#debugging)。它还有一个 I/O 检查器。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-13T00:48:51.567

我以前一直使用 Firebug 和 Firefox，现在感谢 IE8，它有一个非常酷的工具，叫做开发者工具 --- 允许查看所有的 Javascript、CSS 并允许非常酷的调试功能。微软即将到来！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-08-10T18:16:24.010

一位同事向我推荐了这个：Web X 射线护目镜[https://secure.toolness.com/webxray/](https://secure.toolness.com/webxray/)

# sql - 如何从 SELECT 语句的前一个结果行中获取值？

> ID：742226
> 
> 赞同：4
> 
> 时间：2009-04-12T19:02:13.053
> 
> 标签：sql, ms-access

如果我们有一个名为 FollowUp 的表并且有行 [ ID(int) , Value(Money) ] 并且我们在其中有一些行，例如
ID --Value
1------70
2------ 100
3--------150
8------200
20-----250
45-----280
**我们想做一个SQL查询来获取每一行的ID、值和前一行数据显示如下** ID --- Value --- Prev_Value
1 ----- 70 ---------- 0
2 ----- 100 -------- 70
3 ----- 150 -------- 100
8 ----- 200 -------- 150
20 ---- 250 -------- 200
45 -- -- 280 -------- 250

我进行了以下查询，但我认为它在大量数据中的性能非常糟糕

```
SELECT FollowUp.ID, FollowUp.Value,
(   
      SELECT F1.Value
      FROM FollowUp as F1 where 
      F1.ID =
             ( 
                SELECT  Max(F2.ID) 
                FROM FollowUp as F2 where F2.ID < FollowUp.ID  
             ) 
) AS Prev_Value
FROM FollowUp 
```

那么任何人都可以帮助我为此类问题找到最佳解决方案吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-14T18:44:37.273

这个 sql 的性能应该比你上面的那个更好，尽管这些类型的查询往往有点性能密集型......所以你可以在其中放入任何东西来限制你正在查看的数据集的大小都会有很大帮助。例如，如果您正在查看特定的日期范围，请将其放入。

```
SELECT followup.value, 
    ( SELECT TOP 1 f1.VALUE 
      FROM followup as f1 
      WHERE f1.id<followup.id 
      ORDER BY f1.id DESC
    ) AS Prev_Value
FROM followup 
```

高温高压

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-12T19:45:59.857

您可以使用 OVER 语句来生成递增的行号。

```
select
    rownr = row_number() over (order by id)
,   value
from your_table 
```

使用数字，您可以轻松查找上一行：

```
with numbered_rows
as (
    select
        rownr = row_number() over (order by id)
    ,   value
    from your_table
)
select
    cur.value
,   IsNull(prev.value,0)
from numbered_rows cur
left join numbered_rows prev on cur.rownr = prev.rownr + 1 
```

希望这是有用的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-14T10:03:33.813

这不是您实际问题的答案。

相反，我觉得您从错误的方向解决问题：在正确规范化的关系数据库中，每个表的元组（“行”）应该包含对其他数据库项目的引用，而不是实际值。维护元组之间的这些关系属于代码库的数据插入部分。也就是说，如果包含具有最接近、更小的 id 编号的元组的值，则确实属于您的数据模型。

如果知道先前值的要求来自应用程序的视图部分 - 即需要以某种方式格式化数据的单个视图 - 您应该将内容拉出，按 id 排序，并处理要求在查看具体代码。

在您的情况下，我假设知道以前的元组的值确实属于视图代码而不是数据库。

编辑：您确实提到您将它们分开存储并且只想对其进行查询。即便如此，应用程序代码可能是进行这种组合的更合乎逻辑的地方。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-12T19:07:32.523

将这些线拉入您的应用程序并在那里计算先前的值怎么样？

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-04-12T19:15:52.647

创建一个存储过程并使用游标来迭代和生成行。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2015-10-30T21:04:05.993

您可以使用“滞后”功能。

```
 SELECT ID,
            Value,
            LAG(value) OVER(ORDER BY ID) AS Prev_Value
     FROM FOLLOWUP; 
```

# objective-c - Objective-C 中的“函数”和“宏”有区别吗？

> ID：742229
> 
> 赞同：1
> 
> 时间：2009-04-12T19:05:49.470
> 
> 标签：objective-c

我想知道两者是否相同？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-12T19:12:46.473

它们不是同一件事。C 或 Objective-C 中的函数是将一些过程代码组织成一个单元。它具有非常具体的语义，您可以在任何基本的 C 书籍中阅读它们，并在更高级的书籍中阅读更多高级信息。

另一方面，宏是在编译的预处理阶段创建的，它不是实际二进制文件的单独部分。使用宏，宏实际上在复杂发生之前在代码中被替换，以便在使用宏的任何地方注入副本。这就是为什么在使用宏时要考虑副作用很重要的原因（因为如果宏多次使用相同的参数，副作用将多次出现）。

这是一个说明宏的快速示例：

```
#define SHOW_STRING_TWICE(string)  printf("%s\n%s\n", string, string)

// ...

SHOW_STRING_TWICE("Hello, macro!"); 
```

在预处理过程中，宏扩展为以下代码：

```
printf("%s\n%s\n", "Hello, macro!", "Hello, macro!"); 
```

您可以在此代码中看到副作用如何成为问题：

```
#define DOUBLE_NUMBER(number) ((number) + (number))

// ...

int doubleRandom = DOUBLE_NUMBER(generate_random_number()); 
```

在这种情况下，当宏展开时，generate_random_number() 实际上被调用了两次，而您原本期望它只被调用一次。

# c# - 如何在 C# 中从 byte[] 创建 bmp 文件

> ID：742236
> 
> 赞同：8
> 
> 时间：2009-04-12T19:10:02.567
> 
> 标签：c#, bitmap, byte, rgb, 24-bit

我在 TCP 客户端中收到了一个字节 [] 数组。该数组包含一个 24 位 RGB 位图文件。如何创建具有给定宽度、高度和数据的位图文件？

在 C++ 中我使用这个

```
int WriteBitmapFile(const char *filename, int width, int height, unsigned char *imageData)
{
FILE             *filePtr;        // file pointer
BITMAPFILEHEADER bitmapFileHeader;    // bitmap file header
BITMAPINFOHEADER bitmapInfoHeader;    // bitmap info header
DWORD                 imageIdx;    // used for swapping RGB->BGR
unsigned char     tempRGB;            // used for swapping

// open file for writing binary mode
filePtr = fopen(filename, "wb");
if (!filePtr)
    return 0;

// define the bitmap file header
bitmapFileHeader.bfSize = sizeof(BITMAPFILEHEADER);
bitmapFileHeader.bfType = 0x4D42;
bitmapFileHeader.bfReserved1 = 0;
bitmapFileHeader.bfReserved2 = 0;
bitmapFileHeader.bfOffBits = sizeof(BITMAPFILEHEADER) + sizeof(BITMAPINFOHEADER);

// define the bitmap information header
bitmapInfoHeader.biSize = sizeof(BITMAPINFOHEADER);
bitmapInfoHeader.biPlanes = 1;
bitmapInfoHeader.biBitCount = 32;                        // 24-bit
bitmapInfoHeader.biCompression = BI_RGB;                // no compression
bitmapInfoHeader.biSizeImage = width * abs(height) * 4;    // width * height * (RGB bytes)
bitmapInfoHeader.biXPelsPerMeter = 0;
bitmapInfoHeader.biYPelsPerMeter = 0;
bitmapInfoHeader.biClrUsed = 0;
bitmapInfoHeader.biClrImportant = 0;
bitmapInfoHeader.biWidth = width;                        // bitmap width
bitmapInfoHeader.biHeight = height;                    // bitmap height

// switch the image data from RGB to BGR
for(imageIdx = 0; imageIdx < bitmapInfoHeader.biSizeImage; imageIdx+=4)
{
    tempRGB = imageData[imageIdx];
    imageData[imageIdx] = imageData[imageIdx + 2];
    imageData[imageIdx + 2] = tempRGB;
}

// write the bitmap file header
fwrite(&bitmapFileHeader, 1, sizeof(BITMAPFILEHEADER), filePtr);

// write the bitmap info header
fwrite(&bitmapInfoHeader, 1, sizeof(BITMAPINFOHEADER), filePtr);

// write the image data
fwrite(imageData, 1, bitmapInfoHeader.biSizeImage, filePtr);

// close our file
fclose(filePtr);

// Success
return 1;
} 
```

我怎么能在 C# 中做到这一点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-12T20:38:04.820

If the array actually contains a bitmap file, then you can just save the bytes as a file:

```
File.WriteAllBytes(fileName, imageData); 
```

If the array contains only raw pixel data, you can create a Bitmap object using the data:

```
unsafe {
   fixed (byte* ptr = imageData) {
      using (Bitmap image = new Bitmap(width, height, stride, PixelFormat.Format24bppRgb, new IntPtr(ptr))) {
         image.Save(fileName);
      }
   }
} 
```

The `stride` value is the number of bytes between the scan lines. If there is no padding between the scan lines, it's `width * 3` for a 24bpp format.

This method uses the data in the array without creating another copy of the entire image in memory (which is why it needs the stride value).

If the bitmap data is stored upside down in the array, the `stride` value should be negative, and the pointer should be the start of the last scan line in memory (`ptr + stride * (height - 1)`).

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-12T19:23:02.270

我无法使用您将收到的流对其进行测试，但这应该可以。

```
int WriteBitmapFile(string filename, int width, int height, byte[] imageData)
{
  using (var stream = new MemoryStream(imageData))
  using (var bmp = new Bitmap(width, height, PixelFormat.Format24bppRgb))
  {
    BitmapData bmpData = bmp.LockBits(new Rectangle(0, 0,
                                                    bmp.Width,
                                                    bmp.Height),
                                      ImageLockMode.WriteOnly,
                                      bmp.PixelFormat);

    Marshal.Copy(imageData, 0, bmpData.Scan0, imageData.Length);

    bmp.UnlockBits(bmpData);

    bmp.Save(filename);
  }

  return 1;
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-12T19:15:42.037

我建议在 C# 中制作一个位图，并让它自己保存。

例如，请参阅[这篇文章。](http://www.tek-tips.com/viewthread.cfm?qid=1264492&page=10)（特别是最后的回答是正确的。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-06-27T13:26:52.083

这是一种方法，在这里我创建了一个自定义事件参数，其中包含图像存储为字节数组的大小。您可能不需要为此烦恼，这是我创建的代码，用于从 gige 相机存储的字节数组中检索图像，因此对我来说这很有意义。

```
public Bitmap ShowImage(byte[] sender, EventImageParams e)
    {
        Bitmap bitmap = new Bitmap(e.width, e.height, PixelFormat.Format24bppRgb);
        BitmapData bmData = bitmap.LockBits(new Rectangle(0, 0, bitmap.Width, bitmap.Height),
                                            ImageLockMode.ReadWrite, bitmap.PixelFormat);
        IntPtr pNative = bmData.Scan0;

        Marshal.Copy(sender, 0, pNative, (e.width  * e.height * 3));
     //    
        bitmap.UnlockBits(bmData);

        return bitmap;
    } 
```

# java - 我可以在 sun 的 rt.jar 文件中添加类吗？

> ID：742254
> 
> 赞同：6
> 
> 时间：2009-04-12T19:17:17.290
> 
> 标签：java, runtime, jdk1.6, jakarta-mail

我下载了 Javax.mail 包。我有 jdk1.6.0_11。问题是......我无法让 javac 或 java 找到这些类！我可以使用 JCreator LE 编译应用程序（通过将邮件 jar 添加到其搜索列表）但是，当我尝试在命令窗口中运行应用程序时，它会失败。

我可以将这些新类添加到 rt.jar 而不损害我的 jdk 安装吗？我知道java已经连接到那里寻找类。（而且，邮件类位于 javax 包中 - 似乎可以将它们合理地添加到 rt.jar 中的 javax 文件夹中。

谢谢！菲尔·D'

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-12T19:18:57.257

不，你不能，也不应该。

相反，找出你的类加载器的问题（可能是路径？）。您将需要它来访问您需要访问的下一个库。

弄乱 rt.jar 意味着你不能在任何其他 JVM 上运行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-12T19:30:33.000

您应该在类路径中指定 jar 文件：最好在命令行中使用该`-cp`选项，但也可以使用`CLASSPATH`环境变量。

或者，您可以在系统属性中指定其*目录。*`java.ext.dirs`有关更多详细信息，请参阅[扩展机制的文档](http://java.sun.com/j2se/1.5.0/docs/guide/extensions/)。

你不应该胡闹`rt.jar`。这绝对*不是*让额外的 jar 文件可用的方法——它类似于尝试将 Microsoft Word 添加到 Windows 内核；）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-12T19:53:16.673

向 rt.jar 添加东西似乎是个坏主意，尽管它可能而且很容易完成。

尝试从命令行编译您的应用程序，如下所示：

```
javac -cp <path_to_3rd_libs>/jarfile.jar . MainClass.java 
```

如果编译器仍然抱怨 javax.mail 包，请尝试解压缩/检查 jar 文件以查看 javax.mail 包（及其预期内容）是否存在。

（在 Windows 上，使用 7zip 很容易检查 jar 文件。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-12T19:39:24.040

绝对没有。如果您从命令行发布您正在运行的命令，我们将能够为您指出正确的方向，但很可能您只是缺少一个类路径参数。

java -classpath /path/to/mail.jar MyClass

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-12T23:30:56.557

您需要了解 CLASSPATH 概念，它允许您将单个类和包含类的 jar 文件添加到可用于要编译和/或运行的代码的已定义类的“宇宙”中。它在思想上类似于 Windows 世界中的 PATH 变量。

对于 Windows 命令行，这是文档：

[http://java.sun.com/javase/6/docs/technotes/tools/windows/classpath.html](http://java.sun.com/javase/6/docs/technotes/tools/windows/classpath.html)

Java 教程对这个特定概念的写得不好，这让我感到惊讶：

[http://java.sun.com/docs/books/tutorial/essential/environment/paths.html](http://java.sun.com/docs/books/tutorial/essential/environment/paths.html)

你很可能需要一些类似的东西：

C:> 设置 CLASSPATH=c:\javamail\first.jar;c:\javamail\second.jar

之后 java 和 javac 都应该知道这些类

# c# - 在asp.net C#中定位response.write的输出

> ID：742255
> 
> 赞同：0
> 
> 时间：2009-04-12T19:18:38.893
> 
> 标签：c#, asp.net, response.write

我正在尝试使用 response.write 将输出发布到我的 aspx 页面，因为我正在使用以下代码：

```
Response.Write("&lt;<span id='Label1'' style='height:16px;width:120px;Z-INDEX: 102; LEFT: 288px; POSITION: absolute; TOP: 144px'>Its not at the top left corner!</span>"); 
```

这会在屏幕中间打印我的消息，但也会在左角显示一个“<”。我已经尝试了一些东西，但我无法摆脱它。

请帮忙

还有其他定位输出的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-12T19:26:28.143

尝试：

```
Response.Write("<span id='Label1' style='height:16px;width:120px;Z-INDEX: 102; LEFT: 288px; POSITION: absolute; TOP: 144px'>Its not at the top left corner!</span>"); 
```

你有一个 < 在开始时，它给你 "<" 和 Label1 之后的双 ''

但是有很多更好的使用 CSS 定位和使用 Response.Write 生成输出的更好方法。通常不需要直接写......你想做什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-12T19:33:24.037

[这个](https://rads.stackoverflow.com/amzn/click/com/1590599594)或[这个](https://rads.stackoverflow.com/amzn/click/com/0470128615)或类似的东西会帮助你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-12T20:56:37.503

伙计，我有时会使用 response.write 来快速输出 HTML，但我真的建议不要大规模使用它，因为有更好更好的方法来创建干净的 HTMl 输出

*   有一个非常好的功能称为 ParseControl()，它接受一个字符串并将其转换为控件，就像您在上面所做的那样。
*   使用 HTMLWriter。
*   使用 HTMLGeneric 控件。

使用前面提到的所有方法，您可以很好地控制您喜欢的自定义输出。

祝你好运。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-14T07:26:58.340

一种更简单的方法而不是文字：

```
@Html.Raw("<h1>text</h1>"); 
```

# jquery - Jquery $.ajax 异步奇怪行为

> ID：742261
> 
> 赞同：5
> 
> 时间：2009-04-12T19:20:45.097
> 
> 标签：jquery, ajax, asynchronous

我有一个这样的代码片段

```
var searchurl="http://mysite.com/searchpath?q=test";
$.ajax({
   type: "GET",
   url: searchurl,
   cache: false,
   dataType : "jsonp",
   async : false,
   success: function(data){
        alert("success");
   }
});
alert("outside ajax"); 
```

问题是我在工作中没有看到异步。“outside ajax”是我得到的第一个弹出窗口，第二个是“成功”。我有什么明显的遗漏吗？

将我的评论添加到 Anothny 的回复中

我的测试环境是 win xp sp2, FF 3.0.8/w Firebug + IE 8\. 和 JQuery v1.3.2 。我无法从萤火虫中找到任何明显的东西。

您是否愿意使用此网址“ [http://pipes.yahoo.com/pipes/pipe.run?_id=1nWYbWm82xGjQylL00qv4w&_render=json&textinput1=obama&_callback=](http://pipes.yahoo.com/pipes/pipe.run?_id=1nWYbWm82xGjQylL00qv4w&_render=json&textinput1=obama&_callback=) ”尝试上述代码？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-13T09:24:45.023

好吧，你不能有一个同步的 jsonp 请求。jsonp的实现方式是通过脚本标签hack来允许跨域访问。所以 $.ajax 只是忽略了 async 属性，因为它不能发出同步的 jsonp 请求。

附带说明一下，您应该尝试避免同步 ajax 请求。尽管起初它们的设计似乎更简单，但它们最终会在网络保留的情况下冻结浏览器，并导致非常不愉快的用户体验。

# c# - 我可以用 C# 和 Powershell 做什么？

> ID：742262
> 
> 赞同：44
> 
> 时间：2009-04-12T19:21:07.953
> 
> 标签：c#, powershell, powershell-2.0

我对 C# 有很好的了解，对 powershell 也有非常基本的了解。我正在使用 Windows PowerShell CTP 3，这真的很有趣。但我想超越编写脚本/函数。C#有什么很酷的东西吗？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-04-12T19:48:25.953

在最高级别，您有两个不同的选项您可以从 C# 程序托管 PowerShell 并通过 RunSpaces 和管道执行 PowerShell 命令。

或者，您可以在 PowerShell 中运行 C# 代码。这可以通过两种方式完成。使用 PowerShell 管理单元，一个提供 PowerShell cmdlet 和导航提供程序的已编译 dll，或者通过新的 cmdlet **Add-Type**，它允许您动态导入 C#、VB、F# 代码。从帮助

```
$source = @"
public class BasicTest
{
    public static int Add(int a, int b)
    {
        return (a + b);
    }

    public int Multiply(int a, int b)
    {
        return (a * b);
    }
}
"@

Add-Type -TypeDefinition $source
[BasicTest]::Add(4, 3)
$basicTestObject = New-Object BasicTest 
$basicTestObject.Multiply(5, 2) 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-04-12T19:33:08.907

我认为使用 C# 和 PowerShell 可以做的最有趣的事情就是构建 CmdLet's。这些本质上是 PowerShell 的插件，它们是用托管代码编写的，作用类似于普通函数。它们有一个动词-名词对，并且您已经使用的许多功能实际上都是 cmdlet。

[http://msdn.microsoft.com/en-us/magazine/cc163293.aspx](http://msdn.microsoft.com/en-us/magazine/cc163293.aspx)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-12T19:27:13.663

答案是“视情况而定”。你可以用 c# 做各种各样的事情（构建窗口、Web 客户端和移动客户端）。

您可以从 C# 调用 powershell 脚本。看看这个网站==>[链接](http://www.codeproject.com/KB/cs/HowToRunPowerShell.aspx)

您甚至可以将您的 c# 代码转换为 powershell ==>[链接](http://dalelane.co.uk/blog/?p=153)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-22T10:51:29.037

您可以通过以下两种方式之一查看它：

1.  如何在 C# 程序中利用 PowerShell
2.  如何在 PowerShell 中利用 C# 编程。

在某种程度上，它们是完全不同的问题，有不同的答案。

在 C# 中，您可以利用 PowerShell 引擎、运行空间、管道等。与 Exchante 一样，您可以使用 C# 来完成所有 GUI 工作，然后调用 PowerShell cmdlet 来完成所有困难工作。如果您可以找到要利用的 PowerShell cmdlet 或脚本，则此选项是合适的。

在 PowerShell 中，您可以使用 C# 来扩展您可以在 PowerShell 中执行的操作。您可以创建 cmdlt 和提供程序以使其他人能够访问应用程序数据。或者，您可以只创建可在 PowerShell 脚本中使用的对象。此选项是您帮助打开应用程序以更自动化方式进行管理的方式。

因此，根据您要做什么，您可以选择。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-22T10:57:26.980

Scott Hanselman aka [Hanselminutes](http://www.hanselminutes.com/)有几个关于 Powershell、CmdLets、C# 等的播客。如果您想了解它是什么、它是如何工作的等等，这是最好的。在他的网站上搜索以获取播客。

他网站上的 PS 相关播客列表（按时间倒序排列）：

[#190：Powershell 现状/Lee Holmes 和 Jason Shirk](http://www.hanselminutes.com/190/the-state-of-powershell-with-lee-holmes-and-jason-shirk)
[#162：Powershell 2.0](http://www.hanselminutes.com/162/powershell-20)
[#49：Powershell/Bruce Payette](http://www.hanselminutes.com/49/bruce-payette-powershell)
[#36：Jeffrey Snover，Powershell 架构师](http://www.hanselminutes.com/36/jeffrey-snover-powershell-architect)
[#24：Windows Powershell (MONAD)，第二部分](http://www.hanselminutes.com/24/windows-powershell-monad-part-ii)

# c# - 在实体框架中添加具有引用类型的新行

> ID：742265
> 
> 赞同：0
> 
> 时间：2009-04-12T19:23:27.870
> 
> 标签：c#, asp.net, entity-framework

我只使用实体框架几周。很好，但是我应该如何正确添加带有引用子项（表）的新行？

我试过这个程序

```
CMS.ShopOrder order = new CMS.ShopOrder();

    order.CreatedOn = DateTime.Now;

    foreach (var item in CMS.CurrentSession.Cart.Items)
    {           
        order.ShopOrderItems.Add(item);
    }

    db.AddToShopOrder(order);       

    int selT = FormatHelper.GetInt32(ddTransport.SelectedValue);
    int selP = FormatHelper.GetInt32(ddTransport.SelectedValue);    

    order.Transportation = db.Transportation.Where(t => t.Id == selT).FirstOrDefault();
    order.Payment = db.Payment.Where(p => p.Id == selP).FirstOrDefault();
    order.Customer = db.Customer.Where(c=>c.Id == CMS.CurrentSession.Customer.Id).FirstOrDefault();

    db.SaveChanges(); 
```

但我得到了错误：

> 一个实体对象不能被多个 IEntityChangeTracker 实例引用。第 492 行：base.AddObject("ShopOrder", shopOrder);

我可以一次添加所有这些记录吗？

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-12T19:47:59.557

您的对象上下文处理似乎有问题。该错误表明当您尝试添加实体时，该实体已与对象上下文相关联。我假设您在执行多个 Web 请求时保持一些实体处于活动状态，但是您为每个 Web 请求创建一个新的对象上下文。您必须将实体从旧上下文中分离出来并将它们附加到新上下文中才能使 this 正常工作。

有关类似问题，请参阅[MSDN 。](http://social.msdn.microsoft.com/forums/en-US/adodotnetentityframework/thread/5ee5db93-f8f3-44ef-8615-5002949bea71/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T09:46:46.747

谢谢丹布鲁克，

问题是，当我将它添加到会话时，我没有将它从 entityContext 中分离出来。

这有效：

```
public CMS.ProductVariant GetProductVariantById(int id)
    {
        ProductVariant pv = null;
        if (id > 0)
        {
            using (db = new CmsEntity())
            {
                pv = db.ProductVariant.Where(v => v.Id == id).FirstOrDefault();
                db.Detach(pv); 
            }
        }
        return pv;
    } 
```

# javascript - 使用 JavaScript 生成 PDF 文件

> ID：742271
> 
> 赞同：299
> 
> 时间：2009-04-12T19:27:31.277
> 
> 标签：javascript, pdf, pdf-generation

我正在尝试将 XML 数据从网页转换为 PDF 文件，我希望我可以完全在 JavaScript 中完成此操作。我需要能够绘制文本、图像和简单的形状。我希望能够完全在浏览器中完成此操作。

* * *

## 回答 #1

> 赞同：510
> 
> 时间：2009-04-22T19:49:46.127

我刚刚编写了一个名为[jsPDF](https://github.com/MrRio/jsPDF)的库，它仅使用 Javascript 生成 PDF。它还很年轻，我很快就会添加功能和错误修复。在不支持数据 URI 的浏览器中也有一些解决方法的想法。它是在自由的 MIT 许可下获得许可的。

在我开始写它之前我遇到了这个问题，并认为我会回来让你知道:)

[用 Javascript 生成 PDF](https://github.com/MrRio/jsPDF)

示例创建一个“Hello World”PDF 文件。

```
// Default export is a4 paper, portrait, using milimeters for units
var doc = new jsPDF()

doc.text('Hello world!', 10, 10)
doc.save('a4.pdf')
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.5/jspdf.debug.js"></script>
```

* * *

## 回答 #2

> 赞同：155
> 
> 时间：2014-05-07T12:13:18.510

另一个值得一提的 JavaScript 库是**pdfmake**。

*   [pdfmake游乐场](http://pdfmake.org/playground.html)
*   [github上的pdfmake](https://github.com/bpampuch/pdfmake)

浏览器支持似乎不如 jsPDF 强大，似乎也没有形状选项，但格式化文本的选项比 jsPDF 中当前可用的选项更高级。

* * *

## 回答 #3

> 赞同：69
> 
> 时间：2015-02-05T03:35:12.410

我维护[PDFKit](http://github.com/devongovett/pdfkit)，它也为 pdfmake 提供支持（这里已经提到过）。它适用于 Node 和浏览器，并支持其他库不支持的一堆东西：

*   嵌入子集字体，支持 unicode。
*   许多高级文本布局的东西（列、分页、完整的 unicode 换行、基本的富文本等）。
*   为高级排版（OpenType/AAT 连字、上下文替换等）处理更多字体。即将推出：如果您有兴趣，请查看 fontkit 分支。
*   更多图形内容：渐变等。
*   使用诸如 browserify 和流之类的现代工具构建。可在浏览器和节点中使用。

查看[http://pdfkit.org/](http://pdfkit.org/)获取完整教程，亲自了解 PDFKit 可以做什么。有关可以生成哪些类型的文档的示例，请查看使用 PDFKit 本身从一些 Markdown 文件[生成的 PDF 文档：](https://github.com/devongovett/pdfkit/blob/master/docs/generate.coffee) [http](http://pdfkit.org/docs/guide.pdf) ://pdfkit.org/docs/guide.pdf 。

您也可以在浏览器中以交互方式试用它：http: [//pdfkit.org/demo/browser.html](http://pdfkit.org/demo/browser.html)。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2016-05-30T13:39:01.263

另一个有趣的项目是[texlive.js](http://manuels.github.io/texlive.js/)。

它允许您在浏览器中将 (La)TeX 编译为 PDF。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2021-10-25T04:55:39.437

对于 react 爱好者，还有另一个用于生成 PDF 的好资源：[React-PDF](https://react-pdf.org/)

它非常适合在 React 中创建 PDF 文件，甚至可以让用户从客户端本身下载它们，而无需服务器！

这是 React-PDF 的一个小示例片段，用于创建 2 节 PDF 文件

```
import React from 'react';
import { Page, Text, View, Document, StyleSheet } from '@react-pdf/renderer';

// Create styles
const styles = StyleSheet.create({
  page: {
    flexDirection: 'row',
    backgroundColor: '#E4E4E4'
  },
  section: {
    margin: 10,
    padding: 10,
    flexGrow: 1
  }
});

// Create Document Component
const MyDocument = () => (
  <Document>
    <Page size="A4" style={styles.page}>
      <View style={styles.section}>
        <Text>Section #1</Text>
      </View>
      <View style={styles.section}>
        <Text>Section #2</Text>
      </View>
    </Page>
  </Document>
); 
```

这将生成一个单页的 PDF 文档。在里面，有两个不同的块，每个块都呈现不同的文本。这些不是您可以使用的唯一有效原语。您可以参考[组件](https://react-pdf.org/components)或[示例](https://react-pdf.org/repl)部分了解更多信息。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-04-21T22:27:51.287

[您可以通过添加从任何 url（例如http://www.phys.org](http://www.phys.org)）创建 pdf 的链接来使用此免费服务：

[http://freehtmltopdf.com/?convert=http%3A%2F%2Fwww.phys.org&size=US_Letter&orientation=portrait&framesize=800&language=en](http://freehtmltopdf.com/?convert=http%3A%2F%2Fwww.phys.org&size=US_Letter&orientation=portrait&framesize=800&language=en)

* * *

## 回答 #7

> 赞同：-40
> 
> 时间：2009-04-12T23:21:16.847

即使您可以在 JavaScript 中生成内存中的 PDF，您仍然会遇到如何将该数据传输给用户的问题。JavaScript 很难将文件推送给用户。

要将文件获取给用户，您需要进行服务器提交以使浏览器显示保存对话框。

话虽如此，生成PDF确实并不难。只需阅读规范。

# google-app-engine - 在 Google App Engine 上托管/转移网站

> ID：742276
> 
> 赞同：10
> 
> 时间：2009-04-12T19:31:22.250
> 
> 标签：google-app-engine, web, web-hosting

我的网站目前托管在付费服务器上，但我想将其转移到 GAE 上。我该怎么做？任何人都可以在这种情况下帮助我。我会很感激你的帮助。谢谢：）

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-12T21:21:05.120

1）首先，您必须使您的网站适应 GAE 框架（带有 django 的 python 或新的 Java 环境）。您可以通过下载提供本地服务器的 GAE [SDK来测试您的工作。](http://code.google.com/appengine/downloads.html)

[2) 然后在appengine.google.com](http://appengine.google.com/)上创建一个帐户并将您的应用程序上传到 something.appspot.com，进行测试。

3）如果你有域名，在这个域上创建一个google apps账号，最后把这个域和你的GAE网站绑定。[这](http://code.google.com/appengine/articles/domains.html)是谷歌文档。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-13T12:02:56.810

如果它只是一个不需要服务器端脚本或数据库的静态网站，那么您可能需要查看 Google Sites 而不是 Appengine。您可以在此处找到有关站点的更多信息：[http ://www.google.com/sites/help/intl/en/overview.html](http://www.google.com/sites/help/intl/en/overview.html)

如果您确实有一些服务器端逻辑正在进行，则需要将其转换为 python 或 java，并将您的关系数据库转换为不支持您当前数据库使用的 SQL 的 Google 数据 API。您可以阅读有关 API 以及数据 API 支持的内容和教程的更多信息：[http ://code.google.com/appengine/](http://code.google.com/appengine/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-14T11:16:11.907

针对 sanorita 的评论“*实际上，它是生成的 html 而不是纯 html。而 google appengine 是用于静态数据的......对吗？* ”：

AppEngine 可以托管静态数据，但这与它的意图相去甚远。

AppEngine 的目的是让开发人员能够轻松地在 Google 的基础架构上部署他们的动态应用程序。最后，假设您以有效的方式对应用程序进行了编程以处理扩展（*基本上只是注意到写入数据库的成本很高，并且争用是万恶之源*），您几乎可以处理任何数量的流量。

# ruby-on-rails - Rails：查找在某一天创建的任务？

> ID：742277
> 
> 赞同：5
> 
> 时间：2009-04-12T19:31:40.173
> 
> 标签：ruby-on-rails, ruby

我有一个任务列表（名称，starts_at），我试图在日常视图中显示它们（就像 iCal 一样）。

```
def todays_tasks(day)
    Task.find(:all, :conditions => ["starts_at between ? and ?", day.beginning, day.ending]
end 
```

我不知道如何将 Time.now（例如“2009-04-12 10:00:00”）动态转换为一天的开始（和结束），以便进行比较。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-12T21:10:47.673

```
def todays_tasks(now = Time.now)
  Task.find(:all, :conditions => ["starts_at > ? AND < ?", now.at_beginning_of_day, now.at_end_of_day])
end 
```

瞧！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-12T23:49:28.230

稍微扩展augustl的答案。在您的`Task`模型中，您可以定义一个方法来为您获取这些任务。

```
 def self.todays_tasks(t = Time.now)
    Task.all(:conditions => ["created_at > ? AND created_at < ?", t.at_beginning_of_day, t.tomorrow.at_beginning_of_day])
  end 
```

这有助于使您的控制器保持苗条。我还将一天的结束与明天的开始进行比较。这样可以确保如果用户在晚上 11:59:59 创建任务，它会保留在正确的日期。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T19:57:18.340

会不会是：

```
Task.all(:conditions => ["created_at >= ? AND created_at < ?", Time.now.at_beginning_of_day, Time.now.tomorrow.at_beginning_of_day] ) 
```

否则，您永远不会在任务当天检查 00:00:00，而 11:59:59 是任务当天结束时的最后一个值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-09T09:20:22.877

```
def todays_tasks(day)
   Task.where(:created_at => day.beginning_of_day .. day.end_of_day)
end 
```

# java - Java中的序列视频播放（剪辑列表）..可以做到吗？

> ID：742287
> 
> 赞同：1
> 
> 时间：2009-04-12T19:39:16.847
> 
> 标签：java, video, media, sequence

如果我有一堆视频文件，所有的格式、形状都完全相同，那么我可以无缝地播放它们而不会出现跳跃或间隙吗？从最终用户的角度来看，效果就像他们正在观看一个视频。

我知道这在 DirectX 中是可能的，但如果可能的话，我宁愿使用 Java。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-12T23:35:59.523

如果您想在 Java 中播放媒体，Sun 标准是 JMF ( [http://java.sun.com/javase/technologies/desktop/media/jmf/](http://java.sun.com/javase/technologies/desktop/media/jmf/) )，不幸的是它已经休眠了很长一段时间。

FMJ 项目 ( [http://fmj-sf.net/](http://fmj-sf.net/) ) 与 API 兼容并且正在积极开发中。

我无法更好地回答您的问题，但希望这可以让您走得更远。

# .htaccess - 无法为 .htaccess 中的长 url 进行 301 域重定向

> ID：742294
> 
> 赞同：1
> 
> 时间：2009-04-12T19:41:27.653
> 
> 标签：.htaccess

我刚刚将我的 siteA.com 移至 siteB.com。我正在尝试将流量从 siteA.com 转移到 siteB.com。

**我的 301 重定向不起作用的 .htaccess 文件**

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^www.siteA.com/home/3-Tips-in-Math.html$
RewriteRule ^/?$ "http://www.siteB.com/home/3-Tips-in-Math.html" [R=301,L] 
```

**你怎样才能使上面的代码工作？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-12T19:44:05.587

试试这个规则：

```
RewriteCond %{HTTP_HOST} !^www\.siteB\.example$
RewriteRule ^ http://www.siteB.example%{REQUEST_URI} [L,R=301] 
```

# silverlight - Silverlight 安装在 Firefox 3 中，但未检测到/激活

> ID：742310
> 
> 赞同：0
> 
> 时间：2009-04-12T19:49:00.333
> 
> 标签：silverlight, firefox

正如标题所说的那样。我们正在重新设计我们网站的 Silverlight 横幅，并且 Silverlight 内容在除 Firefox 3（PC v3.0.7,8 或 Mac v3.0.8）之外的所有浏览器中都能正常工作。但是，插件被标记为已安装。

问题页面位于： [http ://clearvision.programx.co.uk/Schools/Students.aspx](http://clearvision.programx.co.uk/Schools/Students.aspx)

（注意：我们知道垃圾 HT​​ML 标记，这是我们必须使用的 CMS SiteFinity 中的一个错误。我们已经尝试过使用和不使用这种错误内容，但没有任何效果。）

我看过许多关于 Firefox 3 出现问题的报告（这个特别好： [http ://tempvariable.blogspot.com/2008/04/silverlight-and-firefox-3.html）。](http://tempvariable.blogspot.com/2008/04/silverlight-and-firefox-3.html)

SL 控件是 Silverlight 1.0。

非常感谢任何帮助，我真的不想为 Firefox 用户编写替代内容！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T16:28:21.027

我检查了您的 Silverlight.js 文件，它是 .js 文件的 1.0 版。我认为升级到[Silverlight.js 文件](http://code.msdn.microsoft.com/silverlightjs)（已针对 FF3 更新）的 2.0 版本可能会解决您的问题。

# .htaccess - 无法进行从 siteA.com/* 到 siteB.com/* 的 301 重定向

> ID：742313
> 
> 赞同：0
> 
> 时间：2009-04-12T19:52:46.770
> 
> 标签：.htaccess

我刚刚将我的网站从 siteA.com 移到了 siteB.com。在 siteA.com 上发表了数百篇文章。

Google 仍然只能在 siteA.com 上找到文章。

**问题示例**

我可以在 Google 中找到以下文章

```
www.siteA.com/article1
...
www.siteA.com/article777 
```

我需要从siteA的每篇文章到siteB的文章进行301域重定向，这样

```
www.siteB.com/article1
...
www.siteB.com/article777 
```

这将需要 .htaccess 中的 777 个域重定向。

**有没有**比在 .htaccess -file 中编写 1555 行代码更简单的方法来进行域重定向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-12T20:08:09.073

为什么要进行 777 域重定向？只是说：

```
Redirect permanent / http://www.siteB.com/ 
```

进入 .htaccess 的文档根目录中的文件`www.siteA.com`。

# .net - 部分信任场景中 DataContracts 中的集合

> ID：742318
> 
> 赞同：0
> 
> 时间：2009-04-12T19:56:44.590
> 
> 标签：.net, wcf, serialization, datacontract, partial-trust

在设计用于序列化的 DataContracts 时，我一直很困惑。

假设我有一个对象（例如客户），它公开了一个集合属性（例如一个名为 Addresses 的 AddressCollection）。框架设计指南规定我不应该公开该属性的公共 mutator，即，集合属性应该有一个 get 和没有 set，而是一个公共 set 方法（public void SetAddresses(IEnumerable<Address>addresses)）。

但是，如果我想序列化该对象，并且我预计我将处于部分信任环境中，我*是否必须*向该属性添加一个公共设置器以便它可以正确反序列化？

此外，如果集合在序列化时没有任何内容，并且由于 DataContractSerializer 没有调用默认构造函数，我很确定该集合根本没有设置并且保留为空。我可以使用 OnSerializing 属性来初始化集合，但是在部分信任的情况下，*该*方法也必须是公共的，不是吗？这更难看。

有谁知道这里的适当指导？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T00:50:27.950

是的，它已经过尝试，真正的 OO 思维遇到了新工具。:) 我喜欢从[DTO 模式](http://msdn.microsoft.com/en-us/library/ms978717.aspx)的角度来考虑它。我将我的真正业务对象设置为尽可能接近无变异器，然后我使用一组设计为可序列化的 DTO 对象（公共属性、空白构造函数等）。这不是一个理想的解决方案，但我有发现如果你尝试将非常丰富的对象集与序列化混合，它会变得很难看。最好把它们分开。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T00:32:58.880

如果您真的想保护您的域模型，您可能需要考虑将一些数据传输对象添加到您的解决方案中。这样你就可以序列化你需要的东西并在内部操作域。

# .net - Createinstance() - 我这样做对吗？

> ID：742321
> 
> 赞同：6
> 
> 时间：2009-04-12T19:59:12.790
> 
> 标签：.net, vb.net, reflection, late-binding

我正在尝试用.NET 组合一个插件系统，但我不确定我是否做得正确。系统的基础是特定目录（{apppath}/Plugins/）将有一堆预编译的 DLL，我想通过反射查看每个目录，以及每个可用的类，如果它继承了特定的基类（这是在另一个 DLL 中定义的，但我稍后会介绍），然后创建它的一个实例并在所述实例中调用一个特定的函数。

```
Public Sub ScanPluginsInDirectory(ByVal Directory As String)

    Dim Plugins As New IO.DirectoryInfo(Directory)
    Dim Files As IO.FileInfo() = Plugins.GetFiles("*.dll")
    Dim CryptType As Type = GetType(CryptPluginBase)
    Dim PluginsData as List(Of LoadedPluginsInfo)

    For Each DllFile As IO.FileInfo In Files
        Try
            Dim thisAsm As Assembly = Assembly.LoadFrom(DllFile.FullName)
            Dim ClassDefs = thisAsm.GetTypes().Where(Function(type) CryptType.IsAssignableFrom(type))

            For Each ClassDef As Type In ClassDefs
                Dim A As Object
                A = ClassDef.Assembly.CreateInstance(ClassDef.Name)
                PluginsData.Add(New LoadedPluginsInfo(A.Plugin(), False))
            Next
        Catch ex As Exception
            Continue For
        End Try
    Next
End Sub 
```

我遇到的具体问题是，我不确定这是正确的方法。如果可以假设`A.Plugin()`实际存在并且此处引用的任何结构和类都没有错误，那么我尝试使用的方法是否有效？如果有人需要更多代码来提供帮助，我可以发布它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-12T20:06:17.767

总体而言，该策略应该奏效。Assembly.LoadFrom 调用会将目标程序集加载到进程中。从那里可以进行类型检查并创建这些类型的实例。

我认为创建实例最简单、最可靠的方法是使用 Activator.CreateInstance 方法。

```
For Each def As Type in ClassDefs
  Dim inst = Activator.CreateInstance(def)
  PluginsData.Add(new LoadedPluginsInfo(inst.Plugin(), False))
Next 
```

根据您的目标，另一个建议是将 Try/Catch 块移入循环而不是移出循环。将 Try/Catch 块放在循环外部意味着如果程序集中的任何给定类型确实有错误，您将丢弃该程序集中的所有类型。将其移入内部将允许您仅丢弃不能按预期工作的类型。d 当前行为可能是您的意图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-12T20:08:35.937

这应该可行，我以前在一些项目中一直在使用这种东西。我专门寻找了一个构造函数并调用了它，但除此之外它是相同的想法。

但是您可能想查看[MEF](http://codeplex.com/MEF)，它为您处理插件架构的很多事情（如果您愿意等待发布版本，它现在仍然是 CTP）。

# vb.net - 如何在 Visual Studio 2008 中自动创建代码片段？

> ID：742323
> 
> 赞同：0
> 
> 时间：2009-04-12T19:59:31.043
> 
> 标签：vb.net, visual-studio, interface, code-snippets

我正在尝试创建一个在 VB.Net 中自动实现完全类型化方法的接口

但是，我不知道该怎么做。

我想做一些类似于实现 IDisposable 时发生的事情，它为您提供完整的功能，包括代码和注释。

我知道如何制作代码片段以及如何使用选项卡快捷方式，但是当我实现自己的界面时，如何让代码片段自动出现？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-12T20:14:42.050

只需三个步骤即可轻松完成：

1.  购买 ReSharper
2.  创建一个实时模板来执行此操作
3.  利润！

即使是琐碎的任务，使用代码片段也是一个巨大的痛苦。

# .net - Mono XSP 许可证

> ID：742332
> 
> 赞同：5
> 
> 时间：2009-04-12T20:06:31.743
> 
> 标签：.net, licensing, mono, xsp

首先，对于这样的问题，我很抱歉，我查看了互联网和谷歌搜索，但那里有很多不同的想法。*在邮件列表中，我实际上看到人们声称需要购买 Mono 许可证才能在商业工具中使用它。*

**我可以在商业工具中使用 Mono XSP，许可是否允许？**

我不擅长阅读法律文件。并试图弄清楚这到底意味着什么。在 XSP 包中，我有这个 COPYING 文件：

> ```
> Copyright (c) 2002, 2003, 2004 Novell, Inc. and the individuals 
> ```
> 
> 列在 ChangeLog 条目上。
> 
> ```
> Permission is hereby granted, free of charge, to any person obtaining
> a copy of this software and associated documentation files (the
> "Software"), to deal in the Software without restriction, 
> ```
> 
> 包括但不限于使用、复制、修改、合并、发布、分发、再许可和/或出售软件副本的权利，并允许向其提供软件的人这样做，但须符合以下条件：
> 
> ```
> The above copyright notice and this permission notice shall be
> included in all copies or substantial portions of the Software.
> 
> THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
> EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
> MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
> NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
> LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
> OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
> WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. 
> ```

我的理解是“是的，只要我将此文件的副本保留在我的发行版中，我就可以使用和修改它”

我对吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-12T20:35:18.757

是的你是对的。那是[MIT 许可证](http://www.opensource.org/licenses/mit-license.php)- 或查看[此 Wikipedia entry on the topic](http://en.wikipedia.org/wiki/MIT_License)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-12T23:16:00.353

> 在邮件列表中，我实际上看到人们声称需要购买 Mono 许可证才能在商业工具中使用它。

这取决于您正在使用 Mono 的哪个部分以及您打算做什么。XSP 和所有 Mono 类库一样，是 MIT，这意味着只要保留版权标头，您几乎可以用它做任何事情。

然而，Mono 运行时是 LGPL。因此，如果您计划将其作为产品的一部分进行分发，您需要确保履行 LGPL 义务。如果你不能，那就是你需要获得商业 Mono 许可证的时候。

有关详细信息，请参阅[http://www.mono-project.com/License](http://www.mono-project.com/License)。

# .net - 类型和可为空的扩展方法

> ID：742336
> 
> 赞同：15
> 
> 时间：2009-04-12T20:09:49.927
> 
> 标签：.net, extension-methods

为简单起见，假设我想为 int 类型编写一个扩展方法？和诠释：

```
public static class IntExtentions
{
    public static int AddOne(this int? number)
    {
        var dummy = 0;
        if (number != null)
            dummy = (int)number;

        return dummy.AddOne();
    }

    public static int AddOne(this int number)
    {
        return number + 1;
    }
} 
```

**这可以仅使用一种方法来完成吗？**

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-12T20:18:47.860

不幸的是没有。你可以使int？（或您使用的任何可空类型）方法很容易调用不可空方法，因此您不需要使用 2 种方法复制任何逻辑 - 例如

```
public static class IntExtensions
{
    public static int AddOne(this int? number)
    {
        return (number ?? 0).AddOne();
    }

    public static int AddOne(this int number)
    {
        return number + 1;
    }
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-12T20:17:45.273

你不能。这可以通过编译以下代码进行实验验证

```
public static class Example {
  public static int Test(this int? source) {
    return 42;
  }
  public void Main() {
    int v1 = 42;
    v1.Test();  // Does not compile
  }
} 
```

如果您希望在两种类型上都使用它，则需要为每种类型（可空和不可空）编写扩展方法。

# oop - 抽象和封装的区别？

> ID：742341
> 
> 赞同：382
> 
> 时间：2009-04-12T20:15:02.410
> 
> 标签：oop, encapsulation, abstraction

封装和抽象之间的确切区别是什么？

* * *

## 回答 #1

> 赞同：283
> 
> 时间：2009-04-13T12:02:28.450

这里的大多数答案都集中在 OOP 上，但封装要早得多：

*   **每个函数都是一个[封装](https://en.wikipedia.org/wiki/Encapsulation_%28computer_programming%29)**；在伪代码中：

    ```
    point x = { 1, 4 }
    point y = { 23, 42 }

    numeric d = distance(x, y) 
    ```

    在这里，`distance`封装了平面中两点之间（欧几里得）距离的计算：它隐藏了实现细节。这就是封装，纯粹而简单。

*   **[抽象](https://en.wikipedia.org/wiki/Abstraction_%28software_engineering%29)是*泛化***的过程：采用具体的实现并使其适用于不同的，尽管有些相关的数据类型。抽象的经典示例是 C`qsort`对数据进行排序的函数：

    问题`qsort`是它不关心它排序的数据——事实上，它*不知道*它对什么数据进行排序。相反，它的输入类型是一个无类型指针 ( `void*`)，这只是 C 语言中“我不关心数据类型”的说法（这也称为类型擦除）。重要的一点是`qsort`，无论数据类型如何，实现始终保持不变。唯一需要改变*的*是比较函数，它因数据类型而异。`qsort`因此期望用户提供所述比较函数作为函数参数。

封装和抽象如此紧密地联系在一起，以至于你可以指出它们是真正不可分割的。出于实际目的，这可能是正确的；也就是说，这是一个不是抽象的封装：

```
class point {
    numeric x
    numeric y
} 
```

我们封装了点的坐标，但我们并没有从本质上抽象它们，而是对它们进行逻辑分组。

这是一个不是封装的抽象示例：

```
T pi<T> = 3.1415926535 
```

这是一个具有给定值 (π) 的*泛型变量* `pi`，声明不关心变量的确切类型。诚然，我很难在实际代码中找到这样的东西：抽象几乎总是使用封装。但是，上述*内容确实*存在于 C++(14) 中，通过[*变量模板*](http://en.cppreference.com/w/cpp/language/variable_template)（= 变量的通用模板）；语法稍微复杂一些，例如：

```
template <typename T> constexpr T pi = T{3.1415926535}; 
```

* * *

## 回答 #2

> 赞同：162
> 
> 时间：2015-03-24T04:04:41.660

许多答案及其示例具有误导性。

[封装](http://en.wikipedia.org/wiki/Encapsulation_(object-oriented_programming))是将*“数据”*和*“在该数据上运行的函数*”打包到一个组件中，并限制对某些对象组件的访问。
封装意味着对象的内部表示通常隐藏在对象定义之外的视图之外。

[抽象](http://en.wikipedia.org/wiki/Abstraction_(computer_science))是一种表示基本特征但不包括实现细节的机制。

*封装：* ——**信息隐藏**。
*抽象：* -**实现隐藏**。

示例（在 C++ 中）：

```
class foo{
    private:
        int a, b;
    public:
        foo(int x=0, int y=0): a(x), b(y) {}

        int add(){    
            return a+b;   
        } 
} 
```

任何类对象的内部表示`foo`都隐藏在类之外。--> 封装。
对象的任何可访问成员（数据/函数）`foo`都受到限制，并且只能由该对象访问。

```
foo foo_obj(3, 4);
int sum = foo_obj.add(); 
```

方法的实现`add`是隐藏的。--> 抽象。

* * *

## 回答 #3

> 赞同：140
> 
> 时间：2009-04-12T20:20:16.297

**封装**隐藏了可能适用于也可能不适用于通用或特殊行为的实现细节。

**抽象**提供了一种概括（例如，对一组行为）。

这是一本很好的读物：[Abstract, Encapsulation, and Information Hiding](http://www.tonymarston.co.uk/php-mysql/abstraction.txt) by the Object Agency 的 Edward V. Berard。

* * *

## 回答 #4

> 赞同：107
> 
> 时间：2009-04-12T22:10:58.713

encapsulation puts some things in a box and gives you a peephole; this keeps you from mucking with the gears.

abstraction flat-out ignores the details that don't matter, like whether the things have gears, ratchets, flywheels, or nuclear cores; they just "go"

examples of encapsulation:

*   underpants
*   toolbox
*   wallet
*   handbag
*   capsule
*   frozen carbonite
*   a box, with or without a button on it
*   a burrito (technically, the tortilla around the burrito)

examples of abstraction:

*   "groups of things" is an abstraction (which we call aggregation)
*   "things that contains other things" is an abstraction (which we call composition)
*   "container" is another kind of "things that contain other things" abstraction; note that all of the encapsulation examples are kinds of containers, but not all containers exhibit/provide encapsulation. A basket, for example, is a container that does not encapsulate its contents.

* * *

## 回答 #5

> 赞同：71
> 
> 时间：2012-11-27T17:29:55.933

**[封装](http://www.dotnetfunda.com/articles/article511-what-is-encapsulation-.aspx)**意味着隐藏数据，例如使用 getter 和 setter 等。

**[抽象](http://www.dotnetfunda.com/articles/article632-what-is-an-abstraction-.aspx)**意味着使用抽象类和接口等隐藏实现。

* * *

## 回答 #6

> 赞同：52
> 
> 时间：2015-07-06T10:41:06.543

* * *

## 回答 #7

> 赞同：41
> 
> 时间：2014-01-04T19:13:57.117

上面提供了很多很好的答案，但我将在这里介绍我的（Java）观点。

**数据封装**仅仅意味着包装和控制类中逻辑分组数据的访问。它通常与另一个关键字——**数据隐藏**相关联。这是在 Java 中使用[访问修饰符](http://opensourceforgeeks.blogspot.in/2013/03/access-modifiers-in-java.html)实现的。

一个简单的示例是定义一个私有变量并使用 getter 和 setter 方法授予对它的访问权限，或者将方法设为私有，因为它仅用于类中。用户无需了解这些方法和变量。

**注意**：不应误解封装只是数据隐藏。当我们说封装时，重点应该是对相关数据和行为进行分组或打包或捆绑在一起。

**另一方面，**数据抽象是泛化的概念，因此底层的复杂逻辑不会暴露给用户。**在 Java 中，这是通过使用[接口](http://opensourceforgeeks.blogspot.in/2013/04/interfaces-in-java.html)和[抽象](http://opensourceforgeeks.blogspot.in/2013/04/abstract-classes-and-functions-in-java.html)类来实现的。**

 **例子 -

假设我们有一个**接口 Animal**并且它有一个函数**makeSound()**。有两个具体的类**Dog**和**Cat**实现了这个接口。这些具体的类具有 makeSound() 函数的单独实现。现在假设我们有一只动物（我们从一些外部模块中得到它）。所有用户都知道它接收的对象是一些动物，用户有责任打印动物的声音。一种蛮力方法是检查接收到的对象以**识别**它的类型，然后将其类型**转换**为该 Animal 类型，然后对其**调用**makeSound()。但更简洁的方法是将**事物抽象出来**。使用动物作为**多态引用**并在其上调用 makeSound()。在**运行时**，取决于真正的 Object 类型是什么，适当的函数将被调用。

更多细节[在这里](http://opensourceforgeeks.blogspot.com/2014/01/difference-between-data-encapsulation.html)。

![在此处输入图像描述](https://i.stack.imgur.com/UqTm4.jpg)

复杂的逻辑位于封装在触摸板中的电路板中，并提供了一个很好的界面（按钮）以将其抽象给用户。

PS：以上链接是我的个人博客。

* * *

## 回答 #8

> 赞同：33
> 
> 时间：2015-12-26T05:16:49.460

这些有些模糊的概念并不是计算机科学和编程所独有的。我想提供一些额外的想法，可以帮助其他人理解这些重要概念。

* * *

# 简答

**封装**- 隐藏和/或限制对系统某些部分的访问，同时公开必要的接口。

**抽象**- 除了具体现实、特定对象或实际实例之外，考虑去除某些特征的事物，从而降低复杂性。

主要的**相似之处**在于这些技术*旨在提高理解力和实用性。*

主要**区别**在于*抽象是一种更简单地表示事物的方法（通常是为了使表示更广泛适用），而封装是一种改变其他事物与事物交互方式的方法。*

* * *

# 长答案

### 封装

这是一个封装的例子，希望能让事情更清楚：

![Arduino封装](https://i.stack.imgur.com/lh8DF.jpg)

在这里，我们有一个[Arduino](https://en.wikipedia.org/wiki/Arduino) Uno 和一个外壳内的 Arduino Uno。外壳很好地代表了封装的全部含义。

封装旨在保护某些组件免受外部影响和知识，以及暴露其他事物应该与之交互的组件。在编程术语中，这涉及通过[**访问修饰符**](https://en.wikipedia.org/wiki/Access_modifiers)[**隐藏信息**](https://en.wikipedia.org/wiki/Information_hiding)，这会改变某些变量和/或属性可以读取和写入的程度。[](https://en.wikipedia.org/wiki/Access_modifiers)

 **但除此之外，封装还旨在更有效地提供这些外部接口。在我们的 Arduino 示例中，这可能包括漂亮的按钮和屏幕，使用户与设备的交互更加简单。它们为用户提供了简单的方法来影响设备的行为并获得有关其操作的有用信息，否则这些操作将变得更加困难。

在编程中，这涉及将各种组件组合成一个可分离的结构，例如 a `function`、`class`或`object`。它还包括提供与这些构造交互的方法，以及获取有关它们的有用信息的方法。

封装以许多其他方式帮助程序员，其中最重要的是提高了代码的可维护性和可测试性。

### 抽象

尽管这里的许多其他答案将抽象定义为泛化，但我个人认为该定义是错误的。我会说泛化实际上是一种特定*类型的*抽象，而不是相反。换句话说，所有的概括都是抽象，但所有的抽象不一定都是*概括*。

以下是我对抽象的看法：

![像素树](https://orig03.deviantart.net/cc19/f/2015/073/5/c/yet_another_pixel_art_tree_sketching_by_picotootoo-d8lqlgc.png)

你会说那里的图像有一棵树吗？你很有可能会。但它*真的*是一棵树吗？好吧，当然不是！它是一堆像素，看起来像我们可以称之为树的东西。我们可以说它代表了真实树的抽象。请注意，树的几个视觉细节被省略了。此外，它不会生长、消耗水或产生氧气。怎么可能？它只是屏幕上的一堆颜色，由计算机内存中的字节表示。

这就是抽象的本质。这是一种简化事物的方法，因此它们更容易理解。你脑海中闪过的每一个想法都是对现实的抽象。您对一棵树的心目中的图像不再是一棵实际的树，而不是这个 jpeg。

`Tree`在编程中，我们可以通过创建一个具有模拟生长、耗水和氧气生产方法的类来利用这一优势。我们的创作将代表我们对实际树木的体验，并且只包括我们真正关心的特定模拟的那些元素。我们使用抽象来表示我们对字节和数学的体验。

### 抽象类

编程中的抽象还允许我们考虑几个“具体”对象类型（实际存在的类型）之间的共性，并在唯一实体中定义这些共性。例如，我们的`Tree`类可能继承自`abstract class Plant`，它具有适用于我们所有类植物类的几个属性和方法，但*删除*了每种植物特有的属性和方法。这可以显着减少代码重复，并提高可维护性。

`abstract class`an和 plain的实际区别`class`在于，从概念上讲，没有“真实”的`abstract class`. 构造一个`Plant`对象是没有意义的，因为这不够具体。每个“真实”`Plant`也是一种更具体的`Plant`.

此外，如果我们希望我们的程序更真实，我们可能需要考虑我们的`Tree`类本身可能过于抽象的事实。实际上，every`Tree`是 的一种更具体的类型，因此我们可以为那些继承自我们（也许是现在）类的类型（例如 , 等）`Tree`创建`Birch`类。`Maple``abstract``Tree`

### 虚拟机

另一个很好的抽象示例是[**Java 虚拟机 (JVM)**](https://en.wikipedia.org/wiki/Java_virtual_machine)，它为 Java 代码运行提供了一个虚拟或抽象计算机。它实质上去掉了系统的所有平台特定组件，并提供了一个抽象的“计算机”接口，而不考虑任何具体的系统。

### 区别

封装与抽象的不同之处在于它与某事物的“真实”或“准确”程度没有任何关系。它不会*删除*某些东西的组件以使其更简单或更广泛适用。相反，它可能会*隐藏*某些组件以实现类似的目的。

* * *

## 回答 #9

> 赞同：29
> 
> 时间：2009-04-12T20:22:35.980

*   抽象让您专注于对象的作用而不是它的作用
*   封装意味着隐藏对象如何做某事的内部细节或机制。

就像你开车一样，你知道油门踏板的作用，但你可能不知道它背后的过程，因为它是封装的。

让我举一个 C# 中的例子。假设你有一个整数：

```
int Number = 5;
string aStrNumber = Number.ToString(); 
```

您可以使用 Number.ToString() 之类的方法，它返回数字 5 的字符表示，并将其存储在字符串对象中。该方法告诉你它做了什么，而不是它是如何做的。

* * *

## 回答 #10

> 赞同：22
> 
> 时间：2009-04-13T11:16:51.663

**封装**：向对象的实际用户隐藏不需要的/意外的/适当的实现细节。例如

```
List<string> list = new List<string>();
list.Sort(); /* Here, which sorting algorithm is used and hows its 
implemented is not useful to the user who wants to perform sort, that's 
why its hidden from the user of list. */ 
```

**抽象**：是一种提供泛化的方式，因此是处理大量多样性对象的常用方式。例如

```
class Aeroplane : IFlyable, IFuelable, IMachine
{ // Aeroplane's Design says:
  // Aeroplane is a flying object
  // Aeroplane can be fueled
  // Aeroplane is a Machine
}
// But the code related to Pilot, or Driver of Aeroplane is not bothered 
// about Machine or Fuel. Hence,
// pilot code:
IFlyable flyingObj = new Aeroplane();
flyingObj.Fly();
// fighter Pilot related code
IFlyable flyingObj2 = new FighterAeroplane();
flyingObj2.Fly();
// UFO related code 
IFlyable ufoObj = new UFO();
ufoObj.Fly();
// **All the 3 Above codes are genaralized using IFlyable,
// Interface Abstraction**
// Fly related code knows how to fly, irrespective of the type of 
// flying object they are.

// Similarly, Fuel related code:
// Fueling an Aeroplane
IFuelable fuelableObj = new Aeroplane();
fuelableObj.FillFuel();
// Fueling a Car
IFuelable fuelableObj2 = new Car(); // class Car : IFuelable { }
fuelableObj2.FillFuel();

// ** Fueling code does not need know what kind of vehicle it is, so far 
// as it can Fill Fuel** 
```

* * *

## 回答 #11

> 赞同：14
> 
> 时间：2014-08-30T00:07:41.277

抽象和封装之间的区别。

![抽象与封装的区别](https://i.stack.imgur.com/0SKxv.png)

* * *

## 回答 #12

> 赞同：12
> 
> 时间：2009-12-18T10:58:07.267

**抽象：**以简化/不同的方式呈现事物的想法，这要么更容易理解和使用，要么更适合情况。

考虑一个发送电子邮件的类...它使用抽象来向您展示自己是某种信使男孩，因此您可以调用 emailSender.send(mail, recipient)。它实际上做了什么——选择 POP3 / SMTP、调用服务器、MIME 翻译等，都被抽象掉了。你只看到你的信使男孩。

**封装：**保护和隐藏对象私有的数据和方法的想法。它更多地涉及使某些东西独立且万无一失。

以我为例。我封装了来自世界其他地方的心率。因为我不希望任何其他人更改该变量，并且我不需要其他任何人设置它以便我运行。它对我来说至关重要，但你不需要知道它是什么，而且你可能也不在乎。

环顾四周，你会发现几乎所有你接触的东西都是抽象和封装的例子。例如，您的手机向您展示了一种抽象概念，即能够将您所说的内容传达给其他人——涵盖 GSM、处理器架构、无线电频率以及一百万个您不了解或不关心的其他事物。它还封装了您的某些数据，例如序列号、ID 号、频率等。

这一切都让世界成为一个更宜居的地方：D

* * *

## 回答 #13

> 赞同：10
> 
> 时间：2011-02-11T11:12:50.080

**抽象：**只显示必要的信息。让我们专注于打开计算机的示例。用户不必知道系统仍在加载时发生了什么（该信息对用户隐藏）。

让我们再举一个例子，ATM。客户不需要知道机器如何读取 PIN 码并处理交易，他只需输入 PIN 码，拿走现金，然后离开。

**封装：**处理隐藏类的敏感数据，从而将其中的一部分私有化。这是一种通过不允许从外部访问某些信息来对其客户保密的方法。

* * *

## 回答 #14

> 赞同：8
> 
> 时间：2009-04-13T10:27:51.970

另一个例子：

假设我创建了一个不可变的 Rectangle 类，如下所示：

```
class Rectangle {
 public:
  Rectangle(int width, int height) : width_(width), height_(height) {}
  int width() const { return width_; }
  int height() const { return height_; }

 private:
  int width_;
  int height_;
} 
```

现在很明显我已经**封装了**宽度和高度（访问受到某种限制），但我没有**抽象**任何东西（好吧，也许我忽略了矩形在坐标空间中的位置，但这是一个缺陷例子）。

**好的抽象通常意味着好的封装。**

一个好的抽象的例子是一个通用的数据库连接类。它的公共接口与数据库无关，非常简单，但允许我对连接做我想做的事。你看到了吗？那里也有封装，因为该类必须包含所有低级句柄和调用。

* * *

## 回答 #15

> 赞同：8
> 
> 时间：2013-08-26T10:50:16.320

## ***`Abstraction`***并***`Encapsulation`***通过使用单个通用示例

**-------------------------------------------------- -------------------------------------------------- --------------------------------**

***我们都使用计算器来计算复杂的问题！***

![图片](https://i.stack.imgur.com/4Mcwq.png)

* * *

## 回答 #16

> 赞同：8
> 
> 时间：2015-06-08T09:25:39.257

**抽象：**抽象意味着展示`What`部分功能。

**封装：**封装意味着隐藏`How`部分功能。

让我们举一个非常简单的例子

```
/// <summary>
/// We have an Employee class having two properties EmployeeName and EmployeeCode
/// </summary>
public class Employee
{
    public string EmplpyeeName { get; set; }
    public string EmployeeCode { get; set; }

    // Add new employee to DB is the main functionality, so are making it public so that we can expose it to external environment
    // This is ABSTRACTION
    public void AddEmployee(Employee obj)
    {
        // "Creation of DB connection" and "To check if employee exists" are internal details which we have hide from external environment
        // You can see that these methods are private, external environment just need "What" part only
        CreateDBConnection();
        CheckIfEmployeeExists();
    }

    // ENCAPLUSATION using private keyword
    private bool CheckIfEmployeeExists()
    {
        // Here we can validate if the employee already exists
        return true;
    }

    // ENCAPLUSATION using private keyword
    private void CreateDBConnection()
    {
        // Create DB connection code
    }
} 
```

控制台应用程序类

```
class Program
{
    static void Main(string[] args)
    {
        Employee obj = new Employee();
        obj.EmplpyeeName = "001";
        obj.EmployeeCode = "Raj";

        // We have exposed only what part of the functionality
        obj.AddEmployee(obj);
    }
} 
```

* * *

## 回答 #17

> 赞同：7
> 
> 时间：2011-10-17T15:39:07.257

防止特定对象的数据被外部函数故意或意外滥用的机制称为“**数据封装”**

表示基本特征而不包括背景细节或解释的行为称为**抽象**

* * *

## 回答 #18

> 赞同：6
> 
> 时间：2011-11-03T16:33:50.477

让我们以堆栈为例。它可以使用数组或链表来实现。但它支持的操作是push和pop。

现在**抽象**只暴露接口 push 和 pop。底层表示是隐藏的（它是一个数组还是一个链表？）并且提供了一个定义良好的接口。现在，您如何确保不会意外访问抽象数据？这就是**封装**的用武之地。例如，C++ 中的类使用访问说明符来确保防止意外访问和修改。而且，通过将上述接口设为公共，可以确保操作堆栈的唯一方法是通过定义明确的接口。在这个过程中，它已经耦合了数据和可以操作它的代码（我们这里不涉及友元函数）。也就是说，代码和数据被绑定在一起或捆绑或封装。

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2014-11-18T19:45:07.283

我将尝试以简单的方式演示封装..让我们看看..

*   将数据和函数封装成一个单元（称为类）称为封装。包含和隐藏对象信息的封装，例如内部数据结构和代码。

封装是 -

*   隐藏复杂性，
*   将数据和函数绑定在一起，
*   使复杂的方法私有化，
*   使实例变量私有，
*   向最终用户隐藏不必要的数据和功能。

封装实现了抽象。

抽象是-

*   显示什么是必要的，
*   数据需要从最终用户中抽象出来，

让我们看一个例子-

下图显示了“要添加到数据库中的客户详细信息”的 GUI。

![客户屏幕 GUI](https://i.stack.imgur.com/9iHuE.jpg)

通过查看图像，我们可以说我们需要一个客户类。

步骤 - 1：我的客户类别需要什么？

IE

*   2 个变量来存储客户代码和客户名称。
*   1 将客户代码和客户名称添加到数据库中的功能。

    命名空间客户内容{公共类客户{公共字符串客户代码=“”；公共字符串 CustomerName = ""; public void ADD() { //我的数据库代码将放在这里 }

现在只有 ADD 方法不能单独在这里工作。

步骤-2：验证将如何工作，添加功能起作用？

我们将需要数据库连接代码和验证代码（额外方法）。

```
public bool Validate()
{
    //Granular Customer Code and Name
    return true;
}

public bool CreateDBObject()
{
    //DB Connection Code
    return true;
}

class Program
{
static void main(String[] args)
{
CustomerComponent.Customer obj = new CustomerComponent.Customer;

obj.CustomerCode = "s001";
obj.CustomerName = "Mac";

obj.Validate();
obj.CreateDBObject();

obj.ADD();
}
} 
```

现在不需要向最终用户显示额外方法（Validate(); CreateDBObject() [复杂和额外方法]）。最终用户只需要查看并了解将添加的客户代码、客户名称和添加按钮记录..最终用户不关心它将如何将数据添加到数据库？

步骤-3：将不涉及最终用户交互的额外复杂方法私有化。

因此，将那些 Complicated 和 Extra 方法设为 Private 而不是 Public（即隐藏这些方法）并删除 obj.Validate(); obj.CreateDBObject(); 从主类程序中，我们实现了封装。

换句话说，简化最终用户的接口就是封装。

所以现在代码如下所示 -

```
namespace CustomerContent
{
public class Customer
{
public string CustomerCode = "";
public string CustomerName = "";
public void ADD()
{
   //my DB code will go here
}

private bool Validate()
{
    //Granular Customer Code and Name
    return true;
}

private bool CreateDBObject()
{
    //DB Connection Code
    return true;
}

class Program
{
static void main(String[] args)
{
CustomerComponent.Customer obj = new CustomerComponent.Customer;

obj.CustomerCode = "s001";

obj.CustomerName = "Mac";

obj.ADD();
}
} 
```

概括 ：

步骤-1：我的客户类需要什么？是抽象。

Step -3: Step -3: Private 不涉及最终用户交互的额外复杂方法是​​封装。

PS - 上面的代码既难又快。

* * *

## 回答 #20

> 赞同：5
> 
> 时间：2011-06-01T06:39:21.920

封装将复杂性封装在一个封装中，即类，因此封装......而抽象是一个对象区别于其他对象的特征......

抽象可以通过使具有一个或多个方法抽象的类抽象来实现。这只不过是扩展它的类应该实现的特性。例如，当您发明/设计汽车时，您定义了一个特征，例如汽车应该有 4 个门、刹车、方向盘等……所以任何使用这种设计的人都应该包含这个特征。实现不是每个抽象的头。它只会定义应该包含的特征。

封装是通过使用访问修饰符（如公共、私有、受保护以及继承、聚合或组合）将数据和行为保存在一个类封装中实现的。所以你只显示必需的东西，也只显示你想要显示的程度。ie public, protected, friendly & private ka funda…… 比如GM决定使用上面汽车的抽象设计。但他们有各种产品，具有相同的特性和几乎相同的功能。所以他们编写了一个扩展上述抽象类的类。它说明了变速箱应该如何工作，刹车应该如何工作，方向盘应该如何工作。那么所有的产品都只是使用这个通用的功能。他们不需要知道齿轮箱是如何工作的、刹车是如何工作的或转向轮是如何工作的。

两者都很强大；但是使用抽象需要比封装更多的技能，并且更大的应用程序/产品在没有抽象的情况下无法生存。

* * *

## 回答 #21

> 赞同：5
> 
> 时间：2015-07-13T05:13:46.277

抽象---隐藏实现---在设计中---使用接口/抽象类

封装——隐藏数据——在开发中——使用访问修饰符（公共/私有）

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2014-02-01T19:20:01.340

从此[_](http://theprofessionalspoint.blogspot.in/2013/05/difference-between-encapsulation-and.html)

**OOPS 中封装与抽象的区别**

抽象和封装是两个重要的面向对象编程 (OOPS) 概念。封装和抽象都是相互关联的术语。

**封装与抽象之间的现实差异**

封装意味着隐藏。封装也称为数据隐藏。您可以将封装视为将药物隐藏在其中的胶囊（药片）。封装就是包装，只是隐藏属性和方法。封装用于将代码和数据隐藏在一个单元中，以保护数据不受外界影响。类是封装的最好例子。

抽象是指仅向预期用户显示必要的细节。顾名思义，抽象是“任何事物的抽象形式”。我们在编程语言中使用抽象来制作抽象类。抽象类表示类的方法和属性的抽象视图。

**封装与抽象的实现区别**

1.  抽象是使用接口和抽象类实现的，而封装是使用私有和受保护的访问修饰符实现的。

2.  OOPS 通过防止程序员以非预期的方式访问数据，利用封装来强制类型的完整性（即确保以适当的方式使用数据）。通过封装，只有预定的一组函数才能访问数据。与访问限制（公共/私有等）捆绑在一起的数据类型和操作（方法）的统称是一个类。

* * *

## 回答 #23

> 赞同：4
> 
> 时间：2016-12-10T10:48:05.863

下面的段落帮助我理解了它们之间的区别：

> 数据封装是一种捆绑数据的机制，使用它们的功能和数据抽象是一种只暴露接口而对用户隐藏实现细节的机制。

[你可以在这里](https://www.tutorialspoint.com/cplusplus/cpp_data_encapsulation.htm)阅读更多。

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2013-08-26T16:58:20.607

抽象或封装并不严格要求信息隐藏。信息可能会被忽略，但不必隐藏。

**封装** *是将某物视为单一事物的能力，即使它可能由许多复杂的部分或想法组成。*例如，我可以说我坐在“椅子”上，而不是指那把椅子的许多不同部分，每个部分都有特定的设计和功能，所有部分都精确地组合在一起，目的是为了让我的臀部舒适地保持几英尺远离地板。

**抽象**是通过封装实现的。因为我们封装了对象，所以我们可以将它们视为以某种方式相互关联的事物，而不是陷入内部对象结构的微妙细节中。*抽象是考虑大局的能力，而不是对小细节的关注。*这个词的词根是抽象的，就像出现在学术论文顶部的摘要中一样，而不是抽象的，因为只能实例化为派生子类。

老实说，当我把屁股倒在椅子上时，我从没想过那把椅子的结构会如何承受和支撑我的体重。这是一把足够体面的椅子，我不必担心这些细节。所以我可以把注意力转向我的电脑。再说一次，我不考虑我电脑的组成部分。我只是在查看代表我可以输入的文本区域的网页的一部分，我正在用文字进行交流，甚至几乎没有想到我的手指如何总是在键盘上如此快速地找到正确的字母，以及如何最终在点击这些键和发布到这个论坛之间建立了联系。这就是抽象的强大力量。因为可以信任系统的较低级别以一致和精确的方式工作，所以我们要注意备用以完成更大的工作。

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2011-04-06T10:57:44.993

```
class Aeroplane : IFlyable, IFuelable, IMachine
{ // Aeroplane's Design says:
  // Aeroplane is a flying object
  // Aeroplane can be fueled
  // Aeroplane is a Machine
}
// But the code related to Pilot, or Driver of Aeroplane is not bothered 
// about Machine or Fuel. Hence,
// pilot code:
IFlyable flyingObj = new Aeroplane();
flyingObj.Fly();
// fighter Pilot related code
IFlyable flyingObj2 = new FighterAeroplane();
flyingObj2.Fly();
// UFO related code 
IFlyable ufoObj = new UFO();
ufoObj.Fly();
// **All the 3 Above codes are genaralized using IFlyable,
// Interface Abstraction**
// Fly related code knows how to fly, irrespective of the type of 
// flying object they are.

// Similarly, Fuel related code:
// Fueling an Aeroplane
IFuelable fuelableObj = new Aeroplane();
fuelableObj.FillFuel();
// Fueling a Car
IFuelable fuelableObj2 = new Car(); // class Car : IFuelable { }
fuelableObj2.FillFuel();

// ** Fueling code does not need know what kind of vehicle it is, so far 
// as it can Fill Fuel** 
```

* * *

## 回答 #26

> 赞同：2
> 
> 时间：2013-12-08T06:15:34.550

抽象和封装的过程**都产生接口。**

通过封装生成的接口隐藏了实现细节。

与抽象之前相比，通过抽象生成的接口适用于更多的数据类型。

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2011-07-06T11:55:13.103

抽象是对用户隐藏无用的数据，而封装是将数据绑定到一个胶囊（一个类）中。我认为封装是我们实现抽象的方式。

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2017-04-20T16:03:07.747

`Abstraction`是我们将要执行的**合同。**实施可能会随着时间的推移而改变。各种实现本身可能隐藏也可能不隐藏，但隐藏在*抽象*后面。

假设我们在一个类中定义了所有的类`APIs`，`interface`然后要求我们代码的用户依赖于. 我们可以自由地改进或修改实现，只有我们必须遵循设定的合同。用户与我们的实施没有*耦合。*`APIs``interface`

 ***我们在抽象中公开所有必要的规则（方法），**规则的实现留给实现者实体，实现也不是抽象的一部分。它只是抽象的*签名*和*声明。*

`Encapsulation`只是通过减少状态和行为的访问来*隐藏内部细节。*一个封装的类可能有也可能没有很好的定义`Abstraction`。

`java.util.List`是 的抽象`java.util.ArrayList`。`java.util.ArrayList`使用访问修饰符标记的内部状态`non public`是封装。

**编辑** 假设一个类`Container.nava implements IContainer`，`IContainer`可以声明像、、、等等这样的方法`addElement`。`removeElements`这里`contains`表示`IContainer`它的实现类的抽象。抽象是向外部世界声明类或模块或系统的 API。这些 API 成为`contract`. 该系统可能已经开发，也可能尚未开发。系统的用户现在可以依赖声明的 API，并确保任何实现此类合约的系统将始终遵守声明的 API，他们将始终为这些 API 提供 tge 实现。一旦我们编写了一些具体的实体，然后决定隐藏我们的内部状态就是封装

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2013-06-23T02:50:37.483

我认为封装是一种实现抽象的方法。看看下面的链接。

[抽象与封装](http://lavraham.com/tutorials/java/abstraction)

* * *

## 回答 #30

> 赞同：1
> 
> 时间：2015-06-07T07:26:42.647

简而言之

**抽象使用 -> 封装** & **封装使用 -> 数据隐藏**

或者

**数据隐藏是封装**的子集， **封装是抽象的子集**

参考：[http ://www.tonymarston.co.uk/php-mysql/abstraction.txt](http://www.tonymarston.co.uk/php-mysql/abstraction.txt)

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2018-08-04T12:20:19.797

抽象和封装都以数据隐藏着称。但是有很大的不同。

**封装**

封装是将数据和对数据进行操作的代码绑定或包装到称为类的单个单元中的过程。

封装解决了实现层面的问题。

在课堂上，您可以使用私有或受保护的访问修饰符来隐藏数据。

**抽象**

抽象是隐藏无关细节的概念。换句话说，通过向用户隐藏不必要的细节来简化复杂的系统。

抽象在设计层面解决了问题。

您可以通过在 Java 中创建接口和抽象类来实现抽象。

在 ruby​​ 中，您可以通过创建模块来实现抽象。

例如：我们在 ruby​​ 中使用带有 Array 和 Hash 的 Enumerable 模块的 (collect, map, reduce, sort...) 方法。

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2017-04-23T10:11:14.170

让我用简单的代码示例试试这个

**抽象 = 数据隐藏 + 封装**

```
 // Abstraction
    interface IOperation
    {
        int GetSumOfNumbers();
    }
    internal class OperationEven : IOperation
    {
        // data hiding
        private IEnumerable<int> numbers;

        public OperationEven(IEnumerable<int> numbers)
        {
            this.numbers = numbers;
        }
        // Encapsulation
        public int GetSumOfNumbers()
        {
            return this.numbers.Where(i => i % 2 == 0).Sum();
        }
    } 
```

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2017-04-18T07:21:13.243

我试图在抽象和封装之间划清界限，据我说，抽象更多是概念性的东西，而封装是抽象实现之一。由于可以在不封装的情况下隐藏数据，例如使用私有常量或变量；所以我们可以对数据隐藏进行**封装，但数据隐藏并不总是封装**。在下面的代码中，我尝试描述这些概念的最简单形式。

```
 // Abstraction
    interface IOperation
    {
        int SquareNumber();
    }

    public class Operation
    {
        // Data hiding
        private int number;

        public Operation(int _number)
        {
            this.number = _number;
        }

        // Encapsulation
        public int SquareNumber()
        {
            return number * number;
        }
    } 
```

在行动中，

```
IOperation obj = new Operation(2); 
// obj.number  <--- can't access because hidden from world using private access modifier but not encapsulated. 
obj.SquareNumber(); // cannot access internal logic to calculate square because logic is hidden using encapsulation. 
```

* * *

## 回答 #34

> 赞同：1
> 
> 时间：2021-10-18T18:51:07.097

我读得越多，我就越困惑。所以，这就是我所理解的：

**封装：**

我们通常从外面看到一块手表，它的组件被封装在它的体内。我们对不同的操作有某种控制。这种隐藏细节和暴露控制（例如设置时间）的方式就是封装。

**抽象：**

到目前为止，我们谈论的是手表。但我们没有具体说明是哪种手表。它可以是数字的或模拟的，用于手或墙壁。有很多可能性。我们所知道的是，它是一块手表，它告诉时间，这是我们唯一感兴趣的东西，时间。这种隐藏细节和暴露通用特性或用例的方式是抽象的。

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2018-10-22T16:29:10.460

**抽象**

抽象是提取所有现有和可预见的实现的公共属性和字段的过程。

例如： *Car*是 Sedan、Hatchback、SUV、Coupe、Convertible 的抽象。 *Car*将具有所有类型的汽车共有的所有属性和字段。

**封装**

封装是向用户隐藏不需要的细节的过程。这个术语来自胶囊。就像药物对用户隐藏在胶囊内一样。各种机器和设备的详细信息，从搅拌机、自行车、洗衣机、收音机、电视到飞机。您不希望用户可以看到机器的所有详细信息。

在编程方面：让我们考虑一个类 Car。在下面的例子中，用户只需要知道转动钥匙（turnKey() 方法），他不知道内部功能。用户无需了解任何内部功能或内部组件。

在这种情况下，所有私有方法都是内部函数，而像“活塞 p1”这样的私有字段是用户不需要知道的内部数据。

```
public class Car{

    private void startMotor(){ //do something }
    private void generateVoltage(){ //do something }
    private void sparkPlugIgnition(){ //do something }
    private void fuelFlowFromTankToInjector(){ //do something }
    private void pushPistonsDown() { 
               p1.doAction();
               p2.doAction();
               //do something    }
    private void moveCrankShaft(){ //do something }

    private Piston p1;
    private Piston p2;

    public void turnKey(){
        startMotor();
        generateVoltage();
        sparkPlugIgnition();
        fuelFlowFromTankToInjector();
        pushPistonsDown();
        moveCrankShat();
        ...
    }
} 
```

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2018-10-18T20:25:40.577

简而言之：

**抽象**是一种技术，可以帮助我们识别哪些特定信息是必不可少的，哪些信息应该隐藏。

**封装**是一种以隐藏对象的细节和实现细节的方式封装信息的技术。

* * *

## 回答 #37

> 赞同：-1
> 
> 时间：2009-04-13T11:53:00.393

封装需要模块化。它要求您创建具有数据的对象和处理数据的方法。在这种情况下，您可以将其视为一个模块。

抽象为您提供了类的通用视图。

* * *

## 回答 #38

> 赞同：-1
> 
> 时间：2015-04-23T10:51:12.893

之间有区别

> 抽象

和

> 封装

```
1\.    First difference between Abstraction and Encapsulation is that, Abstraction is implemented in Java using interface and abstract class while Encapsulation is implemented using private, package-private and protected access modifier.

2\.    Data abstraction simply means generalizing something to hide the complex logic that goes underneath where Encapsulation is DATA HIDING.

3\.    Encapsulation is combining related logic data (variables and methods) where as Abstraction is hiding internal implementation details and expose only relevant details to the user. In a way you can Abstraction is achieved by Encapsulation. 
```

![在此处输入图像描述](https://i.stack.imgur.com/dtWiL.png)

* * *

## 回答 #39

> 赞同：-1
> 
> 时间：2015-11-27T09:12:47.167

封装是抽象的一个例子。封装的重点是抽象函数内部发生的事情，将所有复杂性降低为符号（函数的引用或名称），将函数变成黑盒子。

在编程中，“抽象”这个词是一个命令。当一个类继承一个抽象类（或接口）时，您被要求创建一个抽象。

* * *

## 回答 #40

> 赞同：-1
> 
> 时间：2016-04-12T18:48:38.627

一件事，也许是其他答案忘记提及的基本事情是，**封装是抽象**。因此，将两者进行对比并寻找差异并不准确，而是将**封装视为一种抽象形式**。

# c++ - 简单的 OpenGL 纹理贴图不起作用？

> ID：742342
> 
> 赞同：8
> 
> 时间：2009-04-12T20:15:53.187
> 
> 标签：c++, opengl, textures

我正在尝试找出 OpenGL 中的纹理映射，但我找不到一个简单的例子来工作。

正在绘制多边形，虽然它没有纹理，而只是纯色。此外，位图也被正确加载到 sprite1[] 中，因为到目前为止我一直在成功使用 glDrawPixels。

我使用 glGenTextures 来获取我的 tex 名称，但我注意到它并没有改变 texName1; 这个 GLuint 是我初始化它的任何东西，即使在调用 glGenTextures 之后......

我已启用 GL_TEXTURE_2D。

继承人的代码：

```
GLuint texName1 = 0;

glGenTextures(1, &texName1);
glBindTexture(GL_TEXTURE_2D, texName1);
glPixelStorei(GL_UNPACK_ALIGNMENT, 1);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_REPEAT);
glTexParameteri (GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_REPEAT);
glTexParameteri (GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);
glTexParameteri (GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);
glTexEnvf(GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_MODULATE);
glTexImage2D(GL_TEXTURE_2D, 0, GL_BGRA_EXT, sprite1[18], sprite1[22], 0, GL_BGRA_EXT, GL_UNSIGNED_BYTE, &sprite1[54]);

glColor3f(1, 1, 0);
glBindTexture(GL_TEXTURE_2D, texName1);
glBegin(GL_QUADS);
    glTexCoord2f (0.0, 0.0);
    glVertex3f (0.0, 0.0, -5.0f);
    glTexCoord2f (1.0, 0.0);
    glVertex3f (.5, 0.0, -5.0f);
    glTexCoord2f (1.0, 1.0);
    glVertex3f (.5, .5, -5.0f);
    glTexCoord2f (0.0, 1.0);
    glVertex3f (0.0, .5, -5.0f);
glEnd(); 
```

更新：我不知所措。这是我尝试过的所有内容：

1.  原来我是在初始化 OGL 之前初始化我的纹理。纹理在类构造函数中初始化（glGenTextures->glTexImage2D）并在每帧调用的成员函数中绘制（glBegin->glEnd）。genTextures 现在似乎工作正常，我的名字是 1。

2.  GL_RGBA8、GL_BGRA_EXT 的所有可能组合（GL_BGRA 在我的系统上不起作用；我需要 _EXT），我什至从位图中删除了 alpha 通道并尝试了 GL_RGB、GL_BGR_EXT 等的所有组合。没有运气。

3.  尝试以程序方式创建位图并使用它

4.  确保 GL_COLOR_MATERIAL 未启用。

5.  将位图大小更改为 32x32。

6.  尝试了 glTexEnvi 而不是 glTexEnvf。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-17T07:27:36.390

除了[mentat 指出](https://stackoverflow.com/questions/742342/simple-opengl-texture-map-not-working/759322#759322)您可能对非二次幂纹理尺寸有问题之外，您还提到纹理名称生成不会更改名称。

这听起来好像您调用`[glGenTextures](http://www.opengl.org/documentation/specs/man_pages/hardcopy/GL/html/gl/gentextures.html)()`得太早了，即在初始化 OpenGL 之前。如果你不是，那么我建议在调用`glGenTextures()`检查 OpenGL 错误状态之后添加代码，方法是调用`[glGetError()](http://www.opengl.org/documentation/specs/man_pages/hardcopy/GL/html/gl/geterror.html)`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-17T07:08:20.260

在您的评论中，您说您的位图是 29x20 像素。Afaik 要生成有效的纹理，OpenGL 要求图像大小（在每个维度上）是 2 的幂。它不需要是正方形，但它可以是矩形。您可以通过使用[GL_ARB_texture_rectangle](http://www.opengl.org/registry/specs/ARB/texture_rectangle.txt)等一些 OpenGL 扩展来克服这个问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-06-28T07:37:26.303

我将把它放在这里，因为我遇到了同样的问题，并找到了另一篇解释该问题的帖子。iPhone 确实支持 GL_BGRA(GL_EXT_BGRA) 但似乎只是作为输入格式而不是作为内部格式。因此，如果您将 glTexImage2D 调用更改为具有 GL_RGBA 的内部格式，那么它就可以工作。

```
glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA, width, height, 0, GL_BGRA, GL_UNSIGNED_BYTE, &sprite1[54]); 
```

我希望这可以帮助其他偶然发现这篇文章的人。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T13:46:14.433

一些随机的想法：

*   GL_COLOR_MATERIAL 可能已启用
*   将“glTexEnvf”更改为“glTexEnvi”，看看是否有帮助
*   如果在 glGenTextures 之后 texName1 为 0，您可能没有活动的 OpenGL 上下文

对于错误检查，我建议编写一个小函数，打印来自 glGetErrors 的最常见结果的可读输出，并使用它来查找产生错误的行。另一种可能性是使用[GLIntercept](http://glintercept.nutty.org/)、[BuGLe](http://www.opengl.org/sdk/tools/BuGLe/)或[gDEBugger](http://www.gremedy.com/)之类的东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-14T14:00:44.243

我的 OpenGL 生锈了，但我记得与`glTexImage2D` . 最后我设法让它工作，但我总是有更多的运气， `gluBuild2DMipmaps` 所以我最终得到了

```
gluBuild2DMipmaps (
  GL_TEXTURE_2D, type, i.width, i.height, type, GL_UNSIGNED_BYTE, i.data
); 
```

取代

```
glTexImage2D (
  GL_TEXTURE_2D, 0, type, i.width, i.height, 0, type, GL_UNSIGNED_BYTE, i.data 
); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-18T22:09:43.640

我发现了问题。我的电话`glEnable`是`glEnable(GL_BLEND | GL_TEXTURE_2D)`。使用 glGetError 我看到我得到了这个调用的 GL_INVALID_ENUM，所以我将 GL_TEXTURE_2D 移动到它自己的启用函数和宾果游戏中。我猜glEnable不允许逻辑OR？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-14T13:52:13.157

我要检查的第一件事是颜色材料设置，如 ShadowIce 所述，然后检查您的纹理文件以确保其大小合理（例如 256x256）和 RGB 位图。如果文件有轻微的问题，无论您如何尝试，它都不会正确呈现。

然后，我将停止尝试仅调试该代码，而是查看您[与 NeHe 网站上的教程](http://nehe.gamedev.net/data/lessons/lesson.asp?lesson=06)有什么不同。

NeHe 始终是检查您是否尝试在 OpenGL 中做事的好地方。纹理可能是最难做到的事情，而且随着你其他 GL 技能的提高，它们只会变得更加困难。

# c# - LINQ to XML 和 ViewList

> ID：742348
> 
> 赞同：0
> 
> 时间：2009-04-12T20:21:41.630
> 
> 标签：c#, .net, xml, linq

我似乎遇到了问题，不知道如何使它工作。我正在尝试使用 linq 从 XML 获取数据并且代码有效，但是当我尝试将此 linq 数据用作 ListView 的 DataSource 时，出现错误。

我怎样才能使它工作？如何将我的 var 变量转换为正确的变量，以便带有 Pager 的 ListView 将接受它？

任何代码示例都将受到高度赞赏。

那是我得到的错误：

```
Exception Details: System.InvalidOperationException: ListView with id 'showTopics' must have a data source that either implements ICollection or can perform data source paging if AllowPaging is true.

Source Error:

Line 28:         showTopics.DataSource = archievePosts;
Line 29:         showTopics.DataBind(); 
```

和代码隐藏：

```
String xmlpath = Server.MapPath("App_Data/topics.xml");
var archievePosts = from a in XElement.Load(xmlpath).Elements("topic")
                    where (DateTime.Parse(a.Element("topicdate").Value) <= DateTime.Parse(hDate.Text))
                    select new
                    {
                        topic_id = a.Attribute("id").Value.ToString(),
                        topic_subject = a.Element("topicname").Value,
                        topic_date = a.Element("topicdate").Value
                    };
showTopics.DataSource = archievePosts;
showTopics.DataBind(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-12T20:59:12.850

您可以使用`ToArrayList()`或`ToList()`

但是您确定您正在获取数据还是有问题，请尝试调试并查看 ArchivePosts 的值。

希望这可以帮助。

# c# - 确定用作方法参数的变量的名称

> ID：742350
> 
> 赞同：2
> 
> 时间：2009-04-12T20:21:55.327
> 
> 标签：c#, reflection, parameters

在 C# 中，您将如何确定调用方法时使用的变量的名称？

例子：

```
public void MyTestMethod1()
{
  string myVar = "Hello World";
  MyTestMethod2(myVar);
}

public void MyMethod2(string parm)
{
  // do some reflection magic here that detects that this method was called using a variable called 'myVar'
} 
```

我知道参数可能并不总是一个变量，但我使用它的地方是在一些验证代码中，我希望开发人员可以明确说明他们正在验证的值的友好名称，如果他们不这样做' t 然后它只是从他们调用该方法的 var 的名称中推断出来......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-12T20:41:33.343

有一种方法，但它很丑陋。

```
public void MyTestMethod1()
{
  string myVar = "Hello World";
  MyTestMethod2(() => myVar);
}

public void MyMethod2(Expression<Func<string>> func)
{
  var localVariable = (func.Body as MemberExpression).Member.Name;
  // localVariable == "myVar"
} 
```

如您所见，您的所有调用都必须包装到 lambda 中，如果您开始在 lambda 中执行任何其他操作，除了返回单个变量，此方法就会失效。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-12T20:23:28.847

不幸的是，这将非常困难，如果不是不可能的话。

为什么你需要最初发送的变量的名称？

请记住，可能没有使用实际变量：

```
MyMethod2(myVar + "! 123"); 
```

在这种情况下，myVar 只保存部分值，其余部分在运行时在表达式中计算。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-12T20:33:15.300

变量是为实体分配语义的方便标识符。以您所描述的方式以编程方式将它们看起来像是一种很大的代码气味。此外，如果知道真的那么重要，你不能只传递第二个参数吗？

* * *

**编辑：** OP 更新了他的问题以包括这一行：

> 我知道参数可能并不总是一个变量，但我使用它的地方是在一些验证代码中，**我希望开发人员可以明确说明他们正在验证的值的友好名称**，如果他们不这样做' t 然后它只是从他们调用该方法的 var 的名称中推断出来......

如果他们明确声明并且这对您很重要，则绝对应该将其作为参数传递给函数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-16T09:09:57.497

在我看来，您应该使用 Enum 作为变量的标识符，而不是尝试确定变量的名称。变量的全部意义在于它只是一个人类可读的名称来表示一点内存。

你可以这样做：

```
public void MyTestMethod1()
{
  string myVar = "Hello World";
  MyTestMethod2(myVar, VariableType.MyVar);
}

public void MyMethod2(string parm, VariableType type)
{
  if (type == VariableType.MyVar)
  {
  }
} 
```

# c# - 逆变似乎会导致冲突的行为

> ID：742351
> 
> 赞同：1
> 
> 时间：2009-04-12T20:22:32.720
> 
> 标签：c#, .net

以下示例取自[C# in Depth: What you need to master C# 2 and 3](https://rads.stackoverflow.com/amzn/click/com/1933988363)，并且似乎只会导致 jskeet 确定的重大更改，但这是错误的。请解释：

```
delegate void SampleDelegate(string x);

 public void CandidateAction (string x)
 {
     Console.WriteLine("Snippet.CandidateAction")
 }

public class Derived: Snippet
{
   public void CandidateAction (object x)
   {
     Console.WriteLine("Derived.CandidateAction")
   }
}
....

Derived x = new Derived();
SampleDelegate factory = new SampleDelegate (x.CandidateAction);
factory ("test"); 
```

现在，为什么它应该完全作为 SampleDelegate 接受**string**而不是**object**。据我所知，对象不是从字符串派生的。情况恰恰相反。这就是 c# 2.0 下允许的逆变性。似乎表现出相反的效果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-12T20:44:53.023

从概念上讲，Derived.CandidateAction 的签名是说，“我可以处理你想扔给我的任何对象。” SampleDelegate 的合同是“你必须能够处理一个字符串”。现在，如果一个方法可以处理任何对象，它当然可以处理一个字符串。因此 Derived.CandidateAction 能够满足 SampleDelegate 的需求，因此可以分配给 SampleDelegate 变量。

[我在http://hestia.typepad.com/flatlander/2008/12/c-covariance-and-contravariance-by-example.html](http://hestia.typepad.com/flatlander/2008/12/c-covariance-and-contravariance-by-example.html)上对此进行了更详细的讨论（诚然，从 C# 4 的角度来看）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-12T20:45:05.083

逆变允许您使用具有参数的方法，这些参数是委托方法签名中参数的基本类型。

委托签名定义将传递给方法的类型。方法本身可以具有不太“特定”的类型。在您的示例中，当委托作为字符串被调用时。实际方法只需要一个对象是完全可以的，因为允许对象类型的变量保存字符串类型的实例。

这在事件处理场景中最有用，您可以编写这样的事件处理程序，几乎可以附加到任何事件（即使传递的 args 参数更具体，如 ItemCheckedEventArgs）：

```
public void GenericHandler(object source, EventArgs args) {
    //do something generic
} 
```

# c# - C#中'@'的所有用法是什么？

> ID：742354
> 
> 赞同：5
> 
> 时间：2009-04-12T20:24:21.887
> 
> 标签：c#, .net

我注意到这段代码：

```
 FileInfo[] files =new DirectoryInfo(@"C:\").GetFiles(); 
```

目的是`@`什么？还有其他用途吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-12T20:26:25.160

# 字符串文字

C# 支持两种形式的字符串文字：**常规字符串文字**和**逐字字符串文字**。

**常规字符串文字**由用双引号括起来的零个或多个字符组成，如 "hello"，并且可能包括简单的转义序列（如制表符的 \t）以及十六进制和 Unicode 转义序列。

**逐字字符串文字**由一个@ 字符后跟一个双引号字符、零个或多个字符以及一个结束双引号字符组成。一个简单的例子是@"hello"。在逐字字符串文字中，分隔符之间的字符被逐字解释，唯一的例外是引号转义序列。特别是，简单的转义序列以及十六进制和 Unicode 转义序列不会在逐字字符串文字中进行处理。逐字字符串文字可能跨越多行。

**示例 1：**

```
@"C:\Path\File.zip" == "C:\\Path\\File.zip"

// where

"C:\\Path\\File.zip" // regular string literal
@"C:\Path\File.zip"  // verbatim string literal 
```

**注意**：在逐字字符串文字中，您应该转义双引号。

**示例 2：**

```
@"He said: ""Hello""" == "He said: \"Hello\"" 
```

**更多信息在这里**：

*   MSDN 上的[字符串（C# 参考）](http://msdn.microsoft.com/en-us/library/362314fe.aspx)
*   MSDN 上的[字符串文字](http://msdn.microsoft.com/en-us/library/aa691090.aspx)
*   MSDN 上的[字符串基础知识（C# 编程指南）](http://msdn.microsoft.com/en-us/library/ms228362.aspx)
*   [在 C# 中处理字符串](http://www.techotopia.com/index.php/Working_with_Strings_in_C_Sharp)
*   [.NET 和 C# 中的字符串](http://www.yoda.arachsys.com/csharp/strings.html)

# 身份标识

前缀“@”允许使用关键字作为标识符，这在与其他编程语言交互时很有用。字符 @ 实际上不是标识符的一部分，因此标识符在其他语言中可能被视为普通标识符，没有前缀。带有@ 前缀的标识符称为逐字标识符。允许对不是关键字的标识符使用 @ 前缀，但出于风格问题强烈建议不要使用。

**例子：**

```
class @class
{
   public static void @static(bool @bool) {
      if (@bool)
         System.Console.WriteLine("true");
      else
         System.Console.WriteLine("false");
   }
}
class Class1
{
    static void M() {
        cl\u0061ss.st\u0061tic(true);
    }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-12T20:29:26.370

该`@`符号在 C# 中有几个含义：

*   **当在字符串的开头使用时，**它的意思是“按字面意思理解这个字符串；不要解释否则会被用作转义字符的字符。” 这称为**[逐字字符串文字](http://msdn.microsoft.com/en-us/library/aa691090.aspx)**。例如，`@"\n\t"`等于`"\\n\\t"`。

*   **在标识符的开头使用时，**表示“将其解释为标识符，而不是关键字”。例如，`int @this`将允许您命名一个整数变量“this”，这通常是非法的，因为`this`它是一个关键字。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-12T20:26:30.870

@ 符号基本上表示“完全按照原样获取此字符串”。它允许开发人员避免转义。

所以，@"C:\" == "C:\\" （使用 \ 转义）。

我发现它在 RegEx 中最有用......当您开始转义不同的东西等时，RegEx 会变得非常讨厌和混乱，所以只使用文字值很好。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-12T20:27:12.333

这是一个[逐字字符串文字](http://msdn.microsoft.com/en-us/library/aa691090.aspx)，因此您可以使用反斜杠而不会被解释为转义字符。

> 逐字字符串文字由一个`@`字符后跟一个双引号字符、零个或多个字符以及一个结束双引号字符组成。一个简单的例子是 `@"hello"`。在逐字字符串文字中，分隔符之间的字符被逐字解释，唯一的例外是 *quote-escape-sequence*。特别是，简单的转义序列以及十六进制和 Unicode 转义序列不会在逐字字符串文字中进行处理。逐字字符串文字可能跨越多行。

引用转义序列：`""`

因此，逐字字符串文字的唯一转义是`""`在`"`两个 "s 内转义。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-12T20:27:09.650

字符串前的 @ 符号允许对字符串进行字面解释，否则您必须使用另一个 ("C:\") 转义反斜杠。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-12T20:28:30.380

@ 表示该字符串是一个文字字符串，因此您不必在其中转义字符。正如[string 的文档](http://msdn.microsoft.com/en-us/library/362314fe.aspx)所说：

> 逐字字符串的优点是不处理转义序列，这使得编写起来很容易，例如完全限定的文件名：@"c:\Docs\Source\a.txt" 而不是`"c:\\Docs\\Source\\a.txt"`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-12T20:29:19.067

在字符串之前放置 @ 会将其从常规文字字符串变为逐字文字字符串，该字符串不使用正斜杠转义 () 而是使用连续两个引号来转义引号。

[Jon Skeet 在 C#/.NET 中写了更多关于字符串的文章。](http://www.yoda.arachsys.com/csharp/strings.html)

# sml - 如何在 SML 中的 case 语句中打印？

> ID：742363
> 
> 赞同：12
> 
> 时间：2009-04-12T20:28:54.607
> 
> 标签：sml, smlnj

我刚开始使用 SML，我正在尝试修改一些代码，以便了解它在做什么（我找不到像样的 SML/NJ 调试器，但这是一个单独的问题）。

```
fun type_check e theta env non_gens = 
  case e of
   constant_int _ => (integer,theta) 
  | 
   constant_bool _ => (boolean,theta) 
  | ... 
```

假设这是有效的代码，因为 constant_int 是已经声明的数据类型的一部分，等等。如何添加打印语句来表示“返回“整数””？我试过：

```
...
constant_int _ => (print "returning integer") (integer,theta)
... 
```

但我得到：

```
    标准输入：167.22-167.65 错误：运算符不是函数 [tycon 不匹配]
      操作员：单位
      表达：
        （打印“返回整数”）（整数，θ）

```

我想我只是不明白如何执行一系列语句，只有最后一个应该被视为返回值。有什么建议吗？

另外，我将如何打印我自己的数据类型值？当我尝试将数据类型值传递给 print() 时，SML 不喜欢，所以我可能必须为每个数据类型创建一个新的打印函数，对吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-12T22:08:04.430

您可以使用分号“执行一系列语句，只有最后一个语句应被视为返回值”。

```
...
constant_int _ => ( print "returning integer"; (integer,theta) )
... 
```

在这种情况下，我们需要将语句序列包装在括号中，因为分号的优先级低于 case 表达式，所以如果我们没有括号，它会认为 case 表达式以分号结尾，并且整个 case 表达式是序列的一部分，在这种情况下，这不是您想要的。

# c# - 如何在 .NET 中实现匿名方法中捕获的值

> ID：742365
> 
> 赞同：4
> 
> 时间：2009-04-12T20:28:56.090
> 
> 标签：c#, java, .net, closures

我对实际的 .NET 实现及其背后的决定感到好奇。

例如，在 Java 中，匿名类中使用的所有捕获值都必须是最终值。.NET 中似乎取消了此要求。

此外，与引用类型相比，值类型的捕获值的实现是否存在差异？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-12T21:38:26.907

找出它是如何实现的最简单的方法是尝试它。编写一些使用捕获变量的代码，编译它，然后在[Reflector](http://www.red-gate.com/products/reflector/)中查看它。请注意，捕获的是*变量*，而不是*值*。这是 Java 和 C# 在该领域的最大区别之一。

基本思想是，包含至少一个捕获变量的每一级范围会产生一个新类，其中包含已捕获变量的字段。如果有多个级别，则内部范围也有一个用于下一个范围的字段，依此类推。堆栈上真正的局部变量最终是对自动生成类的实例的引用。

这是一个例子：

```
using System;
using System.Collections.Generic;

class Program
{
    static void Main()
    {
        List<Action> actions = new List<Action>();

        for (int i=0; i < 5; i++)
        {
            int copyOfI = i;

            for (int j=0; j < 5; j++)
            {
                int copyOfJ = j;

                actions.Add(delegate
                {
                    Console.WriteLine("{0} {1}", copyOfI, copyOfJ);
                });
            }
        }

        foreach (Action action in actions)
        {
            action();
        }        
    }
} 
```

（当然，如果你不复制，你会得到不同的结果 - 实验！）这被编译成这样的代码：

```
using System;
using System.Collections.Generic;

class Program
{
    static void Main()
    {
        List<Action> actions = new List<Action>();

        for (int i=0; i < 5; i++)
        {
            OuterScope outer = new OuterScope();
            outer.copyOfI = i;

            for (int j=0; j < 5; j++)
            {
                InnerScope inner = new InnerScope();
                inner.outer = outer;
                inner.copyOfJ = j;

                actions.Add(inner.Action);
            }
        }

        foreach (Action action in actions)
        {
            action();
        }        
    }

    class OuterScope
    {
        public int copyOfI;
    }

    class InnerScope
    {
        public int copyOfJ;
        public OuterScope outer;

        public void Action()
        {
            Console.WriteLine("{0} {1}", outer.copyOfI, copyOfJ);
        }
    }
} 
```

*对捕获变量的每个*引用最终都会通过生成类的实例，因此它不仅仅是一次性副本。（好的，在这种情况下，代码中没有其他任何东西使用捕获的变量，但您可以轻松想象它可以。）注意对于外部循环的任何一次迭代，五个新实例都共享一个`OuterScope`. 您可能想尝试在委托中使用额外的代码以查看它如何影响事物 - 如果委托更改，则`copyofI`该更改将在下一个委托中看到；不会看到更改，`copyOfJ`因为下一个委托将使用`InnerScope`.

# c - 机器人寻路算法

> ID：742369
> 
> 赞同：2
> 
> 时间：2009-04-12T20:29:44.980
> 
> 标签：c, algorithm, artificial-intelligence, robot

我有一个使用光学鼠标作为位置跟踪的机器人。基本上，随着机器人的移动，它能够使用鼠标跟踪 X 和 Y 方向的变化。鼠标还跟踪您正在移动的方向 - 即负 X 或正 X。这些值被汇总到单独的 X 和 Y 寄存器中。

现在，机器人在原地旋转并仅向前移动。因此，理想情况下，机器人的运动是在特定角度以直线运动（尽管如果您偏离方向，鼠标跟踪可以拾取偏差）。机器人的一组特定运动如下：
A：旋转 45 度，移动 3 英寸
B：旋转 90 度，移动 10 英寸
C：旋转 -110 度，移动 5 英寸
D：旋转 10 度，移动 1 英寸
但是每次鼠标 X 和鼠标 Y 寄存器都会给出您在每个方向上移动的实际距离。

现在，如果我只想重复从 A 到 D 的运动集，我该如何使用我已经收集的信息来做到这一点。我知道我基本上可以总结我已经输入的所有角度和距离，但是如果每个移动命令中存在很大的错误，这将被证明是不准确的。如何使用鼠标中的原始信息？一位朋友提供了一个想法，即我可以连续地对鼠标值进行正弦和余弦运算并计算最终向量，但我不确定这将如何工作。

问题是鼠标只给出相对读数，因此旋转或向后移动，您可能会擦除信息。所以，是的，我想知道的是如何实现该算法，以便它可以持续跟踪变化，如果您最初以之字形移动到达那里，它可以为您提供最短路径。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-12T21:39:56.947

我认为你需要做的基本算法是这样的：

```
currentX = currentY = 0;
heading = 0; // radians
while (true)
{
    deltas = SampleMouseDeltas();
    heading += deltas.Heading;
    currentX += Math.Cos(heading) * deltas.Distance;
    currentY += Math.Sin(heading) * deltas.Distance;
} 
```

你的想法是对的，这并不精确。它被称为“航位推算”是有原因的。

您可以在哪里获得 deltas.Heading 基于“X”坐标（公式将是（deltax in inches）/（鼠标传感器距离旋转中心的英寸）。此外，deltas.Distance 将来自“Y " 传感器，在您将其从像素转换为英寸之后。

然后要执行这些步骤，您可以执行以下操作：

```
robot.RotateLeft();
heading = 0;
while (heading < 45 degrees)
    heading += SampleMouseDeltas.Heading;
robot.StopRotateLeft();

... etc ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-12T21:24:44.770

不是你的问题的答案，但也许是一个警示故事......我在一年前作为一个学校项目做了这种机器人。这是一个彻底的失败，虽然我在做的过程中学到了很多东西。至于使用鼠标来追踪你的驾驶距离：它根本不适合我们，或者任何其他团体。可能是因为我们需要将鼠标放在离地面几毫米的地方，所以鼠标中的摄像头没有对焦。次年，没有一个做相同项目的小组使用这种方法。他们改为在轮子上做标记，并使用一个简单的红外传感器来计算轮子转了多少圈。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2010-06-08T18:23:52.873

我知道我在某种程度上破坏了这个线程，但如果你想要更准确的角度跟踪，两个光学鼠标将是理想的。基本上，如果你取消了相同方向的运动，你就会留下老鼠相对于彼此的运动。从那里开始，只需进行一些简单的数学运算即可准确确定“机器人”已经转动了多远。

# python - 当我在迭代列表时修改列表时，为什么 Python 会跳过元素？

> ID：742371
> 
> 赞同：16
> 
> 时间：2009-04-12T20:30:22.683
> 
> 标签：python, list, foreach

我目前正在用 python 开发一个程序，我只是注意到语言中的 foreach 循环有问题，或者可能是列表结构。我将给出一个通用示例来简化我的问题，因为我的程序和通用示例都出现了相同的错误行为：

```
x = [1,2,2,2,2]

for i in x:
    x.remove(i)

print x 
```

好吧，这里的问题很简单，我认为这段代码应该从列表中删除所有元素。好吧，问题是在它执行之后，我总是在列表中得到 2 个剩余的元素。

我究竟做错了什么？感谢您提前提供的所有帮助。

编辑：我不想清空列表，这只是一个例子......

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-04-12T20:36:58.083

这是 Python 中一个有据可查的行为，您不应该修改正在迭代的列表。试试这个：

```
for i in x[:]:
    x.remove(i) 
```

返回的`[:]`“切片” `x`，恰好包含其所有元素，因此实际上是 的副本`x`。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-12T20:37:18.753

当你删除一个元素，并且 for 循环 incs 到下一个索引时，你会跳过一个元素。

倒着做。或者请说出你真正的问题。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-13T02:43:03.287

我认为，从广义上讲，当你写作时：

```
for x in lst:
    # loop body goes here 
```

在引擎盖下，python 正在做这样的事情：

```
i = 0
while i < len(lst):
    x = lst[i]
    # loop body goes here
    i += 1 
```

如果你插入`lst.remove(x)`循环体，也许你会明白为什么你会得到你所做的结果？

本质上，python 使用移动指针来遍历列表。指针从指向第一个元素开始。然后删除第一个元素，从而使*第二个*元素成为新的第一个元素。然后指针移动到新的第二个——之前是第三个——元素。等等。（如果您使用 [1,2,3,4,5] 而不是 [1,2,2,2,2] 作为示例列表，可能会更清楚）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-12T20:38:05.270

Why don't you just use:

```
x = [] 
```

It's probably because you're changing the same array that you're iterating over.

Try Chris-Jester Young's answer if you want to clear the array your way.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-08-05T22:01:31.490

我知道这是一篇旧帖子，答案已被接受，但对于那些可能仍会出现的人......

先前的一些答案表明在迭代期间更改可迭代对象是一个坏主意。但作为一种强调正在发生的事情的方式......

```
>>> x=[1,2,3,4,5]
>>> for i in x:
...     print i, x.index(i)
...     x.remove(i)
...     print x
...
1 0
[2, 3, 4, 5]
3 1
[2, 4, 5]
5 2
[2, 4] 
```

希望视觉有助于澄清。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-11-07T17:12:18.920

我同意 John Fouhy 关于休息条件的看法。正如 Chris Jester-Young 所建议的，遍历列表的副本适用于 remove() 方法。但是，如果需要 pop() 特定项目，则反向迭代可以工作，正如 Erik 所提到的，在这种情况下，操作可以就地完成。例如：

```
def r_enumerate(iterable):
    """enumerator for reverse iteration of an iterable"""
    enum = enumerate(reversed(iterable))
    last = len(iterable)-1
    return ((last - i, x) for i,x in enum)

x = [1,2,3,4,5]
y = []
for i,v in r_enumerate(x):
    if v != 3:
        y.append(x.pop(i))
    print 'i=%d, v=%d, x=%s, y=%s' %(i,v,x,y) 
```

或使用 xrange：

```
x = [1,2,3,4,5]
y = []
for i in xrange(len(x)-1,-1,-1):
    if x[i] != 3:
        y.append(x.pop(i))
    print 'i=%d, x=%s, y=%s' %(i,x,y) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-07-29T20:48:25.800

如果您需要从列表中过滤掉东西，使用列表理解可能是一个更好的主意：

```
newlist = [x for x in oldlist if x%2] 
```

例如将从整数列表中过滤掉所有偶数

# python - 封装与继承，帮助做出选择

> ID：742376
> 
> 赞同：1
> 
> 时间：2009-04-12T20:32:47.110
> 
> 标签：python, design-patterns, inheritance, abstract-class

我需要为几种不同的案例类型（在 Python 中）编写处理程序。所有这些类型的接口都是相同的，但处理逻辑不同。

一种选择是定义一个公共类，该类接收特定的处理程序类型作为 __init__ 参数之一：

```
class Handler:
   def __init__ (self, handlerType):
       self._handlerType = handlerType
       self._handler = handlerType.handleStuff

   def handleStuff(self, *args, **kwargs):
       return self._handler(args, kwargs)

# case specific handlers

class Handler_Case1:
   def handleStuff(self, *args, **kwargs):
       print 'Handling Case 1'

class Handler_Case2:
   def handleStuff(self, *args, **kwargs):
       print 'Handling Case 2'

if __name__ == '__main__':
   handlers = []
   handlers.append(Handler(Handler_Case1))
   handlers.append(Handler(Handler_Case2))
   for h in handlers:
       h.handleStuff() 
```

但是，这会导致 TypeError：

> TypeError：必须使用 Handler_Case1 实例作为第一个参数调用未绑定的方法 handleStuff()（改为获取元组实例）

另一种选择是模仿抽象函数，如下所示[（](http://norvig.com/python-iaq.html) “问：你能在 Python 中用 0 行代码实现抽象类吗？”）：

```
class Handler:
  def handleStuff(self, *args, **kwargs): abstract
  def commonFunction(self):
       print 'Common function'

 # case specific handlers

 class Handler_Case1(Handler):
  def handleStuff(self, *args, **kwargs):
      print 'Handling Case 1'

 class Handler_Case2(Handler):
  def handleStuff(self, *args, **kwargs):
      print 'Handling Case 2'

 if __name__ == '__main__':
  handlers = []
  h1 = (Handler_Case1())
  h2 = (Handler_Case2())
  handlers.append(h1)
  handlers.append(h2)
  for h in handlers:
      h.handleStuff()
      print 
```

所以，实际上，我有两个问题：

1.  这两种方法中哪一种更pythonic？和
2.  如何实现第一个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-12T20:50:25.977

I might be missing some subtle intricacy in your question, but given your first example, what precludes you from doing something like this:

```
class HandlerCase1(object):
    def handle_stuff(self, *args, **kwargs):
        print "Handling case 1"

class HandlerCase2(object):
    def handle_stuff(self, *args, **kwargs):
        print "Handling case 2"

if __name__ == "__main__":
    handlers = []
    handlers.append(HandlerCase1())
    handlers.append(HandlerCase2())
    for h in handlers:
        h.handle_stuff() 
```

And if you want the classes to share some common (base) functionality, is there something keeping you from doing this:

```
class Handler(object):
    def common_function(self):
        print "Common function"

class HandlerCase1(Handler):
    def handle_stuff(self, *args, **kwargs):
        print "Handling case 1"

class HandlerCase2(Handler):
    def handle_stuff(self, *args, **kwargs):
        print "Handling case 2"

if __name__ == "__main__":
    handlers = []
    handlers.append(HandlerCase1())
    handlers.append(HandlerCase2())
    for h in handlers:
        h.handle_stuff()
        h.common_function() 
```

# javascript - Javascript 字符串提取/reg exp 帮助

> ID：742378
> 
> 赞同：0
> 
> 时间：2009-04-12T20:32:58.187
> 
> 标签：javascript, string

我有一个这种格式的字符串：

```
<!--Start 498-->
some stuff here
<!--End 498-->

<!--Start 498-->    
some more stuff here
<!--End 499--> 
```

等等。

如何拆分此字符串以删除特定块`<!--Start xx->`和之间的内容`<!--End xx-->`？

例如，如果我想删除 and 之间的文本`<!--Start 500-->`，`<!-- End 500-->`我将如何删除它？

编辑：我可以用什么正则表达式来替换这些？我对正则表达式绝望:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-12T20:37:00.377

我会使用 String.replace 和正则表达式来匹配块并用空字符串替换

就像是

```
<!--Start \d+-->.*?<!--End \d+--> 
```

会成功的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T17:17:49.037

[http://www.webreference.com/js/column5/rules.html](http://www.webreference.com/js/column5/rules.html)会有所帮助。

# c - C 最佳实践中的项目组织

> ID：742391
> 
> 赞同：8
> 
> 时间：2009-04-12T20:42:15.450
> 
> 标签：c, project-organization

我想知道组织大型 C 项目的最佳实践是什么。这是一个专业项目，而不是开源项目，可能存储在 Git 存储库中。事情应该如何排序？结构应该去哪里？什么时候应该使用附加到结构的函数而不是使用结构作为参数的函数？

在布局项目中的文件方面，应该如何组合？什么命名约定最合适？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-12T20:44:07.753

您可能对[这个问题](https://stackoverflow.com/questions/661307/recommendations-for-structuring-complex-applications-in-c)的答案感兴趣。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-12T20:45:53.740

我认为在你的情况下最好的办法就是确保你的整个团队都在同一个页面上。这一点怎么强调都不过分。有一个标准化的做事方法，并确保你这样做。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-04-12T20:44:37.707

对于大型项目，我个人的方法是所有东西都有自己的文件夹。IE：

根 --> （类，结构）

类 --> (ClassA, ClassB)

结构 --> (StructA, StructB)

如果需要，您可以进一步拆分 StructA 或 Struct B...

结构A->（方法，结构）

等等

# svn - How can I get Sandcastle to play nice with SVN?

> ID：742392
> 
> 赞同：1
> 
> 时间：2009-04-12T20:42:58.910
> 
> 标签：svn, sandcastle, robocopy

I'm trying to add the output of a Sandcastle compilation into source control, but Sandcastle has issues trying to output directly into a subversion-controlled directory structure.

So, what I was trying to do is output into a non-controlled directory and then robocopy into the svn-controlled structure. I'd prefer to use /MIR to remove any old files, but the problem is that this causes robocopy to wipe out all the svn property stuff.

So, is there an easy way to use robocopy the way I want, or is there another solution?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-14T02:43:20.563

关于 robocopy，我相信您可以使用该`/xd`开关排除目录，包括源或目标中的目录。对于 SVN，请尝试告诉 robocopy 排除`.svn`文件夹：

```
robocopy C:\sourcedir\ C:\mydestination /mir /xd .svn 
```

# emacs - 无法在 Emacs 中的屏幕之间移动

> ID：742400
> 
> 赞同：1
> 
> 时间：2009-04-12T20:48:02.160
> 
> 标签：emacs

我有两个屏幕，一个是空的，另一个是 Emacs 的手册。我的光标在空白屏幕上。

我所有的命令都会影响空屏幕。

Vim 中的一个类似命令是 Cw。

**您如何切换到 Emacs 的手册**，以便我可以通过 Cv 滚动屏幕？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-12T20:50:49.827

**Control-x + o** (Cx + o), google emacs 备忘单寻求帮助

1.  保持控制
2.  按 X
3.  释放控制和 X
4.  按 O

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-12T20:58:03.977

就像[zaczap 所说的](https://stackoverflow.com/questions/742400/unable-to-move-between-screens-in-emacs/742406#742406)使用“ `C-x o`”（控制“x”然后“o”）在单个窗口中的“帧”之间移动，或者使用“ `C-x 5 o`”在不同的窗口之间移动。

* * *

“窗口”是指一个带有标题栏和装饰物的窗口管理器对象，而“框架”是指整个窗口的一部分，包含一个缓冲区。

* * *

其他重要命令：

*   “ `C-x 2`”在此窗口中创建一个新框架或“ `C-x 5 2`”创建一个新窗口
*   “ `C-x 0`”关闭当前框架或“ `C-x 5 0`”关闭当前窗口
*   " `C-x 1`" 使当前框架展开以使用整个窗口。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-12T23:18:41.657

您还可以滚动另一个屏幕（Emacs 术语中的“窗口”），而无需离开您当前所在的屏幕：

元 (Alt) + PageUp/PageDown

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-01-21T12:30:18.100

Emacs 备忘单 - 重度旋转命令 ^：CTRL 键 M：Esc 或 ALT 键

Emacs ^hi 手册

^x^c 退出 ^d 删除下一个字符 ^x^s 保存 BACKSPACE 删除上一个字符
^x^w 另存为
^xu 撤消 Md 删除下一个单词 ^g 中止命令 M-BACKSPACE 删除上一个单词

^f --> char ^k 删除到行尾 ^b <-- char
^p /\ up ^-SPACE start region ^n / down ^w cut Mw copy ^y paste Mf next word ->
Mb prev. word <-
^xb 切换/新缓冲区 ^x^f 打开文件 ^a 开始行
^e 结束行 ^s search Mg g go to line

^v screen / down
Mv screen /\ up ^x 0 删除窗口 ^x 1 删除其他窗口 ^x 2 垂直分割 ^x 3 水平分割 ^xo 删除当前窗口

# events - Events in JSP?

> ID：742402
> 
> 赞同：0
> 
> 时间：2009-04-12T20:50:05.273
> 
> 标签：events, jsp

I'd like to ask if there is in the JSP events such as the swing (eg: ActionEvent)?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-12T20:54:29.443

No. There are not.

If you want something similar (not equal), you could give [JSF](http://java.sun.com/javaee/javaserverfaces/) a try for your Java based web applications.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T01:36:13.573

客户端的事件将由 javascript 处理。如果您需要将任何信息发送回服务器，请使用 AJAX 或`<form>`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-12T21:27:58.100

如果您喜欢 Swing 编程并希望在 Web 应用程序中继续这种范例，那么我建议您看看[Wicket](http://wicket.apache.org/)。

# windows - Copy files with double credentials (windows)

> ID：742410
> 
> 赞同：0
> 
> 时间：2009-04-12T20:54:11.630
> 
> 标签：windows, io, credentials, rights

Assume we have c:\DirA that can be read by User1 only, and c:\DirB that can be written by User2 only. Both credentials are know.

How can I copy files from DirA to DirB directly?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-12T21:14:09.617

假设进程在第一个用户的上下文中运行，运行[`LogonUser`](http://msdn.microsoft.com/en-us/library/aa378184(VS.85).aspx)以获取第二个用户的安全令牌。生成一个线程并调用[`ImpersonateLoggedOnUser`](http://msdn.microsoft.com/en-us/library/aa378612(VS.85).aspx)，将令牌作为参数传递。第二个线程将有权访问`DirB`. 在第一个线程中读取数据，将它们传递给第二个线程并从那里写入。

如果您正在运行的用户具有备份或恢复权限，更简单的方法是使用[`OpenProcessToken`](http://msdn.microsoft.com/en-us/library/aa379295(VS.85).aspx)后跟[`AdjustTokenPrivileges`](http://msdn.microsoft.com/en-us/library/aa375202(VS.85).aspx).

# linux - 当操作系统杀死你的进程时返回代码

> ID：742413
> 
> 赞同：2
> 
> 时间：2009-04-12T20:54:31.503
> 
> 标签：linux, memory-management, process, return-value, kill

我想测试是否通过多个进程我能够在 32 位操作系统上使用超过 4GB 的内存（我的：带有 1GB 内存的 Ubuntu）。

因此，我编写了一个 malloc 略小于 1GB 的小程序，并对该数组执行了一些操作，并运行了该程序的 5 个实例 vie forks。

问题是，我怀疑操作系统杀死了其中的 4 个，只有一个幸存下来并显示它是“PID：我已经完成”）。

（我用小数组尝试过，打印了 5 次，当我用 TOP 查看正在运行的进程时，我只看到一个实例..）

奇怪的是 - 我在所有实例中都收到了返回代码 0（成功？），包括那些据称被操作系统杀死的实例

我没有得到任何说明进程被杀死的消息。

这个返回码在这种情况下正常吗？

（如果是这样，它会降低我对“返回码”的信任......）

谢谢。

编辑：一些答案暗示了小程序中可能存在的错误，所以在这里。分叉和保存返回码的较大程序较大，我无法在这里上传它，但我认为（并希望）它很好。

我还注意到，如果不是使用我的分叉程序运行它，而是使用终端运行它，使用 './a.out & ./a.out & ./a.out & ./a.out &' （当./a.out 是附加的小程序的二进制文件）我确实看到了一些“Killed”消息。

```
#include <stdio.h>
#include <stdlib.h>
#include <sys/types.h>
#include <unistd.h>
#define SMALL_SIZE 10000
#define BIG_SIZE 1000000000
#define SIZE BIG_SIZE
#define REAPETS 1

    int
main()
{
    pid_t my_pid = getpid();

    char * x = malloc(SIZE*sizeof(char));

    if (x == NULL)
    {
            printf("Malloc failed!");
            return(EXIT_FAILURE);
    }

    int x2=0;
    for(x2=0;x2<REAPETS;++x2)
    {
            int y;
            for(y=0;y<SIZE;++y)
                    x[y] = (y+my_pid)%256;
    }
    printf("%d: I'm over.\n",my_pid);
    return(EXIT_SUCCESS);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-12T21:07:11.067

使用什么信号来终止进程？

0到127（含）之间的退出代码可以自由使用，128以上的代码表示进程被信号终止，其中退出代码为

*128 + 使用的信号数*

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-12T21:07:43.047

好吧，如果您的进程无法`malloc()`使用 1GB 内存，操作系统不会杀死该进程。所发生的只是`malloc()`返回 NULL。因此，根据您编写代码的方式，该进程可能无论如何都会返回 0 - 如果您希望它在内存分配失败时返回错误代码（这通常是一种好习惯），您必须将该行为编程为它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-12T21:14:29.723

进程的返回状态（由`wait`,`waitpid`和返回`system`）或多或少包含以下内容：

*   退出代码，仅在进程正常终止时适用
*   是否发生正常/异常终止
*   终止信号，仅在进程被信号终止时适用

如果您的进程被 OOM 杀手杀死（这显然会向您发送 SIGKILL 信号），则退出代码完全没有意义

有关详细信息，请参阅[wait](http://linux.die.net/man/2/wait)命令的手册页。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-14T14:22:30.087

此代码显示如何获取孩子的终止状态：

```
#include <stdio.h>
#include <stdlib.h>

#include <unistd.h>
#include <sys/wait.h>

int
main (void)
{ 
  pid_t pid = fork();

  if (pid == -1)
  {
    perror("fork()");
  }
  /* parent */
  else if (pid > 0)
  {
    int status;

    printf("Child has pid %ld\n", (long)pid);

    if (wait(&status) == -1)
    {
      perror("wait()");
    }
    else
    {
      /* did the child terminate normally? */
      if(WIFEXITED(status))
      {
        printf("%ld exited with return code %d\n",
               (long)pid, WEXITSTATUS(status));
      }
      /* was the child terminated by a signal? */
      else if (WIFSIGNALED(status))
      {
        printf("%ld terminated because it didn't catch signal number %d\n",
               (long)pid, WTERMSIG(status));
      }
    }
  }
  /* child */
  else
  {
    sleep(10);
    exit(0);
  }

  return 0;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-12T21:15:02.670

你检查过返回值`fork()`吗？很有可能如果`fork()`无法为新进程的地址空间分配足够的内存，那么它将返回错误 (-1)。一个典型的调用方式`fork()`是：

```
pid_t pid;
switch(pid = fork())
{
case 0:
    // I'm the child process
    break;
case -1:
    // Error -- check errno
    fprintf(stderr, "fork: %s\n", strerror(errno));
    break;
default:
    // I'm the parent process
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-13T10:31:56.047

**仅当 WIFEXITED 宏评估为真时，退出代码才“有效”。**请参阅[man waitpid(2)](http://www.manpagez.com/man/2/waitpid/)。

您可以使用 WIFSIGNALED 宏来查看您的程序是否已收到信号。

# c++ - C memset 似乎不会写给每个成员

> ID：742415
> 
> 赞同：6
> 
> 时间：2009-04-12T20:56:34.027
> 
> 标签：c++, templates, sizeof, memset

我写了一个小坐标类来处理 int 和 float 坐标。

```
template <class T>
class vector2
{
public:
    vector2() { memset(this, 0, sizeof(this)); }
    T x;
    T y;
}; 
```

然后在 main() 我做：

```
vector2<int> v; 
```

但是根据我的 MSVC 调试器，只有 x 值设置为 0，y 值没有改变。我以前从未在模板类中使用过 sizeof()，这可能是造成问题的原因吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-12T20:59:54.907

不，不要使用`memset`——它将指针的大小（我的 x86 Intel 机器上的 4 个字节）从`this`. `memset`这是一个坏习惯：在使用复杂类时，您还会将虚拟指针和指向虚拟基的指针归零。而是这样做：

```
template <class T>
class vector2
{
public:
    // use initializer lists
    vector2() : x(0), y(0) {}
    T x;
    T y;
}; 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-04-12T21:09:08.753

正如其他人所说，`memset()`这不是正确的方法。然而，关于为什么不这样做有一些微妙之处。

首先，您尝试使用`memset()`的只是清除`sizeof(void *)`字节。对于您的示例情况，这显然是成员占用的字节数`x`。

简单的解决方法是编写`memset(this, 0, sizeof(*this))`，在这种情况下会同时设置`x`和`y`。

但是，如果您的`vector2`类有任何虚方法，并且编译器使用通常的机制来表示它们，那么这将通过将指针设置为 NULL`memset`来破坏`vtable`并破坏实例。`vtable`哪个不好。

另一个问题是，如果该类型`T`需要一些比将其位设置为 0 更复杂的构造函数操作，则~~不会~~调用成员的构造函数，但它们的效果会因用 覆盖成员的内容而被破坏`memset()`。

唯一正确的操作是将默认构造函数编写为

```
vector2(): x(0), y(0), {} 
```

并且完全忘记尝试使用`memset()`它。

**编辑：** D.Shawley 在评论中指出，在提供的原始代码中，默认构造函数实际上是在`x`和`y`之前调用的。`memset()`虽然在技术上是正确`memset()`的，但调用会覆盖成员，这充其量是非常非常糟糕的形式，最坏的情况是调用未定义行为的恶魔。

正如所写，`vector2`该类是 POD，只要类型`T`也是普通的旧数据，如果`T`是`int`或`float`.

然而，所需要的只是`T`成为某种`bignum`价值类别来导致可能很难诊断的问题。如果幸运的话，它们会通过取消引用由`memset()`. 但幸运女神是一个善变的情妇，更有可能的结果是一些内存泄漏，应用程序变得“不稳定”。或者更有可能，“摇摇欲坠”。

OP 在对另一个答案的评论中问道“......难道没有办法让 memset 工作吗？”

答案很简单，“不”。

选择了 C++ 语言并选择充分利用模板后，您必须通过正确使用该语言来为这些优势付出代价。绕过构造函数（在一般情况下）根本不正确。虽然在某些情况下调用`memset()`C++ 程序是合法、安全和明智的，但这并不是其中之一。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-12T20:58:16.940

问题是这是一个指针类型，它是 4 个字节（在 32 位系统上），而整数是 4 个字节（在 32 位系统上）。尝试：

```
sizeof(*this) 
```

编辑：虽然我同意其他人的观点，构造函数中的初始化列表可能是这里的正确解决方案。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-12T21:15:02.657

不要使用 memset。它会在非 POD 类型上严重中断（并且不一定很容易调试），在这种情况下，它可能比简单地将两个成员初始化为零（两个赋值与函数调用）要慢得多。

此外，您通常不希望将类的所有成员归零。您希望将零是有意义的默认值的那些清零。并且您应该养成在任何情况下将您的成员初始化为有意义的值的习惯。将所有内容归零并假装问题不存在只会保证以后会让人头疼。如果将成员添加到类中，请决定是否应该初始化该成员以及如何初始化。

如果您确实需要类似 memset 的功能，请至少使用与非 POD 类型兼容的 std::fill。

如果您使用 C++ 编程，请使用 C++ 提供的工具。否则，称它为 C。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-13T01:07:30.147

迫切地是正确的。然而，与使用 0 构造 x 和 y 不同，显式调用默认构造函数会将内部类型设置为 0，并允许模板用于具有默认构造函数的结构和类。

```
template <class T>
class vector2
{
public:
    // use initializer lists
    vector2() : x(), y() {}
    T x;
    T y;
}; 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-12T21:08:09.427

不要试图比编译器更聪明。按照语言的意图使用初始值设定项列表。编译器知道如何有效地初始化基本类型。

如果您尝试对具有虚拟功能的类进行 memset hack，您很可能会覆盖 vtable，最终导致灾难。不要像那样使用 hack，它们是维护的噩梦。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-18T06:24:30.683

这可能会起作用：

```
 char buffer[sizeof(vector2)];
memset(buffer, 0, sizeof(buffer));
vector2 *v2 = new (buffer) vector2(); 
```

..或替换/覆盖 vector2::new 来做类似的事情。不过对我来说仍然很奇怪。

一定要搭配

```
 vector2(): x(0), y(0), {} 
```

# powershell - Powershell 模拟

> ID：742417
> 
> 赞同：2
> 
> 时间：2009-04-12T20:56:45.180
> 
> 标签：powershell, impersonation

如何在 PowerShell 中进行模拟？我可以使用[advapi32.dll LogonUser](http://mshforfun.blogspot.com/2006/02/groups-command-in-msh-get.html)，但也许有更简单的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-12T21:21:10.067

很久以前就这个话题[有过类似的讨论（嗯，相对于 SO 退出的时间）。](https://stackoverflow.com/questions/11806/how-do-you-impersonate-an-active-directory-user-in-powershell)
长话短说，使用具有 Identity 参数的 LogonUser、psexec 或 PowerShell 命令。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-13T23:27:13.127

您可以使用上述方法，特别是 PowerShell Get-Credential 方法对我有用。还要检查 Secure-String 方法以使您能够获取凭证信息并使用密码信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-06T15:00:54.760

如果是用于远程连接，您可能会考虑使用 cmdkey.exe 工具（本机），使用以下任一工具，具体取决于您是否希望将密码包含在命令行中或提示：

```
cmdkey /add:<servername> /user:<username> /pass:<password>

cmdkey /add:<servername> /user:<username> /pass 
```

我知道它不是 PowerShell，而是本机 exe，并且可以在 cmdlet 不实现`-Credential`参数的情况下工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-12T06:07:25.933

这是最好的解决方案。

[http://huddledmasses.org/using-alternate-credentials-with-the-filesystem-in-powershell/](http://huddledmasses.org/using-alternate-credentials-with-the-filesystem-in-powershell/)

我认为

# html - div 并排扭曲

> ID：742423
> 
> 赞同：1
> 
> 时间：2009-04-12T20:59:59.133
> 
> 标签：html, css

有没有办法让div并排？

我要布局

```
------------
|Header div|
------------
|  |       |
|ul|iframe |
|  |       | 
```

但是如果 iframe 是可见的：隐藏/折叠`<ul>`将占用所有空间

```
------------
|Header div|
------------
|          |
|ul        |
|          | 
```

如果我让 ul 向左浮动，那么 ul 将没有 width:auto 并且如果我让 iframe position:absolute ul 将始终通过整个站点扩展。

所有显示此内容的网站都使用 ul 并留有余量。但是如果 iframe 不存在，那么 ul 将有边距

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-12T21:11:21.213

如果将 浮动`iframe`到 的右侧，则在删除（或样式设置为）时`ul`， 的内容`ul`将能够填满整个宽度。由于更改样式不会影响布局，因此更改将一事无成。`display``none``visibility`

```
<div>Header</div>
<iframe src="http://www.google.com/" style="width:80%;float:right">
</iframe>
<ul>
  <li>Left column / main column</li>
  <li>A list</li>
  <li>of things</li>
</ul> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-12T21:04:33.087

将 iframe 包裹在 div 中以处理 iframe 位置。将 div 的填充减少到 0。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T16:36:48.400

```
I solved it. By setting overflow:auto on the ul element!

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
    <title>Test</title>
</head>
<body>
<div>Header</div>
<iframe src="http://www.google.com/" style="width:20%;float:right">
</iframe>
<ul style="overflow: auto;">
  <li style="border: solid 1px Yellow;margin: 5px;">Left column / main column</li>
  <li style="border: solid 1px Yellow;margin: 5px;">A list</li>
  <li style="border: solid 1px Yellow;margin: 5px;">of things</li>
</ul>
</body>
</html> 
```

# emacs - 你会为 Vim 老手提供哪个 .emacs 文件？

> ID：742425
> 
> 赞同：5
> 
> 时间：2009-04-12T21:01:27.697
> 
> 标签：emacs, vim

我使用 Vim 进行编码。我也想学 Emacs。

我想至少将我的 .vimrc 中的以下一些自定义导出到我的 .emacs。

**我的.vimrc**

```
let Tlist_Auto_Open = 1

" http://stackoverflow.com/questions/165231/vim-dvorak-keybindings-rebinding
" Dvorak it!
no d h
no h j
no t k
no n l
no s :
no S :
no j d
no J D
no l n
no L N
" Added benefits
no - $
no _ ^
no N 
no ; z
no T L
no P P
no p p

let Tex_ViewRuleComplete_pdf = '/usr/bin/open -a Skim $*.pdf' 

set history=1000

set smartindent
set autoindent
set tabstop=4
set expandtab
set shiftwidth=3                                                                                            
set softtabstop=4
set number
set hlsearch
syntax on
set cursorline
highlight CursorLine guibg=#400000
set ruler
set textwidth=78
set foldcolumn=5

" REQUIRED. This makes vim invoke Latex-Suite when you open a tex file.
filetype plugin on 
filetype indent on

" IMPORTANT: grep will sometimes skip displaying the file name if you
" search in a singe file. This will confuse Latex-Suite. Set your grep
" program to always generate a file-name.
set grepprg=grep\ -nH\ $*

" OPTIONAL: This enables automatic indentation as you type.
filetype indent on

" OPTIONAL: Starting with Vim 7, the filetype of empty .tex files defaults to
" 'plaintex' instead of 'tex', which results in vim-latex not being loaded.
" The following changes the default filetype back to 'tex':
let g:tex_flavor='latex'

" http://ubuntuforums.org/showthread.php?t=74889
set foldmethod=manual "folds by indentation, manual, indent
set nocompatible                "Use Vim extensions
set backspace=indent,eol,start  "More powerful backspacing
set nobackup                    "No backup file
set showmode                    "Tell when in insert mode
set showmatch                   "Show matching () {} etc
set hlsearch                    "Highlight what is searched for
set incsearch                   "Highlight as you type

if &t_Co > 2
  syntax on
endif

set bg=dark
hi clear
if exists("syntax_on")
  syntax reset
endif

"Allowable colors: red, yellow, green, blue, magenta,
"                  cyan, gray, black, gray
hi Normal ctermfg=gray ctermbg=none
hi ErrorMsg ctermfg=gray ctermbg=lightblue
hi Visual ctermfg=lightblue ctermbg=fg cterm=reverse
hi VisualNOS ctermfg=lightblue ctermbg=fg cterm=reverse,underline
hi Todo ctermfg=red ctermbg=darkblue
hi Search ctermfg=gray ctermbg=darkblue
hi IncSearch ctermfg=darkblue ctermbg=gray
hi SpecialKey ctermfg=darkcyan
hi Directory ctermfg=cyan
hi Title ctermfg=magenta cterm=bold
hi WarningMsg ctermfg=red
hi WildMenu ctermfg=yellow ctermbg=black cterm=none
hi ModeMsg ctermfg=lightblue
hi MoreMsg ctermfg=darkgreen ctermfg=darkgreen
hi Question ctermfg=green cterm=none
hi NonText ctermfg=darkblue
hi StatusLine ctermfg=blue ctermbg=gray cterm=none
hi StatusLineNC ctermfg=black ctermbg=gray cterm=none
hi VertSplit ctermfg=black ctermbg=gray cterm=none
"hi Folded ctermfg=darkgrey ctermbg=black cterm=bold
"hi FoldColumn ctermfg=darkgrey ctermbg=black cterm=bold
hi LineNr ctermfg=gray cterm=none
hi DiffAdd ctermbg=darkblue cterm=none
hi DiffChange ctermbg=magenta cterm=none
hi DiffDelete ctermfg=blue ctermbg=cyan
hi DiffText cterm=bold ctermbg=red
hi Cursor ctermbg=brown
hi lCursor ctermbg=darkgreen

hi Comment ctermfg=lightgreen cterm=none
hi Constant ctermfg=cyan cterm=none
hi Identifier ctermfg=gray cterm=none
hi Statement ctermfg=red cterm=none
hi PreProc ctermfg=yellow cterm=bold
hi Type ctermfg=darkyellow cterm=none
hi Special ctermfg=magenta cterm=none
hi Underlined cterm=underline
hi Ignore cterm=none 
```

**您的 .emacs**中有什么可以让我拥有上述某些功能？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-13T00:56:47.070

[EMACS Starter Kit](http://www.emacsblog.org/2008/12/05/emacs-starter-kit/)也很有帮助。

我的上帝——你真的在你的 .vim 中将你的键盘重新映射到 Dvorak 吗？

好的，这里有一些其他的：

> 设置智能缩进
> 设置自动缩进

自动进入编程模式。对于文本模式，请查看“autoindent-mode”和“filladapt”。

> 设置 tabstop=4
> 设置 shiftwidth=3
> 设置 softtabstop=4

```
(setq c-basic-offset 4) ; indents 4 chars
(setq tab-width 4)          ; and 4 char wide for TAB
(setq indent-tabs-mode nil) ; And force use of spaces 
```

（对于 shiftwidth 没有简单的等价物；EMACS 使用更智能的 autindentation 算法。

> 设置扩展选项卡

```
(setq indent-tabs-mode nil) 
```

> 集数

有一种方法可以获得编号的行，但我从不使用它并且不记得它。

> 语法

```
 (turn-on-font-lock) 
```

> 设置光标线

有一堆光标设置，通过mx apropos cursor看

其他一些东西也是可用的，这些是我临时知道的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-12T21:45:03.223

试试这些，并进行实验。

[点文件 emacs](http://dotfiles.com/index.php?app_id=6)

[dotfiles.org](http://dotfiles.org/)

除此之外，总是一个很好的链接：

[GNU Emacs 在线手册](http://www.gnu.org/software/emacs/manual/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-13T06:11:35.377

您可以获得带有`(linum-mode 1)`或`(global-linum-mode 1)`每个缓冲区的编号行。此功能目前仅在 CVS Emacs 中提供。查看[更多选择](http://www.emacswiki.org/emacs/LineNumbers)。

要在 Emacs 中打开 PDF 文档，有`doc-view-mode`. 有关详细说明，请参阅[在 Emacs 缓冲区中查看 PDF/PS/DVI 文件](http://bc.tech.coop/blog/070830.html)。

无论如何，最好[按照 Charlie Martin 的建议](https://stackoverflow.com/questions/742425/which-emacs-file-would-you-give-for-a-vim-veteran/742739#742739)开始使用 Emacs Starter Kit 学习 Emacs ，然后发现自己真正缺少的东西。Emacs 的世界与 Vi 的不同。您可以随时浏览 Stack Overflow 以查看您的问题是否已得到解答。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-23T23:07:26.093

你绝对应该尝试邪恶模式。emacs 的最佳 vim 模拟器： [http ://www.emacswiki.org/emacs/Evil](http://www.emacswiki.org/emacs/Evil)

# c# - 在 WordPress 中格式化 C# 的最佳方法是什么？

> ID：742428
> 
> 赞同：11
> 
> 时间：2009-04-12T21:03:44.117
> 
> 标签：c#, wordpress, syntax-highlighting

嘿，那里的博主！我已经创建了我自己托管的 Wordpress 博客，而且我很难找出将 C# 片段添加到我的博客的最佳方法。大家都用什么？

我目前正在使用“SyntaxHighlighter Evolved”插件，它在大多数情况下都很好用——唯一的问题是切换回可视化编辑器会删除所有空白填充。我尝试将 [sourcecode] 标签包装在 <pre> 中，但是格式化程序无法正常工作。

任何帮助将非常感激。我花了大约 10 个小时试图提出一个强大的解决方案，但没有运气。干杯!

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-12T21:44:10.887

请参阅[我在这个确切问题上写的博客文章](http://ellisweb.net/2008/08/using-syntaxhighlighter-to-format-code-in-wordpress/)，其中解释了如何使用[SyntaxHighlighter](http://code.google.com/p/syntaxhighlighter/)和修复 TinyMCE，这样它就不会弄乱你的空白或标签（你可以在 Wordpress 中自定义一个 tinymce 文件，或者使用[插件](http://www.engfers.com/plugins/tinymce-valid-elements/)为你做这件事）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-12T21:07:34.467

使用 WP-语法插件。要使用它，您需要使用带有语言属性的 pre 标记来包装代码。巩固努力。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-12T21:24:33.477

如果客户端（JavaScript）语法突出显示也是一个选项，我可以推荐[google-code-prettify](http://code.google.com/p/google-code-prettify/)，它工作得很好。[正如我在一篇文章中](http://www.stum.de/2008/10/19/escaping-code-for-posting-on-the-website-and-removing-indent/)详述的那样，作为作者，只需要一点代码转义就可以使其零摩擦。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-12T21:45:44.203

您可以使用 Windows Live Writer 为您的博客撰写文章并使用 Steve Dunns[实时作家插件](http://stevedunns.googlepages.com/codeformatterforwindowslivewriter)。

# sql-server - SQL Server 索引

> ID：742435
> 
> 赞同：0
> 
> 时间：2009-04-12T21:09:09.923
> 
> 标签：sql-server, indexing

即使表具有聚集索引，也需要非聚集索引吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-12T21:17:31.200

为了获得最佳性能，您必须为查询中使用的每个组合创建一个索引。例如，如果您有这样的选择。

```
SELECT *
FROM   MyTable
WHERE  Col_1 = @SomeValue AND
       Col_2 = @SomeOtherValue 
```

然后你应该用 Col_1 和 Col_2 做一个聚集索引。另一方面，如果您有一个额外的查询，它只查找一个列，例如：

```
SELECT *
FROM   MyTable
WHERE  Col_1 = @SomeValue 
```

那么你应该有一个只有 Col_1 的索引。所以你最终有两个索引。一个带有 Col_1 和 Col_2，另一个带有 Col_1。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-12T21:13:39.397

“需要”是对未包含在聚集索引中的列进行更快的查找。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-12T21:41:09.723

不要将聚集索引与跨多列的索引混淆。那不是一回事。

[这](http://www.sql-server-performance.com/articles/per/index_data_structures_p1.aspx)是一篇很好地解释聚集索引与非聚集索引的文章。

在 mssql 服务器中，每个表只能有一个聚集索引，而且它几乎总是主键。聚集索引“附加”到表，因此它不需要返回表来获取可能在“select”子句中的任何其他数据元素。未附加非聚集索引，但包含对包含所有其余数据的表行的引用。

# asp.net-mvc - 模拟 FormsAuthentication.Authenticate() 方法

> ID：742437
> 
> 赞同：4
> 
> 时间：2009-04-12T21:10:57.783
> 
> 标签：asp.net-mvc, forms-authentication, rhino-mocks

有什么方法可以使用测试凭据模拟 FormsAuthentication.Authenticate("username", "password") 方法？我的测试目标是确保如果身份验证失败，它会重定向到正确的位置。我正在使用 Rhino Mocks 作为模拟框架。

非常感谢您的帮助，

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-12T22:23:14.253

Since you are using mvc, if you create a new project and look in the Account controller's code you will find the following clarification:

> The FormsAuthentication type is sealed and contains static members, so it is difficult to unit test code that calls its members. The interface and helper class below demonstrate how to create an abstract wrapper around such a type in order to make the AccountController code unit testable.

Below this, there are these declarations:

```
public interface IFormsAuthentication
public class FormsAuthenticationService : IFormsAuthentication
public interface IMembershipService
public class AccountMembershipService : IMembershipService 
```

You may look for implementations in the referred code.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-12T22:09:19.420

我不使用 Rhino Mocks，但我认为不可能使用除 typemock 之外的任何 .Net 模拟框架来模拟静态方法。最好的解决方法是围绕它创建一个接口适配器。

# performance - 标记单元测试

> ID：742440
> 
> 赞同：1
> 
> 时间：2009-04-12T21:13:25.357
> 
> 标签：performance, unit-testing, continuous-integration, phpunit, tagging

我正在开发一个具有可靠单元测试覆盖率的 PHP 项目。

我注意到，上次，我使用 unit-tests Command-Line Test Runner' **--filter**命令进行了非常棘手的操作。

以下是官方文档中对该命令的解释：

> > **- 筛选**
> > 
> > 仅运行名称与给定模式匹配的测试。模式可以是单个测试的名称，也可以是匹配多个测试名称的正则表达式。

我经常使用它，因为有时只运行整个测试库中的单个测试套件或测试用例会变得非常有用。

我想知道这是否是好习惯？

我听说有时在您的持续集成机器上运行整个测试套件是一种很好的做法，如果**您确定**自己只修改了一个组件并且**100% 有信心**，它不会使其他组件的单元失败-测试。你怎么看待这件事？

前段时间我认为我们不应该太关心运行所有单元测试的整个套件所需的时间，但是当您有非常复杂的业务逻辑和单元测试时 - 这可能会花费大量时间。

我明白，“真正的”单元测试不应该与数据库交互，使用模拟/存根对象，我同意这一点。但有时，使用 DB 固定装置进行测试更容易（更便宜）。

请给我一些建议，如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-12T22:38:25.140

好的单元测试应该：

*   有明确的方法名称和变量名称作为文档
*   快跑。这对于复杂业务逻辑的测试也是可能的。测试应该以大约 0.1 秒的平均时间运行。
*   在一种测试方法中准确测试一件事
*   不与文件系统、电子邮件、数据库、Web 服务和其他所有外部资源集成。您可以创建单独的数据库集成测试来测试您的数据库交互。大多数情况下，这些测试会比你的单元测试慢。我将集成测试放在一个单独的项目中，并且仅在处理集成代码时才运行它们。我还在 CI 服务器上的所有构建中运行它们。
*   彼此完全隔离。当您的测试相互依赖时，您无法通过阅读哪些测试失败来了解您的问题。您可能需要调试才能找到问题。独立测试将为您节省大量时间。

就个人而言，我在测试中不使用类别名称。我每个应用程序使用 2 个测试项目。一种用于单元测试，一种用于集成测试和较慢的测试。

反应：

> “但有时，使用 DB 固定装置进行测试更容易（更便宜）。”

当你的代码写得好时，它会更容易模拟。我不知道 Php 中的 mocking 框架，但我在其他语言中使用它们可以节省我很多时间。先写测试再写代码可能会帮助你设计更容易测试的代码。

就我个人而言，我学会了更好地测试

*   阅读有关它的博客
*   阅读有关它的书籍
*   阅读其他人编写的测试代码
*   当然要写很多测试。我花了几千次测试才变得擅长它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-12T23:07:37.610

> 我经常使用它，因为有时只运行整个测试库中的单个测试套件或测试用例会变得非常有用。
> 
> 我想知道这是否是好习惯？

当然，只要您偶尔运行全套单元测试（通过 CI 服务器听起来很完美）

定期运行“有趣”的测试比很少运行所有的测试要好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T18:37:25.240

**我会通过在提交之前运行必须**运行1 分钟或更短时间的测试子集（“冒烟测试”）来解决这个问题，然后从 CI 服务器运行全套测试。

如果您的全套测试需要超过 15 分钟，那么我会考虑将它们分开并并行运行。

然后你可以使用 --filter 首先运行你最感兴趣的测试，然后是提交之前的冒烟测试，其余的从 CI 服务器运行。

# c# - 什么是捕获电子邮件地址中拼写错误的好正则表达式？

> ID：742451
> 
> 赞同：92
> 
> 时间：2009-04-12T21:19:57.603
> 
> 标签：c#, regex, email-validation

当用户在我的网站上创建帐户时，我想对电子邮件进行服务器验证以不接受*每个*输入。

我将发送确认信息，以进行[握手验证](https://stackoverflow.com/questions/156430/regexp-recognition-of-email-address-hard/156441#156441)。

我正在寻找**一些简单的东西，不是*最好的***，但不是太简单，不能验证任何东西。我不知道必须在哪里限制，因为任何正则表达式都不会进行正确的验证，因为使用正则表达式是不可能的。

我试图限制正则表达式固有的语法和视觉复杂性，因为在这种情况下任何都是正确的。

我可以使用什么正则表达式来做到这一点？

* * *

## 回答 #1

> 赞同：267
> 
> 时间：2009-04-12T23:01:47.953

可以编写一个只接受符合标准的电子邮件地址的正则表达式。但是，有些电子邮件地址并不严格遵循标准，但仍然有效。

以下是一些用于基本验证的简单正则表达式：

包含 @ 字符：

```
@ 
```

包含 @ 和它之后某处的句点：

```
@.*?\. 
```

在 @ 之前、句点之前和之后至少有一个字符：

```
.+@.+\..+ 
```

只有一个@，在@ 之前、句点之前和之后至少有一个字符：

```
^[^@]+@[^@]+\.[^@]+$ 
```

用户 AmoebaMan17 建议进行此修改以消除空格：

```
^[^@\s]+@[^@\s]+\.[^@\s]+$ 
```

并且只接受一个时期***[外部编辑：不推荐，与有效的电子邮件地址不匹配]***：

```
^[^@\s]+@[^@\s\.]+\.[^@\.\s]+$ 
```

* * *

## 回答 #2

> 赞同：118
> 
> 时间：2009-04-12T21:23:26.987

```
^\S+@\S+$ 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-03-21T21:51:02.287

^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+.[a-zA-Z0-9-.]+$

*   只有1个 @
*   多个域和子域

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-06-22T10:48:07.970

我认为 AmoebaMan17 对表达式的这个小调整应该会阻止地址以点开头/结尾，并且还会阻止多个点彼此相邻。在消除常见问题的同时尽量不让它变得复杂。

```
(?!.*\.\.)(^[^\.][^@\s]+@[^@\s]+\.[^@\s\.]+$) 
```

它似乎正在工作（但我不是 RegEx-pert）。解决了用户从以句点结尾的句子末尾复制和粘贴电子邮件地址的问题。

即：这是我的新电子邮件地址 tabby@coolforcats.com。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-12T23:40:18.237

[任你选。](http://regexlib.com/Search.aspx?k=email)

这是符合[RFC 2822 第 3.4.1 节](https://www.rfc-editor.org/rfc/rfc2822#section-3.4.1)的...

```
(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\]) 
```

以防万一你好奇。:)

# iphone - 如何从 Xcode 4 中的断点操作打印字符串值？

> ID：742456
> 
> 赞同：21
> 
> 时间：2009-04-12T21:23:27.457
> 
> 标签：iphone, xcode, gdb, debugging

我有一个断点操作，并且正在使用下拉菜单中的 Log 选项。我想打印出字符串（摘要）值。我正在这样做：

```
the person name is: @p.name@ 
```

但这会打印内存地址。我可以切换到调试器命令选项并执行

```
po f.name 
```

但后来我失去了我的描述，就像第一个选项中使用的那样。使用 Log 选项，有没有办法打印字符串值而不是内存地址？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-07-28T11:17:23.677

您可以使用“调试器命令”将 NSLog 语句与断点一起使用，但您需要添加“expr”

```
expr (void)NSLog(@"The Person Name is %@", p.name) 
```

-

![在 Xcode 4.4 中使用带有调试器命令的 expr 命令作为断点](https://i.stack.imgur.com/oThH9.png)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-04-12T21:38:47.840

您可以做几件事。从下拉列表中添加一个 Log 函数，然后添加另一个框并选择`Debugger Command`并输入`po f.name`。

如果你想让你的日志更复杂，你可以做更多这样的事情：

```
the person name is: @(const char *)[(NSString*)[p.name description] UTF8String]@ 
```

您最好的选择可能是只使用调试器的图形界面来观察变量。如果要记录消息，请使用`NSLog`.

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-06-19T21:36:24.513

这是一个只使用一个动作的解决方案，并且使用的字符比`expr`解决方案少。

![使用 NSlog 的调试器命令](https://i.stack.imgur.com/ZIQXH.png)

但是，除非你添加`void`这样的：

```
po (void)NSLog(@"the person name is: %@", p.name) 
```

你会在你的日志中打印出一个恼人的“nil”。例如：

```
(lldb) po NSLog(@"foo")
 nil
2013-06-19 14:42:59.025 TheMove[95864:c07] foo

(lldb) po (void)NSLog(@"foo")
2013-06-19 14:43:10.758 TheMove[95864:c07] foo 
```

如果您可以忍受 nil（我可以），那么输入会更快并且更容易记住`po`

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-03-06T12:19:00.477

我最终对同一个断点使用了 2 个不同的操作。首先是一个日志，然后是一个带有 po varName 的调试器命令。唯一的缺点是它将打印在 2 个不同的行中。

![在此处输入图像描述](https://i.stack.imgur.com/Lx5Uo.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-11-03T09:38:13.937

您不需要在断点中执行**两个操作**，您可以只使用**一个**命令（日志消息），在其中放置包含变量内容的消息（见图）。通过单击“自动继续”，它就像在代码中有一个打印命令，但好在你的代码中没有打印语句。

[![在此处输入图像描述](https://i.stack.imgur.com/vHK1E.png)](https://i.stack.imgur.com/vHK1E.png)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-11-18T06:26:56.683

对于 Swift 和 Xcode 12.2，您可以双击断点并将`Debugger Command`其用作操作和命令，无论您通常在调试器上使用什么时间。

在示例中，我使用`po`字符串作为参数（以避免打印内存地址），其中包含我正在调试的值。我还启用`Automatically continue...`以避免停止执行。

[![在此处输入图像描述](https://i.stack.imgur.com/e0w3S.png)](https://i.stack.imgur.com/e0w3S.png)

您还可以添加其他文本或其他变量。

但是要记住，运行这些需要一些时间，因此对于时间很重要的操作，这些并不好。

# image - 如何知道浏览器中关闭图像的用户数量？

> ID：742462
> 
> 赞同：1
> 
> 时间：2009-04-12T21:30:39.733
> 
> 标签：image, browser

我正在开发一个非常受欢迎的网站，如果用户在浏览器设置中打开了“加载图像”选项，它看起来不错。

当您尝试使用“关闭图像”选项打开网站时，它变得不可用，许多组件将无法工作，因为用户不会看到“重要”按钮（我们不使用标准操作系统按钮）。

因此，我们无法理解和衡量此错误对业务的负面影响（缺少 alt/title 属性）。我们无法为此任务设置优先级 - 因为我们不知道有多少此类用户访问我们的网站。

请给我一些建议如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-12T21:32:29.867

在日志中查看您在页面上获得了多少点击，而没有来自浏览器的后续请求对其他图像。

当然，浏览器可能缓存了图像，因此请在*第一次*点击时查找。

您甚至可以为此使用 IP 地址，因为如果您丢弃了好的数据（即您忽略的新点击），也可以。问题是：在你*知道*的第一次点击中，有多少没有得到图像？

如果这是一个公共页面（即不是您登录的 Web 应用程序），也要尽可能忽略搜索引擎机器人；他们通常不会检索图像。

# shell - 如何反转文件中的行顺序？

> ID：742466
> 
> 赞同：752
> 
> 时间：2009-04-12T21:34:53.810
> 
> 标签：shell, unix, command-line

我想反转文本文件（或标准输入）中的行顺序，保留每行的内容。

所以，即，从：

```
foo
bar
baz 
```

我想结束

```
baz
bar
foo 
```

是否有一个标准的 UNIX 命令行实用程序来解决这个问题？

* * *

## 回答 #1

> 赞同：1582
> 
> 时间：2009-04-12T21:44:04.910

还值得一提：[`tac`](http://www.gnu.org/software/coreutils/manual/html_node/tac-invocation.html)（the, ahem, reverse of `cat`）。[核心实用程序](http://www.gnu.org/software/coreutils/)的一部分。

### 将一个文件翻转到另一个文件

```
tac a.txt > b.txt 
```

* * *

## 回答 #2

> 赞同：488
> 
> 时间：2009-04-12T21:36:30.437

BSD尾巴：

```
tail -r myfile.txt 
```

参考：[FreeBSD](https://www.freebsd.org/cgi/man.cgi?query=tail&apropos=0&sektion=1)、[NetBSD](http://netbsd.gw.com/cgi-bin/man-cgi?tail+1)、[OpenBSD](http://www.openbsd.org/cgi-bin/man.cgi/OpenBSD-current/man1/tail.1?query=tail&sec=1)和[OS X](https://developer.apple.com/library/mac/documentation/Darwin/Reference/ManPages/man1/tail.1.html)手册页。

* * *

## 回答 #3

> 赞同：177
> 
> 时间：2009-04-13T14:36:26.303

有[众所周知的 sed 技巧](http://web.archive.org/web/20090204080114/http://student.northpark.edu/pemente/sed/sed1line.txt)：

```
# reverse order of lines (emulates "tac")
# bug/feature in HHsed v1.5 causes blank lines to be deleted
sed '1!G;h;$!d'               # method 1
sed -n '1!G;h;$p'             # method 2 
```

（说明：在非初始行前添加保存缓冲区，交换行和保存缓冲区，在末尾打印行）

或者（以更快的执行速度）[从 awk one-liners](http://web.archive.org/web/20090208232311/http://student.northpark.edu/pemente/awk/awk1line.txt)：

```
awk '{a[i++]=$0} END {for (j=i-1; j>=0;) print a[j--] }' file* 
```

如果你记不住，

```
perl -e 'print reverse <>' 
```

在具有 GNU 实用程序的系统上，其他答案更简单，但并非全世界都是 GNU/Linux...

* * *

## 回答 #4

> 赞同：127
> 
> 时间：2018-08-08T10:24:20.230

在你的命令末尾放： `| tac`

tac 完全符合您的要求，它“将每个文件写入标准输出，最后一行先。”

tac 是 cat 的对立面 :-)。

* * *

## 回答 #5

> 赞同：67
> 
> 时间：2011-11-29T14:27:16.040

如果你碰巧在`vim`使用

```
:g/^/m0 
```

* * *

## 回答 #6

> 赞同：58
> 
> 时间：2017-07-20T04:39:04.737

```
tac <file_name> 
```

例子：

```
$ cat file1.txt
1
2
3
4
5

$ tac file1.txt
5
4
3
2
1 
```

* * *

## 回答 #7

> 赞同：44
> 
> 时间：2012-12-13T20:25:01.520

```
$ (tac 2> /dev/null || tail -r) 
```

Try `tac`，它适用于 Linux，如果不起作用，则使用`tail -r`，它适用于 BSD 和 OSX。

* * *

## 回答 #8

> 赞同：26
> 
> 时间：2009-05-06T18:35:58.127

尝试以下命令：

```
grep -n "" myfile.txt | sort -r -n | gawk -F : "{ print $2 }" 
```

* * *

## 回答 #9

> 赞同：18
> 
> 时间：2013-09-15T16:56:46.080

只是重击 :) (4.0+)

```
function print_reversed {
    local lines i
    readarray -t lines

    for (( i = ${#lines[@]}; i--; )); do
        printf '%s\n' "${lines[i]}"
    done
}

print_reversed < file 
```

* * *

## 回答 #10

> 赞同：12
> 
> 时间：2017-03-28T16:51:46.747

对于可能在 shell 脚本中使用的跨操作系统（即 OSX、Linux）解决方案，请使用`tac`上面其他人提到的自制软件，然后像这样使用别名 tac：

安装库

对于 MacOS

```
brew install coreutils 
```

对于 linux debian

```
sudo apt-get update
sudo apt-get install coreutils 
```

然后添加别名

```
echo "alias tac='gtac'" >> ~/.bash_aliases (or wherever you load aliases)
source ~/.bash_aliases
tac myfile.txt 
```

* * *

## 回答 #11

> 赞同：11
> 
> 时间：2012-10-08T03:11:11.953

我真的很喜欢“ *tail -r* ”的答案，但我最喜欢的 gawk 答案是......

```
gawk '{ L[n++] = $0 } 
  END { while(n--) 
        print L[n] }' file 
```

* * *

## 回答 #12

> 赞同：11
> 
> 时间：2015-01-20T17:33:05.563

最简单的方法是使用`tac`命令。`tac`是`cat`的倒数。例子：

```
$ cat order.txt
roger shah 
armin van buuren
fpga vhdl arduino c++ java gridgain
$ tac order.txt > inverted_file.txt
$ cat inverted_file.txt
fpga vhdl arduino c++ java gridgain
armin van buuren
roger shah 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2013-02-06T05:00:57.563

**编辑** 以下生成从 1 到 10 的随机排序的数字列表：

```
seq 1 10 | sort -R | tee /tmp/lst |cat <(cat /tmp/lst) <(echo '-------') **...** 
```

其中点被替换为反转列表的实际命令

**tac**

```
seq 1 10 | sort -R | tee /tmp/lst |cat <(cat /tmp/lst) <(echo '-------') \
<(tac) 
```

**python：在 sys.stdin 上使用 [::-1]**

```
seq 1 10 | sort -R | tee /tmp/lst |cat <(cat /tmp/lst) <(echo '-------') \
<(python -c "import sys; print(''.join(([line for line in sys.stdin])[::-1]))") 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2019-03-14T11:03:58.417

如果要就地修改文件，可以运行

```
sed -i '1!G;h;$!d' filename 
```

这消除了创建临时文件然后删除或重命名原始文件的需要，并且具有相同的结果。例如：

```
$tac file > file2
$sed -i '1!G;h;$!d' file
$diff file file2
$ 
```

基于[ehemient 的回答](https://stackoverflow.com/a/744093/42473)，它几乎但不完全是我想要的。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2018-01-21T01:48:04.680

这将适用于 BSD 和 GNU。

```
awk '{arr[i++]=$0} END {while (i>0) print arr[--i] }' filename 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2019-06-25T02:28:16.543

我看到了很多有趣的想法。但是试试我的想法。将您的文本输入：

> 转 | tr '\n' '~' | 转 | tr '~' '\n'

它假定字符“~”不在文件中。这应该适用于可以追溯到 1961 年的每个 UNIX shell。或者类似的东西。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2019-02-24T13:41:39.967

对于 Emacs 用户：（`C-x h`选择整个文件）然后`M-x reverse-region`. 也适用于仅选择零件或线条并恢复它们。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2020-03-19T16:03:40.570

我碰巧想有效地获取`n`一个非常大的文本文件**的**最后几行。

我尝试的第一件事是`tail -n 10000000 file.txt > ans.txt`，但我发现它非常慢，因为`tail`必须寻找到该位置然后返回打印结果。

当我意识到这一点时，我切换到另一个解决方案：`tac file.txt | head -n 10000000 > ans.txt`. 这一次，seek 位置只需要从末端移动到想要的位置，**就可以节省 50% 的时间**！

带回家留言：

**`tac file.txt | head -n n`如果您`tail`没有`-r`选项，请使用。**

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2020-08-08T15:22:59.997

您可以在命令行上使用 Perl：

`perl -e 'my @b=(); while(<>) {push(@b, $_);}; print join("", reverse(@b));' orig > rev`

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2016-04-19T08:45:58.193

我有同样的问题，但我也希望第一行（标题）保持在最前面。所以我需要使用 awk 的力量

```
cat dax-weekly.csv | awk '1 { last = NR; line[last] = $0; } END { print line[1]; for (i = last; i > 1; i--) { print line[i]; } }' 
```

PS 也适用于 cygwin 或 gitbash

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2016-12-01T00:44:34.717

最佳解决方案：

```
tail -n20 file.txt | tac 
```

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2018-05-11T19:36:40.313

你可以用`vim` `stdin`和来做`stdout`。您也可以使用`ex`POSIX [compliant](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/ex.html)。`vim`只是视觉模式`ex`。实际上，您可以使用`ex`with `vim -e`or `vim -E`（改进`ex`模式）。 `vim`很有用，因为与像`sed`它这样的工具不同，它缓冲文件以进行编辑，而`sed`用于流。您可能可以使用`awk`，但您必须手动缓冲变量中的所有内容。

想法是执行以下操作：

1.  从标准输入读取
2.  对于每一行，将其移至第 1 行（反转）。命令是`g/^/m0`. 这意味着全局，对于每一行`g`；匹配行的开头，它匹配任何东西`^`；将其移到地址 0 之后，即第 1 行`m0`。
3.  打印一切。命令是`%p`. 这意味着所有行的范围`%`；打印线`p`。
4.  强制退出而不保存文件。命令是`q!`. 这意味着退出`q`；强行`!`。

```
# Generate a newline delimited sequence of 1 to 10
$ seq 10
1
2
3
4
5
6
7
8
9
10

# Use - to read from stdin.
# vim has a delay and annoying 'Vim: Reading from stdin...' output
# if you use - to read from stdin. Use --not-a-term to hide output.
# --not-a-term requires vim 8.0.1308 (Nov 2017)
# Use -E for improved ex mode. -e would work here too since I'm not
# using any improved ex mode features.
# each of the commands I explained above are specified with a + sign
# and are run sequentially.
$ seq 10 | vim - --not-a-term -Es +'g/^/m0' +'%p' +'q!'
10
9
8
7
6
5
4
3
2
1
# non improved ex mode works here too, -e.
$ seq 10 | vim - --not-a-term -es +'g/^/m0' +'%p' +'q!'

# If you don't have --not-a-term, use /dev/stdin
seq 10 | vim -E +'g/^/m0' +'%p' +'q!' /dev/stdin

# POSIX compliant (maybe)
# POSIX compliant ex doesn't allow using + sign to specify commands.
# It also might not allow running multiple commands sequentially.
# The docs say "Implementations may support more than a single -c"
# If yours does support multiple -c
$ seq 10 | ex -c "execute -c 'g/^/m0' -c '%p' -c 'q!' /dev/stdin

# If not, you can chain them with the bar, |. This is same as shell
# piping. It's more like shell semi-colon, ;.
# The g command consumes the |, so you can use execute to prevent that.
# Not sure if execute and | is POSIX compliant.
seq 10 | ex -c "execute 'g/^/m0' | %p | q!" /dev/stdin 
```

* * *

**如何使这个可重复使用**

我使用我调用的脚本`ved`（类似 vim 编辑器`sed`）使用 vim 来编辑`stdin`. `ved`将此添加到路径中调用的文件中：

```
#!/usr/bin/env sh

vim - --not-a-term -Es "$@" +'%p | q!' 
```

我使用一个`+`命令而不是`+'%p' +'q!'`，因为 vim 将您限制为 10 个命令。所以合并它们允许`"$@"`有 9 个`+`命令而不是 8 个。

然后你可以这样做：

```
seq 10 | ved +'g/^/m0' 
```

如果您没有 vim 8，请将其放入`ved`：

```
#!/usr/bin/env sh

vim -E "$@" +'%p | q!' /dev/stdin 
```

* * *

## 回答 #23

> 赞同：-6
> 
> 时间：2018-06-15T22:28:14.723

**tail -r**适用于大多数 Linux 和 MacOS 系统

序列 1 20 | 尾 -r

* * *

## 回答 #24

> 赞同：-6
> 
> 时间：2020-05-19T14:00:46.420

```
rev
text here 
```

或者

```
rev <file> 
```

或者

```
rev texthere 
```

* * *

## 回答 #25

> 赞同：-9
> 
> 时间：2016-04-21T21:48:05.077

```
sort -r < filename 
```

或者

```
rev < filename 
```

# windows - Windows Scheme/Lisp 实现

> ID：742482
> 
> 赞同：18
> 
> 时间：2009-04-12T21:41:22.233
> 
> 标签：windows, scheme, 64-bit, lisp

有成千上万的 LISP 和 Scheme 实现可用，我很难找到合适的用于 Windows 开发的实现。我在学校学习了这些语言，发现它们非常优雅，但是，除了在学术环境中之外，我似乎无法找到适合开发代码的实现。

什么是具有以下要求的 Scheme 或 LISP 实现？

编译为本机代码，而不是编译为 C。

支持多处理器上的多线程（即多个线程可以同时运行）。

生成 64 位代码。

无需 Cygwin 即可在 Windows 中使用。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-12T23:00:29.860

[Corman Lisp](http://www.cormanlisp.com/)可能很有趣，但不支持 64 位代码 (AFAIK)。

[Clozure CL](http://trac.clozure.com/openmcl)刚刚移植到 Windows 上，所以它可能还不是很成熟，还缺少一些东西。

[LispWorks](http://www.lispworks.com)和[Allegro CL](http://www.franz.com)很棒，尽管它们不支持多个并发 Lisp 线程。目前 LispWorks 6 正在开发中，它将支持多个并发的 Lisp 线程。但请注意，例如 LispWorks 当前可以在任何时候运行单个 Lisp 线程，但可以运行多个外部线程。

Dan Weinreb[对 Common Lisp 实现进行了调查](http://common-lisp.net/~dlw/LispSurvey.html)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-12T21:54:39.690

大型商业 Common Lisp 实现应该满足您的所有标准：

[LispWorks](http://www.lispworks.com/)和[Allegro CL](http://www.franz.com/)。

一个相当完整、可用且免费的 Scheme 实现是[Racket](http://racket-lang.org/)（以前称为 PLT Scheme）。

免费的[Clozure CL](http://www.clozure.com/clozurecl.html)也可能满足您的需求。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-12T22:16:57.390

我非常喜欢 Clozure。MIT Scheme 将在 Windows 下运行，对于初学者来说它是一个不错的选择，因为它将与 The Book 最匹配。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-13T12:06:50.077

Clozure CL 正在将其 1.3 版本移植到 32 位和 64 位窗口上。

当我键入此内容时，该 1.3 版本位于 RC1。

提供的示例通过 FFI 使用本机 Win32 API 调用来显示传统的 Win32 窗口，并带有消息循环等。

Hunchentoot 网络服务器适用于当前版本。

它支持 Unicode，因此与“W”Win32 API 的接口应该很简单。

它编译为本机代码，支持本机线程并且不需要 cygwin。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-13T09:43:44.027

似乎缺少 ECL。这是一个非常好的 CL 实现，可以在 Windows、Linux 和 Mac 上运行，支持所有平台上的本地线程并允许创建二进制文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-12T22:08:05.460

这是如何在 Windows XP 上使用 Emacs 和 Slime 安装 Lisp 的精彩描述：

[http://www.pchristensen.com/blog/articles/installing-sbcl-emacs-and-slime-on-windows-xp/](http://www.pchristensen.com/blog/articles/installing-sbcl-emacs-and-slime-on-windows-xp/)

# jquery - jQuery：提交表单时的操作？

> ID：742486
> 
> 赞同：0
> 
> 时间：2009-04-12T21:44:07.873
> 
> 标签：jquery

这是我的问题：我有一个可选的 div 网格，这些网格与唯一的类别 ID 相关联

我可能会重新编写网格以在选择隐藏输入时使用它们，但这有点晚了。

提交表单时（标准表单..没有 ajax），我想将选定的 ID 收集到一个变量中。当我使用标准按钮和警报框进行测试时，下面的代码可以工作：

```
parentUID = "";
$('.cat_grid').each(function() {
  cat_parent = $(this).parent();
  if (cat_parent.attr('class')=="on") {
    parentUID += $(this).attr('id')+";";
  }
}); 
```

但是如何在单击提交按钮时触发此事件？我假设将 parentUID 插入隐藏的表单输入并使用某种延迟功能？

感谢您的任何回答！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-12T21:53:10.740

怎么样：

```
 $(form).submit( function() {
   var parentUID = "";
   $('.cat_grid').each(function() {
    cat_parent = $(this).parent();
    if (cat_parent.attr('class')=="on") {
     parentUID += $(this).attr('id')+";";
    }
  });
  $(hiddenInput).val( parentUID );
  //don't return false because we wan't the form to be submitted
 }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-12T22:00:02.360

您可以在表单上使用 onSubmit 并使用您拥有的代码调用函数 GetParentUIDs()，并将 ID 存储在隐藏字段中。您的 GetParentUID 必须返回 true 才能提交表单。

例子

```
<form name="yourform" action="youraction" method="post" onsubmit="return GetParentUIDs();"> 
```

# algorithm - 熵重包装

> ID：742492
> 
> 赞同：2
> 
> 时间：2009-04-12T21:45:57.947
> 
> 标签：algorithm

我一直在折腾机器的概念性想法（如在图灵机中），**我想知道是否已经在这个或相关主题上完成了任何工作。**

这个想法是一台机器，它采用熵流并在任何范围内发出随机符号而不会丢失任何熵。

我认为这是一个远非严格的描述，所以我将举一个例子：假设我有一个随机符号生成器，范围为`1`to `n`，我希望能够在任何给定范围内请求一个符号，`1`首先`12`然后`1`到`1234`. （为了使其可行，我将只考虑确定性机器，在这些机器中，给定相同的输入流和请求，它总是会给出相同的输出。）一个必要的约束是输出至少包含与输入一样多的熵。然而，我最感兴趣的限制是机器只读取和吐出一样多的熵。

例如，如果询问范围内的令牌，`1`它`S1, S2, S3, ... Sm`只会消耗`ceiling(sum(i = 1 to m, log(Si))/log(n))`输入令牌。

[这个问题](https://stackoverflow.com/questions/137783/given-a-function-which-produces-a-random-integer-in-the-range-1-to-5-write-a-fun)询问如何在满足第一个约束的同时进行这种转换，但在第二个约束上做得非常糟糕。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T01:46:45.560

好的，我仍然不确定我是否按照您的要求进行操作。听起来你想要一个功能

> *f* : I → O

其中输入是字母表*I* ={1.. *n* } 上的强随机（均匀分布等）符号序列。（所以一系列随机自然数 ≤ *n*。）输出是 O={1.. *m* } 上的另一个序列，您希望该序列具有与输入一样多的熵。

好的，如果我做对了，首先，如果*m < n*，你不能。如果*m < n*则 lg *m* < lg *n*，则输出符号集的熵更小。

如果*m* ≥ *n*，那么您只需选择{1.. *m* }的第*i^(个元素即可轻松完成。)*熵将是相同的，因为可能的输出符号的数量是相同的。*但是，从均匀分布在整个集合 {1.. m* }的意义上讲，它们不会是“随机的” ，因为必然（鸽笼原则）根本不会选择某些符号。

 **另一方面，如果您对 {1.. *m* } 上的随机序列感到满意，那么您可以通过使用来自随机源的输入作为种子来选择适当的伪随机数生成器来实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-13T03:31:54.030

我目前的通行证：

通过添加以下限制：您提前知道范围序列是 {S1, S2, S3, ..., Sn}，而不是使用非常量碱基的碱基翻译可能会起作用：

1.  寻找`Sp = S1 * S2 * S3 * ... * Sn`
2.  `m=cealing(log(Sp)/log(n))`从输入中提取术语`{R1, R2, R3, ..., Rm}`
3.  寻找`X = R1 + R2*n + R3*n^2 + ... + Rm*n^(m-1)`
4.  改革`X`在`O1 + S1*O2 + S1*S2*O3 + ... Sn*On + x`哪里`1 <= Oi <= Si`

通过将 x 推回到输入流中，这可能可以重新转换为一次只适用于一个值的解决方案。但是我无法说服自己，即使是已知的输出范围形式也是合理的，所以......

# python - 代码在全局范围内有效，但在本地范围内无效？

> ID：742496
> 
> 赞同：0
> 
> 时间：2009-04-12T21:50:15.363
> 
> 标签：python

这个函数应该返回 36，但它返回 0。如果我在交互模式下逐行运行逻辑，我会得到 36。

代码

```
from math import *

line = ((2, 5), (4, -1))
point = (6, 11)

def cross(line, point):
    #reference: http://www.topcoder.com/tc?module=Static&d1=tutorials&d2=geometry1
    ab = ac = [None, None]
    ab[0] = line[1][0] - line[0][0]
    ab[1] = line[1][1] - line[0][1]
    print ab
    ac[0] = point[0] - line[0][0]
    ac[1] = point[1] - line[0][1]
    print ac
    step1 = ab[0] * ac[1] 
    print step1
    step2 = ab[1] * ac[0]
    print step2
    step3 = step1 - step2
    print step3
    return float(value)

cross(line, point) 
```

输出

```
[2, -6] # ab
[4, 6]  #ac
24      #step 1 (Should be 12)
24      #step 2 (Should be -24)
0       #step 3 (Should be 36) 
```

根据交互模式，这应该是 step1、step2 和 step3 的结果

```
>>> ab = [2, -6]
>>> ac = [4, 6]
>>> step1 = ab[0] * ac[1]
>>> step1
12
>>> step2 = ab[1] * ac[0]
>>> step2
-24
>>> step3 = step1 - step2
>>> step3
36 
```

（如果有人能给这个标题起个好名字就好了）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-12T21:57:27.123

你有 ab 和 ac 指向同一个引用。改变这个：

```
ab = ac = [None, None] 
```

对此：

```
ab = [None, None]
ac = [None, None] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-12T21:58:38.947

在该行`ab = ac = [None, None]`中，您将**相同的列表**分配给变量 ab 和 ac。当你改变一个时，你同时改变了另一个。

它以交互方式工作的原因是您不会以相同的方式初始化列表。

用这个交换函数中的第一行：

```
ab = [None, None]
ac = [None, None] 
```

# c# - yield 语句实现

> ID：742497
> 
> 赞同：9
> 
> 时间：2009-04-12T21:50:24.927
> 
> 标签：c#, .net, yield, iterator

我想以易于理解的形式了解有关该声明的*所有信息。*`yield`

我已经阅读了该`yield`语句及其在实现迭代器模式时的易用性。但是，大部分都非常干燥。我想深入了解一下微软如何处理收益率。

另外，你什么时候使用yield break？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-12T21:53:38.630

`yield`通过在内部构建状态机来工作。它会在例程退出时存储该例程的当前状态，并在下一次从该状态恢复。

您可以使用 Reflector 查看编译器是如何实现的。

`yield break`当您想停止返回结果时使用。如果您没有`yield break`，编译器会在函数末尾假定一个（就像`return;`普通函数中的语句一样）

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-12T21:56:01.170

正如 Mehrdad 所说，它构建了一个状态机。

除了使用反射器（另一个很好的建议），您可能会发现[我关于迭代器块实现的文章](http://csharpindepth.com/Articles/Chapter6/IteratorBlockImplementation.aspx)很有用。如果不是块，它会*相对*`finally`简单- 但它们引入了一个额外的复杂维度！

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2019-01-12T19:46:56.143

让我们稍微回顾一下：`yield`关键字被翻译成许多其他人所说的状态机。

实际上，这并不完全像使用将在幕后使用的内置实现，而是编译器`yield`通过实现一个相关接口（包含`yield`关键字的方法的返回类型）将相关代码重写为状态机。

（有限）[状态机](https://en.wikipedia.org/wiki/Finite-state_machine)只是一段代码，取决于您在代码中的位置（取决于先前的状态，输入）转到另一个状态操作，这几乎就是您使用和 yield 时发生的事情方法返回类型为`IEnumerator<T>`/ `IEnumerator`。`yield`关键字是要创建另一个动作以从前一个状态移动到下一个状态的内容，因此在实现中创建状态管理`MoveNext()`。

这正是 C# 编译器 / Roslyn 要做的事情：检查关键字的存在以及包含方法的返回类型，`yield`无论是`IEnumerator<T>`,还是然后创建一个反映该方法的私有类，集成必要的变量和状态。`IEnumerable<T>``IEnumerator``IEnumerable`

如果您对状态机以及编译器如何重写迭代的详细信息感兴趣，可以在 Github 上查看这些链接：

*   [`IteratorRewriter`源代码](https://github.com/dotnet/roslyn/blob/master/src/Compilers/CSharp/Portable/Lowering/IteratorRewriter/IteratorRewriter.cs)
*   [`StateMachineRewriter`: 上面源码的父类](https://github.com/dotnet/roslyn/blob/8d00d4fb2b9d362740222120106ea1ba1edec0df/src/Compilers/CSharp/Portable/Lowering/StateMachineRewriter/StateMachineRewriter.cs)

**琐事1**：（[`AsyncRewriter`](https://github.com/dotnet/roslyn/blob/66c6a7d34d5ca96e8c08120d686203cdbc1b7714/src/Compilers/CSharp/Portable/Lowering/AsyncRewriter/AsyncRewriter.cs)在您编写`async`/`await`代码时使用也继承自，`StateMachineRewriter`因为它还利用了背后的状态机。

如前所述，状态机很大程度上反映在`bool MoveNext()`生成的实现中，其中有一个`switch`+ 有时是一些老式`goto`的基于状态字段的，它表示方法中不同状态的不同执行路径。

编译器从用户代码生成的代码看起来并不那么“好”，主要是因为编译器在这里和那里添加了一些奇怪的前缀和后缀

例如，代码：

```
public class TestClass 
{
    private int _iAmAHere = 0;

    public IEnumerator<int> DoSomething()
    {
        var start = 1;
        var stop = 42;
        var breakCondition = 34;
        var exceptionCondition = 41;
        var multiplier = 2;
        // Rest of the code... with some yield keywords somewhere below... 
```

与上面那段代码相关的变量和类型在编译后将如下所示：

```
public class TestClass
{
    [CompilerGenerated]
    private sealed class <DoSomething>d__1 : IEnumerator<int>, IDisposable, IEnumerator
    {
        // Always present
        private int <>1__state;
        private int <>2__current;

        // Containing class
        public TestClass <>4__this;

        private int <start>5__1;
        private int <stop>5__2;
        private int <breakCondition>5__3;
        private int <exceptionCondition>5__4;
        private int <multiplier>5__5; 
```

关于状态机本身，让我们看一个非常简单的例子，它有一个虚拟分支来产生一些偶数/奇数的东西。

```
public class Example
{
    public IEnumerator<string> DoSomething()
    {
        const int start = 1;
        const int stop = 42;

        for (var index = start; index < stop; index++)
        {
            yield return index % 2 == 0 ? "even" : "odd";
        }
    }
} 
```

将被翻译`MoveNext`为：

```
private bool MoveNext()
{
    switch (<>1__state)
    {
        default:
            return false;
        case 0:
            <>1__state = -1;
            <start>5__1 = 1;
            <stop>5__2 = 42;
            <index>5__3 = <start>5__1;
            break;
        case 1:
            <>1__state = -1;
            goto IL_0094;
        case 2:
            {
                <>1__state = -1;
                goto IL_0094;
            }
            IL_0094:
            <index>5__3++;
            break;
    }
    if (<index>5__3 < <stop>5__2)
    {
        if (<index>5__3 % 2 == 0)
        {
            <>2__current = "even";
            <>1__state = 1;
            return true;
        }
        <>2__current = "odd";
        <>1__state = 2;
        return true;
    }
    return false;
} 
```

正如你所看到的，这个实现远非简单，但它确实完成了工作！

**琐事 2**：`IEnumerable`/`IEnumerable<T>`方法返回类型会发生什么？
好吧，它不仅会生成一个实现 的类`IEnumerator<T>`，它还会生成一个既实现又实现的类，`IEnumerable<T>`以便`IEnumerator<T>`实现 的实现`IEnumerator<T> GetEnumerator()`将利用相同的生成类。

温馨提示：使用`yield`关键字自动实现的几个接口：

```
public interface IEnumerable<out T> : IEnumerable
{
    new IEnumerator<T> GetEnumerator();
}

public interface IEnumerator<out T> : IDisposable, IEnumerator
{
    T Current { get; }
}

public interface IEnumerator
{
    bool MoveNext();

    object Current { get; }

    void Reset();
} 
```

您还可以使用不同的路径/分支以及编译器重写的完整实现来查看[此示例。](https://gist.github.com/mary-perret-1986/041df0e8b6e618ae9ac80b5170a31198)

这是使用[SharpLab](https://sharplab.io)创建的，您可以使用该工具尝试不同的`yield`相关执行路径，并查看编译器如何将它们重写为`MoveNext`实现中的状态机。

关于问题的第二部分，即，`yield break`已在[此处回答](https://stackoverflow.com/a/231945/4636721)

> 它指定迭代器已经结束。您可以将 yield break 视为不返回值的 return 语句。

# sql-server - 请任何人都可以解释如何阅读 SQL Server 中执行不佳的查询的执行计划？

> ID：742499
> 
> 赞同：1
> 
> 时间：2009-04-12T21:52:15.157
> 
> 标签：sql-server, performance

请任何人都可以解释如何阅读 SQL Server 中执行不佳的查询的执行计划？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T08:18:18.787

查看网络上有关执行计划的许多资源，例如：

*   [执行计划基础](http://www.simple-talk.com/sql/performance/execution-plan-basics/)
*   [简单查询的图形执行计划](http://www.simple-talk.com/sql/performance/graphical-execution-plans-for-simple-sql-queries/)

访问[http://www.simple-talk.com](http://www.simple-talk.com)并搜索执行计划——还有更多的文章和示例，甚至还有一本关于执行计划的免费电子书。

马克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-12T21:55:25.023

*   看图；它是一个数据流图，显示了正在执行的基本操作（索引扫描、表扫描、哈希表合并等）
*   找到百分比最高的部分
*   想想你可以做些什么来优化那个操作（提示：“添加索引”是最常见的解决方案）

如有必要，请在此处发布具体问题

# user-interface - 图标是否应该根据所选的背景颜色自行更改？

> ID：742502
> 
> 赞同：1
> 
> 时间：2009-04-12T21:54:27.273
> 
> 标签：user-interface, icons

要求桌面图标更改颜色以“很好地适应”用户选择的桌面颜色。这不仅是一个模糊的要求，而且不是应用程序行为的标准方式。正确的解决方案是提供一些可供用户选择的图标。我只是认为这是一个坏主意。我们仍处于需求阶段，我觉得我正在变得敌对。标准实践的存在是有原因的，但我即将失去冷静，因为 300 项要求中有 15% 属于这一类。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-12T21:59:51.127

1.  通过将其放在“很高兴”列表中来推迟争论（这将永远不会实现，因为它不会对功能添加任何内容并产生不成比例的配置问题）并专注于实际做重要事情的真实功能
2.  建议使用透明图标，使其与桌面颜色完全融合（看看他们是否意识到它是不可见的！）
3.  给出一个很长的清单，说明为什么这个功能很荒谬，制造敌人，让客户/经理觉得自己很愚蠢……不推荐

请记住，您可能正在与那些*善意*但在技术上*不太了解的人打交道。*说“这是一个有趣的想法”来验证他们的感觉/输入/存在，然后继续做更​​重要的事情。;-)

# sql - 带有if语句的sql查询

> ID：742508
> 
> 赞同：3
> 
> 时间：2009-04-12T21:57:17.907
> 
> 标签：sql, mysql, conditional

我正在尝试提出一个查询来报告收入。它将需要 2 个表格：clicks 和 offer。收入的计算方法是转化次数 * 优惠的佣金。转化存储在点击表中名为“conversionDate”的字段中，每个报价的佣金存储在报价表中。

查询中需要有一个条件，以在为优惠加总收入时忽略任何未转化的点击（意味着conversionDate 为NULL）。

我需要进行一些调整，因为它没有给出正确的收入值：

SELECT o.name offer, count(c.id) clicks, if(not isnull(c.conversionDate),income=revenue+o.commission,income)income FROM clicks c, offer o where c.offerID=o.ID GROUP通过 o.ID;

我现在有 3 条虚拟点击记录，其中 2 条是转化。将佣金设置为 1，收入应该是 2。我得到的结果是 1。我是否走在正确的轨道上，或者收入计算应该是某种子查询还是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-12T23:38:31.327

我会这样写查询：

```
SELECT o.name AS offer, COUNT(c.id) AS clicks, 
  SUM( IF(c.conversionDate IS NOT NULL, o.commission, NULL) ) AS revenue 
FROM offers o JOIN clicks c ON (c.offerID=o.ID)
GROUP BY o.ID; 
```

这是另一种解决方案，但没有*任何*转化点击的商品不会显示在查询结果中：

```
SELECT o.name AS offer, COUNT(c.id) AS clicks, 
  SUM(o.commission) AS revenue 
FROM offers o JOIN clicks c 
  ON (c.offerID=o.ID AND c.conversionDate IS NOT NULL)
GROUP BY o.ID; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-12T22:01:09.613

将空检查移至 WHERE 子句

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-12T22:03:31.073

试试这个查询：

```
SELECT o.name offer, COUNT(c.id) clicks, IF(c.conversionDate IS NULL, revenue + o.commission, revenue) revenue
FROM clicks c, offers o
WHERE c.offerID=o.ID
GROUP BY o.ID; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-12T23:01:07.987

```
SELECT o.name offer, count(*) clicks, (COUNT(c.ID) * o.commission) revenue
FROM clicks c, offers o
WHERE c.ConversionDate is not null and c.offerID=o.ID
GROUP BY o.ID, o.name, o.commission; 
```

# jquery - 使用jquery切换身体背景？

> ID：742514
> 
> 赞同：0
> 
> 时间：2009-04-12T22:00:02.500
> 
> 标签：jquery, cookies

我想使用 jquery 制作一个身体背景切换器。你会有一些按钮，每个按钮都会根据你的选择改变身体 bg。我想让它保存一个cookie，以便在您更改页面时它可以检索用户的选择。

第一部分我使用 .addclass 或 .css 得到它，但我被困在 svaing 用户的选择部分。

（对不起我的英语不好）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-13T09:02:56.293

还可以查看 jQuery 的[Cookie 插件](http://plugins.jquery.com/project/Cookie)，它允许您执行以下操作：

```
$.cookie('the_cookie', 'the_value'); // Create a session cookie ("the_cookie") and set its value to "the_value"
$.cookie('chocolate_chip_cookie', 'the_value', { // create a cookie with all available options
    expires: 7, // expires in seven days
    path: '/', // accessible from the whole site...
    domain: 'jquery.com',
    secure: true // ...but only on a https connection
});
$.cookie('the_cookie', null); // delete the session cookie 
```

# iphone - iPhone + JSON + 反射

> ID：742521
> 
> 赞同：5
> 
> 时间：2009-04-12T22:05:57.603
> 
> 标签：iphone, objective-c, cocoa, json, reflection

我正在用 JSON 编写一个 iphone 应用程序，并试图将 JSON 字符串转换为对象（不是字典或数组）。

在 Java 中，多亏了反射，我可以轻松地将 JSON 转换为 javabean 实例，如下所示：

```
import net.sf.json.JSONObject;
class MyBean {
    private String property;
    public String getProperty() { return property; }
    public void setProperty(String property) { this.property=property; }
}

// turn JSON string into a MyBean instance
String str = "{\"property\":\"some value\"}";  
JSONObject jsonObject = (JSONObject) JSONSerializer.toJSON( str );
JsonConfig jsonConfig = new JsonConfig();
jsonConfig.setRootClass( MyBean.class );
MyBean instance = (MyBean) JSONSerializer.toJava( jsonObject, jsonConfig ); 
```

我想知道这在objective-c中是否可行。我目前正在使用[这个](http://code.google.com/p/json-framework/)JSON 框架，但如果需要，我愿意切换。

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-13T03:52:47.410

有一个开源项目称为[objectiveresource](http://github.com/yfactorial/objectiveresource/tree/master)和[objectivesupport](http://github.com/yfactorial/objectivesupport/tree/master)。它们是 Ruby 和 RESTful 开发世界中所谓的 ActiveResource 和 ActiveSupport 的部分 Objective-C 实现。Objectivesupport 所做的部分工作是序列化和反序列化 JSON（以及 XML）对象。如果您不想按原样使用完整的框架，您可以查看objectivesupport 的源代码，在那里您将看到它们对NSObject 进行序列化的实现。下面列出了您要查看的具体代码：（基本上实现为 NSObject、NSArray 和 NSDictionary 类型上的类别） [http://github.com/yfactorial/objectivesupport/tree/d08b5be6c0f7a2b0196b6ec17e4441bb146c4e23/Classes/lib/Serialization/JSON](http://github.com/yfactorial/objectivesupport/tree/d08b5be6c0f7a2b0196b6ec17e4441bb146c4e23/Classes/lib/Serialization/JSON)

顺便说一句，他们似乎正在使用您正在使用的相同[JSON 框架的一个分支。](http://code.google.com/p/json-framework/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-12T22:17:21.133

也许看看[Objective-C 运行时参考](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/ObjCRuntimeRef/Reference/reference.html)可以帮助你！

有一些功能（如`class_createInstance`和`object_setInstanceVariable`）可以帮助您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-17T23:30:30.920

以防万一其他人在寻找这个问题的答案时来到这里，还有另一个项目正是您正在寻找的东西：iPhone 的 JSON，仅此而已。

[看看这里](http://code.google.com/p/json-framework/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-12-29T04:49:40.517

您可能想查看我的实现，以将 JSON 序列化和反序列化为 NSObjects，反之亦然。- [https://github.com/mahadevans87/OBJC_JSONSerializer](https://github.com/mahadevans87/OBJC_JSONSerializer)

# apache-flex - Flex Builder Profiling: can you programmatically start/stop profiling?

> ID：742526
> 
> 赞同：0
> 
> 时间：2009-04-12T22:10:16.657
> 
> 标签：apache-flex, flash, profiling

I just got Flex Builder Professional for the profiling support, and although I can make the profiler work, I am having trouble isolating samples to just a section of my code. Trying to click "clear profiling data" and "stop collecting" in the UI just isn't cutting it.

I'd like to be able to, in my code, do something like:

startProfiling(); // do stuff stopProfiling();

and have that "snapshot" of profiling data visible in the UI.

I can't find any information on this online at all. I know about flash.sampler.* but I don't know how to make flex builder and flash.sampler talk to each other.

This is a pretty routine way to trigger profiler data collection, and I am very frustrated trying to find a solution and hoping someone else has already figured it out.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-24T03:11:04.033

所以你检查了 flash.sampler API？当您连接分析器时，它可能会自动调用 startSampling。您是否尝试过从您的应用程序调用 pauseSampling，然后在您只想收集您的东西时调用 startSampling？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T13:52:31.807

I don't believe this is possible. The profile in flex is like the debugger. You have to hook up to a specific instance of it and profile the application from start to finish. Here is a link that talks more about the Flex 3 profiler and might give you some more information on a different way to achieve what you are looking for.

[http://labs.adobe.com/wiki/index.php/Flex_3:Feature_Introductions:_Performance_and_Memory_Profiling](http://labs.adobe.com/wiki/index.php/Flex_3:Feature_Introductions:_Performance_and_Memory_Profiling)

# sql-server - What are the differences between a Differential Change Map and a Bulk Change Map?

> ID：742528
> 
> 赞同：0
> 
> 时间：2009-04-12T22:12:31.643
> 
> 标签：sql-server

What is the difference between a Differential Change Map and a Bulk Change Map?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T02:58:53.000

以下 MSDN 文章定义了这些 SQL Server 页面类型：

[SQL Server 2008 联机丛书：了解页面和范围](http://msdn.microsoft.com/en-us/library/ms190969.aspx)

> **批量更改地图**
> 
> 关于自每个分配单元的最后一个 BACKUP LOG 语句以来批量操作修改的范围的信息。
> 
> **微分变化图**
> 
> 自每个分配单元的最后一个 BACKUP DATABASE 语句以来已更改的范围的信息。

# ruby-on-rails - Rails 嵌套对象形式 *_attributes

> ID：742536
> 
> 赞同：6
> 
> 时间：2009-04-12T22:21:28.283
> 
> 标签：ruby-on-rails, nested-forms

我正在使用 Rails 2.3.2，并试图让嵌套对象表单正常工作。我已将我的问题缩小到 Rails 没有使用启动 accept_nested_attributes_for 处理所需的 *_attributes 设置嵌套表单元素的问题。

我的模型代码是：

```
class Person < Party
  has_one :name, :class_name => "PersonName"
  accepts_nested_attributes_for :name, :allow_destroy => true
end

class PersonName < ActiveRecord::Base
  belongs_to :person
end 
```

我的视图代码如下所示（我正在使用 HAML）：

```
%h3 New customer
= error_messages_for :person, :person_name, :name, :country

- form_for :person, :url => collection_url, :html => {:class => 'MainForm'} do |person_form|

  - @person.build_name unless @person.name
  - person_form.fields_for :name do |name_form|
    = name_form.label :given_name, "First Name:"
    = name_form.text_field :given_name

    = name_form.label :family_name, "Last Name:"
    = name_form.text_field :family_name

  = hidden_field_tag :inviter_id, params[:inviter_id]
  = hidden_field_tag :inviter_code, params[:inviter_code]
  %p= submit_tag "Create"

= link_to 'Back', collection_url 
```

而不是 params 是：

```
{"person"=>{"name_attributes"=>{"given_name"=>"Fred", "family_name"=>"Flintstone"}}, ...} 
```

我得到：

```
{"person"=>{"name"=>{"given_name"=>"Fred", "family_name"=>"Flintstone"}}, ...} 
```

结果，我得到了一个 TypeMismatch 异常。我遵循了[Ryan Daigle](http://ryandaigle.com/articles/2009/2/1/what-s-new-in-edge-rails-nested-attributes)的文档。我也遵循了[这个博客](http://www.pixellatedvisions.com/2009/03/18/rails-2-3-nested-model-forms-and-nil-new-record)和[complex-forms-example](https://github.com/ryanb/complex-form-examples/tree)的建议。

使用 Firebug，我浏览了我的表单并将输入标签的名称属性从名称调整为 name_attributes。这产生了具有 name_attributes 的参数，并且创建工作正常。

我被困住了，因为我无法弄清楚为什么我的表单没有生成名称的 *_attributes 形式。

我尝试的另一件事是我让 complex_form_example 在我的环境中工作。我浏览了控制器、模型和视图的每一寸，并将其与我的代码进行了比较。我找不到有什么不同。我知道这是一件小事，如果有任何帮助，我将不胜感激！

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-24T09:58:11.870

尝试对 form_for 使用实际对象：

```
form_for :person => form_for @person 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-07-16T06:50:16.513

回帖没有被路由到正确的地方

```
def new
  @person = Person.new
end

<% form_for @person do |f| %>
    <% f.fields_for :name_attributes do |p| %>
        ...
    <% end %>
<% end %> 
```

回帖被路由到正确的地方

```
def new
  @person = Person.new
  @person.name = PersonName.new # << this allows fields_for :relation vs :relation_attributes
end

<% form_for @person do |f| %>
    <% f.fields_for :name do |p| %>
        ...
    <% end %>
<% end %> 
```

无需在#create 中再次@person.name

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-19T16:29:42.473

我刚刚为完全相同的问题苦苦挣扎了大约一个小时！

按照 nowk 的模式在控制器中使用新方法，然后将其放在您的视图中

```
<% form.fields_for :name, @person.name do |name_form| %>

<% end %> 
```

如果你尝试一下，祝你好运，这对我有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-13T17:37:22.733

不知道为什么这不起作用，但作为一种解决方法，您可以在 controller#create 方法中使用 params[:name] 来更新人员记录。

```
person = Person.new(params[:person])
person.name << PersonName.new(params[:name]) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-16T16:49:00.763

不幸的是，我仍然无法弄清楚为什么这个表单不能用于嵌套对象表单。我将其剥离为最简单的数据，并使用 complex-form-example 作为开始重新开始。我结束了使用 active_presenter 从表单中收集 x 对象数据。我将在表单中的某个时候重新讨论嵌套对象表单。谢谢你的帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-09-07T00:55:21.733

以为我会分享我的解决方案，因为它略有不同 - 在我的情况下，我希望嵌套属性是动态的。

在新动作中：

```
 case params[:type]
  when "clubber"
    @account = resource.send "build_#{params[:type]}"
  when "promoter"
    @account = resource.send "build_#{params[:type]}"
  when "company"
    @account = resource.send "build_#{params[:type]}"
  when "venue_owner"
    flash[:notice] = 'We ask that venue owners register via the web. Thanks.'
    redirect_to root_path and return
  end 
```

在我看来：

```
= f.fields_for @account.class.name.downcase+'_attributes' do |form| 
```

漂亮的贫民区，但它的工作原理。

# actionscript-3 - 如何使用 ActionScript 3 暂停/恢复动态加载的外部 SWF 文件？

> ID：742537
> 
> 赞同：1
> 
> 时间：2009-04-12T22:21:58.937
> 
> 标签：actionscript-3, flash, movieclip, playback

我希望能够使用 ActionScript 3.0 播放/暂停动态加载的外部 SWF 电影。任何帮助表示赞赏。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T08:11:20.660

加载的 SWF 可通过 Loader 的**content**属性访问。您可以将 content 属性转换为已加载的 SWF 的 Document Class 以直接访问 SWF 的方法。当然你可以简单地使用 play(); 和停止（）；...如果您只想播放时间线动画：

```
var loader:Loader = new Loader("anim.swf");
addChild(loader);

loader.contentLoaderInfo.addEventListener(Event.COMPLETE, completeHandler);

function completeHandler(e:Event):void
{
    var movie:MovieClip = e.target.content;
    movie.play();
} 
```

# c# - TSQL：使用 INSERT INTO SELECT FROM 进行更新

> ID：742540
> 
> 赞同：11
> 
> 时间：2009-04-12T22:23:29.747
> 
> 标签：c#, sql, tsql, migration, bulkinsert

所以我有一个旧数据库，我正在迁移到一个新数据库。新的架构略有不同，但大多兼容。此外，我想从零开始重新编号所有表。

目前我一直在使用自己编写的工具，手动检索旧记录，将其插入到新数据库中，并更新旧数据库中的 v2 ID 字段以显示其在新数据库中对应的 ID 位置。

例如，我从 MV5.Posts 中选择并插入到 MV6.Posts 中。在插入时，我在 MV6.Posts 中检索新行的 ID，并在旧的 MV5.Posts.MV6ID 字段中更新它。

有没有办法通过 INSERT INTO SELECT FROM 进行此更新，这样我就不必手动处理每条记录？我正在使用 SQL Server 2005，开发版。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-13T13:56:58.347

迁移的关键是做几件事：首先，不要在没有当前备份的情况下做任何事情。其次，如果键将发生变化，您需要至少暂时将旧的和新的存储在新结构中（如果键字段永久暴露给用户，因为他们可能正在通过它进行搜索以获取旧记录）。

接下来，您需要彻底了解与子表的关系。如果您更改关键字段，所有相关表也必须更改。这就是存储新旧密钥派上用场的地方。如果您忘记更改其中任何一个，则数据将不再正确且无用。所以这是关键的一步。

挑选一些特别复杂数据的测试用例，确保为每个相关表包含一个或多个测试用例。将现有值存储在工作表中。

要开始迁移，请使用从旧表中选择插入到新表中。根据记录的数量，您可能希望循环遍历批次（一次不是一条记录）以提高性能。如果新键是一个身份，您只需将旧键的值放在其字段中，让数据库创建新键。

然后对相关表执行相同操作。然后使用表中的旧键值更新外键字段，例如：

```
Update t2
set fkfield = newkey
from table2 t2
join table1 t1 on t1.oldkey = t2.fkfield 
```

通过运行测试用例并将数据与迁移前存储的数据进行比较来测试您的迁移。彻底测试迁移数据至关重要，否则您无法确定数据是否与旧结构一致。迁移是一个非常复杂的动作；花点时间并有条不紊地彻底地做这件事是值得的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-12T22:44:11.897

可能最简单的方法是在 MV6.Posts 上为 oldId 添加一列，然后将旧表中的所有记录插入到新表中。最后，在新表中更新与 oldId 匹配的旧表，如下所示：

```
UPDATE mv5.posts
SET newid = n.id
FROM mv5.posts o, mv6.posts n 
WHERE o.id = n.oldid 
```

如果您愿意，您可以在之后清理并删除 oldId 列。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-12T22:33:49.877

我知道你能做的最好的事情就是使用[output 子句](http://msdn.microsoft.com/en-us/library/ms177564.aspx)。假设您有 SQL 2005 或 2008。

```
USE AdventureWorks;
GO
DECLARE @MyTableVar table( ScrapReasonID smallint,
                           Name varchar(50),
                           ModifiedDate datetime);
INSERT Production.ScrapReason
    OUTPUT INSERTED.ScrapReasonID, INSERTED.Name, INSERTED.ModifiedDate
        INTO @MyTableVar
VALUES (N'Operator error', GETDATE()); 
```

它仍然需要第二遍来更新原始表；但是，它可能有助于使您的逻辑更简单。您需要更新源表吗？您可以将新 ID 存储在第三个交叉引用表中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-12T22:40:00.970

呵呵。我记得在迁移中这样做。

将 old_id 放在新表中使更新更容易——您只需执行`insert into newtable select ... from oldtable`,——以及随后的记录“拼接”更容易。在“缝合”中，您将在插入中更新子表的外键，通过对新父级 ( `insert into newchild select ... (select id from new_parent where old_id = oldchild.fk) as fk, ... from oldchild`) 执行子选择，或者您将插入子级并执行单独的更新以修复外键。

一次插入会更快；在单独的步骤中进行意味着您的插入不依赖于订单，并且可以在必要时重新完成。

迁移后，您可以删除`old_id`列，或者，如果您遇到遗留系统暴露了 id 并且用户将键用作数据的情况，您可以保留它们以允许使用基于 old_id 的查找。

实际上，如果您正确定义了外键，则可以使用 systables/information-schema 来生成插入语句。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-12T22:50:01.977

> 有没有办法通过 INSERT INTO SELECT FROM 进行此更新，这样我就不必手动处理每条记录？

由于您不想*手动*执行，而是***自动***执行，因此请创建一个触发器，`MV6.Posts`以便在插入`UPDATE`时自动发生。`MV5.Posts``MV6.Posts`

你的触发器可能看起来像，

```
create trigger trg_MV6Posts
on MV6.Posts
after insert
as
begin
    set identity_insert MV5.Posts on

    update  MV5.Posts
    set ID = I.ID
    from    inserted I

    set identity_insert MV5.Posts off
end 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-12T22:33:32.733

AFAIK，您不能使用单个 sql 语句更新两个不同的表

但是，您可以使用触发器来实现您想要做的事情。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-12T22:44:53.657

在 MV6.Post.OldMV5Id 中创建一列

在 MV6.Post 中插入 select .. from MV5.Post

然后更新 MV5.Post.MV6ID

# c++ - 运算符 = 用 C++ 中的常量变量重载

> ID：742545
> 
> 赞同：9
> 
> 时间：2009-04-12T22:34:23.247
> 
> 标签：c++, operators, operator-overloading, constants, conversion-operator

我想知道你们是否可以帮助我。

这是我的.h：

```
Class Doctor {
   const string name;
   public:
       Doctor();
       Doctor(string name);
       Doctor & Doctor::operator=(const Doctor &doc);
} 
```

和我的主要：

```
int main(){
    Doctor d1 = Doctor("peter");
    Doctor d2 = Doctor();
    d2 = d1;
} 
```

我想做 operator= 功能。谁能帮我？注意 Doctor 上的 const 成员。

************编辑：********* 我的主要问题是我希望另一个类有一个属性，它是一个医生，就像一个病人有一个医生。但我希望能够改变我的医生。就像我正在看医生 A 但我想看医生 B。这将在我的其他班级 (Pacient) 中使用 setDoctor 函数来完成。如果是我编写代码，我会这样说：

```
class Patient{
    Doctor &d;
}; 
```

然后更改指针。但是，我使用的是一位老师制作的基本代码，它的类定义如下：

```
class Patient{
     Doctor d;
} 
```

但我认为这是不可能的，因为在 Patient 类中使用 setDoctor() 时，我要么制作副本，要么更改变量本身。第一个没有任何区别，第二个由于 const 是不可能的。我对吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-12T22:53:42.310

你快到了。几个值得注意的点：

*   名称不应被`const`限定。A`const`不能被修改，这正是我们在赋值运算符中想要的。

*   C++ 关键字是`class`而不是`Class`你的代码有它（它会给你编译错误）

*   正如 Michael Burr 所说：“应该注意的是，如果该类仅包含已经正确支持赋值的其他类（如在本例中使用简单的字符串成员），则编译器生成的隐式 operator=() 将正常工作。” 在这里，就您而言，唯一的成员`string`具有适当的`op=`. 所以明确定义是多余的。

*   Meeh 的解决方案几乎就在那里。它唯一没有谈论的是自我分配。阅读[常见问题 12](http://www.parashift.com/c++-faq-lite/assignment-operators.html)。

*   赋值是三大成员函数[FAQ 27.10](http://www.parashift.com/c++-faq-lite/coding-standards.html#faq-27.10)之一。查一下。它说，实现 copy ctor、op= 或 dtor 之一的要求通常意味着您还需要实现另外两个。

更正后的代码示例应该是这样的：

```
class Doctor {
  string name;
  public:
    Doctor& operator=(Doctor const& o) { 
         if (&o != this) name = o.name;
         return *this;
    }
  // ...
}; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-13T06:08:31.657

正确定义赋值构造函数以使其异常安全的标准方法是根据复制构造函数来定义它。

```
class Doctor
{
    public:
        Doctor& operator=(Doctor const& rhs)
        {
            if (this != &rhs)
            {
                Doctor  tmp(rhs);  // Use copy constructor here
                this->swap(tmp);   // Now Swap
            }
            return *this;
        }
        void swap(Doctor& rhs) throws()
        {
            std::swap(.....); // swap each member variable.
        }
}; 
```

通过这样做可以使它异常安全。
请注意，您只需要将交换设置为无抛出方法，如果您使用 STL 对象，这相对简单，因为它们都为这种情况定义了无抛出交换，boost 和所有好的库也是如此（因此您应该遵循套件）。

如果这出错了，他们在使用复制构造函数时会出错。此时，您尚未修改自己的对象，因为您正在将构造复制到临时对象中。因此，您提供了良好的异常安全性，因为您的对象仍未更改。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-12T22:48:32.557

声明是`Doctor &operator=(const Doctor &other);` （即删除医生::)

从那里你需要使用 const_cast<> 来删除成员变量的 const-ness 以使其工作。请注意，只有心碎在于您选择的道路。

我建议从成员声明中删除 const ，而是根据需要使成员函数 const 以表明它们不会影响对象。（例如，如果您有一个访问器成员函数，您可以声明 const: `string getName() const { return m_name; }`）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-13T04:34:28.807

正如许多人之前所说，成员是“const”表示它必须在创建期间进行初始化，并且不应更改。如果您必须为这种情况编写一个赋值运算符并且您不能跳过该成员变量的赋值，那么将其设为“可变”。

记住; 从 C++ 标准来看，“抛弃最初声明的 const 变量的 const 是未定义的行为。”

HTH，阿拜

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-12T22:44:28.353

由于您的名字是 const，因此“更改”它的唯一方法是通过构造函数。如果你想使用 = 操作符，你需要“unconst”这个字符串。

..如果你不想“unconst”字符串，你可以通过创建一个复制构造函数来获得一些相同的行为：

```
Doctor(const &Doctor d); 
```

..并实施它：

```
Doctor::Doctor(const &Doctor d)
   : name(d.name)
{
//Im pretty sure you have access to private attributes here
// My C+ is a bit rusty :) If not, make a const string getName() method
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-13T14:07:46.107

您还想将返回类型更改为 const&：

```
const Doctor& operator=(const Doctor &doc); 
```

省略 const 将使以下代码可编译，而实际上它们是无效的：

```
(A = B) = C; 
```

这***不***等于以下内容：（这可能是预期的）

```
A = B = C; 
```

# python - 在声音文件中获取给定时间的幅度？

> ID：742546
> 
> 赞同：2
> 
> 时间：2009-04-12T22:36:30.243
> 
> 标签：python, audio, input, microphone, amplitude

我正在做一个项目，我需要知道来自计算机麦克风的声音幅度。

我目前正在将 Python 与[Snack Sound Toolkit](http://www.speech.kth.se/snack/)一起使用，我可以录制来自麦克风的音频，但我需要知道该音频的响度。我可以将录音保存到一个文件中，并使用另一个工具包从音频文件中读取给定时间点的幅度，或者尝试在音频进入时获取幅度（这可能更容易出错）。

是否有任何库或示例代码可以帮助我解决这个问题？我一直在寻找，到目前为止，Snack Sound Toolkit 似乎是我最大的希望，但似乎没有办法直接访问振幅。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-12T22:56:54.907

查看 Snack Sound Toolkit 示例，似乎有一个 dbPowerSpectrum 函数。

从参考：

> 分贝功率谱 ( )
> 
> 计算声音的对数 FFT 功率谱（在开始选项中给出的样本数处）并返回一个 dB 值列表。有关其余选项的说明，请参见章节项目。可选地，可以使用 end 选项给出结束点。在这种情况下，结果是指定范围内连续 FFT 的平均值。它们的默认间距取自 fftlength，但这可以使用 skip 选项进行更改，该选项告诉 FFT 窗口每步移动多少点。选项：

编辑：我假设当你说振幅时，你的意思是声音对人来说有多“响亮”，而不是时域电压（由于正弦波的积分将是 0，因此在整个长度上可能为 0 . 例如：10 * sin(t) 比 5 * sin(t) 响亮，但随着时间的推移，它们的平均值为 0。（无论如何，您都不想向扬声器发送非交流电压））。

要获得声音的响度，您需要确定每个频率分量的幅度。这是通过傅里叶变换 (FFT) 完成的，它将声音分解为其频率分量。dbPowerSpectrum 函数似乎为您提供了每个频率的幅度列表（如果这与功率谱的确切定义不同，请原谅我）。要获得总音量，您可以将整个列表相加（这将接近，xept 它仍然可能与感知响度不同，因为人耳本身具有频率响应）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T14:28:38.357

我完全不同意 CookieOfFortune 的这个“答案”。

当然，这个问题的措辞很糟糕......但这个答案使事情变得比必要的复杂得多。我假设“幅度”是指感知响度。从技术上讲，（PCM）音频流中的每个样本都代表给定时间片上信号的幅度。要获得响度表示，请尝试简单的 RMS 计算：

[有效值](http://en.wikipedia.org/wiki/Root_mean_square)

|K<

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-10T16:30:16.187

我不确定这是否会有所帮助，但skimpygimpy 提供了将WAVE 文件解析为python 序列并返回的工具——您可以使用它来直接检查波形样本并做您喜欢的事情。您将不得不阅读一些源代码，这些子组件没有记录。

# excel - Conditional median in MS Excel

> ID：742547
> 
> 赞同：13
> 
> 时间：2009-04-12T22:36:36.203
> 
> 标签：excel, worksheet-function, median

I'm trying to calculate the conditional median of a chart that looks like this:

```
A  |  B
-------
x  |  1
x  |  1
x  |  3
x  |  
y  |  4
z  |  5 
```

I'm using MS Excel 2007\. I am aware of the AVERAGEIF() statement, but there is no equivalent for Median. The main trick is that there are rows with no data - such as the 4th "a" above. In this case, I don't want this row considered at all in the calculations.

Googling has suggested the following, but Excel won't accept the formula format (maybe because it's 2007?)

```
=MEDIAN(IF((A:A="x")*(A:A<>"")), B:B) 
```

Excel gives an error saying there is something wrong with my formula(something to do with the * in the condition) I had also tried the following, but it counts blank cells as 0's in the calculations:

```
=MEDIAN(IF(A:A = "x", B:B, "") 
```

I am aware that those formulas return Excel "arrays", which means one must enter "Ctrl-shift-enter" to get it to work correctly.

How can I do a conditional evaluation and not consider blank cells?

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-12T23:02:50.883

嵌套 if 语句。

```
=MEDIAN(IF(A:A = "x",IF(B:B<>"",B:B, ""),"") 
```

没什么好解释的——它检查 A 是否为 x。如果是，则检查 B 是否为非空白。任何符合这两个条件的东西都会被计算为中位数的一部分。

给定以下数据集：

```
A | B
------
x | 
x |     
x | 2
x | 3
x | 4
x | 5 
```

上面的公式返回 3.5，这是我相信你想要的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-08-18T01:27:33.117

使用谷歌搜索的公式，但不要`Enter`在将其输入到公式栏中后点击，而是同时点击`Ctrl`++ （而不是`Shift`）。这会在公式周围放置括号并将其视为数组。`Enter``Enter`

请注意，如果您对其进行编辑，则不能`Enter`再次点击，否则公式将无效。如果编辑，您必须在完成后做同样的事情（`Ctrl`+ `Shift`+ `Enter`）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-11-13T00:07:52.717

还有一种不涉及数组公式的方式，需要 CtrlShiftEnter 操作。它使用 Excel 2010、2011 及更高版本中提供的 Aggregate() 函数。该方法也适用于最小值、最大值和各种百分位数。Aggregate() 允许忽略错误，因此诀窍是使所有不需要的值导致错误。最简单的方法是完成上面设置的任务是：

=聚合(16,6,(B:B)/((A:A = "x")*(B:B<>"")),0.5)

第一个和最后一个参数将场景设置为百分位 50%，这是一个中位数，第二个表示忽略所有错误（包括 DIV#0），第三个表示选择 B 列数据，并将其除以一个数字，即一个表示所有在 A 列中具有 x 的非空值，否则为零。零会创建除以零异常并将被忽略，因为 a/1=a 和 a/0=Div#0

该技术适用于四分位数（具有适当的 p 值），当然还有所有其他百分位数，以及使用带有适当参数的大或小函数的最大值和最小值。

这与非常流行的 Sumproduct() 技巧类似，但它不能用于任何分位数或最大最小值，因为它会产生看起来像这些函数的数字的零。

鲍勃乔丹

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-07-27T18:33:48.567

也许更概括一点，而不是这个......

```
{=MEDIAN(IF(A:A="x",IF(B:B<>"",B:B)))} 
```

...您可以使用以下内容：

```
{=QUARTILE.EXC(IF(A:A="x",IF(B:B<>"",B:B)),2)} 
```

*请注意，大括号指的是数组公式；您不应该在公式中放置方括号，而是在输入公式时按 CTRL+SHIFT+ENTER（或 macOS 上的 CMD+SHIFT+ENTER）*

*然后，您可以通过将最后一个数字分别从2*更改为*1*或*3*轻松获得第一个和第三个四分位数。顺便说一句，QUARTILE.EXC 是大多数商业统计软件（例如 Minitab）使用的。“常规”函数是 QUARTILE.INC，或者对于旧版本的 Excel，只是 QUARTILE。

# concurrency - Haskell for simulating multilane traffic circle?

> ID：742552
> 
> 赞同：4
> 
> 时间：2009-04-12T22:39:05.090
> 
> 标签：concurrency, haskell

It was hard for me to come up with a real-world example for a concurrency:

> Imagine the above situation, where there are many lanes, many junctions and a great amount of cars. Besides, there is a human factor.

The problem is a hard research area for traffic engineers. When I investigated it a some time ago, I noticed that many models failed on it. When people are talking about functional programming, the above problem tends to pop up to my mind.

> Can you simulate it in Haskell? Is Haskell really so concurrent? What are the limits to parallelise such concurrent events in Haskell?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-12T23:36:03.127

我不确定这个问题到底是什么。Haskell 98 没有为并发指定任何东西。特定的实现，如 GHC，提供了实现并行和并发的扩展。

要模拟交通，这将取决于您在模拟中需要什么，例如，如果您想跟踪个别汽车或以一般统计方式进行，您是否想使用滴答声或时间连续模型等。从那里，您可以提出数据的表示形式，以进行并行或并发评估。

GHC 提供[了多种](http://www.haskell.org/haskellwiki/GHC/Concurrency)方法来利用多个硬件执行单元，从传统的信号量和互斥体，到具有轻量级线程的[通道](http://www.haskell.org/ghc/docs/latest/html/libraries/base/Control-Concurrent-Chan.html)（可用于实现像 Erlang 这样的参与者[模型），到](http://en.wikipedia.org/wiki/Actor_model)[软件事务内存](http://en.wikipedia.org/wiki/Software_transactional_memory)，到纯函数式[并行表达式评估](http://www.haskell.org/ghc/docs/latest/html/libraries/parallel/Control-Parallel.html)，[策略](http://www.haskell.org/ghc/docs/latest/html/libraries/parallel/Control-Parallel-Strategies.html)和 实验[嵌套 数据 并行](http://www.haskell.org/haskellwiki/GHC/Data_Parallel_Haskell).

所以是的，Haskell 有许多并行执行的方法，当然可以用于流量模拟，但是在为并发模拟选择最佳数字表示之前，您需要清楚地了解您要尝试做什么。每种方法都有其自身的优势和局限性，包括学习曲线。您甚至可能会了解到并发性对于您的模拟规模来说是多余的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-15T17:18:41.013

在我看来，您正在尝试进行模拟，而不是真实世界的并发。这种事情通常使用[离散事件模拟](http://en.wikipedia.org/wiki/Discrete_event_simulation)来解决。几年前我在 Haskell 中做了类似的事情，并基于 continuation monad 转换器推出了我自己的离散事件模拟库。恐怕它是我的雇主所有的，所以我不能发布它，但它并不太难。延续实际上是一个挂起的线程，所以定义这样的东西（从内存中）：

```
type Sim r a = ContT r (StateT ThreadQueue IO a)

newtype ThreadQueue = TQ [() -> Sim r ()] 
```

状态内部的 ThreadQueue 保存当前调度线程的队列。您还可以使用其他类型的线程队列来保存未调度的线程，例如在信号量中（基于“IORef (Int, ThreadQueue)”）。一旦你有了信号量，你就可以构建 MVar 和 MQueue 的等价物。

要安排线程，请使用“callCC”。“callCC”的参数是一个函数“f1”，它本身将函数“c”作为参数。这个内部参数“c”是延续：调用它会恢复线程。当您这样做时，从该线程的角度来看，“callCC”只是将您作为参数提供给“c”的值返回。实际上，您不需要将值传递回挂起的线程，因此参数类型为空。

因此，您对“callCC”的参数是一个 lambda 函数，它采用“c”并将其放在适合您正在执行的操作的任何队列的末尾。然后它从状态内部获取 ThreadQueue 的头部并调用它。你不必担心这个函数会返回：它永远不会。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-12T22:46:59.190

If you need a concurrent programming language with a functional sequential subset, consider Erlang.

[More about Erlang](http://en.wikipedia.org/wiki/Erlang_(programming_language))

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-13T00:42:33.560

我想您是在问是否可以为系统中的每个对象设置一个线程？

GHC 运行时[可以很好地扩展到数百万个线程](http://hackage.haskell.org/trac/ghc/ticket/1589#comment:6)，并通过 Chris Smith 提到的抽象将这些线程多路复用到可用硬件上。因此，如果您使用 Haskell/GHC，您的系统中肯定有可能拥有数千个线程。

在性能方面，它往往[比 Erlang 快很多](http://shootout.alioth.debian.org/u64q/benchmark.php?test=all&lang=hipe&lang2=ghc&box=1)，但不太重视跨多个节点的进程分布。特别是 GHC，更针对共享内存多核系统上的快速并发。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-12T22:59:56.617

Erlang、Scala、Clojure 是可能适合您的语言。

但我认为你更需要的是找到一个合适的多智能体模拟库或工具包，并绑定到你最喜欢的语言。

我可以告诉你有关 MASON、Swarm 和 Repast 的信息。但这些是 Java 和 C 库......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-18T17:05:56.133

我已经对此做了一个答案，但现在我想从更广泛的角度添加另一个答案。

听起来让这成为一个难题的原因是每个司机都在根据对其他司机将要做什么的心理预测来做出行动。例如，当我开车时，我可以判断一辆车什么时候可能停在我面前，甚至在他指出之前，根据他与我和前面汽车之间的差距对齐的方式。反过来，他可以从我正在后退为他腾出空间的事实中看出我已经看到了他，所以可以停车。一个好的司机会收集很多这些微妙的线索，而且很难建模。

所以第一步就是要找出真实驾驶的哪些方面没有包含在失败的模型中，并想办法把它们放进去。

（提示：所有模型都是错误的，但有些模型是有用的）。

我怀疑答案将涉及为每个模拟驾驶员提供一个或多个其他驾驶员将要做什么的心理模型。这涉及使用驱动程序 1 可能对驱动程序 2 的意图做出的几种不同假设来运行驱动程序 2 的计划算法。同时，驱动程序 2 对驱动程序 1 执行相同的操作。

这种东西很难添加到现有的模拟器中，特别是如果它是用传统语言编写的，因为规划算法很可能有副作用，即使它只是遍历数据结构的方式. 但是函数式语言可能会做得更好。

此外，驱动程序之间的相互依赖可能意味着那里有一个固定点，懒惰的语言往往会做得更好。

# mysql - Most efficient way to generate reports in MySQL on massive datasets

> ID：742553
> 
> 赞同：0
> 
> 时间：2009-04-12T22:39:31.407
> 
> 标签：mysql, optimization

I need to build a reporting interface to an application I'm working on which requires administrators to visualise huge quantities of collected data over time.

Think something similar to Google Analytics etc.

Most of the data that needs to be visualised sits in a basic table which contains a datetime, 'action' varchar and other filterable data - currently the table holds 1.5M rows, and it's growing every day.

At the moment I'm doing a simple select with the filters applied grouped by day and it's running pretty well, but I was wondering if there's a smarter more efficient way to extract such data.

Cheers

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-13T00:12:36.457

1) 两层——原始数据和汇总数据。对于原始数据，索引可能没有帮助。您正在进行聚合，在大多数情况下需要进行全表扫描。如果没有，请重新组织它，它会更快。

2) 找出你的聚合，自动生成它们，并根据聚合数据运行报告。为这些汇总表编制索引！

3) 避免连接。聚合，具体化分组结果，然后加入聚合结果。

4）分区。将一天的数据（或任何有意义的粒度）与另一天的数据分开。如有必要，制作自动表创建脚本（根据您的观点，成熟 - 或功能繁重 - 数据库为您提供了一种称为“分区”的东西，以便以更理智的方式执行此操作）。

5) 阅读“数据仓库” [http://en.wikipedia.org/wiki/Data_warehouse](http://en.wikipedia.org/wiki/Data_warehouse)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-12T22:51:04.437

你可以开始做几件事：

1.  确保在所有过滤器上添加索引，这样它们就不会进行任何表扫描。

2.  使用查询计划分析器检查以确保没有需要优化的地方。

3.  由于您的表中有日期时间戳，因此分区肯定会在将来帮助您。

祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-12T23:22:41.477

您可以期待一些常见的查询，与可能生成的唯一过滤器组合的数量相比，这可能是一个很小的数量。您可以使用它来将数据“压缩”到配套表中，并在晚上运行此收集过程。

# c - Using mmap over a file

> ID：742564
> 
> 赞同：4
> 
> 时间：2009-04-12T22:49:08.263
> 
> 标签：c, file, mmap

I'm trying to allow two different processes to communicate by using memory mapping the same file. However, I'm having some problems with this. I have a feeling this has to do with the way I'm using the open() call and passing my file descriptor to mmap.

Here is my code, can you see anything wrong with it?

Object 1's code:

```
 16     FILE* temp = fopen(theSharedFileName, "w");
 17     fseek(temp, fileSize-1, SEEK_SET);
 18     fprintf(temp, "0"); // make the file a certain size
 19     fseek(temp, 0, SEEK_CUR);
 20 
 21     int sharedFileName = fileno(temp);
 ...
 31     sharedArea = (MyStruct*)mmap(0, fileSize,
 32         PROT_READ | PROT_WRITE | PROT_EXEC, MAP_SHARED, sharedFileName, 0); 
```

I use the "w" file mode since Object 1 will only ever be made once and I want it to reset any previously existing data.

Object 2's Code:

```
 130     FILE* tempFile = fopen(sharedFileName, "a");
 131     int theFile = fileno(tempFile);
 ...
 135     sharedArea = (MyStruct*)mmap(NULL, fileSize,
 136         PROT_READ | PROT_WRITE | PROT_EXEC, MAP_SHARED, theFile, 0); 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-12T23:32:01.063

几个问题：

1.  避免混合高级 I/O（fopen()、fseek()）和一些低级操作，如 mmap()。虽然您可以使用 fileno() 获取低级文件描述符，但这就像走最长的路线到达同一个地方。此外，仅使用 mmap() 会破坏 BSD 和 POSIX 之外的兼容性，因此使用标准 CI/O 函数将一无所获。直接使用 open() 和 lseek() 即可。
2.  在内存映射的同一个文件上使用流格式的 I/O (fprintf()) 是没有意义的。当您对文件进行内存映射时，您隐含地告诉系统您将使用它作为随机访问（直接索引）数据。fprintf() 用于流输出，通常用于顺序访问。事实上，尽管可能，但在同一个描述符中看到 fprintf() 和 fseek() 是不寻常的（这甚至是不可移植的，但由于前一项，我不考虑可移植性）。
3.  保护必须与打开文件保护相匹配。由于您将“w”传递给 fopen() 和`PROT_READ | PROT_WRITE | PROT_EXEC`mmap()，因此您违反了此限制。这也突出了为什么您不应该将高级 I/O 与内存映射混合使用：您如何保证`fopen(...,"w")`将使用正确的标志打开文件？这应该是 C 库的“实现细节”。如果要对具有读写权限的文件进行内存映射，则应使用低级别`open(theSharedFileName, O_RDWR)`打开该文件。
4.  **不要**`PROT_WRITE`和`PROT_EXEC`一起使用。它不可移植**，**存在安全风险。阅读有关[W^X](http://en.wikipedia.org/wiki/W%5EX)和[可执行空间保护](http://en.wikipedia.org/wiki/Executable_space_protection)的信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-13T01:31:01.637

如果您可以使用 C++ 和诸如[ACE](http://www.cs.wustl.edu/~schmidt/ACE.html)或[Boost](http://www.boost.org)之类的库来保护您免受底层细节的影响，并为[IPC](http://en.wikipedia.org/wiki/Inter-process_communication)提供更容易的抽象。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-13T00:03:03.360

正如其他人所说，不要为此使用 fopen() 和朋友。

您遇到的部分问题可能是由于 fprintf() 可以具有流缓冲区，因此它实际上可能不会更改文件，因此在预期时对其他进程可见。您可以添加一个 fflush()，但 read() 和 write() 不执行任何应用程序级缓冲，这也是它们更适合的部分原因。

# c - 数组合算法

> ID：742566
> 
> 赞同：1
> 
> 时间：2009-04-12T22:50:36.687
> 
> 标签：c, algorithm

编写一个函数，给定一串数字和一个目标值，打印在数字之间放置 + 和 * 的位置，以便它们完全结合到目标值。请注意，答案可能不止一个，您打印哪一个都没有关系。

例子：

```
"1231231234",11353 -> "12*3+1+23*123*4" 
"3456237490",1185  -> "3*4*56+2+3*7+490" 
"3456237490",9191  -> "no solution" 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-12T23:01:25.647

如果您有 N 位值，则 + 或 * 运算符有 N-1 个可能的插槽。所以蛮力，有 3^(N-1) 种可能性。测试所有这些都是低效的。

但

你的例子都是10位数。3 ^ 9 = 19683，所以蛮力很好！没有必要得到任何更高级的。

因此，您需要做的就是遍历所有 19683 个案例，每次都为该案例构建一个字符串，并评估表达式。评估表达式是一项简单的任务。迭代很简单（只需使用递增值，您可以通过 (i%3) 读取第一个插槽的状态，这给您“无运算符”“+”或“*”，第二个插槽的状态是（i /3)%3，第三个槽的状态为(i/9)%3，以此类推。）

即使使用粗略的解析代码，CPU 也很快。

蛮力选项在大约 20 位数字后开始变得丑陋，你必须改得更聪明。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-02-20T20:27:59.193

如果这是针对游戏程序员的职位，请不要使用蛮力方法。我做到了，但几年前失败了。后来从内部某人那里听说动态编程方法是获得这份工作的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-12T23:00:24.710

这可以通过回溯或动态规划来解决。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-12T23:31:18.677

“更聪明”的方法（使用动态编程）基本上是这样的：

对于原始字符串的每个子字符串，找出它可以创建的所有可能值。（例如，在您的第一个示例中，“12”可以变为 1+2=3 或 1*2=2）

可能有很多不同的组合，但其中很多都是重复的。（此外，您应该忽略所有大于目标的组合）。

因此，当您添加“+”或“*”时，您可以将其设想为组合字符串的两个子字符串。（并且由于每个子字符串都有可能的值，因此您可以查看这种组合是否可行）

这些值可以类似地生成：尝试以所有可能的方式拆分子字符串，并在子字符串的每一半中组合不同的值。

那么，“状态”的总数类似于 |S|^2 * target - 对于您的示例情况，它比蛮力方法*更糟糕。*但是如果你有一个长度为 1000 的字符串，目标是 5000，那么这个问题可以通过动态规划来解决。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-13T00:03:47.023

[Google Code Jam](http://code.google.com/codejam/)去年（在[Round 1C](http://code.google.com/codejam/contest/dashboard?c=agdjb2RlamFtchALEghjb250ZXN0cxj61wUM)中）有这个问题的扩展版本，称为 Ugly Numbers。当扩展到大量数字时，您可以访问该链接并单击“竞赛分析”以了解该问题的一些方法。

# audio - 我在哪里可以获得免费的游戏音频、图形和其他资源？

> ID：742569
> 
> 赞同：26
> 
> 时间：2009-04-12T22:51:42.453
> 
> 标签：audio, graphics

我已经对这个主题进行了谷歌搜索，但到目前为止还没有找到任何令人满意的东西。

根据您的经验，获取游戏资源（如精灵、背景、音效、音乐等）的最佳位置是什么？更具体地说，我正在寻找更多的音效和音乐，我目前缺少的不仅仅是图形。但是，对于图形，我尝试从不同的站点获取随机图形，但它们就是不匹配。我也不想复制一个完整的图形包。

资源应该是免费且易于获取的。我打算制作的产品即使不是开源的也是免费的，不太可能受到广泛关注或为自己创造利润，所以我想要一些我可以自由使用和分发的东西。

我没有足够的图形和音乐知识来尝试从头开始创建资源，也不知道有谁愿意这样做。

我正在使用 Java。我确信我可以用它读取各种文件格式，或者如果没有，我总是可以使用软件来转换资源。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-13T00:11:51.153

在图形方面，[Lost Garden](http://www.lostgarden.com)的 Daniel Cook制作了一些非常高质量、可重复使用的游戏美术，这些美术作品对个人和商业作品都是免费的（阅读他的[许可](http://lostgarden.com/2007/03/lost-garden-license.html)详情）。[这是他的免费图形](http://lostgarden.com/labels/free%20game%20graphics.html)相关帖子的索引，只需点击文章底部的“阅读更多”链接，您就会找到下载链接。

***编辑：***就音效而言，如果您有特定的想法， [Soundrangers相当不错，但它很快就会变得昂贵。](http://www.soundrangers.com)对于复杂的游戏，如果您想要丰富的用户体验，您将需要数十个，甚至数百个音效。只需几美元，加起来真的很快。很多地方（包括[Soundrangers](http://www.soundrangers.com/index.cfm?fuseaction=category.display&Category_id=591)）都提供主题声音包，让您物有所值，但它仍然不是免费的。GameDev 也有一个[音频资源列表](http://www.gamedev.net/reference/list.asp?categoryid=4)。

对于音乐，我认为您的选择更好。取决于你在寻找什么样的东西（环境、乐器、人声等）。我会认真考虑接触当地的独立音乐家并使用他们现有的曲目。他们可能会让你免费使用他们的音乐（当然是经过适当认证的）或以合理的费用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-13T03:57:37.803

有[http://www.freesound.org/](http://www.freesound.org/)

例如，那里的大多数东西都有一个与 Fedora 不兼容的许可证，但如果你有时问版权所有者，他们会根据不同的许可证来授权。

音乐比音效更难获得。你可以尝试在archive.org上挖掘，在这里说：[http ://www.archive.org/details/muzic](http://www.archive.org/details/muzic)

还可以查看 sfxr [http://www.cyd.liu.se/~tompe573/hp/project_sfxr.html](http://www.cyd.liu.se/~tompe573/hp/project_sfxr.html) 虽然它发出的声音听起来很老派——如果这就是你要找的，那很酷，否则，它可以制作一些占位符音效。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-13T04:06:02.340

如果您正在寻找有趣的纹理，我建议您查看[Filter Forge](http://www.filterforge.com/filters/)。您可以下载滤镜以在 Adob​​e Photoshop 中使用，也可以使用网站上的示例图像为各种类型的地形和材质创建纹理贴图。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-12T22:55:53.130

GarageGames.com 出售很多这类东西...... 3d 模型、纹理、背景音乐等等。

[http://garagegames.com](http://garagegames.com)特别是[http://www.garagegames.com/products/browse](http://www.garagegames.com/products/browse)

高温高压

编辑：哎呀，我没有看到“免费”要求！搜索“知识共享”，您至少会找到很多音乐和一些图形。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-14T23:27:25.830

不知道这是否是您要寻找的类型，但[Game Sprite Archives](http://www.gsarchives.net/index2.php)拥有大量的 SNES/NES/Anything pre-playstation 1 sprite rips 集合。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-14T23:28:34.267

前几天我在寻找一些音效时发现了这个网站：

[http://www.soundrangers.com/](http://www.soundrangers.com/)

看起来它们是免版税的，但大多数声音都需要一两美元。看起来有些声音是免费的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-03T00:47:20.917

**剪贴画**

*   [打开剪贴画](http://www.openclipart.org/)

**纹理**

*   [图像之后](http://www.imageafter.com/textures.php)
*   [CG 纹理](http://www.cgtextures.com/)
*   [开放影片](http://www.openfootage.net/)
*   [纹理猎犬](http://www.texturehound.com/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-02-15T20:18:38.270

我推荐[Sound Snap](http://www.soundsnap.com)，他们允许免费帐户在一个月内免费下载 5 次，如果您注册，还可以下载更多。在过去的几个月里，我一直在使用它们来开发我开发的游戏。

# windows-xp - Error 1219\. Multiple connections to a server or shared resource by the same user

> ID：742594
> 
> 赞同：7
> 
> 时间：2009-04-12T23:03:48.743
> 
> 标签：windows-xp, net-use

I am trying to map network drive, but get error 1219 on Windows XP:

```
net use z: \\serverA\tests password /user:serverA\alex 
```

I have tried

```
net use * /del /yes 
```

But it has no effect, and the

```
net use 
```

shows empty list.

\\serverA\tests is a valid path, as I can open it in Explorer.

What can be done?

**EDIT:** After reboot it works. But any ideas are still very welcome.

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-13T06:13:26.683

This will usually be caused by a handle left open. Download [Process Explorer](http://live.sysinternals.com/procexp.exe) to find it, and try to close the program that has it open (don't close the handle itself). If it turns out to be `explorer.exe`, it's probably a buggy preview handler/shell extension.

If you can't find the handle, you can always try using the IP address of ServerA to create a new connection with different credentials, e.g.

```
net use z: \\10.1.2.3\tests password /user:serverA\alex 
```

* * *

Yes, sorry - use *Find Handle or DLL* with \\ServerA to find the program.

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-04-13T00:59:43.707

To open it in Explorer it has to be able to logon using your credentials (or the ones you provide when it eventually asks you for credentials).

After that you have a connection and would have to disconnect before you could remap the share with different credentials. (see "Disconnect network share")

You could map it persistently - that way it would always use the credentials you provide.

# c# - 在新的浏览器进程中打开 URL

> ID：742598
> 
> 赞同：4
> 
> 时间：2009-04-12T23:04:45.933
> 
> 标签：c#, windows, system, shellexecute

我需要在新的浏览器进程中打开一个 URL。当该浏览器进程退出时，我需要得到通知。我目前使用的代码如下：

```
 Process browser = new Process();
        browser.EnableRaisingEvents = true;
        browser.StartInfo.Arguments = url;
        browser.StartInfo.FileName = "iexplore";

        browser.Exited += new EventHandler(browser_Exited);

        browser.Start(); 
```

显然，这不会到期，因为“文件名”被固定为 iexplore，而不是用户的默认 Web 浏览器。如何确定用户的默认 Web 浏览器是什么？

我在 Vista->forward 上运行。虽然如果可能的话 XP 会很高兴支持。

更多背景信息：我创建了一个非常小的独立 Web 服务器，它为本地磁盘上的一些文件提供服务。在启动服务器结束时，我想启动浏览器。用户完成并关闭浏览器后，我想退出 Web 服务器。上面的代码完美运行，除了只使用 IE。

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-03T06:32:08.530

行。我现在有工作的 C# 代码来做我想做的事。这将返回您应该运行以加载当前默认浏览器的“命令行”：

```
using System;
using System.Collections.Generic;
using System.Runtime.InteropServices;
using System.Linq;
using System.Text;

namespace testDefaultBrowser
{
    public enum ASSOCIATIONLEVEL
    {
        AL_MACHINE,
        AL_EFFECTIVE,
        AL_USER,
    };

    public enum ASSOCIATIONTYPE
    {
        AT_FILEEXTENSION,
        AT_URLPROTOCOL,
        AT_STARTMENUCLIENT,
        AT_MIMETYPE,
    };

    [Guid("4e530b0a-e611-4c77-a3ac-9031d022281b"), InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
    public interface IApplicationAssociationRegistration
    {
        void QueryCurrentDefault([In, MarshalAs(UnmanagedType.LPWStr)] string pszQuery,
        [In, MarshalAs(UnmanagedType.I4)] ASSOCIATIONTYPE atQueryType,
        [In, MarshalAs(UnmanagedType.I4)] ASSOCIATIONLEVEL alQueryLevel,
        [Out, MarshalAs(UnmanagedType.LPWStr)] out string ppszAssociation);

        void QueryAppIsDefault(
            [In, MarshalAs(UnmanagedType.LPWStr)] string pszQuery,
            [In] ASSOCIATIONTYPE atQueryType,
            [In] ASSOCIATIONLEVEL alQueryLevel,
            [In, MarshalAs(UnmanagedType.LPWStr)] string pszAppRegistryName,
            [Out] out bool pfDefault);

        void QueryAppIsDefaultAll(
            [In] ASSOCIATIONLEVEL alQueryLevel,
            [In, MarshalAs(UnmanagedType.LPWStr)] string pszAppRegistryName,
            [Out] out bool pfDefault);

        void SetAppAsDefault(
            [In, MarshalAs(UnmanagedType.LPWStr)] string pszAppRegistryName,
            [In, MarshalAs(UnmanagedType.LPWStr)] string pszSet,
            [In] ASSOCIATIONTYPE atSetType);

        void SetAppAsDefaultAll(
            [In, MarshalAs(UnmanagedType.LPWStr)] string pszAppRegistryName);

        void ClearUserAssociations();
    }

    [ComImport, Guid("591209c7-767b-42b2-9fba-44ee4615f2c7")]//
    class ApplicationAssociationRegistration
    {
    }

    class Program
    {
        static void Main(string[] args)
        {
            IApplicationAssociationRegistration reg = 
                (IApplicationAssociationRegistration) new ApplicationAssociationRegistration();

            string progID;
            reg.QueryCurrentDefault(".txt",
                ASSOCIATIONTYPE.AT_FILEEXTENSION,
                ASSOCIATIONLEVEL.AL_EFFECTIVE,
                out progID);
            Console.WriteLine(progID);

            reg.QueryCurrentDefault("http",
                ASSOCIATIONTYPE.AT_URLPROTOCOL,
                ASSOCIATIONLEVEL.AL_EFFECTIVE,
                out progID);
            Console.WriteLine(progID);
        }
    }
} 
```

哇！感谢大家帮助推动我找到正确的答案！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-22T08:40:17.203

如果您将已知文件类型的路径传递给（文件）资源管理器应用程序，它将“*做正确的事情*”，例如

```
 Process.Start("explorer.exe", @"\\path.to\filename.pdf"); 
```

并在 PDF 阅读器中打开文件。

但是，如果您尝试使用 URL 进行相同的操作，例如

```
Process.Start("explorer.exe", @"http://www.stackoverflow.com/"); 
```

它会启动 IE（这不是我机器上的默认浏览器）。

我知道没有回答这个问题，但我认为这是一个有趣的旁注。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-12T23:12:26.307

这篇博文解释了确定默认浏览器的方法：

[http://ryanfarley.com/blog/archive/2004/05/16/649.aspx](http://ryanfarley.com/blog/archive/2004/05/16/649.aspx)

从上面的博客文章：

```
private string getDefaultBrowser()
{
    string browser = string.Empty;
    RegistryKey key = null;
    try
    {
        key = Registry.ClassesRoot.OpenSubKey(@"HTTP\shell\open\command", false);

        //trim off quotes
        browser = key.GetValue(null).ToString().ToLower().Replace("\"", "");
        if (!browser.EndsWith("exe"))
        {
            //get rid of everything after the ".exe"
            browser = browser.Substring(0, browser.LastIndexOf(".exe")+4);
        }
    }
    finally
    {
        if (key != null) key.Close();
    }
    return browser;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-22T08:01:27.470

好的，我想我可能已经找到了 - IApplicationAssociationRegistration::QueryCurrentDefault [1]。根据文档，这是 ShellExecute 使用的。当我让它工作时，我会发布代码，但如果其他人认为这是正确的使用方法，我会很感兴趣（顺便说一句，我是 Vista 或更高版本的操作系统级别）。

[1]： http: [//msdn.microsoft.com/en-us/library/bb776336](http://msdn.microsoft.com/en-us/library/bb776336(VS.85).aspx) (VS.85).aspx QueryCurrentDefault

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-03T06:11:32.310

行。在会议巡回赛上待了一个星期，现在回到这个问题上。我现在可以用 C++ 做到这一点——它甚至看起来表现得很好！但是，我尝试将其转换为 C#（或 .NET）都失败了（[发布问题](http://social.msdn.microsoft.com/Forums/en-US/windowssdk/thread/3173a5ea-c2d4-4fbd-981f-0fa705db5ebe)）。

这是其他偶然发现此问题的 C++ 代码：

```
#include "stdafx.h"
#include <iostream>
#include <shobjidl.h>
#define _ATL_CSTRING_EXPLICIT_CONSTRUCTORS      // some CString constructors will be explicit

#include <atlbase.h>
#include <atlstr.h>
#include <AtlDef.h>
#include <AtlConv.h>

using namespace std;
using namespace ATL;

int _tmain(int argc, _TCHAR* argv[])
{
    HRESULT hr = CoInitialize(NULL);
    if (!SUCCEEDED(hr)) {
        cout << "Failed to init COM instance" << endl;
        cout << hr << endl;
    }

    IApplicationAssociationRegistration *pAAR;
    hr = CoCreateInstance(CLSID_ApplicationAssociationRegistration,
        NULL, CLSCTX_INPROC, __uuidof(IApplicationAssociationRegistration),
        (void**) &pAAR);
    if (!SUCCEEDED(hr))
    {
        cout << "Failed to create COM object" << endl;
        cout << hr << endl;
        return 0;
    }

    LPWSTR progID;
    //wchar_t *ttype = ".txt";
    hr = pAAR->QueryCurrentDefault (L".txt", AT_FILEEXTENSION, AL_EFFECTIVE, &progID);
    if (!SUCCEEDED(hr)) {
        cout << "Failed to query default for .txt" << endl;
        cout << hr << endl;
    }
    CW2A myprogID (progID);
    cout << "Result is: " << static_cast<const char*>(myprogID) << endl;

    /// Now for http

    hr = pAAR->QueryCurrentDefault (L"http", AT_URLPROTOCOL, AL_EFFECTIVE, &progID);
    if (!SUCCEEDED(hr)) {
        cout << "Failed to query default for http" << endl;
        cout << hr << endl;
    }
    CW2A myprogID1 (progID);
    cout << "Result is: " << static_cast<const char*>(myprogID1) << endl;

    return 0;
} 
```

当我终于让它工作时，我将发布 C# 代码！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-01-05T04:02:59.527

我曾经为一个项目编写过这段代码……它记住了为默认浏览器设置的任何附加参数。它最初是为了在浏览器中打开 HTML 文档而创建的，原因很简单，我总是将我的默认 HTML 程序设置为*编辑器*而不是浏览器，而且看到某些程序在我的文本中打开它的 HTML 自述文件让我很恼火编辑。显然，它也适用于 URL。

```
 /// <summary>
    ///     Opens a local file or url in the default web browser.
    /// </summary>
    /// <param name="path">Path of the local file or url</param>
    public static void openInDefaultBrowser(String pathOrUrl)
    {
        pathOrUrl = "\"" + pathOrUrl.Trim('"') + "\"";
        RegistryKey defBrowserKey = Registry.ClassesRoot.OpenSubKey(@"http\shell\open\command");
        if (defBrowserKey != null && defBrowserKey.ValueCount > 0 && defBrowserKey.GetValue("") != null)
        {
            String defBrowser = (String)defBrowserKey.GetValue("");
            if (defBrowser.Contains("%1"))
            {
                defBrowser = defBrowser.Replace("%1", pathOrUrl);
            }
            else
            {
                defBrowser += " " + pathOrUrl;
            }
            String defBrowserProcess;
            String defBrowserArgs;
            if (defBrowser[0] == '"')
            {
                defBrowserProcess = defBrowser.Substring(0, defBrowser.Substring(1).IndexOf('"') + 2).Trim();
                defBrowserArgs = defBrowser.Substring(defBrowser.Substring(1).IndexOf('"') + 2).TrimStart();
            }
            else
            {
                defBrowserProcess = defBrowser.Substring(0, defBrowser.IndexOf(" ")).Trim();
                defBrowserArgs = defBrowser.Substring(defBrowser.IndexOf(" ")).Trim();
            }
            if (new FileInfo(defBrowserProcess.Trim('"')).Exists)
                Process.Start(defBrowserProcess, defBrowserArgs);
        }
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-03T06:18:00.500

简短的回答，你不能。

如果默认浏览器是 Firefox，并且用户已经运行了一个 Firefox 实例，它只会在同一个 firefox.exe 进程的另一个窗口或选项卡中打开，即使他们关闭了您的页面，该进程也不会' t 退出，直到他们关闭每个窗口和选项卡。在这种情况下，由于临时 firefox.exe proc 会将 URL 编组到当前进程，您将在启动它时立即收到进程退出的通知。（假设这就是 Firefox 的单实例管理的工作方式）。

# php - 你认为在 PHP 中访问类方法中的超级全局变量是不好的形式吗？

> ID：742599
> 
> 赞同：4
> 
> 时间：2009-04-12T23:06:15.570
> 
> 标签：php, oop, login, session, superglobals

以. `login()`_`class Account`

```
class Account {
 /* Class variables */

    public function login() {
        if(isset($_POST['username']) && isset($_POST['password']))
            return $this->_formLogin();
        else if(isset($_SESSION['accountId']))
            return $this->_sessionLogin();
        else if(isset($_COOKIE['username']) && isset($_COOKIE['password']))
            return $this->_cookieLogin();
        else return false;
    }

    private function _formLogin() {
        //perform login actions using $_POST data
    }
    /* All that other stuff */
}
```

试着暂时忽略对数据清理、密码加盐等看不见的方法的任何担忧。专注于`login()`，这个全球访问是坏juju吗？我通常避免在类中使用 PHP 超级全局变量，但我想不出在这种情况下不这样做的充分理由。

我可以理解为什么您不希望在跨类交互的全局变量中出现后台魔术，但是这些全局变量是内置在 PHP 中的，不会被类修改，并且仅由此类使用。

这将导致在您需要用户登录的页面的开头：

```
$user = new Account($whatever, $objects, $we, $depend, $on);
if($user->login()) {
    //Do this stuff when logged in
}
```

而不是在每个页面上都这样做，其逻辑可能需要稍后更改：

```
$user = new Account($whatever, $objects, $we, $depend, $on);
if(isset($_POST['username']) && isset($_POST['password']))
    $user->formLogin($_POST['username'], $_POST['password']);
else if(isset($_SESSION['accountId']))
    $user->sessionLogin($_SESSION['accountId']);
else if(isset($_COOKIE['username']) && isset($_COOKIE['password']))
    $user->cookieLogin($_COOKIE['username'], $_COOKIE['password']);
if($user->isLoggedIn() {
    //Do this stuff when logged in
}
```

虽然我知道在类之外创建一个函数来处理它是一种选择，但这不会和在类中混淆全局变量一样糟糕吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-12T23:17:01.503

要回答我自己的问题，我会说是的，只要您不修改它们以跨多个类访问它们，就可以访问超级全局变量。后台没有什么魔法——你只是在读取状态，超级全局变量是 PHP 为你提供的。

但是，您永远不应该修改类中的全局变量并在其他地方访问它。那是您使单元测试变得不可能的时候。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-12T23:35:37.857

我不会说对这个问题有一个直接的是或否的答案。这个想法（所有 superglobals `$_GET` `$_POST` `$_SESSION`）是您要求的数据位于整个应用程序中，而不是您要求的范围内的数据。

这些超全局变量可能发生的情况是，如果它们在执行函数之前或（上帝保佑）期间由于某种原因而发生变化会怎样。这可能是一个非常烦人的错误重现。

所以我会说这是不好的形式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-12T23:31:21.050

一种方法是将所有超全局变量包装到自己的类中。我很确定 Zend Framework 有一个自己的类，例如操作 Cookie。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-12T23:15:25.953

我会说这取决于您的应用程序的设计。如果该类是一些通用的、松散耦合的类或模块，并且突然使用了这样的全局变量，那么在我的书中那将是不好的做法。但是，如果该类显然面向特定任务，无论如何都需要这些特定的全局变量（例如您的登录示例），我看不到任何明确的反对意见。

# tree - 两棵二叉树同构是什么意思？

> ID：742605
> 
> 赞同：19
> 
> 时间：2009-04-12T23:10:01.910
> 
> 标签：tree, binary-tree, computer-science, isomorphism

两棵二叉树同构是什么意思？我一直在网上寻找，似乎找不到明确的解释。

据我了解，如果两棵树具有相同的形状，它们就是同构的。所以我猜测两个相同的树可以在节点中包含不同的值。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-04-13T00:23:32.483

同构来自希腊语“相同的形状”（如等压线是具有相同气压的点，多边形表示“多面”）所以你的理解是正确的。但是不要误以为在这种情况下形状是*物理*形状（就像树有一个根，一个左节点和一个右节点；请参见下面的示例）。数学家有他们自己的语言，只是*有时*与英语有短暂的关系:-)

它不仅仅是二叉树。在数学中，两个结构是同构的，如果它们的属性被保留而不考虑它们的表达式（你可以有一个函数将 A 转换为 B，另一个从 B 转换为 A 而不会丢失信息）。

对于您的特定情况，保留的是树中的信息。例如，如果该信息是 sorted elements `{1,2,3}`，那么树根本不必是相同的*物理*形状 - 以下两个将是同构的：

```
 2      1
 / \      \
1   3      2
            \
             3 
```

排序链表（或排序数组，就此而言）也与那些同构，因为在这种情况下，两者之间的转换不会丢失任何信息。

如果以与排序顺序无关的方式使用二叉树（即，“袋”类容器），那么信息将只是任何顺序的内容，并且以下所有内容都是同构的（倒数第二个）只是一个包，最后是一个列表）：

```
 2      1           2   3                   +---+  +---+  +---+
 / \      \         /     \      +-------+   | 3 |->| 1 |->| 2 |
1   3      2       1       2     | 1,3,2 |   +---+  +---+  +---+
            \     /         \    +-------+
             3   3           1 
```

当然，根据您的需要，未排序的树可能会被认为有点浪费，但这与本次特定讨论无关。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-09-21T12:12:48.910

两棵树必须满足以下条件才能同构：
1\. 两棵树是同构的当且仅当它们在每个级别中保持相同的级别数和相同的顶点数。

2.两棵树是同构的当且仅当它们具有相同的度谱。

3.两棵树是同构的当且仅当它们在每一层具有相同的谱度。

4.  一个顶点的叶子后代总数和顶点的层数都是树树同构不变量。

**简单来说：**
如果一棵树可以通过执行任意数量的翻转（即交换多个节点的左子节点和右子节点）从另一棵树获得，则两棵树是同构的。

同构树的例子： ![同构树](https://i.stack.imgur.com/bJkbi.png)

参考：1\. [http://www14.in.tum.de/konferenzen/Jass03/presentations/eterevsky.pdf](http://www14.in.tum.de/konferenzen/Jass03/presentations/eterevsky.pdf) 2\. [http://www.geeksforgeeks.org/tree-isomorphism-problem/](http://www.geeksforgeeks.org/tree-isomorphism-problem/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-12T23:14:30.310

我认为你的理解是非常正确的。如果您忽略这些值并只查看结构，那么对于第一棵树中的每个节点，在另一棵树中都必须有一个对应的节点，反之亦然。

自然，两棵树将具有相同数量的节点。此外，您可以编写一个（超朴素）算法来通过尝试所有可能的映射函数来确认这种同构，并确保对于第一棵树中映射到另一棵树中的节点的每个节点，相应的映射发生在父母和两个孩子。显然有有效的算法来检查这一点。

您可能会从首先阅读[图同构](http://en.wikipedia.org/wiki/Graph_isomorphism)中受益；树是一种特殊的（并且更容易解决）的情况，因为它们没有循环。

# c++ - 使用带有 STL 算法的本地类

> ID：742607
> 
> 赞同：50
> 
> 时间：2009-04-12T23:11:18.397
> 
> 标签：c++, stl, stl-algorithm

我一直想知道为什么不能使用本地定义的类作为 STL 算法的谓词。

在问题中：[接近 STL 算法、lambda、本地类和其他方法](https://stackoverflow.com/questions/256557/approaching-stl-algorithms-lambda-local-classes-and-other-approaches)，BubbaT 提到说“*由于 C++ 标准禁止将本地类型用作参数*”

示例代码：

```
int main() {
   int array[] = { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 };
   std::vector<int> v( array, array+10 );

   struct even : public std::unary_function<int,bool>
   {
      bool operator()( int x ) { return !( x % 2 ); }
   };
   std::remove_if( v.begin(), v.end(), even() ); // error
} 
```

有谁知道标准中的限制在哪里？禁止本地类型的理由是什么？

* * *

**编辑**：从 C++11 开始，使用本地类型作为模板参数是合法的。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-04-12T23:15:14.007

C++98/03 标准明确禁止它。

C++11 移除了这个限制。

为了更完整：

> C++03 （和 C++98）标准**的第 14.3.1 条****中列出** 了对用作模板参数的类型的限制：
> 
>  **本地类型、没有链接的类型、未命名类型或由这些类型中的任何一种组合而成的类型不应用作模板类型参数的模板参数。**

 **```
template <class T> class Y { /* ... */  }; 
void func() {   
      struct S { /* ... */ }; //local class   
      Y< S > y1; // error: local type used as template-argument  
      Y< S* > y2; // error: pointer to local type used as template-argument } 
```

来源和更多细节：[http ://www.informit.com/guides/content.aspx?g=cplusplus&seqNum=420](http://www.informit.com/guides/content.aspx?g=cplusplus&seqNum=420)

总而言之，这个限制是一个错误，如果标准发展得更快，这个错误会更早修复……

也就是说，今天大多数通用编译器的最新版本确实允许它，并提供 lambda 表达式。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-14T10:46:46.020

该限制将在 '0x 中删除，但我认为您不会经常使用它们。那是因为 C++-0x 将有 lambdas！:)

```
int main() {
   int array[] = { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 };
   std::vector<int> v( array, array+10 );

   std::remove_if( v.begin()
                 , v.end()
                 , [] (int x) -> bool { return !(x%2); })
} 
```

我在上面的语法可能并不完美，但大致的想法是存在的。

# wpf - 如何通过单击按钮展开 Datagrid 详细信息部分？

> ID：742612
> 
> 赞同：3
> 
> 时间：2009-04-12T23:12:56.443
> 
> 标签：wpf, .net-3.5

我正在尝试实现一个像文件夹树一样工作的数据网格（即每一行代表一个文件夹，详细信息视图是另一个显示文件夹中文件的数据网格）。为了简单起见，我尝试精简代码，因此可能会出现错误，但这是我的基本 XAML 布局：

```
<my:DataGrid Name="dataGrid1" AutoGenerateColumns="False" ItemsSource="{Binding}">
    <my:DataGrid.RowDetailsTemplate>
        <DataTemplate>
            <my:DataGrid ItemsSource="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type my:DataGrid}}, Path=SelectedItem.Files}" AutoGenerateColumns="False" HeadersVisibility="None">
                <my:DataGrid.Columns>
                    <my:DataGridTextColumn Binding="{Binding Path=FileName}" />
                    <my:DataGridTextColumn Binding="{Binding Path=FSize}" />
                </my:DataGrid.Columns>
            </my:DataGrid>
        </DataTemplate>
    </my:DataGrid.RowDetailsTemplate>
    <my:DataGrid.Columns>
        <my:DataGridTemplateColumn CanUserResize="False" CanUserSort="False" Width="16">
            <my:DataGridTemplateColumn.CellTemplate>
                <DataTemplate>
                    <Button Click="Button_Click_1">
                        <Image Source="resources/+.ico" />
                    </Button>
                </DataTemplate>
            </my:DataGridTemplateColumn.CellTemplate>
        </my:DataGridTemplateColumn>
        <my:DataGridTextColumn Header="Name" Binding="{Binding Path=Name}" />
    </my:DataGrid.Columns>
</my:DataGrid> 
```

我试图让按钮展开详细信息行，但我不确定如何引用该行：

```
 private void Button_Click_1(object sender, RoutedEventArgs e)
    {
        // how do I reference a row here?
        DataGridRow row = ?
        // so I can do this:
        if (row.DetailsVisibility == Visibility.Collapsed)
            row.DetailsVisibility = Visibility.Visible;
        else
            row.DetailsVisibility = Visibility.Collapsed;
    } 
```

希望问题很清楚......谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-05T15:27:37.117

```
 private void Button_Click_1(object sender, RoutedEventArgs e)
    {
        DependencyObject obj = (DependencyObject)e.OriginalSource;
        while (!(obj is DataGridRow) && obj != null)
            obj = VisualTreeHelper.GetParent(obj);

        if(obj is DataGridRow)
            (obj as DataGridRow).DetailsVisibility = Visibility.Visible;
    } 
```

...等等瞧

# iphone - iphone：找到CGPath的坐标

> ID：742619
> 
> 赞同：0
> 
> 时间：2009-04-12T23:15:29.917
> 
> 标签：iphone

我使用 CGContextBeginPath、CGContextAddLineToPoint 和 CGContextMoveToPoint 绘制了一个具有 10 个 (x,y) 点的折线图（作为未闭合路径）。我希望能够通过触摸屏幕来检索用户输入水平坐标 (x) 的路径的垂直坐标 (y)，以便显示有关图形的更多信息。关于实现这一目标的最佳方法的任何想法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-12T23:36:32.473

y = mx + b

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-10-13T09:05:43.357

使用 CGPathGetCurrentPoint(CGPath *) 方法。希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T07:44:32.260

```
NSLog(@"PATH: %@",CGRectCreateDictionaryRepresentation(CGPathGetPathBoundingBox(pathRef))); 
```

# javascript - 在 JavaScript 中删除对象

> ID：742623
> 
> 赞同：381
> 
> 时间：2009-04-12T23:18:31.907
> 
> 标签：javascript, pointers, object, memory-management, garbage-collection

我对 JavaScript 的`delete`运算符有点困惑。采取以下代码：

```
var obj = {
    helloText: "Hello World!"
};

var foo = obj;

delete obj; 
```

在这段代码被执行之后，`obj`is `null`，但`foo`仍然指代一个与 完全一样的对象`obj`。我猜这个对象与`foo`指向的对象相同。

这让我很困惑，因为我预计写入会`delete obj`删除内存中指向的对象`obj`——而不仅仅是变量`obj`。

这是因为 JavaScript 的垃圾收集器在保留/释放的基础上工作，所以如果我没有任何其他变量指向该对象，它将*从*内存中删除？

（顺便说一下，我的测试是在 Safari 4 中完成的。）

* * *

## 回答 #1

> 赞同：473
> 
> 时间：2009-04-12T23:59:07.177

delete 操作符只删除一个引用，而不是一个对象本身。如果它确实删除了对象本身，其他剩余的引用就会悬空，就像 C++ 删除一样。（访问其中一个会导致崩溃。使它们全部变为空意味着在删除每个对象时需要额外的工作或额外的内存。）

由于 Javascript 是垃圾收集的，因此您不需要自己删除对象 - 当无法再引用它们时，它们将被删除。

如果您完成了对对象的引用，删除对它们的引用会很有用，因为这为垃圾收集器提供了更多关于可以回收的信息。如果对大对象的引用仍然存在，这可能会导致它未被回收——即使您的程序的其余部分实际上并未使用该对象。

* * *

## 回答 #2

> 赞同：163
> 
> 时间：2009-04-12T23:39:51.327

该`delete`命令对常规变量没有影响，只有属性。命令后`delete`属性没有 value `null`，它根本不存在。

如果属性是对象引用，该`delete`命令将删除属性但不删除对象。如果对象没有其他引用，垃圾收集器将处理该对象。

例子：

```
var x = new Object();
x.y = 42;

alert(x.y); // shows '42'

delete x; // no effect
alert(x.y); // still shows '42'

delete x.y; // deletes the property
alert(x.y); // shows 'undefined' 
```

（在 Firefox 中测试。）

* * *

## 回答 #3

> 赞同：57
> 
> 时间：2011-07-13T20:54:59.957

“隐式声明的变量”是全局对象的属性，因此 delete 对它们起作用，就像它对任何属性起作用一样。用 var 声明的变量是坚不可摧的。

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2009-04-12T23:42:55.530

来自 Mozilla 文档，“您可以使用 delete 运算符删除隐式声明的变量，但不能删除使用 var 语句声明的变量。”

这是链接：[https ://developer.mozilla.org/En/Core_JavaScript_1.5_Reference:Operators:Special_Operators:delete_Operator](https://developer.mozilla.org/En/Core_JavaScript_1.5_Reference:Operators:Special_Operators:delete_Operator)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2016-04-15T10:55:04.277

`delete`不用于删除 java Script 中的对象。

`delete`用于`object key`在您的情况下删除

```
var obj = { helloText: "Hello World!" }; 
var foo = obj;
delete obj; 
```

*对象未删除检查 obj 仍然采用相同的值* 删除用法：

```
delete obj.helloText 
```

然后检查`obj, foo`，两者都是空对象。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-04-07T22:51:28.647

除了 GC 问题，为了性能，应该考虑浏览器可能在后台进行的优化 ->

[http://coding.smashingmagazine.com/2012/11/05/writing-fast-memory-efficient-javascript/](http://coding.smashingmagazine.com/2012/11/05/writing-fast-memory-efficient-javascript/)

似乎将引用设为空而不是删除它可能会更好，因为这可能会改变 Chrome 使用的幕后“类”。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-09-18T10:36:23.970

设置一个变量来`null`确保打破所有浏览器中对对象的任何引用，包括在 DOM 元素和 Javascript 范围之间进行的循环引用。通过使用`delete`命令，我们将对象标记为在垃圾收集的下一次运行时被清除，但如果有多个变量引用同一个对象，删除单个变量不会释放对象，它只会删除该变量之间的链接和物体。并且在垃圾收集的下一次运行中，只会清理变量。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-02-12T17:17:00.943

刚刚找到了一个[jsperf](http://jsperf.com/delete-vs-undefined-vs-null/3)，鉴于此问题，您可能会认为这很有趣。（将其保留在周围以完成图片可能会很方便）

*它比较**delete**，设置**null**和设置**undefined**。*

但请记住，它会在您多次删除/设置属性时测试情况。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-11-17T22:03:36.657

IE 5 到 8 有一个错误，在宿主对象（窗口、全局、DOM 等）的属性上使用删除会引发 TypeError“对象不支持此操作”。

```
var el=document.getElementById("anElementId");
el.foo = {bar:"baz"};
try{
    delete el.foo;
}catch(){
    //alert("Curses, drats and double double damn!");
    el.foo=undefined; // a work around
} 
```

稍后如果您需要检查该属性在哪里具有意义，则使用全值`el.foo !== undefined`，因为`"foo" in el` 在 IE 中将始终返回 true。

如果你真的需要财产真正消失......

```
function hostProxy(host){
    if(host===null || host===undefined) return host;
    if(!"_hostProxy" in host){
       host._hostproxy={_host:host,prototype:host};
    }
    return host._hostproxy;
}
var el=hostProxy(document.getElementById("anElementId"));
el.foo = {bar:"baz"};

delete el.foo; // removing property if a non-host object 
```

如果您需要将主机对象与主机 API 一起使用...

```
el.parent.removeChild(el._host); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-08-04T07:30:13.087

我在寻找同样的答案时偶然发现了这篇文章。我最终做的只是弹出`obj.pop()`对象中所有存储的值/对象，以便我可以重用该对象。不确定这是否是不好的做法。这种技术对我在 Chrome 开发工具或 FireFox Web 控制台中测试我的代码非常有用。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-06-26T17:36:11.557

这对我有用，虽然它不是一个好习惯。它只是删除对象所属的所有关联元素。

```
 for (element in homeService) {
          delete homeService[element];
  } 
```

# robot - 是否有任何 CRobots 风格的游戏支持用一种以上语言编写的机器人？

> ID：742628
> 
> 赞同：8
> 
> 时间：2009-04-12T23:23:44.517
> 
> 标签：robot

许多年前，当我刚开始编程时，我遇到了一些 CRobots 风格的编程游戏（我认为它实际上不是 CRobots，而是某种克隆），玩起来非常酷。

最近我有了一种“编程是工作，而不是游戏”的感觉，我宁愿摆脱这种感觉，所以我想有什么比挑战我的同事来比谁能做最好的机器人更好。

然而，由于有许多不同层次的经验，以及对编程语言的许多不同偏好，我宁愿不将竞争与单一语言联系起来。我在谷歌搜索深夜后发现的那些似乎与单一语言相关联，即使是基于 Java 的那些（如 Robocode）似乎在尝试使用 Jython 或其他基于 JVM 的语言时也存在问题（理论上应该管用）。

有没有这种类型的游戏不限于单一语言？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-18T22:22:16.060

经过更多的挖掘，我发现了两个似乎相当成熟的项目：[IWOR](http://iwor.sourceforge.net/)和[RealTimeBattle](http://realtimebattle.sourceforge.net/)，它们都是基于简单的消息系统，让机器人与控制战斗的服务器进行通信。

这意味着您可以使用任何您想要的语言实现机器人，只要它可以支持套接字（用于 IWOR）或标准输入/标准输出（用于 RTB）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-15T00:43:21.110

Robocode 将成为 . [NET](http://zamboch.blogspot.com/2010/01/robocode-net-alpha-bits.html)即将启用。JVM 的其他语言也有很大的潜力。

# .net - 如何在 C# 中访问 Main 之外的命令行参数

> ID：742630
> 
> 赞同：23
> 
> 时间：2009-04-12T23:26:06.397
> 
> 标签：.net, command-line, dependencies

我正在编写一个需要解析进程命令行的 .NET 类。我不想在 Main() 方法和那个类之间有依赖关系。类如何访问命令行？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-04-12T23:27:37.797

打电话`Environment.GetCommandLineArgs()`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-05-12T11:01:21.830

如果您使用**.NET Compact Framework**，则未实现 Environment.GetCommandLineArgs() 方法并且 System.Diagnostics.Process.GetCurrentProcess().StartInfo.Arguments 始终返回空字符串，因此**您必须使用 main 函数**并将参数传递给其他类.

一个例子 ：

```
[MTAThread]
static void Main(String[] commandLineArguments)
{
  CommandLineHelper.parse(commandLineArguments);
}

public static class CommandLineHelper
{
  public static void parse(String[] commandLineArguments) {
    // add your code here
  }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-12T23:31:23.983

创建一个包含应用程序选项的类。在 main 方法中创建该类的一个实例，使用命令行参数对其进行初始化，并将其传递给需要它的类。

或者，您可以在之后的任何时间通过`CustomConfigClass.Create()`使用`Environment.GetCommandLineArgs()`.

第一个选项是我的建议，因为它使类更容易为单元测试做准备，并在以后切换到另一种配置方法，而不会由于对命令行的依赖而破坏应用程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-12T23:31:19.537

```
System.Diagnostics.Process.GetCurrentProcess().StartInfo.Arguments 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-11T05:01:23.447

String[] myStr = Environment.GetCommandLineArgs();

完成这个例子总是好的。

# vb.net - 适配器更新

> ID：742631
> 
> 赞同：-1
> 
> 时间：2009-04-12T23:26:29.080
> 
> 标签：vb.net, ado.net, dataadapter

我使adapter.insert和adapter.delete都可以正常工作，但不能与adapter.delete一起使用，即使我只在这里输入参数代码

Protected Sub Button2_Click(ByVal sender As Object, ByVal e As System.EventArgs) 处理 Button2.Click usersAdp.Fill(userstable) usersAdp.Update(txtid.Text, Me.txtname.Text, Me.txtemail.Text, Me.txtpassword。 Text, Me.txtconfirm.Text, Me.txtcode.Text, Me.CheckBox1.Checked = True) Me.GridView1.DataSource = userstable Me.GridView1.DataBind() End Sub

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-03T12:31:20.923

这个适配器的数据源是什么——如果它是一个 SQL 表，它是否定义了主键？

当您键入 usersAdp.Update 方法时，智能感知应该为您提供具有各种参数数量和合法组合参数类型的选项。确保向它传递作为合法选项之一的数字和参数类型。

# ruby - 让 gem 的 rake 任务随处可用？

> ID：742633
> 
> 赞同：33
> 
> 时间：2009-04-12T23:27:42.040
> 
> 标签：ruby, rake

所以我正在写一个小宝石，里面有一个“/任务”目录，里面有一些特定的 rake 任务。如何在需要 gem 的地方自动使这些任务可用？例如，我希望在安装 gem 后，我可以在我的 rails 根目录中运行 'rake mygemrake:task'。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2010-11-08T09:48:43.060

对于 Rails3 应用程序，您可能希望考虑为您的 gem 制作 Railtie。

你可以这样做：

**lib/your_gem/railtie.rb**

```
require 'your_gem'
require 'rails'
module YourGem
  class Railtie < Rails::Railtie
    rake_tasks do
      require 'path/to/rake.task'
    end
  end
end 
```

**lib/your_gem.rb**

```
module YourGem
  require "lib/your_gem/railtie" if defined?(Rails)
end 
```

不过，`rake.task`在我的`railtie.rb`. 我选择只在块内定义我的 measley 一两个任务`rake_tasks`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-13T13:59:22.303

Check out the [rdoctask](http://github.com/jimweirich/rake/blob/783adcadb3e6b6c8052ff1f71a6428da45c31d32/lib/rake/rdoctask.rb) in rake for an example of how to define a task provided by a gem. The task is defined in ruby instead of the rake build language and can be required like so:

```
require 'rake'             # the gem
require 'rake/rdoctask'    # the task 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T13:43:56.707

这就是[清酒](http://errtheblog.com/posts/60-sake-bomb)的用途。Datamapper 和 Merb 一直在成功使用 Sake。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-30T22:13:15.730

您可以为 gem 编写正常的 rake 任务并像这样加载它们：

```
require 'rake'
load 'path/to/your/tasks.rake' 
```

另外，看看[thor 与 rake](https://stackoverflow.com/questions/3524296/rake-vs-thor-for-automation-scripts)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-07-28T16:34:09.877

您必须在应用程序的 Rakefile 中导入这些任务。这是我的样子（我正在使用 bundler08 来管理我的 gem）：

```
%w(gem1 gem2 gem3).each do |g|
  Dir[File.dirname(__FILE__) + "/vendor/bundler_gems/**/#{g}*/tasks/*.rake"].each do |f|
    import f
  end
end 
```

# php - 在 xampp 上安装 cake php

> ID：742646
> 
> 赞同：1
> 
> 时间：2009-04-12T23:34:41.977
> 
> 标签：php, mysql, configuration, cakephp, xampp

我在运行 XP 的笔记本电脑上安装了 xampp，它已经运行了很长时间，没有任何问题。

我刚刚尝试安装 cakephp，并更改了数据库配置并启用了 mod_rewrite。

但现在我在欢迎页面上得到以下信息：

> 您的 tmp 目录是可写的。
> 
> FileEngine 用于缓存。要更改配置编辑 APP/config/core.php
> 
> 您的数据库配置文件存在。
> 
> Cake 无法连接到数据库。

我不知道为什么它没有连接到数据库。有没有其他人遇到过这个问题并且知道如何解决它？

*编辑关于在蛋糕中配置数据记录的建议也会有很大帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-02-26T19:18:37.500

当使用 phpmyadmin 为 phpcake 添加用户连接时，我必须将主机设置为`localhost`而不是`%`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-13T14:44:10.637

首先，编辑`~/app/config/core.php`并将调试提高到 2，这将为您提供更详细的错误报告。

其次，三重检查你的`~/app/config/database.php`，并 110% 确定那里没有错字。如果没有错字，请尝试使用非蛋糕脚本连接相同的数据。

如果这也失败了，您可能需要检查 Apache 和 MySQL 日志文件，甚至您的防火墙（如果有的话）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-19T23:57:38.990

您是否检查过您的数据库用户名和密码是否正确？

还要确保您的数据库确实存在。

以下是 XAMPP 使用的默认用户名和密码（实际上是没有密码）：

```
var $default = array(
    'driver' => 'mysql',
    'persistent' => false,
    'host' => 'localhost',
    'login' => 'root',
    'password' => '',
    'database' => 'db_name',
    'prefix' => '',
); 
```

# xna - LoadContent 在我的组件中不起作用

> ID：742651
> 
> 赞同：4
> 
> 时间：2009-04-12T23:37:59.083
> 
> 标签：xna

由于某种原因，我的组件中没有调用 LoadContent 方法。例如，我有我做的游戏类：

```
//Game.cs
protected override void LoadContent() {
  editor = new Editor(...);
  Components.Add(editor);
}

//Editor.cs
public class Editor : DrawableGameComponent{
  Game game;
  public Editor(Game game, ...):base(game){
     this.game = game;
  }

  //THIS method never gets called!
  protected override void LoadContent() {
          background = game.Content.Load<Texture2D>("background");
          base.LoadContent();
  }
} 
```

有小费吗？

编辑：当您记住 Initialize 和 LoadContent 的顺序时，一切正常！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-13T05:23:23.107

我怀疑您的问题是由于[Initialize](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.game.initialize.aspx)功能造成的。 `LoadContent`由 调用`Initialize`。您需要检查两件事：

1.  验证您是否在调用之前在 Game.cs 中创建和添加可绘制游戏组件`base.Initialize()`。在上面的代码中，您在`LoadContent`Game.cs 的函数中创建和添加组件，该组件发生在`Initialize`.
2.  验证`Initialize`您的`Editor`类中的函数是否正在调用基`Initialize`函数：

    ```
    public override void Initialize()
    {
        base.Initialize();
    } 
    ```

查看Nick Gravelyn 的这篇[博文了解更多信息。](http://nickgravelyn.com/2008/11/life-of-an-xna-game/)与您的问题特别相关，尼克在他的帖子中写道：

1.  首先，您将接到 Initialize 的调用。这是您通常为游戏放置非图形初始化代码的地方*。您还需要确保调用 base.Initialize()。当你这样做时，游戏会做一些事情：
    1.  对 Components 集合中的每个 GameComponent 调用 Initialize。
    2.  创建图形设备。
    3.  在游戏上调用 LoadContent。
    4.  为 Components 集合中的每个 DrawableGameComponent 调用 LoadContent。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-12-28T14:50:14.000

如果在调用 base.Initialize 之前尚未注册 GraphicsDeviceManager，则不会调用 LoadContent。以下代码为游戏正确注册了 GraphicsDeviceManager。

```
public class Game1 : Microsoft.Xna.Framework.Game
{
    GraphicsDeviceManager graphics;

    public Game1()
    {
        graphics = new GraphicsDeviceManager(this);
    }

    protected override void Initialize()
    {
        base.Initialize();
    }
} 
```

# asp.net - 在 ASP.NET MVC Ajax.ActionLink 中获取输入值或 JavaScript 变量

> ID：742655
> 
> 赞同：3
> 
> 时间：2009-04-12T23:41:13.567
> 
> 标签：asp.net, asp.net-mvc

我想将输入控件值（例如`textbox1.value`或 javascript 变量）传递给控制器​​操作方法（作为参数），而无需表单发布（使用 Ajax.ActionLink）。请看下面的代码。

是否可以`new {name = textbox1.value}`在 Ajax.ActionLink 中分配类似的东西。

看法

```
<input type="text" id="textbox1" />
<%= Ajax.ActionLink("mylink", "linkfunction", new {name = textbox1.value}, new AjaxOptions { UpdateTargetId = "result"}) %>
<span id="result"></span> 
```

控制器动作是：

```
public string linkfunction(string name)
{
    return  DateTime.Now.ToString();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-12T23:48:28.183

这与此类似：

[ASP.NET MVC：AJAX ActionLink - 以 HTML 属性为目标](https://stackoverflow.com/questions/488726/asp-net-mvc-ajax-actionlink-target-an-html-attribute)

另外，您不需要将控件名称传递到您的操作中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-16T02:26:42.080

我遇到了同样的问题，除了我使用 jQuery 来发出我的 ajax 请求：

```
$('#ajax-content').load('<%= this.Url.Action("Details", "Page", new { id = someJavascriptVariable }) %>'); 
```

我让它像这样工作：

```
$('#ajax-content').load('<%= this.Url.Action("Details", "Page", ) %>' + '/' + someJavascriptVariable); 
```

或者，在您的情况下，它可能如下所示：

```
$('#ajax-content').load('<%= this.Url.Action("Details", "Page", ) %>' + '?name=' + textbox1.value); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T06:23:49.470

我有一个类似的问题。一旦有人向我指出这些函数返回字符串，其余的就到位了——所以，试试下面的

```
Ajax.ActionLink("mylink", "linkfunction", 
    new {name = __MyValue__}, new AjaxOptions 
    { UpdateTargetId = "result"}).Replace("__MyValue__", textbox1.value) 
```

我还没有测试过这个片段，但这样的东西对我来说效果很好。

祝你好运。

# java - 如何在 Java 中将文本解析为列表？

> ID：742660
> 
> 赞同：0
> 
> 时间：2009-04-12T23:49:17.027
> 
> 标签：java, parsing

我将以下文件另存为`.txt`：

```
I Did It Your Way, 11.95
The History of Scotland, 14.50
Learn Calculus in One Day, 29.95
Feel the Stress, 18.50
Great Poems, 12.95
Europe on a Shoestring, 10.95
The Life of Mozart, 14.50 
```

`JList`我需要在 Java中显示书名和不同 s 的价格。我怎么做？

另外，如果我有一个包含两个值的数组（一旦我将标题与价格分开），我如何将标题和价格复制到它们各自的数组中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-13T01:56:43.383

看起来很简单，你不需要任何花哨的东西。

```
BufferedReader r = new BufferedReader(new FileReader("file.txt"));
List<String> titles = new ArrayList<String>();
List<Double> prices = new ArrayList<Double>();

while ((String line = r.readLine()) != null) {
  String[] tokens = line.split(",");
  titles.add(tokens[0].trim());
  prices.add(Double.parseDouble(tokens[1].trim()));
}

r.close(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T10:41:18.490

如果值用逗号分隔，您可以使用[http://opencsv.sourceforge.net/](http://opencsv.sourceforge.net/)。这是示例代码，

```
 CSVReader reader = new CSVReader(new FileReader("test.txt"));
    List myEntries = reader.readAll();

    int noOfEntries=myEntries.size();

    String[] titles=new String[noOfEntries]; 
    String[] price=new String[noOfEntries]; 

    String[] entry=null;
    int i=0;
    for(Object entryObject:myEntries){
        entry=(String[]) entryObject;
        titles[i]=entry[0];
        price[i]=entry[1];
        i++;
            } 
```

# requirements - 内置投票系统的需求工具？

> ID：742662
> 
> 赞同：1
> 
> 时间：2009-04-12T23:50:12.190
> 
> 标签：requirements

有没有内置投票系统的需求收集工具？使用分类效果不佳，因为土地法一直由最后审查的人说了算。这是解决项目需求阶段意见分歧的建议解决方案。 [委员会设计](http://en.wikipedia.org/wiki/Design_by_committee)是众所周知的反模式。有一个标准的“技巧”，可以将事物归类为美好的事物，并为其他人提供机会来认识到某些需求缺乏价值。不幸的是，允许民主决策过程的请求似乎太合理而无法拒绝。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T00:03:50.910

Bugzilla 虽然是一个问题跟踪器而不是一个需求收集工具，但也有一个[投票机制](http://www.bugzilla.org/docs/2.22/html/voting.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T00:02:39.117

[Jira](http://www.atlassian.com/software/jira/)是一个问题跟踪器和整体项目管理系统，我发现它运行良好。它有投票权。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T10:09:02.687

[Playground](http://www.playground-hq.com)内置了投票功能，它是专门为需求获取和组织而设计的工具（披露：我是所有者/开发人员）

然而——在大多数情况下，利益相关者没有平等的投票权——他们中的一些人拥有更高的权力和决策权。从外部“外包想法”时可以最成功地使用投票 - 请参阅 UserVoice。在内部和客户项目上，您只需构建客户想要的任何东西。

# ruby-on-rails - Rails 插件在启动时运行迁移？

> ID：742665
> 
> 赞同：3
> 
> 时间：2009-04-12T23:55:21.833
> 
> 标签：ruby-on-rails

是否有一个插件可以让 Rails 在启动时通过 db:migrate 运行？我正在寻找一种不涉及通过 shell 调用 Rake 任务的解决方案；所以，没有“ `system('rake db:migrate')`”。

我可以很容易地编写自己的插件来做到这一点，但认为如果存在的话，使用/改进现有的 migrate-on-init 插件会更好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T00:45:40.093

这是我在 jRuby 上的 Rails 3.2 工作版本：

```
config.after_initialize do
  ActiveRecord::Migrator.migrate(Rails.root.join("db/migrate"), nil)
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-27T01:10:38.103

将以下内容放入 Rails::Initializer 块中的 environment.rb ...

```
  config.after_initialize 做
    ActiveRecord::Migrator.migrate (RAILS_ROOT + "/db/migrate" )
  结尾

```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-06T23:45:08.617

使用`config.after_initialize`有效，但有两个问题：

1.  它在所有其他初始化程序之后运行，因此如果这些初始化程序执行一些数据库操作，他们将使用旧模式

2.  它可以在所有环境中运行，包括 Rake 任务和 Resque 工作者。我们不想每次运行时都自动迁移`rake routes`，对吗？而且我们不希望同时发生多个迁移。

我的解决方案是使用一个`config/initializers`文件，这样我就可以决定它的运行顺序，并检查我们是否在 rake 任务中。

此外，在我对部署时自动迁移感到满意之前，我只在`development`and`test`环境中执行此操作。

最后，我想打印一些额外的信息（迁移到版本和从版本迁移），所以我没有使用单行，而是进入迁移器，可能比我应该更亲密。

哦耶！它也应该写`schema.rb`。所以我公然`db:schema:dump`从内部窃取代码`active_record/railties/databases.rake`。（如果 rake 任务是对象上的方法，那不是很好吗，所以我们可以直接调用它们？）

`config/initializers/automatically_migrate.rb`：

```
# don't do this in production
if (Rails.env.development? or Rails.env.test?) and
    # don't do this in a worker or task
    !defined?(Rake)  # SEE BELOW FOR POSSIBLE FIX

  migrations_paths = ActiveRecord::Migrator.migrations_paths
  migrator = ActiveRecord::Migrator.new(:up, migrations_paths, nil)
  pending_migrations = migrator.pending_migrations
  unless pending_migrations.empty?
    puts "Migrating from #{migrator.current_version} to #{pending_migrations.last.version}"
    migrator.migrate

    require 'active_record/schema_dumper'
    filename = ENV['SCHEMA'] || "#{Rails.root}/db/schema.rb"
    File.open(filename, "w:utf-8") do |file|
      ActiveRecord::Base.establish_connection(Rails.env)
      ActiveRecord::SchemaDumper.dump(ActiveRecord::Base.connection, file)
    end

  end

end 
```

更新：显然 Rake 的新版本在加载时更加自由，因此表达式`!defined?(Rake)`总是错误的，即使是从命令行运行（即不在 Rake 任务或 Resque Worker 中）。我正在尝试以下方法

```
caller.grep(/rake/).empty? 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-06-17T18:16:18.300

山姆的答案对我不太有效。我正在使用 Rails 3.0，我认为您可能需要在 application.rb 中添加它，在类中的任何位置。

```
config.after_initialize do
  ActiveRecord::Migrator.migrate (RAILS_ROOT + "/db/migrate" )
end 
```

在类似的说明中，我正在使用 JRuby 和 Deploying as a War，我想知道为什么这不是为我创建表，而是抱怨表*such&such*不存在。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2009-04-26T14:52:52.740

根据我的经验，db:migrate-like 例程应该只在存在新迁移时调用，因为它需要相当多的时间。您真的不应该有太多无法跟踪它们何时存在的迁移。

也就是说，在生产环境中运行新迁移的任务最好由 Capistrano 等部署工具来处理。当部署到生产盒时，capistrano 会运行​​迁移，如果你也告诉它的话。

在 every-init 上运行 db:migrate-like 例程会浪费资源和时间。

# memory - 在 VB6 应用程序中识别内存占用的工具

> ID：742671
> 
> 赞同：12
> 
> 时间：2009-04-13T00:03:23.530
> 
> 标签：memory, vb6, memory-management

有哪些工具可用于将 VB6 应用程序中的内存消耗归因于它的多个组件？我可以通过查看各种计数器（私有字节、工作集等）来获取整个应用程序消耗的内存，例如，在 Process Explorer 中。我想更深入地了解运行时创建的各种组件或对象消耗了多少内存。例如，弄清楚在运行时缓存数据的大型集合消耗了多少内存，以及它如何根据集合中元素的数量而变化。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-17T13:04:46.753

我最喜欢的工具必须是 DevPartner，虽然它的价格为 1,500 英镑，但并不便宜。虽然它比内存泄漏检查要多得多，但如果这就是你所需要的，你可能是地毯式轰炸蚂蚁。

如果您想查看您的应用程序是否正确释放资源，请使用我编写的此函数将内存转储到给定位置。我将首先缓存每个变量的地址，然后在关闭时调用 DumpVariableMemory 传递对这些位置的引用，以查看它们是否已被释放。

如果您还没有，您还需要添加一个声明 fopr CopyMemory :)

```
 Public Function DumpVariableMemory(ByVal lngVariablePointer&, _
                                   ByVal lngBufferSizeInBytes&) As String
    '' * Object Name:   DumpVariableMemory
    '' * Type:          Function
    '' * Purpose:       Returns a memory dump of the variable or pointer location
    '' * Created:       21/08/2006 - 17:41:32
    '' * Coder:         Richard Pashley - NUPUK00008148
    '' * Build Machine: W-XPRP-77
    '' * Encapsulation: Full
    '' * Parameters:    lngVariablePointer      -   Long    -   Pointer to the data to dump
    '' *                lngBufferSizeInBytes    -   Long    -   Size of the dump to ouput in bytes
    '' * Returns:       -                       -   String  -   Memory dump output as a string
    '' *                This will dump the memory location starting at the pointer address and
    '' *                ending at the address plus the offset (lngBufferSizeInBytes).
    '' *                You can use LenB to determine the size of the variable for the
    '' *                lngBufferSizeInBytes parameter if required.
    '' *                Example: DebugPrint DumpVariableMemory(VarPtr(lngMyLongValue),LenB(lngMyLongValue)
    '' * Modified By:   [Name]
    '' * Date:          [Date]
    '' * Reason:        [NUPUKxxxxxxxxx]
    '' Declare locals
    Dim lngBufferIterator&                  '' Buffer iterator
    Dim lngBufferInnerIterator&             '' Buffer loop inner iterator
    Dim bytHexDumpArray() As Byte           '' Received output buffer
    Dim strDumpBuffer$                      '' Formatted hex dump construction buffer
    Dim lngValidatedBufferSize&             '' Validated passed buffer size
    '' Turn on error handling
    On Error GoTo DumpVariableMemory_Err
    '' Resize output buffer
    ReDim bytHexDumpArray(0 To lngBufferSizeInBytes - 1) As Byte
    '' Retrieve memory contents from supplied pointer
    Call CopyMemory(bytHexDumpArray(0), _
       ByVal lngVariablePointer, _
       lngBufferSizeInBytes)
    '' Format dump header
    strDumpBuffer = String(81, "=") & vbCrLf & _
       "Pointer Address = &h" & Hex$(lngVariablePointer) & _
       "   Ouput Buffer Size = " & FormatBytes(lngBufferSizeInBytes)
    '' Add header seperator
    strDumpBuffer = strDumpBuffer & _
       vbCrLf & String(81, Chr$(61))
    '' Validate buffer dimensions
    If lngBufferSizeInBytes Mod 16 = 0 Then
        '' Validated ok so assign
        lngValidatedBufferSize = lngBufferSizeInBytes
    Else
        '' Refactor to base 16
        lngValidatedBufferSize = _
           ((lngBufferSizeInBytes \ 16) + 1) * 16
    End If
    '' Iterate through buffer contents
    For lngBufferIterator = 0 To (lngValidatedBufferSize - 1)
        '' Determine if first row
        If (lngBufferIterator Mod 16) = 0 Then
            '' Format dump output row
            strDumpBuffer = strDumpBuffer & vbCrLf & Right$(String(8, Chr$(48)) _
               & Hex$(lngVariablePointer + lngBufferIterator), 8) & Space(2) & _
               Right$(String(4, Chr$(48)) & Hex$(lngBufferIterator), 4) & Space(2)
        End If
        '' Determine required dump buffer padding
        If lngBufferIterator < lngBufferSizeInBytes Then
            '' Pad dump buffer
            strDumpBuffer = strDumpBuffer & Right$(Chr$(48) & _
               Hex(bytHexDumpArray(lngBufferIterator)), 2)
        Else
            '' Pad dump buffer
            strDumpBuffer = strDumpBuffer & Space(2)
        End If
        '' Determine required dump buffer padding
        If (lngBufferIterator Mod 16) = 15 Then
            '' Pad dump buffer
            strDumpBuffer = strDumpBuffer & Space(2)
            '' Iterate through buffer row
            For lngBufferInnerIterator = (lngBufferIterator - 15) To lngBufferIterator
                '' Validate row width
                If lngBufferInnerIterator < lngBufferSizeInBytes Then
                    '' Validate buffer constraints
                    If bytHexDumpArray(lngBufferInnerIterator) >= 32 And _
                       bytHexDumpArray(lngBufferInnerIterator) <= 126 Then
                        '' Ouput data to dump buffer row
                        strDumpBuffer = strDumpBuffer & _
                           Chr$(bytHexDumpArray(lngBufferInnerIterator))
                    Else
                        '' Pad dump buffer
                        strDumpBuffer = strDumpBuffer & Chr$(45)
                    End If
                End If
            Next
            '' Determine required dump buffer padding
        ElseIf (lngBufferIterator Mod 8) = 7 Then
            '' Pad dump buffer
            strDumpBuffer = strDumpBuffer & Chr$(45)
        Else
            '' Pad dump buffer
            strDumpBuffer = strDumpBuffer & Space(1)
        End If
    Next
    '' Assign result to function output
    DumpVariableMemory = strDumpBuffer & _
       vbCrLf & String(81, Chr$(61)) & vbCrLf
Exit_Point:
    Exit Function
    '' Error Handling
DumpVariableMemory_Err:
    LogError "modNYFixLibrary.DumpVariableMemory", Err.Number, Err.Description
    DumpVariableMemory = String(81, Chr$(61)) & vbCrLf & _
       "DumpFailed!" & vbCrLf & String(81, Chr$(61))
    GoTo Exit_Point
    Resume
End Function 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-05-20T15:51:59.393

[Memory Validator](http://www.softwareverify.com/visual-basic/memory/index.html)可以告诉您在 VB6 程序（以及 C++、C、Delphi、Fortran 95...）中分配（和泄漏）内存的位置。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-15T01:48:16.210

我不确定是否有任何公开可用的（免费）工具将 VB6 代码分析到模块级别。有几个可用于 C/C++ 和 .NET 的内存分析器，但在我看到的 VB6 上并不多。看起来这个领域的所有老供应商（IBM Purify、Compuware Devpartner/Boundschecker）要么被收购，要么只支持 .NET。

你可以试试[GlowCode](http://www.glowcode.com/index.htm)。它声明了 C++ 支持，但也强调了 Win32 本机 x86 图像。

Microsoft 发布了[DebugDiag](http://www.microsoft.com/downloads/details.aspx?FamilyID=28bd5941-c458-46f1-b24d-f60151d875a3&displaylang=en)，它支持 .NET 或 Win32 的内存泄漏检测，尽管我从未在 VB 中使用过它。它可能不会显示对模块级别的出色分配，但我敢打赌它至少会确定哪些库/dll 分配了最多的内存。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T15:00:58.560

MS 站点上还有另一个名为[processmonitor.exe](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)的工具。它报告每个请求调用，您可以使用它的过滤功能仅监视应用程序的处理请求。

# xslt - 使用打印出 XSL 变量的值

> ID：742676
> 
> 赞同：19
> 
> 时间：2009-04-13T00:08:23.613
> 
> 标签：xslt, xsl-variable

在根据节点是否存在设置变量之后，我正在尝试输出变量的文字字符串值。我认为条件检查逻辑是正确的。但它没有输出值......

```
<xsl:variable name="subexists"/>

<xsl:template match="class">
<xsl:copy><xsl:apply-templates select="@*|node()"/></xsl:copy>
<xsl:choose>
    <xsl:when test="joined-subclass">
        <xsl:variable name="subexists" select="'true'"/>
    </xsl:when>
    <xsl:otherwise>
        <xsl:variable name="subexists" select="'false'"/>
    </xsl:otherwise>
</xsl:choose>
subexists:  <xsl:value-of select="$subexists" /> 
```

我希望它输出“假”或“真”的文字字符串。但它没有输出任何东西。请帮忙！谢谢！！！

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-13T13:24:31.997

**在这种情况下，设置变量不需要条件**。

这个单行 XPath 表达式：

```
boolean(joined-subclass) 
```

仅**`true()`**当当前节点的子节点，named**`joined-subclass`**存在，**`false()`**否则。

**完整的样式表是**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes"/>

 <xsl:template match="class">
   <xsl:variable name="subexists"
        select="boolean(joined-subclass)"
   />

   subexists:  <xsl:text/>
   <xsl:value-of select="$subexists" />
 </xsl:template>
</xsl:stylesheet> 
```

**请注意**，在此表达式中使用 XPath 函数**[`boolean()`](http://www.w3.org/TR/xpath#function-boolean)**是将节点（或其不存在）转换为布尔值之一**`true()`**或**`false()`**.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-13T01:57:49.387

您的主要问题是认为您在模板之外声明的变量与在选择语句中“设置”的变量相同。这不是 XSLT 的工作方式，无法重新分配变量。这更像是您想要的：

```
<xsl:template match="class">
  <xsl:copy><xsl:apply-templates select="@*|node()"/></xsl:copy>
  <xsl:variable name="subexists">
    <xsl:choose>
      <xsl:when test="joined-subclass">true</xsl:when>
      <xsl:otherwise>false</xsl:otherwise>
    </xsl:choose>
  </xsl:variable>
  subexists:      <xsl:value-of select="$subexists" />
</xsl:template> 
```

如果您需要变量具有“全局”范围，则在模板之外声明它：

```
<xsl:variable name="subexists">
  <xsl:choose>
     <xsl:when test="/path/to/node/joined-subclass">true</xsl:when>
     <xsl:otherwise>false</xsl:otherwise>
  </xsl:choose>
</xsl:variable>

<xsl:template match="class">
   subexists:      <xsl:value-of select="$subexists" />
</xsl:template> 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-13T02:08:16.227

**在 XSLT 中，[`<xsl:variable>`](http://www.w3.org/TR/xslt#element-variable)它只能声明一次**，并且只能在其声明时被赋予一个值。如果同时声明了多个变量，它们实际上是不同的变量，具有不同的作用域。

因此，**实现变量的所需条件设置**并产生其值的方法如下：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes"/>

    <xsl:template match="class">
    <xsl:variable name="subexists">
            <xsl:choose>
                <xsl:when test="joined-subclass">true</xsl:when>
                <xsl:otherwise>false</xsl:otherwise>
            </xsl:choose>
        </xsl:variable>
        subexists:  <xsl:text/>    
        <xsl:value-of select="$subexists" />
    </xsl:template>
</xsl:stylesheet> 
```

**当上述转换应用于以下 XML 文档时**：

```
<class>
 <joined-subclass/>
</class> 
```

**产生了想要的结果**：

```
 subexists:  true 
```

# php - 我的 xpath/php 输出需要显示标签

> ID：742677
> 
> 赞同：1
> 
> 时间：2009-04-13T00:09:37.400
> 
> 标签：php, xpath

我正在尝试获得一个 xpath xpression，它将删除我的外部标签，但它正在删除它，加上内部标签并打印元素数据。我如何让它也打印我的提示标签？

**我的 php 看起来像这样：**

```
<?php
#get file
$xml = simplexml_load_file('content.xml') or die ("Unable to load XML string!");

#loop through results
foreach ( $xml->xpath('//prompt') as $voiceQ) {
  echo "<h2>Thank you for visiting our site2</h2>";
  print $voiceQ;
} //for
?> 
```

**我的 content.xml 看起来像这样**
（我正在写入这个文件并且它正在丢失一些格式。我认为这不是问题）：

```
<?xml version="1.0" encoding="UTF-8"?>
<result>
    <prompt>
        Welcome to Group Finder, Mary Lamb . We see that
        you  like the group:   JackJohnson
    </prompt>
</result> 
```

**我的输出如下所示：**
Welcome to Group Finder, Mary Lamb 。我们看到你喜欢这个组：JackJohnson

**但我希望它看起来像这样：（**
只需删除结果标签）：

```
<prompt>Welcome to Group Finder, Mary Lamb . We see that you  like the group: JackJohnson</prompt> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T11:58:59.910

在 SimpleXMLElement 上尝试[asXML方法：](http://us2.php.net/manual/en/function.simplexml-element-asXML.php)

```
<?php
$string = '<?xml version="1.0" encoding="UTF-8"?><result>
<prompt>Welcome to Group Finder, Mary Lamb . We see that you  like the group:   JackJohnson</prompt></result>';

#get file
$xml = new SimpleXMLElement($string);

#loop through results
foreach ( $xml->xpath('//prompt') as $voiceQ) {
  echo "<h2>Thank you for visiting our site2</h2>";
  print $voiceQ->asXML();
} //for
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-14T02:00:42.647

如果结果在提示范围内，只需循环多一点:)

```
 <php?
    #get file
    $xml = simplexml_load_file('content.xml') or die ("Unable to load XML string!");

    #loop through results
    foreach ( $xml->xpath('//prompt') as $voiceQ) {
      foreach($voiceQ AS $inVoice)
        {
           echo "<h2>Thank you for visiting our site2</h2>";
           print $inVoice;
         }
    } //for
    ?> 
```

# icons - 我应该对分层标签使用什么样的用户级抽象？

> ID：742678
> 
> 赞同：0
> 
> 时间：2009-04-13T00:10:08.397
> 
> 标签：icons, naming, categories

通过用户级抽象，我的意思是我应该如何称呼它们以及我应该在 UI 中使用什么样的图标来表示它？大多数用户现在应该熟悉标签的概念，但我不太确定分层标签是否如此，标签的抽象也不完全适合。

我所拥有的实际上是文件夹和标签之间的东西，因为每个子标签都是其父标签的适当子集。要获取文件夹标签事物的内容，您需要将其内容加上其子文件夹标签事物的内容并递归地执行此操作。在某种程度上，它们就像（在这里我只是在提问过程中部分回答了我自己的问题）类别。你们如何看待称它们为类别？你会给它什么样的图标，因为一个类别是一个抽象的概念，而不是一个可以形成形状的物理对象？

（如果需要，可以维基）

编辑：为了澄清起见，我正在寻找的是像萨莉阿姨这样的最终用户的抽象，可以轻松掌握这个概念。理想情况下，还有一个图形表示（图标）可以很容易地与该概念相关联。

Edit2：我确实忘记提及的一件事是，一个项目可以存在于多个类别中（很像 Google Doc 允许您将文档添加到多个文件夹中）。我想我已经把自己称为类别了。它正好适合你可以用它们做的一切。某些东西可以属于一个以上的类别，子类别是有意义的，人们通常创建的大多数子类别都适合一种 is-a 关系（例如，Windows 用户可能会在他们的“我的文档”文件夹中说一个名为 resumes 的文件夹，因为简历是一个文档，如果您将文件夹视为类别，那么它在“我的文档”中也是有意义的）

我还没有弄清楚的是图标（我 99% 确定我将使用某种 TreeView 来显示它们）我可以只使用我想的文件夹图标，也许是自定义文件夹图标，除非其他人有更好的主意。谷歌称它们为文件夹，所以我想这不会太糟糕吧？

为了进一步澄清，我的目标受众将是技术足以知道如何下载和安装应用程序的人，但仅此而已。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T00:52:40.667

如果您的目标受众是技术人员，那么 TreeViews 和/或文件夹是抽象分层数据的常用方法。它们都是复合模式的变体。

不过，在后谷歌时代，我倾向于认为层次分类不如平面标签/标签空间与非常快速的搜索相结合重要。恕我直言，如果数据集的大小很大（例如，> 1000 个文档/元素），那么分层分类的开销会超过将文档放入漂亮整洁的类别的名义好处。

如果您的目标受众是非技术性的，那么根据我的经验，非技术性用户不会获得层次结构，也不会花时间去找出一个以上的分类级别。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-15T05:01:05.640

对我来说，答案来自 Opera Desktop Team 博客（以及 Dotclear 的博客，它使用了相同的约定，感谢我也发现了它）：

`tag:subtag` -`CSS:font`

当您单击 CSS:font 时，您知道它是较大 CSS 标记的一部分。标签页面应该有一个文本表明父标签可用（或者你可以自己找到它，在维基百科上通过直接的 URL 操作）。

我有[一个关于 WordPress 的讨论](http://wordpress.org/support/topic/290016?replies=1#post-1138483)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T00:28:45.343

标签“详细信息”怎么样？由于子标签是适当的子集，因此可以将其视为将详细信息应用于标签...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-13T00:15:56.667

您可以使用“捆绑包”（如 del.ico.us 所做的那样）。我不确定是否不止一个级别对标签有意义。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-04-13T00:11:56.787

对我来说，这听起来像是一个大纲。

有[大纲标记语言](http://en.wikipedia.org/wiki/OML)（OML）。

# c# - 基于 LINQ 中任意键的不同对象列表

> ID：742682
> 
> 赞同：17
> 
> 时间：2009-04-13T00:12:42.510
> 
> 标签：c#, .net, linq

我有一些对象：

```
class Foo {
    public Guid id;
    public string description;
}

var list = new List<Foo>();
list.Add(new Foo() { id = Guid.Empty, description = "empty" });
list.Add(new Foo() { id = Guid.Empty, description = "empty" });
list.Add(new Foo() { id = Guid.NewGuid(), description = "notempty" });
list.Add(new Foo() { id = Guid.NewGuid(), description = "notempty2" }); 
```

我想以`id`字段唯一的方式处理此列表，并丢弃非唯一对象（基于 id）。

我能想到的最好的是：

```
list = list.GroupBy(i => i.id).Select(g=>g.First()).ToList(); 
```

是否有更好/更好/更快的方法来实现相同的结果。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-04-13T01:23:50.280

一个非常优雅和意图揭示的选项是在 IEnumerable 上定义一个新的扩展方法

所以你有了：

```
list = list.Distinct(foo => foo.id).ToList(); 
```

和 ...

```
 public static IEnumerable<T> Distinct<T,TKey>(this IEnumerable<T> list, Func<T,TKey> lookup) where TKey : struct {
        return list.Distinct(new StructEqualityComparer<T, TKey>(lookup));
    }

    class StructEqualityComparer<T,TKey> : IEqualityComparer<T> where TKey : struct {

        Func<T, TKey> lookup;

        public StructEqualityComparer(Func<T, TKey> lookup) {
            this.lookup = lookup;
        }

        public bool Equals(T x, T y) {
            return lookup(x).Equals(lookup(y));
        }

        public int GetHashCode(T obj) {
            return lookup(obj).GetHashCode();
        }
    } 
```

可以构建一个类似的帮助类来比较对象。（它需要做更好的空处理）

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-04-13T01:33:16.700

在我的非正式测试中，使用该`Distinct()`方法比使用 GroupBy() 快大约 4 倍。对于 100 万个 Foo，我的测试在大约 0.89 秒时使用 Distinct() 从非唯一数组中生成唯一数组，其中 GroupBy() 大约需要 3.4 秒。

我的 Distinct() 调用看起来像，

```
var unique = list.Distinct(FooComparer.Instance).ToArray(); 
```

`FooComparer`看起来像，

```
class FooComparer : IEqualityComparer<Foo> {
    public static readonly FooComparer Instance = new FooComparer();

    public bool Equals(Foo x, Foo y) {
        return x.id.Equals(y.id);
    }

    public int GetHashCode(Foo obj) {
        return obj.id.GetHashCode();
    }
} 
```

我的`GroupBy()`版本看起来像，

```
var unique = (from l in list group l by l.id into g select g.First()).ToArray(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-13T00:22:09.150

如果 id 字段相同，则创建一个`IEqualityComparer<Foo>`返回 true 的，并将其传递给 Distinct() 运算符。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-13T00:36:13.203

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            var list = new List<Foo>();
            list.Add(new Foo() { id = Guid.Empty, description = "empty" });
            list.Add(new Foo() { id = Guid.Empty, description = "empty" });
            list.Add(new Foo() { id = Guid.NewGuid(), description = "notempty" });
            list.Add(new Foo() { id = Guid.NewGuid(), description = "notempty2" });

            var unique = from l in list
                         group l by new { l.id, l.description } into g
                         select g.Key;
            foreach (var f in unique)
                Console.WriteLine("ID={0} Description={1}", f.id,f.description);
            Console.ReadKey(); 
        }
    }

    class Foo
    {
        public Guid id;
        public string description;
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-28T17:14:43.987

覆盖**Equals(object obj)**和**GetHashCode()**方法：

```
class Foo
{
    public readonly Guid id;
    public string description;

    public override bool Equals(object obj)
    {
        return ((Foo)obj).id == id;
    }
    public override int GetHashCode()
    {
        return id.GetHashCode();
    }
} 
```

然后只需调用**Distinct()**：

```
list = list.Distinct().ToList(); 
```

# c# - 从目录中选择随机文件

> ID：742685
> 
> 赞同：15
> 
> 时间：2009-04-13T00:15:09.540
> 
> 标签：c#, .net, file, random

我已经在 C# 中看到了一些示例，但到目前为止还没有看到，在目录下选择随机文件的最佳方法是什么？

在这种特殊情况下，我想每 15 分钟左右从“C:\wallpapers”中选择一张壁纸。

谢谢。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-04-13T00:20:14.583

获取数组中的所有文件，然后随机检索一个

```
var rand = new Random();
var files = Directory.GetFiles("c:\\wallpapers","*.jpg");
return files[rand.Next(files.Length)]; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-13T00:34:30.273

如果您正在为壁纸执行此操作，您不想只是随机选择一个文件，因为它不会对用户随机显示。

如果你连续三次选择同一个怎么办？还是两者交替？

这是“随机的”，但用户不喜欢它。

请参阅这篇文章，了解如何以[用户喜欢的方式显示随机图片](http://blog.asmartbear.com/blog/2007/12/18/not-in-the-cards.html)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-16T02:11:14.243

[从目录中选择随机文件](https://stackoverflow.com/questions/742887/select-random-file-from-directory)

```
private string getrandomfile2(string path)
    {
        string file = null;
        if (!string.IsNullOrEmpty(path))
        {
            var extensions = new string[] { ".png", ".jpg", ".gif" };
            try
            {
                var di = new DirectoryInfo(path);
                var rgFiles = di.GetFiles("*.*").Where( f => extensions.Contains( f.Extension.ToLower()));
                Random R = new Random();
                file = rgFiles.ElementAt(R.Next(0,rgFiles.Count())).FullName;
            }
            // probably should only catch specific exceptions
            // throwable by the above methods.
            catch {}
        }
        return file;
    } 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-13T00:21:29.713

```
var files = new DirectoryInfo(@"C:\dev").GetFiles();
int index = new Random().Next(0, files.Length);

Console.WriteLine(files[index].Name); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-13T00:20:38.840

为什么不只是：

1.  将文件放入数组
2.  使用 Random 类选择一个介于 0 和 files.Length 之间的随机数
3.  使用随机数作为索引从数组中抓取文件

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-13T00:21:43.563

使用`Directory.GetFiles(...)`获取文件名数组并使用`Random`类选择随机文件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-04-07T07:14:17.520

只是我的 5 美分，用于 mvc 操作的代码，使用 cookie，因此我们不会重复相同的文件名两次：

```
 [AllowAnonymous]
        //-------------------------------------------------------------
        public async Task<ActionResult> RandomBackground()
        //-------------------------------------------------------------
        {
            var basePath = "~/Content/images/backgrounds";
            var dir = System.Web.Hosting.HostingEnvironment.MapPath(basePath);

            var rand = new Random();
            var files = System.IO.Directory.GetFiles(dir, "*.jpg");
            if (files!=null)
            {
                var cookie = "Background";
                var pickedFile = "";
                var fileName = "";
                var oldFilename = "";
                while ((oldFilename == fileName) && files.Count<string>()>1)
                {
                    oldFilename = ReadControllerCookie(cookie);
                    pickedFile = files[rand.Next(files.Length)];
                    fileName = System.IO.Path.GetFileName(pickedFile);
                }
                SaveControllerCookie(cookie, fileName);
                return Content(fileName);
            }
            return new EmptyResult();
        } 
```

用作：

```
<img src="~/Content/images/backgrounds/@Html.Action("RandomBackground", "YourControllerName")"> 
```

# php - 如何将句子中的单词组合成组合词？

> ID：742686
> 
> 赞同：2
> 
> 时间：2009-04-13T00:15:12.957
> 
> 标签：php, nlp, semantics, composition

我有一句话，例如

> John Doe 去年搬到了纽约。

现在我将句子分成单个单词，我得到：

> array('John', 'Doe', 'move', 'to', 'New', 'York', 'last', 'year')

这很容易。但是后来我想组合单个单词来获得所有组合的术语。如果组合的术语有意义，那么我想得到所有这些。该操作的结果应如下所示：

> 约翰，能源部，约翰能源部，移动，能源部移动，约翰能源部移动，到，移动到，能源部移动到......

单词应该由 k 部分的限制组成。在上面的示例中，限制为 3。因此一个术语最多可以包含 3 个单词。

问题：如何在 PHP 中编写组合代码？如果我有一个函数，它将一个句子作为输入并给出一个包含所有术语的数组作为输出，那就太好了。

我希望你能帮助我。提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-13T00:26:03.883

每个构图都将由起点和长度定义 - 只需循环即可。

PHP 不会一直为您提供帮助，但它确实有一些方便的功能。

```
$words = explode(" ", $sentence);
for ($start = 0; $start < count($words); $start++) //starting point
{
   //try all possible lengths
   //limit = max length
   //and of course it can't overflow the string
   for ($len = 1; $len <= $limit && $len <= count($words)-$start; $len++)
   {
      //array_slice gets a chunk of the array, and implode joins it w/ spaces
      $compositions[] = implode(" ", array_slice($words, $start, $len));
   }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-13T00:41:07.370

如果您已经拥有将单词拆分为数组的代码，则此函数将让您选择您希望短语最长的时间，并返回一个包含短语的数组数组。

```
function getPhrases($array, $maxTerms = 3) {
    for($i=0; $i < $maxTerms; $i++) { //Until we've generated terms of all lengths
         for($j = 0; $j < (sizeof($array) - $i); $j++) { //Until we've iterated as far through the array as we should go
             $termArray[] = array(array_slice($array, $j, ($i+1))); //Add this part of the array to the array
         }
    }
    return $termArray;
}

//Usage example

$newarray = explode(" ", "This is a pretty long example sentence");
print_r(getPhrases($newarray));
```

# netbeans - 有没有办法将 Netbeans 中的代码文本居中显示在屏幕上？

> ID：742689
> 
> 赞同：0
> 
> 时间：2009-04-13T00:17:38.800
> 
> 标签：netbeans, netbeans-plugins

我正在尝试模拟我之前使用 emacs 的暗房设置，但使用的是 Netbeans。我几乎一直处于 alt-shift-enter 全屏模式，然后 shift-escape 以最大化代码编辑器屏幕。但是，这会导致所有代码文本编辑器块以及行号都与屏幕左侧对齐。是否有可能，即使通过第三方插件，也可以将所有块集中到屏幕中心？

netbeans 的版本是 6.7m3

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-13T18:17:05.197

这可能是一个错误，请尝试将其报告给 netbeans。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-06-10T15:15:26.563

已经有一段时间了，但似乎仍然没有专门的方法来做到这一点（在我的例子中是 NB 11.2）。这是一个适合我的解决方法：

创建或打开一个空文件并将文件的编辑器容器从其他打开的文件选项卡拖到窗口左侧，这样您就有两个并排的文档。现在将它们之间的分隔符向左拖动以使右侧文档的代码居中。瞧。

在全屏模式（Alt + Shift + Enter）下效果很好，但在仅显示一个编辑器的编辑器模式下不起作用（Ctrl + Shift + Enter）。

# sql - 关于 Django 中的嵌套集合和查询效率的问题

> ID：742697
> 
> 赞同：6
> 
> 时间：2009-04-13T00:22:43.733
> 
> 标签：sql, django, performance, django-models

我看到很多这样的答案：

[打印一份拥有多个房屋的人员列表 每个拥有多个房屋的人](https://stackoverflow.com/questions/387991/printing-a-list-of-persons-with-more-than-one-home-each-home-with-more-than-one)

我已经用类似的模型尝试过这个答案，这似乎是一种非常低效的方法。每次迭代似乎都会进行单独的查询，有时会导致对数据库的数千次查询。我意识到您可以缓存查询集，但它似乎仍然非常错误。那么问题来了，你用的是那种方法吗？如果没有，你怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-13T12:11:45.497

这是一个很好的问题，而且不限于 Django 的 ORM 框架。

我总觉得记住对象关系映射 (ORM) 框架解决的一些问题很重要：

*   **面向对象的 CRUD**：如果应用程序的其余部分基于强大的面向对象原则，那么使用对象访问数据持久性会使代码更加连贯、内部一致，有时甚至更短。

*   **持久层封装**：ORM 在您的应用程序中为 DB 访问提供了一个清晰的层。它将读取/写入数据所需的所有功能封装在一处，这就是所谓的 DRY（不要重复自己）原则的缩影。这使一些事情变得更容易：*模型更改*，因为所有面向数据库的选择和插入/更新代码都在一个位置而不是整个应用程序中，*安全性*，因为所有数据库访问都通过一个位置，以及*测试*，因为它很容易模拟您的数据模型并在明确描述时进行访问。

*   **SQL 安全性**：虽然很容易保护原始 SQL 的使用免受注入攻击等攻击，但如果您有一个 ORM 框架作为 DB-contact 的单点来为您做这件事，那么您就不必考虑它了，这会更容易。

请注意，速度不在列表中。ORM 是代码和数据库之间的间接级别。我们当然要求 ORM 设计人员负责编写能够生成良好 SQL 语句的框架，但 ORM 旨在提供代码和架构级别的效率，而不是执行效率。阅读过 SQL 基础书籍的开发人员将始终能够获得更好的性能，直接与 DB 对话。

当然有一些策略可以解决这个问题，在 Django 中，这些策略`select_related()`就像 ozan 提到的那样，以及站点/视图/杂项缓存，但它们不会为您提供与直接 SQL 语句相同的性能。因此，当我需要速度时，我永远不会使用不提供某种机制来发出原始 SQL 语句的 ORM 框架。例如，在从连接许多表的数据库中生成大型报告时，我经常使用原始 SQL；ORM 方式可能需要几分钟，SQL 方式可能需要几秒钟。

话虽如此，我从不担心每个单独的查询。我对任何来到 ORM 层的人的建议是：不要保姆 ORM 的数据库访问。编写您的应用程序或模块，然后对其进行分析，调整那些真正需要提高性能的区域，或使用缓存/select_related 来减少应用程序的整体 DB-chatiness。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-13T02:03:37.970

您可以使用[select_related() 查询集方法](http://docs.djangoproject.com/en/dev/ref/models/querysets/#id4)来减少数据库查询的数量。您还可以指定深度，因此在给定的示例中，如果电话号码模型具有其他外部关系，您将使用 select_related(depth=2) 来避免选择相关实体的进一步“级别”。

# c - 从 C 中的函数返回枚举？

> ID：742699
> 
> 赞同：35
> 
> 时间：2009-04-13T00:24:36.913
> 
> 标签：c, function, enums

如果我在头文件中有类似以下内容，如何声明一个返回 Foo 类型枚举的函数？

```
enum Foo
{
   BAR,
   BAZ
}; 
```

我可以做类似以下的事情吗？

```
Foo testFunc()
{
    return Foo.BAR;
} 
```

还是我需要使用 typedefs 或指针之类的？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-04-13T00:36:27.710

在 C++ 中，您可以只使用`Foo`.

在 C 中，您必须使用`enum Foo`，直到您为其提供 typedef。

然后，当您提到 时`BAR`，您不使用`Foo.BAR`，而只是使用`BAR`。所有枚举常量共享相同的命名空间（“普通标识符”命名空间，由函数、变量等使用）。

因此（对于 C）：

```
enum Foo { BAR, BAZ };

enum Foo testFunc(void)
{
    return BAR;
} 
```

或者，使用`typedef`：

```
typedef enum Foo { BAR, BAZ } Foo;

Foo testFunc(void)
{
    return BAR;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-13T00:27:27.420

我相信其中的各个值`enum`本身就是标识符，只需使用：

```
enum Foo testFunc(){
  return BAR;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-13T00:29:21.690

我认为一些编译器可能需要

```
typedef enum tagFoo
{
  BAR,
  BAZ,
} Foo; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-13T00:34:45.483

```
enum Foo
{
   BAR,
   BAZ
}; 
```

在 C 中，返回类型之前应该有枚举。当您使用单个枚举值时，您不会以任何方式限定它们。

```
enum Foo testFunc()
{
    enum Foo temp = BAR;
    temp = BAZ;
    return temp;
} 
```

# ruby-on-rails - Rails Active Record find(:all, :order => ) 问题

> ID：742700
> 
> 赞同：76
> 
> 时间：2009-04-13T00:25:30.857
> 
> 标签：ruby-on-rails, ruby, activerecord

我似乎无法使用 ActiveRecord::Base.find 选项 :order 一次超过一列。

例如，我有一个带有日期和参加列的“显示”模型。

如果我运行以下代码：

```
@shows = Show.find(:all, :order => "date") 
```

我得到以下结果：

```
[#<Show id: 7, date: "2009-04-18", attending: 2>, 
 #<Show id: 1, date: "2009-04-18", attending: 78>, 
 #<Show id: 2, date: "2009-04-19", attending: 91>, 
 #<Show id: 3, date: "2009-04-20", attending: 16>,
 #<Show id: 4, date: "2009-04-21", attending: 136>] 
```

如果我运行以下代码：

```
@shows = Show.find(:all, :order => "attending DESC")

[#<Show id: 4, date: "2009-04-21", attending: 136>,
 #<Show id: 2, date: "2009-04-19", attending: 91>,
 #<Show id: 1, date: "2009-04-18", attending: 78>,
 #<Show id: 3, date: "2009-04-20", attending: 16>,
 #<Show id: 7, date: "2009-04-18", attending: 2>] 
```

但是，如果我运行：

```
@shows = Show.find(:all, :order => "date, attending DESC") 
```

或者

```
@shows = Show.find(:all, :order => "date, attending ASC") 
```

或者

```
@shows = Show.find(:all, :order => "date ASC, attending DESC") 
```

我得到与仅按日期排序相同的结果：

```
 [#<Show id: 7, date: "2009-04-18", attending: 2>, 
 #<Show id: 1, date: "2009-04-18", attending: 78>, 
 #<Show id: 2, date: "2009-04-19", attending: 91>, 
 #<Show id: 3, date: "2009-04-20", attending: 16>,
 #<Show id: 4, date: "2009-04-21", attending: 136>] 
```

在哪里，我想得到这些结果：

```
[#<Show id: 1, date: "2009-04-18", attending: 78>,
#<Show id: 7, date: "2009-04-18", attending: 2>, 
 #<Show id: 2, date: "2009-04-19", attending: 91>, 
 #<Show id: 3, date: "2009-04-20", attending: 16>,
 #<Show id: 4, date: "2009-04-21", attending: 136>] 
```

这是从日志生成的查询：

```
[4;35;1mUser Load (0.6ms)[0m   [0mSELECT * FROM "users" WHERE ("users"."id" = 1) LIMIT 1[0m
[4;36;1mShow Load (3.0ms)[0m   [0;1mSELECT * FROM "shows" ORDER BY date ASC, attending DESC[0m
[4;35;1mUser Load (0.6ms)[0m   [0mSELECT * FROM "users" WHERE ("users"."id" = 1) [0m 
```

最后，这是我的模型：

```
 create_table "shows", :force => true do |t|
    t.string   "headliner"
    t.string   "openers"
    t.string   "venue"
    t.date     "date"
    t.text     "description"
    t.datetime "created_at"
    t.datetime "updated_at"
    t.decimal  "price"
    t.time     "showtime"
    t.integer  "attending",   :default => 0
    t.string   "time"
  end 
```

我错过了什么？我究竟做错了什么？

**更新：感谢您的所有帮助，但似乎你们所有人都和我一样难过。解决问题的方法实际上是切换数据库。我从默认的 sqlite3 切换到 mysql。**

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-01-14T02:49:58.297

**可能是两件事。第一的，**

此代码已弃用：

```
Model.find(:all, :order => ...) 
```

应该：

```
Model.order(...).all 
```

:all、:order 和许多其他选项不再支持查找。

**其次，**您可能有一个 default_scope 在您调用`find`.`Show`

在互联网上挖掘了数小时后，我找到了一些有用的文章来解释这个问题：

*   [http://m.onkey.org/active-record-query-interface](http://m.onkey.org/active-record-query-interface)
*   [http://www.simonecarletti.com/blog/2010/07/the-way-to-rails-3/](http://www.simonecarletti.com/blog/2010/07/the-way-to-rails-3/)

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2009-04-13T16:36:33.317

我注意到在您的第一个示例中，简单的**:order => "date"**记录**7在记录****1**之前排序。此顺序也是您在多列排序中查看结果的方式，无论您是否按参加排序。

如果日期不完全相同，并且**7**的日期在**1**的日期之前，这对我来说似乎很有意义。查询发现日期不相等，然后像所有其他记录一样简单地按日期排序，而不是发现**日期**s 完全相等然后继续按**参加排序。**

我从浏览中看到，SQLite 对 DATE 或 DATETIME 数据类型没有原生的理解，而是让用户选择他们必须自己解析的浮点数或文本。数据库中日期的文字表示是否可能不完全相等？大多数人似乎需要[使用日期函数](http://www.mail-archive.com/sqlite-users@sqlite.org/msg30166.html)，以便日期的行为符合您的预期。也许有一种方法可以使用[日期函数](http://www.sqlite.org/cvstrac/wiki/wiki?p=DateAndTimeFunctions)按列包装您的订单，这将为您提供一些具体的比较，例如**date(date) ASC，参加 DESC**。我不确定语法是否有效，但这是一个可以解决您的问题的领域。希望有帮助。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2010-04-28T10:52:05.807

问题是*date*是一个**保留的 sqlite3 关键字**。*我对time*也有类似的问题，也是一个保留关键字，它在 PostgreSQL 中运行良好，但在 sqlite3 中没有。*解决方案是重命名列*。

看到这个：[Sqlite3 activerecord :order => "time DESC" doesn't sort](https://stackoverflow.com/q/2719941/252799)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-02-13T21:44:08.330

我刚刚遇到了同样的问题，但我设法让我的查询在 SQLite 中工作，如下所示：

```
@shows = Show.order("datetime(date) ASC, attending DESC") 
```

我希望这可以帮助某人节省一些时间

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-13T00:46:20.197

不是`:order => 'column1 ASC, column2 DESC'`吗？

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-15T22:39:44.300

确保直接在数据库级别检查架构。我之前对此感到很恼火，例如，最初编写迁移以创建 :datetime 列，然后我在本地运行它，然后在实际部署之前将迁移调整为 :date。因此，除了我的以外，每个人的数据库看起来都不错，而且错误很微妙。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-18T21:34:40.933

我理解为什么 Rails 开发人员使用 sqlite3 进行开箱即用的实现，但 MySQL 更实用，恕我直言。我意识到这取决于您构建 Rails 应用程序的目的，但大多数人会将默认的 database.yml 文件从 sqlite3 切换到 MySQL。

很高兴您解决了您的问题。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-21T08:33:03.547

很高兴您找到了解决方案。但这是一个有趣的问题。我自己直接用 sqlite3（不通过 rails）尝试了它，但没有得到相同的结果，对我来说，订单按预期出来了。

如果你想继续研究这个问题，我建议你做的是启动 sqlite3 命令行应用程序并检查架构和那里的查询：

这向您显示了架构：`.schema`

然后运行在日志文件中显示的 select 语句：`SELECT * FROM "shows" ORDER BY date ASC, attending DESC`

这样你会看到：

1.  架构看起来如您所愿（例如，该日期实际上是一个日期）
2.  日期列实际上包含日期，而不是时间戳（也就是说，您没有一天中的某个时间会弄乱排序）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-04-25T04:05:40.673

我正在使用 rails 6 并且 Model.all(:order 'columnName DESC') 不起作用。我在[OrderInRails中找到了正确答案](https://apidock.com/rails/ActiveRecord/QueryMethods/order)

这很简单。

```
@variable=Model.order('columnName DESC') 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-07-22T18:35:04.577

这也可能有帮助：

```
Post.order(created_at: :desc) 
```

# c - 什么时候值得在结构定义中使用指向结构的指针？

> ID：742703
> 
> 赞同：4
> 
> 时间：2009-04-13T00:27:27.403
> 
> 标签：c, pointers, struct, memory-management

抱歉，如果问题不清楚；我发现很难用一句话来解释。

假设我有`struct`一个成员是 a `struct`，例如以下内容：

```
struct A {
    struct B b;
}; 
```

可以说我打算始终将此结构的实例进行堆分配。改成这个有什么好处吗？（即保持一个**指向**）`struct B`

```
struct A {
    struct B *b;
}; 
```

在后一种情况下，我将有几个函数，例如`make_A`and`free_A`将负责分配和取消分配 ; 指向的内存`b`。

我能想到第二种形式可能更可取的唯一示例是，当并非所有实例`struct A`都实际使用`b`. 在这种情况下，可以通过只为那些需要它的实例分配额外的内存来节省内存。

是否还有其他情况可以使第二种形式提供一些有用的东西？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-13T00:31:52.167

如果每个`A`都恰好有一个`B`，则不应*使用*指向`B`.

除了您不需要为额外的内存管理而烦恼之外，它实际上更慢且效率更低 allocate `B`。

即使您想传递指向`B`其他代码的指针，您仍然可以传递该地址。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-13T00:33:02.663

当 B 的一个实例可以由 A 的多个实例共享时，您将获得指向 B 的指针。这有助于避免重复和在多个地方维护 B 的版本。根据乔纳森的评论，这是以知道何时释放内存和计算对 B 的引用为代价的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-13T01:28:51.920

我认为你的最后一句话很中肯。如果不是每个`A`人都有 a `B`，那么您可以通过使用指针来节省内存（那些`A`没有 a 的 s为 null `B`）。

`B`除非所有未使用的 s 的累积大小在可用堆中占相当大的比例，否则这不太可能真正有用。

但是，出于以下原因，我会将您的声明更改为“当并非所有实例`A`都只有一个副本时`B`”（这是您要求的另一种情况）：

> 列表中的节点在哪里`B`（也包含指向另一个`B`或 null 的指针），我会将其设为指针[尽管*如果*所有`A`s 必须至少有一个，您仍然可以嵌入第一个节点`B`]。

另一种可能性是在它们的性质允许的情况下`B`在 s 之间共享 s `A`（例如作为`A`屏幕上的窗口`B`），尽管在这种情况下您必须对`B`s 进行引用计数，以便知道何时最终将它们释放到您的`free_A()`调用（当然，能够重用你调用中已经存在`B`的`make_A()`调用）。

# iphone - 我可以在 iPhone 上使用 Core Audio 效果吗？

> ID：742706
> 
> 赞同：3
> 
> 时间：2009-04-13T00:29:02.360
> 
> 标签：iphone, core-audio

我知道 iPhone OS 中有一部分 Core Audio 可用，但我不知道有多少效果/过滤器可用。如果可用，我想获得一些关于如何在音频单元上应用一些简单效果（延迟、回声等）的指导。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-14T13:43:59.323

您可以在 iPhone WRT 上对音频执行几项操作。

第一个是 OpenAL，一个在 iPhone 上受支持的跨平台音频处理库。您可以在这里找到它的常见问题解答： [https ://web.archive.org/web/20100725234354/https://developer.apple.com/iphone/library/technotes/tn2008/tn2199.html](https://web.archive.org/web/20100725234354/https://developer.apple.com/iphone/library/technotes/tn2008/tn2199.html)

接下来，您可以使用 iPhone 上可用的服务之一作为 Core Audio 子集的一部分。您可以在此处获取 iPhone 和 Mac OS X Core Audio 开发人员可用的服务列表：[Core Audio Services](https://developer.apple.com/library/content/documentation/MusicAudio/Conceptual/CoreAudioOverview/WhatsinCoreAudio/WhatsinCoreAudio.html#//apple_ref/doc/uid/TP40003577-CH4-SW1)

据我所知，看起来没有任何罐装音频效果。因此，如果您在 Core Animation 中为您提供了预定义的过渡，我认为您在 iPhone 的 CA 中没有开箱即用的更高级别的效果可供您使用。也就是说，OpenAL 是跨平台的，您应该能够找到大量作为 OpenAL 1.1 SDK 的一部分或作为其他公共贡献的一部分的示例效果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-23T01:07:52.167

效果不包括在内，您必须自己编写。您可以使用 iPod eq，但仅此而已。一些转换器是可用的，虽然浮点到 int 的不是。

# python - 对于python中类中的每个函数

> ID：742708
> 
> 赞同：5
> 
> 时间：2009-04-13T00:30:07.803
> 
> 标签：python, reflection, oop

在python中是否可以在一个类中运行每个函数？

**编辑：** 我想做的是调用类中的函数，收集它们的返回变量并使用它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-13T00:41:33.830

是的你可以。又快又脏：

```
class foo:
    def one(self):
        print "here is one"
    def two(self):
        print "here is two"
    def three(self):
        print "here is three"

obj = foo()
for entry in dir(obj):
    print entry, callable(getattr(obj,entry))
    if callable(getattr(obj,entry)):
        getattr(obj,entry)() 
```

如果您想要更精致的概念，请查看 unittest.py 模块。应该有执行以字符串“test”开头的所有方法的代码

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-13T00:42:26.150

取决于您所说的“功能”。不过，这样的事情可能会奏效：

```
import inspect

def methods(c):
    return (m for m in (getattr(c, d) for d in dir(c))
            if inspect.ismethoddescriptor(m) or inspect.ismethod(m)) 
```

然后：

```
class C:
    def f(self): pass

>>> list(methods(C))
[<unbound method C.f>] 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-14T14:46:40.233

[`dir`内置](http://docs.python.org/library/functions.html#dir)将列出对象的所有属性，例如：

```
>>> class MyClass:
...     def one(self):
...         print "one"
...     def two(self):
...         print "two"
...     def three(self):
...         print "three"
... 
>>> dir(MyClass)
['__doc__', '__module__', 'one', 'three', 'two'] 
```

它也适用于初始化的类..

```
>>> c = MyClass()
>>> dir(c)
['__doc__', '__module__', 'one', 'three', 'two'] 
```

方法只是碰巧可调用的属性（通过`c.attribute()`）-我们可以使用该`getattr`函数通过变量引用该方法..

```
>>> myfunc = getattr(c, 'one')
>>> myfunc
<bound method MyClass.one of <__main__.MyClass instance at 0x7b0d0>> 
```

然后我们可以简单地调用那个变量..

```
>>> myfunc()
one # the output from the c.one() method 
```

因为有些属性不是函数（在上面的例子中，`__doc__`和`__module__`）。我们可以使用[callable 内置](http://docs.python.org/library/functions.html#callable)函数来检查它是否是一个可调用的方法（一个函数）：

```
>>> callable(c.three)
True
>>> callable(c.__doc__)
False 
```

因此，将所有这些组合成一个循环：

```
>>> for cur_method_name in dir(c):
...     the_attr = getattr(c, cur_method_name)
...     if callable(the_attr):
...             the_attr()
... 
one
three
two 
```

请记住，这将再次调用类似的方法`__init__`，这可能是不希望的。您可能想跳过`cur_method_name`以下划线开头的任何内容

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-13T02:49:06.957

这是一个使用 yield 循环遍历类中的函数的方法。

```
def get_functions(mod):
    for entry in dir(mod):
        obj=getattr(mod,entry);
        if hasattr(obj, '__call__') and hasattr(obj,'__func__') :
            yield obj

class foo:
    def one(self):
        print ("here is two")
        return 1
    def two(self):
        print ("here is two")
        return 2
    def three(self):
        print ("here is three")
        return 3

print(sum([fun() for fun in get_functions(foo())])) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-13T10:18:15.237

既然你写了这个类，你就已经*知道*所有的功能了。

```
class ThisIsPeculiar( object ):
    def aFunction( self, arg1 ):
        pass
    def anotherFunction( self, thisArg, thatArg ):
        pass
    functionsToCall = [ aFunction, anotherFunction ]

>>> p= ThisIsPeculiar()
>>> p.functionsToCall
[<function aFunction at 0x6b830>, <function anotherFunction at 0x6b870>] 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-13T14:02:09.693

尝试使用[检查模块](http://docs.python.org/library/inspect.html)：

```
import inspect

class Spam:
    def eggs(self):
        print "eggs"
    def ducks(self):
        print "ducks"
    value = "value"

spam = Spam()
for name, method in inspect.getmembers(spam, callable):
    method() 
```

输出：

```
ducks
eggs 
```

# algorithm - 缩短文本，只保留重要的句子

> ID：742711
> 
> 赞同：4
> 
> 时间：2009-04-13T00:33:07.967
> 
> 标签：algorithm, nlp, semantics

德国网站 nandoo.net 提供缩短新闻文章的可能性。如果您使用滑块更改百分比值，则文本会更改，并且会省略一些句子。

你可以在这里看到它的作用：

> [http://www.nandoo.net/read/article/299925/](http://www.nandoo.net/read/article/299925/)

新闻文章在左侧并标记了标签。滑块位于第二列的顶部。将滑块向左移动得越多，文本就越短。

你怎么能提供这样的东西？是否有任何算法可以用来实现这一目标？

我的想法是他们的算法计算句子中标签和名词的数量。然后省略标签/名词数量最少的句子。

那可能是真的吗？还是你有别的想法？

我希望你能帮助我。提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-05T22:16:21.490

这是计算语言学的一个热门研究课题。使用贝叶斯过滤的浅层方法不太可能产生完美的结果 - 但无论如何您可能并不需要完美的结果。

在 CL 中，80-20 规则很快变成了 95-5 规则，所以如果您对通过浅层方法可以实现的目标感到满意，请跳过此答案。

如果你想看看你是否可以改进你的结果，你可以尝试找到一些更好的资源。您所指的任务在研究社区中称为“文本摘要”，它有自己的[网页](http://www.summarization.com/)，已经过时了。[Mani and Maybury (1999)](http://mitpress.mit.edu/catalog/item/default.asp?ttype=2&tid=3943)可能是一个很好的概述（我自己没有读过），但也很陈旧。最近是 Martin Hassels关于该主题的[论文](http://www.csc.kth.se/~xmartin/dlgate.php?file=phdthesis_mh_2007.pdf)，也相当详尽，包括与语言无关的（阅读：统计，即浅层）方法。

与往常一样，Google 也可以为您提供帮助。只需搜索[文本摘要](http://google.com/search?q=text+summarization)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-13T00:36:41.047

通常，您希望保留具有该文章更独特的单词的句子。

也就是说，句子越“通用”，它对这篇特定文章的描述就越少。

执行此操作的正常方法是贝叶斯分析，很像垃圾邮件过滤器。首先确定整篇文章中哪些单词出现的频率比您预期的要高，然后找到包含这些单词的句子。

# security - ADO.NET 数据服务的部署

> ID：742719
> 
> 赞同：6
> 
> 时间：2009-04-13T00:39:11.167
> 
> 标签：security, wcf-data-services

保护 ADO.NET 数据服务的最佳方式是什么？有没有人在生产中使用过这个，如果是的话，你使用了哪些安全选项？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-10-13T13:36:20.187

这是一篇[博文](http://mtaulty.com/CommunityServer/blogs/mike_taultys_blog/archive/2008/05/27/10447.aspx)，深入解释了如何保护 ADO .NET 数据服务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-14T11:51:06.660

@tbreffni 发表了一篇不错的博客文章。除了在您的 ado.net 数据服务中设置实体访问规则以控制如何为底层实体数据模型中的不同实体提供访问权限。

假设您的代码如下：

```
public class Northwind : DataService<NorthwindEntities>
{
    public static void InitializeService(IDataServiceConfiguration
                                                   config)
    {
        config.SetEntitySetAccessRule("*", EntitySetRights.All);
    }
} 
```

SetEntitySetAccessRule 方法允许您引用整个实体模型或仅引用特定实体集，然后根据 EntitySetRights 枚举定义权限。枚举中包含以下值：

**无** 拒绝访问数据的所有权利。

**ReadSingle** 读取单个数据项的授权。

**ReadMultiple** 读取数据集的授权。

**WriteAppend**授权在数据集中创建新的数据项。

**WriteReplace** 授权替换数据。

**WriteDelete**从数据集中删除数据项的授权。

**WriteMerge** 授权合并数据。

**AllRead**授权读取数据。

**AllWrite** 授权写入数据。

**所有**创建、读取、更新和删除数据的授权。

使用 Microsoft ADO.NET 服务的演练在[这里](http://msdn.microsoft.com/en-us/library/cc907912.aspx)介绍了此过程。EntitySetRights 枚举[在此处](http://msdn.microsoft.com/en-us/library/system.data.services.entitysetrights.aspx)记录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-08T19:00:28.140

您是指安全的单个查询类型还是整个服务？如果是整个服务，那么您可以使用标准的 IIS 保护方法，例如 Windows 身份验证。在受控的 Windows 环境中，Web 服务正在使用这些服务，您可以设置一个域 ID 作为框之间的授权用户。当然，使用 SSL 是为了保护数据加密。

# linq - 从 DataItem 中读取匿名类型

> ID：742721
> 
> 赞同：0
> 
> 时间：2009-04-13T00:40:38.637
> 
> 标签：linq

我想将 e.Item.DataItem 中的值读入一个字符串，但无论出于何种原因，我似乎无法得到它，尽管我可以在监视窗口中看到它

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2010-02-03T20:36:43.633

[从类似的问题](https://stackoverflow.com/questions/1470907/access-columns-in-itemdatabound-event-when-the-datasource-is-linq)中得到以下信息

```
DataBinder.Eval(e.Item.DataItem, "PropertyName") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-13T00:59:46.140

您可以添加更多信息吗？您是真的想要一个字符串值还是需要该值中的特定字符串？

如果您需要一个应该可行的字符串值。监视窗口倾向于通过在对象上调用 .ToString 来显示值。如果监视窗口中的值是您想要的字符串，那么您应该能够通过简单地调用 ToString 来获取它。

```
var item = e.Item.DataItem.ToString(); 
```

您还需要对各种属性进行空检查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T21:43:14.000

听起来你已经做了类似的事情：

```
obj.Datasource = (from .... select new { a=..., b=...}).ToList(); 
```

对于您的其中一个项目，您想获取“a”或“b”的值，对吗？

你可以，但它很复杂（不推荐）。为此，您必须将 e.Item.DataItem 强制转换为正确的类，但这是一个匿名类型，这意味着您无法在没有一些技巧的情况下指定强制转换。你可以尝试这样的事情：

```
private T ForceCast(T prototype, object obj)
{
  return (T)obj;
} 
```

然后，调用 ForceCast(new {a=...,b=...}, e.Item.DataItem)。我认为如果你在同一个程序集中这会起作用（并且你为 a 和 b 提供的值得到正确的类型 - 编译器会为你猜测 T 并弄清楚事情）。但是，更好的方法是定义一个真正的类来保存您从数据源返回的数据。然后你可以将 e.Item.DataItem 转换为那个类，你会没事的。

（注意：我实际上并没有尝试运行此代码——这只是我在阅读本文时的一个想法，但我想我以前见过它。也许是[这个博客](http://tomasp.net/blog/cannot-return-anonymous-type-from-method.aspx)？）

# asp.net - LINQ - 插入不适用于“联结”表

> ID：742729
> 
> 赞同：0
> 
> 时间：2009-04-13T00:48:19.257
> 
> 标签：asp.net, linq

我有一个“联结”表，用于存储用户的用户 ID（与 aspnet_membership 表中的用户 ID 相同）和产品 ID。我已将此表添加到 .dbml 文件中。我正在尝试使用 LINQ 插入表中，但它失败了。联结表中的两个字段都设置为主键，但是，我在 .dbml 文件中没有 aspnet_membership 表（我也没有在两个表之间设置关系 - 它不会让我因为 userID 字段在aspnet_membership 不是主键）。这是我的代码（我在其他位置使用过类似的代码没有问题，所以我怀疑 .dbml 配置是问题所在）。任何想法为什么插入失败？

```
bool success = false;
ASIStoreDataDataContext storeContext = new ASIStoreDataDataContext();
try
{
    if (HttpContext.Current.User.Identity.IsAuthenticated)
    {
        STOR_NewsletterUser newsSub = new STOR_NewsletterUser();
        newsSub.SNWS_NewsLetterID = newsletterID;
        newsSub.UserID = userID;
        storeContext.STOR_NewsletterUsers.InsertOnSubmit(newsSub);
        storeContext.SubmitChanges();
        success = true;
    }
}
catch { }

return success; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T01:03:06.337

首先，摆脱那个 try/catch 块。任何随机异常都可能在那里发生，你不会知道它，因为你正在吃异常。*永远*不要那样做。

现在，也许如果您发布了异常或您认为插入失败的其他原因，我可以给您更好的回应。相反，我可以建议的最好的方法是您更改代码如下：

```
ASIStoreDataDataContext storeContext = new ASIStoreDataDataContext();
try
{
    if (!HttpContext.Current.User.Identity.IsAuthenticated)
        return false;

    STOR_NewsletterUser newsSub = new STOR_NewsletterUser();
    newsSub.SNWS_NewsLetterID = newsletterID;
    newsSub.UserID = userID;
    storeContext.STOR_NewsletterUsers.InsertOnSubmit(newsSub);
    storeContext.SubmitChanges();
    return true;
}
catch (Exception ex) {
    Console.WriteLine(ex.ToString()); // Or Debug.Print, or whatever
    throw;                            // Don't eat the exception
} 
```

完成后，编辑您的问题以包含显示的异常。如果没有发生异常，则编辑您的问题，说明发生了什么*不*应该发生，或者*没有*发生什么应该发生。

# php - 为安全编码 PHP 标签？

> ID：742730
> 
> 赞同：2
> 
> 时间：2009-04-13T00:48:23.580
> 
> 标签：php, security, xss

[Kohana](http://docs.kohanaphp.com/helpers/security#encode_php_tags)和[Codeigniter](http://codeigniter.com/user_guide/helpers/security_helper.html)都有`encode_php_tags()`. 我了解 XSS 清理（用于 Javascript），但是您何时以及为什么要使用`encode_php_tags()`？安全威胁是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-13T01:09:38.987

#kohana 论坛上的一位聪明人建议它存在，因为 Expression Engine 使用 eval() 作为模板。如果有人将 PHP 嵌入到一个字符串中，它可能会被 eval()'d 并执行。由于 Kohana 不将 eval() 用于模板，因此它可能只是从 Codeigniter 时代遗留下来的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-13T01:17:05.477

这确保了用户输入中的任何 PHP 代码都不会被执行，例如，如果应用程序将输入写入文件或将其传递给`eval()`. 或者，如果您只是想写一些 PHP 代码来显示浏览器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-13T01:10:08.817

如果您的应用程序允许将用户输入写入某种文件。您应该阻止用户输入可以在您的服务器上执行的 PHP 代码。

`encode_php_tags()`防止这种情况。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-13T01:19:01.587

使用点很明确，您的网站用户不必在您的表单中编写 php 代码。如果您正在使用为 CI 或 kohana 提供的其他 XSS 预防方法，则没有必要使用它。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-04-13T01:08:14.997

为什么他们将其列为与安全相关的功能，我无法告诉您，但这几乎只是将 PHP 标记中的 < 和 > 替换为其编码形式，因此不允许解析标记之间的实际 PHP 代码. 纯粹是视觉上的东西，但你有它......

# php - 如何在 [LOOP]...[/LOOP] 之间获取字符串

> ID：742735
> 
> 赞同：1
> 
> 时间：2009-04-13T00:51:41.060
> 
> 标签：php, regex

如何在 [LOOP]...[/LOOP] 之间获取字符串我尝试了这个但不起作用

```
$gloop = preg_replace('/\[LOOP\]([^\[]*)\[\/LOOP\]/', '\\1', $var); 
```

... 细绳：

```
'<tr>
    [LOOP]<th scope="col">%Gdata_All%</th>[/LOOP]
</tr>' 
```

但我会在 [LOOP]...[/LOOP]

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-13T01:31:38.593

我首先想说的是，您是在创建自己的模板库吗？周围有一些成熟的，比如[Smarty](http://www.smarty.net/)，应该能够满足您的要求。杰夫·阿特伍德的这篇文章也很好读：“[不要重新发明轮子，除非你打算学习更多关于轮子的知识](http://www.codinghorror.com/blog/archives/001145.html)”

如果您想推出自己的解决方案，那很好，这里有一些建议。

# BB码

* * *

这种方法依赖于安装了 PHP 的 BBCode 扩展，它是原生的，不依赖于正则表达式引擎（慢）。这个解决方案*可能*是最快的。

您可以让 BBCode 解析器转换

```
[LOOP]<td><?php print $row->title; ?></td>[/LOOP] 
```

进入

```
<?php foreach($result as $row): ?><td><?php print $row->title; ?></td><?php endforeach; ?> 
```

查看 BBCode 参数以了解如何将变量传递到 [LOOP] 语法中。

[您可以在bbcode_create](http://uk.php.net/manual/en/function.bbcode-create.php)方法页面上查看更多示例。

# **常用表达**

* * *

它们有点慢，但在所有 PHP 安装中默认启用。

这个正则表达式的学分去 Gumbo（你应该给他投票）。

```
/\[LOOP]((?:[^[]+|\[(?=\/LOOP]))*)\[\/LOOP]/ 
```

然后，您可以按如下方式使用它。

```
if (preg_match('%\[LOOP\]((?:[^[]+|\[(?=/LOOP\]))*)\[/LOOP\]%i', $subject, $result)) {
    # Successful match
    # You can access the content using $result[1];
} else {
    # Match attempt failed
} 
```

-马修

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-13T14:02:08.523

I would use this regular expression:

```
/\[LOOP]((?:[^[]+|\[(?=\/LOOP]))*)\[\/LOOP]/ 
```

It matches a sequence of any character other than `[` (`[^[]+`) or the `[` that is not followed by a `/LOOP]` (`\[(?!\/LOOP])`, `(?!`*`expr`*`)` is a negative look-ahead assertion) between a `[LOOP]` and `[/LOOP]`; the surrounding `(?:`*`expr`*`)` is a non-capturing grouping.

But it would certainly be better if you use a real parser to detect malformed code as [The Pixel Developer](https://stackoverflow.com/questions/742735/how-to-get-string-between-loop-loop/742802#742802) already pointed out.

# c# - 我应该在我的 C# 程序中使用属性还是应该使用 get/set 访问器？

> ID：742742
> 
> 赞同：4
> 
> 时间：2009-04-13T00:59:33.257
> 
> 标签：c#, properties, coding-style

当我看到这个声明时，我正在阅读 Rob Miles 的一本名为 C# Yellow Book 的书：

> 程序员钟爱新的闪亮玩具。他们非常热衷于使用语言特性来炫耀。属性可能有点像这样。在考虑属性与 get 和 set 方法时，我更喜欢老式的 get 和 set 方法，因为您知道这些方法在哪里。另一方面，如果以正确的方式使用，我可以看到属性可以使生活更轻松的地方。

我不太确定他的意思是什么。你们有什么建议？MS有什么建议？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-13T01:03:31.920

我认为您应该考虑一些非编程建议

> 在罗马做到入乡随俗。

.NET 的所有库、设计器和代码生成器都具有根深蒂固的特性。它几乎是平台不可分割的一部分。如果您选择使用 get/set 访问器而不是普通属性，您将创建一个外观与其他程序员所期望的完全不同的库。

使用 get/set 访问器只会增加您创建与各种工具不兼容的代码的机会。例如，有许多工具可以提供特殊情况属性和字段并为它们提供特殊功能。您将有一个等效的构造，但没有工具支持。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-23T11:44:09.607

几年前，我作为一名 Java 程序员转而使用 C# 编写了本书的这一部分。我想我会在下一个版本中重新审视文本并使其更加清晰。

如果你想确保你的类的用户知道当他们使用一个东西时一些代码将会运行，那么把它放到一个方法中就会明确这一点。此外，使用方法允许您返回错误条件而不必抛出异常。没有性能影响，因为编译器无论如何都会将属性转换为方法。

不过，我在编写的代码中经常使用属性，特别是对于像状态这样的东西。我从来没有真正提倡不使用属性，更要确保在正确的情况下使用正确的东西。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-13T01:06:18.730

我不知道 Rob Miles 是谁，但如果你的报价是准确的，那么我已经对他失去了尊重。

.NET 中的所有内容都使用属性。如果您的代码不使用属性，那么它将是唯一不使用的代码。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-13T02:40:30.017

```
myObject.Property++; 
```

相对：

```
myObject.SetProperty(myObject.GetProperty() + 1); 
```

是的..

当完成非平凡的计算/处理时，应使用显式 getter/setter 方法，以便执行实际操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-13T01:04:34.367

我喜欢房产。在“类库设计指南”中，他们建议使用属性（特别是对于独立于其他状态的状态）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-13T01:06:04.130

考虑这一点的最好方法是与现实生活中的物体进行比较。让我们说你是一个在现实生活中需要被设计的人。在头发颜色、高度和宽度等方面，你会如何称呼你的一些属性？一旦你开始思考这些方面，它会更有帮助，因为每个人都有自己的思考方式。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-13T01:46:35.047

如果你不使用属性，你会失去一个我认为在 .NET 中非常有用的非常突出的特性：绑定。您只能绑定到/从 .NET 中的属性，因此如果您使用 get/set 访问器，您将无法与其他人很好地相处。

# php - 用于取消引用函数结果的 PHP 语法

> ID：742764
> 
> 赞同：34
> 
> 时间：2009-04-13T01:12:42.570
> 
> 标签：php, arrays, syntax, function

**背景**

在我经常使用的所有其他编程语言中，对函数的返回值进行操作很简单，而无需声明一个新变量来保存函数结果。

然而，在 PHP 中，这似乎并不那么简单：

### example1（函数结果是一个数组）

```
<?php 
function foobar(){
    return preg_split('/\s+/', 'zero one two three four five');
}

// can php say "zero"?

/// print( foobar()[0] ); /// <-- nope
/// print( &foobar()[0] );     /// <-- nope
/// print( &foobar()->[0] );     /// <-- nope
/// print( "${foobar()}[0]" );    /// <-- nope
?> 
```

### example2（函数结果是一个对象）

```
<?php    
function zoobar(){
  // NOTE: casting (object) Array() has other problems in PHP
  // see e.g., http://stackoverflow.com/questions/1869812
  $vout   = (object) Array('0'=>'zero','fname'=>'homer','lname'=>'simpson',);
  return $vout;
}

//  can php say "zero"?       
//  print zoobar()->0;         //  <- nope (parse error)      
//  print zoobar()->{0};       //  <- nope                    
//  print zoobar()->{'0'};     //  <- nope                    
//  $vtemp = zoobar();         //  does using a variable help?
//  print $vtemp->{0};         //  <- nope 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-13T01:14:59.973

PHP 无法从函数访问数组结果。有些人称之为问题，有些人只是接受这是语言的设计方式。所以 PHP 让你创建不必要的变量只是为了提取你需要的数据。

所以你需要做。

```
$var = foobar();
print($var[0]); 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2011-10-25T12:41:07.863

这特别是数组取消引用，目前 php5.3 不支持，但在下一个版本 5.4 中应该可以。另一方面，在当前的 php 版本中可以取消引用对象。我也很期待这个功能！

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-11-22T17:01:31.900

***从 PHP 5.4 开始可以进行数组解引用：***

*   [http://svn.php.net/viewvc?view=revision&revision=300266](http://svn.php.net/viewvc?view=revision&revision=300266)

### 示例（[来源](http://schlueters.de/blog/archives/138-Features-in-PHP-trunk-Array-dereferencing.html)）：

```
function foo() {
    return array(1, 2, 3);
}
echo foo()[2]; // prints 3 
```

使用**PHP 5.3**你会得到

```
Parse error: syntax error, unexpected '[', expecting ',' or ';' 
```

* * *

**原答案：**

这已经[被](https://stackoverflow.com/questions/1182452/any-way-to-access-array-directly-after-method-call) [问](https://stackoverflow.com/questions/742764/php-syntax-for-dereferencing-function-result) [过](https://stackoverflow.com/questions/13109/php-access-array-value-on-the-fly)[了](https://stackoverflow.com/questions/1459924/when-a-php-function-returns-an-array-can-i-access-its-elements-inline) 。答案是不。这不可能。

在这个话题上[引用](http://groups.google.de/group/mailing.www.php-dev/browse_frm/thread/890e71cdcee796b6/e50baa8521e7b593?hl=de&lnk=gst&q=dereferencing+array#e50baa8521e7b593) [安迪·古特曼斯的话：](http://en.wikipedia.org/wiki/Andi_Gutmans)

> 这是一个众所周知的功能请求，但在 PHP 5.0 中不被支持。我不能告诉你它是否会得到支持。这需要一些研究和大量思考。

您还可以在 PHP Bugtracker[中多次](http://bugs.php.net/bug.php?id=43577)[找到此](http://bugs.php.net/bug.php?id=23022)[请求。](http://bugs.php.net/bug.php?id=47161) 有关技术细节，我建议您查看[官方 RFC](http://wiki.php.net/rfc/functionarraydereferencing)和/或询问[PHP Internals](http://news.php.net/php.internals)。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-04-13T02:36:53.257

好吧，您可以根据情况使用以下任何一种解决方案：

```
function foo() {
    return array("foo","bar","foobar","barfoo","tofu");
}
echo(array_shift(foo())); // prints "foo"
echo(array_pop(foo())); // prints "tofu" 
```

**或者您可以使用list()**从返回的数组中获取特定值：

```
list($foo, $bar) = foo();
echo($foo); // prints "foo"
echo($bar); // print "bar" 
```

**编辑：我之前给出的each()**示例代码不正确。**each()**返回一个键值对。所以使用**foreach()**可能更容易：

```
foreach(foo() as $key=>$val) {
    echo($val);
} 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-07-25T16:36:05.863

不幸的是，没有办法做到这一点，尽管它在大多数其他编程语言中都是如此。

如果你真的想做一个单行，你可以创建一个名为 a() 的函数并执行类似的操作

```
$test = a(func(), 1); // second parameter is the key. 
```

但除此之外，PHP 不支持 func()[1]。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-06-07T10:23:58.590

编写一个包装函数来完成相同的任务。由于 PHP 的简单类型转换，这可能是非常开放的：

```
function array_value ($array, $key) {
return $array[$key];
} 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-07-25T17:44:32.857

正如其他人所提到的，这是不可能的。PHP 的语法不允许这样做。但是，我确实有一个建议可以从另一个方向解决问题。

如果您可以控制该`getBarArray`方法并且可以访问 PHP 标准库（安装在许多 PHP 5.2.X 主机上，并且默认安装在 PHP 5.3 上），您应该考虑返回一个`[ArrayObject](http://us2.php.net/arrayobject)`而不是原生 PHP 数组/集合。 `ArrayObjects`有一个`[offetGet](http://us2.php.net/manual/en/arrayobject.offsetget.php)`方法，可以用来检索任何索引，所以你的代码可能看起来像

```
<?php
class Example {
    function getBarArray() {
        $array = new ArrayObject();
        $array[] = 'uno';
        $array->append('dos');
        $array->append('tres');
        return $array;
    }
}

$foo = new Example();
$value = $foo->getBarArray()->offsetGet(2); 
```

如果你需要一个原生数组/集合，你总是可以转换结果。

```
//if you need 
$array = (array) $foo->getBarArray(); 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-07-31T16:03:57.673

如果您只想返回数组中的第一项，请使用 current() 函数。

```
return current($foo->getBarArray()); 
```

[http://php.net/manual/en/function.current.php](http://php.net/manual/en/function.current.php)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-11-01T02:29:30.417

实际上，我编写了一个允许这种行为的库：

[http://code.google.com/p/php-preparser/](http://code.google.com/p/php-preparser/)

适用于一切：函数、方法。缓存，所以和 PHP 本身一样快 :)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2010-02-17T15:50:44.317

您不能在 PHP 中链接这样的表达式，因此您必须将结果保存`array_test()`在变量中。

试试这个：

```
function array_test() {
  return array(0, 1, 2);
}

$array = array_test();
echo $array[0]; 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-07-25T16:56:08.460

这太牵强了，但如果你真的需要它在一行中：

```
 return index0( $foo->getBarArray() );

/* ... */

function index0( $some_array )
{
  return $some_array[0];
} 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-11-20T08:23:06.293

经过进一步研究，我相信答案是否定的，这样的临时变量确实是处理从函数返回的数组的规范方法。

看起来这将从 PHP 5.4 开始改变。

此外，这个答案最初是针对这个版本的问题：

[使用从函数返回的数组时如何避免 PHP 中的临时变量](https://stackoverflow.com/questions/1769020/how-to-avoid-temporary-variables-in-php-when-using-an-array-returned-from-a-func)

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-11-20T08:38:52.800

当然，您可以返回一个对象而不是数组并以这种方式访问​​它：

```
echo "This should be 2: " . test()->b ."\n"; 
```

但我没有找到用数组来做到这一点的可能性:(

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-11-20T09:44:59.617

我通常的解决方法是拥有这样的通用功能

```
 function e($a, $key, $def = null) { return isset($a[$key]) ? $a[$key] : $def; } 
```

进而

```
 echo e(someFunc(), 'key'); 
```

作为奖励，当您不需要它时，这也避免了“未定义索引”警告。

至于为什么`foo()[x]`不起作用的原因，答案很不礼貌，不会在这里发布。;)

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-11-20T20:31:29.720

这些是解决您的问题的一些方法。

首先，如果您返回的变量数组不属于集合的一部分，但每个变量都有不同的含义，您可以直接使用它来命名变量。

其他两种方法是返回作为值集合的结果。

```
function test() {
  return array(1, 2);
}   
list($a, $b) = test();
echo "This should be 2: $b\n";

function test2() {
   return new ArrayObject(array('a' => 1, 'b' => 2), ArrayObject::ARRAY_AS_PROPS);
}
$tmp2 = test2();
echo "This should be 2: $tmp2->b\n";

function test3() {
   return (object) array('a' => 1, 'b' => 2);
}
$tmp3 = test3();
echo "This should be 2: $tmp3->b\n"; 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2011-02-16T22:34:24.113

非常贫民区，但是，它可以只使用 PHP 来完成。这利用了一个 lambda 函数（在 PHP 5.3 中引入）。看到并感到惊讶（并且，咳咳，害怕）：

```
function foo() {
    return array(
        'bar' => 'baz',
        'foo' => 'bar',
}

// prints 'baz'
echo call_user_func_array(function($a,$k) { 
    return $a[$k]; 
}, array(foo(),'bar')); 
```

在大多数其他语言中，我们必须经历如此美妙的事情才能做到这一点。

为了记录，我做了一些类似于诺尔特所做的事情。对不起，如果我让任何人的眼睛流血。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2017-05-24T21:51:31.373

以前在 PHP 5.3 中你必须这样做：

```
function returnArray() {
  return array(1, 2, 3);
}
$tmp = returnArray();
$ssecondElement = $tmp[1]; 
```

结果：`2`

从 PHP 5.4 开始，可以按如下方式取消引用数组：

```
function returnArray() {
  return array(1, 2, 3);
}
$secondElement = returnArray()[1]; 
```

结果：`2`

自 PHP 5.5 起：

你甚至可以变得聪明：

```
echo [1, 2, 3][1]; 
```

结果：`2`

你也可以对字符串做同样的事情。这称为字符串取消引用：

```
echo 'PHP'[1]; 
```

结果：`H`

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-11-20T08:51:25.240

如果它只是为了美观，那么如果您返回一个对象，那么 Object 表示法将起作用。就内存管理而言，如果进行临时复制，则不会进行临时复制，而只会更改引用。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2011-03-04T16:35:53.290

有三种方法可以做同样的事情：

1.  正如 Chacha102 所说，使用函数返回索引值：

    ```
    function get($from, $id){
        return $from[$id];
    } 
    ```

    然后，您可以使用：

    ```
    get($foo->getBarArray(),0); 
    ```

    获取第一个元素，依此类推。

2.  一种使用 current 和 array_slice 的懒惰方式：

    ```
    $first = current(array_slice($foo->getBarArray(),0,1));
    $second = current(array_slice($foo->getBarArray(),1,1)); 
    ```

3.  使用相同的函数返回数组和值：

    ```
    class FooClass {
        function getBarArray($id = NULL) {
            $array = array();

            // Do something to get $array contents

            if(is_null($id))
                return $array;
            else
                return $array[$id];
            }
    } 
    ```

    然后您可以获得整个数组和单个数组项。

    ```
    $array = $foo->getBarArray(); 
    ```

    或者

    ```
    $first_item = $foo->getBarArray(0); 
    ```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2013-04-03T17:39:55.987

**简短的回答：**

是的。可以在 PHP 中对函数的返回值进行操作，只要函数结果和您的特定 PHP 版本支持它。

参考例子2：

```
//  can php say "homer"?      
//  print zoobar()->fname;     //  homer <-- yup 
```

**案例：**

*   函数结果是一个数组，并且您的 PHP 版本足够新
*   函数结果是一个对象，并且你想要的对象成员是可访问的

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-07-25T16:35:59.920

这行得通吗？

```
 return ($foo->getBarArray())[0]; 
```

否则，您可以发布 getBarArray() 函数吗？我不明白为什么从你迄今为止发布的内容来看这不起作用。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-11-22T15:41:53.300

您可以使用参考：

```
$ref =& myFunc();
echo $ref['foo']; 
```

这样，您并没有真正创建返回数组的副本。

# html - 解析没有断字符串的网页

> ID：742769
> 
> 赞同：-2
> 
> 时间：2009-04-13T01:15:48.973
> 
> 标签：html, c, parsing

我正在尝试解析网页中的一些字符串，但我不断收到恰好被分解的字符串，无法检查字符串是否完整。目前，我有一个 1024 字节的缓冲区，用于接收部分页面。我应该怎么做才能确保获得完整的字符串，最好不要使用过大的缓冲区。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-13T08:11:57.413

我不完全确定我理解你在做什么以及你所说的“断线”是什么意思，但我会试着给你一个答案。

通过断开的字符串，我假设您的意思是一段 HTML 或文本的逻辑结尾。最终，除了解析之外，您别无他法，如果您不在某个合乎逻辑的停止点，请继续阅读。如果您使用 char[] 来保存数据，那么您肯定会遇到缓冲区问题。根据你读取数据的方式，方法可能会改变，但过程大致是：

（有点 C，技术上不准确）

```
int allocLen = 1024;
char buffer[] = malloc(allocLen);
readInNBytes(buffer, 128);
if (notAtLogicalEnd(buffer))
     realloc(buffer, allocLen *= 2);
else
     // we're done? 
```

现在，显然这忽略了确定您的字符串是否损坏的细节，但这仍然是悬而未决的解释。有几种方法可以检查您是否处于数据的有效末尾：查找空格字符、换行符等，或检查 HTML 是否以 [/html] 标记结尾。无论哪种方式，您都必须读取整个数据集。

但是，我很想知道您如何阅读 HTML 数据以及您对“断串”的完整解释，我会修改我的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T08:28:57.747

我认为您要说的是您的字符串并不总是最终出现在缓冲区的同一迭代中。如果是这样，基本上有两种选择。

1.  使用巨大的缓冲区。没有办法证明你不会在这里错过任何机会，但它会大大降低机会。
2.  如果您知道要查找的字符串的最大长度，则可以创建两个缓冲区。第一个保存你刚刚得到的当前部分，另一个保存前一个。您需要知道字符串长度的原因是因为缓冲区的大小需要至少等于字符串的大小。

第二种解决方案是迄今为止更好的解决方案，但它确实依赖于字符串最大长度的知识。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-29T22:48:15.193

这仅与您的问题无关，但您可能正在解决错误的问题。多年来，我常常从网页中抓取 HTML 以尝试获取某些字符串。然后在听说 Firefox 的[Chickenfoot](http://groups.csail.mit.edu/uid/chickenfoot/)[`w3m`](http://w3m.sourceforge.net/)扩展后，我意识到使用Web 浏览器将 HTML 转换为 ASCII，然后使用标准机制（如[LPEG](http://www.inf.puc-rio.br/~roberto/lpeg/)或[解析组合](http://en.wikipedia.org/wiki/Parser_combinators)器）抓取 ASCII会容易得多。这个想法并不适用于所有问题，但是当它发生时，它通常比抓取 HTML 容易得多。

例如，我最近使用这种技术为家庭作业抓取了超过 200,000 首歌曲的歌词。

# svn - svn BASE 什么时候等于 HEAD

> ID：742772
> 
> 赞同：28
> 
> 时间：2009-04-13T01:17:05.647
> 
> 标签：svn

我对 svn 中的 BASE 版本有疑问。我知道这是上次运行更新时项目的原始版本，并且 svn diff 和 status 基本上针对此版本运行。BASE 什么时候更新？运行更新时它会更新到 HEAD 吗？即使更新期间发生冲突，这是否总是正确的？如果发生冲突，BASE 有什么？它是否仍然具有我上次更新的版本（在导致冲突的最近更新之前）或者即使存在冲突也会更新到 HEAD？
此外，当 svn commit 运行时，我假设 BASE 使用我的本地更改进行更新，此时 BASE、HEAD 和我的本地副本都相同？前提是提交成功。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-04-13T07:14:07.350

HEAD 是存储库中的最新版本。BASE 是您从存储库获得的最后一个修订版。成功提交或更新后它们是相同的。

当您进行更改时，您的文件与 BASE 副本不同。当您还原时，它们会返回匹配 BASE 修订版。当您遇到冲突时，您不会更新存储库。相反，您的文件仍被视为“正在编辑”，就好像您正在进行更改一样。解决冲突后，您实际上已经决定了最终文件的外观，然后像往常一样提交它们。因此，冲突就像特殊编辑的情况。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-13T06:20:08.070

BASE 是存储库中存在的工作副本的修订版。换句话说，您的修订没有您所做的更改。所以如果你`svn update`一个文件或文件夹要HEAD，那么BASE和HEAD是相等的。

当发生冲突时，BASE 成为与您的工作副本冲突的提交之前的修订版。

在一个项目上运行`svn info`以查看它的 BASE 修订版。

[修订说明符](http://svnbook.red-bean.com/en/1.4/svn.tour.revs.specifiers.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-10-14T08:44:08.080

查看日志时很重要，因为没有 url 的 svn log 显示您的 BASE 日志，但使用 url 显示您的 HEAD 日志，这就是为什么我总是使用“svn log -rHEAD:1”来查看所有更改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-13T20:26:24.153

**理论**：成功递归更新或切换所有文件的基本版本后成为头。在提交或部分更新之后，某些文件可能处于 HEAD 修订版，但只有在没有跳过文件的更新之后，您才能确定所有文件都处于同一版本。（跳过的原因是未版本化的障碍或冲突）。

**但是**，你为什么需要知道这一点。Subversion 应该在内部知道这一点，但在大多数情况下，这些知识对用户来说并不重要。（当文件过期时，Subversion 会自动警告您）。

据我所知，您真正需要确保您处于稳定版本的唯一时间是，当您从工作副本创建分支时。

# asp.net - 在 VMware RAM Disk 中运行 Visual Studio 和站点

> ID：742774
> 
> 赞同：1
> 
> 时间：2009-04-13T01:17:52.277
> 
> 标签：asp.net, visual-studio-2008, vmware, ramdisk

我有一台 24 GB 的机器，所以我打算安装 Vista 64 位，除了 VMware 工作站 6.5 Vista 映像之外什么都没有，它将安装在我将在主 Vista 上制作的 RAM 磁盘上。

整个 VMware 映像将在 RAM 中，因此我将在其中安装 Visual Studio 2008 并将我的所有站点都放在那里，就好像它是一个真正的磁盘一样。我已经对从 RAM Disk 运行应用程序进行了一些测试，性能非常出色，但我有些担心。

*   如何进行连续备份？由于它是一个 RAM 磁盘，一旦 PC 重新启动，一切都将消失：Visual Studio、SQL 数据库、我的站点以及其他所有内容。
*   只要我的主主机 Vista 没有安装任何东西，留 8 GB 的 RAM 就足够了吗？

*   VMware 映像是一个文件，那么我应该对主机驱动器还是 VMware 映像内的驱动器进行碎片整理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T01:51:49.417

看看[Live Mesh](http://blogs.msdn.com/livemesh/)。它将负责为您同步所有数据。当您重新启动 RAM 映像时，它会将文件拉回。通常，您注意到 LiveMesh 文件夹和普通文件夹之间的唯一区别是文件夹图标。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-13T03:20:39.250

碎片整理：以下是 VMWare 的建议：“首先，在 VM 中运行碎片整理实用程序；第二，使用 WMware Workstation 碎片整理工具；第三，在主机上运行碎片整理实用程序”

Backup: for my VMs, I use SynbackPro to run a timed backup of my project files to a SHARED folder on my host machine, then on the host I have SyncbackPro running a timed backup to an external drive. That way, no matter which VM I happen to be using, the external drive gets the backups.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-13T08:22:11.397

RAM disk is a great idea in principle, but you might not gain as much as you think. First, its declared overhead is about 10%, but in our server it degraded the performance in about 30-40%. Second, when having a lot of memory at hand, the system cache can load most of your files into memory anyway, so effectively all your IO is done with the RAM.

This is based on our experience with our server, and it might to apply to your case. I would suggest you at least try to install everything directly on the OS, let it run for some time so all needed files are cached, and then check the performance. If it's similar to what you have with VMWare + RAM disk, it would be much easier for you to maintain.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-13T01:28:41.860

对我来说，这似乎不是一个好主意，如果系统出现故障，内存磁盘就会被破坏。

我将专注于以一种有用的方式简单地分配内存，并将操作系统文件保存在磁盘上。

# python - 离散事件排队模拟

> ID：742776
> 
> 赞同：2
> 
> 时间：2009-04-13T01:18:54.503
> 
> 标签：python, queue

我一直在尝试实现单个服务器队列。我已经将Norm Matloff 的 Simpy 教程中的一些[伪代码改编为 Python，代码在](http://pastebin.com/m17c230e6)[这里](http://pastebin.com/m566e1c12)。现在我正在努力寻找某种方法来计算工作/客户的平均等待时间。

在这一点上，我的大脑已经将自己打成一个结！任何指针、想法、提示或伪代码将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-13T01:47:21.830

您应该知道每个客户何时到达队列。当他们到达服务器时，您应该将服务的客户数量加一，并累积他等待的时间。在模拟结束时，您只需将累积时间除以客户数量，您就有了工作/客户的平均等待时间。

核心问题在于考虑不同的事件并根据这些事件更新统计数据。

您的模拟应该将模拟的所有结构初始化为合理的状态：

*   将客户队列初始化为没有人
*   将服务客户的任何计数初始化为 0
*   将任何累积的等待时间初始化为 0
*   将当前系统时间初始化为0
*   等等。

一旦所有系统都已初始化，您将创建一个客户到达的事件。这通常由某个给定的分布决定。生成系统事件将需要更新系统的统计信息。此时您可以选择生成所有工作/客户到达时间。每个客户的服务时间也是您将从给定分布中生成的东西。

然后，您必须处理每个事件并相应地更新统计信息。例如，当第一个客户到达时，从模拟开始到当前时间，队列一直是空的。队列中的平均客户数量可能是一个感兴趣的参数。您应该将 0 * 经过的秒数累积到一个累加器中。一旦客户到达空队列，您应该生成服务时间。下一位客户将在给定工作完成之前或之后到达。如果下一个客户在前一个客户得到服务之前到达，那么您将他添加到队列中（累积没有人等待的事实）。根据接下来发生的事件，您必须累积在该时间间隔内发生的统计信息。服务器的空闲时间也是此类模拟中感兴趣的参数。

为了让事情更清楚，请考虑有 18 个人在排队，并且服务器已经为第一个客户完成了一项工作。第 18 个客户到达与第一个人工作完成之间的时间间隔是要添加到累加器的加权平均值。例如，有 18 人排队 4 秒。

服务器尚未空闲，因此您应该从队列中取出一个条目并开始处理下一个作业。这项工作将花费一些时间，通常是从某个分布中定义的。如果下一位客户在当前工作完成之前到达，那么 17 人排队的事实将被添加到您的加权值中。

再次在基本层面上，您正在累积系统中相关事件之间的统计数据：

```
while (current_time < total_simulation_time)
      handle_next_event
      generate_subsequent_events
      accumulate_statistics
      update_current_time
endwhile

Display "Average wait time: " accumulated_wait_time / number_of_customers_served 
```

希望这有助于它似乎有点冗长。

# c# - 显示自定义控件的自定义图标？

> ID：742781
> 
> 赞同：12
> 
> 时间：2009-04-13T01:22:11.797
> 
> 标签：c#, user-controls, custom-controls

在 Visual Studio 中，当您创建自定义控件时，您会得到这个[![默认工具箱图标](https://i.stack.imgur.com/PxbLj.png)](https://i.stack.imgur.com/PxbLj.png)丑陋的紫色小齿轮作为控件的图标，而不是自定义控件[![默认工具箱图标](https://i.stack.imgur.com/PxbLj.png)](https://i.stack.imgur.com/PxbLj.png)。

那么如何更改控件的图标呢？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2014-05-29T13:12:34.167

1.  将您的图标（例如“icon.bmp”16x16 像素）放在自定义控件项目的根文件夹中
2.  在您的控件类之前包含此行： [ToolboxBitmap(typeof(yourControl), "yourControl.bmp")]

以下是您需要注意的进一步步骤：-

1.  验证您的位图具有以下属性： 16 像素的高度 16 像素的宽度 位图保存为 16 色 bmp 文件
2.  将其命名为与自定义控件的类相同的名称（即：yourControl.bmp）
3.  将其放在同一目录中，然后将其作为程序集的嵌入式资源。
4.  要将位图作为嵌入资源启用，请右键单击位图文件并选择“属性”菜单项。在 Properties 页面中，将 Build Action 设置为 Embedded Resource。
5.  因此，当您将控件放置在页面中时，工具箱将在程序集清单中搜索与控件具有相同限定名称的嵌入位图，这就是位图必须与控件类具有相同名称的原因。

有关这方面的进一步讨论，您可以参考[此](http://forums.asp.net/t/942689.aspx?Icon%20for%20custom%20server%20control)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-13T01:24:54.660

使用类的[ToolboxBitmap](https://docs.microsoft.com/en-us/dotnet/api/system.drawing.toolboxbitmapattribute)属性。

# multithreading - 如何正确使用 SDl_Threads？

> ID：742789
> 
> 赞同：2
> 
> 时间：2009-04-13T01:25:04.567
> 
> 标签：multithreading, sdl

我不熟悉线程、SDL 以及图形的一般工作方式。我一直在浏览 LazyFoo 的所有 SDL 教程，对我帮助很大。但在他关于多线程的教程中，他评论说你不应该在单独的线程中使用视频功能，否则可能会导致问题。我很好奇应该怎么做，因为我对图形和线程的理解还很模糊。

由于我的一个项目是射击游戏，我想知道是否应该创建一个线程来显示所有图形，一个线程接收所有玩家为他的船输入，另一个线程用于敌方 AI。

如果这不是应该这样做的，（我认为这是错误的）是否有人对如何使用用户输入实现图形和使用线程的敌人 AI 有任何建议？

对于 Lazyfoo 的教程，这是链接： [http ://lazyfoo.net/SDL_tutorials/](http://lazyfoo.net/SDL_tutorials/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-12-10T12:10:02.977

刚开始时，根据职责分离线程会容易得多。解决这个问题的更“正确”的方法是使用线程池，这会导致更大的可伸缩性。那里有预先构建的线程池解决方案，包括一个用于 SDL 的解决方案。

如果您使用 OpenGL 或 DirectX 进行渲染，我怀疑对这些 API 的调用会产生很多开销，因此您至少可以在主线程中执行游戏循环的（必要的）顺序部分：获取输入、更新世界模型（包括使用人工智能计算的结果），渲染。然后你可以让人工智能、网络线程并行运行。因此，您无需担心单独的渲染线程。有一个例外：如果您在软件中进行大量计算（我的意思是在光线投射/光线跟踪中）渲染，那么您最好以某种方式在并行线程上执行渲染“逻辑”，写入帧缓冲区，然后在你的主线程中执行上面给出的序列，并使用例如 blitting 你准备好的帧缓冲区。GDI。

关于渲染，是的，仅从单个线程（主线程）进行的 AFAIK 渲染通常是（或曾经是）一个好主意，以确保例如。使用 OpenGL 你没有问题。再次AFAIK这不再是主要平台上的问题。另外，我不知道 GDI 或 DirectX 是否分别有相同的问题。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-04-13T02:01:18.473

一般来说，我认为将渲染线程与 UI/AI 线程分开是个好主意。它有助于使您的代码更易于理解。由于源代码中有许多游戏可用，您为什么不看看他们是如何做到的呢？

# c# - 表 UI C#

> ID：742793
> 
> 赞同：0
> 
> 时间：2009-04-13T01:27:09.117
> 
> 标签：c#, user-interface

我需要一些可以容纳 3 列文本的 GUI（我想对齐）。我将添加和删除行。我可以使用什么控件以及如何添加这 3 个项目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T01:31:09.980

如果您使用的是 WindowsForms，请使用 DataGrid 控件。它允许完全控制标题的显示，您可以随意手动添加/删除行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T01:40:21.927

如果你想使用 WinForms，你可以使用[TableLayoutPanel](http://msdn.microsoft.com/en-us/library/system.windows.forms.tablelayoutpanel.aspx)来提供这个功能。单元格内容可以是[Label](http://msdn.microsoft.com/en-us/library/system.windows.forms.label.aspx)或只读[TextBox](http://msdn.microsoft.com/en-us/library/system.windows.forms.textbox.aspx)。您也可以使用[DataGrid](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagrid(VS.71).aspx)。当然，也总是有[ListView](http://msdn.microsoft.com/en-us/library/system.windows.forms.listview.aspx)。

在 WPF 中，您有更多关于如何实现此目的的选项，但您可以使用[Grid](http://msdn.microsoft.com/en-us/library/system.windows.controls.grid.aspx)（在概念上类似于[TableLayoutPanel](http://msdn.microsoft.com/en-us/library/system.windows.forms.tablelayoutpanel.aspx)）或[DataGrid](http://wpf.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=25047)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T01:42:17.757

如果您正在寻找简单有效的东西，ListView 控件总是有效的。

# algorithm - PCP定理

> ID：742806
> 
> 赞同：1
> 
> 时间：2009-04-13T01:34:21.393
> 
> 标签：algorithm

有人可以用外行的术语来描述[PCP 定理吗？](http://en.wikipedia.org/wiki/PCP_theorem)[编辑：我是一名计算机科学专业的学生，​​开始理论。]

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-13T01:41:42.873

好吧，维基百科至少有两页关于这个主题：

*   [概率可检查的证明（复杂性）](http://en.wikipedia.org/wiki/PCP_(complexity))
*   [PCP定理](http://en.wikipedia.org/wiki/PCP_theorem)

我们可以为您的外行假设什么水平的知识？

粗略地说，我认为，可以检查 NP 完全问题的给定解决方案是否在（合理的）有限时间内接近最优，而确定最优解决方案则不是。

但是，这假设您知道“ [NP 完全](http://en.wikipedia.org/wiki/NP-complete)”意味着一个具有“[非确定性多项式复杂性](http://en.wikipedia.org/wiki/NP_(complexity))”的问题，等等——这对于外行来说是一个相当大的假设。您需要充分了解复杂性理论和“大 O”符号才能知道这意味着什么。并且要了解具有（确定性）多项式时间特征的算法与具有非确定性多项式时间特征的算法之间存在巨大差异。

在这方面，维基百科将成为你的朋友——或者你的导师推荐的算法书籍。

* * *

根据 Jörg W Mittag 的评论更正 - 谢谢。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-13T22:00:02.883

针对外行计算机科学家：

PCP 定理说，您可以制作易于检查的证明，您只需查看恒定数量的（随机选择的）位即可（通常）区分一个坏的证明和一个好的证明。

针对外行理论家：

对于一种语言来说，NP 意味着你可以很容易地*证明*一个字符串是这种语言。例如，您可以通过提供令人满意的输入来证明布尔电路是可满足的。（但很难证明一个电路是*不可*满足的！）

在这种情况下，验证证明的人/程序/图灵机必须在多项式时间内运行（在语言中假定的字符串大小）。它必须是*完整*的，这意味着它始终接受给定字符串在该语言中的有效证明。它必须是*sound*，这意味着它拒绝任何*不在*该语言中的字符串的“证明”。

对于 NP，验证者是确定性的。如果验证者可以使用随机性怎么办？然后我们必须允许一些错误，所以我们允许验证者不完全*正确*——它可能不正确地接受一些证明。真的，我们关心的是验证者至少检测到错误的证明，比如说，1/4 的时间。如果您想要更高的准确性，您可以再运行几次！:-)

最强形式的 PCP 定理说，NP 中的任何语言都有一个证明系统，只需查看*恒定*数量的随机选择的位就可以验证该证明系统。常数是... **3**。（这与 3-SAT 中的 3 相同）这些证明使用纠错码，因此证明中的任何错误都会与大部分输入冲突。使用更强大的代码让您只需 3 位即可任意接近 50% 的可靠性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-13T01:54:39.597

您可以尝试“NP 中的每个问题都有一个 PCP”，但“外行”*可能*不关心这个话题，任何深入的解释都有可能使他们陷入昏迷；-)

# jquery - 克隆不是克隆选择值

> ID：742810
> 
> 赞同：82
> 
> 时间：2009-04-13T01:35:27.817
> 
> 标签：jquery

我没想到它，但以下测试在克隆值检查中失败：

```
test("clone should retain values of select", function() {
    var select = $("<select>").append($("<option>")
                              .val("1"))
                              .append($("<option>")
                              .val("2"));
    $(select).val("2");
    equals($(select).find("option:selected").val(), "2", "expect 2");
    var clone = $(select).clone();
    equals($(clone).find("option:selected").val(), "2", "expect 2");
}); 
```

这是正确的吗？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-04-13T13:20:54.393

经过进一步研究，我在 JQuery 错误跟踪系统中找到了这张票，它解释了错误并提供了解决方法。显然，克隆选择值太贵了，所以他们不会修复它。

[https://bugs.jquery.com/ticket/1294](https://bugs.jquery.com/ticket/1294)

我对 clone 方法的使用是在一个通用方法中，任何东西都可能被克隆，所以我不确定何时或是否会有选择来设置值。所以我添加了以下内容：

```
var selects = $(cloneSourceId).find("select");
$(selects).each(function(i) {
    var select = this;
    $(clone).find("select").eq(i).val($(select).val());
}); 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2012-08-03T22:32:44.577

这是 jQuery 的克隆方法的固定版本：

[https://github.com/spencertipping/jquery.fix.clone](https://github.com/spencertipping/jquery.fix.clone)

```
// Textarea and select clone() bug workaround | Spencer Tipping
// Licensed under the terms of the MIT source code license

// Motivation.
// jQuery's clone() method works in most cases, but it fails to copy the value of textareas and select elements. This patch replaces jQuery's clone() method with a wrapper that fills in the
// values after the fact.

// An interesting error case submitted by Piotr Przybył: If two <select> options had the same value, the clone() method would select the wrong one in the cloned box. The fix, suggested by Piotr
// and implemented here, is to use the selectedIndex property on the <select> box itself rather than relying on jQuery's value-based val().

(function (original) {
  jQuery.fn.clone = function () {
    var result           = original.apply(this, arguments),
        my_textareas     = this.find('textarea').add(this.filter('textarea')),
        result_textareas = result.find('textarea').add(result.filter('textarea')),
        my_selects       = this.find('select').add(this.filter('select')),
        result_selects   = result.find('select').add(result.filter('select'));

    for (var i = 0, l = my_textareas.length; i < l; ++i) $(result_textareas[i]).val($(my_textareas[i]).val());
    for (var i = 0, l = my_selects.length;   i < l; ++i) result_selects[i].selectedIndex = my_selects[i].selectedIndex;

    return result;
  };
}) (jQuery.fn.clone); 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2011-07-15T22:41:00.117

根据 Chief7 的回答制作了一个插件：

```
(function($,undefined) {
    $.fn.cloneSelects = function(withDataAndEvents, deepWithDataAndEvents) {
        var $clone = this.clone(withDataAndEvents, deepWithDataAndEvents);
        var $origSelects = $('select', this);
        var $clonedSelects = $('select', $clone);
        $origSelects.each(function(i) {
            $clonedSelects.eq(i).val($(this).val());
        });
        return $clone;
    }
})(jQuery); 
```

只是简单地测试了它，但它似乎工作。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2016-03-25T11:16:01.360

我的方法有点不同。

而不是在克隆期间修改选择，我只是`select`在页面上观看每个`change`事件，然后，如果值发生更改，我将需要`selected`的属性添加到 selected 中`<option>`，使其变为`<option selected="selected">`. 由于选择现在被标记在`<option>`'s 标记中，当您选择`.clone()`它时它会被传递。

您需要的唯一代码：

```
//when ANY select on page changes its value
$(document).on("change", "select", function(){
    var val = $(this).val(); //get new value
    //find selected option
    $("option", this).removeAttr("selected").filter(function(){
        return $(this).attr("value") == val;
    }).first().attr("selected", "selected"); //add selected attribute to selected option
}); 
```

现在，您可以复制选择任何您想要的方式，它的价值也会被复制。

```
$("#my-select").clone(); //will have selected value copied 
```

我认为这个解决方案的*自定义*程度较低，因此如果您稍后修改某些内容，您不必担心您的代码是否会中断。

如果您不希望将其应用于页面上的每个选择，您可以在第一行更改选择器，例如：

```
$(document).on("change", "select.select-to-watch", function(){ 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-08-04T14:55:24.897

简化 Chief7 的回答：

```
var cloned_form = original_form.clone()
original_form.find('select').each(function(i) {
    cloned_form.find('select').eq(i).val($(this).val())
}) 
```

同样，这里是 jQuery 票：[http ://bugs.jquery.com/ticket/1294](http://bugs.jquery.com/ticket/1294)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-13T02:52:03.157

是的。这是[因为](http://www.w3.org/TR/2001/WD-DOM-Level-2-HTML-20011210/html.html#ID-70874476)“select”DOM 节点的“selected”属性与选项的“selected”属性不同。jQuery 不会以任何方式修改选项的属性。

试试这个：

```
$('option', select).get(1).setAttribute('selected', 'selected');
//    starting from 0   ^ 
```

如果您真的对 val 函数的工作原理感兴趣，您可能需要检查

```
alert($.fn.val) 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-08-17T17:23:49.760

克隆 a`<select>`不会复制s**上**`value=`的属性`<option>`。所以 Mark 的插件并非在所有情况下都有效。

要修复，请在克隆值*之前执行此操作：*`<select>`

```
var $origOpts = $('option', this);
var $clonedOpts = $('option', $clone);
$origOpts.each(function(i) {
   $clonedOpts.eq(i).val($(this).val());
}); 
```

`<select>`在 jQuery 1.6.1+中克隆选择了哪个选项的另一种方法...

```
// instead of:
$clonedSelects.eq(i).val($(this).val());

// use this:
$clonedSelects.eq(i).prop('selectedIndex', $(this).prop('selectedIndex')); 
```

后者允许`<option>`您*在*设置`selectedIndex`.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-07-21T23:21:25.227

```
$(document).on("change", "select", function(){
    original = $("#original");
    clone = $(original.clone());
    clone.find("select").val(original.find("select").val());

}); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-01-28T09:35:31.457

如果您只需要选择的值，序列化表单或类似的东西，这对我有用：

```
$clonedForm.find('theselect').val($origForm.find('theselect').val()); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-03-16T11:07:36.393

just reporting back. For some godly unknown reason, and even though this was the first thing I tested, and I haven't changed my code whatsoever, now the

```
$("#selectTipoIntervencion1").val($("#selectTipoIntervencion0").val()); 
```

approach is working. I have no idea why or if it will stop working again as soon as I change something, but I'm gonna go with this for now. Thanks everybody for the help!

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-07-29T03:46:49.017

@pie6k 展示了一个好主意。

它解决了我的问题。我把它改小一点：

```
$(document).on("change", "select", function(){
    var val = $(this).val();
    $(this).find("option[value=" + val + "]").attr("selected",true);
}); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-11-27T16:22:34.707

在尝试了 1 小时的不同解决方案后，我确实创建了这个简单的解决方案

```
$clonedItem.find('select option').removeAttr('selected');
$clonedItem.find('select option[value="' + $originaItem.find('select').val() + '"]').attr('selected', 'true'); 
```

# javascript - reddit 是如何在弹出登录表单时让整个背景变黑的？

> ID：742812
> 
> 赞同：0
> 
> 时间：2009-04-13T01:40:58.383
> 
> 标签：javascript, css, ajax

当您单击 reddit 注册按钮时，会弹出一个漂亮的窗口，并且屏幕的其余部分会变黑。您可以单击屏幕的其余部分以关闭弹出窗口。

我知道我可以为此使用最外层的 div，但这就是 reddit 的做法吗？他们是否也在动态更改该外部 div 的属性？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-13T01:52:18.713

这种技术被称为 an`overlay`并且实现起来非常简单：

```
#overlay {
    position: fixed;
    z-index:103;
    top: 0px;
    left: 0px;
    height:100%;
    width:100%;
    background-color: gray;
    opacity: 0.7;
} 
```

显示它的完整行为称为[模态窗口](http://en.wikipedia.org/wiki/Modal_window)。

[查看上面 CSS 的实时示例](http://jsbin.com/ezeno)。

但是，考虑到所有因素，要使浮动 DIV 具有表单等，您将需要使用已经为此制作的许多插件之一，例如[Thickbox](http://jquery.com/demo/thickbox/)或[jqModal](http://dev.iceburg.net/jquery/jqModal/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-13T01:50:07.143

他们创建了一个`div`具有以下 CSS 属性的元素：

```
/* Makes div cover page */
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;

/* Puts div over all other elements on page */
z-index: 1000;

/* Fills the div with a solid colour */
background-color: gray;

/* Makes div partially see-through */
opacity: 0.7; 
```

然后`div`将登录框的`z-index`设置为`1001`，使其显示在`div`覆盖层上方。

史蒂夫

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T01:44:26.470

他们使用一个类似于[thinbox](http://jquery.com/demo/thickbox/)的插件。

# iphone - 进入编辑模式时动画自定义绘制的 UITableViewCell

> ID：742829
> 
> 赞同：49
> 
> 时间：2009-04-13T01:51:41.477
> 
> 标签：iphone, objective-c, cocoa-touch, ios

### 背景

首先，非常感谢[atebits](http://www.atebits.com)提供了非常丰富的博文[Fast Scrolling in Tweetie with UITableView](http://blog.atebits.com/2008/12/fast-scrolling-in-tweetie-with-uitableview)。[这篇文章详细解释了开发人员如何能够从Tweetie](http://www.atebits.com/tweetie-iphone)中的 UITableViews 中挤出尽可能多的滚动性能。

### 目标

从博客文章（[原始](http://atebits.cachefly.net/blog/FastScrolling/FastScrolling.zip)）（[我的 github 存储库](http://github.com/adamalex/fast-scrolling/tree/c335d04f2fcf9ecd2c92935fc73ff09d89569e15)）链接的源代码开始：

1.  允许使用这些自定义单元格的 UITableView 切换到编辑模式，公开 UI 以从表格中删除项目。（[github 提交](http://github.com/adamalex/fast-scrolling/commit/9fa66a3ecb9c98bcc3ed4bd5cf26a7b6825b5ffb)）

2.  当删除控件从左侧滑入时，将单元格的文本移到一边。这样就完成了，虽然文本在没有动画的情况下来回跳转。（[github 提交](http://github.com/adamalex/fast-scrolling/commit/eb88ffd7af320cd55eda230f204251644dca4fbf)）

3.  *将动画应用于上述目标 2 中的文本移动，以获得流畅的用户体验。这是我陷入困境的一步。*

### 问题

介绍此动画以完成目标 3 的最佳方式是什么？如果这可以以保持我[上次提交](http://github.com/adamalex/fast-scrolling/commit/eb88ffd7af320cd55eda230f204251644dca4fbf)的逻辑的方式完成，那就太好了，因为我希望选择仅移动视图的冲突部分，而任何非冲突部分（例如右对齐文本）留在同一个地方或移动不同数量的像素。如果上述方法不可行，那么撤消我的最后一次提交并将其替换为将整个视图向右滑动的选项也将是一个可行的解决方案。

我感谢任何人可以提供的任何帮助，从快速指针和想法一直到代码片段或 github 提交。当然，如果你愿意，欢迎你 fork[我的 repo 。](http://github.com/adamalex/fast-scrolling/tree/master)我将继续参与这个问题，以确保任何成功的解决方案都提交给 github 并在此处完整记录。非常感谢你花时间陪伴！

### 更新的想法

自从我的第一篇文章以来，我一直在考虑这个问题，并意识到在视图中相对于其他文本项移动一些文本项可能会破坏原始博客文章中解决的一些原始性能目标。所以在这一点上，我正在考虑一个解决方案，其中整个单个子视图被动画到它的新位置可能是最好的一个。

其次，如果以这种方式完成，则可能存在子视图具有自定义颜色或渐变背景的情况。希望这可以通过一种方式完成，即在其正常位置，背景向左延伸到看不见的程度，以便当视图向右滑动时，自定义背景在整个单元格中仍然可见。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-14T03:47:05.763

感[谢克雷格的回答](https://stackoverflow.com/questions/742829/animating-custom-drawn-uitableviewcell-when-entering-edit-mode/743856#743856)为我指明了正确的方向，我有一个解决方案。我恢复了我的[提交](http://github.com/adamalex/fast-scrolling/commit/eb88ffd7af320cd55eda230f204251644dca4fbf)，它根据编辑模式移动了文本位置，并将其替换为[一个新的解决方案](http://github.com/adamalex/fast-scrolling/commit/5cef99dfa4697b9d8d89185d3b3ab8edb7cb532d)，该解决方案在任何时候调用 layoutSubviews 时都将整个内容视图设置为正确的位置，这会在切换到和从编辑模式时产生自动动画：

```
- (void)layoutSubviews
{
    CGRect b = [self bounds];
    b.size.height -= 1; // leave room for the separator line
    b.size.width += 30; // allow extra width to slide for editing
    b.origin.x -= (self.editing) ? 0 : 30; // start 30px left unless editing
    [contentView setFrame:b];
    [super layoutSubviews];
} 
```

通过这样做，我能够删除在 ABTableViewCell.m 中找到的 setFrame: override，因为它以前的逻辑加上我的添加现在可以在 layoutSubviews 中找到。

我在单元格上设置了一个浅灰色背景，以验证自定义背景是否正常工作，而不会让我们在它来回移动时看到它的背后，它似乎工作得很好。

再次感谢克雷格和其他任何对此进行调查的人。

此解决方案的 GitHub 提交：([链接](http://github.com/adamalex/fast-scrolling/commit/5cef99dfa4697b9d8d89185d3b3ab8edb7cb532d))

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-13T13:12:55.240

您目前如何移动文本？或者更具体地说，您在哪个 UITableViewCell 方法中执行移动？

根据我的经验，在此处覆盖该`layoutSubviews`方法并设置框架将自动包装在动画中。

例如：

```
- (void)layoutSubviews {
    if (self.editing) {
        [titleLabel setFrame:CGRectMake(62, 6, 170, 24)];
    }
    else {
        [titleLabel setFrame:CGRectMake(30, 6, 200, 24)];
    }
    [super layoutSubviews];
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2010-08-18T10:31:46.630

为了完全控制自定义单元格中的编辑，您应该覆盖 UITableViewCell 子类中的 willTransitionToState 方法并检查状态掩码

```
- (void)willTransitionToState:(UITableViewCellStateMask)state
{
    NSString *logStr = @"Invoked";
    if ((state & UITableViewCellStateShowingEditControlMask)
        != 0) {
        // you need to move the controls in left
        logStr = [NSString stringWithFormat:@"%@
                  %@",logStr,@"UITableViewCellStateShowingEditControlMask"];
    }
    if ((state & UITableViewCellStateShowingDeleteConfirmationMask)
        != 0) {
        // you need to hide the controls for the delete button
        logStr = [NSString stringWithFormat:@"%@
                  %@",logStr,@"UITableViewCellStateShowingDeleteConfirmationMask"];
    }
    NSLog(@"%@",logStr);
    [super willTransitionToState:state];
} 
```

你也可以覆盖 layoutSubviews

```
- (void)layoutSubviews {
    // default place for label
    CGRect alarmTimeRect = CGRectMake(37, 7, 75, 30);
    if (self.editing && !self.showingDeleteConfirmation) {
        // move rect in left
        alarmTimeRect = CGRectMake(77, 7, 75, 30);
    }
    [alarmTimeLabel setFrame:alarmTimeRect];
    [super layoutSubviews];
} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-11-10T17:52:21.640

还要处理滑动：（self.editing && !self.showingDeleteConfirmation）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-05-31T20:45:39.313

我也有这个问题：如何为自定义编辑模式设置动画？我不是很喜欢这里的解决方案，所以我决定稍微思考一下并找到一个不同的解决方案。我不知道它是否更好，但我更喜欢那个。所以我决定在这里分享：

在自定义单元格（继承自 UITableViewCell）中，只需重载 setEditing：

```
- (void)setEditing:(BOOL)editing animated:(BOOL)animated {
    [super setEditing:editing animated:animated];

    if (animated) {
        [UIView beginAnimations:@"setEditingAnimation" context:nil];
        [UIView setAnimationDuration:0.3];
    }

    if (editing) {
        /* do your offset and resize here */
    } else {
        /* return to the original here*/
    }

    if (animated)
        [UIView commitAnimations];
} 
```

我不检查编辑值是否相同，但这只是我如何做到的一个想法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-17T05:00:04.293

实际上有四种编辑状态。

UITableViewCellStateDefaultMask = 0

UITableViewCellStateShowingEditControlMask = 1<<0 = 0b01 = 1 通过设置 tableView.edit = YES

UITableViewCellStateShowingDeleteConfirmationMask = 1<<1 = 0b10 = 2 通过滑动删除

UITableViewCellStateShowingEditControlMask 和 UITableViewCellStateShowingDeleteConfirmationMask = (1<<1)&(1<<0) = 0b11 = 3 通过设置 tableView.edit = YES 并按下“停止”按钮

让我感到困惑的是，当状态 3 转换到状态 1 时，不会调用任何选择器，它没有使用 self.showingDeleteConfirmation 来更改 iOS7 中的布局**。因此**，为了明确状态 2 和状态 3，我添加了一个实例变量来实现它。这对我很有效。

```
-(void)willTransitionToState:(UITableViewCellStateMask)state{
    [super willTransitionToState:state];

    //Custom delete button from
    //http://stackoverflow.com/questions/19159476/uitableviewcelldeleteconfirmationcontrol-issue
    if((state & UITableViewCellStateShowingDeleteConfirmationMask) == UITableViewCellStateShowingDeleteConfirmationMask){
        [self recurseAndReplaceSubViewIfDeleteConfirmationControl:self.subviews];
        [self performSelector:@selector(recurseAndReplaceSubViewIfDeleteConfirmationControl:) withObject:self.subviews afterDelay:0];
    }

    _swipeDelete = NO;

    if(state==2){
        //Swipe to delete confirm
        _swipeDelete = YES;
    }

    if(state==3){
        //Edit state to delete confirm
    }
}

- (void)layoutSubviews{

    [super layoutSubviews];

    self.contentView.frame = CGRectMake(10, 5.0, 300, self.frame.size.height - 10);

    if(self.editing){
        self.contentView.frame = CGRectMake(40, 5.0, 270, self.frame.size.height - 10);
    }

    if(_swipeDelete){
        self.contentView.frame = CGRectMake(10, 5.0, 300, self.frame.size.height - 10);
    }
} 
```

# javascript - JavaScript OnBlur 事件阻止提交 HTML 表单

> ID：742837
> 
> 赞同：5
> 
> 时间：2009-04-13T01:56:05.210
> 
> 标签：javascript, forms, dom-events, form-submit, onblur

考虑以下形式：

```
<form action="/a" method="post"> 
    <input name="x" type="text" onblur="myonblur(e)" />
    <input name="y" type="text" />
    <input name="submit" type="submit" value="Submit" />
</form> 
```

当焦点位于名称为“x”的元素上并且用户按下提交按钮时，将`onblur`触发事件但未提交表单。如果我的表单中有`onblur` 事件，有什么方法可以使提交按钮按预期工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-13T01:59:31.957

考虑优化您的`onBlur()`方法，以减少运行时间。如果您的表单无法提交，可能是因为表单`onBlur()`太长而导致浏览器无法执行任何其他操作。

您也可以使用该`onChange()`方法代替 `onBlur()`. 这可能对你更有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T17:10:43.373

尝试添加

```
return true; 
```

在调用你的 onBlur 函数之后。您面临的问题可能是由于事件处理程序的“返回错误”预防。

# java - 如何判断二叉树是否平衡？

> ID：742844
> 
> 赞同：117
> 
> 时间：2009-04-13T01:58:06.673
> 
> 标签：java, algorithm, data-structures, binary-tree

从那个学年到现在已经有一段时间了。在一家医院找到了一份 IT 专家的工作。现在正在尝试进行一些实际的编程。我现在正在研究二叉树，我想知道确定树是否高度平衡的最佳方法是什么。

我在想一些事情：

```
public boolean isBalanced(Node root){
    if(root==null){
        return true;  //tree is empty
    }
    else{
        int lh = root.left.height();
        int rh = root.right.height();
        if(lh - rh > 1 || rh - lh > 1){
            return false;
        }
    }
    return true;
} 
```

这是一个很好的实现吗？还是我错过了什么？

* * *

## 回答 #1

> 赞同：168
> 
> 时间：2010-02-01T16:33:33.653

在寻找其他东西时偶然发现了这个老问题。我注意到您从未得到完整的答案。

解决此问题的方法是首先为您尝试编写的函数编写规范。

规范：如果（1）它是空的，或者（2）它的左右孩子高度平衡并且左树的高度在 1右树的高度。

既然您有了规范，那么编写代码就很简单了。只需遵循规范：

```
IsHeightBalanced(tree)
    return (tree is empty) or 
           (IsHeightBalanced(tree.left) and
            IsHeightBalanced(tree.right) and
            abs(Height(tree.left) - Height(tree.right)) <= 1) 
```

将其翻译成您选择的编程语言应该是微不足道的。

**奖励练习**：这个简单的代码草图在计算高度时遍历树的次数太多了。你能让它更有效率吗？

**超级奖励练习**：假设树*严重*不平衡。就像，一侧深一百万个节点，另一侧深三个。是否存在这种算法炸毁堆栈的情况？您能否修复实现以使其永远不会破坏堆栈，即使在给定大量不平衡树的情况下也是如此？

**更新**：Donal Fellows 在他的回答中指出，人们可以选择不同的“平衡”定义。例如，可以对“高度平衡”采取更严格的定义，并要求到*最近的*空孩子的路径长度在到*最远*的空孩子的路径之一内。我的定义没有那么严格，因此允许更多的树。

也可以没有我的定义那么严格；可以说，平衡树是这样一种树，其中每个分支上到一棵空树的最大路径长度相差不超过 2、3 或其他常数。或者最大路径长度是最小路径长度的一部分，例如一半或四分之一。

平时真的无所谓。任何树平衡算法的重点是确保您不会陷入一侧有一百万个节点而另一侧有三个节点的情况。Donal 的定义在理论上是好的，但在实践中，提出一种满足这种严格程度的树平衡算法是很痛苦的。性能节省通常不能证明实施成本是合理的。您花费大量时间进行不必要的树重新排列，以达到在实践中几乎没有什么区别的平衡水平。谁会在乎有时需要 40 个分支才能到达一棵百万节点的不完全平衡树中最远的叶子，而理论上它在完全平衡的树中只需要 20 个？关键是它永远不需要一百万。从一百万的最坏情况下降到四十的最坏情况通常就足够了。您不必一直寻找最佳情况。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2010-04-07T21:53:12.323

平衡是一种真正微妙的属性。你以为你知道它是什么，但它很容易出错。特别是，即使是 Eric Lippert 的（好的）答案也是错误的。那是因为*高度*的概念是不够的。您需要了解树的最小和最大高度的概念（其中最小高度是从根到叶的最少步数，而最大高度是......好吧，你明白了）。鉴于此，我们可以将平衡定义为：

> 任何树枝的最大高度不超过任何树枝的最小高度的*一*棵树。

（这实际上意味着分支本身是平衡的；您可以选择相同的分支作为最大值和最小值。）

验证此属性所需要做的就是一个简单的树遍历来跟踪当前深度。第一次回溯时，会给你一个基线深度。之后每次回溯时，都会将新深度与基线进行比较

*   如果它等于基线，那么你就继续
*   如果不止一个不同，则树不平衡
*   如果它是一个关闭，那么您现在知道平衡范围，并且所有后续深度（当您即将回溯时）必须是第一个或第二个值。

在代码中：

```
class Tree {
    Tree left, right;
    static interface Observer {
        public void before();
        public void after();
        public boolean end();
    }
    static boolean traverse(Tree t, Observer o) {
        if (t == null) {
            return o.end();
        } else {
            o.before();
            try {
                if (traverse(left, o))
                    return traverse(right, o);
                return false;
            } finally {
                o.after();
            }
        }
    }
    boolean balanced() {
        final Integer[] heights = new Integer[2];
        return traverse(this, new Observer() {
            int h;
            public void before() { h++; }
            public void after() { h--; }
            public boolean end() {
                if (heights[0] == null) {
                    heights[0] = h;
                } else if (Math.abs(heights[0] - h) > 1) {
                    return false;
                } else if (heights[0] != h) {
                    if (heights[1] == null) {
                        heights[1] = h;
                    } else if (heights[1] != h) {
                        return false;
                    }
                }
                return true;
            }
        });
    }
} 
```

我想你可以在不使用观察者模式的情况下做到这一点，但我发现这样推理更容易。

* * *

[编辑]：为什么你不能只取每一边的高度。考虑这棵树：

```
 /\
       /  \
      /    \
     /      \_____
    /\      /     \_
   /  \    /      / \
  /\   C  /\     /   \
 /  \    /  \   /\   /\
A    B  D    E F  G H  J 
```

好的，有点乱，但是根的每一边都是平衡的：`C`深度为 2，`A`，`B`，`D`，`E`深度为 3，`F`，`G`，`H`，`J`深度为 4。左分支的高度为 2（记住高度会随着您遍历而减小分支），右分支的高度为 3。但整个树并*不平衡*`C`，因为和之间的高度差为 2 `F`。您需要一个 minimax 规范（尽管实际算法可能不那么复杂，因为应该只有两个允许的高度）。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2009-04-13T02:03:00.827

这仅确定树的顶层是否平衡。也就是说，你可以有一棵树，在最左边和最右边有两条长树枝，中间什么都没有，这将返回 true。在返回 true 之前，您需要递归检查`root.left`and`root.right`以查看它们是否也在内部平衡。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2010-02-02T14:25:40.323

奖励练习反应。简单的解决方案。显然，在实际实现中，可能会包装这个或其他东西以避免要求用户在他们的响应中包含高度。

```
IsHeightBalanced(tree, out height)
    if (tree is empty)
        height = 0
        return true
    balance = IsHeightBalanced(tree.left, out heightleft) and IsHeightBalanced(tree.right, out heightright)
    height = max(heightleft, heightright)+1
    return balance and abs(heightleft - heightright) <= 1 
```

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2013-09-03T14:44:17.937

发布订单解决方案，仅遍历树一次。时间复杂度为 O(n)，空间为 O(1)，比自顶向下的解决方案要好。我给你一个java版本的实现。

```
public static <T> boolean isBalanced(TreeNode<T> root){
    return checkBalance(root) != -1;
}

private static <T> int checkBalance(TreeNode<T> node){
    if(node == null) return 0;
    int left = checkBalance(node.getLeft());

    if(left == -1) return -1;

    int right = checkBalance(node.getRight());

    if(right == -1) return -1;

    if(Math.abs(left - right) > 1){
        return -1;
    }else{
        return 1 + Math.max(left, right);
    }
} 
```

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2011-02-22T10:20:53.363

高度平衡二叉树的定义是：

> 二叉树，其中**每个**节点的两个子树的高度相差不超过 1。

所以，一棵空的二叉树总是高度平衡的。
如果满足以下条件，则非空二叉树是高度平衡的：

1.  它的左子树是高度平衡的。
2.  它的右子树是高度平衡的。
3.  左右子树的高度差不大于1。

考虑树：

```
 A
     \ 
      B
     / \
    C   D 
```

正如所见，它的左子树`A`是高度平衡的（因为它是空的），它的右子树也是如此。但是树仍然不是高度平衡的，因为条件 3 不满足，因为左子树的`0`高度是 并且右子树的高度是`2`。

即使左右子树的高度相等，下面的树也不是高度平衡的。您现有的代码将为它返回 true。

```
 A
     /  \ 
    B    C
   /      \
  D        G
 /          \
E            H 
```

所以def中的**every**这个词非常重要。

这将起作用：

```
int height(treeNodePtr root) {
        return (!root) ? 0: 1 + MAX(height(root->left),height(root->right));
}

bool isHeightBalanced(treeNodePtr root) {
        return (root == NULL) ||
                (isHeightBalanced(root->left) &&
                isHeightBalanced(root->right) &&
                abs(height(root->left) - height(root->right)) <=1);
} 
```

[**Ideone 链接**](http://www.ideone.com/LB5x6)

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2015-12-16T19:57:17.017

可以通过Level order traversal检查二叉树是否平衡：

```
private boolean isLeaf(TreeNode root) {
    if (root.left == null && root.right == null)
        return true;
    return false;
}

private boolean isBalanced(TreeNode root) {
    if (root == null)
        return true;
    Vector<TreeNode> queue = new Vector<TreeNode>();
    int level = 1, minLevel = Integer.MAX_VALUE, maxLevel = Integer.MIN_VALUE;
    queue.add(root);
    while (!queue.isEmpty()) {
        int elementCount = queue.size();
        while (elementCount > 0) {
            TreeNode node = queue.remove(0);
            if (isLeaf(node)) {
                if (minLevel > level)
                    minLevel = level;
                if (maxLevel < level)
                    maxLevel = level;
            } else {
                if (node.left != null)
                    queue.add(node.left);
                if (node.right != null)
                    queue.add(node.right);
            }
            elementCount--;
        }
        if (abs(maxLevel - minLevel) > 1) {
            return false;
        }
        level++;
    }

    return true;
} 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2010-11-17T08:33:25.257

这比实际情况要复杂得多。

算法如下：

1.  令 A = 最高层节点的深度
2.  令 B = 最低层节点的深度

3.  如果 abs(AB) <= 1，则树是平衡的

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-04-13T02:32:08.603

平衡意味着什么取决于手头的结构。例如，B-Tree 的节点不能超过距根的一定深度，或者更少，所有数据都位于距根的固定深度，但如果叶子到叶子的分布可能会失去平衡- 但一个节点是不均匀的。跳过列表完全没有平衡的概念，而是依靠概率来实现良好的性能。斐波那契树故意失去平衡，推迟重新平衡以实现卓越的渐近性能，以换取偶尔更长的更新。AVL 和红黑树将元数据附加到每个节点以获得深度平衡不变量。

所有这些结构以及更多结构都存在于大多数常见编程系统的标准库中（python、RAGE 除外！）。实现一两个是很好的编程实践，但它可能不是一个很好的利用时间来为生产滚动你自己的，除非你的问题有一些特殊的性能，不需要任何现成的集合来满足。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2014-06-03T02:53:22.263

注 1：任何子树的高度只计算一次。

注 2：如果左子树不平衡，则跳过可能包含百万个元素的右子树的计算。

```
// return height of tree rooted at "tn" if, and only if, it is a balanced subtree
// else return -1
int maxHeight( TreeNode const * tn ) {
    if( tn ) {
        int const lh = maxHeight( tn->left );
        if( lh == -1 ) return -1;
        int const rh = maxHeight( tn->right );
        if( rh == -1 ) return -1;
        if( abs( lh - rh ) > 1 ) return -1;
        return 1 + max( lh, rh );
    }
    return 0;
}

bool isBalanced( TreeNode const * root ) {
    // Unless the maxHeight is -1, the subtree under "root" is balanced
    return maxHeight( root ) != -1;
} 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-04-13T02:10:47.657

平衡通常取决于每个方向上最长路径的长度。上述算法不会为您做到这一点。

你想实现什么？周围有自平衡树（AVL/红黑）。事实上，Java 树是平衡的。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2011-05-05T04:42:41.277

```
public boolean isBalanced(TreeNode root)
{
    return (maxDepth(root) - minDepth(root) <= 1);
}

public int maxDepth(TreeNode root)
{
    if (root == null) return 0;

    return 1 + max(maxDepth(root.left), maxDepth(root.right));
}

public int minDepth (TreeNode root)
{
    if (root == null) return 0;

    return 1 + min(minDepth(root.left), minDepth(root.right));
} 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2016-09-05T11:46:52.337

这是一个完整的 C# 测试解决方案（对不起，我不是 java 开发人员）（只需在控制台应用程序中复制粘贴）。我知道平衡的定义各不相同，所以不是每个人都可能喜欢我的测试结果，但请看一下在递归循环中检查深度/高度并在第一次不匹配时退出而不在每个节点上保存节点高度/级别/深度的略有不同的方法（仅在函数调用中维护它）。

```
using System;
using System.Linq;
using System.Text;

namespace BalancedTree
{
    class Program
    {
        public static void Main()
        {
            //Value Gathering
            Console.WriteLine(RunTreeTests(new[] { 0 }));
            Console.WriteLine(RunTreeTests(new int[] { }));

            Console.WriteLine(RunTreeTests(new[] { 0, 1, 2, 3, 4, -1, -4, -3, -2 }));
            Console.WriteLine(RunTreeTests(null));
            Console.WriteLine(RunTreeTests(new[] { 10, 8, 12, 8, 4, 14, 8, 10 }));
            Console.WriteLine(RunTreeTests(new int[] { 20, 10, 30, 5, 15, 25, 35, 3, 8, 12, 17, 22, 27, 32, 37 }));

            Console.ReadKey();
        }

        static string RunTreeTests(int[] scores)
        {
            if (scores == null || scores.Count() == 0)
            {
                return null;
            }

            var tree = new BinarySearchTree();

            foreach (var score in scores)
            {
                tree.InsertScore(score);
            }

            Console.WriteLine(tree.IsBalanced());

            var sb = tree.GetBreadthWardsTraversedNodes();

            return sb.ToString(0, sb.Length - 1);
        }
    }

    public class Node
    {
        public int Value { get; set; }
        public int Count { get; set; }
        public Node RightChild { get; set; }
        public Node LeftChild { get; set; }
        public Node(int value)
        {
            Value = value;
            Count = 1;
        }

        public override string ToString()
        {
            return Value + ":" + Count;
        }

        public bool IsLeafNode()
        {
            return LeftChild == null && RightChild == null;
        }

        public void AddValue(int value)
        {
            if (value == Value)
            {
                Count++;
            }
            else
            {
                if (value > Value)
                {
                    if (RightChild == null)
                    {
                        RightChild = new Node(value);
                    }
                    else
                    {
                        RightChild.AddValue(value);
                    }
                }
                else
                {
                    if (LeftChild == null)
                    {
                        LeftChild = new Node(value);
                    }
                    else
                    {
                        LeftChild.AddValue(value);
                    }
                }
            }
        }
    }

    public class BinarySearchTree
    {
        public Node Root { get; set; }

        public void InsertScore(int score)
        {
            if (Root == null)
            {
                Root = new Node(score);
            }
            else
            {
                Root.AddValue(score);
            }
        }

        private static int _heightCheck;
        public bool IsBalanced()
        {
            _heightCheck = 0;
            var height = 0;
            if (Root == null) return true;
            var result = CheckHeight(Root, ref height);
            height--;
            return (result && height == 0);
        }

        private static bool CheckHeight(Node node, ref int height)
        {
            height++;
            if (node.LeftChild == null)
            {
                if (node.RightChild != null) return false;
                if (_heightCheck != 0) return _heightCheck == height;
                _heightCheck = height;
                return true;
            }
            if (node.RightChild == null)
            {
                return false;
            }

            var leftCheck = CheckHeight(node.LeftChild, ref height);
            if (!leftCheck) return false;
            height--;
            var rightCheck = CheckHeight(node.RightChild, ref height);
            if (!rightCheck) return false;
            height--;
            return true;
        }

        public StringBuilder GetBreadthWardsTraversedNodes()
        {
            if (Root == null) return null;
            var traversQueue = new StringBuilder();
            traversQueue.Append(Root + ",");
            if (Root.IsLeafNode()) return traversQueue;
            TraversBreadthWards(traversQueue, Root);
            return traversQueue;
        }

        private static void TraversBreadthWards(StringBuilder sb, Node node)
        {
            if (node == null) return;
            sb.Append(node.LeftChild + ",");
            sb.Append(node.RightChild + ",");
            if (node.LeftChild != null && !node.LeftChild.IsLeafNode())
            {
                TraversBreadthWards(sb, node.LeftChild);
            }
            if (node.RightChild != null && !node.RightChild.IsLeafNode())
            {
                TraversBreadthWards(sb, node.RightChild);
            }
        }
    }
} 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-04-13T02:14:55.773

如果这是为了你的*工作*，我建议：

1.  [不要重新发明](http://www.google.com/search?hl=en&q=height+balanced+binary+tree&aq=0&oq=height+balanced+b)轮子
2.  [使用/购买 COTS](http://www.google.com/search?q=height+balanced+binary+tree+java+library&btnG=Search&hl=en&sa=2)而不是摆弄比特。
3.  节省您的时间/精力来解决业务问题。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2011-12-06T17:34:24.633

```
#include <iostream>
#include <deque>
#include <queue>

struct node
{
    int data;
    node *left;
    node *right;
};

bool isBalanced(node *root)
{
    if ( !root)
    {
        return true;
    }

    std::queue<node *> q1;
    std::queue<int>  q2;
    int level = 0, last_level = -1, node_count = 0;

    q1.push(root);
    q2.push(level);

    while ( !q1.empty() )
    {
        node *current = q1.front();
        level = q2.front();

        q1.pop();
        q2.pop();

        if ( level )
        {
            ++node_count;
        }

                if ( current->left )
                {
                        q1.push(current->left);
                        q2.push(level + 1);
                }

                if ( current->right )
                {
                        q1.push(current->right);
                        q2.push(level + 1);
                }

        if ( level != last_level )
        {
            std::cout << "Check: " << (node_count ? node_count - 1 : 1) << ", Level: " << level << ", Old level: " << last_level << std::endl;
            if ( level && (node_count - 1) != (1 << (level-1)) )
            {
                return false;
            }

            last_level = q2.front();
            if ( level ) node_count = 1;
        }
    }

    return true;
}

int main()
{
    node tree[15];

    tree[0].left  = &tree[1];
    tree[0].right = &tree[2];
    tree[1].left  = &tree[3];
    tree[1].right = &tree[4];
    tree[2].left  = &tree[5];
    tree[2].right = &tree[6];
    tree[3].left  = &tree[7];
    tree[3].right = &tree[8];
    tree[4].left  = &tree[9];   // NULL;
    tree[4].right = &tree[10];  // NULL;
    tree[5].left  = &tree[11];  // NULL;
    tree[5].right = &tree[12];  // NULL;
    tree[6].left  = &tree[13];
    tree[6].right = &tree[14];
    tree[7].left  = &tree[11];
    tree[7].right = &tree[12];
    tree[8].left  = NULL;
    tree[8].right = &tree[10];
    tree[9].left  = NULL;
    tree[9].right = &tree[10];
    tree[10].left = NULL;
    tree[10].right= NULL;
    tree[11].left = NULL;
    tree[11].right= NULL;
    tree[12].left = NULL;
    tree[12].right= NULL;
    tree[13].left = NULL;
    tree[13].right= NULL;
    tree[14].left = NULL;
    tree[14].right= NULL;

    std::cout << "Result: " << isBalanced(tree) << std::endl;

    return 0;
} 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2018-12-08T19:16:19.110

回复：@lucky 的解决方案使用 BFS 进行级别顺序遍历。

我们遍历树并保留对 vars min/max-level 的引用，它描述了节点是叶子的最小级别。

我相信@lucky 解决方案需要修改。正如@codaddict 所建议的那样，我们必须检查左或右子节点是否为空（而不是两者），而不是检查节点是否为叶节点。否则，算法会认为这是一个有效的平衡树：

```
 1
    / \
   2   4
    \   \
     3   1 
```

在 Python 中：

```
def is_bal(root):
    if root is None:
        return True

    import queue

    Q = queue.Queue()
    Q.put(root)

    level = 0
    min_level, max_level = sys.maxsize, sys.minsize

    while not Q.empty():
        level_size = Q.qsize()

        for i in range(level_size):
            node = Q.get()

            if not node.left or node.right:
                min_level, max_level = min(min_level, level), max(max_level, level)

            if node.left:
                Q.put(node.left)
            if node.right:
                Q.put(node.right)

        level += 1

        if abs(max_level - min_level) > 1:
            return False

    return True 
```

该解决方案应满足初始问题中提供的所有规定，在 O(n) 时间和 O(n) 空间中运行。内存溢出将被定向到堆而不是破坏递归调用堆栈。

或者，我们可以最初遍历树以迭代地计算 + 缓存每个根子树的最大高度。然后在另一个迭代运行中，检查每个根的左子树和右子树的缓存高度是否相差不超过一。这也将在 O(n) 时间和 O(n) 空间中运行，但要迭代运行，以免导致堆栈溢出。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-04-13T02:07:22.453

好吧，你需要一种方法来确定左右的高度，以及左右是否平衡。

我只想`return height(node->left) == height(node->right);`

关于编写`height`函数，请阅读： [了解递归](https://stackoverflow.com/questions/717725/understanding-recursion/717839#717839)

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-04-13T02:08:29.923

你说的是什么树？那里有[自平衡](http://en.wikipedia.org/wiki/Self-balancing_binary_search_tree)树。检查他们的算法，他们确定是否需要重新排序树以保持平衡。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2010-02-01T20:47:02.093

这是一个基于通用深度优先遍历的版本。应该比其他正确答案更快并处理所有提到的“挑战”。为风格道歉，我真的不知道Java。

如果 max 和 min 都已设置并且差异 >1，您仍然可以通过提前返回来使其更快。

```
public boolean isBalanced( Node root ) {
    int curDepth = 0, maxLeaf = 0, minLeaf = INT_MAX;
    if ( root == null ) return true;
    while ( root != null ) {
        if ( root.left == null || root.right == null ) {
            maxLeaf = max( maxLeaf, curDepth );
            minLeaf = min( minLeaf, curDepth );
        }
        if ( root.left != null ) {
            curDepth += 1;
            root = root.left;
        } else {
            Node last = root;
            while ( root != null
             && ( root.right == null || root.right == last ) ) {
                curDepth -= 1;
                last = root;
                root = root.parent;
            }
            if ( root != null ) {
                curDepth += 1;
                root = root.right;
            }
        }
    }
    return ( maxLeaf - minLeaf <= 1 );
} 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2019-07-25T04:42:22.543

```
class Node {
    int data;
    Node left;
    Node right;

    // assign variable with constructor
    public Node(int data) {
        this.data = data;
    }
}

public class BinaryTree {

    Node root;

    // get max depth
    public static int maxDepth(Node node) {
        if (node == null)
            return 0;

        return 1 + Math.max(maxDepth(node.left), maxDepth(node.right));
    }

    // get min depth
    public static int minDepth(Node node) {
        if (node == null)
            return 0;

        return 1 + Math.min(minDepth(node.left), minDepth(node.right));
    }

    // return max-min<=1 to check if tree balanced
    public boolean isBalanced(Node node) {

        if (Math.abs(maxDepth(node) - minDepth(node)) <= 1)
            return true;

        return false;
    }

    public static void main(String... strings) {
        BinaryTree tree = new BinaryTree();
        tree.root = new Node(1);
        tree.root.left = new Node(2);
        tree.root.right = new Node(3);

        if (tree.isBalanced(tree.root))
            System.out.println("Tree is balanced");
        else
            System.out.println("Tree is not balanced");
    }
} 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2010-04-07T21:10:43.190

Here's what i have tried for Eric's bonus exercise. I try to unwind of my recursive loops and return as soon as I find a subtree to be not balanced.

```
int heightBalanced(node *root){
    int i = 1;
    heightBalancedRecursive(root, &i);
    return i; 
} 

int heightBalancedRecursive(node *root, int *i){

    int lb = 0, rb = 0;

    if(!root || ! *i)  // if node is null or a subtree is not height balanced
           return 0;  

    lb = heightBalancedRecursive(root -> left,i);

    if (!*i)         // subtree is not balanced. Skip traversing the tree anymore
        return 0;

    rb = heightBalancedRecursive(root -> right,i)

    if (abs(lb - rb) > 1)  // not balanced. Make i zero.
        *i = 0;

    return ( lb > rb ? lb +1 : rb + 1); // return the current height of the subtree
} 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2013-08-02T10:07:15.353

一棵空树是高度平衡的。如果满足以下条件，则非空二叉树 T 是平衡的：

1) T的左子树是平衡的

2）T的右子树是平衡的

3）左子树和右子树的高度差不大于1。

```
/* program to check if a tree is height-balanced or not */
#include<stdio.h>
#include<stdlib.h>
#define bool int

/* A binary tree node has data, pointer to left child
   and a pointer to right child */
struct node
{
  int data;
  struct node* left;
  struct node* right;
};

/* The function returns true if root is balanced else false
   The second parameter is to store the height of tree.  
   Initially, we need to pass a pointer to a location with value 
   as 0\. We can also write a wrapper over this function */
bool isBalanced(struct node *root, int* height)
{
  /* lh --> Height of left subtree 
     rh --> Height of right subtree */   
  int lh = 0, rh = 0;  

  /* l will be true if left subtree is balanced 
    and r will be true if right subtree is balanced */
  int l = 0, r = 0;

  if(root == NULL)
  {
    *height = 0;
     return 1;
  }

  /* Get the heights of left and right subtrees in lh and rh 
    And store the returned values in l and r */   
  l = isBalanced(root->left, &lh);
  r = isBalanced(root->right,&rh);

  /* Height of current node is max of heights of left and 
     right subtrees plus 1*/   
  *height = (lh > rh? lh: rh) + 1;

  /* If difference between heights of left and right 
     subtrees is more than 2 then this node is not balanced
     so return 0 */
  if((lh - rh >= 2) || (rh - lh >= 2))
    return 0;

  /* If this node is balanced and left and right subtrees 
    are balanced then return true */
  else return l&&r;
}

/* UTILITY FUNCTIONS TO TEST isBalanced() FUNCTION */

/* Helper function that allocates a new node with the
   given data and NULL left and right pointers. */
struct node* newNode(int data)
{
    struct node* node = (struct node*)
                                malloc(sizeof(struct node));
    node->data = data;
    node->left = NULL;
    node->right = NULL;

    return(node);
}

int main()
{
  int height = 0;

  /* Constructed binary tree is
             1
           /   \
         2      3
       /  \    /
     4     5  6
    /
   7
  */   
  struct node *root = newNode(1);  
  root->left = newNode(2);
  root->right = newNode(3);
  root->left->left = newNode(4);
  root->left->right = newNode(5);
  root->right->left = newNode(6);
  root->left->left->left = newNode(7);

  if(isBalanced(root, &height))
    printf("Tree is balanced");
  else
    printf("Tree is not balanced");    

  getchar();
  return 0;
} 
```

时间复杂度：O(n)

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2013-06-21T18:30:50.303

```
public int height(Node node){
    if(node==null)return 0;
    else{
        int l=height(node.leftChild);
        int r=height(node.rightChild);
       return(l>r?l+1:r+1);

}}
public boolean balanced(Node n){

    int l= height(n.leftChild);
    int r= height(n.rightChild);

    System.out.println(l + " " +r);
    if(Math.abs(l-r)>1)
        return false;
    else 
        return true;
    } 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2013-08-07T00:59:20.883

为了在大树上获得更好的性能，您可以保存每个节点的高度，因此这是空间与性能的权衡：

```
class Node {
    Node left;
    Node right;
    int value;
    int height;
} 
```

实现增删减的例子

```
void addNode(Node root,int v)
{    int height =0;
     while(root != null)
     {
         // Since we are adding new node so the height 
         // will increase by one in each node we will pass by
         root.height += 1;
         height++;
         else if(v > root.value){
            root = root.left();
            }
         else{
         root = root.right();
         }

     }

         height++;
         Node n = new Node(v , height);
         root = n;         
}
int treeMaxHeight(Node root)
{
 return Math.Max(root.left.height,root.right.height);
}

int treeMinHeight(Node root)
{
 return Math.Min(root.left.height,root.right.height);

}

Boolean isNodeBlanced(Node root)
{
   if (treeMaxHeight(root) - treeMinHeight(root) > 2)
       return false;

  return true;
}

Boolean isTreeBlanced (Node root)
{
    if(root == null || isTreeBalanced(root.left) && isTreeBalanced(root.right) && isNodeBlanced(root))
    return true;

  return false;

} 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2021-11-21T02:58:06.703

递归检查每个子树是否平衡。递归意味着，您向子树请求某些内容，子树将返回响应。你一直在问，直到你达到基本情况。在树问题中，基本情况是当您点击叶节点时。

在这种情况下，我们向子树提出 2 个问题：

1-你平衡吗？

2-你的身高是多少？

所以递归函数将返回 2 个答案，我将这些答案保存在数组中。

这是python代码：

```
class Solution:
    def isBalanced(self, root: Optional[TreeNode]) -> bool:
        def dfs(root):
            # leaf node is balanced
            if not root:
                # we carry the height of each subtree
                return [True,0]
            # with recursion, we start from bottom, so we do not have repetitive work
            left,right=dfs(root.left),dfs(root.right)
            # if any of the subtree return false, then we know entire tree is not balanced
            balanced=left[0] and right[0] and abs(left[1]-right[1])<=1
            # 1+max(left[1],right[1]) is the height of the each subtree. 1 is the root of the subtree
            return [balanced,1+max(left[1],right[1])]
        return dfs(root)[0] 
```

这是javascript代码：

```
var isBalanced = function(root) {
 function dfs(root){
     if(!root){
         return [true,0]
     }

     const left=dfs(root.left)
     const right=dfs(root.right)
     const balanced=left[0] && right[0] && Math.abs(left[1]-right[1])<=1
     return [balanced,1+Math.max(left[1],right[1])]
 }
    return dfs(root)[0]
}; 
```

* * *

## 回答 #26

> 赞同：-1
> 
> 时间：2013-02-20T20:09:07.497

```
 static boolean isBalanced(Node root) {
    //check in the depth of left and right subtree
    int diff = depth(root.getLeft()) - depth(root.getRight());
    if (diff < 0) {
        diff = diff * -1;
    }
    if (diff > 1) {
        return false;
    }
    //go to child nodes
    else {
        if (root.getLeft() == null && root.getRight() == null) {
            return true;
        } else if (root.getLeft() == null) {
            if (depth(root.getRight()) > 1) {
                return false;
            } else {
                return true;
            }
        } else if (root.getRight() == null) {
            if (depth(root.getLeft()) > 1) {
                return false;
            } else {
                return true;
            }
        } else if (root.getLeft() != null && root.getRight() != null && isBalanced(root.getLeft()) && isBalanced(root.getRight())) {
            return true;
        } else {
            return false;
        }
    }
} 
```

* * *

## 回答 #27

> 赞同：-2
> 
> 时间：2009-05-28T18:44:38.863

这不行吗？

```
return ( ( Math.abs( size( root.left ) - size( root.right ) ) < 2 ); 
```

任何不平衡的树都会​​失败。

# vba - 如何将 COM 公开的 .NET 项目添加到 VB6（或 VBA）引用对话框？

> ID：742851
> 
> 赞同：11
> 
> 时间：2009-04-13T02:03:17.690
> 
> 标签：vba, deployment, vb6, com-interop, setup-project

根据Phil Wilson撰写的特殊文章[Build and Deploy a .NET COM Assembly](http://www.simple-talk.com/dotnet/visual-studio/build-and-deploy-a-.net-com-assembly/) ，我创建了一个暴露给 COM 的 .NET 程序集。

在 .NET 程序集为 COM 正确注册的意义上，一切正常，并且编译后的 COM 代码可以毫无问题地调用它。

唯一奇怪的是，在使用 VB 6.0 或 VBA 时针对 COM 公开的 .NET 程序集进行开发需要程序员“浏览”到相关 .tlb 文件的确切文件位置，之后一切正常。也就是说，类库不会直接显示在“引用”对话框中，因此您必须浏览到文件位置。

同样，COM 互操作方面确实 100% 有效；但是，我认为必须有一些设置可以使库在 VB 6.0 和 VBA 的“引用”对话框中直接可见。

有谁知道这个设置是什么？或者这是否应该通过注册而自动为我发生？

非常感谢您的任何建议...

麦克风

**编辑/更新**

要回答 jpoh 关于我是否使用 /codebase 开关的问题，我使用的是 .msi 安装包，而不是明确使用 RegAsm。程序集已正确注册，这可以从以下事实看出：在 HKCR\CLSID{myGUID}\InprocServer32 中，“CodeBase”键正确地保存了程序集的完整路径。编译后的 COM 组件对这个 dll 执行得很好，只有在使用 VB 6.0 或 VBA 对其进行开发时，它们才不会出现在引用对话框中。因此，我需要“浏览”到正确的文件位置，之后它可以 100% 正常工作。

**更新#2**

经过进一步研究，似乎虽然类 GUID 已正确注册，但我的 .tlb 文件未注册。我不知道为什么不。注册 .tlb 文件应该在 HKCR\Interface{myInterfaceGUID} 中为我的类所基于的接口放置一些注册表项，但这不会发生。奇怪的是，除了在 VB6 和 VBA 的引用对话框中的可发现性之外，这种缺少注册似乎并没有影响 dll 的功能。

安装项目中我的 .tlb 文件的属性似乎是正确的：“PackageAs”属性设置为“vsdpaDefault”，“Register”属性设置为“vsdrfCOM”。我很困惑为什么这不会成功地安装在目标机器上。

**更新#3**

好的，事实证明安装项目*没有*成功构建......尽管它报告“构建成功”。

实际上有一个构建警告（令人惊讶的是，警告，而不是错误）被报告为“无法为文件名'DotNetLibrary3.tlb'创建注册信息”。由于这是一个警告，而不是错误，因此编译说明“构建成功”并且错误列表*没有*打开。

跟踪这一点，当您在 Vista 是您的开发机器时尝试创建安装项目时，这似乎是一个问题，如下所述：

[VS2008 Setup项目中COM typelib注册问题](http://social.msdn.microsoft.com/forums/en-US/winformssetup/thread/c571f910-0ad6-4a00-8bce-bcc15b5b5337/)

这里描述了一个有点手动的修复：

[反馈：无法为名为“filename”的文件创建注册信息](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=356321&wa=wsignin1.0)

我还没有尝试修复，但我明天会，如果解决了我会报告。

**更新#4**

效果不太好……在 Vista 上运行时，按照该文章中的建议运行 RegCap.exe 似乎不起作用。由于 RegCap 实际上是由安装项目本身在创建 .msi 时在内部运行的，因此这并不奇怪。简而言之，安装项目几乎肯定会失败，因为它正在调用的 RegCap 命令失败了……所以直接调用 RegCap 没有任何帮助。

最重要的是，这只是尝试在 Vista 上创建安装包时的一个错误。或者，也许它是 Visual Studio 2008 和 Vista 的组合，我不确定。尝试相同的方法是在 Windows XP 上运行的 Visual Studio 2005 上创建一个安装项目，绝对没有任何问题。

很可能有一些修复程序可以在 Vista 和/或 Visual Studio 2008 上正常运行，但我无法找到它。对我来说更高效的是在 Windows XP 上使用 Visual Studio 2005 生成 COM 注册要求，然后将它们导入到我的 Visual Studio 2008 安装项目中。这些可以通过 regasm 导出为 .REG 文件，对 dll 使用 /regfile 开关，对 .tlb 文件使用 RegCap（在 W'XP 上运行！）。由于我的 COM 接口不会改变，我只需要这样做一次。

希望在 Vista 上运行时 Visual Studio 2008 中的这个问题将在某个时候得到纠正，但如果没有，希望这篇文章对发现自己处于相同情况的其他人有所帮助......

**也可以看看：**

[如何在自动化服务器列表中安装并注册用 VB.NET 编写的 COM Server for Excel？](https://stackoverflow.com/questions/1506858/how-to-get-com-server-for-excel-written-in-vb-net-installed-and-registered-in-aut/1506932#1506932)

——迈克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T02:16:29.950

您的`regasm`命令是否包含`/codebase`标志？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-09-22T16:14:39.860

我知道这是很久以前的事了，但我找不到任何明智的答案。我遇到了类似的问题，解决方法是以安装它的同一用户身份运行 Visual Studio。如果我以其他用户身份运行它，除了 COM 注册之外的所有内容都可以正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-22T00:13:25.237

如果你在 Vista 下运行 VS2008，它不会给出警告，但**没有提升**。Elevated 是我们（Vista 用户）学习始终使用该东西的方式，但出于某种原因，它更喜欢另一种方式。

注意：虽然提升了，但我为 SQL Server Tools 启动了某种安装，我最终能够通过，但是当运行没有提升时，它会尝试再次执行此操作并因权限问题而失败。不过，它似乎不会影响实际的构建结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-09-23T16:36:52.250

注册表中将缺少 Typelib 注册表项。您需要使用 Microsoft.NET\framework\ 文件夹中的 regtlibv12 [path]MyTypeLib.tlb 来获取您构建程序集所用的 .NET 版本。完成此操作后，其他注册表项将存在，并且 VBA 引用可以找到它。或者，对于 Windows 10，我在 windows 文件夹中使用 regtlib.exe [path]MyTypeLib.tlb 然后您必须重新收集安装程序的组件，以便它现在具有 typelib 条目。我个人使用 wix 安装程序，并为此使用“加热”。Regasm /regfile 不会这样做。在 .dll 和 .tlb 上使用 heat 来获取 classid 和 typelib 注册表项

# iphone - 可以为 EXC_BAD_ACCESS 设置断点吗？

> ID：742857
> 
> 赞同：2
> 
> 时间：2009-04-13T02:08:21.343
> 
> 标签：iphone, xcode, debugging

就像您可以为 设置断点一样`objc_exception_throw`，是否有等价的 `EXC_BAD_ACCESS`？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-04-13T02:15:21.623

EXC_BAD_ACCESS 是一个例外 (EXCeption_BAD_ACCESS)。如果你在 objc_exception_throw 上设置断点，你会得到这些。您可能想查看 NSZombieEnabled，因为您可能正在尝试访问一个 dealloc'd 对象。

# c# - 如何处理 Global.asax 之外的 Session.End 事件

> ID：742867
> 
> 赞同：3
> 
> 时间：2009-04-13T02:13:05.387
> 
> 标签：c#, asp.net

正式的 HttpSession 事件 End 仅在 Global.asax 文件中处理，但我想知道是否有办法，虽然不是正式的（例如反射）以不同的方式处理事件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T13:07:08.903

这不是在 HttpModule 中可以轻松完成的事情，因为 Session_OnEnd 事件可能发生在系统请求范围之外。您最好通过自定义会话状态提供程序来处理此问题，其中您的会话管理代码是触发 Session_OnEnd 事件的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T12:19:12.497

我不是这方面的专家，但我认为你可以使用 HTTPModule，因为它允许访问所有事件 pf hte ASPX 页面，这里是关于创建 HTTP 模块的好文章的链接。

[http://www.15seconds.com/Issue/020417.htm](http://www.15seconds.com/Issue/020417.htm)

希望这可以帮助。

# firefox - AutoCompleteExtender 渲染问题

> ID：742868
> 
> 赞同：2
> 
> 时间：2009-04-13T02:13:46.603
> 
> 标签：firefox, asp.net-ajax, ajaxcontroltoolkit

我在我的应用程序中使用 AutoCompleteExtender 并且不知何故，建议框开始出现在文本框下方而不是下方 20-30 像素处。在挖掘生成的 HTML 之后，我注意到它呈现为 UL 和 LI 元素，而在从 ASP.NET 下载的示例中，它呈现为 DIV 内的 DIV 并且工作正常。

我无法弄清楚是什么使它呈现不同。如何在文本框下方显示建议列表？

顺便说一下，它在 IE 中看起来不错，这个问题只存在于 Firefox 中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T15:09:20.063

你将不得不使用你的 CSS。默认（来自示例）是：

```
visibility : hidden;
margin : 0px !important;
background-color : #f0f0f0;
color : windowtext;
border : buttonshadow;
border-width : 1px;
border-style : solid;
cursor : 'default';
overflow : auto;
height : 200px;
text-align : left; 
list-style-type : none; 
```

例如，我在我的一个网站上添加了：

```
.autocomplete_completionListElement li
{  
    margin : 0px !important;
    padding: 2px;
} 
```

但是你会想使用像[Firebug](http://getfirebug.com/)这样的东西来确定你有什么规则被应用到你不想成为的规则。请记住，CSS =*级联*样式表，因此父元素或规则可以像这样影响库元素。

# asp.net - 如何在用户控件内设置标签的文本

> ID：742869
> 
> 赞同：0
> 
> 时间：2009-04-13T02:14:10.237
> 
> 标签：asp.net, user-controls

我有一个显示类别列表的用户控件。在该用户控件中，我有一个 Label 控件，我想从文件后面的代码中写入该控件。这是我的标签

我试过这段代码：

```
Label lblCount = (Label)this.Page.FindControl("Label1");
lblCount.text = "some text"; 
```

我怎样才能从页面后面的用户控制代码中获得写入标签的权限？我需要什么代码。我不断收到此错误：对象引用未设置为对象的实例。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T03:09:38.497

我通常这样做

```
<asp:Label ID="Label1" runat="server" Text='<%# GetAmount() %>'></asp:Label> 
```

然后在后面的代码中有这样的方法。

```
protected string GetAmount()
{
    return "some text";
} 
```

将为页面中的每一行调用 GetAmount() 方法。如果需要，可以使用 Eval("ColumnName") 从数据源传递参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-19T07:58:41.167

您收到该错误的原因是您试图在页面生命周期中过早地设置该值。在 Page_Load 中，ListView 尚未成为项目，因此您无法访问它们。

对于使用模板、ListViews、Repeaters 等的控件，我使用“OnItemCreated”事件——它会为每个已创建的项目触发，并且您可以访问各种事物。

所以使用以下内容：

```
<asp:ListView ID="lvHomePageLinks" OnItemCreated="ListItems_Created" runat="server"> 
```

然后在您的代码隐藏中：

```
protected void ListItems_Created(object sender, ListViewItemEventArgs e)
{
    ((Label) e.Item.FindControl("Label1")).Text = "some text";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T02:22:47.627

这是我的完整用户控制 ascx 代码：

```
<%@ Control Language="C#" AutoEventWireup="true" CodeFile="homepagelinks.ascx.cs" Inherits="Controls_homepagelinks" EnableViewState="false" %>
 <div class="browseheaderbox">
        <asp:Image ID="Image3" runat="server" ImageUrl="~/App_Themes/TLP/images/icons/search_main.gif"
            AlternateText="Browse Business Categories" Width="34px" Height="31px" Style="float: left;" />
        <h2 class="pad0">
            Browse Business Categories</h2>
    </div>
 <asp:ListView ID="lvHomePageLinks" runat="server">
    <LayoutTemplate>
        <div id="homepagelinks">
            <asp:PlaceHolder ID="itemPlaceholder" runat="server" />
            <div class="clearer">&nbsp;</div>
        </div>
    </LayoutTemplate>
    <ItemTemplate>
        <div class="linkcatsHome">
            <h5>
            <asp:Image ID="Image1" runat="server" ImageUrl="~/App_Themes/TLP/images/icons/icon_alltrades.png" AlternateText='<%# Eval("txtCategory") %>' />
            <%# String.Format("<a href=\"directory/{0}.aspx\">{1}</a>", Eval("txtCategoryURL").ToString(), g.CapitalizeWords(Eval("txtCategory").ToString()))%></h5>
            <asp:Label ID="Label1" runat="server" Text="Label"></asp:Label>

            <%# GetHomePageSubCats(Convert.ToInt32(Eval("intCategoryID")), Convert.ToInt32(g.homepagesubcatamount))%>
        </div>
    </ItemTemplate>
    <EmptyDataTemplate>
        Sorry No Data To Display
    </EmptyDataTemplate>
    </asp:ListView> 
```

这是代码benhid文件：

```
using System;
using System.Collections;
using System.Configuration;
using System.Data;
using System.Linq;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Xml.Linq;
using System.Data.SqlClient;
using System.Text;

public partial class Controls_homepagelinks : System.Web.UI.UserControl
{
    public CategoryBLL CategoryBLL = new CategoryBLL();
    public ListingBLL ListingBLL = new ListingBLL();
    public general g = new general();

    protected void Page_Load(object sender, EventArgs e)
    {
        if (!Page.IsPostBack)
        {
            SqlDataReader reader;
            reader = CategoryBLL.GetRandomCategories_dr();

            Label lbl = (Label)this.Page.FindControl("Label1");
            lbl.Text = "some text";

            lvHomePageLinks.DataSource = reader;
            lvHomePageLinks.DataBind();
            reader.Close();
            reader.Dispose();
        }
    }
} 
```

# python - Python 中的不变性和线程安全

> ID：742882
> 
> 赞同：4
> 
> 时间：2009-04-13T02:25:58.603
> 
> 标签：python, multithreading, immutability

我正在清理我在……不那么知识渊博时编写的一些 Python 代码。主要是因为对 Python 中的线程的不完全理解而产生的一些复杂性。我需要制作一个线程安全的项目列表，并且我想通过不可变列表来完成它，而不是通常的锁定方法。我知道不可变对象在线程方面非常特殊，因为围绕不完整状态更改的所有线程安全问题都会消失。

所以，我问：下面的代码是线程安全的吗？

```
class ImmutableList(object):
    def __init__(self):
        self._list = ()

    def __iter__(self):
        return self._list.__iter__()

    def append(self, x):
        self._list = self._list + tuple([x]) 
```

我认为是，因为每次都会构建一个新列表。如果在另一个线程迭代列表时更新了列表，则旧列表将继续用于剩余的迭代。这对我来说很好，但可能并不适合所有人。

另外，这是个好主意吗？我只想将此应用于列表大小较小且列表没有太大变化的少数情况（事件侦听器会浮现在脑海中）。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-13T02:35:47.597

首先，在 Python 编程语言的 CPython 参考实现中，附加到列表已经是线程安全的。换句话说，虽然语言规范不要求列表类是线程安全的，但无论如何都是这样。因此，除非您使用 Jython 或 IronPython 或其他类似的 Python 实现，否则您没问题。

其次，您还需要重载其他列表操作，例如`__setitem__`and`__setslice__`等。我假设您的实现可以处理这个问题。

最后，您的问题的答案是否定的：您的代码不是线程安全的。考虑以下情况：

*   您的列表包含 (5, 6)
*   线程 1 尝试追加 7，线程 2 尝试追加 8
*   线程 1 构造另一个元组 (5, 6, 7)，在此之前可以分配给 _list，有一个上下文切换
*   线程 2 执行它的分配，所以列表现在是 (5, 6, 8)
*   线程 1 重新获得对 CPU 的控制权并分配给 _list，覆盖之前的追加。列表现在是 (5, 6, 7) 并且 8 已经丢失。

这个故事的寓意是你应该使用锁定并避免聪明。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-13T02:57:27.373

一个真正的不可变列表实现不允许底层列表结构改变，就像你在这里一样。正如@[Eli Courtwright] 所指出的，您的实现不是线程安全的。那是因为它并不是真正不可变的。为了实现不可变的实现，任何会更改列表的方法都将返回一个反映所需更改的新列表。

关于您的代码示例，这将要求您执行以下操作：

```
class ImmutableList(object):
  def __init__(self):
    self._list = ()

  def __iter__(self):
    return self._list.__iter__()

  def append(self, x):
    return self._list + tuple([x]) 
```

# c# - 从目录中选择随机文件

> ID：742887
> 
> 赞同：4
> 
> 时间：2009-04-13T02:30:01.603
> 
> 标签：c#, .net, file, random

有关如何改进此方法的任何建议？我目前正在使用它从壁纸目录中选择单个壁纸

我知道您不应该再使用arraylist，但我想不出替代方法，我也不确定如何在目录信息中过滤不止一种类型的文件（即jpg gif png）。

任何建议或调整都会很棒

```
private string getrandomfile(string path)
        {
            ArrayList al = new ArrayList();
            DirectoryInfo di = new DirectoryInfo(path);
            FileInfo[] rgFiles = di.GetFiles("*.*");
            foreach (FileInfo fi in rgFiles)
            {
                al.Add(fi.FullName);
            }

            Random r = new Random();
            int x = r.Next(0,al.Count);

            return al[x].ToString();

        } 
```

谢谢

碰撞

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-13T02:44:44.953

为什么不使用 LINQ：

```
var files = Directory.GetFiles(path, "*.*").Where(s => Regex.Match(s, @"\.(jpg|gif|png)$").Success);
string randFile = path + files.ToList()[r.Next(0, files.Count())]; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-14T01:33:11.700

与往常一样 - 给猫剥皮的方法不止一种。我已经建立了 tvanfosson （正确）答案，而不是因为这“更”正确；但因为我认为这是一种有用的方法。

```
private static string getRandomFile(string path)
{
    try
    {
        var extensions = new string[] { ".png", ".jpg", ".gif" };

        var di = new DirectoryInfo(path);
        return (di.GetFiles("*.*")
                            .Where(f => extensions.Contains(f.Extension
                                                               .ToLower()))
                            .OrderBy(f => Guid.NewGuid())
                            .First()).FullName ;              
    }
    catch { return ""; }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-13T02:32:23.407

您是否真的需要 ArrayList，您应该能够消除它并在生成随机数后直接使用该数组。

此外，您应该检查路径是否有效......如果由用户指定......

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-13T02:44:08.557

更改为使用伪随机数生成器的单个实例。

```
// Use a class variable so that the RNG is only created once.
private Random generator;
private Random Generator
{
    get
    {
        if (this.generator == null)
        {
           this.generator = new Random();
        }
        return this.generator;
    }
}
private string getrandomfile(string path)
{
    string file = null;
    if (!string.IsNullOrEmpty(path))
    {
        var extensions = new string[] { ".png", ".jpg", ".gif" };
        try
        {
            var di = new DirectoryInfo(path);
            var rgFiles = di.GetFiles("*.*")
                            .Where( f => extensions.Contains( f.Extension
                                                               .ToLower() );
            int fileCount = rgFiles.Count();
            if (fileCount > 0)
            {
                int x = this.Generator.Next( 0, fileCount );
                file = rgFiles.ElementAt(x).FullName;
            }
        }
        // probably should only catch specific exceptions
        // throwable by the above methods.
        catch {}
    }
    return file;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-15T03:31:23.780

我做了一些改变

这是我最终使用的代码，我删掉了一些条件，因为它们并不重要（如果没有文件，它将返回 null 反正不需要测试两次）。我还纠正了一些小的语法错误，一位用户指出应该将返回值向下移动。

同样关于随机类，我不知道为什么继续调用它是不好的，但我不认为这是必要的，因为它只会每 10 到 15 分钟运行一次。即使这样，它也只会在找到文件的情况下创建类。

感谢大家的帮助（**tvanfosson）**

```
private string getrandomfile2(string path)
    {
        string file = null;
        if (!string.IsNullOrEmpty(path))
        {
            var extensions = new string[] { ".png", ".jpg", ".gif" };
            try
            {
                var di = new DirectoryInfo(path);
                var rgFiles = di.GetFiles("*.*").Where( f => extensions.Contains( f.Extension.ToLower()));
                Random R = new Random();
                file = rgFiles.ElementAt(R.Next(0,rgFiles.Count())).FullName;
            }
            // probably should only catch specific exceptions
            // throwable by the above methods.
            catch {}
        }
        return file;
    } 
```

# asp.net - ASP.NET - 你可以在没有 Linq to SQL 的情况下使用动态数据吗？

> ID：742891
> 
> 赞同：0
> 
> 时间：2009-04-13T02:33:01.020
> 
> 标签：asp.net, dynamic-data

我有一个动态创建数据库表的应用程序。我想为这些数据创建一个 CRUD 接口。但是因为表是在应用程序运行时创建的，所以我无法通过将 Linq to SQL 类拖到设计器上来创建它们。但是，我确实在我的代码中知道我要编辑的表是什么。

谁能告诉我是否可以通过以下方式向动态数据提供提要：

1.  SQL查询
2.  或数据集，

而不是 Linq to SQL 范式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T03:12:19.833

据我所知，这是不可能的。来自[MSDN](http://msdn.microsoft.com/en-us/library/cc488545.aspx)：

> *它通过在运行时自动发现 LINQ-to-SQL 或实体框架数据模型来做到这一点*

有一个 MVC 版本即将推出，但会有类似的限制。

可能有一些方法可以为您的情况创建解决方法，因为您在某些时候确实有表格，但我不确定没有更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-05-13T15:44:08.263

好吧，DD 与 Linq to SQL 和实体框架一起工作。对于您的问题，似乎两者都不是很有帮助。

# hosting - 在家里搭建一个小型的代码托管服务器

> ID：742892
> 
> 赞同：2
> 
> 时间：2009-04-13T02:33:14.980
> 
> 标签：hosting

这更像是一个硬件问题而不是软件问题，但仍然......：我想在家里有一台服务器来玩/实验它。用途是托管我自己的存储库（bzr、svn 等），有一个小型网络服务器来托管我的个人编程项目的 wiki/trac 和一个 ftp 来托管文件。

所以我正在考虑购买一台小型 PC，但在我们生活的这个生态关注的时代，我真的很想有一个**小**的功耗！那么关于我应该买什么有什么建议吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-13T02:40:41.140

[这个站点](http://www.mini-box.com/site/index.html)有一些非常低成本和低功耗的计算机，它们是 x86 启动的！这些不会是任何速度恶魔计算机，但如果你只是想将它用于轻型家庭用途，例如存储库和 ftp 服务，你应该没问题。

[这](http://www.mini-box.com/Alix-3D-Board-3-LAN-1-MINI-PCI-1_3?sc=8&category=19)是一台运行功率约为 5 瓦的计算机……您可以运行 12 瓦运行灯泡所需的功率！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T02:55:49.777

使用共享服务而不是专用家庭服务器可能会更好，即使在不工作时也总是打开。共享服务器允许您使用所需的计算能力，而不是将其浪费在备用计算机上。

我推荐[http://itrebal.com/](http://itrebal.com/)来设置你的服务器。

# c# - 快速 WPF 粒子背景

> ID：742894
> 
> 赞同：9
> 
> 时间：2009-04-13T02:34:12.403
> 
> 标签：c#, wpf, algorithm

我正在构建一个 WPF 应用程序，我希望它的背景填充随机的**粒子：**

*   不透明度/z 顺序
*   尺寸
*   速度
*   “*模糊*”（模糊效果）
*   方向（或路径）

我找到[了一个很好的例子](http://www.flashden.net/item/background-animation-blurry-light-cells/21980)，我想要它，但不幸的是它在 Flash 中并且不是免费的......

我试图实现它，但我无法让它**顺利**...

所以我想知道你们中的任何人是否可以帮助我改进它，以使其使用更少的 CPU 和更多的 GPU，因此它更流畅，即使有更多的粒子和全屏模式。

***代码“Particle.cs”***：定义粒子及其所有属性的类

```
public class Particle
{
    public Point3D Position { get; set; }
    public Point3D Velocity { get; set; }
    public double Size { get; set; }

    public Ellipse Ellipse { get; set; }

    public BlurEffect Blur { get; set; }
    public Brush Brush { get; set; }
} 
```

***XAML "Window1.xaml"***：窗口的 xaml 代码，由径向背景和承载粒子的画布组成

```
<Window x:Class="Particles.Window1"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
Title="Window1" Height="600" Width="800" Loaded="Window_Loaded">
    <Grid>
        <Grid.Background>
            <RadialGradientBrush Center="0.54326,0.45465" RadiusX="0.602049" RadiusY="1.02049" GradientOrigin="0.4326,0.45465">
                <GradientStop Color="#57ffe6" Offset="0"/>
                <GradientStop Color="#008ee7" Offset="0.718518495559692"/>
                <GradientStop Color="#2c0072" Offset="1"/>
            </RadialGradientBrush>
        </Grid.Background>
        <Canvas x:Name="ParticleHost" />
    </Grid>
</Window> 
```

***代码“Window1.xaml.cs”***：一切发生的地方

```
public partial class Window1 : Window
{
    // ... some var/init code...

    private void Window_Loaded(object sender, RoutedEventArgs e)
    {
        timer.Interval = TimeSpan.FromMilliseconds(10);
        timer.Tick += new EventHandler(timer_Tick);
        timer.Start();
    }

    void timer_Tick(object sender, EventArgs e)
    {
        UpdateParticules();
    }

    double elapsed = 0.1;
    private void UpdateParticules()
    {
        // clear dead particles list
        deadList.Clear();
        // update existing particles
        foreach (Particle p in this.particles)
        {
            // kill a particle when its too high or on the sides
            if (p.Position.Y < -p.Size || p.Position.X < -p.Size || p.Position.X > Width + p.Size)
            {
                deadList.Add(p);
            }
            else
            {
                // update position
                p.Position.X += p.Velocity.X * elapsed;
                p.Position.Y += p.Velocity.Y * elapsed;
                p.Position.Z += p.Velocity.Z * elapsed;
                TranslateTransform t = (p.Ellipse.RenderTransform as TranslateTransform);
                t.X = p.Position.X;
                t.Y = p.Position.Y;

                // update brush/blur
                p.Ellipse.Fill = p.Brush;
                p.Ellipse.Effect = p.Blur;
            }
        }

        // create new particles (up to 10 or 25)
        for (int i = 0; i < 10 && this.particles.Count < 25; i++)
        {
            // attempt to recycle ellipses if they are in the deadlist
            if (deadList.Count - 1 >= i)
            {
                SpawnParticle(deadList[i].Ellipse);
                deadList[i].Ellipse = null;
            }
            else
            {
                SpawnParticle(null);
            }
        }

        // Remove dead particles
        foreach (Particle p in deadList)
        {
            if (p.Ellipse != null) ParticleHost.Children.Remove(p.Ellipse);
            this.particles.Remove(p);
        }
    }

    private void SpawnParticle(Ellipse e)
    {
        // Randomization
        double x = RandomWithVariance(Width / 2, Width / 2);
        double y = Height;
        double z = 10 * (random.NextDouble() * 100);
        double speed = RandomWithVariance(20, 15);
        double size = RandomWithVariance(75, 50);

        Particle p = new Particle();
        p.Position = new Point3D(x, y, z);
        p.Size = size;

        // Blur
        var blur = new BlurEffect();
        blur.RenderingBias = RenderingBias.Performance;
        blur.Radius = RandomWithVariance(10, 15);
        p.Blur = blur;

        // Brush (for opacity)
        var brush = (Brush)Brushes.White.Clone();
        brush.Opacity = RandomWithVariance(0.5, 0.5);
        p.Brush = brush;

        TranslateTransform t;

        if (e != null) // re-use
        {
            e.Fill = null;
            e.Width = e.Height = size;
            p.Ellipse = e;

            t = e.RenderTransform as TranslateTransform;
        }
        else
        {
            p.Ellipse = new Ellipse();
            p.Ellipse.Width = p.Ellipse.Height = size;
            this.ParticleHost.Children.Add(p.Ellipse);

            t = new TranslateTransform();
            p.Ellipse.RenderTransform = t;
            p.Ellipse.RenderTransformOrigin = new Point(0.5, 0.5);
        }

        t.X = p.Position.X;
        t.Y = p.Position.Y;

        // Speed
        double velocityMultiplier = (random.NextDouble() + 0.25) * speed;
        double vX = (1.0 - (random.NextDouble() * 2.0)) * velocityMultiplier;
        // Only going from the bottom of the screen to the top (for now)
        double vY = -Math.Abs((1.0 - (random.NextDouble() * 2.0)) * velocityMultiplier);

        p.Velocity = new Point3D(vX, vY, 0);
        this.particles.Add(p);
    }

    private double RandomWithVariance(double midvalue, double variance)
    {
        double min = Math.Max(midvalue - (variance / 2), 0);
        double max = midvalue + (variance / 2);
        double value = min + ((max - min) * random.NextDouble());
        return value;
    }
} 
```

非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-14T06:45:35.520

我认为问题不在于性能。该应用程序并没有接近我的 CPU，但帧速率仍然不流畅。

我会看两件事。你如何计算你的位置更新，以及你触发事件的频率。

```
timer.Interval = TimeSpan.FromMilliseconds(10); 
```

那是每秒 100 帧。改为选择 30fps（显示器上每隔一次刷新一次）或 60 等。您应该尝试与显示器同步进行更新，就像视频游戏一样。

```
timer.Interval = TimeSpan.FromMilliseconds(33.33); // 30 fps 
```

仅此一项可能无法解决平滑度问题。您也不应该假设事件之间的时间是固定的：

```
double elapsed = 0.1; 
```

当您触发计时器以每 0.01 秒执行一次更新时，这并不意味着它实际上是在一致的时间内完成的。垃圾收集，操作系统调度，任何会影响它实际花费的时间的东西。测量自上次更新实际完成以来经过的时间，并根据该数字进行计算。

祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-14T13:23:09.077

谢谢大家回答我。

我已经考虑了你的每一个答案：

*   [Lucas Aardvark](https://stackoverflow.com/users/56555/lucas-aardvark) >> 我已经这样做了，它提高了一点应用程序的速度并使用了更少的 CPU/内存。
*   [Rob Walker](https://stackoverflow.com/users/3631/rob-walker) >> 我点击了链接，但当我看到：“*由于零优化和大量数组副本****，模拟器是相当 CPU 密集型***的”。
**   [kvb](https://stackoverflow.com/users/82959/kvb) >> 我曾尝试使用动画，但它更复杂，并没有提高应用程序的***流畅度***......也许我做错了！我还删除了 Point3D 的使用，因为实际上不需要使用它们*   [Jogn Noonan](https://stackoverflow.com/users/6054/john-noonan) >> 真正有指导意义的答案，但我不确定这会有所帮助。如果我测量 2 次更新之间的时间，那么时间越长，比率就越大。所以粒子会像“传送”一样，对吧？*

 *我已经更新[了我的源代码](http://88.191.92.151/dl/Particles/Particles-v2.zip)：

**Particle**类现在只有以下属性：

```
public class Particle
{
    public Point Velocity { get; set; } // Speed of move

    public BlurEffect Blur { get; set; } // Blur effect
    public Brush Brush { get; set; } // Brush (opacity)
} 
```

Window1.xaml**没有**改变，但我改变了他的背后代码：

```
public partial class Window1 : Window
{
    DispatcherTimer timer = new DispatcherTimer();
    Random random = new Random(DateTime.Now.Millisecond);

    // Some general values
    double MaxSize = 150;
    double NumberOfParticles = 25;
    double VerticalVelocity = 0.4;
    double HorizontalVelocity = -2.2;

    private void Window_Loaded(object sender, RoutedEventArgs e)
    {
        for (int i = 0; i < NumberOfParticles; i++)
        {
            CreateParticle();
        }

        timer.Interval = TimeSpan.FromMilliseconds(33.33);
        timer.Tick += new EventHandler(timer_Tick);
        timer.Start();
    }

    void timer_Tick(object sender, EventArgs e)
    {
        // I control "particle" from their ellipse representation
        foreach (Ellipse ellipse in ParticleHost.Children)
        {
            var p = ellipse.Tag as Particle;
            var t = ellipse.RenderTransform as TranslateTransform;

            // Update location
            t.X += p.Velocity.X;
            t.Y -= p.Velocity.Y;

            // Check if the particle is too high
            if (t.Y < -MaxSize)
            {
                t.Y = Height + MaxSize;
            }

            // Check if the particle has gone outside
            if (t.X < -MaxSize || t.X > Width + MaxSize)
            {
                t.X = random.NextDouble() * Width;
                t.Y = Height + MaxSize;
            }

            // Brush & Effect
            ellipse.Fill = p.Brush;
            // Comment this line to deactivate the Blur Effect
            ellipse.Effect = p.Blur;
        }
    }

    private void CreateParticle()
    {
        // Brush (White)
        var brush = Brushes.White.Clone();
        // Opacity (0.2 <= 1)
        brush.Opacity = 0.2 + random.NextDouble() * 0.8;
        // Blur effect
        var blur = new BlurEffect();
        blur.RenderingBias = RenderingBias.Performance;
        // Radius (1 <= 40)
        blur.Radius = 1 + random.NextDouble() * 39;
        // Ellipse
        var ellipse = new Ellipse();
        // Size (from 15% to 95% of MaxSize)
        ellipse.Width = ellipse.Height = MaxSize * 0.15 + random.NextDouble() * MaxSize * 0.8;
        // Starting location of the ellipse (anywhere in the screen)
        ellipse.RenderTransform = new TranslateTransform(random.NextDouble() * Width, random.NextDouble() * Height);
        ellipse.Tag = new Particle
        {
            Blur = blur,
            Brush = brush,
            Velocity = new Point
            {
                X = HorizontalVelocity + random.NextDouble() * 4,
                Y = VerticalVelocity + random.NextDouble() * 2
            }
        };
        // Add the ellipse to the Canvas
        ParticleHost.Children.Add(ellipse);
    }
} 
```

如果你[尝试这个新版本](http://88.191.92.151/dl/Particles/Particles-v2.zip)，你会发现它仍然不**流畅**。

但是，如果您评论影响模糊效果的线条，您会看到它非常顺利！

有什么想法吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-15T01:08:56.790

Erich Mirabal >> 我确实尝试过 HLSL，学习新东西很有趣，但由于我是一个完全新手，我没有设法做一个 Box/Gaussian blur ...

无论如何，我找到了一种完全不使用 CPU 的方法。

我没有移动 Ellipse，而是移动了他们的 Image。

**我使用RenderTargetBitmap**和**PngBitmapEncoder**类生成内存中的 PNG，并移动这些*已经模糊和透明的*图像！

非常感谢大家的回答！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-13T04:30:52.857

如果我是你，我会考虑使用 WPF 的内置动画系统，而不是像你正在做的那样使用回调手动更新位置。例如，可能值得研究命名空间中的`Point3DAnimation`类`System.Windows.Media.Animation`等。在单独的说明中，使用 3D 点看起来实际上并没有给你买任何东西（据我所知，你在实际渲染椭圆时忽略了 Z 值），所以你可能想改为简单地使用`Point`s

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-19T16:03:38.647

MSDN WPF 有一个很好的粒子效果演示。此外，O'Reilly 的《Learning XNA》一书介绍了如何使用 XNA 使用粒子效果。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-17T18:45:53.517

我通过删除 ellipse.Effect 行解决了您的问题，而是将以下内容添加到 Window1.xaml

```
 <Canvas x:Name="ParticleHost">
        <Canvas.Effect>
            <BlurEffect />
        </Canvas.Effect>
    </Canvas> 
```

当然，它们的外观不同，每个都有自己的模糊半径。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-13T03:00:00.783

我正在阅读某人试图做同样事情的博客，但我似乎找不到它（我会继续寻找它）。他能够加快应用程序的方法是重用粒子。您会看到每次创建新粒子时都会占用内存。除非你有一个疯狂的好系统，否则你买不起这种内存，因为 .NET 使用大量内存。

**解决方案：**重用粒子，一旦粒子不再出现在屏幕上，要么释放它的内存（可能因为 GC 而无法工作），或者将粒子重新定位在底部并重用它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-13T03:03:18.560

不确定这是否会更好，但有人已经组合了[Silverlight C64 模拟器](http://silverlightc64.codeplex.com/)，他们使用的技术基本上是显示带有提供帧的自定义源（您的代码）的电影。

优点是您在显示帧时获得回调，因此可以适应实际播放速率。我不确定这对更高分辨率的效果如何，C64 示例只有一个低分辨率屏幕可以模拟。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-14T13:29:01.230

您是否考虑过使用 HLSL 进行 ShaderEffect 以在 GPU 上进行渲染？你可以写一个[PixelShader](http://msdn.microsoft.com/en-us/library/system.windows.media.effects.shadereffect.aspx)。这是其中一个[公告](http://blogs.msdn.com/jaimer/archive/2008/10/03/announcement-wpf-shader-effects-library-on-codeplex.aspx)中的一些其他示例，它也有一些不错的链接。它在渲染中绝对应该是平滑的。

# c++ - C/C++ 注册表帮助

> ID：742897
> 
> 赞同：0
> 
> 时间：2009-04-13T02:35:00.983
> 
> 标签：c++, c, resources

我正在编写一个 mp3 应用程序，我有它，所以它在启动时就开始了。但是，在 msconfig 中查看它时，它说制造商未知。我怎样才能让它说“daxsoft”？

没有 .rc 文件有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T02:58:18.773

您需要在项目中包含的 .rc 文件中添加一个版本部分（如果您还没有 .rc 文件，请添加一个 .rc 文件）。

在 .rc 文件中，您需要一个 RT_VERSION 块，它可以让您指定文件版本、公司等。

此信息由资源编译器 (rc.exe) 处理并包含在最终的 exe 中。如果您将 .rc 文件添加到项目中，Visual Studio 将自动为您处理此问题。

有关该过程的旧但仍然准确的概述，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/cc194804.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T02:48:56.097

我认为它来自您的 .exe 文件，您需要签署：

[http://blogs.msdn.com/secureapps/archive/2007/01/25/code-signing.aspx](http://blogs.msdn.com/secureapps/archive/2007/01/25/code-signing.aspx)

# .net - 为 .config 文件中的自定义部分启用 Intellisense

> ID：742905
> 
> 赞同：39
> 
> 时间：2009-04-13T02:41:40.250
> 
> 标签：.net, configuration, web-config, intellisense, app-config

在 Visual Studio 中编辑 .NET 配置文件（app.config、web.config 等）时，我得到 Visual Studio 的智能感知来指导我选择应用程序的设置。如果我添加自定义配置部分，如何为我的自定义设置启用智能感知？我相信这个问题一定有一个简单的答案，但粗略的谷歌搜索并没有给我任何帮助。

谢谢！

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2011-01-09T12:21:25.853

正如其他答案所说，您需要为自定义配置部分提供 XML Schema 文档。无需将`.xsd`架构文件添加到某个全局目录；您可以直接从`App.config`文件中的自定义部分引用它：

```
<configuration>

  <!-- make the custom section known to .NET's configuration manager -->
  <configSections>
    <section name="customSection" type="..." />
  </configSections>

  <!-- your custom section -->
  <customSection xmlns="http://tempuri.org/customSection.xsd"
                 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                 xsi:noNamespaceSchemaLocation="customSection.xsd">
    ...
  </customSection>

<configuration> 
```

该`xmlns`属性仅用于设置默认命名空间，因此您无需在`customSection`元素及其所有子元素上设置它。（但是，不要将`xmlns`属性放在`<configuration>`元素上！）

`customSection.xsd`包含 IntelliSense 将使用的架构，例如：

```
<xs:schema id="customSectionSchema"
           targetNamespace="http://tempuri.org/customSection.xsd"
           elementFormDefault="qualified"
           xmlns="http://tempuri.org/customSection.xsd"
           xmlns:mstns="http://tempuri.org/customSection.xsd"
           xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="customSection">
    ...
  </xs:element>
</xs:schema> 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2010-01-11T19:39:47.690

如果您不想修改 Visual Studio 文件或将任何内容复制到 Visual Studio 文件夹中，可以将`.xsd`文件添加到项目中，打开文件并在“*属性*`.config`”窗口中选择“*架构*” （单击图标）：*`[…]`*

 *![Visual Studio 的屏幕截图，显示在何处查找和更改](https://i.stack.imgur.com/3cJs0.png)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-04-13T02:45:50.053

您需要为您的自定义设置创建一个 XSD 文件并将其复制到您的 Visual Studio 安装的架构目录中。对于 2005，这是：%ProgramFiles%\Microsoft Visual Studio 8\XML\Schemas

这里有一些关于此的信息。 [http://blogs.msdn.com/astebner/archive/2005/12/07/501466.aspx](http://blogs.msdn.com/astebner/archive/2005/12/07/501466.aspx)

# html - 背景图片定位问题

> ID：742910
> 
> 赞同：1
> 
> 时间：2009-04-13T02:45:09.740
> 
> 标签：html, css

我有这个作为我的 CSS 样式。`#pg_wrap`调整浏览器窗口大小时，我没有以背景图像为中心。我的屏幕截图是当您将浏览器窗口缩小到小于`#pg_wrap`宽度的 1344 像素时（宽度不必是那样，只是一个测试数字）。

屏幕截图是使用 Firefox 拍摄的。Chrome 不这样做。如何让背景图像保持不变？

[铬合金](http://img9.imageshack.us/my.php?image=sschrome.png&via=yfrog)

[火狐](http://img9.imageshack.us/my.php?image=94209626.png&via=yfrog)

```
body
{
    text-align: center;
    background-image: url('p_bg_75.jpg');
    background-repeat: repeat-y;
    background-color: black;
    background-attachment:fixed
    margin: 0px;
    padding: 0px;

}
#pg_wrap
{
    margin-left: auto;
    margin-right: auto;
    width: 1344px;
    height: 1000px;
    border: 1px solid white;
    text-align: center;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-13T03:27:03.183

不同之处在于浏览器以不同的方式处理不正确的 css。

改变

```
background-attachment:fixed 
```

到

```
background-attachment:fixed; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-13T08:37:17.040

你忘记声明背景位置了吗？请记住 text-align 不会对齐背景。作为一个单一的声明，你似乎在追求：

```
background: #000000 url('p_bg_75.jpg') repeat-y fixed top center; 
```

我无法通过您的问题判断您是否真的希望附件被“固定”，但根据您的屏幕截图，我对此表示怀疑。所以你也可以从声明中删除它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T15:53:24.723

如上所述，尝试：

```
background-position: center; 
```

并粘贴一段 HTML，以便我们可以在 Safari/Chrome 中进行测试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-20T17:08:57.303

通常对于中心对齐的站点，您最好使用 2 个背景图像。1 个背景图像放置在 BODY 上，另一个背景放置在中心对齐的 DIV 上。

如果正文没有像您的示例中那样的边距，并且您将浏览器设置为小于 1344px，您将不会再看到正文背景。为了确保在内容很短的情况下不会出现奇怪的效果，您可以将 DIV 的最小高度也设置为 100%。

也许看看这个网站也使用了这种技术：http: [//www.prgs.nl/](http://www.prgs.nl/)

# c# - C# MSVS 中的资源

> ID：742915
> 
> 赞同：2
> 
> 时间：2009-04-13T02:51:26.107
> 
> 标签：c#, resources

我按照此处的说明[如何在 .NET 中创建和使用资源](https://stackoverflow.com/questions/90697/how-to-create-and-use-resources-in-c-net-vs-2008/90699#90699)

但是，当我做 Properties.Resources.Name; 我得到“当前上下文中不存在名称‘属性’”。它让我发疯，因为我尝试了多种方法并用谷歌搜索，但找不到解决方案。

该资源在我正在使用的同一个项目中。该项目是 1 种形式。并且代码在 Form1_Load

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-13T03:00:48.410

确保没有命名空间问题。Resources 类的完全限定名称是`YourProject.Properties.Resources`，因此如果某些原因导致 Form 被放置在与 Properties 类不同的命名空间中，则需要使用完全限定名称从表单中访问它。使用对象浏览器浏览您的解决方案并找出您的 Properties 类的命名空间是什么。

# mysql - 您如何从表中获取下一个即将到来的日期？

> ID：742928
> 
> 赞同：3
> 
> 时间：2009-04-13T02:59:17.430
> 
> 标签：mysql

我目前正在建立一个棒球网站。在页面的一侧，我想显示下一场即将到来的比赛的信息。我正在使用 mysql 版本。5.0.45。我的桌子是这样建造的：

对方球队、日期、时间、分数

*   日期为 mysql 日期格式 (yyyy-mm-dd)
*   我找到了 datediff(date1,date2) 命令并尝试对此进行试验，但没有成功

我尝试过以下查询：

```
SELECT *
FROM schedule
WHERE MIN(DATEDIFF(CURDATE(),date)) 
```

*   但这给了我一个错误，因为我使用了`MIN()`错误的功能
*   我对mysql还是很陌生，我似乎无法弄清楚

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-13T03:03:43.363

如果要显示下一场比赛（包括今天），可以使用以下内容：

```
SELECT * FROM `schedule` WHERE `date` >= CURDATE() ORDER BY `date` LIMIT 1; 
```

如果要显示所有即将到来的游戏，请使用：

```
SELECT * FROM `schedule` WHERE `date` >= CURDATE() ORDER BY `date`; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T03:02:11.667

我认为它会是这样的：

```
SELECT * FROM `schedule` WHERE `date` > NOW() ORDER BY `date` LIMIT 1 
```

将`LIMIT 1`查询限制为返回一行，但如果您需要多行，您可以相应地调整数字（或`LIMIT 1`完全省略，以获取所有未来游戏的数据）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T03:03:03.957

也许：

```
select top 1 * from schedule where date>=CURDATE() order by date 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-13T03:10:03.877

有几件事需要考虑。

如果您将列命名为“日期”，您很可能会让自己遭受永恒的折磨。

众所周知，查询优化器无法优化将表达式和/或函数与值进行比较的查询 - 尝试仅使用列名。

因此，您应该将日期列的值与 CURDATE() 进行比较。（可以将列值与表达式或函数进行比较。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-02-11T10:06:16.557

尝试`SELECT max(day) FROM schedule`

这给出了表格中的最高日期。

要获得第二天，请使用：

```
SELECT  
DATE_ADD(max(day),INTERVAL 1 DAY)
FROM schedule 
```

（我用“day”作为你的字段“date”）

# xcode - 使用 Xcode 时保持电池寿命 - 您的设置/建议？

> ID：742931
> 
> 赞同：4
> 
> 时间：2009-04-13T03:00:12.700
> 
> 标签：xcode, macos, battery

我经常发现自己想在国际航班上打开 Xcode 并进行一些编码，而我没有电源，但这是清空 MacBook Pro 电池的快速方法。

在运行 Xcode 时，您使用哪些设置来延长电池寿命？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-13T04:27:45.890

使用电池运行时，预测编译会自动禁用自身。

如果你有双核机器，

```
defaults write com.apple.Xcode XCMaxNumberOfDistributedTasks 1 
```

一次编译一个文件（而不是在双核 CPU 的每个内核上编译一个文件），这可能会节省一些费用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-13T03:12:36.040

我的猜测是 XCode 的预测性编译（在您键入时编译以缩短稍后的构建时间）将是一个很大的吸引力，以及索引。您可以分别在“Building”和“Code Sense”下的“Preferences”中将它们都关闭。

但是，一些轻量级测试似乎表明，如果您使用电池，它不会进行预测编译。所以，也许这不是问题。如果您可以忍受它的关闭，索引仍然可能会有所帮助。

它也可能有助于在编译时做尽可能少的工作 - 也许检查以确保您正在使用预编译的头文件和您正在导入的所有大型框架。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-13T04:35:57.463

我发现在我的 Mac 上节省电池的最佳方法是使用通用访问来反转所有颜色。一切看起来都是负面的，但如果你能忍受的话，你的屏幕大部分都是黑色的，我相当相信它会有所作为。

除此之外，检查您是否可以关闭其中一个内核，我经常在我的 mac pro 上这样做。

注意：我很清楚在 LCD 中，白色和黑色像素之间的功率差异很小。但是，根据我自己有限的经验，在黑色背景下工作时，我可以降低对比度和亮度，而不是在白色背景下工作，这*确实*可以节省电量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-13T03:54:10.387

如何将编辑窗口更改为在深色背景上显示浅色文本。

在字体和颜色下的首选项中有预定义的设置。

# asp.net - window.location 之后的 JQuery 模态弹出窗口

> ID：742939
> 
> 赞同：0
> 
> 时间：2009-04-13T03:04:00.023
> 
> 标签：asp.net, javascript, jquery, ajax, dhtml

以下是此问题所需的信息。

默认.aspx /test/default.aspx

当 default.aspx 加载时，用户单击一个按钮，然后该按钮应重定向到 /test/default.aspx。我的模式弹出窗口不能与重定向和想法一起使用？

我尝试过`window.location = "/test/default.aspx";`使用自定义`settimeout`方法来调用该函数，但它不起作用。如果我延长延迟时间，新页面一加载它就会消失或在新页面加载时闪烁。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-02T10:58:39.100

```
window.location.href="www.google.com"; 
```

# java - 键盘轮询系统

> ID：742944
> 
> 赞同：3
> 
> 时间：2009-04-13T03:08:05.443
> 
> 标签：java, swing, keyboard-events, game-loop

我正在为 Java 游戏寻找一种高效的键盘输入系统。目前我正在使用我在这里找到的一些代码：

[键盘输入轮询系统](http://gpsnippets.blogspot.com/2008/03/keyboard-input-polling-system-in-java.html)

然而，这似乎有点低效（请评论您对代码的想法）。完整代码可在此处获得：

[粘贴代码](http://pbin.oogly.co.uk/listings/viewlistingdetail/86f38d3f64f6064a591c1037021580)

我才刚刚开始研究新的解决方案并将代码分开，但是有人对在主游戏循环中执行此操作的有效方法有任何建议（包括解释）吗？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-13T03:56:17.947

设置一个 KeyEventListener；调用时，将当前键放入一键缓冲区。

在计算线程中，或者在轮询线程中，周期性地查询当前的key buffer。现在，您不再需要不断地查看 I/O，而是让事件侦听器来做这件事（它已经经过高度优化并干净地实现以使用底层硬件），同时您继续进行定期轮询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-31T19:10:03.263

我认为这是很棒的代码。链接的作者已经实现了从键盘进行拉式数据传输，而不是通常的 KeyListener 推送方法。此实现支持[N-key rollover](http://en.wikipedia.org/wiki/Rollover_%28key%29#n-key_rollover)，但是，USB 的限制是同时 6-8 个键。

如果你想稍微清理一下，那么只存储你想要注意的键。但是，这不会为您节省太多，每次按下键时只会将一个 int 写入数组。

您到底发现什么效率低下？对于初学者，我在链接代码中看不到任何循环。

# c# - 在 .net 中“通过网络”触发事件

> ID：742948
> 
> 赞同：3
> 
> 时间：2009-04-13T03:11:04.470
> 
> 标签：c#, .net, networking, remoting

我需要一种方法来“通过网络”触发远程进程上的事件并传递参数（xml 序列化等）。我希望能够做这样的事情。

```
foreach(childClient c in clientList)
{
    MyEvent += c.EventHandler;
}

MyEvent("param"); 
```

什么技术对此有好处？WCF？

这是一个内部软件项目的小型部署，因此设计开销最小是一个优势，不必“快速”并且不会处理大量流量。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-13T03:16:24.410

有很多方法可以做到这一点，但 WCF 是 .NET 代码的最佳匹配。如果您是内部人员，那么希望防火墙等不是太大的问题，您可以使用全双工的 NET.TCP 绑定。你想阅读[回调合约](http://idunno.org/archive/2008/05/29/wcf-callbacks-a-beginners-guide.aspx)。

有很多例子，比如[这个](http://dotnetaddict.dotnetdevelopersjournal.com/wcf_alarmclock.htm)。

# asp.net - 关于从 ASP.NET MVC 应用程序播放声音文件的建议

> ID：742949
> 
> 赞同：2
> 
> 时间：2009-04-13T03:11:07.777
> 
> 标签：asp.net, jquery, asp.net-mvc, ajax, audio

我正在开发一个新的 ASP.NET MVC / JQuery 应用程序，它需要播放简短的声音文件以响应用户操作。例如，在某些情况下，当用户点击一个词时，计算机应该发音该词（有一个小的有限词列表）。

我想就以下问题提出建议：

1.  您会推荐哪种声音文件格式？
2.  关于播放声音的浏览器特性，我需要了解什么？
3.  您认为处理声音文件最节省带宽的方法是什么？例如，如果一个页面上有 5 个可点击的单词，你会将所有 5 个声音文件与页面一起发送到浏览器，还是不发送任何文件并在用户点击时使用 ajax 检索声音文件？

当然，我还需要知道什么？:)

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T03:25:28.833

您可以将音频嵌入 mp3 或将它们包装在 flash 中（就像您在 HTML 中那样）。如果您想添加一些爵士乐，请为您的单词创建一个带有播放、暂停、停止按钮的自定义控件。

这个链接应该可以帮助你 --> [http://www.beansoftware.com/ASP.NET-Tutorials/Media-Player.aspx](http://www.beansoftware.com/ASP.NET-Tutorials/Media-Player.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-13T18:41:40.567

我正在使用[SoundManager2](http://www.schillmania.com/projects/soundmanager2)。它具有预加载和按需加载。有一个带有您需要的功能的[演示](http://www.schillmania.com/projects/soundmanager2/demo/play-mp3-links/)- 点击播放。唯一的问题是确保 js 可以找到 swf 播放器，路径可能不是您需要的。

# php - 我的 PHP 数组有什么问题？

> ID：742955
> 
> 赞同：1
> 
> 时间：2009-04-13T03:21:44.413
> 
> 标签：php, arrays, foreach

```
 $genreList;

    function directorGen($array)
    {
        foreach($array as $value)
        {
          $genreList[] = $value;    
        }
    }

   //later..

   directorGen($title->genres()); 
```

此代码生成一个 NULL 数组。如果我将 $genreList[] = $value 替换为 echo $value ，一切都会按预期打印出来。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T03:27:26.597

如果`$genreList`是一个全局变量，那就是你的问题：这是一个范围问题。它可以通过以下方式轻松修复：

```
$genreList = array();

function directorGen($array) {
    global $genreList;
    foreach($array as $value) {
        $genreList[] = $value;        
    }
} 
```

**注意：**虽然不是绝对必要的，但我也对其进行了初始化，我认为这是一种很好的做法。

如果`directorGen()`是成员函数并且`$genreList`是数据成员，则更改为：

```
function directorGen($array) {
    foreach($array as $value) {
        $this->genreList[] = $value;        
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T03:24:26.277

在哪里`$genreList`定义？它可能只是一个函数局部变量，在这种情况下，它会在函数退出时丢失。如果它是类级别的变量，请记住`$this->genreList`改用。

**编辑**

我的错。如果它是一个全局变量，您需要将它添加到函数的顶部，以便 PHP 找到它：

```
global $genreList; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-13T03:25:50.487

这是一个范围问题。directorGen() 中的 $genreList 仅存在于 directorGen() 中，它并不是隐含的全局变量，因为它在函数之外被提及。尝试`global $genreList`在函数顶部使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-13T03:27:21.340

以下任何一项都可以解决您的问题；

```
$genreList[] .= $value; // Appends each value to the array. 

array_push($genreList, $value); 
```

同样是我的错误，您应该通过以下语句从函数返回genreList：

```
return $genreList; 
```

使用 global 关键字通常被认为是一种代码异味，因为它会在跟踪全局变量的使用以及它的值发生变化时产生许多问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-13T11:46:05.650

```
function directorGen($array)
{
    $genreList = array();

    foreach($array as $value)
    {
        $genreList[] = $value;        
    }

    return $genreList;
} 
```

//之后..

导演根($title->genres());

您将始终收到数组。甚至是空的。而且你不需要用 is_array() 函数检查它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-13T16:35:08.250

这可能是你想要做的：

```
class Test {
    //public, protected, private ...
    var $genreList = array();

    function directorGen(array $array) {
        //remove string keys
        $values = array_values($array);
        $this->genreList = array_merge($this->genreList, $values);
    }
} 
```

注意：将重置计数器。如果您取消设置一个值，然后添加新值，键将被重置，最低为 0，最大值为 count - 1。

# java - Java Swing - JList 自定义单元格渲染 - 捕获动作

> ID：742958
> 
> 赞同：6
> 
> 时间：2009-04-13T03:25:44.247
> 
> 标签：java, swing, jlist, cellrenderer

每当我为 JList 制作自定义单元格渲染器时，我添加到其中的任何元素都不会响应操作。例如，如果我让单元格渲染器返回一个带有元素的 JPanel，其中一个元素有一个 ActionListener，它根本不会响应。

为什么是这样？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-14T08:02:44.180

渲染器可能看起来像为单元格返回组件的工厂，但实际上它遵循**享元渲染**方法并使用*相同*的组件来渲染所有单元格（每次调用`getListCellRendererComponent()`都应该为特定单元格重新配置相同的组件实例，并且返回它以便可以渲染单元格）。

这样，您可以`JList`（以及`JTable`和`JTree`）显示大量单元格，而无需为每个单元格实例化组件。作为副作用，渲染组件无法响应事件，因为它仅在渲染循环期间使用，但不会出现在组件树中。

正如 Neil Coffey 所说，您可以将侦听器添加到`JList`( `JTable`, `JTree`) 中，并使用辅助方法 ( `locationToIndex(...)`, `getCellBounds(...)`) 来调度受影响的单元格，从而处理单元格特定的逻辑。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-13T04:42:23.703

您作为列表单元格渲染器返回的项目正是为此而设计的：**渲染**。使用 JList 注册侦听器（通常，您需要一个 ListSelectionListener）。

# jquery - jquery 属性选择器无法选择的属性

> ID：742964
> 
> 赞同：1
> 
> 时间：2009-04-13T03:27:59.013
> 
> 标签：jquery, css-selectors, css

我正在自动生成选择器，但我遇到了问题。一些属性选择器不起作用。例如，在[此页面上](http://dogself.com/telluriumTest/index2.htm)，以下选择器无法按预期工作：

```
$("img[src=/p/aost/logo?logo_id=1238551994]"); 
```

我还注意到我无法使用 action 属性的值来选择 <form>。

**问题：**在 jquery 选择器中是否有属性的完整列表。

**不是问题：**我不是在问如何使用 jquery 函数选择具有这些属性的元素。

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-13T04:06:17.957

```
$("img[src='/p/aost/logo?logo_id=1238551994']"); 
```

当您有非字母数字字符时引用字符串，我认为您在操作 url 中有同样的问题。

# iphone - 在tableView上面加个UIView的问题

> ID：742966
> 
> 赞同：1
> 
> 时间：2009-04-13T03:29:23.490
> 
> 标签：iphone, uitableview

我在我的应用程序中向 UITableView 添加了一个子视图，添加后，tableViewCell 仍然可以点击，如何防止这种情况？请帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T04:45:29.827

如果我这次理解了你的问题，如果你可以让子视图变成屏幕的大小，那么你只需要在子视图上将 userInteractionEnabled 设置为 TRUE 即可。

用一个简单的 UITableView 和一个 UIImageView 对其进行了测试。如果我禁用 userInteractionEnabled 则调用 tableView 委托的 willSelectRowAtIndexPath ，如果我将其设置为 TRUE 则没有任何反应。

# gdi+ - 关于 gdi+ 位图的一个奇怪问题！

> ID：742970
> 
> 赞同：1
> 
> 时间：2009-04-13T03:32:58.910
> 
> 标签：gdi+, bitmap

我正在使用以下代码获取位图点，

（宽度 = 800，高度 = 600）；

```
Bitmap* m_BitmapCanvasCore = new Bitmap(width, height, PixelFormat32bppARGB); 
```

但 m_BitmapCanvasCore 始终为 NULL ... gdi+ 有什么问题吗？或者我需要避免的任何命名空间污染？为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T04:13:02.463

你在创建位图之前调用了[GdiplusStartup吗？](http://msdn.microsoft.com/en-us/library/ms534077(VS.85).aspx)

# testing-strategies - 测试无限输入域的最佳实践，如解析器或基于规则的系统？

> ID：742971
> 
> 赞同：2
> 
> 时间：2009-04-13T03:34:27.937
> 
> 标签：testing-strategies

测试文本转语音引擎是一项相当艰巨的任务。引擎本身解析输入并根据单个单词的语音分析应用发音规则。此外，存在发音规则的例外列表以改善最终结果。诸如[古腾堡计划之类的项目](http://www.gutenberg.org/browse/scores/top)可以让您从字面上扔*书*在问题上；但是，问题仍然存在，由于问题的范围，我永远不会感到舒服。我追求六个九的解决方案（99.9999% 防撞）。向引擎投掷随机文本清楚地表明我只有三个九，随后的修复似乎没有帮助。我知道在这种情况下该怎么做（重新访问引擎中的错误处理机制以使其优雅降级）。一般问题仍然存在。在任何无限输入域中，您如何证明软件质量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T15:50:11.460

测试覆盖率。确保您正在访问所有分支和所有循环，执行所有代码并确保它正常工作或正常失败。根据它的重要性，尝试实现 100% [MCDC Coverage](http://en.wikipedia.org/wiki/Modified_Condition/Decision_Coverage)（修改后的条件/决策覆盖率）；对于每个条件，确定影响结果的所有输入排列，并确保测试每个排列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T05:51:44.053

你如何测试你的引擎？我会尝试使用语音识别引擎（如微软的内置引擎）来检查质量。在证明的数量上，我会使用所有单词的文本字典+来自不同作者的一些书籍的文本。

# python - Django RSS 提要错误的域

> ID：742974
> 
> 赞同：3
> 
> 时间：2009-04-13T03:36:50.413
> 
> 标签：python, django, rss

我有一个 RSS 提要，我正在使用 Django 在我的新站点上设置。目前，我为每个用户提供一个 RSS 提要，而不仅仅是一个大型的、令人讨厌的全球 RSS 提要。唯一的问题是 RSS 提要返回的链接在链接中的域名完全错误。结束路径是完全正确的，get_absolute_url 方法似乎适用于我的应用程序中的所有其他内容，只是不在这里。你会认为我会得到默认的“www.example.com/item/item_id”，但我得到了另一个托管在此服务器上的域。起初我以为它只是在提取服务器的主机名，但事实并非如此。它也没有提取 SITE_ID 设置的内容。Django 文档说提要会从 SITE_ID 设置中提取域，但事实并非如此。一世'

我确定我错过了一些简单的东西，但对于我的生活，我无法推断出来。它用来构建 URL 的域根本不存在于应用程序的代码或数据库中的任何地方。那么它到底是在哪里提出域的呢？

更新：

Apache 中的 ServerName 设置为我看到的 RSS 源用于构建 URL 的域。我改变了它，并重新启动了 Apached，错误的域仍在使用中。关于如何强制 Django 使用正确的域的任何其他想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-13T15:08:41.217

可能是来自环境变量？尝试：

```
export | grep your.mistery.domain 
```

看看是否有任何问题，以运行 Django 应用程序的同一用户身份执行此操作。

您知道您始终可以实现您的 item_link() 方法，该方法将返回您想要的 URL，请参阅[此处的文档](http://docs.djangoproject.com/en/dev/ref/contrib/syndication/?from=olddocs#feed-classes)

# javascript - 为什么在 onBeforeDeactivate 事件处理程序中调用 focus() 时 DIV 会发生变化？

> ID：742975
> 
> 赞同：2
> 
> 时间：2009-04-13T03:37:08.617
> 
> 标签：javascript, html, internet-explorer, focus, right-to-left

我在 IE7/8 中遇到了一个网页的有线问题。页面配置为**dir="rtl"**。并且**divRow的****宽度**非常大，因此它包含的 div 不会换行。

单击编辑器区域，键入一些单词，然后单击“Hello world”文本。布局会变得凌乱，因为**divRow**类的偏移量和宽度发生了变化。

我想这是一个 IE7/8 错误。有没有办法解决这个问题？

基本上，***divRow***必须使其包含的 div 不换行。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" 
  "http://www.w3.org/TR/html4/strict.dtd">
<html>
  <head>
  <style>
    div 
    {
      border: 1px;
      border-color: black;
    }

    .divRow
    {
      /* this is to make its containing div not to wrap */
      min-width: 2000px; 
    }

    div.divEditor
    {
      width: 100%;
    }

    iframe
    {
      height: 100%;
      width: 100%;
    }
  </style>
  <script>
    function $(id)
    {
      return document.getElementById(id);
    }

    function focusToRight()
    {
      var elem = $("innerDiv1");

      function fcs()
      {
        elem.focus();
      }
      setTimeout(fcs, 1);

    }
  </script>
  </head>
  <body dir="rtl">
    <div>
    <div id='main' 
      style="overflow: hidden; position: relative; width=100%">
      <div class="divRow" id="firstRow">
        <div style='float:right' id='innerDiv1'>
          Hello world.
        </div>
        <div style='float:right' id='innerDiv2'>
          This is to make it is very very very very very very very very  
          very very very very very very very very long
        </div>
      </div>
      <div class="divEditor">
        <iframe id="editorIFrame" onbeforedeactivate="focusToRight();" 
          src="about:blank"></iframe>
      </div>
    </div>

    </div>
    <script>
      //document.getElementById('main').style.width='40px';
      //$("editorIFrame").document.designMode = "on";
      document.frames["editorIFrame"].document.designMode = "On";
    </script>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-13T10:53:00.223

完全摆脱 min-width:2000px 条件。

阻止包含 div 包装或折叠的方法是在其末尾插入一个 style="clear:right" 的空 div。这个新的 div 仍然在包含的 div 内，但它必须清除，即低于浮动，所以它拉伸了 div 的垂直高度。

# programming-languages - 擅长编程语言意味着什么？

> ID：742977
> 
> 赞同：7
> 
> 时间：2009-04-13T03:38:59.317
> 
> 标签：programming-languages

“懂一门语言”的真正含义是什么？

我相信这不仅仅是知道语法。

是吗

*   了解所有/大部分可用的库
*   了解语言的特性是如何实现的

你是如何学习你精通的语言的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-13T03:43:37.230

“了解”一门编程语言与“了解”一门人类语言非常相似——当你不必不停地翻书或停下来记住正确的单词时，你就可以流利了。

我认为“了解一门语言”意味着能够阅读和理解大多数程序（约 90%），而无需在参考资源中查找任何内容，并且确切地知道在哪里可以找到框架中更晦涩部分的技术细节。对于本身没有“框架”的语言/平台，它拥有社区普遍接受的主要库的知识。

对于用那种语言写作，这意味着花费大约 90% 以上的时间来设计你所写的东西——包括对设计的研究——而不到 10% 的时间来查找技术参考信息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-13T03:45:20.283

真正“懂”一种语言来形容自己是“好”的意思

*   您了解该语言的**所有功能**，包括两者
    *   独特/**好的功能以及何时使用它们**，以及
    *   尘土飞扬的**角落和要避免什么**
*   你知道**常见的约定**
*   （正如你提到的）你知道**平台的库**
*   您了解整个**工具链**（IDE、构建项目、调试器、分析器），因此您可以精通该语言

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-13T07:56:15.563

给定语言 X 中的一行代码，该行被编写一次并且可能被读取多次（当然也可能被修改）。因此，语言的熟练程度在很大程度上是阅读理解。对于用 X 编写的程序语料库，你能多快阅读这些程序并理解它们在做什么？

*是吗*

*   *了解所有/大部分可用的库*？我不这么认为，因为在您学习它时会创建任意数量的常用库。即使是当今许多语言的**基础**库也有数千个不同的概念（类）和数万个函数。
*   *知道语言的特性是如何实现的*吗？这是语言的给定实现的属性，而不是语言本身的属性。但我认为它确实有贡献。知道正则表达式通常被实现为状态机（并了解这方面的理论）与理解正则表达式语言非常相关。尽管了解 Java 字节码的工作原理与我从事过的 Java 应用程序没有任何关系... [1] 我猜某些语言与其可能的实现比其他语言有更清晰的分离：这可能是高级和高级之间的关键区别低级语言。

如果你脑子里有一种特定的语言，一个好的测试就是看看它里面的严肃例子。对于 C 语言，阅读（例如）Linux 内核、GNU OS 实用程序、PostgreSQL 或 Subversion，并**弄清楚它们是如何工作**的，不仅是一种指示，而且也是一种很好的实践。

[1] 有一项关于字节码静态分析的作业；但实际的解决方案可以写成任何东西。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-13T03:52:02.403

我认为这真的取决于“好”的定义，或者“好”的目的。

例如，让我们考虑 Java。

大多数工作不会满足于您精通核心语言，他们希望您精通特定的 API（例如，用于 GUI 的 Swing）甚至第三方 API（如所有 Apache 的东西）。您不一定必须知道每个极端情况。

学术和工业研究可能需要您真正了解该语言的里里外外。例如，如果您编写静态分析工具或编译器优化，最好了解边缘情况。

在教育和质量保证中，了解所有奇怪的角落及其风险通常很重要。这在 C++ 中很典型。在教育中，因为你可以指望学生不小心犯这些错误。在 QA 中，因为这是一些奇怪的错误所在的地方（例如，静态初始化中的竞争条件）。

至于功能是如何实现的，我认为你可以成为一名出色的程序员，而无需知道某些东西是如何实现的（例如，C++ 中 VTBL 的细节），但重要的是要知道其他东西是如何实现的（例如，垃圾收集、内存管理，一些库）来编写非常好的和高效的代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-13T07:26:14.027

在我看来，这意味着你可以用那种语言思考。当您阅读问题陈述时，能够看到部分代码出现在您的脑海中，这很好地表明了您对一门语言的熟练程度。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-13T07:16:57.747

给定一个**算法**，如果你能**实现一个解决**方案

*   **更快**（比许多其他程序）
*   **高效**（比许多其他程序使用更少的资源）
*   **更小**（使用较小的内存占用）
*   **优雅**（易于理解和维护）

我觉得你更懂语言...

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-02-08T15:33:04.067

您可能想考虑一下不真正了解一种语言意味着什么。例如，我经常遇到一些人认为他们知道 OCaml，因为他们知道标准 ML（同一家族的另一种语言），而事实上，他们并不知道语言之间的差异或它们的实际含义。所以我想说，了解一种语言的一部分就是知道它与其他语言的区别。

C vs C++ 是另一个例子。许多人曾经声称他们知道 C++，然后会用 C++ 编写 C 代码。

# c# - WPF：画布 Z 索引错误

> ID：742983
> 
> 赞同：2
> 
> 时间：2009-04-13T03:42:28.417
> 
> 标签：c#, wpf, canvas, z-index

所以我在 WPF 中制作了自己的轮播控件。我偶然发现了一个错误，想知道是否有人知道我可以如何解决这个问题，比如方法调用或一系列方法调用或一些变通方法。这是我的轮播的打印屏幕：

[轮播图片 http://img4.imageshack.us/img4/9599/carousele.jpg](http://img4.imageshack.us/img4/9599/carousele.jpg)

正如你可以清楚地看到这张图片，我的鼠标指针在按钮上，上面写着 16。但是上面写着 18 的按钮是蓝色的，就好像我的鼠标在那个按钮上一样。我还将工具提示设置为绑定到内容，并且工具提示说我的鼠标悬停在带有 18 个按钮的按钮上。这应该是正确的行为，因为 18 是按钮的 z-index 值。因此，上面有 18 的按钮应该在上面有 16 的按钮的顶部。然而，WPF 并没有以这种方式渲染画布，我想知道如何克服这个问题。我尝试了 canvas.InvalidateArranage()、canvas.invalidateVisual()、canvas.UpdateLayout() 但我没有运气。画布的左侧显示了它应该是什么样子，但即使 z-index 值正确，右侧也无法产生相同的结果，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-11-09T22:39:10.220

在 wpf 中，从技术上讲，您的鼠标超过 18 岁。事件（可能）被触发的方式如下：

我超过“16”，调用鼠标悬停 16 我超过“18”，调用鼠标悬停 18

因为 18 是最近调用的，所以它被选中（再次，只是我的猜测）。

在 mousemove 事件的事件参数中（我假设 mousemove），确保设置 e.Handled = true，这样它只处理一次**************