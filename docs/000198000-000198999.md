# StackOverflow 问答 000198000-000198999

# c# - 在 IIS 6 上使用 WCF 主机时超时

> ID：198004
> 
> 赞同：0
> 
> 时间：2008-10-13T15:32:56.430
> 
> 标签：c#, wcf, iis

我在 IIS 6 上托管 WCF 服务时遇到问题。

我想我的主机很好，我可以从一个普通的应用程序连接到它，然后完成我的工作。但现在我想对服务进行压力测试，我想从 Web 客户端进行，通过单击按钮调用 wcf 服务的普通 aspx 页面，并且能够向上和向下扩展它。

我的问题是从服务连接/检索数据时出现超时。我认为这可能与身份验证有关，但我不确定...

我在服务器和普通客户端上使用 WShttpbindings ......我在我的 Web 测试项目中直接将 WCF 服务作为服务引用调用！

提前致谢，

基督教

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-14T15:59:44.083

我以前也遇到过类似的问题，我必须确保我完成后立即关闭工厂。您也可以增加允许连接到该服务的数量，但您应该确保在完成它的那一刻关闭工厂。

与往常一样，请查看**Nicholas Allen 的博客**以了解 WCF 的所有内容：http: [//blogs.msdn.com/drnick/archive/2007/12/28/controlling-http-connection-limits.aspx](http://blogs.msdn.com/drnick/archive/2007/12/28/controlling-http-connection-limits.aspx)

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-13T15:59:06.580

[尝试使用SvcTraceViewer](http://msdn.microsoft.com/en-us/library/ms732023.aspx)跟踪服务并读取生成的日志

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T16:49:03.577

我写了几篇文章来解释为什么会在[IDisposable](http://www.iserviceoriented.com/blog/post/Indisposable+-+WCF+Gotcha+1.aspx)和 [Throttling](http://www.iserviceoriented.com/blog/post/Configuring+Performance+Options+-+WCF+Gotcha+3.aspx)方面发生这种情况。

# java - 需要一个分布式键值查找系统

> ID：198006
> 
> 赞同：16
> 
> 时间：2008-10-13T15:33:20.003
> 
> 标签：java, database, bigtable, key-value-store, distributed-database

我需要一种方法来对（可能）数百 GB 的数据进行键值查找。理想情况下，基于分布式哈希表的东西可以很好地与 Java 配合使用。它应该是容错的，并且是开源的。

存储应该是持久的，但理想情况下会将数据缓存在内存中以加快速度。

它应该能够支持来自多台机器的并发读取和写入（尽管读取将是常见的 100 倍）。基本上，目的是对 Web 服务的用户元数据进行快速初始查找。

任何人都可以推荐任何东西吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-29T17:10:45.563

你可能想看看[Hazelcast](http://www.hazelcast.com)。它是分布式/分区的，超级精简，简单且免费。

```
java.util.Map map = Hazelcast.getMap ("mymap");
map.put ("key1", "value1"); 
```

问候，

-塔利普

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-13T15:40:02.780

[Open Chord](http://open-chord.sourceforge.net/)是[CHORD](http://en.wikipedia.org/wiki/Chord_(DHT))协议的 Java 实现。它是一个分布式哈希表协议，应该可以完美地满足您的需求。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-15T01:11:52.580

根据用例，[Terracotta](http://terracotta.org)可能正是您所需要的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-13T15:37:05.377

您可能应该指定它是否需要持久化，是否需要在内存中等等。您可以尝试：[http ://www.danga.com/memcached/](http://www.danga.com/memcached/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-13T15:51:02.197

分布式哈希表包括 Tapestry、Chord 和 Pastry。其中之一应该适合您的需求。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-13T15:55:59.533

OpenChord 听起来很有希望。但我也会考虑[BDB](http://www.oracle.com/technology/products/berkeley-db/index.html)或任何其他非 SQL 哈希表，使其分布式可能非常容易（如果存储节点的数量（至少）是（几乎）恒定的），只需对客户端上的密钥进行哈希处理即可合适的服务器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-14T02:30:01.813

[Java 中的开源缓存解决方案](http://java-source.net/open-source/cache-solutions)

[Oracle Coherence](http://www.oracle.com/technology/products/coherence/index.html)（以前是 Tangosol）

[JCache JSR](http://jcp.org/en/jsr/detail?id=107)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-23T08:32:27.087

[nmdb](http://blitiri.com.ar/p/nmdb/)听起来正是您所需要的。分布式，在内存缓存中，具有持久的磁盘存储。当前的后端包括 qdbm、berkeley db 和（最近在给开发人员的快速电子邮件后添加）[tokyo cabinet](http://tokyocabinet.sourceforge.net/index.html)。虽然键/值大小是有限的，但我相信如果您不需要 TICP 支持，可以取消它。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-01-12T10:32:35.127

[尝试Redisson](https://redisson.org)的分布式 Map 结构，它基于[Redis](http://redis.io/)服务器。使用 Redis 集群配置，您可以将数据拆分到 1000 台服务器上。

使用示例：

```
Redisson redisson = Redisson.create();

ConcurrentMap<String, SomeObject> map = redisson.getMap("anyMap");
map.put("123", new SomeObject());
map.putIfAbsent("323", new SomeObject());
map.remove("123");

...

redisson.shutdown(); 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-10-13T15:37:27.170

DNS 有能力做到这一点，我不知道您的每条记录有多大（8GB 吨小数据？），但它可能会起作用。

# php - PHP 函数 imagettftext() 和 unicode

> ID：198007
> 
> 赞同：12
> 
> 时间：2008-10-13T15:33:38.923
> 
> 标签：php, unicode, gd

我正在使用 PHP 函数 imagettftext() 将文本转换为 GIF 图像。我正在转换的文本包含 Unicode 字符，包括日语。在我的本地机器（Ubuntu 7.10）上一切正常，但在我的虚拟主机服务器上，日语字符被破坏了。什么可能导致差异？一切都应该编码为 UTF-8。

虚拟主机服务器上的损坏图像：http: [//www.ibeni.net/flashcards/imagetest.php](http://www.ibeni.net/flashcards/imagetest.php)

从我的本地机器复制正确的图像：http: [//www.ibeni.net/flashcards/imagetest.php.gif](http://www.ibeni.net/flashcards/imagetest.php.gif)

从我的本地机器复制 phpinfo()：http: [//www.ibeni.net/flashcards/phpinfo.php.html](http://www.ibeni.net/flashcards/phpinfo.php.html)

从我的虚拟主机服务器复制 phpinfo()： [http ://example5.nfshost.com/phpinfo](http://example5.nfshost.com/phpinfo)

代码：

```
mb_language('uni');
mb_internal_encoding('UTF-8');

header('Content-type: image/gif');

$text = '日本語';
$font = './Cyberbit.ttf';

// Create the image
$im = imagecreatetruecolor(160, 160);
$white = imagecolorallocate($im, 255, 255, 255);
$black = imagecolorallocate($im, 0, 0, 0);

// Create some colors
imagefilledrectangle($im, 0, 0, 159, 159, $white);

// Add the text
imagettftext($im, 12, 0, 20, 20, $black, $font, $text);
imagegif($im);
imagedestroy($im); 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-14T16:02:47.710

这是最终对我有用的解决方案：

```
$text = "你好";
// Convert UTF-8 string to HTML entities
$text = mb_convert_encoding($text, 'HTML-ENTITIES',"UTF-8");
// Convert HTML entities into ISO-8859-1
$text = html_entity_decode($text,ENT_NOQUOTES, "ISO-8859-1");
// Convert characters > 127 into their hexidecimal equivalents
$out = "";
for($i = 0; $i < strlen($text); $i++) {
    $letter = $text[$i];
    $num = ord($letter);
    if($num>127) {
      $out .= "&#$num;";
    } else {
      $out .=  $letter;
    }
} 
```

除了函数 imagettftext() 不接受命名实体之外，将字符串转换为 HTML 实体是可行的。例如，

```
&#26085;&#26412;&#35486; 
```

可以，但是

```
&ccedil; 
```

不是。转换回 ISO-8859-1，将命名实体转换回字符，但还有第二个问题。imagettftext() 不支持值大于 >127 的字符。最后的 for 循环将这些字符编码为十六进制。这个解决方案适用于我正在使用的文本（包括日语、中文和葡萄牙语的重音拉丁字符），但我不能 100% 确定它是否适用于所有情况。

所有这些体操都是必需的，因为 imagettftext() 在我的服务器上并不真正接受 UTF-8 字符串。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-12-24T02:23:40.370

我在使用将在图像中呈现文本并输出它的脚本时遇到了同样的问题。`$_GET`问题是，由于不同的浏览器（或代码顽固/偏执，无论你想怎么想），我无法知道数组中放入了什么编码。

这是我解决问题的方法。

```
$item_text = $_GET['text'];

# detect if the string was passed in as unicode
$text_encoding = mb_detect_encoding($item_text, 'UTF-8, ISO-8859-1');
# make sure it's in unicode
if ($text_encoding != 'UTF-8') {
    $item_text = mb_convert_encoding($item_text, 'UTF-8', $text_encoding);
}

# html numerically-escape everything (&#[dec];)
$item_text = mb_encode_numericentity($item_text,
    array (0x0, 0xffff, 0, 0xffff), 'UTF-8'); 
```

这解决了`imagettftext`无法处理 #127 以上字符的任何问题，只需将所有字符（包括多字节 Unicode 字符）更改为它们的 HTML 数字字符实体——“A” 对于“A”、“B” 对于“B”等——[手册页](http://www.php.net/imagettftext)声称支持。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-10-13T08:54:56.627

我有同样的问题。将字体从 otf 转换为 ttf 有帮助。您可以使用 FontForge（标准存储库中提供）进行转换。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T15:48:50.953

我的主要嫌疑人是您用于渲染的字体。

根据[http://fr3.php.net/imagettftext](http://fr3.php.net/imagettftext)，php 使用的不同版本的 GD 库可以显示不同的行为。

*   本地机器上的 GD 版本：2.0 或更高版本
*   您的虚拟主机服务器上的 GD 版本：捆绑（与 2.0.34 兼容）

*编辑：* 另一个想法：你能验证它`$text = '日本語';`真的像这样保存在你的生产服务器上吗？您的脚本可能存在编码问题。

*下一次编辑：* BKB 已经提出了这一点。因此，如果这是原因：他首先得到了答案；-)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-13T17:10:59.710

您的生产机器上是否存在该特定字体文件？如果使用 FTP 上传文件，您是否使用二进制编码？

# eclipse - 任何类似于 Emacs 对 Eclipse 的缓冲区/窗口支持的东西？

> ID：198016
> 
> 赞同：8
> 
> 时间：2008-10-13T15:37:02.663
> 
> 标签：eclipse, emacs

我正在尝试从 Emacs 切换到 Eclipse。似乎缺少的一件事是它的缓冲区/窗口支持。

我知道在 Eclipse 中，我可以将编辑器的选项卡标题拖到上面来拆分视图，创建一个新的 Emacs 窗口的等价物，这是朝着正确方向迈出的一步。

不过，我找不到此功能的任何键绑定。理想情况下，我希望能够将键设置为水平拆分，垂直拆分，切换到下一个（有下一个编辑器，但我想要下一个窗口/无论你怎么称呼它），切换到上一个，关闭这个窗口拆分（不是这个编辑器），关闭所有其他编辑器窗口拆分。

事实上，我发现关闭拆分窗格的唯一方法是将所有文件一个接一个地拖动，直到一个都没有。这样的事情使得在 Eclipse 中使用分屏变得乏味。

任何帮助将不胜感激，希望我缺少一些简单的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T15:05:14.000

Emacs+ 对 Eclipse 有这种确切的行为：http: [//www.mulgasoft.com/emacsplus](http://www.mulgasoft.com/emacsplus)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T15:19:45.503

根据[键首选项](http://help.eclipse.org/ganymede/index.jsp?topic=/org.eclipse.platform.doc.user/concepts/accessibility/keyboardshortcuts.htm)，有一个打开新编辑器的未绑定命令，它将打开另一个选项卡而不是拆分视图。还有一个未绑定的命令可以关闭所有其他编辑器。 `Ctrl`+`W`将关闭当前编辑器，`Ctrl`+`F6`将在选项卡之间切换。您可以绑定或重新绑定它们以更接近它们的 Emacs 等效项。或者，有一个 Emacs 键映射，您可能会发现它更有帮助。不幸的是，我无法从键盘上拆分视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T16:03:43.170

尝试`Ctrl`-`Tab`和`Ctrl`-循环浏览选项卡（缓冲区）和-`Shift`关闭选项卡。您还可以查看 eclipse 配置中的快捷方式绑定。`Tab``Ctrl``F4`

# jsp - 帮助 JSP 中字符串国际化的工具

> ID：198023
> 
> 赞同：3
> 
> 时间：2008-10-13T15:38:46.403
> 
> 标签：jsp, internationalization, jstl

是否有任何工具可以帮助 JSP 文件中的字符串国际化？

大多数 IDE（例如[NetBeans](http://www.netbeans.org)）都为 Java 代码提供了这样的功能。但是，对于 NetBeans，JSP 文件不存在这样的功能。

例如，使用[gettext](http://www.gnu.org/software/gettext/)，有各种工具可以帮助从代码中提取文本字符串。JSP 类似的东西会很棒！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-30T07:03:41.803

如果我碰到一个老问题，我希望没人介意...

当面临同样的问题时，我将 (a) 一种在 JSP 中以 Gettext 样式本地化字符串的方法（在源 JSP 中保持英语）和 (b) 一个 Ant 任务放在一起，该任务可以在 JSP 中找到此类字符串并生成一个 Gettext锅文件。

(a) 由 WebGettext 提供，它为诸如`${messages["Hello {0}"][username]}`. 解析器为请求用户的语言环境查找翻译，并使用 MessageFormat 替换任何参数。

(b) 由 Regex2PotTask 提供，它有点像 xgettext，但用于可配置的正则表达式而不是 C、Java、Perl 等函数调用，例如 gettext("my string")。

[Tennera 的主页](https://fedorahosted.org/tennera/)在这里。

[示例 JSP 项目](https://fedorahosted.org/tennera/browser/trunk/webgettext-example)- 请参阅 RUNNING.txt

目前这一切都有些粗糙，但我认为基础知识都在那里。如果有人表达了兴趣，我什至可能会被激励“正确”记录它......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-10-07T10:24:40.797

我找到了一个试图解决问题的 Eclipse 插件：http: [//bravo.heliohost.org/](http://bravo.heliohost.org/)

但是我自己无法尝试，因为我的配置不受支持。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-14T12:14:49.933

我发现这是[解决](http://www.eclipsezone.com/eclipse/forums/t84478.rhtml)此问题的一种解决方法。它远非理想，但允许您使用 IDE 搜索所有字符串。解释解决方案：

1.  JSP 编译为 servlet，因此为文件系统上的每个 JSP 找到相应的 servlet 类。对于 Tomcat，这将是“工作”目录。
2.  将关联的 servlet .java 文件导入 IDE，然后使用 IDE 的常规国际化工具：*Externalize strings...* (Eclipse) / *Internationalization Wizard* (NetBeans)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-26T09:15:50.977

这是一个非常强大的产品/解决您的问题：[Globalyzer](http://www.lingoport.com/software-internationalization-products/globalyzer)

我自己没有使用过它，但我为我以前雇主的一个项目做了一些研究。我们需要从大量 Java 代码和 JSP 中提取所有字符串。我们发现 Globalyzer 满足了我们所有的需求。

最后我们决定不选择 Globalyzer，但这纯粹是成本问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-04-26T18:33:32.717

通常，您使用该`xgettext`命令从源代码中提取可翻译的字符串。它支持各种语言，Java 也是如此，但没有对 JSP 的原生支持。虽然我发现设置语言参数以`PHP`正确解析 JSP 文件，因为 PHP 和 JSP 具有相似的语法。

# jquery - 在 iframe 中获取单选值

> ID：198024
> 
> 赞同：3
> 
> 时间：2008-10-13T15:38:47.667
> 
> 标签：jquery, jquery-plugins

我该如何用 jQuery 来做这件事？

基本结构：

```
<form id="myForm">
  <iframe>
    <!-- Normal HTML headers omitted -->
    <input type=radio name="myRadio" value=1>First
    <input type=radio name="myRadio" value=2>Second
    <input type=radio name="myRadio" value=3>Third
  </iframe>
  <input type=button value="Submit" />
</form> 
```

我尝试了网上的各种例子，例如

```
$("input[@type=radio][@checked]"); 
```

但是失败了。即使使用 jQuery 表单插件的[.fieldValue()](http://malsup.com/jquery/form/#fields)失败。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-13T16:00:34.317

尝试`$('#myForm iframe').contents().find('input[name=myradio]').val()`

我假设 iframe 内容已经加载并且可以访问，例如同一个域。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-13T16:39:34.843

除非 jQuery 做了一些我不知道的魔法，否则访问另一个框架的 DOM 需要一些技巧。这可能有效：

```
var frameDocument = $('#myForm iframe').contentDocument || $('#myForm iframe').contentWindow.document;
$(frameDocument).find('input[type=radio][checked]'); 
```

并且，请注意 jQuery 文档中的这一点：

> 请注意，从版本 1.2 开始，不推荐使用属性名称之前的“@”。

# c# - 在 Windows XP 下通过远程桌面渲染 WPF 是否存在问题？

> ID：198030
> 
> 赞同：8
> 
> 时间：2008-10-13T15:40:34.760
> 
> 标签：c#, .net, wpf, windows-xp, remote-desktop

我听说 Windows XP 上的远程桌面不支持 WPF 原语。这意味着如果您在 vista 机器上运行 WPF 应用程序并将其显示在 XP 机器上（通过远程桌面），则显示将作为压缩位图发送。

此问题已在通过 DirectX 11 (?) 的 Vista-Vista 通信中得到解决，但在 XP 上不可用。这里显然会影响性能，我想在着手开发 WPF 应用程序之前了解它。

可以在此处找到有关此主题的一些信息：

[http://blogs.msdn.com/tims/archive/2007/01/05/comparing-wpf-on-windows-vista-v-windows-xp.aspx](http://blogs.msdn.com/tims/archive/2007/01/05/comparing-wpf-on-windows-vista-v-windows-xp.aspx)

请参阅上述链接中的评论（引用）：

* * *

对于 SpongeJim 的问题，这是由 MIL（媒体集成层）完成的，它是处理合成的 WPF 的底层核心。在 Vista/Vista 远程桌面连接上，MIL 原语被远程化，然后重新构成。在其他组合（例如 2003/XP）上，被远程处理的是位图，这显然更加占用带宽。有关此主题的更多深入信息，请参见 Greg Schechter 的博客，尤其是在此条目中：http: [//blogs.msdn.com/greg_schechter/archive/2006/06/09/623566.aspx](http://blogs.msdn.com/greg_schechter/archive/2006/06/09/623566.aspx)

* * *

有没有人对此问题有任何经验或更多最新信息？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-13T16:48:02.190

As of .NET 3.5 SP1, all WPF graphics are remoted as bitmaps, even on Vista-to-Vista communication. From [http://blogs.msdn.com/jgoldb/archive/2008/05/15/what-s-new-for-performance-in-wpf-in-net-3-5-sp1.aspx](http://blogs.msdn.com/jgoldb/archive/2008/05/15/what-s-new-for-performance-in-wpf-in-net-3-5-sp1.aspx):

> We now remote as bitmaps in ALL cases.
> 
> The reason is that WPF 3.5 SP1 now uses a new graphics DLL (wpfgfx.dll) and certain changes could not be made to Vista’s existing graphics DLL (milcore.dll) that is also used by DWM.

As other commenters have noted, the performance will greatly depend on the design of your application’s UI. The potential upshot is that you only have to test in one scenario; remoting performance should now be the same regardless of the client or server.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-13T15:53:04.750

一旦这些应用程序更新为与 WPF 一起使用，我们使用 Remote Admin 和 Bomgar 进行远程处理就没有问题。我们已经测试了 XP 到 XP、XP 到 Vista、Vista 到 XP 以及 Vista 到 Vista。我们最初只遇到工具提示和组合框下拉/弹出窗口的问题。在过去六个月左右的时间里，一切都很好。

我刚刚测试了从我的 XP 桌面远程访问 Vista 虚拟机，我们的应用看起来很棒（如果运行有点慢，但它是一个虚拟机......）我切换到低质量的 8 位颜色，性能问题几乎完全消失了. 渐变等在我们的窗口背景等上丢失了，但它绝对仍然可用。

我不认为你应该有任何功能问题，只有轻微的性能问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T15:48:17.630

我想这取决于你的 wpf 应用程序。如果你有很多渐变、动画、画笔等......你的应用程序肯定会在网络上运行得更慢......

# java - eclipse beakpoint：在离开 Java 方法之前停止

> ID：198041
> 
> 赞同：19
> 
> 时间：2008-10-13T15:44:33.990
> 
> 标签：java, eclipse, debugging, breakpoints, eclipse-3.4

有没有办法告诉调试器在返回之前停止，无论哪个语句从方法中退出，无论是返回、异常还是跌出底部？Java 编辑器向我显示了我的方法*可以*退出的所有位置，这使我受到启发——当您单击方法声明的返回类型时，它会突出显示它们（启用标记出现次数）。

[日食 3.4]

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-10-13T16:41:24.827

在方法签名的行上放置一个断点。那是你写的地方

```
public void myMethod() { 
```

然后右键单击断点并选择“断点属性”。在弹出窗口的底部有两个复选框：“方法入口”、“方法出口”。检查后者。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-13T17:12:08.057

您可以设置方法断点。

双击方法声明旁边的空白处。出现带有箭头装饰的断点。右键单击以检查属性，您可以为“方法入口”和/或“方法出口”设置“暂停：”。

您可以在[Eclipse Cookbook](http://books.google.com/books?id=U4UuyIU6bZAC&pg=PA132&lpg=PA132&dq=%22method+breakpoint%22+%22eclipse%22&source=web&ots=eOj8Od5DLx&sig=g-cThDlC2pZ9Alvk5RD8fZ3-0TU&hl=en)中了解更多关于它们的信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T15:54:41.253

好问题。在我的脑海中，我会这样做：

```
public void method(Object stuff) {
    try {
        /* normal code */
    } finally {
        int x = 0;
    }
} 
```

您可以在 x = 0 行上设置断点，无论您返回何处，它都将始终执行。即使抛出异常，它也会运行。

问题在于范围。除非您在 try 块之外定义变量，否则您将无法在到达 finally 块的位置看到它们的值，因为它们将退出范围。

只需放置 5 个断点（每个 return 语句一个，无论如何）可能效果最好。

我希望有更好的方法，我很想知道。

# excel - Excel图表 - 动态设置系列结束

> ID：198045
> 
> 赞同：7
> 
> 时间：2008-10-13T15:46:11.380
> 
> 标签：excel, charts, worksheet-function

我有一个包含大量图表的电子表格和一张包含大量数据的表格。

我已经使用在每个图表上绘制了数据

```
=Sheet1!$C5:$C$3000 
```

这基本上只是在图表上绘制 C5 到 C3000 中的值。

通常，尽管我只想查看数据的子集，例如，我可能只想查看前 1000 行。目前要做到这一点，我必须修改每个图表中的公式，这需要时间。

你知道简化这个的方法吗？理想情况下，如果我可以在单张纸上有一个单元格，它可以从行号中读取并绘制从 C5 到 C“行号”的所有图表，那将是最好的。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-13T16:22:35.940

好的，我必须做更多的研究，这里是如何使它工作，完全在电子表格中（没有 VBA）：

使用 A1 作为所需范围的结尾，并且图表与数据在同一张纸上：

将数据的第一个单元格 (C5) 命名为命名范围，例如 TESTRANGE。
创建了一个命名范围 MYDATA 作为以下公式：

=OFFSET(测试, 0, 0, Sheet1!$A$1, 1)

现在，转到图表 SOURCE DATA 对话框的 SERIES 选项卡，并将 VALUES 语句更改为：

=Sheet1!MYDATA

现在每次更改 A1 单元格值时，它都会更改图表。

感谢 Robert Mearns 发现了我之前回答中的缺陷。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-14T00:34:53.887

这可以通过两个步骤来实现：

*   创建动态命名范围
*   添加一些 VBA 代码以将图表数据源更新为命名范围

### 创建一个名为 Range 的动态

在数据表的单元格中输入数据范围内的行数。

在您的数据表（插入 - 名称 - 定义）上创建一个名为**MyRange**的命名范围，其公式类似于：

```
=OFFSET(Sheet1!$A$1,0,0,Sheet1!$D$1,3) 
```

更新公式以匹配您的布局

*   *Sheet1!$A$1*将此设置为数据范围的左上角
*   *Sheet1!$D$1*将此设置为包含行数的单元格
*   *3*将此值设置为列数

测试命名范围是否正常工作：

选择下拉菜单 Edit - Go To，在参考字段中键入**MyRange 。**应选择图表的数据区域。

### 添加一些VBA代码

打开 VBA IDE (Alt-F11)

在 VBAProject 窗口中选择 Sheet1 并插入此代码

```
Private Sub Worksheet_Change(ByVal Target As Range)

        If Target.Address <> "$D$1" Then Exit Sub
    'Change $D$1 to the cell where you have entered the number of rows
    'When the sheet changes, code checks to see if the cell $D$1 has changed

       ThisWorkbook.Sheets("Sheet1").ChartObjects(1).Chart.SetSourceData _
         Source:=ThisWorkbook.Sheets("Sheet1").Range("MyRange")
    '  ThisWorkbook.Sheets("Chart1").SetSourceData _
         Source:=ThisWorkbook.Sheets("Sheet1").Range("MyRange")
    'The first line of code assumes that chart is embedded into Sheet1
    'The second line assumes that the chart is in its own chart sheet
    'Uncomment and change as required

    'Add more code here to update all the other charts

End Sub 
```

### 需要注意的事项

不要直接使用命名范围作为图表的数据源。如果您输入命名范围“MyRange”作为图表的源数据 - 数据范围，Excel 会自动将命名范围转换为实际范围。因此，您命名范围的任何未来更改都不会更新您的图表。

性能可能会受到上面列出的方法的影响。

命名范围中的**OFFSET**函数是“易失性的”，这意味着它会在工作簿中的任何单元格计算时重新计算。如果性能是一个问题，请将其替换为**INDEX**公式。

```
=Sheet1!$A$1:INDEX(Sheet1!$1:$65536,Sheet1!$D$1,2) 
```

每次在 Sheet1 上更改数据时都会触发代码。如果性能是一个问题，请将代码更改为仅在请求时运行（即通过按钮或菜单）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-13T16:07:47.140

您可以在 Excel 中动态设置图表的范围。您可以使用以下 VBA 代码来执行此操作：

```
Private Sub Worksheet_Change(ByVal Target as Range)
    Select Case Target 
    Case Cells(14, 2)
        Sheet1.ChartObjects(1).Chart.SetSourceData Range("$C5:$C$" & Cells(14,2))
    ...
    End Select
End Sub 
```

在这种情况下，包含要包含的最后一行的编号的单元格是 B14（在引用 Cells 对象时记住 row first）。如果您想完全在代码中执行此操作，也可以使用变量而不是 Cells 引用。（这在 2007 年和 2003 年都有效。）您可以将此过程分配给一个按钮，并在更新包含最后一行的单元格后单击它以刷新图表。

但是，这可能不是您想要做的……我不知道有一种方法可以直接在图表中使用公式来指定源数据。

**编辑：**正如 PConroy 在评论中指出的那样，您可以将此代码放在该工作表的 Change 事件中，这样既不需要按钮也不需要组合键来运行代码。您还可以添加代码，使其仅在编辑匹配单元格时更新每个图表。

我已经更新了上面的示例以反映这一点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-13T16:14:59.230

您可以查看动态范围。如果使用 OFFSET 函数，则可以指定起始单元格以及要选择的行数和列数。 [该站点](http://www.cpearson.com/excel/named.htm)提供了一些有关将名称分配给 OFFSET 范围的有用信息。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-13T19:22:48.463

+1 为名称解决方案。

请注意，名称实际上并没有真正引用范围，它们引用了**公式**。这就是为什么您可以将名称设置为“=OFFSET(...)”或“=COUNT(...)”之类的名称。您可以创建命名常量，只需让名称引用类似于“=42”。

命名公式和数组公式是我发现自己一遍又一遍地应用于不太强大的用户工作表的两种工作表技术。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-17T20:52:10.840

一种简单的方法是隐藏您不想包含的行/列 - 当您转到图表时，它会自动排除隐藏的行/列

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-04-08T11:48:08.107

**增强@Robert Mearns 的答案**，这里是如何使用动态单元格范围***仅使用 Excel 公式***的图形（不需要 VBA）：

**创建一个名为 Range 的动态**

假设您有 3 列，例如：

A5 | 时间 | 数据1 | 数据2 |

A6 | 00:00 | 123123 | 234234 |

...

A3000 | 16:54 | 678678 | 987987 |

现在，您的数据范围可能会根据您可能拥有的数据而变化，例如您有 20 行数据、3000 行数据甚至 25000 行数据。您希望有一个可以自动更新的图表，而无需在每次更新数据本身时重新设置数据范围。

以下是如何简单地做到这一点：

1.  定义另一个单元格，它的值将包含有数据的占用单元格的数量，并将公式`=COUNTIF(A:A,"<>"&"")`放入其中。*例如，这将在单元格* ***D1***中。

2.  转到“公式”选项卡->“定义名称”以定义名称范围。

3.  在“新名称”窗口中：

    一世。为您的数据范围命名，*例如* ***DataRange*** *。*

    ii. 在“引用”中将公式设置为`=OFFSET(Sheet1!$A$1, 0, 0,Sheet1!$D$1,3)`：

    在哪里：

    *   `Sheet1!$A$1`=> 参考：是您要作为偏移基础的参考。

    *   `0`=> Rows：是您希望结果的左上角单元格引用的行数，向上或向下。

    *   `0`=> Columns：是您希望结果的左上角单元格引用的左侧或右侧的列数。

    *   `Sheet1!$D$1`=> 高度：是您希望结果的高度，以行数为单位。

    *   `3`=> 宽度：是您希望结果的宽度，以列数为单位。

4.  添加图表，然后在“选择数据源”窗口的图表数据区域中，插入您创建的公式。*例如：`=Sheet1!DataRange`*

**缺点：**如果直接使用命名范围作为图表的数据源，Excel 会自动将命名范围转换为实际范围。因此，您命名范围的任何未来更改都不会更新您的图表。

为此，您需要编辑图表并将范围重新设置为`=Sheet1!DataRange`每次。这可能不是那么有用，但它比手动编辑范围要好......

# javascript - 通缉：acts_as_nested_set，AJAX拖放教程

> ID：198047
> 
> 赞同：0
> 
> 时间：2008-10-13T15:47:03.407
> 
> 标签：javascript, ruby-on-rails, prototypejs

任何人都可以建议一个教程或示例代码来实现嵌套集（或类似的有序树结构）以及相关的便于拖放的 Javascript 吗？我正在寻找显示代码（视图）以及在更改时将树写入数据库的 AJAX 后端控制器。

我希望它代表一个多层菜单，其中项目的顺序和深度很重要。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-23T08:03:22.103

经过大量搜索，我找到[了这个由 Sven Fuchs 编写的在线示例](http://www.artweb-design.de/2008/5/30/scriptaculous-sortabletree)，它完成了我需要的 90% 的工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-07T06:43:14.257

这可能会有所帮助： [http ://www.justinball.com/2009/01/18/heirarchies-trees-jquery-prototype-scriptaculous-and-acts_as_nested_set/](http://www.justinball.com/2009/01/18/heirarchies-trees-jquery-prototype-scriptaculous-and-acts_as_nested_set/)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2008-10-13T18:59:55.203

像这样的东西你真的不想为一个 jquery 插件打耳光。如果你在外面找不到任何东西，是时候给自己做一杯浓缩咖啡，然后自己深入研究代码了 :)

使用其他更成熟的代码作为示例点，但您自己编写它，它将真正适合您的项目。同时寻找前端和后端代码也非常困难......除非你想从一篇博客文章中获得一些标题，比如“30 个用于 AJAXify 网站的 jquery 插件”，并且你想要垃圾 PHP 代码。（在这种情况下，您似乎需要 RoR）

这可能对你没有多大帮助，但这是我会做的。

无论如何，我特别反对 jquery 插件......即使它完成了你想要的工作。很多代码都很臃肿。另外我倾向于不相信其他人:)

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2008-10-13T23:46:05.937

我已经使用 [www.dhtmlgoodies.com](http://www.dhtmlgoodies.com)的拖放文件夹树来执行此操作。它不是最新的 mootools/jquery/yourfavoriteframework javascript，但你不必看它，它作为一个组件很好地工作，并带有一组漂亮的图像。

我创建了一个小的 mootools 1.1 包装类：

```
window.addEvent('domready', function()
    {
        document.Treeview = new TreeView();
    });

TreeView = new Class({

    initialize: function()
    {
        treeObj = new JSDragDropTree();
        treeObj.setTreeId('treeview');
        treeObj.initTree();
        treeObj.showHideNode(true, 'node0');
        $$('.hiddennode').each(function(elm) { elm.setStyle('display','none'); });
        this.currentItem = false;
    },

    saveValues: function() 
    {
        saveString = treeObj.getNodeOrders();
        new Ajax('./menuitem/save', {postBody: 'order='+saveString, onComplete:function(){window.Growl(this.transport.responseText)}, multiple:false}).request();
    },

    addItem: function()
    {
        new Ajax('./menuitem/add', {update:'editPanel'}).request();     
    },

    loadMenuItem: function(id)
    {
        this.currentItem = id;
        new Ajax('./menuitem/edit/'+id, {update:'editPanel', onComplete:function(){new ScrollDing('editPanel');}}).request();
    },

    removeItem: function()
    {
        if(!this.currentItem)
        {
            alert('please select a menu item to delete.');
        }
        else
        {
        if(confirm('Are you sure you want to delete this menu item?'))
        { 
            // multiple: true is my little extension to mootools's Ajax class. 
        // It expects a JSON object with keys corresponding to element ID's
        // and updates their innerHTML
            new Ajax('./menuitem/delete/'+this.currentItem, {multiple:true}).request();
            this.currentItem = false;
        }
        }
    }

}); 
```

有一个 PHP 类可以进行基本设置。我已经为示例简化了一些内容，但这应该可以帮助您入门。当然，您必须对其进行调整以使用 RoR :-P

```
/**
 * 
 * @package Pork
 * @author SchizoDuckie
 * @copyright SchizoDuckie 2008
 */
class TreeMenu
{
    private  $menuItems, $output;
    function __construct()
    {
        global $db;

        $input =  $db->fetchAll("SELECT * FROM menu ORDER BY intparent, intOrder");
        for ($i=0; $i<sizeof($input); $i++)
        {
            $array = $input[$i];
            $this->menuItems[ $array->intParent ][ ] = $array;
        }
    }

    function hasSubItems($node)
    {
        return (array_key_exists($node, $this->menuItems) && sizeof($this->menuItems[$node]) > 0) ? true : false;
    } 

    function displaytree($start=0, $noSiblings=false)
    {
        $output .= "<ul>";
        for ($i=0; $i<sizeof($this->menuItems[$start]); $i++)
        {

            $item = $this->menuItems[$start][$i];
            $siblings = ($noSiblings) ? "  " : '';
            $output .=  "<li id='node{$item->ID_Menu}'{$siblings}><a href='#' onclick='Treeview.loadMenuItem({$item->ID_Menu});return false;'>{$item->strMenuItem}</a>";
            if ($this->hasSubItems($item->ID_Menu))
            {
                $output .= $this->displayTree($item->ID_Menu, $noSiblings);
            }
            $output .=  "</li>";
        }       
       $output .=   "</ul>";
       return($output);
    }

    function getTreeInnerHTML()
    {
        return("<li id='node0' noDrag='true' noSiblings='true'><a href='#' onclick='return false'>Root</a>{$this->displaytree()}</li>");

    function display()
    {
        global $_TPL;

        $_TPL['styles'][] = './includes/drag-drop-folder-tree.css';
        $_TPL['scripts'][]= './includes/drag-drop-folder-tree.js';
        $_TPL['scripts'][]= './includes/pork.foldertree.js';

        return ("<div id='treebuttons'>
            <input type='button' onclick='Treeview.saveValues()' value='Save order'>
            <input type='button' onclick='Treeview.addItem()' value='Add'>
            <input type='button' onclick='Treeview.removeItem()' value='Remove'>
        </div>
        <ul id='treeview'>{$this->getTreeInnerHTML()}</ul>
        <div id='msgDiv'></div>

        <div id='editPanel'></div>
        ");
    }

} 
```

用法：

```
$tv = new TreeView();
$_TPL['menu'] = $tv->display(); 
```

这也是更改顺序的示例以及添加、编辑和删除功能的作用（当然是简化的）。JsObject 只是一个带有显示函数和 __get 和 __set 函数的包装器，die() 带有一个 json_encoded 数组。对于 ajax 请求非常方便；）

```
<?
global $_URI;

switch ($_URI[0])
{
    case 'menuitem':
        switch ($_URI[1])
        {
            case 'add':
                $item = new menuItem();
                die($item->displayEditor('Add Menu Item', "multiple:true"));
            break;
            case 'edit':
                $item = new menuItem($_URI[2]);
                $_SESSION['currentMenuItem'] = $_URI[2];
                die($item->displayEditor('Edit MenuItem', 'multiple:true'));
            break;
            case 'delete':
                $item = new menuItem($_URI[2]);
                $item->deleteYourSelf();
                $js = new jsObject();
                $js->editPanel = 'Menu Item '.$item->menuItem.' has been deleted.';

                $menu = new Menu();
                $js->treeview = $menu->getTreeInnerHTML();
                $js->script = "document.Treeview = new TreeView();";    
                $js->display();
            break;
            case 'save':
            $items = explode(",",$_POST['order']);
            for($i=0;$i<sizeof($items);$i++)
            {
                $tokens = explode("|",$items[$i]);
                $db->query("update menu set intParent='{$tokens[1]}', intOrder='{$i}' where ID_Menu='{$tokens[0]}'");
            }
            die('Saved the new order!');
        break;
        }
    break;
}

?> 
```

你有它，一个带有可读、不言自明的代码的教程。它不是 RoR，也不是 Prototype，但这应该让你开始吧？

# javascript - 防止 js alert() 暂停计时器

> ID：198049
> 
> 赞同：5
> 
> 时间：2008-10-13T15:47:22.627
> 
> 标签：javascript, timer

所以我为测验做了一些计时器。问题是，我刚刚意识到，当我把

```
javascript: alert("blah"); 
```

在地址中，弹出警报框会**暂停**我的计时器。这在测验中是非常不需要的。

我认为没有任何方法可以阻止这种行为......但无论如何我都会问。

如果没有，介意建议我该怎么办？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-13T16:58:40.970

永远不要依赖 javascript（或任何其他客户端时间）来计算在回发或不同页面之间完成的操作所经过的时间。

如果你总是比较服务器日期，人们就很难作弊：

1.  第一个页面请求，存储服务器时间
2.  每 N 秒使用 javascript 调用一次，比较 2 个服务器时间，并返回经过的时间（仅用于显示）
3.  当用户提交表单时，比较两个服务器时间，计算经过的时间，并丢弃那些耗时过长的（即：可能的作弊者）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-13T16:21:10.887

显然预览渲染与发布的渲染不同。这一段是为了确保接下来的两行显示为代码。

```
// Preserve native alert() if you need it for something special
window.nativeAlert = window.alert;

window.alert = function(msg) {
    // Do something with msg here. I always write mine to console.log,
    // but then I have rarely found a use for a real modal dialog,
    // and most can be handled by the browser (like window.onbeforeunload).
}; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-13T15:49:20.093

不，没有办法阻止警报停止 JavaScript 中的单线程。可能您可以使用其他一些用户通知方式，例如浮动层。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-13T15:51:49.153

它是模态的并停止执行。考虑一种不会像灯箱技术那样暂停执行的替代方案。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-13T16:25:02.660

我认为提问者试图防止作弊。由于用户可以键入 javascript: alert("paused"); 进入地址栏，或者制作一个书签来做到这一点，很容易暂停测验和作弊。

我唯一能想到的是使用 Date() 来获取当前时间，并在计时器触发时再次检查它。然后，如果时间差没有合理地接近预期的计时器持续时间，请发出警告并取消该问题的答案或让他们不及格测验。没有办法阻止用户暂停您的测验，但应该可以抓住他们。

当然，通过任何防作弊功能，您都会激励人们成为更好的作弊者。一个人可以在他们的 PC 上更改系统时间，并欺骗从操作系统获取时间的 javascript Date() 构造函数。

您可以使用时间间隔对一秒的时间间隔长度进行重复的时钟比较。间隔处理程序还可以更新用户显示器上的剩余时间字段。然后，随着测验时间的流逝，用户可以感受到压力的增加。娱乐时间！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-13T20:28:25.583

SyaZ 问题的反馈循环已经澄清了相关问题。

这是迄今为止总结好的答案的尝试：

*   客户端脚本本质上很容易操纵以欺骗在线测验。查看[@Filini 的服务器端方法](https://stackoverflow.com/questions/198049/prevent-js-alert-from-pausing-timers#198265)

*   window.alert = function(msg) {} 将覆盖*alert()*并且可能会打败放入地址栏中的低悬果：*javascript:alert('Pausing page so I can google answer') 或者我将使用我的电话-现在的朋友。* [礼貌@eyelidlessness](https://stackoverflow.com/questions/198049/prevent-js-alert-from-pausing-timers#198160)

*   如果您必须使用客户端方法，而不是使用 setTimeOut()，您可以使用这样的自定义基于日期比较的暂停函数（[@Mnebuerquo 的概念](https://stackoverflow.com/questions/198049/prevent-js-alert-from-pausing-timers#198172)，我的代码示例（[@micahwittman](https://stackoverflow.com/users/11181/micahwittman)））：

例子：

```
var beginDate = new Date();

function myTimeout(milsecs){
  do { curDate = new Date(); }
    while((curDate-beginDate) < milsecs);
}

function putDownYourPencils(milsecs){
  myTimeout(milsecs);
  var seconds = milsecs / 1000;
  alert('Your '  + seconds + ' seconds are up. Quiz is over.');
}

putDownYourPencils(3000); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-13T22:57:06.970

最终，您无法信任用户输入。如果不跟踪服务器上经过的时间，就不能保证数据没有被操纵。

但是，如果您确信您的测验者不精通 JavaScript，并且仅仅依靠他们在某处发现的“技巧”，您可以使用以下代码测试作弊（暂停），这不需要修改窗口警报：

```
var timer = {
    startDatetime: null,
    startSec: 0,
    variance: 1,
    exitOnPause: true,
    count: function (config) {
        var that = this;

        if (typeof config == "object" && typeof parseInt(config.seconds) == "number" && !isNaN(parseInt(config.seconds)))
        {
            if (typeof parseFloat(config.variance) == "number" && !isNaN(parseFloat(config.variance))) this.variance = config.variance;
            if (typeof config.exitOnPause == "boolean") this.exitOnPause = config.exitOnPause;

            if (config.seconds > 0)
            {
                if (!this.startSec) this.startSec = config.seconds;
                if (!this.startDatetime) this.startDatetime = new Date();
                var currentDatetime = new Date();

                if (currentDatetime.getTime() - this.startDatetime.getTime() > (this.startSec - config.seconds) * this.variance * 1000)
                {
                    if (typeof config.onPause == "function") config.onPause();

                    if (!this.exitOnPause)
                    {
                        this.startDatetime = new Date();
                        this.startSec = config.seconds--;
                        window.setTimeout(function () { that.count(config); }, 1000);
                    }
                }
                else
                {
                    config.seconds--;
                    window.setTimeout(function () { that.count(config); }, 1000);
                }
            }
            else
            {
                if (typeof config.onFinish == "function") config.onFinish();
            }
        }
    }
}; 
```

此计时器对象有一个方法 count()，它接受一个对象作为输入。它期望输入对象中至少有一个 seconds 属性。

出于某种原因，window.setTimeout 并不总是按预期工作。有时，在我的机器上，应该在 1 秒后执行代码的 window.setTimeout(x, 1000) 花费了 2 秒以上。因此，在这种情况下，您应该允许差异，这样没有作弊的人就不会被标记为作弊者。方差默认为 1，但可以在输入对象中覆盖。这是如何使用此代码的示例，它允许 2.5 秒的“摆动空间”用于慢戳：

```
timer.count({
    seconds: 10,
    onPause: function () { alert("You cheated!"); window.location.replace("cheatersAreBad.html"); },
    onFinish: function () { alert("Time's up!"); },
    variance: 2.5
}); 
```

例如，通过这样的解决方案，您可以使用 Ajax 告诉服务器端脚本用户已暂停计时器或将用户重定向到解释他们被抓到作弊的页面。如果出于某种原因，您希望允许用户在被发现作弊后继续参加测验，您可以将 exitOnPause 设置为 false：

```
timer.count({
    seconds: 10,
    exitOnPause: false,
    onPause: function () { recordCheaterViaAjax(); },
    onFinish: function () { alert("Time's up!"); },
    variance: 2.5
}); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-26T18:16:03.907

服务器会话可以设置为在 1 小时后到期。javascript 只能用作显示工具，让用户知道还剩多少时间。如果他决定通过暂停计时器来作弊，那么在发布他的测试时他可能会惊讶于他的会话已超时。

# c++ - 为什么“删除 [][]... multiDimensionalArray;” C++ 中的运算符不存在

> ID：198051
> 
> 赞同：22
> 
> 时间：2008-10-13T15:48:01.330
> 
> 标签：c++, arrays

我一直想知道在标准 C++ 语言中是否有删除多维数组的运算符。

如果我们创建了一个指向一维数组的指针

```
int *array = new int[size]; 
```

删除看起来像：

```
delete [] array; 
```

那太棒了。但是如果我们有二维数组，我们就做不到

```
delete [][] twoDimenstionalArray; 
```

相反，我们应该循环并删除这些项目，就像在[这个](http://eli.thegreenplace.net/2003/07/23/allocating-multi-dimensional-arrays-in-c/)例子中一样。

谁能解释为什么？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-10-13T15:52:04.333

从技术上讲，C++ 中没有二维数组。您用作二维数组的是一维数组，每个元素都是一维数组。由于它在技术上不存在，因此 C++ 无法删除它。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-10-13T15:53:40.710

因为没有办法打电话

```
int **array = new int[dim1][dim2]; 
```

所有新闻/删除必须平衡，因此`delete [][]`操作员没有意义。

`new int[dim1][dim2]``dim1`返回一个指向类型为大小的数组的指针`int[dim2]`。所以`dim2`必须是编译时间常数。这类似于在堆栈上分配多维数组。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-13T15:53:28.307

在该示例中多次调用 delete 的原因是因为 new 也被多次调用。必须为每个新的调用删除。

例如，如果我分配 1,000,000 字节的内存，我以后不能删除 200,000 - 300,00 的条目，它被分配为一个完整的块，并且必须作为一个完整的块释放。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-13T16:02:29.990

就像您提到的示例中那样，您必须循环的原因是编译器/分配器不知道需要删除的数组数量。

当你分配你的二维数组时，你真的创建了 N 个一维数组。现在每一个都要删除，但是系统不知道有多少。顶级数组的大小，即指向二级数组的指针数组，就像 C 中的任何其他数组一样：系统不存储它的大小。

因此，无法`delete [][]`按照您的描述实现（无需显着更改语言）。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-13T15:52:03.757

从语言设计的角度不确定确切的原因，我猜这与分配内存时创建一个数组数组并且每个都需要删除的事实有关。

```
int ** mArr = new int*[10];
for(int i=0;i<10;i++)
{
   mArr[i]=new int[10];
} 
```

我的 c++ 生锈了，我不确定这在语法上是否正确，但我认为它很接近。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-04-25T23:37:34.733

虽然所有这些答案都是相关的，但我将尝试解释预期的结果，类似的东西*`delete[][] array;`*可能适用于动态分配的数组以及为什么它不可能：

**静态**`int array[ROWS][COLS];`分配数组所允许的语法只是程序员的抽象，实际上是创建一维数组。但是在编译过程中（当维度大小并且必须是标准的常量时）编译器还会记住这些维度的大小，这是以后使用语法（例如. 编译器，已知这个大小，然后将使用简单的数学替换为一维数组的相应索引：.**`int array[ROWS*COLS];``COLS``ROWS``array[x][y] = 45``[x][y]``[COLS*x + y]`**

 **另一方面，如果您想要相同的多维功能（实际上是符号） ，**动态分配的数组就不是这种情况。**由于它们的大小可以在运行时确定，因此它们还必须记住每个附加维度的大小以供以后使用 - 并在数组的整个生命周期中记住这一点。此外，必须在此处实现系统更改才能将数组实际作为多维`[x][y]`使用，在代码中保留访问符号的形式，而不是在编译期间将其替换为一维符号，而是稍后在运行时替换它。

Therefore an **absence** of *`array = new int[ROWS][COLS]`* implies no necessity for *`delete[][] array;`*. And as already mentioned, it can't be used on your example to delete your "multi-dimensional" array, because your sub-arrays (additional dimensions) are allocated separately (using separate `new` call), so they are independent of the top array (`array_2D`) which contains them and they all can't be deleted at once.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-13T15:51:00.543

delete[] 适用于任何非标量（数组）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-13T18:21:03.220

您可以使用包装类为您完成所有这些事情。使用“原始”数据类型通常不是一个好的解决方案（数组应该封装在一个类中）。例如 std::vector 就是一个很好的例子。

应该准确地调用 Delete 多少次 new 被调用。因为您不能调用“a = new X[a][b]”，所以也不能调用“delete [][]a”。

从技术上讲，这是一个很好的设计决策，可以防止整个 n 维矩阵出现奇怪的初始化。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-14T05:56:49.743

好吧，我认为这很容易实现，但太危险了。很容易判断指针是否由 . 创建`new[]`，但很难判断`new[]...[]`（如果允许）。

# html - 有必要显示一个空的 ?

> ID：198058
> 
> 赞同：14
> 
> 时间：2008-10-13T15:50:50.577
> 
> 标签：html

我想显示一个具有背景颜色的 div，其高度和宽度设置为 100%，但没有内容。是否可以在不放   的情况下做到这一点？里面？

编辑：感谢 Mark Biek 指出具有宽度和高度样式的空 div 显示了我的期望。我的 div 在一个表格单元格中，它没有显示。

```
<table style="width:100%">
<tr>
<th>Header</th>
<td><div id="foo"></div></td>
</tr>
</table> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-13T15:57:50.513

这似乎适用于 Firefox、Safari、IE6 和 IE7。

```
<html>
    <head>
        <style>
            #foo{
                background:  #ff0000;
                width:  100%;
                height:  100%;
                border:  2px dashed black;
            }
        </style>
    </head>
    <body onload="">
        <div id="foo"></div>
    </body>
</html> 
```

[![3 浏览器示例](https://farm4.static.flickr.com/3008/2938703792_f4602930fb_m.jpg)](http://farm4.static.flickr.com/3008/2938703792_886e488f68_o.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-13T16:01:24.033

嗯...我不确定规范到底说了什么，但我知道虽然空的内联元素（例如 span）是有效的，但空的块元素（例如 p 或 div）会被 html-tidy “清理” .

因此，我会说坚持使用   会更安全。因为它对你的情况没有害处。我还会添加诸如“<!-- background container -->”之类的评论。所以每个要修改你的html的人都知道，即​​使是空的，div也有特殊的含义。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-13T16:15:03.333

恕我直言，如果您希望它们实际呈现为某些内容，则应该包含其他空 DIV 的 nbsp。

在“理论上”的注释中..如果没有内容，浏览器不**应该**显示任何内容。nbsp 的全部意义在于表示空白。这既是常识，也是（我相信）标准。

在实际方面..你有三个选择。一种是关闭 nbsp，因为你知道你会得到不可预知的结果。这可能是最容易编码的。另一种方法是始终包含 nbsp，方法是始终将 nbsp 放在 div 的末尾，或者测试是否为空，如果为空则添加 nbsp。第三个它用于测试浏览器并在需要时插入 nbsp。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T15:58:13.993

我认为这取决于浏览器（IE/Gecko 引擎/Webkit 引擎）和模式（标准模式、Quirks 模式）。我有一些 div 出现在 FFox/Standards 模式中，而没有出现在 IE6/7 中。

您可能可以仅使用 css 以跨浏览器的方式执行此操作，但您可能会求助于一些 css hack。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-13T16:01:44.187

根据经验，IE 不会渲染空元素的边框（至少是空的 <td> 元素）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-14T20:40:56.947

也许

`#foo {empty-cells: show;}`

虽然那可能只是为了`<td>`

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-02-12T05:34:26.430

您应该`&nbsp;`始终包括在内。

# c++ - Win2K/XP中检查目录写权限的代码

> ID：198071
> 
> 赞同：4
> 
> 时间：2008-10-13T15:53:46.467
> 
> 标签：c++, windows, security, permissions, atl

问候！

我正在尝试使用 C++ 从 Windows MFC/ATL 程序中检查目录写权限。我的第一个猜测是使用 C 标准的 _access 函数，例如：

```
if (_access("C:\mydir", 2) == -1)
   // Directory is not writable. 
```

但显然在 Windows 2000 和 XP 上，_access 无法确定目录权限。（即，当您在资源管理器中右键单击目录时，属性对话框中的安全选项卡） 那么，是否有一种优雅的方法可以使用任何 Windows C++ 库来确定 Windows 2000/XP 中目录的写入权限？如果是这样，怎么做？

谢谢

埃文

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-13T16:21:47.813

您可以调用具有 GENERIC_WRITE 访问权限的 CreateFile 来检查这一点。 [http://msdn.microsoft.com/en-us/library/aa363858(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa363858(VS.85).aspx)

它不是 C++ 库，但它仍然算得上优雅，因为它直接执行您想要的操作……

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T16:00:02.147

使用秒 api。您可以在 Adv 上询问。Win32 api新闻组：news://194.177.96.26/comp.os.ms-windows.programmer.win32 经常被讨论的地方（C/C++代码）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-13T17:18:20.197

有许多[Windows 安全功能](http://msdn.microsoft.com/en-us/library/aa375742(VS.85).aspx)，尽管我不会称它们的使用特别优雅。我会推荐 GetNamedSecurityInfo 作为通用解决方案，但 CreateFile 解决方案具有一定的简单性和直接性，我也很欣赏。:)

# .net - 在哪里可以了解各种类型的 .NET 列表？

> ID：198079
> 
> 赞同：29
> 
> 时间：2008-10-13T15:57:00.920
> 
> 标签：.net, collections

有没有人知道一个很好的资源来简明地解释 C# 中可用的不同类型的列表以及何时使用它们是合适的？

例如，列表、哈希表、字典等。

我从不太确定什么时候应该使用什么。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-10-13T16:13:09.733

这些不是所有列表，尽管它们都是集合。这是一个快速的总结。

**非泛型集合（API 是根据`object`. 值类型被装箱的。**

这些主要在[System.Collections](http://msdn.microsoft.com/en-us/library/system.collections.generic.aspx)命名空间中：

*   [ArrayList](http://msdn.microsoft.com/en-us/library/system.collections.arraylist.aspx)：由数组支持的项目列表。快速随机读/写访问。*如果*缓冲区不需要调整大小，则快速添加到尾端。
*   [Hashtable](http://msdn.microsoft.com/en-us/library/system.collections.hashtable.aspx)：从键映射到值。键是唯一的，值不必是唯一的。使用 GetHashCode 方法来实现接近 O(1) 的读/写访问（除了所有项目具有相同哈希或后备存储需要重建的恶劣情况）。遍历键/值对会产生不可预测的顺序。（嗯，实际上是不可预测的。）
*   [SortedList](http://msdn.microsoft.com/en-us/library/system.collections.sortedlist.aspx)：与 Hashtable 类似，但条目始终以按键排序的顺序返回。存储为键/值对列表。
*   [Stack](http://msdn.microsoft.com/en-us/library/system.collections.stack.aspx) : 后进先出集合
*   [队列](http://msdn.microsoft.com/en-us/library/system.collections.queue.aspx)：先进先出集合
*   [数组](http://msdn.microsoft.com/en-us/library/system.array.aspx)：固定大小 O(1) 随机访问；非泛型，但也有强类型形式

**通用集合。（强类型 API，不会装箱值类型（假设合适的 T）。**

这些主要在[System.Collections.Generic 命名空间](http://msdn.microsoft.com/en-us/library/system.collections.generic.aspx)中：

*   [List<T>](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx) : 像 ArrayList
*   [Dictionary<TKey, TValue>](http://msdn.microsoft.com/en-us/library/xfhwa508.aspx) : 像 Hashtable
*   [SortedList<TKey, TValue>](http://msdn.microsoft.com/en-us/library/ms132319.aspx)：类似于 SortedList
*   [SortedDictionary<TKey, TValue>](http://msdn.microsoft.com/en-us/library/f7fta44c.aspx)：类似于 SortedList，但存储为键/值对树，在许多情况下提供更好的性能。有关更多详细信息，请参阅文档。
*   [LinkedList<T>](http://msdn.microsoft.com/en-us/library/he2s3bh7.aspx)：双向链表（快速访问头尾）
*   [Stack<T>](http://msdn.microsoft.com/en-us/library/ms132319.aspx) : 像栈一样
*   [Queue<T>](http://msdn.microsoft.com/en-us/library/7977ey2c.aspx) : 像队列
*   [ReadOnlyCollection<T>](http://msdn.microsoft.com/en-us/library/ms132474.aspx)：与 List<T> 类似，但提供只读视图

可能最重要的集合*接口*是[IEnumerable](http://msdn.microsoft.com/en-us/library/system.collections.ienumerable.aspx)（和[IEnumerable<T>](http://msdn.microsoft.com/en-us/library/9eekhta0.aspx)）。这表示一个项目序列，就像 Stream 表示一个字节序列一样。没有随机访问，只有前向阅读。LINQ to Objects 基于此，几乎所有集合类型都实现了它。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-16T17:42:11.817

为了解释 tobsen 之前的回答，C5 Generic Collection Library 有大量的收藏。我将在这里描述其中的一些：

**队列/堆栈**

*   `CircularQueue<T>`：此类提供严格的队列和堆栈功能。同样，使用索引器可以有效地*O* (1) 访问堆栈/队列中的任何项目：（`cq[0]`其中 0 是最旧的项目，接下来要出列，最后要弹出）。

**列表**

注意：`ArrayList`也`LinkedList`可以用作队列/堆栈

*   `ArrayList<T>`: 与 , 中的对应物类似，它`System.Collections.Generic (SCG)`由`List<T>`数组支持，保证*O* (1) 索引，但最坏情况下*O* ( *n* ) 插入。*O* ( *n* ) 找到一个项目。
*   `LinkedList<T>`: 与其对应的类似`SCG.LinkedList<T>`。使用双向链表，保证*O* (1) 插入，但最坏情况*O* ( *n* ) 索引（在实践中，与列表头部或尾部的距离成正比）。还要*O* ( *n* ) 找到一个项目。排序使用稳定的合并排序。
*   `HashedArrayList<T>`: 与`ArrayList<T>`上面类似，但不允许重复。您获得的回报是查找项目及其索引的时间减少到*O* (1)。
*   `HashedLinkedList<T>`: 与`LinkedList<T>`上面类似，但不允许重复。和以前一样，找到一个项目的时间减少到*O* (1)，但找到它的索引的时间仍然是*O* ( *n* )。
*   `WrappedArray<T>`: 与 非常相似`ArrayList<T>`，它充当实现 的数组的包装器`C5.IList<T>`，但如果尝试修改集合 (`IsFixedSize`为 true 并且`Add`,不工作; ,`Remove`和做，但是，因为它们是就地操作）。`Insert``Sort``Shuffle``Reverse`

列表还提供了一个“查看”功能，它表示底层列表的一部分，允许执行本地操作。使用 C5 书中提供的模式，可以使用对数组和链表都有效的视图来执行操作。任何列表操作也可以在视图上执行，将它们的效果限制在底层列表的子集上。

**排序集合**

*   `SortedArray<T>`: 与 an 类似，`ArrayList<T>`不同之处在于它保持其项目排序并且不允许重复。请注意，此集合上的随机插入和删除速度很慢。如果项目数量很少或很少修改但经常通过项目索引或值访问，则此集合是最好的。
*   `TreeSet<T>`：使用红黑树结构来保持项目排序。作为一个集合，它不允许重复。通过索引或项目值访问以及插入/删除需要*O* ( *log n* )。
*   `TreeBag<T>`：使用红黑树，保持项目排序。作为一个包，它确实允许重复，但不会在树中存储重复，而是通过计数来保持重复。

两者都`TreeSet<T>`提供`TreeBag<T>`了在*O* (1) 中有效地制作“快照”或树的持久副本的能力，允许在修改底层树的同时对快照进行迭代。请注意，树上的每个快照都会对树的更新增加性能损失，但这些影响会在释放快照后消失。

**哈希集合**

*   `HashSet<T>`：使用简单哈希表进行存储的集合。按项目值访问需要*O* (1)。作为一个集合，它不允许重复。提供一个函数`BucketCostDistribution()`，可以帮助您确定项目的哈希码函数的效率。
*   `HashBag<T>`: 与 类似`HashSet<T>`，但有包语义，表示允许重复，但重复只通过计数存储。

**优先队列**

*   `IntervalHeap<T>`：提供优先队列。求最大值和最小值是*O* (1) 次运算，删除最大值、最小值、添加和更新是*O* ( *logn* ) 次运算。通过显式存储它们（而不是通过计数）来允许重复。

**字典**

*   `HashDictionary<H,K>`: 类似于, 提供*O* (1)`SCG.Dictionary<H,K>`中的条目访问、插入和删除。还提供了如上的功能。不保证任何特定的枚举顺序。*`BucketCostDistribution()``HashSet<T>`*
**   `TreeDictionary<H,K>`: 类似于 ,`SCG.SortedDictionary<H,K>`使用红黑树提供一个持久排序的字典。条目访问、插入和删除需要*O* ( *log n* )。保证字典的枚举遵循键比较器指定的顺序。*

 ***受保护的集合**

同样，C5 还提供“受保护”集合，它有效地充当只读包装器，防止集合被修改。集合中的项目仍然可以修改，但不能添加、删除或插入集合中的项目。

一个很长的答案，但对 C5 库的各种集合供您使用是彻底的。我发现 C5 库很棒，并且经常在我自己的代码中使用它，将常见的 C# 标头替换为：

```
using C5;
using SCG = System.Collections.Generic; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-13T16:11:58.940

你应该拿起一本关于基本数据结构的书。无论语言如何，都是相同的理论。

一个简短的解释：

*   `Array`: (如在 eg 中`int[] myArray`) - 可以在集合永不更改时使用的静态数组（您不能添加或删除其中的项目，但您可以更改单个项目的值）
*   `ArrayList`：通用数组/列表，允许相对快速的枚举以及直接访问。该列表可以在您添加项目时自动增长，但由于它只存储`Object`，因此由于性能和类型安全问题，您应该很少使用它。
*   `List<T>`: 上述 ArrayList 的通用版本。它在性能和灵活性之间提供了一个很好的平衡，几乎总是应该在你有一个动态的平面项目列表时使用。（.NET 2.0 中的新功能）
*   `Hashtable`: 像平面列表一样工作，但不是用整数索引它，而是可以使用任何对象索引。值得注意的是，哈希表中没有“顺序”。
*   `Dictionary<T>`：哈希表的通用版本。在 .NET 2.0 和更高版本中使用它而不是 Hashtable，原因与上面的 ArrayList 与 List 相同。
*   `Stack<T>`：提供先进后出类型的列表。您最后添加的物品将是您挑选物品时首先收到的物品。
*   `Queue<T>`：提供先进先出列表。把它想象成一个管子，你在一端插入物品，从另一端取出它们。通常用于在例如线程之间传递消息。

通常，您应该对在 .NET 2.0 及更高版本中所做的几乎所有事情使用泛型集合。您将获得完整的类型安全性（与例如 ArrayList 和 HashTable 相比），并且与非泛型一次相比，它们对于值类型（整数、结构、浮点数等）要快得多。

如果您有一个永远不会改变的项目列表，或者您不需要/不想要灵活性，`List<T>`那么您当然可以使用数组，因为它的开销最少。

从公共方法或属性返回集合时，建议将其转换为不太灵活的接口。因此，如果您有一个要返回的 List，您可以将其转换为 an `IEnumerable<int>`，这意味着您的消费者无法向其中添加项目（当然，除非它将其转换回，但它仍然是对用户的指示）。转换它还可以让您在以后灵活地更改底层数据结构，同时保持 API 稳定性。您还可以选择`ICollection<int>`或`IList<int>`公开更多功能，但隐藏实际数据结构。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-13T16:11:29.877

**哈希图**

*   字典
*   哈希表（非泛型）

这是一种允许您保留键值对的数据结构。给定具有某种排序方式的键，您可以插入一个值。一个简单的示例可以是学生列表，其中键是学生 ID，值是学生姓名。

**随机访问列表**

*   列表
*   ArrayList（非泛型）

随机访问列表用于存储要随机访问的一长串对象（即您想在 O(1) 时间内访问第 n 个元素）。如果您想在列表的中间插入/删除元素，那就不好了，因为这需要整个列表被打乱，这可能需要一些时间。

**链表和类似的**

*   链表
*   队列
*   堆

如果您不想访问中间的元素，则链接列表非常有用，因为这将花费 O(N) 时间。如果您想在中间插入/删除元素，那就太好了，因为它只涉及更改几个指针。

队列和堆栈稍微专业化，因为它们针对 FIFO 和 FILO 行为（分别为先进先出和先进先出）进行了优化。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-13T15:59:44.940

如果您从[System.Collections 的 MSDN 文档](http://msdn.microsoft.com/en-us/library/system.collections.aspx)开始，您可以深入了解各个集合类型，以获取有关这些“列表”以及如何使用它们的更多详细信息。例如，doco for`Hashtable`说：“表示基于键的哈希码组织的键/值对的集合。”

在[理解泛型](http://en.csharp-online.net/Understanding_Generics%E2%80%94The_System.Collections.Generic_Namespace)中也有一个很好的 System.Collections.Generic 讨论。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-13T16:05:56.817

List<T> 是可排序的，但不建议公开。

Collection<T> 是一个基本的、没有多余装饰的集合。

Dictionary<T> 是键值对的集合（很像旧的哈希表，但现在是通用的）。

KeyedCollection<T> 是一个字典，可以从值中确定键（这是一个抽象，所以你必须继承它并支持GetKey函数）

ReadOnlyCollection<T> 是一个不能修改内容的特殊集合。

从 .NET 2.0 开始，ArrayList 和 HashTable 基本上已经过时。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-13T19:07:34.967

除了到目前为止的出色答案之外，还有一些可以通过[C5 Generic Collection Library](http://www.itu.dk/research/c5/)获得的 Collections 。在根据您的要求决定使用什么时，文档（也在他们的网站上）可能会有所帮助。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-04T14:59:41.813

MSDN 有一篇名为[Selecting a Collection Class](http://msdn.microsoft.com/en-us/library/6tc79sx1.aspx)的文章，我发现在尝试找出在给定情况下使用哪种集合时非常有用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-13T16:00:59.230

这些是各种类型的[通用数据结构](http://www.cs.auckland.ac.nz/software/AlgAnim/ds_ToC.html)的示例。这些数据结构在软件工程中无处不在。

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2008-10-13T16:00:10.620

`System.collections.Generic.`如果您只是在代码窗口中键入，Intellisense 会向您显示每个的简短描述。不要忘记尾随句点。哦，还有`System.Collections.ObjectModel.`。从那里您应该能够从 MSDN 获得有关任何看起来很有希望的信息的更多信息。

# asp.net - 如何从 Web 应用程序中找出 ASP.NET 中的会话大小？

> ID：198082
> 
> 赞同：20
> 
> 时间：2008-10-13T15:57:47.097
> 
> 标签：asp.net, session, size

如何从 Web 应用程序中找出 ASP.NET 中的会话大小？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-10-13T17:42:09.633

如果您试图在运行时而不是在调试跟踪中获取 Session 的大小，您可能想尝试这样的事情：

```
long totalSessionBytes = 0;
BinaryFormatter b = new BinaryFormatter();
MemoryStream m;
foreach(var obj in Session) 
{
  m = new MemoryStream();
  b.Serialize(m, obj);
  totalSessionBytes += m.Length;
} 
```

（灵感来自[http://www.codeproject.com/KB/session/exploresessionandcache.aspx](http://www.codeproject.com/KB/session/exploresessionandcache.aspx)）

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2011-03-16T19:07:15.083

上面答案中的代码一直给我相同的数字。这是最终对我有用的代码：

```
private void ShowSessionSize()
{
    Page.Trace.Write("Session Trace Info");

    long totalSessionBytes = 0;
    System.Runtime.Serialization.Formatters.Binary.BinaryFormatter b = 
        new System.Runtime.Serialization.Formatters.Binary.BinaryFormatter();
    System.IO.MemoryStream m;
    foreach (string key in Session)
    {
        var obj = Session[key];
        m = new System.IO.MemoryStream();
        b.Serialize(m, obj);
        totalSessionBytes += m.Length;

        Page.Trace.Write(String.Format("{0}: {1:n} kb", key, m.Length / 1024));
    }

    Page.Trace.Write(String.Format("Total Size of Session Data: {0:n} kb", 
       totalSessionBytes / 1024));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T16:20:36.007

我认为您可以通过将**Trace="true"**添加到 aspx 页面的页面指令来找到该信息。然后，当页面加载时，您可以看到有关页面请求的大量详细信息，包括我认为的会话信息。

您还可以通过在 web.config 文件中添加一行来在整个应用程序中启用跟踪。就像是：

```
<trace enabled="true" requestLimit="10" pageOutput="true" traceMode="SortByTime" 
 localOnly="true"/> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-10-16T08:32:14.397

这是我的代码，用于将所有当前会话变量及其大小（以 kB 为单位）放入字典中。

```
// <KEY, SIZE(kB)>
var dict = new Dictionary<string, decimal>();

BinaryFormatter b = new BinaryFormatter();
MemoryStream m;
foreach(string key in Session.Keys) 
{
    var obj = Session[key];
    if (obj == null)
    {
        dict.Add(key, -1);
    }
    else
    {
        m = new MemoryStream();
        b.Serialize(m, obj);

        //save the key and size in kB (rounded to two decimals)
        dict.Add(key, Math.Round(Convert.ToDecimal(m.Length) / 1024, 2)); 
    }
}

//return dict 
```

# windows - 如何从命令行列出已安装的 MSI？

> ID：198087
> 
> 赞同：13
> 
> 时间：2008-10-13T15:59:00.217
> 
> 标签：windows, windows-installer

我们最近将我们的 Windows 软件包从 RPM (cygwin) 切换到 MSI (wix)。拥有原生包装是一个非常受欢迎的变化，我们打算坚持下去。然而，MSI 感觉它所做的事情过于复杂，而且似乎没有提供一些基本的能力。但我可能弄错了。

有没有办法从命令行列出所有已安装的 MSI？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-13T16:11:13.543

也许[这](http://msdn.microsoft.com/en-us/library/aa394378(VS.85).aspx)是一个很好的起点，例如 MSDN 中的 VB 脚本：

```
strComputer = "."

Set objWMIService = GetObject("winmgmts:" & _
    "{impersonationLevel=impersonate}!\\" & _
    strComputer & _
    "\root\cimv2")

Set colSoftware = objWMIService.ExecQuery _
    ("SELECT * FROM Win32_Product")   

If colSoftware.Count > 0 Then

    Set objFSO = CreateObject("Scripting.FileSystemObject")
    Set objTextFile = objFSO.CreateTextFile( _
        "c:\SoftwareList.txt", True)

    For Each objSoftware in colSoftware
        objTextFile.WriteLine objSoftware.Caption & vbtab & _
        objSoftware.Version
    Next

    objTextFile.Close

Else
    WScript.Echo "Cannot retrieve software from this computer."

End If 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-11-21T17:01:28.277

您可以使用[PowerShell](http://en.wikipedia.org/wiki/Powershell)和[Windows Management Instrumentation (WMI)](http://en.wikipedia.org/wiki/Windows_Management_Instrumentation)。这是一个单行：

```
Get-WmiObject -Class win32_product 
```

这是`Get-WmiObject` [cmdlet](http://en.wikipedia.org/wiki/Cmdlet)的帮助：

[http://technet.microsoft.com/en-us/library/dd315295.aspx](http://technet.microsoft.com/en-us/library/dd315295.aspx)

这是一个示例，我们选择第一个安装的程序并将其格式化为表格：

```
PS C:\Users\knut> Get-WmiObject -Class win32_product |
>> select -First 1 | ft Name, Version, Vendor -AutoSize
>>

Name             Version  Vendor
----             -------  ------
AWS SDK for .NET 1.2.0200 Amazon Web Services Developer Relations 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-13T16:29:36.067

我不确定这是否是您需要的，但您可以从命令行查询卸载列表：

```
REG QUERY HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall 
```

# visual-studio - 在 VS 2008 中创建测试运行配置

> ID：198097
> 
> 赞同：7
> 
> 时间：2008-10-13T16:01:20.913
> 
> 标签：visual-studio, visual-studio-2008, unit-testing, code-coverage

我正在使用 Visual Studio 2008（开发人员版）中的 n 层架构，但遇到了问题。

我们正在对服务层的每个方法运行单元测试，并且我正在尝试查看代码覆盖率结果，以确保通过我的方法访问所有主要路径。

当我尝试查看结果时，我被告知测试运行没有启用代码覆盖。我尝试通过 test -> edit test run configurations 编辑测试运行配置，结果发现没有找到。

我还没有发现如何创建测试运行配置，以便我可以启用代码覆盖率结果。

如何创建配置？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-13T17:21:48.177

右键单击**解决方案**，选择添加，新建项目，然后在结果对话框中选择测试运行配置。唯一棘手的部分是除非您右键单击解决方案，否则您不会获得此选择。

# sql - 仅具有选择的事务中的提交和回滚之间有区别吗？

> ID：198108
> 
> 赞同：21
> 
> 时间：2008-10-13T16:04:29.503
> 
> 标签：sql, oracle, transactions, commit, rollback

我们在我公司使用的内部应用程序框架使得有必要将每个 SQL 查询放入事务中，即使我知道没有任何命令会在数据库中进行更改。在会话结束时，在关闭连接之前，我提交事务以正确关闭它。我想知道如果我回滚它是否有任何特别的区别，尤其是在速度方面。

请注意，我使用的是 Oracle，但我猜其他数据库也有类似的行为。此外，我对开始交易的要求无能为力，代码库的那部分不在我的掌控之中。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-13T16:46:18.060

数据库通常保留前映像日志（事务之前的状态）或后映像日志（事务完成时的状态。）如果保留前映像，则必须在回滚时恢复. 如果它保留残像，则必须在提交时替换数据。

Oracle 既有日志空间，也有回滚空间。事务日志累积块，稍后由 DB 写入者写入。由于这些是异步的，几乎没有任何与数据库写入器相关的内容对您的事务有任何影响（如果队列已满，那么您可能需要等待。）

即使对于仅查询事务，我也愿意打赌在 Oracle 的回滚区域中存在一些事务记录保存。我怀疑回滚需要 Oracle 在确定没有任何实际回滚之前需要做一些工作。我认为这与您的交易同步。在回滚完成之前，您不能真正释放任何锁。[是的，我知道您在事务中没有使用任何东西，但锁定问题是为什么我认为必须完全释放回滚，然后才能释放所有锁，然后您的回滚就完成了。]

另一方面，提交或多或少是预期的结果，我怀疑丢弃回滚区域可能会稍微快一些。您没有创建任何事务条目，因此数据库编写器甚至永远不会醒来检查并发现无事可做。

我还希望，虽然提交可能会更快，但差异会很小。如此微小，以至于您甚至可能无法在并排比较中测量它们。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-13T16:43:16.663

我同意之前的答案，在这种情况下 COMMIT 和 ROLLBACK 之间没有区别。确定没有任何内容可提交所需的 CPU 时间与确定没有任何内容可回滚所需的 CPU 时间之间的差异可能可以忽略不计。但是，如果差异可以忽略不计，我们可以放心地忘记它。

但是，值得指出的是，在单个事务的上下文中执行大量查询的会话与在一系列事务的上下文中执行相同查询的会话之间存在差异。

如果客户端启动事务，执行查询，执行 COMMITor ROLLBACK，然后启动第二个事务并执行第二个查询，则不能保证第二个查询将观察到与第一个查询相同的数据库状态。有时，维护数据的单一一致视图至关重要。有时，获取数据的最新视图至关重要。这取决于你在做什么。

我知道，我知道，OP没有问这个问题。但是有些读者可能会在他们的脑海中问这个问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-13T16:15:40.760

一般来说，COMMIT 比 ROLLBACK 快得多，但在你什么都不做的情况下，它们实际上是相同的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-13T22:18:10.310

该文件指出：

*   Oracle 建议您在与 Oracle 数据库断开连接之前，使用 COMMIT 或 ROLLBACK 语句显式结束应用程序中的每个事务，包括最后一个事务。如果没有显式提交事务，程序异常终止，那么最后一个未提交的事务会自动回滚。大多数 Oracle 实用程序和工具的正常退出会导致提交当前事务。Oracle 预编译器程序的正常退出不会提交事务，而是依赖 Oracle 数据库回滚当前事务。

[http://download.oracle.com/docs/cd/B28359_01/server.111/b28286/statements_4010.htm#SQLRF01110](http://download.oracle.com/docs/cd/B28359_01/server.111/b28286/statements_4010.htm#SQLRF01110)

如果你想选择做一个或另一个，那么你还不如做一个和什么都不做一样的事情，然后就去做。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-21T20:27:06.270

好吧，我们必须考虑 SELECT 在 Oracle 中返回的内容。有两种模式。默认情况下，SELECT 返回数据，因为数据在 SELECT 语句开始执行的那一刻开始执行（这是 READ COMMITTED 隔离模式的默认行为，默认的事务模式）。因此，如果在发出 SELECT 之后执行了 UPDATE/INSERT，则结果集中将不可见。

如果您需要比较两个结果集（例如总账应用程序的债务方和贷方方），这可能会成为问题。为此，我们有第二种模式。在该模式下，SELECT 返回当前事务开始时的数据（READ ONLY 和 SERIALIZABLE 隔离级别的默认行为）。

因此，至少有时需要在事务中执行 SELECT。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-13T16:07:10.463

由于您没有做过任何 DML，我怀疑 Oracle 中的 COMMIT 和 ROLLBACK 之间没有区别。无论哪种方式，都无事可做。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-04-07T10:52:47.913

我认为 Commit 会更有效；因为通常您希望提交大多数数据库事务；所以你会认为数据库针对这种情况进行了优化（而不是试图更有效地进行回滚）。

# visual-studio - Visual Studio 中的 MSDN 链接

> ID：198111
> 
> 赞同：4
> 
> 时间：2008-10-13T16:05:36.647
> 
> 标签：visual-studio, plugins, msdn

我正在寻找一个插件或方法来简单地从我的 .Net 代码中的任何命名空间、类型、方法、属性等转到通过上下文菜单项或类似超链接的机制覆盖它的 MSDN 页面。有谁知道会这样做吗？

右键单击时的“转到定义”选项*几乎*涵盖了这一点，但它的效果还不够好 - 不支持命名空间，并且您经常会看到丑陋的元数据页面。我还在使用vs2005，所以如果vs2008在这方面更好，我想知道它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-13T17:06:16.413

你试过F1吗？这将自动打开相应方法或对象的帮助。不确定这是否适用于命名空间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T17:19:14.953

除了使用 F1（它并不总是有效）之外，我还没有找到 VS 的加载项来执行此操作，我还有另一种快速解决方法。

我使用 Launchy（来自 launchy.net）并设置了 Weby 插件，这样我就可以快速进行 MSDN 搜索。因此，如果我正在寻找 String.Format，我的仅键盘序列（来自 VS 或其他任何地方）将是这样的：

alt-空格 MSDN String.Format

这使我直接进入 MSDN 搜索，通常第一个列表就是我要查找的内容。这不是一个完美的解决方案，但拥有快速的互联网连接和仅使用键盘的方法对我来说效果很好。

# windows - 如何同步安装 MSI？

> ID：198114
> 
> 赞同：9
> 
> 时间：2008-10-13T16:06:30.840
> 
> 标签：windows, windows-installer

要对任何 MSI 软件包进行无人值守安装，只需使用以下命令：

```
msiexec /qn /i package.msi 
```

但是，这会触发异步安装：如果您碰巧链接了 2 个依赖安装，您将不得不以某种方式等待第一个安装完成。

有没有办法从命令行做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-18T19:17:01.247

我很幸运：

```
start /wait msiexec /i MyInstaller.msi ... 
```

[在 2005 年的这篇博](http://blogs.msdn.com/b/heaths/archive/2005/11/15/493236.aspx)文中找到。希望你能在 08 年找到它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-13T16:09:19.133

我们曾多次使用各种产品遇到这种情况，我最终使用了一个小型外部程序来启动每个 msi 并等待它完成以启动下一个。您可能可以在像 vbscript 这样轻量级的东西中做到这一点，但当时我们想要更多的 gui，所以我们有一个更大的外部程序。

# actionscript - Actionscript - 将 AS2 资产组合成一个 SWF

> ID：198119
> 
> 赞同：0
> 
> 时间：2008-10-13T16:09:00.163
> 
> 标签：actionscript, flash, actionscript-2

我有一个 Flash 项目，我试图将其导出为单个 SWF。有一个主 SWF 文件可以加载大约 6 个其他 SWF，主 SWF 和子 SWF 都引用其他外部资源（图像、声音等）。我想将所有内容打包为单个 .swf 文件，这样我就不必将其他资产与 .swf 一起打包。

所有的编码都在时间轴中完成，但资产尚未导入 Flash 创作环境，我现在没有时间这样做（到处都有太多对它们的引用）。我希望我只是缺少一个允许这种打包导出的选项，但我还没有找到类似的东西。

我无法访问 Flex 或 mxmlc（由于 AS 是基于时间线的，它们不一定会帮助我）。有什么想法吗？

谢谢！

PS ...如果没有办法完全按照我所说的那样做，我可以处理将所有资产放在“资产”文件夹或类似的东西中，所以我只是带着 main.swf 和资产文件夹。这里的问题是对资产的所有引用都假定它们与 main.swf 文件位于同一文件夹中，因此一切都假定为本地...有没有办法更改 Flash 中所有外部引用的范围（例如，代码中的所有本地引用实际上都在 /assets 中搜索）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-12T01:41:52.163

您*也许*可以使用 swfmill/mtasc 将您的 swf 反编译为 XML，并使用精美的 XSLT 重新组合它们并使用 swfmill/mtasc 重新编译。

如果这不起作用并且如果您使用的是 MovieClip.loadMovie 或 MovieClipLoader.loadMovie，您可以重载它们的方法并拦截 url：

```
var realLoadMovie:Function = MovieClip.prototype.loadMovie;

MovieClip.prototype.loadMovie = function(url:String, method:String) {
    return realLoadMovie("assets/" + url, method);
}

var test:MovieClip = createEmptyMovieClip("testclip", getNextHighestDepth());
test.loadMovie("test.swf"); 
```

如果 url 具有资源类型前缀（例如 file://），则需要进行一些额外的字符串解析

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-17T23:29:23.710

当您嵌入 swf 时，您可以添加一个基本参数，就像对齐、缩放等一样。如果设置了 base，所有相对 url 将以您定义的任何路径作为前缀（嗯，几乎所有；视频和文件引用对象是这里例外）。除此之外，我会选择 nikaji 的解决方案。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-10-13T16:15:52.287

嗨贾斯汀，

听起来您需要考虑使用共享库。查看：

[http://kb.adobe.com/selfservice/viewContent.do?externalId=tn_14767](http://kb.adobe.com/selfservice/viewContent.do?externalId=tn_14767)

# java - 如何替换当前的 Java 进程，例如 unix 风格的 exec？

> ID：198122
> 
> 赞同：5
> 
> 时间：2008-10-13T16:09:20.570
> 
> 标签：java, windows-services

我有一个用 Java 编写的服务器，它作为 Windows 服务运行（感谢 Install4J）。我希望这个服务能够下载它运行的 JAR 文件的最新版本，并开始运行新代码。针是我不希望 Windows 服务完全退出。

理想情况下，我会通过 unix 风格的 exec() 调用来停止当前版本并运行新版本来完成此操作。我怎样才能最好地做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-13T16:29:06.833

据我所知，在 Java 中没有办法做到这一点。

我想您可以通过使用 Java[`Runtime.exec`](http://java.sun.com/javase/6/docs/api/java/lang/Runtime.html#exec(java.lang.String))或[`ProcessBuilder`](http://java.sun.com/javase/6/docs/api/java/lang/ProcessBuilder.html)start() 命令（启动新进程）然后让当前进程结束来解决它……文档状态

> 当没有更多对 Process 对象的引用时，子进程不会被终止，而是子进程继续异步执行。

我假设如果父级完成并且被垃圾收集也是如此。

问题是 Runtime.exec 的进程将不再有有效的输入、输出和错误流。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T17:49:08.497

这是一种复杂但可移植的方式。

将您的代码分成两个罐子。一个非常小的罐子只是用来管理进程启动。它创建一个 ClassLoader，在其类路径中保存另一个 jar。

当你想加载一个新版本时，你终止所有从旧 jar 运行代码的线程。从旧 jar 中删除对类实例的所有引用。清空对加载旧 jar 的 ClassLoader 的所有引用。此时，如果您没有遗漏任何内容，那么旧的类和 ClassLoader 应该可以进行垃圾回收了。

现在，您从一个指向新 jar 的新 ClassLoader 实例重新开始，并重新启动您的应用程序代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-13T23:51:52.897

[Java Service Wrapper](http://wrapper.tanukisoftware.org/doc/english/download.jsp)可以做到这一点以及更多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T17:55:17.780

您可以使用内置的重新加载功能，例如 Tomcat、Jetty 或 JBoss，它们可以作为服务运行，您不必将它们用作 Web 容器或 Java EE 容器。

其他选项是 OSGi，以及您自己的类加载功能。

但请注意在生产环境中重新加载。它并不总是最好的解决方案。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-10-13T16:59:09.033

一般的做法：

```
import java.io.BufferedInputStream;
import java.util.Arrays;

public class ProcessSpawner {    
public static void main(String[] args) {
    //You can change env variables and working directory, and
    //have better control over arguments.
    //See [ProcessBuilder javadocs][1]
    ProcessBuilder builder = new ProcessBuilder("ls", "-l");

    try {
        Process p = builder.start();
        //here we just echo stdout from the process to java's stdout.
        //of course, this might not be what you're after.
        BufferedInputStream stream = 
            new BufferedInputStream(p.getInputStream());
        byte[] b = new byte[80];
        while(stream.available() > 0) {                 
            stream.read(b);
            String s = new String(b);
            System.out.print(s);
            Arrays.fill(b, (byte)0);
        }
        //exit with the exit code of the spawned process.
        System.exit(p.waitFor());

    } catch(Exception e) {
        System.err.println("Exception: "+e.getMessage());
        System.exit(1);
    }
  }
} 
```

# c++ - 如何获取特定用户的 Windows“特殊文件夹”的路径？

> ID：198124
> 
> 赞同：10
> 
> 时间：2008-10-13T16:09:48.557
> 
> 标签：c++, windows, winapi

在服务内部，为特定用户确定特殊文件夹路径（例如“我的文档”）的最佳方式是什么？SHGetFolderPath 允许您传递令牌，因此我假设有某种方法可以模拟您感兴趣的文件夹的用户。

有没有办法仅基于用户名来做到这一点？如果不是，您需要为用户帐户提供的最少信息量是多少？我宁愿不必要求用户的密码。

（这是一个[相关的问题](https://stackoverflow.com/questions/131716/get-csidllocalappdata-path-for-any-user-on-windows)。）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-13T16:25:06.030

请不要进入注册表查找此信息。在 Windows 的未来版本中，该位置可能会发生变化。请改用 SHGetFolderPath。

[http://msdn.microsoft.com/en-us/library/bb762181(VS.85).aspx](http://msdn.microsoft.com/en-us/library/bb762181(VS.85).aspx)

编辑：看起来[LogonUser](http://msdn.microsoft.com/en-us/library/aa378184(VS.85).aspx)将为您需要的其他用户提供令牌。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-13T16:35:15.510

您可以尝试调用[ImpersonateLoggedOnUser()](http://msdn.microsoft.com/en-us/library/aa378612(VS.85).aspx)来修改另一个用户的用户令牌，然后将其传递给 SHGetFolderPath()。根据 ImpersonateLoggedOnUser() 的文档，您似乎可以调用 LogonUser() 来获取特定用户的令牌。

仅仅通过阅读，我猜想相关用户必须以某种形式登录才能使其正常工作。我记得有一页说必须安装用户的注册表配置单元才能使其正常工作（我想这是有道理的）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-14T02:35:11.960

我会挂载用户的注册表配置单元并查找路径值。是的，由于所有提到的原因（前向兼容性差等），这是一个次优的解决方案。但是，与 Windows 中的许多其他东西一样，MS 没有提供 API 方式来做您想做的事情，因此它是可用的最佳选择。

您可以使用[LookupAccountName](http://msdn.microsoft.com/en-us/library/aa379159.aspx)获取用户的 SID（不是 GUID） 。[您可以使用LoadUserProfile](http://msdn.microsoft.com/en-us/library/bb762281.aspx)加载用户的注册表配置单元，但不幸的是，这也需要用户令牌，这将需要他们的密码。幸运的是，您可以使用[RegLoadKey](http://msdn.microsoft.com/en-us/library/ms724889(VS.85).aspx)手动将配置单元加载到任意位置，读取数据并卸载它（我认为）。

是的，这很痛苦，是的，它可能会在未来的 Windows 版本中出现问题。也许到那个时候，MS 会提供一个 API 来做这件事，将它向后移植到旧版本的 Windows 中，并通过 Windows 更新自动分发它......但我不会屏住呼吸。

PS 此信息旨在补充您在相关问题中提供的信息，包括免责声明。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2008-10-13T16:14:04.537

此信息存储在注册表项“HKEY_USERS\S-1-5-21-616815238-485949776-2992451252-3228\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders”中。

“S-1-5-21-616815238-485949776-2992451252-3218”是用户的 GUID。您需要获取此 GUID 才能找到相应的密钥并读取它。

在[此](http://weseetips.com/2008/05/01/how-to-get-the-path-of-special-folders-in-windows/)示例中，他们使用您提到的 SHGetFolderPath 函数，并且有一个包含所有特殊文件夹的列表，这可能会有所帮助。

**注意：** Microsoft 不鼓励使用注册表项，因为它仍然存在只是为了向后兼容

# javascript - 是否有一个 textarea/富文本编辑器允许用户在输入时跟随在其中呈现的链接？

> ID：198129
> 
> 赞同：1
> 
> 时间：2008-10-13T16:11:12.453
> 
> 标签：javascript, html, fckeditor, richtext

我正在寻找类似 FCKEditor 之类的东西，它允许用户通过左键单击链接来跟踪链接。

例如，StackOverflow 中的降价编辑器不允许您在向编辑器中输入数据时单击添加的链接。我想呈现一个文本区域，其中预先填充了一些指向实验室结果的链接，用户可以在发表评论时选择查看这些链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-13T17:28:45.837

tinyMCE 和 fck 编辑器都将以蓝色突出显示链接，如果您 ctrl+单击它们，将在新选项卡/窗口中打开（取决于您的浏览器配置）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-28T02:09:24.507

或者您可以尝试预览模式，就像 StackOverflow 一样。请参阅[如何在 ASP.Net 站点中启用 FCKeditor 的实时预览？](https://stackoverflow.com/questions/293854/how-can-i-enable-live-preview-for-fckeditor-in-an-asp-net-site)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T16:16:20.150

大多数 HTML 富文本不会对链接做任何事情（除了您可以通过单击左键将光标放在其中以编辑其文本），这会阻止您例如右键单击打开链接，复制它，或者您的浏览器允许的任何内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T16:22:22.930

[TinyMCE](http://tinymce.moxiecode.com)允许您在同一页面内预览，然后通过单击按钮/图标单击任何链接。我认为必须有一种方法可以在 TinyMCE 之外触发它，并可能让它填充另一个字段/区域。（您可能还可以获取 textarea 的值并将其放在页面的其他位置。）

不确定这是否是您正在寻找的。

# arrays - VB中什么速度更快？从数组中删除一个元素还是插入一个？

> ID：198135
> 
> 赞同：-2
> 
> 时间：2008-10-13T16:12:40.047
> 
> 标签：arrays, optimization, vb6

哪个更快？someCondition 为真的概率与它为假的概率相同。

插入：

```
arrayList = Array("apple", "pear","grape")
if someCondition then
    ' insert "banana" element
end if 
```

删除：

```
arrayList = Array("apple","banana","pear","grape")
if not someCondition then
    ' remove "banana" element
end if 
```

看起来它完全取决于插入和删除的实现。那么，一般来说，哪个更快？我倾向于插入，因为我读过可以使用 CopyMemory 插入而无需循环。删除也是一样的吗？有人有例子吗？

编辑：这是 VB6，而不是 VB.NET。出于显示原因，我必须使用插入而不是附加。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-13T16:27:25.040

两者的性能大致相同，因为两者都需要创建一个新数组。数组是固定大小的连续结构。

为了在插入时保持这一点，必须使用附加元素创建一个新数组。所有现有值都被复制到数组中的新位置，然后添加插入的元素。

为了在删除时保持这一点，必须创建一个少一个元素的新数组。然后必须将除删除之外的所有现有条目复制到新数组中。

这两个操作在几乎相同的大小上具有基本相同的操作。性能不会有显着差异。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T16:28:24.260

对于删除，删除项目之后的每个项目都必须向下移动。

对于插入，必须为新项目找到空间。如果可以吞并的数组后面有空的空间，那么这不会花时间，唯一花费的时间是在新项目之后的每个项目更多，以便在中间腾出空间。

如果本地没有可用空间，则必须分配一个全新的数组并复制每个项目。

因此，当考虑添加或删除相同的数组位置时，插入可能与删除一样快，但可能要长得多。插入不会更快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T16:15:03.117

我找到了一个例子，表明一个人也可以在不循环的情况下删除。它看起来比要插入的代码更简单。

```
Public Sub RemoveArrayElement_Str(AryVar() As String, ByVal _
    RemoveWhich As Long)
    '// The size of the array elements
    '// In the case of string arrays, they are
    '// simply 32 bit pointers to BSTR's.
    Dim byteLen As Byte

    '// String pointers are 4 bytes
    byteLen = 4

    '// The copymemory operation is not necessary unless
    '// we are working with an array element that is not
    '// at the end of the array
    If RemoveWhich < UBound(AryVar) Then
        '// Copy the block of string pointers starting at
        ' the position after the
        '// removed item back one spot.
        CopyMemory ByVal VarPtr(AryVar(RemoveWhich)), ByVal _
            VarPtr(AryVar(RemoveWhich + 1)), (byteLen) * _
            (UBound(AryVar) - RemoveWhich)
    End If

    '// If we are removing the last array element
    '// just deinitialize the array
    '// otherwise chop the array down by one.
    If UBound(AryVar) = LBound(AryVar) Then
        Erase AryVar
    Else
        ReDim Preserve AryVar(UBound(AryVar) - 1)
    End If
End Sub 
```

[http://www.vb-helper.com/howto_delete_from_array.html](http://www.vb-helper.com/howto_delete_from_array.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T16:15:09.357

我不得不猜测插入，因为它总是可以追加，而删除你必须担心漏洞。

但是什么版本的vb？如果您在 .Net 中执行删除或插入操作，则根本不应该为此使用数组。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-13T17:41:07.590

关于主题但不是一个完整的答案：

插入和删除不是适用于数组的应用程序。它超越了“优化”并进入了糟糕的编程。

如果这隐藏在调用结构的底部并且有人最终重复调用它，您可能会受到严重的性能影响。在一种情况下，我将数组插入排序更改为仅使用链表，并将运行时间从 10+小时（锁定机器）更改为秒/分钟）。

它正在用 ip 地址填充一个列表框。正如在 c 类地址空间上设计和测试的那样，它运行良好，但我们要求在 b 类地址空间上工作而不会失败（可能需要一段时间，但不是几个小时）。我们的任务是尽可能减少重构以使其不会失败。

不要假设你知道你的 hack 将如何被使用。

# sql - 在 postgres 中复制表（包括索引）

> ID：198141
> 
> 赞同：94
> 
> 时间：2008-10-13T16:14:08.517
> 
> 标签：sql, postgresql, indexing

我有一个 postgres 表。我需要从中删除一些数据。我打算创建一个临时表，复制数据，重新创建索引并删除我需要的行。我不能从原始表中删除数据，因为这个原始表是数据的来源。在一种情况下，我需要获得一些取决于删除 X 的结果，在另一种情况下，我需要删除 Y。所以我需要所有原始数据始终存在并且可用。

但是，重新创建表并再次复制并重新创建索引似乎有点愚蠢。无论如何在 postgres 中告诉它“我想要这个表的完整单独副本，包括结构、数据和索引”？

不幸的是，PostgreSQL 没有“CREATE TABLE .. LIKE X INCLUDING INDEXES”

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2009-07-03T12:34:33.243

新 PostgreSQL（根据 docs 自 8.3 起）可以使用“包括索引”：

```
# select version();
                                             version
-------------------------------------------------------------------------------------------------
 PostgreSQL 8.3.7 on x86_64-pc-linux-gnu, compiled by GCC cc (GCC) 4.2.4 (Ubuntu 4.2.4-1ubuntu3)
(1 row) 
```

如您所见，我正在 8.3 上进行测试。

现在，让我们创建表：

```
# create table x1 (id serial primary key, x text unique);
NOTICE:  CREATE TABLE will create implicit sequence "x1_id_seq" for serial column "x1.id"
NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "x1_pkey" for table "x1"
NOTICE:  CREATE TABLE / UNIQUE will create implicit index "x1_x_key" for table "x1"
CREATE TABLE 
```

看看它的样子：

```
# \d x1
                         Table "public.x1"
 Column |  Type   |                    Modifiers
--------+---------+-------------------------------------------------
 id     | integer | not null default nextval('x1_id_seq'::regclass)
 x      | text    |
Indexes:
    "x1_pkey" PRIMARY KEY, btree (id)
    "x1_x_key" UNIQUE, btree (x) 
```

现在我们可以复制结构：

```
# create table x2 ( like x1 INCLUDING DEFAULTS INCLUDING CONSTRAINTS INCLUDING INDEXES );
NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "x2_pkey" for table "x2"
NOTICE:  CREATE TABLE / UNIQUE will create implicit index "x2_x_key" for table "x2"
CREATE TABLE 
```

并检查结构：

```
# \d x2
                         Table "public.x2"
 Column |  Type   |                    Modifiers
--------+---------+-------------------------------------------------
 id     | integer | not null default nextval('x1_id_seq'::regclass)
 x      | text    |
Indexes:
    "x2_pkey" PRIMARY KEY, btree (id)
    "x2_x_key" UNIQUE, btree (x) 
```

如果您使用的是 8.3 之前的 PostgreSQL，您可以简单地使用带有选项“-t”的 pg_dump 来指定 1 个表，在转储中更改表名，然后再次加载它：

```
=> pg_dump -t x2 | sed 's/x2/x3/g' | psql
SET
SET
SET
SET
SET
SET
SET
SET
CREATE TABLE
ALTER TABLE
ALTER TABLE
ALTER TABLE 
```

现在表格是：

```
# \d x3
                         Table "public.x3"
 Column |  Type   |                    Modifiers
--------+---------+-------------------------------------------------
 id     | integer | not null default nextval('x1_id_seq'::regclass)
 x      | text    |
Indexes:
    "x3_pkey" PRIMARY KEY, btree (id)
    "x3_x_key" UNIQUE, btree (x) 
```

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2008-10-13T20:01:30.740

```
[CREATE [ [ GLOBAL | LOCAL ] { TEMPORARY | TEMP } ] TABLE table_name
    [ (column_name [, ...] ) ]
    [ WITH ( storage_parameter [= value] [, ... ] ) | WITH OIDS | WITHOUT OIDS ]
    [ ON COMMIT { PRESERVE ROWS | DELETE ROWS | DROP } ]
    [ TABLESPACE tablespace ]
    AS query][1] 
```

这是一个[例子](http://developer.postgresql.org/pgdocs/postgres/sql-createtableas.html)

```
CREATE TABLE films_recent AS
  SELECT * FROM films WHERE date_prod >= '2002-01-01'; 
```

从第一个创建新表的另一种方法是使用

```
 CREATE TABLE films_recent (LIKE films INCLUDING INDEXES);  

    INSERT INTO films_recent
         SELECT *
           FROM books
          WHERE date_prod >= '2002-01-01'; 
```

请注意，如果使用第二种方法，Postgresql 有一个[补丁](http://people.planetpostgresql.org/dfetter/index.php?/archives/158-Postgres-Weekly-News-February-10-2008.html)来修复表空间问题

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2019-12-11T12:07:53.340

网上有很多答案，其中一个可以在[这里](https://www.technologyscout.net/2015/04/postgresql-copy-a-table-structure-and-data/)找到。

我最终做了这样的事情：

```
create table NEW ( like ORIGINAL including all);
insert into NEW select * from ORIGINAL 
```

这将复制架构和数据，包括索引，但不包括触发器和约束。请注意，索引与原始表共享，因此当向任一表添加新行时，计数器将递增。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-13T20:29:52.807

> 我有一个 postgres 表。我需要从中删除一些数据。

我假设...

```
delete from yourtable
where <condition(s)> 
```

...由于某种原因无法正常工作。（愿意分享这个原因吗？）

> 我打算创建一个临时表，复制数据，重新创建索引并删除我需要的行。

查看 pg_dump 和 pg_restore。使用 pg_dump 和一些聪明的选项，也许在 pg_restoreing 之前编辑输出可能会奏效。

* * *

由于您正在对数据进行“假设”类型的分析，我想知道您是否最好使用视图。

您可以根据对要排除的内容的否定来为要测试的每个场景定义一个视图。即，根据您要包含的内容定义视图。例如，如果您想要在数据上“删除”X=Y 的行的“窗口”，那么您将创建一个视图作为 (X != Y) 的行。

视图存储在数据库中（在系统目录中）作为它们的定义查询。每次查询视图时，数据库服务器都会查找定义它的基础查询并执行该查询（与您使用的任何其他条件进行与运算）。这种方法有几个好处：

1.  您永远不会复制数据的任何部分。
2.  当您查询每个视图/场景时，将使用已用于基表（您的原始“真实”表）的索引（如查询优化器所认为的那样）。无需重新定义或复制它们。
3.  由于视图是基表中“真实”数据的“窗口”（不是快照），因此您可以在基表上添加/更新/删除，只需重新查询视图场景，无需重新创建任何内容数据随时间变化。

当然，有一个权衡。由于视图是虚拟表而不是“真实”（基本）表，因此每次访问它时实际上都在执行（可能是复杂的）查询。这可能会使事情变慢一点。但它可能不会。它取决于许多问题（数据的大小和性质、系统目录中统计信息的质量、硬件速度、使用负载等等）。在你尝试之前你不会知道。如果（且仅当）您确实发现性能慢得无法接受，那么您可能会考虑其他选项。（物化视图、表格副本……任何以空间换时间的东西。）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-06-20T19:04:24.197

一个简单的方法是包含所有：

```
CREATE TABLE new_table (LIKE original_table INCLUDING ALL); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-13T16:33:31.223

使用选择创建一个新表以获取所需的数据。然后将旧表换成新表。

```
create table mynewone as select * from myoldone where ...
mess (re-create) with indexes after the table swap. 
```

# sql-server - 如何为全文搜索中的不同列分配权重？

> ID：198152
> 
> 赞同：10
> 
> 时间：2008-10-13T16:17:17.450
> 
> 标签：sql-server, full-text-search

在我的全文搜索查询中，我想为特定列分配更高的权重。考虑这个查询：

```
SELECT Key_Table.RANK, FT_Table.* FROM Restaurants AS FT_Table
INNER JOIN FREETEXTTABLE(Restaurants, *, 'chilly chicken') AS Key_Table
ON FT_Table.RestaurantID = Key_Table.[KEY]
ORDER BY Key_Table.RANK DESC 
```

现在，我希望 Name 列在结果中具有更高的权重（Name、Keywords 和 Location 是全文索引的）。目前，如果在三列中的任何一列中找到结果，则排名不受影响。

例如，我希望名称为“Chilly Chicken”的行比关键字“Chilly Chicken”的行具有更高的排名，但要使用另一个名称。

编辑：

我不急于使用 ContainsTable，因为这意味着分离短语（Chilly AND Chicken 等），这将涉及我必须搜索所有可能的组合 - Chilly AND Chicken、Chilly OR Chicken 等。我想要FTS 引擎自动找出最匹配的结果，我认为 FREETEXT 以这种方式做得很好。

如果我误解了 CONTAINS/CONTAINSTABLE 的工作原理，我深表歉意。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-13T21:23:35.193

最好的解决方案是使用 ContainsTable。使用联合创建一个搜索所有 3 列的查询，并添加一个整数来指示搜索了哪一列。按该整数对结果进行排序，然后对 desc 进行排序。

等级是 sql server 内部的，不是您可以调整的。

您还可以通过将排名除以整数来操作**返回的排名（名称将除以 1，关键字和位置除以 2 或更高）。**这会导致出现不同的排名。

下面是一些 sql 示例
：--推荐使用 start change tracking 和 start background updateindex (see books online)

```
    SELECT 1 AS ColumnLocation, Key_Table.Rank, FT_Table.* FROM Restaurants AS FT_Table
 INNER JOIN ContainsTable(Restaurant, Name, 'chilly chicken') AS Key_Table ON
FT_Table.RestaurantId = Key_Table.[Key]

UNION SELECT 2 AS ColumnLocation, Key_Table.Rank, FT_Table.* FROM Restaurants AS FT_Table
 INNER JOIN ContainsTable(Restaurant, Keywords, 'chilly chicken') AS Key_Table ON
FT_Table.RestaurantId = Key_Table.[Key]

UNION SELECT 3 AS ColumnLocation, Key_Table.Rank, FT_Table.* FROM Restaurants AS FT_Table
 INNER JOIN ContainsTable(Restaurant, Location, 'chilly chicken') AS Key_Table ON
FT_Table.RestaurantId = Key_Table.[Key]

按列位置排序，排名 DESC

```

在生产环境中，我会将查询的输出插入到表变量中，以在返回结果之前执行任何其他操作（在这种情况下可能没有必要）。此外，避免使用 *，只需列出您真正需要的列。

编辑：使用 ContainsTable 是对的，您必须将关键字修改为“chilly*”和“chicken*”，我使用对输入短语进行标记的过程来执行此操作。如果您不想这样做，只需将上面的每个 ContainsTable 实例替换为 FreeTextTable，查询仍将正常工作。

# html - 为什么 CSS min-width 属性不强制 div 具有指定的最小宽度？

> ID：198153
> 
> 赞同：19
> 
> 时间：2008-10-13T16:18:15.387
> 
> 标签：html, css

```
<html>
    <head>
        <style type="text/css">
            div {
                border:1px solid #000;
                min-width: 50%;
            }
        </style>
    </head>
    <body>
        <div>This is some text. </div>
    </body>
</html> 
```

我相信 div 应该占页面的 50%，除非由于某种原因，div 内的文本使其变大。但是，div 周围的边框会延伸到整个页面宽度。这发生在 IE 和 Firefox 中。

建议？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-13T20:36:34.243

> 我相信 div 应该占页面的 50%，除非由于某种原因，div 内的文本使其变大。

`min-width`没有设置你的块将增长的最小起始宽度；相反，它限制了块可以收缩的程度。

在`min-width: 50%;`中，`50%`是对包含块的引用。我从来没有使用百分比`min-width`，但我发现它对其他单位很有用。例如，如果我有一个想要全宽的块（如一列文本），但我不希望它低于最小宽度，我可以使用类似`{width: 100%; min-width: 250px;}`.

请注意其他人提到的有关 IE 支持的警告。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-13T16:22:52.320

如果您为`absolute`元素提供定位，它将`50%`在 Firefox 中。但是，IE 不喜欢`min-width`or`min-height`属性，因此您必须定义宽度`50%`才能使其在 IE 中工作。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-13T17:14:31.950

如果没有`min-width`，您的 div 将占用整个页面宽度，这就是`display:block`元素的行为方式。添加`min-width`不能使它变小。

将属性更改`display`为`absolute`或`float`属性`left`将使元素缩小以适合内容。然后，`min-width`开始讲道理。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-13T16:32:36.590

补充一下[Chris Serra 所说](https://stackoverflow.com/questions/198153/why-does-the-css-min-width-attribute-not-force-a-div-to-have-the-specified-mini#198165)的，在 IE < 7（和 7？这些天我无法跟踪，但绝对是 < 8）中，其行为与应有的`width`行为完全相同。`min-width`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-14T16:26:29.520

你告诉它最小宽度是 50%。由于没有其他东西占用空间，它将占用所有空间（边距除外）。

如果你给它一个 75% 的最大宽度，firefox 应该把它限制在这个范围内。IE6 仍然会忽略它。

正如 David Kolar 已经说过的，我们中的许多人通常不使用百分比来表示最小宽度。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-07T20:44:28.823

您可能想尝试使用 IE 特定的样式表并包含和表达式，例如：

```
print("width:expression(document.body.clientWidth < 1024? "50%" : "100%");"); 
```

这将根据加载时浏览器窗口的宽度更改宽度设置。我个人喜欢使用 px 作为单位度量，但您需要根据您的特定设置进行尝试。

# windows - xcopy /排除问题

> ID：198155
> 
> 赞同：2
> 
> 时间：2008-10-13T16:18:53.030
> 
> 标签：windows, batch-file, xcopy

我正在尝试运行 xcopy 来复制不包括 .obj 等的文件。我看到的是，当我的 excludes.txt 文件包含 .obj 作为扩展名时，Microsoft.Practices.ObjectBuilder.dll 不会被复制。当 .obj 被删除时，我 Microsoft.Practices.ObjectBuilder.dll 被正确复制。但这不会发生在其他 dll 上。

有谁知道为什么会发生这种情况？

谢谢！

列尼克

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-13T17:02:10.900

是的，xcopy 就是那样愚蠢。

做这个：

```
dir /b *.obj >excludes.txt
xcopy * /exclude:excludes.txt targetdir 
```

尽管有时这仍然会出现问题。

例如，如果您有一个名为**practice.obj**的文件，它不会复制它，但它也无法复制您的 Microsoft。**实践**.ObjectBuilder.dll

一个方便的技巧是，如果您在 dir 上指定 /s，您将获得递归*和*完整路径，然后如果您在 xcopy 上完全指定源目录，则排除项必须从头开始匹配：

```
dir /s /b *.obj >excludes.txt
xcopy c:\sourcedir\* /exclude:excludes.txt \targetdir 
```

现在 Microsoft.Practices.ObjectBuilder.dll 只有在您碰巧在同一目录中有 Microsoft.Practices.obj 文件时才会复制失败。得到它？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-13T16:21:21.013

我猜是因为子字符串 .obj 在名称 Microsoft.Practices**.Obj**ectBuilder.dll 中找到，并且由于 windows 不区分大小写，因此它将排除它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-13T17:23:50.340

无论如何， XCOPY 现在已被[弃用](http://blogs.msdn.com/matt_pietrek/archive/2007/01/16/robocopy-built-into-vista.aspx)，所以我怀疑事情会得到解决。看看 ROBOCOPY - 它内置于 Vista 中，并包含在[2003 和 XP](http://www.microsoft.com/downloads/details.aspx?familyid=9d467a69-57ff-4ae7-96ee-b18c4790cffd&displaylang=en)的资源工具包中。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2008-10-13T16:23:34.130

答案是您可以通过键入以下内容获得的信息：

```
xcopy /? 
```

即：

> /EXCLUDE:file1[+file2][+file3]...
> 指定包含字符串的文件列表。每个字符串应位于文件中的单独行中。当任何字符串与要复制的文件的绝对路径的任何部分匹配时，该文件将被排除在复制之外。例如，指定像 \obj\ 或 .obj 这样的字符串将分别排除目录 obj 下的所有文件或所有具有 .obj 扩展名的文件。

# c# - 我可以在 c# 中告诉 ActiveRecord 类的表名吗？

> ID：198157
> 
> 赞同：1
> 
> 时间：2008-10-13T16:20:29.547
> 
> 标签：c#, castle-activerecord

我正在尝试验证架构是否与我正在初始化的对象匹配。

除了简单地反映类名之外，还有其他方法可以获取类的 TableName 吗？

我正在使用一些具有显式 TableNames 的类

编辑：使用乔的解决方案，我添加了不指定表名的情况，它可能使用约束

```
public string find_table_name(object obj)
{
        object[] attribs = obj.GetType().GetCustomAttributes(typeof(Castle.ActiveRecord.ActiveRecordAttribute), false);

        if (attribs != null)
        {
            ActiveRecordAttribute attrib = (Castle.ActiveRecord.ActiveRecordAttribute) attribs[0];
            if (attrib.Table != null)
                return attrib.Table;
            return obj.GetType().Name;
        }
    return null;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-13T16:58:21.017

如果您有以下情况：

```
[ActiveRecord(Table = "NewsMaster")]
public class Article
{
    [PrimaryKey(Generator = PrimaryKeyType.Identity)]
    public int NewsId { get; set; }

    [Property(Column = "NewsHeadline")]
    public string Headline { get; set; }

    [Property(Column = "EffectiveStartDate")]
    public DateTime StartDate { get; set; }

    [Property(Column = "EffectiveEndDate")]
    public DateTime EndDate { get; set; }

    [Property]
    public string NewsBlurb { get; set; }
} 
```

这将为您提供表名：

```
 [Test]
    public void Can_get_table_name()
    {
        var attribs = typeof(Article).GetCustomAttributes(typeof(Castle.ActiveRecord.ActiveRecordAttribute), false);

        if (attribs != null)
        {
            var attrib = (Castle.ActiveRecord.ActiveRecordAttribute) attribs[0];
            Assert.AreEqual("NewsMaster", attrib.Table);
        }
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-28T12:18:51.030

您还可以使用：

```
ActiveRecordModel.GetModel(typeof(Article)).ActiveRecordAtt.Table 
```

看到[这个测试用例](http://svn.castleproject.org:8080/svn/castle/trunk/ActiveRecord/Castle.ActiveRecord.Tests/PluralizationTestCase.cs)

# jquery - 你如何使用 jQuery 来简化你的 MVC 视图？

> ID：198174
> 
> 赞同：6
> 
> 时间：2008-10-13T16:25:08.867
> 
> 标签：jquery, asp.net-mvc, model-view-controller

我发现 jQuery 是一个很好的工具来简化我的 MVC 视图。

例如，我没有包含复杂的逻辑来向我的表格添加交替样式，而是这样做......

```
$(document).ready(function() {
   $("table.details tr:odd").addClass("detailsAlternatingRow");
   $("table.details tr:even").addClass("detailsRow");                          
}); 
```

你知道 jQuery 的任何其他好的用途来减少我的 MVC 视图中的逻辑吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-13T18:36:44.220

MVC 框架有一个 JsonResult 可以很好地消除服务器往返，并且可能能够摆脱视图页面中的一些逻辑。我写了一个关于这个的教程：

[http://www.dev102.com/2008/08/19/jquery-and-the-aspnet-mvc-framework/](http://www.dev102.com/2008/08/19/jquery-and-the-aspnet-mvc-framework/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-13T16:30:07.970

实现观察者[http://google-ajax-examples.googlecode.com/svn/trunk/customevents/jquery.html](http://google-ajax-examples.googlecode.com/svn/trunk/customevents/jquery.html)被证明是一个非常好的实践。非常适合代码维护。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T16:45:37.360

请注意，如果您在服务器上使用 PHP，则可以使用[phpQuery](http://code.google.com/p/phpquery/)（我确信其他语言也有类似的服务器端 jQuery 端口）来执行类似的操作，而无需期望用户启用 Javascript。

# eclipse - 在Eclipse中格式化时如何指定类成员的顺序

> ID：198177
> 
> 赞同：3
> 
> 时间：2008-10-13T16:26:27.960
> 
> 标签：eclipse

在 Eclipse IDE 中，如何自定义 Java 代码样式格式化程序以使其按指定顺序对类成员进行排序，例如按可见性对所有实例方法进行分组？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-13T16:28:45.023

如果问题是，“你如何自定义'Source -> Format'命令来重新排序成员？”，我认为它不能做到。要更改用于“源 -> 排序成员”命令的顺序，请更改“成员排序顺序”首选项：“窗口 -> 首选项 -> Java -> 外观 -> 成员排序顺序”

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-09-22T05:33:38.813

我不确定他们何时添加了此功能，但它似乎在 3.5 中存在：

窗口 -> 首选项

Java -> 编辑器 -> 保存操作

其他操作 -> 配置 ...

代码组织 -> 成员 -> 排序成员

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-12-10T19:45:46.610

另一种方法是执行代码清理：

设置排序顺序：

1 - 窗口 -> 首选项 -> Java -> 外观 -> 成员排序顺序 - 选中“按可见性对同一类别中的成员进行排序

2 - Window -> Preferences ... Java -> Code Style -> Clean up ... 在代码组织中，选择排序成员

清理：

3 - 在您的 java 源代码上，右键单击 -> 源代码 -> 清理。

# .net - 托管 Windows 工作流设计器

> ID：198191
> 
> 赞同：2
> 
> 时间：2008-10-13T16:33:07.853
> 
> 标签：.net, workflow, hosting, workflow-foundation

有没有人有托管 Windows 工作流设计器表面的经验？我在 MSDN 上看到了一些相当难以理解的示例，但仅此而已 - 当然没有任何内容可以解释清楚或易于阅读的托管 WF 的过程......是否有更好的托管资源WF（或类似工作流程的设计表面 - 我不一定与 WF 相关联）实际上**有意义**吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-13T16:42:19.457

如果你想从代码中学习，有一个来自 MSDN 的参考应用程序。

[WF Sample Workflow Designer Visual Studio 2005 解决方案](http://www.microsoft.com/downloads/details.aspx?familyid=3a331d20-44d4-4fb4-a833-f6ec9aee1b82&displaylang=en)

工作流设计器的开发人员维护了一个博客。一旦我能够将其挖掘出来，将立即更新该帖子。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-13T21:13:17.570

从我在[这里](http://download.microsoft.com/download/5/9/B/59B74A2A-245D-4304-802E-E0A0800FACD3/Dublin__NET_4_overview.docx)读到的关于 WF 4.0 的一点点，比如：

> *   更新的视觉设计师
>     *   更易于最终用户使用
>     *   更容易由 ISV 重新托管
>     *   能够调试 XAML
> *   新的工作流流程控制模型
>     *   流程图、规则

我建议在PDC（10月底）等待公告

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-29T19:56:53.870

还有几本书描述了如何托管工作流设计器。例如 Pro WF 书籍（作者 Bruce Bukovics）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-30T06:42:46.827

不幸的是，在 WF 3.x 中重新托管设计器并不是非常简单，并且需要您对设计器架构有所了解。MS 正在考虑在下一个版本中改进这一点（甚至还不是测试版，但他们今天在 PDC 上讨论了这个）。

提问者的问题 - 你提到的文章之一是这个吗？

[http://msdn.microsoft.com/en-us/library/aa480213.aspx](http://msdn.microsoft.com/en-us/library/aa480213.aspx)

我想理解的最大希望大概是先下载代码示例，并尝试与文章并行阅读。

# jsf - JSF/CSS 属性冲突

> ID：198193
> 
> 赞同：2
> 
> 时间：2008-10-13T16:34:32.077
> 
> 标签：jsf

这是我们的第一个 JSF 应用程序，我正在将我们的图形设计师的 CSS 集成到我们的 facelets 文件中。他告诉我，他需要input 标签的**name**和**id**属性与 label 标签的**for属性相同。**

他的要求：

```
<label for="username">User Name:</label>
<input id="username" type="text" name="username" /> 
```

但是，当 JSF 代码呈现 HTML 时，我会在这些属性中获得额外的标识符。

我的小脸代码：

```
<label for="username">User Name:</label>
<h:inputText value="#{login.username}" id="username" name="username" /> 
```

发送到浏览器的最终 XHTML：

```
<label for="username">User Name:</label>
<input id="j_id2:username" type="text" name="j_id2:username" /> 
```

从 JSF 的角度来看，这对我来说是有意义的，但是我有没有办法满足我们平面设计师的要求并让每个人都开心？或者这是一个糟糕的 JSF 疏忽？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-13T16:49:39.753

您可以使用 JSF outputLabel 标记，它应该自动处理 id：

```
<h:inputText id="username">
    <h:outputLabel for="username" value="User Name: "/>
</h:inputText> 
```

**编辑：**为避免混淆：您还可以将 outputLabel 放在 inputText 元素之外。我只是像这样使用它。

# sql - 何时使用 SQL 表别名

> ID：198196
> 
> 赞同：31
> 
> 时间：2008-10-13T16:35:44.667
> 
> 标签：sql, database, table-alias

我很想知道人们是如何使用表别名的。我工作的其他开发人员总是使用表别名，并且总是使用 a、b、c 等的别名。

这是一个例子：

```
SELECT a.TripNum, b.SegmentNum, b.StopNum, b.ArrivalTime
FROM Trip a, Segment b
WHERE a.TripNum = b.TripNum 
```

我不同意他们的观点，并认为应该更谨慎地使用表别名。

我认为应该在查询中包含两次相同的表时使用它们，或者当表名很长并且在查询中使用较短的名称将使查询更易于阅读时。

我还认为别名应该是一个描述性的名称，而不仅仅是一个字母。在上面的例子中，如果我觉得我需要使用 1 个字母的表别名，我会使用 t 表示 Trip 表，使用 s 表示段表。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-13T16:52:17.440

使用表别名有两个原因。

首先是化妆品。这些语句更容易编写，并且在使用表别名时可能也更容易阅读。

第二个更实质。如果一个表在 FROM 子句中出现多次，则需要表别名以保持它们的区别。自联接在表包含引用同一表的主键的外键的情况下很常见。

两个示例：一个员工表，其中包含一个引用主管的员工 ID 的主管 ID 列。

二是零件爆炸。通常，这是在具有三列的单独表中实现的：ComponentPartID、AssemblyPartID 和 Quantity。在这种情况下，不会有任何自连接，但在此表和对 Parts 表的两个不同引用之间通常会有一个三向连接。

养成一个好习惯。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-10-13T16:39:41.227

我用它们来节省打字。但是，我总是使用类似于函数的字母。所以，在你的例子中，我会输入：

```
SELECT t.TripNum, s.SegmentNum, s.StopNum, s.ArrivalTime 
FROM Trip t, Segment s 
WHERE t.TripNum = s.TripNum 
```

对我来说，这只是让阅读更容易。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-13T16:51:28.597

作为一般规则，**我总是使用它们**，因为我的存储过程中通常有多个连接。在使用 CodeSmith 等代码生成工具时，它还可以更轻松地自动为您生成别名。

我尽量远离像 a & b 这样的单个字母，因为我可能有多个以字母 a 或 b 开头的表。我采用更长的方法，将引用的外键与别名表连接起来，例如 CustomerContact ...这将是加入 Contact 表时 Customer 表的别名。

我不介意**更长**的名称的另一个原因是由于我的大部分存储过程都是通过代码 CodeSmith 生成的。我不介意手工输入我可能必须自己构建的**少数几个。**

使用当前示例，我会执行以下操作：

```
SELECT TripNum, TripSegment.SegmentNum, TripSegment.StopNum, TripSegment.ArrivalTime 
FROM Trip, Segment TripSegment 
WHERE TripNum = TripSegment.TripNum 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-06-17T14:55:49.990

我可以加入已经有几年历史的辩论吗？

还有一个没有人提到的原因。某些数据库中的 SQL 解析器使用别名效果更好。我不记得 Oracle 是否在以后的版本中更改了这一点，但是当涉及到别名时，它会查找数据库中的列并记住它们。当涉及到表名时，即使在语句中已经遇到过，它也会重新检查数据库中的列。因此，使用别名可以加快解析速度，尤其是长 SQL 语句。我相信有人知道这是否仍然是这种情况，其他数据库是否在解析时这样做，如果它改变了，***什么时候***改变了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-13T17:11:58.913

我一直用它，原因：

*   在语句中保留完整的表名会使它们难以阅读，而且你不能有两次同一张表
*   不使用任何东西是一个非常糟糕的主意，因为稍后您可以将一些字段添加到已经存在于其他表中的表中

考虑这个例子：

```
select col1, col2
from tab1
join tab2 on tab1.col3 = tab2.col3 
```

现在，想象几个月后，您决定将名为“col1”的列添加到 tab2。数据库将默默地允许您这样做，但由于 tab1.col1 和 tab2.col1 之间的歧义，应用程序会在执行上述查询时中断。

但是，我同意你的命名：a、b、c 很好，但在你的例子中**t**和**s**会好得多。当我不止一次拥有同一张桌子时，我会使用 t1, t2, ... 或 s1, s2, s3...

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-04T19:16:10.920

在简单查询中，我不使用别名。在包含多个表的查询中，我总是使用它们，因为：

*   它们使查询更具可读性（我的别名是 2 个或更多大写字母，这是表名的快捷方式，如果可能的话，与其他表的关系）
*   它们允许更快的开发和重写（我的表名很长，并且根据它们所扮演的角色有前缀）

所以而不是例如：

```
SELECT SUM(a.VALUE) 
       FROM Domesticvalues a, Foreignvalues b 
       WHERE a.Value>b.Value
       AND a.Something ... 
```

我写的：

```
select SUM(DVAL.Value) 
       from DomesticValues DVAL, ForeignValues FVAL 
       where DVAL.Value > FVAL.Value
       and   DVAL.Something ... 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-13T16:59:21.780

我发现它只不过是一种偏好。如上所述，别名可以节省输入，尤其是对于长表/视图名称。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-13T17:00:23.913

使用全名会更难阅读，特别是对于较大的查询或 Order/Product/OrderProduct 场景0

我会使用 t 和 s。或 o/p/op

如果您使用 SCHEMABINDING 那么列必须是合格的

如果将列添加到基表，则限定会减少查询中重复的机会（例如“评论”列）

由于这种限定，总是使用别名是有意义的。

使用 a 和 b 是盲目服从一个奇怪的标准。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-13T21:24:58.293

我学到的一件事是，尤其是对于复杂的查询；如果您使用别名作为每个字段引用的限定符，则六个月后排除故障要简单得多。然后，您不会试图记住该字段来自哪个表。

我们往往有一些可笑的长表名，所以如果表有别名，我发现更容易阅读。当然，如果您使用派生表或自联接，则必须这样做，因此养成习惯是个好主意。我发现我们的大多数开发人员最终在他们的所有 sps 中为每个表使用相同的别名，所以大多数时候任何阅读它的人都会立即知道 pug 或 mmh 的别名是什么。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-13T16:39:12.007

我觉得你应该尽可能多地使用它们，但我同意 t & s 比 a & b 更能代表实体。

和其他一切一样，这归结为偏好。当每个开发人员以相同的方式使用别名时，我喜欢你可以依赖于遵循相同约定的存储过程。

去说服你的同事和你在同一个页面上，否则这一切都一文不值。另一种方法是您可以将 Zebra 表作为第一个表并将其别名为 a。那会很可爱。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-13T16:46:01.913

我只在需要区分字段来自哪个表时才使用它们

```
select PartNumber, I.InventoryTypeId, InventoryTypeDescription
from dbo.Inventory I
    inner join dbo.InventoryType IT on IT.InventoryTypeId = I.InventoryTypeId 
```

在上面的示例中，两个表都有一个 InventoryTypeId 字段，但其他字段名称是唯一的。

始终使用表的缩写作为名称，以便代码更有意义 - 询问您的其他开发人员是否将他们的局部变量命名为 A、B、C 等！

唯一的例外是在 SQL 语法需要表别名但未引用它的极少数情况下，例如

```
select *
from (
    select field1, field2, sum(field3) as total
    from someothertable
) X 
```

在上面，SQL 语法需要子选择的表别名，但它没有在任何地方引用，所以我变得懒惰并使用 X 或类似的东西。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-14T08:14:22.510

我总是使用它们。我以前只在只涉及一个表的查询中使用它们，但后来我意识到 a) 只涉及一个表的查询很少见，b) 只涉及一个表的查询很少会长时间保持这种状态。所以我总是从一开始就把它们放进去，这样我（或其他人）就不必在以后重新安装它们。哦，顺便说一句：根据 SQL-92 标准，我称它们为“相关名称”:)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-21T20:19:36.097

表别名应该是四件事：

1.  短的
2.  有意义的
3.  一直使用
4.  持续使用

例如，如果您有名为 service_request、service_provider、user 和affiliate（以及许多其他）的表，一个好的做法是将这些表别名为“sr”、“sp”、“u”和“a”，然后这样做在每个可能的查询中。如果这些别名通常与您的组织使用的首字母缩写词一致，这将特别方便。因此，如果“SR”和“SP”分别是服务请求和服务提供者的公认术语，那么上面的别名带有双重有效负载，直观地代表表和它所代表的业务对象。

这个系统的明显缺陷首先是对于包含很多“单词”的表名可能会很尴尬，例如 a_long_multi_word_table_name 会别名为 almwtn 或其他东西，并且很可能你最终会得到这样命名的表，它们的缩写相同. 第一个缺陷可以随心所欲地处理，例如取最后 3 或 4 个字母，或者您认为最有代表性、最独特或最容易键入的任何子集。我在实践中发现的第二个并不像看起来那么麻烦，也许只是运气好。您还可以执行诸如取表中“单词”的第二个字母之类的操作，例如将 account_transaction 别名为“atr”而不是“at”以避免与 account_type 冲突。

当然，无论您是否使用上述方法，别名都应该很短，因为您会非常频繁地键入它们，并且应该始终使用它们，因为一旦您针对单个表编写查询并省略了别名，它就是不可避免的是，您稍后需要在第二个表中编辑具有重复列名的表。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-04-24T19:21:50.217

因为我总是完全限定我的表，所以当涉及 JOINed 表时，我使用别名为正在选择的字段提供更短的名称。我认为这使我的代码更容易理解。

如果查询只处理一个源——没有 JOIN——那么我不使用别名。

只是个人喜好问题。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-01-17T20:44:05.887

上面的帖子中有很多关于何时以及为什么给表名取别名的好主意。其他人没有提到的是，它还有助于帮助维护人员理解表的范围。在我们公司，我们不允许创建视图。（感谢 DBA。）因此，我们的一些查询变得很大，甚至超过了 Crystal Reports 中 SQL 命令的 50,000 个字符的限制。当一个查询将其表别名为 a、b、c 并且其子查询执行相同的操作，并且其中的多个子查询每个都使用相同的别名时，很容易错误地读取查询的哪个级别。当足够的时间过去时，这甚至会使原始开发人员感到困惑。在查询的每个级别中使用唯一别名可以更容易阅读，因为范围保持清晰。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2008-10-13T16:41:04.263

总是。让它成为一种习惯。

# c++ - 如何在 C 或 C++ 中反转字符串？

> ID：198199
> 
> 赞同：186
> 
> 时间：2008-10-13T16:36:21.920
> 
> 标签：c++, c, string, reverse

如何在 C 或 C++ 中反转字符串而不需要单独的缓冲区来保存反转的字符串？

* * *

## 回答 #1

> 赞同：484
> 
> 时间：2008-10-13T16:39:29.277

```
#include <algorithm>
std::reverse(str.begin(), str.end()); 
```

这是 C++ 中最简单的方法。

* * *

## 回答 #2

> 赞同：167
> 
> 时间：2008-10-14T03:09:24.823

阅读 Kernighan 和 Ritchie

```
#include <string.h>

void reverse(char s[])
{
    int length = strlen(s) ;
    int c, i, j;

    for (i = 0, j = length - 1; i < j; i++, j--)
    {
        c = s[i];
        s[i] = s[j];
        s[j] = c;
    }
} 
```

* * *

## 回答 #3

> 赞同：130
> 
> 时间：2008-10-13T16:58:34.760

标准算法是使用指向开始/结束的指针，并将它们向内移动，直到它们在中间相遇或交叉。随走随换。

* * *

反转 ASCII 字符串，即一个以 0 结尾的数组，其中每个字符都适合 1 `char`。（或其他非多字节字符集）。

```
void strrev(char *head)
{
  if (!head) return;
  char *tail = head;
  while(*tail) ++tail;    // find the 0 terminator, like head+strlen
  --tail;               // tail points to the last real char
                        // head still points to the first
  for( ; head < tail; ++head, --tail) {
      // walk pointers inwards until they meet or cross in the middle
      char h = *head, t = *tail;
      *head = t;           // swapping as we go
      *tail = h;
  }
} 
```

```
// test program that reverses its args
#include <stdio.h>

int main(int argc, char **argv)
{
  do {
    printf("%s ",  argv[argc-1]);
    strrev(argv[argc-1]);
    printf("%s\n", argv[argc-1]);
  } while(--argc);

  return 0;
} 
```

相同的算法适用于已知长度的整数数组，只是使用`tail = start + length - 1`而不是结束查找循环。

（编者注：这个答案最初也为这个简单的版本使用了 XOR-swap。为了这个热门问题的未来读者的利益而修复。 [*强烈*](https://stackoverflow.com/questions/10549155/why-swap-dont-use-xor-operation-in-c)[不推荐](https://stackoverflow.com/questions/10549155/why-swap-dont-use-xor-operation-in-c)[XOR-swap](https://stackoverflow.com/questions/10549155/why-swap-dont-use-xor-operation-in-c)*；难以阅读并使您的代码编译效率降低。你可以[在 Godbolt 编译器资源管理器上](https://godbolt.org/z/pPNxJq)看到，当使用 gcc -O3 为 x86-64 编译 xor-swap 时，asm 循环体要复杂得多。）*

 ** * *

## 好的，好的，让我们修复 UTF-8 字符...

（这是 XOR-swap 的事情。请注意，您*必须避免*与 self 交换，因为如果`*p`和`*q`是相同的位置，您将使用 a^a==0 将其归零。XOR-swap 取决于具有两个不同的位置，将它们分别用作临时存储。）

编者注：您可以使用 tmp 变量将 SWP 替换为安全的内联函数。

```
#include <bits/types.h>
#include <stdio.h>

#define SWP(x,y) (x^=y, y^=x, x^=y)

void strrev(char *p)
{
  char *q = p;
  while(q && *q) ++q; /* find eos */
  for(--q; p < q; ++p, --q) SWP(*p, *q);
}

void strrev_utf8(char *p)
{
  char *q = p;
  strrev(p); /* call base case */

  /* Ok, now fix bass-ackwards UTF chars. */
  while(q && *q) ++q; /* find eos */
  while(p < --q)
    switch( (*q & 0xF0) >> 4 ) {
    case 0xF: /* U+010000-U+10FFFF: four bytes. */
      SWP(*(q-0), *(q-3));
      SWP(*(q-1), *(q-2));
      q -= 3;
      break;
    case 0xE: /* U+000800-U+00FFFF: three bytes. */
      SWP(*(q-0), *(q-2));
      q -= 2;
      break;
    case 0xC: /* fall-through */
    case 0xD: /* U+000080-U+0007FF: two bytes. */
      SWP(*(q-0), *(q-1));
      q--;
      break;
    }
}

int main(int argc, char **argv)
{
  do {
    printf("%s ",  argv[argc-1]);
    strrev_utf8(argv[argc-1]);
    printf("%s\n", argv[argc-1]);
  } while(--argc);

  return 0;
} 
```

*   为什么，是的，如果输入是 borked，这会很高兴地在这个地方交换。
*   破坏 UNICODE 时的有用链接：http: [//www.macchiato.com/unicode/chart/](http://www.macchiato.com/unicode/chart/)
*   此外，UTF-8 over 0x10000 未经测试（因为我似乎没有任何字体，也没有耐心使用 hexeditor）

例子：

```
$ ./strrev Räksmörgås ░▒▓○◔◑◕●

░▒▓○◔◑◕● ●◕◑◔○▓▒░

Räksmörgås sågrömskäR

./strrev verrts/. 
```

* * *

## 回答 #4

> 赞同：43
> 
> 时间：2008-10-13T17:00:05.553

`char`非邪恶的 C，假设字符串是一个以 null 结尾的数组的常见情况：

```
#include <stddef.h>
#include <string.h>

/* PRE: str must be either NULL or a pointer to a 
 * (possibly empty) null-terminated string. */
void strrev(char *str) {
  char temp, *end_ptr;

  /* If str is NULL or empty, do nothing */
  if( str == NULL || !(*str) )
    return;

  end_ptr = str + strlen(str) - 1;

  /* Swap the chars */
  while( end_ptr > str ) {
    temp = *str;
    *str = *end_ptr;
    *end_ptr = temp;
    str++;
    end_ptr--;
  }
} 
```

* * *

## 回答 #5

> 赞同：31
> 
> 时间：2011-07-03T00:16:19.170

已经有一段时间了，我不记得哪本书教过我这个算法，但我认为它非常巧妙且易于理解：

```
char input[] = "moc.wolfrevokcats";

int length = strlen(input);
int last_pos = length-1;
for(int i = 0; i < length/2; i++)
{
    char tmp = input[i];
    input[i] = input[last_pos - i];
    input[last_pos - i] = tmp;
}

printf("%s\n", input); 
```

该算法的可视化，由[slashdottir](https://stackoverflow.com/users/901444/slashdottir)提供：

![将字符串反转到位的算法的可视化](https://i.stack.imgur.com/LLSbH.gif)

* * *

## 回答 #6

> 赞同：23
> 
> 时间：2008-10-13T18:26:36.157

请注意，std::reverse 的美妙之处在于它可以与`char *`字符串和`std::wstring`s 以及`std::string`s一起使用

```
void strrev(char *str)
{
    if (str == NULL)
        return;
    std::reverse(str, str + strlen(str));
} 
```

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2008-10-13T18:05:57.243

为了完整起见，应该指出，在各种平台上都有字符串的表示形式，其中每个字符的字节数根据字符***而变化***。老派程序员将其称为[DBCS（双字节字符集）](http://en.wikipedia.org/wiki/DBCS)。[现代程序员在UTF-8](http://en.wikipedia.org/wiki/UTF-8)（以及[UTF-16](http://en.wikipedia.org/wiki/UTF-16)等）中更常遇到这种情况。还有其他这样的编码。

在任何这些可变宽度编码方案中，这里发布的简单算法（[邪恶](https://stackoverflow.com/questions/198199/how-do-you-reverse-a-string-in-place-in-c-or-c#198264)、[非邪恶](https://stackoverflow.com/questions/198199/how-do-you-reverse-a-string-in-place-in-c-or-c#198275)或[其他](https://stackoverflow.com/questions/198199/how-do-you-reverse-a-string-in-place-in-c-or-c#198200)）根本无法正常工作！事实上，它们甚至可能导致字符串变得难以辨认，甚至是该编码方案中的非法字符串。有关一些很好的例子，请参阅[Juan Pablo Califano 的回答](https://stackoverflow.com/questions/198199/how-do-you-reverse-a-string-in-place-in-c-or-c#198637)。

std::reverse() 在这种情况下可能仍然有效，只要您的平台对标准 C++ 库（特别是字符串迭代器）的实现正确考虑到这一点。

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2008-10-13T18:55:29.830

如果您正在寻找反转 NULL 终止的缓冲区，这里发布的大多数解决方案都可以。但是，正如 Tim Farley 已经指出的那样，这些算法只有在假设一个字符串在语义上是一个字节数组（即单字节字符串）是有效的情况下才有效，我认为这是一个错误的假设。

例如，字符串“año”（西班牙语中的年份）。

Unicode 代码点是 0x61、0xf1、0x6f。

考虑一些最常用的编码：

**Latin1 / iso-8859-1**（单字节编码，1个字符为1个字节，反之亦然）：

> 原来的：
> 
> 0x61、0xf1、0x6f、0x00
> 
> 逆转：
> 
> 0x6f、0xf1、0x61、0x00
> 
> **结果没问题**

**UTF-8：**

> 原来的：
> 
> 0x61、0xc3、0xb1、0x6f、0x00
> 
> 逆转：
> 
> 0x6f、0xb1、0xc3、0x61、0x00
> 
> **结果是乱码和非法的 UTF-8 序列**

**UTF-16 大端：**

> 原来的：
> 
> 0x00, 0x61, 0x00, 0xf1, 0x00, 0x6f, 0x00, 0x00
> 
> **第一个字节将被视为 NUL 终止符。不会发生逆转。**

**UTF-16 小端：**

> 原来的：
> 
> 0x61, 0x00, 0xf1, 0x00, 0x6f, 0x00, 0x00, 0x00
> 
> **第二个字节将被视为 NUL 终止符。结果将是 0x61, 0x00，一个包含“a”字符的字符串。**

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2012-09-28T13:10:54.460

另一种 C++ 方式（虽然我自己可能会使用 std::reverse() :) 更具表现力和更快）

```
str = std::string(str.rbegin(), str.rend()); 
```

C方式（或多或少:)）请注意交换的XOR技巧，编译器有时无法优化它。

[在这种情况下，它通常要慢得多。](http://en.wikipedia.org/wiki/XOR_swap_algorithm#Reasons_for_avoidance_in_practice)

```
char* reverse(char* s)
{
    char* beg = s, *end = s, tmp;
    while (*end) end++;
    while (end-- > beg)
    { 
        tmp  = *beg; 
        *beg++ = *end;  
        *end =  tmp;
    }
    return s;
} // fixed: check history for details, as those are interesting ones 
```

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2008-10-13T16:36:32.480

```
#include <cstdio>
#include <cstdlib>
#include <string>

void strrev(char *str)
{
        if( str == NULL )
                return;

        char *end_ptr = &str[strlen(str) - 1];
        char temp;
        while( end_ptr > str )
        {
                temp = *str;
                *str++ = *end_ptr;
                *end_ptr-- = temp;
        }
}

int main(int argc, char *argv[])
{
        char buffer[32];

        strcpy(buffer, "testing");
        strrev(buffer);
        printf("%s\n", buffer);

        strcpy(buffer, "a");
        strrev(buffer);
        printf("%s\n", buffer);

        strcpy(buffer, "abc");
        strrev(buffer);
        printf("%s\n", buffer);

        strcpy(buffer, "");
        strrev(buffer);
        printf("%s\n", buffer);

        strrev(NULL);

        return 0;
} 
```

此代码产生以下输出：

```
gnitset
a
cba 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-10-14T05:24:47.780

如果您使用 GLib，它有两个函数，[g_strreverse()](http://library.gnome.org/devel/glib/stable/glib-String-Utility-Functions.html#g-strreverse)和[g_utf8_strreverse()](http://library.gnome.org/devel/glib/stable/glib-Unicode-Manipulation.html#g-utf8-strreverse)

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2011-03-15T17:33:27.910

我喜欢 Evgeny 的 K&R 答案。但是，很高兴看到使用指针的版本。否则，它基本上是相同的：

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

char *reverse(char *str) {
    if( str == NULL || !(*str) ) return NULL;
    int i, j = strlen(str)-1;
    char *sallocd;
    sallocd = malloc(sizeof(char) * (j+1));
    for(i=0; j>=0; i++, j--) {
        *(sallocd+i) = *(str+j);
    }
    return sallocd;
}

int main(void) {
    char *s = "a man a plan a canal panama";
    char *sret = reverse(s);
    printf("%s\n", reverse(sret));
    free(sret);
    return 0;
} 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2012-02-22T10:39:46.120

用于反转字符串的递归函数（没有额外的缓冲区，malloc）。

简短而性感的代码。不好，不好的堆栈使用。

```
#include <stdio.h>

/* Store the each value and move to next char going down
 * the stack. Assign value to start ptr and increment 
 * when coming back up the stack (return).
 * Neat code, horrible stack usage.
 *
 * val - value of current pointer.
 * s - start pointer
 * n - next char pointer in string.
 */
char *reverse_r(char val, char *s, char *n)
{
    if (*n)
        s = reverse_r(*n, s, n+1);
   *s = val;
   return s+1;
}

/*
 * expect the string to be passed as argv[1]
 */
int main(int argc, char *argv[])
{
    char *aString;

    if (argc < 2)
    {
        printf("Usage: RSIP <string>\n");
        return 0;
    }

    aString = argv[1];
    printf("String to reverse: %s\n", aString );

    reverse_r(*aString, aString, aString+1); 
    printf("Reversed String:   %s\n", aString );

    return 0;
} 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2013-10-31T21:40:22.267

如果您使用 ATL/MFC `CString`，只需调用`CString::MakeReverse()`.

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-06-08T19:40:47.697

完后还有：

```
#include <stdio.h>
#include <strings.h>

int main(int argc, char **argv) {

  char *reverse = argv[argc-1];
  char *left = reverse;
  int length = strlen(reverse);
  char *right = reverse+length-1;
  char temp;

  while(right-left>=1){

    temp=*left;
    *left=*right;
    *right=temp;
    ++left;
    --right;

  }

  printf("%s\n", reverse);

} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-10-30T05:09:46.153

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <stdbool.h>

unsigned char * utf8_reverse(const unsigned char *, int);
void assert_true(bool);

int main(void)
{
    unsigned char str[] = "mañana mañana";
    unsigned char *ret = utf8_reverse(str,  strlen((const char *) str) + 1);

    printf("%s\n", ret);
    assert_true(0 == strncmp((const char *) ret, "anãnam anañam", strlen("anãnam anañam") + 1));

    free(ret);

    return EXIT_SUCCESS;
}

unsigned char * utf8_reverse(const unsigned char *str, int size)
{
    unsigned char *ret = calloc(size, sizeof(unsigned char*));
    int ret_size = 0;
    int pos = size - 2;
    int char_size = 0;

    if (str ==  NULL) {
        fprintf(stderr, "failed to allocate memory.\n");
        exit(EXIT_FAILURE);
    }

    while (pos > -1) {

        if (str[pos] < 0x80) {
            char_size = 1;
        } else if (pos > 0 && str[pos - 1] > 0xC1 && str[pos - 1] < 0xE0) {
            char_size = 2;
        } else if (pos > 1 && str[pos - 2] > 0xDF && str[pos - 2] < 0xF0) {
            char_size = 3;
        } else if (pos > 2 && str[pos - 3] > 0xEF && str[pos - 3] < 0xF5) {
            char_size = 4;
        } else {
            char_size = 1;
        }

        pos -= char_size;
        memcpy(ret + ret_size, str + pos + 1, char_size);
        ret_size += char_size;
    }    

    ret[ret_size] = '\0';

    return ret;
}

void assert_true(bool boolean)
{
    puts(boolean == true ? "true" : "false");
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-01-27T21:27:24.623

## C++ 多字节 UTF-8 逆向器

我的想法是，你永远不能只交换结尾，你必须始终从头到尾移动，遍历字符串并寻找“这个字符需要多少字节？” 我从原始结束位置开始附加字符，并从字符串的前面删除字符。

```
void StringReverser(std::string *original)
{
  int eos = original->length() - 1;
  while (eos > 0) {
    char c = (*original)[0];
    int characterBytes;
    switch( (c & 0xF0) >> 4 ) {
    case 0xC:
    case 0xD: /* U+000080-U+0007FF: two bytes. */
      characterBytes = 2;
      break;
    case 0xE: /* U+000800-U+00FFFF: three bytes. */
      characterBytes = 3;
      break;
    case 0xF: /* U+010000-U+10FFFF: four bytes. */
      characterBytes = 4;
      break;
    default:
      characterBytes = 1;
      break;
    }

    for (int i = 0; i < characterBytes; i++) {
      original->insert(eos+i, 1, (*original)[i]);
    }
    original->erase(0, characterBytes);
    eos -= characterBytes;
  }
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-02-05T21:00:06.750

```
void reverseString(vector<char>& s) {
        int l = s.size();
        char ch ;
        int i = 0 ;
        int j = l-1;
        while(i < j){
                s[i] = s[i]^s[j];
                s[j] = s[i]^s[j];
                s[i] = s[i]^s[j];
                i++;
                j--;
        }
        for(char c : s)
                cout <<c ;
        cout<< endl;
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-11-14T11:09:42.017

在 C++ 中，可以在函数中完成相反的操作：

```
#include <algorithm>
#include <string>

void backwards(vector<string> &inputs_ref) {
    for (auto i = inputs_ref.begin(); i != inputs_ref.end(); ++i) {
        reverse(i->begin(), i->end());
    }
} 
```

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2014-05-17T01:46:58.323

如果您不需要存储它，您可以像这样减少花费的时间：

```
void showReverse(char s[], int length)
{
    printf("Reversed String without storing is ");
    //could use another variable to test for length, keeping length whole.
    //assumes contiguous memory
    for (; length > 0; length--)
    {
        printf("%c", *(s+ length-1) );
    }
    printf("\n");
} 
```

# c++ - istream 运营商

> ID：198215
> 
> 赞同：0
> 
> 时间：2008-10-13T16:39:43.580
> 
> 标签：c++

```
int main()
{
    HandPhone A,B;
    A>>B;//overloading operator>> to simulate sending sms to another handphone(object)
    return 0;
} 
```

我应该如何声明 istream 运营商来模拟向另一个手机（对象）发送短信？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-13T18:30:53.200

这是如何定义 >> 运算符：

```
void operator >> (HandPhone& a, HandPhone& b)
{
    // Add code here.
} 
```

我已将返回类型设置为 void，因为我不确定链接是否有意义。

但是将运算符重载以执行随机任务被认为是糟糕的设计（在 C++ 世界中），因为它使代码难以阅读。流式运算符 >> 和 << 具有非常明确的含义，但发送消息看起来不像流式传输，我希望以这种方式使用运算符。我希望在流的目标端解组对象会产生一个与源端放置的对象非常相似的对象。

做这样的事情要容易得多。

```
B.sendMessageTo(A,Message("PLOP")); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-13T16:46:01.133

[std::istream](http://www.cplusplus.com/reference/iostream/istream/)是一个类，而不是一个运算符。可以为任意两种类型定义 << 和 >> 运算符：

```
class A;
class B;

A operator << (A& a, const B& b)    // a << b;  sends b to a.
{
   a.sendMessage(b);
   return a;
} 
```

# .net - 在 Embedded XP (Win XPE) 上安装 .NET Framework 2.0

> ID：198223
> 
> 赞同：2
> 
> 时间：2008-10-13T16:44:22.497
> 
> 标签：.net, qfe

我正在尝试在嵌入式 Windows XP SP2（又名 XPE）上安装 .Net 框架 2.0 版。

我正在使用 Microsoft 的 XPE 特定版本的安装程序：

[http://www.microsoft.com/downloads/details.aspx?familyid=c4837dad-5719-4b63-8752-cb0a65802329&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=c4837dad-5719-4b63-8752-cb0a65802329&displaylang=en)

安装开始时失败并出现以下错误：

QFE 安装程序 - 错误无法连接到数据库 - 请检查数据库

如何在 SPE 上安装 .Net 2.0？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-13T17:01:08.110

好的，所以您正在运行更新 XPE 开发环境的安装程序，对吗？或者您是否尝试在密封设备之前在设备上运行它？

您需要在安装了 XPE 开发环境（和数据库）的工作站上运行该安装程序。安装程序正在查找特定 Sql Server 实例上的特定数据库，因此如果您（或其他人）更改了它，您需要阅读如何指定要与安装程序一起使用的连接字符串。

此外，它可能正在尝试使用您的 Windows 帐户凭据进行连接。确保您能够登录到 Sql Server，使用组件定义打开数据库，并向其中添加记录。或者，如果您可以指定连接字符串，则可以设置要使用的 Sql 登录用户名和密码。

Profiler 是解决上述两个问题的绝佳工具。

一旦你安装了组件，你必须将它们添加到你的镜像中，检查你的依赖关系然后构建它。

* * *

如果您尝试直接在机器上安装 .NET 2.0（在重新封装之前），则首先需要机器上的 Windows Installer 软件包。可能还有其他一些依赖项；好久没做所以记不太清了。

对 XPE 安装的依赖关系进行故障排除的最佳方法是将来自 Sysinternals 的 ProcessMonitor 放在其上。当您运行安装程序时，您会看到它在哪里尝试查找内容并失败了。将该信息带回您的 XPE IDE 并在您的组件中搜索这些文件。然后，您必须将包含这些文件的包添加到您的图像中，然后重试。有时它是一个艰巨的过程......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-03T19:56:31.543

Windows XP Embedded Service Pack 2 Feature Pack 2007 不是一个独立的产品。它要求开发人员安装 Windows® Embedded Studio 工具套件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T16:24:35.783

嗨，我知道如何解决它，

只需为 w XP Embedded 安装 futre-pack 2007 =（包括 .NET framework2.0）：D

# html - SSI 和 XSL

> ID：198224
> 
> 赞同：0
> 
> 时间：2008-10-13T16:44:58.797
> 
> 标签：html, xml, xslt, ssi

我正在构建一个菜单并对其进行设置，以便我使用标准`<!--#include virtual = "myDoc.xml" -->` SSI 标记来包含我的 xml 文档。xml 文档包括带有`<?xml-stylesheet type="text/xsl" href="myOtherDoc.xsl"?>`. 由于某种原因，xsl 文档无法正常工作。xml 显示为 blob。

谢谢

账单

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-13T16:56:36.683

不幸的是，您的 XSL 转换不会那样工作。您必须将 XML 文档单独发送到内置 xsl 转换器将引用样式表并执行转换的浏览器。

您所拥有的是一个已经呈现的 HTML 页面，并且您将 XML 作为呈现到输出流中的一小块 xml 包含在内，但是浏览器不知道要对其进行转换，因为它没有：

```
<?xml-stylesheet type="text/xsl" href="myOtherDoc.xsl"?> 
```

...页面开头的 PI。请记住，这些是由浏览器而不是服务器处理的。

您需要转换 XML 服务器端，例如

```
<!-- #include virtual="doMenuXform.asp" --> 
```

# c# - 如何使窗口有任务栏文本但没有标题栏

> ID：198233
> 
> 赞同：10
> 
> 时间：2008-10-13T16:48:05.140
> 
> 标签：c#, .net, winforms

如何使我的窗口没有标题栏，但在任务栏中显示一些描述性文本？如果您设置表单的 .Text 属性，那么 .net 会给它一个标题栏，这是我不想要的。

```
 this.ControlBox = false;
        this.FormBorderStyle = System.Windows.Forms.FormBorderStyle.FixedDialog;
        this.MaximizeBox = false;
        this.MinimizeBox = false;
        this.ShowInTaskbar = true;
        this.Text = "My title for task bar"; 
```

我找到了一个部分解决方案来覆盖 CreateParams：

```
 protected override System.Windows.Forms.CreateParams CreateParams
    {
        get
        {
            System.Windows.Forms.CreateParams cp = base.CreateParams;
            cp.Style &= ~0x00C00000; // WS_CAPTION
            return cp;
        }
    } 
```

然而，这会导致我的窗口被调整大小，就好像它们有一个标题栏一样，即它比它应该的高。有什么好的解决办法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-07-01T22:33:26.430

在我的情况下，我有一个 Form with`FormBorderStyle = FormBorderStyle.SizableToolWindow`并且以下`CreateParams`覆盖起到了作用（即，我现在有一个没有标题且标题没有额外边距的表单，但它将标题保留在任务栏中）：

```
protected override System.Windows.Forms.CreateParams CreateParams
{
    get
    {
        var parms = base.CreateParams;
        parms.Style &= ~0x00C00000; // remove WS_CAPTION
        parms.Style |= 0x00040000;  // include WS_SIZEBOX
        return parms;
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-13T17:07:21.997

研究的一种方法可能是将`FormBorderStyle`您的属性设置`Form`为`None`（而不是`FixedDialog`）。

这种方法的缺点是您丢失了窗口的边框以及标题栏。这样做的结果是您丢失了通常使用 Windows 窗体“免费”获得的表单重新定位/调整大小逻辑；您需要通过在表单的 MouseDown 和 MouseMove 事件处理程序中实现您自己的表单移动/调整大小逻辑来处理这个问题。

我也有兴趣了解更好的解决方案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-13T17:06:28.893

只需将边框样式设置为无。

```
this.FormBorderStyle = FormBorderStyle.None; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-13T17:23:27.440

一旦你用 FormBorderStyle 删除了边框，正如已经提到的，你可以很容易地让它变得可拖动。我在[http://www.blackwasp.co.uk/DraggableBorderless.aspx](http://www.blackwasp.co.uk/DraggableBorderless.aspx)对此进行了描述。

# java - 如何在 Java 中解析“事件 XML”？

> ID：198240
> 
> 赞同：2
> 
> 时间：2008-10-13T16:49:54.700
> 
> 标签：java, xml, sax

我正在寻找使用 Java 来解析远程设备生成的事件驱动 XML 的持续流。这是两个事件的简化示例：

```
<?xml version="1.0"?>
<Event> DeviceEventMsg
<Param1>SomeParmValue</Param1>
</Event>
<?xml version="1.0"?>
<Event> DeviceEventMsg
<Param1>SomeParmValue</Param1>
</Event> 
```

看起来 SAX 比 DOM 更适合这个，因为它是一个持续的流，尽管我对 Sax 不太熟悉。不要因为 XML 的结构而对我大喊大叫——我已经知道并且无法更改它。

是的，设备确实在每个事件之前发送 xml 指令。我的第一个问题是第二个 xml 处理指令正在破坏 SAX 解析器。

任何人都可以建议一种方法来解决这个问题吗？

* * *

到目前为止，我正在使用的第二个 xml 处理指令的代码是：

```
public class TestMe extends HandlerBase {
    public void startDocument () throws SAXException
    {
        System.out.println("got startDocument");
    }

    public void endDocument () throws SAXException
    {
        System.out.println("got endDocument");
    }

    public void startElement (String name, AttributeList attrs) throws SAXException
    {
        System.out.println("got startElement");
    }

    public void endElement (String name) throws SAXException
    {
        System.out.println("got endElement");
    }

    public void characters (char buf [], int offset, int len) throws SAXException
    {
        System.out.println("found characters");
    }

    public void processingInstruction (String target, String data) throws SAXException
    {
        System.out.println("got processingInstruction");
    } 

    public static void main(String[] args) {
        SAXParserFactory factory = SAXParserFactory.newInstance();
        try {
            SAXParser saxParser = factory.newSAXParser();
            // using a file as test input for now
            saxParser.parse( new File("devmodule.xml"), new TestMe() );

        } catch (Throwable err) {
            err.printStackTrace ();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-13T17:13:29.003

尝试使用[StAX](http://en.wikipedia.org/wiki/StAX)而不是 SAX。StAX 提供了更大的灵活性，它是流 XML 的更好解决方案。StAX 的实现很少，我对[codehaus](http://stax.codehaus.org/Download)的实现非常满意，但也有来自[Sun](https://sjsxp.dev.java.net/)的实现。它可能会解决你的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T19:12:04.013

还有一个建议，特别是关于多个 xml 声明。是的，这是非法的 xml，因此正确的解析器会使用默认模式来处理它。但是一些解析器有备用的“多文档”模式。例如，伍德斯托克斯有这个，所以你可以查看：

[http://www.cowtowncoder.com/blog/archives/2008/04/entry_66.html](http://www.cowtowncoder.com/blog/archives/2008/04/entry_66.html)

基本上，您必须告诉解析器（通过输入工厂）输入是“多个 xml 文档”（ParsingMode.PARSING_MODE_DOCUMENTS）的形式。

如果是这样，它将接受多个 xml 声明，每个声明都表示新文档的开始。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T21:31:10.200

如果您打印出开始和结束元素 System.out.println() 的名称，您将得到如下内容：

> got startDocument got startElement Event found characters found characters got startElement Param1 found characters got endElement Param1 found characters got endElement Event org.xml.sax.SAXParseException: 处理指令目标匹配“[xX][mM][lL]”是不允许的。...

所以我认为第二个

> `<?xml version="1.0"?>`

没有得到 endDocument 会导致解析器问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T21:49:22.287

如果你添加这个：

```
catch(SAXException SaxErr){
        System.out.println("ignore this error");
    } 
```

在另一个捕获之前，您将捕获此特定错误。然后，您必须重新打开设备或对于静态文件情况，您可能需要跟踪您是否在文件中。

或者在结束事件事件时，关闭设备/文件，然后为下一个事件重新打开它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-13T22:12:41.693

RE：Simon 建议捕获 SAXException 以确定您何时到达一个 XML 文档的结尾并到达另一个 XML 文档的开头，我认为这将是一个有问题的方法。如果发生另一个错误（无论出于何种原因），您将无法判断异常是由于错误的 XML 还是由于您已到达文档末尾而引发的。

问题是解析器是用来处理 XML 文档的。不是几个 XML 文档的流。我建议编写一些代码来手动解析传入的数据流，将其分解为包含单个 XML 文档的单个流；然后将这些流串行传递给 XML 解析器（这样可以保证事件的顺序）。

# java - checkstyle + 抑制过滤器

> ID：198244
> 
> 赞同：6
> 
> 时间：2008-10-13T16:51:06.383
> 
> 标签：java, code-analysis, static-analysis, checkstyle

我有一个 checkstyle 抑制过滤器设置（例如忽略单元测试代码中的幻数）。

抑制 xml 文件与 checkstyle xml 文件位于同一文件夹中。但是，这个文件实际上是不同的：在我的 Windows 开发框中，它位于 Linux CI 服务器上的 d:\dev\shared\checkstyle\config 中，它将位于另一个开发者框的 /root/repo/shared/checkstyle/config 中它可能在任何地方（他们查看他们的 svn 存储库）。

唯一“一致”的是抑制文件始终与 checkstyle xml 文件位于同一文件夹中。我无法弄清楚如何确保始终一致地拾取该文件。另外我不知道为什么 checkstyle 不支持 checkstyle xml 文件中的嵌入式抑制。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-13T22:39:23.573

当我在 Linux 和 Windows 之间来回切换时，我在 Checkstyle 抑制配置中遇到了同样的问题。以下是我在基于 Ant 的构建系统中解决它的方法：

基本上，我通过使用 Ant 构建脚本配置 Checkstyle 属性文件，将适当的、特定于平台的目录值注入到主 Checkstyle 配置文件中。

我的主要 Checkstyle 配置文件有一个`SuppressionFilter`模块声明，如下所示。该`checkstyle-suppressions-file`属性的值来自 Checkstyle 属性文件：

```
<module name="SuppressionFilter">
    <property name="file" value="${checkstyle-suppressions-file}"/>
</module> 
```

Checkstyle 属性文件不是静态的，它是由 Ant 构建脚本从名为`template-checkstyle.properties`. 以下是抑制文件属性的模板：

```
checkstyle-suppressions-file=@SCM_DIR@/checkstyle_suppressions.xml 
```

我的 Ant 构建脚本将此文件复制到名为`checkstyle.properties`. 该副本将特殊标记替换为找到抑制文件的目录的正确值：

```
<copy file="${scm.dir}/template-checkstyle.properties" tofile="${scm.dir}/checkstyle.properties">
    <filterset>
        <filter token="SCM_DIR" value="${scm.dir.unix}"/>
    </filterset>
</copy> 
```

现在，价值`scm.dir.unix`从何而来？好吧，它*来自*我构建的一个属性，请继续阅读。您需要使用您提到的目录值指定这样的值。

请注意，关于您指定此目录的方式，有一个不太明显的问题。我说该`scm.dir.unix`值是从构建属性派生的，因为我观察到主 Checkstyle 配置文件不能在模块的`file`属性值中包含反斜杠，即 Windows 路径分隔符。`SuppressionFilter`例如，指定类似`C:\foo\bar\baz`的内容会导致 Checkstyle 错误消息说`C:foobarbaz`找不到。我通过使用 Ant 的任务将`scm.dir`目录构建属性“转换”为“unix”格式来解决这个问题：`pathconvert`

```
<pathconvert targetos="unix" property="scm.dir.unix">
    <path location="${scm.dir}"/>
</pathconvert> 
```

然后我这样调用`checkstyle`Ant 任务：

```
<checkstyle config="${scm.dir}/checkstyle_checks.xml"
            properties="${scm.dir}/checkstyle.properties">
    <!-- details elided -->
</checkstyle> 
```

对任务的调用将文件`checkstyle`中包含的键/值对`checkstyle.properties`注入到主 Checkstyle 配置中。

如果你喜欢，你可以在[这里看到完整的脚本](http://virtualteamtls.svn.sourceforge.net/viewvc/virtualteamtls/trunk/scm/)

希望这可以帮助

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-21T19:26:31.643

在 Eclipse 中，我放置了以下内容，不需要我添加任何其他属性：

```
<module name="SuppressionFilter">
    <property name="file" value="${samedir}/suppressions.xml"/>
</module> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T14:25:22.767

`build.xml`我使用`ant.file`变量和项目名称获取所在目录的绝对路径：

```
<project name="common" ... >
  <dirname property="thisdir" file="${ant.file.common}"/> 
```

然后我可以连接到我的 checkstyle 配置文件的绝对路径：

```
checkstyle.suppressions.file=${thisdir}/qclib/checkstyle-suppressions.xml 
```

由于`thisdir`变量来自ant，所以似乎不需要路径分隔符转换。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-11-05T12:17:59.447

如果您正在使用 eclipse 并且您的抑制文件与外部 checkstyle 配置位于同一目录中，则可以像这样设置抑制过滤器：

```
<module name="SuppressionFilter">
    <property name="file" value="${config_dir}/my_suppressions.xml"/>
</module> 
```

您还必须在 checkstyle 配置中定义 ${config_dir} 属性：

Eclipse Preferences -> “Checkstyle” -> 选择你的 cs 配置 -> “Properties ..” -> “Additional Properties ..”

为 checkstyle 配置目录定义一个属性：

```
config_dir --->  ${config_loc} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-05T14:50:32.047

我认为罗伯特的答案可以扩展到**ant 和 Eclipse**的简单解决方案：

在配置 XML 中包含抑制文件，如下所示：

```
<module name="SuppressionFilter">
    <property name="file" value="${samedir}/suppressions.xml"/>
</module> 
```

现在，Eclipse 满意并找到了该文件。

要让 ant 工作，请将您的目标更新为以下内容：

```
<checkstyle config="${checkstyle.config}/checkstyle-checks.xml">
    <!-- ... -->
    <property key="samedir" value="${checkstyle.config}"/>
</checkstyle> 
```

希望这可以帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-08-10T23:23:47.120

从 CheckStyle 4.26.0 开始，您可以在配置文件中使用预定义的常量。

（[https://github.com/jshiell/checkstyle-idea/issues/217](https://github.com/jshiell/checkstyle-idea/issues/217)）：

> *   ${basedir} & ${project_loc} - 映射到当前项目目录
> *   ${workspace_loc} - 映射到当前的 Eclipse 工作区目录
> *   ${config_loc} & ${samedir} - 映射到配置文件所在的目录

如果您想与 maven 共享配置，您需要使用“propertyExpansion”配置元素在您的 POM 配置（在报告部分）中“别名”“eclipse 常量”：

```
<plugin>
   <groupId>org.apache.maven.plugins</groupId>
   <artifactId>maven-checkstyle-plugin</artifactId>
   <version>3.0.0</version>
   <configuration>
      <configLocation>${project.basedir}/quality/checkstyle/dap_checkstyle_checks.xml</configLocation>
      <propertyExpansion>basedir=${project.basedir}</propertyExpansion>
   </configuration>
   <reportSets>
      <reportSet>
         <reports>
            <report>checkstyle</report>
         </reports>
      </reportSet>
   </reportSets>
</plugin> 
```

“propertyExpansion”的灵感来自：[https](https://github.com/checkstyle/checkstyle/blob/master/pom.xml#L582) ://github.com/checkstyle/checkstyle/blob/master/pom.xml#L582 。

# vba - 在 Excel 2007 中编写 VBA 以在 Excel 2003 中使用

> ID：198247
> 
> 赞同：7
> 
> 时间：2008-10-13T16:51:45.537
> 
> 标签：vba, excel

我所在的开发人员已更新到 Excel 2007，但大多数用户还没有。我正在为需要包含一些 vba 代码的用户构建电子表格模板 (*.xlt)，我想知道在 2007 年而不是 2003 年构建它时可能会遇到什么问题？我无法使用装有 Excel 2003 的机器进行测试，而且我担心这个特定的项目会走向灾难。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-13T17:03:10.210

VBA 语言没有改变，但 Office 2007 中还有一些 Office 2003 中没有的其他对象。当您尝试在 2003 环境中访问这些项目时，这自然会导致运行时错误。是什么阻止您使用 Excel 2003 设置虚拟机进行开发？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-04T04:50:10.840

最好（最可靠）的做法是始终在可能用于运行代码的最旧版本的 Excel 中开发，而不是依赖于可能不完整的已添加到 Excel 2007 对象库的对象和方法列表。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-02-08T11:54:17.510

我发现的一个区别是，从菜单（在 Excel 2003 中）调用的子例程必须具有与从功能区（在 Excel 2007 中）调用时不同的签名。更重要的是，Excel 2003 无法识别 IRibbonControl 并引发编译错误。

为了实现跨版本兼容性，我使用条件编译参数，然后在预处理器宏中检查它。

例如

```
#If USINGRIBBON Then
    Public Sub CallFromRibbon(control As IRibbonControl)
#Else
    Public Sub CallFromRibbon()
#End If
    ' Code here
   End Sub 
```

这确实意味着您必须保存一个将 USINGRIBBON 标志设置为 false（对于 Excel2003）和另一个将 USINGRIBBON 标志设置为 true（对于 Excel2007）的加载项版本，但这比维护两个完全独立的版本要容易得多代码库。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-15T06:51:53.640

billb2112 是对的。Excel 2007 与 Excel 2003 相比有许多不向后兼容的更改。虽然语言可能没有改变，但对象已经更新。有些添加了其他属性，有些工作方式不同，Excel 中的某些功能也发生了变化。

您需要非常小心，您的代码在 Excel 2003 中有效。我会建议，正如 billb2112 所说，您可以获得一个虚拟机，不仅可以测试，还可以编码。我为只有 2003 的客户进行所有 Excel 开发在 2003 年的机器上。请注意，如果用户使用 Excel 2002 或 2000，则返回时会有更多差异，并且您只会在这些旧版本不支持的任何代码上遇到运行时错误。

不幸的是，更新杰夫斯的答案并不完全正确。虽然是的，vba 语言尚未更新，但 2007 年与 2003 年不同。2003 年与 2002 年不同，等等。发生的事情是额外的，并添加了额外的函数和函数参数。例如，2003 年 Excel 中的 FIND 函数选项比 2002 年多。因此，如果您在 2003 年录制宏（查找这些问题的最佳方法），然后在 2002 年运行它，您将遇到与在 2002 VBA 编辑器中根本不起作用的新参数。对 excel 2007 中已更改的功能执行相同的过程，然后返回 2003 进行测试将帮助您找到这些问题。一些示例包括条件格式、颜色（主题）和许多新的电子表格功能。jon peltier 在这方面有最好的建议 - 以客户/用户将使用的最旧版本进行开发。Virtual PC 2007 可免费下载和安装。您只需要安装 XP/Vista 和 office 的许可副本即可在其中运行。

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2009-09-30T17:21:10.630

我曾经在 2003 年开发过很多宏，什么是 POTA，Find、Dir 和其他一些东西不可用或者发生了一些变化。因此可能会出现一些错误，我曾经从 65000 行数到第一个非空行来计算要处理的行数......现在更多的行意味着更多的工作要做

# windows-xp - 使 DDD 在 XP 上正常运行的最低 Cygwin 安装是多少？

> ID：198248
> 
> 赞同：3
> 
> 时间：2008-10-13T16:52:04.540
> 
> 标签：windows-xp, gdb, cygwin, gnu, ddd-debugger

我在 Windows XP 上使用草莓 Perl 附带的 MinGW 中的 gcc。我也想拥有[ddd](http://www.gnu.org/software/ddd/)（数据显示调试器），但显然在 Windows 上获取 ddd 的最简单方法是运行 Cygwin。那么我可以安装最少的 Cygwin 来启动和运行 ddd 是什么？如果我可以在 Win32 上本地运行 ddd ，我更愿意，但这似乎不是一个选择。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-19T09:12:37.173

据我所知，只有以下内容（使用 Cygwin DLL 版本 1.5.25-15），并允许安装程序安装任何其他包以满足依赖关系。
基础：base-files、grep
开发：ddd、gdb
数学：gnuplot

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-11-25T16:57:46.997

让 grep 工作的示例：只需将以下文件从 cygwin bin 目录拖放到适当的目录中... cyggcc_s-1.dll cygiconv-2.dll cygintl-8.dll cygpcre-0.dll cygwin1.dll grep.exe

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-25T17:27:54.677

Cygwin`setup.exe`安装程序会为您解决依赖关系。只需运行安装程序，找到并启用`ddd`，然后单击下一步。它可能会安装一些您并不严格需要的软件包，但找出可以安全省略的软件包可能是浪费时间。

免责声明：我没有试过这个；我只是安装一切。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T17:25:08.857

如果你追求极简主义，你可能想要一个比[cygwin-x11](http://x.cygwin.com/)更小的 X 服务器（尽管它是我使用的，而且我非常喜欢它）。[Starwin X-Win32](http://www.starnet.com/products/xwin32/)得到积极维护（尽管在试用期之后要花费 $$），并且避免了安装 Cygwin 的开销；还有其他适用于 win32 的零成本最小 X 服务器可用，但我没有立即可用的链接。

正如[x.cygwin.com](http://x.cygwin.com/)上的文档所示，该`xorg-x11-base`软件包是最低要求。

# asp.net - ASP.NET - ObjectDataSource：使用多选 ListBox 作为 ControlParameter

> ID：198252
> 
> 赞同：3
> 
> 时间：2008-10-13T16:53:32.960
> 
> 标签：asp.net, listbox, objectdatasource

我有一个包含 GridView 控件的表单，该控件数据绑定到 ObjectDataSource 控件。有几个 TextBox 控件已被用作 ObjectDataSource 的 ControlParameters。我还有一个 ObjectDataSource 与 {TypeName="myDataClass"} 关联的自定义数据对象。这些值从 ObjectDataSource 传递到 myDataClass。

现在我还需要使用多选 ListBox 作为 ControlParameter。当我使用 ListBox 的 SelectedValue 参数时，ObjectDataSource 只看到列表中的第一个选定项。

问题是：如何将所有多选 ListBox 值传递到我的自定义对象“myDataClass”中，而不是只选择第一个？因此 ["multi-select"]

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T17:44:46.117

多选列表框很棘手。您需要遍历代码中的项目以构建选定值的列表。因此，您可能需要实现一个自定义参数来为您执行此操作。

您可能最终需要从代码隐藏绑定到网格，而不是以声明方式进行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-21T08:06:14.933

这是典型的问题。多选列表框总是返回第一个选定的值，而不是所有选定的值。我们必须遍历整个集合并检查每个单独的值是否被选中。

# pdf - Watin 和 PDF

> ID：198266
> 
> 赞同：7
> 
> 时间：2008-10-13T16:58:52.903
> 
> 标签：pdf, watin

任何人都可以提供使用 Watin 下载 PDF 文件的示例吗？我尝试了 SaveAsDialogHandler 但我无法弄清楚。也许可以使用 MemoryStream？

谢谢，

--jb

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-14T14:48:45.613

```
FileDownloadHandler fileDownloadHandler = new FileDownloadHandler(file.FullName);
using (new UseDialogOnce(ie.DialogWatcher, fileDownloadHandler))
{
    ie.Button("exportPdfButtonId").ClickNoWait();

    fileDownloadHandler.WaitUntilFileDownloadDialogIsHandled(30);
    fileDownloadHandler.WaitUntilDownloadCompleted(200);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-14T14:46:58.940

这段代码可以解决问题。UsedialogOnce 类可以在 WatiN.UnitTests 代码中找到，它将成为 WatiN 1.3 版本的一部分（可能会在 10 月 14 日发布）。

FileDownloadHandler fileDownloadHandler = new FileDownloadHandler(file.FullName); 使用 (new UseDialogOnce(ie.DialogWatcher, fileDownloadHandler)) { ie.Button("exportPdfButtonId").ClickNoWait();

```
fileDownloadHandler.WaitUntilFileDownloadDialogIsHandled(30);
fileDownloadHandler.WaitUntilDownloadCompleted(200); 
```

}

HTH, Jeroen van Menen 首席开发人员 WatiN

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-14T22:34:27.703

我刚刚遇到了同样的问题，除了我使用 Foxit 而不是 Acrobat。我告诉 Foxit 不要在浏览器中运行，然后这段代码开始正常工作。这是一个完整的单元测试，应该可以解决问题：

```
 string file = Path.Combine(Directory.GetCurrentDirectory(), "test.pdf");

        using (IE ie = new IE())
        {
            FileDownloadHandler handler = new FileDownloadHandler(file);

            using (new UseDialogOnce(ie.DialogWatcher, handler))
            {
                try
                {
                    ie.GoToNoWait("http://www.tug.org/texshowcase/cheat.pdf");

                    //WatiN seems to hang when IE loads a PDF, so let it timeout...
                    ie.WaitForComplete(5);
                }
                catch (Exception)
                {
                    //Ok.
                }

                handler.WaitUntilFileDownloadDialogIsHandled(30);
                handler.WaitUntilDownloadCompleted(30);
            }

        }

        Assert.That(File.Exists(file)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-23T15:59:47.927

看看这个帖子：

[如何使用 WatiN 检查 PDF 是否在浏览器中成功打开？](https://stackoverflow.com/questions/1191897/how-to-check-if-pdf-was-successfully-opened-in-the-browser-using-watin/1457215#1457215)

# javascript - 有没有好的浏览器内代码编辑器？

> ID：198271
> 
> 赞同：50
> 
> 时间：2008-10-13T16:59:28.363
> 
> 标签：javascript, ide, editor, dhtml

我们都见过浏览器内的富文本编辑器，它允许您以所见即所得的方式编辑彩色/样式文本。但是代码编辑器呢？它会在您键入时根据语言规则自动突出显示代码？在文本区域中考虑 Eclipse（但没有重构支持）。

这样的事情存在吗？我想缩放将是一个问题 - 较大的文件将难以有效编辑。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-10-13T17:36:32.063

[CodeMirror](http://codemirror.net/)支持 60 多种语言，以及实现更高级编辑功能（自动完成、代码折叠、可配置键绑定、搜索和替换、linter 集成等）的插件。丰富的编程 API 和 CSS 主题系统可用于自定义 CodeMirror，并使用新功能对其进行扩展。

它自 2007 年初开始开发，有一个[Wikipedia 页面](https://en.wikipedia.org/wiki/CodeMirror)，并被用于大量流行的开源项目（Joomla、Firebug 等）。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2011-01-18T01:13:25.300

[王牌](http://ajaxorg.github.com/ace/)。他们不使用 iFrame。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-13T17:14:35.977

editArea javascript 库[做得](http://www.cdolivet.com/editarea/?page=editArea)很好。[OpenCMS](http://www.opencms.org)内容管理系统使用它作为就地 JSP 和 JavaScript 编辑器。当文件 > 2000 行左右时，着色会有点混乱。

他们页面上的功能列表是：

*   易于集成，仅包含一个脚本和一个函数调用
*   选项卡支持（允许编写格式良好的源代码）
*   搜索和替换（使用正则表达式）
*   可定制的实时语法高亮（目前：PHP、CSS、Javascript、Python、HTML、XML、VB、C、CPP、SQL、Pascal、Basic、Brainf*ck）
*   自动缩进新行
*   行号
*   多语言支持（目前：克罗地亚语、丹麦语、英语、法语、德语、意大利语、日语、波兰语、葡萄牙语）
*   全屏模式
*   可以在与“原型”和“mootools”之类的库相同的环境中工作。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-01T19:30:05.347

Mozilla 的 Bespin 看起来*很*有趣，但该项目已[停止](https://mozillalabs.com/en-US/skywriter/)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-01-31T14:04:20.993

如果您是 JavaScript 开发人员，[Cloud9看起来很有趣。](https://c9.io/)

Amy Editor 是我今天遇到的另一个基于浏览器的编辑器 - 看起来它正在尝试在浏览器中模拟 TextMate - 包括 Bundles 和 Snippets - 尽管该项目看起来可能已经死了......[主页/演示](http://www.amyeditor.com/)和[来源GitHub](https://github.com/aprilchild/aprilchild)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-08-01T03:44:56.490

您可以查看用于 Web 开发的~~dockPHP~~ [StackHive](http://stackhive.com)（基于 codemirror）。现在它支持 HTML/CSS 开发，但我也在进行实时 javascript-ing 工作。

免责声明：我是dockPHP的创始人：）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-09T21:04:03.827

这是一个附带的建议——但我使用[Firefox 插件“It's All Text！”](https://addons.mozilla.org/en-US/firefox/addon/4125) 将我的文本区域发送到进行编辑——所有好的标记、搜索等。

当然，这取决于用户，并且不能轻易地向访问者推出，如果这是您的意图的话。

但是，无论如何，我倾向于对浏览器内编辑器的限制感到恼火。（SO 在编辑期间捕获我的 Ck 的方式仍然让我措手不及...... [这意味着我不会在 Emacs 中编辑*所有内容......]）*

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-13T17:31:43.540

[Javascript VI](http://gpl.internetconnection.net/vi/)，有一些错误，但这是一个有趣的想法。VI FTW！

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-12-01T17:11:37.243

我用codiad。我将它与 PHP、js 和 C 一起使用。特点：

*   支持 40 多种语言插件库
*   错误检查和通知
*   多用户支持
*   编辑器屏幕分割
*   本地存储冗余
*   高级搜索工具
*   智能自动完成
*   实时协作编辑
*   超过 20 个语法颜色主题
*   完全开源
*   轻松定制源
*   在您自己的服务器上运行
*   快速下载备份
*   最大编辑器屏幕空间
*   i18n 语言支持

[http://codiad.com](http://codiad.com)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-07-18T03:46:41.497

[codeandbox.com](http://codesandbox.com)是多个框架的新选择。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-05-05T10:16:03.637

**Eclipse Orion**提供了一个成熟的[代码编辑](https://wiki.eclipse.org/Orion/How_Tos/Code_Edit)器和一个缩小的[Orion 编辑器](https://wiki.eclipse.org/Orion/How_Tos/Editor_Build)。你可以在这里看到它的[演示](https://orionhub.org/examples/editor/demo.html)。

# file - 从损坏的媒体中读取数据

> ID：198272
> 
> 赞同：7
> 
> 时间：2008-10-13T16:59:33.727
> 
> 标签：file, disk, recovery

即使 Windows 资源管理器被炸毁，是否可以读取损坏的媒体（cd、hdd、dvd...）？

我的意思是，是否有一组 API 或其他东西可以在非常低的级别（在资源管理器之下？）访问磁盘并读取可以检索到的任何内容，即使它只是部分内容，特别是如果你仍然可以看到该文件来自资源管理器，但无法对其执行任何操作，因为它以某种方式损坏（CD 上的划痕等）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-13T18:23:43.683

Windows Explorer 的主要问题是它不支持在读取错误后恢复复制。例如，大多数表面划伤的 CD 每次弹出并重新插入时都会在磁盘的不同区域出现故障。

因此，使用支持恢复复制操作的实用程序，可以通过执行几次“弹出/重新加载/恢复”来读取损坏 CD 的全部内容。

事实上，这就是[我编写的实用程序](http://aib.ftuff.com/get.php?file=filecopy.exe)所做的，而且我从来不需要任何更高级的东西来读取划痕的磁盘。（它只是使用 ReadFile 和 WriteFile。）

低一级是通过将诸如“\.\F:”之类的字符串（注意：这里的斜杠是字面意思）传递给 CreateFile 来打开原始分区（即磁盘映像）。它可以让你从驱动器中读取原始扇区，但是从这些数据中重建文件会很困难。

事实上，“\.\”语法允许您在“\GLOBAL??”中打开设备。Windows 对象管理器命名空间的分支，就好像它们是文件一样。这与使用 /dev/x 作为参数调用 dd 没有什么不同。还有一个“\Device”分支，但只能通过 DeviceIoControl()（即 ioctl()）访问，这意味着没有简单的 ReadFile()/WriteFile() 接口。

我猜，任何低于该级别的都将是特定于设备的；就像某些 CD 刻录程序那样读取原始 CD-ROM 数据（包括 ECC 位）。您必须对特定媒体（CD、闪存、DVD）以及您的硬件允许您在它们上执行的操作进行一些研究。

注意：反斜杠似乎在访问网页的过程中丢失了；您需要将“反斜杠点反斜杠设备名称”传递给 CreateFile。当然，您也需要逃脱它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T18:32:01.123

第一步是[dd_rescue](http://www.garloff.de/kurt/linux/ddrescue/)。之后，您可以自由尝试任何方法来重建数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-13T17:17:20.043

如果您想这样做，请从 Linux 端进行 - 请参阅：http : [//sourceforge.net/projects/monkeycity/opensource](http://sourceforge.net/projects/monkeycity/)

或现成的应用程序和免费软件：[http ://www.theabsolute.net/sware/dskinv.html](http://www.theabsolute.net/sware/dskinv.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-04-09T02:22:52.317

还有[GNU**`ddrescue`**](http://www.gnu.org/software/ddrescue/)

> GNU ddrescue 是一个数据恢复工具。它将数据从一个文件或块设备（硬盘、cdrom 等）复制到另一个，试图在读取错误的情况下首先挽救好的部分。

确保使用 3-arg 版本（[手册](http://www.gnu.org/software/ddrescue/manual/ddrescue_manual.html)）：

```
ddrescue [options] infile outfile [mapfile] 
```

也就是说，**`mapfile`**即使 a 是可选的，也要使用它，因为：

> 如果您使用 ddrescue 的 mapfile 功能，可以非常有效地抢救数据（仅读取需要的块）。您也可以随时中断救援，稍后在同一点恢复。映射文件是 ddrescue 有效性的重要组成部分。除非您知道自己在做什么，否则请使用它。

它也包含在 Cygwin 和 Homebrew 中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-13T18:53:32.657

我有两个磁盘开始在我身上瓦解。从不可读扇区的图案来看，我认为它们的乳液内部有剥落。WinXP Explorer 只是举手并说驱动器甚至不存在。

[在这两种情况下，我都使用了 Runtime Software ( http://www.runtime.org/](http://www.runtime.org/) )的“GetDataBack for NTFS” 。您可以下载免费试用版，该试用版会告诉您付费后*可以获得*什么。我买的时候是 49 美元，但我看到现在是 79 美元。

这个节目太棒了。它不一定很快，因为它会一遍又一遍地重读某些扇区，试图从多次尝试中获得共识值，但是当它完成后，你可以取回你认为永远消失的东西。我有一个驱动器需要 10 多个小时来分析，但完成后我得到了 500GB 驱动器的 97% 以上。绝对物有所值。

另一个很棒的工具是 Beyond Compare。我有 rev 2.5.3，但目前是 3.?? 费用为 30 美元。他们有一个全功能的 30 天跟踪。它在复制大量文件（并且只复制那些需要复制的文件）方面做得很好，而且与资源管理器不同，它不会在出现故障时崩溃。如果您熟悉 Samba 人的那个程序，它有点像 Windows 的可视化 rsync。

除了作为一个非常满意的客户之外，我与提到的任何一家公司都没有任何联系。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-13T17:06:48.143

我不知道 Windows Explorer 和 Win32 API 之间存在什么层。您可以尝试使用 Win32 File I/O 编写程序。如果这不起作用，那么您必须编写自己的设备驱动程序才能降低。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-13T17:45:51.280

我从 linux 方面获得了一些运气，或者使用了 BartPE ( [http://www.nu2.nu/pebuilder/](http://www.nu2.nu/pebuilder/) )，但是仅仅看到文件并不总是意味着文件将是可恢复的，无论你从 Windows 或 Linux 重新尝试。您最好的选择可能是使用恢复程序的试用版。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-13T19:31:22.097

从磁存储设备中恢复数据的黄金标准必须是[SpinRite](http://www.spinrite.info)。虽然它是一个商业应用程序，所以你可能不会从中学到很多东西。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-13T19:38:34.813

如果你身边有一台 Linux 机器，我可以推荐[dvdisaster](http://dvdisaster.net/en/index.php "dv灾难")。它最初用于创建纠错文件，但它也将 DVD 读入图像并忽略读取错误；并且您可以一个接一个地使用不同的驱动器来填充图像中缺失的扇区。

# javascript - FCKeditor 插件问题

> ID：198279
> 
> 赞同：0
> 
> 时间：2008-10-13T17:00:54.240
> 
> 标签：javascript, asp-classic, wysiwyg, fckeditor

我是一个尝试为 FCKeditor 开发的完整初学者，所以请耐心等待。我的任务是开发一个自定义插件，允许用户浏览用户上传的一组特定图像。本质上，用户首先附加图像，然后使用 FCKeditor 插入这些图像。

所以我有我的插件目录：

*   郎
*   fckplugin.js
*   img.png（用于工具栏按钮）

我正在寻找有关自定义文件浏览器策略的一些帮助（我们称之为 mybrowser.asp）。

1) mybrowser.asp 是否应该在插件目录中？它是动态的，仅适用于站点的一个特定区域。

2) 我应该如何将查询字符串传递给 mybrowser.asp？

3) 对于开发 FCKeditor 插件还有其他建议吗？任何可能对我有帮助的示例插件？

编辑：传递给插件页面的查询字符串将与主机页面上的完全相同。（这是一个非常具体的插件，只会在一个地方使用）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-13T17:16:15.207

除非您计划支持多种语言，否则您不需要 lang 目录。但即便如此，我也会先让插件以一种语言工作。

我可能会将 mybrowser.asp 放在插件目录中。

这是 fckplugin.js 的一些代码，可以帮助您入门。

```
// Register the related command. 
// RegisterCommand takes the following arguments: CommandName, DialogCommand 
// FCKDialogCommand takes the following arguments: CommandName, 
//    Dialog Title, Path to HTML file, Width, Height

FCKCommands.RegisterCommand( 
    'MyBrowser', 
    new FCKDialogCommand( 
        'My Browser', 
        'Select An Image',
        FCKPlugins.Items['MyBrowser'].Path + 'mybrowser.asp',
        500,
        250) 
);

// Create the toolbar button. 
// FCKToolbarButton takes the following arguments: CommandName, Button Caption 

var button = new FCKToolbarButton( 'MyBrowser', 'Select An Image' ) ; 
button.IconPath = FCKPlugins.Items['MyBrowser'].Path + 'img.png' ; 
FCKToolbarItems.RegisterItem( 'MyBrowser', button ) ; 
```

编辑：我没有对此进行测试，但是您应该能够通过按照这些方式执行某些操作来附加查询字符串。

```
 'Select An Image',
        FCKPlugins.Items['MyBrowser'].Path + 'mybrowser.asp' + window.top.location.search,
        500, 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T14:45:59.567

您可能不需要编写自己的文件浏览器，因为此功能是内置的。如果您检查 fckconfig.js 文件并搜索**var _FileBrowserLanguage**，您可以指定您的服务器语言，它应该希望使用**编辑器中的等效文件 -> 文件管理器-> 连接器**文件夹。

如果您希望[检查文档](http://docs.fckeditor.net/)，那有望使您走上正轨。

# compression - SharpLibZip：添加没有路径的文件

> ID：198285
> 
> 赞同：16
> 
> 时间：2008-10-13T17:04:34.030
> 
> 标签：compression, sharpziplib

我正在使用以下代码，使用[SharpZipLib](http://www.sharpziplib.com/)库将文件添加到 .zip 文件，但每个文件都以其完整路径存储。我只需要将文件存储在 .zip 文件的“根目录”中。

```
string[] files = Directory.GetFiles(folderPath);
using (ZipFile zipFile = ZipFile.Create(zipFilePath))
{
     zipFile.BeginUpdate();
     foreach (string file in files)
     {
          zipFile.Add(file);
     }
     zipFile.CommitUpdate();
} 
```

我在提供的文档中找不到有关此选项的任何信息。由于这是一个非常受欢迎的图书馆，我希望阅读此书的人可能会有所了解。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-10-14T12:11:13.730

我的解决方案是将 的`NameTransform`对象属性设置`ZipFile`为 a`ZipNameTransform`并将其`TrimPrefix`设置为文件的目录。这会导致条目名称的目录部分（即完整文件路径）被删除。

```
public static void ZipFolderContents(string folderPath, string zipFilePath)
{
    string[] files = Directory.GetFiles(folderPath);
    using (ZipFile zipFile = ZipFile.Create(zipFilePath))
    {
        zipFile.NameTransform = new ZipNameTransform(folderPath);
        foreach (string file in files)
        {
            zipFile.BeginUpdate();
            zipFile.Add(file);
            zipFile.CommitUpdate();
        }
    }
} 
```

很酷的是 NameTransform 属性是 type `INameTransform`，允许自定义名称转换。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-13T17:12:29.537

将[System.IO.Path.GetFileName()](http://msdn.microsoft.com/en-us/library/system.io.path.getfilename.aspx)与 ZipFile.Add() 的 entryName 参数结合使用怎么样？

```
string[] files = Directory.GetFiles(folderPath);
using (ZipFile zipFile = ZipFile.Create(zipFilePath))
{
     zipFile.BeginUpdate();
     foreach (string file in files)
     {
          zipFile.Add(file, System.IO.Path.GetFileName(file));
     }
     zipFile.CommitUpdate();
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-13T17:12:40.940

MSDN 条目`Directory.GetFiles()`表示*返回的文件名附加到提供的路径参数。*（[http://msdn.microsoft.com/en-us/library/07wt70x2.aspx](http://msdn.microsoft.com/en-us/library/07wt70x2.aspx)），因此您传递的字符串`zipFile.Add()`包含路径。

根据 SharpZipLib 文档，Add 方法有一个重载，

> ```
> public void Add(string fileName, string entryName) 
> Parameters:
>   fileName(String) The name of the file to add.
>   entryName (String) The name to use for the ZipEntry on the Zip file created. 
> ```

试试这个方法：

```
string[] files = Directory.GetFiles(folderPath);
using (ZipFile zipFile = ZipFile.Create(zipFilePath))
{
     zipFile.BeginUpdate();
     foreach (string file in files)
     {
          zipFile.Add(file, Path.GetFileName(file));
     }
     zipFile.CommitUpdate();
} 
```

# asp.net - ASP.NET cookie 过期时间始终为 1/1/0001 12:00 AM

> ID：198295
> 
> 赞同：31
> 
> 时间：2008-10-13T17:11:02.520
> 
> 标签：asp.net, cookies

我正在使用以下代码设置 cookie 过期时间：

* * *

```
// remove existing cookies.
request.Cookies.Clear();
response.Cookies.Clear();

// ... serialize and encrypt my data ...

// now set the cookie.
HttpCookie cookie = new HttpCookie(AuthCookieName, encrypted);
cookie.Expires = DateTime.Now.Add(TimeSpan.FromHours(CookieTimeOutHours));
cookie.HttpOnly = true;
response.Cookies.Add(cookie);

// redirect to different page 
```

* * *

当我在另一个页面中读取 cookie 超时时，我得到了 1/1/0001 12:00 AM。如果有人可以帮助我解决问题，我将不胜感激。我正在使用 ASP.NET 3.5

好的。阅读 Gulzar 的链接后，我似乎根本无法检查 HttpRequest 上的 cookie.Expires 吗？因为链接似乎表明 cookie.Expires 始终设置为 DateTime.MinValue 因为服务器永远无法知道客户端计算机上的实际时间？所以这意味着我必须自己将时间存储在cookie中并检查它？我的理解正确吗？

谢谢尚卡尔

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-01-20T11:51:11.697

这里的问题实际上并不在于 ASP.NET，而在于浏览器在 http 请求中提供的信息量。无论您在服务器端使用何种平台，都无法获得到期日期。

正如您在问题中总结的那样，HttpRequest 对象提供的 HttpCookie 对象的 Expires 属性始终设置为 1/1/0001 12:00 AM。这是因为浏览器在发送请求时不会将过期信息以及域和路径等属性传递给服务器。发送的唯一 cookie 信息是名称和值。因此，请求中的 cookie 将具有这些“缺失”字段的默认值，因为它们在服务器端是未知的。

我猜这背后的原因是 cookie 的到期、域和路径属性仅用于浏览器在决定是否应在请求中传递 cookie 以及服务器只对名称和值感兴趣。

您建议将到期时间复制为 cookie 的另一个值的解决方法是获得您正在寻找的行为的一种方法。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-10-08T15:56:28.840

起初我也很失望，为什么 Request cookie 没有实际的 Expires 值。使用 Fiddler2 调试 http 后。我知道 .NET 没有错，相反，http 协议是请求 cookie 表现如此的答案。

如果您在应用程序和浏览器之间使用 Fiddler。您可以看到正确发送到浏览器的响应 cookie，其中包含所有域、路径、过期、安全和 httponly。但是，http cookie 标头中的下一个请求 cookie 没有 expires 值，它只有 cookie 名称和值。负责发送此请求标头的浏览器，我相信这是因为 http 协议。原因是因为要最小化大小并且 Web 服务器不需要检查它，因为它们实际上设置了所有值。他们应该注意到。

因此，由于您已经知道日期，因此您无需检查 web 请求的过期值。只是，如果您收到 cookie，则意味着 cookie 尚未过期。设置过期时间后，浏览器将处理过期时间。如果要更改过期时间，只需在响应中设置新值。

呼叫MeLaNN

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-08-08T04:53:06.073

为了解决这个问题，我向主体添加了一个声明，然后我可以读取该声明并向用户显示 cookie 到期时间，如下所示：

```
 public static void Configuration(IAppBuilder app)
    {

        app.UseCookieAuthentication(new CookieAuthenticationOptions
        {
            AuthenticationType = DefaultAuthenticationTypes.ApplicationCookie,
            LoginPath = new PathString(string.Format("~/Login.aspx"),
            Provider = new CookieAuthenticationProvider
            {
                OnValidateIdentity = SetExpiryClaim 
            }
        });

        app.MapSignalR();
    }

    private static Task SetExpiryClaim(CookieValidateIdentityContext context)
    {
        var contextExpireUtc = context.Properties.ExpiresUtc;

        var claimTypeName = "contextExpireUtc";
        var identity = context.Identity;

        Claim contextExpiryClaim;

        if (identity.HasClaim(c => c.Type == claimTypeName))
        {
            contextExpiryClaim = identity.FindFirst(claimTypeName);
            identity.RemoveClaim(contextExpiryClaim);
        }
        contextExpiryClaim = new Claim(claimTypeName, contextExpireUtc.ToString());
        context.Identity.AddClaim(contextExpiryClaim);

        return Task.FromResult(true);
    } 
```

然后，您可以稍后通过 ClaimsPrinciple 检索到期时间

```
 ClaimsPrincipal principle = Thread.CurrentPrincipal as ClaimsPrincipal;
    DateTime contextExpiry = principle.Claims.First(p => p.Type == "contextExpireUtc").Value.AsDateTime(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-02T06:54:05.437

链接中讨论的版本问题没有帮助。基本上 ASP.NET cookie 很烂。我必须自己将过期日期时间存储在 cookie 中，并在每个请求中检查它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-09T14:45:30.417

在使用 Iphone 进行测试时，我遇到了类似的问题。问题是由于 Iphone 在设备上设置了错误的日期时间，因此将 cookie 过期日期设置为 datetime.now.adddays(-1) 不会使 cookie 过期

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-10-30T10:17:09.033

来自浏览器的请求仅发送 cookie 的`name`和`value`，如下所示：

```
GET /sample_page.html HTTP/2.0
Host: www.example.org
Cookie: yummy_cookie=choco; tasty_cookie=strawberry 
```

所以这**在 ASP.NET 中不是问题**。正如一些答案和评论中提到的，到期日期是确定是否将该 cookie 发送到服务器。因此，如果 cookie 过期，它将`null`在服务器上。

此外，解决方法是在该 cookie 上存储另一个值来确定到期日期（如果你真的需要它）

参考：[使用 HTTP cookie](https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies#The_client_sends_back_to_the_server_its_cookies_previously_stored)

# javascript - XUL - 在主浏览器窗口中加载新页面的侧边栏按钮

> ID：198312
> 
> 赞同：1
> 
> 时间：2008-10-13T17:16:57.717
> 
> 标签：javascript, firefox, iframe, xul

我正在学习如何制作 Firefox 扩展。我创建了一个 xul 和覆盖文件，它在我的浏览器中创建了一个侧边栏。我正在尝试将按钮放在侧边栏中，以在主浏览器窗口中加载不同的页面。我不确定如何访问主浏览器窗口并在其中加载新的 url。我这里有一个简单的按钮和脚本，可以向您展示我目前所拥有的。任何关于这个主题的光都将不胜感激！

```
<script type="application/x-javascript">    
    function loadURL(url) {     

            // I know this part is wrong. How do I load url into main browser??
    window.content.open(url)
    }
</script> 

<button
     id="identifier"
     class="dialog"
     label="Yahoo"
     image="images/image.jpg"
     oncommand="loadURL("http://www.yahoo.com);"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-13T19:08:28.070

您应该能够通过以下方式访问活动选项卡窗口上下文：

```
函数加载URL（网址）{  
    content.wrappedJSObject.location = url;
}

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-08-01T14:23:50.983

This another method!

```
document.getElementById('1').loadURI('http://tridz.com') 
```

# c# - Linq to SQL 类的生命周期

> ID：198320
> 
> 赞同：4
> 
> 时间：2008-10-13T17:18:55.453
> 
> 标签：c#, linq-to-sql, oop, c#-3.0

据我所知，当我新建一个*Linq to SQL 类*时，它相当于新建一个*SqlConnection 对象*。

假设我有一个具有两种方法的对象：`Delete()`和`SubmitChanges()`. *在每个方法中更新Linq to SQL 类*对我来说是明智的，还是将一个持有*Linq to SQL 类*的私有变量- 由构造函数新建 - 是要走的路？

我试图避免的是超时。

**更新：**

```
namespace Madtastic
{
    public class Comment
    {
        private Boolean _isDirty = false;
        private Int32 _id = 0;
        private Int32 _recipeID = 0;
        private String _value = "";
        private Madtastic.User _user = null;

        public Int32 ID
        {
            get
            {
                return this._id;
            }
        }

        public String Value
        {
            get
            {
                return this._value;
            }

            set
            {
                this._isDirty = true;

                this._value = value;
            }
        }

        public Madtastic.User Owner
        {
            get
            {
                return this._user;
            }
        }

        public Comment()
        {
        }

        public Comment(Int32 commentID)
        {            
            Madtastic.DataContext mdc = new Madtastic.DataContext();

            var comment = (from c in mdc.Comments
                           where c.CommentsID == commentID
                           select c).FirstOrDefault();

            if (comment != null)
            {
                this._id = comment.CommentsID;
                this._recipeID = comment.RecipesID;
                this._value = comment.CommentsValue;
                this._user = new User(comment.UsersID);
            }

            mdc.Dispose();
        }

        public void SubmitChanges()
        {
            Madtastic.DataContext mdc = new Madtastic.DataContext();

            var comment = (from c in mdc.Comments
                           where c.CommentsID == this._id
                           select c).FirstOrDefault();

            if (comment != null && this._isDirty)
            {
                comment.CommentsValue = this._value;
            }
            else
            {
                Madtastic.Entities.Comment c = new Madtastic.Entities.Comment();

                c.RecipesID = this._recipeID;
                c.UsersID = this._user.ID;
                c.CommentsValue = this._value;

                mdc.Comments.InsertOnSubmit(c);
            }

            mdc.SubmitChanges();

            mdc.Dispose();
        }

        public void Delete()
        {
            Madtastic.DataContext mdc = new Madtastic.DataContext();

            var comment = (from c in mdc.Comments
                           where c.CommentsID == this._id
                           select c).FirstOrDefault();

            if (comment != null)
            {
                mdc.Comments.DeleteOnSubmit(comment);

                mdc.SubmitChanges();

                this._isDirty = false;
                this._id = 0;
                this._recipeID = 0;
                this._value = "";
                this._user = null;
            }

            mdc.Dispose();
        }
    }
} 
```

**重构代码（根据 Grank 的规范）：**

```
namespace Madtastic
{
    public sealed class CommentNew : IDisposable
    {
        private Madtastic.DataContext _mdc;
        private Madtastic.Entities.Comment _comment;
        private Madtastic.User _user;

        public Int32 ID
        {
            get
            {
                return this._comment.CommentsID;
            }
        }

        public String Value
        {
            get
            {
                return this._comment.CommentsValue;
            }

            set
            {
                this._comment.CommentsValue = value;
            }
        }

        public Madtastic.User Owner
        {
            get
            {
                return this._user;
            }
        }

        public void Comment(Int32 commentID)
        {
            this._mdc = new Madtastic.DataContext();

            this._comment = (from c in _mdc.Comments
                             where c.CommentsID == commentID
                             select c).FirstOrDefault();

            if (this._comment == null)
            {
                this._comment = new Madtastic.Entities.Comment();

                this._mdc.Comments.InsertOnSubmit(this._comment);
            }
            else
            {
                this._user = new Madtastic.User(this._comment.User.UsersID);
            }
        }

        public void SubmitChanges()
        {
            this._mdc.SubmitChanges();
        }

        public void Delete()
        {
            this._mdc.Comments.DeleteOnSubmit(this._comment);

            this.SubmitChanges();
        }

        void IDisposable.Dispose()
        {
            this._mdc.Dispose();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T18:57:16.253

取决于您所指的“LINQ-to-SQL 类”以及相关代码的外观。
如果您正在谈论 DataContext 对象，并且您的代码是一个生命周期很长的类或您的程序本身，我相信最好在构造函数中对其进行初始化。这并不像创建和/或打开一个新的 SqlConnection，它实际上非常聪明地管理其数据库连接池以及并发性和完整性，因此您无需考虑它，这是我迄今为止体验的一部分乐趣LINQ 到 SQL。我从未见过发生超时问题。
您应该知道的一件事是，跨 DataContext 范围共享表对象非常困难，如果可以避免的话，真的不建议这样做。Detach() 和 Attach() 可能很糟糕。因此，如果您需要传递代表 SQL 数据库表中一行的 LINQ-to-SQL 对象，您应该尝试设计 DataContext 对象的生命周期，以涵盖您需要对任何对象执行的所有工作从中产生的。
此外，实例化 DataContext 对象会产生大量开销，并且由它管理大量开销......如果您一遍又一遍地访问相同的几个表，最好使用相同的 DataContext 实例，因为它将管理其连接池，并在某些情况下缓存一些东西以提高效率。但是，建议不要将数据库中的每个表都加载到 DataContext 中，只加载您需要的表，如果正在访问的表在非常独立的情况下非常独立，您可以考虑将它们拆分为多个 DataContext，这会给您一些如果围绕它们的情况不同，则有关何时初始化每个选项的选项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-13T21:57:26.013

现在查看了您编辑发布的代码示例，我肯定会重构您的类以利用 LINQ-to-SQL 的内置功能。（我不会编辑我之前的评论，因为它是对一般问题的更好答案）
您的类的字段似乎是数据库中 Comments 表上列的非常直接的映射。因此，您不需要在本课程中手动完成大部分手动操作。大多数功能只需拥有一个 Madtastic.Entities.Comment 类型的私有成员即可处理（如果您必须维护此类与项目其余部分的交互方式，只需将您的属性映射到其属性）。然后，您的构造函数只需初始化一个私有成员 Madtastic.DataContext 并将您的私有成员 Madtastic.Entities.Comment 设置为对其进行 LINQ 查询的结果。如果评论为空，则创建一个新评论并在 DataContext 上调用 InsertOnSubmit。（但提交更改没有意义，因为您还没有为这个新对象设置任何值）
在您的 SubmitChanges 中，您所要做的就是在 DataContext 上调用 SubmitChanges。它自己跟踪数据是否需要更新，如果不需要，它不会访问数据库，所以你不需要_isDirty。
在您的 Delete() 中，您所要做的就是在 DataContext 上调用 DeleteOnSubmit。
事实上，稍微回顾一下，您可能会发现根本不需要 Madtastic.Comment 类，而 Madtastic.Entities.Comment LINQ-to-SQL 类可以直接充当您的数据访问层。似乎唯一的实际区别是采用 commentID 的构造函数，以及 Entities.Comment 具有 UsersID 属性的事实，而您的 Madtastic.Comment 类具有整个 User。（但是，如果 User 也是数据库中的一个表，并且 UsersID 是其主键的外键，您会发现 LINQ-to-SQL 在 Entities.Comment 对象上创建了一个 User 对象，您可以直接访问它带评论。用户）
如果你发现你可以完全消除这个类，这可能意味着你可以进一步优化 DataContext 的生命周期，方法是将它提升到项目中使用 Comment 的方法。

编辑发布以下示例重构代码（对任何错误表示歉意，因为我在几秒钟内在记事本中键入它而不是打开 Visual Studio，而且我不会为您的项目获得智能感知）：

```
namespace Madtastic
{
    public class Comment
    {
        private Madtastic.DataContext mdc;
        private Madtastic.Entities.Comment comment;

        public Int32 ID
        {
            get
            {
                return comment.CommentsID;
            }
        }

        public Madtastic.User Owner
        {
            get
            {
                return comment.User;
            }
        }

        public Comment(Int32 commentID)
        {            
            mdc = new Madtastic.DataContext();

            comment = (from c in mdc.Comments
                           where c.CommentsID == commentID
                           select c).FirstOrDefault();

            if (comment == null)
            {
                comment = new Madtastic.Entities.Comment();
            mdc.Comments.InsertOnSubmit(comment);
            }

        }

        public void SubmitChanges()
        {

            mdc.SubmitChanges();

        }

        public void Delete()
        {
            mdc.Comments.DeleteOnSubmit(comment);
            SubmitChanges();
        }
    }
} 
```

您可能还希望按照许多人的建议实施 IDisposable/using。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T18:47:24.650

我假设您的意思是为 DataContext 类保存一个值？就个人而言，我的偏好是默认为任何 IDisposable（DataContext 类是）的“使用”子句。在构造函数中实例化并将 DataContext 保存在私有变量中将使这成为不可能。所以对我来说，我会将实例化放在方法中，但更具体地说，我会将实例化放在 using 子句中，以便确保正确处理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T20:01:45.950

我当前的一个项目使用 Linq to SQL，我们将数据上下文作为对象内部的私有字段保存。这样做在大多数情况下并不麻烦，如果我在构造函数中传入数据上下文，则允许将来进行模拟，并且看起来比打开多个数据上下文更干净。与 Jacob 上面提到的类似，我们正在实现 IDisposable 以确保在不再需要对象时可以可靠地关闭数据上下文。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-13T20:05:28.190

默认情况下，SqlConnections 是池化的。你应该把它们更新成一堆来证明汇集成本是合理的！

DataContexts 制作起来很便宜（在第一个之后）。你应该把它们换成一堆来证明第一个新的成本是合理的！

# .net - 将跟踪输出重定向到控制台

> ID：198322
> 
> 赞同：75
> 
> 时间：2008-10-13T17:19:31.427
> 
> 标签：.net, vb.net, .net-2.0, console, trace

假设我正在 VB.Net 中开发一个小型批处理控制台应用程序。我希望能够像这样构建应用程序：

```
Sub WorkerMethod()
   'Do some work
   Trace.WriteLine("Work progress")

   'Do more work
   Trace.WriteLine("Another progress update")

   '...
End Sub

Sub Main()

   'Do any setup, like confirm the user wants to continue or whatever

   WorkerMethod()     

End Sub 
```

请注意，我正在使用`Trace`而不是`Console`用于我的输出。这是因为工作方法可能从其他地方调用，甚至存在于不同的程序集中，我希望能够将不同的跟踪侦听器附加到它。那么如何将控制台连接到跟踪？

我已经可以通过定义一个简单的类（如下所示）并将一个实例添加到 Trace 的 listeners 集合中来做到这一点，但我想知道是否有更被接受或内置的方式来实现这一点：

```
Public Class ConsoleTrace
    Inherits Diagnostics.TraceListener

    Public Overloads Overrides Sub Write(ByVal message As String)
        Console.Write(message)
    End Sub

    Public Overloads Overrides Sub WriteLine(ByVal message As String)
        Console.WriteLine(message)
    End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：158
> 
> 时间：2008-10-13T17:21:45.853

您可以将以下内容添加到您的 exe 的 .config 文件中。

```
<?xml version="1.0"?>
<configuration>
    <system.diagnostics>
        <trace autoflush="true">
            <listeners>
                <add name="logListener" type="System.Diagnostics.TextWriterTraceListener" initializeData="cat.log" />
                <add name="consoleListener" type="System.Diagnostics.ConsoleTraceListener"/>
            </listeners>
        </trace>
    </system.diagnostics>
</configuration> 
```

我还包括了 TextWriter，以防您有兴趣登录到文件。

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2009-10-23T15:35:09.263

乔尔，

您可以这样做而不是 app config 方法：

```
Trace.Listeners.Add(new ConsoleTraceListener()); 
```

或者，如果您想在应用程序的生命周期内管理添加或删除侦听器：

```
ConsoleTraceListener listener = new ConsoleTraceListener();
Trace.Listeners.Add(listener);

Trace.WriteLine("Howdy");

Trace.Listeners.Remove(listener);

Trace.Close(); 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-14T14:59:16.337

很好的解决方案，但我有一种情况，我有不同的 dll 由同一个调用 exe 运行，所以我不想修改调用 exe 的 .config 文件。我希望每个 dll 处理它自己对跟踪输出的更改。

很简单：

```
Stream outResultsFile = File.Create ("output.txt");
var textListener = new TextWriterTraceListener (outResultsFile);
Trace.Listeners.Add (textListener); 
```

当然，这会将 Trace 输出输出到“output.txt”文件。

# javascript - 招聘时测试 HTML/CSS/Javascript 技能

> ID：198337
> 
> 赞同：27
> 
> 时间：2008-10-13T17:26:31.600
> 
> 标签：javascript, html, css, frontend

在招聘前端开发人员时，您应该测试哪些特定技能和实践？评估他们在 HTML、CSS 和 Javascript 方面的技能的好指标是什么？

显然，无表语义 HTML 和纯 CSS 布局可能是关键技能。但是具体的技术呢？他/她应该能够毫不费力地模拟多列布局吗？CSS精灵？等高（或人造）列？HTML 标签的选择是否重要（即过于依赖`<div>`）？他们应该能够（用文字）解释花车是如何工作的吗？

那么javascript技能呢？框架经验（jQuery、Prototype 等）有多重要。今天？

显然，职位的详细信息和他们将从事的工作地点是需要哪些技能的最佳指示。但我想知道在为候选人创建测试时，人们可能会认为哪些特定技能会破坏交易（或制造商）。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-13T17:33:06.610

当我面试客户端开发人员职位的人时，我试图弄清楚：

```
1) 了解 DOM（那是什么，它与 HTML 有什么关系等）
2) 理解 XML/命名空间
3) 理解 JavaScript（面向对象？否则如何）
4) 了解组件化方法（XBL、HTC） - 加
5）理解OO原理
6) JavaScript 闭包
7) 浏览器内存泄漏

```

我马上给出的唯一简单的测试用例：

```
<script type="text/javascript">
变量 a = 1;
</脚本>

```

我建议受访者用技术术语解释那条线。

我还检查了对 Web 技术当前状态的总体认识，在其他问题中，我建议设计一个 Web 浏览器，建议受访者选择他将投入到他的全新生物中的技术，建议可能缺少的技术当前的客户端平台。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-14T12:05:16.807

我可以建议你在线测试，包括 HTML、CSS 和 JavaScript。

[http://tests4geeks.com/test/html-css-javascript](http://tests4geeks.com/test/html-css-javascript)

它有 60 个问题（每个主题 20 个）。考生完成考试后，您将通过电子邮件收到报告。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-13T18:12:18.340

Sergey 和 swilliams 都给出了很好的答案，特别是 swilliams 提到要求投资组合是关键。使用投资组合，您还可以测试以下项目，

*   html 和 css 是否有效？
*   演示文稿是否在浏览器中呈现一致？
*   候选人有 JavaScript 错误吗？如果他们这样做了，这个人是让他们冒泡到表示层还是他们至少用一个 try/catch 块来捕获它们？
*   就 JS 而言，这个人有多先进？他们可以进行表单验证吗？他们可以做正则表达式吗？他们是否依赖 MM_Preloader？（呸！）

作品集还可以让人感受到某人对 Web 开发的热情。此外，如果他们为其他人建立了一个网站，仅此一项就提供了与候选人讨论许多事情的机会，

*   他们是如何着手开发 UI 的？
*   什么样的规划进入了网站？
*   如何发现/满足用户期望？
*   施工过程中遇到了哪些挑战？

除了这些项目之外，您可能要考虑的另一种方法是开发人员测试，您可以将其发送给潜在雇员。没有什么比一天更难的了，但足够的脑筋急转弯来看看他们是否可以解决 CSS 或 JS 问题。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-13T17:30:56.443

索取作品集，然后与您的团队一起审查。这照顾了装腔作势的人和“不能很好地处理采访”的人。

除此之外，我会向他们展示一些相对简单的模型和一台笔记本电脑，然后说“试试吧”。

也许问他们今天最喜欢网页设计的什么，最讨厌什么。询问他们对即将发生的事情（HTML 5、IE 8、Chrome 等）的看法，看看他们是否跟上即将发生的事情。

询问他们是否有最喜欢的 JavaScript 框架以及为什么。也许让他们在 JS 中编写一些代码，例如 [in] 著名的嘶嘶声问题。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-14T06:10:28.780

在我的公司，我们不使用测试，而且作品集更重要，尤其是因为我们倾向于关注候选人的个人动机和对前端开发的热情。

但是，如果我应该在招聘之前给候选人一个测试，我会这样做：

交出一张经过 Photoshop 处理的网页的打印件，该网页代表了一个清晰的语义组件树。询问该人他或她将如何得出 html 的结果。只是请他或她大声思考。看到一个页面时会想到什么，知道它需要开发。

然后归结为候选人采取的方法。

为每个特定的 html 部分选择最佳可用标记是一个（重要的）方面，但可以由周围有经验的人掌握，以指导新员工。能够正确地将设计分解为其语义组件，识别部分并将主要和次要内容与导航分开不是数学或科学，因此难以测试。但是关于分解页面方法的对话可能会将有经验的人和初学者分开。

但正如我在第一行所说的，我们通常会询问一个人在空闲时间做了哪些与网络相关的工作，例如博客、游戏或演示。如果做了任何事情，这个人通常非常擅长前端开发，或者渴望学习和适应。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-14T02:55:02.170

我们过去要么为他们设置一个小简报，让他们在特定的时间范围内工作，要么在某些情况下与他们签订一份工作，看看他们的进展如何。

我从不担心让某人坐在面试室的笔记本电脑前并想出一个解决方案，因为那种环境（你希望）与正常的工作条件不太一样。

简介的确切性质在很大程度上取决于您正在寻找的技能。在一些商店中，前端开发人员在实现设计“氛围”时将不得不承担一定程度的填补设计空白，和/或履行“品牌警察”职责。
在这些情况下，在简报中留下一些关于排版的一些细节和其他小细节的漏洞可以给你一些关于他们在这些方面的能力的提示。
让他们选择 javascript 框架，他们是选择最适合这项工作的框架，还是他们知道的框架。（主观问题，是的。但是为了一个日期选择器和一些菜单动画而引入道场可能是矫枉过正）

我会寻找可以实现基于 css 的布局的人，但如果在处理遗留项目时需要，实际上可以在基于表的布局上工作。尽管受到了诽谤，但 hacky 表格布局的一些更精细的细节并不总是那么容易。

这类任务的主要内容是对细节的关注，他们是否为打印添加了一套样式规则，使用了适当的图像大小和格式，生成了干净有效的代码，他们是否因为真的想要这份工作而去追求黄金，并准备稍微伸展自己来得到它。

因为你给了他们一些额外的时间，所以期望他们试图给人留下深刻印象是公平的，而不是把他们放在一张陌生的桌子上并告诉他们去做的那种充满压力的情景。因此，虽然现实并且不期望每天在每项任务上都完美地工作，但在这种情况下，我正在寻找黄金，或者至少证明黄金是目标。

扔一个他们以前没有做过的东西的曲线球......看看他们能很快把它捡起来。经验是好的，但在一个变化如此之快的领域，快速学习的能力可能更为重要。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-13T22:03:58.903

了解浏览器的不同之处也很关键。尤其是 IE。如果他们只为 IE 编码过，请当心！Vica Versa 也是如此，如果他们从未在 IE6/7 中测试过他们的东西，他们就不知道它的失败有多可怕。

如果他们能说出 3 件失败的事情，或者在 IE 中需要解决方法，那么他们很可能会成功。如果他们不能，他们还没有足够的跨浏览器体验。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-14T02:18:12.883

我问人们他们使用什么工具，他们如何编码，即他们是否使用 DreamWeaver、BBEdit、emacs 或其他什么。假设他们不只是给出一个单词的答案，您通常会了解他们的优先级是什么，他们如何编码等。

然后我问他们如何验证他们的代码，这总是很有趣。

除了通过让他们坐下来敲定一个页面来实际测试他们之外，我还会询问他们所做工作的具体示例，以及他们如何解决问题。

例如，你说*“告诉我们你在一个严格的期限内完成的工作”*或者你说*“告诉我们一个非常令人沮丧的问题以及你是如何克服它的”*或*“在你最近完成的工作中，发生了什么你最自豪？”*

通过这种方式，您可以深入了解他们所做的事情、他们解决问题的技能和经验、他们处理压力和挫折的方式，当然还有他们的变通办法/偷工减料措施是聪明的还是愚蠢的.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-13T22:04:08.217

感谢您到目前为止的所有答案。他们绝对是很好的建议。不过，我还没有准备好将其标记为已接受。我真正寻找的是前端开发人员需要能够在测试环境中生成的具体任务。换句话说，什么是 CSS 的 FizzBu​​zz？

我确实同意，一个扎实的作品集和聪明地谈论这个主题的能力可能会最大限度地降低考试的重要性。另一方面，我认为我们都知道非常善于说大话的候选人，但是当涉及到实际展示实际知识时，他们就功亏一篑了。

@JonathanHolland - 我倾向于不同意。HTML/CSS 确实很容易学习，但是从一些快速教程中获得的知识与花费数年时间做布局的人相比是微不足道的。优秀的 CSS 开发人员可以提供许多技术和实践。

@roenving - 也许我是多余的。通过“纯 CSS”，我的意思是无表。我还指不使用表格作为布局方法的意义上的无表格。但是，这不是 div-vs-table 布局讨论的问题。试试[这里](https://stackoverflow.com/questions/83073/div-vs-table)。尽管我相信现在大多数雇主都会问开发人员是否可以在不使用表格的情况下进行布局（作为一种方法）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-20T15:38:35.837

我没有任何招聘经验，但我参加了许多 Web 开发人员的面试，并且可以讲述我的经历。

在我所有的采访中，一种方法确实被认为是发现真正人才的最佳方式。我承认我不是专家，这可能就是我没有得到这份工作的原因，但这是淘汰那些有能力和优秀的人的绝妙方法。

我们被问了几个关于 DOM、面向对象、闭包、XML 命名空间和一般 Web 设计的问题，然后我们被带到一个安静的办公室，可以看到附近河流的美景，并被要求写几个例子来展示我们的能力. 我们被单独留下，但被告知如果我们需要使用浏览器，将在之后查看源代码和我们的浏览器历史记录。我们被要求使用以下内容制作公司内部网：

*   一个简单的三列布局
*   使用 CSS 制作的漂亮表格
*   一个可用但好看的导航栏。
*   使用 XML 和 JavaScript 进行动态加载

只要花一点时间来做这件事，你就会看到真正能做这件事的人。虽然也许他们的示例总是更好或更适合不同的应用程序，但这只是表明展示开发人员技能的最佳方式是**让他们做出一些事情！**如果你知道你的东西并且他们知道他们的东西，那么他们的代码会很好。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-10-13T21:55:45.410

"

显然，无表语义 HTML 和纯 CSS 布局可能是关键技能。

"

没看懂这句话...

您真的是说为了避免使用表格而以复杂的方式使用表格来完成一项简单的任务会更好吗？-)

餐桌恐惧症就像在没有服务器端帮助的情况下制作大型网站一样难受...

当然，过去十年的餐桌地狱并不有趣，但是如果不使用桌子来完成很多任务真的很愚蠢......

使用 easyist 完成任务的 html 元素，无论它使用哪个标记名！-)

——而且我不明白什么是“纯 CSS 布局”；我从来没有想过如何创建一个没有 html 元素的 html 页面来托管样式表中的布局......

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2008-10-13T19:43:57.890

我知道这不是一个很好的答案，但我做的第一件事就是公开他们的 Word 简历的格式。如果他们利用了 Word 提供的缩进和样式，而不是制表符、制表符、制表符、空格、空格、空格、空格，那么他们就会排在首位。

* * *

## 回答 #13

> 赞同：-9
> 
> 时间：2008-10-13T17:30:00.360

我不会太重视它，因为正确的 HTML/CSS 非常简单，任何人都可以在一周内学会它。

也就是说，您可能想查看他们的投资组合，以帮助您对他们当前的技能水平做出决定。

# c# - 来自 Spring Context 的进度条？

> ID：198341
> 
> 赞同：2
> 
> 时间：2008-10-13T17:28:37.647
> 
> 标签：c#, spring, spring.net

我想创建一个带有进度条的窗口，它显示 Spring 对象实例化的当前状态。从 Spring.Net 的[文档](http://www.springframework.net/docs/1.1.2/reference/html/objects.html#objects-factory-customizing)看来，每当一个对象被实例化时，这似乎 `IObjectPostProcessors`是开始和跟踪的正确点。但是，为了获得“实例化类的百分比”，我需要询问`ObjectDefinitionCount`spring 的工厂以获取配置对象的数量。然而，这在上下文创建完成之前不起作用（[这个问题](https://stackoverflow.com/questions/179140/how-do-i-find-out-when-the-springnet-root-context-has-loaded) 问题似乎也是相关的）。

如果无法使用 Spring 获取启动状态，如何在应用程序启动期间向用户显示信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-29T22:13:08.917

我可以为您提供一种解决方法，尽管它并不完美，但它可能应该是一个不错的估计。

*   您使用持久存储机制（属性文件、数据库等）来跟踪创建的 bean 的数量。
*   您使用 IObjectPostProcessors 更新初始化计数
*   在第一次运行时，显然该值为 0
*   在随后的运行中，您使用最后一次计数来**估计**要完成的初始化次数。

当然，这并不准确，但它应该在大多数情况下提供一个很好的估计。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-04T15:33:13.880

Spring 分两步读取配置 - 首先从配置中读取所有对象定义，然后处理这些定义，必要时实例化单例。

您应该通过实现 IObjectFactoryPostProcessor 来获得您想要的。ObjectFactoryPostProcessors 是最先被实例化的对象。此时对象定义的数量已经可用。使用 IObjectPostProcessor 可为您提供有关正在实例化的每个对象的信息。

如果您在加载配置时已经获取了对象定义的数量，我想这是可能的，但 Spring 会一次性读取配置。您需要使用不同的技术获取对象的总数。

hth，埃里希

# sql-server - 如何以编程方式获取 SQL 2005 中事务日志的大小？

> ID：198343
> 
> 赞同：22
> 
> 时间：2008-10-13T17:29:15.790
> 
> 标签：sql-server, tsql

我们在我们的数据库上使用固定的事务日志大小，我想组合一个应用程序来监控日志大小，这样我们就可以看到什么时候事情变得太紧张了，我们需要增加固定的 trn 日志。

是否有任何可以运行的 TSQL 命令告诉我事务日志的当前大小以及事务日志的固定限制？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2011-08-16T21:26:54.560

我使用了您的代码，但是转换为 int 时出错。“消息 8115，级别 16，状态 2，第 1 行算术溢出错误，将表达式转换为数据类型 int。” 因此，无论哪里有“*8”，我都将其更改为 *8.0，并且代码运行良好。

```
SELECT (size * 8.0)/1024.0 AS size_in_mb
     , CASE
  WHEN max_size                                 = -1 
  THEN 9999999                  -- Unlimited growth, so handle this how you want
  ELSE (max_size * 8.0)/1024.0                  END AS max_size_in_mb
  FROM YOURDBNAMEHERE.sys.database_files
 WHERE data_space_id                            = 0 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-10-13T17:35:40.503

一个快速的谷歌搜索揭示了这一点：

```
DBCC SQLPERF ( LOGSPACE ) 
```

为什么不在事务日志上使用自动增长？看起来这将是一个更可靠的解决方案。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-02-16T10:08:59.650

使用 sys.database_files 只会为您提供日志文件的大小，而不是其中的日志大小。如果您的文件是固定大小的，这没什么用处。DBCC SQLPERF ( LOGSPACE ) 有点老派，但如果您需要支持旧版本的 SQL Server，则效果很好。

相反，您可以像这样使用 dm_os_performance_counters 表：

```
SELECT
    RTRIM(instance_name) [database], 
    cntr_value log_size_kb
FROM 
    sys.dm_os_performance_counters 
WHERE 
    object_name = 'SQLServer:Databases'
    AND counter_name = 'Log File(s) Used Size (KB)'
    AND instance_name <> '_Total' 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-13T17:53:09.237

这不是我的想法，所以你可能想仔细检查数学......

```
SELECT
     (size * 8)/1024.0 AS size_in_mb,
     CASE
        WHEN max_size = -1 THEN 9999999   -- Unlimited growth, so handle this how you want
        ELSE (max_size * 8)/1024.0
     END AS max_size_in_mb
FROM
     MyDB.sys.database_files
WHERE
     data_space_id = 0   -- Log file 
```

您可以从该系统视图中获得更多信息，例如增长增量、日志是否设置为自动增长以及是否设置为按特定数量或百分比增长。

！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-02-16T20:12:47.083

对于 SQL 2008 及更高版本，`FILEPROPERTY`还公开了文件中使用的空间量，并且比所有其他答案要简单得多：

```
select [Name], physical_name [Path], CAST(size AS BIGINT)*8192 [TotalBytes], CAST(FILEPROPERTY(name,'SpaceUsed') AS BIGINT)*8192 [UsedBytes], (case when max_size<0 then -1 else CAST(max_size AS BIGINT)*8192 end) [MaxBytes]
from sys.database_files 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-08T11:36:00.193

如果您确实需要坚持使用固定大小的事务日志，我建议将其设置为合理的大小，允许一些余量，然后执行以下两项之一：

*   如果您不需要时间点恢复，请将数据库恢复模式设置为 SIMPLE。简而言之，它将允许事务日志“自我回收”空间。

或者

*   如果您必须将恢复模式保持为 FULL，请安排一个执行事务日志备份的作业。这将释放事务日志中的空间，并允许您在需要时进行时间点恢复。

此外，也许您会发现以下文章很有用：[如何阻止 SQL Server 数据库的事务日志意外增长](http://support.microsoft.com/kb/873235)。

# php - 使用 PHP 创建单文件上传表单的最佳方法是什么？

> ID：198346
> 
> 赞同：21
> 
> 时间：2008-10-13T17:30:32.807
> 
> 标签：php, upload, file-upload

我在网上找到了一些示例，但我想从每天使用 PHP 的人那里获得关于潜在安全性或性能注意事项及其解决方案的反馈。

请注意，我只对一次上传一个文件感兴趣。

理想情况下不需要浏览器插件（Flash/Java），尽管知道使用插件的好处会很有趣。

我想知道最好的 HTML 表单代码和 PHP 处理代码。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-10-13T18:07:13.140

# 文件上传教程

## HTML

```
<form enctype="multipart/form-data" action="action.php" method="POST">
  <input type="hidden" name="MAX_FILE_SIZE" value="1000000" />
  <input name="userfile" type="file" />
  <input type="submit" value="Go" />
</form> 
```

*   `action.php`是将处理上传的 PHP 文件的名称（如下所示）
*   `MAX_FILE_SIZE`必须出现在 type 的输入之前`file`。这个值很容易在客户端上被操纵，所以不应该依赖。它的主要好处是在用户上传文件之前向用户提供文件太大的早期警告。
*   您可以使用 type 更改输入的名称`file`，但请确保它不包含任何空格。您还必须更新 PHP 文件（如下）中的相应值。

## PHP

```
<?php
$uploaddir = "/www/uploads/";
$uploadfile = $uploaddir . basename($_FILES['userfile']['name']);

echo '<pre>';
if (move_uploaded_file($_FILES['userfile']['tmp_name'], $uploadfile)) {
    echo "Success.\n";
} else {
    echo "Failure.\n";
}

echo 'Here is some more debugging info:';
print_r($_FILES);
print "</pre>";
?> 
```

上传文件夹不应位于可通过 HTTP 访问的位置，否则可能会上传 PHP 脚本并在服务器上执行它。

打印 的值`$_FILES`可以提示正在发生的事情。例如：

```
    大批
    (
        [用户文件] => 数组
        (
            [名称] => 文件名.ext
            [类型] =>
            [tmp_name] =>
            [错误] => 2
            [大小] => 0
        )
    )

```

这个结构提供了一些关于文件名、MIME 类型、大小和错误代码的信息。

## 错误代码

> 0 表示没有错误，文件已经上传成功
> 1 表示文件超过了 php.ini 中定义的最大文件大小。如果您想更改最大文件大小，您需要打开您的 php.ini 文件，确定显示如下的行：upload_max_filesize = 2M 并将值从 2M (2MB) 更改为您需要的任何值
> 2 表示最大文件大小手动定义，已超出页面脚本
> 3 表示文件仅部分上传
> 4 表示文件尚未指定（空文件字段）
> 5 尚未定义
> 6 表示没有临时文件夹
> 7 表示该文件无法写入磁盘

## `php.ini`配置

使用较大的文件运行此设置时，您可能会收到错误。检查您的`php.ini`文件中的这些键：

`max_execution_time = 30`
`upload_max_filesize = 2M`

适当增加这些值可能会有所帮助。使用 Apache 时，对此文件的更改需要重新启动。

最大内存允许值（通过 设置`memory_limit`）在此处不起作用，因为文件在上传时被写入 tmp 目录。tmp 目录的位置可以选择通过`upload_tmp_dir`.

## 检查文件 mimetypes

您应该检查用户上传的文件类型 - 最佳做法是根据允许的文件类型列表进行验证。允许任何文件的潜在风险是**用户可能会将 PHP 代码上传到服务器然后运行它**。

您可以使用非常有用的[`fileinfo`](http://www.php.net/manual/en/ref.fileinfo.php)扩展（取代旧[`mime_content_type`](http://www.php.net/manual/en/function.mime-content-type.php)功能）来验证 mime 类型。

```
// FILEINFO_MIME set to return MIME types, will return string of info otherwise
$fileinfo = new finfo(FILEINFO_MIME);
$file = $fileinfo->file($_FILE['filename']);

$allowed_types = array('image/jpeg', 'image/png');
if(!in_array($file, $allowed_types))
{
    die('Files of type' . $file . ' are not allowed to be uploaded.');
}
// Continue 
```

## 更多信息

[您可以在PHP.net 手册](http://docs.php.net/manual/en/features.file-upload.php)中阅读有关处理文件上传的更多信息。

## 对于 PHP 5.3+

```
//For those who are using PHP 5.3, the code varies.
$fileinfo = new finfo(FILEINFO_MIME_TYPE);
$file = $fileinfo->file($_FILE['filename']['tmp_name']);
$allowed_types = array('image/jpeg', 'image/png');
if(!in_array($file, $allowed_types))
{
    die('Files of type' . $file . ' are not allowed to be uploaded.');
}
// Continue 
```

## 更多信息

[您可以在PHP.net 文档](http://php.net/manual/en/fileinfo.constants.php)中阅读有关 FILEINFO_MIME_TYPE 的更多信息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-13T17:41:34.860

阅读[这个介绍](http://docs.php.net/manual/en/features.file-upload.php)，它应该告诉你你需要知道的一切。用户评论也相当有用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-13T17:35:10.240

Flash 的主要好处是它允许您上传多个文件。Java 的主要好处是它允许从文件系统拖放。很抱歉没有回答中心问题，但我想我会把它扔进去，因为它相当简单。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-14T03:13:56.703

安全性对于文件上传来说是一件非常重要的事情，在上传文件夹中添加一个 .htaccess 可以阻止脚本从它运行，这可以方便地添加额外的安全层。

.htaccess

```
Options -Indexes
Options -ExecCGI
AddHandler cgi-script .php .php3 .php4 .phtml .pl .py .jsp .asp .htm .shtml .sh .cgi 
```

参考：[http ://www.mysql-apache-php.com/fileupload-security.htm](http://www.mysql-apache-php.com/fileupload-security.htm)

# bug-tracking - Assembla：你喜欢 Trac 门票还是 Assembla 门票，为什么？

> ID：198352
> 
> 赞同：5
> 
> 时间：2008-10-13T17:32:46.437
> 
> 标签：bug-tracking, trac, assembla

我是一名刚刚开始使用开源 Web 开发（Python/Django）的开发人员。我注册了一个免费的 Assembla.com 帐户，但我真的不知道是使用 Trac 票务还是 Assembla 综合票务。我为两者都设置了空间来试用它们，但似乎我需要使用它们一段时间才能看到任何一种方式的明显好处。

因为我刚刚开始，我只是在做一些小项目，例如 Django 教程等。

你有关于 Trac 与 Assembla 票务的建议吗？是的，我用谷歌搜索了这个，没有任何有用的结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T18:45:11.033

我没有资格讨论“最佳”，这就是对建议的要求归结为。

Trac 有一个广泛的（恕我直言，架构良好）插件基础设施；如果你是一个重度 Python 开发人员并且有兴趣定制你的票务系统（或者如果你不是，并且发现任何[现有的插件](http://trac-hacks.org/)都很有用），那么这可能是一个需要考虑的因素。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-15T08:05:31.513

我只使用了 Trac 票证，因为我还使用了 Trac wiki 和 Trac subversion 存储库。能够在工单、wiki 页面和源代码之间来回链接是有意义的。

然而，工单用户界面非常 Web 1.0 风格：大量的页面重新加载和导航。工单编辑页面也太长了。我当然更喜欢塔达主义风格的编辑。

也许谷歌电子表格是要走的路。编辑排序方便，可以在一起编辑票单的同时进行Skype会议。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-02-21T09:30:07.527

我发现 Assembla 的门票非常好。我没怎么尝试过 Trac 的，我被讨厌的界面吓到了。

据我了解，Assembla 也在推动用户使用他们的工具，而不是 Trac。我认为这是有道理的，因为它允许他们更充分地将其与其他工具集成。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-13T17:44:29.457

我使用 Assembla 票务，它工作得很好......从来不需要其他任何东西。
另外，现在我在 Google Code 上托管我的一些项目，它还有一个最小但非常有用的跟踪系统。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-11-16T23:28:46.900

Assembla Tickets，至少现在使用的版本，在您最初的问题之后 2 年，比 Trac 领先几英里。一些细节：scrum orderred backlog、更好的用户、通知、隐私管理等。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-13T18:02:54.613

这取决于。只是为了尝试这一点 - 任何托管解决方案都可以做到这一点。如果事实证明你是一个真正的极客 - 杂项。您想要运行自己的 VPS 的原因（例如来自我喜欢的 slicehost）。我使用 Trac 已经有一段时间了，如果您有一个项目并且只需要基本功能，它是一个不错的选择。最近改用redmine，功能更多，更适合多项目环境。

# apache-flex - 这在计算机科学中叫什么？

> ID：198357
> 
> 赞同：7
> 
> 时间：2008-10-13T17:34:03.113
> 
> 标签：apache-flex, computer-science, mate

许多编程语言和框架确实/允许/需要一些我似乎找不到名称的东西，即使计算机科学中可能有一个。他们基本上做的是按名称绑定到变量/对象/类/函数。

[弹性](http://www.adobe.com/products/flex/)示例（“selectAll()”）：

```
<mx:Button click="selectAll()" label="Select All"/> 
```

[配合](http://mate.asfusion.com/)示例（“价格”）：

```
<Injectors target="{QuotePanel}">
  <PropertyInjector targetKey="price" source="{QuoteManager}" sourceKey="currentPrice" />
</Injectors> 
```

Java 示例（“Foo”）：

```
Class.forName("Foo") 
```

还有很多其他的例子。你明白了。令我困扰的是，实际上没有办法在编译时验证这一点，而且 IDE 在代码完成、导航和重构方面也无能为力。但这不是重点。

我的问题是，这叫什么？***我不认为它是其中之一：[动态绑定](http://en.wikipedia.org/wiki/Dynamic_binding)，[名称绑定](http://en.wikipedia.org/wiki/Name_binding)，[反射](http://en.wikipedia.org/wiki/Reflection_(computer_science))***

**更新**：不，这不是一个测验，如果听起来像一个，对不起。对于编程来说，这只是“命名那首歌”的问题。

**更新**：有帮助的答案：

*   来自 Tim Lesher：它被称为“后期绑定”、“动态绑定”或“运行时绑定”。*它通过字符串绑定的事实只是一个实现细节*......
*   来自 Konrad Rudolph：……*这只是解释器的输入*。

**更新**：正如人们正确指出的那样，一些示例是后期绑定，一些是反射，一些是运行时评估（解释）等。但是，我得出结论可能没有名称可以描述它们。这只是一堆确实有共同点的例子，但不足以给它命名。我喜欢“一切都是字符串”的答案，但即使它很有趣，它也不能完全做到公正。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-13T17:56:10.197

它被称为“后期绑定”、“动态绑定”或“运行时绑定”。它通过字符串绑定的事实只是一个实现细节，尽管它确实暗示字符串到符号的映射存在于运行时（某些语言，如 c++，不提供）。

另一方面，“自省”或“反射”指的是找出对象在运行时实现的接口、方法或属性的能力。

确实，动态绑定的符号在执行前无法验证；这就是使它们与静态绑定符号不同的原因。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-13T17:37:45.447

后期装订

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-13T17:36:19.817

是什么让你认为这`Class.forName`不是反思？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-13T17:37:46.850

反射

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-13T17:48:46.453

flex 的东西可以称为后期绑定，如果它像普通的 html 一样工作。在用户单击按钮之前，运行时不会费心查找函数是否存在。第二件事是依赖注入，它涉及函数指针（通过接口）和反射。java肯定是反射。

我想可能是你不能正确地表达你的问题，或者选择了不好的例子来说明你的想法。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-13T17:37:07.193

后期绑定？

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-19T13:41:50.300

第二个和第三个例子是反射或后期绑定的例子，但第一个例子不是。

```
<mx:Button click="selectAll()" label="Select All"/> 
```

在编译之前被重写为 ActionScript，该`selectAll()`部分被隐藏在事件处理函数中。像这样的东西（可以通过添加`-keep-generated-actionscript`到编译器标志来检查它是如何完成的）：

```
_button1 = new Button();
_button1.label = "Select All";
_button1.addEventListener("click", function( event : Event ) : void {
    selectAll();
}); 
```

编译器确定属性是事件、样式还是属性，但由于这是在编译时完成的，因此它不是反射。根据定义，反射是在运行时完成的。

我认为可以说第二个和第三个示例是反射，但也可以说它们是后期绑定的示例。它们中没有一个实际上决定了它们所处理的对象的能力，因此它们不是反射。但是，我会说“反射”一词通常在广义上用于表示调用名称在运行时确定的方法或从仅在运行时命名的类创建对象的任何事物。如果要精确，“后期绑定”可能是最正确的答案，但我认为“反思”已经足够了。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-13T17:44:10.003

“内省”？

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-13T17:55:50.883

顺便说一句，我推测您向我们展示的 Flex 代码仅使用 ActionScript 调用，在这种情况下，该`click`属性将由`eval`Flex 文档的解释器简单地 'd'。因此，这种代码背后没有什么特别的魔力，它只是解释器的输入。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-13T17:57:19.073

我认为 Flex 示例与 Java 中的示例不太一样（不知道其他内容）。Java 示例显然是我称之为**后期绑定**的东西，因为类加载器在运行时解析类名，这是执行此操作的最晚可能时间。

Flex MXML 主要是另一种语法，它最终会被编译成您也可以用 ActionScript 编写的东西。据我所知， mx:Button 和 selectAll() 函数是*在编译时解析的*。如果您在那里使用未定义的符号，至少 mxmlc 会出错。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-13T18:23:57.770

在某些情况下，编译器可以提供帮助……代码生成。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-13T18:50:31.913

如果直到运行时才知道变量的类型，那么它就是后期绑定。如果变量类型在编译时已知，那么它就是早期绑定。

Intellisense、代码完成和您谈论的所有其他 IDE 功能仅适用于早期绑定变量。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-13T20:33:33.780

我称之为“一切都是字符串”、“作为通用数据类型的字符串”或“字符串滥用”。

支持：

[http://research.microsoft.com/~emeijer/papers/xml2003/xml2003.html](http://research.microsoft.com/~emeijer/papers/xml2003/xml2003.html)

[http://blog.moertel.com/articles/2006/10/18/a-type-based-solution-to-the-strings-problem](http://blog.moertel.com/articles/2006/10/18/a-type-based-solution-to-the-strings-problem)

[http://pveentjer.wordpress.com/2006/10/11/string-is-not-a-good-universal-datatype/](http://pveentjer.wordpress.com/2006/10/11/string-is-not-a-good-universal-datatype/)

[http://computer-programming-languages.suite101.com/article.cfm/abused_strings_considered_harmful](http://computer-programming-languages.suite101.com/article.cfm/abused_strings_considered_harmful)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-13T17:39:37.500

在 .NET 世界中，我们称之为数据绑定，它使用反射进行处理。

它也让我强烈地想起了依赖注入。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-13T17:40:29.653

闻起来像一个指向我的函数指针。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-13T17:42:25.653

您提供的 Java 示例称为动态类加载。我不确定其他示例是否相同。但这在反思中很有用。也许您正在寻找称为控制反转的设计模式。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-10-13T17:57:18.883

第一个示例是一个命名空间 xml 如何在编译时假设含义的示例，第二个是数据绑定/依赖注入第三个示例是反射，如果我必须用一个名称标记所有这 3 个示例，我想我会去对于“语法”

# sharepoint - 为什么我的项目中复制了 Microsoft.SharePoint.Search.dll？

> ID：198359
> 
> 赞同：4
> 
> 时间：2008-10-13T17:34:27.603
> 
> 标签：sharepoint, visual-studio-2005

在处理涉及引用 Microsoft.SharePoint.dll 的 VS2005 项目时，构建项目会导致 Microsoft.SharePoint.Search.dll 被复制到我的 bin 文件夹中。为什么是这样？好吧，也许这只是一个错误，但我想知道机制。

[编辑：本地复制绝对是关闭的——Microsoft.SharePoint.dll 没有被复制。Microsoft.SharePoint.Search.dll 不在 GAC 中，但如果它不在也没关系。]

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-13T17:54:22.370

*   它不在 GAC 中
*   您引用的其中一个程序集正在使用它（我认为 Microsoft.Sharepoint.dll 引用了它）
*   由于您没有引用它，因此据我所知，您无法将 Local Copy 设置为 FALSE
*   我已将构建/部署脚本更改为删除它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-13T20:45:34.680

对我有用的是

*   添加对 Microsoft.SharePoint 和 Microsoft.SharePoint.Search 的引用（即使您不需要它）
*   将两个引用的 Copy Local 设置为 false。

当您构建项目时，它们都不会被复制到 debug/release/whatever 目录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T17:39:57.703

您是否尝试关闭属性中的“复制本地”以引用 Microsoft.SharePoint.dll ？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T17:50:49.070

可能是因为它不在 GAC 中，因为 GAC 中的其他文件没有复制到那里。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-13T17:51:48.007

它可能是一个依赖项，并且您已启用本地复制。

不过，我会保持启用本地复制，因为它确实减轻了部署的痛苦。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-08T15:45:41.697

如果您在其中编译 x64 体系结构的程序集的机器（主机）并且在“添加引用”期间安装了 x64 版本的 SharePoint（将引用设置为这些程序集），则它将本地复制设置为 false。

因此，如果程序集是 AMD64 并且您设置了“任何 CPU”，那么“添加引用”集就是副本 local = true，无论如何。如果将其更改为 false，但随后从另一个目标设置为 Any CPU 或 NOT x64 的项目引用此项目，则引用 get 也会被复制。

在此链接中根据需要查看自定义 MSBuild：[How do I override CopyLocal (Private) setting for references in .NET from MSBUILD](https://stackoverflow.com/questions/1682096/how-do-i-override-copylocal-private-setting-for-references-in-net-from-msbuild)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-05-29T08:11:00.800

好的，我只是想用这个解释来补充答案：

1）在我的项目中，我参考了：Microsoft.SharePoint Microsoft.SharePoint.Publishing

2）当我编译我的项目时，在 x64 虚拟 moss 2007 服务器上，我将以下文件添加到我的 bin/debug 中：ssocli.dll、Microsoft.SharePoint.Portal.SingleSignon.dll、Microsoft.SharePoint.Search.dll、Microsoft .SharePoint.Search.xml、Microsoft.Office.Server.Search.dll。

有趣的是，我的 x86 虚拟服务器上没有这个问题。

3) 所有这些文件都可以在 c:\program files\Common Files\Microsoft Shared\Web Server Extensions\bin\ISAPI 中找到。

4）根据我在 MSDN 论坛上找到的答案，引用的 dll 可能引用或依赖于其他 dll。因此，它们被添加到 bin/debug 文件夹中。

5）为防止这种情况发生，您可以在项目中引用依赖的dll并将本地复制设置为false。

[https://social.msdn.microsoft.com/Forums/sharepoint/en-US/192fa94c-b588-401d-8ca8-845c3fe15f60/could-not-load-file-or-assembly-microsoftsharepointsearch-version12000-cultureneutral?forum=共享点开发遗产](https://social.msdn.microsoft.com/Forums/sharepoint/en-US/192fa94c-b588-401d-8ca8-845c3fe15f60/could-not-load-file-or-assembly-microsoftsharepointsearch-version12000-cultureneutral?forum=sharepointdevelopmentlegacy)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-02-24T14:09:26.037

我们的一位客户遇到了这个问题，这似乎是由于 Visual Studio 2019 安装向导的单个组件部分中提供的适用于 Visual Studio 的 Office 开发人员工具选项，例如

[![在此处输入图像描述](https://i.stack.imgur.com/OOXjQ.png)](https://i.stack.imgur.com/OOXjQ.png)

解决方案是取消选中它并卸载插件。因此，在编译项目时，不应将 SharePoint 相关程序集添加到项目中。

我希望这些信息可能对某人有所帮助。

# c# - 在 Winforms 中托管的 Silverlight

> ID：198360
> 
> 赞同：11
> 
> 时间：2008-10-13T17:34:32.177
> 
> 标签：c#, javascript, wpf, winforms, silverlight

我想通过一个winforms浏览器在winforms中托管一个silverlight控件，但是为了让它工作，我需要某种方式让表单与silverlight对话，反之亦然。是否有可能以某种方式让两者使用 JavaScript 作为中间人进行交互？即，让表单与浏览器的javascript 对话，并与silverlight 控件对话吗？有没有更好的办法？或者根本就没有办法？（除了将代码编译为 silverlight 和 wpf）

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-16T15:02:53.837

我认为使用 Windows 窗体 WebBrowser 控件是您最好的选择。为此，您需要将 Silverlight 应用程序放在网页上，然后将 WebBrowser 指向页面的 URI。

为了防止您的 WebBrowser 控件表现得像 IE，我建议设置以下内容：

```
webBrowser.AllowNavigation = false;
webBrowser.AllowWebBrowserDrop = false;
webBrowser.IsWebBrowserContextMenuEnabled = false;
webBrowser.WebBrowserShortcutsEnabled = false; 
```

从 Silverlight 中调用表单上的方法很容易做到。首先，您需要一个包含您想从 Silverlight 调用的所有方法的类。您可以使用表单本身或其他对象，但您需要使用 [ComVisible(true)] 属性标记类。然后将对象分配给 WebBrowser.ObjectForScripting 属性。这会将您的对象公开为网页上的“window.external”。

```
[ComVisible(true)]
public partial class Form1 : Form
{
    ......
    webBrowser.ObjectForScripting = this;
    ......
    public void CallMeInForm(string something)
    {
        MessageBox.Show("Silverlight said: " + something);
    }
} 
```

这就是您的 Windows 窗体项目中的内容。在您的 Silverlight 应用程序中，您需要获取此 ObjectForScripting 并在其上调用方法。要调用上面示例中的方法，请使用以下行：

```
using System.Windows.Browser;
......
ScriptObject myForm = (ScriptObject)HtmlPage.Window.GetProperty("external");
myForm.Invoke("CallMeInForm", "testing 1 2 3"); 
```

Invoke 命令允许您将任意数量和类型的参数传递给您的函数，尽管我怀疑如果您尝试传递复杂的数据类型，它不会非常喜欢它。但是如果你需要这样做，你总是可以使用序列化。

从您的表单中调用 Silverlight 函数似乎是一个诡计多端的方向。我还没有完全弄清楚这一点。

在您的 Silverlight 应用程序中，您还可以向网页公开函数。为此，请使用 HtmlPage.RegisterScriptableObject() 函数。同样，您可以使用要公开的方法传入任何类。但是，对于要公开的方法，您必须使用 [ScriptableMember] 属性对其进行标记。

```
HtmlPage.RegisterScriptableObject("Page", this);
......
[ScriptableMember]
public void CallMeInSilverlight(string message)
{
    HtmlPage.Window.Alert("The form said: " + message);
} 
```

此时，您的方法在页面上暴露给 JavaScript，您可以像这样调用它，假设您已添加`id="silverlightControl"`到`<object>`元素中：

```
document.getElementById('silverlightControl').Content.Page.CallMeInSilverlight("testing 1 2 3"); 
```

注意`Page`属性？这就是`RegisterScriptableObject()`给我们的电话。现在，让我们将其包装成一个整洁的 JavaScript 方法：

```
<script type="text/javascript">
    function CallMe(message) {
        var control = document.getElementById('silverlightControl');
        control.Content.Page.CallMeInSilverlight(message);
    }
</script> 
```

现在我们可以`CallMe()`从 Windows 窗体应用程序中调用该方法，如下所示：

```
public void CallToSilverlight()
{
    webBrowser.InvokeScript("CallMe", new object[] { "testing 1 2 3" });
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-14T06:29:37.790

看看[Desklighter](http://www.blendables.com/labs/Desklighter/Default.aspx)。不完全是您正在寻找的东西，但它确实证明它应该是可能的？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-09T18:16:11.700

如果您*真正*需要做的只是在桌面应用程序中托管 Silverlight，我建议您查看[Jeremiah Morrill](http://jmorrill.hjtcentral.com/)的[SilverlightViewport](http://silverlightviewport.codeplex.com/)项目。它允许您在 WPF 或 XNA 应用程序中嵌入 Silverlight 应用程序。它仍然非常有用，但您可能会发现它很有用。

来一张图让你胃口大开：

[http://i3.codeplex.com/Project/Download/FileDownload.aspx?ProjectName=silverlightviewport&DownloadId=97946](http://i3.codeplex.com/Project/Download/FileDownload.aspx?ProjectName=silverlightviewport&DownloadId=97946)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T17:40:25.457

Winform 应用程序中的 Silverlight 听起来像是个坏消息。这意味着您在单个应用程序中运行到不同的 CLR，并且必须处理大量增加的复杂性才能使其工作。如果可能，请考虑在您的应用程序中使用完整的 WPF，而不是这里有一个[链接](http://blog.paranoidferret.com/index.php/2008/06/24/wpf-tutorial-using-wpf-in-winforms/)向您展示如何操作。

# configuration - 如何在运行时获取 Grails Config.groovy 中的好东西？

> ID：198365
> 
> 赞同：36
> 
> 时间：2008-10-13T17:36:31.983
> 
> 标签：configuration, grails, runtime

在 Config.groovy 我看到这个：

```
// set per-environment serverURL stem for creating absolute links
environments {
    production {
        grails.serverURL = "http://www.changeme.com"
    }
} 
```

在运行时访问它的正确方法是什么？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-05-15T09:30:17.653

在更新的 grails 版本中，ConfigurationHolder 已被弃用。

相反，您应该使用 grailsApplication 对象。

```
grailsApplication.config.grails.serverURL 
```

如果在 Controller 或 Service 中，则使用 grailsApplication 对象的依赖注入。例如

```
class MyController{
    def grailsApplication
    def myAction() {
        grailsApplication.config.grails.serverURL
    } 
```

请参阅[如何在 Grails 2.0 中访问 Grails 配置？](https://stackoverflow.com/questions/7133580/how-to-access-grails-configuration-in-grails-2-0)

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2008-10-13T18:31:18.643

danb 在正确的轨道上。但是，如果您进行更好的导入，您的生活会变得轻松一些：

```
import org.codehaus.groovy.grails.commons.ConfigurationHolder as CH
println CH.config.grails.serverURL 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-10-13T18:09:26.693

这里是：

```
import org.codehaus.groovy.grails.commons.ConfigurationHolder
println ConfigurationHolder.config.grails.serverURL 
```

或者，在控制器和标签中，显然这将起作用：

```
grailsApplication.config.grails.serverURL 
```

我在 BootStrap 中需要它，所以我需要选项 1。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2014-07-16T19:59:15.507

正如一些评论中提到的，另一个选项是[`grails.utils.Holders`](http://grails.org/doc/latest/api/grails/util/Holders.html)在 Grails 2.0 中添加的类。我更喜欢这种方法，因为您可以在未配置依赖注入的类中使用它。

```
import grails.util.Holders

class Foo {
    def bar() {
        println(Holders.config.grails.serverURL)
    }
} 
```

# c++ - Visual C++ 中缺少/想要的功能

> ID：198402
> 
> 赞同：0
> 
> 时间：2008-10-13T17:46:58.033
> 
> 标签：c++, visual-c++, ide

我找不到另一个已经被问到的主题，所以我开始了一个……如果有，请随意链接并关闭它。

您觉得 Visual C++ 最缺少什么功能？

微软一直在为最后几个版本的 C#/VB.NET 开发添加不错的功能，但 C++ 感觉有点被忽视了。我对其他 IDE 没有太多经验，但在过去五年中，C++ IDE 开发一定有一些人们喜欢的进步。我很好奇人们认为 Visual C++ 缺少的最明显的功能是什么。

笔记：

*   不，我不为 MS 工作，我只是经常使用他们的东西，并希望看到它变得更好
*   这是针对原生 C++ 开发的，尽管我认为 C++/CLI 也应该是公平的游戏
*   随意添加多个功能作为单独的条目；这样人们就可以投票选出他们认为最缺乏的东西

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-13T17:48:44.567

重构。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-13T19:05:52.973

我似乎是地球上为数不多的使用它的人之一，但如果微软能够在他们的编译器和 IDE 中正确地实现关键字，我真的很高兴——`and`事实上，所有的 ISO 646，但这三个是只有那些真正有用的。`or``not`

他们有很多不实施它们的“好”借口——不是一个破坏性的错误，没有多少人使用它们，yadda yadda yadda——但这是一件*小事*，而且他们似乎很粗心不去实施它只是出于恶意.

......对于那些不知道我在说什么的人：

```
// This is valid C++
bool x = not (a and b) or c;

// … and is equivalent to this:
bool x = ! (a && b) || c; 
```

`ciso646`对于不立即支持上述代码但符合标准的编译器*必须*支持此代码的编译器，这些关键字也被定义为标准头文件中的宏。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-13T18:26:16.487

这与 IDE 无关，但与语言有关。我希望 MS 至少支持一些 C99 更改。具体来说：

*   `stdint.h`和`inttypes.h`。我有自己的版本，所以这对我来说没什么大不了的，但 MS 真的应该在很久以前就把这些放进去。它们完全不需要对编译器进行任何更改。
*   混合声明/代码和`inline`C。他们已经必须为 C++ 做这个，为什么不让我用 C 做呢？
*   `_Pragma()`. 他们已经做了一些非常相似的事情（`_pragma()` 我认为），但它已经足够不同了，它需要`#ifdef`s 才能工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-13T18:39:34.137

如果单行上存在多个表达式（由序列点分隔），则允许一次单步执行单个语句。示例：在 for 循环中，将初始化和比较作为两个单独的语句（在第一次传递）和比较和增量作为两个单独的语句（在后续传递）进行。

单步执行宏。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-13T21:20:14.827

既然我们在做梦……而且您提到了[模板元编程](http://en.wikipedia.org/wiki/Template_metaprogramming)（TMP），那么如果有一个 TMP 调试器，那就太棒了；）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-14T08:48:26.230

自动生成代码、getter/setter 等，就像 IntelliJ IDEA for Java 一样。

编辑：还添加了 Visual Assist X 当前提供的几乎所有内容。这对于在 Visual C++ 中工作是绝对必要的。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-14T04:25:32.347

如果我在头文件中声明一组函数，只需单击一下，所有函数都应该自动展开到它的 .cpp 文件中。或相反亦然。我不确定是否已经有一个宏。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-19T20:02:21.707

如果 Intellisense 最终得到修复，那就太好了。当我右键单击代码窗口中的任何位置时，我的 VS 2008 冻结了 10 分钟以上。C#/VB.NET 得到了所有 Intellisense 的喜爱——C++ 并非如此......

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-18T11:53:05.037

Visual C++ 编译器缺少对 register 关键字的支持。它只是忽略它。

在应用程序的热点中，重要的是能够指导编译器做正确的事情。

或者正如詹姆斯普拉特所说：

> “REGISTER 关键字被忽略。这对于生成快速代码至关重要，因为编译器并不总是选择正确的变量来保存在寄存器中。”

register 关键字是一个强大的工具，可能会被滥用并且会损害可移植性，但我认为应该支持它。

出于某种原因，Microsoft 不允许我们进行这种级别的控制。主要论点是编译器比软件工程师更聪明。这并非在所有情况下都是正确的。如果 Metroworks 为其 PowerPC/Macintosh 的 C++ 编译器使用相同的参数，我将无法仅通过分配将面向用户的应用程序加速 2 倍（主要操作从 4 秒到 2 秒）寄存器的重要变量，消除了主内存访问。这仅用了一个小时就完成了，通过反汇编生成的代码和消除内存访问来指导。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-13T18:54:37.630

除了单步执行宏之外，我想知道是否有人认为最终编译器将需要支持单步执行模板扩展功能？随着元编程变得更加标准，模板变得更加复杂和编译时评估，这可能会成为一个问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-22T18:14:36.723

想到了我个人想要的另一件事：

通过名称中断函数的能力，无论它是从哪里调用的，或者它是在哪里定义的。

中断代码中的函数很容易，但我经常发现自己想中断我没有源代码的函数（例如：OS API 函数），并且跟踪代码中的每个实例是不可行的和调用函数的库代码。VS 具有中断函数的能力，但它似乎不适用于不在您的代码中的函数。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-13T17:50:49.210

我认为 VC++ 迫切需要的一件事：

*   步进式能力

通过未记录的 NativeDE 子键（谷歌子键名称以了解它）提供了一个跨步功能，这对于琐碎的构造函数/等非常有用。然而，随着 boost、TR1、COM 抽象和其他多步传递代码变得越来越普遍，VC++ 确实可以使用在调试器中自动单步执行函数的能力。请注意，这对于 C# 已经作为属性存在，但对于本机 C++ 恕我直言，它是必需的，并且作为文档化的受支持功能。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-14T04:16:13.410

我个人想要的另一件事是类图显示，就像 .NET 语言一样。我认为它肯定有助于可视化您尝试可视化的新代码项目。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-31T20:52:33.270

能够设置编译线程的优先级。

# optimization - 你如何测试 VBA 代码的运行时间？

> ID：198409
> 
> 赞同：97
> 
> 时间：2008-10-13T17:49:02.240
> 
> 标签：optimization, testing, vba, profiling, performance

VBA中是否有代码可以包装一个函数，让我知道运行时间，以便我可以比较函数的不同运行时间？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2008-10-13T19:16:17.587

除非您的功能非常慢，否则您将需要一个非常高分辨率的计时器。我知道的最准确的一个是`QueryPerformanceCounter`。谷歌它以获取更多信息。尝试将以下内容推送到一个类中，称之为`CTimer`说，然后你可以在全局某个地方创建一个实例，然后`.StartCounter`调用`.TimeElapsed`

```
Option Explicit

Private Type LARGE_INTEGER
    lowpart As Long
    highpart As Long
End Type

Private Declare Function QueryPerformanceCounter Lib "kernel32" (lpPerformanceCount As LARGE_INTEGER) As Long
Private Declare Function QueryPerformanceFrequency Lib "kernel32" (lpFrequency As LARGE_INTEGER) As Long

Private m_CounterStart As LARGE_INTEGER
Private m_CounterEnd As LARGE_INTEGER
Private m_crFrequency As Double

Private Const TWO_32 = 4294967296# ' = 256# * 256# * 256# * 256#

Private Function LI2Double(LI As LARGE_INTEGER) As Double
Dim Low As Double
    Low = LI.lowpart
    If Low < 0 Then
        Low = Low + TWO_32
    End If
    LI2Double = LI.highpart * TWO_32 + Low
End Function

Private Sub Class_Initialize()
Dim PerfFrequency As LARGE_INTEGER
    QueryPerformanceFrequency PerfFrequency
    m_crFrequency = LI2Double(PerfFrequency)
End Sub

Public Sub StartCounter()
    QueryPerformanceCounter m_CounterStart
End Sub

Property Get TimeElapsed() As Double
Dim crStart As Double
Dim crStop As Double
    QueryPerformanceCounter m_CounterEnd
    crStart = LI2Double(m_CounterStart)
    crStop = LI2Double(m_CounterEnd)
    TimeElapsed = 1000# * (crStop - crStart) / m_crFrequency
End Property 
```

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2008-10-13T23:51:56.890

VBA 中的 Timer 函数为您提供自午夜以来经过的秒数，精确到 1/100 秒。

```
Dim t as single
t = Timer
'code
MsgBox Timer - t 
```

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2011-07-25T17:32:28.140

如果您尝试像秒表一样返回时间，您可以使用以下 API 来返回系统启动后的时间（以毫秒为单位）：

```
Public Declare Function GetTickCount Lib "kernel32.dll" () As Long
Sub testTimer()
Dim t As Long
t = GetTickCount

For i = 1 To 1000000
a = a + 1
Next

MsgBox GetTickCount - t, , "Milliseconds"
End Sub 
```

在[http://www.pcreview.co.uk/forums/grab-time-milliseconds-included-vba-t994765.html](http://www.pcreview.co.uk/forums/grab-time-milliseconds-included-vba-t994765.html)之后（因为 winmm.dll 中的 timeGetTime 对我不起作用并且 QueryPerformanceCounter 对于所需的任务来说太复杂了）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-03-21T15:41:27.957

对于新手，这些链接解释了如何对您想要时间监控的所有潜艇进行自动分析：

[http://www.nullskull.com/a/1602/profiling-and-optimizing-vba.aspx](http://www.nullskull.com/a/1602/profiling-and-optimizing-vba.aspx)

[http://sites.mcpher.com/share/Home/excelquirks/optimizationlink](http://sites.mcpher.com/share/Home/excelquirks/optimizationlink) 参见[http://sites.mcpher.com/share/Home/excelquirks/downlable-items中的 procProfiler.zip](http://sites.mcpher.com/share/Home/excelquirks/downlable-items)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-09-19T08:31:09.713

```
Sub Macro1()
    Dim StartTime As Double
    StartTime = Timer

        ''''''''''''''''''''
            'Your Code'
        ''''''''''''''''''''
    MsgBox "RunTime : " & Format((Timer - StartTime) / 86400, "hh:mm:ss")
End Sub 
```

输出：

> 运行时间：00:00:02

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-13T19:20:30.043

多年来，我们一直使用基于 winmm.dll 中 timeGetTime 的解决方案来实现毫秒精度。见[http://www.aboutvb.de/kom/artikel/komstopwatch.htm](http://www.aboutvb.de/kom/artikel/komstopwatch.htm)

这篇文章是德文的，但是下载中的代码（一个包装 dll 函数调用的 VBA 类）很简单，可以使用和理解，无需阅读文章。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-07-16T09:26:56.830

正如 Mike Woodhouse 回答的那样，QueryPerformanceCounter 函数是对 VBA 代码进行基准测试的最准确的方法（当您不想使用定制的 dll 时）。我写了一个类（链接[https://github.com/jonadv/VBA-Benchmark](https://github.com/jonadv/VBA-Benchmark)），使该功能易于使用：

1.  只初始化基准类
2.  在您的代码之间调用该方法。

例如，无需为减去时间、重新初始化时间和编写调试代码编写代码。

```
Sub TimerBenchmark()

Dim bm As New cBenchmark

'Some code here
bm.TrackByName "Some code"

End Sub 
```

这会自动打印一个可读的表格到立即窗口：

```
IDnr  Name       Count  Sum of tics  Percentage  Time sum
0     Some code      1          163     100,00%     16 us
      TOTAL          1          163     100,00%     16 us

Total time recorded:             16 us 
```

当然，只有一段代码的表格不是很有用，但是有多段代码，你的代码中的瓶颈在哪里会立即变得清晰。该类包括一个 .Wait 函数，它的作用与 Application.Wait 相同，但只需要以秒为单位的输入，而不是时间值（编码需要大量字符）。

```
Sub TimerBenchmark()

Dim bm As New cBenchmark

bm.Wait 0.0001 'Simulation of some code
bm.TrackByName "Some code"

bm.Wait 0.04 'Simulation of some (time consuming) code here
bm.TrackByName "Bottleneck code"

bm.Wait 0.00004 'Simulation of some code, with the same tag as above
bm.TrackByName "Some code"

End Sub 
```

打印带有百分比的表格并汇总具有相同名称/标签的代码：

```
IDnr  Name             Count  Sum of tics  Percentage  Time sum
0     Some code            2       21.374       5,07%   2,14 ms
1     Bottleneck code      1      400.395      94,93%     40 ms
      TOTAL                3      421.769     100,00%     42 ms

Total time recorded:             42 ms 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2020-04-14T23:41:46.787

带 2 个小数位的秒数：

```
Dim startTime As Single 'start timer
MsgBox ("run time: " & Format((Timer - startTime) / 1000000, "#,##0.00") & " seconds") 'end timer 
```

[![秒格式](https://i.stack.imgur.com/YgQWt.jpg)](https://i.stack.imgur.com/YgQWt.jpg)

毫秒：

```
Dim startTime As Single 'start timer
MsgBox ("run time: " & Format((Timer - startTime), "#,##0.00") & " milliseconds") 'end timer 
```

[![毫秒格式](https://i.stack.imgur.com/xy9JG.jpg)](https://i.stack.imgur.com/xy9JG.jpg)

带逗号分隔符的毫秒数：

```
Dim startTime As Single 'start timer
MsgBox ("run time: " & Format((Timer - startTime) * 1000, "#,##0.00") & " milliseconds") 'end timer 
```

[![带逗号分隔符的毫秒](https://i.stack.imgur.com/LM9CF.jpg)](https://i.stack.imgur.com/LM9CF.jpg)

只是把这个留给那些像我一样正在寻找一个用秒到 2 个小数空格格式化的简单计时器的人。这些是我喜欢使用的又短又甜的小计时器。它们只在子函数或函数的开头占用一行代码，最后又占用一行代码。这些并不意味着疯狂准确，我个人通常不关心小于 1/100 秒的任何事情，但是毫秒计时器将为您提供这 3 个中最准确的运行时间。我也读过你如果它碰巧在穿过午夜时运行，可能会得到不正确的读数，这是一个罕见的例子，但仅供参考。

# c# - 在 WinForms 中显示和编辑大量十六进制数据的最佳方法是什么？

> ID：198414
> 
> 赞同：1
> 
> 时间：2008-10-13T17:50:29.727
> 
> 标签：c#, winforms, controls, ui-design

我希望在 16 X n 网格状显示器中显示 128 到 512 字节的十六进制数据（0x00 到 0xFF）大小的数组。它需要选择单个元素或一组元素并以某种方式突出显示数据的能力。它还需要允许编辑。我正在使用 Winforms 在 C# 3,5 中编写此代码。

我正在考虑某种富文本框或只是一组小文本框，但是这两个想法都不是没有缺点的。是否有一个免费的类似电子表格的自定义控件有意义，或者我将不得不自己推出。任何想法，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T17:52:10.377

看看DataGridView。

您需要将其分解为组成单元格，但它绝对非常适合将数据网格（如 Excel）放在一起。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T17:54:04.837

更好的方法是创建一个像小标签这样的自定义控件，所有的花里胡哨都显示突出显示的一个，编辑并将所有这些放在像面板这样的自定义容器中。您可以为自定义标签指定行和列，以便于布局。

# c# - 如何折叠空的 xml 标签？

> ID：198419
> 
> 赞同：2
> 
> 时间：2008-10-13T17:51:33.920
> 
> 标签：c#, xml

我得到这样的XML：

`<Items> <Row attr1="val"></Row> <Row attr1="val2"></Row> </Items>`

如您所知，这是有效的 XML，但我正在使用的另一个库已损坏，它只接受这种格式的 XML：

`<Items> <Row attr1="val"/> <Row attr1="val2"/> </Items>`

我已经将 XML 读入 XmlDocuments，操作它们，并使用 XmlWriter() 重写它们，对我来说“折叠”这些空标签的最简单（也是最有效）的方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-13T18:40:00.250

将要折叠的每个 XmlElement的[IsEmpty属性设置为 true。](http://msdn.microsoft.com/en-us/library/system.xml.xmlelement.isempty.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-13T18:41:01.887

如果您使用 System.XML 的 DOM 操作对象（XmlElement 等）而不是 XmlWriter，您可以免费获得它。

```
XmlElement items = xmlDoc.SelectNodes("items");
XmlElement row = xmlDoc.CreateElement("row");
items[0].appendChild(row); 
```

你会得到一个“<row/>”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T19:37:09.870

你可以试试这个。

使用其 WriteFullEndElement 调用 base.WriteEndElement 的实现的子类 XmlTextWriter。像这样：

```
 public class BetterXmlTextWriter : XmlTextWriter
    {
        public BetterXmlTextWriter(TextWriter w)
            : base(w)
        {
        }

        public override void WriteFullEndElement()
        {
            base.WriteEndElement();
        }
    } 
```

然后使用 XmlDocument.WriteContentTo 将文档写出到您的子类的实例中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T20:25:00.070

如果您已经在使用 XmlWriter 来编写 XML，那么它应该已经在折叠空元素。此代码（使用 .Net 3.5）：

```
XmlWriter xw = XmlWriter.Create(Console.Out);
xw.WriteStartElement("foo");
xw.WriteAttributeString("bar", null, "baz");
xw.WriteEndElement();
xw.Flush();
xw.Close(); 
```

发出`<foo bar='baz' />`.

如果您的 XmlWriter 不是，您应该检查以确保您的 XmlWriter 代码没有发出您不期望的文本节点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-08-03T15:45:40.520

这是一个递归方法：

```
private static void FormatEmptyNodes(XmlNode rootNode)
{
    foreach (XmlNode childNode in rootNode.ChildNodes)
    {
        FormatEmptyNodes(childNode);

        if(childNode is XmlElement)
        {
            XmlElement element = (XmlElement) childNode;
            if (string.IsNullOrEmpty(element.InnerText)) element.IsEmpty = true;
        }
    }
} 
```

像这样使用：

```
var doc = new XmlDocument();
doc.Load(inputFilePath);
FormatEmptyNodes(doc);
doc.Save(outputFilePath); 
```

# graphics - 您是否通过 HTML 画布成功处理了 2D 图形？

> ID：198421
> 
> 赞同：1
> 
> 时间：2008-10-13T17:52:02.780
> 
> 标签：graphics, canvas

我正在寻找通过 HTML 画布元素呈现丰富的 2D 图形的 Web 应用程序的成功和失败案例。我在网上看到了一些有趣的示例，但想了解一些使用这种方法完成的实际开发示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-20T08:21:08.420

也许不完全是您正在寻找的东西，但[GWT-canvas](http://code.google.com/p/gwt-canvas/)值得检查。至少它是一个 HTML Canvas 项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T03:53:59.723

我有一个使用画布标签的评分应用程序。教师可以设置新的成绩曲线，我会根据变化显示每个成绩有多少学生的直方图。

这样教练就可以很容易地看到曲线是否符合他们的期望，这样他们就可以得到他们想要的形状。

我还使用画布标签作为设计图像的一种方式，这些图像以后可能会变成真正的位图图像，因此我可以根据用户的反馈轻松地试验并决定哪种图像效果最好。对我来说，使用画布标签进行更改比让位图图像具有正确的大小和外观要快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T22:58:36.733

对我来说，最重要的是文字。我需要渲染矢量图形**和**文本。

因此我更喜欢 SVG。

也就是说，对于简单的图形，甚至是复杂的图形，CANVAS 都是一个很好的工具。

# java - 你如何比较Java中的两个版本字符串？

> ID：198431
> 
> 赞同：190
> 
> 时间：2008-10-13T17:54:41.370
> 
> 标签：java, comparison, versioning

有比较版本号的标准习语吗？我不能只使用直接的 String compareTo，因为我还不知道最大发布点数是多少。我需要比较版本并满足以下条件：

```
1.0 < 1.1
1.0.1 < 1.1
1.9 < 1.10 
```

* * *

## 回答 #1

> 赞同：202
> 
> 时间：2012-06-13T22:25:05.900

这个旧帖子的另一个解决方案（对于那些可能有帮助的人）：

```
public class Version implements Comparable<Version> {

    private String version;

    public final String get() {
        return this.version;
    }

    public Version(String version) {
        if(version == null)
            throw new IllegalArgumentException("Version can not be null");
        if(!version.matches("[0-9]+(\\.[0-9]+)*"))
            throw new IllegalArgumentException("Invalid version format");
        this.version = version;
    }

    @Override public int compareTo(Version that) {
        if(that == null)
            return 1;
        String[] thisParts = this.get().split("\\.");
        String[] thatParts = that.get().split("\\.");
        int length = Math.max(thisParts.length, thatParts.length);
        for(int i = 0; i < length; i++) {
            int thisPart = i < thisParts.length ?
                Integer.parseInt(thisParts[i]) : 0;
            int thatPart = i < thatParts.length ?
                Integer.parseInt(thatParts[i]) : 0;
            if(thisPart < thatPart)
                return -1;
            if(thisPart > thatPart)
                return 1;
        }
        return 0;
    }

    @Override public boolean equals(Object that) {
        if(this == that)
            return true;
        if(that == null)
            return false;
        if(this.getClass() != that.getClass())
            return false;
        return this.compareTo((Version) that) == 0;
    }

} 
```

* * *

```
Version a = new Version("1.1");
Version b = new Version("1.1.1");
a.compareTo(b) // return -1 (a<b)
a.equals(b)    // return false

Version a = new Version("2.0");
Version b = new Version("1.9.9");
a.compareTo(b) // return 1 (a>b)
a.equals(b)    // return false

Version a = new Version("1.0");
Version b = new Version("1");
a.compareTo(b) // return 0 (a=b)
a.equals(b)    // return true

Version a = new Version("1");
Version b = null;
a.compareTo(b) // return 1 (a>b)
a.equals(b)    // return false

List<Version> versions = new ArrayList<Version>();
versions.add(new Version("2"));
versions.add(new Version("1.0.5"));
versions.add(new Version("1.01.0"));
versions.add(new Version("1.00.1"));
Collections.min(versions).get() // return min version
Collections.max(versions).get() // return max version

// WARNING
Version a = new Version("2.06");
Version b = new Version("2.060");
a.equals(b)    // return false 
```

* * *

编辑：

@daiscog：谢谢你的评论，这段代码是为Android平台开发的，根据谷歌的推荐，与使用监管模式的Java不同，该方法“匹配”检查整个字符串。（[Android 文档](http://developer.android.com/reference/java/lang/String.html#matches%28java.lang.String%29)- [JAVA 文档](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#matches%28java.lang.String%29)）

* * *

## 回答 #2

> 赞同：119
> 
> 时间：2011-07-10T12:02:15.953

使用 Maven 真的很容易：

```
import org.apache.maven.artifact.versioning.DefaultArtifactVersion;

DefaultArtifactVersion minVersion = new DefaultArtifactVersion("1.0.1");
DefaultArtifactVersion maxVersion = new DefaultArtifactVersion("1.10");

DefaultArtifactVersion version = new DefaultArtifactVersion("1.11");

if (version.compareTo(minVersion) < 0 || version.compareTo(maxVersion) > 0) {
    System.out.println("Sorry, your version is unsupported");
} 
```

[您可以从此页面](http://mvnrepository.com/artifact/org.apache.maven/maven-artifact/3.0.3)获取 Maven Artifact 的正确依赖字符串：

```
<dependency>
<groupId>org.apache.maven</groupId>
<artifactId>maven-artifact</artifactId>
<version>3.0.3</version>
</dependency> 
```

* * *

## 回答 #3

> 赞同：64
> 
> 时间：2008-10-13T17:57:23.283

用点作为分隔符对字符串进行标记，然后从左侧开始并排比较整数翻译。

* * *

## 回答 #4

> 赞同：53
> 
> 时间：2009-05-07T19:50:01.120

您需要规范化版本字符串，以便可以比较它们。就像是

```
import java.util.regex.Pattern;

public class Main {
    public static void main(String... args) {
        compare("1.0", "1.1");
        compare("1.0.1", "1.1");
        compare("1.9", "1.10");
        compare("1.a", "1.9");
    }

    private static void compare(String v1, String v2) {
        String s1 = normalisedVersion(v1);
        String s2 = normalisedVersion(v2);
        int cmp = s1.compareTo(s2);
        String cmpStr = cmp < 0 ? "<" : cmp > 0 ? ">" : "==";
        System.out.printf("'%s' %s '%s'%n", v1, cmpStr, v2);
    }

    public static String normalisedVersion(String version) {
        return normalisedVersion(version, ".", 4);
    }

    public static String normalisedVersion(String version, String sep, int maxWidth) {
        String[] split = Pattern.compile(sep, Pattern.LITERAL).split(version);
        StringBuilder sb = new StringBuilder();
        for (String s : split) {
            sb.append(String.format("%" + maxWidth + 's', s));
        }
        return sb.toString();
    }
} 
```

印刷

> ```
> '1.0' < '1.1'
> '1.0.1' < '1.1'
> '1.9' < '1.10'
> '1.a' > '1.9' 
> ```

* * *

## 回答 #5

> 赞同：51
> 
> 时间：2014-11-04T21:55:16.040

最好重用现有代码，取[Maven 的 ComparableVersion 类](http://grepcode.com/file_/repo1.maven.org/maven2/org.apache.maven/maven-artifact/3.2.3/org/apache/maven/artifact/versioning/ComparableVersion.java/?v=source)

好处：

*   Apache 许可证，版本 2.0，
*   经测试，
*   在 spring-security-core、jboss 等多个项目中使用（复制）
*   多种[功能](https://maven.apache.org/ref/3.0.4/maven-artifact/apidocs/org/apache/maven/artifact/versioning/ComparableVersion.html)
*   它已经是 java.lang.Comparable
*   只需复制粘贴该类，没有第三方依赖项

不要包含对 maven-artifact 的依赖，因为这会拉取各种传递依赖

* * *

## 回答 #6

> 赞同：36
> 
> 时间：2012-04-05T19:16:15.897

```
// VersionComparator.java
import java.util.Comparator;

public class VersionComparator implements Comparator {

    public boolean equals(Object o1, Object o2) {
        return compare(o1, o2) == 0;
    }

    public int compare(Object o1, Object o2) {
        String version1 = (String) o1;
        String version2 = (String) o2;

        VersionTokenizer tokenizer1 = new VersionTokenizer(version1);
        VersionTokenizer tokenizer2 = new VersionTokenizer(version2);

        int number1 = 0, number2 = 0;
        String suffix1 = "", suffix2 = "";

        while (tokenizer1.MoveNext()) {
            if (!tokenizer2.MoveNext()) {
                do {
                    number1 = tokenizer1.getNumber();
                    suffix1 = tokenizer1.getSuffix();
                    if (number1 != 0 || suffix1.length() != 0) {
                        // Version one is longer than number two, and non-zero
                        return 1;
                    }
                }
                while (tokenizer1.MoveNext());

                // Version one is longer than version two, but zero
                return 0;
            }

            number1 = tokenizer1.getNumber();
            suffix1 = tokenizer1.getSuffix();
            number2 = tokenizer2.getNumber();
            suffix2 = tokenizer2.getSuffix();

            if (number1 < number2) {
                // Number one is less than number two
                return -1;
            }
            if (number1 > number2) {
                // Number one is greater than number two
                return 1;
            }

            boolean empty1 = suffix1.length() == 0;
            boolean empty2 = suffix2.length() == 0;

            if (empty1 && empty2) continue; // No suffixes
            if (empty1) return 1; // First suffix is empty (1.2 > 1.2b)
            if (empty2) return -1; // Second suffix is empty (1.2a < 1.2)

            // Lexical comparison of suffixes
            int result = suffix1.compareTo(suffix2);
            if (result != 0) return result;

        }
        if (tokenizer2.MoveNext()) {
            do {
                number2 = tokenizer2.getNumber();
                suffix2 = tokenizer2.getSuffix();
                if (number2 != 0 || suffix2.length() != 0) {
                    // Version one is longer than version two, and non-zero
                    return -1;
                }
            }
            while (tokenizer2.MoveNext());

            // Version two is longer than version one, but zero
            return 0;
        }
        return 0;
    }
}

// VersionTokenizer.java
public class VersionTokenizer {
    private final String _versionString;
    private final int _length;

    private int _position;
    private int _number;
    private String _suffix;
    private boolean _hasValue;

    public int getNumber() {
        return _number;
    }

    public String getSuffix() {
        return _suffix;
    }

    public boolean hasValue() {
        return _hasValue;
    }

    public VersionTokenizer(String versionString) {
        if (versionString == null)
            throw new IllegalArgumentException("versionString is null");

        _versionString = versionString;
        _length = versionString.length();
    }

    public boolean MoveNext() {
        _number = 0;
        _suffix = "";
        _hasValue = false;

        // No more characters
        if (_position >= _length)
            return false;

        _hasValue = true;

        while (_position < _length) {
            char c = _versionString.charAt(_position);
            if (c < '0' || c > '9') break;
            _number = _number * 10 + (c - '0');
            _position++;
        }

        int suffixStart = _position;

        while (_position < _length) {
            char c = _versionString.charAt(_position);
            if (c == '.') break;
            _position++;
        }

        _suffix = _versionString.substring(suffixStart, _position);

        if (_position < _length) _position++;

        return true;
    }
} 
```

**例子：**

```
public class Main
{
    private static VersionComparator cmp;

    public static void main (String[] args)
    {
        cmp = new VersionComparator();
        Test(new String[]{"1.1.2", "1.2", "1.2.0", "1.2.1", "1.12"});
        Test(new String[]{"1.3", "1.3a", "1.3b", "1.3-SNAPSHOT"});
    }

    private static void Test(String[] versions) {
        for (int i = 0; i < versions.length; i++) {
            for (int j = i; j < versions.length; j++) {
                Test(versions[i], versions[j]);
            }
        }
    }

    private static void Test(String v1, String v2) {
        int result = cmp.compare(v1, v2);
        String op = "==";
        if (result < 0) op = "<";
        if (result > 0) op = ">";
        System.out.printf("%s %s %s\n", v1, op, v2);
    }
} 
```

**输出：**

```
1.1.2 == 1.1.2                --->  same length and value
1.1.2 < 1.2                   --->  first number (1) less than second number (2) => -1
1.1.2 < 1.2.0                 --->  first number (1) less than second number (2) => -1
1.1.2 < 1.2.1                 --->  first number (1) less than second number (2) => -1
1.1.2 < 1.12                  --->  first number (1) less than second number (12) => -1
1.2 == 1.2                    --->  same length and value
1.2 == 1.2.0                  --->  first shorter than second, but zero
1.2 < 1.2.1                   --->  first shorter than second, and non-zero
1.2 < 1.12                    --->  first number (2) less than second number (12) => -1
1.2.0 == 1.2.0                --->  same length and value
1.2.0 < 1.2.1                 --->  first number (0) less than second number (1) => -1
1.2.0 < 1.12                  --->  first number (2) less than second number (12) => -1
1.2.1 == 1.2.1                --->  same length and value
1.2.1 < 1.12                  --->  first number (2) less than second number (12) => -1
1.12 == 1.12                  --->  same length and value

1.3 == 1.3                    --->  same length and value
1.3 > 1.3a                    --->  first suffix ('') is empty, but not second ('a') => 1
1.3 > 1.3b                    --->  first suffix ('') is empty, but not second ('b') => 1
1.3 > 1.3-SNAPSHOT            --->  first suffix ('') is empty, but not second ('-SNAPSHOT') => 1
1.3a == 1.3a                  --->  same length and value
1.3a < 1.3b                   --->  first suffix ('a') compared to second suffix ('b') => -1
1.3a < 1.3-SNAPSHOT           --->  first suffix ('a') compared to second suffix ('-SNAPSHOT') => -1
1.3b == 1.3b                  --->  same length and value
1.3b < 1.3-SNAPSHOT           --->  first suffix ('b') compared to second suffix ('-SNAPSHOT') => -1
1.3-SNAPSHOT == 1.3-SNAPSHOT  --->  same length and value 
```

* * *

## 回答 #7

> 赞同：29
> 
> 时间：2020-11-30T16:26:07.360

# 使用 Java 9[自己的内置`Version`类](https://docs.oracle.com/javase/9/docs/api/java/lang/module/ModuleDescriptor.Version.html)

```
import java.util.*;
import java.lang.module.ModuleDescriptor.Version;
class Main {
  public static void main(String[] args) {
    var versions = Arrays.asList(
      "1.0.2",
      "1.0.0-beta.2",
      "1.0.0",
      "1.0.0-beta",
      "1.0.0-alpha.12",
      "1.0.0-beta.11",
      "1.0.1",
      "1.0.11",
      "1.0.0-rc.1",
      "1.0.0-alpha.1",
      "1.1.0",
      "1.0.0-alpha.beta",
      "1.11.0",
      "1.0.0-alpha.12.ab-c",
      "0.0.1",
      "1.2.1",
      "1.0.0-alpha",
      "1.0.0.1",  // Also works with a number of sections different than 3
      "1.0.0.2",
      "2",
      "10",
      "1.0.0.10"
    );
    versions.stream()
      .map(Version::parse)
      .sorted()
      .forEach(System.out::println);
  }
} 
```

[在线尝试！](https://tio.run/##dZI9b8JADIb3/AqLKVTlyNEN1AGp3cqE1KXq4CQXcnC5i@xLEKr47WkaUAkBJsuvH3/I9hZrnGzTXdPoonTkYdsKovLaiKdF0NcM2o0oXFoZJVadeVOckC69I/GpiLWziyAxyAwr1BZ@AoCyio1OgD361tROp1C0sXDtSdvN1zcgbXjcoQA1EtSnQgyvsCTCAwvkD80@7AiAkRSRmI2e@240iZXHG/UeNNTQlDkKeb@glNfy0JXDLEqEfNChL8vb2U7UcEL5kJQzgfEkuQSj4XyzB6MMxD8KYDqFpWEHe0c7hr32OSDYqogVgcuAVeK7o6Q6yxQp68HnaOHlulRvi/2FRjcto1EnjBens59PLtiTwiIcn2lRYBmeH2s@L5FY/Ye4fUuVXtDM0Tsmebg@sFeFcJVvM9oX88Z2XY7BsWl@AQ "Java (JDK) – 在线试用")

输出：

```
0.0.1
1.0.0-alpha
1.0.0-alpha.1
1.0.0-alpha.12
1.0.0-alpha.12.ab-c
1.0.0-alpha.beta
1.0.0-beta
1.0.0-beta.2
1.0.0-beta.11
1.0.0-rc.1
1.0.0
1.0.0.1
1.0.0.2
1.0.0.10
1.0.1
1.0.2
1.0.11
1.1.0
1.2.1
1.11.0
2
10 
```

* * *

## 回答 #8

> 赞同：22
> 
> 时间：2016-10-17T15:04:36.457

想知道为什么每个人都认为版本仅由整数组成 - 在我的情况下不是。

为什么要重新发明轮子（假设版本遵循 Semver 标准）

首先通过 Maven安装[https://github.com/vdurmont/semver4j](https://github.com/vdurmont/semver4j)

然后使用这个库

```
Semver sem = new Semver("1.2.3");
sem.isGreaterThan("1.2.2"); // true 
```

* * *

## 回答 #9

> 赞同：17
> 
> 时间：2015-01-11T20:31:41.273

```
public static int compareVersions(String version1, String version2){

    String[] levels1 = version1.split("\\.");
    String[] levels2 = version2.split("\\.");

    int length = Math.max(levels1.length, levels2.length);
    for (int i = 0; i < length; i++){
        Integer v1 = i < levels1.length ? Integer.parseInt(levels1[i]) : 0;
        Integer v2 = i < levels2.length ? Integer.parseInt(levels2[i]) : 0;
        int compare = v1.compareTo(v2);
        if (compare != 0){
            return compare;
        }
    }

    return 0;
} 
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2018-12-27T11:40:09.553

如果您的项目中已经有 Jackson，您可以使用`com.fasterxml.jackson.core.Version`：

```
import com.fasterxml.jackson.core.Version;
import org.junit.Test;

import static org.junit.Assert.assertTrue;

public class VersionTest {

    @Test
    public void shouldCompareVersion() {
        Version version1 = new Version(1, 11, 1, null, null, null);
        Version version2 = new Version(1, 12, 1, null, null, null);
        assertTrue(version1.compareTo(version2) < 0);
    }
} 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2020-05-14T11:00:57.603

@alex在 Kotlin 上的[帖子](https://stackoverflow.com/a/11024200/6352712)

```
class Version(inputVersion: String) : Comparable<Version> {

        var version: String
            private set

        override fun compareTo(other: Version) =
            (split() to other.split()).let {(thisParts, thatParts)->
                val length = max(thisParts.size, thatParts.size)
                for (i in 0 until length) {
                    val thisPart = if (i < thisParts.size) thisParts[i].toInt() else 0
                    val thatPart = if (i < thatParts.size) thatParts[i].toInt() else 0
                    if (thisPart < thatPart) return -1
                    if (thisPart > thatPart) return 1
                }
                 0
            }

        init {
            require(inputVersion.matches("[0-9]+(\\.[0-9]+)*".toRegex())) { "Invalid version format" }
            version = inputVersion
        }
    }

    fun Version.split() = version.split(".").toTypedArray() 
```

用法：

```
Version("1.2.4").compareTo(Version("0.0.5")) //return 1 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2010-01-09T01:33:34.050

```
public int compare(String v1, String v2) {
        v1 = v1.replaceAll("\\s", "");
        v2 = v2.replaceAll("\\s", "");
        String[] a1 = v1.split("\\.");
        String[] a2 = v2.split("\\.");
        List<String> l1 = Arrays.asList(a1);
        List<String> l2 = Arrays.asList(a2);

        int i=0;
        while(true){
            Double d1 = null;
            Double d2 = null;

            try{
                d1 = Double.parseDouble(l1.get(i));
            }catch(IndexOutOfBoundsException e){
            }

            try{
                d2 = Double.parseDouble(l2.get(i));
            }catch(IndexOutOfBoundsException e){
            }

            if (d1 != null && d2 != null) {
                if (d1.doubleValue() > d2.doubleValue()) {
                    return 1;
                } else if (d1.doubleValue() < d2.doubleValue()) {
                    return -1;
                }
            } else if (d2 == null && d1 != null) {
                if (d1.doubleValue() > 0) {
                    return 1;
                }
            } else if (d1 == null && d2 != null) {
                if (d2.doubleValue() > 0) {
                    return -1;
                }
            } else {
                break;
            }
            i++;
        }
        return 0;
    } 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2018-05-04T19:00:43.460

```
/**  
 *  written by: Stan Towianski - May 2018 
 * notes: I make assumption each of 3 version sections a.b.c is not longer then 4 digits: aaaa.bbbb.cccc-MODWORD1(-)modnum2
 * 5.10.13-release-1 becomes 0000500100013.501     6.0-snapshot becomes 0000600000000.100
 * MODWORD1 = -xyz/NotMatching, -SNAPSHOT, -ALPHA, -BETA, -RC, -RELEASE/nothing  return:  .0, .1, .2, .3, .4, .5
 * modnum2 = up to 2 digit/chars second version
 * */
public class VersionCk {

    private static boolean isVersionHigher( String baseVersion, String testVersion )
        {
        System.out.println( "versionToComparable( baseVersion ) =" + versionToComparable( baseVersion ) );
        System.out.println( "versionToComparable( testVersion ) =" + versionToComparable( testVersion ) + " is this higher ?" );
        return versionToComparable( testVersion ).compareTo( versionToComparable( baseVersion ) ) > 0;
        }

    //----  not worrying about += for something so small
    private static String versionToComparable( String version )
        {
//        System.out.println("version - " + version);
        String versionNum = version;
        int at = version.indexOf( '-' );
        if ( at >= 0 )
            versionNum = version.substring( 0, at );

        String[] numAr = versionNum.split( "\\." );
        String versionFormatted = "0";
        for ( String tmp : numAr )
            {
            versionFormatted += String.format( "%4s", tmp ).replace(' ', '0');
            }
        while ( versionFormatted.length() < 12 )  // pad out to aaaa.bbbb.cccc
            {
            versionFormatted += "0000";
            }
//        System.out.println( "converted min version =" + versionFormatted + "=   : " + versionNum );
        return versionFormatted + getVersionModifier( version, at );
        }

    //----  use order low to high: -xyz, -SNAPSHOT, -ALPHA, -BETA, -RC, -RELEASE/nothing  returns: 0, 1, 2, 3, 4, 5
    private static String getVersionModifier( String version, int at )
        {
//        System.out.println("version - " + version );
        String[] wordModsAr = { "-SNAPSHOT", "-ALPHA", "-BETA", "-RC", "-RELEASE" };        

        if ( at < 0 )
            return "." + wordModsAr.length + "00";   // make nothing = RELEASE level

        int i = 1;
        for ( String word : wordModsAr )
            {
            if ( ( at = version.toUpperCase().indexOf( word ) ) > 0 )
                return "." + i + getSecondVersionModifier( version.substring( at + word.length() ) );
            i++;
            }

        return ".000";
        }

    //----  add 2 chars for any number after first modifier.  -rc2 or -rc-2   returns 02
    private static String getSecondVersionModifier( String version )
        {
        System.out.println( "second modifier =" + version + "=" );
        Matcher m = Pattern.compile("(.*?)(\\d+).*").matcher( version );
//        if ( m.matches() )
//            System.out.println( "match ? =" + m.matches() + "=   m.group(1) =" + m.group(1) + "=   m.group(2) =" + m.group(2) + "=   m.group(3) =" + (m.groupCount() >= 3 ? m.group(3) : "x") );
//        else
//            System.out.println( "No match" );
        return m.matches() ? String.format( "%2s", m.group(2) ).replace(' ', '0') : "00";
        }

    public static void main(String[] args) 
        {
        checkVersion( "3.10.0", "3.4.0");
        checkVersion( "5.4.2", "5.4.1");
        checkVersion( "5.4.4", "5.4.5");
        checkVersion( "5.4.9", "5.4.12");
        checkVersion( "5.9.222", "5.10.12");
        checkVersion( "5.10.12", "5.10.12");
        checkVersion( "5.10.13", "5.10.14");
        checkVersion( "6.7.0", "6.8");
        checkVersion( "6.7", "2.7.0");
        checkVersion( "6", "6.3.1");
        checkVersion( "4", "4.0.0");
        checkVersion( "6.3.0", "6");
        checkVersion( "5.10.12-Alpha", "5.10.12-beTA");
        checkVersion( "5.10.13-release", "5.10.14-beta");
        checkVersion( "6.7.0", "6.8-snapshot");
        checkVersion( "6.7.1", "6.7.0-release");
        checkVersion( "6-snapshot", "6.0.0-beta");
        checkVersion( "6.0-snapshot", "6.0.0-whatthe");
        checkVersion( "5.10.12-Alpha-1", "5.10.12-alpha-2");
        checkVersion( "5.10.13-release-1", "5.10.13-release2");
        checkVersion( "10-rc42", "10.0.0-rc53");
        }

    private static void checkVersion(String baseVersion, String testVersion) 
        {
        System.out.println( "baseVersion - " + baseVersion );
        System.out.println( "testVersion - " + testVersion );
        System.out.println( "isVersionHigher = " + isVersionHigher( baseVersion, testVersion ) );
        System.out.println( "---------------");
        }

    } 
```

一些输出：

```
---------------
baseVersion - 6.7
testVersion - 2.7.0
versionToComparable( baseVersion ) =0000600070000.500
versionToComparable( testVersion ) =0000200070000.500 is this higher ?
isVersionHigher = false
---------------
baseVersion - 6
testVersion - 6.3.1
versionToComparable( baseVersion ) =0000600000000.500
versionToComparable( testVersion ) =0000600030001.500 is this higher ?
isVersionHigher = true
---------------
baseVersion - 4
testVersion - 4.0.0
versionToComparable( baseVersion ) =0000400000000.500
versionToComparable( testVersion ) =0000400000000.500 is this higher ?
isVersionHigher = false
---------------
baseVersion - 6.3.0
testVersion - 6
versionToComparable( baseVersion ) =0000600030000.500
versionToComparable( testVersion ) =0000600000000.500 is this higher ?
isVersionHigher = false
---------------
baseVersion - 5.10.12-Alpha
testVersion - 5.10.12-beTA
second modifier ==
versionToComparable( baseVersion ) =0000500100012.200
second modifier ==
versionToComparable( testVersion ) =0000500100012.300 is this higher ?
second modifier ==
second modifier ==
isVersionHigher = true
---------------
baseVersion - 5.10.13-release
testVersion - 5.10.14-beta
second modifier ==
versionToComparable( baseVersion ) =0000500100013.500
second modifier ==
versionToComparable( testVersion ) =0000500100014.300 is this higher ?
second modifier ==
second modifier ==
isVersionHigher = true
---------------
baseVersion - 6.7.0
testVersion - 6.8-snapshot
versionToComparable( baseVersion ) =0000600070000.500
second modifier ==
versionToComparable( testVersion ) =0000600080000.100 is this higher ?
second modifier ==
isVersionHigher = true
---------------
baseVersion - 6.7.1
testVersion - 6.7.0-release
versionToComparable( baseVersion ) =0000600070001.500
second modifier ==
versionToComparable( testVersion ) =0000600070000.500 is this higher ?
second modifier ==
isVersionHigher = false
---------------
baseVersion - 6-snapshot
testVersion - 6.0.0-beta
second modifier ==
versionToComparable( baseVersion ) =0000600000000.100
second modifier ==
versionToComparable( testVersion ) =0000600000000.300 is this higher ?
second modifier ==
second modifier ==
isVersionHigher = true
---------------
baseVersion - 6.0-snapshot
testVersion - 6.0.0-whatthe
second modifier ==
versionToComparable( baseVersion ) =0000600000000.100
versionToComparable( testVersion ) =0000600000000.000 is this higher ?
second modifier ==
isVersionHigher = false
---------------
baseVersion - 5.10.12-Alpha-1
testVersion - 5.10.12-alpha-2
second modifier =-1=
versionToComparable( baseVersion ) =0000500100012.201
second modifier =-2=
versionToComparable( testVersion ) =0000500100012.202 is this higher ?
second modifier =-2=
second modifier =-1=
isVersionHigher = true
---------------
baseVersion - 5.10.13-release-1
testVersion - 5.10.13-release2
second modifier =-1=
versionToComparable( baseVersion ) =0000500100013.501
second modifier =2=
versionToComparable( testVersion ) =0000500100013.502 is this higher ?
second modifier =2=
second modifier =-1=
isVersionHigher = true
---------------
baseVersion - 10-rc42
testVersion - 10.0.0-rc53
second modifier =42=
versionToComparable( baseVersion ) =0001000000000.442
second modifier =53=
versionToComparable( testVersion ) =0001000000000.453 is this higher ?
second modifier =53=
second modifier =42=
isVersionHigher = true
--------------- 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2019-03-06T12:32:37.330

我编写了一个名为 MgntUtils 的开源库，它有一个适用于字符串版本的实用程序。它正确地比较它们，使用版本范围等等。这是这个库[javadoc](http://michaelgantman.github.io/Mgnt/docs/)查看方法`TextUtils.comapreVersions(...)`。它已被大量使用并经过良好测试。这是描述库及其获取位置的[文章。](https://community.oracle.com/blogs/michaelgantman/2016/01/26/open-source-java-library-with-stacktrace-filtering-silent-string-parsing-and-version-comparison)它可以作为[Maven 工件](https://search.maven.org/search?q=MgntUtils)和在[github](https://github.com/michaelgantman/Mgnt)上使用（带有源代码和 JavaDoc）

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2020-04-25T02:25:31.793

我现在就这样做了，问自己，对吗？因为我以前从未找到比我最干净的解决方案：

您只需要像以下示例一样拆分字符串版本（“1.0.0”）：

```
userVersion.split("\\.") 
```

然后你将有：{“1”，“0”，“0”}

现在，使用我所做的方法：

```
isUpdateAvailable(userVersion.split("\\."), latestVersionSplit.split("\\.")); 
```

方法：

```
/**
 * Compare two versions
 *
 * @param userVersionSplit   - User string array with major, minor and patch version from user (exemple: {"5", "2", "70"})
 * @param latestVersionSplit - Latest string array with major, minor and patch version from api (example: {"5", "2", "71"})
 * @return true if user version is smaller than latest version
 */
public static boolean isUpdateAvailable(String[] userVersionSplit, String[] latestVersionSplit) {

    try {
        int majorUserVersion = Integer.parseInt(userVersionSplit[0]);
        int minorUserVersion = Integer.parseInt(userVersionSplit[1]);
        int patchUserVersion = Integer.parseInt(userVersionSplit[2]);

        int majorLatestVersion = Integer.parseInt(latestVersionSplit[0]);
        int minorLatestVersion = Integer.parseInt(latestVersionSplit[1]);
        int patchLatestVersion = Integer.parseInt(latestVersionSplit[2]);

        if (majorUserVersion <= majorLatestVersion) {
            if (majorUserVersion < majorLatestVersion) {
                return true;
            } else {
                if (minorUserVersion <= minorLatestVersion) {
                    if (minorUserVersion < minorLatestVersion) {
                        return true;
                    } else {
                        return patchUserVersion < patchLatestVersion;
                    }
                }
            }
        }
    } catch (Exception ignored) {
        // Will be throw only if the versions pattern is different from "x.x.x" format
        // Will return false at the end
    }

    return false;
} 
```

等待任何反馈:)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2013-01-29T20:15:41.303

我创建了一个简单[**的实用程序，用于**](https://github.com/petrnohejl/Alfonz/blob/master/alfonz-utility/src/main/java/org/alfonz/utility/VersionUtility.java)使用[**语义版本控制**](http://semver.org/)约定比较**Android 平台**上的版本。因此它仅适用于格式为 XYZ (Major.Minor.Patch) 的字符串，其中 X、Y 和 Z 是非负整数。你可以在我的[GitHub 上](https://github.com/petrnohejl/Alfonz/blob/master/alfonz-utility/src/main/java/org/alfonz/utility/VersionUtility.java)找到它。[](http://semver.org/)

 **方法*Version.compareVersions(String v1, String v2)*比较两个版本字符串。如果版本相等，则返回 0，如果版本 v1 在版本 v2 之前，则返回 1，如果版本 v1 在版本 v2 之后，则返回 -1，如果版本格式无效，则返回 -2。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2016-06-02T13:39:07.203

对于我的项目，我使用我的 commons-version 库[https://github.com/raydac/commons-version](https://github.com/raydac/commons-version) 它包含两个辅助类 - 解析版本（解析的版本可以与另一个版本对象进行比较，因为它是可比较的）和 VersionValidator它允许检查某些表达式的版本，例如`!=ide-1.1.1,>idea-1.3.4-SNAPSHOT;<1.2.3`

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2019-03-13T11:54:16.643

```
public int CompareVersions(String version1, String version2)
{
    String[] string1Vals = version1.split("\\.");
    String[] string2Vals = version2.split("\\.");

    int length = Math.max(string1Vals.length, string2Vals.length);

    for (int i = 0; i < length; i++)
    {
        Integer v1 = (i < string1Vals.length)?Integer.parseInt(string1Vals[i]):0;
        Integer v2 = (i < string2Vals.length)?Integer.parseInt(string2Vals[i]):0;

        //Making sure Version1 bigger than version2
        if (v1 > v2)
        {
            return 1;
        }
        //Making sure Version1 smaller than version2
        else if(v1 < v2)
        {
            return -1;
        }
    }

    //Both are equal
    return 0;
} 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2019-08-03T13:04:16.323

我编写了一个小型 Java/Android 库来比较版本号：[https ://github.com/G00fY2/version-compare](https://github.com/G00fY2/version-compare)

它的基本作用是这样的：

```
 public int compareVersions(String versionA, String versionB) {
    String[] versionTokensA = versionA.split("\\.");
    String[] versionTokensB = versionB.split("\\.");
    List<Integer> versionNumbersA = new ArrayList<>();
    List<Integer> versionNumbersB = new ArrayList<>();

    for (String versionToken : versionTokensA) {
      versionNumbersA.add(Integer.parseInt(versionToken));
    }
    for (String versionToken : versionTokensB) {
      versionNumbersB.add(Integer.parseInt(versionToken));
    }

    final int versionASize = versionNumbersA.size();
    final int versionBSize = versionNumbersB.size();
    int maxSize = Math.max(versionASize, versionBSize);

    for (int i = 0; i < maxSize; i++) {
      if ((i < versionASize ? versionNumbersA.get(i) : 0) > (i < versionBSize ? versionNumbersB.get(i) : 0)) {
        return 1;
      } else if ((i < versionASize ? versionNumbersA.get(i) : 0) < (i < versionBSize ? versionNumbersB.get(i) : 0)) {
        return -1;
      }
    }
    return 0;
  } 
```

此代码段不提供任何错误检查或处理。除此之外，我的库还支持“1.2-rc”>“1.2-beta”等后缀。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2019-11-15T12:07:58.543

由于此页面上没有答案可以很好地处理混合文本，因此我制作了自己的版本：

```
import java.util.regex.Matcher;
import java.util.regex.Pattern;

class Main {
    static double parseVersion(String v) {
        if (v.isEmpty()) {
            return 0;
        }
        Pattern p = Pattern.compile("^(\\D*)(\\d*)(\\D*)$");
        Matcher m = p.matcher(v);
        m.find();
        if (m.group(2).isEmpty()) {
            // v1.0.0.[preview]
            return -1;
        }
        double i = Integer.parseInt(m.group(2));
        if (!m.group(3).isEmpty()) {
            // v1.0.[0b]
            i -= 0.1;
        }
        return i;
    }

    public static int versionCompare(String str1, String str2) {
        String[] v1 = str1.split("\\.");
        String[] v2 = str2.split("\\.");
        int i = 0;
        for (; i < v1.length && i < v2.length; i++) {
            double iv1 = parseVersion(v1[i]);
            double iv2 = parseVersion(v2[i]);

            if (iv1 != iv2) {
                return iv1 - iv2 < 0 ? -1 : 1;
            }
        }
        if (i < v1.length) {
            // "1.0.1", "1.0"
            double iv1 = parseVersion(v1[i]);
            return iv1 < 0 ? -1 : (int) Math.ceil(iv1);
        }
        if (i < v2.length) {
            double iv2 = parseVersion(v2[i]);
            return -iv2 < 0 ? -1 : (int) Math.ceil(iv2);
        }
        return 0;
    }

    public static void main(String[] args) {
        System.out.println("versionCompare(v1.0.0, 1.0.0)");
        System.out.println(versionCompare("v1.0.0", "1.0.0")); // 0

        System.out.println("versionCompare(v1.0.0b, 1.0.0)");
        System.out.println(versionCompare("v1.0.0b", "1.0.0")); // -1

        System.out.println("versionCompare(v1.0.0.preview, 1.0.0)");
        System.out.println(versionCompare("v1.0.0.preview", "1.0.0")); // -1

        System.out.println("versionCompare(v1.0, 1.0.0)");
        System.out.println(versionCompare("v1.0", "1.0.0")); // 0

        System.out.println("versionCompare(ver1.0, 1.0.1)");
        System.out.println(versionCompare("ver1.0", "1.0.1")); // -1
    }
} 
```

但是，在您需要将“alpha”与“beta”进行比较的情况下，它仍然不足。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2020-06-23T10:34:39.527

基于[https://stackoverflow.com/a/27891752/2642478](https://stackoverflow.com/a/27891752/2642478)

```
class Version(private val value: String) : Comparable<Version> {
    private val splitted by lazy { value.split("-").first().split(".").map { it.toIntOrNull() ?: 0 } }

    override fun compareTo(other: Version): Int {
        for (i in 0 until maxOf(splitted.size, other.splitted.size)) {
            val compare = splitted.getOrElse(i) { 0 }.compareTo(other.splitted.getOrElse(i) { 0 })
            if (compare != 0)
                return compare
        }
        return 0
    }
} 
```

你可以像这样使用：

```
 System.err.println(Version("1.0").compareTo( Version("1.0")))
    System.err.println(Version("1.0") < Version("1.1"))
    System.err.println(Version("1.10") > Version("1.9"))
    System.err.println(Version("1.10.1") > Version("1.10"))
    System.err.println(Version("0.0.1") < Version("1")) 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2020-10-15T15:09:17.267

也许有人会对我的解决方案感兴趣：

```
class Version private constructor(private val versionString: String) : Comparable<Version> {

    private val major: Int by lazy { versionString.split(".")[0].toInt() }

    private val minor: Int by lazy { versionString.split(".")[1].toInt() }

    private val patch: Int by lazy {
        val splitArray = versionString.split(".")

        if (splitArray.size == 3)
            splitArray[2].toInt()
        else
            0
    }

    override fun compareTo(other: Version): Int {
        return when {
            major > other.major -> 1
            major < other.major -> -1
            minor > other.minor -> 1
            minor < other.minor -> -1
            patch > other.patch -> 1
            patch < other.patch -> -1
            else -> 0
        }
    }

    override fun equals(other: Any?): Boolean {
        if (other == null || other !is Version) return false
        return compareTo(other) == 0
    }

    override fun hashCode(): Int {
        return major * minor * patch
    }

    companion object {
        private fun doesContainsVersion(string: String): Boolean {
            val versionArray = string.split(".")

            return versionArray.size in 2..3
                    && versionArray[0].toIntOrNull() != null
                    && versionArray[1].toIntOrNull() != null
                    && (versionArray.size == 2 || versionArray[2].toIntOrNull() != null)
        }

        fun from(string: String): Version? {
            return if (doesContainsVersion(string)) {
                Version(string)
            } else {
                null
            }
        }
    }
} 
```

用法：

```
val version1 = Version.from("3.2")
val version2 = Version.from("3.2.1")
version1 <= version2 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2017-02-18T05:59:01.060

自己写了一个小函数。使用列表更简单

```
 public static boolean checkVersionUpdate(String olderVerison, String newVersion) {
        if (olderVerison.length() == 0 || newVersion.length() == 0) {
            return false;
        }
        List<String> newVerList = Arrays.asList(newVersion.split("\\."));
        List<String> oldVerList = Arrays.asList(olderVerison.split("\\."));

        int diff = newVerList.size() - oldVerList.size();
        List<String> newList = new ArrayList<>();
        if (diff > 0) {
            newList.addAll(oldVerList);
            for (int i = 0; i < diff; i++) {
                newList.add("0");
            }
            return examineArray(newList, newVerList, diff);
        } else if (diff < 0) {
            newList.addAll(newVerList);
            for (int i = 0; i < -diff; i++) {
                newList.add("0");
            }
            return examineArray(oldVerList, newList, diff);
        } else {
            return examineArray(oldVerList, newVerList, diff);
        }

    }

    public static boolean examineArray(List<String> oldList, List<String> newList, int diff) {
        boolean newVersionGreater = false;
        for (int i = 0; i < oldList.size(); i++) {
            if (Integer.parseInt(newList.get(i)) > Integer.parseInt(oldList.get(i))) {
                newVersionGreater = true;
                break;
            } else if (Integer.parseInt(newList.get(i)) < Integer.parseInt(oldList.get(i))) {
                newVersionGreater = false;
                break;
            } else {
                newVersionGreater = diff > 0;
            }
        }

        return newVersionGreater;
    } 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2019-09-12T06:01:05.297

使用 Java 8 Stream 替换组件中的前导零。此代码通过了[interviewbit.com上的所有测试](https://www.interviewbit.com/problems/compare-version-numbers/)

```
public int compareVersion(String A, String B) {
    List<String> strList1 = Arrays.stream(A.split("\\."))
                                           .map(s -> s.replaceAll("^0+(?!$)", ""))
                                           .collect(Collectors.toList());
    List<String> strList2 = Arrays.stream(B.split("\\."))
                                           .map(s -> s.replaceAll("^0+(?!$)", ""))
                                           .collect(Collectors.toList());
    int len1 = strList1.size();
    int len2 = strList2.size();
    int i = 0;
    while(i < len1 && i < len2){
        if (strList1.get(i).length() > strList2.get(i).length()) return 1;
        if (strList1.get(i).length() < strList2.get(i).length()) return -1;
        int result = new Long(strList1.get(i)).compareTo(new Long(strList2.get(i)));
        if (result != 0) return result;
        i++;
    }
    while (i < len1){
        if (!strList1.get(i++).equals("0")) return 1;
    }
    while (i < len2){
        if (!strList2.get(i++).equals("0")) return -1;
    }
    return 0;
} 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2019-12-06T13:36:08.737

对于要根据版本号显示强制更新警报的人，我有以下想法。这可以在比较 Android Current App 版本和 firebase 远程配置版本之间的版本时使用。这不完全是所问问题的答案，但这肯定会帮助某人。

```
import java.util.List;
import java.util.ArrayList;
import java.util.Arrays;
public class Main
{
  static String firebaseVersion = "2.1.3"; // or 2.1
  static String appVersion = "2.1.4";
  static List<String> firebaseVersionArray;
  static List<String> appVersionArray;
  static boolean isNeedToShowAlert = false;
  public static void main (String[]args)
  {
    System.out.println ("Hello World");
    firebaseVersionArray = new ArrayList<String>(Arrays.asList(firebaseVersion.split ("\\.")));
    appVersionArray = new ArrayList<String>(Arrays.asList(appVersion.split ("\\.")));
    if(appVersionArray.size() < firebaseVersionArray.size()) {
        appVersionArray.add("0");
    }
    if(firebaseVersionArray.size() < appVersionArray.size()) {
        firebaseVersionArray.add("0");
    }
    isNeedToShowAlert = needToShowAlert(); //Returns false
    System.out.println (isNeedToShowAlert);

  }
  static boolean needToShowAlert() {
      boolean result = false;
      for(int i = 0 ; i < appVersionArray.size() ; i++) {
          if (Integer.parseInt(appVersionArray.get(i)) == Integer.parseInt(firebaseVersionArray.get(i))) {
              continue;
          } else if (Integer.parseInt(appVersionArray.get(i)) > Integer.parseInt(firebaseVersionArray.get(i))){
             result = false;
             break;
          } else if (Integer.parseInt(appVersionArray.get(i)) < Integer.parseInt(firebaseVersionArray.get(i))) {
             result = true;
             break;  
          }
      }
      return result;
  }
} 
```

[您可以通过在https://www.onlinegdb.com/online_java_compiler](https://www.onlinegdb.com/online_java_compiler)中复制粘贴来运行此代码

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2020-01-25T05:09:32.477

```
public static void main(String[] args) {

    String version1 = "1.0";
    String version2 = "1.0.0";
    String[] version1_splits = version1.split("\\.");
    String[] version2_splits = version2.split("\\.");
    int length = version1_splits.length >= version2_splits.length ? version1_splits.length : version2_splits.length;
    int i=0;
    for(;i<length;i++){
        int version1_int = getValue(version1_splits,i);
        int version2_int = getValue(version2_splits,i);
        if(version1_int > version2_int){
            System.out.println("version1 > version2");
            break;
        }
        else if(version1_int < version2_int){
            System.out.println("version2 > version1");
            break;
        }
        else{
            if(i == length-1)
            System.out.println("version1 = version2");
        }
    }
}

private static int getValue(String[] version1_splits, int i) {
    int temp;
    try{
        temp = Integer.valueOf(version1_splits[i]);
    }
    catch(IndexOutOfBoundsException e){
        temp=0;
    }

    return temp;
} 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2022-03-02T09:07:46.483

科特林：

```
@kotlin.jvm.Throws(InvalidParameterException::class)
fun String.versionCompare(remoteVersion: String?): Int {
    val remote = remoteVersion?.splitToSequence(".")?.toList() ?: return 1
    val local = this.splitToSequence(".").toList()

    if(local.filter { it.toIntOrNull() != null }.size != local.size) throw InvalidParameterException("version invalid: $this")
    if(remote.filter { it.toIntOrNull() != null }.size != remote.size) throw InvalidParameterException("version invalid: $remoteVersion")

    val totalRange = 0 until kotlin.math.max(local.size, remote.size)
    for (i in totalRange) {
        if (i < remote.size && i < local.size) {
            val result = local[i].compareTo(remote[i])
            if (result != 0) return result
        } else (
            return local.size.compareTo(remote.size)
        )
    }
    return 0
} 
```

* * *

## 回答 #28

> 赞同：-1
> 
> 时间：2016-04-05T16:27:02.283

此代码尝试解决此类比较版本。

> 大多数版本说明符，例如 >= 1.0，都是不言自明的。说明符 ~> 具有特殊含义，最好通过示例来说明。~> 2.0.3 等同于 >= 2.0.3 和 < 2.1。~> 2.1 等同于 >= 2.1 和 < 3.0。

```
public static boolean apply(String cmpDeviceVersion, String reqDeviceVersion)
{
    Boolean equal           = !cmpDeviceVersion.contains(">") && !cmpDeviceVersion.contains(">=") &&
                              !cmpDeviceVersion.contains("<") && !cmpDeviceVersion.contains("<=") &&
                              !cmpDeviceVersion.contains("~>");

    Boolean between         = cmpDeviceVersion.contains("~>");
    Boolean higher          = cmpDeviceVersion.contains(">") && !cmpDeviceVersion.contains(">=") && !cmpDeviceVersion.contains("~>");
    Boolean higherOrEqual   = cmpDeviceVersion.contains(">=");

    Boolean less            = cmpDeviceVersion.contains("<") && !cmpDeviceVersion.contains("<=");
    Boolean lessOrEqual     = cmpDeviceVersion.contains("<=");

    cmpDeviceVersion        = cmpDeviceVersion.replaceAll("[<>=~]", "");
    cmpDeviceVersion        = cmpDeviceVersion.trim();

    String[] version        = cmpDeviceVersion.split("\\.");
    String[] reqVersion     = reqDeviceVersion.split("\\.");

    if(equal)
    {
        return isEqual(version, reqVersion);
    }
    else if(between)
    {
        return isBetween(version, reqVersion);
    }
    else if(higher)
    {
        return isHigher(version, reqVersion);
    }
    else if(higherOrEqual)
    {
        return isEqual(version, reqVersion) || isHigher(version, reqVersion);
    }
    else if(less)
    {
        return isLess(version, reqVersion);
    }
    else if(lessOrEqual)
    {
        return isEqual(version, reqVersion) || isLess(version, reqVersion);
    }

    return false;
}

private static boolean isEqual(String[] version, String[] reqVersion)
{
    String strVersion = StringUtils.join(version);
    String strReqVersion = StringUtils.join(reqVersion);
    if(version.length > reqVersion.length)
    {
        Integer diff = version.length - reqVersion.length;
        strReqVersion += StringUtils.repeat(".0", diff);
    }
    else if(reqVersion.length > version.length)
    {
        Integer diff = reqVersion.length - version.length;
        strVersion += StringUtils.repeat(".0", diff);
    }

    return strVersion.equals(strReqVersion);
}

private static boolean isHigher(String[] version, String[] reqVersion)
{
    String strVersion = StringUtils.join(version);
    String strReqVersion = StringUtils.join(reqVersion);
    if(version.length > reqVersion.length)
    {
        Integer diff = version.length - reqVersion.length;
        strReqVersion += StringUtils.repeat(".0", diff);
    }
    else if(reqVersion.length > version.length)
    {
        Integer diff = reqVersion.length - version.length;
        strVersion += StringUtils.repeat(".0", diff);
    }

    return strReqVersion.compareTo(strVersion) > 0;
}

private static boolean isLess(String[] version, String[] reqVersion)
{
    String strVersion = StringUtils.join(version);
    String strReqVersion = StringUtils.join(reqVersion);
    if(version.length > reqVersion.length)
    {
        Integer diff = version.length - reqVersion.length;
        strReqVersion += StringUtils.repeat(".0", diff);
    }
    else if(reqVersion.length > version.length)
    {
        Integer diff = reqVersion.length - version.length;
        strVersion += StringUtils.repeat(".0", diff);
    }

    return strReqVersion.compareTo(strVersion) < 0;
}

private static boolean isBetween(String[] version, String[] reqVersion)
{
    return (isEqual(version, reqVersion) || isHigher(version, reqVersion)) &&
            isLess(getNextVersion(version), reqVersion);
}

private static String[] getNextVersion(String[] version)
{
    String[] nextVersion = new String[version.length];
    for(int i = version.length - 1; i >= 0 ; i--)
    {
        if(i == version.length - 1)
        {
            nextVersion[i] = "0";
        }
        else if((i == version.length - 2) && NumberUtils.isNumber(version[i]))
        {
            nextVersion[i] = String.valueOf(NumberUtils.toInt(version[i]) + 1);
        }
        else
        {
            nextVersion[i] = version[i];
        }
    }
    return nextVersion;
} 
```

* * *

## 回答 #29

> 赞同：-1
> 
> 时间：2017-01-08T08:04:26.110

我喜欢@Peter Lawrey 的想法，并且我将其扩展到更多限制：

```
 /**
    * Normalize string array, 
    * Appends zeros if string from the array
    * has length smaller than the maxLen.
    **/
    private String normalize(String[] split, int maxLen){
        StringBuilder sb = new StringBuilder("");
        for(String s : split) {
            for(int i = 0; i<maxLen-s.length(); i++) sb.append('0');
            sb.append(s);
        }
        return sb.toString();
    }

    /**
    * Removes trailing zeros of the form '.00.0...00'
    * (and does not remove zeros from, say, '4.1.100')
    **/
    public String removeTrailingZeros(String s){
        int i = s.length()-1;
        int k = s.length()-1;
        while(i >= 0 && (s.charAt(i) == '.' || s.charAt(i) == '0')){
          if(s.charAt(i) == '.') k = i-1;
          i--;  
        } 
        return s.substring(0,k+1);
    }

    /**
    * Compares two versions(works for alphabets too),
    * Returns 1 if v1 > v2, returns 0 if v1 == v2,
    * and returns -1 if v1 < v2.
    **/
    public int compareVersion(String v1, String v2) {

        // Uncomment below two lines if for you, say, 4.1.0 is equal to 4.1
        // v1 = removeTrailingZeros(v1);
        // v2 = removeTrailingZeros(v2);

        String[] splitv1 = v1.split("\\.");
        String[] splitv2 = v2.split("\\.");
        int maxLen = 0;
        for(String str : splitv1) maxLen = Math.max(maxLen, str.length());
        for(String str : splitv2) maxLen = Math.max(maxLen, str.length());
        int cmp = normalize(splitv1, maxLen).compareTo(normalize(splitv2, maxLen));
        return cmp > 0 ? 1 : (cmp < 0 ? -1 : 0);
    } 
```

希望它可以帮助某人。它通过了 interviewbit 和 leetcode 中的所有测试用例（需要在 compareVersion 函数中取消注释两行）。

轻松测试！

* * *

## 回答 #30

> 赞同：-1
> 
> 时间：2021-06-30T13:23:18.073

最简单的解决方案是使用字符串比较。删除不需要的点或字母，以防版本类似于 v1.0.1Beta 使用 Regex("[^0-9]") 并且您获得 1.0 和 1.0.1 等版本：

```
String ver1 = "10";
String ver2 = "101";

int res = ver1.compareTo(ver2);
System.out.println("res: "+res); 
```

如果**ver1**按字典顺序小于**ver2**，则将返回一个负数，如果相等则返回 0 或如果**ver1**大于则返回正数。

**compareTo() 方法按字典顺序比较两个字符串。**

比较基于字符串中每个字符的 Unicode 值。

如果字符串等于另一个字符串，则该方法返回 0。如果字符串小于另一个字符串（更少字符），则返回小于 0 的值；如果字符串大于另一个字符串（更多字符），则返回大于 0 的值。

* * *

## 回答 #31

> 赞同：-2
> 
> 时间：2014-11-24T16:15:14.707

```
public class VersionComparator {

    /* loop through both version strings
     * then loop through the inner string to computer the val of the int
     * for each integer read, do num*10+<integer read>
     * and stop when stumbling upon '.'
     * When '.' is encountered...
     * see if '.' is encountered for both strings
     * if it is then compare num1 and num2 
     * if num1 == num2... iterate over p1++, p2++
     * else return (num1 > num2) ? 1 : -1
     * If both the string end then compare(num1, num2) return 0, 1, -1
     * else loop through the longer string and 
     * verify if it only has trailing zeros
     * If it only has trailing zeros then return 0
     * else it is greater than the other string
     */
    public static int compareVersions(String v1, String v2) {
        int num1 = 0;
        int num2 = 0;
        int p1 = 0;
        int p2 = 0;

        while (p1 < v1.length() && p2 < v2.length()) {
            num1 = Integer.parseInt(v1.charAt(p1) + "");
            num2 = Integer.parseInt(v2.charAt(p2) + "");
            p1++;
            p2++;

            while (p1 < v1.length() && p2 < v2.length() && v1.charAt(p1) != '.' && v2.charAt(p2) != '.') {
                if (p1 < v1.length()) num1 = num1 * 10 + Integer.parseInt(v1.charAt(p1) + "");
                if (p2 < v2.length()) num2 = num2 * 10 + Integer.parseInt(v2.charAt(p2) + "");
                p1++;
                p2++;
            }

            if (p1 < v1.length() && p2 < v2.length() && v1.charAt(p1) == '.' && v2.charAt(p2) == '.') {
                if ((num1 ^ num2) == 0) {
                    p1++;
                    p2++;
                }
                else return (num1 > num2) ? 1 : -1;
            }
            else if (p1 < v1.length() && p2 < v2.length() && v1.charAt(p1) == '.') return -1;
            else if (p1 < v1.length() && p2 < v2.length() && v2.charAt(p2) == '.') return 1;
        }

        if (p1 == v1.length() && p2 == v2.length()) {
            if ((num1 ^ num2) == 0) return 0;
            else return (num1 > num2) ? 1 : -1;
        }
        else if (p1 == v1.length()) {
            if ((num1 ^ num2) == 0) {
                while (p2 < v2.length()) {
                    if (v2.charAt(p2) != '.' && v2.charAt(p2) != '0') return -1;
                    p2++;
                }
                return 0;
            }
            else return (num1 > num2) ? 1 : -1;
        }
        else {
            if ((num1 ^ num2) == 0) {
                while (p1 < v1.length()) {
                    if (v1.charAt(p1) != '.' && v1.charAt(p1) != '0') return 1;
                    p1++;
                }
                return 0;
            }
            else return (num1 > num2) ? 1 : -1;
        }
    }

    public static void main(String[] args) {
        System.out.println(compareVersions("11.23", "11.21.1.0.0.1.0") ^ 1);
        System.out.println(compareVersions("11.21.1.0.0.1.0", "11.23") ^ -1);
        System.out.println(compareVersions("11.23", "11.23.0.0.0.1.0") ^ -1);
        System.out.println(compareVersions("11.2", "11.23") ^ -1);
        System.out.println(compareVersions("11.23", "11.21.1.0.0.1.0") ^ 1);
        System.out.println(compareVersions("1.21.1.0.0.1.0", "2.23") ^ -1);
        System.out.println(compareVersions("11.23", "11.21.1.0.0.1.0") ^ 1);
        System.out.println(compareVersions("11.23.0.0.0.0.0", "11.23") ^ 0);
        System.out.println(compareVersions("11.23", "11.21.1.0.0.1.0") ^ 1);
        System.out.println(compareVersions("1.5.1.3", "1.5.1.3.0") ^ 0);
        System.out.println(compareVersions("1.5.1.4", "1.5.1.3.0") ^ 1);
        System.out.println(compareVersions("1.2.1.3", "1.5.1.3.0") ^ -1);
        System.out.println(compareVersions("1.2.1.3", "1.22.1.3.0") ^ -1);
        System.out.println(compareVersions("1.222.1.3", "1.22.1.3.0") ^ 1);
    }
} 
```

* * *

## 回答 #32

> 赞同：-2
> 
> 时间：2015-06-28T19:07:48.390

这是一个优化的实现：

```
public static final Comparator<CharSequence> VERSION_ORDER = new Comparator<CharSequence>() {

  @Override
  public int compare (CharSequence lhs, CharSequence rhs) {
    int ll = lhs.length(), rl = rhs.length(), lv = 0, rv = 0, li = 0, ri = 0;
    char c;
    do {
      lv = rv = 0;
      while (--ll >= 0) {
        c = lhs.charAt(li++);
        if (c < '0' || c > '9')
          break;
        lv = lv*10 + c - '0';
      }
      while (--rl >= 0) {
        c = rhs.charAt(ri++);
        if (c < '0' || c > '9')
          break;
        rv = rv*10 + c - '0';
      }
    } while (lv == rv && (ll >= 0 || rl >= 0));
    return lv - rv;
  }

}; 
```

结果：

```
"0.1" - "1.0" = -1
"1.0" - "1.0" = 0
"1.0" - "1.0.0" = 0
"10" - "1.0" = 9
"3.7.6" - "3.7.11" = -5
"foobar" - "1.0" = -1 
```

# php - 有效检测损坏的 jpeg 文件？

> ID：198438
> 
> 赞同：16
> 
> 时间：2008-10-13T17:56:30.417
> 
> 标签：php, jpeg, corruption

是否有一种有效的方法来检测 jpeg 文件是否损坏？

背景信息：
  解决方案需要在 php 脚本
  中工作 jpeg 文件在磁​​盘上
  手动检查是没有选择的（用户上传的数据）

我知道`imagecreatefromjpeg(string $filename);`可以做到。但是这样做的速度很慢。

有人知道更快/更有效的解决方案吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-13T18:19:47.403

在命令行中，您可以使用 jpeginfo 来确定 jpeg 文件是否正常。

> $ jpeginfo -c test.jpeg
> 
> test.jpeg 260 x 264 24bit JFIF N 15332 [OK]

从 php.ini 调用 jpeginfo 应该很简单。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-10-25T23:55:25.193

我最简单（也是最快）的解决方案：

```
 function jpeg_file_is_complete($path) {
    if (!is_resource($file = fopen($path, 'rb'))) {
        return FALSE;
    }
    // check for the existence of the EOI segment header at the end of the file
    if (0 !== fseek($file, -2, SEEK_END) || "\xFF\xD9" !== fread($file, 2)) {
        fclose($file);
        return FALSE;
    }
    fclose($file);
    return TRUE;
}

function jpeg_file_is_corrupted($path) {
    return !jpeg_file_is_complete($path);
} 
```

注意：这只会检测损坏的文件结构，但不会检测损坏的图像数据。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-05-03T20:33:27.003

仅供参考——我已经使用上面[的](https://stackoverflow.com/a/1622536/15619)[方法`jpeg_file_is_complete`](https://stackoverflow.com/a/1622536/15619)（无论如何，当我对该图像进行上述测试时，它没有检测到它已损坏。

到目前为止，使用`imagecreatefromjpeg()`工作，但不是很快。我发现 using`jpeginfo`也可以检测这些类型的损坏图像，并且比`imagecreatefromjpeg`（我在我的 PHP 中使用 运行基准测试）更快`microtime()`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-15T14:51:07.977

请尝试一下

```
<?php
$img = $_GET['img'];
$str_exec = 'jpeginfo -c /chroot/home/www/html/media/'.$img;
$result = exec($str_exec);
if(strpos($result, 'ERROR'))
{
    echo 'ERROR';
}
else
{
    echo 'OK';
}
?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-05-10T19:01:28.407

**只是一个小提示-如何获取适用于 Windows（64 位）的 jpeginfo？** 作者的 github 上没有 win32/win64 二进制文件，但您可以这样做：

1）`jpeginfo.exe`从此档案中获取： [https ://github.com/MoserMichael/cstuff/raw/master/img-archive/img-archive.zip](https://github.com/MoserMichael/cstuff/raw/master/img-archive/img-archive.zip)

2)`cygwin1.dll`从此存档中获取：ftp: [//mirror.internode.on.net/pub/cygwin/x86/release/cygwin64/cygwin64-2.6.0-1.tar.xz](ftp://mirror.internode.on.net/pub/cygwin/x86/release/cygwin64/cygwin64-2.6.0-1.tar.xz)

如果有效，请从命令行测试它：`jpeginfo --help`. 如果有信息-它工作得很好。

 `**如何测试 jpeginfo 输出？**

`jpeginfo`如果文件正常，则返回 0，但它不仅在文件不正常时返回 1，而且在发现不理解的内容时返回 1。然后它会生成这样的消息：

`Warning: unknown JFIF revision number 2.01 1280 x 720 24bit JFIF N 122550 [WARNING]`

在损坏的文件上，它返回 1 和如下消息：

`1328 x 2048 24bit JFIF N 1310080 Premature end of JPEG file [WARNING]`

因此，您可能不仅要测试返回代码，还要测试实际输出。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2010-01-22T18:15:38.433

您也可以尝试根据 MD5 生成文件哈希，并将其用作校验和，以在各个步骤中验证 JPEG 数据。例如，从文件读取之后，然后在传输之后，等等。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-04-03T02:58:25.703

解决方案：

我找到了满足我需要的完美工具：

[http://www.thomasbarker.co.uk/2011/05/29/corrupt-jpeg-checkertool-for-finding-corrupt-jpeg-image-files/](http://www.thomasbarker.co.uk/2011/05/29/corrupt-jpeg-checkertool-for-finding-corrupt-jpeg-image-files/)

递归搜索目录并找到任何损坏的 JPEGS。看起来您也可以使用任意数量的 CPU。

为我工作。

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2014-03-28T20:25:05.023

我还有一个简单的 getimagesize() 解决方案

```
if(!getimagesize($image_url)) echo 'Image is corrupt or not readable'; 
```

# c# - C# - 是否有 32 位浮点数学库？

> ID：198448
> 
> 赞同：5
> 
> 时间：2008-10-13T18:01:07.473
> 
> 标签：c#, math, floating-point

我打算用 c# 而不是 c++（使用 SlimDX）来做我的下一个项目。

所有的 directX 都使用浮点数，但是 System.Math 使用双精度数。这意味着在浮点数和双精度数之间不断转换。

所以理想情况下，我想使用浮点数编写所有代码，因为无论如何我都没有得到任何额外的精度从双精度转换为浮点数......

但是，我一直无法找到一组使用浮点数的 .net 数学函数。我当然可以用 c# 编写自己的库，但我宁愿使用已经优化的现有库等...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T18:46:24.213

XNA 提供了几个数学常数（包括 3D 专家，如 PI/2 等）和一些具有浮点精度的高级数学函数（尽管不是三角函数）。虽然这很可能不是您的选择，因为 XNA 不像 SlimDX 那样纤薄，这肯定意味着 System.Math 要么实际上缺少某些东西，要么性能损失没有那么大。根据我的经验，您实际上并没有为自己计算那么多，因为其中大部分是由几何类（矩阵、四元数、向量）或 GPU 本身处理的。

从这个角度来看，我会看看他们提供的 SlimDX。似乎矩阵、向量、四元数（甚至 16 位浮点数）等典型事物已经存在。如果您缺少一些具有浮点精度的常量，只需自己创建它们（不必每次都进行强制转换，只需在启动时进行）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-27T05:45:24.630

是的，如果这是所需的所有精度，您将通过在浮点中端到端工作来获得非常显着的性能提升。

从 CenterSpace 软件中查看[NMath库。](http://centerspace.net)整个库始终支持浮点、双精度和复杂类型。

保罗

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-03-06T06:53:21.530

回答标题中的问题：**是**的。

从**.NET Core 2.0 (.NET Standard 2.1)**开始，您可以使用内置`MathF`类来使用浮点类型来执行数学运算。

请参阅[MSDN 上](https://docs.microsoft.com/en-us/dotnet/api/system.mathf)[有关类型的文档`MathF`](https://docs.microsoft.com/en-us/dotnet/api/system.mathf)

# ruby-on-rails - 如何在 Ruby 中获取随机数

> ID：198460
> 
> 赞同：811
> 
> 时间：2008-10-13T18:07:24.043
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-4, random

如何在`0`和之间生成随机数`n`？

* * *

## 回答 #1

> 赞同：974
> 
> 时间：2008-10-13T18:10:25.520

采用[`rand(range)`](http://www.ruby-doc.org/core-2.1.3/Kernel.html#method-i-rand)

来自[Ruby 随机数](http://www.codeodor.com/index.cfm/2007/3/25/Ruby-random-numbers/1042)：

> 如果您需要一个随机整数来模拟六面骰子的掷骰，您可以使用：`1 + rand(6)`. 可以用 模拟掷骰子`2 + rand(6) + rand(6)`。
> 
> 最后，如果您只需要一个随机浮点数，只需`rand`不带参数调用即可。

* * *

正如[Marc-André Lafortune](https://stackoverflow.com/users/8279/marc-andre-lafortune)在[下面的回答中提到的（去投票）](https://stackoverflow.com/questions/198460/how-to-get-a-random-number-in-ruby/2773866#2773866)，[Ruby 1.9.2 有自己的`Random`类](http://www.ruby-lang.org/en/news/2009/07/20/ruby-1-9-2-preview-1-released/)（Marc-André 自己[帮助调试](http://redmine.ruby-lang.org/issues/show/3104)，因此该功能的[目标是 1.9.2](http://redmine.ruby-lang.org/versions/show/11)）。

例如，在这个[需要猜 10 个数字的游戏中](http://www.eggheadcafe.com/software/aspnet/35817496/random-integer-within-a-r.aspx)，您可以使用以下命令初始化它们：

```
10.times.map{ 20 + Random.rand(11) } 
#=> [26, 26, 22, 20, 30, 26, 23, 23, 25, 22] 
```

笔记：

*   [正如Marc-André Lafortune](https://stackoverflow.com/users/8279/marc-andre-lafortune)在[他的回答](https://stackoverflow.com/questions/198460/how-to-get-a-random-number-in-ruby/2773866#2773866)中（再次）详细解释的那样，使用`Random.new.rand(20..30)`(using `Random.new`) 通常不是一个好主意。

*   但是，如果您不使用`Random.new`，则[类方法`rand`](http://www.ruby-doc.org/core/classes/Random.src/M000693.html)仅采用一个`max`值，而不是 a `Range`，正如[栏杆](https://stackoverflow.com/users/66725/banister)（精力充沛地）在评论中指出的那样（并且如文档中所述[）`Random`](http://www.ruby-doc.org/core/classes/Random.html)。只有[实例方法](http://www.ruby-doc.org/core/classes/Random.src/M000688.html)可以带a `Range`，如[生成一个7位随机数](https://stackoverflow.com/questions/5722881/generate-a-random-number-with-7-digits/5723105#5723105)所示。

这就是为什么等价的`Random.new.rand(20..30)`will be `20 + Random.rand(11)`，因为`Random.rand(int)`返回“一个大于或等于零且*小于参数*的随机整数”。`20..30`包括30，我需要拿出一个0到11之间的随机数，不包括11。

* * *

## 回答 #2

> 赞同：601
> 
> 时间：2010-05-05T14:01:50.417

虽然您可以使用`rand(42-10) + 10`获取和之间的随机数`10`（`42`其中 10 包括在内，42 不包括在内），但自 Ruby 1.9.3 以来有一种更好的方法，您可以在其中调用：

```
rand(10...42) # => 13 
```

[`backports`](http://github.com/marcandre/backports)通过要求我的gem可用于所有版本的 Ruby 。

Ruby 1.9.2 还引入了`Random`该类，因此您可以创建自己的随机数生成器对象并拥有一个不错的 API：

```
r = Random.new
r.rand(10...42) # => 22
r.bytes(3) # => "rnd" 
```

该类`Random`本身充当随机生成器，因此您可以直接调用：

```
Random.rand(10...42) # => same as rand(10...42) 
```

***注意事项`Random.new`***

在大多数情况下，最简单的方法是使用`rand`or `Random.rand`。每次你想要一个随机数时创建一个新的随机生成器是一个*非常糟糕的主意*。如果这样做，您将获得初始播种算法的随机属性，与[随机生成器本身](http://en.wikipedia.org/wiki/Mersenne_twister)的属性相比，这些属性非常糟糕。

如果您使用`Random.new`，则应*尽可能少地*调用它，例如一次 as`MyApp::Random = Random.new`并在其他任何地方使用它。

有帮助的情况`Random.new`如下：

*   您正在编写 gem 并且不想干扰主程序可能依赖的`rand`/序列`Random.rand`
*   你想要单独的可重复的随机数序列（比如每个线程一个）
*   您希望能够保存和恢复可重现的随机数序列（很容易，因为`Random`可以编组对象）

* * *

## 回答 #3

> 赞同：47
> 
> 时间：2012-07-20T11:15:10.923

如果您不仅要查找数字，还要查找 hex 或 uuid，那么值得一提的是，该`SecureRandom`模块`ActiveSupport`在 1.9.2+ 中找到了 ruby​​ 核心。所以不需要一个完整的框架：

```
require 'securerandom'

p SecureRandom.random_number(100) #=> 15
p SecureRandom.random_number(100) #=> 88

p SecureRandom.random_number #=> 0.596506046187744
p SecureRandom.random_number #=> 0.350621695741409

p SecureRandom.hex #=> "eb693ec8252cd630102fd0d0fb7c3485" 
```

它记录在这里：[Ruby 1.9.3 - 模块：SecureRandom (lib/securerandom.rb)](http://rubydoc.info/stdlib/securerandom/1.9.3/SecureRandom)

* * *

## 回答 #4

> 赞同：38
> 
> 时间：2012-12-12T20:12:22.187

您可以使用该方法生成一个随机数`rand`。传递给`rand`方法的参数应该是 an`integer`或 a `range`，并返回范围内对应的随机数：

```
rand(9)       # this generates a number between 0 to 8
rand(0 .. 9)  # this generates a number between 0 to 9
rand(1 .. 50) # this generates a number between 1 to 50
#rand(m .. n) # m is the start of the number range, n is the end of number range 
```

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2008-10-13T18:10:10.107

嗯，我想通了。显然有一个名为 rand 的内置 (?) 函数：

```
rand(n + 1) 
```

如果有人回答更详细的答案，我会将其标记为正确答案。

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2012-05-23T06:02:22.813

那这个呢？

```
n = 3
(0..n).to_a.sample 
```

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2015-02-19T18:53:15.537

最简单的问题答案：

```
rand(0..n) 
```

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2017-01-16T11:58:57.663

您可以简单地使用`random_number`.

如果给定一个正整数作为 n，则`random_number`返回一个整数：0 <= `random_number`< n。

像这样使用它：

```
any_number = SecureRandom.random_number(100) 
```

输出将是 0 到 100 之间的任何数字。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2012-11-15T23:31:45.780

```
rand(6)    #=> gives a random number between 0 and 6 inclusively 
rand(1..6) #=> gives a random number between 1 and 6 inclusively 
```

请注意，范围选项仅适用于较新的（我相信是 1.9+）版本的 ruby​​。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2016-04-29T10:32:32.767

范围 = 10..50

**兰特（范围）**

或者

**range.to_a.sample**

或者

**range.to_a.shuffle**（这将打乱整个数组，您可以按第一个或最后一个或从该数组中的任何一个随机数来选择随机数）

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2015-08-22T23:09:00.703

你可以做 rand(range)

```
x = rand(1..5) 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2013-12-24T17:38:49.737

此链接将对此有所帮助；

[http://ruby-doc.org/core-1.9.3/Random.html](http://ruby-doc.org/core-1.9.3/Random.html)

**下面对红宝石中的随机数有一些更清楚的说明；**

生成一个从 0 到 10 的整数

```
puts (rand() * 10).to_i 
```

以更易读的方式生成一个从 0 到 10 的数字

```
puts rand(10) 
```

生成一个从 10 到 15 的数字，包括 15

```
puts rand(10..15) 
```

**非随机随机数**

每次运行程序时生成相同的数字序列

```
srand(5) 
```

生成 10 个随机数

```
puts (0..10).map{rand(0..10)} 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2017-02-16T10:04:47.597

在 ruby​​ 中获取随机数的简单方法是，

```
def random    
  (1..10).to_a.sample.to_s
end 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2016-03-11T13:59:43.713

也许它对你有帮助。我在我的应用程序中使用它

```
https://github.com/rubyworks/facets
class String

  # Create a random String of given length, using given character set
  #
  # Character set is an Array which can contain Ranges, Arrays, Characters
  #
  # Examples
  #
  #     String.random
  #     => "D9DxFIaqR3dr8Ct1AfmFxHxqGsmA4Oz3"
  #
  #     String.random(10)
  #     => "t8BIna341S"
  #
  #     String.random(10, ['a'..'z'])
  #     => "nstpvixfri"
  #
  #     String.random(10, ['0'..'9'] )
  #     => "0982541042"
  #
  #     String.random(10, ['0'..'9','A'..'F'] )
  #     => "3EBF48AD3D"
  #
  #     BASE64_CHAR_SET =  ["A".."Z", "a".."z", "0".."9", '_', '-']
  #     String.random(10, BASE64_CHAR_SET)
  #     => "xM_1t3qcNn"
  #
  #     SPECIAL_CHARS = ["!", "@", "#", "$", "%", "^", "&", "*", "(", ")", "-", "_", "=", "+", "|", "/", "?", ".", ",", ";", ":", "~", "`", "[", "]", "{", "}", "<", ">"]
  #     BASE91_CHAR_SET =  ["A".."Z", "a".."z", "0".."9", SPECIAL_CHARS]
  #     String.random(10, BASE91_CHAR_SET)
  #      => "S(Z]z,J{v;"
  #
  # CREDIT: Tilo Sloboda
  #
  # SEE: https://gist.github.com/tilo/3ee8d94871d30416feba
  #
  # TODO: Move to random.rb in standard library?

  def self.random(len=32, character_set = ["A".."Z", "a".."z", "0".."9"])
    chars = character_set.map{|x| x.is_a?(Range) ? x.to_a : x }.flatten
    Array.new(len){ chars.sample }.join
  end

end 
```

[https://github.com/rubyworks/facets/blob/5569b03b4c6fd25897444a266ffe25872284be2b/lib/core/facets/string/random.rb](https://github.com/rubyworks/facets/blob/5569b03b4c6fd25897444a266ffe25872284be2b/lib/core/facets/string/random.rb)

这对我来说可以

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2016-03-11T14:31:35.207

这个怎么样？

```
num = Random.new
num.rand(1..n) 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-10-13T18:15:52.513

不要忘记先用*srand()*播种 RNG 。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2015-01-23T17:42:50.217

尝试`array#shuffle`随机化方法

```
array = (1..10).to_a
array.shuffle.first 
```

# computer-science - 是否有任何程序可以绘制和测试状态机、图灵机等？

> ID：198461
> 
> 赞同：5
> 
> 时间：2008-10-13T18:07:57.553
> 
> 标签：computer-science, state-machine, finite-automata

当我感恩节后回到学校时，我将参加 CS 理论课程，涵盖确定性和非确定性有限状态机、图灵机、下推自动机和其他一些内容等主题。但是，我还没有找到一个好的应用程序可以生成它们的可视化表示以及测试它们的工作方式（通过/失败等）。到目前为止我发现的最好的是[jFlap](http://www.jflap.org/)，我发现它相当尴尬。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-13T18:22:38.413

我在大学时使用的是[JFlap](http://www.cs.duke.edu/csed/jflap/)。我没有发现它使用起来很尴尬，但从那时起它看起来可能已经改变了。对不起，我没有比这更好的答案了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-13T18:25:19.187

我的一个朋友用乳胶画了它们。我总是喜欢铅笔和纸。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-13T18:50:30.197

我现在就在这样的班级。我发现纸和铅笔就足够了。我不能肯定地说，但我认为你不会被要求在一张纸上绘制太复杂而无法理解的自动机。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-13T19:02:37.427

我用 UML 画了它们，并提交了 StarUML jpeg 导出一段时间。

然后我编写了一个 PHP 脚本将它们转换为 DOT 格式，并使用 Graphviz 来获得漂亮的机器。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-13T19:27:11.323

Simulink 状态流。

大量的矫枉过正，当然。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-13T18:37:46.713

[IAR visualSTATE](http://www.iar.com/website1/1.0.1.0/371/1/index.php)可能很有趣。

# html - GET 或 POST 是否比另一个更安全？

> ID：198462
> 
> 赞同：299
> 
> 时间：2008-10-13T18:08:01.937
> 
> 标签：html, http, security, post, get

在比较 HTTP GET 和 HTTP POST 时，从安全角度来看有什么区别？其中一种选择本质上是否比另一种更安全？如果是这样，为什么？

我意识到 POST 不会公开 URL 上的信息，但是这是否有任何真正的价值，或者它只是通过默默无闻的安全性？当担心安全性时，我是否有理由更喜欢 POST？

**编辑：**
通过 HTTPS，POST 数据被编码，但是 URL 可以被第三方嗅探吗？此外，我正在处理 JSP；在使用 JSP 或类似框架时，是否可以说最佳做法是完全避免将敏感数据放在 POST 或 GET 中，而是使用服务器端代码来处理敏感信息？

* * *

## 回答 #1

> 赞同：440
> 
> 时间：2009-11-16T19:43:20.957

GET 请求的安全性略低于 POST 请求。两者都不能单独提供真正的“安全”；使用 POST 请求*不会*神奇地使您的网站在相当大的程度上防止恶意攻击。但是，使用 GET 请求*会使*原本安全的应用程序变得不安全。

*您“不得使用 GET 请求进行更改”的口头禅仍然非常有效，但这与恶意*行为无关。登录表单是最容易使用错误请求类型发送的表单。

### 搜索蜘蛛和网络加速器

这是您应该使用 POST 请求来更改数据的真正原因。搜索蜘蛛会跟踪您网站上的每个链接，但不会提交他们找到的随机表单。

Web 加速器比搜索蜘蛛更糟糕，因为它们在客户端机器上运行，并“点击”*登录用户上下文中的*所有链接。因此，使用 GET 请求删除内容的应用程序，即使它需要管理员，也会很乐意服从（非恶意！）网络加速器的命令并[删除它看到的所有内容](https://web.archive.org/web/20090126045517/http://radar.oreilly.com/archives/2005/05/google-web-acce-1.html)。

### 混乱的副手攻击

[无论您使用 GET 还是 POST 请求，都可能](http://haacked.com/archive/2009/04/02/anatomy-of-csrf-attack.aspx)发生[混淆代理攻击](http://en.wikipedia.org/wiki/Confused_deputy_problem)（其中代理是浏览器）。

在攻击者控制的网站上，GET 和 POST[同样容易提交](http://pentestmonkey.net/blog/csrf-xml-post-request) [，无需用户交互](http://www.javascript-coder.com/javascript-form/javascript-form-submit.phtml)。

POST 不太容易受到影响的唯一情况是，许多不受攻击者控制的网站（例如，第三方论坛）允许嵌入任意图像（允许攻击者注入任意 GET 请求），但阻止所有注入任意 POST 请求的方法，无论是自动还是手动。

有人可能会争辩说，网络加速器是混淆代理攻击的一个例子，但这只是定义问题。如果有的话，恶意攻击者无法控制这一点，因此即使副手*感到*困惑，也几乎不是*攻击。*

 *### 代理日志

代理服务器可能会完整记录 GET URL，而不剥离查询字符串。POST 请求参数通常不会被记录。在这两种情况下都不太可能记录 Cookie。[（例子）](http://www.linuxquestions.org/questions/linux-server-73/sample-squid-proxy-log-files-837345/)

这是支持 POST 的一个非常弱的论点。首先，可以完整记录未加密的流量；恶意代理已经拥有它需要的一切。其次，请求参数对攻击者的用途有限：他们真正需要的是 cookie，所以如果他们只有代理日志，他们不太可能攻击 GET 或 POST URL。

登录请求有一个例外：这些请求往往包含用户的密码。将其保存在代理日志中会打开一个在 POST 情况下不存在的攻击向量。但是，无论如何，通过普通 HTTP 登录本质上是不安全的。

### 代理缓存

缓存代理可能会保留 GET 响应，但不会保留 POST 响应。话虽如此，与将 URL 转换为 POST 处理程序相比，GET 响应可以变得不可缓存。

### HTTP“推荐人”

如果用户要从响应 GET 请求而提供的页面导航到第三方网站，则该第三方网站将看到所有 GET 请求参数。

属于“向第三方显示请求参数”的类别，其严重程度取决于这些参数中存在的内容。POST 请求自然不受此影响，但是为了利用 GET 请求，黑客需要将指向他们自己网站的链接插入到服务器的响应中。

### 浏览器历史

这与“代理日志”参数非常相似：GET 请求与其参数一起存储在浏览器历史记录中。如果攻击者可以物理访问机器，他们可以轻松获得这些。

### 浏览器刷新动作

一旦用户点击“刷新”，浏览器就会重试 GET 请求。关机后恢复选项卡时可能会这样做。因此，任何行动（例如，付款）都将在没有警告的情况下重复。

浏览器不会在没有警告的情况下重试 POST 请求。

这是仅使用 POST 请求来更改数据的一个很好的理由，但与恶意行为无关，因此与安全性无关。

## 所以我该怎么做？

*   仅使用 POST 请求来更改数据，主要是出于与安全无关的原因。
*   仅对登录表单使用 POST 请求；否则会引入攻击向量。
*   如果您的站点执行敏感操作，那么您确实需要知道他们在做什么的人，因为这不能在一个单一的答案中涵盖。您需要使用 HTTPS、HSTS、CSP、缓解 SQL 注入、[脚本注入 (XSS)](http://en.wikipedia.org/wiki/Cross-site_scripting)、[CSRF](http://en.wikipedia.org/wiki/Cross-site_request_forgery)以及可能特定于您的平台的大量其他东西（例如各种框架中的批量分配漏洞：[ASP.NET MVC](https://web.archive.org/web/20120503215142/http://freshbrewedcode.com/joshbush/2012/03/05/mass-assignment-aspnet-mvc/)，[Ruby on Rails](http://www.infoq.com/news/2012/03/GitHub-Compromised)等）。没有一件事可以区分“安全”（不可利用）和“不安全”。

* * *

> 通过 HTTPS，POST 数据被编码，但是 URL 可以被第三方嗅探吗？

不，它们不能被嗅探。但 URL 将存储在浏览器历史记录中。

> 公平地说，最好的做法是避免将敏感数据完全放在 POST 或 GET 中，而是使用服务器端代码来处理敏感信息吗？

取决于它的敏感程度，或者更具体地说，以何种方式敏感。显然客户会看到它。任何可以物理访问客户计算机的人都会看到它。客户可以在将其发回给您时对其进行欺骗。如果这些很重要，那么可以，将敏感数据保留在服务器上，不要让它离开。

* * *

## 回答 #2

> 赞同：216
> 
> 时间：2008-10-13T18:11:03.693

就安全性而言，它们本质上是相同的。虽然 POST 确实不会通过 URL 公开信息，但它在客户端和服务器之间的实际网络通信中公开的信息与 GET 一样多。如果您需要传递敏感信息，您的第一道防线将是使用安全 HTTP 传递它。

GET 或查询字符串帖子非常适合为特定项目添加书签或协助搜索引擎优化和索引项目所需的信息。

POST 适用于用于提交一次性数据的标准表单。我不会使用 GET 来发布实际表单，除非可能在您希望允许用户将查询保存在书签中的搜索表单中，或者类似的东西。

* * *

## 回答 #3

> 赞同：181
> 
> 时间：2011-01-18T15:20:37.200

您没有提供更高的安全性，因为通过 HTTP POST 发送的变量比通过 HTTP GET 发送的变量要高。

[HTTP/1.1 为我们提供了一堆发送请求的方法](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html)：

*   选项
*   得到
*   头
*   邮政
*   放
*   删除
*   痕迹
*   连接

## 假设您有以下使用 GET 的 HTML 文档：

```
<html>
<body>
<form action="http://example.com" method="get">
    User: <input type="text" name="username" /><br/>
    Password: <input type="password" name="password" /><br/>
    <input type="hidden" name="extra" value="lolcatz" />
    <input type="submit"/>
</form>
</body>
</html> 
```

你的浏览器问什么？它问这个：

```
 GET /?username=swordfish&password=hunter2&extra=lolcatz HTTP/1.1
 Host: example.com
 Connection: keep-alive
 Accept: application/xml,application/xhtml+xml,text/html;q=0.9,text/ [...truncated]
 User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US) [...truncated]
 Accept-Encoding: gzip,deflate,sdch
 Accept-Language: en-US,en;q=0.8
 Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3 
```

## 现在假设我们将请求方法更改为 POST：

```
 POST / HTTP/1.1
 Host: example.com
 Connection: keep-alive
 Content-Length: 49
 Cache-Control: max-age=0
 Origin: null
 Content-Type: application/x-www-form-urlencoded
 Accept: application/xml,application/xhtml+xml,text/ [...truncated]
 User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.0; [...truncated]
 Accept-Encoding: gzip,deflate,sdch
 Accept-Language: en-US,en;q=0.8
 Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3

 username=swordfish&password=hunter2&extra=lolcatz 
```

**这两个**HTTP 请求都是：

*   未加密
*   包含在两个示例中
*   可以被窃听并受到 MITM 攻击。
*   很容易被第三方和脚本机器人复制。

许多**浏览器**不支持除 POST/GET 之外的 HTTP 方法。

许多**浏览器**行为存储页面地址，但这并不意味着您可以忽略任何其他问题。

所以具体来说：

> 一个本质上比另一个更安全吗？我意识到 POST 不会公开 URL 上的信息，但其中是否有任何真正的价值，或者它只是通过默默无闻的安全性？这里的最佳做法是什么？

这是正确的，因为你用来说 HTTP 的软件倾向于使用一种方法而不是另一种方法来存储请求变量，这只会阻止某人查看你的浏览器历史记录或来自 10 岁认为他们理解 h4x0r1ng 的其他一些天真的攻击，或检查您的历史存储的脚本。如果您有一个可以检查您的历史存储的脚本，那么您也可以轻松地拥有一个检查您的网络流量的脚本，所以通过默默无闻的整个安全性只是为脚本小子和嫉妒的女朋友提供了默默无闻。

> 通过 https，POST 数据被编码，但 url 可以被第三方嗅探吗？

以下是 SSL 的工作原理。还记得我上面发送的那两个请求吗？这是它们在 SSL 中的样子：（我将页面更改为[https://encrypted.google.com/](https://encrypted.google.com/)因为 example.com 对 SSL 没有响应）。

## 通过 SSL 发布

```
q5XQP%RWCd2u#o/T9oiOyR2_YO?yo/3#tR_G7 2_RO8w?FoaObi)
oXpB_y?oO4q?`2o?O4G5D12Aovo?C@?/P/oOEQC5v?vai /%0Odo
QVw#6eoGXBF_o?/u0_F!_1a0A?Q b%TFyS@Or1SR/O/o/_@5o&_o
9q1/?q$7yOAXOD5sc$H`BECo1w/`4?)f!%geOOF/!/#Of_f&AEI#
yvv/wu_b5?/o d9O?VOVOFHwRO/pO/OSv_/8/9o6b0FGOH61O?ti
/i7b?!_o8u%RS/Doai%/Be/d4$0sv_%YD2_/EOAO/C?vv/%X!T?R
_o_2yoBP)orw7H_yQsXOhoVUo49itare#cA?/c)I7R?YCsg ??c'
(_!(0u)o4eIis/S8Oo8_BDueC?1uUO%ooOI_o8WaoO/ x?B?oO@&
Pw?os9Od!c?/$3bWWeIrd_?( `P_C?7_g5O(ob(go?&/ooRxR'u/
T/yO3dS&??hIOB/?/OI?$oH2_?c_?OsD//0/_s%r 
```

## 通过 SSL 获取

```
rV/O8ow1pc`?058/8OS_Qy/$7oSsU'qoo#vCbOO`vt?yFo_?EYif)
43`I/WOP_8oH0%3OqP_h/cBO&24?'?o_4`scooPSOVWYSV?H?pV!i
?78cU!_b5h'/b2coWD?/43Tu?153pI/9?R8!_Od"(//O_a#t8x?__
bb3D?05Dh/PrS6_/&5p@V f $)/xvxfgO'q@y&e&S0rB3D/Y_/fO?
_'woRbOV?_!yxSOdwo1G1?8d_p?4fo81VS3sAOvO/Db/br)f4fOxt
_Qs3EO/?2O/TOo_8p82FOt/hO?X_P3o"OVQO_?Ww_dr"'DxHwo//P
oEfGtt/_o)5RgoGqui&AXEq/oXv&//?%/6_?/x_OTgOEE%v (u(?/
t7DX1O8oD?fVObiooi'8)so?o??`o"FyVOByY_ Supo? /'i?Oi"4
tr'9/o_7too7q?c2Pv 
```

（注意：我将 HEX 转换为 ASCII，其中一些显然不应该显示）

整个 HTTP 会话都是加密的，唯一可见的通信部分是在 TCP/IP 层（即 IP 地址和连接端口信息）。

### 所以让我在这里做一个大胆的声明。您的网站并没有通过一种 HTTP 方法提供比另一种更高的安全性，全世界的黑客和新手都知道如何执行我刚刚在这里演示的操作。如果您想要安全，请使用 SSL。浏览器倾向于存储历史记录，RFC2616 9.1.1 建议不要使用 GET 来执行操作，但认为 POST 提供安全性是完全错误的。

POST 唯一的安全措施是什么？防止您嫉妒的前任翻阅您的浏览器历史记录。就是这样。世界其他地方登录到您的帐户嘲笑您。

为了进一步说明为什么 POST 不安全，Facebook 到处使用 POST 请求，那么[FireSheep 之](http://codebutler.com/firesheep)类的软件怎么会存在呢？

请注意，即使您使用 HTTPS 并且您的站点不包含[XSS](https://en.wikipedia.org/wiki/Cross-site_scripting)漏洞，您也可能会受到[CSRF攻击。](https://en.wikipedia.org/wiki/Cross-site_request_forgery)简而言之，这种攻击场景假定受害者（您的站点或服务的用户）已经登录并拥有适当的 cookie，然后请求受害者的浏览器对您的（假定是安全的）站点执行某些操作。如果您没有针对 CSRF 的保护，攻击者仍然可以使用受害者凭据执行操作。攻击者看不到服务器响应，因为它会被传输到受害者的浏览器，但损坏通常在那个时候已经造成。

* * *

## 回答 #4

> 赞同：35
> 
> 时间：2008-10-13T18:11:20.650

**没有额外的安全性。**

发布数据不会显示在历史记录和/或日志文件中，但如果数据应该保持安全，则需要 SSL。
否则，任何嗅探电线的人都可以读取您的数据。

* * *

## 回答 #5

> 赞同：30
> 
> 时间：2008-10-13T18:16:19.940

即使`POST`与 , 对于登录表单或任何其他具有相对敏感信息的表单相比没有真正的安全优势`GET`，请确保您使用`POST`的是：

1.  ed的信息`POST`不会保存在用户的历史记录中。
2.  表单中发送的敏感信息（密码等）稍后在 URL 栏中将不可见（使用`GET`，将在历史记录和 URL 栏中可见）。

此外，`GET`具有数据的理论限制。`POST`没有。

对于真正的敏感信息，请务必使用`SSL`( `HTTPS`)

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2008-10-13T18:37:44.123

GET 和 POST 都不比另一个“更安全”，就像传真和电话都不比另一个“更安全”一样。提供了各种 HTTP 方法，以便您可以选择最适合您要解决的问题的方法。GET 更适合[幂等](http://en.wikipedia.org/wiki/Idempotence)查询，而 POST 更适合“动作”查询，但如果您不了解您正在维护的应用程序的安全架构，您可以很容易地使用它们中的任何一个。

最好阅读第 9 章： [HTTP/1.1 RFC的](http://www.w3.org/Protocols/rfc2616/rfc2616.html)[方法定义](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html)，以全面了解 GET 和 POST 最初设想的含义。

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2008-10-13T20:05:23.370

GET 和 POST 之间的区别不应该从安全性的角度来看待，而应该从它们对服务器的意图来看。GET 永远不应该改变服务器上的数据——至少除了日志之外——但是 POST 可以创建新的资源。

好的代理不会缓存 POST 数据，但它们可能会缓存来自 URL 的 GET 数据，因此您可以说 POST 应该更安全。但 POST 数据仍可用于表现不佳的代理。

正如许多答案中提到的，唯一确定的赌注是通过 SSL。

但请确保 GET 方法不会提交任何更改，例如删除数据库行等。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2008-10-13T19:05:06.003

这与安全无关，但是...**浏览器不缓存 POST 请求**。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2008-10-13T18:11:50.447

我通常的选择方法是这样的：

*   **获取**稍后将通过 URL **检索**的项目
    *   例如，搜索应该是 GET，这样您就可以稍后执行 search.php?s=XXX
*   **POST**将要**发送的项目**
    *   这与 GET*相比相对*不可见并且更难发送，但仍然可以通过 cURL 发送数据。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2008-10-13T20:11:32.843

两者都没有神奇地为请求提供安全性，但是 GET 意味着一些通常会阻止它安全的副作用。

GET URL 显示在浏览器历史记录和网络服务器日志中。出于这个原因，它们不应该用于登录表单和信用卡号等内容。

然而，仅仅发布这些数据也不能保证它的安全。为此，您需要 SSL。当通过 HTTP 使用时，GET 和 POST 都通过线路以明文形式发送数据。

POST 数据还有其他充分的理由——比如能够提交无限量的数据，或者对临时用户隐藏参数。

缺点是用户不能为通过 POST 发送的查询结果添加书签。为此，您需要 GET。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2011-12-22T09:26:20.820

考虑这种情况：一个草率的 API 接受 GET 请求，例如：

```
http://www.example.com/api?apikey=abcdef123456&action=deleteCategory&id=1 
```

在某些设置中，当您请求此 URL 时，如果存在有关请求的错误/警告，则整行都会记录在日志文件中。更糟糕的是：如果您忘记禁用生产服务器中的错误消息，这些信息只会在浏览器中以纯文本形式显示！现在您刚刚将您的 API 密钥提供给了所有人。

不幸的是，有真正的 API 以这种方式工作。

我不喜欢在日志中包含一些敏感信息或在浏览器中显示它们的想法。POST 和 GET 是不一样的。在适当的地方使用每个。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-10-13T18:10:01.713

更改 POST 请求更难（它比编辑查询字符串需要更多的努力）。**编辑：**换句话说，它只是默默无闻的安全，几乎没有。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-08-19T04:36:35.920

1.  安全性作为传输中数据的安全性：POST 和 GET 之间没有区别。

2.  安全作为计算机上数据的安全：POST 更安全（没有 URL 历史记录）

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2012-04-17T20:32:28.943

除非您定义要保护的是什么，否则安全性的概念是没有意义的。

如果您想保护存储的浏览器历史记录、某些类型的日志记录以及查看您的 URL 的人，那么 POST 更安全。

如果您想防止有人嗅探您的网络活动，那么没有区别。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2019-05-14T15:53:18.053

免责声明：以下几点仅适用于 API 调用，不适用于网站 URL。

**网络安全**：您必须使用 HTTPS。在这种情况下，GET 和 POST 同样安全。

**浏览器历史记录**：对于前端应用程序，如 Angular JS、React JS 等 API 调用是前端进行的 AJAX 调用。这些不会成为浏览器历史记录的一部分。因此，POST 和 GET 同样安全。

**服务器端日志**：通过使用数据屏蔽和访问日志格式的写入集，可以隐藏请求 URL 中的所有或仅敏感数据。

**浏览器控制台中的数据可见性：**对于有恶意的人来说，查看 POST 数据和查看 GET 数据几乎相同。

因此，通过正确的日志记录实践，GET API 与 POST API 一样安全。随处跟随 POST 会强制 API 定义不佳，应避免使用。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-10-13T18:19:05.080

许多人采用一种约定（Ross 提到），GET 请求只检索数据，不修改服务器上的任何数据，而 POST 请求用于所有数据修改。虽然其中一个本身并不比另一个更安全，但如果您*确实*遵循此约定，则可以应用横切安全逻辑（例如，只有拥有帐户的人才能修改数据，因此拒绝未经身份验证的 POST）。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-10-14T19:19:05.740

我不打算重复所有其他答案，但有一个方面我还没有看到 - 它是数据消失的故事。我不知道在哪里可以找到它，但是...

基本上它是关于一个网络应用程序，每隔几个晚上就会神秘地丢失所有数据，没有人知道为什么。检查日志后发现该网站是由谷歌或其他任意蜘蛛发现的，它很高兴地获取（阅读：GOT）它在网站上找到的所有链接 - 包括“删除此条目”和“你确定吗？” 链接。

实际上-已经提到了其中的一部分。这就是“不要在 GET 上更改数据，而只能在 POST 上更改数据”背后的故事。爬虫会很高兴地遵循 GET，而不是 POST。即使是 robots.txt 也无助于防止行为不端的爬虫。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2011-01-17T23:05:40.930

您还应该注意，如果您的网站包含指向您无法使用 GET 控制的其他外部网站的链接，则当他们按下您网站上的链接时，会将这些数据放在外部网站的引用标题中。因此，通过 GET 方法传输登录数据始终是一个大问题。因为这可能会暴露登录凭据，以便通过检查日志或查看 Google 分析（或类似内容）轻松访问。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2015-11-18T14:22:04.777

RFC7231：

" URI 旨在共享，而不是安全的，即使它们标识了安全资源。URI 通常显示在显示器上，在打印页面时添加到模板中，并存储在各种不受保护的书签列表中。因此，包含URI 中敏感的、可识别个人身份的或有披露风险的信息。

服务的作者应该避免使用基于 GET 的表单来提交敏感数据，因为这些数据将被放置在请求目标中。许多现有的服务器、代理和用户代理在第三方可能看到的地方记录或显示请求目标。此类服务应该改用基于 POST 的表单提交。”

该 RFC 明确指出不应使用 GET 提交敏感数据。由于这句话，一些实现者可能不会以同样的谨慎处理从 GET 请求的查询部分获得的数据。我自己正在制定一个协议，以确保数据的完整性。根据这个规范，我不应该保证 GET 数据的完整性（我会这样做，因为没有人遵守这些规范）

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2016-03-05T11:23:05.963

正如之前有人所说，HTTPS 带来了安全性。

但是，POST 比 GET 更安全一点，因为 GET 可以存储在历史记录中。

但更可悲的是，有时 POST 或 GET 的选择并不取决于开发人员。例如，超链接始终通过 GET 发送（除非使用 javascript 将其转换为发布表单）。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-10-13T18:17:48.377

GET 对任何人都是可见的（甚至是你现在肩上的那个）并且保存在缓存中，因此使用 post 的安全性较低，顺便说一句，没有一些加密例程的 post 不确定，为了一点安全性，你必须使用 SSL（ https)

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2011-02-26T09:33:41.620

不同之处在于 GET 发送数据打开和 POST 隐藏（在 http-header 中）。

因此 get 更适合非安全数据，例如 Google 中的查询字符串。永远不能通过 GET 发送 Auth-data - 所以在这里使用 POST。当然，整个主题要复杂一些。如果您想了解更多信息，请阅读[这篇文章](http://geekroom.de/entwicklung/webentwickler-get-oder-post/)（德语）。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2011-04-26T23:45:59.813

**POST 的安全性较差的**一个原因是 GET默认记录，参数和所有数据几乎普遍由您的网络服务器记录。

[POST](https://stackoverflow.com/questions/989967/best-way-to-log-post-data-in-apache)则*相反*，它几乎普遍**没有记录**，导致很难发现攻击者活动。

我不赞成“它太大”的论点，这没有理由不记录*任何东西*，至少 1KB，对于人们识别攻击者在一个弱入口点工作直到它弹出，然后 POST 确实有很大帮助通过启用任何基于 HTTP 的后门来静默传递无限量的数据，这是一种双重破坏。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2013-08-02T15:28:18.453

最近发布[了一个攻击](http://breachattack.com/)，它允许中间人泄露压缩的 HTTPS 请求的请求正文。因为请求标头和 URL 没有被 HTTP 压缩，所以 GET 请求可以更好地抵御这种特定的攻击。

[在某些模式下](http://en.wikipedia.org/wiki/CRIME_%28security_exploit%29)GET 请求也容易受到攻击，SPDY 压缩请求标头，TLS 还提供可选（很少使用）压缩。在这些情况下，攻击更容易预防（浏览器供应商已经提供了修复）。HTTP 级别压缩是一个更基本的功能，供应商不太可能禁用它。

这只是一个示例，显示了 GET 比 POST 更安全的场景，但我认为从这种攻击原因选择 GET 而不是 POST 不是一个好主意。攻击非常复杂，需要非平凡的先决条件（攻击者需要能够控制部分请求内容）。在攻击可能有害的情况下，最好禁用 HTTP 压缩。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2021-02-15T17:53:30.837

除非使用 https，否则没有安全性 - 使用 https，GET 和 POST 之间的传输安全性相同。

但是一个重要的方面是客户端和服务器在记住请求时的区别。在考虑使用 GET 或 POST 登录时，记住这一点非常重要。

使用 POST，密码由服务器应用程序处理然后丢弃，因为一个好的设计不会在数据库中存储密码 - 只有加密安全的哈希值。

但是使用 GET，服务器日志最终会包含带有查询参数的请求。因此，无论数据库中的密码哈希有多好，服务器日志仍将包含明文密码。除非文件系统被加密，否则即使在日志文件被删除后，服务器磁盘也会包含这些密码。

The same problem happens when using access tokens as query parameters. And this is also a reason why it is meaningful to consider supplying any access token in the HTTP header data - such as by using a bearer token in the Authorization header.

The server logs are often the weakest part of a web service, allowing an attacker to elevate their access rights from leaked information.

* * *

## 回答 #26

> 赞同：-3
> 
> 时间：2012-02-02T17:23:14.027

这是一篇旧帖子，但我想反对一些答案。如果您要传输敏感数据，则需要使用 SSL。如果您使用带有 GET 参数的 SSL（例如 ?userid=123），该数据将以纯文本形式发送！如果您使用 POST 发送，这些值会被放入消息的加密正文中，因此对于大多数 MITM 攻击来说是不可读的。

最大的区别是数据的传递位置。只有在将数据放在 URL 中时才有意义，它不能被加密，否则您将无法路由到服务器，因为只有您可以读取 URL。这就是 GET 的工作方式。

简而言之，您可以通过 SSL 在 POST 中安全地传输数据，但无论是否使用 SSL，您都无法使用 GET 来做到这一点。

* * *

## 回答 #27

> 赞同：-3
> 
> 时间：2012-10-19T07:21:57.793

甚至 POST 也接受 GET 请求。假设您有一个包含 user.name 和 user.passwd 等输入的表单，它们应该支持用户名和密码。如果我们简单地添加一个?user.name="my user&user.passwd="my password"，那么请求将被“绕过登录页面”接受。

一个解决方案是在服务器端实现过滤器（java 过滤器作为 e）并检测没有字符串查询作为 GET 参数传递。

* * *

## 回答 #28

> 赞同：-5
> 
> 时间：2019-12-01T09:41:03.237

Post 与 SSL 一起安装是最安全的，因为它在消息正文中传输。

但是所有这些方法都是不安全的，因为它在其下面使用的 7 位协议可以通过擒纵装置破解。即使通过 4 级 Web 应用程序防火墙。

套接字也不能保证......即使它在某些方面更安全。

# python - 获取 CSV 读取器/写入器对象使用的文件对象

> ID：198465
> 
> 赞同：2
> 
> 时间：2008-10-13T18:09:06.380
> 
> 标签：python, csv

实例化后，有什么方法可以访问 CSV 写入器/读取器对象使用的文件对象？我打开了 csv 模块，看来它的比赛是内置的。我还尝试将文件对象设置为属性，但出现以下错误：

```
AttributeError: '_csv.writer' object has no attribute 'fileobj' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-13T18:33:54.817

`csv.writer`是一个“内置”功能。也就是说，它是用编译后的 C 代码而不是 Python 编写的。所以它的内部变量不能从 Python 代码中访问。

话虽如此，我不确定您**为什么**需要检查 csv.writer 对象以找出文件对象。该对象是在创建对象时指定的：

```
w = csv.writer(fileobj, dialect, ...) 
```

因此，如果您以后需要访问该对象，只需将其保存在另一个变量中即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-14T05:40:53.253

据我所知，一旦将文件对象放入 csv 对象，就没有直接的方法可以将其取出。我的方法可能是对您正在使用的 csv 编写器和读取器进行子类化，以便他们可以随身携带这些数据。当然，这假设能够直接访问工厂函数创建的类的类型（除其他外）。

# visual-studio-2008 - 如何为 Visual Studio 2008 设置默认的源代码管理插件？

> ID：198477
> 
> 赞同：3
> 
> 时间：2008-10-13T18:11:29.387
> 
> 标签：visual-studio-2008, version-control, tfs, visual-foxpro, foxpro

我们最近安装了 Team Foundation Server 2008，我们将它用于 Visual Studio 2008 代码和我们仍在迁移到 .Net 的 Visual FoxPro 9 代码。我必须安装 TFS MSSCCI 提供程序才能从 VFP9 IDE 获得连接。这工作正常，但 Visual Studio 现在似乎对使用哪个源代码控制插件感到困惑，并不断恢复到 TFS MSSCCI 提供程序，而不是随 Team Explorer 一起安装的“Visual Studio Team Foundation Server”插件。当插件更改时，我在尝试从 TFS 获取/签入代码时遇到错误。如何让 Visual Studio 将 Team Explorer 插件作为我的默认插件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-16T10:26:53.677

事实证明，在从 VSS 到 TFS 的迁移过程中，源代码控制绑定没有被转换。重新绑定解决方案解决了问题。

所以，问题真的不在于 VS 没有保留我的默认选择。它只是根据我试图打开的解决方案文件上的绑定更改源代码控制插件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T18:21:28.510

您是否尝试过将 VS 2008 使用的源代码控制插件切换到 TFS？您可以在工具>选项>源代码管理下找到该选项。它似乎没有默认设置选项，但如果在设置后关闭 VS，它应该保存该值。

祝你好运。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-13T18:22:17.103

从VS2008工具菜单：VS2008->工具->选项->源代码管理->插件选择->选择你想要的插件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-13T18:25:57.750

@smaclell，@Vivek - 是的，我已经尝试过了，它适用于当前会话，但是下次我打开 Visual Studio 时它会恢复。

我还看到一个帖子，建议我将其更改为None，然后关闭VS，然后将其更改为TFS并关闭VS。这似乎导致默认设置为无，但是当我尝试从 TFS 打开解决方案时，它实际上又恢复为使用 MSSCCI 提供程序。

我将尝试对 Team Explorer 安装进行修复。我认为我是在安装 Team Explorer 之后安装了 MSSCCI 提供程序，并且可能是这个顺序把事情搞砸了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-11-26T16:15:54.513

好的，我只是有相同的答案，并认为我解决了它。您必须以管理员身份更改它。

于是，我以管理员身份右键启动VS2013，将SCC插件设置为None，退出。然后以同样的方式启动，更改为 AnkhSVN，退出。

正常启动时，现在有正确的 SVN 默认值，而不是 TFS！

# sql-server-2005 - SQL Server 2008 相对于 SQL Server 2005 的优势？

> ID：198478
> 
> 赞同：69
> 
> 时间：2008-10-13T18:11:30.620
> 
> 标签：sql-server-2005, sql-server-2008, comparison

Microsoft 的 SQL Server 2005 和 SQL Server 2008 之间的主要区别是什么？

是否有任何令人信服的升级理由（任何版本，因为我有一个客户有多个版本）？或者是否有一个网站可以比较两台服务器的图表或要点？

[另外，这两个版本的Express](http://en.wikipedia.org/wiki/SQL_Server_Express)版本有什么值得注意的地方吗？

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2008-10-13T18:34:06.860

*   透明数据加密。加密整个数据库的能力。
*   备份加密。在备份时执行以防止篡改。
*   外部密钥管理。将密钥与数据分开存储。
*   审计。监控数据访问。
*   数据压缩。减少事实表大小并提高性能。
*   资源总督。限制用户或组消耗高级别或资源。
*   热插拔 CPU。即时添加 CPU。
*   表演工作室。性能监控工具的集合。
*   *安装改进。磁盘映像和服务包卸载选项。*
*   动态发展。新的 ADO 和 Visual Studio 选项以及 Dot Net 3。
*   实体数据服务。业务线 (LOB) 框架和实体查询语言 (eSQL)
*   LINQ。开发查询语言，用于访问 SQL 和 XML 等多种类型的数据。
*   数据同步。开发经常断开连接的应用程序。
*   大 UDT。UDT 没有大小限制。
*   日期和时间。新数据类型：日期、时间、日期时间偏移。
*   文件流。用于管理二进制数据的新数据类型 VarBinary(Max) FileStream。
*   表值参数。将整个表传递给存储过程的能力。
*   空间数据。用于存储纬度、经度和 GPS 条目的数据类型。
*   全文搜索。原生索引、作为元数据的词库和备份能力。
*   SQL Server 集成服务。改进的多处理器支持和更快的查找。
*   合并。TSQL 命令结合了插入、更新和删除。
*   SQL Server 分析服务器。堆栈改进，更快的块计算。
*   SQL Server 报告服务器。改进的内存管理和更好的渲染。
*   Microsoft Office 2007。使用 OFFICE 作为 SSRS 模板。SSRS 到 WORD。
*   SQL 2000 支持结束。对 SQL 2000 的主流支持即将结束。

（好的介绍文章[第 1](http://www.databasejournal.com/features/mssql/article.php/3691821)部分、[第 2](http://www.databasejournal.com/features/mssql/article.php/3697056)部分、[第 3 部分](http://www.databasejournal.com/features/mssql/article.php/3702381)。至于令人信服的原因，这取决于您使用 SQL Server 的目的。您需要[分层数据类型](http://blogs.msdn.com/manisblog/archive/2007/08/17/sql-server-2008-hierarchyid.aspx)吗？您当前是否将文件存储在数据库中并希望切换到[SQL Server 的新文件流功能](http://blogs.msdn.com/rdoherty/archive/2007/10/12/getting-traction-with-sql-server-2008-filestream.aspx)？您可以通过打开[数据压缩](http://blogs.msdn.com/chadboyd/archive/2007/07/28/katmai-sql-2008-data-compression-including-backup-compression.aspx)来使用更多磁盘空间吗？

我们不要忘记[合并](http://msdn.microsoft.com/en-us/library/bb522522.aspx)数据的能力。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-19T01:01:39.943

请注意，许多真正的杀手级功能仅在企业版中。数据压缩和备份压缩是我最喜欢的两个 - 它们立即为您提供免费的性能改进。数据压缩减少了您必须执行的 I/O 量，因此大量查询速度提高了 20-40%。CPU 使用率上升，但在当今的多核环境中，我们通常拥有更多的 CPU 能力，但没有更多的 IO。无论如何，这些仅在企业中。

如果您只打算使用标准版，那么大多数改进都需要更改您的应用程序代码和 T-SQL 代码，因此销售起来并不那么容易。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-13T18:51:57.620

具有更高声誉的人可以将其复制到主要答案中：

*   更改跟踪。允许您获取有关自特定版本以来哪些行发生的更改的信息。
*   更改数据捕获。允许捕获和查询所有更改。（企业）

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-13T18:53:00.207

我想这取决于你的角色

作为开发者的我：

*   合并声明
*   报告服务改进
*   日期/时间更改

编辑，*后期*更新，使用后

*   过滤索引
*   表值参数
*   没有 IIS 的 Reporting Services

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-02T16:49:38.210

[我在PASS 2008](http://summit2008.sqlpass.org/)中参加了一堆 SQL Server 2008 会谈，从我的角度来看，唯一的“杀手级功能”是扩展事件。

有很多很棒的改进，但对我来说，这是唯一一个接近改变游戏规则的改进。表值参数和合并可能是我的下一个最爱。日常，[IntelliSense](http://en.wikipedia.org/wiki/IntelliSense)是一个巨大的胜利。但这并不是真正特定于 SQL Server 2008，只是 SQL Server 2008 工具集（其他工具可以为您提供针对 SQL Server 2005、2000 等的类似 IntelliSense）。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-13T18:21:39.287

添加了新[功能](http://www.microsoft.com/sqlserver/2008/en/us/overview.aspx)。但是，你必须看看它是否值得升级。[不过， Management Studio 2008 中](http://www.simple-talk.com/sql/learn-sql-server/management-studio-improvements-in-sql-server-2008/)有一些很好的改进，尤其是查询编辑器的智能感知。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-11-04T21:29:48.060

SQL 2008 还允许您禁用特定表的锁升级。我发现这在经常更新的小型表上非常有用，在这些表中锁可能会升级，从而导致并发问题。在 SQL 2005 中，即使在删除语句上使用 ROWLOCK 提示，锁也可以升级，这可能导致死锁。在我的测试中，由于 SQL 2005 上的锁升级，我开发的一个应用程序在小表操作期间出现并发问题。在 SQL 2008 中，这个问题消失了。

记住处理大量行锁的潜在开销仍然很重要，但是在需要时可以选择停止升级非常有用。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-06-25T07:34:33.000

我的最爱之一是过滤索引。现在，我可以为最关键的查询创建闪电般的快速覆盖索引，而对 DML 语句的影响很小。

/哈坎·温瑟

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2010-12-27T10:34:38.453

SQL Server 2008 引入了四种新的日期和时间数据类型，包括：

```
* DATE: As you can imagine, the DATE data type only stores a date in the format of YYYY-MM-DD. It has a range of 0001-01-01 through 9999-12-32, which should be adequate for most business and scientific applications. The accuracy is 1 day, and it only takes 3 bytes to store the date.
* TIME: TIME is stored in the format: hh:mm:ss.nnnnnnn, with a range of 00:00:00.0000000 through 23:59:59:9999999 and is accurate to 100 nanoseconds. Storage depends on the precision and scale selected, and runs from 3 to 5 bytes.
* DATETIME2: DATETIME2 is very similar to the older DATETIME data type, but has a greater range and precision. The format is YYYY-MM-DD hh:mm:ss:nnnnnnnm with a range of 0001-01-01 00:00:00.0000000 through 9999-12-31 23:59:59.9999999, and an accuracy of 100 nanoseconds. Storage depends on the precision and scale selected, and runs from 6 to 8 bytes.
* DATETIMEOFFSET: DATETIMEOFFSET is similar to DATETIME2, but includes additional information to track the time zone. The format is YYYY-MM-DD hh:mm:ss[.nnnnnnn] [+|-]hh:mm with a range of 0001-01-01 00:00:00.0000000 through 0001-01-01 00:00:00.0000000 through 9999-12-31 23:59:59.9999999 (in UTC), and an accuracy of 100 nanoseconds. Storage depends on the precision and scale selected, and runs from 8 to 10 bytes. 
```

[http://soft-engineering.blogspot.com/](http://soft-engineering.blogspot.com/)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-08-18T14:02:19.097

新功能真的很棒，它符合当今时代的非常重要的因素。对于 .net 的人来说，使用 SQL Server 总是一件好事，我希望使用最新版本我们将拥有**更好的安全性**和更好的性能，以及引入**压缩**数据库大小的功能。**备份加密**实用程序也是现象。

再次感谢微软在软件方面的伟大想法:)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2012-06-21T05:54:46.187

在过去的几个月里，丹佛 SQL Server 用户组就 SQL 2008 的新功能做了一些非常好的演示，其中包括 Paul Nielsen 上周刚从雷德蒙德的“Jump Start”回来后不久发表的一篇演讲（如果我记得的话）事件的名称正确）。

关于 SQL 2008 的所有“新特性”的一些警告，确定哪些特性将出现在各个版本中的分类仍在进行中。许多/大多数新的/非常酷的功能，如数据压缩、分区索引、策略等，只会出现在企业版中。除非您计划运行企业版，否则 CTP 中的许多功能可能不会出现在 SQL 2008 标准等中。

关于其他小但经常被忽视的问题 - SQL 2008 将只有 64 位，如果您购买新硬件不应该是一个问题，但如果您打算使用现有硬件......另外，如果你有对第三方驱动程序（例如 oracle）的依赖最好确保 64 位版本可用/有效

# asp.net-mvc - 带有源代码的真实世界 ASP.NET MVC 应用程序？

> ID：198482
> 
> 赞同：17
> 
> 时间：2008-10-13T18:12:52.223
> 
> 标签：asp.net-mvc

我认为博客上的所有教程和内容都很棒，但有时当您实际构建应用程序时，您编写代码或与系统交互的方式完全不同。

我想知道你们是否都知道一些优秀的真实世界类型的 ASP.NET MVC 应用程序，这些应用程序具有可用于实验的源代码。

我知道以下内容，但我有兴趣看看是否还有更多：

*   [使用 jQuery 的 Flickr Xplorer ASP.NET MVC 网站](http://www.codeplex.com/FlickrXplorer/Release/ProjectReleases.aspx?ReleaseId=18041)（[实时网站](http://www.flickrmvc.net/Photo/intel#259803598)）

*   [Kigg](http://www.codeplex.com/Kigg)（[现场网站](http://kigg.dotnetslackers.com/)）

*   [论坛：创建完美的应用程序](http://weblogs.asp.net/stephenwalther/archive/2008/09/05/asp-net-mvc-application-building-forums-1-create-the-perfect-application.aspx)

*   [MVC 店面](http://blog.wekeroad.com/mvc-storefront/)（感谢[cristianlibardo](https://stackoverflow.com/users/16526/cristianlibardo)提醒我这个）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-13T18:22:21.050

我相信你知道[storefront](http://blog.wekeroad.com/mvc-storefront/)。我听说这是一个很好的教程，它带有源代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-15T14:10:53.310

## 氧化物

Oxite 是一个**使用 ASP.NET MVC 编写的简单博客引擎**，设计有两个主要目标：

1.  以可重用的方式提供“核心博客功能”示例。博客很简单并且被许多开发人员很好地理解，但是博客需要实现的一组基本功能（引用、RSS、评论等）相当复杂。希望这段代码有所帮助。
2.  提供使用 ASP.NET MVC 编写的真实示例。

**链接**

*   [VisitMix 上的 Oxite 网站](http://visitmix.com/Lab/Oxite)
*   [CodePlex 上的 Oxite](http://www.codeplex.com/oxite)

更新：Karl Seguin 批评 Oxite 实施：[http ://codebetter.com/blogs/karlseguin/archive/2008/12/15/oxite-oh-dear-lord-why.aspx](http://codebetter.com/blogs/karlseguin/archive/2008/12/15/oxite-oh-dear-lord-why.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-04-30T13:41:28.207

我学会了使用[NOPCommerce](http://nopcommerce.com)。它展示了 ASP.NET MVC 的几乎所有功能，最新版本在 MVC5 上。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-16T18:44:54.450

查看[代码丛](http://www.codeplex.com/Project/ProjectDirectory.aspx?TagName=MVC)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-01T10:40:19.387

[NuGet 源](http://nuget.codeplex.com/SourceControl/list/changesets)包括用于运行 nuget.org 的服务器项目。

# delphi - 在应用程序中拖放到另一个应用程序

> ID：198488
> 
> 赞同：4
> 
> 时间：2008-10-13T18:17:09.093
> 
> 标签：delphi, drag-and-drop

我有一个包含文件名的 ListView。这些文件名需要可拖动到 TreeView，它是应用程序内的拖放功能，并与 Delphi 的内置拖放支持一起使用 - 没问题。但我还必须能够将 ListView 项目拖放到另一个应用程序，例如 Windows 资源管理器。这也有效，例如使用 Anders Melander 的组件套件 ( [http://melander.dk](http://melander.dk) ) 的 DragFileSource 组件，它在 ListView.MouseDown 事件中开始工作，因此实际上并没有启动拖放操作。

基本上，我需要的行为与您在 Windows 资源管理器中看到的相同：您可以将项目拖到应用程序内的另一个文件夹，也可以拖到另一个应用程序。

如何在 Delphi 中做到这一点？我想应该有一个“拖动”启动，但是当鼠标移出应用程序窗口时，它需要“切换”到其他功能，并且如果鼠标移回应用程序窗口，再次回到标准拖放.

谢谢你的帮助！

霍尔格

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-14T07:22:53.300

您提到的[拖放组件套件就是这样做的。](http://melander.dk/)您可以启动拖动，默认情况下您可以将其拖放到您自己的应用或其他应用中。只需选择其他应用程序可以理解的正确剪贴板格式。你有什么问题？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-13T18:56:15.817

如果您想要 VCL 样式和 Windows 样式的拖放，那么对所有内容都使用 Windows 样式的拖放，包括在您自己的应用程序中进行拖放。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-14T02:44:39.710

DropMaster 组件可能对此有所帮助 - 请参阅[http://www.raize.com/DevTools/DropMaster/](http://www.raize.com/DevTools/DropMaster/)

# console - 如何预防 运行 Intersystems Caché 终端脚本时出错？

> ID：198493
> 
> 赞同：2
> 
> 时间：2008-10-13T18:19:08.060
> 
> 标签：console, terminal, intersystems-cache, disconnected-session

我正在开发一个需要执行 Intersystems Cache Terminal Scripts 的系统。

当我在常规 Caché 终端或 telnet 终端内运行例程时，Cache 会执行例程直到结束，没有任何问题。但是，当我尝试运行相同的例程，但这次在 Caché 终端脚本中调用该例程时，Caché 会在一段时间后断开会话。文档中根本没有提到“超时”设置或与我收到的“”消息相关的任何内容。

脚本就像这样运行：

```
Cterm.exe /console=cn_iptcp:192.168.2.13[23] c:\test.s 
```

1) 有谁知道是什么可能导致 Interystems Caché 在运行过程中断开会话（会话也不是空闲的。它会定期向控制台输出状态消息）？

2）关于如何解决它的任何想法？

谢谢，

路易斯·费尔南多

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-19T15:45:23.627

过了一会儿，我终于发现了会话被终止的原因。您必须在最后等待某些东西，否则脚本就会终止。但是您必须确保您等待的字符串在代码完成之前不会被打印出来。

因此，我刚刚将程序更改为仅在末尾打印“操作完成”，然后输入以下行：

```
 waitfor "Operation finished"
terminate 
```

现在程序不会中断。

干杯，

路易斯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T18:59:00.757

有没有可能不是超时，而是其他问题？可能是没有被捕获/记录的运行时错误？

从交互式控制台运行和作为脚本运行的主要区别在于，当您以交互方式运行时，您处于程序员模式，但在脚本中您处于用户模式。我想不出任何原因为什么这很重要，但您的代码可能对此很敏感。

这里有一些东西可以尝试：编写一个非常简单的脚本，除了不时地写出一个字符之外什么都不做。也许是这样的：

FI=1:1:360 H 10 W "." ;每10秒写一个点，持续1小时

如果这也超时，那么您就知道它是终端，而不是您的代码。

# c# - System.Array.CopyTo() 和 System.Array.Clone() 之间的区别

> ID：198496
> 
> 赞同：93
> 
> 时间：2008-10-13T18:19:40.650
> 
> 标签：c#, .net, arrays, .net-2.0

`System.Array.CopyTo()`和有什么区别`System.Array.Clone()`？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2008-10-13T18:20:13.487

**[Clone()](http://msdn.microsoft.com/en-us/library/system.array.clone.aspx)**方法返回一个包含原始数组中所有元素的新数组（浅拷贝）对象。**[CopyTo()](http://msdn.microsoft.com/en-us/library/system.array.copyto.aspx)**方法将元素复制到另一个现有数组中。两者都执行浅拷贝。浅拷贝意味着内容（每个数组元素）包含对与原始数组中的元素相同的对象的引用。深拷贝（这两种方法都不执行）会为每个元素的对象创建一个新实例，从而产生一个不同但相同的对象。

所以区别是：

```
1- CopyTo require to have a destination array when Clone return a new array.
2- CopyTo let you specify an index (if required) to the destination array. 
```

编辑：

删除错误的示例。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2008-10-13T18:45:50.097

到目前为止未提及的另一个区别是

*   `Clone()`目标数组不需要存在，因为新数组是从头开始创建的。
*   `CopyTo()`不仅目标数组需要已经存在，它还需要足够大以容纳源数组中您指定为目标的索引中的所有元素。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2012-08-27T12:12:40.033

正如许多其他答案所述，这两种方法都执行数组的[浅拷贝](https://stackoverflow.com/questions/184710/what-is-the-difference-between-a-deep-copy-and-a-shallow-copy)。但是，存在尚未解决的差异和建议，并在以下列表中突出显示。

特点[`System.Array.Clone`](http://msdn.microsoft.com/en-us/library/system.array.clone.aspx)：

*   使用 .NET 4.0 进行的测试表明它**比`CopyTo`**可能的慢，因为它使用[`Object.MemberwiseClone`](http://msdn.microsoft.com/en-us/library/system.object.memberwiseclone.aspx);
*   **需要将结果**转换为适当的类型；
*   结果数组与源具有相同的长度。

特点[`System.Array.CopyTo`](http://msdn.microsoft.com/en-us/library/06x742cw.aspx)：

*   **比`Clone`**复制到相同类型的数组时更快；
*   **它调用[`Array.Copy`](http://msdn.microsoft.com/en-us/library/system.array.constrainedcopy.aspx)继承是能力**，是最有用的：
    *   可以将值类型元素装箱成引用类型元素，例如，将`int[]`数组复制到`object[]`;
    *   可以将引用类型元素拆箱成值类型元素，例如，将`object[]`装箱的数组复制`int`到`int[]`;
    *   可以对值类型执行扩展转换，例如，将 a 复制`int[]`到`long[]`.
    *   可以向下转换元素，例如，将`Stream[]`数组复制到 a`MemoryStream[]`中（如果源数组中的任何元素不可转换`MemoryStream`为抛出异常）。
*   允许将源复制到长度大于源的目标数组。

另请注意，这些方法可用于支持[`ICloneable`](http://msdn.microsoft.com/en-us/library/system.icloneable.aspx)and [`ICollection`](http://msdn.microsoft.com/en-us/library/system.collections.icollection.aspx)，因此如果您正在处理数组类型的变量，则不应使用`Clone`or`CopyTo`而是使用[`Array.Copy`](http://msdn.microsoft.com/en-us/library/k4yx47a1.aspx)or [`Array.ConstrainedCopy`](http://msdn.microsoft.com/en-us/library/system.array.constrainedcopy.aspx)。受约束的复制确保如果复制操作无法成功完成，则目标阵列状态不会损坏。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2008-10-13T18:23:33.543

正如@PatrickDesjardins 所说，两者都执行浅拷贝（尽管许多被误导的灵魂认为这`CopyTo`是深拷贝）。

但是，`CopyTo`允许您将一个数组复制到目标数组中的指定索引，从而显着提高灵活性。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-11-06T20:10:05.240

```
object[] myarray = new object[] { "one", 2, "three", 4, "really big number", 2324573984927361 };

//create shallow copy by CopyTo
//You have to instantiate your new array first
object[] myarray2 = new object[myarray.Length];
//but then you can specify how many members of original array you would like to copy 
myarray.CopyTo(myarray2, 0);

//create shallow copy by Clone
object[] myarray1;
//here you don't need to instantiate array, 
//but all elements of the original array will be copied
myarray1 = myarray.Clone() as object[];

//if not sure that we create a shalow copy lets test it
myarray[0] = 0;
Console.WriteLine(myarray[0]);// print 0
Console.WriteLine(myarray1[0]);//print "one"
Console.WriteLine(myarray2[0]);//print "one" 
```

[来源](http://mgznet.com/CopyToVSClone.aspx)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-03-14T07:31:38.010

CopyTo() 和 Clone() 都进行浅拷贝。Clone() 方法对原始数组进行克隆。它返回一个精确长度的数组。

另一方面，CopyTo() 将元素从原始数组复制到目标数组，从指定的目标数组索引开始。请注意，这会将元素添加到已经存在的数组中。

以下代码将与说 CopyTo() 进行深层复制的帖子相矛盾：

```
public class Test
{
public string s;
}

// Write Main() method and within it call test()

private void test()
{
Test[] array = new Test[1];
array[0] = new Test();
array[0].s = "ORIGINAL";

Test[] copy = new Test[1];
array.CopyTo(copy, 0);

// Next line displays "ORIGINAL"
MessageBox.Show("array[0].s = " + array[0].s);
copy[0].s = "CHANGED";

// Next line displays "CHANGED", showing that
// changing the copy also changes the original.
MessageBox.Show("array[0].s = " + array[0].s);
} 
```

让我解释一下。如果数组的元素是引用类型，则副本（对于 Clone() 和 CopyTo()）将被复制到第一（顶层）级别。但是较低的级别不会被复制。如果我们还需要较低级别的副本，我们必须明确地这样做。这就是为什么在克隆或复制引用类型元素之后，克隆或复制数组中的每个元素都引用与原始数组中相应元素引用的相同内存位置。这清楚地表明没有为较低级别创建单独的实例。如果是这样，那么更改复制或克隆数组中任何元素的值都不会对原始数组的相应元素产生影响。

我认为我的解释是详尽无遗的，但我没有找到其他方法可以使其易于理解。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-08-08T19:30:49.617

`Array.Clone()``int`当将数组或字符串作为引用传递给方法时，将执行技术上的深层复制。

例如

```
int[] numbers = new int[] { -11, 12, -42, 0, 1, 90, 68, 6, -9 }; 

SortByAscending(numbers); // Sort the array in ascending order by clone the numbers array to local new array.
SortByDescending(numbers); // Same as Ascending order Clone 
```

即使方法对数字数组进行排序，但它不会影响传递给排序方法的实际引用。即数字数组将在第 1 行中采用相同的未排序初始格式。

**注意：**克隆应该在排序方法中完成。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-02-29T23:19:43.810

该`Clone()`方法不引用目标实例只是给你一个副本。该`CopyTo()`方法将元素复制到现有实例中。

两者都没有给出目标实例的引用，并且正如许多成员所说，他们给出了没有引用的浅拷贝（幻觉拷贝），这是关键。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-04-13T02:50:20.760

两者都是浅拷贝。**CopyTo 方法不是深拷贝。** 检查以下代码：

```
public class TestClass1
{
    public string a = "test1";
}

public static void ArrayCopyClone()
{
    TestClass1 tc1 = new TestClass1();
    TestClass1 tc2 = new TestClass1();

    TestClass1[] arrtest1 = { tc1, tc2 };
    TestClass1[] arrtest2 = new TestClass1[arrtest1.Length];
    TestClass1[] arrtest3 = new TestClass1[arrtest1.Length];

    arrtest1.CopyTo(arrtest2, 0);
    arrtest3 = arrtest1.Clone() as TestClass1[];

    Console.WriteLine(arrtest1[0].a);
    Console.WriteLine(arrtest2[0].a);
    Console.WriteLine(arrtest3[0].a);

    arrtest1[0].a = "new";

    Console.WriteLine(arrtest1[0].a);
    Console.WriteLine(arrtest2[0].a);
    Console.WriteLine(arrtest3[0].a);
}

/* Output is 
test1
test1
test1
new
new
new */ 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-07-17T09:33:24.153

**Array.Clone**在调用函数时不需要目标/目标数组可用，而**Array.CopyTo**需要目标数组和索引。

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2010-01-23T12:49:45.490

`Clone()`仅用于复制数据/数组的结构，它不复制实际数据。

`CopyTo()`复制结构以及实际数据。

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2013-12-09T12:06:43.310

请注意：使用 String[] 和 StringBuilder[] 是有区别的。

在 String 中 - 如果您更改 String，我们已复制（通过 CopyTo 或 Clone）指向同一字符串的其他数组将不会更改，但原始 String 数组将指向新 String，但是，如果我们使用 StringBuilder在数组中，String 指针不会改变，因此，它将影响我们为该数组制作的所有副本。例如：

```
public void test()
{
    StringBuilder[] sArrOr = new StringBuilder[1];
    sArrOr[0] = new StringBuilder();
    sArrOr[0].Append("hello");
    StringBuilder[] sArrClone = (StringBuilder[])sArrOr.Clone();
    StringBuilder[] sArrCopyTo = new StringBuilder[1];
    sArrOr.CopyTo(sArrCopyTo,0);
    sArrOr[0].Append(" world");

    Console.WriteLine(sArrOr[0] + " " + sArrClone[0] + " " + sArrCopyTo[0]);
    //Outputs: hello world hello world hello world

    //Same result in int[] as using String[]
    int[] iArrOr = new int[2];
    iArrOr[0] = 0;
    iArrOr[1] = 1;
    int[] iArrCopyTo = new int[2];
    iArrOr.CopyTo(iArrCopyTo,0);
    int[] iArrClone = (int[])iArrOr.Clone();
    iArrOr[0]++;
    Console.WriteLine(iArrOr[0] + " " + iArrClone[0] + " " + iArrCopyTo[0]);
   // Output: 1 0 0
} 
```

# math - 自学线性代数的书籍和资源

> ID：198501
> 
> 赞同：9
> 
> 时间：2008-10-13T18:20:59.930
> 
> 标签：math, linear-algebra, algebra

我正在寻找书籍和资源来自学*线性*代数以用于 3D 图形编程。我更喜欢实用的教学方法而不是理论教学（尽管数学是什么，99.99% 的理论？），所以我梦寐以求的资源将是一本从实际角度处理线性代数的书，因为它与 3D 图形编程一起使用。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-13T18:24:08.847

[MIT OpenCourseWare](http://ocw.mit.edu/OcwWeb/Mathematics/18-06Spring-2005/CourseHome/)提供免费的线性代数课程。对于您的特定兴趣而言，可能过于笼统，但它是免费的。:)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-13T20:15:53.973

如果你问数学家、工程师和游戏程序员什么是线性代数，你会得到三个不同的答案。

数学家将专注于迷人但抽象的主题，例如线性独立和抽象向量空间。工程师将专注于用于求解微分方程的特征向量。对于图形，您通常使用向量来计算几何，这不是线性代数教科书的重点。

一本好的计算机图形学教科书应该涵盖您需要的大部分内容。FS Hill 的书就是一个例子。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-13T18:28:38.447

尽管不打算教授线性代数，但《[3d 游戏编程大师的技巧](https://rads.stackoverflow.com/amzn/click/com/0672318350)》这本书对 3D 图形进行了出色的覆盖，并提供了如何应用线性代数的示例。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-14T04:55:26.083

Foley's *Computer Graphics*将以实用的方式回答您的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-14T05:01:18.423

嗯——对于 3D 编程，你不需要所有花哨的线性代数东西，比如抽象向量空间、基、特征向量等。

你所需要的只是一些基本的东西，比如矩阵乘法、内积的定义（以及一些关于它的基本事实）、关于法线向量的线和计划的定义等。

如果我没记错的话，所有这些通常都包含在本科分析几何课程中。

但毕竟 - 如果你不想使用自己的渲染引擎，你会使用 DirectX、OpenGL 或类似的东西，然后你只需要知道如何用它的坐标“解决”3D 中的一个点，也许如何计算“表面”的法线向量 - 在所有这些情况下，维基百科或谷歌都会为您提供帮助。

# google-app-engine - 如何最好地防止 GAE 应用程序中的 CSRF 攻击？

> ID：198520
> 
> 赞同：11
> 
> 时间：2008-10-13T18:25:46.190
> 
> 标签：google-app-engine, csrf

那么，对于 GAE 应用程序来说，防止 XSRF 攻击的最佳方法是什么？想象一下：

1.  任何人都可以看到用户的公共对象，并且在请求中使用 db.Model id 来确定要显示的对象。恶意用户现在拥有该 ID。
2.  恶意用户创建自己的对象并签出删除表单。他们现在知道如何删除具有特定 id 的对象。
3.  恶意用户让无辜用户提交对该用户对象的删除请求。

我可以添加哪些步骤来防止#3？请注意，当我说 ID 时，我使用的是密钥的实际 ID 部分。我的一个想法是在删除请求中使用完整的键值，但这会阻止恶意用户解决这个问题吗？据我所知，密钥是模型类类型、应用程序 ID 和对象实例 ID 的某种组合，因此如果他们愿意，他们可能会从 id 派生密钥。

还有其他想法吗？Jeff 写[了一篇关于这个的帖子](http://www.codinghorror.com/blog/archives/001171.html)，并提出了一些方法——一个隐藏的表单值，它会在每次请求时改变，以及一个通过 js 写入表单的 cookie 值。我不想排除非 javascript 用户，因此 cookie 解决方案不好 - 对于隐藏的表单值，我必须对显示可删除对象的每个请求进行数据存储写入 - 对于可扩展的对象来说，这不是理想的情况应用程序！

还有其他想法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-25T23:16:50.670

当您生成允许用户删除对象的页面时，生成一个随机标记并将其包含在隐藏的表单字段中。还使用该值设置一个仅限 HTTP 的 cookie。当您收到删除请求时，请检查表单中的随机令牌和 cookie 中的值是否匹配。

您的随机令牌不应该只是一个随机数。您应该加密随机数和用户身份的组合，以使攻击者难以伪造自己的令牌。您还应该对存储在表单中的值和存储在 cookie 中的值使用不同的加密密钥，因此如果其中一个令牌确实泄漏，攻击者仍然难以伪造另一个令牌。

此方法通过表单中是否存在安全令牌来验证删除请求是否来自您的表单；并且不需要写入数据存储。

这种方法仍然容易受到跨站点脚本攻击，攻击者可以从表单中检索隐藏值或提交表单，因此请彻底测试您的站点是否存在跨站点脚本漏洞。这种方法也容易受到[“点击劫持”](http://en.wikipedia.org/wiki/Clickjacking "点击劫持")攻击。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-13T20:20:33.667

很简单：检查推荐人。（故意）不可能使用 Javascript、HTML 表单等设置它。如果它是空白的（某些代理和浏览器剥离引用者）或来自您自己的站点 - 或者更具体地说来自预期的来源 - 允许它。否则，拒绝它并记录它。

编辑：Jeff 写了[一篇后续文章](https://blog.codinghorror.com/preventing-csrf-and-xsrf-attacks/)，介绍了几种防止 CSRF 攻击的方法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-15T14:38:52.607

在显示表单的服务器响应中，创建一个魔术哈希（基于客户端 ip + 日期/时间 + 随机盐等）。将其放入 cookie 并存储在服务器上的某个位置。在提交操作处理期间，根据数据库条目检查 cookie 哈希。

如果没有这样的哈希值或它不同，则拒绝提交。

成功提交后，您可以删除哈希条目，将其状态更改为已提交 - 任何适合您的。

在许多情况下，这种方法应该可以保护您，但肯定仍然不是 100% 防弹的。

搜索有关 CSRF 的文章，也许您会在[Stack Overflow](http://stackoverflow.com)上找到一些好的答案。;)

不要进行任何引荐来源网址检查或客户端 IP 验证 - 这太容易出错（引荐来源网址信息可能会被用户代理、代理或用户的偏好清除）并且客户端的 IP 可能会在表单创建和提交之间发生变化 - 不要t 惩罚用户的动态 IP 地址分配。

# cocoa - 如何确定货币符号是在 MacOS 上的数字的左侧还是右侧

> ID：198526
> 
> 赞同：1
> 
> 时间：2008-10-13T18:26:26.970
> 
> 标签：cocoa, macos, core-foundation

如何在 Mac Carbon 项目中使用 CFLocale / CFNumberFormatter 确定货币符号应该位于数字的左侧还是右侧？

我需要与一个电子表格应用程序交互，该应用程序需要我传递一个数字、货币符号、货币符号位置和填充，而不是使用 CFNumberFormatter 创建的 CStringRef。

```
CFLocaleRef currentLocale = CFLocaleCopyCurrent();
CFTypeRef currencySymbol = CFLocaleGetValue (currentLocale, kCFLocaleCurrencySymbol); 
```

为我提供了货币符号作为字符串。但我迷失了如何确定货币符号的位置......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T07:24:09.270

作为一种解决方法，我已经开始创建一个表示货币值的字符串，并通过搜索字符串来确定货币符号的位置，但这对我来说确实很可疑。

```
 CFNumberFormatterRef numberFormatter = CFNumberFormatterCreate(kCFAllocatorDefault, CFLocaleCopyCurrent(), kCFNumberFormatterCurrencyStyle);
    double someNumber = 0;
    CFStringRef asString = CFNumberFormatterCreateStringWithValue(kCFAllocatorDefault, numberFormatter, kCFNumberDoubleType, &someNumber); 
```

...

随意用卷起的报纸打我，告诉我真正的答案......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-26T06:15:23.157

您可以尝试检查从`CFNumberFormatterGetFormat`. [看起来](http://unicode.org/reports/tr35/tr35-6.html#Number_Format_Patterns)您想搜索`¤`which is `\u00A4`。

# c# - 在 .NET 中更改 DateTimePicker 的背景颜色

> ID：198532
> 
> 赞同：15
> 
> 时间：2008-10-13T18:28:29.290
> 
> 标签：c#, .net, vb.net, winforms

在`.NET`（至少在 2008 版本中，也许在 2005 版本中），更改`BackColor`a 的属性`DateTimePicker`对外观绝对没有影响。如何更改文本区域的背景颜色，而不是下拉日历的背景颜色？

***编辑：***我说的是 Windows 窗体，而不是 ASP。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-13T22:34:15.643

根据[MSDN](http://msdn.microsoft.com/en-us/library/0625h0ta.aspx)：

> 设置`BackColor`对 的外观没有影响`DateTimePicker`。

您需要编写一个扩展的自定义控件`DateTimePicker`。覆盖`BackColor`属性和`WndProc`方法。

每当您更改 时`BackColor`，请不要忘记调用该`myDTPicker.Invalidate()`方法。这将强制控件使用指定的新颜色重绘。

```
const int WM_ERASEBKGND = 0x14;
protected override void WndProc(ref System.Windows.Forms.Message m)
{
    if(m.Msg == WM_ERASEBKGND)
    {
        using(var g = Graphics.FromHdc(m.WParam))
        {
            using(var b = new SolidBrush(_backColor))
            {
                g.FillRectangle(b, ClientRectangle);
            }
        }
        return;
    }

    base.WndProc(ref m);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-07-29T20:24:03.740

有一个免费的实现派生`DateTimePicker`，允许您在更改时更改`BackColor`属性。

参见 CodeProject 网站：[`DateTimePicker`with working`BackColor`](http://www.codeproject.com/KB/selection/DateTimePicker_With_BackC.aspx)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-09-29T10:18:01.980

基于此 CodeProject: [A DateTimePicker with working BackColor](https://www.codeproject.com/Articles/30660/A-DateTimePicker-with-working-BackColor)（如上所示） 我重写了一个自定义 datepicker 类（在 VB.NET 中），它允许自定义背景颜色、TextColor 和出现在下拉按钮旁边的小图像。

例 1：

[![在此处输入图像描述](https://i.stack.imgur.com/LSZ4x.png)](https://i.stack.imgur.com/LSZ4x.png)

例 2：

[![在此处输入图像描述](https://i.stack.imgur.com/ZoHfk.png)](https://i.stack.imgur.com/ZoHfk.png)

要使其正常工作，只需使用以下代码在您的项目中创建一个新类并重建解决方案。
一个名为的新控件`MyDateTimePicker`现在应该出现在工具箱列表中：

```
Public Class MyDateTimePicker 
    Inherits System.Windows.Forms.DateTimePicker
    Private _disabled_back_color As Color
    Private _image As Image
    Private _text_color As Color = Color.Black

    Public Sub New()
        MyBase.New()
        Me.SetStyle(ControlStyles.UserPaint, True)
        _disabled_back_color = Color.FromKnownColor(KnownColor.Control)
    End Sub

    ''' <summary>
    '''     Gets or sets the background color of the control
    ''' </summary>
    <Browsable(True)>
    Public Overrides Property BackColor() As Color
        Get
            Return MyBase.BackColor
        End Get
        Set
            MyBase.BackColor = Value
        End Set
    End Property

    ''' <summary>
    '''     Gets or sets the background color of the control when disabled
    ''' </summary>
    <Category("Appearance"), Description("The background color of the component when disabled")>
    <Browsable(True)>
    Public Property BackDisabledColor() As Color
        Get
            Return _disabled_back_color
        End Get
        Set
            _disabled_back_color = Value
        End Set
    End Property

    ''' <summary>
    '''     Gets or sets the Image next to the dropdownbutton
    ''' </summary>
    <Category("Appearance"),
    Description("Get or Set the small Image next to the dropdownbutton")>
    Public Property Image() As Image
        Get
            Return _image
        End Get
        Set(ByVal Value As Image)
            _image = Value
            Invalidate()
        End Set
    End Property

    ''' <summary>
    '''     Gets or sets the text color when calendar is not visible
    ''' </summary>
    <Category("Appearance")>
    Public Property TextColor As Color
        Get
            Return _text_color
        End Get
        Set(value As Color)
            _text_color = value
        End Set
    End Property

    Protected Overrides Sub OnPaint(e As System.Windows.Forms.PaintEventArgs)
        Dim g As Graphics = Me.CreateGraphics()
        g.TextRenderingHint = Drawing.Text.TextRenderingHint.ClearTypeGridFit

        'Dropdownbutton rectangle
        Dim ddb_rect As New Rectangle(ClientRectangle.Width - 17, 0, 17, ClientRectangle.Height)
        'Background brush
        Dim bb As Brush

        Dim visual_state As ComboBoxState

        'When enabled the brush is set to Backcolor, 
        'otherwise to color stored in _disabled_back_Color
        If Me.Enabled Then
            bb = New SolidBrush(Me.BackColor)
            visual_state = ComboBoxState.Normal
        Else
            bb = New SolidBrush(Me._disabled_back_color)
            visual_state = ComboBoxState.Disabled
        End If

        'Filling the background
        g.FillRectangle(bb, 0, 0, ClientRectangle.Width, ClientRectangle.Height)

        'Drawing the datetime text
        g.DrawString(Me.Text, Me.Font, New SolidBrush(TextColor), 5, 2)

        'Drawing icon
        If Not _image Is Nothing Then
            Dim im_rect As New Rectangle(ClientRectangle.Width - 40, 4, ClientRectangle.Height - 8, ClientRectangle.Height - 8)
            g.DrawImage(_image, im_rect)
        End If

        'Drawing the dropdownbutton using ComboBoxRenderer
        ComboBoxRenderer.DrawDropDownButton(g, ddb_rect, visual_state)

        g.Dispose()
        bb.Dispose()
    End Sub
End Class 
```

*注意，这个类是简化的，所以它的功能有限

# opengl-es - 抖动 gouraud 着色的顶点色多边形以去除条带

> ID：198534
> 
> 赞同：3
> 
> 时间：2008-10-13T18:28:59.710
> 
> 标签：opengl-es, quantization, dithering

我在[低分辨率嵌入式设备](http://www.apple.com/iphone/)上使用[OpenGL ES](http://www.khronos.org/opengles/)。

我已经使用顶点着色将垂直颜色渐变应用到用作渲染场景背景的大多边形上。我可以在颜色渐变中看到清晰可见的条带伪影。

我的主要经验是使用软件渲染器。使用软件渲染器，通常会抖动掉[马赫带](http://en.wikipedia.org/wiki/Mach_band)和其他带状伪影。我们经常在渲染帧的量化步骤中执行此操作，其中浮点、高精度的颜色表示被转换为较低精度的输出（通常带有整数分量）。我们通过随机向上或向下舍入最终整数分量来实现抖动，以在图像中插入最微小的噪声，从而欺骗眼睛看到颜色之间的连续和平滑混合。

我的问题是我是否可以使用 OpenGL ES 来实现这一点？这种抖动是OpenGL管道的一部分，还是我应该跳过顶点着色并将渐变渲染到纹理并对其应用一些噪声？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-15T16:41:10.440

你试过 glEnable(GL_DITHER) 吗？它通常最初是启用的，但我从未使用过 GL ES 或嵌入式设备。它还可能取决于您在帧缓冲区中使用的颜色深度，如果每个通道只有 4 位，您将获得伪影。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-13T19:06:15.610

我从来没有听说过你描述的在 OGL 管道中的效果。不过，我的知识在这一点上有点过时，所以我可能错了。如果可以的话，我会给渲染纹理一个镜头。

# asp.net - asp.net：获取 DropDownList 的 SelectedItem 并保留列表项

> ID：198535
> 
> 赞同：2
> 
> 时间：2008-10-13T18:29:11.083
> 
> 标签：asp.net, .net, drop-down-menu, viewstate, selecteditem

问题来了。。

我有一个带有标签、下拉列表和提交按钮的小页面。

```
<div>
    <asp:label id="Message" runat="server"/> 
        <br />
        Which city do you wish to look at on hotels for?<br /><br />
        <asp:dropdownlist id="Dropdownlist1" runat="server" EnableViewState="true">
        </asp:dropdownlist>
        <br /><br /><br /><br />
        <input type="Submit" />     
</div> 
```

在表单加载时，我将项目插入下拉列表，然后单击按钮，我将显示下拉列表中项目的计数。这是代码。

`if (Page.IsPostBack) { Message.Text = "You have selected " + Dropdownlist1.Items.Count.ToString(); } else { Message.Text = "You have selected " + Dropdownlist1.Items.Count.ToString(); Dropdownlist1.Items.Add("Madrid"); Dropdownlist1.Items.Add("Chennai"); Dropdownlist1.Items.Add("New York"); }`

这是有趣的部分。如果我直接从 IDE 运行它，它工作得非常好。我第一次得到计数为 0，当我按下提交按钮时得到 3。我需要在现有的虚拟目录上运行这个小代码。如果我在该虚拟目录中运行相同的 aspx 页面，我会在第一次加载时得到计数 0。当我单击提交时，我得到计数​​为 0，并且我在下拉列表中看不到任何项目，它正在被清除。我已将 viewstate 设置为 true，以便我记住插入的内容。

我不确定当我从 IDE 运行它和从另一个虚拟目录运行它时有什么区别。我对 Asp.Net 还很陌生，所以我在这里介绍了所有选项，以便了解下拉列表的工作原理。我在这里缺少配置吗？

顺便说一句，仅供参考，当我将 DropDownList 放在向导控件中时，我遇到了同样的问题。当从 IDE 运行时，它工作正常，但是当我从虚拟目录运行时，它没有获得选定的值，也没有记住下拉列表中的项目。

对此的任何帮助将不胜感激。

* * *

对不起:(，还有几个问题

> 根据您的代码，该列表仅在不是 PostBack 时才会被填充。因此，当您单击按钮时，列表将为空。如果您动态填充列表，则不会记住这些项目。您必须在每个 Page_load 中添加。视图状态只会记住选择了哪个项目。

当页面直接从 IDE 执行时，它如何记住这些项目，而不记得我何时从虚拟目录运行。是否有我可能需要设置的视图状态才能使其正常工作。缓存设置也没有太大的运气。我启用了跟踪信息，又是一件有趣的事情：|，直接从 IDE 而不是从虚拟目录执行时会发生跟踪。再次提问，子目录的 web.config 应该覆盖父 web.config 对吗？

感谢回复。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-13T19:06:36.717

听起来您可能在页面级别禁用了 EnableViewState。与其他响应相反，如果启用了 ViewState，则无需在 PostBack 上重新填充列表。

尝试在页眉中添加 EnableViewState="true" 属性。

我认为这是一个错误。如果 EnableViewState="false" 在页面级别，EnableViewState="true" 在控件级别，则不会像应有的那样为控件保留 ViewState。

如果您只想为某些控件启用 ViewState，请在页面级别设置 EnableViewState="true"，然后为您不想为其保留 ViewState 的控件设置 EnableViewState="false"。倒退，我知道，但这是唯一的解决方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-30T06:49:54.397

这对我有用

```
 protected void Page_Load(object sender, EventArgs e)
{
            if(!IsPostBack)
            FillApplicationDropDown();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T18:32:29.330

也许页面在虚拟目录中被缓存。

尝试将此添加到 Page_Load

```
Response.Cache.SetCacheability(HttpCacheability.NoCache) 
```

我认为可以使用配置文件将缓存应用于目录。所以可能这就是区别。

# c# - 如何通过 .NET/C# 中的反射引发事件？

> ID：198543
> 
> 赞同：32
> 
> 时间：2008-10-13T18:31:30.440
> 
> 标签：c#, .net, event-handling, devexpress

我有一个第三方编辑器，它基本上包含一个文本框和一个按钮（DevExpress ButtonEdit 控件）。我想让特定的击键（`Alt`+ `Down`）模拟单击按钮。为了避免一遍又一遍地写这个，我想制作一个通用的 KeyUp 事件处理程序，它将引发 ButtonClick 事件。不幸的是，控件中似乎没有引发 ButtonClick 事件的方法，所以......

如何通过反射从外部函数引发事件？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-02-25T14:19:41.900

这是一个使用泛型的演示（省略了错误检查）：

```
using System;
using System.Reflection;
static class Program {
  private class Sub {
    public event EventHandler<EventArgs> SomethingHappening;
  }
  internal static void Raise<TEventArgs>(this object source, string eventName, TEventArgs eventArgs) where TEventArgs : EventArgs
  {
    var eventDelegate = (MulticastDelegate)source.GetType().GetField(eventName, BindingFlags.Instance | BindingFlags.NonPublic).GetValue(source);
    if (eventDelegate != null)
    {
      foreach (var handler in eventDelegate.GetInvocationList())
      {
        handler.Method.Invoke(handler.Target, new object[] { source, eventArgs });
      }
    }
  }
  public static void Main()
  {
    var p = new Sub();
    p.Raise("SomethingHappening", EventArgs.Empty);
    p.SomethingHappening += (o, e) => Console.WriteLine("Foo!");
    p.Raise("SomethingHappening", EventArgs.Empty);
    p.SomethingHappening += (o, e) => Console.WriteLine("Bar!");
    p.Raise("SomethingHappening", EventArgs.Empty);
    Console.ReadLine();
  }
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-13T18:44:21.707

一般来说，你不能。将事件视为基本上成对的`AddHandler`/`RemoveHandler`方法（因为它们基本上就是这样）。它们的实现方式取决于班级。大多数 WinForms 控件都[`EventHandlerList`](http://msdn.microsoft.com/en-us/library/system.componentmodel.eventhandlerlist.aspx)用作它们的实现，但是如果它开始获取私有字段和密钥，您的代码将非常脆弱。

控件是否`ButtonEdit`公开了`OnClick`您可以调用的方法？

脚注：实际上，事件*可以*有“raise”成员，因此`EventInfo.GetRaiseMethod`. 但是，C# 从未填充过它，而且我也不相信它在一般框架中。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-13T18:43:31.287

您通常不能引发其他类事件。事件实际上存储为私有委托字段，外加两个访问器（add_event 和 remove_event）。

要通过反射来完成，您只需要找到私有委托字段，获取它，然后调用它。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2010-07-22T19:25:56.340

我写了一个类的扩展，它实现了 INotifyPropertyChanged 来注入 RaisePropertyChange<T> 方法，所以我可以像这样使用它：

```
this.RaisePropertyChanged(() => MyProperty); 
```

无需在任何基类中实现该方法。对于我的使用来说它很慢，但也许源代码可以帮助某人。

所以这里是：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Diagnostics;
using System.Linq.Expressions;
using System.Reflection;
using System.Globalization;

namespace Infrastructure
{
    /// <summary>
    /// Adds a RaisePropertyChanged method to objects implementing INotifyPropertyChanged.
    /// </summary>
    public static class NotifyPropertyChangeExtension
    {
        #region private fields

        private static readonly Dictionary<string, PropertyChangedEventArgs> eventArgCache = new Dictionary<string, PropertyChangedEventArgs>();
        private static readonly object syncLock = new object();

        #endregion

        #region the Extension's

        /// <summary>
        /// Verifies the name of the property for the specified instance.
        /// </summary>
        /// <param name="bindableObject">The bindable object.</param>
        /// <param name="propertyName">Name of the property.</param>
        [Conditional("DEBUG")]
        public static void VerifyPropertyName(this INotifyPropertyChanged bindableObject, string propertyName)
        {
            bool propertyExists = TypeDescriptor.GetProperties(bindableObject).Find(propertyName, false) != null;
            if (!propertyExists)
                throw new InvalidOperationException(string.Format(CultureInfo.CurrentCulture,
                    "{0} is not a public property of {1}", propertyName, bindableObject.GetType().FullName));
        }

        /// <summary>
        /// Gets the property name from expression.
        /// </summary>
        /// <param name="notifyObject">The notify object.</param>
        /// <param name="propertyExpression">The property expression.</param>
        /// <returns>a string containing the name of the property.</returns>
        public static string GetPropertyNameFromExpression<T>(this INotifyPropertyChanged notifyObject, Expression<Func<T>> propertyExpression)
        {
            return GetPropertyNameFromExpression(propertyExpression);
        }

        /// <summary>
        /// Raises a property changed event.
        /// </summary>
        /// <typeparam name="T"></typeparam>
        /// <param name="bindableObject">The bindable object.</param>
        /// <param name="propertyExpression">The property expression.</param>
        public static void RaisePropertyChanged<T>(this INotifyPropertyChanged bindableObject, Expression<Func<T>> propertyExpression)
        {
            RaisePropertyChanged(bindableObject, GetPropertyNameFromExpression(propertyExpression));
        }

        #endregion

        /// <summary>
        /// Raises the property changed on the specified bindable Object.
        /// </summary>
        /// <param name="bindableObject">The bindable object.</param>
        /// <param name="propertyName">Name of the property.</param>
        private static void RaisePropertyChanged(INotifyPropertyChanged bindableObject, string propertyName)
        {
            bindableObject.VerifyPropertyName(propertyName);
            RaiseInternalPropertyChangedEvent(bindableObject, GetPropertyChangedEventArgs(propertyName));
        }

        /// <summary>
        /// Raises the internal property changed event.
        /// </summary>
        /// <param name="bindableObject">The bindable object.</param>
        /// <param name="eventArgs">The <see cref="System.ComponentModel.PropertyChangedEventArgs"/> instance containing the event data.</param>
        private static void RaiseInternalPropertyChangedEvent(INotifyPropertyChanged bindableObject, PropertyChangedEventArgs eventArgs)
        {
            // get the internal eventDelegate
            var bindableObjectType = bindableObject.GetType();

            // search the base type, which contains the PropertyChanged event field.
            FieldInfo propChangedFieldInfo = null;
            while (bindableObjectType != null)
            {
                propChangedFieldInfo = bindableObjectType.GetField("PropertyChanged", BindingFlags.Instance | BindingFlags.NonPublic);
                if (propChangedFieldInfo != null)
                    break;

                bindableObjectType = bindableObjectType.BaseType;
            }
            if (propChangedFieldInfo == null)
                return;

            // get prop changed event field value
            var fieldValue = propChangedFieldInfo.GetValue(bindableObject);
            if (fieldValue == null)
                return;

            MulticastDelegate eventDelegate = fieldValue as MulticastDelegate;
            if (eventDelegate == null)
                return;

            // get invocation list
            Delegate[] delegates = eventDelegate.GetInvocationList();

            // invoke each delegate
            foreach (Delegate propertyChangedDelegate in delegates)
                propertyChangedDelegate.Method.Invoke(propertyChangedDelegate.Target, new object[] { bindableObject, eventArgs });
        }

        /// <summary>
        /// Gets the property name from an expression.
        /// </summary>
        /// <param name="propertyExpression">The property expression.</param>
        /// <returns>The property name as string.</returns>
        private static string GetPropertyNameFromExpression<T>(Expression<Func<T>> propertyExpression)
        {
            var lambda = (LambdaExpression)propertyExpression;

            MemberExpression memberExpression;

            if (lambda.Body is UnaryExpression)
            {
                var unaryExpression = (UnaryExpression)lambda.Body;
                memberExpression = (MemberExpression)unaryExpression.Operand;
            }
            else memberExpression = (MemberExpression)lambda.Body;

            return memberExpression.Member.Name;
        }

        /// <summary>
        /// Returns an instance of PropertyChangedEventArgs for the specified property name.
        /// </summary>
        /// <param name="propertyName">
        /// The name of the property to create event args for.
        /// </param>
        private static PropertyChangedEventArgs GetPropertyChangedEventArgs(string propertyName)
        {
            PropertyChangedEventArgs args;

            lock (NotifyPropertyChangeExtension.syncLock)
            {
                if (!eventArgCache.TryGetValue(propertyName, out args))
                    eventArgCache.Add(propertyName, args = new PropertyChangedEventArgs(propertyName));
            }

            return args;
        }
    }
} 
```

我删除了原始代码的某些部分，因此扩展应该按原样工作，而无需引用我的库的其他部分。但它并没有真正经过测试。

PS 部分代码是从别人那里借来的。真可惜，我忘记了我是从哪里得到它的。:(

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-10-13T18:42:51.943

从*[Raising an event via reflection](http://social.msdn.microsoft.com/Forums/en-US/netfxbcl/thread/44b0d573-5c53-47b0-8e85-6056cbae95b0/)*开始，虽然我认为[VB.NET](http://en.wikipedia.org/wiki/Visual_Basic_.NET)中的答案，也就是说，这篇文章之前的两篇文章将为您提供通用方法（例如，我会从 VB.NET 中寻找灵感引用不在同一类中的类型）：

```
 public event EventHandler<EventArgs> MyEventToBeFired;

    public void FireEvent(Guid instanceId, string handler)
    {

        // Note: this is being fired from a method with in the same
        //       class that defined the event (that is, "this").

        EventArgs e = new EventArgs(instanceId);

        MulticastDelegate eventDelagate =
              (MulticastDelegate)this.GetType().GetField(handler,
               System.Reflection.BindingFlags.Instance |
               System.Reflection.BindingFlags.NonPublic).GetValue(this);

        Delegate[] delegates = eventDelagate.GetInvocationList();

        foreach (Delegate dlg in delegates)
        {
            dlg.Method.Invoke(dlg.Target, new object[] { this, e });
        }
    }

    FireEvent(new Guid(),  "MyEventToBeFired"); 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-10-14T14:40:45.583

事实证明，我可以做到这一点，但没有意识到：

```
buttonEdit1.Properties.Buttons[0].Shortcut = new DevExpress.Utils.KeyShortcut(Keys.Alt | Keys.Down); 
```

但如果我不能，我将不得不深入研究源代码并找到引发事件的方法。

谢谢大家的帮助。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2016-05-28T11:00:48.550

似乎Wiebe Cnossen[接受的答案](https://stackoverflow.com/a/586156/4227)中的代码可以简化为：

```
private void RaiseEventViaReflection(object source, string eventName)
{
    ((Delegate)source
        .GetType()
        .GetField(eventName, BindingFlags.Instance | BindingFlags.NonPublic)
        .GetValue(source))
        .DynamicInvoke(source, EventArgs.Empty);
} 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-02-25T12:44:18.370

如果你知道控件是一个按钮，你可以调用它的`PerformClick()`方法。对于其他事件，我也有类似的问题，例如`OnEnter`, `OnExit`。如果我不想为每个控件类型派生一个新类型，我就无法引发这些事件。

# sql - Oracle DB Mac 地址或其他唯一标识符

> ID：198551
> 
> 赞同：0
> 
> 时间：2008-10-13T18:33:05.833
> 
> 标签：sql, oracle

我正在通过 ODBC 连接使用 SQL 与 Oracle DB 进行交互。是否有一个 SQL 命令我可以用来获取服务器的 MAC 地址，或者唯一标识服务器硬件或软件安装的东西。这样我就可以确定（或至少相当确定）我一直在与同一个数据库通信。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T18:45:44.840

检查[http://download.oracle.com/docs/cd/B28359_01/server.111/b28320/dynviews_1086.htm#REFRN30047](http://download.oracle.com/docs/cd/B28359_01/server.111/b28320/dynviews_1086.htm#REFRN30047)

v$database 性能视图有一个列 dbid。这是您的数据库的一个相当唯一的标识号。（当然名称列也可以是唯一的）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-13T18:38:36.103

我不知道你是否可以得到mac地址。但是在 v$instance 视图中，有一些信息可以帮助您。

```
SELECT * FROM v$instance; 
```

# asp.net - 以编程方式确定 GridView 控件的列名？

> ID：198552
> 
> 赞同：1
> 
> 时间：2008-10-13T18:33:45.550
> 
> 标签：asp.net, gridview

我有一行数据需要在数据库中使用存储过程进行修改。但为了调用该存储过程，我需要知道每一列的名称。如何确定列的名称？（硬编码不是一种选择，因为我们正在谈论很多名称可能会更改的列）。

编辑：给出接受的答案，看起来 eviljack 想要列的标题文本而不是绑定字段的名称

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-13T18:53:06.667

要获取列的标题文本，您可以使用以下命令：

字符串 colText = grid.Columns[i].HeaderText;

其中 i 是列的索引。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-13T18:39:25.650

假设您使用的是 BoundField 列，您可以从 GridView 获取 Columns 集合并将（从 DataControlField）转换为 BoundField，获取 DataField 属性

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-13T11:34:05.687

```
 foreach (TableCell objCell in e.Row.Cells)
                {
                    if (objCell is DataControlFieldHeaderCell)
                    {
                        string HEADERTEXT = objCell.Text;

                    }
                 } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-10T14:25:27.667

```
''' <summary>
''' Requires that the 'AccessibleHeaderText' property is set on the column in the aspx
''' </summary>
Private Function GetCellByName(ByVal e As System.Web.UI.WebControls.GridViewRowEventArgs, ByVal colName As String) As System.Web.UI.WebControls.TableCell

    Dim result As TableCell = Nothing

    If e.Row.RowType = DataControlRowType.DataRow Then
        Dim grid As GridView = e.Row.NamingContainer
        Dim index As Integer = 0

        For i As Integer = 0 To grid.Columns.Count - 1
            If String.Compare(grid.Columns(i).AccessibleHeaderText, colName, True) = 0 Then
                index = i
                Exit For
            End If
        Next

        If index <= e.Row.Cells.Count Then
            result = e.Row.Cells(index)
        End If
    End If

    Return result

End Function 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-24T13:59:43.197

```
List<string> ColName = new List<string>();
foreach(DataColumn c in gridview.Columns)
{
     ColName.Add(c);
} 
```

# asp.net - 为 ASP.NET 生成 PDF 的动态缩略图

> ID：198558
> 
> 赞同：7
> 
> 时间：2008-10-13T18:35:02.380
> 
> 标签：asp.net, pdf, image-generation

我使用了来自 Aspose ( [Aspose.PDF.kit](http://www.aspose.com/categories/file-format-components/aspose.pdf.kit-for-.net-and-java/default.aspx) ) 的工具为 .NET 应用程序动态生成 PDF 缩略图。这很好用，但是还有哪些其他选择呢？Codeproject.com 有[这个教程](http://www.codeproject.com/KB/GDI-plus/pdfthumbnail.aspx)，但它要求您拥有 Acrobat 的完整版本。

是否有适用于 ASP.NET 的开源替代方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-11T00:56:26.263

使用 Itext 创建 PDFS 的缩略图

[http://threebit.net/mail-archive/itext-questions/msg00436.html](http://threebit.net/mail-archive/itext-questions/msg00436.html)

我会推荐 iTextSharp，这样你就不需要 java 可再发行组件

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-11-05T10:48:24.053

我实际上对此进行了相当多的研究，这就是我想出的：

*   TallComponents.com 的 PDFRasterizer 评估版向我证明，它可以在 50 行以下的代码中完成。它相当昂贵——大约 500 英镑。

*   购买 Acrobat Pro 来执行此操作并不划算，尤其是当它使用剪贴板将 PDF 加载到内存中时。

*   ITextSharp 有一个用于处理 PDF 的大型 API，尽管我读过一些地方说它不能从 PDF 创建缩略图，我也没有设法做到这一点。如果有人可以举个例子纠正我，那将非常感激！

*   GFL SDK 是一个免费的解决方案（在已经写完这篇文章之后！）我已经开始在 C#.NET 中工作了！哈利路亚！我使用的代码在这里：[http](http://homeofcox-cs.blogspot.com/2008/10/c-convert-pdf-to-image-format.html) : //homeofcox-cs.blogspot.com/2008/10/c-convert-pdf-to-image-format.html，您需要使用 regsvr32 引用 gflAx.dll 。可执行程序。当您在 COM 选项卡下添加对 DLL 的引用时，它就会出现。

所以总而言之，如果你想免费完成，可以使用 GflaX 在 c#.NET 中完成。

干杯，

卡尔。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-13T19:30:59.350

您可以使用 Windows Shell 的 COM 接口并调用 IExtractImage() 来生成位图。我没有 C# 代码，但我用 C++ 编写了一个成功完成此任务的函数。Windows shell 不依赖 Acrobat SDK 来生成缩略图，但它*可能*取决于您在计算机上安装了免费的 Acrobat Reader。

这是一些用 Delphi 编写的提供该功能的代码的链接。

[http://www.delphi3000.com/articles/article_3806.asp?SK=](http://www.delphi3000.com/articles/article_3806.asp?SK=)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-11T18:48:41.250

我将测试这个组件。它是免费的，他们的在线演示看起来很吸引人： [http ://www.tallcomponents.com/pdfthumbnail-overview.aspx](http://www.tallcomponents.com/pdfthumbnail-overview.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-13T19:03:15.070

我曾经编写了一些 .NET 代码来包装[GhostView](http://pages.cs.wisc.edu/~ghost/)并生成 TIFF——然后可以很容易地使用这些代码来生成缩略图。[你可以在这里](http://ssise.svn.sourceforge.net/viewvc/ssise/Processor/Processor.cs?view=markup)查看代码。函数 processAndInsertLoan 包含实际启动 GhostView 进程并捕获处理输出的代码。如果您愿意，您应该能够从中挽救一些东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-13T18:43:58.043

我绝对鄙视使用 PDF 文档。但是当我绝对需要时，我一直在使用[iTextSharp](http://itextsharp.sourceforge.net/)。它有相当多的功能，[API 有很好的文档记录](http://itext.ugent.be/library/api/)，而且理论上是免费的。尽管要有效地使用它，但如果您获得他们在其网站上推送的书，它会有所帮助。我不确定你是否可以轻松地用它制作缩略图，但它在我迄今为止从事的每个项目中生成和操作 PDF 方面对我很有用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-12-03T06:40:34.330

[我在博客中介绍了一个在 ASP.NET 中生成PDFS](http://www.roastedamoeba.com/blog/archive/2010/11/04/creating-thumbnails-of-a-pdf-in-aspnet)缩略图的开源解决方案。

它在内部使用 GhostscriptSharp，但将其包装在[DynamicImage](https://github.com/sitdap/dynamic-image)环境中，这意味着您可以[将许多其他过滤器](https://github.com/sitdap/dynamic-image/wiki)应用于 PDF 缩略图图像。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-02-16T06:36:30.690

我发现 Tim 的 DynamicImage 是最好的。免费的 TallComponents.com 版本限制缩略图大小。

# html - 掌握语义标记和好的 CSS 有多难？

> ID：198561
> 
> 赞同：10
> 
> 时间：2008-10-13T18:35:49.930
> 
> 标签：html, css

我知道这不会是一个流行的问题，因为很多网页设计师想假设他们的手艺是困难和有价值的。

**它是**。但我不认为这很困难，因为 HTML 和 CSS 很难掌握，我认为这很困难，因为成为一名优秀的创意设计师很难。请抵制反射性地不同意我的冲动，因为我认为这种语言很简单。

作为一名设计师，我很烂，幸好这不是我的工作。不过，我可以拍摄一张照片购物的照片，并轻松地从中创建一个纯 HTML/CSS 网页。

我个人认为，**任何人都**可以在一周或两周的学习中成为一名有效的 HTML/CSS 大师。没有那么复杂（这是一个有多年经验的人）。

跨浏览器编码并不像人们说的那么难。我在 Firefox 中开发，并为 IE 进行了调整，我完成了，一个好的 CSS 重置可以处理 99% 的问题。

你不同意这一点吗？HTML和CSS是不是一个星期就学不好？

编辑：这与我在这里严重否决的答案有关：[招聘时测试 HTML/CSS/Javascript 技能](https://stackoverflow.com/questions/198337/testing-htmlcssjavascript-skills-when-hiring#198344)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-10-13T20:35:28.143

“HTML和CSS不可能在一周内学好吗？”

总之，**是**的。

您可以按照“24 小时内学习 html”之类的内容编写基本页面吗？绝对地。你会知道它为什么起作用或不起作用 - 可能不是。

“......一个好的 CSS 重置可以处理 99% 的问题。” 可能。**为什么**会这样可能远远超出*一周的学习时间*。

*   找到可以处理 99% 问题的通用 CSS 重置 - 免费
*   处理另外 1% - 无价之宝！

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-10-13T18:38:45.527

HTML 和 CSS 在语法上是非常简单的语言。正确有效地使用它们一点也不简单。

HTML 的最佳实践并不完全清楚，而且很少使用它们。学习这些东西需要时间，而不仅仅是学习语言。

出于基本目的，CSS 非常简单。对于复杂的设计，它是极其不简单的。当你考虑浏览器的怪癖时，它变得非常不简单。

从纯理论的角度来看，它们很容易。从现实世界使用的角度来看，它们不是。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-13T18:41:38.623

HTML 作为一种纯粹的描述性语言，几乎是微不足道的。CSS 都是关于副作用的，视觉上的副作用，并且至少比学习更难一个数量级。我非常怀疑*任何人都*可以在一周内成为 CSS 大师（根据您的定义），即使是那些编写规范的人。对此有太多不同的解释和使用扩展（例如浮点数）。

PS 你*知道*你主页后面的 HTML 和 CSS 验证失败，不是吗？;-)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-13T18:37:58.333

恕我直言，**浏览器不兼容**是它困难的主要原因。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-13T19:07:17.263

我对这个问题的回答是：这一定很难，因为我仍然看到一大堆垃圾标记和 css。更具体地说，语义标记是有细微差别的，并且有些主观（您应该使用标题和列表，还是定义列表？答案并不总是黑白的）。

知道如何使用 html 和 css 是一回事，但真正理解语义是另一回事。在我看来，这并不太难，但缺乏理解似乎持续存在于骇人听闻的丰富中。

我每天使用语义标记和 CSS 工作 8 小时以上，从小型网站到复杂的应用程序。我认为按照您的建议，在几周内学习和理解 html 和 css 的语法相对容易，但是需要大量的经验和研究才能达到一个真正可以抽象思考的地步（高度准确） ) 关于给定设计组合的最佳、最灵活和最语义标记是什么，以及给定设计可能会遇到哪些跨浏览器问题。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-13T18:40:41.480

> 你不同意这一点吗？HTML和CSS是不是一个星期就学不好？

是的，我几乎可以肯定。尽管我分享了您与实施相关的经验：

> 不过，我可以拍摄一张照片购物的照片，并轻松地从中创建一个纯 HTML/CSS 网页。

给定一个好的参考或一些先验知识，这并不是那么难，当然比通常声称的要少*得多（！），如果模拟有什么好处的话。*

然而，这：

> 跨浏览器编码并不像人们说的那么难。

是错误的，以我的经验。这在很大程度上取决于您正在使用的模拟：如果它是由 Web 开发人员设计并针对 Web 开发进行了优化，那么实现可能很容易。然而，图形设计可能是任意复杂的，并且在关注潜水员浏览器怪癖的同时有意义地实现它们是非常费力的。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-10-14T01:24:38.577

> 我个人认为，任何人都可以在一周或两周的学习中成为一名有效的 HTML/CSS 大师。

我什至认为这句话没有意义（除了你对“信仰”这个词的困惑之外）——当我们称人们为“大师”时，我们的意思是，一个拥有丰富、深刻的知识和经验的人，一个头脑和肩膀的人高于其余部分。如果有人可以在两周内成为大师，那么就没有大师了。

无论如何，我将您诊断为第二阶段的新手：您已经过了一定的水平，并且您认为您已经掌握了该主题。你缺乏谦逊。

我建议你继续在 HTML 和 CSS 领域工作，你会发现有很多有趣的问题你不知道如何解决；您会发现有非常聪明的人以您从未想过的有趣方式解决了这些问题；而且您还会发现有许多不同的方法可以达到相同的目的——您知道的方法可能有效，但可能有更聪明的方法来优化、改进或简化您的 HTML/CSS。

我会把你写在我 2009 年 10 月的日记里，我们会看看你的感受。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-14T02:49:19.077

我认为，如果我们将 HTML/CSS 语言的复杂性与编程语言或框架的复杂性进行讨论，那是毫无争议的。HTML/CSS 易于编写，语法和规则易于**记忆**。

但就像编程语言一样，语法并不像它的使用方式那么重要。尝试将 CSS 视为一系列相互构建的布局规则——这些规则的构建方式很大程度上取决于页面的行为。一个优秀的 CSS 开发人员将能够将一个 Photoshop 模型转换为一个不仅看起来不错，而且在动态内容的需求下表现良好的页面。CSS 设计师面临的挑战不是编写代码，而是在设计的各个部分之间进行权衡，以平衡页面的功能行为与其美学要求。

就像任何语言一样，CSS 设计有自己的最佳实践、技术和设计模式（这可以追溯到[我最初提出问题](https://stackoverflow.com/questions/198337/testing-htmlcssjavascript-skills-when-hiring)的原因）。

更重要的是，前端布局技能中男人与男孩（或女人与女孩）的区别在于他们对浏览器布局的概念和机制的理解程度，如[本文](http://www.w3.org/TR/CSS21/)所述。[对视觉格式化模型](http://www.w3.org/TR/CSS21/visuren.html)的深入理解是很多人迷失的地方。更不用说跨浏览器的东西了。

如果您认为这些东西是蛋糕，那么对您来说更有力量。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-13T18:43:38.183

与任何事情一样，熟能生巧。我发现随着我使用有效的 HTML 和 CSS 开发的网站越多，使它们跨浏览器变得越容易。你会更加意识到问题，更加意识到怪癖，并且能够提前避开它们。随着时间的推移，它变得更容易。但是，如果你没有人从一开始就指出所有这些，我认为这根本不是一件容易的事，如果你不知道去哪里看或问谁，这可能会非常令人沮丧。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-13T18:45:06.790

“掌握” HTML 和 CSS 很容易——它们的语义都很简单。通过这种方式，掌握绘画就更容易了——只需在画布上擦一些颜料就可以了。语法几乎是任何计算机任务中最简单的部分——学习*如何*使用它要困难得多。

自 1996 年左右以来，我一直是一名 Web 开发人员。我从一开始就了解 HTML，以及 CSS 和 Javascript，因为它们已经被普遍使用。当我设计一个页面时，它仍然看起来像垃圾——语法正确的垃圾，但仍然不是很愉快。这就是为什么我真的很高兴与能够为我处理外观和感觉部分的才华横溢的设计师合作。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-13T18:46:07.787

网页设计是一个棘手的主题，您已经将其范围缩小到 HTML 和 CSS。这几乎就像说编程很容易，因为您了解 SSADM（其他方法可用）。

当然，制作 HTML 页面并使用 CSS 加载它很简单，但从来都不是一件容易的事。在两周内，我严重怀疑您是否能够在 Photoshop 中编写任何给您的布局。就我而言，网页设计涉及整个创建过程，包括在您使用的任何光栅程序中创建设计，然后用 (X)HTML 和 CSS 对其进行编码。一旦制作了这个外壳，开发人员就可以处理后端脚本和编程。

网页设计是一门困难的学科，因为它变化很大，就像编程一样，你永远不会停止学习做某事的新方法。如果您还没有，请查看 W3C 规范，看看您真正了解多少。

如果您发现 HTML 和 CSS 如此简单，那么您可能想看看[SitePoint 论坛](http://www.sitepoint.com/forums)。你要么对网页设计社区有很大的帮助，要么你会意识到你并不像你想象的那么好。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-13T18:47:28.783

我的观点是这不是语言本身 - (X)HTML 和 CSS 相当简单，并且有很多很好的参考资源。更困难的是找出用编写良好的 HTML/CSS 实现设计概念的最佳方法。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-14T07:13:54.487

作为一个新手说：我今年8月开始学习xhtml/css，一个月每天花12个小时，设法建立了我的作品集，仍然太重，在IE中不能正常工作——我仍然认为它是一个测试项目。在 30 天内，我学到的东西比你想象的要多得多，要真正做到这一点，我需要两周以上的时间！

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-13T18:45:57.803

使用语义标记和良好的 CSS 构建网站最终更容易，然后返回并更改使用 10 层嵌套表格、1 像素透明 gifs（用于间距）和非标准`<font>`标签设计的网页设计来改变文本的外观。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-13T19:32:48.473

不要低估 HTML 和 css 的复杂性。是的，它们很容易学习，但掌握它们需要大量的智慧。

当您在游戏中玩了一段时间后，以下 HTML 和 css 示例的不同方法是大量的。

```
#header h1 { font-size: 2em; }
<div id="header">
  <h1>Title</h1>
<div> 
```

和

```
.title { font-size: 2em; }
<div id="header">
  <h1 class="title">Title</h1>
<div> 
```

选择是否使用类或 ID，或者是否松散地定义您的样式将严重影响您获得强大的健壮网站的能力。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-14T08:01:15.390

就像其他人所说的那样，学习“如何”相对容易，但“为什么”需要经验，而经验需要时间来获得。

一个有趣的站点是[http://csszengarden.com](http://csszengarden.com)，其中的挑战是使用完全相同的 HTML，并且只使用 CSS，修改页面以使其看起来与其他示例非常不同。值得一看。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-02-11T13:12:49.630

哇，我一定真的很慢，我花了大约一年的时间来掌握 CSS - 只是学习它并捏造它，可能需要几个星期，但真正了解细节就像一年......

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-02-11T13:21:55.363

*编写好的*跨浏览器基于 css 的网站需要相当多的经验。主要原因是在您这样做的过程中，您会发现越来越多的浏览器特定问题。通过构建许多基于标准的网站，您将获得完全避免这些的经验。

第一阶段通常是人们所说的“div 狂热（95% 的内容使用 div）”，对于 Firefox 和 IE，这可能在一周内学会。之后，人们开始为他们的内容使用更符合语义的标签，并删除无意义的标签。

在这个阶段之后，人们对垂直居中和表单设计等更难的问题变得更加熟练（难以*实现*像素精度[http://www.456bereastreet.com/archive/200409/styling_form_controls/](http://www.456bereastreet.com/archive/200409/styling_form_controls/)）。

真正的大师可以做所有这些事情，也能够使用最少的 css 规则并使用非常有效的图像策略，例如 sprites。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-03-02T00:38:54.623

掌握 CSS 肯定需要超过几周的时间。

使用重置文件或框架意味着您可能能够在这段时间内将一些非常可靠的东西拼凑在一起，但对于为什么它会正常工作却知之甚少，当您遇到未涵盖的问题时，这些问题会再次困扰您你的框架。

...或者我只是在为自己的无能找借口...（愚蠢的 IE）

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-05-20T20:30:52.237

这真的取决于你在一周内的目标是什么。您可以在一天内学习 HTML，然后在一周内学习 CSS。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-07-21T23:21:54.073

学习如何使用斧头只需要一分钟，但学习如何雕刻独木舟则需要数年时间。

我已经这样做了 11 年，而且由于框架、打包的 CMS、AJAX 等等，它变得越来越难。相比之下，浏览器兼容性是小菜一碟。

例如，现在我正在使用 OpenLayers 插件开发 Drupal 站点。在我什至开始使它看起来像 Drupal 中的 OpenLayers 之外的东西之前，我有近 2000 行 CSS 由这些框架提供。每个人都在超载其他人，创建了一个微妙的 CSS 本轮。（尝试在 Gmail 中触发标签按钮来体验一下。）

所以是的：HTML/CSS 很简单。一个周末就学会了围棋的所有规则，我是高手了吗？

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2015-06-25T10:32:38.393

这个问题是 6 年前提出的，但即便如此，我也不认为这是真的。我把它比作单板滑雪。几乎任何人都可以在一周的课程后站起来并开始做一些转弯。学习曲线非常容易。然而，一旦你掌握了基础知识，你需要多年的练习才能完成 1080 的大跳跃。

Similarly, CSS and HTML are easy but I'm still learning new things all the time and figuring out better ways to do things.

# apache - 如何将 Apache 配置为 j2ee 服务器的代理（负载均衡器）？

> ID：198564
> 
> 赞同：6
> 
> 时间：2008-10-13T18:37:26.340
> 
> 标签：apache, jakarta-ee, mod-proxy

我将 apache Web 服务器安装为前端，并在 Intranet 服务器中安装了 j2ee SAP Netweaver 应用程序服务器。如何配置 apache 以向/来自 j2ee 应用服务器转发请求和响应。例如，外部 apache 服务器的 ip 是 9.20.1.1:80。内部 sap 服务器的地址是 192.168.0.1/sap/bc/gui/sap/its/webgui?sap_client=200 我想访问我的 sap 应用程序服务器，例如 9.20.1.1/sapserver/sap/bc/gui/sap/its/ webgui?sap_client=200

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-14T17:39:40.293

您提到了负载平衡 - 所以大概您希望能够添加更多通过单个地址提供服务的应用程序服务器。我希望它们是无状态的或将会话信息存储在数据库中。您可以使用 Apache 作为反向代理负载均衡器`mod_proxy_balancer`。文档在[这里](http://httpd.apache.org/docs/2.2/mod/mod_proxy_balancer.html)。

[这是一个从这个链接](http://blog.innerewut.de/2006/4/21/scaling-rails-with-apache-2-2-mod_proxy_balancer-and-mongrel)添加到你的 httpd.conf 的例子。

```
 <Proxy balancer://myclustername>
  # cluster member 1
  BalancerMember http://192.168.0.1:3000 
  BalancerMember http://192.168.0.1:3001

  # cluster member 2, the fastest machine so double the load
  BalancerMember http://192.168.0.11:3000 loadfactor=2
  BalancerMember http://192.168.0.11:3001 loadfactor=2

  # cluster member 3
  BalancerMember http://192.168.0.12:3000
  BalancerMember http://192.168.0.12:3001

  # cluster member 4
  BalancerMember http://192.168.0.13:3000
  BalancerMember http://192.168.0.13:3001
</Proxy>

<VirtualHost *:80>
  ServerAdmin info@meinprof.de
  ServerName www.meinprof.de
  ServerAlias meinprof.de
  ProxyPass / balancer://meinprofcluster/
  ProxyPassReverse / balancer://meinprofcluster/
  ErrorLog /var/log/www/www.meinprof.de/apache_error_log
  CustomLog /var/log/www/www.meinprof.de/apache_access_log combined
</VirtualHost> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-13T18:53:25.043

这通常被错误地称为反向代理。如果您使用搜索引擎查找“反向代理 apache”，您会得到很多不错的结果。

快速的答案是将这样的内容添加到您的 apache.conf

> ProxyPass /sap/ 192.168.0.1/sap/
> 
> < 位置 /sap/ >
> 
> ```
>  ProxyPassReverse /sap/ 
> ```
> 
> </位置>

另请参阅 modrewrite rools 和 [P] 选项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-13T18:47:56.800

假设您启用了 mod_proxy，请添加到您的站点可用：

```
 ProxyRequests Off
   <Location "/sapserver">
        ProxyPass http://192.168.0.1
        ProxyPassReverse http://192.168.0.1
   </Location> 
```

不过要小心，因为这确实会将您的内部网站暴露给整个互联网。

# excel - 将 Excel 数据导出到 Matlab 的最简单方法是什么？

> ID：198568
> 
> 赞同：7
> 
> 时间：2008-10-13T18:38:03.203
> 
> 标签：excel, matlab, export

以编程方式将 Excel 数据导出到 Matlab 的最简单方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-13T19:07:14.470

如果您在安装了 Excel 的 Windows 上运行 Matlab，请尝试[XLSREAD](http://www.mathworks.com/access/helpdesk/help/techdoc/index.html?/access/helpdesk/help/techdoc/ref/xlsread.html)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-13T18:39:31.593

如果 Excel 文件中没有太多文本注释，请将其保存为 csv，然后使用 MATLAB 函数 csvread。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-03-09T21:51:35.643

在最近的 Matlab 版本中，还有可以在 Excel 中`csvread()`轻松`writetable()`打开的 csv。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-13T18:41:31.353

只需花一点钱，您就可以获得 MATLAB 附加 Excel 链接，它提供了一个干净整洁的界面，用于在两个程序之间来回传输数据。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-18T00:44:01.543

如前所述，XLSREAD 是这项工作的正确功能。在非 Windows 系统上，它也可以在没有安装 Excel 的情况下工作。但是，据说它缺少一些 Excel 高级功能。

# java - “java -server”和“java -client”之间的真正区别？

> ID：198577
> 
> 赞同：414
> 
> 时间：2008-10-13T18:40:13.260
> 
> 标签：java, jvm, jvm-hotspot

“java -server”和“java -client”之间有什么真正的实际区别吗？

我在 Sun 的网站上只能找到一个模糊的

> “-server 启动速度较慢，但​​应该运行得更快”。

真正的区别是什么？（目前使用 JDK 1.6.0_07。）

* * *

## 回答 #1

> 赞同：388
> 
> 时间：2008-10-13T18:57:45.393

这实际上与*HotSpot*和客户端和服务器配置之间不同的默认*选项值*（[Java HotSpot VM Options ）相关联。](http://www.oracle.com/technetwork/java/javase/tech/vmoptions-jsp-140102.html)

来自白皮书的[第 2 章（](http://www.oracle.com/technetwork/java/whitepaper-135217.html#2) [Java HotSpot 性能引擎架构](http://www.oracle.com/technetwork/java/whitepaper-135217.html)）：

> JDK 包括两种类型的 VM——客户端产品和针对服务器应用程序调整的 VM。这两个解决方案共享 Java HotSpot 运行时环境代码库，但使用适合客户端和服务器明显独特的性能特征的不同编译器。这些差异包括编译内联策略和堆默认值。
> 
> 尽管服务器虚拟机和客户端虚拟机相似，但服务器虚拟机已经过专门调整，以最大限度地提高峰值运行速度。它旨在执行长时间运行的服务器应用程序，这些应用程序需要尽可能快的运行速度，而不是快速启动时间或更小的运行时内存占用。
> 
> 客户端 VM 编译器用作经典 VM 和早期版本 JDK 使用的即时 (JIT) 编译器的升级。客户端 VM 为应用程序和小程序提供了改进的运行时性能。Java HotSpot 客户端 VM 经过专门调整，可减少应用程序启动时间和内存占用，使其特别适合客户端环境。一般来说，客户端系统更适合 GUI。

所以真正的区别也在于编译器级别：

> 客户端虚拟机编译器不会尝试执行服务器虚拟机中的编译器执行的许多更复杂的优化，但作为交换，它需要更少的时间来分析和编译一段代码。这意味着客户端 VM 可以更快地启动并且需要更小的内存占用。
> 
> 服务器 VM 包含一个高级自适应编译器，它支持通过优化 C++ 编译器执行的许多相同类型的优化，以及一些传统编译器无法完成的优化，例如跨虚拟方法调用的激进内联。这是相对于静态编译器的竞争和性能优势。自适应优化技术的方法非常灵活，通常甚至优于高级静态分析和编译技术。

注意：*jdk6 update 10*的发布（请参阅[更新发布说明：1.6.0_10 中的更改](http://www.oracle.com/technetwork/java/javase/6u10-142936.html)）试图改善启动时间，但与热点选项不同的原因是，使用更小的内核以不同的方式打包。

* * *

[G. Demecki](https://stackoverflow.com/users/1037316/g-demecki)[在评论](https://stackoverflow.com/questions/198577/real-differences-between-java-server-and-java-client/198651?noredirect=1#comment59707599_198651)中指出，在 JDK 的 64 位版本中，该`-client`选项被忽略了很多年。
请参阅[Windows`java`命令](https://docs.oracle.com/javase/7/docs/technotes/tools/windows/java.html)：

```
-client 
```

> 选择 Java HotSpot 客户端 VM。
> **支持 64 位的 JDK 当前忽略此选项，而是使用 Java Hotspot Server VM**。

* * *

2022：[Holger在](https://stackoverflow.com/users/2711488/holger)[评论](https://stackoverflow.com/questions/198577/real-differences-between-java-server-and-java-client/198651?noredirect=1#comment124789844_198651)中引用了[JavaSE6 / Server-Class Machine Detection](https://docs.oracle.com/javase/6/docs/technotes/guides/vm/server-class.html)，并补充说：

> 只有在 32 位 Windows 系统上，`-client`才会无条件选择。
> 其他系统检查机器是否为“服务器类”，当具有至少 2 个内核和至少 2GiB 内存时，该机器是否满足。
> 
> 这就解释了为什么现在几乎所有东西都使用`-server`了相当长的一段时间。即使是你能找到的最便宜的电脑，也是“服务器级”机器。Sun/Oracle 64 版本甚至没有附带客户端 JVM。

* * *

## 回答 #2

> 赞同：91
> 
> 时间：2012-08-17T10:17:39.723

旧版本 Java 中最明显的直接区别是分配给应用程序`-client`而不是`-server`应用程序的内存。例如，在我的 Linux 系统上，我得到：

```
$ java -XX:+PrintFlagsFinal -version 2>&1 | grep -i -E 'heapsize|permsize|version'
uintx AdaptivePermSizeWeight               = 20               {product}
uintx ErgoHeapSizeLimit                    = 0                {product}
uintx InitialHeapSize                     := 66328448         {product}
uintx LargePageHeapSizeThreshold           = 134217728        {product}
uintx MaxHeapSize                         := 1063256064       {product}
uintx MaxPermSize                          = 67108864         {pd product}
uintx PermSize                             = 16777216         {pd product}
java version "1.6.0_24" 
```

因为它默认为`-server`，但`-client`我得到的选项是：

```
$ java -client -XX:+PrintFlagsFinal -version 2>&1 | grep -i -E 'heapsize|permsize|version'
uintx AdaptivePermSizeWeight               = 20               {product}
uintx ErgoHeapSizeLimit                    = 0                {product}
uintx InitialHeapSize                     := 16777216         {product}
uintx LargePageHeapSizeThreshold           = 134217728        {product}
uintx MaxHeapSize                         := 268435456        {product}
uintx MaxPermSize                          = 67108864         {pd product}
uintx PermSize                             = 12582912         {pd product}
java version "1.6.0_24" 
```

所以这个版本`-server`的大部分内存限制和初始分配要高得多。`java`

然而，这些值可能会因架构、操作系统和 jvm 版本的不同组合而改变。最新版本的 jvm 删除了标志并重新删除了服务器和客户端之间的许多区别。

还请记住，您可以`jvm`使用`jvisualvm`. 如果您的用户或模块​​设置`JAVA_OPTS`或使用更改命令行选项的脚本，这将非常有用。这还可以让您实时监控*堆*和*永久*空间使用情况以及许多其他统计信息。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2015-08-07T11:54:36.430

-client 和 -server 系统是不同的二进制文件。它们本质上是两个不同的编译器 (JIT)，它们连接到同一个运行时系统。客户端系统最适合需要快速启动时间或占用空间小的应用程序，服务器系统最适合整体性能最重要的应用程序。一般来说，客户端系统更适合交互式应用程序，例如 GUI

[![在此处输入图像描述](https://i.stack.imgur.com/zkWjn.gif)](https://i.stack.imgur.com/zkWjn.gif)

我们使用两个开关运行以下代码：

```
package com.blogspot.sdoulger;

public class LoopTest {
    public LoopTest() {
        super();
    }

    public static void main(String[] args) {
        long start = System.currentTimeMillis();
        spendTime();
        long end = System.currentTimeMillis();
        System.out.println("Time spent: "+ (end-start));

        LoopTest loopTest = new LoopTest();
    }

    private static void spendTime() {
        for (int i =500000000;i>0;i--) {
        }
    }
} 
```

**注意：**代码只编译一次！两次运行的课程相同！

**使用 -client：**
java.exe -client -classpath C:\mywork\classes com.blogspot.sdoulger.LoopTest
花费时间：766

**使用 -server:**
java.exe -server -classpath C:\mywork\classes com.blogspot.sdoulger.LoopTest
花费时间：0

似乎服务器系统的更积极优化，删除循环，因为它知道它不执行任何操作！

[参考](http://www.javacodegeeks.com/2011/07/jvm-options-client-vs-server.html)

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2010-09-23T06:11:38.417

我刚刚注意到的一个区别是，在“客户端”模式下，JVM 似乎实际上将一些未使用的内存还给了操作系统，而在“服务器”模式下，一旦 JVM 获取了内存，它就不会给它背部。无论如何，这就是它在带有 Java6 的 Solaris 上的显示方式（`prstat -Z`用于查看分配给进程的内存量）。

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2013-03-18T07:15:06.647

Oracle 的在线文档提供了一些有关 Java SE 7 的信息。

在[java –](http://docs.oracle.com/javase/7/docs/technotes/tools/windows/java.html) Windows 的 Java 应用程序启动器页面上，该`-client`选项在 64 位 JDK 中被忽略：

> 选择 Java HotSpot 客户端 VM。支持 64 位的 jdk 当前忽略此选项，而是使用 Java HotSpot Server VM。

但是（为了让事情变得有趣），`-server`它指出：

> 选择 Java HotSpot 服务器虚拟机。在支持 64 位的 jdk 上，仅支持 Java HotSpot Server VM，因此 -server 选项是隐式的。这在未来的版本中可能会发生变化。

[Server-Class Machine Detection](http://docs.oracle.com/javase/7/docs/technotes/guides/vm/server-class.html)页面提供有关操作系统和体系结构选择的 VM 的信息。

我不知道这在多大程度上适用于 JDK 6。

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2016-03-10T10:29:43.507

来自 Goetz - Java 并发实践：

> 6.  调试提示：对于服务器应用程序，请务必`-server`在调用 JVM 时始终指定 JVM 命令行开关，**即使是开发和测试**。服务端 JVM 比客户端 JVM 执行更多的优化，比如将循环中没有被修改的变量提升到循环之外；看起来在开发环境（客户端 JVM）中工作的代码可能会在部署环境（服务器 JVM）中中断。例如，如果我们“忘记”在清单 3.4 中将变量 sleep 声明为 volatile，**服务器 JVM 可以将测试提升出循环（将其变成无限循环），但客户端 JVM 不会**。出现在开发中的无限循环的成本远低于仅出现在生产中的无限循环。

> 清单 3.4。数羊。
> 
> ```
> volatile boolean asleep;
> ...
> while (!asleep)
>    countSomeSheep(); 
> ```

我的重点。YMMV

* * *

## 回答 #7

> 赞同：15
> 
> 时间：2008-10-13T18:48:58.517

IIRC 服务器虚拟机在启动时进行了更多的热点优化，因此它运行得更快，但启动时间更长，并且使用了更多内存。客户端 VM 推迟了大部分优化以允许更快的启动。

编辑添加：[这是来自 Sun 的一些信息](http://java.sun.com/docs/hotspot/HotSpotFAQ.html#compiler_types)，它不是很具体，但会给你一些想法。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-10-13T18:57:26.533

IIRC，它涉及垃圾收集策略。理论上，客户端和服务器在短期对象方面会有所不同，这对于现代 GC 算法很重要。

[这是](http://www.jivesoftware.com/community/docs/DOC-1486)服务器模式的链接。唉，他们没有提到客户端模式。

这是一个关于GC[的非常彻底的链接；](http://www.artima.com/insidejvm/ed2/gc.html)这是一篇[比较基础的文章](http://chaoticjava.com/posts/how-does-garbage-collection-work/)。不确定地址 -server 与 -client 是否之一，但这是相关材料。

在 No Fluff Just Stuff 上，Ken Sipe 和 Glenn Vandenburg 都就这类事情进行了精彩的演讲。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-13T18:45:07.493

我没有注意到两者之间的启动时间有任何差异，但是使用“-server”（Solaris 服务器，每个人都使用 SunRays 运行应用程序）对应用程序性能的改进非常小。那是在1.5以下。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-03-22T14:53:23.163

上次我看了这个，（诚然，这是不久前的事了）我注意到的最大区别在于垃圾收集。

IIRC：

*   服务器堆虚拟机的代数与客户端虚拟机不同，垃圾收集算法也不同。**这可能不再是真的**
*   服务器虚拟机将分配内存而不将其释放给操作系统
*   服务器虚拟机将使用更复杂的优化算法，因此对优化有更大的时间和内存需求

~~如果您可以使用[jvisualvm](http://visualvm.java.net/)工具比较两个 java VM，一个客户端，一个服务器，您应该会看到垃圾收集的频率和效果以及代数方面的差异。~~

~~我有两张截图可以很好地显示差异，但我无法重现，因为我有一个 64 位 JVM，它只实现了服务器 VM。（而且我也懒得在我的系统上下载和争论 32 位版本。）~~

这似乎不再是这种情况了，尝试在具有服务器和客户端 VM 的 Windows 上运行一些代码后，我似乎得到了相同的生成模型......

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-03-22T07:46:45.477

当从 1.4 迁移到 1.7("1.7.0_55") 版本时。我们在这里观察到的是，在客户端和服务器模式下分配给 heapsize|permsize|ThreadStackSize 参数的默认值没有这种差异。

顺便说一句，（[http://www.oracle.com/technetwork/java/ergo5-140223.html](http://www.oracle.com/technetwork/java/ergo5-140223.html)）。这是从上面的链接中截取的片段。

```
initial heap size of 1/64 of physical memory up to 1Gbyte
maximum heap size of ¼ of physical memory up to 1Gbyte 
```

ThreadStackSize 在 1.7 中更高，通过 Open JDK 论坛，有讨论说 1.7 版本的帧大小略高。相信可以根据您的应用程序的行为在运行时测量真正的差异

# iis-7 - 共享环境中 IIS7 中应用程序池回收的最佳设置是什么？

> ID：198580
> 
> 赞同：34
> 
> 时间：2008-10-13T18:41:04.850
> 
> 标签：iis-7, application-pool, recycle

在共享环境中，IIS7 中应用程序池回收的最佳设置是什么？

![在此处输入图像描述](https://i.stack.imgur.com/RNQo8.png)

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-10-14T16:08:02.053

作为 Hoster，您肯定希望回收内存和时间、可能的请求限制和 CPU。您希望对这些限制非常积极，但请确保将它们发布给您的客户。

[**内存**](https://technet.microsoft.com/en-us/library/cc725749(v=ws.10).aspx)- x86 机器为 512，可能为 768。对于 x64，您可以根据每台服务器的主机数量将其设置得更高。您只需要小心并观察您的应用程序池在内存问题上的回收事件。

[**时间**](https://technet.microsoft.com/en-us/library/cc754494(v=ws.10).aspx)- 我们通常在凌晨 1 点进行回收，正负（第一个站点 1:01，第二个 1:11，第三个 1:21，这样您就不会同时进行所有回收）

[**请求限制**](https://technet.microsoft.com/en-us/library/cc770469(v=ws.10).aspx)- 35,000 是 IIS6 的默认值，但这个数字非常随意，并且非常依赖于相关站点。对于小型使用站点，每晚回收将在您收到 35k 请求之前很久。

[**CPU**](http://www.iis.net/configreference/system.applicationhost/applicationpools/add/cpu) - 95%/1 分钟限制/KillW3WP，但请谨慎使用。我对此的理解是，如果 CPU 在此工作进程的 1 分钟限制上达到 95%+，则当 Action 设置为 KillW3WP 时，工作进程将被终止并且在剩余的限制内无法重新启动。您最初可能想尝试 NoAction，然后仔细查看您的事件日志。

[**回收事件日志**](https://technet.microsoft.com/en-us/library/cc771318(v=ws.10).aspx)- 您要确保为您设置的每个事件阈值记录应用程序池回收 - 即，如果您根据请求限制进行限制，请确保启用请求限制日志记录。

要记住的一件事是，您*应该在*[machine.config](http://www.iis.net/learn/get-started/planning-your-iis-architecture/the-configuration-system-in-iis-7)`retail="true"`的`<deployment>`元素中进行设置：

```
<system.web>
    <!--
        <deployment
            retail = "false" [true|false]
        />
    -->
    <deployment retail="true" />
</system.web> 
```

不设置这将允许站点打开调试，这允许请求中无限超时 - 对于托管商来说并不完全理想......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-13T18:43:10.663

提示：当你回收你的应用程序时，你所有的会话变量都会被销毁......所以要小心！

恕我直言，保留默认值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-13T18:56:04.040

如果您的站点交通繁忙，请使用较长的回收计划。如果您的站点流量较低，请使用较短/默认的时间表来节省内存。

我从 Al Zabir 的博客中了解到这一点：http: [//msmvps.com/blogs/omar/archive/2008/10/04/best-practices-for-creating-websites-in-iis-6-0.aspx](http://msmvps.com/blogs/omar/archive/2008/10/04/best-practices-for-creating-websites-in-iis-6-0.aspx)

Daniel S. 是对的，您的会话变量在回收时会被破坏，因此请确保您对此进行了良好的测试或在获取会话对象时具有良好的错误保护/恢复。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-12-20T11:44:14.063

您需要根据您的需要进行设置，考虑您拥有的内存量和站点/Web 应用程序的使用高峰时间。

还要考虑您的站点/Web 应用程序的内存使用情况，就好像存在内存泄漏一样，您可能比您想象的更频繁地回收。

权衡任何泄漏与回收成本，如上所述，您将丢失状态变量。

# algorithm - 软件开发中的非确定性有限状态机？

> ID：198581
> 
> 赞同：8
> 
> 时间：2008-10-13T18:41:20.420
> 
> 标签：algorithm, language-agnostic, math, state-machine

最近我一直在考虑*有限状态机*(FSM)，以及如何在软件中实现它们（编程语言无关紧要）。

我的理解是*确定性状态机*被广泛使用（解析器/词法分析器、编译器等），但*非确定性状态机*有什么问题？

我知道可以*将*所有非确定性状态机转换为确定性状态机（甚至以编程方式）。那不是我的意思。我还认为非确定性状态机的实现要复杂得多。

无论如何，实现非确定性状态机是否有意义**？**有什么我不知道的特殊应用吗？这样做的原因是什么？也许优化和专门的非确定性状态机更快？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-13T18:44:18.430

大多数正则表达式引擎使用*非*确定性自动机，因为它们提供了更大的灵活性。DFA 受到更多限制。看看一些实现，你会看到这一点。[微软甚至在他们的 .NET Regex](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regex%28VS.80%29.aspx)类文档中强调了这一事实：

> .NET Framework 正则表达式引擎是一个回溯正则表达式匹配器，它结合了传统的非确定性有限自动机 (NFA) 引擎，例如 Perl、Python、Emacs 和 Tcl 使用的引擎。

[匹配行为](http://msdn.microsoft.com/en-us/library/0yzc2yb0%28VS.80%29.aspx)（第一段）——本文还提供了使用 NFA 而不是更有效的 DFA 的理由。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-13T18:52:25.263

如您所知，NFA 和 DFA 在计算上是等价的。这是自动机理论中最早的定理之一。有一些算法可以将一个转换为另一个（与下推或图灵机不同）。

所以。为什么一个比另一个？因为用 NFA 表示给定问题比等效的 DFA 容易得多。

**编辑：**就实际计算机器而言，DFA 会走得更快，因为它们不必回溯。但是它们会占用更多的内存来表示。（内存与 CPU 的权衡）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-28T12:37:06.573

我的建议 = 看看[Adrian Thurstons Ragel](http://www.complang.org/ragel/)的手册。

有一些直接生成 DFA 的简单方法，但我相信它们只支持有限范围的运算符——基本上是 EBNF 通常的嫌疑人。Ragel 使用非确定性方法从更简单的自动机组成复杂的自动机，然后使用 epsilon 消除和最小化来创建有效的确定性自动机。无论您需要多少奇怪的运算符，到最小确定性自动机的转换总是相同的，并且每个运算符的实现都通过使用非确定性方法保持简单。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T18:45:40.333

[Cayuga](http://www.cs.cornell.edu/bigreddata/cayuga/)在底层利用非确定性有限状态机进行复杂事件处理。好吧，看起来他们称之为“用于事件监控的有状态发布/订阅”，但我相信它是 CEP。

我相信他们的一些论文甚至讨论了他们为什么使用自动机模型。您可能想浏览他们的网站。

> ...卡尤加自动机，从标准的非确定性有限自动机扩展而来。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-13T20:26:33.887

维特[比算法](http://en.wikipedia.org/wiki/Viterbi_algorithm)通过将[隐马尔可夫模型](http://en.wikipedia.org/wiki/Hidden_Markov_Model)视为 NFA 来对它们进行操作。不完全相同，但肯定是类似的。

它们在语音和文本识别等应用程序中很有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-16T13:50:31.510

很多时候，创建 NFA 然后使用它要容易得多（唯一的区别是您拥有一组状态而不是一个状态）。如果你想快速获得它，你可以做 DFA，但不要忘记，做它的时间是指数级的（因为生成的自动机可以指数级地变大！）。

另一方面，如果你想做一个补语，你别无选择，你需要一个 det。变体。

这就是为什么否定不在正则表达式引擎中，仅在类（[^...]）中的原因，您可以确定自动机是确定性的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-26T16:03:14.933

如果我错了，请纠正我，但从我的编译器类中，我记得有时你根本不能使用 DFA，因为它会导致状态“爆炸”。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-26T16:23:55.033

我认为选择非确定性有限自动机的主要原因是实际获得选择的匹配。使用确定性版本可能更难做到这一点。

如果您只想知道它们是否匹配，并且没有其他细节，我认为编译成有限自动机会更好。

# asp.net - Can I use commas in a URL?

> ID：198606
> 
> 赞同：47
> 
> 时间：2008-10-13T18:46:20.970
> 
> 标签：asp.net, iis, url, url-rewriting

I typically use URL rewriting to pass content IDs to my website, so this

```
 Foo.1.aspx 
```

rewrites to

```
 Foo.aspx?id=1 
```

For a specific application I need to pass in multiple IDs to a single page, so I've rewritten things to accept this:

```
 Foo.1,2,3,4,5.aspx 
```

This works fine in Cassini (the built-in ad hoc web server for Visual Studio) but gives me "Internet Explorer cannot display the webpage" when I try it on a live server running IIS. Is this an IIS limitation? Should I just use dashes or underscores instead of commas?

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2008-10-13T20:07:08.547

Commas are allowed in the filename part of a URL, but are reserved characters in the domain*, as far as I know.

What version of IE are you using? I've come across the odd report of IE5.5 truncating URLs on a comma ([link here](http://kb.adobe.com/selfservice/viewContent.do?externalId=326072), but have tested URLs with commas in IE7 and it seems to be OK, so if there was an IE bug, it doesn't seem to be there any more - could it be an IIS issue?

I'm wondering if the page error is due to a rule failure with the `mod_rewrite` - can you post the rule which is matching multiple ids and passing them off to your `Foo.aspx`? Is there any chance that it's only matching `Foo.N,N`, and failing on more commas?

* * *

* From the [URI RFC](http://www.ietf.org/rfc/rfc2396.txt):

> 2.2\. Reserved Characters
> 
> Many URI include components consisting of or delimited by, certain special characters. These characters are called "reserved", since their usage within the URI component is limited to their reserved purpose. If the data for a URI component would conflict with the reserved purpose, then the conflicting data must be escaped before forming the URI.
> 
> ```
>  reserved    = ";" | "/" | "?" | ":" | "@" | "&" | "=" | "+" |
>                 "$" | "," 
> ```
> 
> The "reserved" syntax class above refers to those characters that are allowed within a URI, but which may not be allowed within a particular component of the generic URI syntax

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2008-10-13T22:37:29.257

I recall that Url Routing by default first checks to see if the file exists, and commas are not legal in filenames, which is parhaps why you are getting errors. IIS may have legacy code that aborts the request before it can get to asp.net for processing.

Scott Hanselman's [blog post](http://www.hanselman.com/blog/PlugInHybridsASPNETWebFormsAndASPMVCAndASPNETDynamicDataSideBySide.aspx) talks a bit about this and may be relevant for you.

* * *

As general comment: Url rewriting is typically used to make a url friendly and easy to remember.

`~/page.aspx?id=1,2,3,4` is neither worse nor better than `~/page/1-2-3-4.aspx` : both are difficult to use so why go through the extra effort? Avoid creating new url forms just because you can. Users, help desk, and other developers will just be confused.

Url rewriting is best utilized to transform

```
~/products/view.aspx?id=1
~/products/category.aspx?type=beverage 
```

into

```
~/products/view/1
~/products/category/beverage 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-12-22T20:35:13.733

Try using `%2c` in the URL to replace the commas.

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-07-22T01:55:29.150

In addition to the answer by ConroyP, below is another citation to the RFC. It notes a number of unsafe characters, but does not mention the comma (suggesting that the comma is safe):

> Characters can be unsafe for a number of reasons. The space character is unsafe because significant spaces may disappear and insignificant spaces may be introduced when URLs are transcribed or typeset or subjected to the treatment of word-processing programs. The characters "<" and ">" are unsafe because they are used as the delimiters around URLs in free text; the quote mark (""") is used to delimit URLs in some systems. The character "#" is unsafe and should always be encoded because it is used in World Wide Web and in other systems to delimit a URL from a fragment/anchor identifier that might follow it. The character "%" is unsafe because it is used for encodings of other characters. Other characters are unsafe because gateways and other transport agents are known to sometimes modify such characters. These characters are "{", "}", "|", "\", "^", "~", "[", "]", and "`".
> 
> All unsafe characters must always be encoded within a URL. For example, the character "#" must be encoded within URLs even in systems that do not normally deal with fragment or anchor identifiers, so that if the URL is copied into another system that does use them, it will not be necessary to change the URL encoding.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-13T18:53:34.637

The comma is allowed in the path, query string and fragment according to spec. It wouldn't surprise me if IE doesn't conform to the spec though. Try the entity as Claudiu suggests, but I don't know why that would be necessary.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-13T20:18:46.727

### Answer

The problem was the commas. I'm guessing that IIS was having an issue with it (not IE) since IE was able to display it fine on localhost.

At any rate I just changed the URL format to this and it works fine:

```
Foo.1-2-3-4-5.aspx 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-13T21:22:19.673

If you'd put in place a front controller then you could do something like;

```
index.aspx?c=Foo/1/2/3/4 
```

The Front Controller would pick up the method name and the parameters to pass to it. This is a pretty common technique nowadays.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-13T18:49:45.020

The right way to *accept* multiple ids is like this:

```
Foo.aspx?id=1;id=2;id=3;id=4;id=5 
```

Note that's just what the target is. When re-writing urls, you can set your own rules to a certain extent for what you want the source to look like.

I had to learn this on StackOverflow, too. See this question:
[Split out ints from string](https://stackoverflow.com/questions/63463/split-out-ints-from-string)

# algorithm - Smalltalk 的图论库

> ID：198608
> 
> 赞同：6
> 
> 时间：2008-10-13T18:47:16.430
> 
> 标签：algorithm, graph-theory, smalltalk

有人知道 Smalltalk 中图算法的实现吗？

我想要一些允许您在模型对象或其他东西上实现接口并提供传递闭包、传递减少、拓扑排序等算法的东西。

人们最终会经常重新实现这些广泛适用的算法，如果有一个每个人都可以使用的通用实现，那就太好了。

我猜，指向可以移植的其他（最好是 OO）语言的类似库的指针也很有用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-14T13:16:07.813

I don't know if it has everything you need (and it includes a whole lot of other stuff), but the Jun library (GPL Licensed) might be a good place to start. It's shipped as part of the standard NC version of VisualWorks, not sure about the other Smalltalks. The package you'd be interested in is called Jun-Topology-Graph.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-14T14:49:15.380

对于 Squeak，请查看声称是图形库的[http://www.squeaksource.com/Graph.html](http://www.squeaksource.com/Graph.html)，如“这些类添加了一个集合类别来表示集合，这些集合不一定有序列，但更结构化比套”。

# html - 任何免费的 HTML 图像切片器？

> ID：198612
> 
> 赞同：3
> 
> 时间：2008-10-13T18:48:26.660
> 
> 标签：html, image

给了我一张 HTML 界面的大 JPG。现在我需要把它分解成几块，然后用 html 表组装起来。如果没有切片器，它会非常费力且容易出错。我没有 Photoshop 或 Firework，有人知道我可以使用的任何免费实用程序吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-13T18:55:00.283

我想你可以用[GIMP](http://www.websiterepairguy.com/ebooks/gimp/How_Slice_Image.html)做到这一点。它是免费和[开源](http://www.gimp.org/source/)的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-13T18:53:15.777

你考虑[过 Paint.Net](http://www.getpaint.net/index.html)吗？这是一个很好的工具，而且它是免费的

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-22T14:26:06.780

正如人们之前所说，您可以使用 GIMP 对图像文件进行切片。

请参阅本教程，了解如何使用 GIMP 对图像进行切片：[http ://docs.gimp.org/en/python-fu-slice.html](http://docs.gimp.org/en/python-fu-slice.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-11-14T21:04:58.903

试试[Namo 图像切片器](http://www.SelectFreeware.com/node/519)。独立安装程序是从旧的 v6 版本的 Namo WebEditor Suite 版本创建的，但运行良好。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-02-06T12:43:22.530

有一个免费的在线照片编辑器，如 Photoshop，您可以使用它来切片图像。无需将其安装在您的 PC 中。网址是[http://pixlr.com/editor/](http://pixlr.com/editor/)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-10-04T15:19:56.173

如果你没有选择 Filter>Web>Slice 你可能没有像我一样安装 python 所以如果你有问题你最好看看这个

[http://www.gimptalk.com/forum/python-and-gimp-t25587.html](http://www.gimptalk.com/forum/python-and-gimp-t25587.html)

但是我仍在努力获得我的 Gimp 切片。但我想我应该让每个人都知道，如果不安装我目前读过的python，切片是不可能的。

谢谢我希望这对你有用。再见。祝你今天过得愉快。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-13T18:56:02.667

我已经为此使用[了 GIMP](http://www.gimp.org)。对于 .pst 文件，我很容易提取图层。当然，在 JPEG 中，您必须手动选择。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-13T18:58:14.533

不是答案，但您应该尝试使用 CSS + 语义元素而不是表格重新创建布局。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-19T16:46:32.190

[NetBeans](http://www.netbeans.org/)和[Eclipse](http://www.eclipse.org/)都有 HTML/JSP 编辑器。如果您正在进行 Java 编程，您可能已经安装了这些 IDE 中的一个或两个。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-19T16:54:13.627

> 我希望它有一个像 photoshop 这样的刀具工具，可以让我画线，它会为我剪下图像...... – Haoest（10 月 13 日 20:22）

据我所知，您正在寻找可以为您编写代码的东西 - 您是否尝试过 ImageReady？我认为它可以像 Photoshop 一样免费试用。

如果你不是（如果你愿意正确地编写代码，那么你可以做得很好），那么你*可以*使用 GIMP，但它有点不同。

将您的图像加载到 GIMP 中，然后开始将标尺拖动到您想要切片的位置。据我所知，GIMP 中有一个切片工具，但我更喜欢手动选择部分并保存为单独的图像，然后自己编写代码。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-10-19T17:23:27.390

这是一个我从未见过有人提出过的疯狂或可能不疯狂的想法。我没有尝试过，但我认为它在很多情况下都会很好用。

1.  使用 Microsoft Paint、GIMP、Apple Preview（使用 command-option-shift-4 和粘贴）之类的“绘图”程序将图像切成小块 - 随便什么。

2.  将图像保存在文件中，如下所示。使用浅色字体（浅灰色、淡紫色、任何柔和的颜色等）在该图像的那块图像上刻出该块的短名称。如果你先在纸上这样做会有所帮助。使用短名称作为文件名的基础保存文件。

3.  为页面的 HTML 创建一个骨架布局，以容纳这些片段。通过将元素的 class 属性设置为该图像片段的短名称来命名每个片段，与相应图像文件的基本文件名相同。

    a.) 使用 DIV 元素，其中您有一行图像（或图像中的项目行）或 TR 元素，如果您更喜欢将整个事物包装在一个 TABLE 中（安静，尖叫！）。

    b.) 在 SPAN 元素而不是 DIV 元素中包装水平穿过页面的片段（或者对所有片段使用 DIV 并编写 CSS 规则来覆盖某些片段的显示属性，以便它们的行为类似于 SPAN）。如果您正在制作 TABLE，请使用 TD 而不是 CSS（或重新定义 DIV）。\

4.  接下来，一次重写一个块 - 用适当的 HTML 替换其“剪切”的原始图像。

这种方法的优点是您可以看到您在此过程中的每一步都在做什么。

它是完全增量的。没有从 JPG 到 HTML 的“大爆炸”转换，因此您可以一步一步进行。

要进行图像“切片”，只需使用 1 像素的虚线或虚线。当您绘制切割线时，在您的绘图程序中打开 X,Y 坐标跟踪，然后移动到每条线的末尾，记下其 X,Y 坐标。

任何绘画程序都适用于此。支持图层的绘图/绘图混合应用程序（例如免费的 GIMP 图形程序）效果最佳。您可以将图像放在背面层，即油漆层。然后，您可以在其上方放置一个绘图层，并在其上绘制虚线/虚线切割线。您还可以为该层中的每个部分刻上短名称。

有人说PSP里面有图片切片功能。这是[关于 Slicer 的 PSP 教程](http://www.moommist.us/Tutorials/slicer.html)。由于听起来 PSP 不仅可以让您绘制剪切线，还可以为您生成 HTML，这似乎可以减轻一些手动工作。

# powershell - 如何使用 Powershell 回收 IIS AppPool？

> ID：198623
> 
> 赞同：21
> 
> 时间：2008-10-13T18:52:06.590
> 
> 标签：powershell, iis-6

我根本没有真正编写过任何 Windows 脚本，所以我不知道如何完成这个脚本。无论如何，基本上我们想要做的是有一个脚本，它将接受关于哪个 IIS AppPool 回收的参数。我对 Google 进行了一些研究，但在让事情正常运行方面并没有取得太大的成功。

这是我现在正在尝试的：

```
$appPoolName = $args[0]
$appPool = get-wmiobject -namespace "root\MicrosoftIISv2" -class "IIsApplicationPools" Where-Object {$_.Name -eq "W3SVC/APPPOOLS/$appPoolName"}
$appPool.Recycle() 
```

和我得到的错误：

```
Get-WmiObject : A parameter cannot be found that matches parameter name '$_.Name -eq "W3SVC/APPPOOLS/$appPoolName"'. 
```

无论如何，如果我也知道如何调试这样的东西会很好。我已经通过执行 gwmi -namespace "root\MicrosoftIISv2" -list 修复了原始脚本的一个错误。任何其他类似的提示都会很棒。

谢谢！

**更新**：这里有更多信息

```
$appPool = gwmi -namespace "root\MicrosoftIISv2" -class "IISApplicationPools" | Get-Member

.   TypeName: System.Management.ManagementObject#root\MicrosoftIISv2\IIsApplicationPools

Name                MemberType   Definition
----                ----------   ----------
Caption             Property     System.String Caption {get;set;}
Description         Property     System.String Description {get;set;}
InstallDate         Property     System.String InstallDate {get;set;}
Name                Property     System.String Name {get;set;}
Status              Property     System.String Status {get;set;}
__CLASS             Property     System.String __CLASS {get;set;}
__DERIVATION        Property     System.String[] __DERIVATION {get;set;}
__DYNASTY           Property     System.String __DYNASTY {get;set;}
__GENUS             Property     System.Int32 __GENUS {get;set;}
__NAMESPACE         Property     System.String __NAMESPACE {get;set;}
__PATH              Property     System.String __PATH {get;set;}
__PROPERTY_COUNT    Property     System.Int32 __PROPERTY_COUNT {get;set;}
__RELPATH           Property     System.String __RELPATH {get;set;}
__SERVER            Property     System.String __SERVER {get;set;}
__SUPERCLASS        Property     System.String __SUPERCLASS {get;set;}
ConvertFromDateTime ScriptMethod System.Object ConvertFromDateTime();
ConvertToDateTime   ScriptMethod System.Object ConvertToDateTime();
Delete              ScriptMethod System.Object Delete();
GetType             ScriptMethod System.Object GetType();
Put                 ScriptMethod System.Object Put();

gwmi -namespace "root\MicrosoftIISv2" -class "IISApplicationPools"

__GENUS          : 2
__CLASS          : IIsApplicationPools
__SUPERCLASS     : CIM_LogicalElement
__DYNASTY        : CIM_ManagedSystemElement
__RELPATH        : IIsApplicationPools.Name="W3SVC/AppPools"
__PROPERTY_COUNT : 5
__DERIVATION     : {CIM_LogicalElement, CIM_ManagedSystemElement}
__SERVER         : IRON
__NAMESPACE      : root\MicrosoftIISv2
__PATH           : \\IRON\root\MicrosoftIISv2:IIsApplicationPools.Name="W3SVC/A
                   ppPools"
Caption          :
Description      :
InstallDate      :
Name             : W3SVC/AppPools
Status           : 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-13T19:35:05.770

**Where-Object**是一个过滤器，它期望输入中的某些内容。*在where 过滤器*之前似乎缺少一个**管道**。

 *尝试：

```
$appPoolName = $args[0]
$appPool = get-wmiobject -namespace "root\MicrosoftIISv2" -class "IIsApplicationPool" | Where-Object {$_.Name -eq "W3SVC/APPPOOLS/$appPoolName"}
$appPool.Recycle() 
```

**编辑**：我注意到 WMI 类是*IISApplicationPools ，如您所见，当通过管道传输到***Get-Member**时，它没有向我们显示 Recycle 方法。这需要更改为*IISApplicationPool*（非复数）。通过该更改，您可以使用 Recycle 方法。上面的代码已经更新。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-04-28T19:47:45.633

使用来自这个问题的数据，我能够创建 2 个非常有用的函数。

*   获取 IisAppPools
*   回收-IisAppPool

编码：

```
function Get-IisAppPools {

    Get-WmiObject -Namespace "root\MicrosoftIISv2" -Class "IIsApplicationPool" -Filter 'name like "W3SVC/APPPOOLS/%"' 
         | ForEach-Object { $_.Name.ToString().SubString(15) } 

}

function Recycle-IisAppPool([string]$appPoolName) { 

     Invoke-WmiMethod -Name Recycle -Namespace "root\MicrosoftIISv2" -Path "IIsApplicationPool.Name='W3SVC/APPPOOLS/$appPoolName'" 

} 
```

您可以像这样使用这些功能

```
Recycle-IisAppPool DefaultAppPool
Get-IisAppPools | ? { $_ -match "v4.0$" } | % { Recycle-IisAppPool $_ } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-13T20:37:53.507

使用 get-WMIObject 时，您可能应该使用 -filter 而不是通过管道连接到 Where-Object。filter 参数使用 WQL 语法语言而不是 PowerShell 的，所以不要让它绊倒你。

```
$appPoolName = $args[0]
$appPool = get-wmiobject -namespace "root\MicrosoftIISv2" -class "IIsApplicationPools" -filter 'name="W3SVC/APPPOOLS/$appPoolName"' 
```

话虽如此，将管道放在那里应该可以工作，并且肯定会使其更容易使用，除非您已经了解 WQL。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-30T19:49:01.937

这不是特定于 Powershell 的答案，但 iisapp.vbs 将列出正在运行的应用程序池，并且有一个 /r 标志来回收特定的应用程序池。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-07-06T17:27:44.240

您还可以使用 WQL 查询来获取您想要的 AppPool；这具有在 WMI 端过滤结果的优点，这在从远程机器获取对象时特别方便。

```
(Get-WmiObject -Query "SELECT * FROM IIsApplicationPool WHERE Name = 'W3SVC/AppPools/$appPoolName'" -Namespace 'root\MicrosoftIISv2').Recycle() 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-10-18T02:12:48.807

在 Powershell 中：

```
$pool = Get-IISAppPool -Name <name>

$pool.recycle() 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-03-20T23:13:31.247

使用 IIS 8.0，我发现我必须使用`-namespace root\webadministration -class ApplicationPool`

例如，要使用 PowerShell 远程回收 IIS 8 中的应用程序池：

与往常一样，请首先通过列出应用程序池进行测试。只需从命令中删除`| where`和第一个`(`：

```
gwmi -comp WebServer01 -namespace root\webadministration -class ApplicationPool

#Recycle app pool by name.
(gwmi -comp WebServer01 -namespace root\webadministration -class ApplicationPool | `
where {$_.Name -eq 'YourAppPool'}).recycle() 
```

在一条线上：

```
(gwmi -comp WebSserver01 -namespace root\webadministration -class ApplicationPool | where {$_.Name -eq 'YourAppPool'}).recycle() 
```

# c++ - 确定 IP 是否被阻止

> ID：198625
> 
> 赞同：1
> 
> 时间：2008-10-13T18:52:27.527
> 
> 标签：c++, windows, security, networking

有谁知道是否可以可靠地确定（以编程方式 C/C++ ...）Windows PC 上是否安装了防火墙或 IP 过滤软件？我需要检测主机操作系统是否在我的客户端软件中阻止了某个服务器 IP。

在这种情况下，我不需要担心外部硬件防火墙，因为我可以完全控制它。我只关心软件防火墙。我希望我可以迭代 Windows 网络堆栈或 NDIS 接口并确定这一点

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-14T07:31:13.127

在阅读了您对其他答案的一些评论后，我认为这实际上可能更接近您正在寻找的内容。它可能无法捕获所有类型的防火墙，但任何主要的防火墙供应商都应在安全中心注册，因此可以使用此方法进行检测。您也可以将其与此处的其他一些答案结合起来，为自己提供第二级验证。

### [在 Windows 中检测正在运行的防火墙](http://www.experts-exchange.com/Programming/Languages/CPP/Q_21645145.html)

这是专家交流帖子，因此您可能无法阅读该主题。以防万一，我已经复制并粘贴了相关信息。它在 VBScript 中，但就可以使用的 WMI 命名空间而言，它应该为您指明正确的方向。

> **KemalRouge**：我刚刚在一位同事的帮助下解决了这个问题。他给我指了一个知识库文章的方向，文章指出这个信息存储在 WMI 数据库中
> 
> 基本上，可以通过几行代码查询WMI，以了解安全中心正在监控哪些防火墙/杀毒软件，以及该软件的状态（即启用与否）。
> 
> 无论如何，如果您有兴趣，这里有一些我用来测试的 VB 代码（您需要参考“Microsoft WMI Scripting V1.2 Library”）：

```
Private Sub DumpFirewallInfo()

Dim oLocator    As WbemScripting.SWbemLocator
Dim oService    As WbemScripting.SWbemServicesEx
Dim oFirewalls  As WbemScripting.SWbemObjectSet
Dim oFirewall   As WbemScripting.SWbemObjectEx
Dim oFwMgr      As Variant

    Set oFwMgr = CreateObject("HNetCfg.FwMgr")

    Debug.Print "Checking the Windows Firewall..."
    Debug.Print "Windows Firewal Enabled: " & oFwMgr.LocalPolicy.CurrentProfile.FirewallEnabled
    Debug.Print ""

    Set oFwMgr = Nothing

    Debug.Print "Checking for other installed firewalls..."

    Set oLocator = New WbemScripting.SWbemLocator
    Set oService = oLocator.ConnectServer(".", "root\SecurityCenter")
    oService.Security_.ImpersonationLevel = 3

    Set oFirewalls = oService.ExecQuery("SELECT * FROM FirewallProduct") ' This could also be "AntivirusProduct"

    For Each oFirewall In oFirewalls
        Debug.Print "Company:       " & vbTab & oFirewall.CompanyName
        Debug.Print "Firewall Name: " & vbTab & oFirewall.DisplayName
        Debug.Print "Enabled:       " & vbTab & Format$(oFirewall.Enabled)
        Debug.Print "Version:       " & vbTab & oFirewall.versionNumber
        Debug.Print ""
    Next oFirewall

    Set oFirewall = Nothing
    Set oFirewalls = Nothing
    Set oService = Nothing
    Set oLocator = Nothing

End Sub 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-13T19:19:09.797

如果您可以假设以下内容，则可能存在黑客攻击：

1.  允许传出 HTTP 连接

2.  您可以在侦听端口 80 的另一台服务器上运行您自己的服务之一

对您的服务进行编码以接受 IP [和端口或 url]。它必须返回是否能够连接到 IP。

通过这种方式，您可以了解实际服务器是否已启动并正在运行。如果服务器不直接可用，您可以断定它被防火墙阻止。

如果您不想编写/运行自己的服务，则可以使用 Internet 上可用的网络状态 Web 服务之一。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-13T19:03:21.187

如果该 IP 在其外部防火墙硬件上被阻止？绝对不可能说出给定主机无法访问的*原因。*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-13T19:08:58.240

一种可能的解决方案是利用防火墙不会阻止对端口 80 的访问，但会阻止对其他端口的访问这一事实。因此，您可以尝试连接到端口 80，然后如果成功，则通过通常阻塞的端口连接（[请参阅此处的示例列表](http://www.chebucto.ns.ca/~rakerman/trojan-port-table.html#Trojan-News)）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-13T19:11:03.400

您无法真正判断 IP 是否被阻止，至少在不知道您正在寻找什么防火墙软件并专门检查它的情况下是这样。一些想法：

*   检查启用或阻止您的服务器的特定防火墙（例如 Windows 防火墙）
*   检查主机文件以获取阻止您的服务器 IP 的条目
*   通过一个或多个代理连接，看看他们是否可以访问 IP，以防您的客户端无法访问。
*   测试服务器以查看它是否可访问（毕竟，这才是您真正要测试的内容，对吗？看看服务器是否可以通信？）。如果您的服务器端发生实际中断，则多次/定期对此进行测试可能是有意义的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-13T18:56:34.163

您必须从 C# 翻译，但这篇博文解释了如何检查 Windows 防火墙是否已启用： [http ://www.shafqatahmed.com/2008/01/controlling-win.html](http://www.shafqatahmed.com/2008/01/controlling-win.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-13T20:42:00.177

我打算建议在[netsh](http://support.microsoft.com/kb/242468)上做一些“期望”式的编程......但通常当有这样的命令行应用程序时，它背后有一个库。

查看[Windows 防火墙 API](http://msdn.microsoft.com/en-us/library/aa366452(VS.85).aspx)。我不能说这会解决您的具体问题，但似乎很有可能。

检查是否允许特定端口的[示例代码](http://msdn.microsoft.com/en-us/library/aa366434(VS.85).aspx)...显示所需标头[的一个很好的示例。](http://msdn.microsoft.com/en-us/library/aa364726(VS.85).aspx)

* * *

## 回答 #8

> 赞同：-4
> 
> 时间：2008-10-13T19:12:04.833

尝试调用 Ping。

# sql-server - SQL Server 不使用约束的唯一列集-按 900 字节限制获取位

> ID：198634
> 
> 赞同：1
> 
> 时间：2008-10-13T18:54:14.310
> 
> 标签：sql-server

我有一个包含 3 个 nvarchar(255) 列的表，这 3 个列的组合必须是唯一的。通常我会创建一个唯一约束，但在这种情况下，我达到了 900 字节的限制。因为我必须支持 SQL Server 2000，所以我不能使用包含列来解决这种情况。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-13T18:57:54.050

如果我理解正确，您可以使用触发器并在“插入”或“更新”上检查值的组合在进行更改之前是否是唯一的。你也可以通过存储过程来做同样的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-13T18:56:57.937

255 似乎很随意。考虑到这一点，nvarchar(150) 是否足够？或者导致 <= 900 字节的某种组合？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T19:27:48.313

正在并行处理这个问题，但看起来它是已经提出的一些其他想法的扩展......您应该能够使用 CHECKSUM 创建一个索引视图来处理这个问题。

举个例子：

```
CREATE TABLE dbo.Test_Unique_Limit (
    string_1    NVARCHAR(255)   NOT NULL,
    string_2    NVARCHAR(255)   NOT NULL,
    string_3    NVARCHAR(255)   NOT NULL )
GO
CREATE VIEW dbo.Test_Unique_Limit_View
WITH SCHEMABINDING
AS
    SELECT string_1, string_2, string_3, CHECKSUM(string_1, string_2, string_3) AS CHKSUM
    FROM dbo.Test_Unique_Limit
GO
CREATE UNIQUE CLUSTERED INDEX Test_Unique_Limit_IDX ON dbo.Test_Unique_Limit_View (CHKSUM)
GO 
```

我没有在生产中使用过这种方法，所以我不能保证它的性能或完全的准确性。您需要在那里进行自己的测试。

不过，我要指出的一件事......您遇到这个问题的事实应该让您退后一步，考虑模型本身是否真的和它应该的一样好。您所描述的列上的唯一索引似乎有点奇怪。

祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T20:06:27.097

我无权访问 SQL 2000 Server，所以我无法在那里进行测试，但假设它支持标量函数，它应该可以工作。您可以通过在每列上添加非唯一索引来使其更快，这样就不必进行表扫描。

```
CREATE FUNCTION [dbo].[fn_count_rows_for_ids]
(
    @id1 nvarchar(255),
    @id2 nvarchar(255),
    @id3 nvarchar(255)
)
RETURNS int
AS
BEGIN
    DECLARE @count int

    SELECT @count = count(*) FROM tbl_test WHERE (string_1 = @id1 AND string_2 = @id2 AND string_3 = @id3)

    RETURN @count

END

CREATE TABLE [dbo].[tbl_test](
    [string_1] [nvarchar](255) NOT NULL,
    [string_2] [nvarchar](255) NOT NULL,
    [string_3] [nvarchar](255) NOT NULL
) ON [PRIMARY]

ALTER TABLE [dbo].[tbl_test]  WITH CHECK ADD  CONSTRAINT [CK_tbl_test] CHECK  (([dbo].[fn_count_rows_for_ids]([string_1],[string_2],[string_3])<=(1)))

ALTER TABLE [dbo].[tbl_test] CHECK CONSTRAINT [CK_tbl_test] 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-13T19:22:57.323

另一个想法：你可以添加一个列来存储这些值的哈希值吗？SQL 2000 支持用于 md5 总和的扩展存储过程，您可以从触发器调用它来创建散列。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-10-13T19:22:10.680

您可以使用 MD5 或 SHA1 对 3 列进行散列，并在散列值上创建一个 unqiue 约束。

实施的难易程度取决于您插入/更新的来源。

如果它们仅来自您的应用程序，那么它应该相对容易实现。

如果它们来自多个来源，您可以考虑在 T-SQL 中实现散列。快速的 Google 搜索发现了以下 T-SQL 中的 MD5 实现：[http](http://binaryworld.net/Main/CodeDetail.aspx?CodeId=3600) ://binaryworld.net/Main/CodeDetail.aspx?CodeId=3600 。在 SQL2005 上，您可以使用内置的哈希函数：http: [//msdn.microsoft.com/en-us/library/ms174415.aspx](http://msdn.microsoft.com/en-us/library/ms174415.aspx)。

请注意，MD5 不再被认为是“安全的”，尽管它对于这种情况应该足够了。它比 SHA1 运行更快，更容易实现。

# php - PHP / MySQL中的多个数据表？

> ID：198650
> 
> 赞同：3
> 
> 时间：2008-10-13T18:57:31.120
> 
> 标签：php, mysql, dataset

在 asp.net 中，您可以通过对数据库的一次调用来检索 MULTIPLE 数据表。你能在php中做同样的事情吗？

例子：

```
$sql ="select * from t1; select * from t2;";
$result = SomeQueryFunc($sql);
print_r($result[0]); // dump results for t1
print_r($result[1]); // dump results for t2 
```

你能做这样的事情吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-13T21:19:34.297

这称为“多查询”。PHP 中的 mysql 扩展没有任何方法来启用多查询。mysqli 扩展确实允许您使用多查询，但只能通过 multi_query() 方法。见[http://php.net/manual/en/mysqli.multi-query.php](http://php.net/manual/en/mysqli.multi-query.php)

不建议使用多查询，因为它会增加 SQL 注入攻击造成的潜在破坏。如果你使用多查询，你应该使用严格的代码检查习惯来避免 SQL 注入漏洞。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-13T19:04:40.607

这应该可以使用较新的 MySQL 和 mysqli（改进的）php 扩展。我不确定是否有任何数据库抽象层支持这一点。

请参阅相关的[MySQL 文档](http://dev.mysql.com/doc/refman/5.0/en/c-api-multiple-queries.html)和 [PHP 文档](http://php.net/manual/en/mysqli.multi-query.php)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T19:08:35.247

[`PDOStatement::nextRowset()`](http://us2.php.net/manual/en/pdostatement.nextrowset.php)似乎是你所追求的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-13T12:11:54.143

如果您使用的是经典 MySQL，则不能。您可以创建一个看起来像的函数

```
function SomeQueryFunc($queries) {
    $queries = explode(';', $queries);
    $return = array();
    foreach($queries as $index => $query) {
        $result = mysql_query($query);
        $return[$index] = array();
        while($row = mysql_fetch_assoc($result)) {
           foreach($row as $column => $value) {
              $return[$index][$column] = $value;
           }
        }
    }
    return $return;
} 
```

这将按预期工作

# java - 寻找进化音乐示例代码

> ID：198654
> 
> 赞同：8
> 
> 时间：2008-10-13T18:58:36.327
> 
> 标签：java, genetic-algorithm, evolutionary-algorithm, jfugue

我想实现一个交互式进化算法来生成音乐（可能只是简单的旋律开始）。

我想为此使用[JFugue](http://www.jfugue.org)。它的网站声称它非常适合进化音乐，但我找不到任何进化的例子。

我已经有了[一个框架](https://watchmaker.dev.java.net)来提供进化机制。我正在寻找的是一些简单的、可工作的代码，这些代码展示了音乐部分的可行方法（例如，适合进化曲调的编码和进化运算符）。

我对如何实现它有一些想法，但我对音乐理论并不是特别了解，所以首先我想重新实现一些已知有效的东西。

那么，是否有人拥有或知道任何免费提供的代码（任何语言都可以）来展示一种或多种进化音乐的方法？

**编辑：**我专门寻找进化代码而不是其他可用于音乐合成的技术。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-15T21:42:12.847

到目前为止，我只找到了[this](http://graphics.stanford.edu/~bjohanso/gp-music/gp_music-old.html)，这是 C 语言中的一个遗传编程示例。

**更新（2010 年 1 月）：**还有[这个在线系统](http://darwintunes.org/)，它没有源代码，但它是可以实现的示例。我还发现[了 Grammidity](http://grammidity.sourceforge.net/)，它允许从语法演变出 MIDI 事件序列。

**更新（2011 年 7 月）：**我刚刚[在 MIT 开放课件网站上找到了一些相关的 Python 代码](http://ocw.mit.edu/courses/music-and-theater-arts/21m-380-music-and-technology-algorithmic-and-generative-music-spring-2010/assignments-and-projects/genetic-algorithms/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-13T16:22:40.357

您可能想研究*马尔可夫链*-它们可能比一开始的进化算法对您更有用，因为判断输出的质量以培育出最好的将是一场噩梦（主观和时间-消费），它们非常适合与进化编程相结合。

[在Coding Horror](http://www.codinghorror.com/blog/archives/001132.html)上有很好的介绍。这篇文章解释了这个概念并展示了显着的结果，评论更多地提到了音乐（我在评论和他们链接的网站中迷失了几个小时）。[在Wikipedia](http://en.wikipedia.org/wiki/Markov_chain)上有一些更具体的细节和进一步阅读。

马尔可夫链对它们具有概率元素，因此您可以将它们与进化编程结合起来——通过进化一种选择除掷骰子之外的替代方案的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-29T11:25:59.503

有一些关于使用[元胞自动机](http://en.wikipedia.org/wiki/Cellular_automata)生成音乐的研究。与所有其他音乐生成一样，这实际上是一个映射而不是生成的问题。你可以使用几乎任何东西作为输入，只要你定义你的映射，让它听起来“好”（我想有趣是一个更好的词）。

谷歌搜索“细胞自动机音乐”给出了相当多的点击率。如果您可以访问他们的档案，另一个很好的信息来源是[计算机音乐杂志。](http://204.151.38.11/cmj/)

# wpf - 嵌套滚动区域

> ID：198656
> 
> 赞同：13
> 
> 时间：2008-10-13T18:59:15.280
> 
> 标签：wpf, layout, scroll

我为 WPF 创建了一个控件，我有一个问题要问你 WPF 专家。

我希望我的控件能够扩展以适应可调整大小的窗口。

在我的控件中，我有一个要随窗口展开的列表框。我在列表框周围还有其他控件（按钮、文本等）。

我希望能够在我的控件上设置最小尺寸，但我希望通过创建用于查看控件的滚动条来缩小窗口的大小。

这将创建嵌套的滚动区域：一个用于列表框，一个 ScrollViewer 包裹整个控件。

现在，如果列表框设置为自动大小，它将永远不会有滚动条，因为它总是在 ScrollViewer 中以全尺寸绘制。

如果内容不能变小，我只希望控件滚动，否则我不想滚动控件；相反，我想滚动控件内的列表框。

如何更改 ScrollViewer 类的默认行为？我尝试从 ScrollViewer 类继承并覆盖 MeasureOverride 和 ArrangeOverride 类，但我无法弄清楚如何正确测量和安排孩子。看来安排必须以某种方式影响 ScrollContentPresenter，而不是实际的内容子项。

任何帮助/建议将不胜感激。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-10-15T12:09:21.570

我创建了一个类来解决这个问题：

```
public class RestrictDesiredSize : Decorator
{
    Size lastArrangeSize = new Size(double.PositiveInfinity, double.PositiveInfinity);

    protected override Size MeasureOverride(Size constraint)
    {
        Debug.WriteLine("Measure: " + constraint);
        base.MeasureOverride(new Size(Math.Min(lastArrangeSize.Width, constraint.Width),
                                      Math.Min(lastArrangeSize.Height, constraint.Height)));
        return new Size(0, 0);
    }

    protected override Size ArrangeOverride(Size arrangeSize)
    {
        Debug.WriteLine("Arrange: " + arrangeSize);
        if (lastArrangeSize != arrangeSize) {
            lastArrangeSize = arrangeSize;
            base.MeasureOverride(arrangeSize);
        }
        return base.ArrangeOverride(arrangeSize);
    }
} 
```

即使包含的元素想要更大，它也将始终返回所需的大小 (0,0)。用法：

```
<local:RestrictDesiredSize MinWidth="200" MinHeight="200">
     <ListBox />
</local> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-20T14:13:10.863

你的问题出现了，因为`Control`a 内的 s`ScrollViewer`有几乎无限的可用空间。因此，您的内心`ListBox`认为它可以通过占据显示所有元素所需的完整高度来避免滚动。当然，在您的情况下，这种行为会产生`ScrollViewer`过度锻炼外部的不良副作用。

因此，目标是在当且仅当且仅当有足够多的情况`ListBox`下使用**可见**高度，`ScrollViewer`否则使用某个最小高度。为了实现这一点，最直接的方法是继承`ScrollViewer`并覆盖[`MeasureOverride()`](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.measureoverride.aspx)以将适当大小的`availableSize`（即给定的`availableSize`放大到最小大小而不是“通常的”无穷大）传递给`Visual`使用[`VisualChildrenCount`](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.visualchildrencount.aspx)and找到的 s [`GetVisualChild(int)`](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.getvisualchild.aspx)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-03T07:34:10.583

我使用[了丹尼尔](https://stackoverflow.com/users/141502/daniel)的解决方案。这很好用。谢谢你。

然后我在装饰器类中添加了两个布尔依赖属性：`KeepWidth`和`KeepHeight`. 因此，可以在一维上抑制新特征。

这需要改变`MeasureOverride`：

```
protected override Size MeasureOverride(Size constraint)
{
    var innerWidth = Math.Min(this._lastArrangeSize.Width, constraint.Width);
    var innerHeight = Math.Min(this._lastArrangeSize.Height, constraint.Height);
    base.MeasureOverride(new Size(innerWidth, innerHeight));

    var outerWidth = KeepWidth ? Child.DesiredSize.Width : 0;
    var outerHeight = KeepHeight ? Child.DesiredSize.Height : 0;
    return new Size(outerWidth, outerHeight);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T19:09:29.300

虽然我不建议创建需要外部滚动条的 UI，但您可以很容易地完成此操作：

```
<Window
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  >    
    <ScrollViewer HorizontalScrollBarVisibility="Auto" 
                  VerticalScrollBarVisibility="Auto">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <ListBox Grid.Row="0" Grid.RowSpan="3" Grid.Column="0" MinWidth="200"/>
            <Button Grid.Row="0" Grid.Column="1" Content="Button1"/>
            <Button Grid.Row="1" Grid.Column="1" Content="Button2"/>
            <Button Grid.Row="2" Grid.Column="1" Content="Button3"/>
        </Grid>
    </ScrollViewer>
</Window> 
```

我真的不推荐这个。WPF 提供了特殊的布局系统，如 Grid，您应该尝试允许应用程序根据需要调整自身大小。也许您可以在窗口本身上设置 MinWidth/MinHeight 以防止这种调整大小？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-05-19T22:18:03.740

在代码隐藏中创建一个方法，将 ListBox 的 MaxHeight 设置为包含它的任何控件和其他控件的高度。如果列表框在其上方或下方有任何控件/边距/填充，请从分配给 MaxHeight 的容器高度中减去它们的高度。在主窗口“加载”和“窗口调整大小”事件处理程序中调用此方法。

这应该给你两全其美。尽管主窗口有自己的滚动条，但您正在给 ListBox 一个“固定”大小，这将导致它滚动。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-06-16T15:05:33.600

用于 2 ScrollViewer

```
 public class ScrollExt: ScrollViewer
{
    Size lastArrangeSize = new Size(double.PositiveInfinity, double.PositiveInfinity);

    public ScrollExt()
    {

    }
    protected override Size MeasureOverride(Size constraint)
    {
        base.MeasureOverride(new Size(Math.Min(lastArrangeSize.Width, constraint.Width),
                                      Math.Min(lastArrangeSize.Height, constraint.Height)));
        return new Size(0, 0);
    }

    protected override Size ArrangeOverride(Size arrangeSize)
    {
        if (lastArrangeSize != arrangeSize)
        {
            lastArrangeSize = arrangeSize;
            base.MeasureOverride(arrangeSize);
        }
        return base.ArrangeOverride(arrangeSize);
    }
} 
```

代码：

```
 <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
        <Grid >
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <TextBlock Background="Beige" Width="600" Text="Example"/>
            <Grid Grid.Column="1" x:Name="grid">
                    <Grid Grid.Column="1" Margin="25" Background="Green">
                    <local:ScrollExt HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                        <Grid Width="10000" Margin="25" Background="Red" />
                    </local:ScrollExt>
                    </Grid>
                </Grid>
        </Grid>
    </ScrollViewer> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-10-26T14:35:16.037

我最终结合了[丹尼尔斯](https://stackoverflow.com/a/1571972/1011688)的答案和[海纳的](https://stackoverflow.com/a/9988974/1011688)答案。我决定发布整个解决方案，以便人们在需要时更容易采用它。这是我的装饰类：

```
public class RestrictDesiredSizeDecorator : Decorator
{
    public static readonly DependencyProperty KeepWidth;
    public static readonly DependencyProperty KeepHeight;

    #region Dependency property setters and getters
    public static void SetKeepWidth(UIElement element, bool value)
    {
        element.SetValue(KeepWidth, value);
    }

    public static bool GetKeepWidth(UIElement element)
    {
        return (bool)element.GetValue(KeepWidth);
    }

    public static void SetKeepHeight(UIElement element, bool value)
    {
        element.SetValue(KeepHeight, value);
    }

    public static bool GetKeepHeight(UIElement element)
    {
        return (bool)element.GetValue(KeepHeight);
    }
    #endregion

    private Size _lastArrangeSize = new Size(double.PositiveInfinity, double.PositiveInfinity);

    static RestrictDesiredSizeDecorator()
    {
        KeepWidth = DependencyProperty.RegisterAttached(
            nameof(KeepWidth),
            typeof(bool),
            typeof(RestrictDesiredSizeDecorator));

        KeepHeight = DependencyProperty.RegisterAttached(
            nameof(KeepHeight),
            typeof(bool),
            typeof(RestrictDesiredSizeDecorator));
    }

    protected override Size MeasureOverride(Size constraint)
    {
        Debug.WriteLine("Measure: " + constraint);

        var keepWidth = GetValue(KeepWidth) as bool? ?? false;
        var keepHeight = GetValue(KeepHeight) as bool? ?? false;

        var innerWidth = keepWidth ? constraint.Width : Math.Min(this._lastArrangeSize.Width, constraint.Width);
        var innerHeight = keepHeight ? constraint.Height : Math.Min(this._lastArrangeSize.Height, constraint.Height);
        base.MeasureOverride(new Size(innerWidth, innerHeight));

        var outerWidth = keepWidth ? Child.DesiredSize.Width : 0;
        var outerHeight = keepHeight ? Child.DesiredSize.Height : 0;

        return new Size(outerWidth, outerHeight);
    }

    protected override Size ArrangeOverride(Size arrangeSize)
    {
        Debug.WriteLine("Arrange: " + arrangeSize);

        if (_lastArrangeSize != arrangeSize)
        {
            _lastArrangeSize = arrangeSize;
            base.MeasureOverride(arrangeSize);
        }

        return base.ArrangeOverride(arrangeSize);
    }
} 
```

这是我在 xaml 中使用它的方式：

```
<ScrollViewer>
    <StackPanel Orientation="Vertical">
        <Whatever />

        <decorators:RestrictDesiredSizeDecorator MinWidth="100" KeepHeight="True">
            <TextBox
                Text="{Binding Comment, UpdateSourceTrigger=PropertyChanged}"
                Height="Auto"
                MaxHeight="360"
                VerticalScrollBarVisibility="Auto"
                HorizontalScrollBarVisibility="Auto"
                AcceptsReturn="True"
                AcceptsTab="True"
                TextWrapping="WrapWithOverflow"
                />
        </decorators:RestrictDesiredSizeDecorator>

        <Whatever />
    </StackPanel>
</ScrollViewer 
```

上面创建了一个文本框，它将垂直增长（直到达到 MaxHeight），但将匹配父级的宽度而不增长外部 ScrollViewer。将窗口/ScrollViewer 调整为小于 100 宽将强制外部 ScrollViewer 显示水平滚动条。也可以使用其他带有内部 ScrollViewers 的控件，包括复杂的网格。

# project-management - 项目管理——资源图

> ID：198666
> 
> 赞同：-1
> 
> 时间：2008-10-13T19:04:49.310
> 
> 标签：project-management

我已经看过并且还没有找到一个简单的资源甘特图工具。谁能推荐一个允许有限资源调度的工具？

在典型的甘特图中，任务位于左侧，资源分配给任务，但我更愿意将资源放在左侧并将任务分配给人员。

一些技术含量低的软件公司通过将所有任务分解为大致相同的努力水平来做到这一点（例如，所有任务大约需要 1 周时间）。然后，您将所有员工列在白板上，并将便签贴在白板上的人员旁边。

完成后，您可以看到正在处理任务的时间（粘性在哪里）以及谁在处理它（在哪一行）。您还可以查看在接下来的 X 周内不会做的事情——如果您的便利贴不在前 4 列中的板上，则在接下来的 4 周内不会做。

我想找到一个可以让我做到这一点的程序，但还没有找到任何东西。

我已经尝试过 MS Project，但并不特别关心该工具。我也在 E​​xcel 中做过这种事情，但是当你想尝试几种不同的场景时，这会变得很痛苦。

有谁知道有这个功能的程序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-14T07:55:17.757

MS Project 可以做与您想要的类似的事情。转到菜单`View | Resource Usage`，它将按日期分解资源，但随后您可以扩展到任务。

如果这不是关闭，请张贴您想要的图纸。

PS：我同意@Simon 的观点，如果你愿意的话，MSProject 可能会浪费时间。但是，我不认为 scrum 或极端开发方法是解决调度问题的灵丹妙药。

[替代文字 http://docs.google.com/File?id=dd8xj6nh_15fxtxnq86_b](http://docs.google.com/File?id=dd8xj6nh_15fxtxnq86_b)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-23T11:59:40.270

除了 Mark Nold 的回答之外，您在 MS Project 的“报告”菜单上还有几个选项，可以让您更简洁地表示谁在做什么，而不是您在“资源使用情况”视图中看到的内容。

然而，报告方法的缺点是它只能查看。

在 MSProject 之外，您可以查看 Fogbugz 的调度系统。它没有勾选“甘特图”要求，但您可以查看随时间推移的每人活动细分。

顺便说一句，我倾向于使用 MSProject 进行容量规划 - 一个很好的大范围刷子，说明谁可以在一段时间内做什么，在一个抽象级别上，可以轻松地重新调整计划。*对于实际*工作的日常跟踪，我们使用 Fogbugz。我认为它是用于战略规划的 MSProject/Gantty 东西，以及用于战术管理和规划的 Fogbugz。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-13T19:25:10.737

我在您的问题中没有看到明确的问题，因此我假设您正在寻找有关项目管理和工具的提示，这就是我要回答的内容:-)

Microsoft Project 可以满足您的需求。我没有推荐它，因为它往往一开始很有帮助，而且很快就会占用你一半的生命，让它保持最新状态。收集任务和估计以及设置依赖关系非常有用。除此之外，不要被愚弄相信它预测的结束日期。

不要小看 Excel，你可以做一些项目管理工具永远不会让你做的事情，比如你自己的预测。它的布局也非常灵活。如果你真的想要一个，甚至有免费的模板可以将[Excel 布局为甘特图。](http://www.vertex42.com/ExcelTemplates/excel-gantt-chart.html)

鉴于大多数软件项目的不断发展的性质，应该得到像甘特图这样的东西，我建议你看看在敏捷旗帜下的项目管理方法，例如[Scrum](http://en.wikipedia.org/wiki/SCRUM)和[Extreme](http://www.extremeprogramming.org/)。通过以稍微不同的方式考虑您的项目，您可以完全消除对甘特图的需求。

祝你好运。继续检查您的估计...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-09T14:18:36.467

身高，

很抱歉迟到的回复。同类最佳的调度工具可提供您正在寻找的东西。例如，看看 www.optisol.biz 上的调度工具 Schedlyzer。它以数字和图形形式按时间顺序显示每个资源的计划任务列表。

光伏

# .net - machine.config 中忽略了 .NET 程序集绑定配置

> ID：198668
> 
> 赞同：0
> 
> 时间：2008-10-13T19:05:15.020
> 
> 标签：.net, configuration, clr, gac, fusion

我有一种情况，我需要能够根据它们的部分名称在 GAC 中加载程序集。为此，我在 app.config 文件中添加了以下内容：

```
<runtime>
  <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
    <qualifyAssembly partialName="MyAssembly"
                     fullName= "MyAssembly, Version=1.0.0.0, Culture=neutral, PublicKeyToken=0123456789abcdef"/>
  </assemblyBinding>
</runtime> 
```

这正是我想要的方式。但是，如果我在 machine.config 文件中放置相同的元素，它似乎会被忽略，并且在尝试加载 MyAssembly 时会出现 FileNotFoundExceptions。

以下是元素在我的app.config中时的程序集绑定日志，并且绑定成功：

```
LOG：此绑定在默认加载上下文中开始。
LOG：使用应用程序配置文件：C:\Documents and Settings\jon_scheiding\My Documents\Source\Testing\Test Projects 1\Cmd\bin\Debug\Testers.Cmd.vshost.exe.config
LOG：使用 C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\config\machine.config 中的机器配置文件。
LOG：部分引用来自配置文件。新参考：MyAssembly，Version=1.0.0.0，Culture=neutral，PublicKeyToken=0123456789abcdef。
日志：政策后参考：MyAssembly，Version=1.0.0.0，Culture=neutral，PublicKeyToken=0123456789abcdef
日志：通过查看 GAC 找到程序集。
LOG：绑定成功。从 C:\WINDOWS\assembly\GAC_MSIL\MyAssembly\1.0.0.0__b20f4683c1030dbd\MyAssembly.dll 返回程序集。
LOG：程序集在默认加载上下文中加载。
```

将其与我的配置在 machine.config 中时的日志进行对比，并且绑定失败：

```
LOG：此绑定在默认加载上下文中开始。
LOG：使用应用程序配置文件：C:\Documents and Settings\jon_scheiding\My Documents\Source\Testing\Test Projects 1\Cmd\bin\Debug\Testers.Cmd.vshost.exe.config
LOG：使用 C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\config\machine.config 中的机器配置文件。
LOG：此时未将策略应用于引用（私有、自定义、部分或基于位置的程序集绑定）。
日志：正在尝试下载新的 URL 文件：///C:/Documents and Settings/jon_scheiding/My Documents/Source/Testing/Test Projects 1/Cmd/bin/Debug/MyAssembly.DLL。
日志：正在尝试下载新的 URL 文件：///C:/Documents and Settings/jon_scheiding/My Documents/Source/Testing/Test Projects 1/Cmd/bin/Debug/MyAssembly/MyAssembly.DLL。
日志：尝试下载新的 URL 文件：///C:/Documents and Settings/jon_scheiding/My Documents/Source/Testing/Test Projects 1/Cmd/bin/Debug/MyAssembly.EXE。
日志：尝试下载新的 URL 文件：///C:/Documents and Settings/jon_scheiding/My Documents/Source/Testing/Test Projects 1/Cmd/bin/Debug/MyAssembly/MyAssembly.EXE。
LOG：所有探测 URL 都已尝试并失败。
```

问题似乎是第四行，“Policy not being applied to reference at this time”。但是，关于此消息的含义或如何解决它，我几乎找不到文档。

如何让框架识别我的 <runtime> 元素？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-03T07:17:01.107

该框架不会从 machine.config 中读取qualifyAssebmly 配置，它只会从您的应用程序配置文件中读取它。

该框架确实可以识别您的运行时元素，但是它不能识别qualifyAssembly 元素。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-02-04T16:03:54.733

我很晚才回到这个需求，因为我们在 GAC 中有一些程序集，而 NHibernate 之类的东西需要解决它们。不是将所有这些qualifyAssembly 元素添加到每个app.config，下面的代码允许我们将它们添加到我们的machine.config。

```
using System;
using System.Collections.Generic;
using System.Configuration;
using System.IO;
using System.Reflection;
using System.Xml;
using System.Xml.XPath;

namespace MyNamespace {

    /// <summary>
    /// Implements <see cref="IDisposable"/> to provide a scope for resolving
    /// assemblies described in the machine.config file with 
    /// &lt;qualifyAssembly&gt; elements.
    /// </summary>
    /// <remarks>
    /// Because the framework only respects &lt;qualifyAssembly&gt; at the
    /// application configuration level, this class provides similar
    /// functionality for this element at the machine configuration level.
    /// You can wrap a new instance of this class in a <b>using</b> statement
    /// to get resolution within a specific scope; or, you can call the 
    /// <see cref="AssemblyResolver.Attach()"/> method to get 
    /// resolution for the lifetime of the current <see cref="AppDomain"/>.
    /// </remarks>
    public sealed class AssemblyResolver : IDisposable {

        #region Private fields and implementation

        private static Dictionary<string, string> _qualifiedNames;

        private static Assembly ResolveAssembly(object sender, ResolveEventArgs args) {
            if(_qualifiedNames == null) {
                //
                // Lazily initialize short/long name mappings.
                //
                _qualifiedNames = BuildQualifiedNameList();
            }

            if(!_qualifiedNames.ContainsKey(args.Name)) {
                return null;
            }

            try {
                return Assembly.Load(_qualifiedNames[args.Name]);
            }
            catch(FileNotFoundException) {
                //
                // TODO: Should this exception be propogated?
                // It probably should not be hidden from the consumer
                // since it likely indicates a configuration error.
                //
                return null;
            }
        }

        private static Dictionary<string, string> BuildQualifiedNameList() {
            var dict = new Dictionary<string, string>(StringComparer.InvariantCultureIgnoreCase);

            //
            // Get runtime XML data
            //
            var xml = GetConfigXml(GetMachineRuntimeSection());
            if(xml == null) {
                return dict;
            }

            //
            // Iterate the qualifyAssembly elements and register in the list
            //
            var navigator = xml.CreateNavigator();
            foreach(XPathNavigator qualifyAssembly in navigator.Select("runtime/asm:assemblyBinding/asm:qualifyAssembly", CreateNamespaceManager())) {
                dict.Add(
                    qualifyAssembly.GetAttribute("partialName", string.Empty),
                    qualifyAssembly.GetAttribute("fullName", string.Empty));
            }

            return dict;
        }

        private static ConfigurationSection GetMachineRuntimeSection() {
            System.Configuration.Configuration machineConfig = ConfigurationManager.OpenMachineConfiguration();
            return machineConfig.GetSection("runtime") as ConfigurationSection;
        }

        private static IXPathNavigable GetConfigXml(ConfigurationSection runtimeSection) {
            var ignoreSection = runtimeSection as IgnoreSection;
            if(ignoreSection == null) {
                return null;
            }

            //
            // Cheat via Reflection to get the XML content of the config
            // section.
            //
            FieldInfo field = typeof(IgnoreSection).GetField("_rawXml", BindingFlags.Instance | BindingFlags.NonPublic);
            string rawXml = (string)field.GetValue(ignoreSection);
            return new XPathDocument(new StringReader(rawXml));
        }
        private static IXmlNamespaceResolver CreateNamespaceManager() {
            var nsmgr = new XmlNamespaceManager(new NameTable());
            nsmgr.AddNamespace("asm", "urn:schemas-microsoft-com:asm.v1");
            return nsmgr;
        }

        #endregion

        /// <summary>
        /// Creates a new <see cref="AssemblyResolver"/>.
        /// </summary>
        public AssemblyResolver() {
            AppDomain.CurrentDomain.AssemblyResolve += new ResolveEventHandler(ResolveAssembly);
        }

        /// <summary>
        /// Removes the current <see cref="AssemblyResolver"/>
        /// from the <see cref="AppDomain"/>.
        /// </summary>
        public void Dispose() {
            AppDomain.CurrentDomain.AssemblyResolve -= new ResolveEventHandler(ResolveAssembly);
            GC.SuppressFinalize(this);
        }

        /// <summary>
        /// Provides qualified assembly resolution for the lifetime of the
        /// current <see cref="AppDomain"/>.
        /// </summary>
        public static void Attach() {
            Attach(AppDomain.CurrentDomain);
        }

        /// <summary>
        /// Provides qualified assembly resolution for the lifetime of an
        /// <see cref="AppDomain"/>.
        /// </summary>
        /// <param name="appDomain">
        /// The <see cref="AppDomain"/> to service.
        /// </param>
        public static void Attach(AppDomain appDomain) {
            appDomain.AssemblyResolve += new ResolveEventHandler(ResolveAssembly);
        }

    }
} 
```

在大多数情况下，我们通过像这样使用它来限制它的范围：

```
using(new AssemblyResolver()) {
    //
    // NHibernate initialization or whatever
    //
} 
```

它也可以在应用程序启动代码或 global.asax 中使用，并在应用程序的生命周期内持续存在，如下所示：

```
AssemblyResolver.Attach();
//
// or
//
AssemblyResolver.Attach(AppDomain.CurrentDomain); 
```

# javascript - JQuery 选择框和循环帮助

> ID：198670
> 
> 赞同：9
> 
> 时间：2008-10-13T19:05:51.837
> 
> 标签：javascript, jquery, forms, elements

谢谢阅读。我对 jQuery 有点陌生，我正在尝试制作一个可以包含在我所有网站中的脚本，以解决一个总是让我发疯的问题......

问题：带有长选项的选择框在 Internet Explorer 中被截断。例如，这些选择框： [http ://discoverfire.com/test/select.php](http://discoverfire.com/test/select.php)

在 Firefox 中它们很好，但在 IE 中，选项在下拉时被切断为选择的宽度。

解决方案：我要做的是创建一个脚本，我可以将其包含在任何页面中，该页面将执行以下操作：

1.  循环浏览页面上的所有选择。

2.  对于每个选择： A. 循环遍历其选项。B. 找出最长选项的宽度。C. 绑定一个函数以将选择扩展到焦点宽度（或者单击...）。D. 绑定一个函数以在模糊时缩小到它的原始宽度。

我已经设法为一个选择框完成了第 2 步的大部分工作。

我发现获取选项宽度是一个问题（尤其是在 IE 中），所以我循环遍历并将每个选项的文本复制到一个跨度，测量跨度宽度，并使用最长的一个作为选择将扩展到的宽度. 也许有人有更好的主意。

这是代码

```
<script type='text/javascript'>

      $(function() {

         /*
         This function will:
            1\. Create a data store for the select called ResizeToWidth.
            2\. Populate it with the width of the longest option, as approximated by span width.

         The data store can then be used
         */
         // Make a temporary span to hold the text of the options.
         $('body').append("<span id='CurrentOptWidth'></span>");

         $("#TheSelect option").each(function(i){

            // If this is the first time through, zero out ResizeToWidth (or it will end up NaN).
            if ( isNaN( $(this).parent().data('ResizeToWidth') ) ) {
               $(this).parent().data( 'OriginalWidth', $(this).parent().width() );
               $(this).parent().data('ResizeToWidth', 0);

               $('CurrentOptWidth').css('font-family', $(this).css('font-family') );
               $('CurrentOptWidth').css('font-size', $(this).css('font-size') );
               $('CurrentOptWidth').css('font-weight', $(this).css('font-weight') );

            }

            // Put the text of the current option into the span.
            $('#CurrentOptWidth').text( $(this).text() );

            // Set ResizeToWidth to the longer of a) the current opt width, or b) itself. 
            //So it will hold the width of the longest option when we are done
            ResizeToWidth = Math.max( $('#CurrentOptWidth').width() , $(this).parent().data('ResizeToWidth') );

            // Update parent ResizeToWidth data.
            $(this).parent().data('ResizeToWidth', ResizeToWidth)

          });

         // Remove the temporary span.
         $('#CurrentOptWidth').remove();

         $('#TheSelect').focus(function(){
            $(this).width( $(this).data('ResizeToWidth') );
         });

         $('#TheSelect').blur(function(){
            $(this).width( $(this).data('OriginalWidth') );
         });

           alert( $('#TheSelect').data('OriginalWidth') );
           alert( $('#TheSelect').data('ResizeToWidth') );

      });

   </script> 
```

和选择：

```
<select id='TheSelect' style='width:50px;'>
   <option value='1'>One</option>
   <option value='2'>Two</option>
   <option value='3'>Three</option>
   <option value='42,693,748,756'>Forty-two billion, six-hundred and ninety-three million, seven-hundred-forty-some-odd..... </option>
   <option value='5'>Five</option>
   <option value='6'>Six</option>
   <option value='7'>Seven...</option>
</select> 
```

如果你想运行它，希望它会为你运行，或者你可以在这里看到它的运行：http: [//discoverfire.com/test/select.php](http://discoverfire.com/test/select.php)。

我需要帮助：这需要一点润色，但如果您指定选择框，似乎可以正常工作。

但是，我似乎无法弄清楚如何通过循环将其应用于页面上的所有选择框。到目前为止，我有这个：

```
$('select').each(
   function(i, select){
      // Get the options for the select here... can I use select.each...?
   }
); 
```

另外，有没有更好的方法来获得每个选择的最长选项的长度？跨度很接近，但不是很精确。问题是 IE 为实际选择的选项宽度返回零。

任何想法都非常受欢迎，无论是对于提出的问题，还是对我的代码的任何其他改进。

谢谢！！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-13T20:22:11.510

要修改每个选择，请尝试以下操作：

```
$('select').each(function(){

  $('option', this).each(function() {
    // your normalizing script here

  })

}); 
```

第二个 jQuery 调用的第二个参数 (this) 限定了选择器 ('option') 的范围，因此它本质上是“此选择中的所有选项元素”。如果没有提供第二个参数，您可以认为它默认为“文档”。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-13T20:38:58.653

我能够使用此代码复制 IE7 页面上所有选择的结果，我发现它比您使用的 span 方法简单得多，但您可以用任何适合您需要的代码替换“resize”函数。

```
function resize(selectId, size){
    var objSelect = document.getElementById(selectId);
    var maxlength = 0;
    if(objSelect){
        if(size){
            objSelect.style.width = size;
        } else {
            for (var i=0; i< objSelect.options.length; i++){
                if (objSelect[i].text.length > maxlength){
                    maxlength = objSelect[i].text.length;
                }
            }
            objSelect.style.width = maxlength * 9;
        }
    } 
}

$(document).ready(function(){
    $("select").focus(function(){
        resize($(this).attr("id"));
    });
    $("select").blur(function(){
        resize($(this).attr("id"), 40);
    });
}); 
```

# java - 在没有临时文件的Java中将音频流转换为WAV字节数组

> ID：198679
> 
> 赞同：9
> 
> 时间：2008-10-13T19:07:11.553
> 
> 标签：java, audio, wav, javasound

给定一个包含压缩格式（例如 MP3 或 OGG）的音频数据的调用，我希望创建一个`InputStream`包含输入数据的 WAV 转换的数组。不幸的是，如果您尝试这样做，JavaSound 会给您以下错误：`in``byte`

```
java.io.IOException: stream length not specified 
```

我设法通过将 wav 写入临时文件，然后将其读回来使其工作，如下所示：

```
AudioInputStream source = AudioSystem.getAudioInputStream(new BufferedInputStream(in, 1024));
AudioInputStream pcm = AudioSystem.getAudioInputStream(AudioFormat.Encoding.PCM_SIGNED, source);
AudioInputStream ulaw = AudioSystem.getAudioInputStream(AudioFormat.Encoding.ULAW, pcm);
File tempFile = File.createTempFile("wav", "tmp");
AudioSystem.write(ulaw, AudioFileFormat.Type.WAVE, tempFile);
// The fileToByteArray() method reads the file
// into a byte array; omitted for brevity
byte[] bytes = fileToByteArray(tempFile);
tempFile.delete();
return bytes; 
```

这显然不太理想。有没有更好的办法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-13T19:53:03.817

问题是大多数 AudioFileWriter 在写入 OutputStream 时需要提前知道文件大小。因为你不能提供这个，所以它总是失败。不幸的是，默认的 Java 声音 API 实现没有任何替代方案。

但是您可以尝试使用 Tritonus 插件中的 AudioOutputStream 架构（Tritonus 是 Java 声音 API 的开源实现）：[http ://tritonus.org/plugins.html](http://tritonus.org/plugins.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-02T17:34:46.210

我注意到很久以前有人问过这个问题。如果有任何新人（使用 Java 7 及更高版本）发现了这个线程，请注意通过 Files.readAllBytes API 有更好的新方法。请参阅： [如何将 .wav 文件转换为字节数组？](https://stackoverflow.com/questions/13802441/how-to-convert-wav-file-into-byte-array)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-03-04T00:06:23.617

太晚了，我知道，但我需要这个，所以这是我在这个话题上的两分钱。

```
public void UploadFiles(String fileName, byte[] bFile)
{
    String uploadedFileLocation = "c:\\";

    AudioInputStream source;
    AudioInputStream pcm;
    InputStream b_in = new ByteArrayInputStream(bFile);
    source = AudioSystem.getAudioInputStream(new BufferedInputStream(b_in));
    pcm = AudioSystem.getAudioInputStream(AudioFormat.Encoding.PCM_SIGNED, source);
    File newFile = new File(uploadedFileLocation + fileName);
    AudioSystem.write(pcm, Type.WAVE, newFile);

    source.close();
    pcm.close();
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2016-08-30T16:18:23.787

如果您准备将为您创建正确标题的课程，则该问题很容易解决。在我的示例[示例中，如何读取 wav 缓冲区中的音频输入](http://privateblog.info/kak-zapisat-zvuk-na-java-v-byte-massiv/)数据进入某个缓冲区，之后我创建标头并在缓冲区中有 wav 文件。不需要额外的库。只需从我的示例中复制代码即可。

示例如何使用在缓冲区数组中创建正确标头的类：

```
public void run() {    
    try {    
        writer = new NewWaveWriter(44100);  

        byte[]buffer = new byte[256];  
        int res = 0;  
        while((res = m_audioInputStream.read(buffer)) > 0) {  
            writer.write(buffer, 0, res);  
        }  
    } catch (IOException e) {  
        System.out.println("Error: " + e.getMessage());  
    }    
}    

public byte[]getResult() throws IOException {  
    return writer.getByteBuffer();  
} 
```

您可以在我的链接下找到 NewWaveWriter 类。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2011-06-28T10:36:52.290

这很简单...

```
File f = new File(exportFileName+".tmp");
File f2 = new File(exportFileName);
long l = f.length();
FileInputStream fi = new FileInputStream(f);
AudioInputStream ai = new AudioInputStream(fi,mainFormat,l/4);
AudioSystem.write(ai, Type.WAVE, f2);
fi.close();
f.delete(); 
```

.tmp 文件是一个 RAW 音频文件，结果是一个带有标题的 WAV 文件。

# winforms - 为什么我的工具箱项在 Visual Studio 2008 中消失了？

> ID：198691
> 
> 赞同：7
> 
> 时间：2008-10-13T19:11:10.827
> 
> 标签：winforms, visual-studio-2008

我正在开发一个包含多个针对 Windows Mobile 5 和标准 Windows 应用程序的项目的解决方案。

最近在设计器中打开表单时，常见的 UI 控件（文本框、按钮、标签等）已经消失，只剩下项目中定义的控件。

重置工具箱没有效果。谷歌搜索建议删除 中的工具箱临时文件`Local Settings\Application Data\Microsoft\VisualStudio\9.0`，但这只是成功恢复了 Windows Mobile 5 的默认控件。WinForms 控件仍然神秘失踪。

此外，如果我在工具箱上右键单击并*全选*，实际上所有的 WinForms 控件都会出现，但是它们都是灰色的。

有没有其他人经历过这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T14:47:00.027

如果您右键单击工具箱并选择“选择项目...”，然后按“命名空间”列排序，则可以选择所需的那些（例如用于 WinForms 的 System.Windows.Forms）。

您可以使用 Shift 进行多选，然后选择/取消选择该组。

然后控件重新出现在工具箱中并启用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T13:46:24.693

我只是有一个类似的问题。在托管 C++ 项目中，所有默认工具箱项都从 winforms 设计器中消失。玩了一会发现.vcproj文件有问题。

```
<VisualStudioProject
    ProjectType="Visual C++"
    Version="9,00"
    Name="COLLADA Import"
    ProjectGUID="{0DEEF9B6-1929-44E3-92EC-13712839FB63}"
    RootNamespace="COLLADAImport"
    Keyword="ManagedCProj"
    TargetFrameworkVersion="0"
    > 
```

当您将 TargetFrameworkVersion 设置为有效数字时，例如 .Net 2.0 的 131072，工具箱项目将返回。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-13T22:32:56.503

对于常规的 WinForm，我也注意到了同样的事情。我无法与移动应用程序交谈，但在常规的 winforms 中，这有发生的趋势。

我相信这实际上是 Visual Studio 中的一个错误。

通过向控件添加属性，您可以做一些事情（同样，对于 WinForms。我不确定移动设备）。如：

```
[ToolboxBitmap(typeof(MyControl), "MyControlBitmap")] 
```

此站点上还有一些其他有用的相关内容：

[http://en.csharp-online.net/Design-Time_Integration-Attributes](http://en.csharp-online.net/Design-Time_Integration-Attributes)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-15T10:30:10.510

我遇到了完全相同的问题（安装 Windows Mobile SDK 后，工具箱中的所有项目都变灰了）。

我已经以管理员身份启动了 Visual Studio 2008 命令行并启动了以下命令（警告 - 您的所有设置都丢失了！！）

```
devenv /setup /resetuserdata /selfreg /resetskippkgs 
```

在那之后，工具箱看起来很好，并且像第一天一样工作。这个想法来自这个线程：[connect.microsoft.com](http://connect.microsoft.com/VisualStudio/feedback/details/322223/no-usable-controls-in-toolbox-when-developing-for-compact-framework)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-06-22T14:13:34.110

转到工具菜单并选择导入和导出设置，然后选择“全部重置”设置，然后是。保存您当前的设置，之后您的工具箱将重新出现。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-13T22:35:09.057

实际上，您也许可以[添加一个注册表项](http://msdn.microsoft.com/en-us/library/9yxtkx75(VS.80).aspx)以使其也可以正常工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-10-23T13:34:48.260

好吧，猜猜为 VS 2008 安装的 Service Pack 1 会消失，如果您有无线鼠标和键盘，请将其关闭。选择这两个工作中的一个。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-19T20:27:22.963

如果您在 vista 下运行 Visual Studio 2008，请尝试以管理员身份运行它。右键单击快捷方式并选择*以管理员身份运行*。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-11-02T20:25:01.870

确保您未处于调试模式。

# python - 我可以将 python 字典腌制到 sqlite3 文本字段中吗？

> ID：198692
> 
> 赞同：40
> 
> 时间：2008-10-13T19:11:13.853
> 
> 标签：python, sqlite, pickle

有什么我应该注意的问题吗？我可以将它存储在文本字段中，还是需要使用 blob？（我对 pickle 或 sqlite 都不太熟悉，所以我想确保我用我的一些高级设计理念在正确的树上吠叫。）

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2010-02-26T10:23:14.950

我也需要实现同样的目标。

事实证明，在我终于弄清楚之前，这让我很头疼，[多亏了这篇文章](http://coding.derkeiler.com/Archive/Python/comp.lang.python/2008-12/msg00352.html)，如何使它以二进制格式实际工作。

### 插入/更新：

```
pdata = cPickle.dumps(data, cPickle.HIGHEST_PROTOCOL)
curr.execute("insert into table (data) values (:data)", sqlite3.Binary(pdata)) 
```

您必须指定转储的第二个参数以强制执行二进制酸洗。
另请注意**sqlite3.Binary**以使其适合 BLOB 字段。

### 要检索数据：

```
curr.execute("select data from table limit 1")
for row in curr:
  data = cPickle.loads(str(row['data'])) 
```

在检索 BLOB 字段时，sqlite3 获取一个“缓冲区”python 类型，需要在传递给加载方法之前使用**str进行字符串化。**

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-10-13T19:31:36.213

如果要存储腌制对象，则需要使用 blob，因为它是二进制数据。但是，例如，您可以对腌制对象进行 base64 编码以获取可以存储在文本字段中的字符串。

不过，一般来说，做这种事情表明设计不好，因为您存储的是不透明的数据，您将失去使用 SQL 对该数据进行任何有用操作的能力。尽管不知道您实际上在做什么，但我无法真正对此做出道德呼吁。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-12T19:30:07.120

我写了一篇关于这个想法的博客，除了我使用 json 而不是 pickle，因为我希望它可以与 perl 和其他程序互操作。

[http://writeonly.wordpress.com/2008/12/05/simple-object-db-using-json-and-python-sqlite/](http://writeonly.wordpress.com/2008/12/05/simple-object-db-using-json-and-python-sqlite/)

从架构上讲，这是一种为任意数据结构获取持久性、事务等的快速而肮脏的方法。我发现这种组合在我想要持久性时非常有用，并且不需要在 sql 层对数据做太多事情（或者在 sql 中处理非常复杂，而使用生成器很简单）。

代码本身非常简单：

```
#  register the "loader" to get the data back out.
sqlite3.register_converter("pickle", cPickle.loads) 
```

然后，当你想把它转储到数据库中时，

```
p_string = p.dumps( dict(a=1,b=[1,2,3]))  
conn.execute(''' 
   create table snapshot( 
      id INTEGER PRIMARY KEY AUTOINCREMENT, 
        mydata pickle); 
''')  

conn.execute(''' 
    insert into snapshot values 
    (null, ?)''', (p_string,))
''') 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-13T19:37:31.507

Pickle 有文本和二进制输出格式。如果您使用基于文本的格式，则可以将其存储在 TEXT 字段中，但如果您使用（更有效的）二进制格式，则它必须是 BLOB。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-14T06:07:06.167

我不得不同意这里的一些评论。小心并确保您真的想将泡菜数据保存在数据库中，可能有更好的方法。

无论如何，我过去在尝试将二进制数据保存在 sqlite 数据库中时遇到了麻烦。显然你必须使用 sqlite3.Binary() 来为 sqlite 准备数据。

这是一些示例代码：

```
query = u'''insert into testtable VALUES(?)'''
b = sqlite3.Binary(binarydata)
cur.execute(query,(b,))
con.commit() 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-13T19:35:59.340

由于 Pickle 可以将您的对象图转储为字符串，因此应该可以。

请注意，尽管 SQLite 中的 TEXT 字段使用数据库编码，因此您可能需要在取消腌制之前将其转换为简单字符串。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-13T19:37:44.190

如果字典可以腌制，它也可以存储在 text/blob 字段中。

请注意不能腌制的字典（也就是包含不可腌制的对象）。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-13T20:00:26.890

是的，正如其他人所解释的那样，您可以将腌制对象存储在 SQLite3 数据库的 TEXT 或 BLOB 字段中。

请注意，某些对象**不能腌制**。内置容器类型可以（dict、set、list、tuple 等）。但是有些对象，比如文件句柄，引用了它们自己的数据结构之外的状态，而其他扩展类型也有类似的问题。

由于字典可以包含任意嵌套的数据结构，因此它可能不是可腌制的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-13T22:11:31.227

SpoonMeiser 是正确的，您需要有充分的理由来腌制数据库。

使用 SQLite 编写实现持久性的 Python 对象并不难。然后，您也可以使用 SQLite CLI 来处理数据。根据我的经验，这值得额外的工作，因为许多调试和管理功能可以简单地从 CLI 执行，而不是编写特定的 Python 代码。

在项目的早期阶段，我按照您的建议做了，最后为每个业务对象重新编写了一个 Python 类（注意：我没有说每个表！）这样应用程序的主体可以专注于需要“做什么”而不是“如何”完成。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-13T23:13:39.073

考虑到您的要求是保存一个字典，然后为了用户的“观看乐趣”而将其吐出，另一个选择是使用该`shelve`模块，它可以让您将任何可腌制的数据保存到文件中。python 文档在[这里](http://docs.python.org/library/shelve.html#example)。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-14T00:34:57.163

根据您正在处理的内容，您可能需要查看[shove](http://pypi.python.org/pypi/shove)模块。它做了类似的事情，它在 sqlite 数据库中自动存储 Python 对象（以及各种其他选项）并伪装成字典（就像[shelve](http://www.python.org/doc/2.5.2/lib/module-shelve.html)模块一样）。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-03-13T12:07:17.880

可以将对象数据存储为 pickle dump、jason 等，但也可以对它们进行索引、限制它们并运行使用这些索引的选择查询。这是元组的示例，可以轻松应用于任何其他 python 类。所有需要的都在 python sqlite3 文档中进行了解释（有人已经发布了链接）。无论如何，这里的所有内容都放在以下示例中：

```
import sqlite3
import pickle

def adapt_tuple(tuple):
    return pickle.dumps(tuple)    

sqlite3.register_adapter(tuple, adapt_tuple)    #cannot use pickle.dumps directly because of inadequate argument signature 
sqlite3.register_converter("tuple", pickle.loads)

def collate_tuple(string1, string2):
    return cmp(pickle.loads(string1), pickle.loads(string2))

#########################
# 1) Using declared types
con = sqlite3.connect(":memory:", detect_types=sqlite3.PARSE_DECLTYPES)

con.create_collation("cmptuple", collate_tuple)

cur = con.cursor()
cur.execute("create table test(p tuple unique collate cmptuple) ")
cur.execute("create index tuple_collated_index on test(p collate cmptuple)")

cur.execute("select name, type  from sqlite_master") # where type = 'table'")
print(cur.fetchall())

p = (1,2,3)
p1 = (1,2)

cur.execute("insert into test(p) values (?)", (p,))
cur.execute("insert into test(p) values (?)", (p1,))
cur.execute("insert into test(p) values (?)", ((10, 1),))
cur.execute("insert into test(p) values (?)", (tuple((9, 33)) ,))
cur.execute("insert into test(p) values (?)", (((9, 5), 33) ,))

try:
    cur.execute("insert into test(p) values (?)", (tuple((9, 33)) ,))
except Exception as e:
    print e

cur.execute("select p from test order by p")
print "\nwith declared types and default collate on column:"
for raw in cur:
    print raw

cur.execute("select p from test order by p collate cmptuple")
print "\nwith declared types collate:"
for raw in cur:
    print raw

con.create_function('pycmp', 2, cmp)

print "\nselect grater than using cmp function:"
cur.execute("select p from test where pycmp(p,?) >= 0", ((10, ),) )
for raw in cur:
    print raw

cur.execute("explain query plan select p from test where p > ?", ((3,)))
for raw in cur:
    print raw 

print "\nselect grater than using collate:"
cur.execute("select p from test where p > ?", ((10,),) )
for raw in cur:
    print raw  

cur.execute("explain query plan select p from test where p > ?", ((3,)))
for raw in cur:
    print raw

cur.close()
con.close() 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2019-08-20T19:48:04.997

许多应用程序使用 sqlite3 作为 SQLAlchemy 的后端，因此自然也可以在 SQLAlchemy 框架中提出这个问题（这就是我遇到这个问题的方式）。

为此，需要定义希望存储泡菜数据的列以存储“PickleType”数据。实现非常简单：

```
from sqlalchemy import PickleType, Integer
from sqlalchemy.orm import sessionmaker
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy import create_engine
import pickle

Base= declarative_base()

class User(Base):
    __tablename__= 'Users'

    id= Column(Integer, primary_key= True)
    user_login_data_array= Column(PickleType)

login_information= {'User1':{'Times': np.arange(0,20),
                             'IP': ['123.901.12.189','123.441.49.391']}}

engine= create_engine('sqlite:///memory:',echo= False) 

Base.metadata.create_all(engine)
Session_maker= sessionmaker(bind=engine)
Session= Session_maker()

# The pickling here is very intuitive! Just need to have 
# defined the column "user_login_data_array" to take pickletype data.

pickled_login_data_array= pickle.dumps(login_information)
user_object_to_add= User(user_login_data_array= pickled_login_data_array)

Session.add(user_object_to_add)
Session.commit() 
```

（我并不是说这个例子最适合使用泡菜，因为其他人已经注意到了问题。）

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-09-13T04:47:57.610

在 SourceForge 上查看此解决方案：

y_serial.py 模块 :: 使用 SQLite 存储 Python 对象

“序列化 + 持久性 :: 在几行代码中，将 Python 对象压缩和注释为 SQLite；然后在没有任何 SQL 的情况下通过关键字按时间顺序检索它们。数据库存储无模式数据的最有用的“标准”模块。”

[http://yserial.sourceforge.net](http://yserial.sourceforge.net)

# ldap - 如何在 Apache httpd 中使用客户端证书连接到 LDAP 进行授权？

> ID：198696
> 
> 赞同：2
> 
> 时间：2008-10-13T19:12:53.663
> 
> 标签：ldap, certificate, apache, x509

我有一个使用 x509 客户端证书（2 路 SSL）对用户进行身份验证的站点和一个包含授权信息的 LDAP 目录。我想使用证书属性之一来查询目录（确切地说是 SSL_CLIENT_S_DN_CN）。我看到了如何使用 mod_ssl 使用用户的客户端证书进行身份验证，我看到了如何使用 mod_auth_ldap 等来使用来自基本或基于表单的身份验证的用户名来查询 LDAP 存储以获取授权。我没有看到一个很好的例子是如何使用用户客户端证书的属性代替用户名来查询 LDAP。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-15T05:57:09.557

Apache 2.2.x 存在一个模块：[modXLDAPAuth](http://www.urec.fr/rubrique34.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-13T19:53:37.370

这可能会有所帮助：[settingcerts](http://httpd.apache.org/docs/2.2/mod/mod_ldap.html#settingcerts) + [mod_authnz_ldap](http://httpd.apache.org/docs/2.2/mod/mod_authnz_ldap.html#authldapurl) (authldapurl)

# java - 为什么从 Oracle 查询符合 JDBC 的数据库不像馅饼那么容易？

> ID：198703
> 
> 赞同：0
> 
> 时间：2008-10-13T19:16:29.833
> 
> 标签：java, oracle, jdbc

好的，所以它*几乎*已经像馅饼一样容易了。但它真的应该比它更容易。

我想我应该能够通过将 JDBC 连接字符串放入 TNSNAMES 来连接到另一个数据库。每个数据库供应商都有一个 type-4 JDBC 驱动程序，而且通常有一个很好的免费替代方案。

鉴于 Oracle 是如此热衷于 Java 的粉丝，并且在数据库中内置了 JVM，我原以为基于 JDBC 的链接技术将是不费吹灰之力。在 TNSNAMES 中有一个 JDBC 连接字符串似乎是一个自然的扩展，并且一切都会“正常工作”——你可以对任何东西使用“sql*plus”。

但它不是这样工作的。如果你想连接到另一个非 Oracle 数据库，你必须购买一个叫做 Oracle 网关的东西或者使用 ODBC（通过一个叫做 Generic Connectivity 的东西）。

[**原创性警告**...这与我[以前的问题](https://stackoverflow.com/questions/186443/what-options-are-available-for-connecting-to-a-microsoft-sql-server-database-fr)有关，但有人建议我输入补充评论作为单独的问题。我与谁争辩？]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T00:50:26.570

答案与以下问题相同：

1.  为什么 Oracle 不提供将数据卸载为非专有格式（例如逗号分隔或 XML）的有效方法
2.  为什么大多数 Oracle 非 DB 产品只能与 Oracle RDBMS 一起使用？（无需使用 Oracle 数据库网关）

你听说过[供应商锁定](http://en.wikipedia.org/wiki/Vendor_lock-in)的概念吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T20:28:47.190

我当然认为这个问题有些修辞，并且需要大量盐分。:-)

本着这种精神，一个适当轻率的答案可能是“因为他们不希望您使用其他人的数据库”？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T21:32:54.067

这是一个真正的问题——也许有点开玩笑，但肯定不是修辞。让访问其他人的数据变得非常容易，这完全符合 Oracle 的利益。目前有很多方法可以做到这一点，但没有一个足够简单。数据库中有一个 JVM，每个其他数据库都有 JDBC 驱动程序——它应该“正常工作”，所以我只能假设它没有被“正常工作”是有原因的。

我的问题是是否有人知道这个原因。有没有人？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-14T03:35:40.200

TNS有点乱，恕我直言。在我（诚然有限的）经验中，它似乎在不同平台之间表现不一致。

为 Oracle 辩护对我来说远非如此，但我对 JDBC 瘦驱动程序没有任何问题。（如果您阅读 oracle jdbc 文档，他们会阻止您使用 oci，除非您有充分的理由。

将它与 JNDI（在 j2ee 应用服务器上）配对，您的所有连接管理问题都会得到解决。

# c# - 在您的代码周围提供导入

> ID：198705
> 
> 赞同：1
> 
> 时间：2008-10-13T19:17:05.683
> 
> 标签：c#, design-patterns, mef

在我的[MEF](http://www.codeplex.com/MEF)使用中，我有一堆我想在我的代码的许多其他部分中提供的导入。就像是：

```
[Export (typeof (IBarProvider))]
class MyBarFactory : IBarPovider
{
    [Import]
    public IFoo1Service IFoo1Service { get; set; }

    [Import]
    public IFoo2Service IFoo2Service { get; set; }

    [Import]
    public IFoo3Service IFoo3Service { get; set; }

    [Import]
    public IFoo4Service IFoo4Service { get; set; }

    [Import]
    public IFoo5Service IFoo5Service { get; set; }

    public IBar CreateBar()
    {
        return new BarImplementation(/* want to pass the imported services here */);
    }
}

class BarImplementation : IBar
{
    readonly zib zib;

    public BarImplementation(/* ... */)
    {
        this.zib = new Zib(/* pass services here, too */);
    }
} 
```

我可以将每个导入的服务作为单独的参数传递，但这是很多无聊的代码。一定有更好的东西。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-16T05:39:57.390

我不完全确定这是否能回答您的问题，但您是否考虑过使用构造函数注入？

```
class BarImplementation : IBar
{
    [ImportingConstructor]
    public BarImplementation(IFoo1Service foo1, IFoo2Service foo2, ...) { }
} 
```

通过使用 ImportingConstructor 属性标记您的构造函数，它实际上将使该构造函数的所有参数都需要导入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-13T19:18:25.023

我想过制作一个接口来提供这些服务：

```
partial class BarImplementation
{
    public IRequiredServices
    {

        public IFoo1Service IFoo1Service { get; set; }
        public IFoo2Service IFoo2Service { get; set; }  
        public IFoo3Service IFoo3Service { get; set; }          
        public IFoo4Service IFoo4Service { get; set; }      
        public IFoo5Service IFoo5Service { get; set; }
    }
} 
```

然后`MyBarFactory`实现`BarImplementation : BarImplementation.IRequiredServices`. 这很容易写，但是，我如何将它们传递给`Zib`? 我不想以`Zib`这种方式与它的消费者耦合。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T19:19:40.403

我可以创建`IImports`一个包含我导入的所有服务的接口，将其传递到任何地方，然后类可以使用或不使用它们喜欢的任何一个。但这将所有课程结合在一起。

# .net - 用户根据给定 System.Windows.Forms.KeyEventArgs 中的值键入了哪些可打印字符（如果有）？

> ID：198707
> 
> 赞同：3
> 
> 时间：2008-10-13T19:17:59.503
> 
> 标签：.net, winforms, datagridview

作为解决问题的方法，我认为我必须处理 KeyDown 事件来获取用户实际键入的可打印字符。

KeyDown 为我提供了具有 KeyCode、KeyData、KeyValue、Modifiers、Alt、Shift、Control 属性的 KeyEventArgs 对象。

我的第一次尝试只是将 KeyCode 视为 ascii 代码，但我键盘上的 KeyCode 是 46，一个句点（“.”），所以当用户键入删除键时，我最终打印了一个句点。所以，我知道我的逻辑是不充分的。

（对于那些好奇的人，问题是我在 DataGridView 的控件集合中有自己的组合框，并且不知何故我键入的某些字符不会产生 KeyPress 和 TextChanged ComboBox 事件。这些字母包括 Q、$、%...。

此代码将重现该问题。生成一个 Form App 并用此代码替换 ctor。运行它，然后尝试在两个组合框中输入字母 Q。

```
public partial class Form1 : Form
{
    ComboBox cmbInGrid;
    ComboBox cmbNotInGrid;
    DataGridView grid;

    public Form1()
    {
        InitializeComponent();

        grid = new DataGridView();

        cmbInGrid = new ComboBox();
        cmbNotInGrid = new ComboBox();

        cmbInGrid.Items.Add("a");
        cmbInGrid.Items.Add("b");
        cmbNotInGrid.Items.Add("c");
        cmbNotInGrid.Items.Add("d");

        this.Controls.Add(cmbNotInGrid);
        this.Controls.Add(grid);
        grid.Location = new Point(0, 100);
        this.grid.Controls.Add(cmbInGrid);
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-11-26T01:39:45.247

许多控件会覆盖默认的键输入事件。例如，面板默认情况下根本不会响应它们。至于简单控件的情况，您可以尝试：

```
protected override bool IsInputKey(Keys keyData) {
    // This snippet informs .Net that arrow keys should be processed in the panel (which is strangely not standard).

    switch (keyData & Keys.KeyCode) {
        case Keys.Left:
            return true;
        case Keys.Right:
            return true;
        case Keys.Up:
            return true;
        case Keys.Down:
            return true;
    }
    return base.IsInputKey(keyData);

} 
```

IsInputKey 函数告诉您的程序从哪些键接收事件。如果您覆盖显然具有特殊功能的键，您可能会遇到奇怪的行为，但请进行一些试验并亲自查看哪些有效，哪些无效。

现在，对于更高级的控件，如 DataGridView 或 ComboBox，键处理可能会更加复杂。以下资源应该为您提供一些关于如何解决问题的提示：

[http://www.dotnet247.com/247reference/msgs/29/148332.aspx](http://www.dotnet247.com/247reference/msgs/29/148332.aspx)

或者此资源可能会解决您的问题：

[http://dotnetperls.com/previewkeydown](http://dotnetperls.com/previewkeydown)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T13:25:11.367

Just as an idea to throw out there, if it looks like your `DataGridView` is intercepting keyboard events before they can reach your child control, can you provide your own handlers for the keyboard events you are interested in directly on the `DataGridView`, and in the handler method(s), (1) suppress the `DataGridView`'s normal handling of the event, and/or (2) manually pass the event along to your child control?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T19:27:35.753

看看 System.Text.Encoding.ASCII 和 System.Text.Encoding.Default

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T19:52:26.377

尝试：

```
KeysConverter converter = new KeysConverter();
string key = converter.ConvertTo(e.KeyCode, typeof(string)); 
```

但是你描述的行为很奇怪。在这些情况下，您应该获得 KeyPress ......尝试做一个简单的例子（只是一个带有 KeyPreview = true 和 KeyPress 事件处理的表单），看看你得到了什么。还要在显示表单时检查语言栏，可能输入法与您的预期不同。

# sql-server - sql 2005 中的 PIVOT

> ID：198716
> 
> 赞同：8
> 
> 时间：2008-10-13T19:19:42.650
> 
> 标签：sql-server, sql-server-2005, pivot

我需要旋转一列（数字列）。示例需要此数据：

```
a 1
a 2
b 3
b 4
c 5
d 6
d 7
d 8
d 9
e 10
e 11
e 12
e 13
e 14 
```

看起来像这样

```
a 1 2
b 3 4
c 5
d 6 7 8 9
e 10 11 12 13 14 
```

任何帮助将不胜感激...

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-14T01:56:54.580

使用`ROW_NUMBER()`,`PIVOT`和一些动态 SQL（但不需要游标）：

```
CREATE TABLE [dbo].[stackoverflow_198716](
    [code] [varchar](1) NOT NULL,
    [number] [int] NOT NULL
) ON [PRIMARY]

DECLARE @sql AS varchar(max)
DECLARE @pivot_list AS varchar(max) -- Leave NULL for COALESCE technique
DECLARE @select_list AS varchar(max) -- Leave NULL for COALESCE technique

SELECT @pivot_list = COALESCE(@pivot_list + ', ', '') + '[' + CONVERT(varchar, PIVOT_CODE) + ']'
        ,@select_list = COALESCE(@select_list + ', ', '') + '[' + CONVERT(varchar, PIVOT_CODE) + '] AS [col_' + CONVERT(varchar, PIVOT_CODE) + ']'
FROM (
    SELECT DISTINCT PIVOT_CODE
    FROM (
        SELECT code, number, ROW_NUMBER() OVER (PARTITION BY code ORDER BY number) AS PIVOT_CODE
        FROM stackoverflow_198716
    ) AS rows
) AS PIVOT_CODES

SET @sql = '
;WITH p AS (
    SELECT code, number, ROW_NUMBER() OVER (PARTITION BY code ORDER BY number) AS PIVOT_CODE
    FROM stackoverflow_198716
)
SELECT code, ' + @select_list + '
FROM p
PIVOT (
    MIN(number)
    FOR PIVOT_CODE IN (
        ' + @pivot_list + '
    )
) AS pvt
'

PRINT @sql

EXEC (@sql) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T20:16:18.260

这个相关问题应该有你需要的答案：[SQL Server: Examples of PIVOTing String data](https://stackoverflow.com/questions/24470/sql-server-pivot-examples)

SSRS 中的矩阵控件具有动态列，如果此数据无论如何都绑定到报表，那么您可以使用它。否则，您将必须创建一个 sql sproc 来动态生成示例中的 sql，然后执行它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-13T20:29:52.867

只是因为我想获得更多的 CTE 经验，所以我想出了以下内容：

```
WITH CTE(CTEstring, CTEids, CTElast_id)
AS
(
    SELECT string, CAST(id AS VARCHAR(1000)), id
    FROM dbo.Test_Pivot TP1
    WHERE NOT EXISTS (SELECT * FROM dbo.Test_Pivot TP2 WHERE TP2.string = TP1.string AND TP2.id < TP1.id)
    UNION ALL
    SELECT CTEstring, CAST(CTEids + ' ' + CAST(TP.id AS VARCHAR) AS VARCHAR(1000)), TP.id
    FROM dbo.Test_Pivot TP
    INNER JOIN CTE ON
        CTE.CTEstring = TP.string
    WHERE
        TP.id > CTE.CTElast_id AND
        NOT EXISTS (SELECT * FROM dbo.Test_Pivot WHERE string = CTE.CTEstring AND id > CTE.CTElast_id AND id < TP.id)
)
SELECT
    t1.CTEstring, t1.CTEids
FROM CTE t1
INNER JOIN (SELECT CTEstring, MAX(LEN(CTEids)) AS max_len_ids FROM CTE GROUP BY CTEstring) SQ ON SQ.CTEstring = t1.CTEstring AND SQ.max_len_ids = LEN(t1.CTEids)
ORDER BY CTEstring
GO 
```

它可能需要一些调整，但它适用于您的示例

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-13T20:44:41.120

此处也可以使用合并函数，类似于关于连接数据的其他问题。

[如何创建 SQL Server 函数以将子查询中的多行“加入”到单个分隔字段中？](https://stackoverflow.com/questions/6899/is-there-a-way-to-create-a-mssql-function-to-join-multiple-rows-from-a-subquery#6924)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-13T21:09:42.897

我不确定你正在做的事情在 SQL 中是否真的可能（或至少是实用的） - 我不确定，因为我仍然不确定你想要做什么。

您可以在客户端应用程序中构建该数据透视表，例如：

```
select distinct Letter from MyTable 
```

获取字母列表，然后在循环内使用参数化查询：

```
select Number from MyTable where Letter=:letter 
```

获取每个字母的数字列表。

# controls - asp:SiteMapPath 与动态图像

> ID：198717
> 
> 赞同：1
> 
> 时间：2008-10-13T19:20:09.047
> 
> 标签：controls, asp.net-3.5, sitemappath

好的，所以我正在构建面包屑，并且根据面包屑的值，图像将成为分隔符。因此“HOME”将有一个图像，“SEARCH”将有另一个图像。

我知道我可以以编程方式做到这一点（至少我假设），但有没有更简单的方法来做到这一点？我可以根据节点的值将图像链接到节点吗？我可以用 PathSeparatorTemplate 来做吗？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T19:56:49.313

你可以放一个

```
<asp:Image ... /> 
```

进入 PathSerparatorTemplate 但您仍然必须从代码中设置图像 url。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-13T22:17:07.910

我看到你已经接受了一个答案，但我认为一些代码会有所帮助，所以这里有一些：

## Site1.Master

* * *

```
 <asp:SiteMapPath ID="SiteMapPath1" Runat="server" OnItemDataBound="Item_Bound">
        <PathSeparatorTemplate>
            <asp:Image ID="SepImage" runat="server" ImageUrl="/images"/>
        </PathSeparatorTemplate>
    </asp:SiteMapPath> 
```

## Site1.Master.cs

* * *

```
 private string lastItemKey = "";
    public void Item_Bound(Object sender, SiteMapNodeItemEventArgs e)
    {
        if (e.Item.ItemType == SiteMapNodeItemType.PathSeparator)
        {
            string imageUrl = ((Image) e.Item.Controls[1]).ImageUrl;
            imageUrl += lastItemKey + ".png";
            ((Image) e.Item.Controls[1]).ImageUrl = imageUrl;
        }
        else
        {
            lastItemKey = e.Item.SiteMapNode.Key;
        }
    } 
```

然后我有一个`/images`目录，其中包含每个`Key`s 的图像`SiteMapNode`。换句话说：此代码将导致在每个路径节点之后显示的图像取决于它之前节点的键。

希望这可以帮助某人。

# jakarta-ee - ColdFusion web.xml？

> ID：198720
> 
> 赞同：3
> 
> 时间：2008-10-13T19:20:40.307
> 
> 标签：jakarta-ee, coldfusion

在 J2EE Web 容器中找到的部署描述符/web.xml 文件是否有 ColdFusion 模拟？我知道 CF 运行在 JRun 之上，我可以调整 JRun dd，但是特定于应用程序的配置文件呢？有没有这样的事情我不知道，或者你只需​​要自己动手？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-13T19:30:46.887

ColdFusion 8 有几个特定于应用程序的配置，可以在 application.cfc 文件中设置

application.cfc 还实现了在应用程序执行期间发生的几个“一般事件”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-22T18:49:49.143

有几个区域等效设置
`application.cfc`或在旧站点上`application.cfm`
CFAdmin 工具对数据源、JVM 等有更多设置
取决于您使用的框架，可能有额外的 .xml 配置文件。
Fusebox 使用：文件调用`fusebox.xml`和`circuit.xml`
FW/1 使用附加设置`application.cfc`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-13T19:34:52.697

您可以在 Application.cfc [http://www.bennadel.com/blog/726-ColdFusion-Application-cfc-Tutorial-And-Application-cfc-Reference.htm](http://www.bennadel.com/blog/726-ColdFusion-Application-cfc-Tutorial-And-Application-cfc-Reference.htm)上查看此帖子。

如果您使用的不是具有 Application.cfc 的 Coldfusion 版本，您将需要查看 Application.cfm，它的实现方式与 Application.cfc 完全不同。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-14T12:41:17.947

有一个 jrun.xml 文件允许进行一些配置。它在 CF7 和 CF8 中可用。我只对这个文件做了一些小的调整，例如将 ip 地址绑定到 CF 实例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-04-13T20:19:39.917

ColdFusion 提供位于 \ColdFusion8\wwwroot\WEB-INF 的客户端和服务器部署描述符文件。文件分别是 client-config.wsdd 和 server-config.wsdd

# php - 在 PHP 中将 Word 文档转换为可用的 HTML

> ID：198721
> 
> 赞同：5
> 
> 时间：2008-10-13T19:20:43.927
> 
> 标签：php, ms-word

我有一组想要使用我编写的 PHP 工具发布的 Word 文档。我将 Word 文档复制并粘贴到文本框中，然后使用 PHP 程序将它们保存到 MySQL 中。我遇到的问题来自 Word 文档具有的所有非标准字符，例如弯引号和省略号（“...”）。我目前所做的是手动搜索并用纯文本或 HTML 实体（é ; 等）替换这些类型的东西（以及诸如 e-acute 之类的外来符号）是否有 PHP 中可以调用的函数Word 文档的输出，并将应为实体的所有内容转换为实体，并将其他在 Firefox 中无法正确显示的符号转换为可以显示的符号。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-13T19:34:33.477

这在过去对我很有帮助：

```
$str = mb_convert_encoding($str, 'HTML-ENTITIES', 'UTF-8') 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-13T19:27:01.810

更好的解决方案是确保您的数据库设置为支持 UTF-8 字符。扩展集中可用的附加字符应涵盖您正在谈论的所有“非标准”字符。

否则，如果您确实必须将这些字符转换为 HTML 实体，请使用[htmlentities()](http://www.php.net/htmlentities)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-05-18T09:32:01.977

我认为所有这些答案都忽略了一个要点。Windows 本身使用 latin1 的 Windows 风格，因此如果您将一些特殊字符（如不对称引号）粘贴到 Windows 机器上的表单中，然后将其发送到 unix（或任何非 muckrosoft）框（即发送到数据库）或其他）某些字符与 unix 系统所理解的任何内容都不匹配，因此字符混乱和乱码。这意味着即使你有一个 UTF-8 数据库，并使用 htmlentities，一些讨厌的东西仍然会通过，因为它们是操作系统无法识别的字符——它们甚至不是 UTF-8 的一部分——是微软独有的发明。

我对这一切的掌握有点不稳定 - 查看[http://www.cs.tut.fi/~jkorpela/www/windows-chars.html](http://www.cs.tut.fi/~jkorpela/www/windows-chars.html)以获得我在上面截取的简短形式的出色解释。- 如果有人有更好的解决方案（肯定有一个！）如何 PHPify 这篇文章的解释......我很想听听！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T19:28:50.900

htmlspecialchars() 会让你走得很远，但要小心，因为 Word 文档很乱。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-07-03T04:46:39.810

这是我为非便携式 Windows 字符集的问题准备的解决方案。这会将有问题的几乎是拉丁语 1 字符替换为等效的 HTML 实体。

```
$translation=array(
    // reference from http://www.cs.tut.fi/~jkorpela/www/windows-chars.html
    "\x82" => "&#8218;",
    "\x83" => "&#402;",
    "\x84" => "&#8222;",
    "\x85" => "&#8230;",
    "\x86" => "&#8224;",
    "\x87" => "&#8225;",
    "\x88" => "&#710;",
    "\x89" => "&#8240;",
    "\x8a" => "&#352;",
    "\x8b" => "&#8249;",
    "\x8c" => "&#338;",
    "\x91" => "&#8216;",
    "\x92" => "&#8217;",
    "\x93" => "&#8220;",
    "\x94" => "&#8221;",
    "\x95" => "&#8226;",
    "\x96" => "&#8211;",
    "\x97" => "&#8212;",
    "\x98" => "&#732;",
    "\x99" => "&#8482;",
    "\x9a" => "&#353;",
    "\x9b" => "&#8250;",
    "\x9c" => "&#339;",
    "\x9f" => "&#376;",
);    
return str_replace(array_keys($translation),array_values($translation),$input); 
```

它对我^(有用 TM)

# svn - 跨不同程序开发的库的 Subversion 存储库布局

> ID：198726
> 
> 赞同：13
> 
> 时间：2008-10-13T19:23:54.793
> 
> 标签：svn, repository

我负责几个（相当小的）程序，它们通过不同的库共享大量代码。我想知道最好的存储库布局是开发不同的程序（和库），并使库在所有程序中保持同步。

为了争论，假设有两个程序有两个库：

*   程序1
    *   图书馆1
    *   图书馆2
*   程序2
    *   图书馆1
    *   图书馆2

自然地，库的错误修复和增强应该（最终）合并到所有程序中。由于在处理不同程序时正在处理这些库，因此使用[外部定义](http://svnbook.red-bean.com/en/1.5/svn.advanced.externals.html)似乎是不可能的。

所以我想把我的图书馆除了一个地方当作[供应商分支](http://svnbook.red-bean.com/en/1.5/svn.advanced.vendorbr.html)，但我不确定最好的布局是什么。

我在想一些事情：

*   图书馆
    *   图书馆1（祖先）
    *   图书馆2（祖先）
*   程序1
    *   程序1代码
    *   Library1（供应商分支）
    *   Library2（供应商分支）
*   ...

然后说在开发 Program1 时对 Library2 进行了一些更改，我将它们合并回存储库的库部分，并在需要时将它们从那里合并到所有其他程序。

合并到其他程序并不总是立即发生，在 Program2 上工作的人可能会接近发布，而是先完成发布，创建一个标签，然后才更新所有库。

我有点担心这会在一段时间后导致许多合并和一些维护头痛，但我真的没有看到更好的解决方案。

再说一次，这对我来说似乎是一个相当常见的用例，所以我想我只是问问 stackoverflow 社区，实现这一目标的最佳存储库布局是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-13T19:48:52.717

好吧，我想我不同意外部因素是不可能的。我过去也遇到过类似的问题。我使用 svn 属性外部解决了它。

创建您的库存储库：

```
svnadmin create /path/library1
svnadmin create /path/library2
... 
```

创建客户端存储库：

```
svnadmin create /path/program1
svnadmin create /path/program2
... 
```

现在将库声明为程序存储库中的外部库：

```
cd /path/program1
svn propset svn:externals "library1 svnpath://wherever/library1/trunk/" .
svn propset svn:externals "library2 svnpath://wherever2/library2/trunk/" . 
```

现在，您可以对程序 1 和 2 进行更改，并且在这些项目的根目录进行提交不会影响库......但是，如果您需要对库进行更改，您可以。然后，当且仅当您对库存储库具有写入权限时，您也可以提交这些更改 - 但只能从库的子目录中提交。

即这不会对库做出承诺......

```
... make a change in /path/program1/library1 ... 
cd /path/program1
svn commit -m "some change" 
```

这提交了在上面的库中所做的更改：

```
cd /path/program1/library1
svn commit -m "change to library code" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T19:44:00.447

为什么库的源代码必须存在于程序树中。分别编译您的库并将它们链接到您的程序中。

# ruby-on-rails - 激活用户时带有acts_as_state_machine的restful_authentication中的DoubleRenderError

> ID：198740
> 
> 赞同：1
> 
> 时间：2008-10-13T19:28:08.780
> 
> 标签：ruby-on-rails, ruby, authentication, restful-authentication

在使用`restful_authentication`with`acts_as_state_machine`和电子邮件激活的项目中，每当用户从电子邮件链接执行激活操作时，我都会收到双重渲染错误。

我正在使用默认值

```
def activate
   self.current_user = params[:activation_code].blank? ? false : User.find_by_activation_code(params[:activation_code])
   if logged_in? && !current_user.active?
   current_user.activate!
   flash[:notice] = "Signup complete!"
   end
   redirect_back_or_default('/')
end 
```

激活，默认

```
def redirect_back_or_default(default)
  redirect_to(session[:return_to] || default)
  session[:return_to] = nil
end 
```

重定向。重定向方法在以相同方式调用的所有其他情况下都有效。

双重渲染错误发生在路由为“/”的页面 main_page/home 的渲染中。

我应该寻找什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-14T08:21:23.260

充当状态机有时会出现一些奇怪的行为，即写入数据库的已保存记录与内存中的对象不同步。我敢打赌，即使正在设置数据库中的字段（反之亦然），与新激活的用户对应的 ruby​​ 对象也没有更新。

我需要查看实际运行的控制器操作以呈现您设置的与“/”匹配的路线，但我敢打赌，您在该操作中遇到了微妙的不一致情况，这些情况被 AASM 中的这种不一致所困扰。尝试在该控制器操作开始时重新加载用户对象，以查看问题是否消失。如果没有通过确保您的状态更改实际保存到数据库来开始调试。

# build - 在 Jam 中定义跨目录依赖

> ID：198743
> 
> 赞同：2
> 
> 时间：2008-10-13T19:30:14.877
> 
> 标签：build, build-tools, jam

在使用 make 多年之后，我刚刚开始在我的项目中使用 jam（实际上是 ftjam）。

在我的项目工作区中，我有两个目录：

*   `src`我在哪里构建可执行文件和库
*   `test`我的测试程序在哪里

我正在尝试建立对测试程序的依赖关系，以便每次编译它们时，库也会重新编译（如果需要的话）。

关于如何做的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T16:02:53.263

好的，这似乎不像我想的那么简单，所以我自己想出了一个解决方案。它使用脚本来实现最终结果，所以我仍然希望 Jam 大师将有一个仅果酱的解决方案。

*   使用通用定义在项目的根目录中创建一个 Jamrules。

*   在项目根目录下创建一个Jamfile，内容如下：

```
    子目录。;
    子包括 。源代码；
    子包括 。测试 ;

```

*   在 src 目录下创建一个 Jamfile

```
    子目录 .. src ;
    图书馆 mylib : mylib.c ;

```

*   在 test 目录下创建一个 Jamfile

```
    子目录 .. 测试；
    主要 mytest : mytest.c ;
    取决于 mytest : mylib$(SUFLIB) ;

```

使用此设置，只要我在根目录中，每当我尝试构建 mytest 时，库也将被重新编译（如果需要）。我在干扰器邮件列表上发现了一条旧消息，描述了它。

唉，如果我在 test 子目录中，这不起作用，因为 jam 只能查看*子目录*。

因此，我创建了一个名为的简单脚本`jmk`并将其与`jam`可执行文件放在一起（以便两者都在路径中）：

```
if [ "$JMKROOT" = "" ] ; then
   JMKROOT=`pwd`
   export JMKROOT
fi
cd $JMKROOT
jam $* 
```

我将 JMKROOT 环境变量设置为我的项目的根目录。

因为当我在 Windows shell 中编译时（这就是我想使用 Jam 的原因），我只需使用这个小`jmk.bat`批处理文件：

```
@echo off
if "%JMKROOT%" EQU "" set JMKROOT=%CD%

set OLDCD=%CD%
cd %JMKROOT%
jam %1 %2 %3 %4 %5 %6 %7 %8 %9

cd %OLDCD% 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-26T00:03:50.660

我在我的[一个项目](http://github.com/Andromeda-OS/LLVM)中使用 Jam ，我遇到了你的情况。我在子目录中有我的可执行程序`bin`，我的静态库保存在`lib`子目录中。

在我的顶级 Jamfile 中，我输入`SubDir TOP ;`. 这会将变量初始化`$(TOP)`为指向包含此 Jamfile 的目录。然后我添加诸如`SubInclude TOP bin llvm-tblgen`and之类的行`SubInclude TOP lib Support`，它将 Jamfiles 的内容添加到构建中`bin/llvm-tblgen`和`lib/Support`构建中。

在 Jamfile in 中`bin/llvm-tblgen`，我输入`SubDir TOP bin llvm-tblgen ;`. 我在 Jamfile 中做同样的事情`lib/Support`，但我`SubDir TOP lib Support ;`改用它。输入`SubDir`规则时的关键是输入从`TOP`到包含此 Jamfile 的目录的每个子目录的名称。

然后，当需要设置可执行目标的链接线时，我会像这样引用支持库`$(TOP)/lib/Support/libLLVMSupport.a`：Jam 将此路径扩展到`libLLVMSupport.a`相对于我运行 Jam 的位置的位置，即使我 cd 进入该`bin/llvm-tblgen`目录并从那里手动运行 Jam。

这使得管理包含跨目录依赖项的大型项目变得非常容易。此解决方案与您之前的解决方案不同，它允许您直接运行 Jam。希望对你有帮助！

# asp.net-mvc - 删除 *.cs、*.Designer.cs 代码隐藏文件？

> ID：198744
> 
> 赞同：2
> 
> 时间：2008-10-13T19:30:46.183
> 
> 标签：asp.net-mvc, code-behind

是的，这有点毫无意义，但我想知道......我的所有这些代码隐藏文件都弄乱了我的 MVC 应用程序。据我所知，我需要这些文件的唯一原因是告诉 ASP.NET 我的页面扩展自 ViewPage 而不是 Page。

我尝试了几个不同的 Page 指令更改，但我发现没有任何东西可以让我识别页面的基类并让我删除代码隐藏文件。

有没有办法做到这一点？

**更新**：我正在尝试从强类型 ViewPage 继承！似乎可以从常规 ViewPage 继承...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-13T19:47:58.943

删除代码隐藏并使用如下页面指令：

```
<%@ Page Title="Title" Inherits="System.Web.Mvc.ViewPage" Language="C#" MasterPageFile="~/Views/Layouts/Site.Master" %> 
```

或者，如果您想摆脱代码隐藏但仍想使用强类型视图，请阅读此链接：[http ://devlicio.us/blogs/tim_barcz/archive/2008/08/13/strongly-typed-viewdata -没有-a-codebehind.aspx](http://devlicio.us/blogs/tim_barcz/archive/2008/08/13/strongly-typed-viewdata-without-a-codebehind.aspx)

这是一个剪切和粘贴的样子：

```
<%@ Page Inherits="System.Web.Mvc.ViewPage`1[[ABCCompany.MVC.Web.Models.LoginData, ABCCompany.MVC.Web]]" Language="C#" MasterPageFile="~/Views/Shared/Site.Master" %> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-13T19:47:30.097

假设您的代码隐藏中没有任何代码，为什么不将它们全部指向一个代码隐藏文件？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-13T19:56:55.133

开箱即用，您应该能够删除 .designer.cs 并且什么都不会损坏。后面的其他代码可能很有用，例如，如果您想强烈键入您的视图数据。

# .net - 您如何在进程中将本机映射到 IL 指令指针

> ID：198754
> 
> 赞同：11
> 
> 时间：2008-10-13T19:33:32.530
> 
> 标签：.net, profiling, clr-profiling-api

在使用 .NET 框架的非托管 API 来分析 .NET 进程内进程时，是否可以查找与提供给 StackSnapshotCallback 函数的本机指令指针相关的 IL 指令指针？

可能很明显，我正在拍摄当前堆栈的快照，并希望在堆栈转储中提供文件和行号信息。*托管堆栈资源管理器*通过查询`ISymUnmanagedMethod::GetSequencePoints`. 这很好，但是序列点与偏移量相关联，到目前为止我假设这些是从方法开始的偏移量（在中间语言中）。

[在对他的博客文章Profiler stack walk: Basics and beyond](https://web.archive.org/web/20190114032244/https://blogs.msdn.microsoft.com/davbr/2005/10/06/profiler-stack-walking-basics-and-beyond)的后续评论中，David Broman 表示可以使用`ICorDebugCode::GetILToNativeMapping`. 但是，这并不理想，因为获取此接口需要从另一个调试器进程附加到我的进程。

我想避免这一步，因为我想在拍摄这些快照时继续能够从 Visual Studio 调试器中运行我的应用程序。它可以更轻松地单击输出窗口中的行号并转到有问题的代码。

该功能是可能的......您可以在托管代码内部随意吐出一个行号堆栈跟踪，唯一的问题是它是否可访问。另外，我不想使用`System::Diagnostics::StackTrace`or`System::Environment::StackTrace`功能，因为出于性能原因，我需要延迟堆栈的实际转储..所以节省用于稍后解析方法名称和代码位置的成本是可取的.. . 以及混合本机和托管帧的能力。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-01T17:21:06.130

为了从 by 提供的本机指令指针转换为`ICorProfilerInfo2::DoStackSnapshot`中间语言方法偏移量，您必须采取两个步骤，因为`DoStackSnapshot`将`FunctionID`本机指令指针作为虚拟内存地址提供。

第 1 步，是将指令指针转换为本机代码方法偏移量。（从 JITed 方法开始的偏移量）。这可以通过`ICorProfilerInfo2::GetCodeInfo2`

```
ULONG32 pcIL(0xffffffff);
HRESULT hr(E_FAIL);
COR_PRF_CODE_INFO* codeInfo(NULL);
COR_DEBUG_IL_TO_NATIVE_MAP* map(NULL);
ULONG32 cItem(0);

UINT_PTR nativePCOffset(0xffffffff);
if (SUCCEEDED(hr = pInfo->GetCodeInfo2(functioId, 0, &cItem, NULL)) &&
    (NULL != (codeInfo = new COR_PRF_CODE_INFO[cItem])))
{
    if (SUCCEEDED(hr = pInfo->GetCodeInfo2(functionId, cItem, &cItem, codeInfo)))
    {
        COR_PRF_CODE_INFO *pCur(codeInfo), *pEnd(codeInfo + cItem);
        nativePCOffset = 0;
        for (; pCur < pEnd; pCur++)
        {
            // 'ip' is the UINT_PTR passed to the StackSnapshotCallback as named in
            // the docs I am looking at 
            if ((ip >= pCur->startAddress) && (ip < (pCur->startAddress + pCur->size)))
            {
                nativePCOffset += (instructionPtr - pCur->startAddress);
                break;
            }
            else
            {
                nativePCOffset += pCur->size;
            }

        }
    }
    delete[] codeInfo; codeInfo = NULL;
} 
```

第 2 步。一旦你从 natvie 代码方法的开头有了一个偏移量，你可以使用它来转换为从中间语言方法开始的偏移量，使用`ICorProfilerInfo2::GetILToNativeMapping`.

```
if ((nativePCOffset != -1) &&
    SUCCEEDED(hr = pInfo->GetILToNativeMapping(functionId, 0, &cItem, NULL)) &&
    (NULL != (map = new COR_DEBUG_IL_TO_NATIVE_MAP[cItem])))
{
    if (SUCCEEDED(pInfo->GetILToNativeMapping(functionId, cItem, &cItem, map)))
    {
        COR_DEBUG_IL_TO_NATIVE_MAP* mapCurrent = map + (cItem - 1);
        for (;mapCurrent >= map; mapCurrent--)
        {
            if ((mapCurrent->nativeStartOffset <= nativePCOffset) && 
                (mapCurrent->nativeEndOffset > nativePCOffset))
            {
                pcIL = mapCurrent->ilOffset;
                break;
            }
        }
    }
    delete[] map; map = NULL;
} 
```

然后可以使用符号 API 将代码位置映射到文件和行号

感谢[Mithun Shanbhag](http://social.msdn.microsoft.com/Forums/en-US/netfxtoolsdev/thread/ee47a207-5ee6-4e24-a89f-e2134a8eb7c8)指导寻找解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-17T23:01:14.387

```
Console.WriteLine("StackTrace: '{0}'", Environment.StackTrace); 
```

确保您的构建生成符号。

展开讨论：

> > 可能很明显，我正在拍摄当前堆栈的快照，并希望在堆栈转储中提供文件和行号信息。

鉴于此 - 看起来您不附加到流程的唯一原因是您可以在开发工具时轻松调试工具或其中的一部分。IMO 是在可用时不选择更好的设计（ICorDebug 或 w/e）的糟糕借口。其糟糕设计的原因是因为您的代码在（可能）外部二进制文件的进程空间中执行，从而在已知（或更糟 - 未知）损坏的进程状态中导致令人讨厌的（“有时”罕见）副作用（包括破坏其他人的数据）。这应该足够开始了，但即使是这样，也有一些多线程代码等边缘情况需要解决设计问题。

大多数人通常会问“你真正想做什么？” 作为对一种过于复杂的做事方式的回应。在**大多数**情况下，有一种更简单/更容易的方法。为本机代码编写了堆栈跟踪器后，我知道它可能会变得混乱。

现在，也许你最终可能会让一切正常，所以 - 只是我的 $.02

# visual-studio - 将 Visual Studio 资源文件转换为文本文件？

> ID：198772
> 
> 赞同：8
> 
> 时间：2008-10-13T19:38:16.653
> 
> 标签：visual-studio, localization, resource-file

我知道有一些工具可以将文本文件获取到 Visual Studio 的资源文件。但我想将我的资源文件中的文本转换为文本文件，以便翻译它们。还是有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-13T19:57:35.040

您可以使用**[Resx Editor](http://resx.sourceforge.net/)**，一个面向翻译的小型文件编辑器。

*   目标受众：译者。
*   支持的文件格式：Microsoft RESX 2.0

这是 Joannès Vermoel（免费工具的作者）关于它的[博客条目的链接。](http://blog.vermorel.com/?p=14)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-05T17:11:33.767

最后，我只是使用了一个快速破解：

```
public class Export
{
    public string Run()
    {
        var resources = new StringBuilder();

        var assembly = Assembly.GetExecutingAssembly();
        var types = from t in assembly.GetTypes()
                    where t != typeof(Export)
                    select t;
        foreach (Type t in types)
        {
            resources.AppendLine(t.Name);
            resources.AppendLine("Key, Value");
            var props = from p in t.GetProperties()
                        where !p.CanWrite && p.Name != "ResourceManager"
                        select p;
            foreach (PropertyInfo p in props)
            {
                resources.AppendFormat("\"{0}\",\"{1}\"\n", p.Name, p.GetValue(null));
            }

            resources.AppendLine();
        }
        return resources.ToString();
    }
} 
```

将此代码添加到包含 your.resx 文件的项目中（我的位于单独的“语言”项目中），然后使用以下代码将结果保存到 .csv 中，以便可以使用电子表格编辑器加载它。

```
var hack = new Languages.Export();
var resourcesSummary = hack.Run();
var cultureName = System.Threading.Thread.CurrentThread.CurrentCulture.Name;
using (TextWriter file = File.CreateText(@"C:\resources." + cultureName + ".csv"))
{
    file.Write(resourcesSummary);
} 
```

这不允许您将文件从 .csv 导入回您的 .resx 文件，以便对其进行编译。有一个可以做到这一点的实用程序会很好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-09T00:46:04.203

您可以使用[Simple Resx Editor](http://simpleresxeditor.blogspot.com/)，它有一些有趣的功能可以帮助您进入翻译过程。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-13T21:21:14.450

尽管它是反直觉的，但翻译 exe 而不是资源文件是一个更好的主意。在这里阅读原因：

[http://www.apptranslator.com/misconceptions.html](http://www.apptranslator.com/misconceptions.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-20T06:19:15.280

您可能想看看[Excel Resource Transfer](http://www.jollans.com/tiki/tiki-index.php?page=excelresourcetransfer)。它是 Microsoft Excel 的插件，用于从资源文件中导入和导出文本。有试用版。完整版售价 25 欧元。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-12-07T00:44:01.083

如果您正在为 Web 项目执行此操作，则进行国际化（包括翻译）的更好方法是使用[i18n nuget 包](https://github.com/turquoiseowl/i18n)。不仅可以更好地使用模板，而且还具有其他优点，例如本地化 URL。

这是来自 github 存储库的示例：

```
<div id="content">
    <h2>[[[Welcome to my web app!]]]</h2>
    <h3><span>[[[Amazing slogan here]]]</span></h3>
    <p>[[[Ad copy that would make Hiten Shah fall off his chair!]]]</p>
    <span class="button" title="[[[Click to see plans and pricing]]]">
        <a href="@Url.Action("Plans", "Home", new { area = "" })">
            <strong>[[[SEE PLANS & PRICING]]]</strong>
            <span>[[[Free unicorn with all plans!]]]</span>
        </a>
    </span>
</div> 
```

运行后期构建任务会生成一个 PO 数据库，该数据库可以提供给使用 PO 编辑工具（如[POEdit](http://poedit.net/)）的翻译人员来提供特定于区域设置的文本。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-16T12:52:24.380

您可以使用 Microsoft 的 winres.exe，它可以让您本地化 Windows 窗体，而无需使用 Visual Studio。它不会将资源保存到文本文件中，但其想法是每种文化的本地化专家都可以使用该工具生成应用程序的本地化版本。

这是一个更好的解释： http: [//msdn.microsoft.com/en-us/library/8bxdx003 (VS.80).aspx](http://msdn.microsoft.com/en-us/library/8bxdx003(VS.80).aspx)

# visual-studio - Windows Powershell 和 Visual Studio '08 路径

> ID：198777
> 
> 赞同：2
> 
> 时间：2008-10-13T19:39:55.993
> 
> 标签：visual-studio, powershell, configuration-files

我正在尝试将 Windows Powershell 配置为与 Visual Studio 一起使用。没什么特别的，只是把东西设置好，这样我就可以 cl & nmake。我认为我需要做的就是编辑路径设置（但我不知道如何在 WPSH 中进行设置）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T00:14:13.163

经过大量挖掘，我在 My Documents 中创建了一个名为**WindowsPowerShell**的目录，创建了一个名为**Microsoft.PowerShell_profile.ps1**的文件，并且（经过几次迭代）在其中插入了以下代码，它就可以工作了。

```
function Get-Batchfile($file) 
{
    $theCmd = "`"$file`" & set" 
    cmd /c $theCmd | Foreach-Object {
        $thePath, $theValue = $_.split('=')
        Set-Item -path env:$thePath -value $theValue
    }
}

Get-Batchfile("C:\Program Files\Microsoft Visual Studio 9.0\VC\vcvarsall.bat") 
```

感谢大家的友好帮助。:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T19:57:54.257

您可能想查看[这篇文章](https://stackoverflow.com/questions/138144/whats-in-your-powershell-profileps1file#139997)——它似乎很好地解决了您的问题（无论如何，它对我想要的东西有效）。

# .net - RegEx 判断字符串是否不包含特定字符

> ID：198781
> 
> 赞同：35
> 
> 时间：2008-10-13T19:43:06.113
> 
> 标签：.net, regex, regex-negation

这次很简单的问题。

我正在尝试使用正则表达式测试字符串是否不包含字符。我认为表达式的形式是“[^ *x* ]”，其中*x*是您不想出现的字符，但这似乎不起作用。

例如，

```
Regex.IsMatch("103","[^0]") 
```

和

```
Regex.IsMatch("103&","[^&]") 
```

两者都返回真（我希望假）。

我开始使用`"[^&]"`并认为可能需要将 & 转义为 \&，但这似乎没有什么不同。

想法？我认为这是一件小事。

另外，我使用的是 .NET，所以请记住这一点。

编辑1：

我找到[了这个](https://stackoverflow.com/questions/42990/regex-to-match-against-something-that-is-not-a-specific-substring)，但它似乎没有回答我遇到的问题。

编辑2：

我想回应[Kevin](https://stackoverflow.com/questions/198781/regex-to-tell-if-a-string-does-not-contain-a-specific-character#198793)和[Joel](https://stackoverflow.com/questions/198781/regex-to-tell-if-a-string-does-not-contain-a-specific-character#198796)的建议。这些建议确实会更快，但在这种情况下它们并没有实现我需要的灵活性，所以如果你通过搜索找到了这个问题，一定要看看他们的答案是否符合你的需求。在我的例子中，正则表达式被传递给 DataTable 验证方法，该方法循环遍历每一行并验证特定列中该行的内容是否与传入的 RegEx 匹配。因为我将重用这个方法对于正在验证的其他几个数据表，我想：

1.  使用 Regex 启用最广泛的验证，以及
2.  始终寻找正匹配（即，而不是使用 !Regex.IsMatch(cell, regexvariable)，我希望始终能够使用 Regex.IsMatch(cell, regexvariable)，因为大多数调用此方法的 DataTables 将使用正匹配而不是负匹配。

希望这会有所帮助。

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2008-10-13T19:45:27.310

你的解决方案是对的。您看到的匹配是针对其他字符的。你想说的是“嘿！我不想在整个字符串中看到这个字符”。

在这种情况下，你这样做：

```
Regex.IsMatch("103","^[^0]*$") 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-10-13T19:53:54.593

模式 [^0] 将匹配任何非零字符。在您的两个示例中，模式都将匹配第一个字符（“1”）。要测试整个字符串是否不包含零，模式应该是“^[^0]*$”。其内容如下：从字符串的开头开始，匹配任意数量的非零字符，紧随其后的是字符串的结尾。任何包含零的字符串都将失败。任何不包含零的字符串都会通过。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-13T19:46:19.757

如果您正在寻找字符串中的单个字符，那么正则表达式似乎有点矫枉过正。为什么不直接使用 .IndexOf 或 .Contains ？

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-13T19:45:44.830

解析器到达的第一个字符是“1”，对于 [^0] 和 [^&] 也是如此，因此在这两个示例中都将返回 true。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-13T19:47:52.983

你把你的否定放在错误的地方。 `[^x]`将匹配任何不是 x 的东西。如果 x 在字符串中，如果还有任何其他字符，则字符串仍然与表达式匹配。相反，如果 x 存在，您希望匹配 true，然后否定函数的结果：

```
Not Regex.IsMatch("103", "0")

Not Regex.IsMatch("103&", "&") 
```

并不是说这些简单的例子，普通的 String.IndexOf() 或 String.Contains() 会是更好的选择。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-03-23T20:24:55.443

我遇到了这个问题，寻找同样的东西，但对于 JavaScript。上面的表达式在我的情况下不起作用，但我遇到了下面的表达式。（以防万一其他寻找 JavaScript 解决方案的人也来到这里。）

`^((?!0).)*$`

这种结构称为[负前瞻](https://www.regular-expressions.info/lookaround.html)

# security - 为 asp.net 存储密钥、密码的安全方法

> ID：198803
> 
> 赞同：2
> 
> 时间：2008-10-13T19:51:35.380
> 
> 标签：security

为网站存储密钥和/或密码的最佳做法是什么。这些密钥用于各种第 3 方 Web 服务。最好将它们放在 Web.config 文件或数据库中，还是以某种方式加密？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-13T19:56:38.677

您可以将加密的值存储在 .config 文件中，ASP.NET 2.0 将即时解密它们。

您的配置将类似于：

```
<configSections>
   <section 
      name="sampleSection" 
      type="System.Configuration.SingleTagSectionHandler" 
   />
</configSections>

<MySecrets
   FavoriteMusic="Disco" 
   FavoriteLanguage="COBOL" 
   DreamJob="Dancing in the opening ceremonies of the Olympics" 
/> 
```

然后在与配置文件相同的目录中从命令行运行以下命令：

```
aspnet_regiis -pef MySecrets . 
```

来自 K. Scott Allen：

[http://odetocode.com/Blogs/scott/archive/2006/01/08/2707.aspx](http://odetocode.com/Blogs/scott/archive/2006/01/08/2707.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-13T19:56:36.570

假设您的数据库无法从外部世界访问，或者您已将其正确锁定，这将是存储密钥的首选方式。这允许您的所有应用程序从同一个密钥/密码存储中提取，从而非常快速和轻松地进行更改。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-13T19:59:59.120

取决于值更改的频率。如果它们永远不会改变，那么我会将它们保留在您的源代码中。

我会远离在 Web.Config 中存储更改的数据，因为更改它会强制重新启动应用程序池。

我的投票是将它们加密存储在数据库中，并为更改值提供一种简单的方法（例如，将值存储在缓存中并在用户更改它们时刷新它们）。

# html - 如何使用 Microsoft Enterprise Library 发送 HTML 格式的电子邮件？

> ID：198805
> 
> 赞同：7
> 
> 时间：2008-10-13T19:52:39.573
> 
> 标签：html, logging, enterprise-library

我知道如何使用文本格式化程序使用 Microsoft Enterprise Library 2.0 发送邮件。但这些电子邮件始终是纯文本的。entlib 2.0 有没有办法以 HTML 格式发送这些邮件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-14T15:02:59.830

好吧，这很有趣，我现在正在写自己的答案。

我所做的是使用 entlib 的源代码。

在 Microsoft.Practices.EnterpriseLibrary.Logging 和 Microsoft.Practices.EnterpriseLibrary.Logging.TraceListenerData

我找到了我需要的课程。

*   将 EmailMessage.cs 复制到 EmailMessageHTML.cs
*   将 EmailTraceListener.cs 复制到 EmailHTMLTraceListener.cs
*   将 EmailTraceListenerData.cs 复制到 EmailHTMLTraceListenerData.cs

将这些类放入您自己的新图书馆项目中。

在 EmailMessageHTML 中更改所有构造函数以匹配新的类名，然后在方法中添加以下行：

```
 protected MailMessage CreateMailMessage()
            {
              .....

                message.IsBodyHtml = true;
              .....

                return message;
            } 
```

之后，我不得不在 EmailHTMLTraceListener 中使用这个新的 EmailMessageHTML 类（将 EmailMessage 更改为 EmailMessageHTML），并在新的 EmailHTMLTraceListenerData.cs 文件中使用这个 EmailHTMLTraceListener。

编译这个新项目，然后在您的配置中使用它，如下所示（示例）

```
<loggingConfiguration 
name="Logging Application Block" 
tracingEnabled="true" 
defaultCategory="" 
logWarningsWhenNoCategoriesMatch="true">
    <listeners>
        <add toAddress="your@emailgoes.here"          
         fromAddress="yourserveraddress@goes.here" 
         subjectLineStarter="" 
         subjectLineEnder="My HTMLemailLogger" 
         smtpServer="localhost" smtpPort="25" 
         formatter="Text Formatter"                        
         listenerDataType="MYLibrary.HTMLEmailLogger.EmailHTMLTraceListenerData, 
         MYLibrary.HTMLEmailLogger, Version=2.0.0.0, 
        Culture=neutral, 
        PublicKeyToken=null" 
        traceOutputOptions="None" 
        type="MYLibrary.HTMLEmailLogger.EmailHTMLTraceListener, 
        MYLibrary.HTMLEmailLogger, 
        Version=2.0.0.0, 
        Culture=neutral, 
        PublicKeyToken=null" 
        name="EmailHTML TraceListener"/>
    </listeners>
</loggingConfiguration> 
```

并添加一个有效的类别来记录这个当然：

```
<add switchValue="All" name="OutOfBalanceBooking">
    <listeners>
        <add name="Database Trace Listener"/>
        <add name="EmailHTML TraceListener"/>
    </listeners>
</add> 
```

当然，您需要一些 HTML 文档才能使用 EntLib 登录。我把它留给读者作为练习。确实如此！现在，对于客户在网站上进行的每笔不平衡预订，我都会收到一封很好的 HTML 电子邮件……

# language-agnostic - 在网页上放置“发送给朋友”按钮是否有意义？

> ID：198819
> 
> 赞同：4
> 
> 时间：2008-10-13T19:57:35.007
> 
> 标签：language-agnostic

我们多久会在网页上看到“将此页面发送给朋友”之类的内容？嗯，我经常看到他们。

我的问题是，你们如何看待它的有效性？如果我点击了一个有趣的网页，并且我认为我的朋友会喜欢它，我可以从浏览器栏中复制 URL，将其粘贴到电子邮件中，然后按“发送”按钮。在我看来，它通常比网页上像这样的按钮/链接更快且更少错误意识。此外，我不太确定该网站如何处理我输入的电子邮件 - 他们不是存储它然后以 1/100 美元的价格出售给垃圾邮件发送者吗？

我的问题是——当你设计一个网站时，你会在页面上放置这样的链接吗（它经常出现在有一些新闻/文章的网站上）？它甚至有意义吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-13T19:59:41.773

我妈妈不知道如何在电子邮件或即时消息中发送 URL，但她确实经常使用“发送给朋友”按钮。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-13T20:19:12.997

告诉朋友按钮有许多不那么明显的用途。

**从用户的角度来看：** 告诉朋友按钮会提醒用户在他们自己可能没有想到的时候告诉朋友，从而增加推荐。作为页面的一部分，它更加引人注目。

它还消除了技术问题，例如知道如何粘贴或通过电子邮件发送链接、正确设置本地电子邮件、在自己的计算机上访问电子邮件等。

**从站长的角度来看：**

有些网站只是发送电子邮件。其他人可以做更多一些合法和道德的事情，有些则不然。

对于网站的所有者，由于引荐通过他们的服务器，它允许（如果他们选择）跟踪引荐。他们可以查看发送的页面、发送频率以及最受欢迎的页面。

他们还可能跟踪其他信息，这使他们可以进行比赛，可能会看到人们对他们的页面的看法等。

他们可能会跟踪电子邮件地址，这可能会为他们提供营销数据——例如，如果他们看到很多人正在分享在 aol.com 上的地址，他们可能会决定在 aol 上做更多的广告。

Referrals can also be incentivised, contests run, etc.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-13T19:59:40.010

不，我个人不会把它放在我的页面上，但对于不太懂技术的用户，我想这个按钮会有很大帮助。很多人不会在地址栏中的 URL 和他们正在查看的页面之间建立关联。我知道我妈妈已经好几年没有了。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-13T20:08:12.880

我根据客户的要求把它放在那里，我还分发了一个免费模块，它为 DotnetNuke 安装提供“告诉朋友”功能，它很受欢迎。

正如其他人指出的那样，这实际上取决于目标受众，更多精通技术的用户只会复制和粘贴，而不太精通技术的用户会发现“告诉朋友”样式模块的更多实际用途。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-13T20:14:19.060

当我不确定长 URL 的哪些位是我的朋友访问该页面所需的最低要求以及哪些位是与我在网站上的会话相关的数据时，我使用了这些按钮。

话虽如此，当我使用它们时，我已经将它们发送给自己，并从我收到的电子邮件中复制并粘贴了 URL！

正如其他人所指出的，非技术人员可能无法理解 URL 是什么，但所有人都可以轻松理解“发送给朋友”按钮。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-13T20:16:18.730

告诉朋友类型的功能还提供了一个机会来捕获您可能会错过的流量统计数据。如果您完全依赖人们将 URL 复制并粘贴到电子邮件中，那么您将无法判断这种情况发生的频率。如果您构建一个发送消息的表单，您可以计算有多少人发送了多少条消息。

像任何网络流量指标一样，这个指标是有缺陷的，但它可以为您提供这种行为的一个数量级，以及一种比较两种不同内容的接收方式的方法。

# coding-style - 摆脱匈牙利符号的最佳方法？

> ID：198825
> 
> 赞同：5
> 
> 时间：2008-10-13T19:59:10.947
> 
> 标签：coding-style, refactoring, hungarian-notation

假设您继承了一个 C# 代码库，该代码库使用一个具有 200 个静态方法的类来提供核心功能（例如数据库查找）。在那个班级的许多噩梦中，匈牙利符号（不好的那种）的大量使用。

您会重构变量名称以删除匈牙利符号，还是不理会它们？

如果您选择更改所有变量以删除匈牙利符号，您的方法是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-13T20:01:54.670

别管它。你的时间有更好的用途。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-10-13T20:04:46.023

重构——我发现这种规模的匈牙利符号确实会干扰代码的自然可读性，而练习是熟悉那里的内容的好方法。

但是，如果有其他团队成员知道代码库，则您需要就重构达成共识，并且如果任何变量暴露在一个项目之外，那么您将不得不让他们独自一人。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-10-13T20:01:05.670

右键单击变量名称，Refactor -> Rename。

有 VS 插件也可以做到这一点，但内置方法对我来说很好用。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-13T20:07:45.580

我会怎么做？假设我只需要维护代码而不以任何重要的方式重写它？**别管它。**当我*添加*代码时，使用现有的风格，意思是，使用那种丑陋的匈牙利符号（就像这让我觉得很脏。）

但是，嘿，如果你真的*渴望重构，*那么一次只做一点。每次处理它时，都要花十分钟重命名变量。稍微整理一下。几个月后你可能会发现它像口哨一样干净......

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-13T21:19:01.693

不要忘记有两种匈牙利符号。

最初的 Charles Simonyi HN，后来被称为 App's Hungarian 和后来被称为 System Hungarian 的令人憎恶的东西，在一些啄木鸟（这是一个技术术语）之后完全误解了[Simonyi 的原始论文](http://msdn.microsoft.com/en-us/library/aa260976.aspx)。

不幸的是，系统 HN 被 Petzold 和其他人传播，成为今天被正确认可的更占主导地位的堕胎。

阅读 Joel 关于原始 Apps Hungarian Notation 意图的[精彩文章](http://www.joelonsoftware.com/articles/Wrong.html)，并为匆忙中丢失的内容感到抱歉。

如果您拥有的是 App's Hungarian，那么在阅读了 Charles Simonyi 的原始文章和 Joel 的文章之后，您可能会想要保留它。

如果你掉进了一堆热气腾腾的匈牙利语系统？

所有赌注都取消了！

哇！（捂着鼻子说）（-：

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-13T20:04:36.850

如果您感到幸运并且只是希望匈牙利语消失，请隔离使用的匈牙利语前缀并尝试在文件中搜索和替换以将它们替换为*nothing*，然后进行清理并重建。如果错误数量很少，只需修复它。如果错误数量很大，请返回并首先将其分解为逻辑（按域）类，然后单独重命名（IDE 会有所帮助）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-13T20:07:40.417

我曾经在 VB6 时代虔诚地使用它，但是当 VB.NET 出现时就停止了，因为这是新的 VB 指南所说的。其他开发商没有。所以，我们有很多旧代码。当我对代码进行维护时，我会从我接触的函数/方法/子中删除符号。*除非*您对所有内容都进行了**非常好的单元测试**并且可以运行它们以证明没有任何 问题，否则我不会一次将其全部删除。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-13T20:09:51.300

你这样做会破坏多少？这是一个重要的问题要问自己。如果有很多其他代码使用该库，那么您可能只是通过重命名练习为人们（也许是您）创建工作。

我会把它放在重构时要做的事情清单上。至少那时每个人都希望你（暂时）打破图书馆。

也就是说，我对命名不佳的方法和变量感到非常沮丧，所以我可以联系起来。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-13T20:04:21.420

我不会用它来做一个项目。我会使用 VS 中的重构工具（实际上，我会使用 Resharper 的，但 VS 的工作正常）并以我被要求修改的任何方法修复所有变量。或者，如果我必须进行更大规模的更改，我会在我被要求*理解*的任何方法中重构变量名称。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-13T20:06:01.013

如果您有合法的需要删除和更改它，我会使用内置的重构工具或 Resharper 之类的工具。

然而，我会同意 Chris Conway 的观点并问你为什么，是的，这很烦人，但同时，很多时候“如果它没有坏就不要修复它”的方法是真的是最好的方法！

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-13T20:11:18.757

只有当你直接使用它时才改变它。并确保您有一个准备好应用的测试平台，以确保它仍然有效。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-13T20:46:22.727

我同意逐步淘汰匈牙利符号的最佳方法是在修改代码时重构代码。进行这种重构的最大好处是你应该围绕你正在修改的代码编写单元测试，这样你就有了一个安全网，而不是交叉手指并希望你不会破坏现有的功能。一旦你完成了这些单元测试，你就可以根据自己的喜好随意更改代码。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-13T20:53:41.743

我想说一个更大的问题是你有一个包含 200（！）方法的类！

如果这是一个非常依赖/变化很大的类，那么可能值得重构以使其更可用。

在这方面，Resharper 是绝对必须的（你可以使用内置的重构工具，但 Resharper 更好）。

开始寻找一组相关的方法，然后将它们重构为一个漂亮的小内聚类。更新以符合您的最新代码标准。

编译并运行您的测试套件。

有更多的能量吗？提取另一个类。
磨损 - 没有麻烦；明天回来再做一些。在短短几天内，您将征服野兽。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-10-13T21:00:14.367

我同意@Booji 的观点——当您出于其他一些好的原因已经访问代码时，按例行程序手动执行。然后，您将摆脱最常见的问题，剩下的由谁来关心。

我想问一个类似的问题，只是在我的情况下，有问题的代码是我自己的。我有一个非常古老的习惯，即使用 FoxPro 时代的“坏种”匈牙利语（打字很弱，范围界定不寻常）——我最近才改掉这个习惯。

这很难——这意味着在你的代码库中接受不一致的风格。就在一周前，我终于说出了“screw it”并开始了一个不带字母“p”的参数名称。我最初感受到的认知失调已经让位于自由感。世界并没有走到尽头。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-10-13T21:49:49.460

我一直在解决这个问题的方法是在遇到变量时一次更改一个变量，然后在您回来进行更深入的更改时执行更全面的更改。如果你像我一样，变量的不同命名法会让你疯狂一段时间，但你会慢慢习惯的。关键是一次一点地削减它，直到你拥有一切所需的地方。

或者，你可以完全抛弃你的变量，只让每个函数返回 42。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-13T21:26:25.717

在我看来，更大的问题是 200 方法的[God Object](http://en.wikipedia.org/wiki/God_object)类。我建议仅删除匈牙利符号的重构本身就是一种低价值、高风险的活动。除非围绕该类有大量的自动化单元测试可以让您对重构有信心，否则我认为您应该完全不理会它。

我想这样的一组测试不太可能存在，因为遵循 TDD 实践的开发人员会（希望）自然地避免首先构建一个上帝对象 - 编写全面的测试将非常困难。

然而，消除上帝对象并建立一个单元测试库具有更高的价值。我的建议是寻找机会重构类本身——也许当出现合适的业务需求/更改时需要更改该代码（因此希望附带一些购买和付费的系统和回归测试）。您可能无法证明一次性重构整个事物的努力是合理的，但您可以在机会出现时逐步进行，并测试更改。通过这种方式，您可以一点一点地将意大利面条代码转换为具有全面单元测试的更干净的代码库。

如果您愿意，您可以随时消除匈牙利语。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-11-25T15:55:09.763

实际上，我在这里为应用程序扩展做同样的事情。我的方法是使用 VIM 映射来搜索特定的匈牙利符号前缀，然后删除它们并根据需要修复大写。

示例（在 vimrc 中）：

```
"" Hungarian notation conversion helpers
"" get rid of str prefixes and fix caps e.g. strName -> name
map ,bs /\Wstr[A-Z]^Ml3x~
map ,bi /\Wint[A-Z]^Ml3x~
"" little more complex to clean up m_p type class variables
map ,bm /\Wm_p\?[A-Z]^M:.s/\(\W\)m_p\?/\1_/^M/\W_[A-Z]^Mll~
map ,bp /\Wp[A-Z]^Mlx~ 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2011-06-01T20:15:05.583

如果您只是为了重构而破坏代码，我会认真考虑让 i 独自一人，特别是，如果您要影响团队中可能依赖该代码的其他人。

如果您的团队对此重构感到满意，并投入时间来执行此操作（如果这意味着代码更具可读性/可维护性，将来可能会节省时间），请使用 Visual Studio（或您正在使用的任何 IDE ) 来帮助您重构代码。

但是，如果您的团队/老板不愿意承担这样的重大变化，我建议您采取一种有些非正统的、折中的方法。与其在一次扫描中完成所有重构，不如重构在正常维护期间需要触及的代码部分（更具体地说，函数）？随着时间的推移，这种缓慢的重构将使代码达到更清晰的状态，此时您可以通过最终扫描完成重构过程。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-12-16T01:48:54.087

使用此[java 工具删除 HN](https://gist.github.com/TKolbusz/1862bfa57b506a7b5e0afde4ea3e371f#file-hungariannotation-java)：

或者只是使用“replace”/“replace all”和下面的正则表达式将“c_strX”替换为“x”： [![正则表达式替换 HN](https://i.stack.imgur.com/1ffz1.png)](https://i.stack.imgur.com/1ffz1.png)

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2008-10-13T20:39:04.533

我喜欢匈牙利符号。不明白你为什么要摆脱它。

# ruby-on-rails - Activerecord 关联问题：让 has_many :through 工作

> ID：198831
> 
> 赞同：4
> 
> 时间：2008-10-13T20:00:44.750
> 
> 标签：ruby-on-rails, ruby, activerecord

我正在用 Ruby on Rails 构建一个应用程序，并且包含我的 3 个模型（以及它们的迁移脚本）来显示我正在尝试做什么，以及什么不起作用。下面是概要：我的应用程序中有属于团队的用户，每个团队可以有多个教练。我希望能够提取适用于用户的教练列表。

例如，用户 A 可能属于团队 T1 和 T2。T1 和 T2 团队可以有四名不同的教练，并且有一个共同的教练。我希望能够通过简单地说：

```
u = User.find(1)
coaches = u.coaches 
```

这是我的迁移脚本，以及我的模型中的关联。我在我的设计中做错了什么吗？我的联想正确吗？

```
class CreateUsers < ActiveRecord::Migration
  def self.up
    create_table :users do |t|
      t.column :login, :string, :default => nil
      t.column :firstname, :string, :default => nil
      t.column :lastname, :string, :default => nil
      t.column :password, :string, :default => nil
      t.column :security_token, :string, :default => nil
      t.column :token_expires, :datetime, :default => nil
      t.column :legacy_password, :string, :default => nil
    end
  end

  def self.down
    drop_table :users
  end
end

class CreateTeams < ActiveRecord::Migration
  def self.up
    create_table :teams do |t|
      t.column :name, :string
    end
  end

  def self.down
    drop_table :teams
  end
end

class TeamsUsers < ActiveRecord::Migration
  def self.up
    create_table :teams_users, :id => false do |t|
      t.column :team_id, :integer
      t.column :user_id, :integer
      t.column :joined_date, :datetime
    end
  end

  def self.down
    drop_table :teams_users
  end
end 
```

以下是模型（不是整个文件）：

```
class User < ActiveRecord::Base

  has_and_belongs_to_many :teams
  has_many :coaches, :through => :teams

class Team < ActiveRecord::Base
  has_many :coaches
  has_and_belongs_to_many :users

class Coach < ActiveRecord::Base
  belongs_to :teams
end 
```

当我试图拉动教练时会发生这种情况：

```
u = User.find(1)
=> #<User id: 1, firstname: "Dan", lastname: "Wolchonok">
>> u.coaches
ActiveRecord::StatementInvalid: Mysql::Error: #42S22Unknown column 'teams.user_id' in 'where clause': SELECT `coaches`.* FROM `coaches`    INNER JOIN teams ON coaches.team_id = teams.id    WHERE ((`teams`.user_id = 1)) 
```

这是sql中的错误：

Mysql::Error: #42S22Unknown column 'teams.user_id' in 'where clause': SELECT `coaches`.* FROM `coaches`INNER JOIN teams ON coaches.team_id = teams.id WHERE (( `teams`.user_id = 1))

我是否在 :through 子句中遗漏了什么？我的设计完全关闭了吗？有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-13T21:18:23.567

你不能连续两次做 has_many :through 。它会告诉你它是一个无效的关联。如果您不想像上面那样添加 finder_sql，您可以添加一个模仿您正在尝试做的事情的方法。

```
 def coaches
    self.teams.collect do |team|
      team.coaches
    end.flatten.uniq
  end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-13T20:44:33.603

它更像是多对多甚至更多的关系。我只想写一些sql：

```
has_many :coaches, :finder_sql => 'SELECT * from coaches, teams_users WHERE 
               coaches.team_id=teams_users.team_id 
               AND teams_users.user_id=#{id}' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-13T20:40:07.557

我不认为 ActiveRecord 可以处理在 has_many 关系中进行两步加入。为了使其工作，您必须将用户加入到 team_users 到团队到教练。through 选项只允许一个额外的连接。

相反，您必须使用 :finder_sql 选项并自己写出完整的连接子句。不是世界上最漂亮的东西，但当您尝试做一些与众不同的事情时，ActiveRecord 就是这样。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-13T21:32:45.580

您可以在 users 中删除“has_many :coaches, :through => :teams” 行，然后在您的 User 模型中手写一个 coaches 方法，如下所示：

```
def coaches
  ret = []
  teams.each do |t|
    t.coaches.each do |c|
      ret << c
    end
  end
  ret.uniq
end 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-14T02:31:11.873

虽然我喜欢编写 SQL，但我认为它不是这种情况下的理想解决方案。这是我最终在用户模型中所做的事情：

```
 def coaches
    self.teams.collect do |team|
      team.coaches
    end.flatten.uniq
  end

  def canCoach(coachee)
    u = User.find(coachee)

    coaches = u.coaches
    c = []
    coaches.collect do |coach|
      c.push(coach.user_id)
    end

    return c.include?(self.id)
  end 
```

我曾想过一举搞定，但我喜欢从用户对象中返回一系列教练对象的能力。如果有更好的方法，我很想看到改进的代码。

# visual-studio-2005 - 从 VS 05 中的资源中设置应用程序图标

> ID：198848
> 
> 赞同：3
> 
> 时间：2008-10-13T20:06:29.077
> 
> 标签：visual-studio-2005, resources, icons

我知道我可以将图标添加到项目的 Resources.resx 文件中，然后从代码中引用该图标。

如何从资源中设置整个EXE的图标？我所看到的只是一个浏览另一个文件的地方。我想使用我的资源中的当前图标文件，而不必在我的项目中有重复的文件......

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T20:09:26.527

添加应用程序图标的方式是必须从本地文件系统中选择它，然后在构建时将其嵌入到应用程序中。据我所知，不可能先从资源文件中提取它。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-10-13T20:11:04.980

我一直用来防止重复文件引用的一种解决方案是创建一个解决方案文件夹，例如“项目依赖项”。然后所有的引用都来自该文件夹，因此在构建它时，它会从 Project Dependencies 文件夹中提取。

这也适用于资源文件，只需先将它们复制到解决方案文件夹，然后将它们拖到您的资源中。

对于程序集图标，也只需浏览到 Project Dependencies 文件夹。

祝你好运！

# linux - 如何在 Linux（特别是 Fedora 9）上使我的默认（或任何静态）路由永久化？

> ID：198849
> 
> 赞同：7
> 
> 时间：2008-10-13T20:06:41.400
> 
> 标签：linux, installation, default, fedora, routes

我刚刚执行了最新（2008 年秋季）版本的 Fedora 9 Linux 的新安装，我很困惑它从来没有正确设置默认路由，即使在这个操作系统的迷宫中运行，也没有明显的方法。

当然，很明显可以像这样一次性完成：

```
 route add default gw gw1 metric 0 eth0 
```

或像这样：

```
 ip route add to default via 192.168.2.1 protocol static 
```

但是，这些都不能在重新启动后幸存下来。在读取 /etc/rc.d/init.d/network 时，它会尝试从 /etc/sysconfig/static-routes 中的文件中查找数据，但该文件从未存在过。所以，我尝试创建它并用数据填充它。这样做的问题是脚本在一个奇怪的地方放置了一个破折号（减号），我不确定如何处理。

当然，可以只编辑 /etc/rc.d/init.d/network，但那是不标准的。事实上，我唯一的其他资源似乎是编辑 rc.local，但这在启动序列中还不够早，无法用于诸如网络时间守护程序之类的事情。

我已经完成了我的功课——我已经阅读了所有的手册页、信息条目，并尝试了适当的方法，我什至还进行了相当多的网络搜索，但都无济于事——我的下一步，不在这里回答，将是注册 Fedora 邮件列表并在那里提问！或者，放弃并编辑脚本。

那么，一个人应该如何做到这一点呢？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-13T20:44:17.347

网关通常在 /etc/sysconfig/network-scripts/ifcfg-eth0 中设置，而不是在 /etc/sysconfig/network 中。例如，在我当前的机器上：

> /etc/sysconfig/网络

```
NETWORKING=yes
NETWORKING_IPV6=no
HOSTNAME=flyboys
NISDOMAIN=ekcineon 
```

> /etc/sysconfig/network-scripts/ifcfg-eth0

```
DEVICE=eth0
ONBOOT=yes
HWADDR=00:1d:09:31:3a:cc
NETMASK=255.255.255.0
IPADDR=150.102.65.30
GATEWAY=150.102.65.252
TYPE=Ethernet 
```

请注意，我设置了 HWADDR，因为我有两个以太网卡，并且我想确保将正确的一个分配给 eth0。第二张卡的配置在 /etc/sysconfig/network-scripts/ifcfg-eth1

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-09-18T16:26:31.810

只需编辑`/etc/sysconfig/network-scripts/route-ethXX`

并在里面写：**默认通过 ip_address dev device**，将**ip_address**替换为**您的网关 ip**，将**device**替换**为正确的 eth device 的名称**。但是对于**Device 选项**，它的 ... 可选，在多个 eth 设备的情况下设置它。即使在网络重启的情况下也能工作，rc.local 中的路由指令仅在启动时工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-13T20:09:00.850

我没有使用过最新版本的 Fedora，但它经常被设置为 /etc/sysconfig/network 中的 GATEWAY 变量。

当然，如果您只是想让它工作，您可以将命令放在 /etc/rc.local 中，以便在引导序列完成时执行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T20:21:34.100

没见过Fedora。但是这种事情不应该有一些GUI吗？如果您有 Gnome，请尝试运行`gnome-network-preferences`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-27T14:12:45.627

这是针对 RHEL 的，因为它略有不同：

1.  使用 ifconfig 识别接口
2.  sudo vi /etc/sysconfig/network-scripts/route-ethXX
3.  按照以下语法添加路由，其中​​ /xx 表示子网掩码

    > ```
    > host: 172.30.xxx.xxx via 172.30.xxx.xxx
    > network: 172.30.xxx.xxx/xx via 172.30.xxx.xxx
    > Default gateway: 0.0.0.0 via xxx.xxx.xxx.xxx</li> 
    > ```
    > 
    > *   保存文件。*   sudo /etc/init.d/network restart （警告：如果您忘记为管理界面设置正确的路由（如果适用），您可能会失去与服务器的连接）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-06-04T17:46:06.787

如果可用，您可以使用 nmcli，ei

```
 # nmcli con show
NAME         UUID                                  TYPE      DEVICE
System eth0  xxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx  ethernet  eth0
ens33        xxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx  ethernet  --

# nmcli con edit "System eth0"

nmcli> goto ipv4
You may edit the following properties: method, dns, dns-search, dns-options, dns-priority, addresses, gateway, routes, route-metric, route-table, routing-rules, ignore-auto-routes, ignore-auto-dns, dhcp-client-id, dhcp-timeout, dhcp-send-hostname, dhcp-hostname, dhcp-fqdn, never-default, may-fail, dad-timeout
nmcli ipv4>

nmcli ipv4> print
['ipv4' setting values]
ipv4.method:                            manual
ipv4.dns:                               --
ipv4.dns-search:                        --
ipv4.dns-options:                       --
ipv4.dns-priority:                      0
ipv4.addresses:                         10.10.10.1/26
ipv4.gateway:                           10.10.10.129
ipv4.routes:                            --
ipv4.route-metric:                      -1
ipv4.route-table:                       0 (unspec)
ipv4.routing-rules:                     --
ipv4.ignore-auto-routes:                no
ipv4.ignore-auto-dns:                   no
ipv4.dhcp-client-id:                    --
ipv4.dhcp-timeout:                      0 (default)
ipv4.dhcp-send-hostname:                yes
ipv4.dhcp-hostname:                     --
ipv4.dhcp-fqdn:                         --
ipv4.never-default:                     no
ipv4.may-fail:                          yes
ipv4.dad-timeout:                       -1 (default)
nmcli ipv4>

nmcli ipv4> set routes 192.168.122.0/24 10.10.10.1

nmcli ipv4> verify
Verify setting 'ipv4': OK
nmcli ipv4> save
nmcli ipv4> quit

#nmcli con up "System eth0" 
```

它应该使用适当的参数创建文件 /etc/sysconfig/network-scripts/routes-，例如

```
ADDRESS0=192.0.2.0
NETMASK0=255.255.255.0
GATEWAY0=198.51.100.1 
```

# visual-studio - Visual Studio 2003 合并模块

> ID：198852
> 
> 赞同：2
> 
> 时间：2008-10-13T20:07:32.023
> 
> 标签：visual-studio, visual-studio-2005, installation, visual-studio-2003, merge-module

我正在使用 Visual Studio 2005 进行安装。该应用程序依赖于使用 MFC 7.1（来自 Visual Studio 2003）构建的 DLL。

是否有 MFC 7.1 的合并模块或 MFC 8 的其他可再发行组件？在哪里可以找到它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-16T15:36:26.373

这些合并模块通常位于`%ProgramFiles%\Common Files\Merge Modules.`

查找这些文件：

*   `vc_user_crt71_rtl_x86_---.msm`（有 msvcr71.dll）
*   `vc_user_mfc71_rtl_x86_---.msm`（有 mfc71.dll）
*   `vc_user_stl71_rtl_x86_---.msm`（有 msvcp71.dll）
*   `vc_user_mfc71_loc_rtl_x86_---.msm`（具有 mfc71*.dll 本地化版本）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-14T04:54:00.963

`%ProgramFiles%\Microsoft Visual Studio .NET 2003\redist`假设您安装了 Visual Studio 2003，我希望 MFC 7.1 的合并模块位于. （但是，我无法验证这一点，因为这台 PC 上没有 Visual Studio。）

# .net - Linq to SQL - 您可以提交单个对象的更改吗？

> ID：198857
> 
> 赞同：1
> 
> 时间：2008-10-13T20:08:25.330
> 
> 标签：.net, linq-to-sql

Linq to SQL 是否支持向单个对象提交更改？SubmitChanges 方法将所有更改发送到数据库，但是如果我与错误日志表相关联并且只想将记录保存到错误日志中而不将所有更改提交到我的其他表怎么办？

示例：
对象操作（ID、名称、类型、描述、结果）
对象 ActionError（ActionID、ErrNum、ErrMsg）

Action 和 ActionErrors 按 ID 存在关联。在处理操作时，发生了一些我想记录错误的事情。我可以将一个新的 ActionError 对象添加到 ActionErrors 的集合中，但是如何在不对 Action 进行任何更改的情况下仅将这些对象发送到数据库？使用单独的数据上下文是否是在 Linq to SQL 中唯一想要完成的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T20:18:00.427

[这](http://west-wind.com/weblog/posts/246222.aspx)是一篇关于如何管理 Linq to SQL DataContext 的生命周期的好文章，可能会对您有所帮助...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T20:16:52.630

您可以使用带有 RefreshMode.OverwriteCurrentValues 的 DataContext 上的 Refresh() 方法刷新更改的实体集合，然后更新您的 ActionError 并提交更改。

FWIW。我还没有这样做，但是查看文档，这是我会尝试的。

# .net - 对不阻塞 GUI 线程的 MessageBox.Show 替换的建议？

> ID：198868
> 
> 赞同：3
> 
> 时间：2008-10-13T20:12:21.937
> 
> 标签：.net, user-interface, messagebox

不久前，我遇到了一种情况，我们需要向用户显示消息框以获取通知，但我们无法使用 MessageBox.Show，因为它阻塞了 GUI 线程（因此，当对话框处于活动状态时，屏幕上的任何内容都不会更新）。关于替代方案的任何建议？

[我当时编写了一个替代方案，但我不喜欢它。如果没有更好的情况出现，我会将其作为答案发布]

编辑：对话框必须浮动在主窗口的顶部；我不在乎它是否出现在任务栏中。在某些情况下，可能会同时激活多个对话框。

附录：我的解决方案是一个基本表单，它提供了 OK 和 CANCEL 按钮来发出 Completed 和 Canceled 事件；OK 为子类覆盖调用了一个虚拟 ValidateData。调用表单使用属性来避免每次重新创建表单（表单只是隐藏而不是关闭）并保留活动表单的字典以防止多次激活同一表单。这看起来像一个模态窗体，一次支持多个弹出窗体，但不占用主 GUI 线程。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-13T20:30:11.587

我同意 rslite 和 Mitchel Sellers 的观​​点。创建一个非模态表单来显示所需的信息是最好的方法。如果您有多个消息，您可能需要考虑将它们放入 ListBox 并让用户双击它们以获取需要显示的完整信息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-13T20:49:42.343

我建议像其他人所说的那样采用非模态方法，但更具体一点：

*   如果您只想要一个通知，您可以尝试一个气球提示（TNA 或您自己的），或者一个类似于 Outlook 邮件通知的窗口或许多即时消息程序（如 Trillian 显示）的通知。
*   如果您只是想给用户一个行动的机会，请使用非模态表单，但请记住他很可能只是单击它即可。
*   如果用户必须对您的消息采取行动，您应该使用模态。请注意，所有者窗口仍将被绘制并且您可以刷新您的 GUI - 模式对话框毕竟有一个消息泵，否则它将无法工作。我最近做了类似的事情，我们有一个后台工作线程池，它可以执行任何操作和触发事件以使 GUI 刷新，以及一个模式等待对话框，它仍然得到它的消息泵。所有者窗口确实按预期使用后台操作进行了更新。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-05-14T18:18:43.070

将[NotifyIcon](http://msdn.microsoft.com/en-us/library/system.windows.forms.notifyicon.aspx)添加到您的应用程序并显示[气球提示](http://msdn.microsoft.com/en-us/library/ms160064.aspx)怎么样。不利的一面是通知会在短时间内消失，但如果他们不需要采取行动，这对您的用户来说可能是最好的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-13T20:14:10.980

我会根据具体要求使用非模态对话框或一些工具提示来解决这个问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-13T20:16:17.327

如果您不希望它阻塞，我只需创建您自己的简单表单来进行显示。这就是我在需要非阻塞解决方案之前为客户完成项目的方式。但是请记住，如果您以非阻塞方式进行操作，那么如果用户真的是“您必须采取行动”类型的项目，那么用户可能会获得倍数并不知所措。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-13T05:22:57.387

感谢所有提供建议的人，看来我的解决方案是正确的;-)

我的解决方案是一个基本表单，它提供了 OK 和 CANCEL 按钮来发出 Completed 和 Canceled 事件；OK 为子类覆盖调用了一个虚拟 ValidateData。调用表单使用属性来避免每次重新创建表单（表单只是隐藏而不是关闭）并保留活动表单的字典以防止多次激活同一表单。这看起来像一个模态窗体，一次支持多个弹出窗体，但不占用主 GUI 线程。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-10-13T20:34:26.603

如果您想要 MessageBox 的外观和感觉，只需在后台线程中显示它。

```
ThreadPool.QueueUserWorkItem( (state) =>
    {
         MessageBox.Show("Your message");
    }); 
```

（代码未测试）

# google-maps - 谷歌地图是否尊重 KML 中的定义？

> ID：198870
> 
> 赞同：2
> 
> 时间：2008-10-13T20:14:11.447
> 
> 标签：google-maps, kml

我正在使用 GGeoXml 对象在嵌入式 Google 地图上覆盖 KML。我需要为地标自定义弹出气球，所以我尝试使用该[`<BalloonStyle>`](http://code.google.com/apis/kml/documentation/kmlreference.html#balloonstyle)元素：

```
<?xml version="1.0" encoding="utf-8"?>
<Document xmlns="http://earth.google.com/kml/2.0">
    <name>Concessions</name>
    <Style id="masterPolyStyle">
        ...
        <BalloonStyle>
            <text>
                <![CDATA[
                  <h6>Concession</h6>
                  <h4>$[name]</h4>
                  <p>$[description]</p>
                ]]>
            </text>
            <displayMode>default</displayMode>
            <bgColor>DDA39B81</bgColor>
        </BalloonStyle>
    </Style>

    ...

</Document> 
```

这在 Google 地球中按预期工作，但嵌入式地图 API 似乎完全忽略了这一点。我想我可以完全省略`<name>`元素，只将 HTML 中的所有内容放入`<description>`元素中，但我希望能够利用该[`<ExtendedData>`](http://code.google.com/apis/kml/documentation/kmlreference.html#extendeddata)元素以结构化方式显示自定义数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-24T20:57:37.420

这现在记录在这里（2009/04）：

[http://code.google.com/apis/kml/documentation/kmlelementsinmaps.html](http://code.google.com/apis/kml/documentation/kmlelementsinmaps.html)

*   <气球风格>没有

（你什么时候问这个的？这个论坛/服务在每个问题上都需要一个很大的日期，里面有一年:-)）

2$c, *派克

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-30T19:51:47.590

不，就像您提到的那样，描述中的 html 是我知道您可以通过 kml/georss 提要控制气球样式的唯一方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-14T14:18:32.377

实际上，上面引用的文档（[http://code.google.com/apis/kml/documentation/kmlelementsinmaps.html](http://code.google.com/apis/kml/documentation/kmlelementsinmaps.html)）一定已经改变了，b/c 现在它说：

> <BalloonStyle> 仅部分支持 <text>

我的问题是 <text> 似乎适用于一个 KML 文件，但不适用于另一个。适用的一个有多边形地标，另一个有图标表示的点 - 我想知道这是否是为什么......

# .net - 各种 .NET Framework 版本的操作系统兼容性

> ID：198873
> 
> 赞同：56
> 
> 时间：2008-10-13T20:14:34.223
> 
> 标签：.net, windows, version-compatibility

每个 .Net 框架的最低操作系统要求是什么？例如，哪个版本不可能在每个操作系统上运行：

*   视窗 95
*   视窗 98
*   视窗 98SE
*   视窗我
*   视窗 NT 3.x
*   视窗 NT 4
*   视窗 2000

我相信所有 .Net 框架都与 XP、Vista、Windows Server 2003 和 Windows Server 2008 兼容（如果有错误，请纠正我）。

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2008-10-13T20:30:49.807

1.x 和 2.0 一直工作到 Win98，但在 Windows 8 之前停止（未验证）。

* * *

[根据 Microsoft 的](http://msdn.microsoft.com/en-us/library/ms229070(VS.80).aspx).NET Framework 2.0 支持的操作系统：

*   视窗 98
*   视窗我
*   视窗 2000
*   视窗
*   Windows Vista（操作系统附带）
*   视窗服务器 2003
*   Windows Server 2008（包含在操作系统中）

* * *

.NET Framework 3.0 支持的操作系统：

*   视窗 XP SP2
*   Windows Vista（操作系统附带）
*   Windows 7的
*   视窗 8
*   Windows 2003 服务器服务包 1 (SP1)

注意：Windows Vista 附带 .NET Framework 3.0。独立的 .NET Framework 3.0 包不是必需的，而且在 Vista 上不受支持。

* * *

.NET Framework 3.5[根据 Microsoft](https://docs.microsoft.com/en-us/dotnet/framework/get-started/system-requirements#supported-client-operating-systems)支持的操作系统：

*   视窗
*   视窗
*   Windows 7（操作系统随附）
*   Windows 8 和 8.1[请参阅](https://support.microsoft.com/en-us/kb/3002547)
*   视窗服务器 2003
*   视窗服务器 2008
*   Windows Server 2012 和 2012 R2[请参阅](https://support.microsoft.com/en-us/kb/3002547)

* * *

.NET Framework 4.0[根据 Microsoft](https://docs.microsoft.com/en-us/dotnet/framework/get-started/system-requirements#supported-client-operating-systems)支持的操作系统：

*   Windows XP（但不是 Starter、Media Center 或 Tablet 版本）
*   视窗
*   Windows 7的
*   视窗 8
*   视窗 10
*   视窗服务器 2003
*   视窗服务器 2008

* * *

[根据 Microsoft 的](https://docs.microsoft.com/en-us/dotnet/framework/get-started/system-requirements#supported-client-operating-systems).NET Framework 4.5 支持的操作系统：

*   Windows Vista SP2
*   Windows 7的
*   Windows 8（操作系统随附）
*   视窗 10
*   视窗服务器 2008 SP2/R2
*   Windows Server 2012（包含在操作系统中）

* * *

.NET Framework 4.5.1/4.5.2/4.6 [Microsoft 支持的](https://docs.microsoft.com/en-us/dotnet/framework/get-started/system-requirements#supported-client-operating-systems)操作系统：

*   Windows Vista SP2
*   视窗 7 SP1
*   视窗 8
*   Windows 8.1（包含在操作系统中）
*   Windows 10（操作系统随附 4.6）
*   视窗服务器 2008 SP2/R2
*   Windows Server 2012（包含在操作系统中）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-13T20:17:50.863

从 1.0 版开始，Windows 98 及更高版本支持 Microsoft .NET 框架，但以下情况除外：

```
Windows NT
Windows Server 2003 (Itanium-based) 
```

作为补充说明，我已经能够通过基于 Linux 的机器上的 Mono 在 2.0 版以下的平台上相当可靠地运行 .NET IL 可移植可执行文件。虽然如果在 Mono 中编译它确实运行得更好。出于奇怪的原因，使用 Mono 包编译的 PE 比使用 Microsoft .NET 编译器编译的 PE 更接近 .NET IL 的书面标准。

[.NET 2.0 在 MSDN 上声明它与 Windows 98 兼容](http://msdn.microsoft.com/en-us/library/ms229070.aspx)

[.NET 3.0/3.5 需要 XP 或更高版本](http://msdn.microsoft.com/en-us/windowsvista/bb188202.aspx)：

```
Microsoft Windows 2003 Server Service Pack 1 (SP1)
Windows XP SP2
Windows Vista * 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-13T20:24:00.570

.Net 1、1.1 和 2.0 在 Windows 98 / Windows 2000 + NOT Windows NT 或 Windows 95 上均受支持。

.Net 3.0 / 3.5 仅在 Windows XP/Vista、Server 2003 和 Server 2008 版本上受支持。不再支持 Windows 98 和 2000。见[MSDN](http://msdn.microsoft.com/en-us/library/bb882520.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-13T20:21:05.740

**更新**：显然我错了。正如其他人所指出的，MSDN 声明 2.0 及更低版本也适用于 Win 98。

所有 .Net 版本都可以在 XP SP2 及更高版本上运行，尽管有些类还提供对 Vista 特定功能的支持，并且在 XP 上正常失败。我认为 1.0 曾经可以在 Windows 2000 上运行，但其他所有发布的 .Net 都需要 XP 或更高版本。

# javascript - img onload 在 IE7 中无法正常工作

> ID：198892
> 
> 赞同：14
> 
> 时间：2008-10-13T20:18:52.937
> 
> 标签：javascript, html, internet-explorer, image

我的 webapp 中有一个 img 标签，它使用 onload 处理程序来调整图像大小：

```
<img onLoad="SizeImage(this);" src="foo" > 
```

这在 Firefox 3 中运行良好，但在 IE7 中失败，因为由于某种原因，传递给`SizeImage()`函数的图像对象的宽度和高度为 0——也许 IE 在完成加载之前调用了该函数？在对此进行研究时，我发现其他人在使用 IE 时也遇到了同样的问题。我还发现这不是有效的 HTML 4。这是我们的文档类型，所以我不知道它是否有效：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
```

是否有合理的解决方案来调整加载图像的大小，最好是符合标准的解决方案？该图像用于用户上传自己的照片，几乎可以是任何尺寸，我们希望最大显示为 150x150。如果您的解决方案是在上传时调整图像服务器端的大小，我知道这是正确的解决方案，但我被禁止实施它:( 它必须在客户端完成，并且必须在显示器上完成。

谢谢。

**编辑**：由于我们应用程序的结构，在文档的 onload 中运行此脚本是不切实际的（几乎是不可能的）。我只能合理地编辑图像标签和它附近的代码（例如，我可以`<script>`在它的正下方添加一个）。此外，我们已经有 Prototype 和 EXT JS 库......管理层宁愿不必添加另一个（一些答案建议使用 jQuery）。如果可以使用这些框架解决这个问题，那就太好了。

**编辑 2**：不幸的是，我们必须支持 Firefox 3、IE 6 和 IE 7。也希望支持所有基于 Webkit 的浏览器，但由于我们的网站目前不支持它们，我们可以容忍仅适用于大3。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-13T20:34:03.577

如果你不需要支持 IE 6，你可以使用这个 CSS。

```
yourImageSelector {
    max-width: 150px;
    max-height: 150px;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-13T20:23:40.790

IE7 试图在 DOM 树完全呈现之前调整图像大小。您需要在 document.onload 上运行它......您只需要确保您的函数可以处理传递给非“this”元素的引用。

或者......我希望这不是一个易燃的进攻...... jQuery 让这样的事情变得非常非常容易。

编辑以回应编辑1：

您可以`document.onload(runFunction);`在正文中的任何位置放置任何脚本标签。它仍然会等到加载文档才能运行该功能。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-11T19:26:25.730

我注意到 Firefox 和 Safari 无论如何都会在新图像上触发“加载”事件，但 IE 6 和 7 只有在它们确实必须从服务器获取图像时才会触发“加载”——如果图像是已经在本地缓存中。我玩了两种解决方案：

1）每次给图像一个唯一的http参数，网络服务器会忽略，比如

```
<img src="mypicture.jpg?keepfresh=12345" /> 
```

这有一个缺点，它实际上会破坏缓存，所以你在浪费带宽。但它可能会解决问题，而不必搞砸你的 JavaScript。

2) 在我的应用程序中，需要加载处理程序的图像由 JavaScript 动态插入。我不只是附加图像，然后构建一个处理程序，而是使用这段代码，它在 Safari、FF 和 IE6 和 7 中测试良好。

```
document.body.appendChild(newPicture);
if(newPicture.complete){
    doStuff.apply(newPicture);
}else{
    YAHOO.util.Event.addListener(newPicture, "load", doStuff);
} 
```

我正在使用 YUI（显然），但您可以使用框架中的任何工作来附加处理程序。函数 doStuff 期望在**此**附加到受影响的 IMG 元素的情况下运行，这就是我以**.apply**样式调用它的原因，您的里程可能会有所不同。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-10-16T23:14:09.323

jQuery 的代码。但是用其他框架很容易拨号。真的很有帮助。

```
var onload = function(){ /** your awesome onload method **/ };
var img = new Image();
img.src = 'test.png';

// IE 7 workarond
if($.browser.version.substr(0,1) == 7){
    function testImg(){
        if(img.complete != null && img.complete == true){ 
            onload();
            return;
        }
        setTimeout(testImg, 1000);
    }
    setTimeout(testImg, 1000);
}else{
    img.onload = onload
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-13T20:25:44.327

我会这样做的方式是使用 jQuery 来做类似的事情：

```
$(document).load(function(){
    // applies to all images, could be replaced 
    //by img.resize to resize all images with class="resize"
    $('img').each(function(){
        // sizing code here
    });
}); 
```

但我不是 javascript 专家；)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-06T20:06:47.463

如果您真的被卡住了， setTimeout() 可能是一种解决方法。只需将其设置为 2 或 3 秒 - 或在页面预计加载之后。

编辑：您可能想看看[这篇文章](http://www.jibbering.com/faq/faq_notes/closures.html#clMem)- 一直在底部关于 IE 内存泄漏......

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-04T19:58:50.737

> 编辑：由于我们应用程序的结构，在文档的 onload 中运行此脚本是不切实际的（几乎是不可能的）。

即使其他框架、库或代码将处理程序附加到该事件，也始终可以向`window.onload`（或任何事件）添加处理程序。

```
<script type="text/javascript">
function addOnloadHandler(func) {
    if (window.onload) {
        var windowOnload = window.onload;
        window.onload = function(evt) {
            windowOnload(evt);
            func(evt);
        }
    } else {
        window.onload = function(evt) {
            func(evt);
        }
    }
}

// attach a handler to window.onload as you normally might
window.onload = function() { alert('Watch'); };

// demonstrate that you can now attach as many other handlers
// to the onload event as you want
addOnloadHandler(function() { alert('as'); });
addOnloadHandler(function() { alert('window.onload'); });
addOnloadHandler(function() { alert('runs'); });
addOnloadHandler(function() { alert('as'); });
addOnloadHandler(function() { alert('many'); });
addOnloadHandler(function() { alert('handlers'); });
addOnloadHandler(function() { alert('as'); });
addOnloadHandler(function() { alert('you'); });
addOnloadHandler(function() { alert('want.'); });
</script> 
```

[这个答案](https://stackoverflow.com/questions/807878/javascript-that-executes-after-page-load/807997#807997)`addOnloadHandler()`与我的代码版本略有不同，使用`attachEvent`. 但是我在测试中发现，`attachEvent`似乎并不能保证处理程序按照您添加它们的顺序触发，这可能很重要。提供的功能保证处理程序按添加的顺序触发。

请注意，我传入`evt`了添加的事件处理程序。这不是绝对必要的，代码应该在没有它的情况下工作，但我使用的库希望将事件传递给`onload`处理程序，除非我将它包含在我的函数中，否则该代码将失败。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-14T08:51:38.403

您可以执行以下操作：

```
var img = new Image();
img.src = '/output/preview_image.jpg' + '?' + Math.random();
img.onload = function() {
  alert('pass')
} 
```

# c# - 如何将图像添加到我的 Run for RichTextBlock？

> ID：198910
> 
> 赞同：1
> 
> 时间：2008-10-13T20:26:49.380
> 
> 标签：c#, wpf

我编写了一个小型 WPF 应用程序，我喜欢在其中将文本添加到 RichTextBox 中，以便将最新的内容放在首位。我写了这个，它有效：

```
 /// <summary>
    /// Prepends the text to the rich textbox
    /// </summary>
    /// <param name="textoutput">The text representing the character information.</param>
    private void PrependSimpleText(string textoutput)
    {
        Run run = new Run(textoutput);
        Paragraph paragraph = new Paragraph(run);

        if (this.RichTextBoxOutput.Document.Blocks.Count == 0)
        {
            this.RichTextBoxOutput.Document.Blocks.Add(paragraph);
        }
        else
        {
            this.RichTextBoxOutput.Document.Blocks.InsertBefore(this.RichTextBoxOutput.Document.Blocks.FirstBlock, paragraph);
        }
    } 
```

现在我想制作该功能的新版本，它也可以添加小图像。我很茫然 - 可以添加图像吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-14T06:36:38.027

尝试以下操作：

```
BitmapImage bi = new BitmapImage(new Uri(@"C:\SimpleImage.jpg"));
Image image = new Image();
image.Source = bi;
InlineUIContainer container = new InlineUIContainer(image);            
Paragraph paragraph = new Paragraph(container); 
RichTextBoxOutput.Document.Blocks.Add(paragraph); 
```

InlineUIContainer 是这里的“魔法”……您可以向其中添加任何 UIElement。如果要添加多个项目，请使用面板来包装项目（即 StackPanel 等）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T23:26:04.900

RickTextbox.Document 是一个 FlowDocument，您几乎可以在其中添加任何实现 ContentElement 的内容。这包括 Image、Label、StackPanel 和所有其他 WPF 收藏夹。

查看[FlowDocument 概述](http://msdn.microsoft.com/en-us/library/aa970909.aspx)了解更多详细信息。

# graphics - ImageMagick 反射

> ID：198928
> 
> 赞同：5
> 
> 时间：2008-10-13T20:32:08.340
> 
> 标签：graphics, image, image-manipulation, imagemagick

简短的：

```
convert ( -size 585x128 gradient: )  NewImage.png 
```

如何更改上述 ImageMagick 命令，使其从现有图像中获取宽度和高度？我需要它保持单行命令。

* * *

细节：

我正在尝试使用 ImageMagick 以编程方式创建图像反射。我正在寻找的效果类似于您在查看水池边缘的物体时看到的效果。关于我在[这里](http://www.imagemagick.org/discourse-server/viewtopic.php?f=1&t=11585)尝试做的事情有一个很好的主题，但解决方案并不是我正在寻找的。由于我将从 C#.Net 应用程序调用 ImageMagick，因此我想使用一个没有任何临时文件的调用并通过标准输出返回图像。到目前为止，我有这个...

```
convert OriginalImage.png  ( OriginalImage.png -flip -blur 3x5 \
    -crop 100%%x30%%+0+0 -negate -evaluate multiply 0.3 \
    -negate  ( -size 585x128 gradient: ) +matte -compose copy_opacity -composite )
    -append NewImage.png 
```

这工作正常，但没有给我我正在寻找的确切褪色。它不是从上到下的漂亮的实心渐变，而是从左上角到右下角的渐变。我添加了 (-negate -evaluate multiply 0.3 -negate) 部分以使其更亮一点，因为我没有得到我想要的淡入淡出。我也不想在创建渐变时对图像的大小进行硬编码（-size 585x128 gradient:），如果可能的话，我还想保持原始图像的透明度。

要转到标准输出，我计划用“-”替换“NewImage.png”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-15T16:24:11.053

如果您从 C# 调用它，也许您可​​以在 C# 中检索图像尺寸。然后调用 ImageMagick 命令

```
command = String.Format("convert bar %1x%2",img.Width,img.Height) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-19T04:54:03.190

您应该将现有图像作为输入，并使用 -fx 而不是使用渐变伪格式自己创建渐变。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2010-04-23T19:20:40.167

这可能会有所帮助： [图像下的反射](http://www.alleluia.ch/systeme-dexploitation/commande/107-reflexion-sous-une-image)

```
#!/bin/sh

gamma=$1
source=$2
destination=$3
size=`identify -format "%wx%h" $source`

convert $source \
  \( -size $size xc:none \
  \( \( -flip $source -crop $size+0+0 \) \
  -size $size gradient: -gamma $gamma \
  -compose copy_opacity -composite \) \
  -compose blend -composite \) \
  -append $destination 
```

# .net-3.5 - 如何判断是否安装了 .NET 3.5 SP1？

> ID：198931
> 
> 赞同：91
> 
> 时间：2008-10-13T20:32:43.253
> 
> 标签：.net-3.5, installation

如何确定 SP1 是否已安装在具有 .NET 3.5 的服务器上？

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2008-10-13T20:40:45.717

看`HKLM\SOFTWARE\Microsoft\NET Framework Setup\NDP\v3.5\`。其中一项必须为真：

*   该`Version`键中的值应为**3.5.30729.01**
*   或者`SP`同一个键中的值应该是**1**

在 C# 中（取自第一条评论），您可以按照以下方式做一些事情：

```
const string name = @"SOFTWARE\Microsoft\NET Framework Setup\NDP\v3.5";
RegistryKey subKey = Registry.LocalMachine.OpenSubKey(name);
var version = subKey.GetValue("Version").ToString();
var servicePack = subKey.GetValue("SP").ToString(); 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-10-13T20:42:17.147

您可以使用服务器上的 IE访问[SmallestDotNet 。](http://www.smallestdotnet.com)这将告诉您版本，如果您已过时，还会提供下载链接。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-10-13T20:45:39.107

使用控制面板中的添加/删除程序。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2010-04-30T23:25:22.237

我在试图弄清楚如何在不访问远程桌面或注册表的情况下检测安装在服务器上的框架版本时来到这个页面，所以 Danny V 的回答对我有用。

```
string path = System.Environment.SystemDirectory;
path = path.Substring( 0, path.LastIndexOf('\\') );
path = Path.Combine( path, "Microsoft.NET" );
// C:\WINDOWS\Microsoft.NET\

string[] versions = new string[]{
    "Framework\\v1.0.3705",
    "Framework64\\v1.0.3705",
    "Framework\\v1.1.4322",
    "Framework64\\v1.1.4322",
    "Framework\\v2.0.50727",
    "Framework64\\v2.0.50727",
    "Framework\\v3.0",
    "Framework64\\v3.0",
    "Framework\\v3.5",
    "Framework64\\v3.5",
    "Framework\\v3.5\\Microsoft .NET Framework 3.5 SP1",
    "Framework64\\v3.5\\Microsoft .NET Framework 3.5 SP1",
    "Framework\\v4.0",
    "Framework64\\v4.0"
};

foreach( string version in versions )
{
    string versionPath = Path.Combine( path, version );

    DirectoryInfo dir = new DirectoryInfo( versionPath );
    if( dir.Exists )
    {
        Response.Output.Write( "{0}<br/>", version );
    }
} 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-10-13T21:13:15.260

看看这篇[文章](http://www.codeproject.com/KB/dotnet/frameworkversiondetection.aspx)，它显示了您需要查找的注册表项，并提供了一个 .NET 库来为您执行此操作。

首先，您应该通过查看 HKLM\Software\Microsoft\NET Framework Setup\NDP\v3.5\Install 来确定是否安装了 .NET 3.5，这是一个 DWORD 值。如果该值存在并设置为 1，则安装该版本的框架。

查看 HKLM\Software\Microsoft\NET Framework Setup\NDP\v3.5\SP，它是一个 DWORD 值，表示 Service Pack 级别（其中 0 表示没有 Service Pack）。

为了正确起见，您确实需要确保先安装 .NET Fx 2.0 和 .NET Fx 3.0，然后检查是否安装了 .NET 3.5。如果这三个都为真，那么您可以检查服务包级别。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2010-03-03T23:14:28.490

检查是否存在以下目录：

在 64 位机器中：%SYSTEMROOT%\Microsoft.NET\Framework64\v3.5\Microsoft .NET Framework 3.5 SP1\

在 32 位机器上：%SYSTEMROOT%\Microsoft.NET\Framework\v3.5\Microsoft .NET Framework 3.5 SP1\

其中 %SYSTEMROOT% 是 SYSTEMROOT 环境变量（例如 C:\Windows）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-13T20:52:48.703

假设名称无处不在“Microsoft .NET Framework 3.5 SP1”，您可以使用以下命令：

```
string uninstallKey = @"SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall";
using (RegistryKey rk = Registry.LocalMachine.OpenSubKey(uninstallKey))
{
    return rk.GetSubKeyNames().Contains("Microsoft .NET Framework 3.5 SP1");
} 
```

# grails - grails 索引页面的最佳实践

> ID：198936
> 
> 赞同：27
> 
> 时间：2008-10-13T20:34:12.187
> 
> 标签：grails, indexing, model

在 grails 应用程序中为索引页面填充模型的正确方法是什么？默认情况下没有 IndexController，是否有一些其他机制可以将这个和那个列表放入模型中？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-10-15T12:34:44.323

我不会声称这是正确的方式，但它是开始的一种方式。将控制器作为默认设置并不需要太多。向 UrlMappings.groovy 添加映射：

```
class UrlMappings {
    static mappings = {
      "/$controller/$action?/$id?"{
            constraints {
                // apply constraints here
            }
        }
      "500"(view:'/error')
     "/"
        {
            controller = "quote"
        }
    }
} 
```

然后将索引操作添加到现在的默认控制器：

```
class QuoteController {

    def index = {
        ...
    }
} 
```

如果您要加载的内容已经是另一个操作的一部分，只需重定向：

```
def index = {
    redirect(action: random)
} 
```

或者要真正实现一些重用，请将逻辑放入服务中：

```
class QuoteController {

    def quoteService

    def index = {
        redirect(action: random)
    }

    def random = {
        def randomQuote = quoteService.getRandomQuote()
        [ quote : randomQuote ]
    }
} 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-07-05T23:00:54.940

我无法让上面的 Ed T 的例子起作用。也许从那时起 Grails 发生了变化？

经过一些实验和一些在网上翻找后，我最终得到了这个`UrlMappings.groovy`：

```
 "/"(controller: 'home', action: 'index') 
```

我的 HomeController 看起来像这样：

```
class HomeController {

  def index = {
    def quotes = = latest(Quote.list(), 5)
    ["quotes": quotes, "totalQuotes": Quote.count()]
  }

} 
```

在 中`views/home`，我有一个`index.gsp`文件。这使得`index.gsp`视图中的文件变得不必要，所以我删除了它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-13T20:39:41.960

**好的答案：**如果您需要为索引页面填充模型，是时候从使用直接 index.gsp 更改为索引控制器了。

**邪恶的答案：**如果您创建一个控制器为“*”的过滤器，即使对于静态页面，它也会被执行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-02-03T09:44:14.000

在 grails 1.3.6 中仅添加

`"/index.gsp"(uri:"/")`

到 UrlMappings.groovy 对我来说效果很好。它与添加新控制器和之前描述的映射具有相同的效果。

下面是我完整的 UrlMappings.groovy：

```
class UrlMappings {

    static mappings = {
        "/$controller/$action?/$id?"{
            constraints {
                // apply constraints here
            }
        }

        "/"(view:"/index")
        "500"(view:'/error')

        "/index.gsp"(uri:"/")
    }
} 
```

# error-handling - 如何在 Intersystems Caché 中使用 $etrap 真正捕获所有错误？

> ID：198941
> 
> 赞同：1
> 
> 时间：2008-10-13T20:34:48.130
> 
> 标签：error-handling, intersystems-cache

因为这个，我一直在敲我的头。在构思 $etrap（错误处理特殊变量）的方式中，您必须小心真正捕获所有错误。我在这方面取得了部分成功。但是我仍然缺少一些东西，因为在用户模式（应用程序模式）下运行时，**内部缓存库**错误仍然会停止应用程序。

我所做的是：

```
ProcessX(var)

    set sc=$$ProcessXProtected(var)
    w !,"after routine call"
    quit sc

ProcessXProtected(var)

    new $etrap
    ;This stops Cache from processing the error before this context. Code
    ; will resume at the line [w !,"after routine call"] above
    set $etrap="set $ECODE = """" quit:$quit 0 quit"

    set sc=1 
    set sc=$$ProcessHelper(var)
    quit sc

ProcessHelper(var)

    new $etrap
    ; this code tells Cache to keep unwindind error handling context up
    ; to the previous error handling.
    set $etrap="quit:$quit 0 quit"

    do AnyStuff^Anyplace(var)

    quit 1

AnyStuffFoo(var)
    ; Call anything, which might in turn call many sub routines
    ; The important point is that we don't know how many contexts
    ; will be created from now on. So we must trap all errors, in any
    ; case.

    ;Call internal Cache library
    quit 
```

毕竟，我可以看到当我从提示符调用程序时它可以工作！但是当我从缓存终端脚本（应用程序模式，我被告知）调用时，它失败并中止程序（错误捕获机制无法按预期工作）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-20T12:42:58.313

是否可能仅在用户模式下设置了旧式错误陷阱 ($ZTRAP)？

这方面的文档非常好，所以我不会在这里全部重复，但关键是 $ZTRAP 不像 $ETRAP 那样是 New-ed。在某种程度上，它是“隐式更新的”，因为它的值仅适用于当前堆栈级别和后续调用。一旦您退出设置的级别，它就会恢复到任何先前的值。

此外，我不确定 $ETRAP 和 $ZTRAP 处理程序之间是否定义了优先顺序，但如果 $ZTRAP 具有更高的优先级，那将覆盖您的 $ETRAP。

您可以在调用库函数之前尝试自己设置 $ZTRAP。将其设置为不同于 $ETRAP 的值，这样您就可以确定触发了哪个。

即使这样也可能无济于事。如果在库函数中设置了 $ZTRAP，则新值将生效，因此这不会产生影响。这只会在 $ZTRAP 的值来自堆栈中的某个位置时对您有所帮助。

你没有提到是什么库函数导致了这个。我的公司有一些库函数的源代码，所以如果你能告诉我函数名，我会看看我能找到什么。请也给我 $ZVersion 的值，这样我可以确定我们谈论的是相同版本的 Cache。

# perl - 如何在 Perl 中使用原始套接字？

> ID：198945
> 
> 赞同：4
> 
> 时间：2008-10-13T20:35:34.680
> 
> 标签：perl, networking, sockets

您如何在 Perl 中获得**原始**套接字，那么构建用于它的数据包的最佳方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-13T20:52:08.190

与在 C 中所做的相同...通过在创建套接字时设置套接字类型。

在[CPAN](http://search.cpan.org/~rgarcia/perl-5.10.0/ext/Socket/Socket.pm)的示例中，使用**SOCK_RAW**而不是**SOCK_DGRAM** (UDP) 或**SOCK_STREAM** (TCP)。

注意：创建原始套接字通常需要管理权限（即 UNIX 上的 root）。Windows 操作系统可能禁用了创建原始套接字的功能，您只需对其进行测试并查看即可。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-13T20:39:48.417

也许搜索[CPAN](http://search.cpan.org)可能会有所帮助？ 我想到了[IO::Socket 。](http://search.cpan.org/dist/IO)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-13T23:35:21.557

起初我认为大多数以前的答案都没有回应这个问题。经过进一步思考，我认为作者可能没有问对正确的问题。

如果您正在编写应用程序，您通常不会想到“构建数据包”。您只需打开套接字，格式化数据有效负载，它就是使用您的数据构建数据包的协议栈。好的，如果您使用数据报，您确实需要定义、生成和解析您的有效负载。但是您通常让内核将其封装在网络级别（例如添加 IP 标头）或链路层（例如添加以太网帧）。您通常不使用 pcap。有时只需打包和解包，也许 vec 就足够了。

如果您正在编写一个不寻常的数据包处理器，例如主动恶意攻击工具、中间人进程或流量整形设备，那么更有可能是“构建数据包”并使用 pcap。也许 Net::Packet 也适合你。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-13T21:05:55.337

看起来[Net::RawIP](http://search.cpan.org/dist/Net-RawIP)是我想要的：

```
use Net::RawIP;
$a = new Net::RawIP;
$a->set({ip => {saddr => 'my.target.lan',daddr => 'my.target.lan'},
         tcp => {source => 139,dest => 139,psh => 1, syn => 1}});
$a->send;

$a->ethnew("eth0");
$a->ethset(source => 'my.target.lan',dest =>'my.target.lan');      
$a->ethsend;

$p = $a->pcapinit("eth0","dst port 21",1500,30);
$f = dump_open($p,"/my/home/log");
loop $p,10,\&dump,$f; 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-13T22:12:44.563

正如 austirg 和其他人所说，Socket 会很好地做到这一点：

```
use Socket;

socket my $socket, PF_INET, SOCK_RAW, 0 or die "Couldn't create raw socket: $!";

send $socket, $message, $flags, $to or die "Couldn't send packet: $!";

my $from = recv $socket, $message, $length, $flags or die "Couldn't receive from socket: $!"; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-13T20:44:42.837

获取套接字的基本调用是...socket()。它是 perl 5 的标准配置。perl 5 基本上为您提供了传统 UNIX 所做的标准 socket()、bind()、listen()、accept() 调用。

对于更面向对象的模型，请查看 IO::Socket。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-03-13T04:12:16.360

请注意，如果您尝试使用原始套接字发送一堆 SYN 数据包，那么您只需“使用 Socket；” 这将填满您的 ARP 表并用“没有可用的缓冲区空间”和“netstat”中的一堆“CLOSE_WAIT”条目轰炸（这会阻止您的机器进行任何类型的更多连接，直到其中一些被释放）。

或者换句话说 - 你确实需要 Net::RawIP - 它会有所作为。

# oracle - 让用户访问 Oracle 中的其他模式的正确方法

> ID：198952
> 
> 赞同：14
> 
> 时间：2008-10-13T20:39:30.010
> 
> 标签：oracle, schema, grant, sql-grant

我在 Oracle 中有两个用户 Bob 和 Alice，他们都是通过从 sqlplus 作为 sysdba 运行以下命令创建的：

```
   创建由 $password 标识的用户 $blah；
   向 $blah 授予资源、连接、创建视图；

```

我希望 Bob 能够完全访问 Alice 的模式（即所有表），但我不确定要运行什么授权，以及是以 sysdba 还是以 Alice 的身份运行它。

很高兴听到关于参考资料的任何好的指针——似乎无法从 Internet 或我办公桌上的“Oracle 数据库 10g 完整参考”中得到一个好的答案。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-13T20:41:59.753

AFAIK 你需要一次做一个授权对象。

通常，您会使用脚本来执行此操作，类似于：

```
SELECT 'GRANT ALL ON '||table_name||' TO BOB;'
FROM   ALL_TABLES
WHERE  OWNER = 'ALICE'; 
```

其他数据库对象也类似。

您可以在需要发出授权的每个模式中放置一个包，从该模式中将通过 EXECUTE IMMEDIATE 调用每个 GRANT 语句。

例如

```
 PROCEDURE GRANT_TABLES
   IS
   BEGIN

      FOR tab IN (SELECT table_name
                  FROM   all_tables
                  WHERE  owner = this_user) LOOP
         EXECUTE IMMEDIATE 'GRANT SELECT, INSERT, UPDATE, DELETE ON '||tab.table_name||' TO other_user';
      END LOOP;
   END; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-13T20:49:14.327

有很多事情需要考虑。当您说访问权限时，您是否要在表前加上其他用户名？您可以使用公共同义词，以便隐藏原始所有者（如果这是一个问题）。然后授予同义词的权限。

您还想尽可能提前计划。稍后，您是否希望 Frank 也能够访问 Alice 的模式？您不想重新授予对 N 个表的权限。使用数据库角色将是一个更好的解决方案。例如，将选择授予角色“ALICE_TABLES”，当另一个用户需要访问权限时，只需授予他们对该角色的权限。这有助于组织您在数据库中所做的授权。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-05-07T14:05:02.443

如果您有不同的所有者，则另一种解决方案：

```
BEGIN

  FOR x IN (SELECT owner||'.'||table_name ownertab
            FROM   all_tables
            WHERE  owner IN ('A', 'B', 'C', 'D'))
  LOOP
    EXECUTE IMMEDIATE 'GRANT SELECT ON '||x.ownertab||' TO other_user';
  END LOOP;
END; 
```

# c - 是否可以在不使用函数的情况下初始化 const 结构？

> ID：198970
> 
> 赞同：12
> 
> 时间：2008-10-13T20:44:26.927
> 
> 标签：c

我在一些 C 代码中有一个相当简单的 const 结构，它只包含一些指针，并且如果可能的话希望静态初始化它。我可以吗？如果可以，怎么做？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-13T20:47:46.810

如果指针指向全局对象，您可以：

```
// In global scope
int x, y;
const struct {int *px, *py; } s = {&x, &y}; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-13T20:48:10.380

```
const struct mytype  foo = {&var1, &var2}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T19:18:19.097

const 结构*只能*静态初始化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-09-10T11:21:56.673

但是，如果有一些`struct`如下：

```
struct Foo
{
    const int a;
    int b;
}; 
```

我们想动态创建指向`struct`using的指针`malloc`，所以我们可以玩这个把戏：

```
struct Foo foo = { 10, 20 };
char *ptr = (char*)malloc(sizeof(struct Foo));
memcpy(ptr, &foo, sizeof(foo));
struct Foo *pfoo = (struct Foo*)ptr; 
```

这非常有用，尤其是当某些函数需要返回指针时`struct Foo`

# javascript - ASP.NET 正则表达式验证器（密码强度）

> ID：198974
> 
> 赞同：10
> 
> 时间：2008-10-13T20:44:46.143
> 
> 标签：javascript, asp.net, regex, validation

我有一个具有以下表达式的验证控件：

```
(?=(.*\\d.*){2,})(?=(.*\\w.*){2,})(?=(.*\\W.*){1,}).{8,} 
```

这是一个至少有**2 个数字**、**2 个字母字符**、**1 个非字母数字**和**8 个字符**的密码。不幸的是，这似乎不兼容跨浏览器。

此验证在 Firefox 中完美运行，但在 Internet Explorer 中却不行。

***您的每个答案的组合导致：***

```
var format = "^(?=.{" + minLength + ",})" + 
    (minAlpha > 0 ? "(?=(.*[A-Za-z].*){" + minAlpha + ",})" : "") + 
    (minNum > 0 ? "(?=(.*[0-9].*){" + minNum + ",})" : "") + 
    (minNonAlpha > 0 ? "(?=(.*\\W.*){" + minNonAlpha + ",})" : "") + ".*$";

EX: "^(?=.{x,})(?=(.*[A-Za-z].*){y,})(?=(.*[0-9].*){z,})(?=(.*\W.*){a,}).*$" 
```

重要的部分是具有 (?.{x,}) 的长度**first**。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-13T21:23:39.577

`(?=(.*\W.*){0,})`不是 0 个非字母数字字符。它*至少是 0*个非字母数字字符。如果您希望密码不包含任何非字母数字字符，您可以执行`(?!.*\W)`或`(?=\w*$)`。

一个更简单的解决方案是跳过`\W`前瞻，并使用`\w{8,}`而不是`.{8,}`.

此外，`\w`包括`\d`. 如果您只想要 alpha，您可以选择`[^\W\d]`或`[A-Za-z]`。

```
/^(?=(?:.*?\d){2})(?=(?:.*?[A-Za-z]){2})\w{8,}$/ 
```

这将验证密码至少包含**两个数字**、**两个字母**、**至少 8 个字符长**，并且**仅包含字母数字字符**（包括下划线）。

*   `\w`=`[A-Za-z0-9_]`
*   `\d`=`[0-9]`
*   `\s`=`[ \t\n\r\f\v]`

**编辑：** 要在所有浏览器中使用它，您可能需要执行以下操作：

```
var re = new RegExp("^(?=(?:.*?\\d){2})(?=(?:.*?[A-Za-z]){2})\\w{8,}$");
if (re.test(password)) { /* ok */ } 
```

**Edit2：**问题的最新更新几乎使我的整个答案无效。`^^;;`

如果您将模式替换为原来的模式，您最终应该仍然能够使用 JavaScript 代码。

**编辑3：**好的。现在我明白你的意思了。

```
/^(?=.*[a-z].*[a-z])(?=.*[0-9].*[0-9]).{3,}/.test("password123") // matches
/^(?=.*[a-z].*[a-z])(?=.*[0-9].*[0-9]).{4,}/.test("password123") // does not match
/^(?=.*[a-z].*[a-z]).{4,}/.test("password123")                   // matches 
```

在 Internet Explorer 中，它似乎`(?= )`并不是真正的零宽度。

[http://development.thatoneplace.net/2008/05/bug-discovered-in-internet-explorer-7.html](http://development.thatoneplace.net/2008/05/bug-discovered-in-internet-explorer-7.html)

**Edit4：**更多阅读：http: [//blog.stevenlevithan.com/archives/regex-lookahead-bug](http://blog.stevenlevithan.com/archives/regex-lookahead-bug)

我认为这可以解决您的问题：

```
/^(?=.{8,}$)(?=(?:.*?\d){2})(?=(?:.*?[A-Za-z]){2})(?=(?:.*?\W){1})/
new RegExp("^(?=.{8,}$)(?=(?:.*?\\d){2})(?=(?:.*?[A-Za-z]){2})(?=(?:.*?\\W){1})") 
```

`(?=.{8,}$)`需求是第一位的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-13T21:24:57.500

这将为您提供 2 分钟数字、2 分钟字符和 8 分钟字符长度...我拒绝向您展示如何不允许用户在其密码中包含非字母数字字符，为什么网站要强制执行不太安全的密码？

```
^(?=.*\d{2})(?=.*[a-zA-Z]{2}).{8,}$ 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2008-10-13T20:47:48.697

现有的基于 jQuery 的密码强度验证器之一怎么样 - 例如： [http ://scripts.simplythebest.net/4/Ajax-Password-Strength-Meter-software.html](http://scripts.simplythebest.net/4/Ajax-Password-Strength-Meter-software.html)

# apache-flex - 如果没有 -source-path 选项，ASDoc Ant 任务如何工作？

> ID：198975
> 
> 赞同：1
> 
> 时间：2008-10-13T20:45:18.187
> 
> 标签：apache-flex, ant, asdoc

我想让[ASDoc Ant 任务](http://www.herrodius.com/blog/85)工作：

```
<target name="asdoc" depends="compile">
    <mkdir dir="${dist_asdocs}"/>
    <asdoc 
    docSources="${srcdir}"
    output="${dist_asdocs}"
    executable="${FLEX_HOME}/bin/asdoc.exe" />
</target> 
```

当我运行它时，我从 ASDoc 收到错误，例如“错误：找不到类型或不是编译时常量：XXX”。当我手动运行 ASDoc 时，我会这样做：“asdoc -source-path src -doc-sources src”。如果我省略 -source-path 值，我会得到相同的错误......那么我应该如何让 Ant 任务工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-14T00:34:47.087

好吧，我无法测试它，因为它仅适用于 Windows（尝试执行 asdoc.exe）。

但是我已经为 asdoc 缺少 ant 任务编写了自己的解决方案：

```
<exec executable="${FLEX_HOME}/bin/asdoc" dir="${basedir}">
    <arg value="-source-path"/>
    <arg path="${basedir}/src"/>

    <arg value="-doc-sources"/>
    <arg path="${basedir}/src"/>

    <arg value="-output"/>
    <arg path="${DOC_DIR}"/>

    <arg value="-main-title"/>
    <arg path="${ant.project.name} Documentation"/>

    <arg line="-library-path+=${basedir}/libs"/>
</exec> 
```

当然，如果您在 Windows 上，则必须将可执行文件更改为 asdoc.exe。我不知道您是否还必须将所有 / 替换为 \ 或者 ant 是否为您执行此操作。如果您不使用任何不在库路径上的 .swcs，则可以省略最后一个。或者至少您必须将其更改为指向正确的目录。

**编辑：**我查看[了 asdoc-task 的源代码，](http://prana.svn.sourceforge.net/viewvc/prana/trunk/ant/src/org/pranaframework/ant/Asdoc.java?view=markup)它与我对 exec-task 所做的基本相同，它只允许一小部分命令行参数。

我还测试了没有源路径参数的解决方案，令我惊讶的是它*仍然*有效。我做了一些进一步的测试，这就是我发现的：

当未指定源路径时，asdoc(.exe) 假定`src`为默认值。因此，如果您使用该约定， asdoc-task 通常可以工作（例如，Flex Builder 会这样做），但如果您不这样做，则会失败。

所以要使用 asdoc-task 你必须命名你的源目录`src`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-11T16:35:16.727

我建议不要使用 asdoc ant 任务，因为自从我第一次发布它以来我还没有进一步开发它。正如 Simon 所提到的，它只支持可能的一小部分，因此您很可能最好使用 exec 任务。

# visual-studio-2008 - VS2008 调试器挂起

> ID：198979
> 
> 赞同：6
> 
> 时间：2008-10-13T20:47:25.423
> 
> 标签：visual-studio-2008

我正在使用带有 SP1 的 Visual Studio 2008 Team System，并且我注意到每当我停止调试应用程序时 IDE 都会挂起几 (10-15) 秒的恼人趋势。起初我认为这只发生在 WPF 应用程序中，但我也观察到了 Windows 窗体应用程序和 ASP.NET 站点中的行为。我根据上一篇文章对选项进行了一系列更改，[并](https://stackoverflow.com/questions/8440/visual-studio-optimizations)进行了详尽的 Google/MSDN 搜索，但仍然没有找到阻止这种情况的方法。

有人有想法么？

* * *

@ [korona](https://stackoverflow.com/users/25731/korona) - 不，那没有解决它。不过谢谢你的建议。

ProcMon 的更多研究显示了这个有趣的花絮，不确定它是否相关：

```
8:45:46.6790857 AM  WindowsFormsApplication1.vshost.exe 7684    FASTIO_CHECK_IF_POSSIBLE    C:\WINXP\Microsoft.NET\Framework\v2.0.50727\CONFIG\enterprisesec.config.cch FAST IO DISALLOWED  Operation: Read, Offset: 48, Length: 12
8:45:46.6793569 AM  WindowsFormsApplication1.vshost.exe 7684    ReadFile    C:\WINXP\Microsoft.NET\Framework\v2.0.50727\CONFIG\enterprisesec.config.cch FAST IO DISALLOWED  Offset: 508, Length: 12 
```

这会重复几次，比如数百次，然后切换到不同的路径：

```
8:45:46.7470314 AM  WindowsFormsApplication1.vshost.exe 7684    FASTIO_CHECK_IF_POSSIBLE    D:\documents and settings\myusername\Application Data\Microsoft\CLR Security Config\v2.0.50727.42\security.config.cch   FAST IO DISALLOWED  Operation: Read, Offset: 48, Length: 12
8:45:46.7472187 AM  WindowsFormsApplication1.vshost.exe 7684    ReadFile    D:\documents and settings\myusername\Application Data\Microsoft\CLR Security Config\v2.0.50727.42\security.config.cch   FAST IO DISALLOWED  Offset: 508, Length: 12 
```

并再次重复多次，每次迭代的偏移量略有变化。也许无关，但是......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-14T12:00:45.767

我在我的一台开发机器和 Visual Studio 2005 上观察到这种行为。问题是由 Visual Studio 试图访问一些不存在的网络共享引起的（我不记得确切的原因）。您可以试一试[Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)，以查看您的 Visual Studio 在完成调试并返回正常视图时是否正在尝试做一些愚蠢的事情。可能是因为您在某些工具栏或工具箱中有一些损坏的插件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-14T15:46:22.423

查看您的 ProcMon 结果，似乎是 CreateFile() 调用一直在占用。我假设所有活动都在等待该线程返回。您可以使用“属性”窗口上的“线程”选项卡在 Process Explorer（也是先前链接的 SysInternals 包的一部分）中验证这一点，但有些困难。

因此，如果 CreateFile 是导致阻塞的原因，则表明这是 Windows 本身的延迟。皮埃尔所说的——注意网络共享——也是我的第一直觉。过去，当 Explorer 映射到我目前无法访问的共享时，我经历了很多看似莫名其妙的减速，即使当时我没有对这些共享进行任何工作。

您可以通过取消映射所有驱动器并从网络中拔出来测试这种可能性吗？D: 是与 C: 分开的物理驱动器吗？如果是这样，如果将构建目录移动到 C:，看看它是否会更快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T18:19:14.957

答对了！这与网络共享有关。我还不知道是哪一个，但现在我知道在哪里看应该很容易弄清楚。我接受了您的建议，解开了我的网卡，断开了我的网络驱动器，然后重新运行。不挂机！非常感谢，非常感谢。这将使生活变得更好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-21T02:46:01.537

从下面的网站我发现了几种可能的解决方案。

[http://social.msdn.microsoft.com/Forums/en/vsdebug/thread/e9c5da47-a194-4051-a3d5-28b404263b3f](http://social.msdn.microsoft.com/Forums/en/vsdebug/thread/e9c5da47-a194-4051-a3d5-28b404263b3f)

最好的方法是运行 Internet Explorer 然后转到工具 -> Internet 选项 -> 高级选项卡 -> 安全部分，取消选中“检查发布者的证书吊销”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-13T21:06:42.560

即使使用基本应用程序也会宿醉吗？就像制作一个新的 Windows 窗体然后点击调试一样，还是只使用更复杂的应用程序？因为我之前也注意到了（可能不是 10-15 秒，但我注意到有一点延迟）但是当我尝试调试一个相对简单的 Windows 窗体应用程序时，我没有得到它根本没有。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-13T21:17:37.887

好问题。我创建了一个非常简单的 Windows 窗体应用程序：

```
private void button1_Click(object sender, EventArgs e)
{
    MessageBox.Show("I am saying hello.");
} 
```

关闭表单时仍然挂起 10 秒。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-14T13:57:45.153

@ [Pierre](https://stackoverflow.com/users/4597/pierre) - 我在 devenv.exe 上运行 ProcMon 并定时关闭应用程序。结果很有趣。它挂了 15 秒，您可以在 ProcMon 中看到挂起。从 8:45:31 到 8:45:46，没有记录任何活动。我将在 ProcMon 中弄乱过滤器，看看它是否是 devenv.exe 之外的东西，但这是我在 15 秒范围内从 devenv.exe 记录的内容：

```
8:45:31.0221244 AM  devenv.exe  7096    QueryNameInformationFile    D:\Working\WindowsFormsApplication1\WindowsFormsApplication1\bin\Debug\WindowsFormsApplication1.vshost.exe  BUFFER OVERFLOW Name: \W
8:45:31.0227991 AM  devenv.exe  7096    CreateFile  D:\Working\WindowsFormsApplication1\WindowsFormsApplication1\bin\Debug\WindowsFormsApplication1.vshost.exe.Manifest NAME NOT FOUND  Desired Access: Generic Read/Execute, Disposition: Open, Options: Synchronous IO Non-Alert, Non-Directory File, Attributes: n/a, ShareMode: Read, AllocationSize: n/a
8:45:46.7647624 AM  devenv.exe  7096    RegOpenKey  HKCU\Software\Classes\CLSID\{141243A4-76E6-4FC3-A114-EAE02389304E}  NAME NOT FOUND  Desired Access: Read
8:45:46.7647792 AM  devenv.exe  7096    RegOpenKey  HKCR\CLSID\{141243A4-76E6-4FC3-A114-EAE02389304E}   NAME NOT FOUND  Desired Access: Read
8:45:46.7649139 AM  devenv.exe  7096    RegOpenKey  HKCU\Software\Classes\CLSID\{141243A4-76E6-4FC3-A114-EAE02389304E}  NAME NOT FOUND  Desired Access: Read
8:45:46.7649264 AM  devenv.exe  7096    RegOpenKey  HKCR\CLSID\{141243A4-76E6-4FC3-A114-EAE02389304E}   NAME NOT FOUND  Desired Access: Read
8:45:46.9834610 AM  devenv.exe  7096    RegQueryValue   HKCU\Software\Microsoft\VisualStudio\9.0\UseMRUDocOrdering  NAME NOT FOUND  Length: 144
8:45:46.9835087 AM  devenv.exe  7096    RegQueryValue   HKLM\SOFTWARE\Microsoft\VisualStudio\9.0\UseMRUDocOrdering  NAME NOT FOUND  Length: 144
8:45:46.9865681 AM  devenv.exe  7096    RegOpenKey  HKCU\Software\Classes\ReSharper.ReSharper_MoveLeft  NAME NOT FOUND  Desired Access: Read
8:45:46.9865881 AM  devenv.exe  7096    RegOpenKey  HKCR\ReSharper.ReSharper_MoveLeft   NAME NOT FOUND  Desired Access: Read
8:45:46.9866155 AM  devenv.exe  7096    RegOpenKey  HKCU\Software\Classes\ReSharper.ReSharper_MoveLeft  NAME NOT FOUND  Desired Access: Maximum Allowed
8:45:46.9866285 AM  devenv.exe  7096    RegOpenKey  HKCR\ReSharper.ReSharper_MoveLeft   NAME NOT FOUND  Desired Access: Maximum Allowed
8:45:46.9869661 AM  devenv.exe  7096    RegOpenKey  HKCU\Software\Classes\ReSharper.ReSharper_MoveRight NAME NOT FOUND  Desired Access: Read
8:45:46.9869813 AM  devenv.exe  7096    RegOpenKey  HKCR\ReSharper.ReSharper_MoveRight  NAME NOT FOUND  Desired Access: Read
8:45:46.9870055 AM  devenv.exe  7096    RegOpenKey  HKCU\Software\Classes\ReSharper.ReSharper_MoveRight NAME NOT FOUND  Desired Access: Maximum Allowed
8:45:46.9870177 AM  devenv.exe  7096    RegOpenKey  HKCR\ReSharper.ReSharper_MoveRight  NAME NOT FOUND  Desired Access: Maximum Allowed
8:45:46.9872667 AM  devenv.exe  7096    RegOpenKey  HKCU\Software\Classes\ReSharper.ReSharper_MoveUp    NAME NOT FOUND  Desired Access: Read
8:45:46.9872818 AM  devenv.exe  7096    RegOpenKey  HKCR\ReSharper.ReSharper_MoveUp NAME NOT FOUND  Desired Access: Read
8:45:46.9873078 AM  devenv.exe  7096    RegOpenKey  HKCU\Software\Classes\ReSharper.ReSharper_MoveUp    NAME NOT FOUND  Desired Access: Maximum Allowed
8:45:46.9873207 AM  devenv.exe  7096    RegOpenKey  HKCR\ReSharper.ReSharper_MoveUp NAME NOT FOUND  Desired Access: Maximum Allowed
8:45:46.9875683 AM  devenv.exe  7096    RegOpenKey  HKCU\Software\Classes\ReSharper.ReSharper_MoveDown  NAME NOT FOUND  Desired Access: Read
8:45:46.9875873 AM  devenv.exe  7096    RegOpenKey  HKCR\ReSharper.ReSharper_MoveDown   NAME NOT FOUND  Desired Access: Read
8:45:46.9876141 AM  devenv.exe  7096    RegOpenKey  HKCU\Software\Classes\ReSharper.ReSharper_MoveDown  NAME NOT FOUND  Desired Access: Maximum Allowed
8:45:46.9876276 AM  devenv.exe  7096    RegOpenKey  HKCR\ReSharper.ReSharper_MoveDown   NAME NOT FOUND  Desired Access: Maximum Allowed
8:45:46.9912375 AM  devenv.exe  7096    RegOpenKey  HKCU\Software\Classes\CLSID\{00020424-0000-0000-C000-000000000046}\TreatAs  NAME NOT FOUND  Desired Access: Query Value
8:45:46.9912529 AM  devenv.exe  7096    RegOpenKey  HKCR\CLSID\{00020424-0000-0000-C000-000000000046}\TreatAs   NAME NOT FOUND  Desired Access: Query Value
8:45:46.9914799 AM  devenv.exe  7096    RegOpenKey  HKLM\Software\Microsoft\Windows\CurrentVersion\Installer\Managed\S-1-5-21-2966119792-2635991036-4117835597-414090\Installer\Features\7F9CD27BF7173A842A185F81E7100860   NAME NOT FOUND  Desired Access: Read
8:45:46.9915751 AM  devenv.exe  7096    RegOpenKey  HKLM\Software\Microsoft\Windows\CurrentVersion\Installer\Managed\S-1-5-21-2966119792-2635991036-4117835597-414090\Installer\Features\7F9CD27BF7173A842A185F81E7100860   NAME NOT FOUND  Desired Access: Read
8:45:46.9916485 AM  devenv.exe  7096    RegEnumValue    HKCU\Software\Microsoft\Installer\Features\7F9CD27BF7173A842A185F81E7100860 NO MORE ENTRIES Index: 1, Length: 220
8:45:46.9916921 AM  devenv.exe  7096    RegQueryValue   HKCU\Software\Microsoft\Windows\CurrentVersion\Group Policy\AppMgmt\{B72DC9F7-717F-48A3-A281-F5187E018006}  NAME NOT FOUND  Length: 144
8:45:46.9917220 AM  devenv.exe  7096    RegOpenKey  HKLM\Software\Microsoft\Windows\CurrentVersion\Installer\Managed\S-1-5-21-2966119792-2635991036-4117835597-414090\Installer\Features\7F9CD27BF7173A842A185F81E7100860   NAME NOT FOUND  Desired Access: Read
8:45:46.9918086 AM  devenv.exe  7096    RegOpenKey  HKLM\Software\Microsoft\Windows\CurrentVersion\Installer\Managed\S-1-5-21-2966119792-2635991036-4117835597-414090\Installer\Features\7F9CD27BF7173A842A185F81E7100860   NAME NOT FOUND  Desired Access: Read
8:45:46.9918661 AM  devenv.exe  7096    RegEnumValue    HKCU\Software\Microsoft\Installer\Features\7F9CD27BF7173A842A185F81E7100860 NO MORE ENTRIES Index: 1, Length: 220
8:45:46.9919019 AM  devenv.exe  7096    RegOpenKey  HKCU\Software\Classes\CLSID\{00020424-0000-0000-C000-000000000046}\LocalServer32    NAME NOT FOUND  Desired Access: Maximum Allowed
8:45:46.9919204 AM  devenv.exe  7096    RegOpenKey  HKCR\CLSID\{00020424-0000-0000-C000-000000000046}\LocalServer32 NAME NOT FOUND  Desired Access: Maximum Allowed
8:45:46.9919447 AM  devenv.exe  7096    RegOpenKey  HKCU\Software\Classes\CLSID\{00020424-0000-0000-C000-000000000046}\InprocHandler32  NAME NOT FOUND  Desired Access: Maximum Allowed
8:45:46.9919595 AM  devenv.exe  7096    RegOpenKey  HKCR\CLSID\{00020424-0000-0000-C000-000000000046}\InprocHandler32   NAME NOT FOUND  Desired Access: Maximum Allowed
8:45:46.9919825 AM  devenv.exe  7096    RegOpenKey  HKCU\Software\Classes\CLSID\{00020424-0000-0000-C000-000000000046}\InprocHandlerX86 NAME NOT FOUND  Desired Access: Maximum Allowed
8:45:46.9919969 AM  devenv.exe  7096    RegOpenKey  HKCR\CLSID\{00020424-0000-0000-C000-000000000046}\InprocHandlerX86  NAME NOT FOUND  Desired Access: Maximum Allowed
8:45:46.9920191 AM  devenv.exe  7096    RegOpenKey  HKCU\Software\Classes\CLSID\{00020424-0000-0000-C000-000000000046}\LocalServer32    NAME NOT FOUND  Desired Access: Maximum Allowed
8:45:46.9920322 AM  devenv.exe  7096    RegOpenKey  HKCR\CLSID\{00020424-0000-0000-C000-000000000046}\LocalServer32 NAME NOT FOUND  Desired Access: Maximum Allowed
8:45:46.9920543 AM  devenv.exe  7096    RegOpenKey  HKCU\Software\Classes\CLSID\{00020424-0000-0000-C000-000000000046}\LocalServer  NAME NOT FOUND  Desired Access: Maximum Allowed
8:45:46.9920677 AM  devenv.exe  7096    RegOpenKey  HKCR\CLSID\{00020424-0000-0000-C000-000000000046}\LocalServer   NAME NOT FOUND  Desired Access: Maximum Allowed
8:45:46.9921310 AM  devenv.exe  7096    RegQueryValue   HKCU\Software\Classes\CLSID\{00020424-0000-0000-C000-000000000046}\AppID    NAME NOT FOUND  Length: 144
8:45:46.9921387 AM  devenv.exe  7096    RegQueryValue   HKCR\CLSID\{00020424-0000-0000-C000-000000000046}\AppID NAME NOT FOUND  Length: 144
8:45:46.9921910 AM  devenv.exe  7096    RegOpenKey  HKCU\Software\Classes\Interface\{A6FAF38C-284B-48B3-B871-84B9A66010E9}\ProxyStubClsid32 NAME NOT FOUND  Desired Access: Query Value
8:45:46.9922398 AM  devenv.exe  7096    RegOpenKey  HKCU\Software\Classes\Interface\{A6FAF38C-284B-48B3-B871-84B9A66010E9}\ProxyStubClsid32 NAME NOT FOUND  Desired Access: Maximum Allowed
8:45:46.9922774 AM  devenv.exe  7096    RegOpenKey  HKCU\Software\Classes\Interface\{A6FAF38C-284B-48B3-B871-84B9A66010E9}\ProxyStubClsid32 NAME NOT FOUND  Desired Access: Maximum Allowed
8:45:46.9923306 AM  devenv.exe  7096    RegOpenKey  HKCU\Software\Classes\Interface\{A6FAF38C-284B-48B3-B871-84B9A66010E9}\Forward  NAME NOT FOUND  Desired Access: Query Value
8:45:46.9923447 AM  devenv.exe  7096    RegOpenKey  HKCR\Interface\{A6FAF38C-284B-48B3-B871-84B9A66010E9}\Forward   NAME NOT FOUND  Desired Access: Query Value
8:45:46.9923676 AM  devenv.exe  7096    RegOpenKey  HKCU\Software\Classes\Interface\{A6FAF38C-284B-48B3-B871-84B9A66010E9}\TypeLib  NAME NOT FOUND  Desired Access: Maximum Allowed
8:45:46.9924159 AM  devenv.exe  7096    RegOpenKey  HKCU\Software\Classes\Interface\{A6FAF38C-284B-48B3-B871-84B9A66010E9}\TypeLib  NAME NOT FOUND  Desired Access: Maximum Allowed
8:45:46.9924549 AM  devenv.exe  7096    RegOpenKey  HKCU\Software\Classes\Interface\{A6FAF38C-284B-48B3-B871-84B9A66010E9}\TypeLib  NAME NOT FOUND  Desired Access: Maximum Allowed
8:45:46.9924925 AM  devenv.exe  7096    RegOpenKey  HKCU\Software\Classes\Interface\{A6FAF38C-284B-48B3-B871-84B9A66010E9}\TypeLib  NAME NOT FOUND  Desired Access: Maximum Allowed
8:45:46.9925301 AM  devenv.exe  7096    RegOpenKey  HKCU\Software\Classes\Interface\{A6FAF38C-284B-48B3-B871-84B9A66010E9}\TypeLib  NAME NOT FOUND  Desired Access: Maximum Allowed
8:45:46.9925761 AM  devenv.exe  7096    RegOpenKey  HKCU\Software\Classes\TypeLib\{95FF4B0C-E6EC-470C-82AC-EB0471714C5A}    NAME NOT FOUND  Desired Access: Maximum Allowed
8:45:46.9926243 AM  devenv.exe  7096    RegOpenKey  HKCU\Software\Classes\TypeLib\{95FF4B0C-E6EC-470C-82AC-EB0471714C5A}    NAME NOT FOUND  Desired Access: Maximum Allowed
8:45:46.9926490 AM  devenv.exe  7096    RegEnumKey  HKCR\TypeLib\{95FF4B0C-E6EC-470C-82AC-EB0471714C5A} NO MORE ENTRIES Index: 1, Length: 288
8:45:46.9926676 AM  devenv.exe  7096    RegOpenKey  HKCU\Software\Classes\TypeLib\{95FF4B0C-E6EC-470C-82AC-EB0471714C5A}\1.0    NAME NOT FOUND  Desired Access: Maximum Allowed
8:45:46.9927153 AM  devenv.exe  7096    RegOpenKey  HKCU\Software\Classes\TypeLib\{95FF4B0C-E6EC-470C-82AC-EB0471714C5A}\1.0    NAME NOT FOUND  Desired Access: Maximum Allowed
8:45:46.9927525 AM  devenv.exe  7096    RegOpenKey  HKCU\Software\Classes\TypeLib\{95FF4B0C-E6EC-470C-82AC-EB0471714C5A}\1.0\0  NAME NOT FOUND  Desired Access: Maximum Allowed
8:45:46.9928018 AM  devenv.exe  7096    RegOpenKey  HKCU\Software\Classes\TypeLib\{95FF4B0C-E6EC-470C-82AC-EB0471714C5A}\1.0\0\win32    NAME NOT FOUND  Desired Access: Maximum Allowed
8:45:46.9928530 AM  devenv.exe  7096    RegOpenKey  HKCU\Software\Classes\TypeLib\{95FF4B0C-E6EC-470C-82AC-EB0471714C5A}\1.0\0\win32    NAME NOT FOUND  Desired Access: Maximum Allowed
8:45:46.9928710 AM  devenv.exe  7096    RegQueryValue   HKCR\TypeLib\{95FF4B0C-E6EC-470C-82AC-EB0471714C5A}\1.0\0\win32\(Default)   BUFFER OVERFLOW Length: 144
8:45:46.9928986 AM  devenv.exe  7096    RegOpenKey  HKCU\Software\Classes\TypeLib\{95FF4B0C-E6EC-470C-82AC-EB0471714C5A}\1.0\0\win32    NAME NOT FOUND  Desired Access: Maximum Allowed
8:45:46.9929159 AM  devenv.exe  7096    RegQueryValue   HKCR\TypeLib\{95FF4B0C-E6EC-470C-82AC-EB0471714C5A}\1.0\0\win32\(Default)   BUFFER OVERFLOW Length: 144
8:45:46.9936201 AM  devenv.exe  7096    ReadFile    C:\Program Files\Common Files\Microsoft Shared\MSENV\vsprojhostproc.olb FAST IO DISALLOWED  Offset: 224, Length: 4
8:45:46.9936267 AM  devenv.exe  7096    FASTIO_CHECK_IF_POSSIBLE    C:\Program Files\Common Files\Microsoft Shared\MSENV\vsprojhostproc.olb FAST IO DISALLOWED  Operation: Read, Offset: 224, Length: 4
8:45:46.9938304 AM  devenv.exe  7096    ReadFile    C:\Program Files\Common Files\Microsoft Shared\MSENV\vsprojhostproc.olb FAST IO DISALLOWED  Offset: 228, Length: 20
8:45:46.9938360 AM  devenv.exe  7096    FASTIO_CHECK_IF_POSSIBLE    C:\Program Files\Common Files\Microsoft Shared\MSENV\vsprojhostproc.olb FAST IO DISALLOWED  Operation: Read, Offset: 228, Length: 20
8:45:46.9939826 AM  devenv.exe  7096    ReadFile    C:\Program Files\Common Files\Microsoft Shared\MSENV\vsprojhostproc.olb FAST IO DISALLOWED  Offset: 472, Length: 40
8:45:46.9939877 AM  devenv.exe  7096    FASTIO_CHECK_IF_POSSIBLE    C:\Program Files\Common Files\Microsoft Shared\MSENV\vsprojhostproc.olb FAST IO DISALLOWED  Operation: Read, Offset: 472, Length: 40
8:45:46.9941335 AM  devenv.exe  7096    ReadFile    C:\Program Files\Common Files\Microsoft Shared\MSENV\vsprojhostproc.olb FAST IO DISALLOWED  Offset: 512, Length: 40
8:45:46.9941384 AM  devenv.exe  7096    FASTIO_CHECK_IF_POSSIBLE    C:\Program Files\Common Files\Microsoft Shared\MSENV\vsprojhostproc.olb FAST IO DISALLOWED  Operation: Read, Offset: 512, Length: 40
8:45:46.9943155 AM  devenv.exe  7096    ReadFile    C:\Program Files\Common Files\Microsoft Shared\MSENV\vsprojhostproc.olb FAST IO DISALLOWED  Offset: 552, Length: 40
8:45:46.9943207 AM  devenv.exe  7096    FASTIO_CHECK_IF_POSSIBLE    C:\Program Files\Common Files\Microsoft Shared\MSENV\vsprojhostproc.olb FAST IO DISALLOWED  Operation: Read, Offset: 552, Length: 40
8:45:46.9944710 AM  devenv.exe  7096    ReadFile    C:\Program Files\Common Files\Microsoft Shared\MSENV\vsprojhostproc.olb FAST IO DISALLOWED  Offset: 3,072, Length: 16
8:45:46.9944762 AM  devenv.exe  7096    FASTIO_CHECK_IF_POSSIBLE    C:\Program Files\Common Files\Microsoft Shared\MSENV\vsprojhostproc.olb FAST IO DISALLOWED  Operation: Read, Offset: 3,072, Length: 16
8:45:46.9947328 AM  devenv.exe  7096    ReadFile    C:\Program Files\Common Files\Microsoft Shared\MSENV\vsprojhostproc.olb FAST IO DISALLOWED  Offset: 3,088, Length: 8
8:45:46.9947380 AM  devenv.exe  7096    FASTIO_CHECK_IF_POSSIBLE    C:\Program Files\Common Files\Microsoft Shared\MSENV\vsprojhostproc.olb FAST IO DISALLOWED  Operation: Read, Offset: 3,088, Length: 8
8:45:46.9948846 AM  devenv.exe  7096    ReadFile    C:\Program Files\Common Files\Microsoft Shared\MSENV\vsprojhostproc.olb FAST IO DISALLOWED  Offset: 3,232, Length: 2
8:45:46.9948895 AM  devenv.exe  7096    FASTIO_CHECK_IF_POSSIBLE    C:\Program Files\Common Files\Microsoft Shared\MSENV\vsprojhostproc.olb FAST IO DISALLOWED  Operation: Read, Offset: 3,232, Length: 2
8:45:46.9954480 AM  devenv.exe  7096    ReadFile    C:\Program Files\Common Files\Microsoft Shared\MSENV\vsprojhostproc.olb FAST IO DISALLOWED  Offset: 3,234, Length: 14
8:45:46.9954536 AM  devenv.exe  7096    FASTIO_CHECK_IF_POSSIBLE    C:\Program Files\Common Files\Microsoft Shared\MSENV\vsprojhostproc.olb FAST IO DISALLOWED  Operation: Read, Offset: 3,234, Length: 14
8:45:46.9956052 AM  devenv.exe  7096    ReadFile    C:\Program Files\Common Files\Microsoft Shared\MSENV\vsprojhostproc.olb FAST IO DISALLOWED  Offset: 3,104, Length: 16
8:45:46.9956103 AM  devenv.exe  7096    FASTIO_CHECK_IF_POSSIBLE    C:\Program Files\Common Files\Microsoft Shared\MSENV\vsprojhostproc.olb FAST IO DISALLOWED  Operation: Read, Offset: 3,104, Length: 16
8:45:46.9957616 AM  devenv.exe  7096    ReadFile    C:\Program Files\Common Files\Microsoft Shared\MSENV\vsprojhostproc.olb FAST IO DISALLOWED  Offset: 3,120, Length: 8
8:45:46.9957666 AM  devenv.exe  7096    FASTIO_CHECK_IF_POSSIBLE    C:\Program Files\Common Files\Microsoft Shared\MSENV\vsprojhostproc.olb FAST IO DISALLOWED  Operation: Read, Offset: 3,120, Length: 8
8:45:46.9959108 AM  devenv.exe  7096    ReadFile    C:\Program Files\Common Files\Microsoft Shared\MSENV\vsprojhostproc.olb FAST IO DISALLOWED  Offset: 3,152, Length: 16
8:45:46.9959158 AM  devenv.exe  7096    FASTIO_CHECK_IF_POSSIBLE    C:\Program Files\Common Files\Microsoft Shared\MSENV\vsprojhostproc.olb FAST IO DISALLOWED  Operation: Read, Offset: 3,152, Length: 16
8:45:46.9961043 AM  devenv.exe  7096    ReadFile    C:\Program Files\Common Files\Microsoft Shared\MSENV\vsprojhostproc.olb FAST IO DISALLOWED  Offset: 3,168, Length: 8
8:45:46.9961095 AM  devenv.exe  7096    FASTIO_CHECK_IF_POSSIBLE    C:\Program Files\Common Files\Microsoft Shared\MSENV\vsprojhostproc.olb FAST IO DISALLOWED  Operation: Read, Offset: 3,168, Length: 8
8:45:46.9962559 AM  devenv.exe  7096    ReadFile    C:\Program Files\Common Files\Microsoft Shared\MSENV\vsprojhostproc.olb FAST IO DISALLOWED  Offset: 3,200, Length: 16
8:45:46.9962612 AM  devenv.exe  7096    FASTIO_CHECK_IF_POSSIBLE    C:\Program Files\Common Files\Microsoft Shared\MSENV\vsprojhostproc.olb FAST IO DISALLOWED  Operation: Read, Offset: 3,200, Length: 16
8:45:47.0162060 AM  devenv.exe  7096    RegOpenKey  HKCU\Software\Classes\CLSID\{00020424-0000-0000-C000-000000000046}\TreatAs  NAME NOT FOUND  Desired Access: Query Value 
```

谢谢你的帮助。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-14T14:11:27.093

我不是 100% 确定这是同一个问题，但我在调试期间让 VC++ 以类似的方式运行。这主要发生在闯入崩溃的程序时，所以我再次不确定这是否是同一个问题，但它可能值得一试。

原因：被调试的进程在文本服务框架用于呈现文本的互斥锁上获得锁时死亡。当其他应用程序尝试呈现任何文本时，它们最终会陷入僵局，直到被调试的进程终止。

修复：通过打开控制面板、区域和语言选项、语言、详细信息...、高级并选中标有“关闭高级文本服务”的框来关闭高级文本服务。

抱歉，如果这与您的问题无关，但它确实帮助我的调试器启动并锁定了我的系统。

更多信息：[http ://www.virtualdub.org/blog/pivot/entry.php?id=118](http://www.virtualdub.org/blog/pivot/entry.php?id=118)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-20T06:50:39.663

太好了，就像我的情况一样。您是否能够找出 Visual Studio 试图访问的网络共享。您可能想尝试使用[wireshark](http://www.wireshark.org/)进行进一步调查。您将看到您的 PC 产生的流量...

# java - 如何使用加速度计进行手势识别

> ID：198982
> 
> 赞同：19
> 
> 时间：2008-10-13T20:48:05.123
> 
> 标签：java, embedded, accelerometer, gesture-recognition

我的目标是识别安装在太阳点上的加速度计的简单手势。一个手势可以像旋转设备或以几种不同的动作移动设备一样简单。该设备目前只有加速度计，但我们正在考虑添加陀螺仪，以使其更容易/更准确。

有没有人有关于如何做到这一点的建议？Java中有任何可用的库吗？您推荐我查看的示例项目？你推荐的论文？

Sun Spot 是一个 Java 平台，可帮助您快速制作系统原型。它使用 Java 进行编程，可以将命令转发回连接到计算机的基站。如果我需要解释硬件的工作原理，请发表评论。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-13T21:17:57.310

加速度计将记录由于重力引起的恒定加速度，加上用户承受的任何加速度，再加上噪音。

您将需要对样本进行低通滤波，以尽可能多地去除不相关的噪声。最糟糕的噪音通常是比任何可能的人为加速度更高的频率。

意识到当设备没有被用户加速时，唯一的力是由于重力，因此你可以[推断出它](http://tom.pycke.be/mav/69/accelerometer-to-attitude)在空间中的姿态。而且，当总加速度从1g变化很大时，一定是由于用户加速了设备；通过减去最后已知的重力估计，您可以粗略估计用户在哪个方向以及加速设备的速度，从而获得可以开始与已知手势列表进行匹配的数据。

使用单个三轴加速度计，您可以检测当前的俯仰和滚动，以及设备在直线上的加速度。将加速度减去重力积分将为您提供当前速度的估计值，但由于噪声，估计值会迅速偏离现实；您必须在手势之前/之间/期间对用户的行为做出假设，并通过您的 UI 引导他们，以提供设备未加速的点，您可以重置您的估计并可靠地估计重力方向。再次积分以找到位置不太可能在任何有用的时间长度内提供可用的结果。

如果您有两个相距一定距离的三轴加速度计，或者一个和一些陀螺仪，您还可以检测设备的旋转（通过比较加速度矢量，或直接从陀螺仪）；在几秒钟内积分角动量会给你一个相对于你开始积分时的当前偏航的估计，但这又会迅速偏离真实。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-11-02T11:45:39.150

由于似乎没有人按照 OP 的要求提到现有库，因此这里是：http:

[//www.wiigee.org/](http://www.wiigee.org/)

用于 Wiimote，**wiigee**是一种基于 Java 的开源实现，用于基于加速度计的模式匹配读数。它使用**隐马尔可夫模型**[1] 来实现这一点。

它显然被一家公司 Thorn Technologies 使用，效果很好，他们在这里提到了他们的经验：[http ://www.thorntech.com/2013/07/mobile-device-3d-accelerometer-based-gesture-recognition /](http://www.thorntech.com/2013/07/mobile-device-3d-accelerometer-based-gesture-recognition/)

或者，您可以考虑**FastDTW** ( [https://code.google.com/p/fastdtw/](https://code.google.com/p/fastdtw/) )。它不如常规**DTW准确**[2]，而且计算成本更低，这对于嵌入式系统或移动设备来说是一件大事。

[1] [https://en.wikipedia.org/wiki/Hidden_​​Markov_model](https://en.wikipedia.org/wiki/Hidden_Markov_model)
[2] [https://en.wikipedia.org/wiki/Dynamic_time_warping](https://en.wikipedia.org/wiki/Dynamic_time_warping)

编辑：OP 在他完成项目的评论之一中提到， 90% 的现场准确率和亚毫秒级的计算时间，使用[$1 Recognizer](https://depts.washington.edu/aimgroup/proj/dollar/)的变体。他还提到轮换不是他项目的标准。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-07-02T03:39:34.273

尚未提及的是实际的手势识别。这是困难的部分。清理完数据（低通滤波、归一化等）后，您还有大部分工作要做。

看看隐马尔可夫模型。这似乎是最流行的方法，但使用它们并非易事。通常有一个预处理步骤。首先进行 STFT 并将结果向量聚类到字典中，然后将其输入 HMM。看看 java lib 的谷歌代码中的 jahmm。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-21T22:46:25.757

添加到月影关于必须重置重力和旋转基线的观点......

除非期望设备具有稳定的静止时刻（作用在其上的唯一力是重力）来重置其测量基线，否则您的系统最终会产生相当于眩晕的现象。

# visual-studio - Visual Studio 中的全局查找和替换

> ID：198984
> 
> 赞同：5
> 
> 时间：2008-10-13T20:48:22.223
> 
> 标签：visual-studio, ide, replace, find

我有一个包含多个项目的解决方案，我们需要做一些严肃的全球替换。

有没有办法在替换后保留一些值的情况下进行通配符替换？

因此，例如，如果我希望每个**HttpContext.Current.Session[“whatevervalue”]**都成为**HttpContext.Current.Session[“whatevervalue”].ToString()**传入的字符串值将被尊重？我不想替换“whatevervalue”，我只想在模式匹配的地方附加一个 .ToString() 。

这在 Visual Studio 中可行吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-13T20:54:14.410

首先，备份您的项目，以防万一……在大规模更换之前总是一个好主意。

然后，在查找/替换对话框中，选择使用正则表达式复选框：

在“查找”框中，使用以下模式：

```
HttpContext\.Current\.Session\["{.@}"\] 
```

并在替换框中，使用：

```
HttpContext.Current.Session["\1"].ToString() 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-13T20:50:06.710

简单...使用正则表达式和分组。

找到什么：（HttpContext.Current.Session[“whatevervalue”]）

替换为：\0.ToString();

记得检查使用：并选择正则表达式

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-13T20:56:56.480

您要打开“查找选项”扩展器并选择“使用正则表达式”选项。完成后，您希望这些作为您的查找/替换条目：

寻找：

```
HttpContext\.Current\.Session\[{("([^"]|\")*")}\] 
```

代替：

```
HttpContext.Current.Session[\1].ToString() 
```

附加说明：

启用正则表达式选项后，您将能够使用指向右侧的三角形按钮来访问 Visual Studio 的 Regex 语法片段。

另请注意，Visual Studio 的 Regex 语法非常贫乏，因为它自 Visual Studio 6（或更早？）时代以来就没有改变——所以不要认为任何语法元素是理所当然的。

例如，有人可能认为我上面的 find 正则表达式被破坏了，因为双引号之前的反斜杠没有正确转义，但实际上，在此处放置双反斜杠会破坏表达式，而不是修复它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-10-28T18:14:47.363

这些答案似乎都不适用于 Visual Studio 2013，因为该版本似乎终于切换到标准 RegEx。但是，非 RegEx 专家或习惯于旧的 VS Find/Replace RegEx 语法的人会发现 RegEx Shortcut 按钮非常有用。

请参阅此答案以获取更多信息，包括查找/替换/环绕示例：

[Visual Studio 的“查找和环绕”而不是“查找和替换”](https://stackoverflow.com/questions/17591818/visual-studio-find-and-surround-with-instead-of-find-and-replace/26615388#26615388)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-13T20:50:57.613

您可以将[Visual Assist](http://www.wholetomato.com/)用于此类任务。它是用于不同类型重构的强大工具。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-13T21:42:26.013

您还可以考虑使用[http://www.devexpress.com/Products/NET/IDETools/RefactorASP/上提供的免费下载工具 Refactor](http://www.devexpress.com/Products/NET/IDETools/RefactorASP/)

它所做的不仅仅是查找和替换，他们称之为重命名具有更易于理解的名称的成员。它的各种功能将轻松帮助您改进代码。

# c - 对基于 c 的小型向量和矩阵库的建议

> ID：198991
> 
> 赞同：13
> 
> 时间：2008-10-13T20:50:45.557
> 
> 标签：c, math, vector

我需要一个用于 2d 和 3d 向量以及 3x3 和 4x4 矩阵的轻量级库。在基本的 C 中。这样我就不会以次优的方式重新发明轮子。

有什么建议么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-13T21:19:29.350

[Meschach](http://www.math.uiowa.edu/~dstewart/meschach/)是一个纯 c 向量/矩阵库，比例如 LAPACK 小得多（根据常见问题解答，至少 :)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-13T21:15:21.950

许多人告诉您使用各种[BLAS](http://en.wikipedia.org/wiki/Basic_Linear_Algebra_Subprograms)库，但这对您来说可能会很慢，因为您正在处理小型矩阵。它们中的大多数都经过优化以将矩阵分块为固定大小（大约 50 个元素 - 取决于缓存大小）并使用优化算法对块进行操作，然后使用简单算法对剩余部分进行操作。在小矩阵上，这甚至比仅仅调用普通算法还要慢。

FWIW，当我需要在 fortran（2x2 和 4x4 方矩阵 mults）中执行此操作时，我只是对完全展开的版本进行了硬编码，它运行得很好*（大约是 gfortran 上内置 MATMUL 的速度的 20 倍，但这可能是由于以下事实MATMUL 没有到位，我的版本是）*。我永远找不到一个好的图书馆来为我做这件事。

在 C++ 中它会很好，因为你可以使用[BLITZ](http://sourceforge.net/projects/blitz/)但是唉......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-13T20:54:59.337

假设您正在为 x86 编码，您可能会查看英特尔的[集成性能基元](http://www.intel.com/cd/software/products/asmo-na/eng/302910.htm#vmo)(IPP) 和[数学内核库](http://www.intel.com/cd/software/products/asmo-na/eng/266858.htm)(MKL)。它们为许多常见操作（包括向量和矩阵）提供了超级快速的库（可能比其他任何人都快，因为它们针对非公共微架构细节进行了优化）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-13T21:05:06.167

试试 CIMG ( [cimg.sourceforge.net)](http://cimg.sourceforge.net/)。它专注于图像处理，但免费，非常轻量级（整个库由单个 .h 文件组成！），并具有所有标准矢量/矩阵运算。

它是 C++，所以如果你直接做 C，它就行不通，但值得一看。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-23T08:35:14.413

也许您应该尝试 DirectX 数学库（只是 Windows ...）。向量、矩阵、对它的运算，你所需要的可能都在那里。您只能使用这个，而不是整个 DX。您可以使用版本 9 或 10。它很快 :)

```
#include <D3DX9Math.h> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-13T21:03:17.853

[Mathtools.net](http://www.mathtools.net/C_C__/Mathematics/)上有很多选择。[Object-Oriented Numerics](http://www.oonumerics.org/oon/)还列出了一些可能对您有用的包。由于我不确定您在做什么（您需要大量优化的线性代数吗？或者简单的运算就足够了？），很难更具体。

一般来说，[矩阵模板库](http://www.osl.iu.edu/research/mtl/)是经过深思熟虑的。如果你需要一些严肃的线性代数，你应该看看[BLAS](http://www.netlib.org/blas/faq.html)和[LAPACK](http://math.nist.gov/lapack++/)。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-10-09T05:39:42.737

您可能还想看看[Armadillo C++ 库](http://arma.sourceforge.net)

# web - 在您的网站上提供信用卡付款的最佳方式是什么？

> ID：198994
> 
> 赞同：6
> 
> 时间：2008-10-13T20:51:45.927
> 
> 标签：web, credit-card, payment

我想在我的网站上提供信用卡付款，并且想知道最好（或首选）的方式是什么？

我知道我可以使用 Google checkout、paypal 等，但这不是我想要的。我正在寻找一种简单的基本 CC 支付方式，它只支持所有不同的信用卡。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-13T20:54:09.947

有很多解决方案。一对夫妇开始：[Authorize.net](http://www.authorize.net)和[支付技术](http://www.paymentech.com/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-13T20:54:11.790

如果您不想使用外部处理器，这很难。安全问题是巨大的，我无法认真想象一家银行允许你这样做。我强烈建议您使用 Paypal、Google Checkout 或 WorldPay，或您的银行提供/推荐的任何付款处理系统。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-23T23:55:01.877

如果您只想接受信用卡，那么您绝对没有理由需要在服务器上存储信用卡数据。许多从未实施过非 Paypal/Google Checkout 系统的人会试图吓唬你说这是一项非常艰巨的任务，但你的代码只需要从客户端获取加密的 CC 并将其传递给网关。它永远不需要存在于您的数据库中，并且因此将您的风险降至最低。

我想说的是使用 Paypal 按钮和使用网关之间的界限只是您希望客户在您的网站上还是在其他人的网站上结帐的选择。就是这样。风险并不大，因为您需要做的就是购买 SSL 证书并使用信誉良好的购物车系统，如 Magento、Ubercart for Drupal 等。总会涉及到努力。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-13T21:04:25.997

我会在 Visa 上四处寻找答案，寻找可靠的第三方公司；我绝不会编写自己的 CC 授权码；在我看来，这听起来像是对黑客的巨大邀请。

Paypay 是相当可靠的，我知道。

查看 Amazon、Ebay、Yahoo 等的解决方案。他们可能会许可他们的购物车软件（当然是收费的）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-13T21:05:39.113

完全取决于你是谁。

如果您的公司足够成熟，可以从银行获得互联网商家帐户，那么如果您的交易量大于“非常非常小”，请这样做。如果您每月的营业额超过 1000 英镑（或者说每月 1000 美元或美元等），那么请获得一个商家帐户。

如果你的营业额没有那么多，那么首先要弄清楚如何让你的营业额达到那么高，否则你的生意就不会长久。

互联网商家账户收取的佣金并不比前面提到的“持有现金”PSP 少很多，但它们也更快地给你钱，而且通常使用起来更合理。

有许多网关提供商可以与银行合作，而银行本身通常会提供自己的服务。您可以从技术角度选择最适合您的组合。

免责声明：此信息基于我在英国整合支付提供商的有限经验。它可能不适用于其他国家（甚至这里！）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-13T20:54:46.560

如果我在美国，我会使用 google checkout。它非常便宜，是我（和许多客户）信任的品牌。

除此之外，还有很多可能性。**不过，请远离 Digital River 拥有的任何东西**。好像FastSpring比较好，但是比较贵。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-13T20:56:58.490

我已经实现了几次 Authorize.NET。它工作得很好，我相信他们的费率是合理的。

您确实需要管理自己的 SSL 证书等，并遵守 PCI 标准，但要摆脱贝宝的邪恶，这是一个很小的代价。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-14T06:40:39.920

如果您的现金流偏小（

大多数银行都可以开设商户账户；当然，为了获得一个，您需要是一家注册企业，并满足其他几个标准，这些标准因银行而异。

其次，您需要选择支付处理器。如果您的客户在美国，我会推荐 Authorize.net。我以前和他们一起工作过，并且取得了很好的成功。

并非所有银行，也不是所有支付处理器都可以协同工作，因此请仔细检查它们是否能很好地协同工作。

设置好它们后，您的支付处理器将为您提供一个 API，允许您与他们的支付服务集成。如果您使用常见的电子商务软件，它们最有可能是与主要支付处理器集成的插件或代码。

确保您的网站是安全的 - 您将对任何泄露的客户数据负责。

祝你好运！

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-10-13T22:16:51.747

接受信用卡有很多复杂性，这就是 PayPal 和 Google Checkout 如此受欢迎的原因——它们为您处理了大部分复杂性。

另一家提供比 PayPal 更多的公司是[Kagi](http://www.kagi.com/sell.php)。我强烈建议您观看他们的[简短宣传视频](http://www.kagi.com/tutorials/outsourcer/)，因为它概述了以您想要的方式处理信用卡所需的所有组件——支付网关、支付处理器、商家帐户等；我认为这可能会说服您采用不同的方法。

# xslt - 使用 XSL 进行绝对定位转换并呈现 为 PDF

> ID：198996
> 
> 赞同：4
> 
> 时间：2008-10-13T20:52:09.390
> 
> 标签：xslt, pdf, xsl-fo

如何使用 XSL 完成绝对定位？我正在将 XSL 转换为 FO 到 PDF 以用于邮寄信件，并试图弄清楚如何绝对定位包含返回地址和收件人地址的 fo:blocks，以便它们显示在信封上的窗口中。

任何人都有关于魔术语法的建议来实现这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-14T07:42:19.843

我不是这方面的专家，我也没有（目前）一个 XSL-FO 处理器来测试这个，但这样的东西不应该工作吗？（请不要按字面意思理解）

```
<fo:block>
    <fo:block>
        BLABLABLABLABLABLABLABLABLABLABLABLABLABLABLABLABLABLABLABLA 
    </fo:block>
    <fo:block-container position="absolute" 
                        top="30pt" left="30pt" height="16pt" width="100%">
        <fo:block font="48pt Arial" color="red">absolute</fo:block>
    </fo:block-container>
</fo:block> 
```**`******