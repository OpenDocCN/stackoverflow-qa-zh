# StackOverflow 问答 000411000-000411999

# c++ - 是否可以检测指向成员函数的指针？

> ID：411004
> 
> 赞同：1
> 
> 时间：2009-01-04T13:59:27.033
> 
> 标签：c++, templates, specialization

我想要一个指向成员函数的情况下的专门模板。有没有办法检测到这一点？现在我声明 struct isPtrToMemberFunc，然后为每个类（现在只有 1 个）添加一个额外的模板（类 TType=void）并专门化额外的模板以查看其 isPtrToMemberFunc。有没有办法自动检测到这个？如果不是，我目前的方法是最好的解决方案吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-04T14:05:23.853

有一种方法，但它包括您对每个数量的参数和这些成员函数的 const/volatile 修饰符重复您的专业化。一种更简单的方法是使用`boost.functiontypes`which 为您执行此操作：

```
template<typename T>
void doit(T t) {
    if(boost::function_types::is_member_function_pointer<T>::value) {
        std::cout << "it is";
        // ...
    } else {
        std::cout << "it is not";
        // ...
    }
} 
```

[从这里](http://www.boost.org/doc/libs/1_37_0/libs/function_types/doc/html/index.html)抓住它。

# c# - 出于与 Try-Catch 相同的原因，是否要谨慎使用 Try-Finally？

> ID：411012
> 
> 赞同：11
> 
> 时间：2009-01-04T14:05:52.183
> 
> 标签：c#, asp.net, vb.net, exception, class

我刚读完[这篇](https://stackoverflow.com/questions/410558/why-are-exceptions-said-to-be-so-bad-for-input-validation)关于异常的优缺点的文章，我同意 Try-Catch 块不应该用于“正常”控制流管理的观点（不要像 goto 一样使用它们）。然而，一位作者对可维护性，尤其是性能提出了（好的）观点，这让我对 Try-Finally 块中的同一件事感到疑惑。

*我将我的 ASP.NET 应用程序中的每个*Connection open 事件都用 Try包围，这样我就可以确保在 finally 中关闭 Connection。在网络应用程序中泄漏连接显然不是一件好事，我怀疑我会改变这种做法，但你的想法是什么？

注意：我确实将连接包装在 DAL 中，并且可以在调用对象析构函数时关闭连接，但这对我来说似乎很粗略。据我所知，您不能指望在发生异常时调用析构函数。我错了吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-04T14:11:06.590

您无需避免使用 try {} ... finally {} 编码模式。但就您的连接而言，由于它们是 IDisposable，请改用“使用”，因为它为您做的事情与更长、更麻烦的 try/finally 块相同。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-04T14:14:29.250

到处使用 try-catch 块的*坏处*在于，在使用异常时，您可能会隐藏错误代码。Try-finally（没有 catch）不会隐藏异常，但会提供代码执行保证。在您的情况下，即使是格式正确的 SQL 命令（例如尝试插入重复行），您也可以预期某些类型的异常，因此我认为 finally 的使用是合理的。这假设您和我一样认为连接应该是短暂的并且在使用时打开/关闭，而不是在 DAL 的生命周期内。

**编辑**：我会第二次@Dave Markle 的建议。using 块更加优雅和语义等价。唯一一次我可能更喜欢 try-finally 而不是 using 是避免多个嵌套的 using 来支持单个 try-finally。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-04T14:09:53.953

在有意义的地方使用 Try/Finally，在您真正遇到由此引起的问题之前，不要尝试优化它。

话虽如此，Try/Finally 并不像异常那样昂贵。当然，它们不是免费的，但是抛出和捕获异常比 Try/Finally 块更昂贵。

.NET 中的“析构函数”在对象被垃圾回收时被调用，这意味着它可能需要很长时间才能被调用。使用 Dispose 模式来实现确定性资源处置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-04T14:14:45.643

我相信将连接包装在 using 语句中是一种更好的做法（假设连接实现 IDisposable）。dispose 方法将检查您的连接状态并在必要时关闭。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-04T14:26:17.230

AC# 析构函数在对象被垃圾回收时调用，除了少数边界情况（如果应用程序正在关闭，终结器线程只会得到这么长的时间，之后它就会被终止）。但这意味着你不知道它什么*时候*会被调用。在对象被垃圾收集之前可能需要很长时间。所以你是对的，这是个坏主意。

然而，try/finally 通常也是没有意义的，因为一个`using`块会更优雅地实现同样的事情。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-04T15:26:17.483

正如其他人指出的那样，由于在 C# 中有 using 构造，因此很少需要 try-finally。我仍然相信该模型比 C++ 中的 RAII 倒退了一步——原因是客户端代码仍然需要记住使用 using（就像他们必须记住使用 try-finally 一样）。虽然 using 比 try-finally 更简洁，但如果你习惯了 C++，它仍然显得不必要地冗长，尤其是当你有几层嵌套时。

不久前，我写了一篇关于如何减轻这种情况的博客文章：

[http://www.levelofindirection.com/journal/2009/9/24/raii-and-readability-in-c.html](http://www.levelofindirection.com/journal/2009/9/24/raii-and-readability-in-c.html)

# ssh - 来自动态 IP 的 ssh/VPN 访问/旅行时。基于 knockd 或 dynDNS 的身份验证？

> ID：411037
> 
> 赞同：0
> 
> 时间：2009-01-04T14:21:39.390
> 
> 标签：ssh, sysadmin, openvpn, knockd

使用 knockd 与使用基于动态 DNS 的身份验证从动态 IP 地址或旅行（即一些随机酒店 IP）进行 ssh 或 VPN 登录的优缺点是什么？理想情况下，任何具有 ssh/VPN 客户端功能的设备都应该能够使用任何需要的附加客户端软件。

（另一种选择，保持 ssh / VPN 端口对所有人开放，这不是很有吸引力。）

我倾向于喜欢 knockd （或其他端口敲门守护程序），因为它不依赖于第 3 方来保持其不妥协的东西......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T12:59:51.177

你真的害怕让你的 SSH 端口保持开放吗？会发生什么？

您拒绝了 root 访问，您安装了 BFD 或拒绝主机之类的东西，您只使用公钥身份验证...您真的认为这不安全吗？

恕我直言，添加诸如 knockd 之类的内容可能会引入错误的安全感。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T13:06:39.900

即使您保持 SSH 端口关闭，也只能让 openvpn 的端口保持打开状态（并让 openssh 仅在 vpn 接口上侦听）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-05T12:23:13.780

好吧，除非您使用 DNSSEC，否则基于 DNS 的身份验证是一个相当糟糕的主意。DNS 不安全，酒店提供商经常使用 DNS。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-05T12:29:59.537

我自己，我在非标准端口上使用 ssh，只接受带有密钥文件的用户登录。

当我在端口 22 上运行 ssh 时，有很多字典攻击，但他们都使用“root”用户（无论如何都不允许通过 ssh 登录）。

# c# - 私有字段和私有属性的区别

> ID：411048
> 
> 赞同：38
> 
> 时间：2009-01-04T14:26:27.323
> 
> 标签：c#, .net, properties

使用私有属性而不是私有字段有什么区别

```
private String MyValue { get; set; }

// instead of

private String _myValue;

public void DoSomething()
{
   MyValue = "Test";

   // Instead of

   _myValue = "Test";
} 
```

有任何性能问题吗？还是只是一个命名约定？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-01-04T14:37:09.280

私有属性允许您抽象内部数据，以便对内部表示的更改不需要影响实现的其他部分，即使在同一个类中也是如此。私有字段不提供此优势。使用 C# 3.0 中的自动属性，我很少看到需要直接实现字段——私有或公共。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-01-04T16:22:08.540

您可以从属性（私有、公共......）中获得的最大收益是它可以产生计算值与设定值。例如

```
class Person { 
  private DateTime _birthday;
  private int _age { get { return (DateTime.Now - _birthday).TotalYears; }
} 
```

这种模式的优点是只需为 N 个其他值更新一个值以反映更改。无论可访问性如何，属性都是如此。私有财产与非私有财产没有特别的优势（当然，除了它是私有的）

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-01-04T14:31:57.653

您很少希望将财产设为私有。提供私有财产的规定只是为了完整性。如果您的属性只是获取/设置字段的值，那么不会有性能差异，因为它很可能会被 JIT 编译器内联。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-04T14:44:18.113

除了已经回答的问题之外，性能、语义和完整性，我见过一个有效的案例，用于私有属性而不是私有字段：

```
public class Item
{
    private Item _parent;
    private List<Item> _children;

    public void Add(Item child)
    {
        if (child._parent != null)
        {
            throw new Exception("Child already has a parent");
        }
        _children.Add(child);
        child._parent=this;
    }
} 
```

假设我们不想出于任何原因公开 Parent，但我们可能还想进行验证检查。是否应该能够将父母作为孩子添加到其孩子之一？

要解决此问题，您可以将其设为属性并检查循环引用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-04T14:30:45.333

属性访问将（部分）变慢，因为它将调用 getter/setter。好处是您可以进行数据验证，例如，如果您更改要保护的属性，则可以过滤到继承者。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-04T17:02:18.693

在处理私有访问时，差异非常小。是的，存在性能损失（可能由 JIT 优化）发送属性表示方法调用，而不是直接地址访问。

使用属性的主要优点是允许更改实现而不更改所需的外部签名。由于这些是私人访问的，因此对实现的任何更改只会影响本地代码。

在与私人成员打交道时，除了您团队的约定外，我认为财产没有任何优势。

# asp.net-mvc - ASP.NET MVC 页面/子页面路由

> ID：411054
> 
> 赞同：5
> 
> 时间：2009-01-04T14:28:36.600
> 
> 标签：asp.net-mvc, routing

我试图弄清楚如何处理以下情况。一般来说，我在一个表中有一堆记录。所有这些都有 ID 和 ParentID 字段以形成树。

```
Page1
 - Page2
 - Page3
Page4
 - Page5
 -- Page6 
```

现在，我希望我的 Page3 和 Page6 的路线分别是一样`/Page1/Page6`的`/Page3/Page5/Page6`。也就是说，我想在 URL 中包含所有父母。

如何设置我的控制器动作/路由以实现上述结果？

编辑：忘了提到上述结构将是动态的 - 可以添加/删除/更改父节点等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-04T15:52:15.153

您可以使用通配符匹配。

可能的路线：

```
routes.MapRoute("SomeName", "{*Page}", new { controller = "ControllerName", action = "ActionName" }); 
```

并在操作中接受字符串 Page，并手动解析它，也许有一个拆分？

这也可能有用：[URL 路由](http://weblogs.asp.net/scottgu/archive/2007/12/03/asp-net-mvc-framework-part-2-url-routing.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-04T16:28:57.917

请注意，控制器名称和操作是固定的，而不是基于 url。

```
// place the more specific route first
routes.MapRoute("r1", "{parent}/{child}/{subchild}", 
    new { controller = "Page", action = "Index", parent = parent, child = child, subchild = subchild });

routes.MapRoute("r2", "{parent}/{child}", 
    new { controller = "Page", action = "Index", parent = parent, child = child });

public class PageController
{
    public ActionResult Index(string parent, string child, string? subchild)
    {
        // stuff
    }
} 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-01-04T14:31:11.243

你应该使用

```
routes.MapRoute("Page6", "Page3/Page5/Page6", new { controller = "Page6", action = "Index" }); 
```

或者也许使用正则表达式路由

[http://blog.sb2.fr/post/2009/01/03/Regular-Expression-MapRoute-With-ASPNET-MVC.aspx](http://blog.sb2.fr/post/2009/01/03/Regular-Expression-MapRoute-With-ASPNET-MVC.aspx)

# c# - 从 Nunit 运行时，将 XmlSchema 写入 MemoryStream 失败并出现异常

> ID：411056
> 
> 赞同：6
> 
> 时间：2009-01-04T14:29:15.787
> 
> 标签：c#, nunit, xsd

我正在尝试将 XmlSchema 对象转换为字符串。
我正在构建一个简单的 XmlSchema，对其进行编译，然后将其转换如下：

```
public string ConvertXmlSchemaToString(XmlSchema xmlSchema)
{
        String schemaAsString = String.Empty;
        // compile the schema
        XmlSchemaSet schemaSet = new XmlSchemaSet();
        schemaSet.Add(xmlSchema);
        schemaSet.ValidationEventHandler += new ValidationEventHandler(schemaSet_ValidationEventHandler);
        schemaSet.Compile();

        // allocate memory for string output
        MemoryStream memStream = new MemoryStream(1024);
        xmlSchema.Write(memStream);
        memStream.Seek(0, SeekOrigin.Begin);
        StreamReader reader = new StreamReader(memStream);
        schemaAsString = reader.ReadToEnd();
        return schemaAsString;
} 
```

作为控制台应用程序运行时，一切正常，但是从 Nunit 运行时，我在“xmlSchema.Write(memStream);”中出现异常 线。

例外是：生成 XML 文档时出错。

内部异常是：公共语言运行时检测到无效程序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-04T15:09:13.290

可能无法解决您的问题，但您可能希望像这样将 usings 包裹在您的流中。

```
// allocate memory for string output
using (MemoryStream MemStream = new MemoryStream(1024))
{
    xmlSchema.Write(MemStream);
    MemStream.Seek(0, SeekOrigin.Begin);
    using (StreamReader reader = new StreamReader(MemStream))
    {
        SchemaAsString = reader.ReadToEnd();
    }
}
return SchemaAsString; 
```

这样，流就可以正确处理。这可能就是 NUnit 所抱怨的。

# c# - CodeDom 泛型类型约束

> ID：411057
> 
> 赞同：12
> 
> 时间：2009-01-04T14:29:31.107
> 
> 标签：c#, generics, codedom

有没有办法使用 CodeDom 生成类约束。

因为当我使用类似的东西时

```
var method = new CodeMemberMethod();
var genericParam = new CodeTypeParameter("InterfaceType");
genericParam.Constraints.Add("class");
method.TypeParameters.Add(genericParam); 
```

生成的代码就像

```
private InterfaceType GetImpl<InterfaceType>()
    where InterfaceType : @class
{
} 
```

我发现最好的解决方法是在上课前使用前导空格

```
genericParam.Constraints.Add(" class"); 
```

但这似乎充其量是一种解决方法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-10T14:50:49.353

似乎没有明确的方法来指定该约束。既不[是“结构”约束](http://msdn.microsoft.com/en-us/library/d5x73970(VS.80).aspx)。

对于“T : new()”约束，使用标志`HasConstructorConstraint`

其余的使用 CodeTypeReference，就像在[这个 msdn 示例](http://msdn.microsoft.com/en-us/library/system.codedom.codetypeparameter.aspx)中一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-02T20:35:26.877

我还使用零宽度空格 ( `"\x200Bclass"`) 而不是普通空格。然后我用空字符串替换它在最终字符串中：`.Replace("\x200B", string.Empty);`

# jquery - IE 正在丢失 ClearType

> ID：411058
> 
> 赞同：14
> 
> 时间：2009-01-04T14:30:02.383
> 
> 标签：jquery, internet-explorer, cleartype

我正在经历一些非常奇怪的事情！

我有一个用 JS (jQuery) 隐藏的 div。像这样：

```
$('#myDiv').hide(); 
```

然后当我像这样进行淡入淡出时：

```
$("#myDiv").fadeIn('slow'); 
```

然后文本在 IE 中丢失 ClearType，但在 FF 中没有。如果我使用切换插入的淡入淡出，那么一切都很好。

IE 在做什么，是否有任何解决方案，因为它看起来很可怕。 *（我已经开启了 ClearType，正如您此时可能理解的那样）*

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-04T14:34:00.037

对该主题的快速搜索显示以下内容：

[jQuery 淡入/淡出 IE cleartype 故障](http://blog.bmn.name/2008/03/jquery-fadeinfadeout-ie-cleartype-glitch/)

问题似乎是CSS“过滤器”属性不会自动删除。**解决此问题的最简单方法**是手动删除它：

```
$('#myDiv').fadeIn('slow', function() {
   this.style.removeAttribute('filter');
}); 
```

正如上面的博客文章所解释的，这是一个相当混乱的解决方案。

摘自博客文章，包括针对此问题的**更清洁的解决方案**：

> 这意味着每次我们想要淡化一个元素时，我们都需要删除 filter 属性，这使得我们的代码看起来很乱。
> 
> 一个简单、更优雅的解决方案是通过 jQuery 的插件接口使用自定义函数包装 .fadeIn() 和 .fadeOut() 函数。代码将完全相同，但我们不直接调用淡入淡出函数，而是调用包装器。像这样：

```
$('#node').customFadeOut('slow', function() { 
   //no more fiddling with attributes here
}); 
```

> 那么，你如何让这个工作？在您包含 jQuery 库以添加功能后，只需包含以下代码。

```
(function($) {
    $.fn.customFadeIn = function(speed, callback) {
        $(this).fadeIn(speed, function() {
            if(jQuery.browser.msie)
                $(this).get(0).style.removeAttribute('filter');
            if(callback != undefined)
                callback();
        });
    };
    $.fn.customFadeOut = function(speed, callback) {
        $(this).fadeOut(speed, function() {
            if(jQuery.browser.msie)
                $(this).get(0).style.removeAttribute('filter');
            if(callback != undefined)
                callback();
        });
    };
})(jQuery); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-04T15:02:15.220

一种方法是在 div 上设置背景颜色（通常）为白色。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-04T14:33:27.823

当对 IE 应用淡入淡出时，它会（至少通过 jquery）应用 dxtransform 类，这将使它失去任何抗锯齿效果，直到其不透明度恢复为 1。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-01-09T11:48:30.893

我设法提出了一个有点“通用”的解决方案。*如果不透明度介于 0 和 1 之间， removeAttribute*不起作用，所以我的两美分解决方案如下：

*将此代码放在 jQuery animate 方法定义 (jquery.xxxjs) 的第一行之后*

```
animate: function( prop, speed, easing, callback ) {
var optall = jQuery.speed(speed, easing, callback);

/*
 * IE rendering anti-aliasing text fix.
 */
// fix START
var old_complete_callback = optall.complete;
optall = jQuery.extend( optall, {complete: function(){
        if (jQuery.browser.msie) {
            var alpha = $(this).css('opacity');
        if(alpha == 1 || alpha == 0) {
            this.style.removeAttribute('filter');
        }
        }
        if (jQuery.isFunction(old_complete_callback)) {
        old_complete_callback.call(this);
        }
    }
});
// fix END

    ... 
```

希望这会有所帮助...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-01-10T13:07:25.220

我设法提出了一个有点“通用”的解决方案。如果不透明度介于 0 和 1 之间，removeAttribute 不起作用，所以我的两美分解决方案如下：

将此代码放在 jQuery animate 方法定义 (jquery.xxxjs) 的第一行之后

```
animate: function( prop, speed, easing, callback ) {
var optall = jQuery.speed(speed, easing, callback);

/*
 * IE rendering anti-aliasing text fix.
 */
// fix START
var old_complete_callback = optall.complete;
optall = jQuery.extend( optall, {complete: function(){
    if (jQuery.browser.msie) {
        var alpha = $(this).css('opacity');
        if(alpha == 1 || alpha == 0) {
            this.style.removeAttribute('filter');
        }
    }
    if (jQuery.isFunction(old_complete_callback)) {
        old_complete_callback.call(this);
    }
}});
// fix END

... 
```

希望这会有所帮助...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-04T14:37:15.443

我读过 Firefox 2 在应用不透明度时使用自己的文本渲染引擎（至少在 Mac 上）。这有时看起来很奇怪。

我已经用这个 CSS 解决了这个问题（它似乎根本不影响性能）

```
body {
   -moz-opacity: 0.99;
} 
```

这*也可以*在 IE 中工作。哦，但你需要使用 IE 的专有`filter`属性。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-01-26T11:55:32.843

好的，这是我有史以来最糟糕的解决方案：

```
<head>
    <script>
        $(function() {
                $(document.body).fadeIn(0);
        });
    </script>
</head>

<body>

    <script>
        $(document.body).hide();
    </script>

    body text
</body> 
```

立即隐藏正文，并在文档完成后将其淡入。然后你基本上禁用了cleartype。

哦，**请不要任何人这样做。**或者，如果它对你来说真的很有意义，那就好好测试一下。请记住，在加载整个 DOM 之前，您不会看到任何东西。我还看到了一些奇怪的图形故障。

# bash - 我如何告诉 rsync 仅在目标目录存在时才运行？

> ID：411092
> 
> 赞同：8
> 
> 时间：2009-01-04T14:52:20.093
> 
> 标签：bash, rsync

我有这个 bash 脚本运行我的备份到外部硬盘驱动器...仅当该驱动器已安装（OS X）：

```
DIR=/Volumes/External; 
if [ -e $DIR ]; 
then rsync -av ~/dir_to_backup $DIR; 
else echo "$DIR does not exist"; 
fi 
```

这可行，但我觉得我误读了 rsync 手册页。如果顶级目标目录不存在，是否有内置的 rsync 选项可以中止运行？在不测试 /Volumes/External 的存在的情况下，如果目录尚未挂载，则将使用该名称创建目录。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-04T14:58:54.790

这两个标志看起来像您要查找的内容：

```
--existing, --ignore-non-existing 
```

从手册页：

> --existing, --ignore-non-existing
> 这告诉 rsync 跳过创建目标上尚不存在的文件（包括目录）。如果此选项与 --ignore-existing 选项结合使用，则不会更新任何文件（如果您只想删除无关文件，这将很有用）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-04T15:00:56.067

AFAIK 不，但你可以用斜杠模拟行为：

`rsync -av dir_to_backup /Volumes/External/;`

如果目录不存在（可能需要也可能不需要），它将退出并出现错误。

此外，您始终可以优化 if：

`test -e $DIR && rsync -av ...`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-04T15:03:40.787

不，据我从手册页中看到的，似乎没有任何这样的选项。

# c++ - 派生类中具有相同名称但不同签名的函数

> ID：411103
> 
> 赞同：95
> 
> 时间：2009-01-04T15:02:59.293
> 
> 标签：c++, function, inheritance, lookup, c++-faq

我有一个同名的函数，但在基类和派生类中有不同的签名。当我尝试在从派生继承的另一个类中使用基类的函数时，我收到一个错误。请参阅以下代码：

```
class A
{
    public:
    void foo(string s){};
};

class B : public A
{
    public:
    int foo(int i){};
};

class C : public B
{
    public:
    void bar()
    {
        string s;
        foo(s);
    }
}; 
```

我从 gcc 编译器收到以下错误：

```
In member function `void C::bar()': no matching function for call to `C::foo(std::string&)' candidates are: int B::foo(int) 
```

如果我`int foo(int i){};`从 class中删除`B`，或者如果我从 重命名它`foo1`，一切正常。

这有什么问题？

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2009-01-04T15:07:40.123

这是因为如果在您的一个基地中找到名称，名称查找就会停止。它不会超越其他基地。B 中的函数会影响 A 中的函数。您必须在*B*的范围内重新声明 A 的函数，以便从 B 和 C 中可以看到这两个函数：

```
class A
{
    public:
    void foo(string s){};
};

class B : public A
{
    public:
    int foo(int i){};
    using A::foo;
};

class C : public B
{
    public:
    void bar()
    {
        string s;
        foo(s);
    }
}; 
```

编辑：标准给出的真实描述是（从 10.2/2 开始）：

> 以下步骤定义在类范围 C 中名称查找的结果。首先，考虑类中及其每个基类子对象中名称的每个声明。如果 A 是 B 的基类子对象，则一个子对象 B 中的成员名称 f 隐藏子对象 A 中的成员名称 f。任何如此隐藏的声明都将不予考虑。由 using 声明引入的这些声明中的每一个都被认为来自 C 的每个子对象，这些子对象的类型包含由 using 声明指定的声明。96) 如果声明的结果集不是全部来自相同类型的子对象，或者该集合具有非静态成员并包含来自不同子对象的成员，则存在歧义并且程序格式错误。否则，该集合是查找的结果。

它在另一个地方（就在它上面）有以下说法：

> 对于 id-expression [*类似 "foo"* ]，名称查找从 this 的类范围开始；对于qualified-id [*类似于“A::foo”，A 是一个嵌套名称说明符*]，名称查找在嵌套名称说明符的范围内开始。名称查找发生在访问控制之前（3.4，第 11 节）。

（[...] 由我提出）。请注意，这意味着即使您在 B 中的 foo 是私有的，仍然无法找到 A 中的 foo（因为稍后会发生访问控制）。

* * *

## 回答 #2

> 赞同：82
> 
> 时间：2009-01-04T15:09:23.537

派生类中的函数不覆盖基类中的函数但具有相同名称的函数将*隐藏*基类中的其他同名函数。

通常认为在派生类中具有与低音类中的函数同名的函数被认为是不好的做法，这些函数并不打算覆盖基类函数，因为您所看到的通常不是可取的行为。通常最好给不同的函数起不同的名字。

如果您需要调用基本函数，则需要使用`A::foo(s)`. 请注意，这也会同时禁用任何虚拟功能机制`A::foo(string)`。

# c++ - C ++，指向函数和指向成员函数的指针之间的等价？

> ID：411114
> 
> 赞同：4
> 
> 时间：2009-01-04T15:08:46.300
> 
> 标签：c++, boost, function-pointers

我习惯于认为成员函数只是普通函数的一种特殊情况，其中成员函数在其参数列表的开头有一个额外的参数，用于 'this' 指针，即成员函数所在的对象应该采取行动。我过去曾以这种方式使用过 boost::function 并且从未遇到任何问题：

```
boost::function f<(void)(MyObject*, int, int)> = &MyObject::method_that_takes_two_ints; 
```

但是我已经看到了成员函数指针的这种语法：

```
void (MyObject::*f)( int, int ) = &MyObject::method_that_takes_two_ints; 
```

在此语法中，“this”参数不可见。这让我想知道，指向成员函数的指针是否真的是一个单独的野兽，而这种提升正在为我处理细节。

标准对“this”参数的位置有何规定？也许只是在我的编译器上，额外的“this”参数首先出现，也许在其他编译器上它可能在最后？我是否很幸运，我的思维方式与我的编译器（GCC4、VS2005）处理它的方式一致？指向成员函数的指针总是只是带有额外参数的指向函数的特例，还是编译器可以以不同的方式实现它们？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-04T15:15:26.427

该标准几乎没有说明`this`指针应该放在哪里，事实上，对成员函数使用不同的调用约定是相当普遍的。（所以'this'指针不仅仅是一个额外的第一个参数，它实际上存储在与第一个参数不同的位置）

特别是，MSVC`thiscall`对成员函数和`stdcall`其他地方使用调用约定。 [http://www.hackcraft.net/cpp/MSCallingConventions/#thiscall](http://www.hackcraft.net/cpp/MSCallingConventions/#thiscall)描述了它们之间的区别，但注意`thiscall`将`this`指针存储在`ECX`寄存器中，而`stdcall`将*所有*参数存储在堆栈中。

您绝对最好将它们视为完全不同的类型。指向成员函数的指针*不仅仅是*指向带有额外参数的函数的指针。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-04T15:34:34.393

指针不与指向成员的`this`指针一起存储（成员函数指针是这种情况的特例）。如果你只是这样做

```
void (MyObject::*f)( int, int ) = &MyObject::method_that_takes_two_ints; 
```

那么存储的只是您以后必须提供的对象上应该调用哪个成员函数的信息。如果你想调用它，你必须传递一个对象，编译器将从那里获取`this`指针。

```
MyObject o; (o.*f)(1, 2); 
```

成员函数指针只是一个成员指针，其类型（指向）是函数类型。标准说成员函数指针没有它们自己指向的“成员函数类型”，并且会以某种方式包含 this 指针类型。

```
int main() {
    typedef void fun() const;
    fun MyObject::*mem_function_ptr = 
        &MyObject::const_method_that_takes_two_ints;
} 
```

`fun`在该代码中是函数类型。“正常”函数具有的类型。与成员函数指针相反，指向函数的指针只是指向具有该类型的函数的指针：

```
void foo() { cout << "hello"; }
int main() {
    typedef void fun();
    fun * f = &foo;
} 
```

而指向成员函数的指针在该函数类型之上具有附加的成员指针级别。

关于`this`指针的一些事情以及它与它指向的对象的关系（不是技术性的，只是理论上的东西）：

每个成员函数都有一个隐藏参数，称为 ，`implicit object parameter`它具有类型`MyObject&`或`MyObject const&`取决于您是否具有 const 或非常量成员函数。您在 上调用成员函数的对象`o`是`implied object argument`，它被传递给参数。在构成描述如何调用成员函数的规则的标准理论中，隐式对象参数是第一个隐藏参数。这是概念性的，并不意味着它是实现中的真实案例。隐含对象参数然后绑定到该隐含对象参数，可能导致隐式转换（因此，如果您在非常量对象上调用 const 成员函数，则限定转换将从转换`MyObject`为`MyObject const&`. 对于非常量对象，这就是使非常量函数比调用 const 函数更好的选择的原因）。例如，可以在这段代码中说：

```
struct A {
    operator int() const { return 0; }
};

int main() { 
    A a;
    int i = a; // implicit conversion using the conversion function
} 
```

type 的隐含对象参数绑定到`a`type的隐含对象参数，然后具有此处类型的指针指向其对象。需要注意的重要一点是，隐式对象参数只是一个理论构造，用于形式化调用成员函数的规则是如何构成的（构造函数不包括它们），而 this 指针实际上是存在的。是一个指针，因为在引入的时候，C++ 还没有引用。`A``A const&``this``A const*``this``this`

我希望这能帮助你理解这个问题。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-04T22:59:15.913

一篇关于成员函数指针的优秀文章是 CodeProject 的[Member Function Pointers and the Fastest Possible C++ Delegates](http://www.codeproject.com/KB/cpp/FastDelegate.aspx)。本文介绍了从简单案例到具有多重继承的虚拟成员函数指针的成员函数指针。作为奖励，它提供了一个非常有用的委托实现。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-04T15:16:50.700

是的，指向函数的指针和指向成员的指针是完全不同的野兽。需要为指向成员的指针提供一个对象实例，以便使用`->*`or`.*`运算符取消引用。制作指向成员的指针时没有`this`使用参数，因为在使用指向成员的指针时确定（ or`this`左侧的对象）。`->*``.*`

请注意，指向成员函数和指向成员变量的指针之间的差异可能比指向成员函数和常规函数指针之间的差异要小。

通常，成员函数和常规函数可以具有完全不同的调用约定，因此您不能在它们之间进行转换。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-04T23:34:36.793

请注意，使用不同的编译器，指向成员函数的指针的大小可能会有所不同。

[另一件需要注意的事情，如The Old New Thing 博客](http://blogs.msdn.com/oldnewthing/archive/2004/02/09/70002.aspx)中所写：

> 指向成员函数的指针的大小可以根据类而改变。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-04T15:19:35.077

它们绝对是不同的类型，您所做的任何假设都将是特定于平台/编译器的。

[这个页面](http://www.codeproject.com/KB/cpp/FastDelegate.aspx)有比我想知道的更多关于成员函数点实现的信息，包括许多流行编译器的实现细节。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-05T09:47:58.803

回答所有问题：是的，它们是特殊指针，不同于普通指针。是的， boost::function 可以识别它们。

该标准没有说明调用堆栈的内部细节。事实上，许多编译器可能会根据实际参数列表使用整数寄存器、浮点寄存器和/或堆栈。'this' 指针只是另一种特殊情况。

Boost::function 通过在内部使用两个代码路径解决了这个问题。您可以通过检查这两种情况的调用堆栈来看到这一点。如果您的 boost::function 存储了指向成员函数的指针，则 operator() 将拆分参数列表。第一个参数用作使用其余参数调用成员函数的对象。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-04T21:11:36.863

为了补充其他人的答案，Boost.Function 通过专门针对成员函数指针的赋值运算符来工作，以允许它检测您何时通过了一个。当您调用该函数时，它会在内部将其重新解释为调用成员函数指针 ( `(obj->*fun)(args)`) 的正确方法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-05T10:23:48.217

我想你可能会觉得这个链接很有趣：

[http://www.parashift.com/c++-faq-lite/pointers-to-members.html](http://www.parashift.com/c++-faq-lite/pointers-to-members.html)

它很好地描述了您想了解的有关指向成员的所有内容。

# scripting - 程序化图形工具链

> ID：411118
> 
> 赞同：2
> 
> 时间：2009-01-04T15:10:29.790
> 
> 标签：scripting, svg, inkscape

我在[Inkscape](http://inkscape.org/)中绘制了一个图标，但现在想以编程方式对其进行更改（针对不同的图标状态稍微更改颜色）并将其转换为包含多个不同颜色图标的平铺 PNG 格式文件。我知道 Inkscape 的*--export-png*选项，但看不到让它更改图像和/或多次导出到组合图像的不同部分的方法。

**是否有任何好的*面向用户的*工具来以编程方式摆弄图像，或者我是否必须深入研究 GD 甚至手动修改 SVG XML？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-04T15:15:36.163

尽管我不能 100% 确定它是否满足您对面向用户的要求，但我建议您查看[www.imagemagick.org](http://www.imagemagick.org "ImageMagick")。我已经成功地使用它的“convert”实用程序将脚本从 svg 转换为 png 并添加自定义背景颜色。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-18T16:28:41.473

我使用两组简单的工具来为网络漫画做到这一点：

*   用于修改 SVG XML 的基本 Perl/PHP/Ruby 脚本（还有一个很棒的 Perl 库，但我发现我需要的基本更改不需要它）
*   从命令行运行 Inkscape 本身以将 SVG 渲染为 PNG。Inkscape 的 SVG 渲染是迄今为止我发现的最好的。

注意：Inkscape 可以通过一些工作安装在网络服务器上，并且可以从 CGI（perl、php 等）调用，尽管它很慢（所以你应该缓存结果）。

从 SVG 文件目录的命令行调用它：

```
find -name "*svg" -exec inkscape -z --file={} \ 
    --export-png=$OUTPUT{}.png --export-width=640 --vacuum-defs \; 
```

*   查找所有 SVG 文件
*   运行 Inkscape 渲染每个文件
*   宽度限制为 640 像素
*   清理 SVG 文件（在签入 svn/git 之前最好这样做）

您可能还对[Batik](http://xmlgraphics.apache.org/batik)感兴趣，这是一个用 Java 编写的 SVG 渲染引擎。它在服务器端运行良好，并且相当独立。

# memory - 比较代码大小与源大小

> ID：411121
> 
> 赞同：2
> 
> 时间：2009-01-04T15:13:18.740
> 
> 标签：memory, dll, code-generation, code-analysis, metrics

有很多用于计算代码行数的脚本/工具，还有一些可以根据代码行数计算函数大小。但是在这里，我正在寻找一种方法来根据生成的代码字节来测量函数大小。

有谁知道从 .lib 或 .dll 中提取此信息的方法/工具？

例如，我知道如何列出 .lib 或 .dll 中的函数名称及其起始地址，但我还没有找到获取它们内存占用的方法。

PS：我正在寻找 Windows 平台上的解决方案，但欢迎任何关于替代系统的答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-04T15:28:58.367

我不确定它是否完全符合您的要求，但您可以尝试按照[本教程](http://home.hiwaay.net/~georgech/WhitePapers/MapFiles/MapFiles.htm)解析地图文件。

此外，如果您寻求付费解决方案，[Red-gate 的 ANTS 分析器](http://www.red-gate.com/Products/ants_profiler/index.htm)是合理的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-04T16:19:32.163

在 Unix 上，该`size`命令会为您提供相关信息：

```
Black JL: size /usr/lib/libc.so.1
909301 + 32017 + 6731 = 948049
Black JL: size ~/lib/libjl.a
/work1/jleffler/lib/libjl.a[affbak.o]: 4849 + 44 + 4 = 4897
/work1/jleffler/lib/libjl.a[affstd.o]: 5488 + 48 + 4 = 5540
/work1/jleffler/lib/libjl.a[base64.o]: 8772 + 9 + 320 = 9101
/work1/jleffler/lib/libjl.a[basedigit.o]: 841 + 0 + 0 = 841
/work1/jleffler/lib/libjl.a[basename.o]: 996 + 0 + 0 = 996
/work1/jleffler/lib/libjl.a[bitmap.o]: 3876 + 8 + 4096 = 7980
...lots of entries omitted...
Black JL: size ~/bin/sqlcmd.64
169694 + 17728 + 8280 = 195702
Black JL: size cc3e_*.o | so
cc3e_fixed_from_gregorian.o: 1906 + 0 + 0 = 1906
cc3e_gregorian_date.o: 684 + 0 + 0 = 684
cc3e_gregorian_epoch.o: 707 + 0 + 0 = 707
cc3e_gregorian_from_fixed.o: 1729 + 0 + 0 = 1729
cc3e_gregorian_year_from_fixed.o: 1625 + 0 + 0 = 1625
cc3e_last_kday.o: 742 + 0 + 0 = 742
cc3e_nth_kday.o: 1123 + 0 + 0 = 1123
Black JL: 
```

来自我系统周围的半随机文件 - 这是运行 Solaris 10 的 Sun SPARC，使用`size`from `/usr/ccs/bin`（不是 GNU 版本，但它可能会提供类似的信息）。

`size`Cygwin 下的GNU说：

```
$ size libjl.a
text    data     bss     dec     hex filename
 800      64      16     880     370 affbak.o (ex libjl.a)
1008      64      16    1088     440 affstd.o (ex libjl.a)
 176       0       0     176      b0 basedigit.o (ex libjl.a)
 208       0       0     208      d0 basename.o (ex libjl.a)
 544     320    4096    4960    1360 bitmap.o (ex libjl.a)
 816       0      16     832     340 block.o (ex libjl.a) 
```

但是，这可能没有多大帮助 - 当在 DLL (C:\WINDOWS\twain.dll) 上运行时，GNU`size`表示它无法识别文件类型。OTOH，它似乎确实理解“.lib”文件：

```
jleffler@IBM-027DF09B37F /cygdrive/c/notes/jvm/bin
$ size jawt.lib
   text    data     bss     dec     hex filename
     63      30       0      93      5d jawt.dll (ex jawt.lib)
     63      20       0      83      53 jawt.dll (ex jawt.lib)
     63       8       0      71      47 jawt.dll (ex jawt.lib)
      8      26       0      34      22 jawt.dll (ex jawt.lib)

jleffler@IBM-027DF09B37F /cygdrive/c/notes/jvm/bin
$ ls -l jawt.lib
-rwxrwxrwx+ 1 jleffler None 1692 Oct 25  2007 jawt.lib 
```

# c# - NHibernate ISession.save(newTransientEntity) 是否只会返回生成的 Id，但不会更新实体的 Id 属性？

> ID：411127
> 
> 赞同：2
> 
> 时间：2009-01-04T15:16:05.567
> 
> 标签：c#, nhibernate, attributes, nhibernate-mapping

使用 NHibernate.Mapping.Attributes，我有一个实体类，例如：

```
[Class]    
public class EntityA
{
  ...
  [Id][Generator(class="guid")]
  public Guid Id {...}

  [Property]
  public string Property1 {...}
  ...
} 
```

假设我使用如下代码将瞬态实体添加到持久性上下文中：

```
...
Guid id;
using(ISession s = sessionFactory.OpenSession())
using(ITransaction t = s.BeginTransaction())
{
  EntityA entity = new EntityA();
  entity.Property1 = "Some Value";
  id = (Guid) s.Save(entity);
  t.Commit();
  Assert.IsTrue(s.Contains(entity)); // <-- result: true
}

Assert.AreEquals(id, entity.Id); // <-- Result: false, Expexted: true
... 
```

我想断言会成功，但实际结果是错误的。我的印象是 save 方法将使用生成的值更新实体的 Id 属性。我已经通过使用 NHibernate 1.2 和 2.0 进行了测试，结果相似。

所以问题是：

*   这种行为（不更新实体的 ID）是设计使然，还是我的机器中的 NHibernate 编译错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-04T17:04:53.600

您尚未指定 Id 的名称

代替：

```
[Id] 
```

您应该指定名称：

```
[Id(Name="Id")] 
```

在第一种情况下，生成的映射是错误的：

```
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2">
  <class name="Test.EntityA, test">
    <id type="Guid">
      <generator class="guid" />
    </id>
  </class>
</hibernate-mapping> 
```

而在第二种情况下，您将获得正确的映射：

```
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2">
  <class name="Test.EntityA, test">
    <id type="Guid" name="Id">
      <generator class="guid" />
    </id>
  </class>
</hibernate-mapping> 
```

请注意缺少的 name="Id" 属性。

# ruby-on-rails - 使用 named_scope 获取行数

> ID：411134
> 
> 赞同：12
> 
> 时间：2009-01-04T15:20:47.727
> 
> 标签：ruby-on-rails, ruby

`named_scope`Rails 大师：感谢另一个 SO 用户，我刚刚发现。:)

我想获得一组行的计数 - 即 a `SELECT COUNT(*)`. 此外，我希望仍然能够在调用中链接命名范围。

这是命名范围的合法（尽管很奇怪）用法吗？

```
named_scope :count, :select => "COUNT(*) as count_all" 
```

那么我可以做（例如）：

```
@foobar = Foobar.count.scope.scope.scope 
```

通过 访问计数`@foobar.first.count_all`。

> **（编辑以解决艾伦的评论）**

你可以这样做：

```
@foobar = Foobar.scope.scope.scope.size 
```

但这会导致结果查询，而不是更快的`SELECT COUNT(*)`查询。我正在查询的数据库中有大量行。

有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-04T17:25:42.407

您正在寻找的功能是内置的。

```
Foobar.count # SELECT count(*) AS count_all FROM "foobars"
Foobar.named_scope.count # SELECT count(*) AS count_all FROM "foobars" WHERE .... 
```

如果您`script/server`在开发模式下运行，您将在查询被执行时看到它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-04T16:00:42.110

我认为这根本不正确。范围用于优化查找语句，计数查询不能很好地处理这些语句。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-04T16:47:42.497

有一种更好的方法可以做到这一点，rails 已经为您提供了方法。

使用您的示例，您可以这样做：

```
@foobar_size = Foobar.all.size #returns integer equal to total rows of Foobar 
```

甚至是这样的范围：

```
@banned_foobars = Foobar.scope_to_find_banned.size #returns integer equal to total rows for "scope_to_find_banned" 
```

# c++ - 如何在 MSVC++ 2005 或 2008 的大型解决方案中找到重复的标题？

> ID：411142
> 
> 赞同：3
> 
> 时间：2009-01-04T15:27:35.467
> 
> 标签：c++, visual-c++, header, include

在 Visual Studio (C++) 中，有没有办法轻松找到在 .cpp 文件中定义的重复标头？

我也在尝试寻找检测这种情况的方法：

*   A 包括 B 包括 C
*   A 包括 C
*   => A 不需要包含 C

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-04T15:37:49.720

如果您想检测这种情况，您可以将此宏添加到每个文件的顶部。用 A 代替文件名

```
#if A_H
#error "Duplicate include"
#else
#define A_H
#endif 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-04T15:39:56.083

通常，您使用#pragma 标记它们一次，或等效的宏守卫并停止关心它。

如果您使用的是 MS 编译器，您可以在每个头文件的最顶部放置一个 #pragma 消息（IIRC，它可能是一个 #pragma 警告或 #pragma 错误），其中包含头文件的名称和您的构建输出将显示每个已编译文件包含的每个文件的列表。

这对您的头文件最有效，因为不会包含系统文件。

如果您想查看所有包含的标头，请编辑编译选项以包含[/P （预处理到文件）](http://msdn.microsoft.com/en-us/library/8z9z0bx6.aspx)，这不会编译您的代码，而是将预处理器重定向到文件，然后您可以通过 grep 来查看#include 语句。请注意，这些文件会很大。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-04T18:24:27.060

PC-Lint（可能还有其他 lint 工具）可以指示未使用的包含文件。

# c# - 如何在不禁用的情况下使 WinForms TextBox 中的文本不可选择？

> ID：411143
> 
> 赞同：2
> 
> 时间：2009-01-04T15:28:02.643
> 
> 标签：c#, winforms, textbox

是否可以在不禁用 TextBox 的情况下使 TextBox 中的文本无法选择？这是一个 RichTextBox，我需要它的格式和选择功能。我无法禁用它，因为我想处理 MouseMove 和 MouseDown 事件。

到目前为止，我已经考虑禁用文本框并在其顶部放置一个面板，它将其事件委托给文本框处理程序，但我无法使面板透明，因此它隐藏了文本框。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-04T16:05:01.100

如何处理 .Enter 或 .GotFocus 事件以清除所做的任何选择？[您可以在 WinForms TextBox 中自动选择焦点上的所有文本](https://stackoverflow.com/questions/97459/automatically-select-all-text-on-focus-in-winforms-textbox)
中看到与您想要的相反的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-07-26T08:34:12.433

如何处理这样的选择更改事件：

```
 private void richTextBox1_SelectionChanged(object sender, EventArgs e)
    {
        this.richTextBox1.SelectionStart = this.richTextBox1.Text.Length;
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-04T16:09:43.230

我不太确定你在做什么（想要一些不可选择的东西，但想要它的选择功能），但设置`ReadOnly`为 true 是否完成了你正在寻找的东西？

# javascript - 是什么导致了这些 javascript 验证错误（隐含的全局和已定义的 var）？

> ID：411145
> 
> 赞同：1
> 
> 时间：2009-01-04T15:28:21.393
> 
> 标签：javascript, ajax, validation

谁能解释我为什么：

```
function doAjax() {
    var xmlHttpReq = false;
    try { // Firefox, Opera 8.0+ and Safari
        xmlHttpReq = new XMLHttpRequest();
    }
    catch (e) { // Internet Explorer
        try {
            xmlHttpReq = new ActiveXObject("Msxml2.XMLHTTP");
        }
        catch (e) {
            try {
                xmlHttpReq = new ActiveXObject("Microsoft.XMLHTTP");
            }
            catch (e) {
                alert("Your browser does not support AJAX. Please use an AJAX compatible browser.");
                return false;
            }
        }
    }
    xmlHttpReq.open('GET', 'handler.php', true);
    xmlHttpReq.onreadystatechange = function() {
        if (xmlHttpReq.readyState == 4) {
            var response = xmlHttpReq.responseText;
            handleAjaxResponse(response);
        }
    };
    xmlHttpReq.send(null);
    return true;
} 
```

导致以下验证错误：

```
Error:

Implied global: ActiveXObject 8, XMLHttpRequest 4, alert 15, handleAjaxResponse 24

Problem at line 10 character 16: 'e' is already defined.

catch (e) {

Problem at line 14 character 20: 'e' is already defined.

catch (e) { 
```

通过 JSlint.com javascript 验证器

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-04T15:39:13.820

关于第**一个错误**，这里是[JSLint 文档](http://www.jslint.com/lint.html)的摘录：

> **未定义的变量和函数**
> 
> JavaScript 最大的问题是它对全局变量的依赖，尤其是隐含的全局变量。如果变量没有显式声明（通常使用 var 语句），则 JavaScript 假定该变量是全局变量。这可以掩盖拼写错误的名称和其他问题。
> 
> JSLint 期望所有变量和函数在使用或调用之前都被声明。这允许它检测隐含的全局变量。这也是一种很好的做法，因为它使程序更易于阅读。
> 
> 有时文件依赖于在别处定义的全局变量和函数。您可以通过在文件中包含一个注释来向 JSLint 识别这些，该注释列出了您的程序所依赖但未在您的程序或脚本文件中定义的全局函数和对象。
> 
> 全局声明可能如下所示：

```
/*global getElementByAttribute, breakCycles, hanoi */ 
```

> 全局声明以 `/*global`. 请注意，g 之前没有空格。你可以有尽可能多的`/*global`评论。它们必须出现在使用它们指定的变量之前。

**关于您的问题，以下部分最有可能帮助您修复错误：**

> 可以为您预定义一些全局变量。选择 Assume a browser (browser) 选项（请参阅下面的选项）以预定义 Web 浏览器提供的标准全局属性，例如窗口和文档以及警报。选择 Assume Rhino (rhino) 选项以预定义 Rhino 环境提供的全局属性。选择 Assume a Yahoo Widget (widget) 选项以预定义 Yahoo! 提供的全局属性 小部件环境。

给出第二**个错误**是因为您对每个异常（包括嵌套异常）重新使用了变量“ `e`”。重命名每个异常的变量以避免这种情况。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-04T16:34:28.640

使用像 jQuery 这样的框架会更明智（特别是如果你真的想支持旧版本的 IE（pre v6）），但我认为你不这样做是有原因的。

如果 a) 你不嵌套 try-catch 和 b) 你分解出一组函数会更好，即一个用于获取 Xhr 对象，另一个用于使用 Xhr 对象发出通用 ajax 请求和外部“doAjax " 执行您要进行的特定 ajax 调用的函数：-

```
function getXHR()
{
    var result = null
    if (window.XMLHttpRequest)
    {
        result = new XMLHttpRequest();
    }
    else
    {
        try { result = new ActiveXObject("MSXML2.XMLHTTP.3.0") }
        catch (e) { }

        if (result == null)
        {
            try { result = new ActiveXObject("Microsoft.XMLHTTP") }
            catch (e) { }
        }
    }
    return result; 
}

function ajaxRequest(url, data, callBack)
{
    var xmlHttpReq = getXHR();
    if (xmlHttpReq)
    {
        xmlHttpReq.open(data != null ? 'GET' : 'POST', url, true);
        xmlHttpReq.onreadystatechange = function()
        {
            if (xmlHttpReq.readyState == 4)
            {
                //what happens if status is not 200
                callBack(xmlHttpReq.responseText);
            }
        };
        xmlHttpReq.send(null);
        return true;
    }
    else
    {
        return false;
    }
}

function doAjax()
{
     var result = ajaxRequest('handler.php', null, handleAjaxResponse);
     if (!result) alert("Your browser does not support AJAX. Please use an AJAX compatible browser.");
     return result;
} 
```

进一步的改进是让回调接受一个 XHR 对象而不是基本的 responseText。这会给你更多的灵活性。如果回调函数只是想要文本，它可以使用这个函数：-

```
function getTextFromXhr(xhr)
{
    xhr.onreadystatechange = fnVoid;
    if (xhr.status == 200)
    {
        return xhr.responseText;
    }
    else
    {
        throw {number: xhr.status,
            description: xhr.statusText,
            responseText: xhr.responseText
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-04T15:32:52.633

您在每个 try/catch 块中重用变量 e 。尝试重命名它们以避免冲突。其他问题只是警告您正在使用需要在其他地方定义的东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-04T15:33:43.457

JSlint 通常会给出很多错误...

'e' 已经定义对我来说似乎很清楚:) 您对所有 try-catch 语句使用相同的变量。

# .net - 如何从 Access 表中生成 .net 类

> ID：411162
> 
> 赞同：2
> 
> 时间：2009-01-04T15:42:36.497
> 
> 标签：.net, ms-access

有什么方法可以让我的 .NET 类从 Access 中的表中自动生成？

像 ORM 这样的东西可用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-04T15:58:46.463

您可以使用诸如 nHibernate 之类的 ORM，这是 ORM [http://www.theserverside.net/news/thread.tss?thread_id=29914的部分旧列表](http://www.theserverside.net/news/thread.tss?thread_id=29914)

或者您可以使用代码生成技术，例如 CodeSmith [http://www.codesmithtools.com/](http://www.codesmithtools.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-04T16:37:05.530

You can add a **DataSet** to your project (Add New Item) and then drag-and-drop your tables onto the dataset-view. This will automatically generate classes for the tables.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-04T15:47:39.950

Microsoft Access 支持 NHibernate： [http ://www.hibernate.org/](http://www.hibernate.org/)

LINQ to SQL 和实体框架不支持 Access。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-04T15:48:40.683

MyGeneration 获得了一些用于从访问表中自动生成类的模板。

[http://www.mygenerationsoftware.com/portal/default.aspx](http://www.mygenerationsoftware.com/portal/default.aspx)

# asp.net - 使用 URL Rewrite 和 404.aspx 时的回发问题

> ID：411167
> 
> 赞同：3
> 
> 时间：2009-01-04T15:47:19.047
> 
> 标签：asp.net, url-rewriting, postback, http-status-code-404

我在我的网站上使用 URL 重写来获取如下 URL：
*[http://mysite.com/users/john](http://mysite.com/users/john)*
而不是
*[http://mysite.com/index.aspx?user=john](http://mysite.com/index.aspx?user=john)*

为了使用 IIS6 实现这种无扩展重写并且无法访问托管服务器，我使用了“404 方法”。当服务器找不到请求时，执行映射的 404 页面，因为这是一个 aspx 页面，所以可以执行重写（我可以使用托管服务上的控制面板设置 404 映射）。

这是 Global.asax 中的代码：

```
protected void Application_BeginRequest(object sender, EventArgs e)
{
    string url = HttpContext.Current.Request.Url.AbsolutePath;
    if (url.Contains("404.aspx"))
    {
        string[] urlInfo404 = Request.Url.Query.ToString().Split(';');
        if (urlInfo404.Length > 1)
        {
            string requestURL = urlInfo404[1];
            if (requestURL.Contains("/users/"))
            {
                HttpContext.Current.RewritePath("~/index.aspx?user=" + GetPageID(requestURL));              
                StoreRequestURL(requestURL);
            }
            else if (requestURL.Contains("/picture/"))
            {
                HttpContext.Current.RewritePath("~/showPicture.aspx?pictureID=" + GetPageID(requestURL));
                StoreRequestURL(requestURL);
            }
        }
    }
}

private void StoreRequestURL(string url)
{
    url = url.Replace("http://", "");
    url = url.Substring(url.IndexOf("/"));
    HttpContext.Current.Items["VirtualUrl"] = url;
}

private string GetPageID(string requestURL)
{
    int idx = requestURL.LastIndexOf("/");
    string id = requestURL.Substring(idx + 1);
    id = id.Replace(".aspx", ""); //Only needed when testing without the 404-approach
    return id;
} 
```

在我的母版页上的 Page_Load 中，我在表单标签的操作属性中设置了正确的 URL。

```
protected void Page_Load(object sender, EventArgs e)
{
    string virtualURL = (string)HttpContext.Current.Items["VirtualUrl"];
    if (!String.IsNullOrEmpty(virtualURL))
    {
        form1.Action = virtualURL;
    }
} 
```

重写工作正常，但是当我在页面上执行回发时，没有执行回发，这可以通过某种方式解决吗？

问题似乎与 404 方法有关，因为当我尝试不使用它（并失去无扩展功能）时，回发工作。那是我请求的时候：http:
*[//mysite.com/users/john.aspx](http://mysite.com/users/john.aspx)*

这可以解决还是有任何其他解决方案可以满足我的要求（IIS6，没有服务器访问/ISAPI 过滤器和无扩展）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-08-08T10:01:00.797

```
form1.Action = Request.RawUrl 
```

结合

```
HttpContext.Current.RewritePath("/Default.aspx", true); 
```

对我来说效果很好。

设置表单 Action 属性是我缺少的部分......

感谢您的解决方案！！！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-04T15:57:53.223

Scott Guthrie 在这里介绍了在没有 IIS 访问的情况下执行此操作的不同方法：

[http://weblogs.asp.net/scottgu/archive/2007/02/26/tip-trick-url-rewriting-with-asp-net.aspx](http://weblogs.asp.net/scottgu/archive/2007/02/26/tip-trick-url-rewriting-with-asp-net.aspx)

就个人而言，我过去曾创建过 HTTPModules，而且它很容易组合在一起。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-02-22T13:15:02.150

form1.Action = Request.RawUrl 也是C#的写法 放到页面加载方法中

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-04T15:59:57.540

我将从安装[Live Http Headers](https://addons.mozilla.org/en-US/firefox/addon/3829)开始，看看 Http 请求发生了什么。

啊，在那篇文章中它解释了它，看起来 form 标签的 action 属性是错误的：

> 人们在使用 ASP.NET 和 Url-Rewriting 时经常遇到的一个问题与处理回发方案有关。具体来说，当您`<form runat="server">`在页面上放置一个控件时，ASP.NET 默认会自动输出标记的“action”属性以指向它所在的页面。使用 URL-Rewriting 时的问题是控件呈现的 URL 不是请求的原始 URL（例如：/products/books），而是重写后的 URL（例如：/products.aspx?category =书）。这意味着当您向服务器进行回发时，该 URL 将不是您的干净的 URL。
> 
> 在 ASP.NET 1.0 和 1.1 中，人们经常对控件进行子类化`<form>`并创建自己的控件来正确输出要使用的操作。虽然这可行，但它最终有点混乱 - 因为这意味着您必须更新所有页面才能使用此备用表单控件，并且有时可能会遇到 Visual Studio WYSIWYG 设计器的问题。
> 
> 好消息是，在 ASP.NET 2.0 中，有一个更简洁的技巧可以用来重写`<form>`控件上的“action”属性。具体来说，您可以利用新的 ASP.NET 2.0 控件适配器扩展性体系结构来自定义控件的呈现`<form>`，并用您提供的值覆盖其“操作”属性值。这不需要您更改 .aspx 页面中的任何代码。相反，只需将 .browser 文件添加到您的 /app_browsers 文件夹，该文件夹注册一个控制适配器类以用于输出新的“动作”属性...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-04-19T10:49:10.173

尝试这样的事情：

```
 if (Request.HttpMethod == "GET" && shouldChangeUrl)
            {
                urlRedirect = "REAL-URL-HERE";

                _postBackUrl = urlRedirect;
                Context.RewritePath(urlRedirect);
            }
            else
                //If Post Back (Request.HttpMethod="POST")
                Context.RewritePath(_postBackUrl); 
```

因此，您在重写 url 时将回发的真实 URL 保存在一个变量中（此处为：_postBackUrl），然后仅在回发时使用它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-11-23T22:38:06.220

您可以改用以下内容：

form1.Action = Request.RawUrl

我不确定在 C# 中会是什么，但这就是它在 VB 中的样子，而且它很有效

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-15T19:37:21.790

问题出在 404 处理中。您的表单正在发布到一个不存在的页面，ASP.NET 将请求重定向到 404 页面，因此它会丢失所有回发数据。

唯一的解决方案是将表单的 action 属性设置为现有页面，这样用户在提交表单时会看到 index.aspx?user=john。对于 SEO，这不是问题，因为爬虫不会发布帖子，因此看不到丑陋的地址。

# language-agnostic - 开源专有软件涉及什么？

> ID：411180
> 
> 赞同：7
> 
> 时间：2009-01-04T15:58:11.613
> 
> 标签：language-agnostic, open-source

我提出这个问题的主要动机是[这个 uservoice 建议](https://web.archive.org/web/20090413071456/http://stackoverflow.uservoice.com:80/pages/general/suggestions/29462-make-your-software-open-source)。Jeff 拒绝了让 SO 软件开源的请求，称这需要更多时间。

我以前在从专有到开源的各种其他软件中看到过这一点。所以，我的问题是： **为什么让软件开源似乎需要这么长时间？** 对我来说，这似乎很简单：把你的代码放在 sourceforge 和谷歌代码上，然后就可以完成了。但显然我在整个过程中缺少一些东西。

（在有人认为我试图批评 Jeff 或其他任何延迟开源他们的软件的人之前，我不是。我只是想了解开源的过程及其成本。 )

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-04T16:03:54.550

通常它需要所有贡献者都同意，对于某些项目，这意味着你必须询问很多人是否也可以打开他们的代码。

对于其他项目，它要求您使用的库是开源的，或者从您使用它们的项目中取出。IIRC Sun 表示他们无法[打开 Java](http://www.infoworld.com/article/06/06/27/79685_HNsunopensourcejava_1.html)很长时间，因为他们使用了一些无法打开的 3rd 方代码。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-04T16:55:29.503

其他人已经给出了您问题的主要答案 - 获得这样做的法律许可（请参阅关于SO 相关问题儿童[的 WMD 编辑器逆向工程的](https://blog.stackoverflow.com/2008/12/reverse-engineering-the-wmd-editor/)SO 博客条目）通常非常困难，甚至是不可能的。

> 所以，我的问题是：为什么让软件开源似乎需要这么长时间？对我来说，这似乎很简单：将您的代码放在 Sourceforge 和 Google Code 上并完成它。但显然我在整个过程中缺少一些东西。

您所描述的 - 转储源 - 并不是真正的开源。它更类似于 AbandonWare 或“可用资源”。一个开源项目需要接受来自外部的输入，并建立一个社区。Apache 软件基金会对其孵化器项目使用的标准之一是“它是否从原始作者之外获得了大量的贡献者？”。这是一个合理的担忧。

请注意，AbandonWare 和“可用资源”都不一定是坏的；两者都使原本不可用的代码可用（并提供了开源的一些好处）。但开源远不止这些。

此外，在处理真正的开源项目时存在管理开销。这是不容忽视的。

最后，由于害怕被嘲笑，作者宁愿不提供源代码的代码质量也并非闻所未闻。我怀疑这是否适用于这种情况，但它适用于软件世界的其他领域。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-04T16:04:50.400

原因是：

1.  您确定您有权将软件开源吗？
2.  你**真的**想要吗？

关于第一个问题，请注意您可能正在使用第三方代码，因此您必须检查所有代码，确保您有权将其全部开源。

其次，它要求项目所有者想要开源项目。在某些情况下，他/她可能认为这不值得。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-04T16:38:35.027

打开源代码可能是好是坏。在最好的情况下，他们只会从社区的贡献中受益，并保留创意控制权。在最坏的情况下，项目可能会分叉，两个不同的代码库通常对社区没有好处。

在 SO 的情况下，他们可能会担心，如果有足够多的人不耐烦，那么过早开放源代码会导致项目分叉，因为其他开发人员实现他们的“宠物”功能比 SO 更快（或不同）。也许那些人真的想要被拒绝的功能。

Forking 也带来了 Shawn 提到的竞争方面。也许很久以后，当 SO 拥有更完善的社区时，开放源代码会更容易被接受，因为 SO 将在任何潜在的竞争中抢占先机。

保守的做法是在做出决定之前稍等片刻，而不是现在打开并希望最好。

**编辑：**请注意，即使在最好的情况下，他们也承担了管理开源项目和与任何想要贡献的人打交道的额外角色。想到“放牧猫”的比喻，他们现在可能想专注于代码库而不是管理开销。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-04T17:25:57.287

以下是开源之前需要考虑的一些因素：

1.  您是否能够合法地使代码开源？由于图书馆，其他贡献者等。

2.  你有商业模式/你需要一个吗？在像 SO 或 Digg 这样的项目中，边缘主要在社区中，那么它应该没问题，但在其他部署在企业防火墙内的项目中，使其操作系统降低了赚钱来支付成本的能力。尽管一些公司通过支持来做到这一点，但是，获得支持成本的能力取决于产品的性质以及它对部署它的公司的重要性。

3.  你对社区的感觉如何？有大量的开源项目只有 1 或 2 个贡献者，而贡献补丁的用户并不多。如果是这种情况，那么间接费用可能大于任何收益。

4.  您准备好支持其他人在其他垂直领域甚至同一垂直领域部署您的产品了吗？这意味着论坛、邮件列表、错误跟踪器、易于使用的升级脚本、文档等。

一个项目要想作为开源成功，就必须得到良好的管理。把代码放在那里是不够的。您最终会遇到不愉快的社区，并且可能会出现您无法控制的分叉。

# fortran - FORTRAN，您对开发环境有什么建议

> ID：411195
> 
> 赞同：4
> 
> 时间：2009-01-04T16:06:34.657
> 
> 标签：fortran

我需要开始在 FORTRAN 中开发，关于学习\开发来自 .NET 领域的 FORTRAN 有什么建议吗？有没有推荐的接近 Visual Studio 的环境？Visual Fortran 看起来很有前途，但有点贵，而且看起来它不能用 gcc 编译。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-04T16:32:56.863

Eclipse 是一个很棒的 Java IDE，显然支持 Fortran ......请参阅：

[http://www.eclipse.org/photran/](http://www.eclipse.org/photran/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-06T15:30:38.143

Visual Studio + 英特尔 Fortran 怎么样？当我将程序移植到 Windows 时，我使用该组合。不过，对.NET 一无所知。

在 Fortran 世界中，关于 Eclipse+Photran 的讨论并不多。我们中的很多 Fortran 黑客都认为 Emacs 是一个 IDE。

最后，在 Linux 上，你可以试试 Sun Studio Express——它是免费的，包括 Fortran、C、C++ 编译器和一个基于 NetBeans 的 IDE（实际上，我认为它是 NetBeans）

# apache-flex - Flex 3 - 启动 .exe 文件

> ID：411202
> 
> 赞同：2
> 
> 时间：2009-01-04T16:13:37.387
> 
> 标签：apache-flex

我想整理我的电子书。并想创建一个包含我的电子书列表的空中应用程序。我想要它，如果我单击该电子书名称。我会启动/调用电子书文件。就像双击文件夹中的图标一样。我怎么能在 flex 中触发它？谢谢。

另外，如果我将页码保存在我的 flex 应用程序中，是否有可能在启动电子书文件时，我会直接转到该特定页面？：D？

太感谢了！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-04T16:59:57.013

AIR 不具备启动外部进程的功能。您的选择是使用另一个 EXE 打包解决方案（例如[MDM Zinc](http://www.multidmedia.com/software/zinc/ "MDM锌")）或创建自己的包装层。Mik Chambers 在 .NET 中有一个[命令代理](http://www.mikechambers.com/blog/2008/01/17/commandproxy-net-air-integration-proof-of-concept/)的概念证明，您可以将其用作基础。

如果您使用后者，您将需要的 .NET 类/方法是[Process.Start](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.start.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-19T14:08:42.107

使用 AIR 2，您可以使用 Native Process API 来完成此操作

# latex - 如何增加 LaTeX 中两个表格之间的空间？

> ID：411217
> 
> 赞同：14
> 
> 时间：2009-01-04T16:30:08.023
> 
> 标签：latex

我对 LaTeX 完全陌生，我想做的事情就是逃避我。下面，我有两个并排出现的表的代码（这是我想要的）。但是它们非常靠近，我希望在两张桌子之间留出一英寸的距离。我将如何实现这种效果？

```
 \begin{center}
      \begin{tabular}[t]{ c | c }
       $n$ &$f(n)$ \\ \hline
       1 & 6 \\
       2 & 7 \\
       3 & 6 \\
       4 & 7 \\
       5 & 6 \\
      \end{tabular}
      \begin{tabular}[t]{ c | c c c c c}
       $g$ &  6 &  7 &  8 &  9 & 10  \\ \hline
       1   & 10 & 10 & 10 & 10 & 10  \\
       2   &  7 &  8 &  9 & 10 &  6  \\    
       3   &  7 &  7 &  8 &  8 &  9  \\   
       4   &  9 &  8 &  7 &  6 & 10  \\   
       5   &  6 &  6 &  6 &  6 &  6  \\   
      \end{tabular}
     \end{center} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-04T16:34:47.827

您可以`\hspace{2em}`在表格之间插入。如果您想要更多或更少的空间，请更改该值。

# c++ - 哈德森、C++ 和 UnitTest++

> ID：411218
> 
> 赞同：22
> 
> 时间：2009-01-04T16:30:18.290
> 
> 标签：c++, unit-testing, continuous-integration, hudson, jenkins

有没有人将[Hudson用作使用](http://hudson.dev.java.net/)[UnitTest++](http://unittest-cpp.sourceforge.net/)作为测试库的 C++ 项目的持续集成服务器？

你到底是怎么设置的？

我知道之前有几个关于持续集成的问题，但我希望这个问题的范围更窄。

编辑：我会澄清一下我在寻找什么。当单元测试失败时，我已经将构建设置失败。我正在寻找像 Hudson 的 JUnit 支持这样的东西。UnitTest++ 可以创建 XML 报告（参见[此处](http://www.alittlemadness.com/2007/01/10/unittest-reports/)）。所以，也许如果有人知道如何将这些报告翻译成与 JUnit 兼容，Hudson 就会知道如何吃掉它？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-05T14:48:15.733

我们正在我的工作场所积极地这样做。

目前，我们使用自由风格的软件项目来：

*   每 15 分钟检查一次我们的 Subversion 存储库以获取更新
*   调用 Windows 批处理文件来清理和构建解决方案文件
    *   项目文件作为构建后事件构建和运行单元测试
    *   单元测试失败由测试返回`main()`，因此被视为构建错误

我还测试了使用 UnitTest++ 中包含的 XmlTestReporter 生成输出文件的配置。[xUnit 插件](http://wiki.hudson-ci.org/display/HUDSON/xUnit+Plugin)本机支持此输出以及您可以转换的任何其他输出，尽管我必须更改版本 0.1.3 中随附的 XSL 文件以获取测试历史记录中记录的持续时间。

关于我们的集成，我们有很多地方想要改进；构建日志很长且难以解析，没有着色或突出显示等，但到目前为止它仍然对我们有益。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-12-16T14:26:11.317

正如 Patrick Johnmeyer 在接受的答案中建议的那样，我检查了[xUnit插件。](http://wiki.hudson-ci.org/display/HUDSON/xUnit+Plugin)为了完整起见，这里是驱动程序代码：

```
#include <fstream>
#include "UnitTest++.h"
#include "XmlTestReporter.h"

int main( int argc, char *argc[] ) {
    std::ofstream f("file.xml");
    UnitTest::XmlTestReporter reporter(f);
    return UnitTest::RunAllTests(reporter, UnitTest::Test::GetTestList(), NULL, 0);
} 
```

在 Hudson 配置中，勾选“Publish testing tools result report”并指向`"file.xml"`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-30T22:13:32.863

Hudson 现在有一个[CppUnit 插件](http://wiki.hudson-ci.org/display/HUDSON/CppUnit+Plugin)可以解决问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-07T09:49:59.517

早在我开始使用 Hudson 之前，我就参与了一个 C++ 项目，我们使用了 cpp-unit-lite 和 CruiseControl

我们更改了 Cpp-unit-lite 以生成类似 JUnit 的 XML 报告文件，并且 CruiseControl 获取了 XML 报告文件。

您可以对 UnitTest++ 执行相同的操作，Hudson 将获取报告文件。

但是，这似乎需要做很多工作。看看 Hudson 的绘图插件。您可以让脚本从 UnitTest++ 输出中提取失败/通过测试的数量，并使用 plot 插件绘制每个构建的通过/失败测试的简单图表。

不如内置的单元测试报告好，但您可以快速开始工作。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-31T14:20:29.617

我将 hudson 与 CppUnit 和 xml 输出一起使用。xml 由 xslt 转换为类似的 JUnit 输出。CppUnit 站点提供了一个将 CppUnit 输出转换为 JUnit 输出的 xslt。为了获得更多详细信息，我对其进行了一些修改，例如：

*   命名空间作为包
*   执行时间处理时间

您可以转换您的 xml 输出以获得以下内容：

```
<?xml version="1.0" encoding="UTF-8"?>
<testsuite>
   <testcase name="my test name"
             classname="Package1.Package2.TestClass"
             time="0.25">
      <error type="error"/>
   </testcase>
   ....
</testsuite> 
```

如果成功：只需删除子标签

问候

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-05T19:08:23.103

我们在我的办公室一直在使用类似的方法，除了使用 cxxtest 而不是 UnitTest++，现在我们正在迁移到谷歌非常优秀的 (imho) gtest 框架。

对于 cxxtest，我们做了类似于 Patrick J. 建议的事情，基本上是添加一个构建步骤，该步骤将通过 ant 运行测试套件程序，并在任何测试失败时导致构建失败。这种方法的缺点是当构建由于测试结果而失败时，您必须通过控制台输出来找出问题所在。如果您的测试框架可以输出与 junit 兼容的 XML，那么您也会失去 hudson 可以生成的漂亮图表。

切换到 gtest 的动机之一是它确实生成 junit XML，因此理论上，hudson 可以解析测试结果并以更明智的方式发布它们。无论如何，它看起来不像 UnitTest++ 生成这样的东西（如果我错了，请纠正我），所以这可能是一个有争议的问题，但至少将它集成到你的构建过程中将确保测试在运行期间运行构建。

# f# - 在 F# 中将浮点数转换为 int

> ID：411221
> 
> 赞同：10
> 
> 时间：2009-01-04T16:31:59.300
> 
> 标签：f#

有人可以解释为什么`int (0.4 * 10.0)`还`4`没有吗？`int ((2.4 - 2.0) * 10.0)``3`

然后还请说明如何获取`4`。即我真的必须这样做`int (System.Math.Round((2.4 - 2.0) * 10.0))`吗？

对于应该如此简单的事情来说，它是如此丑陋。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-04T16:45:34.873

2.4 - 2.0 的双重表示是 0.399999999999。当您将数字转换为 int 时，小数部分被截断，因此 3.999999999 被截断为 3。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-05T14:21:12.933

实际上，在 .Net 中有一种`decimal`数据类型可以帮助您解决这个问题，如果您的数字可以精确地表示为小数部分。

```
2.4m - 2.0m == 0.4m
2.4 - 2.0   != 0.4 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-10-19T18:05:45.930

将`float`数字转换为`int`用途：

`let i = Convert.ToInt32(f)`

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-05T14:14:42.710

> 然后还请解释如何获得 4。即我真的必须做吗
> 
> int (System.Math.Round((2.4 - 2.0) * 10.0))
> 
> 对于应该如此简单的事情来说，它是如此丑陋。

当然不是，只要定义

```
let round x = int System.Math.Round(x) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-04T16:52:34.407

浮点数不是无限精度的。有些数字可以完美表示（任何涉及 2 的幂，例如 1、1/2 = 0.5、1/4 = 0.25 等），而其他数字则不能（例如 1/3 不能精确分解为有限序列二的幂）。通常，截断无限级数的末端会导致数字的编码版本略小于其真实值。

将此与 (int) 运算符截断而不是舍入这一事实相结合，您可能会遇到*应*产生 4.0 的操作导致 3.999999999991 变为 3 的情况。

每当您尝试将浮点数/双精度数转换为整数时，您都需要仔细考虑要使用哪个运算符——截断（向下舍入）、向上舍入或最近舍入。

由于这是浮点表示的问题，因此不仅在 F# 中如此，在 C# 和 (IIRC) Java 和其他语言中也是如此。

# sql - A source to learn database design

> ID：411222
> 
> 赞同：2
> 
> 时间：2009-01-04T16:32:05.727
> 
> 标签：sql, database-design

I am looking to make a website and in the future desktop apps as well and i know nothing about db design so what tutorials or books (online preferably) are there? thanks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-04T18:32:12.020

The T. Connolly 's [book](http://www.nhbs.com/database_systems_tefno_161037.html) is one of the best I've read so far.

> Database Systems : A Practical Approach to Design, Implementation and Management

Easy to pick up and cover a lot of topics.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-04T16:42:13.460

The [introduction to normalization](http://dev.mysql.com/tech-resources/articles/intro-to-normalization.html) in the MySQL manual is very good. There's also a list of resources at the end of the article.

# css - 尽管我对其进行了编码，但页脚并没有粘在底部

> ID：411228
> 
> 赞同：2
> 
> 时间：2009-01-04T16:36:32.910
> 
> 标签：css, footer, sticky-footer

*我暂时删除了页脚，网站必须上线。所以链接也消失了。*

如您所见（在 FF2 和 IE7 中）页脚位于屏幕底部，但不在页面底部（内容）。

我的代码中有这个：

```
<div id="wrap">
    <div id="top"></div>
    <div id="content"></div>
    <div id="footer"></div>
</div> 
```

这在css中：

```
html {
    height: 100%;
    margin: 0;
    padding: 0;
}
body {
    height: 100%;
    margin: 0;
    padding: 0;
    padding-bottom: 30px;  /* height of the footer */
}
#wrap {
    margin-left: auto;
    margin-right: auto;
    width: 960px; 
    min-height: 100%;
    position: relative; 
}
*#wrap {            /* IE hack */
height:100%;
}
#footer {
    position: absolute;
    bottom: 0;
    width: 100%;
    height: 30px;
    padding: 0;
    margin: 0;
} 
```

或者，长话短说：我按照[此处](http://matthewjamestaylor.com/blog/keeping-footers-at-the-bottom-of-the-page)给出的说明进行操作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-04T17:09:50.893

您没有足够仔细地遵循您的指示。[马修布局](http://matthewjamestaylor.com/blog/keeping-footers-at-the-bottom-of-the-page)的关键

```
<div id="container">
   <div id="header"></div>
   <div id="body"></div>
   <div id="footer"></div>
</div> 
```

是容器有位置：相对而页脚有位置：绝对。这将一个放在另一个里面。请注意，容器通过保留页脚大小的 padding-bottom 为页脚保留空间。因此，布局仅在页脚高度固定时才有效。

使用botttom:0 绝对定位的元素将把自己放在最近的相对定位的父元素的底部。如果没有，则使用视口，这就是您的布局中发生的情况。

您的页脚 div 不是您的 wrap div 的孩子。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-04T16:48:00.860

[这个](http://ryanfait.com/sticky-footer/)怎么样？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-04T16:55:40.483

将填充从主体底部移动到#wrap 的底部。由于该填充，您的页脚始终距离“页面”底部 30 像素。通过将其放在#wrap 上，您将防止#wrap 的内容出现在您的页脚后面。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-05T12:45:12.923

对，所以 #size 在 100% 以内，去掉包装上的填充并将以下内容添加到 #content

```
overflow:auto;
padding-bottom:30px; 
```

那么你的链接在FF中对我有用

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-04T16:55:19.533

```
 <style type="text/css">
html {
    height: 100%;
    margin: 0;
    padding: 0;
}
body {
    height: 100%;
    margin: 0;
    padding: 0;
}
#wrap {
    margin-left: auto;
    margin-right: auto;
    width: 960px; 
    position: relative; 
}
*#wrap {            /* IE hack */
height:100%;
}
#footer {
    position: absolute;
    bottom: 0;
    width: 100%;
    height: 30px;
    padding: 0;
}
</style>
<div id="wrap">
    <div id="top"></div>
    <div id="content"></div>
    <div id="footer"></div>
</div> 
```

这对我有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-04T18:25:33.860

IMO，IE star hack 导致了这个问题。尝试使用以下命令更改 IE hack：

```
*html #wrap {
    ...
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-04T20:10:25.880

这件事肯定有别的原因，上面描述的每种方法都适用于不同的网站，只是不适用于我的网站。

这是我的页面源，不相关的东西被剥离（内容和东西）：

```
<body>
    <div id="size"> javascript textsize modifier</div>
    <div id="wrap">

        <div id="top"> logoimage
            <div id="menu">
                <div id="menuwrapper">
                    <ul id="primary-nav">
                        <li> Homelink </li>
                        <li class="menuactive menuparent" class="over"> Link 2
                            <ul>
                                <li> Sublink 1 </li>
                                <!-- etcetera //-->
                            </ul>
                        </li>
                        <li class="menuparent" class="over"> Active Link 3
                            <ul>
                                <li> Sublink 1</li>
                                <!-- etcetera //-->
                            </ul>
                        </li>
                    </ul>
                </div> <!-- end menuwrapper //-->
            </div> <!-- end menu //-->
        </div> <!-- end top //-->

        <div id="content">
            <div id="newssnippet"></div>
            <div id="roundedright"> <!-- rounded corners //-->
                <!-- 6 divs to create rounded corners //-->
                <div id="right">Random main content</div>
                <!-- 7 divs to create rounded corners //-->
            </div> <!-- end rounded corners //-->

            <div id="logo">Another logo</div>

            <div id="roundedleft"> <!-- rounded corners again //-->
                <!-- 6 divs to create rounded corners //-->
                <div id="left">News content</div> 
                <!-- 7 divs to create rounded corners //-->
            </div>  <!-- end rounded corners //-->
        </div> <!-- end content //-->

        <div id="footer"></div>

    </div><!-- end wrap //-->
</body> 
```

显然，我是按照[开篇链接中](http://matthewjamestaylor.com/blog/keeping-footers-at-the-bottom-of-the-page)的规定布局进行的。

然后在CSS中，我有：

```
html {
    height: 100%;
    margin: 0;
    padding: 0;
} 
body {
    background: #e7e7e7 url(images/cms/background.jpg) repeat-x;
    font-family: Verdana, Arial, sans-serif;
    font-size: .8em;
    height: 100%;
    margin: 0;
    padding: 0;
    padding-bottom: 30px;
}
#wrap {
    margin-left: auto;
    margin-right: auto;
    width: 960px; 
    position: relative; 
    min-height:100%;
}
*html #wrap {     /* IE hack */
    height:100%;
}
#footer {
    position: absolute;
    bottom: 0;
    width: 100%;
    height: 30px;
    background: transparent url(images/cms/footer.png) no-repeat bottom center;
    padding: 0;
}
#footer p {
    margin: 0;
    padding: 0;
    padding-top: .7em;
    text-align: center;
}
#footer a {
    text-decoration: none;
} 
```

这应该是每一个相关的位......

我错过了什么？

记录：如果内容低于 100% 高，页脚将在正确的位置粘在 oage 的底部。所以，如果它没有填满屏幕。
如果内容超过页面的 100%，页脚位于内容的一半，所以当我必须滚动查看所有内容时。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-06T13:39:43.203

这个网站有一个很好的演示技术：[http ://www.themaninblue.com/experiment/footerStickAlt/](http://www.themaninblue.com/experiment/footerStickAlt/)

# c# - 比较两个对象。

> ID：411232
> 
> 赞同：14
> 
> 时间：2009-01-04T16:37:25.013
> 
> 标签：c#

如果我有一个复杂的对象，编写代码来比较 2 个实例以查看它们是否相同的最佳实践模式是什么

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-04T16:39:40.953

实现 IEquatable 接口。这定义了一个通用方法，值类型或类实现该方法以创建用于确定实例相等性的特定于类型的方法。不要忘记也覆盖 Equals(object) 。更多信息在这里：

[http://msdn.microsoft.com/en-us/library/ms131187.aspx](http://msdn.microsoft.com/en-us/library/ms131187.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-04T16:52:25.453

我认为答案是高度依赖问题的。例如，您可能希望仅当对象的所有属性都相等时才认为对象相等。这可能是每个对象没有唯一标识属性的情况。如果有这样一个（或多个）属性（例如 ID 或 ID 和版本）唯一标识该类型的每个对象，那么您可能只想基于该属性（或多个属性）进行比较。

然而，基本模式应该是这样的：

```
if their references are equal (includes both null)
   return true
else if one object is null
   return false
else
   return value based on relevant properties 
```

请注意，如果您覆盖 Equals 运算符，您还需要覆盖 GetHashCode() 以便等效对象的哈希码相同。这将确保使用哈希码确定重复键的数据结构在对象用作键时正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-04T16:55:45.290

既然你提到了一个复杂对象，请确保复杂对象中的所有复合对象都实现了 tvanfosson 提到的 equals(Object)。最后利用所有复合对象的等号在复杂对象中实现等号

# php - problem with php script in 1and 1 hosting

> ID：411237
> 
> 赞同：0
> 
> 时间：2009-01-04T16:39:56.070
> 
> 标签：php

I have a problem.

I have wrote an upload form on my html page. Then created an upload php file. I added both to my webserver 1 and 1\. when clicking on the script on the live webpage - it starts uploading, however the domain name/upload.php file sits there with nothing there (blank) when i check the destination folder nothing is there.

any gurus willing to help with this - i'm baffled - its my first time dabbling with php?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-04T17:45:37.123

Have you checked that your `<form>` tag has `enctype="multipart/form-data"`?

Posting your source code would help you get better answers.

Also, in upload.php, try doing `print_r($_FILES);` to output the list of files.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-04T19:04:13.673

Try some more error-checking. Have a look at this IBM tutorial on [Debugging techniques for PHP programmers.](http://www.ibm.com/developerworks/library/os-debug/) Some of the suggestions work only in an IDE, but there is a good deal on debugging using print statements (simple, yet effective).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-04T17:54:29.803

Question is kind of vague, but most of the time these problems occur because of wrong folder permissions.

Try to chmod 666 on the folder you are writing to.

# subsonic - .netTiers 与 SubSonic

> ID：411238
> 
> 赞同：1
> 
> 时间：2009-01-04T16:40:09.703
> 
> 标签：subsonic, .nettiers

今天下午我有一些时间来比较 netTiers 和 SubSonic。

我使用了使用 SubStage（SubSonic 2.1 版本的一部分）生成的代码，并使用 RepositoryRecord 作为我的基类。

我使用 .netTiers 2.2 生成的代码对同一个数据库进行了相同的测试

该测试是 Rob Conery 在他的帖子中使用的测试的衍生产品：

[http://blog.wekeroad.com/blog/subsonic-scaling/](http://blog.wekeroad.com/blog/subsonic-scaling/)

当我说导数时，我的意思是我刚刚将 100,000 条记录写入数据库。

我在同一台 PC 上重复了每个测试三遍。

我发现 .netTiers 在 90 秒内完成了任务。

亚音速在 104 秒内完成。

与这些平均值的偏差不超过一秒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-04T18:20:42.327

也不确定这是否是一个问题，但如果您打算在这 2 种产品之间找到一些较大的性能差异，那么似乎没有太多。所以我会选择任何为我手头的任务提供最佳功能的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-04T16:42:38.250

这是一个问题吗？:)

只要您避开“深层”方法，并使用自定义存储过程的司法使用，我一直发现 netTiers 的性能很好。

# keyboard-shortcuts - 如何在 IntelliJ IDEA 中选择骆驼化单词的单个单词

> ID：411240
> 
> 赞同：94
> 
> 时间：2009-01-04T16:41:21.480
> 
> 标签：keyboard-shortcuts, intellij-idea

IntelliJ IDEA 中移动或选择骆驼化单词的单个单词的快捷方式是什么？假设我有一个 LongMultiWordVariableName，我希望能够将光标移动到每个单词以进行编辑或选择变量的一部分。

Eclipse 有一个快捷方式来执行此操作，+ `Ctrl`/`←`用于`→`移动，`Ctrl`++ /用于选择。`Shift``←``→`

* * *

## 回答 #1

> 赞同：189
> 
> 时间：2009-01-05T01:39:56.900

IDEA 与 Eclipse 的驼峰式单词有相同的击键，但你必须打开 CamelHumps 选项（它在 Settings -> Editor -> General -> Smart Keys -> Use "CamelHumps" words ）

* * *

## 回答 #2

> 赞同：121
> 
> 时间：2009-01-09T12:54:04.813

是的，yalestar 的答案是正确的。设置 > 编辑器 > 智能键 > 使用“CamelHumps”字样

但是，这里有一些有用的信息：如果您希望能够通过双击来选择整个单词，请在“设置”>“编辑器”中取消选择“双击时选择“荣誉 'CamelHumps' 单词设置”。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2019-09-30T16:32:14.540

最新版本的 Android Studio 中有一个快捷方式。您只需点击“ **Shift** ”键两次（双击），然后在搜索中输入“camelhum”，然后该选项就会出现，您可以打开/关闭它。我附上了一张图片供参考。[![在此处输入图像描述](https://i.stack.imgur.com/HFfjV.jpg)](https://i.stack.imgur.com/HFfjV.jpg)

# ruby - How do I pass/get command line parameters?

> ID：411246
> 
> 赞同：3
> 
> 时间：2009-01-04T16:43:50.790
> 
> 标签：ruby, parameters, shoes

I am trying to use Shoes and I need to pass it command-line parameters (basically, my Shoes app will be called from another pre-existing app and this would allow me to pre-fill some parts of shoes). Should I then call it using bin/shoes wrapper?

It seems I can not pass arguments to shoes wrapper (it concatenates all parameters and tries to use the result as a script path name). And I can't seem to be able to access ARGV array.

```
 Juraj. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-09T06:34:53.450

代码示例

```
Shoes.app do
  para "program: #{ARGV[0]}\n"
  para "arg1: #{ARGV[1]}\n"
  para "arg2: #{ARGV[2]}\n"
end 
```

从包装器调用时为我工作`shoes.run`。例如，如果我`./shoes.run test.app foo bar`在命令行上运行，它会显示：

```
program: test.app
arg1: foo
arg2: bar 
```

为了我。也许您的连接行为与您如何调用 Shoes 相关，而不是与 Shoes 包装器本身有关？

`shoes`此外，如果我在打开所有东西后运行，这同样适用于我。此外，您可以运行

```
shoes test.app -- foo bar 
```

以确保应用程序获取参数而不是鞋子可执行文件。

# scripting - 在静默模式下运行 CMD 或 BAT

> ID：411247
> 
> 赞同：51
> 
> 时间：2009-01-04T16:45:34.357
> 
> 标签：scripting, cmd, batch-file

如何在静默模式下运行 CMD 或 .bat 文件？我希望阻止向用户显示 CMD 界面。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-01-04T16:57:41.993

包括以下短语：

```
@echo off 
```

就在你的 bat 脚本的顶部。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-01-04T16:57:52.367

我在 StackOverflow 问题中提出了一种[在后台运行批处理文件的方法（**不显示 DOS 窗口**）](https://stackoverflow.com/questions/298562)

那应该回答你的问题。

这里是：

* * *

从您的第一个脚本中，使用以下行调用您的第二个脚本：

```
wscript.exe invis.vbs run.bat %* 
```

实际上，您正在调用一个 vbs 脚本：

*   你的脚本的 [path]\name
*   脚本所需的所有其他参数 ( `%*`)

然后，invis.vbs 将使用[Windows Script Host Run() 方法](http://msdn.microsoft.com/en-us/library/d5fk67ky(VS.85).aspx)调用您的脚本，该方法需要：

*   intWindowStyle : 0 表示“不可见的窗口”
*   bWaitOnReturn : false 表示您的第一个脚本不需要等待您的第二个脚本完成

请参阅完整的 invis.vbs 脚本的问题：

```
Set WshShell = WScript.CreateObject("WScript.Shell")
WshShell.Run """" & WScript.Arguments(0) & """" & sargs, 0, False
                                                         ^
                             means "invisible window" ---| 
```

* * *

Tammen 反馈后更新：

如果您在 DOS 会话中并且想要“在后台”启动另一个脚本，那么一个简单的（如[前面提到的同一个问题](https://stackoverflow.com/questions/298562)`/b`中所详述）就足够了：

> 您可以使用**`start /b second.bat`**从您的第一个文件异步启动第二个批处理文件，该文件共享您的第一个窗口。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2014-01-15T06:18:26.733

我认为这是在不打开 DOS 窗口的情况下运行批处理文件的最简单和最短的解决方案，当您想要安排一组命令定期运行时，它可能会非常分散注意力，因此 DOS 窗口不断弹出，这是您的解决方案. 使用 VBS 脚本调用批处理文件...

```
Set WshShell = CreateObject("WScript.Shell" ) 
WshShell.Run chr(34) & "C:\Batch Files\ mycommands.bat" & Chr(34), 0 
Set WshShell = Nothing 
```

将上面的行复制到编辑器并使用 .VBS 扩展名保存文件。相应地编辑 .BAT 文件名和路径。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-11-15T18:26:14.153

[使用来自http://www.battoexeconverter.com](http://www.battoexeconverter.com)的 Advanced BAT to EXE 转换器

这将允许您将任何其他二进制文件与您的批处理文件嵌入到一个独立的完全无声的 EXE 及其免费软件中

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-04-15T07:00:35.173

使用 Bat To Exe 转换器来执行此操作

[http://download.cnet.com/Bat-To-Exe-Converter/3000-2069_4-10555897.html](http://download.cnet.com/Bat-To-Exe-Converter/3000-2069_4-10555897.html)
（选择**直接下载链接**）

1 - 打开 Bat to Exe Converter，选择您的 Bat 文件。
2 - 在选项菜单中选择“不可见的应用程序”，然后按编译按钮。

完毕！

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2011-02-06T13:27:22.347

尝试**[SilentCMD](http://www.stephan-brenner.com/?page_id=345)**。这是一个小型免费软件程序，它执行批处理文件而不显示命令提示符窗口。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-11-26T22:29:13.537

如果我想在静默模式下运行命令提示符，那么有一个简单的 vbs 命令：

```
Set ws=CreateObject("WScript.Shell")
ws.Run "TASKKILL.exe /F /IM iexplore.exe" 
```

如果我想**在 cmd 中静默打开一个 url**，那么这里是一个代码：

```
Set WshShell = WScript.CreateObject("WScript.Shell") 
Return = WshShell.Run("iexplore.exe http://otaxi.ge/log/index.php", 0)
'wait 10 seconds
WScript.sleep 10000 
Set ws=CreateObject("WScript.Shell")
ws.Run "TASKKILL.exe /F /IM iexplore.exe" 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-12-25T03:26:42.030

我很有信心我最喜欢这种方法。将以下代码复制并粘贴到 .vbs 文件中。从那里您将调用批处理文件...因此请确保您编辑最后一行以指定批处理文件的路径和名称（其中应包含您要启动的文件或执行您需要执行的操作）

```
Const HIDDEN_WINDOW = 12 

strComputer = "." 
Set objWMIService = GetObject("winmgmts:" _ 
& "{impersonationLevel=impersonate}!\\" & strComputer & "\root\cimv2") 
Set objStartup = objWMIService.Get("Win32_ProcessStartup") 

Set objConfig = objStartup.SpawnInstance_ 
objConfig.ShowWindow = HIDDEN_WINDOW 
Set objProcess = GetObject("winmgmts:root\cimv2:Win32_Process") 
errReturn = objProcess.Create("C:\PathOfFile\name.bat", null, objConfig, intProcessID) 
```

它肯定对我有用。欢迎评论：）

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-10-13T17:01:07.400

另一种方法，没有 3rd 方程序或转换器（“批处理到 exe”程序实际上只是将您的批处理文件放在 tmp 文件夹中，然后静默运行，因此任何人都可以从那里获取它并获取您的代码）没有 vbs 文件（因为没有人知道vbs）批处理文件开头只有一行。

```
@echo off > NUL 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-09-27T21:32:49.217

下面的无声 .bat 文件代码可防止需要两个 bat 文件（使用“goto”和“:”）。

它在同一个 .bat 文件中完成所有操作。**经过测试并确认在 Windows 10 中工作**

***确保将“C:\pathToFile\ThisBatFile.bat”替换为同一个 .bat 文件的路径！保留“.bat”后的空格。***

```
@echo off
if [%1]==[] (
    goto PreSilentCall
) else (
    goto SilentCall
)

:PreSilentCall
REM Insert code here you want to have happen BEFORE this same .bat file is called silently
REM such as setting paths like the below two lines

set WorkingDirWithSlash=%~dp0
set WorkingDirectory=%WorkingDirWithSlash:~0,-1%

REM below code will run this same file silently, but will go to the SilentCall section
cd C:\Windows\System32
if exist C:\Windows\Temp\invis.vbs ( del C:\Windows\Temp\invis.vbs /f /q )
echo CreateObject("Wscript.Shell").Run "C:\pathToFile\ThisBatFile.bat " ^& WScript.Arguments(0), 0, False > C:\Windows\Temp\invis.vbs
wscript.exe C:\Windows\Temp\invis.vbs Initialized
if %ERRORLEVEL%==0 (
    echo Successfully started SilentCall code. This command prompt can now be exited.
    goto Exit
)

:SilentCall
cd %WorkingDirectory%
REM Insert code you want to be done silently. 
REM Make sure this section has no errors as you won't be able to tell if there are any, 
REM since it will be running silently. You can add a greater than symbol at the end of
REM your commands in this section to output the results to a .txt file for the purpose 
REM of debugging this section of code.

:Exit 
```

如果您的 .bat 文件需要的**不仅仅是**“Initialized”参数（它告诉 bat 文件转到 :SilentCall 部分），请添加“ **^& WScript.Arguments(1)、** ”、“ **^& WScript.Arguments(2) ,** " 等 根据参数的数量，然后编辑调用 wscript.exe 的行：

“wscript.exe C:\Windows\Temp\invis.vbs 初始化**BatFileArgOne** **BatFileArgTwo** ”

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-06-21T08:19:42.533

我创建了[RunApp](https://github.com/futurist/runapp)来完成这样的工作，并在我的生产环境中使用它，希望它有所帮助。

如下配置：

**文件：config.arg**

```
:style:hidden

MyBatchFile.bat
arg1
arg2 
```

`runapp.exe`而是启动。

# c - C 的编码风格检查器

> ID：411249
> 
> 赞同：22
> 
> 时间：2009-01-04T16:46:06.790
> 
> 标签：c, coding-style

我在一家拥有严格编码风格准则但没有自动工具来验证它们的公司工作。我环顾四周，我能找到的唯一工具是类似于 lint 的工具，它们似乎旨在验证代码的功能，防止错误，而不是确保编码风格正确。

如果有的话，我们应该使用什么工具？

注意：我正在寻找适用于 C 代码的东西，尽管适用于 C++ 的东西也会很好。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-04T21:24:37.290

传统的美化[缩进](http://en.wikipedia.org/wiki/Indent_(Unix))，在每台 Unix 机器上都可用。在某些机器上找到的版本是[GNU indent](http://www.gnu.org/software/indent/)，可以在每台机器上编译和安装。GNU indent 可以从文件中读取一组规则`~/.indent.pro`，例如：

```
--original --dont-format-first-column-comments --no-blank-lines-after-commas --parameter-indentation 8 --indent-level 8 --line-length 85 --no-space-after-parentheses --no-comment-delimiters-on-blank-lines 
```

因此，在提交之前运行 indent 可以保证呈现的一致性。如果您想**强制执行**，请在您使用的版本控制系统中定义一个预提交挂钩，如果提交的版本与缩进产生的版本不同，它将运行缩进并拒绝提交。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-04T16:54:24.060

您正在寻找“[代码美化](http://google.com/search?q=c+code+beautifier)器”。[Uncrustify](http://uncrustify.sourceforge.net/)是免费的。

您只需能够在其配置文件中描述您的编码风格，它将确保每个文件都符合所描述的风格。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-04T17:23:28.103

[AStyle](http://astyle.sourceforge.net/)做你想做的事：

> Artistic Style 是用于 C、C++、C# 和 Java 编程语言的源代码缩进器、格式化器和美化器。

有一个适用于 Eclipse的[AStyle 插件。](http://astyleclipse.sourceforge.net/)

Eclipse 也有一个代码格式化程序，但我不确定它是否适用于 CDT。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-04T17:13:57.390

有（或曾经）有很多工具可以做到这一点。最古老的一个是`cb`（C Beautifier），它出现在古代 Unix 版本中——在这种情况下，意味着版本 7 Unix：

```
CB ( 1 ) UNIX Programmer’s Manual CB ( 1 )

NAME
    cb – C program beautifier
SYNOPSIS
    cb
DESCRIPTION
   Cb places a copy of the C program from the standard input on the standard
   output with spacing and indentation that displays the structure of the
   program.
BUGS 
```

GNU`indent`是一个更加复杂和可配置的野兽。也有商业工具。例如，[Abraxas Software](http://www.abxsoft.com/)提供了一个 CodeCheck 工具，例如；我们在 90 年代中期曾短暂使用过它，但它希望我们做出的改变（非常必要，但）对管理来说太麻烦了。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-02-11T08:00:30.473

来自类似的问题：[Vera++](https://bitbucket.org/verateam/vera/wiki/Home)：

> Vera++ 是一个用于验证、分析和转换 C++ 源代码的可编程工具。
> 
> Vera++ 预计的主要使用场景有：
> 
> 确保源代码符合给定的编码标准和约定。
> 
> 提供源代码指标和统计数据。
> 
> 执行源代码的自动转换，范围从漂亮的打印到诊断，再到故障注入和高级测试。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-09-17T08:11:04.880

您可以使用`clang-format`. 更多信息可以在官方网站上找到： http: [//clang.llvm.org/docs/ClangFormat.html](http://clang.llvm.org/docs/ClangFormat.html)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-04T17:10:45.320

我反对在这里使用正式的工具。编码标准的最佳执行是同侪压力。团队成员之间的同侪压力和相互尊重是团队建设环境的关键要素......与有人无意中“破坏构建”时所必需的善意骚扰没有什么不同，等等。

审查新团队成员的代码是学习过程中的关键部分，融入团队和学习编码标准等。如果编码标准太复杂或微妙而无法通过这种方式学习，那么不要寻找验证标准的工具，您应该寻找新的编码标准。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-05-20T04:13:50.070

试试[UniversalIndentGUI](http://universalindent.sourceforge.net/)，它是一个围绕流行的缩进器/美化器的 GUI 包装器，例如 Uncrustify、Artistic Style 和 GNU Indent。它的 GUI 和实时预览功能使尝试不同的压头变得非常容易，一旦你找到了你喜欢的压头和配置，你可以导出配置甚至导出一个 shell 脚本。如果你还在尝试，那就太好了。

* * *

## 回答 #9

> 赞同：-8
> 
> 时间：2010-02-11T10:09:29.763

请使用 VIM 并享受轻松。你可以通过简单的命令来做任何与源代码编程相关的事情。您还可以通过编辑 .vimrc 文件使 VIM 更加可靠和强大。它的帮助会对你有很大帮助。

/伦吉特克

# java - PHP和Java有什么区别？

> ID：411254
> 
> 赞同：23
> 
> 时间：2009-01-04T16:48:19.423
> 
> 标签：java, php

精通 PHP 但学习 Java 的人应该知道的 PHP 和 Java 之间的主要区别是什么？

**编辑：**我的意思是语言语法的差异，即它们的数据类型，它们如何处理数组和引用变量等等:)

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-01-04T20:44:48.667

不是一个详尽的列表，我是一名 PHP 开发人员，不久前曾参观过 Java，所以 Caveat Emptor。

Java 中的每个变量都需要在前面加上一个数据类型。这包括基本类型，如 boolean、int、double 和 char，以及 Object 数据类型，如 ArrayList、String 和您自己的对象

```
int  foo    = 36;
char bar    = 'b';
double baz  = 3.14;
String speech = "We hold these truths ...";
MyWidget widget = new MyWidget(foo,bar,baz,speech); 
```

* * *

每个变量只能保存其类型的值。使用上述声明，以下是无效的

```
foo = baz 
```

* * *

对象上的平等（而不是原始类型）检查对象身份。所以以下不直观的打印错误。字符串有一个相等的方法来处理这个。

```
//see comments for more information on what happens 
//if you use this syntax to declare your strings
//String v1 = "foo";
//String v2 = "foo";

String v1 = new String("foo");
String v2 = new String("foo");

if(v1 == v2){
    println("True");
}
else{
    println("False");
} 
```

* * *

数组是您的经典 C 数组。只能保存一种特定类型的变量，需要以固定长度创建

* * *

为了解决这个问题，有一系列集合对象，其中一个名为 ArrayList，它的行为更像 PHP 数组（尽管持有一种类型的业务仍然如此）。您不会像语法那样获得数组，所有操作都是通过方法完成的

```
//creates an array list of strings
ArrayList<String> myArr = new ArrayList<String>();
myArr.add("My First Item"); 
```

ArrayLists 仍然有数字键。还有另一个名为 HashMap 的集合，它将为您提供一个字典（或关联数组，如果您在 90 年代上学），如对象。

* * *

ArrayLists 和其他集合是用称为泛型（<String>）的东西实现的。我不是 Java 程序员，所以我对泛型的了解只是它们描述了对象将操作的事物的类型。那里还有很多事情要做。

* * *

Java没有指针。但是，所有对象实际上都是引用，类似于 PHP 5，与 PHP 4 不同。我**认为**Java 没有（折旧的）PHP &reference &syntax。

* * *

Java中所有的方法参数都是按值传递的。但是，由于所有对象实际上都是引用，因此您在传递对象时传递了引用的值。这意味着如果您操作传递给方法的对象，则操作将保持不变。但是，如果您尝试这样的事情，您将不会得到您期望的结果

```
public void swapThatWontWork(String v1, String v2)
{
  String temp = var1;
  var1 = var2;
  var2 = temp;
} 
```

* * *

现在是提到方法需要指定其返回类型的好时机，如果方法返回不应该返回的东西，就会发生不好的事情。以下方法返回一个 int

```
public int fooBarBax(int v1){
} 
```

* * *

如果一个方法要抛出一个异常，你必须这样声明它，否则编译器不会与它有任何关系。

```
public int fooBarBax(int v1) throws SomeException,AnotherException{
   ...
} 
```

如果您使用未在方法中编写的可能引发异常的对象，这可能会变得很棘手。

* * *

您在 Java 中的主要代码入口点将是一个类的方法，而不是 PHP 的主要全局入口点

* * *

Java 中的变量名不以符号 ($) 开头，尽管我认为如果您希望它们可以

* * *

Java 中的类名区分大小写。

* * *

字符串在 Java 中是不可变的，因此连接可能是一项昂贵的操作。

* * *

Java 类库提供了一种实现线程的机制。PHP 没有这样的机制。

* * *

PHP 方法（和函数）允许您使用可选参数。在java中，您需要为每个可能的参数列表定义一个单独的方法

```
public function inPHP($var1, $var2='foo'){}

public void function inJava($var1){
    $var2 = "foo";
    inJava($var1,$var2);
}
public void function inJava($var1,$var2){

} 
```

* * *

当对象调用自己的方法方法时，PHP 需要使用显式的 $this。Java（如上例所示）没有。

* * *

Java 程序倾向于从“程序运行、保持运行、处理请求”的方式构建，而 PHP 应用程序是从“运行、处理请求、停止运行”的方式构建的。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-04T17:05:07.017

我认为这两种语言（以及它们的运行时系统）差异太大，无法列出所有差异。一些非常重要的东西浮现在我的脑海：

*   Java 被编译为字节码，PHP 被解释（正如 Alan Storm 指出的，从 PHP 4 开始，它不是，但它仍然表现得好像它是一样）；
*   Java 是强类型的静态类型，而 PHP 是相当弱的动态类型；
*   PHP 主要用于动态生成网页。Java 也可以做到这一点，但也可以做任何其他事情（如 Applet、手机软件、企业级产品、带有或不带 GUI 的桌面应用程序、3d 游戏、Google Web 工具包……）；和
*   *在此处添加您最喜欢的差异*

您会在需要时注意到大多数差异，但最重要的是：

*   PHP 提供 OOP（面向对象编程）作为大多数项目中忽略的选项。Java 要求您以 OOP 方式编程，但是在以不太 OOP 语言的背景学习 Java 时，很容易把事情搞砸并以错误的方式使用 OOP（或者您可能将其称为次优方式或低效的方式...）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-04T21:30:29.493

*   Java 是强类型的。PHP 不是；
*   PHP 做了很多隐式类型转换，这实际上可能是有问题的，这也是 PHP5 有像`===`and之类的运算符的原因`!==`。Java 的隐式类型转换主要限于原始类型的自动装箱（PHP 没有原始类型）。这经常出现。

考虑：

```
$val = 'a';
if (strpos('abcdefghij', $val)) {
  // do stuff
} 
```

这是不正确的，并且由于返回索引`0`转换为`false`. 正确的版本是：

```
$val = 'a';
if (strpos('abcdefghij', $val) !== false) {
  // do stuff
} 
```

Java 条件语句需要显式的`boolean`;

*   PHP 变量和数组都以前缀开头`$`，否则无法区分；
*   PHP 关联数组的等价物是 PHP `Maps`（例如`HashMap`）。关联数组按插入顺序排序，可以像普通数组一样使用（在值上）。在 Java 中有一种`Map`维护插入顺序的实现，但这是例外而不是规范；
*   `$arr['foo'] = 'bar'`在关联数组中插入或更新元素。Java 必须使用`Map.put()`and `Map.get()`;
*   PHP5 相当于函数指针和匿名函数（使用`create_function()`）；5.3 在语言级别引入了闭包。Java 必须对两者都使用内部类，这有点冗长。此外，内部类在如何从外部范围访问变量方面受到限制（请阅读JavaPapers 上的[Java 闭包](http://javapapers.com/core-java/java-closures/)），这使得它们不如真正的闭包强大。
*   变量声明在 PHP 中是可选的；
*   在函数中使用全局变量需要在 PHP 中显式使用`global`关键字；
*   POST/GET 参数是，除非另外配置 ( `register_globals()`) 自动产生同名的全局变量。它们也可以通过`$_POST`全局变量（和`$_SESSION`会话变量）访问，而对这些东西的支持来自一个名为 servlets API 的 JEE 附加组件，通过对象`HttpServletRequest`和`HttpSession`;
*   PHP 中的函数声明使用`function`关键字，而在 Java 中声明返回类型和参数类型；
*   PHP 函数名称通常不会发生冲突，而 Java 允许方法重载，只要不同的方法签名不模棱两可；
*   PHP 有函数参数的默认值。Java没有。在 Java 中，这是使用方法重载实现的。
*   PHP 支持[缺失方法](http://cmlubinski.info/programming-languages-web-developers/method-missing-method)模式，这在 PHP 文档中被混淆地称为“[重载”。](http://php.net/__call)

比较：

```
function do_stuff($name = 'Foo') {
  // ...
} 
```

到

```
void doStuff() {
  doStuff("Foo");
}

void doStuff(String what) {
  // ...
} 
```

*   PHP 中的字符串常量使用单引号或双引号声明，与 Perl 非常相似。双引号将评估嵌入在文本中的变量。所有 Java String 常量都使用双引号，并且没有这样的变量求值；
*   PHP 对象方法调用使用`->`运算符。Java使用`.`运算符；
*   Java 中的构造函数以类名命名。在 PHP 中，它们被称为`__construct()`；
*   在 Java 对象中，`this`它是隐式的，仅用于明确范围，在某些情况下用于内部类。在 PHP5 中，`$this`是显式的；
*   Java 中的静态方法可以使用`.`实例上的任一运算符调用（尽管不鼓励这样做，但在语法上是有效的），但通常使用类名来代替。

这两个是等价的：

```
float f = 9.35f;
String s1 = String.valueOf(f);
String s2 = "My name is Earl".valueOf(f); 
```

但前者是首选。PHP 使用`::`范围解析操作符来处理静态；

*   方法重载和重载在 Java 中是很自然的，但在 PHP 中有点杂乱无章；
*   PHP 代码嵌入在其他大部分是 HTML 文档中，就像 JSP 的工作方式一样；
*   PHP 使用`.`运算符来附加字符串。Java 使用`+`;
*   Java 5+ 方法必须使用省略号 ( `...`) 显式声明可变长度参数列表。所有 PHP 函数都是可变长度的；
*   可变长度参数列表被视为方法体内的数组。在 PHP 中，您必须使用`func_get_args()`,`func_get_arg()`和/或`func_num_args()`;
*   毫无疑问，这就是现在想到的所有内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-05T01:11:26.507

*   您可以使用[JavaDoc](http://java.sun.com/j2se/javadoc/faq/index.html)工具自动生成软件文档。但是你需要以特定的方式写评论。

*   你不能在手机上运行 PHP :) 有很多运行时环境和平台。这意味着您需要提前考虑可能缺少哪些库或可能存在哪些限制（屏幕大小、内存限制、文件路径分隔符“/”或“\”，例如）。

# ruby - Tab movement in shoes

> ID：411255
> 
> 赞同：4
> 
> 时间：2009-01-04T16:49:00.187
> 
> 标签：ruby, shoes, tab-ordering

I have a problem I have a:

```
stack {
  flow {
    para "Enter text:"
    edit_line
  }
edit_box
} 
```

(simplified version). When user is on edit_line and presses tab, I want it to move to edit_box control (currently, it just loses focus).

```
 Thanks,

   Juraj. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T21:46:00.103

目前，这仅适用于 linux（可能还有 windows）

这是原生小部件在其他平台上呈现方式的问题。也许它可以修复！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-11T21:50:04.247

我尝试了@上面列出的示例，并且遇到了您描述的预期行为。

您在哪个平台上运行您的应用程序？

干杯，

库纳尔

# gwt - 测试 GWT 代码的最佳方法是什么

> ID：411257
> 
> 赞同：17
> 
> 时间：2009-01-04T16:51:08.747
> 
> 标签：gwt

测试 GWT 代码的最佳方法是什么？

托管模式下的 GWTTestCase 太慢，并且没有一个模拟框架工作。

目前，我们按照[http://robvanmaris.jteam.nl/2008/03/09/test-driven-development-for-gwt-ui-code/](http://robvanmaris.jteam.nl/2008/03/09/test-driven-development-for-gwt-ui-code/)中的建议遵循 MVC，并使用 GWTMockUtilities disarm() 和 restore() 来模拟小部件。而且我们还没有找到在 GWT MVC 中测试 View 的方法。有没有更好的方法来测试 GWT 代码？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-06T02:39:47.217

如果您希望单独测试 GWT 小部件，那么选择并不多。您可以使用 GWTTestCase 实例化您的小部件并通过其 API 对其进行测试，这就是 Google 为 GWT 小部件本身所做的事情：[RadioButtonTest 的源](https://gwt.googlesource.com/gwt/+/master/user/test/com/google/gwt/user/client/ui/RadioButtonTest.java "RadioButtonTest 的来源")

但是，事件触发机制在 GWTTestCases 中不起作用，这意味着您不能以编程方式单击按钮并期望在侦听器上调用某些 onClick() 回调方法。即使不是不可能，也很难获得底层 DOM，因此它可能不是测试低级 HTML 发射代码的最佳工具。

听起来您正在遵循所有正确的步骤；Rob 的文章很好地描述了如何使用 Model-View-Presenter (MVP) 设计模式编写可测试的代码。您在视图层之外保留的逻辑越多越好。如果无法做到这一点，请使用 Selenium 之类的工具来创建动态 UI 行为的集中测试。

我遵循了类似的策略——小部件中代码最少的 MVP。在少数情况下，我确实编写了一些代码来包装 Grid 类，因此我能够在 GWTTestCase 中实例化我的组件，将其传递给 Grid，在我的组件上调用一些方法，并检查 Grid 的状态。我为 Better Software 写了一篇关于 Test-First GWT 的文章，您可以[在我的博客上](http://blog.danielwellman.com/2008/11/test-first-gwt-article-in-november-2008-better-software-magazine.html "测试第一篇 GWT 文章")阅读。

如果您要测试使用非 UI GWT 类（例如 URL 编码或字典）的代码，则需要使用 GWTTestCase，或者遵循类似的包装策略，直到代码太简单而无法破解。然后使用 Selenium 之类的工具或一些目标 GWTTestCases 进行集成测试，这些工具仅测试您是否正确使用了该库——正如 JB Rainsberger 所说，“不要测试框架！”

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-03-24T08:46:13.230

作为替代方案，您应该尝试[gwt-test-utils](http://code.google.com/p/gwt-test-utils/)，它设法在独立的 JVM 中运行 GWT 客户端代码，并提供一些功能来模拟您想要的任何东西（组件、RPC 服务等）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-12T16:03:26.167

什么对我有用：

使用经典的模型/视图/控制器（例如，视图或控制器中没有业务逻辑；控制器仅将视图事件转换为模型上的方法调用）。

将模型和控制器代码与 GWT 视图小部件和任何其他依赖 GWT 且无法在普通旧 JVM 中实例化的类分离。然后，您可以使用良好的旧 JUnit 测试它们。

编写端到端测试以通过 GUI 测试系统，以确保模型和控制器正确连接到视图。我们发现部署和启动应用程序，然后通过由 JUnit 和 WebDriver 控制的浏览器与其交互比使用 GWTTestCase 更快！

使用 JMock 测试异步调用，如下所示：[http](http://www.jmock.org/gwt.html) ://www.jmock.org/gwt.html 。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-11-26T17:03:34.827

还可以阅读[使用 Google Web Toolkit 的测试方法](http://code.google.com/webtoolkit/articles/testing_methodologies_using_gwt.html)

# c++ - Tutorial for tile based side scroller game-play?

> ID：411273
> 
> 赞同：3
> 
> 时间：2009-01-04T16:59:45.967
> 
> 标签：c++, c

Does anyone know a good resource or some pointers which could help me make a side scrolling tile based (descreet movement for character) with box pushing and moving platforms etc. I'm focused right now C/C++ console development (tho after this project I may stop and do stuff a little more graphical, still C/C++). Something bit like [Super Serib Bros](http://www.foon.co.uk/farcade/ssb/). I've taken a look at the code of SSB and I have some idea of how it works, tho the variable names aren't particularly helpful.

It occurs to me someone somewhere must have thought about his problem before. So before I go re-inventing the wheel, any clues?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-05T01:31:45.577

您可能最好加入一个更知名的游戏开发组，例如[GameDev](http://www.gamedev.net/)或[DevMaster](http://www.devmaster.net/)，并查看[Microsoft](http://www.microsoft.com/express/gamedevelopment/)推出的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T12:21:36.637

我不确定你会找到多少资源来制作游戏，因为大多数开源游戏都开发了自己的工具，而商业游戏则将他们的工具保密。

我认为最好的策略是从头开始，使用现有的低级库。

对于 C++，我建议将[Box2d](http://box2d.org)用于物理，将[HGE](http://hge.relishgames.com/ "HGE")用于图形。也听说python的pygame库不错，但是自己没试过。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-09T22:10:52.210

我在业余时间使用一个名为[RPG Maker的编辑器/引擎来娱乐。](http://www.play-asia.com/paOS-13-71-7s-49-en-15-rpg%20maker%20vx-70-2b0a.html)您可以免费下载演示。它是一个基于 tile 的 rpg 引擎，非常基础，但引擎是用 ruby​​ 编写的，可以很容易地浏览。

# windows - Why does perfmon fail to give available memory and what are the alternatives?

> ID：411275
> 
> 赞同：0
> 
> 时间：2009-01-04T17:02:12.750
> 
> 标签：windows, memory, perfmon

I am trying to get reliable information on when my C# application (Windows XP) will run out of memory. I did some research and tests on my machine and picked the most reliable **perfmon** counters:

```
Memory.Pages Output/sec
Memory.Available Bytes 
```

I use thresholds and AND operator and it works quite well, but on the client machine (also Windows XP) both counters are useless. Available memory does not drop below 1GB and pages output is constant zero. After reading some logs I still don't see any useful counter.
Counters like committed memory give correct value, but the program runs out of memory (with paging killing the performance) after crossing 50%-60% of the 5GB available.

Any alternatives? I wouldn't like to be forced to try to allocate memory and catch OutOfMemory exceptions during the computations.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-04T20:42:36.237

请参阅[Windows 进程何时耗尽内存？](https://stackoverflow.com/questions/201906/when-does-a-windows-process-run-out-of-memory)

长话短说，您想要检查进程的私有字节、虚拟字节和/或工作集。

# excel - Import from ADO.NET Data Services into Excel

> ID：411287
> 
> 赞同：0
> 
> 时间：2009-01-04T17:10:40.640
> 
> 标签：excel, ado.net

I'm playing around with ADO.NET Data Services and would like to import the output from a query into a spreadsheet. Although Excel 2007 allows me to import the results of a request from the web page, the resulting spreadsheet contains all the XML header info which makes seeing/working with the data impossible for my users. Can't seem to find a solution. Any help? Thx.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-23T21:35:37.223

你去数据选项卡了吗？
然后**从其他来源** ，然后是**XML 数据导入**？

使用数据的 URL。我使用 Jon Udell 的博客提要作为[测试](http://blog.jonudell.net/feed/)，它奏效了。

如果我知道公共 ADO.NET 服务 URL，我可以对其进行测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-30T07:27:54.923

它不能正常工作，因为提要 Web 服务具有特殊的 xml 格式，这与 ado.net 数据服务使用的 ATOM 不同。查看此网址以获得不太好的解决方案：http: [//geeks.netindonesia.net/blogs/andriyadi/archive/2009/07/16/oba-excel-amp-ado-net-data-services.aspx](http://geeks.netindonesia.net/blogs/andriyadi/archive/2009/07/16/oba-excel-amp-ado-net-data-services.aspx)

# c++ - winsock2 的替代品，带有 C++ 中的示例服务器源

> ID：411295
> 
> 赞同：4
> 
> 时间：2009-01-04T17:15:11.070
> 
> 标签：c++, winsock

我正在使用在[http://tangentsoft.net/wskfaq/examples/basics/select-server.html找到的这个示例实现](http://tangentsoft.net/wskfaq/examples/basics/select-server.html)

这完成了我需要的大部分工作，处理连接而不阻塞，并且在其线程中完成所有工作（不像某些示例那样为每个连接创建一个新线程），但我很担心，因为我被告知 winsock 只会支持最多 64 个客户端连接：S

这64个连接是真的吗？

我还有什么其他选择？有一个类似实现的 c++ 示例会很酷。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-04T17:17:14.623

**替代库：**

您应该考虑使用[boost asio](http://www.boost.org/doc/libs/1_37_0/doc/html/boost_asio.html)。它是一个跨平台的网络库，可以简化您可能需要完成的许多任务。

您可以在[此处找到您需要的示例源代码](http://www.boost.org/doc/libs/1_37_0/doc/html/boost_asio/examples.html)。

* * *

**关于 64 个限制：**

好的设计没有硬性的 64 连接限制。基本上，如果您使用某种线程模型，您将不会遇到此限制。

以下是有关您听说的限制的一些信息：

> 4.9 - “64 个套接字”的限制是什么？
> 
> 有两个 64 插槽限制：
> 
> Win32 事件机制（例如WaitForMultipleObjects()）一次只能等待64 个事件对象。Winsock 2 提供了 WSAEventSelect() 函数，它允许您使用 Win32 的事件机制来等待套接字上的事件。因为它使用 Win32 的事件机制，所以一次只能等待 64 个套接字上的事件。如果要一次等待超过 64 个 Winsock 事件对象，则需要使用多个线程，每个线程等待不超过 64 个套接字。
> 
> select() 函数在某些情况下也被限制为一次等待 64 个套接字。winsock.h 中定义的 FD_SETSIZE 常量决定了传递给 select() 的 fd_set 结构的大小。它默认定义为 64。您可以在 #include winsock.h 之前将此常量定义为更高的值，这将覆盖默认值。不幸的是，至少有一个非 Microsoft Winsock 堆栈和一些分层服务提供程序假定默认值为 64；他们将忽略较大 fd_sets 中第 64 个以上的套接字。
> 
> 您可以编写一个测试程序来在您计划支持的系统上进行尝试，看看它们是否不受限制。如果是这样，您可以使用线程来解决这个问题，就像使用事件对象一样。

[来源](http://tangentsoft.net/wskfaq/advanced.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-04T17:25:16.727

@布莱恩：

```
 if ((gConnections.size() + 1) > 64) {
                    // For the background on this check, see
                    // www.tangentsoft.net/wskfaq/advanced.html#64sockets
                    // The +1 is to account for the listener socket.
                    cout << "WARNING: More than 63 client "
                            "connections accepted.  This will not "
                            "work reliably on some Winsock "
                            "stacks!" << endl;
                } 
```

对 OP：

为什么你不想使用winsock2？您可以尝试使用 IOCP 构建您自己的服务器，尽管制作这个跨平台有点棘手。您可以像 Brian 建议的那样查看 Boost::asio。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-04T22:54:48.373

在您决定需要“winsock2 的替代方案”之前，请阅读以下内容：[Microsoft Windows 的网络编程](https://rads.stackoverflow.com/amzn/click/com/0735615799)。

总之，您不需要“Winsock2 的替代品”，您需要了解如何使用所提供的编程模型在您的目标平台上完全发挥作用。然后，如果你真的***需要***使用异步 I/O 的跨平台套接字代码，那么看看 ASIO，但是，如果你*真的不需要*跨平台代码，那么考虑一些真正关注你在平台上可能遇到的问题的东西您确实需要专注于 - 即特定于 Windows 的东西。回到上面提到的书，看看你有各种选择。

最具性能和可扩展性的选项是使用 IO 完成端口。我有一些免费的代码可以从[这里](http://www.serverframework.com/products---the-free-framework.html)获得，可以很容易地编写一个在基于 Windows (NT) 的平台上扩展和执行良好的服务器；链接页面还链接到我写过的一些文章。我的框架与 ASIO 的比较可以在这里找到：http: [//www.lenholgate.com/blog/2008/09/how-does-the-socket-server-framework-compare-to-boostasio.html](http://www.lenholgate.com/blog/2008/09/how-does-the-socket-server-framework-compare-to-boostasio.html)。

# c# - 比较两个列表的最快方法

> ID：411296
> 
> 赞同：11
> 
> 时间：2009-01-04T17:16:03.517
> 
> 标签：c#, collections

我有一个列表（Foo），我想看看它是否等于另一个列表（foo）。最快的方法是什么？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-04T18:54:05.050

从 3.5 开始，您可以为此使用 LINQ 函数：

```
List<string> l1 = new List<string> {"Hello", "World","How","Are","You"};
List<string> l2 = new List<string> {"Hello","World","How","Are","You"};
Console.WriteLine(l1.SequenceEqual(l2)); 
```

它还知道提供您自己的比较器的重载

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-04T17:37:53.707

以下是我会做的步骤：

1.  如果为真，则执行 object.ReferenceEquals()，然后返回真。
2.  检查计数，如果不一样，返回false。
3.  逐一比较元素。

以下是该方法的一些建议：

1.  基于 ICollection 实现。这为您提供计数，但不限于特定的集合类型或包含的类型。
2.  您可以将该方法实现为 ICollection 的扩展方法。
3.  您将需要使用 .Equals() 来比较列表的元素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-04T17:23:03.783

像这样的东西：

```
public static bool CompareLists(List<int> l1, List<int> l2)
{
    if (l1 == l2) return true;
    if (l1.Count != l2.Count) return false;
    for (int i=0; i<l1.Count; i++)
        if (l1[i] != l2[i]) return false;
    return true;
} 
```

可能需要一些额外的错误检查（例如空检查）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-04T17:44:45.300

像这样的事情可能会使用匹配操作。

```
public static CompareList<T>(IList<T> obj1, IList<T> obj2, Action<T,T> match)
{
   if (obj1.Count != obj2.Count) return false;
   for (int i = 0; i < obj1.Count; i++)
   {
     if (obj2[i] != null && !match(obj1[i], obj2[i]))
       return false;
   }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-04T20:21:58.227

假设您的意思是您想知道 CONTENTS 是否相等（不仅仅是列表的对象引用。）

如果您将比插入更频繁地进行相等检查，那么您可能会发现每次插入值时生成哈希码并在进行相等检查时比较哈希码更有效。请注意，您应该考虑顺序是否重要，或者只是列表具有任何顺序的相同内容。

除非您经常比较，否则我认为这通常是一种浪费。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-20T05:44:14.517

我没有看到提到的一种快捷方式是，如果您知道列表是如何创建的，您可以将它们加入字符串并直接比较。

例如...

就我而言，我想提示用户输入单词列表。我想确保每个单词都以字母开头，但之后可以包含字母、数字或下划线。我特别担心用户会使用破折号或以数字开头。

我使用正则表达式将其分成 2 个列表，然后将它们重新组合在一起并将它们作为字符串进行比较：

```
 var testList = userInput.match(/[-|\w]+/g)  
        /*the above catches common errors: 
         using dash or starting with a numeric*/
    listToUse = userInput.match(/[a-zA-Z]\w*/g)

    if (listToUse.join(" ") != testList.join(" ")) {
                return "the lists don't match" 
```

因为我知道两个列表都不会包含空格，并且列表只包含简单的字符串，所以我可以用空格将它们连接在一起，然后比较它们。

# google-visualization - google charts bad request

> ID：411302
> 
> 赞同：2
> 
> 时间：2009-01-04T17:17:23.937
> 
> 标签：google-visualization

does anyone know why this is a bad request?

```
http://chart.apis.google.com/chart?cht=lxy&
chd=t:0,0.7,1.4,2.2,2.9,3.6,4.3,5,5.8,6.5,7.2,7.9,8.6,9.4,10.1,10.8,11.5,12.2,12.9,13.7,14.4,15.1,15.8,16.5,17.3,18,18.7,19.4,20.1,20.9,21.6,22.3,23,23.7,24.5,25.2,25.9,26.6,27.3,28.1,28.8,29.5,30.2,30.9,31.7,32.4,33.1,33.8,34.5,35.3,36,36.7,37.4,38.1,38.8,39.6,40.3,41,41.7,42.4,43.2,43.9,44.6,45.3,46,46.8,47.5,48.2,48.9,49.6,50.4,51.1,51.8,52.5,53.2,54,54.7,55.4,56.1,56.8,57.6,58.3,59,59.7,60.4,61.2,61.9,62.6,63.3,64,64.7,65.5,66.2,66.9,67.6,68.3,69.1,69.8,70.5,71.2,71.9,72.7,73.4,74.1,74.8,75.5,76.3,77,77.7,78.4,79.1,79.9,80.6,81.3,82,82.7,83.5,84.2,84.9,85.6,86.3,87.1,87.8,88.5,89.2,89.9,90.6,91.4,92.1,92.8,93.5,94.2,95,95.7,96.4,97.1,97.8,98.6,99.3|30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30|0,0.7,1.4,2.2,2.9,3.6,4.3,5,5.8,6.5,7.2,7.9,8.6,9.4,10.1,10.8,11.5,12.2,12.9,13.7,14.4,15.1,15.8,16.5,17.3,18,18.7,19.4,20.1,20.9,21.6,22.3,23,23.7,24.5,25.2,25.9,26.6,27.3,28.1,28.8,29.5,30.2,30.9,31.7,32.4,33.1,33.8,34.5,35.3,36,36.7,37.4,38.1,38.8,39.6,40.3,41,41.7,42.4,43.2,43.9,44.6,45.3,46,46.8,47.5,48.2,48.9,49.6,50.4,51.1,51.8,52.5,53.2,54,54.7,55.4,56.1,56.8,57.6,58.3,59,59.7,60.4,61.2,61.9,62.6,63.3,64,64.7,65.5,66.2,66.9,67.6,68.3,69.1,69.8,70.5,71.2,71.9,72.7,73.4,74.1,74.8,75.5,76.3,77,77.7,78.4,79.1,79.9,80.6,81.3,82,82.7,83.5,84.2,84.9,85.6,86.3,87.1,87.8,88.5,89.2,89.9,90.6,91.4,92.1,92.8,93.5,94.2,95,95.7,96.4,97.1,97.8,98.6,99.3|28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28|0,0.7,1.4,2.2,2.9,3.6,4.3,5,5.8,6.5,7.2,7.9,8.6,9.4,10.1,10.8,11.5,12.2,12.9,13.7,14.4,15.1,15.8,16.5,17.3,18,18.7,19.4,20.1,20.9,21.6,22.3,23,23.7,24.5,25.2,25.9,26.6,27.3,28.1,28.8,29.5,30.2,30.9,31.7,32.4,33.1,33.8,34.5,35.3,36,36.7,37.4,38.1,38.8,39.6,40.3,41,41.7,42.4,43.2,43.9,44.6,45.3,46,46.8,47.5,48.2,48.9,49.6,50.4,51.1,51.8,52.5,53.2,54,54.7,55.4,56.1,56.8,57.6,58.3,59,59.7,60.4,61.2,61.9,62.6,63.3,64,64.7,65.5,66.2,66.9,67.6,68.3,69.1,69.8,70.5,71.2,71.9,72.7,73.4,74.1,74.8,75.5,76.3,77,77.7,78.4,79.1,79.9,80.6,81.3,82,82.7,83.5,84.2,84.9,85.6,86.3,87.1,87.8,88.5,89.2,89.9,90.6,91.4,92.1,92.8,93.5,94.2,95,95.7,96.4,97.1,97.8,98.6,99.3|0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0|0,0.7,1.4,2.2,2.9,3.6,4.3,5,5.8,6.5,7.2,7.9,8.6,9.4,10.1,10.8,11.5,12.2,12.9,13.7,14.4,15.1,15.8,16.5,17.3,18,18.7,19.4,20.1,20.9,21.6,22.3,23,23.7,24.5,25.2,25.9,26.6,27.3,28.1,28.8,29.5,30.2,30.9,31.7,32.4,33.1,33.8,34.5,35.3,36,36.7,37.4,38.1,38.8,39.6,40.3,41,41.7,42.4,43.2,43.9,44.6,45.3,46,46.8,47.5,48.2,48.9,49.6,50.4,51.1,51.8,52.5,53.2,54,54.7,55.4,56.1,56.8,57.6,58.3,59,59.7,60.4,61.2,61.9,62.6,63.3,64,64.7,65.5,66.2,66.9,67.6,68.3,69.1,69.8,70.5,71.2,71.9,72.7,73.4,74.1,74.8,75.5,76.3,77,77.7,78.4,79.1,79.9,80.6,81.3,82,82.7,83.5,84.2,84.9,85.6,86.3,87.1,87.8,88.5,89.2,89.9,90.6,91.4,92.1,92.8,93.5,94.2,95,95.7,96.4,97.1,97.8,98.6,99.3|100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100&
chco=3072F3,ff0000,00aaaa,541269&chs=1000x200&chxt=x,y&
chxl=0:|18|18|18|18|18|19|19|19|19|19|19|20|20|20|20|20|20|21|21|21|21|21|21|22|22|22|22|22|22|23|23|23|23|23|23|0|0|0|0|0|0|1|1|1|1|1|1|2|2|2|2|2|2|3|3|3|3|3|3|4|4|4|4|4|4|5|5|5|5|5|5|6|6|6|6|6|6|7|7|7|7|7|7|8|8|8|8|8|8|9|9|9|9|9|9|10|10|10|10|10|10|11|11|11|11|11|11|12|12|12|12|12|12|13|13|13|13|13|13|14|14|14|14|14|14|15|15|15|15|15|15|16|16|16|16|16|16|17|17|1:||3.5|7|10.5|14 
```

trying to plot four lines on a graph

thanks

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-04T17:49:38.317

Google Charts has a maximum length of URL that it will handle without giving that error. I'm not sure what that limit is precisely, but your URL is 4774 characters long and I think the limit is just over 2000 characters.

You may need to use the simple or extended data encoding instead of text encoding. Text encoding is the least space-efficient way of encoding data for the Google Charts API. See the [Data Formats](http://code.google.com/apis/chart/formats.html) API documentation for more information.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-04T17:54:59.570

As Greg said, your URL is too long.

> The maximum length of a URL is not determined by the Google Chart API, but rather by web browser and web server considerations. Currently, URLs that are over 2048 characters in length when URL-encoded (e.g., | becomes %7C) are not recommended. As web browsers and servers evolve, this number may change. See [http://www.boutell.com/newfaq/misc/urllength.html](http://www.boutell.com/newfaq/misc/urllength.html) for a more in-depth discussion.

Have a look at the [Google Chart API FAQ](http://code.google.com/apis/chart/faq.html#url_length) for more information

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-31T13:24:39.217

尽管这已经得到正确回答，但我认为使用您的数据提供实用的解决方案可能会很有用：

```
<form id='graphform' name='graphform' action='https://chart.googleapis.com/chart' method='POST' target='graph_target'>
  <input type="hidden" name="cht" value='lxy' /> 
  <input type="hidden" name="chd" value="t:0,0.7,1.4,2.2,2.9,3.6,4.3,5,5.8,6.5,7.2,7.9,8.6,9.4,10.1,10.8,11.5,12.2,12.9,13.7,14.4,15.1,15.8,16.5,17.3,18,18.7,19.4,20.1,20.9,21.6,22.3,23,23.7,24.5,25.2,25.9,26.6,27.3,28.1,28.8,29.5,30.2,30.9,31.7,32.4,33.1,33.8,34.5,35.3,36,36.7,37.4,38.1,38.8,39.6,40.3,41,41.7,42.4,43.2,43.9,44.6,45.3,46,46.8,47.5,48.2,48.9,49.6,50.4,51.1,51.8,52.5,53.2,54,54.7,55.4,56.1,56.8,57.6,58.3,59,59.7,60.4,61.2,61.9,62.6,63.3,64,64.7,65.5,66.2,66.9,67.6,68.3,69.1,69.8,70.5,71.2,71.9,72.7,73.4,74.1,74.8,75.5,76.3,77,77.7,78.4,79.1,79.9,80.6,81.3,82,82.7,83.5,84.2,84.9,85.6,86.3,87.1,87.8,88.5,89.2,89.9,90.6,91.4,92.1,92.8,93.5,94.2,95,95.7,96.4,97.1,97.8,98.6,99.3|30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30|0,0.7,1.4,2.2,2.9,3.6,4.3,5,5.8,6.5,7.2,7.9,8.6,9.4,10.1,10.8,11.5,12.2,12.9,13.7,14.4,15.1,15.8,16.5,17.3,18,18.7,19.4,20.1,20.9,21.6,22.3,23,23.7,24.5,25.2,25.9,26.6,27.3,28.1,28.8,29.5,30.2,30.9,31.7,32.4,33.1,33.8,34.5,35.3,36,36.7,37.4,38.1,38.8,39.6,40.3,41,41.7,42.4,43.2,43.9,44.6,45.3,46,46.8,47.5,48.2,48.9,49.6,50.4,51.1,51.8,52.5,53.2,54,54.7,55.4,56.1,56.8,57.6,58.3,59,59.7,60.4,61.2,61.9,62.6,63.3,64,64.7,65.5,66.2,66.9,67.6,68.3,69.1,69.8,70.5,71.2,71.9,72.7,73.4,74.1,74.8,75.5,76.3,77,77.7,78.4,79.1,79.9,80.6,81.3,82,82.7,83.5,84.2,84.9,85.6,86.3,87.1,87.8,88.5,89.2,89.9,90.6,91.4,92.1,92.8,93.5,94.2,95,95.7,96.4,97.1,97.8,98.6,99.3|28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28|0,0.7,1.4,2.2,2.9,3.6,4.3,5,5.8,6.5,7.2,7.9,8.6,9.4,10.1,10.8,11.5,12.2,12.9,13.7,14.4,15.1,15.8,16.5,17.3,18,18.7,19.4,20.1,20.9,21.6,22.3,23,23.7,24.5,25.2,25.9,26.6,27.3,28.1,28.8,29.5,30.2,30.9,31.7,32.4,33.1,33.8,34.5,35.3,36,36.7,37.4,38.1,38.8,39.6,40.3,41,41.7,42.4,43.2,43.9,44.6,45.3,46,46.8,47.5,48.2,48.9,49.6,50.4,51.1,51.8,52.5,53.2,54,54.7,55.4,56.1,56.8,57.6,58.3,59,59.7,60.4,61.2,61.9,62.6,63.3,64,64.7,65.5,66.2,66.9,67.6,68.3,69.1,69.8,70.5,71.2,71.9,72.7,73.4,74.1,74.8,75.5,76.3,77,77.7,78.4,79.1,79.9,80.6,81.3,82,82.7,83.5,84.2,84.9,85.6,86.3,87.1,87.8,88.5,89.2,89.9,90.6,91.4,92.1,92.8,93.5,94.2,95,95.7,96.4,97.1,97.8,98.6,99.3|0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0|0,0.7,1.4,2.2,2.9,3.6,4.3,5,5.8,6.5,7.2,7.9,8.6,9.4,10.1,10.8,11.5,12.2,12.9,13.7,14.4,15.1,15.8,16.5,17.3,18,18.7,19.4,20.1,20.9,21.6,22.3,23,23.7,24.5,25.2,25.9,26.6,27.3,28.1,28.8,29.5,30.2,30.9,31.7,32.4,33.1,33.8,34.5,35.3,36,36.7,37.4,38.1,38.8,39.6,40.3,41,41.7,42.4,43.2,43.9,44.6,45.3,46,46.8,47.5,48.2,48.9,49.6,50.4,51.1,51.8,52.5,53.2,54,54.7,55.4,56.1,56.8,57.6,58.3,59,59.7,60.4,61.2,61.9,62.6,63.3,64,64.7,65.5,66.2,66.9,67.6,68.3,69.1,69.8,70.5,71.2,71.9,72.7,73.4,74.1,74.8,75.5,76.3,77,77.7,78.4,79.1,79.9,80.6,81.3,82,82.7,83.5,84.2,84.9,85.6,86.3,87.1,87.8,88.5,89.2,89.9,90.6,91.4,92.1,92.8,93.5,94.2,95,95.7,96.4,97.1,97.8,98.6,99.3|100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100"  />
  <input type="hidden" name="chco" value="3072F3,ff0000,00aaaa,541269" />
  <input type='hidden' name='chs' value='1000x200' />
  <input type="hidden" name="chxt" value="x,y" />
  <input type="hidden" name="chxl" value="0:|18|18|18|18|18|19|19|19|19|19|19|20|20|20|20|20|20|21|21|21|21|21|21|22|22|22|22|22|22|23|23|23|23|23|23|0|0|0|0|0|0|1|1|1|1|1|1|2|2|2|2|2|2|3|3|3|3|3|3|4|4|4|4|4|4|5|5|5|5|5|5|6|6|6|6|6|6|7|7|7|7|7|7|8|8|8|8|8|8|9|9|9|9|9|9|10|10|10|10|10|10|11|11|11|11|11|11|12|12|12|12|12|12|13|13|13|13|13|13|14|14|14|14|14|14|15|15|15|15|15|15|16|16|16|16|16|16|17|17|1:||3.5|7|10.5|14" />
</form>  
<iframe name='graph_target' src='' style='width:1000px;height:200px;'></iframe>
<script type="text/javascript">
document.forms["graphform"].submit();
</script> 
```

这会生成一个信息量不大的图表！

# c# - 我应该如何使用 C# 读取分区表/引导扇区？

> ID：411304
> 
> 赞同：2
> 
> 时间：2009-01-04T17:17:44.777
> 
> 标签：c#

嗨，我已经浏览了 WMI 类...但是没有一个可以帮助我获取分区表信息...现在我有一个项目是显示 USB 拇指驱动器的 .MBR 我应该怎么做？真的很困惑......任何帮助和指导将不胜感激！

ps 代码只能用C#写

**编辑**

谢谢！我浏览了 CreateFile 文档...仍然想知道我应该如何使用 P/Invoke 来调用 CreateFile 并读取引导扇区（显示 .MBR ）？你有这部分的参考代码吗？再一次感谢你！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-05-09T11:43:50.810

如果您愿意，可以使用 WMI 获取有关任何驱动器的信息。为此，您需要查询相应的 WMI 类。使用 C#，您必须添加以下引用：

```
System.Management 
```

并使用语句：

```
using System.Management; 
```

要获取连接到您计算机的磁盘信息，您可以使用以下查询：

```
Select * From Win32_DiskDrive 
```

使用 C#，您可以查询如下：

```
SelectQuery wmi_sorgusu = new SelectQuery("Select * from Win32_DiskDrive");
ManagementObjectSearcher wmi_bulucu = new ManagementObjectSearcher( wmi_sorgusu );

foreach (ManagementObject wmi_nesne in wmi_bulucu.Get()) {
    Console.WriteLine(wmi_nesne.GetPropertyValue( "DeviceID" ).ToString());
    Console.WriteLine(wmi_nesne.GetPropertyValue( "InterfaceType" ).ToString());
    Console.WriteLine(wmi_nesne.GetPropertyValue( "Caption" ).ToString());
    Console.WriteLine(wmi_nesne.GetPropertyValue( "Status" ).ToString());
    Console.WriteLine(wmi_nesne.GetPropertyValue( "MediaLoaded" ).ToString());
    //... etc
} 
```

获取设备参数后，可以用同样的方法查询Win32_DiskPartition WMI Class。您可以将设备参数作为 WHERE 子句提供给 SELECT 查询。对 Win32_DiskPartition 的查询返回连接到系统的所有驱动器的所有分区。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-04T18:29:42.823

如果您准备自己解析原始信息，可以使用 P/Invoke 调用 CreateFile。如果您的用户帐户有足够的 mojo，您可以通过传递一个字符串来打开原始磁盘设备，例如`"\\.\PHYSICALDRIVE0"`. 有关详细信息，请参阅 CreateFile 的文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T03:45:36.943

老实说，如果你不能用 IO.FileStream 用同样的魔法路径打开它，我会感到非常惊讶。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-27T07:26:46.027

确实 C# FileStream 不能直接打开物理设备：

> 未处理的异常：System.ArgumentException：FileStream 不会打开 Win32 设备，例如磁盘分区和磁带驱动器。避免在路径中使用“\.\”。

# xml - 列出特定子元素的给定属性

> ID：411306
> 
> 赞同：2
> 
> 时间：2009-01-04T17:18:30.627
> 
> 标签：xml, xslt

我有一些看起来像这样的 XML 代码

```
<SEARCHRESULTS>
  <FUNCTION name="BarGraph">
    <PARAMETER name="numList"></PARAMETER>
    <PARAMETER name="maxValue"></PARAMETER>
    <CODE>Some code</CODE>
  </FUNCTION>
</SEARCHRESULTS> 
```

我想为每个函数提取一个参数名称列表，到目前为止，我得到了以下 xsl 代码

```
<xsl:for-each select="SEARCHRESULTS/FUNCTION">
  <ROW>
    <COL><DATA><xsl:value-of select="@name" /></DATA></COL>
    <COL><DATA><xsl:value-of select="PARAMETER/@name" /></DATA></COL>
    <COL><DATA><xsl:value-of select="CODE" /></DATA></COL>
  </ROW>
</xsl:for-each> 
```

这当然会返回第一个参数的名称以及函数名称和代码。

我想要一个文本字符串中函数的所有参数的列表。返回分隔是最好的，但只要所有名称都在字符串中，我可以稍后解析它。

我可以将目标数据库中的参数记录标准化 - 但我不会这样做，我只需要它们用于显示目的，所以我不想投入太多精力。这就是为什么我正在寻找一个简单的文本字符串。

我认为可能有某种方法可以在其中添加一个星号或其他东西。如果不是，我将创建一个变量并添加另一个 for-each 来构建一个字符串 - 但似乎应该有一个更简单的方法

生成的 XML 应如下所示

```
<ROW>
  <COL><DATA>BarGraph</DATA></COL>
  <COL><DATA>numList;maxValue</DATA></COL>
  <COL><DATA>Some code</DATA></COL>
</ROW> 
```

';' 在第二列中可以是回车或我可以指定的其他字符

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-04T17:25:50.720

尝试第二次 foreach ：

```
<xsl:template match="/">
<xsl:for-each select="SEARCHRESULTS/FUNCTION">
  <ROW>
    <COL>
      <DATA>
        <xsl:value-of select="@name" />
      </DATA>
    </COL>
    <COL>
      <DATA>
        <xsl:for-each select="PARAMETER">
          <!-- separate the names by a semicolon (do not insert a semicolon the first time -->
          <xsl:if test="position() > 1">
            <xsl:text>;</xsl:text>
          </xsl:if>
          <xsl:value-of select="@name" />
        </xsl:for-each>
      </DATA>
    </COL>
    <COL>
      <DATA>
        <xsl:value-of select="CODE" />
      </DATA>
    </COL>
  </ROW>
</xsl:for-each> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-04T21:57:56.473

**产生所需结果的一种可能转换如下**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <!--                                              -->
    <xsl:template match="/*">
      <TABLE>
        <xsl:apply-templates select="*"/>
      </TABLE>
    </xsl:template>
 <!--                                              -->
    <xsl:template match="FUNCTION">
      <ROW>
        <COL><xsl:value-of select="@name"/></COL>
        <COL><xsl:apply-templates select="PARAMETER"/></COL>
        <COL><xsl:apply-templates select="CODE"/></COL>
      </ROW>
    </xsl:template>
 <!--                                              -->
<xsl:template match="PARAMETER">
 <xsl:param name="pDelim" select="';'"/>
 <xsl:value-of select=
 "concat(@name,
         substring($pDelim,
                   1 div not(position() = last()))
                   )"/>
</xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于原始 XML 文档时**：

```
<SEARCHRESULTS>
    <FUNCTION name="BarGraph">
        <PARAMETER name="numList"></PARAMETER>
        <PARAMETER name="maxValue"></PARAMETER>
        <CODE>Some code</CODE>
    </FUNCTION>
</SEARCHRESULTS> 
```

**产生了想要的结果**：

```
<TABLE>
   <ROW>
      <COL>BarGraph</COL>
      <COL>numList;maxValue</COL>
      <COL>Some code</COL>
   </ROW>
</TABLE> 
```

**请**注意****`<xsl:template>`**which match**`PARAMETER`**有一个 parameter **`$pDelim`**，它可用于指定使用什么字符（或字符串）作为参数名称列表的分隔符。此分隔符的默认值设置为“;”。**

 *** * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-05T02:30:55.673

xsl:apply-templates 将是您的答案。它简单而优雅。

```
<xsl:template match="FUNCTION/PARAMETER">
    <xsl:if test="position() > 1">
        <xsl:text>; </xsl:text> <!-- This is the delimiter -->
    </xsl:if>
    <xsl:value-of select="@name" />
</xsl:template> 
```

然后代替`<xsl:value-of select="PARAMETER/@name" />`你做这个：

```
<xsl:apply-templates select="PARAMETER" /> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-04T17:26:18.223

```
<xsl:template match="PARAMETER">
    <xsl:value-of select="@name" />
    <xsl:text> </xsl:text>
</xsl:template> 
```

替换当前代码

```
 <COL><DATA><xsl:value-of select="PARAMETER/@name" /></DATA></COL> 
```

和

```
 <COL><DATA><xsl:apply-templates select="PARAMETER"/></DATA></COL> 
```

# c# - 从错误中记录多少信息？

> ID：411312
> 
> 赞同：3
> 
> 时间：2009-01-04T17:22:44.550
> 
> 标签：c#, asp.net, error-logging

在我工作的公司，我创建了一个错误日志类来处理我的 ASP.net 应用程序中的错误。这是一个自定义类，因为我们不允许在我们的服务器上安装其他软件（nLog、log4net 等）。

我目前在我的两个项目中使用它，并从中看到了一些好的结果。现在我正在捕获导致页面和应用程序错误的错误。它发送并存储错误消息和所有内部异常。

我现在遇到的问题是，我收到了我不太确定如何重现的错误。我没有从任何用户那里听到任何错误报告。我不确定他们在做什么，或者即使他们将这些视为错误。

我正在考虑在每个页面上创建一个事件日志，或者在我想要更多信息的页面上创建一个事件日志。将其作为 Session 变量保存在页面上，并向其写入事件（函数的开始/结束、变量更改等）。然后只有当一个错误被调用来让它与错误消息一起发送时，看看它是否能更好地了解正在发生的事情。我希望这样做不会在所有用户访问应用程序时给我大量的事件日志，只是希望在一个用户发生错误之前发生。

你知道我应该注意的任何陷阱吗？

你对要寻找的东西有什么建议吗？

更新：

@Saret：我知道您的回复来自哪里，我同意。我对这家公司还很陌生，仍然需要学习他们是如何做事的。过去，我曾与我的同事进行过对话，如果拥有这个产品或使用这个开源项目会很棒。问题归结为，我们致力于安全系统，并且获得批准以获取这些东西需要花费大量时间、顶盖和处理所有繁文缛节。我会进一步调查这种情况，因为我相信拥有一个好的错误记录系统很重要，目前没有使用任何东西。

@Jim Blizard：我想尝试避免在某个地方记录/存储所有内容，然后找出对导致错误的情况很重要的内容。我不想陷入罗伯托·巴罗斯（Roberto Barros）链接的文章中谈论的过多信息。我目前的想法是，在每个页面的内存中保留一个字符串，如果出现错误，则在页面 Page_Error 事件中，获取该字符串并将其附加到正在记录的异常中。这样我只记录发生的错误/异常并存储带有该错误的事件日志。如果没有任何反应，正在创建的日志将被丢弃到比特桶中，再也不会被看到。

@Roberto Barros：感谢那个链接，我记得在某处读过它，但忘记保存了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-04T17:52:09.060

这可能不是您正在寻找的确切答案，但是当有强大的工具（您提到的）可以为您处理所有这些关键问题时，为什么要开发自己的错误记录机制呢？

我很感激您不允许安装其他软件，但不记录库只是像您的自定义代码这样的类？根本区别在哪里？我认为花时间担心实现日志框架可能会更好地用于倡导和为一个体面的日志解决方案制定商业案例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-04T17:57:22.327

我曾经在一家不允许安装任何不是我自己的代码或他们（可怕的）COM 对象的机构工作。如果您有这种类型的限制，那么看看您是否可以获取 log4net 的源代码并将其包含在您的项目中。

在日志记录方面，目前没有什么比 log4net 更好的了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-05T01:36:17.827

我个人在 asp.net 应用程序中记录错误（并且仅记录错误）时采用了以下方法：

*   使用 `protected void Application_Error(object sender, EventArgs e) { Server.Transfer("~/Support/ServerErrorSupport.aspx", true); }` （我会`Server.Transfer`保留所有帖子数据。）

*   生成此错误唯一的错误 ID（因此可以对同一错误的后续报告进行分组）。ID 是由连接字符串计算得出的哈希值，该字符串包括：file、method、lineNr 和 error.Message。我通过堆栈跟踪上的正则表达式获取文件、方法和 lineNr 值。

*   我将以下所有数据记录到 xml 结构中（根据数据类型，我以不同的方式存储值，值类型 => ToString()、ISerializable => 序列化，...）：

    1.  机器名：Application.Server.MachineName
    2.  PhysicalRoot: Application.Server.MapPath("~/")
    3.  RequestUrl：Application.Request.Url.ToString()
    4.  应用程序设置：WebConfigurationManager.AppSettings
    5.  连接设置：WebConfigurationManager.ConnectionStrings
    6.  查询字符串：Application.Request.QueryString
    7.  FormPost：Application.Request.Form
    8.  会话：Application.Session
    9.  HttpHeaders：Application.Request.Headers
*   将 xml 结构保存为包含错误 ID 和时间戳的本地文件。我选择这种方法是因为：

    *   我可以将 rapport（xml 文件）邮寄给自己（在测试/调试期间非常容易）
    *   在生产期间将其存储在本地或数据库中
    *   因为该文件只是一个（转储到高清）保存，所以在创建错误报告期间不会出错（如服务器连接、数据库问题等），只需确保您具有写入权限即可。
    *   此外，在 servererrorsupport.aspx 页面上，保存 xml 文件后，用户可以选择包含额外信息并添加电子邮件地址，以随时了解有关错误的进度。这将附加到 xml 文档中。
    *   我使用 xslt 文件在一个不错的错误报告中格式化错误数据 (xml)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-04T17:24:56.383

对于错误，我非常喜欢记录 A LOT。当出现问题时，信息非常有价值。我会将整个日志与会话标识符一起保存在一个地方（文本文件或数据库表），以将相关事件组合在一起。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-04T18:02:58.180

这是我喜欢记录的内容：

*   错误/调试级别（信息、调试、问题、崩溃等）
*   时间
*   描述性文本（通常是一行）
*   堆栈跟踪（如果可能）
*   数据（用户、会话、变量值等...）

最简单的方法是写入文本文件，但最好将其保存在数据库中。您还可以使用 Windows 事件日志。有些事情要注意。嗯...您需要定期清除日志。

有趣的故事：有一次我们有一个错误记录器记录到数据库，但是我们有错误的数据库凭据导致了一个错误，然后被记录了......最终从递归（IIRC）中得到堆栈溢出。

# c# - 如何在 C# 中访问用户控件的属性

> ID：411316
> 
> 赞同：20
> 
> 时间：2009-01-04T17:23:31.910
> 
> 标签：c#, user-controls, properties, richtextbox

我制作了一个带有一个文本框和一个富文本框的 C# 用户控件。

如何从用户控件外部访问富文本框的属性。

例如..如果我把它放在一个表单中，我怎么能使用richtextbox的Text属性？？？

谢谢

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-01-04T17:28:45.877

最干净的方法是将所需的属性公开为用户控件的属性，例如：

```
class MyUserControl
{
  // expose the Text of the richtext control (read-only)
  public string TextOfRichTextBox
  {
    get { return richTextBox.Text; }
  }
  // expose the Checked Property of a checkbox (read/write)
  public bool CheckBoxProperty
  {
    get { return checkBox.Checked; }
    set { checkBox.Checked = value; }
  }

  //...
} 
```

通过这种方式，您可以控制要公开的属性以及它们应该是读/写还是只读的。（当然，您应该为属性使用更好的名称，具体取决于它们的含义）。

这种方法的另一个优点是它隐藏了用户控件的内部实现。如果您想将您的富文本控件与其他控件交换，您不会破坏控件的调用者/用户。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-04T17:26:56.803

将属性网格中 RichTextBox 的访问修饰符（“修饰符”）更改为 Public。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-04T17:30:30.803

像这样向用户控件添加一个属性

```
public string TextBoxText
{
    get
    {
        return textBox1.Text;
    }
    set
    {
        textBox1.Text = value;
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-06-16T22:04:43.733

我最近在使用自定义类时遇到了一些问题：

用户控件有一个自定义类类型的公共属性。默认情况下，设计器尝试为其分配一些值，因此在设计器代码中，该行`userControlThing.CustomClassProperty = null`被自动添加。

目的是能够在运行程序时随时为用户控件提供自定义类（以更改对用户可见的值）。由于该`set {}`部分没有检查空值，因此出现了各种错误。

解决方案是将属性更改为私有属性，并使用两种公共方法来设置和获取值。设计者将尝试自动分配属性，但不理会方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-04T17:32:03.437

您需要为richtextbox 创建一个公共属性，或者公开其他一些可以设置richtextbox 文本的属性，例如：

```
private RichTextBox rtb;

public string RichTextBoxText
{
    get
    {
        return rtb.Text;
    }
    set
    {
        rtb.Text = value;
    }
} 
```

# optimization - 你一般是在之前设置默认值还是在else里面设置呢？

> ID：411330
> 
> 赞同：7
> 
> 时间：2009-01-04T17:28:22.213
> 
> 标签：optimization

您会执行以下哪一项：

```
var = true;
if (...) var = false; 
```

或者

```
if (...) var = false;
else var = true; 
```

你有什么理由选择或其他？

我的工作前提是 var 没有发生任何其他事情。下一行代码可能类似于：

```
if (var) { ... } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-04T17:38:36.437

`var = { ... }`既然它是一个，那么直接怎么样`boolean`？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-04T17:42:05.850

我更喜欢Java中的第二个，做这样的事情：

```
int x;
if (cond) {
  x = 1;
} else {
  x = 5;
} 
```

因为如果稍后更改某些内容（例如，我将`else`块转换为`else if`），编译器会告诉我该变量未能初始化，如果我使用您的第一个策略，我可能会错过。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-04T17:38:06.157

如果您的语言支持，您也可以使用三元运算符:)

如果 IF 有可能失败并且变量必须具有默认值，我通常只会做第一个。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-04T17:52:09.403

如果你设置了默认值，那么你稍后再将它重置为其他东西，虽然它是一个非常小的数量，但它仍然是一种资源浪费。因此，在大多数情况下，对于大多数代码而言，平衡的 if/else 甚至 (?:) 语法都更清晰、更合适，除了：

有时，如果您所做的是构建贯穿代码（或决策函数），从特定条件开始，然后测试一大堆其他条件以查看是否发生变化，那么您肯定要设置默认值第一的：

```
int final = 27;

if ( some condition ) final = 86;

if ( another condition ) {
    final = 98;
    return final;
}

if ( some state ) {
   final += 2;
}

return final; 
```

或者类似的东西。

顺便说一句：在你的例子中，如果你设置'var'，那么下一行只是测试'var'，你真的不需要'var'对吗？如果条件太难看以至于使用 'var' 有助于使其可读，那么您最好将条件移动到它自己的函数中，接受额外的函数调用以提高可读性。通常，当且仅当您获得一些重要的东西（例如可读性）作为回报时，您才可以浪费资源。

保罗。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-04T17:31:26.043

取决于上下文。当 IF 失败时很明显 'var' 需要为真时，我会使用第二个选项。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-04T17:40:06.620

我使用第一种类型，除非要设置的值需要大量计算。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-04T18:27:19.677

正如许多人所说，永远是第一。然而，值得强调的原因是，这是因为它使程序更能抵抗由不正确的维护引起的未来错误。

例如，出现一些额外的业务条件并且维护编码人员在 if 中添加一两个额外的条件以包含更多业务逻辑并错误地修改代码是很常见的 - 例如

```
如果（a==b）{
  如果（a==c）{
    【新逻辑】
    变量=假
  }
}
别的 {
  变量 = 假
}

```

从表面上看，它看起来不太可能，但它经常发生令人震惊（公平地说，情况通常是在原始情况变得更加复杂之后出现的）。首先进行初始化可以防止这种情况。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-04T17:40:54.170

您更喜欢简短紧凑的代码还是更易于阅读的代码？

如果您更喜欢简短紧凑的代码，请使用

```
 var x = true;
if (...) x = false; 
```

但这甚至可以“改进”。大多数语言都会给出初始值，通常对于布尔类型，默认值为 false。所以，你可以写

```
 var x;
if (...) x = true; 
```

如果您喜欢易于阅读的代码，请使用

```
 if (...) var x = false;
else var x = true; 
```

因为它让你的意图清晰。

**两者的表现是一样的。**

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-04T17:43:32.883

取决于语言。在 C++ 中，我强烈建议尽快将其设置为默认值，否则可能会出现垃圾结果。

在大多数其他语言中，您可以更灵活一些。事实上，我认为明确定义条件比设置默认值更具可读性。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-04T18:14:22.387

由于以后不会写入该变量，因此对于一般值，我将在 Java 中编写以下内容：

```
final Type var;
if (cond)
{
    var = value1;
}
else
{
     var = value2;
} 
```

Java 编译器会捕捉到 var 在使用前没有赋值的错误。final 关键字表示变量在条件之后是常量的事实。

在您使用布尔值的确切情况下，我会使用

```
final boolean var = !cond; 
```

在这种情况下使用条件表示您受到“布尔恐惧症”的困扰。

* * *

在 CI 中会在声明时初始化变量。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-04T20:16:03.747

我通常设置“默认”值并使用 if 语句来修改它。如果不存在默认值，则只有 if 语句。

```
int timeout = 100;
if (moreTime) timeout = 1000;

int searchOption = null;
if (sometest1) searchOption = 1;
if (sometest2) searchOption = 2;

// then later..
if (searchOption != null)
  ..... 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-04T21:19:42.340

如果初始化足够复杂以至于无法清晰地编写直接表达式，我有时会发现将这种情况处理为

```
boolean isFoo = determineWhetherFoo(...); 
```

where`determineWhetherFoo`接受任何必要的参数来做出决定并返回适当的布尔结果。这使得变量的含义和它依赖的内容非常清楚。将一个变量初始化为一个可能错误的值，然后是一堆可能会改变其值的代码，有时会掩盖所表达的内容。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2009-01-04T21:24:20.130

无论你在哪里写一个`if()`也写`else`- 即使它是空的。编译器会对其进行优化，但它会迫使您（以及您之后的任何程序员）考虑何时`if ()`未触发，后果是什么？

# java - 将 JavaMail 与 TLS 一起使用

> ID：411331
> 
> 赞同：51
> 
> 时间：2009-01-04T17:28:28.577
> 
> 标签：java, smtp, jakarta-mail, ssl

我在 SO 上发现了其他几个关于 JavaMail API 和通过 SMTP 服务器发送邮件的问题，但没有一个讨论过使用 TLS 安全性。我正在尝试使用 JavaMail 通过我的工作 SMTP 邮件服务器向自己发送状态更新，但它需要 TLS，而且我在网上找不到任何关于如何使用 JavaMail 访问需要 TLS 加密的 SMTP 服务器的示例。有人能帮忙吗？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-01-04T17:42:11.967

实际上，我们的产品中有一些通知代码，如果可用，它会使用 TLS 发送邮件。

您将需要设置 Java Mail 属性。您只需要一个 TLS，但如果您的 SMTP 服务器使用 SSL，您可能需要 SSL。

```
Properties props = new Properties();
props.put("mail.smtp.starttls.enable","true");
props.put("mail.smtp.auth", "true");  // If you need to authenticate
// Use the following if you need SSL
props.put("mail.smtp.socketFactory.port", d_port);
props.put("mail.smtp.socketFactory.class", "javax.net.ssl.SSLSocketFactory");
props.put("mail.smtp.socketFactory.fallback", "false"); 
```

然后，您可以将其传递给 JavaMail Session 或任何其他会话实例化器，例如`Session.getDefaultInstance(props)`.

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-01-05T20:29:57.540

好帖子，线

```
props.put("mail.smtp.socketFactory.class", "javax.net.ssl.SSLSocketFactory"); 
```

如果 SMTP 服务器使用**SSL Authentication**，就像 GMail SMTP 服务器一样，这是强制性的。但是，如果服务器使用基于**TLS 的纯文本身份验证**，则它不应该存在，因为 Java 邮件会抱怨初始连接是纯文本的。

还要确保您使用的是最新版本的 Java Mail。最近我使用了以前项目中的一些旧 Java Mail jar 并且无法使代码工作，因为登录过程失败。升级到最新版本的Java Mail后，错误的原因就清楚了：是javax.net.ssl.SSLHandshakeException，在旧版本的lib中没有抛出。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2010-11-07T14:04:26.133

上面示例中的设置不适用于我使用的服务器（[authsmtp.com](http://www.authsmtp.com/)）。我不断收到此错误：

```
javax.net.ssl.SSLException: Unrecognized SSL message, plaintext connection? 
```

我删除了 mail.smtp.socketFactory 设置，一切正常。最终设置是这样的（未使用 SMTP 身份验证，我在其他地方设置了端口）：

```
java.util.Properties props = new java.util.Properties();
props.put("mail.smtp.starttls.enable", "true"); 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-01-03T14:13:32.457

只需使用以下代码。通过 Java 发送电子邮件真的很有用，它可以工作：

```
import java.util.*;
import javax.activation.CommandMap;
import javax.activation.MailcapCommandMap;
import javax.mail.*;
import javax.mail.Provider;
import javax.mail.internet.*;

public class Main {

    public static void main(String[] args) {
            final String username="your@gmail.com";
            final String password="password";
            Properties prop=new Properties();
            prop.put("mail.smtp.auth", "true");
            prop.put("mail.smtp.host", "smtp.gmail.com");
            prop.put("mail.smtp.port", "587");
            prop.put("mail.smtp.starttls.enable", "true");

            Session session = Session.getDefaultInstance(prop,
          new javax.mail.Authenticator() {
            protected PasswordAuthentication getPasswordAuthentication() {
                return new PasswordAuthentication(username, password);
          }
        });
          try {
                 String body="Dear Renish Khunt Welcome";
                 String htmlBody = "<strong>This is an HTML Message</strong>";
                 String textBody = "This is a Text Message.";
         Message message = new MimeMessage(session);
         message.setFrom(new InternetAddress("your@gmail.com"));
                 message.setRecipients(Message.RecipientType.TO,InternetAddress.parse("receiver@gmail.com"));
        message.setSubject("Testing Subject");
        MailcapCommandMap mc = (MailcapCommandMap) CommandMap.getDefaultCommandMap();
        mc.addMailcap("text/html;; x-java-content-handler=com.sun.mail.handlers.text_html");
        mc.addMailcap("text/xml;; x-java-content-handler=com.sun.mail.handlers.text_xml");
        mc.addMailcap("text/plain;; x-java-content-handler=com.sun.mail.handlers.text_plain");
        mc.addMailcap("multipart/*;; x-java-content-handler=com.sun.mail.handlers.multipart_mixed");
        mc.addMailcap("message/rfc822;; x-java-content-handler=com.sun.mail.handlers.message_rfc822");
        CommandMap.setDefaultCommandMap(mc);
            message.setText(htmlBody);
                        message.setContent(textBody, "text/html");
            Transport.send(message);

            System.out.println("Done");

        } catch (MessagingException e) {
            e.printStackTrace();
        }

    }

} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2021-10-05T18:54:04.053

我刚刚花了很多时间弄清楚如何使用 JavaMail 通过 gmail 或 office365 发送电子邮件。[我在常见问题](https://javaee.github.io/javamail/FAQ)解答中找不到答案，但[javadoc](https://javaee.github.io/javamail/docs/api/com/sun/mail/smtp/package-summary.html)帮助了我一点。

如果你忘记了`props.put("mail.smtp.starttls.enable","true")`，你会得到`com.sun.mail.smtp.SMTPSendFailedException: 451 5.7.3 STARTTLS is required to send mail`.

如果你忘记了`props.put("mail.smtp.ssl.protocols", "TLSv1.2");`，你会得到`javax.mail.MessagingException: Could not convert socket to TLS;`and `No appropriate protocol (protocol is disabled or cipher suites are inappropriate)`。显然这仅对 JavaMail 1.5.2 及更早版本是必需的。

这是我让它工作所需的最少代码：

```
import java.util.Properties;
import javax.mail.Authenticator;
import javax.mail.Message;
import javax.mail.MessagingException;
import javax.mail.PasswordAuthentication;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeMessage;

public class SendEmail {
    public static void main(String[] args) {
        Properties props = new Properties();
        props.put("mail.smtp.auth", "true");
        props.put("mail.smtp.starttls.enable","true");
        // smtp.gmail.com supports TLSv1.2 and TLSv1.3
        // smtp.office365.com supports only TLSv1.2
        props.put("mail.smtp.ssl.protocols", "TLSv1.2");
        props.put("mail.smtp.host", "smtp.office365.com");
        props.put("mail.smtp.port", "587");

        Session session = Session.getInstance(props, new Authenticator() {
            @Override
            protected PasswordAuthentication getPasswordAuthentication() {
                return new PasswordAuthentication("test@example.com", "******");
            }
        });

        try {
            Message message = new MimeMessage(session);
            message.setFrom(new InternetAddress("sender@example.com"));
            message.setRecipients(Message.RecipientType.TO, InternetAddress.parse("recipient@example.com"));
            message.setSubject("You got mail");
            message.setText("This email was sent with JavaMail.");
            Transport.send(message);
            System.out.println("Email sent.");
        } catch (MessagingException e) {
            throw new RuntimeException(e);
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-05-19T11:01:30.510

使用[Simple Java Mail 5.0.0](http://simplejavamail.org) (simplejavamail.org) 非常简单，该库将为您处理所有 Session 属性。

以下是使用 Google 的 SMTP 服务器的示例：

```
Email email = EmailBuilder.startingBlank()
        .from("lollypop", "lol.pop@somemail.com")
        .to("C.Cane", "candycane@candyshop.org")
        .withSubject("hey")
        .withPlainText("We should meet up!")
        .withHTMLText("<b>We should meet up!</b>")
        .buildEmail();

MailerBuilder.withSMTPServer("smtp.gmail.com", 25, "user", "pass", SMTP_TLS)
        .buildMailer()
        .sendMail(email);

MailerBuilder.withSMTPServer("smtp.gmail.com", 587, "user", "pass", SMTP_TLS)
        .buildMailer()
        .sendMail(email);

MailerBuilder.withSMTPServer("smtp.gmail.com", 465, "user", "pass", SMTP_SSL)
        .buildMailer()
        .sendMail(email); 
```

如果您启用了双因素登录，则需要从您的 Google 帐户生成[应用程序专用密码。](https://security.google.com/settings/security/apppasswords)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-12-18T10:39:39.513

作为一个小提示，当我在上面的示例中每个来自 javamail 的示例中将 smtp 更改为 smtps 时，它才开始对我起作用（参见 smtpsend.java，[https://github.com/javaee/javamail/releases/download/JAVAMAIL- 1_6_2/javamail-samples.zip](https://github.com/javaee/javamail/releases/download/JAVAMAIL-1_6_2/javamail-samples.zip)，选项 -S)。

我的结果代码如下：

```
Properties props=new Properties();
props.put("mail.smtps.starttls.enable","true");
// Use the following if you need SSL
props.put("mail.smtps.socketFactory.port", port);
props.put("mail.smtps.socketFactory.class", "javax.net.ssl.SSLSocketFactory");
props.put("mail.smtps.socketFactory.fallback", "false");
props.put("mail.smtps.host", serverList.get(randNum));
Session session = Session.getDefaultInstance(props);

smtpConnectionPool = new SmtpConnectionPool(
    SmtpConnectionFactories.newSmtpFactory(session));

final ClosableSmtpConnection transport = smtpConnectionPool.borrowObject();
...
transport.sendMessage(message, message.getAllRecipients()); 
```

# delphi - 德尔福代码生成

> ID：411342
> 
> 赞同：3
> 
> 时间：2009-01-04T17:34:43.323
> 
> 标签：delphi, code-generation

我需要加快编码速度，工作量太大，所以我需要能够生成代码。有什么工具，有什么想法吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-04T23:17:43.317

Delphi 包括 Live Templates，这是一个完全可编写脚本和可配置的系统，用于生成任何大小或复杂性的代码结构。

在我看来，实时模板是 Delphi 中被低估的功能之一。

了解如何使用它们：[http ://delphi.wikia.com/wiki/Delphi_Live_Templates](http://delphi.wikia.com/wiki/Delphi_Live_Templates)

和

[http://delphi.wikia.com/wiki/Live_Templates_Technical_Info](http://delphi.wikia.com/wiki/Live_Templates_Technical_Info)

实时模板是完全可编写脚本的，这意味着您可以编写 Delphi 代码来做任何您想做的事情。

可在此处找到可扩展的示例：

[http://cc.codegear.com/Item/26420](http://cc.codegear.com/Item/26420)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-04T17:46:10.007

恕我直言，这不是一个好主意。如果您需要生成器，那么您可能有很多看起来非常相似的代码，所以与其生成器相比，更好的办法是重新思考和重构您拥有的代码。

这应该会导致更少的代码更易于维护，并且将来用于类似任务的代码更少。

如果您正在做数据库应用程序，那么您可以使用一些优秀的可视化 SQL 查询构建器来帮助您创建查询。那是Delphi不是很好的部分（我不知道它在D2007和D2009中是否有所改进）

**编辑 - 关于 SQL 生成**

有很多关于查询生成器的评论。
好吧，我想我被宠坏了。我记得，在版本 6（甚至可能是 5？）之前的 Delphi 有不错的可视化查询生成器。当我在查询设计器中选择字段时，我在 SQL 中有 0（零）个错误，而不是自己编写 SQL。
SQL 在 Delphi 中只是字符串，没有编译器检查，所以这是确保 SQL 正确编写的最佳方法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-04T17:48:43.810

如果您的意思是建模工具，您可以尝试[ModelMaker](http://www.modelmakertools.com/modelmaker/index.html)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-04T21:29:47.967

而不是尝试生成代码，您可能应该只获取代码来完成您想做的大部分事情。

Sourceforge为 Delphi提供[了数百种免费产品。](http://sourceforge.net/search/?type_of_search=soft&words=delphi)

您可以在 Google 代码搜索中使用数[十万个代码示例。](http://www.google.com/codesearch?as_q=&btnG=Search+Code&hl=en&as_lang=pascal&as_license_restrict=i&as_license=&as_package=&as_filename=&as_case=)

加上存储库中的数千个免费或可购买的组件，例如[Torry 的 Delphi Pages](http://www.torry.net/)或[Embarcadero 的 Delphi Code Central](http://cc.codegear.com/products.aspx?ProdID=1)

使用已经制作的组件是加快编码速度和添加您永远无法做到的功能的最快方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-05T15:49:45.920

对我来说，最好的方法是创建自定义组件，然后为此组件创建设计器。
我发现我大部分时间都在编写从控件读取/写入值的代码。所以我创建了可以读取、写入、验证值并自动填写表单或存储过程或直接生成 SQL 并执行的控件。

自定义设计器允许您轻松设置所有属性。现在我不再为这种琐碎的任务编写代码，我只是控制、打开设计器并设置必须满足的属性和规则。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-08T03:47:15.190

ModelMaker Code Explorer 可以加快我的编码速度。它有一个很好的用于同步实现和声明的热键，所以如果你改变了一个，你不必搜索它对。此外，非常好的功能是方法编辑对话框。还有很多。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-08T09:46:34.827

你试过[GExpert](http://www.gexperts.org/)吗？它是一组工具，旨在通过向 IDE 添加多项功能来提高 Delphi 和 C++Builder 程序员的生产力。GExperts 是作为开源软件开发的。

其他替代方法是通过将框架保存到 IDE 存储库中来使用项目模板，创建自己的组件和框架。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-14T23:03:49.043

我编写了一个名为 CodeTypo 的代码生成器。我在许多生产环境中使用它。你可以在这里找到它：http: //dade2000.altervista.org/index.php?page= [CodeTypo](http://dade2000.altervista.org/index.php?page=CodeTypo)

它仍处于测试阶段，但可用且相当稳定。

我将把这个旧网站的所有内容迁移到新的英文网站 (www.danieleteti.it) 中。我将添加一些关于 CodeTypo 和代码生成器的其他信息。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-04T21:40:10.240

最能加快我的 Delphi 编码速度的是为 Delphi 获取 CodeRush（通过Delphi 5、6、7的[DevExpress VCL 订阅）并设置大量模板。](http://www.devexpress.com)

# javascript - 如何最好地确定参数是否未发送到 JavaScript 函数

> ID：411352
> 
> 赞同：256
> 
> 时间：2009-01-04T17:38:57.793
> 
> 标签：javascript, arguments

我现在已经看到了 2 种方法来确定参数是否已传递给 JavaScript 函数。我想知道一种方法是否比另一种更好，或者一种方法不好用？

```
 function Test(argument1, argument2) {
      if (Test.arguments.length == 1) argument2 = 'blah';

      alert(argument2);
 }

 Test('test'); 
```

或者

```
 function Test(argument1, argument2) {
      argument2 = argument2 || 'blah';

      alert(argument2);
 }

 Test('test'); 
```

据我所知，它们都会产生相同的结果，但我之前只在生产中使用过第一个。

[汤姆](https://stackoverflow.com/questions/411352/how-best-to-determine-if-an-argument-is-not-sent-to-the-javascript-function#411368)提到的另一个选项：

```
function Test(argument1, argument2) {
    if(argument2 === null) {
        argument2 = 'blah';
    }

    alert(argument2);
} 
```

根据胡安的评论，最好将汤姆的建议改为：

```
function Test(argument1, argument2) {
    if(argument2 === undefined) {
        argument2 = 'blah';
    }

    alert(argument2);
} 
```

* * *

## 回答 #1

> 赞同：290
> 
> 时间：2009-01-04T17:46:09.197

有几种不同的方法可以检查参数是否传递给函数。除了您在（原始）问题中提到的两个 - 检查`arguments.length`或使用`||`运算符提供默认值 - 还可以显式检查参数是否`undefined`通过`argument2 === undefined`或`typeof argument2 === 'undefined'`是否偏执（见评论）。

使用`||`运算符已成为标准做法 - 所有酷孩子都这样做 - 但要小心：如果参数评估为 ，则将触发默认值`false`，这意味着它实际上可能是`undefined`, `null`, `false`, `0`, `''`（或任何其他`Boolean(...)`返回`false`）。

所以问题是何时使用哪种检查，因为它们都会产生略有不同的结果。

检查`arguments.length`表现出“最正确”的行为，但如果有多个可选参数，则可能不可行。

测试`undefined`是下一个“最好的” - 如果函数是用一个`undefined`值显式调用的，它只会“失败”，这很可能应该被视为与省略参数相同的方式。

`||`即使提供了有效参数，使用运算符也可能触发使用默认值。另一方面，它的行为实际上可能是合乎需要的。

总结一下：*只有在你知道自己在做什么的情况下才使用它！*

在我看来，`||`如果有多个可选参数并且不想传递对象文字作为命名参数的解决方法，那么 using 也是一种方法。

另一种提供默认值的好方法`arguments.length`是通过 switch 语句的标签：

```
function test(requiredArg, optionalArg1, optionalArg2, optionalArg3) {
    switch(arguments.length) {
        case 1: optionalArg1 = 'default1';
        case 2: optionalArg2 = 'default2';
        case 3: optionalArg3 = 'default3';
        case 4: break;
        default: throw new Error('illegal argument count')
    }
    // do stuff
} 
```

这样做的缺点是程序员的意图（视觉上）不明显，并且使用了“幻数”；因此，它可能容易出错。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-04-30T18:16:37.493

如果您使用 jQuery，一个不错的选择（尤其是对于复杂的情况）是使用[jQuery 的 extend 方法](http://api.jquery.com/jQuery.extend/)。

```
function foo(options) {

    default_options = {
        timeout : 1000,
        callback : function(){},
        some_number : 50,
        some_text : "hello world"
    };

    options = $.extend({}, default_options, options);
} 
```

如果您调用该函数，则如下所示：

```
foo({timeout : 500}); 
```

选项变量将是：

```
{
    timeout : 500,
    callback : function(){},
    some_number : 50,
    some_text : "hello world"
}; 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-01-04T17:53:23.830

这是我找到测试的少数情况之一：

```
if(! argument2) {  

} 
```

工作得很好，并且在语法上具有正确的含义。

（同时限制我不允许`argument2`具有其他含义的合法空值；但这**真的很**令人困惑。）

编辑：

这是松散类型语言和强类型语言之间风格差异的一个很好的例子；以及 javascript 提供的一种风格选择。

我个人的偏好（没有针对其他偏好的批评）是极简主义。代码要说的越少，只要我保持一致和简洁，其他人就越不需要理解才能正确推断出我的意思。

这种偏好的一个含义是我不想 - 不觉得它有用 - 堆积一堆类型依赖性测试。相反，我尝试使代码具有它看起来的含义；并且只测试我真正需要测试的东西。

我在其他一些人的代码中发现的恶化之一是需要弄清楚他们是否期望在更大的上下文中实际遇到他们正在测试的案例。或者，如果他们试图测试所有可能的东西，可能是因为他们对上下文的预测不够充分。这意味着我最终需要在两个方向上彻底追踪它们，然后才能自信地重构或修改任何东西。我认为他们很有可能已经进行了各种测试，因为他们预见到了需要它们的情况（而这通常对我来说并不明显）。

（我认为这些人使用动态语言的方式有一个严重的缺点。很多时候人们不想放弃所有的静态测试，并最终伪造它。）

在比较全面的 ActionScript 3 代码和优雅的 javascript 代码时，我最明显地看到了这一点。AS3 可能是 js 体积的 3 或 4 倍，而且我怀疑可靠性至少不会更好，这仅仅是因为做出的编码决策数量（3-4X）。

正如你所说，Shog9，YMMV。:D

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2017-07-23T22:14:00.870

在 ES6 (ES2015) 中，您可以使用[默认参数](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Default_parameters)

```
function Test(arg1 = 'Hello', arg2 = 'World!'){
  alert(arg1 + ' ' +arg2);
}

Test('Hello', 'World!'); // Hello World!
Test('Hello'); // Hello World!
Test(); // Hello World!
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-01-04T17:57:44.197

存在显着差异。让我们设置一些测试用例：

```
var unused; // value will be undefined
Test("test1", "some value");
Test("test2");
Test("test3", unused);
Test("test4", null);
Test("test5", 0);
Test("test6", ""); 
```

使用您描述的第一种方法，只有第二个测试将使用默认值。第二种方法将默认除第一种以外的所有方法（因为 JS 会将`undefined`, `null`, `0`, and`""`转换为 boolean `false`。如果您要使用 Tom 的方法，则只有第四种测试将使用默认值！

您选择哪种方法实际上取决于您的预期行为。如果`undefined`允许的值不是`argument2`，那么您可能需要对第一个值进行一些更改；如果需要一个非零、非空、非空值，那么第二种方法是理想的——实际上，它通常用于快速消除考虑范围内的如此广泛的值。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2012-08-21T09:51:08.540

```
url = url === undefined ? location.href : url; 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-01-04T17:48:14.577

对不起，我还不能发表评论，所以回答汤姆的回答......在 javascript (undefined != null) == false 实际上该函数不适用于“null”，您应该使用“undefined”

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-12-30T13:01:58.737

为什么不使用`!!`运算符？这个操作符，放在变量之前，把它变成一个布尔值（如果我理解得很好的话），所以`!!undefined`and `!!null`（甚至`!!NaN`，这可能很有趣）将返回`false`。

这是一个例子：

```
function foo(bar){
    console.log(!!bar);
}

foo("hey") //=> will log true

foo() //=> will log false 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2017-03-24T18:44:49.697

还有一个[棘手的方法来查找参数是否传递给函数](https://codeschool.com/discuss/t/shaping-up-with-angularjs-level-2-challenge-9/4958/3)。看看下面的例子：

```
this.setCurrent = function(value) {
  this.current = value || 0;
}; 
```

这意味着如果 的值`value`不存在/未通过 - 将其设置为 0。

很酷哈！

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-03-05T02:22:31.240

通过使用可选属性的 Object 调用函数可以方便地进行参数检测：

```
function foo(options) {
    var config = { // defaults
        list: 'string value',
        of: [a, b, c],
        optional: {x: y},
        objects: function(param){
           // do stuff here
        }
    }; 
    if(options !== undefined){
        for (i in config) {
            if (config.hasOwnProperty(i)){
                if (options[i] !== undefined) { config[i] = options[i]; }
            }
        }
    }
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2021-08-30T12:16:20.003

有时您希望 undefined 作为可能的参数，但您仍然会遇到无法传递参数的情况。在这种情况下，您可以使用`arguments.length`来检查传递了多少参数。

```
 // Throw error if the field is not matching our expectations
function testField(label, fieldValue, expectedValue) {
    console.log(arguments) // Gives: [Arguments] { '0': 'id', '1': 1, '2': undefined }
    if(arguments.length === 2) {
        if(!fieldValue) {
            throw new Error(`Field "${label}" must have a value`)
        }
    }

    else if(expectedValue === undefined) {
        if(fieldValue !== undefined) {
            throw Error(`Field "${label}" must NOT have a value`)
        }
    }

    // We stringify so our check works for objects as well
    else {
        if(JSON.stringify(fieldValue) !== JSON.stringify(expectedValue)) {
            throw Error(`Field "${label}" must equal ${expectedValue} but was ${fieldValue}`)
        }
    }
} 
```

`testField('id', 12)`-> 通过，我们不希望 id 为空白

`testField('id', undefined, undefined)`-> 通过，我们希望 id 未定义

`testField('id', 12, undefined)`-> 错误，我们希望 id 未定义

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-05-18T19:06:28.060

有时您可能还想检查类型，特别是如果您将函数用作 getter 和 setter。以下代码是 ES6（不会在 EcmaScript 5 或更早版本中运行）：

```
class PrivateTest {
    constructor(aNumber) {
        let _aNumber = aNumber;

        //Privileged setter/getter with access to private _number:
        this.aNumber = function(value) {
            if (value !== undefined && (typeof value === typeof _aNumber)) {
                _aNumber = value;
            }
            else {
                return _aNumber;
            }
        }
    }
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-01-02T03:13:17.427

```
function example(arg) {
  var argumentID = '0'; //1,2,3,4...whatever
  if (argumentID in arguments === false) {
    console.log(`the argument with id ${argumentID} was not passed to the function`);
  }
} 
```

因为数组继承自`Object.prototype`. 考虑⇑让世界变得更美好。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2018-06-28T05:56:06.497

fnCalledFunction(Param1,Param2, window.YourOptionalParameter)

如果上面的函数是从很多地方调用的，并且你确定前 2 个参数是从每个地方传递的，但不确定第三个参数，那么你可以使用 window.

如果没有从调用者方法中定义，window.param3 将处理。

# activerecord - 如何使 ActiveRecord 在具有多列作为主键的表上工作？

> ID：411384
> 
> 赞同：0
> 
> 时间：2009-01-04T17:52:01.167
> 
> 标签：activerecord

如何在现有数据库上使用 ActiveRecord，多列作为主键，没有 ID 列？我不得不在 set_primary_key、更新和删除方法上编写扩展/黑客。但我不确定它是否适用于未来的版本。有没有办法让 ActiveRecord 在这种情况下工作而无需 hack？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-04T18:28:45.413

ActiveRecord 不支持复合主键。[这是一个](http://compositekeys.rubyforge.org/)声称添加支持的库。

# authentication - How do I interact with a kerberos server from my own application

> ID：411391
> 
> 赞同：1
> 
> 时间：2009-01-04T17:54:46.293
> 
> 标签：authentication, kerberos, access-control, gssapi

My network has a kerberos server for username/password authentication. Machines that run my application have functioning kerberos clients, so users can use kinit, etc.

How do I interact with the server programatically, from my own custom applications? The preferred language for an example is C.

I want users of my application to authenticate against a kerberos server before access to certain functions. I anticipate having to ask them for their username and password - kinit may not have been called.

The machines hosting the applications run OS X and Debian/Linux.

I believe the answer might well involve GSSAPI. If so, are there good tutorials for this?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T03:03:13.050

Sun 在他们的《[Solaris Security for Developers Guide》](http://www.oracle.com/pls/topic/lookup?ctx=solaris11&id=GSSAPIPG)一书中对此进行了介绍。对您特别有帮助的可能是[附录 A - 基于 C 的 GSSAPI 程序示例](http://docs.oracle.com/cd/E23824_01/html/819-2145/sampleprogs-1.html#scrolltoc)和[第 5 章 - GSS-API 客户端示例](http://docs.oracle.com/cd/E23824_01/html/819-2145/gssclient.html#scrolltoc)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-04T03:56:35.810

看看 Heimdal，他们有一个广泛的 kerberos API，下面的站点有一个很好的 doxygen 安装，描述了 API。

[http://www.h5l.org](http://www.h5l.org)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-04T18:04:25.743

GSSAPI is indeed the recommended approach, but the precise details will depend on your language environment and whether you need interop with Windows. Is your kerberos provider Windows or something else?

On Windows, Kerberos is a native protocol supported by the OS, and many high level Win32 APIs will effectively give you it for free. Making it interop with a non Windows kerberos server is possible but not trivial.

On UNIX, you may first need to install kerberos client support and get that working - but if your network already has a kerberos server, this may have been done for you already.

Windows includes an implementation of GSSAPI as does Java, and most UNIX flavors have an implementation. I believe GSSAPI addons are available for PHP also.

If you can add more specifics on your requirements I can firm this answer up a bit.

# javascript - 如何在 DIV 标签上使用 javascript onclick 来切换包含可点击链接的部分的可见性？

> ID：411396
> 
> 赞同：8
> 
> 时间：2009-01-04T17:59:02.493
> 
> 标签：javascript, css, prototypejs, scriptaculous

嗨，我有一个 DIV 部分，最初只有其标题可见。我想要实现的是，当访问者单击 div 区域上的任意位置时，`toggle_section`会`toggle_stuff`在可见/隐藏之间切换。

```
<div id="toggle_section" 
     onclick="javascript: new Effect.toggle('toggle_stuff', 'slide');">
    <div id="toggle_title">Some title</div>
    <div id="toggle_stuff">
        some content stuff
        <a href="/foo.php">Some link</a>
    </div>
</div> 
```

但是，按照现在的设置方式，如果我在`<a>`中有任何链接`toggle_section`，单击该链接也将执行 onclick 事件。

那么我的问题是设置这种行为的最佳方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-04T19:01:29.247

最简单的解决方案是在 DIV 中**的链接中添加一个额外的 onclick 处理程序，以**停止事件传播：

```
<div id="toggle_section" 
     onclick="javascript: new Effect.toggle('toggle_stuff', 'slide');">
    <div id="toggle_title">Some title</div>
    <div id="toggle_stuff">
        some content stuff
        <a href="/foo.php"
            onclick="Event.stop(event);"
        >Some link</a>
    </div>
</div> 
```

上面的示例使用 Prototype 的[`Event.stop()`](http://www.prototypejs.org/api/event/stop)函数来促进跨浏览器事件传播停止。

当您使用内联`onclick()`处理程序时，大多数（如果不是全部）浏览器将首先在冒泡阶段遍历事件（这是您想要的）。

可以在出色的[Quirksmode中找到了解此行为背后的实际原因以及](http://www.quirksmode.org/js/events_order.html)*事件捕获*和*事件冒泡*之间差异的一个很好的指南。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-24T16:37:22.630

在脚本中：

```
function overlayvis(blck) {
  el = document.getElementById(blck.id);
  el.style.visibility = (el.style.visibility == 'visible') ? 'hidden' : 'visible';
} 
```

激活器链接，后跟内容（页面上没有其他原因）：

```
<div onclick='overlayvis(showhideme)">show/hide stuff</div>
<div id="showhideme">
  ... content to hide / unhide ...
</div> 
```

我从[模态窗口 javascript css 覆盖](https://stackoverflow.com/questions/6578427/modal-window-javascript-css-overlay)中得到了这个- 必须搜索源并且很高兴发现它是这个站点。:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-04T19:40:12.167

在我发布了我的第一个问题后，我迫不及待地想再次考虑它，似乎我找到了一种非常简单的方法来实现这一点。

我已将 onlick 移动`Effect.toggle`到一个单独的函数中，例如：

```
function someClick(event) {
    if (event.target.nodeName == 'A') {
        return;
    } else {
        new Effect.toggle('toggle_stuff', 'slide');
    }
} 
```

我想这仅适用于`A`标签，但不适用于其他任何可点击的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-04T18:38:58.733

我真的不知道这是否可行，但尝试给链接元素一个`z-index`比 toggle_section div 更大的值。

就像是 ：

```
#toggle_section a { z-index: 10; } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-12-13T11:33:42.513

添加 onclick 处理程序以停止事件传播。

使用 JQuery：onclick="event.stopPropagation()"

使用原型：onclick="Event.stop(event)"

# cocoa-touch - 限制 UITextView 中的文本

> ID：411398
> 
> 赞同：5
> 
> 时间：2009-01-04T17:59:42.367
> 
> 标签：cocoa-touch

我正在尝试将文本输入限制到可可触摸中的 UITextView 中。我真的想限制行数而不是字符数。到目前为止，我有这个来计算行数：

```
- (BOOL)textView:(UITextView *)textView shouldChangeTextInRange:(NSRange)range replacementText:(NSString *)text {
    if([text isEqualToString:@"\n"]) {
        rows++;
    }
    NSLog(@"Rows: %i", rows);
    return YES;
} 
```

但是，如果自动换行而不是用户按回车键，这将不起作用。有没有办法检查文本是否类似于检查“\n”？

谢谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-08T06:10:59.830

不幸的是，使用 NSString -stringWithFont:forWidth:lineBreakMode: 不起作用-无论您选择哪种换行模式，文本都会以小于当前宽度的宽度换行，并且任何溢出行的高度都变为 0。为了得到一个真实的数字，把绳子装进一个比你需要的框架高的框架里——然后你会得到一个比你的实际高度更大的高度。

请注意我的软糖（从宽度中减去 15）。这可能与我的观点有关（我有另一个观点），所以你可能不需要它。

```
- (BOOL)textView:(UITextView *)aTextView shouldChangeTextInRange:(NSRange)aRange replacementText:(NSString*)aText
{
        NSString* newText = [aTextView.text stringByReplacingCharactersInRange:aRange withString:aText];

        // TODO - find out why the size of the string is smaller than the actual width, so that you get extra, wrapped characters unless you take something off
        CGSize tallerSize = CGSizeMake(aTextView.frame.size.width-15,aTextView.frame.size.height*2); // pretend there's more vertical space to get that extra line to check on
        CGSize newSize = [newText sizeWithFont:aTextView.font constrainedToSize:tallerSize lineBreakMode:UILineBreakModeWordWrap];

        if (newSize.height > aTextView.frame.size.height)
            {
            [myAppDelegate beep];
            return NO;
            }
        else
            return YES;
} 
```

# url - 在 URL 中包含 ID 是否可以？

> ID：411407
> 
> 赞同：3
> 
> 时间：2009-01-04T18:06:00.873
> 
> 标签：url, seo, slug

好吧，我的问题很简单。

ID 是否会影响网页在 Google 上的位置？我有这样的链接 `http://example.com/news/title-slug/15/` ，人们对我说我应该从 URL 中删除 ID。

我相信那不是真的。按照我的逻辑，你不能依赖标题的蛞蝓。我知道如果没有两个具有相同标题的页面，它应该可以正常工作，但是如果 ID 在那里没有任何伤害，我为什么要删除它。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-04T18:16:28.030

是的，把它放在那里。

谷歌没有业务试图猜测 URL 的每个元素代表什么并基于此更改其索引。

URL 本质上可以映射到任何资源，我很确定 Google 能够识别这一点。您应该做的就是通过使用重定向确保多个 URL 没有相同的内容。因此，例如，`http://example.com/news/wrong-title-slug/15/`应该重定向回`http://example.com/news/title-slug/15/`而不是仅仅回显同一页面。谷歌真的不喜欢重复的内容。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-04T18:53:50.043

It's fine.

But I would not put that behind the title-slug though. Some url might get more confusing than the others.

```
http://example.com/entry/how-to-solve-question-45/15 
```

a better one would be :

```
http://example.com/entry/15/how-to-solve-question-45 
```

Besides, you can't really rely on just the title-slug, because changing the title of an entry means breaking user's bookmark. Not to mention that it is faster to retrieve an entry from the database by an integer ID instead of an url-slug.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-10T01:50:46.197

The problem here is not whether Google will accept it, but whether or not doing so is user-friendly.

A common reason for keeping the ID in a URL is to ensure that the URL is unique. For example, if two people on here were to create a question named "Jon Skeet Facts" we'd have a problem, whereas with the ID the users are aware that they are two different questions with the same title. This is the same as with relational databases where a unique identifier is required.

In essence, why care what Google thinks? The whole Search Engine Optimisation industry is a farce, and this is coming from someone who has been paid more than once as a SEO Consultant. Why follow what Google wants when you can map Google's intentions by making your website perfect for the user? If you make a good website Google will reward you. The ID has a reason to be there, so keep it in.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-04T18:09:28.463

我认为你可以把它留在里面。当你得到用于识别的元素和用于描述的元素时，这似乎是有道理的。毕竟是在这里完成的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-04T18:24:04.737

宙斯不会因此而打倒你。我不想在那里有无意义的数字，因为它不是很有吸引力或语义。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-04T22:48:10.460

拥有 id 不会损害您的 SEO 排名。有 slug 确保页面的主要关键字将被索引，所以一切都很好。

# html - 如何将数据（表单）发布到 html 页面并在中间劫持数据？

> ID：411408
> 
> 赞同：1
> 
> 时间：2009-01-04T18:06:13.510
> 
> 标签：html, forms, post

网站地址：[http ://www.ynet.co.il/YediothPortal/Ext/TalkBack/CdaTalkBack/1,2497,L-3650194-0-68-544-0--,00.html](http://www.ynet.co.il/YediothPortal/Ext/TalkBack/CdaTalkBack/1,2497,L-3650194-0-68-544-0--,00.html)

1.  用垃圾填满表格。
2.  点击“发送”
3.  表单将数据发布到另一个 HTML，而不对我刚刚添加的数据进行任何解析

他们是如何做到的呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-04T18:23:37.560

一个可能的选择是他们使用的是内容管理系统，其中 URL 上的“html”实际上并不意味着它是静态 html 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-04T18:22:51.697

根据澄清的问题进行编辑：

许多框架可以配置为拦截 html 请求——例如，asp.net 可以设置为处理任何给定的扩展，而 HTTPModule 可以对此做任何事情。它决定如何处理任何请求实际上取决于 Web 服务器配置。

*另外：你真的不想说“劫持”*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-04T18:29:25.850

这可能超出了左侧字段，但我确实使用了偶尔的 JS 函数来获取标题中的所有内容，然后对其进行解析或使用 AJAX 将其传递给另一个脚本。

我有时会在 404.html 页面中使用此方法来获取前一页的标题，将它们解析出来以查看有人*试图*去哪里并重定向它们。

也就是说，正如 annakata 所说，这是众多可用选项之一。

# linux - Linux Dev 上的 Subversion 存储库

> ID：411410
> 
> 赞同：5
> 
> 时间：2009-01-04T18:07:49.887
> 
> 标签：linux, svn, security

在 linux 开发机器上设置 subversion 存储库的最佳实践是什么。外部用户需要能够访问特定的存储库，但机器上没有其他内容。我知道一个答案是建立一个专用的存储库，但我正在寻找一个单机解决方案：存储库的位置、帐户、备份过程。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-04T18:21:49.267

Subversion 的流行访问方法之一是通过 Apache 模块。您可以在目录级别设置不同的权限来控制访问。请参阅[选择服务器配置](http://svnbook.red-bean.com/en/1.5/svn.serverconfig.choosing.html)和[httpd，即 Apache HTTP 服务器](http://svnbook.red-bean.com/en/1.5/svn.serverconfig.httpd.html)。对于身份验证，我建议使用外部身份验证源，例如 Microsoft AD，通过[`mod_auth_sspi`](http://sourceforge.net/projects/mod-auth-sspi/).

如果您需要混合和匹配权限，请参阅我对[如何使用 SVN 仅显示某些文件夹](https://stackoverflow.com/questions/335039/how-can-i-make-only-some-folders-show-up-for-certain-developers-with-svn#336312)的答案。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-05T07:49:46.500

我在一家 IT 运营基础设施自动化公司工作；我们一直这样做。

存储库位置：我们默认使用“/srv/svn”来存储所有 SVN 存储库，除非客户有特定要求，例如现有存储库可能存储在 ReadyNAS 共享文件系统上。

帐户：我们所有的客户都使用 LDAP。要么是在主控主机上运行的 OpenLDAP 服务器，要么是 Active Directory，因为一些客户在他们的办公室中有一个 Windows 域，我们也可以配置它。开发人员可以访问“SCM”组（通常是 svn、git 或 devel）和“deploy”组。这些组仅有权登录和执行与 SCM 相关的活动（即，根据组所有权将提交写入 repo），或将应用程序部署到生产环境。

备份程序：我们使用 svnadmin hotcopy，除非客户已经准备好了（通常是 svnadmin dump，呵呵）。

```
svnadmin hotcopy /srv/svn /srv/svn_backups/$(date +%Y%m%d) 
```

要访问 repo，通常是简单的 svn+ssh。一些客户已经安装了 Apache，但数量不多。我推荐 SSH。开发人员推出他们的公共 ssh 密钥，一切都很好。LDAP 用户管理几乎不需要维护（**唯一**的方法）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-04T18:33:13.017

我建议查看[subversion book 中关于服务器配置的章节](http://svnbook.red-bean.com/en/1.5/svn.serverconfig.choosing.html)。它会就哪种配置更适合您的使用提出建议。

对于它的价值，使用独立的 svn 守护程序设置存储库非常简单。烦人的事情是管理用户权限。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-14T09:16:32.193

我有一篇[博客文章](http://www.technical-recipes.com/2011/how-to-set-up-a-linux-based-subversion-svn-server/)描述了设置和启动基于 Linux 的 Subversion 服务器以维护代码存储库等所需的步骤。

基本上步骤是：

1.  [下载](http://linux.softpedia.com/progDownload/Subversion-Download-3007.html)Subversion 压缩包。
2.  解压并安装 Subversion。
3.  处理运行时出现的任何安装问题`./configure`（如果有）。
4.  使用 . 创建 Subversion 存储库`svnadmin create`。
5.  使用您选择的文本编辑器编辑存储库配置文件。
6.  同上密码文件。
7.  使用 . 将您的代码、项目等导入存储库`svn import`。
8.  将服务器作为守护进程启动，例如`svnserve -d`. 也可以让它在重新启动时自动执行此操作。
9.  使用标准 Subversion 命令开始使用它，例如签出、签入、备份等...

# sql - 灵活匹配许多数据库记录（类似 Quicksilver 或 Launchy 的匹配）

> ID：411411
> 
> 赞同：7
> 
> 时间：2009-01-04T18:08:36.033
> 
> 标签：sql, mysql, database, algorithm, search

假设我有一个包含许多名称的数据库表。我想对这些名称进行“灵活匹配”。我不确定“灵活匹配”是否是正确使用的术语，但现在让我们一起去吧。关于“模糊匹配”也有[类似的](https://stackoverflow.com/questions/369755/how-do-i-do-a-fuzzy-match-of-company-names-in-mysql-with-php-for-auto-complete) [讨论](https://stackoverflow.com/questions/309479/how-to-find-best-fuzzy-match-for-a-string-in-a-large-string-database)，但我对语音匹配并不真正感兴趣。我对所谓的有序子集匹配感兴趣。

我希望它类似于 QuickSilver (OSX) 或 Launchy (Windows)。以下是给定搜索字符串的一些匹配示例：

*mit* ⇒麻省理工学院**ffox** ⇒ *Fire* **fox** *osx* **⇒** Mac OS **X** *ms* ⇒微软公司**_** **_** _ **_** _ **_**

 *********我的最终目标是拥有一个带有自动完成文本字段的网页，该文本字段是从服务器驱动的数据。

我相信通过结合[jQuery LiveUpdate](http://ejohn.org/blog/jquery-livesearch/)和/或[jQuery QuickSelect](http://github.com/dcparker/jquery_plugins/tree/master/quickselect)的功能，我将在客户端获得足够的结果。

我需要帮助的地方是如何最好地处理服务器端对大桌子的弹性匹配。[我对如何使用 Quicksilver评分](http://code.google.com/p/blacktree-alchemy/source/browse/trunk/Crucible/Code/NSString_BLTRExtensions.m) [算法](http://orderedlist.com/demos/quicksilverjs/javascripts/quicksilver.js)和一些排列索引逻辑构建自己的自定义索引有一些想法，但如果有其他可用的东西，我宁愿不重新发明轮子。

**总结：** *针对具有多行的数据库表获得快速弹性匹配的最佳方法是什么？*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-14T01:10:11.897

这并不能直接回答我的问题，但是对于我正在从事的项目，我意识到我还不*需要**服务器*端组件。为了方便我的 Web 应用程序的客户端，我刚刚启动了两个新的开源项目：

 **   [LiquidMetal](http://github.com/rmm5t/liquidmetal/tree/master)：这是一种类似于 Quicksilver 的评分算法，可以根据缩写对字符串进行评分。在构建索引时很有用。
*   [Flexselect](http://rmm5t.github.com/jquery-flexselect/)：一个 jQuery 插件，可以将选择框变成与 flex 匹配的增量查找控件。把它想象成 Quicksilver 挤进一个选择框。它使用 LiquidMetal 对实时结果进行过滤和排序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T16:35:07.843

一种方法是只进行 LIKE 匹配。在每个字符之间，然后在字符串之前和之后放置一个 %，然后根据它进行搜索。显然，这将为**ms**引入其他内容，例如“**多媒体**系统”，但您可以将其与另一个包含“建议”匹配的表配对，并按这些匹配进行排序**。**

# excel - SSRS：从 Excel 文件查询数据时出错（通过 ODBC）

> ID：411413
> 
> 赞同：3
> 
> 时间：2009-01-04T18:10:39.147
> 
> 标签：excel, reporting-services, odbc, dsn

我正在尝试使用`SSRS`. 数据在 Excel 工作表中。我已经设置了一个用户 DSN 并在`SSRS`using中创建了一个数据源`ODBC`。

我可以在`Data`选项卡中查询 excel。但是，在尝试预览时，出现以下错误：

> 错误 [hy000] [microsoft] [odbc excel driver] 用于查看链接的 Microsoft Excel 工作表的连接丢失。

任何人都知道为什么会发生这种情况以及如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T01:48:36.740

我会考虑创建一个 SQL Sever Integration Services 包以将数据从 Excel 导入 SQL 数据库，并将该数据库用作报表的数据源。可以安排 SSIS 包定期刷新数据。使用 Excel 等基于文件的数据源容易受到人们修改电子表格结构以及移动、删除或锁定文件的影响。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-04T20:04:36.017

似乎是一个稍纵即逝的错误。我删除了数据集，创建了一个新数据集并再次重新运行。有效。

# c++ - C++ 中指向 void 的指针？

> ID：411422
> 
> 赞同：11
> 
> 时间：2009-01-04T18:15:40.963
> 
> 标签：c++, pointers, void, void-pointers

我正在阅读[Ogre3D](http://www.ogre3d.org)实现中的一些代码，但我无法理解`void *`类型变量的含义。`void`C++中的指针是什么意思？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-01-04T18:20:43.650

指向 void 的指针，`void*`可以指向任何对象：

```
int a = 5;
void *p = &a;

double b = 3.14;
p = &b; 
```

你不能取消引用、增加或减少那个指针，因为你不知道你指向什么类型。这个想法是`void*`可以用于像`memcpy`这样的功能，只是复制内存块，而不关心它们复制的类型。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-04T18:18:48.930

它只是一个通用指针，用于在您不知道类型时传递数据。您必须将其转换为正确的类型才能使用它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-04T18:17:41.113

它是指向内存中某个位置的原始指针。它不允许任何指针算术，如 char * 或 int *。

以下是一些使用示例

[http://theory.uwinnipeg.ca/programming/node87.html](http://theory.uwinnipeg.ca/programming/node87.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-04T18:20:31.530

它是一个指向*任何东西*的指针——只是一块你可以玩的内存——可能是一个对象，也可能是一个字符。你必须强制转换才能用它做任何有用的事情。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-04T21:14:18.217

[以我之前的帖子为基础...](https://stackoverflow.com/questions/406010/passing-pointer-to-an-array-of-arrays-through-function#406274)

* * *

**注意：**这里所有的内存地址都是虚构的。我只是为了说明一个观点而编造它们。

* * *

鉴于：

```
int data[] = {10,11,12}; 
```

我们现在有：

```
0xffff0000-0xffff0003  with a value of (int)(10)
0xffff0004-0xffff0007  with a value of (int)(11)
0xffff0008-0xffff000b  with a value of (int)(12) 
```

（我**不**打算在这里讨论大端字节序和小端字节序。）

如果我们有：

```
int * p = data; 
```

我们现在在其他地方有了另一个内存位置，比如说：

```
 0xaaaa0000-0xaaaa0003  with a value of (int*)0xffff0000 
```

我们可以使用*p[1]* [或 *(p + 1)] 将 *(int*)(0xffff0004) [=11] 称为 sizeof(int)=4 和 0xffff0000+sizeof(int) = 0xffff0004。

如果我们有：

```
void * v = data; 
```

我们现在在其他地方有了另一个内存位置，比如说：

```
 0xbbbb0000-0xbbbb0003  with a value of (void*)0xffff0000. 
```

但是， void 没有任何关联的 sizeof() 信息。我们不能增加或减少指针。我们无法取消引用以访问存储在 0xffff0000 中的数据。我们只能将该值用作原始内存地址。

如果我们想使用存储在 (void*)0xffff0000 中的数据，我们首先需要将其转换为适当的类型。

也就是说， (void *) 作为一种将地址传递给任意数据结构的方法仍然非常有用。例如，memset()。我是否将*struct tm*或*struct sockaddr*归零并不重要。我们只需要一个指向结构及其大小的指针。

（这应该不言而喻，但是......当心使用 memset 将类实例归零，并且这样做会覆盖虚拟指针表。）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-04T23:17:31.227

void 指针不能指向 C++ 中的类成员。

# iphone - 当 iPhone 进入待机模式时，iPhone 应用程序会发生什么？

> ID：411436
> 
> 赞同：24
> 
> 时间：2009-01-04T18:23:37.390
> 
> 标签：iphone, cocoa-touch, xamarin.ios

我的应用程序使用 NSTimer，当 iPhone 进入待机模式（通过按下硬件按钮或空闲计时器）时，NSTimer 似乎不会触发。

当我再次激活 iPhone 时，我的应用程序仍在前台。当 iPhone 处于待机模式时，第三方应用程序会发生什么？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-02-05T14:36:54.160

虽然在这里并不明显，但我相信原始发帖人确实通过在 iPhone 开发者论坛中启动一个线程（[可在此处获得](https://devforums.apple.com/message/23294#23294)）找到了他的问题的答案（我最终不得不找到自己，因为信息未在此处共享）。

如果其他人有同样的问题并在将来找到该页面，这里有一个有用的回复，由 Apple 论坛上的某个人发布，名为“eskimo1”（我对其进行了轻微编辑，以便在没有上下文的情况下更容易阅读由整个原始线程提供）：

*   关于 iPhone 应用程序状态术语，“活动”并不意味着“唤醒”，它意味着“附加到 GUI”。认为它类似于 Mac OS X 中的“最前面”。当您锁定设备时，您的应用程序会停用，但设备可能会或可能不会进入睡眠状态
*   如果设备连接到主电源（即通过 USB），iPhone OS 很少休眠。但是，如果使用电池运行，它可以休眠。
*   屏幕锁定后的一小段时间（根据 Oliver Drobnik 的说法是 20 秒），设备进入睡眠状态。这就像合上笔记本电脑的盖子一样；主 CPU 上的所有活动都停止。
*   如果设备在正确的音频会话中播放音频，则不会发生这种情况。有关详细信息，请参阅[DTS Q&A QA1626“音频会话 - 确保屏幕锁定时继续播放音频”](http://developer.apple.com/iphone/library/qa/qa2008/qa1626.html)。
*   请注意，idleTimerDisabled 属性（可以打开以防止在应用程序运行时关闭屏幕）是关于在用户不活动后锁定屏幕。它与系统睡眠没有直接关系（它间接相关，因为系统可能在锁定后不久就进入睡眠状态）。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-04T19:34:04.080

请参阅*iPhone OS 编程指南*中的*应用程序中断*，尤其是和事件。（整个指南当然值得一读。）当您忽略这些事件时，计时器似乎会持续一段时间然后停止。听起来合乎逻辑，如果继续运行，应用程序很容易耗尽电池电量。应用程序到底发生了什么？我猜它根本没有获得任何 CPU 时间——它会在您重新“打开”机器时冻结并解冻。</p> *`applicationWillResignActive``applicationDidBecomeActive`*

 ** * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-10T23:57:26.443

我的第一个建议是不要禁用空闲计时器，这只是一个 hack。如果您想在 UI 事件期间保持计时器处于活动状态，请使用 NSCommonModes 在当前运行循环上运行计时器：

```
// create timer and add it to the current run loop using common modes

self.timer = [NSTimer timerWithTimeInterval:.1 target:self selector:@selector(handleTimer) userInfo:nil repeats:YES];
[[NSRunLoop currentRunLoop] addTimer:self.timer forMode:NSRunLoopCommonModes]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-01T13:52:36.593

我最近在我正在开发的一个应用程序中遇到了这个问题，该应用程序使用多个计时器并播放一些音频提示并进行了两个相对简单的更改：

1.  在`AppDelegate`我实现了以下方法，并且仅存在允许应用程序在屏幕锁定时继续

    ```
    // this receives the notification when the device is locked
    - (void)applicationWillResignActive:(UIApplication *)application
    { 
    }

    // this receives the notification that the application is about to become active again
    - (void)applicationWillBecomeActive:(NSNotification *)aNotification
    {
    } 
    ```

    参考： API 文档中的[UIApplicationDelegate 协议参考](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIApplicationDelegate_Protocol/Reference/Reference.html)和[NSApplication 类参考](http://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/NSApplication_Class/)（可通过 Xcode 访问，只需搜索`applicationWillBecomeActive`）。

2.  制作主`viewcontroller`类`AVAudioPlayerDelegate`并使用 Apple 的“AddMusic”示例中的此代码使应用程序播放的音频警报很好地混合到 iPod 音频等中......

    我只是将此代码放入 viewDidLoad 期间调用的方法中。如果您对此感兴趣，那么您属于“谁应该阅读此文档”类别：[Audio Session Programming Guide](http://developer.apple.com/iPhone/library/documentation/Audio/Conceptual/AudioSessionProgrammingGuide/Introduction/Introduction.html)

    ```
    // Registers this class as the delegate of the audio session.
    [[AVAudioSession sharedInstance] setDelegate: self];

    // The AmbientSound category allows application audio to mix with Media Player
    // audio. The category also indicates that application audio should stop playing 
    // if the Ring/Siilent switch is set to "silent" or the screen locks.
    [[AVAudioSession sharedInstance] setCategory: AVAudioSessionCategoryAmbient error: nil];

    // Activates the audio session.
    NSError *activationError = nil;
    [[AVAudioSession sharedInstance] setActive: YES error: &activationError]; 
    ```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-01-08T07:06:03.207

我将这篇文章中的信息用于我正在构建的一个小样本。这是我在启动播放以防止音频停止时使用的代码：

```
AudioSession.Category = AudioSessionCategory.MediaPlayback; 
```

当应用程序完成播放以重置为原始值时：

```
AudioSession.Category = AudioSessionCategory.SoloAmbientSound; 
```

完整样本在这里：

[http://github.com/migueldeicaza/monotouch-samples/tree/master/StreamingAudio/](http://github.com/migueldeicaza/monotouch-samples/tree/master/StreamingAudio/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-14T06:04:17.057

我相信您的应用程序在暂停时应该可以正常运行。（想想潘多拉电台）

检查您的计时器是否由于您的视图被隐藏或发生其他事件而被取消分配。

# java - 如何显示方法是否可能返回 null

> ID：411447
> 
> 赞同：50
> 
> 时间：2009-01-04T18:30:15.740
> 
> 标签：java, null, design-by-contract

在发布[了这个问题](https://stackoverflow.com/questions/410890/how-to-trace-a-nullpointerexception-in-a-chain-of-getters "如何在 getter 链中跟踪 NullPointerException？")并阅读[了](https://stackoverflow.com/questions/271526/How-to-avoid-null-statements-in-java "如何避免java中的空语句？")这个问题之后，我意识到知道一个方法是否应该返回 null 或者这是否被认为是错误条件并且应该抛出异常是非常重要的。还有一个很好的讨论何时[返回 'null' 或抛出异常](https://stackoverflow.com/questions/175532/return-null-or-throw-exception)。

**我正在编写一个方法，并且我已经知道是否要返回 null 或抛出异常，表达我的决定的最佳方式是什么，换句话说，记录我的合同？**

我能想到的一些方法：

*   把它写在规格/文档中（有人会读吗？）
*   使其成为方法名称的一部分（正如我[在这里](https://stackoverflow.com/questions/175532/return-null-or-throw-exception#411400 "回答“返回 null 或抛出异常”")建议的那样）
*   假设每个*抛出*异常的方法都*不会*返回 null，而每个“不”抛出的方法都*可能*返回 null。

我主要是在谈论 java，但它也可能适用于其他语言：为什么有一种正式的方式来表达是否会抛出异常（`throws`关键字），但没有正式的方式来表达是否可能返回 null？

为什么没有这样的东西：

```
public notnull Object methodWhichCannotReturnNull(int i) throws Exception
{
    return null; // this would lead to a compiler error!
} 
```

## 总结与结论

合同的表达方式有很多种：

*   如果您的 IDE 支持它（如 IntelliJ），最好使用注释，`@NotNull`因为它对程序员可见并且可用于自动编译时检查。Eclipse有一个[插件](http://groups.csail.mit.edu/pag/jsr308/eclipse/)可以添加对这些的支持，但它对我不起作用。
*   如果这些不是一个选项，请使用类似`Option<T>`or的自定义类型`NotNull<T>`，这可以增加清晰度并至少进行运行时检查。
*   无论如何，在 JavaDoc 中记录合同永远不会有害，有时甚至会有所帮助。
*   使用方法名称来记录返回值的可*空性*不是由我以外的任何人提出的，尽管它可能非常冗长且并不总是有用，但我仍然相信有时它也有其优点。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-01-04T18:53:07.020

一个很好的后续问题。我认为`null`一个真正特殊的值，如果一个方法可以返回`null`它必须在 Javadoc 中清楚地记录它时（`@return some value ..., or null if ...`）。在编码时我是防御性的，并假设一个方法可能会返回`null`，除非我确信它不能返回（例如，因为 Javadoc 是这样说的。）

人们意识到这是一个问题，建议的解决方案是使用注释以一种可以自动检查的方式来说明意图。请参阅[JSR 305：软件缺陷检测注释](http://jcp.org/en/jsr/detail?id=305)、[JSR 308：Java 类型注释](http://jcp.org/en/jsr/detail?id=308)和[JetBrain 的 Nullable How-To](http://www.jetbrains.com/idea/documentation/howto.html)。

您的示例可能看起来像这样，并被 IDE、编译器或其他代码分析工具拒绝。

```
@NotNull
public Object methodWhichCannotReturnNull(int i) throws Exception
{
    return null; // this would lead to a compiler error!
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-04T18:45:10.107

您可以使用该[`Option`](http://functionaljava.googlecode.com/svn/artifacts/2.17/javadoc/fj/data/Option.html)类型，它非常类似于具有零个或一个元素的列表。返回类型 of`Option<Object>`表示该方法可能返回一个`Object`，或者它可能返回一个特殊的类型值`None`。这种类型是用更好的类型检查替代使用 null 的。

例子：

```
public Option<Integer> parseInt(String s) {
   try {
      return Option.some(Integer.parseInt(s));
   }
   catch (Exception e) {
      return Option.none();
   }
} 
```

如果您始终使用它，则可以打开 IDE 空警告，或者只使用 grep ，如果您在通常使用文字的任何地方使用`null`它，则根本不应该出现在您的代码中。`Option.none()``null`

`Option`Scala 是标准的，它`Maybe`在 Haskell 中被调用。上面的链接指向一个名为[Functional Java](http://functionaljava.org)的库，其中包含它。该版本实现了`Iterable`接口，并具有可以让您很好地组合事物的单子方法。例如，在以下情况下提供默认值 0 `None`：

```
int x = optionalInt.orSome(0); 
```

你可以替换这个...

```
if (myString != null && !"".equals(myString)) 
```

...有了这个，如果你有`Option<String>`...

```
for (String s : myOptionString) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-04T18:51:50.563

[IntelliJ IDEA 中对 @Nullable 和 @NotNull 注释](http://www.jetbrains.com/idea/documentation/howto.html)有一些支持。还有一些关于将这些注释（或类似功能）添加到 Java 7 的讨论。不幸的是，我不知道这已经走了多远，或者它是否仍然在轨道上。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-04T18:53:38.343

确实：在我们的框架中，我们有一个“非空”指针类型，可以返回它以指示该方法将始终返回一个值。

我看到三个选项：

1.  等待语言支持来表达它（例如[C# ?!](https://stackoverflow.com/questions/411447/how-to-show-if-a-method-may-return-null#411465)的东西）
2.  使用 Aspect Orientation 构建您自己的语言扩展来表达它
3.  使用自定义类型来表达它
4.  （但建立在开发者合作的基础上）使用命名方案来表示它

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-04T20:43:23.020

对于 Java，可以使用方法的 Javadoc 描述来记录返回值的含义，包括它是否可以为 null。正如已经提到的，注释也可以在这里提供帮助。

另一方面，我承认我不认为 null 是值得害怕的。在某些情况下，“没人在家”是一个有意义的条件（尽管 Null Object 技术在这里也有真正的价值）。

尝试对空值调用方法肯定会导致异常。但尝试除以零也是如此。这并不意味着我们需要开展一场消除零的运动！这只是意味着我们需要了解方法的约定，并使用它返回的值做正确的事情。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-04T18:36:36.413

你看过[Spec#](http://research.microsoft.com/en-us/projects/specsharp/)吗？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-04T18:43:16.133

您可以编写自己的注释 (Java) 或属性 (C#) 来指示返回值可能为空。没有任何东西会自动检查它（尽管 .NET 4.0 将有此类事情的[代码协定](http://research.microsoft.com/en-us/projects/contracts/)），但它至少会充当文档。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-04T18:58:48.660

也许您可以定义一个名为“NotNull”的泛型类，这样您的方法可能类似于：

```
public NotNull<Object> methodWhichCannotReturnNull(int i) throws Exception
{
   // the following would lead to a run-time error thown by the
   // NotNull constructor, if it's constructed with a null value
   return new NotNull<Object>(null);
} 
```

这仍然是运行时（不是编译时）检查，但是：

*   在方法的实现中抛出（不是调用代码的错误）
*   它是自我记录的（调用者知道他是`NotNull<T>`作为返回类型得到的）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-04T20:48:17.147

不惜一切代价避免依赖 JavaDocs。人们只有在签名看起来不是微不足道且不言自明的情况下才会阅读它们（这是不好的开始），而那些真正费心阅读它们的人不太可能在 null 上犯错，因为他们目前更加小心.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-04T18:45:37.407

如果您使用的是 Java 5+，则可以使用自定义注解，例如 @MayReturnNull

**更新**

除了所有的编码理念（返回 null、使用异常、断言、yada yada），我希望以上内容能回答您的问题。除了具有默认值的原语之外，复杂类型可能为空，也可能不为空，您的代码需要处理它。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-04T19:03:15.627

一般来说，我会假设默认情况下返回 null 值违反了 API 的约定。几乎总是可以设计您的代码，以便在“正常”执行流程期间永远不会从您的 API 返回空值。（例如，检查 foo.contains(obj) 而不是调用 foo.get(obj) 并为 null 设置一个单独的分支。或者，使用[Null 对象模式](http://en.wikipedia.org/wiki/Null_Object_pattern)。

如果您不能以这种方式设计您的 API，我会清楚地记录何时以及为什么会抛出 null ——**至少**在 Javadoc 中，并且可能还使用自定义 @annotation，例如其他几个答案所建议的。

# c# - 如何刷新 Windows 窗体控件的简单绑定？

> ID：411457
> 
> 赞同：2
> 
> 时间：2009-01-04T18:38:09.327
> 
> 标签：c#, .net, binding

我使用以下方法将域对象属性绑定到 System.Windows.Forms.Label 的 Text 属性`DataBindings`：

```
Label l = new Label();
l.DataBindings.Add(new Binding("Text",myDomainObject,"MyProperty")); 
```

但是，当我更改域对象时，标签不会反映更改。我知道对于像 DataGridView 这样的复杂控件，可以使用可以调用 ResetBindings 的 BindingSource 来完成绑定，但是在 Label 的简单情况下我找不到任何方法来更新绑定。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2011-02-23T19:39:11.700

`INotifyPropertyChanged`肯特有正确的答案，但我想在应用界面上添加一点花絮。

要轻松引发事件，请尝试此操作

```
protected void OnPropertyChanged<T>(Expression<Func<T>> property)
{
    if (this.PropertyChanged != null)
    {
        var mex = property.Body as MemberExpression;
        string name = mex.Member.Name;
        this.PropertyChanged(this, new PropertyChangedEventArgs(name));
    }
} 
```

并像这样应用它

```
{ // inside some method or property setter
    OnPropertyChanged(() => this.MyProperty);
} 
```

这比通过名称指定属性更好的唯一原因是，如果您重构，或者只是更改属性的名称，您不必手动更改实现，而是可以让编译器自动重命名所有引用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-04T18:56:34.000

您的域对象应该实现[INotifyPropertyChanged](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx)以便绑定知道基础属性何时更改。

# wcf - EF entites via WCF problem

> ID：411459
> 
> 赞同：1
> 
> 时间：2009-01-04T18:41:33.580
> 
> 标签：wcf, entity-framework

I've created a WCF service based on an Entity Framework model. When I consume the service from a console app, a WinForm app, and a WPF app, everything just works. I can see the entites and can add/delete/etc. However, when I try to consume the same WCF service from a web app, I get errors stating that the entities are not recognized. Looks like the edm is not being included in the service refernce in this case. Suggestions? Thx.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-04T19:39:32.760

Think I stumbled on the answer. I was naming the service reference in my web app the same as my edm, which doesn't seem to bother the console app, WinForm app, and a WPF app, but does cause the problem with the web app. Curious. Any insights?

# http - Use HTTP Keep-Alive for server to communicate to client

> ID：411460
> 
> 赞同：16
> 
> 时间：2009-01-04T18:41:37.573
> 
> 标签：http, chat, keep-alive

Recently in an interview I was asked how I would approach an online chat client application. I went through the standard "polling" solution but was cut off because the interviewer was looking for the "HTTP 1.1 keep-alive" method. Having used HTTP for quite a while and remembering that the whole point was to be "stateless", this never occurred to me (also, not to mention that the keep-alive is not consistently implemented).

My question is, is it possible for a web server to broadcast and/or send information to a client when the "keep-alive" header has been set?

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-04T18:55:07.420

With HTTP 1.1, keep-alive is the default behavior. (In HTTP 1.0, the default behavior was to close the connection.) The server must send the 'Connection: close" header to terminate the connection with the first response. So there is still a TCP socket available to push data through, but just pushing data from the server would violate the HTTP protocol in a major way. Even using keep-alive, the client would still have to poll the server.

It is important to distinguish between HTTP Keepalive and TCP Keepalive. HTTP keepalive prevents the connection from being closed by the server or client. TCP keepalive is used when the connection might be idle for an extended period of time and might be dropped by a NAT proxy or firewall. TCP keepalive is activated on a per-socket basis by setsockopt() calls.

When doing a 'long poll' to eliminate the need to re-poll, TCP keepalive might be needed.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-04T19:25:07.140

Keep-alive simply holds a TCP socket open, so each time you poll, you save the overhead of the TCP setup/teardown packets--but you still have to poll.

However, "long polling" is a strategy for the web server to broadcast notifications to the client. Essentially, the client issues a GET request, but instead of immediately responding, the web server waits until they have a notification to send, at which point they respond to the GET request. This eliminates any need for packets to go across the wire for polling purposes, and keeps the connection stateless, which as you correctly mention is one of the purposes of the protocol.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-04T19:19:46.420

You might read more about [Comet](http://en.wikipedia.org/wiki/Comet_(programming)) servers. That sounds basically like the approach that the interviewer was asking about. Their effectiveness is disputed by some, but it has been used in several similar situations.

For example, I believe gmail uses comet technologies for some things (but don't quote me on it).

Another example that seems relevant is [BOSH](http://en.wikipedia.org/wiki/BOSH), which is a protocol for transmitting chat information using HTTP and XMPP. But I don't believe that using keep-alive is involved in that.

# rest - RESTful way to create multiple items in one request

> ID：411462
> 
> 赞同：140
> 
> 时间：2009-01-04T18:42:30.690
> 
> 标签：rest, post

I am working on a small client server program to collect orders. I want to do this in a "REST(ful) way".

What I want to do is:

Collect all orderlines (product and quantity) and send the complete order to the server

At the moment I see two options to do this:

1.  Send each orderline to the server: POST qty and product_id

I actually don't want to do this because I want to limit the number of requests to the server so option 2:

2.  Collect all the orderlines and send them to the server at once.

How should I implement option 2? a couple of ideas I have is: Wrap all orderlines in a JSON object and send this to the server or use an array to post the orderlines.

Is it a good idea or good practice to implement option 2, and if so how should I do it.

What is good practice?

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2015-11-17T22:20:25.060

我相信解决此问题的另一种正确方法是创建另一个代表您的资源集合的资源。例如，假设我们有一个类似的端点`/api/sheep/{id}`，我们可以 POST`/api/sheep`来创建一个绵羊资源。

现在，如果我们想支持批量创建，我们应该考虑在 at `/api/flock`（或者`/api/<your-resource>-collection`如果您缺少更有意义的名称）的新群资源。请记住，**资源不需要映射到您的数据库或应用程序模型**。这是一个普遍的误解。

资源是更高级别的表示，与您的数据无关。对资源进行操作可能会产生重大的副作用，例如向用户发出警报、更新其他相关数据、启动长期存在的进程等。例如，我们可以将文件系统甚至 unix`ps`命令映射为 REST API。

我认为可以安全地假设操作资源也可能意味着创建其他几个实体作为副作用。

* * *

## 回答 #2

> 赞同：55
> 
> 时间：2009-01-08T19:40:33.940

尽管批量操作（例如批量创建）在许多系统中是必不可少的，但它们并没有被 RESTful 架构风格正式解决。

我发现按照您的建议发布集合基本上可以工作，但是当您需要报告失败以响应此类请求时会出现问题。当由于不同原因发生多个故障或服务器不支持事务时，此类问题会更​​严重。我给你的建议是，如果没有性能问题，比如服务商在局域网（不是广域网）或者数据比较少的时候，向服务器发送 100 个 POST 请求是值得的。保持简单，从单独的请求开始，如果您遇到性能问题，请尝试优化。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2014-09-16T19:18:45.123

Facebook 解释了如何做到这一点：[https ://developers.facebook.com/docs/graph-api/making-multiple-requests](https://developers.facebook.com/docs/graph-api/making-multiple-requests)

> 简单的批处理请求
> 
> 批处理 API 接收一组表示为 JSON 数组的逻辑 HTTP 请求 - 每个请求都有一个方法（对应于 HTTP 方法 GET/PUT/POST/DELETE 等），一个 relative_url（在 graph.facebook 之后的 URL 部分。 com)、可选的 headers 数组（对应于 HTTP 头）和一个可选的 body（用于 POST 和 PUT 请求）。Batch API 返回表示为 JSON 数组的逻辑 HTTP 响应数组 - 每个响应都有一个状态代码、一个可选的 headers 数组和一个可选的 body（它是一个 JSON 编码的字符串）。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-01-04T20:23:09.583

你的想法对我来说似乎有效。实施取决于您的偏好。您可以为此使用 JSON 或仅使用参数（“order_lines []”数组）并执行

```
POST /orders 
```

由于您将在单个操作（订单及其行）中一次创建更多资源，因此验证每一个资源并仅在所有资源都通过验证时才保存它们至关重要，即。你应该在交易中做到这一点。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-10-24T15:40:50.020

我最近实际上一直在努力解决这个问题，这就是我正在努力的方向。

如果添加多个资源的 POST 成功，则返回 200 OK（我正在考虑 201，但用户最终不会登陆已创建的资源）以及显示已添加的所有资源的页面，无论是读取- 仅或可编辑的时尚。例如，用户能够使用仅包含单个文件输入的表单来选择多个图像并将其发布到画廊。如果 POST 请求完全成功，则为用户提供一组用于创建的每个图像资源表示的表单，允许他们指定有关每个图像资源的更多详细信息（名称、描述等）。

如果无法创建一个或多个资源，POST 处理程序将中止所有处理并将每个单独的错误消息附加到数组中。然后，返回 419 冲突，并将用户路由到 419 冲突错误页面，该页面显示错误数组的内容，以及返回提交表单的方法。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-06-25T00:10:15.333

我想最好在[单个连接](http://www.w3.org/Protocols/rfc2616/rfc2616-sec8.html)中发送单独的请求。当然，您的网络服务器应该支持它

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2009-01-04T20:04:14.940

您不会希望发送 100 个订单行的 HTTP 标头。您既不想生成任何不必要的请求。

将一个 JSON 对象中的整个订单发送到服务器，发送到：server/order 或 server/order/new。返回指向：server/order/order_id的东西

还可以考虑使用~~CREATE~~ PUT 而不是 POST

# php - 关于动态URL解析的问题

> ID：411464
> 
> 赞同：2
> 
> 时间：2009-01-04T18:42:50.113
> 
> 标签：php, url, url-parsing

我看到很多很多网站都有各个页面的 URL，例如

[http://www.mysite.com/articles/this-is-article-1](http://www.mysite.com/articles/this-is-article-1) [http://www.mysite.com/galleries/575](http://www.mysite.com/galleries/575)

而且它们不会重定向，它们不会缓慢运行...

我知道如何解析 URL，这很容易。但在我看来，在动态网站上这似乎很慢而且很麻烦。同样，如果页面都是静态构建的（hende 自定义 URL），那么这意味着页面的所有组件也是静态的......（这会很糟糕）

我很想听听一些关于这通常是如何完成的想法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-04T18:50:48.380

您可以通过多种方式处理上述问题。一般来说，总是至少涉及某种形式的重定向——尽管这可能是在 .htaccess 级别而不是 php 级别。这是一个场景：

1.  使用 .htaccess 重定向到您的 php 处理脚本。

2.  解析 uri ($_SERVER['REQUEST_URI']) 并确定内容的类型（例如，根据您的示例，文章或画廊）。

3.  使用提供的 id（通常附加到 uri 的末尾，再次如您的示例中所示）来获取正确的数据 - 通过提供静态文件或查询数据库以获取所请求的内容。

这种方法是增加 SEO 的一种非常流行的方法，但正如您正确强调的那样，采用这种方法可能会遇到困难 - 通常不是性能，但它可能会使开发或管理更加麻烦（如果您的实施没有经过深思熟虑，则后者可扩展）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-04T19:20:47.727

首先，将应用程序级别的 /plain/ URL 重写与使用 /plain/ CGI（CGI 可以是 PHP、ISAPI、ASP.NET 等）与提供静态页面进行比较时，提供静态文件将始终获胜。工作量减少了。例如，在 Windows 和 Linux（据我所知）中，内核甚至增强了通过 HTTP 在本地驱动器上提供静态文件的功能。为了进一步说明这一点，我什至找到了一个使用多个服务器和操作系统的基准：[http](http://www.litespeedtech.com/web-server-performance-comparison-litespeed-2.0-vs.html#RESULT) ://www.litespeedtech.com/web-server-performance-comparison-litespeed-2.0-vs.html#RESULT请注意，提供静态文件非常重要比使用任何类型的 CGI 都快

但是，通过有效地使用重写的 URL 可以潜在地提高性能和可伸缩性，并且它是通过缓存完成的。如果您返回正确的缓存标头（请参阅[HTTP 文档中的缓存控制指令](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.9)），那么它将使下游服务器能够缓存数据，因此您甚至不会在您的站点上获得点击。但是，我想您也可以使用静态页面获得同样的好处 :) 我恰好在一两天前在 High Scalability 博客上读到了一篇关于这个主题的文章：http: [//highscalability.com/strategy-understanding-your -data-leads-best-scalability-solutions](http://highscalability.com/strategy-understanding-your-data-leads-best-scalability-solutions)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-04T18:48:19.930

它通常通过[重写引擎](http://en.wikipedia.org/wiki/Rewrite_engine)完成，可以在服务器中（通过类似 Apache 中的 mod_rewrite 之类的东西）或在 Web 应用程序中（所有请求都被路由到 Web 应用程序，它为指定的路径查找路由）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-04T18:56:45.700

重写引擎是最好的方法，因为它们快速且经过优化。允许您的服务器端脚本仅使用普通的本地变量。

Apache 的 mod_rewrite 是最常见的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-04T19:01:50.603

就我而言，我坚持使用已经内置此功能的 Web 框架。（代码点火器）

> ...同样，如果页面都是静态构建的（hende 自定义 URL），那么这意味着页面的所有组件也是静态的......（这会很糟糕）

...是的，这确实很糟糕。:o

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-04T19:06:46.443

可以重写

1.  .htaccess 文件或 httpd.conf 或 vhosts.conf 文件中的服务器级别。这通常比在应用程序级别完成的下一级重写更快。

2.  应用程序级别（在本例中使用 PHP）。您可以编写自定义重定向来分析 URL 并基于此以某种方式重定向。Zend Framework (ZF) 等现代 Web 框架使用路由来控制 URL 重写。下面是一个带有 ZF 的静态路由示例

$route = new Zend_Controller_Router_Route_Static('latest/news/this/week', array('controller' => 'news'));

这会将来自[http://somedomain.com/lastest/news/this/week](http://somedomain.com/lastest/news/this/week)的任何请求重定向到新闻控制器。

动态路线的一个例子是

$route = new Zend_Controller_Router_Route('galleries/:id', array('controller' => 'gallery'));

变量 $id 可用于该控制器的位置（使用我们上面的示例将是 575）

这些是非常有用的工具，可让您开发应用程序并追溯将 URL 更改为您想要的任何内容。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-04T20:01:59.500

一个非常简单的方法是让 CGI 解析 URL 的 PATH_INFO 部分。在您的示例中：

```
http://www.example.com/articles/12345 (where "articles" is a CGI script)
                       ^CGI^   ^^^^^^PATH_INFO 
```

脚本名称之后的所有内容都传递给 PATH_INFO CGI 标头中的脚本。

然后您可以进行数据库查找或任何您希望生成页面的操作。

访问此值时要小心，因为 IIS 服务器和 Apache 服务器将 URL 的不同部分放在 PATH_INFO 中。（IIRC：IIS**错误地**使用了整个 URL 并且 Apache 将其修剪为上述内容。）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-04T23:25:09.637

在 apache 服务器上，mod_rewrite 是最常见的，它是一个 apache mod，它允许您使用正则表达式将请求 url 重写为其他 url，因此对于您的示例，将使用如下内容：

```
重写引擎开启
RewriteRule ^articles/(.*)articles.php?article=$1 [L]
RewriteRule ^galleries/(\d*) gallery.php?gallerie=$1 [L]

```

这几乎不需要任何时间，实际上与拥有网址一样快：
www.mysite.com/galleries.php?gallerie=575 但看起来更好

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-05T13:11:45.863

我以前使用过这种方法 - 你只需要添加不应在正则表达式中重定向的文件扩展名，然后其他所有内容都由 php 处理，所以你不需要进入你的 .htacces 文件

[成功的网址](http://www.alistapart.com/articles/succeed/)

# asp.net-mvc - ASP.NET MVC Form repopulation

> ID：411476
> 
> 赞同：6
> 
> 时间：2009-01-04T18:52:12.137
> 
> 标签：asp.net-mvc, forms, repopulation

I have a controller with two actions:

```
[AcceptVerbs("GET")]
    public ActionResult Add()
    {
        PrepareViewDataForAddAction();
        return View();
    }

[AcceptVerbs("POST")]
    public ActionResult Add([GigBinderAttribute]Gig gig, FormCollection formCollection)
    {
        if (ViewData.ModelState.IsValid)
        {
            GigManager.Save(gig);
            return RedirectToAction("Index", gig.ID);
        }
        PrepareViewDataForAddAction();
        return View(gig);
    } 
```

As you can see, when the form posts its data, the Add action uses a GigBinder (An implemenation of IModelBinder)

In this binder I have:

```
 if (int.TryParse(bindingContext.HttpContext.Request.Form["StartDate.Hour"], out hour))
        {
           gig.StartDate.Hour = hour;
        }
        else
        {
            bindingContext.ModelState.AddModelError("Doors", "You need to tell us when the doors open");
        } 
```

The form contains a text box with id "StartDate.Hour".

As you can see above, the GigBinder tests to see that the user has typed in an integer into the textbox with id "StartDate.Hour". If not, a model error is added to the modelstate using AddModelError.

Since the gigs property gigs.StartDate.Hour is strongly typed, I cannot set its value to, for example, "TEST" if the user has typed this into the forms textbox.

Hence, I cant set the value of gigs.StartDate.Hour since the user has entered a string rather than an integer.

Since the Add Action returns the view and passes the model (return View(gig);) if the modelstate is invalid, when the form is re-displayed with validation mssages, the value "TEST" is not displayed in the textbox. Instead, it will be the default value of gig.StartDate.Hour.

How do I get round this problem? I really stuck!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-04-29T02:04:50.747

我认为问题在于您的 ViewModel 与您的 View 匹配不够紧密。在 MVC 中，您的 ViewModel 尽可能与您的 View 匹配非常重要。

在您的 ViewModel 中，您假设一个整数，但在您的 View 中，您使用 TextBox 来呈现属性，这将允许任何类型的文本。这里存在不匹配，您在尝试映射它们时遇到的困难是不匹配的症状。

我认为您应该：
1\. 将 ViewModel 属性的类型更改为字符串，然后在您的控制器中进行验证以确保输入的字符串实际上是一个数字，或者：
2\. 将 View 呈现的控件更改为仅允许通过自定义控件或 Javascript 验证输入数字（如@Qun Wang 建议的那样）

就个人而言，我推荐选项 1。这样 ViewModel 不依赖于 View 实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T14:05:52.527

Could you do this in your PrepareViewDataForAddAction method?..

```
if (!ViewData.ModelState.IsValid)
    {
        ViewData["StartDate.Hour"] = "Error";
    } 
```

The other fields on the form will still populate based on the properties of the Gig object.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-10T09:27:08.287

我认为您需要先进行一些基本的客户端验证。不允许它发布到服务器。

# c# - Strange results from OdbcDataReader reading Sqlite DB

> ID：411478
> 
> 赞同：1
> 
> 时间：2009-01-04T18:53:32.790
> 
> 标签：c#, sqlite, blob, datareader

This method returns some strange results, and was wondering if someone could explain why this is happening, and possibly a solution to get my desired results.

Results:

FileName = what I'd expect

FileSize = what I'd expect

Buffer = all bytes = 0

BytesRead = 0

BlobString = string of binary data

FieldType = BLOB (what I'd expect)

ColumnType = System.String

Furthermore, if the file is greater than a few KB, the reader throws an exception stating the StringBuilder capacity argument must be greater than zero (presummably because the size is greater than Int32.MaxValue).

I guess my question is how does one properly read large BLOBs from an OdbcDataReader?

```
 public static String SaveBinaryFile(String Key)
    {
        try
        {
            Connect();

            OdbcCommand Command = new OdbcCommand("SELECT [_filename_],[_filesize_],[_content_] FROM [_sys_content] WHERE [_key_] = '" + Key + "';", Connection);
            OdbcDataReader Reader = Command.ExecuteReader(CommandBehavior.SequentialAccess);

            if (Reader.HasRows == false)
                return null;

            String FileName = Reader.GetString(0);
            int FileSize = int.Parse(Reader.GetString(1));
            byte[] Buffer = new byte[FileSize];
            long BytesRead = Reader.GetBytes(2, 0, Buffer, 0, FileSize);

            String BlobString = (String)Reader["_content_"];
            String FieldType = Reader.GetDataTypeName(2);
            Type ColumnType = Reader.GetFieldType(2);

            return null;
        }
        catch (Exception ex)
        {
            Tools.ErrorHandler.Catch(ex);
            return null;
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-04T19:39:41.027

I created the field as a BLOB. However, seeing the results of your suggestion of GetFieldType being a System.String, I'm not sure. I'm using the SQLite Manager FireFox addon to manager, and it's reporting *content* as a BLOB.

.NET and the SQLite manager seem to be conflicting. I can save the file properly out of the manager so I know it's stored properly -- it's just reading it into my app.

*filesize* is a text field, it was something I just quickly added to try to debug this whole thing and I plan to change it sooner or later.

The size issue is really surprising to me, but I cannot explain it (which is why I'm here :) I can't determine what the exact size limit is, but I know it will throw an error with a file that is only 34KB. Attached below is a copy of the exception report I generate.

Error Occured: 1:36 PM 1/4/2009 HelpLink:

InnerException:

Message:
'capacity' must be greater than zero. Parameter name: capacity

Source:
mscorlib

StackTrace:
at System.Text.StringBuilder..ctor(String value, Int32 startIndex, Int32 length, Int32 capacity) at System.Text.StringBuilder..ctor(String value, Int32 capacity) at System.Data.Odbc.OdbcDataReader.internalGetString(Int32 i) at System.Data.Odbc.OdbcDataReader.GetValue(Int32 i, TypeMap typemap) at System.Data.Odbc.OdbcDataReader.GetValue(Int32 i) at System.Data.Odbc.OdbcDataReader.get_Item(String value) at AppEx.Data.DatabaseHandler.SaveBinaryFile(String Key) in ...\Data\DatabaseHandler.cs:line 249

TargetSite:
Void .ctor(System.String, Int32, Int32, Int32)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-04T19:02:14.113

Is the field type in the database definitely a BLOB rather than a CLOB? It certainly *looks* as if it's treating it as text data instead of binary data. What does `Reader.GetFieldType(2)` return?

Just as a side-issue, is the *filesize* field really a string rather than an integer? Can you not just use `Reader.GetInt32(1)`?

Finally, with your size issue - when you talk about something being "more than a few KB" - there's a big difference between "more than a few K" and "big enough to overflow `int.MaxValue`" (which would be 2GB). Do you have anything of a few megabytes in size?

# asp.net - 如何处理中继器内按钮的事件？这个 EnableEventValidation 是什么？

> ID：411491
> 
> 赞同：3
> 
> 时间：2009-01-04T19:02:55.080
> 
> 标签：asp.net

我有`Repeater`一个`Button`里面有一个`ItemTemplate`。我将`CommandName`属性添加到按钮，并`ItemCommand`在`Repeater`.

我的问题是，当我单击按钮时，我收到`ArgumentException`一条消息，说明`EnableEventValidation`设置为`true`.

（顺便问一下，有没有办法让我用英语而不是糟糕的葡萄牙语翻译来传达信息？）

我尝试将其设置为`false`并且`ItemCommand`未调用处理程序。如果我将它设置为`true`我得到错误。

`ClientScriptManager.RegisterForEventValidation`如果我信任客户（我这样做），该消息还说明了有关使用的信息。问题是我无法理解该方法的文档。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-04T21:15:03.910

我见过的唯一一次是当我在回发时重新绑定 Page_Load 中的转发器时，而不是将绑定包装在 if (!Page.IsPostBack) 中。如果你这样做，那么发送消息的控件实际上是无效的，所以它会失败。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-04T23:02:48.963

注意 Steve Robbins 指出的绑定问题，您可能还想看看[这篇](http://aspalliance.com/1343_Handling_Events_within_a_Repeater_Control_Using_ASPNET_20.all)文章，当我遇到类似情况时，我发现这篇文章非常有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-23T11:56:21.153

唯一的问题是 Postback 发生在 Repeater 的 ItemCommand 事件可能发生之前......即为什么 asp.net 抛出事件验证错误

如果页面加载中的绑定中继器将其写入 If(!PostBack){...}

# bash - 构建包含空格的参数列表

> ID：411495
> 
> 赞同：14
> 
> 时间：2009-01-04T19:04:45.560
> 
> 标签：bash, arguments, whitespace

在 bash 中，可以转义包含空格的参数。

```
foo "a string" 
```

这也适用于命令或函数的参数：

```
bar() {
    foo "$@"
}

bar "a string" 
```

到目前为止一切顺利，但是如果我想在调用之前操纵参数`foo`怎么办？

这不起作用：

```
bar() {
    for arg in "$@"
    do
        args="$args \"prefix $arg\""
    done

    # Everything looks good ...
    echo $args

    # ... but it isn't.
    foo $args

    # foo "$args" would just be silly
}

bar a b c 
```

那么当参数包含空格时如何构建参数列表呢？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-05T00:38:46.760

有（至少）两种方法可以做到这一点：

1.  使用数组并使用以下方法扩展它`"${array[@]}"`：

    ```
    bar() {
        local i=0 args=()
        for arg in "$@"
        do
            args[$i]="prefix $arg"
            ((++i))
        done

        foo "${args[@]}"
    } 
    ```

    所以我们学了什么？`"${array[@]}"`是`${array[*]}`什么`"$@"`是什么`$*`。

2.  或者，如果您不想使用数组，则需要使用`eval`：

    ```
    bar() {
        local args=()
        for arg in "$@"
        do
            args="$args \"prefix $arg\""
        done

        eval foo $args
    } 
    ```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-10-03T19:44:47.990

这是一个不需要使用数字索引的较短版本：

`find`（示例：为命令构建参数）

```
dir=$1
shift
for f in "$@" ; do
    args+=(-iname "*$f*")
done
find "$dir" "${args[@]}" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-04T19:51:34.013

使用[数组](http://tldp.org/LDP/abs/html/arrays.html)（Bash中的[隐藏功能之一）。](https://stackoverflow.com/questions/211378/hidden-features-of-bash#211525)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-06T14:42:52.793

您可以按照您的建议使用数组，只需更改一个小细节。调用 foo 的行应该是

```
 foo "${args[@]}" 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-06T14:52:26.800

我也有这个问题。我正在编写一个 bash 脚本来备份我的 Windows 计算机（cygwin）上的重要文件。我也尝试了数组方法，但仍然有一些问题。不确定我是如何修复它的，但这是我的代码中很重要的部分，以防它对您有所帮助。

```
WORK="d:\Work Documents\*"
#   prompt and 7zip each file
for x in $SVN $WEB1 $WEB2 "$WORK" $GRAPHICS $W_SQL
do
    echo "Add $x to archive? (y/n)"
    read DO
    if [ "$DO" == "y" ]; then
        echo "compressing $x"
        7zip a $W_OUTPUT "$x"
    fi
    echo ""
done 
```

# mutex - 互斥问题

> ID：411499
> 
> 赞同：4
> 
> 时间：2009-01-04T19:06:47.507
> 
> 标签：mutex

请看下面的伪代码：

```
boolean blocked[2];
int turn;
void P(int id) {
      while(true) {
             blocked[id] = true;
             while(turn != id) {
                    while(blocked[1-id])
                    /* do nothing */;
                    turn = id;
             }
             /* critical section */
             blocked[id] = false;
             /* remainder */
      }
}
void main() {
      blocked[0] = false;
      blocked[1] = false;
      turn = 0;
      parbegin(P(0), P(1)); //RUN P0 and P1 parallel
} 
```

我认为可以使用上面的代码实现一个简单的互斥解决方案。但它不起作用。有谁知道为什么？

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-18T09:06:11.750

由于以下原因，不能保证互斥在此示例中：

我们从以下情况开始：

```
blocked = {false, false};
turn = 0; 
```

P1 现在执行，并跳过

```
 blocked[id] = false; // Not yet executed. 
```

现在的情况是：

```
blocked {false, true}
turn = 0; 
```

现在 P0 执行。它通过第二个 while 循环，准备执行临界区。并且当 P1 执行时，它会将 turn 设置为 1，并且也准备好执行临界区。

顺便说一句，这种方法最初是由 Hyman 发明的。他于 1966 年将其发送给 ACM 通讯

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-12-07T20:14:29.540

由于以下原因，不能保证互斥在此示例中：

我们从以下情况开始：

```
turn= 1;
blocked = {false, false}; 
```

执行如下：

```
P0: while (true) {
P0:   blocked[0] = true;
P0:   while (turn != 0) {
P0:     while (blocked[1]) {
P0:     }
P1: while (true) {
P1:   blocked[1] = true;
P1:   while (turn != 1) {
P1:   }
P1:   criticalSection(P1);
P0:     turn = 0;
P0:   while (turn != 0)
P0:   }
P0:   critcalSection(P0); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-04T22:02:55.217

这是作业，还是一些嵌入式平台？有什么理由不能使用 pthread 或 Win32（相关的）同步原语吗？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-04T19:19:06.310

也许你需要将blocked和turn声明为volatile，但是不指定编程语言就无从得知。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-04T20:03:57.017

并发不能这样实现，尤其是在多处理器（或多核）环境中：不同的核/处理器有不同的缓存。这些缓存可能不一致。下面的伪代码可以按所示顺序执行，结果如下：

```
get blocked[0] -> false   // cpu 0
set blocked[0] = true     // cpu 1 (stored in CPU 1's L1 cache)
get blocked[0] -> false   // cpu 0 (retrieved from CPU 0's L1 cache)
get glocked[0] -> false   // cpu 2 (retrieved from main memory) 
```

您*需要*硬件知识来实现​​并发。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-01-04T20:40:33.807

编译器可能已经优化了“空”while 循环。将变量声明为 volatile 可能会有所帮助，但不能保证在多处理器系统上就足够了。

# c# - 了解 IEquatable

> ID：411500
> 
> 赞同：52
> 
> 时间：2009-01-04T19:08:05.677
> 
> 标签：c#, iequatable

当我实现要使用[`IEquatable<T>`接口](https://docs.microsoft.com/en-us/dotnet/api/system.iequatable-1?view=netstandard-2.0)比较的对象时：

1.  如果我已经实现了，为什么我必须重写`Equals(object)`方法`Equals(T)`？
2.  实施后可以使用`==`and`!=`运算符`IEquatable<T>`吗？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-01-04T19:11:36.543

1.  来自[MS Docs 文章`IEquatable<T>`](https://docs.microsoft.com/en-us/dotnet/api/system.iequatable-1?view=netstandard-2.0)：

    > 如果您实现`IEquatable<T>`，您还应该覆盖 和 的基类实现， `Equals(Object)`以便 `GetHashCode()`它们的行为与 `Equals(T)` 方法的行为一致。如果你做 override `Equals(Object)`，你的覆盖实现也会在调用 `Equals(Object, Object)` 你的类的静态方法时被调用。此外，您应该重载`op_Equality` and`op_Inequality`运算符。这可确保所有相等性测试返回一致的结果。

2.  不，[运算符不使用 Equals 方法](https://stackoverflow.com/a/1849288/712526)。它们必须单独[重载](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/statements-expressions-operators/overloadable-operators)才能这样做。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2009-01-04T19:28:45.183

1）正如雷所说，`Equals(object)`当从不知道（静态）你实现的类调用方法时，覆盖以确保一致性`IEquatable<T>`。例如，非泛型集合类将`Equals(object)`用于比较。您还应该覆盖`GetHashCode()`.

2) 实现`IEquatable<T>`不会自动重载 == 和 != 运算符，但没有什么可以阻止您这样做，就像这样做一样`System.String`。但是，如果您这样做，您应该非常清楚地记录这一点 - 并且在您对仍然使用身份比较的其他类型的引用（例如 MyType 和 Object）进行比较时要小心。我怀疑这样做不是一个好主意，除非它在你的代码中是一个非常常用的类型，每个人都会非常熟悉它*，并且*重载 == 的语法糖会对可读性产生积极影响。

# asp.net - 回传是否被谷歌广告或 CPM 广告视为浏览量？

> ID：411504
> 
> 赞同：1
> 
> 时间：2009-01-04T19:08:49.997
> 
> 标签：asp.net, postback, autopostback

回发 (asp.net) 是否被谷歌广告或 CPM 广告视为浏览量，还是被忽略？

谷歌广告如何区分回发和综合浏览量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-04T19:18:01.197

（**更新**：抱歉，我将 google adsense 与 google analytics 混合使用。不确定这是否适用于 adsense。）

由于 google 分析代码片段在客户端上运行，因此每次在浏览器中显示页面时都会执行它，即使这是由回发引起的。

如果当前请求不是回发，您可以通过仅包含谷歌分析代码片段来更改此行为。例如，您可以将 google 代码片段放入用户控件中，并在回发的情况下将控件的 Visible 属性设置为 false。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-04T19:31:01.310

每当执行其 javascript 时，Google adsense 都会为页面打勾，回发后，来自服务器的 HTML 会重新加载到浏览器中，这会触发 Google adsense javascript 执行，因此，它会再次为您的页面打勾。

但是，在 Google 分析报告中，通过过滤掉重复的页面视图来消除这种情况。你会看到独特的访问者、独特的页面浏览量等。我想 Adsense 使用相同的技术。

# php - XML Fetcher Cron 作业：运行频率和获取次数？

> ID：411512
> 
> 赞同：0
> 
> 时间：2009-01-04T19:13:06.433
> 
> 标签：php, cron

我在一个共享的虚拟主机上有一个 PHP 脚本，它从大约 300 个“提要”中选择过去半小时内未更新的 40 个，发出 cURL 请求，然后将其传递给用户。

```
SELECT * FROM table WHERE latest_scan < NOW() - INTERVAL 30 MINUTE ORDER BY latest_scan ASC LIMIT 0, 40;
// Make cURL request and process it 
```

我希望能够尽快交付更新**，**但不想让我的服务器或我从中获取的服务器陷入困境（它只是少数）。

我应该多久运行一次 cron 作业，我应该限制每次运行的获取次数吗？给多少？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-04T19:18:56.047

“评估”每个提要实际更改的频率是一件好事，因此如果某项更改的平均时间为 24 小时，那么您只需每 12 小时获取一次。

只需存储#changes 和#try's 并选择您需要检查的那些...您可以每分钟运行一次脚本，然后让一些统计数据完成剩下的工作！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-04T19:23:56.660

在共享主机上，您可能还会遇到脚本运行时问题。例如，如果您的脚本运行时间超过 30 秒，服务器可能会终止。如果您的主机属于这种情况，您可能需要进行一些测试/记录处理每个提要所需的时间，并在确定应该同时处理多少提要时考虑到这一点。

为了解决这个问题，我必须做的另一件事是在处理每个单独的请求**之前**将“上次扫描”标记为已更新，这样问题提要就不会继续失败并在每次 cron 运行时被拾取。如果需要，您可以在失败时再次更新条目并指定失败发生的原因（如果已知）。

# c# - 向实体自动添加 LinqToSql 基类的方法？

> ID：411515
> 
> 赞同：2
> 
> 时间：2009-01-04T19:14:45.820
> 
> 标签：c#, linq-to-sql

是否有自动将基类添加到 Linq2Sql 实体的方法？

我知道我可以定义一个部分并实现它，但必须有一种自动化的方式，对吧？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-04T23:28:38.397

LINQ-to-SQL 代码生成器直接支持这一点。

数据上下文的基类可以在设计器中设置为`Base Class`属性。或者，直接编辑 dbml：右键单击，“Edit With...”，“XML Editor”

要更改实体的基类，请设置类型：

```
<Database EntityBase="Some.NameSpace.Foo" ... > 
```

要更改数据上下文的基类，请设置类型：

```
<Database BaseType="Some.NameSpace.Bar" ... > 
```

在这两种情况下，请在属性中使用完全限定类型。等等。

请注意，因为它非常字面化，您也可以使用这种方法使您的实体实现一个接口 - 例如，当我的类具有`LastUpdated`和之类的属性时`UpdatedBy`，我可能有一个`IAuditable`定义这些的接口。然后我可以将代码放在我的数据上下文（覆盖）中，为所有正在更新的实体`SubmitChanges`调用`GetChangeSet()`和设置这些值；`IAuditable`很甜。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-04T19:23:24.197

编辑：在这种情况下， [Marc 的答案](https://stackoverflow.com/questions/411515/way-to-automatically-add-a-linqtosql-base-class-to-entities#411903)显然是正确的方法，但我将这个答案留给后代 - 在某些情况下，这是一个方便的技巧，您只需要一个部分类来更改继承/接口一类的。

我不知道任何自动化方式，但如果您想为多个类执行此操作并且*只想*指定基类，您可以考虑为部分类声明创建一个文件。我在 Protocol Buffers 中使用这种方法来使自动生成的内部表示类实现特定的接口。

有关此示例的代码，请参见[PartialClasses.cs](http://github.com/jskeet/dotnet-protobufs/tree/master/src/ProtocolBuffers/DescriptorProtos/PartialClasses.cs)。（忽略 TODO - 它已在本地修复，但我有一段时间没有推送 :)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-04T19:31:43.650

有些人编写了自己的代码模板来代替 DBML 方法。走这条路，您可以轻松地自己添加基类。

[Visual Studio 2008 的 LINQ to SQL 模板](http://damieng.com/blog/2008/09/14/linq-to-sql-template-for-visual-studio-2008)是一个很好的起点

# java - Java字符串资源的管理

> ID：411517
> 
> 赞同：2
> 
> 时间：2009-01-04T19:16:10.560
> 
> 标签：java

我正在与其他人一起开发一个 java SE 1.5+ swing 应用程序。我想知道管理字符串资源的最佳方式是什么。我了解资源包等背后的原则。我想避免为每个需要字符串的类使用一个属性文件，因为这似乎有点矫枉过正。尤其是当您有很多类可能只对字符串进行单个引用时（例如在错误处理程序中）。另一方面，当您减少合并冲突的风险时，它使与他人协作时变得更容易。

每次您需要显示简单的用户反馈时，必须加载资源包似乎特别麻烦，同样在错误处理程序中，当涉及到许多类时。

在具有数百个类的相当大的应用程序中管理字符串的最有效方法是什么，其中许多类与 GUI 无关，但在发生异常时需要将信息性消息传递回 GUI。

我正在使用 NetBeans，它通常为每个 GUI 类创建一个属性文件，用于与按钮、标签等相关的所有文本。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-04T19:19:52.720

是什么让你认为你必须为每个类都有一个单独的属性文件？通常，您只需要几个（或一个！）属性文件（当然，每种语言）。

只需[`ResourceBundle.getBundle()`](http://java.sun.com/javase/6/docs/api/java/util/ResourceBundle.html)使用适当的参数调用 - 您可以使用来自多个类的同一个包。

编辑：每个对话框拥有一组属性文件等可以更容易地查看任何特定字符串的来源，但它使得重用相同的消息等变得更加困难。正确的平衡将取决于应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-04T20:07:46.540

JSR 296 Swing 应用程序框架支持资源管理（看起来将成为 Java 7 的一部分）。SAF 旨在预先构建许多人经常需要的 Swing 应用程序的一部分，同时封装最佳实践。你可能不想直接与它联系起来，但值得看看他们做了什么，看看它是否给你一些想法。如果我记得，他们使用具有明确命名约定的级联资源包。后者意味着您知道在哪里查看，而前者意味着您可以在包层次结构的某些部分重用属性。

这里收集了许多[JSR 296 资源](http://tech.puredanger.com/java7#jsr296)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-04T19:20:59.817

这可能很幼稚，但是将它们存储在嵌入式或外部数据库中呢？这可能会简化管理，并且更改语言的可配置性更高。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-04T20:20:55.797

今年我打算实现类似于 Launchpad 的翻译平台的东西： [https ://launchpad.net/+tour/translation](https://launchpad.net/+tour/translation)

简而言之：

*   并行翻译
*   基于先前输入的短语的短语建议
*   政策，例如部分限制和结构化：任何人都可以提出翻译建议，而受信任的社区成员审查和批准新工作

**更新**

当然，这建立在 ResourceBundle 等之上，但它是管理所有字符串的好方法；-)

# cocoa - 如何在 Cocoa 中创建一周的一系列日期

> ID：411530
> 
> 赞同：1
> 
> 时间：2009-01-04T19:25:14.020
> 
> 标签：cocoa, date

我正在编写一个应用程序，需要显示一周中的当前日期。

因此，对于接下来的一周，我需要生成以下日期。

2009 年 1 月 5 日星期一 2009 年 1 月 6 日星期二 2009 年 1 月 7 日星期三 2009 年 1 月 8 日星期四 2009 年 1 月 9 日星期五

我已经对应用程序进行了编码，以从当前日期生成五个日期。我遇到的问题是找到一种在本周创建周一到周五的方法。

我正在运行 OS X 10.5 并且正在使用 Cocoa 环境。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-04T19:51:57.930

查看[NSCalendar](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSCalendar_Class/Reference/NSCalendar.html)和[NSDateComponents](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSDateComponents_Class/Reference/Reference.html)。

如果您还没有，您应该阅读[Cocoa 的日期和时间编程主题以](http://developer.apple.com/documentation/Cocoa/Conceptual/DatesAndTimes/DatesAndTimes.html)获取更多信息/帮助。

# html - Adsense 在基于 ajax 的应用程序中？

> ID：411533
> 
> 赞同：8
> 
> 时间：2009-01-04T19:26:54.220
> 
> 标签：html, ajax, asp.net-ajax, adsense

如何在基于 asp.net ajax/ajax 的应用程序中添加 adsense 或其他广告？（例如[ra-ajax 示例页面](http://ra-ajax.org/samples/Viewport-Calendar-Starter-Kit.aspx)）或[GWT](http://gwt-ext.com/demo/)

创建 iframe 是可行的解决方案吗？

如下所述，放置 adsense 脚本很容易。但是 google bot 将无法扫描我基于 ajax 的页面，因为所有内容都是 javascript。不会有上下文广告。所以不能赚钱。这对于静态广告来说会很棒。有什么想法/意见吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-14T00:20:51.963

看起来您想要做的是加载 AdSense，然后根据通过 AJAX 传递的内容动态刷新/更改广告。

很遗憾，这违反了 AdSense 计划政策；我刚刚在这里发布了一个很长的答案：[Refresh a Div that has a Google ad inside it](https://stackoverflow.com/questions/435391/refresh-a-div-that-has-a-google-ad-inside-it#441425)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-04T19:33:57.840

Google 不建议使用 iframe 方法，因为它破坏了广告的上下文关系（因为在调用广告的页面上没有可处理的内容）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-06T20:22:27.930

Jader，Google AdSense 防止广告使用 AJAX 插入页面。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-05-15T10:30:59.207

只是为了给这篇文章添加更新，现在 AdSense 政策允许这样做。[您可以在此处](http://adsense.blogspot.com/2013/05/updates-to-our-modifying-ad-code-policy.html)找到更新的政策（2013 年 5 月）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-04T19:31:06.647

为什么不能正常添加广告？您可以创建一个 iFrame，但我认为没有必要。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-05-07T02:02:50.820

编辑：没关系。AdSense 似乎尽其所能阻止这种情况发生。他们真的不希望您动态加载 AdSense。

我意识到这个问题已经存在一年了，但是我编写了一个库来帮助解决`document.write`部分问题（我不知道这是否违反了 TOS）[writeCapture.js](http://github.com/iamnoah/writeCapture)。这很简单：

```
$('#ads').writeCapture().html('<script src="whatever-your-adsense-code-is"> </script>'); 
```

该示例使用 jQuery，但您也可以单独使用它。因为它将在同一页面中加载（没有 iframe），所以它应该工作得很好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-09-02T19:02:22.687

谷歌很快就会让这成为可能......

[Ajax 的 Adsense](http://code.google.com/apis/afa/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-10-20T09:23:17.400

这是一个老问题，但为了记录，我相信[http://www.retailigence.com](http://www.retailigence.com)有一个 API，您可以使用它来实时查找位置和上下文广告。

* * *

## 回答 #9

> 赞同：-5
> 
> 时间：2009-01-05T00:28:56.233

Google AdSense 为您提供一小段 HTML 代码，其中包含一些 Javascript 的脚本标记，可以完美地与任何网页配合使用，无论是 Ajax、ASP.NET、ra-ajax 示例页面还是 GWT。如果您已在 HTML 中插入此代码段，但仍有问题，请为您的页面提供链接。

# linux - linux中的自定义协议？

> ID：411544
> 
> 赞同：17
> 
> 时间：2009-01-04T19:34:23.410
> 
> 标签：linux, custom-protocol

我正在尝试将我的一个爱好项目移植到 linux。最好是 Mono，因为它是用 C# 编写的。但我也在研究 Python。

该应用程序的一个特点是它需要与自定义协议相关联，因此当用户在应用程序的网站上单击如下链接时会调用该应用程序：

```
myapp://module/action 
```

像[这样](http://msdn.microsoft.com/en-us/library/aa767914.aspx)的自定义协议，[这个](https://stackoverflow.com/questions/389204/how-do-i-create-my-own-url-protocol-eg-so)和[这个](https://stackoverflow.com/questions/309690/communicating-from-website-to-desktop-application-not-vice-versa)。

如何在 linux/unix 系统中做到这一点？我可以像在 Windows 中那样关联系统范围的处理程序吗？还是需要依赖于浏览器？

在谷歌上找不到任何东西。而且我对 linux 编程一无所知。

我需要一些指示。谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-04T20:08:20.657

在理想情况下，这类事情由桌面环境（KDE、GNOME、XFCE）处理，Firefox 尊重这些设置——至少在 Ubuntu、Fedora 和 OpenSUSE 上应该这样做。YMMV：

[将新的 URI 方案处理程序集成到 GNOME 和 Firefox](http://people.w3.org/~dom/archives/2005/09/integrating-a-new-uris-scheme-handler-to-gnome-and-firefox/)

[为 firefox (KDE) 添加协议处理程序](http://www.last.fm/forum/21714/_/42837/_/430232)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-04T19:52:28.803

为Firefox执行此操作的手动方法：

```
open firefox
type in about:config to location bar
add new string
name:  network.protocol-handler.app.myapp
value: /path/to/program 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-04T19:50:18.230

不会有一个单一的答案，因为这充其量只会在 X 窗口管理器级别发生。通常，您需要有一些可以放入路径中的代码块，并将名称与协议相关联。查看 about:config 页面，这是设置处理程序的地方。

这实际上也是 Windows 所做的一切，只是这些东西在注册表中。

[这看起来像是](http://starkravingfinkle.org/blog/2008/04/firefox-3-web-protocol-handlers/)Firefox 的一个不错的描述。

* * *

## 回答 #4

> 赞同：-6
> 
> 时间：2009-01-04T20:07:57.570

> 我可以像在 Windows 中那样关联系统范围的处理程序吗？还是需要依赖于浏览器？

它必须依赖于浏览器。在 Linux 中没有关联 URL 处理程序的跨浏览器方式。

# refactoring - 代码生成器与代码重构

> ID：411547
> 
> 赞同：4
> 
> 时间：2009-01-04T19:37:42.060
> 
> 标签：refactoring

你喜欢你的 CRUD 程序吗？代码生成、框架驱动还是手动编写？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-04T19:53:10.453

我对代码生成器的经验是它们是一个好的开始，但是在更改完成后，我通常想手动重写模块。当然，这可能会成为维护问题。但这真的变成了“一根绳子有多长”的问题。 您正在处理*哪些生成器、框架和资源？*其中一些是可怕的处理，其他的工作正常。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-04T21:04:34.787

我喜欢带有自定义模板的代码生成器，原因如下： 减少编码工作 易于进行全局更改 在模板中嵌入架构可确保开发人员的合规性。减少编码错误的机会。一致的功能 更少的测试。

事实上，使用代码生成器，当架构更新时，我能够在几分钟内从包含 60 多个表的修改后的数据库创建或重新创建存储过程、实体类和 DAL。通过使用自定义模板，我确保所有层都符合我的命名规则，并确保正确处理错误并防止重复插入。

非常适合固定价格合同。如果它是每小时一次，那么您可能想手动进行:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-04T19:49:24.550

如果你使用 .Net 使用 Linq，那么它很容易维护。LinqToSql 可以轻松更新数据模型，而无需大量更改代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-04T19:52:04.060

我喜欢框架驱动和手动编写的混合体。我已经使用 NHibernate 和 LinqtoSql 做了一些工作，有时它们为我生成的查询需要一点帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-04T20:00:18.630

这实际上取决于您的应用程序的大小。手工制作的数据访问层对于非常小的应用程序最有意义，因为您拥有最终控制权，但对于任何中型到大型应用程序，我建议使用代码生成器。我在 APEX SQL（不是很好）、LINQ 和 Subsonic（都非常好）方面有各种经验。我即将评估 Telerik ORM，但我想这也会很好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-04T20:08:05.400

在我看来，代码生成器是糟糕设计的标志并且违反了 DRY。一个好的框架会让你维护更少的代码。使用框架，您最终也会扩展和重构代码，而不是代码模板。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-04T21:53:55.517

框架是选择之一，如果我需要使用代码生成器，我喜欢将生成代码的快速 Perl 脚本放在一起，以便我准确了解生成的内容和原因。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-04T22:13:37.723

如果您将用户视为数据输入员来为您维护数据库表，它们会很有用。它们有助于最大限度地减少满足最低要求所需的编程时间。

如果您希望您的工作质量能够反映比这更好的东西，那么对他们来说最好的说法是，如果您不太确定如何自己制作简单一致的 UI 屏幕，它们可能会给您一个快速启动。

就我个人而言，我发现基于真实用例将它们重构为有用且有吸引力的东西比从头开始需要更长的时间。他们是呆伯特尖头发的老板会喜欢的那种技术。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-04T22:51:01.873

我发现一个比代码生成器更好的 CRUD 逻辑框架。当一组复杂的表生成一个非常慢的查询来产生结果时，我遇到过这种情况。

# c# - Anatomy of an email message

> ID：411553
> 
> 赞同：2
> 
> 时间：2009-01-04T19:41:43.643
> 
> 标签：c#, .net, email

What are the various parts to an email message?

I'm working with these 3rd party components, and so far from what I understand are:

1.  emails have unique messageID's (per server I would presume)

2.  emails have headers

3.  emails have body text that can be either html or plain text.

4.  attachments have to be parsed using mime, and each mime part can have different types like: multipart/ applicatoin/octet-stream and filenames.

side question, where exactly is the documentation that these 3rd party components have to adhere to?

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-04T19:48:57.983

I think its time to read some RFCs. ;)

RFC2822 - Internet Message Format
[http://www.faqs.org/rfcs/rfc2822.html](http://www.faqs.org/rfcs/rfc2822.html)

RFC2045 - Multipurpose Internet Mail Extensions (MIME) Part One
[http://www.faqs.org/rfcs/rfc2045.html](http://www.faqs.org/rfcs/rfc2045.html)

RFC2046 - Multipurpose Internet Mail Extensions (MIME) Part Two
[http://www.faqs.org/rfcs/rfc2046.html](http://www.faqs.org/rfcs/rfc2046.html)

RFC 2049 - Multipurpose Internet Mail Extensions (MIME) Part Five: Conformance Criteria and Examples
[http://www.faqs.org/rfcs/rfc2049.html](http://www.faqs.org/rfcs/rfc2049.html)

RFC2821 - Simple Mail Transfer Protocol
[http://www.faqs.org/rfcs/rfc2821.html](http://www.faqs.org/rfcs/rfc2821.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-04T19:52:49.300

If sent by an MS Exchange server which is not configured properly, an email can be a single blob in a propriety binary format known as [TNEF](http://en.wikipedia.org/wiki/TNEF) that is attached to a message which contain little else as a file usually named `winmail.dat`.

# fogbugz - Why does FogBugz require that the DEP is turned off?

> ID：411560
> 
> 赞同：0
> 
> 时间：2009-01-04T19:48:51.260
> 
> 标签：fogbugz, dep, data-execution-prevention

I am really wondering why FogBugz when installed locally insists that [DEP](http://support.microsoft.com/default.aspx/kb/875352) is turned off?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-05T23:11:27.947

FogBugz 6 (and earlier) requires that Data Execution Prevention (DEP) be disabled on versions of Windows that have DEP, **because of a third-party COM component** that we use for parsing email. We will fix this in the next major release of FogBugz: FogBugz will no longer use this third-party component (in fact, the next version of FogBugz will not use *any* COM components).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-04T20:08:17.523

打开它并使用调试器查看它在哪里崩溃 :) 我遇到了一些 COM 组件，这些组件将从触发 DEP 异常的数据块中执行一些代码。我愿意猜测 FogBugz 也在某个地方访问一些正在做同样事情的本机组件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-04T20:06:42.783

不知道 FogBugz 的具体情况，但是...

关闭 DEP 的最常见原因是在堆栈或堆上以编程方式生成的 thunk。Windows 内核模拟最常见的内核，但“最常见”的覆盖范围不是很好。

关闭 DEP 的第二个最常见原因是错误链接的代码段似乎是数据段。

第三个最常见的原因是字符串中的机器码。一般来说，这确实是一种糟糕的风格，但有时在 Windows 上却无济于事。

第四个最常见的原因是代码中的某些算法假定了堆栈布局。DEP 搞砸了。

或者程序可能真的在堆缓冲区上运行代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-04T20:18:05.210

[除非禁用 DEP，或者为已安装的挂钩设置了适当的内存保护](http://msdn.microsoft.com/en-us/library/aa366786(VS.85).aspx)选项，否则尝试修补或将挂钩插入其地址空间内的其他模块的代码通常不起作用。

这是一些框架（例如Delphi）的常用技术，其中“补丁”在运行时动态应用以修复供应商尚未解决的错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-05T05:49:30.377

我只是不喜欢在服务器环境中关闭 DEP 的想法，因为现代最先进的软件无法处理它。特别是因为它是我多年来尝试过的唯一需要它的软件。

在安装过程中，我遇到了 DEP 警报。

正如上面的 FogBugz 链接所说，“但是请注意，在启用 DEP 的情况下，FogBugz 将无法正常运行。”。

# c# - 网格视图中缺少数据

> ID：411571
> 
> 赞同：1
> 
> 时间：2009-01-04T19:53:13.340
> 
> 标签：c#, asp.net-mvc

我创建了

```
 DataTable dt = new DataTable();

        dt.Columns.Add("Type");
        dt.Columns.Add("Address1");
        dt.Columns.Add("Address2");
        dt.Columns.Add("PostalCode");
        dt.Columns.Add("Country");

        DataRow drow = dt.NewRow();

        drow["Type"] = ddlAddressType.SelectedItem.ToString();
        drow["Address1"] = txtAddress1.Text;
        drow["Address2"] = txtAddress2.Text;
        drow["PostalCode"] = txtPostalCode.Text;
        drow["Country"] = ddlCountry.SelectedItem.ToString();

        dt.Rows.Add(drow);

        Session["Address"] = dt; 
```

尝试使用以下代码将该值添加到网格视图中：

```
public void populateAddressGridView()
{
    if (Session["Address"] != null)
    {
        DataTable dt = (DataTable)Session["Address"];

        if ((dt != null) && (dt.Rows.Count > 0))
        {
            AddressGridView.Visible = true;
            AddressGridView.DataSource = dt;
            AddressGridView.DataBind();
        }
        else
        {
            AddressGridView.Visible = false;
        }
    } 
```

但添加新数据行后字段为空，没有任何值。如果我启用字段的自动生成，我可以查看生成的数据。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-16T01:51:35.133

Sounds to me like you need to set AutoGenerateColumns="false" and then specify the columns to show in the gridview:

```
<asp:GridView ID="AddressGridView" runat="server" AutoGenerateColumns="false">
<Columns>
    <asp:BoundField HeaderText="Type" DataField="Type" />
    <asp:BoundField HeaderText="Address1" DataField="Address1" />
    <asp:BoundField HeaderText="Address2" DataField="Address2" />
    <asp:BoundField HeaderText="PostalCode" DataField="PostalCode" />
    <asp:BoundField HeaderText="Country" DataField="Country" />
</Columns>
<EmptyDataTemplate>
    No records were found matching your search criteria
</EmptyDataTemplate>
</asp:GridView> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T14:51:35.647

在我看来是对的。调试时，您能否确认会话对象被正确地转换为数据表？演员表后是否有行？代码是否进入数据绑定方法？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-15T17:10:36.243

是否需要注册

Global.asax 文件中的 Session["Address"] 变量在使用之前 ???

和赫克托，

确保您的应用程序的会话状态在 web.config 文件上已启用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-05T21:58:22.387

在 GridView 的定义中，如果您将 AutoGenerateColumns 设置为 false，请确保您已定义。

# c# - C# 中的正确柯里化

> ID：411572
> 
> 赞同：37
> 
> 时间：2009-01-04T19:53:48.597
> 
> 标签：c#, lambda, currying

给定一个`DoSomething`采用（无参数）函数并以某种方式处理它的方法。有没有比下面的代码片段更好的方法来为带参数的函数创建“重载”？

```
public static TResult DoSomething<TResult>(Func<TResult> func)
{
    //call func() and do something else
}

public static TResult DoSomething<T0, TResult>(
    Func<T0, TResult> func,
    T0 arg0)
{
    return DoSomething(() => func(arg0));
}

public static TResult DoSomething<T0, T1, TResult>(
    Func<T0, T1, TResult> func,
    T0 arg0, T1 arg1)
{
    return DoSomething(arg => func(arg, arg1), arg0);
}

public static TResult DoSomething<T0, T1, T2, TResult>(
    Func<T0, T1, T2, TResult> func,
    T0 arg0, T1 arg1, T2 arg2)
{
    return DoSomething(arg => func(arg, arg1, arg2), arg0);
} 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-01-04T20:02:52.307

编辑：如评论中所述，这是部分应用而不是柯里化。我写了[一篇关于我对差异的理解的博客文章](http://codeblog.jonskeet.uk/2012/01/30/currying-vs-partial-function-application/)，人们可能会觉得有趣。

好吧，它并没有特别的不同 - 但我会将咖喱部分与“调用 DoSomething”部分分开：

```
public static Func<TResult> Apply<TResult, TArg> (Func<TArg, TResult> func, TArg arg)
{
    return () => func(arg);
}

public static Func<TResult> Apply<TResult, TArg1, TArg2> (Func<TArg1, TArg2, TResult> func,
                                                          TArg1 arg1, TArg2 arg2)
{
    return () => func(arg1, arg2);
}

// etc 
```

然后：

```
DoSomething(Apply(foo, 1)); 
```

这样，您可以在其他情况下重用柯里化代码 - 包括您不想立即调用新返回的委托的情况。（例如，您以后可能想更多地咖喱它。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-02-22T12:29:10.963

@Jon Skeet 的答案是正确的，但是手动编写所有可能的超载是疯狂的，因此您可以使用像[Curryfy](https://github.com/leandromoh/Curryfy)这样的库来为您完成这项工作。Curryfy 库特别公开了 Curry、UnCurry 和 ApplyPartial 扩展方法，有很多重载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-04-17T12:31:15.213

这是允许使用`dynamic`（如 js 中的 Curry）编写无限调用函数的方法：

```
dynamic Sum(int a)
{
    Console.WriteLine(a);
    return new Func<int, dynamic>(b => Sum(a + b));
} 
```

如果你这样称呼它`Sum(2)(3)(4)(10)`，输出将是：

```
2
5
9
19 
```

# sql - 使用主键将数据插入 SQL 表。对于骗子 - 允许插入错误还是先选择？

> ID：411575
> 
> 赞同：1
> 
> 时间：2009-01-04T19:58:56.387
> 
> 标签：sql, insert

给定一个表格，例如：

```
CREATE TABLE dbo.MyTestData (testdata varchar(50) NOT NULL) 

ALTER TABLE dbo.MyTestData WITH NOCHECK ADD CONSTRAINT [PK_MyTestData] PRIMARY KEY  CLUSTERED (testdata) 
```

并且假设当我们完成收集要从具有已知重复项的外部数据列表中添加的项目时，我们想要一个唯一的“testdata”列表......在执行插入存储过程时，应该编写该过程来测试是否存在或应该它只允许错误吗？最常见的做法是什么？我一直在进行存在性测试，但昨晚还在争论这个……

```
CREATE PROCEDURE dbo.dmsInsertTestData @ptestdata VarChar(50)
AS
  SET NOCOUNT ON

  IF NOT EXISTS(SELECT testdata FROM dbo.MyTestData WHERE testdata=@ptestdata)
  BEGIN
    INSERT INTO dbo.MyTestData (testdata ) VALUES (@ptestdata)
  END

RETURN 0 
```

还是在执行此错误时捕获/忽略 PK 违规错误？

```
CREATE PROCEDURE dbo.dmsInsertTestData @ptestdata VarChar(50)
AS
  SET NOCOUNT ON
  INSERT INTO dbo.MyTestData (testdata ) VALUES (@ptestdata)
RETURN 0 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-04T20:34:41.057

您的错误检查（即“IF NOT EXISTS ...”）可能会或可能不会起作用，因为存在潜在的竞争条件（如果另一个事务在您的 IF NOT EXISTS 语句之后但在您的 INSERT 语句之前插入记录）。

因此，无论您之前是否检查过，您都应该对 INSERT 语句进行编码，就好像它可能会失败一样。

**您是否也**想检查（不是，而是）取决于您和您的 UI。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-04T20:37:39.180

我总是在一个声明中做到这一点：

```
INSERT INTO dbo.MyTestData (testdata ) VALUES (@ptestdata)
WHERE NOT EXISTS(SELECT 1 FROM dbo.MyTestData WHERE testdata=@ptestdata) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-04T20:12:10.633

我认为大多数程序员会建议避免异常。从 T-SQL 的性能角度来看，我不确定，但在 .NET 中，我相信抛出的异常比附加的 if/else 语句成本更高。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-04T20:22:25.060

我对您给出的第一个示例的担忧是它没有向用户返回错误。可以修复它，但除非它返回错误，否则我不会使用它。

如果您对这两种可能性的担忧是在大型表上的性能，我建议您同时测试它们，看看其中一个是否明显快于另一个。如果 if 选择特别复杂，并且插入将需要在大多数情况下发生，那么在大多数情况下，简单地让它失败可能会更快。另一方面，如果输入错误的可能性很高，并且 if 相对简单，如此处所示，那么另一个过程可能是一个更好的过程。但是只有对您的真实数据结构和数据以及您的真实查询进行真实测试才能告诉您哪个性能更好，因为它可能在不同的情况下有所不同。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-04T20:23:22.563

我相信这取决于存储过程的性质。基本上，如果您与它们有关（或为程序的客户封装它们），则应该处理错误，如果您与它们没有任何关系并且不能使其对其他人更友好，则让它们传播应用层。

如果存储过程旨在插入原始数据，我认为它应该让应用程序来处理可能的错误。如果存储过程被设计为一个抽象层（并且执行特定*任务*而不是运行特定*语句*）并且可以处理错误并对其执行某些操作或者可以以优雅的方式报告它（例如，明确定义错误代码）到应用程序，它应该这样做。否则，应该由应用程序确保它没有插入重复数据，而不是数据库（数据库已经使用主键强制执行此操作）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-04T20:25:49.670

为了用户友好，执行 SELECT 通常是一个好习惯，如果记录已经存在，则为用户提供查看和/或编辑它的机会。

例如，如果用户正在添加新的客户记录，他们可能想要查看已为该客户显示的信息。他们可能有其他信息要添加到记录中，例如电话号码。

在这种情况下，拒绝添加记录不如提供查看现有副本的能力有用。

# c# - 当作为普通委托参数提供时，为什么必须强制转换 lambda 表达式

> ID：411579
> 
> 赞同：126
> 
> 时间：2009-01-04T20:00:47.630
> 
> 标签：c#, c#-3.0, delegates, lambda

取方法 System.Windows.Forms.Control.Invoke(Delegate method)

为什么这会产生编译时错误：

```
string str = "woop";
Invoke(() => this.Text = str);
// Error: Cannot convert lambda expression to type 'System.Delegate'
// because it is not a delegate type 
```

然而这很好用：

```
string str = "woop";
Invoke((Action)(() => this.Text = str)); 
```

当方法需要一个普通的委托时？

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2009-01-04T20:07:02.407

lambda 表达式可以转换为委托类型或表达式树 - 但它必须知道*哪种*委托类型。仅仅知道签名是不够的。例如，假设我有：

```
public delegate void Action1();
public delegate void Action2();

...

Delegate x = () => Console.WriteLine("hi"); 
```

您希望引用的对象的具体类型`x`是什么？是的，编译器*可以*生成具有适当签名的新委托类型，但这很少有用，并且您最终会减少错误检查的机会。

如果您想通过最简单的方法轻松调用`Control.Invoke`，`Action`则向 Control 添加扩展方法：

```
public static void Invoke(this Control control, Action action)
{
    control.Invoke((Delegate) action);
} 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-04-03T14:04:11.780

厌倦了一遍又一遍地投射 lambda？

```
public sealed class Lambda<T>
{
    public static Func<T, T> Cast = x => x;
}

public class Example
{
    public void Run()
    {
        // Declare
        var c = Lambda<Func<int, string>>.Cast;
        // Use
        var f1 = c(x => x.ToString());
        var f2 = c(x => "Hello!");
        var f3 = c(x => (x + x).ToString());
    }
} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2011-11-10T00:41:32.197

十分之九的时间人们得到这个是因为他们试图编组到 UI 线程上。这是懒惰的方式：

```
static void UI(Action action) 
{ 
  System.Windows.Threading.Dispatcher.CurrentDispatcher.BeginInvoke(action); 
} 
```

现在它被输入了，问题就消失了（qv Skeet 的回答），我们有了这个非常简洁的语法：

```
int foo = 5;
public void SomeMethod()
{
  var bar = "a string";
  UI(() =>
  {
    //lifting is marvellous, anything in scope where the lambda
    //expression is defined is available to the asynch code
    someTextBlock.Text = string.Format("{0} = {1}", foo, bar);        
  });
} 
```

对于奖励积分，这里有另一个提示。您不会为 UI 内容执行此操作，但如果您需要 SomeMethod 阻塞直到它完成（例如请求/响应 I/O、等待响应），请使用[WaitHandle](http://msdn.microsoft.com/en-us/library/9f7e54k1.aspx)（qv msdn WaitAll、WaitAny、WaitOne）。

请注意，AutoResetEvent 是 WaitHandle 派生类。

```
public void BlockingMethod()
{
  AutoResetEvent are = new AutoResetEvent(false);
  ThreadPool.QueueUserWorkItem ((state) =>
  {
    //do asynch stuff        
    are.Set();
  });      
  are.WaitOne(); //don't exit till asynch stuff finishes
} 
```

最后一个提示，因为事情可能会纠缠不清：WaitHandles 会停止线程。这是他们应该做的。*如果您在停止时*尝试编组到 UI 线程，您的应用程序将挂起。在这种情况下 (a) 需要进行一些严重的重构，并且 (b) 作为临时 hack，您可以像这样等待：

```
 bool wait = true;
  ThreadPool.QueueUserWorkItem ((state) =>
  {
    //do asynch stuff        
    wait = false;
  });
  while (wait) Thread.Sleep(100); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-12-07T01:45:21.630

彼得·沃恩。你是大男人。把你的概念更进一步，我想出了这两个函数。

```
private void UIA(Action action) {this.Invoke(action);}
private T UIF<T>(Func<T> func) {return (T)this.Invoke(func);} 
```

我将这两个函数放入我的表单应用程序中，我可以像这样从后台工作人员拨打电话

```
int row = 5;
string ip = UIF<string>(() => this.GetIp(row));
bool r = GoPingIt(ip);
UIA(() => this.SetPing(i, r)); 
```

也许有点懒，但我不必设置工人完成的功能，在这种情况下非常方便

```
private void Ping_DoWork(object sender, System.ComponentModel.DoWorkEventArgs e)
{
  int count = this.dg.Rows.Count;
  System.Threading.Tasks.Parallel.For(0, count, i => 
  {
    string ip = UIF<string>(() => this.GetIp(i));
    bool r = GoPingIt(ip);
    UIA(() => this.SetPing(i, r));
  });
  UIA(() => SetAllControlsEnabled(true));
} 
```

本质上，从 gui DataGridView 获取一些 IP 地址，ping 它们，将生成的图标设置为绿色或红色，然后重新启用表单上的按钮。是的，它是后台工作人员中的“parallel.for”。是的，它有很多调用开销，但对于短列表和更紧凑的代码来说可以忽略不计。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-12-16T10:15:43.217

我试图根据[@Andrey Naumov](https://stackoverflow.com/a/714044/661933)的回答来构建它。可能这是一个轻微的改进。

```
public sealed class Lambda<S>
{
    public static Func<S, T> CreateFunc<T>(Func<S, T> func)
    {
        return func;
    }

    public static Expression<Func<S, T>> CreateExpression<T>(Expression<Func<S, T>> expression)
    {
        return expression;
    }

    public Func<S, T> Func<T>(Func<S, T> func)
    {
        return func;
    }

    public Expression<Func<S, T>> Expression<T>(Expression<Func<S, T>> expression)
    {
        return expression;
    }
} 
```

其中类型参数`S`是形式参数（输入参数，这是推断其余类型的最低要求）。现在你可以这样称呼它：

```
var l = new Lambda<int>();
var d1 = l.Func(x => x.ToString());
var e1 = l.Expression(x => "Hello!");
var d2 = l.Func(x => x + x);

//or if you have only one lambda, consider a static overload
var e2 = Lambda<int>.CreateExpression(x => "Hello!"); 
```

您可以在同一类中具有类似的`Action<S>`附加重载。`Expression<Action<S>>`对于*其他*内置的委托和表达式类型，您将不得不编写单独的类`Lambda`，例如`Lambda<S, T>`,`Lambda<S, T, U>`等。

我看到了与原始方法相比的优势：

1.  少了一种类型说明（只需要指定形式参数）。

2.  如示例所示，这使您可以自由地使用它来对付任何`Func<int, T>`，而不仅仅是`T`说 ， 。`string`

3.  立即支持表达式。在较早的方法中，您必须再次指定类型，例如：

    ```
    var e = Lambda<Expression<Func<int, string>>>.Cast(x => "Hello!");

    //or in case 'Cast' is an instance member on non-generic 'Lambda' class:
    var e = lambda.Cast<Expression<Func<int, string>>>(x => "Hello!"); 
    ```

    用于表达式。

4.  像上面一样为其他委托（和表达式）类型扩展类同样繁琐。

    ```
    var e = Lambda<Action<int>>.Cast(x => x.ToString());

    //or for Expression<Action<T>> if 'Cast' is an instance member on non-generic 'Lambda' class:
    var e = lambda.Cast<Expression<Action<int>>>(x => x.ToString()); 
    ```

在我的方法中，您只需声明一次类型（对于`Func`s 来说也少了一个）。

* * *

另一种实现安德烈答案的方法就像不完全通用

```
public sealed class Lambda<T>
{
    public static Func<Func<T, object>, Func<T, object>> Func = x => x;
    public static Func<Expression<Func<T, object>>, Expression<Func<T, object>>> Expression = x => x;
} 
```

所以事情减少到：

```
var l = Lambda<int>.Expression;
var e1 = l(x => x.ToString());
var e2 = l(x => "Hello!");
var e3 = l(x => x + x); 
```

那甚至更少打字，但是您会失去某些类型的安全性，而且**imo，这不值得。**

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-07-17T07:56:35.323

派对迟到了，但你也可以这样投

```
this.BeginInvoke((Action)delegate {
    // do awesome stuff
}); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-10-03T06:23:38.747

```
 this.Dispatcher.Invoke((Action)(() => { textBox1.Text = "Test 123"; })); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-08-29T13:40:13.207

使用 XUnit 和[Fluent Assertions](https://fluentassertions.com/introduction)可以以一种我觉得非常酷的方式使用这种内联功能。

**前**

```
[Fact]
public void Pass_Open_Connection_Without_Provider()
{
    Action action = () => {
        using (var c = DbProviderFactories.GetFactory("MySql.Data.MySqlClient").CreateConnection())
        {
            c.ConnectionString = "<xxx>";
            c.Open();
        }
    };

    action.Should().Throw<Exception>().WithMessage("xxx");
} 
```

**后**

```
[Fact]
public void Pass_Open_Connection_Without_Provider()
{
    ((Action)(() => {
        using (var c = DbProviderFactories.GetFactory("<provider>").CreateConnection())
        {
            c.ConnectionString = "<connection>";
            c.Open();
        }
    })).Should().Throw<Exception>().WithMessage("Unable to find the requested .Net Framework Data Provider.  It may not be installed.");
} 
```

# c# - 如何在 C# 中将流保存到文件中？

> ID：411592
> 
> 赞同：807
> 
> 时间：2009-01-04T20:04:39.573
> 
> 标签：c#, .net, stream

我有一个`StreamReader`用流初始化的对象，现在我想将此流保存到磁盘（流可能是`.gif`or`.jpg`或`.pdf`）。

现有代码：

```
StreamReader sr = new StreamReader(myOtherObject.InputStream); 
```

1.  我需要将其保存到磁盘（我有文件名）。
2.  将来我可能希望将其存储到 SQL Server。

我也有编码类型，如果我将它存储到 SQL Server，我将需要它，对吗？

* * *

## 回答 #1

> 赞同：1032
> 
> 时间：2011-04-01T16:01:34.453

正如 Tilendor 在 Jon Skeet 的回答中所强调的那样，流`CopyTo`从 .NET 4 开始就有一种方法。

```
var fileStream = File.Create("C:\\Path\\To\\File");
myOtherObject.InputStream.Seek(0, SeekOrigin.Begin);
myOtherObject.InputStream.CopyTo(fileStream);
fileStream.Close(); 
```

或使用以下`using`语法：

```
using (var fileStream = File.Create("C:\\Path\\To\\File"))
{
    myOtherObject.InputStream.Seek(0, SeekOrigin.Begin);
    myOtherObject.InputStream.CopyTo(fileStream);
} 
```

* * *

## 回答 #2

> 赞同：570
> 
> 时间：2009-01-04T20:08:51.513

不得用于二进制文件（如 gif 或 jpg）*。*用于*文本*数据。如果您将其用于任意二进制数据，您几乎*肯定会*丢失数据。（如果你使用 Encoding.GetEncoding(28591) 你可能会没事，但有什么意义呢？）`StreamReader``StreamReader`

 **为什么你需要使用 a `StreamReader`？为什么不将二进制数据保存*为*二进制数据并将其作为二进制数据写回磁盘（或 SQL）呢？

编辑：因为这似乎是人们想要看到的东西......如果你*只是*想将一个流复制到另一个流（例如到一个文件），请使用这样的东西：

```
/// <summary>
/// Copies the contents of input to output. Doesn't close either stream.
/// </summary>
public static void CopyStream(Stream input, Stream output)
{
    byte[] buffer = new byte[8 * 1024];
    int len;
    while ( (len = input.Read(buffer, 0, buffer.Length)) > 0)
    {
        output.Write(buffer, 0, len);
    }    
} 
```

要使用它将流转储到文件，例如：

```
using (Stream file = File.Create(filename))
{
    CopyStream(input, file);
} 
```

请注意，它[`Stream.CopyTo`](https://docs.microsoft.com/en-gb/dotnet/api/system.io.stream.copyto?view=netframework-4.5#System_IO_Stream_CopyTo_System_IO_Stream_)是在 .NET 4 中引入的，目的基本相同。

* * *

## 回答 #3

> 赞同：87
> 
> 时间：2013-08-01T20:25:08.497

```
public void CopyStream(Stream stream, string destPath)
{
  using (var fileStream = new FileStream(destPath, FileMode.Create, FileAccess.Write))
  {
    stream.CopyTo(fileStream);
  }
} 
```

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2013-12-11T14:38:26.200

```
private void SaveFileStream(String path, Stream stream)
{
    var fileStream = new FileStream(path, FileMode.Create, FileAccess.Write);
    stream.CopyTo(fileStream);
    fileStream.Dispose();
} 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2016-10-12T13:57:59.780

我没有使用 得到所有答案`CopyTo`，可能使用该应用程序的系统可能尚未升级到 .NET 4.0+。我知道有些人想强迫人们升级，但兼容性也很好。

另一件事，我首先没有使用流从另一个流中复制。为什么不这样做：

```
byte[] bytes = myOtherObject.InputStream.ToArray(); 
```

获得字节后，您可以轻松地将它们写入文件：

```
public static void WriteFile(string fileName, byte[] bytes)
{
    string path = Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location);
    if (!path.EndsWith(@"\")) path += @"\";

    if (File.Exists(Path.Combine(path, fileName)))
        File.Delete(Path.Combine(path, fileName));

    using (FileStream fs = new FileStream(Path.Combine(path, fileName), FileMode.CreateNew, FileAccess.Write))
    {
        fs.Write(bytes, 0, (int)bytes.Length);
        //fs.Close();
    }
} 
```

这段代码在我用一个`.jpg`文件测试过它时有效，尽管我承认我只用过小文件（小于 1 MB）。一个流，流之间无需复制，无需编码，只需写入字节！`StreamReader`如果您已经有一个可以`bytes`直接转换为的流，则无需过度复杂化`.ToArray()`！

我可以看到这样做的唯一潜在缺点是，如果您有一个大文件，将其作为流并使用`.CopyTo()`或等效允许`FileStream`流式传输它，而不是使用字节数组并逐个读取字节。因此，这样做可能会更慢。但它不应该阻塞，因为句柄的`.Write()`方法`FileStream`写入字节，并且一次只做一个字节，所以它不会阻塞内存，除非**你必须有足够的内存来保存流作为`byte[]`对象**。在我使用这个的情况下，得到一个`OracleBlob`，我必须去一个`byte[]`，它足够小，而且，无论如何，我没有可用的流媒体，所以我只是将我的字节发送到我的函数，上面。

使用流的另一种选择是将其与`CopyStream`另一篇文章中的 Jon Skeet 函数一起使用 - 这只是用于`FileStream`获取输入流并直接从中创建文件。它`File.Create`不像他那样使用 （最初对我来说似乎有问题，但后来发现它可能只是一个 VS 错误......）。

```
/// <summary>
/// Copies the contents of input to output. Doesn't close either stream.
/// </summary>
public static void CopyStream(Stream input, Stream output)
{
    byte[] buffer = new byte[8 * 1024];
    int len;
    while ( (len = input.Read(buffer, 0, buffer.Length)) > 0)
    {
        output.Write(buffer, 0, len);
    }    
}

public static void WriteFile(string fileName, Stream inputStream)
{
    string path = Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location);
    if (!path.EndsWith(@"\")) path += @"\";

    if (File.Exists(Path.Combine(path, fileName)))
        File.Delete(Path.Combine(path, fileName));

    using (FileStream fs = new FileStream(Path.Combine(path, fileName), FileMode.CreateNew, FileAccess.Write)
    {
        CopyStream(inputStream, fs);
    }

    inputStream.Close();
    inputStream.Flush();
} 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2019-10-27T08:48:46.977

下面是一个正确使用和实现 idisposable 的示例：

```
static void WriteToFile(string sourceFile, string destinationfile, bool append = true, int bufferSize = 4096)
{
    using (var sourceFileStream = new FileStream(sourceFile, FileMode.OpenOrCreate))
    {
        using (var destinationFileStream = new FileStream(destinationfile, FileMode.OpenOrCreate))
        {
            while (sourceFileStream.Position < sourceFileStream.Length)
            {
                destinationFileStream.WriteByte((byte)sourceFileStream.ReadByte());
            }
        }
    }
} 
```

……还有这个

```
 public static void WriteToFile(Stream stream, string destinationFile, int bufferSize = 4096, FileMode mode = FileMode.OpenOrCreate, FileAccess access = FileAccess.ReadWrite, FileShare share = FileShare.ReadWrite)
    {
        using (var destinationFileStream = new FileStream(destinationFile, mode, access, share))
        {
            while (stream.Position < stream.Length) 
            {
                destinationFileStream.WriteByte((byte)stream.ReadByte());
            }
        }
    } 
```

关键是理解 using 的正确使用（这应该在如上所示的实现 idisposable 的对象的实例化上实现），并且对属性如何为流工作有一个好主意。位置实际上是流中的索引（从 0 开始），在使用 readbyte 方法读取每个字节时跟随该索引。在这种情况下，我本质上是使用它来代替 for 循环变量，并简单地让它一直持续到长度，即整个流的结尾（以字节为单位）。忽略字节，因为它实际上是相同的，您将拥有像这样简单而优雅的东西，可以干净地解决所有问题。

还要记住，ReadByte 方法只是在进程中将字节转换为 int，并且可以简单地转换回来。

我将添加我最近编写的另一个实现来创建各种动态缓冲区以确保顺序数据写入以防止大规模过载

```
private void StreamBuffer(Stream stream, int buffer)
{
    using (var memoryStream = new MemoryStream())
    {
        stream.CopyTo(memoryStream);
        var memoryBuffer = memoryStream.GetBuffer();

        for (int i = 0; i < memoryBuffer.Length;)
        {
            var networkBuffer = new byte[buffer];
            for (int j = 0; j < networkBuffer.Length && i < memoryBuffer.Length; j++)
            {
                networkBuffer[j] = memoryBuffer[i];
                i++;
            }
            //Assuming destination file
            destinationFileStream.Write(networkBuffer, 0, networkBuffer.Length);
        }
    }
} 
```

解释很简单：我们知道我们需要记住我们希望写入的整个数据集，而且我们只想写入一定的数量，所以我们希望第一个循环的最后一个参数为空（与 while 相同） ）。接下来，我们初始化一个字节数组缓冲区，该缓冲区设置为传递的大小，在第二个循环中，我们将 j 与缓冲区的大小和原始缓冲区的大小进行比较，如果它大于原始大小字节数组，结束运行。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2010-04-23T22:49:05.560

为什么不使用 FileStream 对象？

```
public void SaveStreamToFile(string fileFullPath, Stream stream)
{
    if (stream.Length == 0) return;

    // Create a FileStream object to write a stream to a file
    using (FileStream fileStream = System.IO.File.Create(fileFullPath, (int)stream.Length))
    {
        // Fill the bytes[] array with the stream data
        byte[] bytesInStream = new byte[stream.Length];
        stream.Read(bytesInStream, 0, (int)bytesInStream.Length);

        // Use FileStream object to write to the specified file
        fileStream.Write(bytesInStream, 0, bytesInStream.Length);
     }
} 
```

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2011-07-07T14:30:01.903

```
//If you don't have .Net 4.0  :)

public void SaveStreamToFile(Stream stream, string filename)
{  
   using(Stream destination = File.Create(filename))
      Write(stream, destination);
}

//Typically I implement this Write method as a Stream extension method. 
//The framework handles buffering.

public void Write(Stream from, Stream to)
{
   for(int a = from.ReadByte(); a != -1; a = from.ReadByte())
      to.WriteByte( (byte) a );
}

/*
Note, StreamReader is an IEnumerable<Char> while Stream is an IEnumbable<byte>.
The distinction is significant such as in multiple byte character encodings 
like Unicode used in .Net where Char is one or more bytes (byte[n]). Also, the
resulting translation from IEnumerable<byte> to IEnumerable<Char> can loose bytes
or insert them (for example, "\n" vs. "\r\n") depending on the StreamReader instance
CurrentEncoding.
*/ 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2014-02-13T11:04:43.633

另一种选择是将流获取到 a`byte[]`并使用`File.WriteAllBytes`. 这应该这样做：

```
using (var stream = new MemoryStream())
{
    input.CopyTo(stream);
    File.WriteAllBytes(file, stream.ToArray());
} 
```

将其包装在扩展方法中可以更好地命名：

```
public void WriteTo(this Stream input, string file)
{
    //your fav write method:

    using (var stream = File.Create(file))
    {
        input.CopyTo(stream);
    }

    //or

    using (var stream = new MemoryStream())
    {
        input.CopyTo(stream);
        File.WriteAllBytes(file, stream.ToArray());
    }

    //whatever that fits.
} 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2013-07-16T06:47:57.673

```
public void testdownload(stream input)
{
    byte[] buffer = new byte[16345];
    using (FileStream fs = new FileStream(this.FullLocalFilePath,
                        FileMode.Create, FileAccess.Write, FileShare.None))
    {
        int read;
        while ((read = input.Read(buffer, 0, buffer.Length)) > 0)
        {
             fs.Write(buffer, 0, read);
        }
    }
} 
```

# json - 处理 json 和 asp.net ajax 中的空白非字符串数据

> ID：411594
> 
> 赞同：0
> 
> 时间：2009-01-04T20:05:52.940
> 
> 标签：json, asp.net-ajax

我试图找出在 asmx Web 服务中指示日期为 null 的最佳方式，以便在用户未在日期字段中输入文本时插入 dbnull.value。目前，我正在序列化的类中有一个字符串字段，它将用作日期字段。当该字符串为空时，我插入 dbnull.value，否则我插入转换为日期时间的字符串。这是唯一的方法还是有更好的方法？整数和双精度数呢？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-04T20:50:19.870

我想这取决于您使用什么机制来插入数据库，例如参数化 SQL、存储过程等。如果使用参数化 SQL，我认为您当前的解决方案很好，尽管如果日期的数据库表字段允许空值，我不'如果日期字段为空，则认为没有必要在 INSERT 语句中为日期列传递值。如果使用存储过程，您可以将日期设置为具有 NULL 默认值的[可选参数。](http://msdn.microsoft.com/en-us/library/ms187926.aspx)

顺便说一句，您是否使用 asp.net ajax 机制来解析 JSON 中的日期？例如

```
\/Date(1169125740)\/

//1169125740 is the number of milliseconds since UTC (Midnight January 1, 1970) 
```

# mysql - 按第一个表的结果分组的第二个表的总和

> ID：411624
> 
> 赞同：0
> 
> 时间：2009-01-04T20:24:05.027
> 
> 标签：mysql

使用 MySQL 语法，我将如何编写查询以返回以下内容（我包括两个表描述以及它们之间的关系）：

```
TABLE_A (ID, DATE, TABLE_C_ID)
TABLE_B (ID, AMOUNT, TABLE_A_ID)
TABLE_C (ID) 
```

我想返回以下内容，并具有指定的限制：

```
SELECT 
    TABLE_A.ID, 
    TABLE_A.DATE 
    (SUM TABLE_B.AMOUNT 
         FROM TABLE_B 
         WHERE TABLE_B.ID = TABLE_A.ID) 
    FROM TABLE_A, TABLE_B 
    WHERE TABLE_A.TABLE_C_ID = 123 
```

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-04T20:59:32.037

这样做有什么问题？：

```
SELECT 
    TABLE_A.ID, 
    TABLE_A.DATE,
    SUM( TABLE_B.AMOUNT ) AS AMOUNT

FROM TABLE_A

INNER JOIN TABLE_B 
ON TABLE_B.ID = TABLE_A.ID

WHERE TABLE_A.TABLE_C_ID = 123

GROUP BY TABLE_A.ID, 
    TABLE_A.DATE 
```

# .net - 如何在 WebBrowser 控件中设置当前 document.domain 以避免“访问被拒绝”？

> ID：411626
> 
> 赞同：4
> 
> 时间：2009-01-04T20:25:59.640
> 
> 标签：.net, webbrowser-control, cross-domain, access-denied

如何`document.domain`在 WebBrowser Control 中设置 current 以避免跨域调用（XMLHTTP 请求或 Iframe/frame 访问）中的“访问被拒绝”？

我试过了

```
CurrentDocument = WebBrowserControl.Document
CurrentDocument.domain = "example.com"
Console.writeline("xx" & CurrentDocument.domain) 
```

这不起作用，不知何故它永远不会到达console.writeline

难道我做错了什么？还是我应该使用`WebBrowserControl.ActiveXInstance`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-05T02:28:52.997

你用什么语言写这个？您是在访问属性[.Domain](http://msdn.microsoft.com/en-us/library/system.windows.forms.htmldocument.domain.aspx)还是不存在的属性 .domain？

# c# - ASP.NET MVC 中的 DRY - 详细信息显示与编辑表单

> ID：411628
> 
> 赞同：4
> 
> 时间：2009-01-04T20:26:25.910
> 
> 标签：c#, asp.net-mvc

我正在尝试学习 ASP.NET MVC，但遇到了这个问题：我有一个“查看产品详细信息”表单，我想将其用作添加/编辑表单。（当您查看产品详细信息时，如果您有权这样做，应该会出现一个编辑链接；它应该重新显示相同的表单，但这次启用了文本框字段。）

现在，详细信息视图看起来像这样：

```
<% var product = ViewData.Model; %>
<table>
  <tr>
    <td>Name</td>
  </tr>
  <tr>
    <td><%= Html.TextBox("Name", product.Name, new { size = "50", disabled = "disabled"})%></td>
  </tr> 
```

有没有一种方法可以重用它而不在视图中添加太多逻辑？例如，我需要移除`disabled = "disabled"`零件（但`size`零件需要保留在那里），将所有内容放入表单等等。

如果它不能完成，那很好，我只是尽量不要重复同样的事情几次，以防我需要改变它（我会的）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-04T22:45:34.710

使用[MvcContrib.FluentHtml](http://www.codeplex.com/MVCContrib)你可以这样做（增强托德史密斯的建议）：

```
<%=this.TextBox(x => x.Name).Size(50).Disabled(ViewData.Model.CanEdit)%> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-04T21:05:31.400

您始终可以传入一个值，指示您所处的模式或您拥有的权限：

```
ViewData.Model.CanEdit 
```

所以你可能想为你的模型创建一个复合类，而不是仅仅使用 Product

```
public class ProductViewData
{
    public Product Product {get; set;}
    public bool CanEdit {get; set;}
} 
```

# java - 将 u1F000 表示为 Java 字符串

> ID：411631
> 
> 赞同：0
> 
> 时间：2009-01-04T20:28:42.660
> 
> 标签：java, unicode

我有一堆 U1F000 及以上的[unicode 字符](http://www.unicode.org/charts/PDF/U1F000.pdf)，我想知道如何用 Java 表示它们。Java unicode 转义采用“\uXXXX”形式，Java 语言规范说“表示补充字符需要两个连续的 Unicode 转义”。这如何适用于 U1F000？

```
String mahjongTile = "\u0001\uf000"; 
```

**似乎**不起作用（我只得到两个空白方块），但我想这可能是字体故障。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-05T09:04:21.450

Jon 的回答应该有效，但您也可以使用`appendCodePoint`StringBuilder 或 StringBuffer 中的方法。

```
StringBuilder sb = new StringBuilder();
sb.appendCodePoint(0x1f000); 
```

这两种技术都会为您转换为代理对。

听起来您现在的问题是让字符正确显示。如果您试图在控制台上显示它们，请忘记它；大多数机器上的控制台太有限了。我建议您将输出写入文件并使用良好的文本编辑器来读取它，或者在 JTextPane 等 Swing 组件中显示输出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-04T20:35:18.497

如果您希望在字符串文字中使用适当的代理对，则需要计算出相应的代理对。（在 C# 中，您可以编写 "\U0001f000" - \u 用于 BMP，\U 用于完整的 Unicode。）

在 Java 中，你可以这样做：

```
String foo = new String(new int[]{0x1f000}, 0, 1); 
```

如果你还想看到它的“1f000”-ness。我承认我不记得我头顶的高/低替代范围:(

# eclipse - 如何找出 Eclipse 在后台做什么？

> ID：411632
> 
> 赞同：9
> 
> 时间：2009-01-04T20:28:59.353
> 
> 标签：eclipse, eclipse-plugin

OS X 10.5.6。

我的 Eclipse 3.4 最近快疯了。

在诸如键入文本或在导航器视图中移动某些文件或保存等无害操作之后，它有时会开始“等待后台操作”，并吃掉一个 CPU 内核，来回移动数十兆字节的内存。

我怀疑某些插件是流氓。

我怎样才能找到它是哪一个（二进制搜索除外）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-04T20:46:24.573

这是一个艰难且通常不可能实现的目标，我曾多次遇到过这个问题。

我一般遵循以下流程：

1）打开进度视图，看看里面有没有列出任何东西；在某些情况下，非系统作业会造成问题，并且实际上已命名。如果此处没有弹出任何内容，则可能是标记为系统的作业（隐藏它），或者甚至不作为作业运行的作业（更糟）

2）在一般偏好下使用显示堆，尝试发现堆大小是否跳跃。默认情况下，Eclipse 在 JVM 堆空间不足的情况下运行，一旦达到极限，即使没有插件出错并卡住，它也会开始搅动。

3) 创建并运行工作区的调试版本并尝试重现问题，然后从其他 Eclipse 中断开程序并查看哪些线程处于活动状态。不幸的是，大多数线程都没有被生成插件识别，这真的很糟糕。

4）不幸的是，开始在搜索上浪费时间。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-05T07:40:19.950

您也可以尝试使用

```
-Dcom.sun.management.jmxremote 
```

选项。

然后启动

```
C:\[jdk1.6.0_0x path]\bin\jconsole.exe 
```

正如这个关于[日食记忆](https://stackoverflow.com/questions/100161#101164)的问题所说。如果您使用 1.6 JVM 启动 eclipse，您将能够监控很多运行时细节。

也尝试[这些设置](https://stackoverflow.com/questions/142357)并检查您的问题是否仍然存在。

# cocoa-touch - 下载带有可变 URL 的图像？

> ID：411633
> 
> 赞同：1
> 
> 时间：2009-01-04T20:29:51.550
> 
> 标签：cocoa-touch

我是新来的，所以请为我哑巴。我一直在为 iPhone 应用程序修改 Objective-C 并且遇到了障碍。

我正在尝试将变量（字符串）中包含的值传递给方法，但它不起作用。我猜这是因为变量可能是指向值的指针，而不是值本身。我想知道你是否可以建议我如何解决。

这是方法

```
- (UIImage *)newUIImageWithURLString:(NSString *)urlString
{
   return [[UIImage alloc] initWithData:[NSData dataWithContentsOfURL:[NSURL URLWithString:urlString]]];
} 
```

发送此消息有效...在这里，我已经对 URL 进行了硬编码，正在发送。

```
UIImage* newimage = [self newUIImageWithURLString:@"http://images.mydomain.com/PhotoServer/Thumb/97/83358897.jpg"]; 
```

这个没有...这里正在传递变量。我收到一个错误，即传递的值没有值。

```
UIImage* newimage = [self newUIImageWithURLString:newListing.ListingPhotoUrl]; 
```

我知道它确实有价值，因为以下确实有效。

```
self.ListingtitleLabel.text = newListing.ListingPhotoUrl; 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-04T21:33:43.153

您确定动态 URL 有效吗？例如，如果 newListing.ListingPhotoURL 不是有效的 URL 或无法访问，您将收到此错误，因为您没有进行任何错误检查。虽然您的代码很简洁，但您在调试时可能应该稍微冗长一些，或者至少在您对语言更加熟悉之前。我建议这样重写你的方法：

```
-(UIImage*)newUIImageWithURLString:(NSString*)urlString {
  NSParameterAssert(urlString);
  NSData *pictureData = [NSData dataWithContentsOfURL:[NSURL URLWithString:urlString]];
  NSAssert1(pictureData, @"No data returned for url: %@", urlString);
  return [[UIImage alloc] initWithData:pictureData];
} 
```

使用这样编写的方法，您将立即知道是否某些行为未按预期进行（断言宏将引发异常）。如果您尝试调试某些东西，这也为您提供了更细粒度的位置来设置断点。

# database - 你怎么不做连接？

> ID：411646
> 
> 赞同：3
> 
> 时间：2009-01-04T20:40:40.873
> 
> 标签：database, performance, optimization, schema, scalability

我最近读了很多关于数据库查询中的连接如何减慢速度的文章。显然 Google App Engine 甚至不允许它们。

我想知道人们如何设计一个没有连接的应用程序。例如，我正在开发一个具有`contacts`和的应用程序`organizations`。一个联系人可以在多个组织中，一个组织可以有多个联系人。如果没有连接两个实体的第三张表，怎么可能建立这种关系......

```
contacts --< contacts_organizations >-- organizations 
```

这是否意味着在 GAE 中不能建立多对多关系？您只是省略了需要加入的功能？

我猜您可能`organizations`在表中有一个 TEXT 列，其中`contacts`包含以空格分隔的每个联系人的组织 ID 列表。不过这似乎有点奇怪。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-04T21:20:15.270

这是一个将软件减速的神话，就像断言在应用程序代码中编写循环会使软件减速一样是一个神话。

*我的意思是，为什么要写一个循环？那只是一次又一次地运行相同的代码行！一次还不够吗？这是一个巨大的浪费！*

上述陈述旨在具有讽刺意味。

我的观点是，一个查询包含一个连接，目的是：得到正确的答案。低效或不必要地使用连接当然是糟糕的设计，例如将循环不变的代码放入循环中。

避免连接作为一般策略是**过早优化**的一个例子。如果你编写高效代码的方法是想出这样的一揽子规则，那么避免连接对你没有帮助。

* * *

至于 Google App Engine，它确实支持实体之间的关系，但由于它不是严格意义上的关系数据库模型，所以连接的概念并没有真正出现。相反，您可以从给定的引用中获取相关实体，这更像是模型的 ORM 接口，它与 SQL 中的联接不同。

您可以在此处阅读更多信息： [http ://code.google.com/appengine/articles/modeling.html](http://code.google.com/appengine/articles/modeling.html)

（该链接在此线程的另一个答案中，但已被删除）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-04T22:33:41.193

挑剔点：Google 不允许在其数据库中使用 JOIN 以防止用户运行“昂贵”的查询；数据库不是关系型的，所以“JOIN”SQL 动词一开始并不真正适用。

通过这种方式，BigTable 与[Amazon 的 SimpleDB](http://aws.amazon.com/simpledb/)相同- 数据被非规范化并剥离了模式，因此您可以有效地最终获得巨大、高效的哈希表，其中包含桶中允许的任意数据。

这些哈希表非常非常容易扩展，尤其是与关系数据库相比。对于像 GAE 这样的应用程序，极端的可扩展性比完整的功能集具有更高的优先级。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-04T20:48:31.530

您使用`db.ReferenceProperty`来链接对象，有关详细信息和示例，请参阅[Google App Engine：一对多 JOIN](http://blog.arbingersys.com/2008/04/google-app-engine-one-to-many-join.html)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-05T00:45:18.040

通常，当您谈论不允许连接的数据库时，您谈论的是不一定适合一台服务器的非常大的数据库。最近的例子是云数据库，如[Amazon 的 SimpleDB](http://aws.amazon.com/simpledb/)、[Microsoft 的 SQL Data Services](http://www.microsoft.com/azure/data.mspx)和[Google 的 App Engine Datastore](http://code.google.com/appengine/docs/datastore/)。有些提供有限的连接能力，但最大的困难是跨“[分区](http://en.wikipedia.org/wiki/Partition_(database))”进行连接。在像这样的大型数据库中，您对数据进行分区，因此它不必驻留在同一台服务器上。您必须决定对它进行分区的正确方法。

在您的示例中，我会将组织键列表存储在联系人表的字段中，反之亦然。这些数据库的设计与典型的规范化数据库不同。这些表通常是“稀疏表”，这基本上意味着每条记录可以有任意数量的字段，这些字段基本上是名称/值对。想想亚马逊上的产品表，以及不同类型的产品可能有多少不同的字段。书籍有页数，但 MP3 有持续时间。在稀疏表中，这些记录将存储在同一个表中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-04T21:36:09.733

我认为谷歌正在剥夺你一些计算量大的机制，所以你会寻找可以利用更多其他类型资源的方法，例如硬盘维护参考表和/或计数表，而不是浪费 CPU 周期来连接和聚合计算。

这并非不可能，您只需要使用*其他*类型的资源来帮助您解决它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-05T01:00:49.897

您可以在您的应用程序而不是数据库服务器中执行连接，方法是分别从每个表中获取结果然后将它们组合起来，但是对于大多数连接来说，这样做只会减慢您的速度，因为进行多次数据库往返而不是仅仅一。

但是：诚实的事实是加入不是你的问题。到了他们的时候，如果有的话，你甚至不需要问这个问题。您可以数出实际项目的数量，这些项目在您的手指上（主要是 Ebay），并且没有证据表明完全消除连接是这些项目可以扩展的唯一方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-07-23T22:02:41.060

您提到的数据库充其量是版本化的记录存储，旨在跨多个服务器存储大量数据。称它们为“数据库”将是一个延伸。不支持连接，也不支持 ACID 事务，回滚等。您可以编写没有它们的应用程序，但通常需要做更多的工作来提供功能。

为了：

```
contacts --< contacts_organizations >-- organizations 
```

您可以对联系人中的组织和组织中的联系人进行去规范化和存储。但是您必须在应用程序处理同时更新到两个表时强制执行参照完整性。

更好的解决方案是将数据存储在三个表中并自己进行“连接”。

# exception - 如何处理这个异常？

> ID：411651
> 
> 赞同：3
> 
> 时间：2009-01-04T20:44:49.010
> 
> 标签：exception, haskell

Haskell 今天让我头疼。我想处理一个异常。当它到达顶部时，它会打印如下：

*** 例外：../p/trip/Trip.hs:(88,16)-(89,50)：函数拆分中的非详尽模式

对我来说，它看起来像是 PatternMatchFail，但这不起作用：

```
handle (\(PatternMatchFail _) -> return env) f 
```

我的意思是，它编译，但不处理异常。我究竟做错了什么？这是错误的例外还是什么？有没有办法捕捉任何异常？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-04T22:04:50.687

如果修复错误的来源不是一个选项，你应该看看这个： [http ://www.haskell.org/ghc/docs/latest/html/libraries/base/Control-Exception.html](http://www.haskell.org/ghc/docs/latest/html/libraries/base/Control-Exception.html)

我相信使用 Control.Exception 中的“handle”或“try”或“catch”或任何其他内容是这里的关键，标准前奏中的函数仅处理 IO-Exceptions，而不是纯代码中的错误。

在 Haskell98 中，纯代码无法处理异常。纯函数必须返回值，异常是返回值失败。

例子：

```
import qualified Control.Exception as C
x ::String
x = undefined
y = "return value"

main = do C.handle (\_ -> return "caught") (C.evaluate x) >>= print
          C.handle (\_ -> return "caught") (C.evaluate y) >>= print 
```

调用评估是强制对 x 和 y 进行评估，haskell 是懒惰的。

如果您让 x 的评估推迟到稍后（懒惰地），该异常也将稍后抛出，在不同的地方（在这种情况下，它是使用该值的“打印”），它可能不会被捕获。

# xcode - 如何更改默认版权模板

> ID：411653
> 
> 赞同：12
> 
> 时间：2009-01-04T20:46:37.210
> 
> 标签：xcode, templates, xcode-template

每当我在 xcode 中创建一个新文件时，它都会在文件顶部放置如下内容：

```
//  Copyright __MyCompanyName__ 2008\.  All rights reserved. 
```

我怎样才能将其更改为有用的东西？

更新：[在这里找到答案](https://stackoverflow.com/questions/33720/change-templates-in-xcode#33789)。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-04T21:02:35.040

从 Xcode 3 开始，它将使用地址簿卡中的“公司”字段。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2015-12-02T16:04:50.457

请按照以下步骤更改版权：

[![在此处输入图像描述](https://i.stack.imgur.com/6wDAx.png)](https://i.stack.imgur.com/6wDAx.png)

注意：更改适用于您创建的新文件，因此您需要更新之前手动创建的文件。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-02-10T22:34:03.957

从 Xcode 6.1.1 开始，这可以通过单击项目视图中的主 .xcodeproj 文件（蓝色的）来更改。右侧面板有一个名为“组织”的字段，将用于版权模板。该面板可以隐藏，并且可以通过右上角的按钮使其可见。

# c# - 企业库 Unity 与其他 IoC 容器

> ID：411660
> 
> 赞同：136
> 
> 时间：2009-01-04T21:00:30.897
> 
> 标签：c#, .net, inversion-of-control, unity-container, enterprise-library

与其他 IoC 容器（Windsor、Spring.Net、Autofac ..）相比，使用 Enterprise Library Unity 的优缺点是什么？

* * *

## 回答 #1

> 赞同：237
> 
> 时间：2009-01-08T03:35:11.270

我正在为一个用户组准备一个演示文稿。因此，我刚刚经历了一堆。即：AutoFac、MEF、Ninject、Spring.Net、StructureMap、Unity 和 Windsor。

我想展示 90% 的案例（构造函数注入，这主要是人们使用 IOC 的主要目的）。 [您可以在此处查看解决方案（VS2008）](https://cid-b0ed6c076f2f2bfe.skydrive.live.com/self.aspx/Public/IocDemo.zip)

因此，有几个关键区别：

*   初始化
*   对象检索

它们中的每一个也都有其他特性（有些具有 AOP 和更好的 gizmo，但通常我想要 IOC 做的只是为我创建和检索对象）

注意：不同库对象检索之间的差异可以通过使用 CommonServiceLocator 来消除：http: [//www.codeplex.com/CommonServiceLocator](http://www.codeplex.com/CommonServiceLocator)

这给我们留下了初始化，它通过两种方式完成：通过代码或通过 XML 配置 (app.config/web.config/custom.config)。有的两者都支持，有的只支持一个。我应该注意：一些使用属性来帮助 IoC。

所以这是我对差异的评估：

### [忍者](http://ninject.org/)

仅代码初始化（带有属性）。我希望你喜欢 lambdas。初始化代码如下所示：

```
 IKernel kernel = new StandardKernel(
                new InlineModule(
                    x => x.Bind<ICustomerRepository>().To<CustomerRepository>(),
                    x => x.Bind<ICustomerService>().To<CustomerService>(),
                    x => x.Bind<Form1>().ToSelf()
                    )); 
```

### [结构图](http://structuremap.sourceforge.net/)

初始化代码或 XML 或属性。v2.5 也非常 lambda'y。总而言之，这是我的最爱之一。关于 StructureMap 如何使用属性的一些非常有趣的想法。

```
ObjectFactory.Initialize(x =>
{
    x.UseDefaultStructureMapConfigFile = false;
    x.ForRequestedType<ICustomerRepository>()
        .TheDefaultIsConcreteType<CustomerRepository>()
        .CacheBy(InstanceScope.Singleton);

    x.ForRequestedType<ICustomerService>()
        .TheDefaultIsConcreteType<CustomerService>()
        .CacheBy(InstanceScope.Singleton);

    x.ForConcreteType<Form1>();
 }); 
```

### [统一](http://codeplex.com/unity)

初始化代码和 XML。不错的库，但 XML 配置令人头疼。微软或高速公路商店的大图书馆。代码初始化很简单：

```
 container.RegisterType<ICustomerRepository, CustomerRepository>()
          .RegisterType<ICustomerService, CustomerService>(); 
```

### [春天.NET](http://www.springframework.net/)

XML 仅据我所知。但是对于功能，Spring.Net 在阳光下可以做 IoC 可以做的所有事情。但是因为统一化的唯一方法是通过 XML，所以 .net 商店通常会避免使用它。虽然，很多 .net/Java 商店都使用 Spring.Net，因为 .net 版本的 Spring.Net 和 Java Spring 项目之间的相似性。

**注意**：现在可以通过引入[Spring.NET CodeConfig](http://www.springframework.net/codeconfig/)在代码中进行配置。

### [温莎](http://www.castleproject.org/container/index.html)

XML 和代码。像 Spring.Net 一样，Windsor 会做任何你想做的事情。Windsor 可能是最流行的 IoC 容器之一。

```
IWindsorContainer container = new WindsorContainer();
container.AddComponentWithLifestyle<ICustomerRepository, CustomerRepository>("CustomerRepository", LifestyleType.Singleton);
container.AddComponentWithLifestyle<ICustomerService, CustomerService>("CustomerService",LifestyleType.Singleton);
container.AddComponent<Form1>("Form1"); 
```

### [自动法](http://code.google.com/p/autofac/)

可以混合使用 XML 和代码（使用 v1.2）。不错的简单 IoC 库。似乎没有大惊小怪地做基础知识。支持具有组件本地范围和明确定义的生命周期管理的嵌套容器。

以下是初始化它的方法：

```
var builder = new ContainerBuilder();
builder.Register<CustomerRepository>()
        .As<ICustomerRepository>()
        .ContainerScoped();
builder.Register<CustomerService>()
        .As<ICustomerService>()
        .ContainerScoped();
builder.Register<Form1>(); 
```

* * *

如果我今天必须选择：我可能会选择 StructureMap。它对 C# 3.0 语言特性的支持最好，并且在初始化方面具有最大的灵活性。

**注意**：Chris Brandsma 将他的原始答案变成了[一篇博文](http://elegantcode.com/2009/01/07/ioc-libraries-compared/)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-04T21:27:16.553

据我所见，它们几乎相同，除了这里和那里的一些实现细节。Unity 在竞争中最大的优势是它是由微软提供的，那里有很多公司害怕 OSS。

一个缺点是它相当新，所以它可能有老玩家已经解决的错误。

话虽如此，您可能想[检查一下](http://weblogs.asp.net/podwysocki/archive/2008/02/22/ioc-and-the-unity-application-block-going-deeper.aspx)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-09-28T09:28:13.287

旧线程，但因为这是谷歌在我输入 unity vs spring.net 时向我展示的第一件事......

如果你不喜欢 XML 配置，Spring 现在会做 CodeConfig

[http://www.springframework.net/codeconfig/doc-latest/reference/html/](http://www.springframework.net/codeconfig/doc-latest/reference/html/)

此外，Spring 不仅仅是一个 DI 容器，如果您查看文档中的“模块”部分，DI 容器是它所做的大量事情的基础。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-16T04:08:03.190

如果我弄错了，请纠正我，但我认为 Autofac 本身支持此链接中列出的 XML 配置：[Autofac XML 配置](http://code.google.com/p/autofac/wiki/XmlConfiguration)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-11-27T11:34:12.637

Spring 有一个特性，它可以根据参数名称或位置向构造函数或属性注入参数。如果参数或属性是简单类型（例如整数、布尔值），这将非常有用。请参阅[此处的示例](http://therning.org/niklas/2006/09/spring-and-named-constructor-arguments/)。我认为这并不能真正弥补 Spring 无法在代码中进行配置的原因。

Windsor 也可以做到这一点，并且可以在代码而不是配置中做到这一点。（如果我错了，请纠正我，我只是通过我在这里听到的内容）。

我想知道Unity是否可以做到这一点。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-11-12T00:37:00.237

需要注意的一点：Ninject 是唯一支持上下文依赖注入的 IoC 容器（根据他们的网站）。但是，因为我没有使用其他 IoC 容器的经验，所以我无法判断这是否成立。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-04-24T19:37:49.887

只是为了增加我的 2 美分，我尝试了 StructureMap 和 Unity。我发现 StructureMap 的文档记录很差/有误导性，配置起来很麻烦，而且使用起来很笨拙。同样，它似乎不支持解析时构造函数参数覆盖之类的场景，这对我来说是一个关键的使用点。所以我放弃了它并选择了 Unity，它在大约 20 分钟内完成了我想做的事情。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-05-31T13:00:14.043

我个人使用 Unity，但只是因为它来自 Microsoft。我对这个决定感到遗憾有一个原因：它最大的问题是有一个大“错误”导致它不断抛出异常。您可以在调试时忽略异常。但是，如果您遇到它，它会**极大**地减慢您的应用程序，因为抛出异常是一项昂贵的操作。例如，我目前正在我的代码中的一个地方“修复”这个异常，Unity 的异常使页面的渲染时间增加了**4 秒。**有关更多详细信息和解决方法，请参阅：

[可以让 Unity 始终不抛出 SynchronizationLockException 吗？](https://stackoverflow.com/questions/2873767/can-unity-be-made-to-not-throw-synchronizationlockexception-all-the-time)

# iphone - iPhone 应用程序：如何实现像内置按钮一样的滑块按钮

> ID：411661
> 
> 赞同：0
> 
> 时间：2009-01-04T21:01:42.967
> 
> 标签：iphone, cocoa-touch

我说的是 iPhone 上的“滑动解锁”按钮。任何想法如何在我自己的 iPhone 应用程序中实现一个？我不认为它是 IB 中的控件，或者我只是错过了它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-04T23:48:31.430

这不是提供的控件，您必须自己动手。这应该不会太难，只需使用触摸方法（请参阅 UIResponder）为视图提供功能。

# paradigms - 我们可以从您最近的灾难性范式转变中学到什么？

> ID：411668
> 
> 赞同：3
> 
> 时间：2009-01-04T21:07:06.203
> 
> 标签：paradigms

偶尔，我们会经历一次颠覆我们假设的软件学习体验，我们会从全新的角度看待软件开发。对于我们中的大多数人来说，我怀疑最明显的一个是向核心 OOP 的过渡。您还经历过哪些此类地震，您建议我们如何利用您的经验来质疑我们的假设？

编辑：也许对你学到的东西有一些建议，以及它如何改变你的编程？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-05T01:13:44.363

不是最近的，但我是作为一个业余爱好者开始编程的。我成为了这方面的专家，通过自学学会了我需要知道的一切。我上大学是为了获得计算机科学的 2 年学位，在我的课程中航行，并且完全没有学到任何新信息。这太容易了，在为留言板做出贡献并看到其他人挣扎之后，我自我评估自己至少与任何 10 年的老手一样是一名优秀的程序员。

于是我得到了我的第一份编程工作。当我去敲定我的第一行代码时，那些实际上会被其他人使用的代码，这对我打击很大：**我写代码很烂**。

只是有机会看看其他人的代码，听他们谈论 DLL、版本控制、将程序集放入 GAC、设计模式、测试驱动开发，所有这些在大学里从来没有人费心提及的外国概念我意识到我对编程几乎一无所知。大学和自学并没有让我为真正的交易做好准备。事实证明，我可以编写代码来做任何我想做的事情，但我根本不是一个高水平的思想家，而且我编写的任何代码都非常糟糕。

好吧，6 个月的实际经验解决了这个问题，帮助消除了一些坏习惯，让我对代码的实际外观有了很好的感觉。所以，我在这里，自我感觉良好，但我遇到了一个我无法解决的问题：我有一个对象嵌套在另一个对象的 5 层深处，我希望它通知最外面的对象它的状态已经改变。我想不出一个明显的方法来做到这一点，所以我咨询了一位同事，他借给我一本关于 Java 设计模式的书。我读了这本书，它让我大开眼界，发现我错过了多少：有一个我以前从未见过的设计模式世界，为我从未想过的问题提出了优雅的解决方案。

然后它又一次打击了我，一直以来我都错过了很多东西，我根本不是一个高水平的思想家，而我为解决 GoF 书中描述的相同问题而写的 hack 让它变得平淡无奇很明显：**我不擅长写代码**。

又过了 6 个月，我成为了设计模式的大师。我在抽象工厂中生活和呼吸，长篇大论地抱怨为什么 MVC 远远优于 MVP，向我床边的 Martin Fowler 的金色偶像祈祷。所以，无论如何，我想通过学习一些额外的语言来提升我的简历。我在列表中添加了 Python、C#、Perl，但我真的很厌倦一遍又一遍地学习相同的东西，只是语法上的细微变化。我决定看一种奇怪的语言，我偶然发现了一些 Haskell 的片段。由于不知道该语言是什么，我阅读并发现了一个完整的编程范式，称为函数式编程。只是为了好玩，我学习了一种函数式编程语言（我选择 OCaml 而不是 Haskell 和 Lisp），它完全改变了我对编程的看法。

在运行了那个小实验之后，它再次击中了我：**我不擅长写代码**

这个函数式编程世界是如何在我不知道的情况下存在的？为什么没有人早点告诉我这件事？想一想，我曾经为自己能够抽出几十个 Java 类而感到自豪，实际上是 1000 行代码创建抽象工厂、具体工厂、访问者等的层次结构。当我精通 OCaml 时，我的应用程序中的行数下降了 20:1。数十个潜在的 Java 层次结构分解为几个 OCaml 联合，所有这些都适合单个屏幕。从那以后，我一直在乘坐函数式编程火车。

这里的教训很简单：如果你认为自己是最好的程序员，那你就糟透了。“我知道要知道的一切”的心态是幼稚的，会限制你成为真正优秀程序员的能力。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-04T21:26:03.560

[测试驱动开发](http://www.agiledata.org/essays/tdd.html)?

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-04T21:20:44.770

不知道这些是否算作范式转变，但是...

*   [Lambda演算](http://en.wikipedia.org/wiki/Lambda_calculus)
*   [贝叶斯定理](http://yudkowsky.net/rational/bayes)

是去年我还在上大学的时候大开眼界。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-04T21:27:59.263

我们可以了解到，许多花哨的名称只是赋予旧式想法的名称，这些想法经过了一些修饰和形式化。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-04T21:14:23.723

闭包，[lambda 函数](http://www.secnetix.de/olli/Python/lambda_functions.hawk)...

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-04T21:26:53.090

对我来说，依赖注入和控制反转。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-04T23:28:47.757

[***映射***和***减少***](http://en.wikipedia.org/wiki/MapReduce)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-04T21:10:41.297

3GL 到 4GL ;)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-04T23:21:23.653

类型推断。在对 Java 繁琐、官僚的类型规范装置感到非常沮丧之后，发现 SML 并看到静态类型几乎*可以*毫不费力地让我大开眼界（这让我对 Java*更加*沮丧......）。请注意，从那以后我就没有*使用*过类型推断语言（通常，要么我没有选择语言，要么我选择了 Python），但是看到可以做什么已经极大地影响了我对做什么*的*态度......

# http - 监控、模拟、创建 HTTP 数据包

> ID：411669
> 
> 赞同：2
> 
> 时间：2009-01-04T21:09:04.543
> 
> 标签：http, networking

我用 WireShark 做了一些 HTTP 监控。是否有更多类似的工具可以让您创建自己的 HTTP 消息？想到 Telnet

可以很方便地了解您的网站是如何防黑客的......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-04T21:26:17.817

Charlse HTTP 代理工具是我的最爱。您可以手动创建 HTTP 请求或编辑现有的 HTTP 请求。[http://www.charlesproxy.com/](http://www.charlesproxy.com/)

完全免费的工具是 Fiddler，它具有类似的功能[http://www.fiddlertool.com/fiddler/](http://www.fiddlertool.com/fiddler/)

Charlse 在不同的操作系统上运行，它位于 java VM 之上。Fiddler 在 windows dot net 上运行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-04T21:31:48.883

我发现[Tamper Data](https://addons.mozilla.org/en-US/firefox/addon/966)非常有用的 Firefox 插件可以用来处理 HTTP 标头和参数。如果/当您想破解您的（或其他人 :) ）网站时，这非常有用。

-凯

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-04T21:32:02.830

对于 Mac，我喜欢 HTTP 客户端。

[http://ditchnet.org/httpclient/](http://ditchnet.org/httpclient/)

哇！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-04T21:35:51.260

我一直很幸运使用[Netcat](http://en.wikipedia.org/wiki/Netcat)。一个非常简单的命令行实用程序，它允许您通过 TCP/IP 发送您想要的任何内容。[HTTP](http://en.wikipedia.org/wiki/HyperText_Transfer_Protocol)本身非常简单，因此您可以手工制作它。示例用法：

```
nc www.mywebsite.com 80
GET / HTTP/1.0
(hit return twice) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-04T22:51:30.517

如果您需要更强大的应用程序，请查看 WebScarab。在 java 上运行并包含主要用于监控的全部功能，但它更像是一种高级安全工具。

> WebScarab 旨在成为任何需要公开基于 HTTP(S) 的应用程序工作的人的工具，无论是允许开发人员调试其他困难的问题，还是允许安全专家以应用程序的方式识别漏洞已经设计或实施。

[在这里](http://www.owasp.org/index.php/Category:OWASP_WebScarab_Project)可用

# ide - 当您在名称后添加点时，向您显示成员的 IDE 弹出窗口的一般术语是什么？

> ID：411676
> 
> 赞同：1
> 
> 时间：2009-01-04T21:11:26.397
> 
> 标签：ide, terminology

我正在写一篇学术论文，我需要参考大多数面向 OO 语言的 IDE 中存在的功能，您可以在源代码中键入对象名称，添加点，然后会弹出一些内容并让您选择成员。

我正在寻找一个通用的（不是 IDE 特定的术语，尽管我也有兴趣了解这些），它专门指此功能和弹出窗口，而不是所有支持功能（例如，“内容辅助”或类似的东西） . 该术语应与大多数 IDE 中的成员列表或大纲视图区分开来。

我的论文涉及 Eclipse 和 Java，但我想知道是否有一个被广泛接受的术语。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-04T21:13:42.523

[intellisense](http://en.wikipedia.org/wiki/IntelliSense)是您正在寻找的微软采用的名称:)

[自动完成](http://en.wikipedia.org/wiki/Autocompletion)是在其他程序非 Microsoft 财产中使用的术语

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-04T21:12:45.707

[Intellisense](http://en.wikipedia.org/wiki/IntelliSense)就是微软所说的，而且这似乎是普遍使用的。“自动完成”也可以正常工作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-04T22:31:19.620

“自动完成”是更通用的术语。我会避免使用特定于供应商的行话。

（此外，在不太可能的情况下，不知道该术语的读者更有可能从上下文中弄清楚“自动完成”的含义。“智能感知”就像“潮汐”或“承诺”；你'永远不要从名字中猜出它是什么。;-)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-04T21:36:24.193

我认为 AutoComplete 并没有完全捕捉到它。请参阅有关 Joel on Software 的讨论：

[http://discuss.joelonsoftware.com/default.asp?joel.3.457350.17](http://discuss.joelonsoftware.com/default.asp?joel.3.457350.17)

我认为“内容辅助”或类似的东西在学术论文中是可以接受的。正如该论坛的另一位发帖者所指出的，我认为 Intellisense 正变得很像 Kleenex 或“google”（动词形式）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-04T21:41:47.817

我认为“智能感知”一词可能是传播最广的，只需要几个滴答声就可以理解。我会同意的。

在我使用 Visual Studio 之前，我最熟悉的术语是“Code Insight”，它也很容易理解。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-04T21:36:54.940

如果您指的是弹出的小列表，我通常将其称为自动建议弹出菜单。

# javascript - 如何扩展 jQuery 以更轻松地检索 tagName

> ID：411688
> 
> 赞同：19
> 
> 时间：2009-01-04T21:16:39.787
> 
> 标签：javascript, jquery

我正在寻找扩展 jQuery，以便我可以轻松地检索 jQuery 对象中第一个元素的 tagName。这是我想出的，但它似乎不起作用：

```
$.fn.tagName = function() {
    return this.each(function() {
        return this.tagName;
    });
}
alert($('#testElement').tagName()); 
```

有什么想法有什么问题吗？

顺便说一句，我希望将其更多地用于测试而不是生产。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-01-04T21:19:19.237

试试这个：

```
$.fn.tagName = function() {
    return this.get(0).tagName;
}
alert($('#testElement').tagName()); 
```

为了进一步解释为什么您的原始示例不起作用，该`each()`方法将始终返回原始 jQuery 对象（除非 jQuery 对象本身被修改）。要查看每个代码中发生了什么，这里有一些伪代码显示了该`each()`方法的工作原理：

```
function each(action) {
    for(var e in jQueryElements) {
        action();
    }
    return jQueryObject;
} 
```

这不是`each()`真正实现的方式（可能是很长的镜头），但它表明您的`action()`函数的返回值被忽略了。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-05T11:07:01.687

为什么要创建一个插件？好像有点没必要……

```
alert( $('div')[0].tagName ); 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-04-10T18:44:35.343

您可能希望添加一个 toLowerCase() 以使其更加一致（并且符合 XHTML）。

```
$.fn.tagName = function() {
    return this.get(0).tagName.toLowerCase();
}

alert($('#testElement').tagName()); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-09-03T10:32:24.447

这将返回匹配元素的小写标记名。

例如，

```
jQuery("#test_div").tagName(); 
```

将返回`div`（假设该元素是一个 div）。

如果您传递一个元素集合，它会返回一个包含所有标记名的数组，其中每个数组条目对应于匹配的元素。

例如，如果我们运行

```
jQuery(".classname").tagName(); 
```

在以下 (X)HTML 上：

```
<div>
<p class="classname">test text</p>
<div class="anotherClass">
    <ul>
        <li class="classname"><a href="test">Test link</a></li>
    </ul>
    <p class="classname">Some more text</p>
</div>
<div> 
```

将一个标记名数组：

```
["p", "li", "p"] 
```

这就是功能 - 它与上面的基本相同，但它支持多个元素，这对您的项目可能有用也可能没有用。

```
jQuery.fn.tagName = function(){
    if(1 === this.length){
        return this[0].tagName.toLowerCase();
    } else{
        var tagNames = [];
        this.each(function(i, el){
            tagNames[i] = el.tagName.toLowerCase();
        });
        return tagNames;
    }
}; 
```

# python - gtk.Builder，容器子类和绑定子小部件

> ID：411708
> 
> 赞同：4
> 
> 时间：2009-01-04T21:30:01.600
> 
> 标签：python, gtk, bind, subclass, gtkbuilder

我正在尝试在 gtk.Builder 定义文件中使用自定义容器小部件。至于实例化这些小部件，它工作得很好：

```
#!/usr/bin/env python

import sys 
import gtk 

class MyDialog(gtk.Dialog):
    __gtype_name__ = "MyDialog"

if __name__ == "__main__":
    builder = gtk.Builder()
    builder.add_from_file("mydialog.glade")

    dialog = builder.get_object("mydialog-instance")
    dialog.run() 
```

现在的问题是说我在那个对话框中有一个 gtk.TreeView 小部件。我试图弄清楚如何将该小部件绑定到 MyDialog 实例变量。

我能想到的一种便宜的替代方法是在获取对话框小部件后调用其他方法，如下所示：

```
dialog = builder.get_object("mydialog-instance")
dialog.bind_widgets(builder) 
```

但这似乎相当尴尬。有没有人已经解决了这个问题，或者对如何去做有更好的想法？

谢谢，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-05T01:56:06.743

好吧，我想我回答了我自己的问题。

执行上述操作的一种方法是覆盖 gtk.Buildable 的 parser_finished()，它可以访问创建类实例本身的构建器对象。该方法在整个 .xml 文件加载后调用，因此我们可能想要获取的所有其他小部件都已经存在并已初始化：

```
class MyDialog(gtk.Dialog, gtk.Buildable):
    __gtype_name__ = "MyDialog"

    def do_parser_finished(self, builder):
        self.treeview = builder.get_object("treeview1")
        # Do any other associated post-initialization 
```

需要注意的一点是，由于某种原因（至少对我而言，在 pygtk 2.12 中），如果我没有明确地从 gtk.Buildable 继承，则不会调用 override 方法，即使 gtk.Dialog 已经实现了 buildable界面。

# f# - 如何在 f# 中声明和使用标记接口？

> ID：411709
> 
> 赞同：20
> 
> 时间：2009-01-04T21:30:20.477
> 
> 标签：f#

你如何在 F# 中复制它？

```
interface IMarker
{
    // No members here
}

class MyClass : IMarker
{
// can contain code
} 
```

更新：以下代码确实定义了标记接口，但到目前为止，没有一个答案能够产生实现此标记接口的类（参见上面的 MyClass）

```
type IMarker = interface     end 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2011-02-23T21:37:09.720

一个老问题，但这种特殊情况所需的语法（F# 2.0）实际上是：

```
type IMarker = interface end

type Marker =
  class
    interface IMarker
  end 
```

或者（包括标记的构造函数）：

```
type IMarker = interface end

type Marker() =
    interface IMarker 
```

只是写

```
type Marker =
  interface IMarker 
```

不可能，因为您似乎想创建一个新的接口类型。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-04T22:27:36.837

```
type IMarker = interface     end
type MyClass = interface IMarker 
```

（更新）

F# 总是隐式定义接口，您需要强制转换为接口才能使用它。

[为什么 F# 接口与 C# 有很大不同](http://cs.hubfs.net/forums/thread/7523.aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-04T22:59:34.883

为了获得空类型，我相信您将不得不恢复为非轻量级语法（接口...结束）。

```
#light

type IMarker = 
    interface
    end

type Marker =
    interface IMarker 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-04T21:41:48.050

在我的脑海中（没有启动 Visual Studio）：

```
type IMarker ;

type MyClass =
  interface IMarker 
```

# sql - SQL 中的最佳 LIKE 搜索

> ID：411724
> 
> 赞同：7
> 
> 时间：2009-01-04T21:38:30.523
> 
> 标签：sql, optimization, search

我有一个零件数据库，我将不断查询报价系统。零件数据库中有 1,400,000 多条记录。用户将开始输入部件号，他们希望系统能够在几个字符后找到，所以我需要能够进行通配符搜索，例如：

```
SELECT NeededFields FROM Parts WHERE PartNumber LIKE 'ML%' 
```

我可以执行任何类型的优化来尝试从这种类型的查询中获得最大的性能吗？我已经索引了 PartNumber 字段，但我不确定这是否是我能得到的最好的。我也愿意考虑独立于 SQL 索引的数据库中内置的替代索引结构。主键是一个 Guid，但我需要它来进行复制并且因为我使用了特定的数据结构。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-04T21:42:07.363

大多数（好的）优化器会尝试为没有首先出现通配符的 LIKE 子句使用索引。如果模式以通配符开头，那么他们能做的就更少了。

如果索引是 B-Tree 索引，而不是哈希索引（ISAM 系统通常使用 B-Trees），那么子句的前导字符可以用来约束索引搜索。如果系统使用哈希索引，那么您将无法轻松处理部分字符串，除非您在第一个字符上创建单独的索引，然后在前两个字符上，然后是前三个字符，...... ISAM 系统可能会为您提供这种灵活性；大多数 SQL 系统不这样做，您必须创建包含零件号字段的前 1、2、3 ... 个字符的 1、2、3、... 个字符的列。

*补充*：评论问“哪个 DBMS？”，这是公平的。我可以担保 IBM Informix Dynamic Server (IDS) 和 Standard Engine (SE) 的任何版本，您可以使用。我希望 IBM DB2（LUW 或 z/OS）都能做到。我希望甲骨文能够做到这一点。评论表明 PostgreSQL 8.0 及更高版本可以做到这一点 - 需要注意。对于 Sybase、Ingres、MS SQL Server、Firebird 或 MySQL，我无法回答我自己的知识。每个 DBMS 都可能有关于何时可以使用索引的警告。

请注意，如果存在另一个提供选择性的索引，则可以优先使用提供通配符搜索访问权限的索引。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-04T21:52:10.667

我猜你的主键（GUID）可能有一个聚集索引。您可能需要考虑使主键不被聚集。相反，您可以聚集为 PartNumber 创建的索引。（每个表只能有一个聚集索引）

您还应该考虑在查询中添加一个 TOP 谓词，以便只返回前 100（左右）行。我在想......如果用户首先输入一个 M，可能会有几十万个匹配项，加载速度会很慢。通过限制行数，您应该获得更好的性能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-04T21:42:46.567

您如何在 partnumber 字段上对表进行分区。您可以将表拆分为不同的卷。

卷 A 持有 am
卷 B 持有 nz

*编辑顺便说一句，从来没有这样做过。*

有关理论，请参[见此 http://msdn.microsoft.com/en-us/library/ms345146.aspx](http://msdn.microsoft.com/en-us/library/ms345146.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-04T21:45:32.990

这个查询看起来不错！如果该字段已编入索引并且您正在执行`LIKE 'term%'`查询，通配符位于末尾，您应该获得优化的执行计划。

根据您的 DBMS，您可以检查优化器对 EXPLAIN 关键字的实际作用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-04T22:41:18.367

我很好奇，

您能否扩展您的问题以包括以下 4 个查询的持续时间：

```
SELECT top 100 NeededFields FROM Parts WHERE PartNumber LIKE '%'
SELECT top 100 NeededFields FROM Parts WHERE PartNumber LIKE 'M%'
SELECT top 100 NeededFields FROM Parts WHERE PartNumber LIKE 'ML%'
SELECT top 100 NeededFields FROM Parts WHERE PartNumber LIKE 'ML0833%' 
```

如果事实证明第一个/第二个查询比最后一个慢很多，您可以考虑引入一个维护这些情况的缓存表（使用触发器或作业更新它）

另外，我想我刚刚注意到一些事情，您的索引是否完全覆盖？如果不是，您可能会在结果计数达到阈值时进行表扫描。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-04T21:50:30.950

尝试使用零件编号的前 2 或 3 个字符对表进行分区。尝试使用分区本地索引与全局索引。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-04T22:47:52.753

我会使用全文搜索。使用这种查询，您的结果几乎是即时的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-05T12:51:32.957

[当通配符位于末尾时， PostgreSQL](http://www.postgresql.org/)似乎无法优化 LIKE 查询。

在这里，表 Zones 在列名上建立索引：

```
CREATE INDEX index_zones_name ON Zones(name); 
```

并且索引用于 = 查询：

```
EXPLAIN SELECT id FROM Zones WHERE name = 'toto.fr';
                              QUERY PLAN                                   
-------------------------------------------------------------------------------
 Index Scan using index_zones_name on zones  (cost=0.00..21.06 rows=4 width=4)
   Index Cond: (name = 'toto.fr'::text) 
```

尽管有 300 万行，但查询是即时的。

但是，对于 LIKE 查询：

```
EXPLAIN SELECT id FROM Zones WHERE name LIKE 'toto%';
                   QUERY PLAN                        
---------------------------------------------------------
 Seq Scan on zones  (cost=0.00..75991.43 rows=1 width=4)
   Filter: (name ~~ 'toto%'::text) 
```

并且查询需要**更长的**时间。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-04T22:45:52.913

考虑不为此使用 SQL。

创建一些用户界面所需的数据转储。一百万条记录不是很多-考虑制作`26`文件-每个“首字母”一个并存储信息。让它包括最受欢迎的条目。

如果您想要更多的特异性（或用户开始滚动），您可以为每个剩余记录创建`26*26`更多文件（`AB`、`AC`、`AD`等）。

如果您坚持为此使用 SQL，请对其进行分析。尝试*为*主角创建一个索引，例如

```
CREATE INDEX partno_idx ON parts (SUBSTRING(partnumber,0,1)) 
```

（或任何您当地的 SQL 方言）然后使用类似`WHERE SUBSTRING(partnumber,0,1)='M'`. 结果将避免前缀搜索很少比全字符串（或整数）索引（可能使用哈希表或跳过列表）快。

分析这一点很重要：也许将字符转换为其 ASCII 代码会更快。您的数据集以及您的 SQL Server 软件和版本将高度相关。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-05T13:00:38.587

如果您使用的是 mysql，请考虑创建部分索引：

```
mysql> CREATE INDEX part_of_name ON customer (name(10)); 
```

索引将仅匹配前 10 个字符

# c - 在作为参数传递时解决有关“未使用”函数的夹板警告

> ID：411726
> 
> 赞同：0
> 
> 时间：2009-01-04T21:38:47.510
> 
> 标签：c, splint

在我的一个程序中，[夹板](http://www.splint.org/)检查器警告：

```
expat-test.c:23:1: Function exported but not used outside expat-test: start
  A declaration is exported, but not used outside this module. Declaration can
  use static qualifier. (Use -exportlocal to inhibit warning)
   expat-test.c:38:1: Definition of start 
```

使用 start()**函数**。该程序使用与回调一起使用的[expat XML 解析器。](http://expat.sourceforge.net/)你给解析器一个函数：

```
XML_SetElementHandler(parser, start, end); 
```

解析器在某些时候将其回调。这是 C 语言中非常常见的习语，我想知道为什么夹板会抱怨。我在[常见问题解答](http://www.splint.org/faq.html)或[手册](http://www.splint.org/manual/html/sec8.html)中找不到任何内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-04T21:49:25.150

您是否调用`XML_SetElementHandler()`了定义的同一个翻译单元（通常是 .c 源文件）`start()`？如果是这样，警告可能是正确的：添加`static`到函数定义并检查您的应用程序是否仍然链接没有错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-04T21:59:30.340

'static' 关键字有效地对其他翻译单元（通常是 .C 文件）隐藏了函数的名称。代码仍然存在，您可以从该 C 文件中获取函数的地址（但不能从其他 C 文件中获取）。然后，您可以通过调用函数或从函数返回地址或将其存储在全局变量中等方式将地址传递给其他翻译单元。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T10:05:34.447

我倾向于声明所有未导出为静态的函数。我受过教育，目前认为这样做是一种很好的做法。（免责声明：与大多数事情一样，这个“规则”有很多例外。）

# c# - Expression.Or，参数“item”不在范围内

> ID：411738
> 
> 赞同：8
> 
> 时间：2009-01-04T21:44:31.523
> 
> 标签：c#, linq, expression-trees, expression

我正在尝试将静态函数写入或两个表达式，但收到以下错误：

> 参数“项目”不在范围内。
> 
> 说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。
> 
> 异常详细信息：System.InvalidOperationException：参数“项目”不在范围内。

方法：

```
public static Expression<Func<T, bool>> OrExpressions(Expression<Func<T, bool>> left, Expression<Func<T, bool>> right)
{
    // Define the parameter to use
    var param = Expression.Parameter(typeof(T), "item");

    var filterExpression = Expression.Lambda<Func<T, bool>>
         (Expression.Or(
             left.Body,
             right.Body
          ), param);
    // Build the expression and return it
    return (filterExpression);
} 
```

**编辑**：添加更多信息

or'd 的表达式来自下面的方法，执行得很好。如果有更好的方法或结果我全神贯注。另外，我不知道有多少人被提前或被淘汰了。

```
public static Expression<Func<T, bool>> FilterExpression(string filterBy, object Value, FilterBinaryExpression binaryExpression)
{
    // Define the parameter to use
    var param = Expression.Parameter(typeof(T), "item");

    // Filter expression on the value
    switch (binaryExpression)
    {
        case FilterBinaryExpression.Equal:
            {
                // Build an expression for "Is the parameter equal to the value" by employing reflection
                var filterExpression = Expression.Lambda<Func<T, bool>>
                    (Expression.Equal(
                        Expression.Convert(Expression.Property(param, filterBy), typeof(TVal)),
                        Expression.Constant(Value)
                     ),
                    param);
                // Build the expression and return it
                return (filterExpression);
            } 
```

**编辑**：添加更多信息

或者，有没有更好的方法来做一个或？目前，.Where(constraint) 在约束类型为 Expression> 的情况下工作得很好。我该怎么做 where(constraint1 or constraint2) (到约束 n'th)

提前致谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-04T22:23:03.240

问题是您在 OrExpressions 方法中创建的表达式重用了两个表达式的主体。这些主体将包含对它们自己的 ParameterExpression 的引用，该 ParameterExpression 已在 FilterExpression 中定义。

解决方法是重写左右部分以使用新的 ParameterExpression。或者传递原始的 ParameterExpression。并不是因为两个ParameterExpression同名就代表同一个参数。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-05T13:46:12.287

正如已经建议的那样，[在这里](http://www.albahari.com/nutshell/predicatebuilder.aspx)您可以找到这个非常好的（工作）代码

```
public static Expression<Func<T, bool>> Or<T>(this Expression<Func<T, bool>> expr1, Expression<Func<T, bool>> expr2)
{
    var invokedExpr = Expression.Invoke(expr2, expr1.Parameters.Cast<Expression>());
    return Expression.Lambda<Func<T, bool>>(Expression.Or(expr1.Body, invokedExpr), expr1.Parameters);
} 
```

您可以适应您的需求，并且与 LINQ 无关（恕我直言）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-04T22:27:45.760

我不确定这里的正确术语，但基本上表达式参数是不等价的，即使它们具有相同的名称。

这意味着

```
var param1 = Expression.Parameter(typeof(T), "item");
var param2 = Expression.Parameter(typeof(T), "item");

param1 != param2 
```

如果在表达式中使用 param1 和 param2 将不是同一个东西。

处理这个问题的最佳方法是为您的表达式预先创建一个参数，然后将其传递给所有需要该参数的辅助函数。

编辑：另外，如果您尝试在 LINQ 中动态组合 where 子句，您可以尝试[PredicateBuilder](http://www.albahari.com/nutshell/predicatebuilder.aspx)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-25T16:38:30.493

对于那些通过搜索引擎找到此页面并打算使用**Ben&Joe Albahari 的 PredicateBuilder 的人**，请注意，因为它**不适用于 Entity Framework**。

试试[这个固定版本](http://petemontgomery.wordpress.com/2011/02/10/a-universal-predicatebuilder/)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-03-11T21:49:21.790

我也想到了 Fabrizio 的解决方案，但由于我试图组合两个将作为 linq 2 sql 查询执行的表达式，我认为它会在内存中执行，而不是在 sql 服务器中执行。

我被写了——Linq-To-Sql 识别出调用是一个 lambda 表达式，因此仍然会产生优化的 sql。

# perl - 如何在 Perl 中解析日期和转换时区？

> ID：411740
> 
> 赞同：27
> 
> 时间：2009-01-04T21:47:39.443
> 
> 标签：perl, datetime, parsing, date, timezone

我在 Perl 中使用[localtime](http://perldoc.perl.org/functions/localtime.html)函数来获取当前日期和时间，但需要解析现有日期。我有以下格式的 GMT 日期：“20090103 12:00”我想将其解析为我可以使用的日期对象，然后将 GMT 时间/日期转换为我当前的时区，该时区目前是东部标准时间. 因此，我想将“20090103 12:00”转换为“20090103 7:00”任何有关如何执行此操作的信息将不胜感激。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-01-04T22:19:58.397

因为 Perl 内置的日期处理接口有点笨拙，并且您最终会传递大约六个变量，所以更好的方法是使用[DateTime](http://search.cpan.org/perldoc?DateTime)或[Time::Piece](http://search.cpan.org/perldoc?Time::Piece)。DateTime 是全能歌唱、全能跳舞的 Perl 日期对象，您可能最终会想要使用它，但 Time::Piece 更简单且完全适合此任务，具有与 5.10 一起发布的优势，并且该技术是两者基本相同。

[这是使用 Time::Piece 和strptime](http://opengroup.org/onlinepubs/007908799/xsh/strftime.html)的简单、灵活的方法。

```
#!/usr/bin/perl

use 5.10.0;

use strict;
use warnings;

use Time::Piece;

# Read the date from the command line.
my $date = shift;

# Parse the date using strptime(), which uses strftime() formats.
my $time = Time::Piece->strptime($date, "%Y%m%d %H:%M");

# Here it is, parsed but still in GMT.
say $time->datetime;

# Create a localtime object for the same timestamp.
$time = localtime($time->epoch);

# And here it is localized.
say $time->datetime; 
```

为了对比，这是手动方式。

由于格式是固定的，正则表达式就可以了，但如果格式发生变化，您将不得不调整正则表达式。

```
my($year, $mon, $day, $hour, $min) = 
    $date =~ /^(\d{4}) (\d{2}) (\d{2})\ (\d{2}):(\d{2})$/x; 
```

然后将其转换为 Unix 纪元时间（自 1970 年 1 月 1 日以来的秒数）

```
use Time::Local;
# Note that all the internal Perl date handling functions take month
# from 0 and the year starting at 1900\.  Blame C (or blame Larry for
# parroting C).
my $time = timegm(0, $min, $hour, $day, $mon - 1, $year - 1900); 
```

然后回到你的当地时间。

```
(undef, $min, $hour, $day, $mon, $year) = localtime($time);

my $local_date = sprintf "%d%02d%02d %02d:%02d\n",
    $year + 1900, $mon + 1, $day, $hour, $min; 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-01-04T22:20:26.193

这是一个示例，使用[DateTime](http://datetime.perl.org)及其[strptime](http://search.cpan.org/dist/DateTime-Format-Strptime/lib/DateTime/Format/Strptime.pm)格式模块。

```
use DateTime;
use DateTime::Format::Strptime;

my $val = "20090103 12:00";

my $format = new DateTime::Format::Strptime(
                pattern => '%Y%m%d %H:%M',
                time_zone => 'GMT',
                );

my $date = $format->parse_datetime($val);

print $date->strftime("%Y%m%d %H:%M %Z")."\n";

$date->set_time_zone("America/New_York");  # or "local"

print $date->strftime("%Y%m%d %H:%M %Z")."\n";

$ perl dates.pl
20090103 12:00 UTC
20090103 07:00 EST 
```

* * *

如果您想解析本地时间，这就是您的方法:)

```
use DateTime;

my @time = (localtime);

my $date = DateTime->new(year => $time[5]+1900, month => $time[4]+1,
                day => $time[3], hour => $time[2], minute => $time[1],
                second => $time[0], time_zone => "America/New_York");

print $date->strftime("%F %r %Z")."\n";

$date->set_time_zone("Europe/Prague");

print $date->strftime("%F %r %Z")."\n"; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-05T10:11:09.163

这就是我要做的...

```
#!/usr/bin/perl
use Date::Parse;
use POSIX;

$orig = "20090103 12:00";

print strftime("%Y%m%d %R", localtime(str2time($orig, 'GMT'))); 
```

您也可以使用`Time::ParseDate`and`parsedate()`代替`Date::Parse`and `str2time()`。请注意，事实上的标准 atm。似乎是 DateTime （但您可能不想使用 OO 语法来转换时间戳）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-04T22:18:46.620

任君挑选：

*   [DateTime](http://search.cpan.org/perldoc?DateTime) ::* （或者，在[datetime.perl.org](http://datetime.perl.org/)）
*   [日期::Manip](http://search.cpan.org/perldoc?Date::Manip)
*   [Date::Calc](http://search.cpan.org/perldoc?Date::Calc)（2004 年最后一次更新）

毫无疑问，还有无数其他人，但他们可能是最有力的竞争者。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2014-04-18T09:53:18.783

```
use strict;
use warnings;
my ($sec,$min,$hour,$day,$month,$year)=localtime();
$year+=1900;
$month+=1;
$today_time = sprintf("%02d-%02d-%04d %02d:%02d:%02d",$day,$month,$year,$hour,$min,$sec);
print $today_time; 
```

# jquery - RubyOnRails 2.2 + Jquery UI 可排序和 AJAX：我就是这样做的。有没有更好的办法？

> ID：411746
> 
> 赞同：1
> 
> 时间：2009-01-04T21:51:58.750
> 
> 标签：jquery, ruby-on-rails, ruby, ajax, rjs

在 Rails 2.2 项目中，我让用户将项目列表放在一个投资组合对象中（即：）`PortfolioHasManyProjects`。页面上有一个用于常规文本、标题等的 Rails 表单，以及 2 个可排序列表；这些列表用于将项目从全局项目列表拖到您的投资组合项目列表中。

它类似于这里所做的：http: [//ui.jquery.com/latest/demos/functional/#ui.sortable](http://ui.jquery.com/latest/demos/functional/#ui.sortable)。

我有投资组合列表 (#drag_list) 更新更改并通过 AJAX 调用提交其​​序列化数据。 **这是在 application.js 文件中完成的：**

```
jQuery.ajaxSetup({ 
  'beforeSend': function(xhr) {xhr.setRequestHeader("Accept", "text/javascript")}
})

jQuery.fn.submitDragWithAjax = function() {
  this.submit(function() {
    $.post(this.action, $("#drag_list").sortable('serialize'), null, "script");
    return false;
  })
  return this;
};

$(document).ajaxSend(function(event, request, settings) {
  if (typeof(AUTH_TOKEN) == "undefined") return;
  // settings.data is a serialized string like "foo=bar&baz=boink" (or null)
  settings.data = settings.data || "";
  settings.data += (settings.data ? "&" : "") + "authenticity_token=" + encodeURIComponent(AUTH_TOKEN);
});

/-------------------------------------------/

$(document).ready(function(){

    $(".ajax_drag").submitDragWithAjax();

    $("#drag_list").sortable({
        placeholder: "ui-selected",
        revert: true,
        connectWith:["#add_list"],
        update : function () {
            $("#drag_list").submit();
        }
    });

    $("#add_list").sortable({ 
        placeholder: "ui-selected",
        revert: true,
        connectWith:["#drag_list"]
    }); 
```

这就是事情变得棘手的地方。我不确定如何处理序列化数据并将其与表单一起提交给`new.html.erb`文件中的控制器。所以我所做的就是`new.js.erb`将隐藏的表单字段`new.html.erb`与我将在控制器中提取的数据一起插入。

**这是 new.js.erb：**

```
$("#projects").html("");
<% r = params[:proj] %>
<% order=1 %>
<% for i in r %>
  $("#projects").append("<input type=hidden name=proj[<%=order%>] value=<%=i%> />");
  <% order=order+1 %>
<% end %> 
```

**编辑new.html.erb：**

```
<h1>New portfolio</h1>
<h2>The List</h2>

<div class="list_box">
  <h3>All Available Projects</h3>
  <%= render :partial => "projects/add_list" %>
</div>

<div class="list_box">
  <h3>Projects currently in your new portfolio</h3>
  <%= render :partial => "projects/drag_list" %>
</div>

<div style="clear:both"></div>
<br/>
<br/>

<h2>Portfolio details</h2>
<% form_for(@portfolio) do |f| %>
  <%= f.error_messages %>
  <h3>Portfolio Name</h3>
  <p>
    <%= f.text_field :name %>
  </p>
  <h3>URL</h3>
  <p>
    <%= f.text_field :url %>
  </p>
  <h3>Details</h3>
  <p>
    <%= f.text_area :details %>
  </p>
  <p>

    <div id="projects">
    <input type="hidden" name="proj" value="" />   
    </div>

    <%= f.submit "Create" %>
  </p>
<% end %> 
```

然后表单提交到投资组合控制器中的 create 方法：

```
 def new
    @projects = Project.find(:all)
    @portfolio = Portfolio.new
    respond_to do |format|
      format.html # new.html.erb
      format.xml  { render :xml => @portfolio }
      format.js
    end
  end

 def create
    @portfolio = Portfolio.new(params[:portfolio])
    proj_ids = params[:proj]
    @portfolio.projects = []
    @portfolio.save

    proj_ids.each {|key, value| puts "Key:#{key} , Value:#{value} " }
    proj_ids.each_value {|value| @portfolio.projects << Project.find_by_id(value) }

    respond_to do |format|
      if @portfolio.save
        flash[:notice] = 'Portfolio was successfully created.'
        format.html {  render :action => "index" }
        format.xml  { render :xml => @portfolio, :status => :created, :location => @portfolio }
      else
        format.html { render :action => "new" }
        format.xml  { render :xml => @portfolio.errors, :status => :unprocessable_entity }
      end
    end
  end 
```

* * *

**所以最后我的问题：**

1.  这是这样做的正确方法吗？出于某种原因，我觉得不是，主要是因为在 Rails 中做其他所有事情似乎都更容易和直观。这行得通，但要做到这一点是地狱。必须有一种更*优雅*的方式通过 AJAX 调用向控制器发送序列化数据。

2.  我将如何在同一页面上调用不同的 AJAX 操作？假设我有一个可排序和一个自动完成的 AJAX 调用，我可以有一个`sortable.js.erb`并`autocomplete.js.erb`从任何文件中调用它们吗？我不确定如何设置控制器来对此做出响应。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-08T11:34:27.323

如果您使用 jQuery，这是一个[很好的解决方案。](http://henrik.nyh.se/2008/11/rails-jquery-sortables)

从链接的博客：

> 我刚刚为 Rails/jQuery 应用程序编写了一些可排序的代码，并想我会写下它需要多少代码，以及我在后端使用的单个 MySQL 查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-21T02:24:16.613

这是我基于 Silviu 提到的文章的解决方案。我正在对属于课程的部分进行排序，因此包含了课程 ID。

这是在视图中 - 我正在使用 HAML，因此您必须转换为 erb。

```
#sorter
- @lesson.parts.each do |part|
  %div[part] <- HAML rocks - this constructs a div <div id="the_part_id" class="part">
    = part_screenshot part, :tiny
    = part.swf_asset.filename 
```

js看起来像这样：

```
 $('#sorter').sortable({items:'.part', containment:'parent', axis:'y', update: function() {
  $.post('/admin/lessons/' + LessonId + '/parts/sort', '_method=post&authenticity_token='+ AUTH_TOKEN+'&'+$(this).sortable('serialize'));
  $('#sorter').effect("highlight");
}}); 
```

这是 PartsController 中调用的方法：

```
def sort
load_lesson
part_positions = params[:part].to_a
@parts.each_with_index do |part, i|
  part.position = part_positions.index(part.id.to_s) + 1
  part.save
end
render :text => 'ok' 
```

结尾

```
def load_lesson
@lesson = Lesson.find(params[:lesson_id])
@parts = @lesson.parts 
```

结尾

它需要一些工作来向用户提供反馈，但这对我有用。

# build-process - 每日构建，现实吗？

> ID：411751
> 
> 赞同：8
> 
> 时间：2009-01-04T21:56:53.667
> 
> 标签：build-process, continuous-integration

在单人商店甚至（尤其是）较大的商店中，您到底如何才能维持日常构建？

如果您更改 API 或数据库表等，您将不得不更改应用程序中的这么多层，或者说 sql 初始化脚本等。

你怎么能指望项目为需要一天以上才能完成的更改而构建？

确保构建在每一次更改中都能正常工作是一个开发目标吗？

（顺便说一句，我从“每日构建”中了解到的是按下一个按钮并准备好生产代码来发布......我感觉我有错误的选择呵呵）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-04T22:03:08.850

每日构建不应该要求您按下按钮。它应该自动发生，根据特定的时间安排或基于其他事件（例如代码签入）触发。

让主分支中的代码处于永久可构建状态是个好主意。在它工作之前不要将代码签入该分支。您可以在自己的分支中进行较大的更改，也可以通过使用标志来阻止应用程序的一些新逻辑。

您可以通过让您的日常构建脚本完成所有必需的设置来处理数据库架构等要求。请记住，您不需要更改生产模式，因为您不会每天都部署您的构建 - 它应该只用于测试，以便您可以尽快识别回归。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-04T22:02:38.273

> 在单人商店甚至（尤其是）较大的商店中，您到底如何才能维持日常构建？

没有一个，你怎么能指望把事情放在一起呢？目的是每次签入存储库都可以生成干净的构建。如果不能，你就没有正确地做事。

当将大的更改放入源代码存储库时，这一点尤其重要。

> 你怎么能指望项目为需要一天以上才能完成的更改而构建？

很简单，只在存储库上构建。仅将内容检入有效的存储库中。

> 确保构建在每一次更改中都能正常工作是一个开发目标吗？

是的，这就是目标。与大多数愿望一样，它可能不会实现，但将其作为目标可以对代码库发生的事情提供良好的反馈。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-04T22:03:37.117

是的，每日构建的想法是测试您的*主要代码分支*是否稳定、通过测试并随时可以发布。

如果您的修订控制系统中的更改需要多次提交，那么您应该创建一个开发分支，这样您就可以自由提交而不会破坏主分支的稳定性。

请注意，您的数据库需要为每个分支提供单独的测试模式。无论如何，我建议为每个测试环境使用一个单独的数据库实例，所以这应该不是问题。

完成重构和更新测试后，您应该能够手动验证代码是否通过了测试，并且您的日常构建不会中断。

然后，您可以将开发分支中的更改合并到主分支。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-04T22:07:48.653

我已经使用 CruiseControl 来实现 Continues Integration，它甚至可以创建新的构建并将它们部署在*每个 SVN 签入*上，所以这个问题的答案是肯定的...... ;)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-04T22:24:38.463

我经常听到这种抱怨，甚至在我的公司。这只是一种工作方式。如果你不能让你的东西在任何时候都可以编译和测试，那么你可能正在以一种不稳定的方式处理你的问题，并且一次接触了太多的代码。你是个杂耍者。杂耍者不会编程。

在我所有的项目中，我们每小时构建一次。我们使用 Luntbuild 来做到这一点，它会在构建失败后立即向所有项目成员发送邮件，并且会继续发送邮件直到构建工作。损坏的代码不会被签入，当有人破坏构建时，他必须为整个团队获取 cookie（或其他合适的“羞辱”:-)）。

每周我们都会尝试在我们的测试服务器上安装该软件，以便我们的测试部门可以测试该软件。

您将看到这将产生更好的代码，并且在项目期间几乎任何时候都可以交付项目，因为：

*   你被迫将你的工作分解成更小、更容易理解、因此更容易编码的片段，这将导致更少的错误。
*   您被迫经常更新和签入，这使项目进展得更快，因为您可以从项目早期的同事重用中受益。
*   代码会更干净，因为您希望能够为其编写单元测试（否则“覆盖警察”会得到您）

我意识到这不是对“你如何保持构建工作”问题的真正答案，我认为没有真正的灵丹妙药答案。你只需要开始做，看看它是否适合你。我认为大部分专业程序员都同意持续集成、自动化测试和日常构建是一件好事。

我目前的项目有2个问题，一个是buildserver由于网络问题没有发邮件，另一个是恐慌太多。这意味着失败的每小时构建会在很久以后才被注意到，并且由于未完成的功能，每周安装是不可能的。您可以立即看到这个问题对项目的反映，以及团队成员的积极性。它只是不会“顺利”进行。

我希望这有帮助。让他们保持绿色！（即单元测试）

编辑：您所指的“按下按钮”是“单步构建”。这意味着您有一个脚本来执行您的构建（或 ant，或 maven，或其他），并且您使用该脚本来执行测试。因此，当您的自动化构建过程正常工作时，您就知道您有一个可交付的产品。您只需运行脚本并将输出发送给客户。我们的构建脚本会生成一个目录结构，该目录结构会一对一地复制到我们交付软件的 CD 上。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-04T22:01:11.413

简而言之...

自动化。

在完成之前不要检查它。

是的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-04T22:01:36.793

进行每日构建的最简单方法是在流中工作。

有一个开发流、一个 QA（或测试）流，最后是一个发布流。

随时构建您的 QA 和发布流。仅在需要时构建您的开发流。

现在您可以对您的开发流进行重大更改，然后在一些更简单的操作中合并它们（在源代码控制中），您的自动构建过程就会开始。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-04T22:04:04.200

如果它建立在您的机器上，它应该建立在服务器上。问题是您只需在完成任务或使用分支时签入，因此您不会破坏构建。

人们不一定要这样做才能在任何一天将产品放入盒子中，当然，可能有一些例程必须在发布之前完成，但想法是任何开发人员都可以在服务器中获取最新代码它将内置在他们的机器中。它也用于自动化单元测试；如果代码无法编译，则无法运行它们。

几乎每个大型软件公司都使用每日构建（实际上，一天构建几次），所以是的，这是可行的并且是一种常见的做法。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-04T22:07:44.613

在我目前的工作中，我们至少每天使用 CruiseControl、Ivy 存储库、Ant 和 ClearCase 构建 Java EE 应用程序。我们是一个庞大的团队，能够负担得起一个构建团队（3 人）并构建服务器。

是的，您提到的问题确实会发生，例如错误的数据库更改、错误的合并、损坏的编译和测试。但总的来说，我们不会有任何其他方式。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-04T22:18:03.393

还要检查这个问题：

*   [独立开发人员的最佳持续集成设置](https://stackoverflow.com/questions/264307)

# c# - 在 C# 中重复字符的最佳方法

> ID：411752
> 
> 赞同：931
> 
> 时间：2009-01-04T21:56:59.597
> 
> 标签：c#, .net, string

`\t`在 C#中生成字符串的最佳方法是什么

我正在学习 C# 并尝试用不同的方式来表达同一件事。

`Tabs(uint t)`是一个函数，它返回一个`string`数量`t`为`\t`'s

例如`Tabs(3)`退货`"\t\t\t"`

这三种实施方式中哪`Tabs(uint numTabs)`一种最好？

当然，这取决于“最佳”的含义。

1.  LINQ 版本只有两行，这很好。但是对重复和聚合的调用是否会不必要地消耗时间/资源？

2.  `StringBuilder`版本很清楚，但是课程是否有点`StringBuilder`慢？

3.  该`string`版本是基本的，这意味着它很容易理解。

4.  一点都不重要吗？他们都是平等的吗？

这些都是帮助我更好地了解 C# 的问题。

```
private string Tabs(uint numTabs)
{
    IEnumerable<string> tabs = Enumerable.Repeat("\t", (int) numTabs);
    return (numTabs > 0) ? tabs.Aggregate((sum, next) => sum + next) : ""; 
}  

private string Tabs(uint numTabs)
{
    StringBuilder sb = new StringBuilder();
    for (uint i = 0; i < numTabs; i++)
        sb.Append("\t");

    return sb.ToString();
}  

private string Tabs(uint numTabs)
{
    string output = "";
    for (uint i = 0; i < numTabs; i++)
    {
        output += '\t';
    }
    return output; 
} 
```

* * *

## 回答 #1

> 赞同：1711
> 
> 时间：2009-01-04T22:00:39.060

那这个呢：

```
string tabs = new string('\t', n); 
```

`n`你想重复字符串的次数在哪里。

或更好：

```
static string Tabs(int n)
{
    return new string('\t', n);
} 
```

* * *

## 回答 #2

> 赞同：199
> 
> 时间：2013-03-13T16:16:38.303

```
string.Concat(Enumerable.Repeat("ab", 2)); 
```

退货

> “阿巴”

和

```
string.Concat(Enumerable.Repeat("a", 2)); 
```

退货

> “啊”

从...

[是否有内置函数可以在.net 中重复字符串或字符？](https://stackoverflow.com/questions/4115064/is-there-a-built-in-function-to-repeat-string-or-char-in-net)

* * *

## 回答 #3

> 赞同：138
> 
> 时间：2009-04-06T10:38:32.793

在所有版本的 .NET 中，您可以这样重复一个字符串：

```
public static string Repeat(string value, int count)
{
    return new StringBuilder(value.Length * count).Insert(0, value, count).ToString();
} 
```

重复一个字符，`new String('\t', count)`是你最好的选择。请参阅[@CMS 的答案](https://stackoverflow.com/a/411762)。

* * *

## 回答 #4

> 赞同：65
> 
> 时间：2009-01-04T22:01:59.633

最好的版本当然是使用内置方式：

```
string Tabs(int len) { return new string('\t', len); } 
```

在其他解决方案中，更喜欢最简单的；只有当这被证明太慢时，才努力寻求更有效的解决方案。

~~如果你使用 a`StringBuilder`并且事先知道它的结果长度，那么也使用适当的构造函数，这会更有效，因为这意味着只发生一次耗时的分配，并且没有不必要的数据复制。~~ 废话：当然上面的代码效率更高。

* * *

## 回答 #5

> 赞同：53
> 
> 时间：2010-06-22T23:34:55.877

扩展方法：

```
public static string Repeat(this string s, int n)
{
    return new String(Enumerable.Range(0, n).SelectMany(x => s).ToArray());
}

public static string Repeat(this char c, int n)
{
    return new String(c, n);
} 
```

* * *

## 回答 #6

> 赞同：42
> 
> 时间：2009-01-27T12:28:52.417

使用扩展方法怎么样？

* * *

```
public static class StringExtensions
{
   public static string Repeat(this char chatToRepeat, int repeat) {

       return new string(chatToRepeat,repeat);
   }
   public  static string Repeat(this string stringToRepeat,int repeat)
   {
       var builder = new StringBuilder(repeat*stringToRepeat.Length);
       for (int i = 0; i < repeat; i++) {
           builder.Append(stringToRepeat);
       }
       return builder.ToString();
   }
} 
```

* * *

然后你可以写：

```
Debug.WriteLine('-'.Repeat(100)); // For Chars  
Debug.WriteLine("Hello".Repeat(100)); // For Strings 
```

请注意，对简单字符而不是字符串使用 stringbuilder 版本的性能测试会给您带来主要的性能损失：在我的计算机上，测量性能的差异为 1:20：Debug.WriteLine('-'.Repeat(1000000)) //char 版本和
Debug.WriteLine("-".Repeat(1000000)) //string 版本

* * *

## 回答 #7

> 赞同：24
> 
> 时间：2011-06-20T13:50:01.230

这个怎么样：

```
//Repeats a character specified number of times
public static string Repeat(char character,int numberOfIterations)
{
    return "".PadLeft(numberOfIterations, character);
}

//Call the Repeat method
Console.WriteLine(Repeat('\t',40)); 
```

* * *

## 回答 #8

> 赞同：24
> 
> 时间：2014-12-03T02:42:37.170

我知道这个问题已经有五年的历史了，但是有一种简单的方法可以重复一个甚至可以在 .Net 2.0 中使用的字符串。

重复一个字符串：

```
string repeated = new String('+', 3).Replace("+", "Hello, "); 
```

退货

> “你好你好你好， ”

要将字符串作为数组重复：

```
// Two line version.
string repeated = new String('+', 3).Replace("+", "Hello,");
string[] repeatedArray = repeated.Split(',');

// One line version.
string[] repeatedArray = new String('+', 3).Replace("+", "Hello,").Split(','); 
```

退货

> {“你好你好你好”， ””}

把事情简单化。

* * *

## 回答 #9

> 赞同：22
> 
> 时间：2013-08-28T10:45:21.250

假设你想重复 '\t' n 次，你可以使用；

```
String.Empty.PadRight(n,'\t') 
```

* * *

## 回答 #10

> 赞同：17
> 
> 时间：2011-01-26T02:43:31.373

您的第一个示例使用`Enumerable.Repeat`：

```
private string Tabs(uint numTabs)
{
    IEnumerable<string> tabs = Enumerable.Repeat(
                                 "\t", (int) numTabs);
    return (numTabs > 0) ? 
            tabs.Aggregate((sum, next) => sum + next) : ""; 
} 
```

可以更紧凑地重写`String.Concat`：

```
private string Tabs(uint numTabs)
{       
    return String.Concat(Enumerable.Repeat("\t", (int) numTabs));
} 
```

* * *

## 回答 #11

> 赞同：14
> 
> 时间：2013-04-23T07:09:24.450

使用`String.Concat`and `Enumerable.Repeat`which 将比使用更便宜`String.Join`

```
public static Repeat(this String pattern, int count)
{
    return String.Concat(Enumerable.Repeat(pattern, count));
} 
```

* * *

## 回答 #12

> 赞同：9
> 
> 时间：2014-02-07T11:07:06.690

```
var str = new string(Enumerable.Repeat('\t', numTabs).ToArray()); 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2009-04-06T10:58:42.353

答案实际上取决于您想要的复杂性。例如，我想用竖线勾勒出我所有的缩进，所以我的缩进字符串确定如下：

```
return new string(Enumerable.Range(0, indentSize*indent).Select(
  n => n%4 == 0 ? '|' : ' ').ToArray()); 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2018-01-22T08:31:48.323

还有另一种方法

```
new System.Text.StringBuilder().Append('\t', 100).ToString() 
```

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2018-06-04T09:39:23.827

对我来说很好：

```
public static class Utils
{
    public static string LeftZerosFormatter(int zeros, int val)
    {
        string valstr = val.ToString();

        valstr = new string('0', zeros) + valstr;

        return valstr.Substring(valstr.Length - zeros, zeros);
    }
} 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2018-02-16T17:56:58.190

您可以创建扩展方法

```
static class MyExtensions
{
    internal static string Repeat(this char c, int n)
    {
        return new string(c, n);
    }
} 
```

然后你可以像这样使用它

```
Console.WriteLine('\t'.Repeat(10)); 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2018-08-24T21:12:56.613

毫无疑问，公认的答案是重复单个字符的最佳和最快的方法。

Binoj Anthony 的答案是一种简单且非常有效的重复字符串的方法。

但是，如果您不介意更多代码，您可以使用我的数组填充技术更快地有效地创建这些字符串。在我的比较测试中，以下代码的执行时间大约是 StringBuilder.Insert 代码的 35%。

```
public static string Repeat(this string value, int count)
{
    var values = new char[count * value.Length];
    values.Fill(value.ToCharArray());
    return new string(values);
}

public static void Fill<T>(this T[] destinationArray, params T[] value)
{
    if (destinationArray == null)
    {
        throw new ArgumentNullException("destinationArray");
    }

    if (value.Length > destinationArray.Length)
    {
        throw new ArgumentException("Length of value array must not be more than length of destination");
    }

    // set the initial array value
    Array.Copy(value, destinationArray, value.Length);

    int copyLength, nextCopyLength;

    for (copyLength = value.Length; (nextCopyLength = copyLength << 1) < destinationArray.Length; copyLength = nextCopyLength)
    {
        Array.Copy(destinationArray, 0, destinationArray, copyLength, copyLength);
    }

    Array.Copy(destinationArray, 0, destinationArray, copyLength, destinationArray.Length - copyLength);
} 
```

有关此数组填充技术的更多信息，请参阅[用单个值填充数组的最快方法](https://stackoverflow.com/questions/5943850/fastest-way-to-fill-an-array-with-a-single-value/22867582#22867582)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2017-12-22T16:06:28.353

试试这个：

1.  添加 Microsoft.VisualBasic 参考
2.  使用：字符串结果 = Microsoft.VisualBasic.Strings.StrDup(5,"hi");
3.  请让我知道这对你有没有用。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2020-11-10T17:24:14.610

用 6,435 z 的 $str = [System.Linq.Enumerable]::Repeat([string]::new("z", 143), 45) 填充屏幕

$str

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2018-08-27T07:28:17.403

尽管与之前的建议非常相似，但我喜欢保持简单并应用以下内容：

```
string MyFancyString = "*";
int strLength = 50;
System.Console.WriteLine(MyFancyString.PadRight(strLength, "*"); 
```

标准.Net 真的，

# winapi - Win32：支持符号服务器的图形调试器？

> ID：411756
> 
> 赞同：2
> 
> 时间：2009-01-04T21:58:47.643
> 
> 标签：winapi, debugging

我正在尝试调试一个程序，但我没有源代码：explorer.exe

它是 Microsoft 的本机 Win32 应用程序，符号可用。

我现在需要的是一个支持符号的（图形）调试器。

*   OllyDbg 是一个图形调试器，但不支持符号。
*   Delphi 是一个图形调试器，但不支持符号。
*   WinDbg 不是图形调试器，它支持符号。
*   Visual C# Express Edition 不是 Win32 调试器。
*   Process Explorer 支持符号，但不是调试器
*   Process Monitor 支持符号，但不是调试器

是否有任何支持 Microsoft 符号服务器的新图形调试器，在过去 6 个月内编写，我不知道？

* * *

图形调试器是您可以看到反汇编的地方，并且可以进入和停止指令，例如：

德尔福

[![替代文字](https://i.stack.imgur.com/HoQ6g.png)](https://i.stack.imgur.com/HoQ6g.png)

奥利调试：

[![替代文字](https://i.stack.imgur.com/oPmhJ.png)](https://i.stack.imgur.com/oPmhJ.png)

国际开发协会专业版

[替代文字 http://www.hex-rays.com/idapro/linux/remotedebugger2.gif](http://www.hex-rays.com/idapro/linux/remotedebugger2.gif)

WinDbg 并没有向您展示一系列指令：

[替代文字 http://windowsitpro.com/Files/11/21217/Figure_01.gif](http://windowsitpro.com/Files/11/21217/Figure_01.gif)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-04T22:07:37.920

好吧，与 cdb 相比，WinDbg 是一个图形调试器，尽管它不是世界上最友好的！

Visual Studio Pro 当然是一个图形调试器并且支持符号服务器，所以你可以试试 Visual Studio C++ Express。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-07T12:57:32.117

如果通过“图形调试器”，您的意思是它会向您显示汇编代码，那么 WinDBG 就是您真正要寻找的。您只需要知道在哪里可以找到您正在寻找的东西：

*   **alt-6**调用堆栈
*   **alt-7**反汇编

如果您打开*Window*菜单，您可以选择*Automatically Open Disassembly*。*当您在调用堆栈*窗口中单击它时，这将导致打开特定堆栈帧的*反汇编。*

 *诚然，WinDBG 没有其他所有漂亮的颜色，但它非常实用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-10-14T16:29:02.777

Windbg当然可以满足你的目标，看看组装说明。

使用 View->Disassembly 打开反汇编窗口。

**注意**：Windbg 有 2 种模式“*源模式开启*”和“*源模式关闭*”，因此默认情况下您只能使用您拥有源的功能。查找工具栏图标：

[![替代文字](https://i.stack.imgur.com/qTqAU.png)](https://i.stack.imgur.com/qTqAU.png)

或使用 windbg 命令`l+t`或`l-t`.

您的示例显示您正在使用符号服务器，但为了其他人的利益，一个起点是使用 MS 和 Firefox 公共符号服务器：

```
srv*c:\Symbols*http://msdl.microsoft.com/download/symbols;srv*c:\Symbols*http://symbols.mozilla.org/firefox 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-05T03:49:16.623

[Visual Studio C++ Express](http://www.microsoft.com/express/vc/)添加支持托管 (.Net) 和本机 (Win32) 调试。它支持符号服务器。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-04T22:27:45.523

查看 IDA Pro： [http ://www.hex-rays.com/idapro/](http://www.hex-rays.com/idapro/)

它既是反汇编器又是调试器，并且支持符号。

# php - mysql：不能将 max_allowed_pa ckage 设置为大于 16MB 的任何内容

> ID：411758
> 
> 赞同：3
> 
> 时间：2009-01-04T21:59:10.637
> 
> 标签：php, mysql, file-upload, blob

我不确定这是否是发布此类问题的正确位置，如果不是这样，请（礼貌地）让我知道... :-)

我需要从 php 站点将大于 16MB 的文件保存在 mysql 数据库中...

我已经更改了 c:\xampp\mysql\bin\my.cnf

并将 max_allowed_pa​​cket 设置为 16 MB，一切正常

然后我将其设置为 32 MB，但我无法处理大于 16 MB 的文件

我收到以下错误：

'MySQL 服务器已消失'

（当 max_allowed_pa​​cket 设置为 1MB 时，我遇到了同样的错误）

必须有一些其他设置不允许我处理大于 16MB 的文件

也许是php客户端，我猜，但我不知道在哪里编辑它

这是我正在运行的代码

当 file.txt 的长度小于 16.776.192 字节时，它可以正常工作，但是

如果 file.txt 有 16.777.216 字节我得到上述错误

哦，字段 download.content 是一个 longblob ......

```
 $file = 'file.txt';

$file_handle = fopen( $file, 'r' );

$content = fread( $file_handle, filesize( $file ) );

fclose( $file_handle );

db_execute( 'truncate table download', true );

$sql = 
"insert into download( 
    code, title, name, description, original_name, 
    mime_type, size, content, 
    user_insert_id, date_insert, user_update_id, date_update )
values (
    'new file', 'new file', 'sas.jpg', 'new file', '$file',
    'mime', " . filesize( $file ) . ", '" . addslashes( $content ) . "',
    0, " . db_char_to_sql( now_char(), 'datetime' ) . ", 0, " . db_char_to_sql( now_char(), 'datetime' ) . " )";

db_execute( $sql, true ); 
```

（db_execute 函数只是打开连接并执行 sql 的东西）

运行在 windows XP sp2 服务器版本：5.0.67-community PHP 版本 4.4.9 mysql 客户端 API 版本：3.23.49

使用： ApacheFriends XAMPP (Basispaket) 版本 1.6.8 + Apache 2.2.9 + MySQL 5.0.67 (社区服务器) + PHP 5.2.6 + PHP 4.4.9 + PEAR + phpMyAdmin 2.11.9.2 ...

这是 c:\xampp\mysql\bin\my.cnf 内容的一部分

```
# MySQL 服务器
[mysqld]
端口= 3306
套接字=“C：/xampp/mysql/mysql.sock”
basedir="C:/xampp/mysql"
tmpdir="C:/xampp/tmp"
datadir="C:/xampp/mysql/data"
跳跃锁定
key_buffer = 16M
# max_allowed_pa​​cket = 1M
max_allowed_pa​​cket = 32M
表缓存 = 128
排序缓冲区大小 = 512K
net_buffer_length = 8K
读取缓冲区大小 = 256K
read_rnd_buffer_size = 512K
myisam_sort_buffer_size = 8M

```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-04-20T09:48:39.490

**编辑：我原来的答案是不正确的。**

php 链接的 mysql 客户端库的版本（明显）比 mysql 服务器版本旧，这使得我写的看起来是真的；但是现在似乎并非如此。当我针对正确的 mysql 客户端库重新编译 php 时，只需要更新服务器端变量即可。

我将在此处留下回复，因为其他人可能会发现问题并且它很可能与客户端库相关（就像我的一样）。它也是（给定原始问题状态 v3 库和 v4 服务器）很可能是原始问题的答案。

跑

```
phpinfo() 
```

并在 mysql 部分中查找“客户端 API 版本”以检查版本。

*- 来自这里的旧答案*

问题是虽然有一个服务器变量“max_allowed_pa​​cket”，但客户端中也有一组。您可以在 mysql 客户端中使用

```
mysql --max_allowed_packet 
```

或通过使用

```
set-variable   = max-allowed-packet=64M 
```

在 my.cnf 的 [client] 部分

不幸的是 php 不读取 my.cnf 也不允许你设置这个客户端变量。因此，您会遇到 php 源代码中的编译时间限制：

```
ext/mysql/libmysql/net.c:ulong max_allowed_packet=16*1024*1024L; 
```

如果您重新编译修改此限制的 php 模块，它应该可以解决您的问题，但正如其他人所指出的那样，您确实应该以不同的方式做事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-04T23:01:07.860

我过去在 PHP 和 MySQL 中遇到过这个问题。

我记得我的解决方案将二进制文件分成块并循环遍历数组。首先它会插入一个新行，然后它会使用 CONCAT 语句更新该行。

这很讨厌，但它成功了。

实际上，最后，我们将二进制内容存储在文件中，并在数据库中保存了指向该文件的指针。它效率更高。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-04T23:05:27.523

出于这个原因扩展 max_allowed_pa​​cket 是错误实现的结果。我建议阅读[这篇](http://www.dreamwerx.net/phpforum/?id=1)文章/文件存储的实现。您可以存储任何大小的文件。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-05T06:53:45.597

php.ini 文件中还有最大允许上传限制。它没有直接连接到 MySQL，但如果您使用 php 发送数据，则可能是您的问题。

```
; Maximum allowed size for uploaded files.
upload_max_filesize = 16M

; Maximum size of POST data that PHP will accept.
post_max_size = 16M 
```

# python - 可以使用 Django 表单进行可变数量的输入吗？

> ID：411761
> 
> 赞同：21
> 
> 时间：2009-01-04T22:00:33.163
> 
> 标签：python, django, django-forms

是否可以使用 django 表单拥有可变数量的字段？

具体应用是这样的：

用户可以在图片上传表单上上传任意数量的图片。上传图片后，它们将被带到一个页面，在那里他们可以为图片命名和描述。图片的数量将取决于用户选择上传的数量。

那么**如何让 django 使用可变数量的输入字段生成表单**（如果需要，可以作为参数传递）？

**编辑：自从写了**[杰夫鲍尔的回答中提到](http://www.b-list.org/weblog/2008/nov/09/dynamic-forms/)的文章以来，一些事情发生了变化。

即这行代码似乎不起作用：

```
# BAD CODE DO NOT USE!!!
return type('ContactForm', [forms.BaseForm], { 'base_fields': fields }) 
```

所以这就是我想出的......

# 我使用的答案：

```
 from tagging.forms import TagField
from django import forms

def make_tagPhotos_form(photoIdList):
    "Expects a LIST of photo objects (ie. photo_sharing.models.photo)"

    fields = {}

    for id in photoIdList:
        id = str(id)

        fields[id+'_name'] = forms.CharField()
        fields[id+'_tags'] = TagField()
        fields[id+'_description'] = forms.CharField(widget=forms.Textarea)

    return type('tagPhotos', (forms.BaseForm,), { 'base_fields': fields }) 
```

note 标记不是 django 的一部分，但它是免费的并且非常有用。看看：[django-tagging](http://code.google.com/p/django-tagging/)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-05T02:35:12.313

是的，可以在 Django 中动态创建表单。您甚至可以将动态字段与普通字段混合搭配。

```
class EligibilityForm(forms.Form):
    def __init__(self, *args, **kwargs):
        super(EligibilityForm, self).__init__(*args, **kwargs)
        # dynamic fields here ...
        self.fields['plan_id'] = CharField()
    # normal fields here ...
    date_requested = DateField() 
```

要更好地阐述这种技术，请参阅 James Bennett 的文章：**所以你想要一个动态形式？**

[http://www.b-list.org/weblog/2008/nov/09/dynamic-forms/](http://www.b-list.org/weblog/2008/nov/09/dynamic-forms/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-04T22:57:03.237

如果你跑

```
python manage.py shell 
```

并输入：

```
from app.forms import PictureForm
p = PictureForm()
p.fields
type(p.fields) 
```

你会看到 p.fields 是一个 SortedDict。您只需要插入一个新字段。就像是

```
p.fields.insert(len(p.fields)-2, 'fieldname', Field()) 
```

在这种情况下，它将在最后一个字段之前插入一个新字段。您现在应该适应您的代码。

另一种选择是在模板中创建一个 for/while 循环并在 HTML 中执行表单，但是 django 表单由于某种原因而摇摆不定，对吗？

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-04T23:00:48.483

使用多种形式（django.forms.Form 不是标签）

```
class Foo(forms.Form):
    field = forms.Charfield()

forms = [Foo(prefix=i) for i in xrange(x)] 
```

或使用 self.fields 向表单动态添加多个字段。

```
class Bar(forms.Form):
    def __init__(self, fields, *args, **kwargs):
        super(Bar, self).__init__(*args, **kwargs)
        for i in xrange(fields):
            self.fields['my_field_%i' % i] = forms.Charfield() 
```

# windows - 使用 TortoiseCVS 时出现“启动 CVS 进程时出现问题”

> ID：411771
> 
> 赞同：2
> 
> 时间：2009-01-04T22:02:55.700
> 
> 标签：windows, cvs, tortoisecvs

使用 TortoiseCVS 时，当我签出一个模块时，对话框（见[截图](http://img.skitch.com/20090104-b2pne85gp2xn9bhcgwjfsfbkcr.png)）告诉我“启动 CVS 进程时出现问题”，“句柄无效”。关于这将如何发生的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-04T23:10:20.963

重新安装 TortoiseCVS 解决了这个问题。在第一次安装 TortoiseCVS 时，我有另一个并发安装，这一定把事情搞砸了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-04T18:52:34.983

设置 NT cvs 安装文件夹的路径（例如 C:\Program Files (x86)\CVSNT）。对我来说工作得很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-04T22:57:11.347

它不应该是文件URL的形式吗？

是否将 cvs.exe 添加到路径中？

哪个版本的乌龟？简历？据谷歌称，该描述报告了一个错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-23T06:35:50.547

就我而言，在文件夹`cvs.exe`中找不到。`CVSNT`我很确定我没有删除它。重新安装 TortoiseCVS 解决了这个问题。

# c - 用 C 语言在 Linux 上获取程序进程（服务和守护进程）

> ID：411777
> 
> 赞同：2
> 
> 时间：2009-01-04T22:07:22.710
> 
> 标签：c, unix

我想知道如何创建一个在后台启动的应用程序。我目前正在用 C 语言创建一个网络服务器作为一个小项目，以学习一些旧的 C 和 Linux 套接字编程。但我现在担心的是：

*   如何获取当前进程号？

我想得到这个，因为当我启动进程时，我想为启动服务的用户显示进程号。

*   我的第二个问题是，如何将我的应用程序作为守护程序启动以在后台运行？

任何关于我如何做到这一点的参考资料、教程和/或视频都非常感谢！

* * *

也许我有点不清楚；我想从 C 中获取进程 ID。那么，我需要为我的应用程序创建一个 shell 脚本还是可以从 C 中执行此操作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-04T22:17:46.403

1.  要获取正在运行的进程的标识符，请使用该`getpid()`函数。
2.  要创建守护进程，即在后台运行的分离进程，请遵循[这些说明](http://www-theorie.physik.unizh.ch/~dpotter/howto/daemonize)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-04T22:13:44.883

在 *nix 上，使用[ps](http://www.computerhope.com/unix/ups.htm)获取进程 ID， 或者如果您知道进程名称，请执行

```
ps aux | grep processname 
```

要将任何程序作为守护进程运行，请使用[nohup](http://en.wikipedia.org/wiki/Nohup)

# linux - 写保护的虚拟页面，catch write

> ID：411788
> 
> 赞同：0
> 
> 时间：2009-01-04T22:14:47.453
> 
> 标签：linux, x86, elf, language-implementation

是否存在一种方法可以捕获写入受写保护的页面？

我计划做一个类似自我的对象系统，您可以在其中复制对象以实例化它。（因为与其他的相比，这听起来简单而紧凑）显然，为此目的创建的对象应该以某种方式进行写保护。我已经看到有一种方法可以在 ELF 中的程序头中标记写保护的内容。（RE、RWE、RW 标志）

这是否提供写保护？我记得它应该引发一个段错误，这是真的吗？如何将写入捕获到写保护页面。这是实现我想要的东西的好方法吗？还有更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-05T08:49:17.563

是的，您可以使用[mprotect](http://www.opengroup.org/onlinepubs/009695399/functions/mprotect.html)。

是的，对受保护内存的写入会引发段错误。您可以安装处理程序，例如在 C++ 中：

```
std::signal(SIGSEGV, my_segv_handler_func); 
```

这是一种做你想做的事情的合理方式，尽管你必须添加很多额外的管理工具才能让它工作。例如，这种写检测是在硬件中完成的，在 x86 架构上，页面大小为 4k。所以你可以一次保护 4k 的东西，在 4k 的边界上对齐——而不是通用的“从地址 X 开始并走 N 个字节”。我相信你要么必须

1.  具有对象到页面的映射，以便您可以识别对页面的写入是否是对特定受保护对象的写入，或者
2.  滚动你自己的 malloc，它总是在 4k 边界上分配，这将迫使你使用 4k 的最小分配块大小

我不知道是否有更好的方法，但玩起来听起来很有趣。:)

# c - 在 C 中将 32 位应用程序转换为 64 位应用程序

> ID：411798
> 
> 赞同：21
> 
> 时间：2009-01-04T22:21:58.297
> 
> 标签：c, x86, x86-64, 32bit-64bit, porting

我目前正在用 C 语言将 32 位应用程序转换为 64 位应用程序。该应用程序目前正在使用 x86 架构（Windows、osx、Unix、Linux）。因此，在开始编码之前，我想知道在转换应用程序时需要考虑什么。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-01-04T22:35:10.907

1.  找出是谁写的。他们是白痴吗？他们是几年前的*你吗？*你能问他们问题吗？他们是否熟悉多个平台和系统的存在？了解*程序作者的思维方式*将有助于您在遇到问题时理解问题。
2.  启动并运行 64 位机器/构建环境。
3.  用 int 替换 long。完全清楚那`LONG`不是`long`。
4.  用和替换`(int)&x`演员表和打字`intptr_t``(unsigned int)&x``uintptr_t`
5.  审计任何依赖转换结构来`char*`进行指针运算的东西。
6.  正则表达式搜索 \<4\> 以防您假设`4 = sizeof(void*)`
7.  耐心点。当您发现问题时，如果存在相同的问题，请查看其他地方，并将解决方案包装在宏中。
8.  尽量不要使用`#ifdef RUN64`或类似的东西。如果 128 位平台流行起来，你会后悔的。
9.  用一些集中的宏来封装您的所有更改，这些宏将隐藏程序中其他地方的可移植性差异。
10.  使用覆盖率测试器来帮助确保你已经覆盖了所有内容（如果合适的话）

*编辑*按照评论的建议添加`uintptr_t`了注释。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-04T22:49:10.083

一个尚未提及的潜在问题是，如果您的应用程序从磁盘读取或写入二进制数据（例如，使用 读取结构数组`fread`），您将不得不非常仔细地检查并且可能最终有两个读取器：一个用于遗留文件一个用于 64 位文件。或者，如果您小心地使用头文件中的诸如此类`uint32_t`的类型`<stdint.h>`，您可以重新定义您的结构以逐位兼容。在任何情况下，**二进制 I/O**都是需要注意的。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-04T22:33:17.980

这实际上取决于应用程序及其编码方式。一些代码可以用 64 位编译器重新编译，它就可以工作，但通常只有在设计代码时考虑到可移植性才会发生这种情况。

如果代码对本机类型和指针的大小有很多假设，如果它有很多位打包技巧，或者它使用字节指定协议与外部进程通信，但使用一些关于本机类型大小的假设，那么它可能需要一些或很多工作才能获得干净的编译。

几乎每个强制转换和编译器警告都是需要检查的危险信号。如果代码一开始没有“警告干净”，那么这也表明可能需要进行大量工作。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-04T22:30:27.907

如果您为您的值使用了正确的类型 - 例如。`size_t`, `ptrdiff_t`, `uintptr_t`, 固定大小的 int 类型`stdint.h`在适当的地方 - 并且没有硬编码值大小，您的代码应该开箱即用。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-05T04:50:32.477

C 中 32 位和 64 位编程之间的两个主要区别是`sizeof(void*)`和`sizeof(long)`. 您将遇到的主要问题是大多数 Unix 系统使用定义 long 为 64 位的 I32LP64 标准，而 Win64 使用定义 long 为 32 位的 IL32LLP64 标准。如果您需要支持跨平台编译，您可能需要为 32 位和 64 位整数使用一组基于架构的 typedef，以确保所有代码的行为一致。这是作为 C99 标准的一部分的 stdint.h 的一部分提供的。如果您没有使用 C99 编译器，则可能需要滚动您自己的等价物

如其他地方所述，转换的主要关注点是假设`sizeof(int) == sizeof(long) == sizeof(void*)`代码、支持已写入磁盘的数据的代码和跨平台 IPC 的代码。

要详细了解这背后的历史，请查看 ACM Queue 中的这篇[文章](http://queue.acm.org/detail.cfm?id=1165766)。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-04T22:31:12.053

切换到 64 位时面临的主要问题是指针的大小不同（64 位而不是 32 位 - duh）整数的大小和 long 的大小也可能不同，具体取决于平台。

为什么这是个问题？好吧，事实并非如此，除非您的代码假定 sizeof(int) == sizeof(void*)。这可能会导致讨厌的指针错误。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-04T22:36:18.050

好吧，从根本上说，更改的数量相当少，但如果应用程序一开始没有仔细编写以使其具有一定的可移植性，这仍然是一项主要任务。

主要区别在于指针是 64 位宽的，*但*大多数其他数据类型没有改变。int 仍然是 32 位，而 long 可能仍然是 32 位。因此，如果您的代码在整数和指针之间转换，那将会中断。类似地，任何依赖于成员特定偏移量的结构或类似结构都可能会中断，因为其他成员现在可能更大，因此会更改偏移量。

当然，你的代码一开始就不应该依赖这些技巧，所以在理想情况下，这根本不是问题，你可以简单地重新编译，一切都会正常工作。但你可能并不生活在一个理想的世界里...... ;)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-05T11:22:31.077

已经有很多好的答案了。

考虑使用[Gimpel Lint](http://www.gimpel.com/)。它可以准确指出有问题的构造类型。如果您的经验与我一样，它还会向您展示系统中与 32/64 位端口无关的许多错误。

# python - 如何动态检索 Django 模型类？

> ID：411810
> 
> 赞同：36
> 
> 时间：2009-01-04T22:32:50.227
> 
> 标签：python, django, django-models, django-queryset

如果没有 Django 模型的完整模块路径，是否可以执行以下操作：

```
model = 'User' [in Django namespace]
model.objects.all() 
```

...相对于：

```
User.objects.all(). 
```

编辑：我正在尝试根据命令行输入进行此调用。是否可以避免导入语句，例如，

```
model = django.authx.models.User 
```

没有 Django 返回错误：

```
"global name django is not defined." 
```

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-01-04T23:11:28.400

我想你正在寻找这个：

```
from django.db.models.loading import get_model
model = get_model('app_name', 'model_name') 
```

当然，还有其他方法，但如果您不知道需要将哪些模型文件导入命名空间，我会采用这种方法。（请注意，如果不首先知道它属于哪个应用程序，实际上没有办法安全地获取模型。如果你想测试你在迭代所有应用程序模型时的运气，请查看 loading.py 的源代码。）

**Django 1.7+ 的更新：**根据 Django 的[弃用时间线](https://docs.djangoproject.com/en/dev/internals/deprecation/#deprecation-removed-in-1-9)，`django.db.models.loading`在 Django 1.7 中已弃用，并将在 Django 1.9 中删除。[正如Alasdair 的回答](https://stackoverflow.com/a/28380435/996114)中所指出的，在 Django 1.7+ 中，有一个[应用程序注册表](https://docs.djangoproject.com/en/1.8/ref/applications/#module-django.apps)。您可以使用该[`apps.get_model`](https://docs.djangoproject.com/en/1.8/ref/applications/#django.apps.apps.get_model)方法动态获取模型：

```
from django.apps import apps
MyModel = apps.get_model('app_label', 'MyModel') 
```

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2015-02-07T09:19:49.723

对于 Django 1.7+，有一个[应用程序注册表](https://docs.djangoproject.com/en/1.8/ref/applications/#module-django.apps)。您可以使用该[`apps.get_model`](https://docs.djangoproject.com/en/1.8/ref/applications/#django.apps.apps.get_model)方法动态获取模型。

```
from django.apps import apps
MyModel = apps.get_model('app_label', 'MyModel') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-04T22:34:45.013

```
from django.authx.models import User
model = User
model.objects.all() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-04T23:42:46.310

> 模型 = django.authx.models.User
> 
> ? Django 返回错误，“未定义全局名称 django。”

Django 不返回错误。Python 可以。

首先，您必须导入模型。您必须使用

```
from django.authx.models import User 
```

其次，如果你得到一个`django`未定义的错误，那么 Django 没有正确安装。你必须有 Django`PYTHONPATH`或者安装在你的 Python 库/站点包中。

要正确安装 Django，请参阅[http://docs.djangoproject.com/en/dev/intro/install/#intro-install](http://docs.djangoproject.com/en/dev/intro/install/#intro-install)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-04T23:43:50.613

类是 Python 中的“第一类”对象，这意味着它们可以像所有其他对象一样被传递和操作。

模型是类——你可以从使用类语句创建新模型的事实中看出：

```
class Person(models.Model):
    last_name = models.CharField(max_length=64)

class AnthropomorphicBear(models.Model):
    last_name = models.CharField(max_length=64) 
```

`Person`和标识符都`AnthropomorphicBear`绑定到 Django 类，所以你可以传递它们。如果您想创建在模型级别工作的辅助函数（并共享一个公共接口），这将很有用：

```
def print_obj_by_last_name(model, last_name):
    model_name = model.__name__
    matches = model.objects.filter(last_name=last_name).all()
    print('{0}: {1!r}'.format(model_name, matches)) 
```

因此`print_obj_by_last_name`将与`Person`或`AnthropomorphicBear`模型一起使用。只需像这样传递模型：

```
print_obj_by_last_name(model=Person, last_name='Dole')
print_obj_by_last_name(model=AnthropomorphicBear, last_name='Fozzy') 
```

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2009-01-04T22:40:44.157

如果您将模型名称作为字符串传递，我想一种方法可能是

```
modelname = "User"
model = globals()[modelname] 
```

但是在某些情况下，使用 globals() 可能会有点危险。所以要小心处理:)

# .net - 可以使用 Enterprise Library 从 .Net 调用 Oracle FUNCTION？

> ID：411820
> 
> 赞同：0
> 
> 时间：2009-01-04T22:39:37.700
> 
> 标签：.net, oracle, enterprise-library

我有以下 Oracle 功能：

```
function get_job_no return number is
        V_job_no number;
      begin
         select appwork.tlm_corphier_job.nextval into V_job_no from dual;
         return V_job_no;
      end get_job_no; 
```

请注意：
1）这是一个函数，而不是一个过程
2）这是返回一个数字，而不是一个 VARCHAR
3）我碰巧使用的是 System.Data.OracleClient 而不是 Oracle.DataAccess.Client （由于另一个问题我是有）但是任何一个解决方案都可以。

我正在尝试使用 MS 企业库从 VB.Net 调用它，如下所示：

```
Imports Microsoft.Practices.EnterpriseLibrary.Data
Imports System.Data.OracleClient
    Public Function GetNextJobNumber() As Object
        Dim db As Database = DatabaseFactory.CreateDatabase()
        Dim myresult As Object = Nothing
        Using cmd As DbCommand = db.GetStoredProcCommand("CORPHIER_PKG.get_job_no")
            Dim retval As New Data.OracleClient.OracleParameter("retval", GetType(System.Data.OracleClient.OracleNumber))
            retval.Direction = ParameterDirection.ReturnValue
            cmd.Parameters.Add(retval)
            db.ExecuteNonQuery(cmd)
            myresult = retval.Value
        End Using
        Return myresult
    End Function 
```

我收到以下错误：

System.InvalidCastException：无法将参数值从 RuntimeType 转换为 Decimal。---> System.InvalidCastException：对象必须实现 IConvertible。在 System.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider) at System.Data.OracleClient.OracleParameter.CoerceValue(Object value, MetaType destinationType) --- 内部异常堆栈跟踪结束 --- 在 System.Data。 OracleClient.OracleParameter.CoerceValue(Object value, MetaType destinationType) at System.Data.OracleClient.OracleParameter.SetCoercedValueInternal(Object value, MetaType metaType) at System.Data.OracleClient.OracleParameterBinding.PrepareForBind(OracleConnection connection, Int32& offset) at System.Data .OracleClient.OracleCommand.Execute(OciStatementHandle statementHandle, CommandBehavior 行为, Boolean needRowid,

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-04T23:11:31.863

好的，这似乎有效：

```
Public Function GetNextJobNumber() As Object
    Dim db As Database = DatabaseFactory.CreateDatabase()
    Using cmd As DbCommand = db.GetStoredProcCommand("CORPHIER_PKG.get_job_no")
        db.AddParameter(cmd, "retval", DbType.Int32, 0, ParameterDirection.ReturnValue, True, 0, 0, String.Empty, DataRowVersion.Current, Convert.DBNull)
        db.ExecuteNonQuery(cmd)
        Return db.GetParameterValue(cmd, "retval")
    End Using
End Function 
```

# c++ - 如何在 Qt 中实现 QHoverEvent？

> ID：411823
> 
> 赞同：9
> 
> 时间：2009-01-04T22:40:49.307
> 
> 标签：c++, qt, events

我只是在用 C++ 学习 Qt。我已经成功实现了信号和槽来捕获诸如`ButtonPushed()`等标准事件。但是，当我将鼠标悬停在`QLabel`. 看起来[QHoverEvent](http://doc.qt.io/qt-4.8/qhoverevent.html)会做我需要的，但我似乎找不到任何关于如何实现它的教程或示例。它的完成方式与信号和插槽相同吗？我试过：

```
connect(ui.lbl_test, SIGNAL(QHoverEvent), this, SLOT(TestFunc(QEvent::Type type, const QPoint & pos, const QPoint & oldPos))); 
```

..但是当我将鼠标悬停在标签上时该函数没有被调用。

这是函数，在头文件中作为公共插槽列出：

```
void MyDialog::TestFunc(QEvent::Type type, const QPoint & pos, const QPoint & oldPos) {
     QMessageBox::information(this, tr("Hey"), tr("Listen!"));
} 
```

任何人都可以帮我解决这个问题或指出一个很好的例子吗？

编辑：

阅读下面的帖子后，我发现没有`setFlag()`成员要求我的标签小部件，但我确实尝试了：

```
 ui.lbl_test->setMouseTracking(true);
    connect(ui.lbl_test, SIGNAL(ui.lbl_test->mouseMoveEvent()), this, SLOT(TestFunc(QMouseEvent *event))); 
```

并相应更新`TestFunc()`。但是当我将鼠标悬停时仍然没有任何反应。

看了之后，我`QLabel`什至不确定是否继承了 mouseMoveEvent() `QWidget`。如果这是真的，是否有一个小部件，或者在某处继承它的对象列表？我可以从他们网站上的文档中看出一个对象有多少继承的函数..

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2014-10-15T21:00:40.287

[http://qt-project.org/doc/qt-5/qwidget.html#enterEvent](http://qt-project.org/doc/qt-5/qwidget.html#enterEvent)

[http://qt-project.org/doc/qt-5/qwidget.html#leaveEvent](http://qt-project.org/doc/qt-5/qwidget.html#leaveEvent)

[http://qt-project.org/doc/qt-5/qt.html#widget-attributes](http://qt-project.org/doc/qt-5/qt.html#widget-attributes)

## Qt::WA_Hover

> 当鼠标进入或离开小部件时，强制 Qt 生成绘制事件。此功能通常在实现自定义样式时使用；有关详细信息，请参阅样式示例。

[http://qt-project.org/doc/qt-5/qtwidgets-widgets-styles-example.html#norwegianwoodstyle-class-implementation](http://qt-project.org/doc/qt-5/qtwidgets-widgets-styles-example.html#norwegianwoodstyle-class-implementation)

> `QStyle::polish()`在使用该样式绘制的每个小部件上都会调用一次此重载。我们重新实现它以将`Qt::WA_Hover`属性设置为`QPushButtons`和`QComboBoxes`。设置此属性后，Qt 会在鼠标指针进入或离开小部件时生成绘制事件。这使得当鼠标指针悬停在按钮和组合框上时可以以不同的方式呈现按钮和组合框。

## 如何接收进入和离开事件`QWidget`

1.  设置 WA_Hover 的 Widget 属性

    ```
    // in your widget's constructor (probably)
    this->setAttribute(Qt::WA_HOVER, true); 
    ```

2.  实施`QWidget::enterEvent()`和`QWidget::leaveEvent()`。

    ```
    void Widget::enterEvent(QEvent * event)
    {
        qDebug() << Q_FUNC_INFO << this->objectName();
        QWidget::enterEvent(event);
    }

    void Widget::leaveEvent(QEvent * event)
    {
        qDebug() << Q_FUNC_INFO << this->objectName();
        QWidget::leaveEvent(event);
    } 
    ```

3.  完毕

## QWidget 中的 QHoverEvent

[http://qt-project.org/doc/qt-5/qhoverevent.html#details](http://qt-project.org/doc/qt-5/qhoverevent.html#details)

[http://qt-project.org/doc/qt-5/qobject.html#event](http://qt-project.org/doc/qt-5/qobject.html#event)

[http://qt-project.org/doc/qt-5/qwidget.html#event](http://qt-project.org/doc/qt-5/qwidget.html#event)

```
// in your widget's constructor (probably)
this->setAttribute(Qt::WA_HOVER, true);
// ...

void Widget::hoverEnter(QHoverEvent * event) {qDebug() << Q_FUNC_INFO << this->objectName();}
void Widget::hoverLeave(QHoverEvent * event) {qDebug() << Q_FUNC_INFO << this->objectName();}
void Widget::hoverMove(QHoverEvent * event) {qDebug() << Q_FUNC_INFO << this->objectName();}

bool Widget::event(QEvent * e)
{
    switch(e->type())
    {
    case QEvent::HoverEnter:
        hoverEnter(static_cast<QHoverEvent*>(e));
        return true;
        break;
    case QEvent::HoverLeave:
        hoverLeave(static_cast<QHoverEvent*>(e));
        return true;
        break;
    case QEvent::HoverMove:
        hoverMove(static_cast<QHoverEvent*>(e));
        return true;
        break;
    default:
        break;
    }
    return QWidget::event(e);
} 
```

**更新：**

## 简单示例

悬停按钮并查看计数变化。查看应用程序输出以获取更多信息。

[https://gist.github.com/peteristhegreat/d6564cd0992351f98aa94f869be36f77](https://gist.github.com/peteristhegreat/d6564cd0992351f98aa94f869be36f77)

希望有帮助。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-04T22:54:22.117

根据你给你的文档链接，如果你的小部件有`Qt::WA_Hover`标志，你只会得到这个 QHoverEvent 。

构建小部件调用后：

```
widget->setAttribute(Qt::WA_Hover); 
```

看看它是否有效。

实现相同结果的另一种方法是`mouseMoveEvent()`在您的小部件中覆盖
通知，除非您调用，否则通常不会调用此函数：

```
widget->setMouseTracking(true); 
```

这基本上就是 QT 在内部实现悬停事件的方式。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-05T23:14:56.473

为此目的使用信号和插槽是行不通的。

`mouseMoveEvent()`不是信号或元方法，不能连接到插槽。

子类化小部件类并覆盖`mouseMoveEvent()`将允许您获取鼠标移动事件，但这是实现此目的的一种非常重量级的方法（并在您的源代码库中添加了一个类）。

相反，请考虑`eventFilter()`在您的类上实现一个方法`MyDialog`并将其安装在`QLabel`. 使用此事件过滤器方法，您可以拦截给定`QObject`实例的所有事件。

这是有关事件过滤器的文档。

[http://doc.qt.io/qt-4.8/eventsandfilters.html#event-filters](http://doc.qt.io/qt-4.8/eventsandfilters.html#event-filters)

此外，通过查看代码示例，我建议您花点时间研究一下`SIGNAL()`和`SLOT()`宏的作用。你可以看到它们是如何定义的`$QTDIR/src/corelib/kernel/qobjectdefs.h`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-10-26T20:47:10.993

我遇到了同样的问题，我来到了以下解决方案设计：

在我的主小部件中，我想处理一些选定对象的悬停事件。出于这个原因，我在我的上创建了 2 个插槽`MainWindow`：

```
public slots:
    void onHoverIn(QObject* object);
    void onHoverOut(QObject* object); 
```

然后我创建了一个这样的事件过滤器类：

悬停事件过滤器.h

```
#ifndef HOVEREVENTFILTER_H
#define HOVEREVENTFILTER_H

#include <QObject>
#include <QEvent>

class HoverEventFilter : public QObject
{
    Q_OBJECT
public:
    explicit HoverEventFilter(QObject *parent = 0);

signals:
    void HoverIn(QObject *);
    void HoverOut(QObject *);

public slots:

protected:
    bool eventFilter(QObject *watched, QEvent *event);
};

#endif // HOVEREVENTFILTER_H 
```

悬停事件过滤器.cpp

```
#include "hovereventfilter.h"

HoverEventFilter::HoverEventFilter(QObject *parent) : QObject(parent)
{

}

bool HoverEventFilter::eventFilter(QObject *watched, QEvent *event)
{

    QEvent::Type t = event->type();

    switch(t){
    case QEvent::Enter:
        emit HoverIn(watched);
        break;

    case QEvent::Leave:
        emit HoverOut(watched);
        break;
    default:
        return false;
    }

    return true;
} 
```

您可以看到此类将根据发生的情况触发 HoverIn 或 HoverOut。**这种方法不需要设置`Qt::WA_Hover`**

现在作为最后一步，我们需要指示要过滤哪些元素并连接信号和插槽。我将在 mainwindow.h 中创建一个指向事件过滤器的私有指针

```
class MainWindow : public QWidget
{
    Q_OBJECT

...

public slots:
    void onHoverIn(QObject* object);
    void onHoverOut(QObject* object);

private:

    HoverEventFilter* hoverEventFilter;

...

}; 
```

在构造函数中，我添加了这个：

```
this->hoverEventFilter = new HoverEventFilter(this);

connect(this->hoverEventFilter, SIGNAL(HoverIn(QObject*)), this, SLOT(onHoverIn(QObject*)));
connect(this->hoverEventFilter, SIGNAL(HoverOut(QObject*)), this, SLOT(onHoverOut(QObject*))); 
```

现在，每当我希望在某个对象上接收悬停事件时，我只需在其上设置事件过滤器，如下所示：

```
this->ui->someLabelOrWhatever->installEventFilter(this->hoverEventFilter); 
```

剩下的是`onHoverIn`和`onHoverOut`in的实现`MainWindow`。他们都有相同的想法，所以我将只展示`onHoverIn`

```
void MainWindow::onHoverIn(QObject *object)
{
    QString objectName = object->objectName();

    switch(objectName){
        // do something depending on name of the widget
    }
} 
```

您可以轻松扩展它，以处理新项目上的悬停事件，您只需在其上设置一个事件侦听器并处理您希望在`onHoverIn`and`onHoverOut`方法中执行的操作。无需对任何小部件进行子类化。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-07-30T14:25:20.183

`QHoverEvent`仅适用于悬停小部件，您希望通过子类化小部件来实现`enterEvent`和`leaveEvent`处理程序。如果您想改用事件过滤器，则对应的事件类型为`QEvent::Enter`和`QEvent::Leave`。

如果您只需要更改小部件的外观，您可能需要查看 Qt 样式表，因为它们提供了一个`:hover`选择器。

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2009-03-07T23:22:32.667

您需要继承或过滤该特定小部件的[focusInEvent](http://doc.trolltech.com/4.5/qwidget.html#focusInEvent)和[focusOutEvent](http://doc.trolltech.com/4.5/qwidget.html#focusOutEvent)。

# .net - NHibernate 与字符串主键和关系

> ID：411825
> 
> 赞同：5
> 
> 时间：2009-01-04T22:41:26.497
> 
> 标签：.net, nhibernate, nhibernate-mapping

我刚刚被这个问题困扰了一个小时，最终我很烦人地发现了这个问题。

**情况**

我有一个表，它使用一个字符串作为主键，这个表有各种多对一和多对多关系，所有这些关系都与这个主键无关。

从表中搜索多个项目时，所有关系都被带回。但是，每当我尝试通过主键（字符串）获取对象时，它并没有带回任何关系，它们总是设置为 0。

**部分解决方案**

所以我查看了我的日志以查看 SQL 正在做什么，并且返回了正确的结果。所以我以各种随机的方式尝试了各种事情，最终得出了结论。将字符串传递给 get 方法的情况与数据库中的情况并不完全相同，因此当它尝试将关系项与主要实体匹配时，它什么也没找到**（或者至少 NHIbernate 没有因为正如我上面所说，SQL 实际上返回了正确的结果）**

**真正的解决方案**

有没有其他人遇到过这个？如果是这样，您如何告诉 NHibernate 在将 SQL 结果与实体匹配时忽略大小写？这很愚蠢，因为它之前工作得很好，突然之间它开始关注字符串的大小写。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-15T15:22:38.227

我在我的数据库中的 ref 表上有完全相同的情况。我以与您相同的方式映射架构文件​​。在代码中，当我通过主键查询记录时，我使用 NHibernate ISession 的实例执行以下操作：

```
return session.Get<T>(id); 
```

在此语句中，T 是您要查询的类型，id 是您要查找的字符串 id（主键）

这是我的映射文件的示例：

```
 <class name="Merchant" table="T__MERCHANT">
        <id name="MerchantId" column="MERCHANT_ID" type="string">
            <generator class="assigned" />
        </id>

        <property name="MerchantStatusId" column="MERCHANT_STATUS_ID" type="Char" not-null="true" length="1" />
        <property name="MerchantStatusName" column="MERCHANT_STATUS_NAME" type="string" length="50" />
        <property name="MerchantName" column="NAME" type="string" not-null="true" length="50" />
 </class>
</hibernate-mapping> 
```

我的 C# 代码如下所示：

```
public Merchant GetMerchantById(string id)
{
     return session.Get<Merchant>(id);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T23:37:22.060

为了一致性起见，请修改：

```
<joined-subclass name="JohnHarmanLtd.Web.FineArtCompany.Models.Book, App_Code.tqeub3fb, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null"> 
```

更具体地说是“ **App_Code.tqeub3fb** ”。看起来您正在使用来自 ASP.NET 网站的临时程序集作为 NHibernate 映射的一部分？

将您的业务实体移到它们自己的库中，这样程序集名称始终相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-05T16:49:16.437

这是我的解决方法（这是一种解决方法；我正在处理一个 IMO 设计不佳的就地数据库）。

原文出自：[https ://forum.hibernate.org/viewtopic.php?f=25&t=979685&view=previous](https://forum.hibernate.org/viewtopic.php?f=25&t=979685&view=previous)

这是我的自定义字符串类（在 VB 中）：

```
Imports NHibernate.UserTypes
Imports NHibernate.Type
Imports NHibernate.SqlTypes

Public Class CaseInsensitiveStringType
    Inherits AbstractStringType

    ' Methods
    Public Sub New()
        MyBase.New(New StringSqlType)
    End Sub

    Public Sub New(ByVal sqlType As StringSqlType)
        MyBase.New(sqlType)
    End Sub

    ' Properties
    Public Overrides ReadOnly Property Name As String
        Get
            Return "InsensitiveString"
        End Get
    End Property

    Public Overrides Function IsEqual(ByVal x As Object, ByVal y As Object) As Boolean
        Return MyBase.IsEqual(x, y) OrElse (x IsNot Nothing AndAlso y IsNot Nothing AndAlso String.Equals(x, y, StringComparison.InvariantCultureIgnoreCase))
    End Function

    Public Overrides Function GetHashCode(ByVal x As Object, ByVal entityMode As NHibernate.EntityMode, ByVal factory As NHibernate.Engine.ISessionFactoryImplementor) As Integer
        Return MyBase.GetHashCode(x.ToString().Trim().ToUpperInvariant(), entityMode, factory)
    End Function
End Class 
```

而且我使用 FluentNhibernate，所以这是映射的样子（仅适用于 Id 字段）：

```
Id(Function(x) x.Id).GeneratedBy.Assigned().CustomType(Of CaseInsensitiveStringType)() 
```

就是这样；我的关联开始再次正确填充。

同样，使用 int/GUID PK 而不是字符串来正确设计数据库要好得多，但如果必须这样做，这是“修复”NHibernate 的一种不错的方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-23T20:49:44.707

我不明白你的问题：

*   当您通过 PK 使用 Get 方法查询时，返回的对象对于关系没有任何值
*   当您通过另一种查询进行查询时（示例将很有用），关系不为空吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-09T14:23:47.003

对此没有选择，但您可以使用 QBE 实现相同的目标

```
Example.create(parent).ignoreCase() 
```

# sql-server - 身份插入

> ID：411829
> 
> 赞同：5
> 
> 时间：2009-01-04T22:46:18.967
> 
> 标签：sql-server

任何人都可以请解释一下 SET IDENTITY INSERT ON 和 OFF 的作用。

谢谢，克里斯

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-04T23:13:59.160

假设您有一个带有自动增量/标识列的表。当您进行插入时，您通常不能为该列指定值，因为它是自动填充的。

但是，如果您`SET IDENTITY_INSERT YourTable ON`先调用，则*可以*将特定值插入标识列。

我在手动合并表时最常使用它——我从未在定期执行的代码块中使用它。

另请注意，您一次只能在一个表上指定此项。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-04T22:47:57.247

[设置 IDENTITY_INSERT](http://msdn.microsoft.com/en-us/library/ms188059.aspx) ON

允许将显式值插入到表的标识列中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-05T15:52:51.937

迈克尔哈伦已经给了你答案，但我想放大。使用这个命令是非常危险的，你不应该使用它，除非在少数非常有限的情况下。当您使用它时，自动编号不再适用于任何人，因此将记录正常插入数据库的所有代码都将失败。因此，应尽可能或至少在非工作时间以单用户模式进行。不应该定期插入记录，而只能用于将数据从一个表合并到数据库重新设计中的新结构之类的事情。如果您在使用此命令时不知道自己在做什么，您可能会严重破坏数据库的数据完整性。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-04T23:11:29.417

chrisprat，到目前为止，您已经注册了一周，您的所有活动都是提出五个问题，这些问题很容易被 Google 或 MSDN 回答。

这是怎么回事？

# sql - 应用程序执行复杂的 SQL 查询

> ID：411836
> 
> 赞同：1
> 
> 时间：2009-01-04T22:49:05.560
> 
> 标签：sql, sql-server, tsql

我的应用程序需要对数据库执行一系列相当复杂的查询。通常我会将所有内容转储到存储过程中并以这种方式执行。

但我无权访问我尝试访问的数据库，因此无法创建存储过程。有没有更好的方法来执行此操作，而不是访问数据库 5-6 次以获得我需要的结果？我可以将所有内容加入一个查询中，但如果可能的话，我想避免这种情况，因为我需要加入大约 10 个表。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-04T22:53:08.640

如果这最终是您需要做的，那么加入 10 个表没有任何问题。一般SQL擅长这种事情。但是，如果您的 5-6 个查询之间没有那么紧密的耦合，则单独运行它们。

如果您选择分解查询，则击中 DB 5-6 次就可以了——这绝对没有错。无论如何，您的访问方法（例如 ADO.NET）可能会免费为您提供连接池，因此多个查询的开销非常小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-04T22:53:26.393

您始终可以通过用“;”分隔它们来一次执行相同系列的查询。.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-04T22:53:24.770

如果可以将所有内容合并到一个查询中，那么根据我的经验，这样做几乎总是更有效；无论如何，您都应该这样做。在任何情况下都首先遵循这条线索。仅在不可行时才考虑替代方案。

# algorithm - 在矩阵/位图中查找质量簇

> ID：411837
> 
> 赞同：5
> 
> 时间：2009-01-04T22:49:06.230
> 
> 标签：algorithm, language-agnostic, geometry

这是此处发布的问题的延续： [Finding the center of mass on a 2D bitmap](https://stackoverflow.com/questions/408358/finding-the-center-of-mass-on-a-2d-bitmap)讨论了在布尔矩阵中查找质心，如给出的示例。

假设现在我们将矩阵展开为这种形式：

```
0 1 2 3 4 5 6 7 8 9
1 . X X . . . . . .
2 . X X X . . X . .
3 . . . . . X X X .
4 . . . . . . X . .
5 . X X . . . . . .
6 . X . . . . . . .
7 . X . . . . . . .
8 . . . . X X . . .
9 . . . . X X . . . 
```

如您所见，我们现在有 4 个质心，用于 4 个不同的集群。

鉴于只有一个质心存在，我们已经知道如何找到质心，如果我们在这个矩阵上运行该算法，我们将在矩阵中间得到一些点，这对我们没有帮助。

什么是找到这些质量簇的好、正确和快速的算法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-04T22:57:53.747

我想我会检查矩阵中的每个点并根据它的邻居找出它的质量。点的质量会随着距离的平方下降。然后，您可以选择彼此之间距离最小的前四个点。

这是我拼凑起来的一些 Python 代码，试图说明找出每个点的质量的方法。使用您的示例矩阵进行一些设置：

```
matrix = [[1.0 if x == "X" else 0.0 for x in y] for y in """.XX......
.XXX..X..
.....XXX.
......X..
.XX......
.X.......
.X.......
....XX...
....XX...""".split("\n")]

HEIGHT = len(matrix)
WIDTH = len(matrix[0])
Y_RADIUS = HEIGHT / 2
X_RADIUS = WIDTH / 2 
```

要计算给定点的质量：

```
def distance(x1, y1, x2, y2):
  'Manhattan distance http://en.wikipedia.org/wiki/Manhattan_distance'
  return abs(y1 - y2) + abs(x1 - x2)

def mass(m, x, y):
  _mass = m[y][x]
  for _y in range(max(0, y - Y_RADIUS), min(HEIGHT, y + Y_RADIUS)):
    for _x in range(max(0, x - X_RADIUS), min(WIDTH, x + X_RADIUS)):
      d = max(1, distance(x, y, _x, _y))
      _mass += m[_y][_x] / (d * d)
  return _mass 
```

注意：我在这里使用[曼哈顿](http://en.wikipedia.org/wiki/Manhattan_distance)距离（又名 Cityblock，又名出租车几何），因为我认为使用欧几里德距离增加的精度不值得调用 sqrt() 的成本。

遍历我们的矩阵并建立一个元组列表，如 (x, y, mass(x,y))：

```
point_mass = []
for y in range(0, HEIGHT):
  for x in range(0, WIDTH):
    point_mass.append((x, y, mass(matrix, x, y))) 
```

对每个点的质量列表进行排序：

```
from operator import itemgetter
point_mass.sort(key=itemgetter(2), reverse=True) 
```

查看该排序列表中的前 9 个点：

```
(6, 2, 6.1580555555555554)
(2, 1, 5.4861111111111107)
(1, 1, 4.6736111111111107)
(1, 4, 4.5938888888888885)
(2, 0, 4.54)
(4, 7, 4.4480555555555554)
(1, 5, 4.4480555555555554)
(5, 7, 4.4059637188208614)
(4, 8, 4.3659637188208613) 
```

如果我们从最高到最低工作并过滤掉与已经看到的点太接近的点，我们将得到（我正在手动进行，因为我现在没有时间在代码中执行它......）：

```
(6, 2, 6.1580555555555554)
(2, 1, 5.4861111111111107)
(1, 4, 4.5938888888888885)
(4, 7, 4.4480555555555554) 
```

这是一个非常直观的结果，只需查看您的矩阵（请注意，与您的示例进行比较时，坐标为零）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T17:16:40.037

您需要一个聚类算法，这很容易，因为您只有一个二维网格，并且条目彼此相邻。您可以只使用[洪水填充算法](http://en.wikipedia.org/wiki/Flood_fill)。拥有每个集群后，您可以像在[2D center of mass 文章中一样找到中心。](https://stackoverflow.com/questions/408358/finding-the-center-of-mass-on-a-2d-bitmap).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-04T22:59:27.067

我的第一个想法是首先找到任何具有非零值的单元格。从那里做一些洪水填充算法，并计算找到的细胞的质心。接下来将矩阵中找到的单元格归零，然后从顶部重新开始。

这当然不会像谷歌的方法那样扩展，tuinstoel 链接，但对于较小的矩阵更容易实现。

编辑：

[不相交集](http://en.wikipedia.org/wiki/Disjoint-set_data_structure "维基百科：不相交集数据结构")（使用路径压缩和按等级联合）在这里可能很有用。它们对于并集和查找集具有*O* ( *α* ( *n* )) 时间复杂度，其中

> *α* ( *n* ) = min { *k* : A [*k*] (1) ≥ *n* }。

A [*k*] ( *n* ) 是 Ackerman 函数，因此对于任何合理的值， *α* ( *n* ) 本质上都是*O (1)。*唯一的问题是不相交的集合是项目到集合的单向映射，但是如果您要遍历所有项目，这并不重要。

这是一个用于演示的简单python脚本：

```
from collections import defaultdict

class DisjointSets(object):
    def __init__(self):
        self.item_map = defaultdict(DisjointNode)

    def add(self,item):
        """Add item to the forest."""
        # It's gets initialized to a new node when
        # trying to access a non-existant item.
        return self.item_map[item]

    def __contains__(self,item):
        return (item in self.item_map)

    def __getitem__(self,item):
        if item not in self:
            raise KeyError
        return self.item_map[item]

    def __delitem__(self,item):
        del self.item_map[item]

    def __iter__(self):
        # sort all items into real sets
        all_sets = defaultdict(set)
        for item,node in self.item_map.iteritems():
            all_sets[node.find_set()].add(item)
        return all_sets.itervalues()

class DisjointNode(object):
    def __init__(self,parent=None,rank=0):
        if parent is None:
            self.parent = self
        else:
            self.parent = parent
        self.rank = rank

    def union(self,other):
        """Join two sets."""
        node1 = self.find_set()
        node2 = other.find_set()
        # union by rank
        if node1.rank > node2.rank:
            node2.parent = node1
        else:
            node1.parent = node2
            if node1.rank == node2.rank:
                node2.rank += 1
        return node1

    def find_set(self):
        """Finds the root node of this set."""
        node = self
        while node is not node.parent:
            node = node.parent
        # path compression
        root, node = node, self
        while node is not node.parent:
            node, node.parent = node.parent, root
        return root

def find_clusters(grid):
    disj = DisjointSets()
    for y,row in enumerate(grid):
        for x,cell in enumerate(row):
            if cell:
                node = disj.add((x,y))
                for dx,dy in ((-1,0),(-1,-1),(0,-1),(1,-1)):
                    if (x+dx,y+dy) in disj:
                        node.union(disj[x+dx,y+dy])
    for index,set_ in enumerate(disj):
        sum_x, sum_y, count = 0, 0, 0
        for x,y in set_:
            sum_x += x
            sum_y += y
            count += 1
        yield 1.0 * sum_x / count, 1.0 * sum_y / count

def main():
    grid = [[('.' != cell) for cell in row if not cell.isspace()] for row in (
        ". X X . . . . . .",
        ". X X X . . X . .",
        ". . . . . X X X .",
        ". . . . . . X . .",
        ". X X . . . . . .",
        ". X . . . . . . .",
        ". X . . . . . . .",
        ". . . . X X . . .",
        ". . . . X X . . .",
    )]
    coordinates = list(find_clusters(grid))
    centers = dict(((round(x),round(y)),i) for i,(x,y) in enumerate(coordinates))
    for y,row in enumerate(grid):
        for x,cell in enumerate(row):
            if (x,y) in centers:
                print centers[x,y]+1,
            elif cell:
                print 'X',
            else:
                print '.',
        print
    print
    print '%4s | %7s %7s' % ('i','x','y')
    print '-'*22
    for i,(x,y) in enumerate(coordinates):
        print '%4d | %7.4f %7.4f' % (i+1,x,y)

if __name__ == '__main__':
    main() 
```

输出：

```
. X X . . . . . .
. X 3 X . . X . .
. . . . . X 4 X .
. . . . . . X . .
. X X . . . . . .
. 2 . . . . . . .
. X . . . . . . .
. . . . X X . . .
. . . . X 1 . . .

   i |       x       y
----------------------
   1 |  4.5000  7.5000
   2 |  1.2500  4.7500
   3 |  1.8000  0.6000
   4 |  6.0000  2.0000 
```

这样做的目的是展示不相交的集合。中的实际算法`find_clusters()`可以升级为更强大的算法。

**参考**

*   *算法简介。*第 2 版。科门等人。

# windows - 是否可以让 Microsoft build.exe 包含来自远程目录的源？

> ID：411841
> 
> 赞同：4
> 
> 时间：2009-01-04T22:51:32.700
> 
> 标签：windows, build, wdk

将源文件添加到多个目录之外（例如 ../../source.cpp 或 ../../../somewhere_else/source.cpp，与仅 source.cpp 或 ../source.cpp 相比） WDK/DDK 构建中的 SOURCES= 声明会产生以下错误：

```
Ignoring invalid directory prefix in SOURCES= entry 
```

是否可以在构建中包含远程源文件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-04T22:57:50.393

无法直接执行此操作。`build`明确设计为仅处理文件相同或父目录中的源代码`sources`。它不能使用来自任意位置的源文件。特别是，它的依赖跟踪系统似乎无法解析和跟踪远程文件，因此它明确检查并强制所有文件都是本地文件。

有两种常见的解决方案：

1.  将远程代码构建为单独的库（通过同一`build`项目中的另一个子项目/目录，或使用独立的构建步骤）。

2.  为执行的每个远程源文件放置一个本地存根`#include "../../remote_source.cpp`，然后将此本地存根添加到`SOURCES=`列表中。这将起作用，*但*`build`/`nmake`不会跟踪. 如果发生更改，您将不得不使用本地代理源，或者以其他方式强制重建（删除本地代理 obj、使用运行或其他方式）。*`remote_source.cpp``remote_source.cpp``touch``build``-cZ`*

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-30T08:02:14.390

另一种方法是使用 source.inc 来包含这些文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-30T21:25:58.983

讨厌复活一个超级老话题，但我也遇到了这个问题。

另一种替代方法是在其中创建另一个源文件，该文件仅构建远程源的目标文件，因此基本上是一个名为**某处_else\sources**的文件，并为其提供相同的中间目录。

然后将“dirs”文件添加到您的原始目录并在其中指定该远程文件夹。然后通过在原始源文件中添加类似这样的内容直接链接到目标文件：

```
$(TARGETLIBS) = $(PROJECT_OBJ_ROOT)\$(O)\source.obj 
```

这样，您不必编译为 lib，但 build 将其视为一个并链接，无需任何依赖项检查或位置关心。

***当然，如果你给它们相同的中间目录和相同的原始源文件名（source.cpp），你可能会遇到一些问题***

# c# - .NET 3 中 System.Random 的随机性如何？

> ID：411843
> 
> 赞同：6
> 
> 时间：2009-01-04T22:52:52.697
> 
> 标签：c#, .net, random

我目前正在编写一个简单的密码生成器（C#）。为此，我需要一些随机数。

可以简单地使用 .NET 附带的[Random](http://msdn.microsoft.com/en-us/library/system.random.aspx)类，还是有任何已知问题？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-04T22:54:39.263

它没有任何问题——它足以生成简单的密码。一个简单的例子（[来源](http://authors.aspalliance.com/brettb/RandomNumbersInCSharp.asp)）：

```
Random RandomClass = new Random();
int RandomNumber = RandomClass.Next(); // Random number between 1 and 2147483647
double RandomNumber = RandomClass.Next(1,10); // Random number between 1 and 10

double RandomDouble = RandomClass.NextDouble(); // Random double between 0.0 and 1.0 
```

*[How To: Generate a Random Password (C#/VB.NET)](http://www.obviex.com/Samples/Password.aspx)*一文有一个非常全面的示例，说明如何生成具有指定复杂性的良好、易于阅读的密码。这对你来说可能有点矫枉过正，但它可能会提供一个很好的来源来复制想法。

* * *

如果你需要更多的密码学知识，还有另一个命名空间：

```
System.Security.Cryptography 
```

具体来说，你可以使用这个：

```
System.Security.Cryptography.RNGCryptoServiceProvider.GetBytes(yourByte) 
```

一个例子是*[在 VB.NET 中将 Crypto 用于您的随机数](http://geekswithblogs.net/cwilliams/archive/2005/10/16/57141.aspx)*，另一个是*[Crypto Random Numbers](http://weblogs.asp.net/dbright/archive/2003/10/16/32305.aspx)*。

如果您正在考虑推出自己的产品，*[开发者指南分享](http://www.guidanceshare.com/wiki/.NET_Framework_2.0_Security_Inspection_Questions_-_Cryptography)*网站有一些信息可以让您摆脱它。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-05T00:28:09.963

System.Random*不是*随机性的“加密强”源。假设攻击者知道（或可以猜测）用于创建 System.Random 的“种子”值，则 Random 函数的输出是完全可预测的。如果您只是简单地调用 new System.Random() ，那么初始值只是当前系统时间的表示（攻击者通常很容易猜到这一点）。

即使不完全知道初始时间，攻击者也可以通过蛮力检查给定时间范围内的所有潜在值。

System.Security.Cryptography 命名空间中的随机生成器设计用于这种情况，并从许多更安全的来源中获得其不可预测性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-04T23:04:12.533

如果您想了解如何`System.Random`为您工作的一些细节，那么这篇[CodeBetter](http://codebetter.com/blogs/brendan.tompkins/archive/2005/03/09/59496.aspx)文章非常值得一读。他很好地概述了 Random 函数正在做什么以及如何使用散列 GUID 作为种子使其“更随机”。如果您只需要为用户帐户生成随机初始密码（我在这里假设），那么这应该绰绰有余，在这种情况下，加密工具可能会矫枉过正。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-06T17:22:34.610

一切都有一个[RFC ！](http://en.wikipedia.org/wiki/Request_for_Comments)-*[安全随机性要求](http://www.ietf.org/rfc/rfc4086.txt)*(RFC 4086)。

您还可以在硬件上花费一些大笔资金来创建随机种子。我认为[盖革计数器](http://en.wikipedia.org/wiki/Geiger_counter)是专业解决方案的标准。现在大多数扑克网站都使用这个。

# c - 在 C 中解压缩 .Z 文件

> ID：411856
> 
> 赞同：0
> 
> 时间：2009-01-04T22:57:58.087
> 
> 标签：c, compression

有人可以指出我在 ANSI C 中解压缩 .Z 文件的公共域（或 MIT 或 BSD 许可证）库吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-04T23:18:55.047

对不起，我在之前的回复中胡说八道。显然 unix 压缩文件 (.Z) 使用 LZW，而不是 Deflate。

在这种情况下，请查看[liblzw](http://freestdf.sourceforge.net/liblzw.php)。它是公共领域。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-04T23:14:34.480

sourceforge 上有一个公共域版本：[ncompress](http://ncompress.sourceforge.net/)

**编辑：** [liblzw](http://freestdf.sourceforge.net/liblzw.php)（DrJokepu 的建议）和 ncompress 共享相同的开发人员和代码库，所以坚持使用 liblzw ...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-04-17T16:24:08.130

您可以使用 BSD 许可的库[lzws](https://github.com/andrew-aladev/lzws)。它没有来自 ncompress（20 世纪）的遗留代码。

# actionscript-3 - 与 Erlang 服务器的 Flash 通信

> ID：411857
> 
> 赞同：3
> 
> 时间：2009-01-04T22:57:59.303
> 
> 标签：actionscript-3, erlang

看来，这是一个 erlang 问题。我有这段代码来测试客户端发送数据，用 Actionscript 3 编写：

```
var socket:Socket=new Socket("localhost", 2345);
socket.addEventListener(Event.CONNECT, connected);

private function connected(event:Event):void {
    socket.writeInt(12); //packet length, should be correct? 4 bytes each?
    socket.writeInt(3);
    socket.writeInt(6);
    socket.writeInt(9);
    socket.flush();
} 
```

然后我有了这个用 Erlang 编写的小型服务器：

```
start_nano_server() ->
    {ok, Listen} = gen_tcp:listen(2345, [binary, {packet, 0},
                     {reuseaddr, true},
                     {active, true},
                    {packet_size, 128}]),
    {ok, Socket} = gen_tcp:accept(Listen),
    gen_tcp:close(Listen), 
    receive_data(Socket, []).

receive_data(Socket, SoFar) ->
    receive
    {tcp,Socket,Bin} ->   
        receive_data(Socket, [Bin|SoFar]);
    {tcp_closed,Socket} ->
        Bytes=list_to_binary(reverse(SoFar)),
        io:format("~p~n",[Bytes])
    end. 
```

现在，无论我从客户端发送什么，我总是得到`[<<0,0,0,4,0,0,0,32>>]`响应。我可以尝试直接将字节写入套接字而不是整数，我得到了同样的结果。我可以写更多或更少的数据，结果相同。UTF 字符串相同的结果。即使将“4”指定为数据包头长度，我也只会得到相同的一致结果`[<<0,0,0,32>>]`。我不明白我在这里做错了什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-05T16:00:00.987

这是连接到 Flash 套接字的工作 Erlang 服务器的摘录...

它基于 Klacke 的 Chargen 服务器示例： [http ://erlang.org/examples/klacke_examples/chargen.erl](http://erlang.org/examples/klacke_examples/chargen.erl)

```
-module(remoting_soc).

-export([accept/1]).

accept(Listen) ->

    {ok, Soc} = gen_tcp:accept(Listen),
    Pid = spawn(fun() -> loop(Soc) end),
    gen_tcp:controlling_process(Soc,Pid),
    %% Start Listening for another connection
    remoting_soc:accept(Listen).

loop(Socket)->

    receive

        {tcp, Socket,"register"++Rest} ->
            ...do stuff...
            loop(Socket);

    end. 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-05T14:11:44.450

`Listen`接收数据前尽量不要关闭。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-05T15:02:13.507

怀疑它更可能是 Flash 问题 - 您的 Erlang 服务器代码与 Java 套接字客户端完美配合。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-05T20:50:32.523

如果有人想知道答案，我将回答我自己的问题。

使用数据包嗅探器，我能够发现 Flash 确实发送了错误的数据包。虽然我不知道数据包数据的实际意义，但我知道问题出在哪里。我想这是因为我在同一台机器上打开了 Flash 套接字和 Erlang 套接字——通常这不会是一个问题，但我相信由于 Flash 在侦听套接字和发送套接字之间没有任何区别，所以它不知何故与 Erlang 程序上的打开套接字发生冲突。

当您在 Flash 套接字中指定 Socket(host, port) 时，您不仅可以在该套接字上发送数据，而且还可以接收它，因此这似乎是问题的根源。

我测试了在我的笔记本电脑上运行 Flash 程序并在我的 PC 上运行服务器，它运行良好。

# visual-studio - 有没有一种快速的方法来更改具有大量控件的表单上的 tabindexes？

> ID：411861
> 
> 赞同：6
> 
> 时间：2009-01-04T22:59:55.850
> 
> 标签：visual-studio

所以我有一个包含很多控件的表单，这些控件都有一个标签索引。

插入一些额外的字段后，我必须在新控件之后编辑所有控件的索引。

是否有一种简单的方法可以在 Visual Studio 中自动执行此操作，或者是否有某种插件？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-04T23:06:02.327

假设您正在谈论 Windows 窗体 UI。您可以单击菜单：查看 | Tab Order，然后只需单击您希望 Tab 键顺序所在的控件。对于 Visual Studio 中的基于 Web 的 UI，似乎没有任何类似的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-04T23:02:43.957

使 tabindex 的增量为 5 或 10，然后如果您插入新控件，则不会出现此问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-04T23:05:36.917

[MZ-Tools](http://www.mztools.com/)有一个[TabIndex 助手](http://www.mztools.com/v6/features.aspx#TabIndexAssistant)。

# sql-server - `SET ANSI_NULLS OFF` 有什么作用？

> ID：411864
> 
> 赞同：9
> 
> 时间：2009-01-04T23:01:53.583
> 
> 标签：sql-server

做什么`SET ANSI_NULLS OFF`？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-04T23:03:58.197

[来自 MSDN：](http://msdn.microsoft.com/en-us/library/aa259229(SQL.80).aspx)

> SQL-92 标准要求针对空值的等于 (=) 或不等于 (<>) 比较的计算结果为 FALSE。
> 
> 当`SET ANSI_NULLS`为**ON**`WHERE column_name = NULL`时，即使 column_name 中有空值，使用的 SELECT 语句也会返回零行。`WHERE column_name <> NULL`即使 column_name 中有非空值，使用 SELECT 语句也会返回零行。
> 
> 当`SET ANSI_NULLS`为**OFF**时，等于 (=) 和不等于 (<>) 比较运算符不遵循 SQL-92 标准。SELECT 语句使用`WHERE column_name = NULL`返回 column_name 中具有空值的行。SELECT 语句使用`WHERE column_name <> NULL`返回列中具有非空值的行。此外，SELECT 语句 using`WHERE column_name <> XYZ_value`返回所有非 XYZ_value 且非 NULL 的行。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-04T23:04:06.793

它改变了`NULL`s 的行为方式。`NULL`ANSI 中的 s 产生类似的东西

`NULL = NULL`-> 假的

`NULL <> NULL`-> 假的

`ANSI_NULLS`关闭时，( ) `NULL = NULL`-> true。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-10-01T02:37:52.490

`SET ANSI_NULLS OFF`指示服务器评估涉及`NULL`使用非标准语义的语句。

```
SET ANSI_NULLS OFF;
SELECT CASE WHEN NULL = NULL THEN 1 ELSE 0 END; -- Evaluates to 1 (bad!)
SET ANSI_NULLS ON;
SELECT CASE WHEN NULL = NULL THEN 1 ELSE 0 END; -- Evaluates to 0 (good!) 
```

您永远不应使用以下非标准语义设置**创建新代码**`SET ANSI_NULLS OFF`，因为：

*   从来没有必要，
*   为了使数据库查询表现出与`NULL`任何其他值（例如在`WHERE`子句中）不同处理时出现的丰富语义，与值比较的值`NULL`应始终返回 False / UNKNOWN，
*   它使代码更难维护，因为开发人员可能没有意识到它正在使用非标准设置，或者被它弄糊涂了，并且
*   [Microsoft 已警告说](https://docs.microsoft.com/en-us/sql/t-sql/statements/set-ansi-nulls-transact-sql)，在 SQL Server 的未来版本中，该设置将导致显式错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T02:57:29.000

当打开时，它不计算 Null 值并返回 0。

启用此选项后，任何将值与 null 进行比较的查询都会返回 0

示例： SET ANSI_NULLS ON SELECT empname FROM emp1 WHERE phone=NULL

解释：它不会返回任何内容，因为 SET ANSI_NULLS 为 ON。

资源：

[http://www.xpode.com/ShowArticle.aspx?ArticleId=599](http://www.xpode.com/ShowArticle.aspx?ArticleId=599)

谢谢，

罗希特

# .net - 在 .NET 中实现 IHttpSecurity（托管代码）

> ID：411865
> 
> 赞同：1
> 
> 时间：2009-01-04T23:01:59.810
> 
> 标签：.net, webbrowser-control

如何在 .NET 中为 Webbrowser Control 实现 IHttpSecurity？

我找不到任何示例，所有示例都在 C++ 中，MSDN 文档也仅适用于 C++

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-05T02:30:40.450

为此，您将不得不使用 COM 互操作。在 IDL 文件 (urlmon.idl) 中查找接口的 IID (guid)，然后在代码中重新创建接口。您可能必须将 PreserveSig 属性附加到 OnSecurityProblem 接口，以便可以返回适当的错误代码。

# c# - 代表电子邮件附件的字符串值，如何存储到磁盘/数据库？

> ID：411874
> 
> 赞同：0
> 
> 时间：2009-01-04T23:06:41.173
> 
> 标签：c#, .net, encoding, file, io

好的，事实证明我正在使用的这个第 3 方组件将电子邮件附件存储在字符串类型的属性中（它已经被解码）。

我现在如何将其存储到文件中？

它有：文件名、编码类型和文件的字符串表示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T00:23:02.060

使用 StreamWriter/TextWriter 类打开文件并调用 .Write 方法。或者，您可以先使用 Convert.ToBase64String 对其进行 base64 编码。

# objective-c - 在 C double 和 Cocoa 的 NSDecimalNumber 之间转换？

> ID：411876
> 
> 赞同：5
> 
> 时间：2009-01-04T23:08:49.217
> 
> 标签：objective-c, cocoa, cocoa-touch

我正在将我用 Java 编写的算法转换为 Objective-C。在 java 中，BigDecimal 类处理基数为 10 的数字，并且可以将原始 double 作为构造函数 arg。然而，在 Cocoa 的 NSDecimalNumber 类中，没有直接的方法可以使用原始双精度来构造实例。

目前我正在使用这个（难闻的）黑客：

```
 [NSDecimalNumber decimalNumberWithString:[NSString stringWithFormat:@"%1.38f", number]]; 
```

有没有更好的办法？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-04T23:21:17.790

NSNumber 是 NSDecimalNumber 的超类，有一个 +numberWithDouble: 方法。那就是你想要的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-01-22T14:32:09.597

您也可以使用`[[NSDecimalNumber alloc] initWithDouble:(double)]`，只是不那么明显。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-04T23:21:43.093

```
[NSDecimalNumber numberWithDouble:myDouble] 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-08-20T21:15:44.893

我已经找到了让它工作的方法，并且解除警告是这样的。

```
 NSNumber *temp = [NSNumber numberWithDouble:self.hourlyRate];
    myDecimal = [NSDecimalNumber decimalNumberWithDecimal:[temp decimalValue]]; 
```

它摆脱了警告，尽管是两行而不是一行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-01T07:14:32.047

在其他帖子中，我发现使用这些`NSNumber`方法的信息`NSDecimalNumber`将返回`NSNumber`，或者将返回，`NSDecimalNumber`但这不是规范所说的，因此它可能被认为是一个错误并在未来发生变化。呃类似的东西。

# ruby-on-rails - 如何跟踪最受欢迎的产品

> ID：411877
> 
> 赞同：2
> 
> 时间：2009-01-04T23:09:04.320
> 
> 标签：ruby-on-rails

我正在尝试实现“热门产品”功能。基本上，每次查看产品时，我都想将该产品的查看次数记录到数据库中。我在哪里把钩子放在这样的地方？我已经看到了基于构建某种流量分析的东西，但我正在寻找可以使此功能与 RoR 应用程序更加耦合的想法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-04T23:40:58.217

我假设控制器中有一个“视图”方法，做类似的事情

```
@product = Product.find(params[:id]) 
```

如果产品有“视图”字段，您可以执行类似的操作

```
@product.views = @product.views + 1
@product.save 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-05T11:41:43.847

写信给`@product.views`像@eelco.lempsink.nl 这样的柜台说可能是一个完美的基本解决方案，但恕我直言，会有重大的可扩展性问题，例如：

*   在读取时执行数据库写入将是一个非常重要的过载
*   如果它是一个大应用程序，那么视图很可能会被服务器缓存命中

也许一个更具可扩展性（但非常非 RoR）的解决方案是获取服务器日志并运行批处理来运行流行度计算（例如每个 IP 的唯一性等），然后将此信息更新为 RoR 模型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-05T08:28:32.503

建议的像 eelco.lempsink.nl 这样的视图字段应该可以工作。要获得最受欢迎的项目，您可以添加以下内容：

```
:sort => "views DESC", 
```

但请确保仅计算人类对该项目的查看次数。如果每次在流行项目列表中显示该项目时计数都会增加，您将得到一个反馈循环，扰乱流行系统。Allso 确保不允许 webcrawlers 更改视图状态。

所以你真的应该考虑你想要衡量的东西，对产品感兴趣的人数，或者被误导性缩略图和高人气排名所愚弄的点击产品的人数。

如果这是一个网上商店或类似网站，您最好计算买家数量而不是浏览次数。这将更准确地衡量对产品的真正兴趣（因为他们实际上有足够的兴趣来花钱购买），而且我认为*写入*数据库以获得视图听起来有点不明智（视图比购买多得多）。`views`与可能遭受反馈问题的字段相比，您将获得更好的数据，因为您可以通过`order`在特定时间范围内选择带有时间戳的产品的行数来获得流行历史。从上周左右获得订单可能不会那么昂贵（对于很长的时间跨度，结果可能应该被缓存）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T13:29:01.057

我会说在单独的表格中跟踪一些统计数据。例如：

products_views

--

product_id user_id ip_address created_at updated_at

这样，如果两个人同时查看，您就不必担心锁定更新数据库中的视图字段。然后，您可以在后台处理此表以汇总统计信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-06T04:49:25.083

根据您呈现内容的方式，以及您真正想要对视图做什么，您可能希望完全放弃这一点并使用 Google/Microsoft 分析之类的东西。他们在他们的产品上投入了大量时间，让您可以看到随着时间的推移有关您的流量的各种信息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-11-26T16:59:24.220

我喜欢谷歌分析这种东西，然后使用 API 将数据拉到你的应用程序中。

这否定了任何“错误”读取，并且您可以跟踪和记录大量其他信息。

# asp.net - 将字典的字典传递给 javascript (.NET)

> ID：411896
> 
> 赞同：1
> 
> 时间：2009-01-04T23:24:19.670
> 
> 标签：asp.net, javascript, web-services, soap, asp.net-ajax

我正在尝试解决通过 SOAP Web 服务将二维表传递到 JavaScript AJAX 应用程序的问题。我正在尝试通过使用以下属性声明的 ASP.NET Web 服务将数据传递到 JavaScript 网页：

```
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
[System.Web.Script.Services.ScriptService] 
```

我需要将一个复杂类型传递给 JavaScript：

```
[Serializable]
public class PayRateSummary
{
    public string[] EmployeeId;
    public Dictionary<string, string> EmployeeName;
    public string[] PaycodeId;
    public Dictionary<string, Dictionary<string, double?>> EmployeePaycodeRate;
}

[WebMethod(EnableSession = true)]
public DataElements.PayRateSummary EnumPayRates(Guid companyId)
{
} 
```

Web 服务以非常标准的方式声明：

```
 <asp:ScriptManager runat="server" ID="ScriptManager1">
        <Services><asp:ServiceReference Path="~/WebService.asmx" /></Services>
    </asp:ScriptManager> 
```

...函数 RefreshPayRates() { WebService.EnumPayRates(CompanyCurrent, OnPayRatesLoaded, OnFailure); }

出于某种原因，Dictionary[string,string] 可以正常通过，但 Dictionary[string,Dictionary[string,string]] 没有：

-->[http://vvcap.net/db/8rveoL-FMP6EUikCaqiz.htp](http://vvcap.net/db/8rveoL-FMP6EUikCaqiz.htp)

我记得过去我用头撞墙去理解，可以做些什么来通过这些物体，但从未找到任何解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-04T23:42:38.383

你试过用这个：[http ://code.google.com/p/aspjson/](http://code.google.com/p/aspjson/)

我不熟悉 ASP，但在 PHP 中，我使用类似的东西将 PHP 原生对象转换为 JSON 对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T00:19:52.117

基于[sktrdie](https://stackoverflow.com/questions/411896/pass-to-javascript-a-dictionary-of-a-dictionary-net#411924)的回答，您可以使用 ASP.NET AJAX JSON Web 服务将数据作为 JSON 对象传递和返回。这里有些例子-

*   [使用 ASP.NET AJAX 3.5 JSON Web 服务](http://www.ajaxprojects.com/ajax/tutorialdetails.php?itemid=264)
*   [在 ASP.NET AJAX 中使用 JSON 语法](http://quickstarts.asp.net/previews/ajax/jsonsyntax.aspx)
*   [了解 ASP.NET AJAX Web 服务代理](http://weblogs.asp.net/dwahlin/archive/2006/12/28/understanding-asp-net-ajax-web-service-proxies.aspx)

在这个问题中有很多关于 JSON 的好信息——[什么是 JSON，我为什么要使用它？](https://stackoverflow.com/questions/383692/what-is-json-and-why-would-i-use-it)

**编辑 -**

目前，您说您正在使用[SOAP](http://en.wikipedia.org/wiki/Simple_Object_Access_Protocol)，它是一种基于 XML 的传输协议。这里有一篇非常简洁的文章 - [Extending an existing ASP.NET Web Service to support JSON](http://www.codeproject.com/KB/webservices/XML_and_JSON_on_same_We_S.aspx) - 它解释了如何扩展现有的 Web 服务，

此外，如果您无法访问 .NET 3.5 JSON 序列化器/反序列化器，请查看[James Newton King 的 JSON.NET 库](http://james.newtonking.com/projects/json-net.aspx)。

**编辑 2 -**

再次查看您的屏幕截图以及您具有 [ScriptService] 属性的事实，您似乎正在返回一个 JSON 字符串（我理解这是默认值）。因此，我在想是 ASP.NET AJAX JSON 序列化程序未能序列化这一行中的可为空的双精度

```
public Dictionary<string, Dictionary<string, double?>> EmployeePaycodeRate; 
```

到每个实例中正确的 JSON 数据类型？您可以通过将 Web 服务更改为返回双精度来查看是否是这种情况，然后使用具有值的数据进行尝试。

根据[MSDN](http://msdn.microsoft.com/en-us/library/bb412170.aspx) -

> 还支持可空类型并以与不可空类型相同的方式映射到 JSON。

尽管如此，我认为值得以与我建议的方式类似的方式进行研究，因为这是您的问题发生的地方

希望这可以帮助

**编辑 3 -**

为什么带有 Dictionary 值的 Dictionary 无法在 JSON 字符串中表示，这似乎很奇怪。考虑一个字典在 JSON 中看起来像这样

```
[{"Key":"a1","Value":"a1"},
{"Key":"a2","Value":"a2"}] 
```

因此，具有 Dictionary 值的 Dictionary 看起来像这样（我相信）

```
[{"Key":"a1","Value": {"Key":"b1","Value":"b1"} },
{"Key":"a2","Value": {"Key":"b2","Value":"b2"} }] 
```

根据[JSONLint - JSON 验证器，这是有效的 JSON](http://www.jsonlint.com/)。

# python - Django文件上传偶尔失败

> ID：411902
> 
> 赞同：8
> 
> 时间：2009-01-04T23:28:35.480
> 
> 标签：python, django, apache

我正在尝试将我的第一个 Django 1.0.2 应用程序移植到使用 Apache + mod_python 3.3.1 + python 2.6.1（全部以 64 位模式运行）在 OSX/Leopard 上运行，上传文件时偶尔会遇到错误在使用 Django 开发服务器进行测试时不存在。

上传的代码类似于 Django 文档中描述的代码：

```
class UploadFileForm(forms.Form):
    file  = forms.FileField()
    description = forms.CharField(max_length=100)
    notifygroup = forms.BooleanField(label='Notify Group?', required=False)

def upload_file(request, date, meetingid ):
    print date, meetingid
    if request.method == 'POST':
        print 'before reloading the form...'
        form = UploadFileForm(request.POST, request.FILES)
    print 'after reloading the form'
        if form.is_valid():
            try: 
                handle_uploaded_file(request.FILES['file'], request.REQUEST['date'], request.REQUEST['description'], form.cleaned_data['notifygroup'], meetingid )
            except:
                return render_to_response('uploaded.html', { 'message': 'Error! File not uploaded!' })
            return HttpResponseRedirect('/myapp/uploaded/')
    else:
        form = UploadFileForm()
    return render_to_response('upload.html', {'form': form, 'date':date, 'meetingid':meetingid}) 
```

此代码通常可以正常工作，但有时（例如，每 10 次上传一次）并且在相当长的等待时间后，它会失败并出现以下错误：

```
IOError at /myapp/upload/2009-01-03/1
Client read error (Timeout?)
Request Method: POST
Request URL:    http://192.168.0.164/myapp/upload/2009-01-03/1
Exception Type: IOError
Exception Value:    
Client read error (Timeout?)
Exception Location: /Library/Frameworks/Python64.framework/Versions/2.6/lib/python2.6/site-packages/django/http/multipartparser.py in read, line 406
Python Executable:  /usr/sbin/httpd
Python Version: 2.6.1
Python Path:    ['/djangoapps/myapp/', '/djangoapps/', '/Library/Frameworks/Python64.framework/Versions/2.6/lib/python26.zip', '/Library/Frameworks/Python64.framework/Versions/2.6/lib/python2.6', '/Library/Frameworks/Python64.framework/Versions/2.6/lib/python2.6/plat-darwin', '/Library/Frameworks/Python64.framework/Versions/2.6/lib/python2.6/plat-mac', '/Library/Frameworks/Python64.framework/Versions/2.6/lib/python2.6/plat-mac/lib-scriptpackages', '/Library/Frameworks/Python64.framework/Versions/2.6/lib/python2.6/lib-tk', '/Library/Frameworks/Python64.framework/Versions/2.6/lib/python2.6/lib-old', '/Library/Frameworks/Python64.framework/Versions/2.6/lib/python2.6/lib-dynload', '/Library/Frameworks/Python64.framework/Versions/2.6/lib/python2.6/site-packages']
Server time:    Sun, 4 Jan 2009 22:42:04 +0100

Environment:

Request Method: POST
Request URL: http://192.168.0.164/myapp/upload/2009-01-03/1
Django Version: 1.0.2 final
Python Version: 2.6.1
Installed Applications:
['django.contrib.auth',
 'django.contrib.contenttypes',
 'django.contrib.sessions',
 'django.contrib.sites',
 'django.contrib.admin',
 'myapp.application1']
Installed Middleware:
('django.middleware.common.CommonMiddleware',
 'django.contrib.sessions.middleware.SessionMiddleware',
 'django.contrib.auth.middleware.AuthenticationMiddleware')

Traceback:
File "/Library/Frameworks/Python64.framework/Versions/2.6/lib/python2.6/site-packages/django/core/handlers/base.py" in get_response
  86\.                 response = callback(request, *callback_args, **callback_kwargs)
File "/djangoapps/myapp/../myapp/application1/views.py" in upload_file
  137\.         form = UploadFileForm(request.POST, request.FILES)
File "/Library/Frameworks/Python64.framework/Versions/2.6/lib/python2.6/site-packages/django/core/handlers/modpython.py" in _get_post
  113\.             self._load_post_and_files()
File "/Library/Frameworks/Python64.framework/Versions/2.6/lib/python2.6/site-packages/django/core/handlers/modpython.py" in _load_post_and_files
  87\.                 self._post, self._files = self.parse_file_upload(self.META, self._req)
File "/Library/Frameworks/Python64.framework/Versions/2.6/lib/python2.6/site-packages/django/http/__init__.py" in parse_file_upload
  124\.         return parser.parse()
File "/Library/Frameworks/Python64.framework/Versions/2.6/lib/python2.6/site-packages/django/http/multipartparser.py" in parse
  134\.             for item_type, meta_data, field_stream in Parser(stream, self._boundary):
File "/Library/Frameworks/Python64.framework/Versions/2.6/lib/python2.6/site-packages/django/http/multipartparser.py" in __iter__
  607\.         for sub_stream in boundarystream:
File "/Library/Frameworks/Python64.framework/Versions/2.6/lib/python2.6/site-packages/django/http/multipartparser.py" in next
  421\.             return LazyStream(BoundaryIter(self._stream, self._boundary))
File "/Library/Frameworks/Python64.framework/Versions/2.6/lib/python2.6/site-packages/django/http/multipartparser.py" in __init__
  447\.         unused_char = self._stream.read(1)
File "/Library/Frameworks/Python64.framework/Versions/2.6/lib/python2.6/site-packages/django/http/multipartparser.py" in read
  300\.         out = ''.join(parts())
File "/Library/Frameworks/Python64.framework/Versions/2.6/lib/python2.6/site-packages/django/http/multipartparser.py" in parts
  293\.                 chunk = self.next()
File "/Library/Frameworks/Python64.framework/Versions/2.6/lib/python2.6/site-packages/django/http/multipartparser.py" in next
  315\.             output = self._producer.next()
File "/Library/Frameworks/Python64.framework/Versions/2.6/lib/python2.6/site-packages/django/http/multipartparser.py" in next
  376\.             data = self.flo.read(self.chunk_size)
File "/Library/Frameworks/Python64.framework/Versions/2.6/lib/python2.6/site-packages/django/http/multipartparser.py" in read
  406\.         return self._file.read(num_bytes)

Exception Type: IOError at /myapp/upload/2009-01-03/1
Exception Value: Client read error (Timeout?) 
```

我尝试使用 mod_wsgi 运行所有内容，没有区别。

有人知道我在做什么错吗？

在此先感谢您的帮助！

ppdo

=====

更新：

虽然我成功上传了大文件（60+ MB），但当它失败时，它与上传的大小没有明显的关系，即它也失败了之前已经成功上传的 10kB 文件。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-06T11:33:53.580

使用 mod_wsgi 解决了 Firefox 的问题。

将我的研究限制在 Apache 和 Safari 之间的交互问题上，我偶然发现了 Apache [https://bugs.webkit.org/show_bug.cgi?id=5760](https://bugs.webkit.org/show_bug.cgi?id=5760)的这个错误报告，它描述了与正在发生的事情非常相似的事情，而且显然是还开着。阅读这篇文章给了我尝试禁用keepalive的想法，虽然我需要更广泛地测试它，但问题似乎已经消失了。

一个简单的：

BrowserMatch "Safari" nokeepalive

在 Apache 配置中成功了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T13:28:23.443

我会追查异常值

```
Client read error (Timeout?) 
```

这似乎很奇怪。尝试阅读[此线程](http://groups.google.com/group/django-users/browse_thread/thread/03ff1503377a8bfc)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T00:21:48.087

文件有多大？上传脚本超时可能需要足够长的时间，因此请尝试增加该脚本的执行时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-17T20:43:57.123

很长一段时间没有答案，但是我自己经历过这个问题并尝试了一些方法来解决它。在我的情况下，如果有人在上传期间取消下载（或失去连接），就会发生这种情况。

您可以自己尝试一下，看看这是否是导致“IOError：请求数据读取错误”的原因：上传足够大的文件，您可以从计算机或路由器上拔下以太网电缆。稍等一下，看看你是否得到错误。我每次都这样做！

# iphone - 用户点击了哪个文本字段？

> ID：411905
> 
> 赞同：2
> 
> 时间：2009-01-04T23:29:01.360
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch

我的 iphone 应用程序有几个文本字段。每个文本字段上的“退出时结束”事件调用单个操作。如何判断哪个文本字段调用了该操作？我可以从传递给操作的发件人对象中检测到这一点吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-04T23:48:06.783

该`sender`对象将是有问题的 UITextField。如果您有一堆 IBOutlets 连接到您的文本字段，您可以简单地比较 if`sender == aField`以查看它是哪个字段。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-04T23:43:07.993

当然，只需在每个文本字段上设置一个标签（NSInteger），然后在发件人对象上检查它们。

在 UIView 的 tag 属性的文档下查找更多详细信息。

# c# - C# (.NET) 设计缺陷

> ID：411906
> 
> 赞同：86
> 
> 时间：2009-01-04T23:29:25.633
> 
> 标签：c#, .net

C# 或 .NET 框架中最大的设计缺陷是什么？

示例：没有不可为空的字符串类型，从 IDataReader 获取值时必须检查 DBNull。

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2009-01-04T23:39:59.263

*   `Reset()`on 方法是`IEnumerator<T>`一个错误（对于迭代器块，语言规范甚至*要求*这会引发异常）
*   在 Eric 看来，返回数组的反射方法是[一个错误](http://blogs.msdn.com/ericlippert/archive/2008/09/22/arrays-considered-somewhat-harmful.aspx)
*   数组协方差过去和现在都是一个奇怪的东西
    *   更新：带有 .NET 4.0 的 C# 4.0 为泛型接口添加了协变/逆变支持（如`IEnumerable<out T>`和`Func<in T, out TResult>`，但不是具体类型（如`List<T>`）。
*   `ApplicationException`而是失宠——这是一个错误吗？
*   同步集合 - 一个好主意，但在现实中不一定有用：您通常需要同步*多个*操作 ( `Contains`, then `Add`)，因此同步不同操作的集合并不是那么有用
    *   更新： .NET Framework 4.0 中添加了、、 、 等[类型- 尽管接受工厂委托](https://docs.microsoft.com/en-us/dotnet/api/system.collections.concurrent?view=netframework-4.8)[的`System.Collections.Concurrent`](https://docs.microsoft.com/en-us/dotnet/api/system.collections.concurrent?view=netframework-4.8)方法不保证每个键只会调用一次工厂。`TryAdd``GetOrAdd``TryRemove`
*   `using`/模式可以更多地使用`lock`——也许允许它们共享可重用（可扩展？）语法；`IDisposable`您可以通过返回和使用来模拟这一点`using`，但它可能更清楚
*   迭代器块：没有简单的提前检查参数的方法（而不是懒惰地）。当然，您可以编写两个链式方法，但这很难看
*   更简单的不变性会很好；C# 4.0[有点](http://marcgravell.blogspot.com/2008/11/immutability-and-optional-parameters.html)帮助，但还不够
*   没有“这个 ref-type 参数不能为空”的支持——尽管合约（在 4.0 中）对此有所帮助。`Foo(SqlConnection! connection)`但是像（注入空检查 / ）这样的语法`throw`会很好（与`int?`等相反）
    *   更新：[这已在 C# 8.0 中修复](https://docs.microsoft.com/en-us/dotnet/csharp/nullable-references)。
*   缺乏对具有泛型的运算符和非默认构造函数的支持；C# 4.0 用 解决了这个问题`dynamic`，或者你可以[像这样启用它](http://www.pobox.com/~skeet/csharp/miscutil/usage/genericoperators.html)
*   迭代器变量在扩展中的 while*之外*`foreach`声明，这意味着 anon-methods/lambdas 捕获单个变量，而不是每次迭代一个变量（线程/异步/等很痛苦）
    *   更新：[这已在 C# 5.0 中修复](https://stackoverflow.com/questions/12112881/has-foreachs-use-of-variables-been-changed-in-c-sharp-5)。

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2009-01-05T13:32:11.410

TextWriter 是 StreamWriter 的*基*类。什么？

这总是把我弄糊涂到极点。

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2009-01-05T00:40:50.343

一个小小的 C# 宠物 - 构造函数使用 C++/Java 语法，使构造函数与类同名。

`New()`或者`ctor()`会更好。

当然，诸如 coderush 之类的工具使重命名类的问题变得不那么重要，但是从可读性 POV 来看，New() 提供了极大的清晰度。

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2009-07-25T06:21:31.857

我非常同意[这篇文章](https://stackoverflow.com/questions/411906/c-net-design-flaws/413093#413093)（对于那些对缺少 ToString 感到厌烦的人，有一个调试器属性可以为您的类提供自定义格式）。

在上面的列表之上，我还要添加以下合理的要求：

1.  不可为空的引用类型作为可空值类型的补充，
2.  允许覆盖结构的空构造函数，
3.  允许泛型类型约束指定密封类，
4.  我同意这里的另一张海报，它在用作约束时要求任意构造函数签名，即。哪里`T : new(string)`_`T : new(string, int)`
5.  我也同意这里关于修复事件的另一张海报，无论是针对空事件列表还是在并发设置中（尽管后者很棘手），
6.  运算符应定义为扩展方法，而不是类的静态方法（或至少不只是静态方法），
7.  允许接口的静态属性和方法（Java 有这个，但 C# 没有），
8.  允许在对象初始化器中初始化事件（目前只允许字段和属性），
9.  为什么“对象初始化器”语法仅在创建对象时可用？为什么不随时提供它，即。`var e = new Foo(); e { Bar = baz };`
10.  [修复二次可枚举行为](https://github.com/dotnet/csharplang/issues/378)，
11.  所有集合都应该有不可变的迭代快照（即，改变集合不应该使迭代器失效），
12.  元组很容易添加，但像 " `Either<T>`" 这样的有效封闭代数类型不是，所以我喜欢某种方式来声明一个封闭代数类型并对其强制执行详尽的模式匹配（基本上是对访问者模式的一流支持，但是效率更高）；所以只需要枚举，用详尽的模式匹配支持来扩展它们，并且不允许无效的情况，
13.  一般来说，我喜欢支持模式匹配，但至少支持对象类型测试；我也有点喜欢这里另一篇文章中提出的开关语法，
14.  我同意另一篇文章，即`System.IO`类，如`Stream`，设计得有些糟糕；任何需要一些实现来抛出的接口`NotSupportedException`都是一个糟糕的设计，
15.  `IList`应该比现在简单得多；事实上，对于许多具体的集合接口来说，这可能是正确的，例如`ICollection`，
16.  太多的方法抛出异常，例如 IDictionary，
17.  我更喜欢一种比 Java 更好的检查异常形式（请参阅关于类型和效果系统的研究以了解如何做到这一点），
18.  在泛型方法重载解决方案中修复各种烦人的极端情况；例如，尝试提供两种重载扩展方法，一种对引用类型进行操作，另一种对可空结构类型进行操作，看看您的类型推断是否喜欢这样，
19.  提供一种方法来安全地反映接口的字段和成员名称，例如`INotifyPropertyChanged`将字段名称作为字符串的接口；您可以通过使用带有 lambda 的扩展方法来做到这一点`MemberExpression`，即。`() => Foo`，但这不是很有效，
    *   更新：C# 6.0`nameof()`为单个成员名称添加了运算符，但它在泛型中不起作用（`nameof(T) == "T"`而不是实际类型参数的名称：您仍然需要这样做`typeof(T).Name`）） - 它也不允许您获得“路径”字符串，例如`nameof(this.ComplexProperty.Value) == "Value"`限制其可能的应用。
20.  允许接口中的运算符，并使所有核心数字类型都实现`IArithmetic`；其他有用的共享操作员界面也是可能的，
21.  使改变对象字段/属性变得更加困难，或者至少允许注释不可变字段并让类型检查器强制执行它（只需将其视为 getter-only 属性 fer chrissakes，这并不难！）；事实上，以更明智的方式统一字段和属性，因为两者兼而有之是没有意义的；C# 3.0 的自动属性是朝这个方向迈出的第一步，但还远远不够，
    *   更新：虽然 C# 有`readonly`关键字，并且 C# 6.0 添加了只读自动属性，但它不像真正的语言支持不可变类型和值那样严格。
22.  简化声明构造函数；我喜欢 F# 的方法，但这里的另一篇文章只需要“new”而不是类名至少更好，

我想这已经足够了。这些都是我在过去一周遇到的所有烦恼。如果我真的全神贯注，我可能会持续几个小时。C# 4.0 已经添加了命名的、可选的和默认的参数，我非常赞成。

现在提出一个不合理的要求：

1.  **如果 C#/CLR 可以支持类型构造函数多态性，**那就太好了，即。泛型优于泛型，

请问好看吗？:-)

* * *

## 回答 #5

> 赞同：29
> 
> 时间：2009-01-05T00:14:41.660

我不明白你做不到

其中T：新（U）

因此，您声明泛型类型 T 具有非默认构造函数。

**编辑：**

我想做这个：

```
public class A 
{
    public A(string text) 
    {

    }
}

public class Gen<T> where T : new(string text) 
{

} 
```

* * *

## 回答 #6

> 赞同：20
> 
> 时间：2009-01-05T00:28:56.730

1.  我不是 Stream、StringWriter、StringReader、TextReader、TextWriter 类的忠实粉丝……只是不直观的是什么是什么。
2.  IEnumerable.Reset 为迭代器抛出异常。我有一些第三方组件在数据绑定时总是调用重置，需要我先转换到列表才能使用这些组件。
3.  Xml Serializer 应该有序列化的 IDictionary 元素
4.  我完全忘记了 HttpWebRequest 和 FTP API，这让我很痛苦....（感谢 Nicholas 的评论让我想起了这一点：-）

编辑
5\. 我的另一个烦恼是 System.Reflection.BindingFlags 如何根据您使用的方法有不同的用途。例如在 FindFields 中 CreateInstance 或 SetField 是什么意思？在这种情况下，他们重载了令人困惑的枚举背后的含义。

* * *

## 回答 #7

> 赞同：20
> 
> 时间：2009-01-05T07:55:55.660

我真的很惊讶我是第一个提到这个的人：

ADO.NET 类型化数据集不会将可空列公开为可空类型的属性。你应该可以这样写：

```
int? i = myRec.Field;
myRec.Field = null; 
```

相反，你必须写这个，这很愚蠢：

```
int? i = (int?)myRec.IsFieldNull() ? (int?)null : myRec.Field;
myRec.SetFieldNull(); 
```

这在 .NET 2.0 中很烦人，现在更烦人的是，您必须在漂亮整洁的 LINQ 查询中使用像上面这样的 jiggery-pokery。

同样令人讨厌的是，生成的`Add<TableName>Row`方法对可空类型的概念同样不敏感。更是如此，因为生成的`TableAdapter`方法不是。

.NET 中没有太多让我觉得开发团队说“好吧，伙计们，我们已经足够接近了——发布吧！” 但这肯定会。

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2009-01-05T00:00:16.197

我不知道我会说这是一个设计缺陷，但如果你能像在 VB 中一样推断出 lambda 表达式，那就太好了：

VB：

```
Dim a = Function(x) x * (x - 1) 
```

C＃

如果可以这样做就好了：

```
var a = x => x * (x - 1); 
```

而不必这样做：

```
Func<int, int> a = x => x * (x - 1); 
```

我意识到它不会再长了，但在 Code Golf 中，每个角色都算得上该死！他们在设计这些编程语言时没有考虑到这一点吗？:)

* * *

## 回答 #9

> 赞同：14
> 
> 时间：2009-01-05T13:29:44.877

1.  [System.Object](http://msdn.microsoft.com/en-us/library/system.object.aspx)类：

    *   Equals 和 GetHashCode - 并非所有类都是可比较的或可散列的，应将其移至接口。我想到了 IEquatable 或 IComparable（或类似的）。

    *   ToString - 并非所有类都可以转换为字符串，应将其移至接口。我想到了 IFormattable （或类似的）。

2.  [ICollection.SyncRoot](http://msdn.microsoft.com/en-us/library/system.collections.icollection.syncroot.aspx)属性：

    *   提倡糟糕的设计，外部锁几乎总是更有用。
3.  泛型应该从一开始就存在：

    *   [System.Collections](http://msdn.microsoft.com/en-us/library/system.collections.aspx)命名空间包含许多或多或少过时的类和接口。

* * *

## 回答 #10

> 赞同：12
> 
> 时间：2009-01-05T23:00:04.570

令我恼火的一件事是`Predicate<T> != Func<T, bool>`悖论。它们都是类型的代表，`T -> bool`但它们不兼容分配。

* * *

## 回答 #11

> 赞同：11
> 
> 时间：2009-01-04T23:34:08.900

有些人（ISV）希望您可以在构建时将其编译为机器代码，并将其链接起来，以便创建不需要 dotNet 运行时的本机可执行文件。

* * *

## 回答 #12

> 赞同：11
> 
> 时间：2009-01-05T02:59:07.333

我们非常了解**正确**的OO 技术。解耦、契约式编程、避免不当继承、适当使用异常、开/关主体、Liskov 可替换性等。无论如何，.Net 框架都没有采用最佳实践。

对我来说，.Net 设计的最大缺陷不是站在巨人的肩膀上；而是站在巨人的肩膀上。**向使用其框架的广大程序员推广不太理想的编程范式**。

如果 MS 重视这一点，软件工程世界在这十年中本可以在质量、稳定性和可扩展性方面取得巨大飞跃，但可惜，它似乎正在倒退。

* * *

## 回答 #13

> 赞同：11
> 
> 时间：2009-01-24T12:52:15.907

我不喜欢 C# switch 语句。

我想要这样的东西

```
switch (a) {
  1    : do_something;
  2    : do_something_else;
  3,4  : do_something_different;
  else : do_something_weird; 
} 
```

所以没有更多的中断（容易忘记）和用逗号分隔不同值的可能性。

* * *

## 回答 #14

> 赞同：10
> 
> 时间：2009-02-03T19:46:12.633

C# 中的事件，您必须在其中显式检查侦听器。这难道不是事件的重点，向碰巧在那里的任何人广播吗？即使没有？

* * *

## 回答 #15

> 赞同：9
> 
> 时间：2009-02-21T16:18:28.510

[嵌套/递归迭代器](http://blogs.msdn.com/wesdyer/archive/2007/03/23/all-about-iterators.aspx)的可怕（并且对大多数人来说完全不可见）O(N^2) 行为。

我很沮丧，他们知道它，知道[如何解决它，](http://citeseer.ist.psu.edu/cache/papers/cs2/355/http:zSzzSzwww.cs.kuleuven.ac.bezSz~frankzSzPAPERSzSzFTfJP2005.pdf/iterators-revisited-proof-rules.pdf)但它没有被视为具有足够的优先级来值得包含。

我一直在使用类似树的结构，并且当聪明人以这种方式无意中引入非常昂贵的操作时，我不得不纠正他们的代码。

“yield foreach”的美妙之处在于，更简单、更容易的语法鼓励正确、高性能的代码。这是我认为他们在为平台的长期成功添加新功能之前应该追求的[“成功坑” 。](http://blogs.msdn.com/brada/archive/2003/10/02/50420.aspx)

* * *

## 回答 #16

> 赞同：7
> 
> 时间：2009-01-05T01:08:20.460

一些类实现了接口，但它们没有实现该接口的许多方法，例如 Array 实现 IList 但 9 个方法中有 4 个抛出 NotSupportedException [http://msdn.microsoft.com/en-us/library/system.array_members .aspx](http://msdn.microsoft.com/en-us/library/system.array_members.aspx)

* * *

## 回答 #17

> 赞同：7
> 
> 时间：2009-01-05T01:22:38.980

**接口中的静态成员和嵌套类型。**

这在接口成员具有特定于接口的类型（*例如*an `enum`）的参数时特别有用。将枚举类型嵌套在接口类型中会很好。

* * *

## 回答 #18

> 赞同：6
> 
> 时间：2009-06-30T02:38:43.917

事件的极其危险的默认性质。由于订阅者被删除，您可以调用事件并处于不一致的状态，这真是太可怕了。有关该主题的更多信息，请参阅[Jon Skeet](http://www.yoda.arachsys.com/csharp/events.html)和[Eric Lippert 的](http://blogs.msdn.com/ericlippert/archive/2009/04/29/events-and-races.aspx)优秀文章。

* * *

## 回答 #19

> 赞同：6
> 
> 时间：2010-02-14T19:19:13.993

*   `null`到处。

*   `const`无处。

*   API 是不一致的，例如改变一个数组返回`void`但附加到一个`StringBuffer`返回相同的 mutable `StringBuffer`。

*   集合接口与不可变数据结构不兼容，例如`Add`in`System.Collections.Generic.IList<_>`不能返回结果。

*   没有结构类型，所以你写`System.Windows.Media.Effects.SamplingMode.Bilinear`的不仅仅是`Bilinear`.

*   `IEnumerator`当类应该是不可变的时，由类实现的可变接口`struct`。

*   平等和比较是一团糟：你有`System.IComparable`，但`Equals`你也有，，，，，，和。`System.IComparable<_>``System.IEquatable``System.Collections.IComparer``System.Collections.IStructuralComparable``System.Collections.IStructuralEquatable``System.Collections.Generic.IComparer``System.Collections.Generic.IEqualityComparer`

*   元组应该是结构，但结构不必要地抑制尾调用消除，因此最常见和基本的数据类型之一将不必要地分配并破坏可扩展的并行性。

* * *

## 回答 #20

> 赞同：5
> 
> 时间：2009-01-05T06:31:37.107

**0 兼职作为枚举**

枚举的特点：http: [//blogs.msdn.com/abhinaba/archive/2007/01/09/more-peculiarites-of-enum.aspx](http://blogs.msdn.com/abhinaba/archive/2007/01/09/more-peculiarites-of-enum.aspx)

正如这个很好的例子所示：http: [//plus.kaist.ac.kr/~shoh/postgresql/Npgsql/apidocs/Npgsql.NpgsqlParameterCollection.Add_overload_3.html](http://plus.kaist.ac.kr/~shoh/postgresql/Npgsql/apidocs/Npgsql.NpgsqlParameterCollection.Add_overload_3.html)

我的建议，好好利用“@”符号：

代替：

if ((myVar & MyEnumName.ColorRed) != 0)

用这个：

if ((myVar & MyEnumName.ColorRed) != @0)

* * *

## 回答 #21

> 赞同：5
> 
> 时间：2009-01-09T14:02:06.673

添加到其他人已经提出的长长的优点列表中：

*   `DateTime.Now == DateTime.Now`在大多数情况下，但不是所有情况。

*   `String`不可变的有很多构造和操作选项，但是`StringBuilder`（可变的）没有。

*   `Monitor.Enter`并且`Monitor.Exit`应该是实例方法，因此您可以 new a`Monitor`并锁定它，而不是新的特定对象进行锁定。

*   析构函数不应该被命名为析构函数。ECMA 规范称它们为终结器，这对 C++ 人群来说不那么容易混淆，但语言规范仍然将它们称为析构函数。

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2009-01-05T05:33:44.010

我们使用属性的方式有时会激怒我。我喜欢将它们视为 Java 的 getFoo() 和 setFoo() 方法的等价物。但他们不是。

如果[属性使用指南](http://msdn.microsoft.com/en-us/library/bzwdh01d(VS.71).aspx)声明属性应该能够以任何顺序设置以便序列化可以工作，那么它们对于 setter-time 验证是无用的。如果您的背景是您希望防止对象允许自己进入无效状态，那么属性不是您的解决方案。有时我看不到他们比公共成员更好，因为我们在*应该*在房产中做的事情方面非常有限。

为此，我一直希望（这主要是在这里大声思考，我只是希望我能做这样的事情）我可以以某种方式扩展属性语法。想象一下这样的事情：

```
 private string password;

public string Password
{
    // Called when being set by a deserializer or a persistence
    // framework
    deserialize
    {
       // I could put some backward-compat hacks in here. Like
       // weak passwords are grandfathered in without blowing up
       this.password = value;
    }
    get
    {
       if (Thread.CurrentPrincipal.IsInRole("Administrator"))
       {
           return this.password;
       }
       else
       {
           throw new PermissionException();
       }
    }
    set
    {
       if (MeetsPasswordRequirements(value))
       {
           throw new BlahException();
       }
       this.password = value;
    }
    serialize
    {
        return this.password;
    }
} 

```

我不确定这是否有用或访问这些会是什么样子。但我只是希望我可以对属性做更多的事情，并真正像 get 和 set 方法一样对待它们。

* * *

## 回答 #23

> 赞同：4
> 
> 时间：2009-01-05T10:01:23.020

扩展方法很好，但它们是解决问题的丑陋方法，这些问题本来可以用真正的 mixins 更干净地解决（看看 ruby​​ 看看我在说什么），关于 mixins 的主题。将它们添加到语言中的一个非常好的方法是允许将泛型用于继承。这允许您以一种很好的面向对象的方式扩展现有类：

```
public class MyMixin<T> : T
{
    // etc...
} 
```

这可以像这样用于扩展字符串，例如：

```
var newMixin = new MyMixin<string>(); 
```

它比扩展方法强大得多，因为它允许您覆盖方法，例如将它们包装起来，从而允许在语言中使用类似 AOP 的功能。

对不起，咆哮:-)

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2009-01-04T23:45:58.237

框架 V1 中 SqlCommand 上的 .Parameters.Add() 方法设计得很糟糕——如果你传入一个值 (int) 为 0 的参数，其中一个重载基本上不起作用——这导致他们创建SqlCommand 类的 .Parameters.AddWithValue() 方法。

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2009-01-04T23:48:55.017

*   能够在空变量上调用扩展方法是有争议的，例如

    对象 a=null; a.MyExtMethod(); // 这是可调用的，假设它在某处定义了 MyExtMethod

    它可能很方便，但在空引用异常主题上是模棱两可的。

*   一个命名“缺陷”。System.configuration.dll 中“配置”的“C”应大写。

*   异常处理。应该像在 Java 中一样强制捕获或抛出异常，编译器应该在编译时检查它。用户不应依赖注释来获取目标调用中的异常信息。

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2009-01-05T03:52:37.053

Microsoft 不会修复框架中的明显错误，也不会提供挂钩以便最终用户可以修复它们。

此外，没有办法在运行时对 .NET 可执行文件进行二进制修补，也无法在不对本机库进行二进制修补的情况下指定 .NET 框架库的私有版本（以拦截加载调用），并且 ILDASM 不可再分发，因此我无法自动化反正补丁。

* * *

## 回答 #27

> 赞同：3
> 
> 时间：2012-02-24T23:58:04.787

1.  `ICollection<T>`和没有子集`IList<T>`；至少，协变只读集合接口`IListSource<out T>`（带有枚举器、索引器和计数）会非常有用。
2.  .NET 不支持[弱委托](http://www.codeproject.com/Articles/29922/Weak-Events-in-C)。变通方法充其量是笨拙的，并且在部分信任的情况下，侦听器端的变通方法是不可能的（需要ReflectionPermission）。
3.  [通用接口统一是被禁止的](http://higherlogics.blogspot.com/2011/11/type-unification-forbidden-more-cclr.html)，即使它是有意义的并且不会引起任何问题。
4.  与 C++ 不同，.NET 中不允许[协变返回类型](http://loyc-etc.blogspot.com/2008/09/simulating-covariant-return-types-in-c.html)
5.  不可能按位比较两个值类型是否相等。在一个功能性的“[持久](http://en.wikipedia.org/wiki/Persistent_data_structure)”数据结构中，我正在编写一个`Transform(Sequence<T>, Func<T,T>)`函数，该函数需要快速确定该函数是返回相同的值还是返回不同的值。如果函数不修改大部分/所有参数，则输出序列可以共享输入序列的部分/全部内存。如果没有按位比较任何值类型 T 的能力，则必须使用慢得多的比较，这极大地损害了性能。
6.  .NET 似乎无法以高性能方式支持 ad-hoc 接口（如 Go 或 Rust 中提供的接口）。即使该类没有显式实现该接口，此类接口也允许您转换`List<T>`为假设的（其中 T:U）。`IListSource<U>`至少有[三个](http://www.codeproject.com/Articles/35900/C-Object-to-Interface-Caster-Utility) [不同的](http://www.codeproject.com/Articles/122827/DynamicObjects-Duck-Typing-in-NET) [库](http://www.codeproject.com/Articles/87991/Dynamic-interfaces-in-any-NET-language)（独立编写）来提供此功能（当然存在性能缺陷——如果可以找到完美的解决方法，称其为 .NET 中的缺陷是不公平的）。
7.  其他性能问题：IEnumerator 每次迭代需要两个接口调用。普通方法指针（IntPtr 大小的开放委托）或值类型委托（IntPtr*2）是不可能的。固定大小的数组（任意类型的 T）不能嵌入到类中。没有`WeakReference<T>`（您可以轻松编写自己的，但它会在内部使用强制转换。）
8.  `Predicate<T>`在某些情况下（例如vs ） ，相同的委托类型被认为是不兼容的（没有隐式转换）这一事实对我来说很麻烦`Func<T,bool>`。我经常希望我们可以为接口和委托进行[结构类型化](http://en.wikipedia.org/wiki/Structural_type_system)，以实现组件之间更松散的耦合，因为在 .NET 中，独立 DLL 中的类实现相同的接口是不够的——它们还必须共享对第三个的公共引用定义接口的 DLL。
9.  `DBNull.Value`存在，即使`null`同样可以很好地达到相同的目的。
10.  C# 没有 ??= 运算符；你必须写`variable = variable ?? value`。事实上，C# 中有一些地方不必要地缺乏对称性。例如你可以写`if (x) y(); else z();`（不带大括号），但你不能写`try y(); finally z();`.
11.  When creating a thread, it is impossible to cause the child thread to inherit thread-local values from the parent thread. Not only does the BCL not support this, but you can't implement it yourself unless you create all threads manually; even if there were a thread-creation event, .NET [can't tell you the "parents" or "children"](https://stackoverflow.com/questions/4214492/net-is-there-a-way-to-get-the-parent-thread-id) of a given thread.
12.  The fact that there are two different length attributes for different data types, "Length" and "Count", is a minor nuisance.
13.  I could go on and on forever about [the poor design of WPF](http://loyc-etc.blogspot.com/2011/07/why-wpf-sucks.html)... and WCF (though quite useful for some scenarios) is also full of warts. In general, the bloatedness, unintuitiveness, and limited documentation of many of the BCL's newer sublibraries makes me reluctant to use them. A lot of the new stuff could have been far simpler, smaller, easier to use and understand, more loosely coupled, better-documented, applicable to more use cases, faster, and/or more strongly typed.
14.  I'm often been bitten by the needless coupling between property getters and setters: In a derived class or derived interface, you can't simply add a setter when the base class or base interface only has a getter; if you override a getter then you are not allowed to define a setter; and you can't define the setter as virtual but the getter as non-virtual.

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2009-01-09T13:34:10.477

在 1.x 中让我印象深刻的一件事是，在使用 时`System.Xml.XmlValidatingReader`，`ValidationEventHandler`'s`ValidationEventArgs`不会暴露底层`XmlSchemaException`（标记为内部），它包含所有有用的信息，如`linenumber`and `position`。相反，您应该从 Message 字符串属性中解析它或使用反射来挖掘它。当您想向最终用户返回更经过清理的错误时，效果就不太好了。

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2009-03-27T07:21:26.100

不喜欢你不能在另一个枚举中使用一个枚举的值，例如：

```
 enum Colors { white, blue, green, red, black, yellow }

    enum SpecialColors { Colors.blue, Colors.red, Colors.Yellow } 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2009-01-04T23:50:08.883

隐式类型变量在 IMO 中的实施很差。我知道你真的应该只在使用 Linq 表达式时使用它们，但是你不能在本地范围之外声明它们很烦人。

来自 MSDN：

*   var 只能在同一语句中声明和初始化局部变量时使用；变量不能初始化为 null，也不能初始化为方法组或匿名函数。
*   *var 不能用于类范围内的字段。*
*   使用 var 声明的变量不能在初始化表达式中使用。换句话说，这个表达式是合法的： int i = (i = 20); 但是这个表达式会产生编译时错误： var i = (i = 20);
*   不能在同一语句中初始化多个隐式类型变量。
*   如果名为 var 的类型在范围内，则 var 关键字将解析为该类型名称，并且不会被视为隐式类型局部变量声明的一部分。

我认为这是一个糟糕的实现的原因是他们称它为 var，但它距离变体还有很长的路要走。它实际上只是不必输入完整类名的简写语法（与 Linq 一起使用时除外）

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2012-01-31T22:07:07.713

StreamWriter 和 StreamReader 类（和子类）在 Close() 和 Dispose() 上关闭底层流。无法计算我围绕这个设计选择工作了多少次。

* * *

## 回答 #32

> 赞同：-1
> 
> 时间：2009-01-05T04:24:47.147

老实说，在我多年的 .NET (C#) 编程中，我记忆中的框架设计没有缺陷。这意味着就我而言，可能没有值得记住的缺陷。

然而，几年前微软发布 XNA 时，我不喜欢一些东西，他们完全删除了他们的 MDX 2.0 版本，这使我的游戏无法播放并且不容易转换。这是一个更广泛的缺陷，与 .NET 框架无关。

.NET 框架实际上遵循由许多高端语言体系结构开发的许多非常好的设计准则。所以我不得不说我对.NET 很满意。

但是要告诉你一些可能更好的事情，我不得不抱怨通用系统，我找不到接口的泛型，例如“where T is MyObj”（这不是完全正确的语法。但是，这部分本来可以做得更好，更清晰。

想象一下有一个接口，它有 2 个不同的类共享，如果你想在那个接口中有一个通用方法，你需要检查一些讨厌的 Generics-sytanx。可能只是我想做一些奇怪的事情。不过对我来说唯一值得纪念的事情。

* * *

## 回答 #33

> 赞同：-1
> 
> 时间：2009-01-09T13:38:21.963

CLR（因此 C#）不支持多重继承，并且 ASP.NET 充满了 LSP 中断......

这些是我的“最爱”...

我可能会发现更多的错误，但那些是我最不喜欢的......！:(

# silverlight - Silverlight XML 编辑器/语法高亮

> ID：411913
> 
> 赞同：8
> 
> 时间：2009-01-04T23:33:37.483
> 
> 标签：silverlight, editor, controls, syntax-highlighting

我正在寻找提供**XML 语法高亮的****Silverlight 文本编辑器控件**。*我在Winforms*或*WPF*中找到了一些答案，例如[在 Stackoverflow 上](https://stackoverflow.com/questions/394751/anyone-know-a-code-editor-i-can-embed-in-a-wpf-window-or-windows-forms)，但我没有设法将它们转换为 Silverlight。Silverlight 缺少 System.Drawing 的事实可能是一个大问题。

 ****我为 Silverlight 找到的唯一文本编辑器是[Codeplex 上的 RichTextEdit](http://www.codeplex.com/richtextedit)，但我认为它不是实时语法高亮显示的合适基础。

有没有人听说过这样的控件，或者可以提供有关如何构建的提示？非常感谢，

罗曼

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-05T04:51:38.477

我终于找到了我正在寻找的控制！ [SL2TextBoxWsSynParser](http://www.codeproject.com/KB/silverlight/SL2TextBoxWsSynParser.aspx)

编辑：此控件似乎不再更新，但出现了一个新的语法高亮控件：

它可[在此处](http://www.vladhorby.com/Blog/post/2010/05/05/Syntax-Highlighting-TextBox-in-Silverlight-using-MVVM.aspx)获得，并在[CoderProof](http://www.coderproof.com)网站上使用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-07-17T19:33:41.600

Actipro Software 有一个用于 Winforms、WPF 和 Silverlight 的语法高亮组件：

[http://www.actiprosoftware.com/](http://www.actiprosoftware.com/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T05:37:22.787

我认为这是一个有趣的问题，但你没有答案。

我不知道现有的控件。

我已经构建了一个控件来编辑 XHTML，但它也使用 System.Drawing 而不是 WPF（因此不适用于 Silverlight）。

WPF 可能至少与 System.Drawing 一样强大，但我不知道。

关于我如何构建它的提示：

*   定义一个 DOM（一个普通的 System.Xml.XmlDocument 可能适合你）
*   解析文档以实例化 DOM
*   定义用户控件（带有滚动条）
*   将 DOM 实例传递给用户控件
*   在控件的 'paint' 方法中，绘制 DOM 的可见部分
*   实现对鼠标和按键的支持

如果您真的想要有关如何构建一个的提示，请询问更具体的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T00:15:46.060

您好，感谢您的回答！

不幸的是，虽然 WPF 具有绘图功能，但 Silverlight 运行一组非常有限的 CLR。绘制用户控件看起来是一项相当艰巨的任务。

然而，它之前已经用这个[Silverlight 富文本编辑器](http://www.codeplex.com/richtextedit)完成了。我将看看我是否设法使用类似的技术来呈现 XML 文档。

但是有一个问题：当用户进行更改时，用户控件是否足够快以动态渲染 DOM？

# iis - IIS 应用程序池错误 (1013 - W3SVC)

> ID：411918
> 
> 赞同：2
> 
> 时间：2009-01-04T23:38:57.207
> 
> 标签：iis, coldfusion, iis-6

我们在 IIS 安装中的应用程序事件查看器中收到了许多警告。我们设置了一个 AppPool，其中包含两个网站（都是 ColdFusion 网站，而不是 .NET）。

事件查看器显示以下警告：

```
A process serving application pool 'HighPriorityApps' exceeded time limits 
during shut down. The process id was '175540'. 
```

有什么想法可以解决这个问题或从哪里开始寻找解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-05T14:31:04.393

我们仅使用 config 解决了类似的问题。

William R Stanek 的 Microsoft IIS 6.0 Administrator's Pocket Cunsultant 是一本可以提供帮助的好书。

我会尽力在这里提供帮助。我以前见过这个。

在我的公司，我们总是将单独的站点拆分为单独的应用程序池，并在其上运行 ColdFusion

对于每个池，我们设置了以下设置。

右键单击应用程序池中的池回收工作进程（以分钟为单位）1740，其他一切都清除

我们还确保最大工作进程数为 4。

我们在空闲 20 分钟后关闭工作进程，将内核请求队列限制为 1000

我们每 30 秒 ping 一次工作进程

每月在 4 台服务器上提供数千万的页面浏览量。

您还应该检查网站属性框/主目录/配置中的 IIS“应用程序配置”中是否将 .cfm 的扩展设置为 JRUN/CF dll 以及通配符应用程序映射。

我们删除了通配符应用程序映射，因为我们发现 jrun 正在对图像进行轮询，只是说它不会处理它们。

同样在网站属性中检查 ISAPI 过滤器，如果您不使用 .NET，请确保它没有在此处作为过滤器运行，因为它可能只是导致事情爆炸的过滤器。

您是否检查过 ColdFusion 中的平均队列长度和排队时间。试试 Fusion Reactor 在这里找到问题。可能是您的网站太忙了，我对此表示怀疑，因为 CF 会在 IIS 之前爆炸。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T00:16:06.710

每个应用程序池都为工作进程设置了回收时间。此消息基本上意味着工作进程无法正常回收，它必须由 IIS 强制执行。

以下来自 Microsoft 支持的文章解释了如何调试此类问题[http://support.microsoft.com/kb/919792](http://support.microsoft.com/kb/919792)。

如果这无助于找到原因，那么我将尝试确定两个站点中的哪个站点导致了问题。那么您正在寻找的问题可能是所有工作进程都在使用中，等待来自不同工作进程的反应，因为所有工作进程都已经在使用中，所以这种反应永远不会出现。或者某些资源文件、数据库连接、文件句柄等......永远不会被释放，这意味着工作进程无法（优雅地）回收。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-12T19:27:53.410

检查您的 Web 服务器，以防安装了 .net framework 2.0 (MS07-040) 的安全更新。这有已知问题。您可以搜索 MS07-040 的 Microsoft 安全公告，这对我造成了类似的问题。需要升级到 .Net framework 2.0 SP1，问题就消失了。

# c - C（Unix）中基于文件的配置处理

> ID：411921
> 
> 赞同：26
> 
> 时间：2009-01-04T23:41:36.717
> 
> 标签：c, parsing, unix, configuration

这可能是编程时最常见的任务/问题之一；您需要将应用程序的配置存储在某处。

当我尝试创建网络服务器或其他应用程序时，我希望尽可能保持代码简洁，因为我对编程的主要兴趣是架构。这导致我想将配置存储在一个文件中，该文件可以更改而无需重新编译软件。

我不是来重新发明轮子或类似的东西，所以我想做的是在 *nix 上用 C 语言创建一个配置阅读器。该配置可能看起来很像任何其他软件的配置；Apache、vsftpd、MySQL 等

基本问题是：如何从文本文件中读取并有效地处理每一行（在纯 C 中）？我需要使用`fgetc()`和处理每个字符吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-05T02:40:24.673

嗯，有[LibConfig](http://www.hyperrealm.com/libconfig/)。

我在[Wiki上找到了](http://en.wikipedia.org/wiki/Configuration_file)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-05T02:28:54.167

很多人都给出了相当好的建议——Pure-FTP 的例子很有趣。

您还应该阅读ES Raymond 的[TAOUP](http://catb.org/esr/writings/taoup/)（Unix 编程艺术）。它有大量配置文件的示例。它还概述了配置文件的规范习语。例如，您可能应该允许“#”在行尾开始注释，并忽略空行。如果配置文件包含您不理解的行，您还应该决定您将做什么——是忽略并继续静默，还是抱怨。（我更喜欢抱怨的东西；然后我知道为什么我刚刚添加的内容没有任何效果 - 而静默忽略意味着我不知道我刚刚添加的条目是否有任何效果。）

另一个问题是定位配置文件。您是通过编译位置、使用环境变量覆盖的默认安装位置还是通过其他一些魔法来做到这一点的？确保有一个命令行选项允许绝对指定配置文件 - 甚至考虑将其作为唯一的方法。

否则，在广泛的范围内，保持简单，每个人都会更快乐。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-05T00:58:53.660

好的，这是一个 C 代码的真实示例：

```
/* demo-fgets -- read a "demo.text", copy to stdout with line
   numbers. */

#include <stdio.h>
#include <stdlib.h>

#define MAXLINE 100

FILE * fp;
char bufr[MAXLINE];

extern int errno ;

int main(int argc, char ** argv){
    int count = 0 ;
    if((fp = fopen("demo.text","r")) != NULL){
        /* then file opened successfully. */
        while(fgets(bufr,MAXLINE,fp)!=NULL){
            /* then no read error */
            count +=1;
            printf("%d: %s",     /* no "\n", why? */
                   count, bufr);
        }
        /* fgets returned null */
        if(errno != 0){
            perror(argv[0]);    /* argv[0]?  Why that? */
            exit(1);
        }
        exit(0);                /* EOF found, normal exit */
    } else {                    /* there was an error on open */
        perror(argv[0]);
        exit(1);
    }
} 
```

我用这个输入文件运行它：

```
520 $ cat demo.text 
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum
aliquet augue id quam. Sed a metus. Quisque sit amet quam. Sed id
ante. In egestas est non mi. Sed vel velit non elit vehicula
viverra. Curabitur eget tortor in ipsum vulputate
faucibus. Suspendisse imperdiet mauris at nibh. Sed interdum. Maecenas
vulputate, massa vel placerat mattis, ante est tincidunt sem, in
sollicitudin velit lacus non tortor. Etiam sagittis consequat nisl. 

Vestibulum id leo quis mauris gravida placerat. Donec aliquet justo a
tortor. Etiam nisi nibh, auctor non, luctus et, aliquam vitae,
metus. Cum sociis natoque penatibus et magnis dis parturient montes,
nascetur ridiculus mus. Nunc lacinia quam a ligula. Nulla quis nisi eu
nunc imperdiet cursus. Nunc vitae nisi vitae tellus posuere
sollicitudin. Nunc suscipit, dui ac interdum euismod, pede nisl varius
dui, sed mattis libero mauris eu felis. Nam mattis dui eget
nunc. Suspendisse malesuada, pede eget posuere pellentesque, neque
eros pretium nibh, ut blandit dui leo dapibus orci. Etiam lacinia
lectus at orci. Donec ligula lacus, sagittis nec, sodales et,
fringilla lobortis, eros. Etiam sit amet nulla. Aliquam mollis pede id
enim. Etiam ligula felis, pulvinar nec, vestibulum molestie, interdum
ut, urna. Ut porta ullamcorper diam. Nullam interdum arcu. 

Pellentesque habitant morbi tristique senectus et netus et malesuada
fames ac turpis egestas. Etiam eu enim quis sem accumsan
tristique. Proin non sem. Etiam quis ante. Aenean ornare pellentesque
dolor. Praesent sodales. Cras dui velit, scelerisque a, accumsan a,
vestibulum in, dui. Pellentesque sed sapien. Etiam augue est,
convallis eget, egestas vel, molestie id, turpis. Cum sociis natoque
penatibus et magnis dis parturient montes, nascetur ridiculus
mus. Cras posuere lorem eu diam. Ut ultricies velit. Nunc imperdiet
suscipit mauris. Vestibulum molestie elit id risus. Phasellus et
purus. Vestibulum id mauris. Fusce gravida elit quis turpis. Aliquam
ut est. 

Sed in mauris eu nulla rhoncus suscipit. Nam id dolor sit amet turpis
placerat sodales. Nunc ipsum. Quisque diam tellus, dapibus non,
interdum at, aliquam sit amet, tellus. Donec non pede eget massa
aliquam semper. Quisque dictum lacinia ipsum. Fusce magna purus,
mattis id, commodo et, lobortis eu, arcu. Vestibulum viverra neque a
nulla. Cum sociis natoque penatibus et magnis dis parturient montes,
nascetur ridiculus mus. Pellentesque vel felis in ligula blandit
auctor. Quisque quam. Curabitur turpis. Morbi molestie augue a
nisi. Nulla sollicitudin sagittis elit. Suspendisse in odio sed magna
dictum vestibulum. Duis facilisis lorem eget neque. Proin sit amet
urna eget velit scelerisque aliquam. Pellentesque imperdiet. Nullam
sapien. Nullam placerat ipsum eget metus. 

Mauris ornare risus eu velit. Morbi bibendum diam in sem. Morbi
aliquet nisl sit amet quam. Donec ornare sagittis nibh. Fusce ac
lectus. Sed sit amet risus. Integer facilisis commodo
sem. Pellentesque facilisis. Donec libero. Lorem ipsum dolor sit amet,
consectetur adipiscing elit. 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-01-05T02:45:42.277

好吧，让我们来看看另一部分。你需要考虑你想拥有什么作为你的“语言”。在 UNIX 世界中，规范版本可能是空格分隔的文本（think `/etc/hosts`）或“:”分隔的文本（like `/etc/passwd`）。

你有几个选择，在某种意义上最简单的就是使用 scanf(3)。再次，阅读手册页以获取详细信息，但如果行条目类似于

```
port    100 
```

那么你会寻找类似的东西

```
char inbuf[MAXLINE];
int  val;

scanf("%s %d\n", &inbuf[0], &val); 
```

如果您编写一个简单的 FSA 解析，您可以获得更多的灵活性：从行中一次读取一个字符，并使用有限自动机来定义要做什么。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-01-05T00:09:04.493

有很多方法。您*不需要*使用 fgetc。您可能应该阅读 stdio 手册页，但规范的做法是使用 fopen(3) 打开文件，然后使用 fgets(3) 一次读取一行。这看起来像：

```
#include <stdio.h>

FILE * fp ;
char bufr[MAXLINE];

if((fp = fopen(filename, "r") != NULL){
    while(! feof(fp)){
         fgets(bufr, MAXLINE, fp);
         /* Do stuff */
    }
} else {
    /* error processing, couldn't open file */
} 
```

您还可以查看 Sourceforge 的[libini](http://sourceforge.net/projects/libini)。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-05T01:17:15.557

您为什么要从头开始编写此代码，已经完成了*很多**次*；只需找到一个好的 F/OSS 实现并使用它。

 *> 您如何从文本文件中读取并有效地处理每一行

不用担心效率，读取配置文件无所谓。而是追求简单性和可维护性。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-01-05T02:29:24.460

我会这样做的方式（伪代码）：

```
while(there is input) {
  get one line;
  if (it is empty line || it beings with spaces followed by a '#') {
    skip this line, either empty or it's a comment;
  }
  find the position of the token that splits option name and its value;
  copy the option name and its value to separate variables;
  removing spaces before and after these variables if necessary;
  if (option == option1) {
     parse value for option 1;
  } else if (option == option2) {
     parse value for option 2;
  } else {
     handle unknown option name;
  }
  check consistency of options if necessary;
} 
```

请注意，部分代码（检查变量周围的空行、注释和空格）是为了在编写配置文件时为您提供额外的灵活性。例如，您不会因为不小心在这里和那里留下额外的空间而导致程序崩溃。

这是假设您有如下所示的配置文件：

```
# comment for option 1
option1 = value1

# comment for option 2
option2 = value2

... 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-05T02:03:04.577

另一个解决方案 - [Pure-ftpd](http://download.pureftpd.org/pub/pure-ftpd/doc/README.Configuration-File)

> 与许多守护进程不同，Pure-FTPd 不读取任何配置文件。相反，它使用命令行选项。...在服务器中为配置文件添加解析器是个坏主意。它减慢了一切速度，并且无需任何资源。

对于选项，有[getopt](http://www.gnu.org/software/libtool/manual/libc/Getopt.html)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-05T12:33:24.523

GNU LibC中还有[getline() 函数和朋友](http://www.gnu.org/software/libtool/manual/libc/Line-Input.html)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-01-06T11:23:15.567

不久前，我用 C 语言编写了一个干净、无依赖、事件驱动的 INI 文件解析器。我决定把它扔进一个[公共 Hg 存储库](http://projects.stoneship.org/hg/shared/alini/)。它是 MIT 许可的，因此您可以在任何您喜欢的地方自由使用它。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2019-12-23T08:23:04.527

C 不像 Python 那样容易，但我们仍然想要“导入”之类的东西......

```
#define _CRT_SECURE_NO_WARNINGS
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
/*conf*/
/*
 * #ip
 * ip:192.168.0.0.1
 * #port
 * port:8888
 * */
/*read conf*/
void test()
{
        FILE *fp = fopen("conf", "r");
        if (fp == NULL)
        {
                return;
        }

        char line[1024] = { 0 };
        while (!feof(fp))
        {
                memset(line, 0, 1024);
                fgets(line, 1024, fp);
                if (line[0] == '#')
                {
                        continue;
                }

                int len = strlen(line);
                char *pos = strchr(line, ':');
                if (pos == NULL)
                {
                        continue;
                }
                char key[64] = { 0 };
                char val[64] = { 0 };

                int offset = 1;
                if (line[len - 1] == '\n')
                {
                        offset = 2;
                }

                strncpy(key, line, pos - line);
                strncpy(val, pos + 1, line + len - offset - pos);

                printf("%s -> %s\n", key, val);
        }
}

int main()
{
        printf("read start...\n");
        test();
        printf("read success!!!\n");
        int c = getchar();
        return 0;
} 
```

以上基于 x:y 格式的 conf...

```
ip:192.168.0.0.1
port:8888 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-05T01:37:33.193

您是否考虑过将配置值存储为环境变量？:) 配置文件将是您在程序之前运行的 shell 脚本。（实际上shell脚本会执行它来保存变量）。这样你就可以使用 shell 作为配置解析器:)

使用[http://www.google.com/codesearch](http://www.google.com/codesearch)和“读取配置”

请参阅 [httpd 示例][1]

[1]：[https://web.archive.org/web/20120519035457/http://www.google.com:80/codesearch/p?hl=ru#W6G7kfsfmHo/httpd-2.2.4/server/config。 c&q=读取](https://web.archive.org/web/20120519035457/http://www.google.com:80/codesearch/p?hl=ru#W6G7kfsfmHo/httpd-2.2.4/server/config.c&q=read)配置 httpd

# ruby-on-rails - 掌握 Rails 的详细示例

> ID：411923
> 
> 赞同：3
> 
> 时间：2009-01-04T23:42:23.223
> 
> 标签：ruby-on-rails

谁能指出我在 Rails 中的主要细节实现？我用谷歌搜索但找不到任何好的示例网站。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-04T23:50:13.940

您可能希望从[acts_as_tree](http://api.rubyonrails.org/classes/ActiveRecord/Acts/Tree/ClassMethods.html)模型开始，但确切的实现很大程度上取决于您想要的最终结果；）

# sharepoint - 设计共享点页面 - 我可以使用什么？

> ID：411935
> 
> 赞同：0
> 
> 时间：2009-01-04T23:51:32.830
> 
> 标签：sharepoint

我正在下载和安装必需的 sharepoint 2007 组件，使用 Bamboo 实用程序在我的 Vista Home Premium 机器上设置 Vista 上的软件。我想知道，我是否需要 Sharepoint Designer 2k7 以所见即所得的方式进行设计，还是可以使用 Visual Studio 2008 的 Sharepoint 工具？

我有哪些选择？

我找不到概述我的选择的文章。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-05T01:05:53.973

不，如果您正在尝试进行所见即所得的编辑，则需要 Sharepoint Designer，或者您可以手动编辑/创建页面。事实上，早期版本（早于 2007 年）没有专门为 Sharepoint 设计的设计师或产品，唯一可用于 WYSIWYG 的工具是 FrontPage：P

更多信息：http: [//blogs.msdn.com/sharepointdesigner/](http://blogs.msdn.com/sharepointdesigner/)

高温高压

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T08:39:49.893

不同的工具。

Sharepoint Designer (SPD) 用于内置工作流程、修改现有页面以及一系列幕后和管理类型职责。它被称为最终用户类型的工具，但它太复杂了。这是

适用于 Visual Studio 的 Sharepoint 工具可帮助您创建新项目、创建新的工作流活动或完成工作流。远高于最终用户，根据您的想法，您可以在 Visual Studio 中创建东西，然后使用 SPD 使用它。

Infopath 用于创建存储在最终用户级工具 sharepoint 中的表单。将表单存储在 sharepoint 中后，您可以使用 SPD 基于开箱即用的工作流活动创建工作流，也可以使用 Visual Studio 创建更复杂的工作流。如果您拥有 MOSS 的企业版或表单服务器，您可以将这些表单显示为 HTML，而不是要求用户在其本地计算机上安装 Infopath。

因此，如果您正在构建开发/学习机器，请安装所有这些。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T00:13:25.047

InfoPath（MS Office 的一部分）是一个很好的工具，用于为 SharePoint 设计数据感知表单。

不过，SharePoint Designer 似乎确实适用于一般设计任务。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-07T19:19:25.327

您可以打开一个苔藓网站是 VS 2008，但您会在视觉上得到一些错误，相信与内容区域有关，您仍然可以编辑页面源代码。

话虽如此，如果您经常处理它，您将需要共享点设计器，因为它具有其他派上用场的功能。

# .net - 测试业务线 (LOB) .NET 应用程序？

> ID：411937
> 
> 赞同：7
> 
> 时间：2009-01-04T23:52:47.913
> 
> 标签：.net, unit-testing, testing

我想知道这里是否有人有单元测试 LOB 应用程序（通常是 CRUD）的经验。

我曾涉足 Visual Studio 中的内置单元测试工具，但我发现很难运行命中数据库的测试。由于数据发生了变化，再加上我对自己在做什么一无所知，因此似乎很难产生预期的结果并对其进行断言。此外，我什至听说您不应该对数据库运行单元测试......但是其他人如何对 CRUD LOB 软件执行单元测试？

我听说过很多关于 TDD 和与测试的持续集成，但似乎如果我什至不能从一开始就创建单元测试，我就不能真正使用这些方法。这是因为像记事本这样的产品很容易为……创建单元测试……你有一定数量的特性，这些特性应该总是产生相同的结果。但是对于 LOB 应用程序，您可以在测试环境中创建、删除或修改诸如销售订单之类的东西。

任何见解将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-05T00:00:09.490

通常使用 CRUD，您将需要模拟或使用 IOC 容器作为您的数据访问层，这样您就不会总是访问数据库和“可变数据”。

对于单元测试，您总是期望相同的值，因此将其连接到数据库通常会导致问题。

查看 RhinoMocks 或 Inversion Of Control Containers。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T00:01:40.967

我创建了一个基线数据库并使用 dbUnit 将其导出到一组 XML 文件中。测试的第一遍是清除并使用基线填充测试数据库。之后，您应该能够根据预期值断言单元测试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-05T01:11:56.893

自动化测试是一个广泛的类别，其中包含两个较小的类别：单元测试和集成测试。

单元测试是一种识别程序最小单元的实践，并编写程序对它们进行相互隔离的测试。当程序的最小单元紧密耦合在一起时，可能很难相互隔离地测试它们。在这种情况下，有一些技术和工具可以帮助您（模拟和模拟框架）。为了有效地进行单元测试，你的代码库需要以一种特定的方式编写，一种支持单元测试的方式——程序的最小单元不能耦合在一起。大多数程序都没有考虑到这个原则，因此它们很难进行单元测试。尽可能进行单元测试，并为您编写的任何新代码牢记这一原则，以便您始终可以对新代码进行单元测试。

集成测试是识别作为程序大单元集成许多较小单元的功能的实践，并编写程序测试它们与程序的其他大单元隔离。例如，测试您的持久层正确地将对象保存到持久存储并从持久存储中正确检索对象的过程是一个集成测试，因为它同时测试您的持久层以及 TCP/IP 管道、数据库配置、数据库架构、数据库中已有的数据以及数据库中已有的数据与您的代码正在执行的操作之间的交互。除了单元测试之外，一定要进行集成测试。

此外，纯粹出于自动化集成测试的目的创建一个单独的数据库。尽量避免在生产或开发数据库上运行自动化集成测试，因为你只会遇到问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-05T04:54:21.627

我偶然发现了同样的问题，你没有那么多选择......

*   每次测试后回滚（将 xtUnit 用于 NUnit 或 MbUnit 回滚属性）。这适用于 CRUD 操作的典型单元测试。
*   在测试之前使用备份还原策略。这将使单元测试执行时间变长。然而，MbUnit 支持这一点（2.X 的属性在 3.x 主干中不存在）
*   使用 sql 脚本创建/删除数据库。

最后两个选项的最大优势是您可以在执行所谓的集成测试时使用它们（例如在需要支持其他层（物理服务器）上的数据库更改的 UI 自动化时）。

我将最后一个与[Watin](http://watin.sourceforge.net/)结合用于网络应用程序。对于 WPF 和 Win32 看看[White](http://www.codeplex.com/white)，它看起来很有希望。

# java - JDialog不绘画

> ID：411945
> 
> 赞同：1
> 
> 时间：2009-01-04T23:59:26.323
> 
> 标签：java, swing

我是 java 新手，但我认为这很直接。从文本文件导入数据时，我会显示一个 JDialog 供用户输入，但该对话框未在其他计算机上正确绘制。

在我的计算机上，如果我从 NetBeans 中或从命令提示符运行程序，则对话框会正确显示。如果我在它应该运行的计算机上运行程序，那么对话框的内部不会被绘制 - 我所看到的只是对话框的边框，然后是控件应该在其后面的屏幕。这台计算机正在运行 XPSP2 和 jre6 更新 11。

有谁知道可能出了什么问题？

TIA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-05T00:06:02.207

我们需要查看您的代码以确定，但很可能您是在[UI 线程](http://java.sun.com/docs/books/tutorial/uiswing/concurrency/dispatch.html)上执行导入，从一些侦听器代码中 - 因为您使用的是 UI 线程，所以在您从侦听器返回之前不会处理任何事件。

解决方案是启动一个新线程来进行导入，然后让它触发事件来更新 GUI。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-05T09:53:01.197

该代码在一个地方有效，但在另一个地方无效。电脑不是魔法。因此，两台计算机之间肯定存在一些差异。该代码是 Swing GUI 代码。三个最可能的差异是：

*   不同的视频硬件
*   不同的代码（可能是 JRE 库）
*   不同的 Swing 外观和感觉（可能由不同的操作系统引起）

如果两台机器上与视频硬件的 Java 连接有所不同，请尝试找出原因。您的机器和目标机器是否都具有最新的视频驱动程序等？目标机器是否有两个显示器，或者视频硬件的其他差异可能导致执行不同的代码？

两台计算机（例如 JRE 或操作系统）之间的差异可能会导致执行不同的代码。您已经告诉我们目标机器的 JRE 和操作系统：您的机器呢？您能否找到第三台机器，或安装另一台 JRE，以便我们知道它是机器还是 JRE？

您可能在两台机器上有不同的 Swing 外观和感觉。尝试不同的外观和感觉。

```
UIManager.setLookAndFeel(UIManager.getCrossPlatformLookAndFeelClassName()); 
```

只是提到问题可能出在您的代码的某个地方，并且错误更有可能是您的代码而不是 Swing 库中的代码，但这至少可以帮助您弄清楚为什么一切都在一台机器上运行而不是在另一台机器上运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T00:05:18.543

[您是否在Event Dispatch Thread](http://java.sun.com/docs/books/tutorial/uiswing/concurrency/dispatch.html)中完成所有与 Swing 相关的工作？如果是这样，你确定你没有阻塞这个线程，或者在其中做一些缓慢的事情吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-05T00:23:02.827

通过命令终端运行程序，以便查看程序是否引发了任何异常。

该命令将是：java -jar pathtoyourjar.jar

# html - 用于更快、更好的 Web 开发的工具

> ID：411954
> 
> 赞同：76
> 
> 时间：2009-01-05T00:05:05.673
> 
> 标签：html

多年来，大多数 Web 开发人员将构建一个工具库或“行业工具”。最近我发现了 rsync，我很惊讶这些年来我是如何在没有它的情况下生活的。您认为哪些工具最引人注目？请坚持您经常使用的那些并发誓。它们也可以是框架、平台、编辑器以及您认为 Web 开发人员应该使用的任何其他东西（jquery、joomla、xdebug、vi、notepad++ 等）。

我将从几个开始：

1.  [rsync](http://samba.anu.edu.au/ftp/rsync/rsync.html) - “一键”同步到实时服务器，反之亦然
2.  [mysqldump](http://dev.mysql.com/doc/refman/5.1/en/mysqldump.html) - 与 rsync 一起用于同步数据库
3.  [测试样式小书签](https://www.squarefree.com/bookmarklets/webdevel.html)- 实时 css 编辑器小书签，它通过允许实时编辑打破了“编辑 > 保存 > 重新加载”循环。
4.  [javascript shell](https://www.squarefree.com/bookmarklets/webdevel.html) - 附加到窗口的 javascript shell 窗口
5.  [firebug](http://www.getfirebug.com/) - 高级 javascript/css/dom 调试器
6.  [php-shell](http://pear.php.net/package/PHP_Shell/) - 我经常使用它来快速测试语句、函数、类或脚本
7.  [CSS-Discuss Wiki](http://css-discuss.incutio.com/) - 如果您在此 wiki 上找不到 CSS 问题的解决方案，我会感到惊讶（在这种情况下，您应该添加它）
8.  [字体矩阵](http://media.24ways.org/2007/17/fontmatrix.html)- 帮助我选择字体堆栈
9.  [PHPMyAdmin](http://www.phpmyadmin.net/) - 我确定每个人都使用它来管理他们的 MySQL 数据库，但我认为我会将它添加到列表中以更好地衡量

尽管我在 LAMP 环境中突出显示了工具，但您可能会提到在您的环境中使用的工具。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-01-05T00:21:49.070

## LAMP 堆栈开发

*   IDE：[Zend Studio](http://www.zend.com/en/products/studio/) / [PDT for Eclipse](http://www.eclipse.org/pdt/)
*   PHP 框架：[Zend 框架](http://framework.zend.com)
*   Javascript 库：[jQuery](http://jquery.com/)
*   源代码版本控制：[SubVersion](http://subversion.tigris.org/) with [Tortoise](http://tortoisesvn.tigris.org/)客户端
*   HTML过滤库：[HTML Purifier](http://htmlpurifier.org/)
*   图像处理库：[php image](http://code.google.com/p/php-image/)
*   操作码缓存：[APC](http://www.php.net/apc)
*   Javascript/CSS 部署：[缩小](http://code.google.com/p/minify/)
*   标记/javascript检查调试：[Firebug](http://getfirebug.com/)
*   数据库管理：[phpMyAdmin](http://www.phpmyadmin.net/home_page/index.php)
*   页面加载分析器：[YSlow](http://developer.yahoo.com/yslow/)
*   标记验证：[HTML 验证器](http://users.skynet.be/mgueury/mozilla/)
*   外壳客户端：[PuTTY](http://www.chiark.greenend.org.uk/~sgtatham/putty/)
*   FTP 客户端：[FlashFXP](http://www.flashfxp.com/)
*   PHP[手册](http://www.php.net/)
*   经验和技能:)

（我专注于 LAMP，因为那是我用于 Web 开发的工具）

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-05T00:12:45.220

**用于开发的 Firefox 插件**

[ColorZilla](http://www.colorzilla.com)

事实证明这对我非常有用。您可以在任何网页上滴眼任何颜色（我在这里使用我的母语拼写），如果您愿意，也可以在 chrome 上滴眼！

[Web 开发人员工具栏](http://www.chrispederick.com/work/web-developer/)

尺子很有用！更不用说其他一切了:)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-01-05T01:26:58.457

[VirtualBox](http://www.virtualbox.org/)使开发变得非常容易，因为您可以将虚拟机作为“服务器”并从您的主操作系统浏览页面。如果您的目标操作系统不是您正在开发的操作系统，则尤其如此。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-01-05T00:39:08.007

这些是我的一些基本要点：

操作系统：

*   文本编辑器：[Textmate](http://macromates.com/)
*   CSS 编辑器：[CSSEdit](http://macrabbit.com/cssedit/)
*   FTP工具：[传输](http://www.panic.com/transmit/)

视窗：

*   文本和 CSS 编辑器：[Aptana](http://aptana.org/)

跨平台：

*   源代码管理：[Git](http://git.or.cz/)
*   浏览器插件：[萤火虫](http://getfirebug.com/)
*   框架：[Ruby on Rails](http://rubyonrails.org/)
*   Javascript 库：[原型](http://www.prototypejs.org/)和 [Scriptaculous](http://script.aculo.us/)
*   导航多台计算机：[Synergy](http://synergy2.sourceforge.net/)

另外，这是我不久前写的一篇文章：[Web 开发人员工具箱的基本要素](http://thetacom.info/2008/03/24/essentials-for-a-web-developers-toolbox/)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-01-05T00:39:25.620

[阿普塔纳工作室](http://www.aptana.com/)

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-01-05T01:02:37.163

现金（付钱给别人）。

**编辑：**这个问题清楚地说：

> 请坚持您经常使用的那些并发誓。它们也可以是框架、平台、编辑器以及您认为 Web 开发人员应该使用的**任何其他东西**

将部分或全部 Web 开发外包是非常合理的。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-01-05T01:07:03.830

如果你发现 rsync 有帮助，我相信你会发现[unison](http://www.cis.upenn.edu/~bcpierce/unison/)更是如此！

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-01-05T02:04:18.660

优秀的 Galperin 列表中仅添加/替换了一些内容：

*   PHP IDE：[VS.PHP](http://vsphp.de/) /[文本板](http://www.textpad.com/)
*   PHP MVC 框架：[CodeIgniter](http://codeigniter.com/)
*   PHP ORM 框架：[phpDBO](http://www.phpdbo.com/)
*   PHP 模板框架：[PHPTAL](http://phptal.motion-twin.com/)
*   FTP客户端：[FireFTP](https://addons.mozilla.org/de/firefox/addon/684)
*   WAMP 包：[WAMP 服务器](http://www.wampserver.com/)

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-01-05T00:08:08.630

[Johnny Cache](https://addons.mozilla.org/en-US/firefox/addon/3817) - 阻止在 Firefox 中缓存某些 URL（否则 Firefox 偶尔会缓存 CSS 和 javascript）

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-06-20T23:59:27.450

## 我的列表

*   IDE：Visual Studio / Netbeans（zip 文件！，几乎可移植）

*   编辑器：notepad++（便携），monaco字体

*   文件比较：winmerge（便携）

*   源码控制：颠覆、乌龟

*   票务控制：redmine

*   文件管理器：自由指挥官（便携）

*   Web-Browser: IE, FF (portable), chrome (portable), Iron (chrom without google crap, 也是便携的), qtweb, arora,

*   FF 插件：firebug、web developer、xmarks

*   客户端：pidgin

*   邮件客户端：gmail

*   下载管理器：免费下载管理器（便携式）

*   网站：STACKOVERFLOW !!!，gotapi ......和谷歌，一直......

*   杂项：launchy（没有它就活不下去！）

*   虚拟化：虚拟盒子（我对每个环境都有一个机器映像）

*   办公室：openoffice（便携式）

*   灯组：xammp（便携！）

*   磁盘使用：windirstat（便携式）、scanner（便携式）

*   Pdf 查看器：foxit（便携式）、sumatrapdf（便携式）

*   解压器：7-zip 便携式

*   M$ sql比较工具：sql delta

*   M$ sql管理：visual studio sql manager

*   mysql

*   MySql管理：phpmyadmin，mysql自带的manager

*   卸载程序实用程序：revo unistaller（便携式）

*   注册表清理器：ccleaner（便携式）

*   FTP：filezilla（便携式）

您可能已经注意到，我特别偏爱便携式应用程序...

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-01-05T01:08:51.283

如果您喜欢使用[VIM](http://www.vim.org/)的任何变体作为您选择的编辑器，一个极好的附加功能是[CSS 颜色预览](http://www.vim.org/scripts/script.php?script_id=2150)，它“用真实颜色覆盖十六进制 CSS 颜色代码”。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-01-05T04:06:57.713

**jQuery**

我最近开始使用它，它*非常*好用！一切都变得容易编码！至少！

我怎么强调都不过分。像这样的多功能库不应该错过，即使是像我这样通常看不起使用其他人代码的人。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-01-12T18:21:39.630

别介意我，我只是来宣传我最喜欢的编辑器/正则表达式调试器/grepper 套件。:-)

*   [EditPad Pro](http://www.editpadpro.com/)（IMO，最好的文本编辑器）
*   [RegexBuddy](http://www.regexbuddy.com/) （我发现的唯一真正的正则表达式*调试器）*
*   [PowerGREP](http://www.powergrep.com/)（不再使用 Windows 搜索）

它们都不是免费的，但它们都获得了合理的许可，并且都支持便携式安装（适合钥匙串上的 USB 驱动器）。最重要的是，[作者](https://stackoverflow.com/users/33358/jan-goyvaerts)是 SO 用户。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-01-05T02:09:25.360

[电子文本编辑器](http://www.e-texteditor.com/)，作为“Windows 上 TextMate 的强大功能”出售。我发现它非常适合 HTML 和 CSS 编码。它非常轻巧，并包含一些肯定会提高生产力的强大功能。我经常使用的其他值得注意的工具是：

*   [萤火虫](https://addons.mozilla.org/en-US/firefox/addon/1843)
*   [Web开发人员](https://addons.mozilla.org/en-US/firefox/addon/60)
*   [W3C 验证器](http://www.w3.org/QA/Tools/#validators)

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-01-05T04:40:10.423

CakePHP - 用于 php 的 MVC 框架

CakePHP 是一个用于 PHP 的快速开发框架，它为开发、维护和部署应用程序提供了一个可扩展的体系结构。在约定优于配置范式中使用常见的设计模式（如 MVC 和 ORM），CakePHP 降低了开发成本并帮助开发人员编写更少的代码。

总结了许多与 CRUD 相关的工作，并具有许多其他功能，可以减少我们必须做的工作。

[http://cakephp.org/](http://cakephp.org/)

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-01-06T12:51:55.547

除了这里提到的其他工具外，我经常在拥有适当的调试代理方面找到很大的帮助 - [Fiddler](http://www.fiddlertool.com/fiddler/)（免费，仅限 Windows）和[Charles](http://www.charlesproxy.com/)（商业，跨平台）是很棒的工具。

做前端开发，很多时间都花在弄清楚 IE 行为不端的原因上（尤其是 IE6）。一些很好的工具是：

*   [Internet Explorer 开发人员工具栏](http://www.microsoft.com/en-us/download/details.aspx?id=18359)
*   [Companion.JS](http://www.my-debugbar.com/wiki/CompanionJS/HomePage) - 这是 Microsoft Script Debugger 的配套应用程序，它在 IE 中为您提供真正有用的 Javascript 错误消息。
*   [XRay](http://www.westciv.com/xray/) - 这是一个用于检查 HTML 布局的书签。这可能看起来微不足道，但对于在 IE6 中调试布局非常有帮助

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2009-01-12T18:02:22.413

我最近发现了[XRefresh](http://xrefresh.com)，它会在您保存更改后自动重新加载本地文件（file:// URL）。当您处于项目的初始阶段并经常更新本地项目目录中的静态 HTML、CSS 和 JavaScript 文件时，这绝对很棒。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2009-01-27T23:20:15.053

lynx、wget 和 curl 等命令行 http 客户端非常有用，至少在您的开发风格面向命令行和文本工具的情况下是如此。我很惊讶他们还没有被提及。

*   例如，将 POST 数据提供给 url 并打印出响应标头和 html 输出：`echo 'foo=1&bar=2' | lynx -post\_data -mime\_header http://localhost/my/app`
*   一旦它在你的 shell 历史中就可以快速执行（向上箭头，返回），与切换到浏览器相比，中断流或分心的风险更小。
*   可编写脚本、可修改、可重复。您可以在它前面加上一个脚本以将数据库置于一个已知的起始状态，您可以为您感兴趣的特定事物 grep 响应标头或 html 输出，然后使用命令行数据库查询来确定是否完成状态是需要的。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2010-02-11T05:08:13.990

IDE：[视觉工作室](http://msdn.microsoft.com/en-us/vstudio/default.aspx)

框架：[ASP.NET MVC](http://www.asp.net/mvc/)

客户端：[jQuery](http://en.wikipedia.org/wiki/Jquery)和[jQuery.ui](http://jqueryui.com/)

[Internet Explorer 开发人员工具栏](http://en.wikipedia.org/wiki/Internet_Explorer_Developer_Toolbar)

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2010-11-16T13:58:01.473

如果您是 Windows 开发人员，您**必须**看看这些工具：

*   [FreeCommander](http://www.freecommander.com/)（类固醇目录浏览器）
*   [特工 Ransack](http://mythicsoft.com/page.aspx?type=agentransack&page=home) （轻松搜索）
*   [Komodo](http://www.activestate.com/komodo-ide) & [Notepad++](http://notepad-plus-plus.org/)（成功组合）
*   谷歌浏览器（带扩展）：
    *   [分辨率测试仪](https://chrome.google.com/extensions/detail/idhfcdbheobinplaamokffboaccidbal)
    *   [从网页中选择颜色](https://chrome.google.com/extensions/detail/hmdcmlfkchdmnmnmheododdhjedfccka)
    *   [搜索引擎优化](https://chrome.google.com/extensions/detail/oangcciaeihlfmhppegpdceadpfaoclj)
    *   [截屏](https://chrome.google.com/extensions/detail/alelhddbbhepgpmgidjdcjakblofbmce)

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2010-12-18T05:12:44.870

*   IDE：PHPStorm、PyCharm（重构！！！）
*   VIRT：win32 上的 colinux
*   git + sh
*   KitTY + WinSCP

*   网络检查员

*   萤火虫 + addys
*   xpathbuddy (tbr)
*   犀牛 (CLI)
*   环境
*   phpsh
*   xdebug + kcachegrind

*   采埃孚

*   梨
*   jQuery
*   封闭工具

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-01-05T01:40:24.543

开发不仅仅是编码。有需求捕获、分析、设计、QA。以下是对软件开发不同[阶段的](http://www.dynamicalsoftware.com/cr/demo/sitemap.html)介绍。几年前，我在[Top OSS for Coders](http://www.transitionchoices.com/cgi-bin/article.pl?id=17)上发表了这篇文章，但它仍然与我相关。此列表包括在软件开发的所有不同阶段（而不仅仅是编码阶段）对我非常有帮助的 OSS 工具。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-01-05T03:36:16.277

我发现一些 Firefox 插件非常有用：

*   [Live HTTP Headers](https://addons.mozilla.org/en-US/firefox/addon/3829) - 检查请求/响应 HTTP 标头非常有用。

*   [MeasureIt](https://addons.mozilla.org/en-US/firefox/addon/539) - 测量浏览器内部内容的工具。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2009-01-05T04:03:20.840

作为一个必须为我的一个客户编写蛋糕 php 应用程序的 Windows 人，[SFTPDrive](http://www.expandrive.com/sftpdrive/)对我非常有帮助。我的虚拟机是一个 Centos Linux 发行版，我大部分时间都在我的 Windows 环境中工作（当然也有一些例外）。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2009-01-05T07:40:08.780

我主要使用谷歌:-)

说真的，一个很棒的 Firefox 插件是[TamperData](https://addons.mozilla.org/en-US/firefox/addon/966) - 让您能够更改每个请求的标头和数据。[Paint.NET](http://www.getpaint.net/index.html)图像编辑器每天都会帮助我，我推荐它来满足您的基本图像编辑需求
。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2009-01-05T09:20:50.247

[RXP](http://www.cogsci.ed.ac.uk/~richard/rxp.html)

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2009-01-06T15:18:31.193

提琴手

视图状态助手

顶级风格精简版

IE 开发者工具栏

萤火虫

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2009-01-07T08:37:49.647

NetBeans 或者如果你是控制台专家，emacs

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2009-01-05T00:28:21.367

一个关于协同作用的窗口框。首先在 IE 中构建，*然后*针对 Firefox/Safari 进行调整，这使我对 IE 的支持达到了标准。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2009-01-05T03:56:59.277

我最近开始使用**HttpWatch**，发现它很棒。它允许您检查 Web 应用程序的所有 HTTP 流量。您的 AJAX 响应的大小是多少？浏览器是否从其缓存中加载了 gif？您的页面是否提出任何您不知道的请求？这些只是 HttpWatch 可以帮助您回答的部分问题。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2009-01-07T08:45:51.347

我想添加用于虚拟开发环境的[VMWare Workstation 。](http://www.vmware.com/products/ws/)我还没有尝试过新的 eclipse vm 调试插件，顺便说一句；）

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2009-01-08T16:30:30.453

Firebug - 用于澄清正在使用的 CSS 以及它来自什么样式表的出色工具 Crimson Editor - 具有出色语法突出显示 JQuery 的小编辑器 - 够了 DNS 专家 - 即时检查任何与 DNS 相关的内容

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2011-09-30T11:56:43.023

我使用[MySQL](http://mywebsql.net)来管理 MySQL。phpMyAdmin 太传统了。

* * *

## 回答 #34

> 赞同：-1
> 
> 时间：2010-09-08T09:57:07.060

对于网站，请使用 Ruby on rails。它为您生成表单、按钮、列表框。它生成数据验证以确保用户输入正确。

# c# - 如何再次请求中止的 HttpWebRequest？

> ID：411974
> 
> 赞同：9
> 
> 时间：2009-01-05T00:22:12.673
> 
> 标签：c#, .net, httpwebrequest

我的目标是在异步 HttpWebRequest 失败时重试它。

当我[Abort()](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.abort.aspx)一个 HttpWebRequest 时，我不能再次 BeginGetResponse()。所以再次请求的唯一方法可能是重新创建 HttpWebRequest 对象。这似乎需要做很多工作，因为我必须从旧对象中复制所有属性。有什么捷径吗？

注意：我认为序列化可以解决我的问题，但是这个类不会序列化，如上一个[问题](https://stackoverflow.com/questions/351265/httpwebrequest-wont-serialize)中所述。

**更新**删除了示例源代码，因为它是不必要的

**目前对此事**的看法没有捷径，重做请求的唯一方法是创建另一个 HttpWebRequest 对象，就像您创建原始对象一样。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-28T15:48:33.527

这是不可能的。

HTTPWebRequest 实例实际上代表一个请求实例（尽管存在内部重试的极端情况），因此在逻辑上不是可以重复的东西。它能够只返回一个响应（请求/响应是一对逻辑对），尽管您可以多次检查该响应，但您将获得完全相同的对象。

基本上，您认为 HTTPWebRequest 实例是一种工厂，但它确实是具体的。您必须创建另一个实例。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-01-18T17:45:29.820

### 这是可能的！

您只需要创建一个新`HttpWebRequest`对象并将所有属性通过反射从旧对象复制到它。

这是执行此操作的**扩展方法**：

```
/// <summary>
/// Clones a HttpWebRequest for retrying a failed HTTP request.
/// </summary>
/// <param name="original"></param>
/// <returns></returns>
public static HttpWebRequest Clone(this HttpWebRequest original)
{
    // Create a new web request object
    HttpWebRequest clone = (HttpWebRequest)WebRequest.Create(original.RequestUri.AbsoluteUri);

    // Get original fields
    PropertyInfo[] properties = original.GetType().GetProperties(BindingFlags.Public | BindingFlags.Instance);

    // There are some properties that we can't set manually for the new object, for various reasons
    List<string> excludedProperties = new List<String>(){ "ContentLength", "Headers" };

    // Traverse properties in HttpWebRequest class
    foreach (PropertyInfo property in properties)
    {
        // Make sure it's not an excluded property
        if (!excludedProperties.Contains(property.Name))
        {
            // Get original field value
            object value = property.GetValue(original);

            // Copy the value to the new cloned object
            if (property.CanWrite)
            {
                property.SetValue(clone, value);
            }
        }
    }

    return clone;
} 
```

当您想重新发出相同的请求时，只需执行以下命令：

```
// Create a request
HttpWebRequest request = (HttpWebRequest)HttpWebRequest.Create("https://www.google.com/");

// Change some properties...

// Execute it
HttpWebResponse response = (HttpWebResponse)request.GetResponse();

// Clone the request to reissue it using our extension method
request = request.Clone();

// Execute it again
response = (HttpWebResponse)request.GetResponse(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-05T02:27:22.530

您在哪里尝试序列化请求？在尝试发出请求*之前*序列化请求可能是个好主意，然后在失败时重新发送请求（从序列化实例）。

此外，您可能希望删除代理、序列化实例，然后重新设置代理，因为这似乎是序列化请求的问题所在。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-12T14:44:41.533

没有捷径，重做请求的唯一方法是创建另一个 HttpWebRequest 对象，就像创建原始对象一样。

# database - 哪个开源数据库是会计相关系统的最佳选择？

> ID：411976
> 
> 赞同：12
> 
> 时间：2009-01-05T00:24:17.460
> 
> 标签：database, open-source, accounting

我正处于为我的公司规划和设计定制会计应用程序的早期阶段。我的目标是为数据存储部分使用开源关系数据库，并且我知道有两个得到广泛支持的可靠数据库：MySQL 和 PostgreSQL。

对于需要事务、存储过程、函数和安全性的系统，对于这两个数据库中的哪一个最适合会计应用程序有什么意见，还是我缺少另一个数据库？

我更熟悉 MySQL 和 MS SQLServer 2005，但由于许可证成本，我正试图摆脱后者。

*让我补充一下：这不是像 Quickbooks 或 Peachtree 这样的会计需求。这基本上是一个系统，用于处理我们提供的特定业务服务的会计处理。可能有两三个系统可以满足这种需求，在进行任何定制之前的价格在六位数范围内，并且需要我的小公司长期与供应商结婚。因此，我们正在内部构建应用程序。*

*另外，虽然我很欣赏**购买与建造**的争论，但我想摆脱那个特定的宗教问题，因为购买之路已经走完了，供应商惨遭失败。有时您只需要自己完成这项工作，这个特定的项目和预算就可以保证。*

感谢大家迄今为止的回复。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-05T00:35:56.687

有四种主要的开源关系数据库管理系统可能适用于此类应用程序：Postgresql、MySQL、Firebird 和 Ingres。还有其他系统，例如[SQLite，](http://www.sqlite.org/)但它们没有这种类型的架构，也不是真正为这种类型的工作负载设计的。这种类型的其他一些开源数据库管理系统确实存在，但由于某些原因（例如缺乏明显的供应商承诺）似乎并不可行。具有此类问题的系统示例是[SAP-DB。](http://en.wikipedia.org/wiki/MaxDB)

[Postgresql](http://www.postgresql.org/)具有所有开源数据库中最好的功能集，并且支持 XA 事务，如果您的应用程序是一个三层系统并且支持非平凡复杂的事务，您可能会想要这些。特别是，如果您想要执行跨越多个数据库调用的事务，您将需要这个。

多年来，已经构建了 PostgreSQL 的几个商业变体，例如[Illustra、](http://en.wikipedia.org/wiki/Illustra) [Greenplum](http://www.greenplum.com/)和[EnterpriseDB。](http://www.enterprisedb.com/) Illustra 是 PostgreSQL 的商业版本，随后被 Informix 收购。Greenplum 是为数据仓库应用程序设计的修改版本。EnterpriseDB 是一家提供支持的商业版 PostgreSQL 以及一些增值软件的公司。

[MySQL](http://www.mysql.com/) 5.x 具有支持合理横截面功能的功能集，但它不像 PostgreSQL 那样功能丰富。它具有更广泛的主流接受度，并且将是最容易招募熟练开发人员的开源数据库管理系统。尽管旧版本没有强大的事务支持，但[InnoDB](http://www.innodb.com/)等事务存储引擎已经可用一段时间了。目前[围绕](http://www.mysql.com/news-and-events/sun-to-acquire-mysql.html)Sun 收购的政治已经产生[了](http://www.oracle.com/corporate/press/2005_oct/inno.html) [代码](http://www.oracle.com/corporate/press/2006_feb/sleepycat.html) [分叉](http://news.oreilly.com/2008/07/mysql-forks-could-drizzle-be-t.html)，MySQL 环境[有些混乱，](http://ronaldbradford.com/blog/understanding-the-various-mysql-products-variants-2009-03-13/)[5.1 版本中的质量问题](http://monty-says.blogspot.com/2008/11/oops-we-did-it-again-mysql-51-released.html)存在争议。 然而，MySQL 是迄今为止最受欢迎和最著名的开源数据库管理系统，并且是唯一在开源圈子之外具有显着品牌知名度的系统。

[Firebird](http://www.firebirdsql.org/)是 Interbase 的开源版本。最后我看了一下，它没有 XA 支持，但如果您的应用程序设置为两层客户端-服务器系统，那就没问题了。 **更新：**我找不到关于此的明确规范，但文档确实表明它支持两阶段提交，但我能找到的并没有具体说明它是否支持 XA 协议。该文档暗示 JDBC 驱动程序确实支持两阶段提交。

该系统上一个有趣的变体是[Fyracle](http://www.janus-software.com/fb_fyracle.html)，它旨在提供与 Oracle 的一定程度的兼容性。它最初是为用作[Compiere](http://www.compiere.com/)的后端而开发的，它是针对 Oracle 构建的，并且与它非常紧密地耦合。

[Ingres](http://www.ingres.com/)现在可以通过开源许可证获得，但开源社区对它的欢迎是集体打了个哈欠。然而，它功能丰富且非常成熟——我知道有人在 1990 年做 INGRES 应用程序，它可以追溯到 1980 年代。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-05T00:35:11.353

我的建议？不。最好买一个。对会计有更多了解的人已经编写了已经处理 GAAP 的好包。他们拥有比以往任何时候都更大的用户群，这将更快地发现缺陷。这是经典的“购买与构建”。编写自己的代码对您的公司没有竞争优势。如果您这样做是因为您担心许可证成本，我会说您没有正确考虑开发时间。这是您可以证明在内部进行此操作的唯一方法。

话虽如此，如果您担心 SQL Server 许可成本，我建议您首先选择 PostgreSQL 或其次选择 MySQL。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-05T00:53:32.347

我非常同意 duffymo 和 tuinstoel 等人的回答。重新考虑您的构建与购买决定。给你讲个故事吧：

当我在一家中型公司（国际，年收入超过 1 亿美元）工作时，CFO 决定用 Oracle Financials 取代财务系统。只有那个包不完全符合这家公司使用的会计惯例。

因此，首席财务官聘请了一组合同程序员，并付钱让他们根据首选的会计实践定制 Oracle Financials。她花费了 12 个月的时间，100 万美元的程序员工资，加上软件的初始成本，只是为了复制他们打算更换的会计系统。

她说，如果她必须重新做一遍，她会购买商业包，但将公司的会计习惯调整为软件支持的默认设置。这会更容易、更快，也更有可能成功。

因此，请考虑构建您自己的定制包的成本。还要考虑贵公司在维护、调试和增强该软件方面的持续成本。即使购买六位数的商业包，也可能比支付程序员开发和维护这样一个系统的费用要便宜。

* * *

为了更直接地回答您提出的问题，我认为 PostgreSQL 和 MySQL 之间没有与您的项目相关的显着差异。既然您对 MySQL 很熟悉，那么您也可以使用它。

我想提供一个强制性提醒，不要使用不精确的数据类型，如`FLOAT`财务`DOUBLE PRECISION`数据。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-05T01:49:28.130

对于**任何**想要使用开源数据库的应用程序，最简单的答案是 Postgres。它比 MySQL 更“为企业做好准备”，更不用说它更好地遵循 SQL 标准。MySQL 在其更高版本中得到了很大改进，但 Postgres 在各个方面都胜过它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-05T00:41:51.807

有开源的免费会计系统。像 osFinancials。我真的不明白你为什么要建立自己的系统？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-05T01:23:40.257

对于您的应用程序，这并不重要。从 sqlite 到 MySQL 到 Postgres 的任何东西都可能工作得很好。选择你最熟悉的那个。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-05T01:38:19.243

火鸟 - [http://www.firebirdsql.org/](http://www.firebirdsql.org/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-05T01:55:30.130

如果您熟悉 MySQL，请使用它。但是选择合适的数据库引擎而不是默认的 MyISAM

[存储引擎列表](http://solutions.mysql.com/engines.html)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-05T04:36:59.040

老实说，*任何*通常的嫌疑人都会做这项工作。维护会计科目表和相关数据表是驱动大多数关系模型的根本问题。事实上，如果您考虑会计系统的一般日记帐视图，您*所拥有*的只是会计科目表和一般日记帐，由交易编号、日期、描述、借方帐户和金额、贷方帐户和金额组成。您所做的其他一切都是对它们的 SELECT 。

~~尽管如此，有这么多完全足够、经过充分测试和接受的财务包，包括开源免费（如啤酒）版本，除非你是指练习曲、学习项目，否则我会把我的努力在谷歌上搜索并选择一个。~~

看到你的更新。问题是，这是一个主要由非功能性需求决定的问题。您打算将数据库分布在多台服务器上吗？你期望多少负载？每秒交易量还是每天交易量？在过去的几年里，我围绕这两个方面构建了系统，通常最重要的是可靠性和可用性要求：PostgreSQL 通过强制行原子性和序列化并发更新更有效地处理单行的并发更新。另一方面，MySQL 似乎更好地处理非常大的数据库。然而第三个问题是备份——其中一个（我现在不记得是哪一个）或多或少需要一些停机时间来备份。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-02T09:48:11.393

对于内部基于 Web 的会计应用程序，您最好将 Gemstone 作为免费但非开源的对象数据库，将 Seaside 作为 Web 框架。否则称为玻璃。

对于内部应用程序，开发人员的工作量将受到限制。Gemstone，作为一个 smalltalk 图像，提供了迄今为止最好的开发人员生产力。它支持在更改对象定义时迁移对象，从而实现真正的迭代开发。Seaside 将模板替换为精心设计的特定领域语言，用于构建 Web 应用程序。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-09-04T07:12:03.843

我在 PostgreSQL 上构建[会计软件。](http://ledgersmb.org)它工作得很好。我会极力推荐它。事实上（无耻的插件），您可能会考虑与我们合作以改进我们的项目并将其用作起点。

具体有几个原因：

1.  LISTEN/NOTIFY 使您能够在发生变化时将其他程序挂接到您的会计数据库中，而无需经常检查表。
2.  我们发现大多数复杂查询的性能都非常好。

Firebird 和 Ingres 将为您提供非常可靠的关系解决方案。MySQL 我不推荐，因为您实际上将所有内容都绑定到一个只能写入数据库的应用程序（sql 模式汤意味着关系基本上是一个私有 API，而不是它们在 PostgreSQL、Firebird 和 Ingres 中的公共 API），并且这意味着未来的灵活性会降低。

但是，使用 PostgreSQL，您可以在一个盒子中获得一流的、可扩展的开发平台。发展速度快。它坚如磐石。高级功能*非常有用。*你不会失望的。我们没有去过。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-05T00:50:08.013

如果这是一个桌面应用程序，您可能需要查看 SQLite。它在公共领域是众所周知的，而且使用起来并不难。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2009-01-05T00:34:23.833

由于您**不需要**存储过程，因此请将其从列表中删除。

将业务逻辑放在代码中，而不是在数据库中，您会更高兴。如果您有机会开始“清理”，那么将数据库用于最有意义的事情——持久性而不是处理。

一旦你做出决定，MySQL 和 PostgreSQL 之间的细微差别就消失了。两者都是处理几乎相同 SQL 的关系引擎。专注于他们最擅长的事情。

**建议**：使您的应用程序独立于任何数据库特性。

# java - 覆盖 JComponent.getBaselineResizeBehavior() 但保持 Java5 兼容性

> ID：411982
> 
> 赞同：4
> 
> 时间：2009-01-05T00:26:17.253
> 
> 标签：java, swing, baseline

对于我的 Swing 项目，我需要同时支持**Java 5**和**Java 6**。我已经定义了一个自定义`JComponent`（调用它`Picture`），并且在将它嵌入到 a 之后`JScrollPane`，我将它放入`JPanel`使用 DesignGridLayout 管理器的 a 中。

得益于**swing-layout**开源库，DesignGridLayout 支持基线对齐（实现对 Java 5 的基线支持并提供与新的 Java 6 基线支持的兼容性）。

我的`Picture`类*覆盖* `public int getBaseline(int width, int height)`，以便我可以为它定义一个正确的基线。请注意，“*覆盖*”并不完全正确：它覆盖了 Java6 上的方法，但在 Java5 中定义了它。

当我在 Java5 上运行我的示例应用程序**时，一切都很好**：`Picture`我定义的基线被正确使用。

但是，**当我使用 Java6 时**，我的`Picture#getBaseline()`方法不会被调用！当然**，我的图片的基线对齐很糟糕**（居中）。

在检查 Java6 源代码后，我看到，在 中`BasicScrollPaneUI`，`getBaseline()`首先调用`getBaselineResizeBehavior()`视口组件（我的`Picture`实例）。并且`getBaseline()`只有在`getBaselineResizeBehavior()`返回时才会调用`Component.BaselineResizeBehavior.CONSTANT_ASCENT`。

现在我的问题是这是我无法在 Java5 中实现`getBaselineResizeBehavior()`的 Java6 方法，因为它返回 Java5中不存在的枚举。`JComponent``Component.BaselineResizeBehavior`

所以我的问题（最后）是：我如何实现（或模拟？）`getBaselineResizeBehavior()`以便我的类仍然可以在 Java5 环境中编译和运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-05T10:13:55.210

> 如何实现（或模拟？） getBaselineResizeBehavior() 以便我的类仍然可以在 Java5 环境中**编译和运行？**

您无法使用 Java 5 库编译此方法声明，因为类型[Component.BaselineResizeBehaviour](http://java.sun.com/javase/6/docs/api/java/awt/Component.BaselineResizeBehavior.html)不存在：

```
public Component.BaselineResizeBehavior getBaselineResizeBehavior() 
```

您必须使用 Java 6 进行编译。如果您编译到 1.5 目标，您的类仍然可以在 Java 5 上运行，但您必须注意它们可以优雅地处理缺失的类型/方法。在遇到这些情况时为它们添加测试。确保开发人员在签入之前尝试在 Java 5 上运行他们的代码。

比如这个类...

```
public class MyPanel extends javax.swing.JPanel {

    public java.awt.Component.BaselineResizeBehavior getBaselineResizeBehavior() {
        return java.awt.Component.BaselineResizeBehavior.OTHER;
    }

    public static void main(String[] args) {
        new MyPanel();
        System.out.println("OK");
    }

} 
```

[...可以使用javac](http://java.sun.com/javase/6/docs/technotes/tools/#basic) JDK 编译器按如下方式编译和运行：

```
X:\fallback>javac -version
javac 1.6.0_05

X:\fallback>javac -target 1.5 MyPanel.java

X:\fallback>"C:\Program Files\Java\jre1.5.0_10\bin\java.exe" -cp . MyPanel
OK 
```

所有流行的 IDE 都提供了生成旧类版本的选项。当您需要决定代码路径时，您可以使用反射在运行时测试方法/类型是否存在。

未能设置目标将导致如下错误：

```
Exception in thread "main" java.lang.UnsupportedClassVersionError: Bad version n
umber in .class file
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClass(Unknown Source)
    at java.security.SecureClassLoader.defineClass(Unknown Source)
    at java.net.URLClassLoader.defineClass(Unknown Source)
    at java.net.URLClassLoader.access$100(Unknown Source)
    at java.net.URLClassLoader$1.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    at java.lang.ClassLoader.loadClassInternal(Unknown Source) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-05T11:10:54.563

我会创建一个 Picture 的子类，可能称为 PictureJava6，它实现了 getBaselineResizeBehaviour()，并且在创建 Picture 实例时，执行以下操作：

```
public Component pictureFactory() {
    if(javaVersion > "1.6") {
        return new PictureJava6();
    } else {
        return new Picture();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-05T00:40:49.547

您可以使用反射尝试按名称获取 CONSTANT_ASCENT 返回值。如果不能反映，你是J5，否则是J6。这避开了显式依赖并允许编译到 J5。

跟随。是为对话模式执行此操作的示例：

```
try {
    Field  fld=Class.forName("java.awt.Dialog$ModalExclusionType").getField("TOOLKIT_EXCLUDE");
    Method mth=getClass().getMethod("setModalExclusionType",new Class[]{fld.getType()});
    mth.invoke(this,new Object[]{fld.get(null)});
    }
catch(Throwable thr) {
    log.errorln("Unable to configure window to be unaffected by modal dialogs - dialogs may need to be closed to operate help.");
    log.errorln("Use Java 6 or later to avoid modal dialogs conflicting with the help system.");
    log.errorln("Exception: "+thr);
    } 
```

**更新：我最初发布了 J5 代码注释掉的代码；我已经改变了这一点，因为我意识到它暗示 J5 代码在 J6 中不起作用，从而混淆了问题——它确实如此。**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-05T02:19:32.857

我认为在解析虚函数和重载时，返回类型不被视为方法签名的一部分；可能是您可以定义“覆盖”方法以返回 Object，并根据我的第一个答案反映返回 Enum。由于您在 J5 中进行编译，因此不会出现编译时冲突，但 JVM 仍应选择您的方法来覆盖......它*可能会*或可能会引发运行时异常。尽管如此，还是值得一试。

例如：

```
public Object getBaselineResizeBehavior() {
    Object ret;
    // reflect out the return value
    return ret;
    } 
```

任何错误处理都可以是 System.out，纯粹用于调试，因为除非您是 J6，否则不会调用它，因此如果调用，正确编码的反射应该始终有效。

当然，我会评论这种方法，以明确发生了什么。**********************