# StackOverflow 问答 000462000-000462999

# crystal-reports - Crystal Reports 8，共享变量和公式

> ID：462003
> 
> 赞同：0
> 
> 时间：2009-01-20T16:19:33.573
> 
> 标签：crystal-reports

[是的，仍然与此问题](https://stackoverflow.com/questions/450469/crystal-reports-no-rowset-was-returned-for-this-table-query-or-procedure-cra)和[其他问题](https://stackoverflow.com/questions/460494/crystal-will-disappear-when-previewing-a-subreport)中的报告相同。是的，我知道，我是 CR 菜鸟 :-) 无论如何，我已经仔细浏览了 Google，并且弹出了很多关于如何使用共享变量的教程，但我似乎无法掌握它的工作原理，因为我无法实现什么我需要。

这些是我的公式：（ActiveAttSaldo，在正资产子报表中创建）同时打印记录；全局编号var att_saldo；att_saldo := 总和 ({@ImportoEuroConto}, {SP_EstrattoConto.TipoConto})

（PassSaldo，在负资产子报表中创建）同时打印记录；全局编号var pass_saldo := 0; pass_saldo := 总和 ({@ImportoEuroConto}, {SP_EstrattoConto.TipoConto})

（UtileSaldo，在主报告中创建）同时打印记录；共享编号var ut2_saldo；ut2_saldo := {@AttSaldoShared}-{@PassSaldoShared};

如果 ut2_saldo > 0 则 'UTILE: '+ToText(ut2_saldo) else if ut2_saldo = 0 then 'Pareggio' else 'PERDITA: '+ToText(ut2_saldo)

（PassSaldoShared，在主报告中创建）同时打印记录；全局编号var pass_saldo；pass_saldo;

（AttSaldoShared，在主报告中创建）同时打印记录；全局编号var att_saldo；att_saldo;

这个想法是有一个“最终平衡”，但变量总是 0，所以我总是看到“Pareggio”而不是正确的值。所有公式都正确放置：

*   ActiveAttSaldo 放置在组页脚 1（活动资产子代表）中 - 按“TipoConto”分组
*   PassSaldo 放置在组页脚 1（被动资产子代表）中 - 由 TypoConto 分组
*   UtileSaldo、AttSaldoShared 和 PassSaldoShared 都在同一部分中声明，这是由 CodiceSocieta（CompanyCode，英文）分组的组页脚 1b（在组页脚 1a 中，两个子报表都存在）。

据我所知，这应该是做事的正确方法（但我可能是错的，那就是...... :D）而且我无法查明问题所在。你能帮帮我吗？

最好的祝福，

安德鲁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T16:24:01.223

好的，我设法通过使用 6（六）个公式来做到这一点，报告顶部的两个用于声明变量并将变量初始化为 0（零），每个子报告两个用于计算总和，最后两个在主报告中实际显示价值观:-)

无论如何，我们重新编写了报告（感谢我们的一位 SQLServer 大师），现在几乎所有的复杂性（子代表、共享变量）都消失了！呜呜呜呜呜呜！:-)

然而，我对我的任何问题都没有收到任何答案感到震惊，其中一些问题仍然 - 但是 - 打开，因为我仍然无法理解例如为什么，哦，为什么！？！，Crystal会崩溃或简单地消失而没有留下任何可能发生的事情的暗示。我知道没有错误日志，事件查看器中也没有明显的迹象，**没有任何东西**可以解释这些怪人。

谢谢大家的时间，

安德鲁

# algorithm - 匹配计数条件的小数

> ID：462027
> 
> 赞同：0
> 
> 时间：2009-01-20T16:24:09.960
> 
> 标签：algorithm, language-agnostic, ternary-representation

对于所有长度为 36 的三进制数（包括以 0 开头的三进制数），有多少个具有完全相同的 1 和 2 计数，或者恰好多 1 比 2？

例如：

*   00 - 是
*   01 - 是的
*   02 - 没有
*   10 - 是的
*   11 - 没有
*   12 - 是的
*   20 - 没有
*   21 - 是的
*   22 - 没有

因此，对于所有长度为 2 的三进制数，9 种可能性中有 5 种匹配。这大概会随着长度的增加而变小。对于长度 3，27 个中有 13 个。

如果我们正在处理二进制数，这里有许多可用的解决方案[，](http://gurmeetsingh.wordpress.com/2008/08/05/fast-bit-counting-routines/)但我不清楚如何将这些推广到三进制数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T16:43:52.573

作为一个组合练习，这个过程似乎很简单。对于 [1..18] 中的每个 N，在 36 位三元串中找到“1”的所有不同排列。然后将其乘以 N“2”在未被“1”占据的位置上的不同排列的数量，对于 N-1 个“2”也是如此。求这 36 个数字的总和。毕竟，为 N=0 添加 1，这是所有“0”的三元串。

在一个 36 长的 tritstring 中 N 个 trit 的不同排列的数量应该是

```
36! / N!(36-N)! 
```

这个问题听起来像是一个脑筋急转弯。我没有进一步开发上述内容，但我高度怀疑存在快捷方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T17:32:59.977

我的一个朋友给了我以下答案，他的数学知识比我多。我已将此标记为“社区”，因为这不是我的工作。

您需要知道每个（大多数？）组合的方式数，而不仅仅是等于 1s/2s。EG 你可以把 +18 和 -18 放在一起得到相等数量的 1 和 2

```
18
0/0
0/1
...
0/18
1/0
1/1
...
1/17
...
18/0 
```

直接求解似乎容易得多。

```
0/0
1/0
1/1
2/1
2/2
3/2
3/3
...
18/17
18/18 
```

做组合学

```
0/0 = 1 way
1/0 = (36C1) = 36 possibilities
1/1 = (36C1) * (36-1C1) = 1260 possibilities
2/1 = (36C2) * (36-2C1) = 21420
2/2 = (36C2) * (36-2C2) = 353430
3/2 = (36C3) * (36-3C2) = 3769920
3/3 = (36C3) * (36-3C3) = 38955840
4/3
4/4
5/4
5/4

18/17 = (36C18) * (36-18C17) = 163352435400
18/18 = (36C18) * (36-18C18) = 9075135300 
```

用于打印 bc 行的 Perl 脚本，因为我懒得编写代码来很好地平衡乘法和除法。

```
sub print_choose
{
    $n = $_[ 0 ];
    $c = $_[ 1 ];

    if( $c == 0 ) { print "1"; return; }

    for( $j = 0; $j < $c; ++$j ) {
        if( $j ) { print "*"; }
        print $n - $j;
    }
    for( $j = 0; $j < $c; ++$j ) {
        print "/", $c - $j;
    }
}

for( $i = 0; $i <= 18; ++$i ) {
    if( $i > 0 ) {
        print_choose( 36, $i );
        print "*";
        print_choose( 36 - $i, $i - 1 );
        print "\n";
    }

    print_choose( 36, $i );
    print "*";
    print_choose( 36 - $i, $i );
    print "\n";
}

foo.pl | bc | perl -ne '$sum += $_; print "$sum\n"'
1
37
1297
22717
376147
4146067
43101907
335270707
2453494507
14315547787
78370635499
355942682251
1512492877051
5477807830651
18506699821051
54336152794651
148388466850351
357393609196351
798626687482351
1592846228397151
2943019447952311
4906907767305271
7584937293695671
10709305074484471
14094036837005671
17218404617794471
19862100432308071
21750454585532071
22964396541176071
23611832250852871
23913968915368711
24027270164562151
24062676804935101
24071007779140501
24072477951059101
24072641303494501
24072650378629801 
```

# python - Python / Perl 的 XML-RPC 和 Continuum

> ID：462038
> 
> 赞同：2
> 
> 时间：2009-01-20T16:27:39.390
> 
> 标签：python, perl, xml-rpc, continuum

有没有人使用 Python 或 Perl 通过 Xml-rpc 获取数据取得任何成功......？

我正在使用 continuum.py 库：

```
#!/usr/bin/env python

from continuum import *

c = Continuum( "http://localhost:8080/continuum/xmlrpc" ) 
```

或者：

```
#!/usr/bin/perl

use Frontier::Client;

my $url = "http://dev.server.com:8080/continuum/xmlrpc";

my $client = RPC::XML::Client->new($url);

my $res = $client->send_request('system.listMethods');

print "   Response class = ".(ref $res)."\n";
print "   Response type = ".$res->type."\n";
print "   Response string = ".$res->as_string."\n";
print "   Response value = ".$res->value."\n"; 
```

给出：`No such handler: system.listMethods`

有人过得更好吗...？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-31T10:11:11.627

您所描述的不是客户端库的一部分 - 这是服务器是否实现这些方法的问题。

我是[RPC::XML](http://search.cpan.org/dist/RPC-XML) Perl 模块的作者，在我提供的服务器类中，我还提供了基本“自省”API 的实现，它已成为 XML-RPC 领域的一种半标准。但即便如此，服务器类的用户也可能选择不激活自省 API。

当然，我不能谈论其他 XML-RPC 实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T09:59:57.537

是的……使用 Perl。

我用过[XML::RPC](http://search.cpan.org/dist/XML-RPC/)。事实上，我编写了 CPAN 模块[WWW::FreshMeat::API](http://search.cpan.org/dist/WWW-FreshMeat-API/)使用它来访问 Freshmeats XML-RPC API，所以我知道它运行良好！

将 XML::RPC 与 Freshmeat 一起使用，“system.*”调用对我有用....

```
use XML::RPC;
use Data::Dumper;

my $fm = XML::RPC->new( 'http://freshmeat.net/xmlrpc/' );

# need to put in your Freshmeat username/password here
my $session = $fm->call( 'login', { username => 'user', password => 'pass' });

my $x = $fm->call('system.listMethods');

say Dumper( $x ); 
```

给我....

```
$VAR1 = [
        'system.listMethods',
        'system.methodHelp',
        'system.methodSignature',
        'system.describeMethods',
        'system.multiCall',
        'system.getCapabilities',
        'publish_release',
        'fetch_branch_list',
        'fetch_project_list',
        'fetch_available_licenses',
        'fetch_available_release_foci',
        'fetch_release',
        'login',
        'logout',
        'withdraw_release'
      ]; 
```

希望有帮助。

# c# - .Net Excel 插件帮助

> ID：462039
> 
> 赞同：1
> 
> 时间：2009-01-20T16:27:54.990
> 
> 标签：c#, .net, excel, add-in

我有兴趣为 Office 2003 和 2007 为工作和家庭创建几个加载项。我在 VS2008 中看到了用于创建插件的项目模板，但我不清楚下一步该做什么。到目前为止，我也很难在网上找到方向。我不是在寻找剪切和粘贴代码，而是指向*Hello World*方向的手指，用于使用 VS8 的模板创建插件。

先感谢您！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T16:41:51.937

当我需要编写 Word 插件时，这篇文章让我开始：http:
[//support.microsoft.com/kb/302896](http://support.microsoft.com/kb/302896)

这是我*实际*的“Hello World”代码！:-)

```
public void OnStartupComplete(ref System.Array custom)
{
    System.Windows.Forms.MessageBox.Show("Hello World!");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T16:51:53.443

我不确定你到底想做什么，但[这里](http://msdn.microsoft.com/en-us/office/bb496949.aspx)有一堆视频可能会告诉你方法。

编码快乐！！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-20T19:05:47.793

感谢您的时间和回复！

在*gkrodgers*和*Perpetualcoder 的*响应之间，我被带到了我的最终目的地 -->[演练：为 Excel 创建您的第一个应用程序级插件](http://msdn.microsoft.com/en-us/library/cc668205.aspx)

为什么我有这么多时间首先找到这个是我无法理解的。

谢谢你们两个给我的手指！;)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T16:52:58.747

最近我开始为 ms 项目编写一个 ui 应用程序。Vs2008 做了一个了不起的工作，使它变得非常容易。我使用了 c#（以前根本没有使用过），我发现最有效的方法是结合查看导入包的 API 和编辑器的代码完成工具。但我同意，试图找到教程甚至是好的 Api 文档并不好玩……来自 Java 世界。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-20T16:53:58.637

对于办公自动化，最好的工具是 VSTA：用于自动化的 Visual Studio 工具。

这将包括用于开发办公插件等的 SDK/IDE 等。

# java - J2ME 中的正则表达式

> ID：462048
> 
> 赞同：7
> 
> 时间：2009-01-20T16:30:26.857
> 
> 标签：java, regex, java-me

如果我想在 JavaME 中实现一个正则表达式引擎（缺少正则表达式库），从哪里开始最好？我想象那里有现有的正则表达式代码，可以用作移植的起点。

如果做不到这一点，一个关于如何编译和执行正则表达式的好指南就可以了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T16:39:20.133

您能否调查第三方 RegEx 库，例如[http://www.brics.dk/~amoeller/automaton/](http://www.brics.dk/~amoeller/automaton/)？

您能否分析您的需求并将您的需求简化为不需要 RegEx 库的东西？

# iphone - 在 Objective-C 中作为外部类委托

> ID：462062
> 
> 赞同：3
> 
> 时间：2009-01-20T16:34:51.373
> 
> 标签：iphone, objective-c, xcode, delegates, external

我正在使用 Xcode 和 Interface Builder 为 iPhone 创建一个简单的项目。虽然我了解什么是委托，但我在使用它时遇到了问题。

我的界面中有一个 UITextField 。当用户点击它时它会显示键盘，但我需要手动编程如何隐藏键盘。可以使用委托来完成。所以在 IB 中，我从库中获取对象，将它的类名指定为 Control1Delegate，然后将我的文本字段中的委托出口连接到这个 Control1Delegate。我也有这个 Control1Delegate 类的 .m 和 .h 文件：

Control1Delegate.h

```
@interface Control1Delegate : NSObject <UITextFieldDelegate> {
}

- (BOOL) textFieldShouldReturn:(UITextField *)textField;

@end 
```

Control1Delegate.m

```
#import "Control1Delegate.h"

@implementation Control1Delegate

- (BOOL) textFieldShouldReturn:(UITextField *)textField {
    [textField resignFirstResponder];
    return YES;
}

@end 
```

但这不起作用。运行时，它永远不会到达 textFieldShouldReturn 方法，或者在没有 msg 或 EXEC_BAD_ACCESS 的情况下崩溃。有趣的是，当我将方法移动到控制器文件（已生成一个向导）并从 UITextField 连接到此控制器（文件所有者）时，一切都按预期工作。我看到大多数苹果代码教程将委托方法放入随机对象而不是单独的类中 - 我想知道为什么。我不能在单独的班级中有代表吗？

我在这里缺少什么？一些空指针？对象生命周期？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T17:41:14.017

您的 Control1Delegate 对象在创建后不久就会被销毁。如果要让它们保持活动状态，则必须保留所有顶级 Nib 对象。请参阅[资源编程指南：Nib 对象生命周期](https://developer.apple.com/iphone/library/documentation/Cocoa/Conceptual/LoadingResources/CocoaNibs/chapter_3_section_4.html)。

文件的所有者可以有这样的属性，以保留对象：

```
@property (nonatomic, retain) IBOutlet Control1Delegate *control1delegate; 
```

记住在不再需要对象后释放它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T17:16:16.937

您可以将委托方法放在任何类中，包括专为此目的而构建的方法。Apple（和其他程序员）通常不专门为委托函数创建类的原因是它变得过于复杂且难以共享数据。例如，在我的一个项目中，我可能会创建一个 Window Controller 子类来处理来自窗口的委托方法、窗口内的表视图和窗口的工具栏。操作和维护该窗口状态所需的一切都在一个控制器类中。现在想象三个独立的类（可能加上一个管理它们的控制器类）执行相同的功能——这是很多额外的工作，没有真正的好处。

至于它为什么崩溃，听起来你在应用程序的其他地方犯了内存管理错误。您可以使用调试器准确跟踪它的来源。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T19:27:24.613

谢谢你俩。我现在不仅知道如何解决我的问题，而且终于明白了对象在 Nib 创建过程中是如何保留的。在 IB 中创建对象是不够的，如果它是一个新实体，它必须连接到 File's Owner 中的真实 ivar（使用正确合成的 getter/setter）。

# python - Python 与 Netbeans 6.5

> ID：462068
> 
> 赞同：1
> 
> 时间：2009-01-20T16:37:53.927
> 
> 标签：python, netbeans, project

你能给我一些链接或解释如何在 Netbeans 上配置现有的 python 项目吗？这些天我正在尝试它，它继续崩溃，代码导航也无法正常工作，而且我在调试时遇到问题。当然，这些问题与我对 python 的低经验有关，我在组织源文件夹、导入 ecc 等琐碎的事情上也需要支持，非常感谢。瓦莱里奥

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T16:48:32.720

Python 支持处于测试阶段，作为过去 2 年使用 NB 的人，我可以说即使是发布版本也存在错误，有时会崩溃。早期的 Ruby 支持也很不稳定。

# sql-server-2005 - SQL order by 和 left outer join 没有正确的顺序

> ID：462071
> 
> 赞同：2
> 
> 时间：2009-01-20T16:38:31.240
> 
> 标签：sql-server-2005, left-join, sql-order-by

我有一个视图，它连接两个表并按第一个表排序。除了顺序不正确。它错过了一个偶然的记录，然后在最后，大多数记录按顺序存在，然后在最后，其余记录按顺序存在。所以它有记录，如

```
1  (most of the records in order)
2
4
5
6
7
8
10
11
13
15
3  (the first set of missing records)
12
9 (the rest of the missing records)
14 
```

我的看法如下。在我加入之前我需要做订单吗？我究竟做错了什么？（我已经获得了这个视图，并且另一个数据库实例中完全相同的视图可以正常工作。）

```
CREATE VIEW [dbo].[SampleView]
AS
SELECT     TOP 100 PERCENT blp.*, ISNULL(YEAR(DATEADD(month, 2, tb.[End of D&D])), 0) AS DEMO_FY
FROM         dbo.Table1 AS blp LEFT OUTER JOIN
                      dbo.Table2 AS tb ON blp.FACIL_NAME = tb.[Structure ID]
ORDER BY blp.ID 
```

（编辑）排序字段的类型是 [ID] [int] NOT NULL IDENTITY(1, 1)，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T16:46:07.293

阅读[在 SQL Server 2005 和 SQL Server 2008 中创建排序视图](http://blogs.lessthandot.com/index.php/DataMgmt/DataDesign/create-a-sorted-view-in-sql-server-2005--2008)有一个修补程序，您必须在 2000 兼容模式下运行它才能工作。为什么不只是在从视图中选择时进行排序？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T16:47:52.003

我会从视图中完全删除 ORDER BY 子句。相反，请在查询视图时指定您的订单。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-20T17:05:35.710

[此](http://cf-bill.blogspot.com/2007/01/sql-server-order-view.html "这")博客条目中的评论非常清楚。

再次来自 BOL 的文本：

> “当在视图、内联函数、派生表或子查询的定义中使用 ORDER BY 时，该子句仅用于确定由 TOP 子句返回的行。当这些构造为时，ORDER BY 子句不保证有序结果查询，除非在查询本身中也指定了 ORDER BY。”
> 
> “虽然视图定义包含一个 ORDER BY 子句，但该 ORDER BY 子句仅用于确定 TOP 子句返回的行。在查询视图本身时，SQL Server 不保证结果将被排序，除非您明确指定，如以下查询所示：

```
SELECT * FROM TopView
ORDER BY LastName 
```

"

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T16:43:24.693

这两个 SQL Server 很可能是略有不同的版本。有一个已知的修补程序：

[http://support.microsoft.com/kb/926292/](http://support.microsoft.com/kb/926292/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-20T17:15:09.700

您应该始终在最后一个可能的点“排序”，因为排序很慢（N log N）。当您对视图执行选择时，通常会包含一个 where 子句。您只想对该结果集进行排序。

# java - 如何一般地指定一个可序列化列表

> ID：462077
> 
> 赞同：12
> 
> 时间：2009-01-20T16:40:23.110
> 
> 标签：java, generics, serialization

我有以下界面：

```
public interface Result<T extends Serializable> extends Serializable{
    T getResult();
} 
```

使用该接口，我无法定义类型的变量

```
Result<List<Integer>> 
```

因为 List 不可序列化。

但是，如果我将界面更改为此：

```
public interface Result<T> extends Serializable{
    T getResult();
} 
```

现在通过编译时检查变得不可能实现，因为不能保证 T 是可序列化的，并且该类的全部目的是存储结果，以便我以后可以取回它，可能在通过 Internet 传输之后.

我的问题是，有没有一种方法可以声明一个变量，使其具有两种类型，或者是否有其他一些我没有看到的方法来做到这一点？所以，也许是这样的：

```
(List<Integer> extends Serializable) value = new ArrayList(); 
```

我试图把这个问题的负担尽可能多地放在实现上，这样这个接口的未来消费者就不会意识到这个问题。

谢谢你的帮助！

这是我正在尝试做的更详细的示例：我正在调用服务器，我想将其结果存储在结果对象中，但我不想处理强制转换。因此，每个可以在服务器上调用的方法都将使用泛型定义结果的类型。此结果对象还将存储有关结果的其他元数据，例如可能返回的信息太多。在许多情况下，我想使用一个列表，但 List 接口是不可序列化的，尽管许多实现是可序列化的。

那么，如何指定使用的类型必须是可序列化的，但仍允许使用 List（而不是 List 的特定实现）？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-22T16:23:33.343

您需要将变量类型声明为`Result<? extends List<Integer>>`.

类型检查知道`List`is not `serializable`，但是`List`can be的子类型`serializable`。

这是一些示例代码。接口实现只是用匿名内部类完成的。您可以看到将在第二个对象上`getResult`返回 a`List<Integer>`

```
 Result<Integer> res = new Result<Integer>() {

        Integer myInteger;

        private static final long serialVersionUID = 1L;

        @Override
        public Integer getResult() {
            return myInteger;
        }

        @Override
        public void addResult(Integer input) {
            this.myInteger = input;
        }
    };

    Integer check = res.getResult();

    Result<? extends List<Integer>> res2 = new Result<ArrayList<Integer>>() {

        ArrayList<Integer> myList;

        private static final long serialVersionUID = 1L;

        @Override
        public ArrayList<Integer> getResult() {
            return myList;
        }

        @Override 
        public void addResult(ArrayList<Integer> input) {
            this.myList = input;
        }

    };

    List<Integer> check2 = res2.getResult(); 
```

编辑：通过实现`void addResult(T input)`接口方法使示例更加完整

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-22T16:53:59.837

尽管 List 接口没有实现 Serializable，但所有内置的 Collection 实现都可以。这在集合[实现教程](http://java.sun.com/docs/books/tutorial/collections/implementations/index.html)中进行了讨论。

Collections Design FAQ 有一个问题[“为什么 Collection 不扩展 Cloneable 和 Serializable？”](http://java.sun.com/javase/6/docs/technotes/guides/collections/designfaq.html#5) 其中谈到了为什么 Sun 在没有扩展 Serializable 的情况下设计了它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-20T17:11:25.887

您可以简单地将变量声明为`Result<ArrayList<Integer>>`. 只要您仍然对`List`界面进行编程，就没有真正牺牲可替换性。

我还建议创建一个新界面`ListResult`：

```
public interface ListResult<T extends Serializable & List<E extends Serializable>>
        implements Result<T> {
    T getResult();
} 
```

但是您仍然必须将变量声明为`ListResult<ArrayList<Integer>>`. 所以我会走更简单的路线。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T17:10:22.940

如果您的意图是对列表使用 Result 类型，并且您想要确保列表的元素是可序列化的，您可以这样定义它：

```
public interface Result<T extends List<? extends Serializable>> {} 
```

这样，您可以定义如下内容：

```
Result<List<Integer>> r; 
```

但是这样的东西不会编译：

```
Result<List<List>> r; 
```

现在，如果您想将结果同时用于 Integer 和 List，那么类型不需要是可序列化的，对吗？在那种情况下，我真的不明白你的目标是什么。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-20T17:20:18.537

你有点可以，我认为：

```
public class Thing<T extends Serializable> implements Serializable {
    private static class Holder<V extends Serializable> {
        private final V value;
        private Holder(V value) {
            this.value = value;
        }
    }
    private Holder<? extends List<T>> holder;
    private <V extends List<T> & Serializable> void set(V value) {
        holder = new Holder<V>(value);
    }
} 
```

这对你来说看起来够丑吗？

我可以建议您不要尝试`Serializable`使用 Java 静态类型系统来强制实施吗？它只是一个接口，因为当时还没有注释。执行它是不切实际的。OTOH，您可以使用在封闭系统中进行静态分析的类型检查器来强制执行它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-20T20:38:50.943

我最终解决此问题的方法是将其用作接口：

```
public interface Result<T> extends Serializable{
    T getResult();
} 
```

然后为每种不同类型的集合以及任何对象创建一个实现。

因此，例如，这里是 ListResult 类的样子：

```
public class ListResult<T> implements Result<List<T>>{
    public List<T> getResult(){
        //return result
    }

    public <V extends List<T> & Serializable> void setResult(V result){
        //store result
    }
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-01-20T16:50:07.550

最初的想法。如果您打算将序列化用于任何类型的长期数据存储，请不要。不保证序列化在 JVM 的调用之间起作用。

除非您添加与对象序列化相关的功能，否则您可能不应该扩展 Serializable。相反，实现 Result 的类也应该实现 Serializable。

# php - 如何配置 Apache/PHP 以接受查询字符串中的斜杠？

> ID：462082
> 
> 赞同：6
> 
> 时间：2009-01-20T16:41:22.360
> 
> 标签：php, apache, apache2, query-string

我有两台运行 PHP 的 Apache 服务器。一个接受查询字符串中的正斜杠并以预期的方式将其传递给 PHP，例如：

```
http://server/index.php?url=http://foo.bar

```

有效，在 PHP 中这个表达式为真：

```
$_REQUEST['url'] == "http://foo.bar" 
```

但是，在*其他*Apache 服务器中，相同的 URL 会导致`403 Forbidden`错误！请注意，如果查询字符串正确地进行了 URL 转义（即使用`%2F`而不是正斜杠），那么一切正常。

很明显，导致这种情况的 Apache 或 PHP 配置存在一些差异，但我不知道是什么原因！

我想在这两种情况下都*接受*这种形式的 URL，而不是拒绝它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2011-11-29T02:05:12.250

这里的一些帖子表明 OP 的用法是错误的，这是错误的。

扩展 Sam152 的评论，查询字符串允许同时包含 ? [和 / 字符，请参阅http://www.ietf.org/rfc/rfc3986.txt](http://www.ietf.org/rfc/rfc3986.txt)的第 3.4 节，这基本上是 Tim Berners-Lee 和朋友编写的规范 web 应该如何运行的规范。

问题在于编写不佳（或配置不当或滥用）的解析器将查询字符串斜杠解释为分隔路径组件。

我已经看到了用于解析 URL 的 PHP 的 pathinfo 函数的示例。Pathinfo 不是用来解析 URL 的。但是，您可以使用 parse_url 提取路径，然后使用 fileinfo 从路径中检索详细信息。您将看到 parse_url 处理 / 和 ? 在查询字符串中就好了。

无论如何，总的问题是，即使在经验丰富的开发人员中，对这个领域的全面了解也很少，而且大多数人（直到最近还包括我自己）只是假设文件名之后的任何内容都必须进行 urlencoded，如果您这样做，这显然是错误的考虑标准。

tl;博士阅读规范:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T19:36:05.627

`http://server/index.php?url=http://foo.bar`不是有效的网址。您必须对斜杠进行编码。我认为浏览器会自动执行此操作，所以也许您正在使用不同的浏览器进行测试？

或者可能是[AllowEncodedSlashes](http://httpd.apache.org/docs/2.2/mod/core.html#allowencodedslashes)设置？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T19:46:46.133

在您的 Apache 配置中：

```
AllowEncodedSlashes On 
```

有关更多信息，请参阅文档：
[http ://httpd.apache.org/docs/2.2/mod/core.html#allowencodedslashes](http://httpd.apache.org/docs/2.2/mod/core.html#allowencodedslashes)

编辑：嗯，这可能是你已经在工作的......我遇到了同样的问题，最终为我解决的问题是只使用`$_SERVER['REQUEST_URI']`我需要的数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-05T22:22:15.557

你`mod_security`安装了吗？看到这个线程：

[403 Forbidden on PHP page called with url encoding in a $_GET 参数](https://stackoverflow.com/q/1089744/212218)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-20T17:37:25.380

这听起来像是默认magic_quotes_gpc 的另一种情况。在导致问题的服务器上检查 php.ini 并确保

```
magic_quotes_gpc = Off 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-01-20T19:21:23.830

您没有指定 PHP 对这个 url 做了什么。它会重定向到此页面还是尝试阅读它？

可能有一些 mod_rewrite 规则来删除双斜杠，或者出于其他目的，它试图将其重定向到不应该的地方。

也许在 http:// 之前没有 ^ 的正则表达式

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-01-20T19:41:21.230

> 请注意，如果查询字符串正确地进行了 URL 转义（即使用 %2F 而不是正斜杠），那么一切正常。

因此，当查询字符串格式正确时它可以工作，而当它不是时则不起作用。有什么问题？

# javascript - 使用 window.location 查询页面的 GET 参数是否安全？

> ID：462084
> 
> 赞同：3
> 
> 时间：2009-01-20T16:41:39.177
> 
> 标签：javascript, dom

我正在进行同行评审，我发现人们使用 window.location.search 来检查哪些参数已发送到给定（搜索）页面。

这样做安全吗？我在想我们可能可以在脚本块内的 HTML 输出中打印参数并验证打印的变量，而不是查询 window.location。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-20T16:44:13.197

如果启用了 javascript，`window.location.search`则可以安全使用。

就像一些无用的进一步信息一样：据我所知，该属性是在 Netscape Navigator 2 / MS Internet Explorer 3 中引入的，所以我认为它使用起来非常安全，即使它不是任何标准的一部分（但）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T16:51:57.283

像“安全”一样安全还是“这将永远有效”？

尽管 window.location 很广泛，但它仍然不是 W3C 标准的一部分。然而，它在 2006 年被添加到工作草案规范中：基本上意味着浏览器可能支持也可能不支持它。所以从“这将永远有效”，我猜你会抓住一个小机会。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T16:56:38.770

关于这种方法需要注意的一点。 `window.location`在页面加载时静态设置，并且不会检测到用户在那之后对地址栏所做的更改。这不应该是一个问题，但重要的是要知道。

将以下代码保存为 html 文件并在浏览器中启动它：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <title>test</title>
    </head>
    <body>
        <a href="javascript:void(0);" 
                onclick="alert(window.location);">click me</a>
    </body>
</html> 
```

“点击我”锚点将显示当前窗口位置`onclick`。但是，如果您在地址栏中添加任何内容并再次单击该链接，它将报告与第一次相同的内容。

希望这不是问题，我无法想象它会以任何方式影响您，但很高兴知道。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T23:34:59.373

> 这样做安全吗？

是的。将参数作为名称-> 值映射获取参数的示例代码，假设您不需要每个参数有多个值：

```
function getParameters() {
    var parameters= new Object();
    var parts= window.location.search.substring(1).split('\x26');
    for (var parti= parts.length; parti-->0;) {
        var subparts= parts[parti].split(';'); // support semicolon separators as well as ampersand (see HTML 4.01 section B.2.2)
        for (var subparti= subparts.length; subparti-->0;) {
            var parparts= subparts[subparti].split('=', 2);
            if (parparts.length==2)
                parameters[decodeURIComponent(parparts[0])]= decodeURIComponent(parparts[1]);
        }
   }
   return parameters;
} 
```

# flash - 从投影仪闪光灯执行外部 exe

> ID：462088
> 
> 赞同：3
> 
> 时间：2009-01-20T16:41:57.473
> 
> 标签：flash, actionscript-3

我们有一个从 AS3 编译的投影仪应用程序 (.exe)。我们如何从投影仪启动另一个（外部）可执行文件？

这是代码......它没有任何可见的。

```
//Play ACQ Demo
Acq.addEventListener(MouseEvent.CLICK, clickAcq);
function clickAcq(event:MouseEvent):void {
                flash.system.fscommand("exec",".\\ACQ\\Acq.exe");
                trace("ACQ clicked");
                gotoAndPlay("Main");
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-20T16:49:51.000

文档说您要执行的程序应该位于投影仪 exe 旁边的“fscommand”文件夹中。（你可以放一个bat文件来启动其他程序）

[http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/system/package.html](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/system/package.html)

编辑：如果您想要更高级的选项，您可以尝试使用第三方工具，例如[http://www.northcode.com/](http://www.northcode.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-02-21T18:36:23.850

这个免费的实用程序[http://www.northcode.com/blog.php/2007/08/07/Conquering-FSCommand-EXEC-Part-1-Proxy](http://www.northcode.com/blog.php/2007/08/07/Conquering-FSCommand-EXEC-Part-1-Proxy)让您可以解决 Flash 中 EXEC fscommand 的一些限制。

# java - 在java中，如何创建一个具有私有构造函数的类，其超类也有一个私有构造函数？

> ID：462094
> 
> 赞同：5
> 
> 时间：2009-01-20T16:44:36.190
> 
> 标签：java, constructor

举个例子：

```
public class Foo {
    private Foo() {}
}

public class Bar extends Foo {
    private Bar() {}

    static public doSomething() {
    }
} 
```

那是一个编译错误。一个类至少需要隐式调用其超类的默认构造函数，在这种情况下，它在*Foo*中不可见。

我可以从*Bar调用**Object*的构造函数吗？

 ** * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-20T16:47:24.703

你不能。您至少需要将 Foo 的构造函数包设为私有（尽管我可能只是将其设为受保护的。

（编辑 - 这篇文章中的评论是一个很好的观点）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-21T10:14:23.263

这实际上是一种不良继承形式的症状，称为实现继承。要么原始类没有被设计为被继承，因此选择使用私有构造函数，或者整个 API 设计不佳。

解决此问题的方法不是找出继承的方法，而是查看是否可以组合对象而不是继承，并通过接口来实现。即，类 Foo 现在是接口 Foo，带有 FooImpl。那么界面bar可以扩展Foo，带有一个与FooImpl无关的BarImpl。

在 BarImpl 内部，如果您希望进行一些代码重用，您可以在内部有一个 FooImpl 作为成员，但这完全取决于实现，不会暴露。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-20T16:47:31.800

只要 Foo 具有私有构造函数，您就无法创建 Bar 的实例。你能做到的唯一方法是如果 Foo 有一个受保护的构造函数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T16:50:46.130

当它是 Foo 的子类时，您不能直接从 Bar 调用 Object 的构造函数，它必须通过 Foo 的构造函数，在这种情况下它是私有的。

当您将 Foo 的构造函数声明为私有时，它不会创建默认的公共构造函数。由于 Bar*必须*调用 Foo 的构造函数，因此不可能将其保留为私有。和其他人一样，我建议使用受保护的而不是私有的。

# linux - 用于创建指向共享库的符号链接的 Bash 脚本

> ID：462100
> 
> 赞同：7
> 
> 时间：2009-01-20T16:46:40.960
> 
> 标签：linux, bash, scripting, java-native-interface, shared-libraries

我认为这个问题对于你的 shell 脚本怪物来说是相当容易的。

我正在寻找通过 bash shell 脚本创建指向 Unix 共享库的符号链接的最优雅和最短的方法。

我需要从共享库文件列表开始，例如“libmythings.so.1.1，libotherthings.so.5.11”，获取创建的符号链接，例如：

```
libmythings.so -> libmythings.so.1 -> libmythings.so.1.1
libotherthings.so -> libotherthings.so.5 -> libotherthings.so.5.11 
```

库文件位于包含其他文件（例如其他 shell 脚本）的目录中。

**编辑**：嗯，“ldconfig -nN”。可以正常工作，但我还需要没有在“.so”之后附加库的主要编号的链接，至少是其中一个库，因为一个或多个库是来自 Java 的 JNI 调用的入口点，所以当一个库通过 System.loadlibrary("libraryname") 实例化它需要一个名为“libraryname.so”的库，而不是“libraryname.so.X”。

如果有针对 Java 部分的解决方法，那么仅使用 ldconfig -nN 的解决方案就可以工作。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-20T16:56:48.443

我相信`ldconfig`这是执行此操作的标准工具。

我记得在某个地方它可以根据内部版本信息生成符号链接，但现在找不到源。

**编辑**是的，如果你运行

```
ldconfig -v 
```

您将看到它根据库内部生成所有链接。

```
ldconfig /path/to/dir 
```

只会为该目录中的文件创建链接

不过需要注意的是，我玩过它，它似乎并没有始终如一地创建 .so$，只是 .so.{major}

我不确定它的内部是如何工作的，但我知道：

```
lib # rm libmagic.so
库#rm libmagic.so.1
库#ldconfig
lib # 文件 libmagic.so.1   
libmagic.so.1：指向“libmagic.so.1.0.0”的符号链接
lib # 文件 libmagic.so
libmagic.so：无法打开“libmagic.so”（没有这样的文件或目录）

```

所以是什么决定了它是如何工作的，对我来说是个谜

**进一步区分后编辑**，.la 文件对行为没有影响。

“SO”名称字段指示符号链接将被调用。

而且只会有一个。

0x000000000000000e (SONAME) 库 soname: [libmagix.so]

这是在破解代码并将“.1”替换为空格之后。

ldconfig 生成“libmagic.so”（是的，包括空格）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-20T16:58:40.157

```
for baselib in "$@"
do
     shortlib=$baselib
     while extn=$(echo $shortlib | sed 's/\.[0-9][0-9]*$//')
           [ -n "$extn" ]
     do
         shortlib=$(basename $shortlib $extn)
         ln -s $baselib $shortlib
     done
done 
```

我作弊了——所有链接都指向基础库（libmythings.so.1.1）；如果你真的想链接，那么你需要：

```
for baselib in "$@"
do
     shortlib=$baselib
     while extn=$(echo $shortlib | sed 's/\.[0-9][0-9]*$//')
           [ -n "$extn" ]
     do
         shorterlib=$(basename $shortlib $extn)
         ln -s $shortlib $shorterlib
         shortlib=$shorterlib
     done
done 
```

当心 - 未经测试的代码。

* * *

傲慢先于克星。

评论到达，上面的代码不起作用 - 并且评论是正确的。原位测试的固定版本是：

```
set -- libname.so.5.1.1

for baselib in "$@"
do
    shortlib=$baselib
    while extn=$(echo $shortlib | sed -n '/\.[0-9][0-9]*$/s/.*\(\.[0-9][0-9]*\)$/\1/p')
          [ -n "$extn" ]
    do
        shortlib=$(basename $shortlib $extn)
        echo ln -s $baselib $shortlib
    done
done 
```

更改在`sed`命令中。这个版本默认不打印任何东西`-n`（修改后，脚本生成以下输出。删除 echo 以使其执行链接命令。

```
ln -s libname.so.5.1.1 libname.so.5.1
ln -s libname.so.5.1.1 libname.so.5
ln -s libname.so.5.1.1 libname.so 
```

该脚本说明了有关 shell 脚本的一个有趣且经常被忽视的点：while 条件块中的操作序列不必是单个命令。编辑操作所在行的状态不影响整体测试是否成功；最后一个命令 ' ' 的退出状态`[ -n "$extn" ]`控制循环是否继续。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-11-15T23:30:51.897

源自 Jonathan Leffler 的脚本（我已将其添加为我的 ~/bin 中名为 'liblinks' 的脚本）

```
#!/bin/bash
# liblinks - generate symbolic links 
# given libx.so.0.0.0 this would generate links for libx.so.0.0, libx.so.0, libx.so
#

# By adding sudo to the ls command, we get permission to do the linking (or get an empty list)
LIBFILES=`sudo ls lib*.so.*`
for FILE in $LIBFILES;
   do
   echo $FILE
    shortlib=$FILE
    basename=$FILE
    while extn=$(echo $shortlib | sed -n '/\.[0-9][0-9]*$/s/.*\(\.[0-9][0-9]*\)$/\1/p')
          [ -n "$extn" ]
    do
        shortlib=$(basename $shortlib $extn)
        sudo ln -fs $basename $shortlib
        basename=$shortlib
    done

   done 
```

# java - 在 Java 中获取驱动器名称（而不是驱动器号）

> ID：462110
> 
> 赞同：12
> 
> 时间：2009-01-20T16:48:56.743
> 
> 标签：java, windows

在我的 Windows 机器上，我的主硬盘驱动器有字母 C: 和名称“本地磁盘”。

要在 Windows 上以 Java 列出驱动器号，File 对象具有静态 listRoots() 方法。但我找不到在 Windows 上获取驱动器名称（而不是驱动器号）的方法。

有没有人试过这个？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-20T16:52:20.543

是的，您需要获取 FileSystemView 对象并使用[getSystemDisplayName](http://java.sun.com/javase/6/docs/api/javax/swing/filechooser/FileSystemView.html#getSystemDisplayName(java.io.File))。（我曾经用 Java 实现了一个文件系统浏览器）。

虽然它并不完美，但它会让你得到名字。从文档中：

> 将在系统文件浏览器中显示的文件、目录或文件夹的名称。Windows 示例：“M:\”目录显示为“CD-ROM (M:)” 默认实现从 ShellFolder 类获取信息。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-21T01:39:29.370

实际上，要获取驱动器名称（例如本地磁盘），您需要使用 getSystemTypeDescription。getSystemDisplayName 返回卷名。

```
import java.io.File;
import java.util.Arrays;
import java.util.List;
import javax.swing.filechooser.FileSystemView;

public class Test2 {
    public static void main(String args[]){

      List <File>files = Arrays.asList(File.listRoots());
      for (File f : files) {
        String s1 = FileSystemView.getFileSystemView().getSystemDisplayName (f);
        String s2 = FileSystemView.getFileSystemView().getSystemTypeDescription(f);
        System.out.println("getSystemDisplayName : " + s1);
        System.out.println("getSystemTypeDescription : " + s2);
      }
      /* output (French WinXP)

          getSystemDisplayName : 
          getSystemTypeDescription : Disquette 3½ pouces

          getSystemDisplayName : REGA1 (C:)
          getSystemTypeDescription : Disque local

          getSystemDisplayName : 
          getSystemTypeDescription : Lecteur CD

          getSystemDisplayName : My Book (F:)
          getSystemTypeDescription : Disque local
      */
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-11T23:30:37.330

使用[WMI](http://en.wikipedia.org/wiki/Windows_Management_Instrumentation)（通过[JACOB](http://sourceforge.net/projects/jacob-project/)或[com4j](https://github.com/kohsuke/com4j)）是另一种选择。

`FileSystemView.getSystemDisplayName`不给你原始卷标。它是驱动器号和卷标的组合，如果未设置标签，则为默认值。

WMI 将为您提供原始卷标，以及其他一些信息，例如驱动器是否可移动（令人惊讶的`FileSystemView.isFloppyDrive()`是，它没有告诉您这一点；它的字面意思是“它是软盘吗？”）

# nhibernate - NHibernate.Search，未创建 Lucene 索引文件

> ID：462111
> 
> 赞同：0
> 
> 时间：2009-01-20T16:49:00.610
> 
> 标签：nhibernate, lucene.net, castle-activerecord, nhibernate.search

我遇到了 NHibernate.Search 的问题，它突然停止工作，它根本无法创建文件或读取索引文件。

NHibernate 似乎可以正确加载它：

```
2009-01-20 17:37:17,751 [1] 调试 NHibernate.Impl.SessionFactoryImpl -
  使用属性实例化会话工厂：{use_reflection_optimizer=True,
  hibernate.search.analyzer=Lucene.Net.Analysis.SimpleAnalyzer, Lucene.Net,
  hibernate.search.default.directory_provider=NHibernate.Search.Store.FSDirectoryProvider,
  NHibernate.Search, dialect=NHibernate.Dialect.PostgreSQL82Dialect,
  connection.driver_class=NHibernate.Driver.NpgsqlDriver,
  hibernate.search.default.indexBase.create=true,
  hibernate.search.default.indexBase=c:\temp\Lucene,
  connection.provider=NHibernate.Connection.DriverConnectionProvider,
  connection.connection_string_name=开发者}

```

但在那之后，似乎没有任何效果。没有文件被创建，并且 c:\temp\Lucene 也从未被创建。我已经检查了权限，我似乎找不到任何问题。

这对我来说已成为死胡同，并且不知道如何进行调试。非常感谢任何反馈。

好的，更新：

我发现 FullTextIndexEventListener.Initialize(NHibernate.Cfg.Configuration cfg) 永远不会被调用。

我假设当将监听器添加到 NHibernate 配置时会触发它（因为它实现了 NHibernate.Event.IInitializable），但是在检查 NHibernate 的源时，这似乎不是这种情况？

奇怪的是，它可以在我的同事开发机器上运行，而无需手动调用。我们运行相同的源代码以及相同的库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T14:47:41.247

好的，发现不知何故，我的机器一直在加快 ActiveRecord 和 NHibernate 之间的初始化阶段，这意味着自从我将 EventListeners 注册到 NHibernate On_ApplicationStart() 后，NHibernate 已经初始化，因此永远不会在侦听器中调用 Initialize()。

在我同事的计算机上，NHibernate 在注册事件侦听器时尚未初始化，因此调用了 Initialize。

这是 ActiveRecord 设计中的一个缺陷，因为我需要先初始化 AR，然后才能将某些内容注册到 NHibernate。有点像第22条。

希望有人会发现此信息有用。

# flash - Flex VideoDisplay 停止缓冲

> ID：462114
> 
> 赞同：3
> 
> 时间：2009-01-20T16:49:49.830
> 
> 标签：flash, video, apache-flex, h.264

我正在尝试使用 Adob​​e Flex 和 libh264streaming 构建视频播放器应用程序。在小盒子里，我的小播放器工作得很好。

但是，如果视频更大，大约 200-300MB，我会看到很多问题：

1.  浏览器崩溃。
2.  它永远不会停止缓冲，一直下载直到获得整个视频（300M）。
3.  CPU使用率随着浏览器内存消耗而上升。

我猜 1\. 和 1\. 是造成 2\. 因为播放器需要越来越多的内存来存储视频。

我想以某种方式限制缓冲区大小，并在达到上限后立即停止下载视频。我认为 YouTube 视频播放器就是这样工作的（查看播放器底部的播放器控件）。

任何想法如何在 Flex 中实现它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T06:51:18.803

“libh264streaming”到底是什么？在谷歌上搜索它只会找到这个带有确切文本的线程。根据您的描述，听起来它根本没有流式传输视频，而只是提供渐进式下载。

渐进式下载有时被错误地称为流式传输。它只是一个普通的 HTTP 文件下载，只要视频头在文件的开头，Flash 就会开始播放文件，只要它有头加上一定的最小视频数据量（4 个关键帧我相信）。渐进式下载传统上不提供带宽限制或流式传输的其他优势，但最近一些提供了慢速下载的实现，这更接近于流式传输，并且可以在文件中间开始渐进式下载（动态重写标题）以允许人们跳转到中间没有下载整个东西。

Flash Player 仅支持 RTMP 流式传输。这是 Flash Media Server 和 Red5、rubyizumi 等几个开源选项支持的专有协议。Adobe 就在两天前宣布将发布 RTMP 并提供开放许可，因此您应该会在不久的将来看到更多支持 RTMP 的产品。流式传输提供与客户端和服务器的双向通信，因此服务器发送请求数量的帧作为缓冲区，客户端请求帧以根据需要填充缓冲区。服务器发送的内容不超过请求的内容，服务器可以搜索到各个点，只需要刷新缓冲区，而不是整个视频。

如果你想提供大文件，你可能需要一个真正的流媒体服务器。一种替代方法是将文件分解成块，根据需要下载它们并一个接一个地播放。这也会很复杂，但可行。

高温下，

山姆

* * *

我们正在招聘！华盛顿特区（或希望搬迁）的开发人员和 QA 应将简历发送至 careers@blinemedical.com。

* * *

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T15:56:21.057

我能够在 2 个 VideoDisplay 对象的基础上创建一个组件，这些对象以块的形式加载 mp4 文件（比如每个有 1 分钟的缓冲区）。一旦主显示器达到某个点（在我的情况下为缓冲区大小的 50%），辅助 VideoDisplay 就会开始加载视频。主视频完成后，组件立即切换到辅助显示。

这种方法使用 mod_h264_streaming 效果很好。搜索操作几乎可以立即工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T14:52:00.363

我猜这个问题还没有人回答的部分原因是因为没有很好的答案。我当然不是 Flash 流媒体奥秘方面的专家，但我猜是为了至少发布一些东西来回应你，我猜，从阅读文档并亲自尝试一些事情，你正在尝试不能用 VideoDisplay 对象完全在 Flex 环境中完成；它可能需要在服务器上处理，或者至少在服务器和客户端之间处理，以便流得到正确传递和终止，并且 VideoDisplay 对象正常运行。

对不起，我希望我有一个更好的答案给你；如果还有其他人这样做，请随时加入。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T00:57:41.093

很难确定，但看起来你提到的 lib 提供了一些控制机制来告诉服务器你想玩哪个块（我从他们网页上的声明中得到这个：......“你真的长视频剪辑，您不想将它们重新编码成更小的部分？我们还支持“虚拟视频剪辑”，因此您可以指定只播放视频的一部分或创建视频特定部分的下载链接。 "

对我来说，您似乎只需要添加一个控制结构，允许您（告诉服务器）以块的形式获取视频。

如果由于某种原因无法做到这一点，并且您只能访问原始数据流：

我需要知道您在 flex 中使用哪些接口来加载视频，但一般来说，您会添加一个接收 ProgressEvent 的侦听器并检查加载的字节（对于通用加载器对象）

您的另一个选择是使用读取和写入方法创建自己的套接字，当数据进入时，您可以使用它来检查字节计数器。您可以将读取的字节放入字节数组中，然后当您有一个可用的块时，您会需要将该字节数组转换为适合播放器对象的格式...

看看 flash.net.Socket

（[http://livedocs.adobe.com/flex/2/langref/flash/net/Socket.html](http://livedocs.adobe.com/flex/2/langref/flash/net/Socket.html)）

# c - 检测到 POSIX 系统上的日志文件已被删除或截断？

> ID：462122
> 
> 赞同：4
> 
> 时间：2009-01-20T16:51:11.590
> 
> 标签：c, unix, file-io, posix, truncate

假设一个长时间运行的进程写入日志文件。假设日志文件无限期地保持打开状态。假设一个粗心的系统管理员删除了该日志文件。程序可以检测到这种情况发生了吗？

假设`fstat()`将报告已删除文件的链接计数为零是否安全？

在我看来，截断有点棘手。部分取决于文件描述符是否在`O_APPEND`模式下运行。如果日志文件没有运行`O_APPEND`，那么程序的日志描述符的当前写入位置不会改变，并且截断会删除前导字节，但程序会继续在“末尾”写入，留下一个幻象零的间隙字节（它们读为零，但不一定占用磁盘空间）。

如果程序以 运行`O_APPEND`，那么它将写入当前存在的文件末尾。观察截断的唯一方法是注意文件位置不是程序预期的位置 - 这反过来意味着明确跟踪该位置。

总的来说，我并不像删除那样担心截断，但任何想法都会受到欢迎。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-20T17:03:34.077

如果文件被硬链接或重命名，则检查`fstat()`返回的链接计数为零将失败。我可能会定期将`stat()`'s 的 inode 编号与`fstat()`'s.

我不确定截断。

`tail -F`检查删除和截断，所以我会检查它的来源，看看它是如何实现的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T18:10:18.903

假设粗心的系统管理员杀死了该进程。你真的想防止管理员做随机的事情吗？我猜您只是在寻找一种不时启动新日志文件的方法，例如使用`logrotate`. 在那里提供一种手动让程序重新打开日志文件的方法就足够了。执行此操作的标准方法是侦听程序中的 HUP 信号，如果到达则重新打开日志文件：

```
#include <signal.h>

volatile int f_sighup;

void sighup_handler() {
  f_sighup = 1;
}

void trap_sighup() {
  struct sigaction sa;
  int rv;

  memset(&sa, 0, sizeof(struct sigaction));
  sa.sa_handler = &sighup_handler;
  rv = sigaction(SIGHUP, &sa, NULL);
  if (-1 == rv) {
    fprintf(stderr, "warning: setting SIGHUP signal handler failed");
  }
}

int main() {
  f_sighup = 0;
  trap_sighup();
  ...
} 
```

然后定期检查`f_sighup`主程序中的标志，看看是否应该重新打开日志文件。这与类似的工具配合得很好`logrotate`，它可以重命名旧的日志文件，然后调用`kill -s HUP $PID`. 粗心的系统管理员可以在删除（或更好地重命名）旧日志文件后手动执行此操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T17:06:51.167

您可以使用[inotify](http://www-128.ibm.com/developerworks/linux/library/l-inotify.html)监视您的日志文件，监视它的文件系统事件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-12-29T23:09:29.340

回应[søren-holm](https://stackoverflow.com/users/1651834/s%c3%b8ren-holm)的[回答](https://stackoverflow.com/a/37835392)

> 关闭文件时，修改时间会更改。

这似乎不正确：

```
import os
from time import sleep

TMPF = '/tmp/f'

def print_stats():
    print("%s, %s" % (os.stat(TMPF).st_mtime, os.stat(TMPF).st_ctime))
    sleep(1.1)

print("Opening...")
with open(TMPF, 'w') as f:
    print_stats()
    print("Writing...")
    os.write(f.fileno(), 'apple')
    print_stats()
    print("Flushing...")
    f.flush()
    print_stats()
    print("Closing...")

print_stats() 
```

产生：

```
Opening...
1483052647.08, 1483052647.08
Writing...
1483052648.18, 1483052648.18
Flushing...
1483052648.18, 1483052648.18
Closing...
1483052648.18, 1483052648.18 
```

诚然，其中有一点 Python 的魔力。不能合理地保证`write()`自动刷新，但重点是 mtime 在文件被修改时更新，而不是在文件关闭时更新。的行为`ctime`将取决于您的文件系统及其挂载选项。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2016-06-15T12:25:00.880

关闭文件时，修改时间会更改。因此，使用 stat() 定期检查 mtime 将起作用。

# .net - ClickOnce 部署的应用程序可以从磁盘读取文件吗？

> ID：462133
> 
> 赞同：1
> 
> 时间：2009-01-20T16:53:24.440
> 
> 标签：.net, clickonce, sandbox, file-access

.Net 中通过 ClickOnce 交付的应用程序可以从用户磁盘读取 Excel 和 Access 文件吗？

我知道该应用程序应该在沙箱中运行，我很好奇这个沙箱与系统的其余部分是如何分区的？

可以从网络共享以及用户硬盘驱动器读取文件吗？

假设用户具有对相关文件的读取权限。

谢谢你，
基思

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T17:05:47.927

是的，它可以，但你需要给它正确的权限。

在属性页的安全选项卡中，勾选“启用 ClickOnce 安全设置”，使其成为完全信任的应用程序，或者使其成为部分信任的应用程序，但要特别赋予它 FileIO 权限。

# version-control - Tortoise CVS - 防止用户在分支中提交更改？

> ID：462144
> 
> 赞同：1
> 
> 时间：2009-01-20T16:58:23.073
> 
> 标签：version-control, cvs, tortoisecvs

如何防止开发人员将更改提交到 CVS 中的特定分支？

最近，一位开发人员将代码提交到主分支，让我有很多回滚工作**;-(**我怎样才能防止这种情况发生？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-08T00:18:17.777

可能不是这样，但如果您在服务器上运行 CVSNT，您可以简单地使用该`cvs chacl`命令。有关详细信息，请参阅[http://cvsnt.org/manual/html/chacl.html](http://cvsnt.org/manual/html/chacl.html)。我有一段时间没有使用 TortoiseCVS，但我想那里甚至可能有一个 GUI 选项（你的服务器仍然必须是 CVSNT 才能真正工作）。

请注意，TortoiseCVS 只是 CVSNT 客户端的图形前端。如果您提供了有关服务器的一些信息，您的问题将更容易回答。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T17:06:19.500

将此用户对该特定分支的访问权限更改为只读。

老实说，我没有头绪。但这可能会有所帮助：[CVS 访问控制列表扩展补丁](http://cvsacl.sourceforge.net/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-09-09T09:00:44.297

这种方法对我有用：-

1) 创建一个 shell 脚本，根据参数检查提交的分支。为方便起见，我将它存储在 CVSROOT 中，但它可以位于 CVS 服务器上的任何位置。

```
#!/bin/bash

if [ -f CVS/Tag ]
then
  TAG=`cat CVS/Tag`
else
  TAG=THEAD
fi

if [ "$TAG" == "T$1" ]
then
  echo Cannot commit to $1
  exit 1
else
  echo Commit ok
fi
exit 0 
```

然后修改 commitinfo 文件以针对特定分支运行此脚本：-

```
ALL /cvs/repos/CVSROOT/checkbranch.sh YOUR-BRANCH-NAME-HERE 
```

这将导致脚本为所有签入运行。它将分支名称作为参数传递。该脚本会将参数与正在签入的代码的分支进行比较，如果它们匹配，则会抛出错误。如果要锁定多个分支，则在 commitinfo 中添加多行。

显然，如果开发人员真的想提交某些东西，他们可以破解 commitinfo 文件，但它可以防止错误，而不是故意尝试破坏。

# visual-studio - Visual Studio 2008 中的 SSRS：相对图像路径？

> ID：462148
> 
> 赞同：1
> 
> 时间：2009-01-20T17:01:09.230
> 
> 标签：visual-studio, visual-studio-2008, reporting-services, report

我有一个需要在多个报告的标题中重复的标题图像。我知道您可以将图像添加到报告中并指向图像文件所在的路径，例如`file://C:\path\to\Reports\Images\logo.gif`，但是在部署应用程序时该路径可以并且将会改变。

我尝试使用相对路径（假设报告在`Reports/`文件夹中）`Images/logo.gif`（或`Images\logo.gif`），但这只会在设计器和实际输出中产生损坏的图像。我的语法不正确吗？如果没有，有没有办法做这样的事情？

编辑：我也知道将图像嵌入到报告中，但是这个图像需要嵌入到每个报告中，如果需要更改，则必须在每个报告中单独更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T17:36:52.857

将路径存储在数据库中的变量中，并且只保留表中每个图像的字段名称。在运行您的应用程序时将它们放在一起。

因此，您将拥有一张带有图像的表格：

```
record1 otherdata image1.gif
record2 otherdata image2.gif 
```

和另一个具有系统变量的表，包括

```
imagepath  c:\path\to\reports\images\ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T18:27:06.710

我们有动态标题标志。我们只是将图像存储在数据库中，这样更容易。徽标足够小，不会对性能造成太大影响。

Image 控件上的 Image 属性：

```
=First(Fields!BlobData.Value, "spimGetReportImg") 
```

**spimGetReportImg 数据集**只是调用我们用来获取正确图像的存储过程。IE：

```
CREATE PROCEDURE [dbo].[spimGetReportImg]
@pk
AS 
BEGIN
SET NOCOUNT ON
SELECT b.BlobData
FROM   dbo.tblBlob b
WHERE  pkBlob = @pk 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-02T21:37:22.880

[这篇博文](http://www.haveyougotwoods.com/archive/2009/01/28/relative-path-to-an-external-image-in-reporting-services.aspx)中描述了我们最终所做的事情。我们认为这是一个足够好的解决方案，即使路径目前是硬编码的。

# random - VB6：列出可用命令，然后随机执行其中一个

> ID：462150
> 
> 赞同：0
> 
> 时间：2009-01-20T17:01:21.430
> 
> 标签：random

你好！我是n00b，我正在寻找VB6中的几行代码来实现这一点：我想列出一定数量的要执行的命令，然后告诉我的程序在其中随机选择一个并执行它：严格来说，我正在处理一个 MSAgent 角色，我希望他每 5 分钟做一次脸。请问我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T17:17:55.263

```
Public Sub MakeFace()

  'Reset random seed.
  Randomize

  'Generate a random integer with the specified range.
  Dim Min As Integer, Max As Integer, N As Integer
  Min = 1
  Max = 5
  N = Min + Round(Rnd) * Max

  'Select and call the desired function.
  Select Case N

    Case 1
      Call MakeHappyFace

    Case 2
      Call MakeSadFace

    Case 3
      Call MakeAngryFace

    Case 4
      Call MakeSmirkFace

    Case 5
      Call MakeFunnyFace

  End Select

End Sub 
```

# maven-2 - 在 Maven 站点生命周期中存在哪些范围

> ID：462151
> 
> 赞同：0
> 
> 时间：2009-01-20T17:01:33.380
> 
> 标签：maven-2, findbugs

在为 Maven 站点生成报告期间，哪些 Maven 范围可用？有没有可用的。

我正在尝试在几个模块之间共享一个 FindBugs 过滤器文件，而不是让它最终出现在任何应用程序 jar 中。我正在考虑放入一个公共项目，它将它与我们可能拥有的任何其他此类文件的分类器一起打包在一个单独的 jar 中。任何需要它的项目都将使用分类器导入项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T18:47:25.723

使用[checkstyle plugin](http://maven.apache.org/plugins/maven-checkstyle-plugin/examples/multi-module-config.html)，诀窍是将单独的 JAR 声明为插件的依赖项（这也适用于 PMD）。

不幸的是，这不适用于 FindBugs 插件，因为它似乎在文件系统而不是类路径中寻找过滤器。

我要做的是将[依赖项的执行：解包](http://maven.apache.org/plugins/maven-dependency-plugin/unpack-mojo.html)绑定到`pre-site`阶段，以便从存储库中获取单独的 JAR 并将其解包`target`，然后在 FindBugs 插件的配置中使用相对路径引用过滤器文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-12T02:00:37.750

我认为这个问题可以更好地表述为“如何跨项目共享我的 findbug 配置？”

严格来说，范围仅适用于依赖关系解析。插件在给定范围内请求依赖解析。一个阶段或生命周期本身没有范围的概念，因此从技术上讲，这个问题没有答案。;-)

# c# - 从 C# 应用程序启动 C++ 可执行文件并保持基于角色的安全上下文

> ID：462160
> 
> 赞同：0
> 
> 时间：2009-01-20T17:04:26.227
> 
> 标签：c#, c++, security-roles

首先，我知道这可能是一项艰巨的任务，但是...... :)

我们有一些软件可以与我们公司生产的硬件交互。该软件加载一个 .NET 程序集，它充当我们与硬件的接口。

目前我们有一个用 C# 编写的“启动器”应用程序，它提供基于角色的安全性。此“启动器”通过进程启动带有命令行参数（要使用的 .NET 程序集）的 C++ 可执行文件。然后，C++ 可执行文件加载提供的 .NET 程序集并使用它来执行其操作。

问题是因为我在一个进程中启动 C++ 应用程序，我丢失了“启动器”提供的基于角色的安全上下文。

有什么方法可以启动 C++ 应用程序并保持基于角色的安全上下文？

感谢您抽时间阅读。如果您有任何问题，请告诉我。

谢谢，

亚当

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T18:18:36.327

您还必须修改 C++ 应用程序以检查角色。

如果可以这样做，您可能会考虑将 C# 应用程序的一部分分解为多个程序集。具体来说，将角色作为 C# 应用程序的一部分，并将其编译为带有 COM/ActiveX 扩展的 dll。

然后您可以调用 C# dll（通过 COM）来检查权限。

# c++ - 错误：未在此范围内声明“NULL”

> ID：462165
> 
> 赞同：128
> 
> 时间：2009-01-20T17:05:40.377
> 
> 标签：c++, gcc, pointers, null

在 gcc 4.3 上编译 C++ 时收到此消息

```
error: ‘NULL’ was not declared in this scope 
```

它出现又消失，我不知道为什么。为什么？

谢谢。

* * *

## 回答 #1

> 赞同：184
> 
> 时间：2009-01-20T17:14:34.367

`NULL`不是关键字。它是一些标准头文件中定义的标识符。你可以包括

```
#include <cstddef> 
```

将其纳入范围，包括其他一些基础知识，例如`std::size_t`.

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2011-11-30T14:16:45.270

GCC 正在向 C++11 迈进，这可能就是您现在需要包含*cstddef*以使用*NULL*常量的原因。C++11 中的首选方法是使用新的*nullptr*关键字，该关键字在 GCC 4.6 版本中实现。*nullptr*不能隐式转换为整数类型，因此它可用于消除对指针和整数类型都已重载的函数的调用的歧义：

```
void f(int x);
void f(void * ptr);

f(0);  // Passes int 0.
f(nullptr);  // Passes void * 0. 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-20T17:13:58.330

`NULL`不是关键字；它是 0 的宏替换，我相信它是`stddef.h`or 。`cstddef`您没有`#included`合适的头文件，因此 g++ 将`NULL`其视为常规变量名，并且您尚未声明它。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-09-23T17:43:39.063

要完成其他答案：如果您使用的是 C++11，请使用`nullptr`，这是一个关键字，表示指向 null 的 void 指针。（而不是`NULL`, 这不是指针类型）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-01-10T19:28:09.723

您可以将宏声明为 NULL。在你的#includes 之后添加：

```
#define NULL 0 
```

或者

```
#ifndef NULL
#define NULL 0
#endif 
```

不 ”;” 在说明的最后......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-09-14T09:28:42.190

NULL 也可以在以下位置找到：

```
#include <string.h> 
```

String.h 将从其他地方拉入 NULL。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-06-07T10:53:13.457

如果您仔细查看任何 std 标头中的 NULL 宏：

> #define NULL __null

所以基本上，你可以改用`__null`关键字。

# c# - 如何明确丢弃 out 参数？

> ID：462167
> 
> 赞同：114
> 
> 时间：2009-01-20T17:06:12.293
> 
> 标签：c#, out

我正在打电话：

```
myResult = MakeMyCall(inputParams, out messages); 
```

但我实际上并不关心这些消息。如果它是一个输入参数，我不在乎，我只是传入一个空值。如果是我不在乎的回报，我就放弃它。

有没有办法用 out 做类似的事情，还是我需要声明一个我会忽略的变量？

* * *

## 回答 #1

> 赞同：128
> 
> 时间：2016-11-30T13:49:48.210

从 C# 7.0 开始，可以避免预先声明参数以及忽略它们。

```
public void PrintCoordinates(Point p)
{
    p.GetCoordinates(out int x, out int y);
    WriteLine($"({x}, {y})");
}

public void PrintXCoordinate(Point p)
{
    p.GetCoordinates(out int x, out _); // I only care about x
    WriteLine($"{x}");
} 
```

来源：[https ://blogs.msdn.microsoft.com/dotnet/2017/03/09/new-features-in-c-7-0/](https://blogs.msdn.microsoft.com/dotnet/2017/03/09/new-features-in-c-7-0/)

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2009-01-20T17:20:46.833

您必须声明一个变量，然后您将忽略该变量。TryParse（或 TryWhatever）模式最常见的情况是，它用于测试用户输入的有效性（例如，它可以被解析为数字吗？）而不关心实际的解析值。

你在问题中使用了“dispose”这个词，我怀疑这很不幸 - 但是如果 out 参数是实现 IDisposable 的类型，你当然应该调用 Dispose 除非方法文档明确说明接收值不会授予所有权。我不记得曾经见过带有一次性`out`参数的方法，所以我希望这只是一个不幸的选择。

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2009-01-20T17:09:15.423

不幸的是，您需要传递一些东西，因为需要该方法来设置它。所以你不能发送`null`，因为需要设置它的方法会爆炸。

隐藏丑陋的一种方法是将方法包装在另一种`out`为您执行参数的方法中，如下所示：

```
String Other_MakeMyCall(String inputParams)
{
    String messages;

    return MakeMyCall(inputParams, out messages);
} 
```

然后你可以调用`Other_MakeMyCall`而不必摆弄`out`你不需要的参数。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-01-20T18:59:36.590

如果原始函数是这样声明的：

```
class C
{
    public Result MakeMyCall(Object arg, out List<String> messages);
} 
```

你可以像这样声明一个扩展方法：

```
static class CExtension
{
    public static Result MakeMyCall(this C obj, Object arg)
    {
        List<String> unused;
        return obj.MakeMyCall(arg, out unused);
    }
} 
```

扩展方法的行为类似于使 out 参数可选的重载。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-20T17:28:30.190

Visual Basic 编译器通过创建一个虚拟变量来做到这一点。C# 可以做到，如果你能说服微软这是一个好主意。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-20T17:12:06.430

如果类`messages`implements `IDisposable`，你不应该忽略它。考虑类似以下方法（可能在语法上不正确，因为我有一段时间没有编写 C#）：

```
using (FooClass messages) {
    myResult = MakeMyCall(inputParams, messages);
} 
```

一旦出`using`块，`messages`将被自动处置。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-20T17:28:04.417

您必须为 out 参数传递一个变量。您不必在传递变量之前对其进行初始化：

```
MyMessagesType messages;
myResult = MakeMyCall(inputParams, out messages); 
```

通常，您可以在调用后忽略“消息”——除非“消息”出于某种原因需要处理，例如使用有限的系统资源，在这种情况下，您应该调用 Dispose()：

```
messages.Dispose(); 
```

如果它可能会使用大量内存并且会在范围内保留一段时间，那么如果它是引用类型，则应该将其设置为 null，如果它是值类型，则应该将其设置为新的默认实例，以便垃圾收集器可以回收内存：

```
messages = null; // Allow GC to reclaim memory for reference type.

messages = new MyMessageType(); // Allow GC to reclaim memory for value type. 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-11-03T12:01:57.493

在这种情况下，我为没有 Delete 或 Remove 方法的 ConcurrentDictionary 创建了一个通用扩展方法。

```
//Remove item from list and ignore reference to removed item
public static void TryRemoveIgnore<K,T>(this ConcurrentDictionary<K,T> dictionary, K key)
{
    T CompletelyIgnored;
    dictionary.TryRemove(key, out CompletelyIgnored);
} 
```

从 ConcurrentDictionary 的实例调用时：

```
ClientList.TryRemoveIgnore(client.ClientId); 
```

# delphi - Delphi 2007 未正确使用 JAX-WS Web 服务

> ID：462171
> 
> 赞同：3
> 
> 时间：2009-01-20T17:06:38.017
> 
> 标签：delphi, soap, jax-ws

在尝试使用我使用 JAX-WS 在 Java 中设置的 Web 服务时，我遇到了 Delphi 2007 的问题。可以从另一个 Java 程序和 C#/ASP.NET 2.0 网站很好地使用 Web 服务。但是，当我尝试使用 Delphi 2007（17-DEc-2007 补丁）中的 WSDL Importer 访问相同的服务时，JAX-WS Web 服务无法识别我传递的任何参数并将它们设为空。

我检查了 Delphi 传递的 SOAP 消息，并将其与其他消息进行了比较，它们几乎相同（除了一些可忽略的命名空间 decs 和 .NET 的大量视图状态！）

我也浏览过网络（最有用的链接是 Bob 博士的[http://www.bobswart.nl/Weblog/Blog.aspx?RootId=5:798](http://www.bobswart.nl/Weblog/Blog.aspx?RootId=5:798)），但并不高兴。

有没有人遇到过这个？

TIA。

* * *

传奇继续！

在尝试使用 HTTPRIO 对象并尝试使其正常工作后，我最终放弃并尝试了通过 HTTP 的直接 XML 传输。失败。

好的，所以我用 C# 构建了一个简单的测试器并尝试了它。工作没问题。

使用 Fiddler 查看向后和向前发送的内容似乎唯一的区别在于命名空间。我在 Delphi 中更改了 XML 发送中的命名空间，并且......它有效！

这是 WSDLImporter 生成的原始 XML 的示例：

```
<?xml version="1.0"?>
<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/">
    <SOAP-ENV:Body>
        <version xmlns="http://path.to.service.com/">
            <input>test</input>
        </version>
    </SOAP-ENV:Body>
</SOAP-ENV:Envelope> 
```

这是实际有效的：

```
<?xml version="1.0"?>
<S:Envelope xmlns:S="http://schemas.xmlsoap.org/soap/envelope/">
    <S:Body>
        <ns2:version xmlns:ns2="http://path.to.service.com/">
            <input>test</input>
        </ns2:version>
    </S:Body>
</S:Envelope> 
```

那么，既然我知道了这一点，我是否要着手更改 WSDLImporter 代码的名称空间值？我在 HTTPRIO 属性上看不到任何明显的东西。

TIA

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-25T17:37:16.730

哈哈它活着！！！

基本上我不得不拿出推荐的

```
InvRegistry.RegisterInvokeOptions(TypeInfo(ActivityService), ioDocument); 
```

并强制它使用秒。5 编码。根据需要生成命名空间，并将参数传递给 Java Web 服务。

对，需要啤酒，很多啤酒:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-01-31T09:58:26.217

你应该在你的 WSDL 中评论这一行：

```
//InvRegistry.RegisterInvokeOptions(TypeInfo(WebService), ioDocument); 
```

够了……享受吧。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T18:35:56.510

不是您问题的解决方案，但我最近在相同的环境中遇到了麻烦。我不得不多次更改选项，直到找到使用 Web 服务的正确方法（用 C# 编写）。

查看：

```
- THTTPRIO.Converter.Options
- THTTPRIO.HTTPWebNode
- THTTPRIO.HTTPWebNode.InvokeOptions 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-02T15:43:12.803

我用头撞墙了两天，直到找到这篇文章……Cesars 暗示要检查 THTTPRIO.Converter.Options……我几乎尝试了所有方法，最后一个是将 soXXXXHdr 设置为 true -> 然后发生了一些奇怪的事情，服务器不再有空值：O ...

我不知道为什么该设置会使值通过，它只是（至少对我而言）。

如果真正了解正在发生的事情的人能解释这一点，那就太好了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-02-03T12:12:36.877

从 Converter.Options 中删除 soSendMultiRefObj 有助于

# winforms - 你如何为不懂电脑的人实现 UI？

> ID：462176
> 
> 赞同：6
> 
> 时间：2009-01-20T17:07:44.317
> 
> 标签：winforms, web-applications, user-interface

我一直支持一个用户群使用的网络应用程序，该用户群的年龄范围为 40-65 岁。该应用程序非常好，并且有最新的 ajaxy 东西等。我们现在称之为非常用户友好和响应迅速。我很惊讶这个应用程序对那个用户群来说不是那么用户友好。有人告诉我，一些自动完成功能会让他们迷失方向！！此外，还会发生很多意外点击，他们有时会说“它不会通过！” 然后我意识到没有单击所需的复选框之一。我希望我把这个场景说清楚了。

有人可以为此提供资源/提示吗？与其说是可访问性问题。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-20T17:14:01.153

[不要让我思考](https://rads.stackoverflow.com/amzn/click/com/0789723107)

就像一本圣经，必读的讲座

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-20T17:23:19.247

我在 50 多岁的员工使用的应用程序中遇到了类似的问题。

我只是在他们使用应用程序时与他们坐在一起，学到了很多东西。如果他们试图做我认为愚蠢的事情或错过了我认为显而易见的事情，我会问他们他们想要做什么，是什么让他们认为这是解决问题的方法。

确实，很多更有经验的用户会认为是好处，而有用的功能可能只是分散注意力。一定要非常认真地对待用户的反馈。如果您也有精明的用户，他们可能有一个高级模式，可以打开自动完成等。但不要试图认为您最了解，因为某种工作方式可以让您在使用 UI 时更有效地工作.

还。请记住使用易于用鼠标点击的大字体、高对比度和大按钮。我知道您说您没有遇到可访问性问题，但您的用户可能会欣赏这些东西并将其视为对 UI 的改进。我遇到的一个问题是用户似乎不理解图标的含义，文本似乎效果更好。或者，如果您有空间，请在现有图标旁边添加文本。

添加新功能时要非常小心……这些可能会使这类用户非常困惑。他们花了很长时间才弄清楚如何做某事，现在它改变了！因此，如果可能的话，请确保新功能不会过多或完全不影响旧功能。

另一个要考虑的好事情是工作流程。如果你可以组织屏幕元素，让用户可以从上到下以线性方式完成任务，这可能会提高可用性。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-20T18:09:47.623

如果你想要一本很棒的 UI 书籍，试试Donald Norman**的 The Design of Everyday Things**。它与计算机界面无关，但适用于几乎所有 UI 工作。

我的两分钱：使界面与年龄组已经熟悉的东西（可能是 Microsoft Office）保持一致。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-20T17:36:12.467

正如您所看到的，在可用性方面做了大量工作，甚至还有工具可以测试您的网站等等。

但是，如果您可以接触到一些用户并与他们一起进行测试，那是最好的。UI 是一门经验艺术——就像所有的编程一样，我认为——所以如果你可以直接与你的目标宇宙交互，那是最好的。

如果您有一个小样本组进行测试，您会看到用户已经报告的许多事情正在发生，而其他事情则没有。可能只有少数用户（或一个响亮的用户！）对自动完成感到迷失方向，或者可能是所有用户。或者他们可能会学习使用自动完成功能......

在学习方面，您还有另一件事要研究：是否可以培训您的用户？您可以通过网站上的课程或一些介绍页面来做到这一点。我知道这似乎违背了标准的 UI 逻辑（它很直观，不需要培训），但对于从未见过鼠标的人来说，情况就不同了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-20T17:17:11.960

少用它。更少的交互方式意味着更少的事情出错。这并不意味着您必须删除功能，只是隐藏不必要的东西，直到它们适合上下文。GNOME 似乎至少在这部分是正确的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-20T17:35:59.517

我经常发现自动完成功能让人分心。我现在是一个很好的打字员，我通常通过思考这个词来打字，让我的手指来完成剩下的工作。如果我可以输入“餐厅”之类的内容，那就很简单了。如果我必须输入“r”，然后是“e”，然后是“s”，然后是“t”，然后是“a”，然后选择“restaurant”，那需要更多的脑力劳动；同样，如果我必须做一些特别的事情来避免输入“restauranturant”，那会很痛苦。

有些人非常擅长使用鼠标，而有些人则非常笨拙，而且鼠标并不是唯一的指针设备。包括我在内的一些人发现笔记本电脑滑垫真的很笨拙（并且很高兴购买一个像样的 USB 鼠标来插入它既便宜又容易）。

不过，这不一定是问题所在。如果一个框总是或从不需要被选中，首先不要显示它。如果有时需要检查它，那么您需要有一种方法告诉用户该框是问题所在。

一般来说，不要太喜欢炫耀和使用所有整洁的 Web 2.0 玩具。真人并不难找。和两三个人坐下来，看着他们尝试使用你的网站，如果可能的话，请他们大声思考。记下令他们困惑的地方和不喜欢的地方。当您进行更改时，请一两个人再试一次。

请记住，您可以设计一个与人合作的网站。你不能设计人们使用网站。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-20T19:18:40.793

AJAX 风格的自动完成和具有大量字段的表单通常适用于基本上知道自己在做什么并希望尽快完成应用程序的用户。传统意义上，慢而乏味=更痛苦。

听起来对于您的特定用户群，痛苦的定义是不同的。如果这意味着他们一次只需要处理一点点，您的用户可能不介意缓慢地浏览应用程序。也许您想要的是将表单分解为小步骤：一次只显示一个字段并在进入下一个字段之前向用户提供反馈。这为每个步骤的具体说明留出了足够的空间。

自动完成的一种可能替代方法是为常见答案设置单选按钮，其中一个答案是“其他”，并有一个用于输入答案的文本框。当然，这只有在有少量常见答案时才有效。您的用户*可能会*发现这更容易，但我不会假设，甚至不会相信他们的话。如果您有时间，请尝试两种方式实施并观察对用户的影响。自动完成可能更适合特定问题，而单选按钮可能更适合其他问题。

最后一个想法：一点点教育可以走很长的路。您可能想要以某种方式向您的用户解释如何填写网络表单。不过，这可能是一种逃避：“问题不是我的应用程序，而是用户！” :) 尽管如此，如果您的用户将使用您的以外的网络应用程序，最好对他们进行常见的网络表单实践教育，这样他们就不会反复感到沮丧。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-21T19:00:31.453

针对您提到的具体问题的一些具体提示：

*   自动完成：如果自动完成意味着自发出现的下拉菜单、窗格、对话框或页面，会导致迷失方向，从而分散用户的打字注意力。考虑使用固定列表框或窗格来显示自动完成选项。

*   意外点击：可能是由于控件的视觉编码不一致（例如您在此网页上看到的），导致用户没有意识到什么是可点击的，什么是不可点击的。为所有链接选择一种颜色。所有链接和只有链接都应该加下划线。其他控件的外观和行为应该像标准的 GUI 控件，并且通常看起来*很像*它们的物理类似物（例如，标签应该看起来像纸质笔记本标签，按钮应该看起来像电子按钮）。坚持使用黑色作为惰性文本。

*   不完整的字段：未能注意到字段可能是视觉设计不平衡的结果。每个页面都应该呈现与用户任务一致的视觉层次结构，其中更重要的项目比不太重要的项目更突出，项目之间的关系在视觉上很明显。一般来说，用户交互的字段和控件应该最显眼，其中必填字段应该更显眼。您的页面总体上可能过于杂乱无章的文本、颜色和图形。

*   “不会通过！”：听起来您需要对错误状态进行更好的反馈，以便用户可以自己找出他们错过了什么。考虑突出显示未回答的字段并显示指令文本（例如，“选择其中之一 ->”）。或者考虑将用户带到一个*只有*未回答字段供他们完成的页面。

一般而言，您的应用程序可能过于努力，过于令人印象深刻，出于美学原因，旨在看起来和表现酷炫和令人兴奋。对环境的要求越高（没有经验的用户、复杂的应用程序），你对美学做出的让步就越少。无论如何，使用 AJAX，但只是为了改进功能，而不是为了引起“哇”。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-22T05:36:09.347

几年前，我从创建公共图书馆软件的测试中得到了一些可用性结果。这很有趣，因为当时大量图书馆用户并不精通计算机。这些非计算机精通用户能够立即获得的唯一 GUI 控件是文本框和按钮。界面没有使用滚动条，而是使用 CD 播放器上的按钮，使用单上/下箭头向上翻页，双上/下箭头转到顶部或底部。仅使用这些功能实现的搜索 UI 非常成功。

如果您希望您的用户不会错过复选框，最好将答案强制放入 UI 流程中。虽然有经验的用户讨厌类似向导的界面，但如果初学者被迫一次阅读和回答一个问题，他们通常会有更好的体验。

如果你有一个复选框，一个选项是必须在屏幕上采取行动按钮，每个按钮都有一个你会使用复选框的隐含值。例如，您可以有一个标记为“下班直接回家”和“下班回家路上在杂货店停下”的按钮，而不是“取牛奶”选项的复选框。通过将复选框值放在操作按钮上，用户必须考虑选项并做出有意识的选择。

顺便说一句，我一直发现尝试向新手用户解释默认值是一个有趣的练习。他们只是不明白。这就是为什么向导或备用按钮的方法在新手环境中可以更好地工作的原因，因为它们被迫回答每个问题而不是默认设置。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-20T18:21:14.200

为不太懂计算机的人设计的问题之一是他们无法处理计算机的自由。UI 提供了许多选择，并且可以按不同的顺序进行处理，这可能会导致混乱、缺少复选框等。

非高级用户可以更轻松地处理一条“路径”并一次做出一项选择。理论上可以将一个选项很多的对话框重构为一系列不需要来回的选项。这对于高级用户来说更长更烦人，但对于害怕计算机的人来说非常有效。

例如，与其向人们展示四个种族的选票屏幕，不如一个接一个地展示他们并在每个种族中做出选择。需要更长的时间，但不太可能错过或压倒人们。

此外，非计算机精通用户不会注意到诸如焦点移动、灰色按钮等提示。当我们看到灰色按钮时，意味着我们还没有完成输入内容。当他们看到一个灰色的按钮时，他们会忽略它，并最终推啊推啊推，不明白它没有启用。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-20T18:23:45.617

您对 40+ 无法弄清楚类似 AJAX 的应用程序感到惊讶吗？如果您针对的是该年龄段，我会尽可能保持简单。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-22T05:48:13.113

只是一个小的。尽最大努力遵守应用程序将在其上运行的操作系统的 UI 细微差别。如果你能做到这一点，用户就“一次学习一切”。例如，Word 2003 与写字板相似是有原因的。与计划（仍然？）使 Windows 7 中的所有附件使用功能区界面的原因相同。

对我来说，没有什么比由 Linux 编码人员构建并直接编译到 Windows 的 QT 应用程序更糟糕的了。如果您面向多个操作系统，请确保您实现了一种设计模式，该模式允许您在每个操作系统上制作“一致”的 UI。

# c++ - 为什么 C++ 没有指向成员函数类型的指针？

> ID：462180
> 
> 赞同：11
> 
> 时间：2009-01-20T17:08:52.083
> 
> 标签：c++, function, pointers, member

我在这里可能完全错了，但据我所知，C++ 并没有真正的本机“指向成员函数的指针”类型。我知道你可以用 Boost 和 mem_fun 等做一些技巧。但是为什么 C++ 的设计者决定不使用包含指向函数的指针和指向对象的指针的 64 位指针？

我的具体意思是指向*未知类型的**特定*对象的成员函数的指针。IE 可以用于**回调**的东西。这将是一个包含*两个*值的类型。第一个值是指向*函数*的指针，第二个值是指向对象*特定实例*的指针。

 *****我的意思不是指向类的一般成员函数的指针。例如

```
int (Fred::*)(char,float) 
```

它会非常有用，让我的生活更轻松。

雨果

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-20T19:29:43.203

@RocketMagnet - 这是对您的[另一个问题](https://stackoverflow.com/questions/462491/again-why-doesnt-c-have-a-pointer-to-member-function-type)的回应，该问题被标记为重复。我在回答*这个*问题，而不是这个问题。

通常，指向成员函数的 C++ 指针不能在类层次结构中移植。也就是说，您通常可以侥幸逃脱。例如：

```
#include <iostream>
using std::cout;
class A { public: int x; };
class B { public: int y; };
class C : public B, public A { public: void foo(){ cout << "a.x == " << x << "\n";}};

int main() {
    typedef void (A::*pmf_t)();
    C c; c.x = 42; c.y = -1;

    pmf_t mf = static_cast<pmf_t>(&C::foo);
    (c.*mf)();
} 
```

编译这段代码，编译器**正确地**抱怨：

```
$ cl /EHsc /Zi /nologo pmf.cpp
pmf.cpp
pmf.cpp(15) : warning C4407: cast between different pointer to member representations, compiler may generate incorrect code

$ 
```

所以要回答“为什么 C++ 没有指向成员函数的指针在 void-class 上？” 是这个虚构的基类没有成员，所以没有任何值可以安全地分配给它！“void (C:: *)()”和“void (void::* )()”是互不兼容的类型。

现在，我敢打赌你在想“等等，我之前已经很好地投射了成员函数指针！” 是的，你可能有，使用 reinterpret_cast 和单一继承。这与其他重新解释演员表属于同一类别：

```
#include <iostream>
using std::cout;
class A { public: int x; };
class B { public: int y; };
class C : public B, public A { public: void foo(){ cout << "a.x == " << x << "\n";}};
class D { public: int z; };

int main() {
    C c; c.x = 42; c.y = -1;

    // this will print -1
    D& d = reinterpret_cast<D&>(c);
    cout << "d.z == " << d.z << "\n";
} 
```

因此，如果`void (void::*)()`确实存在，但没有什么可以安全/便携地分配给它。

`void (*)(void*)`传统上，您可以在任何您想使用的地方使用签名函数`void (void::*)()`，因为虽然成员函数指针不能很好地在继承层次结构上下转换，但 void 指针确实可以很好地转换。反而：

```
#include <iostream>
using std::cout;
class A { public: int x; };
class B { public: int y; };
class C : public B, public A { public: void foo(){ cout << "a.x == " << x << "\n";}};

void do_foo(void* ptrToC){
    C* c = static_cast<C*>(ptrToC);
    c->foo();
}

int main() {
    typedef void (*pf_t)(void*);
    C c; c.x = 42; c.y = -1;

    pf_t f = do_foo;
    f(&c);
} 
```

所以对于你的问题。为什么 C++ 不支持这种类型的转换。指向成员函数的指针类型已经必须处理虚拟与非虚拟基类，以及虚拟与非虚拟成员函数，它们都属于同一类型，在某些平台上将它们膨胀到 4*sizeof(void*)。我认为因为它会使指向成员函数的指针的实现进一步复杂化，而原始函数指针已经很好地解决了这个问题。

就像其他人评论的那样，C++ 为库编写者提供了足够的工具来完成这项工作，然后像你我这样的“普通”程序员应该使用这些库而不是为这些细节操心。

编辑：标记的社区维基。请仅编辑以包含对 C++ 标准的相关引用，并添加斜体。（特别是在我的理解错误的地方添加对标准的引用！^_^）

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-20T17:18:50.863

正如其他人指出的那样，C++ 确实具有成员函数指针类型。

您正在寻找的术语是“绑定函数”。C++ 没有为函数绑定提供语法糖的原因是因为它的理念是只提供最基本的工具，然后您可以使用这些工具构建您想要的一切。这有助于保持语言“小”（或者至少，减少令人难以置信的巨大）。

类似地，C++ 没有像 C# 那样的 lock{} 原语，但它有 RAII，由 boost 的 scoped_lock 使用。

当然，有学派认为你应该为所有可能有用的东西添加语法糖。无论好坏，C++ 都不属于那个学校。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-20T17:11:43.763

[确实如此。](http://www.parashift.com/c++-faq-lite/pointers-to-members.html)

例如，

```
int (Fred::*)(char,float) 
```

是指向`Fred`返回 an`int`并接受 a`char`和 a的类的成员函数的指针`float`。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-22T14:40:06.550

我认为答案是 C++ 的设计者选择不在语言中包含可以在库中轻松实现的东西。你自己对你想要什么的描述给出了一种完全合理的实现方式。

我知道这听起来很有趣，但 C++ 是一种极简语言。他们确实把所有能留给他们的东西都留给了图书馆。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-20T18:41:18.077

TR1 有 std::tr1::function，它将被添加到 C++0x。所以在某种意义上它确实有。

C++ 的设计理念之一是：不用为不用的东西付费。C# 风格的问题是它们很重并且需要语言支持，每个人都会为他们是否使用它们付费。这就是为什么首选库实现的原因。

委托很重的原因是方法指针通常比普通指针大。只要方法是虚拟的，就会发生这种情况。方法指针将根据使用它的基类调用不同的函数。这需要至少两个指针，即 vtable 和偏移量。该方法涉及的其他怪异来自涉及多重继承的类。

尽管如此，我不是编译器作者。可能已经有可能为绑定方法指针创建一个新类型，这将颠覆所引用方法的虚拟性（毕竟我们知道如果方法被绑定，基类是什么）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-21T01:35:40.207

问题肯定不是在一个易于使用的包中拥有对象指针和函数指针的基础，因为您可以使用指针和 thunk 来做到这一点。（x86 上的 VC++ 已经使用这种 thunk 来支持指向虚拟成员函数的指针，因此这些指针只占用 4 个字节。）您最终可能会得到很多 thunk，这是真的，但是人们已经依赖链接器来消除重复的模板实例化——无论如何我都会这样做——而且只有这么多的 vtable，而这些偏移量你最终会在实践中得到。对于任何规模合理的程序来说，开销可能不会很大，如果您不使用这些东西，那么它不会花费您任何费用。

（传统上使用 TOC 的架构会将 TOC 指针存储在函数指针部分，而不是存储在 thunk 中，就像他们已经这样做一样。）

（当然，这种新类型的对象不能完全替代普通的函数指针，因为大小会不同。但是，它们在调用点会写成相同的。）

我看到的问题是调用约定的问题：在一般情况下，以这种方式支持指向函数的指针可能会很棘手，因为生成的代码必须以相同的方式准备参数（包括）而不考虑实际类型指针指向的事物、函数或成员函数。

这在 x86 上可能没什么大不了的，至少对于 thiscall 来说不是，因为您可以不顾一切地加载 ECX 并接受如果调用函数不需要它，那么它将是假的。（而且我认为 VC++ 在这种情况下无论如何都假定 ECX 是伪造的。）但是在将寄存器中命名参数的参数传递给函数的架构上，您最终可能会在 thunk 中进行大量改组，并且如果堆栈参数被推向左侧- 向右，那么你基本上已经吃饱了。这不能静态修复，因为在限制中没有交叉翻译单元信息。

[编辑：MSalters 在上面对 Rocketmagnet 帖子的评论中指出，如果对象和函数都已知，则可以立即确定 this 偏移量等。这完全没有发生在我身上！但是，考虑到这一点，我想只需要存储确切的对象指针，可能是偏移量，以及确切的函数指针。这使得 thunk 完全没有必要——我认为——但我很确定指向成员函数和非成员函数的问题仍然存在。]

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-22T14:22:28.613

C++ 已经是一门大语言，加上它会使它变得更大。你真正想要的甚至比绑定成员函数更糟糕，它更接近于 boost::function。您想同时存储 a`void(*)()`和 a pair 用于回调。毕竟，原因是你希望给调用者一个完整的回调，而被调用者不应该关心确切的细节。

大小可能是`sizeof(void*)+sizeof(void(*)())`. 指向成员函数的指针可以更大，但那是因为它们是未绑定的。例如，他们需要处理您正在获取虚拟函数地址的可能性。但是，内置的绑定指针到成员函数类型不会受到这种开销的影响。它可以解析绑定时要调用的确切函数。

这对于 UDT 是不可能的。boost::function 在绑定对象指针时不能丢弃 PTMF 的开销。您需要了解 PTMF、vtable 等的结构——所有非标准的东西。但是，我们现在可能会使用 C++1x。一旦它在 std:: 中，它对编译器供应商来说是公平的游戏。标准库实现本身是不可移植的（参见例如 type_info）。

我猜你仍然想要一些好的语法，即使编译器供应商在库中实现了这一点。我愿意`std::function<void(*)()> foo = &myX && X::bar`。（它不与现有语法冲突，因为 X::bar 不是表达式 - 只有 &X::bar 是）

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-01-20T18:57:23.567

我突然想到方法有一个隐式`this`参数，因此`c`指向方法的指针不足以允许调用该方法（因为无法确定应该使用哪个实例`this`（或者即使*任何*实例当前存在） ）。

**编辑：** Rocketmagnet 评论说他在问题中解决了这个问题，而且似乎是这样，尽管我认为这是在我开始回复之后添加的。但无论如何，我会说“mea culpa”。

所以请允许我稍微扩展一下这个想法。

C++ 与 c 密切相关，并且其所有内在类型都与早期语言兼容（`c++`我想主要是因为开发历史）。因此，内在`c++`指针是`c`指针，无法支持您要求的用途。

当然，您可以构建一个派生类型来完成这项工作——就像在 boost 实现中一样——但是这样的小动物属于库。

# c# - 开源最小网络服务器？

> ID：462184
> 
> 赞同：13
> 
> 时间：2009-01-20T17:09:40.257
> 
> 标签：c#, c++, webserver

我正在考虑我编写的项目的下一步。它目前是一个控制串口设备的桌面应用程序。

我正在考虑允许浏览器客户端连接到某个进程以获取有关设备状态等的“近乎实时”更新。可能还允许从浏览器客户端进行控制。

我宁愿不从头开始编写自己的网络服务器，这将是一个非常缩小的网络服务器。

关于在哪里看的任何建议？

我更喜欢 C++ 或 C# 实现。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-20T17:21:59.780

如果您在 Windows 上运行，请使用 http.sys。它是一个通过 .NET 框架公开的轻量级 Web 服务器。

[http://mikehadlow.blogspot.com/2006/07/playing-with-httpsys.html](http://mikehadlow.blogspot.com/2006/07/playing-with-httpsys.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-20T18:11:02.460

我从朋友那里听说过有关[lighthttpd的好消息](http://www.lighttpd.net/)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-20T17:22:54.367

我不知道任何 C# http 服务器，但是您可以很快地制作自己的服务器（请参阅[http://www.codeplex.com/webserver](http://www.codeplex.com/webserver)）。

正如建议的那样，[lighthttpd](http://www.lighttpd.net/)可能会成功。

我还推荐[simpleweb](http://simpleweb.sourceforge.net/)，这是一个用 Java 编写的非常轻巧且功能强大的 http 服务器。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-20T18:20:33.423

[nginx](http://nginx.net/)非常轻量级并且非常可扩展（例如，请参阅 [Wordpress 的故事](http://barry.wordpress.com/2008/04/28/load-balancer-update/)以了解一个高调的案例）。仅 POSIX。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-03-18T05:02:45.287

这是我去年写的另一种选择，并且对我很有帮助。

**嵌入IO：** [https ://github.com/unosquare/embedio](https://github.com/unosquare/embedio)

我主要使用它在 Raspberry Pi（软浮点）上创建 RESTful 服务。它也是麻省理工学院许可的。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-24T14:26:46.743

查看我的网络服务器项目： http: [//www.codeplex.com/webserver](http://www.codeplex.com/webserver) 它包含一个精简分支，用于最小化。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-06-25T12:24:51.650

还有一些建议：

*   [NancyFX](https://github.com/NancyFx/Nancy/wiki/Documentation)（寻找自我主机）
*   [皮艇](http://kayakhttp.com/)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-05-05T03:55:47.273

Consider taking a look at the System.Net.HTTPListener class. It implements a HTTP listener which makes it very easy to respond to HTTP requests from clients. Since you don't need a full-fledged HTTP server, that is probably the way to go!

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-20T18:08:06.863

从 Visual Studio 运行 Web 项目时，通常是通过 Cassini2 运行它。这也是一个可下载的项目。

否则，如果您想要更小的东西，您可以查看 Indy 10 库（开源），它是一套完整的网络 API。你可以用它相当快地编写你自己的网络服务器。

或者，NSoftware 也有一些网络 API。它们是商业的，但有据可查，我很幸运能得到他们的支持（但已经有一段时间了）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-20T18:13:53.437

由于您不是自己编写的，因此它必须是最小的服务器吗？Apache 和相关的可能会满足您的目的。它是重量级的，但不了解您的更多可能或可能不是问题的要求。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-03-22T06:53:43.287

看看 Codeprpject 网站
有很多开源和简单的 webserver

[使用 C# 创建自己的 Web 服务器](http://www.codeproject.com/Articles/1505/Create-your-own-Web-Server-using-C)

[C# 中的简单 HTTP 服务器](http://www.codeproject.com/Articles/137979/Simple-HTTP-Server-in-C)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-20T17:57:15.263

我不知道是否适合您的项目，但[http://www.tntnet.org/](http://www.tntnet.org/)看起来很有希望。或者，您可以寻找一个 http 服务器库，您可以添加您的自定义代码来构建一个嵌入了应用程序的 Web 服务器。有很多（如 libmicrohttpd），在不了解您的项目的情况下不值得在这里列举。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2013-08-29T00:31:23.553

您也可以尝试使用 nodejs 来构建网络服务器。

有实现简单示例的示例

# c# - 学习新技术的最佳方式是什么？

> ID：462185
> 
> 赞同：5
> 
> 时间：2009-01-20T17:09:41.787
> 
> 标签：c#, ajax, linq, wcf

我想知道学习“新”技术（如 LINQ、WPF、WCF、AJAX、最新的 C# 3.0 等）的最佳方式是什么？

怎样学得最好？是通过书籍、网络广播、在线文章、教程、示例还是动手实验室？

另外，你如何确保你会记住所学的东西？（再次阅读一本书/文章？更深入地挖掘您认为您已经熟悉的主题？）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-20T17:14:28.877

我是老式的。我仍然从寻找一本好书开始，从头开始阅读，直到它过于依赖我在第一次通读时没有掌握的东西，然后回去动手做一些事情。

博客、网络广播和在线文章通常会在我掌握了基础知识后出现。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-20T17:16:24.940

你能做的最好的事情就是*开始编码*。那里有大量的信息：书籍、杂志、博客等。无论你做什么，不要只是阅读它们 - 跟随并编写示例代码。

学习的来源不是太重要，我读过糟糕的书和好的博客，也读过优秀的书和危险的不准确博客。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-20T17:15:07.500

首先考虑一个项目来使用它。当您尝试使用它来实现特定目标时，学习过程会发生巨大变化。

从那里你正在做的是研究驱动的。您可以查找任何告诉您如何在项目中执行下一步的书籍、网络广播等。

完成该项目后，您可以返回并从更多角度了解该技术的内部工作原理。（而且您更有能力检测某些作者为我们提供的总 BS。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-20T17:37:48.673

反复试验！这是学习任何东西的最佳方式！

像学习游泳一样思考：您可以阅读很多游泳内容，但如果您不尝试，您将永远学不会。

如果您从一本书中学习，请打开您的编辑器/IDE 并尝试该书的任何示例，即使它看起来很愚蠢。那些愚蠢的例子会发展你的分析思维；）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-20T18:29:51.093

我从来没有通过阅读来真正学习一门新技术——第一步总是我在某个地方看到的一个想法，或者我真的想看到一个想法付诸实施。在理想的情况下（为了最大的动力），你会发现有你想要的东西，但它还没有出现——然后你就开始行动了（一开始很慢 ;-) 并在尝试完成你的项目时从中学习存在的各种来源（无论是书籍、博客、文章等对我来说并不重要）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-20T17:18:19.537

我通常会对在用户组（我们在英国有很多）、会议或路演中提出的主题感兴趣。这样你就可以在最后向真正了解他们的东西的人提问。

然后我要么在线研究，要么买一本电子书并尝试编写“真正的”应用程序（即你一直想写来做“事情”但还没有完成的应用程序）。如果幸运的话，我会为我正在开发的真实应用程序编写一个模块。

这是一个真正使用它的人的灵感，并提供了一个激发我兴趣的真实世界的例子。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-20T18:18:08.310

对我来说最好的工作技术：

1.  一些网络广播可以快速了解可以做什么以及如何做
2.  以某种方式使用它，无论是在我的项目中还是在某些沙盒应用程序中
3.  现在是深入了解技术的时候了：书籍和博客

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-20T18:27:14.487

不幸的是，对我来说，唯一的方法就是在现实世界的作业中练习。

我可以阅读很多文章，并下载框架、编译器、示例等，这非常有帮助，因为我知道技术的全部内容，但我只是在必须使用它时才学习它我的客户工作。

爱好项目，只是不适合我，因为要求总是“太软”，也就是说，由于我设定了自己的要求，我倾向于只“要求”我所知道的。但是当涉及到一个新客户并且他们问一些我从未想过的事情时，我必须找出如何去做（或者首先是否可行），那么我可以说我学到了一些新东西。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-20T17:18:22.503

1.  找几个不错的博客/播客/任何可以介绍新技术的东西。这让您了解现有技术之间的相似之处/不同之处，并为您提供要查找的关键字和技术的总体概述。

2.  找几个带有源代码的非常简单的项目，让您了解一个正在运行的应用程序是如何工作的，并且当您试图弄清楚某些事情时，可能会为您指明正确的方向。

3.  找到几个好的留言板（如 SOFlow 8^D），当您遇到问题时可以使用它们。如果你自己拼凑一些东西，它通常会有你需要的代码片段。

4.  弄脏！想出一个伟大的小项目，您将热衷于使用新技术创建和构建它。激情将帮助您解决这些棘手的问题，并在完成后为您提供一些个人吹牛的权利。8^D

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-20T17:22:24.070

听起来可能很有趣，但这是我通常的学习路径。我不会说它是最好的方法，但这就是我的做法。

1.  我得到了一本只触及表面的书，适合绝对初学者的书，比如在 24 小时内自学什么的。这让我有机会让用户了解这些术语并让自己免于被吓倒。

2.  我在网上寻找一些视频和教程，并练习/复制我看到的示例。

3.  一旦你感到舒服，你就可以开始阅读该语言/技术的圣经了。不要停止实施示例。

4.  继续寻找免费的在线测试或问卷，让您对此充满信心。这就是 StackOverflow 的用武之地 :)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-20T19:01:18.003

对于你想学习的每一项技术，创建一个你想用它们制作的东西的概念证明。

例如，使用 Winforms 或 Ajax 创建自动完成的概念证明。在远程处理或 Web 服务技术之外，制作自己的概念证明，了解如何在不使用 sql 或低级 tcp/ip 管道的情况下与服务器通信。

学习如何做（写）事情，会给你一个真正快速的学习方法。Google 和 Stackoverflow 是你的朋友，读了很多书。对于 LINQ 相关的东西，[这里](https://stackoverflow.com/questions/tagged/linq)的 LINQ 问题和答案的数量和质量都相当不错。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-20T19:17:22.277

I think that the best way is doing some real work that the technology claims to be good at (WPF => Smart Client, ASP .Net => A Web Site).
Also, if you have a running project using a legacy version of the newly technology that you are intending to understand (Windows Client to WPF, ASP to ASP .Net, Flash to Flex), a migration of it would speed up things a lot.
Hope this helps.

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-20T19:27:24.427

I like to start by ready a good book about that particular technology. Sometimes i don't read it cover to cover and just read important sections and tips. Then i make a list about any new interesting fact I've found so far. This makes my starting point. From this point on, I'll continue playing and doing some stuff with that technology and also I'll follow blogs or websites that have related content.

I think the most important part of learning a technology is using it and learning its practices, both best and worst.

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-20T17:55:07.560

对于许多技术的概述，我会寻找技术播客。它们比博客更容易跟上（尽管博客是另一个不错的选择）。

要更深入地了解特定技术，您应该创建一个关于该主题的播客。你会比你想象的更快地了解它。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-20T18:21:20.863

当我有一个目标时，我学得最好，所以最好从一个测试应用程序的好主意开始。我将使用一篇或两篇好的博客文章让我继续前进，然后进行一些试验和错误！很高兴回去完善我使用书籍、网络广播等所学的知识，但是没有什么比通过实际做来学习更好的了。如果我用勺子喂得太多，那就更难理解了。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-01-20T18:36:21.160

我会选择 33% 的听力/阅读，67% 的做。

阅读、收听播客等，直到您觉得自己对技术的功能有了不错的掌握。然后**找一个需要构建软件小部件的人，有一个灵活的时间表并且没有多少钱**，如果他们同意使用技术 X 构建它，可以以较低的价格为他们构建它。你可以学习技术现实世界的方式，他们得到的解决方案会持续一段时间。您将拥有一个具有真实需求的真实用户，并且您将被要求构建在现实世界中有效的东西。比爱好项目或教程要好得多。这就是我学习 Silverlight 的方式。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-01-20T18:49:18.310

这是我现在正在采用的方法，我认为这是一种非常精通技术的好方法：

1.  阅读一本书并在阅读时创建笔记。我个人几乎总是将 Apress 书籍作为我的第一本书，但每个人都有不同的品味。
2.  根据您的笔记，开始在玩具项目中使用该技术，以便您可以触及所有重要主题。如果您的笔记不足以让您完成这些迷你项目，那么它们还不够。返回并回填您需要的任何笔记。
3.  阅读另一本书，手头有笔记，并填写第一本书中遗漏的任何内容。
4.  开始在实际项目中使用该技术。

这看起来很多，但我认为它会帮助你在短时间内变得非常熟练。只要您有空闲时间，就可以慢慢完成步骤 1-3。因为你有一套（好的）笔记，你可以把你的记忆刷新到你离开的地方。

# iphone - MobileMe SDK/API 文档

> ID：462186
> 
> 赞同：7
> 
> 时间：2009-01-20T17:09:45.000
> 
> 标签：iphone, macos, mobileme

在网上搜索时，我发现很多关于“MobileMe API”（或 .Mac API）的参考资料用于与 MobileMe 同步数据，但我找不到任何权威文档，即使在 Apple 的网站上也是如此。

有人知道它在哪里或如何获得它吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-20T18:08:35.053

目前没有可用的 MobileMe API 或 SDK。这是 WWDC '08 上的谣言。今年或许能看到曙光。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-01-27T06:27:30.543

没有用于 mobileme 的 api，但是一切都是使用标准开发的。

例如，您可以使用 CalDAV 访问日历和任务，或者您可以使用 WebDav 访问 iDisk。

我希望这会有所帮助，因为我一直在寻找这个几个月。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T18:51:12.737

没有 Mobile Me SDK。

有（曾经）一个 .Mac SDK，但 1）它不会在 iPhone 上运行，并且 2）近 3 年没有更新。

与往常一样，您应该[向 Apple 提出请求](http://bugreporter.apple.com)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T18:25:37.407

在相关的说明中，我真的认为 Apple 在开发人员文档和社区参与方面做得不够好。他们当然可以在这方面从微软的书中拿出一页。

# c# - 基本 Visio 2003 C# 交互，drawingControl

> ID：462194
> 
> 赞同：0
> 
> 时间：2009-01-20T17:12:46.383
> 
> 标签：c#, visio

我正在尝试使用 Visio 2003 进行一点绘图自动化。但是，我在获取 MSDN 所说的内容并将其合并到我的代码中时遇到了问题。我可能犯了一个非常新手的错误。但是，经过几天的互联网搜索，我还没有实施解决方案。

我试图简单地从 tbClick 打开一个模板。MSDN 站点告诉我使用 DrawingControl.Src 打开模板。但是，当我将 DrawingControl 应用于代码并进行编译时，我收到此错误：非静态字段、方法或属性“VisOcx.IDrawingCopntrol.Src.get”(CS0120) 需要对象引用。下面是一段代码，显示了命名空间资源和我要实现的功能。

我也愿意接受有关代码的任何和所有建议。

```
//namespace
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Windows.Forms;
using System.Diagnostics;   
using System.Runtime.Serialization;
using System.Runtime.InteropServices;
using Visio1 = Microsoft.Office.Interop.Visio;
using Visio2 = VisOcx;

//function
void Qed2_elevation_stencil_tbClick(object sender, EventArgs e)
{
    try
    {
        Visio2.DrawingControl.Src = "C:\\Drawing.vsd";
    }
    catch (Exception ex)
    {
        MessageBox.Show(ex.Message);
    }

    return;
} 
```

* * *

我想我离让这段代码工作更近了。我现在收到错误消息，“'Qed2_elevation_stencil_tbClick' 没有过载匹配委托'System.EventHandler'（CSO123）。下面是更新的代码。提前感谢任何愿意提供帮助的人。

```
// 
// qed2_elevation_stencil_tb
// 
this.qed2_elevation_stencil_tb.ToolTipText = "QED2 Front Elevation";
this.qed2_elevation_stencil_tb.Click += new    
system.EventHandler(this.Qed2_elevation_stencil_tbClick);

using System;
using System.Configuration;
using System.Collections.Generic;
using System.Collections;
using System.Data;
using System.Drawing;
using System.Windows.Forms;
using System.Diagnostics;   
using System.Runtime.Serialization;
using System.Runtime.InteropServices;
using System.IO;

using Visio1 = Microsoft.Office.Interop.Visio;
using Visio2 = VisOcx;
using Visio3 = AxMicrosoft.Office.Interop.VisOcx;

public partial class MainForm : Form
{

    public MainForm()
    {
        //
        // The InitializeComponent() call is required for Windows Forms   designer support.
        //
        InitializeComponent();

        //
        // TODO: Add constructor code after the InitializeComponent() call.
        //
    }

    private Visio1.Application  VisApp = null;
    private Visio1.Page         VisPage = null;     
    private Visio1.Document     VisDocument = null;
    private Visio1.Documents    VisDocuments = null;
    private Visio1.Window       VisWindow = null;
    private Visio1.Document     VisStencil = null;

private void Qed2_elevation_stencil_tbClick(ref Visio1.Documents visDocuments)

    {
        string stencilPath = System.IO.Path.Combine(@"C:\\Documents and Settings\\MGPF50\\My Documents\\Visio Stencils", @"Front Elevation Stencil.vss");

        try
        {
            VisStencil = visDocuments.OpenEx(stencilPath,
                (short)Visio1.VisOpenSaveArgs.visOpenRO
                + (short)Visio1.VisOpenSaveArgs.visOpenHidden
                + (short)Visio1.VisOpenSaveArgs.visOpenMinimized
                + (short)Visio1.VisOpenSaveArgs.visOpenNoWorkspace);
        }
        catch (COMException exp)
        {
            MessageBox.Show("Error Loading Stencil: " + stencilPath + exp.Message);
            throw exp;
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-20T17:50:51.250

当需要实例化以供使用时，您正尝试静态访问绘图控件。这是一个应该有所帮助的[演练。](http://msdn.microsoft.com/en-us/magazine/cc164043.aspx)

# transactions - Web 应用程序中的事务处理

> ID：462195
> 
> 赞同：2
> 
> 时间：2009-01-20T17:12:50.157
> 
> 标签：transactions

我注意到在大多数 Web 应用程序中，只要在一系列页面中涉及事务，事务处理就发生在数据库层中。在可能有大量用户运行此类事务的 Web 应用程序中，处理所有事务可能是一件至关重要的事情。我同意数据库层在执行此操作方面非常有效，并提供了许多功能来有效执行此操作。

我的问题是，如果 Web 应用程序建立在不支持事务处理的数据库之上，有没有办法在其他层处理这些事务？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T17:39:43.007

不处理事务的数据库？最好得到一个新的数据库。

我不同意 - 事务*不在*持久层中处理。我认为它们应该属于服务层，因为服务方法映射到工作单元和用例。单个服务调用可能涉及多个数据库和模型对象，因此它们都需要是单个 ACID 工作单元。如果持久层处理事务，这是不可能的。

即使数据库不支持，这样的设计也可以处理事务。该服务可以在回滚的情况下实现补偿调用。如果您将该逻辑塞入持久层，这是不可能的。

在我看来，您必须在 Web 层和持久层之间有一个单独的服务接口。Web 层仅处理 HTTP 请求、路由到服务以及制定响应以发回。服务完成工作。

这些服务可以是 Web 服务，如果您选择以这种方式部署它们，但有很多部署选择。单独的服务层独立于这些选择。

# java - Java：接口与抽象类（关于字段）

> ID：462198
> 
> 赞同：10
> 
> 时间：2009-01-20T17:13:07.037
> 
> 标签：java, interface, accessibility, abstract-class, field

根据我收集到的信息，我想强制一个类使用特定的私有字段（和方法）我需要一个抽象类，因为接口只声明公共/静态/最终字段和方法。正确的？？

我刚开始我的第一个大型 Java 项目，想确保以后不会伤害自己 :)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-20T17:20:57.083

您不想强制使用某些私有字段或方法。一般来说，你不关心实现，你关心的是接口。所以在几个接口中定义几个方法（取决于你需要多少）并定义实现它们的类。这可能在未来对你的伤害最小。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-01-20T17:54:47.547

两者都提供是很常见的，因此您最终会得到：

```
public interface Sendable {
    public void sendMe();
} 
```

和

```
public abstract class AbstractSender implements Sendable {
    public abstract void send();

    public void sendMe() {
        send(this.toString());
    }
} 
```

这样，任何对抽象类中的默认实现感到满意的人都可以快速子类化它而无需重写大量代码，但任何需要做更复杂的事情（或需要从不同的基类继承）的人仍然可以实现接口和即插即用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-20T17:16:56.280

子类不能使用私有字段和方法（除非它们也是内部类）。但是，您可以使它们受到保护。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-20T17:21:05.507

接口定义了这一点 - 与实现类之外的世界的接口（合同）。（抽象与否）超类的公共方法也是如此。您不应该尝试要求子类具有某些私有成员 - 您正在尝试指定实现，而这正是 OOP 所要避免的。

当您想在超类中定义一些共享行为时，您可以使用抽象类 - 但该类不能独立存在（它需要被子类化）。可能是共享行为需要它自己的某种状态——在这种情况下，它可以定义私有字段，并且它也可能具有只有它才能使用的私有方法。

即使您从抽象类继承，您也无法访问其私有字段/方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-20T17:16:46.343

这是对的。但这不一定是一个非此即彼的决定，您可以通过提供一个骨架实现以及您的接口来结合接口和抽象类的优点。*您可以在Effective Java, 2nd Ed*中找到关于这种方法的非常有趣的描述。, Item 18 ("Prefer interfaces to abstract classes")。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-20T17:17:10.087

这是正确的。接口供公众使用。私有实现需要在抽象（或具体）类中。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-20T17:19:15.357

如果您发现自己在猜测选择哪个接口，我建议您在接口方面犯错 - 最好有一个应该是抽象类的接口，而不是相反。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-20T17:44:02.373

接口定义了行为*契约*。这就是他们需要做的，而不是属性。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-20T18:15:26.350

> 我想强制一个类使用特定的私有字段（和方法）

你问题的这一部分是有问题的：你认为你为什么要这样做？

私有成员对子类不可见，并且接口定义了公共接口，因此您唯一的选择是使用抽象类......但我想不出任何人想要这样做的任何理由

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-20T17:52:06.133

如果你想让子类定义特定的方法，使用接口就可以了。正如其他人所说，与其说是子类是*如何*做到的，不如说是它*会*做到这一点。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-04-13T03:29:34.553

如果您希望一个类使用另一个类的某些字段或方法，您可以将它们声明为受保护。

```
 public abstract class A {

      protected Object thing;
    } 
```

可以被同一个包中的另一个类访问（可以是扩展类 A，也可以不是）

```
A a = new A();
a.thing.toString(); 
```

不过，这并不是真正“强迫”另一个类使用它，更像是“启用”。

# java - 如何访问 Velocity 模板中的静态成员？

> ID：462223
> 
> 赞同：10
> 
> 时间：2009-01-20T17:17:51.973
> 
> 标签：java, model-view-controller, velocity

我不确定是否有办法在 Velocity 中执行此操作：

我有一个用户 POJO，它有一个名为 Status 的属性，它看起来像一个枚举（但它不是，因为我被困在 Java 1.4 上），定义看起来像这样：

```
public class User  {

    // default status to User
    private Status status = Status.USER;

    public void setStatus(Status status) {
        this.status = status;
    }

    public Status getStatus() {
        return status;
    } 
```

Status 是一个静态内部类：

```
public static final class Status {

    private String statusString;

    private Status(String statusString) {
        this.statusString = statusString;
    }

    public final static Status USER = new Status("user");
    public final static Status ADMIN = new Status("admin");
    public final static Status STATUS_X = new Status("blah");

    //.equals() and .hashCode() implemented as well
} 
```

使用这种模式，可以很容易地在条件下测试用户状态，例如

```
if(User.Status.ADMIN.equals(user.getStatus())) ... 
```

...无需为状态 ID、任何幻数等引用任何常量。

但是，我不知道如何在我的 Velocity 模板中使用 VTL 测试这些条件。我想根据用户的状态打印一个简单的字符串，例如：

```
Welcome <b>${user.name}</b>!
<br/>
<br/>

#if($user.status == com.company.blah.User.Status.USER)
    You are a regular user
#elseif($user.status == com.company.blah.User.Status.ADMIN)
    You are an administrator
#etc...

#end 
```

但这会引发一个看起来像的异常 `org.apache.velocity.exception.ParseErrorException: Encountered "User" at webpages/include/dashboard.inc[line 10, column 21] Was expecting one of: "[" ...`

从[VTL User Guide](http://velocity.apache.org/engine/releases/velocity-1.6.1/user-guide.html)中，没有提到直接在 VTL 中访问 Java 类/静态成员，条件的右侧（RHS）似乎只能是数字文字、字符串文字、属性引用或方法参考。

那么有什么方法可以访问 Velocity 模板中的静态 Java 属性/引用？我知道作为一种解决方法，我可以在我的控制器中嵌入状态 ID 或其他标识符作为参考（这是一个使用 Velocity 作为视图技术的 Web MVC 应用程序），但我强烈不想嵌入任何魔法视图层中的数字或常量。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-20T17:37:33.570

我想出了一个解决方法，允许我将每个`User.Status`对象添加到 Velocity 上下文中，这避免了对模板中常量或幻数的任何类型的引用。

在控制器/Java 端：

```
// put the statuses directly into the model
Map statusMap = new HashMap();
statusMap.put("user", User.Status.USER);
statusMap.put("groupOperator", User.Status.ADMIN);
...
modelAndView.addObject("statusmap", statusMap); 
```

然后在模板中可以像这样引用这些值：

```
#if($user.status == $statusmap.user)
   You are a regular user
#elseif($user.status == $statusmap.admin)
    You are an administrator
##etc...
#end 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-02T22:39:06.763

是的，Velocity 本身并没有 grok 类和包。你可以做你所做的，或者使用 FieldMethodizer 类来自动化它。另一种选择是 VelocityTools 2.0 中的 FieldTool。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-05-19T11:04:36.243

尝试使用 Velocity 的 FieldMethodizer，它不是最好的解决方案，但你可以做一些事情。

使用这个类你可以调用静态公共常量，请看链接：

[FieldMethodizer API](http://velocity.apache.org/engine/releases/velocity-1.4/api/org/apache/velocity/app/FieldMethodizer.html)

# vb.net - 显示文件列表的最佳 VB.NET 控件（标准/自定义）是什么？

> ID：462232
> 
> 赞同：1
> 
> 时间：2009-01-20T17:19:49.880
> 
> 标签：vb.net, user-interface, file, custom-controls, user-controls

我正在 VB.NET 中开发一个桌面搜索引擎，我正在寻找一个强大、灵活且功能丰富的控件来显示搜索结果，即文件列表。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T17:31:11.133

如果您使用的是 WinForms，则标准是使用 TreeView 用于文件夹，使用 ListView 用于文件/结果。

如果您不着急，使用 WPF 自行开发可能会很有趣。它会更加灵活，但也需要更多的工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T17:32:14.503

[System.Windows.Forms.ListView](http://msdn.microsoft.com/en-us/library/system.windows.forms.listview.aspx)控件可能与 Windows 本身用于在资源管理器中呈现文件和文件夹列表的控件最相似。

# backup - 共享软件执行与时间机器

> ID：462236
> 
> 赞同：4
> 
> 时间：2009-01-20T17:20:49.487
> 
> 标签：backup, registration, restore, rollback, shareware

**问题：**客户 X 正在（考虑）将他以前的“仅限 Windows”共享软件应用程序之一移植到 Mac OS X。他关心的一个问题是如何强制执行 30 天试用期并使其免受诸如 Time 之类的“系统回滚”软件的影响机器。

**问题：**防止使用“系统回滚”软件来延长或以其他方式修改共享软件的 30 天试用期的行业最佳做法是什么？

**免责声明：**我不认为客户 X 的策略是可行的，而且我不认为人们会为了多使用他的软件几天而有动机回滚整个系统。尽管如此，为了尽职调查，我在这里问只是为了研究他的问题。如果您仅仅因为您（和我）可能不同意或认为这不切实际而希望投反对票，请考虑这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-20T17:37:01.403

通常，OS X 开发人员会在某个支持文件夹中使用一个隐藏文件，其中包含试用日期。在大多数情况下，这对于他想要的东西来说是一个足够好的策略，我怀疑有人会为了盗版他的应用程序而进行完整的系统还原，如果他们使用 Time Machine 从更早的日期还原应用程序包本身，它不会对试用日期没有任何影响。

现在，如果他担心用户会进行完全恢复或追踪隐藏文件，他可以为他的试用软件尝试某种在线验证服务。说真的，反正那些人就是随便找个破解版的，就算你想花时间也打不过。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T17:31:08.687

他将花多少钱来寻找和实施解决方案？人们延长试用期他会损失多少钱？投资回报率是多少？

哦，等等，这不是问题。他想做点什么，即使付出的比赚的多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-20T17:44:26.770

一种可能可行的方法是获取一些系统特有的变量。我不确定 OSX 中有什么可用的，但可能有两个示例：主高清序列号、主网络适配器 MAC 地址。

将这些因素组合成一个可重复的哈希“电话回家”（确保您在 EULA 或类似的文件中披露这一点）。您可以测量用户使用它的次数并“回复”以让应用知道是否加载。

这不是万无一失的......但如果没有破解它（这是一个不可避免的问题），最终用户将需要对系统如何工作的相当极端的了解。

这将花费更多（因为您需要保持激活服务器正常运行）并且对于想要在没有互联网连接的情况下使用它的用户来说会很烦人。衡量一下，加上开发成本，并考虑盗版是否真的足以证明成本是合理的。

提醒您的客户，如果他们测量了非法下载，并非每次下载都是损失销售。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-20T18:50:33.987

它是共享软件，所以我们知道一些事情。

有些人想要使用您的软件，并且非常愿意为此付费。您需要为他们做的就是让他们试用您的软件，并且不要让他们难以付款。（对我来说，Paypal 既快捷又简单，但邮寄支票就成了一件苦差事。）

有些人不会为您的软件付费，他们所做的不会影响您。如果他们作弊，您实际上可能会好一点；那样的话，他们可能会对可能付钱给你的人感兴趣。如果您愿意，请尝试阻止他们使用您的软件，但不要自欺欺人地认为这会给您带来更多收益。

有些人愿意付钱给你，但更愿意免费使用它。这些人是你要担心的人。你想让支付给你的问题比作弊更容易。如果成本是合理的，他们无论如何都不会付出不合理的努力来使用它，所以你不需要采取过于严格的措施。（请记住，唯一会努力作弊的人是那些无论如何都不会付钱给你的人。）

还要记住，使保护过度烦人会使人们从“可以支付”类别转移到“不会支付”类别。许多当代的例子恰恰相反，我真的不认为惹恼你的合法客户是商业计划的重要组成部分。

没有什么可以做的，除了打电话回家引起很多其他问题，以防止每个人破解你的保护计划，所以如果它首先值得出售，就会有人破解它，并可能把它放在海盗湾。不用担心，因为您对此无能为力。把你的精力放在能给你带来更多利润的事情上。编辑：要非常小心保护您的应用程序。您不希望 Pirate Bay 版本明显优于合法版本。您还希望合法客户说“它很棒，安装没问题”，而不是“它禁用了我的 DVD 驱动器并让我的沙鼠受孕，但在那之后它很棒”。

Finally, I don't see the difference between Windows and MacOSX here. If I download some shareware for Windows, I keep the .zip file around, and I can uninstall and reinstall, or reset the system date. For MacOS, i can uninstall and reinstall, or reset the system date, and Time Machine can automate some of this. What's the issue here? (Remember that if you leave uninstallable bits where they can cause problems later, you're potentially annoying the cash customers.)

My recommendation would be to not worry about it too much.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-20T18:12:07.107

正如[Oli 所写](https://stackoverflow.com/questions/462236/shareware-enforcement-vs-time-machine#462317)，该软件可以通过硬件序列号等给家里打电话。甚至还有可以在机器本身上使用 TPM 硬件的 DRM 方案。打电话回家很简单，但它有多个缺陷：

1.  存在隐私问题。许多用户不喜欢软件电话回家，任何使用拨号的人都会注意到电话。
2.  您必须维护电话回家应用程序。
3.  没有互联网连接的人将被锁定，除非您有备份 DRM 方案，例如[Marc 所写](https://stackoverflow.com/questions/462236/shareware-enforcement-vs-time-machine#462290)的系统文件夹中的隐藏文件。
4.  如果手机家庭服务器出现问题，您的客户可能难以使用试用版应用程序。

但是，电话家庭服务器的一个很好的用途是收集有关应用程序使用方式的指标，并可能下载更新。当然，指标具有更多的隐私含义。

最终任何应用程序都可以被破解。视频游戏供应商有反作弊软件，以防止修改后的客户在线作弊；也许这项技术也可以在这里使用。但是，仍然存在对 Internet 连接的有害要求。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-08-27T01:34:13.343

Windows 和大多数其他操作系统也存在将系统恢复到以前状态的软件。更简单的方法是使用 VMware 或其他工具将试用版安装到虚拟机中，这样您就可以立即回滚到以前的快照。我总是将试用版安装到虚拟机中，不是因为我想延长试用期，而是因为我想在我的主系统上冒险之前全面测试试用版。

如果有人愿意为了继续使用您的试用版而反复回滚他们的 PC 或 VM，那么他们可能无论如何都不会购买您的软件。如果你阻止他们，他们会破解你竞争对手的产品。

# language-agnostic - 新项目：在问题管理系统中创建任务/工单是谁的责任？

> ID：462243
> 
> 赞同：2
> 
> 时间：2009-01-20T17:21:31.513
> 
> 标签：language-agnostic, project-management

我想知道谁在团队中负责制定规范（由业务分析师制作）并在问题管理系统（例如 JIRA）中逐项列出它（票证和子任务）（供开发人员细读）。

我觉得这取决于您选择的项目管理方法（例如 PRINCE2）和/或团队规模，但请赐教。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T17:27:00.533

取决于您在 JIRA 中的具体内容。如果是开发项目，那么这通常是每个团队的团队/技术负责人的责任。如果由更高级别的人完成，则粒度将不够好，并且估计将趋向于非常乐观

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T18:22:16.943

在我的公司，我们通常这样做：如果编写规范文档的人知道他编写规范的系统，即他将能够判断滴答/任务的最佳粒度，我会要求他创建它们。否则，项目负责人（了解系统进出）创建工单（参考规范文档的相关章节）。

至于为特定开发人员分配工单：这通常由项目负责人完成（谁应该了解谁有多忙）。我们还有一个“池”，开发人员可以在其中自己选择一张票（但我们主要将其用于错误修复，而不是用于新功能，否则您可能无法完全控制您的版本中包含哪些功能'目前正在开发中）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T22:32:32.820

是的，这是你的软件开发方法决定的，除非它不谈论它；没有*正确*的答案，*更好*的答案取决于您的项目和人员。

您所描述的任务是功能分解，您将业务分析师的需求规范中的每个需求分解为实现该需求的功能。这也称为*功能设计*，所以你说的是功能设计师。

您可以选择直接在*新功能*JIRA 问题的描述中记录您的功能设计，就像我们有时所做的那样，或者您可能有一个中间*功能需求规范*。在后一种情况下，将功能拆分为开发人员任务可能更直接（在不是设计活动的意义上），并且可能由将工作分配给开发人员的项目经理或技术负责人完成，或者由分配工作的开发人员完成为自己工作。

在任何情况下，这项任务都是关于从业务分析师的角度转换为开发人员的角度。您需要如何执行此操作，以及执行多少步骤，取决于编写者如何将其放在开发人员的术语中，以及开发人员对以分析师的术语编写的需求的理解程度。更少的步骤花费更少的时间并引入更少的噪音，但需要具有更好理解和沟通技巧的人。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T17:41:25.933

在我的工作中，不需要深入了解您的应用程序的一般任务（即：创建具有某些权限的用户，创建聚合某些数据点的报告，...）通常可以由项目经理创建然后分配给团队负责人/高级开发人员。然后，团队负责人/高级开发人员创建较小的任务，这些任务是 PM 记录的更一般项目的子集，并将这些任务分配给特定的开发人员，同时考虑到他们的技能组合（即：SQL 人员可以编写查询以获取数据，客户端 UI 人员可以在报告的前端工作，...）。让 PM 或项目所有者直接将详细任务分配给开发人员往往会造成混乱并可能危及发布。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-20T18:58:19.120

取决于很多事情......谁编写了规范？项目的规模，开发团队的规模，开发人员的设计技能有多强？谁管理开发人员的时间？等等

根据我的经验，它通常是首席开发人员。谁领导项目的实际开发。我已经看到项目经理对此也有反应，但由于缺乏技术知识，它从来没有那么好用。

假设一个业务人员编写了规范，并且您有初级/中级开发人员，那么管理这些开发人员的负责人将编写一系列小的技术规范并将其分配给开发人员。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-21T01:56:01.367

最终，开发 WBS（工作分解结构）是 PM 的工作；它实际上由您引用的工单和子任务组成。实际上，他/她可能不像步兵那样接近问题；因此，查找 WBS 中的所有项目可能是一项协作练习。

谁**实际上**将它们输入到您的问题管理系统/错误跟踪器/项目调度程序/项目管理软件/FogBugz 中，实际上是他/她指示完成工作的任何团队成员。

# c++ - 在 STL 集上使用静态与成员查找方法？

> ID：462252
> 
> 赞同：3
> 
> 时间：2009-01-20T17:23:55.643
> 
> 标签：c++, algorithm, stl, stl-algorithm

我正在使用集合，因为我想使用已排序容器（例如集合）的快速查找属性。我想知道是否必须使用 find 成员方法来获得排序容器的好处，还是我也可以在 STL 算法中使用静态 find 方法？

我的预感是使用静态版本将使用线性搜索而不是我想要的二进制搜索。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-20T17:30:11.527

没错，[非会员版本](http://www.sgi.com/tech/stl/find.html)进行线性搜索，而会员版本将进行 O(log N) 搜索。std::set 针对 O(log N) 的插入、检索和删除进行了优化。

作为定义点， std::find 方法不是静态函数。[有关静态](http://msdn.microsoft.com/en-us/library/s1sb61xd.aspx)在 C++ 中的各种含义的描述，请参见此处。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T17:42:03.813

这是依赖于实现的，因为有人可能已经为静态“查找”实现了部分特化，该静态“查找”在集合上使用二进制搜索，但考虑到所有因素，成员函数版本可能会执行得更好。

IIRC，Scott Meyers 在他的“Effective STL”一书中建议始终更喜欢 find、swap 等常用函数的成员版本而不是非成员函数，因为与非成员版本相比，它们更有可能是最佳实现*并且*您通常可以依靠成员版本的性能优势，而您不能总是依靠将存在给定函数的部分特化这一事实。

# c# - WinForm中的OpenID？

> ID：462264
> 
> 赞同：3
> 
> 时间：2009-01-20T17:28:09.550
> 
> 标签：c#, winforms, openid, rpx

有没有人知道在 WinForm（.net 2.0 和 C#）中有或没有 RPX 的 OpenID 的最佳（或任何）教程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-01-14T14:35:37.997

其他不鼓励在应用程序中嵌入 OpenID 的回答者所说的话也是如此。

但我要补充一点：你应该看看 OAuth。它很可能正是您正在寻找的东西，并且实际上是为应用程序设计的，用于对 Web 服务进行身份验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T05:21:52.113

由于 WinForms 是一个客户端接口，而 OpenID 要求您实际运行一个 Web 服务器，您可能只想在某处设置一个执行 OpenID 身份验证的 Web 应用程序，然后向您的应用程序返回某种证明，断言用户已登录。然后嵌入浏览器控件，以便用户可以通过此 Web 应用程序登录。

请注意，如果用户可以控制终端，这不会给您带来任何安全性 - 他们可以将请求重定向到他们控制下的假服务器，破解二进制文件等。所以我不确定这将如何有用结束 ：）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-13T18:26:52.120

Open ID 协议不是您可以从任何地方调用的东西。它依靠 Web 浏览器重定向将用户发送到提供商的登录页面并返回给依赖方。

如果您考虑一下，尝试从客户端应用程序中使用 Open ID 并没有多大意义。Open ID 依赖于信任其 Web 浏览器的用户，因此当他们被重定向到其 Open ID 提供商的登录页面时，他们可以查看 URL 并确保他们正在将其凭据输入到受信任的一方。

OTOH，用户不信任您的 Winforms 应用程序。如果您将登录页面实现为 WinForm，他们如何知道使用他们的凭据信任您的应用程序？

在 WinForms 应用程序中执行此操作的唯一方法是将 Web 浏览器控件嵌入到您的登录表单中，但我认为与它进行通信以获取身份验证信息可能是一个挑战。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-11-20T11:57:39.427

这里有一个用于 Windows 窗体的 OpenID 认证客户端库：

[身份模型.OidcClient2](https://github.com/IdentityModel/IdentityModel.OidcClient2)

# c# - 获取 Shell 使用的文件图标

> ID：462270
> 
> 赞同：51
> 
> 时间：2009-01-20T17:30:05.507
> 
> 标签：c#, .net, vb.net, winforms, shell-icons

在 .Net（C# 或 VB：不关心）中，给定一个真实现有文件的文件路径字符串、FileInfo 结构或 FileSystemInfo 结构，我如何确定 shell（资源管理器）为此使用的图标文件？

我目前不打算将它用于任何事情，但是当我看到[这个问题](https://stackoverflow.com/questions/462232/what-is-the-best-vb-net-control-standard-custom-for-displaying-list-of-files)时，我对如何做到这一点感到好奇，我认为在 SO 上存档会很有用。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-01-20T17:40:42.707

```
Imports System.Drawing
Module Module1

    Sub Main()    
        Dim filePath As String =  "C:\myfile.exe"  
        Dim TheIcon As Icon = IconFromFilePath(filePath)  

        If TheIcon IsNot Nothing Then    
            ''#Save it to disk, or do whatever you want with it.
            Using stream As New System.IO.FileStream("c:\myfile.ico", IO.FileMode.CreateNew)
                TheIcon.Save(stream)          
            End Using
        End If
    End Sub

    Public Function IconFromFilePath(filePath As String) As Icon
        Dim result As Icon = Nothing
        Try
            result = Icon.ExtractAssociatedIcon(filePath)
        Catch ''# swallow and return nothing. You could supply a default Icon here as well
        End Try
        Return result
    End Function
End Module 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-01-20T18:24:03.947

请忽略所有告诉您使用注册表的人！注册表不是 API。您想要的 API 是带有 SHGFI_ICON 的 SHGetFileInfo。您可以在此处获得 P/Invoke 签名：

[http://www.pinvoke.net/default.aspx/shell32.SHGetFileInfo](http://www.pinvoke.net/default.aspx/shell32.SHGetFileInfo)

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-05-05T02:26:42.037

您应该使用 SHGetFileInfo。

Icon.ExtractAssociatedIcon 在大多数情况下与 SHGetFileInfo 一样有效，但 SHGetFileInfo 可以与 UNC 路径（例如，像“\\ComputerName\SharedFolder\”这样的网络路径）一起工作，而 Icon.ExtractAssociatedIcon 不能。如果您需要或可能需要使用 UNC 路径，最好使用 SHGetFileInfo 而不是 Icon.ExtractAssociatedIcon。

这是一篇关于如何使用 SHGetFileInfo[的优秀 CodeProject 文章。](http://www.codeproject.com/KB/files/fileicon.aspx)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2013-10-18T08:08:57.987

只不过是 Stefan 答案的 C# 版本。

```
using System.Drawing;

class Class1
{
    public static void Main()
    {
        var filePath =  @"C:\myfile.exe";
        var theIcon = IconFromFilePath(filePath);

        if (theIcon != null)
        {
            // Save it to disk, or do whatever you want with it.
            using (var stream = new System.IO.FileStream(@"c:\myfile.ico", System.IO.FileMode.CreateNew))
            {
                theIcon.Save(stream);
            }
        }
    }

    public static Icon IconFromFilePath(string filePath)
    {
        var result = (Icon)null;

        try
        {
            result = Icon.ExtractAssociatedIcon(filePath);
        }
        catch (System.Exception)
        {
            // swallow and return nothing. You could supply a default Icon here as well
        }

        return result;
    }
} 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-06-10T16:46:39.263

这在我的项目中对我有用，希望这对某人有所帮助。

它是带有 P/Invokes 的 C#，它可以在 WinXP 以来的 x86/x64 系统上运行。

（壳牌.cs）

```
using System;
using System.Drawing;
using System.IO;
using System.Runtime.InteropServices;

namespace IconExtraction
{
    internal sealed class Shell : NativeMethods
    {
        #region OfExtension

        ///<summary>
        /// Get the icon of an extension
        ///</summary>
        ///<param name="filename">filename</param>
        ///<param name="overlay">bool symlink overlay</param>
        ///<returns>Icon</returns>
        public static Icon OfExtension(string filename, bool overlay = false)
        {
            string filepath;
            string[] extension = filename.Split('.');
            string dirpath = Path.Combine(System.AppDomain.CurrentDomain.BaseDirectory, "cache");
            Directory.CreateDirectory(dirpath);
            if (String.IsNullOrEmpty(filename) || extension.Length == 1)
            {
                filepath = Path.Combine(dirpath, "dummy_file");
            }
            else
            {
                filepath = Path.Combine(dirpath, String.Join(".", "dummy", extension[extension.Length - 1]));
            }
            if (File.Exists(filepath) == false)
            {
                File.Create(filepath);
            }
            Icon icon = OfPath(filepath, true, true, overlay);
            return icon;
        }
        #endregion

        #region OfFolder

        ///<summary>
        /// Get the icon of an extension
        ///</summary>
        ///<returns>Icon</returns>
        ///<param name="overlay">bool symlink overlay</param>
        public static Icon OfFolder(bool overlay = false)
        {
            string dirpath = Path.Combine(System.AppDomain.CurrentDomain.BaseDirectory, "cache", "dummy");
            Directory.CreateDirectory(dirpath);
            Icon icon = OfPath(dirpath, true, true, overlay);
            return icon;
        }
        #endregion

        #region OfPath

        ///<summary>
        /// Get the normal,small assigned icon of the given path
        ///</summary>
        ///<param name="filepath">physical path</param>
        ///<param name="small">bool small icon</param>
        ///<param name="checkdisk">bool fileicon</param>
        ///<param name="overlay">bool symlink overlay</param>
        ///<returns>Icon</returns>
        public static Icon OfPath(string filepath, bool small = true, bool checkdisk = true, bool overlay = false)
        {
            Icon clone;
            SHGFI_Flag flags;
            SHFILEINFO shinfo = new SHFILEINFO();
            if (small)
            {
                flags = SHGFI_Flag.SHGFI_ICON | SHGFI_Flag.SHGFI_SMALLICON;
            }
            else
            {
                flags = SHGFI_Flag.SHGFI_ICON | SHGFI_Flag.SHGFI_LARGEICON;
            }
            if (checkdisk == false)
            {
                flags |= SHGFI_Flag.SHGFI_USEFILEATTRIBUTES;
            }
            if (overlay)
            {
                flags |= SHGFI_Flag.SHGFI_LINKOVERLAY;
            }
            if (SHGetFileInfo(filepath, 0, ref shinfo, Marshal.SizeOf(shinfo), flags) == 0)
            {
                throw (new FileNotFoundException());
            }
            Icon tmp = Icon.FromHandle(shinfo.hIcon);
            clone = (Icon)tmp.Clone();
            tmp.Dispose();
            if (DestroyIcon(shinfo.hIcon) != 0)
            {
                return clone;
            }
            return clone;
        }
        #endregion
    }
} 
```

(NativeMethods.cs)

```
using System;
using System.Drawing;
using System.Runtime.InteropServices;

namespace IconExtraction
{
    internal class NativeMethods
    {
        public struct SHFILEINFO
        {
            public IntPtr hIcon;
            public int iIcon;
            public uint dwAttributes;
            [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 260)]
            public string szDisplayName;
            [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 80)]
            public string szTypeName;
        };

        [DllImport("user32.dll")]
        public static extern int DestroyIcon(IntPtr hIcon);

        [DllImport("shell32.dll", CharSet = CharSet.Auto, BestFitMapping = false, ThrowOnUnmappableChar = true)]
        public static extern IntPtr ExtractIcon(IntPtr hInst, string lpszExeFileName, int nIconIndex);

        [DllImport("Shell32.dll", BestFitMapping = false, ThrowOnUnmappableChar = true)]
        public static extern int SHGetFileInfo(string pszPath, int dwFileAttributes, ref SHFILEINFO psfi, int cbFileInfo, SHGFI_Flag uFlags);

        [DllImport("Shell32.dll")]
        public static extern int SHGetFileInfo(IntPtr pszPath, uint dwFileAttributes, ref SHFILEINFO psfi, int cbFileInfo, SHGFI_Flag uFlags);
    }

    public enum SHGFI_Flag : uint
    {
        SHGFI_ATTR_SPECIFIED = 0x000020000,
        SHGFI_OPENICON = 0x000000002,
        SHGFI_USEFILEATTRIBUTES = 0x000000010,
        SHGFI_ADDOVERLAYS = 0x000000020,
        SHGFI_DISPLAYNAME = 0x000000200,
        SHGFI_EXETYPE = 0x000002000,
        SHGFI_ICON = 0x000000100,
        SHGFI_ICONLOCATION = 0x000001000,
        SHGFI_LARGEICON = 0x000000000,
        SHGFI_SMALLICON = 0x000000001,
        SHGFI_SHELLICONSIZE = 0x000000004,
        SHGFI_LINKOVERLAY = 0x000008000,
        SHGFI_SYSICONINDEX = 0x000004000,
        SHGFI_TYPENAME = 0x000000400
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-07-27T19:49:50.027

注册表方法的问题在于您没有明确获取图标索引 ID。有时（如果不是所有时候），您会得到一个图标 ResourceID，它是应用程序开发人员用来命名图标插槽的别名。

因此，注册表方法意味着所有开发人员都使用与隐式图标索引 id 相同的 ResourceID（它是从零开始的、绝对的、确定性的）。

扫描注册表位置，您会看到很多负数，有时甚至是文本引用 - 即不是图标索引 ID。隐式方法似乎更好，因为它可以让操作系统完成工作。

现在只测试这种新方法，但它很有意义，并有望解决这个问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-06-29T06:48:51.857

如果您只对特定扩展名的图标感兴趣并且不介意创建临时文件，则可以按照[此处显示的示例进行操作](http://www.vbforums.com/showthread.php?t=84721)

C#代码：

```
 public Icon LoadIconFromExtension(string extension)
    {
        string path = string.Format("dummy{0}", extension);
        using (File.Create(path)) { }
        Icon icon = Icon.ExtractAssociatedIcon(path);
        File.Delete(path);
        return icon;
    } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-20T17:42:17.650

[这个](http://msdn.microsoft.com/en-us/magazine/cc301425.aspx)链接似乎有一些信息。它涉及大量的注册表遍历，但它似乎是可行的。示例在 C++ 中

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-20T17:48:08.120

*   确定扩展
*   在注册表中，转到`"HKCR\.{extension}"`，读取默认值（我们称之为`filetype`）
*   在 中`"HKCR\{filetype}\DefaultIcon"`，读取默认值：这是图标文件（或图标容器文件，如带有嵌入图标资源的 .exe）的路径
*   如果需要，请使用您首选的方法从上述文件中提取图标资源

编辑/从评论上移：

如果图标在容器文件中（这很常见），路径后面会有一个计数器，如下所示：`"foo.exe,3"`. 这意味着它是可用图标的第 4 个图标（索引从零开始）。“,0”的值是隐含的（和可选的）。如果计数器为 0 或缺失，shell 将使用第一个可用图标。

# nhibernate - NHibernate - 映射字符串外键

> ID：462281
> 
> 赞同：4
> 
> 时间：2009-01-20T17:32:48.650
> 
> 标签：nhibernate, nhibernate-mapping

我继承的遗留数据库包含以下表格：

```
Teams ( 
 TeamId INT PRIMARY KEY,
 Name VARCHAR(30)
)

Players (
 PlayerId INT PRIMARY KEY,
 Team VARCHAR(30)
) 
```

球员表中的外键指的是球队名称，而不是teamId。

我尝试使用包从团队映射到玩家：

```
<bag name="Players">
    <key column="Team" foreign-key="Name" />
    <one-to-many class="DataTransfer.Player, DataTransfer" />
</bag> 
```

但我得到 SqlException：将 varchar 值“Arsenal”转换为数据类型 int 时转换失败

我已经能够使用包来映射其他区域的字符串外键，但在这些情况下，外键指的是父表的主键。

编辑：我正在使用 NHibernate 2.0.1

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T19:11:01.260

I think the property-ref attribute exists to solve this problem.

```
<bag name="Players">
   <key column="Team" property-ref="Team" />
   <one-to-many class="Player" property-ref="Team" />
</bag> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-20T18:28:42.063

现在我不能 100% 确定这是否可行，但您是否尝试过多对一映射关系？

也许是这样的：

```
<many-to-one name="Players" class="DataTransfer.Player, DataTransfer"
             column="Name" property-ref="Team" /> 
```

我相信这应该有效，根据 NHibernate 手册，property-ref 是一个用于映射遗留数据的属性，其中外键是指关联表的唯一键而不是主键。这听起来像你发现自己的情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T18:34:06.343

我相信您需要使用 property-ref 属性来定义您将关联的字段。外键属性用于生成 DDL 以创建关系（如果您使用该功能）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-20T10:06:34.330

刚刚发现这个：[https](https://nhibernate.jira.com/browse/NH-1272) : //nhibernate.jira.com/browse/NH-1272，似乎这是NHibernate中的一个错误，它已在2.1.0Alpha1中修复。

我已经在 NHibernate 2.1.0Alpha2 中尝试过，它可以工作！

（property-ref 应该只在地图标签中）

# c++ - 客户不会与 ATL 服务对话

> ID：462296
> 
> 赞同：0
> 
> 时间：2009-01-20T17:38:29.857
> 
> 标签：c++, com, service, atl

我在导出 COM 对象的 ATL 服务时遇到问题。它作为本地服务运行，但是当作为 Windows 服务运行时，我无法连接。该服务正确启动并运行，但我的客户端（下面的代码）总是失败并出现错误“无法启动服务”。

所以我们在看同样的事情，我已经建立了一个最小的项目，可以在我的 PC 上重现这个问题。

File->New Project
Visual C++ -> ATL "ATL Project"
Name: "MyService"
在Application Settings下，选择"Service (EXE)"

转到“类视图”
右键单击“MyService”并添加 -> 类
选择：“ATL 简单对象”
短名称：“MyObject”

转到“解决方案视图”
右键单击“解决方案'MyService'”并添加->“新建项目”
这将是一个“Visual C++”->“Win32”“Win32 控制台应用程序”
名称：“MyClient”
检查“添加ATL 的通用头文件”框

在 client.cpp 中，使用以下代码：

```
#include "stdafx.h"
#import "../MyService/Debug/MyService.tlb"

#include <iostream>

using namespace MyServiceLib;

int _tmain(int argc, _TCHAR* argv[])
{
    ::CoInitialize( NULL );

    try
    {
        IMyObjectPtr spQueue( __uuidof( MyObject ) );
    }
    catch( const _com_error& Err )
    {
        std::wcout << L"Error: " << Err.ErrorMessage() << std::endl;
    }
    catch( ... )
    {
        std::wcout << L"Unexpected Error" << std::endl;
    }

    ::CoUninitialize();
    std::wcout << L"Finished" << std::endl;

    return 0;
} 
```

打开“项目依赖”
项目“MyClient”依赖于“MyService”

构建解决方案。

在命令提示符下，运行以下命令：
MyService /Service
net start MyService
client

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T18:10:20.337

您是否在应用程序 MyClient 中选择选项“添加通用头文件：ATL”？这个在我的测试中工作正常。

让服务在您的用户帐户（默认为系统帐户）下运行，以便在调试 IDE 时访问。

好锁。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T19:22:16.823

您可能需要在 progid 下创建额外的注册表项。我看不到您在哪里调用“CoInitializeSecurity”

[Microsoft 在http://msdn.microsoft.com/en-us/library/3ts2dxc8.aspx](http://msdn.microsoft.com/en-us/library/3ts2dxc8.aspx)提供了一个示例

--

迈克尔

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-05T15:59:49.860

ATL 注册表模板 (Visual Studio 2008/2010) 中有一个错误。组件的 .rgs 文件缺少 AppID 值，如[本 MSDN 博客中所述](http://blogs.msdn.com/b/jigarme/archive/2008/05/08/cocreateinstance-returns-0x80080005-for-visual-studio-2008-based-atl-service.aspx)

在 MyObject.rgs 中的*'TypeLib...'*行上方添加以下行

```
val AppID = s '%APPID%' 
```

# java - 如何使用类 在 Java 中？

> ID：462297
> 
> 赞同：277
> 
> 时间：2009-01-20T17:38:46.253
> 
> 标签：java, templates, class, generics

[在这个问题](https://stackoverflow.com/questions/31693/differences-in-generics)上有一个很好的讨论泛型以及它们在幕后的真正作用，所以我们都知道这`Vector<int[]>`是一个整数数组的向量，并且`HashTable<String, Person>`是一个其键是字符串和值`Person`的表。然而，让我难过的是`Class<>`.

java 类`Class`也应该采用模板名称，（或者我被 eclipse 中的黄色下划线告知）。我不明白我应该在那里放什么。对象的全部意义在于`Class`您不完全掌握有关对象的信息，例如反射等。为什么它让我指定`Class`对象将持有哪个类？我显然不知道，或者我不会使用该`Class`对象，我会使用特定的对象。

* * *

## 回答 #1

> 赞同：220
> 
> 时间：2013-10-23T14:51:16.437

我们所知道的是“*任何类的所有实例都共享该类的相同 java.lang.Class 对象*”

例如）

```
Student a = new Student();
Student b = new Student(); 
```

那么`a.getClass() == b.getClass()`是真的。

现在假设

```
Teacher t = new Teacher(); 
```

没有泛型，以下是可能的。

```
Class studentClassRef = t.getClass(); 
```

但是现在这是错误的..？

例如）`public void printStudentClassInfo(Class studentClassRef) {}`可以调用`Teacher.class`

使用泛型可以避免这种情况。

```
Class<Student> studentClassRef = t.getClass(); //Compilation error. 
```

现在T是什么？？T 是类型参数（也称为类型变量）；由尖括号 (<>) 分隔，跟在类名之后。
T 只是一个符号，就像在编写类文件时声明的变量名（可以是任何名称）。
稍后在初始化期间T 将被替换为有效的类名 ( `HashMap<String> map = new HashMap<String>();`)

例如）`class name<T1, T2, ..., Tn>`

所以`Class<T>`表示特定类类型' `T`'的类对象。

假设您的类方法必须使用未知类型参数，如下所示

```
/**
 * Generic version of the Car class.
 * @param <T> the type of the value
 */
public class Car<T> {
    // T stands for "Type"
    private T t;

    public void set(T t) { this.t = t; }
    public T get() { return t; }
} 
```

这里 T 可以用作**CarName**`String`的类型

 **OR T 可以用作**modelNumber**`Integer`的类型，

 **OR T 可以用作**有效汽车实例**`Object`的类型。

 **现在，上面是简单的 POJO，它可以在运行时以不同的方式使用。
集合，例如）List、Set、Hashmap 是最好的例子，它们将根据 T 的声明与不同的对象一起工作，但是一旦我们将 T 声明为 String，
例如）`HashMap<String> map = new HashMap<String>();`那么它将只接受 String 类实例对象。

**通用方法**

泛型方法是引入自己的类型参数的方法。这类似于声明泛型类型，但类型参数的范围仅限于声明它的方法。允许使用静态和非静态泛型方法，以及泛型类构造函数。

泛型方法的语法包括类型参数，位于尖括号内，并出现在方法的返回类型之前。对于泛型方法，类型参数部分必须出现在方法的返回类型之前。

```
 class Util {
    // Generic static method
    public static <K, V, Z, Y> boolean compare(Pair<K, V> p1, Pair<Z, Y> p2) {
        return p1.getKey().equals(p2.getKey()) &&
               p1.getValue().equals(p2.getValue());
    }
}

 class Pair<K, V> {

    private K key;
    private V value;
} 
```

这`<K, V, Z, Y>`是方法参数中使用的类型声明，它应该在返回类型之前`boolean`。

在下面; `<T>`方法级别不需要类型声明，因为它已经在类级别声明。

```
class MyClass<T> {
   private  T myMethod(T a){
       return  a;
   }
} 
```

但是下面是错误的，因为类级别的类型参数 K、V、Z 和 Y 不能在静态上下文中使用（这里是静态方法）。

```
class Util <K, V, Z, Y>{
    // Generic static method
    public static  boolean compare(Pair<K, V> p1, Pair<Z, Y> p2) {
        return p1.getKey().equals(p2.getKey()) &&
               p1.getValue().equals(p2.getValue());
    }
} 
```

**其他有效场景是**

```
class MyClass<T> {

        //Type declaration <T> already done at class level
        private  T myMethod(T a){
            return  a;
        }

        //<T> is overriding the T declared at Class level;
        //So There is no ClassCastException though a is not the type of T declared at MyClass<T>. 
        private <T> T myMethod1(Object a){
                return (T) a;
        }

        //Runtime ClassCastException will be thrown if a is not the type T (MyClass<T>).  
        private T myMethod1(Object a){
                return (T) a;
        }       

        // No ClassCastException        
        // MyClass<String> obj= new MyClass<String>();
        // obj.myMethod2(Integer.valueOf("1"));
        // Since type T is redefined at this method level.
        private <T> T myMethod2(T a){
            return  a;
        }

        // No ClassCastException for the below
        // MyClass<String> o= new MyClass<String>();
        // o.myMethod3(Integer.valueOf("1").getClass())
        // Since <T> is undefined within this method; 
        // And MyClass<T> don't have impact here
        private <T> T myMethod3(Class a){
            return (T) a;
        }

        // ClassCastException for o.myMethod3(Integer.valueOf("1").getClass())
        // Should be o.myMethod3(String.valueOf("1").getClass())
    private  T myMethod3(Class a){
        return (T) a;
    }

        // Class<T> a :: a is Class object of type T
        //<T> is overriding of class level type declaration; 
        private <T> Class<T> myMethod4(Class<T> a){
            return  a;
        }
    } 
```

最后静态方法总是需要显式`<T>`声明；它不会从类级别派生`Class<T>`。这是因为类级别 T 与实例绑定。

另请阅读[泛型限制](https://docs.oracle.com/javase/tutorial/java/generics/restrictions.html#createStatic)

[通配符和子类型](https://docs.oracle.com/javase/tutorial/java/generics/subtyping.html)

[泛型方法的类型参数](https://stackoverflow.com/questions/4829631/unusual-generic-syntax-arrays-stringaslist)

* * *

## 回答 #2

> 赞同：150
> 
> 时间：2009-01-20T17:45:16.863

使用类 Class 的通用版本，除其他外，您可以编写类似的东西

```
Class<? extends Collection> someCollectionClass = someMethod(); 
```

然后您可以确定您收到的 Class 对象 extends `Collection`，并且此类的一个实例将（至少）是一个 Collection。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2009-01-20T17:41:20.677

来自 Java 文档：

[...] 更令人惊讶的是，类 Class 已被泛化。类文字现在用作类型标记，提供运行时和编译时类型信息。这启用了一种静态工厂风格，以新 AnnotatedElement 接口中的 getAnnotation 方法为例：

```
<T extends Annotation> T getAnnotation(Class<T> annotationType); 
```

这是一个通用的方法。它从参数推断其类型参数 T 的值，并返回一个适当的 T 实例，如以下代码段所示：

```
Author a = Othello.class.getAnnotation(Author.class); 
```

在泛型之前，您必须将结果转换为 Author。此外，您将无法让编译器检查实际参数是否代表 Annotation 的子类。[...]

好吧，我从来不用这种东西。任何人？

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-01-20T21:52:48.330

我发现`class<T>`在创建服务注册表查找时很有用。例如

```
<T> T getService(Class<T> serviceClass)
{
    ...
} 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-11-07T16:29:53.913

在@Kire Haglin 的回答之后，可以在[JAXB unmarshalling 的文档中](http://jaxb.java.net/tutorial/section_3_1-Unmarshalling-and-Using-the-Data.html#Unmarshalling)看到泛型方法的另一个示例：

```
public <T> T unmarshal( Class<T> docClass, InputStream inputStream )
         throws JAXBException {
  String packageName = docClass.getPackage().getName();
  JAXBContext jc = JAXBContext.newInstance( packageName );
  Unmarshaller u = jc.createUnmarshaller();
  JAXBElement<T> doc = (JAXBElement<T>)u.unmarshal( inputStream );
  return doc.getValue();
} 
```

这允许`unmarshal`返回任意 JAXB 内容树类型的文档。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-20T17:53:39.717

`class`正如其他答案所指出的那样，将其设为通用有很多很好的理由。但是，很多时候您无法知道要使用的泛型类型`Class<T>`。在这些情况下，您可以简单地忽略黄色日食警告，或者您可以使用`Class<?>`...我就是这样做的；）

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2019-06-24T08:44:27.623

在java`<T>`中意味着泛型类。通用类是一个可以处理任何类型的*数据类型*的类，或者换句话说，我们可以说它是独立于数据类型的。

```
public class Shape<T> {
    // T stands for "Type"
    private T t;

    public void set(T t) { this.t = t; }
    public T get() { return t; }
} 
```

其中*T*表示类型。现在，当您创建此 Shape 类的实例时，您需要告诉编译器它将处理哪种数据类型。

例子：

```
Shape<Integer> s1 = new Shape();
Shape<String> s2 = new Shape(); 
```

*Integer*是一种类型，*String*也是一种类型。

`<T>`特别代表泛型类型。根据 Java Docs - 泛型类型是在类型上*参数化*的泛型类或接口。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-20T17:47:13.943

您经常希望将通配符与`Class`. 例如，`Class<? extends JComponent>`, 将允许您指定该类是 的某个子类`JComponent`。如果您`Class`已从 检索实例`Class.forName`，那么您可以`Class.asSubclass`在尝试构建实例之前使用它进行转换。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-04-10T08:13:15.707

举另一个例子，Class ( `Class<T>`) 的泛型版本允许编写如下泛型函数。

```
public static <T extends Enum<T>>Optional<T> optionalFromString(
        @NotNull Class<T> clazz,
        String name
) {
    return Optional<T> opt = Optional.ofNullable(name)
            .map(String::trim)
            .filter(StringUtils::isNotBlank)
            .map(String::toUpperCase)
            .flatMap(n -> {
                try {
                    return Optional.of(Enum.valueOf(clazz, n));
                } catch (Exception e) {
                    return Optional.empty();
                }
            });
} 
```

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2010-02-02T12:25:39.740

一开始很混乱。但它在以下情况下有所帮助：

```
class SomeAction implements Action {
}

// Later in the code.
Class<Action> actionClass = Class.forName("SomeAction"); 
Action action = actionClass.newInstance();
// Notice you get an Action instance, there was no need to cast. 
```

* * *

## 回答 #11

> 赞同：-4
> 
> 时间：2013-07-29T18:50:17.447

只需使用牛肉类：

```
public <T> T beefmarshal( Class<beef> beefClass, InputBeef inputBeef )
     throws JAXBException {
     String packageName = docClass.getPackage().getBeef();
     JAXBContext beef = JAXBContext.newInstance( packageName );
     Unmarshaller u = beef.createBeef();
     JAXBElement<T> doc = (JAXBElement<T>)u.beefmarshal( inputBeef );
     return doc.getBeef();
} 
```

# c# - 是否可以通过 URI 引用存储在独立存储中的文件？

> ID：462307
> 
> 赞同：3
> 
> 时间：2009-01-20T17:41:26.467
> 
> 标签：c#, wpf, isolatedstorage

以上[一个问题](https://stackoverflow.com/questions/458307/what-is-the-best-practice-for-storing-and-processing-images-and-videos)为动力，我想将图像和视频临时存储在独立存储中。我的应用程序（用 WPF/C# 编写）将允许用户通过查看它们在[MediaElement](http://msdn.microsoft.com/en-us/library/system.windows.controls.mediaelement.aspx)中的内容来查看这些临时存储的项目。我希望将 MediaElement 的[Source 属性](http://msdn.microsoft.com/en-us/library/system.windows.controls.mediaelement.source.aspx)设置为存储在 IsolatedStorage 中的视频或图像的 URI，但我无法弄清楚如何动态创建 URI，因为它似乎不受独立存储的天真支持。任何帮助将不胜感激 - 在此先感谢您！

**更新 - 2009** 年 1 月 21 日 在解决了一天的问题后，我得出结论，隔离存储方法不适用于存储需要由 Uri 引用的大型视频文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-02-19T19:30:50.717

隔离存储旨在为您提供一种在客户端存储数据的方法，而无需知道您存储的文件的具体位置。缺少 URI 的原因是将您存储的文件保存在“安全沙箱”中。您也许能够找到一种方法来获取实际的 URI，但如果有一种方法，Microsoft 很可能会发布一个安全补丁来破坏您的代码。

我会找到一种不同的方式来完成你的任务。尝试“对抗”平台中的安全设置通常是一个坏主意，因为未来的平台更改可能会破坏您的应用程序。

# c# - 用于嵌入 C#/.NET 应用程序的脚本语言？

> ID：462311
> 
> 赞同：14
> 
> 时间：2009-01-20T17:42:38.740
> 
> 标签：c#, .net, scripting, embed

*[我能找到的[唯一类似问题](https://stackoverflow.com/questions/137933/what-is-the-best-scripting-language-to-embed-in-a-c-desktop-application)很久以前就得到了回答，并且主要包含对 IronPython 的引用。我也想考虑其他选择]*

我们有一个用 C# 编写的复杂数据分析应用程序。该应用程序应为用户提供定制其数据分析任务的复杂方法。目前，我们混合使用配置文件和 Excel 表格来指定它，但它变得笨拙，因此我们正在寻找一种脚本语言来嵌入。

用于 C#/.NET 嵌入的最佳简单脚本语言是什么？是否有可能以类似于 Excel/Word 的方式嵌入 VBA？或者是否使用了 JavaScript/Lua？

不用说，将一些 API 和对象从主应用程序公开到嵌入式脚本中应该很容易。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-20T17:48:23.317

我知道另一个问题引用[IronPython](http://www.codeplex.com/IronPython)，但我仍然觉得它应该在这里，因为我认为它是最好的选择之一。

另一个不错的选择是[IronRuby](http://www.ironruby.net/)。我看到的主要区别是您的开发人员/用户是否有任何可以转移的 Python 或 Ruby 经验。

真的，最终你最好的选择将是一种最容易被用户适应的语言。除非他们接受它并且能够比使用旧方法更有效率，否则不值得付出努力。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-20T17:43:47.787

也许[嘘？](http://boo.codehaus.org)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-20T17:49:24.623

路亚太棒了！Lua 与 .NET 配合得非常好。我写了一篇关于如何开始嵌入 Lua 和 C# 的博客文章，可能值得一看：

[http://blog.apterainc.com/software/embedding-lua-and-c/](http://blog.apterainc.com/software/embedding-lua-and-c/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-20T18:02:47.810

我会研究仅 XAML 的 Windows 工作流。您可以重新托管设计器，并提供可以拖出并用于以他们喜欢的任何方式操作数据的自定义活动。非常直观。我目前在我的一个应用程序中使用它，用户似乎很喜欢它。虽然它的学习曲线很小，但它远不如典型的脚本语言，而且人们似乎能够相当快地掌握它，尤其是那些有使用流程图和 Visio 经验的人。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-20T17:46:14.707

我知道您要求使用脚本技术，但基本需求是非程序员的代码控制。我们使用[.Net 的 ILOG 规则](http://www.ilog.com/products/rulesnet/index.cfm)来满足这一需求。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-20T17:50:51.173

嗯，C#呢？没有理由不能让用户编写 C#，然后安全地将其加载到具有所有正确限制和保护措施的另一个 AppDomain 中。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-20T17:51:35.523

[JScript.NET](http://www.west-wind.com/WebLog/posts/10688.aspx)或[PowerShell](http://www.codeproject.com/KB/cs/HowToRunPowerShell.aspx)呢？

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-20T18:03:27.530

我认为通过 CodeDom 使用 C# 是非常强大的解决方案

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-28T21:56:18.060

已经提到了 Boo 和 IronPython，但不要忘记[IronScheme](http://www.codeplex.com/IronScheme)、[F#](http://en.wikipedia.org/wiki/F_Sharp_programming_language)或任何[其他](http://en.wikipedia.org/wiki/List_of_CLI_Languages)已移植到 CIL 虚拟机并具有运行时编译/解释的语言。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-08-05T18:13:19.343

IronRuby 每天都看起来更好。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-20T18:05:36.197

有很多很多的[脚本语言](http://en.wikipedia.org/wiki/Scripting_language)。哪个最适合您取决于您​​要做什么。

您应该分析用户需要执行的任务、他们已经熟悉的符号，并选择与他们匹配的现有脚本语言。您不应该选择一种流行的脚本语言，然后强迫您的应用程序和用户适应它。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-20T18:04:13.113

我也会投票赞成使用 C# 来编写你的扩展。除非您有令人信服的理由，例如现有用户群已经熟悉 python、ruby 或 boo，否则引入另一种语言只会增加复杂性和培训成本。

# sql-server - 通过 sp_executesql 执行存储过程

> ID：462312
> 
> 赞同：4
> 
> 时间：2009-01-20T17:42:43.687
> 
> 标签：sql-server, stored-procedures

我正在尝试在另一个存储过程中执行一个存储过程。问题是存储过程名称是在第一个过程中动态构建的。这是我正在尝试做的一个例子......

```
CREATE PROCEDURE SPINSVALUE_12345
    @guid uniqueidentifier
AS
    DECLARE @returnValue bit
    DECLARE @spToExec NVARCHAR(255)
    SET @returnValue = 0
    WHILE (@returnValue=0)
    BEGIN
         SET @spToExec = 'SPINSVALUE_' + REPLACE(@guid, '-', '_')
         ... DO OTHER STUFF ...
         EXEC sp_executeSQL @spToExec, N'@returnValue BIT OUTPUT', @returnValue OUTPUT
    END
END 
```

我似乎无法让 sp_executeSQL 工作。是否可以以这种方式执行存储过程并从 OUTPUT 参数中获取值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-20T17:56:39.273

proc 有返回值还是输出值？这是一个例子

```
create proc prBlatest
as
return 5
go

DECLARE @chvTableName VARCHAR(100),
@intTableCount INT,
@chvSQL NVARCHAR(100)

SELECT @chvTableName = 'prBlatest'
SELECT @chvSQL = N'exec @intTableCount = ' + @chvTableName

EXEC sp_executesql @chvSQL, N'@intTableCount INT OUTPUT', @intTableCount OUTPUT

SELECT @intTableCount
GO 
```

顺便说一句，我认为让许多 proc 做类似事情是个坏主意，也许你需要重构

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-30T17:10:58.493

抱歉耽搁了：D，以下代码完美运行（对于 N.. 输出和输入参数）请试试这个（[来源](http://support.microsoft.com/kb/262499)）：

```
CREATE PROCEDURE Myproc
@parm varchar(10),

@parm1OUT varchar(30) OUTPUT,
@parm2OUT varchar(30) OUTPUT
AS
SELECT @parm1OUT='parm 1' + @parm
SELECT @parm2OUT='parm 2' + @parm
GO
DECLARE @SQLString NVARCHAR(500)
DECLARE @ParmDefinition NVARCHAR(500)
DECLARE @parmIN VARCHAR(10)
DECLARE @parmRET1 VARCHAR(30)
DECLARE @parmRET2 VARCHAR(30)
SET @parmIN=' returned'
SET @SQLString=N'EXEC Myproc @parm,
@parm1OUT OUTPUT, @parm2OUT OUTPUT'
SET @ParmDefinition=N'@parm varchar(10),
@parm1OUT varchar(30) OUTPUT,
@parm2OUT varchar(30) OUTPUT'

EXECUTE sp_executesql
@SQLString,
@ParmDefinition,
@parm=@parmIN,
@parm1OUT=@parmRET1 OUTPUT,@parm2OUT=@parmRET2 OUTPUT

SELECT @parmRET1 AS "parameter 1", @parmRET2 AS "parameter 2"
go
drop procedure Myproc 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T18:02:06.267

试试这个：

```
SET @spToExec = 'EXEC SPINSVALUE' + REPLACE(@guid, '-', '_') + ' @returnValue OUT'        
EXEC sp_executeSQL @spToExec, N'@returnValue int OUTPUT', @returnValue OUTPUT 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-12T21:15:28.753

我想补充一下 SQLMenace 的答案。他的回答帮助我朝着正确的方向前进。在过程需要参数的情况下，它们必须在语句参数中声明。

```
create proc prBlatest @in int
as
return 5 + @in
go

DECLARE @chvTableName VARCHAR(100),
    @intTableCount INT,
    @chvSQL NVARCHAR(100)

SELECT @chvTableName = 'prBlatest'
SELECT @chvSQL = N'exec @intTableCount = ' + @chvTableName + ' @inputParam' 
        --NOTICE the @in parameter is declared in the statement parameter

EXEC sp_executesql @chvSQL, N'@inputParam int, @intTableCount INT OUTPUT'
    , @inputParam = 5
    , @intTableCount = @intTableCount OUTPUT

SELECT @intTableCount
GO 
```

在这种情况下返回值 10。

参数可以使用它们的名称来设置（使用来自 @params 列表的名称）以避免在有很多时混淆。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-07-17T11:12:46.900

```
DECLARE @SQL NVARCHAR(100)
DECLARE @return_value int 
SET @SQL = '[dbo].[SpData] @id = 1' 
EXECUTE sp_executesql @SQL ,N'@return_value INT OUTPUT', @return_value OUTPUT" 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-12-15T21:14:01.770

非常方便，我用这部分来重建一些部分。希望它对某些人有所帮助；

```
CREATE PROCEDURE Myproc
AS
GO
    DECLARE @ProcName  VARCHAR(255) = 'Procedure-Name'
    DECLARE @SQLString NVARCHAR(500)
    DECLARE @ParmDefinition NVARCHAR(500)
    DECLARE @parmIN VARCHAR(10)
    DECLARE @parmRET1 INT
    DECLARE @v_file_prefix varchar(255) = @ProcName
    DECLARE @v_file_identifier varchar(255) = '004faae0-5927-43f0-a3fb-aa24fcdbbef3'
    DECLARE @v_path varchar(255) = 'C:\INPUT\DataTransfer\Customers\Upload'

    BEGIN 
        --SET @parmIN=' returned'
        SET @SQLString=N'EXEC [src].[Load' + @ProcName + '] @p_file_prefix, @p_file_identifier, @p_path, @RowCount OUTPUT'
        SET @ParmDefinition=N'@p_file_prefix varchar(255), @p_file_identifier varchar(255),@p_path varchar(255),@RowCount INT OUTPUT'

        EXECUTE sp_executesql
        @SQLString,
        @ParmDefinition,
        @p_file_prefix=@v_file_prefix,
        @p_file_identifier=@v_file_identifier,
        @p_path=@v_path,
        @RowCount=@parmRET1 OUTPUT
    END;

SELECT @parmRET1 AS "parameter 1"
go 
```

# c# - .NET 在服务器上创建计划任务失败并显示 E_ACCESSDENIED

> ID：462313
> 
> 赞同：3
> 
> 时间：2009-01-20T17:43:29.330
> 
> 标签：c#, .net, asp.net, permissions, scheduled-tasks

我有一个 ASP.NET 网站（在 C# 中），它接收用户数据，然后尝试创建一个 Windows 计划任务。当然，这在 DEV 机器上效果很好，但无法在服务器上运行。我试图弄清楚 ASPNET 用户（或匿名 Web 用户）创建任务需要哪些权限。

错误是：

```
Access is denied. (Exception from HRESULT: 0x80070005 (E_ACCESSDENIED)) 
Stacktrace: 
    at MyScheduler.NewWorkItem(String TaskName, Guid& rclsid, Guid& riid, Object& obj) 
    at MyScheduler.CreateTask(String name) 
```

我已经进行了一些搜索，建议的解决方案是使用 web.config 'impersonate' 标志来强制应用程序以具有足够权限的用户身份运行，而不是可能没有这些权限的 ASPNET 帐户。

例子：

```
<system.web>
    <identity impersonate="true" />
</system.web> 
```

不幸的是，这似乎并不能解决问题。从我阅读的文档中，这应该以匿名网络用户身份运行，但似乎用户没有足够的权限。

我更改了设置以指定恰好是计算机管理员的特定域用户。例子：

```
<system.web>
    <identity impersonate="true" userName="WindowsDomain\YourUserName" password="YourPassword" />
</system.web> 
```

这样做允许应用程序成功创建 Windows 计划任务。因此，显然，通过正确的 Windows 2003 权限集，我可以让应用程序像在开发环境中一样执行。但是，我不打算将网络或机器管理员帐户的用户凭据以纯文本形式放在 Web.config 文件中。

是否有人碰巧知道需要设置哪些权限才能使 ASPNET 帐户按预期运行？

**编辑：** Win32 API 用于创建计划任务。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T17:50:15.747

无需担心 ASPNET 用户权限，您的内部流程是否允许您创建特定于计算机的帐户并在那里提供凭据？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-26T13:18:27.980

我已经能够解决我的特定问题，尽管不是完全。我仍然没有确定创建和运行计划任务所需的确切权限，但以下似乎可行：

1.  添加`<identity impersonate="true" />`到 Web.config
2.  将 IUSR 用户（即应用程序将使用模拟运行的用户）添加到“Backup Operators”组。

这使应用程序可以访问“计划任务”文件夹，以便他们可以创建和运行任务。

我们还有一个问题，即任务试图以本地系统帐户运行。不幸的是，似乎只有管理员才能将本地系统帐户指定为运行用户，因此我们需要冒充管理员帐户，而不是备份操作员，以使我们的代码正常运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T17:48:40.227

你在给事件日志写东西吗？您的组件（我认为它托管在 IIS 中？）可能无法访问事件日志中的写入内容。

这只是一个猜测~前段时间我也遇到过类似的问题，我是这样解决的：

[点击](http://fgheysels.blogspot.com/2008/01/cannot-open-log-for-source-0-on-windows.html)

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2009-03-10T17:56:43.547

另一种选择是刷新服务器上的BIOS

# wxpython - wxWidgets 中的窗口溢出小部件

> ID：462320
> 
> 赞同：1
> 
> 时间：2009-01-20T17:44:51.823
> 
> 标签：wxpython, wxwidgets, shaped-window

我正在寻找一种在 Linux 上的 wxPython 中实现这种设计的方法......
我有一个带有按钮的工具栏，当按下按钮时，应该会出现一个弹出窗口，模仿工具栏的扩展（如菜单），并且这个弹出窗口应该显示两列单选按钮（比如 2x5）和一个文本框......我的主要问题是工具栏的高度很小，所以弹出窗口必须溢出窗口/客户区的边界......

我想到了两种可能的实现：

*   通过使用 wxMenu，因为*可以*在客户区之外绘制菜单。我担心布局可能性对于我的目标不够灵活
*   通过使用异形框架。按下按钮将重新塑造框架并根据要求绘制所需的小部件。

我的问题是：我错过了什么/错了吗？:) 这完全可行吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T18:04:57.963

使用菜单是不行的，因为`wxWidgets`不能将小部件放在菜单上。原则上可以使用异形框架，但问题是要获取您单击的按钮的位置，以便在正确的位置显示窗口。那时我试图这样做，但没有运气（在 C++ wxWidgets 中）。也许这种情况在两者之间发生了变化，祝你好运。

您也可以尝试一个`wxComboCtrl`，它允许您拥有一个自定义弹出窗口。然后可以显示单选框和输入控件。

# reporting-services - SSRS报表中参数选择后页面刷新

> ID：462330
> 
> 赞同：14
> 
> 时间：2009-01-20T17:48:25.843
> 
> 标签：reporting-services, parameters

我的 SSRS 报告中有几个参数。有些是多值的，有些是常规的下拉列表。每次选择不同的参数值时，页面都会刷新。有什么办法可以避免在每个参数选择上刷新页面。

提前致谢。玛丽亚

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-30T15:06:10.627

我今天刚遇到这个问题，下面的帖子肯定对我有帮助。

[http://blog.summitcloud.com/2009/12/fix-refresh-of-parameters-in-ssrs/](http://blog.summitcloud.com/2009/12/fix-refresh-of-parameters-in-ssrs/)

引用帖子：

> 根据微软的说法，如果默认值或有效值列表`=Year()`对于 RS 引擎在运行时无法理解“太复杂”（可能像表达式一样简单），它将确定它是依赖的，因此是刷新的候选者。

链接中的帖子显示了一个简单的解决方法示例：

> 如果可以，将这些 VB 表达式转换为基于 SQL 语句返回值的数据集。所以`=Year()` 在表达式中会变成类似`Select Year(getdate()) as CurYear`

希望能帮助到你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T18:05:36.150

除非您愿意滚动自己的报表查看器控件，否则不容易。这样做是因为 SSRS 具有可用于确定其他参数值的参数。例如，假设您正在查看网站用户，并且您的第一个选项是操作系统，也许它有 Vista、XP 和 Mac。

当您选择 Vista 时，页面会刷新以获取所有不同版本的 Vista 的列表。

如果您正在使用这样的东西，那么您将无法阻止刷新。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-17T18:50:57.523

在这个例子中，我尝试了`DateTime`参数回发

希望它也适用于你

对于参数中的`DateTime`字段，首先将参数设置为虚拟日期值，然后将此`DateTime`值分配给报告的实际`DateTime`参数。

假设我们有一个存储过程，我们必须提供*From Date*和*To Date*

1.  在报告参数中，添加一个虚拟`DateTime`参数`Datetime_Dummy`作为`Name``DateTime``DataType`
2.  使其隐藏
3.  在**默认值**部分中，选择**指定值**
4.  将表达式设置为`=Today()`
5.  确保这是`DateTime`datetimes 参数中的第一个参数
6.  将`FromDate`参数设置`DataType`为`DateTime`
7.  在**默认值**部分中，选择**指定值**
8.  将表达式设置为`=Parameters!Datetime_Dummy.Value`

这可以防止页面在`From`选择新日期时回发。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-24T17:19:22.760

以下是基于我在其他地方阅读的帖子的一种对我有用的方法。

在我的场景中，我有一个布尔参数，我直接提供了 Yes 和 No 标题以及相应的 true 和 false 值（不是通过查询）。我也有 2 个日期时间参数。这些都没有相互联系。

每次，我输入任何一天的值并进行标记，SSRS 都会自行刷新。似乎 SSRS 试图解决在我的情况下是 Yes 和 NO 选项的值的表达式。

**解决方案**是使用数据集返回为我解决问题的 Yes 和 No 值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-07-05T19:37:13.790

这是相当长的解决方案，但是我能够弄清楚。页面不断刷新，因为您在参数之间存在依赖关系（您创建的最后一个参数取决于您之前创建的所有参数）

为了解决这个问题，您需要按照以下步骤删除依赖项：

1）右键单击“报表数据”窗格上的“数据集”文件夹 -> 显示隐藏的数据集（SSRS 2008 会自动为您添加的每个参数创建一个数据集）

2）双击出现的每个隐藏数据集（即参数数据集） -> 查询 -> 查询设计器，右上角有一个像尺子顶部的蓝色三角形（设计模式），在查询它从[数据库名称]中显示的位置，您需要删除之前的所有内容，直到（不包括）ON ROWS（从底部开始的第一个ON ROWS）还删除所有右括号'）'在查询结束时

3）单击确定应用更改，然后单击参数并删除该列表中的所有内容，然后按确定应用。

4）展开报表数据中的参数文件夹，双击每个参数->高级->从不刷新

这应该会让人耳目一新：）谢谢你，克里斯

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-12-06T16:16:19.547

对我来说，这是通过在 web.config 中禁用 X-Content-Type-Options: nosniff 自定义标头来解决的。

```
<customHeaders>
   <add name="X-Frame-Options" value="SAMEORIGIN" />
   <!-- 
   <add name="X-Content-Type-Options" value="nosniff" />
	THIS BREAKS SSRS REPORTS, causes clickable controls to immediately reload page
	-->
    <add name="X-XSS-Protection" value="1; mode=block" />
</customHeaders>
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2010-01-21T08:42:54.890

我已经做过很多次了，这只是根据项目的需要通过各种排列和组合来消除参数依赖性。

只需做以下事情。

1.  从下拉数据群中删除参数的所有依赖性。
2.  在每个报告参数下传递默认值。

我希望它会有所帮助。

谢谢你。

# c - 'long long' 的格式说明符

> ID：462345
> 
> 赞同：40
> 
> 时间：2009-01-20T17:52:17.630
> 
> 标签：c

我将 64 位计数器的变量声明为：

```
long long call_count; 
```

我应该在打印语句中使用什么格式说明符？

我试过了`%l`，，，，`%ld`。`%ll`似乎没有一个是正确的。

我使用 Diab C 编译器来编译我的应用程序代码以在 pSOS 操作系统上运行。

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-01-20T18:08:17.300

根据 C99，它应该是“%lld”（例如，请参见[此处](http://www.nullstone.com/download/releasenotes-ns-c.htm)）。如果 Diab C 不是 C99，那么您必须查看编译器文档，我似乎无法通过快速谷歌搜索在线找到该文档。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-20T17:56:10.787

它是`"%lli"`（或等价的`"%lld"`）

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-01-20T17:57:47.867

Microsoft 和 Watcom 使用`%I64d`（大写的眼睛），其他人使用`%lld`（小写的 ell ell）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-08-06T06:27:24.853

这里已经描述了这一点，甚至更多： [使用 printf 的 64 位整数的跨平台打印](https://stackoverflow.com/questions/6299083/cross-platform-printing-of-64-bit-integers-with-printf)

TL;DR：您可以使用 PRId64 宏（来自 inttypes.h）以半可移植的方式打印十进制的 64 位整数。还有其他宏（如 PRIx64）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-20T17:56:20.397

也许%lld？我认为这是 gcc 的格式，对 Diab C 编译器一无所知。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-21T06:14:15.493

%lld 代表有符号，%llu 代表无符号

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-09-03T19:21:21.287

```
long long t1;             //signed
unsigned long long t2;    //unsigned

printf("%lld",t1);
printf("%llu",t2); 
```

# java - 字符串长度从 Javascript 到 Java 代码不同

> ID：462348
> 
> 赞同：21
> 
> 时间：2009-01-20T17:53:53.490
> 
> 标签：java, javascript, string, carriage-return

我有一个带有一段 Javascript 验证代码的 JSP 页面，它限制了提交时的一定数量的字符。我正在使用 a`<textarea>`所以我不能简单地使用像 a 中的长度属性`<input type="text">`。

我`document.getElementById("text").value.length`用来获取字符串长度。我在 Windows 上运行 Firefox 3.0（但我也用 IE 6 测试了这种行为）。表单被提交到 J2EE servlet。在我的 Java servlet 中，参数的字符串长度大于 2000！

我注意到这可以通过在`<textarea>`. 我使用 Firebug 来断言 的长度，`<textare>`它实际上是 2000 个字符长。但是在 Java 方面，回车符被转换为 UNIX 样式（`\r\n`，而不是`\n`），因此字符串长度不同！

我在这里遗漏了一些明显的东西还是什么？如果没有，您将如何可靠地（跨平台/浏览器）确保`<textarea>`限制。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-01-20T20:23:32.753

这并不是真正的 JavaScript（或 Java）问题——两个层都报告了它们正在处理的字符串的准确长度。您的问题是字符串在 HTTP 传输期间被转换。

如果您绝对必须确保字符串不超过某个长度，您可以通过将“\n”的每个实例替换为“\n\r”来模拟客户端上的这种转换 - 但仅用于长度验证目的：

```
textarea.value.replace(/\n/g, "\r\n").length 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-20T17:59:39.750

您是否特别关心使用了哪些行尾？为什么不让 Java 将“\r\n”转换为“\n”？（注意“\r\n”是 Windows 风格；“\n”是 Unix 风格。）

或者，在检查 JavaScript 中的长度时执行相反的操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T18:23:40.000

您是否将其限制为 2000 个字符，以便它适合数据库中的 nvarchar(2000) 列？否则，可能只允许 2% 的溢出在 Java 端是灵活的。

Java 应该使用 Unicode UTF16 来表示字符串。那`/r`一定是在其他地方，也许是提交时在网络浏览器中的转换？你试过不同的浏览器吗？在不同的平台上？你可能只需要去掉`/r`s.

# merge - 在文件更改的编辑缓冲区合并中

> ID：462355
> 
> 赞同：3
> 
> 时间：2009-01-20T17:55:44.783
> 
> 标签：merge, text-editor

当文件从他们下面更改时，许多编辑者会注意到。如果您对文件进行了未保存的编辑，是否有任何编辑器可以让您进行三向合并？

常见的情况是我忘记在更新 SVN 之前保存文件，当我切换回我的编辑器时，我意识到我现在可以选择踩下刚刚所做的更新、放弃我的更改或进行复制/paste/external-diff-tool 歌舞。

是的，我知道在我更新之前正确的解决方案是 ctrl+s，但我是人类，并且想要一个非常简单的解决方案来解决问题，然后我把它搞砸了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T14:13:27.193

[EditPad Pro](http://www.editpadpro.com)，当它检测到您已打开但未保存更改的文件已在磁盘上更改时，会询问您是否要从磁盘重新加载文件，忽略磁盘上的更改，或查看磁盘上的文件与具有您已打开的未保存更改的版本。

那是双向差异，而不是您要求的三向差异。我不知道有任何文本编辑器会提供三向差异。如果磁盘上的文件已被破坏，则文本编辑器不再拥有原始文件的副本。这将是版本控制要解决的问题。

预防措施可能是让您的编辑器锁定您已打开的文件。然后 SVN 更新将在您在编辑器中打开的任何文件上失败。在 EditPad Pro 中，选项、首选项、文件中有一个选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T19:48:15.960

**使用 vim，您可以使用:DiffOrig**进入差异模式。
可以使用**:checkt强制检查修改**

要使其自动化，您可以将以下内容放入您的 .vimrc：

```
au FileChangedShell * DiffOrig 
```

一旦 Vim 意识到文件 (mtime) 发生了变化，Vim 就会进入 diff 拆分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T19:53:57.367

听起来像是解决文件在您脚下被修改的问题的不好方法。正如我通常回答的那样：你**真正**想解决什么问题？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T20:27:24.493

我很少遇到这种情况，可能是因为我的手指一不做任何事情就保存，而不必真正考虑它。

否则，我建议您找到一个集成到您的编辑器中的 SVN 客户端。大多数此类客户端会在提交或更新之前自动（或要求）保存。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-30T14:25:55.857

因此，您对文件进行了未保存的更改，然后对该文件进行了 SVN 更新，对吗？

在这种情况下，您应该在更新后保存更改并再次运行 SVN 更新。第二次运行 SVN 更新将尝试合并存储库中的更改并告诉您是否存在冲突。

更多/最重要的更改是编辑器中未保存的更改，SVN 更新中的更改始终可以从存储库中再次拉出。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-20T18:24:22.557

这似乎是源代码控制的问题，而不是编辑器。

当然，Emacs 可以通过编程来做到这一点，但默认情况下，它似乎只是询问您是否要保存更改的文件。尝试编辑已更改的文件将为您提供将缓冲区恢复为文件内容的选项。

Vi（至少我正在使用的版本）甚至不检查文件是否已更改。（在我编辑它之前它也不检查文件是否是只读的，这让我发疯。也许我需要找到一个更好的 vi。）

# .net - 使用哪个？Visual Studio 开发服务器或本地 IIS Web 服务器？

> ID：462356
> 
> 赞同：11
> 
> 时间：2009-01-20T17:55:48.947
> 
> 标签：.net, iis, webserver

我一直想知道这个……谢天谢地，现在有一个很好的专家环境来问这个问题。

在创建 Web 应用程序项目时，哪个 Web 服务器最方便使用？

这是一个重复的问题...... [ASP.NET 开发服务器或 Localhost IIS？](https://stackoverflow.com/questions/281667/asp-net-development-server-or-localhost-iis)... 我的错！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-20T17:57:56.387

阅读本文：[ASP.NET 开发服务器还是 Localhost IIS？](https://stackoverflow.com/questions/281667/asp-net-development-server-or-localhost-iis)

我的问题更多地针对一般用途，而不是专门针对 Web 应用程序..

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-01T03:04:53.360

从 ASP.NET 4.5 和 Visual Studio 2012 开始，[马口](http://www.asp.net/vnext/overview/aspnet/whats-new#_Toc318097428)推荐的服务器是 IIS Express。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-20T18:07:12.123

VS 开发服务器当然不会那么大惊小怪。它使开发多个网站更容易管理。如果您没有运行 IIS 的专用测试环境，我当然会选择在本地运行 IIS。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-20T18:10:31.227

我两个都用。

每天使用 VS 内置服务器进行第一级测试，然后使用测试 IIS 服务器进行下一级测试。对于代码的每分钟更改，为了方便起见，您无法击败 VS 内置服务器。

我曾经使用专用的测试 IIS 服务器进行所有测试，它减慢了我的速度并且没有提供足够的好处；不过，在正式上线之前，在完整的 IIS 服务器上测试您的部署仍然是值得的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-20T17:58:33.187

我认为 Visual Studio 开发服务器是为测试和运行您的应用程序而构建的，以查看它们将如何工作..

另一方面，IIS 是真正的交易......它是您的应用程序将运行的网络服务器......

# java - break和continue语句的区别

> ID：462373
> 
> 赞同：288
> 
> 时间：2009-01-20T18:00:46.397
> 
> 标签：java, break, continue

谁能告诉我`break`和`continue`声明之间的区别？

* * *

## 回答 #1

> 赞同：564
> 
> 时间：2009-01-20T18:02:15.533

`break`离开一个循环，`continue`跳到下一个迭代。

* * *

## 回答 #2

> 赞同：104
> 
> 时间：2009-01-20T18:05:53.187

有关更多详细信息和代码示例，请参阅[**分支语句：**](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/branch.html)

### `break`

> break 语句有两种形式：有标签的和无标签的。您在前面对 switch 语句的讨论中看到了未标记的形式。您还可以使用未标记的中断来终止 for、while 或 do-while 循环 [...]
> 
> 无标签的 break 语句终止最里面的 switch、for、while 或 do-while 语句，但有标签的 break 终止外部语句。

### `continue`

> continue 语句跳过 for、while 或 do-while 循环的当前迭代。未标记的形式跳到最内层循环体的末尾并计算控制循环的布尔表达式。[...]
> 
> 带标签的 continue 语句跳过标有给定标签的外部循环的当前迭代。

* * *

## 回答 #3

> 赞同：72
> 
> 时间：2012-05-21T23:12:41.543

```
System.out.println ("starting loop:");
for (int n = 0; n < 7; ++n)
{
    System.out.println ("in loop: " + n);
    if (n == 2) {
        continue;
    }
    System.out.println ("   survived first guard");
    if (n == 4) {
        break;
    }
    System.out.println ("   survived second guard");
    // continue at head of loop
}
// break out of loop
System.out.println ("end of loop or exit via break"); 
```

这将导致以下输出：

```
starting loop:
in loop: 0
    survived first guard
    survived second guard
in loop: 1
    survived first guard
    survived second guard
in loop: 2
in loop: 3
    survived first guard
    survived second guard
in loop: 4
    survived first guard
end of loop or exit via break 
```

您可以标记一个块，而不仅仅是一个 for 循环，然后从嵌套块中断/继续到外部块。在少数情况下，这可能很有用，但通常您会尽量避免使用此类代码，除非程序的逻辑比以下示例更易于理解：

```
first:
for (int i = 0; i < 4; ++i) 
{
    second:
    for (int j = 0; j < 4; ++j) 
    {
        third:
        for (int k = 0; k < 4; ++k) 
        {
            System.out.println ("inner start: i+j+k " + (i + j + k));
            if (i + j + k == 5)
                continue third;
            if (i + j + k == 7)
                continue second;
            if (i + j + k == 8)
                break second;
            if (i + j + k == 9)
                break first;
            System.out.println ("inner stop:  i+j+k " + (i + j + k));
        }
    }       
} 
```

因为它是可能的，这并不意味着你应该使用它。

如果你想以一种有趣的方式混淆你的代码，你不要选择一个有意义的名字，而是 http: 并在它后面加上一个看起来很陌生的评论，就像源代码中的网络地址：

```
http://stackoverflow.com/questions/462373
for (int i = 0; i < 4; ++i) 
{
     if (i == 2) 
         break http; 
```

我想这是来自 Joshua Bloch 测验。:)

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2014-07-23T12:14:13.040

Break 完全离开循环并执行循环之后的语句。而 Continue 则离开当前迭代并使用循环中的下一个值执行。

> 这段代码解释了一切：

```
public static void main(String[] args) {
    for(int i=0;i<10;i++)
    {
        if (i==4)
        {
            break;
        }
        System.out.print(i+"\t");

    }
    System.out.println();
    for(int i=0;i<10;i++)
    {

        if (i==4)
        {
            continue;
        }
        System.out.print(i+"\t");
    }
} 
```

输出：

```
0   1   2   3   
0   1   2   3   5   6   7   8   9 
```

* * *

## 回答 #5

> 赞同：25
> 
> 时间：2009-01-20T18:02:19.997

`break`完全退出循环。`continue`跳过*continue*语句之后的语句并继续循环。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2018-05-02T14:10:12.720

**中断语句**

有时有必要在循环完成对所有步长值的完全迭代之前[退出循环。](https://funnelgarden.com/java-for-loop/#Break_Statement)例如，循环遍历数字列表，直到找到满足特定条件的数字。或者循环遍历文件中的字符流，直到读取某个字符。

在下面的例子中，我们使用一个简单的 for 循环来打印从 0 到 9 的值：

```
for(int i=0; i<10; i++) {
  System.out.println(i);
} 
```

输出：

```
0
1
2
3
4
5
6
7
8
9 
```

现在如果我们在 i==4 时添加一个 break 语句，我们的代码将在 i 等于 4 时跳出循环。您可以使用 break 语句跳出 for 循环、while 循环和 do-while 循环。break 语句只会跳出当前循环。为了从嵌套的内循环中跳出外循环，您需要在 break 语句中使用标签。

```
for(int i=0; i<10; i++) {
  System.out.println(i);
  if(i==4) {
    break;
  }
} 
```

输出：

```
0
1
2
3
4 
```

**继续声明**

Java 的[continue 语句](https://funnelgarden.com/java-for-loop/#Continue_Statement)跳过循环的当前迭代并直接进入下一个迭代。在 for 循环中调用 continue 语句后，循环执行将执行 step 值并评估布尔条件，然后继续进行下一次迭代。在下面的示例中，我们在循环中打印出从 0 到 9 的所有值，但我们跳过打印出 4。

```
for(int i=0; i<10; i++) {
  if(i==4) {
    continue;
  }
  System.out.println(i);
} 
```

输出：

```
0
1
2
3
5 <---- SKIPPED OVER 4 and continued with next loop iteration
6
7
8
9 
```

**循环标签 - 中断语句** 您可以[在嵌套循环中使用标签，](https://funnelgarden.com/java-for-loop/#Loop_Label)方法是指定您希望在中断内部循环后继续执行的位置。通常，break 语句只会跳出最内层的循环，因此当您想跳出外层循环时，可以使用标签来完成此操作，本质上是执行类似于 goto 语句的操作。

下面的示例使用 3 个循环，所有循环都相互嵌套。由于无法从最内层循环内部完全跳出最外层循环，因此我们可以使用标签“outer1”来完成此操作，并在 break 语句旁边指定标签。

```
outer1:
for(int i=0; i<5; i++) {
  for(int j=0; j<4; j++) {
    for(int k=0; k<2; k++) {
      System.out.println("[" + i + "][" + j + "][" + k + "]");
      if(j == 3) {
        break outer1;
      }
    }
  }
} 
```

输出：

```
[0][0][0]
[0][0][1]
[0][1][0]
[0][1][1]
[0][2][0]
[0][2][1]
[0][3][0] 
```

注意显示的最后一行是“<a href="https://funnelgarden.com/java-for-loop/" rel="noreferrer">0[0]”，这就是 j == 3 的位置，这就是我们称为“break outer1;” 打破最外层的循环。

**循环标签 - Continue 语句**

您还可以使用带有 continue 关键字的标签从特定点继续循环。以前面的示例为例，仅将一行更改为指定`continue outer1;`而不是`break outer1;`将导致循环继续从`outer1`标签循环而不是跳出循环。注意每次`continue outer1;`调用的方式，代码在循环索引 i 增加 1 后从外循环继续。

```
outer1:
for(int i=0; i<5; i++) {
  for(int j=0; j<4; j++) {
    for(int k=0; k<2; k++) {
      System.out.println("[" + i + "][" + j + "][" + k + "]");
      if(j == 3) {
        continue outer1;
    }
  }
}

[0][0][0]
[0][0][1]
[0][1][0]
[0][1][1]
[0][2][0]
[0][2][1]
[0][3][0] <---- CONTINUE WITH LABEL CALLED HERE
[1][0][0] <---- CONTINUES FROM NEXT ITERATION OF OUTER LOOP
[1][0][1]
[1][1][0]
[1][1][1]
[1][2][0]
[1][2][1]
[1][3][0] <---- CONTINUE WITH LABEL CALLED HERE
[2][0][0] <---- CONTINUES FROM NEXT ITERATION OF OUTER LOOP
[2][0][1]
[2][1][0]
[2][1][1]
[2][2][0]
[2][2][1]
[2][3][0] <---- CONTINUE WITH LABEL CALLED HERE
[3][0][0] <---- CONTINUES FROM NEXT ITERATION OF OUTER LOOP
[3][0][1]
[3][1][0]
[3][1][1]
[3][2][0]
[3][2][1]
[3][3][0] <---- CONTINUE WITH LABEL CALLED HERE
[4][0][0] <---- CONTINUES FROM NEXT ITERATION OF OUTER LOOP
[4][0][1]
[4][1][0]
[4][1][1]
[4][2][0]
[4][2][1]
[4][3][0] 
```

资料来源：[Java 中的循环 – 终极指南](https://funnelgarden.com/java-for-loop/)

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-01-20T18:02:20.853

`break`语句会导致其应用的语句终止（、`switch`、`for`或`do`）`while`。

语句用于`continue`结束当前循环迭代并将控制权返回给循环语句。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2009-01-20T18:12:13.207

[优秀的答案](https://stackoverflow.com/questions/462373/difference-between-break-and-continue-statement#462375)简单而准确。

我会添加一个代码示例。

```
C:\oreyes\samples\java\breakcontinue>type BreakContinue.java

    class BreakContinue {

        public static void main( String [] args ) {

               for( int i = 0 ; i < 10 ; i++ ) {

                     if( i % 2 == 0) { // if pair, will jump
                         continue; // don't go to "System.out.print" below.
                     }

                     System.out.println("The number is " + i );

                     if( i == 7 ) {
                         break; // will end the execution, 8,9 wont be processed
                      }

               }
        }

    }

C:\oreyes\samples\java\breakcontinue>java BreakContinue
The number is 1
The number is 3
The number is 5
The number is 7 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2015-04-22T13:39:42.567

`continue`跳过当前执行的**循环**并**移至**下一个**循环**，而`break` **移出****循环并执行循环****后**的下一条语句。我使用以下代码了解了差异。查看不同的输出。希望这会有所帮助。

```
public static void main(String[] args) {
    for(int i = 0; i < 5; i++){
        if (i == 3) {
            continue;
        }
        System.out.print(i);
    }
}//prints out 0124, continue moves to the next iteration skipping printing 3

public static void main(String[] args) {
    for(int i = 0; i < 5; i++){
        if (i == 3) {
            break;
        }
        System.out.print(i);
    }
}//prints out 012, break moves out of the loop hence doesnt print 3 and 4 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-01-20T18:14:52.873

考虑以下：

```
int n;
for(n = 0; n < 10; ++n) {
    break;
}
System.out.println(n); 
```

**break**导致循环终止，*n*的值为 0。

```
int n;
for(n = 0; n < 10; ++n) {
    continue;
}
System.out.println(n); 
```

**continue**使程序计数器返回到循环的第一行（检查条件并且 n 的值是递增的）并且*n*的最终值是 10。

还应该注意的是，**break**只会终止它所在的循环的执行：

```
int m;
for(m = 0; m < 5; ++m)
{
    int n;
    for(n = 0; n < 5; ++n) {
        break;
    }
    System.out.println(n);
}
System.out.println(m); 
```

会输出一些大意的东西

```
0
0
0
0
0
5 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-01-20T18:02:46.203

该`break`语句跳出循环（下一个要执行的语句是右括号之后的第一个语句），而`continue`在下一次迭代时开始循环。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-01-20T18:04:21.940

该`break`语句存在当前的循环控制结构，并在`continue`退出时跳到它后面，但又跳回到循环条件。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-01-20T18:18:08.340

简单示例：

`break`离开循环。

```
int m = 0;
for(int n = 0; n < 5; ++n){
  if(n == 2){
    break;
  }
  m++;
}

System.out.printl("m:"+m); // m:2 
```

`continue`将返回开始循环。

```
int m = 0;
for(int n = 0; n < 5; ++n){
  if(n == 2){
    continue; // Go back to start and dont execute m++
  }
  m++;
}

System.out.printl("m:"+m); // m:4 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2017-09-29T10:42:01.080

为了防止在满足条件时执行任何操作，应该使用 continue 并在满足条件时退出循环，应该使用 break。

例如在下面提到的代码中。

```
 for(int i=0;i<5;i++){

        if(i==3){

           continue;

        }
       System.out.println(i);
     } 
```

上面的代码将打印结果：0 1 2 4

现在考虑这段代码

```
 for(int i=0;i<5;i++){

            if(i==3){

                break;

            }
            System.out.println(i);
         } 
```

此代码将打印 0 1 2

这就是 continue 和 break 的基本区别。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-01-20T18:10:55.017

这是break的语义：

```
int[] a = new int[] { 1, 3, 4, 6, 7, 9, 10 };
// find 9
for(int i = 0; i < a.Length; i++)
{
    if (a[i] == 9) 
        goto goBreak;

    Console.WriteLine(a[i].ToString());      
}
goBreak:; 
```

这是 continue 的语义：

```
int[] a = new int[] { 1, 3, 4, 6, 7, 9, 10 };
// skip all odds
for(int i = 0; i < a.Length; i++)
{
    if (a[i] % 2 == 1) 
        goto goContinue;

    Console.WriteLine(a[i].ToString());      

goContinue:;
} 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2014-12-09T14:15:37.917

首先，我想你应该知道Java中有两种类型的break和continue，分别是labeled break、unlabeled break、labeled continue和unlabeled continue。现在，我将谈谈它们之间的区别。

```
class BreakDemo {
public static void main(String[] args) {

    int[] arrayOfInts = 
        { 32, 87, 3, 589,
          12, 1076, 2000,
          8, 622, 127 };
    int searchfor = 12;

    int i;
    boolean foundIt = false;

    for (i = 0; i < arrayOfInts.length; i++) {
        if (arrayOfInts[i] == searchfor) {
            foundIt = true;
            break;//this is an unlabeled break,an unlabeled break statement terminates the innermost switch,for,while,do-while statement.
        }
    }

    if (foundIt) {
        System.out.println("Found " + searchfor + " at index " + i);
    } else {
        System.out.println(searchfor + " not in the array");
    }
} 
```

未标记的 break 语句终止最里面的 switch ,for ,while ,do-while 语句。

```
public class BreakWithLabelDemo {
public static void main(String[] args) {
    search:
    for (int i = 0; i < 3; i++) {
        for (int j = 0; j < 5; j++) {
            System.out.println(i + " - " + j);
            if (j == 3)
                break search;//this is an labeled break.To notice the lab which is search.
        }
    }
} 
```

带标签的 break 终止外部语句。如果您使用 javac 和 java 这个演示，您将得到：

```
0 - 0
0 - 1
0 - 2
0 - 3 
```

```
class ContinueDemo {
public static void main(String[] args) {

    String searchMe = "peter piper picked a " + "peck of pickled peppers";
    int max = searchMe.length();
    int numPs = 0;

    for (int i = 0; i < max; i++) {
        // interested only in p's
        if (searchMe.charAt(i) != 'p')
            continue;//this is an unlabeled continue.

        // process p's
        numPs++;
    }
    System.out.println("Found " + numPs + " p's in the string.");
} 
```

未标记的 continue 语句会跳过 for、while、do-while 语句的当前迭代。

```
public class ContinueWithLabelDemo {
public static void main(String[] args) {
    search:
    for (int i = 0; i < 3; i++) {
        for (int j = 0; j < 5; j++) {
            System.out.println(i + " - " + j);
            if (j == 3)
                continue search;//this is an labeled continue.Notice the lab which is search
        }
    }
} 
```

带标签的 continue 语句跳过用给定标签标记的外部循环的当前迭代，如果您使用 javac 和 java 演示，您将获得：

```
0 - 0
0 - 1
0 - 2
0 - 3
1 - 0
1 - 1
1 - 2
1 - 3
2 - 0
2 - 1
2 - 2
2 - 3 
```

如果你有任何问题，你可以看这个的Java教程：[在此处输入链接描述](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/branch.html)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-01-20T18:02:53.787

简单来说：break 会终止当前循环，循环结束后在第一行继续执行。continue 跳回到循环条件并继续运行循环。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2013-12-14T22:11:50.603

```
for (int i = 1; i <= 3; i++) {
        if (i == 2) {

            continue;
        }
        System.out.print("[i:" + i + "]"); 
```

在 netbeans 中尝试此代码，您将了解 break 和 continue 之间的区别

```
for (int i = 1; i <= 3; i++) {
        if (i == 2) {

            break;
        }
        System.out.print("[i:" + i + "]"); 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2015-11-26T00:54:16.613

简单的程序来理解 continue 和 break 之间的区别

什么时候`continue`使用

```
 public static void main(String[] args) {
    System.out.println("HelloWorld");
    for (int i = 0; i < 5; i++){
        System.out.println("Start For loop i = " + i);
        if(i==2){
            System.out.println("Inside if Statement for i = "+i);
           continue;
        }
        System.out.println("End For loop i = " + i);
    }
    System.out.println("Completely out of For loop");
}

OutPut:
HelloWorld
Start For loop i = 0
End For loop i = 0
Start For loop i = 1
End For loop i = 1
Start For loop i = 2
Inside if Statement for i = 2
Start For loop i = 3
End For loop i = 3
Start For loop i = 4
End For loop i = 4
Completely out of For loop 
```

什么时候`break`使用

```
public static void main(String[] args) {
    System.out.println("HelloWorld");
    for (int i = 0; i < 5; i++){
        System.out.println("Start For loop i = " + i);
        if(i==2){
            System.out.println("Inside if Statement for i = "+i);
           break;
        }
        System.out.println("End For loop i = " + i);
    }
    System.out.println("Completely out of For loop");
}

Output:
HelloWorld
Start For loop i = 0
End For loop i = 0
Start For loop i = 1
End For loop i = 1
Start For loop i = 2
Inside if Statement for i = 2
Completely out of For loop 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2017-03-16T04:55:54.437

Continue 语句停止迭代并开始下一个迭代 例如：

```
System.out.println("continue when i is 2:");
    for (int i = 1; i <= 3; i++) {
        if (i == 2) {
            System.out.print("[continue]");
            continue;
        }
        System.out.print("[i:" + i + "]");
    } 
```

和 Break 语句停止循环或退出循环

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2009-01-20T18:13:57.553

所以你在一个 for 或 while 循环中。使用中断；会让你脱离循环。就像，它会结束。继续; 将告诉它运行下一次迭代。

在 if 语句中使用 continue 没有意义，但是 break; 很有用。在 switch...case 中，总是使用 break；结束一个案例，因此它不会执行另一个案例。

# c# - 从 .NET 应用程序中重新启动 Windows

> ID：462381
> 
> 赞同：21
> 
> 时间：2009-01-20T18:03:01.867
> 
> 标签：c#, .net, winforms

如何使用 .NET 框架重新启动或关闭 Windows？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-01-20T18:07:54.150

以下代码将从 shell 执行关闭命令：

```
// using System.Diagnostics;

class Shutdown
{
    /// <summary>
    /// Windows restart
    /// </summary>
    public static void Restart()
    {
        StartShutDown("-f -r -t 5");
    }

    /// <summary>
    /// Log off.
    /// </summary>
    public static void LogOff()
    {
        StartShutDown("-l");
    }

    /// <summary>
    ///  Shutting Down Windows 
    /// </summary>
    public static void Shut()
    {
        StartShutDown("-f -s -t 5");
    }

    private static void StartShutDown(string param)
    {
        ProcessStartInfo proc = new ProcessStartInfo();
        proc.FileName = "cmd";
        proc.WindowStyle = ProcessWindowStyle.Hidden;
        proc.Arguments = "/C shutdown " + param;
        Process.Start(proc);
    }
} 
```

（来源：[http ://dotnet-snippets.de/dns/c-windows-herrunterfahren-ausloggen-neustarten-SID455.aspx](http://dotnet-snippets.de/dns/c-windows-herrunterfahren-ausloggen-neustarten-SID455.aspx)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-20T18:09:18.077

我不知道一种纯粹的.NET 方式来做到这一点。您的选择包括：

*   P/调用[ExitWindowsEx Win32 函数](http://msdn.microsoft.com/en-us/library/aa376868(VS.85).aspx)
*   如前所述，使用 Process.Start 运行 shutdown.exe。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-20T18:09:22.167

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Text;
using System.Windows.Forms;
// Remember to add a reference to the System.Management assembly
using System.Management;

namespace ShutDown
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void btnShutDown_Click(object sender, EventArgs e)
        {
            ManagementBaseObject mboShutdown = null;
            ManagementClass mcWin32 = new ManagementClass("Win32_OperatingSystem");
            mcWin32.Get();
            // You can't shutdown without security privileges
            mcWin32.Scope.Options.EnablePrivileges = true;
            ManagementBaseObject mboShutdownParams = mcWin32.GetMethodParameters("Win32Shutdown");
            // Flag 1 means we want to shut down the system
            mboShutdownParams["Flags"] = "1";
            mboShutdownParams["Reserved"] = "0";
            foreach (ManagementObject manObj in mcWin32.GetInstances())
            {
                mboShutdown = manObj.InvokeMethod("Win32Shutdown", mboShutdownParams, null);
            }
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-20T18:45:55.197

这是 P/Invoke 方式：

```
namespace pcController
{
    /// <summary>
    /// Specifies the type of restart options that an application can use.
    /// </summary>
    public enum RestartOptions
    {
        /// <summary>
        /// Shuts down all processes running in the security context of the process that called the ExitWindowsEx function. Then it logs the user off.
        /// </summary>
        LogOff = 0,
        /// <summary>
        /// Shuts down the system and turns off the power. The system must support the power-off feature.
        /// </summary>
        PowerOff = 8,
        /// <summary>
        /// Shuts down the system and then restarts the system.
        /// </summary>
        Reboot = 2,
        /// <summary>
        /// Shuts down the system to a point at which it is safe to turn off the power. All file buffers have been flushed to disk, and all running processes have stopped. If the system supports the power-off feature, the power is also turned off.
        /// </summary>
        ShutDown = 1,
        /// <summary>
        /// Suspends the system.
        /// </summary>
        Suspend = -1,
        /// <summary>
        /// Hibernates the system.
        /// </summary>
        Hibernate = -2,
    }
    /// <summary>
    /// An LUID is a 64-bit value guaranteed to be unique only on the system on which it was generated. The uniqueness of a locally unique identifier (LUID) is guaranteed only until the system is restarted.
    /// </summary>
    [StructLayout(LayoutKind.Sequential, Pack = 1)]
    internal struct LUID
    {
        /// <summary>
        /// The low order part of the 64 bit value.
        /// </summary>
        public int LowPart;
        /// <summary>
        /// The high order part of the 64 bit value.
        /// </summary>
        public int HighPart;
    }
    /// <summary>
    /// The LUID_AND_ATTRIBUTES structure represents a locally unique identifier (LUID) and its attributes.
    /// </summary>
    [StructLayout(LayoutKind.Sequential, Pack = 1)]
    internal struct LUID_AND_ATTRIBUTES
    {
        /// <summary>
        /// Specifies an LUID value.
        /// </summary>
        public LUID pLuid;
        /// <summary>
        /// Specifies attributes of the LUID. This value contains up to 32 one-bit flags. Its meaning is dependent on the definition and use of the LUID.
        /// </summary>
        public int Attributes;
    }
    /// <summary>
    /// The TOKEN_PRIVILEGES structure contains information about a set of privileges for an access token.
    /// </summary>
    [StructLayout(LayoutKind.Sequential, Pack = 1)]
    internal struct TOKEN_PRIVILEGES
    {
        /// <summary>
        /// Specifies the number of entries in the Privileges array.
        /// </summary>
        public int PrivilegeCount;
        /// <summary>
        /// Specifies an array of LUID_AND_ATTRIBUTES structures. Each structure contains the LUID and attributes of a privilege.
        /// </summary>
        public LUID_AND_ATTRIBUTES Privileges;
    }
    /// <summary>
    /// Implements methods to exit Windows.
    /// </summary>
    public class LibClass
    {
        /// <summary>Required to enable or disable the privileges in an access token.</summary>
        private const int TOKEN_ADJUST_PRIVILEGES = 0x20;
        /// <summary>Required to query an access token.</summary>
        private const int TOKEN_QUERY = 0x8;
        /// <summary>The privilege is enabled.</summary>
        private const int SE_PRIVILEGE_ENABLED = 0x2;
        /// <summary>Specifies that the function should search the system message-table resource(s) for the requested message.</summary>
        private const int FORMAT_MESSAGE_FROM_SYSTEM = 0x1000;
        /// <summary>Forces processes to terminate. When this flag is set, the system does not send the WM_QUERYENDSESSION and WM_ENDSESSION messages. This can cause the applications to lose data. Therefore, you should only use this flag in an emergency.</summary>
        private const int EWX_FORCE = 4;
        /// <summary>
        /// The LoadLibrary function maps the specified executable module into the address space of the calling process.
        /// </summary>
        /// <param name="lpLibFileName">Pointer to a null-terminated string that names the executable module (either a .dll or .exe file). The name specified is the file name of the module and is not related to the name stored in the library module itself, as specified by the LIBRARY keyword in the module-definition (.def) file.</param>
        /// <returns>If the function succeeds, the return value is a handle to the module.<br></br><br>If the function fails, the return value is NULL. To get extended error information, call Marshal.GetLastWin32Error.</br></returns>
        [DllImport("kernel32.dll", EntryPoint = "LoadLibraryA", CharSet = CharSet.Ansi)]
        private static extern IntPtr LoadLibrary(string lpLibFileName);
        /// <summary>
        /// The FreeLibrary function decrements the reference count of the loaded dynamic-link library (DLL). When the reference count reaches zero, the module is unmapped from the address space of the calling process and the handle is no longer valid.
        /// </summary>
        /// <param name="hLibModule">Handle to the loaded DLL module. The LoadLibrary or GetModuleHandle function returns this handle.</param>
        /// <returns>If the function succeeds, the return value is nonzero.<br></br><br>If the function fails, the return value is zero. To get extended error information, call Marshal.GetLastWin32Error.</br></returns>
        [DllImport("kernel32.dll", EntryPoint = "FreeLibrary", CharSet = CharSet.Ansi)]
        private static extern int FreeLibrary(IntPtr hLibModule);
        /// <summary>
        /// The GetProcAddress function retrieves the address of an exported function or variable from the specified dynamic-link library (DLL).
        /// </summary>
        /// <param name="hModule">Handle to the DLL module that contains the function or variable. The LoadLibrary or GetModuleHandle function returns this handle.</param>
        /// <param name="lpProcName">Pointer to a null-terminated string containing the function or variable name, or the function's ordinal value. If this parameter is an ordinal value, it must be in the low-order word; the high-order word must be zero.</param>
        /// <returns>If the function succeeds, the return value is the address of the exported function or variable.<br></br><br>If the function fails, the return value is NULL. To get extended error information, call Marshal.GetLastWin32Error.</br></returns>
        [DllImport("kernel32.dll", EntryPoint = "GetProcAddress", CharSet = CharSet.Ansi)]
        private static extern IntPtr GetProcAddress(IntPtr hModule, string lpProcName);
        /// <summary>
        /// The SetSuspendState function suspends the system by shutting power down. Depending on the Hibernate parameter, the system either enters a suspend (sleep) state or hibernation (S4). If the ForceFlag parameter is TRUE, the system suspends operation immediately; if it is FALSE, the system requests permission from all applications and device drivers before doing so.
        /// </summary>
        /// <param name="Hibernate">Specifies the state of the system. If TRUE, the system hibernates. If FALSE, the system is suspended.</param>
        /// <param name="ForceCritical">Forced suspension. If TRUE, the function broadcasts a PBT_APMSUSPEND event to each application and driver, then immediately suspends operation. If FALSE, the function broadcasts a PBT_APMQUERYSUSPEND event to each application to request permission to suspend operation.</param>
        /// <param name="DisableWakeEvent">If TRUE, the system disables all wake events. If FALSE, any system wake events remain enabled.</param>
        /// <returns>If the function succeeds, the return value is nonzero.<br></br><br>If the function fails, the return value is zero. To get extended error information, call Marshal.GetLastWin32Error.</br></returns>
        [DllImport("powrprof.dll", EntryPoint = "SetSuspendState", CharSet = CharSet.Ansi)]
        private static extern int SetSuspendState(int Hibernate, int ForceCritical, int DisableWakeEvent);
        /// <summary>
        /// The OpenProcessToken function opens the access token associated with a process.
        /// </summary>
        /// <param name="ProcessHandle">Handle to the process whose access token is opened.</param>
        /// <param name="DesiredAccess">Specifies an access mask that specifies the requested types of access to the access token. These requested access types are compared with the token's discretionary access-control list (DACL) to determine which accesses are granted or denied.</param>
        /// <param name="TokenHandle">Pointer to a handle identifying the newly-opened access token when the function returns.</param>
        /// <returns>If the function succeeds, the return value is nonzero.<br></br><br>If the function fails, the return value is zero. To get extended error information, call Marshal.GetLastWin32Error.</br></returns>
        [DllImport("advapi32.dll", EntryPoint = "OpenProcessToken", CharSet = CharSet.Ansi)]
        private static extern int OpenProcessToken(IntPtr ProcessHandle, int DesiredAccess, ref IntPtr TokenHandle);
        /// <summary>
        /// The LookupPrivilegeValue function retrieves the locally unique identifier (LUID) used on a specified system to locally represent the specified privilege name.
        /// </summary>
        /// <param name="lpSystemName">Pointer to a null-terminated string specifying the name of the system on which the privilege name is looked up. If a null string is specified, the function attempts to find the privilege name on the local system.</param>
        /// <param name="lpName">Pointer to a null-terminated string that specifies the name of the privilege, as defined in the Winnt.h header file. For example, this parameter could specify the constant SE_SECURITY_NAME, or its corresponding string, "SeSecurityPrivilege".</param>
        /// <param name="lpLuid">Pointer to a variable that receives the locally unique identifier by which the privilege is known on the system, specified by the lpSystemName parameter.</param>
        /// <returns>If the function succeeds, the return value is nonzero.<br></br><br>If the function fails, the return value is zero. To get extended error information, call Marshal.GetLastWin32Error.</br></returns>
        [DllImport("advapi32.dll", EntryPoint = "LookupPrivilegeValueA", CharSet = CharSet.Ansi)]
        private static extern int LookupPrivilegeValue(string lpSystemName, string lpName, ref LUID lpLuid);
        /// <summary>
        /// The AdjustTokenPrivileges function enables or disables privileges in the specified access token. Enabling or disabling privileges in an access token requires TOKEN_ADJUST_PRIVILEGES access.
        /// </summary>
        /// <param name="TokenHandle">Handle to the access token that contains the privileges to be modified. The handle must have TOKEN_ADJUST_PRIVILEGES access to the token. If the PreviousState parameter is not NULL, the handle must also have TOKEN_QUERY access.</param>
        /// <param name="DisableAllPrivileges">Specifies whether the function disables all of the token's privileges. If this value is TRUE, the function disables all privileges and ignores the NewState parameter. If it is FALSE, the function modifies privileges based on the information pointed to by the NewState parameter.</param>
        /// <param name="NewState">Pointer to a TOKEN_PRIVILEGES structure that specifies an array of privileges and their attributes. If the DisableAllPrivileges parameter is FALSE, AdjustTokenPrivileges enables or disables these privileges for the token. If you set the SE_PRIVILEGE_ENABLED attribute for a privilege, the function enables that privilege; otherwise, it disables the privilege. If DisableAllPrivileges is TRUE, the function ignores this parameter.</param>
        /// <param name="BufferLength">Specifies the size, in bytes, of the buffer pointed to by the PreviousState parameter. This parameter can be zero if the PreviousState parameter is NULL.</param>
        /// <param name="PreviousState">Pointer to a buffer that the function fills with a TOKEN_PRIVILEGES structure that contains the previous state of any privileges that the function modifies. This parameter can be NULL.</param>
        /// <param name="ReturnLength">Pointer to a variable that receives the required size, in bytes, of the buffer pointed to by the PreviousState parameter. This parameter can be NULL if PreviousState is NULL.</param>
        /// <returns>If the function succeeds, the return value is nonzero. To determine whether the function adjusted all of the specified privileges, call Marshal.GetLastWin32Error.</returns>
        [DllImport("advapi32.dll", EntryPoint = "AdjustTokenPrivileges", CharSet = CharSet.Ansi)]
        private static extern int AdjustTokenPrivileges(IntPtr TokenHandle, int DisableAllPrivileges, ref TOKEN_PRIVILEGES NewState, int BufferLength, ref TOKEN_PRIVILEGES PreviousState, ref int ReturnLength);
        /// <summary>
        /// The ExitWindowsEx function either logs off the current user, shuts down the system, or shuts down and restarts the system. It sends the WM_QUERYENDSESSION message to all applications to determine if they can be terminated.
        /// </summary>
        /// <param name="uFlags">Specifies the type of shutdown.</param>
        /// <param name="dwReserved">This parameter is ignored.</param>
        /// <returns>If the function succeeds, the return value is nonzero.<br></br><br>If the function fails, the return value is zero. To get extended error information, call Marshal.GetLastWin32Error.</br></returns>
        [DllImport("user32.dll", EntryPoint = "ExitWindowsEx", CharSet = CharSet.Ansi)]
        private static extern int ExitWindowsEx(int uFlags, int dwReserved);
        /// <summary>
        /// The FormatMessage function formats a message string. The function requires a message definition as input. The message definition can come from a buffer passed into the function. It can come from a message table resource in an already-loaded module. Or the caller can ask the function to search the system's message table resource(s) for the message definition. The function finds the message definition in a message table resource based on a message identifier and a language identifier. The function copies the formatted message text to an output buffer, processing any embedded insert sequences if requested.
        /// </summary>
        /// <param name="dwFlags">Specifies aspects of the formatting process and how to interpret the lpSource parameter. The low-order byte of dwFlags specifies how the function handles line breaks in the output buffer. The low-order byte can also specify the maximum width of a formatted output line.</param>
        /// <param name="lpSource">Specifies the location of the message definition. The type of this parameter depends upon the settings in the dwFlags parameter.</param>
        /// <param name="dwMessageId">Specifies the message identifier for the requested message. This parameter is ignored if dwFlags includes FORMAT_MESSAGE_FROM_STRING.</param>
        /// <param name="dwLanguageId">Specifies the language identifier for the requested message. This parameter is ignored if dwFlags includes FORMAT_MESSAGE_FROM_STRING.</param>
        /// <param name="lpBuffer">Pointer to a buffer for the formatted (and null-terminated) message. If dwFlags includes FORMAT_MESSAGE_ALLOCATE_BUFFER, the function allocates a buffer using the LocalAlloc function, and places the pointer to the buffer at the address specified in lpBuffer.</param>
        /// <param name="nSize">If the FORMAT_MESSAGE_ALLOCATE_BUFFER flag is not set, this parameter specifies the maximum number of TCHARs that can be stored in the output buffer. If FORMAT_MESSAGE_ALLOCATE_BUFFER is set, this parameter specifies the minimum number of TCHARs to allocate for an output buffer. For ANSI text, this is the number of bytes; for Unicode text, this is the number of characters.</param>
        /// <param name="Arguments">Pointer to an array of values that are used as insert values in the formatted message. A %1 in the format string indicates the first value in the Arguments array; a %2 indicates the second argument; and so on.</param>
        /// <returns>If the function succeeds, the return value is the number of TCHARs stored in the output buffer, excluding the terminating null character.<br></br><br>If the function fails, the return value is zero. To get extended error information, call Marshal.GetLastWin32Error.</br></returns>
        [DllImport("user32.dll", EntryPoint = "FormatMessageA", CharSet = CharSet.Ansi)]
        private static extern int FormatMessage(int dwFlags, IntPtr lpSource, int dwMessageId, int dwLanguageId, StringBuilder lpBuffer, int nSize, int Arguments);
        /// <summary>
        /// Exits windows (and tries to enable any required access rights, if necesarry).
        /// </summary>
        /// <param name="how">One of the RestartOptions values that specifies how to exit windows.</param>
        /// <param name="force">True if the exit has to be forced, false otherwise.</param>
        /// <exception cref="PrivilegeException">There was an error while requesting a required privilege.</exception>
        /// <exception cref="PlatformNotSupportedException">The requested exit method is not supported on this platform.</exception>
        public static void ExitWindows(RestartOptions how, bool force)
        {
            switch (how)
            {
                case RestartOptions.Suspend:
                    SuspendSystem(false, force);
                    break;
                case RestartOptions.Hibernate:
                    SuspendSystem(true, force);
                    break;
                default:
                    ExitWindows((int)how, force);
                    break;
            }
        }
        /// <summary>
        /// Exits windows (and tries to enable any required access rights, if necesarry).
        /// </summary>
        /// <param name="how">One of the RestartOptions values that specifies how to exit windows.</param>
        /// <param name="force">True if the exit has to be forced, false otherwise.</param>
        /// <remarks>This method cannot hibernate or suspend the system.</remarks>
        /// <exception cref="PrivilegeException">There was an error while requesting a required privilege.</exception>
        protected static void ExitWindows(int how, bool force)
        {
            EnableToken("SeShutdownPrivilege");
            if (force)
                how = how | EWX_FORCE;
            if (ExitWindowsEx(how, 0) == 0)
                throw new PrivilegeException(FormatError(Marshal.GetLastWin32Error()));
        }
        /// <summary>
        /// Tries to enable the specified privilege.
        /// </summary>
        /// <param name="privilege">The privilege to enable.</param>
        /// <exception cref="PrivilegeException">There was an error while requesting a required privilege.</exception>
        protected static void EnableToken(string privilege)
        {
            if (!CheckEntryPoint("advapi32.dll", "AdjustTokenPrivileges"))
                return;
            IntPtr tokenHandle = IntPtr.Zero;
            LUID privilegeLUID = new LUID();
            TOKEN_PRIVILEGES newPrivileges = new TOKEN_PRIVILEGES();
            TOKEN_PRIVILEGES tokenPrivileges;
            if (OpenProcessToken(Process.GetCurrentProcess().Handle, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref tokenHandle) == 0)
                throw new PrivilegeException(FormatError(Marshal.GetLastWin32Error()));
            if (LookupPrivilegeValue("", privilege, ref privilegeLUID) == 0)
                throw new PrivilegeException(FormatError(Marshal.GetLastWin32Error()));
            tokenPrivileges.PrivilegeCount = 1;
            tokenPrivileges.Privileges.Attributes = SE_PRIVILEGE_ENABLED;
            tokenPrivileges.Privileges.pLuid = privilegeLUID;
            int size = 4;
            if (AdjustTokenPrivileges(tokenHandle, 0, ref tokenPrivileges, 4 + (12 * tokenPrivileges.PrivilegeCount), ref newPrivileges, ref size) == 0)
                throw new PrivilegeException(FormatError(Marshal.GetLastWin32Error()));
        }
        /// <summary>
        /// Suspends or hibernates the system.
        /// </summary>
        /// <param name="hibernate">True if the system has to hibernate, false if the system has to be suspended.</param>
        /// <param name="force">True if the exit has to be forced, false otherwise.</param>
        /// <exception cref="PlatformNotSupportedException">The requested exit method is not supported on this platform.</exception>
        protected static void SuspendSystem(bool hibernate, bool force)
        {
            if (!CheckEntryPoint("powrprof.dll", "SetSuspendState"))
                throw new PlatformNotSupportedException("The SetSuspendState method is not supported on this system!");
            SetSuspendState((int)(hibernate ? 1 : 0), (int)(force ? 1 : 0), 0);
        }
        /// <summary>
        /// Checks whether a specified method exists on the local computer.
        /// </summary>
        /// <param name="library">The library that holds the method.</param>
        /// <param name="method">The entry point of the requested method.</param>
        /// <returns>True if the specified method is present, false otherwise.</returns>
        protected static bool CheckEntryPoint(string library, string method)
        {
            IntPtr libPtr = LoadLibrary(library);
            if (!libPtr.Equals(IntPtr.Zero))
            {
                if (!GetProcAddress(libPtr, method).Equals(IntPtr.Zero))
                {
                    FreeLibrary(libPtr);
                    return true;
                }
                FreeLibrary(libPtr);
            }
            return false;
        }
        /// <summary>
        /// Formats an error number into an error message.
        /// </summary>
        /// <param name="number">The error number to convert.</param>
        /// <returns>A string representation of the specified error number.</returns>
        protected static string FormatError(int number)
        {
            StringBuilder buffer = new StringBuilder(255);
            FormatMessage(FORMAT_MESSAGE_FROM_SYSTEM, IntPtr.Zero, number, 0, buffer, buffer.Capacity, 0);
            return buffer.ToString();
        }
    }
    /// <summary>
    /// The exception that is thrown when an error occures when requesting a specific privilege.
    /// </summary>
    public class PrivilegeException : Exception
    {
        /// <summary>
        /// Initializes a new instance of the PrivilegeException class.
        /// </summary>
        public PrivilegeException() : base() { }
        /// <summary>
        /// Initializes a new instance of the PrivilegeException class with a specified error message.
        /// </summary>
        /// <param name="message">The message that describes the error.</param>
        public PrivilegeException(string message) : base(message) { }
    }
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-20T18:07:05.883

我看到的最好的方式：

```
System.Diagnostics.Process.Start("cmd.exe /c shutdown", "-rf"); 
```

WinAPI方法也很少..

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2018-06-01T20:41:07.477

您可以使用 WMI 和 LINQ 来平滑其粗糙点。

```
const int restart = 2;
var management = new ManagementClass("Win32_OperatingSystem");
management.Scope.Options.EnablePrivileges = true;
management.GetInstances().OfType<ManagementObject>().First().InvokeMethod("Win32Shutdown", new object[] { restart, 0 }); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-20T18:14:10.377

检查这篇文章..它给出了你问题的答案

[http://www.codeproject.com/KB/cs/timercomputershutdown.aspx](http://www.codeproject.com/KB/cs/timercomputershutdown.aspx)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-20T18:14:12.390

如果您不介意使用 WinAPI，您可以调用 user32.dll 中的 ExitWindows 函数。这里有一篇文章告诉你一切：
[http ://www.eggheadcafe.com/tutorials/aspnet/e5ef4e3e-6f42-4b9b-8834-04366ce32c96/net-lock-logoff-reboot.aspx](http://www.eggheadcafe.com/tutorials/aspnet/e5ef4e3e-6f42-4b9b-8834-04366ce32c96/net-lock-logoff-reboot.aspx)

# c# - 如何将 WPF 用户控件的宽度拉伸到其窗口？

> ID：462390
> 
> 赞同：46
> 
> 时间：2009-01-20T18:05:26.150
> 
> 标签：c#, .net, wpf, xaml, wpf-controls

我有一个带有用户控件的窗口，我想让用户控件宽度等于窗口宽度。怎么做？

用户控件是一个水平菜单，包含一个三列网格：

```
<ColumnDefinition Name="LeftSideMenu" Width="433"/>
<ColumnDefinition Name="Middle" Width="*"/>
<ColumnDefinition Name="RightSideMenu" Width="90"/> 
```

这就是我想要窗口宽度的原因，将用户控件拉伸到 100% 宽度，第二列相对。

编辑：

我正在使用网格，有 Window 的代码：

```
<Window x:Class="TCI.Indexer.UI.Operacao"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:tci="clr-namespace:TCI.Indexer.UI.Controles"
    Title=" " MinHeight="550" MinWidth="675" Loaded="Load" ResizeMode="NoResize" WindowStyle="None" WindowStartupLocation="CenterScreen" WindowState="Maximized" Focusable="True"
    x:Name="windowOperacao">
    <Canvas x:Name="canv">
        <Grid>
            <tci:Status x:Name="ucStatus"/> <!-- the control which I want to stretch in width -->
        </Grid>
    </Canvas>
</Window> 
```

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-01-20T18:32:07.830

您需要确保您的用户控件没有在用户控件的 xaml 文件中设置它的宽度。只需从中删除 Width="..." 就可以了！

**编辑：**这是我测试它的代码：

*SOUserAnswerTest.xaml：*

```
<UserControl x:Class="WpfApplication1.SOAnswerTest"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Height="300">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Name="LeftSideMenu" Width="100"/>
            <ColumnDefinition Name="Middle" Width="*"/>
            <ColumnDefinition Name="RightSideMenu" Width="90"/>
        </Grid.ColumnDefinitions>
        <TextBlock Grid.Column="0">a</TextBlock>
        <TextBlock Grid.Column="1">b</TextBlock>
        <TextBlock Grid.Column="2">c</TextBlock>
    </Grid>
</UserControl> 
```

*Window1.xaml：*

```
<Window x:Class="WpfApplication1.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:WpfApplication1"
    Title="Window1" Height="300" Width="415">
    <Grid>

        <local:SOAnswerTest Grid.Column="0" Grid.Row="5" Grid.ColumnSpan="2"/>
    </Grid>
</Window> 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-01-22T19:49:31.573

WPF 中的 Canvas 没有提供太多的自动布局支持。出于这个原因，我试图避开它们（Horizo​​ntalAlignment 和 VerticalAlignment 不能按预期工作），但我让您的代码可以处理这些小修改（将控件的宽度和高度绑定到画布的 ActualWidth/ActualHeight）。

```
<Window x:Class="TCI.Indexer.UI.Operacao"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:tci="clr-namespace:TCI.Indexer.UI.Controles"
Title=" " MinHeight="550" MinWidth="675" Loaded="Load" 
ResizeMode="NoResize" WindowStyle="None" WindowStartupLocation="CenterScreen" 
WindowState="Maximized" Focusable="True" x:Name="windowOperacao">

<Canvas x:Name="canv">
    <Grid>
        <tci:Status x:Name="ucStatus" Width="{Binding ElementName=canv
                                                    , Path=ActualWidth}" 
                                      Height="{Binding ElementName=canv
                                                    , Path=ActualHeight}"/> 
        <!-- the control which I want to stretch in width -->
    </Grid>
</Canvas> 
```

画布是这里的问题。如果您实际上并没有利用画布在布局或 Z 顺序“挤压”方面提供的功能（想想 PhotoShop 中的 flatten 命令），我会考虑使用像 Grid 这样的控件，这样您就不会结束必须了解与 WPF 所期望的工作方式不同的控件的怪癖。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-21T13:37:39.560

画布在您的窗口中至关重要吗？如果没有，请尝试将其删除并将 Grid 保留为主面板。除非指定，否则 Canvas 没有大小，而 Grid 通常会占用所有可用空间。在画布内部，网格将没有可用空间。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-20T18:30:39.703

将用户控件上的 Horizo​​ntalAlignment 设置为 Stretch 并将 Width 设置为 Auto 是否可以达到预期的效果？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-20T18:26:30.710

您要将 UserControl 添加到哪个容器？通常，当您将控件添加到 Grid 时，它们会拉伸以填充可用空间（除非它们的行/列被限制为特定宽度）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-01-25T01:18:15.360

而是在用户控件中使用 Width 和 Height，使用 MinHeight 和 MinWidth。然后你就可以很好的配置UC，并且可以在其他窗口中进行拉伸。

好吧，正如我在 WPF 中看到的那样，微软对 Windows 属性和行为进行了重新思考，但到目前为止，我并没有错过旧的 Windows 窗体中的任何内容，在 WPF 中，控件在那里，但在一个新的角度。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-03-22T02:20:22.517

这对我有用。不要为 UserControl 分配任何宽度或高度，并在父窗口中定义行和列定义。

```
<UserControl x:Class="MySampleApp.myUC"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
         mc:Ignorable="d"  
        >
   <Grid>

    </Grid>
</UserControl>

 <Window xmlns:MySampleApp="clr-namespace:MySampleApp"  x:Class="MySampleApp.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="auto" Width="auto" MinWidth="1000" >
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto" />           
    </Grid.RowDefinitions>
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*" />            
    </Grid.ColumnDefinitions>
    <MySampleApp:myUC Grid.Column="0" Grid.Row="0" />       
</Grid> 
```

# unit-testing - 您建议从 TDD 迁移到 BDD 的步骤是什么？

> ID：462401
> 
> 赞同：9
> 
> 时间：2009-01-20T18:07:12.060
> 
> 标签：unit-testing, tdd, bdd

如果您想将您的开发过程从测试驱动开发转移到[行为驱动开发](http://en.wikipedia.org/wiki/Behavior_Driven_Development)，您会采取或推荐什么路径？

您可能面临哪些挑战？随着范式的变化、思维过程的转变和项目执行前景的变化，移动开发过程本身将是一项艰巨的任务。

有没有人有过让这种转变顺利进行的真实经验（嗯……可能不是那么顺利）？

或者任何人试图做出这种转变？

我知道这可能不适用于每件事。但是，如果有人需要朝这个方向发展，那么合乎逻辑的步骤是什么。

我从以下 SO 帖子中只有关于 BDD 的基本信息。 [TDD 和 BDD 之间的主要区别](https://stackoverflow.com/questions/2509/what-are-the-primary-differences-between-tdd-and-bdd)

我正在寻找的关键点是：

*   需要什么样的开发人员培训？
*   SDLC 流程是否有任何重大变化？
*   您推荐哪些 BDD 工具（.net）？
*   良好的 BDD 资源 (.net)

提前致谢。

## 编辑：

关于 .NET 的 BDD 框架，我在 SO [Most Mature BDD Framework for .NET中看到了这篇文章](https://stackoverflow.com/questions/307895/what-is-the-most-mature-bdd-framework-for-net)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-09T19:31:24.300

当我开始研究 BDD 时，我调查了所有的框架（对于 .net），但最终没有使用它们。主要原因是我觉得社区还没有确定语法和最佳实践，所以我继续使用 NUnit 和基于Ben Scheirman的[博客文章的基类。](http://flux88.com/blog/the-transition-from-tdd-to-bdd/)这非常有效，因为 BDD 不是关于工具，而是使测试干净且易于理解，这对于像 nunit 这样的普通工具是完全可能的。

与我的旧单元测试相比，新样式更具可读性，并且更加关注命名和行为。我们距离打印出方法名称并与业务人员讨论该系统不远了。

Scott Bellware 的一些附加读物：[行为驱动开发](http://www.code-magazine.com/article.aspx?quickid=0805061&page=1 "行为驱动开发")

测试示例：

```
public class WhenAddingLineItemToEmptyOrder : BDDBase
{
    Order order;

    [SetUp]
    public void Arrange()
    {
        order = new Order();
    }

    public void Act() // called by BDDBase
    {
        LintItem item = new LineItem();
        item.Quantity = 1;
        item.Price = 10;
        order.AddLineItem(item);
    }

    [Test]
    public void TotalPriceShouldBeUpdated()
    {
        Assert.AreEqual(10, order.TotalPrice);
    }

    [Test]
    public void OrderCanBeCheckedOut()
    {
        Assert.IsTrue(order.CanBeCheckedOut)
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-20T18:36:59.503

据我了解... BDD 是一种看待 TDD 的新方法。这更像是一种心理转变，而不是新技术。

我的意思是你可以在技术上使用单元测试工具来做 BDD

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T19:33:09.017

行为驱动开发是一种现代敏捷工具，使您的公司能够重新评估开发人员的核心能力，以便找到更好的沟通方式，增加管理愿景的交叉，这将使您能够在一个全新的水平上有效地创造价值您的内在市场地位。
测试驱动开发的思维方式转变体现了范式转变，包括深入的工作流分析、通过最先进的敏捷方法不断反馈，以及对底层行为场景转换矩阵的仔细关注。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T19:50:31.447

您可能想收听[Hanselminutes Show #146 - 测试驱动的开发就是设计 - TDD 的最后一句话](http://www.hanselminutes.com/default.aspx?showID=164)。

Scott Bellware 说的最有趣的事：“测试驱动开发就是设计”

让他“打开”它的书：[Microsoft® .NE​​T 中的测试驱动开发](http://www.microsoft.com/learning/en/us/books/6778.aspx)（对于 .NET 开发人员，请收听播客了解上下文）

# .net - SQL Service Broker 和 .NET Windows 服务 - 最佳实践？

> ID：462426
> 
> 赞同：13
> 
> 时间：2009-01-20T18:14:23.857
> 
> 标签：.net, sql-server, service-broker

我目前有一个从旧应用程序更新的数据库。我想利用 SQL Service Broker 队列，以便在更新记录时将消息放入队列中（使用触发器或其他东西）。

然后，我想要一个长时间运行的应用程序（用 .NET 编写的 Windows 服务），它不断地“监听”队列以获取消息并为另一个应用程序处理它们。

我在网上找到了一些示例代码，只是想获得一些关于代码是否可靠的输入。因此，这是 Windows 服务类的缩写版本：

```
public class MyService
{
    public void StartService()
    {
        Thread listener = new Thread(Listen);
        listener.IsBackground = true;
        listener.Start();
    }

    private void Listen()
    {
        while (true)
        {
            using (SqlConnection connection = new SqlConnection(_connectionString))
            {
                string commandText = "WAITFOR ( RECEIVE * FROM MyQueue);";
                using (SqlCommand command = new SqlCommand(commandText, connection))
                {
                    connection.Open();
                    command.CommandTimeout = 0;
                    SqlDataReader reader = command.ExecuteReader();
                    while (reader.Read())
                    {
                        // Process message
                    }
                }
            }
        }
    }
} 
```

你怎么看？代码完全按照我想要的方式工作。但是分离一个包含 SQL 命令的新线程的想法永远不会超时 - 在无限循环中 - 让我有点紧张。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-20T18:58:16.060

如果您处于无限循环中，您的服务将不会完全关闭。您应该检查退出条件，在服务收到关闭消息时设置。您可以向 WAITFOR 添加超时，以便检查是否应该关闭。您还应该在处理的每一行上检查这一点。

我使用了 2 秒的睡眠来延迟，但是在 WAITFOR 上执行 2 秒的超时会完成同样的事情。

服务有 30 秒的时间关闭，否则 Windows 会认为它卡住了。

# php - is_numeric、intval、ctype__digit.. 你能依赖它们吗？

> ID：462427
> 
> 赞同：8
> 
> 时间：2009-01-20T18:14:36.197
> 
> 标签：php, regex, numeric

is_numeric、intval、ctype__digit.. 你能依赖它们吗？

还是我必须使用正则表达式？

```
函数 isNum($str) {

    return (preg_match("/^[0-9]+$/", $str));

}

```

你们有什么感想？我傻吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2014-10-02T08:46:40.080

`ctype_digit`和之间的一个重要区别`is_numerict`是负值和浮点数。

`is_numeric(-10)`将返回`true`而 'ctype_digit(-10)' 将是`false`

也`ctype_digit(12.50)`将返回`false`而 `is_numeric(12.50)`将是`true`

所以它们都很方便取决于你的域逻辑的上下文。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-20T18:28:27.867

is_numeric、intval 和 ctype_digit 都做了非常不同的事情。

[is_numeric](http://ca3.php.net/manual/en/function.is-numeric.php)将告诉您变量的内容是否为数字（即如果它是浮点或整数值则为真）。

[intval](http://ca.php.net/manual/en/function.intval.php)尝试将一串数字转换为整数值

[ctype_digit](https://www.php.net/manual/en/function.ctype-digit.php)将告诉您字符串是否只包含数字字符（将执行与 isNum 函数相同的检查）。

最好的方法可能是检查 is_numeric 是否为真，然后使用 settype($myvalue, 'integer') 或 intval($myvalue);

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-20T20:53:04.160

您命名了两种函数：

**Validator**检查给定值是否具有给定特征并返回*true*或*false*。
[`is_numeric`](http://docs.php.net/manual/en/function.is-numeric.php)，[`ctype_*`函数](http://docs.php.net/manual/en/ref.ctype.php)和你的`isNum`函数是验证函数，因为它们只是告诉你一个值是否有效。

**过滤器**以新值具有给定特征的方式更改给定值，因此将是*有效*的。
[`intval`](http://docs.php.net/manual/en/function.intval.php)并且这些[`filter_*`函数](http://docs.php.net/manual/en/ref.filter.php)是过滤函数，因为它们总是会返回可以通过验证器的有效值。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-20T19:36:17.997

You can also use the new [filter functions](http://no.php.net/manual/en/function.filter-var.php).

```
if (!$var = filter_var($var, FILTER_VALIDATE_INT)) {
  die('Not an int!');
}

echo "Var has the value $var.\n"; 
```

Best used when filtering input from cli, web client, etc. [List of filters here](http://no.php.net/manual/en/intro.filter.php).

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-21T03:31:32.420

按照文档。`is_numeric`将始终可用，并且仅验证您有一个可以被 PHP 视为数字的字符串。这些`ctype_*`功能的范围有点窄，但也应该始终可用。

IMO 对此类检查来说，RegEx 是矫枉过正的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-20T18:21:44.887

我不是 PHP 专家，但您是否考虑过编写数据驱动的单元测试来具体了解这些功能。如果您不确定它们的可靠性并且文档不清楚，那么没有什么比可以测试 1000 个排列及其预期输出的单元测试更好的了。

您甚至不必像我想象的那样走那么远，您只想测试一些特殊的边缘情况。您的编程技能和编译器是您最好的朋友。您编写的程序将确认或否认您的怀疑。

此外，为了获得奖励，您可以监控每种方法需要多长时间，并查看哪种方法性能更高。

只是一个想法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-20T18:24:28.640

我不确定你为什么不只使用intval。毕竟，您的正则表达式甚至没有考虑负数，而 intval 会（尽管也许这就是您想要的？）。

或者甚至只是强制转换为 int，这样可以避免一些深奥的浮点“陷阱”，这些问题可能会与 intval 一起偷偷摸摸。

# sql - 锁定 SQL Server 存储过程

> ID：462434
> 
> 赞同：3
> 
> 时间：2009-01-20T18:17:50.353
> 
> 标签：sql, sql-server, stored-procedures, locking

我有一个存储过程，它根据某些标准操作整数表字段（表示序列号） - 标准可以将该字段重置为零。在多用户环境中，该字段可能在被另一个用户更新之前被 1 个用户引用，所以我想通过将存储过程限制为一次只为 1 个用户运行来防止这种情况。有没有办法在我的存储过程中做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-20T18:19:25.093

如果您将语句包装在事务中，它们将全部以原子方式执行。不过，您可能需要根据需要提高[事务隔离级别](http://msdn.microsoft.com/en-us/library/ms173763.aspx)。

例如，如果您不希望其他人在执行一堆语句时读取或写入特定表，则顶部的此语句将实现这一点：

```
SET TRANSACTION ISOLATION LEVEL SERIALIZABLE; 
```

不过，除非绝对必要，否则我不建议升级到这个级别，因为它基本上破坏了并发优势。

相反，请考虑使用较低的内容或重新编写逻辑以消除对关键部分的需求。

# python - Python 中的数据包嗅探（Windows）

> ID：462439
> 
> 赞同：15
> 
> 时间：2009-01-20T18:18:33.583
> 
> 标签：python, sniffing, sniffer

使用 Python 嗅探网络数据包的最佳方法是什么？

我从几个地方听说最好的模块是一个名为 Scapy 的模块，不幸的是，它使 python.exe 在我的系统上崩溃。我认为这只是我如何安装它的问题，除了许多其他人告诉我它在 Windows 上运行得不是特别好。（如果有人感兴趣，我正在运行 Windows Vista，这可能会影响事情）。

有谁知道更好的解决方案？

升级版：

在阅读了告诉我安装 PyPcap 的答案后，我搞砸了一点，发现我尝试使用的 Scapy 也告诉我安装 PyPcap，除了它是一个修改版本供它使用。显然，正是这个修改后的 PyPcap 导致了问题，因为答案中的示例也导致了挂起。

我安装了 PyPcap 的原始版本（来自 Google 的网站），并且 Scapy 开始正常工作（我没有尝试很多东西，但至少在我开始嗅探时它没有崩溃）。[我向 Scapy 开发人员发送了一张新的缺陷票： http](http://trac.secdev.org/scapy/ticket/166) ://trac.secdev.org/scapy/ticket/166 ，希望他们能用它做点什么。

无论如何，只是想我会让你们都知道。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2015-08-30T21:19:05.897

# 艰难的路

您可以使用原始套接字嗅探所有 IP 数据包。
原始套接字是以二进制形式发送和接收数据的套接字。
python中的二进制表示在一个看起来像这样的字符串中`\x00\xff`......每个`\x..`都是一个字节。
要读取 IP 数据包，您需要根据 IP 协议以二进制形式分析接收到的数据包。

这是 IP 协议格式的图像，每个标头的大小以位为单位。

[![IP协议格式](https://i.stack.imgur.com/rtM54.jpg)](https://i.stack.imgur.com/rtM54.jpg)

本教程可能会帮助您了解了解原始数据包并将其拆分为标头的过程：http: [//www.binarytides.com/python-packet-sniffer-code-linux/](http://www.binarytides.com/python-packet-sniffer-code-linux/)

# 简单的方法

另一种非常容易嗅探 IP 数据包的方法是使用 scapy 模块。

```
from scapy.all import *
sniff(filter="ip", prn=lambda x:x.sprintf("{IP:%IP.src% -> %IP.dst%\n}")) 
```

此代码将为您打印每个 IP 数据包的源 IP 和目标 IP。您可以通过阅读此处的文档来使用 scapy 做更多事情：[http ://www.secdev.org/projects/scapy/doc/usage.html](http://www.secdev.org/projects/scapy/doc/usage.html)

这取决于您要实现的目标，但如果您需要构建一个项目，其功能是嗅探 IP 数据包，那么我建议使用 scapy 以获得更稳定的脚本。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-20T18:31:15.303

使用[pypcap](http://code.google.com/p/pypcap/)：

```
import dpkt, pcap
pc = pcap.pcap()     # construct pcap object
pc.setfilter('icmp') # filter out unwanted packets
for timestamp, packet in pc:
    print dpkt.ethernet.Ethernet(packet) 
```

输出样本：

```
Ethernet(src='\x00\x03G\xb2M\xe4', dst='\x00\x03G\x06h\x18', data=IP(src='\n\x00\x01\x1c',
dst='\n\x00\x01\x10', sum=39799, len=60, p=1, ttl=128, id=35102, data=ICMP(sum=24667,
type=8, data=Echo(id=512, seq=60160, data='abcdefghijklmnopqrstuvwabcdefghi'))))

Ethernet(src='\x00\x03G\x06h\x18', dst='\x00\x03G\xb2M\xe4', data=IP(src='\n\x00\x01\x10',
dst='\n\x00\x01\x1c', sum=43697, len=60, p=1, ttl=255, id=64227, data=ICMP(sum=26715,
data=Echo(id=512, seq=60160, data='abcdefghijklmnopqrstuvwabcdefghi')))) 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-20T18:20:59.787

使用[python-libpcap](http://sourceforge.net/projects/pylibpcap/)。

```
import pcap

p = pcap.pcapObject()
dev = pcap.lookupdev()
p.open_live(dev, 1600, 0, 100)
#p.setnonblock(1)
try:
    for pktlen, data, timestamp in p:
        print "[%s] Got data: %s" % (time.strftime('%H:%M', 
                                                   time.localtime(timestamp)),
                                     data)
except KeyboardInterrupt:
    print '%s' % sys.exc_type
    print 'shutting down'
    print ('%d packets received, %d packets dropped'
           ' %d packets dropped by interface') % p.stats() 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-12-08T14:45:49.973

您可以使用原始套接字，以及您的接口 IP 地址（在管理员模式下），

```
import socket
s = socket.socket(socket.AF_INET,socket.SOCK_RAW,socket.IPPROTO_IP)
s.bind(("YOUR_INTERFACE_IP",0))
s.setsockopt(socket.IPPROTO_IP,socket.IP_HDRINCL,1)
s.ioctl(socket.SIO_RCVALL,socket.RCVALL_ON)
while True:
   data = s.recvfrom(10000)
   print data 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-10-09T14:22:31.173

如果scapy，请尝试以下方法。（它适用于 Windows 10）

```
# -*- coding: utf-8 -*-

# pip install scapy

"""
[{'name': 'Intel(R) 82574L Gigabit Network Connection',
  'win_index': '4',
  'description': 'Ethernet0',
  'guid': '{XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX}',
  'mac': '00:0C:29:5C:EE:6D',
  'netid': 'Ethernet0'}]
"""

from pprint import pprint
from scapy.arch.windows import get_windows_if_list
from scapy.all import *

# disable verbose mode
conf.verb = 0

def parse_packet(packet):
    """sniff callback function.
    """
    if packet and packet.haslayer('UDP'):
        udp = packet.getlayer('UDP')
        udp.show()

def udp_sniffer():
    """start a sniffer.
    """
    interfaces = get_windows_if_list()
    pprint(interfaces)

    print('\n[*] start udp sniffer')
    sniff(
        filter="udp port 53",
        iface=r'Intel(R) 82574L Gigabit Network Connection', prn=parse_packet
    )

if __name__ == '__main__':
    udp_sniffer() 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-20T18:26:40.367

另一种选择是[pypcap](http://code.google.com/p/pypcap/)。

为了解析结果，[Construct](http://construct.wikispaces.com/)非常灵巧。

# iphone - iPhone 中的 XSLT 版本

> ID：462440
> 
> 赞同：14
> 
> 时间：2009-01-20T18:18:36.173
> 
> 标签：iphone, cocoa-touch, xslt

我计划在我的 iPhone 应用程序中使用 XML/XSLT。

iPhone 目前支持哪个版本的 XSLT？我可以使用 XSLT 2.0 还是只使用 1.0 ？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2010-02-16T14:49:44.560

在 iPhone OS 上使用`libxslt`其实很简单：

1.  [下载 libxslt 的源代码](http://xmlsoft.org/XSLT/downloads.html)并解压。
2.  将“libxslt”目录添加到构建设置中的**标题搜索路径**。此外，在此处添加 libxml-headers 的路径（通常`/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS3.0.sdk/usr/include/libxml2`）。
3.  将 libxml2.2.dylib 和 libxslt.dylib 添加到**链接的框架**（Xcode“组和文件”面板：右键单击“框架”->“添加”->“现有框架...”）。
4.  创建一个简单的 XML 文件及其 XSL 转换。

最后，您可以使用类似于上面示例的代码将转换结果转换为 an `NSString`（例如显示在 a 中`UIWebView`）：

```
#import <libxml/xmlmemory.h>
#import <libxml/debugXML.h>
#import <libxml/HTMLtree.h>
#import <libxml/xmlIO.h>
#import <libxml/xinclude.h>
#import <libxml/catalog.h>
#import <libxslt/xslt.h>
#import <libxslt/xsltInternals.h>
#import <libxslt/transform.h>
#import <libxslt/xsltutils.h>

...

NSString* filePath = [[NSBundle mainBundle] pathForResource: @"article" ofType: @"xml"];
NSString* styleSheetPath = [[NSBundle mainBundle] pathForResource: @"article_transform" ofType:@"xml"];

xmlDocPtr doc, res;

// tells the libxml2 parser to substitute entities as it parses your file
xmlSubstituteEntitiesDefault(1);
// This tells libxml to load external entity subsets
xmlLoadExtDtdDefaultValue = 1;

sty = xsltParseStylesheetFile((const xmlChar *)[styleSheetPath cStringUsingEncoding: NSUTF8StringEncoding]);
doc = xmlParseFile([filePath cStringUsingEncoding: NSUTF8StringEncoding]);
res = xsltApplyStylesheet(sty, doc, NULL);

char* xmlResultBuffer = nil;
int length = 0;

xsltSaveResultToString(&xmlResultBuffer, &length, res, sty);

NSString* result = [NSString stringWithCString: xmlResultBuffer encoding: NSUTF8StringEncoding];

NSLog(@"Result: %@", result);

free(xmlResultBuffer);

xsltFreeStylesheet(sty);
xmlFreeDoc(res);
xmlFreeDoc(doc);

xsltCleanupGlobals();
xmlCleanupParser(); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-11-08T11:57:07.367

正如 Lou Franco 所指出的，iPhone 上不允许使用 dylib。

它在模拟器和手机的开发中都可以正常工作，但是一旦您将其提交给 Apple 批准，它就会被拒绝。我的应用在大约 20 分钟内就被拒绝了，大概是被他们的自动静态分析工具拒绝了。

相反，下载源代码，将其添加到您的项目中，链接 LibXML2.2.dylib（不要问我为什么允许使用此 dylib 但不允许使用 XSLT！）并构建项目。这就是你所要做的。这要归功于 Lou，因为正是他为我指明了正确的方向。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-20T18:42:05.110

恐怕 xslt 的情况相当严峻。课程将`NSXMLDocument`是做到这一点的方式，但苹果将其从 iPhone 中撤下。

[TouchXML](http://code.google.com/p/touchcode/wiki/TouchXML)计划支持 xslt，但还没有。

我知道的唯一选择是直接使用[libxslt](http://xmlsoft.org/XSLT/)，它支持 xslt 1.0 和一些[exslt](http://www.exslt.org/)扩展。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-01-26T14:53:44.027

即使您自己编译并构建它，也不能在 iPhone 上使用 libxslt。我已经这样做了，并且我的应用程序反复被拒绝。AppReview 过程使用的工具不区分代码中的静态链接符号和 iOS 中的动态链接符号。换句话说，如果您使用 libxslt，您的应用将被拒绝，因为应用商店无法判断您是否使用私有 API。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-09-23T01:54:59.820

对于更新到 XCode 5 + iOS7 baseSDK 的每个人，您会注意到，如果您包含`libxslt-1.1.26`在您的项目中并从源代码编译，它使用的是先前版本的`libxml`. 在最新的基础 SDK`libxml`中已更新，因此您需要更新到`libxslt-1.1.28`.

当您下载最新`.tar.gz`文件时，您第一次需要包含到您的项目中的是：

*   `config.h`
*   `libxslt/*.h`
*   `libxslt/*.c`

但是`config.h`，`libxslt/xsltconfig.h`还不存在。他们有`.in`后缀。您将需要运行`./configure`脚本，或者如果它不能直接为您工作，那么像我一样作弊。

**第 1 步 - 0 个差异**

`config.h.in`只需创建一个名为的新副本`config.h`。

**第 2 步 - 12 个差异**

`libxslt/xsltconfig.h.in`只需创建一个名为的新副本`libxslt/xsltconfig.h`。

前四个更改只是版本号。

1.  `#define LIBXSLT_DOTTED_VERSION "1.1.28"`
2.  `#define LIBXSLT_VERSION 10128`
3.  `#define LIBXSLT_VERSION_STRING "10128"`
4.  `#define LIBXSLT_VERSION_EXTRA "-GITv1.1.28"`

接下来的四个

1.  `#if @WITH_XSLT_DEBUG@`-> `#if 1`//只需替换`@WITH_XSLT_DEBUG@`为`1`
2.  `#if @WITH_MEM_DEBUG@`->`#if 1`
3.  `#if @WITH_TRIO@`->`#if 0`
4.  `#if @WITH_DEBUGGER@`->`#if 1`

最后四个

1.  `#if @WITH_MODULES@`->`#if 1`
2.  `#define LIBXSLT_DEFAULT_PLUGINS_PATH() "@LIBXSLT_DEFAULT_PLUGINS_PATH@"`->`#define LIBXSLT_DEFAULT_PLUGINS_PATH() "/usr/lib/libxslt-plugins"`
3.  `#if @XSLT_LOCALE_XLOCALE@`->`#if 1`
4.  `#if @XSLT_LOCALE_WINAPI@`->`#if 0`

    **第 3 步**

现在您已经手动执行了`./configure`将执行的步骤，您可以按照前面概述的说明将`libxslt`文件添加到项目中：

*   `config.h`
*   `libxslt/*.h`
*   `libxslt/*.c`

# c# - 嵌入式 (ASP.NET) Web 服务器

> ID：462444
> 
> 赞同：11
> 
> 时间：2009-01-20T18:20:22.377
> 
> 标签：c#, .net, asp.net, automated-tests, embeddedwebserver

我正在寻找适用于 .NET 的轻型 Web 可嵌入 Web 服务器。

我需要它来伪造 SOAP Web 服务以进行自动化测试，因此如果它支持 ASP.NET Web 服务或其他创建 SOAP Web 服务的简单方法，那将是一大优势。快速启动和关闭以及不同端口上的多个同时实例的额外奖励积分。

谷歌搜索出现[aspnetserve](http://code.google.com/p/aspnetserve/)、[www-Sharp.Runtime](http://www-sharp.com/)和[Neokernel Web Server](http://www.neokernel.com/content.agent?page_name=Home)。有人对这些或其他解决方案有任何经验吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-20T18:22:45.633

你可以试试[Cassini Web Server](https://code.google.com/p/cassini/)。

* * *

^(^(编辑))
现在 6 1/2 年后，我会推荐[IIS Express](http://www.iis.net/learn/extensions/introduction-to-iis-express/iis-express-overview)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-03-04T05:06:33.097

查看与 mono 捆绑的[XSP Web 服务器。](http://www.mono-project.com/ASP.NET)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-08-18T03:12:26.707

我最近遇到的其他一些可以托管 ASP.NET

*   [IIS 快递](http://weblogs.asp.net/scottgu/archive/2010/06/28/introducing-iis-express.aspx)
*   [UltiDev 卡西尼](http://ultidev.com/products/cassini/)
*   [深渊网络服务器](http://www.aprelium.com/)
*   [卡西尼开发](http://cassinidev.codeplex.com/)

# c# - C# 中的 GetHashCode 指南

> ID：462451
> 
> 赞同：138
> 
> 时间：2009-01-20T18:22:16.757
> 
> 标签：c#, .net, hashcode

我在 Essential C# 3.0 和 .NET 3.5 书中读到：

> GetHashCode() 在特定对象的生命周期内的返回应该是恒定的（相同的值），即使对象的数据发生变化。在许多情况下，您应该缓存方法返回以强制执行此操作。

这是一个有效的指导方针吗？

我在 .NET 中尝试了几个内置类型，但它们的行为并非如此。

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2010-07-13T08:53:24.047

已经很久了，但是我认为仍然有必要对这个问题给出正确的答案，包括解释为什么和如何。到目前为止，最好的答案是详尽引用 MSDN 的答案——不要试图制定自己的规则，MS 人员知道他们在做什么。

但首先要做的事情是：问题中引用的指南是错误的。

现在是为什么 - 其中有两个

**首先为什么**：如果哈希码以某种方式计算，即使对象本身发生变化，它在对象的生命周期内也不会改变，那么它会破坏等式契约。

请记住：“如果两个对象比较相等，则每个对象的 GetHashCode 方法必须返回相同的值。但是，如果两个对象不比较相等，则两个对象的 GetHashCode 方法不必返回不同的值。”

第二句话经常被误解为“唯一的规则是，在对象创建时，相等对象的哈希码必须相等”。不知道为什么，但这也是这里大多数答案的本质。

考虑两个包含名称的对象，其中名称用于 equals 方法：同名 -> 相同的事物。创建实例 A：名称 = Joe 创建实例 B：名称 = Peter

哈希码 A 和哈希码 B 很可能不一样。当实例 B 的名称更改为 Joe 时，现在会发生什么？

根据问题的指导方针， B 的哈希码不会改变。结果将是：A.Equals(B) ==> true 但同时：A.GetHashCode() == B.GetHashCode() ==> false。

但是，equals&hashcode-contract 明确禁止这种行为。

**第二个原因**：虽然 - 当然 - 是正确的，但哈希码中的更改可能会破坏使用哈希码的哈希列表和其他对象，反之亦然。不更改哈希码在最坏的情况下会得到哈希列表，其中所有许多不同的对象都将具有相同的哈希码并因此位于相同的哈希箱中 - 例如，当使用标准值初始化对象时会发生这种情况。

* * *

现在来看看如何 好吧，乍一看，似乎有一个矛盾 - 无论哪种方式，代码都会中断。但是这两个问题都不是来自更改或未更改的哈希码。

MSDN中很好地描述了问题的根源：

从 MSDN 的哈希表条目：

> 只要在 Hashtable 中用作键，键对象就必须是不可变的。

这确实意味着：

任何创建散列值的对象都应该在对象更改时更改散列值，但是当它在 Hashtable（或任何其他使用散列的对象，当然）中使用时，它不能 - 绝对不能 - 允许对自身进行任何更改.

首先，最简单的方法当然是设计仅用于哈希表的不可变对象，在需要时将其创建为普通可变对象的副本。在不可变对象内部，显然可以缓存哈希码，因为它是不可变的。

其次如何或给对象一个“你现在被散列”-标志，确保所有对象数据都是私有的，检查所有可以更改对象数据的函数中的标志，如果不允许更改则抛出异常数据（即设置标志）。现在，当您将对象放在任何散列区域时，请确保设置标志，并且 - 以及 - 在不再需要时取消设置标志。为了便于使用，我建议在“GetHashCode”方法中自动设置标志——这样就不会被遗忘。并且“ResetHashFlag”方法的显式调用将确保程序员必须考虑现在是否允许更改对象数据。

好的，也应该说一下：在某些情况下，可以有具有可变数据的对象，其中哈希码仍然没有改变，当对象数据发生更改时，不会违反 equals&hashcode-contract。

然而，这确实要求 equals 方法也不基于可变数据。因此，如果我编写一个对象，并创建一个 GetHashCode 方法，该方法只计算一次值并将其存储在对象中以在以后的调用中返回它，那么我必须再次：绝对必须创建一个 Equals 方法，它将使用为比较存储的值，因此 A.Equals(B) 也永远不会从 false 变为 true。否则，合同将被破坏。这样做的结果通常是 Equals 方法没有任何意义——它不是原始引用 equals，但也不是一个值 equals。有时，这可能是预期的行为（即客户记录），但通常不是。

因此，只需在对象数据更改时更改 GetHashCode 结果，并且如果打算（或只是可能）使用列表或对象在哈希内部使用对象，则使对象不可变或创建只读标志以用于包含对象的哈希列表的生命周期。

（顺便说一句：所有这一切都不是 C# 或 .NET 特定的 - 它是所有哈希表实现的本质，或更一般地说是任何索引列表，当对象在列表中时，对象的标识数据永远不应该改变. 如果违反此规则，将发生意外和不可预知的行为。在某个地方，可能存在列表实现，它会监视列表中的所有元素并自动重新索引列表 - 但这些的性能充其量肯定会令人毛骨悚然。）

* * *

## 回答 #2

> 赞同：94
> 
> 时间：2009-01-20T18:36:26.120

答案主要是，它是一个有效的指导方针，但可能不是一个有效的规则。它也没有讲述整个故事。

要指出的是，对于可变类型，您不能将哈希码基于可变数据，因为两个相等的对象必须返回相同的哈希码，并且哈希码必须在对象的生命周期内有效。如果散列码发生变化，您最终会得到一个在散列集合中丢失的对象，因为它不再存在于正确的散列箱中。

例如，对象 A 返回 1 的哈希值。因此，它进入哈希表的 bin 1。然后更改对象 A，使其返回哈希 2。当哈希表查找它时，它在 bin 2 中查找但找不到它 - 该对象在 bin 1 中是孤立的。这就是为什么哈希码必须~~在对象的整个生命周期内都~~不会改变，这只是编写 GetHashCode 实现令人头疼的一个原因。

**更新**
[Eric Lippert 发布了一个博客](http://ericlippert.com/2011/02/28/guidelines-and-rules-for-gethashcode/)，提供了关于`GetHashCode`.

**附加更新**
我在上面做了一些更改：

1.  我区分了准则和规则。
2.  我击穿了“对象的整个生命周期”。

指南只是一个指南，而不是规则。实际上，`GetHashCode`只有当事物期望对象遵循准则时才需要遵循这些准则，例如当它被存储在哈希表中时。如果您从不打算在哈希表中使用您的对象（或任何其他依赖于 的规则`GetHashCode`），您的实现不需要遵循指南。

当您看到“对象的生命周期”时，您应该阅读“对象需要与哈希表合作的时间”或类似内容。像大多数事情一样，`GetHashCode`是关于知道何时打破规则。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-20T18:29:42.903

来自[MSDN](http://msdn.microsoft.com/en-us/library/system.object.gethashcode.aspx)

> 如果两个对象比较相等，则每个对象的 GetHashCode 方法必须返回相同的值。但是，如果两个对象比较不相等，则两个对象的 GetHashCode 方法不必返回不同的值。
> 
> 只要确定对象的 Equals 方法的返回值的对象状态没有修改，对象的 GetHashCode 方法就必须始终返回相同的哈希码。请注意，这仅适用于应用程序的当前执行，并且如果再次运行应用程序，则可以返回不同的哈希码。
> 
> 为了获得最佳性能，散列函数必须为所有输入生成随机分布。

这意味着如果对象的值发生变化，哈希码也应该发生变化。例如，“Name”属性设置为“Tom”的“Person”类应该有一个哈希码，如果将名称更改为“Jerry”，则应该有一个不同的代码。否则，Tom == Jerry，这可能不是您想要的。

* * *

**编辑**：

同样来自 MSDN：

> 覆盖 GetHashCode 的派生类也必须覆盖 Equals 以保证被认为相等的两个对象具有相同的哈希码；否则，Hashtable 类型可能无法正常工作。

从[MSDN 的哈希表条目](http://msdn.microsoft.com/en-us/library/system.collections.hashtable.aspx)：

> 只要在 Hashtable 中用作键，键对象就必须是不可变的。

我读这篇文章的方式是，可变对象*应*在其值更改时返回不同的哈希码，*除非*它们是为在哈希表中使用而设计的。

在 System.Drawing.Point 的示例中，对象是可变的，并且*在*X 或 Y 值更改时返回不同的哈希码。这将使其成为在哈希表中按原样使用的糟糕候选者。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-01-20T18:49:09.153

我认为有关 GetHashcode 的文档有点令人困惑。

一方面，MSDN 声明对象的 hashcode 永远不应该改变，并且是恒定的。另一方面，MSDN 还声明 GetHashcode 的返回值对于 2 个对象应该是相等的，如果这 2 个对象被认为是相等的。

[MSDN：](http://msdn.microsoft.com/en-us/library/system.object.gethashcode.aspx)

> 哈希函数必须具有以下属性：
> 
> *   如果两个对象比较相等，则每个对象的 GetHashCode 方法必须返回相同的值。但是，如果两个对象比较不相等，则两个对象的 GetHashCode 方法不必返回不同的值。
> *   只要确定对象的 Equals 方法的返回值的对象状态没有修改，对象的 GetHashCode 方法就必须始终返回相同的哈希码。请注意，这仅适用于应用程序的当前执行，并且如果再次运行应用程序，则可以返回不同的哈希码。
> *   为了获得最佳性能，散列函数必须为所有输入生成随机分布。

然后，这意味着您的所有对象都应该是不可变的，或者 GetHashcode 方法应该基于您的对象的不可变属性。例如，假设你有这个类（天真的实现）：

```
public class SomeThing
{
      public string Name {get; set;}

      public override GetHashCode()
      {
          return Name.GetHashcode();
      }

      public override Equals(object other)
      {
           SomeThing = other as Something;
           if( other == null ) return false;
           return this.Name == other.Name;
      }
} 
```

这个实现已经违反了 MSDN 中的规则。假设您有 2 个此类的实例；instance1 的 Name 属性设置为“Pol”，instance2 的 Name 属性设置为“Piet”。两个实例都返回不同的哈希码，而且它们也不相等。现在，假设我将 instance2 的名称更改为“Pol”，那么根据我的 Equals 方法，两个实例应该相等，并且根据 MSDN 的规则之一，它们应该返回相同的哈希码。
但是，这是无法做到的，因为 instance2 的哈希码会改变，而 MSDN 声明这是不允许的。

然后，如果您有一个实体，您可以实现哈希码，以便它使用该实体的“主标识符”，这可能是理想的代理键或不可变属性。如果您有一个值对象，您可以实现哈希码，以便它使用该值对象的“属性”。这些属性构成了值对象的“定义”。这当然是价值对象的本质；你对它的身份不感兴趣，而对它的价值感兴趣。
因此，值对象应该是不可变的。（就像它们在 .NET 框架中一样，字符串、日期等......都是不可变的对象）。

想到的另一件事：
在“会话”期间（我真的不知道应该如何称呼它）“GetHashCode”应该返回一个常量值。假设您打开您的应用程序，从数据库（实体）中加载一个对象的实例，并获取其哈希码。它会返回一个特定的数字。关闭应用程序，然后加载相同的实体。这次是否要求哈希码与您第一次加载实体时的值相同？恕我直言，不是。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-01-20T18:37:35.900

这是个好建议。以下是布赖恩·佩平对此事的看法：

> 这不止一次让我绊倒：确保 GetHashCode 在实例的整个生命周期内始终返回相同的值。请记住，在大多数哈希表实现中，哈希码用于标识“桶”。如果对象的“桶”发生变化，哈希表可能无法找到您的对象。这些可能是很难找到的错误，所以在第一时间就做好。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-20T18:35:22.753

不直接回答您的问题，但是 - 如果您使用 Resharper，请不要忘记它具有为您生成合理的 GetHashCode 实现（以及 Equals 方法）的功能。您当然可以指定在计算哈希码时将考虑类的哪些成员。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2010-02-19T10:35:24.133

查看 Marc Brooks 的这篇博文：

[VTO、RTO 和 GetHashCode()——哦，天哪！](http://musingmarc.blogspot.com/2007/08/vtos-rtos-and-gethashcode-oh-my.html)

然后查看后续帖子（由于我是新手，无法链接，但初始文章中有一个链接）进一步讨论并涵盖了初始实施中的一些小弱点。

这是我创建 GetHashCode() 实现所需要知道的一切，他甚至提供了他的方法以及其他一些实用程序的下载，简而言之就是黄金。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-01-20T18:45:04.777

哈希码永远不会改变，但了解哈希码的来源也很重要。

如果您的对象使用值语义，即对象的身份由其值定义（如字符串、颜色、所有结构）。如果您的对象的身份独立于其所有值，则哈希码由其值的子集标识。例如，您的 StackOverflow 条目存储在某个数据库中。如果您更改您的姓名或电子邮件，您的客户条目将保持不变，尽管某些值已更改（最终您通常由一些长的客户 ID # 标识）。

简而言之：

值类型语义 - 哈希码由值定义 参考类型语义 - 哈希码由某个 id 定义

如果这仍然没有意义，我建议您阅读 Eric Evans 的域驱动设计，他在其中探讨了实体与值类型（这或多或少是我在上面尝试做的）。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2011-03-01T13:34:25.643

查看Eric Lippert[的 GetHashCode 指南和规则](http://ericlippert.com/2011/02/28/guidelines-and-rules-for-gethashcode/)

# asp.net-ajax - 其他类似于 ajaxpro 的成名作品？

> ID：462455
> 
> 赞同：0
> 
> 时间：2009-01-20T18:23:15.383
> 
> 标签：asp.net-ajax

只是想知道是否有其他可选的包装框架可以为 web 方法生成客户端代理 js 代码。

我正在开始开发一个新网站，并想在选择一个框架之前评估一些框架。

我看到 AjaxPro 这样做了，想将其与其他一些选项（如果有）进行比较 [http://www.codeplex.com/AjaxPro](http://www.codeplex.com/AjaxPro)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T18:30:04.620

您可能需要考虑[ADO.Net Data Services (Astoria)](http://msdn.microsoft.com/en-us/data/bb931106.aspx)。这不是一个 AJAX 框架，但它可以让您完成很多您想要的事情，并且具有完整的框架支持的好处。

它还使您可以灵活地使用内置的 JavaScript 代理对象，或者您可以使用您自己选择的自定义构建的东西，比如[JQuery](http://jquery.com/)！

AjaxPro 很不错，但它永远不会拥有与上述两种技术中的任何一种相同的支持水平。

# asp.net-mvc - ASP.NET MVC 领域：它们对大型应用程序是否重要？

> ID：462458
> 
> 赞同：30
> 
> 时间：2009-01-20T18:23:38.283
> 
> 标签：asp.net-mvc

我正在开发一个大型 ASP.NET MVC 应用程序。我目前正在研究用于构建控制器/视图的机制。我看到有人提到单轨铁路，它使用“区域”。我已经查看了[Haacked 的](http://haacked.com/archive/2008/11/04/areas-in-aspnetmvc.aspx)文章，它看起来像是一个有趣的选择。我想知道是否有人在生产的 ASP.NET MVC 应用程序中实现了区域，以及他们是否有任何在线资源可以帮助实现这些区域并证明它们的存在。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-01-20T21:59:24.510

我和我的团队目前正在使用 ASP.NET MVC 框架作为底层技术开发一个非常大的应用程序。我们正在使用[区域](http://haacked.com/archive/2008/11/04/areas-in-aspnetmvc.aspx)、[强类型视图名称](http://oddiandeveloper.blogspot.com/2008/11/strongly-typed-view-names.html)和我们自己的[本地化](http://oddiandeveloper.blogspot.com/2008/11/localization-with-aspnet-mvc.html)版本。到目前为止，它的合作非常好。

对我来说，与 ASP.NET MVC 的交易破坏者将是控制器名称必须是唯一的。完全可以预见，需要一个控制器来管理我的应用程序的库存和调度区域内的库存以及对这些区域进行分类太难了。对于区域，这不再是问题。我强烈建议按照 Phil Haack 的概述使用它们。

或者，您可以查看[Steven Sanderson 的实现](http://blog.codeville.net/2008/11/05/app-areas-in-aspnet-mvc-take-2/)，他在其中更进一步，尽管对我们来说这不是我们需要的东西。

很快看到 Areas 在 ASP.NET MVC 中实现，我不会感到惊讶。

祝您的应用程序好运，我认为您不会后悔选择 ASP.NET MVC。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-22T23:10:16.317

在我看来，大型应用程序中区域的支持绝对至关重要。对我来说，微软打算在没有内置支持的情况下发布 ASP.NET MVC 1.0 似乎很奇怪。

幸运的是，MVC 在可扩展性方面弥补了功能上的不足。例如，在 S#arp 架构中，正如 Asaf 简要提到的，我从 Phil Haack ( [http://haacked.com/archive/2008/11/04/areas-in-aspnetmvc.aspx](http://haacked.com/archive/2008/11/04/areas-in-aspnetmvc.aspx) ) 和 Steve Sanderson ( [http ://blog.codeville.net/2008/11/05/app-areas-in-aspnet-mvc-take-2/](http://blog.codeville.net/2008/11/05/app-areas-in-aspnet-mvc-take-2/)）但修改了合并结果以支持视图文件夹下的区域。（我不喜欢有一个单独的“Areas”文件夹来保存您的视图区域。）换句话说，如果您使用相应的控制器 Animals.AardvarksController 创建一个“Animals”区域，您的 Views 文件夹将反映 Views/Animals /土豚。

如果您对使用所有 S#arp 架构不感兴趣，我鼓励您至少检查一下该框架中的区域是如何实现的，以便在您自己的应用程序中使用。相关代码包括：

*   可重用区域支持类： [http ://sharp-architecture.googlecode.com/svn/trunk/src/SharpArch/SharpArch.Web/Areas/](http://sharp-architecture.googlecode.com/svn/trunk/src/SharpArch/SharpArch.Web/Areas/)
*   视图引擎的更换： http: [//sharp-architecture.googlecode.com/svn/trunk/src/NorthwindSample/app/Northwind.Web/Global.asax.cs](http://sharp-architecture.googlecode.com/svn/trunk/src/NorthwindSample/app/Northwind.Web/Global.asax.cs)
*   “区域”的声明（本示例有一个名为“组织”的命名空间/区域）： [http ://sharp-architecture.googlecode.com/svn/trunk/src/NorthwindSample/app/Northwind.Web.Controllers/RouteRegistrar 。CS](http://sharp-architecture.googlecode.com/svn/trunk/src/NorthwindSample/app/Northwind.Web.Controllers/RouteRegistrar.cs)
*   该区域下的视图：http: [//sharp-architecture.googlecode.com/svn/trunk/src/NorthwindSample/app/Northwind.Web/Views/Organization/Employees/](http://sharp-architecture.googlecode.com/svn/trunk/src/NorthwindSample/app/Northwind.Web/Views/Organization/Employees/)

顺便说一下，S#arp 架构包括一个 CRUD 脚手架生成器，它自动考虑嵌套命名空间。正如 Asaf 所提到的，您可以在[http://code.google.com/p/sharp-architecture/找到更多相关信息](http://code.google.com/p/sharp-architecture/)

比利·麦卡弗蒂

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-21T00:57:37.020

取自[S#arp apchitecture 1.0 Beta](http://devlicio.us/blogs/billy_mccafferty/archive/2009/01/19/s-arp-architecture-beta-1-0-now-available.aspx)发行说明：

> 包含作为 Views 文件夹下的子文件夹无缝支持的视图“区域”

# web-services - Web 服务响应中的空字符导致 XML 文档错误

> ID：462467
> 
> 赞同：0
> 
> 时间：2009-01-20T18:24:45.927
> 
> 标签：web-services, soap, xml-serialization, asmx

SQL Server Integration Services 2005 中似乎存在一个错误，在某些情况下，它将零长度字符串转换为单个字符串，其字符恰好是 ansi null，即。ascii 字符零（请注意，这与 sql null 非常不同）。

这发生在我们的一个数据加载过程中，因此应该为空的地址行将这些字符放入其中。

我们通过 Web 服务公开这些数据，并且数据可以序列化。当通过 IE 查看 Web 服务响应时，标准 XSL 甚至会去除空值，但是当您查看源代码时，您可以看到它们：

```
Addr2="&#x0;" 
```

但是，当您从 .Net 生成的代理调用此服务时，您会收到错误消息：

```
"There is an error in XML document" 
```

这可能是因为 null 终止了文档并因此使其无效。

虽然我们可以尽最大努力防止这些值进入数据库，但是当这些值在响应中时，有什么方法可以防止代理代码出错？我们真的不想在我们所有的网络方法中添加代码来检测和删除这些。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-29T12:55:01.517

我有一个类似的问题，虽然它发生在我们自己的网络服务中。为了诊断问题，我调试了生成的 XmlSerializer DLL。您可以通过添加来做到这一点

```
<system.diagnostics>
  <switches>
    <add name="XmlSerialization.Compilation" value="4"/>
  </switches>
</system.diagnostics> 
```

有关详细信息，请参阅[MSDN](http://msdn.microsoft.com/en-us/library/aa302301.aspx)文章。

我们能够在 Web 服务端解决问题。

[在这个位置](http://geekswithblogs.net/gaijin42/archive/2005/10/18/null_value_datetime_c_sharp_web_service_java_interop_hetrogeneous.aspx)可以找到另一种解决方案。

# delphi - Delphi 7 SOAP 应用程序停止编译

> ID：462468
> 
> 赞同：2
> 
> 时间：2009-01-20T18:25:03.787
> 
> 标签：delphi, soap

我不知道为什么，但是一个 SOAP 服务器应用程序和该服务的一对客户端停止编译，而我没有任何已知的原因。我已经安装了delphi 2007和delphi 2009，我不知道原因是否来自于此。

现在，当我编译一个肥皂应用程序时，我收到如下错误：

> Unit XMLSchema 是用不同版本的 XMLDOM.SHttp 编译的

有人知道原因吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T19:30:23.470

删除所有 dcus 并尝试全部构建。如果您同时使用 d2007 和 D2009 进行编译，
请确保为编译后的代码提供不同的文件夹...还要确保您没有 D2007 和 d2009 路径的“混合匹配”来引用使用的单位。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-26T14:30:50.737

最后我发现问题出在哪里。这来自 codebot.org 的免费库，其中包含另一个版本的 xmldom.pas

谢谢和问候

PD 我会尝试退还我的帐户。

# sql - 这个实现是否符合 SQL-92？

> ID：462471
> 
> 赞同：5
> 
> 时间：2009-01-20T18:25:47.530
> 
> 标签：sql, oracle, plsql

[Tony Andrews](https://stackoverflow.com/users/18747/tony-andrews)在另一个[问题](https://stackoverflow.com/questions/461985/better-way-to-structure-a-pl-sql-if-then-statement)中举了一个例子：

```
IF p_c_courtesies_cd 
   || p_c_language_cd 
   || v_c_name 
   || v_c_firstname 
   || v_c_function 
   || p_c_phone 
   || p_c_mobile p_c_fax 
   || v_c_email is not null
THEN
     -- Do something
END IF; 
```

作为 Oracle COALESCE 函数的一个聪明的（如果不是有点晦涩的话）替代方案。果然，它有效，如果任何参数不为空，则 IF 测试为真。我的问题：Oracle 对上述串联操作 SQL-92 的实现是否符合？涉及 NULL 的表达式不应该评估为 NULL 吗？如果您不这么认为，那么表达式 1 + NULL 为什么要计算为 NULL？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-21T11:06:39.337

不，Oracle 对空值的处理是特殊的，与其他所有人的不同，并且与 ANSI 标准不一致。然而，在甲骨文的辩护中，它可能早在 ANSI 标准出现之前就已经确定并致力于这种处理方式！

这一切都始于 Oracle 存储带有字符数的字符串，然后是字符串数据。NULL 由零字符数表示，没有后续字符串数据 - 这与空字符串 ('') 完全相同。Oracle 根本没有办法区分它们。

这会导致一些古怪的行为，例如这种串联情况。Oracle 也有一个函数 LENGTH 来返回字符串的长度，但这是以相反的方式定义的，因此 LENGTH('') 返回 NULL 而不是零。所以：

```
LENGTH('abc') + LENGTH('') IS NULL

LENGTH('abc' || '') = 3 
```

在我看来，这违反了基本的数学原理。

当然，Oracle 开发人员已经习惯了这一点，以至于我们中的许多人甚至看不出它有任何错误或奇怪之处——事实上，有些人会争辩说世界其他地方都是错误的，空字符串和 NULL**是**相同的事物！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T19:15:29.893

@Nezroy：感谢您的链接。然而，当我阅读该标准时，我相信它表明 Oracle 的实现实际上是不正确的。第 6.13 节，一般规则，第 2a 项：

```
 2) If <concatenation> is specified, then let S1 and S2 be the re-
        sult of the <character value expression> and <character factor>,
        respectively.

        Case:

        a) If either S1 or S2 is the null value, then the result of the
          <concatenation> is the null value. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T18:35:06.013

那么 COALESCE 是由 SQL-92 标准明确定义的，用于返回列表中的第一个非 NULL 值；所以根据定义，Oracle 的实现是正确的。

编辑：[SQL-92 规范](http://www.contrib.andrew.cmu.edu/~shadow/sql/sql1992.txt)；搜索 COALESCE 以查看其定义。

也就是说，关于 NULL 没有任何具体的规定，即任何涉及 NULL 的操作都必须为 NULL。更准确的限制是 NULL 既不为假也不为 0 也不等于另一个 NULL（例如 NULL == NULL 为假，因为一个 NULL 不等于另一个 NULL）。然而，这并不意味着仍然不能有逻辑一致的方式来处理不总是返回 NULL 的 NULL。

编辑：所以 NULL + 1 是 NULL，就像 NaN + 1 仍然是 NaN 一样；它实际上是一个未定义的操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T20:06:19.683

基于 DCookie 突出显示的[SQL-92](http://www.contrib.andrew.cmu.edu/~shadow/sql/sql1992.txt)规范部分和其他数据库的行为，我想说 Oracle 的连接运算符的行为不符合标准。

甲骨文（来自 tuinstoel 的回答）：

```
SQL>  select 'something'||null from dual;

'SOMETHIN
---------
something
```

微软SQL：

```
SELECT 'something'+NULL;

NULL
```

PostgreSQL：

```
postgres=# \pset null '(null)'
Null display is "(null)".
postgres=# select 'something'||null as output;
 output
--------
 (null)
(1 row) 
```

MySQL：

```
mysql> select concat('something',NULL) as output;
+--------+
| output |
+--------+
| NULL   |
+--------+
1 row in set (0.00 sec) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-20T18:46:24.167

```
SQL>  select 'something'||null from dual;

'SOMETHIN
---------
something 
```

与 null 的字符串连接不会导致 null。我认为这是正常的行为，我已经习惯了。不知道还能说什么。

# sql - sql主键和索引

> ID：462477
> 
> 赞同：110
> 
> 时间：2009-01-20T18:28:00.210
> 
> 标签：sql, sql-server, tsql, indexing, primary-key

假设我在数据库中有一个 ID 行 (int) 作为主键。如果我经常查询 ID，是否还需要对其进行索引？还是它是主键意味着它已经被索引？

我问的原因是因为在 MS SQL Server 中我可以在这个 ID 上创建一个索引，正如我所说的，这是我的主键。

编辑：一个额外的问题 - 额外索引主键有什么害处吗？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2009-01-20T18:51:54.483

没错，SQL Server 允许您在相同字段上创建重复索引令人困惑。但是您可以创建另一个的事实并不表示 PK 索引也不存在。

额外的索引没有好处，但唯一的危害（非常小）是额外的文件大小和行创建开销。

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2009-01-20T19:01:40.360

正如其他人已经说过的，主键是自动索引的。

仅当您需要优化使用主键和其他一些特定列的查询时，在主键列上创建更多索引才有意义。通过在主键列上创建另一个索引并包含其他一些列，您可能会达到查询所需的优化。

例如，您有一个包含许多列的表，但您只查询 ID、名称和地址列。以 ID 作为主键，我们可以创建以下索引，该索引建立在 ID 之上，但包含 Name 和 Address 列。

```
CREATE NONCLUSTERED INDEX MyIndex
ON MyTable(ID)
INCLUDE (Name, Address) 
```

因此，当您使用此查询时：

```
SELECT ID, Name, Address FROM MyTable WHERE ID > 1000 
```

SQL Server 将仅使用您创建的索引为您提供结果，它不会从实际表中读取任何内容。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2009-01-20T20:07:55.733

***注意：这个答案解决了大型**企业级开发。*

这是一个 RDBMS 问题，而不仅仅是 SQL Server，其行为可能非常有趣。一方面，虽然主键自动（唯一）索引很常见，但它不是绝对的。 **有时必须不唯一索引主键。**

*在大多数 RDBMS 中，如果主键不存在*，则会自动在主键上创建唯一索引。因此，您可以在将主键列声明为主键之前在主键列上创建自己的索引，然后当您应用主键声明时，数据库引擎将使用该索引（如果可接受）。通常，您可以创建主键并允许创建其默认唯一索引，然后在该列上创建自己的备用索引，然后删除默认索引。

现在是有趣的部分——你什么时候不想要一个唯一的主键索引？当您的表获取足够的数据（行）以使索引的维护过于昂贵时，您不想要也不能容忍一个。这取决于硬件、RDBMS 引擎、表和数据库的特性以及系统负载。但是，它通常会在表格达到几百万行时开始显现。

本质问题是每次插入行或更新主键列都会导致索引扫描以确保唯一性。随着表的增长，唯一索引扫描（或其在任何 RDBMS 中的等效项）变得更加昂贵，直到它主导表的性能。

我已经多次处理过这个问题，表有 20 亿行，8 TB 的存储空间，每天有 4000 万行插入。我的任务是重新设计所涉及的系统，其中包括实际上作为第一步删除唯一主键索引。事实上，在我们甚至接近重新设计之前，为了从中断中恢复，在生产中删除该索引是必要的。重新设计包括寻找其他方法来确保主键的唯一性并提供对数据的快速访问。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2009-01-20T18:29:54.963

默认情况下，主键总是被索引。

> 您可以使用 SQL Server Management Studio 或 Transact-SQL 在 SQL Server 2012 中定义主键。创建主键会自动创建相应的唯一、聚集或非聚集索引。

[http://technet.microsoft.com/en-us/library/ms189039.aspx](http://technet.microsoft.com/en-us/library/ms189039.aspx)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-01-20T18:34:29.260

[这里来自MSDN](http://msdn.microsoft.com/en-us/library/ms191236.aspx "MSDN")的段落：

> 为表指定 PRIMARY KEY 约束时，数据库引擎通过为主键列创建唯一索引来强制数据唯一性。此索引还允许在查询中使用主键时快速访问数据。因此，选择的主键必须遵循创建唯一索引的规则。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-01-20T18:30:30.920

除非您指定非聚集索引，否则 PK 将成为聚集索引

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2018-11-29T19:22:39.063

声明`PRIMARY KEY`or`UNIQUE`约束会导致 SQL Server 自动创建索引。

可以在不匹配约束的情况下创建唯一索引，但如果没有唯一索引，则不能存在约束（主键或唯一）。

从这里开始，约束的创建将：

*   导致创建同名索引
*   拒绝删除创建的索引，因为没有它就不允许存在约束

同时删除约束将删除关联的索引。

`PRIMARY KEY`那么， a或之间是否存在实际区别`UNIQUE INDEX`：

*   `NULL`值不允许在 中`PRIMARY KEY`，但允许在`UNIQUE`索引中；和集合运算符（UNION、EXCEPT、INTERSECT）一样，`NULL = NULL`这意味着您只能有一个值，因为两个`NULL`s 彼此重复；
*   `PRIMARY KEY`每个表只能存在一个，而可以创建[999个唯一索引](https://docs.microsoft.com/en-us/sql/sql-server/maximum-capacity-specifications-for-sql-server?view=sql-server-2017)
*   创建约束时`PRIMARY KEY`，除非表上已经存在聚集索引或`NONCLUSTERED`在其定义中使用，否则将其创建为聚集索引；创建索引时`UNIQUE`，它被创建为`NONCLUSTERED`除非它不是特定的`CLUSTERED`并且这样的已经不存在；

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-20T18:30:33.887

使其成为主键也应该自动为其创建索引。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-09-19T23:42:06.670

在 SQL Server 中，一般来说，主键是自动索引的。这是真的，但它不能保证更快的查询。当只有 1 个字段作为主键时，主键将为您提供出色的性能。但是，当有多个字段作为主键时，索引是基于这些字段的。

例如：字段 A、B、C 是主键，因此当您根据 WHERE CLAUSE 中的这 3 个字段进行查询时，性能很好，但是当您想在 WHERE CLAUSE 中仅使用 C 字段进行查询时，您不会有好的表现。因此，为了让您的性能启动并运行，您需要手动索引 C 字段。

大多数情况下，在您达到超过 100 万条记录之前，您不会看到问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-20T18:29:45.090

主键被自动索引

您可以根据您的使用情况使用 pk 创建其他索引

*   如果您经常按 zip_code 和 id 选择 index zip_code, id 可能会有所帮助

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-20T18:30:11.467

我有一个没有（单独）索引的庞大数据库。

每当我通过主键查询时，出于所有密集目的，结果都是即时的。

# python - 我可以使用 Numpy 获得矩阵行列式吗？

> ID：462500
> 
> 赞同：47
> 
> 时间：2009-01-20T18:32:16.067
> 
> 标签：python, arrays, numpy

我在 Numpy 的手册中读到有`det(M)`可以计算行列式的函数。`det()`但是，我在 Numpy 中找不到该方法。

顺便说一句，我使用 Python 2.5。Numpy 应该没有兼容性问题。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-01-20T18:35:26.310

您可以[`numpy.linalg.det`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.linalg.det.html)用来计算数组的行列式：

```
In [1]: import numpy

In [2]: M = [[1, 2], [3, 4]]

In [3]: print numpy.linalg.det(M)
Out[3]: -2.0000000000000004 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2013-10-11T11:37:57.350

对于**大型数组**，使用 时可能会发生下溢/溢出`numpy.linalg.det`，或者您可能会得到`inf`或`-inf`作为答案。

在许多这些情况下，您可以使用`numpy.linalg.slogdet`（[请参阅文档](http://docs.scipy.org/doc/numpy/reference/generated/numpy.linalg.slogdet.html)）：

```
sign, logdet = np.linalg.slogdet(M) 
```

其中`sign`是行列式的符号和`logdet`对数。您可以简单地通过以下方式计算行列式：

```
det = np.exp(logdet) 
```

对于稀疏矩阵（二维数组），我强烈推荐[另一种基于 LU 分解的方法](https://stackoverflow.com/a/60982033/832621)。

# java - RuntimeException 以外的异常

> ID：462501
> 
> 赞同：2
> 
> 时间：2009-01-20T18:32:45.363
> 
> 标签：java, exception

除了 Java 中的 RuntimeException 之外，是否还有可能发生异常？谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-20T19:31:39.240

是的，有**三种**。

## **已检查的异常**

由于环境中最有可能出现故障，编译器会通知您何时可以抛出它们。

他们应该被抓住，如果程序可以用它做点什么，否则最好放他们走。

他们中的大多数继承自

```
java.lang.Exception 
```

或从

```
java.lang.Throwable 
```

虽然从前者继承更好。

例如：

```
java.io.IOException 
```

*表示发生了某种 I/O 异常。此类是由失败或中断的 I/O 操作产生的一般异常类。*

## **错误**

这些是特殊类型的例外。他们**不应该被抓住**，因为当它们发生时意味着刚刚发生了非常糟糕的事情。

他们都继承自

```
java.lang.Error 
```

例如：

```
java.lang.OutOfMemoryError 
```

*当 Java 虚拟机因为内存不足而无法分配对象时抛出，并且垃圾收集器无法提供更多内存。*

或者

```
java.lang.StackOverflowError 
```

*当由于应用程序递归太深而发生堆栈溢出时引发。*

## 运行时异常

用于识别程序员故障，而不是资源故障。

编码时可以“通常”避免运行时异常。如果你有一个很可能你做错了什么。

有时会捕获运行时异常，但是，除非您确切知道自己在做什么以及**为什么**，否则捕获它们是一种不好的做法（同样，除非这正是您所需要的）

他们继承自

```
java.lang.RuntimeException 
```

例如

```
java.lang.ArrayIndexOutOfBoundsException 
```

*抛出以指示已使用非法索引访问数组。索引为负数或大于或等于数组的大小*

或者

```
java.lang.NullPointerException 
```

*当应用程序在需要对象的情况下尝试使用 null 时抛出*

关于最后两个，**大多数**情况下，它们可以通过仔细编程来避免，并了解程序的状态是什么（这个数组有 5 个元素吗？我为什么要尝试访问 -1 或 6th。这个引用是否为空？为什么我要调用 null.toString() )

尽管我曾与声称应该抓住所有 NPE 的人争论过。好吧，我能说什么。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-20T18:33:20.387

java.lang 包定义了以下不是运行时异常的标准异常类：

*   **[ClassNotFoundException](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/ClassNotFoundException.html)**：抛出该异常表示找不到要加载的类。

*   **[CloneNotSupportedException](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/CloneNotSupportedException.html)**：当为未实现 Cloneable 接口并因此无法克隆的对象调用 clone() 方法时，将引发此异常。

*   **[Exception](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Exception.html)**：抛出此异常的适当子类以响应在虚拟机级别检测到的错误。如果一个程序定义了自己的异常类，它们应该是 Exception 类的子类。

*   **[IllegalAccessException](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/IllegalAccessException.html)**：当程序试图动态加载一个类（即使用Class类的forName()方法，或者ClassLoader类的findSystemClass()或loadClass()方法）和当前正在执行的方法时抛出这个异常无权访问指定的类，因为它在另一个包中并且不是公共的。当程序试图创建一个类的实例（即，使用 Class 类的 newInstance() 方法）时，也会引发此异常，而该类的实例没有可供调用者访问的零参数构造函数。

*   **[InstantiationException](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/InstantiationException.html)**：此异常是为了响应尝试使用 Class 类的 newInstance() 方法实例化抽象类或接口而引发的。

*   **[InterruptedException](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/InterruptedException.html)**：抛出此异常表示正在休眠、等待或以其他方式暂停的线程已被另一个线程中断。

*   **[NoSuchFieldException](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/NoSuchFieldException.html)**：当找不到指定的变量时抛出此异常。此异常是 Java 1.1 中的新异常。

*   **[NoSuchMethodException](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/NoSuchMethodException.html)**：当找不到指定的方法时抛出此异常。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-20T19:05:22.520

基本上在 java（与 .NET 相对）中，您有两种类型的异常：

*   Checked Exception：所有继承自异常的类。客户端代码必须通过 try-catch 或 throws 子句处理这种异常（在编译器中强制执行）。
*   未经检查的异常：从 RuntimeException 继承的所有类。客户端代码不必处理此类异常。

我可以推荐以下[O'Reilly On Java](http://www.onjava.com/pub/a/onjava/2003/11/19/exceptions.html) Exception 文章。

# c# - 现成的现场搜索 asp.net 网站

> ID：462528
> 
> 赞同：0
> 
> 时间：2009-01-20T18:37:39.283
> 
> 标签：c#, asp.net, search, e-commerce, search-engine

我开发了一个结合电子商务网站的商业索引。（在asp.net2.0+c#中）

我正在寻找一个已经处理索引、速度和质量等问题的站内搜索引擎。

有没有这样做的著名解决方案？

我需要在我的设计中自定义搜索结果，因此不能选择谷歌搜索引擎。

谢谢， 伊坦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T18:55:27.253

我自己没有使用过它，但我已经阅读了关于[Lucene.net](http://incubator.apache.org/lucene.net/)的关于 Java的[Lucene](http://lucene.apache.org/java/docs/)端口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T21:30:55.393

你看过 DTSearch 吗？它相对便宜且功能齐全。不是很好，但应该足够了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T18:52:17.587

您需要更多详细信息，例如您的搜索方式。在您的数据库中搜索产品描述将与搜索显示这些产品的网页非常不同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-06T16:49:54.723

尝试使用 Microsoft[全文搜索](http://technet.microsoft.com/en-us/library/cc723263.aspx)

# sql-server - VFP 唯一标识符是否与 Guid 相同？

> ID：462531
> 
> 赞同：1
> 
> 时间：2009-01-20T18:38:11.123
> 
> 标签：sql-server, guid, foxpro, visual-foxpro

我正在将 foxpro 数据库转换为 SQL Server，其中一些键是 VFP 生成的唯一标识符 - 我假设是 GUID。这些是有效的唯一标识符吗？

我可以只使用字节并将它们轻松转换为 SQL Server 中的唯一标识符吗？

谢谢，

克雷格

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T18:41:32.257

是的，它是一样的

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-01-26T21:34:37.837

VFP 的唯一标识符只是整数，而不是 GUID。默认情况下，它们从 1 开始并按 1 递增。

# asp.net - ASP.NET中如何实现动态页面文件名？

> ID：462532
> 
> 赞同：1
> 
> 时间：2009-01-20T18:38:22.950
> 
> 标签：asp.net, dynamic, filenames

我希望我的网站为动态内容创建搜索引擎优化的链接（而不是通过查询字符串定位数据）。所以：

```
mysite/SomeModifiableNname.aspx
```

代替

```
mysite/DynamicContent.aspx?entryID=2345
```

.

除了重定向请求的智能 404 处理程序或 IIS 中的自定义 mime 类型处理程序之外，在 ASP.NET 中是否有一个很好的解决方案？
*请记住，页面文件名必须能够在运行时更改。*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T18:40:25.050

您可以使用**HttpHandler**，如此[处所示](http://codebetter.com/blogs/jeffrey.palermo/archive/2005/08/10/130532.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T18:41:39.650

这是一个广泛的主题，通常称为 URL 重写......

有几种方法可以做到这一点。我建议查看 IIS 重写模块。

您可能还应该调查为 MVC 开发并在 ASP.NET 3.51 中可用的 URL 路由功能

更新：我希望我能更多地了解你的意图。最后一句话让我很困惑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T19:19:35.813

我过去用 UrlRewrite.Net 做过这个。在 IIS7 中也有一个内置的工具

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-21T13:45:27.017

感谢大家的想法。根据提供的信息，我发现了我认为需要的解决方案：

在 Global.asax（或通过 HttpModule）中，监听 BeginRequest 事件并在那里应用 Context.Rewrite 路径：

```
void Application_BeginRequest(object sender, EventArgs e)
{
    string fullOrigionalpath = Request.Url.ToString();

    if (fullOrigionalpath.ToLower().Contains("/Games".ToLower()))
    {
        Context.RewritePath("Default.aspx?id=Games");
    }

} 
```

然后，在将处理这些请求的页面的 OnPreInit 方法上，需要再次应用重写路径，以便 PostBacks 能够正常工作：

```
protected override void OnPreInit(EventArgs e)
{
    base.OnPreInit(e);

    if (Request.QueryString["id"] == null)
        return;
    if (Request.QueryString["id"].ToLower().Equals("games"))
        Context.RewritePath("Games", "", "id=Games");
} 
```

使这项工作比我遇到的许多 URL 重写模块更好的关键是路径可以是动态的。也就是说，创建的 URL 可以是数据驱动的。

# java - 如何检查 CachedRowSet 中是否存在列名？

> ID：462534
> 
> 赞同：10
> 
> 时间：2009-01-20T18:39:55.427
> 
> 标签：java, jdbc, metadata, cachedrowset

我正在从可能发生变化的视图中查询数据。在执行`crs.get******()`.

我发现我可以像这样查询*元数据*以查看列是否存在，然后再从它请求数据：

```
ResultSetMetaData meta = crs.getMetaData();
int numCol = meta.getColumnCount();

for (int i = 1; i < numCol + 1; i++) 
    if (meta.getColumnName(i).equals("name"))
        return true; 
```

有没有更简单的方法来检查列是否存在？

* * *

### 编辑

它必须与数据库无关。这就是为什么我引用`CachedRowSet`而不是数据库。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-20T18:50:00.057

通用 JDBC API 没有更简单的方法（至少我不知道，或者找不到......我在自己开发的工具集中有完全相同的代码。）

您的代码不完整：

```
ResultSetMetaData meta = crs.getMetaData();
int numCol = meta.getColumnCount();

for (int i = 1; i < numCol + 1; i++) {
    if (meta.getColumnName(i).equals("name")) {
        return true;
    }
}

return false; 
```

话虽如此，如果您使用专有的、特定于数据库的 API 和/或 SQL 查询，我相信您可以找到更优雅的方式来做同样的事情。但是您必须为需要处理的每个数据库编写自定义代码。如果我是你，我会坚持使用 JDBC API。

您提出的解决方案有什么地方让您认为它不正确吗？这对我来说似乎很简单。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-01-26T22:54:31.723

如果列不在 CachedRowSet 中，您可以采用更短的方法，即 findColumn() 将为 InvalidColumName 抛出 SQLException。

例如

```
 try {
     int foundColIndex = results.findColumn("nameOfColumn");
} catch {
  // do whatever else makes sense
} 
```

可能是对异常处理的滥用（根据 EffectiveJava 第 2 版第 57 条），但它是循环遍历元数据中所有列的替代方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T18:46:42.200

哪个数据库？

我认为在 Oracle 中有列出列的表。

我不记得它是否也适用于视图，但我想它们确实有效，类似于：

```
select colum_name from all_views where view_name like 'myview' 
```

或者

```
select name from all_objects where object_name like 'myview' and object_type='view' 
```

我不记得确切的语法。不过，您应该具有空间权限。

每个 RDBMS 都应该有类似的东西。

您还可以执行查询

```
select * from myView where 1 = 0 ; 
```

并从元数据中获取列，如果您希望它避免在知道列是否存在之前获取数据。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T18:53:27.757

不，真的没有更好的办法。你可能想重新审视这个问题。如果您可以重新定义问题，有时它会使解决方案变得更简单，因为问题已经发生了变化。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-08T18:34:40.987

警告：以下评论纯粹来自记忆，没有任何支持性文书工作:)

如果我没记错的话，当 oracle 缓存行集实现与连接池一起使用时，有一个神秘的问题会引起它的丑陋。似乎有对缓存行集对象中保存的连接的静默引用（即使它应该断开连接），它关闭了随后在垃圾收集池中打开的另一个连接。出于这个原因，我最终放弃并编写了自己的数据对象层（这些天我将其交给 spring & hibernate）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-06-07T12:00:11.260

旧线程，但我刚刚遇到了同样的问题并最终得到了一个实用函数：

```
private Set<String> getColumnNames(ResultSet cached) throws SQLException {
    ResultSetMetaData metaData = cached.getMetaData();
    return IntStream.range(1, metaData.getColumnCount())
                    .mapToObj(i -> {
                        try {
                            return metaData.getColumnName(i);
                        } catch (SQLException e) {
                            throw new RuntimeException(e);
                        }
                    }).collect(toSet());
} 
```

如果我们不必在 lambda 中捕获异常（没有一些丑陋的 hack），那将是非常优雅的

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-09-25T12:25:34.130

继 Jared 的这个帖子中的最佳答案，以及 corsiKa 的一个被低估的评论：

```
ResultSetMetaData meta = crs.getMetaData();
int numCol = meta.getColumnCount();
Set<String> columns = new HashSet<>;

for (int i = 1; i <= numCol; i++) 
{
    columns.add(meta.getColumnName(i));    
}

return columns.contains("name"); 
```

# javascript - 覆盖 !important 风格

> ID：462537
> 
> 赞同：186
> 
> 时间：2009-01-20T18:41:16.813
> 
> 标签：javascript, css

标题几乎概括了它。

外部样式表有以下代码：

```
td.EvenRow a {
  display: none !important;
} 
```

我试过使用：

```
element.style.display = "inline"; 
```

和

```
element.style.display = "inline !important"; 
```

但两者都不起作用。是否可以使用 javascript 覆盖 !important 样式。

这是为了一个greasemonkey 扩展，如果这有所作为的话。

* * *

## 回答 #1

> 赞同：358
> 
> 时间：2009-10-16T10:00:57.013

您可以使用几个简单的单行代码来执行此操作。

1.  在元素上设置“样式”*属性：*

    element.setAttribute('style', 'display:inline !important');

或者...

2.  修改对象的`cssText`属性`style`：

    element.style.cssText = 'display:inline !important';

要么完成这项工作。

===

我编写了一个名为“important”的 jQuery 插件来操作`!important`元素中的规则：http: [//github.com/premasagar/important](http://github.com/premasagar/important)

===

编辑：正如评论中所分享的，标准 CSSOM 接口（JavaScript 与 CSS 交互的 API）提供了[`setProperty`](https://developer.mozilla.org/en-US/docs/Web/API/CSSStyleDeclaration/setProperty)方法：

```
element.style.setProperty(propertyName, value, priority); 
```

例如：

```
document.body.style.setProperty('background-color', 'red', 'important'); 
```

* * *

## 回答 #2

> 赞同：262
> 
> 时间：2009-01-20T21:12:07.460

`element.style`有一个`setProperty`可以将优先级作为第三个参数的方法：

```
element.style.setProperty("display", "inline", "important") 
```

它[在旧 IE 中不起作用，](http://www.quirksmode.org/dom/w3c_css.html#t46)但在当前浏览器中应该没问题。

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2009-01-20T18:59:09.600

我相信这样做的唯一方法是将样式添加为带有“！important”后缀的新CSS声明。最简单的方法是在文档头部添加一个新的 <style> 元素：

```
function addNewStyle(newStyle) {
    var styleElement = document.getElementById('styles_js');
    if (!styleElement) {
        styleElement = document.createElement('style');
        styleElement.type = 'text/css';
        styleElement.id = 'styles_js';
        document.getElementsByTagName('head')[0].appendChild(styleElement);
    }
    styleElement.appendChild(document.createTextNode(newStyle));
}

addNewStyle('td.EvenRow a {display:inline !important;}') 
```

使用上述方法添加的规则将（如果您使用 !important 后缀）覆盖其他先前设置的样式。如果您不使用后缀，请确保将“[特异性](http://www.w3.org/TR/CSS2/cascade.html#specificity)”等概念考虑在内。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-10-04T00:50:21.850

以@Premasagar 的出色回答为基础；如果您不想删除所有其他内联样式，请使用此

```
//accepts the hyphenated versions (i.e. not 'cssFloat')
addStyle(element, property, value, important) {
    //remove previously defined property
    if (element.style.setProperty)
        element.style.setProperty(property, '');
    else
        element.style.setAttribute(property, '');

    //insert the new style with all the old rules
    element.setAttribute('style', element.style.cssText +
        property + ':' + value + ((important) ? ' !important' : '') + ';');
} 
```

[无法使用`removeProperty()`，因为它不会删除`!important`Chrome 中的规则。
不能使用`element.style[property] = ''`，因为它只接受 FireFox 中的 camelCase。]

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-12-21T14:06:58.497

如果要在 DOM Element 样式属性中更新/添加单个样式，可以使用此功能：

```
function setCssTextStyle(el, style, value) {
  var result = el.style.cssText.match(new RegExp("(?:[;\\s]|^)(" +
      style.replace("-", "\\-") + "\\s*:(.*?)(;|$))")),
    idx;
  if (result) {
    idx = result.index + result[0].indexOf(result[1]);
    el.style.cssText = el.style.cssText.substring(0, idx) +
      style + ": " + value + ";" +
      el.style.cssText.substring(idx + result[1].length);
  } else {
    el.style.cssText += " " + style + ": " + value + ";";
  }
} 
```

[**所有主流浏览器都支持**](http://www.quirksmode.org/dom/w3c_css.html#t30)[style.cssText](http://www.quirksmode.org/dom/w3c_css.html#t30)。

用例示例：

```
var elem = document.getElementById("elementId");
setCssTextStyle(elem, "margin-top", "10px !important"); 
```

[这是演示的链接](https://jsfiddle.net/mark087/dtevfn7c/61/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-20T11:43:50.330

如果您所做的只是将 css 添加到页面，那么我建议您使用 Stylish 插件，并编写用户样式而不是用户脚本，因为用户样式更有效和更合适。

[有关如何创建用户样式的信息，](http://userstyles.org/help/coding)请参阅此页面

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-11-20T16:39:13.600

[https://developer.mozilla.org/en-US/docs/Web/CSS/initial](https://developer.mozilla.org/en-US/docs/Web/CSS/initial)

在 css3 中使用初始属性

```
 <p style="color:red!important"> 
    this text is red 
       <em style="color:initial"> 
          this text is in the initial color (e.g. black)
       </em>
    this is red again
 </p> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-08-26T00:46:28.377

[https://jsfiddle.net/xk6Ut/256/](https://jsfiddle.net/xk6Ut/256/)

在 JavaScript 中覆盖 CSS 类的一种选择是使用样式元素的 ID，以便我们可以更新 CSS 类

```
function writeStyles(styleName, cssText) {
    var styleElement = document.getElementById(styleName);
    if (styleElement) document.getElementsByTagName('head')[0].removeChild(
        styleElement);
    styleElement = document.createElement('style');
    styleElement.type = 'text/css';
    styleElement.id = styleName;
    styleElement.innerHTML = cssText;
    document.getElementsByTagName('head')[0].appendChild(styleElement);
} 
```

..

```
 var cssText = '.testDIV{ height:' + height + 'px !important; }';
    writeStyles('styles_js', cssText) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-05-22T11:36:53.683

如果您通过 java 脚本注入一个类（例如：'show'），而不是注入样式，它将起作用。但是在这里你需要像下面这样的css。添加的类 css 规则应低于您的原始规则。

```
td.EvenRow a{
  display: none !important;
}

td.EvenRow a.show{
  display: block !important;
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-03-04T12:43:15.457

我们还有另一种可能从 CSS 中删除属性值。

就像在js中使用replace方法一样。但是您必须确切地知道样式的 ID，或者您可以编写一个 for 循环来检测它（计算页面上的样式，然后检查是否有任何“包含”或“匹配”`!important`值。&你可以计算还有 - 有多少包含它们，或者只是简单地编写一个全局 [regexp: /str/gi] 替换方法）

我的很简单，但是我附上一个jsBin，例如：

[https://jsbin.com/geqodeg/edit?html,css,js,输出](https://jsbin.com/geqodeg/edit?html,css,js,output)

First I set the body background in CSS for yellow `!important`, then I overrided by JS for darkPink.

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2013-09-29T14:59:06.037

下面是使用 jquery 设置样式属性的重要参数的代码片段。

```
$.fn.setFixedStyle = function(styles){
    var s = $(this).attr("style");
    s = "{"+s.replace(/;/g,",").replace(/'|"/g,"");
    s = s.substring(0,s.length-1)+"}";
    s = s.replace(/,/g,"\",\"").replace(/{/g,"{\"").replace(/}/g,"\"}").replace(/:/g,"\":\"");
    var stOb = JSON.parse(s),st;
    if(!styles){
     $.each(stOb,function(k,v){
      stOb[k] +=" !important";
     });
    }
    else{
     $.each(styles,function(k,v){
      if(v.length>0){
        stOb[k] = v+" !important";
      }else{
        stOb[k] += " !important";  
      }
     });
    }
    var ns = JSON.stringify(stOb);
    $(this).attr("style",ns.replace(/"|{|}/g,"").replace(/,/g,";"));
}; 
```

用法非常简单。只需传递一个包含您要设置为重要属性的所有属性的对象。

```
$("#i1").setFixedStyle({"width":"50px","height":""}); 
```

还有两个附加选项。

1.只需将重要参数添加到已经存在的样式属性传递空字符串。

2.为所有存在的属性添加重要参数，不要传递任何东西。它将所有属性设置为重要。

这是它的现场直播。[http://codepen.io/agaase/pen/nkvjr](http://codepen.io/agaase/pen/nkvjr)

# intel - 超线程会导致系统不稳定吗？

> ID：462549
> 
> 赞同：6
> 
> 时间：2009-01-20T18:44:27.070
> 
> 标签：intel, hyperthreading

我正在使用新的 Intel I7 四核处理器构建 PC。打开超线程后，它会在任务管理器中报告 8 个内核。

我的一些同事说超线程会使系统不可靠并建议将其关闭。

你们中的任何一个好人都可以启发我和其余的 stockoverflow 用户。

> 继续：我一直在使用超线程，并且一直在使用。一点不稳定都没有。我正在使用：

*   微软服务器 2008 64 位
*   微软 SQL Server 2008 64 位
*   微软视觉工作室 2008
*   管理员服务器
*   很多控件（Telerik、Dundas、Rebex、Resharper）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-20T18:50:34.797

稳定性不太可能受到影响，因为抽象级别非常低，操作系统只是将其视为另一个 CPU 来提供工作。但是，性能是另一回事。

老实说，我不能说这种情况是否仍然存在，但至少在启用 HT 的 CPU 首次问世时，至少在某些应用程序中存在已知问题。例如，众所周知，启用 HT 后，MySQL 和多线程应用程序（如我在日常工作中支持的 Java 应用程序）会降低性能。我们始终建议将其删除，至少对于我们的服务器端企业应用程序的特定用例而言。

这可能不再是问题，并且在桌面环境中，对于大多数用例而言，这不太可能成为问题。当 CPU 被大量使用时，在 CPU 上拆分工作的能力通常会导致应用程序响应速度更快。但是，当应用程序已经具有大量线程和 CPU 密集型（例如在数据库服务器的情况下）时，上下文切换和开销可能会成为一种阻碍。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-20T19:00:52.343

在我的脑海中，我能想到你的同事可能会这样说的几个原因。

*   几篇关于超线程下 SQL 性能受损的文章。我相信它最终会做太多的上下文切换或缓存抖动。记不清了。

*   早期从单进程到多进程或更可能对大多数人来说超线程进程，带来了许多线程问题。他们以前从未见过的竞争条件、死锁等。尽管它是一个代码问题，但有些人指责了过程。

他们是否对多核/多进程或只是关于超线程提出相同的要求？

至于我，我已经在超线程机器上开发 4 年了，唯一的问题是我自己造成的 UI 死锁问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-20T19:01:19.097

当将线程分派到同一个 CPU 而不是不同的 CPU 时，超线程主要会影响调度程序的行为/性能......

它将显示在一个编码错误的应用程序中，该应用程序不处理线程之间的竞争条件......

所以通常是糟糕的设计/代码....突然发现故障模式条件

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-20T18:48:02.353

不可靠？我怀疑是这样。我能想到的超线程的唯一缺点是，**如果操作系统不知道它**，它可能会在其他物理处理器空闲时在一个物理处理器上调度两个线程，这会降低性能。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-20T18:51:52.313

SQL server 和某些查询的超线程存在问题，因为 SQL server 有自己的调度程序，maxdop 1 可以解决这个问题

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-20T18:55:14.460

无论 Windows 在何种程度上不稳定，超线程都不太可能做出重大贡献（或者现在它会成为大新闻。）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-20T18:47:01.060

我已经拥有一台超线程 PC 已有几年了。没有那么多核心，但对我来说效果很好。

希望我有测试数据来证明你的同事是错的，但听起来这只是我与他们的观点。;)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-20T18:53:23.310

超线程 CPU 中的线程共享相同的缓存，因此不会遇到多 CPU 架构可能会遇到的缓存一致性问题。但是，如果一个软件的开发人员正在考虑使用多个 cpu 进行编程，那么他们将（或应该）使用读取语义（iirc，这就是术语）进行编写。即，所有写入都立即从缓存中刷新。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-20T19:04:48.717

据我所知，从操作系统的角度来看，它认为超线程与拥有实际的多核没有任何不同。从操作系统的角度来看，没有区别 - 它是孤立的。

所以，除了超线程的“额外核心”不是“真实的”（严格的技术意义上）并且没有“真实”CPU核心的全部性能之外，我看不出它会是更不可靠。在某些罕见的情况下，速度可能会更慢，但可靠性并不低。

当然，这取决于你正在运行什么——我想一些应用程序可能会因为 CPU 而“宕机和变脏”，而超线程可能会让它们感到困惑，但这可能很少见。

我本人已经使用超线程运行 PC 好几年了，我没有发现稳定性问题。

抱歉，我没有更具体的数据！

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-20T19:09:40.937

我有一个i7系统，我没有任何问题。

如果它适用于多个内核，则它适用于超线程。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-20T18:51:47.633

简短的回答：是的。

与几乎所有问题一样，长答案是“视情况而定”。取决于操作系统、软件、CPU 版本等。我个人必须两次禁用超线程才能使软件正常工作（一次，使用 Synergy 应用程序，两次，使用 Windows NT 4.0 安装程序），但是您的里程可能会有所不同。

只要您安装的 Windows 从一开始就检测到多个 HT 内核（它会加载一些相关的驱动程序等），您始终可以“事后”禁用（并重新启用）HT。如果您无法解决特定软件的奇怪稳定性问题，禁用 HT 以查看它是否有任何影响并不难。

我不会一开始就禁用它，因为坦率地说，它可能在您日常使用的 99.99% 中都能正常工作。但是请注意，是的，它偶尔会导致奇怪的行为，所以如果您碰巧在解决非常奇怪的问题时，请不要排除它。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-20T19:16:04.090

就个人而言，我发现超线程虽然不会造成任何问题，但实际上也没有太大帮助。这可能就像拥有一个额外的 .1 处理器。在我工作的 HT 机器上，我很少看到我的 CPU 超过 50%。我不知道 HT 在 i7 等较新的处理器上是否会变得更好，但我并不乐观。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-20T19:23:36.447

除了听到一些关于 SQL Server 的报告外，我所能报告的都是正面的。在启用 HT 的重型多线程应用程序上，我的性能提高了大约 25%。从来没有遇到过问题，我使用的是第一代 HT 处理器......

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-11T16:19:51.053

晚会迟到，但供将来参考；

我目前在使用 SQLServer 时遇到了这个问题。基本上，我的理解是同一处理器上的超线程共享相同的 L1 和 L2 缓存，这可能会导致两者之间出现问题。从我正在阅读的内容来看，思杰似乎也有这个问题。

Slava Ok 写了一篇[很好的博客文章](http://blogs.msdn.com/slavao/archive/2005/11/12/492119.aspx)。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-12-23T10:25:55.453

我在这里*很*迟到了，但通过谷歌找到了这个页面。我可能发现了一个非常微妙的问题。我有一个运行 2003 Server 的 i7 950，它很棒。最初我在 BIOS 中保留了超线程，但在一些测试和努力推动的过程中，我运行了一个 Carrette 名为“crashme”的程序。该程序试图通过生成一个进程并为其提供垃圾来尝试运行来使操作系统崩溃。我的双 Opteron 设置永远运行它没有问题，但 950 在一个小时内崩溃了。除非我做了一些愚蠢的事情，否则它不会因为其他任何事情而崩溃，所以这非常令人惊讶。一时兴起，我关闭了 HT 并再次运行该程序。它整夜运行，甚至它的多个实例。一个轶事并不意味着什么，但尝试一下，看看会发生什么。此外，如果关闭 HT，处理器在任何给定负载下似乎都会稍微凉一些。YMMV。

# groovy - 在 Groovy 中使用 findAll 集合闭包

> ID：462561
> 
> 赞同：1
> 
> 时间：2009-01-20T18:47:42.633
> 
> 标签：groovy, iteration

我有一个需要使用 findAll 闭包的“Set”。Set 包含对象，而不仅仅是原始值。例如...我有一组员工对象，我需要通过员工的属性迭代和抓取该员工对象集的元素。

由于某种原因， findAll 闭包似乎只是忽略了我的关闭并返回一个空集。

这是我的语法；

```
dstCollection = srcCollection.findAll{
    it.age == 22
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T20:19:17.910

以下对我有用：

```
class Employee {
    int age

    String toString() {
        age
    }
}

def list = [ new Employee(age:22), new Employee(age:23), new Employee(age:22) ] as Set

println list
println list.findAll { it.age == 22 } 
```

输出：

```
[22, 23, 22]
[22, 22] 
```

你可以发布你的代码吗？

编辑：添加“as Set”，因为我注意到问题是关于集合而不是列表。这也适用于我。

# algorithm - 如何存储套装，快速找到相似的图案？

> ID：462563
> 
> 赞同：0
> 
> 时间：2009-01-20T18:48:03.023
> 
> 标签：algorithm, data-structures, pattern-matching, puzzle

（这不是作业，也不是工作问题。这只是我个人的兴趣/职业，完全是虚构的。但我对好的算法或数据结构感兴趣。）

假设，我会经营一个约会网站。而我的***特点***是单曲**与电影品味相匹配**。（为什么不？）

在这种情况下，我需要一种方法来存储每个用户的电影评分。（到目前为止没问题。）我需要一个数据结构来找到最合适的用户。两种口味模式之间的距离将是两个用户做出的所有评分之间的平均距离。

**例子**

```
movies   A B C D E F G H I J K L M ...
user Xm  9 5   1   1   5
user Ym      4 6 1         8
user Zf  9   6 4           7 
```

距离(X,Z) = avg( abs(9-9) + abs(1-4) ) = 1.5

距离(Y,Z) = avg( abs(4-6) + abs(6-4) + abs(8-7) ) = 1.666

因此，X 先生比 Y 先生更适合 Z 女士。

**我喜欢那个...**

*   ...不需要对数据库进行很多操作
*   ...不需要处理大量数据
*   ... 快跑
*   ...提供最佳匹配
*   好的，也许我也会考虑好的近似值。

请记住，这也应该适用于数以千计的可能电影、仅对大约 20-50 部电影评分的用户以及数以千计的用户。

（因为这是一个心理难题，而不是真正的问题，所以工作场所并没有真正的帮助。）

**你的搜索算法或数据结构是什么？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T19:04:02.103

看起来您正在寻找电影空间中[最近的邻居](http://www.cs.sunysb.edu/~algorith/files/nearest-neighbor.shtml)。你的距离函数是[L1 度量](http://eis.comp.lancs.ac.uk/~kristof/research/notes/basicstats/index.html)。您可能可以使用某种[空间索引](http://en.wikipedia.org/wiki/Spatial_index)。也许您可以使用[协同过滤](http://en.wikipedia.org/wiki/Collaborative_filtering)中的技术。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-20T20:18:51.047

听起来很像[Netflix Prize](http://www.netflixprize.com/index)挑战赛，更具体地说是最受欢迎的方法的前半部分。您尝试做的事情的可能实现是多种多样的。它们都不是特别有效，并且 L1 度量对于可靠的相关性来说并不是一个特别好的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T18:58:05.857

```
CREATE TABLE data (user INTEGER, movie INTEGER, rate INTEGER);

SELECT  other.user, AVG(ABS(d1.rate - d2.rate)) AS distance
FROM    data me, data other
WHERE   me.user = :user
    AND other.user <> me.user
    AND other.movie = me.movie
GROUP BY
    other.user
ORDER BY
    distance 
```

复杂度将是 O(n ^(1.5) )) 而不是 O(n ² )，因为将与电影进行`n`比较`sqrt(n)`（每对填充在一起的电影的平均值）。

# visual-studio-2008 - 在 Visual Studio 中添加引用的 HintPath

> ID：462564
> 
> 赞同：37
> 
> 时间：2009-01-20T18:48:08.157
> 
> 标签：visual-studio-2008, tfs, build-process

我知道我可以将**HintPath**添加到外部 DLL 以帮助 Visual Studio/TFS 在构建时找到 dll。

我想知道的是......是否可以添加多个**HintPath**？

例如...开发人员将他们的 DLL 放在一个地方，我们在服务器上的不同地方对这些 DLL 进行 GetLatest，因此需要多个**HintPath**。

世界，你怎么看？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-11-16T13:42:20.087

抱歉，您**不能**使用多个 HintPath。Visual Studio/MSBuild 仅采用**最后一个** `<HintPath>`定义，将忽略任何以前的定义。在 VS2010 和 VS2012 中确认。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-20T19:10:16.503

这个答案不再有效。正如[Sardaukar 的评论](https://stackoverflow.com/questions/462564/hintpath-on-a-added-reference-in-visual-studio/462650#comment16281588_462650)所说，**Visual Studio 总是盲目地使用最后一个 HintPath**。[亚历克斯的回答](https://stackoverflow.com/a/13417794/105971)支持这一点。

* * *

好的。这次我比 Stackoverflow 快。我尝试添加它，它似乎工作正常。

所以多个 HintPath 是可能的。

当你有这个：

```
<Reference Include="System.ComponentModel.Composition.Codeplex">
    <HintPath>..\..\..\MEF2_Preview2\bin\System.ComponentModel.Composition.Codeplex.dll</HintPath>
</Reference> 
```

您可以像这样简单地添加更多提示路径：

```
<Reference Include="System.ComponentModel.Composition.Codeplex">
    <HintPath>..\..\..\MEF2_Preview2\bin\System.ComponentModel.Composition.Codeplex.dll</HintPath>
    <HintPath>D:\MEF\System.ComponentModel.Composition.Codeplex.dll</HintPath>
</Reference> 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2011-08-08T11:39:19.737

您可以为此使用环境变量。例如

```
<Reference Include="System.ComponentModel.Composition.Codeplex">
    <HintPath>$(PathToDLLs)\MEF2_Preview2\bin\System.ComponentModel.Composition.Codeplex.dll</HintPath>
</Reference> 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2014-11-04T15:01:22.567

使用条件，您可以：

```
<Reference Include="TheAssembly">
    <HintPath Condition="Exists('..\My\Assembly\Path')">..\My\Assembly\Path\TheAssembly.dll</HintPath>
    <HintPath Condition="Exists('..\..\My\Assembly\Path')">..\..\My\Assembly\Path\TheAssembly.dll</HintPath>
    <HintPath Condition="Exists('..\..\..\My\Assembly\Path')">..\..\..\My\Assembly\Path\TheAssembly.dll</HintPath>
    <HintPath Condition="Exists('..\..\..\..\My\Assembly\Path')">..\..\..\..\My\Assembly\Path\TheAssembly.dll</HintPath>
    <HintPath Condition="Exists('..\..\..\..\..\My\Assembly\Path')">..\..\..\..\..\My\Assembly\Path\TheAssembly.dll</HintPath>
    <HintPath Condition="Exists('..\..\..\..\..\..\My\Assembly\Path')">..\..\..\..\..\..\My\Assembly\Path\TheAssembly.dll</HintPath>
    <HintPath Condition="Exists('..\..\..\..\..\..\..\My\Assembly\Path')">..\..\..\..\..\..\..\My\Assembly\Path\TheAssembly.dll</HintPath>
    etc...
</Reference> 
```

将使用 Condition 评估为 true 的最后一个 HintPath。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-04T16:32:57.527

在注释掉的目标部分之后，将以下内容添加到项目文件的底部：

```
<Target Name="BeforeResolveReferences">
  <CreateProperty Value="YOUR_FIRST_PATH;YOUR_SECOND_PATH;$(AssemblySearchPaths)">
    <Output TaskParameter="Value" PropertyName="AssemblySearchPaths" />
  </CreateProperty>
</Target> 
```

替换`YOUR_FIRST_PATH`并`YOUR_SECOND_PATH`使用您的路径。

重要的是，这在以下行之后，否则您的设置将被覆盖：

`<Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />`

使用`$(AssemblySearchPaths)`路径中字符串末尾的条目，DLL 将覆盖正常分辨率。如果将其移至开头，则首先尝试正常分辨率，并检查其他路径是否有任何未找到的路径。正常分辨率包括`<HintPath>`部分，因此如果您的路径先出现，则无需删除它们。

# asp.net - linq to sql 并仅从连接表中检索特定行

> ID：462565
> 
> 赞同：1
> 
> 时间：2009-01-20T18:48:23.367
> 
> 标签：asp.net, linq-to-sql, join

我有两张表 1) 产品 2) 类别

Product 表有一个名为“CategoryID”的字段，Category 表有一个名为“CategoryName”、ID、DateCreated 和其他一些字段。

我想使用 LINQ to SQL 来查询所有产品行以及 Category.CategoryName。此查询将在数据源中使用并绑定到 ListView。

我知道我可以将 LoadWith 选项与 DataContext 和连接一起使用。但问题是我最终得到了 Product 和 Category 中的**所有**行。我真正想要的是 Product 中的所有行，**只是**Category.CategoryName

完美的解决方案是，如果 LoadWith 选项允许您指定要返回的字段，但正如[在此处回答](https://stackoverflow.com/questions/456754/linq-to-sql-loadwith-limiting-fields-returned)的那样，这是不可能的。

我确实找到**了一种方法**，创建一个自定义类，它具有我想要返回的完全相同的字段。所以例如

```
public class ProductInfo
{
   public string ProdName { get; set; }
   public int ProdID { get; set; }
   public int CategoryID { get; set; }
   public string CategoryName { get; set; } 
} 
```

但问题是 select 语句最终很长。例如...

```
var products = from p in db.Products
               join c in db.Categories on p.CategoryID = c.ID
               select new ProductInfo { ProdName = p.ProdName, ProdID = p.ID,
 CategoryID = p.CategoryID, CategoryName = c.CategoryName } 
```

这变得非常容易出错。

**所以我的问题 - 有没有更好的方法来做到这一点？**

编辑/澄清：我应该提到我需要中间类的原因是因为我需要能够将结果集作为特定类型返回，在本例中为 ProductInfo

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T20:05:11.933

我认为您几乎走在正确的轨道上，但我不会真正担心中间课程：

```
var products = from p in db.Products
           join c in db.Categories on p.CategoryID = c.ID
           select new { p.ProdName, ProdId = p.ID, p.CategoryID, 
              CategoryName = c.CategoryName } 
```

然后，您可以将其连接到 LinqDataSource 的 Selecting 事件中。[Scott Guthrie 在他的帖子“使用带有 asp:LinqDataSource”控件的自定义 Linq 表达式](http://weblogs.asp.net/scottgu/archive/2007/09/07/linq-to-sql-part-9-using-a-custom-linq-expression-with-the-lt-asp-linqdatasource-gt-control.aspx)中的“使用选择事件执行自定义查询投影”一节中谈到了这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T20:46:59.273

哦，天哪，我应该提到我需要中间类的原因是因为我需要能够将结果集作为特定类型返回，在本例中为 ProductInfo

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T20:57:08.067

```
List<ProductInfo> products = (from p in db.Products
               join c in db.Categories on p.CategoryID = c.ID
               select new ProductInfo { ProdName = p.ProdName, ProdID = p.ID,
 CategoryID = p.CategoryID, CategoryName = c.CategoryName }).ToList<ProductInfo>(); 
```

# java - 使用 SL4J 进行日志记录、Jakarta Commons 日志记录、第三方库的 log4j 和我自己的代码

> ID：462566
> 
> 赞同：23
> 
> 时间：2009-01-20T18:48:47.890
> 
> 标签：java, logging, log4j, apache-commons, slf4j

我有一些关于日志记录的问题，更具体地说是关于设置它并确保它有效。

我正在做的项目将使用[Wicket](http://wicket.apache.org/)、[Spring](http://www.springsource.org/)和[Hibernate](http://www.hibernate.org/)。我知道 Wicket 和 Hibernate 使用 Java 的 Simple Logging Facade ( [SL4J](http://www.slf4j.org/) )，并且 Spring 使用的是[Apache Commons 的日志组件](http://commons.apache.org/logging/)。

他们会幸福地共存吗？我想我会将[log4j](http://logging.apache.org/log4j/1.2/index.html)与 SL4J 和 Apache commons 的日志组件一起使用，你认为这是个好主意吗？

我可以将它们全部设置为将日志数据输出到一个通用文件中吗？或者我应该使用单独的文件？还是应该将日志消息存储在数据库中？（我宁愿不这样做，因为我发现对文本文件进行 grepping 等非常方便。）

对于 Spring，我想我需要某种用于 Apache Commons 日志记录组件的配置文件，以及在哪里指导它使用 log4j？

当我设置好这些后，我猜想看到一切正常，我将日志记录级别设置为 INFO，因为可以确定所有三个框架都在该模式下输出一些信息？还是有更好的方法来确定？

还有我的最后一个问题。在我开始的项目中，您是否建议我将 SL4J 用于我自己的日志记录目的？（我以为我会直接使用 log4j，但那是在我了解更多关于日志的知识之前，许多受人尊敬的库似乎选择了桥接/立面的路径来满足他们的日志记录需求。如果它让我们在没有添加的情况下获得灵活性成本没有理由不这样做。）

我期待听到更多关于您如何进行日志记录的信息。对我来说这是一个新的领域，我渴望在其中提高自己。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-20T19:16:14.807

好吧，SLF4J 只是一个门面，就像公共日志记录一样，这意味着它们仍然需要其他东西才能工作。它们允许库作者不强迫用户拥有多个日志库和配置。Log4j 和 logback 是常规的日志库。

请参阅[此处](https://stackoverflow.com/questions/354837/whats-up-with-logging-in-java)了解更多信息。

SLF4J 有一个[公共日志桥](http://www.slf4j.org/legacy.html)，您可以使用它来替换公共日志库。我认为那里的模式很好地解释了这种情况。

现在，您只需要使用 slf4j-logj12.jar 来进行公共日志记录，并且 slf4j 使用 log4j（或您选择的任何其他内容；顺便说一句，logback 不需要与 slf4j 一起使用的其他库）作为支持引擎。

您的应用程序将因此拥有

*   jcl104-over-slf4j.jar（将 jakarta commons 日志桥接到 slf4j）
*   slf4j.jar（供hibernate和其他人使用slf4j）
*   slf4j-logj12.jar（用于 slf4j 使用 log4j 作为后端）
*   log4j.jar（供您的应用程序使用。所有配置也将在此处完成）

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-01-20T19:25:57.783

以下是将所有内容重定向到 SLF4J 的方法：

*   `commons-logging.jar`从您的类路径中删除。如果您正在使用 Maven 并且无法摆脱 commons-logging，请参阅[此](http://day-to-day-stuff.blogspot.com/2007/07/no-more-commons-logging.html)。

*   放入`jcl-over-slf4j.jar`你的类路径（它来自 SLF4J 发行版）。这是一个模仿 JCL 类的插入式替换，但在内部调用 SLF4J。这将处理 Spring 以及任何其他使用 JCL 的框架。

通过放入`slf4j-xxx.jar`类路径将 SLF4J 连接到您最喜欢的后端（Log4J、Logback...）。配置后端以将所有类别记录到一个文件中，您就完成了。

至于在您的应用程序中使用 SLF4J，这不是绝对必要的。像 JCL 和 SLF4J 这样的库最初是为那些编写库并且不想将他们的客户锁定在特定的日志框架中的人设计的。

PS：顺便说一下，JCL = Jakarta Commons Logging

# html - 对齐两个单独（但相关）的 html 表中的列

> ID：462569
> 
> 赞同：1
> 
> 时间：2009-01-20T18:49:39.777
> 
> 标签：html, internet-explorer-6

我正在使用这种设置实现一个带有固定标题的表：

```
<div style="padding-right:18px"><!-- to account for the scrollbar on the other div -->
  <table id="head">
    <tr>
       <th>Col 1</th>
       <th>Col 2</th>
    </tr>
  </table>
</div>
<div style="height:400px; overflow-y:scroll">
  <table id="body">
    <tr>
       <td>Val 1a</td>
       <td>Val 2a</td>
    </tr>
    <tr>
       <td>Val 1b</td>
       <td>Val 2b - this cell is wide</td>
    </tr>
  </table>
</div> 
```

我正在使用dojo，因此在页面加载后使列宽相同：

```
dojo.addOnLoad(function(){
    var $bodyRow = dojo.query('#body tr')[0];
    var $headRow = dojo.query('#head tr')[0];
    dojo.forEach($bodyRow.cells, function(item, index){
        var w = item.offsetWidth;
        dojo.style($headRow.cells[index], 'width', w + "px");
    });
}); 
```

不幸的是，尽管宽度正在调整，但它们的调整不足以对齐。任何人都知道为什么这不起作用？还是更好的方法？注意：这必须在 IE6 中工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T18:58:44.140

您是否尝试过在 CSS 中设置宽度，或者您是否需要实现列大小调整和所有爵士乐？我不确定javascript是这里的答案。

尝试类似：

```
th, td { width: 50%; } // get 2 equal width columns in both tables 
```

PS，在“正文”表中，最好使用列/行标题的`<td>`元素。`<th>`也使您在编写 CSS 时更容易区分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T19:45:03.003

offsetWidth 获取元素的宽度、内边距和边框。使用元素样式设置宽度，您只是设置元素的宽度，因此每列将被前列的所有水平边框和填充的总和关闭

试试这个

```
dojo.addOnLoad(function(){
    var $bodyRow = dojo.query('#body tr')[0];
    var $headRow = dojo.query('#head tr')[0];
    dojo.forEach($bodyRow.cells, function(item, index){
            var w = dojo.style($bodyRow.cells[index], 'width');
            dojo.style($headRow.cells[index], 'width', w + "px");
    });
}); 
```

-恩里科

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T19:04:17.373

宽度是动态的，应根据内容呈现。对于某些列，我可以在 css 中添加一个建议，但最后，我需要将大小调整为浏览器中实际呈现的大小。

（在我使用 s 的真实代码中。我只是忘记更改我为上面的玩具示例复制和粘贴的内容。）

# ruby-on-rails - 是否有比较 django、rails 和 PHP 框架各自的内存使用情况的基准？

> ID：462571
> 
> 赞同：5
> 
> 时间：2009-01-20T18:50:23.207
> 
> 标签：ruby-on-rails, frameworks, comparison, memory-management, benchmarking

我必须在 RAM 有限（1 GB，无交换）的嵌入式服务器上运行具有许多服务的 Web 服务器。最多有 100 个用户。我将提供诸如论坛、小游戏（javascript 或 flash）等服务。

我的团队非常了解 Ruby on Rails，但我有点担心 Rails 的内存使用情况。我真的不想在这里开始一个巨魔，但我想知道是否有比较 Rails、Django、CakePHP 或任何其他 PHP 框架的任何严肃的（即记录的）基准？

您能否指出基准或就 Rails 的内存使用情况给我您的意见？请请不要巨魔。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-20T19:01:51.250

就内存使用而言，它通常是 Python > Ruby > PHP，当然这会导致 Django > Rails > CakePHP。不仅是内存，而且这也往往适用于原始性能。编辑：还值得注意的是，当然，这里没有绝对的。在很多使用场景中 Ruby 都会击败 Python，毫无疑问。我想我们都同意 Ruby 和 Python 总是会击败 PHP，不过 :)

这是一个直接的 3 路基准测试（在 PHP 方面使用 Symfony），它证实了上述内容：[http://wiki.rubyonrails.com/rails/pages/Framework+Performance](http://wiki.rubyonrails.com/rails/pages/Framework+Performance)。虽然当然很容易找到支持你自己观点的统计数据:)

也就是说，制作一个蹩脚、缓慢、低效的 Django 应用程序和一个精简、快速、高效的 Rails 应用程序仍然很容易，反之亦然。您正在使用的系统的技能、知识和专业知识对其内存和性能占用的影响远远超过框架本身。数据库优化、服务器选择和架构（Apache 与使用 nginx/lighttpd 的代理设置等）以及基本设计决策可能很快就会压倒框架的固有特性。

所以我想我想说的是，如果你的团队了解 Rails，并且你的专长在于 Rails，我会坚持使用 Rails。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T19:01:52.480

我只是偶然发现了这个看起来相当不错的基准。它只提供有关 Rails 内存使用（和性能）的数据，但它只是部分回答了这个问题，因为它没有将 Rails 与其他框架进行比较。

[http://www.rubyenterpriseedition.com/comparisons.html](http://www.rubyenterpriseedition.com/comparisons.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T19:11:27.080

我自己的经验是 Rails 的内存使用率可能很高，尤其是在 64 位机器上（`thin`作为 Web 前端，最小大约为 95-100 MB）。PHP 倾向于与不同的模式一起使用，因此直接比较有点困难。

# c++ - C++ 的 String.Format

> ID：462580
> 
> 赞同：28
> 
> 时间：2009-01-20T18:52:18.333
> 
> 标签：c++, localization, string.format, printf

正在寻找 .NET 的 String.Format 等函数的 C++ 实现。显然有 printf 和它的品种，但我正在寻找一些位置如下的东西：

> String.Format("您好，{0}。您已经 {1} 岁。成为 {1} 的感觉如何？", name, age);

这是必要的，因为我们将尝试使本地化我们的应用程序变得更容易，并且让翻译者 {0} 和 {1} 定位在句子中的任何位置比给他们一个 %s、%d、% 容易得多d 在翻译中必须按该顺序定位。

我想用变量输入（va_start、va_end 等）搜索和替换是我最终要构建的，但如果已经有一个可靠的解决方案，那将是可取的。

谢谢 ：）

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-01-20T18:54:13.917

查看[boost 格式库。](http://www.boost.org/doc/libs/1_37_0/libs/format/index.html)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-20T19:20:22.583

QT 的 QString 允许你这样做：

```
QString("Hi there %1\. You are %2 years old. How does it feel \
         to be %2?").arg(name).arg(age) 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-08T18:38:12.933

信不信由你，printf 和朋友们支持位置参数。

```
 #include <stdio.h>

 int main() {
   char *name = "Logan";
   int age = 25;
   printf("Hi there %1$s, you are %2$d years old. How does it feel to be %2$d?\n", name, age);
  return 0;
 } 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-01-21T09:36:56.287

你可以看看[FastFormat](http://fastformat.sourceforge.net/) -library。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-16T09:05:34.987

我认为您可以使用[FastFormat](http://www.fastformat.org/)，如

```
std::string result;

fastformat::fmt(result, "Hi there {0}. You are {1} years old. How does it feel to be {1}?", name, age); 
```

这几乎是相同的语法。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-26T13:52:38.350

上面的许多好的建议在大多数情况下都可以使用。就我而言，我最终想从资源中加载字符串，并尽可能地使字符串资源接近 .NET String.Format，所以我推出了自己的。在查看了上面的一些实现以获得想法之后，最终的实现非常简短和容易。

有一个 String 类，在我的例子中它派生自 Microsoft 的 CString，但它可以派生自任何字符串类。还有一个 StringArg 类——它的工作是接受任何参数类型并将其转换为字符串（即它模仿 .NET 中的 ToString）。如果一个新对象需要 ToString 化，您只需添加另一个构造函数。构造函数允许 printf 样式的格式说明符用于非默认格式。

然后，String 类接受源字符串的字符串表 ID、一些 StringArg 参数，最后是一个可选的 HINSTANCE（我使用了很多 DLL，其中任何一个都可以托管字符串表，所以这允许我将其传递进去，或默认使用特定于 DLL 的 HINSTANCE）。

使用示例：

```
dlg.m_prompt = String(1417); //"Welcome to Stackoverflow!"
MessageBox(String(1532, m_username)); //"Hi {0}" 
```

实际上，它只需要一个字符串 ID 作为输入，但是添加一个输入字符串而不是字符串 ID 将是微不足道的：

```
CString s = String.Format("Hi {0}, you are {1} years old in Hexidecimal", m_userName, StringArg(m_age, "%0X")); 
```

现在对于在变量上执行等效于 ToString 的 StringArg 类：

```
class StringArg
{
StringArg(); //not implemented
        StringArg(const StringArg&); //not implemented
        StringArg& operator=(const StringArg&); //not implemented

    public:
        StringArg(LPCWSTR val);
    StringArg(const CString& val);
    StringArg(int val, LPCWSTR formatSpec = NULL);
    StringArg(size_t val, LPCWSTR formatSpec = NULL);
    StringArg(WORD val, LPCWSTR formatSpec = NULL);
    StringArg(DWORD val, LPCWSTR formatSpec = NULL);
    StringArg(__int64 val, LPCWSTR formatSpec = NULL);
    StringArg(double val, LPCWSTR formatSpec = NULL);
    CString ToString() const;
private:
    CString m_strVal;
};

extern HINSTANCE GetModuleHInst(); //every DLL implements this for getting it's own HINSTANCE -- scenarios with a single resource DLL wouldn't need this 
```

对于 String 类，有一堆成员函数和构造函数，最多需要 10 个参数。这些最终调用 CentralFormat 来完成真正的工作。

```
class String : public CString
{
public:
    String() { }
    String(WORD stringTableID, HINSTANCE hInst = GetModuleHInst()) { Format(stringTableID, hInst); }
    String(WORD stringTableID, const StringArg& arg1, HINSTANCE hInst = GetModuleHInst()) { Format(stringTableID, arg1, hInst); }
    String(WORD stringTableID, const StringArg& arg1, const StringArg& arg2, HINSTANCE hInst = GetModuleHInst()) { Format(stringTableID, arg1, arg2, hInst); }
    String(WORD stringTableID, const StringArg& arg1, const StringArg& arg2, const StringArg& arg3, HINSTANCE hInst = GetModuleHInst()) { Format(stringTableID, arg1, arg2, arg3, hInst); }
    String(WORD stringTableID, const StringArg& arg1, const StringArg& arg2, const StringArg& arg3, const StringArg& arg4, HINSTANCE hInst = GetModuleHInst()) { Format(stringTableID, arg1, arg2, arg3, arg4, hInst); }
    String(WORD stringTableID, const StringArg& arg1, const StringArg& arg2, const StringArg& arg3, const StringArg& arg4, const StringArg& arg5, HINSTANCE hInst = GetModuleHInst()) { Format(stringTableID, arg1, arg2, arg3, arg4, arg5, hInst); }
    String(WORD stringTableID, const StringArg& arg1, const StringArg& arg2, const StringArg& arg3, const StringArg& arg4, const StringArg& arg5, const StringArg& arg6, HINSTANCE hInst = GetModuleHInst()) { Format(stringTableID, arg1, arg2, arg3, arg4, arg5, arg6, hInst); }
    String(WORD stringTableID, const StringArg& arg1, const StringArg& arg2, const StringArg& arg3, const StringArg& arg4, const StringArg& arg5, const StringArg& arg6, const StringArg& arg7, HINSTANCE hInst = GetModuleHInst()) { Format(stringTableID, arg1, arg2, arg3, arg4, arg5, arg6, arg7, hInst); }
    String(WORD stringTableID, const StringArg& arg1, const StringArg& arg2, const StringArg& arg3, const StringArg& arg4, const StringArg& arg5, const StringArg& arg6, const StringArg& arg7, const StringArg& arg8, HINSTANCE hInst = GetModuleHInst()) { Format(stringTableID, arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8, hInst); }
    String(WORD stringTableID, const StringArg& arg1, const StringArg& arg2, const StringArg& arg3, const StringArg& arg4, const StringArg& arg5, const StringArg& arg6, const StringArg& arg7, const StringArg& arg8, const StringArg& arg9, HINSTANCE hInst = GetModuleHInst()) { Format(stringTableID, arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8, arg9, hInst); }

    CString& Format(WORD stringTableID, HINSTANCE hInst = GetModuleHInst());
    CString& Format(WORD stringTableID, const StringArg& arg1, HINSTANCE hInst = GetModuleHInst());
    CString& Format(WORD stringTableID, const StringArg& arg1, const StringArg& arg2, HINSTANCE hInst = GetModuleHInst());
    CString& Format(WORD stringTableID, const StringArg& arg1, const StringArg& arg2, const StringArg& arg3, HINSTANCE hInst = GetModuleHInst());
    CString& Format(WORD stringTableID, const StringArg& arg1, const StringArg& arg2, const StringArg& arg3, const StringArg& arg4, HINSTANCE hInst = GetModuleHInst());
    CString& Format(WORD stringTableID, const StringArg& arg1, const StringArg& arg2, const StringArg& arg3, const StringArg& arg4, const StringArg& arg5, HINSTANCE hInst = GetModuleHInst());
    CString& Format(WORD stringTableID, const StringArg& arg1, const StringArg& arg2, const StringArg& arg3, const StringArg& arg4, const StringArg& arg5, const StringArg& arg6, HINSTANCE hInst = GetModuleHInst());
    CString& Format(WORD stringTableID, const StringArg& arg1, const StringArg& arg2, const StringArg& arg3, const StringArg& arg4, const StringArg& arg5, const StringArg& arg6, const StringArg& arg7, HINSTANCE hInst = GetModuleHInst());
    CString& Format(WORD stringTableID, const StringArg& arg1, const StringArg& arg2, const StringArg& arg3, const StringArg& arg4, const StringArg& arg5, const StringArg& arg6, const StringArg& arg7, const StringArg& arg8, HINSTANCE hInst = GetModuleHInst());
    CString& Format(WORD stringTableID, const StringArg& arg1, const StringArg& arg2, const StringArg& arg3, const StringArg& arg4, const StringArg& arg5, const StringArg& arg6, const StringArg& arg7, const StringArg& arg8, const StringArg& arg9, HINSTANCE hInst = GetModuleHInst());
private:
    void CentralFormat(WORD stringTableID, std::vector<const StringArg*>& args, HINSTANCE hInst);
}; 
```

最后，实现（希望可以在 StackOverflow 上发布这么多内容，尽管大部分内容非常简单）：

```
StringArg::StringArg(LPCWSTR val)
{
    m_strVal = val;
}

StringArg::StringArg(const CString& val)
{
    m_strVal = (LPCWSTR)val;
}

StringArg::StringArg(int val, LPCWSTR formatSpec)
{
    if(NULL == formatSpec)
        formatSpec = L"%d"; //GLOK
    m_strVal.Format(formatSpec, val);
}

StringArg::StringArg(size_t val, LPCWSTR formatSpec)
{
    if(NULL == formatSpec)
        formatSpec = L"%u"; //GLOK
    m_strVal.Format(formatSpec, val);
}

StringArg::StringArg(WORD val, LPCWSTR formatSpec)
{
    if(NULL == formatSpec)
        formatSpec = L"%u"; //GLOK
    m_strVal.Format(formatSpec, val);
}

StringArg::StringArg(DWORD val, LPCWSTR formatSpec)
{
    if(NULL == formatSpec)
        formatSpec = L"%u"; //GLOK
    m_strVal.Format(formatSpec, val);
}

StringArg::StringArg(__int64 val, LPCWSTR formatSpec)
{
    if(NULL == formatSpec)
        formatSpec = L"%I64d"; //GLOK
    m_strVal.Format(formatSpec, val);
}

StringArg::StringArg(double val, LPCWSTR formatSpec)
{
    if(NULL == formatSpec)
        formatSpec = L"%f"; //GLOK
    m_strVal.Format(formatSpec, val);
}

CString StringArg::ToString() const
{ 
    return m_strVal; 
}

void String::CentralFormat(WORD stringTableID, std::vector<const StringArg*>& args, HINSTANCE hInst)
{
    size_t argsCount = args.size();
    _ASSERT(argsCount < 10); //code below assumes a single character position indicator

    CString tmp;
    HINSTANCE hOld = AfxGetResourceHandle();
    AfxSetResourceHandle(hInst);
    BOOL b = tmp.LoadString(stringTableID);
    AfxSetResourceHandle(hOld);
    if(FALSE == b)
    {
#ifdef _DEBUG

        //missing string resource, or more likely a bad stringID was used -- tell someone!!
    CString s;
        s.Format(L"StringID %d could not be found!  %s", stringTableID, hInst == ghCommonHInst ? L"CommonHInst was passed in" : L"CommonHInst was NOT passed in"); //GLOK
        ::MessageBeep(MB_ICONHAND);
        ::MessageBeep(MB_ICONEXCLAMATION);
        ::MessageBeep(MB_ICONHAND);
        _ASSERT(0);
        ::MessageBox(NULL, s, L"DEBUG Error - Inform Development", MB_ICONSTOP | MB_OK | MB_SERVICE_NOTIFICATION); //GLOK
        }
#endif //_DEBUG

    CString::Format(L"(???+%d)", stringTableID); //GLOK
        return;
    }

    //check for the degenerate case
    if(0 == argsCount)
    {
        CString::operator=(tmp);
        return;
    }

    GetBuffer(tmp.GetLength() * 3); //pre-allocate space
    ReleaseBuffer(0);
    LPCWSTR pStr = tmp;
    while(L'\0' != *pStr)
    {
        bool bSkip = false;

        if(L'{' == *pStr)
        {
            //is this an incoming string position?
            //we only support 10 args, so the next char must be a number
            if(wcschr(L"0123456789", *(pStr + 1))) //GLOK
            {
                if(L'}' == *(pStr + 2)) //and closing brace?
                {
                    bSkip = true;

                    //this is a replacement
                    size_t index = *(pStr + 1) - L'0';
                    _ASSERT(index < argsCount);
                    _ASSERT(index >= 0);
                    if((index >= 0) && (index < argsCount))
                        CString::operator+=(args[index]->ToString());
                    else
                    {
//bad positional index

                        CString msg;
                        msg.Format(L"(??-%d)", index); //GLOK
                        CString::operator+=(msg);
                    }
                    pStr += 2; //get past the two extra characters that we skipped ahead and peeked at
                }
            }
        }

        if(false == bSkip)
            CString::operator+=(*pStr);
        pStr++;
    }
}

CString& String::Format(WORD stringTableID, HINSTANCE hInst)
{
    std::vector<const StringArg*> args;
    CentralFormat(stringTableID, args, hInst);
    return *this;
}

CString& String::Format(WORD stringTableID, const StringArg& arg1, HINSTANCE hInst)
{
    std::vector<const StringArg*> args;
    args.push_back(&arg1);
    CentralFormat(stringTableID, args, hInst);
    return *this;
}

CString& String::Format(WORD stringTableID, const StringArg& arg1, const StringArg& arg2, HINSTANCE hInst)
{
    std::vector<const StringArg*> args;
    args.push_back(&arg1);
    args.push_back(&arg2);
    CentralFormat(stringTableID, args, hInst);
    return *this;
}

CString& String::Format(WORD stringTableID, const StringArg& arg1, const StringArg& arg2, const StringArg& arg3, HINSTANCE hInst)
{
    std::vector<const StringArg*> args;
    args.push_back(&arg1);
    args.push_back(&arg2);
    args.push_back(&arg3);
    CentralFormat(stringTableID, args, hInst);
    return *this;
}

CString& String::Format(WORD stringTableID, const StringArg& arg1, const StringArg& arg2, const StringArg& arg3, const StringArg& arg4, HINSTANCE hInst)
{
    std::vector<const StringArg*> args;
    args.push_back(&arg1);
    args.push_back(&arg2);
    args.push_back(&arg3);
    args.push_back(&arg4);
    CentralFormat(stringTableID, args, hInst);
    return *this;
}

CString& String::Format(WORD stringTableID, const StringArg& arg1, const StringArg& arg2, const StringArg& arg3, const StringArg& arg4, const StringArg& arg5, HINSTANCE hInst)
{
    std::vector<const StringArg*> args;
    args.push_back(&arg1);
    args.push_back(&arg2);
    args.push_back(&arg3);
    args.push_back(&arg4);
    args.push_back(&arg5);
    CentralFormat(stringTableID, args, hInst);
    return *this;
}

CString& String::Format(WORD stringTableID, const StringArg& arg1, const StringArg& arg2, const StringArg& arg3, const StringArg& arg4, const StringArg& arg5, const StringArg& arg6, HINSTANCE hInst)
{
    std::vector<const StringArg*> args;
    args.push_back(&arg1);
    args.push_back(&arg2);
    args.push_back(&arg3);
    args.push_back(&arg4);
    args.push_back(&arg5);
    args.push_back(&arg6);
    CentralFormat(stringTableID, args, hInst);
    return *this;
}

CString& String::Format(WORD stringTableID, const StringArg& arg1, const StringArg& arg2, const StringArg& arg3, const StringArg& arg4, const StringArg& arg5, const StringArg& arg6, const StringArg& arg7, HINSTANCE hInst)
{
    std::vector<const StringArg*> args;
    args.push_back(&arg1);
    args.push_back(&arg2);
    args.push_back(&arg3);
    args.push_back(&arg4);
    args.push_back(&arg5);
    args.push_back(&arg6);
    args.push_back(&arg7);
    CentralFormat(stringTableID, args, hInst);
    return *this;
}

CString& String::Format(WORD stringTableID, const StringArg& arg1, const StringArg& arg2, const StringArg& arg3, const StringArg& arg4, const StringArg& arg5, const StringArg& arg6, const StringArg& arg7, const StringArg& arg8, HINSTANCE hInst)
{
    std::vector<const StringArg*> args;
    args.push_back(&arg1);
    args.push_back(&arg2);
    args.push_back(&arg3);
    args.push_back(&arg4);
    args.push_back(&arg5);
    args.push_back(&arg6);
    args.push_back(&arg7);
    args.push_back(&arg8);
    CentralFormat(stringTableID, args, hInst);
    return *this;
}

CString& String::Format(WORD stringTableID, const StringArg& arg1, const StringArg& arg2, const StringArg& arg3, const StringArg& arg4, const StringArg& arg5, const StringArg& arg6, const StringArg& arg7, const StringArg& arg8, const StringArg& arg9, HINSTANCE hInst)
{
    std::vector<const StringArg*> args;
    args.push_back(&arg1);
    args.push_back(&arg2);
    args.push_back(&arg3);
    args.push_back(&arg4);
    args.push_back(&arg5);
    args.push_back(&arg6);
    args.push_back(&arg7);
    args.push_back(&arg8);
    args.push_back(&arg9);
    CentralFormat(stringTableID, args, hInst);
    return *this;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-20T19:23:51.157

几个选项：

*   boost 格式库（已经提到过）
*   串流
*   旧版 printf/sprintf 函数
*   使用正则表达式或内置字符串函数的自定义实现

在相关的说明中，您所说的内容完全不足以进行本地化。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-20T19:24:13.420

如果您要自己编写，搜索和替换可能不是最好的方法，因为大多数搜索/替换方法只允许您一次替换一个，并且在允许 escpae 字符方面做得很差（例如，如果您想要`{0}`在输出中包含文字字符串。

你最好编写自己的有限状态机来遍历输入字符串，一次生成一个输出字符串。这允许您处理转义字符和更复杂的输出函数（例如本地化日期`{0:dd\MM\yyyy}`）。除了比搜索/替换或正则表达式方法更快之外，它还将为您提供更大的灵活性。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-20T20:53:03.380

iostream：

```
stringstream s;
string a;
s << "this is string a: " << a << endl; 
```

您可以像 sprintf （谷歌为“iostream 格式”）和它在 C++ 标准中的格式。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-22T21:04:54.087

瞄准Windows？[FormatMessage()](http://msdn.microsoft.com/en-us/library/ms679351.aspx)是你的朋友

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-11-10T10:58:02.477

如果您应该跨平台，那么我会投票支持 boost::format，或者可能是 ICU。如果你应该只支持 Windows，那么 FormatMessage （或方便的包装，CString::FormatMessage，如果你使用 MFC）

可以看看这里做个对比：[http ://www.mihai-nita.net/article.php?artID=20060430a](http://www.mihai-nita.net/article.php?artID=20060430a)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-12-26T01:20:01.267

除了其他人建议的选项外，我还可以推荐[fmt 库](https://github.com/cppformat/cppformat)，它实现了类似于[`str.format`](http://docs.python.org/2/library/stdtypes.html#str.format)Python 和`String.Format`C# 中的字符串格式。这是一个例子：

```
string result = fmt::format("Hi {0}. You are {1} years old.", name, age); 
```

该库是完全类型安全的，并且比 Boost 格式[快得多。](https://github.com/cppformat/cppformat#speed-tests)

免责声明：我是这个库的作者。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-04-01T16:47:31.470

前段时间，我试图做类似的事情，但有一些额外的假设：

*   不支持位置格式（所以我想这不适合你）
*   c++2k3（能够将它与一些旧代码合并）
*   （几乎）没有依赖（甚至 crt，所以没有 sprintf 依赖）

我失败了，它完全没有完成，但你仍然可以看看一些结果：

[http://code.google.com/p/pileofcrap/source/browse/tests_format.cpp](http://code.google.com/p/pileofcrap/source/browse/tests_format.cpp)

[http://code.google.com/p/pileofcrap/source/browse/format/Format.h](http://code.google.com/p/pileofcrap/source/browse/format/Format.h)

# .net - 配置文件作为嵌入式资源

> ID：462583
> 
> 赞同：7
> 
> 时间：2009-01-20T18:54:11.997
> 
> 标签：.net, configuration

有没有人有在 VB.NET 或 C# 中使用嵌入式配置文件的示例？我了解如何嵌入配置文件，但之后访问它的最佳方法是什么？我可以像对待外部配置文件一样将其视为配置文件吗？

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-20T19:05:13.003

i believe it's not the idea to put config file to be an embedded resource. embedded resources get packed into the dll and you can't change your configuration afterwards without recompilation (which is the idea of a config file in a first place).

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-20T20:25:18.427

您的一种选择是使用配置对象来包含任何配置设置的默认值。然后，您可以在配置对象的构造函数中尝试使用来自 app.config、数据库配置表等某处的值覆盖默认配置值。

这对许多目的很有用：

1.  单元测试工具（例如 nUnit）需要特殊配置才能访问 app.config。
2.  app.config 文件的存在不是必需的，因为它将使用默认值（这似乎是您的目标）。
3.  可以帮助确保类型安全的配置值。

一个简单的例子：

```
public class MyConfiguration
{

    private string _defaultValue1 = "Value1";
    private int _defaultValue2 = 22;

    public string Value1
    {
        get
        {
            return _defaultValue1;
        }
    }

    public int Value2
    {
        get
        {
            return _defaultValue2;
        }
    }

    #region cnstr

    public MyConfiguration()
    {
        LoadValuesFromConfigurationXml();
    }

    #endregion

    public static MyConfiguration GetConfig()
    {
        // Optionally Cache the config values in here... caching code removed 
        // for simplicity
        return new MyConfiguration();
    }    

    internal void LoadValuesFromConfigurationXml()
    {
        int tempInt;

        string value = ConfigurationManager.AppSettings["Value1"];

        if (!String.IsNullOrEmpty(value))
        {
            _defaultValue1 = value;
        }

        value = ConfigurationManager.AppSettings["Value2"];

        if (!String.IsNullOrEmpty(value))
        {
            if (int.TryParse(value, out tempInt))
            {
                _defaultValue2 = tempInt;
            }
        }

    }

} 
```

要访问配置值，请使用：MyConfiguration.GetConfig().Value1

希望这会有所帮助，马克斯

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-20T23:32:12.980

我通常有一个类将首选项保存在 UserAppDataPath 中的 xml 中。就像是：

```
public class Preferences
    {
        public static String prefFile = "/preferences.xml";
        private static XmlDocument doc;

        public static void set(String prefName, String value)
        {
            XmlElement nnode = (XmlElement)root.SelectSingleNode("//" + prefName);
            if (nnode == null)
            {
                nnode = doc.CreateElement(prefName);
                root.AppendChild(nnode);
            }
            nnode.InnerText = value;
        }
        public static String get(String prefName)
        {
            XmlElement nnode = (XmlElement)root.SelectSingleNode("//" + prefName);
            if (nnode != null) return nnode.InnerText;
            return "";
        }

        private static XmlElement root
        {
            get
            {
                if (doc == null)
                {
                    doc = new XmlDocument();
                    try
                    {
                        doc.Load(Application.UserAppDataPath + prefFile);
                    }
                    catch (Exception)
                    {
                        doc.LoadXml("<root></root>");
                        NodeChangedHandler(null, null); // costringo a salvare.
                    }
                    doc.NodeChanged += new XmlNodeChangedEventHandler(NodeChangedHandler);
                    doc.NodeInserted += new XmlNodeChangedEventHandler(NodeChangedHandler);
                    doc.NodeRemoved += new XmlNodeChangedEventHandler(NodeChangedHandler);
                }
                return (XmlElement)doc.FirstChild;
            }
        }
        private static void NodeChangedHandler(Object src, XmlNodeChangedEventArgs args)
        {
            if (doc != null)
                doc.Save(prefFile);
        }
    } 
```

# css - CSS 布局帮助 - 多行地址

> ID：462585
> 
> 赞同：7
> 
> 时间：2009-01-20T18:54:25.523
> 
> 标签：css

我正在尝试在页面的页脚中显示一个右对齐的地址，如下所示：

```
东南主街 1234 号
    无处，ID 45445
        (555) 555-5555

```

在我的标记中，我有这个：

```
<地址>
   东南主街 1234 号
   无处，ID 45445
   (555) 555-5555
</地址>

```

如何在不使用 css 在每一行中插入 <br /> 的情况下正确布局？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-20T18:58:59.133

嘿尝试使用这个使用这个

```
.address
{
white-space:pre;
text-align:right;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T18:59:43.407

您将不得不在其中添加额外的元素，无论是`<br>`按照您的建议，还是类似：

```
 <address>
      <div class="street">1234 south east Main St.</div>
      <div class="state">Nowhere, Id 45445</div>
      <div class="telnum">(555) 555-5555</div>
   </address> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-20T19:08:45.603

首先，在这种情况下，给地址一个 id 是一个很好的做法。当然，如果您不再使用其他地址，则没有必要。然后：

```
address#company_address
{
  white-space: pre;
  text-align: right;
} 
```

# javascript - Safari 中的小闪光

> ID：462590
> 
> 赞同：0
> 
> 时间：2009-01-20T18:55:28.187
> 
> 标签：javascript, flash, safari

我们有一个 Flash 文件，在其他所有浏览器中都会以正确的大小（大约 1600 像素）显示，但是在 safari 中它看起来很小。我们还注意到，有时当闪存文件未缓存时，它会显示为正常大小，然后在软刷新后闪存又变小了。

我们正在使用 mootools 来包含 flash，但我也尝试过使用带有发布功能的 flash 的 HTML/Javascript，我们仍然遇到同样的问题，它在 safari 中很小。

有人对这可能是什么有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-13T18:45:41.400

我遇到了类似的问题。我发现，一旦我删除了 Flash 嵌入代码周围的 html 表，Safari 就会以正确的大小呈现 Flash 电影。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T23:58:23.240

我想知道您是否在一个地方更改了 HTML 中的大小，而在另一个地方没有更改。注意：在代码中，您在 2 个地方需要它：OBJECT 和 EMBED。

```
<OBJECT classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" 
    codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,0,0" 
    WIDTH="100%" HEIGHT="82%">

    <PARAM NAME=movie VALUE="filename.swf"> 
    <PARAM NAME=quality VALUE=high> 
    <PARAM NAME=salign VALUE=T> 
    <PARAM NAME=devicefont VALUE=true> 
    <PARAM NAME=bgcolor VALUE=#fffff7>

    <EMBED src="filename.swf" quality=high salign=T devicefont=true bgcolor=#fffff7 WIDTH="100%" HEIGHT="82%   
        TYPE="application/x-shockwave-flash" PLUGINSPAGE="http://www.macromedia.com/go/getflashplayer"></EMBED>
</OBJECT> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T02:45:10.703

您是否偶然地动态调整了 Flash 电影的大小（在 Flash 电影加载时监听 Event.RESIZE 或设置舞台大小）？在某些浏览器（safari 就是其中之一）中存在许多已知问题，当 flash 对象被缓存和“重新加载”时，某些事件不会触发。检查以下链接。我的解决方法一直是将大小参数传递给 flash 对象以在加载时使用。

[http://pixelfumes.blogspot.com/2007/07/ie6-as3-preloader-events-failing.html](http://pixelfumes.blogspot.com/2007/07/ie6-as3-preloader-events-failing.html)

# hibernate - EasyMock 和 Hibernate 标准查询

> ID：462592
> 
> 赞同：2
> 
> 时间：2009-01-20T18:55:55.473
> 
> 标签：hibernate, easymock

我正在尝试使用 JUnit4 和 EasyMock 2.4 测试使用休眠标准 API 的 dao 方法。

当我运行测试夹具“testGetAsset”时，我收到以下异常：

```
java.lang.AssertionError:   
Unexpected method call add(name=Test):
   add(name=Test): expected: 1, actual: 0
   add(source=GSFP): expected: 1, actual: 0  
   uniqueResult(): expected: 1, actual: 0  
at org.easymock.internal.MockInvocationHandler.invoke(MockInvocationHandler.java:32)  
at org.easymock.internal.ObjectMethodsFilter.invoke(ObjectMethodsFilter.java:61)  
at $Proxy7.add(Unknown Source)  
at com.hsbc.sfd.funddb.persistence.dao.AssetDaoImpl.getAsset(AssetDaoImpl.java:80)  
at com.hsbc.sfd.funddb.persistence.AssetDaoTest.testGetAsset(AssetDaoTest.java:62) 
```

我认为这个问题与未使用 Asset.class 初始化的模拟标准对象有关，但我是 EasyMock 和模拟对象的初学者，所以如果有人可以看看并告诉我，我将不胜感激我需要做什么才能使测试通过。

非常感谢，马克

代码如下：

## 道法

```
public Asset getAsset(String name, Source source) {
    return (Asset) this.sessionFactory.getCurrentSession()
            .createCriteria(Asset.class)
            .add(Restrictions.eq("name", name))
            .add(Restrictions.eq("source", source))
            .uniqueResult();
} 
```

## 测试班

```
public class AssetDaoTest {

private SessionFactory factory;
private Session session;
private Criteria criteria;

private AssetDaoImpl dao;

@Before
public void setUp() {
    factory = createMock(SessionFactory.class);
    session = createMock(Session.class);
    criteria = createMock(Criteria.class);

    dao = new AssetDaoImpl();
    dao.setSessionFactory(factory);
}

@Test
public void testGetAsset() {

    String name = "Test";
    Source source = Source.GSFP;

    Asset asset = new Asset();
    asset.setName(name);
    asset.setSource(source);

    expect(factory.getCurrentSession()).andReturn(session);
    expect(session.createCriteria(Asset.class)).andReturn(criteria);
    expect(criteria.add(Restrictions.eq("name", name))).andReturn(criteria);
    expect(criteria.add(Restrictions.eq("source", source))).andReturn(criteria);
    expect(criteria.uniqueResult()).andReturn(asset);

    replay(factory, session, criteria);

    dao.getAsset(name, source);
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-11T06:21:03.410

问题是您在模拟设置中传递给 criteria.add 的限制与在 DAO 级别传递的对象实例并不完全相同。

看看 EasyMock 的参数匹配器。您可以创建自己的参数匹配器，这可能会为您提供所需的灵活性，但需要做一些工作。

可能值得考虑一下您在这里真正测试的内容。使用 hibernate 测试 DAO 的一个好方法是使用 HSQL 之类的东西来模拟您的数据库，而不是尝试模拟 hibernate 标准 API。然后，您可以将一些示例数据加载到您的内存数据库中，并确保您的 DAO 行为正确。

# language-agnostic - 检测整数内的单个一位流

> ID：462609
> 
> 赞同：2
> 
> 时间：2009-01-20T19:01:11.313
> 
> 标签：language-agnostic, binary, bit-manipulation

我必须检查一个数字是否满足以下条件：

*   在二进制中，所有一位必须是连续的。
*   该数字必须至少设置一位。
*   连续的一位可能从 MSB 开始或在 LSB 结束，因此如果该数字由单个一位流和一个零位流组成，则完全有效，反之亦然。

我编写了一个代码来检查这些条件是否存在实际问题（检查数据文件完整性）。

它可以正常工作，而且时间紧迫，但我是一个老顽固的怪胎，喜欢这样的谜题，所以我试图想出一种更聪明的方法来检查单比特流。

字符串被零包围的情况很容易，但不能处理特殊情况。

**欢迎任何想法、二进制黑客和部分解决方案！**

* * *

为了让我的要求更清楚一些例子：以下数字满足我的标准：

```
 0x80000000
  0x00000001
  0xff000000
  0x000000ff
  0xffffffff
  0x000ff000 
```

以下数字没有（因为它们有多个连续的一串）：

```
 0xf00000f <- one-bit streams should not wrap-around at 2^n
  0x0001700 <- a trivial example.
  0x0000000 <- no one bit at all. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T19:06:46.217

```
bool isOK(uint val) {
   while (val != 0 && (val & 1u) == 0) val >>= 1;
   if (val == 0) return false;
   while (val != 0 && (val & 1u) == 1) val >>= 1;
   return val == 0;
}

; x86 assembly
mov eax, THE_NUMBER ; store the number in eax
bsf ecx, eax
jz .notok
mov edi, 1
shl edi, cl
mov esi, eax
add esi, edi
test esi, eax
jnz .notok
mov eax, 1
jmp .end
.notok:
mov eax, 0
.end: ; eax = 1 if satisfies the criteria, otherwise it's 0 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-20T19:06:56.823

这应该做你想要的。

```
if(i == 0)
    return false;
while(i % 2 == 0) {
    i = i / 2;
}
return (i & (i + 1)) == 0; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-29T01:09:07.130

我在方法 hasInsetZero 中解决了几乎相同的问题[http://smallissimo.blogspot.fr/2012/04/meteor-contest-part-3-reducing.html](http://smallissimo.blogspot.fr/2012/04/meteor-contest-part-3-reducing.html)：（并使用了其他一些技巧）

```
hasInsetZero: aMask
    | allOnes |
    allOnes := aMask bitOr: aMask - 1.
    ^(allOnes bitAnd: allOnes + 1) > 0 
```

它是 Smalltalk 代码，但用 C 语言翻译（我们需要否定并关心 0），即：

```
int all_set_bits_are_consecutive( x )
/* return non zero if at least one bit is set, and all set bits are consecutives */
{
   int y = x | (x-1);
   return x && (! (y & (y+1)));
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T19:23:49.223

假设您想要快速，基本算法将是：

1.  找到最低位集。
2.  按最低位集的索引移动数字。
3.  添加1。
4.  如果 result 是 2 且非零的幂，则成功！

所有这些操作都是 O(1) 或 O(log(integer bit width))，如下所示：

```
unsigned int lowest_power_of_2(unsigned int value) 
{ return value & -value; }

unsigned int count_bits_set(unsigned int value) 
{ /* see counting bits set in parallel */ }

unsigned int lowest_bit_set_or_overflow_if_zero(unsigned int value)
{ return count_bits_set(lowest_power_of_2(value) - 1); }

unsigned int is_zero_or_power_of_2(unsigned int value)
{ return value && (value & (value - 1))==0; }

bool magic_function(unsigned in value)
{ return is_zero_or_power_of_2((value >> (lowest_bit_set_or_overflow_if_zero(lowest_power_of_2(value)))) + 1); } 
```

编辑：更新最终操作以占零，但 OP 的算法要快得多，因为它都是恒定操作（尽管考虑溢出将是 PITA）。

微信

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-20T19:28:21.850

我会使用 bsr 和 bsf 来确定数字中设置的最小和最大位。由此，创建一个满足条件的有效数字。比较已知的有效数字与实际数字是否相等。没有循环，只有一个比较。

伪代码：

```
min_bit = bsf(number);
max_bit = bsr(number);
valid_number = ~(-1 << (max_bit - min_bit) ) << min_bit;
return ( number == valid_number ); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-20T19:36:40.897

我的正在进行中的版本。不作为答案，只是为了提供更多想法并记录我目前的方法：

```
int IsSingleBitStream (unsigned int a)
{
  // isolate lowest bit:
  unsigned int lowest_bit = a & (a-1);

  // add lowest bit to number. If our number is a single bit string, this will
  // result in an integer with only a single bit set because the addition will     
  // propagate up the the highest bit. We ought to end up with a power of two.
  a += lowest_bit;

  // check if result is a power of two:
  return (!a || !(a & (a - 1)));
} 
```

如果以下行，此代码将不起作用：

a+= 最低位

溢出。此外，如果有多个位域，我不确定我的“隔离单个位”代码是否有效。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-20T19:09:11.577

`(N^2 - N) / 2`N 位整数有可能（32 位为 496）。

您可以使用查找表。

# apache-flex - 使 Flex 3 按钮响应回车键的最佳方法是什么？

> ID：462618
> 
> 赞同：9
> 
> 时间：2009-01-20T19:02:42.963
> 
> 标签：apache-flex

在 Flex 3 中，当鼠标单击按钮，或者当它们具有焦点并且用户按下空格键时，它们会调用它们的单击处理程序。

当用户按下回车键时，是否有一种直接的方法可以使具有焦点的 Flex 3 按钮调用其单击处理程序？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-20T19:28:59.493

当然，你可以这样做：

```
<mx:Script>
    <![CDATA[
        import mx.controls.Alert;

        private function btn_click(event:MouseEvent):void
        {
            Alert.show("Clicked!"); 
        }

        private function btn_keyDown(event:KeyboardEvent):void
        {
            if (event.keyCode == Keyboard.ENTER)
                btn.dispatchEvent(new MouseEvent(MouseEvent.CLICK));
        }
    ]]>
</mx:Script>

<mx:Button id="btn" label="Click Me" click="btn_click(event)" keyDown="btn_keyDown(event)" /> 
```

...虽然我不喜欢在这些对象之外的对象上调度事件。更简洁的方法可能是将 Button 子类化，在子类中添加侦听器和处理程序，然后从该类中分派 click 事件。但这应该有助于说明这一点。祝你好运！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-20T19:26:01.323

对于登录表单之类的东西，您需要实际使用 mx:form - 这是说明它的代码片段：

```
<mx:Form defaultButton="{loadButton}">
<mx:TextInput id="feedURL" />
<mx:Button id="loadButton" label="Load" click="someHandler(event)" />
</mx:Form> 
```

输入网址并按回车键，bam，预期的行为。

从[这里谷歌搜索。](http://www.johncblandii.com/2008/03/flex-3-button-click-on-enter-k.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-08-17T11:39:18.150

如果您要提交登录对话框之类的表单，则 TextField 上的“输入”属性是一个很好的解决方案：

`<mx:TextInput displayAsPassword="true" id="wPassword" enter="handleLoginSubmit()"/>`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-23T21:28:52.957

甚至更好

```
 private function setValidationFocus(formObject:Object):void
    {
        formObject.setFocus();
        formObject.dispatchEvent(new MouseEvent(MouseEvent.MOUSE_OUT));  // sneaky sneaky
        formObject.dispatchEvent(new MouseEvent(MouseEvent.MOUSE_OVER));
    } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-08-24T16:23:22.087

您还可以将`KEY_DOWN`Christian's answer 中的侦听器添加到按钮本身。只要确保你调用了 stopImmediatePropagation。在这个例子中，我让任何键导致按钮动作。而且我使用的是相同的处理程序，所以我允许任何“事件”类型。您可以使用不同的“cancelClick”处理程序。

```
protected function cancelClick(e:Event = null):void{
    this.dispatchEvent(new Event(Event.CANCEL)); // do component action
    e.stopImmediatePropagation();
}

override protected function partAdded(partName:String, instance:Object):void {
    super.partAdded(partName,instance);
    switch(instance){
        case cancel:
            cancel.addEventListener(MouseEvent.CLICK,cancelClick);
            cancel.addEventListener(KeyboardEvent.KEY_DOWN,cancelClick);
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-20T19:21:40.523

尝试“buttonDown”事件；在任何一种情况下都可以发送它。否则，您可能正在查看使用“keyDown”并检查按下的键。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-03-08T10:06:01.083

我一直在寻找同样的问题，但 Christian Nunciato 的回答对我来说似乎是最好的。要添加到他的解决方案中的另一件事是，我认为应该将冒泡标志 in`btn.dispatchEvent(new MouseEvent(MouseEvent.CLICK))`设置为，`false (btn.dispatchEvent(new MouseEvent(MouseEvent.CLICK, false)))`因为应该在按钮上隔离事件。

# html - 应该 和 在网页设计中不惜一切代价避免？

> ID：462619
> 
> 赞同：43
> 
> 时间：2009-01-20T19:02:47.673
> 
> 标签：html, css

我不断地寻找需要使用`<br />`标签的地方，因为 CSS 无法满足我的需求。被`<br />`考虑的不是“设计”的一部分，而不是文档结构的一部分吗？它的可接受用途是什么？相同的规则是否也适用于`<hr />`?

这是一个我觉得被迫使用`<br />`标签的例子：

我想显示这个：

`<address>1234 south east Main St. Somewhere, Id 54555</address>`

像这样：

```
东南主街 1234 号
某处，编号 54555

```

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-01-20T19:23:29.160

使用 <br /> 或 <hr /> 没有任何问题。它们都不是不推荐使用的标签，即使在新的 HTML 5 草案规范（相关[规范信息](http://dev.w3.org/html5/spec/Overview.html#the-hr-element)）中也是如此。事实上，很难说 <br /> 标签的正确用法比 W3C 本身更好：

> *以下示例是 br 元素的正确用法：*
> 
> <p>P。谢尔曼<br>
> 42 Wallaby Way<br>
> 悉尼</p>
> 
> *br 元素不得用于分隔段落中的主题组。*
> 
> *以下示例不符合标准，因为它们滥用了 br 元素：*
> 
> <p><a ...>34 条评论。</a><br>
> <a ...>添加评论。<a></p>
> 
> <p>姓名：<input name="name"><br>
> 地址：<input name="address"></p>
> 
> *以下是上述的替代方案，它们是正确的：*
> 
> <p><a ...>34 条评论。</a></p>
> <p><a ...>添加评论。<a></p>
> 
> <p>姓名：<input name="name"></p>
> <p>地址：<input name="address"></p>

<hr /> 也可以很好地成为内容的一部分，而不仅仅是一个显示元素。当涉及到什么是内容和什么不是内容时，请使用良好的判断力，您就会知道何时使用这些元素。它们都是当前 W3C 规范中有效且有用的元素。但是权力越大，责任越大，所以要正确使用它们。

**编辑1：**

我第一次点击“post”后的另一个想法——近年来，Web 开发人员中有很多反<table> 情绪，这是有充分理由的。人们滥用 <table> 标签，将其用于网站布局和格式化。这不是它的用途，所以你不应该那样使用它。但这是否意味着你**永远**不应该使用 <table> 标签？如果您的代码中确实有一个诚实的表怎么办，例如，如果您正在写一篇科学文章并且想要包含[元素周期表](http://www.webelements.com/)? 在那种情况下，使用 <table> 是完全合理的，它变成了语义标记而不是格式化。<br /> 也是同样的情况。当它是您内容的一部分时（即，应该在这些点中断以便正确英语的文本），使用它！当您只是出于格式化原因这样做时，最好尝试另一种方式。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-20T19:20:05.643

只要你不使用 <br/> 来组成段落，你在我的书中可能没问题；）我讨厌看到：

```
<p>
  ...lengthy first paragraph...
  <br/>
  <br/>
  ...lengthy second paragraph...
  <br/>
  <br/>
  ...lengthy third paragraph...
</p> 
```

至于地址，我会这样做：

```
<address class="address">
  <span class="street">1100 N. Wullabee Lane</span><br/>
  <span class="city">Pensacola</span>, <span class="state">Florida</span> 
  <span class="zip">32503</span>
</address> 
```

但这可能是因为我喜欢 jQuery，并且希望在任何给定时刻访问这些部分中的任何一个 :)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-20T19:07:53.840

`<hr />`和`<br />`，就像其他一切一样，可以在不应该的时候被滥用来进行设计。 `<hr />`旨在用于在视觉上划分文本部分，但在本地化意义上。 `<br />`意味着做同样的事情，但没有水平线。

将`<hr />`整个站点用作设计将是一个设计缺陷，但在这篇文章中，例如，同时使用`<br />`和是正确的`<hr />`，因为这部分文本仍然必须是一段文本，即使网站布局发生了变化。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-20T19:13:22.597

`<hr/>`并且`<br/>`是对文档没有语义价值的表示元素，所以从纯粹的角度来看，是的，应该避免它们。

不要将 HTML 视为一种表示工具，而是将其视为需要自我描述的文档。 `<hr/>`并且`<br/>`不添加任何语义值——而是它们代表浏览器中非常具体的表示。

综上所述，在你的方法中要务实。尝试不惜一切代价避免它们，但如果你发现自己在墙壁和天花板上编码以避免它们，那么最好继续使用它们。语义很重要，但像这样的边缘情况并不是最重要的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-20T19:14:23.720

没有为什么？它们是有用的构造。

* * *

添加此附录（以及随附的 HR），以防我的简短回答被解释为缺乏适当的考虑。;)

尝试为 BR 和 HR 标签及其喜欢的 UI 问题提出跨浏览器 CSS 限制的解决方案可能是而且通常是令人难以置信的浪费时间两秒内解决。为什么有些 UI 人员会浪费这么多时间试图想出“纯粹”的方法来使用经过验证的 HTML 结构（如换行符和水平规则），这对我来说完全是个谜。这两个标签以及许多其他标签都是完全合法的，并且确实可供您使用。从这个意义上说，“纯”是无稽之谈。

与我共事的一位设计师根本无法做到这一点。他会浪费几个小时，有时甚至几天，试图围绕它“编码”，但仍然想出一些在 Opera 中不起作用的东西。我发现这完全莫名其妙。老兄，添加BR，完成。完全合法，像魅力一样工作，每个人都很开心。

我完全是为了抽象呈现，不要误会我的意思；我们全力以赴，尽我们所能。但要理智。如果你已经花了五个小时试图找出某种方法来实现，在脚本中，BR 现在给你的东西，并且上帝不会因为你这样做而向你倾泻火，那么就去做，然后继续前进。无论如何，如果它有那么大的问题，那么您的解决方案可能有问题。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-20T19:18:49.263

我相信*绝对避免*使用普遍接受的解决方案（即使它已经过时）与设计带有`<div>`标签而不是`<table>`标签的表格是一样的，这样您就可以使用`<div>`.

在设计您的网站时，您可能*不需要*使用`<br />`标签，但我仍然可以想象它们在需要用户输入的情况下很有用，例如。

我认为使用没有任何*问题*，`<br />`但没有遇到很多*需要*使用它们的情况。`<br />`在大多数情况下，如果这是垂直分隔内容所需要的，那么可能有比使用标签更优雅（更漂亮）的解决方案。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-20T19:27:27.547

我`<hr style="display:none">`在部分之间放了一个。例如，在多列布局中的列之间。在不支持 CSS 的浏览器中，分离仍然很清晰。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-20T19:07:03.937

有趣的问题。我一直用作`<br/>`回车（因此实际上是内容的一部分）。不确定这是否是正确的做法，但它对我很有帮助。

`<hr/>`另一方面...

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-20T19:09:09.377

我不会说*不惜一切代价*，但如果你想成为纯粹主义者，这些标签与结构和布局无关，但 HTML 应该将内容与呈现分开。 `<hr />`可以通过 CSS 和`<br/>`正确使用 otehr 标签（如`<p>`.

如果您不想成为纯粹主义者，请使用它们:)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-20T19:10:55.660

我认为您的模板中应该很少需要 BR 标签。但有时可以在内容、用户生成和系统生成中调用它。就像你想在段落中保留一段文本但在它之前需要一个换行符。

什么情况下你觉得你不得不使用 BR 标签？

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-20T19:15:08.833

`<br>`是表示换行符的 HTML 方式，因为没有其他方式可以做到这一点。

源代码中的物理换行符被理所当然地忽略（更准确地说：被视为单个空格），因此您需要一种标记方式来表达它们。

并非每个换行符都是新段落的开头，并且将文本打包到`<div>`s 中（例如）只是为了避免`<br>`s 对我来说似乎过于偏执。他们为什么要打扰你？

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-01-26T09:05:16.947

BR 很好，因为硬换行符可能是内容的一部分，例如在代码块中（即使您可能为此使用 PRE 元素）或歌词。

另一方面，人力资源纯粹是表象：一条水平线，一条水平线。对相邻元素使用border-top/bottom。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2011-04-06T11:40:21.703

我个人认为，为了真正分离内容和风格，两者都`<br />`应该`<hr />`避免。

至于`<br />`在我自己的标记中取消标签，我`<div>`与 css`margin`属性结合使用来处理任何需要换行的内容，以及`<span>`用于内联但具有不同“内容类”的任何内容（显然区分它们与`class`属性）。

要使用 css 替换`<hr />`标签，我只需创建一个`<div>`将`border-top-style`css 属性设置为`solid`并将其他三个边设置为`none`. `margin`和`padding`属性然后`<div>`处理水平线的实际放置/定位。

就像我说的，我不是专家，我的网页设计经验主要是我处理 JSP 页面的副作用（我是一名 Java 程序员），但我在一些研究中遇到了这个问题，并想投入我的两分钱...

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2014-08-11T04:30:29.950

您可以使用`<br>`但不要使用`<hr>`.

`<BR>`— LINE BREAK
— 这是显示信息。仍然常用，但要谨慎使用。

`<HR>`— 水平规则
— 显示没有语义价值的信息——永远不要使用它。“水平”，顾名思义，是一种视觉属性。

来源：[HTML 标签的正确使用指南](http://webdesignfromscratch.com/html-css/list-of-html-tags-with-semantic-usage/)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-20T19:18:37.300

如果你要严格，那是不好的用法。

`<br/>`并且`<hr/>`不是内容的一部分。例如，`<hr/>`通常用于分隔文本块。但是边界底部不可能吗？并且`<br/>`在许多情况下被视为将文本限制为某种形式的一种方式，而这是用 css 无法实现的？

当然你不会去 Strict 不要太担心。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-01-01T05:07:15.787

HR 目前在防止移动浏览器的字体膨胀算法发挥作用方面有一些骇人听闻的用途。

此外，如果您有很多由 HR 分隔的小内容，Googlebot 目前会将其视为“N 个单独的条目”，这可能对您有用。

BRs 实际上应该只用作段落中的换行符，这是一种非常罕见的印刷用法（可能在表格单元格中除外），而且我不知道使用它们的任何骇人理由。

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2020-05-05T00:04:12.533

这是帮助您学习 html 的课程的摘录。

```
<form>
    <p>Choose your pizza toppings:</p>
    <label for="cheese">Extra cheese</label>
    <input id="cheese" name="topping" type="checkbox" value="cheese">
    <br>
    <label for="pepperoni">Pepperoni</label>
    <input id="pepperoni" name="topping" type="checkbox" value="pepperoni">
    <br>
    <label for="anchovy">Anchovy</label>
    <input id="anchovy" name="topping" type="checkbox" value="anchovy"> 
```

# sql-server - 如何从 SQL Server 2005 数据库中删除脱机文件

> ID：462637
> 
> 赞同：2
> 
> 时间：2009-01-20T19:07:04.170
> 
> 标签：sql-server, sql-server-2005

我有一个数据库，前段时间从 SQL 2000 实例恢复到 SQL 2005 实例。SQL 2000 实例定义了旧的、未使用的全文搜索。

看来，当文件恢复时，全文搜索没有恢复，只是被删除了。

这使数据库处于一个有趣的状态，FTS 文件仍然与数据库相关联，但数据库知道的文件被列为 OFFLINE。事实证明，这使数据库无法完成完整备份。

那么，有谁知道如何从数据库中删除文件？`ALTER DATABASE REMOVE FILE`返回

> Msg 5009, Level 16, State 2, Line 1 找不到或无法初始化语句中列出的一个或多个文件。

对于每个不存在的文件，实际的备份命令会引发以下错误之一：

> Msg 9987, Level 16, State 1, Line 1 不允许备份全文目录 '' 因为它不在线。检查错误日志文件，了解全文目录脱机的原因并使其联机。或者，可以通过使用 FILEGROUP 或 FILE 子句将选择限制为仅包括联机数据来执行 BACKUP。

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-20T20:34:28.957

这个难题的答案很简单，至少如果你不关心你的 FTS 指数，我不关心。

```
EXEC master.dbo.sp_detach_db @dbname = N'dbname', @keepfulltextindexfile=N'false' 
```

这里的关键是第二个标志，`@keepfulltextindexfile`默认为真。通过将其设置为 false 然后重新附加数据库，所有 FTS 数据都将被删除，并且备份可以按应有的方式工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-10-13T21:22:42.167

我将报告问题修复如下

1.  将数据库置于单用户模式。
2.  分离数据库。但在为分离单击确定之前，取消选中保留全文目录。
3.  重新附加数据库

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T19:13:01.007

您应该重新填充全文目录。默认情况下，SQL Server 2005 不会执行此操作来加速安装过程。

# database - 优化包含线串的数据集的最佳方法。一些线在相同的坐标开始和结束

> ID：462640
> 
> 赞同：2
> 
> 时间：2009-01-20T19:07:55.480
> 
> 标签：database, algorithm, sorting, gis

**设置**
我有一个包含线串的表。线串由多个地理点组成。每个点都由纬度和经度组成。注意：线串值在数据库中存储为 TEXT。

所以表中的一行可能如下所示：
id: an integer
linestring: x1, y2, x2, y2, x3, y3, x4, y4

**问题**
Google 地图一次最多只能显示 1000 个元素。就我而言，我正在显示 850 个线串，并且将来需要添加更多。

**问题**
相当多的线串与一个或多个其他线串连接，这意味着它们开始和/或结束于相同的坐标。我要做的是找到优化数据集的最佳方法，以便将末端连接的线串合并到数据库表中。当我解析数据库表并为谷歌地图创建显示文件时，这将减少总元素数。

**示例**
在此示例中，假设 alpha (A,B,C) 值表示地理点。未优化的表可能如下所示：

优化前：
**id linestring**
1 A, B, C
2 C, D
3 B, A
4 F, G, H
5 G, I
6 H, J

* * *

优化后：
1 A、B、C、D
2 F、G、H、J
3 G、I

* * *

那么优化数据的最佳方法是什么？有没有一种效果最好的特定算法？我有一些我将制定和添加的解决方案的想法，但它们看起来很冗长和令人费解。

我不是 CS 专业的，所以请原谅草率的术语，让我知道是否需要在任何地方进行澄清。谢谢！

* * *

仅供参考..我正在使用 MySQL 数据库。我没有使用空间扩展。如果您有一个使用空间扩展的令人尴尬的简单解决方案，无论如何我很想听听。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T19:35:56.563

我认为最简单的方法是使用 MySQL 空间扩展。

特别是我只使用了 Oracle 空间扩展。在 Oracle 中，我们可以使用[SDO_GEOM.RELATE](http://download.oracle.com/docs/cd/B19306_01/appdev.102/b14255/sdo_objgeom.htm#BGHCDIDG)或[SDO_RELATE](http://www.potu.com/man/mysql/manual_Spatial_extensions_in_MySQL.html#Functions_for_testing_spatial_relations_between_geometric_objects)等函数来找出两个对象之间的空间关系（包含、接触、相交等）

我确信在 MySQL 中有一个等效的空间函数

编辑：

这是一个列出所有可用 MySQL 空间函数的[链接。](http://www.potu.com/man/mysql/manual_Spatial_extensions_in_MySQL.html#Functions_for_testing_spatial_relations_between_geometric_objects)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-21T18:07:33.777

需要意识到的一件事是，如果有多个线串可以连接到给定的线串，*则选择哪个并不重要*——优化表中的线串的最终数量将是相同的。

因此，在这种情况下，一个简单的贪心策略会反复寻找一对可以连接的线串并将它们连接起来，直到你再也找不到这样的一对，这将为你提供一个最佳表格。本质上，伪代码是：

```
while (there exists a pair of linestrings x and y that share an endpoint) {
    delete(x)
    delete(y)
    insert(x . y)
} 
```

这不能在单个 SQL 查询中完成，因为可能`x . y`会再次使用生成的线串。您应该能够使用诸如 T-SQL 之类的过程语言或脚本语言（例如 Perl，使用 DBI 进行数据库访问）编写 while 循环，并使用 SQL SELECT 查询来查找一对或一对列表以及然后使用 DELETE 和 INSERT 语句处理每个。

我建议将两个字段添加到您的表中，`begin`并`end`为它们编制索引以加快搜索速度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T13:29:02.777

如果每个端点最多出现两次（结束一个线串并开始另一个线串），那么将有一个独特的解决方案，但可以保证吗？例如，如果您有以下情况会发生什么：

1.  甲、乙、丙
2.  丙、丁
3.  C、E、F

这应该产生：

1.  A B C D
2.  C、E、F

或者：

1.  A、B、C、E、F
2.  丙、丁

?

还是你不在乎？

# .net - 如何在 TreeView 中选择下一个/上一个 TreeViewItem？

> ID：462641
> 
> 赞同：2
> 
> 时间：2009-01-20T19:08:28.927
> 
> 标签：.net, wpf, treeview, treeviewitem

我有更改 TreeViewItem 的选定子节点的 First/Last/Previous/Next 按钮。将 First 和 Last 节点设置为选中状态不是问题。例如，要选择最后一个子节点：

```
TreeViewItem selectedItem = (myTreeView.SelectedItem as TreeViewItem);
TreeViewItem ParentItem = (selectedItem.Parent as TreeViewItem);
(ParentItem.Items[ParentItem.Items.Count - 1] as TreeViewItem).IsSelected = true; 
```

将上一个/下一个项目设置为选中的最简单/最优雅的方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-20T19:38:59.740

您可以用 IndexOf 调用替换 for 循环。

```
int index = ParentItem.Items.IndexOf(MyTreeView.SelectedItem) 
```

当然，最好检查 index + 1 是否是有效的集合索引。

对于前一个兄弟，它将是索引 - 1。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-05-21T11:04:28.787

我的变体至少适用于 4 级树。

如果光标遇到最后一个 treeviewitem，它将在开始时进行。如果您在第一个节点按 Previous，您将留在原地。

```
 // Button Back
    private void Button_Click_1(object sender, RoutedEventArgs e)
    {
        if (treeViewStruct.Items.Count < 1) return;
        if (Currentitem == null)
        {
            ((TreeViewItem)treeViewStruct.Items[0]).IsSelected = true;
            return;
        }
        TreeViewItem item = FindPreviousItem(Currentitem);
        if (item == null)
            ((TreeViewItem)treeViewStruct.Items[0]).IsSelected = true;
        else item.IsSelected = true;
    }

    /// <summary>
    /// Get Previous Node
    /// </summary>
    /// <param name="item">Current selected node</param>
    /// <returns></returns>
    private static TreeViewItem FindPreviousItem(TreeViewItem item)
    {
        TreeViewItem foundedItem = null;
        var parentItem = (item.Parent as TreeViewItem);
        if (parentItem != null)
        {
            int index = parentItem.Items.IndexOf(item);
            if (index > 0 && index < parentItem.Items.Count)
            {
                return FindLastChildren((TreeViewItem)parentItem.Items[index - 1]);
            }
            else if (index == 0)
                return parentItem;
        }
        else return item;
        return foundedItem;
    }

    private static TreeViewItem FindLastChildren(TreeViewItem parent)
    {
        if (parent.Items.Count > 0)
        {
            return FindLastChildren((TreeViewItem)parent.Items.Last());
        }
        else return parent;
    }

    // вперед
    private void Button_Click_2(object sender, RoutedEventArgs e)
    {
        if (treeViewStruct.Items.Count < 1) return;
        if (Currentitem == null)
        {
            ((TreeViewItem)treeViewStruct.Items[0]).IsSelected = true;
            return;
        }
        TreeViewItem item = FindNextItem(Currentitem);
        if (item == null)
            ((TreeViewItem)treeViewStruct.Items[0]).IsSelected = true;
        else item.IsSelected = true;
    }

    /// <summary>
    /// Get Next Node
    /// </summary>
    /// <param name="item">Current selected node</param>
    /// <returns></returns>
    private static TreeViewItem FindNextItem(TreeViewItem item)
    {
        TreeViewItem foundedItem = null;
        if (item.Items.Count < 1)
        {
            var parentItem = (item.Parent as TreeViewItem);
            if (parentItem != null)
            {
                int index = parentItem.Items.IndexOf(item);
                if (index > 0 && index < parentItem.Items.Count - 1)
                {
                    return (TreeViewItem)parentItem.Items[index + 1];
                }
                else if (index == parentItem.Items.Count - 1)
                {
                    return FindFirstNextParent(parentItem);
                }
            }
            else return item;
        }
        return (TreeViewItem)item.Items[0];
    }

    private static TreeViewItem FindFirstNextParent(TreeViewItem parent)
    {
        var parentParent = ((TreeViewItem)parent).Parent;
        if (parentParent is TreeViewItem)
        {
            int pindex = ((TreeViewItem)parentParent).Items.IndexOf(parent);
            if ((pindex + 1) < ((TreeViewItem)parentParent).Items.Count)
                return ((TreeViewItem)((TreeViewItem)parentParent).Items[pindex + 1]);
            else
            {
                return FindFirstNextParent(((TreeViewItem)((TreeViewItem)parent).Parent));
            }
        }
        return parent;
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T19:35:11.323

它并不优雅，但它确实有效。谁能想出一个更好的解决方案？（显示“下一个”功能）

```
int index = 0;
foreach (TreeViewItem i in ParentItem.Items) {
    if (i.Equals(MyTreeView.SelectedItem)) {
        break;
    }
    index++;
}
(ParentItem.Items[index + 1] as TreeViewItem).IsSelected = true; 
```

# ruby-on-rails - Rails 记录器格式字符串配置

> ID：462651
> 
> 赞同：16
> 
> 时间：2009-01-20T19:10:45.753
> 
> 标签：ruby-on-rails, logging

如何配置 rails logger 以其他格式输出其日志字符串？我想获得更多信息，例如：

[日志级别] [时间] [消息]

调试：01-20-2008 13:11:03.00：方法调用

当我想跟踪我的 development.log 以获取仅来自某个日志级别的消息时，这真的会帮助我，比如调试。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-21T16:43:39.420

做了一些挖掘并在 RubyOnRails Talk 谷歌组中找到[了这篇文章。](http://groups.google.com/group/rubyonrails-talk/browse_thread/thread/9da4250f2c7e2cd7/d6948f578149f2f0?lnk=gst&q=logger#d6948f578149f2f0 "在 Rails2 中自定义记录器消息？")

所以我稍微修改了一下，放在了我的 environment.rb 的最后：

```
module ActiveSupport
  class BufferedLogger
    def add(severity, message = nil, progname = nil, &block)
      return if @level > severity
      message = (message || (block && block.call) || progname).to_s

      level = {
        0 => "DEBUG",
        1 => "INFO",
        2 => "WARN",
        3 => "ERROR",
        4 => "FATAL"
      }[severity] || "U"

      message = "[%s: %s #%d] %s" % [level,
                                     Time.now.strftime("%m%d %H:%M:%S"),
                                     $$,
                                     message]

      message = "#{message}\n" unless message[-1] == ?\n
      buffer << message
      auto_flush
      message
    end
  end
end 
```

这会产生如下格式字符串：

[调试：0121 10:35:26 #57078] 渲染布局/_header (0.00089)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-19T19:22:18.477

对于 rails 4 应用程序，我整理了一个简单的 gem，它不仅增加了对时间戳和日志级别等基本标记的支持，甚至还为日志消息本身添加了颜色。

[https://github.com/phallguy/shog](https://github.com/phallguy/shog)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-03-23T07:38:13.343

标签的问题在于它们会使您的日志混乱到无法阅读的程度。

我会推荐类似[木材](https://github.com/timberio/timber-ruby)的东西。它会自动在不牺牲可读性的情况下使用上下文（级别、时间、会话 ID 等）扩充您的日志。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-09-20T06:19:22.233

```
# config/initializers/rack_logger.rb
module Rails
  module Rack
    class Logger < ActiveSupport::LogSubscriber
      # Add UserAgent
      def started_request_message(request)
         'Started %s "%s" for %s at %s by %s' % [
          request.request_method,
          request.filtered_path,
          request.ip,
          Time.now.to_default_s,
          request.env['HTTP_USER_AGENT'] ]
      end
    end
  end
end 
```

[源链接](http://yuumi3.hatenablog.com/entry/20140718/1405643069)

# logging - 如何解决特定的循环依赖：DAL & Logging

> ID：462656
> 
> 赞同：2
> 
> 时间：2009-01-20T19:12:18.030
> 
> 标签：logging, data-access-layer, decoupling

需要记录一些“高风险”数据操作。在这种情况下，“高风险”操作被定义为写入我们的 ERP 系统。碰巧我们正在将这些事件记录到我们的 SQL Server 数据库中。

伪代码：

```
Public Class MyCompany.DAL.ERP {
  Public void WriteToERP(string msg) {
    // ... do the write
    MyCompany.Logging.Write("Wrote msg: " + msg);
  }
}

Public Class MyCompany.Logging {
  Public void Write(string msg) {
    MyCompany.DAL.ExecuteSQL("Insert INTO EventLog VALUES " + msg);
  }
} 
```

消除这种紧密耦合的最佳做法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T19:19:09.187

嗯，恕我直言，日志记录是一个基础设施问题。你可以在你的 DAL 中使用它，但你的记录器不应该使用你的 DAL。

如果您删除了您的记录器对 DAL 的依赖，那么您应该也可以在其他项目中使用您的记录器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T19:20:33.520

您可以创建自定义 TraceListener (System.Diagnostics) 以插入公司的 SQL Server 数据库。然后使用 Trace / TraceSource (System.Diagnostics) 登录应用程序代码。然后，您可以使用标准 .NET 配置在设计时使用您的自定义 TraceListener。这样，如果您需要更改事件日志记录，您只需更改 TraceListener。另外，您可以在其他应用程序中重用 TraceListener。

您还可以使用企业库的日志记录应用程序块和许多其他第 3 方日志记录解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T19:18:27.237

也许您可以将日志记录组件移至单独的程序集（我假设这是 C# 代码），引发一个事件，调用者可以在调用 Logging.Write() 之前注册该事件。在 Logging.Write() 返回后，从事件中注销。在事件处理程序中，您可以执行 MyCompany.DAL.ExecuteSQL("Insert INTO EventLog VALUES " + msg) 调用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T19:24:38.580

我之前通过两种方式解耦了这种情况：状态变化和日志事件。

第一种方法是创建一个 IHaveStatus 接口，如下所示：

```
/// <summary>
/// Interface for objects that have a status message 
/// that describes their current state.
/// </summary>
public interface IHaveStatus
{
    /// <summary>
    /// Occurs when the <seealso cref="Status"/> property has changed.
    /// </summary>
    event EventHandler<StatusChangedEventArgs> StatusChanged;
    /// <summary>
    /// The current status of the object.  When this changes, 
    /// <seealso cref="StatusChanged"/> fires.
    /// </summary>
    string Status { get; }
} 
```

当你的对象做事时，你设置你的 Status 属性。您可以将属性设置器配置为在设置时触发 StatusChanged 事件。使用您的对象的任何人都可以侦听您的状态更改事件并记录发生的所有事情。

另一个版本是向您的对象添加日志事件。

```
public event EventHandler<LogEventArgs> Log; 
```

主体几乎相同，只是您的对象比状态驱动的日志更健谈（只有在您特别想记录某些内容时才会触发该事件）。

这个想法是 DAL 之外的调用者有责任将这些事件连接到正确的日志（希望通过使用 DI 设置）。您的 DAL 不知道是谁或什么在消耗这些事件，从而很好地区分了这些问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-20T19:32:31.560

响应之间的共同点似乎是建议实现类似于观察者模式的东西。

（如果有更好的总结性陈述，请告诉我。我会相应地更新。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-20T20:46:31.223

实际上，如果您所说的高风险数据是指关键/重要的是要知道它应该是数据的方式，并且如果您需要在数据库中保存日志（某种元数据），那么解决方案应该与其他人建议的完全不同。

我描述的情况意味着数据库事务的结果在任何给定时间都应该在数据库中同时包含日志记录数据和数据本身。一个不应该独立于另一个来完成。

因此，这种“日志记录”应该作为单个数据库事务的一部分来完成，并且 DAL 应该确保在同一事务中同时正确插入这两个项目。

不这样做可能会产生以下副作用：

*   只有一个数据或日志插入到数据库中。
*   只有一个数据或日志在另一个之前插入到数据库中，这意味着依赖于在任何给定时间都必须存在的事实的系统可能会在特定情况下随机失败。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-24T02:32:43.410

为了避免循环依赖 DAL -> Logger -> DAL，我建议你有两层 DAL：“simple DAL”和“logging DAL”。

“简单 DAL”只是一个 DAL。“日志记录 DAL”建立在“简单 DAL”之上；它使用简单的 DAL 操作数据库，并再次使用简单的 DAL 记录内容。所以你有了：

[应用程序逻辑] --uses--> [logging DAL] --uses--> [simple DAL] --uses--> DB

如果你想对不需要记录的数据库做一些事情（“低风险”操作;-)）你可以直接使用“简单 DAL”并绕过记录 DAL。

# javascript - 隐含的字符串比较，0==''，但 1=='1'

> ID：462663
> 
> 赞同：19
> 
> 时间：2009-01-20T19:14:52.937
> 
> 标签：javascript

我正在调试一些东西，并在 JavaScript 中发现了一些奇怪之处：

```
alert(1=='') ==> false
alert(0=='') ==> true
alert(-1=='') ==> false 
```

隐含的字符串比较 0 应该 = '0' 是有意义的。对于所有非零值都是如此，但为什么不为零呢？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-20T19:24:40.330

根据关于[Javascript 比较运算符的 Mozilla 文档](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Operators/Comparison_Operators)

> 如果两个操作数的类型不同，JavaScript 会转换操作数，然后应用严格比较。如果任一操作数是数字或布尔值，则操作数将转换为数字；如果任一操作数是字符串，则将另一个操作数转换为字符串

实际发生的是字符串被转换为数字。例如：

`1 == '1'`变成：`1 == Number('1')`_`1 == 1``true`

然后试试这个： `1 == '1.'`become `1 == Number('1.')`become `1 == 1`:`true` 如果它们变成字符串，那么你会得到`'1' == '1.'`，这将是错误的。

恰巧如此`Number('') == 0`，因此`0 == ''`是真的

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-20T19:19:40.713

当 javascript 进行隐式类型转换时，空字符串文字将匹配 0 整数。像这样进行比较，您将获得预期的结果：

```
alert(1==='') ==> false
alert(0==='') ==> false
alert(-1==='') ==> false 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-20T19:24:03.327

ECMA-262，第 3 版，11.9.3 关于`x == y`，第 16 步：

> 如果 Type(x) 是 Number 并且 Type(y) 是 String，则返回比较结果 x == ToNumber(y)。

空字符串在比较之前`''`被转换为`0`。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-20T19:18:39.110

这只是 JavaScript 妥协中真正可怕的破坏之一。'' 和 0 都是未初始化的值（等于布尔值 false），因此相等。

为了保护自己免受此类奇怪错误的影响，最好始终使用 === 运算符。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-20T19:18:25.707

Javascript 和 PHP 一样，是弱类型*。因此，当您将 0 与 '' 进行比较时，JS 引擎会将它们转换为相似的数据类型。由于 0 和 '' 都等同于 boolean(false)，因此“false == false”为真。

*弱类型语言不要求变量是任何特定的数据类型，因此您可以将一个变量设置为字符串，将其更改为 int、float 和返回字符串，而不会出现处理器抛出错误。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-20T19:23:28.083

在许多语言中，可以将空字符串强制为 false。

小心使用 == 而不是 === 进行比较：

```
alert('' == '0'); //false  
alert(0 == ''); // true  
alert(0 =='0'); // true 
```

== 不是传递的。

# svn - 多个工作副本之间的颠覆合并？

> ID：462667
> 
> 赞同：3
> 
> 时间：2009-01-20T19:15:13.327
> 
> 标签：svn, backup, recovery

我们已经完全失去了我们的存储库，并且我们有 8 名开发人员进行了未提交的更改。假设无法从备份中恢复。

如果一个人可以访问所有工作副本（文件副本或远程共享），是否可以将我们工作副本中的更改合并到一个工作副本？然后可以将最终的工作副本导入到新的存储库中。

简而言之，你可以在没有服务器的情况下合并两个不同的工作副本吗？

编辑：请不要因为没有备份而对我撒尿；那部分是我无法控制的。假设他们每晚都会备份。

**跟进**：这就是我们所做的：

1.  从所有开发人员的最新工作副本开始。
2.  将其导入新的存储库。
3.  从最新的工作副本修订到最旧的工作，仅复制具有更改然后提交的文件。
4.  洗涤-漂洗-重复6次。（2 个开发人员没有未提交的更改）。
5.  导出所有旧的工作副本，将它们拉上拉链并储存起来，以便在需要时安全保存。
6.  将我们在发布管理数据库中的修订更新为现在非常年轻的 repo。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-20T19:52:19.073

由于您丢失了存储库（对此感到抱歉），因此您也丢失了整个历史记录。

你现在所能做的就是从头开始。

1.  创建一个新的存储库
2.  创建文件夹结构
3.  将第一个用户的工作副本导出到新文件夹
4.  将导出的文件夹导入存储库
5.  所有其他用户现在签出一个新的工作副本
6.  所有其他用户现在“导出”他们的原始工作副本而不是新的工作副本

“导出”是指创建工作副本的副本，但其中没有隐藏的 .svn 文件夹。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T19:49:08.440

嗨棘手的问题。但这就是我会做的。

1.  创建一个新的存储库。
2.  创建8个分支和1个主干
3.  导入开发人员在分支上的工作。
    *   分支 1 上的开发人员 1
    *   分支 2 上的开发人员 2
    *   等等等等
4.  然后开始从分支 1 合并到主干。当您在后备箱中的情况稳定时，您将继续使用分支 2 等

当您完成这项可怕的工作时，请教开发人员尽早并经常检查...以及如何使用分支...

/约翰

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T19:17:31.857

您的问题不是您丢失了服务器，而是存储库本身。除了重新创建一个新的 repo 并仔细分类各种工作副本以供导入之外，我看不出你能做什么。祝你好运。

PS：没有备份对你不利...

PPS：这是[DVCS](http://en.wikipedia.org/wiki/Distributed_Version_Control_System)通过在每个开发人员的沙箱中为大多数人提供完整的 repo 副本而自然解决的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T19:20:22.320

最简单的方法是创建您自己的服务器，创建一个测试存储库，在其中添加一个（最稳定的）构建，然后一次合并一个工作副本。但是，是的，您丢失了所有历史记录，因为您丢失了旧的仓库。

然后，您可以从该测试创建主存储库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-20T19:20:29.323

我会尝试只选择一个工作副本来为新的 repo 导入，然后使用 svn switch 将剩余的 7 个工作副本重新指向新的 repo，可能带有 relocate，以使他们相信它是同一个 repo 但已重新定位。只需尝试从丢失的存储库中为初始导入选择一个没有（或尽可能少）结构更改的工作副本：例如，仅文件编辑。

当然，如果上述方法不起作用，请对您的工作副本进行大量备份:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-20T19:43:18.683

Subversion 将文件的原始版本保存在本地工作副本中。创建一个新的存储库，制作最旧的工作副本的副本，还原工作副本 COPY 上的更改，然后将该工作副本导入新的存储库。

svn 导入：[http ://svnbook.red-bean.com/en/1.0/re12.html](http://svnbook.red-bean.com/en/1.0/re12.html)

导入后，您可以使用 svn switch --relocate 将其他工作副本重新指向您的新存储库，并提交更改。

svn 开关——重定位：http: [//svnbook.red-bean.com/en/1.1/ch04s05.html](http://svnbook.red-bean.com/en/1.1/ch04s05.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-02-15T22:06:33.913

从最原始的工作副本中在与旧版本相同的位置创建一个新存储库（这样您可以在新存储库中捕获更多历史记录）。

如果它不起作用以及在哪里不起作用，请从新存储库的签出中放入 .svn-directories。（例如结帐，并删除除 .svn 目录之外的所有内容）

# delphi - 在 Delphi 中为表单上的许多控件切换控件类型（但不是名称）

> ID：462676
> 
> 赞同：4
> 
> 时间：2009-01-20T19:17:41.777
> 
> 标签：delphi, delphi-2007

我需要将窗体上特定类型的每个控件切换到不同的类型，同时保持与每个控件关联的名称和代码。

例如，假设我需要将十几个或更多 TEdit 字段切换到 TSpinEdits。我怎样才能在 Delphi 2007 中以最小的努力做到这一点？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-20T19:23:49.160

使用[GExperts](http://www.gexperts.org)替换组件专家。它是免费的，并且是我见过的唯一可以满足您要求的工具，包括将属性从旧组件映射到新组件。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-20T19:45:02.083

如果您不想使用任何外部工具，您可以随时尝试切换以将表单查看为文本，然后搜索并将 TEdit 替换为 TSpinEdit。当您切换回并保存表单时，IDE 应该会告诉您 .pas 文件中的声明不正确并提供自动更正它们。属性映射不应该是一个问题，除非您想要从一个类映射到另一个类的名称不同的属性。新类中不存在的属性将被删除。无论如何，这就是它在Delphi 7中的工作方式......

如果您对结果不满意，您可以尝试 Craig 推荐的 GExperts，它是 IDE 的一个很好的补充，原因有很多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-06T15:08:38.733

我使用 CNTools 组件替换器（在 GExperts 中找不到），它也有一个很好的组件选择器功能，因此您可以根据一些简单的查询选择多个控件。

# java - 使用带有 java 5 的 jmx 以编程方式获取堆信息

> ID：462677
> 
> 赞同：5
> 
> 时间：2009-01-20T19:18:17.707
> 
> 标签：java, memory, heap-memory, jmx

我知道使用 jconsole 附加到 java 进程以获取内存信息。具体来说，我是在以编程方式获取各种内存池的信息之后，以便将其绑定到监控应用程序。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-21T01:34:53.793

谢谢mattk-我基本上是这样做的:-)

```
List memBeans = ManagementFactory.getMemoryPoolMXBeans();           
for (Iterator i = memBeans.iterator(); i.hasNext(); ) {

    MemoryPoolMXBean mpool = (MemoryPoolMXBean)i.next();
    MemoryUsage usage = mpool.getUsage();

    String name = mpool.getName();      
    float init = usage.getInit()/1000;
    float used = usage.getUsed()/1000;
    float committed = usage.getCommitted()/1000;
    float max = usage.getMax()/1000;
    float pctUsed = (used / max)*100;
    float pctCommitted = (committed / max)*100;

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T19:23:56.337

查看[java.lang.management.MemoryPoolMXBean](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/management/MemoryPoolMXBean.html)和相关类。

# scripting - 用于更改用户的注销脚本

> ID：462693
> 
> 赞同：1
> 
> 时间：2009-01-20T19:20:52.927
> 
> 标签：scripting, windows-server-2003, logoff

使用 Windows 2003，我正在寻找一种创建“注销脚本”的方法，该脚本将继续当前注销，然后立即登录另一个用户。因此，“UserA”注销。脚本触发登录“UserB”。

这是我们编写了“shell”的计算机应用程序升级的一部分；类似于信息亭应用程序。对于升级，我们需要以“Adminstrator”身份登录，然后在升级完成后，注销“Administrator”并以“sample_user”身份登录。我们想在不重新启动的情况下完成此操作。

请注意，我不想要启动注销（即“关闭”）的脚本。我正在寻找一个将在用户注销时运行的[脚本（通过组策略设置）。](http://technet.microsoft.com/en-us/library/cc781354.aspx)如上所述，脚本应该登录不同的用户。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-03T19:24:44.707

不要认为以所述方式（注销时的脚本）是可能的。

您必须将机器设置为以指定帐户自动登录，然后注销（让它为您自动登录），然后您必须通过放置临时登录脚本再次禁用该功能......通常听起来很乱。

可以使用 Microsofts Shared Computer Toolkit 或类似工具进行实际设置（不太确定“正常”注册表自动登录在手动注销时的行为，但我有一个 XP 信息亭可以立即自动登录，即使你手动注销-您必须使用诸如 shift+logoff 之类的键覆盖它才能再次手动指定登录，因此可以以某种方式进行）。

“最简单”的方法可能是用您自己制作的人替换 msgina.dll ......

**但是**你为什么要这样做？只需使用*runas*并以其他用户身份启动您需要执行的任何操作，而无需注销控制台用户 - 毕竟它是一个多用户系统？桌面只是绒毛^^

（*无论如何，这将要求您的脚本可以使用用户凭据，这使得它在您损害该帐户的安全性时变得多余 - 违背了首先拥有第二个帐户的目的，无论它存在的目的是什么？*）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-07T03:21:34.863

我会尝试[将注册表设置为](http://support.microsoft.com/kb/315231)使用您想要的用户自动登录，然后简单地注销管理员用户。那应该重新登录您的信息亭用户。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T19:28:11.757

不确定当前用户注销后如何登录另一个用户（不确定Windows是否会让您...）

但是你可以使用shutdown来注销：

> ```
> shutdown /? 
> ```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T18:04:42.527

以下是一些可能属于“廉价黑客”类别的想法：

首先在 UserB 登录，然后使用`runas /user:userA <cmd>`运行安装过程的第一部分怎么样？

如果这是不可接受的，我知道有一种方法可以让 Windows 工作站（那些不属于域的工作站）在重新启动后自动登录到某个用户帐户。也许如果您查看发生了哪些注册表更改并复制它们，重新启动将自动登录该用户。（当然，作为最后阶段，在 userB 登录后，您必须恢复这些更改 :-)

我还想知道是否有一种服务可以强制打开“登录屏幕”以某个用户身份登录。也许使用某种方法，例如远程桌面远程执行它的方式......如果可能的话，那么您可以创建一个在用户A注销之前安装的服务，这将触发用户B的登录。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-05T18:53:20.413

您可以使用 VNC 编写脚本（有很多免费版本，任您选择）。在机器上设置一个 VNC 服务器进程来监听 localhost。当用户注销时，您的注销脚本将使用 VNC 连接到机器并发送登录下一个用户所需的击键。VNC使用RFB（remote framebuffer）协议；有大多数流行语言的库，因此您应该能够快速获得一些工作。或者有相关的[工具](http://www.vncrobot.com/)可能[会](http://cyberelk.net/tim/software/rfbplaymacro/)有所帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-03T21:00:02.207

如果您要以给定语言将这样的东西作为普通脚本运行，它很可能无法正常工作，因为当您注销帐户时，所有进程都应该与正在运行的脚本一起被终止。

您可能能够创建某种“服务”，该服务将在服务帐户（即始终处于活动状态）上运行，该服务帐户会自动为您执行此用户切换。

我的赌注是 Windows Powershell，尽管我不完全确定它在实际创建服务方面有什么功能。

快速搜索会出现以下内容（第二个链接是一个论坛，但它提到将 Powershell 作为服务运行并向该服务发送一个参数，该参数将是您的用户切换脚本的路径）

[如何使用 Powershel 创建 Windows 服务](http://halr9000.com/article/444)

[Powershell 脚本作为 Windows 服务](http://www.vistax64.com/powershell/37213-powershell-script-windows-service.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-08T14:52:46.933

我没有 Windows 2003 服务器或具有“组策略”设置的系统来测试我的预感，但您可以查看 Windows 的 SU（“切换用户”）。最初是资源工具包的一部分，现已扩展到新的[SUperior SU](http://www.stefan-kuhr.de/supsu/main.php3)。如果可行，请发布结果/脚本。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-09T22:20:59.883

您可以从构建远程控制实用程序（如 VNC 等）的角度来解决这个问题。这里最重要的是，如果你想访问登录屏幕（即 CTRL + ALT + DEL / 用户名/密码）部分，唯一的问题是 Windows 服务是唯一可以访问它的组件，所以你会必须创建一个。

我认为这个技术作为一个整体的唯一问题是，即使你花了很多精力让它工作（这将是一个相当大的努力），这个成功的机会与整个事情起源于一个即使以管理员身份重新登录时可能出错的事情的数量，注销脚本（即当东西关闭时）也很低。

请记住，对于您需要以管理员身份运行的任何内容，Windows 中有更简单的方法可以实现这一点（例如运行方式、更改需要更新的项目的用户权限等）。

# java - 如何在文件写入失败时确保文件完整性？

> ID：462696
> 
> 赞同：4
> 
> 时间：2009-01-20T19:22:12.753
> 
> 标签：java, file, locking, integrity

**跟进**：[如何安全地更新一个有许多读者和一个作者的文件？](https://stackoverflow.com/questions/421357/how-to-safely-update-a-file-that-has-many-readers-and-one-writer)

在我之前的问题中，我发现您可以使用 FileChannel 的锁来确保读取和写入的顺序。

但是，如果编写器在写入过程中失败（比如 JVM 崩溃），您将如何处理这种情况？这个基本算法看起来像，

```
WRITER:
  lock file
  write file
  release file

READER:
  lock file
  read file
  release file 
```

如果 JVM 在 期间崩溃`write file`，肯定会释放锁，但现在我有一个不完整的文件。我想要完整的东西总是可读的。要么是旧内容，要么是新内容，两者之间没有任何内容。

我的第一个策略是写入一个临时文件，然后将内容复制到“实时”文件中（同时确保良好的锁定）。算法是，

```
WRITER:
  lock temp file
  write temp file
  lock file
  copy temp to file
  release file
  release temp
  delete temp

READER:
  lock file
  read file
  release file 
```

一件好事是，`delete temp`如果临时文件已被另一位作家锁定，则不会删除临时文件。

但是如果 JVM 在`copy temp to file`. 然后我添加了一个`copying`标志，

```
WRITER:
  lock temp file
  write temp file
  lock file
  create copying flag
  copy temp to file
  delete copying flag
  release file
  release temp
  delete temp

READER:
  lock file
  if copying flag exists
    copy temp to file
    delete copying flag
    delete temp 
  end
  read file
  release file 
```

永远不会有两件事访问该`copying`文件，因为它受到文件锁的保护。

现在，这是这样做的方法吗？确保非常简单的事情似乎很复杂。是否有一些 Java 库可以为我处理这个问题？

**编辑**

好吧，我设法在第三次尝试中犯了一个错误。阅读器不会将锁锁定到 temp `copy temp to file`。简单地锁定临时文件也不是一个简单的修复！这将导致写入者和读取者以不同的顺序获取锁，并可能导致死锁。这一直在变得越来越复杂。这是我的第四次尝试，

```
WRITER:
  lock file
  write temp file
  create copying flag
  copy temp to file
  delete copying flag
  delete temp
  release file

READER:
  lock file
  if copying flag exists
    copy temp to file
    delete copying flag
    delete temp 
  end
  read file
  release file 
```

这次临时文件由主锁保护，因此它甚至不需要自己的锁。

**编辑 2**

当我说 JVM 崩溃时，我的意思是说电源坏了，而你没有 UPS。

**编辑 3**

我仍然设法犯了另一个错误。您不应该锁定您正在写入或读取的文件。这将导致问题，因为除非您在 Java 中使用 RandomAccessFile，否则您无法同时获得读取和写入锁，它不实现输入/输出流。

相反，您要做的只是锁定一个锁定文件，该锁定文件保护您正在读取或写入的文件。这是更新的算法：

```
WRITER:
  lock
  write temp file
  create copying flag
  copy temp to file
  delete copying flag
  delete temp
  release

READER:
  lock
  if copying flag exists
    copy temp to file
    delete copying flag
    delete temp 
  end
  read file
  release 
```

锁定和释放保护文件、临时文件和复制标志。唯一的问题是现在不能共享读卡器锁，但它永远不可能真正共享。读者总是有机会修改文件，因此一开始就创建一个可共享的锁是错误的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-04-04T17:26:57.073

尽管没有防弹、跨操作系统、跨 FS 解决方案，但“写入唯一临时文件并重命名”策略仍然是您的最佳选择。大多数平台/文件系统都试图使文件重命名（有效地）原子化。请注意，您想使用 +separate+ 锁定文件进行锁定。

所以，假设你想更新“myfile.txt”：

*   锁定“myfile.txt.lck”（这是一个单独的空文件）
*   将更改写入唯一的临时文件，例如“myfile.txt.13424.tmp”（使用`File.createTempFile()`）
*   为获得额外保护，但可能更慢，请在继续 ( ) 之前 fsync 临时文件`FileChannel.force(true)`。
*   将“myfile.txt.13424.tmp”重命名为“myfile.txt”
*   解锁“myfile.txt.lck”

在某些平台（windows）上，由于文件操作的限制，您需要做更多的跳舞（您可以在重命名之前将“myfile.txt”移动到“myfile.txt.old”，并使用“.old”文件恢复如果您在阅读时需要的话）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T19:39:46.600

我不认为有一个完美的答案。我不完全知道您需要做什么，但是您可以写入一个新文件，然后在成功时重命名文件，而不是复制。重命名很快，因此应该不太容易崩溃。如果在重命名阶段失败，这仍然无济于事，但您已将风险窗口降至最低。

同样，我不确定它是否适用或与您的需求相关，但是您能否在文件末尾写一些文件块以显示所有数据已写入？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T22:09:00.137

我假设您有一个不断追加的大文件。虚拟机崩溃并不经常发生。但如果它们发生，您需要一种方法来回滚失败的更改。您只需要一种方法来知道回滚多远。例如，通过将最后一个文件长度写入新文件：

```
WRITER:
  lock file
  write file position to pos-file
  write file
  remove pos-file
  unlock file 
```

如果作者崩溃，您的一位读者将获得读锁。他们必须检查 pos 文件。如果他们找到一个，就会发生崩溃。如果他们查看文件内部，他们知道将更改回滚到多远才能再次获得一致的文件。当然，回滚过程必须以与写入过程类似的方式发生。

当您不是追加而是替换文件时，您可以使用相同的方法：

```
WRITER:
  lock file
  write writing-in-progress-file
  write file
  remove writing-in-progress-file
  unlock file 
```

与以前适用于读者的规则相同。当正在写入的文件存在但读取器已经获得读锁时，写入的文件处于不一致状态。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-04-04T16:26:16.590

如果没有一些操作系统支持，那么在不要求打开文件的程序完成或回滚可能正在进行的操作的情况下，将不可能使任意复杂的文件操作成为原子操作。如果该警告是可以接受的，则可以执行以下操作：

1.  在文件开头附近，不跨越 512 字节边界，包括两个 4 或 8 字节数字（取决于最大文件大小），指示文件的逻辑长度和更新记录的位置（如果有） . 大多数时候更新记录的值为零；写入非零值的行为将提交更新序列；当更新序列完成时，它将被重写为零。
2.  在更新序列开始之前，确定更新序列完成时文件逻辑长度的上限（有一些方法可以绕过这个限制，但它们会增加复杂性）
3.  要开始更新序列，请在文件中寻找其当前逻辑长度或未来逻辑长度（上限）中较大的距离，然后写入更新记录，每个更新记录由文件偏移量、字节数组成要写入，以及要写入的数据。写入执行所有更新所需的尽可能多的此类记录，并以具有 0 偏移量和 0 长度的记录结束。
4.  要提交更新序列，请刷新所有挂起的写入并等待它们完成，然后写入新文件长度和第一条更新记录的位置。
5.  最后，通过依次处理所有更新记录、刷新所有写入并等待其完成来更新文件，并将更新记录位置设置为零，并（可选）将文件截断为其逻辑长度。
6.  如果尝试打开更新序列位置非零的文件，请在执行任何其他操作之前完成执行任何挂起的写入（使用上述最后一步）。

如果在写入更新记录位置之前写入文件的原始操作失败，则所有写入操作都将被有效忽略。如果在写入更新记录位置之后但在清除之前失败，则下次打开文件时将提交所有写入操作（其中一些可能已经执行，但再次执行应该是无害的） . 如果在更新记录位置写入后失败，则文件更新将完成，失败完全不会影响它。

其他一些方法使用单独的文件来保存挂起的写入。在某些情况下，这可能是个好主意，但它的缺点是将文件分成两部分，两部分必须放在一起。仅复制一个文件，或意外配对在不同时间制作的两个文件的副本，可能会导致数据丢失或损坏。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-05-18T13:39:32.053

解决方案：使用 2 个文件并按连续顺序写入它们。
只有 1 次写入会失败。

# java - Java中静态块的线程安全

> ID：462697
> 
> 赞同：41
> 
> 时间：2009-01-20T19:22:26.090
> 
> 标签：java, multithreading, static

假设我有一些 Java 代码：

```
public class SomeClass {
    static {
        private final double PI = 3.14;
        private final double SOME_CONSTANT = 5.76;
        private final double SOME_OTHER_CONSTANT = 756.33;
    }

  //rest of class
} 
```

如果一个线程正在初始化 SomeClass 的`Class`对象，并且正在初始化静态块中的值，而第二个线程想要`Class`再次加载 SomeClass，那么静态块会发生什么？即使第一个线程没有完成，第二个线程是否会忽略它假设它已经初始化？还是发生了其他事情？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-01-20T19:28:40.697

如果第一个线程尚未完成 SomeClass 的初始化，则第二个线程将阻塞。

[这在第 12.4.2 节](http://docs.oracle.com/javase/specs/jls/se7/html/jls-12.html#jls-12.4.2)的 Java 语言规范中有详细说明。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-01-20T19:25:00.453

Java 保证静态类初始化是线程安全的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-21T10:05:49.597

请注意，您不要调用需要锁定正在初始化的类的代码 - 它会死锁。看到这篇博文：[http ://ramblingabout.wordpress.com/2008/04/10/deadlock-quiz-the-answer/](http://ramblingabout.wordpress.com/2008/04/10/deadlock-quiz-the-answer/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-06-12T17:07:37.713

静态块在初始化时始终是线程安全的。这就是为什么使用单例对象的**静态**变量作为创建单例对象的一种方式（单例设计模式）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-06-02T11:51:52.237

> 因为 Java 编程语言是多线程的，所以类或接口的初始化需要仔细同步，因为其他一些线程可能试图同时初始化同一个类或接口

引用自[Java 语言规范](https://docs.oracle.com/javase/specs/jls/se7/html/jls-12.html#jls-12.4.2)

# c# - How to correctly use .NET2.0 serial port .BaseStream for async operation

> ID：462698
> 
> 赞同：15
> 
> 时间：2009-01-20T19:22:28.743
> 
> 标签：c#, asynchronous, stream, serial-port, operation

I am attempting to use the .BaseStream property of the .NET2.0 SerialPort to do asynchronous reads and writes (BeginWrite/EndWrite, BeginRead/EndRead).

I am having some success in this, but after a time, I notice (using Process Explorer) a very gradual increase in the Handles the app is using, and occasionally an extra thread, which also increases the Handle count.

The context switch rate also increases each time a new thread appears.

The app constantly sends 3 bytes to a PLC device, and gets 800 or so bytes in return, and does so at a baud rate of 57600.

The initial CSwitch Delta (again, from Process Explorer) is around 2500, which seems very high anyway. Each time a new thread appears, this value increases, and the CPU load increases accordingly.

I'm hoping that somebody might have done something similar, and can help me out, or even say 'In God's name, don't do it that way.'

In the code below, 'this._stream' is obtained from SerialPort.BaseStream, and CommsResponse is a class I use as the IAsyncresult state object.

This code is common to a TCP connection I make as an alternative to using the serial port, (I have a CommsChannel base class, with a serial and TCP channel derived from it) and it has none of these problems so I'm reasonably hopeful that there is nothing wrong with the CommsResponse class.

Any comments gratefully received.

```
 /// <summary>
    /// Write byte data to the channel.
    /// </summary>
    /// <param name="bytes">The byte array to write.</param>
    private void Write(byte[] bytes)
    {
        try
        {
            // Write the data to the port asynchronously.
            this._stream.BeginWrite(bytes, 0, bytes.Length, new AsyncCallback(this.WriteCallback), null);
        }
        catch (IOException ex)
        {
            // Do stuff.
        }
        catch (ObjectDisposedException ex)
        {
            // Do stuff.
        }
    }

    /// <summary>
    /// Asynchronous write callback operation.
    /// </summary>
    private void WriteCallback(IAsyncResult ar)
    {
        bool writeSuccess = false;

        try
        {
            this._stream.EndWrite(ar);
            writeSuccess = true;
        }
        catch (IOException ex)
        {
            // Do stuff.
        }

        // If the write operation completed sucessfully, start the read process.
        if (writeSuccess) { this.Read(); }
    }

    /// <summary>
    /// Read byte data from the channel.
    /// </summary>
    private void Read()
    {
        try
        {
            // Create new comms response state object.
            CommsResponse response = new CommsResponse();

            // Begin the asynchronous read process to get response.
            this._stream.BeginRead(this._readBuffer, 0, this._readBuffer.Length, new AsyncCallback(this.ReadCallback), response);
        }
        catch (IOException ex)
        {
            // Do stuff.
        }
        catch (ObjectDisposedException ex)
        {
            // Do stuff.
        }
    }

    /// <summary>
    /// Asynchronous read callback operation.
    /// </summary>
    private void ReadCallback(IAsyncResult ar)
    {
        // Retrieve the comms response object.
        CommsResponse response = (CommsResponse)ar.AsyncState;

        try
        {
            // Call EndRead to complete call made by BeginRead.
            // At this point, new data will be in this._readbuffer.
            int numBytesRead = this._stream.EndRead(ar);

            if (numBytesRead > 0)
            {
                // Create byte array to hold newly received bytes.
                byte[] rcvdBytes = new byte[numBytesRead];

                // Copy received bytes from read buffer to temp byte array
                Buffer.BlockCopy(this._readBuffer, 0, rcvdBytes, 0, numBytesRead);

                // Append received bytes to the response data byte list.
                response.AppendBytes(rcvdBytes);

                // Check received bytes for a correct response.
                CheckResult result = response.CheckBytes();

                switch (result)
                {
                    case CheckResult.Incomplete: // Correct response not yet received.
                        if (!this._cancelComm)
                        {
                            this._stream.BeginRead(this._readBuffer, 0, this._readBuffer.Length,
                                new AsyncCallback(this.ReadCallback), response);
                        }
                        break;

                    case CheckResult.Correct:  // Raise event if complete response received.
                        this.OnCommResponseEvent(response);
                        break;

                    case CheckResult.Invalid: // Incorrect response
                        // Do stuff.
                        break;

                    default: // Unknown response
                        // Do stuff.
                        break;
                }
            }
            else
            {
                // Do stuff.
            }
        }
        catch (IOException ex)
        {
            // Do stuff.
        }
        catch (ObjectDisposedException ex)
        {
            // Do stuff.
        }
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-23T13:27:05.337

一些建议：

由于您只发送 3 个字节，因此您可以进行同步写入操作。延迟不会是什么大问题。

也不要一直创建新的 AsyncCallback。创建一个 Read 和一个 Write AsyncCallback 并在每个 begin 调用中使用它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-24T04:02:00.533

根本不需要 BeginWrite。您只发送 3 个字节，它们很容易放入传输缓冲区，并且当您发送下一组时，您始终确定缓冲区是空的。

请记住，串行端口比 TCP/IP 连接慢得多。您很可能最终会为收到的每个字节调用 BeginRead()。这给了线程池一个很好的锻炼，你肯定会看到很多上下文切换。不太确定手柄消耗。确保在没有附加调试器的情况下进行测试。

尝试使用 DataReceived 而不是 BeginRead() 绝对是您应该尝试的。拉而不是推，当发生某些事情时，您将使用线程池线程，而不是始终让一个线程处于活动状态。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-26T20:13:30.963

是否可以将串口传入的数据直接发送到文件中？在高波特率（1 兆波特）下，很难处理这么多的不间断数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-30T20:36:47.023

设备的响应是否总是固定大小？如果是这样，请尝试使用[`SerialPort.Read`](http://msdn.microsoft.com/en-us/library/ms143549%28v=VS.80%29.aspx)并传递数据包大小。这将阻塞，因此将其与`DataReceived`. 更好的是，如果响应总是以相同的字符结束，并且这个结束签名保证在数据包中是唯一的，那么设置[`NewLine`](http://msdn.microsoft.com/en-US/library/system.io.ports.serialport.newline%28v=VS.80%29.aspx)属性并使用`ReadLine`. 这将使您免受未来数据包大小变化的影响。

# c# - 如何使用 LINQ 获取数组中最大值的索引？

> ID：462699
> 
> 赞同：29
> 
> 时间：2009-01-20T19:23:04.560
> 
> 标签：c#, linq

我有一个双精度数组，我想要最大值的索引。这些是我迄今为止提出的解决方案，但我认为必须有一个更优雅的解决方案。想法？

```
double[] score = new double[] { 12.2, 13.3, 5, 17.2, 2.2, 4.5 };
int topScoreIndex = score.Select((item, indx) => new {Item = item, Index = indx}).OrderByDescending(x => x.Item).Select(x => x.Index).First();

topScoreIndex = score.Select((item, indx) => new {Item = item, Index = indx}).OrderBy(x => x.Item).Select(x => x.Index).Last();

double maxVal = score.Max();
topScoreIndex = score.Select((item, indx) => new {Item = item, Index = indx}).Where(x => x.Item == maxVal).Select(x => x.Index).Single(); 
```

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-02-12T19:17:57.723

嗯，为什么要让它过于复杂？这是最简单的方法。

```
var indexAtMax = scores.ToList().IndexOf(scores.Max()); 
```

是的，您可以创建一个扩展方法来使用更少的内存，但除非您正在处理巨大的数组，否则您*永远不会*注意到差异。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2009-01-20T19:27:17.780

我建议编写自己的扩展方法（编辑为带有`IComparable<T>`约束的通用方法。）

```
public static int MaxIndex<T>(this IEnumerable<T> sequence)
    where T : IComparable<T>
{
    int maxIndex = -1;
    T maxValue = default(T); // Immediately overwritten anyway

    int index = 0;
    foreach (T value in sequence)
    {
        if (value.CompareTo(maxValue) > 0 || maxIndex == -1)
        {
             maxIndex = index;
             maxValue = value;
        }
        index++;
    }
    return maxIndex;
} 
```

请注意，如果序列为空，则返回 -1。

说一下特点：

*   这适用于只能枚举一次的序列 - 这有时可能非常重要，并且通常是 IMO 的理想功能。
*   内存复杂度为 O(1)（与排序的 O(n) 相反）
*   运行时复杂度为 O(n)（与 O(n log n) 排序相反）

至于这是否“是 LINQ”：如果它已被包含为标准 LINQ 查询运算符之一，您会将其视为 LINQ 吗？它是不是感觉特别陌生或与其他 LINQ 运算符不同？如果 MS 将它作为新的运算符包含在 .NET 4.0 中，它会是 LINQ 吗？

编辑：如果您真的非常非常想使用 LINQ（而不仅仅是获得一个优雅的解决方案），那么这里仍然是 O(n) 并且只评估一次序列：

```
int maxIndex = -1;
int index=0;
double maxValue = 0;

int urgh = sequence.Select(value => {
    if (maxIndex == -1 || value > maxValue)
    {
        maxIndex = index;
        maxValue = value;
    }
    index++;
    return maxIndex;
 }).Last(); 
```

这很可怕，我不建议你使用它——但它会起作用。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-01-20T19:28:48.870

```
var scoreList = score.ToList();
int topIndex =
    (
      from x
      in score
      orderby x
      select scoreList.IndexOf(x)
    ).Last(); 
```

如果`score`不是一个数组，这还不错......

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-10-13T20:18:29.773

这不是唯一的基于聚合的解决方案，但这实际上只是一个单行解决方案。

```
double[] score = new double[] { 12.2, 13.3, 5, 17.2, 2.2, 4.5 };

var max = score.Select((val,ix)=>new{val,ix})
               .Aggregate(new{val=Double.MinValue,ix=-1},(z,last)=>z.val>=last.val?z:last);

Console.WriteLine ("maximum value is {0}", max.val );
Console.WriteLine ("index of maximum value is {0}", max.ix ); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-03-25T15:11:53.447

试试这个完全是 LINQ 并且性能最好的：

```
var indexAtMax = scores.Select((x, i) => new { x, i })
            .Aggregate((a, a1) => a.x > a1.x ? a : a1).i; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-11-24T22:07:33.443

我今天遇到了这个问题（在年龄最高的用户数组中获取索引），我这样做了：

```
var position = users.TakeWhile(u => u.Age != users.Max(x=>x.Age)).Count(); 
```

它在 C# 类上，所以它的菜鸟解决方案，我相信你的更好:)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-11-16T18:52:02.797

`System.Linq.Enumerable.Select`带索引，并`System.Linq.Enumerable.Aggregate`会在一行中完成

```
public static int IndexOfMax<TSource>(this IEnumerable<TSource> source)
    where TSource : IComparable<TSource> => source.Select((value, idx) => (value, idx))
    .Aggregate((aggr, next) => next.value.CompareTo(aggr.value) > 0 ? next : aggr).idx; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-10T05:01:56.407

最糟糕的可能复杂度是 O(2N) ~= O(N)，但它需要枚举集合两次。

```
 void Main()
{
    IEnumerable<int> numbers = new int[] { 1, 2, 3, 4, 5 };

    int max = numbers.Max ();
    int index = -1;
    numbers.Any (number => { index++; return number == max;  });

    if(index != 4) {
        throw new Exception("The result should have been 4, but " + index + " was found.");
    }

    "Simple test successful.".Dump();
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-02-25T13:59:04.117

如果您想要看起来 LINQy 的东西，因为它纯粹是功能性的，那么 Jon Skeets 上面的答案可以改写为：

```
public static int MaxIndex<T>(this IEnumerable<T> sequence) where T : IComparable<T>
    {
        return sequence.Aggregate(
            new { maxIndex = -1, maxValue = default(T), thisIndex = 0 },
            ((agg, value) => (value.CompareTo(agg.maxValue) > 0 || agg.maxIndex == -1) ?
                             new {maxIndex = agg.thisIndex, maxValue = value, thisIndex = agg.thisIndex + 1} :
                             new {maxIndex = agg.maxIndex, maxValue = agg.maxValue, thisIndex = agg.thisIndex + 1 })).
            maxIndex;
    } 
```

这与另一个答案具有相同的计算复杂性，但更浪费内存，为可枚举的每个元素创建一个中间答案。

# javascript - 如何在 onchange() 事件后调用的方法中将焦点设置到输入字段？

> ID：462705
> 
> 赞同：1
> 
> 时间：2009-01-20T19:23:43.000
> 
> 标签：javascript, javascript-events

在验证输入字段后，我遇到了将焦点设置到输入字段的问题。

我有 2 个字段：from 和 to。

```
 <spring:message code="template.fields.label.from"/>: 
       <mvc:input  path="templateFields.selectorRangeFrom" 
       onchange="validateNumber('templateFields.selectorRangeFrom',true)"/>
   <spring:message code="template.fields.label.to"/>: 
      <mvc:input path="templateFields.selectorRangeTo"   
     onchange="validateNumber('templateFields.selectorRangeTo',true)"/> 
```

我有方法 validateNumber() 验证字段并在字段无效时返回 false，否则返回 true。但是焦点永远不会停留在无效数字上，它总是会转到下一个对象。

```
function validateNumber(index,isInteger) {
 var object = document.getElementById(index);
 var value = object.value;   
 if (testNumeric2(value,isInteger)==false)   {
     alert('Please correct the value: ' + value);               
     object.focus();
     object.select();
     return false;  
 } 
return true;    
 } 
```

我发现如果我添加：event.returnValue=false（在返回 false 之前），那么它适用于 IE。但我找不到 Firefox 的解决方案。

感谢您的任何建议，马塔利

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-20T20:04:53.977

**setTimeout()**允许您将函数的执行推迟几毫秒 - 如果您使用零，这只是意味着，“一旦您完成了您现在正在做的任何事情，就执行此操作” – 处理事件，在你的情况下。

试试这个：

```
if (! /** check field **/) {
   /** show error **/
   setTimeout((function() { object.focus() }), 0);
} 
```

基本上，您将创建一个专注于输入框的函数，然后指示浏览器在完成事件的默认处理后立即调用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T19:46:11.173

我不确定为**onChange**返回 false应该是什么意思。如果您只想重新关注问题区域，我建议您通过**setTimeout()**调用来执行此操作（您必须在输入元素周围创建一个闭包）。

这样，当您尝试聚焦文本框时，事件处理将完成。

作为旁注，我还建议您不要使用**alert()**来通知用户错误，因为它很刺耳，并且会在许多 Windows 系统上导致刺耳的意外声音。在故障控制旁边显示一个图标或在故障控制周围显示一个红色边框可能是对待用户更好的方式。

# opengl - 渲染到立方体贴图

> ID：462721
> 
> 赞同：12
> 
> 时间：2009-01-20T19:26:10.747
> 
> 标签：opengl, glsl, fbo

根据[ARB_geometry_shader4](http://www.opengl.org/registry/specs/ARB/geometry_shader4.txt)，可以使用几何着色器将场景渲染到立方体贴图的 6 个面上，并将立方体贴图附加到帧缓冲区对象。我想用这种方式创建一个阴影贴图。但是，似乎有一个我无法解决的冲突：

1.  我只能将 GL_DEPTH_COMPONENT 作为内部类型的纹理附加到 GL_DEPTH_ATTACHMENT_EXT。
2.  深度纹理只能是 1D 或 2D。
3.  如果我想附加一个立方体贴图，所有其他附加的纹理也必须是立方体贴图。

因此，当我想渲染到立方体贴图时，看起来我不能使用任何深度测试。或者我到底在这里想念什么？

**编辑：**看起来较新的 Nvidia 驱动程序 (180.48) 支持深度立方体贴图。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-30T15:34:26.623

好的，在这里回答一些其他问题：

当然可以使用 6 个 FBO，每个面一个。或者使用一个 FBO 并在绘制之前附加每个面。在这两种情况下，立方体贴图面将被视为任何其他 2D 纹理，您可以将其与普通 2D 纹理或渲染缓冲区一起使用。并且所有可能的方式可能没有太大区别（如果硬件支持它们）。

但是，也可以一步绘制所有内容，因为我很好奇这是如何完成的，所以我做了一些研究。

要创建一个将立方体贴图的所有面都附加到单个连接点的 FBO，我使用了以下代码（用 D 编写）：

```
// depth cube map
glGenTextures(1, &tDepthCubeMap);
glBindTexture(GL_TEXTURE_CUBE_MAP, tDepthCubeMap);
glTexParameterf(GL_TEXTURE_CUBE_MAP, GL_TEXTURE_MIN_FILTER, GL_LINEAR);
glTexParameterf(GL_TEXTURE_CUBE_MAP, GL_TEXTURE_MAG_FILTER, GL_LINEAR);
glTexParameterf(GL_TEXTURE_CUBE_MAP, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);
glTexParameterf(GL_TEXTURE_CUBE_MAP, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);
glTexParameterf(GL_TEXTURE_CUBE_MAP, GL_TEXTURE_WRAP_R, GL_CLAMP_TO_EDGE);
for (uint face = 0; face < 6; face++) {
    glTexImage2D(GL_TEXTURE_CUBE_MAP_POSITIVE_X + face, 0, GL_DEPTH_COMPONENT24,
        width, height, 0, GL_DEPTH_COMPONENT, GL_FLOAT, null);
}

// color cube map
glGenTextures(1, &tColorCubeMap);
glBindTexture(GL_TEXTURE_CUBE_MAP, tColorCubeMap);
glTexParameterf(GL_TEXTURE_CUBE_MAP, GL_TEXTURE_MIN_FILTER, GL_LINEAR);
glTexParameterf(GL_TEXTURE_CUBE_MAP, GL_TEXTURE_MAG_FILTER, GL_LINEAR);
glTexParameterf(GL_TEXTURE_CUBE_MAP, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);
glTexParameterf(GL_TEXTURE_CUBE_MAP, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);
glTexParameterf(GL_TEXTURE_CUBE_MAP, GL_TEXTURE_WRAP_R, GL_CLAMP_TO_EDGE);
for (uint face = 0; face < 6; face++) {
    glTexImage2D(GL_TEXTURE_CUBE_MAP_POSITIVE_X + face, 0, GL_RGBA,
        width, height, 0, GL_RGBA, GL_FLOAT, null);
}

// framebuffer object
glGenFramebuffersEXT(1, &fbo);
glBindFramebufferEXT(GL_FRAMEBUFFER_EXT, fbo);
glFramebufferTextureARB(GL_FRAMEBUFFER_EXT, GL_DEPTH_ATTACHMENT_EXT, tDepthCubeMap, 0);
glFramebufferTextureARB(GL_FRAMEBUFFER_EXT, GL_COLOR_ATTACHMENT0_EXT, tColorCubeMap, 0);

glDrawBuffer(GL_COLOR_ATTACHMENT0_EXT);

if (!isValidFBO()) {
    glDeleteFramebuffersEXT(1, &fbo);
    fbo = 0;
} 
```

*   如果你只想有一个深度图，你必须改变*glDrawBuffer(GL_COLOR_ATTACHMENT0_EXT);* 到*glDrawBuffer(GL_NONE);* 在验证它之前（以及在绘制它之前）
*   MIN 和 MAG 过滤器必须设置为有效值（默认为 GL_NEAREST_MIPMAP_LINEAR）
*   所有纹理的宽度和高度必须相同

要渲染到立方体贴图的面，您需要一个几何着色器。以下着色器错过了一些旋转，但应该清楚它的作用。gl_Layer 用于将图元引导到正确的面（0 = +X，1 = -X，...）。

```
#version 120
#extension GL_EXT_geometry_shader4 : enable

void main(void) {
    int i, layer;
    for (layer = 0; layer < 6; layer++) {
        gl_Layer = layer;
        for (i = 0; i < 3; i++) {
            gl_Position = gl_PositionIn[i];
            EmitVertex();
        }
        EndPrimitive();
    }
} 
```

# sql - 生产系统中的动态 SQL

> ID：462724
> 
> 赞同：3
> 
> 时间：2009-01-20T19:26:57.953
> 
> 标签：sql

SO 有很多关于如何使用动态 SQL 完成各种任务的 Q&A，回复通常伴随着关于实际使用所提供方法的可取性的警告和免责声明。我曾在从“知道如何使用游标是一个坏兆头”到“sp_executesql 不整洁！”的环境中工作过。

当涉及到生产系统时，应该始终避免使用动态 sql，或者它应该在编程工具箱中占有一席之地。如果不是/如此，为什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-20T19:29:42.067

您的一些问题的答案可以在这里找到[动态 SQL 的诅咒和祝福](http://www.sommarskog.se/dynamic_sql.html)

有时您必须使用动态 SQL，因为它会执行得更好

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T19:32:52.560

这取决于动态 sql 的含义。将参数值直接替换到 sql 字符串中的查询是危险的，应该避免，除非在极少数情况下没有其他选项。

使用平台支持的适当参数化查询机制的动态 SQL 可能非常强大。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-20T20:21:00.497

评估动态 SQL 的使用时有几个注意事项：

*   性能可能会有很大差异，并且特定于针对哪个数据库引擎
*   维护可以在两个方向上大相径庭（例如，动态 SQL 可以采用静态 SQL 不能采用的模块化技术）
*   动态 SQL 容易受到 SQL 注入攻击，但静态 SQL（大多数情况下）不会
*   有时您的需求使静态 SQL（几乎）不可能，但这应该很少见

请记住，SQL 是代码，RDBMS 是另一个 API。它并不特别，或者至少不多；像处理任何其他代码和 API 一样处理它。特别是，不要只针对 API 直接编写代码：模块化您的代码并编写一些辅助方法以使其更容易和可重用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T19:48:30.967

“动态 SQL”的成本因 DBMS 而异。

*   在 IBM DB2 中，查询计划可以预编译为机器代码，动态 SQL 的成本很高。

*   在 IBM Informix (IDS - Informix Dynamic Server) 中，大多数查询实际上是“动态 SQL”（存储过程中的查询除外），因为 SQL 是在运行时解释的，即使客户端表示法使用静态 SQL。

我相信——尽管 DB2 专家可能会反驳我——用于 DB2 的 CLI（ODBC，又名 CCC）和 JCC（JDBC）系统将所有 SQL 都作为动态 SQL 执行。

我不知道 Oracle、Sybase、MS SQL Server 做了什么——我怀疑它们更接近 IDS 采用的线路而不是 DB2 采用的线路。对于 MySQL 和 PostgreSQL，如果它们的行为不像 DB2 那样更像 IDS，我会感到惊讶。

因此，对于 IDS，使用动态 SQL 没有特别的开销；在服务器级别，您的 SQL 无论如何都是动态的。其他 DBMS 可能还有其他因素在起作用。

所有服务器的一个问题是“如何从通过网络发送的 SQL 中识别预编译查询”。对于 DB2，预编译器识别所使用的包，应用程序和服务器之间的通信协议识别它。我的理解是 ODBC 和 JDBC 等 DB2 客户端不使用预编译包——因此我认为它们一直有效地执行动态 SQL。

小心使用动态 SQL 进行 SQL 注入！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-20T19:28:54.813

我以前的商店永远不会允许对数据库（SQL Server）执行这样的事情。它被禁止作为实践，并且数据库被锁定以防止它。所有工作都通过对象（SP 等）。

恕我直言，这是始终正确的做法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-20T19:32:58.737

在某些极端情况下，动态 SQL 比替代方法更容易和更快。只要您保持它们的数量很少而且它们之间的距离很远，并且它们是动态生成的准备好的参数化 SQL，我认为它们没有什么大问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-20T20:00:44.373

动态 SQL 有一席之地——甚至在生产代码中。执行带有安全漏洞的任意代码不会。

一般来说，如果没有充分的理由使用动态 SQL，我会避免使用它。动态 SQL 在运行之前不会被检查，因此您显然有更大的测试负担。但是，在处理管理任务、静态代码生成、适应不断变化的系统而无需基于查询元数据的过度维护、使用 DRY 避免冗余等时，有很多好时机使用它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-20T20:26:29.533

我认为我们的系统中有很多动态 SQL，主要是因为我们有很多动态创建的*对象*（主要是表、索引、视图）。其中很多是遗产。诸如 2k5 中的分区表之类的东西在我们的一些用例中有所帮助。但是如前所述，您需要为此做好充分的准备；procs 中的 on-the-fly SQL 通常有更好的（静态）解决方案。

# c# - 在 Server 2003 上安装 Word 2003 插件

> ID：462735
> 
> 赞同：1
> 
> 时间：2009-01-20T19:28:49.477
> 
> 标签：c#, ms-word, ms-office, vsto, add-in

我已经把别人的一堆东西交给我了。在这些项目中，有一个 Word 2003 加载项（VSTO 2005 SE、.NET 2.0），据报道它在 2007 年运行良好，但我们的部署环境需要 2003 年。它对于 Office 2003 的安装显然很好——没有错误，显示在添加/删除中 - 但工具栏在 Word 本身中不可用。

据说这在某人的测试环境中运行良好，但我从未见过它在我们常见的开发环境中运行。我们有一个包含 MSI 和 setup.exe 的设置/部署项目。（我尝试在 CAB 中打包东西以防万一，我已经尝试过独立安装 prereqs，没有明显区别。）

MSI，setup.exe，在 Visual Studio 中右键单击安装 setup/deploy 项目，这些方法都没有报告错误——但这些方法都没有成功在 Server 2003 上的 Word 2003 中显示工具栏。但是，如果我将 Visual Studio 指向 winword.exe 进行调试并启动项目，则会显示加载项按钮。它继续出现在后来的独立客户初创公司中。在我通过添加/删除或右键单击卸载或运行 MSI 并删除显式删除它之前，它仍可作为工具栏使用。

所以现在我不知所措——在典型的设置/部署安装期间没有发生的调试中运行会发生什么？

编辑：好的，更新。为 Word 2003 创建了一个干净的 VSTO 2005 加载项，新的加载项名称，干净的石板。在 Server 2003 和 XP Pro 上，裸项目、virgin registry 也会遇到相同的行为。我是 XP 的本地管理员，我是 2003 机器上的域管理员。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T19:36:46.687

以下是一些故障排除问题：

*   您正在开发什么样的插件？共享加载项还是 VSTO？如果VSTO是哪个版本？
*   您使用的是什么操作系统？Vista可能很棘手...
*   在注册表中检查加载项的 LoadBehavior。您可以在

    ```
    HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\Word\Addins\<add-in class name>\ 
    ```

    或者

    ```
    HKEY_CURRENT_USER\SOFTWARE\Microsoft\Office\Word\Addins\<add-in classname>\ 
    ```

如果 LoadBehavior 的值为 2，则您的加载项在启动期间已被禁用。当 Word 无法实例化加载项时会发生这种情况，通常是因为加载项引发未处理的异常，或者 - 更常见的是 - 因为加载项未正确注册。

您是否检查过目标系统上是否正确安装了 VSTO 运行时？

但是，即使您使用 VSTO，对于 Word，该插件仍然看起来像一个经典的 COM 插件，它扩展了经典的 IDTExtensibility2 接口。此类加载项必须通过以下方式注册：

*   上面两个注册表项之一，用于告诉 Word 加载项的类名以及加载行为和描述等附加信息
*   加载项的类名必须注册在

    ```
    HKEY_CLASSES_ROOT\<add-in classname>\CSLID 
    ```

*   必须在下面注册正确版本的 COM 组件（其中 {xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx} 是在 HKEY_CLASSES_ROOT\\CSLID 下指定的组件的 guid）：

    ```
    HKEY_CLASSES_ROOT\CLSID\{xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx} 
    ```

以下两个链接也可以帮助您进一步缩小问题范围：

> [HOWTO：对 Visual Studio 和 Office 加载项进行故障排除](http://www.mztools.com/articles/2007/MZ2007009.aspx)
> 
> [Outlook COM 插件疑难解答 - 使用 ProcMon](http://blogs.msdn.com/dvespa/archive/2008/10/15/troubleshooting-outlook-com-addins-using-procmon.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-22T18:50:11.333

编辑：对加载项程序集的完全信任最终成为修复。似乎没有比完全信任低的任何东西运行。

//

最终向 Microsoft 开了一张票，他们向我介绍了 VSTO_SUPPRESSDISPLAYALERTS：

[http://msdn.microsoft.com/en-us/library/ms269003(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms269003(VS.80).aspx)

该值默认为 1；将其设置为 0 会提供一个弹出对话框，否则会被掩埋。

仍在研究细节，我将继续更新此线程，但现在我们终于有了前进的基础：

```
Could not load file or assembly 'PrintTest2007, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' or one of its dependencies. Failed to grant permission to execute. (Exception from HRESULT: 0x80131418)

************** Exception Text **************
System.IO.FileLoadException: Could not load file or assembly 'PrintTest2007, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' or one of its dependencies. Failed to grant permission to execute. (Exception from HRESULT: 0x80131418)
File name: 'PrintTest2007, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' ---> System.Security.Policy.PolicyException: Execution permission cannot be acquired.
   at System.Security.SecurityManager.ResolvePolicy(Evidence evidence, PermissionSet reqdPset, PermissionSet optPset, PermissionSet denyPset, PermissionSet& denied, Boolean checkExecutionPermission)
   at System.Security.SecurityManager.ResolvePolicy(Evidence evidence, PermissionSet reqdPset, PermissionSet optPset, PermissionSet denyPset, PermissionSet& denied, Int32& securitySpecialFlags, Boolean checkExecutionPermission)
   at Microsoft.VisualStudio.Tools.Applications.Runtime.AppDomainManagerInternal.HandleOnlineOffline(Exception e, String basePath, String filePath)
   at Microsoft.VisualStudio.Tools.Applications.Runtime.AppDomainManagerInternal.LoadStartupAssembly(EntryPoint entryPoint, Dependency dependency, Dictionary`2 assembliesHash)
   at Microsoft.VisualStudio.Tools.Applications.Runtime.AppDomainManagerInternal.ConfigureAppDomain()
   at Microsoft.VisualStudio.Tools.Applications.Runtime.AppDomainManagerInternal.LoadAssembliesAndConfigureAppDomain(IHostServiceProvider serviceProvider)
   at Microsoft.VisualStudio.Tools.Applications.Runtime.AppDomainManagerInternal.LoadEntryPointsHelper(IHostServiceProvider serviceProvider) 
```

# html - 关闭斜线之前的空间？

> ID：462741
> 
> 赞同：106
> 
> 时间：2009-01-20T19:30:23.717
> 
> 标签：html, xml, xhtml, coding-style

我经常看到 XML 和 HTML 标记中的右斜杠前面有一个空格。XHTML 换行符可能是典型的例子：

```
<br /> 
```

代替：

```
<br/> 
```

空间似乎是多余的。事实上，我认为这是多余的。

**写这个空间的原因是什么？**

我读过该空间解决了一些“向后兼容性问题”。哪些向后兼容性问题？这些问题是否仍然相关，或者我们是否仍然为了 IE3 兼容性而添加额外的空格？是否存在一些对此有明确答案的规范？

如果不是向后兼容性，那么它是可读性问题吗？类似于大括号大括号辩论？

```
void it_goes_up_here() {

int no_you_fool_it_goes_down_there()
{ 
```

我当然可以尊重不同的风格观点，所以我很高兴得知写空间只是一个品味问题。

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2009-01-20T20:37:49.807

答案是人们希望遵守[XHTML1.0 规范的附录](http://www.w3.org/TR/xhtml1/#guidelines)C。[仅当您将XHTML 作为 text/html 提供](http://www.w3.org/TR/xhtml1/#media)时，您才需要这样做。大多数人都会这样做，因为 XHTML 的真正 MIME 类型（application/html+xml）在 Internet Explorer 中不起作用。

当前没有浏览器关心这个空间。浏览器对这些东西非常宽容。

用于确保 HTML 解析器将尾部斜杠视为无法识别的属性所需的空间。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2015-06-17T00:24:01.300

[![Netscape 4.80 在 HTML 中显示 <br/> 和 <br /> 的不同行为](https://i.stack.imgur.com/MYnJO.png)](https://i.stack.imgur.com/MYnJO.png)

用显示文档的**Netscape 4.80**屏幕截图支持[bobince 的回答](https://stackoverflow.com/a/463692/540955)

 **```
data:text/html,<title>space</title>foo<br />bar 
```

（左上角，换行渲染）和

```
data:text/html,<title>no space</title>foo<br/>bar 
```

（左下角，忽略换行符）。

* * *

发布为答案以显示图片

切线相关：事实上，我有一个冗长的答案，在被误解的 SGML 规范，即[SGML Null End Tag ( *NET* )](https://en.wikipedia.org/wiki/Standard_Generalized_Markup_Language#NET)中确定了古代浏览器这种不当行为的原因（以及由此产生的包含空格的建议） （其中`1<tag/2/3`等于实际上意味着），`1<tag>2</tag>3`但是我不仅找不到好的证据和具体的标准版本，我什至无法掌握正确的符合标准的行为。可供参考的原始链接很少：`1<tag/>2``1<tag>>2`

*   [w3c 验证器通知提到有问题的结束斜线](https://validator.w3.org/docs/errors.html#ve-63)并指向
*   [SGML、HTML、XML 和 XHTML 中的空元素 @ www.cs.tut.fi/~jkorpela/](http://www.cs.tut.fi/~jkorpela/html/empty.html)
*   [当心 XHTML：Null End Tags (NET)](http://www.webdevout.net/articles/beware-of-xhtml#net)声明，即

    > 但是，仍然有一些较小的用户代理可以正确支持 Null End Tags。支持它的最著名的用户代理之一是 W3C 验证器。

（现在无法在那里重现，但支持 Lee Kowalkowski 关于受此影响的多个浏览器的声明。）

*   [XML W3C 工作草案 07-Aug-97](http://www.w3.org/TR/WD-xml-970807.html) - 最新的规范草案，包括在 DTD 片段中引用 Null End Tag：`NET "/>"`

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2009-01-21T00:28:12.900

> 这些问题是否仍然相关，或者我们是否仍然为了 IE3 兼容性而添加额外的空格？

你很接近 - 它适用于 Netscape 4。

看到其他合理化很有趣，但这就是它的全部目的。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-20T19:47:43.013

不，空间不是必需的，但某些旧浏览器需要正确呈现这些标签。做到这一点的正确方法是没有额外的空间，因为这是 XHTML 从 XML 继承的东西。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-20T20:07:56.153

该空间只是使标签更具可读性。我非常支持格式化以获得更易读的代码。像这样的小事情有很长的路要走。没有空格，结束标签与开始标签混合在一起。因为我正在快速阅读代码，所以处理它只需要一点时间。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-20T19:44:49.070

在 XHTML 中，br 标记必须闭合，[但空格不是必需的](http://www.w3.org/TR/xhtml1/#h-4.6)。这是一个风格问题。在 HTML 中，br 标签不能关闭，所以两者都是错误的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-20T19:35:40.213

我认为留白是强化标签为空且会自行关闭的想法的一种方式。

今天我不再使用空白，因为我从来没有遇到过没有空白的问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-06-16T14:59:22.457

如果那里有一个非常懒惰的 html 作家，或者他害怕引号怎么办。如果您是他的机器人页面爬虫，请考虑以下内容...

`<img src=http://myunquotedurl.com/image.jpg />`

相对

`<img src=http://myunquotedurl.com/image.jpg/>`

这可能看起来很小，但如果没有空间，看看它可以做什么。机器人不知道斜线是 url 的一部分还是结束标记的一部分。

# iis - 使用 AQTime 分析经典 ASP 应用程序

> ID：462742
> 
> 赞同：1
> 
> 时间：2009-01-20T19:30:26.417
> 
> 标签：iis, asp-classic, profiling, jscript, aqtime

我们已经开发了大量使用 ASP（jscript 风格）的网站，通过 COM 与底层智能层（用 Delphi 编写）对话。这些网站在 IIS（5 和 6）上运行。

多年来，这个 ASP 层已经变得相当繁重（没有业务逻辑，但有很多控制器/场景/视图/ajax/等处理），我们想对其进行一些性能调整。根据创建者的说法，AQTime（我们有最新版本）可用于此目的（一次性分析服务器端脚本和底层 com 对象），但我根本不知道如何让它工作。

帮助文件解释了如何分析 COM dll、ISAPI dll 甚至客户端脚本，但没有说明如何分析在 ASP 页面上运行的服务器端脚本。无法选择 .asp 文件作为“分析模块”。谷歌也没有帮助。

关于如何做到这一点的任何建议？也欢迎分析经典 asp 页面的替代建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-03T07:06:38.423

好吧，事实证明，**这是不可能的**（根据官方支持）。在我们的应用程序中的树层中，

1.  在服务器上运行的 Delphi 代码
2.  在服务器上运行的 ASP 代码 (jscript)
3.  在客户端上运行的客户端 jscript（ajax 等）

AQTime 只能分析 (1) 和 (3)。虽然它可以很好地剖析服务器上的 windows 脚本宿主 .js 文件，但它不会剖析 .asp 代码。我真的希望它会，看看两者是如何通过相同的 jscript.dll 执行的。

# unit-testing - 单元测试...应该在这里使用吗？

> ID：462743
> 
> 赞同：2
> 
> 时间：2009-01-20T19:30:38.833
> 
> 标签：unit-testing, data-analysis, scientific-software

**重复**：[https ://stackoverflow.com/questions/135651/learning-unit-testing](https://stackoverflow.com/questions/135651/learning-unit-testing)

* * *

我正在尝试为我的研究小组开发一些软件来分析和绘制实验数据。我想让它完全没有错误。这会是*单元测试*的情况吗？如果是这样，您能否为我指出一些很好的单元测试参考资料？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-20T19:33:40.310

几乎任何代码都是单元测试的好候选；它将帮助您记录代码的意图，并证明您的代码按预期工作。在将代码发布给团队的其他成员之前，它肯定会帮助您找到错误。你没有说你正在使用什么平台，所以我不能推荐一个测试框架，但我可以推荐 Kent Beck 的优秀[*测试驱动开发：通过示例*](https://rads.stackoverflow.com/amzn/click/com/0321146530)作为一个很好的一般起点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T19:39:40.190

根据我的经验，单元测试对于任何与 UI 无关的功能（例如“如果它是负值，则显示为红色的数字”）是一个好主意，可以帮助您尽早发现错误。因此，我建议尽可能编写单元测试（并让它们自动运行，例如每晚或什至在每次构建之后，以查看是否有一些新代码破坏了任何东西）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T19:55:09.767

那么您的应用程序需要分析数据吗？好吧，这听起来像是可以编写测试。

例如，如果您的数据总是在星期三得分 5.25。

你可以写一个测试。

```
void CheckScoreOnWeds()
{
     Assert.AreEqual( 5.25, DataAnalyzer.CalcScore(Day.Wednesday));     
} 
```

然后写你的课

```
class DataAnalyzer
{
    public double CalcScore( DayOfWeek Day)
    {
          //complex stuff
          return 5.25
    } 
} 
```

在那里你有一个单元测试。

# c# - Web 请求超时

> ID：462744
> 
> 赞同：5
> 
> 时间：2009-01-20T19:31:18.817
> 
> 标签：c#

等待 Web 请求返回的合理时间是多少？我知道这可能是一个有点加载的问题，但我要做的就是验证网页是否可用。

也许有更好的方法？

```
try 
{ 
    // Create the web request 
    HttpWebRequest request = WebRequest.Create(this.getUri()) as HttpWebRequest;

    request.Credentials = System.Net.CredentialCache.DefaultCredentials;

    // 2 minutes for timeout
    request.Timeout = 120 * 1000;

    if (request != null)
    {
        // Get response 
        response = request.GetResponse() as HttpWebResponse;

        connectedToUrl = processResponseCode(response);
    }
    else
    {
        logger.Fatal(getFatalMessage());

        string error = string.Empty;
    }
} 
catch (WebException we) 
{ 
...
} 
catch (Exception e) 
{ 
...
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-20T19:46:20.317

您需要考虑 Web 服务的使用者将花费多长时间，例如，如果您连接到数据库 Web 服务器并运行冗长的查询，您需要使 Web 服务超时时间长于查询所需的时间。否则，Web 服务将（错误地）超时。

我还使用（消费者时间）+ 10 秒之类的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T19:36:39.447

临时我会允许 10 秒，但这实际上取决于代码将使用哪种网络连接运行。尝试在几天/几周内运行一些测试 ping，以查看典型的响应时间。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-20T19:51:12.210

我会测量确实存在的页面需要多长时间才能响应。如果他们都在大约相同的时间内做出响应，那么我会将超时时间设置为大约两倍。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-20T21:13:30.420

只是想补充一点，很多时候我会使用自适应超时。可以是一个简单的指标，例如：

`period += (numTimeouts/numRequests > .01 ? someConstant: 0);`

每当您遇到超时时都会检查以尝试将超时保持在 1% 以下（例如）。只是要小心减少它太低:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-20T19:42:09.297

等待 Web 请求的合理时间量可能因一台服务器而异。如果服务器位于高延迟链路的远端，那么响应时间显然会比它在隔壁房间时更长。但是两分钟似乎对于服务器响应来说已经绰绰有余了。PING 命令的默认超时值以秒而不是分钟表示。我建议您查看 PING 或 TRACERT 等网络实用程序使用的超时值以获得灵感。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-20T19:42:28.607

我只会等待（MAX）30 秒，可能接近 15 秒。这真的取决于你在做什么以及连接不成功的结果。我相信你知道有很多理由可以让你超时......

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-20T19:46:06.417

我想这取决于两件事：

*   网络速度/负载（正如其他人所写，使用 ping 可能会让您对此有所了解）
*   您正在调用的页面类型：例如，它是静态 HTML 页面还是可能会执行一些耗时操作（数据库访问等）的页面

无论如何，我认为2分钟是很多时间。*我*肯定会将超时时间减少到 30 秒以下。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-20T20:03:00.860

我意识到这并不能直接回答你的问题，但是这个问题的“答案”有点难。无论如何，我过去使用[gomez](http://www.gomez.com/info_center/instant-test.php)来测量来自世界各地的页面加载时间的工具。它是免费的，如果您之前没有进行过此类测试，它可能有助于您明确了解给定位置的给定页面的典型页面加载时间。

# properties - 如何访问 CIL (MSIL) 中的对象属性？

> ID：462746
> 
> 赞同：3
> 
> 时间：2009-01-20T19:31:43.857
> 
> 标签：properties, cil

我是一个绝对的初学者，你看。假设我在堆栈上有一个字符串对象，并且想要获取其中的字符数 - 它的 .Length 属性。我将如何获得隐藏在里面的 int32 数字？

提前谢谢了！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T19:40:35.913

在 IL 中真的没有属性这样的东西。只有字段和方法。C# 属性构造由编译器转换为`get_PropertyName`方法`set_PropertyName`，因此您必须调用这些方法才能访问该属性。

代码的示例（调试）IL

```
var s = "hello world";
var i = s.Length; 
```

伊利诺伊州

```
 .locals init ([0] string s,
           [1] int32 i)
  IL_0000:  nop
  IL_0001:  ldstr      "hello world"
  IL_0006:  stloc.0
  IL_0007:  ldloc.0
  IL_0008:  callvirt   instance int32 [mscorlib]System.String::get_Length()
  IL_000d:  stloc.1 
```

如您所见，Length 属性是通过调用来访问的`get_Length`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T19:44:04.033

我作弊了……我拿了下面的 C# 代码，在 ildasm/Reflector 中看了看

```
static void Main(string[] args)
{
    string h = "hello world";
    int i = h.Length;
} 
```

相当于

```
.method private hidebysig static void Main(string[] args) cil managed
{
    .entrypoint
    .maxstack 1
    .locals init (
        [0] string h,
        [1] int32 i)
    L_0000: nop 
    L_0001: ldstr "hello world"
    L_0006: stloc.0 
    L_0007: ldloc.0 
    L_0008: callvirt instance int32 [mscorlib]System.String::get_Length()
    L_000d: stloc.1 
    L_000e: ret 
} 
```

# c# - 带有 System.Xml.Linq 命名空间的显式元素关闭标记

> ID：462747
> 
> 赞同：6
> 
> 时间：2009-01-20T19:31:45.260
> 
> 标签：c#, xml, linq-to-xml

我正在使用（.NET 3.5 SP1）System.Xml.Linq 命名空间来使用数据的 div 标签填充 html 模板文档（然后将其保存到磁盘）。有时 div 标签是空的，这对于 HTML 来说似乎是个问题。根据我的研究，DIV 标签不是自动关闭的。因此，至少在 Firefox 下，a`<div />`被认为是一个没有匹配结束标签的开始 div 标签。

因此，当我通过声明创建新的 div 元素时：

```
XElement divTag = new XElement("div"); 
```

**如何强制生成的 XML`<div></div>`代替`<div />`？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-20T19:43:46.873

我不确定为什么你会得到一个空的 DIV（似乎有点毫无意义！）但是：

```
divTag.SetValue(string.Empty); 
```

应该这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-12-10T17:05:29.993

使用 XElement divTag = new XElement("div", String.Empty); 你得到明确的结束标签

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T19:42:18.797

我不知道使用 LINQ 的问题的答案。但是在 codeplex 上有一个名为[HTML Agility Pack](http://www.codeplex.com/htmlagilitypack)的项目，它允许您创建和操作 HTML 文档，这与我们使用 System.Xml 命名空间类操作 XML 文档的方式非常相似。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-23T06:29:36.663

我这样做了。按预期工作。

```
myXml = new XElement("script", new XAttribute("src", "value"));
myXml .Value = ""; 
```

结果如下。

```
<script src = "value"></script> 
```

# iphone - iPhone上有音频压缩库吗？

> ID：462759
> 
> 赞同：4
> 
> 时间：2009-01-20T19:35:38.823
> 
> 标签：iphone

可以即时压缩正在录制的音频吗？

或者是否有任何库可以获取 .caf 文件并转换为压缩格式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-20T20:07:58.587

Core Audio API（您将用于录制音频）允许您选择格式、比特率等。您可以选择低比特率来减小文件大小。在使用 iPhone 的大多数情况下，您正在录制语音音频，低比特率就可以了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T22:34:21.727

[音频队列服务](http://developer.apple.com/DOCUMENTATION/MusicAudio/Conceptual/AudioQueueProgrammingGuide/Introduction/chapter_1_section_1.html)可以录制和编码音频。这些在 iPhone 上可用。该文档包括保存到任意格式的文件。我不知道它是否与转码 .caf 文件完美匹配，但绝对值得一看。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-16T12:07:43.110

2.x SDK 不支持压缩音频。

您可能必须编译和链接第 3 方库。

看CPU使用率，显然不会
像内置解压那样硬件加速。

# css - 使网站易于访问的最佳实践是什么？

> ID：462767
> 
> 赞同：8
> 
> 时间：2009-01-20T19:36:57.403
> 
> 标签：css, accessibility

我正在寻找设计一个考虑到可访问性的网站的最佳实践。该网站将有很多年长和能力较弱的人访问它，我想让它对他们尽可能友好。是否有描述所有正确标签和要使用的属性的资源？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-20T19:42:14.613

根据您的目标，有很多资源。

强烈建议你从：

*   [第 508 条](http://www.section508.gov/)（美国立法，但显然以美国为中心）

*   W3C 的[Web 可访问性倡议](http://www.w3.org/WAI/)和[Web 内容可访问性指南](http://www.w3.org/TR/WCAG10/)

编辑：

忘了提到 WCAG 已经受到了一些相当大的批评，这使得[这个](http://wcagsamurai.org/)家伙的努力非常有帮助。

还想从个人经验中补充一点，要记住 WA 并不意味着“有屏幕阅读器的盲人”。**您还必须考虑各种访问限制**：例如与肌肉控制、不寻常的输入设备和简单的屏幕放大有关的灵活性问题。

祝你好运！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-21T09:27:17.600

这是我倾向于遵循的快速列表

*   确保它使用符合 AAA 标准的干净 XHTML 标记，
*   尽可能尝试将 HTML、CSS、Javascript 溢出到各自的文件中，
*   为打印、屏幕等创建不同的样式表，
*   确保您考虑到视力障碍和色盲的颜色和字体，
*   尝试仅将主导航放置在代码顶部，以便实际内​​容显示在代码顶部附近，这样人们就不必滚动到很远才能看到内容，特别是如果他们使用屏幕阅读器 / 低资源，
*   如果您在内容之前确实有很多导航，那么在顶部附近放置一个链接，允许用户跳到内容，
*   确保页面上的第一个链接是网站的纯文本/低图形版本，
*   确保所有页面和所有基本功能都可以在没有打开 JavaScript 的情况下工作，
*   Firefox 有很多插件可以帮助开发，包括：
    *   Web开发人员
    *   没有脚本
    *   HTML 验证器
    *   萤火虫
*   确保页面在包括旧浏览器在内的所有浏览器中呈现，即使这意味着它可以正常工作，但与设计不完全匹配。
*   确保 HTML、CSS、JavaScript 保持在最小文件大小以帮助下载时间，例如删除空格和空行，
*   始终在表单和 alt 中使用 LABELS，在链接和图像中使用标题标签，
*   仅将表格用于表格数据并确保数据正确标记，
*   在可能的情况下，不要使用 JavaScript 将内容写入页面，而是使用 CSS 隐藏它，这样 JavaScript 被禁用或无法正常工作，那么内容仍然会出现，
*   始终确保您在 JavaScript 中使用 onkeypress 和 onclick 事件，以防止用户不能/不使用鼠标。

最后，如果您必须在页面上使用空白图像进行跟踪等，那么不要给它们 Alt 标签。这是我自己的观点，并且是在网上引起激烈争论的观点，尤其是当 1x1px 图像用于间距时。但是，据我所知，如果您使用的是屏幕阅读器，那么您不会读取它不需要看到的图像的愚蠢评论。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-20T19:45:15.403

尝试查看 Wikipedia 关于[Web Accessibility](http://en.wikipedia.org/wiki/Web_accessibility)的文章。它包含许多指向不同国家/地区的各种信息来源的链接，根据您的目标受众，这可能很有用。W3C 是最初的标准之一，但有很多批评者。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-20T19:41:11.310

除其他外.. 为每个“img”标签提供“alt”和“title”属性。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-20T20:21:01.493

获取像 lynx 这样的纯文本浏览器。如果您的网站在 lynx 中运行，它可能适用于需要屏幕阅读器或有其他障碍的人。它不能替代查找法规，但它是一种快速简便的检查。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-20T22:12:11.253

对于另一个观点，请参阅[荷兰政府网络指南](http://www.webrichtlijnen.nl/english/)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-20T19:39:23.543

政府提供了一个称为[第 508 节](http://www.section508.gov/)的标准，该标准列出了使网站兼容的原因。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-20T19:41:29.577

W3C 网站上有一个很好的资源：[Web Content Accessibility Guidelines](http://www.w3.org/TR/WAI-WEBCONTENT/)。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-20T19:49:59.437

要记住几件事：

*   在每个页面上都有一个 CSS 链接，可以轻松更改字体大小。

*   在视觉上尝试以向后 S 的方式易于阅读的适当演示文稿..从左到右，后退..等。

*   确保其他响应中提到的所有 alt 标签等都是至关重要的。

*   看看是否有一些专门测试您的网站的残疾人网站。看到他们列出的重要事项并没有什么坏处。

*   确保内容易于阅读和查找。仅此一项将使工作变得容易得多。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-20T20:51:16.287

关于这个主题有很多很多资源。事实上，危险在于信息过载，而不是信息不足。

但另一种方法是从一般意义上考虑您的 HTML 页面，而不是您在 Web 浏览器中看到的视觉输出。如果您编写了一个解释网站的软件，会有什么帮助？这是使用良好语义的一种迂回说法。我的首要建议是使用标准的 XHTML 作为内容，使用 CSS 进行设计。还可以查找诸如“渐进增强”和“行为 Javascript”之类的主题。

但是对于资源：

*   W3C 的 Web 可访问性倡议：www.w3.org/wai
*   www.WebAIM.org
*   www.Accessify.com
*   www.CSSZenGarden.com 获取有关如何将语义标记设计为看起来非常不同的灵感。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-20T22:17:56.063

它还没有被提及，所以我想我会提及它。如果您希望盲人用户能够使用您的网站，请避免使用 Flash。我在互联网上找到的最多 1% 的闪存是可访问的。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-21T09:12:07.413

有关可访问性（色盲屏幕阅读器、排版等）的良好资源列表以设计方式[在这里](http://www.mezzoblue.com/zengarden/book/links/)。对于网站和一般文档的验证，我使用[W3C](http://www.w3.org/)。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-22T13:19:05.760

如果您在 asp.net 中进行开发，那么开源 NAAK 工具可能会很有用。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2009-01-20T21:11:39.520

必读的是 Jeffery Zeldman 的[“使用 Web 标准进行设计”](https://rads.stackoverflow.com/amzn/click/com/0321385551)

不确定您是否在使用 Dreamweaver，但他还刚刚发布了一个工具包来验证您的网站的可访问性。

# visual-studio - 混合使用不同版本的 Visual Studio 2002 及更高版本构建的 C 代码静态库

> ID：462768
> 
> 赞同：1
> 
> 时间：2009-01-20T19:37:10.583
> 
> 标签：visual-studio, sdk, static-libraries, mixing

我有一个使用 Visual Studio 2002 C (v7.0) 编译器和英特尔 Fortran 9.0.018 编译器编译并链接在一起的 C 和 Fortran 例程的静态可链接库。

我的库中的 C 代码调用并链接到 Microsoft C-RunTime (MSCRT) 2002 静态库（单线程）。我相信 2002 CRT 库的实际版本号是 v7.0

我将这个静态库称为“vs2002if9.lib”

我可以使用任何更高版本的 Visual Studio（2003、2005 或 2008）安全地静态链接到我的“vs2002if9.lib”，而不必担心调用程序在 C 运行时调用方面的行为方式吗？

还是我通过混合 CRT 静态库的版本来制造问题？

如果我将我的“vs2002if9.lib”提供给第 3 方软件开发人员怎么办？我对他们有什么要求？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T19:48:27.677

过去，混合 C 运行时对我不起作用。我可以看到这种工作{也许}的唯一方式是，如果您在静态链接的 C-Runtime 的边界内完全隔离堆栈/堆的使用[没有任何东西通过参数跨越边界，那么您的 vs2009if9 是什么值.lib 提供]。

例如，如果您要在应用程序中分配一个指针 [堆内存] 并将该指针传递给您提供的库，应该使用哪个堆管理器？正确的答案是管理指针的堆管理器，但您的库不会知道其他堆管理器。如果您的库分配内存供应用程序使用，它会变得更丑陋，并且使用提供的指针释放/删除是应用程序的责任（糟糕的设计是的，但仍然可能）。同样，将使用错误的堆管理器。

# apache-flex - ActionScript (Flex) 的检查样式

> ID：462770
> 
> 赞同：7
> 
> 时间：2009-01-20T19:37:21.927
> 
> 标签：apache-flex, actionscript, coding-style

嗨，我目前正在开发一个使用 Flex 和 Java 的项目。在 Java 中，我们使用 Checkstyle 轻松实施了编码标准，我们希望为 Flex 执行此操作。

有人知道类似于 Checkstyle 的工具可以允许编码标准检查吗？（我已经用谷歌搜索了这个，但发现只有一个用 python 编写的项目并且它被遗弃了）

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T16:04:35.957

总而言之，有……有点，但仅适用于 Actionscript，你必须自己测试……有一个 Actionscript 3 版本的[原型](http://code.google.com/p/checkstyleas3/downloads/list)，但它甚至还不是 Beta 版（并且我承认我没有时间测试它）。我还没有发现任何与 XML 类似的东西，更不用说 MXML。然而，这至少在Flex 4的[功能请求列表中。](http://clintm.esria.com/2007/12/10/flex-builder-4-feature-wish-list/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T13:05:14.430

我也在做一个使用 Flex 和 Java 的项目。和您一样，在 Java 中，我们可以轻松使用 checkstyle、findBug、javaNcss 或 PMD 等插件。我的个人项目是为 Flex 做这件事。我已经测试了原型'checkStyleas3'，但它只是验证代码源 en 返回 0 或 -1 作为结果。因此，如果您想做更多的事情，您将拥有（事实上我也是）来实现这个原型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-12T19:43:22.637

留意这个：[http ://blog.joa-ebert.com/2009/05/20/as3v-preview/](http://blog.joa-ebert.com/2009/05/20/as3v-preview/)

# jquery - Is there a jQuery event that fires when all effects are done running

> ID：462778
> 
> 赞同：0
> 
> 时间：2009-01-20T19:41:08.750
> 
> 标签：jquery

The title explains the question, otherwise is there way to call a function when all the effects on a page are done running?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T19:52:41.567

You could nest your animations like this

```
$('#Div1').slideDown('fast', function(){
   $('#Div2').slideUp('fast');
}); 
```

And do them sequentially...

You could also do something like this:

```
var animations = 0;
checkAnimation(1);
$('#Div1').slideDown('fast', function(){
   checkAnimation(-1);
});

checkAnimation(count){
   animations += count;
   if(count == 0)
      //animations complete
   }
   else {
       //still animating
   }
} 
```

Hope this helps.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T19:52:41.177

You might be able to make use of **.queue** to get the functionality you are after. If the length of the queue was 0 you would know that all animations on the object are finished.

[Documentation](http://docs.jquery.com/Effects/queue)

# java - WSDL2Java 用于重载方法？

> ID：462786
> 
> 赞同：1
> 
> 时间：2009-01-20T19:42:23.243
> 
> 标签：java, web-services, cxf

我正在尝试在包含重载方法（相同的方法名称，不同的参数）的 WSDL 上运行 WSDL2Java (Apache CXF)。在我看来，我似乎需要编写一个 JAX-WS 映射文件或一个 JAXB 映射文件来执行此操作，但我觉得我被大量未读过的规范所困扰。有人有这方面的例子吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-24T08:07:49.180

在这种情况下，我使用了手工制作的 WSDL。我采用原始的 WSDL 并对其进行调整。

# .net - Getting odd error on .net ExecuteNonQuery

> ID：462790
> 
> 赞同：0
> 
> 时间：2009-01-20T19:43:23.397
> 
> 标签：.net, sql-server

I'm working in .NET with SQL server on the backend

I have a database that I create a record in using a web control - then I need to update some of the fields.
I can trap the sql statement and run it in sql server successfully - however, when I try to run execute non-query I get the following error:

Unhandled Execution Error Incorrect syntax near '<'. at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection) at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection) at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj) at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj) at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async) at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult result, String methodName, Boolean sendToPipe) at System.Data.SqlClient.SqlCommand.ExecuteNonQuery() at TestAPI.UpdateTicketValues(String srId) in D:\Webs\Internal\veritythree.com\SupportBeta\TestAPI.ascx.vb:line 216 at TestAPI.Submit_Click(Object sender, EventArgs e) in D:\Webs\Internal\veritythree.com\SupportBeta\TestAPI.ascx.vb:line 170 at System.Web.UI.WebControls.Button.OnClick(EventArgs e) at System.Web.UI.WebControls.Button.RaisePostBackEvent(String eventArgument) at System.Web.UI.WebControls.Button.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent(String eventArgument) at System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument) at System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData) at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) 0.517567748943243 0.511543

Here is my function:

```
Public Function UpdateTicketValues(ByVal srId As String) As Boolean
    Dim result As Boolean
    Dim myCDataReader As System.Data.SqlClient.SqlDataReader
    Dim myUConn As New System.Data.SqlClient.SqlConnection
    Dim myCCmd As New System.Data.SqlClient.SqlCommand
    Dim myUCmd As New System.Data.SqlClient.SqlCommand
    Dim strSQL As String

    strSQL = "SELECT Contact_RecId, First_Name, Last_Name, PhoneNbr, Extension, Email FROM vti_ContactInformation " & _
             "WHERE Company_RecId = " & CoId & " AND Email = '" & txtEmail.Text & "'"
    myCConn.Open()
    myUConn = New System.Data.SqlClient.SqlConnection("Data Source=x;Initial Catalog=x;User Id=x;Password=x;Trusted_Connection=False")
    myUConn.Open()
    myCCmd.Connection = myCConn
    myCCmd.CommandText = strSQL
    myCDataReader = myCCmd.ExecuteReader
    If myCDataReader.Read() Then
        'Run update with contact information
        strSQL = "UPDATE SR_Service " & _
                 "SET Contact_RecId = " & myCDataReader.GetValue(0) & ", " & _
                 "    Contact_Name = '" & myCDataReader.GetValue(1) & " " & myCDataReader.GetValue(2) & "', " & _
                 "    PhoneNbr = '" & myCDataReader.GetValue(3) & "', " & _
                 "    Extension = '" & myCDataReader.GetValue(4) & "', " & _
                 "    Email_Address = '" & myCDataReader.GetValue(5) & "' " & _
                 "WHERE SR_Service_RecId = " & srId & " "
        myUCmd.Connection = myUConn
        myUCmd.CommandText = strSQL
        'myCCmd.ExecuteNonQuery()
        lblServiceRequest.Text = myUCmd.CommandText
        result = True
    Else
        myUCmd.CommandText = ""
        result = False
    End If
    If myUCmd.CommandText <> "" Then
        myUCmd.ExecuteNonQuery()
    End If
    myCConn.Close()
    myUConn.Close()
    Return result
End Function 
```

Any help is appreciated!

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-20T19:48:03.417

before i even look where the error might be i suggest you stop immediatly what your doing and first go change all sql code to use parameters. if you don't your site will be open to sql injection attacks that can destroy your database.

to find out where the problem is run profiler and check the stmt:starting and stmt:completed events.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T20:06:16.283

我对此的看法是在执行命令之前中断。debug.print 命令文本，切换到 sql 查询分析器并将 sql 字符串粘贴到那里并运行。然后你会确切地看到问题是什么，如果它在命令中。

我认为您的值可以转义 sql-string 并且包含 '< 或其他内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-20T19:52:49.743

Aside from the other answers above relating to [SQL Injection](http://en.wikipedia.org/wiki/SQL_injection), you'll want to look at:

```
... " & CoId & " ...

... " & myCDataReader.GetValue(0) & " ...

... " & srId & " ... 
```

These statements are not escaped so there's a good chance your error is there.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T20:22:14.067

您确定错误在 UPDATE 语句中吗？我认为它在 SELECT 语句中，正如我从您的堆栈跟踪中看到的那样。你为什么不在那个语句中使用参数呢？

除此之外，您的代码可以更有效地编写。现在，您执行一条 SELECT 语句，并为结果集中的每条记录执行一条 UPDATE 查询。知道 SQL 是基于集合的，并且这可以写在一个语句中。

像这样的东西：

```
UPDATE sr_service
   SET contact_name = vti_ContactInformation.FirstName + ' ' + vti_ContactInformation.LastName
   ... your other columns ..
FROM vti_ContactInformation
WHERE sr_service.sr_service_recid = {yourid} 
```

确保将 {yourid} 替换为适当的列。我没有这样做，因为我无法直接看到您分配给 srId 变量的值。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-20T20:01:12.207

很可能将此代码转换为参数化查询（这很可能会修复过程中的错误）所需的时间比跟踪问题所需的时间更少。不再有 SQL 注入的风险，更易于阅读，并且您可以获得执行计划。赢赢赢！

像这样连接字符串很容易出错，这是避免以这种方式执行 SQL 的另一个原因。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-20T19:49:41.247

First things first; set to stop on exceptions (so you can see which non-query it is) -- then you'll be able to see the command text that is going wrong.

I'd also recommend converting these queries into stored procedures (or at least parameterised queries); not just for performance gains from execution plans, but also from a security point of view (consider what happens when txtEmail.Text is "'; drop table vti_ContactInformation; select '"

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-20T21:51:10.097

谢谢大家 - 当我将所有内容更改为参数时，我发现 srId 变量中的值有一些隐藏文本（一些 xml 标签剩余）。一旦我把它理顺了，它就完美地工作了。

感谢您的指点和良好的方向！

# c# - C#中创建单项列表的快捷方式

> ID：462793
> 
> 赞同：154
> 
> 时间：2009-01-20T19:44:39.820
> 
> 标签：c#

在 C# 中，是否有一个内联快捷方式来实例化 List<T> 只有一项。

我目前正在做：

```
new List<string>( new string[] { "title" } )) 
```

到处都有这段代码会降低可读性。我想过使用这样的实用方法：

```
public static List<T> SingleItemList<T>( T value )
{
    return (new List<T>( new T[] { value } ));
} 
```

所以我可以这样做：

```
SingleItemList("title"); 
```

有没有更短/更清洁的方法？

谢谢。

* * *

## 回答 #1

> 赞同：278
> 
> 时间：2009-01-20T19:51:26.267

只需使用这个：

```
List<string> list = new List<string>() { "single value" }; 
```

你甚至可以省略 () 大括号：

```
List<string> list = new List<string> { "single value" }; 
```

更新：当然这也适用于多个条目：

```
List<string> list = new List<string> { "value1", "value2", ... }; 
```

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2009-01-20T20:15:22.707

```
var list = new List<string>(1) { "hello" }; 
```

与其他人发布的内容非常相似，只是它确保最初只为单个项目分配空间。

当然，如果您知道稍后会添加一堆东西，这可能不是一个好主意，但仍然值得一提。

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2009-01-20T19:52:46.527

Michael 使用扩展方法的想法导致了一些更简单的事情：

```
public static List<T> InList<T>(this T item)
{
    return new List<T> { item };
} 
```

所以你可以这样做：

```
List<string> foo = "Hello".InList(); 
```

我不确定我是否喜欢它，请注意...

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-01-20T20:12:52.137

根据对[Google Java Collections](http://code.google.com/p/google-collections/)的了解，对我之前的答案有不同的回答：

```
public static class Lists
{
    public static List<T> Of<T>(T item)
    {
        return new List<T> { item };
    }
} 
```

然后：

```
List<string> x = Lists.Of("Hello"); 
```

我建议查看 GJC——里面有很多有趣的东西。（我个人会忽略“alpha”标签——它只是“alpha”的开源版本，它基于一个非常稳定和大量使用的内部 API .)

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2016-07-07T13:12:16.460

```
new[] { "item" }.ToList(); 
```

它比

```
new List<string> { "item" }; 
```

而且您不必指定类型。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-01-20T19:49:28.813

使用带有方法链接的扩展方法。

```
public static List<T> WithItems(this List<T> list, params T[] items)
{
    list.AddRange(items);
    return list;
} 
```

这会让你这样做：

```
List<string> strings = new List<string>().WithItems("Yes"); 
```

或者

```
List<string> strings = new List<string>().WithItems("Yes", "No", "Maybe So"); 
```

**更新**

您现在可以使用列表初始值设定项：

```
var strings = new List<string> { "This", "That", "The Other" }; 
```

请参阅[http://msdn.microsoft.com/en-us/library/bb384062(v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/bb384062(v=vs.90).aspx)

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2016-07-20T16:15:10.083

另一种方式，在“C#/.Net Little wonders”上找到（不幸的是，该站点不再存在）：

```
Enumerable.Repeat("value",1).ToList() 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-02-18T16:10:32.547

对于 java 中可枚举的单个项目，它将是 Collections.singleton("string");

在 c# 中，这将比新列表更有效：

```
public class SingleEnumerator<T> : IEnumerable<T>
{
    private readonly T m_Value;

    public SingleEnumerator(T value)
    {
        m_Value = value;
    }

    public IEnumerator<T> GetEnumerator()
    {
        yield return m_Value;
    }

    IEnumerator IEnumerable.GetEnumerator()
    {
        yield return m_Value;
    }
} 
```

但是有没有更简单的使用框架的方法？

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-09-04T09:39:11.637

我有这个小功能：

```
public static class CoreUtil
{    
    public static IEnumerable<T> ToEnumerable<T>(params T[] items)
    {
        return items;
    }
} 
```

因为它没有规定具体的返回类型，所以它是如此通用，以至于我到处使用它。你的代码看起来像

```
CoreUtil.ToEnumerable("title").ToList(); 
```

但当然它也允许

```
CoreUtil.ToEnumerable("title1", "title2", "title3").ToArray(); 
```

当我必须将一项附加/前置到 LINQ 语句的输出时，我经常使用它。例如，将空白项添加到选择列表中：

```
CoreUtil.ToEnumerable("").Concat(context.TrialTypes.Select(t => t.Name)) 
```

保存一些`ToList()`和`Add`语句。

（迟到的答案，但我偶然发现了这个老歌，并认为这可能会有所帮助）

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-01-20T19:52:20.337

你也可以做

```
new List<string>() { "string here" }; 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-01-20T20:06:52.850

我会做

```
var list = new List<string> { "hello" }; 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2016-03-30T10:24:35.257

受到其他答案的启发（因此我可以在需要时随时获取它！），但命名/样式与 F# 一致（`singleton`每个数据结构都有一个标准函数*）：

```
namespace System.Collections.Generic
{
    public static class List
    {
        public static List<T> Singleton<T>(T value) => new List<T>(1) { value };
    }
} 
```

*当然除了`ResizeArray`它自己，因此这个问题:)

* * *

在实践中，我*实际上*将其命名`Create`为与我定义的其他助手保持一致，例如[`Tuple.Create`](https://msdn.microsoft.com/en-us/library/system.tuple.create(v=vs.110).aspx)，`Lazy.Create`[2][`LazyTask.Create`](https://stackoverflow.com/a/33946166/11635)等：

```
namespace System.Collections.Generic
{
    public static class List
    {
        public static List<T> Create<T>(T value) => new List<T>(1) { value };
    }
} 
```

[2]

```
namespace System
{
    public static class Lazy
    {
        public static Lazy<T> Create<T>(Func<T> factory) => new Lazy<T>(factory);
    }
} 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2016-10-18T14:48:49.360

试试**var**

```
var s = new List<string> { "a", "bk", "ca", "d" }; 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-11-22T06:28:32.550

如果有人登陆此页面并尝试添加对象而不是字符串，那么这对我有用。

```
new List<myObj> { new myObj{propertName=propstryValue }
, new myObj{propertName=propstryValue }, new myObj{propertName=propstryValue }
}; 
```

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2021-03-21T19:04:06.430

您需要从`List<>`该类创建一个继承者

```
 public class SingletonList<T> : List<T>
    {
        public SingletonList(T element) : base(1)
        {
            this.Add(element);
        }
    } 
```

你可以用它代替基`List<>`类

```
var singletonList = new SingletonList<string>("Hello World!"); 
```

# asp.net - 有没有办法使用 ModalPopup Extender 打开另一个页面？

> ID：462801
> 
> 赞同：0
> 
> 时间：2009-01-20T19:46:08.740
> 
> 标签：asp.net, modalpopupextender

我想知道是否有办法使用 Modal Popup Extender 打开另一个页面？如果有人可以请告诉我我该怎么做..

谢谢

奥维斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T19:53:44.543

您可能会在 Modal Popup Extender 中放置一个指向页面的 iframe，但这有点麻烦。我建议将该页面上的任何内容放入用户控件中，然后从原始页面和带有模式弹出窗口的页面引用该控件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T20:02:15.853

尝试使用 HTML iframe 作为扩展器的目标控件。iframe 标签有一个“src”属性，它应该指向你想在对话框中显示的页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T14:43:14.790

你必须考虑它没有错觉 - 从根本上说，模式弹出窗口只是一个 DIV。所以问题是“你能在 div 中显示不同的页面吗？”。iframe ......或者也许是一个网络服务调用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-24T14:54:28.017

您可以使用用户控件并将其动态加载到模式弹出窗口

Dim ctrl As Control
ctrl = Me.Page.LoadControl("~/control/cmsbar.ascx")
ctrl.id="ctrlx"
Placeholder1.Controls.Add(ctrl )
popup.Show()

请注意，弹出窗口将有一个占位符来添加控件。您必须给用户控件一个 id，以便可以为控件加载视图状态。此代码必须放在 Page_Init 事件中，以便在第二次创建用户控件时加载其视图状态

# events - 从 C++/CLI 引发事件的正确方法？

> ID：462805
> 
> 赞同：15
> 
> 时间：2009-01-20T19:46:22.470
> 
> 标签：events, c++-cli, raise

我想知道从 C++/CLI 引发事件的正确方法是什么。在 C# 中[应该首先制作处理程序的副本，检查它是否不为空，然后调用它](https://stackoverflow.com/questions/340610/create-empty-c-event-handlers-automatically#340638)。C++/CLI 有类似的做法吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2010-01-06T17:13:43.777

这不是故事的全部！您通常不必担心 C++/CLI 中的空事件处理程序。这些检查的代码是为您生成的。考虑以下简单的 C++/CLI 类。

```
public ref class MyClass
{
public:
    event System::EventHandler ^ MyEvent;
}; 
```

如果你编译这个类，并使用[Reflector](http://www.red-gate.com/products/reflector/)反汇编它，你会得到以下 c# 代码。

```
public class MyClass
{
    // Fields
    private EventHandler <backing_store>MyEvent;

    // Events
    public event EventHandler MyEvent
    {
        [MethodImpl(MethodImplOptions.Synchronized)] add
        {
            this.<backing_store>MyEvent = (EventHandler) Delegate.Combine(this.<backing_store>MyEvent, value);
        }
        [MethodImpl(MethodImplOptions.Synchronized)] remove
        {
            this.<backing_store>MyEvent = (EventHandler) Delegate.Remove(this.<backing_store>MyEvent, value);
        }
        raise
        {
            EventHandler <tmp> = null;
            <tmp> = this.<backing_store>MyEvent;
            if (<tmp> != null)
            {
                <tmp>(value0, value1);
            }
        }
    }
} 
```

通常的检查是在 raise 方法中进行的。除非您真的想要自定义行为，否则您应该像在上面的类中一样声明您的事件，并在不担心 null 处理程序的情况下提升它。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-01-20T19:55:26.007

C++/CLI 允许您`raise`在[**自定义事件**](http://msdn.microsoft.com/en-us/library/5f3csfsa.aspx)处理程序中进行覆盖，因此您不必`null`在引发事件时进行测试或复制。当然，在您的自定义中，`raise`您仍然必须这样做。

示例，改编自 MSDN 以确保正确性：

```
public delegate void f(int);

public ref struct E {
   f ^ _E;
public:
   void handler(int i) {
      System::Console::WriteLine(i);
   }

   E() {
      _E = nullptr;
   }

   event f^ Event {
      void add(f ^ d) {
         _E += d;
      }
      void remove(f ^ d) {
        _E -= d;
      }
      void raise(int i) {
         f^ tmp = _E;
         if (tmp) {
            tmp->Invoke(i);
         }
      }
   }

   static void Go() {
      E^ pE = gcnew E;
      pE->Event += gcnew f(pE, &E::handler);
      pE->Event(17);
   }
};

int main() {
   E::Go();
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2011-03-04T11:32:14.133

如果您的问题是***raise***不是私有的，那么像文档说的那样明确地实现它：

[http://msdn.microsoft.com/en-us/library/5f3csfsa.aspx](http://msdn.microsoft.com/en-us/library/5f3csfsa.aspx)

总之：

如果您只使用***event***关键字，您将创建一个“微不足道”的事件。编译器为您生成***add*** / ***remove*** / ***raise***和委托成员。生成的***raise***函数（如文档所说）检查***nullptr***。此处记录了琐碎的事件：

[http://msdn.microsoft.com/en-us/library/4b612y2s.aspx](http://msdn.microsoft.com/en-us/library/4b612y2s.aspx)

如果您想要“更多控制”，例如将***raise***设为私有，那么您必须显式实现成员，如链接中所示。您必须显式声明委托类型的数据成员。然后使用***event***关键字来声明与事件相关的成员，如 Microsoft 示例中所示：

```
// event keyword introduces the scope wherein I'm defining the required methods
// "f" is my delegate type
// "Event" is the unrealistic name of the event itself
event f^ Event
{
      // add is public (because the event block is public)
      // "_E" is the private delegate data member of type "f"
      void add(f ^ d) { _E += d; }

   // making remove private
   private:
      void remove(f ^ d) { _E -= d; }

   // making raise protected
   protected:
      void raise(int i)
      { 
         // check for nullptr
         if (_E)
         {
            _E->Invoke(i);
         }
      }
}// end event block 
```

罗嗦，但它就在那里。

-赖利。

# c# - 如何创建特定类型的用户控件

> ID：462812
> 
> 赞同：0
> 
> 时间：2009-01-20T19:48:27.240
> 
> 标签：c#, winforms, user-controls, controls, components

我正在尝试创建一个 winForms 用户控件。但我想要一个用户控件——当放置在表单上时——不占用任何表单空间。相反，它像 OpenFileDialog 一样很好地隐藏在下方。

首先，这是一个什么样的用户创造的东西？它仍然称为“用户控件”吗？如果不是，这可以解释为什么我所有的搜索都是徒劳的。其次，我需要从什么对象开始创建这样的东西？

非常感谢您朝正确的方向轻推。

谢谢。

- 杰瑞

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T19:52:03.533

出现在“组件托盘”中的控件，如 Windows 窗体计时器控件，继承自 Component。

要使用一些自动样板代码创建一个，右键单击一个项目并单击添加... | 零件

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T19:54:00.003

我相信您正在谈论创建一个[Component](http://msdn.microsoft.com/en-us/library/system.componentmodel.component.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T19:59:24.207

好吧...我知道...我现在感觉一英寸高。

我很想收回这个问题并隐藏我的愚蠢，但我想我会把它留给其他可能会问同样问题并且也需要温柔提醒的人。

感谢您对noggin的打击！

# perl - 如何在 mod_perl 的 BEGIN 块中访问 Apache 服务器配置？

> ID：462824
> 
> 赞同：1
> 
> 时间：2009-01-20T19:50:36.110
> 
> 标签：perl, apache2, startup, mod-perl2

我一直在尝试从使用 PerlSetEnv 切换到使用[自定义配置指令](http://perl.apache.org/docs/2.0/user/config/custom.html)。我的配置模块带有`set_val`来自文档的副本：

```
sub set_val
{
    local our ($key, $self, $parms, $arg) = @_;
    $self->{$key} = $arg;
    unless ($parms->path)
    {
        local our $srv_cfg = Apache2::Module::get_config($self, $parms->server);
        $srv_cfg->{$key} = $arg;
    }
} 
```

...由每个自定义指令子调用。然后我有我的.conf：

```
PerlLoadModule MyModule::ServerConfig
MyCustomDirective 'hello' 
```

这很好，因为 httpd -t 可以确定文件的语法。问题是我似乎无法从 BEGIN 块中获取配置文件中的值，这是我需要做的。

我试过修补各种各样的东西：

```
BEGIN
{
    use Apache2::CmdParms ();
#   use Apache2::Directive ();
    use Apache2::Module ();
#   use Apache2::ServerUtil ();
#   use Apache2::RequestUtil ();

    use Data::Dump;
    warn ddx(Apache2::Module::get_config('MyModule::ServerConfig', Apache2::CmdParms->server));
#   warn ddx(Apache2::Directive->as_hash);
#   warn Apache2::ServerUtil->dir_config('MyCustomDirective);
#   warn Apache2::CmdParms->server->server_hostname();
} 
```

……但无济于事。正如它所说，我的大部分努力（例如尝试访问`CmdParms->server`）导致`Parent: child process exited with status 3221225477 -- Restarting`Apache自动重启。如果我通过`ServerUtil->server to get_config()`了，服务器会保持活动状态，但警告只会打印出“1”。

我在某处读到，这是因为您无法在`BEGIN`块内获得任何与请求相关的内容，因为请求会有所不同。这有点道理，除了使用 PerlOptions +GlobalRequest 我已经能够`$ENV`在一个`BEGIN`块中看到，那么为什么我不能看到我自己的指令，就像它们依赖于请求的发生方式一样？特别令人困惑的是，如果我尝试传递`Apache2::RequestUtil->request->per\_dir\_config()`到`get_config()`，它会说`Global $r object is not available.` 如果在一个`BEGIN`块中这是真的，我怎么能得到`$ENV`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-20T20:36:59.217

尝试将您想要的`import`功能添加到其他模块和`use`此模块中您通常放置`BEGIN`块的代码中。它应该工作相同。可能会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T21:14:38.407

部分原因是 Dump 没有被正确使用。这效果更好：

```
use Data::Dump qw(pp);
warn pp(Apache2::Module::get_config('MyModule::ServerConfig', Apache2::ServerUtil->server)); 
```

但是，它不显示出现在 <Directory> 块中的任何指令。

不过，在我的特殊情况下，我不需要那个功能，但我再想一想。那恰好是我卡住它们的地方。

# plugins - 自定义 IntelliJ Idea 快捷方式 - 插件还是键盘映射？

> ID：462826
> 
> 赞同：2
> 
> 时间：2009-01-20T19:51:23.550
> 
> 标签：plugins, intellij-idea

我想在 Idea 中创建一个类似于 Ctrl+Shift+T 的快捷方式。我不想在 Class 和 Test 之间切换，而是想根据当前选项卡 (X) 在 XModel、XView 和 XController 之间切换。我应该创建一个插件还是可以在 Keymap 中实现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-12-04T02:44:58.700

据我所知（从 IDEA 10 开始），这需要一个插件，您可以在其中配置组合在一起的文件扩展名。

# ruby-on-rails - 在尊重 CDATA 的同时转义 HTML 和号的正则表达式

> ID：462831
> 
> 赞同：8
> 
> 时间：2009-01-20T19:52:15.047
> 
> 标签：ruby-on-rails, ruby, regex

我编写了一个内容管理系统，它使用服务器端正则表达式在页面响应发送到客户端浏览器之前转义页面响应中的 & 符号。正则表达式注意已被转义或属于 HTML 实体的 & 符号。例如，以下内容：

```
a & b, c & d, © 2009
```

变成这样：

```
一个& b, c & d, © 2009
```

（只`&`修改了第一个。）下面是正则表达式，它是从 Rails 助手中获取和修改的：

```
html.gsub(/&(?!([a-zA-Z][a-zA-Z0-9]*|(#\d+));)/) { |special| ERB::Util::HTML_ESCAPE[special] } 
```

虽然这很好用，但它确实有问题。正则表达式不知道任何`<![CDATA[`或`]]>`可能围绕未转义的＆符号。这对于嵌入式 JavaScript 保持不变是必要的。例如，这个：

```
<script type="text/javascript">
  // <![CDATA[
  if (a && b) doSomething();
  // ]]>
</script> 
```

不幸的是这样渲染：

```
<script type="text/javascript">
  // <![CDATA[
  if (a &amp;&amp; b) doSomething();
  // ]]>
</script> 
```

JavaScript 引擎当然不理解。

我的问题是：有没有办法修改正则表达式以完全按照它现在所做的那样做，除了它使 CDATA 部分中的文本保持不变？

`<`由于正则表达式一开始并不那么简单，所以这个问题可能更容易回答：是否可以编写一个正则表达式，将除“ ”和“ ”之间的那些字母之外的所有字母都变为句点`>`？例如，一个会`"some <words> are < safe! >"`变成`".... <words> ... < safe! >"`?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-21T22:49:29.650

你自找的！:D

```
/&(?!(?:[a-zA-Z][a-zA-Z0-9]*|#\d+);)
 (?!(?>(?:(?!<!\[CDATA\[|\]\]>).)*)\]\]>)/xm 
```

第一行是您的原始正则表达式。如果前面有一个 CDATA 关闭序列 ( )，则前瞻匹配，除非这里和那里之间`]]>`有一个打开序列 ( )。`<!CDATA[`假设文档格式最低限度，这应该意味着当前位置在 CDATA 部分内。

糟糕，我倒退了：通过使用积极的前瞻，我只在 CDATA 部分中匹配“裸”与号。我将其更改为负前瞻，所以现在它可以正常工作了。

顺便说一句，这个正则表达式可以在 Ruby 模式下的 RegexBuddy 中工作，但不能在[rubular 站点上工作](http://www.rubular.com/)。我怀疑 Rubular 使用的是旧版本的 Ruby，对正则表达式的支持较弱。任何人都可以确认吗？（你可能已经猜到了，我不是 Ruby 程序员。）

编辑：Rubular 的问题是我使用“s”作为修饰符（表示点匹配一切），但 Ruby 使用“m”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-21T03:28:30.553

不要为此使用正则表达式。这是一个可怕的、可怕的想法。相反，只需对您输出的任何可能包含字符的内容进行 HTML 编码。像这样：

```
require 'cgi'
print CGI.escape("All of this is HTML encoded!") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-22T18:43:45.620

那行得通！在[Rubular](http://www.rubular.com)，我不得不将选项从`/xs`to更改`/m`（并且我删除了分隔正则表达式两部分的空格，如您在上面显示的那样）。

[您可以在http://www.rubular.com/regexes/5855](http://www.rubular.com/regexes/5855)上查看此正则表达式以及示例字符串。

如果 Rubular 永久链接不是真正永久的，这是我为正则表达式输入的内容：

```
/&(?!(?:[a-zA-Z][a-zA-Z0-9]*|#\d+);)(?!(?>(?:(?!<!\[CDATA\[|\]\]>).)*)\]\]>)/m 
```

这是测试字符串：

```
<p>a & b</p>
<p>c &amp; d</p>
<script type="text/javascript">
  // <![CDATA[
  if (a && b) doSomething('a & b &amp; c');
  // ]]>
</script>
<p>a & b</p>
<p>c &amp; d</p> 
```

只有两个＆符号匹配 -`a & b`顶部和`a & b`底部。& 符号已经逃逸，`&amp;`并且所有 & 符号（无论是否逃逸）`<![CDATA[`都`]]>`被单独留下。

所以，我的最终代码现在是这样的：

```
html.gsub(/&(?!(?:[a-zA-Z][a-zA-Z0-9]*|#\d+);)(?!(?>(?:(?!<!\[CDATA\[|\]\]>).)*)\]\]>)/m, '&amp;') 
```

非常感谢艾伦。这正是我所需要的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T20:09:01.380

我在这里做了类似的事情：
[Best way to encode text data for XML](https://stackoverflow.com/questions/157646/best-way-to-encode-text-data-for-xml)

幸运的是，就我而言，CDATA 不是问题。

问题是你必须小心这个表达式不是贪婪的，否则你会得到这样的结果：

`.... <words> are < safe! >`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-20T22:00:56.597

我严重怀疑您要完成的工作是否可以仅使用正则表达式来完成。正则表达式在正确处理嵌套方面是出了名的糟糕。

使用 XML 解析器而不是转义 CDATA 内容可能会更好。

# c# - 改进/修复 C 样式块注释的正则表达式

> ID：462843
> 
> 赞同：10
> 
> 时间：2009-01-20T19:53:48.430
> 
> 标签：c#, c, regex, parsing, comments

我正在（用 C# 编写）一个简单的解析器来处理一种看起来很像经典 C 的脚本语言。

在我拥有的一个脚本文件中，我用来识别 /* 块注释 */ 的正则表达式正在进入某种无限循环，占用 100% 的 CPU 时间。

我正在使用的正则表达式是这样的：

```
/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+/ 
```

关于为什么这可能会被锁定的任何建议？

或者，我可以使用什么其他正则表达式来代替？

更多信息：

*   在面向 .NET 3.5 的 C# 3.0 中工作；
*   我正在使用 Regex.Match(string,int) 方法在字符串的特定索引处开始匹配；
*   我已经让程序运行了一个多小时，但比赛还没有完成；
*   传递给 Regex 构造函数的选项是`RegexOptions.Multiline`and `RegexOptions.IgnorePatternWhitespace`;
*   正则表达式适用于我的 453 个测试文件中的 452 个。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-20T22:06:10.847

我在您的正则表达式中看到的一些问题：

您的正则表达式中不需要`|[\r\n]`序列；否定字符类 like`[^*]`匹配除 之外的所有内容`*`，包括行分隔符。只有`.`（点）元字符与这些元字符不匹配。

进入评论后，您唯一需要寻找的字符就是星号；只要您没有看到其中之一，您就可以吞噬任意数量的角色。`[^*]`这意味着当你可以使用时使用它是没有意义的`[^*]+`。事实上，你不妨把它放在一个原子组中`(?>[^*]+)`——因为一旦你匹配了这些非星号，你将永远没有任何理由放弃它们。

过滤掉多余的垃圾，最外层括号内的最后一个选择是`\*+[^*/]`，这意味着“一个或多个星号，后跟一个不是星号或斜杠的字符”。这将始终与注释末尾的星号匹配，并且总是不得不再次放弃它，因为下一个字符是斜杠。事实上，如果在最后一个斜线之前有 20 个星号，那么你的正则表达式的那部分将匹配它们，然后它会一个接一个地放弃它们。然后最后一部分--`\*+/`将匹配它们以保持不变。

为了获得最佳性能，我会使用这个正则表达式：

```
/\*(?>(?:(?>[^*]+)|\*(?!/))*)\*/ 
```

这将很快匹配格式良好的评论，但更重要的是，如果它开始匹配*不是*有效评论的内容，它将尽快失败。

* * *

由[David](https://stackoverflow.com/questions/462843/improving-fixing-a-regex-for-c-style-block-comments/463339?noredirect=1#comment55996077_463339)提供，这是一个将嵌套注释与任何嵌套级别匹配的版本：

```
(?s)/\*(?>/\*(?<LEVEL>)|\*/(?<-LEVEL>)|(?!/\*|\*/).)+(?(LEVEL)(?!))\*/ 
```

它使用 .NET 的平衡组，因此它不会以任何其他方式工作。为了完整起见，这是另一个版本（来自 RegexBuddy 的库），它使用 Perl、PCRE 和 Oniguruma/Onigmo 支持的递归组语法：

```
/\*(?>[^*/]+|\*[^/]|/[^*])*(?>(?R)(?>[^*/]+|\*[^/]|/[^*])*)*\*/ 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2010-10-15T20:05:54.293

不不不！没有其他人读过掌握正则表达式（第 3 版）！？在这篇文章中，Jeffrey Friedl 研究了这个确切的问题并将其用作示例（第 272-276 页）来说明他的“展开循环”技术。他对大多数正则表达式引擎的解决方案是这样的：

`/\*[^*]*\*+(?:[^*/][^*]*\*+)*/`

然而，如果正则表达式引擎被优化为处理惰性量词（就像 Perl 的那样），那么最有效的表达式要简单得多（如上面所建议的）：

`/\*.*?\*/`

（当然应用了等效的 's' “点匹配所有”修饰符。）请注意，我不使用 .NET，所以我不能说哪个版本对于该引擎来说更快。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-20T20:14:38.700

您可能想尝试使用 Singleline 而不是 Multiline 选项，那么您不必担心 \r\n。启用此功能后，以下对我有用的简单测试包括跨越多行的注释：

```
/\*.*?\*/ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T20:15:33.143

我觉得你的表达方式太复杂了。应用于大字符串，许多替代方案意味着很多回溯。我想这是你看到的性能影响的来源。

如果基本假设是匹配从`"/*"`直到`"*/"`遇到第一个的所有内容，那么一种方法是这样（像往常一样，正则表达式不适合嵌套结构，因此嵌套块注释不起作用）：

```
/\*(.(?!\*/))*.?\*/             // run this in single line (dotall) mode 
```

从本质上讲，这表示：`"/*"`，后面是任何本身没有跟随的东西`"*/"`，然后是`"*/"`。

或者，您可以使用更简单的：

```
/\*.*?\*/                       // run this in single line (dotall) mode 
```

像这样的非贪婪匹配有可能在极端情况下出错——目前我想不出这个表达式可能会失败，但我不完全确定。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-05-10T23:01:31.140

我现在正在使用这个

```
\/\*[\s\S]*?\*\/ 
```

# c# - 库的设计时验证

> ID：462853
> 
> 赞同：4
> 
> 时间：2009-01-20T19:57:19.140
> 
> 标签：c#, winforms

我有一个想要许可和分发的库。

我知道如何为运行时许可类/库。实际上，我已经这样做了好几次了。我知道如何许可用户控件。我也做过几次。

让我难过的是如何许可一个库（没有拖放用户控件或组件）仅用于开发。您如何为设计时授权库？

有什么想法/提示吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-20T20:46:31.803

我终于找到了答案。这一点并不像我想象的那么明显。

您需要查看是否附加了调试器，而不是查找 DesignTime 或 RunTime 属性。

将它放在构造函数中（在您的类中使用适当的属性），然后您就可以开始运行了！！

 `````
if (System.Diagnostics.Debugger.IsAttached)
{
    License L = LicenseManager.Validate(typeof(MyControl), this);
} 
````  `我希望这可以帮助其他有同样问题的人！！

- 杰瑞

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-08-28T03:58:15.093

您可以使用 LibraryManager.UsageMode 来确定您是否在设计时运行。我假设您也希望从您发布的答案中检查调试运行。

# coldfusion - Migrating from ColdFusion MX (6, I think) to ColdFusion 7

> ID：462855
> 
> 赞同：2
> 
> 时间：2009-01-20T19:58:12.523
> 
> 标签：coldfusion, adobe, upgrade, backwards-compatibility, macromedia

I'm thinking of migrating my sites from [ColdFusion MX](http://en.wikipedia.org/wiki/ColdFusion#ColdFusion_MX_6) to [ColdFusion 7](http://en.wikipedia.org/wiki/ColdFusion#ColdFusion_MX_7). Are there any issues I should be aware of? I heard that ColdFusion is backwards compatible.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-01-28T12:46:41.543

在您的应用程序上使用 ColdFusion MX7 的[代码兼容性分析器](http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=Debug_18.html)。

另请参阅[“ColdFusion MX7 文档”](http://livedocs.adobe.com/coldfusion/7/htmldocs/wwhelp/wwhimpl/js/html/wwhelp.htm)。

# version-control - Perforce，多个解决方案之间共享的项目

> ID：462856
> 
> 赞同：0
> 
> 时间：2009-01-20T19:58:20.853
> 
> 标签：version-control, perforce

**更新**：

所以事实证明，我们可能在 Visual Studio 2003 中发现了一个错误（我知道……这并不奇怪）。我们发现，如果使用 Visual Studio（使用将解决方案添加到源代码管理）将解决方案添加到存储库中，一切都很好......去图吧。

* * *

因此，我们正在将我们的 VSS 存储库（如果可以调用它的话）转换为 Perforce，并且我们遇到了多个解决方案中包含的项目的问题。

我们的存储库可能看起来像这样......

*   //仓库
    *   开发主程序
        *   解决方案1
            *   Project1（构建到 DLL）
        *   解决方案 2（以 Project1 作为项目参考）
            *   项目2
        *   解决方案 3（以 Project1 作为项目参考）
            *   项目3

在 Visual Studio for Solution2 中使用集成的源代码管理时，它抱怨项目不在当前解决方案文件夹下，我们可能想要移动它。因为多个解决方案引用了项目 1，我们永远无法将它组织到一个解决方案不会抱怨的地方......

将 Project1 构建为 DLL 并将其存储在 Lib 文件夹中的最佳做法是什么？或者，还有更好的方法？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T15:19:36.750

我们遇到了类似的问题，并且非常像@Toby Allen 在他的回答中提到的那样，通过客户规范来解决它。然而，随着时间的推移，这变得非常痛苦（随着客户规范变得越来越复杂，建立新的团队成员变得越来越困难；自动化也更加复杂，因为事情......“不断变化”:-)）。

最终，我们改进了我们的策略，改为使用目录结构和分支。目录结构如下：

```
//depot
    /products
        /(product_name)
            /doc
            /lib
                /(3rd_party_libname)
                    (DLLs)
                /(another_3rd_party_libname)
                    (DLLs)
            /src
                /Project1
                    (files, csproj, vbproj, etc)
                /Project2
                    (files, csproj, vbproj, etc)
                /Project3
                    (files, csproj, vbproj, etc)
            Solution1.sln (includes src/Project1)
            Solution2.sln (includes src/Project1, src/Project2)
            Solution3.sln (includes src/Project1, src/Project3)
        /(another_product_name)
            /doc
            /lib
            /src
            (solutions)
    /shared
        /(shared_lib_name)
            /doc
            /lib
            /src
            (solutions)
        /(another_shared_lib_name)
            /doc
            /lib
            /src
            (solutions) 
```

请注意，在整个结构中重复相同的结构 (doc/lib/src/solutions)。Lib 包含“外部”库 - 项目引用中包含的第 3 方库。Src 包含属于特定产品的所有项目的平面列表。然后使用解决方案以多种方式“组合”项目。我将 src 目录视为具有“可用内容”的容器，然后从该容器中挑选解决方案并组合项目（根据需要）。

在多个产品之间共享的库进入共享目录。一旦进入共享目录，它们就被视为独立于产品——它们有自己的发布周期，并且永远不会作为源加入产品。通过将共享库发布程序集/程序集分支到产品的**lib**目录中，将共享库拉入产品 -> 从产品的角度来看，第 3 方库和共享库之间没有区别。这使我们能够控制哪些产品正在使用哪个版本的共享库（当产品需要新功能时，它必须明确分支到共享库的新版本中，就像它包含新版本的第 3 方库一样，以及随之而来的所有优点和缺点）。

总之，我们的结构有两种“类型”共享库的概念：

*   产品本地的项目，由多个解决方案使用（包含在 src 目录中的平面项目列表中，多个解决方案可以引用它们）
*   多个产品使用的项目（添加到共享目录，被视为具有独立于产品版本的第 3 方库）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-21T19:53:29.023

我不太了解将 Visual Studio 与 Perforce 结合使用，但您可以考虑在需要时创建将 Project1 映射到 Solution2、Solution3 等的工作区视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-23T09:04:53.730

If I understand correctly you want how your files are stored on disk to differ from how it is stored in Perforce. If this is the case, and you cant simply redefine the reference within VS, then a cleverly designed client can do the trick.

```
Client: Client_Solution2

Description:
Created by Me.

Root:   C:/Development/Solutions

View:
//depot/Devmain/Solution1/... //Client_Solution2/Solution2/Solution1/...
    //depot/Devmain/Solution2/... //Client_Solution2/Solution2/... 
```

This will give you a structure where Solution1 is a sub directory of solution 2.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T20:02:54.777

解决方案应该是在每次将 Solution1 添加到新项目时将其重新绑定到源代码控制服务器。（它在文件-> 源代码管理-> 更改源代码管理下。）

每个解决方案的每个桌面只需要执行一次。

# javascript - 我可以使用 Javascript 与 Camtasia 的播放器互动吗？

> ID：462859
> 
> 赞同：3
> 
> 时间：2009-01-20T19:58:34.050
> 
> 标签：javascript, camtasia

我有一个网站，我正在展示用 Camtasia 录制的 2 个“教程”视频。
他们都是“自动启动=假”

我正在使用 mp4 文件和 movie_controller.swf 文件的组合。

我希望能够通过 Javascript 开始一部电影（我假设这是可能的），并且在电影结束时也能在 Javascript 中得到通知。

这可能吗？它在任何地方都有记录吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-27T00:14:52.297

只是为了记录我的发现，以防其他人需要这样做......

不，你不能。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-01-20T20:29:51.057

抱歉，但是： [http ://www.google.com.ar/search?q=start+a+movie+through+Javascript](http://www.google.com.ar/search?q=start+a+movie+through+Javascript)

[http://www.swishtalk.com/showthread.php?p=9678](http://www.swishtalk.com/showthread.php?p=9678)

[http://www.permadi.com/tutorial/flashGetObject/](http://www.permadi.com/tutorial/flashGetObject/)

# c++ - 用于图像识别的 C++ 库：包含单词到字符串的图像

> ID：462860
> 
> 赞同：6
> 
> 时间：2009-01-20T19:58:55.300
> 
> 标签：c++, fonts, ocr, image-recognition

有谁知道用于拍摄图像并对其执行图像识别的 c++ 库，以便它可以根据给定的字体和/或字体高度找到字母？即使是不允许您选择字体的字体也会很好（例如：readLetters(Image image)。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-23T07:20:30.507

我最近一直在研究这个。你最好的就是 Tesseract。如果您需要在 OCR 之上进行布局分析，而不是使用 Ocropus（后者又使用 Tesseract 进行 OCR）。布局分析是指能够检测图像上文本的位置，并进行线分割、块分割等。

通过对 Tesseract 的实验，我发现了一些非常好的技巧，值得分享。基本上我必须对图像进行大量预处理。

1.  将输入图像放大/缩小到 300 dpi。
2.  从图像中去除颜色。灰度很好。我实际上使用了一个抖动阈值并将我的输入设置为黑白。
3.  从您的图像中删除不必要的垃圾。对于以上所有三个，我使用 netbpm（一组用于 unix 的图像处理工具）来达到我所需要的几乎 100% 的准确度。

如果你有一个高度定制的字体并且单独使用 tesseract，你必须“训练”系统——基本上你必须提供一堆训练数据。这在 tesseract-ocr 网站上有很好的记录。您实质上为您的字体创建了一种新的“语言”，并使用 -l 参数将其传入。

我发现的另一种训练机制是使用 Ocropus 使用神经网络 (bpnet) 训练。建立一个好的统计模型需要大量的输入数据。

在调用 Tesseract/Ocropus 方面都是 C++。它不会像 ReadLines(Image) 那样简单，但是您可以查看一个 API。您也可以通过命令行调用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-20T20:06:10.323

虽然我不能特别推荐一个，但您正在寻找的术语是 OCR（光学字符识别）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-20T20:06:36.703

有[tesseract-ocr](http://code.google.com/p/tesseract-ocr/)这是一个专业的图书馆来做到这一点。

从那里的网站

> Tesseract OCR 引擎是 1995 年 UNLV 精度测试中排名前三的引擎之一。从 1995 年到 2006 年，它几乎没有做任何工作，但它可能是可用的最准确的开源 OCR 引擎之一

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T20:07:51.803

我想你想要的是[猜想](http://www.corollarium.com/conjecture/)。曾经是 libgocr 项目。我已经有几年没有使用它了，但是如果您设置了密钥，它曾经非常可靠。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-12-21T04:43:06.830

[Tesseract OCR 库](https://github.com/rmtheis/tess-two/)提供了非常准确的结果，它是一个 C 和 C++ 库。我最初的结果准确率约为 80%，但在提供 OCR 之前对图像进行预处理，结果准确率约为 95%。什么是预处理：

1）对位图进行二值化（B&W 对我来说效果更好）。[怎么做](https://stackoverflow.com/a/16528661/5450941)

2) 将图像重采样为 300 dpi

3) 以无损格式保存图像，例如 LZW TIFF 或 CCITT Group 4 TIFF。

# .net - 如何在 w2k8 中使用性能计数器

> ID：462865
> 
> 赞同：3
> 
> 时间：2009-01-20T20:00:49.290
> 
> 标签：.net, security, performancecounter, perfmon, rights-management

问题：

我可以使用普通用户权限在 w2k8 中添加+使用性能计数器。

如果我尝试创建或访问进程性能计数器，我会收到计数器不存在的消息。

可以在 powershell 中尝试相同的操作，显示计数器不存在的消息。

如果我与管理员帐户（不是任何管理员帐户，管理员帐户）做同样的事情，我可以毫无问题地访问计数器。

其他计数器（如处理器）与普通用户或管理员用户帐户一起工作正常。

那么在不需要管理员帐户的情况下从（比如说.net）程序访问进程计数器需要什么？

蒂亚

ps 不，我不会登录。不喜欢 OpenID

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-20T21:09:05.907

您可以在没有管理员帐户的情况下访问它，但是您使用的任何帐户都必须是管理员，并且具有管理员权限。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T06:41:55.347

我假设您正在使用 WMI 来创建和读取性能计数器，否则您将获得 UnauthorizedAccessException。除非我们知道您使用什么语言和真正的方法来执行此操作，否则我们不会提供太多帮助。

有一些方法可以使用 Longhorn 内核，它们不依赖于对本地系统进行更改来使其工作。确保您的应用程序已签名并在项目中使用正确的权限会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-21T07:55:04.743

只有这种类型的计数器不起作用的另一个帐户具有本地管理员权限。因此，这不是答案。我忘了提：UAC在机器上打开了。

# c - 有没有成熟的二元决策图工具可用？

> ID：462871
> 
> 赞同：2
> 
> 时间：2009-01-20T20:02:21.487
> 
> 标签：c, data-structures, binary-decision-diagram

是否有任何用于 C 或其他经过测试并具有良好文档的语言的二进制决策图 (BDD) 库？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-20T20:08:54.047

从 CMU检查[BDD 库](http://www-2.cs.cmu.edu/~modelcheck/bdd.html)。

此外，出于基本参考目的，计算机编程艺术的前分册 1b 都是关于 BDD 的。这是它的[压缩后记](http://www-cs-faculty.stanford.edu/~knuth/fasc1b.ps.gz)。[Knuth 在他的 Programs to Read 页面](http://www-cs-faculty.stanford.edu/~knuth/programs.html)上发布了一些他在准备时编写的程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-08-31T21:13:03.453

查看[CUDD](http://vlsi.colorado.edu/~fabio/CUDD/)。

有关如何在 Windows 环境中进行设置的一些信息，请尝试[此..](http://technical-recipes.com/?p=329)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-30T07:42:11.803

*二进制决策图维基*百科条目，在[外部链接](http://en.wikipedia.org/wiki/Binary_decision_diagram#External_links)部分，作为一个非常完整的包列表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-08-31T21:18:19.710

[BDDBDDB](http://bddbddb.sourceforge.net/)是一个基于 BDD 的系统，用于解决类似于 Prolog 的逻辑推理。它已被用于程序分析、一般游戏和许多其他领域。它可能不是您正在寻找的东西，但它是众所周知且维护良好的。

# mysql - 使用 ActiveRecord 和 MySQL 插入 DATETIME

> ID：462877
> 
> 赞同：3
> 
> 时间：2009-01-20T20:05:38.577
> 
> 标签：mysql, ruby, datetime, activerecord

我在 ActiveRecord 根据文档插入 DATETIME 时遇到问题；“如果表有名为 created_at/created_on 或 updated_at/updated_on 的字段，Active Record 会自动为创建和更新操作添加时间戳。” 我有一个名为 created_at 的列，但 ActiveRecord 没有插入 DATETIME。我的插入查询如下所示：

```
def add_record(server_id, backup_type)
  Record.create(:server_id => server_id, :backup_type => backup_type)
end 
```

我知道我可以使用类似的东西插入时间

```
:created_at => "#{Time.now.strftime("%Y-%m-%d %H:%M:%S")}" 
```

我想远离它的原因是服务器之间的时间差异，无论是在本地还是在地理上。我想知道是否有办法在相同的创建方法中运行类型，例如：

```
def add_record(server_id, backup_type)
  Record.create(:server_id => server_id, :backup_type => backup_type, created_at => DATETIME())
end 
```

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T20:38:45.920

您有一个 created_at 列，但 ActiveRecord 没有创建时间戳？created_at 列的列类型是什么？也许您可以向我们展示您的迁移？

此外，如果您告诉 Rails 使用 UTC（我认为默认为 2.2），那么无论服务器语言环境如何，时间值都是正确的。

最后：你可以只传递一个时间/日期/日期时间实例，你不必自己格式化。例如`YourModel.create(:a_time_column => Time.now)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T20:28:02.790

如果 created_at 字段类型是[TimeStamp](http://dev.mysql.com/doc/refman/5.0/en/timestamp.html)，那么您可以使用函数[CURRENT_TIMESTAMP()](http://dev.mysql.com/doc/refman/5.0/en/date-and-time-functions.html#function_current-timestamp)来设置字段的值。

# c# - 转换列表 > 进入列表 在 C# 中

> ID：462879
> 
> 赞同：22
> 
> 时间：2009-01-20T20:06:07.017
> 
> 标签：c#, linq, generics, list, union

我有一个`List<List<int>>`. 我想将其转换为`List<int>`每个 int 都是唯一的。我想知道是否有人使用 LINQ 有一个优雅的解决方案。

我希望能够使用 Union 方法，但它每次都会创建一个新的 List<> 。所以我想避免做这样的事情：

```
List<int> allInts = new List<int>();

foreach(List<int> list in listOfLists)
   allInts = new List<int>(allInts.Union(list)); 
```

有什么建议么？

谢谢！

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-01-20T20:12:46.160

```
List<List<int>> l = new List<List<int>>();

l.Add(new List<int> { 1, 2, 3, 4, 5, 6});
l.Add(new List<int> { 4, 5, 6, 7, 8, 9 });
l.Add(new List<int> { 8, 9, 10, 11, 12, 13 });

var result = (from e in l
              from e2 in e
              select e2).Distinct(); 
```

### 更新 09.2013

但是这些天我实际上会把它写成

```
var result2 = l.SelectMany(i => i).Distinct(); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-20T20:36:07.877

```
List<int> result = listOfLists
  .SelectMany(list => list)
  .Distinct()
  .ToList(); 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-20T20:09:49.380

怎么样：

```
HashSet<int> set = new HashSet<int>();
foreach (List<int> list in listOfLists)
{
    set.UnionWith(list);
}
return set.ToList(); 
```

# c# - 无效操作异常

> ID：462886
> 
> 赞同：0
> 
> 时间：2009-01-20T20:07:20.570
> 
> 标签：c#, .net, sql-server, database

是否有人在故障转移配置中使用 SQL Server 2005 和数据访问应用程序块时遇到此错误？

“InvalidOperationException 框架数据提供程序错误 6”

当 SQL Server 处于故障转移配置中时，它似乎不定期地出现在我们的服务器应用程序中并且更频繁地发生？在进行一些研究时，我看到 MS 在 .NET 2.0 sp1 中发布了一个补丁，但是，该补丁没有前滚或捆绑在最新的 .NET 服务包中，如果未来的服务包会覆盖它，我们不愿意实施它。

我们的服务器目前使用 .NET 3.5 sp1 和最新的 MS 数据访问应用程序块实现。

任何帮助或指导将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-20T20:16:22.893

我用谷歌搜索了一下，发现一些人通过更换连接数据库服务器的网线解决了这个问题。这些类型的错误很棘手 - 您是否有 Microsoft 支持合同？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-02T17:28:59.183

以防万一有人感兴趣...

我确实在 .NET 3.5 sp1 KB 文章 944099 中显示了 MS[对此问题的修复。](http://support.microsoft.com/kb/951847)如果您应用了之前的 2.0 修复然后升级到 3.5，您的补丁将被错误的 System.Data.dll 覆盖。至少在我们的案例中似乎是这样的。

我们已经用打补丁的服务器运行我们的系统近一周了，到目前为止一切都很好。

# java - JPA 未生成“在删除集为空时”FK 限制

> ID：462898
> 
> 赞同：10
> 
> 时间：2009-01-20T20:09:08.210
> 
> 标签：java, hibernate, orm, jpa, foreign-keys

我有两个相关的类 JPA 注释。警报和状态。一个警报可以有一个状态。

我需要的是能够删除一个状态并将空值“传播”到已删除的状态中的警报。

也就是说，我需要将外键定义为“ **on delete set null** ”。

```
@Entity
public class Alarm {
    @Id
    @GeneratedValue(strategy=GenerationType.SEQUENCE, generator="sequence")
    @SequenceGenerator(name="sequence", sequenceName="alarm_pk_seq")
    private Integer id;

    @OneToOne(cascade=CascadeType.ALL)
    @JoinColumn(name="idStatus")
    private Status status;

    // get/set
}

@Entity
public class Status {
    @Id
    @Column(name="idStatus")
    private Integer id;

    private String description;

    // get/set
} 
```

例子：

前：

```
STATUS
id  description
1   new
2   assigned
3   closed

ALARMS
id  status
1   1
2   2
3   2 
```

之后（删除id=2的状态）

```
STATUS
id  description
1   new
3   closed

ALARMS
id  status
1   1
2   NULL
3   NULL 
```

我正在使用 Hibernate 和 PostgreSQL，从源代码自动生成数据库。我已经尝试了所有可能的 CascadeType 都没有成功。

代码有什么问题吗？可以用 JPA 做到这一点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-25T15:36:28.313

只需使用 Hibernate 注释添加：

```
@OnDelete(action=OnDeleteAction.CASCADE) 
```

将外键生成为：“ON UPDATE NO ACTION ON DELETE CASCADE;”

但是没有action=OnDeleteAction.SET_NULL

此外，如果可能的话，我不喜欢将我的代码绑定到 Hibernate（但如果它有效，我可以接受它）。

这个[线程](http://forum.hibernate.org/viewtopic.php?t=946681&view=previous&sid=a292f0816e8d2bbc7dcf84327b8df596)讨论它。我不敢相信 JPA（或 Hibernate 扩展）中没有一种简单的方法来生成外键。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T15:56:53.843

在您的情况下，您正在从类生成数据库。这意味着您不会将数据库用于其他目的（因为这样做会迫使您拥有 DDL 脚本）。这意味着在数据库或 java 代码中实现此规则并不重要。

我们还知道 Hibernate 会在删除一个或多个状态并尝试在没有级联的情况下提交时引用它的情况下引发瞬态异常。

此外，数据库将使用外键约束生成。

这意味着必须遵守约束才能使应用程序正常工作。

如果您的实体自己在一个罐子里，您可以在警报或状态界面中添加一个临时方法以在遵守规则的同时删除状态。

此外，程序员在使用实体时将被迫遵守规则，否则代码将无法工作。但是为了使任务更容易，您可以使关系双向，以便从状态中跟踪警报的任务变得更容易。

如果可以，请使用 ondelete 拦截器/侦听器将 alarm.status 属性设置为 null。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-09T06:55:38.310

不知道其他非休眠实现，但这是我在休眠中一直关注的一个 JIRA 问题......

[http://opensource.atlassian.com/projects/hibernate/browse/HHH-2707](http://opensource.atlassian.com/projects/hibernate/browse/HHH-2707)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-22T08:40:16.773

你确定你的@OneToOne 吗？在我看来，您宁愿使用 @ManyToOne （因为状态可能会受到多个警报的影响）：

```
@Entity
public class Alarm {
    ...

    @ManyToOne(cascade=CascadeType.ALL)
    @JoinColumn(name="idStatus", nullable=true)
    private Status status;

    ...
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-10-15T20:19:43.100

OpenJPA 有

```
@ForeignKey(deleteAction=ForeignKeyAction.NULL) 
```

但是没有标准的 JPA 方法可以做到这一点（显然使用 Hibernate 是不可能的）。

让我想回到 JDO。

# reporting-services - Reporting Services 使用多个工作表导出到 Excel

> ID：462902
> 
> 赞同：53
> 
> 时间：2009-01-20T20:10:09.113
> 
> 标签：reporting-services

我目前正在构建一个呈现为 excel 的 MS Reporting Services 报告。我试图弄清楚如何设置报告，以便在报告上创建多个数据工作表（选项卡）。我知道在报告中输入分页符会给你一个新的工作表，但是，有没有办法命名每个选项卡而不是默认为（工作表 1，工作表 2）等。

有谁知道这是怎么做到的？

提前致谢！

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2010-11-30T08:56:52.653

问题的原始提问者迟到了，但是使用 SQL Server 2008 R2 现在可以：

在 tablix 或 table 或其他元素上设置属性“Pagebreak”以强制新选项卡，然后在分页符之前的元素和分页符之后的元素上设置属性“Pagename”。当报告导出到 Excel 时，这些名称将出现在选项卡上。

在这里阅读：[http ://technet.microsoft.com/en-us/library/dd255278.aspx](http://technet.microsoft.com/en-us/library/dd255278.aspx)

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2014-01-15T16:15:03.137

下面是 SQL Server 2008 R2 的屏幕截图，使用 Visual Studio 2010 中的 SSRS 报表设计器。

我做了截图，因为有些对话框不容易找到。

**1：添加组**

![SsrsAddGroup](https://i.stack.imgur.com/3Oncz.png)

**2：指定要分组的字段**

![SsrsAddGroupDialog](https://i.stack.imgur.com/ZhsD0.png)

**3：现在单击报表设计器正下方的“行组”选择器中的组**

![SsrsRowGroupsSelector](https://i.stack.imgur.com/fCyc1.png)

**4：F4选择属性窗格；展开 'Group' 并设置 Group > PageBreak > BreakLocation = 'Between'，然后为 Group > PageName 输入您想要的表达式**

![SsrsGroupProperty](https://i.stack.imgur.com/x6nAs.png)

**5：这是一个示例表达式**

![SsrsGroupPropertyDialog](https://i.stack.imgur.com/W2UmH.png)

**这是导出到 Excel 的报告的结果，选项卡根据 PageName 表达式命名**

![SsrsExcelTabs](https://i.stack.imgur.com/pG95N.png)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-01-20T20:30:55.827

正如[@huttelihut 指出的那样](https://stackoverflow.com/a/4311980/6088)，这现在可以从 SQL Server 2008 R2 开始 -[在此处阅读更多](http://technet.microsoft.com/en-us/library/dd255278.aspx)

在 2008 R2 之前，这似乎是不可能的，但[MSDN Social](http://social.msdn.microsoft.com/Forums/sqlserver/en-US/4876ffe0-f0c0-413e-9890-0c85615b3edf/in-ssrs-after-export-into-excel-how-to-give-sheet-name?forum=sqlreportingservices)有一些建议的解决方法。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-01-29T18:48:12.390

爱德华的解决方案对我有用。

如果您希望将整个 tablix 放在一张具有常量名称的工作表上，请在 tablix 的 Properties 中指定 PageName。如果在 tablix 的 Properties 中设置 PageName，则不能在表达式中使用来自 tablix 数据集的数据。

如果您希望将 tablix 中的行分组到工作表中（或者您希望一个工作表的名称基于数据），请在组标题中指定 PageName。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-08-10T16:43:10.553

我在 2005 年找到了解决此问题的简单方法。以下是我的步骤：

1.  创建一个名为“PageBreaks”的字符串参数，其值为“Y”和“N”。
2.  在用于将数据拆分到 Excel 中的多个工作表的组（值）之上添加一个组级别。
3.  插入到该组的第一个文本框字段中，'PageBreaks' 的表达式是这样的...... `=IIF(Parameters!PageBreaks.Value="Y",Fields!DISP_PROJECT.Value,"")` 注意：如果参数 ='Y'，那么您将获得每个不同值的多个工作表。否则，每个组记录的字段都为 NULL（最后只导致一个分页符）。
4.  将新分组行的可见性隐藏值更改为“真”。
5.  注意：当您这样做时，它还将确定您在视图中是否有分页符，但我的用户喜欢它，因为他们拥有控制权。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-06-15T12:25:53.073

将选项卡名称放在报表的页眉或组 TableRow1 上，以便它出现在每个 Excel 工作表的“A1”位置。然后在您的 Excel 工作簿中运行此宏。

```
Sub SelectSheet()
        For i = 1 To ThisWorkbook.Sheets.Count
        mysheet = "Sheet" & i
        On Error GoTo 10
        Sheets(mysheet).Select
        Set Target = Range("A1")
        If Target = "" Then Exit Sub
        On Error GoTo Badname
        ActiveSheet.Name = Left(Target, 31)
        GoTo 10
Badname:
        MsgBox "Please revise the entry in A1." & Chr(13) _
        & "It appears to contain one or more " & Chr(13) _
        & "illegal characters." & Chr(13)
        Range("A1").Activate
10
        Next i
End Sub 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-07-13T15:12:24.863

根据您希望工作表所基于的类别对报告数据进行分组。指定您希望该分组为每个新类别开始一个新页面。每个页面都成为 Excel 工作簿中的一个新工作表。

注意：我使用 SQL Server 2003 和 Excel 2003。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-14T10:54:18.100

在组上按 F4 并查找页面名称，在属性上并命名您的页面，这应该可以解决您的问题

# .net - 关闭应用时提示用户保存

> ID：462903
> 
> 赞同：5
> 
> 时间：2009-01-20T20:10:45.197
> 
> 标签：.net, winforms, shutdown, application-shutdown

我正在写归结为文档编辑器的内容。当应用程序关闭时，我需要提示用户保存更改。这很容易。我的问题是什么时候*不*提示用户是合适的，而是简单地丢弃未保存的数据并关闭。

在 FormClosing 事件中，CloseReason 枚举包括：

*   没有任何
*   Windows关机
*   MdiFormClosing
*   用户关闭
*   任务管理器关闭
*   FormOwnerClosing
*   应用程序退出调用

我认为 WindowsShutDown 和 TaskManagerClosing 不应该导致“保存更改？” 提示出现，以防止应用程序在显示该提示时挂起。

这是标准做法，还是我应该在这里做其他事情？

为清楚起见，这是代码：

```
protected override void OnFormClosing(FormClosingEventArgs e)
{
    base.OnFormClosing(e);

    if (!(e.CloseReason == CloseReason.WindowsShutDown || e.CloseReason == CloseReason.TaskManagerClosing)
            && this.ChangesPending())
    {
        switch (MessageBox.Show(this, "Save changes?", "Save Changes", MessageBoxButtons.YesNoCancel))
        {
            case DialogResult.Yes:
                this.Save();
                break;
            case DialogResult.No:
                // Do nothing
                break;
            case DialogResult.Cancel:
                e.Cancel = true;
                break;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T20:18:48.240

我认为`TaskManagerClosing`应该是唯一不提示的原因，如果有的话。就个人而言，我希望在`WindowsShutDown`. 如果我在某处使用未保存的文档关闭 Windows，则意味着我已经忘记了它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-20T20:19:41.700

我肯定还会在 WindowsShutDown 上显示“您要保存”对话框（例如，应用程序可能已经在后台运行了一段时间而用户忘记了它，或者他可能在服务包后单击了“重新启动”安装时不假思索等）。

至于TaskManagerClosing，在这种情况下我不会显示对话框。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T20:19:16.803

我个人更喜欢在用户选择关闭时关闭程序，如果在关闭时有任何未保存的文档，我更愿意保留这些文件的备份副本，并在用户下次打开应用程序时通知用户有未保存的文档。

我这样做有几个原因，第一，我希望我的应用程序在我告诉它们关闭时关闭，第二，我保留文件的临时副本，当用户使用它时我会更新所有更改，我会保护它防止意外崩溃和关闭我的应用程序。

因此，使用这种技术，您无需担心应用程序是否已关闭。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T20:23:03.923

CloseReason 真的是一个有争议的问题，不是吗？您的表单正在消失的事实是您想要捕捉的。

现在您需要知道您的应用程序是否已经处理了“保存”事件。如果是这样，表格可以消失。您已保存文档。但如果没有，您可能需要提示用户。

如果您可以快速验证数据（即，与文件中的数据相比，对文档进行字符串比较或哈希比较），那么您将知道用户是否保存了表单数据。

否则，如果有很多字段，并且检查每个字段都是资源禁止的，那么在您的表单上放置一个“isDirty”标志。让 Save() 方法将 isDirty 设置为 false，并且所有其他字段更改都将其设置为 true。

然后，在 formClosing 中，您只需要：

 `````
protected override void OnFormClosing(FormClosingEventArgs e)
{
    if (isDirty) 
    {
        DialogResult R = MessageBox.Show(this, "Save changes?", "Save Changes", 
                MessageBoxButtons.YesNoCancel);

        if (R == DialogResult.Yes)
        {
            this.Save();
        } else if (R == DialogResult.Cancel)
        {
            e.Cancel = true;
        }
    }
} 
````  `* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-20T20:49:45.493

我认为甚至`TaskManagerClosing`可以使用提示来保存。如果您的应用程序响应正常，通过任务管理器关闭它应该与任何其他关闭它的方式没有什么不同。如果它被挂起，那么你的 onClose 处理程序做什么都没关系 - 它永远不会到达那里。

我同意@Jerry，因为如果自上次保存后数据没有更改，则避免提示保存更为重要。我通常使用一个简单的“已更改”标志，该标志在任何编辑操作中设置，并在保存和加载时清除。

# .net - Team Foundation Explorer - 首次签入

> ID：462913
> 
> 赞同：2
> 
> 时间：2009-01-20T20:13:26.940
> 
> 标签：.net, tfs

如何在 Team Foundation Server 中首次签入代码？

我创建了一个本地路径，在其中放置了一些代码，现在怎么办？点击刷新没有帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-20T20:15:48.807

您必须在项目资源管理器中右键单击解决方案，然后选择“将项目添加到源代码管理”。然后它将引导您完成将其添加到 TFS 的过程。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T20:18:30.050

如果您只想将文件添加到源代码管理而不使用解决方案，那么您需要将它们实际添加到 TFS。TFS 只会在源代码控制中显示它知道的文件。

在源代码管理资源管理器窗口中应该有一个添加文件按钮。您可以点击它并使用它将文件/文件夹添加到源代码管理。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-21T21:16:43.410

我还建议您安装最新版本的 Power Tools for TFS - 其中包括 Windows Explorer Shell（您需要为此选择自定义安装）。这将在 Windows 资源管理器中为映射到工作区的目录添加一个上下文菜单 - 因此您不必启动 Visual Studio 来执行这样的简单文件操作。

下载地址在这里：http: [//msdn.microsoft.com/en-us/tfs2008/bb980963.aspx](http://msdn.microsoft.com/en-us/tfs2008/bb980963.aspx)

# java - Java 嵌入式数据库比较

> ID：462923
> 
> 赞同：102
> 
> 时间：2009-01-20T20:17:09.490
> 
> 标签：java, database, comparison, embedded-database

我打算开发一个小型（Java）应用程序来管理我的财务。我相信我需要使用嵌入式数据库，但我对这个问题没有经验。我试图查看[一些可用的产品](http://java-source.net/open-source/database-engines)，但我无法决定哪一种更适合我。[H2](http://www.h2database.com/)、[HSQLDB](http://hsqldb.org/)、[Derby](http://db.apache.org/derby/)和[Berkeley DB](http://www.oracle.com/technology/products/berkeley-db/je/index.html)似乎是不错的候选者，但我仍然看不出它们之间的比较。感谢您帮助比较它们并帮助我决定使用哪一个。

我打算将 Hibernate 用于我的应用程序（除非您建议使用 DBMS 提供的 API），但我也希望能够使用 SQL 浏览工具（修改模式和更改数据）轻松编辑数据库。

谢谢你。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-01-20T22:12:47.680

任何一个

*   [HSQLDB](http://hsqldb.org/) - 由 OpenOffice 使用，经过测试且稳定。它很容易使用。如果你想编辑你的数据库数据，你可以打开文件并编辑插入语句。

或者

*   [H2](http://www.h2database.com/html/main.html) - 据说更快（由最初设计 hsqldb 的开发人员提供）

您使用哪一个取决于您，这取决于您需要多少性能和多少稳定性。

H2的开发者已经提出了一个很好的性能评估：
[http ://www.h2database.com/html/performance.html](http://www.h2database.com/html/performance.html)

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2008-09-11T19:03:59.330

我使用[Apache Derby](http://db.apache.org/derby/)来满足我几乎所有的嵌入式数据库需求。您也可以使用基于 Derby 的 Sun 的 Java DB，但 Derby 的最新版本要新得多。它支持商业、本地数据库支持的许多选项，但更小且更易于嵌入。我有一些数据库表，其中包含超过一百万条记录，没有问题。

大约 3 年前，我曾经使用过 HSQLDB 和 Hypersonic。当时它有一些主要的性能问题，由于这些问题，我从它切换到了 Derby。即使在 Apache 的孵化器中，Derby 也很稳定。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2013-02-03T22:57:52.307

我需要在我的一个项目中使用 Java 嵌入式数据库，并且我做了很多研究来了解每个数据库的优缺点。我写了一篇博客，列出了流行的嵌入式 Java 数据库（H2、HSQLDB、Derby、ObjectDB、Neo4j、OrientDB）的优缺点，你可以看看。我选择了 H2，因为我认为它最适合我的要求。博客链接：[http](http://sayrohan.blogspot.in/2012/12/choosing-light-weight-java-database.html) ://sayrohan.blogspot.in/2012/12/choosing-light-weight-java-database.html 希望对您有所帮助！

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2009-02-25T15:57:33.317

我会选择H2，性能比德比要好得多。阅读[http://www.h2database.com/html/performance.html](http://www.h2database.com/html/performance.html)了解更多信息。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2009-01-20T20:49:55.803

[HSQLDB](http://hsqldb.org/)是一个很好的候选者（它在 OpenOffice 中使用的事实可能会让你们中的一些人信服），但是对于这么小的个人应用程序，为什么不使用对象数据库（而不是经典的关系数据库）呢？

我在我的一个项目中使用[了 DB4O](http://www.db4o.com/)，我对它非常满意。面向对象，不需要整个 Hibernate 层，可以直接插入/更新/删除/查询对象！此外，您无需担心模式，您可以直接使用对象，其余的由 DB4O 完成！

我同意可能需要一些时间来适应这种新类型的数据库，但请查看[DB40 教程](http://developer.db4o.com/Resources/view.aspx/Formula_One_Tutorial)，了解它使使用数据库变得多么容易！

编辑：正如评论中所说，DB4O 自动处理较新版本的类。此外，在应用程序之外浏览和更新数据库的工具可在此处获得：[http ://code.google.com/p/db4o-om/](http://code.google.com/p/db4o-om/)

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2008-09-11T17:33:14.463

[Java DB](http://www.oracle.com/technetwork/java/javadb/overview/index.html)（Sun 的 Apache Derby 发行版）现在*在*JDK 6 中发布！

我一直想做像 Jason Cohen 这样的事情，并且一直认为这看起来像是 JDK 发行版中最简单的方法（上周是我的应用程序的要求）。或者也许我只是这样懒惰。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-09-11T17:26:52.853

我们在生产中使用 HSQLDB 作为我们应用程序的“无配置”选项。它允许人们在没有设置真实数据库的麻烦的情况下进行试用。

但是我们*不*支持正常使用。原因有几个：

1.  与数据大小成比例地减慢。
2.  难以在我们的应用程序之外访问（例如自定义报告）。
3.  事务/磁盘同步很难正确处理，因此很容易丢失数据。

至少对于（2）和（3），有一些方法可以解决它，但很难；例如安装 MySQL 要容易得多。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2008-09-12T11:03:14.720

[neo4j](http://neo4j.org)是：

> 一个嵌入式的、基于磁盘的、完全事务性的 Java 持久性引擎，它以图形而不是表的形式存储数据

我还没有机会尝试它——但它看起来很有希望。请注意，这不是 SQL 数据库 - 您的对象图是为您保留的 - 因此它可能不适合您现有的应用程序。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2013-11-13T22:16:10.157

可以在这里找到很好的比较工具：[http ://www.jpab.org/All/All/All.html](http://www.jpab.org/All/All/All.html)

还要注意头对头 DBMS/JPA 比较

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-01-20T22:41:32.663

大多数事情已经说了，但我可以补充一点，我在一些我喜欢的项目中使用了 HSQL、Derby 和 Berkely DB，它们都工作得很好。所以我认为诚实并不重要。值得一提的是，HSQL 将自己保存为带有 SQL 语句的文本文件，这非常好。让您在开发时快速进行测试和设置数据变得非常容易。如果需要，还可以进行快速编辑。猜猜如果您还需要更改，您可以轻松地将所有这些转移到任何数据库:)

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2009-01-21T10:00:50.920

HSQLDB 可能会导致大型应用程序出现问题，它不是那么稳定。

我听过的最好的（但不是第一手经验）是berkleyDB。但是，除非您将其开源，否则由于许可的原因，使用它会花费您一条胳膊和一条腿……请参阅此[http://www.oracle.com/technology/software/products/berkeley-db/htdocs/licensing.html](http://www.oracle.com/technology/software/products/berkeley-db/htdocs/licensing.html)详情。

附言。如果您不知道，berkleyDB 不是关系数据库。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2008-09-11T17:26:43.650

我是[.Net 和 Java 的 DB4O 的](http://www.db4o.com/Default.aspx?AspxAutoDetectCookieSupport=1)忠实粉丝。

自早期版本以来，性能已经变得更好。许可模式也不错。我特别喜欢可用于查询对象的选项。示例查询非常强大且易于使用。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2009-01-20T22:23:33.527

您将使用什么标准来评估这些？如果你还不知道，那么你现在不需要决定。尽量使您的应用程序与数据库实现无关 - 提供适当的包装器、数据访问对象等，并在您掌握所有事实并且必须做出决定时做出此决定。

如果您使用的是关系数据库和 SQL，那么上面的内容应该不会太难（使用 JDBC 等）。确保您有大量的周边测试，以便当您想要在数据库之间切换时，您可以确定您的应用程序的功能保持不变。

前段时间我遇到了同样的问题。我不知道要使用哪个数据库，所以我的第一个解决方案使用了 Derby（或 HSQLDB？），后来我能够切换到 HSQLDB（或 Derby ？不记得哪个解决方案有效）一旦我确定了哪里我遇到了问题（与性能有关），哪种解决方案真正适合我。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2008-09-12T10:19:01.440

我用过 Derby，我真的很讨厌它的数据类型转换函数，尤其是日期/时间函数。（数字类型）<--> Varchar 转换很痛苦。

因此，如果您计划在 DB 语句中使用数据类型转换，请考虑使用其他嵌入式 DB，我学得太晚了。

[最新的 Derby 版本数据类型转换](http://db.apache.org/derby/docs/10.4/ref/rrefsqlj33562.html)

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2009-01-20T20:39:47.510

我个人喜欢 HSQLDB，但主要是因为它是我第一次尝试。

据说 H2 速度更快，并提供了更好的 GUI 前端（顺便说一下，它是通用的，可以与任何 JDBC 驱动程序一起使用）。

至少 HSQLDB、H2 和 Derby 提供了非常适合开发的服务器模式，因为您可以同时使用应用程序和某些工具访问数据库（嵌入式模式通常不允许）。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2009-09-15T14:05:23.917

我想我有点晚了（晚了很多;-)）到这篇文章，但我想添加 Perst，一个开源的、面向对象的 Java 和 .NET 嵌入式数据库。供您考虑。Perst 是一个用于 Java 的开源/双重许可嵌入式数据库。该发行版与 Google 的 Android 平台兼容，还包括用于 Java ME 的 Perst Lite。我们甚至构建了一个 Android 基准测试并制作了一份关于该主题的白皮书……您可以在这里查看：[http ://www.mcobject.com/index.cfm?fuseaction=download&pageid=581§ionid=133](http://www.mcobject.com/index.cfm?fuseaction=download&pageid=581&sectionid=133)

一切顺利，克里斯

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2010-11-02T03:43:18.640

如果我是正确的，H2 来自编写 HSQLDB 的同一个人。如果您信任他们网站上的基准，它会好很多。此外，还有一些观点认为太阳社区过快地加入了德比。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2009-01-20T20:35:47.847

我意识到您提到了 SQL 浏览，但是您问题中的所有其他内容都让我想建议您也考虑[DB4O](http://www.db4o.com/)，这是[一个很棒的简单对象 DB](http://www.ibm.com/developerworks/java/library/j-db4o1.html)。

# c++ - 真的有像Objective C++这样的东西吗？

> ID：462924
> 
> 赞同：3
> 
> 时间：2009-01-20T20:17:54.403
> 
> 标签：c++, objective-c, cocoa, macos, objective-c++

我正在阅读一篇[关于](http://savoysoftware.com/blog/?p=114)iPhone 编程的文章，我注意到关于 Objective C++ 的讨论，文章中显示的代码看起来主要像 Objective-C，但也有几个 C++ 片段。真的可以用 C++ 编写 Cocoa 吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-20T22:30:14.777

除了其他评论之外，我还要补充一点，Objective-C++ 与“从 C++ 编写 Cocoa 程序”并不完全相同，因为不涉及 C++ 到 Cocoa 的桥接。

在 Objective-C++ 中，您完全使用 Objective-C 对象/语法对 Cocoa API 进行编程。Cocoa API 保持不变，因此您需要以相同的方式与其通信（使用 Objective-C 字符串、Objective-C 数组和 Objective-C 对象）。

与普通的 Objective-C 相比，Objective-C++ 的不同之处在于您还*可以*使用 C++ 对象（包含 Objective-C 对象，包含在 Objective-C 对象中或仅与 Objective-C 对象一起使用）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-20T20:24:16.760

是的。基本上，Objective-C 是一组类似于 Smalltalk 的 C 对象扩展。Objective C++ 是将这些相同的扩展应用于 C++ 的结果。这为您提供了一种具有两种不同对象模型的语言。

Apple 的 xcode 开发环境同时提供了 Objective-C 和 Objective-C++ 编译器。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-20T20:26:59.737

[在 Objective-C 中使用 C++](http://developer.apple.com/documentation/Cocoa/Conceptual/ObjectiveC/Articles/chapter_14_section_1.html#//apple_ref/doc/uid/TP30001163-CH10-SW1)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T23:29:46.170

它实际上是 Apple 文档中的一个复活节彩蛋，用于检查是否有人在阅读 - 同一个人编写了 WO4 指南中的所有 WebScript 文档。

是的，有 Objective-C++。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-20T20:22:43.830

就在这里。

# css - Css 布局帮助 - 3 列页脚

> ID：462931
> 
> 赞同：9
> 
> 时间：2009-01-20T20:19:32.807
> 
> 标签：css

我试图让我的网站中的页脚看起来像这样：

```
威尔格罗夫浸信会 关于 | 部委 1234 S. Main st.
John G. Smith，高级牧师 联系我们 | 某处站点地图，ID 55555

```

我的问题是将它放在 3 列中。有什么建议么？

谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-20T20:39:42.923

使用浮点数很容易完成：

```
<div id="footer">
    <p class="left">Left aligned text here<br />Next line here</p>
    <p class="right">Right aligned text here<br />Next line here</p>
    <p class="centered">Center Text here<br />Next line here</p>
</div> 
```

和CSS：

```
.left{
text-align:left;
float:left;
}
.right{
float:right;
text-align:right;
}
.centered{
text-align:center;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-20T20:23:56.433

以下是[三列 CSS 布局](http://css-discuss.incutio.com/?page=ThreeColumnLayouts)的列表。 [Alistpart.com](http://www.alistapart.com)也[有一篇](http://www.alistapart.com/articles/holygrail)关于它的文章。

我建议查看“三列 CSS 布局”列表；每个链接都从“报纸版面”的角度详细介绍了它的外观，以及每个链接的优缺点。我将它用于[我正在维护的网站](http://stannscatholicschool.com)的三列布局。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-23T16:59:21.557

```
 <div id="footer">
  <div>foo</div>
  <div>bar</div>
  <div>baz</div>
</div>

#footer { display: table; width: 100%; table-layout: fixed; }
#footer > div { display: table-cell; } 
```

不过，这在 IE 7 及之前的版本中不起作用。在这种情况下，我建议为它们提供（通过 IE 条件注释）类似于 alex 的标记，您可以在其中使用简单的浮点数。这些不会正确居中，但它们肯定会工作，并且随着人们升级到 IE8 或更好的浏览器，它们会自动升级为 display:table 解决方案。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-07-09T11:05:24.013

我在自己的网站上使用了以下代码。

### HTML：

```
<footer>
    <aside class="footer-left">
        Lorem ipsum dolor sit amet, consectetur adipiscing elit.
    </aside>

    <aside class="footer-right">
        Aenean elit ante, ultrices ac vestibulum id, tempor id nisi.
    </aside>

    <aside class="footer-center">
        Integer tincidunt, sem at placerat ullamcorper, urna felis condimentum justo.
    </aside>
</footer> 
```

### CSS：

```
footer [class ^= 'footer-'] {
    width: 33.3333%;
    display: inline-block;
    text-align: center;
}

footer .footer-left {
    float: left;
}

footer .footer-right {
    float: right;
} 
```

所有内容都将居中对齐，因为这就是我想要的。不过，您可以轻松更改此设置。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-25T05:18:53.557

要拥有几乎相等宽度的三列：

HTML：

```
<div id="footer">
    <p>First section, first line of text<br /> Second line of text</p>
    <p>Second section, first line of text<br /> Second line of text</p>
    <p>Third section, first line of text<br /> Second line of text</p>
</div> 
```

CSS：

```
#footer > p:first-child {
    float: left;
    text-align: left;
    width: 33.3%; }

#footer > p:nth-child(2) {
    float: left;
    text-align: center;
    width: 33.4%; }

#footer > p:last-child {
    float: right;
    text-align: right;
    width: 33.3%; } 
```

与 Jayx 的回答相比，我简化了标记并在样式表中使用了不同的选择器。

阅读有关[小数百分比长度](https://stackoverflow.com/questions/4308989/are-the-decimal-places-in-a-css-width-respected "是否尊重 CSS 宽度中的小数位？")的更多信息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-02-01T23:27:54.087

实际上，文本对齐代码除了使文本倾斜到末尾这一事实外，还可以工作。要解决此问题，只需应用一个 margin-top 负值与左侧文本对齐。看一看...

```
#left {
    text-align:left;
}

#right {
    text-align:right;
    margin-top:-35px;
}

#center {
    text-align:center;
    margin-top:-35px;
} 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-01-20T20:23:28.167

试试这个：

```
<div style="float:left; padding:10px;">left</div>
<div style="float:left; padding:10px;">center</div>
<div style="float:left; padding:10px;">right</div> 
```

您可以相应地调整填充等。

# python - 是否可以在 wxPython 中使文本半透明？

> ID：462933
> 
> 赞同：1
> 
> 时间：2009-01-20T20:20:18.423
> 
> 标签：python, wxpython, transparency, opacity

我在我的主 wx.Frame 上添加了一些 wx.StaticText 对象，它已经应用了背景图像。但是，StaticText 似乎总是使用纯色（不透明）背景颜色绘制，从而隐藏图像。我尝试创建一个 wx.Color 对象并在那里更改 alpha 值，但这没有产生任何结果。有什么方法可以将文本放在框架上并让背景发光？此外，是否可以使文本本身半透明？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-21T10:19:09.633

您可能需要一些图形渲染小部件。据我所知，在 wxPython 中，您可以直接使用内置的 wxGraphicsContext 或 pyCairo。开罗更强大。但是，我不知道细节。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-28T15:53:54.487

我会尝试将 aggdraw 放入一个小画布中。

任何静态文本都使用平台的本机标签机制，因此您无法对其进行那种控制。

# javascript - 在 Rails 中进行 Javascript 测试的 Selenium 或 Watir

> ID：462934
> 
> 赞同：15
> 
> 时间：2009-01-20T20:20:19.063
> 
> 标签：javascript, ruby-on-rails, ajax, testing, selenium

我们在 Rails 应用程序中使用了 RSpec 和 Cucumber，效果很好。Webrat 非常适合非 AJAX 交互，但我们正准备重新开始为我们的 Javascript 编写测试。

Webrat 内置了对 Selenium 的支持，我们以前也使用过 Selenium，但我很好奇是否有人在使用 Watir 和 Cucumber 时取得了良好的效果，以及 Watir 与 Selenium 的优缺点是什么。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-17T15:21:30.770

作为 OpenQA 和 Selenium RC 的创始人，我显然倾向于将 Selenium 作为一个不错的选择。我们最近刚刚发布了 1.0 beta 2 版本，并且非常接近 1.0 最终版本。

但是，使用 Watir/FireWatir 也不会出错。Adam 关于 WebDriver 将合并形成 Selenium 2.0 的评论是正确的，但他暗示 Watir 不使用本机钩子是不正确的。如果 Watir 只是一个 Selenium 克隆并且还使用了 JavaScript 注入，我会说它不值得一看。

但是因为它有原生的钩子，所以它可以做一些 Selenium 目前做不到的事情。虽然它支持的浏览器较少，但它在它支持的主浏览器 (IE) 中更深入一些，并允许您控制页面/画布之外的内容。

总而言之：两者都可以，Selenium 很棒，如果您使用 Selenium 再坚持一段时间，您很快就会通过 WebDriver/Selenium 2.0 获得两全其美的效果。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T05:13:52.533

我通过 JRuby 使用带有 Celerity 的 Cucumber 取得了很好的效果。

Celerity 是一个无头浏览器，它使用与 Watir 兼容的 API 包裹 HtmlUnit，并支持 JavaScript 和 AJAX 测试。

无头使 Celerity 更快、更容易地集成到持续集成构建周期中。

由于 Celerity 与 Watir 的 API 兼容，因此您可以相当轻松地在 Watir 和 Celerity 之间切换。有一些警告，但值得付出努力。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-21T14:45:23.700

我会说 Watir 更圆滑，但用处不大。它主要是一个 IE 自动化系统，具有相当不稳定的 Firefox 支持。（我承认有一段时间没有检查 FireWatir，它可能已经改进了。）

在 Watir 上有对 Selenium-RC 的实验性支持。那肯定是两全其美。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-23T12:47:25.247

您可能想尝试[WebDriver](http://code.google.com/p/webdriver/)。将来它将[成为 Selenium](http://code.google.com/p/webdriver/wiki/FrequentlyAskedQuestions)的一部分。与 JRuby 一起工作。

它与 Selenium、Sahi 或 Watir 的不同之处在于它本机控制浏览器，不使用 JavaScript，并且不受其他解决方案存在的许多问题的影响。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-21T13:52:58.220

我试过Watir，但没有用黄瓜。这是为java应用程序。我们面临的问题是试图确定页面已加载。在找到解决方案之前，我们不得不稍微搜索一下论坛。否则很好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-11-26T04:25:00.180

Watir 2.0 也将使用 WebDriver。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-09-08T12:04:22.217

如果您想在 Rails 3 上使用 Watir。

您可以使用“watir-webdriver-rails”gem（我是创建者）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-01-25T06:27:53.003

我发现它的 Env-Js 的最佳解决方案[http://github.com/smparkes/env-js](http://github.com/smparkes/env-js) 它像 webrat 但支持 JS

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-09-15T15:50:36.750

不要忽略像 QUnit 或 Jasmine 这样的东西来对你的 javascript 进行单元测试。如果不出意外，它会减少你必须用 cucumber/selenium/capybara/whatever 编写的全栈测试的数量

# asp.net - 如果您无权访问 Page，有没有办法加载用户控件？

> ID：462945
> 
> 赞同：1
> 
> 时间：2009-01-20T20:22:50.197
> 
> 标签：asp.net

如果我无权访问 Page 对象（例如我在实用程序类中），如何在 ASP.NET 中动态加载用户控件？

通常你会这样做：

```
Page.LoadControl("~/controls/MyControl.ascx"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T20:34:12.467

您可以使用以下代码将实用程序类中的控件添加到当前页面：

```
Page currentPage = HttpContext.Current.Handler as Page;
if (currentPage != null)
{
    currentPage.Controls.Add(
        currentPage.LoadControl("~/controls/MyControl.ascx"));
} 
```

它有效，但我不建议这样做，并认为它是一种黑客行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T20:25:19.207

正确加载用户控件的唯一方法（即以启动其生命周期的方式）是将其添加到另一个控件的控件集合中。

因此，您需要传入对页面的引用或对页面上控件的引用，并将控件添加到该控件的集合中。

# asp.net - 针对 ASP.net 2.0 的 VS2008：项目级导入警告

> ID：462955
> 
> 赞同：0
> 
> 时间：2009-01-20T20:25:33.187
> 
> 标签：asp.net, vb.net, visual-studio-2008

我有一个针对 asp.net 2.0 构建的网络应用程序，但不断收到以下警告：

在项目级导入“System.Xml.Linq”中指定的命名空间或类型不包含任何公共成员或找不到。确保命名空间或类型已定义并包含至少一个公共成员。确保导入的元素名称不使用任何别名。

我找不到实际引用 Linq 的任何地方。我什至在文本编辑器中打开了 .vbproj，它也没有隐藏在那里。

任何想法在哪里设置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-20T21:01:26.250

打开您的 web.config 并删除其中对 Linq 的引用。您应该需要从“程序集”部分下删除这些行：

```
 <add assembly="System.Core, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
        <add assembly="System.Data.DataSetExtensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
        <add assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add assembly="System.Xml.Linq, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T20:55:52.923

你检查了你的 web.config 文件吗？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-03-30T04:04:46.123

如果您有旧版本的 .Net Framework，您也会收到此错误。

转到项目->属性->高级编译选项->目标框架（所有配置）

如果设置为 .NET Framework 2.0，请尝试将其更改为 3.5。

那为我修好了。

# mysql - 莫名其妙的内部查询

> ID：462962
> 
> 赞同：0
> 
> 时间：2009-01-20T20:27:03.213
> 
> 标签：mysql, sql, mysql-error-1242

我有一个嵌套的 SQL 查询，它显示了我无法理解的结果。该查询通过 PARTNER_USER 表连接 PARTNER 和 USER 表。合作伙伴基本上是用户的集合，此查询的目的是确定第 20 个用户何时向 ID 为 34 的合作伙伴注册：

```
select p.partner_id id,
       u.created_on launch_date
from   user u join partner_user pu
using (user_id) join partner p
using (partner_id)
where  p.partner_id = 34
and    u.user_id     =
       (select  nu.user_id
       from     user nu
       join     partner_user npu using (user_id)
       join     partner np using (partner_id)
       where    np.partner_id = 34
       order by nu.created_on limit 19, 1) 
```

但是，如果我将最后第二行更改为

```
 where    np.partner_id = p.partner_id 
```

查询失败并显示错误消息“子查询返回超过 1 行”。为什么第一个查询有效，而第二个查询无效？他们看起来和我一样。

谢谢，唐

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T20:49:30.843

JPunyon 是对的。一个或另一个查询必须首先运行，然后在事后修剪其结果。

如果您查看编写的查询，则外部查询必须知道内部查询的结果才能应用其 where 子句。但是，当您指定

```
where    np.partner_id = p.partner_id 
```

在内部查询中，然后您试图使内部查询知道外部查询的结果以应用其 where 子句。这是一个循环依赖。

作为人类，您可以阅读查询，并且可以看出在这种特殊情况下，您在外部查询的 where 子句中要求一个特定的值，而您要求在内部查询中使用相同的值，所以似乎数据库应该看到并使用外部查询中的相同文字值。

实际上，内部查询只是在不知道 的可能值的情况下首先运行`p.partner_id`，因此出现“多行”错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T20:31:14.780

当您使用 = 运算符与子查询的结果进行比较时，您的子查询可能只返回一行。如果要检查子查询返回的所有行，则必须使用 IN 运算符。

```
AND u.User_Id IN ( SELECT .... ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T20:37:29.167

当您更改子查询中的 where 子句时，您将打开闸门。主查询中的 where 子句不限制子查询。所以你得到的结果不止1个。

编辑：这是什么数据库？我之前没有遇到过“使用”构造......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-31T16:49:17.163

@Jason Punyon mysql 支持 USING 构造。

# silverlight - 如何处理使用 Silverlight 不支持的功能的 ASX 流（例如 REPEAT）

> ID：462967
> 
> 赞同：0
> 
> 时间：2009-01-20T20:28:31.823
> 
> 标签：silverlight

我正在尝试显示由另一方作为服务器端播放列表 (ASX) 提供的视频源。播放列表包含一些不受支持的功能，例如重复：

```
<ASX VERSION="3.0">
  <REPEAT COUNT="4">
    <EntryRef href="http://some-ad-network.com/ad.asx" />
    <Entry>
      <Ref href="http://video-host/content-primary-source"></Ref>
    </Entry>
    <Entry>
      <Ref href="http://video-host/content-secondary-source"></Ref>
    </Entry>
  </REPEAT>
</ASX> 
```

[Silverlight 2.0 不支持 REPEAT 元素](http://msdn.microsoft.com/en-us/library/cc189080(VS.95).aspx#anchor_mediaformats_formats)并引发异常：

> REPEAT 元素：这不受支持，并且会引发带有 AG _ E _ ASX _ UNSUPPORTED _ ELEMENT 的 MediaError。

有解决方法吗？我可以通过 HttpWebRequest 将 ASX 文件拉下来，解析它，然后单独请求流吗？你知道处理 ASX 文件解析的库或一些示例代码吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-20T20:40:53.747

Attributes 获取 MediaAttribute 对象的集合，这些对象与 Source 设置为的 ASX 文件中的当前条目相对应。这是一个javascript示例：

[http://msdn.microsoft.com/en-us/library/bb412367.aspx](http://msdn.microsoft.com/en-us/library/bb412367.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-26T18:15:44.183

我最终不得不自己解析 ASX 文件并手动加载元素。如果将加载 ASX 文件，Peter 的建议很有帮助，但是 Silverlight ASX 解析器在遇到大多数不受支持的元素时会抛出异常，因此您永远没有机会从 Attributes 属性加载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-15T17:00:10.597

由于 MediaElement 中的 asx 处理不好，我还制作了一个自定义 asx 解析器。它纠正了几个错误，请参阅[http://blog.revolunet.com/index.php/general/wpf-mediaelement-asx-workaround](http://blog.revolunet.com/index.php/general/wpf-mediaelement-asx-workaround)

# c# - 将 BCD 转换为二进制的最有效方法

> ID：462970
> 
> 赞同：5
> 
> 时间：2009-01-20T20:30:31.820
> 
> 标签：c#, binary, bcd

我有下面的代码将 32 位 BCD 值（以两个 uint 一半提供）转换为 uint 二进制值。

提供的值最大为 0x9999，形成最大值 0x99999999。

有没有更好（即更快）的方法来实现这一目标？

```
 /// <summary>
    /// Convert two PLC words in BCD format (forming 8 digit number) into single binary integer.
    /// e.g. If Lower = 0x5678 and Upper = 0x1234, then Return is 12345678 decimal, or 0xbc614e.
    /// </summary>
    /// <param name="lower">Least significant 16 bits.</param>
    /// <param name="upper">Most significant 16 bits.</param>
    /// <returns>32 bit unsigned integer.</returns>
    /// <remarks>If the parameters supplied are invalid, returns zero.</remarks>
    private static uint BCD2ToBin(uint lower, uint upper)
    {
        uint binVal = 0;

        if ((lower | upper) != 0)
        {
            int shift = 0;
            uint multiplier = 1;
            uint bcdVal = (upper << 16) | lower;

            for (int i = 0; i < 8; i++)
            {
                uint digit = (bcdVal >> shift) & 0xf;

                if (digit > 9)
                {
                    binVal = 0;
                    break;
                }
                else
                {
                    binVal += digit * multiplier;
                    shift += 4;
                    multiplier *= 10;
                }
            }
        }

        return binVal;
    } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-21T13:57:18.680

如果您有足够的空间容纳 39,322 个元素的数组，您可以随时查找该值。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-21T02:33:41.197

如果展开循环，请记住保持位移。

```
value =  ( lo        & 0xF);
value += ((lo >> 4 ) & 0xF) * 10;
value += ((lo >> 8 ) & 0xF) * 100;
value += ((lo >> 12) & 0xF) * 1000;
value += ( hi        & 0xF) * 10000;
value += ((hi >> 4 ) & 0xF) * 100000;
value += ((hi >> 8 ) & 0xF) * 1000000;
value += ((hi >> 12) & 0xF) * 10000000; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-20T20:41:42.203

您的代码似乎相当复杂；你需要特定的错误检查吗？

否则，您可以只使用以下代码，它不应该更慢，事实上，它几乎是相同的：

```
uint result = 0;
uint multiplier = 1;
uint value = lo | hi << 0x10;

while (value > 0) {
    uint digit = value & 0xF;
    value >>= 4;
    result += multiplier * digit;
    multiplier *= 10;
}
return result; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-20T20:56:38.287

我想你可以展开循环：

```
value = ( lo     & 0xF);
value+= ((lo>>4) & 0xF) *10;
value+= ((lo>>8) & 0xF) *100;
value+= ((lo>>12)& 0xF) *1000;
value+= ( hi     & 0xF) *10000;
value+= ((hi>>4  & 0xF) *100000;
value+= ((hi>>8) & 0xF) *1000000;
value+= ((hi>>12)& 0xF) *10000000; 
```

您可以像这样检查无效的 BCD 数字：

```
invalid = lo & ((lo&0x8888)>>2)*3 
```

如果任何单个十六进制数字 > 9，这会将 invalid 设置为非零值。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-12-28T16:23:05.723

尝试这个：

```
public static int bcd2int(int bcd) {
   return int.Parse(bcd.ToString("X"));
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-09-25T07:28:53.363

```
public static uint BCDToNum(int num)
{
    return uint.Parse(num.ToString(), System.Globalization.NumberStyles.HexNumber);
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-05-21T12:38:10.720

当然，还有更有效的方法。当然这只是一个例子，所以你可以把它作为一个教训来调整^^

```
function bcd_to_bin ($bcd) {    
$mask_sbb = 0x33333333;         
$mask_msb = 0x88888888;
$mask_opp = 0xF;

for($i=28;$i;--$i) {            
    $mask_msb <<= 1;
    $mask_opp <<= 1;
    $mask_sbb <<= 1;

    for($j=0;$j<$i;$j+=4) { 
        $mask_opp_j = $mask_opp << $j;

        if ($bcd & $mask_msb & $mask_opp_j ) {
            $bcd -= $mask_sbb & $mask_opp_j;
        }
    }
}

return $bcd; 
```

}

# git - Git 提交范围中的双点“..”和三点“...”有什么区别？

> ID：462974
> 
> 赞同：514
> 
> 时间：2009-01-20T20:32:18.710
> 
> 标签：git, git-checkout, git-diff, git-log, git-rev-list

一些 Git 命令采用提交范围，一种有效的语法是用两个点分隔两个提交名称`..`，另一种语法使用三个点`...`。

两者有什么区别？

* * *

## 回答 #1

> 赞同：824
> 
> 时间：2014-06-12T14:13:17.853

# 在 Git 日志中使用提交范围

当您使用`..`和`...`with之类的提交范围时`git log`，它们之间的区别在于，对于分支 A 和 B，

```
git log A..B 
```

将向您显示**B 拥有而 A 没有的所有提交**，而

```
git log A...B 
```

将向您显示A***拥有***和 B 没有的提交，以及 B 拥有而 A 没有的提交，或者换句话说，**它将过滤掉 A 和 B 共享的所有提交，因此只显示他们*不*共享**的提交。

## 使用维恩图和提交树进行可视化

这是 的视觉表示`git log A..B`。分支 B 包含但 A 中不存在的提交是提交范围返回的内容，在维恩图中以红色突出显示，在提交树中以蓝色圈出：

 ![](https://i.stack.imgur.com/beLTVm.png)![树 1](https://i.stack.imgur.com/a8HHAm.png)

这些是 的图表`git log A...B`。请注意，命令不会返回两个分支***共享的提交：***

 ![](https://i.stack.imgur.com/4SprXm.png)![树 2](https://i.stack.imgur.com/6K2Rlm.png)

## 使三点提交范围`...`更有用

您可以通过使用显示哪些提交属于哪个分支的选项来使三点提交范围`...`在日志命令中更有用：`--left-right`

```
$ git log --oneline --decorate --left-right --graph master...origin/master
< 1794bee (HEAD, master) Derp some more
> 6e6ce69 (origin/master, origin/HEAD) Add hello.txt 
```

在上面的输出中，您将看到属于的提交`master`带有前缀`<`，而属于的提交`origin/master`带有前缀`>`。

# 在 Git Diff 中使用提交范围

有一天我可能会添加我自己的解释来解释提交范围如何[与](https://stackoverflow.com/questions/7251477/git-diff-whats-the-difference-between-having-and-no-dots)`git diff`.[范围？](https://stackoverflow.com/questions/7251477/git-diff-whats-the-difference-between-having-and-no-dots).

# 也可以看看

*   [Pro Git § 6.1 Git 工具 - 修订选择 - 提交范围](http://git-scm.com/book/en/Git-Tools-Revision-Selection#Commit-Ranges)

* * *

## 回答 #2

> 赞同：287
> 
> 时间：2009-01-20T20:46:40.960

这取决于您使用的是`log`命令还是`diff`命令。在这种`log`情况下，它在`man git-rev-parse`文档中：

> 要从提交中排除可访问的提交，使用前缀 ^ 表示法。例如 ^r1 r2 表示可从 r2 访问的提交，但排除可从 r1 访问的提交。
> 
> 这个集合操作经常出现，以至于有一个简写形式。当您有两个提交 r1 和 r2（根据上面指定修订中解释的语法命名）时，您可以请求可从 r2 访问的提交，不包括可通过“^r1 r2”从 r1 访问的提交，它可以写成“r1..r2”。
> 
> 类似的符号“r1...r2”称为 r1 和 r2 的对称差异，并定义为“r1 r2 --not $(git merge-base --all r1 r2)”。它是可以从 r1 或 r2 之一但不能从两者中访问的一组提交。

这基本上意味着您将获得两个分支中的任何一个中的所有提交，但不是两个分支中的所有提交。

在这种`diff`情况下，它在`man git-diff`文档中：

> ```
>  git diff [--options] <commit>...<commit> [--] [<path>...]
> 
>       This form is to view the changes on the branch containing and up to
>       the second <commit>, starting at a common ancestor of both
>       <commit>. "git diff A...B" is equivalent to "git diff
>       $(git-merge-base A B) B". You can omit any one of <commit>, which
>       has the same effect as using HEAD instead. 
> ```

这有点模糊。基本上，这意味着它仅显示该分支与另一个分支相比的差异：它使用您给它的第一个提交查找最后一个常见提交，然后将第二个提交与该提交进行比较。与此分支相比，这是查看该分支中进行了哪些更改的简单方法，而无需仅注意此分支中的更改。

`..`稍微简单一些：在这种情况`git-diff`下，它与 a 相同`git diff A B`，只是将 A 与 B 进行比较。在这种`log`情况下，它显示了 B 中但不在 A 中的所有提交。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2021-10-13T17:02:23.810

我认为关于两个点与三个点混淆的最大来源是，当与`git diff`它一起使用时，它与与使用时**相反**`git log`。

请参阅其他答案、实际文档或大量博客文章以了解*确切的*详细信息，但我发现这些简单的陈述可以很好地传达正确的*想法*：

```
git log  A..B   # Show me commits only on B.
git log  A...B  # Show me commits only on A or only on B.
git diff A..B   # Show me changes only on A or only on B.
git diff A...B  # Show me changes only on B. 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2021-03-09T08:54:08.880

这有点令人困惑=所以这是这个流程的实际情况

```
 A---B---C topic
     /
D---E---F---G master 
```

[https://github.com/alexcpn/gitdiffs/pull/2/commits](https://github.com/alexcpn/gitdiffs/pull/2/commits) [https://github.com/alexcpn/gitdiffs/pull/1/commits](https://github.com/alexcpn/gitdiffs/pull/1/commits)

**Git 日志行为**

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
| 1 | > git log --oneline --graph topic...main * 9411a8b (HEAD -> main) G
* 3a567aa F
* aad429f (topic) C
* 6b1eb5a B
* d65c129 A | 主题 D
E
A
B
C | 主 D
E
F
G | 在主题和主要方面，但不在 两者中 |
| 2 | git log --oneline --graph main...topic * 9411a8b (HEAD -> main) G
* 3a567aa F
* aad429f (topic) C
* 6b1eb5a B
* d65c129 A | 主题 D
E
A
B
C | 主 D
E
F
G | 和上面一样 |
| 3 | git log --oneline --graph topic..main * 9411a8b (HEAD -> main) G
* 3a567aa F | 主题 D
E
A
B
C | 主 D
E
F
G | 主要，但不是主题 |
| 4 | git log --oneline --graph main..topic * aad429f (topic) C
* 6b1eb5a B
* d65c129 A | 主题 D
E
A
B
C | 主 D
E
F
G | 在主题中，但不在主要内容中 |

**Git 差异行为**

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
| 1 | git diff topic..main D
E
-A
-B
-C
+F
+G | 主题 D
E
A
B
C | 主 D
E
F
G | 与主题 相比，主要内容主要内容
 |
| 2 | git diff main..topic D
E
-F
-G
+A
+B

+C | 主题 D
E
A
B
C | 主 D
E
F
G | 主题中的内容 与主要 内容相比，主题中没有的内容
 |
| 3 | git diff main...topic D
E (你可以在这里换行)
+A
+B
+C | 主题 D
E
A
B
C | 主 D
E
F
G | 在主题中，但不在主要内容中 |
| 4 | git diff 主题...主要 D
E
+F
+G | 主题 D
E
A
B
C | 主 D
E
F
G | 主要，但不是主题 |

# syntax - Lua - if 语句中的语法错误

> ID：462976
> 
> 赞同：1
> 
> 时间：2009-01-20T20:32:53.203
> 
> 标签：syntax, lua

只是试图执行一个小的 Lua 脚本，但不幸的是我做错了。我没有更多的想法可能是什么错误。

```
function checkPrime( n )
    for i = 2, n-1, 1 do
        if n % i == 0 then
            return false
        end
    end
    return true
end 
```

口译员说：

```
lua: /home/sebastian/luatest/test.lua:3: `then' expected near `%' 
```

我认为这不是一件大事，也许很清楚出了什么问题。但不知何故，我现在看不到它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-20T20:48:13.623

可能有一些版本问题，检查你的lua版本。使用 '%' 作为取模的中缀运算符只能在 Lua 5.1 中使用，在 5.0 中尚不支持。尝试`math.mod`改用：

```
if math.mod(n,i) == 0 then 
```

**编辑**：另请注意，在 5.1 中，`math.mod`仍然存在，但已重命名为`math.fmod`. 目前，旧名称仍然有效，但在未来版本中可能会删除支持。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-01-20T20:36:42.507

您是否尝试将“n% i == 0”括在括号中？愚蠢的问题，但有时会被忽视！

# c++ - 将 CGImageRef 放在剪贴板上

> ID：462982
> 
> 赞同：1
> 
> 时间：2009-01-20T20:35:11.653
> 
> 标签：c++, c, core-graphics, macos-carbon

我正在尝试将 CGImageRef 复制到剪贴板粘贴板。我发现一个函数声称它应该通过从（零大小）创建一个目标，将图像添加到目标，完成，然后将引用粘贴到剪贴板中来做到这一点。

但是它不起作用，所以有两个问题：

1.  **这是**解决这个问题的正确方法吗？（即，只有一个小错误，还是我做错了？）

2.  我应该选择什么类型的目的地？来源有它作为TIFF，但word似乎不知道如何处理，我将其更改为PICT，这至少给了我“粘贴”选项，但后来说它太大了......

代码：

```
void copyCGImageRefToPasteboard(CGImageRef ref)
{
    OSStatus err = noErr;
    PasteboardRef theClipboard;

    err = PasteboardCreate( kPasteboardClipboard, &theClipboard );
    err = PasteboardClear( theClipboard );// 1

    CFMutableDataRef url = CFDataCreateMutable(kCFAllocatorDefault, 0);

    CFStringRef type = kUTTypePICT;
    size_t count = 1;
    CFDictionaryRef options = NULL;
    CGImageDestinationRef dest = CGImageDestinationCreateWithData(url, type, count, options);
    CGImageDestinationAddImage(dest, ref, NULL);
    CGImageDestinationFinalize(dest);

    err = PasteboardPutItemFlavor( theClipboard, (PasteboardItemID)1, type, url, 0 );
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-07-20T18:17:46.080

进入詹姆斯登普西的“库比蒂诺绕口令”

彼得在粘贴板上放了一张 PICT。

弃用 PICT 是一种糟糕的粘贴板类型。

参考见：http: [//developer.apple.com/mac/library/documentation/cocoa/Conceptual/PasteboardGuide106/Articles/pbUpdating105.html](http://developer.apple.com/mac/library/documentation/cocoa/Conceptual/PasteboardGuide106/Articles/pbUpdating105.html)

简而言之：不推荐将 PICT 放在粘贴板上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-23T14:37:53.853

好的，我在这里回答我自己的问题，但这是我发现的：

Apple 希望您将 PDF 用于粘贴板。因此，如果您将 Pict 换成 PDF，它几乎可以正常工作。但是，MS Word（我正在测试的）只开始允许在最新版本（我没有）中粘贴 PDF。

所以，这就是解决方案，使用 PDF，并且需要 Word 2008。

# c# - 如何获取到 DB 的 IDbCommand 输出？（。网）

> ID：462992
> 
> 赞同：1
> 
> 时间：2009-01-20T20:36:59.793
> 
> 标签：c#, .net, sqlcommand, idbcommand

我有一个 SqlCommand 对象，我执行它的 ExecuteNonQuery 方法。查询失败，但我看不到如何获取查询来调试它。你可以帮帮我吗？

**更新**我目前正在使用 Wireshark (tcpdump) 来读取命令，但我认为这不是最好的解决方案

**更新**CommandText 属性仅提供存储过程名称。我想要带有参数的整个命令。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-20T20:39:31.333

您可以使用 SQL Profiler 查看与参数器一起发送的对存储过程的查询/调用是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T20:39:52.813

您可以获得 SqlCommand 的 CommandText 属性的值吗？如果抛出异常，您可以捕获它，并访问 CommandText 属性，该属性将为您提供 SQL 命令，就像您设置它一样。当然，如果它包含参数，则不会将参数替换为适当的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T20:48:30.237

如果您还想查看参数，那么您必须查看命令对象的 Parameters 属性（不仅仅是 CommandText），并查看此集合中的每个参数以提取值和数据类型，如果您对此感兴趣的话在。

现在，听起来您要调试的是存储过程本身，而不是 C# 代码，对吗？如果是这种情况，您需要将 Visual Studio 调试器附加到 SQL Server 以调试 T-SQL 代码。我知道你可以用 Oracle 做到这一点，所以我假设你应该能够用 SQL Server 开箱即用地做到这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-20T21:38:46.453

无论如何，您可能应该在 SQL 周围使用 try/catch 块，但这样做的好处是您可以轻松地返回 SQL 命令字符串以及错误。

这样的事情应该这样做：

```
try
{
    ***Execute your SQL query here***
}
catch (Exception e)
{
    Console.WriteLine(e.ToString());
    Console.WriteLine(***My SQL command string***);

} 
```

# asp.net - 通过使用 ASP.NET 构建的网站流式传输视频的最佳方式是什么？

> ID：462993
> 
> 赞同：0
> 
> 时间：2009-01-20T20:37:20.167
> 
> 标签：asp.net, vb.net, video, video-streaming

我正在寻找大家对从使用 ASP.NET 构建的网站流式传输视频的最佳方式的意见。一些值得注意的项目包括：

*   流式传输 .avi、.mpg 和可能的 .wmv 文件的能力
*   某人将视频直接上传到共享服务器并使其流式传输而无需任何额外工作（无需压缩等）的能力

我认为 Silverlight 可能是一个不错的选择，但我非常感谢其他人的意见（如果可以，请包括优点/缺点）。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-20T20:47:52.983

我想到了一些明显的选择：

*   Flash - 它是一种流行的行业标准，但不是 Microsoft 的 .NET Framework 原生的。

*   Silverlight - 它的实现和使用有利于 .NET 开发人员，但是，虽然它正在慢慢兴起，但它还不是一个被广泛接受的标准，并且被 Flash 的资历和受欢迎程度大大掩盖了。

编辑：作为我的 .NET 开发人员，我会立即选择 Silverlight。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-20T20:52:35.550

我会使用 asp:mediaplayer，它实际上是 Silverlight。

# .net - Graphics.DrawRectangle(Pen, RectangleF)

> ID：462995
> 
> 赞同：10
> 
> 时间：2009-01-20T20:37:37.123
> 
> 标签：.net, graphics, drawing, overloading, rectangles

[http://msdn.microsoft.com/en-us/library/system.drawing.graphics.drawrectangle.aspx](http://msdn.microsoft.com/en-us/library/system.drawing.graphics.drawrectangle.aspx)

FillRectangle、DrawRectangle、FillElipse 和 DrawEllipse 都可以采用 4 个 Float（或“Single”）参数：x、y、宽度、高度。不过，DrawRectangle 是唯一不采用 RectangleF 的。

我想知道是否有人知道这是为什么。看起来他们似乎只是忘记了超载它。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-21T21:21:31.137

好吧，这对我来说确实也像是一个遗漏。

有趣的是，有一个 DrawRectangles 的重载，它接受一个 RectangleF[] 数组作为参数。

所以我想如果需要的话，你可以将它与一个数组大小一起使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-03-27T05:17:11.843

根据安迪的回答，扩展名应该如下

```
public static class GraphicsExtensions
{
    public static void DrawRectangle(this Graphics g, Pen pen, RectangleF rect)
    {
        g.DrawRectangles(pen, new[] { rect });
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-23T07:42:50.453

继安迪的回答之后，这种简单的扩展方法让生活更轻松。

```
using System.Drawing;

public static class GraphicsExtensions
{
    public static void DrawRectangle(this Graphics g, Pen pen, RectangleF rect) =>
        g.DrawRectangle(pen, rect.X, rect.Y, rect.Width, rect.Height);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-11-20T11:28:13.777

我知道这个问题很老，但仅供参考：我相信正确的方法是使用[round](https://docs.microsoft.com/cs-cz/dotnet/api/system.drawing.rectangle.round?view=netframework-4.7.2)或[truncate](https://docs.microsoft.com/cs-cz/dotnet/api/system.drawing.rectangle.truncate?view=netframework-4.7.2)，例如：

```
Dim BBox As RectangleF = ListOfRectangleF(3)         ' get RectangleF any way you have it
Dim p As New Pen(Brushes.DarkRed)
e.Graphics.DrawRectangle(p, Rectangle.Round(ptBBox)) ' draw RectangleF using Rectangle.Round() 
```````**************