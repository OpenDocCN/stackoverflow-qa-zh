# StackOverflow 问答 11165000-11165999

# java - 让我的 dos 代码批量运行命令

> ID：11165000
> 
> 赞同：0
> 
> 时间：2012-06-22T22:34:03.433
> 
> 标签：java, windows, batch-file

这是我的`dos`命令代码。

我需要将当前文件名从我的重命名批处理工具中提取`dos command`到运行中。很确定我只是打破命令

```
add +filename+ with quotes like "cmd /c \\Converter.exe \\android\\"+filename+" -android -o \\android\\"+filename 
```

但是我的文件在另一个`class`. eclipse 建议`getfilename(null)`不起作用。

我怎样才能做到这一点？下面我尝试了通配符，这当然不起作用。

```
import java.io.BufferedReader;
import java.io.InputStreamReader;
public class doscommand {         
    public static void run() {            
        try {
                 Runtime rt = Runtime.getRuntime();                 
             //Process pr = rt.exec("cmd /c dir");                 
             Process pr = rt.exec("cmd /c \\Converter.exe \\android\\*.sdtid -android -o \\android\\*.txt");                  
             BufferedReader input = new BufferedReader(new InputStreamReader(pr.getInputStream()));                  
             String line=null;                 
                 while((line=input.readLine()) != null) {                     
                         System.out.println(line);
                 }                  
                 int exitVal = pr.waitFor();                 
                 System.out.println("Exited with error code "+exitVal);              
            } catch(Exception e) {                 
            System.out.println(e.toString());                 
             e.printStackTrace();             
           }         
 }
} 
```

重命名代码

```
private void renameFile(){

boolean operationResult = false;
boolean overallResult = true;
int failCount = 0;

/* the operation of this part is ensured by the chooseDirectory()
 * WE get the list of files in the directory
 * get the conditions set by users
 * and perform the file rename operation.
 */

//Let's get all the information from user
String[] fileList = directory.list();  //the list of files in the directory
String Prefix = txtPrefix.getText();
String Rename = txtRename.getText();
String Suffix = txtSuffix.getText();
String digits = (String) cboSequence.getSelectedItem();
int StartingNum;
String generatedSequence;
File oldFile;

//let's call the output frame
if(cbxOutput.isSelected() && OUTPUT_ON == false){
    buildOutput();
    OUTPUT_ON = true;
}

//display the list of files and readability of each file
for(int i = 0; i < fileList.length; i++){   
    oldFile = new File(directory.getPath()+"/"+ fileList[i]);
    String readability = fileList[i] +" - readable?: "+oldFile.canRead();
    System.out.println(readability);

    if(OUTPUT_ON)
        txaOutput.append("\n"+readability);
}

for(int i = 0; i < fileList.length; i++){

    /* get the file extension that we need, and form a new name, 
     * we would check if the Ignore File Extension is selected
     */
    oldFile = new File(directory.getPath()+"/"+ fileList[i]);

    String fileExtension;

    if(cbxIgnoreExtension.isSelected() == true ){
        fileExtension = "";
    }
    else
        fileExtension = getFileExtension(fileList[i]);

    //this part get the original filename       
    String fileName = getFileName(fileList[i]);

    String inputInfo = "The input filename->"+ fileList[i] + "\nfile name->" + fileName + "\nextension->" + fileExtension;   
    System.out.println(inputInfo);

    if(OUTPUT_ON)
        txaOutput.append("\n"+inputInfo);

    /* generate sequence for the Name
     *if the digits selection is NONE, we ignore it
     */
    if(digits.equals("None") == true){
        generatedSequence = "";
        }
        else{
            StartingNum = Integer.parseInt(txtSequence.getText());
            generatedSequence = nameSequence(StartingNum + i, digits);
        }

    //this is affected by the RenameOption, if Rename has something then only we RENAME
    if(cbxRename.isSelected() == true){
        fileName = Rename + generatedSequence;   //the fileName will change.
    }
    else{
        //if Rename has nothing, but the txtSequence has some Value, we take it to the naming too
        fileName = fileName.substring(0,4)+ generatedSequence;
        if(cbxAndroid.isSelected() == true ){
            doscommand.run();
            }

    //the New File Name
    String newFileName = Prefix + fileName.substring(0,4) + Suffix + fileExtension;
    String tentativeName = "new Filename will be ->"+newFileName+"\n";
    System.out.println(tentativeName);

    if(OUTPUT_ON)
        txaOutput.append("\n"+tentativeName);

        // ! Perform the file rename, if the Experimental Mode is not selected
        if(cbxExperiment.isSelected() == false){

            operationResult = oldFile.renameTo(new File(directory.getPath()+"/"+newFileName));
            String renameResult = "\t*Rename successfully?: " + operationResult+"\n\n";
            System.out.println(renameResult);
                if(operationResult == false)
                    failCount++;

                if(OUTPUT_ON)
                txaOutput.append("\n"+renameResult);

            //make up the overall result
            overallResult = (operationResult && overallResult);
        }

}

if(cbxExperiment.isSelected() == false){
        System.out.println("Overall Result: "+overallResult);
        if(overallResult)
            JOptionPane.showMessageDialog(null, "All files renamed successfully!");
        else
            JOptionPane.showMessageDialog(null, "File renamed with "+ failCount+ " failure(s)");
}//end if
}

}//end renameFile 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T16:12:49.410

我还没有阅读 Java 代码，但你的批处理代码对我来说看起来很不对劲。

你不应该有`\\Converter.exe`一个文件名。应该是`Converter.exe`吧？

除非您在服务器共享上使用文件，否则在这种情况下，您需要转义反斜杠并提供像`\\\\server\\Converter.exe`.

与`"\\android\\"+filename`which should be相同`"android\\"+filename`。（我假设您正在使用`\\*.sdtid`转义引号，不确定这在 Java 中是否与在 C# 中相同）。

批处理命令应该看起来更像

```
"cmd /c Converter.exe android\\"+filename+" -android -o android\\"+filename 
```

如果您需要在空格的情况下引用文件名，我想您需要转义它，再次在 C# 中这将是`\"`.

如果这不是问题，那么我建议您调试其余代码和/或改进您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T20:38:26.960

我终于弄清楚了问题所在。`\\android\\"+filename worked`

# c# - 使用 WMP 在 C# 中暂停/播放 MP3 文件

> ID：11165004
> 
> 赞同：0
> 
> 时间：2012-06-22T22:34:18.087
> 
> 标签：c#, mp3, wmp

我又一次陷入了我的练习中。我希望在打开程序时播放 MP3 文件 - 我可以做到，我有音乐。我还想要一个允许暂停音乐的复选框 - 但要么我很累，要么这件事不起作用 - 当我选中/取消选中它时没有任何反应。我已经这样做了：

```
public void PlayPause(int Status)
     {
        WMPLib.WindowsMediaPlayer wmp = new WMPLib.WindowsMediaPlayer();
        switch (Status)
        {
            case 0:
                wmp.URL = "Musik.mp3";
                break;
            case 1:
                wmp.controls.play();
                break;
            case 2:
                wmp.controls.pause();
                break;
        }
    } 
```

在打开程序时，该方法以 case 0 调用。音乐播放。都好。然而这不起作用，我不明白为什么，因为它是非常简单的代码。

```
 public void checkBox1_CheckedChanged(object sender, EventArgs e)
    {
        if (checkBox1.Checked == true)
        {
            PlayPause(2);
        }
        else if (checkBox1.Checked == false)
        {
            PlayPause(1);
        }
    } 
```

关于为什么选中复选框不会暂停/取消暂停音乐的任何想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-22T22:37:06.257

每次调用 PlayPause 函数时，都会实例化一个全新的 WindowsMediaPlayer 对象。

因此，当您稍后调用 pause 时，您什么也没有暂停。

您需要保留或传递对该 WMP 对象的引用，以便您在同一个对象上进行操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T22:37:32.600

嗯，这是因为您每次调用 PlayPause 时都在创建一个新的媒体播放器。在构造函数中创建它应该没问题。

# ruby-on-rails-3 - 需要帮助将设计流程融入 REST

> ID：11165007
> 
> 赞同：0
> 
> 时间：2012-06-22T22:34:43.690
> 
> 标签：ruby-on-rails-3, rest, routing

我在理解如何将我拥有的特定设计流程融入适当的 REST 架构时遇到了一些麻烦。让我解释一下流程：

我正在创建技术支持网站，用户可以在其中提交**ProblemRequests**。在首页，用户选择他遇到问题的所有类别并单击“获取帮助”，然后将他重定向到下一页，在那里他填写一些表格以提交他的请求。以下是页面：

[第 1 页 - 选择问题类别](http://i.minus.com/ijzMDj1LiPxFI.png)

[第 2 页 - 填写问题请求](http://i.minus.com/ibzdee6NK8hqhV.png)

Page 2 基本上就像**ProblemRequest**的 NEW 动作。问题是每个 ProblemRequest 都依赖于多个**ProblemCategories**，因此嵌套路由在这里不起作用。接下来想到的是将所有相关的 ProblemCategories id 作为*NEW* **ProblemRequest**操作的 GET 参数发送，但我不想在 URL 中公开这些 ID。

想到了一种多部分形式，但这涉及使**问题请求**具有状态，其中一些是完整的，而另一些是不完整的。我不想处理这些影响，因为实际上这是一个单页提交，而不是一个非常冗长的过程。

**理想的工作是覆盖ProblemRequests 控制器**的 NEW 操作以响应 POST 操作，但我不知道这是否被认为是不好的编程实践。这是大罪吗？我可以将 NEW 操作更改为响应 POST 而不是 GET 吗？

请指教，

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T22:41:06.663

把事情简单化。往返服务器有什么原因吗？我只是将两个“页面”制作为一个页面并在客户端维护所选类别的状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T23:49:19.970

使用多步骤表单：[http ://railscasts.com/episodes/217-multistep-forms](http://railscasts.com/episodes/217-multistep-forms)

您可以在会话中保存 ID，在您完成信息填写之前，模型不会保存在数据库中。适用于简单的 2 或 3 步表格。

对于更复杂的向导，您可以使用像[https://github.com/schneems/wicked这样的 gem](https://github.com/schneems/wicked)

# html - 正文和页脚的问题

> ID：11165009
> 
> 赞同：-1
> 
> 时间：2012-06-22T22:34:58.790
> 
> 标签：html, css

我的屏幕上有一条奇怪的白线。可以在 jsfiddle 中看到该行。 [http://jsfiddle.net/fWq3c/3/](http://jsfiddle.net/fWq3c/3/) 我的真实屏幕图像可在此处获得：http: [//postimage.org/image/w4jcveyyv/f0779d0b/](http://postimage.org/image/w4jcveyyv/f0779d0b/)

奇怪的是，我的身体在所有屏幕中都没有。

在我的代码中， div #tudo 在正文中。但结果，#tudo 似乎扩展到了身体之外。

```
 <body>
    <div id="tudo">
        <div id="topo_login"></div>
        <div id="conteudo_login">
            @RenderBody() 
        </div>
        <div class="limpar"></div>
        <div id="rodape2"></div>            
        <div id="rodape"></div>
    </div>
</body> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T22:41:04.177

出现这条线是因为背景图像`http://s15.postimage.org/sjog2gpff/Fundo.png`在白色底部有一个边框。更改/编辑此图像，然后重试。

# uml - visio 2010 UML Change shape from Class to Interface

> ID：11165014
> 
> 赞同：0
> 
> 时间：2012-06-22T22:35:29.487
> 
> 标签：uml, visio

*edit: I understand that stackoverflow has banned all questions regarding using Microsoft's Visio. I'm a bit surprised by that, but if someone would bend the rules and help me out I'd greatly appreciate it.

I already tried looking at microsoft's website and other forums on the internet and I'm not finding what I'm looking for. Perhaps there is someone here who knows about Visio 2010.

I dragged and dropped a static structure shape for a UML Class onto my drawing area, and I filled out all the data in it. I then realized that I needed to change it from a class to interface shape. I thought I could simply right click and change this, but no. I tried going to drawing options, but all that does is change it for the future so that it will automatically create an interface shape when I drag and drop.

Isn't there any way to take data from these shapes so I can reuse it again without having to retype it all over in the data fields?

I tried creating a shape data set like msdn blog talks about. I chose to "create from an existing set"---thinking that this means creating from my already existing data from my class shape. Unfortunately this wasn't this case, and it ended up being completely empty....for some reason.

I would think it would be silly that someone would have to manually recreate all the class info all over again, simply because they wanted to change the shape of a UML static structure.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T19:10:19.500

You are not changing the shape, you are changing the meaning of the model entity - their meaning is different therefore the shape cannot be changed.

If you are only using your diagram for display purposes, you can add a new `<<interface>>` stereotype that can be applied to classes, and apply this stereotype to the classes you want to refactor. Otherwise, sadly, you'll have to write it all again.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-17T10:31:06.280

You can try the following (worked for me):

1.  Create a new interface and name it whatever you like
2.  In the Model Explorer drag and drop all methods, etc. from your class to your interface.
3.  Drag the interface you just created from the Model Explorer to the actual document (You'll get the interface in a lollipop representation)
4.  Add the interface to your class (the line end of the lollipop has to be attached to class)

By doing this you can quickly create an interface and move the methods from the class to the interface. Also, when the lollipop interface is attached to the class, all methods are added to the class, too.

# java - 从 Java 与 AJAX 站点交互

> ID：11165017
> 
> 赞同：0
> 
> 时间：2012-06-22T22:35:58.610
> 
> 标签：java, ajax

我正在尝试下载网站的内容。该站点是一个磁电机站点，可以通过选择侧边栏上的属性来过滤结果。请参阅 zannioptical.com 以获得一个很好的例子。

我正在尝试下载网站的内容。因此，如果我们以 zennioptical.com 为例，我需要下载所有矩形眼镜。或所有的塑料等。

那么如何向服务器发送请求以仅显示矩形框等？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T20:33:22.483

您的基本答案是您需要使用正确的查询参数执行 HTTP GET 请求。根据您的问题，不完全确定您是如何尝试执行此操作的，因此这里有两个选项。

如果您尝试从 javascript 执行此操作，您可以查看[此问题](https://stackoverflow.com/questions/247483)。它有一堆答案，展示了如何使用内置`XMLHttpRequest`或使用`jQuery`.

如果您尝试从 java 应用程序下载页面，这实际上根本不涉及 AJAX。您仍然需要执行 GET 请求，但现在您可以查看[其他问题](https://stackoverflow.com/questions/1485708)以获取一些想法。

无论您使用的是 javascript 还是 java，最困难的部分是找出要查询的正确 URL。如果您尝试抓取其他人的网站，则在过滤结果时必须查看浏览器请求的 URL。查看该信息的最简单方法之一是在 Firefox 中`Web Console`找到`Tools`-> `Web Developer`-> `Web Console`。你也可以下载像[Wireshark](http://www.wireshark.org/)这样的东西，它是一个很好的工具，但对于你需要的东西可能有点矫枉过正。

**编辑**

例如，当我单击 zennioptical 上的“矩形框”选项时，这是在以下位置触发的查询`Web Console`：

```
[16:34:06.976] GET http://www.zennioptical.com/?prescription_type=single&frm_shape%5B%5D=724&nav_cat_id=2&isAjax=true&makeAjaxSearch=true [HTTP/1.1 200 OK 2328ms] 
```

您必须执行足够数量的操作才能弄清楚如何生成 URL 以获得所需的结果。

**免责声明**

如果您正在下载其他人的数据，最好先与他们核实。服务器的所有者可能不明白他们可能会考虑*窃取*他们的数据/工作。然后根据你如何使用你下载的数据，你可能会冒险解决各种道德问题……再说一次，如果你是从自己的网站下载，那就去吧。

# .net - Dotfuscator 构建后事件退出，代码 1

> ID：11165023
> 
> 赞同：2
> 
> 时间：2012-06-22T22:36:22.800
> 
> 标签：.net, build, build-automation, obfuscation, dotfuscator

我试图在 TFS 的构建过程中自动对我的项目进行 dotfuscate。

我在项目属性下创建了一个“构建后事件”，如下所示：

> "C:\Program Files (x86)\PreEmptive Solutions\Dotfuscator Professional Edition 4.9\dotfuscator.exe" /in:"$(TargetPath)" /out:"$(TargetDir)Obfuscated\" /honor:on /strip:on /prune:off /rename:off /suppress:on /mapout:"$(TargetFileName).xml" /debug:pdb xcopy /S /R /Y "$(TargetDir)Obfuscated\$(TargetFileName)" "$(TargetDir )"

当此事件开始时，我收到以下错误：

> "C:\Windows\Microsoft.NET\Framework64\v4.0.30319\Microsoft.Common.targets (3717)：命令 ""C:\Program Files (x86)\PreEmptive Solutions\Dotfuscator Professional Edition 4.9\dotfuscator.exe" /in:"C:\Builds\5\BIMS\Sandbox Branch Private Test Manual Build\Binaries\ProcessBookmarks.exe" /out:"C:\Builds\5\BIMS\Sandbox Branch Private Test Manual Build\Binaries\Obfuscated\ " /honor:on /strip:on /prune:off /rename:off /suppress:on /mapout:"ProcessBookmarks.exe.xml" /debug:pdb xcopy /S /R /Y "C:\Builds\5\ BIMS\Sandbox Branch Private Test Manual Build\Binaries\Obfuscated\ProcessBookmarks.exe" "C:\Builds\5\BIMS\Sandbox Branch Private Test Manual Build\Binaries\"" 以代码 4 退出。"

我已经对这个主题进行了数小时的研究、实验和谷歌搜索，但无法找出错误的解释。当我在本地运行构建时，命令工作得很好。任何帮助将不胜感激

编辑：我已经做了几次尝试让 dotfuscator 通过命令行工作。我已确保 dotfuscator 命令在本地自行工作，但是当我运行构建定义时，dotfuscator 命令行以代码 1 退出，如下所示，我不知道如何修复它：

> C:\Windows\Microsoft.NET\Framework64\v4.0.30319\Microsoft.Common.targets (3717)：命令“C:\Program Files (x86)\PreEmptive Solutions\Dotfuscator Professional Edition 4.9\dotfuscator.exe”/ in:"C:\Builds\5\BIMS\Sandbox Branch Private Test Manual Build\Binaries\ProcessBookmarks.exe" /out:"C:\Builds\5\BIMS\Sandbox Branch Private Test Manual Build\Binaries\Obfuscated" / Honor:on /strip:on /prune:off /enhancedOI:on /suppress:on /mapout:"C:\Builds\5\BIMS\Sandbox Branch Private Test Manual Build\Binaries\ProcessBookmarks.exe.xml" /debug: pdb”以代码 1 退出。

我仍然无法让 dotfuscator 在我的自动化构建中工作，有没有人有他们如何做到这一点的例子。我真的很感激这个问题的答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T16:51:42.460

我建议使用 copy 而不是 xcopy 将混淆的 dll 复制到输出文件夹。

我建议这样做的原因是因为我花了一天时间尝试和你做同样的事情，除了我的解决方案中有 Dotfuscator 项目 (*.dotfuproj)（而不是在构建后步骤中通过命令行调用 Dotfuscator）而且我是尝试在 Dotfuscator 项目构建后步骤期间复制 Dotfuscator 输出。

当我使用 xcopy 时，它无法复制文件而没有任何警告、错误或消息。它就像什么都没发生一样继续 - 没有正面或负面的输出。没有什么。

通过命令行执行 xcopy 命令运行良好——对于 xcopy 为什么不起作用以及为什么我没有收到说明原因的消息没有任何意义。[如果有人知道这是为什么，我很想知道]

使用 copy 您需要指定目标文件，而不仅仅是上面 xcopy 命令中的目录。

[我会将此添加为对您问题的评论，但我似乎没有能力/代表（？）]

# java - 在 Java 中用尾数解析浮点数

> ID：11165025
> 
> 赞同：1
> 
> 时间：2012-06-22T22:36:57.837
> 
> 标签：java, floating-point, double, bigdecimal, mantissa

使用标准 Java`Double`类来解析带有尾数的浮点数似乎省略了指数中的 + 号。

例如：

```
Double.parseDouble("1258124354E-28") returns 1.258124354E-19, but
Double.parseDouble("1243544322E+24") returns 1.243544322E33 (not E+33) 
```

有什么方法可以使用 Double 获得 + 符号，而无需字符串后处理？

这`BigDecimal`门课做得更好，例如

```
new BigDecimal("1243544322E+24").toString() does return 1.243544322E+33 
```

但它通常比 慢`Double`，这在密集处理中表现出来。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-22T22:40:08.507

您需要区分存储在 a 中的*值*`double`及其字符串表示形式。

A`double`根本不存储文本表示。1.243544322E33*是*1.243544322E+33。它们是相同的值。

现在，如果您想研究如何将值*格式化*`double`回 a ，`String`那是另一回事 - 但您正在做的*解析很好。*您不会丢失任何信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T23:02:05.800

乔恩如上所述是正确的，它在记忆中正确地表示它。如果您希望它在尾数上显示 + ，那么您正在谈论格式化双精度的字符串。

[冗长的官方格式化程序参考](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Formatter.html#l10n%20algorithm)

```
import java.util.Formatter;

double myDouble = Double.parseDouble("1243544322E+24");

Formatter formatter = new Formatter();
formatter.format("%+E", myDouble); //This should return with what you want, though with an extra + infront of the number 
```

我没有运行这段代码，所以我不能 100% 确定它会完成这项工作。格式说明符中的 + 强制它为任何数字放置一个 + 或 - 符号......我相信这会延伸到尾数。

# ruby-on-rails - 将 Michael Hartl 的 Rails 应用程序降级到 Rails 2

> ID：11165034
> 
> 赞同：-1
> 
> 时间：2012-06-22T22:38:06.120
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-2

[我通过扩展Michael Hartl 的 Rails 3 教程](http://ruby.railstutorial.org/ruby-on-rails-tutorial-book)来构建（破解）我的网络应用程序，却发现我的网络托管服务需要 Rails 2.3.8。我是 Ruby/Rails 的新手，想知道从 Rails 3.x 降级到 Rails 2.x 的可行性。

不幸的是，我的虚拟主机无法升级到 Rails 3。

编辑

更具体地说：我的应用程序主要基于上面提到的教程。我正在寻找将 Rails 3 教程应用程序降级为 Rails 2 应用程序所涉及的工作类型。无论如何我都会尝试一下，但由于我对 Ruby / Rails 缺乏经验，所以在开始之前，我只是想知道会发生什么（即，是否会有很多语法更改，或者我是否必须重组文件目录等）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T03:55:49.610

你不想这样做，这是一个非常糟糕的主意，你最终会用奇怪的错误消息永远追逐你的尾巴，当你问他们时，你会是一个非常不寻常的案例。

任何一个

*   寻找支持 Rails 3 的主机，同时为 Rails 4 做好准备 (tee-hee)
*   从 amazon 或 ebay 上满足 rails 2 的（许多）书籍中寻找（此时可能仍然是大多数）。
*   使用 Heroku - 许多人使用 Heroku 免费上线，然后在需要更多时以低成本使用。

关于 Rails 的主要问题是版本进展迅速 - 每个版本的代码结构都发生了很大变化。与其他更成熟的技术相比，您必须更加努力地避免技术债务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T03:44:58.710

同意“新主人”的建议。我没有降级应用程序，但我在大型应用程序上所做的升级需要数周时间。所以我的回答是，我想尝试它还不够可行，而且我已经使用 Rails 多年了。

多年来，我一直拥有一个廉价的[Dreamhost](http://dreamhost.com/)帐户，并且它们保持最新状态。我也听说过有关 bluehost 的好消息。请注意，这两个共享提供商都是“物有所值”，但如果您重视自己的时间，那么它肯定值 7 美元或不花时间降级应用程序的月费。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-23T09:01:11.553

如果那是你真正想要的，它可以做到。但这是很多工作。我记得将一个非常大的应用程序从 rails 2 升级到 rails 3。您需要反过来执行此操作。我必须解决 gem 兼容性问题（一些 gem 只适用于 rails 3，现在可能更难获得对 rails 2 的支持），活动记录在过去的版本中有不同的 API，我什至不确定是否有链接特征。例如，代替 Model.where，您通常会编写 Model.find(:conditions => {...})，如果您使用的是出现在 rails 3 中的通用 ajax 助手（带有 :remote => true），那么这些行不通。另外，我还会扫描 rails changelog 以确保在 rails 3 中完成的任何安全补丁。可能是您将不得不在旧版本中自行加强某些地方的安全性。如果您的应用程序测试涵盖了（我希望您这样做:-)），那么旧版本的 rspec 或 cucumber 可能会出现一些问题，但通常这些问题并不大。我认为宝石兼容性是最大的问题。其余的或多或少是机械工作。查找和替换。

祝你好运，但如前所述，如果您可以切换主机，那么我建议您这样做并坚持使用最新版本的 rails。

# javascript - facebook的内容是动态加载的吗？

> ID：11165039
> 
> 赞同：0
> 
> 时间：2012-06-22T22:38:25.530
> 
> 标签：javascript, facebook, address-bar

在 Facebook 上单击链接时，顶部标题栏根本不会闪烁。我习惯于在通过 ajax 加载内容的页面上看到这种效果，但在 Chrome 上，url 正在改变，据我所知，这意味着加载了一个新页面。

在 javascript 中，我知道没有重定向就无法更改 url，但主题标签可以，所以我觉得这很有趣。我认为这可能是 chrome 所做的事情，它会先加载一个网页，然后再将您从上一个网页中移除以创建无缝体验，因此我在 Internet Explorer 上进行了尝试。在 IE 上，效果相同，但这次 url 没有改变，只是 hashtag。我也在 FireFox 上试过，它改变 URL 的方式与 chrome 相同。

这里发生了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-22T22:42:44.113

是的，它加载了 AJAX。[并且通过操纵历史](https://developer.mozilla.org/en/DOM/Manipulating_the_browser_history)来更改网址。一个名为[HistoryJS](https://github.com/balupton/History.js/)的不错的库也使用哈希更改为不支持的浏览器包装了此功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T22:42:48.553

不确定 Facebook 上是否是这种情况，但[History API](http://diveintohtml5.info/history.html)允许您以编程方式更改 URL - 只要您遵守[相同的来源策略](http://en.wikipedia.org/wiki/Same_origin_policy)。[GitHub](https://github.com/blog/760-the-tree-slider)是不显眼地使用这种技术的一个很好的例子。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-22T22:43:27.590

在现代浏览器中，可以通过该[`history.pushState()`](https://developer.mozilla.org/en/DOM/Manipulating_the_browser_history#The_pushState%28%29.C2.A0method)函数在不重新加载页面的情况下更新 URL。

例子：

```
history.pushState({}, "", "foo.html"); 
```

# c# - 派生类在自己的静态方法中调用基类的静态方法

> ID：11165040
> 
> 赞同：5
> 
> 时间：2012-06-22T22:38:32.113
> 
> 标签：c#, static-methods, derived-class

我已阅读以下 SO 文章

*   [C#：如何从派生类的静态方法调用基类的静态方法？](https://stackoverflow.com/questions/603177/c-how-do-i-call-a-static-method-of-a-base-class-from-a-static-method-of-a-deri)
*   [我可以有一个基类，其中每个派生类都有自己的静态属性副本吗？](https://stackoverflow.com/questions/5060124/can-i-have-a-base-class-where-each-derived-class-has-its-own-copy-of-a-static-pr)
*   [静态方法继承的正确替代方法是什么？](https://stackoverflow.com/questions/1380087/whats-the-correct-alternative-to-static-method-inheritance-c)

所有人似乎都非常接近我的问题并且有很好的答案，但他们似乎没有回答我的问题，只是说我需要使该方法成为非静态的。

一个例子：

```
abstract public class baseClass
{
    private static List<string> attributeNames = new List(new string {"property1","property2"});
    // code for property definition and access
    virtual public static bool ValidAttribtue(string attributeName)
    {
        if (attributeNames.Contains(attributeName))
            return true;
        else
            return false;
    }
}
class derivedA : baseClass
{
    private static List<string> attributeNames = new List(new string {"property3","property4"});
    // code for property definition and access
    public static override bool ValidAttribute(string attributeName)
    {
        if (attributeNames.Contains(attributeName))
        {
            return true;
        }
        else
        {
            return base.ValidAttribute(attributeName);
        }
    }
}
class derivedB : baseClass
{
    private static List<string> attributeNames = new List(new string {"property10","property11"});
    // code for property definition and access
    public static override bool ValidAttribute(string attributeName)
    {
        if (attributeNames.Contains(attributeName))
        {
            return true;
        }
        else
        {
            return base.ValidAttribute(attributeName);
        }
    }
} 
```

derivedA 将具有属性 1,2,3,4，而 derivedB 将具有属性 1,2,10,11。属性列表似乎是特定于类的值，不能在任何时候更改。我认为它会是静态的。

我的设计是否错误，因为我在不应该使用静态方法时尝试使用它们？

上面的例子让我觉得需要继承静态方法，但似乎尝试这样做是一个设计缺陷。任何人都可以帮助我理解以这种方式编码或构造类有什么问题吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-22T22:42:35.763

> 我的设计是否错误，因为我在不应该使用静态方法时尝试使用它们？

是的。除此之外，您还试图将静态方法声明为`virtual`（然后覆盖它），这是不允许的。`base`当这是一个关键字时，您还试图声明一个名为 的类。

静态方法根本不是多态的。多态性的基础是所涉及的实例的执行时间类型可以不同于表达式的编译时间类型，并根据执行时间类型选择实现。这个概念对于静态方法没有意义，因为*没有*实例。

现在当然*可以*让派生类中的静态方法调用基类中的静态方法——但在任何地方都不会有任何多态性。

作为旁注，您的所有方法都可以以更易读的方式编写：

```
// Base class implementation
return attributeNames.Contains(attributeName);

// Derived class implementations
return attributeNames.Contains(attributeName) ||
       BaseClass.ValidAttribute(attributeName); 
```

# java - 拉取屏幕图像的路径

> ID：11165044
> 
> 赞同：0
> 
> 时间：2012-06-22T22:39:33.003
> 
> 标签：java, android, robotium

我正在尝试提取我正在测试的应用程序的 android 手机上查看的屏幕图像的路径。该应用程序显示各种图片。我想拉图片的路径来拉图片名，但是不知道怎么下手。有什么指导吗？

编辑：我试图找出是否可以从应用程序代码中提取路径以查看用户正在查看的图像。例如。如果我在看一张图片，我想知道图片的路径是什么（路径应该来自某人的硬盘）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T23:42:08.840

图像不一定有路径。最好说出图像的来源，无论是文件、HTTP 流还是其他。不幸的是，一旦将其设置为`ImageView`.

要将图像位设置为`ImageView`，请构造 a `Bitmap`，通常使用 中的`decode*()`方法之一`BitmapFactory`。这就是决定图像来源的因素。在您的单元测试框架中，您可以`ImageView`通过获取`Activity`和调用来处理`findViewById()`，但这对您没有帮助。

您可能还有其他地方可以连接到代码中以确定图像数据的来源，但如果不知道您的应用程序源代码，我就不能说。

您可以要求您的开发人员在`ImageView`'s 标签中提供源代码（请参阅`setTag()`/ `getTag()`）。这样你就可以在你的单元测试中把它拉出来。当然，您必须与他们了解源是什么（URL、数据库 URI、文件路径，？）。

# database - 从 Magento 数据库获取查询——mysql_num_rows

> ID：11165052
> 
> 赞同：1
> 
> 时间：2012-06-22T22:40:16.697
> 
> 标签：database, magento, fetch, mysql-num-rows

Magento中什么函数等于mysql_num_rows？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T08:58:02.613

对于 Magento，适当的等价物是 PHP 的[`count()`](http://php.net/manual/en/function.count.php)函数。

### 为什么？

Magento 通常使用`Varien_Data_Collection`实例来获取包含多条记录的结果集。Varien 为这些集合实现了[延迟加载模式](http://martinfowler.com/eaaCatalog/lazyLoad.html)，也就是说，在您真正需要之前不会获取任何结果集。

如果你看一下这个`Varien_Data_Collection`类，你会发现，这个类确实实现了 PHP 的[Countable 接口](http://www.php.net/manual/en/class.countable.php)和这个接口的正确`count()`方法：

```
class Varien_Data_Collection implements IteratorAggregate, Countable
{
    :
    public function count()
    {
        $this->load();
        return count($this->_items);
    }
    :
} 
```

如果您现在问自己，延迟加载与计数记录有什么关系，那么您需要知道以通常的 Magento 方式查询集合，例如：

```
$collection = Mage::getModel('catalog/product')
    ->getCollection()
    ->addFieldToFilter(
        'status',
        Mage_Catalog_Model_Product_Status::STATUS_ENABLED
    ); 
```

根本*不*获取结果集。但是，您如何计算尚未获取的结果集的记录？对，你不能。也不能`mysql_num_rows`。它首先获取结果集。

现在，当您调用`count()`集合时，例如通过

```
$n = count($collection); 
```

PHP 的核心`count()`函数将检测传递的参数`$collection`实现了一个`Countable`接口并定义了自己的`count()`方法，因此它将调用该接口。

这导致真正获取结果集^*并将其存储到`$this->_items`，这最终允许对记录进行计数并返回数字。

* * *

[* 在 Magento 中，您也可以调用`foreach ($collection as $product)`以真正获取结果集，但这是另一回事。]

# java - drawLine() 使用双变量而不是整数

> ID：11165055
> 
> 赞同：0
> 
> 时间：2012-06-22T22:40:32.007
> 
> 标签：java, java-2d

我想问是否可以使用双变量而不是整数来画线。如果是怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T22:52:55.930

您可以使用[Line2D.Double](http://docs.oracle.com/javase/6/docs/api/java/awt/geom/Line2D.Double.html)。使用[Graphics2D.draw()](http://docs.oracle.com/javase/6/docs/api/java/awt/Graphics2D.html#draw%28java.awt.Shape%29)绘制它。

有关更多详细信息和示例，请参阅[绘制几何图元](http://docs.oracle.com/javase/tutorial/2d/geometry/primitives.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T22:53:15.917

像这样 ？

```
 Line2D line = new Line2D.Double();
             Graphics2D g2 = aPaintContext.getGraphics();
             for (double x = bx; x < rightBorder; x += 5) {
                line.setLine(x, by, x, bottomBorder);
                g2.draw(line); 
```

# jquery - 根据 Jquery UI Slider 值更改的附加文本框

> ID：11165056
> 
> 赞同：1
> 
> 时间：2012-06-22T22:40:34.250
> 
> 标签：jquery, jquery-ui, slider, uislider

我有一个从 0 到 100 的 jquery UI Slider，默认开始是 50。我想知道如何创建一个额外的简单文本框，该文本框根据来自 Slider 的用户值打印 3 个不同选项之一。基本上，如果范围在 0-33 之间，则文本框将显示为（简单），如果范围为 34-66，则显示为（平均），而 67-100 将显示为（困难）。

这是目前我的代码：

```
<script> 
$( ".slider3" ).slider({
animate: true,
range: "min",
value: 50,
min: 0,
max: 100,
step: 1,

//this gets a live reading of the value and prints it on the page
slide: function( event, ui ) {
$( "#slider-result3" ).html( ui.value );
},

});
</script> 
```

请帮忙，因为我已经尝试了几个小时来解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T22:50:43.200

您只需要在 slide 方法中的 ui.value 上做一个 if ：

```
if (ui.value <= 33)
    $( "#slider-input3" ).val( "easy" );
else if (ui.value <= 66)
    $( "#slider-input3" ).val( "average" );
else
    $( "#slider-input3" ).val( "hard" ); 
```

有关示例，请参[见此 jsfiddle](http://jsfiddle.net/geFCF/8/)。

# forms - Symfony2 通过表单和链接进行搜索

> ID：11165058
> 
> 赞同：0
> 
> 时间：2012-06-22T22:40:52.937
> 
> 标签：forms, search, parameters, symfony, get

在 Symfony 2 中，我尝试创建一个小型搜索引擎。搜索由一个表单和一些链接组成（如 solr 上的方面）。我设法使用表单绑定设置搜索表单，在实体中创建特殊的 searchobject 类，所有这些都通过表单发布请求。为了保存以前的搜索，我将完整的搜索对象保存在序列化的会话中。

我的问题是：

如何在不输出表单名称的情况下使用表单获取请求？在 Symfony 2 中通过 get 使用表单是否有效？最佳做法是什么？

我看到的许多使用 Symfony 2 制作的网站都使用 www.url.com/search?q=thequery¶m2=xxx。

如果有效，我将如何预填表格？有一些例子可以看吗？

（PS：如果以现在的方式使用表单，则 url 保持不变，例如 www.url.com/seach）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T08:40:07.323

Just try to change you html form declaration to specify `method="GET"`.

And that's all, you can create your form as usual. :)

# html - IE9 输入/按钮元素边框颜色问题

> ID：11165061
> 
> 赞同：1
> 
> 时间：2012-06-22T22:41:18.307
> 
> 标签：html, css, internet-explorer, xhtml, internet-explorer-9

在我目前正在构建的网站中，我无法让我的边框颜色适合`<input>`和`<button>`元素。我想让顶部、左侧和右侧边框颜色相同，然后底部边框颜色不同。除了这两个之外，我可以让样式适用于任何其他元素，而这个问题只存在于 IE9 中。任何帮助或解释将不胜感激。

我的问题示例：http: [//jsfiddle.net/NyG3x/24/](http://jsfiddle.net/NyG3x/24/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T22:53:24.230

尝试单独设置边框。

```
border: 1px solid #000;
border-bottom: 5px solid #CE181E 
```

这在 IE9 中出现了一个错误。如果将底部边框设置为 1px，则红色边框会正确显示。但是，如果您将该值设置为大于 1px 的值，它似乎会恢复`border-color`为 other 的值`border-color`。

**更新**

一个简单的解决方案是从 中删除样式，包装内部 a`button`的内部文本并设置. 这在 IE9 中有效，如此[处所示](http://jsfiddle.net/NyG3x/46/)。`button``div``div`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-22T23:26:21.637

我知道这是更多的标记，但它肯定会解决问题。

像往常一样将 1px 边框应用于三个边，但将表单元素包装在标签中，例如 div 标签，并在 div 标签上应用 5px 底部边框。

HTML 看起来像这样：

```
<form id="button-set-two">
    <div class="btn-wrapper">
        <input class="btn-style" type="submit" value="Btn1" />
    </div>
</form> 
```

CSS 看起来像这样：

```
#button-set-two .btn-style{
    border: 1px solid #000;
    border-bottom:none;
    color: #000;
    float: left;
    font-size: 1.6em;
    margin-right: 5px;
    padding: 2px 10px;
    background: none;
}

#button-set-two .btn-wrapper{
    border-bottom:5px solid #CE181E;
} 
```

# c# - 有没有一种值得的方法来自动调整 datagridview 列宽？

> ID：11165062
> 
> 赞同：0
> 
> 时间：2012-06-22T22:41:21.743
> 
> 标签：c#, winforms, datagridview

我希望我的 DataGridView 显示整个标题文本（从不剪辑或截断它）。

在某些情况下，我也希望它对列中的值也做同样的事情（它们是相对较短的值，例如“76 trombones”、“3.141592653589793”、“King of the Wild Frontier”等。

我知道我可以通过名称或索引专门引用每一列并设置一个值或一个百分比，但我希望它自动调整自身大小，使其宽度足以显示整个标题文本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T02:39:08.453

您可以迭代 DataGridView 的列并设置其 AutoSizeMode 属性，如下所示：

```
 foreach(DataGridViewColumn column in dataGridView1.Columns)
 {
     column.AutoSizeMode = DataGridViewAutoSizeColumnMode.AllCells;
 } 
```

DataGridViewAutoSizeColumnMode 中还有其他选项。AllCells 选项调整所有列以适合所有单元格的内容，包括标题单元格。

为了在你的代码中实现这一点，我建议你把它放在一个静态方法中，这样你就可以重用它并为其他 DataGridViews 设置列：

```
 public static void SetColumns(DataGridView dgv)
 {
    foreach(DataGridViewColumn column in dgv.Columns)
    {
       column.AutoSizeMode = DataGridViewAutoSizeColumnMode.AllCells;
    }
 } 
```

如果需要，您可以在其中添加其他常规列修改，例如 DefaultCellStyles 等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T22:52:48.040

这种扩展方法（是我自己的）可以回答您的问题 - 甚至更多 { headers, visible / invisible columns, width, height and scrollbars } [https://stackoverflow.com/a/10867026/967770](https://stackoverflow.com/a/10867026/967770)

# mysql - 如何使用 xampp/phpmyadmin 配置 innodb 的 innodb_autoinc_lock_mode

> ID：11165063
> 
> 赞同：1
> 
> 时间：2012-06-22T22:41:43.677
> 
> 标签：mysql, phpmyadmin, xampp, innodb

大家好，我目前正在本地 xampp 服务器上测试我的项目。我需要更改 innodb_autoinc_lock_mode ，但我不知道该怎么做。有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-14T09:19:55.273

在 xampp\mysql\bin\my.ini 中更改它并重新启动 mysql 服务

# css - 更改 Chrome 中的选择边框颜色

> ID：11165066
> 
> 赞同：2
> 
> 时间：2012-06-22T22:42:12.467
> 
> 标签：css, google-chrome

每当您在网页上按 Tab 键时，浏览器都会在所选元素周围放置一个边框。IE 和 Firefox 只使用灰色虚线，但 Chrome 使用纯黄色突出显示。我的问题是 Chrome 还会在任何活动字段输入周围放置此边框 - 因此，每当 Chrome 用户单击我的一个联系人字段以输入他们的信息时，文本框周围就会弹出黄色边框，并且真的弄乱了我的配色方案。

有没有办法通过 CSS 覆盖 chrome 中的这种行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T22:46:25.170

用这个：

```
input:focus, textarea:focus { outline: /* whatever you want it to be */ } 
```

见[这里](http://beckelman.net/2008/09/15/override-chromes-automatic-border-around-active-fields-using-css/)。

# php - 如何通过跨域调用防止 CSRF

> ID：11165075
> 
> 赞同：1
> 
> 时间：2012-06-22T22:43:16.893
> 
> 标签：php, javascript, session, csrf

现在我有一种情况，当来自 example.com 的 javascript 可以访问站点 test1.example.com 时。我是通过跨域做到的，我想防止 CSRF 注入。

我想以标准方式进行此操作-在服务器端-我创建哈希-在会话中保存哈希但我不能这样做，因为当我在 $_SESSION 中保存哈希并想从客户端检查时-$_SESSION 为空-因为它是另一个域（当通过服务器端的代理脚本意识到这一点时 - 没问题）。函数 check_csrf_token - 总是返回 false。

来自服务器端的简单代码

```
public function get_csrf_token(){
    $token = md5(uniqid(mt_rand() . microtime()));
    $_SESSION['token'] = $token;
}

private function check_csrf_token($token){
    return ($_SESSION['token'] == $this->input->get('token'));
} 
```

# directory - Windows中命令行目录更改cd的快捷方式？

> ID：11165081
> 
> 赞同：2
> 
> 时间：2012-06-22T22:44:17.343
> 
> 标签：directory, cmd, windows-vista, cd

我使用的是 Windows Vista，我想知道是否有直接在当前目录（具有焦点的目录）中打开命令行的快捷方式。每次在命令行中复制/粘贴当前目录实际上是相当痛苦的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T22:49:18.783

按住 shift 并在目录中单击鼠标右键。弹出的菜单可以选择在那里打开命令提示符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T22:49:20.030

只需在右键单击文件夹的同时按住 shift 键，附加选项之一将是“在此处打开命令窗口”。

# c# - 向后遍历字符串以查找字符或短语

> ID：11165082
> 
> 赞同：2
> 
> 时间：2012-06-22T22:44:34.523
> 
> 标签：c#, string, indexof

有没有一种从给定索引开始并向后移动以在字符串中查找给定短语的好方法？我只知道如何使用 indexof 向前迭代。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-22T22:46:26.210

您可以使用[`LastIndexOf`](http://msdn.microsoft.com/en-us/library/system.string.lastindexof.aspx)：

```
int index = s.LastIndexOf("foo"); 
```

如果您想从字符串末尾以外的某个位置开始向后搜索，它还有一个可选的开始索引。

```
int index = s.LastIndexOf("foo", 20); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T22:46:57.743

使用 LastIndexOf [http://msdn.microsoft.com/en-us/library/system.string.lastindexof.aspx](http://msdn.microsoft.com/en-us/library/system.string.lastindexof.aspx)。

# php - PHP 按表格更新表格

> ID：11165085
> 
> 赞同：2
> 
> 时间：2012-06-22T22:44:45.930
> 
> 标签：php, forms, html-table

我正在尝试从表单更新表格。

我有 3 页。第一个使用“编辑”链接查询我表中的所有行。单击编辑时（第 2 页），代码会提取 $id 并将其放入 url。$id 是从 url 中提取的，并在查询中用于填写表单。

我的问题是将更新的表单信息传递给我的表。基本上没有更新。

第二页

```
<?php

  include '../db/config.php';
  include '../db/opendb.php';

$id = $_GET["id"]; 

  $order = "SELECT * FROM tableName where id='$id'";
  $result = mysql_query($order);
  $row = mysql_fetch_array($result);

  ?>

  <form method="post" action="edit_data.php">
  <input type="hidden" name="id" value="<?php echo "$row[id]"?>">
    <tr>        
      <td>Title</td>
<td>
<input type="text" name="title" size="20" value="<?php echo"$row[title]"?>">
</td>
    </tr>
    <tr>
      <td>Post</td>
    <td>
<input type="text" name="post" size="40" value="<?php echo
  "$row[post]"?>">
</td></tr>
<tr>
<td align="right">
<input type="submit" name="submit value" value="Edit">
</td>
    </tr>
</form> 
```

第三页

```
 include '../db/config.php';
      include '../db/opendb.php';

   $query = "UPDATE tableName SET '$_POST[title]', '$post[post]' WHERE id='$id'";
        mysql_query($query); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T22:48:44.543

它应该是

```
UPDATE tableName SET `title` = {$_POST['title']}, `post` = {$_POST['post']}... 
```

问问自己，你在设置什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T22:53:56.167

您更新数据库的 SQL 语句错误。它不仅应包括新值列表，还应包括**相应的字段名称**。这意味着它应该看起来更像这样：

```
$query = "UPDATE tableName SET `title` = {$_POST['title']}, `post` = {$_POST['post']} WHERE id = '$id'"; 
```

`$_POST`请注意，您还应该用大括号 ( ) 包含字符串内部的字段，`{}`或者将它们放在引号之外。（如`" = " .$_POST['title']. ", "`）。如果您使用标准方式访问带有他引号的那些（例如 not `$_POST[title]`but`$_POST['title']`或`$_POST["title"]`），这是绝对必要的。

此外，您应该将以下内容添加到您的代码中：

*   *一些错误处理*，目前你甚至不知道是否出了问题。最简单的方法是检查`mysql_query()`函数的返回值，`null`如果是`null`，则获取 mysql 错误消息`mysql_error()`。
*   *转义传递的值。*目前，您将发布的数据直接传递到非常不安全的 mysql 查询中。（例如参见[wikipedia 上的](http://en.wikipedia.org/wiki/SQL_injection)*SQL-Injection* ）在将它们插入查询之前，您应该在所有表单数据上使用它们。这会逃避所有可能是恶意的部分。[`mysql_real_escape_string()`](http://www.php.net/manual/en/function.mysql-real-escape-string.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T22:49:34.907

那是因为您没有设置值。在声明中：

```
$query = "UPDATE tableName SET '$_POST[title]', '$post[post]' WHERE id='$id'"; 
```

您应该传递要更新的列名。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-22T22:54:34.637

```
if (isset($_POST[title])){
$title = mysql_real_escape_string(trim($_POST['title']));
    }else{
$title = NULL;
    }

if (isset($_POST[post])){
$post = mysql_real_escape_string(trim($_POST['post']));
    }else{
$post = NULL;
    }

$query = "UPDATE tableName SET title='$title', post='$post' WHERE id='$id'";           
mysql_query($query); 
```

我还会推荐 mysqli 函数而不是 mysql，而且我可能不会调用变量和表列“post”以避免混淆。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-23T01:13:27.530

如果您还没有使用 PDO 语句来防止 SQL 注入攻击，那么您应该使用更多的保护，而不是只使用 mysql_real_escape_string()。除了转义数据之外，您还应该验证提交的数据实际上是您所期望的。

IE。在您的代码中：

```
 $id = $_GET["id"]; 

  $order = "SELECT * FROM tableName where id='$id'";
  $result = mysql_query($order);
  $row = mysql_fetch_array($result); 
```

如果您添加：

```
if(is_numeric($_GET['id'])){
   $id = mysql_real_escape_string(trim($_GET["id"]));

   $order = "SELECT id, title, post FROM tableName where id='$id'";
   $result = mysql_query($order);
   $row = mysql_fetch_array($result);
  } 
```

这至少可以验证您正在执行的内容实际上是一个 ID 号（也就是说，如果 ID 实际上是一个数字；）。如果您尚未使用 PDO 语句，则可以将此逻辑应用于所有输入。如果您期待字母，则验证字母，数字验证数字，转义特殊字符。同样，这是最低限度的。我真的建议阅读数百种 SQL 注入技术并开始阅读 PDO。

此外，关于使用 SELECT * 语句。我会尽量避免它。它为您的语句增加了一层漏洞，如果您更改表中字段的顺序并且您正在使用 $row[0] （编号请求），它可能会使事情变得混乱，最后如果您的表包含带有数据的附加字段与您需要的无关，然后您在此页面上使用，然后您正在加载不需要的信息。

```
 $order = "SELECT id, title, post FROM tableName where id='$id'"; 
```

会很好地解决这个问题。：） 祝你好运！

# oauth - oAuth 记住用户的标准是什么？

> ID：11165088
> 
> 赞同：6
> 
> 时间：2012-06-22T22:45:07.170
> 
> 标签：oauth, twitter-oauth, facebook-oauth, user-accounts

我和我的同事开发了一个应用程序（Web 应用程序和移动应用程序（iPhone 和 android）），其中包括一个登录过程。目前，我们有自己的登录机制（用户在我们的应用程序上注册了一个帐户，并将他们的信息存储在我们的数据库中）。我们正在研究集成 oAuth 并允许用户使用 Facebook、Twitter、LinkedIn 和 Google 登录。

现在，当用户使用其中任何一个登录时，据我所知，登录过程发生在我们的应用程序之外，基本上只获得访问其资源的权限。

我的问题是：通过 oAuth，我们如何记住用户？即，登录的用户具有读/写权限并具有偏好。当他们实际上没有通过我们的应用程序注册时，我们如何记住他们。我们可以将他们的电子邮件地址存储在我们的“用户”表中吗？

在这种情况下，最佳实践是什么？

感谢您提供的任何信息。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-22T22:55:37.337

在为几个不同的启用 OAuth 的网站构建了身份验证数据库之后，我可以说我学到了一些你应该记住的东西。

1.  您的站点应该有一个用户表，该表完全独立于他们用于注册/登录的 OAuth 提供商。这使您的站点用户能够在您的站点上以他们的主要身份将多个帐户组合在一起。（例如，将 Facebook 和 Twitter 与您关联。）
2.  当您让用户注册时，您应该从他们那里获得一个电子邮件地址。无论您是向 Facebook 询问，还是必须直接询问。这使您以后可以“升级”用户，从纯粹依赖第三方 OAuth 到在您的站点上设置自己的密码。（您只需向他们发送一个指向您的密码重置页面的链接，以便他们开始创建他们的第一个密码。）
3.  您不想使用电子邮件地址作为主键。我不确定这是否是您实际描述的内容，但您确实希望他们拥有一个本地用户 ID，用于维护他们的会话等。然后，您将他们的 Facebook ID 或他们的 Twitter ID 与该本地相关联ID，并使用此类标识符之间的对应关系来匹配您网站的哪些用户考虑已登录。

# java - MySQL/Hibernate 随机出现“通信链接故障”

> ID：11165091
> 
> 赞同：6
> 
> 时间：2012-06-22T22:45:34.640
> 
> 标签：java, mysql, hibernate, c3p0

我们有一个运行 Hibernate/C3PO 4.1.4.Final、Jetty、Java 6 和 Mysql 5.1.63 的 web 应用程序。

> javax.persistence.PersistenceException：org.hibernate.exception.JDBCConnectionException：通信链路故障
> 
> 从服务器成功接收到的最后一个数据包是 238,519 毫秒前。最后一个成功发送到服务器的数据包是 0 毫秒前。

我们的 persistence.xml 的属性部分看起来像这样......

```
 <properties>
        <property name="hibernate.show_sql" value="false"/>
        <!--Begin Credentials -->
        <property name="hibernate.connection.url"
                  value="${rp.config.db.url}&amp;useUnicode=true&amp;characterEncoding=UTF-8"/>
        <property name="hibernate.connection.username" value="${rp.config.db.user}"/>
        <property name="hibernate.connection.password" value="${rp.config.db.password}"/>
        <!--End Credentials -->
        <property name="hibernate.connection.driver_class" value="com.mysql.jdbc.Driver"/>
        <property name="hibernate.dialect" value="com.printlogix.rp.server.utils.Mysql5BitBooleanDialect"/>
        <property name="hibernate.hbm2ddl.auto" value="validate"/>
        <!--C3PO -->
        <property name="hibernate.connection.provider_class"
                  value="org.hibernate.service.jdbc.connections.internal.C3P0ConnectionProvider"/>
        <property name="hibernate.c3p0.acquire_increment" value="25"/>
        <property name="hibernate.c3p0.idle_test_period" value="60"/>
        <property name="hibernate.c3p0.timeout" value="120"/>
        <property name="hibernate.c3p0.max_size" value="150"/>
        <property name="hibernate.c3p0.min_size" value="25"/>
        <property name="hibernate.c3p0.max_statement" value="0"/>
        <property name="hibernate.c3p0.preferredTestQuery" value="select 1;"/>

    </properties> 
```

我们在 MySQL 上的超时设置为 600 秒。我们不知道这是如何发生的 1/5 次。服务器负载很小，数据库相对较小，servlet 都在几秒钟内运行。

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-09T15:30:24.003

这篇文章解释了修复。当连接过期时，C3P0 不会重新连接。

[http://www.databasesandlife.com/automatic-reconnect-from-hibernate-to-mysql/](http://www.databasesandlife.com/automatic-reconnect-from-hibernate-to-mysql/)

Hibernate 的开发人员不会更好地记录这一点，这似乎完全是疯了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-03T15:10:51.833

我认为[这篇文章](https://stackoverflow.com/questions/14554353/database-connection-to-mysql-times-out-even-after-setting-c3p0-testconnectiononc)可能会有所帮助。如果是这样，增加 的值`wait_timeout`只会推迟更多的时间，而不是解决问题。

问题可能与此有关：

*   你打开一个休眠会话
*   做一些比你的数据库的[wait_timeout值花费更多时间的事情](http://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html)
*   您尝试使用此休眠会话。您在此处评论的消息将出现

如果您有兴趣，我在[这里](http://www.supermanhamuerto.com/doku.php?id=java:thelastpacketsuccessfullyreceivedfromserver)记录了一个案例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-07T07:52:59.707

我们在生产服务器上也遇到了同样的问题。默认情况下，MySQL 每 8 小时重置一次连接，因此我们几乎每 8 小时就会出现一次通信故障，因为我们正在使用预定的作业连续访问数据库。我们通过将“wait_timeout”增加到 14 天来解决它，并且由于我们的维护计划每 15 天进行一次，我们重新启动每个 MySQL 服务器是我们的数据库集群（我们有 Master-Master 复制）。使用方法之后，我们没有遇到任何通信链路故障。实际上，有时我们不会每 15 天重新启动一次服务器，但仍然没有错误（触摸木头）。:) 根据您的描述，您似乎已将 wait_timeout 设置为 10 分钟，所以我猜您会收到时差约为 10 分钟的错误。请注意，在 wait_timeout 之后每次重置 MySQL 连接时，不必出现此错误。仅当您当时正在访问数据库时才会出现。:)

# altova - Altova mapforce 字符串日期到 DateTime

> ID：11165094
> 
> 赞同：3
> 
> 时间：2012-06-22T22:45:54.090
> 
> 标签：altova

希望那里的其他人为此使用 Altova Mapforce。

使用 XSLT 将一个 xml 转换为另一个，在源 XML 中，它们的日期为 M/D/YYYY，我需要将它们转换为标准的日期时间格式......好吧，一切。

所以，我正在使用 XSLT 的 tokenize 函数来拆分/获取我的部分，现在，我想参加第 1 部分并说今天到了，但不确定如何将 tokenize 表达式的结果分配给变量使用地图部队。

还有人这样做吗？或者更确切地说，将字符串日期转换为日期时间的最佳方法是什么？

感谢您的想法

编辑。我的输入是一个字符串 '1/31/2012' 并且我的输出需要是 xs:dateTime （或 xs:date，假设 xs:date 可以很容易地转换为 dateTime）

我有一个方法设置将字符串连接在一起并将它们转换为 YYYY-MM-DD 格式，但它仍然报告这对 dateTime 无效（Cast Failed, invalid lexical value 2012-1-31）

也许 YYYY-MM-DD 不是 dateTime 的有效格式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T15:10:01.780

最终创建了一个组件来执行此操作。我的特殊问题是“2012-1-31”不能格式化为日期或日期时间，但是 2012-01-31 可以。所以这变得像在尝试转换为日期之前格式化数字和填充字符一样简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T23:32:48.457

此示例使用 EXSLT（因为我无权访问 XSLT 2.0），但您明白了。

```
<xsl:variable name='date_parts' select='str:split(root/date, "/")' />
<xsl:value-of select='concat($date_parts[3],$date_parts[1],$date_parts[2])' /> 
```

你可以在[这个 playgorund 会议上测试它](http://www.xmlplayground.com/4PrLr4)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-17T11:57:23.820

您可以使用库中的 xs:datetime / format-dateTime

# c - 如何使用 C 中的 stat() 在不同的相对目录中查找文件的大小？

> ID：11165100
> 
> 赞同：1
> 
> 时间：2012-06-22T22:46:39.743
> 
> 标签：c, macos

这是我使用 stat() 获取文件大小的函数：

```
off_t fsize(const char *filename) {                                                                                                                   
  struct stat st;                                                                                                                                        

  if (stat(filename, &st) == 0)                                                                                                                          
     return st.st_size;                                                                                                                                 

  fprintf(stderr, "Cannot determine size of %s: %s\n",                                                                                                   
         filename, strerror(errno));                                                                                                                    

  return -1;                                                                                                                                             
} 
```

我可以通过以下方式获得文件大小：

```
size = fsize ("byte.bin"); 
```

但是当我需要从本地目录的较低目录中获取文件时，比如说“deps/src”目录，它会过早地停止在我身上，并且没有我预期的错误消息：

```
size = fsize ("deps/src/byte.bin"); 
```

我编写了一个使用该函数的小程序，将 byte.bin 文件复制到“deps/byte.bin”并使用“deps/byte.bin”调用我的 fsize 函数并得到错误“无法确定 byte.bin 的大小” ： 没有相应的文件和目录”

如果我使用像“/something/deps/byte.bin”这样的绝对路径，它就可以工作。

我做错了什么以及如何显示我为相对路径执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T20:04:43.073

我猜正在发生的事情是您错误地假设了工作目录。测试工作目录在哪里的一种简单方法是编写一个程序，该程序仅输出`test.txt`. 在许多（但不是全部）情况下，工作目录是存储可执行文件的地方。这意味着如果您尝试访问相对路径上的文件，您可能需要`..`在相对路径中至少包含一个文件才能退出该`bin`目录。

# mysql - 在 MySQL 的列中为某些值添加前导零

> ID：11165104
> 
> 赞同：82
> 
> 时间：2012-06-22T22:46:56.273
> 
> 标签：mysql, sql, database

我有一个 CSV 文件以 CSV 格式发送给我。感兴趣的字段是 8 位数字。其中一些以 0 开头。该字段以数字形式发送。所以，我现在已经去掉了一些前导零。

我已经将该字段转换为 varchar。我现在需要这样做：

我现在有这个：

```
12345678
1234567 
```

我需要这个：

```
12345678
01234567 
```

* * *

## 回答 #1

> 赞同：182
> 
> 时间：2012-06-22T22:48:47.727

将字段更改回数字并用于[`ZEROFILL`](http://dev.mysql.com/doc/refman/5.1/en/numeric-type-overview.html)保留零

或者

采用[`LPAD()`](http://dev.mysql.com/doc/refman/5.1/en/string-functions.html#function_lpad)

```
SELECT LPAD('1234567', 8, '0'); 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-06-22T22:49:31.377

可能：

```
select lpad(column, 8, 0) from table; 
```

* * *

**针对mylesg**的问题进行了编辑，在下面的评论中：

> 好的，似乎对查询进行了更改-但是如何使其永久粘贴（更改）在表中？我尝试了 UPDATE 而不是 SELECT

我假设您使用的查询类似于：

```
UPDATE table SET columnName=lpad(nums,8,0); 
```

如果这成功了，但表的值仍然没有前导零，那么我建议您可能将该列设置为数字类型？如果是这种情况，那么您需要更改表，以便该列属于 text/varchar() 类型，以保留前导零：

第一的：

```
ALTER TABLE `table` CHANGE `numberColumn` `numberColumn` CHAR(8); 
```

二、运行更新：

```
UPDATE table SET `numberColumn`=LPAD(`numberColum`, 8, '0'); 
```

那么，这应该保留前导零；不利的一面是该列不再是严格的数字类型；因此您可能必须强制执行更严格的验证（取决于您的用例）以确保非数字不会输入该列。

参考：

*   [`lpad()`](http://dev.mysql.com/doc/refman/5.1/en/string-functions.html#function_lpad).

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-09-25T00:59:44.707

将电话号码数据从 excel 导入 mysql 数据库时，我遇到了类似的问题。所以一个简单的技巧不需要识别电话号码的长度（因为电话号码的长度在我的数据中有所不同）：

```
UPDATE table SET phone_num = concat('0', phone_num) 
```

我只是在`phone_num`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-01-22T02:32:43.843

以前的答案使用`LPAD()`是最佳的。但是，如果您想要进行特殊或高级处理，这里有一种方法可以对填充进行更多的迭代控制。也可以作为使用其他构造来实现相同目标的示例。

```
UPDATE
    mytable
SET
    mycolumn = CONCAT(
        REPEAT(
            "0",
            8 - LENGTH(mycolumn)
        ),
        mycolumn
    )
WHERE
    LENGTH(mycolumn) < 8; 
```

# python - 在 Windows7 64bit 上为 Python 2.7 安装 rpy2

> ID：11165123
> 
> 赞同：11
> 
> 时间：2012-06-22T22:49:10.287
> 
> 标签：python, windows, r, rpy2

我正在尝试构建和安装 rpy2 Python 模块。但出现错误（见下文）。

我已经安装了 R`C:\Program Files\R\R-2.15.0\`并且`R.h`在`C:\Program Files\R\R-2.15.0\include`. 如何告诉 setup.py 在该目录中找到 R 标头？

Python 和 R 都是使用 Windows 64 位的官方二进制文件安装的。

有人可以为 Windows 64 位和 Python2.7 64 位贡献一个 rpy2 二进制构建吗？Christoph Gohlke 说出于法律或技术原因，rpy2 未包含在他的[非官方 Windows 二进制文件中用于 Python 扩展包](http://www.lfd.uci.edu/~gohlke/pythonlibs/)。其他人有成功的打击吗？

谢谢！

给定以下过程：

```
$ python setup.py  build
running build
running build_py
running build_ext

returned an empty string. (5 times) 
```

将此配置用于 R 作为库：

```
include_dirs: ()
libraries: ()
library_dirs: ('C:/PROGRA~1/R/R-215~1.0/bin/i386',)
extra_link_args: ()
 # OSX-specific (included in extra_link_args)
  framework_dirs: ()
  frameworks: () 
```

使用以下命令构建“rpy2.rinterface._rinterface”扩展：

```
C:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\BIN\amd64\cl.exe /c 
/nologo /Ox /MD /W3 /GS- /DNDEBUG -DWin32=1 -DCSTACK_DEFNS=1 
-I.\rpy\rinterface -IC:\Python27\include -IC:\Python27\PC 
/Tc.\rpy\rinterface\_rinterface.c 
/Fobuild\temp.win-amd64-2.7\Release\.\rpy\rinterface\_rinterface.obj
_rinterface.c 
```

给出这个错误：

```
.\rpy\rinterface\_rinterface.c(61) : fatal error C1083: Cannot open include file: 
'R.h': No such file or directory
error: command '"C:\Program Files (x86)\Microsoft Visual Studio 9.0\VC\BIN\amd64\cl.exe"' 
failed with exit status 2 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-12-15T02:05:27.263

这是 rpy2 Windows 二进制文件、所有 Python 版本和 x86/x64 的链接：

[http://www.lfd.uci.edu/~gohlke/pythonlibs/#rpy2](http://www.lfd.uci.edu/~gohlke/pythonlibs/#rpy2)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-04-15T17:13:52.123

我的经验（2.7.9（默认，2014 年 12 月 10 日，12:28:03）[MSC v.1500 64 位（AMD64）]）：-所有二进制安装程序-显然 rpy2 具有未指定的依赖项-安装了 numpy 和 scipy（win_amd64二进制文件）及其未指定的依赖项

1.  安装 R，安装所需的软件包
2.  安装pywin32
3.  “点安装单调度”
4.  “点安装 rpy2-2.5.6-cp27-none-win_amd64.whl”
5.  更新环境，例如 os.environ['R_HOME'] = r'C:\Program Files\R\R-3.1.3' os.environ['R_USER'] = r'C:\Python27\Lib\site-packages \rpy2'

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-28T11:56:17.970

我自己也在做同样的事情。位于的库等表明您正在选择 32 位版本 i386。添加“C:\Program Files\R\R-2.15.1\include”包含目录可能​​有助于强制解决问题。这是我得到的最远的：

```
building 'rpy2.rinterface._rinterface' extension
error: Unable to find vcvarsall.bat 
```

在路径中使用 MSVC express shell 和 R x64 和 msys sh。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-01-01T16:41:59.443

我在我的 Windows 10 上尝试了所有这些，但一无所获。当我执行时`pip`，它说它已安装到我已经使用了几个月的 Anaconda 版本中，但是当我尝试执行时`import rpy`，它只是给出了一个错误。

打算放弃，但后来我睡了一晚，然后我从命令行执行了以下操作：

*   删除了我所有的旧 Python 实例，包括 Anaconda
*   重新启动
*   重新安装 Anaconda（2.4.1 和 Python 版本 2.7.11）
*   确保 python 从任何目录的命令行运行
*   启动了我的“mingw32”bash shell（附带的那个`git`）
*   将我的个人`R_HOME`环境变量设置为`C:\Program Files\R\R-3.2.3`
*   如上所述`rpy2-2.7.5-cp27-none-win_amd64.whl`从[http://www.lfd.uci.edu/~gohlke/pythonlibs/#rpy2](http://www.lfd.uci.edu/~gohlke/pythonlibs/#rpy2)下载。
*   将工作目录更改为我的用户`Downloads`目录
*   安装它`pip install rpy2-2.7.5-cp27-none-win_amd64.whl`
*   启动python并成功导入和rn py2

这是最后步骤的屏幕截图：

```
mwise@MWISE-OPTO ~/Downloads
$ pip install rpy2-2.7.5-cp27-none-win_amd64.whl
Processing c:\users\mwise\downloads\rpy2-2.7.5-cp27-none-win_amd64.whl
Requirement already satisfied (use --upgrade to upgrade): six in c:\users\mwise\appdata\local\continuum\anaconda2\lib\site-packages (from rpy2==2.7.5)
Requirement already satisfied (use --upgrade to upgrade): singledispatch in c:\users\mwise\appdata\local\continuum\anaconda2\lib\site-packages (from rpy2==2.7.5
)
Installing collected packages: rpy2
Successfully installed rpy2-2.7.5

mwise@MWISE-OPTO ~/Downloads
$ python
Python 2.7.11 |Anaconda 2.4.1 (64-bit)| (default, Dec  7 2015, 14:10:42) [MSC v.1500 64 bit (AMD64)] on win32
Type "help", "copyright", "credits" or "license" for more information.
Anaconda is brought to you by Continuum Analytics.
Please check out: http://continuum.io/thanks and https://anaconda.org
>>> import rpy2
>>> import rpy2.robjects as robjects
>>> pi = robjects.r['pi']
>>> pi[0]
3.141592653589793
>>> 
```

希望这会帮助某人下线...

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-03-26T05:46:38.480

这是因为您的 R 包含库不在您的 CPPFLAGS 环境变量中。您应该在“C:\Program Files\R\R-2.15.0\include”中找到文件 Rh。在 linux 中，您可以将其添加到您的 .bashrc

```
export "$CPPFLAGS=-I/path-to-R/include $CPPFLAGS" 
```

但我对 windows 中的 python 和 R 不熟悉。这就是我所能提供的帮助。

# c# - Umbraco - 从多个下拉列表数据类型中获取预值并使用 Razor 创建无序列表

> ID：11165126
> 
> 赞同：3
> 
> 时间：2012-06-22T22:49:24.493
> 
> 标签：c#, razor, umbraco

我只是找不到如何为 Umbraco 创建无序列表。

我能够获得预值，但我无法将它们作为前端列表输出。

到目前为止，我的代码是：

```
 var myValues = umbraco.library.GetPreValues(12080);
  <ul>
   @foreach(var c in myValues){
      <li><a href="@baseNode.Url?category=@c">@c</a></li>                      
     }

 </ul> 
```

我正在恢复价值观

*   项目，但它们没有分开。我尝试将 .Split() 添加到 foreach 中的 myValues 并给我一个错误。我错过了什么吗？

    提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-23T02:27:42.667

那是因为`umbraco.library.GetPrevalues(int id)`返回一个`XPathNodeIterator`如此简单地遍历值是不够的。在 Umbraco Wiki 中，您可以找到一个[很好的示例](http://our.umbraco.org/wiki/reference/umbracolibrary/getprevalues)，说明如何使用`XPathNodeIterator`. 我重写了它以适应 Razor 上下文：

```
@using System.Xml.XPath
@using umbraco.MacroEngines
@inherits DynamicNodeContext
@try
{
    var baseNode = Model.AncestorOrSelf();

    XPathNodeIterator iterator = umbraco.library.GetPreValues(1094);
    iterator.MoveNext(); //move to first
    XPathNodeIterator preValues = iterator.Current.SelectChildren("preValue", "");

    @preValues.Count

    <ul>
    @while (preValues.MoveNext())
    {
        string preValue = preValues.Current.Value;

        <li><a href="@baseNode.Url?category=@preValue">@preValue</a></li>                      
    }
    </ul>
}
catch (Exception e)
{
    @e.ToString()   
} 
```

# python - 重用子进程对象

> ID：11165129
> 
> 赞同：1
> 
> 时间：2012-06-22T22:49:59.847
> 
> 标签：python, shell, subprocess

我有一个 Python 脚本，它需要发出许多 shell 命令。我以为我可以只创建一个子进程对象，然后在每次有要执行的命令时重用它。

这就是我设置代码的方式：

```
def setupPipeline(self):
    setupShell = subprocess.Popen([''], stdout=subprocess.PIPE, shell=True, stderr=subprocess.PIPE, stdin=subprocess.PIPE)

    # Stop running pipeline
    setupShell.stdin.write('stop ' + self.Name)
    output = setupShell.stdout.read()
    print output

    # Cancel any running jobs and cleanup variables
    setupShell.stdin.write('sudo -u pr cancel ALL')
    output = setupShell.stdout.read()
    print output

    setupShell.stdin.write('sudo -u pr clean ALL')
    output = setupShell.stdout.read()
    print output 
```

（这里跳过很多其他代码）

```
if __name__ == '__main__':
#self-test code
pipelineObj = Pipeline(sys.argv)
pipelineObj.setupPipeline() 
```

但是，当代码到达第二个命令时，我得到一个

```
IOError: [Errno 32] Broken pipe 
```

如何重用子进程对象来发出需要在同一个 shell 中执行的命令？这些命令不能简单地链接在一起，因为在每个调用之间都有处理。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-22T22:54:48.267

创建一个执行 shell 的子进程，并向其发送命令。您正在 shell 中运行一个空命令*，*这会导致它执行该空命令然后退出。

```
shell = subprocess.Popen("/bin/bash -i".split(), stdin=subprocess.PIPE,
                         stdout=subprocess.PIPE, stderr=subprocess.PIPE) 
```

您可能会考虑使用[`pexpect`](https://github.com/pexpect/pexpect)它，因为听起来您正在重新发明它。

# iphone - 当视图处于横向模式时，工具栏上的信息灯消失

> ID：11165130
> 
> 赞同：0
> 
> 时间：2012-06-22T22:50:17.223
> 
> 标签：iphone, objective-c, ios

我有一个带有工具栏的导航栏控制器。左下角的工具栏上只有一个按钮：信息灯。当我将视图旋转为横向时，工具栏仍然存在，但按钮消失了。

我如何让它留下来。我在 IB 中检查了我的 struts 工具栏。它们被设置在工具栏的左下角。

我正在使用 4.0 的基本 SDK 在 iPod touch 上进行测试。

这是代码：

```
UIButton *info = [UIButton buttonWithType:UIButtonTypeInfoLight];
[info addTarget:self 
             action:@selector(infoTap:) 
   forControlEvents:UIControlEventTouchUpInside];
/** Allocate and initialize the information button on the leftside of the toolbar.
 */
UIBarButtonItem *infoItem = [[UIBarButtonItem alloc] initWithCustomView:info];
/** Use this to put space in before your info toolbar button.
   */
UIBarButtonItem *flexItem = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace target:nil action:nil];
/** Add buttons to the array.
   */
NSMutableArray *items = [NSMutableArray arrayWithObjects: infoItem, flexItem, nil];
/** Add array of buttons to toolbar.
   */
[self.toolbar setItems:items animated:NO];
/** Add the toolbar as a subview to the navigation controller.
   */
[self.navigationController.view addSubview:toolbar]; 
```

有什么建议么？

阿曼达

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T01:17:19.513

您发布的代码对于您想要做的事情是正确的，因此问题在于支持代码。

我会检查几件事：封闭视图（self.navigationController.view）是否在旋转时调整大小？

self.navigationController.view 上的 struts 和 autoresizingmasks 是什么？

UIToolbar 上的 struts 和 autoresizingmasks 是什么？

（我不确定您的意思是：“我在 IB 中检查了我的 struts 工具栏。它们被设置为留在工具栏的左下角。”工具栏如何留在工具栏的左下角？ ）。

# c++ - 数组分段错误

> ID：11165133
> 
> 赞同：-1
> 
> 时间：2012-06-22T22:50:28.347
> 
> 标签：c++, arrays, segmentation-fault

我正在编写一个相当简单的代码，将存储在文件中的整数输入到一个中等大小的数组中，但是在编译和运行代码时，它给出了 Segmentation fault 错误，任何人都可以纠正我在哪里犯错，代码是

```
#include <iostream>
#include <fstream>
#include <string>
#include <cstdlib>

using namespace std;

int main()
{
    int arr[100000];
    ifstream f;
    f.open("IntegerArray.txt");
    string line;

    if (f.is_open())
    {
        int i=0;
        while (f.good())
        {
            getline(f,line);
            arr[i++] = atoi(line.c_str());
        }
        f.close();
    }
    else
        cout<<"file not open";
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-03-05T21:28:34.380

使用 对文件中的一行进行 rading 后`getline()`，应检查流中是否存在潜在错误，例如使用`.fail()`，其中：

> 如果为流设置了 failbit 或 badbit 错误状态标志中的一个（或两者），则返回 true。

```
while (f.good())
{
    getline(f,line);

    if (f.fail()) {
        cout << "Corrupt data" << endl; // example output
        break;
    }

    // everything ok, continue with logic
    arr[i++] = atoi(line.c_str());
} 
```

# ios - ios 子类化替代方案

> ID：11165135
> 
> 赞同：1
> 
> 时间：2012-06-22T22:50:45.400
> 
> 标签：ios, uiview, methods, instance, subclass

如果我希望我的 UIView 在 layoutSubviews 上执行自定义逻辑，是通过创建自己的 UIView 子类并实现该方法来实现此目的的唯一方法吗？我想我记得某处的示例中关于能够仅为类的特定实例实现方法的内容，但我不记得语法是什么，或者这是否是一回事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T22:56:08.643

如果您想为该视图执行某些操作，那么最好将其设置为子类并覆盖该视图。

如果您希望它发生在所有视图上，那么您将需要方法 swizzle 将 layoutSubviews 更改为您指定的另一个方法，并将该类别包含在 _prefix.pch 文件中

**Method Swizzling 不能掉以轻心，但你可以**[在这里](https://stackoverflow.com/questions/7720947/method-swizzling-in-ios-5/10825961#10825961)查看我的解释

我推荐第一个选项。子类化和覆盖。只记得调用[super layoutSubviews]方法完成链。（除非意图阻止该链）

# ios - 使用 NSRegularExpression 从 NSString 中提取值

> ID：11165139
> 
> 赞同：1
> 
> 时间：2012-06-22T22:51:31.800
> 
> 标签：ios, regex, nsregularexpression

我有以下 NSString：

```
var param1=8;
var param2=4;
var param3=1; 
```

我需要从中提取参数的值。我使用 NSRegularExpression 但不能让它工作：

```
NSRegularExpression *regex = [NSRegularExpression regularExpressionWithPattern:@"var param1=(.*);\nvar param2=(.*);\nvar param3=(.*)" options:0 error:NULL];
NSTextCheckingResult *match = [regex firstMatchInString:string options:0 range:NSMakeRange(0, [string length])];
NSString *param1= [match rangeAtIndex:1]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T00:33:01.890

虽然标题对答案不公平，但问题[NSRegularExpression validate email](https://stackoverflow.com/questions/8198303/nsregularexpression-validate-email)提供了一个有用的在线[正则表达式检查器](http://gskinner.com/RegExr/)的链接。

我的感觉是，您的示例中的正则表达式中的 \n 字符有问题。

我会考虑一个表达式，例如`@"^var param[123]=\b(\w*)\b;"`，它应该为您提供三个匹配项；您必须使用`NSRegularExpression`method`matchesInString`而不是`firstMatchInString`，但您的循环应该非常简单：

```
 NSArray* matches = [regex matchesInString:string
                                      options:0
                                        range:NSMakeRange(0, [string length])];
    for (NSTextCheckingResult *match in matches) {
        // per match processing
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T07:41:50.453

首先，您将 NSRange 转换为 NSString，最后一行应如下所示：

```
NSString *param1= [string substringWithRange:[match rangeAtIndex:1]]; 
```

其次，也许你的字符串有问题？它可能在换行符之前有空格，等等。我测试过：

```
NSString *string = @"var param1=8;\n"
                    "var param2=4;\n"
                    "var param3=1;"; 
```

它工作正常，返回“8”。

# java - 在java中运行系统进程，这样它就不会冻结程序

> ID：11165141
> 
> 赞同：0
> 
> 时间：2012-06-22T22:51:37.960
> 
> 标签：java, process

请告诉我应该如何在 java 中正确执行系统进程。我想在java中做控制台的kinfd。我做了看起来像那样的东西。

![在此处输入图像描述](../Images/7d9d40792411d3a468dedc61016c8460.png)

我应该如何正确调用 JTextField 中的流程？ ***我知道如何使用侦听器等。我只是询问如何正确运行该过程。*** 谢谢 :) 但我想确保整个布局不会冻结。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T22:54:46.773

使用 SwingWorker 并将操作置于后台。使用后台线程中的内容执行 Runtime.exec()。

[http://docs.oracle.com/javase/6/docs/api/javax/swing/SwingWorker.html](http://docs.oracle.com/javase/6/docs/api/javax/swing/SwingWorker.html)

# php - 肥皂错误致命错误：未捕获的SoapFault异常：[HTTP]无法连接到主机

> ID：11165142
> 
> 赞同：3
> 
> 时间：2012-06-22T22:51:50.643
> 
> 标签：php, web-services, soap

使用 PHP 发送 SOAP 请求时遇到此错误`SoapClient`：

```
Fatal error: Uncaught SoapFault exception: [HTTP] Could not connect to host in /var/www/phpwebservice/soap-client.php:6
Stack trace:
#0 [internal function]: SoapClient->__doRequest('__call('getCatalogEntry', Array)
#2 /var/www/phpwebservice/soap-client.php(6): SoapClient->getCatalogEntry('catalog1')
#3 {main} thrown in /var/www/phpwebservice/soap-client.php on line 6 
```

直接在`/var/www/`含义下移动文件时脚本工作正常：

```
http://localhost/soap-client.php 
```

`phpwebservice`但是当我将它移动到一个名为该错误的子文件夹时。子文件夹是这样的没关系：

```
http://localhost/phpwebservice/soap-client.php 
```

或者如果我为它制作了一个 VirtualHost：

```
http://phpwebservice/soap-client.php 
```

的内容`soap-client.php`：

```
 $client     = new SoapClient("catalog.wsdl");
    $catalogId      = 'catalog1';
    $response       = $client->getCatalogEntry($catalogId);
    echo $response; 
```

肥皂-server.php：

```
 function getCatalogEntry($catalogId){
    if($catalogId == 'catalog1')
            return  "<html>
                <head>
                    <title>catalog</title>
                </head
                <body>
                <p> </p>
                    <table border=1>
                    <tr>
                        <th>catalogid</th>
                        <th>journal</th>
                        <th>section</th>
                        <th>edition</th>
                        <th>title</th>
                        <th>author</th>
                    </tr>
                    <tr>
                        <td>catalog1</td>
                        <td>ibm developerworks</td>
                        <td>xml</td>
                        <td>october 2005</td>
                        <td>jaxp validation</td>
                        <td>brett mclaughlin</td>
                    </tr>
                    </table>
                </body>
            </html>";
elseif($catalogId == 'catalog2')
    return  "<html>
                <head>
                    <title>catalog</title>
                </head>
                <body>
                    <p> </p>
                    <table border=1>
                        <tr>
                            <th>catalogid</th>
                            <th>journal</th>
                            <th>section</th>
                            <th>edition</th>
                            <th>title</th>
                            <th>author</th>
                        </tr>
                        <tr>
                            <td>catalog1</td>
                            <td>ibm developerworks</td>
                            <td>xml</td>
                            <td>july 2006</td>
                            <td>the java xpath api</td>
                            <td>elliotte harold</td>
                        </tr>
                    </table>
                </body>
            </html>";
    }
    ini_set("soap.wsdl_cache_enabled", "0");
    $server = new soapserver("catalog.wsdl");
    $server->addfunction("getCatalogEntry");
    $server->handle(); 
```

目录.wsdl：

```
 <?xml version ='1.0' encoding ='UTF-8' ?>
   <definitions name='Catalog'
   targetnamespace='http://phpwebservice/catalog'
   xmlns:tns='http://phpwebservice/catalog'
   xmlns:soap='http://schemas.xmlsoap.org/wsdl/soap/'
   xmlns:xsd='http://www.w3.org/2001/XMLSchema'
   xmlns:soapenc='http://schemas.xmlsoap.org/soap/encoding/'
   xmlns:wsdl='http://schemas.xmlsoap.org/wsdl/'
   xmlns='http://schemas.xmlsoap.org/wsdl/'>
   <message name='getCatalogRequest'>
    <part name='catalogId' type='xsd:string'/>
   </message>
   <message name='getCatalogResponse'>
    <part name='Result' type='xsd:string'/>
   </message>
   <portType name='CatalogPortType'>
    <operation name='getCatalogEntry'>
                <input message='tns:getCatalogRequest'/>
        <output message='tns:getCatalogResponse'/>
    </operation>
   </portType>
   <binding name='CatalogBinding' type='tns:CatalogPortType'>
    <soap:binding style='rpc' transport='http://schemas.xmlsoap.org/soap/http'/>
    <operation name='getCatalogEntry'>
    <soap:operation soapAction='urn:phpwebservice-catalog#getCatalogEntry'/>
        <input>
            <soap:body use='encoded' namespace='urn:phpwebservice-catalog' encodingStyle='http://schemas.xmlsoap.org/soap/encoding/'/>
        </input>
        <output>
                    <soap:body use='encoded' namespace='urn:phpwebservice-catalog' encodingStyle='http://schemas.xmlsoap.org/soap/encoding/'/>
        </output>
    </operation>
   </binding>
   <service name='CatalogService'>
    <port name='CatalogPort' binding='CatalogBinding'>
        <soap:address location='http://phpwebservice/soap-server.php'/>
   </port>
   </service>
   </definitions> 
```

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T06:53:19.687

如果你在开发环境中，最好设置`soap.wsdl_cache_enabled=0`在`php.ini`. 否则，您必须在对 WSDL 文件（通常位于定义的目录中`soap.wsdl_cache_dir`）进行任何更改后手动删除 WSDL 缓存

您还可以参考：[SoapFault 异常：无法连接到主机](https://stackoverflow.com/questions/4318870/soapfault-exception-could-not-connect-to-host)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-01T14:52:39.380

当我的选项中未指定[connection_timeout](http://php.net/manual/en/soapclient.soapclient.php)时，我遇到了特定 SOAP 服务的此问题。`SoapClient`将超时设置为 1 为我解决了这个问题。

```
$wsdl = 'https://...';
$options [
  'trace' => true,
  'exceptions' => true,
  'connection_timeout' => 1
];
$client = new SoapClient($wsdl, $options); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-25T19:42:55.740

没关系，我只是从 wsdl 文件中的每一行中删除 /catalog ，现在一切正常，thanx 无论如何。

# wpf - ListBox MVVM 中的 ClearSelection

> ID：11165143
> 
> 赞同：3
> 
> 时间：2012-06-22T22:52:09.240
> 
> 标签：wpf, silverlight, mvvm, listbox

在 MVVM Silverlight 应用程序中，用户可以在 TextBox 中输入文本，ListBox 的内容也会相应地发生变化。例如：如果用户输入“TV”，ListBox 将填充所有可用的电视品牌，用户可以从 ListBox 和 ListBox 条目中选择产品；接下来，如果他输入“计算机”，ListBox 内容会更改并使用 ComputerNames 填充。

一旦用户键入内容，它就会在字典中搜索匹配键的值。

**看法：**

```
<TextBox Name="SearchTBox" Text="{Binding SearchStr,UpdateSourceTrigger=PropertyChanged}" />
<ListBox Name="AnalysisLBox" ItemsSource="{Binding DataList,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"   
         SelectedItem="{Binding UserSelectedItem,Mode=TwoWay}"                                   
         Width="250" BorderBrush="Transparent" SelectedIndex="{Binding LBoxSelectedIndex,Mode=TwoWay}">
    <ListBox.ItemTemplate>
        <DataTemplate>
            <StackPanel>
                <TextBlock Text="{Binding}" />
            </StackPanel>
        </DataTemplate>
    </ListBox.ItemTemplate>
</ListBox> 
```

**视图模型：**

```
SortedDictionary Data()
{
    List<string> tvList = new List<string>() { "Sony", "SamSung", "LG","Sharp" };
    List<string> computerList = new List<string>() { "HP","Dell","Lenovo","Gateway" };
    List<string> cameraList = new List<string>() { "Nikon","Sony","Panasonic" };
    SortedDictionary<string, List<string>> Data = new SortedDictionary<string, List<string>>();
    Data.Add("TV", billingList);
    Data.Add("Computer", salesOutList);
    Data.Add("Camera", customerAllocationList);
}

ObservableCollection<string> dataList = new ObservableCollection<string>();
public ObservableCollection<string> DataList
{
    get { return dataList ; }
    set { dataList = value; NotifyPropertyChanged("DataList"); }
}

int lBoxSelectedIndex;
public int LBoxSelectedIndex
{
    get { return lBoxSelectedIndex; }
    set { lBoxSelectedIndex = value; NotifyPropertyChanged("LBoxSelectedIndex"); }
}

string userSelectedItem;
public string UserSelectedItem
{
    get { return userSelectedItem; }
    set
    {
        userSelectedItem = value;
    dataList.Clear(); 
        LBoxSelectedIndex =-1;
        NotifyPropertyChanged("UserSelectedItem");
    }
 } 
```

一旦键与用户键入的字符串（'TV'）`ObservableCollection<string>`匹配，它就会使用绑定到 ListBox 的 tvList 填充 dataList。用户键入 Camera，它会清除 dataList 并添加 cameraList。问题出现在这里。清除数据并填充新数据时，不会清除列表框的选择。先前选择的位置的相同项目保持选中状态。我试图从 ViewModel 的 UserSelectedItem 属性中将 SelectedIndex 设置为 -1，但它不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T18:56:54.017

你也可以设置 `userSelectedItem=null`在

```
ObservableCollection<string> dataList = new ObservableCollection<string>();
public ObservableCollection<string> DataList
{
    get { return dataList ; }
    set 
    { 
        dataList = value;
        userSelectedItem=null
        LBoxSelectedIndex = -1;
        NotifyPropertyChanged("DataList"); 
    }
 } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T23:40:43.927

I think you may have your properties confused. When a selection is made in the ListBox, the `UserSelectedItem` setter is triggered and clears the `dataList` and sets the `LBoxSelectedIndex` to -1\. So really what happens when a user selects an item from the ListBox is the ListBox is cleared and nothing is selected.

Instead, it seems you should be clearing the selection when the `DataList` is changed.

```
string userSelectedItem;
public string UserSelectedItem
{
    get { return userSelectedItem; }
    set
    {
        userSelectedItem = value;
        NotifyPropertyChanged("UserSelectedItem");
    }
}

ObservableCollection<string> dataList = new ObservableCollection<string>();
public ObservableCollection<string> DataList
{
    get { return dataList ; }
    set 
    { 
        dataList = value;
        LBoxSelectedIndex = -1;
        NotifyPropertyChanged("DataList"); 
    }
 } 
```

You'll also need to clear the `DataList` when `SearchStr` is updated and it does not equal any of the keys in the the sorted dictionary.

```
string searchStr;
public string SearchStr
{
    get { return searchStr; }
    set
    {
        searchStr = value;
        LBoxSelectedIndex = -1;
        if (string.IsNullOrEmpty(searchStr))
            DataList = null;
        else
        {
            List<string> selectedValue;
            if (Data.TryGetValue(searchStr, out selectedValue))
                DataList = new ObservableCollection<string>(selectedValue);
            else
                DataList = null;
        }
        NotifyPropertyChanged("SearchStr");
    }
} 
```

# asp.net - SignalR：单个集线器调用在一台服务器上因套接字错误而崩溃

> ID：11165144
> 
> 赞同：1
> 
> 时间：2012-06-22T22:52:14.030
> 
> 标签：asp.net, signalr

发生了非常奇怪的事情。我有一个集线器部署到几个开发盒和一个 QA 盒。所有都在 Windows 2008 R2 和 IIS 上运行。一切都在开发机器上运行。QA 框（如果重要，托管在亚马逊 EC2 中）在单个集线器调用中失败，并在浏览器控制台中引发以下错误。

我们所有的开发框都可以从同一个调用中正常返回。

```
SignalR: A connection attempt failed because the connected party did not properly 
respond after a period of time, or established connection failed because 
connected host has failed to respond

   at System.Net.Sockets.Socket.Receive(Byte[] buffer, Int32 offset, Int32 size, SocketFlags socketFlags)
   at System.Net.Sockets.NetworkStream.Read(Byte[] buffer, Int32 offset, Int32 size) jquery.signalR.min.js:1

Uncaught TypeError: Cannot read property 'Groups' of undefined jquery.signalR.min.js:1
u.processMessages jquery.signalR.min.js:1
f.transports.serverSentEvents.start jquery.signalR.min.js:1 
```

我已经尝试更新到 SignalR 0.5.1（在 0.5.0 上），将 DLL 直接从 dev 复制到 QA 以确保相同的代码，禁用防火墙以防 EC2 做一些奇怪的事情（通过 127.0.0.1 出现同样的错误，所以这就是不是它）..我迷路了..我错过了什么设置？

# oracle - 带有 XMLType 的 CriteriaBuilder where 子句

> ID：11165146
> 
> 赞同：0
> 
> 时间：2012-06-22T22:52:44.247
> 
> 标签：oracle, jpa, oracle11g, jpa-2.0, eclipselink

我有一个带有 XML 的数据库列。我正在使用`JPA`（eclipselink）来访问它。数据库是oracle，所以我使用`oracle.xdb.XMLType and a @Customizer`注释。这一切都很好。

现在我需要使用`CriteriaBuilder`where 子句中的 XML 列创建查询。

基本上我需要重新创建它`CriteriaBuilder`（我确实有 CriteriaBuilder 为非 XML 列工作）：

```
SELECT id, somecolumn, xmlcol FROM sometable WHERE EXTRACTVALUE(xmlcol,'//path/path')='somevalue'; 
```

知道怎么做吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T14:14:04.137

您应该能够使用 JPA CriteriaBuilder function() API 来调用此函数。

如果您需要做一些更高级的事情，您可以使用 EclipseLink 表达式查询，或混合表达式和标准，

[http://wiki.eclipse.org/EclipseLink/UserGuide/JPA/Basic_JPA_Development/Querying/Criteria#JpaCriteriaBuilder_and_EclipseLink_Extensions](http://wiki.eclipse.org/EclipseLink/UserGuide/JPA/Basic_JPA_Development/Querying/Criteria#JpaCriteriaBuilder_and_EclipseLink_Extensions)

# c# - 在等待事件时防止我的程序结束的正确方法是什么

> ID：11165151
> 
> 赞同：3
> 
> 时间：2012-06-22T22:53:10.957
> 
> 标签：c#, multithreading, events

我有一个设置一些事件的应用程序，需要等待这些事件发生后再退出。最好的方法是什么？我知道 Thread.Sleep 是一个糟糕的选择，原因有很多，包括它甚至无法在睡眠时处理事件。我显然不会用一个什么都不做的while循环来浪费cpu周期。那么，防止控制台应用程序在不确定的时间内退出以便它可以在引发事件时处理事件的最简单方法是什么？

最终，这将成为一项服务，这将使这成为一个非问题，但现在在我的第一次迭代中，我只是在控制台应用程序中测试我的一些代码，然后再将其变成真正的服务（之前没有做过服务，所以我想确保我的代码是可靠的，以免使下一步复杂化）。在我写这篇文章时，我刚刚意识到我可以在 WinForms 应用程序中对其进行测试，这样就可以解决我的问题，呵呵。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T23:07:40.973

一个不错的选择是使用[ManualResetEvent](http://msdn.microsoft.com/en-us/library/system.threading.manualresetevent.aspx)。这使您可以在等待设置事件时进行阻塞，而无需休眠。您的控制台应用程序的主例程可以调用`WaitOne()`，`ManualResetEvent`这将阻塞。当您的例程完成后，只需调用`ManualResetEvent.Set()`以允许控制台应用程序关闭。

如果您需要等待一系列事件，[CountdownEvent](http://msdn.microsoft.com/en-us/library/system.threading.countdownevent)是另一种选择。您可以根据需要调用`AddCount()`和`Signal`来增加和减少计数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-25T19:10:01.940

我在[此](http://einaregilsson.com/run-windows-service-as-a-console-program/)基础上编写了可以作为控制台应用程序运行和调试的服务。

“让它更复杂”的方法对我也不起作用。

# python - 为什么这个“[::-1]”在 Python 中返回一个反向列表？

> ID：11165153
> 
> 赞同：14
> 
> 时间：2012-06-22T22:53:16.040
> 
> 标签：python, list, reverse

> **可能重复：**
> [Python Slice Notation 的良好入门在 Python](https://stackoverflow.com/questions/509211/good-primer-for-python-slice-notation)
> [中反转字符串](https://stackoverflow.com/questions/766141/reverse-a-string-in-python)

我最近在一些代码片段中看到了这种语法，我很好奇它的作用。如果我有`my_list = [1,2,3,4,5]`，并且我执行`my_list[::-1]`，我会得到一个包含反转元素的列表`[5,4,3,2,1]`。有人可以向我解释这实际上是做什么的，并说明`[:]`符号和之间的区别`[::]`吗？或者至少让我参考一个资源。

我敢肯定，如果我有一本好的 Python 书，它会在那里，但我没有。`[::]`由于被忽略，因此不可能在 Google 上搜索类似的内容。谢谢！

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-06-22T22:57:11.843

`[:]`和之间没有区别`[::]`。

但`[::-1]`做其他事情：它有一个负步长参数。缺少 start 和 stop 参数意味着完整的数组。负步长参数意味着以相反的顺序获取数据，从结束到开始。

# ms-access-2010 - Access 2010：如何处理数据表和表单中的复合主键

> ID：11165156
> 
> 赞同：1
> 
> 时间：2012-06-22T22:53:33.543
> 
> 标签：ms-access-2010, compound-key

我正在尝试设计一个数据库以简化我的评分过程。我想将作业添加到数据库中，为每个作业添加问题，并将问题加权为整体的百分比。学生通常会犯同样的错误，因此我还希望能够跟踪每个问题扣减学分的原因和扣减的金额，这样我就可以简单地将学生的作业提交与他们所犯的错误联系起来。目标是能够通过单个查询对学生进行同等评分，如果学生没有提交，则给他们一个零分，如果他们提交，则给所有扣除的分数。

我设计了如下图所示的表结构：

![描述数据库的当前关系结构](../Images/22257b0efea6bfee9d076548980ed6ac.png)

我可以使用的工具是 Access 2010（上面的关系图就是用它制作的）。我试图超越描述表格来构建表格来帮助我填充它们。问题是，作为初学者，我无法弄清楚如何让 Access 使用复合主键。我无法弄清楚如何让任何形式的表单链接到多个字段，或者如何让多个输入相互链接，这样我就可以为组合框设置体面的下拉列表，甚至如何获取数据表表的视图使用组合框使这些外键起作用。

此时，我只能看到两个选项：使用复合主键更改这些表以使主键具有不同的字段，并在当前主键上设置复合唯一约束（我不知道如何在 Access 2010 中执行此操作），或者放弃整个想法，转回费力地尝试 Excel 中的所有内容。

有没有人对我怎么做有任何想法：

*   轻松更改表格结构以使表格干净、轻松地进行数据输入和操作？
*   让表单和数据表与当前的复合键范例一起使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T23:23:08.817

这是我建议的图像，主键内容被复制到新键。然后可以删除主键。

![在此处输入图像描述](../Images/ed651ae81fce941403dc1d6d2a140393.png)

# javascript - 移动浏览器上的日期格式

> ID：11165157
> 
> 赞同：0
> 
> 时间：2012-06-22T22:53:38.660
> 
> 标签：javascript, mobile, jquery-mobile

```
std = new Date("2012-06-22 00:05:00");
std_string = std.getHours() + ":" + std.getMinutes(); 
```

在移动浏览器（Android、Blackberry 7）上显示：“Nan:Nan”，为什么？

我怎么能解决这个问题？

**“2012-06-22 00:05:00”**来自 http WebService，是 MYSQL 日期时间格式

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T23:06:21.117

您是否尝试像这样创建对象：

```
var dateWS = "2012-06-22 00:05:00";
var date = dateWS.split(" ")[0].split("-");
var time = dateWS.split(" ")[1].split(":");

var dateObj = new Date(date[0],date[1],date[2],time[0],time[1],time[2]);
var std_string = dateObj .getHours() + ":" + dateObj .getMinutes();
alert(std_string); 
```

我 Jsfiddled 它所以你可以直接在你的浏览器上尝试：http: [//jsfiddle.net/PyGgb/](http://jsfiddle.net/PyGgb/)

编辑：我在我的 Android 2.3 上进行了测试，它正在工作：

![在此处输入图像描述](../Images/ccd1c506835fb78d1da2b7597dc1efb9.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T01:26:51.877

我认为问题是 '-' 。您可以使用 '/' 而不是 '-' ..

将您的“2012-06-22 00:05:00”“-”替换为“/”。

```
 var temp = "2012-06-22 00:05:00".replace('-','/');
   var std = new Date(temp);
   var std_string = std.getHours() + ":" + std.getMinutes();
   alert(std_string); 
```

# javascript - 向导航栏添加按钮并以编程方式显示它们

> ID：11165158
> 
> 赞同：0
> 
> 时间：2012-06-22T22:53:41.470
> 
> 标签：javascript, jquery, jquery-mobile, jquery-selectors, navbar

这是我的页面代码，我需要将我目前拥有的菜单项添加到“page1_nav”，但要么不起作用，要么不显示。

```
<div data-role="page"  id="page1" >
<div id="main" data-role="header" id="page1_header">
    <h1></h1>
    <div data-role="navbar" id='page1_nav'>
    </div>
</div>
<div data-role="content">   
</div>
</div>

$('#page1').live('pageshow',function(event, ui){
var navbar =''; 
navbar+='<ul><li><a href="#"  onclick="goBack()" data-back="true" class="ui-btn-inactive ui-state-persist">Menu1</a></li>';
navbar+='<li><a href="#"  class="ui-btn-active ui-state-persist">Menu2</a></li></ul>';
 $('#page1_nav').append($(navbar));
 $('#page1_nav').page();
}); 
```

任何建议，提前谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T23:30:37.267

你的 jQuery 用脚本标签包装了吗？如果您的脚本不在脚本标签内，您的脚本将不会运行。

```
<script type="text/javascript">

//Your code here

</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T00:47:33.150

你有一些 HTML 错误（双 id 属性），我也会使用 pagebeforeshow 然后增强 jQM 标记

这行得通吗？

*   [http://jsfiddle.net/Mg7rc/](http://jsfiddle.net/Mg7rc/)

HTML

```
<div data-role="page" id="home" data-add-back-btn="true">
    <div id="main" data-role="header" data-position="inline">
        <h1>Home</h1>
        <a href="#" data-icon="check">Save</a>
    </div>
    <div data-role="content">
        <ul data-role="listview" data-inset="true" data-theme="c" data-dividertheme="f">
            <li data-role="list-divider">List View Navigation</li>
            <li><a href="#page1">Go to Page1</a></li>
        </ul>        
    </div>
</div>

<div data-role="page" id="page1" data-add-back-btn="true">
    <div id="myCustomNavbar" data-role="header" data-position="inline" data-add-back-btn="true">
        <!-- dynamic navbar -->
    </div>
    <div data-role="content">
        <p>
            Hello Page 1
        </p>            
    </div>
</div>

<div data-role="page" id="page2" data-add-back-btn="true">
    <div data-role="header" data-position="inline">
        <h1>Page 2</h1>
    </div>
    <div data-role="content">
        <ul data-role="listview" data-inset="true" data-theme="c" data-dividertheme="f">
            <li data-role="list-divider">List View Navigation</li>
            <li><a href="#home">Go to Home Page</a></li>
        </ul>        
    </div>
</div> 
```

JS

```
$('#page1').live('pagebeforeshow', function(event, ui) {
    var myNav  = $('#myCustomNavbar');
    var navbar = '<div data-role="navbar">'
        + '<ul>'
        + '<li><a href="#" data-rel="back" data-direction="reverse">Back</a></li>'
        + '<li><a href="#page2">Page 2</a></li>'
        + '</ul>'
        + '</div>';

    myNav.html(navbar).trigger( 'create' );         
});
​ 
```

# javascript - 为每个列表项添加延迟的 CSS 动画

> ID：11165160
> 
> 赞同：5
> 
> 时间：2012-06-22T22:54:02.720
> 
> 标签：javascript, jquery, animation, css

我正在尝试编写一些 jquery，它将通过指定的无序列表/dom 元素并为每个列表项/子项分配一个 CSS（动画）类。我还想在 .addClass 之间设置一个可调整的延迟时间。

我尝试过的一切都失败了。

例如：

```
<ul>
   <li>Item 1</li>
   <li>Item 2</li>
   <li>Item 3</li>
   <li>Item 4</li>
</ul> 
```

变成：

```
<ul>
   <li class="animation">Item 1</li>
     (50ms delay)
   <li class="animation">Item 2</li>
     (50ms delay)
   <li class="animation">Item 3</li>
     (50ms delay)
   <li class="animation">Item 4</li>
     (50ms delay)
</ul> 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-22T23:02:11.713

这在这里有效：

```
$('ul li').each(function(i){
    var t = $(this);
    setTimeout(function(){ t.addClass('animation'); }, (i+1) * 50);
}); 
```

[http://jsfiddle.net/GCHSW/1/](http://jsfiddle.net/GCHSW/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-23T00:06:56.817

考虑一下：

HTML：

```
<ul id="myList">
   <li>Item 1</li>
   <li>Item 2</li>
   <li>Item 3</li>
   <li>Item 4</li>
</ul> 
```

Javascript：

```
$("#myList li").each(function(i, li) {
    var $list = $(this).closest('ul');
    $list.queue(function() {
        $(li).addClass('animation');
        $list.dequeue();
    }).delay(50);
}); 
```

见小提琴：http: [//jsfiddle.net/DZPn7/2/](http://jsfiddle.net/DZPn7/2/)

虽然这既不简洁也不高效，但它是 jQuery 纯粹主义者的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-04T08:28:59.790

我有 2 种动画方式（使用 jQuery 和 CSS3 Transitions + `.addClass`）。

因此，您可以尝试使用 jQuery，例如：

```
$('#myList li').each(function(i){
   $(this).delay(50*i).animate({opacity: 1},250);
}); 
```

并使用 CSS3 过渡：

```
$('#myList li').not('.animation').each(function(i){
    setTimeout(function(){
       $('#myList li').eq(i).addClass('animation');
    },50*i);
}); 
```

享受！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-22T23:28:01.467

Although the answer above does a good job of approaching the `<ul>` and `<li>` scenario, it will not work very well for a more verbose situation. To really dial this in, the functionality should be wrapped in a function which accepts the target element and delay as an input. The function will then take that element, and set a timeout with the delay for ...sigh, this is too involved I should just code it:

```
function applyAnimation(element, delay){
 setTimeout(function(){ $(element).addClass('animation'); }, delay);
 var children = document.getElementById(id).children;
 for( var i = 0; i < children.length; i++){
  applyAnimation(children[i],(2+i) * delay);//2+i:0 fails, 1 would be parent, 2 is child
 }
} 
```

# sql - 嵌入在 select 语句中的（相关）子查询中的别名范围

> ID：11165165
> 
> 赞同：1
> 
> 时间：2012-06-22T22:54:41.517
> 
> 标签：sql, sql-server, database, sql-server-2008, subquery

我的工作是运行 SQL Server 2008，并且我花费大量时间查询数据库以获取信息，作为我工作的一部分。如果我需要与我的数据集不在同一聚合级别的信息，我会在 select 语句中使用嵌入式查询。通常是相同数字的 2 或 3 个略有不同的版本，因此它们都查询相同的表。（见下面的例子）

问题是*嵌入在 select 语句中的子查询的别名的范围是什么*。我想到的两个选择是：

1.  在脚本级别并且必须对所有子查询和表都是唯一的？
2.  在子查询级别，并且可以在每个中共享相同的别名。

我知道对于 From 语句中别名的表，它们必须是唯一的。我认为查询在每一行生成上执行的事实可能是不同的情况。

示例（完全编造，让我知道任何明显的错误，我会纠正它们）：

脚本级别 - 所有子查询和表的唯一别名：

```
Select
  p.purchaseid, p.purchasedate, 
  s.storename, c.customerid, 
(select count(p2.purchaseid) 
  from purchases p2 inner join 
       store s2 on p2.storeid = s2.storeid
  where s2.storeid = s.storeid
    and p2.purchasedate = p.purchasedate) as 'Store Daily Total Purchases',
(select count(p3.purchaseid) 
  from purchases p3 inner join 
       store s3 on p3.storeid = s3.storeid
  where p3.customerid = p.customerid
    and p3.purchasedate = p.purchasedate) as 'Customer Daily Total Purchases'
from 
  purchases p inner join   
  customer c on p.customerid = c.customerid
  store s on p.storeid = s.storeid 
```

查询级别 - 子查询的常用别名可以：

```
Select
  p.purchaseid, p.purchasedate, 
  s.storename, c.customerid, 
(select count(p2.purchaseid) 
  from purchases p2 inner join 
       store s2 on p2.storeid = s2.storeid
where s2.storeid = s.storeid
  and p2.purchasedate = p.purchasedate) as 'Store Daily Total Purchases',
(select count(p2.purchaseid) 
  from purchases p2 inner join 
       store s2 on p2.storeid = s2.storeid
where p2.customerid = p.customerid
  and p2.purchasedate = p.purchasedate) as 'Customer Daily Total Purchases'
from 
  purchases p inner join   
  customer c on p.customerid = c.customerid
  store s on p.storeid = s.storeid 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-23T00:39:58.870

别名是在查询级别，所以你的第二个例子很好。

from 子句中对表的引用会产生这些相关的子查询，以防您想阅读有关该主题的更多信息。

一般来说，我建议您将查询移至 from 子句并将它们作为连接进行管理：

```
Select p.purchaseid, p.purchasedate, s.storename, c.customerid,
       pdate.cnt as [Store Daily Total Purchases],
       pcust.cnt as [Customer Daily Total Purchases]
from purchases p inner join   
     customer c
     on p.customerid = c.customerid join
     store s on p.storeid = s.storeid left outer join
     (select s2.storeid, p2.purchasedate, count(p2.purchaseid) 
      from purchases p2 inner join 
           store s2 on p2.storeid = s2.storeid
      group by s2.storeid, p2.purchasedate
     ) pdate
     on pdate.purchasedate = p.purchasedate and
        pdate.storeid = s.storeid left outer join
     (select s2.customerid, p2.purchasedate, count(p2.purchaseid) 
      from purchases p2 inner join 
           store s2 on p2.storeid = s2.storeid
      group by s2.storeid, p2.purchasedate
     ) pcust
     on pcust.purchasedate = p.purchasedate and
        pcust.customerid= s.customerid 
```

但是，就您而言，我认为仅使用聚合有一个更简单的解决方案：

```
Select p.purchaseid, p.purchasedate, s.storename, c.customerid,
       count(*) over (partition by s.storeid, p.purchasedate) as  as [Store Daily Total Purchases],
       count(*) over (partition by c.customerid, p.purchasedate) as [Customer Daily Total Purchases]
from purchases p inner join   
     customer c
     on p.customerid = c.customerid join
     store s on p.storeid = s.storeid 
```

# sql - Oracle to_dsinterval 不工作

> ID：11165169
> 
> 赞同：-1
> 
> 时间：2012-06-22T22:54:57.330
> 
> 标签：sql, oracle

我想将字符串转换为时间。我正在尝试`to_disinterval`。但这不需要几毫秒。

如何转换字符串'09:12:09:352'？我正在尝试使用类似的功能

```
to_disinterval('0 '||' '||SUBSTR('09:12:09:352',1,8)). 
```

但它不需要毫秒，它显示 0 9:12:09.0

请帮我。

问候，

柴兔

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-22T23:31:47.473

通过使用`SUBSTR(..., 1, 8)`，您准确地告诉 Oracle 忽略毫秒部分，只取字符串的前 8 个字符`'09:12:09:352'`。摆脱 SUBSTR 并使用

```
to_dsinterval('0 '||' '||'09:12:09.352') 
```

如果那是你需要的。请注意，您还需要将最后一个冒号更改为句点（通常的小数分隔符）。

# ruby-on-rails-3 - 从 Sqlite 表中提取 4 个随机 ID（行）并将数据发布到 Ruby on Rails 中的单独页面上？

> ID：11165171
> 
> 赞同：0
> 
> 时间：2012-06-22T22:55:33.123
> 
> 标签：ruby-on-rails-3, random, sqlite3-ruby

我知道标题长得离谱，但我需要一些关于 Ruby on Rails 和 Sqlite3 的帮助。

我原本以为做类似 4.times { (0..??).to_a.shuffle } 会打印一个介于 0 和 ?? （例如 20）四次，但它为我所做的一切（在 Rails 控制台中）只是打印数字“4”一次。

关于如何通过访问名为“bullets”的数据库表并使用嵌入式 ruby​​ (.erb) 在 Ruby on Rails 中成功完成此操作的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T23:01:37.467

您可以使用如下查询从 sqlite 中提取 4 个随机行：

```
select * from bullets order by random() limit 4; 
```

所以 AREL 语法是：

```
Bullet.select(:id).order('random()').limit(4).collect { |b| b.id }
=> [24, 6, 57, 37] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T23:00:46.010

如果您正在寻找从 0 到 n 的随机数数组，请尝试：

```
4.times.collect {rand(20)} 
```

# macos - 如何在发布时清空并完全释放 Grand Central Dispatch 队列？

> ID：11165173
> 
> 赞同：5
> 
> 时间：2012-06-22T22:55:38.177
> 
> 标签：macos, cocoa, objective-c-blocks, grand-central-dispatch

我有一个对象，它在初始化时使用和在释放调用时创建一个*串行*GCD 队列。在对象的生命周期中，调度块被添加到队列中，但是队列也使用and停止和启动。`dispatch_queue_create``dispatch_free``dispatch_suspend``dispatch_resume`

我的问题是，在某一时刻，对象可能会被释放，并且在释放时，为了整洁，我想完全删除调度队列和其中的所有`dispatch_block_t`对象，无论队列是否被挂起。

据我了解，队列在不再“需要”之前不会解除分配，因为它不再被其中的调度块保留。这使我相信，要释放队列，我必须通过允许其中的块首先执行终止来清空它。

解决此问题的最简单和最可靠的方法是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-23T00:43:42.723

一般来说，这不是你应该太担心的事情。来自[并发编程指南中调度队列的内存管理](http://developer.apple.com/library/ios/#documentation/General/Conceptual/ConcurrencyProgrammingGuide/OperationQueues/OperationQueues.html#//apple_ref/doc/uid/TP40008091-CH102-SW11)：

> 您可以使用 dispatch_retain 和 dispatch_release 函数根据需要增加和减少引用计数。当队列的引用计数达到零时，系统异步释放队列。

因此，当您调用 时`dispatch_release(myQueue)`，您会降低保留计数，但仍在队列中的任何任务都将保留队列。直到这些完成后，队列的保留计数才会为 0。所以这部分问题：

> 这使我相信，要释放队列，我必须通过允许其中的块首先执行终止来清空它。

是准确的。如果您有可能不想在队列中运行的任务，请继续阅读。

如果您从代码中暂停和恢复队列，这不会导致问题 - 因为您必须平衡所有暂停和恢复调用。如果你让你的队列处于暂停状态，[你会过得很糟糕](http://qkme.me/3ptpjv)。也就是说，您还可以选择为队列设置清理功能，使用`dispatch_set_finalizer_f`. 这不应该是必要的，但如果你需要它就在那里。

现在，根据您在此处描述的内容，我建议改用 NSOperation 和 NSOperationQueue 。它是 GCD 之上的一个更高级别的层，它允许您取消任务并做一些其他有用的事情，这些事情直接使用 GCD 很难做到。

# qt - Qt QSS 教程

> ID：11165177
> 
> 赞同：2
> 
> 时间：2012-06-22T22:56:02.857
> 
> 标签：qt, reference, styles, qtstylesheets

是否有任何好的`Qt QSS`教程，或者在某些地方我可以看到样式小部件的示例？如果在某处可用，我想要一些完整的参考。除了有关如何设置按钮或某些选项卡样式的小教程外，我什么也找不到。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-08T01:43:00.823

[Qt 样式表](https://doc.qt.io/qt-5/stylesheet.html)

话题：

1.  概述
2.  样式表语法
3.  Qt 设计器集成
4.  使用样式表自定义 Qt 小部件
5.  Qt 样式表参考
6.  Qt 样式表示例

# bash - 使用 Bash 的两个列表之间的区别

> ID：11165182
> 
> 赞同：37
> 
> 时间：2012-06-22T22:56:39.253
> 
> 标签：bash, sorting, sed, awk, grep

好的，我的 linux 框中的文本文件中有两个相关列表：

```
 /tmp/oldList
 /tmp/newList 
```

我需要比较这些列表以查看添加了哪些行以及删除了哪些行。然后我需要遍历这些行并根据它们是添加还是删除对它们执行操作。

我如何在 bash 中做到这一点？

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2012-06-23T00:08:40.153

使用`comm(1)`命令比较两个文件。它们都需要排序，如果它们很大，您可以事先进行排序，或者您可以使用 bash *process substitution*内联进行排序。

`comm`可以采用标志的组合`-1`，`-2`并`-3`指示要从哪个文件中抑制行（文件 1 独有，文件 2 独有或两者共有）。

要仅在旧文件中获取行：

```
comm -23 <(sort /tmp/oldList) <(sort /tmp/newList) 
```

要仅在新文件中获取行：

```
comm -13 <(sort /tmp/oldList) <(sort /tmp/newList) 
```

您可以将其输入`while read`循环以处理每一行：

```
while read old ; do
    ...do stuff with $old
done < <(comm -23 <(sort /tmp/oldList) <(sort /tmp/newList)) 
```

对于新线路也是如此。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-22T22:58:51.827

[diff 命令](https://linux.die.net/man/1/diff)将为您进行比较。

例如，

```
$ diff /tmp/oldList /tmp/newList 
```

有关更多信息，请参阅上面的手册页链接。这应该解决您问题的第一部分。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-11-07T00:10:09.340

如果您的脚本需要可读性，请考虑使用 Ruby。

要仅在旧文件中获取行：

```
ruby -e "puts File.readlines('/tmp/oldList') - File.readlines('/tmp/newList')" 
```

要仅在新文件中获取行：

```
ruby -e "puts File.readlines('/tmp/newList') - File.readlines('/tmp/oldList')" 
```

您可以将其输入 while read 循环以处理每一行：

```
while read old ; do
  ...do stuff with $old
done < ruby -e "puts File.readlines('/tmp/oldList') - File.readlines('/tmp/newList')" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-02-03T19:57:39.650

这是旧的，但为了完整起见，我们应该说，如果你有一个非常大的集合，最快的解决方案是使用 diff 生成一个脚本然后获取它，如下所示：

```
#!/bin/bash

line_added() {
   # code to be run for all lines added
   # $* is the line 
}

line_removed() {
   # code to be run for all lines removed
   # $* is the line 
}

line_same() {
   # code to be run for all lines at are the same
   # $* is the line 
}

cat /tmp/oldList | sort >/tmp/oldList.sorted
cat /tmp/newList | sort >/tmp/newList.sorted

diff >/tmp/diff_script.sh \
    --new-line-format="line_added %L" \
    --old-line-format="line_removed %L" \
    --unchanged-line-format="line_same %L" \
    /tmp/oldList.sorted /tmp/newList.sorted

source /tmp/diff_script.sh 
```

更改的行将显示为已删除和添加。如果你不喜欢这样，你可以使用--changed-group-format。检查差异手册页。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-01-26T11:35:40.477

我通常使用：

```
diff /tmp/oldList /tmp/newList | grep -v "Common subdirectories" 
```

该`grep -v`选项反转匹配：

> -v, --invert-match 选定的行是那些不匹配任何指定模式的行。

因此，在这种情况下，它会获取`diff`结果并忽略那些常见的结果。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-22T22:58:52.827

你有没有尝试过`diff`

```
$ diff /tmp/oldList /tmp/newList

$ man diff 
```

# javascript - 谷歌分析有没有办法像 Mixpanel 一样跟踪多个事件参数？

> ID：11165184
> 
> 赞同：10
> 
> 时间：2012-06-22T22:56:45.040
> 
> 标签：javascript, google-analytics

鉴于：

```
_trackEvent(category, action, opt_label, opt_value, opt_noninteraction) 
```

我尝试使用 opt_label ，但它似乎只是一个字符串，并且不接受 Mixpanel 那样的不同参数的哈希值。

我怀疑解决方法之一是使用自定义变量？但是文档似乎令人困惑。感谢任何建议。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-06-24T00:12:11.470

虽然您当然可以在 Google Analytics 中完成这项工作，但其他分析服务（如 Mixpanel、KISSmetrics、Kontagent 等）专注于事件分析并为您提供更大的灵活性。话虽如此，您可以破解 Google Analytics 事件模型来获得所需的内容。

如果您想在 Google Analytics 中跟踪每个事件的多个参数，我建议您将要跟踪的参数塞进事件标签中。这是可行的，原因有两个：事件标签可能非常长（实际上长得离谱），并且 Google Analytics 提供了灵活的过滤和分段选项。

因此，为了扩展先前答案中讨论的示例，您可以有一个用于跟踪视频播放详细信息的事件，如下所示：

```
_gaq.push(['_trackEvent', 'Videos', 'Play', 'title:MoreCatLolz, 
    percentPlayed:63, adShown:true, res:480p, fullScreen:false']); 
```

我们所做的只是将一些任意参数扔到事件标签字符串中，以便我们以后可以将它们取出。要分析结果，您可以过滤事件报告以显示“MoreCatLolz”视频与广告一起显示的次数：

![MoreCatLolz 与广告一起展示的次数](../Images/1e3bf843bcc3b3fda78dcab98d4526a2.png)

或者，使用高级细分和正则表达式，您可以计算用户观看了至少 90% 的任何视频的访问次数：

![用户观看任何视频至少 90% 的访问次数](../Images/c9261348b3ed763e350641f593ffc5b9.png)

要跟踪持久的用户数据，例如姓名、加入日期、级别、购买次数等，我建议使用访问者级别的自定义变量，这些变量会自动包含在每个跟踪调用（包括事件）中，并允许您应用许多相同的分析技术。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-01-30T14:28:35.867

GA 在跟踪事件（或一般命中）属性方面不如 Mixpanel，也许您应该重新考虑在 GA 中想要/可以做什么。也就是说，有一种方法可以通过**自定义维度和指标**来实现您的需求。[这里](https://support.google.com/analytics/answer/2709828?hl=en)有一些关于它们做什么的信息，[这里](https://support.google.com/analytics/answer/2709829?hl=en)是关于如何在管理面板中设置它们的说明，在[这里](https://developers.google.com/analytics/devguides/collection/analyticsjs/custom-dims-mets)你可以找到如何在你的代码中使用它们。一些限制：

> 每个属性中有 20 个可用于不同自定义维度的索引和 20 个用于自定义指标的索引。360 帐户有 200 个可用于自定义维度的索引和 200 个可用于自定义指标的索引。
> 
> 自定义维度无法删除，但您可以禁用它们。

首先，您需要通过 GA 中的管理面板添加自定义维度/指标（管理 -> 属性列 -> 自定义定义 -> 自定义维度/指标）。

使用`analytics.js`，您可以`set`在触发命中之前或`send`在触发命中时设置事件属性。例子：

```
// set the dimension/metric values before the hit
ga('set', {
  'dimension5': 'custom dimension data',
  'metric5': 8000
});
// values set above are passed to GA along with the hit info
ga('send', 'event', 'someCategory', 'someAction');

// or alternatively
ga('send', 'event', 'someCategory', 'someAction', {
  'dimension5': 'custom dimension data',
  'metric5': 8000
}); 
```

如果您不确定维度和指标之间的区别，请查看[此](https://support.google.com/analytics/answer/1033861?hl=en)内容。

我希望这有帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-23T01:27:33.450

我不确定 mixpanel 是什么，所以我不知道您试图将分析与什么进行比较。如果您提供了您尝试收集的数据的具体示例，我可以为您提供更好的答案。

假设您有一个视频播放器，并且您想跟踪人们观看视频的时间以及人们暂停视频的次数，您可以这样做；

```
if (video == "pause") {
   var playTime = playduration(), // Total minutes of video watched
       clickPause = pauseNum(); // Total number of times video was paused

   _gaq.push(['_trackEvent', 'Video', 'Play', playTime]);
   _gaq.push(['_trackEvent', 'Video', 'Pause', clickPause]);
} 
```

显然这是通用的，但正如您在`_gaq.push`数组中看到的那样，`Play`and`Pause`是参数，`playTime`and`clickPause`是参数的变量值。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-06-22T23:43:29.443

标签是可选的，所以我会将其扩展为：

```
<a href="#" onClick="_gaq.push(['_trackEvent', 'Games', 'Play', 'Tetris']);">Play</a> 
```

类别 = '游戏'
事件 = '播放'
标签 = '俄罗斯方块'

# shell - 在 shell 中自动执行一些命令

> ID：11165185
> 
> 赞同：0
> 
> 时间：2012-06-22T22:57:02.377
> 
> 标签：shell

假设我每次打开 shell 时都需要在 shell 中自动运行几个命令。我怎样才能自动化呢？

例如：

我需要自动化以下操作：

1.  打开一个外壳
2.  cd /特定文件夹
3.  寻找 。-name 'app_logs'

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T23:12:36.547

如果是 BASH，那么您可以将这些命令放入 ~/.bashrc

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T23:12:55.843

这取决于您使用的操作系统和终端。我想大多数流行的终端都允许您自定义启动命令。例如，在 Mac OS X 附带的 Terminal.app 中，您可以转到 Preferences > Settings > Shell > Startup / run 命令来指定要在每个终端窗口/选项卡启动时运行的脚本。

或者，您可以简单地使用`$HOME/.profile`或的命令`$HOME/.bashrc`，具体取决于您的操作系统和外壳。

# dictionary - 如何在 Python 3 中实现 UserDict.DictMixin 的功能？

> ID：11165188
> 
> 赞同：10
> 
> 时间：2012-06-22T22:57:19.130
> 
> 标签：dictionary, python-3.x, dictmixin

在 Python 3 中，`UserDict.DictMixin`该类被移至`collections`模块中。文档建议使用`collections.MutableMapping`它的位置，但是这个抽象类没有提供一些`DictMixin`做/做的方法。

是否有另一种（或更好的）方法来定义它们，而不是获取`UserDict.Mixin`源的私有副本以导入 - 或者只是将其所需的部分 - 复制到我自己的类字典类中？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-22T23:43:39.180

The "number of methods" are specifically `__len__` and `__iter__` so the additional work is not that much.

```
def __len__(self):
    return len(self.mylist)

def __iter__(self):
    for i in self.mylist:
        yield i 
```

Should work, I think (untested, though).

# language-agnostic - 图灵机有“时间”的概念吗？

> ID：11165191
> 
> 赞同：7
> 
> 时间：2012-06-22T22:57:54.257
> 
> 标签：language-agnostic, time, turing-machines

我本科时研究过基本的图灵机理论。我从未见过任何提及定时图灵机加工。一个例子：一个计算自启动以来经过的秒数的图灵机。

现代计算机显然有能力做到这一点。因此，计算机的能力是图灵机的超集。是否有一些关于此的文章/数学/文档？或者我的论点在某些时候是错误的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-22T23:10:06.363

图灵机不使用时间，因为它不需要，它是一个纯粹的计算设备，计算不是时间的推导，但时间是计算的推导。尽管如此，它是一个机械设备，因此需要时间来制作步骤，所以机器也可以计算这个时间，但这需要另一台修整机来完成。

附言。这是因为熵，时间是从计算中得出的。您可以立即重置计算机，这与熵相反。所以这就是为什么启动几乎总是比关机花费更长的时间，尤其是在您断开电源的情况下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T23:41:56.223

当然，图灵机可以计算时间。

假设你的图灵机每秒走一步。

1.  在图灵机的磁带上写入当前时间（等于 BIOS 中的设置时间或从互联网下载）

2.  编辑机器，使其在每一步中将磁带上的时间增加 1 秒（等于主板上的电动“滴答声发生器”在每个滴答声中增加 BIOS 中的数字）

现在你可以把这台图灵机挂在墙上了。每次查看磁带时，您都会看到准确的时间。

但请记住，图灵机使用字母表。计算机使用字母 {0,1}。图灵机（或计算机）不知道，这些零和一代表字母、数字、图片还是视频。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T23:08:46.063

您可能想阅读[非正式定义](http://en.wikipedia.org/wiki/Turing_machine#Informal_description)，或者，如果您愿意，可以阅读Wikipedia 上图灵机的[正式定义](http://en.wikipedia.org/wiki/Turing_machine#Formal_definition)

随机谷歌搜索我也发现[这](http://www.sciencedirect.com/science/article/pii/S0019995867904330)似乎很有希望。

我认为简而言之，您是对的，计算机比图灵机*更方便*，但基本上没有设备可以解决一台或多台图灵机无法解决的问题。

# java - 在 Java/Android 中测试空 JSON 对象

> ID：11165192
> 
> 赞同：7
> 
> 时间：2012-06-22T22:57:58.333
> 
> 标签：java, android, json, null

我得到了这个 LogCat：

```
06-22 15:30:53.731: E/AndroidRuntime(2389): java.lang.NumberFormatException: Invalid float: "null"
06-22 15:30:53.731: E/AndroidRuntime(2389):     at java.lang.StringToReal.invalidReal(StringToReal.java:63)
06-22 15:30:53.731: E/AndroidRuntime(2389):     at java.lang.StringToReal.parseFloat(StringToReal.java:310)
06-22 15:30:53.731: E/AndroidRuntime(2389):     at java.lang.Float.parseFloat(Float.java:300)
06-22 15:30:53.731: E/AndroidRuntime(2389):     at java.lang.Float.valueOf(Float.java:337) 
```

这是代码：

```
try
{
    jObject = new JSONObject(result);
    starAvg = jObject.getString("AverageRating"); 
}
ratingsBar = (RatingBar) findViewById(R.id.theRatingBar);
ratingsBar.setRating(Float.valueOf(starAvg)); 
```

这是上下文：

在 PHP 中，我在 MySQL 表的列中平均总数。当有 ANY 行时，它会发回其中数据的平均值并对其进行编码，Java 将其作为 JSON 对象拾取。但有时，在某些情况下，一个表可能有 0 行，所以我得到了这个 JSON 对象：

```
 {"AverageRating":null} 
```

然后我的应用程序崩溃，`LogCat`如上所示。

`String`似乎并不关心它是否接收到 Null JSON 对象，但是当我这样做时应用程序崩溃`Float.valueOf(theString)`。

另一个旁注，我试图以这种方式进行测试：

```
if String is Null, Float = 0 
if String is not null, Float.valueOF(String) 
```

但它似乎从来没有将字符串读为空。`null`在这种情况下实际上不是吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-06-22T23:18:53.220

使用以下方法`JsonObject`检查任何键的值是否为空

```
public boolean isNull(java.lang.String key) 
```

此方法用于针对任何键检查 Null 或该键是否没有值。

使用下面的片段

```
if (jsonObject.isNull("AverageRating")) {
    Toast.makeText(this, "Cannot Convert!!", Toast.LENGTH_LONG).show();
    //float set to 0
} else {
    Float.valueOf(jsonObject.getString("AverageRating"));
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-22T23:03:30.730

```
String str = jObject.getString("AverageRating");
float number = 0.f;
try
{
    number = Float.parseFloat(str);
}
catch (NumberFormatException e)
{
    number = 0;
} 
```

`parseFloat()`如果收到 . 将抛出异常`null`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T23:12:29.760

在解析值之前检查 null，

```
String s = jObject.getString("AverageRating");
if (s != null) {
  double rating = Double.parseDouble(s);
  // whatever
} 
```

话虽如此，如果 的值`AverageRating`确实是一个数字，那么生成 JSON 的实体不应将其作为字符串添加到 JSON 中。如果该字段没有值，则该字段应该不存在。如果该字段有值，它应该是一个数字。

如果这是真的，你可以这样处理，

```
if (jObject.has("AverageRating")) {
  double rating = jObject.getDouble("AverageRating");
  // whatever
} 
```

其他帖子建议简单地捕捉`NumberFormatException`. 仅当您希望始终在该字段中具有有效的 double 值并认为它异常时，这才是正确的。如果您知道/期望该字段有时会不存在，则它不符合例外条件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-28T10:02:18.593

```
if (json != null && json.getString(KEY_SUCCESS) != null){
    // PARSE RESULT 
}else{
    // SHOW NOTIFICIATION: URL/SERVER NOT REACHABLE
} 
```

话虽如此，检查空值（如键）作为 json 值。

# load - 无法读取未知加载命令 0x25

> ID：11165194
> 
> 赞同：0
> 
> 时间：2012-06-22T22:58:13.557
> 
> 标签：load, command, xib

iPad 开发：在模拟器中运行良好，在设备上获得内存警告。在所有东西上使用“释放”功能。收到此错误：

无法读取未知加载命令 0x25

无法读取未知加载命令 0x26

它在几次 xib 更改后崩溃。帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-10T10:20:28.460

```
#define LC_VERSION_MIN_IPHONEOS 0x25

struct version_min_command {
uint32_t    cmd;        /* LC_VERSION_MIN_MACOSX or
                   LC_VERSION_MIN_IPHONEOS  */
    uint32_t    cmdsize;    /* sizeof(struct min_version_command) */
    uint32_t    version;    /* X.Y.Z is encoded in nibbles xxxx.yy.zz */
    uint32_t    sdk;        /* X.Y.Z is encoded in nibbles xxxx.yy.zz */ 
```

# email - 最佳电子邮件营销软件（PHPlist 的替代品）

> ID：11165195
> 
> 赞同：0
> 
> 时间：2012-06-22T22:58:16.710
> 
> 标签：email, newsletter, mailman, phplist

那里有 PHPlist 的好替代品吗？特别是在轨道上的红宝石？

我们正在寻找像 www.campaignmonitor.com 这样的产品

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T19:40:25.470

我还创建了一个时事通讯邮件软件[http://codecanyon.net/item/newsletter-mailer-v13/149365](http://codecanyon.net/item/newsletter-mailer-v13/149365)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T23:18:26.210

试试 MadMimi：[https ://www.madmimi.com/](https://www.madmimi.com/)

同样在 GitHub 上：[https ://github.com/madmimi/madmimi-gem](https://github.com/madmimi/madmimi-gem)

# mysql - ms access sql语句选择角色a而不是b的用户

> ID：11165196
> 
> 赞同：1
> 
> 时间：2012-06-22T22:58:21.877
> 
> 标签：mysql, ms-access

我想选择具有角色 A 和/或 B 但没有角色 c 的用户。我试过这个查询，但它不起作用。

```
SELECT User from table1 where (role ="A" or role = "B") and (Role <> "C"). 
```

用户可以拥有多个角色。然后可以有ABC，AC，AB...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T03:43:25.310

谢谢各位 我想通了

```
SELECT DISTINCT a.User, a.ROLE
FROM table1 AS a
WHERE (((a.User) Not In (select user from table1 where
ROLE = "ROLEC" and user = a.user)) AND ((a.ROLE)="ROLEA" Or (a.ROLE)="ROLEB") 
ORDER BY a.User; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T23:01:40.433

我认为如果你只是省略`role <> "C"`它*只会*得到带有`role=A and role=B`. 此外，查看文档，您的括号似乎`(role ="A" or role = "B")`是不必要的。

# iphone - NSMutableURLRequest 在大约 15 秒后超时。超时设置为 240 秒

> ID：11165197
> 
> 赞同：1
> 
> 时间：2012-06-22T22:58:22.857
> 
> 标签：iphone, ios, ipad, nsurlconnection, nsmutableurlrequest

我正在开发一个使用 a`NSMutableURLRequest`和 a`NSURLConnection`将数据发送到我的服务器的 iOS 应用程序。我需要在失败时显示错误消息。我发送请求的代码如下所示

```
const int TIMEOUT = 120;

-(void)send:(id<NSURLConnectionDelegate>)delegate
{
    bodyContents = [bodyContents stringByAppendingFormat:@"--%@--",boundry];
    NSData *data = [bodyContents dataUsingEncoding:NSUTF8StringEncoding];
    [request setHTTPBody:data];
    [request setValue:[NSString stringWithFormat:@"%i",[data length]+4] forHTTPHeaderField:@"Content-Length"];
    NSLog(@"Timeout before setting custom is %f",request.timeoutInterval);
    [request setTimeoutInterval:TIMEOUT];
    NSLog(@"Timeout after setting custom is %f",request.timeoutInterval);
    NSURLConnection *connection = [[NSURLConnection alloc]initWithRequest:request delegate:delegate];
    if(connection)
        NSLog(@"Connection good");
    else
        NSLog(@"Connection not so good");
}

//in the delegate class
-(void)connectionDidFinishLoading:(NSURLConnection*)connection
{
    NSLog(@"connectionDidFinishLoading");
}

-(void)connection:(NSURLConnection*)connection didFailWithError:(NSError *)error
{
    NSLog(@"Failed with error %@",error);
    btnCancel.title = @"Retry";
    self.navigationItem.hidesBackButton = NO;
    [self showAlertDialog:[NSString stringWithFormat:@"%@",[error localizedDescription]] :@"Error"];
} 
```

我希望在 2 分钟无响应后调用 didFailWithError 消息。相反，它在大约 15 秒无响应后被调用，这没有任何意义。我查看了文档以检查我是否错误地设置了超时，我唯一能发现的是，带有正文的帖子的最小超时时间是 240 秒，我已经不情愿地接受了。

运行应用程序的输出如下所示：

> 2012-06-22 16:49:12.393 媒体上传 [672:707] 设置自定义之前的超时为 240.000000
> 
> 2012-06-22 16:49:12.394 媒体上传[672:707] 设置自定义后超时为 240.000000
> 
> 2012-06-22 16:49:12.395 媒体上传[672:707] 连接良好
> 
> 2012-06-22 16:49:29.174 媒体上传[672:707] 失败，错误域=NSURLErrorDomain 代码=-1001“请求超时。” ETC

我对为什么它超时如此之快感到有点困惑。创建连接时服务器没有启动所以我什至不确定为什么它说连接好而不是连接不太好，但这是一个不同的问题（我希望）有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T00:03:11.783

所以，我怀疑答案全在语义上。

至于“连接良好”日志而不是“连接不太好”，这是因为初始化连接不会等待它在网络上执行*任何*操作。它*确实*会导致它立即启动，但不会在它从 init 方法返回之前启动。

更有趣（阅读：误导）的问题是超时。我怀疑超时设置的真正含义是，“如果我已经建立了连接，但服务器还没有给我响应字节”。这与“我一直在尝试，但无法连接”不同。当您以这种方式思考时，它具有一定的意义。一个超时值仅用于所有“网络”内容（路由和握手），另一个用于要处理的实际有效负载。

# objective-c - 协助将 NSInvocation 代码转换为 ARC 兼容（已经是 Objective-C）

> ID：11165198
> 
> 赞同：0
> 
> 时间：2012-06-22T22:58:34.427
> 
> 标签：objective-c, automatic-ref-counting, nsinvocation

我从 Matt Gallagher 那里找到了一些非常棒的代码，用于使 Undo 与 NSInvocation 一起工作。尽管现在管理层希望我们对所有代码都使用 ARC，但我们现在正在将所有代码转换为 ARC。这最后一块就是剩下的了。马特，没有时间做转换，所以我希望我能在这里得到一些帮助。

任何援助将不胜感激！

谢谢！

**NSInvocation(ForwardedConstruction).h**

```
 //
        //  NSInvocation(ForwardedConstruction).h
        //
        //  Created by Matt Gallagher on 19/03/07.
        //  Copyright 2007 Matt Gallagher. All rights reserved.
        //
        //  Permission is given to use this source code file without charge in any
        //  project, commercial or otherwise, entirely at your risk, with the condition
        //  that any redistribution (in part or whole) of source code must retain
        //  this copyright and permission notice. Attribution in compiled projects is
        //  appreciated but not required.
        //

        @interface NSInvocation (ForwardedConstruction)

        + (id)invocationWithTarget:(id)target
            invocationOut:(NSInvocation **)invocationOut;
        + (id)retainedInvocationWithTarget:(id)target
            invocationOut:(NSInvocation **)invocationOut;

        @end 
```

**NSInvocation(ForwardedConstruction).m**

```
 //
        //  NSInvocation(ForwardedConstuction).m
        //
        //  Created by Matt Gallagher on 19/03/07.
        //  Copyright 2007 Matt Gallagher. All rights reserved.
        //
        //  Permission is given to use this source code file without charge in any
        //  project, commercial or otherwise, entirely at your risk, with the condition
        //  that any redistribution (in part or whole) of source code must retain
        //  this copyright and permission notice. Attribution in compiled projects is
        //  appreciated but not required.
        //

    #import "NSInvocation(ForwardedConstruction).h"
    #import <objc/runtime.h>
    #import <objc/message.h>

        //
        // InvocationProxy is a private class for receiving invocations via the
        // forwarding mechanism and saving the received invocation to an external
        // invocation pointer.
        //
        // To avoid as many instance methods as possible, InvocationProxy is a base
        // class (not a subclass of NSObject) and does not implement the NSObject
        // protocol (and so is *not* a first-class object).
        //
    @interface InvocationProxy
    {
        Class isa;
        NSInvocation **invocation;
        id target;
        BOOL retainArguments;
        NSUInteger forwardingAddress;
    }

    /*+ (id)alloc;*/
    + (void)setValuesForInstance:(InvocationProxy *)instance
                          target:(id)target
           destinationInvocation:(NSInvocation **)destinationInvocation
                 retainArguments:(BOOL)retain;
    - (NSMethodSignature *)methodSignatureForSelector:(SEL)aSelector;
    - (void)forwardInvocation:(NSInvocation *)forwardedInvocation;

    @end

    #ifndef __OBJC_GC__

        //
        // DeallocatorHelper is a basic object which takes an id
        // and deallocates it when the DeallocatorHelper is deallocated.
        //
        // Not used in a garbage collected environment (which should deallocate the
        // id automatically).
        //
    @interface DeallocatorHelper : NSObject
    {
        id object;
    }

    - (id)initWithObject:(id)newObject;
    - (void)dealloc;

    @end

    @implementation DeallocatorHelper

        //
        // initWithObject
        //
        // Init method for objects which sets the id to be autoreleased.
        //
    - (id)initWithObject:(id)newObject
    {
        self = [super init];
        if (self != nil)
        {
            object = newObject;
        }
        return self;
    }

        //
        // dealloc
        //
        // Deallocates the id.
        //
    - (void)dealloc
    {
        NSDeallocateObject(object); 
        [super dealloc];
    }

    @end

    #endif

    @implementation InvocationProxy

        //
        // initialize
        //
        // This empty method is required because the runtime tries to invoke it when
        // the first message is sent to the Class. If it doesn't exist, the runtime
        // gets mad.
        //
    + (void)initialize
    {
    }

        //
        // alloc
        //
        // Allocator for the class. Also sets the 
        //
    + (id)alloc
    {
            //
            // Allocate the object using the default allocator.
            //
        InvocationProxy *newObject =
    #ifdef __OBJC_GC__
        objc_allocate_object(self, 0);
    #else
        NSAllocateObject(self, 0, nil);
    #endif
        return newObject;
    }

    - (id)init {  
        return self;  
    }

        //
        // setValuesForInstance:target:destinationInvocation:retainArguments:
        //
        // Method to set the attributes on the instance passed in. We use a class
        // method instead of an instance method to avoid extra instance methods on
        // the class.
        //
    + (void)setValuesForInstance:(InvocationProxy *)instance
                          target:(id)destinationTarget
           destinationInvocation:(NSInvocation **)destinationInvocation
                 retainArguments:(BOOL)retain;
    {
        instance->target = destinationTarget;
        instance->invocation = destinationInvocation;
        instance->retainArguments = retain;
    }

        //
        // methodSignatureForSelector:
        //
        // Invoked by the runtime whenever a message is sent for a method that doesn't
        // exist.
        //
    - (NSMethodSignature *)methodSignatureForSelector:(SEL)aSelector
    {
            //
            // This method should be invoked once before attributes are set (as an
            // "init" invocation).
            //
        if (target == nil)
        {
                //
                // If the invocation is something other than "init", complain using
                // NSObject's standard doesNotRecognizeSelector:
                //
            if (aSelector != @selector(init))
            {
                SEL failSEL = @selector(doesNotRecognizeSelector:);
                Method failMethod =
                class_getInstanceMethod([NSObject class], failSEL);
                IMP failImp = method_getImplementation(failMethod);
                failImp(self, failSEL, aSelector);
            }

                //
                // Otherwise, we use the forwarded "init" to preserve the return
                // address of the forwarding code (which we can use later to determine
                // if this is a forwarded or direct invocation).
                //
            forwardingAddress = (NSUInteger)__builtin_return_address(0);

                //
                // Return the NSMethodSignature from NSObject's init method (just
                // so we have something to return).
                //
            return [NSObject instanceMethodSignatureForSelector:aSelector];
        }

            //
            // On subsequent invocations, check if we are a forwarded invocation or
            // a direct invocation.
            //
        NSUInteger returnAddress = (NSUInteger)__builtin_return_address(0);
        if (returnAddress != forwardingAddress)
        {
                //
                // Handle the case where methodSignatureForSelector: is the message sent
                // directly to the proxy.
                //
                // There is a chance that we have guessed wrong (i.e. if this is sent
                // from __forward__ but from a different code branch) but that won't
                // cause a fatal problem, just a redundant autoreleased NSInvocation
                // that will get safely autoreleased and ignored.
                //
                // Create an NSInvocation for methodSignatureForSelector: 
                //
            NSMethodSignature *signature =
            [target methodSignatureForSelector:_cmd];
            *invocation =
            [NSInvocation invocationWithMethodSignature:signature];
            [*invocation setTarget:target];
            [*invocation setSelector:_cmd];
            [*invocation setArgument:&aSelector atIndex:2];
            if (retainArguments)
            {
                [*invocation retainArguments];
            }

                //
                // Deliberately fall through and still return the target's
                // methodSignatureForSelector: result (in case we guessed wrong).
                //
        }

            //
            // This is the "normal" case: after initialization, we have been correctly
            // invoked from the forwarding code. Return the target's
            // methodSignatureForSelector: for the given selector.
            //
        NSMethodSignature *signature =
        [target methodSignatureForSelector:aSelector];

        NSAssert3(signature != nil,
                  @"NSInvocation(ForwardedConstruction) error: object 0x%@ of class '%@' does not implement %s",
                  target, [target className], sel_getName(aSelector));

        return signature;
    }

        //
        // forwardInvocation:
        //
        // This method is invoked by message forwarding.
        //
    - (void)forwardInvocation:(NSInvocation *)forwardedInvocation
    {
            //
            // This method will be invoked once on initialization (before target is set).
            // Do nothing.
            //
        if (target == nil)
        {
                //
                // This branch will be followed when "init" is invoked on the newly
                // allocated object. Since "init" returns "self" we need to set that
                // on the forwardedInvocation.
                //
            [forwardedInvocation setReturnValue:&self];
            return;
        }

            //
            // Check if the target of the forwardedInvocation is equal to self. If
            // it is, then this is a genuine forwardedInvocation. If it isn't, then
            // forwardInvocation: was directly the message sent to this proxy.
            //
        if ([forwardedInvocation target] == self)
        {
            [forwardedInvocation setTarget:target];
            *invocation = forwardedInvocation;
            if (retainArguments)
            {
                [*invocation retainArguments];
            }
            return;
        }

            //
            // Handle the case where forwardedInvocation is the message sent directly
            // to the proxy. We create an NSInvocation representing a forwardInvocation:
            // sent to the target instead.
            //
        NSMethodSignature *signature =
        [target methodSignatureForSelector:_cmd];
        *invocation =
        [NSInvocation invocationWithMethodSignature:signature];
        [*invocation setTarget:target];
        [*invocation setSelector:_cmd];
        [*invocation setArgument:&forwardedInvocation atIndex:2];
        if (retainArguments)
        {
            [*invocation retainArguments];
        }
    }

    @end

    @implementation NSInvocation (ForwardedConstruction)

        //
        // invocationWithTarget:invocationOut:
        //
        // Basic constructor for NSIncoation using forwarded construction.
        //
    + (id)invocationWithTarget:(id)target
                 invocationOut:(NSInvocation **)invocationOut
    {
            //
            // Check that invocationOut isn't nil.
            //
        NSAssert2(target != nil && invocationOut != nil,
                  @"%@ method %s requires target that isn't nil and a valid NSInvocation** for the second parameter",
                  [self className], sel_getName(_cmd));

            //
            // Alloc and init the proxy
            //
        InvocationProxy *invocationProxy = [[InvocationProxy alloc] init];

            //
            // Set the instance attributes on the proxy
            //
        [InvocationProxy
         setValuesForInstance:invocationProxy
         target:target
         destinationInvocation:invocationOut
         retainArguments:NO];

            //
            // Create the DeallocatorHelper if needed
            //
    #ifndef __OBJC_GC__
            [[[DeallocatorHelper alloc]
                    initWithObject:invocationProxy]
                autorelease];
    #endif

        return invocationProxy;
    }

        //
        // retainedInvocationWithTarget:invocationOut:
        //
        // Same as above but sends retainArguments to the NSInvocation created.
        //
    + (id)retainedInvocationWithTarget:(id)target
                         invocationOut:(NSInvocation **)invocationOut
    {
            //
            // Check that invocationOut isn't nil.
            //
        NSAssert2(target != nil && invocationOut != nil,
                  @"%@ method %s requires target that isn't nil and a valid NSInvocation** for the second parameter",
                  [self className], sel_getName(_cmd));

            //
            // Alloc and init the proxy
            //
        InvocationProxy *invocationProxy = [[InvocationProxy alloc] init];

            //
            // Set the instance attributes on the proxy
            //
        [InvocationProxy
         setValuesForInstance:invocationProxy
         target:target
         destinationInvocation:invocationOut
         retainArguments:YES];

            //
            // Create the DeallocatorHelper if needed
            //
    #ifndef __OBJC_GC__
        [[[DeallocatorHelper alloc]
          initWithObject:invocationProxy]
         autorelease];
    #endif

        return invocationProxy;
    }

    @end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T23:02:45.063

您可以完全避免这种情况：

在 Xcode 中的 Target > Build Phases > Compile Sources 中选择此文件。

按回车。

键入 -fno-objc-arc。

按完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-23T16:57:41.530

正如 Matt 提到的，您应该在编译文件时添加“-fno-objc-arc”标志，但这还不够。您需要做两件事来确保您的调用按预期被调用。

首先总是在变量的声明中添加“__autoreleasing”；你应该有类似的东西：

```
NSInvocation *__autoreleasing invocation;
[[NSInvocation retainedInvocationWithTarget:self invocationOut:&invocation] myMethod]; 
```

如果你没有这样做，ARC 会在你有时间使用它之前将“invocation”设置为 nil。

然后你需要修改 forwardInvocation: 在 NSInvocation 覆盖。这是必需的，因为 ARC 将向代理对象发送“保留”和“释放”，而您不希望它们干扰（这意味着您将无法使用代码来创建“保留”和“释放”的调用消息，但你很可能不是）。

```
- (void)forwardInvocation:(NSInvocation *)forwardedInvocation
{
    //
    // This method will be invoked once on initialization (before target is set).
    // Do nothing.
    //
    if (target == nil)
    {
        //
        // This branch will be followed when "init" is invoked on the newly
        // allocated object. Since "init" returns "self" we need to set that
        // on the forwardedInvocation.
        //
        [forwardedInvocation setReturnValue:&self];
        return;
    }
    if (forwardedInvocation.selector == @selector(retain))
    {
        // This branch will be followed when "retain" is invoked on the newly
        // allocated object. ARC will call retain before the selector we want
        // the signature of is invoked, so we need to return "self" to track
        // the next forward invocation.
        [forwardedInvocation setReturnValue:&self];
        return;
    }
    if (forwardedInvocation.selector == @selector(release))
    {
        // This branch will be followed when "release" is invoked on the newly
        // allocated object. ARC will call release after the selector we want
        // the signature of is invoked.
        return;
    }

    //
    // Check if the target of the forwardedInvocation is equal to self. If
    // it is, then this is a genuine forwardedInvocation. If it isn't, then
    // forwardInvocation: was directly the message sent to this proxy.
    //
    if ([forwardedInvocation target] == self)
    {
        [forwardedInvocation setTarget:target];
        *invocation = forwardedInvocation;
        if (retainArguments)
        {
            [*invocation retainArguments];
            //[forwardedInvocation retainArguments]; // added
        }
        // [forwardedInvocation setReturnValue:forwardedInvocation]; // added
        return;
    }

    //
    // Handle the case where forwardedInvocation is the message sent directly
    // to the proxy. We create an NSInvocation representing a forwardInvocation:
    // sent to the target instead.
    //
    NSMethodSignature *signature =
    [target methodSignatureForSelector:_cmd];
    *invocation =
    [NSInvocation invocationWithMethodSignature:signature];
    [*invocation setTarget:target];
    [*invocation setSelector:_cmd];
    [*invocation setArgument:&forwardedInvocation atIndex:2];
    if (retainArguments)
    {
        [*invocation retainArguments];
    }
} 
```

# javascript - 列表视图 getListItemXmlAttributes 方法因子发布项而失败

> ID：11165200
> 
> 赞同：357
> 
> 时间：2012-06-22T22:58:52.437
> 
> 标签：javascript, listview, methods, attributes, tridion

当项目被修改时，我创建了一个 JS 类来填充 SG/文件夹列表视图数据。（[根据 Jaime 的方法）](http://jaimesantosalcon.blogspot.com/2012/04/sdl-tridion-2011-data-extenders-real.html) 当我对创建它们的出版物中的项目进行操作时，一切都很好。

**例如：**我打开一个组件或页面，自定义`locked by`列立即更新并显示我的用户名。

但是，当我转到子出版物并重复该过程时，会出现一个窗口，询问我是否要本地化或编辑父项目。如果我选择编辑父窗口，则代码不起作用。通过初始调试，我还没有完全弄清楚。Chrome 似乎吞下了这个错误，Firefox 给了我一个神秘的信息：

> 时间戳：2012 年 6 月 22 日下午 3:42:54
> 
> 错误：未捕获的异常：[异常...“组件返回失败代码：0x80004002（NS_NOINTERFACE）[nsIWebProgress.DOMWindow]”nsresult：“0x80004002（NS_NOINTERFACE）”位置：“JS 框架 :: chrome://browser/content/tabbrowser .xml :: :: 第 545 行“数据：无]

有没有人有任何初步的想法？稍后我会尝试发布一些代码...

来自 PageEx.js 的代码：

```
Type.registerNamespace("MyCompany.Tridion.RTFExtensions");

/*
* Constructor
*/

MyCompany.Tridion.RTFExtensions.PageEx = function (id) {
    Type.enableInterface(this, "MyCompany.Tridion.RTFExtensions.PageEx");
    this.addInterface("Tridion.ContentManager.Page", [id]);
    var p = this.properties;
    p.versionNumberString = undefined;
    p.modifiedBy = undefined;
    p.lockedBy = undefined;
    p.approvalStatus = undefined;
    p.publishDate = undefined;
    p.previousVersion = undefined;
    p.previousApprovalStatus = undefined;
    p.customModifiedDate = undefined;
    p.initialModifierUserName = undefined;
};

/*
* sends the list xml string for the item 
*/
MyCompany.Tridion.RTFExtensions.PageEx.prototype.getListItemXmlAttributes = function (customAttributes) {
    var attribs = {};
    $extUtils.getListItemXmlAttributes(customAttributes,this, attribs);
    return this.callBase("Tridion.ContentManager.Page", "getListItemXmlAttributes", [attribs]);
};

/*
* This method gets called when an item is opened from list view. node parameter has the information
* displayed in the list view as attributes. We are getting cutom data extender column information 
* from this xml node and storing it in this class member for returning it from getListItemXmlAttributes method
*/
MyCompany.Tridion.RTFExtensions.PageEx.prototype.setDataFromList = function (node, parentId, timeStamp) {
    $extUtils.setDataFromList(node,parentId,timeStamp,this);
    this.callBase("Tridion.ContentManager.Page", "setDataFromList", [node, parentId, timeStamp]);
};

/* 
* Gets item icon 
*/
MyCompany.Tridion.RTFExtensions.PageEx.prototype.getItemIcon = function () {
    var icon = this.callBase(this.defaultBase, "getItemIcon");
    return icon;
}; 
```

来自 utils.js 的代码：

```
// reloads the list view for the given id (used in list view data refresh when JS cant get the required data without reloading)
MyCompany.Tridion.RTFExtensions.Utilities.reloadListView = function (listTcmId) {
    var registry = $models.getListsRegistry();
    for(var key in registry)
    {
        var entry = $models.getItem(registry[key]);
        if (entry && entry.getParentId() == listTcmId)
        {
           entry.unload();
           return true;
        }
    }
    return false;
}

/*
* This method gets called when an item is opened from list view. node parameter has the information
* displayed in the list view as attributes. We are getting cutom data extender column information 
* from this xml node and storing it in this class member for returning it from getListItemXmlAttributes method
*/
MyCompany.Tridion.RTFExtensions.Utilities.setDataFromList = function (node, parentId, timeStamp, itemClicked) {
    var p = itemClicked.properties;

    if (!timeStamp || timeStamp > itemClicked.getTimeStamp()) {
        var tmp;
        if (tmp = node.getAttribute('Version')) {
            p.versionNumberString = tmp;
            p.previousVersion = tmp;
        }
        if (tmp = node.getAttribute('ModifiedBy')) {
            p.modifiedBy = tmp;
            p.initialModifierUserName = tmp;
        }
        if (tmp = node.getAttribute('LockedBy')) {
            p.lockedBy = tmp;
        }
        if (tmp = node.getAttribute('ApprovalStatus')) {
            p.approvalStatus = tmp;
            p.previousApprovalStatus = tmp;
        }
        if (tmp = node.getAttribute('PublishDate')) {
            p.publishDate = tmp;
        }
        if (p.customModifiedDate === undefined) {
            if (tmp = node.getAttribute('Modified')) {
                p.customModifiedDate = tmp;
            }
        }
    }
}

/*
* sends the list xml string for the item in the list view.
*/
MyCompany.Tridion.RTFExtensions.Utilities.getListItemXmlAttributes = function (customAttributes, listViewObject,attribs) {
    var p = listViewObject.properties;
    $extUtils.getListViewItemLockedByName(p,listViewObject);

    if (customAttributes) {
        for (var attr in customAttributes) {
            attribs[attr] = customAttributes[attr];
        }
    }

    attribs["Version"] = $extUtils.getListViewItemUpdatedVersion(p,listViewObject);
    //modified name has to come after the version update...
    $extUtils.getListViewItemModifiedByName(p,listViewObject);
    attribs["ApprovalStatus"] = $extUtils.getListViewItemApprovalStatus(p,listViewObject);  
    attribs["PublishDate"] = $extUtils.getListViewItemPublishDate(p,listViewObject);

    //set default values
    if (p.versionNumberString != undefined) {
        var iResult = p.versionNumberString.localeCompare(p.previousVersion);
        if (p.previousVersion === undefined || iResult > 0) {
            //it's been updated!
            p.previousVersion = p.versionNumberString;
            p.previousApprovalStatus = p.approvalStatus;

            //also need to update modified date
            p.customModifiedDate = $extUtils.getListViewItemUpdatedModifiedDate(p,listViewObject);
            p.initialModifierUserName = p.modifiedBy;
        }

    }
    attribs["Modified"] = p.customModifiedDate;
    attribs["LockedBy"] = p.lockedBy;
    attribs["ModifiedBy"] = p.modifiedBy;

};

/*
* This method sets the property of the Revisor owner on the item in the list view. however, if it's not the current user
* we have no way to look that up in JS so we have to reload the list view.
*/
MyCompany.Tridion.RTFExtensions.Utilities.getListViewItemModifiedByName = function (p,listViewObject) {
    var p = listViewObject.properties;
    var xmlDoc = listViewObject.getXmlDocument();
    if (xmlDoc) {
        //modifier should always exist...
        var modifierId = $xml.getInnerText(xmlDoc, "/tcm:*/tcm:Info/tcm:VersionInfo/tcm:Revisor/@xlink:title");
        if (modifierId != undefined) {
            var u = Tridion.UI.UserSettings.getJsonUserSettings(true);
            if (modifierId == u.User.Data.Name) {
                var strDescription = u.User.Data.Description.split('(');
                p.modifiedBy = strDescription[0];
                return;
            } else {
                //we're in trouble...
                //let's hope it's the initial modifier we had...
                if (p.previousVersion == p.versionNumberString) {
                    //whew...
                    p.modifiedBy = p.initialModifierUserName;
                    return;
                }

                if (!$extUtils.reloadListView(listViewObject.getOrganizationalItemId())) {
                    //hrm. something failed on the reload? not sure what else to do:
                    p.modifiedBy = modifierId;
                }
            }
        } else {
            //shouldn't ever happen.
            p.modifiedBy = "";
            return;
        }
    }

};

/*
* This method sets the property of the lock owner on the item in the list view. however, if it's not the current user
* we have no way to look that up in JS so we have to reload the list view.
*/
MyCompany.Tridion.RTFExtensions.Utilities.getListViewItemLockedByName = function (p,listViewObject) {
    var xmlDoc = listViewObject.getXmlDocument();
    if (xmlDoc) {
        //this will be user id. no sense getting tcmid... can't look it up without async call
        var lockedUserId = $xml.getInnerText(xmlDoc, "/tcm:*/tcm:Info/tcm:VersionInfo/tcm:ItemLock/tcm:User/@xlink:title");
        if (lockedUserId != undefined) {
            //see if it's the current user. most likely...
            var u = Tridion.UI.UserSettings.getJsonUserSettings(true);
            if (lockedUserId == u.User.Data.Name) {
                var strDescription = u.User.Data.Description.split('(');
                p.lockedBy = strDescription[0];
                return;
            }
            //it's not the current user. no synch way to do what we want, plus the JS call doesn't get the workflow version anyway. refresh the parent view
            if (!$extUtils.reloadListView(listViewObject.getOrganizationalItemId())) {
                //hrm. something failed on the reload? not sure what else to do:
                p.lockedBy = lockedUserId;
            }
        } else {
            //clear it out since there's no lock owner
            p.lockedBy = "";
        }
    }
};

/*
* Gets the ApprovalStatus from the item
* This makes absolutely no sense... but for some reason the approval status gets wiped out when this method
* enters. so I had to use a "previous approval status" variable to maintain it. no idea why. I don't see anything
* else that should be touching it... but clearly something clears it out.
*/
MyCompany.Tridion.RTFExtensions.Utilities.getListViewItemApprovalStatus = function (p,listViewObject) {
    //check if the item has actually been modified.
    if (p.versionNumberString != p.previousVersion) {
        var xmlDoc = listViewObject.getXmlDocument();
        if (xmlDoc) {
            p.approvalStatus = $xml.getInnerText(xmlDoc, "/tcm:*/tcm:Info/tcm:Data/tcm:ApprovalStatus/@xlink:title");
        }
    } else {
        p.approvalStatus = p.previousApprovalStatus;
    }
    if (p.approvalStatus === undefined || p.approvalStatus.toUpperCase() == 'UNAPPROVED') {
        var foo = p.approvalStatus;
        p.approvalStatus = 'WIP';
    }
    return p.approvalStatus;
};

/*
* Gets the PublishDate from the item list view
*/
MyCompany.Tridion.RTFExtensions.Utilities.getListViewItemPublishDate = function (p,listViewObject) {
    //modification won't alter publish date.
    var p = listViewObject.properties;
    return p.publishDate;
};

/*
*   get the modified date for the workflow version, overwrite OOB since that uses last major version
*/
MyCompany.Tridion.RTFExtensions.Utilities.getListViewItemUpdatedModifiedDate = function (p,listViewObject) {
    var xmlDoc = listViewObject.getXmlDocument();
    var modDate = $xml.getInnerText(xmlDoc, "/tcm:*/tcm:Info/tcm:VersionInfo/tcm:RevisionDate");
    return modDate;
}

/*
* Gets the updated Version information from the item
*/
MyCompany.Tridion.RTFExtensions.Utilities.getListViewItemUpdatedVersion = function (p,listViewObject) {
    var p = listViewObject.properties;
    var xmlDoc = listViewObject.getXmlDocument();
    var newVersionString = undefined;
    if (xmlDoc) {
        newVersionString = String.format("{0}.{1}", $xml.getInnerText(xmlDoc, "/tcm:*/tcm:Info/tcm:VersionInfo/tcm:Version"), $xml.getInnerText(xmlDoc, "/tcm:*/tcm:Info/tcm:VersionInfo/tcm:Revision"));
    }
    if (newVersionString != undefined) {
        //want to ensure we're getting a LATER version than we had (because it will try to load the non-workflow version afterwards...
        var iResult = newVersionString.localeCompare(p.previousVersion);
        if (p.previousVersion === undefined || iResult > 0) {
            p.versionNumberString = newVersionString;
        } else {
            p.versionNumberString = p.previousVersion;
        }
    } else {
        p.versionNumberString = p.previousVersion;
    }
    return p.versionNumberString;
};

function launchPopup(winURL, winName, winFeatures, winObj) {
    // this will hold our opened window
    var theWin;
    // first check to see if the window already exists
    if (winObj != null) {
        // the window has already been created, but did the user close it?
        // if so, then reopen it. Otherwise make it the active window.
        if (!winObj.closed) {
            winObj.focus();
            return winObj;
        }
        // otherwise fall through to the code below to re-open the window
    }
    // if we get here, then the window hasn't been created yet, or it
    // was closed by the user.
    theWin = window.open(winURL, winName, winFeatures);
    return theWin;
}

var $extUtils = MyCompany.Tridion.RTFExtensions.Utilities; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-05-13T05:48:01.510

> [异常...“组件返回失败代码：0x80004002 (NS_NOINTERFACE) [nsIWebProgress.DOMWindow]”

这意味着没有分配给[nsIWebProgress](https://developer.mozilla.org/en-US/docs/Mozilla/Tech/XPCOM/Reference/Interface/nsIWebProgress)对象的窗口。所以它无处显示数据。

> nsresult：“0x80004002（NS_NOINTERFACE）”位置：“JS 框架 :: chrome://browser/content/tabbrowser.xml :: :: line 545”数据：否]

这告诉您哪个文件与该错误相关联。以及它发生在哪条线路上。

***但真正的关键是 NS_NOINTERFACE 错误。这意味着该接口尚未注册。***

您正在使用`Type.enableInterface()`. 这是您在其他地方声明的自定义方法吗？我没看到。您可能想将其更改为`.registerInterface()`

请参阅此链接[Type Class](https://msdn.microsoft.com/en-us/library/vstudio/bb397568%28v=vs.100%29.aspx) 和 [Type.registerInterface()](https://msdn.microsoft.com/en-us/library/vstudio/bb397478(v=vs.100).aspx)

# c++ - 运行 .exe 时出错

> ID：11165203
> 
> 赞同：1
> 
> 时间：2012-06-22T22:59:04.200
> 
> 标签：c++, dll, mingw

我刚刚用 mingw 用 c++ 编写了一个相当长的应用程序，然后我把它交给了几个朋友尝试一下。当他们去执行 .exe 文件时，它出现了一个错误，上面写着：

> 程序无法启动，因为您的计算机中缺少 libgcc_s_dw2-1.dll。尝试重新安装程序以解决此问题

调试版本会出现此错误。使用发布版本进行编译会出现相同的错误，只是将“libgcc_s_dw2”替换为“libstdc++-6”。

我可以通过在 .exe 中包含 .dll 来解决这个问题，但是当我决定将它发布给更多普通观众时，我宁愿它是独立的。

我发现这个问题问了很多，但他们都说要添加`-static-libstdc++`到链接器选项中。

我正在使用 CodeBlocks 并去构建选项并将其放在与 MinGW 链接的同一位置。这不起作用，所以我尝试了它旁边的另一个框以获取其他选项，但这也不起作用。

我知道这可能是我想念的一件简单的事情，但我想不出任何地方可以放置它。

感谢您的帮助，并在此先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T23:26:05.780

我添加了选项`-static-libgcc`和链接器设置，如此[处](http://i.stack.imgur.com/7jw8C.jpg)`-static-libstdc++`所示（用空格分隔），它对我有用。

确保从 Build 菜单（或使用 Ctrl-F11）重新构建可执行文件，如果您只是在更改设置后尝试构建，CodeBlocks 将不会重新构建它。

# ruby - 红宝石管道操作员

> ID：11165205
> 
> 赞同：25
> 
> 时间：2012-06-22T22:59:33.583
> 
> 标签：ruby, operators, pipe

我是 ruby​​ 新手，我看到了这个代码片段

```
1|2 
```

它返回 3

`|`运营商实际上是做什么的？我似乎找不到任何关于它的文档。此外，在这种情况下，它是否被称为“管道”运算符？或者它被称为别的东西？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2014-04-22T11:33:49.200

这是一个按位运算符，它们直接使用值的二进制表示。

`|`意思是或。让我告诉你它是如何工作的。

`1|2 = 3` 幕后发生的事情是：

```
1 = 0001
2 = 0010
--------
3 = 0011 <- result 
```

另一个例子：

`10|2 = 10` 现在是二进制：

```
10 = 1010
2  = 0010
--------
10 = 1010 <- result 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-06-22T23:04:36.353

在 Ruby 中，“操作符”实际上是方法调用。它们由每个类定义。

1 和 2 是 Fixnum ，因此在`1|2`管道中执行“按位或”。

[红宝石文档](http://www.ruby-doc.org/core-1.9.3/Fixnum.html#method-i-7C)

[按位信息](https://developer.mozilla.org/en/JavaScript/Reference/Operators/Bitwise_Operators)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-22T23:03:31.357

它是按位或运算符。

[http://www.java2s.com/Code/Ruby/Language-Basics/dobitwiseoperationsinRuby.htm](http://www.java2s.com/Code/Ruby/Language-Basics/dobitwiseoperationsinRuby.htm)

# vba - 将 CSV 转换为使用 SSIS 分隔的 TAB

> ID：11165206
> 
> 赞同：1
> 
> 时间：2012-06-22T22:59:36.163
> 
> 标签：vba, csv, attributes, ssis, text-files

我需要从远程 FTP 站点下载多个 CSV 文件。我正在利用 SSIS，因为这是现场唯一可用的工具。我确实有下载所有文件的 FTP 脚本和一个允许我合并所有文件的 for each 循环。

我想将文件转换为制表符分隔的格式，以避免拆分字段的数据中出现逗号（或者如果有人有其他解决方案，我愿意听）。我有一个可以转换文件的 VB 脚本，但我想利用 ActiveX 脚本任务或脚本任务等任务在 SSIS 中运行脚本。如何插入/转换脚本以使用其中一项任务？下面是我用来转换文件的代码。

```
Dim objFSO, objFile, objFileTSV
Dim strLine, strNewLine, strNewText
Dim FileNameLength, LineLength, NewFileName, Linepos, Quote, QuoteCount, TotalFilesConverted

Set objFSO = CreateObject("scripting.filesystemobject")
strCurPath = objFSO.GetAbsolutePathName(".")
TotalFilesConverted = 0

For Each objFile In objFSO.getfolder(strCurPath).Files
    If UCase(Right(objFile.Name, 4)) = ".CSV" Then
        FileNameLength = Len(objFile.Name)-4
        NewFileName = Left(objFile.Name,FileNameLength) & ".tsv"
        Set objFile = objFSO.OpenTextFile(objFile, 1)

        Do Until objFile.AtEndOfStream
            strLine = objFile.ReadLine
            LineLength = Len(strLine)
            Linepos =1
            strNewLine =""
            Quote = False
            QuoteCount = 0

            Do While Linepos <= LineLength
                If mid(strLine, Linepos, 1) = "," and Not Quote Then 
                    strNewLine = strNewLine + vbTab
                    Quote = False
                Elseif mid(strLine, Linepos, 1) = Chr(34) Then
                    QuoteCount = QuoteCount +1
                    If QuoteCount =2 and Linepos <> LineLength Then
                        If mid(strLine, Linepos, 2) = Chr(34) & Chr(34) Then
                            strNewLine = strNewLine + Chr(34)
                            Linepos = Linepos +1
                            Quote = True
                            QuoteCount = 1
                        Else
                            Quote = False
                            QuoteCount = 0
                        End If
                    Else 
                        Quote = True
                    End If
                Else
                    strNewLine = strNewLine + Mid(strLine, Linepos, 1)
                End If
                Linepos = Linepos +1
            Loop
            strNewText = strNewText & strNewLine & vbCrLF
        Loop
        objFile.Close

        Set objFileTSV = objFSO.CreateTextFile(NewFileName)
        objFileTSV.WriteLine strNewText
        TotalFilesConverted = TotalFilesConverted +1
        strNewText = ""
        objFileTSV.Close

    End If
Next

MsgBox CStr(TotalFilesConverted) + " Files Converted from CSV to TSV." 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T19:51:38.440

由于 SSIS Script Task 对象为您提供了 C# 或 VB.NET 的选择，因此您可以找到很多关于如何解析 CSV 文件的代码想法（例如，请参阅[Parse Delimited CSV in .NET](https://stackoverflow.com/questions/736629/parse-delimited-csv-in-net)）。

此外，在 .NET 中循环文件系统非常容易：

```
For Each dirItem As String In System.IO.Directory.EnumerateFileSystemEntries(DirPath)
    ' Insert code here ...
Next 
```

希望有帮助！

# ruby - 仅当 object.id 与 Ruby 中数组中的任何 id 都不匹配时，才在数组中添加对象

> ID：11165219
> 
> 赞同：0
> 
> 时间：2012-06-22T23:01:36.930
> 
> 标签：ruby, arrays

我有一个对象数组，我想添加另一个对象，只要该属性`object.id`与我在数组中拥有的任何对象的 id 都不匹配。

我知道我可以通过数组检查一买一，但是在 Ruby 中有没有更简单的方法呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T23:03:59.287

```
array << foo unless array.any? { |e| e.id == foo.id } 
```

或者

```
array << foo unless array.map(&:id).include?(foo.id) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T23:22:28.623

我喜欢@Mori 的答案，但如果可能的话，您应该考虑一下哈希是否对您的问题没有意义。您是否需要根据 id 从数组中获取对象？如果是这样，您应该将其设为哈希。

然后你会做

`list[a.id] = a if list[a.id].nil?`

# java - 强制java重新编译坏类

> ID：11165226
> 
> 赞同：0
> 
> 时间：2012-06-22T23:02:24.197
> 
> 标签：java, compilation

我有一个 jar 文件，我需要对其进行一些小改动。我删除损坏的类文件并用 JAD 反编译它们。但是在我修复它们之后，我需要重新编译。当我重新编译时，我显然会出错，因为我只编辑一个文件。但我知道您可以将修改后的类文件注入到 jar 中。所以我的问题是：是否可以强制java简单地编译文件以便我可以重新插入它们？唯一的错误是找不到依赖项和包，但如果我把它放回罐子里，它会找到它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T23:09:14.527

您可以使用接口的实现和对象的组合来开发与添加更改相同的类。在它开发自定义类加载器以卸载旧类并加载新类之后。但这很难做到。

# c++ - ifstream::read 在 ASCII 26 处失败

> ID：11165228
> 
> 赞同：3
> 
> 时间：2012-06-22T23:02:36.863
> 
> 标签：c++, visual-studio-2010, visual-c++, ascii, visual-c++-2010

这个问题困扰我很久了。例如，代码

```
ifstream in;
char temp;
int a;

in.open ("Random.txt");

for (a = 0;a < 10000;a++)
    in.read (&temp, 1);

in.close (); 
```

工作正常，直到`ifstream`遇到替代字符（ASCII = 26）。然后，对于所有以下字符，`ifstream::read`给我`temp = -1`. 我真的不希望这种情况发生，而是希望它继续从文件中读取字符而不是`-1`. 我做错了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-22T23:08:52.590

您需要以二进制模式打开流。由于历史原因，Windows 上的文本模式会将 Control-Z (ASCII 26) 视为文件的结尾。

[我的这个较早的答案中](https://stackoverflow.com/a/405169/5987)有更多细节。

# php - PHP会话重命名问题

> ID：11165233
> 
> 赞同：0
> 
> 时间：2012-06-22T23:03:22.740
> 
> 标签：php

我有这个简单的问题。

我有这部分代码来设置我的会话：

```
if($count==1){
        // Register $myusername, $mypassword and redirect to file "admin.php"
        session_register("admin");
        session_register("password");
        $_SESSION['name']= $myusername;
        header("location:index.php");
    } 
```

这就是我放入每个文件以保护它的内容：

```
<?php
session_start(); //Start the session
define(ADMIN,$_SESSION['name']); //Get the user name from the previously registered super global variable
if(isset($_SESSION['admin'])){//If session not registered
header("location:login.php"); // Redirect to login.php page
}
else //Continue to current page
header( 'Content-Type: text/html; charset=utf-8' );
?> 
```

我需要更改会话名称，因为我已经有了这样的名称。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T23:21:37.977

首先，停止使用[session_register()](http://br.php.net/manual/en/function.session-register.php)函数，从 PHP 5.4.0 开始，它已被弃用和删除。

你应该像下面这样写第一部分：

```
if($count==1){
    // Register $myusername, $mypassword and redirect to file "admin.php"
    $_SESSION['admin']    = $admin;
    $_SESSION['password'] = $password;
    $_SESSION['name']     = $myusername;

    header("location: index.php");
} 
```

分析第二部分，`if/else`逻辑颠倒。这是正确的逻辑。

```
session_start(); //Start the session

//Get the user name from the previously registered super global variable
define(ADMIN, $_SESSION['name']); 

if( isset($_SESSION['admin']) )
{
    //Continue to current page
    header( 'Content-Type: text/html; charset=utf-8' );
}
else
{
    //If session not registered
    header("location:login.php"); // Redirect to login.php page
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T23:32:35.643

您可以通过将数组存储在以下位置来为同一浏览器创建两个会话的错觉`$_SESSION`：

```
$adminsession = array();
$adminsession['admin'] = ...;
$adminsession['name']  = ...;

$subadminsession = array();
$subadminsession['admin'] = ...;
$subadminsession['name']  = ...;

$_SESSION = array('adminsession'    => $adminsession,
                  'subadminsession' => $subadminsession); 
```

在下一页：

```
$adminsession    = $_SESSION['adminsession'];
$subadminsession = $_SESSION['subadminsession']; 
```

实际上，这只是一个会话，因为单个浏览器在任何时候只能向您的站点打开一个会话。

仔细想想为什么你认为你需要这个。这是可维护的吗？你的代码容易理解吗？也许您需要退后一步思考您的系统设计？

# c++ - C 风格字符串与库字符串性能

> ID：11165237
> 
> 赞同：2
> 
> 时间：2012-06-22T23:03:38.740
> 
> 标签：c++

# 问题

C 风格的字符串操作是否真的比库`string`类操作慢 5 倍，正如 C++ Primer，第 4 版让我相信的那样？

## 为什么这么问？

因为当我实际进行性能测试时，事实证明对于特定示例（书中使用的示例），C 风格的字符串大约快 50%。

* * *

# 设置

我正在阅读[C++ Primer, 4th Edition](https://rads.stackoverflow.com/amzn/click/com/0201721481)，其中（第 138 页）列出了以下代码：

```
//  C-style character string implementation
const char *pc = "a very long literal string";
const size_t  len = strlen(pc +1);    //  space to allocate

//  performance test on string allocation and copy
for (size_t ix = 0; ix != 1000000; ++ix) {
    char *pc2 = new char[len + 1];  //  allocate the space
    strcpy(pc2, pc);                //  do the copy
    if (strcmp(pc2, pc))            //  use the new string
        ;    //  do nothing
    delete [] pc2;                  //  free the memory
}

//  string implementation
string str("a very long literal string");

//  performance test on string allocation and copy
for(int ix = 0; ix != 1000000; ++ix) {
    string str2 = str;  //  do the copy, automatically allocated
    if (str != str2)    //  use the new string
        ;   //  do nothing
}    //  str2 is automatically freed 
```

现在请记住，**我在第 2 行知道**这一点`strlen(pc +1)`，并且第一个`for`使用`size_t`但不为数组下标，所以它可能是`int`，但这正是它在书中的写法。

当我测试这段代码（使用`strlen(pc) + 1`，我认为这是有意的）时，我的结果是第一个块的执行**速度比第二个块快约 50%**，这导致**C 风格的字符串比这个特定的库字符串类快例子**。

但是，我敢打赌，由于本书（第 139 页）中与上述代码相关的内容，我遗漏了一些东西（可能很明显）：

> 碰巧的是，平均而言，字符串类实现的执行速度比 C 风格的字符串函数快得多。我们超过五年的 PC 上的相对平均执行时间如下：

```
 user    0.47  # string class 
 user    2.55  # C-style character string 
```

那么是哪一个呢？我应该使用更长的字符串文字吗？也许是因为他们使用了 GNU C 编译器，而我使用了微软的编译器？是因为我有一台更快的电脑吗？

还是这本书只是错了？

### 编辑

Microsoft (R) 32 位 C/C++ 优化编译器版本 16.00.40219.01 用于 80x86

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-23T00:26:50.860

您的结论是 C 风格的字符串在这个示例中使用您的编译器和机器更快，几乎可以肯定是因为 - 必须假设 - 你

*   忘记开启优化，
*   忘记使编译器的字符串长度“未知”（这很棘手），以防止它优化`strlen`调用，并且
*   忘记并关闭会减慢速度的安全范围检查（如果适用）`std::string`。

这是我测试的代码：

```
#include <assert.h>
#include <iostream>
#include <time.h>
#include <string>
#include <string.h>
using namespace std;

extern void doNothing( char const* );

class StopWatch
{
private:
    clock_t     start_;
    clock_t     end_;
    bool        isRunning_;
public:
    void start()
    {
        assert( !isRunning_ );
        start_ = clock();
        end_ = 0;
        isRunning_ = true;
    }

    void stop()
    {
        if( isRunning_ )
        {
            end_ = clock();
            isRunning_ = false;
        }
    }

    double seconds() const
    {
        return double( end_ - start_ )/CLOCKS_PER_SEC;
    }

    StopWatch(): start_(), end_(), isRunning_() {}
};

inline void testCStr( int const argc, char const* const argv0 )
{
    //  C-style character string implementation
    //const char *pc = "a very long literal string";
    const char *pc = (argc == 10000? argv0 : "a very long literal string");
    //const size_t  len = strlen(pc +1);    //  space to allocate
    const size_t  len = strlen(pc)+1;    //  space to allocate

    //  performance test on string allocation and copy
    for (size_t ix = 0; ix != 1000000; ++ix) {
        char *pc2 = new char[len + 1];  //  allocate the space
        strcpy(pc2, pc);                //  do the copy
        if (strcmp(pc2, pc))            //  use the new string
            //;   //  do nothing
            doNothing( pc2 );
        delete [] pc2;                  //  free the memory
    }
}

inline void testCppStr( int const argc, char const* const argv0 )
{
    //  string implementation
    //string str("a very long literal string");
    string str( argc == 10000? argv0 : "a very long literal string" );

    //  performance test on string allocation and copy
    for(int ix = 0; ix != 1000000; ++ix) {
        string str2 = str;  //  do the copy, automatically allocated
        if (str != str2)    //  use the new string
            //;   //  do nothing
            doNothing( &str2[0] );
    }    //  str2 is automatically freed
}

int main( int argc, char* argv[] )
{
    StopWatch   timer;

    timer.start();  testCStr( argc, argv[0] );  timer.stop();
    cout << "C strings: " << timer.seconds() << " seconds." << endl;

    timer.start();  testCppStr( argc, argv[0] );  timer.stop();
    cout << "C++ strings: " << timer.seconds() << " seconds." << endl;
} 
```

典型结果：

```
[d:\开发\测试]
> g++ foo.cpp doNothing.cpp -O2

[d:\开发\测试]
> 一个
C 弦：0.417 秒。
C++ 字符串：0.084 秒。

[d:\开发\测试]
> 一个
C 弦：0.398 秒。
C++ 字符串：0.082 秒。

[d:\开发\测试]
> 一个
C弦：0.4秒。
C++ 字符串：0.083 秒。

[d:\开发\测试]
> _

```

也就是说，C++ 字符串通常不是最快的字符串实现。

通常，不可变字符串（引用计数）比 ​​C++ 字符串有很大的优势，当我了解到这一点时，令我惊讶的是，当它使用适当、快速的自定义分配器时，简单地复制字符串数据的字符串实现仍然更快。但是，不要问我如何实现后者。我只在另一个论坛上看到了代码和测试结果，在我在与 STL 的讨论中指出不可变字符串的一般优势并且存在一些分歧之后，有人慷慨地提供了这些结果。;-)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-22T23:27:06.943

首先：**这个问题没有明确的答案。**

原因是性能取决于库实现、编译器和您使用的选项、您使用的操作系统和您使用的 CPU 架构。

这本书有点旧（2005 年，硬件和软件已经发展），并且它的代码已经在旧编译器、旧实现和旧硬件上进行了测试。无论它对性能的评价是基于作者的观察结果，不同的人使用不同的编译器、库和硬件组合尝试代码肯定会有所不同。

你能做的最好的，就是尝试自己。像这样的简单“基准”并不能说明 C 风格字符串与*现实世界*`std::string`中的 s之间的性能，常见情况，除非它们提供尽可能多的方法来测试和比较性能的广泛覆盖——这将是一个相当大的项目本身。

 *请注意，编译器优化可能会使用本书中显示的代码来欺骗您。例如，由于空的`if`-blocks，整个`if`-statement 和其中的表达式（在这种情况下例如调用 strcpy）可以被删除（*）。使用书中给出的代码块来做有意义的、现实世界适用的基准测试是**非常困难的。**

另请注意，无论这些微基准测试的结果如何，仅适用于它们进行基准测试的操作 - 换句话说 - 只是因为字符串分配、复制和比较似乎使用任一或 C 样式字符串快*x*倍，`std::string`不代表对方一般比对方快*x*倍！

*：使用 GCC 4.7.1 测试了 C 风格的字符串代码，`-Ofast`并且在编译的可执行文件中没有引用`strcmp`，这表明字符串比较在代码中被消除为不必要的 - 它确实*是*- 因为`if`-block 是空的所以一开始就没有理由把整个都放在`if`那里！

添加我自己的观察：我将两段代码分解为不同的函数，然后对其中一个进行 100 次重复调用（使用`for`-loop），然后使用`time`unix-utility 测量运行时间。使用 GCC 4.7.1 和`-Ofast`.

100 次调用 C-Style 字符串函数大约需要 7.05 秒（3 次运行，变化在 7 和 7.1 秒之间），而 100 次调用 std::string 版本平均**只需要大约 1.4 秒超过 3 次运行！**事实上，这表明 std::string 远远优于 C 风格的字符串。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-07-11T14:57:15.717

这不是一个公平的比较，**std::string**可能会使用诸如*copy on write*之类的技术。鉴于您的计时结果，我猜**str2**根本没有创建副本，而是对**str**的引用，这不仅节省了分配和复制，而且还可能使比较成为*nop*。同样使用**strcpy()**也不是最理想的，因为它需要检查终止符。为了更诚实的比较，我建议进行以下修订：

```
#include <stdlib.h>
inline void testCStr(const int argc, const char* argv)
{
    const char* str = (argc == 10000) ? argv : "a very long literal string";
    size_t len = strlen(str);

    int i;
    for ( i = 0; i < 1000000; i++ )
     {
        char* dup = (char*) malloc(len + 1);
        memcpy(dup, str, len + 1);
        dup[0] = str[0]; /* keep things even. */
        if (strcmp(str, dup))
            doNothing(dup);
        free(dup);
     }
}

inline void testCppStr(const int argc, const char* argv)
{
    string str = (argc == 10000) ? argv : "a very long literal string";

    for ( int i = 0; i < 1000000; i++ )
     {
        string dup = str;
        dup[0] = str[0]; // force copy (defeats copy on write).
        if (str != dup)
           doNothing(dup.c_str());
     }
} 
```

C++ 接口非常精简和简单，很容易忽略*引擎盖下实际发生的*事情。现实情况是，如果两个代码序列以相对于语言的等效方式编写，则性能也应该大致相同。

*功能上等同*于原始**testCppStr()**的**testCStr** ()版本可以编写如下：

 ***```
#include <stdlib.h>
#include <string.h>

/* utility. */
static int strcmpx(const char* x, size_t xsize, const char* y, size_t ysize)
{
    int cmp = memcmp(x, y, xsize);
    if (cmp != 0)
        return cmp;
    return -(xsize < ysize);
}

/* mystring. */
typedef struct mystring {
    long* refcnt;
    char* cstr;
    size_t size;
} mystring;

/* mystring private. */
static inline int mystring_unique(const mystring* x)
{   return *x->refcnt == 1;
}

static inline void mystring_add_ref(const mystring* x)
{   ++*x->refcnt;
}

static void mystring_del_ref(mystring* x)
{
    int unique = mystring_unique(x);
    --*x->refcnt;

    if (unique)
        free(x->refcnt);
}

static void mystring_make_unique(mystring* x, const char* str, size_t size)
{
    void* base = malloc(size + 1 + sizeof (long));
    x->refcnt = (long*) base;
    *x->refcnt = 1;

    x->cstr = (char*) base + sizeof (long);
    memcpy(x->cstr, str, size + 1);
    x->size = size;
}

/* mystring public. */
void mystring_construct(mystring* x, const char* str)
{   mystring_make_unique(x, str, strlen(str));
}

void mystring_construct_copy(mystring* x, const mystring* src)
{
    mystring_add_ref(src);
    *x = *src;
}

void mystring_destroy(mystring* x)
{   mystring_del_ref(x);
}

int mystring_cmp(const mystring* x, const mystring* y)
{   return strcmpx(x->cstr, x->size, y->cstr, y->size);
}

const char* mystring_cstr(const mystring* x)
{   return x->cstr;
}

const char* mystring_at_const(const mystring* x, long i)
{   return x->cstr + i;
}

char* mystring_at(mystring* x, long i)
{
    if (!mystring_unique(x))
     {
        mystring save = *x;
        mystring_make_unique(x, x->cstr, x->size);
        mystring_del_ref(&save);
     }
    return x->cstr + i;
}

/* test case. */
void testCStr(const int argc, const char* argv)
{
#define ITERATIONS 1000000
    const char* temp = (argc == 10000) ? argv : "a very long literal string";
    mystring str;
    mystring_construct(&str, temp);

    int i;
    for ( i = 0; i < ITERATIONS; i++ )
     {
        mystring dup;
        mystring_construct_copy(&dup, &str);
#ifdef FORCE_COPY
        *mystring_at(&dup, 0) = *mystring_at_const(&str, 0);
#endif
        if (mystring_cmp(&str, &dup))
            doNothing(mystring_cstr(&dup));
        mystring_destroy(&dup);
     }
    mystring_destroy(&str);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-22T23:41:05.767

同意@zxcdw 所说的话，我想补充一下：

**`std::string`库应该（显着）慢于 C 风格的字符串并没有内在的原因。**

`std::string`实际上可能会做更多的工作，因为它可能会检查每个元素访问的边界（您应该能够使用编译时选项将其关闭）等等。实际上它可能做的工作更少，因为它知道长度（因此是字符串的结尾），并且在附加内容时不必搜索它。**所以你永远不知道（没有测量）。**

另一方面，了解更多意味着更大的内存占用（两个指针而不是一个），当您在短时间内处理大量不同的字符串对象时，这也会影响性能（由于更多的缓存未命中）。但我不认为这就是你的情况。****

# javascript - 如何使 JSON 数据只能由我的 java 脚本访问？

> ID：11165238
> 
> 赞同：2
> 
> 时间：2012-06-22T23:03:49.397
> 
> 标签：javascript, json, security

我正在设计一个需要将大量数据可视化为图表的 Web 应用程序。我发现了一些 javascript 库 [dynagraph] 可以做到这一点。但问题是，如果我使用 javascript 访问数据 [JSON 格式]，任何人都可以修改 javascript[使用 Google Chrome 中的“开发人员工具”等工具] 并获取数据！！那么，有没有办法阻止这种情况呢？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-22T23:08:45.773

答案是**否定**的。正如您所说，JavaScript 代码正在客户端运行，这意味着它可能访问的任何数据都将掌握在客户端手中。

您*可以*做的是将信息传递给将生成图表的服务器端脚本，然后仅将要显示的非私人信息发回给您。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T23:07:17.933

是的，不要使用 Javascript，而是使用一些服务器端工具。每当您使用数据客户端时，都可以读取您的数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T23:08:33.217

无论您使用什么技术，您传递给客户端的任何数据都可能在客户端上被篡改。

如果您接受来自客户的未经验证的输入，那么您就是在招惹麻烦。

您需要验证客户端在服务器端发回的数据，以确保这些值是合理的并与业务规则相匹配。

# objective-c - 从 NSNumbers 的 NSMutableArray 中删除 0

> ID：11165242
> 
> 赞同：1
> 
> 时间：2012-06-22T23:04:07.583
> 
> 标签：objective-c, nsmutablearray, nsnumber

我正在尝试扫描 NSMutableArray 并删除所有 0。（它们被包裹在 NSNumber 对象中）。我试图只使用 for 循环进行搜索，但我遇到了这样一个问题，即一旦我删除了一个对象，它就会导致未来迭代的索引越界问题。我想不出一个合乎逻辑的方法来轻松解决这个问题。

我目前的代码是这样的：

```
 for(int i =0; i < [array count]; i++)
{
    if(!abs([[array objectAtIndex: i] floatValue]) > 0.0)
    {
              [array removeObjectAtIndex: i];
    }
} 
```

有没有办法修复我的循环或使用特殊的方法/函数来消除所有的 0？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T23:35:52.993

当您使用 NSNumbers 时，有一个更优雅的选择：

```
[array removeObject:[NSNumber numberWithFloat:0.0f]]; 
```

就是这样，因为`removeObject:`删除了给定对象数组中的所有出现。对象的比较是基于`isEqual:`方法的，所以当涉及到 NSNumbers 时，它不是比较指针而是比较值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T23:11:38.253

我建议将 NSArray 的`filteredArrayUsingPredicate:`方法与一个简单的块一起使用，如下所示：

```
NSPredicate *notZero = [NSPredicate predicateWithBlock:
    ^BOOL(id evalObject,NSDictionary * options) {
        return [evalObject boolValue];
    }];
array = [array filteredArrayUsingPredicate:notZero]; 
```

块中的逻辑很简单，任何非零的浮点数都是真实的，因此通过了谓词。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-22T23:09:34.640

从另一端开始。

```
for (int i = array.count - 1; i >= 0; --i) {
    ... 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-22T23:27:27.537

类似于 ctrahey 的建议，但可能是一种更易读/更容易理解的方法，正在使用`[NSPredicate predicateWithFormat:]`：

```
NSPredicate *nonZero = [NSPredicate predicateWithFormat:@"SELF == %@", [NSNumber numberWithFloat:0.0]];
array = [array filteredArrayUsingPredicate:nonZero]; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-22T23:19:41.207

不要删除您正在迭代的数组中的项目。而是将它们添加到另一个数组中。然后删除它们。

```
NSMutableArray *array = [NSMutableArray arrayWithCapacity:myArray.count];

for (int i = 0; i < myArray.count ; i++){
    NSNumber *num = [myArray objectAtIndex:i];
    if (num.doubleValue == 0) [array addObject:num];
}

[myArray removeObjectsInArray:array]; 
```

# android - 有没有比使用 AndroidBitmap_xxx 函数更快的视频渲染解决方案？

> ID：11165244
> 
> 赞同：9
> 
> 时间：2012-06-22T23:04:43.347
> 
> 标签：android, opengl-es, bitmap, ffmpeg, rendering

在我的本机线程中，我让 FFMpeg 获取和解码帧，然后将它们放入队列中。

在Java方面，我有一个`GLSurfaceView`and from，`Renderer.onDrawFrame`我正在调用传递位图的本机代码（该位图我只创建一次，然后每次都传递它）。

在本机代码中，我获得了队列的头部，使用`AndroidBitmap_xxx`函数将数据复制到 java 位图，然后在 Java 端将该位图渲染为纹理。

我想知道有没有更快的方法来渲染视频？我应该完全在本机代码中完成吗，如果是，为什么它会更快？

**编辑：**我现在不将 RGB 帧像素复制到锁定的位图像素，而是将 YUV 帧直接解码为锁定的位图像素。这使得渲染速度明显更快（因为不再需要不需要的 memcpy）仍然存在问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T10:04:00.307

更改纹理中像素的最有效技术称为渲染到纹理，可以通过[FBO](http://www.opengl.org/wiki/Framebuffer_Object)在 OpenGL/OpenGL ES 中完成。在桌面 OpenGL 上，您可以使用像素缓冲区对象 ( [PBO](http://www.opengl.org/wiki/Pixel_Buffer_Object) ) 直接在 GPU 上操作像素数据（但 OpenGL ES 尚不支持此功能）。

在未扩展的 OpenGL 上，您可以更改系统内存中的像素，然后使用 glTexImage2D/glTexSubImage2D 更新纹理 - 但这是低效的最后解决方案，应尽可能避免。**glTexSubImage2D**通常更快，因为它只更新现有纹理内的像素，而 glTexImage2D 创建全新的纹理（作为一个好处，您可以更改纹理的大小和像素格式）。另一方面，glTexSubImage2D 只允许更新纹理的一部分。

您说您希望它与 OpenGL ES 一起使用，所以我建议执行以下步骤：

*   用 glTexSubImage2D() 替换 glTexImage2D() - 如果你获得足够的性能，就这样吧；
*   使用 FBO 和着色器实现渲染到纹理 - 重写代码需要更多的工作，但会提供更好的性能。

对于 FBO，代码可能如下所示：

```
// setup FBO
glGenFramebuffers( 1, &FFrameBuffer );
glBindFramebuffer( GL_FRAMEBUFFER, FFrameBuffer );
glFramebufferTexture2D( GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_TEXTURE_2D, YourTextureID, 0 );
glBindFramebuffer( GL_FRAMEBUFFER, 0 );

// render to FBO
glBindFramebuffer( GL_FRAMEBUFFER, FFrameBuffer );
glViewport( 0, 0, YourTextureWidth, YourTextureHeight );
your rendering code goes here - it will draw directly into the texture
glBindFramebuffer( GL_FRAMEBUFFER, 0 );

// cleanup
glBindFramebuffer( GL_FRAMEBUFFER, 0 );
glDeleteFramebuffers( 1, &FFrameBuffer ); 
```

请记住，并非所有像素格式都可以渲染。RGB/RGBA 通常没问题。

# java - 在 Java 中退出时删除目录

> ID：11165253
> 
> 赞同：15
> 
> 时间：2012-06-22T23:06:57.080
> 
> 标签：java, directory

我只是想知道在应用程序关闭时是否可以删除目录？

当应用程序关闭时，有没有一种简单的方法可以做某事？

目前我的应用程序在运行时下载类文件，所以我真正想要的是从客户端系统中删除它们。

到目前为止我已经尝试过

```
File directory = new File("macros/bin/");
directory.deleteOnExit(); 
```

以及在运行时删除下载的启动文件（显然无法完成，因为它需要它们才能运行）。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-06-22T23:12:20.813

你可以试试这个：

```
Runtime.getRuntime().addShutdownHook(new Thread() {

      @Override
      public void run() {
        /* Delete your file here. */
      }
 }); 
```

很大程度上取决于您的程序如何结束。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2016-02-04T22:32:07.317

您应该使用[Apache Commons IO](https://commons.apache.org/proper/commons-io/apidocs/org/apache/commons/io/FileUtils.html)执行以下操作：

```
Runtime.getRuntime().addShutdownHook(new Thread(() -> FileUtils.deleteQuietly(fileOrDir))); 
```

注意： FileUtils.forceDeleteOnExit 实现是有缺陷的：它在注册目录的过程中注册要删除的文件，因此如果稍后添加文件，它将无法删除目录。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-06-23T01:06:28.203

只是为了记录，javadoc说`directory.deleteOnExit()`应该可以工作......该方法应该适用于目录。但是，方法可能会失败，因为该目录在尝试删除它时不为空......并且操作系统通常不会让您删除非空目录。

解决方案是调用`deleteOnExit()`用户下载的文件。您必须在通话*后执行此操作。*`directory.deleteOnExit()`请参阅 javadoc 了解原因。

话虽如此，显式关闭挂钩是一种更强大的方法。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-08-27T13:21:51.003

你可以使用这个：`org.apache.commons.io.FileUtils.forceDeleteOnExit(File)`

```
/*
 * Schedules a file to be deleted when JVM exits.
 * If file is directory delete it and all sub-directories.
 */
FileUtils.forceDeleteOnExit(File) 
```

**限制：**不幸的是，这仅在调用
后没有在目录内创建其他文件和/或文件夹时才有效。`forceDeleteOnExit`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-07-02T06:25:05.400

这对我有用。一个递归函数。

```
public static void makeVolatile(File folder)
{
    folder.deleteOnExit();
    for(File f : folder.listFiles())
    {
        if(f.isDirectory())
            makeVolatile(f);
        else
            f.deleteOnExit();
    }
} 
```

# jquery - 如果复选框未选中禁用上传按钮

> ID：11165254
> 
> 赞同：2
> 
> 时间：2012-06-22T23:07:02.207
> 
> 标签：jquery

我正在使用值文件上传器。但我想启动一个复选框，如果用户没有选中它，则禁用上传按钮。

我可以让它以常规形式工作，但不使用值，因为我认为，他使用 div 元素作为表单属性。所以我猜我把我的代码搞砸了。

在html中我有：

```
<form class="well">
<label>Upload a Single File</label>
<label class="checkbox">
<input id="tos" onclick="if(this.checked){this.form.qq-upload-button.disabled=false}else{this.form.qq-upload-button.disabled=true};this.blur();" checked="" value="1" name="tos" type="checkbox"> I have read and agree to the <a href="/tos">TOS</a>
</label>
<div id="file-uploader-demo1">      
    <noscript>          
        <p>Please enable JavaScript to use file uploader.</p>
        <!-- or put a simple form for upload here -->
    </noscript>         
</div>
</form> 
```

在 fileuploader.js （我有 valums 代码）

```
template:   '<div class="qq-uploader">' + 
            '<div class="qq-upload-drop-area"><span>Drop files here to upload</span></div>' +
            '<div class="qq-upload-button btn btn-primary left">Upload a file</div><span class="help-inline">&nbsp;Lets Do it!</span>' +
            '<ul class="qq-upload-list"></ul>' + 
            '</div>', 
```

你能看出我弄错了什么吗？

本质上，如果用户没有选中该复选框，我希望禁用上传按钮。

对于常规形式，此代码有效：

```
<form class="well">
  <label>Upload a Single File</label>
  <input type="file" class="span3" placeholder="Click Here">
  <span class="help-inline">Associated help text!</span>
  <label class="checkbox">
  <input id="tos" onclick="if(this.checked){this.form.btn.disabled=false}else{this.form.btn.disabled=true};this.blur();" checked="" value="1" name="tos" type="checkbox"> I have read and agree to the <a href="/tos">TOS</a>
  </label>
  <input name="btn" type="submit" class="btn btn-primary left" value="UPLOAD">
</form> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-22T23:08:42.323

删除内联`onclick`处理程序并添加以下 JavaScript 代码：

```
$('#tos').on('change', function() {
    $('.qq-upload-button').prop('disabled', !this.checked);
}); 
```

这会将“禁用”状态与复选框的否定“选中”状态同步。

您的原始代码不起作用的原因`this.form.qq-upload-button`是无效的 JavaScript。你必须`this.form['qq-upload-button']`改用。但是，使用我上面发布的代码要干净**得多。**

# html - 屏幕尺寸 > 容器尺寸时出现奇怪的宽度问题

> ID：11165256
> 
> 赞同：0
> 
> 时间：2012-06-22T23:07:13.503
> 
> 标签：html, css, width, margin

我创建了一个网页，页面顶部有两个栏（用于导航和 Twitter 更新）。我如何做到这一点是通过为每个栏创建两个 div，一个 div 在另一个里面。这样做的原因是因为我希望栏在整个页面上缩放，但内容限制在固定宽度。

现在这“正常”工作正常，但是当浏览器屏幕宽度小于子 div 宽度时，它会溢出到父 div 之外。

我在这里有一个页面的现场演示：http: [//tinyurl.com/7qj3pzs](http://tinyurl.com/7qj3pzs)

编辑：我已将 min-width 添加到父 div，似乎已解决问题：D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T23:10:37.213

在父 div 上，您需要设置以下 CSS：

```
#parentDiv {
    overflow: hidden;
} 
```

假设这是 HTML：

```
<div id="parentDiv">
   <div id="childDiv"></div>
</div> 
```

我还碰巧注意到，在“图表”部分，您将一堆 JQuery 动画弹出到动画队列中。如果您像这样将方法链接到动画中，它将防止动画超载队列和动画，即使在鼠标消失后也是`.stop()`如此：

```
$('a').stop().animate(); 
```

# visual-studio-2012 - 在 VS11 中附加到 w3wp.exe 的键盘快捷键

> ID：11165258
> 
> 赞同：40
> 
> 时间：2012-06-22T23:07:22.207
> 
> 标签：visual-studio-2012

由于[VS11 删除了宏](http://www.infoq.com/news/2011/10/VS-Macros)，我无法再使用键盘快捷键触发[此宏以附加到网络服务器。](http://geekswithblogs.net/SoftwareDoneRight/archive/2009/10/30/quicktip--attach-the-vs-debugger-to-iisrsquos-worker-process.aspx)

在 VisualStudio 2012 中是否有另一种方法可以启动调试器并使用键盘快捷键附加到特定进程？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-08-21T09:54:43.927

安装[AttachTo](http://visualstudiogallery.msdn.microsoft.com/d0265ab0-df51-4100-8e10-1f84403c4cd0?SRC=VSIDE)扩展，并将快捷键绑定到 Tools.AttachToIIS。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2012-06-22T23:12:22.857

如果您在项目属性中选中该框，Visual Studio 中的调试器会自动附加到 Web 服务器。为此，从来不需要宏。

在项目属性的“Web”选项卡上，选中 Visual Studio 中的“使用本地 IIS Web 服务器”框。然后选中底部的“调试器”下的“ASP.NET”框

要调试，只需按 F5。

**编辑**

要让 F5 简单地附加到 w3wp.exe ...

确保您将 Web 项目设置为 StartUp 项目 ![在此处输入图像描述](../Images/40a2ce65631362dae572320403eca10f.png)

在该 Web 项目的设置 Web 选项卡上，只需选择“使用本地 IIS Web 服务器”并输入您用于访问您的站点的 URL（该 URL 仅在您将“开始操作”保留在“当前页面”上时才重要）。我不喜欢启动浏览器，因为我很有可能实际上在项目的另一个站点上。但很棒的是，一旦它附加到 w3wp.exe，它就会调试任何站点。 ![在此处输入图像描述](../Images/346ca5a9bbb965fa8d29337e49ea89ee.png)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-08-20T20:59:01.060

针对 Cory 的回答，您无需创建自己的快捷方式。CTRL+ALT+P 打开附加到进程对话框，然后您可以使用他的建议并键入“w”在列表中查找 IIS 进程。

如果您正在远程调试并且因此没有要自动附加到的本地进程，这也很有用。

如果您在本地计算机上使用 IIS，则可以在项目属性的“Web”选项卡中将其设置为本地 IIS Web 服务器或自定义 Web 服务器。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-01-30T08:26:41.770

遗憾的是宏在 VS 2012 中被删除，但你可以使用热键 :)

Ctrl+Alt+P 按 w （应该找到第一个在 99% 中是 w3wp 的） 按 Enter 确定

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-06-22T23:15:35.057

在 VS12 中，我只是添加了自己的快捷方式，因为默认设置似乎不存在。

CRTL+Shift+ALT+D

对于网络应用程序，我通常使用 aw 并输入。输入是你右手小指的大钥匙。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-12-20T10:42:53.373

由于vs 2015 不支持[AttachTo](https://visualstudiogallery.msdn.microsoft.com/d0265ab0-df51-4100-8e10-1f84403c4cd0?SRC=VSIDE)扩展，我建议另一个：[ReAttach](https://visualstudiogallery.msdn.microsoft.com/8cccc206-b9de-42ef-8f5a-160ad0f017ae)。

# excel - 编写 VBA 代码时的光标移动

> ID：11165260
> 
> 赞同：1
> 
> 时间：2012-06-22T23:08:12.303
> 
> 标签：excel, vba

我正面临一个非常令人沮丧的情况，我正在用 excel 编写一些 VBA 代码，并且光标不断向左移动一个空格，直到我写的任何单词。我似乎无法控制它。当我继续编写代码时，光标不断向后移动 1 个空格，这一切都变成了一个长字。我必须手动转到代码并用空格分隔代码。

这是 MS Excel 2010 中的错误吗？有什么解决办法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-24T03:14:57.227

好的，我找到了答案。

1.单击 Microsoft Office 按钮，然后单击 Excel 选项
2.单击加载项类别
3.在管理框中，单击 COM 加载项，然后单击执行。
4.寻找一个名为“负载测试报告插件”的插件，然后取消选中它
5.restart excel [https://stackoverflow.com/a/2552264/475709](https://stackoverflow.com/a/2552264/475709)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-11-12T23:48:49.907

我在 Excel 365 for Mac (v16.54) 上遇到了这个问题。

我发现关闭自动保存是解决方案。感谢 redOctober13 在另一个线程中提醒我解决方案。 [VBA 编辑器自动删除行尾的空格](https://stackoverflow.com/questions/1164138/vba-editor-auto-deletes-spaces-at-the-ends-of-lines?answertab=active#tab-top)

# django - 带有锚点（#）参数的 Django 重定向（）

> ID：11165267
> 
> 赞同：18
> 
> 时间：2012-06-22T23:08:51.067
> 
> 标签：django

我目前正在使用 Django 的 redirect() 方法来构造要重定向到的 URL。我不想对 URL 进行硬编码，所以我一直在这样做：

```
return redirect('main.views.home', home_slug=slug) 
```

这让我想到了这样的事情：

/home/test-123/

但是我正在为特定的 URL 添加一些客户端跟踪，所以我想在最后使用锚来识别像这样的首次用户访问这样的事情：

/home/test-123/#first

如果没有在 redirect() 方法中对上述 URL 进行硬编码，是否有更优雅的替代方法将锚附加到我构建的 URL 的末尾？

谢谢，G

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-06-23T04:27:27.583

`redirect()` [接受 URL](https://docs.djangoproject.com/en/dev/topics/http/shortcuts/#redirect)，您可以`reverse()` [用来获取一个](https://docs.djangoproject.com/en/dev/topics/http/urls/#django.core.urlresolvers.reverse)并附加哈希部分：

```
from django.core.urlresolvers import reverse

return redirect(reverse('main.views.home', kwargs={'home_slug':slug}) + '#first')
# or string formatting
return redirect('{}#first'.format(reverse('main.views.home', kwargs={'home_slug':slug}))) 
```

此外，还有一个快捷方式`django.shortcuts.resolve_url`，其工作方式如下：

```
'{}#first'.format(resolve_url('main.views.home', home_slug=slug)) 
```

**编辑****Django 2.0**，使用： `from django.urls import reverse`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-03-01T03:41:58.500

*[仅在 Django 1.8 之前工作，在 Django 1.9+ 中不起作用，请参阅评论！]*

您可以在 urls.py 的正则表达式中添加一个锚点。这是来自示例论坛应用程序的示例，它将跳转到线程中所需的帖子。

**视图.py**

```
return redirect(post_list, 
    slug=post.thread.slug, 
    page=1, 
    anchor='post_{0}'.format(post.id)
) 
```

**网址.py**

```
url(r'^thread/(?P<slug>[-\w]+)/(?P<page>[0-9]+)/#(?P<anchor>[-_\w]+)$', post_list, name='forum_view_thread'),
url(r'^thread/(?P<slug>[-\w]+)/(?P<page>[0-9]+)/$', post_list, name='forum_view_thread'),
url(r'^thread/(?P<slug>[-\w]+)/$', post_list, name='forum_view_thread'), 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-27T12:55:59.933

只需使用：

```
url(r'^app/#/welcome/$', SomeView.as_view(), name='welcome'),

from django.utils.encoding import uri_to_iri
uri_to_iri(urlresolvers.reverse('welcome')) 
```

# ruby - 用于分组符号的 Ruby 习语

> ID：11165270
> 
> 赞同：0
> 
> 时间：2012-06-22T23:08:54.907
> 
> 标签：ruby, module, symbols

我正在阅读一些关于 ruby​​ 中符号的示例，其中一个示例是使用符号来表示州名，例如`:Montana`

但是，来自 Java，我通常会在这里使用枚举。我喜欢枚举的地方在于你可以对它们进行分组，所以我可以执行以下操作：

枚举州{蒙大拿州，明尼苏达州，...}

然后在Java代码中我可以调用

```
States.Montana 
```

是否有一种合乎逻辑的方法来对 ruby​​ 中的相关符号进行分组？创建一个包含符号的模块是否有意义？还是在 ruby​​ 中有更惯用的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T23:16:54.587

您可能希望为此使用模块。

```
module States
    MN = "Minnesota"
    WI = "Wisconsin"
end

puts States::MN #=> "Minnesota" 
```

附带说明一下，Ruby 中的“符号”通常指的是[Symbol 类](http://ruby-doc.org/core-1.9.3/Symbol.html)，它有点像一个内部字符串。你写一个像`:my_symbol`. 它们通常用作`HashMap`s* 中的键。

`Hash`*不应该`HashMap`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T23:40:00.420

I'd use an array of symbols or strings:

```
states = [:Montana, :Minnesota, ...]

states.each { |s| puts s }   # print one state each line
puts *states                 # another way to do the same 
```

For that example is worth to say that `puts` converts the argument(s) into string(s); so you can safely use symbols with it. I think the symbols are more useful if you don't intend display or manipulate them; else you may want to use strings.

A case where symbols are useful is for indexing a `Hash`:

```
states = { :montana => 'beautiful', :minnesota => 'wonderful', ... }
puts states[:washington] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T23:11:21.243

这样做的惯用方法是使用原始符号。只需传递名称的符号，用于`downcase`允许一些灵活性（可选）并根据有效符号列表验证符号（可选）。

# casting - 带 ISNULL 的 SQL 查询不会将 smalldatetime 输出为 101 格式

> ID：11165277
> 
> 赞同：0
> 
> 时间：2012-06-22T23:09:52.890
> 
> 标签：casting, sql-server-2008-r2, isnull, smalldatetime

来自 SQL 查询的片段（使用 SQL Server 2008 R2）：

```
, CONVERT (VARCHAR(10), s.ENTER_DATE, 101) "Enrollment Start Date"

, CONVERT (VARCHAR(10), (ISNULL(CAST(s.LEAVE_DATE AS VARCHAR(10)), '')) ,101) "Enrollment Drop Date" 
```

顶行可以很好地将日期输出为正确的 101 格式（例如：）`06/22/2012`。

底线可以根据需要将任何 NULL 值删除为空白，**但是**......对于任何日期值，它不会将该日期输出为正确的 101 格式，而是以默认格式输出日期（例如：2012 年 6 月 22 日）。

我玩过代码并在网上搜索过，但我无法得到想要的结果。

任何人都可以提出解决方案吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T23:36:00.233

您的第二个表达式的计算结果如下：

1.  A `date`or`datetime`值被转换为字符串（使用`CAST()`）

2.  `ISNULL()`如果不为 NULL，则应用它返回相同的结果（相同的字符串）。

3.  该字符串被转换为...一个字符串（使用`CONVERT()`这个时间）。

因此，如您所见，由于最内部的转换，您会得到格式错误的日期。

`ISNULL`我认为你只需要以不同的方式申请。大概是这样的：

```
ISNULL(CONVERT (VARCHAR(10), s.ENTER_DATE, 101), '') "Enrollment Start Date" 
```

# ios - NSDateFormatter iOS，日期模式

> ID：11165284
> 
> 赞同：2
> 
> 时间：2012-06-22T23:11:13.903
> 
> 标签：ios, date, formatter

我只是不知道如何设置 NSDateFormatter 日期格式，所以 [formatter dateWithString:] 不返回零。

日期如下所示：

> 2008-08-18T14:32:22.1875000+01:00

我试过

```
formatter setDateFormat:@"yyyy-MM-ddTHH:mm:ss.fffffffzz+GMT"]; 
```

似乎不起作用:(。任何建议，请帮助。

好的，感谢您的回答，似乎我的问题有点误导了人们，所以我尝试重新措辞，对此感到抱歉，也许编程有点晚了。我需要一个日期包装对象，因此我不必自己解析包含日期的字符串。基本上，我从需要解析的数据库中获取一个字符串，以便可以在我的 UI 中使用它。

```
NSDateFormatter *formatter = [[NSDateFormatter alloc] init];    
formatter.dateFormat = @"yyyy-MM-dd'T'HH:mm:ss.SSSSSSSZZZZ";
formatter.locale = [[NSLocale alloc] initWithLocaleIdentifier:@"en_US_POSIX"];
NSDate *date = [formatter dateFromString:@"2008-08-18T14:32:22.1875000+01:00"];
NSLog(@"%@", date); 
```

打印为零

我想要的是 NSString->NSDat，所以我可以问它包含什么月份，或者它包含什么时间。我现在看到 NSDate 没有这种方法。假设这是一件愚蠢的事情。现在有什么想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-22T23:43:45.077

根据[unicode 文档](http://unicode.org/reports/tr35/tr35-6.html#Date_Format_Patterns)，没有*f*。假设你想要亚秒，那应该是*S*。如果要按字面意思传输，还需要将*T*放在引号中。我认为您也对*z*感到困惑，并且可能想要*ZZZZ*而不是*zz+GMT*。所以：

```
NSDateFormatter *formatter = [[[NSDateFormatter alloc] init] autorelease];
formatter.dateFormat = @"yyyy-MM-dd'T'HH:mm:ss.SSSSSSSZZZZ";
NSLog(@"%@", [formatter stringFromDate:[NSDate date]]); 
```

根据[QA1480](http://developer.apple.com/library/ios/#qa/qa1480/_index.html)`en_US_POSIX` ，如果您想生成用于存储的技术字符串，您可能还需要明确设置 的语言环境。假设您要显示字符串，它保留根据当前语言环境调整您请求的字段的权利。所以那是：

```
NSDateFormatter *formatter = [[[NSDateFormatter alloc] init] autorelease];
formatter.locale = [[[NSLocale alloc] initWithLocaleIdentifier:@"en_US_POSIX"] autorelease];
formatter.dateFormat = @"yyyy-MM-dd'T'HH:mm:ss.SSSSSSSZZZZ";
NSLog(@"%@", [formatter stringFromDate:[NSDate date]]); 
```

根据 ctrahey 的回答，这并不能完全得到您想要的格式，例如

```
012-06-22T16:44:32.9310000GMT-07:00 
```

即字母“GMT”已经爬到那里。切换到单个 Z 摆脱了对 GMT 的显式引用，但也删除了冒号。

编辑：根据您的示例代码：

```
NSDateFormatter *formatter = [[NSDateFormatter alloc] init];    
formatter.dateFormat = @"yyyy-MM-dd'T'HH:mm:ss.SSSSSSSZZZZ";
formatter.locale = [[NSLocale alloc] initWithLocaleIdentifier:@"en_US_POSIX"];
NSDate *date = [formatter dateFromString:@"2008-08-18T14:32:22.1875000+01:00"];
NSLog(@"%@", date); 
```

失败是因为您的输入字符串与提供的日期格式不匹配——它在 +01:00 之前缺少字母 GMT。由于似乎没有与数据库中的内容完全匹配的 unicode 日期字符串，因此最简单的方法可能就是删除冒号。例如

```
NSDateFormatter *formatter = [[NSDateFormatter alloc] init];    
formatter.dateFormat = @"yyyy-MM-dd'T'HHmmss.SSSSSSSZ";
formatter.locale = [[NSLocale alloc] initWithLocaleIdentifier:@"en_US_POSIX"];
NSString *sourceString = @"2008-08-18T14:32:22.1875000+01:00";
NSDate *date = [formatter dateFromString:[sourceString stringByReplacingOccurrencesOfString:@":" withString:@""]];
NSLog(@"%@", date); 
```

对我来说，输出`2008-08-18 13:32:22 +0000`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T23:43:58.180

我能得到的最接近的只是在接近末端的区域偏移中去掉冒号：

```
[formatter setDateFormat:@"yyyy-MM-dd'T'HH:mm:ss.SSSSSSSZ"]; 
```

看起来像这样：2012-06-22T16:40:46.6290000-0700

我使用的文档[在这里](http://unicode.org/reports/tr35/tr35-10.html#Date_Format_Patterns)，[从 Apple链接](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/DataFormatting/Articles/dfDateFormatting10_4.html)

# excel - 宏不删除所有符合要求的项目

> ID：11165287
> 
> 赞同：1
> 
> 时间：2012-06-22T23:11:23.140
> 
> 标签：excel, vba

我写了这个非常简单的宏来删除当 P 列有“1”或“0”并且 L 列包含“假”时的所有行。无论出于何种原因，它似乎都没有连续运行。我必须一遍又一遍地重复运行宏来删除所有内容。

```
 Sub Delete_rows()

    Dim Pcell As Range
    Dim LastPCell As Long
    Range("P2", Range("P65000").End(xlUp)).Name = "LastPCell"

    For Each Pcell In Range("LastPCell")
    If Pcell <= 1 And Pcell.Offset(0, -4) = "False" Then Pcell.Offset(0, 4).EntireRow.Delete
    Next Pcell

    End Sub 
```

只有大约 10,000 行，所以范围大小应该没问题。

在这一点上我有点傻眼，我一直无法解决它。有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T23:43:38.073

扩展@bernie的答案

```
Sub Delete_rows()
Dim lastCell As Long, i As Integer, Pcell As Range
lastCell = ActiveSheet.Range("P65000").End(xlUp).Row

For i = lastCell To 2 Step -1
Set Pcell = ActiveSheet.Cells(i, 16)
    If Pcell <= 1 And Pcell.Offset(0, -4) = "False" Then
        Pcell.Offset(0, 4).EntireRow.Delete
    End If
Next i

End Sub 
```

# c# - Windows 窗体数据绑定 - 在将数据交给控制之前对其进行操作

> ID：11165288
> 
> 赞同：0
> 
> 时间：2012-06-22T23:11:25.907
> 
> 标签：c#, sql-server, database, winforms, data-binding

我正在尝试编写一个软件，它将从 MSSQL 数据库中获取值并将其放入 DataGridView，Visual Studio 的数据绑定功能非常适合。问题是我想在数据库中的信息到达控件之前对其进行格式化/操作。

例如，在一个数据库表中，我有一个名为 UserTypeID 的条目，其中包含整数，而另一个表将 UserTypeID 映射为字符串 UserType，例如“Admin”、“Operator”、“Guest”等。我希望能够获取来自第一个表的 UserTypeID，通过第二个表将其转换为等效的字符串，然后将结果传递给 DataGridView。

有没有一种相当简单的方法可以做到这一点，或者需要一个中间对象或其他什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T23:42:19.407

You can do what @Tyrsius suggested. But,if you are using a collection of objects as your datasource, you can do the manipulations in the GET method for that property. Thats what I would do!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T23:43:40.500

if the strings are static (will not add / delete by the user ) then the easiest way is to create a List<> or an array for the strings and a small extension method like this

```
string[] m = new string[] { "Guest", "Admin", "Operator", "Unit Manager", "User" }

/// <summary>
/// 
/// </summary>
/// <param name="m">the string array which searches for the integer criteria.</param>
/// <param name="s"> the int32 number which will pass to the index of the array </param>
/// <returns></returns>
public static string IntToString( this string S, string[] m, int s)
{
    string z = m.ElementAt(s);
    //Array.Clear(m, 0, m.Length);

    /// if you will need to clear the string array elements each using of this method then delete the comment slashes in front of the Array.Clear() method

   /// in Array.Clear method also -to depends of your need- you can disable to show the
   /// Array elements.. May be you will need only 1 admin and if an admin chooosen you can delete this option by changing the parameters of Array.Clear() Method

    return z;
} 
```

and a simple usage example in a Data Access Layer class :

```
string g;

if (dataReader["yourIntValueFromTable"] != DBNull.Value)
{                           
   yourClassObject.yourIntValueFromTable = (int)dataReader["yourIntValueFromTable"]; 

   yourClassObject.yourStringValue = g.IntToString(m, ((int)dataReader["yourIntValueFromTable"]));

} 
```

after fill this class you can set as datasource to wherever you want.

but, if your strings are dynamic then you need to create a Stored Proc and call your values from there

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-22T23:36:32.467

From your SQL perform the necessary join and include the necessary columns in the returned result

```
SELECT u.userID, u.userName, u.userTypeID, ut.userTypeName
FROM Users u
JOIN UserType ut ON u.userTypeID = ut.userTypeID 
```

That gives you the extra columns you need in the datagridview. If you are using DataTable this would be easy as it can contain variable number of columns. Just bing the datatable to your datagridview

For collection of objects, you will have extra properties:

```
class User
{
    int UserTypeId { get; set; }
    string UserTypeName { get; set; } // this could also be readonly depending on how you want it set
} 
```

# c# - 从 VS2010 DSL 项目生成完整的 XSD 文件

> ID：11165291
> 
> 赞同：0
> 
> 时间：2012-06-22T23:11:43.463
> 
> 标签：c#, visual-studio-2010, c#-4.0, xsd, dsl

我想在 Visual Studio 之外运行的程​​序中读取由 Visual Studio 2010 DSL 项目生成的 XML 模型文件。我计划使用 xsd.exe 根据 Dsl\DomainSchema.tt 模板输出的 XML 模式生成 C# 类。但是，此模板生成的 XSD 文件缺少 .dsl 文件中存在的许多类型。

这是一个错误，还是我需要做一些特别的事情来确保所有类型都包含在生成的模式中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T04:44:42.193

运行 Visual Studio 2010 CMD 并检查`xsd /?`您可以看到该选项的`type`选项，默认情况下它正在查看程序集中的所有类型：

```
/type:<type>
    Type from assembly to generate schema for. Multiple types may be provided.
    If no types are provided, then schemas for all types in an assembly
    are generated. Short form is '/t:'. 
```

# java - 完全由 Ajax 驱动的 JSP Web 应用程序？里面的模板/骨架..有什么缺陷吗？

> ID：11165294
> 
> 赞同：1
> 
> 时间：2012-06-22T23:12:11.773
> 
> 标签：java, ajax, jsp, jsf, jakarta-ee

我曾想过创建一个完全由 ajax 驱动的 Webapp。绝对不应该有提交/整页重新加载。

通过检查 bean 中的用户/密码并设置适当的重定向来完成登录

```
<html xmlns="http://www.w3.org/1999/xhtml"
xmlns:h="http://java.sun.com/jsf/html"
xmlns:f="http://java.sun.com/jsf/core"
xmlns:ui="http://java.sun.com/jsf/facelets"
xmlns:p="http://primefaces.org/ui">
<h:head>
<style>
.ui-widget {
font-size: 12px !important;
}
</style>

<title>myApp</title>
</h:head>
<h:body>
<h:form id="mainform">

    <ui:include src="#{navigationBean.currentPage}" />

</h:form>
</h:body>
</html> 
```

navigationBean 始终包含用户会话（SessionScoped Managed Bean）的当前有效页面。如果有什么变化，我将通过相应的支持 ajax 的组件更新“mainform”，或者使用 f:ajax。

至于现在一切都按预期工作，但我错过了什么吗？

使用此解决方案是否存在主要缺点？我应该注意什么？

感谢您的任何意见！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-20T11:19:34.193

您可能需要考虑使用已经朝着这个方向发展的 javascript 解决方案，例如[history.js](https://github.com/browserstate/history.js/) [angular.js](http://angularjs.org/)或[backbone.js](http://documentcloud.github.io/backbone/)

**对于您的解决方案，您必须考虑：**

--> 我认为1、4是最有问题的部分：

*1：网址*

*   URL 会发生什么？考虑到书签和浏览器的后退按钮，这一点很重要。`window.location.hash`因此你应该用#-values重写url（jQuery 可以很容易地做到这一点）。
*   例如，您不应该保留`your-domain.com/app`所有子页面，而是将 URL 更改为`your-domain.com/app#sub-page-1`
*   加载页面时，您可以解析 #-value 并直接加载与该 url 相关的内容。

这对于良好的用户体验很重要。重新加载页面并返回主页很糟糕！没有那个共享链接是不可能的。

*2：数据和模板*

在您的情况下`<ui:include src="#{navigationBean.currentPage}" />`，将在您的主页中加载另一个 jsf 页面。因此，您正在通过 ajax 加载模板 + 数据。

另一种可能的方法是从服务器加载数据并使用 JavaScript 将数据和模板放在一起。这种技术现在很流行。（像 angular.js 这样的 JavaScript 框架会这样做。）这也有缺点，因为您的页面将非常依赖 JavaScript，并且您几乎会因此而放弃 JSF。

*3：加载 JavaScript 和 CSS*

如果您有带有附加 CSS 或 JavaScript 文件的子页面，您应该检查是否可以通过 ajax 加载它们（通常可以，但需要一些工作）。如果没有，您必须在页面的第一次请求时加载所有相关文件，这会使初始加载速度变慢。

*4：将当前页面存储在bean中* 我认为没有必要，如果您使用*1.* 使用bean（SessionScoped？）存储当前页面，这有一些缺点：

*   如果您在子页面上并输入 URL 以访问主页，它将加载旧的子页面。
*   如果您使用 2 个或更多选项卡浏览您的网站，这将导致冲突。

**结论**

写完之后，我觉得将当前页面存储在一个bean中并不是一个好主意。因为它会引起冲突。我建议在 url 中“存储”当前页面。

像这样的东西：

```
 <div id="nav">
          <a href="javascript:void(0)" id="sub-page-1">sub-page-1</a>
  </div>
  <div id="main"></div> 
```

带有 jQ​​uery 的 JavaScript 将是这样的：

```
 $(function() {
          $('#sub-page-1').click(function() {

                  $.ajax({
                         ...
                         url: '/sub-page-1' // could be jsf page
                         success: function (data) {
                               // set the hash of this page
                               window.location.hash = 'sub-page-1';
                               // set the content on the main div
                               $('#main').html(data);
                         }
                  });

          }) 

     }); 
```

# xcode - CoreData 在单元测试中返回 NSManagedObjects 而不是子类

> ID：11165308
> 
> 赞同：0
> 
> 时间：2012-06-22T23:14:04.480
> 
> 标签：xcode, unit-testing, core-data, nsmanagedobject, nsmanagedobjectcontext

我有一个“数据”类，它使用单个布尔属性“属性”对“NSManagedObject”进行子类化。我还在“数据”类上定义了一个方法“whoisyou”。此代码在应用程序中运行，但只要我将此代码放入我的 UnitTest，Core Data 就会返回“NSManagedObject”而不是“Data”对象，并且“attribute”属性有效，但“whoisyou”方法会抛出“无法识别的选择器”异常。

```
数据 *data = [NSEntityDescription insertNewObjectForEntityForName:@"Data" inManagedObjectContext:self.moc];

NSLog(@"TYPE: %@", [数据类]);

data.attribute = [NSNumber numberWithBool:YES];
STAssertTrue([data.attribute boolValue], @"应该是 TRUE");
data.attribute = [NSNumber numberWithBool:NO];
STAssertFalse([data.attribute boolValue], @"应该是 FALSE");

[数据whoisyou]；

```

与单元测试环境有什么关系？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T23:50:06.633

确保您的自定义类实现文件包含在单元测试目标中。:)

# facebook - 如何让 FB Canvas 应用程序要求用户登录？

> ID：11165309
> 
> 赞同：-1
> 
> 时间：2012-06-22T23:14:06.540
> 
> 标签：facebook

我正在使用 Facebook 画布应用程序，我只想向当前登录到 facebook 的人显示画布应用程序。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T23:33:24.617

将它们重定向到 OAuth 页面。[文档](http://developers.facebook.com/docs/authentication/canvas/)

# mysql - 如何在 MySQL 中获取更新的 2 个日期？

> ID：11165313
> 
> 赞同：1
> 
> 时间：2012-06-22T23:14:26.647
> 
> 标签：mysql, sql, date

考虑存储在 2 个表中的 2 个日期：

```
table_1: user_id data_1 update_date
table_2: user_id data_2 update_date 
```

有没有一种简单的方法可以在 MySQL 中获取 2 中的后者？

如果只找到一个，那么它应该返回它。

编辑：添加了表格详细信息。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-22T23:17:10.460

采用[`GREATEST`](http://dev.mysql.com/doc/refman/5.5/en/comparison-operators.html#function_greatest)

```
SELECT GREATEST(t1.update_date, t2.update_date) AS update_date
FROM table_1 AS t1
   , table_2 AS t2 
```

您的查询可能更复杂，但这应该会给您这个想法。

# c - 如何在 __m128(F32vec4) 中找到最大成员

> ID：11165314
> 
> 赞同：4
> 
> 时间：2012-06-22T23:14:39.147
> 
> 标签：c, sse, simd

像这样的东西：

```
_declspec(align(16)) float dens[4];

//Here the code comes. F32vec4 S_START, Pos, _Vector

*((__m128*)dens) = (S_START - Pos) *_Vector;

float steps = max(max(dens[3], dens[2]), max(dens[1], dens[0])); 
```

如何直接使用 SSE 执行此操作？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-22T23:30:48.453

没有简单的方法可以做到这一点。SSE 并不特别适用于水平操作。所以你必须洗牌...

这是一种方法：

```
__m128 a = _mm_set_ps(10,9,7,8);

__m128 b = _mm_shuffle_ps(a,a,78);  //  {a,b,c,d} -> {c,d,a,b}
a = _mm_max_ps(a,b);

b = _mm_shuffle_ps(a,a,177);        //  {a,b,c,d} -> {b,a,d,c}
a = _mm_max_ss(a,b);

float out;
_mm_store_ss(&out,a); 
```

我注意到最终的商店不应该是一家商店。将值放入数据类型只是一种技巧`float`。

实际上不需要指令，因为`float`类型将存储在相同的 SSE 寄存器中。（只是忽略了前 3 个值。）

# routing - Ember.js 路由：如何设置默认路由以立即渲染？

> ID：11165315
> 
> 赞同：7
> 
> 时间：2012-06-22T23:15:12.730
> 
> 标签：routing, ember.js, ember-old-router

我相信随着我深入研究，这将变得清晰，但目前尚不清楚如何实现这一点。

我正在关注[这篇关于路由的有用 SO 文章](https://stackoverflow.com/questions/11050956/ember-js-router-action-to-controller)的信息，但示例中缺少一个重要部分，即如何在无需单击“主页”链接的情况下立即呈现“主页”视图？

我已经开始深入研究文档以试图理解这一点，但与此同时，为后代回答似乎是一个有用的问题。

我一直在玩上述问题中的工作 jsfiddle 示例，[并](http://jsfiddle.net/rzNuZ/15/)与我发现的其他示例进行比较，该示例[似乎具有默认路由工作](http://jsfiddle.net/zdfs/qsAxZ/5/)

到目前为止，这仍然是一个谜。

**当前代码**：

```
App.Router = Em.Router.extend({
  enableLogging: true,
  location: 'hash',

  root: Em.State.extend({
    // EVENTS
    goHome: Ember.State.transitionTo('home'),
    viewProfile: Ember.State.transitionTo('profile'),

    // STATES
    index: Em.State.extend({
        route: "/",
        redirectsTo: 'home'
    }),

    home: Em.State.extend({
        route: '/home',
        connectOutlets: function(router, context) {
            var appController = router.get('applicationController');
            appController.connectOutlet('home');
        }
    }),

    // STATES
    profile: Em.State.extend({
        route: '/profile',
            connectOutlets: function(router, context) {
              var appController = router.get('applicationController');
              appController.connectOutlet('profile');
            }
        }),
        doOne: function() {
            alert("eins");
        }
  }) 
}); 
```

* * *

**更新：解决方案**

事实证明，我正在使用的示例不起作用的原因是因为它使用`Em.State.extend`而不是`Em.Route.extend`. 有趣的是，当我一步一步地改变它们时，这个例子在我全部改变之前不起作用。

这是工作[示例](http://jsfiddle.net/fSgZS/)：

```
App.Router = Em.Router.extend({
  enableLogging: true,
  location: 'hash',

  root: Em.Route.extend({
    // EVENTS
    goHome: Ember.State.transitionTo('home'),
    viewProfile: Ember.State.transitionTo('profile'),

    // STATES
    index: Em.Route.extend({
        route: "/",
        redirectsTo: 'home'
    }),

    home: Em.Route.extend({
        route: '/home',
        connectOutlets: function(router, context) {
            var appController = router.get('applicationController');
            appController.connectOutlet({name: 'home'});
        }
    }),

    // STATES
    profile: Em.Route.extend({
        route: '/profile',
            connectOutlets: function(router, context) {
              var appController = router.get('applicationController');
              appController.connectOutlet('profile');
            }
        }),
        doOne: function() {
            alert("eins");
        }
  }) 
}); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-10-11T17:48:46.990

现在看来这是不同的做法。我以这种方式取得了成功：

```
App = Ember.Application.create();

App.Router.map(function() {
  // 'index' route is default
  this.resource('dashboard');
});

App.IndexRoute = Ember.Route.extend({
    redirect: function() {
        // this redirects / to /dashboard
        this.transitionTo('dashboard');
    }
});

App.DashboardRoute = Ember.Route.extend({
}); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-11-19T09:14:08.873

使用 Ember CLI，您可以将重定向放在路由目录根目录下的 index.js 中：

```
import Ember from 'ember';

export default Ember.Route.extend( {
  redirect: function() {
    this.transitionTo('dashboard');
  }
}); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-23T11:26:28.533

您可以从索引重定向到主路由：

```
// Default route
$(function() {
    App = Em.Application.create();

    // Instantiated and wired up for you in App.initialize()
    App.ApplicationController = Em.Controller.extend();
    App.ApplicationView = Em.View.extend({
        templateName: 'application'
    });

    App.NavController = Em.Controller.extend({});
    App.NavView = Em.View.extend({ templateName: 'nav' });

    App.HomeController = Em.Controller.extend({});
    App.HomeView = Em.View.extend({ templateName: 'home' });

    App.ProfileController = Em.Controller.extend({});
    App.ProfileView = Em.View.extend({ templateName: 'profile' });

    App.Router = Em.Router.extend({
        enableLogging: true,
        location: 'hash',

        root: Em.Route.extend({
            goHome: Ember.State.transitionTo('home'),
            goProfile: Ember.State.transitionTo('profile'),

            index: Em.Route.extend({
                route: '/',
                redirectsTo: 'home'
            }),

            home: Em.Route.extend({
                route: '/home',

                connectOutlets: function(router, context) {
                    router.get('applicationController').connectOutlet({
                        name: 'home'
                    });
                }
            }),

            profile: Em.Route.extend({
                route: '/profile',

                connectOutlets: function(router, context) {
                    console.log("enter");
                    router.get('applicationController').connectOutlet({
                        name: 'profile'
                    });
                }
            })
        })
    });

    App.initialize();
});
```

```
<script type="text/x-handlebars" data-template-name="application">
    {{view App.NavView controllerBinding="controller.controllers.navController"}}
    <hr />
    <div class="content">
        {{outlet}}
    </div>
</script>

<script type="text/x-handlebars" data-template-name="nav">
    <h1>navigation:</h1>
    <button {{action goHome}}>home</button>
    <button {{action goProfile}}>profile</buton>
</script>

<script type="text/x-handlebars" data-template-name="home">
    <h1>Home...</h1>
</script>
<script type="text/x-handlebars" data-template-name="profile">
    <h1>Profile...</h1>
</script>
```

# haskell - 为什么 GHC 不能为 Monoid 派生实例？

> ID：11165316
> 
> 赞同：20
> 
> 时间：2012-06-22T23:15:29.927
> 
> 标签：haskell, ghc, monoids

GHC 有一些语言标志，例如等`DeriveFunctor`，`DeriveDataTypeable`它们允许编译器生成类型类的派生实例，而不是 Haskell 98 中允许的类型。这对于类似的东西特别有意义`Functor`，因为该类的法律规定了一个明显的，“自然”派生实例。

那么为什么不`Monoid`呢？对于具有单个数据构造函数的任何数据类型来说，似乎是这样的：

```
data T = MkT a b c ... 
```

可以机械地产生一个`Monoid`实例（请原谅伪代码）：

```
instance (Monoid a, Monoid b, Monoid c, ...) => Monoid T where
  mempty =
    MkT mempty mempty mempty ...
  mappend (MkT a1 b1 c1 ...) (MkT a2 b2 c2 ...) =
    MkT (mappend a1 a2) (mappend b1 b2) (mappend c1 c2) ... 
```

我知道[派生](http://hackage.haskell.org/package/derive-2.5.8)包[提供了这个](http://hackage.haskell.org/packages/archive/derive/latest/doc/html/Data-Derive-Monoid.html)，但我的问题特别是 GHC 不提供的原因。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-23T18:00:08.400

不能派生实际上是一个任意的决定`Monoid`，但是幺半群也是非常普遍的，所以通常有很多方法可以使一个类型成为幺半群。这是一个例子：

```
data T = A | B | C deriving (Eq, Ord, Enum)

type Mon a = (a, a -> a -> a)

m1, m2, m3, m4 :: Mon T
m1 = (A, max)
m2 = (C, min)
m3 = (A, \ x y -> toEnum $ (fromEnum x + fromEnum y) `rem` 3)
m4 = (B, f4)
f4 A _ = A
f4 B x = x
f4 C _ = C 
```

`T`这显示了制作幺半群的四种合理方法（`Mon`包含单位和二元运算）。第一个是取最大值的幺半群，第二个是取最小值的幺半群，第三个是取模 3 算术的幺半群，第四个是用于`Ordering`类型的幺半群。没有什么能真正突出自然的方式。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-23T01:35:57.557

您可以对`Num`其他课程提出相同的要求。这将是无关紧要的：所有其他标准派生都适用于具有多个构造函数的数据类型。

作为替代，您可以使用 newtype deriving `newtype T = MkT (a,b,c) deriving Monoid`。

类似的扩展：您可以使空数据类型成为几乎每个类型类的实例。

该`deriving`子句始终是 Haskell 的临时且不方便的部分，因为它仅适用于预定义的类。添加更多的临时扩展会使语言复杂化。相反，GHC 最近获得了对[泛型派生](http://www.haskell.org/haskellwiki/GHC.Generics)的支持。

# node.js - 当我通过 socket.io 操作会话时，如何避免 node.js 中的竞争条件？

> ID：11165319
> 
> 赞同：3
> 
> 时间：2012-06-22T23:15:36.680
> 
> 标签：node.js, express, socket.io, connect

我在我的 socket.io 设置中使用了这个授权功能：

```
io.set('authorization', function (data, accept) {
    if (!data.headers.cookie) {
        return accept('Session cookie required.', false);
    }
    data.cookie = require("cookie").parse(data.headers.cookie);
    data.cookie = require("connect").utils.parseSignedCookies(data.cookie,"yeah whatever");
    data.sessionID = data.cookie['connect.sid'];
    sessionStore.get(data.sessionID, function(err, session){
        if (err) {
            return accept('Error in session store.', false);
        } else if (!session) {
            return accept('Session not found.', false);
        }
        // success! we're authenticated with a known session.info.
        return accept(null, true);
    });
}); 
```

然后我像这样操作会话变量：

```
var addAchievementToUser = function(achievement, sessionID) {
    sessionStore.get(sessionID, function(err, session) {
            //stuff happens here such as
            session.info.username = "whatever";
            sessionStore.set(sessionID, session, function () {
            });
        }
    });
}; 
```

这可以正常工作并且可以满足我的要求，但有时会产生一些邪恶的竞争条件。

那么，我该如何重写它以使其不会产生竞争条件？我查看了连接中间件，看看是否可以只操作单个键/值对而不是整个会话对象。但似乎这是不可能的，因为会话需要是一个字符串：

```
MemoryStore.prototype.set = function(sid, sess, fn){
    var self = this;
    process.nextTick(function(){
        self.sessions[sid] = JSON.stringify(sess);
        fn && fn();
  });
}; 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-23T18:15:41.110

好的，所以我开始使用 redis 中间件，它并没有真正帮助我解决这个问题。无论如何，我基本上只通过 socket.io 编辑会话（并且在客户端首次连接时编辑一次），所以我认为创建一个包含所有活动会话的会话数组是“最好的”，如下所示：

```
io.set('authorization', function (data, accept) {
    if (!data.headers.cookie) {
        return accept('Session cookie required.', false);
    }
    data.cookie = require("cookie").parse(data.headers.cookie);
    data.cookie = require("connect").utils.parseSignedCookies(data.cookie, "rawr");
    data.sessionID = data.cookie['connect.sid'];
    sessionStore.get(data.sessionID, function(err, session){
        if (err) {
            return accept('Error in session store.', false);
        } else if (!session) {
            return accept('Session not found.', false);
        }
        // success! we're authenticated with a known session.info.
        if (!sessions[data.sessionID]) {
            sessions[data.sessionID] = session;
        }

        return accept(null, true);
    });
}); 
```

所以我永远不需要使用 get session 方法来编辑我的 session 数据（只有 set 方法）。好消息是，当同一个客户端连接多个套接字时，它甚至可以工作。

# java - 如何在 Java (Swing) 中使用 GridBayLayout 在我的框架中生成这个特定的图像？

> ID：11165323
> 
> 赞同：2
> 
> 时间：2012-06-22T23:16:46.857
> 
> 标签：java, swing, gridbaglayout

![所需的主 GUI](../Images/04ec6b2240f6c082a7484801404c8663.png)

基本上，我如何生成这个？我很确定这是一份工作`GridBagLayout`，但我无法理解如何正确调整“操作窗格”与“菜单栏”的大小。红线和黑线表示我相信您将在这种情况下使用的网格（3x3），但我可能完全错了，可能有一种方法可以在不同的配置中做到这一点。我试图弄乱`weightx`, `weighty`, `gridheight`, 中的`gridwidth`值`GridBagConstraints`，但我无法在这里实现我的目标。

请注意，第二条红线应该正好是框架下半部分高度的三分之一。

这是我的最新尝试，尝试使用 3x6 网格（c 是 GridBagConstraints 对象，characterPortraits 包含所有肖像，currentScreen 是“操作窗格”）：

```
c.fill = GridBagConstraints.BOTH;
    c.weightx = 0.25;
    c.weighty = (1/6);
    c.gridx = 0;
    c.gridy = 0;
    c.gridheight = 3;
    pane.add(characterPortraits.get(0), c);  

    c.gridx = 2;        
    pane.add(characterPortraits.get(1), c);          

    c.gridx = 0;
    c.gridy = 3;
    c.gridheight = 3;
    pane.add(characterPortraits.get(2), c);  

    c.gridx = 2;        
    pane.add(characterPortraits.get(3), c);

    //c.fill = GridBagConstraints.NONE;
    c.weightx = 1.0;
    c.weighty = 1.0;
    c.gridx = 1;
    c.gridy = 0;
    c.gridheight = 3;
    pane.add(currentScreen, c); 
```

相反，这会在其象限的底部三分之一处生成每个肖像，并且操作窗格占据中心列的 5/6 而不是 4/6，就像我想要的那样。任何想法都会有所帮助；谢谢！-B。

编辑：我正在设计这个应用程序以具有固定的窗口大小；人们可能会说这是糟糕的设计，但我真的只是想感受一下 Swing 组件，并确保它们至少在固定窗口中按照我想要的方式运行。我想我可以允许最大化适当的调整大小，但仅此而已。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-23T04:39:46.650

`JMenuBar`不过，对我来说，您在最奇怪的位置添加您的 , 似乎很奇怪。尽管您可以做些什么，以克服您在此行中提到的困难

```
Instead, this produces each portrait in the bottom third of its quadrant, and the 
Action Pane taking 5/6 of the center column instead of 4/6, like I want it to. 
```

`JPanel`就是在这个位置加一个，然后把你的`ActionPane`和`JmenuBar`加到这个`JPanel`上，达到预期的效果。所以我`centerPanel`在这个位置添加了演示，这是如何实现的。

我希望这个输出是你想要的：

![输出](../Images/80639bffe5411fcf4645994c8e91c82f.png)

这是负责此输出的代码：

```
import java.awt.*;
import javax.swing.*;

public class GridBagPanelLayout
{
    private JPanel portrait1;
    private JPanel portrait2;
    private JPanel portrait3;
    private JPanel portrait4;
    private JPanel centerPanel;

    private JPanel actionPane;

    private void createAndDisplayGUI()
    {
        JFrame frame = new JFrame("GridBag JPanel Layout Example");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        /*
         * This JPanel will serve as the 
         * Content Pane, for the JFrame.
         */
        JPanel contentPane = new JPanel();
        contentPane.setOpaque(true);
        contentPane.setBackground(Color.WHITE);
        contentPane.setLayout(new GridBagLayout());

        GridBagConstraints gbc = new GridBagConstraints();
        gbc.anchor = GridBagConstraints.FIRST_LINE_START;
        gbc.fill = GridBagConstraints.BOTH;
        gbc.gridx = 0;
        gbc.gridy = 0;
        gbc.weightx = 0.33;
        gbc.weighty = 0.5;
        gbc.gridheight = 2;

        portrait1 = new JPanel();
        portrait1.setOpaque(true);
        portrait1.setBackground(Color.BLUE);
        portrait1.setBorder(
                    BorderFactory.createMatteBorder(
                            2, 2, 2, 2, Color.WHITE));
        contentPane.add(portrait1, gbc);

        gbc.gridx = 1;
        gbc.gridy = 0;
        gbc.weighty = 1.0;
        gbc.gridheight = 4;

        centerPanel = new JPanel();
        centerPanel.setOpaque(true);
        centerPanel.setBackground(Color.WHITE);
        centerPanel.setLayout(new GridBagLayout());
        GridBagConstraints constCenter = new GridBagConstraints();
        constCenter.anchor = GridBagConstraints.FIRST_LINE_START;
        constCenter.fill = GridBagConstraints.BOTH;
        constCenter.gridx = 0;
        constCenter.gridy = 0;
        constCenter.weightx = 1.0;
        constCenter.weighty = 0.975;

        actionPane = new JPanel();
        actionPane.setOpaque(true);
        actionPane.setBackground(Color.MAGENTA);
        actionPane.setBorder(
                    BorderFactory.createMatteBorder(
                            2, 2, 2, 2, Color.WHITE));
        centerPanel.add(actionPane, constCenter);

        constCenter.gridx = 0;
        constCenter.gridy = 1;
        constCenter.weighty = 0.025;

        centerPanel.add(getMenuBar(), constCenter); 
        contentPane.add(centerPanel, gbc);  

        gbc.gridx = 2;
        gbc.gridy = 0;
        gbc.weighty = 0.5;
        gbc.gridheight = 2;

        portrait3 = new JPanel();
        portrait3.setOpaque(true);
        portrait3.setBackground(Color.BLUE);
        portrait3.setBorder(
                    BorderFactory.createMatteBorder(
                            2, 2, 2, 2, Color.WHITE));
        contentPane.add(portrait3, gbc);

        gbc.gridx = 0;
        gbc.gridy = 2;
        //gbc.weighty = 0.5;
        //gbc.gridheight = 2;

        portrait2 = new JPanel();
        portrait2.setOpaque(true);
        portrait2.setBackground(Color.BLUE);
        portrait2.setBorder(
                    BorderFactory.createMatteBorder(
                            2, 2, 2, 2, Color.WHITE));
        contentPane.add(portrait2, gbc);

        gbc.gridx = 2;
        gbc.gridy = 2;
        gbc.weighty = 0.5;
        gbc.gridheight = 2;

        portrait4 = new JPanel();
        portrait4.setOpaque(true);
        portrait4.setBackground(Color.BLUE);
        portrait4.setBorder(
                    BorderFactory.createMatteBorder(
                            2, 2, 2, 2, Color.WHITE));
        contentPane.add(portrait4, gbc);

        frame.setContentPane(contentPane);
        frame.setSize(500, 300);
        frame.setLocationByPlatform(true);
        frame.setVisible(true);
    }

    private JMenuBar getMenuBar()
    {
        JMenuBar menuBar = new JMenuBar();

        JMenu fileMenu = new JMenu("File");
        fileMenu.setOpaque(true);
        fileMenu.setBackground(Color.BLACK);
        fileMenu.setForeground(Color.WHITE);
        JMenuItem newItem = new JMenuItem("NEW");
        JMenuItem openItem = new JMenuItem("OPEN");
        fileMenu.add(newItem);
        fileMenu.add(openItem);

        JMenu editMenu = new JMenu("Edit");
        editMenu.setOpaque(true);
        editMenu.setBackground(Color.BLACK);
        editMenu.setForeground(Color.WHITE);
        JMenuItem redoItem = new JMenuItem("Redo");
        JMenuItem undoItem = new JMenuItem("Undo");
        editMenu.add(redoItem);
        editMenu.add(undoItem);

        JMenu viewMenu = new JMenu("View");
        viewMenu.setOpaque(true);
        viewMenu.setBackground(Color.BLACK);
        viewMenu.setForeground(Color.WHITE);
        JMenuItem zInItem = new JMenuItem("Zoom In");
        JMenuItem zOutItem = new JMenuItem("Zoom Out");
        viewMenu.add(zInItem);
        viewMenu.add(zOutItem);

        menuBar.add(fileMenu);
        menuBar.add(editMenu);
        menuBar.add(viewMenu);
        menuBar.setOpaque(true);
        menuBar.setBackground(Color.BLACK);     

        return menuBar;
    }

    public static void main(String... args)
    {
        SwingUtilities.invokeLater(new Runnable()
        {
            public void run()
            {
                new GridBagPanelLayout().createAndDisplayGUI();
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-23T02:05:18.533

我从来都不是 GridBagLayout 的忠实粉丝。很难做到正确 - 每个组件最多可以有 11 个约束 - 很难维护，并且重用相同的约束对象可能会导致意想不到的后果。

相反，我更喜欢嵌套各种类型的布局。对我来说，你显然有：

1.  A `BorderLayout`, with `West`, `Center`, and`East`面板
2.  在`West`面板内部，您有`GridLayout`- 2 行 1 列（纵向 1 和 2）。
3.  在`East`面板内部，您有`GridLayout`- 2 行 1 列（纵向 3 和 4）。
4.  在`Center`面板内部，您有另一个`BorderLayout`，带有一个`Center`组件（操作窗格）和一个`South`组件（菜单栏）。

唯一的限制是西面板和东面板没有逻辑连接。如果肖像 1、2、3 和 4 的大小都相同，那不是问题。如果它们的尺寸不同，您可能会发现西面板和东面板的形状会有所不同。

# c# - 为什么在不涉及逻辑时使用属性？

> ID：11165326
> 
> 赞同：1
> 
> 时间：2012-06-22T23:16:55.227
> 
> 标签：c#, properties

我正在阅读有关 XNA 的教程，它使用以下代码：

```
private int score = 0;

public int Score
{
    get { return score; }
    set { score = value; }
} 
```

使用房产有什么意义？为什么不直接使用`public int Score = 0;`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-22T23:20:46.623

我会在这里使用一个自动属性：

```
public int Score { get; protected set; } 
```

因为它是“同样的东西，打字更少”（但实际上可能更好，因为它限制了谁可以设置分数；-）

属性的一些原因（通过*公共*成员变量）：

1.  属性允许单独设置 getter 和 setter 的可见性，如上所示。

2.  属性可以在接口中指定。（您*正在*针对接口进行编程......对吗？;-)

3.  在属性和成员变量之间切换会破坏 ABI（应用程序二进制接口：例如需要重新编译）。但是，可以在不破坏 ABI 的情况下重新定义现有属性的*实现。*

4.  断点可以在属性中设置。偶尔很方便。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T23:20:55.710

“封装”

通过公开字段，您可以公开实现细节。未来的“评分”可能不是要返回的简单值，而是计算的结果，因此通过将其隐藏在抽象的“GetScore”属性函数后面，您可以自由更改实现的细节，而无需打破消费者。

请注意，您可以在 C# 3.0 中使用具有属性的自动生成字段：

```
public int Score { get; set; } // this will create a hidden field, however all access (even from within the class) must be done by the accessor and mutator methods. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T23:21:20.780

最大的原因是为了便于重构以包含逻辑。（从字段更改为属性需要在引用您的程序集中重新编译，因为 get 和 set 访问器实际上是方法。）正如 pst 的评论所示，您还可以为 get 和 set 分配不同的访问修饰符（例如`protected set`）。使用自动属性，通常几乎没有理由（在可读性或其他方面）使用字段而不是属性。

# qt - Qt忽略QItemSelectionModel中的右键单击

> ID：11165329
> 
> 赞同：0
> 
> 时间：2012-06-22T23:17:07.193
> 
> 标签：qt, mouseevent, qtreeview, qtreewidget, selectionmodel

有没有办法检测从 QItemSelectionModel 中单击了哪个鼠标按钮？

我想阻止鼠标右键单击更改选择。

我用的是QTreeWidget，所以如果有办法屏蔽整个东西，那就太好了，但是右键单击仍然用于上下文菜单，所以我没有追求这种思路。

仍在尝试……我偶然发现了这一点，但我无法运行该函数：http: [//qt-project.org/faq/answer/how_to_prevent_right_mouse_click_selection_for_a_qtreewidget](http://qt-project.org/faq/answer/how_to_prevent_right_mouse_click_selection_for_a_qtreewidget) 这意味着一个简单的覆盖，但这并没有在 Python 中工作

```
def mousePressEvent(self, mouse_event):
    super(MyTreeWidget, self).mousePressEvent(mouse_event)
    print "here %s" % event.type() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T18:25:18.273

这感觉像是另一种解决方法，但我得到了它的工作。在这个例子中，SelectionModel 也是一个事件过滤器，它从 QTreeWidget 的 viewport() 获取鼠标点击事件

另见：

*   [什么可以阻止 mousePressEvent 或事件过滤器鼠标单击事件？](https://stackoverflow.com/questions/11198158/what-can-block-mousepressevent-or-event-filter-mouse-click-events)
*   [QT QItemSelectionModel 忽略列？](https://stackoverflow.com/questions/10906950/qt-qitemselectionmodel-to-ignore-columns)

（希望我没有遗漏任何东西，因为我在运行中破解了它，而我的实际实现要复杂一些，并使用单独的事件过滤器。）

```
from PyQt4.QtGui import QItemSelectionModel
from PyQt4.QtCore import QEvent
from PyQt4.QtCore import Qt

# In the widget class ('tree' is the QTreeWidget)...
    # In __init___ ...
        self.selection_model = CustomSelectionModel(self.tree.model())
        self.tree.viewport().installEventFilter(self.selection_model)

# In the selection model...
class CustomSelectionModel(QItemSelectionModel):
    def __init__(self, model):
        super(CustomSelectionModel, self).__init__(model)
        self.is_rmb_pressed = False

    def eventFilter(self, event):
        if event.type() == QEvent.MouseButtonRelease:
            self.is_rmb_pressed = False
        elif event.type() == QEvent.MouseButtonPress:
            if event.button() == Qt.RightButton:
                self.is_rmb_pressed = True
            else:
                self.is_rmb_pressed = False

    def select(self, selection, selectionFlags):
        # Do nothing if the right mouse button is pressed
        if self.is_rmb_pressed:
            return

        # Fall through. Select as normal
        super(CustomSelectionModel, self).select(selection, selectionFlags) 
```

# python - 如何在 Sympy 中解决 x + 1 < 2？

> ID：11165331
> 
> 赞同：0
> 
> 时间：2012-06-22T23:17:29.713
> 
> 标签：python, math, sympy

在数学中，我可以用以下方法解决“x + 1 < 2”：

```
Reduce[x + 1 < 2, x] 
```

我可以用 SymPy 做同样的事情吗？我该怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-23T00:52:57.483

使用 real=True 定义一个实数符号：

```
In [1]: x = symbols("x", real=True)

In [2]: solve(x + 1 < 2, x)
Out[2]: x < 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T23:33:13.337

使用该[`solve()`](http://docs.sympy.org/dev/modules/solvers/solvers.html)功能。

```
>>> from sympy.solvers import solve
>>> from sympy import Symbol
>>> x = Symbol('x')
>>> solve(x + 1 < 2, x)
And(im(x) == 0, re(x) < -3) 
```

# cassandra - 当列序列化程序为 String 时，如何插入 int？

> ID：11165333
> 
> 赞同：1
> 
> 时间：2012-06-22T23:17:33.930
> 
> 标签：cassandra, astyanax

从 Astyanax 的[入门](https://github.com/Netflix/astyanax/wiki/Getting-Started)页面：

```
ColumnFamily<String, String> CF_USER_INFO =
 new ColumnFamily<String, String>(
     "Standard1",              // Column Family Name
     StringSerializer.get(),   // Key Serializer
     StringSerializer.get());  // Column Serializer 
```

所以键是一个字符串，列值也是一个字符串。但后来：

```
m.withRow(CF_USER_INFO, "acct1234")
.putColumn("firstname", "john", null)
.putColumn("lastname", "smith", null)
.putColumn("address", "555 Elm St", null)
.putColumn("age", 30, null); 
```

最后一个 putColumn 语句使用“30”（int 值）作为列的值。
这是怎么可能的，因为前面的声明表明列值是一个字符串？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T23:25:24.337

您可以为每个单独的列设置序列化程序。这是使用 Hector 的一种方法（以下代码是 JRuby，所以没有很多类型声明）：

```
cluster = HFactory.getOrCreateCluster("my_cluster","localhost:9160")
keyspace = HFactory.createKeyspace("my_keyspace", cluster)
ss = StringSerializer.new
is = IntegerSerializer.new
mut = HFactory.createMutator(keyspace, ss)
mut.addInsertion("my_key", "my_column_family", HFactory.createColumn("age",50,ssis))
mut.execute() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T09:45:22.793

如果有人需要这个

```
 ksDef = cluster.makeKeyspaceDefinition();

            ksDef.setName(keyspaceName)
                    .setStrategyOptions(keyspaceOptions)
                    .setStrategyClass("SimpleStrategy")
                        .addColumnFamily(
                                cluster.makeColumnFamilyDefinition()
                                        .setName("yourcf")
                                        .setDefaultValidationClass("UTF8Type")
                                        .setKeyValidationClass("UTF8Type")
                                        .addColumnDefinition(
                                        cluster.makeColumnDefinition()
                                                setName("flag")
                                                .setValidationClass("BooleanType")); 
```

我正在使用[ThrifeKeyspaceImplTest.java](https://github.com/Netflix/astyanax/blob/master/src/test/java/com/netflix/astyanax/thrift/ThrifeKeyspaceImplTest.java)单元测试作为参考，有很多例子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-29T17:03:17.313

这可能的两个原因：

首先， astyanax 示例没有为列值（验证器）设置验证类。

其次，Astyanax 为大多数原始类型（以及一些其他类型 - 例如 ByteBuffer、UUID 等）提供强类型 putColumn 方法，并且 putColumn 实现代表您处理序列化。

```
@Override 
public ColumnListMutation<C> putColumn(C columnName, int value, Integer ttl) {
    return putColumn(columnName, value, IntegerSerializer.get(), ttl);
} 
```

见[/astyanax-cassandra/src/main/java/com/netflix/astyanax/AbstractColumnListMutation.java#L159](https://github.com/Netflix/astyanax/blob/master/astyanax-cassandra/src/main/java/com/netflix/astyanax/AbstractColumnListMutation.java#L159)

关于验证器，您可以在 astyanax（和 hector）中以编程方式或通过 CLI 设置 column_metadata 在 ColumnDefinition 上设置ValidationClass。请参阅：[http ://www.datastax.com/docs/0.8/configuration/storage_configuration#column-metadata](http://www.datastax.com/docs/0.8/configuration/storage_configuration#column-metadata)

# jquery - jQuery-stickyfloat.js 更新新容器高度

> ID：11165336
> 
> 赞同：0
> 
> 时间：2012-06-22T23:18:14.900
> 
> 标签：jquery, css-float, sticky

这个问题肯定需要使用视觉辅助：http: [//jsfiddle.net/h8DUm/1/](http://jsfiddle.net/h8DUm/1/)

该设置是一个动态改变高度的 2 列表。左列具有调整粘性浮动高度（在右列中）和下拉小部件（在左列中）的控件。右列显示粘性浮动。

除了一个细节外，这一切似乎都很好：当菜单展开并且粘性浮动 div 位于屏幕底部时，然后您折叠菜单，粘性浮动 div 保留在父容器之外，直到窗口滚动.

有没有办法改变这种行为，以便stickyfloat div在这种情况下（或点击）自动更新它的位置？

提前致谢！

# static - 在 gfortran 中使用 -static 和 -fopenmp 时出现段错误

> ID：11165338
> 
> 赞同：2
> 
> 时间：2012-06-22T23:18:24.447
> 
> 标签：static, segmentation-fault, fortran, openmp

我在fortran中使用openmp，在程序完成很多工作之前，它通过简单地尝试写入如下所示的一行而遇到了段错误：

```
783       module Lines
784 
785       character*80 eline, dline
786 
787       contains
788 
789       subroutine InitializeLines
790       print*, 'writing to eline'
791       write(eline,'(1x,79(''#''))')
792       print*, 'writing to dline'
793       write(dline,'(1x,79(''-''))')
794       end subroutine InitializeLines
795 
796       end module Lines 
```

在主程序中，当我尝试调用时，它只是在给我一个段错误之前`InitializeLines`打印出来。`writing to eline`现在，当我在没有`-fopenmp`. 另请注意，本节中只有一个线程处于活动状态（a 只是`get_num_threads()`表明我`InitializeLines`只使用一个线程进入）。我一起飞`-fopenmp`，就没有段错误并且程序正确执行。

另请注意`-DUSEOPENMP`，当我想使用 openmp 时，我的 makefile 中有一个标志。如果我没有定义，那么将不会发生 openmp 操作。*这很重要，因为当我不* 使用编译时*，*`-DUSEOPENMP`我会遇到相同的段错误问题，即使我 100% 确定我什至没有调用任何额外的线程或使用 openmp 的任何部分。 *`-fopenmp`*

 *现在，经过一番尝试，我发现当我取出`-static`作为编译选项时，这个问题就消失了。我的问题是——为什么？为什么会这样`-static`并且`-fopenmp`不一起工作，这是我可以通过其他方式解决的问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-23T08:32:35.073

这是一个[glibc 特有的问题](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=39176)——静态链接不能很好地与包括 OpenMP 在内的线程程序配合使用。不过有一个解决方法：强制链接器链接整个`libpthread.a`档案，而不仅仅是直接引用的符号`-Wl,--whole-archive -lpthread -Wl,--no-whole-archive`。

除非您有充分的理由静态链接系统库，否则不要这样做。*

# c++ - 通过自定义模板化迭代器调整不可迭代的容器进行迭代

> ID：11165341
> 
> 赞同：6
> 
> 时间：2012-06-22T23:18:30.483
> 
> 标签：c++, templates

我有一些类，由于各种原因超出了本讨论的范围，我无法修改（省略了不相关的实现细节）：

```
class Foo { /* ... irrelevant public interface ... */ };

class Bar {
  public:
    Foo& get_foo(size_t index) { /* whatever */ }
    size_t size_foo() { /* whatever */ }
}; 
```

（我正在处理许多类似的 'Foo' 和 'Bar' 类，它们都是从其他地方生成的代码以及我不想子类化的东西等）

[编辑：澄清 - 尽管有许多类似的 'Foo' 和 'Bar' 类，但可以保证每个“外部”类都有 getter 和 size 方法。每个“外部”只有 getter 方法名称和返回类型会有所不同，具体取决于它的“内部”包含类型是什么。

所以，如果我有包含 Quux 实例的 Baz，就会有 Quux& Baz::get_quux(size_t index) 和 size_t Baz::size_quux()。]

鉴于 Bar 类的设计，您不能轻易在 STL 算法中使用它（例如 for_each、find_if 等），并且必须执行命令式循环而不是采用函数式方法（我更喜欢后者的原因也超出了本次讨论）：

```
Bar b;
size_t numFoo = b.size_foo();
for (int fooIdx = 0; fooIdx < numFoo; ++fooIdx) {
  Foo& f = b.get_foo(fooIdx);
  /* ... do stuff with 'f' ... */
} 
```

所以......我从来没有创建过自定义迭代器，在阅读了关于 iterator_traits 等的各种问题/答案之后，我想出了这个（目前半生不熟的）“解决方案”：

首先，自定义迭代器机制（注意：'function' 和 'bind' 的所有用法都来自 MSVC9 中的 std::tr1）：

```
// Iterator mechanism...
template <typename TOuter, typename TInner>
class ContainerIterator : public std::iterator<std::input_iterator_tag, TInner> {
  public:
    typedef function<TInner& (size_t)> func_type;

    ContainerIterator(const ContainerIterator& other) : mFunc(other.mFunc), mIndex(other.mIndex) {}

    ContainerIterator& operator++() { ++mIndex; return *this; }

    bool operator==(const ContainerIterator& other) {
      return ((mFunc.target<TOuter>() == other.mFunc.target<TOuter>()) && (mIndex == other.mIndex));
    }

    bool operator!=(const ContainerIterator& other) { return !(*this == other); }

    TInner& operator*() { return mFunc(mIndex); }

  private:
    template<typename TOuter, typename TInner>
    friend class ContainerProxy;

    ContainerIterator(func_type func, size_t index = 0) : mFunc(func), mIndex(index) {}

    function<TInner& (size_t)> mFunc;
    size_t mIndex;
}; 
```

接下来，我获得表示内部容器开始和结束的有效迭代器的机制：

```
// Proxy(?) to the outer class instance, providing a way to get begin() and end()
// iterators to the inner contained instances...
template <typename TOuter, typename TInner>
class ContainerProxy {
  public:
    typedef function<TInner& (size_t)> access_func_type;
    typedef function<size_t ()> size_func_type;

    typedef ContainerIterator<TOuter, TInner> iter_type;

    ContainerProxy(access_func_type accessFunc, size_func_type sizeFunc) : mAccessFunc(accessFunc), mSizeFunc(sizeFunc) {}

    iter_type begin() const {
      size_t numItems = mSizeFunc();
      if (0 == numItems) return end();
      else return ContainerIterator<TOuter, TInner>(mAccessFunc, 0);
    }
    iter_type end() const {
      size_t numItems = mSizeFunc();
      return ContainerIterator<TOuter, TInner>(mAccessFunc, numItems);
    }

  private:
    access_func_type mAccessFunc;
    size_func_type mSizeFunc;
}; 
```

我可以通过以下方式使用这些类：

```
// Sample function object for taking action on an LMX inner class instance yielded
// by iteration...
template <typename TInner>
class SomeTInnerFunctor {
  public:
    void operator()(const TInner& inner) {
      /* ... whatever ... */
    }
};

// Example of iterating over an outer class instance's inner container...
Bar b; /* assume populated which contained items ... */
ContainerProxy<Bar, Foo> bProxy(
  bind(&Bar::get_foo, b, _1),
  bind(&Bar::size_foo, b));
for_each(bProxy.begin(), bProxy.end(), SomeTInnerFunctor<Foo>()); 
```

根据经验，这个解决方案可以正常工作（减去我在编辑上述内容时可能引入的任何复制/粘贴或拼写错误）。

所以，最后，实际的问题：

我不喜欢调用者要求使用 bind() 和 _1 占位符等。他们真正关心的是：外部类型，内部类型，外部类型获取内部实例的方法，外部类型获取内部实例的方法。

有没有办法以某种方式“隐藏”模板类主体中的绑定？我一直无法找到一种方法来分别为类型和内部方法分别提供模板参数......

谢谢！
大卫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-23T03:10:58.463

您可以定义一个辅助模板结构来隐藏与 Foo 和 Bar 交互的实际机制。然后专门针对每个容器：

```
// incomplete general case
template <typename TOuter> struct LegacyContainerTraits;

// Specialization for 'Bar'
template <> struct LegacyContainerTraits<Bar>
{
    // The inner type of 'Bar' is 'Foo'
    typedef Foo inner_type;

    static size_t get_size(Bar const& outer) {return outer.size_foo();}
    static Foo& get_element(Bar const& outer, size_t index) {
        return outer.get_foo(index);
    }
};

// Specialization for Baz
template <> struct LegacyContainerTraits<Baz>
{
    // The inner type of 'Baz' is 'Quux'
    typedef Quux inner_type;

    static size_t get_size(Baz const& outer) {return outer.size_quux();}
    static Quux& get_element(Baz const& outer, size_t index) {
        return outer.get_quux(index);
    }
}; 
```

然后在`ContainerProxy`/`ContainerIterator`中，而不是存储和使用函数，您只需存储对容器的引用/副本并调用`LegacyContainerTraits`. 事实上，根本不需要`ContainerProxy`：

```
template <typename TOuter> class LegacyContainerIterator;
template <typename TOuter> LegacyContainerIterator<TOuter> begin(TOuter& );
template <typename TOuter> LegacyContainerIterator<TOuter> end(TOuter& );

template <typename TOuter>
class LegacyContainerIterator : 
    public std::iterator<std::random_access_iterator_tag,
                         typename LegacyContainerTraits<TOuter>::inner_type >
{
private:
    ...
    friend LegacyContainerIterator<TOuter> begin<TOuter>(TOuter& );
    friend LegacyContainerIterator<TOuter> end<TOuter>(TOuter& );
    LegacyContainerIterator(TOuter& containerRef, size_t index) ... {};
    ...

public:
    ...
    typename LegacyContainerTraits<TOuter>::inner_type& operator*() {
        return LegacyContainerTraits<TOuter>
            ::get_element(mContainerRef, mIndex);
    }
    ...
};

template <typename TOuter>
LegacyContainerIterator<TOuter> begin(TOuter& containerRef)
{
    return LegacyContainerIterator<TOuter>(containerRef, 0);
}

template <typename TOuter>
LegacyContainerIterator<TOuter> end(TOuter& containerRef)
{
    return LegacyContainerIterator<TOuter>(
               containerRef,
               LegacyContainerTraits<TOuter>::get_size(containerRef));
} 
```

然后，您可以在循环或算法中相当轻松地使用自由函数。即使在基于范围的 for 循环中：

```
Bar b=...;

for (auto it=begin(b); it!=end(b); ++it) {...}

for (auto f : b) {...}

std::for_each(begin(b), end(b), ...); 
```

更充实的版本：http: [//ideone.com/JA9hC](http://ideone.com/JA9hC)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-23T04:45:35.720

或者，如果函数具有可预测的签名，您始终可以将函数本身作为模板参数：

```
template <typename TOuter, typename TInner, 
          TInner& (TOuter::*getfunc)(size_t )>
class ContainerIterator
{
public:
    //...
    TInner& operator*() {return mContainerRef.*getfunc(mIndex);}
    //...
};

template <typename TOuter, typename TInner, 
          size_t (TOuter::*sizefunc)(),
          TInner& (TOuter::*getfunc)(size_t )>
class ContainerProxy
{
public:
    //...
    ContainerIterator<TOuter, TInner, getfunc> end() {
        return ContainerIterator<TOuter, TInner, getfunc>
                   (mContainerRef, 
                    mContainerRef.*sizefunc());
    }
    //...
};

int main()
{
   Bar b;
   ContainerProxy<Bar, Foo, &Bar::size_foo, &Bar::get_foo> proxy(b);
   std::for_each(proxy.begin(), proxy.end(), /*...*/);
} 
```

或者更进一步（[http://ideone.com/ulIC7](http://ideone.com/ulIC7)）并通过将它们包装在传递函数`std::function`：

```
template <typename TOuter, typename TInner>
struct ContainerIterator : public std::iterator<std::input_iterator_tag, TInner>
{
    TOuter& mContainerRef;
    //...
    typedef std::function<TInner& (TOuter*, size_t)> getfunc_type;
    getfunc_type mGetfunc;

    ContainerIterator(TOuter& containerRef, size_t index, getfunc_type const& getFunc)
    /* ... */ {}
    TInner& operator*() {return mGetfunc(&mContainerRef, mIndex);}
    ContainerIterator<TOuter, TInner>& operator++() {++mIndex; return *this;}

    // ...
};

template <typename TOuter, typename TInner>
struct ContainerProxy
{
    TOuter& mContainerRef;

    typedef std::function<size_t (TOuter*)> sizefunc_type;
    sizefunc_type mSizefunc;

    typedef std::function<TInner& (TOuter*, size_t)> getfunc_type;
    getfunc_type mGetfunc;

    ContainerProxy(TOuter& containerRef, sizefunc_type sizefunc, getfunc_type getfunc)
    // ...
    {
    }

    // ...

    ContainerIterator<TOuter, TInner> end() const
    {
        return ContainerIterator<TOuter, TInner>(mContainerRef,
                                                 mSizefunc(&mContainerRef), 
                                                 mGetfunc);
    }
};

int main()
{
    Bar b=...;

    ContainerProxy<Bar, Foo> proxy(b, &Bar::size_foo, &Bar::get_foo); 
    std::for_each(proxy.begin(), proxy.end(), /*...*/);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-23T05:06:13.553

这是 Managu 解决方案变体的完整实现。（好吧，我知道我还没有实现获得真正的随机访问迭代器所需的所有必要的迭代器函数。实现其余的函数是读者的练习。）。

```
#include <vector>
#include <iostream>
#include <iterator>

class Foo {
  public:
    Foo( int ii ) : i(ii) {}
    Foo() : i() {}
    int i;
};

class Bar {
  public:
    Bar() : f1(1), f2(2), f3(3) {}

    Foo& get_foo( size_t i ) {
      if(i==0) return f1;
      if(i==1) return f2;
      return f3;
    }

    size_t n_foo() const { return 3; }

    Foo f1;
    Foo f2;
    Foo f3;
};

template<
  typename INNER,
  typename OUTER,
  size_t(OUTER::*COUNTER)() const,
  INNER&(OUTER::*ACCESSOR)(size_t) >
class ContainerProxy {
  public:
    ContainerProxy( OUTER * o ) : outer(o) {}

    OUTER * outer;
    struct Iterator {
      typedef std::random_access_iterator_tag iterator_category;
      typedef INNER                      value_type;
      typedef ptrdiff_t                  difference_type;
      typedef INNER*                     pointer;
      typedef INNER&                     reference;

      ContainerProxy * container;
      size_t index;

      Iterator( ContainerProxy * c, size_t i ) : container(c), index(i) {}
      Iterator& operator++() { index++; return *this; } 
      INNER& operator*() { return (container->outer->*ACCESSOR)(index); }

      difference_type operator-( const Iterator other ) const { return index-other.index; }
    };

    Iterator begin() { return Iterator(this,0); }

    Iterator end() { return Iterator(this, (outer->*COUNTER)() ); }
};

int main() {
  Bar bar;
  ContainerProxy<Foo,Bar, &Bar::n_foo, &Bar::get_foo> container(&bar);

  std::vector<Foo> v(3);
  std::copy( container.begin(), container.end(), v.begin() );

  std::cout<<v[0].i<<std::endl;
  std::cout<<v[1].i<<std::endl;
  std::cout<<v[2].i<<std::endl;
} 
```

# linux - scanmem (Linux) 与 CheatEngine (Win)

> ID：11165342
> 
> 赞同：0
> 
> 时间：2012-06-22T23:18:34.400
> 
> 标签：linux, windows, memory, process, cheat-engine

`scanmem`比`CheatEngine`（尽管我在我的 VirtualBox 中运行 CheatEngine）慢得多。进一步的 scanmem 无法扫描任何值 (*)，但 CheatEngine 可以。怎么会？对于 Linux 用户，scanmem 是否有更好的选择？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T23:31:06.167

也许试试[Memscanner](http://code.google.com/p/memscanner/)？自 2009 年以来，它没有进行过项目更新，但可能值得一试。

# javascript - Three.js / WebGL - 透明平面隐藏在它们后面的其他平面

> ID：11165345
> 
> 赞同：24
> 
> 时间：2012-06-22T23:18:59.237
> 
> 标签：javascript, three.js, webgl, depth, zbuffer

当您在 Three.js / WebGL 中有两个平面并且其中一个或两个都是透明的时，有时后面的平面会被上面的透明平面隐藏。为什么是这样？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-12-06T10:21:16.133

假设您正在使用一些透明的 *.png 图像。那么这会有所帮助：

```
new THREE.MeshBasicMaterial( { side:THREE.BackSide,map:texture, depthWrite: false, depthTest: false }); 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2016-01-14T09:11:34.580

设置`depthWrite`属性来`false`解决我的问题。

```
new THREE.MeshBasicMaterial({ 
    opacity: 0.25, 
    transparent: true, 
    side: THREE.DoubleSide, 
    depthWrite: false
}); 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2012-06-23T13:24:43.857

尝试添加`alphaTest: 0.5`到材料中。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2012-06-22T23:27:32.670

这不是一个错误，它只是 OpenGL（以及因此，WebGL）的工作方式。透明表面不能很好地与 z 缓冲区配合使用，因此必须手动排序并从后到前渲染。三个 JS 正在尝试为您执行此操作（这就是为什么当您设置 X 值 > 0 时问题消失的原因）但无法像您展示的那样可靠地处理相交几何体的情况。

[我已经在另一个 SO question](https://stackoverflow.com/questions/8763603/transparent-textures-behaviour-in-webgl)中更深入地解释了这个问题，所以你可能想参考一下。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-10-25T15:01:33.287

fwiw，如果你有很多平行平面（看不到你的样本，谷歌无法解析你的域），很容易让它们沿着垂直轴排序。对于飞机列表 [ABCD]，抽签顺序将是 [ABCD] 或 [DCBA]，仅此而已！因此，排序不需要对性能造成影响。只要在你去的时候保持它们的顺序。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-08-09T07:18:03.463

设置Mesh`renderOrder`来解决我的问题，下面是我的代码，你可以**修改** `node.renderOrder`值：

```
loader.load(model_url, (gltf)=>{
            let scene = gltf.scene

            scene.traverse((node)=>{

                if(node.isMesh){
                    node.material.transparent = true

                    if(node.name === 'car_windows'){
                        node.material.opacity = 0.4
                        node.material.side = 0
                        node.renderOrder = 110
                    }

                    if(node.name === 'car_body'){
                        node.material.opacity = 0.4
                        node.renderOrder = 100
                    }

                    if(node.name === 'car_seats'){
                        node.material.opacity = .5
                        node.renderOrder = 90
                    }

                    mesh_arr.push(node)
                    mesh_objs[node.name] = node
                }
            })
}) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-05-17T06:00:13.497

这对我有用，不要使用文字布尔值 true 尝试使用 1 。

```
object3d.material.transparent = 1; 
```

# css - 默认不显示，鼠标悬停可见

> ID：11165346
> 
> 赞同：1
> 
> 时间：2012-06-22T23:19:00.333
> 
> 标签：css, hover, hide, opacity

这是标题 DIV 的 CSS：

```
#header { 
  display: block;
  float: left;
  min-width: 100%;
  min-height: 170px;
  height: auto; 
  background-color: #030309; 
  background-color: #191718; 
  position:fixed; 
  margin-top: -210px; 
  z-index: 999999; 
  opacity:.76;
  -webkit-transition: opacity 1s ease-in-out;
  -moz-transition: opacity 1s ease-in-out;
  -o-transition: opacity 1s ease-in-out;
  -ms-transition: opacity 1s ease-in-out;
  transition: opacity 1s ease-in-out;
  top: 0;
} 
```

这是悬停状态：

```
#header:hover { 
  display:block; 
  opacity:1;
  -webkit-transition: opacity 1s ease-in-out;
  -moz-transition: opacity 1s ease-in-out;
  -o-transition: opacity 1s ease-in-out;
  -ms-transition: opacity 1s ease-in-out;   
  transition: opacity 1s ease-in-out;
} 
```

我想要做的是默认情况下隐藏标题并在悬停时显示。我尝试不断添加，`display: none`但它不起作用。我也尝试过on和on但它不行，因为标题下方的内容保持固定并且从页面顶部不可见。`#header``display:block;``#header:hover``opacity:0;``#header``opacity:1;``#header:hover`

一些建议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-22T23:25:23.590

" `display: none;`" 表示该元素已从文档流中删除，因此不可能有 :hover 状态，因为没有任何东西可以悬停。

您是否正在考虑`visibility: hidden;`（实际上与 相同`opacity: 0;`）？

尝试添加`outline:`到您的 CSS 以帮助您在文档视口中查看该框，这样您就知道您确实将鼠标悬停在它上面。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T23:27:25.170

首先，您有一个`margin-top:-210px`导致标题不可见但您永远不会`0`在悬停时将其向下移动的原因。把它拿出来。然后你可以`opacity`正常设置为0，悬停时设置为1，它会在悬停时淡入。

[演示](http://jsfiddle.net/QNapD/2/)

或者，如果您希望它向下滑动，请将转换从 just `opacity`to更改为`all`并将 a 设置`top:0`为`:hover`状态。您还需要设置一个大于负上边距的高度，以便元素的一部分可见，以便用户可以将鼠标悬停在它上面。我将其设置为`220px`.

**CSS的相关变化：**

```
#header {
    top:-210px;
    height: 220px;
    -webkit-transition:all 1s ease-in-out;
    -moz-transition:all 1s ease-in-out;
    -o-transition:all 1s ease-in-out;
    -ms-transition:all 1s ease-in-out;
    transition:all 1s ease-in-out;
}

#header:hover {
    opacity:1;
    top:0px;
    -webkit-transition:all 1s ease-in-out;
    -moz-transition:all 1s ease-in-out;
    -o-transition:all 1s ease-in-out;
    -ms-transition:all 1s ease-in-out;
    transition:all 1s ease-in-out;
}​ 
```

[演示](http://jsfiddle.net/QNapD/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T23:27:29.923

您正在尝试做的事情没有意义 - 您的标题起初不可见，因此无法悬停。这就是它不会出现的原因。

你可以做的是：

*   最初隐藏块，就像你做的那样。
*   用另一个元素包裹`#header`元素。假设您使用 id 标记它`#header-container`。
*   使用 CSS：`#header-container:hover #header { display: block; }`

这将允许您为客户端提供一个元素`hover`以显示`#header`，而最初隐藏它。

# objective-c - 批处理核心数据获取结果

> ID：11165348
> 
> 赞同：8
> 
> 时间：2012-06-22T23:19:27.960
> 
> 标签：objective-c, ios, cocoa, core-data

我正在执行一个返回大约 2000 个实体的获取请求。目前，这在我的设备上大约需要 20 秒。所以我想我可能会设置一个 100 的获取限制，然后当用户滚动到表格视图的末尾时，获取接下来的 100 个实体。这可以使用`NSFetchRequest's` `setFetchLimit`和来完成`setFetchOffset`。

但是，我想不通的是，如果在我第二次提取对象 101-200 时，对象 1-100 会发生什么？我是否必须为每 100 个项目使用单独`NSFetchedResultsController`的，然后将我的表视图数据源方法配置为基于多个获取结果控制器进行查询？或者我可以`NSFetchedResultsController`以某种方式一次获取 100 个实体，但是在每次后续获取时，只需将接下来的 100 个项目添加到原始的 100 个项目中？

编辑：这是我的代码：

```
 NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];

    NSEntityDescription *entity = [NSEntityDescription 
                                   entityForName:@"MessageObject" inManagedObjectContext:appDelegate.managedObjectContext];

    [fetchRequest setEntity:entity];
    NSPredicate *predicate= [NSPredicate predicateWithFormat:@"ANY tags.tagName==%@", currentTagObject.tagName];
    [fetchRequest setPredicate:predicate];
    NSSortDescriptor *sort= [[NSSortDescriptor alloc] initWithKey:@"createDate" ascending:NO selector:@selector(compare:)];
    [fetchRequest setSortDescriptors:[NSArray arrayWithObject:sort]];
    [fetchRequest setFetchBatchSize:5]; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-22T23:23:00.317

您实际上不需要做任何事情来实现您指定大小的批量获取。您将获得您所描述的行为，只需在单个控制器上执行单个获取请求 - 通过设置批量大小属性，您只是向 CoreData 提示您认为是您自己考虑的最佳批量大小。CoreData 将处理按您需要指定大小的顺序批次获取对象 - 并且在需要内存消耗时，它将对托管对象进行故障处理。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-24T00:44:09.113

使用 ANY 是一项非常昂贵的操作。我不确定这些关系，但您可以尝试获取特定标签名称的标签实体，而不是您的消息对象实体。然后使用逆关系获取消息对象实体

此外，您的排序正在使用比较器，我确信这无济于事。日期应该由核心数据存储为整数，因此您可以在不使用选择器的情况下进行直接排序。

Core Data 非常快，我已经对 65,000 条记录进行了关键字搜索，并在几毫秒内返回了结果。

好运

# python - 为 Python 记录器格式化输出编写单元测试

> ID：11165354
> 
> 赞同：9
> 
> 时间：2012-06-22T23:20:46.103
> 
> 标签：python, unit-testing, logging

你怎么能用 Python 编写一个单元测试来测试记录器的输出是否确实是你期望的格式（即通过调用 logging.basicConfig() 来设置）？我正在考虑自定义 StreamHandler 和使用“re”库，但看起来传递给 StreamHandler.emit() 的 LogRecord 不能给我将输出的字符串。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-22T23:31:57.753

从文档（[http://packages.python.org/testfixtures/logging.html](http://packages.python.org/testfixtures/logging.html)）：

> 为了解决这个问题，TestFixtures 允许您轻松捕获对 Python 日志框架的调用输出，并确保它们符合预期。根据您编写的测试类型，共有三种不同的技术。
> 
> 1.  [上下文管理器](http://packages.python.org/testfixtures/logging.html#the-context-manager)
> 2.  [装饰师](http://packages.python.org/testfixtures/logging.html#the-decorator)
> 3.  [手动使用](http://packages.python.org/testfixtures/logging.html#manual-usage)

示例包含在文档中。缩短版如下。

## 上下文管理器

```
>>> import logging
>>> from testfixtures import LogCapture
>>> with LogCapture() as l:
...     logger = logging.getLogger()
...     logger.info('a message')
...     logger.error('an error') 
```

之后，您可以检查日志是否相等：

```
>>> l.check(
...     ('root', 'INFO', 'a message'),
...     ('root', 'ERROR', 'another error'),
...     )
Traceback (most recent call last):
 ...
AssertionError: Sequence not as expected:

same:
(('root', 'INFO', 'a message'),)

first:
(('root', 'ERROR', 'another error'),)

second:
(('root', 'ERROR', 'an error'),) 
```

## 装饰师

与上一个类似，但适用于特定功能：

```
from testfixtures import log_capture

@log_capture()
def test_function(l):
    logger = logging.getLogger()
    logger.info('a message')
    logger.error('an error')

    l.check(
        ('root', 'INFO', 'a message'),
        ('root', 'ERROR', 'an error'),
        ) 
```

## 手动使用

```
>>> from testfixtures import LogCapture
>>> l = LogCapture() 
```

之后，您还可以“检查”日志：

```
>>> l.check(('root', 'INFO', 'a message'))
<...> 
```

**编辑**：要访问特定日志并以自定义方式分析它们，您可以迭代`l.records`（其中`l`只是`LogCapture`'s 实例）并访问它们中的每一个的一些属性（例如，`msg`包含发送到记录器的消息，`levelname`包含级别的代号，还有很多其他属性）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-02-26T13:55:26.697

如果您只想使用标准库，此解决方案可能会有所帮助。它基于`unittest`和`mock`库。

例如，如果您有`script.py`以下内容。

```
logger = logging.getLogger(__name__)

def log_something():
    logger.debug("something") 
```

你可以为它写一个看起来像这样的测试。

```
import unittest

import mock

from script import log_something

@mock.patch("script.logger")
def test_function(mock_log):
    log_something()

    assertTrue(
        "something" in mock_log.debug.call_args_list[0][0][0]
    ) 
```

这是使用库中的[call_args_list](https://docs.python.org/3/library/unittest.mock.html#unittest.mock.Mock.call_args_list)`mock`。

**`[0][0][0]`最后解释一下**：

1.  这`call_args_list`是一个`call`对象列表，看起来像这样`[call("something")]`。所以第一个`[0]`是返回第一个`call`对象。

2.  第二个`[0]`返回对象的参数元组`call`。它看起来像这样`("something",)`。

3.  第三`[0]`返回`logger`在我们的例子中给出的第一个参数。所以最后的字符串将是 only `"something"`。

# r - 从 R 连接到 Bloomberg

> ID：11165357
> 
> 赞同：0
> 
> 时间：2012-06-22T23:21:00.953
> 
> 标签：r, bloomberg

我收到错误：

```
Error in .jnew("org/findata/blpwrapper/Connection", java.log.level) : 
  org.findata.blpwrapper.WrapperException: Session not started because: Failed to connect server: localhost/127.0.0.1:8194 
```

当我在 R 2.15.0 上运行命令 blpConnect()

这是整个输出：

```
> blpConnect()
R version 2.15.0 (2012-03-30) 
rJava Version 0.9-3 
Rbbg Version 0.4-153 
Java environment initialized successfully.
Looking for most recent blpapi3.jar file...
Adding C:\blp\API\blpapi3.jar to Java classpath
Error in .jnew("org/findata/blpwrapper/Connection", java.log.level) : 
  org.findata.blpwrapper.WrapperException: Session not started because: Failed to connect server: localhost/127.0.0.1:8194 
```

我不知道那是什么意思？

提前致谢。

# verification - 降水预报验证

> ID：11165362
> 
> 赞同：0
> 
> 时间：2012-06-22T23:21:46.870
> 
> 标签：verification, forecasting

我想知道是否有人可以帮助我使用 R 验证包进行一些验证分析。我有两组降水数据，一组是在 20x20x100（纬度 x 经度 x 天）矩阵上的观察，另一组是 20x20x100x5 上的模型结果，其中最后一个维度是集合成员。换句话说，该模型在相同的 100 天内运行了 5 次。

我的目标是根据这些数据绘制可靠性图。数据以英寸/天为单位。

我的主要问题是：1）如何根据这个数据集得到预测概率？换句话说，如何从英寸/天到二进制或分类预测？

2）我想首先我需要选择一些参考值（三分位数？），我将使用它们来获得我的二进制/分类结果。但我不知道如何做到这一点。

任何帮助将不胜感激。谢谢你。亚历克斯·K。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T02:56:55.133

您可以通过首先定义一个阈值来更改为二进制 [0,1]，例如平均降水量 (x1)，然后确定预测值是超过 [1] 还是不超过 [0] 阈值。有了预测类别 (0,1) 后，您现在可以根据观察到的值对其进行测试，以查看哪些同意或不同意...例如，您可以去

预测 <- ifelse(observed$value==x1,0, 1 & ifelse(observed$value>x1,1,0)) 观察到 <- ifelse(observed$value<=x1,0,1)

接下来，您可以使用验证包 Ver<-verify(forecast,observed, frcst.type = "binary", obs.type = "binary") summary(Ver) 中的 verify 函数评估预测和观察之间的一致性

这并不详尽，我希望它有所帮助。理查德：悉尼大学

# php - PHP为Android Dev返回不同的JSON数据

> ID：11165363
> 
> 赞同：1
> 
> 时间：2012-06-22T23:22:23.923
> 
> 标签：php, android, json

所以我希望返回一个 JSON 数组，其中包含来自 PHP 页面的特定数据，具体取决于我提供的参数/值（该信息将由 Android 应用程序使用）。但是我不相信这是最好的方法，例如我可以使用类似的东西。

page.php?allcategories

page.php?specificcategory=12

page.php?specificpage=55

（我可能总共有大约 7 种不同的参数类型）。

显然在 PHP 脚本中，我只需要几个条件语句来测试这些参数是否存在。

有没有更强大或简单“更好”的方法来做我想要实现的目标？因为这是我的第一个想法。

非常感谢

# inno-setup - 如何在卸载过程中替换或消除 InnoSetup 'Are you sure' 提示

> ID：11165369
> 
> 赞同：2
> 
> 时间：2012-06-22T23:23:37.603
> 
> 标签：inno-setup

我被要求自定义在卸载我们使用 InnoSetup 5 构建的产品时询问的“您确定”问题。有没有办法在卸载期间用自定义操作替换文本或整个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-23T23:39:12.333

不要修改`Default.isl`，而只需在脚本中添加一个部分并为那里的值`[Messages]`指定一个覆盖。`ConfirmUninstall`

或者，您可以创建一个新`.isl`文件（仅包含该部分）并通过该部分在脚本中`[Messages]`指定它和原始文件。（您只需要指定要覆盖的特定消息；其他所有内容都将级联到默认文件。）`Default.isl``[Languages]`

# javascript - Rails 3 使用 Jquery 远程提交单选按钮表单（不使用 $.post）？

> ID：11165371
> 
> 赞同：1
> 
> 时间：2012-06-22T23:23:48.970
> 
> 标签：javascript, jquery, ruby-on-rails, ruby-on-rails-3

我想知道是否有办法用 jQuery 提交单选按钮的形式。我遇到的问题是我正在将一个开始评级 jQuery 插件应用到一个 rails 表单，并且这个插件有它自己的点击回调。我想简单地告诉 Rails 表单从这个回调中提交。

这是rails中的表格：

```
<%= form_for([@contact, @contact.overall_ratings.new],
                :remote => true, 
                :format => :js) do |f| %>
    <%-# TODO set these up in a loop %>
    <%= f.radio_button :rating, 1, {:class => "star"} %>
    <%= f.radio_button :rating, 2, {:class => "star"} %>
    <%= f.radio_button :rating, 3, {:class => "star"} %>
    <%= f.radio_button :rating, 4, {:class => "star"} %>
    <%= f.radio_button :rating, 5, {:class => "star"} %>

<% end %> 
```

这是对插件的调用以及回调：

```
$(function(){ 

    $('input.star').rating({
            callback: function(value, link){
                //get parent form
                var form = $(this).parent();
                $(form).submit();

            }
    });

}); 
```

到目前为止，我所遇到的问题是它正在重定向到 .js 文件。似乎它不遵守对 :remote => true 的表单调用，这并不让我感到惊讶，因为我是从插件回调中调用它的。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T08:54:39.437

关于什么

```
$('input.star').click(function(){ $(this).parent().submit(); return true; }); 
```

? 这将在设置无线电输入的值后触发表单提交，因此无论如何它都会起作用。

另外 - 你确定 jquery_ujs 是从 application.js 中正确引用的吗？因为看起来，这种形式没有被设置为远程。

最后 -`:format=>:js`这里不需要 IMO，因为格式也取自标题。

# gcc - 使用 GCC（内联汇编器）将 double 加载到 FPU

> ID：11165379
> 
> 赞同：2
> 
> 时间：2012-06-22T23:25:27.463
> 
> 标签：gcc, assembly, double, gnu-assembler, fpu

我一直在尝试使用 GCC 内联汇编将 a 加载`double`到 FPU 。`FLD`

由于不太熟悉 AT&T 语法，也没有在网上找到任何东西，我非常感谢您的帮助。我的意图是加载 to 的地址，`a`然后`EAX`执行`FLD [EAX]`...

```
double atl(double a, int adr) {
    __asm ("movl ptr %0,%%eax"::"r"(a));
    __asm ("fld qword (%eax)");
    //.... some other code here
    __asm("movl ptr %0,%%eax"::"r"(a));
    __asm("fst qword (%eax)");
    return a;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-22T23:54:12.877

最简单的方法是使用[约束 "m"](http://gcc.gnu.org/onlinedocs/gcc/Simple-Constraints.html#Simple-Constraints)来加载/保存到内存位置：

```
#include <stdio.h>
int main (void) {
    double a = 0.78539816339744;
    asm ("fldl %0;"
         "fsin;"
         "fstpl %0" : "+m"(a));
    printf("sin(45°) = %f\n", a);
    return 0;
} 
```

[修饰符“+”](http://gcc.gnu.org/onlinedocs/gcc/Modifiers.html#Modifiers)告诉编译器你希望你的输入在那个内存位置并输出到同一个位置。

GCC 被允许重新排序你的行，但它会知道该行的语义，并且会相应地进行优化。

一个更困难的例子，使用来自其他变量的加载，而不是要写入的变量：

```
#include <stdio.h>
int main (void) {
    double sin_a, cos_a, a = 0.5;
    asm ("fldl %2;"
         "fsincos;"
         "fstpl %1;"
         "fstpl %0;" : "=m"(sin_a), "=m"(cos_a) : "m"(a));
    printf("sin(29°) = %f, cos(29°) = %f\n", sin_a, cos_a);
    return 0;
} 
```

现场演示：http: [//ideone.com/SuvpM](http://ideone.com/SuvpM)。

~~PS：不过，我无法让 GCC 加载**双精度**值，所以我不知道我的回答是否对您有用。:-(~~

### 更新：

明白了：您需要显式附加`s`（对于单 [32 位]，如`flds`浮点加载单）、`l`（对于双 [64 位]）或`t`（对于长双 [80 位]）。我的 GCC 4.6.3 假定每个内存操作数都有一个值……</p>

# python - Python：如何按叶值过滤字典的 n 嵌套字典？

> ID：11165381
> 
> 赞同：7
> 
> 时间：2012-06-22T23:25:58.643
> 
> 标签：python, dictionary, nested

我有一个看起来像这样的字典：

```
d = {'Food': {'Fruit'  : {'Apples'    : {'Golden Del.'  : ['Yellow'],
                                         'Granny Smith' : ['Green'],
                                         'Fuji'         : ['Red'],    
                                        },
                          'Cherries'  : ['Red'],
                          'Bananas'   : ['Yellow'],
                          'Grapes'    : {'Red Grapes'   : ['Red'],
                                         'Green Grapes' : ['Green'],  
                                        },
                          },
              'Dessert': {'Baked Ds' : {'Cakes'         : {'Yellow Cake' : ['Yellow'],
                                                           'Red Velvet'  : ['Red'],
                                                          },
                                         'Cookies'      : ['Yellow'],
                                        },
                          },
              'Steak'  : ['Red'],
             },
     'Other': ['Blue'],
    } 
```

所以基本上，一个 n 嵌套的字典，其中每个值要么是另一个字典，要么是一个包含单个项目的列表。

假设我想通过单个列表项过滤它，比如“红色”，结果将是：

```
d = {'Food': {'Fruit'  : {'Apples'    : {'Fuji'        : ['Red'],    
                                        },
                          'Cherries'  : ['Red'],
                          'Grapes'    : {'Red Grapes'  : ['Red'], 
                                        },
                          },
              'Dessert': {'Baked Ds' : {'Cakes'        : {'Red Velvet'  : ['Red'],
                                                          },
                                        },
                          },
              'Steak'  : ['Red'],
             },
    } 
```

这样结构保持不变，但列表项中没有“红色”的所有内容都被删除，一直到层次结构。

有什么建议么？我已经搞砸了一段时间并想出了这个，但它似乎不起作用：

```
def filterNestedDict(node, searchItem):
    if isinstance(node,list):
        return node
    else:
        for key, value in node.iteritems():
            if isinstance(value,dict) and value is not {}:
                return {key: filterNestedDict(value,searchItem)}
            elif searchItem in value:
                return {key: filterNestedDict(value,searchItem)}

return filterNestedDict(bigTree, searchItem) 
```

我怀疑这只是递归问题，但任何建议将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-22T23:53:48.470

你非常接近，这应该为你解决问题：

```
def filter_nested_dict(node, search_term):
    if isinstance(node, list):
        if node[0] == search_term:
            return node
        else:
            return None
    else:
        dupe_node = {}
        for key, val in node.iteritems():
            cur_node = filter_nested_dict(val, search_term)
            if cur_node:
                dupe_node[key] = cur_node
        return dupe_node or None 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T00:46:11.073

```
from collections import Mapping

def yield_values_2(d):
  for key in d.keys():
    if isinstance(d[key], Mapping):
      yield_values_2(d[key]) 
      if not d[key]:
        del d[key]
    elif d[key] != ["Red"]:
      del d[key]

d = {'Food': {'Fruit'  : {'Apples'    : {'Fuji'        : ['Red'], 'Fuji2': ['Blue']    
                                        },
                                                                  'Cherries'  : ['Red'],
                                                                                            'Grapes'    : {'Red Grapes'  : ['Red'], 
                                                                                                                                    },
                                                                                                                                                              },
                                                                                                                                                                            'Dessert': {'Baked Ds' : {'Cakes'        : {'Red Velvet'  : ['Red'],
                                                                                                                                                                                                                                      },
                                                                                                                                                                                                                                                                              },
                                                                                                                                                                                                                                                                                                        },
                                                                                                                                                                                                                                                                                                                      'Steak'  : ['Red'],
                                                                                                                                                                                                                                                                                                                                   },
                                                                                                                                                                                                                                                                                                                                       }

print d
yield_values_2(d)
print d 
```

# image-processing - RGB 的伽马校正算法与灰度相同吗？

> ID：11165391
> 
> 赞同：2
> 
> 时间：2012-06-22T23:26:59.223
> 
> 标签：image-processing, rgb, grayscale

RGB 的伽马校正算法是否与灰度图像相同？

我知道如何对单通道灰度图像进行伽马校正。我对 RGB 图像中的所有通道都做同样的事情吗？还是有不同的算法？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-22T23:31:52.217

您可以在每个通道上使用不同的 gamma 值，但是是的，它是相同的算法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-24T07:09:18.223

您可以将 RGB 图像转换为 HSL 颜色空间并仅在 Luma 通道上应用伽玛。

# javascript - 未捕获的类型错误：对象# has no method 'newsticker' I've done a search, and I've found a few results, but none that seem to work - hoping someone can help me or point me in the right direction. I have a web page with jQuery load 问问题 问问题 2012-06-22T23:27:46.817 808 次 This question shows research effort; it is useful and clear 1 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. I've done a search, and I've found a few results, but none that seem to work - hoping someone can help me or point me in the right direction. I have a web page with jQuery loaded and a 3rd party script, News Ticker. I have an existing site with this working fine with no problems, however, when I copy the code to another side, I keep getting: Uncaught TypeError: Object # has no method 'newsticker' The code causing this error is the following: $(document).ready(function() { $("#guestbook").newsticker(); }); The News Ticker script details can be seen at their site - http://www.texotela.co.uk/code/jquery/newsticker/. Thanks in advance! Following up on my comment: B1 Xor B2 < 2^K if and only if B1 and B2 agree on all but the K low order bits, so G has the very special structure of being complete multipartite, with partition labels consisting of all but the K low order bits. A complete multipartite graph is Hamiltonian if and only if there is no majority partition. Plug this fact into Attempt 2. javascriptjquery 4 2 回答 2 This answer is useful 0 因为 newsTicker有一个大写 T $("#guestbook").newsTicker(); 您必须警惕 JS 在其语法中区分大小写。 于 2012-06-22T23:29:18.023 回答 This answer is useful 0 该元素可能不存在。尝试这个： $(document).ready(function() { alert("jQuery loaded!"); if($("#guestbook").length == 0) alert("#guestbook doesn't exist"); else if(!('newsTicker' in $("#guestbook"))) alert("newsTicker not loaded"); else $("#guestbook").newsTicker(); }); 于 2012-06-22T23:32:43.900 回答 Related 0 facebook - 某些用户的 FQL 权限问题 2 c# - 如何在设置类型等方法中设置参数 1 tinymce - 使用 CSS 样式表的自定义格式 1 iphone - 查看上的保存并重新加载按钮（错误在哪里？） 3 c++ - c++ 访问者模式：为什么每个派生访问者都应该实现 Accept()？ 0 search - 活动脚手架：如何过滤查询 3 php - AJAX - 多个 div 的 PHP 更新 1 windows - 在 Windows 驱动程序中创建符号链接（或其他 NTFS 重解析点） 4 php - 从 MySQL 迁移到 MySQLi 1 android - 我应该为 admob 更改目标 sdk 版本 13 吗？ Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：11165399
> 
> 赞同：1
> 
> 时间：
> 
> 标签：javascript, jquery

I've done a search, and I've found a few results, but none that seem to work - hoping someone can help me or point me in the right direction.

I have a web page with jQuery loaded and a 3rd party script, News Ticker. I have an existing site with this working fine with no problems, however, when I copy the code to another side, I keep getting:
`Uncaught TypeError: Object #<Object> has no method 'newsticker'`

The code causing this error is the following:

```
$(document).ready(function() {
    $("#guestbook").newsticker();
}); 
```

The News Ticker script details can be seen at their site - [http://www.texotela.co.uk/code/jquery/newsticker/](http://www.texotela.co.uk/code/jquery/newsticker/).

Thanks in advance!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T23:29:18.023

因为 newsTicker**有一个大写 T**

```
$("#guestbook").newsTicker(); 
```

您必须警惕 JS 在其语法中区分大小写。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T23:32:43.900

该元素可能不存在。尝试这个：

```
$(document).ready(function() {

    alert("jQuery loaded!");

    if($("#guestbook").length == 0)
        alert("#guestbook doesn't exist");
    else if(!('newsTicker' in $("#guestbook")))
        alert("newsTicker not loaded");
    else
        $("#guestbook").newsTicker();
}); 
```

# php - pecl 在生产服务器问题上安装扩展

> ID：11165400
> 
> 赞同：5
> 
> 时间：2012-06-22T23:27:53.030
> 
> 标签：php, production-environment, pecl

所以我在本地安装了 pecl oauth 模块，一切正常。然后我尝试为生产服务器执行此操作，但遇到了一些问题。

如果我说 sudo pecl install oauth，我会收到以下错误：

```
No releases available for package "pecl.php.net/oauth"
install failed 
```

所以我想我必须更新 pecl.php.net，所以我尝试了命令`sudo pecl channel-update pecl.php.net`，但随后我得到了这个输出：

```
Updating channel "pecl.php.net"
Channel "pecl.php.net" is not responding over http://, failed with message:
Connection to 'pecl.php.net:80' failed: Connection refused
Trying channel "pecl.php.net" over https:// instead
Cannot retrieve channel.xml for channel "pecl.php.net" (Connection to `pecl.php.net:443' failed: Connection refused) 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-25T19:12:39.443

好的，我想出了一个解决办法。你设置了一个代理，但是不能正常导出http_proxy:方式。这是命令：

```
sudo pear config-set http_proxy http://username:password@yourproxy:yourport 
```

# wordpress - Wordpress Pinterest Pin It Button. Manual Code

> ID：11165403
> 
> 赞同：1
> 
> 时间：2012-06-22T23:28:04.277
> 
> 标签：wordpress, pinterest

I have some Pinterest code to show a Pin it button on my wordpress posts but it only grabs the post thumbnail. What I want is to grab the first post content image and only grab the thumbnail if there are no images in the post!??

Have tried tons of examples but nothing works.

```
<a href="http://pinterest.com/pin/create/button/?url=<?php the_permalink(); ?>&media=<?php $thumb = wp_get_attachment_image_src( get_post_thumbnail_id($post->ID), 'thumbnail' ); echo $thumb['0']; ?>&description=<?php the_title(); ?>" class="pin-it-button" count-layout="horizontal">Pin It</a> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T02:55:12.120

您可以试试这个，只需将以下功能粘贴到您的`functions.php`

```
function get_first_image()
{
    global $post, $posts;
    $first_img = '';
    $output = preg_match_all('/<img.+src=[\'"]([^\'"]+)[\'"].*>/i', $post->post_content, $matches);
    $first_img = $matches [1][0];
    if(empty($first_img)) $first_img = false;
    return $first_img;
} 
```

在您的`Pinterest`代码获取图像之前

```
$thumb=get_first_image();
if(!$thumb)
{
    $thumb=wp_get_attachment_image_src( get_post_thumbnail_id($post->ID), 'thumbnail' );
    $thumb=$thumb[0];
} 
```

然后在你的`Pinterest`链接`media=<?php echo $thumb; ?>`

```
<a href="http://pinterest.com/pin/create/button/?url=<?php the_permalink(); ?>&media=<?php echo $thumb; ?>&description=<?php the_title(); ?>" class="pin-it-button" count-layout="horizontal">Pin It</a> 
```

# java - 套接字上的 InputStreamReader 未完全读取 POST 请求

> ID：11165409
> 
> 赞同：1
> 
> 时间：2012-06-22T23:28:41.157
> 
> 标签：java, sockets

我有以下代码：

```
ServerSocket ss = new ServerSocket(2351);

Socket s = ss.accept();
InputStreamReader in = new InputStreamReader(s.getInputStream());
writer = new PrintWriter(s.getOutputStream());
writer.flush();

cbuf = new char[buf_length];
in.read(cbuf);
inputLine = new String(cbuf); 
```

我连续四次发送到我的服务器，当我调试上面的代码时，它正确运行了三次。另一次，以下是从套接字读取的我的 inputLine：

```
POST /record HTTP/1.1
Content-type: application/soap+xml;charset="utf-8";action=""
Accept: application/soap+xml, multipart/related, text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2
User-Agent: JAX-WS RI 2.1.5-b03-
Host: localhost:2351
Connection: keep-alive
Content-Length: 2197 
```

内容只是 2197 个空格，而不是 2197 个长度的内容。它真的很奇怪，我被困住了。任何帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T23:32:37.037

您假设 in.read() 填充缓冲区。你不能这样假设。请参阅 Javadoc。由于 EOS，它只需要读取至少一个字符，或者返回 -1。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T23:54:39.983

我会尽量让 EJP 的答案更具体。代替

```
n.read(cbuf);
inputLine = new String(cbuf); 
```

您需要执行以下操作：

```
StringBuilder sb = new StringBuilder();
int charsRead;
while ((charsRead = n.read(cbuf)) != -1) {
    sb.append(cbuf, 0, charsRead);
}
inputLine = sb.toString(); 
```

这可能不是您所问问题的答案，但这绝对是您发布的代码中的一个错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-23T02:28:17.570

@EJP：我重写了我的代码，它终于可以工作了。问题是 in.read() 在某些情况下第一次尝试时只读取 POST 请求的标头。我必须检查内容长度字段，如果它少于您指出的读取字符数，我必须再次执行 in.read() 才能完全获取请求。谢谢大家！

# jquery - 关于 JSON 的实际限制的反馈？

> ID：11165417
> 
> 赞同：2
> 
> 时间：2012-06-22T23:29:42.920
> 
> 标签：jquery, asp.net, json

我正处于应用程序设计的关键决策点。它是一个 ASP.NET Web 应用程序，它使用 REST 来请求有关各种产品的信息。某些产品具有不同的 ProductID，具体取决于它们的属性/变体。例如，用户可能对 Rogaine 感兴趣。关于 Rogain 的 REST 请求可能会返回包含多个变体的响应 - 1 个月的供应量、3 个月的供应量或 4 个月的供应量。这些变体中的每一个都有不同的 ProductID、不同的正常价格、不同的销售价格和许多不同的属性。每个产品都有一组不同的“功能”、不同的图像等。每个产品的属性数量可能非常多。

在大多数情况下，只有几个产品变体。有时半打，有时一打或两个。在这些情况下，JSON 可以轻松处理我的要求。

但以连衣裙为例。它可能有几十种颜色可供选择。它也有 6 种不同的尺寸可供选择。您不希望在它们自己的页面上显示这些中的每一个。在单个页面上显示此产品并呈现这些尺寸和颜色选项供用户选择更加用户友好。也许他们想订购红色的小尺寸。

在上面的示例中，有近 100 种选项组合。在这一点上，我认为 JSON 对我来说是一个不切实际的选择。对于每个独特的组合，都有多个图像链接（每个图像以不同的颜色显示产品）。每个产品都有标价、常规价格和销售价格，节省的金额。每个都有运输属性。每个都有自己的功能列表，可以是每个产品的文本段落。

好的，我的意思是 - 这是要填充到 JSON 字符串中的大量数据，并且当颜色或大小发生更改时，查找详细信息会有延迟。

我喜欢亚马逊提供选择的方式。这是这种情况的链接：

[http://www.amazon.com/American-Apparel-Jersey-Chemise-Small-Navy/dp/B003ILSHQ2/](https://rads.stackoverflow.com/amzn/click/com/B003ILSHQ2)

我查看了源页面，没有看到他们在客户端存储每个产品的详细信息的位置。如果您将鼠标悬停在每个颜色样本上，您会看到页面上的所有细节都发生了变化。价格、运费、大图、功能。几乎一切都在改变。

我偶尔会看到“正在加载...”指示器，但在大多数情况下，它是如此之快，以至于您看不到任何客户端/服务器通信的迹象。

他们如何在不完全重新加载页面并且不将这些信息存储在客户端上的情况下做到这一点？他们用的是什么技术，有人知道吗？

相信我，每次更改产品变体时发送另一个 REST 请求的往返行程太贵了。在我的第一个 REST 响应中，我已经拥有每个产品的*所有*数据。数据不在我的服务器上或我的控制范围内，我真的不想将其保存在我的服务器上。

由于我已经拥有所有数据，因此我想将其存储起来，以便可以像亚马逊一样使用它，但我想将其交给客户。使用 JSON 字符串将是完美的，在大多数情况下，我可以......但不是有效/高效。

有没有办法索引 JSON 字符串以使其更快地处理大量数据？JSON 是不是太多了？我还可以在 JQuery/Javascript 中使用哪些其他选项？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T00:26:05.997

我目前正在编写一个应用程序，我从各种来源获取 JSON 负载，然后将它们存储在 localStorage 中。它们是一组 Facebook、Twitter 和 RSS 订阅源。我通过应用程序分配的唯一 ID 构建提要索引，并将其存储为一个数组，每个 ID 都与一个表示类型的字符串相关联，即 FBK/TWI/RSS 和一个带有提要标题的字符串。

然后，我为每个提要存储一个数组数组，其中包含从它们获取的帖子的数据。

使用 5Mb，这是一个可行的设置。如果您需要存储的数据不超过这个值，我可以想象它不会，它也适用于您。在更改页面时，您可以清除存储空间并下载您的下一个产品对象。

很难想象一个 50kB 的对象会超过 JSON + localStorage 的组合能力 :-) 虽然我确信我即将被告知为什么我错了哈哈！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-26T12:09:33.797

charlietfl 最好地回答了我的问题，但我无法将他的回答标记为答案，因为他没有发布答案，只是发表评论。谢谢charlietfl。

# c# - 如何 NMock FileStream？

> ID：11165418
> 
> 赞同：2
> 
> 时间：2012-06-22T23:29:55.597
> 
> 标签：c#, unit-testing, nmock2

我的单元测试中有这段代码：

```
var file = m_Mockery.NewMock<IFile>();
Stream s = new MemoryStream();

Expect.Once.On( file ).Method( "OpenRead" )
.With( "someFile.mdb")
.Will( Return.Value( s ) );
...
...
...

// this runs the real code that contains the OpenRead call
productionCodeObj.DoIt("someFile.mdb");
m_Mockery.VerifyAllExpectationsHaveBeenMet(); 
```

问题是当我调用 DoIt（它调用 OpenRead）时，我得到一个异常，说找不到文件。我是否误解了 nmock 的作用？我不希望我的单元测试碰到真正的文件系统......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T03:04:30.187

是的，我认为您误解了 NMock 的功能。它用于创建传递给被测对象的对象，以便它们作用于那些模拟对象。似乎您的“productionCodeObj”会通知一个`FileStream`实例本身，因此它不会使用您的模拟。你必须`file`进入它。

# google-maps - 如何限制 GMap 并避免重复地图？

> ID：11165420
> 
> 赞同：0
> 
> 时间：2012-06-22T23:30:11.480
> 
> 标签：google-maps

我正在尝试使用 GMaps，但我想避免这种行为：

![在此处输入图像描述](../Images/f6ad08bb0ea5859290d781f29e33294b.png)

我不想限制缩放。我想限制世界地图的重复。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T23:34:29.517

在您的`MapOptions`对象中，放置一个`minZoom`. 3 应该这样做，但这取决于您映射 div 的大小：

```
 var myOptions = {
          center: new google.maps.LatLng(-34.397, 150.644),
          zoom: 3,
          minZoom:3,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T23:45:39.777

Without restricting zoom, I have seen artificial workarounds. It depends how you have your page set up.

If the map takes up the whole width of the webpage, I think changing the div's width on zoom change is best.

If you have content around the map, you can try setting up gray div "curtains" that block part of the original map's div, so it appears that the map viewport shrunk. The big disadvantage is you will have to cover up the map controls if the viewport needs to stay centered.

See sample code here: [**mutiple occurance of single country in google map**](https://stackoverflow.com/questions/10779992/mutiple-occurance-of-single-country-in-google-map/10789395#10789395)

# python - 使用 Celery 2.6.0rc5 时发生 TypeError

> ID：11165422
> 
> 赞同：0
> 
> 时间：2012-06-22T23:30:24.700
> 
> 标签：python, redis, celery, celery-task

我正在使用[Celery 2.6.0rc5](https://github.com/celery/celery)，并收到以下错误：

```
[2012-06-22 23:01:42,016: ERROR/MainProcess] Unrecoverable error: TypeError('handle_event() takes exactly 3 arguments (1 given)',)
Traceback (most recent call last):
  File "/home/bmh/celery/celery/worker/__init__.py", line 350, in start
    component.start()
  File "/home/bmh/celery/celery/worker/consumer.py", line 369, in start
    self.consume_messages()
  File "/home/bmh/celery/celery/worker/consumer.py", line 435, in consume_messages
    readers[fileno](fileno, event)
  File "/home/bmh/kombu/kombu/transport/redis.py", line 636, in handle_event
    self._callbacks[queue](message)
  File "/home/bmh/kombu/kombu/transport/virtual/__init__.py", line 461, in _callback
    return callback(message)
  File "/home/bmh/kombu/kombu/messaging.py", line 482, in _receive_callback
    self.receive(decoded, message)
  File "/home/bmh/kombu/kombu/messaging.py", line 454, in receive
    [callback(body, message) for callback in callbacks]
  File "/home/bmh/celery/celery/worker/consumer.py", line 397, in on_task_received
    [callback() for callback in on_task_callbacks]
TypeError: handle_event() takes exactly 3 arguments (1 given) 
```

我[刚才从 git 中提取了 kombu 和 celery](https://github.com/celery/celery#using-the-development-version)`redis-server` ，并在安装了 (2:2.2.12-1build1) 作为代理的 Ubuntu 12.04 LTS 上进行了尝试。

我的配置（`celeryconfig.py`）是：

```
BROKER_URL = "redis://localhost:6379/0"
BACKEND_URL = BROKER_URL
CELERY_RESULT_BACKEND = "redis"
CELERY_REDIS_HOST = "localhost"
CELERY_REDIS_PORT = 6379
CELERY_REDIS_DB = 0 
```

我的工人 ( `worker.py`) 是：

```
#!/usr/bin/python2.7
from celery import Celery

celery = Celery()

celery.config_from_object('celeryconfig')

@celery.task(ignore_result=True)
def atest(data):
    print "Got data: %s" % data

if __name__ == "__main__":
    celery.start() 
```

当我使用 运行worker 时`$ ./worker.py worker`，我从python shell 调用worker 如下：

```
import worker
worker.atest("abc") 
```

工人报告上述错误，报告一个更长的错误，最终以工人退出以下情况结束：

```
[2012-06-22 23:01:43,025: WARNING/MainProcess] File "/home/bmh/kombu/kombu/utils/eventio.py", line 95, in unregister
[2012-06-22 23:01:43,025: WARNING/MainProcess] self._epoll.unregister(fd)
[2012-06-22 23:01:43,025: WARNING/MainProcess] ValueError
[2012-06-22 23:01:43,025: WARNING/MainProcess] :
[2012-06-22 23:01:43,026: WARNING/MainProcess] I/O operation on closed epoll fd 
```

顺便说一句，当我运行`$ ./worker.py shell`并运行“import kombu;kombu.version **”**时，它会报告 2.2.2，据我所知是最新版本。可能还值得注意的是，[其他人遇到了这个问题](https://github.com/celery/celery/issues/808)，但似乎通过更新 kombu 解决了这个问题。

因为这真的是我能想象到的最简单的 celery 项目，我对 celery 完全陌生，而且这是一个开发版本，我有点不知道从哪里开始，如果有任何帮助，我将不胜感激。

感谢您的阅读。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T00:32:03.547

我似乎已经通过更新到最新版本的[台球](https://github.com/celery/billiard)来解决这个问题：

```
$ git clone https://github.com/celery/billiard
$ cd billiard 
$ python setup.py develop 
```

# python - 为什么我的python函数没有定义，当它存在于同一个文件中时？

> ID：11165423
> 
> 赞同：5
> 
> 时间：2012-06-22T23:30:28.910
> 
> 标签：python, function, nameerror, defined

我有一个简单的函数，我将调用它`myFunction`。它接受两个参数，对它们执行一些计算，然后返回结果。

我还有一个类，`MyClass`它有一个构造函数，它的标题如下：

```
__init__(self, bar, fun=myFunction): 
```

当我尝试在此类中运行任何内容时，出现以下错误：

```
MyClass
    def __init__(self, bar, fun=myFunction):
NameError: name 'myFunction' is not defined 
```

如果我删除这个类，我可以在 Python Shell 中使用 myFun，那么有什么关系呢？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-22T23:45:05.533

您没有显示实际代码，因此很难确定，但我敢打赌`myFunction`是在`MyClass`. 默认值表达式在`__init__`定义方法时进行评估，因此`myFunction`必须在该点定义。稍后定义它为时已晚。

* * *

## 回答 #2

> 赞同：-6
> 
> 时间：2012-06-22T23:33:43.400

myFunction 是一个变量，而不是一个值，因此您不能将其用作默认参数。

也许您可以使用 lambda 函数作为默认参数，而不是声明函数的名称。

# web2py - 使用 lambda 排序时出错

> ID：11165424
> 
> 赞同：1
> 
> 时间：2012-06-22T23:30:31.840
> 
> 标签：web2py

我对 web2py 比较陌生，并且在使用这种排序功能时遇到了问题：

```
sorted_rows = day_rows.sort(lambda r: r.inspection) 
```

这会导致错误：

```
<type 'exceptions.TypeError'> <lambda>() takes exactly 1 argument (2 given) 
```

day_rows 是数据库选择的结果，在这种情况下，它有大约 20 行。

我显然错过了一些基本的东西，但我无法弄清楚。我将不胜感激任何帮助。

谢谢，约翰

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-23T03:50:43.843

我猜您将 day_rows 转换为字典列表（因此它不再是 DAL Rows 对象），可能会执行类似`db(db.mytable).select().as_list()`. 在这种情况下，您正在调用`sort()`标准 Python`list`对象的方法，其第二个参数是“cmp”，它接受两个参数。如果要将 day_rows 保留为列表，可以执行以下操作：

```
day_rows.sort(key=lambda r: r['inspection']) 
```

虽然这会对列表进行排序，而不是返回一个新列表。如果您想要一个新列表，请执行以下操作：

```
sorted_rows = sorted(day_rows, key=lambda r: r['inspection']) 
```

否则，将 day_rows 保留为 DAL`Rows`对象，您的原始代码应该可以工作。

# php - 从类中静态调用实例方法

> ID：11165429
> 
> 赞同：5
> 
> 时间：2012-06-22T23:30:53.980
> 
> 标签：php

根据手册页之一[http://www.php.net/manual/en/language.oop5.static.php](http://www.php.net/manual/en/language.oop5.static.php)：

> 静态调用非静态方法会生成 E_STRICT 级别的警告。

*但是，当从类内部*进行调用时，情况似乎并非如此：

```
error_reporting(-1);

class Test {
    private $id;
    function __construct($id) { $this->id = $id; }
    function id() { return $this->id; }

    function __toString() {
        return Test::id()
             . self::id()
             . static::id()
             . static::id()
             . call_user_func('Test::id')
             . call_user_func(array('Test', 'id'));
    }
}
$a = new Test('a');
$b = new Test('b');

echo "$a $b $a"; # aaaaaa bbbbbb aaaaaa
var_dump(error_get_last()); # NULL 
```

使用 php 5.4 进行测试

**演示：** [http ://codepad.viper-7.com/IKp9iX](http://codepad.viper-7.com/IKp9iX)

我相信我已经证明：

*   不生成 E_STRICT 警告
*   该php神奇地将静态方法调用更正为实例方法调用（访问实例变量`id`证明了这一点）。

**编辑-** 我想补充一点，将[debug_backtrace](http://www.php.net/debug_backtrace) () 插入到 __toString 调用中会产生一个调用“类型” `->`，这意味着“方法调用”。

这是一个错误，还是记录在案的功能？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-22T23:43:05.417

*如果您在任何*类（不仅仅是声明类）中使用静态语法调用非静态函数，则该非静态函数的行为*就像在当前***$this**对象的上下文中调用它一样。

这意味着我可以在我的班级中使用来自其他班级的方法，并且这些方法将*假定*我班级的**$this**是他们的班级' **$this**。如果他们不检查，`InstanceOf`或者`get_class()`他们的行为将与往常完全相同。

当我像往常一样说时，我的意思是他们会假设您的类' **$this具有他们的类'** **$this**将具有的所有其他方法和属性。

这（我认为）称为对象上下文绑定。在 JavaScript 中，您必须使用这些`call()`和/或`apply()`方法来使函数表现得好像它附加到某个对象一样。但在 PHP 中，它只是通过在非静态函数上使用静态语法来工作。

我记得这在 C++ 中也有效，但我不记得它是否仅在方法属于继承类时才有效（可能是您想要访问的被覆盖的方法，尽管它们被覆盖）。

使用这个（隐藏的）特性，您可以实现**装饰器**设计模式，通过该模式在运行时向对象添加新功能。您还可以模拟**Mixins**或**Traits**（PHP 5.4 现在原生支持），额外的好处是此实现在运行时处理，因此可以动态完成/撤消，而不是在编译时处理的语言功能实现并且不能动态完成/撤消，您必须更改代码才能更改功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T23:38:27.203

我会说这是[一个半文档化的功能](http://php.net/manual/en/language.oop5.late-static-bindings.php#example-223)：

> 在非静态上下文中，被调用的类将是对象实例的类。由于 $this-> 将尝试从同一范围调用私有方法，因此使用 static:: 可能会产生不同的结果。另一个区别是 static:: 只能引用静态属性。

换句话说（据我所知），它可以用来实现后期静态绑定：如果你在扩展你的测试的某个类中调用它们，使用`self::id()`and可能会给出不同的结果。`static::id()`

# php - 用于过滤恶意代码的 php 安全功能正在去除合法字符

> ID：11165430
> 
> 赞同：1
> 
> 时间：2012-06-22T23:30:57.813
> 
> 标签：php, security, function

我有一个安全功能，它是脚本的一部分。它应该过滤掉在输入表单中执行的恶意代码。它可以正常处理来自 AZ 的普通字符，但它会拒绝带有 á、ñ、ö 等字符的输入。

我该怎么做才能不拒绝带有这些字符的表单输入？这是功能：

```
function add_special_chars($string, $no_quotes = FALSE)
{
  $patterns = array(
      "/(?i)javascript:.+>/",
      "/(?i)vbscript:.+>/",
      "/(?i)<img.+onload.+>/",
      "/(?i)<body.+onload.+>/",
      "/(?i)<layer.+src.+>/", 
      "/(?i)<meta.+>/", 
      "/(?i)<style.+import.+>/",
      "/(?i)<style.+url.+>/"
  );

    $string = str_ireplace("&amp;","&",$string);

    if (!$no_quotes) $string = str_ireplace("&#039;","'",$string);

    $string = str_ireplace('&quot;','"',$string);
    $string = str_ireplace('&lt;','<',$string);
    $string = str_ireplace('&gt;','>',$string);
    $string = str_ireplace('&nbsp;',' ',$string);

  foreach ($patterns as $pattern)
  {
     if(preg_match($pattern, $string))
     {
        $string = strip_tags($string);
     }
  }      

  $string = preg_replace('#(&\#*\w+)[\x00-\x20]+;#u', "$1;", $string);
  $string = preg_replace('#(&\#x*)([0-9A-F]+);*#iu', "$1$2;", $string);

  $string = html_entity_decode($string, ENT_COMPAT, LANG_CODEPAGE);

  $string = preg_replace('#(<[^>]+[\x00-\x20\"\'\/])(on|xmlns)[^>]*>#iUu', "$1>", $string);

  $string = preg_replace('#([a-z]*)[\x00-\x20\/]*=[\x00-\x20\/]*([\`\'\"]*)[\x00-\x20\/]*j[\x00-\x20]*a[\x00-\x20]*v[\x00-\x20]*a[\x00-\x20]*s[\x00-\x20]*c[\x00-\x20]*r[\x00-\x20]*i[\x00-\x20]*p[\x00-\x20]*t[\x00-\x20]*:#iUu', '$1=$2nojavascript...', $string);
  $string = preg_replace('#([a-z]*)[\x00-\x20\/]*=[\x00-\x20\/]*([\`\'\"]*)[\x00-\x20\/]*v[\x00-\x20]*b[\x00-\x20]*s[\x00-\x20]*c[\x00-\x20]*r[\x00-\x20]*i[\x00-\x20]*p[\x00-\x20]*t[\x00-\x20]*:#iUu', '$1=$2novbscript...', $string);
  $string = preg_replace('#([a-z]*)[\x00-\x20\/]*=[\x00-\x20\/]*([\`\'\"]*)[\x00-\x20\/]*-moz-binding[\x00-\x20]*:#Uu', '$1=$2nomozbinding...', $string);
  $string = preg_replace('#([a-z]*)[\x00-\x20\/]*=[\x00-\x20\/]*([\`\'\"]*)[\x00-\x20\/]*data[\x00-\x20]*:#Uu', '$1=$2nodata...', $string);

  $string = preg_replace('#(<[^>]+[\x00-\x20\"\'\/])style[^>]*>#iUu', "$1>", $string);

  $string = preg_replace('#</*\w+:\w[^>]*>#i', "", $string);

  do
  {
     $original_string = $string;
     $string = preg_replace('#</*(applet|meta|xml|blink|link|embed|object|iframe|frame|frameset|ilayer|layer|bgsound|title|base)[^>]*>#i', "", $string);
  }
  while ($original_string != $string);   

    return $string;
} 
```

更新：我发现以下行似乎导致了问题，但不知道为什么：

```
 $string = preg_replace('#(<[^>]+[\x00-\x20\"\'\/])style[^>]*>#iUu', "$1>", $string); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-23T00:13:04.753

这是一个坏主意。你的函数最糟糕的部分是`htmlentity_decode()`一半，它完全破坏了这个函数的前 1/2。攻击者只需对引号和括号进行编码，您只需为攻击者构建有效载荷。 `strip_tags()`是个玩笑，并不是防范 XSS 的好方法。这个函数的主要问题是它太简单了。 [HTMLPurifer](http://htmlpurifier.org/)由**数千个**正则表达式组成，它做得更好，但并不完美。

您几乎没有解决最常见的 XSS 形式。 [XSS 是一个输出问题](https://sitewat.ch/en/Blog/5)，你不能指望通过一些神奇的功能传递所有输入并假设它是安全的。XSS 取决于**它的使用方式**。

在没有实际运行您的代码的情况下，我认为这样的事情会绕过它：

```
<a href='jav&#x41%3b&#x53%3bcript&#x3a%3balert(1)'>so very broken</a> 
```

或者甚至更简单的东西：

```
<img src=x onerror=alert(1) /> 
```

就像我说的那样，这是对一个极其复杂的问题的**严重过度简化**。

# scala - 扩展scala案例类而不不断重复构造函数vals？

> ID：11165432
> 
> 赞同：70
> 
> 时间：2012-06-22T23:31:14.277
> 
> 标签：scala, inheritance

有没有一种方法可以扩展一个案例类，而不会在此过程中不断地拾取新的 val？

例如，这不起作用：

```
case class Edge(a: Strl, b: Strl)
case class EdgeQA(a: Strl, b: Strl, right: Int, asked: Int) extends Edge(a, b) 
```

`"a" conflicts with "a"`，所以我被迫重命名为`a1`. 但我不想要“a”的各种额外公开副本，所以我将其设为私有。

```
case class Edge(a: Strl, b: Strl)
case class EdgeQA(private val a1: Strl, private val b1: Strl, right: Int, asked: Int) extends Edge(a, b) 
```

这对我来说似乎并不干净......我错过了什么吗？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2012-06-23T17:18:57.643

正如前面的评论者提到的：应该避免案例类扩展，但您可以将 Edge 类转换为特征。

如果您想避免私有语句，您还可以将变量标记为覆盖

```
trait Edge{
  def a:Strl
  def b:Strl
}

case class EdgeQA(override val a:Strl, override val b:Strl, right:Int, asked:Int ) extends Edge 
```

不要忘记`def`在`val`特质上更喜欢

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2015-05-15T09:25:48.733

与以前的解决方案相比，此解决方案提供了一些优势：

```
trait BaseEdge {
  def a: Strl
  def b: Strl
}
case class Edge(a:Strl, b:Strl) extends BaseEdge
case class EdgeQA(a:Strl, b:Strl, right:Int, asked:Int ) extends BaseEdge 
```

这样：

*   你没有多余`val`的 s，并且
*   你有 2 个案例类。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-06-22T23:40:09.953

案例类不能通过子类化来扩展。或者更确切地说，案例类的子类不能是案例类本身。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-11-17T10:24:40.503

从 开始`Scala 3`，[特征可以有参数](https://dotty.epfl.ch/docs/reference/other-new-features/trait-parameters.html)：

```
trait Edge(a: Strl, b: Strl)
case class EdgeQA(a: Strl, b: Strl, c: Int, d: Int) extends Edge(a, b) 
```

# layout - Twitter bootstrap：如何添加边距？

> ID：11165444
> 
> 赞同：9
> 
> 时间：2012-06-22T23:33:16.600
> 
> 标签：layout, twitter, twitter-bootstrap

我有一个居中的 Twitter Bootstrap 容器页面。

这个容器有一个跨越整个宽度（span12）的标题，标题下方是一个图片库，它是一堆行，每行有 4 个单元格（包含图片）。

我想为每一行添加侧边距，以便第一张和最后一张图片与容器边框不完全贴合，并且图片间距相等。我不想使用 offset1 作为边距，因为它太大了。

这是当前模型的链接：http: [//i46.tinypic.com/21e2h4o.jpg](http://i46.tinypic.com/21e2h4o.jpg)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-23T12:12:39.330

您可以使用 nth-child css 属性

`nth-child(4n+1)`对于左边距

`nth-child(4n+4)`对于右边距

[http://css-tricks.com/how-nth-child-works/](http://css-tricks.com/how-nth-child-works/)

或者

`<div>`在你的`.span12`with添加一个`style="padding:0 19px"`

并在里面添加`<div class="row-fluid">`

```
<div class="row">
  <div class="span12">
    <div style="padding:0 19px">
      <div class="row-fluid">
        <div class="span3">3</div>
        <div class="span3">3</div>
        <div class="span3">3</div>
        <div class="span3">3</div>
      </div>
    </div>
  </div>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T22:24:58.200

span12 的宽度为 940 像素。那应该是您的工作区的宽度或其他任何东西。960px 似乎是网格系统中相当普遍的做法。

这是我的解决方案...

```
<html>
<head>
    <title></title>
    <link href="bootstrap.min.css" rel="stylesheet" type="text/css" />
    <style type="text/css">
        body {
            background-color: #CCC;
        }

        #SiteBody 
        {
            width: 960px;
            margin: 0 auto;
            background-color: white;
        }
    </style>
</head>
<body>
    <div id="SiteBody">
        <div class="container">
            <div class="row">
                <div class="span12">
                    <h1>
                        My Page</h1>
                </div>
            </div>
        </div>
    </div>
</body>
</html> 
```

# objective-c - 像推特应用一样沮丧的 UITableView

> ID：11165448
> 
> 赞同：-1
> 
> 时间：2012-06-22T23:33:39.297
> 
> 标签：objective-c, ios, photoshop

我正在尝试复制以下 Twitter 应用程序图像的单元格。有人可以提供有关您如何执行此操作的见解，包括说明如何在 Photoshop 中创建图像的自定义视图（如果有必要并且无法以编程方式完成）。提前致谢。

![在此处输入图像描述](../Images/978ff7c949cbbd985a37a158def45882.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T00:32:52.997

假设您的问题只是关于外观......您需要做的就是创建一个自定义`UITableViewCell`并覆盖绘图功能以绘制内阴影（就像在[这个问题](https://stackoverflow.com/questions/4431292/inner-shadow-effect-on-uiview-layer)上一样）。

但是，这不会在中间产生“凹痕”。

# postgresql - 将常见查询存储为列？

> ID：11165450
> 
> 赞同：41
> 
> 时间：2012-06-22T23:33:56.503
> 
> 标签：postgresql, database-design, view

使用 PostgreSQL，我有一些看起来像这样的查询：

```
SELECT <col 1>, <col 2>
     , (SELECT sum(<col x>)
        FROM   <otherTable> 
        WHERE  <other table foreignkeyCol>=<this table keycol>) AS <col 3>
FROM   <tbl> 
```

鉴于子选择在每种情况下都是相同的，有没有办法将该子选择存储为表中的伪列？本质上，我希望能够从表 A 中选择一列，该列是表 B 中记录相关的特定列的总和。这可能吗？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2012-06-23T02:19:22.223

> 有没有办法将该子选择存储为表中的伪列？

一个[`VIEW`](https://www.postgresql.org/docs/current/sql-createview.html)like被建议是一个完全有效的解决方案。去吧。

但是还有另一种更适合您的问题的方法。您可以编写一个将表类型作为参数的函数来***模拟*****“计算字段”**或**“生成的列”**。

考虑这个来自您的描述的测试用例：

```
CREATE TABLE tbl_a (a_id int, col1 int, col2 int);
INSERT INTO tbl_a VALUES (1,1,1), (2,2,2), (3,3,3), (4,4,4);

CREATE TABLE tbl_b (b_id int, a_id int, colx int);
INSERT INTO tbl_b VALUES
  (1,1,5),  (2,1,5),  (3,1,1)
, (4,2,8),  (5,2,8),  (6,2,6)
, (7,3,11), (8,3,11), (9,3,11); 
```

创建模拟的函数`col3`：

```
CREATE FUNCTION col3(tbl_a)
  RETURNS int8
  LANGUAGE sql STABLE AS
$func$
SELECT sum(colx)
FROM   tbl_b b
WHERE  b.a_id = $1.a_id
$func$; 
```

现在可以查询：

```
SELECT a_id, col1, col2, tbl_a.col3
FROM   tbl_a; 
```

甚至：

```
SELECT *, a.col3 FROM tbl_a a; 
```

注意我是如何写`tbl_a.col3`/`a.col3`的，而不仅仅是`col3`. 这是*必不可少*的。

与[Oracle 中的“虚拟列”](https://oracle-base.com/articles/11g/virtual-columns-11gr1)不同，它***不会***自动包含在`SELECT * FROM tbl_a`. 你可以使用 a `VIEW`。

## 为什么这行得通？

引用表列的常用方法是使用**属性表示法**：

```
从 tbl_a 中选择tbl_a.col1；
```

调用函数的常用方法是使用**函数表示法**：

```
选择col3(tbl_a) ;
```

一般来说，最好**坚持这些**符合 SQL 标准的规范方式。

但是 Postgres 也允许使用属性表示法。这些也有效：

```
从 tbl_a 中选择col1(tbl_a)；
选择tbl_a.col3；
```

[更多关于手册中的内容。](https://www.postgresql.org/docs/current/xfunc-sql.html#XFUNC-SQL-COMPOSITE-FUNCTIONS)
你现在可能已经看到了，这是怎么回事。这*看起来*像你会添加一个额外的表列，`tbl_a`而`col3()`实际上是一个函数，它将当前行`tbl_a`（或其别名）作为行类型参数并计算一个值。

```
SELECT *, a.col3
FROM   tbl_a AS a; 
```

如果存在实际列`col3`，则它具有优先权，并且系统不会以该行`tbl_a`作为参数来查找该名称的函数。

它的“美”：您可以添加或删除列，`tbl_a`最后一个查询将动态返回所有当前列，其中视图只会返回在创建时存在的列（早期绑定与后期绑定`*`）。
当然，您现在必须先删除依赖函数，然后才能删除表。并且在对表进行更改时，您必须注意不要使函数无效。

我还是不会用。这对无辜的读者来说太令人惊讶了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-23T00:13:02.617

根据狮子的评论，显然这是用视图处理的。所以就我而言，我使用了以下命令：

```
CREATE VIEW <viewname> AS
SELECT *, (SELECT sum(<col x>)
FROM   <otherTable
WHERE  <otherTable foreignkeyCol>=<thisTable keycol>) AS <col 3>
FROM   <tablename> 
```

这基本上给了我另一个表，包括所需的列。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-23T00:15:42.240

除了视图之外，您还可以为总和创建一个函数。

```
CREATE FUNCTION sum_other_table( key type_of_key ) RETURNS bigint
AS $$ SELECT sum( col_x ) FROM table_1 where table_1.key = key $$ LANGUAGE SQL; 
```

然后将其用作您的聚合器：

```
SELECT col_1, col_2, sum_other_table( key ) AS col_3
FROM table_2 WHERE table_2.key = key; 
```

请注意， sum_other_table() 的返回类型取决于您要汇总的列的类型。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-23T16:36:59.613

到目前为止，有三个答案，所有这些都有效。根据具体情况，其中任何一个都可能是“最佳解决方案”。对于小表，性能应该非常接近，但它们都不太可能很好地扩展到具有数百万行的表。使用大型数据集获得所需结果的最快方法可能是（使用 Erwin 的设置）：

```
SELECT a_id, col1, col2, sum(colx)
FROM tbl_a LEFT JOIN tbl_b b using(a_id)
GROUP BY a_id, col1, col2; 
```

如果`a_id`声明为主键，并且在 9.1 或更高版本下运行，则该`GROUP BY`子句可以简化，因为`col1`并且`col2`在*功能上依赖*于`a_id`.

```
SELECT a_id, col1, col2, sum(colx)
FROM tbl_a LEFT JOIN tbl_b b using(a_id)
GROUP BY a_id; 
```

视图可以通过这种方式定义并且可以扩展，但我不*认为*使用函数的方法会考虑所有相同的执行路径，因此可能不会使用最快的执行路径。

# windows - 使用 Github for Windows 通过 SSH 使用自己的私有 Git

> ID：11165458
> 
> 赞同：20
> 
> 时间：2012-06-22T23:35:28.500
> 
> 标签：windows, git, github, ssh, github-for-windows

现在，我正在使用 msysgit 来处理我自己的私有存储库，该存储库使用 SSH 存储在 ec2 亚马逊云服务器上。

到目前为止，我已经能够通过 Git Bash 成功连接到这些存储库（使用 ssh-keygen 创建 ssh-rsa 公钥和私钥，将公钥添加到远程机器上的 authorized_servers），所以我可以克隆，推，拉，通过 CLI。

现在，我已经看到了 Windows 版 Github，我不得不说，它是一款漂亮的软件。由于它基于 msysgit，我想知道是否可以设置 Github for Windows 以通过 UI 连接、克隆和推送提交？

在描述中它看起来是可能的，但文档似乎缺乏关于软件能够做什么的信息。

希望你能在这里帮助我，来自墨西哥的欢呼。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-22T23:51:29.410

这是您正在寻找的内容的好文章。

编辑：我刚刚使用以下步骤进行了测试，它就像魅力一样！

```
 1\. Click on repositories on the left.
   2\. Pull your copy of the repo from the remote , using git-shell
   3\. Drag and drop the Folder on to Git hub for windows dashboard.
   4\. now double click on the repository dropped on to githubW. It should be listed as a local repository.
   5\. it says login required to your non-github remote! 
```

![在此处输入图像描述](../Images/6ae08c803f0e51b10d0aa15eb97e81c3.png)

[学分](http://haacked.com/archive/2012/05/30/using-github-for-windows-with-non-github-repositories.aspx)

出于某种奇怪的原因，GutHub 并没有让使用非 GitHub 遥控器变得简单。（正如你所说，[他们说他们支持非 github 遥控器](http://windows.github.com/help.html)！！）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-08-27T14:10:28.960

**迟到的答案**，但这就是我在 Github for windows 上通过**SSH使用 Gitlab.com 的方式。**

1.  将来自 github_rsa.pub（在 .ssh 文件夹中）中的公共 ssh 密钥添加到 Gitlab.com 上的 SSH 密钥
2.  将`config`文件添加到您的 .ssh 文件夹，如下所示

    ```
    Host gitlab.com
    RSAAuthentication yes
    IdentityFile ~/.ssh/github_rsa
    User mygitlabloginemail 
    ```

3.  通过 Git Bash 克隆/拉取你的存储库

4.  将文件夹拖到 Github For Windows

就是这样，您现在可以将 Github for Windows 与您的 gitlab 存储库一起使用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-08-24T23:05:22.427

由于 GitHub for Windows 也可以使用 https url，请注意，自 2013 年 8 月起，您还可以使用 OAuth 令牌进行身份验证。
请参阅“ [GitHub for Windows 中更好的密码安全性](https://github.com/blog/1604-better-password-security-in-github-for-windows)”

> 在此版本之前，该应用程序将加密并存储您的密码。由于该应用程序还将自己注册为您的 Git 凭据提供程序，因此该应用程序会在需要时以明文形式向 Git.exe 提供您的凭据。
> 
> 在此版本中，当您使用您的用户名和密码登录时，应用程序会在 GitHub.com 上将自己注册为一个`Authorized application`并接收它存储的 OAuth 令牌，而不是您的密码。这类似于与 GitHub 集成的其他应用程序（例如 Travis-CI）的工作方式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-03-28T16:37:55.050

这很奇怪，但唯一的解决方案是将存储库的 URL 拖放到 Github for Windows 中。然后它会询问您的 cusom Git（私人、实验室或其他）的名称和密码......然后瞧。

# orientation - 在 iPad/iPhone 上在纵向和横向之间切换时响应站点被放大

> ID：11165460
> 
> 赞同：50
> 
> 时间：2012-06-22T23:35:49.220
> 
> 标签：orientation, responsive-design, viewport, screen-orientation, device-orientation

我在这里使用 Twitter Bootstrap 构建了一个响应式网站：http: [//zarin.me/cce/](http://zarin.me/cce/)

响应式设计在 iPad 和 iPhone 上效果很好，但是当我将设备从纵向翻转到横向时，网站会放大而不是适应屏幕（捏住屏幕有效）。

我错过了什么？这是视口问题吗？这是我在我的唯一视口代码：

```
<meta content="width=device-width, initial-scale=1.0" name="viewport"> 
```

提前致谢！

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2012-06-24T22:08:30.160

您还想添加最大比例

```
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"> 
```

更新我同意一些评论，声明不应该限制用户的缩放，因为这是不好的做法。下面是一种更好的方法，我相信苹果早就修复了缩放错误。

```
<meta name="viewport" content="width=device-width, initial-scale=1"> 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-09-17T20:03:46.350

虽然将最大比例设置为“1”确实有效，但它会限制您的用户放大您网站内的任何内容。不适合用户体验。试试这个 Javascript，[iOS-Orientation Change Fix](https://github.com/scottjehl/iOS-Orientationchange-Fix)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2014-12-05T08:08:02.450

`initial-scale=1.0`在元中设置：

```
<meta name="viewport" content="width=device-width,initial-scale=1.0" /> 
```

然后`-webkit-text-size-adjust:100%;`在 CSS 中设置：

```
body {
  -webkit-text-size-adjust: 100%;
} 
```

这种方法不会阻止用户放大您的网站，但会确保文本不会被浏览器自动调整大小。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-04-03T10:03:04.470

当页面上的一个容器溢出超过 100% 时，我已经看到了这种情况。页面在初始方向上显示正常，但是当方向改变时，额外的宽度会以某种方式生效，导致页面缩小，并且通常在右侧或左侧留下边距。值得检查所有媒体查询以确保没有尾随填充或边距。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-10-16T12:36:27.420

以下对我有用，并允许用户放大

```
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0" /> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-07-02T12:35:48.820

在 Ipad 3 和 IOS 7.1.2 上正好有这个问题

使用 maximum-scale=1 修复它并允许缩放

js解决方案没有用

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-12-10T12:06:32.300

如果您主要在 iPhone-X 中遇到问题，请尝试`<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover" />`

这对我有用。

# html - 我们如何在 IE 中启用边框半径？

> ID：11165465
> 
> 赞同：1
> 
> 时间：2012-06-22T23:36:18.360
> 
> 标签：html, internet-explorer, css

```
<style>
   border-radius:10px;
</style>
<div class='radius'> <?= echo $score . 'score';?></div> 
```

它在 IE8 中不起作用

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-22T23:45:57.640

Internet Explorer 6-8 不支持 Border-Radius，在 IE 9 中使用border-radius:10px。

它可以与 Jquery 或 [PIE CSS一起使用](http://css3pie.com/)

在**HTML**中添加 jquery.js 和 jquery.corner.js：

```
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.js"></script>
<script type="text/javascript" src="http://malsup.github.com/jquery.corner.js"></script> 
```

**Javascript**

```
$('.radius').corner(); 
```

对于边框半径：10px 使用

```
$('.radius').corner("10px"); 
```

更多示例：http: [//jquery.malsup.com/corner/](http://jquery.malsup.com/corner/)

**演示** [http://jsfiddle.net/vTXXD/](http://jsfiddle.net/vTXXD/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T23:38:31.510

[IE8 不支持它](http://www.quirksmode.org/css/contents.html)。如果你想让它在 IE8 中工作，你需要[使用 hack](http://www.htmlremix.com/css/curved-corner-border-radius-cross-browser)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-22T23:38:47.237

IE 9 之前不支持它。您需要使用[PIE CSS 之](http://css3pie.com/)类的东西。这将要求您在站点中添加一个 htc 文件，您的 css 将如下所示：

```
.radius {
    -webkit-border-radius: 8px;
    -moz-border-radius: 8px;
    border-radius: 8px;
    behavior: url(/PIE.htc);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-22T23:39:03.227

`border-radius`是一个 CSS3 属性并且 IE8 不支持它（IE8 以下的任何东西都不支持它）。

但是，有一个名为[css3pie](http://css3pie.com)的出色脚本增加了对 IE8 的支持。

# mysql - how to prevent insertion of certain offensive words in codeigniter using a database

> ID：11165466
> 
> 赞同：1
> 
> 时间：2012-06-22T23:36:19.560
> 
> 标签：mysql, codeigniter, input

I'm developing a website using codeigniter that allows users to post free ads and search for ads, I'm looking for a fast way to check the user input against a list of offensive words stored in database table, so that if a user enters a bad word, one from those listed in that table then it should be removed (not entered). my table is using the MySql fulltext search feature.

I tried using the like in sql but I was told that it gets slow when the records reach thousands.

is there any suitable solution in codeigniter ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T00:36:28.863

有很多方法可以做到这一点。在您的情况下，我什至不会使用 SQL，我只会在 CI 中编写一个配置选项，其中包含所有坏词的正则表达式，然后将您的输入与这些坏词进行匹配。例如

```
$config['bad_words'] = "/[\s](ass|sex|butt|badword)[\s]/i";
$input               = preg_replace($config['bad_words'],"",$input); 
```

如果您有数千条记录，这将起作用，但如果有数千条坏词可能会有点慢。当然，如果您想使用多个坏词，那么正则表达式是个坏主意。如果你有成千上万的坏词，我会在 mysql 中使用“like”。它确实有点慢，但对性能的影响并不大。

使用 SQL，我将创建一个包含坏词（或坏词 regex-es）的数据库。bad_words 表的每一行都会有一个正则表达式来匹配一个坏词，例如“fu.k”。在验证输入以过滤掉坏词时，您需要：

```
<?php 
  $res = mysql_query( "select * from bad_words" );
  ...
  //get all rows in array $badWords
  ...
  $myRegexMatch = implode ( "|" , $badWords );
  preg_replace($myRegexMatch,"",$input);
?> 
```

这可能是目前最快的解决方案之一，它易于实施且速度非常快。如果你想让它更快，你甚至可以缓存从数据库中获取的正则表达式，使用数据库缓存。

如果您有兴趣更快地做到这一点（您真的不需要），我会编写一个数据库触发器/约束，只要应该插入“广告”，就会在数据库中执行此正则表达式匹配。

# symfony - 在 Symfony 2 中分配一个全局 Twig 变量？

> ID：11165467
> 
> 赞同：0
> 
> 时间：2012-06-22T23:36:22.747
> 
> 标签：symfony, twig

我的 Web 应用程序作为顶栏，我需要在其中显示未读消息的数量。每个`User`实体都作为一个关联`Message`（多对多）。显示消息总数（对于给定用户）很简单：

```
class User
{
    /*
     * @ORM\ManyToMany(targetEntity="Message", invertedBy="users")
     */
    private $messages;
} 
```

在树枝中：

```
Total messages: {{ app.user.messages|length }}. 
```

但是如果我只需要计算**新消息**怎么办？假设我的存储库有一个`getNewMessages(User $user)`方法，如何全局分配这个值以在每个模板中使用？

我知道 Twig 全局变量，但我不知道我应该把相关代码放在哪里：

```
$twig = new Twig_Environment($loader);
$twig->addGlobal('text', new Text());

{{ text.lipsum(40) }} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-23T00:00:13.540

我会注册一个在每个请求上发生的事件侦听器，可能是`kernel.request`事件。在侦听器中，您可以检查登录用户，如果是，则使用新消息计数更新会话变量。然后，您可以使用 twig 访问此会话变量`app.session.msg_count`

这还有一个优点是您可以缓存它并仅在某些条件下更新，以避免对每个请求进行查询。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-25T22:20:16.820

您需要创建并注册一个树枝扩展。树枝扩展可以像您的代码示例一样以相同的方式提供全局变量。我会给你贴一些你可以基于的代码......

首先在任何包中创建扩展类

```
class FooBarTwigExtension extends \Twig_Extension
{
    public function getGlobals()
    {
      return array(
        'foo'=> $this->bar,
      );
    }
} 
```

然后在捆绑服务定义中将其注册为树枝扩展

```
<service id="acme.foo_bundle.twig_extension" class="Acme\FooBundle\Twig\FooBarExtension">
  <tag name="twig.extension" />
  <argument ...>
</service> 
```

之后，您可以在 twig 中访问变量

```
<h1>{{foo}}</h1> 
```

如果您想使用延迟初始化，您可能需要传入一个对象并调用该对象的消息，因此仅在显示时才需要消息计数。

```
<h1>{{messaging.countUnread}} new messages</h1> 
```

另一种方法是实现一个 twig 函数来获取当前用户的未读消息计数

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-03T14:15:29.010

如果您的 User 实体有一个`getUnreadMessages()`方法，您可以使用`{{ app.user.unreadMessages }}`

# c# - Creating 2D wpf custom shapes that are animateable

> ID：11165469
> 
> 赞同：0
> 
> 时间：2012-06-22T23:36:27.333
> 
> 标签：c#, wpf, animation, 2d

At present I am working on a project that involves animating a custom built 2D shape in WPF. The shape is to look like a box and at the present I seem to have a few glitches.

Here is what my code looks like at the moment

```
namespace Wpftrial4
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {

        SolidColorBrush fillcolor = new SolidColorBrush();
        SolidColorBrush bordercolor = new SolidColorBrush();

        public MainWindow()
        {
            InitializeComponent();

            fillcolor.Color = Colors.WhiteSmoke;
            bordercolor.Color = Colors.Blue;

        }

        private void button1_Click(object sender, RoutedEventArgs e)
        {

            //Manually creating the required 2D Box shape
            Path path_rectangle = new Path();

            path_rectangle.Fill = fillcolor;
            path_rectangle.Stroke = bordercolor;
            path_rectangle.StrokeThickness = 5;

            RectangleGeometry rg = new RectangleGeometry();
            double width_rec = 100; 
            double height_rec = 50;
            double left_rec = 130; 
            double top_rec = 100;
            rg.Rect = new Rect(left_rec, top_rec, width_rec, height_rec);
            path_rectangle.Data = rg;
            canvas1.Children.Add(path_rectangle);

            Path path2_top = new Path();
            path2_top.Stroke = new SolidColorBrush(Colors.Brown);
            path2_top.StrokeThickness = 6;
            RectangleGeometry rg2 = new RectangleGeometry();
            double width2 = 100;
            double height2 = 2;
            double left2 = 130;
            double top2 = 90;
            rg2.Rect = new Rect(left2, top2, width2, height2);
            path2_top.Data = rg2;
            canvas1.Children.Add(path2_top);

            Path path3_topcover = new Path();
            path3_topcover.Stroke = new SolidColorBrush(Colors.White);
            path3_topcover.StrokeThickness = 5;
            RectangleGeometry rg3 = new RectangleGeometry();
            double width3 = 100;
            double height3 = 5;
            double left3 = 130;
            double top3 = 100;
            rg3.Rect = new Rect(left3, top3, width3, height3);
            path3_topcover.Data = rg3;
            canvas1.Children.Add(path3_topcover);

            //combining part_Group type
            GeometryGroup myGeometryGroup = new GeometryGroup();
            myGeometryGroup.Children.Add(rg);
            myGeometryGroup.Children.Add(rg3);
            Path myPath = new Path();
            myPath.Stroke = Brushes.Blue;
            myPath.Data = myGeometryGroup;
            canvas1.Children.Add(myPath);

            ////test animate
            //myCustomAnimatedBox MB2 = new myCustomAnimatedBox(200, 200, 300, 250) { Stroke = Brushes.Black, StrokeThickness = 2 };
            //canvas1.Children.Add(MB2); //new myCustomAnimatedBox(200, 200, 300, 250,500,500){Stroke = Brushes.Black, StrokeThickness = 2});
            //PointAnimation pa2 = new PointAnimation();
            ////DoubleAnimation da = new DoubleAnimation();
            //pa2.To = new Point(100, 100);
            ////da.By = 50;
            //pa2.Duration = TimeSpan.FromSeconds(10);
            ////MB2.BeginAnimation(myCustomAnimatedBox.TopProperty,pa2);//(//MB2.BeginAnimation(myCustomAnimatedBox.CenterProperty, pa2);

        }

        //class- style custom2D shape creation
        private void button2_Click(object sender, RoutedEventArgs e)
        {
            myCustomAnimatedBox MB = new myCustomAnimatedBox(200, 200, 350, 250) { Stroke = Brushes.Black, StrokeThickness = 2 };
            canvas1.Children.Add(MB); //new myCustomAnimatedBox(200, 200, 300, 250,500,500){Stroke = Brushes.Black, StrokeThickness = 2});
            //PointAnimation pa = new PointAnimation();
            ////DoubleAnimation da = new DoubleAnimation();
            //pa.To = new Point(100, 100);
            ////da.By = 50;
            //pa.Duration = TimeSpan.FromSeconds(10);
            //MB.BeginAnimation(myCustomAnimatedBox.CenterProperty, pa);

        }
    }

    //Class that defines the custom 2D shape
    public class myCustomAnimatedBox : Shape
    {
        private double x1, width;
        private double y1, height;

        private GeometryGroup myBox = new GeometryGroup();

        public myCustomAnimatedBox(double XX1, double YY1, double widTH, double heiGHT)
        {  
            makeBox(XX1, YY1, widTH, heiGHT);

        }

        //public static readonly DependencyProperty CenterProperty = DependencyProperty.Register("Center", typeof(Point), typeof(myCustomAnimatedBox),
        //    new PropertyMetadata( null,PropertyChanged));// FrameworkPropertyMetadata( FrameworkPropertyMetadataOptions.AffectsMeasure));
        ////new Point(cent_X, cent_Y)

        //public Point Center
        //{
        //    get { return (Point)GetValue(CenterProperty); }
        //    set 
        //    { 

        //        SetValue(CenterProperty, value);
        //        myBox.Children.Clear();
        //        makeBox(myBox, value.X, value.Y, width, height);
        //    }
        //}

        //public Point Center
        //{
        //    get { return (Point)GetValue(CenterProperty); }
        //    set
        //    {

        //        SetValue(CenterProperty, value);
        //        myBox.Children.Clear();
        //        makeBox(myBox, value.X, value.Y, width, height);
        //    }
        //}
        //public Point Top
        //{
        //    get { return new Point(X1, Y1); }
        //    set 
        //    { 
        //        //X1 = value.X;
        //        //Y1 = value.Y;
        //        Top = value;

        //    }

        //}

        //public static readonly DependencyProperty TopProperty = DependencyProperty.Register("Top", typeof(Point), typeof(myCustomAnimatedBox), new FrameworkPropertyMetadata( FrameworkPropertyMetadataOptions.AffectsMeasure));
            //new PropertyMetadata( null,PropertyChanged));

        public double X1
        {
            get { return x1; }
            set 
            {
                x1 = value;

            }
        }

        public double Y1
        {
            get { return y1; }
            set 
            {
                y1 = value;

            }
        }

        //Trial at creating a dependency property
        //private static void TopPropertyChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
        //{
        //    myCustomAnimatedBox myB = (myCustomAnimatedBox)d;

        //    myB.InvalidateVisual();

        //}

        protected override Geometry DefiningGeometry
        {
            get { return myBox; }
        }

        //Function that draws the object
        private void makeBox(double XX1, double YY1, double widTH, double heiGHT)
        {

            width = widTH;
            height = heiGHT;
            this.X1 = XX1;
            this.Y1 = YY1;
            RectangleGeometry rectangle_part = new RectangleGeometry();
            rectangle_part.Rect = new Rect(X1,Y1,width,height);
            RectangleGeometry rg_cover = new RectangleGeometry();
            RectangleGeometry rg_top = new RectangleGeometry();
            rg_top.Rect = new Rect(X1, Y1 - 10, width, 2);
            rg_cover.Rect = new Rect(X1, Y1, width, 5);
            myBox.Children.Add(rectangle_part);
            myBox.Children.Add(rg_top);
            myBox.Children.Add(rg_cover);

        }

    }
} 
```

Since the shape would be undergoing animation like: box opening and closing, I need the custom shape to have a movable part. GeometryGroup according to most authors seem to offer the most advantages when animation plus other databinding is required however. IN the code I have tested creating the shape manually. This could be seen in code attached to Button1\. However when I try to do the class implementation, i am not able to get the kind of effect I want like altering individual constituent characteristics. I am less than 1 month into WPF and would like help in the following areas.

1.  Is GeometryGroup ideal for what I want to achieve?
2.  will following this course lead to the achievement of my goal. ie will I be able to animate a part of a custom 2D shape built in WPF ie box--open; box---Close.
3.  Can someone tell me what I need to do to be able to alter individual properties of the constituent shapes ie rectangles in my custom shape.

Thanks for your help.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T06:09:44.340

制作动画 2d 形状的最佳选择是使用表情混合软件：[下载链接软件](http://expression.microsoft.com/en-us/cc507094.aspx) ，您可以在此处查看示例教程：[Blend 简介：动画](http://www.kirupa.com/net/intro_blend_animation_pg1.htm)

# wpf - The calling thread cannot access this object because a different thread owns it.I dont want to use dispatcher

> ID：11165470
> 
> 赞同：-1
> 
> 时间：2012-06-22T23:36:29.250
> 
> 标签：wpf, synchronization, dispatcher

in wpf,I have a listbox control and two buttons.I want to be able to use the second button when i clicked the first button till add numbers has not fineshed his work.I use dispatcher.begininvoke but this adds the work on main thread.How to i synchronize this threads?I want to be able to use second button, move the window or using other ui elements when addnumbers processing..

```
 void AddNumbers()
    {

                for (int i = 1; i <= 1000000; i++)
                {
                    listBox1.Items.Add(i);
                }

    }

    private void button1_Click(object sender, RoutedEventArgs e)
    {

        Thread thr = new Thread(new ThreadStart(AddNumbers));
        thr.Start();

    }

    private void button2_Click(object sender, RoutedEventArgs e)
    {

        MessageBox.Show("Hello World!");
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T23:49:51.033

只有主 (UI) 线程可以访问 UI 控件。为什么列表框中需要 100 万个项目？Listbox 支持虚拟化。使用 BackgroundWorker（或线程）创建 List，然后在 RunWorkerCompleted 上将 List 绑定到 UI ListBox。至于同步，您只需在启动 BackgroundWorker 时启用/禁用，然后在回调中启用/禁用。同样，为什么您需要在 ListBox 中包含 100 万个项目？

[http://msdn.microsoft.com/en-us/library/cc221403(v=VS.95).aspx](http://msdn.microsoft.com/en-us/library/cc221403(v=VS.95).aspx)

# osx-lion - 如何仅搜索 indesign 文件 osx finder？

> ID：11165474
> 
> 赞同：0
> 
> 时间：2012-06-22T23:38:01.683
> 
> 标签：osx-lion

我想列出我的外部 HD 中的所有 indesign 文件，我尝试了查找器，但我没有看到仅按扩展名搜索的选项。我选择了外部高清，在种类下我选择了其他给我一个输入框的。当我输入photoshop时它可以工作，但当我输入indesign时它不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T23:46:07.850

您可以只搜索扩展名。

打开finder，点击左侧的外置HD，在搜索输入框中搜索你的文件扩展名（即.psd、.pdf、.indd）。

# android - SQLite：检查用户是否存在（在 Android 程序中）

> ID：11165475
> 
> 赞同：0
> 
> 时间：2012-06-22T23:38:01.817
> 
> 标签：android, sqlite

我现在正在上移动编程课程，我们需要创建一个简单的应用程序，用户在其中填写表格，我们获取该数据并将其记录在我们自己的自定义 SQLite 数据库中。我已经成功地进行了表单活动，并进行了广泛的错误检查，并使用 ContentProvider 来处理数据库内容。我几乎完成了，一切正常。我只是在努力添加最后一个要求——在我们让用户提交表单数据之前，我们需要查询数据库并检查他添加的用户名是否已经存在。如果是这样，我们会通知他并且不允许更新/创建数据库。

他是我的内容提供商提供的一些描述数据库的东西：

```
public final static String DBNAME = "FormStorage";
public static final String AUTHORITY = "com.connor.black.provider";
public final static String TABLE_NAMESTABLE = "formstable";
private static UriMatcher sUriMatcher;

public final static String COLUMN_FIRSTNAME = "FirstName";
public final static String COLUMN_LASTNAME = "LastName";
public final static String COLUMN_PHONE = "PhoneNumber";
public final static String COLUMN_EMAIL = "Email";
public final static String COLUMN_USERNAME = "Username";
public final static String COLUMN_PASSWORD = "Password";
public final static String COLUMN_GENDER = "Gender";
public final static String COLUMN_COUNTRY = "Country";
public static final Uri CONTENT_URI = Uri.parse("content://com.connor.black.provider/" + TABLE_NAMESTABLE);

private static final String SQL_CREATE_MAIN = "CREATE TABLE " + TABLE_NAMESTABLE + "("+"_ID INTEGER PRIMARY KEY, "+
                                                                    "FirstName TEXT, " +
                                                                    "LastName TEXT, " +
                                                                    "PhoneNumber TEXT, " +
                                                                    "Email TEXT, " +
                                                                    "Username TEXT, " +
                                                                    "Password TEXT, " +
                                                                    "Gender TEXT, " +
                                                                    "Country TEXT)"; 
```

从我的活动中，在提交 onclicklister 中，我正在这样做：

```
 final Cursor mCursor;
    submit.setOnClickListener(new OnClickListener() {

        public void onClick(View v) {

            Boolean submitCheck = true;

                      //...and code goes by....//

//Username duplicate check
            String[] mProjection = new String[]{"FormStorage.formstable.Username"};
            mCursor = getContentResolver().query(MyContentProvider.CONTENT_URI,
                    mProjection, null, null, null);

if(mCursor != null) {
                if(mCursor.getCount() > 0) {

                   // Check if username already exists

                }
            } 
```

所以我的问题：

我的 mProjection 字符串应该是什么样的？我知道我目前拥有的那个是错误的，但我对选择字符串应该是什么感到困惑？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T23:41:40.150

您的投影是一个`String[]`将列名作为其元素的投影。它们不应包含有关特定表的任何信息。请注意，识别表是 Uri 的工作（使用`setTable`内容提供者`query`实现中的方法）。

```
mProjection = new String { COLUMN_USERNAME } 
```

您应该将列值放在 a 中`String[]`，并让它们替换`?`您的选择中的`String`。这将保护您的数据库免受讨厌的 SQL 注入。

```
mSelection = COLUMN_USERNAME + "= ?";
mSelectionArgs = new String { "username" }; 
```

然后执行查询，

```
Cursor cur = getContentResolver().query(CONTENT_URI, 
                                        mProjection, 
                                        mSelection, 
                                        mSelectionArgs, 
                                        null); 
```

除非您的表很小，否则您应该确保在单独的线程上执行查询。这将确保 UI 线程不会被阻塞。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T23:41:53.297

```
SELECT COUNT(*) AS c
FROM tablename
WHERE username = 'Teh us3rer'
LIMIT 1 
```

此外，请确保您`UNIQUE`对用户名字段有限制以避免数据竞争。

# qt4 - Updating row on QTableWidget cause segmentation fault

> ID：11165479
> 
> 赞同：1
> 
> 时间：2012-06-22T23:38:58.767
> 
> 标签：qt4, qtablewidget

I have QTableWidget connected with `totale()` slot and [itemChanged(QTableWidgetItem *)](http://doc.qt.nokia.com/4.7-snapshot/qtablewidget.html) signal, in my table I am tracking user change on column 3 and 5.

```
void Store::totale(QTableWidgetItem *x)
{
    int row = x->row();
    float sum = 0;
    float ttl = 0;
    QTableWidgetItem *item = NULL;
    if (ui->storeTab->currentIndex() == 1)
    {
        if(x->column() == 5)
        {
            item = new QTableWidgetItem;
            sum = ui->itemsTableWidget->item(row, 3)->text().toFloat() * x->data(0).toFloat();
            item->setText(QString::number(sum, 'f', 2));
            ui->itemsTableWidget->setItem(x->row(), 6, item);
            sum = 0;
            for (int i = 0; i < ui->itemsTableWidget->rowCount(); ++i)
            {
                ttl += ui->itemsTableWidget->item(i, 5)->text().toFloat();
                sum += ui->itemsTableWidget->item(i, 6)->text().toFloat();
            }
            ui->totaleBill0->setText(QString::number(sum, 'f', 2));
            ui->ttlBill0->setText(QString::number(ttl, 'f', 2));
        }
        else if(x->column() == 3)
        {
            item = new QTableWidgetItem;
            sum = x->data(Qt::DisplayRole).toFloat() * ui->itemsTableWidget->item(row, 5)->text().toFloat();
            item->setText(QString::number(sum, 'f', 2));
            ui->itemsTableWidget->setItem(x->row(), 6, item);
            sum = 0;
            for (int i = 0; i < ui->itemsTableWidget->rowCount(); ++i)
            {
                ttl += ui->itemsTableWidget->item(i, 5)->text().toFloat();
                sum += ui->itemsTableWidget->item(i, 6)->text().toFloat();
            }
            ui->totaleBill0->setText(QString::number(sum, 'f', 2));
            ui->ttlBill0->setText(QString::number(ttl, 'f', 2));
        }
    }
} 
```

My problem if I make change on column 5, it works fine, but when I made change on column 3 I get segmentation fault.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-25T14:02:01.873

尝试在添加新行时关闭 cellChanged(int,int) 信号（断开并连接它）。这样，您将不会从未填充的单元格中读取

# java - Java：为什么我需要初始化一个原始局部变量？

> ID：11165485
> 
> 赞同：29
> 
> 时间：2012-06-22T23:40:42.770
> 
> 标签：java, primitive

```
public class Foo {
    public static void main(String[] args) {
        float f;
        System.out.println(f);
    }
} 
```

print 语句会导致以下编译时错误，

> 局部变量 f 可能尚未初始化

如果 Java 中的原语已经有一个[默认值 (float = 0.0f)](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html)，为什么我需要定义一个？

* * *

# 编辑：

所以，这行得通

```
public class Foo {
    float f;
    public static void main(String[] args) {
        System.out.println(new Foo().f);
    }
} 
```

谢谢大家！

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-06-22T23:43:59.727

因为它是一个局部变量。这就是为什么没有分配给它的原因：

> 局部变量略有不同；编译器永远不会为未初始化的局部变量分配默认值。如果您无法在声明它的地方初始化局部变量，请确保在尝试使用它之前为其分配一个值。访问未初始化的局部变量将导致编译时错误。

**编辑：为什么 Java 会引发此编译错误？** 如果我们查看[`IdentifierExpression.java`](https://github.com/openjdk-mirror/jdk7u-jdk/blob/master/src/share/classes/sun/tools/tree/IdentifierExpression.java)类文件，我们会发现这个块：

```
...
if (field.isLocal()) {
            LocalMember local = (LocalMember)field;
            if (local.scopeNumber < ctx.frameNumber && !local.isFinal()) {
                env.error(where, "invalid.uplevel", id);
            }
            if (!vset.testVar(local.number)) {
                env.error(where, "var.not.initialized", id);
                vset.addVar(local.number);
            }
            local.readcount++;
        }
... 
```

如前所述 ( `if (!vset.testVar(local.number)) {`)，JDK 检查 ( `testVar`) 是否分配了变量 ([`Vset`的源代码](https://searchcode.com/codesearch/view/17986236/)，我们可以在其中找到`testVar`代码)。`var.not.initialized`如果不是，它会从[属性文件](http://web.mit.edu/java_v1.1.6/arch/sun4x_55/lib/javac.properties)中引发错误：

```
...
javac.err.var.not.initialized=\
    Variable {0} may not have been initialized.
... 
```

[来源](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-06-22T23:43:44.960

事实上，编译器*并没有*为你的 分配一个默认值`float f`，因为在这种情况下它是一个局部变量——而不是一个字段：

> 局部变量略有不同；编译器永远不会为未初始化的局部变量分配默认值。如果您无法在声明它的地方初始化局部变量，请确保在尝试使用它之前为其分配一个值。访问未初始化的局部变量将导致编译时错误。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-06-22T23:43:33.110

类字段（`final`无论如何都不是）被初始化为默认值。局部变量不是。

> 声明字段时并不总是需要赋值。已声明但未初始化的字段将由编译器设置为合理的默认值。

所以一个（非`final`）字段`f`，如

```
class C {
  float f;
} 
```

将被初始化为`0f`但局部变量`f`在

```
void myMethod() {
  float f;
} 
```

不会是。

语言对局部变量的处理与字段不同。局部变量的生命周期范围很广，因此在初始化之前的任何使用都可能是一个错误。字段没有，因此默认初始化通常很方便。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-07-04T07:35:44.517

实际上局部变量存储在堆栈中。因此有可能获取局部变量存在的任何旧值。出于安全原因，这是一个很大的挑战..因此java说你必须在使用前初始化一个局部变量。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-02-19T07:22:22.293

嗨，伙计们，解决方案很简单。存储在堆内存中的值由基于编译器的数据类型初始化，但局部变量存储在堆栈内存中，因此我们必须显式初始化它。

# hadoop - 差异失败的任务与终止的任务

> ID：11165487
> 
> 赞同：8
> 
> 时间：2012-06-22T23:40:52.277
> 
> 标签：hadoop, mapreduce

在 Jobtracker Web UI 中，我看到了这个名为“Failed/Killed Task Attempts”的专栏。

我想知道它们之间的区别。我猜“失败的”是指在重试后最终确实失败的任务（所以根本没有完成恢复？）而“被杀死的”是指被杀死的任务（由于超时等）但它们可能会被重试？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-23T05:40:39.077

Hadoop 可以自行决定终止任务的原因有几个：
a) 任务在超时期间不报告进度（默认为 10 分钟）
b) FairScheduler 或 CapacityScheduler 需要其他池 (FairScheduler) 或队列 (CapacityScheduler) 的插槽。
c) 推测执行导致不需要任务的结果，因为它已经在其他地方完成。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-23T00:03:33.547

Hadoop 使用“推测执行”。可以在多个盒子上启动相同的任务。第一个完成的人获胜，其他副本被杀死。

失败的任务是出错的任务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-16T06:57:53.817

我有点不同意大卫，因为超时任务没有被标记为已终止，而是被标记为失败。

在我的理解中，以下是失败任务与终止任务的定义

任务可能因为以下原因而失败

1.  任务抛出运行时异常
2.  子JVM突然退出
3.  超时超过 mapred.task.timeout

任务可以被杀死，因为

1.  FairScheduler 或CapacityScheduler 需要某个其他池（FairScheduler）或队列（CapacityScheduler）的槽。
2.  推测执行导致不需要任务的结果，因为它已经在其他地方完成。
3.  用户还可以使用 Web UI 或命令行终止或失败任务尝试

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-28T05:49:12.733

失败的任务是在运行期间抛出异常的尝试，被杀死的任务是在推测执行过程中被杀死的重复任务。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-12-09T21:31:59.640

失败的任务 1\. 有 bug 的 map 或 reduce 代码（运行时异常错误） 2\. jvm 突然退出 3\. 挂起的任务（如果启用它可能会触发推测执行）

终止任务 1\. 推测性执行终止长时间运行的作业。2\. 如果用户自己杀死了一个工作。3\. 任务跟踪器故障

# ruby-on-rails - Rails：如何绘制图表？

> ID：11165492
> 
> 赞同：0
> 
> 时间：2012-06-22T23:41:53.880
> 
> 标签：ruby-on-rails, graphics, charts

我是一名业余 Web 开发人员，我想知道如何从头开始创建图形图表和图形。

在 Ruby on Rails 中制作它们有哪些好的教程和/或指南？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T23:43:31.283

你可能会更好地用 javascript 生成它们。那里有很多很棒的图书馆。也许从[flot](http://code.google.com/p/flot/)开始。

如果您需要更多控制或更奇特的图表，请尝试[d3](http://d3js.org)。

# iphone - iOS - UITabBar 按钮事件

> ID：11165495
> 
> 赞同：1
> 
> 时间：2012-06-22T23:42:09.043
> 
> 标签：iphone, ios, ipad, ios5, uitabbarcontroller

所以这是我面临的问题：

我有一个应用程序，它以登录视图开头，并且有一个标签栏，按钮中有三个按钮。最左边的按钮是“主页”按钮。

现在，一旦用户登录到应用程序，我希望“主页”标签栏按钮将用户引导到与登录视图不同的视图。如何实现？

先感谢您。修阁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T23:55:28.647

我能想到的最简单的方法是在 HomeViewController 中创建一个包含两个视图的视图：LoginView 和 AfterLoginView。在您的故事板/XIB 中标记 LoginView 可见，并使 AfterLoginView 隐藏。用户登录后，通过更改 HomeViewController 中的 hidden 属性，从 LoginView 转换到 AfterLoginView。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-23T00:34:11.467

如果我这样做，我将为它制作四个视图，一个是 loginView，其他是三个选项卡按钮的三个视图。loginView是独立的，所以app启动时会加载loginView并要求用户登录，如果用户登录则重定向到homeView，如果没有则停留在loginView。

所以在 loginView 中，它至少有一个按钮，并使用它来重定向到 homeView -

```
self.selectedIndex = 0; // self is an instance of UITabBarController 
```

# ruby - 如何获取节点的原始 HTML

> ID：11165496
> 
> 赞同：22
> 
> 时间：2012-06-22T23:42:12.497
> 
> 标签：ruby, nokogiri

我正在使用 Nokogiri 分析一些 HTML，但是，我不知道如何在节点内获取原始 HTML。

例如，给定：

```
<tr class="tableX">
  <td align="center">
    <font size="2"><a href="javascript:open('9746')">9746</a></font>
  </td>
  <td align="center">
    <font size="2">2012-06-26</font>
  </td>
</tr> 
```

当我使用这个 XPath 选择器时：

```
doc = Nokogiri::HTML(html)

nodes = doc.search("//tr[@class='tablebX']")

nodes.each do |node|
   node.text # or node.content
end 
```

结果来自`node.text`和`node.content`是：

```
9746
2012-06-26 
```

我想在`tr`块中获取所有原始 HTML，在这种情况下，它是：

```
<td align="center">
  <font size="2"><a href="javascript:open('9746')">9746</a></font>
</td>
<td align="center">
  <font size="2">2012-06-26</font>
</td> 
```

这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-22T23:48:39.430

使用`node.to_s`，或只是`node`：

```
nodes = doc.search("//tr[@class='tablebX']")
nodes.each do |node|
   puts node.to_s
   puts '-'*40
end 
```

使用额外的完整性检查 HTML（你的，加倍，`tr`中间有一个不同的类）我得到：

```
<tr class="tableX">
<td align="center">
<font size="2"><a href="javascript:open('9746')">9746</a></font> 
            </td>
            <td align="center"><font size="2">2012-06-26</font></td>
</tr>
----------------------------------------
<tr class="tableX">
<td align="center">
<font size="2"><a href="javascript:open('9746')">9746</a></font> 
            </td>
            <td align="center"><font size="2">2012-06-26</font></td>
</tr>
---------------------------------------- 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-11-08T04:13:09.773

您可以添加`children.to_html`. 尝试在下面执行此操作：

```
doc = Nokogiri::HTML(html)

nodes = doc.search("//tr[@class='tablebX']")

nodes.each do |node|
   node.children.to_html # or node.content
end 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-06-27T16:28:35.893

正确的方法是`.children`。它返回所选元素内的所有 html。

所以有这个代码：

```
<tr class="container">
  <td>value</td>
</tr> 
```

并使用此过程：

```
data = Nokogiri::HTML(html)
data.css("tr.container").children 
```

将返回此 html：

```
<td>value</td> 
```

我想我的回答为时已晚，但这正是您需要的确切代码。

# xpath - save xquery result into xml file

> ID：11165498
> 
> 赞同：0
> 
> 时间：2012-06-22T23:42:20.387
> 
> 标签：xpath, xquery

I am using xqj api for implemeting XQuery in java, the following is a sample query I have got and it does work. I need to write the output of the query into a .xml file , any one help me in this please?

```
String queryString =

            "declare variable $docName as xs:string external;" + sep +
            "for $cat in doc($docName)/*/"+ objectName +
             "    where $cat/"+field+" > "+ value +
               " order by $cat/" + field + " "+
            "return $cat";
            XQExpression expression = conn.createExpression();
            expression.bindString(new QName("docName"), filename,
            conn.createAtomicType(XQItemType.XQBASETYPE_STRING));
            XQSequence results = expression.executeQuery(queryString);
            System.out.println(results.getSequenceAsString(new Properties())); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T07:53:46.707

尝试这个：

```
XQSequence results = expression.executeQuery(queryString);
FileOutputStream os = new FileOutputStream(new File("output.xml");
results.writeSequence(os, new Properties()); 
```

# magento - Magento Update to 1.7.0.1 causes pricing to display as 0.0

> ID：11165501
> 
> 赞同：0
> 
> 时间：2012-06-22T23:43:04.157
> 
> 标签：magento

I updated my website, and as you can see in the link below... [http://dokha.co/index.php/dokha-medwakh-tobacco/sample-bag-of-dokha.html](http://dokha.co/index.php/dokha-medwakh-tobacco/sample-bag-of-dokha.html)

No matter what option you pick, the price displays as 0.00

I cant figure this out. Any ideas?

Thank you for looking!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T03:53:14.640

Have you tried reindexing?

You probably should reindex the catalog product prices index, but after an upgrade it may be a good idea to reindex everything you can.

# bitcoin - Accepting bitcoins payments on website, and providing automated bitcoin transfers between users (with automatic transaction charge)?

> ID：11165503
> 
> 赞同：12
> 
> 时间：2012-06-22T23:43:21.097
> 
> 标签：bitcoin

I have a website that I would like to enable bitcoin transactions between users. I would like if possible for these transactions to be automated, and I would like the site to receive a percentage per transaction.

Could someone provide a top-level outline of the technologies involved, and how they might need to interact to provide this service. If it's relevant my website is written in Rudy/Rails.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-11-18T12:54:02.540

我建议你使用[https://blockchain.info/api/api_receive](https://blockchain.info/api/api_receive)

基本上，这就是你要做的： - 连接到区块链的 API 并请求一个新的临时地址，附加到支付的用户身上，该网站的地址作为最终受益人。- 将该地址连同他需要的任何信息一起提供给用户，并要求他付款。- 付款发生时区块链会通知您。然后资金将转移到您（网站的）地址。- 然后您可以将减去费用的金额发送给最终用户。

这只是一个粗略的描述。阅读区块链的 API 文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-14T09:48:35.687

我有一个使用 Coinbase API 的类似网站，绝对值得一试。[https://coinbase.com/docs/api/overview](https://coinbase.com/docs/api/overview)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2014-05-01T19:12:52.567

是的，coinbase 保持在线，但强烈建议您将钱包放在桌面上，并将其从 coinbase 或任何其他第三方托管服务转移到桌面钱包。

要创建地址，您可以从设置页面创建一个。Coinbase 还支持将他们的服务与您的网站集成在简单易用的用户界面中，以使用比特币进行支付。该过程与基本的贝宝支付按钮集成相同，甚至支持回调和订阅服务按钮，

# javascript - How can I horizontally/vertically center a modal popup when the modal is sometimes bigger than the screen?

> ID：11165507
> 
> 赞同：-1
> 
> 时间：2012-06-22T23:43:33.890
> 
> 标签：javascript, jquery, css, modal-dialog

I know how to center a modal with javascript but I run into a problem when the modal is taller than the viewport. The top of the modal will be hidden off the top of the screen.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T23:59:45.403

你想拿

```
 (windowHeight - modalHeight) / 2 
```

作为模态的顶部位置

```
 if (modalHeight < windowHeight) 
    else make top as 0 or may be 10\. 
```

我想你已经解释过了。

一个可能的问题是，如果您使用的是固定定位的模态，溢出的部分不会显示，在这种情况下，您应该提供一个小提琴或链接来帮助您处理您的案例。

对于固定定位溢出，您可以将模态最大高度设为 100% 并在模态中显示滚动条。如果模态框是叠加层的子级，您可以将叠加层的最大高度设置为 100%，并在叠加层上使用滚动条。

如果您使用的是绝对定位模态，您将获得 body 的滚动条。

伪代码

```
top = (modalHeight < windowHeight)? (windowHeight - modalHeight) / 2 : 10 ; 
```

# python - 捕获输出时使用带有 select 和 pty 的子进程挂起

> ID：11165521
> 
> 赞同：7
> 
> 时间：2012-06-22T23:44:36.890
> 
> 标签：python, select, subprocess, pty

我正在尝试编写一个能够与其他程序交互的 python 程序。这意味着发送标准输入和接收标准输出数据。我不能使用 pexpect（尽管它确实启发了一些设计）。我现在使用的过程是这样的：

1.  将 pty 附加到子进程的标准输出
2.  通过检查循环直到子进程退出`subprocess.poll`
    *   当标准输出中有可用数据时，立即将该数据写入当前标准输出。
3.  结束！

我一直在对一些代码（如下）进行原型设计，这些代码有效，但似乎有一个让我烦恼的缺陷。子进程完成后，如果我在使用`select.select`. 我真的不想设置超时。只是看起来有点脏。但是，我试图解决这个问题的所有其他方法似乎都不起作用。Pexpect 似乎通过使用`os.execv`and`pty.fork`而不是`subprocess.Popen`和`pty.openpty`我不喜欢的解决方案来解决它。我在检查子流程的生命周期方面做错了吗？我的方法不正确吗？

我正在使用的代码如下。我在 Mac OS X 10.6.8 上使用它，但我也需要它在 Ubuntu 12.04 上工作。

这是子流程运行器`runner.py`：

```
import subprocess
import select
import pty
import os
import sys

def main():
    master, slave = pty.openpty()

    process = subprocess.Popen(['python', 'outputter.py'], 
            stdin=subprocess.PIPE, 
            stdout=slave, stderr=slave, close_fds=True)

    while process.poll() is None:
        # Just FYI timeout is the last argument to select.select
        rlist, wlist, xlist = select.select([master], [], [])
        for f in rlist:
            output = os.read(f, 1000) # This is used because it doesn't block
            sys.stdout.write(output)
            sys.stdout.flush()
    print "**ALL COMPLETED**"

if __name__ == '__main__':
    main() 
```

这是子流程代码`outputter.py`。*奇怪的随机部分只是为了模拟程序以随机​​间隔输出数据。如果您愿意，可以将其删除。没关系*：

```
import time
import sys
import random

def main():
    lines = ['hello', 'there', 'what', 'are', 'you', 'doing']
    for line in lines:
        sys.stdout.write(line + random.choice(['', '\n']))
        sys.stdout.flush()
        time.sleep(random.choice([1,2,3,4,5])/20.0)
    sys.stdout.write("\ndone\n")
    sys.stdout.flush()

if __name__ == '__main__':
    main() 
```

感谢您提供的任何帮助！

**额外说明**

使用 pty 是因为我想确保 stdout 不被缓冲。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-01T06:10:54.423

首先，`os.read`确实阻塞，与您所说的相反。但是，它不会在`select`. 同样`os.read`在一个关闭的文件描述符上总是返回一个空字符串，你可能想要检查它。

然而，真正的问题是主设备描述符永远不会关闭，因此最终`select`会阻塞。在罕见的竞争条件下，子进程已经退出`select`，`process.poll()`并且您的程序很好地退出。但是大多数时候选择会永远阻塞。

如果您按照izhak 的建议安装信号处理程序，那么一切都会崩溃；每当子进程终止时，就会运行信号处理程序。信号处理程序运行后，该线程中的原始系统调用无法继续，因此系统调用调用返回非零errno，这通常会导致python中抛出一些随机异常。现在，如果您在程序的其他地方使用了一些带有任何不知道如何处理此类异常的阻塞系统调用的库，那么您将遇到大麻烦（`os.read`例如，任何地方现在都可以抛出异常，即使在成功之后也是如此`select`）。

权衡一下在任何地方抛出随机异常而不是轮询，我认为超时`select`听起来并不是那么坏的主意。无论如何，您的进程仍然很难成为系统上唯一（缓慢）的轮询进程。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-31T00:32:35.480

您可以更改许多内容以使代码正确。我能想到的最简单的事情就是在fork之后关闭你父进程的slave fd副本，这样当子进程退出并关闭自己的slave fd时，父进程`select.select()`会将master标记为可读取，后续`os.read()`将给出一个空结果，您的程序将完成。*（直到从 fd 的两个*副本都关闭之前，pty master 不会看到从端被关闭。）

所以，只有一行：

```
os.close(slave) 
```

..在通话后立即放置`subprocess.Popen`，应该可以解决您的问题。

但是，可能会有更好的答案，具体取决于您的要求。正如其他人指出的那样，您不需要 pty 只是为了避免缓冲。你可以使用一个 bare`os.pipe()`代替`pty.openpty()`（并且对待返回值完全一样）。裸 OS 管道永远不会缓冲；如果子进程没有缓冲其输出，那么您的`select()`和`os.read()`调用也不会看到缓冲。不过，你仍然需要这`os.close(slave)`条线。

但是您可能出于不同的原因确实需要一个 pty。如果您的一些子程序希望在大部分时间以交互方式运行，那么他们可能会检查他们的标准输入是否是 pty 并且根据答案表现不同（许多常见的实用程序都这样做）。如果你真的想让孩子认为它有一个分配给它的终端，那么`pty`模块就是要走的路。根据您的运行方式`runner.py`，您可能需要从 using切换`subprocess`到`pty.fork()`子进程对象的 preexec_fn 可调用部分）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-23T01:19:02.677

据我了解，您不需要使用`pty`. `runner.py`可以修改为

```
import subprocess
import sys

def main():
        process = subprocess.Popen(['python', 'outputter.py'],
                        stdin=subprocess.PIPE,
                        stdout=subprocess.PIPE, stderr=subprocess.PIPE)

        while process.poll() is None:
                output = process.stdout.readline()
                sys.stdout.write(output)
                sys.stdout.flush()
        print "**ALL COMPLETED**"

if __name__ == '__main__':
        main() 
```

`process.stdout.read(1)`可以用来代替`process.stdout.readline()`子进程中每个字符的实时输出。

注意：如果您不需要子进程的实时输出，请使用[Popen.communicate](http://docs.python.org/library/subprocess.html#subprocess.Popen.communicate)避免轮询循环。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-29T20:01:08.983

当您的子进程退出时 - 您的父进程会收到[SIGCHLD](http://en.wikipedia.org/wiki/SIGCHLD)信号。默认情况下，此信号被忽略，但您可以拦截它：

```
import sys
import signal

def handler(signum, frame):
    print 'Child has exited!'
    sys.exit(0)

signal.signal(signal.SIGCHLD, handler) 
```

该信号还应该将阻塞系统调用中断为“选择”或“读取”（或您所在的任何位置），并让您在处理程序函数中执行您必须执行的任何操作（清理、退出等）。

# javascript - JS regex.exec() returning first find

> ID：11165522
> 
> 赞同：1
> 
> 时间：2012-06-22T23:44:38.457
> 
> 标签：javascript

I am trying to learn how to break up this string:

```
var str = 'red','blue','gree' 
```

I have this working code:

```
var clean = str.replace(/\'/g, "");
var elements = clean.split(','); 
```

which produces array `["red","blue","green"]` which is what i want however. id like to learn how to do this using regex.exec() method.

here is what i got:

```
var patt = /([^']+)/g;
var elem= patt.exec(str); 
```

but this returns array `["red","red"]`

any ideas?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T23:52:56.630

使用`exec`, 要获得多个匹配项，您需要循环运行它...

```
var str = "'red','blue','gree'"; // making a guess here

var patt = /([^']+)/g;
var match;

       //   v----yes, an assignment
while(match = patt.exec(str)) {
    console.log(match[1]);
} 
```

***演示：http:*** [//jsfiddle.net/D62D4/](http://jsfiddle.net/D62D4/)

全局正则表达式将最后一次匹配结束后的索引存储在自身上，并从该点开始执行下一个查询。

这一直持续到没有匹配项，此时索引设置回`0`.

`.lastIndex`您可以使用该属性在正则表达式上观察和修改此索引。

# ruby-on-rails - logging warnings (not errors) in a rails application, and managing them

> ID：11165530
> 
> 赞同：7
> 
> 时间：2012-06-22T23:46:11.957
> 
> 标签：ruby-on-rails, ruby, metrics

I'm looking for a good process to handle warnings/info type messages in Rails applications. For example, how many times users type in the wrong password, how many times validations for models fail, etc. Particularly, I'm looking for an efficient way to operationalize these metrics, since they aren't exceptions but could indicate potential bugs or issues in functionality.

Solutions I'm kicking around are:

*   Logging WARNING or INFO messages and using Splunk to parse them (unfortunately Splunk is ver expensive)
*   Sending Airbrake errors in a WARNING environment

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-17T21:27:42.133

另一种方法是使用类似`StatsD`配对的东西`Librato`（或 的开源替代品`Graphite`）。`StatsD`（以及因此`Librato`/ `Graphite`）操作，`UDP`因此它是一种非常便宜的方法，可以根据您的需要尽可能多地检测登录失败或创建用户等问题。您可以实现单个代码块的时间，也可以只说“调用了这个方法”。

这是 Etsy 大约 3 年前推出的一种方法，基本上允许您获得应用程序“心跳”以用于监控部署出错或功能未按预期/正常工作时。最重要的是，这是获得简单的“执行”风格仪表板的好方法，以显示一切都按预期工作并且应用程序是健康的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-26T20:37:34.127

您应该看看[Papertrail](https://papertrailapp.com/)作为 Splunk+Airbrake 的替代品。如果您只是对日志记录感兴趣，这似乎更合适。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-23T19:58:44.297

免责声明：我的公司建立、拥有和经营[Instrumental](https://instrumentalapp.com/)。

我们在内部使用 Instrumental 来跟踪错误发生的频率（我们实际上使用 Instrumental 来跟踪和压缩最近的注册错误）并跟踪不是实际异常的其他问题。

Rails 实现非常简单（我们也是 Rails 人，所以我们做了一个 Gem）：

[https://github.com/fastestforward/instrumental_agent](https://github.com/fastestforward/instrumental_agent)

您只想在要测量的事物周围添加一些工具（在这种情况下，密码输入错误或验证失败。）

一些关于测量错误、错误和其他事件的文档：

[https://instrumentalapp.com/docs](https://instrumentalapp.com/docs)

# ruby-on-rails - 机架安装应用程序与 sinatra 应用程序的导轨安装

> ID：11165531
> 
> 赞同：3
> 
> 时间：2012-06-22T23:46:11.920
> 
> 标签：ruby-on-rails, ruby, rackup

我想知道哪种方法可以更好地为 ruby​​ 安装不同的应用程序。我有 2 个 sinatra 应用程序和一个 rails 应用程序。

一种方法是使用 rails 作为基础并使用`routes.rb`(within rails)安装 sinatra 应用程序

```
RailsApp::Application.routes.draw do
  mount SinatraApp1, :at => "/url1"
  mount SinatraApp2, :at => "/url2"
  # rest of the rail routes
end 
```

这样，两个 sinatra 应用程序都在 rails 中。

另一种方法是使用 rackup 来安装所有三个使用`config.ru`（所有三个应用程序并行）

```
map "/" do
  run RailsApp::Application
end

map "/url1" do
  run SinatraApp1
end

map "/url2" do
  run SinatraApp2
end 
```

我无法找到一种优于另一种的优势，或者出于什么原因哪种方法更好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-23T08:39:56.550

有趣的是，除了在后一部分（使用机架安装的应用程序）这一事实之外，还有任何显着差异

任何要求

`/url1`

`/url2`

将直接从已安装的机架应用程序中成为服务器，而无需实际在导轨的中间件堆栈中传递请求，然后检测给定安装路径的有效机架应用程序。

这将发生在您的 sinatra 应用程序安装在`routes.rb`文件中定义的 Rails 内的第一部分

因此，我正在尝试使用`mount`您的 sinatra 应用程序，`routes.rb`而不是`config.ru`考虑这样一个事实，即您的请求**将一直被传递，** `rails middleware stack` 其中路由中间件检测到将请求传递给所需的 sinatra 应用程序的适当路径

一个简单的检查你可以做的是尝试点击你的路径`/url1`，或者`/url2`在这两种技术中，你会看到 sinatra 应用程序 routes.rb 会在你的 rails 应用程序中记录请求，而另一个不会

希望这有帮助

# php - PHP Sql Adding New Articles

> ID：11165533
> 
> 赞同：-1
> 
> 时间：2012-06-22T23:46:38.563
> 
> 标签：php, sql

Need help with some PHP and MySQL I cant find were I went wrong..

Trying to add new blog article using a function call. I know all other code is correct because if I manually add entry into database sql it shows on blog. When adding a new entry to database sql it never adds into the database.. Any one notice anything wrong?

I have functions for time and date of post and they all work. If I can figure out this part I can fix the tags too. If any one would like to see in a txt file just let me know its hard to post straight code to here...

```
function eb_admin_newarticle()
{
    global $lang;
    $output="\t\t".ucwords($lang['new_article'])."\r\n";;
    //To add new article post
    if(!empty($_POST['text']))
    {
        foreach($_POST as $key=>$value)
            $_POST[$key]=str_replace("Acirc;","",$value);
        $sql="INSERT INTO eb_articles SET article_flag=".$_POST['sticky'].",article_date=\"".time()."\",author_id=\"".$_SESSION['user_id-'.$_SERVER['SERVER_NAME']]."\", article_title=\"".str_replace("\"","&quot;",$_POST['title'])."\",article_body=\"".$_POST['text']."\",article_comments=".$_POST['comments'];
        mysql_query($sql);

        $article_id=mysql_insert_id();
        //input tags on article
        if(strlen($_POST['tags'])>1) {
            $tags=explode(",",$_POST['tags']);
            foreach($tags as $tag) {
                $sql="INSERT INTO eb_tags SET tag_name=\"".$tag."\"";
                mysql_query($sql);
                if(mysql_affected_rows()==1)
                    $tag_ids[]=mysql_insert_id();
                else
                    $tag_ids[]=mysql_result(mysql_query("SELECT tag_id FROM eb_tags WHERE tag_name=\"".$tag."\""),0);
            }
            foreach($tag_ids as $tag_id)
                mysql_query("INSERT INTO eb_tags_links SET tag_id=".$tag_id.",article_id=".$article_id);
        }

        header('Location: news.php?id='.$article_id);
    }
    else {
        $output.="\t\t<form action=\"admin.php?id=newarticle\" method=\"post\">\r\n";
        $output.="\t\t\t<p><b>".ucwords($lang['title'])."</b><br /><input class=\"inputtext\" type=\"text\" name=\"title\" /></p>\r\n";
        $output.="\t\t\t<textarea id=\"text\" name=\"text\"></textarea>\r\n";
        $output.="\t\t\t<p><b>".ucwords($lang['tags'])."</b><br />".$lang['tag_seperate']."<br /><input type=\"text\" class=\"inputtext\" name=\"tags\" /></p>\r\n";
        $output.="\t\t\t<p><b>".ucwords($lang['sticky'])."</b><br /><input type=\"radio\" name=\"sticky\" value=\"1\" checked=\"checked\" /> ".ucwords($lang['no'])."<br /><input type=\"radio\" name=\"sticky\" value=\"2\" /> ".ucwords($lang['yes'])."</p>\r\n";
        $output.="\t\t\t<p><b>".ucwords($lang['comments'])."</b><br /><input type=\"radio\" name=\"comments\" value=\"0\" /> ".ucwords($lang['no'])."<br /><input type=\"radio\" name=\"comments\" value=\"1\" checked=\"checked\" /> ".ucwords($lang['yes'])."</p>\r\n";
        $output.="\t\t\t<p><input type=\"submit\" name=\"submit\" value=\"".ucwords($lang['save'])."\" /></p>\r\n";
        $output.="\t\t</form>\r\n";
        return $output;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T00:01:30.190

第一件事

*   **您的代码容易受到 SQL 注入的攻击。**
    恶意用户可以轻松清除您的整个表。
*   **您还应该始终`exit;`在标头重定向之后使用。**
    当您发送 时`header`，页面仍将继续执行。此外，这只是对浏览器的建议。恶意用户可以让他的浏览器忽略标题并加载页面。
*   **您正在进行大量不必要的查询。**
    将标签添加到数据库后，您将通过另一个查询获取标签 ID。标签 ID 已经在`mysql_insert_id()`. 无需查询数据库。
    如果要向数据库添加 10 篇文章，则需要进行 10 次查询。这是完全没有必要的。请参阅 MySQL 手册，了解如何使用一个查询来执行此操作。
*   **你甚至不应该使用`mysql_*`！**
    这是不推荐使用和糟糕的风格！去寻找`mysqli`或 PDO 的教程，不要转发 2008 年的文章！

**关于实际问题**，请尝试自己调试。您没有检查您的任何查询是否成功。执行查询时，`mysql_query()`返回资源或`FALSE`失败。检查是否发生这种情况，这样您就可以找出错误发生的确切位置。

可能导致这种情况的一件事是您缺乏封装。例如，您需要更换

```
$sql="INSERT INTO eb_articles SET article_flag=".$_POST['sticky'].", ... 
```

和

```
$sql="INSERT INTO eb_articles SET article_flag='".$_POST['sticky']."', ... 
```

这适用于任何地方，总是用`'`. 那应该可以解决手头的问题，但是您的应用程序仍然很容易受到攻击。

# c# - 将TextBox的文本传递给C#中的另一个表单？

> ID：11165537
> 
> 赞同：4
> 
> 时间：2012-06-22T23:47:07.250
> 
> 标签：c#, winforms

我试过这个来传递信息：

```
Form1 frm1 = new Form1(); 
 textBox1.Text = ((TextBox)frm1.Controls["textBox1"]).Text; 
```

这是获取信息的表单的表单加载。但是没有文字。我该如何解决？`Form2`正在抓取`Form1`的文本并显示它。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-23T00:09:01.620

使用属性公开文本框的内容：

```
class Form1 {
  public string MyValue {
    get { return textBox1.Text; }
  }
} 
```

然后在 Form2 中执行以下操作：

```
var frm1 = new Form1();
frm1.ShowDialog(this); // make sure this instance of Form1 is visible
textBox1.Text = frm1.MyValue; 
```

如果您想`frm1`始终可见，请创建`frm1`一个类变量`Form2`，并调用例如`.Show()`的构造函数。`Form2`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-05-17T13:00:46.013

我发现在 Windows 应用程序中将文本值从一个文本框传递给另一个文本框的简单且合乎逻辑的方法。

**在第二种形式写代码： -**

```
 Create a Parameter of *Form2* Constructor.

    namespace PassingValue
    {
         public partial class Form2 : Form
         {
             public Form2(string message)
             {
                 InitializeComponent();
                 Textbox1.Text= message;
             }
         }
    } 
```

**在第一种形式写代码： -**

```
 Use the Parameter of Second Form in *First Form*:-

   namespace PassValue
   {
      public partial class Form1 : Form
      {
         public Form1()
         {
            InitializeComponent();
         }

         private void Button1_Click(object sender, EventArgs e)
         {
             Form2 f2=new Form2(Textbox.Text);
             f2.Show();
         }
      }
   } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-08-23T17:45:29.737

试试下面的代码，它对我有用......

```
 public static string sendtext = "";
private void button1_Click(object sender, EventArgs e)
{
sendtext = txt1.Text;
Form2 frm = new Form2();
frm.Show();
} 
```

在 form2 的表单加载事件中访问此数据

```
 private void Form2_Load(object sender, EventArgs e)
{
txt2.Text = Form1.sendtext;
} 
```

享受

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-25T13:00:23.970

表格 1

```
//Declare a Static variable
public static string txtInput=string.empty;`

//Set textBox Value to this variable on any event
txtInput=textBox1.Text; 
```

表格 2

```
// Now Call this variable from the Instance of form 1
string getForm1Value=string.empty;
getForm1Value=Form1.txtinput; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-09-05T15:24:16.100

**

> 100% 工作

**

取2个表格，Form1和Form2，Form1包含textbox1和Frm1Btn1，Form2包含Frm2Btn1，现在打开form1，点击打开form2

//FORM1 编码：

```
private void Frm1Btn1_Click(object sender, EventArgs e)

{
    Form2 obj=new Form2();
    obj.showDialog();
} 
```

//FORM2 编码：

```
private void Frm2Btn1_Click(object sender, EventArgs e)
        {

            Form1 objj = new Form1();

            objj =(Form1) Application.OpenForms["Form1"];

            objj.textBox1.Text = "Salil";

            objj=null;
        } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-01-24T10:47:31.737

对我来说，最简单的方法是这样的：

1.  将您的文本框修饰符属性更改为公共；
2.  在您打开第二个表单的地方，像这样打开它：**frm.Show(this);**
3.  在您的 Form2 中，无论您需要文本，只需执行以下操作：

> ```
> var frm = this.Owner;
> var ctl = frm.Controls.Find("textboxOnform1", true).FirstOrDefault() as 
>     Control;
> TextBox Txt = (TextBox)ctl; 
> 
> //And then you can use It 
> textboxt1.Text= Txt.Text; 
> ```

你可以做相反的事情 - 以同样的方式发回文本。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-22T23:55:33.393

如果它是一个 Web 表单，MSDN 会在请求文本的页面顶部提出此建议。

```
 <%@ PreviousPageType VirtualPath="~/SourcePage.aspx" %> 
```

然后在 page_load

```
 if (PreviousPage != null)
{
TextBox SourceTextBox = 
    (TextBox) PreviousPage.FindControl("TextBox1");
if (SourceTextBox != null)
{
    Label1.Text = SourceTextBox.Text;
}
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-23T00:24:33.840

确保 Form1 的 textBox1.Text 属性已初始化为您可以看到的*实际字符串。*我怀疑，由于您使用的是 Form1 的默认实例，因此 TextBox1.Text 属性是[String.Empty](http://msdn.microsoft.com/en-us/library/system.string.empty%28v=vs.110%29.aspx)，这是默认值（以及为什么您没有得到任何可见的文本，这似乎是您所期望的） .

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-02-08T17:34:41.040

您可以做的一件简单的事情是将文本框值存储到一个变量中，然后使用构造函数将其传递给另一个表单。例如

```
string textboxvalue=textbox1.Text();
form2 win = new form2(textboxvalue); 
```

这里 form2 是您要发送值的表单，而 win 是该表单的实例。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-02-04T07:35:21.517

在 Windows 应用程序中，只需转到另一个表单设计器并将该工具声明为公共。您可以从任何形式访问该工具。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-05-31T13:34:36.607

这是在结果表上：

1.  放一个文本框。
2.  您必须单击表单，直到弹出代码编辑器。
3.  在表单加载时，您插入代码。

代码：

```
Form1 frm1 = new Form1();
frm1.Show();
textBox1.Text = ((TextBox)frm1.Controls["textBox1"]).Text; 
```

第一种形式：

1.  放一个文本框和一个按钮。

按钮代码（在表单加载时，输入此代码）：

```
this.Close(); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-06-22T01:21:59.793

形式1：热咖啡

传递文本框 private void button15_Click(object sender, EventArgs e)//获取信用卡上的项目

```
 {
            this.Hide();
            hotcoffepayment p = new otcoffepayment(richTextBox2.Text);//pass form1 textbox
            p.Show();
    } 
```

在form2：hotcoffeepayment

公共热咖啡支付（字符串 strValue）

```
 {
        InitializeComponent();
        textBox1.Text = strValue;//here mention the form2 textbox name 
    } 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-07-02T13:14:24.577

您必须将 textbox 的 modifer 属性设置为“public”才能从另一个表单中获取其值

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2012-06-22T23:59:56.950

表格 1

```
 class Form1
    {

        public System.Windows.Forms.TextBox textBox1; // we need to make it public Textbox
        private System.Windows.Forms.Button button1;
    } 
```

在 Form2 上单击按钮或任何其他事件使用

表格 2

```
private void button1_Click(object sender, EventArgs e)
 {
            Form1 _form1 = new Form1();
            this._form2TextBox.Text = _form1.textBox1.Text;
 } 
```

有关详细信息，请访问[MSDN](http://msdn.microsoft.com/en-us/library/f6525896%28v=vs.90%29.aspx)

# android - Android 应用程序在模拟器上运行并安装在 Android 设备上，但是当我打开它时，它显示空白屏幕，然后强制关闭

> ID：11165538
> 
> 赞同：-3
> 
> 时间：2012-06-22T23:47:14.013
> 
> 标签：android, screen

我创建了一个小应用程序，当我在模拟器上运行它时，它运行完美。

但是，当我将它安装在设备上并启动它时，它会显示空白/黑屏，然后崩溃并显示消息`The Application TOH(process my.own) has stopped unexpectedly`。

不知道我在做什么错..

请指教..

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="my.own"
android:versionCode="2"
android:versionName="2.3.4" >

<uses-sdk android:minSdkVersion="10" />
<supports-screens android:smallScreens="true" 
      android:normalScreens="true" 
      android:largeScreens="true"
      android:xlargeScreens="true"
      android:anyDensity="true" />
<application
    android:icon="@drawable/background2"
    android:label="@string/app_name" >

    <activity
        android:name=".TOH"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>

    <activity
        android:name=".Startgame"
        android:label="@string/app_name">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

           </intent-filter>
    </activity>

    <activity
        android:name=".scoretell" 
        android:label="@string/app_name">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

        </intent-filter>
    </activity>
    <activity android:name=".details"
        android:label="@string/app_name">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

        </intent-filter>
    </activity>
    <activity
        android:name=".ShowPopUp"
        android:label="@string/app_name">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

           </intent-filter>
    </activity>

</application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T04:22:24.053

就像其他人所说的那样，Android Manifest（或任何 xml 文件）不会告诉您错误的故事。该文件中有一些需要修复的东西，但这可能会也可能不会导致错误。LogCat 在 Eclipse 中说什么？这可以作为 Eclipse 中的窗格访问：Window > Show View > LogCat。如果您使用连接到设备的 USB 进行调试，它可能会出现（红色）错误/文本。这将帮助社区看到具体的错误，甚至可能会指出你的代码步履蹒跚的行号。仅供参考，[这](http://fullroom.com/_blog/LogCatStep3.png)就是 logcat 屏幕的样子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T00:20:31.417

当你在模拟器上运行你的应用程序时，看看 Logcat 说了什么。

当应用程序在模拟器上运行时，我曾经遇到过一些“非致命”错误（在 Logcat 中标记为橙色），但显然，当应用程序部署在真实设备上时，该错误是致命的，因为它崩溃了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-23T00:29:40.237

尝试从您的活动中删除以下代码：

```
<intent-filter>
    <action android:name="android.intent.action.MAIN" />
</intent-filter> 
```

# android - 单选按钮的检查条件不起作用

> ID：11165540
> 
> 赞同：0
> 
> 时间：2012-06-22T23:47:33.890
> 
> 标签：android, checkbox, radio-button

我有这个代码：

```
if(ratingRB.isChecked() == true)
{
    Toast.makeText(hotelSearch.this, "Please enter the rating as a word. (Ex. Five)", Toast.LENGTH_SHORT).show();
}
else
{
    if(showAllRB.isChecked() == true)
    {
       nearest.setEnabled(true);
    }
} 
```

但是当我检查 2 个单选按钮（ratingRB、showAllRB）中的任何一个时，什么都没有发生。

`nearest`是一个从一开始就被禁用的复选框，我希望当用户选择时`showAllRB`，复选框被启用..怎么了？我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T00:52:34.763

这是一个类似的问题：[Radio Button selection Changes Toast on Android](https://stackoverflow.com/questions/2740169/radio-button-selection-changes-toast-on-android)

您想将您添加`RadioButtons`到 a 中`RadioGroup`，然后实现 a `RadioGroup.setOnCheckedChangeListener()`。

# c# - 创建、写入和读取新文件类型

> ID：11165544
> 
> 赞同：0
> 
> 时间：2012-06-22T23:48:31.577
> 
> 标签：c#, datatable, save

您好，我有一个生成大量数据的 WinForm 应用程序。目前我有这个可保存和可打开的 Excel .xls 文件格式。但是，我想摆脱这种情况，以便用户无法在 Excel 中打开文件并自由修改内容。

我想出的解决方案是将其编码为新的文件类型，例如“.por”文件。但是，我也不希望这是对扩展名的简单重命名，以便用户可以重命名回 .xls 并进行编辑。我怎样才能做到这一点？

此外，我以编程`DataTable`方式逐行将其写入 Excel 文件。`DataTable`使用不同的方法（不是 SQL）保存内容是否有帮助？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-23T00:14:33.337

一种简单的方法是将您`DataTable`放入`DataSet`，调用`DataSet`'`WriteXml(...)`方法（这会将您的数据以 XML 格式保存到文件中），然后使用`File.Encrypt`.

要从文件中读取，您需要反转该过程，使用`File.Decrypt`将文件转回纯 XML 文件，然后`DataSet`使用 DataSet 的`ReadXml(...)`方法将其加载到 a 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T23:53:36.417

只需序列化您的对象并将其写入磁盘。如果您想让您的用户更难在文本编辑器或其他东西中打开，请使用二进制文件。

[http://msdn.microsoft.com/en-us/library/ms233843.aspx](http://msdn.microsoft.com/en-us/library/ms233843.aspx)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-23T00:54:34.023

更好的是，制作一个`MIME Type`这样当用户双击“.por”文件时，它会触发一个 exe 来告诉用户该做什么。而不是在 Excel 中打开它。如果您不告诉他们，用户将不会知道 por 文件是 Excel 文件。

> 由于 xls 是二进制文件 - 如果文件的扩展名被更改，用户将不知道 MIME 类型，除非他们使用这样的东西： [确定 MAC 上传流文件的 MIME 类型](https://stackoverflow.com/questions/8734832/determining-mime-type-of-mac-upload-stream-file)

关于**获取数据表并逐行将其写入 Excel 文件。**

您可以轻松地将数据放入二维数组：

```
string[,] TwoDimensional = new string[dt.Rows.Count, dt.Columns.Count];
for (int i = 0; i < dt.Rows.Count; i++)
{
    for (int j = 0; j < dt.Columns.Count; i++)
    {
        TwoDimensional[i, j] = dt.Rows[i][j].ToString();
    }
} 
```

并一举将它们设置在 Excel 中：

```
using (var targetRangeHeader = _excelApp.Range["A1"].WithComCleanup())
using (var targetRangeFirstDataCell = targetRangeHeader.Resource.Offset[1, 0].WithComCleanup())
using (var targetRange = targetRangeFirstDataCell.Resource.Resize[LengthOfArray, 1].WithComCleanup())
{
....
targetRange.Resource.Value2 = TwoDimensional; 
```

请注意，我使用[VSTO Contrib](http://vstocontrib.codeplex.com/)进行最终确定 - 即`using`语句。

不要忘记这一点（记录当前的计算模式并恢复它而不是假设用户使用自动）：

```
 public static void TurnOffApplicationSettings(Excel.Application xlApp)
        {
            xlApp.ScreenUpdating = false;
            xlApp.DisplayAlerts = false;
            xlApp.Calculation = XlCalculation.xlCalculationManual;
            xlApp.UserControl = false;
            xlApp.EnableEvents = false;
        }

        public static void TurnOnApplicationSettings(Excel.Application xlApp)
        {
            xlApp.ScreenUpdating = true;
            xlApp.DisplayAlerts = true;
            xlApp.Calculation = XlCalculation.xlCalculationAutomatic;
            xlApp.UserControl = true;
            xlApp.EnableEvents = true;
        } 
```

# java - 用于计数数组反转的合并排序实现

> ID：11165546
> 
> 赞同：0
> 
> 时间：2012-06-22T23:48:47.160
> 
> 标签：java, mergesort

下面是我对数组反转的实现。对于某些输入，它会产生所需的结果。例如：

1 : 0,1,2,3,4,5,6,7,8,9 -> 0 反转（正确）

2 : 1000,999,998,997,.......3,2,1 -> 499500 反转（正确）

3 : 1,3,5,2,4,6 -> 3 反转（正确）

但对于

4 : 9,10,8,1,4,7,6,2,5,3 -> 41 反转（不正确）。正确答案是 33。

```
public class Assignment1 {
static int[] result = new int[10];

public static long divideW (int Arr[]) {
    long countLeft ;
    long countRight ;
    long countMerge ;

    int mid = (Arr.length)/2;

    if (Arr.length <= 1)
        return 0;
    else
    {
        int leftArr[] = new int [mid];
        int rightArr[] = new int [Arr.length - mid];

        for (int i = 0; i < mid; i++){
            leftArr[i] = Arr[i];
        }
        for (int j = 0; j < rightArr.length ; j++){
            rightArr[j] = Arr[mid + j];
        }   
        countLeft = divideW (leftArr);
        countRight = divideW (rightArr);

        //int[] result = new int[Arr.length];
        countMerge = conquer(leftArr, rightArr, result);
        return (countLeft + countRight + countMerge);
    }
}
public static long conquer (int []l, int[]r, int[] result) {
    int i = 0;
    int j = 0;
    int k = 0;
    long count = 0;
    while ((i < l.length) && (j < r.length)) {
    if (l[i] <= r [j]) {
        result[k] = l[i++];
    }
    else if (l[i] > r[j]) {
        result[k] = r[j++];
        count += l.length - i;
    }
    ++k;
    }
    while ( i < l.length) {
        result[k++] = l[i++];
    }
    while ( j < r.length) {
        result[k++] = r[j++];
    }
    return count;
}

public static void main(String[] args) {
    Assignment1 rs = new Assignment1();
    int anArr[] = {9,10,8,1,4,7,6,2,5,3};

    System.out.println (rs.divideW(anArr));

    for (int i = 0 ; i < result.length; ++i) {
        System.out.println (result[i]);
    }  
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-02T18:20:58.897

您的解决方案不正确，因为它没有将排序后的数组传递给**征服** 函数

下面是我使用 C# 实现的代码。

```
using System;

namespace SortingAlgos
{
    public class InversionCountUsingMergeSort
    {
        public static long InversionCount { get; set; }
        public static void Main(string[] args)
        {
            //Load an array
            int[] arrayInts = { 9, 10, 8, 1, 4, 7, 6, 2, 5, 3 };// { 10, 4, 7, 8, 6, 2, 3, 5 };//{1,3,5,2,4,6}--->3;//{ 9, 10, 8, 1, 4, 7, 6, 2, 5, 3 }-->41;//{ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 }--->0;//{ 10, 4, 7, 8, 6, 2, 3, 5 }; //LoadInts();

            Console.WriteLine("========= UnSorted Array Items ==========");

            //Print an unsorted array
            PrintInts(arrayInts);

            Console.WriteLine("========== Inversion Count =========");
            //Sort the array
            arrayInts = MergeSort(arrayInts);

            //Print Sorted array
            PrintInts(arrayInts);
            Console.WriteLine(InversionCount);
            Console.ReadKey();
        }

        private static int[] MergeSort(int[] arrayInts)
        {
            if (arrayInts.Length <= 1)
            {
                return arrayInts;
            }
            else
            {
                int[] result = new int[arrayInts.Length];

                int midPoint = arrayInts.Length / 2;
                int[] leftArray = new int[midPoint];
                int[] rightArray;
                if (arrayInts.Length % 2 == 0)
                {
                    rightArray = new int[midPoint];
                }
                else
                {
                    rightArray = new int[midPoint + 1];
                }

                for (int indexLeft = 0; indexLeft < midPoint; indexLeft++)
                {
                    leftArray[indexLeft] = arrayInts[indexLeft];
                }
                int indexRight = 0;
                for (int indexOnArryInts = midPoint; indexOnArryInts < arrayInts.Length; indexOnArryInts++)
                {
                    if (indexRight < rightArray.Length)
                    {
                        rightArray[indexRight] = arrayInts[indexOnArryInts];
                        indexRight++;
                    }
                }

                leftArray = MergeSort(leftArray);
                rightArray = MergeSort(rightArray);
                return MergeArrays(leftArray, rightArray);

            }
        }

        private static int[] MergeArrays(int[] leftArray, int[] rightArray)
        {
            int arraySize = leftArray.Length + rightArray.Length;
            int[] arrayFinal = new int[arraySize];
            int leftIndex = 0, rightIndex = 0;
            for (int index = 0; index < arraySize; index++)
            {
                if (leftIndex < leftArray.Length && rightIndex < rightArray.Length)
                {
                    if (leftArray[leftIndex] <= rightArray[rightIndex])
                    {
                        arrayFinal[index] = leftArray[leftIndex];
                        leftIndex++;                    
                    }
                    else if (leftArray[leftIndex] > rightArray[rightIndex])
                    {
                        arrayFinal[index] = rightArray[rightIndex];
                        rightIndex++;
                        InversionCount += leftArray.Length - leftIndex;
                    }
                }
                else if (leftIndex < leftArray.Length)
                {
                    arrayFinal[index] = leftArray[leftIndex];
                    leftIndex++;
                }
                else if (rightIndex < rightArray.Length)
                {
                    arrayFinal[index] = rightArray[rightIndex];
                    rightIndex++;
                }
            }
            return arrayFinal;
        }

        private static void PrintInts(int[] arrayInts)
        {
            for (int index = 0; index < arrayInts.Length; index++)
            {
                Console.WriteLine(string.Format("{0}", arrayInts[index]));
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T00:13:08.077

您的答案中的问题（我认为它是正确的）如下：

```
countMerge = conquer(leftArr, rightArr, result); 
```

您只需在**未排序**的数组（leftArr，rightArr）上征服部分，这就是反转次数不同的原因。我改变了这个代码如下，它的工作原理：

```
Arrays.sort(leftArr);
Arrays.sort(rightArr);
countMerge = conquer(leftArr, rightArr, result); 
```

# jquery - 处理 JSON 中的 NULL 值

> ID：11165549
> 
> 赞同：3
> 
> 时间：2012-06-22T23:49:31.197
> 
> 标签：jquery, json, null

我有一个 JSON 流回来，并正在用它的值动态构建一个表。我遇到了一个问题，即数据库中“NULL”的值实际上是在 JSON 中以 NULL 值返回的。

我宁愿我的输出给我的用户不显示 NULL。

除了我的做法之外，有没有更有效的方法来处理这个问题？

```
if(data[i][2] != null){ 
foo = '';
 }else{
foo = data[i][2];
}               
htmlString += '<td>' + foo+ '</td>'; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-23T00:04:00.740

```
cleanData = data[i][2] || ''; 
```

这相当于

```
if(data[i][2] == null){ 
    cleanData = '';
    }
else{
    cleanData = data[i][2];
    } 
```

取 data[i][2] 的值，否则取第二个

```
cleanData = data[i][2] || 'my fall back value'; 
```

如果 data[i][2] 的值未评估为 false，则将其分配给 cleanData，例如：false、null、undefined、0、零长度字符串或 NaN 被评估为 false。否则，将采用“我的后备价值”。很明显，如果您的变量需要采用这些值中的任何一个（如 0），则解决方案并不完美。

```
cleanData = (data[i][2] == null)? '' : data[i][2]; 
```

看起来更可靠。

# file-upload - Tabbable input type="file" 没有文本框是 Tabbable

> ID：11165554
> 
> 赞同：2
> 
> 时间：2012-06-22T23:50:46.490
> 
> 标签：file-upload, input, triggers, focus

我有一个“文件”类型的输入元素：

```
<input type="file"> 
```

它目前使用 jQuery 的 fileUpload 插件（版本 5.8.1）。

我有一些隐藏文件输入文本框的css，只显示按钮（我不需要文本框）。

我希望功能：

1.  点击输入按钮打开上传对话框...
2.  让输入按钮可切换（聚焦），这样我也可以这样打开上传对话框

这是我的问题：

如果我将输入设置为可选项卡，那么我也会将文本框设置为可选项卡（我不想要它，因为它甚至不可见）。

我已经查找了创建一个按钮的可能性，单击该按钮将触发输入的单击事件以上传文件；但是，我已经读到这可能是一个安全漏洞，并且在许多浏览器上不受支持。

有没有一种方法可以使输入成为可选项卡（但仅限于按钮），或者是否有其他方法可以在文件类型的输入上触发点击事件？

任何建议将不胜感激。

# bulletphysics - 将 [-90, 90] 范围内的偏航欧拉角转换为 [0, 360]

> ID：11165556
> 
> 赞同：2
> 
> 时间：2012-06-22T23:50:55.073
> 
> 标签：bulletphysics, euler-angles

是否可以转换从子弹物理引擎获得的偏航欧拉角使用

```
btTransform trans;
trans.getBasis().getEulerYPR(rx, ry, rz); 
```

在 [0 , 360] 范围内。否则，对于 360 度旋转，我得到的欧拉角从 0->90->0-> -90 -> 0 变化

但我想从 0->90->180->270->0

我的图形 API 只接受 0 到 360 范围内的旋转角度

* * *

嗯，0->90->0->-90 是音高值。这是我现在使用的代码：

```
trans.getBasis().getEulerYPR(yaw, pitch, roll);
y1 = (pitch >= 0) ? pitch : (PI2 + pitch); 
```

我试图为音高的负值添加 180，但这不起作用。好吧，看来我需要找到另一种使用欧拉角平滑旋转网格的方法。

* * *

更新：看来我不应该直接使用项目符号功能。更好的选择是直接处理基矩阵：

```
btMatrix3x3 m_el = trans.getBasis();
ry = btAtan2( m_el[0].z(), m_el[0].x() );
if(ry < 0)
    ry += SIMD_PI; 
```

所以这给了我关于 y 轴的旋转。现在关于其他 2 ....呸！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T00:06:03.473

不，请阅读不同角度或一般欧拉角的域。两个的域 [0, 2 pi] 通常是偏航和滚动，一个 [0, pi] 通常是俯仰。

# facebook-like - 具有开放图形标签的管理属性

> ID：11165563
> 
> 赞同：0
> 
> 时间：2012-06-22T23:52:55.250
> 
> 标签：facebook-like, admin, facebook-opengraph

我对我网站 (http://www.lisasmit.tk) 上的点赞按钮有疑问。我有这个点赞按钮有一段时间了，但现在我想在我的网站上添加 Open Graph 标签，这样点赞就会出现在其他人的点赞中，这样我就可以向喜欢我页面的人发送消息。

现在我遇到了这个问题，我在喜欢按钮旁边看不到“管理”功能，也无法进入我的 Facebook 页面上的管理部分。我已经在该部分下方添加了所有元标记（据我所知），我多次喜欢和不喜欢我的页面，但仍然没有任何显示。

我已经使用了统计页面（https://www.facebook.com/insights/），但我无法在那里得到任何结果。该错误提到在我的页面的根目录中找不到管理数据。

此外，我使用了 facebook 调试器，在我输入我的网址后，它提到了“应该修复的打开图形警告”：

*   推断属性：应显式
    提供“og:url”属性，即使可以从其他标签推断出值。
*   推断属性：应显式提供“og:title”属性，即使可以从其他标签推断出值。
*   推断属性：应显式提供“og:description”属性，即使
    可以从其他标签推断出值。

这些是我在 HTML 部分中添加的元标记：

```
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="https://www.facebook.com/2008/fbml" xmlns:og="http://ogp.me/ns#" xml:lang="en" lang="en">

<head>

    <meta property="og:title" content="Lisa Smit" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="http://www.lisasmit.tk" />
    <meta property="og:image" content="URLIMAGE" />
    <meta property="og:site_name" content="Lisa Smit" />
    <meta property="fb:admins" content="MYFBCODE" /> 
```

希望有人可以帮助我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T00:13:14.140

dot.tk 域实际上为您的网站构建了 iframe！因此，即使它显示您在 lisasmit.tk 上，您实际上也在[http://lisasmit.tumblr.com/](http://lisasmit.tumblr.com/)上。

[单击此处](https://developers.facebook.com/tools/debug/og/echo?q=http://lisasmit.tk/)查看 facebook 在您的网站上看到的内容

尝试给您`og:url as http://lisasmit.tumblr.com/`并尝试添加描述元标记，

```
<meta property="fb:description" content="Lisasmit description" /> 
```

也改变你喜欢的代码：

在调试工具中输入[http://lisasmit.tumblr.com/](http://lisasmit.tumblr.com/)以调试您的实际站点。修复此问题后，错误应该会消失。

# image-processing - RGB图像的边缘检测器？

> ID：11165564
> 
> 赞同：3
> 
> 时间：2012-06-22T23:52:55.750
> 
> 标签：image-processing, computer-vision

我已经为灰度图像实现了 Sobel、Prewitt 和 Canny 边缘检测器。我是否对 RGB 图像的每个通道应用相同的操作？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T00:09:24.630

The simplest approach is to apply edge detectors to the three color channels (RGB or HSV) independently, and to combine the results using logical operation (output fusion method).

There are also more sophisticated methods, which treat the three channels as coordinates of the 3D color space, and try to find edges by analyzing the gradient (multi-dimensional gradient methods).

[Source1](http://ai.stanford.edu/~ruzon/compass/color.html) [Source2](http://www.dsp.utoronto.ca/~kostas/Publications2008/pub/23.pdf)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-24T07:07:01.190

还有另一种计算三个通道平均值的方法（也可以加权），并对其应用边缘检测。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-23T00:04:01.807

我自己没有尝试过，但我希望通过先转换为像 YUV 这样的色彩空间，你会得到更好的结果。

# android - 如何在不知道当前活动的情况下在 Android 应用程序中显示对话框

> ID：11165573
> 
> 赞同：2
> 
> 时间：2012-06-22T23:54:59.757
> 
> 标签：android, android-activity, android-dialog

每当我的应用收到来自 android 平台的某种通知时，显示对话框的最佳方式是什么？例如，方向或设备语言发生变化等。

对我来说挑战是我不知道如何获取当前的活动上下文，所以很难使用 AlertDialog。

另外，我只想在应用程序在前台运行时才显示此对话框，所以我的第二个问题是是否有可靠的方法来检测应用程序是否在前台运行？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T00:14:34.333

您应该使用`BroadCastReceiver`. Mark Murphy 在下面的帖子中描述了如何做到这一点：

[如何显示来自 Android 广播接收器的对话框？](https://stackoverflow.com/q/3835160/844882)

# iphone - 让 iOS 应用社交化

> ID：11165584
> 
> 赞同：-2
> 
> 时间：2012-06-22T23:56:32.347
> 
> 标签：iphone, ios, social

**场景：**在 iOS 应用程序中，用户导航到产品视图并对产品进行“评论”。评论被普遍存储，因此应用程序的所有用户现在都可以查看“评论”。

**问题：**是否需要在服务器上设置远程数据库并创建应用程序与服务器之间通信的 API？或者有没有更好的方法来完成这个场景？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T00:00:33.093

您当然需要使用远程数据库。使用 Rails、Sinatra、web2py、Lift、Play 等创建用于发布和检索评论的 API 可能非常简单……

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T05:22:23.113

@Daniel 同意 User1087981 但对于快速应用程序开发，我建议您使用[http://getsocialize.com/](http://getsocialize.com/)。这可以很容易地集成。

# php - Codeigniter 从数据库创建关联数组并在下拉列表中使用

> ID：11165585
> 
> 赞同：0
> 
> 时间：2012-06-22T23:56:58.547
> 
> 标签：php, arrays, forms, codeigniter

我有一个名为`Categories`. 我想创建一个包含数据库中所有类别的表单下拉列表。我的解决方案是创建一个关联数组并将其添加到`form_dropdown()`函数的第二个参数中。我的结果是一个不需要的多维数组。

**模型：**

```
function list_categories()
    {
        $user_id = $this->tank_auth->get_user_id();

        $this->db->where('user_id', $user_id);
        $this->db->order_by("date_created", "desc");
        $query = $this->db->get('categories');
        return $query;      
    } 
```

**看法：**

```
//create array
$categories = array();

if ($query->num_rows() > 0) 
{
     $categories = $query->result_array();
}

//create dropdown
echo form_dropdown('category', $categories, $date_created); //selected value based date created 
```

代码给出了一个多维数组

```
Array ( 
[0] => Array ( [cat_id] => 27 [user_id] => 3 [cat_title] => Some Title [status] => 0 [date_created] => 2012-06-22 18:48:14 ) 

[1] => Array ( [cat_id] => 24 [user_id] => 3 [cat_title] => Title [status] => 0 [date_created] => 2012-06-20 19:37:47 ) 

[2] => Array ( [cat_id] => 23 [user_id] => 3 [cat_title] => Another Title [status] => 0 [date_created] => 2012-06-20 18:25:45 ) 

etc... 
```

如何将上面的结果替换为关联数组，其中 ID 键是类别 ID，值是类别标题？

例子：

```
$categories = array(
    "23" => "some title",
    "14" => "another title",
); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-23T01:18:16.317

示例解决方案：

```
$categories=array(
'0'=>array("cat_id"=>"27","cat_title"=>"some title"),
'1'=>array("cat_id"=>"24","cat_title"=>"Title"),
'2'=>array("cat_id"=>"23","cat_title"=>"Another Title"),
);

   foreach($categories as $catID=>$categoriesData){
        $finalArray[$categoriesData["cat_id"]]=$categoriesData;
   }

print_r($finalArray);

/*
OUTPUT

Array
(
    [27] => Array
        (
            [cat_id] => 27
            [cat_title] => some title
        )

    [24] => Array
        (
            [cat_id] => 24
            [cat_title] => Title
        )

    [23] => Array
        (
            [cat_id] => 23
            [cat_title] => Another Title
        )

)
*/ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-23T00:59:20.850

执行以下操作：

```
foreach($categories as $category){
    $category_array[$category['cat_id']] = $category['cat_title'];
}

$categories = $category_array; 
```

这会将类别 ID 分配为数组键，将标题分配为值，以在下拉列表中使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T00:24:03.313

您可以使用 html_helper 中的 _list() 函数从多维数组中创建嵌套列表

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-10T13:40:25.063

用这个简单的方法，

```
$query = $this->db->get_where('table', array('table_id' => $id));

        $queryArr = $query->result();        

        foreach ($queryArr[0] as $key=>$val)
        {
            $row[$key]=$val;
        }

print_r($row); //this will give associative array 
```

# javascript - 使用 knockoutjs 设置动态 observables

> ID：11165591
> 
> 赞同：0
> 
> 时间：2012-06-22T23:57:52.110
> 
> 标签：javascript, jquery, knockout.js

我正在尝试执行以下操作：

```
var viewModel = function() {
    var self = this;

    $.getJSON("/categories", function(data) {
        $.each(data, function(index, cat) {
            self[cat] = ko.observable(true);
        });
    });
} 
```

传入的数据是一个 JSON 类别名称数组 - 我在控制台日志中确认这些名称都很好。

但是，在我的模板中，当我使用`visible: viewModel[catname]`数据绑定时，什么也没有发生。虽然没有收到任何错误。有任何想法吗？

--

笔记：

实际模板（rails3）：

```
<% @categories.each do |category| %> 
<div data-bind="visible: viewModel[<%=category.name%>]">
<%= category.name %>
</div> 
<% end %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T00:57:14.407

您的绑定应该只是`visible: catname`. 所有绑定都已在 内“限定” `viewModel`，因此您无需在绑定中引用它。

在这里查看我的工作示例：http: [//jsfiddle.net/WpdMZ/](http://jsfiddle.net/WpdMZ/)。注意`banana`和`pear`被设置为`true`，所以它们对应的方块是可见的，但是`apple`被明确设置为`false`，所以它的方块是不可见的。

* * *

根据您的更新，您应该能够更改此行：

```
<div data-bind="visible: viewModel[<%=category.name%>]"> 
```

对此：

```
<div data-bind="visible: <%=category.name%>"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T01:31:28.910

杰基是正确的，但你真的应该考虑一种更一致的方法。如果您的数据正在输入，请将其放入剔除模型中，并使用剔除模板。这是演示此方法的小提琴：http: [//jsfiddle.net/tyrsius/W6SXU/3/](http://jsfiddle.net/tyrsius/W6SXU/3/)

# silverlight - 在 SIlverlight 业务应用程序中创建自定义注册

> ID：11165593
> 
> 赞同：0
> 
> 时间：2012-06-22T23:58:36.643
> 
> 标签：silverlight, service, ria

我需要使用自己的 SQL Server 数据库和表字段自定义 Silverlight Business 模板中的默认注册页面。登录也一样。我该怎么做呢？非常感谢任何好的想法或文档。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T12:02:37.900

我想这篇文章会对你有所帮助。

[http://www.codeproject.com/Articles/83078/A-Sample-Silverlight-4-Application-Using-MEF-MVVM](http://www.codeproject.com/Articles/83078/A-Sample-Silverlight-4-Application-Using-MEF-MVVM)

# php - 循环通过 MySQL left join in php vs. 2个单独的查询

> ID：11165597
> 
> 赞同：1
> 
> 时间：2012-06-22T23:59:42.313
> 
> 标签：php, mysql, while-loop, left-join

我的网站上有一个简单的问答部分，允许发表评论。我目前使用循环和 $_GET['id'] 值填充答案。这是我的查询

```
<?php
try{
   $parent=$_GET['id'];
   $post_type = "2";
   $stmt = $dbh->prepare(
    "SELECT p.post_id, p.content, p.author, p.created, pc.comment_id AS comment_id, pc.content AS comment_content
     FROM posts AS p
     LEFT JOIN posts_comments AS pc
     ON p.post_id = pc.parent_id
     WHERE p.post_type = :post_type AND  p.parent = :parent ");

   $stmt->bindParam(':parent', $parent, PDO::PARAM_INT);
   $stmt->bindParam(':post_type', $post_type, PDO::PARAM_INT);
   $stmt->execute();

   $answers_array = array();
   while ($answers = $stmt->fetch(PDO::FETCH_ASSOC)) {
        $answers_array[]= $answers;
   }
}

?> 
```

这将在数​​组中返回以下结果

```
 Array ( 
[0] => Array ( 
        [post_id] => 12 
        [content] => I have an answer
        [author] => Author1
        [created] => 2012-06-09 21:43:56
        [comment_id] =>
        [comment_content] => ) 
[1] => Array ( 
        [post_id] => 13
        [content] => My second answer
        [author] => Author1
        [created] => 2012-06-10 06:30:58
        [comment_id] => 35
        [comment_content] => 1st comment ) 
[2] => Array ( 
        [post_id] => 13
        [content] => My second answer
        [author] => Author2
        [created] => 2012-06-10 06:30:58
        [comment_id] => 36
        [comment_content] => 2nd comment ) 
[3] => Array ( 
        [post_id] => 13
        [content] => My second answer
        [author] => Author2 
        [created] => 2012-06-10 06:30:58
        [comment_id] => 37
        [comment_content] => 3rd comment ) 
) 
```

在我的 question.php 页面上，我知道我需要使用类似的方法遍历这些结果

```
<?php $answer_count = count($answers_array);
 for($x = 0; $x < $answer_count; $x++) {
 $answers = $answers_array[$x];
}
?> 
```

我的问题 -

我不知道是使用两个单独的查询来提取与每个答案相关联的评论，还是使用我上面的连接并使用 php.ini 构建另一个数组。我不知道如何诚实地做到这一点。如果我使用连接，我想要一个看起来像这样的数组，但我不确定如何使用 php.ini 中的循环来构建它。

```
 Array ( 
[0] => Array ( 
        [post_id] => 12 
        [content] => I have an answer
        [author] => Author1 
        [created] => 2012-06-09 21:43:56 
        [comment_id] => 
        [comment_content] => ) 
[1] => Array ( 
        [post_id] => 13 
        [content] => My second answer
        [author] => Author1 
        [created] => 2012-06-10 06:30:58 
            Array( 
                   [1] => Array (
                       [comment_id] => 35
                       [comment_content] => 1st comment)
                   [2] => Array (
                       [comment_id] => 36
                       [comment_content] => 2nd comment)
                   [3] => Array (
                       [comment_id] => 37
                       [comment_content] => 3rd comment)) 
```

一旦我有一个这样的数组，我想我可以在 question.php 页面上的原始 php 循环中为每个数组做一个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T01:02:27.613

一个查询就好了。正如你所拥有的，可能是更好的选择。你必须找出哪个更有效，让 MySQL 承担压力，或者网络和 PHP 承担压力。让 PHP 比 MySQL 承担压力要好得多，但是如果 MySQL 具有“内置”功能，例如您想要的分组，那么离开 MySQL 并节省网络流量。

要使其工作：将“ORDER BY p.post_id, pc.comment_id”添加到您的查询中 - 这会按顺序获得结果。

然后，如果您必须构建到数组中（尽管您可能可以不使用数组直接处理，但方法类似）：

```
$lastPostID = 0;
while ($row = $stmt->fetch(PDO::FETCH_ASSOC)) {
    if ($lastPostID <> $row['post_id']) {
        $lastPostID  = $row['post_id'];
        $answers[$lastPostID] = array('post_id' => $row['post_id'],
                                      'author_id' => $row['author_id'],
                                      etc
                                      'comments' => array() );
    }
    $answers[$lastPostID]['comments'][] = array('comment_id' => $row['comment_id'], 'coment' => $row['comment'] etc);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-23T00:58:57.543

这是你的选择。每个都有其优点和缺点。使用单个查询（显然，单个数据库调用和）您只需要循环一次数据集，但您有可能返回重复数据。使用多个查询，您只需要准确地拉回您需要的数据，但是（显然，多个数据库调用和）您必须迭代多组数据。

下面是单查询方法的脏实现（相同的基本流程适用于多查询方法，除了评论构建是它自己的循环）。但是基本的想法就在那里。您有一个答案地图，在您迭代记录时添加/检索它们，并附加评论。

```
while ($answers = $stmt->fetch(PDO::FETCH_ASSOC)) 
{
    $post_id = strval($answers['post_id']);
    if(!array_key_exists($post_id, $answers_array)) {
        $answers_array[$post_id] = array(
            'post_id' => $answers['post_id'],
            // ... assign other stuff ...
            'comments' => array()); //initialize the comments array
    }
    if(!empty($answers_array['comment_id'])) {
        $obj = $answers_array[$post_id];
        $obj['comments'][] = array(
            'comment_id' => $answers['comment_id'], 
            'comment_content' => $answers['comment_content']);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-23T00:55:13.020

您将希望使用 JOIN 通过单个查询返回所有结果，否则，您将进行多个查询，每个帖子一个查询。发出许多单独的查询会产生很多开销。

如果您想返回极少数的发布结果，则例外。

请务必按 post_id、comment_id 对查询进行排序。

要遍历组合结果，它看起来像这样：

```
$post_id = 0;
foreach($rows as $row) {
  // See if our post changed
  if ($post_id != $row['post_id']) {
    // Display the post and post header
    ..
    // Update the current post_id variable
    $post_id = $row['post_id'];
  }
  // Display the comment
} 
```

# javascript - 在 Three.js 中创建两点之间的样条曲线

> ID：11165607
> 
> 赞同：9
> 
> 时间：2012-06-23T00:01:55.733
> 
> 标签：javascript, three.js

我正在尝试使用 Three.js 将点与样条连接起来，以实现我正在尝试制作的可视化。

据我所知，我将点添加到数组中，将其传递给 THREE.SplineCurve3，逐步遍历样条点以获取几何坐标并进行渲染。如果我只将开始/结束点添加到数组中，它会起作用，但如果我尝试添加中点，则会出现错误。

示例在这里：

[http://jsfiddle.net/sLQK9/4/](http://jsfiddle.net/sLQK9/4/)

我确定这很简单，但我无法发现 - 任何人都可以帮助我吗？

最终，这些点将位于球体的表面上，两个点之间的样条线将采用飞机将采用的路线 - 即类似于大圆，但在样条线的中点离球体中心更远。

提前谢谢了。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-06-03T16:38:37.387

我在 3D 场景中的两点之间制作曲线的解决方案，尤其是在地球上：

```
var createCurvePath = function(start, end, elevation) {
    var start3 = globe.translateCordsToPoint(start.latitude, start.longitude);
    var end3 = globe.translateCordsToPoint(end.latitude, end.longitude);
    var mid = (new LatLon(start.latitude, start.longitude)).midpointTo(new LatLon(end.latitude, end.longitude));
    var middle3 = globe.translateCordsToPoint(mid.lat(), mid.lon(), elevation);

    var curveQuad = new THREE.QuadraticBezierCurve3(start3, middle3, end3);
    //   var curveCubic = new THREE.CubicBezierCurve3(start3, start3_control, end3_control, end3);

    var cp = new THREE.CurvePath();
    cp.add(curveQuad);
    //   cp.add(curveCubic);
    return cp;
} 
```

然后调用它：

```
var cp = globe.createCurvePath(item1, item2, 200);
var curvedLineMaterial =  new THREE.LineBasicMaterial({color: 0xFFFFAA, linewidth: 3});
var curvedLine = new THREE.Line(cp.createPointsGeometry(20), curvedLineMaterial);
globe.scene.add(curvedLine); 
```

note 曲线创建的二次或三次方法 ![二次与三次贝泽](../Images/e451a8f470d91ea92f81b375e741c7b2.png)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-25T08:29:41.687

我认为你需要指定你希望样条曲线用多少点来插值曲线，虽然你指定`control`了点，但曲线不知道你想要它有多平滑。

尝试这样的事情：

```
// smooth my curve over this many points
var numPoints = 100;

spline = new THREE.SplineCurve3([
   new THREE.Vector3(0, 0, 0),
   new THREE.Vector3(0, 200, 0),
   new THREE.Vector3(150, 150, 0),
   new THREE.Vector3(150, 50, 0),
   new THREE.Vector3(250, 100, 0),
   new THREE.Vector3(250, 300, 0)
]);

var material = new THREE.LineBasicMaterial({
    color: 0xff00f0,
});

var geometry = new THREE.Geometry();
var splinePoints = spline.getPoints(numPoints);

for(var i = 0; i < splinePoints.length; i++){
    geometry.vertices.push(splinePoints[i]);  
}

var line = new THREE.Line(geometry, material);
scene.add(line); 
```

然后，正如@juan Mellado 回答中所指出的那样，您可以使用`spline.getPoint(t)`其中 t 是`0-1`样条曲线的起点和终点之间的值来获得在线上的位置。

顺便说一句，请参阅最近为我回答的[问题](https://stackoverflow.com/questions/11179327/orient-objects-rotation-to-a-spline-point-tangent-in-three-js)，其中包括上面的示例。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-24T09:16:29.263

的参数`getPoint`必须在 [0..1] 范围内：

```
// Virtual base class method to overwrite and implement in subclasses
//  - t [0 .. 1]

THREE.Curve.prototype.getPoint = function ( t ) {
... 
```

# iphone - NSMutableDictionary 为有效键返回（null）/忘记它的值？

> ID：11165609
> 
> 赞同：2
> 
> 时间：2012-06-23T00:02:21.233
> 
> 标签：iphone, objective-c, ipad, null, nsmutabledictionary

行。我有一个“游戏”类，它创建了我的“棋盘”类的一个实例，并对其进行了测试。

“Board”类有一个字典，它似乎无法保持它的值（？）试图将代码限制到最小：

游戏类：

```
@interface Game : UIViewController{
    Board *board;
}
-(void)testAgain; 

@implementation Game
-(void)setup{
    board = [Board alloc]createBoard];
    [board test]; //returns right value
    [self testAgain]; //returns (null), see output below
}
-(void)testAgain{
    [board test];
}

-(void)didLoad{
    [self setup];
} 
```

板级：

```
@interface Board : NSObject{
@property(nonatomic, retain) NSMutableDictionary *dict;

-(Board *)createBoard;
-(void)test;

@implementation Board
@synthesize dict;

-(Board *)createBoard{

    dict = [[NSMutableDictionary alloc]init];

    [dict setObject:@"foo1" forKey:@"1"];
    [dict setObject:@"foo2" forKey:@"2"];
    [dict setObject:@"foo3" forKey:@"3"];
    [dict setObject:@"foo4" forKey:@"4"];
    [dict setObject:@"foo5" forKey:@"5"];

    return self;
}

-(void)test{
    NSLog(@"Test return: %@", [dict objectForKey:@"4"]);
} 
```

以下输出：

```
2012-06-23 01:05:28.614 Game[21430:207] Test return: foo4
2012-06-23 01:05:32.539 Game[21430:207] Test return: (null) 
```

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T00:14:15.917

```
@implementation Game
-(void)setup{
    board = [[[Board alloc] init] createBoard];
    [board test]; //returns right value
    [self testAgain]; //returns (null), see output below
} 
```

您使用的创建模式超出了 Objective-C 的所有约定。您应该使用 [Board new]、[[Board alloc] init|With...|] 或 [Board board|With...|]。

```
-(Board *)createBoard {

    self.dict = [[NSMutableDictionary alloc]init];

    [dict setObject:@"foo1" forKey:@"1"];
    [dict setObject:@"foo2" forKey:@"2"];
    [dict setObject:@"foo3" forKey:@"3"];
    [dict setObject:@"foo4" forKey:@"4"];
    [dict setObject:@"foo5" forKey:@"5"];
} 
```

让我们看看您的代码是否在丢失的 init 重新安装到它所属的位置以及那个小小的丢失的 self 的情况下工作得更好。.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T00:12:05.123

首先，您没有正确地`Board`使用`createBoard`. 您甚至没有`Board`在该方法中返回对象。尝试将该方法修改为如下所示：

```
-(id)initWithCreatedBoard {

self = [super init];

if (self) { 

dict = [[NSMutableDictionary alloc]init];

[dict setObject:@"foo1" forKey:@"1"];
[dict setObject:@"foo2" forKey:@"2"];
[dict setObject:@"foo3" forKey:@"3"];
[dict setObject:@"foo4" forKey:@"4"];
[dict setObject:@"foo5" forKey:@"5"];

[dict retain];

} 
```

回归自我；

}

你也可能想要`retain dict`. 因为他们可能正在被释放。

另外，您使用ARC吗？

另一件事，而不是有两个方法`testAgain`和`test`. 只需调用`test`两次：

```
for (int i = 0; i <= 2; i++) {

[self test];

} 
```

只是更好的结构，就是这样。请反馈您的结果！

# jquery - 带有特定文本的 jQuery 选择器 td

> ID：11165618
> 
> 赞同：3
> 
> 时间：2012-06-23T00:04:04.193
> 
> 标签：jquery

我有一个看起来像这样的 jquery 选择器：

```
$("#MasterListDVWP tr td:contains('" + currentSchool + "')").siblings("td:contains('Yes')").siblings("td:contains('CD'),td:contains('Other1')").each(function() {
// do something
}); 
```

有人可以帮我转换选择器，使其返回与确切文本匹配的对象，而不仅仅是包含吗？我知道这是无效的，但是像这样..siblings("td:equals('CD')")...

对你的帮助表示感谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-23T00:11:04.790

您最好的选择可能是 .filter() 函数。传递一个函数来测试你正在检查的元素的文本

```
$('#MasterListDVWP tr td').filter(function(){
  return $(this).text() === currentSchool;
}).siblings('td').filter(function(){
  return $(this).text() === 'CD' || $(this).text() === 'Other1';
}).each(function(){
  // do something
}); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-23T00:13:23.023

没有像这样的 jQuery 选择器，但您可以创建一个：

```
jQuery.extend(jQuery.expr[':'], {
    containsExactly: function (obj, index, meta, stack) {
        if ($(obj).text() === meta[3]) {
            return true;
        }
        return false;
    }
}); 
```

如果你这样做，那么你现在可以这样做：

```
$("#MasterListDVWP tr td:td:containsExactly('" + currentSchool + "')").siblings("td:containsExactly('Yes')").siblings("td:td:containsExactly('CD'),td:td:containsExactly('Other1')").each(function() {
// do something
}); 
```

[**试试看！**](http://jsfiddle.net/adamzr/ZcGBT/)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-23T00:07:18.637

使用裸选择器是不可能的。

也许你可以`.filter()`像这样使用：

```
 $(...selectors...).filter(
     function (index) { return $(this).text() == "textToMatch"; }
); 
```

对于同一元素的多个过滤：

```
 $(...selectors...).filter(
     function (index) { 
          return $(this).text() == "textToMatch" && $(this).text()=="anotherText"; 
     }
); 
```

或者只是将各种`.filter()`声明链接在一起。

使用 || （或）而不是 && 来查找带有文本*或*其他内容的 TD。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-12-09T13:58:58.113

使用文本过滤行 TD

```
$("#table_id tr td").filter(
     function (index) { return $(this).text() == text_to_find; }
).parent().show() 
```

# cakephp - 使用 POST 请求在 REST Web 服务上接收文件

> ID：11165619
> 
> 赞同：0
> 
> 时间：2012-06-23T00:04:20.463
> 
> 标签：cakephp, cakephp-2.1

我正在尝试获取对操作发出 POST 请求的文件。Web 服务工作正常，但我无法“按原样”检索该文件。Cake 自动将 $this->request->data 转换为一个数组，这不是我需要的。我需要将该文件保存到我的数据库中的 BLOB 列中。

请帮我！！！

提前感谢您的帮助！！

这是我的控制器代码，我使用的是 CakePHP 2.1.0：

```
class TransfersController extends AppController {
public $name = 'Transfers'; 
public $components = array('RequestHandler');

public function record($rfc = null, $numop = null, $source = null) {        
    if ($this->request->is('post')) {
        if (strlen($rfc) > 0) {             
            if ($numop > 0) {
                $this->loadModel('Client');
                $client = $this->Client->findByRfc($rfc);
                if (!empty($client)) {
                   if ($client['Client']['enabled'] == 1) {
                        // unknown way to get the received file                         

                        $this->Transfer->set('client_id', $client['Client']['id']);                             
                        $this->Transfer->set('num_operacion', $numop);
                        $this->Transfer->set('source', $source);
                        // $this->Transfer->set('xml', $this->request->data);
                        if ($this->Transfer->save($this->request->data)) {
                            //$message = 'Ok';
                            $message = $data;
                        } else {
                            $message = 'No se pudo registrar la transmisión';
                        }
                    } else {
                        $message = 'Su cuenta ha sido suspendida. Póngase en contacto con nostros para resolver éste inconveniente.';
                    }
                } else {
                    $message = 'El RFC ' . $rfc . ' no está registrado';
                }
            } else {
                $message = 'El número de operación no es válido';
            }
        } else {
            $message = 'El RFC no es válido';
        }
    } else {
        $message = 'La petición es inválida';
    }
    $this->set('message', $message);
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T19:24:12.533

对于那些有同样问题的人，我可以使用以下方法处理收到的文件：

```
$this->request->input(); 
```

# beanstalkd - 使用 beanstalkc 检查是否所有保留的作业都已完成

> ID：11165622
> 
> 赞同：1
> 
> 时间：2012-06-23T00:04:43.183
> 
> 标签：beanstalkd, beanstalkc

我希望我的一个脚本知道 beanstalkd 中所有剩余的排队作业是否都已完成。

我目前正计划遍历每个作业 ID 并运行 peek() 以查看是否返回任何内容。

有没有更优雅的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-13T16:22:48.713

我想出了如何做到这一点。通过 beanstalk 客户端检查保留作业和​​排队作业的数量是否为零会告诉您剩余作业何时完成。

# jquery - 获取同一个类的所有元素的outerHeight之和

> ID：11165625
> 
> 赞同：21
> 
> 时间：2012-06-23T00:05:14.893
> 
> 标签：jquery

我认为这是一个非常简单的问题，但是......

```
var outerHeight = $('.profile').outerHeight();
$("#total-height").text(outerHeight + 'px'); 
```

现在 var`outerHeight`只给了我 class 的第一个元素的 outerHeight `.profile`。

如何获得类中*所有*元素的 outerHeights 的总和`.profile`？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-06-23T00:08:29.450

循环遍历每个匹配的元素并将外部高度相加：

```
var outerHeight = 0;
$('.profile').each(function() {
  outerHeight += $(this).outerHeight();
});
$("#total-height").text(outerHeight + 'px'); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-06-23T00:08:43.427

这是直接的解决方案。只需遍历 jQuery 对象的元素来总结`outerHeight()`s.

```
var total = 0;
$('.profile').each(function(){
    total += $(this).outerHeight();
});
// total is good here 
```

重要的是所有 jQuery getter 只返回 jQuery 集合中第一个元素的值，但您可以自己添加它们。

这是一个迂回但很酷的方式[http://jsfiddle.net/mendesjuan/bKtAn/6/](http://jsfiddle.net/mendesjuan/bKtAn/6/)

```
// You can use a jQuery object as the `this` param in `Array.prototype` functions
var totalHeight = Array.prototype.reduce.call($('span'), function(a,b){
   // The first param is either the default value (passed into reduce)
   // or the result of the last call of this reducing function
   return a + $(b).outerHeight();
}, 0); 
```

这可以概括为`reduce`一个插件，如：http: [//jsfiddle.net/mendesjuan/bKtAn/9/](http://jsfiddle.net/mendesjuan/bKtAn/9/)

```
(function( $ ) {
    $.fn.reduce = function(cb, init) {  
      return Array.prototype.reduce.call(this, function(a,b){
            return cb(a, b);
      }, init);  
    }
})(jQuery);

const total = $('span').reduce(
   (accumulator, current) => accumulator + $(current).height(),
   0
);
console.log({total}); 
```

我觉得我有点过火了，抱歉，我很兴奋，但是这些代码片段教会了你很多关于 JS 甚至 jQuery 的知识

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-08-23T20:23:05.933

`$("selector")`已经是收藏了。 **直接访问`.outerHeight()`**或任何其他方法，如`.height()`

```
var total = 0;
$("div").outerHeight(function(i, v){
   total += v;
});

alert( total ); // Just to test 
```

```
var total = 0;

$("div").outerHeight(function(i, v){ total += v; });

alert( total );
```

```
div{background:#eee; margin:3px;}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<div style="height:100px;">100px</div>
<div>just lots of breaklines :)<br><br><br><br></div>
<div style="height:200px;">200px</div>
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-23T00:08:04.950

```
var total = 0;
$('.profile').each(function() {
     total += $(this).outerHeight();
});

$("#total-height").text(total + 'px'); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-23T00:08:34.343

不返回 jQuery 对象的 jQuery 函数仅对列表的第一个成员进行操作。

如果要遍历所有`.profile`元素，可以使用`.each()`

```
var totalHeight = 0;
$('.profile').each(function(i, e) {
    totalHeight += $(e).outerHeight();
}); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-06-23T00:08:48.097

试试这个：

```
var outerHeightTotal = 0;
$('.profile').each(function(){
  outerHeightTotal += $(this).outerHeight();
}); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-11-01T16:17:22.667

您可以使用[`get`](https://api.jquery.com/get/)原生元素的数组并[`reduce`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/reduce)获得总和。

这可能更简洁，因为它是一行，无需提前声明变量。

```
const height = $('div').get().reduce((prev, curr) => prev + curr.offsetHeight, 0);
console.log(height);
```

```
.child1 {
  height: 30px;
  background: red;
}

.child2 {
  height: 50px;
  background: green;
}

.child3 {
  height: 10px;
  background: blue;
}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<div class="child1"></div>
<div class="child2"></div>
<div class="child3"></div>
```

当然，这种方法可以在没有 jQuery 的情况下使用。`[...]`事情是转换为`NodeList`元素数组）

```
const height = [...document.querySelectorAll('div')].reduce((prev, curr) => prev + curr.offsetHeight, 0);
console.log(height);
```

```
.child1 {
  height: 30px;
  background: red;
}

.child2 {
  height: 50px;
  background: green;
}

.child3 {
  height: 10px;
  background: blue;
}
```

```
<div class="child1"></div>
<div class="child2"></div>
<div class="child3"></div>
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-08-28T14:47:19.843

你也可以像我一样偷懒，引入一个新的 jQuery 函数来为你完成所有的工作，就像这样：

```
(function($) {    
    $.fn.sumOfOuterHeights = function () {
        var sum = 0;
        $(this).each(function () {
            sum += $(this).outerHeight();
        });
        return sum;
    };
})(jQuery); 
```

然后在你喜欢的任何地方使用它：

```
var height = $('.a, .b, .c').sumOfOuterHeights(); 
```

对我来说，如果您经常使用它，它的可读性和 DRY 也会更高一些。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-04-08T11:50:06.113

更现代的选择：

```
let height = 0
$('.profile').each((i, el) => height += $(el).outerHeight()) 
```

# c# - 实体框架 - 使用多个 edmx 文件

> ID：11165627
> 
> 赞同：2
> 
> 时间：2012-06-23T00:05:47.463
> 
> 标签：c#, .net, entity-framework, repository, unit-of-work

我正在使用实体框架 4，并且我有很多表（500）。我的 edmx 文件非常大，我发现很难打开它并对其进行更改。我发现在我的项目中有与特定业务相关的表“组”，所以我想将 edmx 分成几个文件。我正在使用存储库模式和工作单元模式，并以这种方式使用 POCO：

```
This is my container
    public partial class MyEntities : ObjectContext {
        #region Private Methods
        private void SetContextOptions() {
            ContextOptions.LazyLoadingEnabled = false;
        }
        #endregion

        #region Constructors
        public MyEntities()
            : base("name=MyConnection", "MyEntities") {
            SetContextOptions();
            OnContextCreated();
        }
        #endregion

        #region Partial Methods
        partial void OnContextCreated();
        #endregion
    } 
```

对于每个 edmx，我将 Entity Container Name 属性设置为 MyEntities。这是我的通用存储库：

```
public class Repository<T> : IRepository<T> where T : class, IDataEntity
{
    ObjectContext _context;
    IObjectSet<T> _objectSet;

    protected ObjectContext Context
    {
        get
        {
            if (_context == null)
            {
                _context = GetCurrentUnitOfWork<EFUnitOfWork>().Context;
            }

            return _context;
        }
    }

    protected IObjectSet<T> ObjectSet
    {
        get
        {
            if (_objectSet == null)
            {
                _objectSet = this.Context.CreateObjectSet<T>();
            }

            return _objectSet;
        }
    }

    public TUnitOfWork GetCurrentUnitOfWork<TUnitOfWork>() where TUnitOfWork : IUnitOfWork
    {
        return (TUnitOfWork)UnitOfWork.Current;
    }       

    public virtual IQueryable<T> GetQuery(IEnumerable<Expression<Func<T, object>>> includes)
    {
        return ObjectSet.IncludeMultiple(includes);
    }

    public virtual IPaged<T> GetQuery(IQueryable<T> query,
        Func<IQueryable<T>, IOrderedQueryable<T>> orderBy, int pageNumber, int pageSize)
    {
        if (orderBy != null)
        {
            query = orderBy(query);
        }

        IPaged<T> page = new Paged<T>(query, pageNumber, pageSize);

        return page;
    }

    public virtual IPaged<T> GetQuery(IEnumerable<T> query,
        Func<IEnumerable<T>, IOrderedEnumerable<T>> orderBy, int pageNumber, int pageSize)
    {
        if (orderBy != null)
        {
            query = orderBy(query);
        }

        IPaged<T> page = new Paged<T>(query, pageNumber, pageSize);

        return page;
    }

    public virtual IEnumerable<T> GetObjectStateManagerChanges()
    {
        return this.Context.ObjectStateManager.
            GetObjectStateEntries(EntityState.Added | EntityState.Modified).
            Select(e => e.Entity).
            OfType<T>();
    }

    public virtual void Insert(T entity)
    {
        this.ObjectSet.AddObject(entity);
    }

    public virtual void Delete(T entity)
    {
        this.ObjectSet.DeleteObject(entity);
    }

    public virtual void MarkModified(T entity)
    {
        this.Context.ObjectStateManager.ChangeObjectState(entity, EntityState.Modified);
    }

    public virtual void Attach(T entity)
    {
        ObjectStateEntry entry = null;
        if (this.Context.ObjectStateManager.TryGetObjectStateEntry(entity, out entry) == false)
        {
            this.ObjectSet.Attach(entity);
        }
    }

    public virtual void Detach(T entity)
    {
        ObjectStateEntry entry = null;
        if (this.Context.ObjectStateManager.TryGetObjectStateEntry(entity, out entry) == true)
        {
            this.ObjectSet.Detach(entity);
        }
    }

    public virtual T GetOriginalEntity(Func<T, bool> predicate)
    {
        T originalEntity = null;
        EFUnitOfWorkFactory factory = new EFUnitOfWorkFactory();
        using (EFUnitOfWork uow = (EFUnitOfWork)factory.Create())
        {
            originalEntity = uow.Context.CreateObjectSet<T>().Single(predicate);
        }
        return originalEntity;
    }
} 
```

这是我的工作实施单元：

```
 public class EFUnitOfWorkFactory : IUnitOfWorkFactory
    {
        private static int Counter = 0;
        private static Func<ObjectContext> _objectContextDelegate;
        private static readonly Object _lockObject = new object();

        public static void SetObjectContext(Func<ObjectContext> objectContextDelegate)
        {
            _objectContextDelegate = objectContextDelegate;
        }

        public IUnitOfWork Create()
        {
            ObjectContext context;

            lock (_lockObject)
            {
                Counter++;
                context = _objectContextDelegate();
            }

            return new EFUnitOfWork(context, Counter);
        }
    }

public class EFUnitOfWork : IUnitOfWork, IDisposable
    {
        public ObjectContext Context { get; private set; }
        public int Id { get; private set; }

        public EFUnitOfWork(ObjectContext context, int id)
        {
            Id = id;
            Context = context;
            Context.ContextOptions.LazyLoadingEnabled = false;
        }

        public int Commit()
        {
            return Context.SaveChanges();
        }

        public void Dispose()
        {
            if (Context != null)
            {
                Context.Dispose();
                Context = null;
            }

            GC.SuppressFinalize(this);
        }
    } 
```

我的计划是否可以使用此代码划分 edmx 工作？我的案例的最佳做法是什么（我已阅读[http://blogs.msdn.com/b/adonet/archive/2008/11/24/working-with-large-models-in-entity-的两部分框架部分 1.aspx](http://blogs.msdn.com/b/adonet/archive/2008/11/24/working-with-large-models-in-entity-framework-part-1.aspx)）？

**编辑：**当尝试将 edmxs 的实体容器名称设置为 MyEntities 时，我得到：

```
EntityContainer name 'MyEntities' is already in use by another Entity Data Model in the project. 
```

有什么解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T11:45:34.797

诺尔，

您需要为此实体生成一个 poco 类它会自动创建 pococlasses 以在您创建的实体中单击鼠标右键，您可以在单击代码生成器时查看选项，您需要选择 E4 entitypocogenrator 它会自动创建对象上下文和 pococlass 这些类是我们需要分离的部分类。如果您无法找到 E4enitypocogenrater，您需要在此处安装它是安装 poco 类 fr Ado.entity 框架的链接 [http://visualstudiogallery.msdn.microsoft.com/23df0450-5677-4926-96cc-173d02752313/](http://visualstudiogallery.msdn.microsoft.com/23df0450-5677-4926-96cc-173d02752313/)

# mysql - 指数适用的地方

> ID：11165628
> 
> 赞同：1
> 
> 时间：2012-06-23T00:06:03.133
> 
> 标签：mysql, sql, indexing

在我对索引和语句运行的基本理解中`explain`，它们似乎只适用于`WHERE`and `ORDER BY`。是否有其他地方/实例在`SELECT`语句中应用索引？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-23T00:10:50.153

如果您只选择在 mysql 选择的索引中也使用的确切字段，则可以使用索引中的数据。

然而; 问我这个问题告诉我你错过了索引的基本点以及它们是如何工作的。阅读手册中的一两章以获得更清晰的理解可能是个好主意 - [http://dev.mysql.com/doc/refman/5.0/en/optimization-indexes.html](http://dev.mysql.com/doc/refman/5.0/en/optimization-indexes.html)。对您来说，它们主要用于实现 WHERE 和 ORDER BY 子句*应该是非常合乎逻辑的。*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-23T00:11:00.230

你忘了`JOINS`。以这样一种方式设计表已成为一种常见的做法，即它们将由 FOREIGN KEY 约束字段（它们被“自动”索引 - 至少在 MySQL 中）连接。但有时也会有例外——以后会狠狠地咬他们的创造者。)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-23T03:16:10.690

设计索引时，请遵循以下准则：对具有大量行的表、查询的 WHERE 子句或表连接中使用的列以及 ORDER BY 和 GROUP BY 查询中使用的列使用索引。

避免在经常更新的列上使用不经常使用的索引。此外，避免在频繁更新的表上拥有许多索引。否则，您会不必要地增加查询的插入和更新时间。

适当地使用聚集和非聚集索引。了解每个的目的并为您的方案选择正确的类型。

使用覆盖索引来减少常用语句的查询执行时间。覆盖索引是一个非聚集索引，它包含 WHERE 子句和查询列选择中的所有列。

[http://www.youtube.com/watch?v=ET0EIxRTTgM](http://www.youtube.com/watch?v=ET0EIxRTTgM)

# ruby-on-rails - 如何在rails模型中定义json方法来生成json？

> ID：11165633
> 
> 赞同：0
> 
> 时间：2012-06-23T00:07:08.407
> 
> 标签：ruby-on-rails, json, model

我的控制器中有这个相当长的 json 输出，我希望将它移动到模型中，因为这似乎是一个好习惯。首先，控制器方法：

```
def dashboard
  @line_items = LineItem.all

  respond_to do |format|
    format.json { render json: @line_items.as_json(include: {project: {include: {spec: {methods: [:dashboard_due_at]} },methods:[:company_name, :contacts_names, :owner_names] }}, methods:[:dashboard_created_at, :dashboard_length])}
  end
end 
```

我怎样才能将所有从 as_json 开始的东西移动到 LineItem 模型中，这样我就可以做到

```
format.json { render  json: @line_items.dashboard_json } 
```

谢谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T01:09:48.053

在您的 LineItem 模型中

```
def dashboard_json
  as_json(include: {project: {include: {spec: {methods: [:dashboard_due_at]} },
    methods:[:company_name, :contacts_names, :owner_names] }},
    methods:[:dashboard_created_at, :dashboard_length])
end 
```

# scala - Scala中的字符或字符串-> Unicode值？

> ID：11165635
> 
> 赞同：32
> 
> 时间：2012-06-23T00:07:56.153
> 
> 标签：scala, unicode

因此，我正在完成“不耐烦的 Scala”中的一些练习，其中之一是：

编写一个`for`循环来计算字符串中所有字母的 Unicode 代码的乘积。例如，“你好”中的字符的乘积是 9415087488 L。

下一个问题是做同样的事情，但没有`for`循环——它暗示我们应该检查`StringOps`Scaladoc。

我检查了Scaladoc 中的`RichChar`and`StringOps`部分，也许我误读或看错了地方，但我找不到任何可以让我匹配他们的输出的东西。到目前为止，我已经尝试过：

```
scala> x.foldLeft(1)(_ * _.toInt)
res0: Int = 825152896

scala> x.foldLeft(1)(_ * _.getNumericValue)
res5: Int = 2518992

scala> x.foldLeft(1)(_ * _.intValue())
res6: Int = 825152896

scala> var x = 1
x: Int = 1

scala> for (c <- "Hello") x *= c.toInt

scala> x
res12: Int = 825152896 
```

这与他们的输出不匹配。

我如何做到这一点，无论是方式`for`还是非`for`方式？

谢谢！

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-06-23T00:18:42.177

当您这样做`x.foldLeft(1)(_ * _.toInt)`时，结果类型将推断为 an `Int`，但 9415087488 太大而`Int`无法存储它。

所以你需要告诉 Scala using`Long`来存储它。

```
scala> val x = "Hello"
x: java.lang.String = Hello

scala> x.foldLeft(1L)(_ * _.toInt)
res1: Long = 9415087488

scala> var x: Long = 1
x: Long = 1

scala> for (c <- "Hello") x *= c.toInt

scala> x
res7: Long = 9415087488 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-03-19T18:56:27.627

如果您将 String .toLong 的每个 RichChar 转换，它也可以工作。例如，这个：

`str.map (_.toLong).product`- 工作正常，没有 foldLeft 或循环

这是循环变体：

```
def product(str: String): Long = {
    var prod: Long = 1
    for (ch <- str) prod *= ch
    prod
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-09-15T11:55:48.807

StringOps 中有一个特殊的“产品”方法，它可以将集合的元素相乘。但它使用 Char 类型，因为字符串由 char 元素组成。我们在尝试计算“Hello”.product 时出现溢出。因此，我通过“Hello”.map(_.toLong) 将字符串转换为 Long Unicode 值的向量，并通过以下代码计算其元素的乘积：

```
scala> "Hello".map(_.toLong).product
res79: Long = 9415087488 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-03-02T18:31:13.307

这是另一种方式：

```
scala> (for (c <- "Hello") yield c.toLong).product
res36: Long = 9415087488 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-04-08T02:34:25.420

我发现最直接的方法是：

```
"Hello".foldLeft(1L)((x:Long, y:Char) => x*y) 
```

该方法接受两个参数：一个 Long 和一个接受 Long 和 Char 并返回 Long 的委托函数。您可以像这样直接传递一个匿名函数，或者您可以在别处定义该函数并传递它，如下所示：

```
def multiply(x:Long, y:Char) = {
    x*y
}
"Hello".foldLeft(1L)(multiply) 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-02-09T14:01:55.980

我认为转换到中间映射效率低下，因为在这种情况下，集合被迭代两次：一次是创建 long 的映射，第二次是乘以所有元素。也不需要龙氏不必要的临时收集。我投票给

```
"Hello".foldLeft(1L)(_ * _) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-02-15T22:49:05.923

不使用 for 循环所需的练习，所以我已经递归了：

```
def unicode_rec(s: String): Int = 
  if(s == "") 1 
  else s.head.toInt * unicode_rec(s.tail) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-06-15T17:28:10.113

另一种变体：

```
"Hello".aggregate(1L)({(prod,ch) => prod * ch.toLong}, {(p1,p2)=>p1*p2}) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-02-16T11:42:46.843

所以在这里我们聚在一起:)

```
 // one way
    val longs = for (c <- str) yield c.toLong
    println(longs.product)

    // 2nd way
    println(str.foldLeft(1L)(_ * _.toInt))

    // 3rd way
    var x = 1L
    for (c <- str) yield x *= c.toInt
    println(x)

    // 4th way
    var product = 1L
    for (c <- str) {
      product *= c.toInt
    }
    println(product)

    // 5th way
    println(str.map(_.toLong).product)

    // 6th way
    println(str.foldLeft(1L)(_ * _))

    // 7th way
    println(str.map(_.toLong).reduceLeft(_ * _)) // my IDE warns `Replace reduce with product` 

    // 8th way
    println(str.map(_.toLong).scanLeft(1L)(_ * _).last)

    // 9th way
    println(str.map(_.toLong).reduce((x, y) => (x * y))) // my IDE warns `Replace reduce with product`

   // using recursion
   def exercise9(str: String): Long = {
    var product = str.head.toLong
    if (str.tail.length > 0) {
        product *= exercise9(str.tail)
    }
    product
  } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-03-02T05:08:54.303

在同一本书上也取得了进展。可能看起来有点像 java 风格，但它确实发挥了作用：

```
scala> "Hello".map( x => x.toLong).reduce( (a, b) => a * b)
val res45：长= 9415087488

```

# c# - 数据未显示在 Ajax 中自动完成在 ASp.net C#

> ID：11165637
> 
> 赞同：1
> 
> 时间：2012-06-23T00:08:06.517
> 
> 标签：c#, ajax

我有一个文本框，我已将 AJAX AutocompleteExtender 添加到此.. 代码如下.. 来自：

并且是我添加的 CS 文件文件

```
[System.Web.Services.WebMethodAttribute(), System.Web.Script.Services.ScriptMethodAttribute()]
    public static string[] GetCompletionList(string prefixText, int count, string contextKey)
    {
        string connString = ConfigurationManager.ConnectionStrings["Station"].ToString();

        string selectString = "SELECT *from Station";

        List<String> CustList = new List<string>(count);
        using (SqlConnection sqlConn = new SqlConnection(connString))
        {
            sqlConn.Open();

            using (SqlCommand sqlCmd = new SqlCommand(selectString, sqlConn))
            {
                SqlDataReader reader = sqlCmd.ExecuteReader();
                while (reader.Read())
                    CustList.Add(reader["DBRT"].ToString());//DBRT is the Column name

            }
        }
        return (CustList.ToArray());
    } 
```

当我执行代码并输入时，我输入时它没有显示任何内容。我的代码有什么问题..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T01:16:59.057

如果不使用网络服务，我会这样做。如果需要，您也可以使用 Web 服务。我没有返回字符串数组，而是返回通用列表。

在 Aspx 文件中

您可以根据自己的需要更改Ajax控件的标签Perfix，在我的系统中Ajax控件标签perfix从asp开始。

```
<asp:ScriptManager ID="ScriptManager1" runat="server"
EnablePageMethods = "true">
</asp:ScriptManager>

<asp:TextBox ID="StationSearchTxtBox" runat="server"></asp:TextBox>
<asp:AutoCompleteExtender ServiceMethod="GetCompletionList"
    MinimumPrefixLength="2"
    CompletionInterval="100" EnableCaching="false" CompletionSetCount="10"
    TargetControlID="StationSearchTxtBox"
    ID="AutoCompleteExtender1" runat="server" FirstRowSelected = "false">
</asp:AutoCompleteExtender> 
```

在 CS 文件中

```
[System.Web.Script.Services.ScriptMethod()]
[System.Web.Services.WebMethod]

public static List<string> GetCompletionList(string prefixText, int count)
    {

using (SqlConnection conn = new SqlConnection())
    {
       string connString =    ConfigurationManager.ConnectionStrings   ["Station"].ToString();

        using (SqlCommand cmd = new SqlCommand())
        {
            cmd.CommandText = "select StationName from Stations where " +
            "StationName like @SearchStation + '%'";
            cmd.Parameters.AddWithValue("@SearchStation", prefixText);
            cmd.Connection = conn;
            conn.Open();
            List<string> stations= new List<string>();
            using (SqlDataReader sdr = cmd.ExecuteReader())
            {
                while (sdr.Read())
                {
                    customers.Add(sdr["StationName"].ToString());
                }
            }
            conn.Close();
            return stations;
        }
    } 
```

完全希望这段代码能给你解决问题的方法。

# ios5 - tableView：commitEditingStyle：forRowAtIndexPath：不工作

> ID：11165648
> 
> 赞同：0
> 
> 时间：2012-06-23T00:09:25.333
> 
> 标签：ios5, nsmutablearray, tableview

因此，在我的 viewDidLoad 方法中，我调用了：

```
self.navigationItem.rightBarButtonItem = self.editButtonItem; 
```

然后稍后在我的 tableView:commitEditingStyle:forRowAtIndexPath: 我这样做：

```
- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath {

if (editingStyle == UITableViewCellEditingStyleDelete) {   
    [self.list removeObjectAtIndex:indexPath.row];
    [tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];
} 
```

}

但是，当我在 tableView 中删除一行时，在实际运行应用程序时，我在对列表的 removeObjectAtIndex 调用中抛出异常。我试着把它拿出来，但后来我在 tableView deleteRowsAtIndexPaths:withRowAnimation 上抛出了另一个异常：

请帮忙！提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T21:34:29.033

`self.list`需要是一个`NSMutableArray`.

# android - 您是否需要在 Android 中只向 SystemService 添加一次活动侦听器？还是在 resume() 上？

> ID：11165649
> 
> 赞同：0
> 
> 时间：2012-06-23T00:09:40.040
> 
> 标签：android, android-activity, android-service, activity-lifecycle, searchmanager

例如，在监听 SearchDialog 关闭的活动中，您在 onCreate() 中注册监听器：

```
android.app.SearchManager searchManager =     (android.app.SearchManager)getSystemService(Context.SEARCH_SERVICE);
    if (searchManager != null)
    {
       searchManager.setOnDismissListener(this);
    } 
```

我的问题是这将保持一个监听器还是我需要在说 resume() 中再次将它设置为监听器？或一个注册总是注册。我没有保留对 SearchManager 的本地引用。

还有我们为什么要这样做，是否有任何理由检查经理是否像这样为空，或者可以安全地假设您永远不会让空经理回来？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T00:20:34.393

1.  The listener will persist across the entire `Activity`'s lifecycle, so you should set the listener in `onCreate`. Setting the listener in `onResume` is redundant and unnecessary.

2.  The Android documentation states that `getSystemService` will return `null` only if the service name (in this case `Context.SEARCH_SERVICE`) does not exist. So as long as you are positive it exists, it won't return `null`.

# c# - 使用泛型在编译时强制执行有效结构

> ID：11165654
> 
> 赞同：6
> 
> 时间：2012-06-23T00:10:50.980
> 
> 标签：c#, generics, types

通过滥用 c# 中的类型系统，我可以创建代码，编译器将在其中强制执行规则，以确保不执行不可能的操作。在下面的代码中，它特定于矩阵乘法。

显然，下面的内容是完全不切实际/错误的，但是有什么原因我们将来不能在 c# 中使用这样的东西，我可以在其中定义像 Matrix<2,2> 这样的类型并让编译器确保安全？

此外，任何主流语言中都存在这样的东西吗？我怀疑在 C++ 中进行元编程可能会发生这样的事情？

```
public abstract class MatrixDimension { }

public class One : MatrixDimension { }
public class Two : MatrixDimension { }
public class Three : MatrixDimension { }

public class Matrix<TRow, TCol>
    where TRow : MatrixDimension
    where TCol : MatrixDimension
{

// matrix mult. rule. N×M * M×P  = N×P 
    public Matrix<TRow, T_RHSCol> Mult<T_RHSCol>(Matrix<TCol, T_RHSCol> rhs)
        where T_RHSCol : MatrixDimension
    { return null;}
}

public class TwoByTwo : Matrix<Two, Two> { }

public void Main()
{
    var twoByTwo = new Matrix<Two, Two>();
    var oneByTwo = new Matrix<One, Two>();
    var twoByThree = new Matrix<Two, Three>();
    var threeByTwo = new Matrix<Three, Two>();
    var _twoByTwo = new TwoByTwo();

    var _2x2 = twoByTwo.Mult(twoByTwo);
    var _1x2 = oneByTwo.Mult(twoByTwo);
    var _3x3 = twoByThree.Mult(threeByTwo);

    var _2x2_ = _twoByTwo.Mult(twoByTwo);

    var invalid = twoByThree.Mult(twoByThree); // compile fails, as expected
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T02:58:48.180

F# 支持语言中内置[的度量单位](http://msdn.microsoft.com/en-us/library/dd233243.aspx)——基本上是在 CLR 类型之上创建更丰富的类型系统，就像您开始使用泛型所做的那样。

构建更丰富的类型系统（我在自己的软件中使用它以确保核心模块的高可靠性和正确性）的另一种不同的，我认为是互补的方法是将编译器与*定理证明*器结合使用以保证满足方法和属性（以及类不变量）的前置和后置条件。

[这在SPARKAda](http://en.wikipedia.org/wiki/SPARK_%28programming_language%29)和Java等主流语言中是众所周知的[（通过 JML 扩展）](http://en.wikipedia.org/wiki/Java_Modeling_Language) - 由于 Microsoft Research 在[代码合同](http://research.microsoft.com/en-us/projects/contracts/)功能方面的工作，它也可用于 C#。（我正在大量使用。我强烈建议观看 MSR 页面上链接的视频，它们是开始使用这些工具的最佳方式。）

The *cccheck* static checker from MSR can run in the background of Visual Studio, and will give you error and informational messages along with (I think purple) squigglies in your code editor.

If you want to go down that route, check out the [Code Contracts MSDN forum](http://social.msdn.microsoft.com/Forums/en-US/codecontracts/threads) for support - that's where most users seem to hang out.

# matlab - Matlab fsolve优化终止

> ID：11165655
> 
> 赞同：1
> 
> 时间：2012-06-23T00:10:55.053
> 
> 标签：matlab, mathematical-optimization

我用 fsolve 解决了一个函数，但结果显示

优化终止：X 的相对变化范数小于 max(options.TolX^2,eps) 并且函数值的平方和小于 sqrt(options.TolFun)。

A = 0.3490

有谁知道如何解决这个问题？谢谢！

我的代码如下

```
clear

M=10000;
x0=0.35;
Z=randn(M,1);
A=fsolve(@(x)function_1_5_3(x,Z),x0)

function f=function_1_5_3(x,Z)

r0=.02;%interest rate
sigma=.15;%vatality rate of risky asset
mu0=.06;%drift rate of risky asset
gamma=5;%risk aversion rate
M=10000;%number of trajectories
N=55;%time period
T=55;%total time period
R=40;%time of retirement
dt=T/N;%each time period
t=1:dt:T;
omega=x;
Rf=exp(r0);%riskless reture
mat=rand(M,N);

Rs=exp(mu0+sigma*Z);%risky market return
a=20*mat(:,N-2);
a_1=20*mat(:,N-1);

W=((a.*(Rf+omega*(Rs-Rf))-a_1).^(-gamma)).*(Rs-Rf);%regard as function 4

f=mean(W); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T02:20:41.767

有问题吗？

执行优化时（即找到值 A 以使 function_1_5_3 变得非常小），您需要定义您认为好的解决方案。等待几天来修改参数`eps`以勉强解决解决方案的一点点改进是没有意义的。

有几种常见的启发式方法可以确定“足够好”的解决方案，例如，如果 x 值不再发生太大变化，或者函数值不再发生太大变化。使用 的`options`参数`fsolve`，它允许您使用 设置值`optimset`，您可以选择未知数 ( `options.TolX`) 中的容差，以及函数值 ( `options.TolFun`) 中的容差，即“足够小”的变化量可以考虑函数已经收敛。

在您的情况下，函数值的公差和 x 值的公差都满足优化。两者同时发生有点令人惊讶。如果结果不是最佳的，您应该检查是否应该修改容差，是否在公式中犯了错误，或者您是否`fminsearch`在编写时的意思`fsolve`。

# eclipse - 在 Xmonad 中浮动和调整 libGDX/lwjgl 应用程序的大小

> ID：11165656
> 
> 赞同：2
> 
> 时间：2012-06-23T00:10:55.893
> 
> 标签：eclipse, lwjgl, libgdx, xmonad

我最近改用 Xmonad 作为我的窗口管理器。

当我使用 Eclipse 运行我的 libGDX/lwjgl 应用程序时，它会由 Xmonad 自动平铺。这会在定位方面产生一些问题。

我试着跑步

```
xprop | grep WM_CLASS 
```

并单击应用程序。它没有显示任何名称。

如果有任何方法可以检测到这些 lwjgl 应用程序并将它们浮动，请告诉我。

谢谢你。

编辑：我发现，

```
className =? ""               --> doFloat 
```

会浮动窗口，但它仍然没有适当的大小（800x480），任何调整应用程序大小的提示将不胜感激。

# backbone.js - 过滤多个属性的主干集合

> ID：11165660
> 
> 赞同：4
> 
> 时间：2012-06-23T00:11:38.420
> 
> 标签：backbone.js

这是过滤多个属性的骨干集合的好方法吗：

```
filterData: function(params) {
    // store original data for clearing filters
    this.originalModels = this.models.slice();
    for (var key in params) {
        var val = params[key];
        // if we are dealing with multiple values in an array
        // i.e. ['ford','bmw','mazda']
        if (typeof val === "object") {
            var union = [];
            for (var k in val) {
                var subval = val[k];
                var matched = _.filter(this.models, function(house) {
                   return house.get(key) == subval; 
                });
                union = union.concat(matched);
            }
            this.models = union;
        } else {
           var results = _.filter(this.models, function(house) {
               return house.get(key) == val;
           });
           this.models = results;
        }
    } // end for
    return this.reset(this.models);
},
clearFilters: function() {
    return this.reset(this.originalModels);
} 
```

我对其进行了测试，它允许我以以下方式过滤集合：

```
filterParams = {brand:['ford','bmw','mazda'], color:black}

carCollection.filterData(filterParams); 
```

它似乎有效，但我不知道是否有更好的方法来做到这一点。

我测试了`Backbone.Collection.where()`方法，但如果我想说它不起作用`brand: ['bmw','mazda','ford']`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-23T17:05:50.253

你应该能够使用这样的东西：

```
filterData: function(params) {
    // store original data for clearing filters
    this.originalModels = this.models.slice();

    _.each(params, function(val, key){
        if (typeof val !== 'object') val = [ val ];
        this.models = _.filter(this.models, function(model){
            return _.indexOf(val, model.get(key)) !== -1;
        }, this);
    }, this);
    return this.reset(this.models);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-23T00:20:36.640

Backbone.js 集合可以访问许多 underscore.js 方法，包括 filter()。

```
carCollection.reset(carCollection.filter(function(car){
  return $.inArray(car.brand,['ford','bmw','mazda']) && car.color === 'black';
})); 
```

未经测试，但如果您使用 jQuery，那应该可以工作。如果没有，您可以创建自己的 inArray() 函数

# jquery - 如何在锚标签上执行点击事件

> ID：11165673
> 
> 赞同：2
> 
> 时间：2012-06-23T00:14:04.280
> 
> 标签：jquery, asp.net, html

我正在使用 c# 在 asp.net 上工作。我有一个带有 3 个锚标记链接和一个 html 标签的母版页。当用户单击特定链接时，它应重定向到特定页面，并且链接文本应显示在标签上。我使用了以下代码，

```
$(document).ready(function () {
            $('#div1 a').click(function () {
                if (focus == true)
                    $('#lblHeader').text("Home");
            });
            $('#blog').click(function () {
                if (focus == true)
                    $('#lblHeader').text("Blog");
            });
            $('#about').click(function () {
                if (focus == true)
                    $('#lblHeader').text("About");
            });
        }); 
```

请指导我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T00:19:14.770

如果您有标签服务器控件，则在回发发生之前使用 javascript 更改文本将无效，因为整个页面都被重绘。

**编辑**：我想我知道你想要做什么。为什么不在您的母版页中创建一个`contentplaceholder`，并在每个页面中设置它的值？

在您的母版页中：

```
<%@ Master Language="C#" %>
...
<asp:contentplaceholder id="PageLabel" runat="server" /> 
```

在每个内容页面中：

```
<asp:Content ID="Content1" ContentPlaceHolderID="PageLabel" Runat="Server" >
    Home <!--or about, or blog-->
</asp:content> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-23T00:18:31.447

如果我解决了您的问题，则标签位于母版页上，并且 $('#lblHeader') 未正确访问标签，可能是因为 asp.net 更改了母版页标签的 id - 试试这个：

```
 $(document).ready(function () {
        $('#div1 a').click(function () {
            if (focus == true)
                 $('[id$=lblHeader]').text("Home");
        });
        $('#blog').click(function () {
            if (focus == true)
                 $('[id$=lblHeader]').text("Blog");
        });
        $('#about').click(function () {
            if (focus == true)
                 $('[id$=lblHeader]').text("About");
        });
    }); 
```

或将该值存储在隐藏字段中，并在客户端页面的 document.ready 中将值分配给标签 - 使用我提供的 id

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-23T00:59:13.203

如果您希望用户在单击链接后看到某些内容，您需要阻止浏览器默认设置并为您想要的持续时间设置一个计时器。

这不会提供非常好的用户体验！

```
$('#div1 a, #blog, #about').click(function() {
    if (focus == true) {
        $('[id$=lblHeader]').text("Home");
        var href = this.href
        setTimeout(function() {
            window.location = href;
        }, 2000);
        return false;
    }

}); 
```

# jakarta-ee - 如何在 JBoss AS 7 中配置 2 个持久性提供程序

> ID：11165675
> 
> 赞同：2
> 
> 时间：2012-06-23T00:14:17.750
> 
> 标签：jakarta-ee, jpa, jboss, cassandra, kundera

我对 Java 和 Java EE 还是很陌生，我正在做一个项目，我想使用 2 个数据源（MySQL+Cassandra）实现 JPA（MySQL 的休眠和 Cassandra 的 Kundera）。我的 persistence.xml 如下：

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence xmlns="http://java.sun.com/xml/ns/persistence"
    version="2.0">
    <persistence-unit name="mysqlPU" transaction-type="JTA">
        <description>MySQL Persistent Unit</description>
        <jta-data-source>java:jboss/datasources/MySQLRemote</jta-data-source>
    <provider>org.hibernate.ejb.HibernatePersistence</provider>
    <class>com.eventit.entities.Event</class>
    <class>com.eventit.entities.Group_icon</class>
    <class>com.eventit.entities.Group</class>
    <class>com.eventit.entities.User</class> 
    </persistence-unit>
<persistence-unit name="cassandraPU">
    <provider>com.impetus.kundera.KunderaPersistence</provider>
    <properties>
        <property name="kundera.nodes" value="10.0.0.13" />
        <property name="kundera.port" value="9160" />
        <property name="kundera.keyspace" value="KunderaKeyspace" />
        <property name="kundera.dialect" value="cassandra" />
        <property name="kundera.client.lookup.class"
            value="com.impetus.client.cassandra.pelops.PelopsClientFactory" />
        <property name="kundera.cache.provider.class"
            value="com.impetus.kundera.cache.ehcache.EhCacheProvider" />
        <property name="kundera.cache.config.resource" value="/ehcache-test.xml" />
    </properties>
</persistence-unit> 
```

但是当我在 JBoss（AS 7.1）上部署我的项目时，我收到以下错误：

```
02:56:22,428 ERROR [org.jboss.msc.service.fail] (MSC service thread 1-6) MSC00001: Failed to start service jboss.deployment.unit."Event-it5.5.jar".INSTALL: org.jboss.msc.service.StartException in service jboss.deployment.unit."Event-it5.5.jar".INSTALL: Failed to process phase INSTALL of deployment "Event-it5.5.jar"
at org.jboss.as.server.deployment.DeploymentUnitPhaseService.start(DeploymentUnitPhaseService.java:119) [jboss-as-server-7.1.1.Final.jar:7.1.1.Final]
at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1811) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]
at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1746) [jboss-msc-1.0.2.GA.jar:1.0.2.GA]
at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110) [rt.jar:1.7.0_04]
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603) [rt.jar:1.7.0_04]
at java.lang.Thread.run(Thread.java:722) [rt.jar:1.7.0_04]
Caused by: javax.persistence.PersistenceException: JBAS011466: PersistenceProvider 'com.impetus.kundera.KunderaPersistence' not found
at org.jboss.as.jpa.processor.PersistenceUnitDeploymentProcessor.lookupProvider(PersistenceUnitDeploymentProcessor.java:555)
at org.jboss.as.jpa.processor.PersistenceUnitDeploymentProcessor.deployPersistenceUnit(PersistenceUnitDeploymentProcessor.java:295)
at org.jboss.as.jpa.processor.PersistenceUnitDeploymentProcessor.addPuService(PersistenceUnitDeploymentProcessor.java:258)
at org.jboss.as.jpa.processor.PersistenceUnitDeploymentProcessor.handleJarDeployment(PersistenceUnitDeploymentProcessor.java:145)
at org.jboss.as.jpa.processor.PersistenceUnitDeploymentProcessor.deploy(PersistenceUnitDeploymentProcessor.java:120)
at org.jboss.as.server.deployment.DeploymentUnitPhaseService.start(DeploymentUnitPhaseService.java:113) [jboss-as-server-7.1.1.Final.jar:7.1.1.Final]
... 5 more 
```

mysqlPU 工作得很好，但是当我添加 cassandraPU 时，我得到了例外。我很确定我正在将具有依赖关系的 kundera.jar 正确部署到 jboss，因为我可以`http://127.0.0.1:9990/console/App.html#deployments` 提前在Thanks 中看到 jar，并希望我已经提供了所有必要的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T19:14:40.587

希望这可以帮助。

[https://groups.google.com/forum/#!msg/kundera-discuss/3-iUJQOShvE/kJihv32IbjYJ](https://groups.google.com/forum/#!msg/kundera-discuss/3-iUJQOShvE/kJihv32IbjYJ)

看一看。

-维维克

# c++ - MS ADO DLL 没有正确安装？

> ID：11165683
> 
> 赞同：0
> 
> 时间：2012-06-23T00:15:06.323
> 
> 标签：c++, visual-c++, ado, visual-studio-2010

我只是想在 MSVC 2010 Express 中安装开始弄乱 ADO 所需的一切，只是为了了解更多关于它的信息，我最终可能会使用我在工作中学到的一些东西。

我从 MSDN 读到我需要安装 MDAC，所以我去这里获取了最新版本：http: [//www.microsoft.com/en-us/download/details.aspx?id=5793](http://www.microsoft.com/en-us/download/details.aspx?id=5793)

根据我在网上阅读的内容，我需要使用带有我的 MS ADO DLL 名称的#import 预编译器指令（“msado15.dll”被提及）在 MSVC 中初始化 ADO，但似乎即使在安装 MDAC 之后我也这样做了没有这个DLL。我做错了什么？

如果这很重要，我正在使用 Windows 7 64。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-23T00:24:30.647

“ADO”是旧的 COM/ActiveX“数据对象”组件。

更新/更大/更明亮的对象模型是“ADO.Net”，用于 C# 和 VB.Net。

您引用的链接显然是指旧的 ADO：

> [http://www.microsoft.com/en-us/download/details.aspx?id=5793](http://www.microsoft.com/en-us/download/details.aspx?id=5793)
> 
> 支持的操作系统：Windows 2000、Windows 98、Windows ME、Windows NT

呜呜呜：

1）从这个链接开始：

*   [http://msdn.microsoft.com/en-us/library/9ctka9db.aspx](http://msdn.microsoft.com/en-us/library/9ctka9db.aspx)

2)拥有 Windows 7 (Pro?) 并安装了 MSVS 2010 Express，您*应该拥有所需的一切。*

3) 这是在托管 C++ 中使用 ADO.Net 的一个很好的例子：

*   [http://www.codeproject.com/Articles/1078/Using-ADO-NET-in-a-managed-C-application](http://www.codeproject.com/Articles/1078/Using-ADO-NET-in-a-managed-C-application)

'希望有帮助！

# android - 带有预加载数据库的光标给出空指针异常android

> ID：11165686
> 
> 赞同：0
> 
> 时间：2012-06-23T00:16:26.377
> 
> 标签：android, database, listview, cursor, nullpointerexception

这是类 Db.java

```
package calc.three;

import java.io.IOException;

import android.app.Activity;
import android.app.ListActivity;
import android.content.ContentValues;
import android.content.DialogInterface;
import android.content.DialogInterface.OnClickListener;
import android.database.Cursor;
import android.database.SQLException;
import android.os.Bundle;
import android.view.View;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.ListAdapter;
import android.widget.ListView;
import android.widget.SimpleCursorAdapter;
import android.widget.TextView;
import android.widget.Toast;
import android.database.sqlite.SQLiteDatabase;
import android.widget.AdapterView;
import android.content.Context;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteDatabase.CursorFactory;
import android.database.sqlite.SQLiteOpenHelper;

public class Db extends ListActivity {
private SQLiteDatabase newDb;
DataBaseHelper myDbHelper = new DataBaseHelper(this);
public ListAdapter adapter;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
setContentView(R.layout.main);
    openDatabase();

    Cursor c = newDb.rawQuery("SELECT _id, organisation FROM shoplist", null);
    adapter = new SimpleCursorAdapter(this, R.layout.main, c, new String[] { "organisation" },  new int[] { android.R.id.list });
    setListAdapter(adapter);
    //inserttodata();
    myDbHelper.close();
}

private long inserttodata() {
    // TODO Auto-generated method stub
    ContentValues cv = new ContentValues();
    cv.put("id", "112");
    cv.put("organisation","test" );
     return newDb.insert("shoplist", null, cv);
}

private void openDatabase() {

    try {

        myDbHelper.createDataBase();

    } catch (IOException ioe) {

        throw new Error("Unable to create database");

    }

    try {

        myDbHelper.openDataBase();

    } catch (SQLException sqle) {
System.out.println("failed to open");
        throw sqle;

    }
    //String[] columns= new String[]{"_id", "Organisation"};
    //cursor = newDb.query("Shop", columns, null, null, null, null, null);

}

} 
```

这是 DataBaseHelper 类

```
package calc.three;

import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;

import android.content.Context;
import android.database.SQLException;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteException;
import android.database.sqlite.SQLiteOpenHelper;

public class DataBaseHelper extends SQLiteOpenHelper{

//The Android's default system path of your application database.
private static String DB_PATH = "/data/data/calc.three/databases/";

private static String DB_NAME = "charity.db";

private SQLiteDatabase myDataBase; 

private final Context myContext;

/**
 * Constructor
 * Takes and keeps a reference of the passed context in order to access to the application assets and resources.
 * @param context
 */
public DataBaseHelper(Context context) {

    super(context, DB_NAME, null, 1);
    this.myContext = context;
}   

  /**
     * Creates a empty database on the system and rewrites it with your own database.
     * */
    public void createDataBase() throws IOException{

    boolean dbExist = checkDataBase();

    if(dbExist){
        //do nothing - database already exist
    }else{

        //By calling this method and empty database will be created into the default system path
           //of your application so we are gonna be able to overwrite that database with our database.
        this.getReadableDatabase();

        try {

            copyDataBase();

        } catch (IOException e) {

            throw new Error("Error copying database");

        }
    }

}

/**
 * Check if the database already exist to avoid re-copying the file each time you open the application.
 * @return true if it exists, false if it doesn't
 */
private boolean checkDataBase(){

    SQLiteDatabase checkDB = null;

    try{
        String myPath = DB_PATH + DB_NAME;
        checkDB = SQLiteDatabase.openDatabase(myPath, null, SQLiteDatabase.OPEN_READONLY);

    }catch(SQLiteException e){

        //database does't exist yet.

    }

    if(checkDB != null){

        checkDB.close();

    }

    return checkDB != null ? true : false;
}

/**
 * Copies your database from your local assets-folder to the just created empty database in the
 * system folder, from where it can be accessed and handled.
 * This is done by transfering bytestream.
 * */
private void copyDataBase() throws IOException{

    //Open your local db as the input stream
    InputStream myInput = myContext.getAssets().open(DB_NAME);

    // Path to the just created empty db
    String outFileName = DB_PATH + DB_NAME;

    //Open the empty db as the output stream
    OutputStream myOutput = new FileOutputStream(outFileName);

    //transfer bytes from the inputfile to the outputfile
    byte[] buffer = new byte[2048];
    int length;
    while ((length = myInput.read(buffer))>0){
        myOutput.write(buffer, 0, length);
    }

    //Close the streams
    myOutput.flush();
    myOutput.close();
    myInput.close();

}

public void openDataBase() throws SQLException{

    //Open the database
    String myPath = DB_PATH + DB_NAME;
    SQLiteDatabase.CursorFactory c = null;
    myDataBase = SQLiteDatabase.openDatabase(myPath, c , SQLiteDatabase.OPEN_READWRITE);

}

@Override
public synchronized void close() {

        if(myDataBase != null)
            myDataBase.close();

        super.close();

}

@Override
public void onCreate(SQLiteDatabase db) {

}

@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {

}

    // Add your public helper methods to access and get content from the database.
   // You could return cursors by doing "return myDataBase.query(....)" so it'd be easy
   // to you to create adapters for your views.

} 
```

XML 布局

```
 <?xml version="1.0" encoding="utf-8"?>
  <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

<ListView
    android:id="@android:id/list"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:padding="3dip" >
</ListView>

  </LinearLayout> 
```

我不想在这里做太多事情。我在资产文件夹中发送了一个 .db 文件，并成功复制了它......创建副本后，我在 sqlite 浏览器中从 data/data/calc.three/database 打开了 .db 文件，我在那里有表格.

但我似乎无法运行它强制关闭的应用程序，并在将 rawQuery 传递给光标的行给了我一个 nullPointerException 我在没有该行的情况下运行程序并且没有错误，但我无法在列表视图中显示数据。请帮助我过去 3 天一直坚持这个问题。

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T00:43:18.873

你还没有设置`newDb`……你声明了它，但是当你尝试使用它时它仍然是空的，给你错误。

# javascript - jquery - 根据当前高度与限制切换 div 高度

> ID：11165687
> 
> 赞同：0
> 
> 时间：2012-06-23T00:16:54.193
> 
> 标签：javascript, jquery

jsfiddle 在这里：http: [//jsfiddle.net/M86nA/](http://jsfiddle.net/M86nA/)

代码是这样的：

```
$('div.wrap').click(function(){
   var $minY = $('div.imgur-wrap').height();
   if ($minY = 280) {
      $('div.wrap').animate({height: 500});
   }else{
      $('div.wrap').animate({height: 280});
   }
});​ 
```

我想这是因为它在执行 if 时确实有新的高度（500）？我怎样才能做到这一点？

谢谢！

编辑：用“==”替换“=”并在选择器中删除“imgur”修复它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-23T00:20:32.413

You could use [jQuery `.toggle()`](http://api.jquery.com/toggle-event/) like [in this example](http://jsfiddle.net/M86nA/1/)

```
$('div.wrap').toggle(function() {
    $(this).animate({
        height: 500
    });
}, function() {
    $('div.wrap').animate({
        height: 280
    });
});​ 
```

jQuery will "toggle" between the functions provided in `.toggle()`, one after the other and back. Since 280px is the initial state, we fire the height 500 first, then the 280 and back again.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-23T00:26:33.160

Using your current code, fix the class reference and `=` to `==`.

Change

```
var $minY = $('div.imgur-wrap').height(); 
```

To

```
var $minY = $('div.wrap').height(); 
```

Complete code for reference:

```
$('div.wrap').click(function() {
    var $minY = $('div.wrap').height();
    if ($minY == 280) {
        $('div.wrap').animate({
            height: 500
        });
    } else {
        $('div.wrap').animate({
            height: 280
        });
    }
});​ 
```

See [**DEMO**](http://jsfiddle.net/FranWahl/ACE4J/1/)

# python - 用于列表和子列表的 Python 算法

> ID：11165688
> 
> 赞同：0
> 
> 时间：2012-06-23T00:17:11.970
> 
> 标签：python, algorithm

我有许多可以“打开”或“关闭”的列表，如下所示：

```
lista = ["a", "b", "c"]
listb = ["d", "e"]
listc = ["a", "b", "e"]
listd = ["c", "d"] 
```

我有一个所有未清项目的主清单：

```
all_open = ["a", "b", "c", "e"] 
```

和一个开放列表：

```
open_lists = ["lista", "listc"] 
```

由于子列表是开放式的，它们的项目被添加到主列表中：

```
open_lists.append("listb")
for each i in listb:
    if !(i in all_open):
        all_open.append(i) 
```

当子列表关闭时，是否有一种简单的算法可以从主列表中删除项目？目标是不删除属于仍然打开的其他列表的项目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T00:24:37.573

You have to keep track of how many lists each item was from. The simplest way to do that is with a map. I like to use `collections.Counter` for something like this.

```
import collections
count = collections.Counter()

# add a list
for i in listb:
    if count[i] == 0:
        all_open.append(i)
    count[i] += 1

# delete a list
for i in listb:
    count[i] -= 1
    if count[i] == 0:
        all_open.remove(i) 
```

In addition, you can get rid of `all_open` altogether and use the `count.keys()` iterator instead.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T00:25:48.567

Something like

```
all_items = []
for l in open_lists:
    for item in l:
       if item not in all_items:
           all_items.append(item)

all_open = [item for item in all_open if item not in all_items] 
```

I believe this will results in what you desire although I'm not too clear if that's what you are asking for. You could also keep track of how many times each item is open, and when you close a list, decrease that by 1\. If the value is 0, then remove an item. Might be a lot more efficient than this.

# function - 奇怪的编译器错误：找到单元，我尝试返回一个 Double

> ID：11165689
> 
> 赞同：2
> 
> 时间：2012-06-23T00:17:19.033
> 
> 标签：function, scala, recursion

我的代码：

```
def power(x: Double, n: Int): Double = {
  if (n % 2 == 0 && n > 0) power(power(x, n/2), 2)
  else if (n % 2 == 1 && n > 0) x * power(x, n - 1)
  else if (n == 0) 1
  else if (n < 0) 1 / power(x, -n)
}

println(power(2, 2)) 
```

终端：

```
$ scala ch2ex10.scala 
/scala/impatient/ch2ex10.scala:5: error: type mismatch;
 found   : Unit
 required: Double
  else if (n < 0) 1 / power(x, -n) 
```

这是`Unit`从哪里来的？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-23T01:30:37.120

它来自块中的最后一个“else if”。

看起来并不是所有的可能性都用尽了。如果没有其他可能性（这里恰好是这种情况），只需写

```
 else 1 / power(x, -n) 
```

如果另一种可能性是开放的，你需要写

```
 else if (n < 0) 1 / power(x, -n)
 else ... 
```

并填写点。否则编译器假定

```
 else {} 
```

为你。

# php - 是否可以在 mysql 中为表设置过期日期/时间？

> ID：11165696
> 
> 赞同：1
> 
> 时间：2012-06-23T00:18:45.050
> 
> 标签：php, mysql

我想知道在mysql中创建表时是否可以设置“过期”时间或日期。

例如，创建了一个表并将在 2 小时内过期/自动删除。有这样的效果。谷歌没有给出任何答案，所以它可能不像我希望的那么简单。

需要：我正在制作一个具有购物车功能的网站。如果用户未登录，他们可以将商品添加到购物车。此信息存储在一个临时表中，一旦他们登录，该表将被迁移到特定的用户表或订单。好吧，我试图找到一种方法来删除临时表，如果说用户从未登录或完成订单，然后永久离开网站。这样我就不会以一堆临时表把事情弄得乱七八糟。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-23T00:29:08.893

你这样做是不对的！当您动态更改架构时，这几乎总是一个错误。您应该添加和删除行，而不是表。

将您的所有订单放在同一张表中，并为其添加时间戳。您可以有一个带有订单状态的字段并使用 删除未完成的订单`DELETE ... WHERE status='not completed' AND timefield < DATE_SUB(NOW(), INTERVAL 2 HOUR)`，或者您可以将临时订单放在另一个表中，而不是已完成的订单，但所有临时订单都应该放在*同一个*表中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T00:30:51.813

> 问：我想知道在 mysql 中创建表时是否可以设置“过期”时间或日期。

答：设置“添加”时间或日期很容易，然后运行批处理作业来查询任何/所有早于“过期”时间的项目并采取适当的措施。也许删除。也许电子邮件提醒。也许生成一份报告并删除 - 无论如何。

# xml-serialization - 文件过早结束。试图从 Zipinputstream 解析 xml 的异常

> ID：11165697
> 
> 赞同：0
> 
> 时间：2012-06-23T00:18:58.257
> 
> 标签：xml-serialization, xml-parsing, xstream, zipoutputstream

我正在尝试从 ZipInputStream 中提取 xml 文件和其他内容，并从解析 zipinputstream 的 xml 创建我的对象。但是，当我没有 while 循环读取 inputStream 时，我得到了文件提前结束异常 - 对于以下代码或 Stream Closed。据我了解， ZipInputStream.getNextEntry 获取下一个条目输入流。

另外 - 当我通过创建一个实际的临时文件并传递输入流（如注释代码中）来运行它时 - 它处理得很好 - 但在我的情况下，我将无法写入磁盘 - 所以这一切都必须发生在-记忆。有人能告诉我我的代码哪里出错了，我能做些什么来修复它？

```
ZipEntry entry; 
Map<String, byte[]> otherElements = new HashMap<String, byte[]>();
        entry =((ZipInputStream)inputStream).getNextEntry();
        while (entry != null) {
            logger.debug("entry: " + entry.getName() + ", " + entry.getSize());
            System.out.println(entry.getName() + " - " + entry.getSize());

            if (entry.getName().equalsIgnoreCase("Document.xml")) {
                /*File file = new File("C:\\tmp.xml");
                FileOutputStream fos = new FileOutputStream();
                int read = 0;
                byte[] bytes = new byte[1024];

                while ((read = inputStream.read(bytes)) != -1) {
                    fos.write(bytes, 0, read);
                }
                InputStream fis = new FileInputStream();*/

                while(inputStream.available()>0){
                    inputStream.read();
                }

                myOutput = buildMyOutput((ZipInputStream)inputStream);
                //fos.close();
                //fis.close(); 
```

* * *

```
// method that takes the input and creates the java object
private MyObject buildMyOutput(InputStream xmlStream) throws Exception {

    // build my objects
    XStream xstream = ConvertUtil.getXStream();
    xstream.processAnnotations(MyObject.class);
    MyObject myOutput = (MyObject) xstream.fromXML(xmlStream);
    return myOutput;
} 
```

* * *

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-26T23:10:21.913

找出问题所在：XStream 丢失了编码信息并将其设置为 null [JIRA link on codehaus][1]https://jira.codehaus.org/browse/XSTR-441

因此，基于此输入，我将输入流复制为 UTF-8，然后使用 UTF-8 编码格式调用 buildMyOutput 方法。删除了以下代码段 -

```
 while(inputStream.available()>0){
         inputStream.read();
 } 
```

并将 buildMyOutput 调用更改如下

```
String xml = IOUtils.toString(zipInputStream, "UTF-8");
    InputStream documentXmlIS = IOUtils.toInputStream(xml);
    map = buildMyOutput(documentXmlIS); 
```

# windows - PDCurses Win32a——如何在 Windows 7 上构建

> ID：11165699
> 
> 赞同：2
> 
> 时间：2012-06-23T00:19:42.363
> 
> 标签：windows, windows-7, console-application, curses, pdcurses

[PDCurses-Win32a](http://www.projectpluto.com/win32a.htm)非常清楚地声称它的 init_color() 实现适用于 Windows；但是当我在 Visual Studio 项目中将它构建为 DLL 时（在 nmake 失败后，说它找不到名为“rc”的东西），它没有。我需要做些什么来完成这项工作——以一种还可以显示 IBM 扩展 ASCII（代码页 437）字符的方式？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-24T09:31:34.363

这需要与 Visual Studio 一起提供的 nmake。在 nmake 的目录中有一个批处理文件 vcvars32.bat（在我的例子中是 C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\bin）；从 PDC Win32a 子目录运行它，然后运行 ​​nmake -f vcwin32.mak UTF8=1 pdcurses.lib 。

其他一切都可以开箱即用（如果编译为 UTF-8 或 UCS-2，并为旧的 CP437 字符使用 Unicode 代码点），但这种实现仅限于 Courier 字体——最好使用 SDL 版本标准 pdcurses。

# java - ActionBarSherlock 库导入后报错

> ID：11165700
> 
> 赞同：19
> 
> 时间：2012-06-23T00:20:02.477
> 
> 标签：java, android, actionbarsherlock, android-actionbar

好的，我正在尝试让 ActionBarSherlock 工作，所以我通过以下方式导入了库：

```
Creating New Project > Create Project From Existing Source > Choosing library from the ActionBarSherlock folder 
```

之后，我使用相同的方法从示例文件夹中导入了一个示例项目，库和示例都设置为 Android 15 Build Path！

我的问题是，库中出现了 100 多个错误，关于 Call 的各种东西都需要 api 级别 11，而我不知道出了什么问题！

我尝试过的事情：
清理项目
将构建路径设置为 13、14 和 15

大多数错误说：

```
Call requires API level 11 (current min is 8): android.app.something 
```

更新：我尝试右键单击 lib 文件并单击添加到构建路径，但没有成功，这些是我遇到的一些错误：

```
Description Resource    Path    Location    Type
The method add(CharSequence) of type MenuWrapper must override a superclass method  MenuWrapper.java    /com_actionbarsherlock/src/com/actionbarsherlock/internal/view/menu line 33 Java Problem
The method add(int, int, int, CharSequence) of type MenuWrapper must override a superclass method   MenuWrapper.java    /com_actionbarsherlock/src/com/actionbarsherlock/internal/view/menu line 43 Java Problem
The method add(int, int, int, int) of type MenuWrapper must override a superclass method    MenuWrapper.java    /com_actionbarsherlock/src/com/actionbarsherlock/internal/view/menu line 48 Java Problem
The method add(int) of type MenuWrapper must override a superclass method   MenuWrapper.java    /com_actionbarsherlock/src/com/actionbarsherlock/internal/view/menu line 38 Java Problem
The method addIntentOptions(int, int, int, ComponentName, Intent[], Intent, int, MenuItem[]) of type MenuWrapper must override a superclass method  MenuWrapper.java    /com_actionbarsherlock/src/com/actionbarsherlock/internal/view/menu line 81 Java Problem
The method addOnAttachStateChangeListener(View_OnAttachStateChangeListener) of type ActionMenuItemView must override a superclass method    ActionMenuItemView.java /com_actionbarsherlock/src/com/actionbarsherlock/internal/view/menu line 84 Java Problem
The method addOnAttachStateChangeListener(View_OnAttachStateChangeListener) of type ActionMenuPresenter.OverflowMenuButton must override a superclass method    ActionMenuPresenter.java    /com_actionbarsherlock/src/com/actionbarsherlock/internal/view/menu line 627    Java Problem
The method addSubMenu(CharSequence) of type MenuWrapper must override a superclass method   MenuWrapper.java    /com_actionbarsherlock/src/com/actionbarsherlock/internal/view/menu line 61 Java Problem
The method addSubMenu(int, int, int, CharSequence) of type MenuWrapper must override a superclass method    MenuWrapper.java    /com_actionbarsherlock/src/com/actionbarsherlock/internal/view/menu line 71 Java Problem
The method addSubMenu(int, int, int, int) of type MenuWrapper must override a superclass method MenuWrapper.java    /com_actionbarsherlock/src/com/actionbarsherlock/internal/view/menu line 76 Java Problem
The method addSubMenu(int) of type MenuWrapper must override a superclass method    MenuWrapper.java    /com_actionbarsherlock/src/com/actionbarsherlock/internal/view/menu line 66 Java Problem
The method clear() of type MenuWrapper must override a superclass method    MenuWrapper.java    /com_actionbarsherlock/src/com/actionbarsherlock/internal/view/menu line 101    Java Problem
The method clearHeader() of type SubMenuWrapper must override a superclass method   SubMenuWrapper.java /com_actionbarsherlock/src/com/actionbarsherlock/internal/view/menu line 49 Java Problem
The method close() of type MenuWrapper must override a superclass method    MenuWrapper.java    /com_actionbarsherlock/src/com/actionbarsherlock/internal/view/menu line 157    Java Problem
The method collapseActionView() of type ActionMenuItem must override a superclass method    ActionMenuItem.java /com_actionbarsherlock/src/com/actionbarsherlock/internal/view/menu line 264    Java Problem
The method collapseActionView() of type MenuItemImpl must override a superclass method  MenuItemImpl.java   /com_actionbarsherlock/src/com/actionbarsherlock/internal/view/menu line 612    Java Problem
The method collapseActionView() of type MenuItemWrapper must override a superclass method   MenuItemWrapper.java    /com_actionbarsherlock/src/com/actionbarsherlock/internal/view/menu line 254    Java Problem
The method collapseItemActionView(MenuBuilder, MenuItemImpl) of type ActionBarView.ExpandedActionViewMenuPresenter must override a superclass method    ActionBarView.java  /com_actionbarsherlock/src/com/actionbarsherlock/internal/widget    line 1497   Java Problem
The method describeContents() of type ActionMenuPresenter.SavedState must override a superclass method  ActionMenuPresenter.java    /com_actionbarsherlock/src/com/actionbarsherlock/internal/view/menu line 557    Java Problem
The method expandActionView() of type ActionMenuItem must override a superclass method  ActionMenuItem.java /com_actionbarsherlock/src/com/actionbarsherlock/internal/view/menu line 259    Java Problem
The method expandActionView() of type MenuItemImpl must override a superclass method    MenuItemImpl.java   /com_actionbarsherlock/src/com/actionbarsherlock/internal/view/menu line 598    Java Problem
The method expandActionView() of type MenuItemWrapper must override a superclass method MenuItemWrapper.java    /com_actionbarsherlock/src/com/actionbarsherlock/internal/view/menu line 249    Java Problem
The method expandItemActionView(MenuBuilder, MenuItemImpl) of type ActionBarView.ExpandedActionViewMenuPresenter must override a superclass method  ActionBarView.java  /com_actionbarsherlock/src/com/actionbarsherlock/internal/widget    line 1471   Java Problem
The method findItem(int) of type MenuWrapper must override a superclass method  MenuWrapper.java    /com_actionbarsherlock/src/com/actionbarsherlock/internal/view/menu line 127    Java Problem
The method flagActionItems() of type ActionBarView.ExpandedActionViewMenuPresenter must override a superclass method    ActionBarView.java  /com_actionbarsherlock/src/com/actionbarsherlock/internal/widget    line 1466   Java Problem
The method flagActionItems() of type MenuPopupHelper must override a superclass method  MenuPopupHelper.java    /com_actionbarsherlock/src/com/actionbarsherlock/internal/view/menu line 280    Java Problem
The method getActionProvider() of type ActionMenuItem must override a superclass method ActionMenuItem.java /com_actionbarsherlock/src/com/actionbarsherlock/internal/view/menu line 243    Java Problem
The method getActionProvider() of type MenuItemWrapper must override a superclass method    MenuItemWrapper.java    /com_actionbarsherlock/src/com/actionbarsherlock/internal/view/menu line 240    Java Problem
The method getActionView() of type MenuItemWrapper must override a superclass method    MenuItemWrapper.java    /com_actionbarsherlock/src/com/actionbarsherlock/internal/view/menu line 229    Java Problem
The method getAlphabeticShortcut() of type MenuItemWrapper must override a superclass method    MenuItemWrapper.java    /com_actionbarsherlock/src/com/actionbarsherlock/internal/view/menu line 123    Java Problem 
```

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-06-23T00:38:07.773

*   转到项目属性 > Java 编译器。使用 JDK 1.6。
*   确保您使用 Android 4.0+ 编译库和应用程序
*   确保您的 targetSdkVersion 为 14 或更高。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-23T00:34:08.880

1.  在项目资源管理器中，找到目录`android-support-v4.jar`中的`libs`文件。右键单击此文件并将其添加到您的构建路径：

    `Build path`-->`Add to build path`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-25T18:57:16.987

验证新的库清单包是“com.actionbarsherlock”

（也许这只是我，但我在已经提取库文件夹的地方创建了项目。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-23T16:27:40.717

右键单击，选择属性，java构建路径，库选项卡，单击添加库...并添加JRE系统库1.6

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-02T03:47:15.373

右键单击，选择 Properties，Java Build Path，Libraries 选项卡；单击“添加库”并添加“JRE System Library 1.6”。

确认修改，然后删除您稍后添加的 JRE 系统库。

# javascript - 通过内联数据属性传递 Javascript 函数

> ID：11165707
> 
> 赞同：10
> 
> 时间：2012-06-23T00:20:54.360
> 
> 标签：javascript, html, function, attributes, callback

我正在使用 Javascript 文件上传库，它的功能之一是它使用 HTML5 内联数据属性将信息传递给插件。

这对于任何与数据相关的数据、字符串、数字等都非常有用，但是该插件有一些回调方法，您可以为其分配函数。我的问题是，当尝试通过这些内联数据属性传递 javascript 函数时，如下所示：

```
<input type="file" name="test" data-on-finish="alert();"> 
```

该插件很好地获取了对 onFinish() 回调方法的引用，但是当它尝试执行我放在那里的任何 javascript 时，我得到了错误：

```
Uncaught TypeError: Object alert(); has no method 'call' 
```

我假设它正在读取`alert();`字符串。知道如何将可执行的 javascript 传递给插件吗？

我相信我使用的插件是 jQuery 文件上传插件的扩展： [https ://github.com/blueimp/jQuery-File-Upload/wiki/Options](https://github.com/blueimp/jQuery-File-Upload/wiki/Options)

**更新：** 我也尝试过使用全局定义的函数，如下所示：

```
<script type="text/javascript">
    function myTesting(){
       alert('yay');
    }
</script>
<input type="file" name="test" data-on-finish="myTesting"> 
```

我已经尝试将`data-on-finish`属性更改为`myTesting`, `myTesting()`，仍然没有运气...

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-23T00:26:42.987

为什么不放置回调的名称呢？就像是

```
//for example, a global function
window['someFunctionName'].call();

//a namespaced function
//similar to doing ns.someFunctionName()
ns['someFunctionName'].call(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T00:30:15.473

看起来它正在尝试回调函数，例如 myfunction.call(

尝试传递是这样的函数。

```
<input type="file" name="test" data-on-finish="myFunction;">

function myFunction(){
 alert('I am alerting');
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-24T04:51:05.443

使用这样的东西：

```
$(function() {
  function test() {
    alert("ok");
  }

  $(".test").data("test", test);
  $(".test").data("test")();
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
<div class="test">
</div>
```

# ruby - construct file tree from path components

> ID：11165709
> 
> 赞同：0
> 
> 时间：2012-06-23T00:21:07.040
> 
> 标签：ruby, ruby-on-rails-3

I have an array of file path components like this:

```
[ ['some', 'dir', 'file.txt'],
  ['other', 'folder', 'here.txt'],
  ['this', 'one', 'is', 'deeper', 'file.txt'],
  ['some', 'dir', 'second.txt'
] 
```

So the array contains arrays each consisting of path components to a file. The last element in an inner array is always the file itself, with the preceding elements being directories leading to the file.

What I'm trying to figure out is how to transform the above data so that I can easily generate a file tree with it using `<ul>` and `<li>` tags such that folders are nested within each other and files within the same folder show up together. All sorted alphabetically.

From the above I would like to generate the following. The file `<li>` themselves have to be links to the path to that file:

```
<ul>
  <li>some/
    <ul>
      <li>dir/
        <ul>
          <li><a href="some/dir/file.txt">file.txt</a></li>
          <li><a href="some/dir/second.txt">second.txt</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li>other/
    <ul>
      <li>folder/
        <ul>
          <li><a href="other/folder/here.txt">here.txt<a/></li>
        </ul>
      </li>
    </ul>
  </li>
  <li>this/
    <ul>
      <li>one/
        <ul>
          <li>is/
            <ul>
              <li>deeper/
                <ul>
                  <li><a href="this/one/is/deeper/file.txt">file.txt</a></li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul> 
```

Thanks, I'd appreciate any ideas.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T01:03:11.203

粗略的轮廓；尽可能简单（即，没有任何技巧可以让事情变得简单:)

```
require 'pp'

dir = {}

files = [
  ['some', 'dir', 'file.txt'],
  ['other', 'folder', 'here.txt'],
  ['this', 'one', 'is', 'deeper', 'file.txt'],
  ['some', 'dir', 'second.txt']
]

def merge_paths(h, paths)
  top = paths[0]

  if paths.size == 1
    h[top] = top
  else
    h[top] ||= {}
    merge_paths h[top], paths[1..-1]
  end
end

files.each do |paths|
  merge_paths dir, paths
end

pp dir 
```

输出：

```
{"some"=>{"dir"=>{"file.txt"=>"file.txt", "second.txt"=>"second.txt"}},
 "other"=>{"folder"=>{"here.txt"=>"here.txt"}},
 "this"=>{"one"=>{"is"=>{"deeper"=>{"file.txt"=>"file.txt"}}}}} 
```

创建列表本质上是相同的过程；递归哈希键。当哈希值不是另一个哈希时，您处于最后一级。您可能还想按名称和/或类型进行排序，例如，首先放置目录（作为哈希的键值），依此类推。

你可以玩很多游戏，包括把它变成几行代码，结合像 deep_merge 这样的 gem 来减少你必须手动完成的繁忙工作量。

这也不会进行任何“健全性检查”以确保数据不是病态的，例如，您可以构造一个数组，将文件名转换为目录，用文件名清除目录，等等 -留给读者的练习。

# node.js - App's Mongoose Connection Closes Randomly

> ID：11165712
> 
> 赞同：0
> 
> 时间：2012-06-23T00:21:50.057
> 
> 标签：node.js, express, mongoose

I have a simple webapp using node.js that reads the database and displays this data to the user. There is this issue where after the app isn't actively used, when viewed initially the connection errors out with a [Error: connection closed]. After reloading the connection seems to be ok, though it does seem to bomb randomly after it first happens and you are clicking around (which I'm pretty sure is one of the workers dying from a bad connection and restarting). Here's pretty much all the important bits of the code...

```
//POSTPROVIDER.JS
var mongoose = require('mongoose');
var async = require('async');

var settings = require('./settings.js').mongodb;
if(!settings) {
  console.log('Could not connect to MongoDB server - missing MongoDB settings');
}

var connectString = "mongodb://" +
  settings.username + ":" + settings.password + "@" +
  settings.hostname + ":" + settings.hostport + "/" +
  settings.database;

mongoose.connect(connectString);

mongoose.connection.on('error', function(error) {
  console.log(error)
  mongoose.connect(connectString);
})

var Schema = mongoose.Schema;

var FeedbackSchema  = new Schema({
  //Schema
});

var feedbackDoc = mongoose.model('Feedback', FeedbackSchema);

//Example query
PostProvider.prototype.findByUuid = function(_id, callback) {

  feedbackDoc.findById( _id).exclude('screenshot').exec(function (err, feedback) {
    if (err) return callback(err);

    var feedbacks = JSON.stringify(convertFeedback(feedback), null, '    ');

    callback( null, feedbacks )
  });

};

exports.PostProvider = PostProvider; 
```

And the server code...

```
//APP.JS    
var express = require('express');
var request = require('request');
var cluster = require('cluster');
var numCPUs = require('os').cpus().length;

var app = module.exports = express.createServer();

// Express Config
var pub = __dirname + '/public';

app.configure(function(){
  app.set('views', __dirname + '/views');
  app.set('view engine', 'ejs');
  app.use(express.bodyParser());
  app.use(express.methodOverride());
  app.use(express.compiler({ src: pub, enable: ['sass'] }));
  app.use(express.static(pub));
  app.use(app.router);
});

var error = require('./error');

app.configure('development', function(){
  app.use(error({ showMessage: true, dumpExceptions: true, showStack: true, logErrors: __dirname + '/log/error_log' }));
});

app.configure('production', function(){
  app.use(error({ showMessage: true, dumpExceptions: true, showStack: true, logErrors: __dirname + '/log/error_log' }));
});

var PostProvider = require('./postprovider').PostProvider;
var PostProvider= new PostProvider();

if (cluster.isMaster) {
  // Fork workers.

  console.log("Master is running.  [ %d ]", process.pid );
  for (var i = 0; i < numCPUs; i++) {
    cluster.fork();
  }

  cluster.on('death', function(worker) {
    console.log('worker ' + worker.pid + ' died');
    console.log(worker)
    cluster.fork();
  });
} else {
  // Worker processes have a http server.();
    console.log("Worker is running.  [ %d ]", process.pid );

  //Main View
  app.get('/', function(req, res){

    var pageNum = 1;

      res.render('layout', {
            locals: {
              title: 'View Portal',
              pageNum: pageNum
            }
      });
  });

  app.listen(8900);
  console.log("Express server listening on port 8900");    
} 
```

Is there a way to check the status of the connection, and if so a way to reconnect correctly before processing a query?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T00:31:23.117

使用新版本的 Node，必须重写相关应用程序。回答我自己的问题以结束这个问题。

# django - django - superuser password hash in dumpdata json file

> ID：11165715
> 
> 赞同：2
> 
> 时间：2012-06-23T00:22:11.867
> 
> 标签：django, sentry

Hi can someone tell me what hash is used by django store superuser data ? I'm asking because I'd like to pre-generate password hash, stick it into prepared json fixture and load the user automatically via script. I just need to know how to prepare particular password hash. Thanks

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-24T22:15:03.737

谢谢乔什·斯米顿。我按照你的建议做了 - 第一次手动生成密码，然后将 auth DB 转储到 json 中：

```
sentry --config=/etc/sentry.conf.py dumpdata --indent=2 auth > ~/auth_data.json 
```

从转储的 json 文件中创建了一个新的夹具：

```
[
 {
    "pk": 1,
    "model": "auth.user",
    "fields": {
      "username": "somuser",
      "first_name": "Johnny",
      "last_name": "Bravo",
      "is_active": true,
      "is_superuser": true,
      "is_staff": true,
      "last_login": "2012-06-24 01:13:08",
      "groups": [],
      "user_permissions": [],
      "password": "<password_hash>",
      "email": "some@someother.com",
      "date_joined": "2012-06-24 01:10:30"
    }
  }
] 
```

并在没有任何交互的情况下自动加载它，如下所示：

```
sentry --config=/etc/sentry.conf.py loaddata ~/superuser.json 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T00:25:37.953

By default user passwords are hashed using [PBKDF2](http://en.wikipedia.org/wiki/PBKDF2). You can easily change this.

The hash is stored in the format `algorithm$hash`.

Source: [https://docs.djangoproject.com/en/dev/topics/auth/](https://docs.djangoproject.com/en/dev/topics/auth/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-23T00:25:58.710

The hash used depends on the version of Django you're using. From the Django docs:

> Django 1.4 introduces a new flexible password storage system and uses PBKDF2 by default. Previous versions of Django used SHA1, and other algorithms couldn't be chosen.

For more information, check out the [documentation](https://docs.djangoproject.com/en/dev/topics/auth/#how-django-stores-passwords).

# php - cannot import csv to database mysql

> ID：11165723
> 
> 赞同：-1
> 
> 时间：2012-06-23T00:24:22.297
> 
> 标签：php, mysql, csv, import

I make a admin page to upload the csv file into mysql. The file csv has size 59,9mb. But my script didn't upload the file into mysql. Would you mind to help me to fix this problem? Here is my code :

```
<HTML>
<HEAD>
<TITLE> Admin Update </TITLE>
</HEAD>

<BODY>
<form enctype='multipart/form-data' action="<?php echo $PHP_SELF ?>" method='post'>
<font face=arial size=2>Type file name to import:</font><br>
<input type='file' name='filename' size='20'><br>
<input type='submit' name='submit' value='submit'></form>
<?php
include("phpsqlajax_dbinfo.php");
$connection = mysql_connect ('127.0.0.1', $username, $password);
if (!$connection) {  die('Not connected : ' . mysql_error());} 

$db_selected = mysql_select_db("ipcoba", $connection);
if (!$db_selected) {
  die ('Can\'t use db : ' . mysql_error());
} 
if(isset($_POST['submit']))
{
// address to copy csv file
$target_path = "C:/xampp/htdocs/bikinwebtracert";     

$target_path = $target_path . basename( $_FILES['filename']['name']);

if(move_uploaded_file($_FILES['filename']['tmp_name'], $target_path)) {
echo "<font face=arial size=2>The file ". basename( $_FILES['filename']['name']). " Upload Success</font><br>";
} else{
echo "<font face=arial size=2>Failed to Upload, Please try again</font><br>";
}

$filename=$target_path;
$load=mysql_query("LOAD DATA LOCAL INFILE $filename INTO TABLE CityBlocks FIELDS TERMINATED BY ',' ENCLOSED BY '\"' LINES TERMINATED BY '\r\n' IGNORE 2 LINES (startIpNum, endIpNum, locId)'\n' ") or die(mysql_error());
if ($load){
echo("Failed");
} else {
echo("Success");
}
}
?>
</BODY>
</HTML> 
```

I need to fix this problem as soon as possible. Please Help. Thank You.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T01:47:33.987

您可以使用该导入命令通过命令行将文件导入 mysql 吗？在调查其余代码之前先尝试确保它正常工作。

编辑：

根据[mysql_query](http://php.net/manual/en/function.mysql-query.php)，如果成功，它应该返回 TRUE 或成功的资源，如果不成功则返回 FALSE。你的代码有这个：

```
if ($load){
    echo("Failed");
} else {
    echo("Success");
} 
```

我认为可能存在逻辑错误。尝试将代码更改为此并告诉我们会发生什么：

```
$load=mysql_query("LOAD DATA LOCAL INFILE $filename INTO TABLE CityBlocks FIELDS  TERMINATED BY ',' ENCLOSED BY '\"' LINES TERMINATED BY '\r\n' IGNORE 2 LINES (startIpNum, endIpNum, locId)'\n' ");
if (!$load){
    echo mysql_error();
} else {
echo("Success");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T01:04:03.750

1 - 尝试改进您的过滤器，以检测错误发生的位置

2 - 尝试为csv文件使用一个名称（将上传的文件重命名为test.csv），以保护自己，并确保文件将成功上传

3 - 尝试使用 file_get_contents 而不是 move_uploaded_file

4 - 确定你的错误是什么时候发生的？上传或导入错误？

试试这个代码：

# 编辑

我很高兴你解决了你的问题

我已经尽可能多地解释了，对不起我的英语

```
<?php

/*
The script idea is
1- we get the file name on the user computer
2- we rename it to import.csv
3- we check if file already exists or not
4- we upload the file
5- import the file
*/

/*
STEP 1
if there is incoming files.
*/
if(!$_FILES['filename']['tmp_name']||empty($_FILES['filename']['tmp_name']))
    die('Please select a file');
if($_FILES['filename']['tmp_name']){
/*
STEP 2
Here we will check if there is import.csv file
if there is import.csv file, that's mean there is a process underway
*/
    if(file_exists('/tmp/import.csv'))
        die('Please wait, we still working on the previous process...');
/*
File path
on the user computer
*/
    $filepath=$_FILES['filename']['tmp_name'];
/*
New path for the file
/tmp folder.. always have a permits that allow the lifting of the file
*/
    $newpath='/tmp/import.csv';
/*
Get the content of the file
read more about file_get_contents()
*/
    $getFile=file_get_contents($filepath);
/*
file_put_contents()
function that's requires to parametrs #1 file name #2 file content
and it will create a file with the name and content that you have provided
*/
    $uploade=(!empty($getFile))?file_put_contents($newpath,$getFile):die('We cant get the file!');
/*
if file exists we have succeed
*/
    if(!file_exists($newpath))
        die('The file did not uploaded..');

    //import to database
    $load = mysql_query("LOAD DATA LOCAL .........");
    if($load){
        //remove the file..
        unlink($newpath);
        echo 'success...';
    }

    else{
        echo(file_exists($getFile))?'File uploaded but did not imported to mysql':'File not uploaded';
    }

}

?> 
```

# streaming - 通过客户端 XHR 打开 Soundcloud Track 的 stream_url？

> ID：11165726
> 
> 赞同：4
> 
> 时间：2012-06-23T00:24:34.230
> 
> 标签：streaming, html5-audio, soundcloud, cors, web-audio-api

由于您可以通过 XHR 调用 Soundcloud API（因为 CORS 标头它发送[http://backstage.soundcloud.com/2010/08/of-cors-we-do/](http://backstage.soundcloud.com/2010/08/of-cors-we-do/)，对吗？）我想知道这是不是可以使用音频数据本身，例如轨道的 stream_url。

当尝试使用 Web Audio API 使用 XHR（从客户端）打开 stream_url 时，我得到一个*Origin is not allowed by Access-Control-Allow-Origin。*错误。有没有办法通过 XHttpRequest 从 Client-Side-Javascript 加载音频资源，还是不可能（[https://stackoverflow.com/questions/10871882/audio-data-api-and-streaming-a-no-go](https://stackoverflow.com/questions/10871882/audio-data-api-and-streaming-a-no-go)） ?

会很棒，因为这将允许使用 Web Audio API 做一些非常酷的事情。

谢谢！

**更新**

问题可能与您在调用时收到的 302 重定向有关：

```
http://api.soundcloud.com/tracks/5646378/stream.json?client_id=[client_id] 
```

或其他请求实际媒体文件的呼叫（请参阅评论）。

```
HTTP/1.1 302 Moved Temporarily
Server: nginx
Date: Sun, 24 Jun 2012 09:58:01 GMT
Content-Type: application/json; charset=utf-8
Connection: keep-alive
Cache-Control: no-cache
Location: http://ec-media.soundcloud.com/[...]
X-Runtime: 41
Content-Length: 339
Access-Control-Allow-Methods: GET, PUT, POST, DELETE
Access-Control-Allow-Headers: Accept, Authorization, Content-Type, Origin
Access-Control-Allow-Origin: *
X-Cacheable: NO:Cache-Control=no-cache
X-Varnish: 2433107209
Age: 0
Via: 1.1 varnish
X-Cache: MISS

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: max-age=252460800
Content-Type: audio/mpeg
Date: Sun, 24 Jun 2012 09:58:01 GMT
ETag: "c2241e[...]41bbcf7c0d32f09"
Last-Modified: Tue, 28 Sep 2010 17:57:26 GMT
Server: ECAcc (fra/D484)
x-amz-id-2: oB0XzQcc/[...]+mAr/a
x-amz-meta-bitrate: 128
x-amz-meta-duration: 152900
x-amz-meta-job: t405jWkfNvx7
x-amz-request-id: D65[...]E1355
X-Cache: HIT
Content-Length: 2445478 
```

原始 JSON 响应具有 CORS 标头，而重定向的位置没有。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-25T09:39:36.093

好吧，只要音频文件本身不附带 CORS 标头（请参阅问题中的 curl -IL 输出），唯一对我有用的解决方案就是打开音频文件并自己添加标头。

据我了解，这也是其他应用程序（如[https://github.com/tsenart/audiojedit](https://github.com/tsenart/audiojedit) ）所做的。（在 node.js 中）这具有将二进制文件的流量转移到您的服务器的巨大缺点，否则该服务器将由 soundcloud.com 提供服务。

您可以使用 PHP 打开文件，添加标题并使用以下内容重新流式传输：

```
$fp = fopen('http://api.soundcloud.com/tracks/[track_id]/stream.json?client_id=[client_id]', 'rb');

header("Content-Type: audio/mpeg");
header("Access-Control-Allow-Methods: GET, PUT, POST, DELETE");
header("Access-Control-Allow-Headers: Accept, Authorization, Content-Type, Origin");
header("Access-Control-Allow-Origin: *");
fpassthru( $fp );

exit(); 
```

正如我所说，这只是一种解决方法，不是生产环境的好解决方案，但帮助我继续使用我的网络音频应用程序。

Soundcloud，是否有机会将 CORS 标头添加到音频文件中？:)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-27T04:26:08.140

如果您不一定要使用 XHR，您可以创建新`<audio/>`元素并将其设置`src`为您想要的任何资产，而不受同源策略的约束。

较新版本的 Chrome 将允许您通过媒体元素创建 AudioNode 实例`MediaElementAudioSourceNode`——因此您仍然可以使用所有很酷的新 Web 音频内容。

```
var audio, body, context, source;
audio = document.createElement('audio');
body = document.getElementsByTagName('body')[0];
audio.setAttribute('src', 'http://kevincennis.com/mix/assets/sounds/1901_gtr1.mp3');
body.appendChild(audio);
context = new webkitAudioContext();
source = context.createMediaElementSource(audio);
source.connect(context.destination);
source.mediaElement.play(); 
```

原谅可怕的代码。时间不早了，我累了。

# ruby-on-rails - Hobo cannot find Rails

> ID：11165733
> 
> 赞同：0
> 
> 时间：2012-06-23T00:26:02.380
> 
> 标签：ruby-on-rails, macos, hobo

I am trying to create a web site using Hobo. I've installed Ruby, Rails and Hobo, in that order. However, when I run hobo to create a new site, it says it can't find rails even though I just installed it.

Note that it says, "Could not find rails **amongst** [some list of things]", where [some list of things] actually contains a version of rails!

```
/Library/Ruby/Site/1.8/rubygems/dependency.rb:247:in `to_specs': Could not find rails (~> 3.0.0) amongst
[abstract-1.0.0, actionmailer-3.2.6, actionmailer-3.0.15, actionpack-3.2.6, actionpack-3.0.15, activemodel-3.2.6, activemodel-3.0.15, activerecord-3.2.6, activerecord-3.0.15, activeresource-3.2.6, activeresource-3.0.15, activesupport-3.2.6, activesupport-3.0.15, arel-3.0.2, arel-2.0.10, builder-3.0.0, builder-2.1.2, bundler-1.1.4, coffee-rails-3.2.2, coffee-script-2.2.0, coffee-script-source-1.3.3, dryml-1.3.0, erubis-2.7.0, erubis-2.6.6, execjs-1.4.0, hike-1.2.1, hobo-1.3.0, hobo_fields-1.3.0, hobo_support-1.3.0, i18n-0.6.0, i18n-0.5.0, journey-1.0.4, jquery-rails-2.0.2, json-1.7.3, mail-2.4.4, mail-2.2.19, mime-types-1.19, multi_json-1.3.6, polyglot-0.3.3, rack-1.4.1, rack-1.2.5, rack-cache-1.2, rack-mount-0.6.14, rack-ssl-1.3.2, rack-test-0.6.1, rack-test-0.5.7, rails-3.2.6, railties-3.2.6, railties-3.0.15, rake-0.9.2.2, rdoc-3.12, rubygems-update-1.8.24, sass-3.1.19, sass-rails-3.2.5, sprockets-2.4.3, sprockets-2.1.3, sqlite3-1.3.6, thor-0.15.3, thor-0.14.6, tilt-1.3.3, treetop-1.4.10, tzinfo-0.3.33, uglifier-1.2.5, will_paginate-3.0.3] (Gem::LoadError)
        from /Library/Ruby/Site/1.8/rubygems/specification.rb:777:in `activate_dependencies'
        from /Library/Ruby/Site/1.8/rubygems/specification.rb:766:in `each'
        from /Library/Ruby/Site/1.8/rubygems/specification.rb:766:in `activate_dependencies'
        from /Library/Ruby/Site/1.8/rubygems/specification.rb:750:in `activate'
        from /Library/Ruby/Site/1.8/rubygems/specification.rb:780:in `activate_dependencies'
        from /Library/Ruby/Site/1.8/rubygems/specification.rb:766:in `each'
        from /Library/Ruby/Site/1.8/rubygems/specification.rb:766:in `activate_dependencies'
        from /Library/Ruby/Site/1.8/rubygems/specification.rb:750:in `activate'
        from /Library/Ruby/Site/1.8/rubygems.rb:1232:in `gem'
        from /usr/bin/hobo:22 
```

Here are some more details about my environment: I'm on Mac OS X 10.7.4, with the following versions of Ruby, Rails, and RubyGems:

> **$ rails --version**
> 
> Rails 3.2.6
> 
> **$ ruby -v**
> 
> ruby 1.9.3p0 (2011-10-30 revision 33570) [x86_64-darwin11.4.0]

```
$ gem env
RubyGems Environment:
  - RUBYGEMS VERSION: 1.8.24
  - RUBY VERSION: 1.8.7 (2011-12-28 patchlevel 357) [universal-darwin11.0]
  - INSTALLATION DIRECTORY: /Library/Ruby/Gems/1.8
  - RUBY EXECUTABLE: /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby
  - EXECUTABLE DIRECTORY: /usr/bin
  - RUBYGEMS PLATFORMS:
    - ruby
    - universal-darwin-11
  - GEM PATHS:
     - /Library/Ruby/Gems/1.8
     - /Users/blake/.gem/ruby/1.8
     - /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/gems/1.8
  - GEM CONFIGURATION:
     - :update_sources => true
     - :verbose => true
     - :benchmark => false
     - :backtrace => false
     - :bulk_threshold => 1000
  - REMOTE SOURCES:
     - http://rubygems.org/ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T00:30:00.157

布兰登是对的。也许最简单的解决方案是卸载 Rails，然后安装 Hobo。gem 将自动安装正确版本的 rails，因为 Hobo 依赖于它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T03:04:28.647

您已安装`rails-3.2.6`，与错误消息中的版本不匹配：`rails (~> 3.0.0)`。

`~> 3.0.0`意思是“任何大于或等于 3.0.0 但小于 3.1 的东西；” 所以，在这种情况下，任何 3.0.x 版本。您可以安装特定版本

```
[sudo] gem install rails -v version 
```

（您想要`version`的[版本号在哪里）。](http://rubygems.org/gems/rails/versions)

# mysql - If then else 在一个选择中

> ID：11165736
> 
> 赞同：2
> 
> 时间：2012-06-23T00:26:33.717
> 
> 标签：mysql, sql, if-statement

我正在尝试更快地编写脚本，并且我决定在 SQL 中包含一些过去在 PHP 中发生的计算。我必须做一个 if 语句来决定是否使用`insert`或`update`是否需要代码：

```
IF (EXISTS (SELECT * FROM `edenteva` WHERE `Time`='1340252716' and `Code`='571119'))
THEN IF (EXISTS (SELECT * FROM `map` WHERE `mega`='571119'))
THEN UPDATE `map` SET `edenteva`='571119' WHERE `mega`='571119'
ELSE INSERT INTO `map`(`mega`,`edenteva`) VALUES ('571119','571119'); 
```

但是，我得到一个语法错误，你能看出什么问题吗？

> 1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 'IF (EXISTS (SELECT * FROM `edenteva`WHERE `Time`='1340252716' and `Code`='57111'附近使用正确的语法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T00:29:23.733

好吧，你在你的问题中给出答案：`check the manual`......

IF 语句：[http ://dev.mysql.com/doc/refman/5.5/en/if-statement.html](http://dev.mysql.com/doc/refman/5.5/en/if-statement.html)

EXISTS 语句：[http ://dev.mysql.com/doc/refman/5.0/en/exists-and-not-exists-subqueries.html](http://dev.mysql.com/doc/refman/5.0/en/exists-and-not-exists-subqueries.html)

提示：您将正则条件表达式 IF THEN ELSE 与 SQL 查询中的 IF 语句混淆，这是不同的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-30T21:45:11.170

如果上面定义`map.mega`了一个`UNIQUE`索引（或者它是 a `PRIMARY KEY`），我们可以`ON DUPLICATE KEY UPDATE`这样使用：

```
INSERT INTO TABLE map (mega, edenteva)
VALUES ('571119','571119')
ON DUPLICATE KEY UPDATE edenteva = '571119'; 
```

如果我们只想在另一个表中有一行时进行更新或插入，我们可以使用另一个表作为值的来源：

```
INSERT INTO map (mega, edenteva)
  SELECT code, code
  FROM edenteva
  WHERE time = '1340252716' AND code = '571119'
ON DUPLICATE KEY UPDATE edenteva = VALUES(edenteva) ; 
```

好的 ole SQL 小提琴：[http ://sqlfiddle.com/#!2/9bb19/1](http://sqlfiddle.com/#!2/9bb19/1)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-29T14:14:21.417

IF THEN ELSE 用于存储在 mysql 领域的程序...

所以只能这样使用:(所以对于你或其他期待更多的人来说没有好消息......

```
DELIMITER //

CREATE FUNCTION SimpleCompare(n INT, m INT)
  RETURNS VARCHAR(20)

  BEGIN
    DECLARE s VARCHAR(20);

    IF n > m THEN SET s = '>';
    ELSEIF n = m THEN SET s = '=';
    ELSE SET s = '<';
    END IF;

    SET s = CONCAT(n, ' ', s, ' ', m);

    RETURN s;
  END //

DELIMITER ; 
```

# ajax - how to dynamically draw markers on google map

> ID：11165739
> 
> 赞同：0
> 
> 时间：2012-06-23T00:27:21.073
> 
> 标签：ajax, google-maps

Since the markers are too many and data is very large. I want to only draw the screen bounded region of markers. while I pan to other region, I can dynamically issue new request only for those not-shown markers. In case of overlapping region, the original-shown markers should not be re-drawn. For some reason,I need to use python as the back-end server script.A typical ajax approach should be used I think.

One problem is A new request may cover the original region of markers. A small move may cause the whole region to be re-drawn. Is there any cache-like thing to remember the previous region data so that the same portion of data won't be sent. Is there any way to do this? Any idea would be appreciated!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T00:32:26.180

嗯，你肯定有一个带有标记的数据库，你可以让服务器端的 web 服务公开一个 json 响应，然后你可以从 ajax 调用中使用该 web 服务。

Web 服务在数据库中查询用户的当前位置（使用地理位置 html5 或谷歌地图中的当前中点）。答案必须是区域中的标记数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-23T01:03:13.057

您还可以查看此处描述的不同方法： [https ://developers.google.com/maps/articles/toomanymarkers#markermanager](https://developers.google.com/maps/articles/toomanymarkers#markermanager)

Markermanager 可能是您正在寻找的：http: [//google-maps-utility-library-v3.googlecode.com/svn/tags/markermanager/1.0/docs/reference.html](http://google-maps-utility-library-v3.googlecode.com/svn/tags/markermanager/1.0/docs/reference.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-24T00:02:25.590

谷歌地图 API [示例][1]

[1]：[https](https://google-developers.appspot.com/maps/documentation/javascript/examples/event-arguments) ://google-developers.appspot.com/maps/documentation/javascript/examples/event-arguments 应该可以解决您的问题

# magento - Sort Magento related products by ASC sort order with NULLs last (or NULLs excluded)

> ID：11165740
> 
> 赞同：0
> 
> 时间：2012-06-23T00:27:31.890
> 
> 标签：magento

My Magento 1.6.2.0 installation currently sorts related products in ascending order by sort order (thanks to this [Q/A](https://stackoverflow.com/questions/8008076/magento-1-6-sort-order-of-related-products-not-working)). The answer detailed there works beautifully, however I prefer my products with a sort order value of NULL be listed last or completely excluded. I've played with addAttributeToSelect() but I have been unsuccessful.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T20:10:57.363

这可能不是最好的解决方案，但我在我的 related.phtml 文件中添加了一条 if 语句。

```
 <?php foreach($this->getItems() as $_item): ?>
        // add the if statement immediately after the foreach loop
        <?php if ( !is_null($_item->getPosition()) ): ?>
        . . . .
        <?php endif; ?>
    <?php endforeach; ?> 
```

# python - Build list using only list comprehensions, no function

> ID：11165742
> 
> 赞同：3
> 
> 时间：2012-06-23T00:28:09.117
> 
> 标签：python, list-comprehension

Given

```
userplays = { "Alice"   : { "AC/DC" : 2,
                            "The Raconteurs" : 3,
                            "Mogwai" : 1
                          },
              "Bob"     : { "The XX" : 4,
                            "Lady Gaga" : 3,
                            "Mogwai" : 1,
                            "The Raconteurs" : 1
                          },
              "Charlie" : { "AC/DC" : 7,
                            "Lady Gaga" : 7
                          }
            } 
```

get a list of all bands:

```
['Lady Gaga', 'Mogwai', 'AC/DC', 'The Raconteurs', 'The XX'] 
```

I can do

```
list(set(flatten([ [ band 
                     for band 
                     in playcounts.keys() ] 
                   for playcounts 
                   in userplays.values() ] ) ) ) 
```

where `flatten` is from [Flatten (an irregular) list of lists](https://stackoverflow.com/questions/2158395/flatten-an-irregular-list-of-lists-in-python), but is it possible without `flatten`, using only list/dict comprehensions?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-23T00:33:40.627

这将做到：

```
set(b for v in userplays.values() for b in v.keys()) 
```

产生：

```
set(['Lady Gaga', 'Mogwai', 'AC/DC', 'The Raconteurs', 'The XX']) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-23T01:04:59.490

另一种方法是使用字典理解（Python 2.7+）：

```
{k:v for v in userplays.values() for k in v.keys()}.keys() 
```

产生：

```
['Lady Gaga', 'Mogwai', 'AC/DC', 'The Raconteurs', 'The XX'] 
```

至少在 Python 3.3 中，这也更快：

```
import timeit

userplays = { "Alice"   : { "AC/DC" : 2,
                            "The Raconteurs" : 3,
                            "Mogwai" : 1
                          },
              "Bob"     : { "The XX" : 4,
                            "Lady Gaga" : 3,
                            "Mogwai" : 1,
                            "The Raconteurs" : 1
                          },
              "Charlie" : { "AC/DC" : 7,
                            "Lady Gaga" : 7
                          }
            }

def f1():
    set(b for v in userplays.values() for b in v.keys())

def f2():
    {k:v for v in userplays.values() for k in v.keys()}.keys()    

t1=timeit.Timer(f1).timeit(10000)
t2=timeit.Timer(f2).timeit(10000)
faster=abs(t1-t2) / max(t1,t2)
print("""
set:                {:.4} seconds
dict:               {:.4} seconds
faster of those is  {:.4%} faster

""".format(t1,t2,faster)) 
```

输出：

```
set:                0.02448 seconds
dict:               0.01988 seconds
faster of those is  18.7907% faster 
```

**编辑**

纯粹出于好奇，我比较了可以在单线中完成的各种方式。

结果如下：

```
f1: set from a generator expression
f2: keys from a dict comprehension
f3: set comprehension
f4: set from a list comprehension

       rate/s      f4       f1       f2       f3 
f4    358,650    0.0%   -13.4%   -31.7%   -41.3% 
f1    414,246   15.5%     0.0%   -21.1%   -32.2% 
f2    525,230   46.4%    26.8%     0.0%   -14.1% 
f3    611,158   70.4%    47.5%    16.4%     0.0% 
```

您可以看到集合理解最快，其次是 dict 理解。

下面是生成 Perl 风格基准的代码：

```
import timeit
import locale
locale.setlocale(locale.LC_NUMERIC, "")

userplays = { "Alice"   : { "AC/DC" : 2,
                            "The Raconteurs" : 3,
                            "Mogwai" : 1
                          },
              "Bob"     : { "The XX" : 4,
                            "Lady Gaga" : 3,
                            "Mogwai" : 1,
                            "The Raconteurs" : 1
                          },
              "Charlie" : { "AC/DC" : 7,
                            "Lady Gaga" : 7
                          }
            }

def f1():
    """set from a generator expression"""
    set(b for v in userplays.values() for b in v.keys())

def f2():
    """keys from a dict comprehension"""
    {k:v for v in userplays.values() for k in v.keys()}.keys()    

def f3():
    """set comprehension"""
    {b for v in userplays.values() for b in v.keys()}

def f4():
    """set from a list comprehension"""
    set([b for v in userplays.values() for b in v.keys()])

def test_table(funcs, c):
    results={k.__name__:timeit.Timer(k).timeit(c) for k in funcs}
    fastest=sorted(results,key=results.get, reverse=True)
    table=[]
    table.append([' ','rate/s']+fastest)
    for e in fastest:
        temp=[]
        temp.append(e)
        temp.append(int(round(float(c)/results[e])))
        t2=['{:.1%}'.format((results[x]-results[e])/results[e]) for x in fastest]
        table.append(temp+t2)
    print()    
    for e in funcs:
        print('{}: {}'.format(e.__name__, e.__doc__))
    print()            
    pprint_table(table)    

def format_num(num):
    """Format a number according to given places.
    Adds commas, etc. Will truncate floats into ints!"""

    try:
        inum = int(num)
        return locale.format("%.*f", (0, inum), True)

    except (ValueError, TypeError):
        return str(num)

def get_max_width(table, index):
    """Get the maximum width of the given column index"""
    return max([len(format_num(row[index])) for row in table])        

def pprint_table(table):
    col_paddings = []
    for i in range(len(table[0])):
        col_paddings.append(get_max_width(table, i))

    for row in table:
        # left col
        print(row[0].ljust(col_paddings[0] + 1),end=' ')
        # rest of the cols
        for i in range(1, len(row)):
            col = format_num(row[i]).rjust(col_paddings[i] + 2)
            print (col,end=' ')
        print()

test_table([f1,f2,f3,f4],100000) 
```

# design-patterns - design pattern to handle base/super classes with optional subclasses

> ID：11165744
> 
> 赞同：1
> 
> 时间：2012-06-23T00:28:22.563
> 
> 标签：design-patterns, inheritance

I may not have my terms right here, so please edit for clarity.

Let's say I have code for running a online shop that has a number of different classes/objects associated with it (Order, Customer, Product etc)

Then, I have particular stores, like a Shoe Store and a Pencil Shop, and each implements different aspects of the Base Store.

In an MVC pattern, how do I design an app so that I don't have write a subclass for each object for each type of store? (This would quickly get unwieldy if I had many stores).

For instance, given these modes:

models/baseOrders.file

models/baseCustomers.file

models/baseProducts.file

models/shoeStoreOrders.file (extends baseOrders)

models/pencilShopCustomers.file (extends baseCustomers)

Then I'd like to be able to instantiate an orders model, using shoeStoreModel.file when it's the shoe store and baseOrders when it's the pencil store...

Hopefully this is a clear question, but maybe I'm thinking about this incorrectly altogether... Guidance please!!! Thanks in advance...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T02:35:49.880

您描述它的方式，子类似乎是开放式的。而且由于（通常）您不能动态创建子类，因此一种解决方案是使用[type-object (pdf)](http://www.cs.ox.ac.uk/jeremy.gibbons/dpa/typeobject.pdf)，其*实例*代表所需的*subclasses*。

# jquery - Replace paragraph text within a div based on class

> ID：11165746
> 
> 赞同：1
> 
> 时间：2012-06-23T00:28:47.550
> 
> 标签：jquery, replace

I'm trying to use jQuery to change paragraph text based upon the class of the div in which it resides.

I want each of the class names in the array to replace the p text within their respective divs. Right now I just get the last div's class name for the p text.

```
<div class="ph player">PHILIPPINES<p class="topic">Test topic</p></div>
<div class="sl player">SOLOMON ISLANDS<p class="topic">Test topic</p></div>
<div class="fi player">FIJI<p class="topic">Test topic</p></div>
<div class="sm player">SAMOA<p class="topic">Test topic</p></div>

<script>
var divArr = ["ph", "sl", "fi", "sm"];
$.each(divArr, function(index, value) {
   $(".topic").text(this);
});
</script> 
```

Thanks for looking. Total beginner here.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-23T00:35:00.673

我想你想要的是：

```
$.each(divArr,function(i,val) {
  $('.'+val+' p.topic').text(val);
}); 
```

这将使每个 div 的段落文本等于两个字母的类名

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-23T00:32:29.027

您必须找到合适的`.topic`not all `.topic`s：

```
var divArr = ["ph", "sl", "fi", "sm"];
$.each(divArr, function(index, value) {
   $('.' + value).find(".topic").text(this);
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-23T00:32:37.733

确保您只选择要更改的 div：

```
var divArr = ["ph", "sl", "fi", "sm"];
$.each(divArr, function(index, value) {
   $("div." + value + " .topic").text(value);
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-23T00:33:22.603

```
$.each(divArr, function (i,e) { 
    $("."+this).find("p.topic").text(this);
}); 
```

关键是正确使用选择器。

" `this`" 取值 "ph", "sl"...

因此`"."+this`将识别 JQuery/CSS 语法中的类（.ph、.sl ...）

`$("."+this)`因此选择正确`div`的 ，我们将在其中用类细化`p`标签`.topic`并替换文本（再次，`this`）。

# macos - 如何在打开文件夹时运行脚本？

> ID：11165750
> 
> 赞同：1
> 
> 时间：2012-06-23T00:29:14.827
> 
> 标签：macos, osx-lion, applescript, directory, finder

我想在打开我的特定文件夹时运行一个applescript。然后，根据输入，关闭文件夹或保持打开状态。所有这些都无需打开文件夹。所以，基本上：

1）尝试打开文件夹

2) 文件夹打不开，但弹出窗口

3-A）如果用户点击确定文件夹打开

3-B）如果用户单击取消，它只是退出脚本，使文件夹未打开。

我怎样才能做到这一点？记住：文件夹不能在后台打开，只有用户按确定才能打开。帮助？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T03:53:26.520

对于此任务，您需要使用触发脚本文件的文件夹操作。以下是涉及可能触发脚本的文件夹的事件，以及特殊的相应处理程序。

*   打开一个文件夹——`on opening folder window for this_folder`
*   文件夹已关闭 —`on closing folder window for this_folder`
*   一个或多个项目被添加到文件夹`on adding folder items to this_folder after receiving these_items`
*   从文件夹中删除一个或多个项目 —`on removing folder items from this_folder after losing these_itmes`
*   文件夹窗口被移动——`on moving folder window for this_folder`

在这种情况下，第一个项目符号是您将重点关注的内容。正如项目符号所暗示的，仅当文件夹实际打开时才会触发脚本。**但是，**您可以通过在脚本的最开头添加以下行来解决此问题：

```
tell application "Finder" to close first window whose target is this_folder 
```

这是完整的脚本：

```
on opening folder window for this_folder
    tell application "Finder"
        close first window whose target is this_folder
        -- the window may appear briefly, but at least you've accomplished your goal

        display dialog "Open folder " quoted form of the name of this_folder & "?" buttons{"Yes,"No"} default button 1 cancel button 2
        -- pressing the "No" button is exactly the same as pressing the "Cancel" button on a regular dialog, and the script terminates

        make new Finder window with properties {target:this_folder}
    end tell
end opening folder window 
```

**将您的脚本文件保存在本地脚本文件夹的文件夹操作文件夹中。**如果该文件夹尚不存在，请自行创建该文件夹。这样做将使您的脚本甚至可以运行。现在，为了使其正常运行，您需要将保存的脚本文件（不是应用程序/应用程序包）附加到您想要的文件夹。去做这个...

1.  右键单击所需的文件夹
2.  单击底部的菜单项“文件夹操作设置”
3.  在出现的对话框中找到您保存的脚本
4.  点击“附加”
5.  关闭“文件夹操作设置”窗口

完成此操作后，您的脚本就可以开始使用了。

**附录：**如果您的文件夹包含机密信息，请注意，如 user57368 所述，“使用 AppleScript 可能无法使系统甚至远程安全。”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T01:57:16.890

您需要一个包含文件夹或磁盘映像的应用程序包，而不是普通文件夹。如果您使用加密的磁盘映像，如果不遵循您的首选过程，用户将更难以访问内容，但请注意，当您使用 AppleScript 时，可能无法使系统甚至远程安全。

如果您只想在允许用户读取数据之前提供许可协议或其他静态通知，只需阅读`hdiutil`手册页以了解如何创建在安装时提供许可协议的磁盘映像。

# ruby-on-rails - Ruby On Rails - 从不同的文件访问模型

> ID：11165751
> 
> 赞同：1
> 
> 时间：2012-06-23T00:29:21.640
> 
> 标签：ruby-on-rails, ruby, model

我的 Rails 应用程序中有一个模型，它是

```
class Person < ActiveRecord::Base
..
end 
```

我想从不同的 ruby​​ 文件访问这个模型以进行某些操作。这是为了填充我的数据库。有人可以告诉我该怎么做吗？

我是 ruby​​ on rails 的新手，因此是一个微不足道的问题。我尝试使用 require 或 require relative 包含模型，但我得到一个 LoadError

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T00:50:27.473

如果您使用 rake 任务来填充/操作数据库，那么您可以通过使任务依赖于 rails 环境来解决此问题，这将设置访问数据库所需的一切：

```
task :my_task => :environment do
#do whatever with your models here
end 
```

# iphone - iphone 的 Mapquest 架构 URL

> ID：11165756
> 
> 赞同：1
> 
> 时间：2012-06-23T00:30:11.610
> 
> 标签：iphone, url, schema, mapquest

我尝试构建一个 iPhone 应用程序以使用架构 URL 启动 Mapquest。Mapquest 是否会为其他应用程序公开架构 URL？如果是，你能提供文件或例子吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T06:16:43.323

我没有玩过它，但 MapQuest 确实提供了一个 API 并且有一个（测试版）URL 构建器：http: [//developer.mapquest.com/web/products/quick_start](http://developer.mapquest.com/web/products/quick_start)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T21:34:46.867

我看到的最新信息是他们正在研究它并且没有发布日期。

请参阅：http: [//developer.mapquest.com/web/products/forums/-/message_boards/view_message/389376#_19_message_421803](http://developer.mapquest.com/web/products/forums/-/message_boards/view_message/389376#_19_message_421803)

# css - 如何将内部 div 剪切为其父 div 大小？

> ID：11165760
> 
> 赞同：0
> 
> 时间：2012-06-23T00:31:01.887
> 
> 标签：css, html

我有一个方形 div（称为“方形”）并试图在“方形”内放置另一个 div（“标题”）。但是标题超出了方形边界！如何将其大小削减到父 div 的确切边界？

```
<!DOCTYPE html>
<html>
<head>
    <style type="text/css">
        body {
            background-color: #000000;
        }
        a {
            text-decoration: none;
            color: #FFFFFF;
        }
        div.square {
            background-color: #1BA1E2;
            display: inline-block;
            width: 44px;
            height: 44px;
            margin: 0 6px 0 9px;
        }
        div.caption {
            display: inline-block;
            margin: 15px 0 0 3px;
            padding: 0;
            color: #FFFFFF;
            font-size: 24px;
        }
        span.description {
            display: inline-block;
            vertical-align: bottom;
            font-size: 18px;
        }
    </style>
</head>
<body>
    <p>
        <a href="page">
            <div class="square">
                <div class="caption">
                    Caption
                </div>
            </div>
            <span class="description">
                Description
            </span>
        </a>
    </p>
</body>
</html> 
```

在这种情况下，`Caption`应该在蓝色框内切到`Cap`+ 1/2 `t`（类似于 WP7 样式）。以及旁边的说明。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-23T00:38:32.397

将`overflow:hidden`样式放入`div.square`. 这将导致标题在框的边界处被切断。

[运行示例](http://jsfiddle.net/TzRYj/)

# iphone - 将“MKOverlayView”发送到不兼容类型“id”的参数 '

> ID：11165762
> 
> 赞同：4
> 
> 时间：2012-06-23T00:31:27.460
> 
> 标签：iphone, ios, xcode, mkoverlay

在我的地图视图中添加叠加层时，我收到以下警告：

```
Sending 'MKOverlayView *const __strong' to parameter of incompatible type 'id<MKOverlay>' 
```

该代码运行良好，并且覆盖层按应有的方式绘制，但我很想摆脱警告。导致它的代码：

```
for(MKOverlayView *overlay in [mapView overlays]) {
    [mapView removeOverlay:overlay];
} 
```

（显然，for 循环内的行是引发此错误的原因）Google 没有针对该错误的单一结果。仅与 MKAnnotationView 类似。那里的解决方案（例如）：

```
for(id<MKOverlay> *overlay in [mapView overlays]) {
    [mapView removeOverlay:overlay];
} 
```

引发错误。

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-23T00:40:00.307

该属性返回覆盖*模型*对象（符合协议的对象）`overlays`的数组，而不是覆盖*视图*。*`MKOverlay`*

 **因此，将 for 循环更改为：

```
for(id<MKOverlay> overlay in [mapView overlays]) { 
```

请注意，零件中没有星号`id<MKOverlay> overlay`。**

# azure - Azure Blob 存储和安全性

> ID：11165771
> 
> 赞同：1
> 
> 时间：2012-06-23T00:33:14.350
> 
> 标签：azure, azure-storage, azure-blob-storage, file-storage

我正在决定将哪种技术用于项目。该项目将存储大量文档（Word、PDF 等），我正在尝试找出存储它们的最佳方式。到目前为止，我想出了：

1.  标准托管，并使用文件系统
2.  标准托管，使用全文搜索并将文档存储在 SQL Server 中
3.  使用 Azure Blob。

在任何情况下，任何人都不能看到这些文件。只有特定的授权人员才能查看文档。谁能指出我如何保护文档的方向，以便您不能只将浏览器指向它并且它会可见？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T00:57:36.080

Windows Azure blob 是存储大量文档的好地方。默认情况下，只有拥有帐户访问密钥的人才能检索 blob。（API 调用的标头必须使用该密钥进行签名，因此有一个加密保证，未经授权的第三方无法访问它们。）

我假设您将托管某种类型的前端，该前端允许授权用户访问，并且该前端将充当文件本身的代理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T00:36:07.937

不要将您的文档存储在 Web 服务器目录中。就这么简单。如果您一开始就不想将文件放在 Web 上，为什么还要费尽心思配置 Web 服务器呢？

# android - android中的捆绑包是否永久保存活动状态？

> ID：11165772
> 
> 赞同：3
> 
> 时间：2012-06-23T00:33:16.400
> 
> 标签：android

当我想保存活动的一些状态行为时，文档说我们应该实现 OnSaveInstanceState 和 OnReceiveInstanceState。

他们说即使在销毁或重新启动后，这也会保存活动状态。我更关心销毁（活动完全消失），这是否意味着捆绑包被认为是持久的？

当我打开一个 pdf 阅读器时，关闭它并再次打开它，我看到它在我所在的同一页面中打开。这是使用 Bundles 还是其他实现的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T00:51:31.130

要存储**持久应用程序数据**，请使用**Shared Preferences**。**共享首选项**只是一组持久存储的数据值。通过持久性，我们谈论的是跨*应用程序生命周期*事件*持续存在的数据。*换句话说，应用程序（或设备）可以在不丢失数据的情况下启动和停止。下次用户启动应用程序时，该数据仍然可用。一些游戏使用共享偏好来存储游戏达到的等级，玩家的名字...查看此[链接](https://docs.google.com/viewer?a=v&q=cache%3alGdJlThqC-kJ%3agrail.cba.csuohio.edu/~matos/notes/cis-493/lecture-notes/Android-Chapter14-Preferences.pdf%20&hl=fr&gl=tn&pid=bl&srcid=ADGEESiCJntTdrZAAwDFU6otIu2TWr3y6KJ01cAehq3pxRB8B5qBr9z0ymHcqdAZff9pSWcS1Qr5acoVfciPYtb3z8gYFPr_9SQVAtSXX-MqdBTHM0Yw2lWHPvzrBOSY21blJccdY8ri&sig=AHIEtbR4YxjZyp0IknEq-fwd9n3oLcbhWw)了解如何使用 Android Preference API

 *偏好与捆绑类似但是它们是持久的，捆绑不是！请记住，如果您需要存储持久数据，您有 4 个选项来执行此操作：

1.  **使用共享首选项**
2.  **使用 SQLite 数据库**
3.  **使用内部存储**
4.  **使用外部存储**

**捆绑包**不是持久的，文档说不要指望它，当活动即将被系统杀死时调用 onSaveInstanceState() ，但是对于已知的重新启动（例如在屏幕旋转时）。如果您的活动被杀死因为系统需要更多资源（活动在后台时），所以不会调用 onSaveInstanceState()，但会调用 onPause()。正如文档所述，onSaveInstanceState() 并不意味着保存持久数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-23T01:03:33.067

您可以**考虑**`SavedInstanceState()`永久保存，但不建议将其用于以持久方式保存应用程序相关数据，因为它不能保证被调用并且作者自己也不推荐它。

因此，仅将它们用于保存用户界面状态更改（背景颜色、当前选定的项目、..）并使用其他方法进行持久性，例如：SharedPreferences、文件和 SQLite。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-23T00:39:31.180

*捆绑包*不是持久的，它们的文档指定使用它们进行*持久性*不是一个好主意，因为它们的内部格式可能会在设备甚至操作系统版本之间发生变化。

*另一方面，*SharedPreferences可以持久化，是存储当前应用程序状态等信息的推荐方式。**

 ** * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-23T00:47:50.100

[SavingActivityState](http://developer.android.com/guide/components/activities.html#SavingActivityState)的一些相关部分 ：

> **注意：**不能保证 onSaveInstanceState() 会在您的活动被销毁之前被调用，因为在某些情况下不需要保存状态（例如当用户使用后退按钮离开您的活动时，因为用户明确关闭活动）。

无法保证数据将被存储，尤其是在您的用户退出应用程序的情况下。

> **注意：**因为不能保证调用 onSaveInstanceState()，所以你应该只使用它来记录活动的瞬态状态（UI 的状态）——你不应该使用它来存储持久数据。相反，当用户离开活动时，您应该使用 onPause() 来存储持久数据（例如应该保存到数据库中的数据）。

所以就像 K-ballo 说的，如果你有持久的数据要存储，就使用 SharedPreferences 。 `onSavedInstanceState()`主要用于存储 UI 相关数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-23T01:00:39.853

正如其他人都建议使用共享偏好一样，您应该在 onDestroy 和 onSavedInstance 中都进行此保存。

当android内存不足时，它只会杀死您的应用程序并调用您的onSavedInstance而不调用onDestroy等。将您的上下文保存在传递给onSavedInstance的包中。当您的应用再次进入前台时，android 将负责恢复您的后台活动。但是这一次它会在你的 onCreate 中为每个活动传递你的包，其中将包含你在你的应用程序被杀死时保存在你的 onSavedInstance 中的所有值。

希望这可以帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-09-20T03:42:56.427

简短的回答：**这不是永久性的。**

长答案：来自“Android Programming - The Big Nerd Ranch Guide”：

> 当 onSaveInstanceState(...) 被调用时，数据被保存到 Bundle 对象中。然后，该 Bundle 对象由操作系统填充到您的活动的活动记录中
> 
> ...
> 
> 那么活动记录什么时候被扼杀呢？当用户按下后退按钮时，您的活动真的被彻底破坏了。此时，您的活动记录将被丢弃。活动记录通常在重新启动时也会被丢弃，如果长时间不使用也可能会被丢弃。**

# image-processing - 在 RGB 图像上应用非锐化蒙版？

> ID：11165775
> 
> 赞同：2
> 
> 时间：2012-06-23T00:33:32.720
> 
> 标签：image-processing, computer-vision, filtering, convolution

RGB 图像的 Unsharp 蒙版算法是否与灰度图像相同？我只是将其应用于所有渠道吗？

或者也许我可以转换 RGB -> HSL 并应用它，然后返回 RGB？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T00:40:18.063

我可以告诉您，您习惯使用的大型照片编辑应用程序正是这样做的——它们将不锐化蒙版滤镜独立地应用于每个颜色通道。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-23T00:44:41.743

从在线[GIMP 文档](http://docs.gimp.org/en/plug-in-unsharp-mask.html)：

> **为防止锐化时颜色失真，将图像分解为 HSV 并仅处理值。然后将图像合成为 HSV。**转到颜色 → 组件 → 分解...。确保选中“分解为图层”框。选择 HSV 并单击确定。您将获得一个具有三层的新灰度图像，一层用于色相，一层用于饱和度，一层用于值。（关闭原始图像，以免混淆）。选择值层并对其应用锐化。完成后，选择同一层，反转该过程。转到颜色 → 组件 → 编写...。再次选择 HSV 并单击确定。您将恢复原始图像，只是它已在 Value 组件中锐化。

# wso2 - 我们可以使用 WSO2 进行 Idp 发起的 SSO 吗？

> ID：11165779
> 
> 赞同：0
> 
> 时间：2012-06-23T00:34:28.237
> 
> 标签：wso2, single-sign-on, saml

我是 WSO2 的新手，刚刚使用链接[http://wso2.org/library/articles/2010/07/saml2-web-browser-based-sso-wso2-identity-server](http://wso2.org/library/articles/2010/07/saml2-web-browser-based-sso-wso2-identity-server)演示了一个测试 SAML SSO 。现在我想知道我们是否也可以使用相同的方式执行 Idp 发起的 SSO。如果我错了，请纠正我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T11:18:43.970

是的你可以。WSO2 SAML SSO 实施支持 IDP 发起的 SSO。您可以首先直接登录到 WSO2 Identity Server，然后您可以访问 SSO 系统中的其他资源。

# cocoa - WebView 可可不响应 scrollWheel

> ID：11165787
> 
> 赞同：0
> 
> 时间：2012-06-23T00:35:49.427
> 
> 标签：cocoa, webview, scrollview

如何让它发挥作用？我在继承自 WebView 的类中添加了覆盖方法，但它没有被触发。

任何想法？提前致谢！

```
- (void)scrollWheel:(NSEvent *)theEvent 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T03:46:11.853

WebView 不是捕捉事件的那个；据我所知，获取事件的是框架视图的文档视图，而且它通常是 class `WebHTMLView`，很难子类化。

```
[[[webView mainFrame] frameView] documentView] 
```

对不起，但我不知道在这种情况下如何捕捉滚动事件，也许是方法调配或类似的东西。（尽管您可以使用类似的东西`-enclosingScrollView`并设置自定义滚动条或该类型的东西）

# iphone - 大约每 20 分钟后，iPhone 应用程序会自动注销/终止

> ID：11165788
> 
> 赞同：1
> 
> 时间：2012-06-23T00:35:56.160
> 
> 标签：iphone, background, task

平台和版本 iOS iPhone 4s，iOS 版本 5.1.1

问题描述每当我的应用程序被置于后台时，它大约每 20 分钟就会自动注销/终止。在我们的应用程序中，如果应用程序移至后台，我们可以上传数据。如果我注释掉这一部分，应用程序将不再被杀死。

即使没有活动或没有用户干预并且它只是坐在后台，应用程序也会被注销（被操作系统杀死）。

重现步骤请在下面找到在后台上传附件的代码片段。

```
 -(void) endTaskWidthIdentifier:(NSNumber *)paramIdentifier{
    UIBackgroundTaskIdentifier identifier = [paramIdentifier integerValue];
    [[UIApplication sharedApplication] endBackgroundTask:identifier]; }

 - (void)applicationDidEnterBackground:(UIApplication *)application {
        backgroundTaskIdentifier = [application 
 beginBackgroundTaskWithExpirationHandler:^{
        NSNumber *backgroundTask = [NSNumber 
 numberWithInteger:backgroundTaskIdentifier];
        [self 
 performSelectorOnMainThread:@selector(endTaskWidthIdentifier:)
 withObject:backgroundTask waitUntilDone:YES];
        backgroundTaskIdentifier = UIBackgroundTaskInvalid;
    }];
 } 
```

执行此代码后，应用程序会在 15 到 20 分钟后注销，同时保持在后台，无需用户干预。

如果我评论此代码，应用程序将保留在后台并且不会退出并保持暂停模式。

问题：

这段代码有什么问题。这段代码不应该做什么？

# matlab - Matlab 在不重新绘制的情况下更改绘图中的单个点

> ID：11165795
> 
> 赞同：2
> 
> 时间：2012-06-23T00:37:58.043
> 
> 标签：matlab, plot, octave

所以我在 2D 平面上有一个 N 个点的图（N 可以非常大）。我正在编写一个脚本来显示算法的工作原理。所以我有for循环。在 for 循环的每一步，我都想改变当前点的颜色（实际上可能只用这一点制作一个茎图）。

但是，在步骤结束时，我想删除当前点的颜色，以便为下一个点上色。目前我必须重绘整个情节（包括 2D 点）。我不确定 Matlab 是否在绘图命令中检测到这些东西，但有没有办法在不重绘整个绘图的情况下做到这一点？

例如：

```
plot(x,y, '*');

for j = 1:N-1
    for i = j:N
        hold on;
        %Do stuff

        plot(x,y, '*');
        hold on;
        stem(x(1), y(1), 'g*');
    end

end 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-23T01:55:33.560

一个简单的例子：

```
%# plot some data
x = 1:100;
y = cumsum(rand(size(x))-0.5);
plot(x,y,'*-')

%# animate by going through each point
hold on
h = stem(x(1),y(1),'g');
hold off
for i=1:numel(x)
    %# update the stem x/y data
    set(h, 'XData',x(i), 'YData',y(i));

    %# slow down a bit, drawnow was too fast!
    pause(.1)
end 
```

![截屏](../Images/15f8a9ecdb9448767520079a9631a6eb.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-23T00:44:45.557

查看[句柄图形对象](http://www.mathworks.com/help/techdoc/learn_matlab/f3-15974.html)的文档。

我建议将整组点绘制为一个对象。然后，对于每次迭代，绘制兴趣点。保存一个句柄（如，`h = plot(...);`）。当您准备好进行下一次迭代时，`delete`使用该句柄 ( `delete(h)`) 的对象，并以相同的方式创建下一个。

```
%# outside the for loop (do this once)
plot(x,y,'*');

for...
    h = stem(x(i),y(i),'g*');
    ...
    %# next iteration... i has been incremented
    delete(h);
    h = stem(x(i),y(i),'g*');
end 
```

# macos - 为什么这个简单的 AppleScript 不起作用？

> ID：11165799
> 
> 赞同：2
> 
> 时间：2012-06-23T00:38:56.363
> 
> 标签：macos, bash, shell, alias, osascript

我有一个 Shell 脚本，我需要在 MacOSX 10.6.X 上创建别名文件夹，所以我调用 osascript 使用以下代码来执行此操作：

```
Source="/Volumes/Test Project/Folder/SubFolder"
Destination="/Volumes/Test Project/Dest/"

/usr/bin/osascript -e 'tell application "Finder" to make alias file to POSIX file "$Source" at POSIX file "$Destination"' 
```

此代码返回：

> 29:103：执行错误：Finder 出错：AppleEvent 处理程序失败。(-10000)

有没有人有办法解决吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-23T02:41:12.313

shell 不会替换`$Source`单引号字符串（例如整个AppleScript 命令）中的变量（例如）。解决方案：在命令周围使用双引号（这意味着您需要用反斜杠转义其中的双引号）。

```
/usr/bin/osascript -e "tell application \"Finder\" to make alias file to POSIX file \"$Source\" at POSIX file \"$Destination\"" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-23T01:35:20.020

有什么理由阻止您使用：`ln -s "$Source" "$Destination"`？

# iphone - 绘制 Retina 分辨率的图像反射

> ID：11165800
> 
> 赞同：2
> 
> 时间：2012-06-23T00:38:56.953
> 
> 标签：iphone, ios, graphics, quartz-graphics, retina-display

我很难以 Retina 分辨率（2 倍比例）动态绘制 UIImage 的反射。Apple 用于绘制反射的示例代码从未更新以利用更高分辨率。有简单的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T00:49:37.807

[这](http://cocoacontrols.com/platforms/ios/controls/imagereflection)是一个名为 ImageReflection 的库，可以轻松反射 UIImages。GitHub页面说它已经有两年历史了，所以我不知道它在多大程度上符合“现代”Objective-C（块、ARC、GCD等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T23:49:01.750

我写了一个非常好的库来处理这个：

[https://github.com/nicklockwood/FXImageView](https://github.com/nicklockwood/FXImageView)

它在 UIImage 上提供了一个用于绘制反射的类别，以及一个 UIImageView 子类，它将自动将反射应用于您在运行时设置的任何图像（它甚至可以在后台线程上进行渲染以避免阻塞 UI）。

# sql-server - 需要有关在 SQL Server 上使用 SqlBulkCopy 挑战极限的建议

> ID：11165803
> 
> 赞同：4
> 
> 时间：2012-06-23T00:39:18.877
> 
> 标签：sql-server, scalability, bulkinsert, sqlbulkcopy, database-performance

我正在设计一个应用程序，其中一个方面是它应该能够将大量数据接收到 SQL 数据库中。我将数据库结构设计为具有 bigint 标识的单个表，如下所示：

```
CREATE TABLE MainTable
(
   _id bigint IDENTITY(1,1) NOT NULL PRIMARY KEY CLUSTERED,
    field1, field2, ...
) 
```

我将省略我打算如何执行查询，因为它与我的问题无关。

我写了一个原型，它使用 SqlBulkCopy 将数据插入到这个表中。它似乎在实验室里工作得很好。我能够以约 3K 记录/秒的速度插入数千万条记录（完整记录本身相当大，约 4K）。由于该表上唯一的索引是自动递增 bigint，因此即使在推送了大量行之后，我也没有看到减速。

考虑到实验室 SQL Server 是配置相对较弱的虚拟机（4Gb RAM，与其他 VM 磁盘 sybsystem 共享），我期望在物理机上获得显着更好的吞吐量，但它没有发生，或者说性能提升可以忽略不计。我可以，也许可以在物理机器上更快地插入 25%。即使我配置了 3 驱动器 RAID0，它的性能比单个驱动器快 3 倍（由基准测试软件测量），我也没有任何改进。基本上：更快的驱动子系统、专用物理 CPU 和双 RAM 几乎没有转化为任何性能提升。

然后我使用 Azure 上最大的实例（8 核，16Gb）重复了测试，得到了相同的结果。因此，添加更多内核并不会改变插入速度。

目前，我使用了以下软件参数，但没有任何显着的性能提升：

*   修改 SqlBulkInsert.BatchSize 参数
*   同时从多个线程插入，并调整线程数
*   在 SqlBulkInsert 上使用表锁定选项
*   通过使用共享内存驱动程序从本地进程插入来消除网络延迟

我试图将性能提高至少 2-3 倍，我最初的想法是投入更多的硬件可以完成任务，但到目前为止还没有。

所以，有人可以推荐我吗：

*   什么资源可能被怀疑是这里的瓶颈？如何确认？
*   考虑到只有一个 SQL 服务器系统，有没有一种方法可以尝试获得可靠的可扩展批量插入改进？

**更新**我确信加载应用程序不是问题。它在一个单独的线程中的临时队列中创建记录，因此当有插入时，它会像这样（简化）：

```
===>start logging time
int batchCount = (queue.Count - 1) / targetBatchSize + 1;
Enumerable.Range(0, batchCount).AsParallel().
    WithDegreeOfParallelism(MAX_DEGREE_OF_PARALLELISM).ForAll(i =>
{
    var batch = queue.Skip(i * targetBatchSize).Take(targetBatchSize);
    var data = MYRECORDTYPE.MakeDataTable(batch);
    var bcp = GetBulkCopy();
    bcp.WriteToServer(data);
});
====> end loging time 
```

记录时间，创建队列的部分永远不会占用任何重要的块

**UPDATE2**我已经实现了收集该周期中每个操作需要多长时间，布局如下：

*   `queue.Skip().Take()`- 可以忽略不计
*   `MakeDataTable(batch)`- 10%
*   `GetBulkCopy()`- 可以忽略不计
*   `WriteToServer(data)`- 90%

**UPDATE3**我正在为标准版本的 SQL 设计，所以我不能依赖分区，因为它只在企业版中可用。但我尝试了一种分区方案的变体：

*   创建了 16 个文件组（G0 到 G15），
*   制作了 16 个仅用于插入的表（T0 到 T15），每个表都绑定到其单独的组。表根本没有索引，甚至没有聚集 int 标识。
*   插入数据的线程将循环遍历所有 16 个表。这几乎可以保证每个批量插入操作都使用自己的表

这确实在批量插入方面产生了约 20% 的改进。CPU 内核、LAN 接口、驱动器 I/O 未最大化，并且以最大容量的 25% 左右使用。

**UPDATE4**我认为它现在已经很好了。我能够使用以下技术将插入物推到合理的速度：

*   每个批量插入都进入自己的表，然后结果合并到主表中
*   每次批量插入都会重新创建表，使用表锁
*   [从这里](http://spikes.codeplex.com/)使用 IDataReader 实现而不是 DataTable。
*   从多个客户端完成的批量插入
*   每个客户端都使用单独的千兆 VLAN 访问 SQL
*   访问主表的副进程使用 NOLOCK 选项
*   我检查了 sys.dm_os_wait_stats 和 sys.dm_os_latch_stats 以消除争用

在这一点上，我很难决定谁回答了问题。那些没有得到“答复”的人，我很抱歉，这是一个非常艰难的决定，我感谢大家。

**UPDATE5**：以下项目可以使用一些优化：

*   [从这里](http://spikes.codeplex.com/)使用 IDataReader 实现而不是 DataTable。

除非您在具有大量 CPU 核心数的机器上运行您的程序，否则它可能会使用一些重构。由于它使用反射来生成 get/set 方法，这成为 CPU 的主要负载。如果性能是关键，当您手动编写 IDataReader 代码时，它会增加很多性能，以便编译它，而不是使用反射

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-23T06:43:30.020

有关为批量加载调整 SQL Server 的建议，请参阅 MS 的[数据加载和性能指南](http://msdn.microsoft.com/en-us/library/dd425070%28v=sql.100%29.aspx)论文，以及从在线书籍[优化批量导入的指南。](http://msdn.microsoft.com/en-us/library/ms177445%28SQL.105%29.aspx)尽管他们专注于从 SQL Server 批量加载，但大多数建议适用于使用客户端 API 进行批量加载。这篇论文适用于 SQL 2008 - 你没有说你的目标是哪个 SQL Server 版本
两者都有相当多的信息，值得详细阅读。但是，一些亮点：

*   最少记录批量操作。使用批量记录或简单恢复。您可能需要启用 traceflag 610（但请参阅执行此操作的注意事项）
*   调整批量大小
*   考虑对目标表进行分区
*   考虑在批量加载期间删除索引

[数据加载和性能指南](http://msdn.microsoft.com/en-us/library/dd425070%28v=sql.100%29.aspx)的流程图很好地总结了： ![在此处输入图像描述](../Images/dfedadac09c0967303695313ab7d8f82.png)

正如其他人所说，您需要获得一些性能计数器来确定瓶颈的来源，因为您的实验表明 IO 可能不是限制。 [数据加载和性能指南](http://msdn.microsoft.com/en-us/library/dd425070%28v=sql.100%29.aspx)包括要监视的 SQL 等待类型和性能计数器的列表（文档中没有要链接的锚点，但这大约是文档中的 75%，在“优化批量加载”部分）

*更新*

我花了一段时间才找到链接，但Thomas Kejser 的[这个 SQLBits 演讲](http://sqlbits.com/Sessions/Event7/Designing_and_Tuning_high_speed_data_loading)也非常值得一看 -如果您没有时间观看整个内容，可以使用这些[幻灯片。](http://sqlbits.com/Downloads/142/Designing%20and%20Tuning%20high%20speed%20data%20loading%20-%20Thomas%20Kejser.pptx)它重复了此处链接的一些材料，但还涵盖了有关如何处理特定性能计数器的高发生率的其他一些建议。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-23T01:39:34.607

看来您已经做了很多，但我不确定您是否有机会研究 Alberto Ferrari [SqlBulkCopy 性能分析](http://sqlblog.com/blogs/alberto_ferrari/archive/2009/11/30/sqlbulkcopy-performance-analysis.aspx)报告，该报告描述了考虑与 SqlBulkCopy 相关的性能的几个因素。我想说那篇论文中讨论的很多事情仍然值得尝试，最好先尝试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-29T17:16:16.097

我不确定为什么你没有得到 100% 的 CPU、IO 或内存利用率。但是，如果您只是想提高批量加载速度，则需要考虑以下几点：

1.  将您的数据文件划分为不同的文件。或者，如果它们来自不同的来源，则只需创建不同的数据文件。
2.  然后同时运行多个批量插入。

根据您的情况，上述方法可能不可行；但如果可以的话，我相信它应该会提高你的加载速度。

# java - 将 JButton 放在右下角

> ID：11165807
> 
> 赞同：12
> 
> 时间：2012-06-23T00:39:56.460
> 
> 标签：java, swing, jbutton

我需要在原本为空的 JPanel 的右下角放置一个按钮

```
 +-----------------------------------+
 |                                   |
 |                                   |
 |                                   |
 |                                   |
 |                                   |
 |                                   |
 |                                   |
 |                                   |
 |                      +-----------+|
 |                      | Click Me! ||
 |                      +-----------+|
 +-----------------------------------+ 
```

我怎么做？应该很容易吧？我想找到正确的布局管理器，而不是使用一系列嵌套面板。

```
JPanel panel = new JPanel();
panel.setLayout(new SomeKindOfLayoutManagerThatDoesThis());
panel.add(new JButton("Click Me!"), SETTINGS); 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-06-23T00:58:17.900

我建议将边框布局管理器与流布局一起使用。

就像是：

```
this.setLayout(new BorderLayout());
JPanel buttonPanel = new JPanel();
buttonPanel.setLayout(new FlowLayout(FlowLayout.RIGHT));
JButton clickmeButton = new JButton("Click Me");
buttonPanel.add(clickmeButton);
this.add(buttonPanel,BorderLayout.SOUTH); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-23T00:44:20.840

您可以使用[大小/对齐提示](http://docs.oracle.com/javase/tutorial/uiswing/layout/using.html#sizealignment)[`BoxLayout`](http://docs.oracle.com/javase/7/docs/api/javax/swing/BoxLayout.html)的组合来实现此目的。

# jquery - IE9 jquery ajax post请求随机导致错误请求（400），tomcat接收post参数为'null'

> ID：11165810
> 
> 赞同：2
> 
> 时间：2012-06-23T00:40:04.277
> 
> 标签：jquery, internet-explorer-9, tomcat6, bad-request, http-status-code-400

我们有生产应用程序，我们在 apache 访问日志中随机看到错误的请求响应（状态代码 = 400）。

*   仅适用于 IE9 用户 - （Mozilla/5.0（兼容；MSIE 9.0；Windows NT 6.1；WOW64；Trident/5.0）。
*   我们已尝试为相同的 URL（场景）重新生成 - 我们无法重新生成
*   Tomcat 接收所有参数为 null 并以空指针异常结束。我们确实有一个错误页面转发异常，但客户端收到 400-Bad 请求。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T00:45:20.760

当用户位于公司防火墙后面时，我在 AJAX 上也遇到过类似的问题。有时请求似乎会以不可预知的方式改变。如果您无法使用相同的浏览器进行复制，这可能值得研究。

不幸的是，如果这是问题所在，除了不对这些部分使用 AJAX 外，您无能为力。

# android - 这个 AsyncTask 将在哪里运行？

> ID：11165813
> 
> 赞同：0
> 
> 时间：2012-06-23T00:40:35.923
> 
> 标签：android

假设我的应用程序中有此代码`AlertDialog.Builder(context)`。问题是`Thread`它将运行在哪个位置？

```
final Thread myPrettyOperation = new Thread() {
    @Override
    public void run() {
        //Do some really long operation.
    }
};
class MyPrettyTask extends
        AsyncTask<Void, Integer, Boolean> {
    protected Boolean doInBackground(
            Void... voids) {
        myPrettyOperation.start();
        return true;
    }
    protected void onProgressUpdate(
            Integer... progress) {
    }
    protected void onPostExecute(Boolean result) {
    }
}
new MyPrettyTask().execute(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T00:51:40.757

这取决于您发布的代码的哪些部分被考虑。您的代码中涉及 ​​3 个线程。

显然，run() 的主体将在**您为 myPrettyOperation 创建**的线程中运行。

行*“myPrettyOperation.start(); return true;”* 将在**从系统的线程池中**为 AsyncTask 分配的线程中运行。

其余代码将**在应用程序的 UI 线程**（即主线程）**上运行**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-23T15:01:16.277

由于您在对 Vipul Shah 的回复的评论中提出了一个额外的问题，我将在这里回答（它需要一个代码块）。你的问题是：

> 你确定吗？*[是否全部在 UI 线程上运行]*我该如何进一步调查？

使用我在下面发布的代码块。

请注意我注入到您的代码中的 Log.i 调用。运行您的应用程序，并检查 logcat 输出。线程名称将分别以“Thread1:”、“Thread2:”、“Thread3:”开头的行列出。无论您在输出中看到“main”的哪个位置，都表示您的 UI 线程。在其他情况下，您将看到线程的名称，例如 myPrettyOperation 的“Thread14”。

```
final Thread myPrettyOperation = new Thread() {
    @Override
    public void run() {
        Log.i("YOUR_TAG", "Thread1: "+ Thread.currentThread().getName()); 
        //Do some really long operation.
    }
};
class MyPrettyTask extends
        AsyncTask<Void, Integer, Boolean> {
    protected Boolean doInBackground(
            Void... voids) {
        Log.i("YOUR_TAG", "Thread2: "+ Thread.currentThread().getName()); 
        myPrettyOperation.start();
        return true;
    }
    protected void onProgressUpdate(
            Integer... progress) {
    }
    protected void onPostExecute(Boolean result) {
    }
}
new MyPrettyTask().execute();
Log.i("YOUR_TAG", "Thread3: "+ Thread.currentThread().getName()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-23T03:10:44.653

> 假设我在应用程序的 AlertDialog.Builder(context) 中有此代码

它将始终在 UI 线程上运行

# python - 在OpenGL [python]中纹理映射一个弯曲的矩形

> ID：11165816
> 
> 赞同：0
> 
> 时间：2012-06-23T00:41:20.853
> 
> 标签：python, opengl, texturing

我在 python 中的 OpenGL 中的纹理映射有一些问题。我正在尝试绘制一个在顶部和底部弯曲的矩形，但到目前为止我只能让它在底部弯曲。不知何故鞋面不想形成曲线。我正在使用这个函数，参数为 0.2：

```
def DrawAWobble(y_wobble):
    R = y_wobble/2.0 - 1/(2.0*y_wobble)

    glBegin(GL_POLYGON)
    x = 0.0
    while x<2.1:
        glTexCoord2f(x*0.5, 1.0); glVertex2f(x/2 - 0.5, 0.5 + (R + math.sqrt(R**2 - (1 - x)**2 + 1)))
        x += 0.1

    x = 2.0
    while x>-0.1:
        glTexCoord2f(x*0.5, 0.0); glVertex2f(x/2 - 0.5, -0.5 + (R + math.sqrt(R**2 - (1 - x)**2 + 1)))
        x -= 0.1
    glEnd() 
```

我得到的结果在左边，而我应该得到像图像右侧部分的东西。

![在此处输入图像描述](../Images/bcee1ce61f3e5fa630c53314977591ef.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T01:28:26.247

评论者蒂姆是对的。问题是 GL_POLYGON。问题是 GPU 必须弄清楚如何对您的任意多边形进行三角测量，并且它正在以一种不保留您的映射的方式进行。您可能*想要*的是使用单个四边形或三角形条来渲染它；而不是在多边形的边缘工作，而是来回交替工作。像这样的东西（显然未经测试）：

```
def DrawAWobble(y_wobble,step=0.1):
    R = y_wobble/2.0 - 1/(2.0*y_wobble)

    glBegin(GL_QUAD_STRIP)
    x = 0.0
    while x<2.0+0.5*step:
        glTexCoord2f(0.5*x,0.0); glVertex2f(0.5*(x-1), -0.5 + R + (R*R-(1-x)*(1-x)+1)**0.5)
        glTexCoord2f(0.5*x,1.0); glVertex2f(0.5*(x-1),  0.5 + R + (R*R-(1-x)*(1-x)+1)**0.5)
        x += step
    glEnd() 
```

# ios - UINavigationController 的自定义动画推送未正确呈现导航栏

> ID：11165820
> 
> 赞同：5
> 
> 时间：2012-06-23T00:42:18.183
> 
> 标签：ios, uinavigationcontroller, segue

在自定义 segue 中，我有以下简单的过渡：

```
- (void) perform {
    UIViewController *src = (UIViewController *) self.sourceViewController;
    UIViewController *dst = (UIViewController *) self.destinationViewController;
    [UIView transitionWithView:src.navigationController.view duration:1
                       options:UIViewAnimationOptionTransitionFlipFromBottom
                    animations:^{
                        [src.navigationController pushViewController:dst animated:NO];
                    }
                    completion:NULL];
} 
```

内容视图的动画效果很好。但是，在执行动画时，顶部的导航栏布局混乱（按钮都挤在左上角，没有标题），只有在动画完成时才会弹出到位。任何人都知道我做错了什么以及如何解决它？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-25T19:55:22.207

想通了我的问题。考虑到 UINavigationController 的工作方式以及与它管理的 UIViewController 的交互方式，原始代码确实不正确。（像我在 OP 中所做的那样令人讨厌的东西可以在旧的 SO 帖子中找到作为解决方案。）

这是对我有用的代码（有一个小问题）：

```
- (void) perform {
    UIViewController *src = (UIViewController *) self.sourceViewController;
    UIViewController *dst = (UIViewController *) self.destinationViewController;
    [UIView transitionFromView:src.view
                        toView:dst.view
                      duration:1
                       options:UIViewAnimationOptionTransitionFlipFromBottom
                    completion:nil];
    [UIView transitionFromView:src.navigationItem.titleView
                        toView:dst.navigationItem.titleView
                      duration:1
                       options:UIViewAnimationOptionTransitionFlipFromBottom
                    completion:nil];
    [src.navigationController pushViewController:dst animated:NO];
} 
```

Quibble：这将使导航栏与内容视图分开设置动画，因此您可以翻转两块而不是整个屏幕。我最初试图这样做：

```
 [UIView transitionFromView:src.navigationController.view
                        toView:dst.navigationController.view 
```

但这失败了，因为 1) 目的地的 navigationController 属性在它被推送到导航控制器之前还没有设置，2) 即使它是指同一个视图！我忘记了

> 导航控制器的视图只是其他几个视图的容器，包括导航栏、可选工具栏和包含自定义内容的视图……尽管导航栏和工具栏视图的内容会发生变化，但视图本身会发生变化不是...导航控制器对象使用与导航堆栈上的视图控制器关联的导航项（UINavigationItem 类的实例）动态构建导航栏的内容。因此，要更改导航栏的内容，您必须为自定义视图控制器配置导航项。[（文档）](http://developer.apple.com/library/ios/#documentation/uikit/reference/UINavigationController_Class/Reference/Reference.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T22:36:56.400

另一个“狡辩”？我放

```
[src.navigationController pushViewController:dst animated:YES]; 
```

前

```
 [UIView transitionFromView ... 
```

以便在目的地的 viewDidLoad 方法中可以访问导航控制器。

# iphone - 当 cocos2d 在 CCMenu 中调用 ccTouchEnded 时发生 EXC BAD ACCESS

> ID：11165822
> 
> 赞同：0
> 
> 时间：2012-06-23T00:42:37.080
> 
> 标签：iphone, ios, cocos2d-iphone

这只会偶尔发生一次。当我在按下时从菜单项调用的方法中的断点跳出时，我最终到达方法的末尾，当我跳出时，我最终到达 ccTouchEnded，然后发生错误访问。调试输出窗口中没有显示任何内容，但我得到一个绿色箭头，指向带有错误消息的主要方法。

任何想法为什么会发生这种情况？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T05:48:25.280

因此，如果有人遇到同样的问题，我会弄清楚发生了什么。我有一个包含几个孩子的 CCMenu。当一个孩子被点击时，我做了我想做的事，然后通过 removeChild:cleanup: 在我作为 CCMenuItem 的选择器传递的方法中将其从 CCMenu 中删除。问题是 Cocos2d 在执行选择器方法时停用 CCMenuItem，然后在方法完成时重新激活它。因此，在该方法中，我基本上是通过从 CCMenu 中删除 CCMenuItem 来破坏它，然后在方法结束时 Cocos2d 尝试重新激活它，但它不再在内存中。

我没有看到很多解决方法，所以可能无法在其选择器方法中从 CCMenu 中删除 CCMenuItem。

我解决它的方法是在菜单项上简单地调用 setVisible:NO 和 setIsEnabled:NO。但是，我可以想象这不是最好的方法。也许在这些情况下，您可能会弄乱 z 位置或其他东西来让菜单项不碍事。

无论如何，我希望这对其他人有所帮助，我知道我已经坚持了一段时间。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-09T18:45:07.777

在我看来，更好的解决方案是从堆栈中展开场景破坏调用。使用 NSTimer+BlockKit 之类的东西可以让它变得非常干净。这是我的代码的摘录：

```
- (void)menuAction
{
    // we use a timer here to delay the execution of the action because it
    // destroys the current scene and we're mid a call on CCMenu's ccTouchEnded
    // that isn't expecting a scene tear down
    // http://stackoverflow.com/questions/11165822/exc-bad-access-occurring-when-cocos2d-calls-cctouchended-in-ccmenu
    [NSTimer scheduledTimerWithTimeInterval:0 block:^(NSTimer* timer)
    {
       [[CCDirector sharedDirector] popSceneWithTransition:
         [CCTransitionSlideInL class] duration:kTransDur];
    }
    repeats:NO];
} 
```

# python - 与 uWSGI 一起使用时模块级变量是否安全？

> ID：11165827
> 
> 赞同：3
> 
> 时间：2012-06-23T00:43:28.640
> 
> 标签：python, django, scope, uwsgi

我看到一个奇怪的错误，我在模块范围内创建的变量（例如，在定义任何类或函数之前在文件顶部）随着时间的推移表现不同。这个变量（我们称之为`_cache`）被拉入我的类：

```
_cache = None

class XMLGenerator(object):
    global _cache

    def __init__(self, parms):
        if _cache is None:
             _cache = expensive_query(parms) 
```

此缓存的结果可能会有所不同，具体取决于进入 Web 服务的请求的上下文，但我看到在对同一服务的调用之间生成的 XML 输出中的行为不同：我可以重新启动服务器，一切都很好，但是最终异常行为再次开始。

uWSGI 是否以某种方式在请求之间保留状态？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-12-28T04:36:31.950

我想回过头来解释这里发生了什么。事实上，全局变量不会在 uWSGI 中对同一服务的请求之间“刷新”。因此，如果您创建一个模块级变量，它将在多个请求之间携带状态。显然，这不是我想要的。所以我最终在不同的调用之间传递了一个缓存对象到`XMLGenerator`. 它导致 API 非常难看，但避免了模块级变量的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-24T18:09:08.290

如果您使用多个工作人员执行此操作，那么您可能想要使用 uwsig 的 CachingFramework：

```
http://projects.unbit.it/uwsgi/wiki/CachingFramework 
```

否则，我相信 _cache 在工作人员中可能会有所不同。

此外，您可以使用 uwsgi --processes 1 进行测试以查看问题是否消失。

# html - 为什么输入图像不起作用？

> ID：11165831
> 
> 赞同：0
> 
> 时间：2012-06-23T00:43:52.177
> 
> 标签：html, css, input

我正在尝试使用 type="image" 作为提交按钮。不是它不工作。

```
<input type="image" SRC="http://bin.xxx/images/free_download_continue.png" name="method_free" value="Free Download"> 
```

不适合

```
<input type="submit" name="method_free" value="<TMPL_VAR lang_free_download>"> 
```

当我这样做时，我[http://jsfiddle.net/DXBgp/](http://jsfiddle.net/DXBgp/)得到一个错误

但是当我这样做时[http://jsfiddle.net/EFjbx/](http://jsfiddle.net/EFjbx/)它可以工作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T01:00:28.200

好吧，我认为您把它们弄混了，[http://jsfiddle.net/DXBgp/](http://jsfiddle.net/DXBgp/)有效而[http://jsfiddle.net/EFjbx/](http://jsfiddle.net/EFjbx/)无效，对吗？

在以下位置查看此问题：[如何在提交按钮中设置背景图像？](https://stackoverflow.com/questions/2444894/how-to-set-background-image-in-submit-button). 您应该能够在按钮上使用 CSS 添加背景图像。

# javascript - 插入sqlite后的window.location不起作用

> ID：11165832
> 
> 赞同：0
> 
> 时间：2012-06-23T00:43:52.927
> 
> 标签：javascript, sqlite, cordova

我正在使用phonegap + sqlite。

我正在尝试插入一些东西。

这是代码-

```
function insertDB() {
        var sqlI = "INSERT INTO post_data(post_text,pdate) VALUES("Hello, world","23-05-2012");
        mydb.transaction(
                             function(transaction) {
                             transaction.executeSql(sqlI, [], nullDataHandler, errorHandler); 
                             });
        console.log("inserted");
        window.location="dashboard.html";
} 
```

当我删除该行`window.location="dashboard.html"`或设置 1000 毫秒的延迟时，我可以插入数据，然后执行`window.location="dashboard.html"`. 但是上面的代码不起作用。为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T00:57:12.087

我认为该`transaction`功能是异步的。尝试将重定向放在上面：

```
mydb.transaction(
    function(transaction) {
        transaction.executeSql(
            sqlI, 
            [],  
            function(transaction, results){
                // passing transaction and results in case you have to display some returned statements
                window.location="dashboard.html";
            },
            nullDataHandler
        ); 
}); 
```

如您所见，重定向将在 resultHandler 中处理。

# html - Opera 目标属性

> ID：11165835
> 
> 赞同：0
> 
> 时间：2012-06-23T00:44:27.450
> 
> 标签：html, anchor, opera, target

所以浏览器之间的兼容性差异让我更加抓狂，所以 html 和 css 的呈现

所以在歌剧版本 11.64 `<a href="/folder/" target="_blank">link</a>`

在 Firefox 中按预期工作，但歌剧没有在新窗口中打开

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-24T03:07:06.620

这由 Opera 中的首选项控制：opera:config > User Prefs > Ignore Target。

# c# - 复合异步调用 - 如何？

> ID：11165840
> 
> 赞同：2
> 
> 时间：2012-06-23T00:45:15.330
> 
> 标签：c#, .net, asynchronous, begininvoke

假设，我的`IAsynchronous`接口支持两种执行某些操作的方法（“开始/结束”模式）：

*   `IAsyncResult BeginOperation(AsyncCallback callback, object state)`
*   `EndOperation(IAsyncResult ar)`

还假设我有课程`A : IAsynchronous`和`B : IAsynchronous`. 我必须实现这个`Compound : IAsynchronous`类。'的`Compound`操作是调用`A`' 的操作，等待其完成，然后调用`B`' 的操作，然后像往常一样调用回调。

问题是如何设计`Compound`类：

*   我应该保留原始对象并在' 操作完成`state`时调用原始回调。`Compound`因此，我不能简单地将它们传递给`A.BeginOperation`or `B.BeginOperation`。
*   此外，`Compound.EndOperation`应该重新抛出由`A.EndOperation`or抛出的任何异常`B.EndOperation`。如果`A.EndOperation`已引发异常，则`Compound`不应调用 ' 操作，`B.EndOperation`因为复合操作已失败。
*   如果不仅有 2 个内部操作，而且有 3 个或更多，该怎么办？有没有通用的方法？

为了澄清，请考虑以下示例。假设我们有一个`Multiplier`支持以下方法的类：

*   `IAsyncResult BeginMultiply(LargeNumber x, LargeNumber y, AsyncCallback callback, object state)`
*   `LargeNumber EndMultiply(IAsyncResult ar)`

并且您要编写`ThreeMultiplier`支持以下方法的类：

*   `IAsyncResult BeginMultiply(LargeNumber x, LargeNumber y, LargeNumber z, AsyncCallback callback, object state)`
*   `LargeNumber EndMultiply(IAsyncResult ar)`

该类`ThreeMultiplier`应使用`Multiplier`该类进行计算`x * y * z`。为了做到这一点，它首先计算`x * y`（通过`Multiplier.Begin/EndMultiply`），然后将结果乘以`z`。当然，可以在任何步骤`Multiplier.EndMultiply`抛出`SomeException`哪个计算失败。`x * y * z`

实现这一点的最佳（或好的）方法是什么？有没有图案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-23T04:00:11.273

在编写新代码时，我会避免使用 APM（异步编程模型：使用 IAsyncResult 和 Begin* 和 End*）。

在 Visual Studio 2010 中，引入了任务并行库 (TPL)，同时引入了任务异步模式 (TAP)。这种模式是支持 VS 2012 (C# 5) 中新的 async/await 关键字的底层框架 API 的基础。您可以使用 Task.FromAsync(); 包装 APM 实现；但如果您正在编写新代码，那么使用 Task/Task 将是未来更好的选择。

使用 TAP，您可以使用 Task 对象包装委托，该对象将异步执行委托。然后，您可以“继续”其他异步任务，这些任务将在第一个委托完成时运行。例如，如果您有两个委托，其中一个需要在另一个完成时运行，您可以这样做：

```
 Task.Factory.StartNew(() => MyMethod())
            .ContinueWith(() => MyOtherMethod()); 
```

您可以将其包装在一个方法中：

```
public void AsyncCompound(Action firstAcction, Action secondAction)
{
            Task.Factory.StartNew(firstAction)
                .ContinueWith(secondAction);
} 
```

...比定义 IAsyncResult 类和实现 Begin 和 End 方法的工作要少得多。

至于 .NET 3.5——流行的模式是 APM——没有始终可用的“任务”类。有一些 TPL 实现可能有效，但我没有使用它们。或者，您可以查看[Reactive Extensions](http://msdn.microsoft.com/en-us/devlabs/gg577609)，因为它是实现异步操作的另一种方式——尽管是基于事件的。

APM 会很快变得冗长，因此，我建议尽可能使用委托。我还建议重新使用 IAsyncResult 实现，例如[http://msdn.microsoft.com/en-us/magazine/cc163467.aspx](http://msdn.microsoft.com/en-us/magazine/cc163467.aspx)上的实现 例如：

```
public class Multiplier
{
    public LargeNumber Multiply(LargeNumber x, LargeNumber y)
    {
        return x * y;
    }

    public IAsyncResult BeginMultiply(LargeNumber x, LargeNumber y, AsyncCallback callback, object state)
    {
        AsyncResult<LargeNumber> ar = new AsyncResult<BigInteger>(callback, state);
        ThreadPool.QueueUserWorkItem(o =>
        {
            var asyncResult = (AsyncResult<LargeNumber>)o;
            try
            {
                var largeNumber = Multiply(x, y);
                asyncResult.SetAsCompleted(largeNumber, false);
            }
            catch (Exception e)
            {
                asyncResult.SetAsCompleted(e, false);
            }
        }, ar);
        return ar;
    }

    public LargeNumber EndMultiply(IAsyncResult asyncResult)
    {
        var ar = (AsyncResult<LargeNumber>)asyncResult;

        return ar.EndInvoke();
    }

    public IAsyncResult BeginMultiply(LargeNumber x, LargeNumber y, LargeNumber z, AsyncCallback callback, object state)
    {
        AsyncResult<LargeNumber> ar = new AsyncResult<LargeNumber>(callback, state);

        BeginMultiply(x, y, (asyncResult1) =>
        {
            var firstResult = EndMultiply(asyncResult1);
            BeginMultiply(firstResult, z, (asyncResult2) =>
            {
                var secondResult = EndMultiply(asyncResult2);
                ar.SetAsCompleted(secondResult, true);
            }, state);
        }, state);
        return ar;
    }
} 
```

然后可以按如下方式使用它来异步计算一个值并返回到当前线程：

```
var asyncResult = multiplier.BeginMultiply(x, y, z, ar => { }, null);
var result = multiplier.EndMultiply(asyncResult); 
```

或者，您可以链接到要在后台线程上执行的其他代码：

```
 multiplier.BeginMultiply(x, y, z, ar =>
                                          {
                                            var result = multiplier.EndMultiply(ar);
                                            /* TODO: something with result on this background thread */
                                          }, null); 
```

...由您决定如何在需要的地方获得该结果，以及如何与调用 BeginMultiply 的线程交互（如果有的话）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-23T04:47:06.130

如果您想实现其他一些组合异步操作的好方法 - 请查看 Richter 的[Simplified APM With The AsyncEnumerator](http://msdn.microsoft.com/en-us/magazine/cc546608.aspx)和[下一部分](http://msdn.microsoft.com/en-us/magazine/cc721613.aspx)，它允许使用创建的迭代器编写几乎顺序的代码`yield`。

该库从 Wintellect 网站[下载。](http://www1.wintellect.com/Resources/Details/76)

使用示例 -[使用 AsyncEnumerator](https://stackoverflow.com/questions/4140892/working-with-asyncenumerator)

# ruby-on-rails - 在 Heroku 上的 Rails 3 中保存可编辑数据

> ID：11165844
> 
> 赞同：1
> 
> 时间：2012-06-23T00:46:18.263
> 
> 标签：ruby-on-rails, ruby, file, heroku, persistence

我的 rails 应用程序允许用户通过浏览器编辑某个 json 文件。此数据文件保存在`app/assets/data/thefile.json`（本站仅供内部使用）

我在本地测试了前端，它运行良好，数据得到更新和保存。然后我将代码推送到 Heroku 并在那里进行了测试。有效。然而，大约 1 天后，当我回到网站时，我意识到数据已经恢复到编辑之前的原始状态。

这发生了很多次，我不太确定为什么会发生。也许是因为 Heroku 不允许`app`编辑文件夹中的文件？

任何建议将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T01:33:33.637

可能与 Heroku 具有[只读文件系统](https://devcenter.heroku.com/articles/read-only-filesystem)这一事实有关。

这里还有一个关于[临时文件系统的注释](https://devcenter.heroku.com/articles/dynos#ephemeral_filesystem)

> 每个 dyno 都有自己的临时文件系统，以及最近部署的代码的新副本。在 dyno 的生命周期中，它的运行进程可以将文件系统用作临时暂存器，但是任何其他 dyno 中的进程都看不到写入的文件，并且在 **停止或重新启动 dyno 时，写入的任何文件都将被丢弃。**

# java - Java 单例和同步

> ID：11165852
> 
> 赞同：129
> 
> 时间：2012-06-23T00:47:34.173
> 
> 标签：java, multithreading, synchronization, singleton

请澄清我对单例和多线程的疑问：

*   在多线程环境中，在 Java 中实现 Singleton 的最佳方法是什么？
*   当多个线程同时尝试访问`getInstance()` 方法时会发生什么？
*   我们可以做单例`getInstance()` `synchronized`吗？
*   使用单例类时真的需要同步吗？

* * *

## 回答 #1

> 赞同：223
> 
> 时间：2012-06-23T01:01:07.057

是的，这是必要的。您可以使用几种方法通过延迟初始化来实现线程安全：

严苛的同步：

```
private static YourObject instance;

public static synchronized YourObject getInstance() {
    if (instance == null) {
        instance = new YourObject();
    }
    return instance;
} 
```

这个解决方案要求*每个*线程都同步，而实际上只需要前几个。

[双重检查同步](http://en.wikipedia.org/wiki/Double-checked_locking#Usage_in_Java)：

```
private static final Object lock = new Object();
private static volatile YourObject instance;

public static YourObject getInstance() {
    YourObject r = instance;
    if (r == null) {
        synchronized (lock) {    // While we were waiting for the lock, another 
            r = instance;        // thread may have instantiated the object.
            if (r == null) {  
                r = new YourObject();
                instance = r;
            }
        }
    }
    return r;
} 
```

此解决方案确保只有前几个尝试获取单例的线程必须通过获取锁的过程。

[按需初始化](https://en.wikipedia.org/wiki/Initialization-on-demand_holder_idiom)：

```
private static class InstanceHolder {
    private static final YourObject instance = new YourObject();
}

public static YourObject getInstance() {
    return InstanceHolder.instance;
} 
```

该解决方案利用 Java 内存模型对类初始化的保证来确保线程安全。每个类只能加载一次，只有在需要的时候才会加载。这意味着第一次`getInstance`被调用，`InstanceHolder`将被加载并被`instance`创建，并且由于这是由`ClassLoader`s 控制的，因此不需要额外的同步。

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2012-06-23T01:09:23.277

*这种模式在没有*显式同步的情况下对实例进行线程安全的延迟初始化！

```
public class MySingleton {

     private static class Loader {
         static final MySingleton INSTANCE = new MySingleton();
     }

     private MySingleton () {}

     public static MySingleton getInstance() {
         return Loader.INSTANCE;
     }
} 
```

它之所以有效，是因为它使用类加载器免费为您完成所有同步：`MySingleton.Loader`首先在方法内部访问该类`getInstance()`，因此在第一次调用`Loader`该类时加载该类`getInstance()`。此外，类加载器保证所有静态初始化在您访问该类之前完成 - 这就是为您提供线程安全的原因。

这就像魔术一样。

它实际上与 Jhurtado 的枚举模式非常相似，但我发现枚举模式滥用了枚举概念（尽管它确实有效）

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2012-06-23T01:01:53.320

如果您在 Java 中的多线程环境中工作并且需要保证所有这些线程都在访问一个类的单个实例，那么您可以使用 Enum。这将具有帮助您处理序列化的额外优势。

```
public enum Singleton {
    SINGLE;
    public void myMethod(){  
    }
} 
```

然后让您的线程使用您的实例，例如：

```
Singleton.SINGLE.myMethod(); 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-06-23T00:49:35.160

是的，您需要进行`getInstance()`同步。如果不是这样，可能会出现可以创建类的多个实例的情况。

考虑有两个线程同时调用`getInstance()`的情况。现在想象一下 T1 在`instance == null`检查之后执行，然后 T2 运行。此时实例尚未创建或设置，因此 T2 将通过检查并创建实例。现在想象执行切换回 T1。现在单例已创建，但 T1 已完成检查！它将继续制作对象！使`getInstance()`同步可以防止这个问题。

有几种方法可以使单例线程安全，但`getInstance()`同步可能是最简单的。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-10-02T11:35:28.067

枚举单例

实现线程安全的单例的最简单方法是使用枚举

```
public enum SingletonEnum {
  INSTANCE;
  public void doSomething(){
    System.out.println("This is a singleton");
  }
} 
```

自从在 Java 1.5 中引入 Enum 以来，此代码就可以工作

双重检查锁定

如果你想编写一个在多线程环境中工作的“经典”单例（从 Java 1.5 开始），你应该使用这个。

```
public class Singleton {

  private static volatile Singleton instance = null;

  private Singleton() {
  }

  public static Singleton getInstance() {
    if (instance == null) {
      synchronized (Singleton.class){
        if (instance == null) {
          instance = new Singleton();
        }
      }
    }
    return instance ;
  }
} 
```

这在 1.5 之前不是线程安全的，因为 volatile 关键字的实现不同。

早期加载 Singleton（甚至在 Java 1.5 之前也可以使用）

此实现在加载类时实例化单例并提供线程安全。

```
public class Singleton {

  private static final Singleton instance = new Singleton();

  private Singleton() {
  }

  public static Singleton getInstance() {
    return instance;
  }

  public void doSomething(){
    System.out.println("This is a singleton");
  }

} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-06-12T18:44:49.790

您还可以使用静态代码块在类加载时实例化实例并防止线程同步问题。

```
public class MySingleton {

  private static final MySingleton instance;

  static {
     instance = new MySingleton();
  }

  private MySingleton() {
  }

  public static MySingleton getInstance() {
    return instance;
  }

} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-06-27T09:30:30.980

> 在多线程环境中，在 Java 中实现 Singleton 的最佳方法是什么？

请参阅这篇文章以了解实现 Singleton 的最佳方法。

[在 Java 中实现单例模式的有效方法是什么？](https://stackoverflow.com/questions/70689/what-is-an-efficient-way-to-implement-a-singleton-pattern-in-java/37764478#37764478)

> 当多个线程同时尝试访问 getInstance() 方法时会发生什么？

这取决于您实现该方法的方式。如果您使用没有 volatile 变量的双重锁定，您可能会得到部分构造的 Singleton 对象。

有关更多详细信息，请参阅此问题：

[为什么在这个双重检查锁定示例中使用 volatile](https://stackoverflow.com/questions/7855700/why-is-volatile-used-in-this-example-of-double-checked-locking/)

> 我们可以使单例的 getInstance() 同步吗？
> 
> 使用单例类时真的需要同步吗？

如果您通过以下方式实现 Singleton，则不需要

1.  静态初始化
2.  枚举
3.  LazyInitalaization 与 Initialization-on-demand_holder_idiom

有关更多详细信息，请参阅此问题

[Java 单例设计模式：问题](https://stackoverflow.com/questions/3428615/java-singleton-design-pattern-interview-question/36100122#36100122)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-01-02T22:18:55.277

```
public class Elvis { 
   public static final Elvis INSTANCE = new Elvis();
   private Elvis () {...}
 } 
```

来源：有效的 Java -> 第 2 项

它建议使用它，如果您确定该类将始终保持单例。

# iphone - 核心数据获取非常慢

> ID：11165855
> 
> 赞同：6
> 
> 时间：2012-06-23T00:47:54.830
> 
> 标签：iphone, objective-c, ios, cocoa, core-data

我正在运行一个非常基本的 NSFetchRequest 来获取实体 MessageObject。我只有 2000 个消息对象，我想全部检索它们。但是，由于某些奇怪的原因，获取请求需要超过 10 秒！

```
NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
NSEntityDescription *entity = [NSEntityDescription entityForName:@"MessageObject" inManagedObjectContext:appDelegate.managedObjectContext];
[fetchRequest setEntity:entity];
NSSortDescriptor *sort= [[NSSortDescriptor alloc] initWithKey:@"createDate" ascending:NO selector:@selector(compare:)];
[fetchRequest setSortDescriptors:[NSArray arrayWithObject:sort]];
[fetchRequest setFetchBatchSize:5]; 
```

就是这样，这就是我的获取请求。我什至没有使用谓词，它需要超过 10 秒。我对可能导致这种情况的原因一无所知。如果有人有任何想法或起点，请分享。

我也尝试过启用 SQLite 调试日志 ( `-com.apple.CoreData.SQLDebug 1`)，但我只是从这个简单的提取中获得了数千行输出。这正常吗？

```
 2012-06-22 19:39:59.171 myapp[81825:15e03] about to execute fetch
 2012-06-22 19:39:59.172 myapp[81825:15e03] CoreData: sql: SELECT 0, t0.Z_PK FROM ZMBNOTEOBJECT t0 ORDER BY t0.ZCREATEDATE DESC
 2012-06-22 19:39:59.178 myapp[81825:15e03] CoreData: annotation: sql connection fetch time: 0.0061s
 2012-06-22 19:39:59.179 myapp[81825:15e03] CoreData: annotation: total fetch execution time: 0.0067s for 2052 rows.
 2012-06-22 19:39:59.179 myapp[81825:15e03] CoreData: sql: SELECT 0, t0.Z_PK, t0.Z_OPT, t0.ZAUTHOREMAIL, t0.ZAUTHORNAME, t0.ZCREATEDATE, t0.ZISGLOBAL, t0.ZISLOCKED, t0.ZISNEW, t0.ZISPENDINGDELETE, t0.ZISPENDINGLIKE, t0.ZISPENDINGREAD, t0.ZISPENDINGSYNC, t0.ZLASTUPDATED, t0.ZLOCALLYMODIFIEDDATE, t0.ZMAINIDEA, t0.ZMETALASTUPDATED, t0.ZNOTEID, t0.ZNUMBEROFCHILDREN, t0.ZPARENTAUTHOREMAIL, t0.ZPARENTNOTEID, t0.ZROOTAUTHOREMAIL, t0.ZROOTNOTEID, t0.Z4PENDINGADDNOTES, t0.Z4PENDINGREMOVENOTES FROM ZMBNOTEOBJECT t0 WHERE  t0.Z_PK IN  (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  ORDER BY t0.ZCREATEDATE DESC LIMIT 15
 2012-06-22 19:39:59.180 myapp[81825:15e03] CoreData: annotation: sql connection fetch time: 0.0008s
 2012-06-22 19:39:59.181 myapp[81825:15e03] CoreData: annotation: total fetch execution time: 0.0018s for 15 rows.
 2012-06-22 19:39:59.182 myapp[81825:15e03] CoreData: sql: SELECT 0, t0.Z_PK, t0.Z_OPT, t0.ZAUTHOREMAIL, t0.ZAUTHORNAME, t0.ZCREATEDATE, t0.ZISGLOBAL, t0.ZISLOCKED, t0.ZISNEW, t0.ZISPENDINGDELETE, t0.ZISPENDINGLIKE, t0.ZISPENDINGREAD, t0.ZISPENDINGSYNC, t0.ZLASTUPDATED, t0.ZLOCALLYMODIFIEDDATE, t0.ZMAINIDEA, t0.ZMETALASTUPDATED, t0.ZNOTEID, t0.ZNUMBEROFCHILDREN, t0.ZPARENTAUTHOREMAIL, t0.ZPARENTNOTEID, t0.ZROOTAUTHOREMAIL, t0.ZROOTNOTEID, t0.Z4PENDINGADDNOTES, t0.Z4PENDINGREMOVENOTES FROM ZMBNOTEOBJECT t0 WHERE  t0.Z_PK IN  (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  ORDER BY t0.ZCREATEDATE DESC LIMIT 15
 2012-06-22 19:39:59.186 myapp[81825:15e03] CoreData: annotation: sql connection fetch time: 0.0042s
 2012-06-22 19:39:59.187 myapp[81825:15e03] CoreData: annotation: total fetch execution time: 0.0049s for 15 rows.
 2012-06-22 19:39:59.187 myapp[81825:15e03] CoreData: sql: SELECT 0, t0.Z_PK, t0.Z_OPT, t0.ZAUTHOREMAIL, t0.ZAUTHORNAME, t0.ZCREATEDATE, t0.ZISGLOBAL, t0.ZISLOCKED, t0.ZISNEW, t0.ZISPENDINGDELETE, t0.ZISPENDINGLIKE, t0.ZISPENDINGREAD, t0.ZISPENDINGSYNC, t0.ZLASTUPDATED, t0.ZLOCALLYMODIFIEDDATE, t0.ZMAINIDEA, t0.ZMETALASTUPDATED, t0.ZNOTEID, t0.ZNUMBEROFCHILDREN, t0.ZPARENTAUTHOREMAIL, t0.ZPARENTNOTEID, t0.ZROOTAUTHOREMAIL, t0.ZROOTNOTEID, t0.Z4PENDINGADDNOTES, t0.Z4PENDINGREMOVENOTES FROM ZMBNOTEOBJECT t0 WHERE  t0.Z_PK IN  (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)  ORDER BY t0.ZCREATEDATE DESC LIMIT 15
 2012-06-22 19:39:59.188 myapp[81825:15e03] CoreData: annotation: sql connection fetch time: 0.0008s
 2012-06-22 19:39:59.189 myapp[81825:15e03] CoreData: annotation: total fetch execution time: 0.0014s for 15 rows.
... (thousands of more lines similar to above) 
```

我对阅读这篇文章不是很熟悉，但它似乎在 0.0067 秒内获取了 2052 行。那么为什么在那之后它继续做更多的事情呢？如果完成获取行，请求不应该完成吗？是数据有问题还是什么？

此外，我已经删除了 setFetchBatchSize - 它摆脱了数千行，但获取请求仍然需要很长时间。这是我得到的输出：

```
2012-06-22 20:07:25.316 myapp[8927:707] about to execute fetch
 2012-06-22 20:07:25.322 myapp[8927:707] CoreData: sql: SELECT 0, t0.Z_PK, t0.Z_OPT, t0.ZAUTHOREMAIL, t0.ZAUTHORNAME, t0.ZCREATEDATE,t0.ZISLOCKED, t0.ZISNEW, t0.ZISPENDINGDELETE, t0.ZISPENDINGSYNC, t0.ZLASTUPDATED, t0.ZLOCALLYMODIFIEDDATE, t0.ZMAINIDEA, t0.ZMETALASTUPDATED, t0.ZNOTEID, t0.ZNUMBEROFCHILDREN, t0.ZPARENTAUTHOREMAIL, t0.ZPARENTNOTEID, t0.ZROOTAUTHOREMAIL, t0.ZROOTNOTEID, t0.Z4PENDINGADDNOTES, t0.Z4PENDINGREMOVENOTES FROM ZMBNOTEOBJECT t0 ORDER BY t0.ZCREATEDATE DESC
 2012-06-22 20:07:26.758 myapp[8927:707] CoreData: annotation: sql connection fetch time: 1.0891s
 2012-06-22 20:07:26.763 myapp[8927:707] CoreData: annotation: total fetch execution time: 1.4407s for 4000 rows.
 2012-06-22 20:07:35.967 myapp[8927:707] finished fetching 
```

奇怪的是，在 20:07:26.763，它显然表示 4000 行需要 1.4407 秒，但不是再过 9 秒，我得到的输出是“完成获取”（这是一个出现在 NSLog 之后的语句`[[self fetchedResultsController] performFetch:&error]`）这是怎么回事那？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T00:54:20.610

删除 setFetchBatchSize。

如果您的意图是一次加载所有内容，只需将其删除。

此外，如果您需要加载所有属性，请添加：

```
fetchRequest.returnsObjectsAsFaults = NO; 
```

它将加载每个实体并填充属性。

您可能只想加载某些属性，因此使用它来选择您需要的内容：

```
fetchRequest.propertiesToFetch = ... 
```

你完成了。

# javascript - JavaScript：有没有更好的方法来做一个带有回调函数的 for 循环？

> ID：11165856
> 
> 赞同：3
> 
> 时间：2012-06-23T00:48:07.117
> 
> 标签：javascript, callback

```
for(var i=1; i<496; i++) {
    (function(num) {
        myApp.getTerm(num, function (term, def){
            myApp.quizlet[0].terms[num] = { term: term, definition: def};
        });         
    })(i);
}; 
```

我在 for 循环中调用带有回调的函数。*回调函数需要访问当前循环的迭代*i 。我想出了上面的解决方案。

**有没有其他方法可以做这样的事情？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T01:08:11.937

您正在做的事情并非不合理，应该可以正常工作。纯粹在可读性层面上，我可能会选择

```
for(var i=1; i<496; i++) {
    function get_callback(n) {
        return function(term, def) {
            myApp.quizlet[0].terms[n] = { term: term, definition: def};
         };
    }
    myApp.getTerm(i, get_callback(i));         
}; 
```

如果您习惯使用 Function.bind：

```
function callback (n, term, def) {
    myApp.quizlet[0].terms[n] = { term: term, definition: def};
}
for(var i=1; i<496; i++) {
    myApp.getTerm(i, callback.bind(this,i));
} 
```

我们将第一个参数绑定到，从而产生一个采用and参数`i`的“咖喱”函数。`term``def`

然后当然有这个可怕的黑客，不要在家里尝试这个。

```
for(var i=1; i<496; i++) {
    try { throw i; }
    catch (i) {
        myApp.getTerm(i, function (term,def) {
             myApp.quizlet[0].terms[i] = { term: term, definition: def};
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-23T01:00:17.263

定义要调用的命名函数更具可读性：

```
myApp.getTermForQuizzlet = function(num){
    myApp.getTerm(num, function (term, def){
        myApp.quizlet[0].terms[num] = { term: term, definition: def };
    });         
};

for(var i=1; i<496; i++) {
    myApp.getTermForQuizzlet(i);
}; 
```

除此之外，我不知道你还能做什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-23T01:01:40.800

循环内部的结构称为[立即调用函数表达式](http://benalman.com/news/2010/11/immediately-invoked-function-expression/)(IIFE)。

例如，当您在循环中创建事件处理程序并希望为每个事件处理程序锁定循环变量的当前值以供以后使用时，IIFE 可能很有用。这种“锁定”称为[（词法或函数）闭包](http://en.wikipedia.org/wiki/Closure_%28computer_science%29)：外部函数（在您的情况下为 IIFE）的词法范围，包括任何常量、局部变量和参数值（在您的情况下`num`为 IIFE 的参数，其中是循环变量的实际值），成为每个内部函数对象（在您的情况下，传递给的回调函数`myApp.getTerm`）的内部状态的一部分，即使在外部函数（IIFE）执行结束之后也是如此。

所以我认为你这样做是对的，在你的情况下使用 IIFE 是一个完全有效的解决方案。

这种模式的一个有趣的例子（闭包的 IIFE）可以在[John Resig 的继承实现中](http://ejohn.org/blog/simple-javascript-inheritance/)找到：

```
// ...
(function(name, fn){
  return function() {
    // use name and fn here
  };
})(name, prop[name])
// ... 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-23T01:02:02.223

大多数时候，我使用迭代函数而不是 bulidtin 循环。它们在较新的浏览器和大多数 JS 库中可用：

```
array.forEach(function(item, i){
    //We can freely use "item" and "i" in callbacks without worrying
    setTimeout( function(){ console.log(item, i) }, 1000 );
}); 
```

这通常比 for-loop 版本更短（如果您至少在数组上迭代）并且它避免了“免费”的闭包循环错误，而无需添加额外的立即调用函数或类似的东西那。

此方法的主要缺点是它不支持使用“this”和使用 break、continue 和 return 语句以及内置循环，并且大多数库仅提供用于数组或字典迭代的函数，不支持更多一般循环样式。虽然我很少最终需要这种高级功能，但当它出现时，我通常只使用额外的闭包（就像你所做的那样），或者，如果它是一种常见的模式，则编写我自己的迭代器函数。

```
var forLoop = function(i0, n, f){
    for(var i=i0; i<n; i++){
        f(i);
    }
};

forLoop(1, 496, function(i){
    myApp.getTerm(i, function(term, def){
        myApp.quizlet[0].terms[i] = { ... }
    });
}); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-23T02:50:59.390

似乎您基本上希望

1.  创建应用程序，myApp；
2.  将属性 .quiz 添加到 myApp；
3.  将属性 .terms 添加到 .quiz；
4.  对于测验中的每个术语，形成一个对象以将每个术语与其定义相关联。

要设置您需要的属性，您可以执行以下操作..

```
var terms = ['js', 'php', 'css', 'html', 'as3'];
var defin = ['about js', 'about php', 'about css', 'about html', 'about as3'];
var myApp = {};
myApp.quiz = new Array;
myApp.quiz[0] = [];
myApp.quiz[0].terms = new Array;

terms.forEach(function(ele, idx){
    myApp.quiz[0].terms[idx] = {term: terms[idx], def: defin[idx]};
}) 
```

现在，您需要一种方法来访问任何测验中的任何术语。所以你可以用一个函数来做到这一点，比如 ..

```
function getTerm(qn, tn){
  return myApp.quiz[qn].terms[tn];
}
var q0t2 = getTerm(0, 2);
console.log(q0t2); // def: "about css", term: "css" 
```

我不太确定您的需求是什么，但这是我最好的猜测。如果您的情况不适合我在这里使用的那种方法，请详细说明。:)

# android - AsyncTask.onCancelled() 在 cancel(true) 之后没有被调用

> ID：11165860
> 
> 赞同：8
> 
> 时间：2012-06-23T00:50:01.343
> 
> 标签：android, android-asynctask

在 2.3.6 设备上运行的 Android SDK v15。

我有一个问题，`onPostExecute()`当我在通话`cancel()`中打电话时仍然被`doInBackground()`调用。

这是我的代码：

```
@Override
public String doInBackground(String... params) {
    try {
        return someMethod();
    } catch (Exception e) {
        cancel(true);
    }

    return null;
}

public String someMethod() throws Exception {
    ...
} 
```

我被迫`someMethod()`抛出一个异常来测试它，而不是 onCancelled 被调用，我总是返回到`onPostExecute()`. 如果我检查`isCancelled()`返回值是否为真，那么我知道它`cancel(true)`正在执行。

有任何想法吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-12-13T01:03:24.177

根据Android API文档，`onCancelled()`从API级别3开始就存在，而`onCancelled(Object result)`从API级别11开始才添加。因此，如果平台API级别低于11，`onCancelled()`将*始终*调用，否则将*始终*`onCancelled(Object)`调用。

 *因此，如果您想在所有 API 级别 3 及更高级别上运行您的代码，您需要实现这两种方法。为了获得相同的行为，您可能希望将结果存储在实例变量中，以便`isCancelled()`可以如下所示使用：

```
public class MyTask extends AsyncTask<String, String, Boolean> {
  private Boolean result;
  // . . .
  @Override
  protected void onCancelled() {
    handleOnCancelled(this.result);
  }
  @Override
  protected void onCancelled(Boolean result) {
    handleOnCancelled(result);
  }
  //Both the functions will call this function
  private void handleOnCancelled(Boolean result) {
    // actual code here
  }
} 
```

顺便说一句，Eric 的代码不太可能工作，因为 Android API 文档说：

> 调用该`cancel()`方法将导致 返回`onCancelled(Object)`后在 UI 线程上调用。**调用 cancel() 方法保证** **永远不会被调用。**`doInBackground(Object[])`**`onPostExecute(Object)`**

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-06-23T01:17:07.160

`onCancelled`仅从 Android API 级别 11 (Honeycomb 3.0.x) 起受支持。这意味着，在 Android 2.3.6 设备上，它不会被调用。

你最好的选择是把它放在`onPostExecute`：

```
protected void onPostExecute(...) {
    if (isCancelled() && Build.VERSION.SDK_INT < Build.VERSION_CODES.HONEYCOMB) {
        onCancelled();
    } else {
        // Your normal onPostExecute code
    }
} 
```

如果你想避免版本检查，你可以这样做：

```
protected void onPostExecute(...) {
    if (isCancelled()) {
        customCancelMethod();
    } else {
        // Your normal onPostExecute code
    }
}
protected void onCancelled() {
    customCancelMethod();
}
protected void customCancelMethod() {
    // Your cancel code
} 
```

希望有帮助！:)*

# 3d - 如何使用凸轮四元数计算物体相对于相机的方位角和仰角......？

> ID：11165863
> 
> 赞同：1
> 
> 时间：2012-06-23T00:50:44.877
> 
> 标签：3d, camera, vector-graphics, quaternions

我有一个相机四元数 (a,b,c,d) 和一个凸轮位置 (camX, camY, camZ) 我有一个具有 3d 坐标 (x,y,z) 的对象

我需要计算方位角，物体相对于凸轮视图方向和平面的仰角。

第一个问题如果我把物体放在我的视野中心，f我旋转凸轮，平移它，我应该有相同的方位角值，对吧？？我没有那个。

第二个问题，计算。我正在做对象坐标 - 凸轮位置，以便将对象转换为凸轮。我得到了结果坐标，并用四元数及其共轭制作了三明治产品。（我遵循这个伪代码： http: [//fr.wikipedia.org/wiki/Quaternions_et_rotation_dans_l'espace](http://fr.wikipedia.org/wiki/Quaternions_et_rotation_dans_l%27espace)）

然后，我有一个向量结果，我取 X & Z 分量并计算 atan2

看起来对吗？

任何线索或解释都会在我的斗争中帮助我很多

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-06T15:05:21.800

您描述的第二个计算似乎非常接近正确，但是您应该验证几个基本假设。我稍后会讨论这些。但是，您的第一个问题没有意义。

旋转和平移几乎都会改变方位角值。如果你直视物体，`azimuth==0`. 如果再向左旋转 90°，方位角显然也改变了 90°。如果你然后向前迈出一步（长度`x`），你的方位角刚刚增加了一个`atan(x/d)`度数（`d`物体在你前面的原始距离在哪里）。

至于找到方位角和仰角，您的计算取决于关于世界默认方向的假设。即，如果您的相机坐标是[0,0,0]，则四元数是身份旋转，那么相机朝向什么方向，向上的方向是什么？通常，'up'`+y`和 forward 是`-z`。如果是这种情况，那么您将这样计算：

```
p = q'*(obj-cam)*q
az = atan2(p.x,-p.z)
el = asin(p.y/sqrt(p.x*p.x + p.y*p.y + p.z*p.z)) 
```

哪里`q'`是四元数共轭/逆（只是 negate `q.w`）并且`*`是四元数乘法（`w`向量的分量设置为零）。

# javascript - jQuery POST 没有被调用

> ID：11165865
> 
> 赞同：0
> 
> 时间：2012-06-23T00:50:53.173
> 
> 标签：javascript, jquery, post

我编写了一个脚本，该脚本触发 jQuery POST 以从服务器端文件中以 JSON 格式检索数据，代码如下：

```
$.post("myfile.php", function(authDataset) {
    alert(authDataset);
}); 
```

将返回的示例是：

```
{"firstName":"x","lastName":"y","boximg":"z"} 
```

处理程序文件工作正常，当提供数据时，函数一切正常，但是 jquery POST 函数不起作用。我也尝试过 GET 和 AJAX。

**它放置在 document.ready 标记**中，我已经运行了每个错误检查器，包括 jsLint 和 jsFiddle，但由于某种原因它根本没有触发。

我在 post 函数内外使用了警报，但 post() 没有被调用。

任何人都可以提供建议吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T01:17:44.097

服务器上的 HTACCESS 文件强制使用 SSL，这违反了同源策略。

# android - Android，TabLayout（tabhost），切换选项卡会禁用第二个选项卡上的编辑文本。我该如何防止这种情况？

> ID：11165866
> 
> 赞同：0
> 
> 时间：2012-06-23T00:51:22.467
> 
> 标签：android, keyboard, focus, android-edittext, android-tabhost

我有一个选项卡布局，它由两个选项卡组成，每个选项卡都有自己的活动，所以三个活动，一个选项卡，两个内容。

这两个内容活动都包含一个按钮和一个编辑文本字段。

当我加载时，显示第一个活动，我可以单击编辑文本字段（以黄色突出显示）并且键盘出现。当我切换到第二个选项卡时，没有以黄色突出显示的编辑文本不允许我选择它来调出键盘。

如果我在此之后切换回第一个选项卡，然后切换回第二个选项卡，我可以在两者上使用键盘，并且它在应用程序的持续时间内有效。

我不希望第一次使用并解决这个问题。

我的问题是，我怎样才能让键盘在第二个选项卡的第一次出现时工作？

如果您需要任何代码，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-24T00:14:14.907

我在布局中发现，当您创建一个 edittext 字段时，XML 中有类似的内容

```
<requestfocus /> 
```

并通过删除它来修复它，在第二个选项卡上。

但是，我不知道为什么要修复它。

# scala - 未检测到数据库演变的更改

> ID：11165869
> 
> 赞同：1
> 
> 时间：2012-06-23T00:51:32.460
> 
> 标签：scala, playframework-2.0, playframework-evolutions

我目前正在尝试修复一个错误的数据库进化脚本——事实上，我的第一个（1.sql）用于 Web 应用程序。我对文件应用了修复，但未修复的文件是在我的 Specs2 测试的两个实时实例中运行的文件。

因此，例如，如果我更改：

```
CREATE  TABLE dbname.Account ( ... ); 
```

到：

```
CREATE  TABLE IF NOT EXISTS dbname.Account ( ... ); 
```

在我的进化脚本中，然后运行测试或运行实际实例，

```
CREATE  TABLE dbname.Account ( ... ); 
```

将是它仍然看到的内容，如测试日志和未正确应用进化时显示的实时实例的错误屏幕中所示。

我已经尝试清理、重新编译和删除我的目标文件夹。这些都没有奏效。有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T22:01:25.097

Play Framework Google Group 的人得到了这个。Evolution 脚本也存储在“play_evolutions”表中的数据库模式中。擦桌子解决了这个问题。清除该行可能也可以。

# ajax - onclick 使用 ajax 抓取帖子值

> ID：11165875
> 
> 赞同：0
> 
> 时间：2012-06-23T00:53:04.387
> 
> 标签：ajax, post, onclick

我已经设置了一些行，当单击**打开**时，它将执行数据库更新以将状态设置为打开票证。

但是由于某种原因，我不能带上 master $id 吗？我需要它来做一些其他的事情，并且不想在下一页上进行第二次查询或加入只是为了获取主 ID。

我的查询中有这个（我排除了所有连接代码等）：

```
<?php start query { ?>

<a href="javascript:void(0)" id="<?php echo $cid;?>" onclick="open(id)">Open</a>

<input type="hidden" id="REF<?php echo $cid;?>" value="<?php echo $id;?>">

<?php } // end query ?> 
```

我在我的ajax中有这个：

```
function open(id) {
var txt = $.ajax({
url: 'actions/open.php',
async: true,
type:'POST',
data:({
cid: id,
lid: $('#REF'+id).val()
}) 
}).success;
alert( cid,id );
setTimeout(function(){window.location.href='view.php?mode=Preview&cid='+id+'&id='+lid;},200);
} 
```

我的问题是它一直告诉我 id 在 firebug 中为空

如果我将其更改为仅获取 cid 并进行测试，它可以正常工作吗？

我已经尝试过**document.getElementById**但出于某种奇怪的原因没有任何效果？

我的代码有什么问题吗？我错过了什么吗？

在此先感谢 :) 强尼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T02:57:48.313

你的意思是让这一行调用`open`，并传递一个插值变量值？

```
<a href="javascript:void(0)" id="<?php echo $cid;?>" onclick="open(id)">Open</a> 
```

会成为

```
<a href="javascript:void(0)" id="<?php echo $cid;?>" onclick="open(<?php echo $id;?>)">Open</a> 
```

此外，在您的 AJAX 调用中，您似乎正在将一个键为 的对象分配`lid`给`$('#REF'+id).val()`. 但是，您隐藏的输入标签的 id 为`REF<?php echo $cid;?>`. 要么传递`$CID`to的值`open()`，要么使输入字段的 id 为`REF<?php echo $id;?>`

其他注意事项：看起来您正在使用 jQuery 来构建您的 AJAX 调用。您正在指定 a `async: true`，这是默认选项值。您可以从代码中省略它以获得更好的可读性。查看默认值：[http ://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

# javascript - 挂钩 jQuery 验证消息更改

> ID：11165876
> 
> 赞同：2
> 
> 时间：2012-06-23T00:53:19.213
> 
> 标签：javascript, jquery, html, css, asp.net-mvc-3

我想在工具提示中显示我的 jQuery 验证消息。为了实现这一点，我首先将以下 CSS 规则添加到我的样式表中：

```
fieldset .field-validation-error {
    display: none;
}

fieldset .field-validation-error.tooltip-icon {
    background-image: url('/content/images/icons.png');
    background-position: -32px -192px;
    width: 16px;
    height: 16px;
    display: inline-block;
} 
```

和一小段 JS 代码：

```
; (function ($) {
    $(function() {
        var fields = $("fieldset .field-validation-valid, fieldset .field-validation-error");
        fields.each(function() {
            var self = $(this);
            self.addClass("tooltip-icon");
            self.attr("rel", "tooltip");
            self.attr("title", self.text());
            self.text("");
            self.tooltip();
        });
    });
})(jQuery); 
```

问题是我现在需要在验证消息更改时捕获任何事件，我一直在查看源代码`jquery.validate.unobtrusive.js`，而我需要挂钩的方法是`function onError(error, inputElement)`方法。

只要我有更新的`title`属性，我的工具提示插件就可以工作，问题出现在重新验证字段并重新生成验证消息时，我需要挂钩并防止消息被放在那里并将其放入`title`而是属性。

我想在*不修改*实际`jquery.validate.unobtrusive.js`文件的情况下找到一种方法。

第二点，如果禁用了javascript，我该如何改进这一点以保持功能不变？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T16:29:25.657

好的，我同意了，以防万一有人再次遇到这种情况：

```
; (function ($) {
    $(function() {
        function convertValidationMessagesToTooltips(form) {
            var fields = $("fieldset .field-validation-valid, fieldset .field-validation-error", form);
            fields.each(function() {
                var self = $(this);
                self.addClass("tooltip-icon");
                self.attr("rel", "tooltip");
                self.attr("title", self.text());
                var span = self.find("span");
                if (span.length) {
                    span.text("");
                } else {
                    self.text("");
                }
                self.tooltip();
            });
        }

        $("form").each(function() {
            var form = $(this);
            var settings = form.data("validator").settings;
            var old_error_placement = settings.errorPlacement;
            var new_error_placement = function() {
                old_error_placement.apply(settings, arguments);
                convertValidationMessagesToTooltips(form);
            };
            settings.errorPlacement = new_error_placement;
            convertValidationMessagesToTooltips(form); // initialize in case of model-drawn validation messages at page render time.
        });
    });
})(jQuery); 
```

和风格：

```
fieldset .field-validation-error { /* noscript */
    display: block;
    margin-bottom: 20px;
}

fieldset .field-validation-error.tooltip-icon { /* javascript enabled */
    display: inline-block;
    margin-bottom: 0px;

    background-image: url('/content/images/icons.png');
    background-position: -32px -192px;
    width: 16px;
    height: 16px;
    vertical-align: middle;
} 
```

## 我将只包含我拥有的工具提示脚本，因为它是一种定制的（尽管我基于其他人的）。

```
; (function ($, window) {
    $.fn.tooltip = function (){
        var classes = {
            tooltip: "tooltip",
            top: "tooltip-top",
            left: "tooltip-left",
            right: "tooltip-right"
        };

        function init(self, tooltip) {
            if ($(window).width() < tooltip.outerWidth() * 1.5) {
                tooltip.css("max-width", $(window).width() / 2);
            } else {
                tooltip.css("max-width", 340);
            }

            var pos = {
                x: self.offset().left + (self.outerWidth() / 2) - (tooltip.outerWidth() / 2),
                y: self.offset().top - tooltip.outerHeight() - 20
            };

            if (pos.x < 0) {
                pos.x = self.offset().left + self.outerWidth() / 2 - 20;
                tooltip.addClass(classes.left);
            } else {
                tooltip.removeClass(classes.left);
            }

            if (pos.x + tooltip.outerWidth() > $(window).width()) {
                pos.x = self.offset().left - tooltip.outerWidth() + self.outerWidth() / 2 + 20;
                tooltip.addClass(classes.right);
            } else {
                tooltip.removeClass(classes.right);
            }

            if (pos.y < 0) {
                pos.y = self.offset().top + self.outerHeight();
                tooltip.addClass(classes.top);
            } else {
                tooltip.removeClass(classes.top);
            }

            tooltip.css({
                left: pos.x,
                top: pos.y
            }).animate({
                top: "+=10",
                opacity: 1
            }, 50);
        };

        function activate() {
            var self = $(this);
            var message = self.attr("title");
            var tooltip = $("<div class='{0}'></div>".format(classes.tooltip));

            if (!message) {
                return;
            }
            self.removeAttr("title");
            tooltip.css("opacity", 0).html(message).appendTo("body");

            var reload = function() { // respec tooltip's size and position.
                init(self, tooltip);
            };
            reload();
            $(window).resize(reload);

            var remove = function () {
                tooltip.animate({
                    top: "-=10",
                    opacity: 0
                }, 50, function() {
                    $(this).remove();
                });

                self.attr("title", message);
            };

            self.bind("mouseleave", remove);
            tooltip.bind("click", remove);
        };

        return this.each(function () {
            var self = $(this);
            self.bind("mouseenter", activate);
        });
    };

    $.tooltip = function() {
        return $("[rel~=tooltip]").tooltip();
    };
})(jQuery, window); 
```

# facebook - Facebook Graph API 检索朋友的图像

> ID：11165877
> 
> 赞同：2
> 
> 时间：2012-06-23T00:53:22.443
> 
> 标签：facebook, facebook-graph-api

我正在尝试获取我所有朋友的所有 ID 以及他们的个人资料图片。我在用着`https://graph.facebook.com/me/friends?fields=picture&access_token=[myToken]`

我得到这个返回：

```
{
"data": [
{
"id": "xxx",
"picture": "http://profile.ak.fbcdn.net/hprofile-ak-snc4/xxx_q.jpg"
} 
```

返回的图片 url 是一个非常小的图像。如何获得更大的图像？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T06:42:37.770

**推荐**
根据[文档](https://developers.facebook.com/docs/reference/api/#pictures)（“图片”部分），可以使用用户ID构建个人资料照片的url

例如，假设用户 id 在 $id 中：

```
"http://graph.facebook.com/$id/picture?type=square"
"http://graph.facebook.com/$id/picture?type=small"
"http://graph.facebook.com/$id/picture?type=normal"
"http://graph.facebook.com/$id/picture?type=large" 
```

**哈克**

> [http://profile.ak.fbcdn.net/hprofile-ak-snc4/xxx_.jpg](http://profile.ak.fbcdn.net/hprofile-ak-snc4/xxx_)`q` _

您可以将`q`参数替换为`s`or `b` :)

# c# - C#反序列化递归类

> ID：11165881
> 
> 赞同：2
> 
> 时间：2012-06-23T00:54:18.043
> 
> 标签：c#, xml, recursion, deserialization

我想将我的数据存储在这样的 XML 中：

```
<MyType name="A">
  <MyType name="B" />
  <MyType name="E" />
  <MyType name="C">
    <MyType name="D">
    <MyType name="G">
  </MyType>
</MyType> 
```

MyType 应该是一个包含其他 MyType 实例数组的类。是否可以反序列化这样的类（使用 System.Xml.Serialization.XmlSerializer）或者我必须使用自己的解析器加载它？

此外，是否可以从带有自定义标头的 xml 反序列化，即。" 而不是 ? TY 的答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-23T01:19:13.260

我认为xml不正确。D 和 G 没有关闭。有了这个xml，

```
<MyType name="A">
 <MyType name="B" />
 <MyType name="E" />
 <MyType name="C">
   <MyType name="D" />
   <MyType name="G" />          
 </MyType>
</MyType> 
```

你可以使用这个类来反序列化它：

```
[Serializable]
public class MyType
{
    [XmlElement(ElementName="MyType")]
    public List<MyType> Types { get; set; }

    [XmlAttribute(AttributeName="name")]
    public string Name { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-23T01:17:17.843

作为一个非常基本的示例，您可以看一下：

注意（xml 与您所描述的不太一样，但您需要摆弄 xml 属性以使其完全按照您的意愿行事，但是在结构上它代表了您所要求的场景，即是的，这是可能的）

```
class Program
    {
        static void Main(string[] args)
        {
            var mytypeTest = new MyType
            {
                Name = "a",
                MyTypes = new List<MyType>
                {
                    new MyType
                    {
                        Name = "b"
                    }
                }.ToArray()
            };

            var xml = mytypeTest.Serialize();

            var result = xml.Deserialize<MyType>();
        }
    }

    public class MyType
    {
        [XmlAttribute]
        public string Name { get; set; }
        [XmlElement(ElementName="MyType")]
        public MyType[] MyTypes { get; set; }
    }

    public static class XmlSerializerExtensions
    {
        public static T Deserialize<T>(this string xml) where T : new()
        {
            var _serializer = new XmlSerializer(typeof(T));
            using (var _stringReader = new StringReader(xml))
            {
                using (XmlReader _reader = new XmlTextReader(_stringReader))
                {
                    return (T)_serializer.Deserialize(_reader);
                }
            }
        }

        public static string Serialize<T>(this T value) where T : new()
        {
            var _serializer = new XmlSerializer(typeof(T));
            using (var _stream = new MemoryStream())
            {
                using (var _writer = new XmlTextWriter(_stream, new UTF8Encoding()))
                {
                    _serializer.Serialize(_writer, value);
                    return Encoding.UTF8.GetString(_stream.ToArray());
                }
            }
        }
    } 
```

# jquery - 带有 Twitter 引导主题的多选两列传输小部件

> ID：11165884
> 
> 赞同：10
> 
> 时间：2012-06-23T00:54:24.883
> 
> 标签：jquery, twitter-bootstrap, multi-select

我正在寻找一个基于多选 jquery 的两列传输小部件，其外观与 twitter bootstrap 兼容。通常，传输选择小部件具有两个相邻的列，用户在其中将他的选择从一列沿两个方向移动到另一列。我已经非常努力地搜索，但找不到任何接近我需要的东西。任何人都可以提出一些建议（没有从头开始写一个）。谢谢。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-06-23T09:07:56.003

我最终决定从头开始写我自己的。源代码可以在[这里](https://github.com/rabihkodeih/bootstrap-transfer)找到。以下屏幕截图说明了小部件的外观：

![在此处输入图像描述](../Images/7e109fdac06900cf54c50424c841a92c.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-07T18:49:21.943

user698585 写的小部件已经完成了 99%，是一个很棒的小部件，但是其中存在一些错误，即：

1.  每当您在两列之间移动值时，该小部件都会使网页跳回顶部。如果您必须向下滚动到小部件，这是一个问题。
2.  该小部件不支持其中包含空格或 & 符号的标记值。
3.  没有公开的方法可以使用左侧的值初始化右列，因此如果您使用小部件将选定的值存储在数据库中，则无法在用户使用这些选择时初始化小部件稍后返回页面。

我已将问题通知作者并提供了示例代码修复，但与此同时，如果您遇到这些问题，您可以在[此处](https://github.com/cdeyoung/bootstrap-transfer)找到该小部件的固定分支。

感谢 user698585 的辛勤工作！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-09T17:30:45.020

这不是两列小部件，但具有相同的功能。在我看来它也更漂亮一点：

[http://davidstutz.github.io/bootstrap-multiselect/](http://davidstutz.github.io/bootstrap-multiselect/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-25T11:04:08.307

你可以试试 multiselect plugin[多选两边都有搜索功能](http://www.jqueryrain.com/?qmi2lw8H)

# objective-c - 显示 UIViewController、NSOperationQueue

> ID：11165885
> 
> 赞同：2
> 
> 时间：2012-06-23T00:54:33.273
> 
> 标签：objective-c, xcode, performance, nsoperation

我一直在使用一个 iOS 5 应用程序，其中我有一个 NSOperationQueue，它可以很好地获取一些数据并创建一个 UIViewController。但是，在每个操作似乎都完成的时候，应用程序在很长一段时间内都没有响应。事情是这样的：

1.  从数据库中获取一些数据
2.  队列 - 为每个项目初始化一个自定义 UIViewController 对象。
3.  将每个 UIViewController 对象交给 MainViewController 并显示它们。

一切都很好，直到 UIVC 对象必须出现。它超越了所有 [[self view] addSubview:object.view]; 并到函数结束。但是在 UIVC 对象的 viewDidApear 中的 NSLog 语句出现之前，有一个巨大的延迟，从 5 到 30 秒......

所以在代码中：

```
//MainViewController
-(void)displayNewView {
  [[self view] addSubview:object.view];
  NSLog(@"Done setup");
}

//-- Long unresponsiveness --//

//UIVC object
-(void)viewDidAppear:(BOOL)animated {
  NSLog(@"Start appear");
  [super viewDidAppear:animated];
} 
```

这可能是什么原因造成的？我错过了一些明显的东西吗？

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T21:33:06.283

似乎是每个 UIViewController 的复杂性延迟了整个过程。

对我来说，它们看起来很简单，但我猜 iPhone 不喜欢一次创建 10 个视图，其中包含多个按钮、标签和图像。简化笔尖并确保只分配和初始化使用的东西有很大帮助..但它仍然不是很流畅。

# jquery - 使用灯箱的链接 rel 属性将图像添加到 div

> ID：11165889
> 
> 赞同：0
> 
> 时间：2012-06-23T00:55:01.590
> 
> 标签：jquery, lightbox

我需要一些 jQuery 帮助。我正在为我的灯箱使用[https://github.com/jbutz/bootstrap-lightbox](https://github.com/jbutz/bootstrap-lightbox)，基本上我想要做的是使用 rel 元素内的内容添加到灯箱 div。

```
<ul class="photo">
  <li>
    <a href="#demoLightbox" class="image" data-toggle="lightbox" rel="/image/photo1.jpg">
      <img src="/image/photo1_thumb.jpg">
    </a>
  </li>
  <li>
    <a href="#demoLightbox" class="image" data-toggle="lightbox" rel="/image/photo2.jpg">
      <img src="/image//photo2_thumb.jpg">
    </a>
  </li>
</ul>

<div class="lightbox fade" id="demoLightbox">
  <div class='lightbox-content'>
  # Javascript will insert image src <img> depending on which link is click
  </div>
</div> 
```

从 Javascript 文件中，我在 bootstrap lightbox.js 数据 api 中添加了以下代码

```
 $('.lightbox-content').html('<img src="' + $(this).attr("rel") + '"/>'); 
```

所以看起来像这样

```
 /* LIGHTBOX DATA-API
  * ============== */

  $(function () {
    $('body').on('click.lightbox.data-api', '[data-toggle="lightbox"]', function ( e ) {
      var $this = $(this), href
        , $target = $($this.attr('data-target') || (href = $this.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '')) //strip for ie7
        , option = $target.data('lightbox') ? 'toggle' : $.extend({}, $target.data(), $this.data())
      e.preventDefault()
      $target.lightbox(option);
      $('.lightbox-content').html('<img src="' + $(this).attr("rel") + '"/>');
    })
  }) 
```

如果我这样做是正确的，我不会使用它，它会在 .lightbox-content 类中添加图像标签，但不幸的是，当我点击它加载的图像时，图像和灯箱 div 框架没有居中。我假设它不接受图像中的宽度和高度值。

非常感谢任何见解。非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T18:35:03.090

我最终选择了 Jack Moore 的 Colorobox，[http://www.jacklmoore.com/colorbox/guide](http://www.jacklmoore.com/colorbox/guide)

很好很简单:)

# php - 谁能推荐一个好的 HTML5 jQuery 文件上传插件或工作代码？

> ID：11165891
> 
> 赞同：1
> 
> 时间：2012-06-23T00:55:13.763
> 
> 标签：php, jquery, ajax, plugins, upload

我对拖放不感兴趣，对多个文件上传也不感兴趣。只是您可以通过 AJAX 上传文件这一事实。我有一个重量级的模板，我不想弄乱它，因为它非常好。我已经尝试了整个 iframe 并且在相关页面中添加所有样式是如此痛苦，尤其是在试图让正确的设计重回正轨时。

![这是它的样子](../Images/c508428e355c68d55e0d19b54494a395.png)

“删除头像”完美地工作，因为这只是通过 AJAX/jQuery 的一个简单的发布表单，但是当用户选择文件时，我想要它以便它自动上传文件（不用担心加载器，只是一个微调器会在头像中做预览）通过更改事件。

一切都是通过非常简单的 jQuery 事件设置的，所以我想完全自定义插件，没有任何样式（我发现很多插件已经内置了）。我一直在考虑自己编写没有任何插件，但觉得这只会节省一些时间。而且我不知道从哪里开始的事实也无济于事！

如果以前有人这样做过，任何帮助或链接都可以很好地尝试获取可以在不刷新页面、使用 Flash 或 iframe 的情况下上传的图像。

**我不是特别想使用插件，很高兴知道是否有一种方法可以在不刷新页面的情况下通过上传文件来完成此操作。在这种情况下，最好的方法似乎是使用 iframe。这样一来，上传图片时无需刷新页面，并且`iframe`比使用 HTML5 解决方案更受支持。**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-23T03:47:36.110

[http://www.plupload.com/](http://www.plupload.com/) - Plupload - 您可以将其自定义为仅执行 HTML5 和一些不错的自定义。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-23T03:33:40.787

Uploadifive 使用 HTML5 文件 API 来避免您提到的 Flash 和框架的技巧：[http ://www.uploadify.com/download/download-uploadifive-standard/](http://www.uploadify.com/download/download-uploadifive-standard/)

# python - ImportError：无法导入名称 splitgophertype - python

> ID：11165893
> 
> 赞同：2
> 
> 时间：2012-06-23T00:55:24.797
> 
> 标签：python, osx-lion

因此，我第一次使用 Python 并遇到了一个错误，即 Google 在帮助我解决问题方面做得不好。

我正在运行 OSX Lion 10.7.4、Python 2.7.3，并安装了 xCode 命令行工具。

我似乎无法安装任何软件包。并不断收到以下错误：

```
distribute-0.6.26 user$ python setup.py install --prefix=~/.local
Before install bootstrap.
Scanning installed packages
No setuptools distribution found
running install
Traceback (most recent call last):
    File "setup.py", line 214, in <module>
        scripts = scripts,
      File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/core.py", line 152, in setup
        dist.run_commands()
      File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/dist.py", line 953, in run_commands
        self.run_command(cmd)
      File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/distutils/dist.py", line 972, in run_command
        cmd_obj.run()
      File "/Users/user/distribute-0.6.26/setuptools/command/install.py", line 73, in run
        self.do_egg_install()
      File "/Users/user/distribute-0.6.26/setuptools/command/install.py", line 82, in do_egg_install
        easy_install = self.distribution.get_command_class('easy_install')
      File "/Users/user/distribute-0.6.26/setuptools/dist.py", line 362, in get_command_class
        self.cmdclass[command] = cmdclass = ep.load()
      File "/Users/user/distribute-0.6.26/pkg_resources.py", line 1993, in load
        entry = __import__(self.module_name, globals(),globals(), ['__name__'])
      File "/Users/user/distribute-0.6.26/setuptools/command/easy_install.py", line 26, in <module>
        from setuptools.package_index import PackageIndex
      File "/Users/user/distribute-0.6.26/setuptools/package_index.py", line 2, in <module>
        import sys, os.path, re, urlparse, urllib, urllib2, shutil, random, socket, cStringIO
      File "build/bdist.macosx-10.7-intel/egg/urllib2.py", line 110, in <module>

ImportError: cannot import name splitgophertype 
```

我不介意重新安装 Python，但我不知道在 OSX 上实现这一点的最佳方法。我试过安装 pip 以便我可以卸载 urllib2 但我无法安装它。

有没有人有任何想法？

谢谢-J

添加 dir(urllib) 的结果

```
['ContentTooShortError', 'FancyURLopener', 'MAXFTPCACHE', 'URLopener', '__all__',     
'__builtins__', '__doc__', '__file__', '__name__', '__package__', '__version__', 
'_ftperrors', '_get_proxies', '_get_proxy_settings', '_have_ssl', '_hexdig', '_hextochr', 
'_hostprog', '_is_unicode', '_localhost', '_noheaders', '_nportprog', '_passwdprog', 
'_portprog', '_queryprog', '_safe_map', '_safe_quoters', '_tagprog', '_thishost', 
'_typeprog', '_urlopener', '_userprog', '_valueprog', 'addbase', 'addclosehook', 
'addinfo', 'addinfourl', 'always_safe', 'base64', 'basejoin', 'c', 'ftpcache', 
'ftperrors', 'ftpwrapper', 'getproxies', 'getproxies_environment', 
'getproxies_macosx_sysconf', 'i', 'localhost', 'noheaders', 'os', 'pathname2url', 
'proxy_bypass', 'proxy_bypass_environment', 'proxy_bypass_macosx_sysconf', 'quote', 
'quote_plus', 'reporthook', 'socket', 'splitattr', 'splithost', 'splitnport', 
'splitpasswd', 'splitport', 'splitquery', 'splittag', 'splittype', 'splituser', 
'splitvalue', 'ssl', 'string', 'sys', 'test1', 'thishost', 'time', 'toBytes', 'unquote', 
'unquote_plus', 'unwrap', 'url2pathname', 'urlcleanup', 'urlencode', 'urlopen', 'urlretrieve'] 
```

# php - PHP：strip_tags - 仅删除某些标签（及其内容）？

> ID：11165895
> 
> 赞同：9
> 
> 时间：2012-06-23T00:56:03.757
> 
> 标签：php, web-scraping, strip-tags

我使用该`strip_tags()`功能，但我需要*删除*一些标签（及其所有内容）。

例如 ：

```
<div>
  <p class="test">
    Test A
  </p>
  <span>
    Test B
  </span>
  <div>
    Test C
  </div>
</div> 
```

比方说，我需要摆脱 P 和 SPAN 标签，只保留：

```
<div>
  <div>
    Test C
  </div>
</div> 
```

`strip_tags`期望您想要保留的标签作为第二个参数。

在这个特定的示例中，我可以使用`striptags($html, "<div>");` ，但我正在抓取的 html 和需要删除的标签一直都是不同的。

我花了几个小时寻找适合我需要的功能，但找不到任何有用的东西。

有任何想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-23T01:04:49.970

使用正则表达式。像这样的东西应该工作：

```
$tags = array( 'p', 'span');
$text = preg_replace( '#<(' . implode( '|', $tags) . ')>.*?<\/$1>#s', '', $text); 
```

该[演示](http://codepad.viper-7.com/ImSeLE)显示它用任何内容替换所需的标签。

请注意，您可能需要对其进行更多调整，例如，以补偿​​标签中的空白，或您的示例未演示的其他未知数。

这是用于捕获带有或不带有属性的标签的正则表达式：

```
'#<(' . implode( '|', $tags) . ')(?:[^>]+)?>.*?<\/$1>#s' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-27T15:25:31.150

您说您正在使用简单的 HTML DOM（很好！这是解析 HTML 的正确方法）。当我需要删除标签及其内容时，我会：

```
$rows = $html->find("span");

foreach ($rows as $row)
{
  $row->outertext = "";
}

$html->load($html->save()); 
```

最后一行是必需的，因为 DOM 在修改后会变得混乱，因此必须折叠整个 DOM，然后再次解析，以便永久更改（IMO，简单 HTML DOM 中的错误）。

Simple HTML DOM 方法比正则表达式更安全、更稳定。

# asp.net-mvc-routing - MVC4 Web API 路由冲突

> ID：11165903
> 
> 赞同：2
> 
> 时间：2012-06-23T00:57:21.147
> 
> 标签：asp.net-mvc-routing, asp.net-mvc-4, asp.net-web-api

**问题**

我们刚刚从 MVC4 Web API Beta 切换到 RC，并且`Multiple actions were found that match the request ...`在我们的服务中遇到了异常。

**背景**

我们在`POST`中定义了两个动作`ApiController`：

```
public class MyModelController : ApiController
{
    ...
    // POST /mymodel
    public MyModel Post(MyModel model)
    {
       ...
    }

    // POST /mymodel/upload
    [ActionName("Upload")]
    public HttpResponseMessage UploadModelImage()
    {
        HttpRequestMessage request = Request;
        if (!request.Content.IsMimeMultipartContent())
        {
            throw new HttpResponseException(Request.CreateResponse(HttpStatusCode.UnsupportedMediaType, request));
        }
       ...
    }
} 
```

第一个操作（默认`POST`操作）用于`MyModel`从传递给服务的 JSON 创建一个新对象。我们门户的用户可以选择上传图像作为创建新`MyModel`对象的一部分，在这种情况下，我们使用第二个`Upload`操作来保存文件并将新对象保存到数据库中。此操作读取多部分请求内容，解析模型的属性并将上传的图像保存到我们的 CDN。

自从我们切换到 RC 后，**上传操作 (http://www.myapidomain.com/mymodel/upload) 运行良好，但常规`POST`操作 (http://www.myapidomain.com/mymodel/) 失败**了`Multiple actions were found that match the request ...`引用上面列出的两种方法作为冲突的异常。

以下是我们的路线：

```
routes.MapHttpRoute(
    "Default", // route name
    "{controller}" // route template
    );

routes.MapHttpRoute(
    "OnlyId", // route name
    "{controller}/{id}", // route template
    new {}, // defaults
    new {controller = @"[^0-9]+", id = @"[0-9]+"} // constraints
    );

routes.MapHttpRoute(
    "OnlyAction", // route name
    "{controller}/{action}", // route template
    new {}, // defaults
    new {controller = @"[^0-9]+", action = ActionNameConstraint.Instance} // constraints
    );

routes.MapHttpRoute(
    "DependantAction", // route name
    "{controller}/{principalId}/{action}/{dependentId}", // route template
    new {dependentId = System.Web.Http.RouteParameter.Optional}, // defaults
    new {controller = @"[^0-9]+", action = ActionNameConstraint.Instance} // constraints
    ); 
```

`ActionNameConstraint`只是一个自定义约束，确保`{action}`必须属于`{controller}`

**问题**

我试过以不同的顺序弄乱路线，看看这是否能解决问题而没有运气。我正在寻求以下任何解决方案的帮助：

1.  我们路线中的一个潜在问题。
2.  路由的替代解决方案`content-type`。`Upload`仅需要为多部分表单帖子调用该操作。如果内容类型是 JSON 或 XML，则应使用常规操作。我还没有找到任何表明可以做到这一点的资源，但我希望其他人已经考虑过这一点。
3.  用于从请求内容中读取文件流的模型绑定方法，因此我们不再需要单独的`Upload`操作

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T06:55:26.710

默认情况下，不可能在单个控制器中混合 REST 样式路由和 RPC 样式路由 - 您似乎正在尝试这样做。

在 ASP.NET Web Stack 的 codeplex 上存在一个未解决的问题，Web API 源所在的位置 - [http://aspnetwebstack.codeplex.com/workitem/184](http://aspnetwebstack.codeplex.com/workitem/184)。

如果您想这样使用它，您需要将上传操作移动到一个单独的控制器，该控制器将以仅 RPC 的方式调用。

# javascript - 通过选择器表单控制动画的速度

> ID：11165905
> 
> 赞同：0
> 
> 时间：2012-06-23T00:57:52.920
> 
> 标签：javascript, jquery

我想让动画的速度可选择。我已经编写了以下代码，但我无法弄清楚是什么阻止了它的工作。如果我删除 $("#speed").val(); 并用一个值替换它，它工作正常。任何想法都会受到极大的欢迎！

```
<div class="lowerthird"> </div>

<button onclick="lowerthirdout();">Lower Third Out</button>

<select id="speed">
  <option value="1000">Fast</option>
  <option value="2000">Medium</option>
  <option value="5000">Slow</option>
  <option value="0">None</option>
</select>

function lowerthirdout(){

    var speed = $("#speed").val();

    $(".lowerthird").animate({ 
        left: "640px",
    }, speed );
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T01:09:35.803

您的问题是 640px 之后的一个额外的逗号。您还需要将数字设为 int，而不是使用 parseInt 的字符串：

[http://jsfiddle.net/wpDdN/1/](http://jsfiddle.net/wpDdN/1/)

```
function lowerthirdout(){

    var speed = parseInt($("#speed").val(), 10);

    $(".lowerthird").animate({ 
        left: "640px"
    }, speed );
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T01:05:47.687

看看这个 [http://jsfiddle.net/E6FHC/](http://jsfiddle.net/E6FHC/)

# php - php 过早返回

> ID：11165907
> 
> 赞同：0
> 
> 时间：2012-06-23T00:58:21.053
> 
> 标签：php, jquery, mysqli

我使用 jquery 的 ajax 函数调用 php 文件。它按原样进入文件并开始执行命令。我有多个

```
$stmt->execute(); 
```

调用，这是 mysqli 更新查询。但是只有第一个会执行，之后它将返回而不是执行下一个查询。为什么它只在 1 次查询后返回？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T01:00:31.343

我看到的唯一问题的答案是：“我应该寻找什么可能导致这个问题？”

[http://php.net/manual/en/errorfunc.configuration.php](http://php.net/manual/en/errorfunc.configuration.php)

您应该在 PHP 日志中查找错误，让您知道代码停止的原因。日志的默认位置与 apache 的错误日志（或 IIS，如果您使用它）相同的文件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T01:38:04.927

您的程序在查询之间崩溃。不幸的是，作为 PHP，它经常会默默地这样做，让你摸不着头脑想知道发生了什么。检查您的错误日志，如果它们是空的，您可能需要调高错误报告级别。

乍一看，我猜你的 SQL 是无效的，导致了一个未处理的异常。

# android - 从 Android 应用程序创建的文件在重命名之前不可见

> ID：11165908
> 
> 赞同：1
> 
> 时间：2012-06-23T00:58:32.440
> 
> 标签：android, file

大家！

我使用此代码在我的 android 应用程序中创建一个文件，在 UI 线程中运行：

```
final File dir = Environment.getExternalStorageDirectory();
final File file = new File(dir, "file" + System.currentTimeMillis()); //$NON-NLS-1$

try
{
   file.createNewFile())
}

catch (Exception e)
{
   ...
} 
```

我在我的 Win7 PC 上看不到它，直到我用文件浏览器重命名手机上的文件。我在三星 Galaxy Nexus 操作系统版本 4.0.2 上运行该程序。可能有什么问题？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T11:55:49.740

最后！

解决方案是使用`MediaScannerConnection.scanFile(context, new String[] {path}, null, null);`，但`path`必须包括文件名，而不仅仅是路径。无需扩展。

至少，它在我的情况下有效:)。

非常感谢克里斯·斯特拉顿。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T10:58:53.737

我找到的唯一解决方案是在设备上安装 SSHDroid，在 Win7 上安装 WinSCP。

# c# - 哪里是开始在网格上编写随机路径的好地方？

> ID：11165910
> 
> 赞同：1
> 
> 时间：2012-06-23T00:58:36.903
> 
> 标签：c#, path-finding, maze

我不知道从哪里开始，我没有要求其他人为我做，但我不知道该怎么做，所以如果有人能指出我正确的方向，那就太好了，我无法使用谷歌找到任何东西，这是我需要的：

我需要创建一条从网格一侧到另一侧的路径，但不是以随机方式最短，我需要确保如果路径平行于路径的另一部分，它至少相隔 2 个单位.

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-23T01:39:15.287

我曾经写过一个迷宫生成器，它首先创建了穿过迷宫的路径，如下所示：

在 y 轴上选择两个随机偏移，每边一个，y1 和 y2，然后在 x 轴上选择一个随机偏移，x。然后用从 (0, y1) 到 (x, y1), (x, y1) 到 (x, y2), (x, y2) 到 (w-1, y2) 的直线连接两个点，其中 w 是宽度：

```
 x
   .....
y1 XXX..
   ..X..
   ..XXX y2
   .....
   |-w-| 
```

然后，我反复向初始路径添加“凹凸”，直到它具有所需的长度，例如原始长度的两倍。

一个凹凸看起来像这样：

前：

```
 .....
 XXXXX
 .....
 ..... 
```

后：

```
 .....
 XX.XX
 .XXX.
 ..... 
```

这种类型的转换可以应用于当前路径上的任何四个方向上的任何可用空间。

（我的 ASCII 艺术技能还有很多不足之处——我希望你能明白）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-23T01:18:55.237

这似乎是一个很好的起点：[http](http://www.csharpcity.com/reusable-code/a-path-finding-library/) ://www.csharpcity.com/reusable-code/a-path-finding-library/这是一个很好的基础，可以很容易地满足您的需求。

# java - 如何检测 Java 字符串中的符号和空格？

> ID：11165915
> 
> 赞同：0
> 
> 时间：2012-06-23T00:59:22.950
> 
> 标签：java, android, string

Java中有没有可以扫描符号的方法？!@#$%^&*()-=|`~_,./;'[]<>?:"{}

在使用符号和/或空格（“”）注册后，我将使用它来显示“无效的用户名”提示。

为了澄清，我正在使用 Eclipse。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T01:06:00.410

您可以使用正则表达式。要匹配除字母或数字以外的任何内容，您可以尝试`[^a-zA-Z0-9]`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T01:19:36.987

我建议您查看Android 开发者网站[上关于 Pattern and Matcher 的文档。](http://developer.android.com/reference/java/util/regex/Pattern.html)

提取物：

> 模式是编译的正则表达式。在很多情况下，String.matches、String.replaceAll 和 String.split 等方便的方法会更可取，但如果需要对同一个正则表达式进行大量工作，编译一次并重用可能会更高效它。Pattern 类及其伴侣 Matcher 也提供了比 String 所公开的少量功能更多的功能。

```
// Direct use of Pattern:
 Pattern p = Pattern.compile("[^a-zA-Z0-9]");
 Matcher m = p.matcher(inputString);
 boolean hasSpecialChars = m.find(); 
```

然后`b`你会得到`inputString`包含非字母数字字符的结果。

# ruby - 使用 Ruby 抓取并存储在哈希中

> ID：11165918
> 
> 赞同：2
> 
> 时间：2012-06-23T01:00:04.640
> 
> 标签：ruby, nokogiri, scraper

我编写了 Ruby scraper 从加利福尼亚参议院获取竞选财务数据，然后将每个人保存为哈希。这是到目前为止的代码：

这是主要网站：[http ://cal-access.sos.ca.gov/Campaign/Candidates/](http://cal-access.sos.ca.gov/Campaign/Candidates/)

这是候选人页面的示例：[http ://cal-access.sos.ca.gov/Campaign/Committees/Detail.aspx?id=1342974&session=2011&view=received](http://cal-access.sos.ca.gov/Campaign/Committees/Detail.aspx?id=1342974&session=2011&view=received)

这是 github 存储库，如果您想在代码中查看我的评论：[https ://github.com/aboutaaron/Baugh-For-Senate-2012/blob/master/final-exam.rb](https://github.com/aboutaaron/Baugh-For-Senate-2012/blob/master/final-exam.rb)

上代码...

```
require 'nokogiri'
require 'open-uri'

campaign_data =  Nokogiri::HTML(open('http://cal-access.sos.ca.gov/Campaign/Candidates/'))

class Candidate
def initialize(url)
    @url = url
    @cal_access_url = "http://cal-access.sos.ca.gov"
    @nodes =  Nokogiri::HTML(open(@cal_access_url + @url))
end

def get_summary
    candidate_page = @nodes

    {
        :political_party => candidate_page.css('span.hdr15').text,
        :current_status => candidate_page.css('td tr:nth-child(2) td:nth-child(2) .txt7')[0].text,
        :last_report_date => candidate_page.css('td tr:nth-child(3) td:nth-child(2) .txt7')[0].text,
        :reporting_period => candidate_page.css('td tr:nth-child(4) td:nth-child(2) .txt7')[0].text,
        :contributions_this_period => candidate_page.css('td tr:nth-child(5) td:nth-child(2) .txt7')[0].text.gsub(/[$,](?=\d)/, ''),
        :total_contributions_this_period => candidate_page.css('td tr:nth-child(6) td:nth-child(2) .txt7')[0].text.gsub(/[$,](?=\d)/, ''),
        :expenditures_this_period => candidate_page.css('td tr:nth-child(7) td:nth-child(2) .txt7')[0].text.gsub(/[$,](?=\d)/, ''),
        :total_expenditures_this_period => candidate_page.css('td tr:nth-child(8) td:nth-child(2) .txt7')[0].text.gsub(/[$,](?=\d)/, ''),
        :ending_cash => candidate_page.css('td tr:nth-child(9) td:nth-child(2) .txt7')[0].text.gsub(/[$,](?=\d)/, '')
    }
end

def get_contributors
    contributions_received = @nodes
    grab_contributor_page = @nodes.css("a.sublink6")[0]['href']
    contributor_page = Nokogiri::HTML(open(@cal_access_url + grab_contributor_page))
    grab_contributions_page = contributor_page.css("a")[25]["href"]
    contributions_received = Nokogiri::HTML(open(@cal_access_url + grab_contributions_page))
    puts
    puts "#{@cal_access_url}" + "#{grab_contributions_page}"
    puts

    contributions_received.css("table").reduce([]) do |memo, contributors|
        begin

            memo << {
                :name_of_contributor => contributions_received.css("table:nth-child(57) tr:nth-child(2) td:nth-child(1) .txt7").text
            }

        rescue NoMethodError => e
            puts e.message
            puts "Error on #{contributors}"
        end
        memo
    end
end

end

campaign_data.css('a.sublink2').each do |candidates|
puts "Just grabbed the page for " + candidates.text
candidate = Candidate.new(candidates["href"])
p candidate.get_summary
end 
```

`get_summary`按计划工作。`get_contributors`按计划存储第一个贡献者`<td>`，但会执行 20 多次。在我弄清楚多重打印问题之前，我现在只选择获取名称。

最终目标是获得贡献者的哈希值以及他们所需的所有信息，并可能将它们移动到 SQL 数据库/Rails 应用程序中。但是，在此之前，我只想要一个工作刮刀。

有什么建议或指导吗？对不起，如果代码不是超级。编程的超级新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T03:26:18.093

你做得很好。在提供独立样本方面做得很好。你会惊讶有多少人不这样做。

我看到两个问题。

首先是并非所有页面都有您要查找的统计信息。这会导致您的解析例程有点不安。为了防止这种情况，您可以将其放入`get_summary`：

```
return nil if candidate_page.text =~ /has not electronically filed/i 
```

调用者在看到 nil 时应该做一些智能的事情。

另一个问题是服务器有时没有及时响应，所以脚本超时。如果您认为服务器对您的脚本发出请求的速度感到不安，您可以尝试添加一些睡眠来减慢它的速度。或者，您可以添加一个重试循环。或者，您可以增加脚本超时所需的时间。

中也有一些重复的逻辑`get_summary`。此功能可能受益于策略与逻辑的分离。策略是从页面中检索哪些数据，以及如何格式化：

```
FORMAT_MONEY = proc do |s|
  s.gsub(/[$,](?=\d)/, '')
end

FIELDS = [
  [:political_party, 'span.hdr15'],
  [:current_status, 'td tr:nth-child(2) td:nth-child(2) .txt7'],
  [:last_report_date, 'td tr:nth-child(3) td:nth-child(2) .txt7'],
  [:reporting_period, 'td tr:nth-child(4) td:nth-child(2) .txt7'],
  [:contributions_this_period, 'td tr:nth-child(5) td:nth-child(2) .txt7', FORMAT_MONEY],
  [:total_contributions_this_period, 'td tr:nth-child(6) td:nth-child(2) .txt7', FORMAT_MONEY],
  [:expenditures_this_period, 'td tr:nth-child(7) td:nth-child(2) .txt7', FORMAT_MONEY],
  [:total_expenditures_this_period, 'td tr:nth-child(8) td:nth-child(2) .txt7', FORMAT_MONEY],
  [:ending_cash, 'td tr:nth-child(9) td:nth-child(2) .txt7', FORMAT_MONEY],
] 
```

实现是如何将该策略应用于 HTML 页面：

```
def get_summary
  candidate_page = @nodes
  return nil if candidate_page.text =~ /has not electronically filed/i
  keys_and_values = FIELDS.map do |key, css_selector, format|
    value = candidate_page.css(css_selector)[0].text
    value = format[value] if format
    [key, value]
  end
  Hash[keys_and_values]
end 
```

# jquery - jQuery无法调用null的方法'get'

> ID：11165919
> 
> 赞同：0
> 
> 时间：2012-06-23T01:00:08.730
> 
> 标签：jquery

我得到一个**无法调用 null 的方法“get”**

它适用于 jsfiddle：http: [//jsfiddle.net/nick_craver/RJMhT/1/](http://jsfiddle.net/nick_craver/RJMhT/1/)

```
<script>
var divs = $("div.Image").get().sort(function(){
    return Math.round(Math.random())-0.5; //random so we get the right +/- combo
}).slice(0,1) 
    $(divs).appendTo(divs[0].parentNode).show();
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T01:16:01.140

尝试将您的脚本更改为：

```
<script>
$(document).ready(function() {

    var divs = $("div.Image").get().sort(function() {
               return Math.round(Math.random())-0.5; //random so we get the right +/-              combo
               }).slice(0,1)

    $(divs).appendTo(divs[0].parentNode).show();
});
</script> 
```

这将允许您的脚本等到 DOM 完成加载后再执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T01:08:14.137

有时浏览器会假装很好地加载 jQ，而不是封装在块中。`$(document).ready(function() {`先用块试试。如果这不能解决您的问题，jQ 也有可能与其他内容发生冲突，因此请尝试使用 jQuery() 更改所有 $() 调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T07:26:48.113

有时 jquery 会假装很好地加载 jQ，而不是封装在块中。`jQuery.(document).ready(function() {`先用块试试。并使用正确的 jquery，例如[在此处输入链接描述](http://code.jquery.com/jquery-1.9.1.min.js)

# c++ - C++：自动向量重新分配调用复制构造函数？为什么？

> ID：11165924
> 
> 赞同：9
> 
> 时间：2012-06-23T01:00:41.410
> 
> 标签：c++, stdvector

我正在阅读 C++ Primer, 3rd Ed (Lippman and Lajoie)，它说当需要重新分配向量以便为添加的更多元素腾出空间时`push_back()`，元素在新空间中复制构造，然后在旧元素上调用析构函数。我很困惑为什么这是必要的——为什么不能逐位复制数据？我假设答案与动态内存分配有关，但我目前的推理是，即使向量元素处理动态内存，实际存储在元素中的数据将是指针，这意味着按位复制将保留它们指向的位置并且不会出现任何问题。我可以看到重新定位元素指向的动态分配的内存将是一个问题，因为它会使指针无效，但据我所知，向量重新定位没有理由这样做。

有人可以给我一个不应该一点一点移动的类的简单示例吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-23T04:52:49.657

这可能是最简单（但相当做作）的示例：

```
class foo
{
  int i;
  int* pi; // always points to i
}; 
```

在这里，复制构造函数将维护`pi`指向的不变量`i`。编译器本身无法自行找出这种关系，因此需要调用复制构造函数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-23T05:30:38.253

> 有人可以给我一个不应该一点一点移动的类的简单示例吗？

按照标准，`memcpy`对*任何*不是[C++03 中的 POD（或在 C++11 中可简单复制）的](https://stackoverflow.com/questions/4178175/what-are-aggregates-and-pods-and-how-why-are-they-special)类执行 a 都是合格的。`memcpy`使用非 POD（或不可复制的）调用未定义的行为；*因此必须*使用实际的复制（或 C++11 中的移动）构造函数。

所以`std::vector` *它本身*适用，因为它不是 POD 类型（在 C++11 中，它不是简单可复制的）。

# php - php在导出中重复输出

> ID：11165928
> 
> 赞同：0
> 
> 时间：2012-06-23T01:01:23.443
> 
> 标签：php, mysql, export-to-csv

我有这个问题有一段时间了，我在这里发布了这个问题，但我没有任何反馈。我正在尝试导出查询，我这样做了，只是字段重复了。怎么会这样？

这是代码：

```
$fh = fopen('hostess_query4.csv', 'w');
$result1 = mysql_query("SELECT ".$username." FROM hostess");
if ( !$result1 ) { echo mysql_error(); }
while ($row = mysql_fetch_array($result1)) {
    $last = end($row);
    foreach ($row as $item) {
        fputcsv($fh, $row, ',');
        if ($item != $last)
            fwrite($fh, "\t");
        }
    fwrite($fh, "\n");
    }
}

fclose($fh); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T01:05:08.567

使用 mysql_fetch_assoc() 而不是 mysql_fetch_array。
文档： http:
[//php.net/mysql_fetch_array](http://php.net/mysql_fetch_array)
[http://php.net/mysql_fetch_assoc](http://php.net/mysql_fetch_assoc)

或者使用 mysql_fetch_array 并将第二个可选参数设置为 MYSQL_ASSOC。

新代码：

```
$fh = fopen('hostess_query4.csv', 'w');
$result1 = mysql_query("SELECT ".$username." FROM hostess");
if ( !$result1 ) { echo mysql_error(); }
while ($row = mysql_fetch_assoc($result1)) {
    $last = end($row);
    foreach ($row as $item) {
        fputcsv($fh, $row, ',');
        if ($item != $last)
            fwrite($fh, "\t");
        }
    fwrite($fh, "\n");
    }
}

fclose($fh); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T01:31:13.893

你可以试试这个。

```
$last = end(mysql_fetch_array($result1)); // this will return the last element in $result1
while (list($username) = mysql_fetch_array($result1)) {        
    fputcsv($fh, $username, ',');
    if ($username!= $last)
        fwrite($fh, "\t");
    }
    fwrite($fh, "\n");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-23T01:18:52.663

您将两种不同的方法混淆在一起。

以下方法可行。它使用内[爆](http://php.net/manual/en/function.implode.php)来合并你的行。

```
$fh = fopen('hostess_query4.csv', 'w');

$result1 = mysql_query("SELECT ".$username." FROM hostess");

if ( !$result1 ) { echo mysql_error(); }

while ($row = mysql_fetch_assoc($result1)) {
    fwrite($fh, implode(",", $row)."\n");
}

fclose($fh); 
```

您的问题的原因是 mysql_fetch_array 将返回 0 递增和关联数组。例子：

```
Array
(
    [0] => 1
    [ID] => 1
    [1] => Mike
    [NAME] => Mike
    [2] => 22
    [Age] => 22
) 
```

因此，当您导出它时，它正在导出重复项。将其更改为 mysql_fetch_assoc 或 mysql_fetch_object，您将只有一组值。

# javascript - 如何使用 Javascript 添加 iPhone / iPad 检测？

> ID：11165936
> 
> 赞同：1
> 
> 时间：2012-06-23T01:02:36.697
> 
> 标签：javascript, jquery, mobile, browser-detection

如果浏览器来自 iPhone/iPad，我想在我的网站上添加一个条件以具有某些特定行为，例如单击按钮以显示 div 时。

就像是 ：

```
<script type="text/javascript">
/* iPhone scripts */
<?php if(strstr($_SERVER['HTTP_USER_AGENT'],'iPhone') || strstr($_SERVER['HTTP_USER_AGENT'],'iPod')){ ?>
    // window.addEventListener("load",function() {
    // setTimeout(function(){
    // window.scrollTo(0, 1);
    // }, 0);
    // });
   jQuery(document).ready(function() {
}
}); 
```

这正是我发现的，但我不确定这是不是这样。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-23T15:24:28.567

我使用的是这个：

```
function UtilityHasTouch() {    

    var agent   = navigator.userAgent;

    if ( agent.match(/(iPhone|iPod|iPad|Blackberry|Android)/) ) {
        return true;
    }

    try {
        document.createEvent("TouchEvent");
        return true;
    } catch (e) {
        return false;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-23T01:50:39.010

我建议使用[modernizr](http://modernizr.com/)进行特征检测，而不是依赖于自制的浏览器检测。使用 Modernizr，您只需一个简单的 if 语句即可检测浏览器是否支持触摸事件

```
if (Modernizr.touch) 
```

导致对所有移动设备和平板电脑浏览器的检测。

# python - 导入未完成的模块

> ID：11165937
> 
> 赞同：0
> 
> 时间：2012-06-23T01:02:54.777
> 
> 标签：python, python-2.7

我正在为我的科学工作构建一个个人功能模块，即通用功能。

它还没有完成，所以我想暂时将它保存在它的开发文件夹中，而不是像你用 pip 等安装所有其他模块一样安装它。

现在，我还需要处理其他不相关的项目，但仍然需要这些功能。

我的问题是，将这两个项目放在完全独立的文件夹中，我如何导入一个以在另一个中使用？

谢谢

**编辑：**只是另一个快速的。如果两者都在各自的文件夹中但具有相同的根目录。会有更好/更简单的方法来做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T01:05:37.583

将包含您的模块的目录（我们称之为`functions.py`）放入 PYTHONPATH 环境变量中。然后你就可以`import functions`用来获取你的功能了。

Pip 似乎也支持这一点： `pip install -e src/mycheckout`例如，但我不太了解它的后果。

# java - Java，如何更改类中每个构造函数对象的值？

> ID：11165938
> 
> 赞同：0
> 
> 时间：2012-06-23T01:03:09.500
> 
> 标签：java, constructor

我正在尝试制作游戏，对于枪支类，我需要每个子弹都是构造函数对象，如何一次编辑每个构造函数？比如改变每个子弹的 x 值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T02:14:12.437

让我做出一个艰难的猜测。

```
class Gun{
  Bullet bullet;
  public Gun(){
   bullet = new Bullet();
  }
}
class Bullet{
 public int x=0;
 public Bullet(){
   x=10;
 }
} 
```

您想一次更改所有 Bullet 的 x 值（据我了解）。然后，您必须将所有 Bullet 实例保存在数据结构中。

```
static List<Bullet> bullets = new ArrayList<Bullet>(); 
```

然后更新 Bullet 的构造函数，如下所示。

```
class Bullet{
 public int x=0;
 public Bullet(){
   x=10;
   Gun.bullets.add(this);
 }
} 
```

然后遍历项目符号列表并进行您想要进行的更改。

```
for(Iterator i = bullets.iterator(); i.hasNext();){
 i.next().x = 12;
} 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T01:05:44.900

我认为您误解了构造函数的目的。当创建一个类的实例时调用构造函数，并且通常初始化该单个实例的属性。如果要更改对象的所有实例的值，则必须将引用存储在数组（或其他类似的数据结构）中，然后遍历它们并单独更改每个值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-23T02:19:36.170

没有对项目符号的迭代。不，不，一百万次，不。 *封装*的值，`x`因此您只需进行一次更改。这是一个简单的代码示例，说明了您应该考虑的设计模式。谷歌“发布-订阅模式”或“观察者模式”以获得完整的想法。

```
public class Bullet {
    public static int globalEffect = 0;
    private int myX;
    public int x() { 
     return myX + globalEffect;
    }
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-23T02:23:02.817

在创建项目符号时收集它们，然后迭代集合以更新它们。例如，类似：

```
public abstract class Projectile {
    private static final Collection<Projectile> activeProjectiles = new ArrayList<Projectile>();

    static {
         //update the position of any in-flight projectile approximately once per second
         Runnable updater = new Runnable() {
             public void run() {
                 while (true) {
                     synchronized(activeProjectiles) {
                         for (Projectile projectile : new ArrayList<Projectile>(activeProjectiles)) {
                             projectile.travel();
                         }
                     }
                     try {
                         Thread.sleep(1000);
                     }
                     catch (Throwable ignored) {}
                 }
             }
         };
         new Thread(updater).start();
    }

    protected int x;
    protected int transitTime;

    public abstract int getMuzzleVelocity();

    public Projectile() {
        this.x = 0;
        synchronized(activeProjectiles) {
            activeProjectiles.add(this);
        }
    }

    public int getFriction() {
        return 0;
    }

    private void travel() {
        this.x += this.getMuzzleVelocity() + (this.getFriction() * this.transitTime);
        this.transitTime++;
        if (this.transitTime * this.getFriction() >= this.getMuzzleVelocity()) {
            //this projectile is done
            synchronized(activeProjectiles) {
                activeProjectiles.remove(this);
            }
        }

    }

}

public class Bullet extends Projectile {
    public Bullet() { 
        super();
    } 

    @Override
    public int getMuzzleVelocity() {
         return 600;
    }

    @Override
    public int getFriction() {
        return 25;
    }
} 
```

# java - 练习访问修饰符

> ID：11165942
> 
> 赞同：2
> 
> 时间：2012-06-23T01:03:31.387
> 
> 标签：java

我正在尝试使用具有不同访问修饰符的类包创建一个项目，以查看具有不同访问修饰符的类的所有特征。我尝试了一个带有公共类的包，一个带有默认类的包，然后尝试为受保护类和私有类设置另外两个包，但它对它们说“privatez 类的非法修饰符；只允许 public、abstract 和 final”。为什么会这样。其次，为每个类测试东西是理解它的好方法。我试图提出比上一篇文章更好的问题。我还想学习每个访问修饰符的应用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-23T01:13:08.467

> 我尝试了一个带有公共类的包，一个带有默认类的包，然后尝试为受保护类和私有类设置另外两个包，但它对它们说“privatez 类的非法修饰符；只允许 public、abstract 和 final”。为什么会这样。

简单的答案是 JLS 说您不能将顶级类声明为`private`.

原因是拥有一个只对自己可见的类是没有意义的。任何其他类都无法使用它（假设除了使用反射的肮脏技巧）。所以 JLS 只是说：“这没有意义，我不允许这样做。”

（现在*嵌套*类*可以*访问`private`......但那是因为最外层封闭类中所有类的`private`手段......）`private`

> 其次，为每个类测试东西是理解它的好方法。

我认为最好阅读并尝试理解教科书/教程。问题在于，如果您尝试通过编写自己的示例来学习，您很容易从中得出错误的结论。

* * *

对于这个例子：

```
package privatez; protected class privatez { } 
```

一个假设的`protected`类将/可能只对其子类可见。但是类*总是*对其子类可见，所以这没有任何意义。（此外，防止子类的方法是声明一个类`final`，您可以使用“包私有”来限制子类化；即没有访问修饰符。）

*访问修饰符仅对类中*的`protected`内容有意义。在顶级课程中， 的正常含义没有任何意义。*`protected`*

 *（这是尝试通过示例学习的问题之一。您最终会努力理解为什么编译器会拒绝示例。不要指望编译器“解释”为什么出了问题。这不是它的作用。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-23T01:19:10.833

如果你想学习，你应该阅读一些关于java的书。在这里我只能给你一个小要点：

类访问修饰符：

**上市**

类可以在它所属的包之外访问。

**默认**

这是你不指定任何东西的时候。可以从包中的 with 访问该类，它是其中的一部分。

**只是为了澄清：**

`private`修饰符没有意义。由于没有人可以访问私有类，既不能用于扩展也不能创建实例。

假设如果有一个`protected`类概念，那么该类将对同一个包中的子类可见，如果你不定义任何修饰符就是这种情况。

其他类属性（这些不是访问修饰符）：

**抽象的**

如果定义，该类的用户不能创建它的实例。扩展它的类必须实现抽象方法或将自己定义为抽象。

**最终的**

如果已定义，则用户不能扩展此类。

[有关 java 作为语言的更多详细信息，请阅读](http://docs.oracle.com/javase/tutorial/java/index.html)*

# mysql - 如何将 Linux 服务器中的 MySQL 表名更改为不区分大小写？

> ID：11165944
> 
> 赞同：18
> 
> 时间：2012-06-23T01:03:58.157
> 
> 标签：mysql, linux, case-insensitive

我正在开发一个曾经托管在 Apple 服务器上的旧网站。当它迁移到新的 Linux 服务器时，它停止工作。我很确定这是因为 php 脚本中使用的所有 MySQL 查询对表名都有不同的大小写组合（我不知道为什么原始开发人员在创建表名或 php 脚本时没有遵循任何约定) 这并不重要，因为 Mac 和 Windows MySQL 服务器默认情况下都不区分大小写。但是，Linux 不是。

有没有办法改变 MySQL 上的 Linux 默认值，使它变得不区分大小写并且像 Mac 或 Windows 一样工作？我一直在寻找，但没有找到任何不涉及更改脚本或表名或两者的答案。该网站必须是使用某些 CMS 生成的，因此有几十个页面，并且在每个表和数百个表中包含具有多个查询的文件。我开始尝试以我能想到的最聪明的方式实现这种类型的解决方案，但是如果我触摸表名，那么其他当前工作的页面就会停止工作（我试图避免进一步破坏网站）。

在 Linux 服务器的 Webmin 中的 MySQL 服务器控制台中有一个系统变量（lower_case_table_names），我读取的可以从 0 更改为 1 以解决此问题，但 Webmin 不允许我更改它，因为它是“只读“ 多变的。

你会认为这将是一个很容易解决的问题，但到目前为止我正在失去希望。我希望有人能得到一个目前可能让我难以捉摸的答案。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-23T01:20:23.380

MySQL 的大小写敏感性默认由文件系统处理，这就是您发现这种差异的原因：

> **9.2.2\. 标识符大小写敏感性**
> 
> 在 MySQL 中，数据库对应于数据目录中的目录。数据库中的每个表对应于数据库目录中的至少一个文件（可能更多，取决于存储引擎）。因此，底层操作系统的大小写敏感性在数据库和表名的大小写敏感性中起作用。这意味着数据库和表名在 Windows 中不区分大小写，而在大多数 Unix 中区分大小写。一个值得注意的例外是 Mac OS X，它基于 Unix，但使用不区分大小写的默认文件系统类型 (HFS+)。但是，Mac OS X 也支持 UFS 卷，它与任何 Unix 一样区分大小写。请参阅第 1.8.4 节，“标准 SQL 的 MySQL 扩展”。

幸运的是，下一句话可以帮助你：

> [lower_case_table_names](http://dev.mysql.com/doc/refman/5.0/en/server-system-variables.html#sysvar_lower_case_table_names)系统变量也会影响服务器如何处理标识符区分大小写，如本节后面所述。

`lower_case_table_names`简介：

> 如果设置为 0，则按指定存储表名，并且比较区分大小写。如果设置为 1，则表名以小写形式存储在磁盘上，并且比较不区分大小写。如果设置为 2，则表名按给定方式存储，但以小写形式进行比较。此选项也适用于数据库名称和表别名。有关其他信息，请参阅第 9.2.2 节，“标识符大小写敏感性”。
> 
> 如果您在具有不区分大小写文件名的系统（例如 Windows 或 Mac OS X）上运行 MySQL，则不应将此变量设置为 0。如果在这样的系统上将此变量设置为 0 并使用不同的字母大小写访问 MyISAM 表名，则可能会导致索引损坏。在 Windows 上，默认值为 1。在 Mac OS X 上，默认值为 2。

所以看起来你应该`lower_case_table_names`在`1`MySQL 配置文件中设置。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-06-23T01:16:23.457

有[一个同名的 MySQL 服务器变量](http://dev.mysql.com/doc/refman/5.0/en/server-system-variables.html#sysvar_lower_case_table_names)。您可能需要在系统启动时设置该特定变量，如[本帮助页面](http://dev.mysql.com/doc/refman/5.0/en/using-system-variables.html)中所述。您必须`/etc/my.cnf`为您的数据库服务器实例找到 MySQL 选项文件的位置（我的位于 ），然后将此选项编辑/添加到该`[mysqld]`部分。

之后不要忘记重新启动 MySQL 守护进程...

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2015-01-06T20:16:50.103

编辑mysql配置文件

```
nano /etc/mysql/my.cnf 
```

或任何其他`my.cnf`用于配置您的`mysql`.

在下面

```
[mysqld] 
```

添加行

```
lower_case_table_names=1 
```

跑

```
sudo service mysqld restart 
```

您可能希望将您的 windows 数据库重新导入到您的 linux 数据库中。最好从头开始，使用添加表和插入语句。

很好！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-23T01:15:21.967

您不能更改`lower_case_table_names`mysql 运行时的值 - 它需要在启动时设置。您将需要编辑`my.cnf`（可能在 中`/etc`，可能在其他地方，不确定）。然后重启mysql，应该就好了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-07-28T20:33:17.883

这是因为您使用的文件系统。这被解释为

```
In MySQL, databases correspond to directories within the data directory.
Each table within a database corresponds to at least one file within the database directory (and possibly more, depending on the storage engine). 
Triggers also correspond to files. Consequently, the case sensitivity of the underlying operating system plays a part in the case sensitivity of database, table, and trigger names. 
This means such names are not case-sensitive in Windows, but are case-sensitive in most varieties of Unix. 
One notable exception is macOS, which is Unix-based but uses a default file system type (HFS+) that is not case-sensitive. 
However, macOS also supports UFS volumes, which are case-sensitive just as on any Unix. 
```

您可以[在 mysql 官方网站上阅读更多内容](https://dev.mysql.com/doc/refman/8.0/en/identifier-case-sensitivity.html)

您必须通过运行以下查询来检查区分大小写，以了解数据库的区分大小写：

```
SHOW VARIABLES LIKE "lower_case_table_names"; 
```

值 0（Linux 上的默认值）表示名称比较区分大小写，值 1（Windows 上的默认值）表示不区分大小写，而值 2（macOS 上的默认值）也可以视为不区分大小写。

现在，如果查询结果为 0，那么您需要更改 `lower_case_table_names`变量以使您的数据库不区分大小写。

请记住备份您的数据库，因为更改此变量的值后，您的数据库可能表现不佳。您可以恢复数据库后使其不区分大小写。使用以下命令备份您的数据库（并应在备份后将其删除）：

```
mysqldump -u username -p db_name > dump.sql 
```

现在，您需要找到您的 mysql 配置文件。配置文件可能在

```
/etc/mysql/my.cnf 
```

或

```
/etc/mysql/mysql.conf.d/mysqld.cnf 
```

您需要查找 [mysqld]，无论您找到哪个文件的详细信息，例如（其中一个）：

```
[mysqld]
user            = mysql
pid-file        = /***
socket          = /***
port            = ****
basedir         = /***
datadir         = /***
tmpdir          = /tmp
lc-messages-dir = /**** 
```

编辑您的文件：

```
vi /etc/mysql/mysql.conf.d/mysqld.cnf 
```

并粘贴`lower_case_table_names=1`下面的行 [mysqld]

您需要重新启动mysql：

```
sudo service mysql restart 
```

您现在可以使用以下命令恢复数据库：

```
mysql -u username -p db_name < dump.sql 
```

完毕。干杯。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-11-21T21:54:20.590

在创建数据库实例之前，应将 lower_case_table_names 参数设置为自定义数据库参数组的一部分。您应该避免更改现有数据库实例的 lower_case_table_names 参数，因为这样做可能会导致与时间点恢复备份和只读副本数据库实例不一致。

# android - 适用于 Android 的 Facebook SSO Facebook 应用程序

> ID：11165948
> 
> 赞同：2
> 
> 时间：2012-06-23T01:04:55.227
> 
> 标签：android, facebook

当设备上也安装了 Facebook 应用程序时，我遵循了似乎对其他人有用的建议，但我仍然无法使其工作。（应用程序加载但 Facebook 登录对话框立即消失。）我有一个从这个 OSX 终端命令生成的有效哈希键，我也给了 Facebook。但它不像其他人那样工作。

keytool -exportcert -alias androiddebugkey -keystore ~/.android/debug.keystore | openssl sha1 -二进制 | openssl base64

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T02:54:21.090

使用此工具生成 Key Hash。

[http://www.easyfacebookandroidsdk.com/download/keyhash.zip](http://www.easyfacebookandroidsdk.com/download/keyhash.zip)

# python - 如何访问 distutils 版本号？

> ID：11165952
> 
> 赞同：4
> 
> 时间：2012-06-23T01:05:11.203
> 
> 标签：python, distutils

我有一个用 distutils 构建的 python 包，我在我的设置函数中使用版本参数，就像这样（除了名称和版本之外还有其他参数）：

```
setup(name='example_module', version='0.1.2', ...) 
```

我可以`example_module`通过调用从包中的模块中提取版本号：

```
import pkg_resources
version = pkg_resources.require('example_module')[0].version 
```

如何从此发行版之外的 python 脚本访问此版本号？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T01:11:04.133

通常，版本号是包源中的常量，setup.py 使用该值，然后任何导入包的人都可以读取版本字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-23T04:24:17.493

在发行版之外的另一个 python 程序中使用 is 包版本的最简单方法是遵循 PEP 396。[http://www.python.org/dev/peps/pep-0396/](http://www.python.org/dev/peps/pep-0396/)

任何其他脚本都可以通过运行来访问 python 包的版本

```
python setup.py --version 
```

并捕获输出。在生成我的包的在线文档时，我在我的 Makefile 中使用它来提取版本号。

如果您的软件包包含任何命令行实用程序，请确保您包含`--version`命令行选项。然后任何脚本/程序都可以在安装后使用它来获取你的包版本。

# c++ - 如何在 Qt QMake 中清空缓存：没有这样的插槽，重复错误

> ID：11165953
> 
> 赞同：2
> 
> 时间：2012-06-23T01:05:12.010
> 
> 标签：c++, qt, signals-slots, qmake

所以基本上，我正在编写一个 Qt 应用程序。它曾经工作得很好，但是自从我重新配置了一些文件名（具体来说，很久以前，我有名为 mainwindow.h 和 .cpp 的文件。我分别将它们重命名为 net.h 和 .cpp，并且最近更改了回到 mainwindow.h 和 .cpp），它失败并出现几个错误（在运行时）：

```
Object::connect: No such slot QWidget::slotName()
Object::disconnect: No such signal QWidget::iconSizeChanged(QSize)
Object::disconnect: No such signal QWidget::toolButtonStyleChanged(Qt::ToolButtonStyle)
Object::connect: No such signal QWidget::iconSizeChanged(QSize)
Object::connect: No such signal QWidget::toolButtonStyleChanged(Qt::ToolButtonStyle) 
```

我在班级中注册的唯一插槽是第一个插槽名称。我不确定为什么它被列为 QWidget 的成员而不是我的类（它是 QWidget 的子类）。我知道我声明它是正确的，因为我在 moc_mainwindow.cpp 文件中找到了它。是的，我的类定义中有 Q_OBJECT。

运行时还会发生另一个错误，每秒一次：

```
QWidget::metric: Invalid metric command
QPainter::begin: Paint device returned engine == 0, type: 143256176 
```

就像我说的那样，所有这些过去都可以完美运行，这就是为什么除非被问到，否则我不会发布大量代码。我认为这更像是 QMake 的缓存问题。我试过删除所有moc文件，删除项目文件，清空项目文件并生成一个新的空Makefile等。有人有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T02:34:00.277

您不应该在没有版本控制的情况下开发代码。利用您的版本控制系统清理您的工作副本，或签出到新位置并在那里重新编译。那么你就不会责怪谁知道什么了。

在没有版本控制的情况下，手动将您的项目逐个文件复制到新位置，将其提交到您选择的新版本控制存储库（本地存储库！）并在那里编译。

请注意，Qt Creator 一直默认为影子构建——即不在您的源文件夹中的构建。擦除影子构建是微不足道的：转到源文件夹上方的一个目录，然后查找一个名称很长的文件夹，从项目名称开始。擦除它，您就可以保证没有任何类型的“缓存”。

另请注意，QMake 根本没有缓存。它重新读取其输入中给出的所有文件（.pro 及其包含）并从头开始重新创建所有 Makefile。您可以运行`qmake && make clean`进行清理，但这不会处理来自不同配置项目的文件。唉，这样的文件无论如何都不应该干扰。

# php - 按 id 和 name 对查询进行排序

> ID：11165959
> 
> 赞同：0
> 
> 时间：2012-06-23T01:06:20.903
> 
> 标签：php, mysql

我不确定如何问这个问题，但我会尽力而为。我有两张看起来像这样的桌子......

```
id | firstname | lastname
---+-----------+---------
 1 | JD        | Gonzo
 2 | Mike      | Bryan
 etc 
```

另一个是这样的

```
id | staffid | business
---+---------+---------
 1 |    1    | a
 2 |    4    | a
 etc 
```

我想查询第二个表的人员，然后从第一个表中获取他们的名字，并根据第一个表的名字对结果进行排序。我不知道该怎么做，但我考虑过将名称添加到第二个表中，然后根据名称对查询进行排序，但我希望有更好的方法来做到这一点。在此先感谢您的帮助。我对数据库还是有点陌生​​。顺便说一句，我正在使用 PHP 和 MySQL

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T01:11:41.867

假设 staffid 是外键，

`SELECT table2.staffid, table1.firstname FROM table1 INNER JOIN table2 ON table2.staffid = table1.id ORDER BY firstname`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-23T01:11:45.043

您的 select 语句应该看起来像这样

```
$sql =  "SELECT table1.firstname AS firstname, table1.lastname AS lastname 
FROM table1 INNER JOIN table2 ON table2.staffid == table1.id 
ORDER BY table1.firstname ASC"; 
```

# ios5 - 调用 Amazon S3 的 MKNetworkKit 示例

> ID：11165961
> 
> 赞同：1
> 
> 时间：2012-06-23T01:06:43.293
> 
> 标签：ios5, amazon-s3, mknetworkkit

有没有一个很好的例子来说明如何将 MKNetworkKit 与 S3 一起使用？我曾经使用 Asi，但切换到 MKNetworkKit，我还没有发现任何类似的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T03:32:59.017

MKNetworkKit 有一个与亚马逊服务器对话的实验分支“s3”。但我还没有正式支持它。等待几周左右。

# php - 回显 CodeIgniter 文件上传类 upload->data() 数组

> ID：11165962
> 
> 赞同：2
> 
> 时间：2012-06-23T01:06:45.977
> 
> 标签：php, codeigniter, file-upload

我在 CodeIgniter 框架中创建了一个表单，该表单使用 CodeIgniter 手册（[http://codeigniter.com/user_guide/libraries/file_uploading.html](http://codeigniter.com/user_guide/libraries/file_uploading.html)）中的教程成功上传了图像，但是当我尝试获取文件名时，以下代码只是返回'resize/user/w'。任何想法表示赞赏！

```
$type = 'user';   
$imageData = $this->upload->data();

foreach ($imageData as $info) {
   $url = 'resize/' . $type . '/' . $info['file_name'];
}

echo $url; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-24T00:17:53.590

`print_r($imageData);`[将显示来自CI Upload Class](http://codeigniter.com/user_guide/libraries/file_uploading.html)的所有有用的上传数据：

```
Array
(
[file_name]    => mypic.jpg
[file_type]    => image/jpeg
[file_path]    => /path/to/your/upload/
[full_path]    => /path/to/your/upload/jpg.jpg
[raw_name]     => mypic
[orig_name]    => mypic.jpg
[client_name]  => mypic.jpg
[file_ext]     => .jpg
[file_size]    => 22.2
[is_image]     => 1
[image_width]  => 800
[image_height] => 600
[image_type]   => jpeg
[image_size_str] => width="800" height="200"
) 
```

您可以直接引用您想要的属性，如 Cosmin Atanasiu 所说的`$imageData['file_name']`，等等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-23T01:14:43.893

尝试使用：

```
echo $imageData["file_name"]; 
```

# search - 您如何阅读 Google 搜索网址？

> ID：11165963
> 
> 赞同：2
> 
> 时间：2012-06-23T01:06:48.173
> 
> 标签：search

我想编写一个 TextExpander 片段，让我可以在两个任意日期之间进行搜索。为此，我需要能够阅读搜索 URL，但我在网上找不到好的指南。有没有人有什么建议？

# ruby-on-rails - Ruby on Rails 将信息添加到 .find 结果

> ID：11165964
> 
> 赞同：0
> 
> 时间：2012-06-23T01:07:17.963
> 
> 标签：ruby-on-rails, ruby, find

请记住，在回答这个问题时，我对 Rails 完全陌生。我的问题如下：

我有一个 .find 查询的结果数组。该数组被传递给视图并显示每个项目。但是，在传递它之前，我需要向每个 Array 元素添加信息。如果每个元素都是一个数组，我可以使用 <<，如果它是一个哈希，我可以使用 .merge，但由于我不知道它是什么，我不知道如何添加信息.....

希望你能帮我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T01:12:29.927

好的，您的评论稍微澄清了一点。当你这样做时，`User.find(n)`你会得到一个`user`对象。如果你做类似的事情，`User.find(1, 2, 3)`那么你会得到一个对象数组`user`。因此，动态添加可能不是一个理想的解决方案。

但这里有一个 hacky 方法来做到这一点

```
users = User.find(1, 2, 3)
modified_users = users.map { |user| Array(user) << "some value tacked on" } 
```

这会将您的`user`对象转换为数组，然后为其附加一个值。不推荐，但它会满足你的要求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-23T01:20:31.107

你可以找出它们是什么......只是 `puts results.class`

如果您不想弄乱数组中的对象，您可以创建一个包含您添加的信息的数组或散列。

```
results.map do |r|
  Hash[result: r, info: "your information here"]
end 
```

# javascript - 如果页面上不可用，则从托管的 javascript 文件动态加载 jQuery

> ID：11165966
> 
> 赞同：3
> 
> 时间：2012-06-23T01:07:55.240
> 
> 标签：javascript, jquery, dynamic-loading

我正在尝试做的想法是允许客户将我托管的脚本添加到他们的网站上。我希望能够在我的脚本中使用 jQuery，但不能确定它是否始终可用。这是我的代码明智的。到目前为止，这是我托管的 javascript 页面的完整文件，但我无法让它工作。$('title').html 部分只是为了让我看看它是否有效

**我希望我托管的脚本负责在客户网站上包含 jQuery。除了我的脚本之外，我不希望客户端必须包含 jQuery**

```
window.onload = function () {
    if (typeof jQuery == 'undefined') {
        var jq = document.createElement('script'); 
            jq.type = 'text/javascript'; 
            jq.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js';
        var sc = document.getElementsByTagName('script')[0];
            sc.parentNode.insertBefore(jq, sc);
    } 

    console.log($('title').html());

} 
```

这个 javascript 文件位于我的服务器上，我的客户端会以与 google 分析相同的方式包含这个文件。

这是我希望我的客户必须包括的唯一内容。拉取基本和谷歌分析一样

```
<script type="text/javascript">
    var _waq = _gaq || [];
        _waq.push(['PARAM1', 'PARAM2']);

    (function() {
        var wa = document.createElement('script'); 
            wa.type = 'text/javascript'; 
            wa.async = true;
            wa.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'PATH/TO/SCRIPT/wa.js';
        var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(wa, s);
    })();
</script> 
```

当我运行页面时，我收到一条错误消息，`Uncaught ReferenceError: $ is not defined`但是如果我在页面加载后立即输入，`$('title').html();`我会在控制台中返回标题。

我确定这与脚本中 console.log 的运行时间有关，并且还没有让 jQuery 完全加载。我的问题是我如何能够创建一个客户端可以添加的 javascript 页面，如果它不可用动态加载 jquery，并在脚本上的任何其他内容运行之前加载它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-23T01:21:03.707

我的同事只需要解决同样的问题。从他的代码中提取，变量更改以反映您的代码。

```
if(jq.readyState) {
    // For old versions of IE
    jq.onreadystatechange = function() {
        if(this.readyState == 'complete' || this.readyState == 'loaded') {
            // do something...
        }
    }
} else {
    // Other browsers
    jq.onload = function() {
        // do something...
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-23T01:20:00.353

这个适用于所有浏览器

```
function done(){ //on submit function
    alert($);
}

function load(){ //load jQuery if it isn't already
    window.onload = function(){
        if(window.jQuery === undefined){
            var src = 'https:' == location.protocol ? 'https':'http',
                script = document.createElement('script');
            script.onload = done;
            script.src = src+'://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js';
            document.getElementsByTagName('body')[0].appendChild(script);
        }else{
            done();
        }
    }
}

if(window.readyState){ //older microsoft browsers
    window.onreadystatechange = function(){
        if(this.readyState == 'complete' || this.readyState == 'loaded'){
            load();
        }
    }
}else{ //modern browsers
    load();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-23T03:17:13.397

您可以检查 window.jQuery 是否返回 true，如果它不包含该库。像这样的东西。

```
window.onload = function () {
    if (!window.jQuery) {
        var jq = document.createElement('script'); 
        jq.type = 'text/javascript'; 
        jq.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js';
        var sc = document.getElementsByTagName('script')[0];
        sc.parentNode.insertBefore(jq, sc);
    }
    //You had this in the code you posted so I left it there
    console.log($('title').html());
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-23T01:47:28.767

问题已在 SO 中多次讨论

这个线程代表了很多好的观点。点击jquery标签的“votes”标签，将在最高票数列表中看到它

[使用 Google 托管 jQuery 的最佳方式，但退回到我在 Google 上的托管库失败](https://stackoverflow.com/questions/1014203/best-way-to-use-googles-hosted-jquery-but-fall-back-to-my-hosted-library-on-go)

编辑：场景的区别是检查本地与 CDN。针对这种情况反向

# android - 如何获取 onListItemClick 的值并将其传递给另一个活动

> ID：11165967
> 
> 赞同：5
> 
> 时间：2012-06-23T01:08:01.453
> 
> 标签：android

我有一个 listView 里面有信息，当我单击一行时，它必须在该选定行下给我所有详细信息，在该选择行中我有图像、图像名称、价格等，所以当我单击 listView 中的图像时，它必须填充所有信息，包括下一个活动的图像

我试图在我的 listView 上显示，没关系，这是我的代码：

```
public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        JSONObject json = JSONfunctions.getJSONfromURL("http://10.0.2.2/php/p.php");

            try{

                JSONArray  earthquakes = json.getJSONArray("prop");

                for(int i=0;i<earthquakes.length();i++){                        

                    JSONObject e = earthquakes.getJSONObject(i);

                    String BookName = e.getString("P_City");
                    PNames.add(BookName);
                    String BookImg = e.getString("Pname");
                    PImages.add(BookImg);
                }       
            }catch(JSONException e){
                 Log.e("log_tag", "Error parsing data "+e.toString());
            }   

        setListAdapter(new MobileArrayAdapter(this, PNames,PImages));

    }

    @Override
    protected void onListItemClick(ListView l, View v, int position, long id) {

        String selectedValue = (String) getListAdapter().getItem(position);
        Toast.makeText(this, selectedValue, Toast.LENGTH_SHORT).show();

         Intent i = new Intent(getApplicationContext(), Searching.class);
         // sending data to new activity
         i.putExtra("product", selectedValue);
         startActivity(i);

    }
  } 
```

编辑 ：

```
private final Context context;
    private final String[] myBookNamelist = null;
    private ArrayList<String> MyP = new ArrayList<String>();
    private ArrayList<String> myPurl = new ArrayList<String>();
     //ArrayList<HashMap<String, String>> myBookNamelist = new ArrayList<HashMap<String, String>>();
     //ArrayList<HashMap<String, String>> myBookImageurl = new ArrayList<HashMap<String, String>>();

    public MobileArrayAdapter(Context context,ArrayList<String> Bname,ArrayList<String> BUrl) {
        super(context, R.layout.list_mobile, Bname);
        this.context = context;
        this.MyP = Bname;
        this.myPurl = BUrl;
    }

    public View getView(int position, View convertView, ViewGroup parent) {
        LayoutInflater inflater = (LayoutInflater) context
                .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        View rowView = inflater.inflate(R.layout.list_mobile, parent, false);
        TextView textView = (TextView) rowView.findViewById(R.id.label);
        ImageView imageView = (ImageView) rowView.findViewById(R.id.logo);
        textView.setText(MyP.get(position));
        Bitmap bitmap = null;
        // Change icon based on name
        JSONObject json = JSONfunctions.getJSONfromURL("http://10.0.2.2/php/p.php");
           // http://api.geonames.org/earthquakesJSON?north=44.1&south=-9.9&east=-22.4&west=55.2&username=demo  
            try{

                JSONArray  earthquakes = json.getJSONArray("prop");

                //for(position=0;position<earthquakes.length();position++){
                    JSONObject e = earthquakes.getJSONObject(position);
                    String BB = e.getString("P_City");
                    MyP.add(BB);

                    String UU = e.getString("Pname");
                    myPurl.add(UU);

                //}

            }catch(JSONException e){
                 Log.e("log_tag", "Error parsing data "+e.toString());
            }

            String s = MyP.get(position);
            String i = myPurl.get(position);

            System.out.println(s);
            System.out.println(i);

            try {
                bitmap = BitmapFactory.decodeStream((InputStream)new URL(i).getContent());
            } catch (MalformedURLException err) {
                // TODO Auto-generated catch block
                err.printStackTrace();
            } catch (IOException err) {
                // TODO Auto-generated catch block
                err.printStackTrace();
            }

            //if (!s.equals("")) {
                imageView.setImageBitmap(bitmap);
            //} else {
            System.out.println("Bitmap image: "+position+"="+bitmap);
                //imageView.setImageResource(R.drawable.android_logo);
            //}

        return rowView;
    }
} 
```

我可以将位置传递给下一堂课，但是如何从选定的行中获取所有信息？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-27T13:11:45.023

我正在尝试这段代码两天，然后我得到了它，所以就这样了.. OnListItemClick 将传递一个位置：

```
@Override
    protected void onListItemClick(ListView l, View v, int position, long id) {

        String selectedValue = (String) getListAdapter().getItem(position);
        Toast.makeText(this, selectedValue, Toast.LENGTH_SHORT).show();

Intent moreDetailsIntent = new Intent(ListMobileActivity.this,PropertiesDetails.class);

        Bundle dataBundle = new Bundle();
        dataBundle.putString("SelectedProperty", selectedValue);
        moreDetailsIntent.putExtras(dataBundle);
        startActivity(moreDetailsIntent);

    } 
```

然后第二类将收到包括图像在内的值：

```
String Price,Desc,City,rooms,address,size,garage,sold,Pname,image1,image2,image3;
    Bitmap bitmap,bitmap1,bitmap2,bitmap3;
    TextView txtPrice,txtDesc,txtCity,txtrooms,txtaddress,txtsize,txtgarage,txtsold;
    ImageView imgpropertyImage,imgpropertyImage2;
    String result = null;
    InputStream is = null; 
    StringBuilder sb=null;
    Button btnNext,btnPrevs;
    int imgcount = 1;
    JSONPARSER jsonParser = new JSONPARSER();
    private static String url_create_product = "http://10.0.2.2/php/ViewPropertiesByName.php";
    // JSON Node names
   // private static final String TAG_SUCCESS = "success";

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.thenew);

        txtPrice = (TextView) findViewById(R.id.price);
        txtDesc = (TextView) findViewById(R.id.desc);
        txtCity  = (TextView) findViewById(R.id.City);
        txtrooms = (TextView) findViewById(R.id.Rooms);
        txtaddress = (TextView) findViewById(R.id.Address);
        txtsize  = (TextView) findViewById(R.id.Size);
        txtgarage  = (TextView) findViewById(R.id.garage);
    //  txtsold  = (TextView) findViewById(R.id.sold);      
        imgpropertyImage = (ImageView) findViewById(R.id.imageViewProp);
        imgpropertyImage2 = (ImageView) findViewById(R.id.imageViewProp2);
        btnNext =(Button) findViewById(R.id.btnNext);
        btnPrevs =(Button) findViewById(R.id.btnPrevis);

Bundle b = getIntent().getExtras(); // Getting the Bundle object that pass from another activity
String SelectedProperty = b.getString("SelectedProperty");

////////////////////////Executing A Search Query//////////////////////////////////
List<NameValuePair> postParameters = new ArrayList<NameValuePair>();
postParameters.add(new BasicNameValuePair("P_City",SelectedProperty));

//getting JSON Object
// Note that create product url accepts POST method
 JSONObject json = jsonParser.makeHttpRequest(url_create_product,
         "POST", postParameters);
// check log cat fro response
Log.d("Create Response", json.toString());

/////////////Getting Jason Object from the search Query and displaying results
try{

    JSONArray  earthquakes = json.getJSONArray("PropertyDetails");

    for(int i=0;i<earthquakes.length();i++){                        

        JSONObject e = earthquakes.getJSONObject(i);

        Price = e.getString("P_Price");
        Desc = e.getString("P_Desc");
        City = e.getString("P_City"); 
        rooms = e.getString("P_Rooms");
        address = e.getString("P_Address");
        size = e.getString("P_Size");
        garage = e.getString("P_garage");
        //sold = e.getString("P_Sold");
        Pname = e.getString("Pname");
        image1 = e.getString("image1");
        image2 = e.getString("image2");
        image3 = e.getString("image3");

        //BookImages.add(BookImg);

    } 
```

我帮助那些将来和我有同样问题的人:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-23T02:51:08.877

我相信您正在扩展`ArratAdapter`并且必须在 .`row.xml`下膨胀`getView`。假设您的 row.xml 具有属性 imagename 和 price。然后您将使用类似下面的代码片段来提取这些值。

```
mListView.setOnItemClickListener(new OnItemClickListener() {
        public void onItemClick(AdapterView <? > myAdapter, View myView, int myItemInt, long mylng) {

            String imageName = ((TextView) myView.findViewById(R.id.imageName)).getText().toString();
            String price = ((TextView) myView.findViewById(R.id.price)).getText().toString();

        }

    }); 
```

# javascript - 使用 Javascript 的 replace() 方法用 html 包装一个单词

> ID：11165971
> 
> 赞同：1
> 
> 时间：2012-06-23T01:08:34.037
> 
> 标签：javascript, jquery, replace

我正在尝试使用 Javascript 的内置`replace()`方法，但由于某种原因，它不允许我将 html 包裹在一个单词周围并将其输出到 textarea。

```
$(function() {
    $('#js-convert-markup').click(function() {
        var htmlToConvert = $('.markup_converter').val();
        htmlToConvert.replace('class', '<span class="admin_styles_type">class</span>');
        var convertedMarkup = $('.markup_converted').val(htmlToConvert);
    });
});​ 
```

[http://jsfiddle.net/someprimetime/fmu5m/11/](http://jsfiddle.net/someprimetime/fmu5m/11/)

知道为什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-23T01:11:28.847

replace 返回一个新字符串，它不会改变原始字符串。你需要做：

```
htmlToConvert = htmlToConvert.replace(...) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-23T01:11:00.770

尝试使用：

```
htmlToConvert = htmlToConvert.replace('class', '<span class="admin_styles_type">class</span>'); 
```

字符串在 JavaScript 中是不可变的。

[http://jsfiddle.net/a26nf/](http://jsfiddle.net/a26nf/)

# sql - SQL，如何检查选择的结果是否排除了与另一个表匹配的字符串的所有结果

> ID：11165973
> 
> 赞同：0
> 
> 时间：2012-06-23T01:08:46.143
> 
> 标签：sql, sql-like

我是 sql 的新手，正在尝试学习如何做事请帮我解决这个问题！

我有两张桌子

Table1 有一个句子列表，它有 1 列和 100 行

Table2 有一个单词列表，它有 1 列和 5 行

我想选择 Table1 中找到单词“john”的所有行，但如果 Table2 中的单词也存在于该行中，则不会。这是例外列表

我怎样才能用 SQL 做到这一点？

我一直在尝试一些括号组合，但我不知道我在做什么：

```
SELECT "desc" FROM table 
WHERE "desc"LIKE "%matchedword1%" 
OR "desc" LIKE "%someotherword%" 
AND (SELECT string FROM exceptions) NOT IN "desc"; 
```

帮助！谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-23T01:11:24.573

```
SELECT "desc" FROM table 
WHERE ("desc" LIKE "%matchedword1%" OR "desc" LIKE "%someotherword%") 
AND "desc" NOT IN (SELECT string FROM exceptions); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T01:52:24.973

实际上，您没有将条件语句括在括号中，因此请以这种方式编写此查询：

```
SELECT "desc" FROM table WHERE("desc" LIKE "%matchedword" OR "desc" LIKE "%otherword") 
AND "desc" NOT IN (SELECT string from exception); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-23T01:15:24.463

你可能忘记了括号：

```
SELECT "desc" FROM table 
WHERE ("desc"LIKE "%matchedword1%" 
OR "desc" LIKE "%someotherword%")
AND "desc" NOT IN (SELECT string FROM exceptions); 
```

“AND”总是比“OR”具有更高的优先级。

# html - $.ajax 不保存返回中断

> ID：11165974
> 
> 赞同：1
> 
> 时间：2012-06-23T01:08:58.707
> 
> 标签：html, ajax, jquery

```
$.ajax({    
                type: 'get',
                url:  'message.php',
                data: 'msg=' + msg + '&fromname=' + fromname + '&fromemail=' + fromemail,               
                beforeSend: function() {},  
                success: function() { } 
}); 
```

我使用以下方法通过 ajax 将变量发送到 message.php message.php 然后使用“ `data`”更新数据库（mysql）。我遇到的问题是它将 2 行或更多行更改为 1 个连续行。所以它会跳过返回休息时间。这是文本区域：

```
<textarea class="textar" onchange="save();" onclick="this.value=''"  cols="45" rows="5">What would you like to say in the email?</textarea> 
```

请问有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-23T01:11:55.913

将其更改为：

```
$.ajax({    
    'type': 'get',
    'url': 'message.php',
    'data': {
        'msg': msg,
        'fromname': fromname,
        'fromemail': fromemail
    },
    'beforeSend': function() {},  
    'success': function() { } 
}); 
```

这应该正确地对您传入的值进行 url 编码`data`。

我猜这个问题发生的原因是因为你传递了一个字符串，因此你没有依赖 jQuery 的编码机制。

# jquery - 我如何要求 jquery ui 可拖动包含相对于父级？

> ID：11165980
> 
> 赞同：1
> 
> 时间：2012-06-23T01:10:19.620
> 
> 标签：jquery, jquery-ui, jquery-ui-draggable

我有以下问题：http: [//jsfiddle.net/DerNa/12/](http://jsfiddle.net/DerNa/12/)

这里更清楚地展示了“跳跃”：http: [//jsfiddle.net/DerNa/11/](http://jsfiddle.net/DerNa/11/)

基本上，正在发生的事情是包含相对于窗口（在这种情况下是框架，通过偏移父级 200px 来证明），这是不可取的。是否有可能让它与父母相关？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T01:18:28.110

根据文档使用

```
containment:'parent' 
```

[http://jqueryui.com/demos/draggable/#option-containment](http://jqueryui.com/demos/draggable/#option-containment)

查看“选项选项卡”

# javascript - 如何使用 javascript 从官方 Facebook 按钮捕获 Facebook 点赞数？

> ID：11165985
> 
> 赞同：0
> 
> 时间：2012-06-23T01:11:23.317
> 
> 标签：javascript, jquery, facebook, facebook-graph-api, facebook-javascript-sdk

我已经尝试过这段代码，但它一直返回未定义：

```
setTimeout("alert($('div.connect_widget_button_count_count').val());", 10000); 
```

我等待 10 秒以允许加载臃肿的 facebook 按钮和计数器。

然后，我使用带有**class='connect_widget_button_count_count'的****div**的值发出警报，加载到网页时通常如下所示：

 **```
<div class='connect_widget_button_count_count'>4</div> 
```

4 是官方的 Facebook“计数”数字。

**如何从官方 Facebook 按钮将 Facebook 喜欢/分享/计数作为 javascript 变量捕获？**

根据萤火虫，这是周围的 HTML 的样子：

```
<table class="connect_widget_interactive_area">
   <tbody>
    <tr>
        <td class="connect_widget_button_count_excluding">
            <table class="uiGrid" cellspacing="0" cellpadding="0">
                <tbody>
                    <tr>
                        <td>
                           <div class="connect_widget_button_count_count">2</div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
     </tr>
    </tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T01:21:13.127

```
$('div.connect_widget_button_count_count').text(); 
```

div 没有要检索的值。请参阅[http://api.jquery.com/val/](http://api.jquery.com/val/)

> .val() 方法主要用于获取输入、选择和文本区域等表单元素的值。在元素的情况下， .val() 方法返回一个包含每个选定选项的数组；如果未选择任何选项，则返回 null。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-23T10:21:10.230

facebook 插件在 iframe 中呈现，该 iframe 的域不同于您页面的域（因为您没有在 facebook.com 上托管它），因此您无权访问该文档。

浏览器会阻止不共享同一域的文档之间的通信。**

# javascript - 当通过JS更改值时，jQuery选择不触发onchange事件

> ID：11165987
> 
> 赞同：9
> 
> 时间：2012-06-23T01:11:25.160
> 
> 标签：javascript, jquery, jquery-chosen

# [**JSFiddle**](http://jsfiddle.net/ult_combo/y6BCP/)

我在小提琴中设置了`select`3`option`秒（1 个空白）。当我从手动切换时，`foo`侦听器会正常触发。`bar``change`

[现在，如果我使用此处发布的一些答案中的代码](https://stackoverflow.com/questions/7897760/jquery-chosen-reset)重置`select`通过 JS，则不会为新选择的空白选项触发事件，此外，如果我选择在单击按钮之前选择的选项，则事件也不会触发.`change``reset``onchange`

我确定`select`' 的值**正在**使用上面的函数进行更改，这可以在这个[**fiddle**](http://jsfiddle.net/ult_combo/y6BCP/1/)中看到，但是`select`'`onchange`事件根本不会触发。

我也试过`onchange`, `onclick`,`oninput`事件无济于事。现在我想知道是否应该使用 MutationObserver 或从 DOM 中删除呈现的选定元素并创建另一个，但我可能想多了。任何帮助表示赞赏。

还：

这个答案对我帮助很大：[jQuery Chosen reset](https://stackoverflow.com/questions/7897760/jquery-chosen-reset)

这个答案没有帮助：[如何在选择的原型 javascript 选择框中触发 onchange 事件？](https://stackoverflow.com/questions/8455569/how-to-fire-onchange-event-in-chosen-prototype-javascript-select-box)

如果 jsfiddle.net 被删除，供将来参考的代码：

**HTML**

```
<div id="wrapper">
    <select id="chosen">
        <option value="!!EMPTY VALUE!!"></option>
        <option value="foo">foo</option>
        <option value="bar">bar</option>
    </select>
</div>
<br>
<button id="reset">Reset</button> 
```

**JS**

```
$(function() {
    $('#chosen').chosen();

    $('#wrapper').on('change', '#chosen', function() {
        console.log('onchange: ' + this.value);
    });

    $('#reset').click(function() {
        $("#chosen").val('').trigger("liszt:updated"); //doesn't work
        //$("#chosen").prop('selectedIndex', 0).trigger("liszt:updated"); //doesn't work either
        console.log('reset: ' + $('option:selected').val());
    });
}); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-23T01:15:54.693

您需要在更改值后触发更改`$(selector).trigger("change")`

```
$('#reset').click(function() {
        $("#chosen").val('').trigger("change"); //doesn't work
        //$("#chosen").prop('selectedIndex', 0).trigger("liszt:updated");
        console.log('reset: ' + $('option:selected').val());
    }); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-28T20:24:17.110

从 Fabrício Matté 的评论中复制一个对我有用的答案，这样其他人就不会像我一样看到这篇文章并错过一个解决方案。

```
$('#chosen_chzn').remove();
$('#chosen').val('').change().removeClass('chzn-done').chosen(); 
```

[在他的小提琴上看到这个](http://jsfiddle.net/ult_combo/y6BCP/2/)

我最初尝试继续使用`.trigger('liszt:updated')`call 而不是 the ，`.change()`但这没有用。也没有看到背后的原因`.removeClass('chzn-done')`，但这也是必不可少的，否则您的选择框将消失。

# opencl - OpenCL 纹理/表面引用必须是简单名称

> ID：11165992
> 
> 赞同：0
> 
> 时间：2012-06-23T01:11:47.803
> 
> 标签：opencl

编译内核时出现以下错误：

```
 Error: (0): Texture/surface reference must be simple name 
```

我尽可能将其缩减为以下示例内核，它演示了问题：

```
__kernel void accum(__global __read_only image2d_t accumulateds) {
    int2 pos = (int2)(get_global_id(0),get_global_id(1));
    float4 accum = read_imagef(accumulateds,CLK_RGBA|CLK_ADDRESS_CLAMP|CLK_FILTER_NEAREST,pos);
} 
```

我发现了一些无用的[论坛](http://forums.nvidia.com/index.php?showtopic=219048)。[帖子](http://www.facepunch.com/threads/1167392/25).，但除此之外没有提到这个错误。此外，我还看到了与上述示例相似的示例代码。我的 GPU（GeForce 580M GTX）应该支持读取图像（它支持写入，一方面）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-24T04:33:33.957

经过深思熟虑，我找到了原因。我的猜测是 read_imagef 是一个看不懂的宏 | 指令，所以他们硬编码了一个预处理器检查。显然，这个问题特定于 NVIDIA 硬件（或者可能是我的特定实现），因为以第一种方式编写的代码适用于其他人。

方法1（失败）：

```
float4 my_value = read_imagef(my_image,CLK_FILTER_NEAREST|CLK_ADDRESS_CLAMP,my_position); 
```

方法2（有效）：

```
sampler_t my_sampler = CLK_FILTER_NEAREST|CLK_ADDRESS_CLAMP;
float4 my_value = read_imagef(my_image,my_sampler,my_position); 
```

作为附加说明，在我的原始代码中，我使用了 CLK_RGBA。这是不正确的，并且会导致错误。一定是[这里](http://www.khronos.org/registry/cl/sdk/1.0/docs/man/xhtml/sampler_t.html)的字段之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-10T23:36:23.103

首先，我无法对问题或已发布的答案添加评论，因此我将其发布为答案。对于那个很抱歉。

因此，即使在添加了您指定的采样器标志后，我也会遇到同样的错误。我什至尝试将它作为参数传递给内核，但错误仍然存​​在..