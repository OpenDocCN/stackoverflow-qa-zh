# StackOverflow 问答 000262000-000262999

# c++ - 检查向量是否已排序的最佳算法

> ID：262000
> 
> 赞同：18
> 
> 时间：2008-11-04T14:15:09.577
> 
> 标签：c++, algorithm, optimization, vector

检查 a`std::vector`是否已排序的最佳方法是什么？有没有比循环检查更快的东西`v[i]<=v[i+1]`？迭代器是否更快/更清洁？还是`sort`每次都调用实际上更好（尽管“v 已经排序”的情况很常见）？

我们可以安全地假设向量只包含 POD，通常是`float`s，有时`double`是 s 和`int`s。

向量的大小是非平凡的（通常是几千个项目）但不是极端的（不是千兆字节大小）。

*   在某些情况下，我们会在之后立即对向量进行排序，但是在其他情况下我们不这样做（这是我们算法的错误情况）。
*   我们已经尽可能使用标志“IsSorted”。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-11-04T14:16:52.037

> 有比循环检查 v[i]<=v[i+1] 更快的方法吗？

不。

如果这是您希望经常检查的内容，您可能希望创建一个包装类，该类保留一个“排序”标志，该标志以 False 开头，每当添加项目时设置为 False，并添加一个成员函数 sort() 设置排序后标志为True。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-11-04T15:07:40.033

最好的方法是使用[`std::is_sorted`](http://en.cppreference.com/w/cpp/algorithm/is_sorted)：

```
is_sorted(v.begin(), v.end()) 
```

:-)

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-11-04T16:57:26.847

**考虑多个 CPU 核心**

这取决于您的平台和向量中的项目数。您必须进行基准测试才能找到最好的。

无法回答：有没有比循环检查 v[i]<=v[i+1] 更快的方法？
没有。

因为......现在的计算机有多个 cpu/cores/hyperthreading。因此，通过将检查工作拆分到多个线程来利用计算机中的并行性可能要快得多，因此每个 cpu 可以并行检查一个小范围。

最好通过库函数而不是自己实现它来做到这一点。新版本的库将利用并行性。因此，如果您选择 std::sort，您可能会发现，当您针对新的 STL 实现进行构建时，它们会为您并行执行操作，而您不必担心。我不知道是否有现成的 STL 版本已经可以做到这一点，但值得坚持使用库函数，这样当您升级到有此功能的版本时，这种优化就在那里，您无需进行任何更改.

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-05-20T22:26:21.600

```
std::adjacent_find(v.begin(), v.end(), std::greater<type>()) == v.end() 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-11-04T15:14:14.823

当然我不知道你的问题领域，所以如果我说的不相关，请忽略我，但在我看来，如果我需要一个集合在我访问它时总是被排序，一个自然未排序的集合，如`vector<T>`可能不是最好的选择。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-11-04T14:18:41.143

> 有比循环检查 v[i]<=v[i+1] 更快的方法吗？

您将需要检查任何值以查看它是否已排序，因此它不会比 O(n) 更快，除非您在变异向量时自己跟踪更改或使用已排序的数据结构。

> 还是每次都调用 sort 实际上更好（尽管“v 已经排序”的情况很常见）？

请记住，当列表已经排序（并且枢轴选择不正确）时，会发生快速排序最坏情况的行为。为了避免这种行为，您可能需要检查 std::stable_sort 作为替代品。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-04T16:32:49.283

如果您希望列表非常接近排序，尝试修改[插入排序](http://en.wikipedia.org/wiki/Insertion_sort)可能会有所帮助。如果列表已经排序，它只会执行一次并告诉您。如果列表非常接近排序，它将很快排序。如果列表未排序，则在交换一些次数后中断排序并切换到快速排序（或 stable_sort）。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-02-10T08:34:19.870

C++-11 在 <algorithm> 中包含 is_sorted。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-04T14:29:27.800

> 有比循环检查 v[i]<=v[i+1] 更快的方法吗？

不。

但是，如果您要执行检查以决定是否对向量进行排序，那么**如果**您使用正确的排序算法，即 std::stable_sort 而不是 std::sort，则最好总是排序。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-04T14:18:49.350

为了检查排序，您必须检查每个项目。所以 v[i]<=v[i+1] 是最快的检查。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-04T16:15:33.763

正如其他人所指出的，确定排序状态的谓词是 O(n)。但是从你提到的排序标志，我有点想知道你是否不想要这样的东西：

我们的应用程序的基础库包括一个可以查询成员资格的容器类。这是一个简短的草图：

```
class ObjList {
public:
    ObjList() {};
    ~ObjList() {};

    bool isMember(const Item *);
    void add(const Item *, bool sort = false);

private:

    unsigned int last_sorted_d;

    bool sorted_d;
    unsigned int count_d;
    Item *store_d;
}; 
```

*isMember()对元素的**排序范围*使用二进制搜索，然后对排序范围之后的项目进行线性搜索。根据程序员的选择，插入可以触发或不触发某种项目。例如，如果你知道你将在一个紧密的循环中添加数千个项目，那么在最后插入之前不要排序。

上面只是一个草图，存储比指针数组更复杂，但你明白了。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-20T16:26:12.887

如果在插入项目时使用二进制搜索来查找插入点，那么它永远不会被排序。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-10-11T13:18:32.253

如果您的 C++ 标准库实现包含算法 is_sorted()，那么它是最佳选择。

# sql - 什么是“SQL 提示”？

> ID：262004
> 
> 赞同：5
> 
> 时间：2008-11-04T14:15:28.217
> 
> 标签：sql, hibernate, orm

我是 ORM 解决方案的倡导者，有时我会举办有关 Hibernate 的研讨会。

在谈论框架生成的 SQL 时，人们通常会开始谈论他们需要如何使用“提示”，而这对于 ORM 框架来说是不可能的。

通常是这样的：“我们尝试过 Hibernate。一开始它看起来很有希望，但是当我们让它在我们非常复杂的生产数据库上松动时，它就崩溃了，因为我们无法应用提示！”。

但是当被问到一个具体的例子时，那些人的记忆突然变得不那么清晰了……

我通常会感到害怕，因为整个“提示”主题对我来说听起来像是伏都教......所以有人可以启发我吗？SQL 提示或 DB 提示是什么意思？

我唯一知道的，某种程度上“类似提示”的是 SELECT ... FOR UPDATE。但这得到了 Hibernate-API 的支持......

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-04T14:25:52.347

SQL 语句，尤其是复杂的 SQL 语句，实际上可以由数据库引擎以多种不同的方式执行（首先读取连接中的哪个表，根据许多不同的参数使用哪个索引等）。

有经验的 dba 可以使用提示来*鼓励*DB 引擎在生成其执行计划时选择特定的方法。您通常只需要在对特定查询进行广泛测试和分析后执行此操作（因为数据库引擎通常非常擅长找出最佳执行计划）。

这里有一些特定于 MSSQL 的讨论和语法：http:
[//msdn.microsoft.com/en-us/library/ms181714.aspx](http://msdn.microsoft.com/en-us/library/ms181714.aspx)

[编辑： http://geeks.netindonesia.net/blogs/kasim.wirama/archive/2007/12/31/sql-server-2005-query-hints.aspx](http://geeks.netindonesia.net/blogs/kasim.wirama/archive/2007/12/31/sql-server-2005-query-hints.aspx)的一些附加示例

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-04T15:54:27.613

默认情况下，查询提示用于指导查询优化器不产生合理的查询计划。首先，查询优化器的小背景：

数据库编程与几乎所有其他软件开发不同，因为它有一个机械组件。与 CPU 相比，磁盘寻道和旋转延迟（等待特定扇区到达磁盘磁头下方）非常昂贵。不同的查询解析策略将导致不同数量的 I/O，通常是完全不同的数量。判断正确或错误会对查询的性能产生重大影响。有关查询优化的概述，请参阅[本文。](http://ftp://ftp.research.microsoft.com/users/surajitc/pods98-tutorial.pdf)

SQL 是声明性的——您指定查询的逻辑并让 DBMS 弄清楚如何解决它。现代的基于成本的查询优化器（某些系统，例如 Oracle 还保留了旧的查询优化器以实现向后兼容性）将对查询运行一系列转换。它们保持语义等价，但在操作的顺序和选择上有所不同。根据在表上收集的统计信息（大小、键的分布直方图），优化器计算每个查询计划所需工作量的估计值。它选择最有效的计划。

基于成本的优化是启发式的，并且依赖于准确的统计数据。随着查询复杂性的增加，启发式可能会产生不正确的计划，这可能会非常低效。

在这种情况下，可以使用查询提示来强制查询计划中的某些策略，例如连接类型。例如，在通常返回非常小的结果集的查询中，您可能希望强制使用嵌套循环连接。您可能还希望强制表的某个连接顺序。

O/R 映射器（或任何生成 SQL 的工具）会生成自己的查询，该查询通常没有提示信息。如果此查询运行效率低下，您的选项有限，其中一些是：

*   检查表上的索引。可能您可以添加索引。某些系统（例如最新版本的 Oracle）允许您在多个表中建立索引连接。

*   一些数据库管理系统（再次想到 Oracle）允许您手动将查询计划与特定查询字符串相关联。查询计划由查询的哈希值缓存。如果查询是参数化的，则基本查询字符串是恒定的，并将解析为相同的哈希值。

*   作为最后的手段，您可以修改数据库模式，但这只有在您控制应用程序时才有可能。

如果您控制 SQL，则可以提示查询。在实践中，实际需要这样做是相当少见的。在具有复杂数据库模式的 O/R 映射器上更常见的故障模式是它们可能难以表达复杂的查询谓词或对大量数据进行复杂的操作。

我倾向于主张将 O/R 映射器用于它适合的 98% 的工作，并在它们是合适的解决方案的地方使用存储过程。如果您确实需要提示查询，那么这可能是合适的策略。除非您的应用程序有什么不寻常的地方（例如某种 DSS），否则您只需要在少数情况下从 O/R 映射器中逃脱。您可能还会发现（同样，一个示例是使用聚合数据的 DSS 工具）O/R 映射器并不是真正适合应用程序的策略。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-04T14:31:45.347

虽然 HINTS 与其他答案描述的一样，但您应该只在极少数经过研究的情况下使用它们。HINT 10 次中有 9 次会导致查询计划不佳。除非你真的知道自己在做什么，否则不要使用它们。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-04T14:27:39.490

所有现代 RDBMS-es 都有某种查询优化器来计算最佳查询计划，这是执行 SQL 查询所需的读/写操作序列。

有时计划可能不是最理想的，因此 RDBMS 设计者在 SQL 中包含“提示”。提示是您可以嵌入到影响查询优化器的 SQL 中的指令，通过提示，您可以指示查询优化器，例如它应该使用哪些索引，应该以什么顺序从表中读取数据，......

因此，通过提示，您可以解决一些查询优化器无法自行解决的瓶颈。

例如，这里是[Oracle 提示](http://www.psoug.org/reference/hints.html)列表。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-04T16:50:11.587

没有“优化的 SQL 代码”之类的东西，因为 SQL 代码永远不会被执行。

SQL 代码由优化器转换为执行计划。优化器将使用它必须选择的信息（除其他外）。

*   涉及表的顺序
*   每个涉及的表的连接方法（嵌套/合并/散列）
*   如何访问表的数据（直接表访问/带有书签查找的索引/直接索引访问）（扫描/查找）
*   应该使用并行性，以及何时结束并行性（收集流）

查询提示允许程序员覆盖（在大多数情况下）或礼貌地建议（在其他情况下）优化器的选择。

查询提示可以让您强制关闭并行性，强制所有连接实现为嵌套循环，强制使用一个索引而不是另一个索引......作为一些示例。

由于优化器***非常好***，如果一个人超越了优化器，通常会要求一个非最佳计划。当优化器没有做出正确选择所需的信息时，最好使用查询提示。

我使用查询提示的一个地方是表变量。优化器假定表变量有 0 行，因此优化器总是使用嵌套循环连接表变量（少量行的最佳连接实现）。如果我有一个大表变量 - 已经以对合并联接有利的方式排序，我可以通过应用查询提示来指定要使用的合并联接。

# asp.net-mvc - 在 Visual Studio 中插入替换字符的最快方法

> ID：262012
> 
> 赞同：2
> 
> 时间：2008-11-04T14:16:54.267
> 
> 标签：asp.net-mvc, visual-studio, visual-studio-2008, keyboard-shortcuts

我刚开始学习 ASP.Net MVC，发现自己在视图中写了很多 <%= %> 。Intellisense 确实提供了结尾的 %>，但我发现输入介绍性的 <%= 很麻烦（我很难输入 :-)）。

我对 Rails 和 NetBeans IDE 进行了一些尝试，我可以在其中输入：

```
r<tab>  - which would expand to <%  %> 
```

和

```
re<tab>  - which would expand to <%= %> 
```

可以在 Visual Studio 2008 IDE 中完成类似的操作吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-04T16:52:45.093

根据评论，我仔细检查了下面的片段答案，不幸的是它没有在 HTML 视图中运行。另一种方法是通过录制的宏：

*   在您的 Web 项目中，开始录制：`CTRL`+ `SHIFT`+`R`
*   键入`<%= %>`然后将插入符号返回到“=”之后的空格之间
*   停止录制：`CTRL`+ `SHIFT`+`R`
*   `CTRL`通过++插入`SHIFT`宏`P`

这*可能*就足够了，但最好在所有项目中都有它，而且我们想要一个比`CTRL`+ `SHIFT`+更好的击键`P`：

*   保存宏：Tools->Macros->Save Temporary Macro，给它一个名字
*   将其绑定到按键组合：
    *   工具->选项，然后选择键盘节点
    *   搜索您选择的名称
    *   输入组合键（例如`ALT`+ `A`）并单击 OK

现在您可以在 HTML 视图中按下快捷键（例如`ALT`+ `A`），它将插入 <%= %>，并将插入符号放置在标签中，准备好输入。

* * *

[旧答案：不幸的是，在 HTML 视图中不起作用。]

对于代码片段，使用名称、快捷方式和扩展名创建一个 XML 片段文件（例如“asp.snippet”），然后使用工具 -> 代码片段管理器添加存储片段的文件夹。

这是（通过“asp[tab][tab]”）扩展“<%= [code] %>”的片段的 XML

```
<?xml version="1.0" encoding="utf-8"?>
<CodeSnippet Format="1.0.0"  xmlns="http://schemas.microsoft.com/VisualStudio/2005/CodeSnippet">
  <Header>
    <Title>ASP Server Tags</Title>
    <Author>Chris Bowen</Author>
    <Shortcut>asp</Shortcut>
    <Description>ASP.NET server escape characters, including equals</Description>
    <SnippetTypes>
      <SnippetType>SurroundsWith</SnippetType>
      <SnippetType>Expansion</SnippetType>
    </SnippetTypes>
  </Header>
  <Snippet>
    <Declarations>
      <Literal>
        <ID>code</ID>
        <Default>Code</Default>
      </Literal>
    </Declarations>
    <Code Language="csharp">
      <![CDATA[<%= $code$ $selected$%>$end$]]>
    </Code>
  </Snippet>
</CodeSnippet> 
```

更多详细信息[在 MSDN 上](http://msdn.microsoft.com/en-us/library/ms165392.aspx)。

顺便说一句，VS 有一个片段来创建片段。只需打开一个新的 XML 文件，然后右键单击并选择“插入片段”->“片段”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-04T16:52:59.850

这个宏函数应该这样做：

主代码将做两件事之一，如果没有选择它只会插入 <%= %> 代码结构，如果您当前在编辑器中选择了一些东西，它将用结构 EG <%= selected 包装该代码代码在这里 %>

```
Public Sub WrapMVC()
    Try
        DTE.UndoContext.Open("Wrap MVC")
        Dim OutText As String = ""
        Dim OutFormat As String = "<%={0} %>"
        DTE.ActiveDocument.Selection.Text = String.Format(OutFormat, ActiveWindowSelection)
    Finally
        DTE.UndoContext.Close()
    End Try
End Sub 
```

**辅助例程：**

```
Friend Function ActiveWindowSelection() As String
    If DTE.ActiveWindow.ObjectKind = EnvDTE.Constants.vsWindowKindOutput Then
        Return OutputWindowSelection()
    End If
    If DTE.ActiveWindow.ObjectKind = "{57312C73-6202-49E9-B1E1-40EA1A6DC1F6}" Then
        Return HTMLEditorSelection()
    End If
    Return SelectionText(DTE.ActiveWindow.Selection)
End Function

Private Function HTMLEditorSelection() As String
    Dim hw As EnvDTE.HTMLWindow = ActiveDocument.ActiveWindow.Object
    Dim tw As TextWindow = hw.CurrentTabObject
    Return SelectionText(tw.Selection)
End Function

Private Function OutputWindowSelection() As String
    Dim w As Window = DTE.Windows.Item(EnvDTE.Constants.vsWindowKindOutput)
    Dim ow As OutputWindow = w.Object
    Dim owp As OutputWindowPane = ow.OutputWindowPanes.Item(ow.ActivePane.Name)
    Return SelectionText(owp.TextDocument.Selection)
End Function

Private Function SelectionText(ByVal sel As EnvDTE.TextSelection) As String
    If sel Is Nothing Then
        Return ""
    End If
    If sel.Text.Length <= 2 Then
        SelectWord(sel)
    End If
    If sel.Text.Length <= 2 Then
        Return ""
    End If
    Return sel.Text
End Function

Private Sub SelectWord(ByVal sel As EnvDTE.TextSelection)
    Dim leftPos As Integer
    Dim line As Integer
    Dim pt As EnvDTE.EditPoint = sel.ActivePoint.CreateEditPoint()

    sel.WordLeft(True, 1)
    line = sel.TextRanges.Item(1).StartPoint.Line
    leftPos = sel.TextRanges.Item(1).StartPoint.LineCharOffset
    pt.MoveToLineAndOffset(line, leftPos)
    sel.MoveToPoint(pt)
    sel.WordRight(True, 1)
End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T14:33:50.083

我相信[代码片段](http://www.dotnetjunkies.ddj.com/Article/C95AC204-DE44-4D4A-A2B7-1EB1BE14A8A1.dcik)会符合要求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T16:10:17.673

我发现直接编写宏然后将其绑定到键盘命令。

我使用 Tools->Macros->Macro Explorer 来查看其中的内容，您可以创建一个新模块并添加一个宏来注入您的代码。然后你用工具->自定义->键盘将它绑定到一个键...

由于它与您正在做的事情并没有太大的不同，这里有一个宏来注入带有日期和用户名的源命令 - VBScript - 我并没有努力寻找其他替代方案。

```
Imports System
Imports EnvDTE
Imports EnvDTE80
Imports EnvDTE90
Imports System.Diagnostics

Public Module Module1

    Private Function GetUserName() As String
        GetUserName = System.Environment.UserName
    End Function

    Sub InjectChangeComment()
        ActiveDocument().Selection().Text = "// " + System.DateTime.Now.ToString("MM-dd-yy") + " " + GetUserName() + vbTab + vbTab + vbTab
    End Sub

End Module 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T23:20:36.013

HTML 视图中的代码片段不起作用。它计划用于下一版本的 Visual Studio。我现在会看一下宏方法，或者看看其他工具是否允许在 HTML 编辑器中使用片段。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-07T11:19:58.743

Resharper 是一个可以让你做到这一点的好工具。您可以创建自己的模板来满足您的需求，但也可以使用标签。有很多功能，而且物有所值。

# delphi - 德尔福2009？好的还是越野车？

> ID：262013
> 
> 赞同：6
> 
> 时间：2008-11-04T14:17:05.813
> 
> 标签：delphi, delphi-2009

我厌倦了每年尝试 Delphi，希望能找到一个稳定的版本来从我的旧 Delphi 7 升级。

我应该费心尝试 Delphi 2009 吗？或者它和以前的版本一样不稳定，我应该等到 Delphi 2010 吗？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-04T20:49:27.283

这可能是一个开放式问题，但仍然是一个重要的问题。Borland/Code Gear 在 Delphi 版本中没有一致的跟踪记录，我选择 Delphi 7 的时间比预期的要长得多，就像 Delphi 社区中的许多人一样。Delphi 7 有一个很棒的帮助系统，由于一些难以启齿的内部政治，遗憾地被 Borland 抛弃了。

一年前，当 Code Gear 出现重新关注本地 Win32 代码时，我们转移到了用于 Win32 的 Delphi 2007。这对他们来说似乎是一个很好的举措，并且生产的产品与 Delphi 7 相当，甚至更好。不可否认，Delphi 2007 中的帮助很糟糕，Code Gear 已经承认这是一个问题。已在 Delphi 2009 版本中纠正的问题。

我们最近采用了 Delphi 2009，目前正在将我们的代码迁移到新的 Unicode 平台。Code Gear 已迅速采取行动，将 D2009 打造成一个可靠的、信誉良好的开发平台，Update 1 已经发布，解决了最初用户报告的问题。这是非常令人鼓舞的。

Delphi 2007/2009 成为 Vista/2008 的最佳原生开发平台之一，同时在旧版 Win32 平台上保持无缝向后兼容性。

我们依靠 Delphi 开发实时电视自动化软件。您的问题的简单答案是 - 是的。

如果您想要本机 64 位，请仅等待 Delphi 的下一个版本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-04T14:30:51.150

这是一个开放式问题，但简短的回答是，Delphi 2009 稳定、快速，并且比旧版本（尤其是 2005）有了飞跃。

自 Delphi 7 以来，IDE 已经发展了一些，并且具有更多的 Visual Studio 和类似 Eclipse 的功能。它还具有一些更新的控件，可以更轻松地构建更“现代”的 Windows 应用程序，例如您在 Office 中看到的功能区。我发现拖放操作的响应时间比以前的版本快很多，总体而言 IDE 操作的响应时间似乎快了很多。

到目前为止，IDE 还没有让我崩溃，但我承认我不是一个沉重的日常用户。我主要将 Delphi 2009 用于我自己的业余项目。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-04T15:17:02.197

到目前为止，一切都很好。非常稳定，甚至比 Delphi 2007 还要快（也没有懈怠），并且自 Delphi 7 以来有更多的语言、组件和一般生产力特性、修复和改进，这是你无法动摇的。

阅读文献，观看一些视频并尝试试用：

[http://blogs.codegear.com/pawelglowacki/2008/11/03/38527](http://blogs.codegear.com/pawelglowacki/2008/11/03/38527)

[http://blogs.codegear.com/pawelglowacki/2008/11/03/38527](http://blogs.codegear.com/pawelglowacki/2008/11/03/38527)

[http://blogs.codegear.com/nickhodges/2007/03/28/33579](http://blogs.codegear.com/nickhodges/2007/03/28/33579)

[http://www.stevetrefethen.com/blog/VCLAndRTLEnhancementsSinceDelphi7D7.aspx](http://www.stevetrefethen.com/blog/VCLAndRTLEnhancementsSinceDelphi7D7.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T13:11:19.640

到目前为止，Delphi 2009 已经为我找到了。正如其他人已经提到的那样，它不会崩溃或任何戏剧性的事情。

仅仅为了新的仿制药就值得升级。是时候让我们在 Delphi Win32 领域得到这个了。话虽如此，一些标准模板有点原始。我在 TObjectStack 中遇到访问冲突问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-04T15:24:39.000

诚然，我只使用了试用版。还没有崩溃，智能感知（或代码完成）有一些小问题，但我在 Visual Studio 中遇到了类似类型的问题。Intellisense 似乎在任何地方都很脆弱。在 ide 设置智能感知列表时，我没有遇到任何令人沮丧的延迟，这是一个优点。所以到目前为止整体看起来还不错。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-08T03:59:15.140

I would suggest waiting until one or two service packs come out. Changing the default string from an AnsiString to an UnicodeString is bound to cause headaches for awhile, especially in 3rd party component packages. You should really investigate which components that are 'must have' for your development and ensure that they have a new version that works with Delphi 2009.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-10T11:08:29.593

> 我建议等到一两个服务包出来。

这就是问题。我们不知道 Embarcadero 是否计划发布其他补丁。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-21T11:29:10.797

我使用了 delphi 2009 的试用版，它太棒了！！！没有崩溃，稳定的 ide 一些很酷的新功能……太棒了！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-08-23T11:32:58.897

可惜不稳定。ActionToolbar 和 ActionManu 一直在导致 IDE 异常:( TCoolbar 上的 TActionToolbar 非常闪烁。TListView（带有自动调整的列）在最大化表单时刷新非常慢 - 它看起来很糟糕。自动代码模板很糟糕，无法使用。在单词之间跳转（ ctrl + left/right) 省略操作符 - 在代码中导航非常困难。TAB 仍然无法进行标识（您必须使用 ctrl + shift + i）。

不好的软件，不幸的是:(

# c# - 如何发布业务对象查询服务

> ID：262014
> 
> 赞同：0
> 
> 时间：2008-11-04T14:17:55.700
> 
> 标签：c#, web-services, business-objects

我们正在尝试将 BO 查询服务从一个 Universe 复制到另一个 Universe。如果您使用 BO 查询即服务 (QAAS) 工具，您可以执行此操作，但最终基本上是重新创建查询服务。

看起来 BusinessObjects.DSWS.* 库允许您读取和写入查询服务，但这些不会出现在 QAAS 工具中。我认为这些查询进入了与 QAAS 工具 ping 不同的领域。也许有一个用于数据的 Universe，另一个用于 Web 服务查询。监控 HTTP 流量的 QAAS 工具显示，用于运行查询它们包含的数据的 BO Web 服务也用于管理 Web 服务查询。

我能够使用 QuerySpec 中 XML 字符串上的 Replace() 将一个查询服务复制到新 Universe 中的一个新服务中，以更改 UniverseID。我们基本上可以将一个查询服务复制到另一个 Universe 而无需手动重建它，除了一件小事。

QAAS 工具包括一个发布按钮。这做了一些未知但重要的事情。也许它会制作一些 SOAP、WSDL 或配置文件，以便复制的查询服务是公开的。执行此操作时似乎没有任何 HTTP 流量可以窥探。BusinessObjects.DSWS.* 库包括发布功能，但不适用于查询服务。它适用于 Excel 和 PDF 等一般文件。

现在，我们只能使用两种工具。有谁知道如何像 QAAS 工具一样以编程方式发布 BO 查询服务？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-20T17:25:05.927

已经有一段时间了，但是有一种骇人听闻的方式来做到这一点。

您可以使用 VS 工具生成一个可以调用 BO Web 服务的 csharp 类。该对象可以以文本格式提取相关设置。然后，将查询服务中对象 ID 的现有部分（即 Universe ID）替换为新的 Universe ID。然后该对象可以添加新的查询服务。

此过程非常快速，之后您需要使用 QAAS 工具发布新的、复制的查询服务。代码中可用的所有发布操作似乎都发布了其他内容，而不是查询服务。

# ant - 如何将 Apache Ant 属性值存储在文件中

> ID：262015
> 
> 赞同：5
> 
> 时间：2008-11-04T14:18:12.737
> 
> 标签：ant

我需要从 Apache Ant 修改一个 (xml-) 文件。“loadfile”任务允许在属性中加载文件的内容。但是如何在其（属性）修改后将属性的值存储回文件？

当然，我可以编写自定义任务来执行此操作，但我想知道是否有一些现有的实现。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-04T14:31:51.697

您可以使用[回](http://ant.apache.org/manual/Tasks/echo.html)显任务。

```
<echo file="${fileName}" message="${xmlProperty}"/> 
```

您可能也会对 echoxml 任务感兴趣[。](http://ant.apache.org/manual/Tasks/echoxml.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-02-28T08:44:00.033

使用[属性](http://ant.apache.org/manual/Tasks/propertyfile.html)文件任务。一个取自ant手册的例子：

```
<propertyfile file="my.properties">
  <entry  key="abc" value="${abc}"/>
</propertyfile> 
```

这可能比`echo`使用给定值更新属性文件，同时`echo`追加或覆盖整个文件更好。

# c# - 运行 ClickOnce 部署的 WPF 应用程序版本时的奇怪行为

> ID：262017
> 
> 赞同：2
> 
> 时间：2008-11-04T14:18:18.947
> 
> 标签：c#, wpf, linq, debugging, clickonce

我们有一个基于导航的 WPF 应用程序。当直接从 Visual Studio 运行时，它工作正常，或者即使我们将文件复制到另一个目录或另一台计算机并在那里运行它。

我们使用 ClickOnce 在 Internet 上部署应用程序，大多数情况下这不会导致任何问题。

但是，它时不时地完全冻结，您会看到经典的“应用程序 xxxx 没有响应”和无响应的 UI。

这不会每次都发生，只有在使用已部署的版本时才会发生。（即使我们在开发机器上测试它）。

> 在我输入此消息时，我们多次启动和退出已部署的版本，以尝试重现该行为......有时它会连续发生 10 次，然后在接下来的 20 次中会正常工作。没有迹象表明可能是什么原因造成的。（只是设法让它发生）

只是为了向您展示我的意思，这是一个屏幕截图：

[ ![替代文字](https://i.stack.imgur.com/h1nZh.jpg)][空]

双击 ListBox 中的第一项时会发生这种情况：

```
 LLCOverviewPage llcOverview = new LLCOverviewPage((Controller)this.lstControllers.SelectedItem);
   this.NavigationService.Navigate(llcOverview); 
```

应用程序只是永远保持这种状态，不会抛出异常。

LLCOverViewPage 的构造函数如下所示：

```
public LLCOverviewPage(Controller CurrentController)
{
     InitializeComponent();

     this.currentController = CurrentController.ToLightLinkController();
     this.updateControllerInfo();            
} 
```

updateControllerInfo() 方法在页面上显示信息，然后调用一个方法来获取先前从 SQL Compact 3.5 数据库加载的更多信息：

```
 private void updateControllerInfo()
    {
        //Update the UI with general properties
        this.lblDeviceName.Content = this.currentController.ShortName;
        this.lblEthernetAddress.Content = this.currentController.Eth0.EthernetAddress.ToString();
        this.lblTcpPort.Content = this.currentController.Eth0.TcpPort.ToString();
        this.lblActuatorThroughputMode.Content = (this.currentController.Dali.ActuatorThroughputMode ? "Enabled" : "Disabled");
        this.lblNetmask.Content = (this.currentController.Eth0.Netmask != null ? this.currentController.Eth0.Netmask.ToString() : String.Empty);
        this.lblDefaultGateway.Content = (this.currentController.Eth0.DefaultGateway != null ? this.currentController.Eth0.DefaultGateway.ToString() : String.Empty);      

        //Update the UI with the ballasts
        this.updateBallastList();
    }

    private void updateBallastList()
    {
        this.lstBallasts.ItemsSource = null;

        List<BallastListViewItem> listviewItems = new List<BallastListViewItem>();
        foreach (DaliBallast ballast in this.currentController.Dali.Ballasts.OrderBy(b => b.ShortAddress))
        {
            listviewItems.Add(new BallastListViewItem(ballast,this.currentController.SerialNumber));
        }

        this.lstBallasts.ItemsSource = listviewItems;
    } 
```

就是这样。构建页面时不会发生其他任何事情。

无一例外，而且由于应用程序没有崩溃，我几乎没有什么可以继续找出问题所在。

SQL Compact 数据库存储在用户应用程序文件夹中，因此部署版本使用与普通版本相同的数据库，没有区别。

所以，为了清楚起见，这个问题只发生在部署的版本中！（在装有 Windows XP 和 Windows Vista 的不同机器上测试）

有什么想法可能导致这样的事情发生，或者我可能会尝试什么来追查这个问题？

**更新**

> 使用一些好的旧调试（将日志信息写入文件），我能够确定我的所有代码都成功执行，并且应用程序仅在此之后冻结。

因此，如果您再看一下正在创建的页面的构造函数：

```
 public LLCOverviewPage(Controller CurrentController)
    {
        InitializeComponent();

        this.currentController = CurrentController.ToLightLinkController();
        this.updateControllerInfo();            
    } 
```

在 this.updateControllerInfo() 之后是应用程序不时冻结的地方。这会超出我的代码吗？也许是 WPF 错误？

**更新 2** 我检查了 Windows 中的应用程序事件日志，它是这样说的：

```
<Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
  <System>
    <Provider Name="Application Hang" />
    <EventID Qualifiers="0">1002</EventID>
    <Level>2</Level>
    <Task>101</Task>
    <Keywords>0x80000000000000</Keywords>
    <TimeCreated SystemTime="2008-11-04T15:55:55.000Z" />
    <EventRecordID>1630</EventRecordID>
    <Channel>Application</Channel>
    <Computer>DEVTOP</Computer>
    <Security />
  </System>
  <EventData>
    <Data>LLCControl.exe</Data>
    <Data>1.0.0.0</Data>
    <Data>2f4</Data>
    <Data>01c93e95c29f9da5</Data>
    <Data>20</Data>
    <Binary>55006E006B006E006F0077006E0000000000</Binary>
  </EventData>
</Event> 
```

二进制文本说：未知，猜我完全被狗了......

**更新 3** 如果我将列表框的事件处理程序代码更改为：

```
LLCOverviewPage llcOverview = new LLCOverviewPage((Controller)this.lstControllers.SelectedItem);
MessageBox.Show("Navigating Now");
this.NavigationService.Navigate(llcOverview) 
```

它告诉我应用程序仅在导航时冻结！

**更新 4** 我将一些事件处理程序连接到 NavigationService。当事件被触发时，处理程序简单地写入日志。结果如下所示：

> 17:51:35 导航 17:51:35 导航 17:51:35 加载完成

那么为什么这会被遗忘呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-04T21:56:29.253

我已经能够将问题追溯到发生数据绑定时调用的代码，这保证了这里发现的一个新问题：

[SQL 2 LINQ 查询（由数据绑定调用）完全冻结 WPF 应用程序](https://stackoverflow.com/questions/263612/sql-2-linq-query-called-by-databinding-completely-freezing-wpf-application)

# sharepoint - 具有 Windows Sharepoint Timer Service 的本地管理员 + 网络服务权限的用户

> ID：262018
> 
> 赞同：1
> 
> 时间：2008-11-04T14:18:20.567
> 
> 标签：sharepoint, permissions, windows-server-2003

是否可以创建具有本地管理员和网络服务权限的用户？

我有一个运行 stsadm 的 Sharepoint 计时器作业，它需要本地管理员权限。另一方面，其他需要网络服务权限的服务也使用临时作业，并且那些权限集仅重叠，因此我需要一个具有权限“总和”的用户来运行 OWSTIMER。

（我知道您可以使用 stsadm sharepoint 管理 API 执行的大多数操作，在我的情况下，它是在似乎没有等效 API 的内容数据库之间移动网站集的操作）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T19:23:10.530

我建议始终使用域帐户 - SharePoint 在连接到 Active Directory 服务器的服务器上效果最佳。对于生产环境，最佳实践是使用最低权限帐户。我总是创建以下专用于 SharePoint 服务的域帐户：

DOM\sp服务

您无需为此帐户授予任何特殊权限，因为当您在设置期间指定帐户时，SharePoint 会自动为您执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-25T02:46:39.150

我无法为您提供用户权限（Lars 很重要），但我想分享一些可能有用的信息。

您提到您正在尝试在内容数据库之间移动网站集，但尚未找到可以利用的 API。您是否查看过 SharePoint 的内容部署 API（也称为 PRIME API）是否可以提供帮助？我所说的类型位于**Microsoft.SharePoint.Deployment**命名空间中，它们为您提供了将网站集导出（通过**SPExport**）为 CAB 文件然后导入它们（通过**SPImport**）的机制。

SharePoint 将此命名空间中的类型用于其自己的内容部署路径和作业（在 MOSS 中）；它也是**STSADM.EXE**可执行文件用于导出 ( **STSADM.EXE -o export** ) 和补充导入操作的 API。就此而言，SharePoint Designer 也将它用于其网站“备份”和“还原”操作。

有关如何利用此 API 的示例，请查看 CodePlex ( [http://www.codeplex.com/SPDeploymentWizard](http://www.codeplex.com/SPDeploymentWizard) ) 上的 SharePoint 内容部署向导工具。

我希望这为您提供了一个潜在的替代方案，可以在您的计时器作业中使用命令行！

# html - 用 HTML 创建锦标赛四强括号？

> ID：262022
> 
> 赞同：3
> 
> 时间：2008-11-04T14:19:11.050
> 
> 标签：html, css

有没有可以创建 HTML 后四括号的网站？

还是只有 HTML 会自动创建它，我可以填写细节？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-04T17:19:51.450

偶然发现了这段 HTML 代码，这成功了。我会发布它以防万一有人在路上有同样的问题。

```
table.bracket {
    border-collapse: collapse;
    border: none;
}

.bracket td {
    vertical-align: middle;
    width: 40em;
    margin: 0;
    padding: 10px;
}

.bracket td p {
    border-bottom: solid 1px black;
    margin: 0;
    padding: 5px 5px 5px 5px;
}

.bracket th{
    text-align:center;
}

<table summary="Tournament Bracket" class="bracket">
<tr>
    <th>National Semi-Finals<br>Saturday November 8th</th>
    <th>National Championship<br>Sunday November 9th</th>
    <th>NJCAA National Champion</th>
</tr>
<tr>
    <td><p>#1 Manchester CC (17-2-1)</p></td>
    <td rowspan="2"><p></p></td>
    <td rowspan="4"><p></p></td>
</tr>
<tr>
    <td><p>#4 Triton College (13-4-0)</p></td>
</tr>
<tr>
    <td><p>#2 Herkimer County CC (18-3-0)</p></td>
    <td rowspan="2"><p></p></td>
</tr>
<tr>
    <td><p>#3 County College of Morris (17-3-0)</p></td>
</tr>
</table> 
```

编辑，摆弄：http: [//jsfiddle.net/4KZ6T/](http://jsfiddle.net/4KZ6T/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-04T15:16:31.043

我真的不知道你需要什么问题，但从它的外观来看：

[http://www.bracketmaker.com/](http://www.bracketmaker.com/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-04T19:53:00.237

这个用 html/css 构建的NBA 季后赛[支架和](http://www.breathingfire.com/nba/playoffs/2009/bracket2009.php)[有关它的博客文章](http://www.breathingfire.com/2008/03/nba-playoffs-bracket-hows-it-work/)可能会提供一些灵感。

* * *

**编辑：** 这个答案已经有将近 12 年的历史了。链接已经失效，从那时起HTML 和 CSS 已经发展**了很多。**这是 Chris Coyier（CSS Tricks 和 Codepen 的创始人）在 2018 年收集的 HTML/CSS 锦标赛括号的精彩汇总[https://blog.codepen.io/2018/02/16/need-make-tournament-bracket/](https://blog.codepen.io/2018/02/16/need-make-tournament-bracket/)

# .net - 将 Windows 令牌传递给 WCF，然后从 WCF 传递到 AD 域中的另一台服务器

> ID：262023
> 
> 赞同：0
> 
> 时间：2008-11-04T14:19:32.250
> 
> 标签：.net, wcf, security

这可能很笨拙，但有没有人知道如何：

将用户 windows 令牌（从域进行身份验证）传递给被调用的 wcf 服务 - 然后该服务将根据发出调用的用户 windows 凭据执行操作。

即：客户端 -> WCF -> 一些与活动目录集成的第 3 方存储库。

我有一个负责返回所有数据的 wcf 数据层 - 目前客户调用此服务。此服务从存储库中检索文档。由于存储库支持 AD 集成，因此客户希望通过使用 AD 管理所有帐户来实现此目的。

任何帮助将不胜感激 - 谢谢:-)

---------- 更新我已经关注了jezell的文章，但我仍然有问题。

我想使用 upn 而不是 spn （这样可以锁定帐户并更安全），但我不确定我有什么错误。

我在 AD 服务器上创建了 spn（尝试了所有组合，没有重复）

这是一些代码片段，也许有人知道我做错了什么。

```
Dim binding As New NetTcpBinding()
binding.Security.Mode = SecurityMode.Message
binding.Security.Message.AlgorithmSuite = System.ServiceModel.Security.SecurityAlgorithmSuite.Basic128
binding.Security.Message.ClientCredentialType = MessageCredentialType.Windows

Dim upn As String = "usertest@testdomain.com"

Dim ep As New EndpointAddress(New Uri("net.tcp://server1.testdomain.com:1111/ServiceTest") _
    , EndpointIdentity.CreateUpnIdentity(upn))

Dim factory As New ChannelFactory(Of Credential.Interface.ICredentialTest)(binding, ep)
factory.Credentials.Windows.AllowNtlm = False
factory.Credentials.Windows.AllowedImpersonationLevel = System.Security.Principal.TokenImpersonationLevel.Delegation

Dim iproxy As Credential.Interface.ICredentialTest = factory.CreateChannel()
Dim co As ICommunicationObject = CType(iproxy, ICommunicationObject)
iproxy.ToService(result) 
```

* * *

现在我收到错误消息：'传出消息的身份检查失败。预期的身份是......我能找到的所有内容都与使用证书有关，我没有这样做。

谢谢 ：-）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T15:56:12.773

这称为委托。将客户端配置中允许的模拟级别设置为“委托”并在服务器端禁用 NTLM 身份验证。我在这里有一篇文章进行了更深入的讨论：

[http://www.iserviceorientated.com/blog/post/Delegation+-+WCF+Gotcha+2.aspx](http://www.iserviceoriented.com/blog/post/Delegation+-+WCF+Gotcha+2.aspx)

# .net - 使用 LINQ to SQL 获取“字符串”列的最大长度

> ID：262024
> 
> 赞同：6
> 
> 时间：2008-11-04T14:19:37.960
> 
> 标签：.net, sql, linq, linq-to-sql

是否可以获得 VARCHAR、CHAR 等的最大列长度？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-04T14:35:11.203

这是一种避免接触数据库的方法：

*   使用反射，获取与相关列对应的实体类的属性。
*   然后，检索属性的 System.Data.Linq.Mapping.Column 属性。
*   然后，解析该属性的 DbType 属性（例如**NVarChar(255) NOT NULL**）以获取列长度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T14:30:26.720

在纯 T-SQL 中，您可以使用以下查询：

```
select max_length from sys.columns as c inner join sys.objects o on c.object_id = o.object_id where o.name = 'myTable' and c.name = 'myColumn' 
```

对于 linq-to-sql，您需要将其重写为 linq。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-18T14:27:05.540

在这里回答：

[Linq to SQL - 基础列长度](https://stackoverflow.com/questions/20684/linq-to-sql-underlying-column-length)

虽然我发现改变起来更整洁：

```
public static int GetLengthLimit(Type type, string field) //definition changed so we no longer need the object reference
//Type type = obj.GetType(); //comment this line 
```

并使用：

```
int i = GetLengthLimit(typeof(Pet), "Name"); 
```

任何人都可以想到一种强类型字段引用的方法吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-09-24T21:19:39.037

```
public static int GetLengthLimit(Model.RIVFeedsEntities ent, string table, string field)
{
    int maxLength = 0;   // default value = we can't determine the length

    // Connect to the meta data...
    MetadataWorkspace mw = ent.MetadataWorkspace;

    // Force a read of the model (just in case)...
    // http://thedatafarm.com/blog/data-access/quick-trick-for-forcing-metadataworkspace-itemcollections-to-load/
    var q = ent.Clients;
    string n = q.ToTraceString();

    // Get the items (tables, views, etc)...
    var items = mw.GetItems<EntityType>(DataSpace.SSpace);
    foreach (var i in items)
    {
        if (i.Name.Equals(table, StringComparison.CurrentCultureIgnoreCase))
        {
            // wrapped in try/catch for other data types that don't have a MaxLength...
            try
            {
                string val = i.Properties[field].TypeUsage.Facets["MaxLength"].Value.ToString();
                int.TryParse(val, out maxLength);
            }
            catch
            {
                maxLength = 0;
            }
            break;
        }
    }

    return maxLength;
} 
```

# c# - 你如何在 C# 中用大于 MaxValue 的数字做数学（或数学）？

> ID：262025
> 
> 赞同：6
> 
> 时间：2008-11-04T14:19:41.097
> 
> 标签：c#

> **可能重复：**
> [C# 中的大整数](https://stackoverflow.com/questions/176775/big-integers-in-c-sharp)

我希望能够在 C# 中处理任意大的数字。
我可以只接受整数。

有没有针对这种事情的既定算法？
或者有没有好的第三方库？

如果在 C# 中确实没有好的方法，我可能会考虑更改语言。

感谢您的任何帮助/建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-04T14:23:22.507

您可能想要检查[Big Num](http://en.wikipedia.org/wiki/Arbitrary-precision_arithmetic)类型的库。在 C# 中最流行的是：[IntX](http://www.codeplex.com/IntX/)和[W3b.Sine](http://www.codeplex.com/sine)，另外，它们都是开源的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-04T14:28:58.767

有人在 codeproject [C# BigInteger Class](http://www.codeproject.com/KB/cs/biginteger.aspx)中用 C# 完成了 BigInteger 类。值得一试。

可以在以下位置找到通用算法的示例：[Re: Hi-prec math for visual studio c#?](http://www.physicsforums.com/showthread.php?t=246407) （这是页面底部带有代码段的帖子）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-04T14:36:21.577

正如人们所提到的，BigInteger 类有多种第三方实现。此外，C# 4.0 将在 CLR 中获得本机 BigInteger 类。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-04T14:23:24.193

如果您只需要非常大的数字，您可以使用`long`（64 位），甚至`decimal`（128 位浮点）。

如果您需要大于 9223372036854775807 ( `long`) 或 79228162514264337593543950335 ( `decimal`) 的值，则需要忽略此答案。

# licensing - 程序的许可和自动删除

> ID：262026
> 
> 赞同：0
> 
> 时间：2008-11-04T14:20:00.847
> 
> 标签：licensing, batch-file

我有一个应用程序被复制并在客户端机器上运行。该程序采用 Adob​​e Projector 文件的形式。我想编写一个进程来检查程序何时开始运行许可证是否仍然处于活动状态，如果没有，则删除整个程序。

程序本身知道它的实际安装日期，并且由于我们自己为客户安装程序，我们可以确保在安装时与客户计算机上的日期匹配。每次他们启动程序时，它都会将当前日期与他们上次运行程序的日期进行比较。如果今天的日期晚于该日期，则从剩余天数中减去经过的日期数。如果日期早于上次运行的日期，则会以固定天数惩罚客户端（这是为了阻止客户端尝试在计算机上重置日期并使其许可证永不过期）。

如果他们将整个目录复制到新机器上，程序内的安装日期将与目录中任何文件的创建日期不匹配，并且会将这种情况视为过期的许可证。

我的问题是：有没有一种简单的方法来编写脚本以在每次启动应用程序时运行？我们目前创建了一个可以指向批处理作业的快捷方式，但是您在批处理作业中放了什么？还是这种许可方法完全错误？购买此程序的人只会购买有时间限制的许可证，并且程序是通过将目录复制并粘贴到目标机器上来运行的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-04T14:24:21.930

我相信你想的太复杂了。为什么不让它成为一个试用版，在安装、首次使用或任何你想要的东西后过期 n 天。

关于删除exe的方法：小心，这可能是非法干预别人的电脑。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-04T15:12:04.173

今天接受试用期已过时不在系统上运行软件。我认为实际上删除该程序不会。我知道我再也不会使用这样的应用程序了。

# avatars - 开发人员可以使用哪些 Identicon 框架？

> ID：262028
> 
> 赞同：3
> 
> 时间：2008-11-04T14:20:12.950
> 
> 标签：avatars, identicon

Identicons 是那些基于用户 IP 或名称的图标，它们提供自动头像……就像 StackOverflow 上的头像图标一样。以下是一些可用的系统（向 Roger Browne 致敬）：

*   [http://haacked.com/archive/2007/01/22/Identicons_as_Visual_Fingerprints.aspx](http://haacked.com/archive/2007/01/22/Identicons_as_Visual_Fingerprints.aspx)
*   [http://digitalconsumption.com/forum/Visiglyphs-for-IP-visualisation](http://digitalconsumption.com/forum/Visiglyphs-for-IP-visualisation)
*   [http://www.shamusyoung.com/twentysidetale/?p=1462](http://www.shamusyoung.com/twentysidedtale/?p=1462)
*   [http://turnyournameintoaface.com/](http://turnyournameintoaface.com/) [没有为此提供 API，但考虑到生成的图片是针对特定性别的...]
*   [http://scott.sherrillmix.com/blog/blogger/wp_monsterid/](http://scott.sherrillmix.com/blog/blogger/wp_monsterid/)

还有更多吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T14:31:59.683

我相信 SO 使用[Gravatars](http://en.gravatar.com/)

# c++ - MFC：捕获调整大小

> ID：262036
> 
> 赞同：0
> 
> 时间：2008-11-04T14:22:29.530
> 
> 标签：c++, mfc, controls, resize

只是想知道在调整整个窗口大小时触发的 MFC 应用程序中哪里最好放置功能。我在想 mainfrm 但我似乎无法捕获任何 OnSize 消息......

有人可以告诉我我做错了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T16:09:02.903

> 有人可以告诉我我做错了什么吗？

您没有包含任何有趣的细节，所以这里有一些猜测（因为*当然*大型机通常会收到发送`WM_SIZE`消息......）：

*   您没有正确设置消息处理程序。也许您忘记了消息映射条目？
*   您有一个现有的处理程序`WM_WINDOWPOSCHANGED`无法调用默认窗口过程，从而阻止`WM_SIZE`发送消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T15:13:43.513

我猜您正在使用多文档界面 (MDI) 应用程序类型。在这种情况下，您应该在每个视图中捕获 WM_SIZE 消息 - 您从 CView 派生的类。

# tsql - SQL 如何遍历表并合并结果？

> ID：262043
> 
> 赞同：0
> 
> 时间：2008-11-04T14:24:15.657
> 
> 标签：tsql

我正在尝试做这样的事情：

```
while @nrOfAuthlevels >= @myAuthLevel
begin
    set @myAuthLevel = @myAuthLevel + 1 
    SELECT      Role.name, Role.authorityLevel
    FROM        [dbo].[Role]
    ORDER BY Role.authorityLevel
end 
```

这个存储过程的结果应该是一个表，其中所有 Role.authorityLevel 都低于我自己的。但这会生成几个表。

提前致谢

克里斯托弗

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-04T14:30:18.797

如果要保留当前结构，则需要在 while 循环的每个步骤中插入一个临时表，并且在从 TEMP 表返回之外。

也就是说，为什么不直接使用**WHERE**子句来获得预期的返回结果：

```
SELECT Role.Name, Role.AuthorityLevel
    FROM dbo.Role
    WHERE Role.AuthorityLevel < @MyAuthLevel
    ORDER BY Role.AuthorityLevel 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T14:30:09.547

在循环之前创建一个临时表，不要选择数据，而是将数据插入到这个临时表中：

```
create table #tmp (
 Name type,
 authorityLevel type
)

while @nrOfAuthlevels >= @myAuthLevel
begin
        set @myAuthLevel = @myAuthLevel + 1     
        insert into #tmp values(
            SELECT          Role.name, Role.authorityLevel
            FROM        [dbo].[Role]
            where ...
        )
end 
```

# reporting-services - 在 SqlServer Reporting Services 查询中组合“like”和“in”？

> ID：262075
> 
> 赞同：2
> 
> 时间：2008-11-04T14:34:00.053
> 
> 标签：reporting-services, sql-like, in-clause

以下不起作用，但我正在寻找类似这样的东西。

```
select *
from Products
where Description like (@SearchedDescription + %) 
```

SSRS 使用参数前面的@ 运算符来模拟“in”，我没有找到将字符串与字符串列表匹配的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-17T20:35:22.963

关于如何使用带参数的 LIKE 运算符有几个选项。

选项1

如果将 % 添加到参数值，则可以自定义 LIKE 过滤器的处理方式。例如，您的查询可能是：

```
 SELECT name
 FROM master.dbo.sysobjects
 WHERE name LIKE @ReportParameter1 
```

为了使数据集正确使用 LIKE 语句，您可以使用 sysa% 之类的参数值。当我使用此代码在 SSRS 2008 中测试示例报告时，我返回了以下四个表：

```
 sysallocunits
 sysaudacts
 sysasymkeys
 sysaltfiles 
```

选项 2

另一种不需要用户添加任何“%”符号的方法是生成一个包含代码的变量并执行该变量。

```
 DECLARE @DynamicSQL NVARCHAR(MAX) 

 SET @DynamicSQL = 
 'SELECT  name, id, xtype
 FROM dbo.sysobjects
 WHERE name LIKE ''' + @ReportParameter1 + '%''
 '

 EXEC (@DynamicSQL) 
```

这将使您更好地控制如何使用 LIKE 语句。如果您不希望用户注入任何额外的运算符，那么您始终可以添加代码以去除非字母数字字符，然后再将其合并到最终查询中。

选项 3

您可以创建一个存储过程来控制此功能。我通常更喜欢使用存储过程作为 SSRS 的数据源，并且从不允许动态生成 SQL，但这只是我的偏好。这有助于在执行依赖关系分析检查时提高可发现性，并且还允许您确保最佳查询性能。

选项 4

创建有助于动态生成 SQL 代码的 .NET 代码程序集。我认为这是矫枉过正，充其量是一个糟糕的选择，但可以想象它可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-10T19:54:09.953

您是否尝试过：

`select * from Products where Description like (@SearchedDescription + '%')` （在 % 符号周围加上单引号？）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T16:40:40.933

Dano，您使用的是哪个版本的 SSRS？如果是RS2000，官方不支持多参数列表，但是有一个变通方法....

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-06T09:11:49.013

像这样放：

```
select * 
from tsStudent 
where studentName like @SName+'%' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-09-24T22:44:39.527

我知道这已经很老了，但是在我寻找解决相同问题的过程中出现了这种情况，我最终使用了此处未描述的解决方案。我正在添加一个新的潜在解决方案来帮助其他可能跟随的人。

如所写，此解决方案仅适用于 SQL Server 2016 及更高版本，但可以通过编写自定义[string_split](https://docs.microsoft.com/en-us/sql/t-sql/functions/string-split-transact-sql?view=sql-server-2017) UDF 以及使用子查询而不是 CTE 来适应旧版本。

首先，使用 JOIN 将您的 @SearchedDescription 作为单个字符串映射到您的数据集中：

`=JOIN(@SearchedDedscription, ",")`

然后使用 STRING_SPLIT 将您的“A、B、C、D”类型的字符串映射到表格结构中。

```
;with
SearchTerms as (
  select distinct
    Value
  from 
    string_split(@SearchedDescription, ',')
)
select distinct
  *
from
  Products
  inner join SearchTerms on
    Products.Description like SearchTerms.Value + '%' 
```

如果有人多次添加相同的搜索词，这将在结果集中重复行。同样，单个产品可以匹配多个搜索词。我已经添加`distinct`到 SearchTerms CTE 和主查询中，以尝试抑制这种不适当的行重复。

如果您的查询更复杂（包括来自其他联接的结果），那么这可能会成为一个越来越大的问题。请注意，这是这种方法的主要缺点。

# eclipse - PHPEclipse 奇怪的亮点

> ID：262078
> 
> 赞同：1
> 
> 时间：2008-11-04T14:35:30.160
> 
> 标签：eclipse, phpeclipse

这不是技术问题，但很烦人。

有谁知道如何在 phpEclipse 中关闭或更改名称突出显示的颜色？

我使用白底黑方案，这个亮点有一个白色的背景，使它不可读而且非常难看。

为了更好地解释我指的是哪个突出显示，当我将光标移动到变量/函数/方法/常量时，输入名称的所有其他位置都会突出显示。

我花了几天时间多次通过设置，但我还没有找到一个可以改变那个特别烦人的亮点。

任何人？请？:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T15:22:08.927

对于 Eclipse 中的 Java，它是：

> 窗口 > 首选项 > Java > 编辑器 > 标记出现次数。

我的 ruby​​ 插件也有同样的选择。在首选项窗口中搜索“Mark Occurrences”，希望 php 插件具有相同的选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T16:59:10.867

谢谢，就是这样，Mark Occurences。

当我通过选项搜索时，我正在寻找颜色选择器而不是复选框:)

能够为此更改突出显示颜色会更好，但即使将其删除也有很大帮助。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-11-04T15:21:47.943

在 Eclipse 中，转到 Window > Preference，使用过滤器字段（“type filter text”）搜索“color”。它将显示与颜色相关的所有配置选项。

我想这不是 phpEclipse 的问题，而是与另一个 Eclipse 插件不兼容。

PS：当你解决问题时，请告诉我们那个设置！

# compiler-construction - 新的动态编程语言的后端选择？

> ID：262089
> 
> 赞同：13
> 
> 时间：2008-11-04T15:08:28.843
> 
> 标签：compiler-construction, interpreter, smalltalk, vm-implementation

我一直在开发一个 Smalltalk 变体，只是为了好玩，我想知道在针对后端时，stackoverflowers 的伙伴会选择什么。这些是我目前的考虑：

.NET、JVM：这两个 VM 主要用于静态类型语言，我认为很难针对像 smalltalk 这样的动态语言。

Python（作为源代码）：似乎是最简单的方法。此外，如果我可以发出 Python 字节码会更好，但它没有像其他 VM 的 AFAIK 那样被很好地记录（需要挖掘 Python 的源代码以获取详细信息！）。

自制口译员：不可能，因为这不好玩:-)

LLVM、NekoVM、Parrot 是我正在检查的其他选项。您对此有何看法？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-04T15:13:03.890

不要这么快就打折 .NET 或 JVM。正在为两者开发动态语言（例如，JVM 上的 Groovy、JRuby、Jython；.NET 上的 IronRuby、IronPython）并且 .NET 正在获得“DLR”——动态语言运行时。（有关详细信息，请参阅[Jim Hugunin 的博客](http://blogs.msdn.com/hugunin/)。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-04T15:12:16.420

我会选择JVM，但主要是因为我熟悉它。

[JVM](http://www.java.com/)的客观原因是：支持主要平台，许多库和良好的性能（在您给出的选择范围内它可能具有最佳性能）。

.Net 在 Windows 上效果最好。如果您选择它，您应该在[Mono](http://www.mono-project.com/Main_Page)上进行测试，使其更加平台中立。

[Python](http://www.python.org/)似乎也是一个不错的选择。但我认为对于 JVM 有更多的库可用。

[Parrot](http://www.parrot.org/)在我看来太新鲜了，它需要一些时间来成熟。但未来的一个有趣的选择。

其他选择对我来说是新的，我会看看它们。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-04T15:21:31.017

Parrot 真的很酷，即使他们还没有发布任何“真正的”代码。但由于该项目只是为了好玩，这不应该阻止你：D。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-04T15:59:33.657

既然您正在尝试实现 Smalltalk，为什么不考虑一个受 smalltalk 启发的[Ruby](http://www.ruby-lang.org)虚拟机，例如[YARV](http://www.atdot.net/yarv/)甚至[rubinius](http://www.rubini.us/)。两者都受到 smalltalk 的启发，旨在实现高性能。YARV 将成为新的标准 Ruby VM。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-04T16:11:30.217

使用 Parrot 的一个优点是它附带了大量的示例语言，包括一个名为 ChitChat 的 Smalltalk 变体。因此，您可以将其用作参考，以了解其他人如何在 Parrot 上实现类似的语言。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-04T16:13:55.857

你可能想看看[PyPy——](http://codespeak.net/pypy/dist/pypy/doc/home.html)虽然这个项目的存在是为了在 Python（的一个子集）中实现 Python 语言，但他们采用的方法允许多个前端和多个后端（包括 CLR、JVM、LLVM ，C，甚至 Smalltalk 和 JavaScript，我想）。例如，[JIT 的工作](http://morepypy.blogspot.com/2008/11/porting-jit-to-cli-part-1.html)是使用 Prolog 作为前端语言，CLR 作为后端来完成的。因此，您可能会加入实施 Smalltalk 的队伍，后来发现您也在不知不觉中帮助其他人实施 Prolog... :-)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-04T16:14:08.573

Factor ( [http://factorcode.org/](http://factorcode.org/) ) 可能会为此提供一些有用的功能。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-02-02T14:28:55.720

如果这是为了好玩，为什么不从开源的 Squeak 代码库开始，然后对其进行修改。Smalltalk 应该有一个小的运行时间，你的有趣的小变种可以从 squeak 的引导环境开始，它几乎是微观的，并从那里建立起来。

我反对 .NET 和 JVM 的最大优势是庞大的规模。看看 Squeak 中运行时“操作系统到 smalltalk”的阻抗匹配层有多小。

有趣的项目不应该是……有趣吗？吱吱声有很多东西，务实的不是其中之一，但很有趣……绝对是。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-04T15:13:44.137

JVM 作为首选。从一开始，它将允许广泛的库支持。看看这如何使 Clojure 受益。

此外，LLVM 可能是一个有趣的选择，但我不确定它有多“被证明”，因为我无法使用 LLVM 后端进行成熟的语言实现。

我会避免使用.NET。这将使围绕您的新语言聚集社区和支持变得更加困难，您很快就会需要它。此外，它不是跨平台的。

无论您选择什么，您都会从中学到很多东西。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-04T15:55:42.853

与 .Net 相比，JVM 更稳定、有据可查，并且通常不太可能成为移动目标。此外，如果您使用开源，您更有可能找到可以帮助您的人。.Net 的人才真的很稀缺，而且大多数人都在微软工作，所以他们可能没有时间提供帮助。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-04T15:12:35.263

.NET 作为 DLR 现在位于动态语言的 CLR 之上。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-04T16:03:15.707

在 .Net 上进行操作，毕竟您想这样做是为了好玩。所以让它有点挑战性。然后可以将任何发现报告给 Microsoft，以改进 DLR 及其支持的语言。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-04T16:16:28.257

如果您打算使用 .Net，请查看 Beautiful Code——其中有一篇关于在 .Net CLR 上进行动态代码生成的文章。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-18T02:13:33.460

绝对是使用动态语言运行时的 .Net。完成后，您的对象将可供 C# 和 V.Net 用户直接使用（您打算发布一些东西？*:-)*

特别是，目标在 SilverLight 中的精简版 .Net 下运行，以便您获得最新的 Web 富 UI 支持。

# php - 使用 PHP 查找 JPEG 分辨率

> ID：262090
> 
> 赞同：4
> 
> 时间：2008-11-04T15:10:19.107
> 
> 标签：php, image-processing, gdlib

呼吁所有 PHP 大师！

我知道您可以使用 getimagesize() 在 PHP 中获取图像的实际像素高度和宽度。但是，如果您在 Photoshop 中打开图像并查看图像大小对话框，您会注意到有一个分辨率值决定了图像的打印大小。

给定一个任意的 jpg 图像文件，我需要使用 PHP 来确定这个分辨率数。看来这些信息存储在某个地方的 jpg 文件中，那么我该如何获取它呢？

另一个要求 - 我只有 gdlib 可供我使用。我需要在不使用其他 php 库（imagemagick 等）的情况下执行此操作

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-04T15:16:50.573

您可以直接读取 JPEG 文件，字节 14-18 指定：

*   字节 14：01，X 和 Y 密度单位说明符（00：无，像素比率，01：DPI，02：DPC）
*   字节 15-16：水平像素密度，
*   字节 16-18：垂直像素密度

另见：[http ://www.obrador.com/essentialjpeg/headerinfo.htm](http://www.obrador.com/essentialjpeg/headerinfo.htm)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-09-05T15:02:11.600

有两个地方可以潜在地存储分辨率（即打印时 JPEG 的分辨率，也简称为 DPI 或每英寸点数）。

第一个在 JPEG 的 JFIF 标头中，通常（但不总是）在 JPEG 的开头。

另一个在 EXIF 数据中。

请注意，分辨率数据通常不存在，因为它仅在与物理输出大小相关联时才有意义。例如，如果数码相机写入值，它通常是没有意义的。但是，当 JPEG 被输出到打印机（例如）时，该值将有意义。

这是一些从 JFIF 标头中获取它的代码，前提是存在一个，并且位于文件中的第二个块 APP0 块内。（第一个块始终是 SOI 标记。）：

```
function read_JFIF_dpi($filename)
{
    $dpi = 0;
    $fp = @fopen($filename, r);
    if ($fp) {
        if (fseek($fp, 6) == 0) { // JFIF often (but not always) starts at offset 6.
            if (($bytes = fread($fp, 16)) !== false) { // JFIF header is 16 bytes.
                if (substr($bytes, 0, 4) == "JFIF") { // Make sure it is JFIF header.
                    $JFIF_density_unit = ord($bytes[7]);
                    $JFIF_X_density = ord($bytes[8])*256 + ord($bytes[9]); // Read big-endian unsigned short int.
                    $JFIF_Y_density = ord($bytes[10])*256 + ord($bytes[11]); // Read big-endian unsigned short int.
                    if ($JFIF_X_density == $JFIF_Y_density) { // Assuming we're only interested in JPEGs with square pixels.
                        if ($JFIF_density_unit == 1) $dpi = $JFIF_X_density; // Inches.
                        else if ($JFIF_density_unit == 2) $dpi = $JFIF_X_density * 2.54; // Centimeters.
                    }
                }
            }
        }
        fclose($fp);
    }
    return ($dpi);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-04T16:35:20.150

解决方案：使用 PHP JPEG 元数据工具包 - 从这里下载：[http ://www.ozhiker.com/electronics/pjmt/](http://www.ozhiker.com/electronics/pjmt/)

这个工具包有一些方便的脚本，可以做各种各样的事情，包括查看和编辑 jpeg 文件中的标题、元数据和 jfif 信息。这是一个脚本，可为您提供 jpg 的 XDensity 和 YDensity（x 和 y 打印分辨率）：

```
<?php

include_once("./JPEG.php");
include_once("./JFIF.php");

$image_header = get_jpeg_header_data("./myImage.jpg");
$image_info = get_JFIF($image_header);

print( "XDensity:" . $image_info['XDensity'] . "<br />");
print( "YDensity:" . $image_info['YDensity'] . "<br />");

?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T15:27:05.063

根据图像的保存方式，EXIF 包含大量信息 - 在[PHP 手册](http://php.net/exif)中了解更多信息。但是，您可能需要稍微解析/处理结果（例如，闪存信息是或至少只是一个字节，表示各种状态）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T16:59:55.890

我不明白这一点。像素 = 打印尺寸 x 分辨率，像素数是一个设定值。因此，如果您有 300x300 像素的图像，则您有 1"x1" 的 300 DPI 分辨率、2"x2" 的 150 DPI 分辨率或 4"x4" 的 75 DPI 分辨率等。图像*没有分辨率*除非它具有与其像素大小相比的物理大小。

我错过了什么？（对于其他人来说，这有多明显？=]）

# asp.net - 如何更改我的 Web 服务的 URL？

> ID：262096
> 
> 赞同：0
> 
> 时间：2008-11-04T15:12:15.187
> 
> 标签：asp.net, .net, web-services, asmx, web-reference

如果我更改 web.config 文件中的 url，更改是否会反映在 WebReferences 文件夹中的 .disco、.discomap 和 .wsdl 文件中？

[编辑]

我正在使用 asp.net 2005

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T15:19:41.427

据我所知，更改不会反映在所有其他文件中。但是，如果您更改 web.config 中的 URL，您的应用程序将在运行时从新 URL 调用 Web 服务。查看此[博客条目](http://geekswithblogs.net/ranganh/archive/2006/10/10/93654.aspx)。（不，它不是我的！）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T15:25:21.977

假设您的意思是在客户端中，请在执行时设置[Url](http://msdn.microsoft.com/en-us/library/system.web.services.protocols.webclientprotocol.url.aspx)属性。只要您可以在适当的时间访问该值，您就可以从任何您想要的地方进行配置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T15:25:25.270

我记得**WSDL**文件包含 WS 的**绑定**（URL 映射）。因此，如果您更改机器上的 URL（在 WSDL、Disco 等中）就足够了。

另一方面，不要忘记**重新生成客户端代理**。它们必须反映 WSDL 的变化。

# sql - 当自动编号列的编号用完时，SQL 2005 中会发生什么？

> ID：262106
> 
> 赞同：10
> 
> 时间：2008-11-04T15:14:37.037
> 
> 标签：sql, sql-server-2005, identity, limits

当 SQL Server 2005 碰巧达到 IDENTITY 列的最大值时会发生什么？它是否从头开始并开始重新填补空白？

发生这种情况时，SQL Server 2005 的行为是什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-04T15:18:12.803

**达到最大值时会出现溢出错误**。如果您使用具有最大值的 bigint 数据类型，`9,223,372,036,854,775,807`则很可能永远不会出现这种情况。

您将收到的错误消息如下所示：

```
Msg 220, Level 16, State 2, Line 10
Arithmetic overflow error for data type tinyint, value = 256. 
```

[（来源）](http://forums.microsoft.com/msdn/ShowPost.aspx?PostID=4038424&SiteID=1&pageid=0)

据我所知，MS SQL 不提供任何功能来填补身份空白，因此您要么必须自己执行此操作，要么更改身份列的数据类型。

除此之外，您可以将起始值设置为最小的负数，以获得更大范围的值来使用。

[这是一篇关于这个主题的好博文](http://mssqlserver.wordpress.com/2006/12/01/what-happens-when-my-integer-identity-runs-out-of-scope/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T15:19:30.943

它不会填补空白。相反，插入将失败，直到您更改列的定义以删除标识并找到其他填充空白的方法或增加大小（从 int 到 bigint）或更改数据类型（从 int 到 decimal ) 以便有更多的标识值可用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-04T15:51:14.547

在解决问题之前，您将无法插入新行并且会收到上面列出的错误消息。您可以通过多种方式做到这一点。如果您仍然有数据并且正在使用低于最大值的所有 id，则必须更改数据类型。如果定期清除数据并且您有很大的空白将不会被使用，您可以将标识号重新设置为该空白中的最低数字。例如，在之前的工作中，我们正在记录事务。我们每月可能有 40-5000 万，但我们正在清除所有超过 6 个月的东西，所以每隔几年，身份将接近 20 亿，但我们将没有任何 id 低于 15 亿的东西，所以我们会重新播种回到 0。同样有可能这些都不适合你，你必须找到不同的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T15:22:45.290

如果标识列是整数，那么您的最大值为 2,147,483,647。如果超过它，您将收到溢出错误。

如果您认为这是一种风险，只需使用 BIGINT 数据类型，它最多可以提供 9,223,372,036,854,775,807。无法想象有这么多行的数据库表。

[在这里](http://forums.microsoft.com/msdn/ShowPost.aspx?PostID=4038424&SiteID=1&pageid=0)进一步讨论。（与提到的 xsl 链接相同）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T16:36:59.010

如果您确实达到了标识列的最大数量，您可以将该表中的数据移动到具有更大标识列类型的辅助表中，并将该新标识值的起始值指定为前一个标识值的最大值类型。新的身份值将从那时开始继续。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-21T14:28:02.350

如果您不时删除“旧值”，您只需使用 DBCC CHECKIDENT ('MyTable', RESEED, 0) 重置种子；

# c# - 用图像替换 DataGridView 单词和数字

> ID：262108
> 
> 赞同：0
> 
> 时间：2008-11-04T15:15:06.257
> 
> 标签：c#, datagridview

我正在创建一个应用程序，它在 DataGridView 中显示一些消息及其方向。我想用图片替换一些列内容。例如，我想用绿色箭头（一些 .jpg 图像）替换代表来电的数字 0。

有谁知道如何做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-02T00:30:58.203

我们将图像作为 BMP 文件存储在资源文件中。然后，我们像这样处理 DataGridView 中的 CellFormatting 事件：

```
 private void messageInfoDataGridView_CellFormatting(object sender, DataGridViewCellFormattingEventArgs e)
    {
        // Is this the correct column? (It's actually a DataGridViewImageColumn)
        if (messageInfoDataGridView.Columns[e.ColumnIndex] == messageSeverityDataGridViewTextBoxColumn)
        {
            // Get the row we're formatting
            DataGridViewRow row = messageInfoDataGridView.Rows[e.RowIndex];
            // Get the enum from the row.
            MessageSeverity severity = ((MessageInfo)row.DataBoundItem).MessageSeverity;
            Bitmap cellValueImage;
            // Map the enumerated type to an image...
            // SeverityImageMap is a Dictionary<MessageSeverity,Bitmap>.
            if (ReferenceTables.SeverityImageMap.ContainsKey(severity))
                cellValueImage = ReferenceTables.SeverityImageMap[severity];
            else
                cellValueImage = Resources.NoAction;

            // Set the event args.
            e.Value = cellValueImage;
            e.FormattingApplied = true;
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T15:24:50.777

GridView 能够使用图像字段而不是数据绑定字段。这听起来像它会做的伎俩。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T15:28:56.400

查看创建自定义 datagridviewCell datagridviewColumn 和/或 dataGridViewEditingControl。

# .net - 沉迷于 LINQ

> ID：262110
> 
> 赞同：11
> 
> 时间：2008-11-04T15:15:27.020
> 
> 标签：.net, linq

好吧，我越用LINQ，越喜欢它！我最近发现自己在工作中使用一些遗留代码。它是您经典的 DataSet 和 DataTable 丰富的应用程序。好吧，当添加一些功能时，我发现自己*真的*只想查询 DataTable 的行以获取我正在寻找的结果。

让我重复一遍......而不是循环并添加到临时集合中，我只是想向 Rows 集合询问我需要什么。没有循环，没有临时变量，只要给我我想要的。

```
var customerOrderIds = table.Rows.Cast<DataRow>()
   .Where(x => (string)x["CUSTOMER_ID"] == customerId)
   .Select(x => (string)x["CUSTOMER_ORDER_ID"])
   .Distinct(); 
```

**我的问题是这是否是一件好事，或者是否对 LINQ 感到厌烦？**在我看来，这种从集合中提取数据子集的声明式风格确实是一件好事，而且最终更具可读性。但话又说回来，也许我只是被迷住了:)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-04T15:28:16.947

另一项观察；如果您不使用类型化数据集，您可能还想了解`Field<>`扩展方法：

```
 var customerOrderIds = table.Rows.Cast<DataRow>()
       .Where(x => x.Field<string>("CUSTOMER_ID") == customerId)
       .Select(x => x.Field<string>("CUSTOMER_ORDER_ID"))
       .Distinct(); 
```

或者使用查询语法：

```
 var customerOrderIds = (
        from row in table.Rows.Cast<DataRow>()
        where row.Field<string>("CUSTOMER_ID") == customerId
        select row.Field<string>("CUSTOMER_ORDER_ID")
     ).Distinct(); 
```

我并不是说它是更好或更坏 - 只是另一个可行的选择。

（其实我用`DataTable`的不多，所以YMMV）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-04T15:18:21.540

对我来说似乎很好 - 尽管我会尝试使用强类型数据集，这使得 LINQ 查询看起来更加愉快。

但是，是的，LINQ 是一个非常好的东西 - 与进程外 LINQ 提供程序相比，LINQ to Objects（以及用于 XML 和 DataSets 的周边技术）是非常可预测的。（它不如 LINQ to SQL*性感*，但更广泛适用于 IMO。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-04T18:23:18.547

查询看起来不错。

我想指出两件小事。

> 没有循环

System.Linq.Enumerable 方法对 IEnumerable(T) 合约进行操作，这几乎总是意味着循环 - O(N) 解决方案。这有两个含义：

*   比 Count() > 0 更喜欢 Any() 。Any() 是 O(1)。计数（）是 O（N）。
*   连接...所有连接都是嵌套循环 O(M*N)。

> 。投掷

.Cast 对 DataTable.Rows 非常有效（所有这些对象都是行，所以 cast 总是成功的）。对于异构集合，请注意 .OfType() - 它会过滤掉任何无法转换的项目。

最后，请注意查询在被枚举之前不会执行！您可以通过 foreach、ToList、ToArray、First、Single 等强制枚举。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T15:18:52.473

就个人而言，由于数据表没有能力自行选择不同的，我会说它并不是那么糟糕。

我可能会问，是否有任何方法最终可以使用对象而不是数据表，因为我认为未来的开发人员会更容易理解。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T15:19:01.570

你根本不会得意忘形。在 LINQ to DataSets 上发布了实际作品。拥有如此清晰、声明性的对象查询使得代码的可维护性变得更加容易。但是您必须记住，在您过滤数据时，所有数据都已被拉回。您可能需要考虑将过滤添加到 DataSet 查询的 SQL 中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-04T15:30:55.990

LINQ 只是为您编写“循环/临时变量”代码。LINQ 可帮助您更快地编写代码（并且更具可读性）。

你的代码很好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-08-07T15:37:14.967

连接（使用 join 关键字，但不使用 from 关键字）使用 Dictionary 进行匹配，因此是`O(M+N)`。

group by 也是如此，但以下不是：

```
from x in Xs
from y in Ys
    .Where(o => o == x)
select new
{
    x,
    y
} 
```

这是`O(M*N)`。

# build-automation - 巡航控制源安全模块

> ID：262116
> 
> 赞同：2
> 
> 时间：2008-11-04T15:16:42.650
> 
> 标签：build-automation, cruisecontrol.net, ccnet-config

工作中的构建机器有很多项目，但我们只遇到一个问题。

两个项目非常相似，一个在调试模式下构建，另一个在发布模式下。他们都清除了项目目录，然后从源代码安全中进行了完整的获取。调试版本很好且相当快地获得源代码，但发布版本需要很长时间才能获得源代码（它在 CheckingModifications 部分暂停很长时间，而调试版本不会暂停几乎一样长的时间）。源代码控制块是相同的（包含在单个文件中），如下所示：

```
<sourcecontrol type="vss" autoGetSource="true" applyLabel="false">
    <executable>C:\Program Files\Microsoft Visual Studio\VSS\win32\SS.EXE</executable>
    <project>$/Projects</project>
    <username>####</username>
    <password>####</password>
    <ssdir>\\####\SourceCode\VSS</ssdir>
    <workingDirectory>D:\Projects\</workingDirectory>
    <culture>en-GB</culture>
    <cleanCopy>True</cleanCopy>
</sourcecontrol> 
```

任何人对为什么发布构建源代码控制块更慢有任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-16T14:11:47.053

最后，我们从 SourceSafe 切换到 SourceGear Vault（主要是为了分支功能，但速度和可靠性也是很大的因素）。

我们还将构建机器从旧电脑移到了与源服务器有 1Gb/s 连接的服务器，而不是 100Mb/s，这有很大帮助。

最后，当我在与旧构建机器相同的机器（嗯，克隆）上安装和测试 Vault 时，它将源代码获取操作从大约 10 分钟减少到 5 分钟。一旦它安装在构建服务器上，源代码获取现在时间是1分钟左右。

我对任何人的建议就是从 SourceSafe 切换到其他任何东西......你不会后悔的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-13T16:51:59.920

Debug 和 Release 版本是否同时运行？如果是这样，我可以看到一个在等待另一个完成。

# java - 如何在 Java 中处理多个鼠标输入？

> ID：262125
> 
> 赞同：12
> 
> 时间：2008-11-04T15:18:41.197
> 
> 标签：java, mouse, hci

我的一个朋友让我实现一个蓝色和一个红色指针来表示两个独立鼠标的输入，以加快用于实时音频混合的混音台场景。我很乐意，但尽管我认为这是一个好主意，但我不知道从哪里开始寻找可能的解决方案。

我应该从哪里开始研究实现双鼠标输入的可行方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-04T18:24:33.583

看看[jinput](http://java.net/projects/jinput)。

我有多个键盘使用它，我几乎可以肯定它也支持多个鼠标。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-04T18:13:01.657

不了解 java.. 但对于 C#/c++，您可以尝试 [Microsoft Windows MultiPoint Software Development Kit](http://www.microsoft.com/downloads/details.aspx?FamilyID=A137998B-E8D6-4FFF-B805-2798D2C6E41D&displaylang=en)

我已经在 Windows 上试过了。它适用于 2 个 USB 鼠标。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-04T23:31:20.920

这取决于您打算使用的操作系统。

在**Windows**上，您可以使用：

1.  [CPNMouse](http://cpnmouse.sourceforge.net/) - 驱动程序+软件组合，非常灵活，可以完全隐藏操作系统中的一些鼠标。
2.  [RawInput](http://www.google.com/search?q=rawinput&ie=UTF-8) - 仅由 Windows XP 提供的 API。您可以使用它来区分两个鼠标输入，自己绘制光标并隐藏主光标。看一下[SDGT](http://grouplab.cpsc.ucalgary.ca/software/SDGT)的代码，这是该 API 的 C# 用法。
3.  对于这两种解决方案，您都必须为您的应用程序构建一个 JNI 桥

如果您使用的是**X.Org (X11)**服务器，则有一个名为[MPX](http://wearables.unisa.edu.au/mpx/)的修补版本，即使对于旧版应用程序，它也应该支持多个鼠标。它现在应该是 X.Org 主干的一部分，但我对它不是很熟悉。无论如何，它有一个 API，所以你可以通过 JNI 桥使用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T22:29:10.623

您可以使用多个设备，但在 Java 级别，所有鼠标事件都合并为一个流。该事件不包括它来自哪个鼠标。你确实说过你想混合音频，对吧？好吧，这种组合可能很有趣，但肯定不是您想要的。

我建议使用支持 Java 的 midi 接口，并将一些简单的 midi 控制器设备与多个旋钮或轨迹球连接起来。这些将作为 midi 事件出现，您可以检查状态以获取所需的详细信息。

# asp.net - 清理 .NET HTML 生成

> ID：262131
> 
> 赞同：1
> 
> 时间：2008-11-04T15:19:42.817
> 
> 标签：asp.net, .net-2.0, treeview

我希望清理一些由 .NET 2.0 TreeView 控制器生成的 HTML。切换到另一个版本/型号不是一个可用的选项。

我的第一次破解产生了一个扩展的 TreeView，它带有一个重写的 Render，它正则表达式将我不需要的文本输出到页面。

问题是当我试图折叠/展开树的节点时，我的回发事件没有被触发。我的假设是我不需要再做任何重写，因为父 TreeView 控制器将处理回发事件。

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T15:28:56.353

使用 ASP.NET CSS 控制适配器：

[http://www.asp.net/CSSAdapters/TreeView.aspx](http://www.asp.net/CSSAdapters/TreeView.aspx)

> 如果没有适配器，两者都使用 HTML <table> 标签。可以使用控制适配器，以便呈现嵌套的 <ul> 标记。然后可以使用 CSS 和 JavaScript 的组合来显示和隐藏树或菜单的层次结构的一部分。移除 CSS 和 JavaScript 后，适应的 HTML 会降级为简单的嵌套无序列表，屏幕阅读器等可以轻松解释这些列表。您可以通过在左侧的主题选择器中将主题设置为无来亲自查看。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T16:04:25.673

您正则表达式删除了控件处理回发所需的内容。它可能是高度复杂的 id 或 runat 属性......不管它是什么，如果你被 web 控件困住，你就会被糟糕的 html 困住。

做你想做的事情的唯一真正（和非破坏性）方法不是*扩展*当前控件，而是使用[Control Adapters](http://www.goeleven.com/blog/entryDetail.aspx?entry=46)。已经有使用 css 进行定位的控制适配器。 [这是 ScottGu 关于这些 CSS 适配器的帖子。](http://weblogs.asp.net/scottgu/archive/2006/10/28/CSS-Control-Adapters-Update-_2800_Beta3_2900_.aspx)

# asp.net - Web 应用程序的“简单”安装程序（IIS 虚拟应用程序 + sql server db setup）

> ID：262133
> 
> 赞同：3
> 
> 时间：2008-11-04T15:20:36.543
> 
> 标签：asp.net, web-applications, installation

我需要创建一个 Web 应用程序安装程序。

安装 Shield 似乎有点矫枉过正，有什么东西可以可靠地安装 Web 应用程序（IIS 设置 + sql server db 设置）。

建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T17:06:10.510

CruiseControl.NET ( [http://sourceforge.net/projects/ccnet/](http://sourceforge.net/projects/ccnet/) ) 为此使用 NullSoft 的 NSIS。它做得很好，而且是免费的。安装程序设置脚本，包括在 IIS 中设置一些网站特征的 VBScript 程序，都在源代码树中 ( [http://ccnet.svn.sourceforge.net/viewvc/ccnet/trunk/ccnet.nsi?view=日志](http://ccnet.svn.sourceforge.net/viewvc/ccnet/trunk/ccnet.nsi?view=log)和[http://ccnet.svn.sourceforge.net/viewvc/ccnet/trunk/install](http://ccnet.svn.sourceforge.net/viewvc/ccnet/trunk/install)）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T15:59:10.070

看看[WIX](http://wix.sourceforge.net/manual-wix2/overview.htm)，[模式帮助](http://www.wixwiki.com/index.php?title=Wix_Schema)，它可以做你想做的事情等等......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-04T16:17:41.467

InstallShield 或其竞争对手之一是简单的解决方案，其他任何事情都需要您了解有关 msi 的更多信息（这是一个令人头疼的问题）。我目前喜欢[Advanced Installer](http://www.advancedinstaller.com/)，他们有免费版。我相信 InstallSheild 也有免费版本，我只是不再喜欢 InstallShield 产品，而且他们的控股公司实际上每年都在变化，这让我很困扰。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T18:46:44.893

我只能第二个[NSIS](http://nsis.sourceforge.net/Main_Page)（Nullsoft Scriptable Install System）。支持脚本并且易于设置。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-11-04T16:05:18.887

installshield 是一个很好的方法来做到这一点。可以很好地处理 sql server 设置和 iis 配置。

虽然恐怕不便宜，但对于任何类型的安装都是值得的。wix 可能是一个不错的选择，但是您可以花多少时间来学习它，而不是单击 installshield 中的一些向导。

# dll - 如何浏览 ActiveX DLL 的类和方法？

> ID：262134
> 
> 赞同：11
> 
> 时间：2008-11-04T15:20:56.293
> 
> 标签：dll, activex, explorer

基本上，我想要的是能够探索 ActiveX DLL。我通常启动 VB 6，将 DLL 添加到项目的“引用”，然后使用对象资源管理器。

但是，在这台特定的机器上我无法安装 VB/VS。
我敢肯定有一个工具可以做到这一点。有人知道吗？

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-04T15:30:12.280

如果机器安装了 Microsoft Office，您可以进入内置的 Visual Basic for Applications IDE 并在那里加载对象：

工具菜单 -> 宏 -> Visual Basic 编辑器（或按 Alt+F11）

然后在 VBA 窗口中，工具菜单 -> 参考 -> 浏览以找到您的 DLL

并查看菜单 -> 对象浏览器以查看对象的内容（或按 F2）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-04T15:48:06.767

为此，我使用了 Microsoft 的 OLE/COM Object Viewer。它曾经与旧版本的 Visual Studio 一起安装，并且仍然是 Windows SDK 的一部分。

它似乎也[可以单独使用](http://www.microsoft.com/downloads/details.aspx?familyid=5233b70d-d9b2-4cb5-aeb6-45664be858b6&displaylang=en)——这是来自旧版本的 Windows SDK，但我认为这个工具最近没有太大变化。

要查看特定 DLL 或 OCX 的类型信息，文件、查看 TypeLib... 是您正在寻找的选项。您还可以浏览主窗口中的“控件”组，以查看有关已注册控件的详细信息。右键单击控件的条目，然后单击查看类型信息以查看其公开的类型和方法的详细信息。

这将显示比 VB6 更多的信息。如果您正在查看 ActiveX 控件，则需要查看类型库显示的*coclass*和*dispinterface*部分。

（“查看”菜单中还有一个专家模式选项——这将向您显示存储在注册表中与 COM、OLE 和 ActiveX 相关的几乎所有内容。这通常是相当多的信息.​​.....）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-04T15:26:48.603

是否可以从该机器下载组件并在 Visual Studio 中进行本地检查？（这是我的第一个建议。）（顺便说一句，Visual Studio 的 .NET 版本还具有类似 VB6 的对象资源管理器，可以很好地解决这个问题。）

~~或者，它不是免费的，但您可以尝试[ActiveXplorer](http://www.aivosto.com/activexplorer.html)。（我还没有尝试过，但它看起来很有希望。）~~ **[（停产）]**

# seo - 如何让 Googlebot 相信两个以前使用别名的网站现在是分开的？

> ID：262135
> 
> 赞同：4
> 
> 时间：2008-11-04T15:21:02.110
> 
> 标签：seo, googlebot

这将需要一些设置。相信我，这是为了一个好的事业。

## 的背景

我的一个朋友经营一个非营利性公益网站已经两年了。该网站旨在消除有关某个公众人物的错误信息。当然，在过去的两年里，我们这些支持他所做事情的人不断地链接到该网站，以便在 Google 中推广它，以便在您搜索这个公众人物的名字时，它会显得非常高。（事实上​​，它是#2 结果，就在公众自己的网站下方）。他没有*这个*公众人物的支持，但他所做的一切都是为了公共利益和利益。

朋友最近中风了。巧合的是，当他在医院时，域名就被更新了，而他的妻子却错过了有关它的电子邮件。一个域名抢注者抢购了该域名，并发布了与他的意图截然相反的内容。这个擅自占地者现在受益于他的谷歌展示位置和页面排名。

幸运的是，他拥有的其他域被别名指向该域，即他们使用 DNS 映射或 HTTP 301 重定向（我不确定哪个）将人们发送到正确的站点。我们重新配置了一个别名域以直接指向原始内容。

我们已经为该站点公布了这个新名称，社区现在已经创建了数千个指向新域的链接，并且正在修复所有旧链接。从缓存中我们可以看出，谷歌实际上已经爬取了新地址的原站点，并且重新爬取了冒名顶替的站点。

## 问题

即使 Google 已经抓取了这两个网站，您也无法让该网站出现在新 URL 下的相关搜索中！

在我看来，Google 记得这两个名称之间的旧重定向（可能是因为当它是别名时有人链接到新域）。它在所有结果中将这两个站点视为同一个站点。站点名称的结果以及使用“链接：”运算符查找链接到该站点的站点与 Google 确信它们是同一个站点的结果完全一致。

请记住，我们*无法*控制*旧*域的内容，也*没有*与这些网站相关的人的合作。

**我们如何才能让 Googlebot 相信域“a”和域“b”现在是两个不同的站点，并且应该在结果中这样对待？**

编辑：转发可能是 DNS，而不是基于 HTTP。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T16:53:37.913

谷歌将检测到旧域链接的减少，这将对其造成伤害。

在新域中加入一些有趣的新内容。这将鼓励 Google 抓取此域。

301 重定向将被及时遗忘。也许几个月。请注意，他们将一组 URL 重定向到另一组，而不是从一个域到另一个域。获取一些指向站点内一些*新*页面的链接，而不仅仅是主页，因为这些 URL 不会在旧的重定向集中。

设置 Google 网站管理员工具并提交 XML 站点地图。大约每周一次彻底检查网站管理员工具中的所有内容。

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T15:28:06.123

时间可以抚平所有的伤...

失去对领域的控制是一个很大的打击，需要时间来恢复。听起来您正在遵循所有正确的程序（让人们更改链接、使用 301 等）

重新上架后，原网站的内容有变化吗？如果没有，您可能应该进行一些更改。如果 Google 重新抓取该页面并发现它与之前编入索引的页面基本相同，它可能会认为它是一个副本，这就是它使用原始 URL 的原因。

此外，我相信 Google 有针对此类情况的解决流程。我不确定要填写什么表格或联系谁，但肯定有其他一些 SO 公民可以提供帮助。

祝你好运！

# c# - c#asp.net 3.5中图像按钮上的文本

> ID：262141
> 
> 赞同：10
> 
> 时间：2008-11-04T15:22:34.603
> 
> 标签：c#, asp.net

我有一个图像按钮。我想在上面添加一个文本“搜索”。我无法添加它，因为 VS 2008 中的“imagebutton”属性中没有文本控件。谁能告诉我如何将文本添加到图像按钮？

```
 <asp:ImageButton ID="Searchbutton" runat="server" AlternateText="Search" 
        CssClass="bluebutton"
        ImageUrl="../Graphics/bluebutton.gif" Width="110px" 
        onclick="Searchbutton_Click"/> 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-11-04T15:28:33.827

```
<button runat="server" 
  style="background-image:url('/Content/Img/stackoverflow-logo-250.png')" >
  your text here<br/>and some more<br/><br/> and some more ....
  </button> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-12-13T13:38:16.810

来自[dotnetslave.com](http://forums.asp.net/t/1024015.aspx)的这个提示对我有用：

```
<asp:LinkButton 
    CssClass="lnkSubmit" 
    ID="lnkButton" 
    runat="server">SUBMIT</asp:LinkButton>

a.lnkSubmit:active
{    
    margin:0px 0px 0px 0px;
    background:url(../../images/li_bg1.jpg) left center no-repeat;
    padding: 0em 1.2em;
    font: 8pt "tahoma";
    color: #336699;
    text-decoration: none;
    font-weight: normal;
    letter-spacing: 0px; 
```

}

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-04T15:28:51.737

你不能用`ImageButton`.

但是，您可以使用简单的`Button`，设置文本，并使用 CSS 添加背景图像 (bluebutton.gif) 来达到所需的效果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-03-16T10:04:06.777

无法在图像按钮内添加文本。我也面临同样的问题。我的解决方案是使用链接按钮而不是图像按钮。只需在样式标签中添加图像即可。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T15:31:06.037

我认为您不能将文本写入 ASP.NET 的 ImageButton 控件。如果这是您需要的，您可以即时生成图像，并从后面的代码中编写文本，但这太复杂了，请使用带有 CSS 的普通按钮，除非您的图像不能由 CSS 生成。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-11-01T22:06:18.490

您也可以使用 asp:Label 来执行此操作，如下所示：

```
<style type="text/css">
    .faux-button
    {
        cursor:pointer;
    }
</style>

<div class="faux-button">
    <asp:ImageButton ID="ibtnAddUser" 
        runat="server" 
        ImageUrl="~/Images/add.gif" 
        AlternateText="Add a user image" />
    <asp:Label ID="lblAddUser" 
        runat="server" 
        Text="Add User" 
        AssociatedControlID="imgClick" />
</div> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-02-07T09:09:07.150

我意识到这是一篇旧帖子，但我最近为自己解决了同样的问题。

我创建了一个 ImgButton 服务器控件来呈现这个：

```
<button> <img src="button_icon.png" /> Caption Text </button> 
```

使用 CSS 来设置背景图片的样式有一些缺点，主要是：

*   除非您对左对齐的图像和右对齐的文本变得聪明，否则文本往往会与图像重叠（如果您将 RTL 语言混入其中，这会很不方便）
*   该图像是背景图像，当我们单击按钮时，它似乎不是“在按钮上”，它不会像文本一样被“按下”

我将尝试在此处插入代码，但这里也有完整的源代码和示例： [Button with Img tag and Caption Text](http://www.allottware.co.za/Blog/archive/2012/02/07/button-img-button-with-image-and-text-button.aspx)

图片按钮.cs：

```
[DefaultProperty("Text")]
[DefaultEvent("Click")]
[ToolboxData("<{0}:ImgButton runat=server></{0}:ImgButton>")]
public class ImgButton : WebControl, IPostBackEventHandler
{
    #region Public Properties

    public enum ImgButtonStyle
    {
        Button,
        Anchor
    }

    [Bindable(true)]
    [Category("Appearance")]
    [DefaultValue("")]
    [Localizable(true)]
    public string Text
    {
        get
        {
            String s = (String)ViewState["Text"];
            return ((s == null) ? String.Empty : s);
        }

        set
        {
            ViewState["Text"] = value;
        }
    }
    [EditorAttribute(typeof(System.Web.UI.Design.ImageUrlEditor), typeof(UITypeEditor))]
    public string ImgSrc { get; set; }
    public string CommandName { get; set; }
    public string CommandArgument { get; set; }
    [EditorAttribute(typeof(System.Web.UI.Design.UrlEditor), typeof(UITypeEditor))]
    public string NavigateUrl { get; set; }
    public string OnClientClick { get; set; }
    public ImgButtonStyle RenderStyle { get; set; }
    [DefaultValue(true)]
    public bool UseSubmitBehavior { get; set; }
    [DefaultValue(true)]
    public bool CausesValidation { get; set; }
    public string ValidationGroup { get; set; }
    [DefaultValue(0)]
    public int Tag { get; set; }

    #endregion

    #region Constructor

    public ImgButton()
    {
        Text = "Text";
        ImgSrc = "~/Masters/_default/img/action-help.png";
        UseSubmitBehavior = true;
        CausesValidation = true;
    }

    #endregion

    #region Events

    // Defines the Click event.
    public event EventHandler Click;
    public event CommandEventHandler Command;

    protected virtual void OnClick(EventArgs e)
    {
        if (Click != null)
        {
            Click(this, e);
        }
    }

    protected virtual void OnCommand(CommandEventArgs e)
    {
        if (Command != null)
        {
            Command(this, e);
        }
        RaiseBubbleEvent(this, e);
    }

    public void RaisePostBackEvent(string eventArgument)
    {
        if (CausesValidation)
        {
            Page.Validate(ValidationGroup);
            if (!Page.IsValid) return;
        }
        OnClick(EventArgs.Empty);
        if (!String.IsNullOrEmpty(CommandName))
            OnCommand(new CommandEventArgs(CommandName, CommandArgument));
    }

    #endregion

    #region Rendering

    // Do not wrap in <span> tag
    public override void RenderBeginTag(HtmlTextWriter writer)
    {
        writer.Write("");
    }

    protected override void RenderContents(HtmlTextWriter output)
    {
        string click;
        string disabled = (Enabled ? "" : "disabled ");
        string type = (String.IsNullOrEmpty(NavigateUrl) && UseSubmitBehavior ? "submit" : "button");
        string imgsrc = ResolveUrl(ImgSrc ?? "");

        if (String.IsNullOrEmpty(NavigateUrl))
            click = Page.ClientScript.GetPostBackEventReference(this, "");
        else
            if (NavigateUrl != null)
                click = String.Format("location.href='{0}'", ResolveUrl(NavigateUrl));
            else
                click = OnClientClick;

        switch (RenderStyle)
        {
            case ImgButtonStyle.Button:
                if (String.IsNullOrEmpty(NavigateUrl) && UseSubmitBehavior)
                {
                    output.Write(String.Format(
                        "<button id=\"{0}\" {1}class=\"{2}\" type=\"{3}\" name=\"{4}\" title=\"{5}\"><img src=\"{6}\" alt=\"{5}\"/>{7}</button>",
                        ClientID,
                        disabled,
                        CssClass,
                        type,
                        UniqueID,
                        ToolTip,
                        imgsrc,
                        Text
                    ));
                }
                else
                {
                    output.Write(String.Format(
                        "<button id=\"{0}\" {1}class=\"{2}\" type=\"{3}\" name=\"{4}\" onclick=\"javascript:{5}\" title=\"{6}\"><img src=\"{7}\" alt=\"{6}\"/>{8}</button>",
                        ClientID,
                        disabled,
                        CssClass,
                        type,
                        UniqueID,
                        click,
                        ToolTip,
                        imgsrc,
                        Text
                    ));
                }
                break;

            case ImgButtonStyle.Anchor:
                output.Write(String.Format(
                    "<a id=\"{0}\" {1}class=\"{2}\" onclick=\"javascript:{3}\" title=\"{4}\"><img src=\"{5}\" alt=\"{4}\"/>{6}</a>",
                    ID,
                    disabled,
                    CssClass,
                    click,
                    ToolTip,
                    imgsrc,
                    Text
                ));
                break;
        }
    }

    public override void RenderEndTag(HtmlTextWriter writer)
    {
        writer.Write("");
    }

    #endregion
} 
```

这是我在按钮上使用的 CSS（我将“icon”放在按钮的 CssClass 属性中）：

```
button.icon
{
    cursor: pointer;
}

button.icon img
{
    margin: 0px;
    padding: 0px 5px 0px 5px;
    vertical-align: middle;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-08-13T17:12:39.090

如果您使用链接按钮，您可以添加一个引导按钮，然后通过 CSS“after”属性添加文本。

**链接按钮：**

```
<asp:LinkButton id="download" CssClass="btn btn-primary" Text="Download" OnCommand="OnButtonClick" CommandName="Download" runat="server">
                <span aria-hidden="true" class="glyphicon glyphicon-download-alt"></span></asp:LinkButton> 
```

**CSS：**

```
#MainContent_download:after{ 
content: "Download"; 
padding-left: 5px; 
```

}

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-06-17T14:45:15.523

我更喜欢以下解决方案：

```
 <div style="padding: 5px; float: left;overflow: auto;height: auto;">
                        <asp:ImageButton ID="ImageButton2" ImageUrl="./icons/search24.png" ToolTip="Search"  runat="server" />
                        <p><asp:Label ID="Label7" runat="server" Text="Search"></asp:Label></p>
                    </div> 
```

您可以更改`style`以使其居中对齐等。

# asp.net - 在 ASP.NET 中打印的最佳方式

> ID：262143
> 
> 赞同：2
> 
> 时间：2008-11-04T15:23:20.343
> 
> 标签：asp.net, printing

使用 XSLT 转换为所需的模板后，我在内存中保存了一个 html 字符串。将其发送到客户端打印机的最佳机制是什么？

在以前的项目中，我无耻地作弊并创建了一个打印预览屏幕，它本质上是一个白色背景的 ASPX 页面，然后我使用`Window.print()`.

干杯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-04T15:50:40.040

我认为“打印预览”根本不是作弊。由于您的字符串很可能在服务器上（即在 ASP.NET 代码隐藏中创建），因此您必须以某种方式将其输出到客户端并调用 window.print() 进行打印。网络服务器无法访问客户端的打印机。但是，您可以使用一些技巧来简化事情：

- 在 CSS 中使用 @media 标签为您的页面提供可打印的样式。在许多情况下，您可以使用它来隐藏任何导航等，而不需要“打印预览”。我通常在我的 .css 文件中添加如下内容：

```
.showwhenprinting {position:absolute; display:none;}
@media print
{
  .hidewhenprinting {position:absolute; display:none;}
  .showwhenprinting {position:relative; display:block;}
} 
```

这将让您在大多数浏览器中打印时隐藏块。例如：

```
<div class="someclass hidewhenprinting">Navigation Menu</div>
<div class="someclass showwhenprinting">Printed Page Title</div> 
```

这种方法的另一个好处是它允许用户像通常在浏览器中一样简单地单击“打印”。缺点是一些较旧的浏览器不支持它，并且在某些情况下它不能让您对布局进行足够的控制（例如，如果您需要页眉/页脚）。

- 如果以上内容没有为您提供所需的输出（例如，您不希望在打印结果中显示页面 URL 等），则另一种选择是使用对打印机友好的格式，例如 PDF。为此，请使用 Reporting Services 或类似工具生成 PDF。

- 我不会真正推荐的最后一个选项是向页面添加一个隐藏的 iframe，使用“可打印”HTML 填充它，然后在其中调用 print()。这可能有效，但需要一些 javascript 才能完成，因此您需要注意使其跨浏览器。这将具有与选项 #1 相同的缺点，但更难正确处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T15:28:02.423

查看 CSS 媒体选择器。您可以使用它们在屏幕上创建您想要的外观，并且当用户在浏览器中选择打印时也可以很好地打印。

# security - 编码时我需要考虑哪些安全问题？

> ID：262145
> 
> 赞同：3
> 
> 时间：2008-11-04T15:23:33.290
> 
> 标签：security

我知道 SQL 注入是其中之一……其他的是什么……

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-04T15:29:26.213

OWASP.org 保留一个列表。从[OWASP 前十名](http://www.owasp.org/index.php/Category:OWASP_Top_Ten_Project)开始。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-11-10T06:53:25.177

其他人也这么说，但是...

基本上所有的安全漏洞都来自数据。如果您的程序不处理任何数据，它可能是安全的。它也可能毫无用处:)。

这导致了我认为使代码安全的核心概念：

不要相信你的数据。曾经。

尽可能消毒一切。您可以依赖平台的安全保证（例如，在 Java 或 C# 等托管语言中，您不太可能看到基于字符串的经典缓冲区溢出），但除此之外，您需要验证应用程序中的所有内容.

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-04T15:29:17.117

也不要**存储**明文密码。（我无法告诉你我为我的公司评估了多少商业软件包，然后当我把它们叫出来时，我对此漠不关心。我最喜欢的借口来自 CRM 供应商：“你的最终用户通常会拥有桌面上的企业管理器或查询分析器？”）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-04T16:17:00.267

[以下](https://www.securecoding.cert.org/confluence/display/seccode/Top+10+Secure+Coding+Practices)是 10 大安全编码实践列表。这是一个很好的开始。尤其考虑#8，纵深防御。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-04T16:46:54.217

在处理之前，按摩和过滤程序的所有输入。

永远不要在没有过滤和截断的情况下处理输入。

-R

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-04T15:25:06.267

[如果您正在编写 C，缓冲区溢出](http://en.wikipedia.org/wiki/Buffer_overflow)是经典的，因为它们通常允许攻击者执行任意代码。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-04T15:27:31.257

这是针对网络内容的，但是由于您将其保留为开放式...

JavaScript 注入。如果您允许来自正在输出某处的任何来源的任何输入，则可以在输入中键入 JavaScript，然后在输出时（除非正确编码/解码），它将输出原始 JavaScript。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-04T16:52:03.427

你可以认为这本书的章节是一个很好的清单......

[软件安全的 19 大罪过](https://rads.stackoverflow.com/amzn/click/com/0072260858)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-05T00:04:27.327

简单地进行防御性编程。对于每个函数/方法/过程/子例程，请考虑“预期的输入是什么？当输入偏离那个时我该怎么办？我怎样才能最容易地确保输入不会偏离那个。” 了解您的意见；知道你的输出。不要过火，但也要了解数据库中的数据可能已被泄露。如果可以以某种特定方式约束一组特定的数据，则选择您的数据类型和变量来发挥作用。保持数字事物的数字。

每当我在程序中看到一个字符串对象时，我都会开玩笑地问“如果这个字符串包含吉尔伯特和沙利文歌曲的歌词会发生什么？” 函数开头的简单 if-else 检查和过早的 return 语句可以防止这种事情在以后造成严重破坏。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-15T00:52:08.840

我喜欢使用[Threat Modeling Tools](http://msdn.microsoft.com/en-us/security/dd206731.aspx)对我的系统进行建模。这个特定的允许您对不同的应用程序进行建模，并根据模型为您提供有关哪些类型的威胁适用以及一些缓解措施及其风险的所有类型的信息。它还可以让您在整个开发过程中跟踪这些风险。提出缓解计划的生命周期。它太酷了。:)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-15T01:15:20.657

我支持以下建议：[软件安全的 19 项致命罪](https://rads.stackoverflow.com/amzn/click/com/0072260858)

它不仅仅是一个清单，阅读它以了解软件安全的许多方面。有些是宽泛的项目，可以让您了解许多不同安全问题背后的原因。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-04T15:27:59.977

发送纯文本密码而不首先加密它们绝不是一个好主意。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-04T15:28:29.943

避免发送纯文本用户名。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-11-04T15:30:31.797

如何验证用户输入？例如，您期望一个 10 位数的电话号码，但您得到“800OHNOES！”

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-04-15T00:39:16.157

除了关于 OWASP 的精彩指导，还可以查看 SANS/CWE。

# javascript - 用大量元素替换组合框的好 Javascript 组合框？

> ID：262150
> 
> 赞同：5
> 
> 时间：2008-11-04T15:24:53.913
> 
> 标签：javascript, html, combobox, dhtml

我有一个页面，其中我的组合框有数百个元素，这使得很难选择我想要的一个项目。有没有比 Javascript 更好的替代品

```
<select id="field-component" name="field_component"> 
                  <option selected="selected">1</option><option>2</option>...
</select> 
```

是否有类似“Intellisense”的自动完成功能？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-04T22:06:11.823

在 HTML 5 中有标准的组合框。

目前只有 Opera 支持它，但如果你碰巧是时间旅行者或编写 Opera-only 应用程序，这是一个不错的解决方案 :)

```
<input type=text list=listid>
<datalist id=listid>
  <select><option>1<option>2</select>
</datalist> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-04T15:30:19.067

![http://www.dhtmlx.com/images/logo_combo.gif](https://i.stack.imgur.com/TouKN.gif)
您有[dhtmlCombo](http://www.dhtmlx.com/docs/products/dhtmlxCombo/index.shtml)，在填写输入字段时使用 ajax 检索数据。

dhtmlxCombo 是一个具有自动完成功能的跨浏览器 JavaScript 组合框。

它扩展了基本的选择框功能，以满足最新 Web 应用程序的要求。

dhtmlxCombo 可以从现有的 HTML SELECT 转换或用 JavaScript 填充。支持AJAX，还可以**从服务器数据源动态获取列表值**。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-04T15:59:26.167

检查[jQuery Autocomplete](http://plugins.jquery.com/project/jq-autocomplete)插件，它很容易使用，你只需要在服务器端生成一个 JSON 响应。

请参阅[此演示](http://jquery.bassistance.de/autocomplete/demo/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T15:56:00.667

使用[Prototype](http://prototypejs.org)和[Scriptaculous](http://script.aculo.us/)的[自动完成](http://github.com/madrobby/scriptaculous/wikis/ajax-autocompleter)器在这种情况下运行良好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-05T03:14:15.137

请注意：如果选择框是当前焦点，您可以在键盘上键入，它将带您进入以该文本开头的选择，因此在美国州下拉菜单中键入“ken”将自动选择“肯塔基州”选项.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-21T20:04:29.850

你可以试试这个组合框的实现[http://www.zoonman.com/projects/combobox/](http://www.zoonman.com/projects/combobox/)

*   纯 JavaScript。可编辑。支持IE6。
*   非标准 HTML 布局。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-08-08T00:36:01.687

我认为 Twitter 的免费`typeahead.js`库是当今可用的最好的自动完成库。[在http://twitter.github.io/typeahead.js/](http://twitter.github.io/typeahead.js/)上查看

# iphone - UIImage圆角

> ID：262156
> 
> 赞同：68
> 
> 时间：2008-11-04T15:25:48.980
> 
> 标签：iphone, cocoa-touch

我尝试在 UIImage 上获得圆角，到目前为止我读到的，最简单的方法是使用蒙版图像。为此，我使用了 TheElements iPhone Example 的代码和我找到的一些图像大小调整代码。我的问题是 resizedImage 始终为零，我没有找到错误...

```
- (UIImage *)imageByScalingProportionallyToSize:(CGSize)targetSize
{
    CGSize imageSize = [self size];
    float width = imageSize.width;
    float height = imageSize.height;

    // scaleFactor will be the fraction that we'll
    // use to adjust the size. For example, if we shrink
    // an image by half, scaleFactor will be 0.5\. the
    // scaledWidth and scaledHeight will be the original,
    // multiplied by the scaleFactor.
    //
    // IMPORTANT: the "targetHeight" is the size of the space
    // we're drawing into. The "scaledHeight" is the height that
    // the image actually is drawn at, once we take into
    // account the ideal of maintaining proportions

    float scaleFactor = 0.0; 
    float scaledWidth = targetSize.width;
    float scaledHeight = targetSize.height;

    CGPoint thumbnailPoint = CGPointMake(0,0);

    // since not all images are square, we want to scale
    // proportionately. To do this, we find the longest
    // edge and use that as a guide.

    if ( CGSizeEqualToSize(imageSize, targetSize) == NO )
    { 
        // use the longeset edge as a guide. if the
        // image is wider than tall, we'll figure out
        // the scale factor by dividing it by the
        // intended width. Otherwise, we'll use the
        // height.

        float widthFactor = targetSize.width / width;
        float heightFactor = targetSize.height / height;

        if ( widthFactor < heightFactor )
            scaleFactor = widthFactor;
        else
            scaleFactor = heightFactor;

        // ex: 500 * 0.5 = 250 (newWidth)

        scaledWidth = width * scaleFactor;
        scaledHeight = height * scaleFactor;

        // center the thumbnail in the frame. if
        // wider than tall, we need to adjust the
        // vertical drawing point (y axis)

        if ( widthFactor < heightFactor )
            thumbnailPoint.y = (targetSize.height - scaledHeight) * 0.5;

        else if ( widthFactor > heightFactor )
            thumbnailPoint.x = (targetSize.width - scaledWidth) * 0.5;
    }

    CGContextRef mainViewContentContext;
    CGColorSpaceRef colorSpace;

    colorSpace = CGColorSpaceCreateDeviceRGB();

    // create a bitmap graphics context the size of the image
    mainViewContentContext = CGBitmapContextCreate (NULL, targetSize.width, targetSize.height, 8, 0, colorSpace, kCGImageAlphaPremultipliedLast);

    // free the rgb colorspace
    CGColorSpaceRelease(colorSpace);    

    if (mainViewContentContext==NULL)
        return NULL;

    //CGContextSetFillColorWithColor(mainViewContentContext, [[UIColor whiteColor] CGColor]);
    //CGContextFillRect(mainViewContentContext, CGRectMake(0, 0, targetSize.width, targetSize.height));

    CGContextDrawImage(mainViewContentContext, CGRectMake(thumbnailPoint.x, thumbnailPoint.y, scaledWidth, scaledHeight), self.CGImage);

    // Create CGImageRef of the main view bitmap content, and then
    // release that bitmap context
    CGImageRef mainViewContentBitmapContext = CGBitmapContextCreateImage(mainViewContentContext);
    CGContextRelease(mainViewContentContext);

    CGImageRef maskImage = [[UIImage imageNamed:@"Mask.png"] CGImage];

    CGImageRef resizedImage = CGImageCreateWithMask(mainViewContentBitmapContext, maskImage);
    CGImageRelease(mainViewContentBitmapContext);

    // convert the finished resized image to a UIImage 
    UIImage *theImage = [UIImage imageWithCGImage:resizedImage];

    // image is retained by the property setting above, so we can 
    // release the original
    CGImageRelease(resizedImage);

    // return the image
    return theImage;
} 
```

* * *

## 回答 #1

> 赞同：214
> 
> 时间：2009-12-02T17:36:11.813

如果您使用 UIImageView 来显示图像，您可以简单地执行以下操作：

```
imageView.layer.cornerRadius = 5.0;
imageView.layer.masksToBounds = YES; 
```

并添加边框：

```
imageView.layer.borderColor = [UIColor lightGrayColor].CGColor;
imageView.layer.borderWidth = 1.0; 
```

我相信您必须导入`<QuartzCore/QuartzCore.h>`并链接它才能使上述代码正常工作。

* * *

## 回答 #2

> 赞同：92
> 
> 时间：2011-11-21T01:44:51.827

这些线怎么样...

```
// Get your image somehow
UIImage *image = [UIImage imageNamed:@"image.jpg"];

// Begin a new image that will be the new image with the rounded corners 
// (here with the size of an UIImageView)
UIGraphicsBeginImageContextWithOptions(imageView.bounds.size, NO, 1.0);

// Add a clip before drawing anything, in the shape of an rounded rect
[[UIBezierPath bezierPathWithRoundedRect:imageView.bounds 
                            cornerRadius:10.0] addClip];
// Draw your image
[image drawInRect:imageView.bounds];

// Get the image, here setting the UIImageView image
imageView.image = UIGraphicsGetImageFromCurrentImageContext();

// Lets forget about that we were drawing
UIGraphicsEndImageContext(); 
```

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2015-08-31T03:08:54.953

我`UIImage`根据@epatel 的出色回答快速创建了一个-extension：

```
extension UIImage{
    var roundedImage: UIImage {
        let rect = CGRect(origin:CGPoint(x: 0, y: 0), size: self.size)
        UIGraphicsBeginImageContextWithOptions(self.size, false, 1)
        defer { 
            // End context after returning to avoid memory leak
            UIGraphicsEndImageContext() 
        }

        UIBezierPath(
            roundedRect: rect,
            cornerRadius: self.size.height
            ).addClip()
        self.drawInRect(rect)
        return UIGraphicsGetImageFromCurrentImageContext()
    }
} 
```

在故事板中测试：

[![故事板](https://i.stack.imgur.com/6Ij3P.png)](https://i.stack.imgur.com/6Ij3P.png)

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-03-30T20:00:44.160

问题是使用 CGImageCreateWithMask 返回全黑图像。我找到的解决方案是改用 CGContextClipToMask：

```
CGContextRef mainViewContentContext;
CGColorSpaceRef colorSpace;

colorSpace = CGColorSpaceCreateDeviceRGB();

// create a bitmap graphics context the size of the image
mainViewContentContext = CGBitmapContextCreate (NULL, targetSize.width, targetSize.height, 8, 0, colorSpace, kCGImageAlphaPremultipliedLast);

// free the rgb colorspace
CGColorSpaceRelease(colorSpace);    

if (mainViewContentContext==NULL)
    return NULL;

CGImageRef maskImage = [[UIImage imageNamed:@"mask.png"] CGImage];
CGContextClipToMask(mainViewContentContext, CGRectMake(0, 0, targetSize.width, targetSize.height), maskImage);
CGContextDrawImage(mainViewContentContext, CGRectMake(thumbnailPoint.x, thumbnailPoint.y, scaledWidth, scaledHeight), self.CGImage);

// Create CGImageRef of the main view bitmap content, and then
// release that bitmap context
CGImageRef mainViewContentBitmapContext = CGBitmapContextCreateImage(mainViewContentContext);
CGContextRelease(mainViewContentContext);

// convert the finished resized image to a UIImage 
UIImage *theImage = [UIImage imageWithCGImage:mainViewContentBitmapContext];
// image is retained by the property setting above, so we can 
// release the original
CGImageRelease(mainViewContentBitmapContext);

// return the image
return theImage; 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2018-08-02T16:07:05.683

**在Swift 4**中以正确的比例扩展[Besi 的优秀答案](https://stackoverflow.com/a/32303467/242682)：

 **```
extension UIImage {

    public func rounded(radius: CGFloat) -> UIImage {
        let rect = CGRect(origin: .zero, size: size)
        UIGraphicsBeginImageContextWithOptions(size, false, 0)
        UIBezierPath(roundedRect: rect, cornerRadius: radius).addClip()
        draw(in: rect)
        return UIGraphicsGetImageFromCurrentImageContext()!
    }

} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-11-04T17:16:46.870

除了在那里缩放之外，您实际上并没有做任何事情。您需要做的是通过用 CGPath 裁剪图像来“掩盖”图像的角落。例如 -

```
 - (void)drawRect:(CGRect)rect {
    CGContextRef context = UIGraphicsGetCurrentContext();
    CGContextBeginTransparencyLayerWithRect(context, self.frame, NULL);
    CGContextSetRGBFillColor(context, 1.0, 1.0, 1.0, 1.0);  
    CGFloat roundRadius = (radius) ? radius : 12.0;
    CGFloat minx = CGRectGetMinX(self.frame), midx = CGRectGetMidX(self.frame), maxx = CGRectGetMaxX(self.frame);
    CGFloat miny = CGRectGetMinY(self.frame), midy = CGRectGetMidY(self.frame), maxy = CGRectGetMaxY(self.frame);

    // draw the arcs, handle paths
    CGContextMoveToPoint(context, minx, midy);
    CGContextAddArcToPoint(context, minx, miny, midx, miny, roundRadius);
    CGContextAddArcToPoint(context, maxx, miny, maxx, midy, roundRadius);
    CGContextAddArcToPoint(context, maxx, maxy, midx, maxy, roundRadius);
    CGContextAddArcToPoint(context, minx, maxy, minx, midy, roundRadius);
    CGContextClosePath(context);
    CGContextDrawPath(context, kCGPathFill);
    CGContextEndTransparencyLayer(context);
} 
```

我建议查看 Quartz 2D 编程指南或其他一些示例。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-05-16T13:16:52.423

```
static void addRoundedRectToPath(CGContextRef context, CGRect rect, float ovalWidth, float ovalHeight)
{
  float fw, fh;
  if (ovalWidth == 0 || ovalHeight == 0) {
    CGContextAddRect(context, rect);
    return;
  }
  CGContextSaveGState(context);
  CGContextTranslateCTM (context, CGRectGetMinX(rect), CGRectGetMinY(rect));
  CGContextScaleCTM (context, ovalWidth, ovalHeight);
  fw = CGRectGetWidth (rect) / ovalWidth;
  fh = CGRectGetHeight (rect) / ovalHeight;
  CGContextMoveToPoint(context, fw, fh/2);
  CGContextAddArcToPoint(context, fw, fh, fw/2, fh, 1);
  CGContextAddArcToPoint(context, 0, fh, 0, fh/2, 1);
  CGContextAddArcToPoint(context, 0, 0, fw/2, 0, 1);
  CGContextAddArcToPoint(context, fw, 0, fw, fh/2, 1);
  CGContextClosePath(context);
  CGContextRestoreGState(context);
}

+ (UIImage *)imageWithRoundCorner:(UIImage*)img andCornerSize:(CGSize)size
{
    UIImage * newImage = nil;

    if( nil != img)
    {
       @autoreleasepool {
        int w = img.size.width;
        int h = img.size.height;

        CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();
        CGContextRef context = CGBitmapContextCreate(NULL, w, h, 8, 4 * w, colorSpace, kCGImageAlphaPremultipliedFirst);

        CGContextBeginPath(context);
        CGRect rect = CGRectMake(0, 0, img.size.width, img.size.height);
        addRoundedRectToPath(context, rect, size.width, size.height);
        CGContextClosePath(context);
        CGContextClip(context);

        CGContextDrawImage(context, CGRectMake(0, 0, w, h), img.CGImage);

        CGImageRef imageMasked = CGBitmapContextCreateImage(context);
        CGContextRelease(context);
        CGColorSpaceRelease(colorSpace);
        [img release];

        newImage = [[UIImage imageWithCGImage:imageMasked] retain];
        CGImageRelease(imageMasked);

       }
    }

  return newImage;
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-09-12T10:57:59.633

我认为这可能是非常相关的：在 iOS 11 中，有一种非常优雅的方式可以将 (Image)View 的每个角都舍入。

```
let imageView = UIImageView(image: UIImage(named: "myImage"))    
imageView.layer.maskedCorners = [.layerMinXMinYCorner, .layerMaxXMinYCorner]
imageView.layer.cornerRadius = 10.0 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-10-15T13:57:01.317

它使用剪切而不是蒙版的原因似乎是色彩空间。

苹果文档如下。

面具 面具。如果遮罩是图像，则它必须在 DeviceGray 颜色空间中，不得具有 alpha 分量，并且本身不能被图像遮罩或遮罩颜色遮罩。如果遮罩与图像参数指定的图像大小不同，则 Quartz 缩放遮罩以适合图像。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-12-12T09:23:09.850

大家好，试试这个代码，

```
+ (UIImage *)roundedRectImageFromImage:(UIImage *)image withRadious:(CGFloat)radious {

if(radious == 0.0f)
    return image;

if( image != nil) {

    CGFloat imageWidth = image.size.width;
    CGFloat imageHeight = image.size.height;

    CGRect rect = CGRectMake(0.0f, 0.0f, imageWidth, imageHeight);
    UIWindow *window = [[[UIApplication sharedApplication] windows] objectAtIndex:0];
    const CGFloat scale = window.screen.scale;
    UIGraphicsBeginImageContextWithOptions(rect.size, NO, scale);

    CGContextRef context = UIGraphicsGetCurrentContext();

    CGContextBeginPath(context);
    CGContextSaveGState(context);
    CGContextTranslateCTM (context, CGRectGetMinX(rect), CGRectGetMinY(rect));
    CGContextScaleCTM (context, radious, radious);

    CGFloat rectWidth = CGRectGetWidth (rect)/radious;
    CGFloat rectHeight = CGRectGetHeight (rect)/radious;

    CGContextMoveToPoint(context, rectWidth, rectHeight/2.0f);
    CGContextAddArcToPoint(context, rectWidth, rectHeight, rectWidth/2.0f, rectHeight, radious);
    CGContextAddArcToPoint(context, 0.0f, rectHeight, 0.0f, rectHeight/2.0f, radious);
    CGContextAddArcToPoint(context, 0.0f, 0.0f, rectWidth/2.0f, 0.0f, radious);
    CGContextAddArcToPoint(context, rectWidth, 0.0f, rectWidth, rectHeight/2.0f, radious);
    CGContextRestoreGState(context);
    CGContextClosePath(context);
    CGContextClip(context);

    [image drawInRect:CGRectMake(0.0f, 0.0f, imageWidth, imageHeight)];

    UIImage *newImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    return newImage;
}

return nil;
} 
```

干杯！！！

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-02-25T09:08:45.197

当您使用图像尺寸时，创建圆形图像非常容易。

```
cell.messageImage.layer.cornerRadius = image.size.width / 2
cell.messageImage.layer.masksToBounds = true 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-07-12T09:15:32.127

发现最好和最简单的方法如下（没有答案）：

```
UIImageView *imageView;

imageView.layer.cornerRadius = imageView.frame.size.width/2.0f;
imageView.layer.masksToBounds = TRUE; 
```

很简单，做对了。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-07-12T15:07:36.790

我喜欢@samwize 的答案，但是当与collectionView 一起使用时，它给我带来了严重的内存泄漏。为了修复它，我发现它`UIGraphicsEndImageContext()`丢失了

```
extension UIImage {
    /**
     Rounds corners of UIImage
     - Parameter proportion: Proportion to minimum paramter (width or height)
                             in order to have the same look of corner radius independetly
                             from aspect ratio and actual size
     */
    func roundCorners(proportion: CGFloat) -> UIImage {
        let minValue = min(self.size.width, self.size.height)
        let radius = minValue/proportion

        let rect = CGRect(origin: CGPoint(x: 0, y: 0), size: self.size)
        UIGraphicsBeginImageContextWithOptions(self.size, false, 1)
        UIBezierPath(roundedRect: rect, cornerRadius: radius).addClip()
        self.draw(in: rect)
        let image = UIGraphicsGetImageFromCurrentImageContext() ?? self
        UIGraphicsEndImageContext()
        return image
    }
} 
```

随意传递半径而不是比例。`proportion`之所以使用是因为我有 collectionView 滚动并且图像具有不同的大小，因此当使用恒定**半径**时，它实际上在比例方面看起来不同（例如：两个图像，一个是 1000x1000，另一个是 2000x2000，30的**角半径**在每一个上看起来都不同他们）

因此，如果您这样做，`image.roundCorners(proportion: 20)`所有图片看起来都具有相同的角半径。

这个答案也是一个更新版本。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-11-04T17:11:52.310

[见这里...](https://stackoverflow.com/questions/205431/rounded-corners-on-uiimage#205643) IMO 除非您绝对需要在代码中执行此操作，否则只需在顶部叠加图像即可。

类似于...的东西

```
- (void)drawRect:(CGRect)rect 
{
    // Drawing code
    [backgroundImage drawInRect:rect];
    [buttonOverlay drawInRect:rect];    
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-08-31T09:39:15.177

为了创建圆角图像，我们可以使用quartzcore。

首先如何添加QuartzCore框架？

```
Click  project -Targets
    ->project
       ->BuildPhase
           ->Link Binary with Libraries
             ->Then click + symbol finally select from list and add it 
```

要不然

```
Click  project -Targets
    ->Targets
      ->general
        ->Linked Frameworks and Libraries
          ->Then click + symbol finally select from list and add the QuartzCore framework 
```

现在导入

```
#import <QuartzCore/QuartzCore.h> 
```

在您的视图控制器中

然后在 viewDidLoad 方法中

```
self.yourImageView.layer.cornerRadius = 5.0;
self.yourImageView.layer.borderWidth = 1.0f;
self.yourImageView.layer.borderColor = [UIColor blackColor].CGColor;
self.yourImageView.layer.masksToBounds = YES; 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-11-27T19:16:06.603

我正在努力绕过故事板中 UIImage 框的角落。我的 UIImage 有一个名为 image 的 IBOutlet。在这里阅读了一堆帖子后，我简单地添加了 3 行，效果很好。

```
import UIKit 
```

然后在 viewDidLoad 中：

```
image.layer.cornerRadius = 20.0

image.layer.masksToBounds = true 
```

这适用于 Xcode 9 中的 iOS 11.1。

# iphone - 在 iOS 上禁用输入文本颜色

> ID：262158
> 
> 赞同：117
> 
> 时间：2008-11-04T15:26:50.960
> 
> 标签：iphone, html, css, safari, webkit

下面的简单 HTML 在 Firefox 和基于 WebKit 的浏览器中显示不同（我在 Safari、Chrome 和 iPhone 中检查过）。

在 Firefox 中，边框和文本都具有相同的颜色 ( `#880000`)，但在 Safari 中，文本会变得更浅一些（就好像它应用了一些透明度一样）。

我可以以某种方式解决这个问题（在 Safari 中删除这种透明度）吗？

```
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title></title>
        <style type="text/css">
        input:disabled{
            border:solid 1px #880000;
            background-color:#ffffff;
            color:#880000;
        }
        </style>
    </head>
    <body>
        <form action="">
            <input type="text" value="disabled input box" disabled="disabled"/>
        </form>
    </body>
</html>
```

* * *

## 回答 #1

> 赞同：274
> 
> 时间：2011-01-10T15:21:54.340

```
-webkit-text-fill-color: #880000;
opacity: 1; /* required on iOS */ 
```

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2014-05-07T07:20:59.953

手机和平板电脑的 webkit 浏览器（Safari 和 Chrome）和桌面 IE 对禁用的表单元素有许多默认更改，如果您想要设置禁用输入的样式，您需要覆盖这些更改。

```
-webkit-text-fill-color:#880000; /* Override iOS / Android font color change */
-webkit-opacity:1; /* Override iOS opacity change affecting text & background color */
color:#880000; /* Override IE font color change */ 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2019-04-27T01:44:46.257

**2021 年更新：**

将此页面中的想法结合到“设置并忘记”重置中，使所有禁用的文本与普通文本相同。

```
input:disabled, textarea:disabled, input:disabled::placeholder, textarea:disabled::placeholder {
  -webkit-text-fill-color: currentcolor; /* 1\. sets text fill to current `color` for safari */
  opacity: 1; /* 2\. correct opacity on iOS */
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-11-04T23:22:57.410

这是一个有趣的问题，我已经尝试了很多覆盖，看看我是否可以让它继续下去，但没有任何效果。现代浏览器实际上使用他们自己的样式表来告诉元素如何显示，所以如果你能嗅出 Chrome 的样式表，你可能会看到他们强加给它的样式。我会对结果非常感兴趣，如果你没有结果，我会在以后有时间浪费的时候自己花一点时间寻找它。

供参考，

```
opacity: 1!important; 
```

不会覆盖它，所以我不确定它的不透明度。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-11-05T00:00:23.343

您可以将颜色更改为`#440000`仅适用于 Safari，但恕我直言，最好的解决方案是**根本不更改按钮***的*外观。这样，在每个平台上的每个浏览器中，它看起来就像用户期望的那样。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2017-07-20T08:31:31.887

对于@ryan

我希望我的禁用输入框看起来像一个正常的输入框。这是唯一可以在 Safari Mobile 中使用的东西。

```
-webkit-text-fill-color: rgba(0, 0, 0, 1);
-webkit-opacity: 1;
background: white; 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-11-05T16:27:44.270

您可以使用 readonly 属性而不是 disabled 属性，但是您需要添加一个类，因为没有伪类输入：readonly。

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title></title>
<style type="text/css">
button.readonly{
    border:solid 1px #880000;
    background-color:#ffffff;
    color:#880000;
}
</style>
</head>
<body>
<form action="">
    <button type="button" readonly="readonly" class="readonly">disabled input box</button>
</form>
</body>
</html> 
```

请注意，禁用输入和只读输入不同。只读输入可以有焦点，并会在提交时发送值。看看[w3.org](http://www.w3.org/TR/html401/interact/forms.html#h-17.12)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2019-03-20T03:35:59.750

如果要解决所有禁用输入的问题，可以定义`-webkit-text-fill-color`to `currentcolor`，因此`color`将使用输入的属性。

```
input[disabled] {
   -webkit-text-fill-color: currentcolor;
} 
```

在 Safari 上查看小提琴 [https://jsfiddle.net/u549yk87/3/](https://jsfiddle.net/u549yk87/3/)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-06-01T16:09:23.647

这个问题很老了，但我想我会发布一个更新的 webkit 解决方案。只需使用以下 CSS：

```
input::-webkit-input-placeholder {
  color: #880000;
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-04T16:56:21.373

您可以使用按钮代替输入吗？

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <style type="text/css">
    button:disabled{
        border:solid 1px #880000;
        background-color:#ffffff;
        color:#880000;
    }
    </style>
</head>
<body>
    <form action="">
        <button type="button" disabled="disabled">disabled input box</button>
    </form>
</body>
</html> 
```

# html - 如何防止内联项目包装？

> ID：262160
> 
> 赞同：3
> 
> 时间：2008-11-04T15:27:30.100
> 
> 标签：html, css, layout

我的菜单项看起来像这样

```
<ul>
  <li>Item1<span class="context-trigger"></span></li>
  <li>Item2<span class="context-trigger"></span></li>
  <li>Item3<span class="context-trigger"></span></li>
</ul> 
```

使用 CSS 将上述内容变为水平菜单，使用 JS 将 [spans] 变为显示上下文菜单的按钮。大致是这样的：

```
项目1^ 项目2^ 项目3^

```

如果菜单对于浏览器宽度来说太宽，它会换行，这就是我想要的。问题是有时它会在 [spans] 之前插入换行符。我只希望它在 [li] 之间中断。有任何想法吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-04T15:31:29.780

尝试使用

```
white-space: nowrap; 
```

在上下文触发器类的 css 定义中。

编辑：我认为 patmortech 是正确的，但将 nowrap 放在 span 上不起作用，因为没有“空白”内容。也可能是在 LI 元素上粘贴样式也不起作用，因为浏览器可能会分解部分，因为 span 是 li 中的嵌套元素。您可能会重新考虑您的代码，删除 SPAN 元素并在 LI 元素上使用 css。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-04T15:54:48.720

您需要放置以下内容以防止列表项包装（将其放在上下文触发器类中只会防止跨度内容包装）：

```
li { white-space:nowrap; } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T16:02:43.633

如果你浮动`<li>`元素，你应该得到你想要的效果。

# windows - 为什么 Windows 64 选择要求保存/恢复 xmm6 和 xmm7？

> ID：262162
> 
> 赞同：8
> 
> 时间：2008-11-04T15:27:58.710
> 
> 标签：windows, win64, cpu-registers

为什么 Windows 64 选择要求保存/恢复 xmm6 和 xmm7？

在 Windows 32 中，您可以编写破坏 xmm0...xmm7 的汇编程序。但是如果你使用相同的汇编代码并在 Windows 64 中运行它，它通常会导致应用程序错误，因为 VS2007 将双精度值存储在 xmm6 和 xmm7 中。

在我看来，既然 X64 有 16 个 xmm 寄存器 xmm0...xmm15（而 X32 只有 8 个 xmm 寄存器），那么微软本可以选择允许用户破坏 xmm0..xmm7（这样他们就可以重用 Win32 中的汇编程序）无需考虑）但要求用户保存/恢复 xmm8...xmm15。

那么，为了满足我自己的好奇，为什么 Windows 64 选择要求保存/恢复 xmm6 和 xmm7？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T16:20:24.130

有趣的问题。我发现了这个：[Win64 Structured Exception Handling](http://www.tortall.net/projects/yasm/manual/html/objfmt-win64-exception.html)，它指出 XMM6 到 XMM15 必须保存/恢复，但没有说明*原因*。

Wikipedia 说[Microsoft x64 调用约定](http://en.wikipedia.org/wiki/X86_calling_conventions#Microsoft_x64_calling_convention)使用 XMM0 - XMM3，这意味着假设其他人被保留。同样，它没有说明原因。

# open-source - 为什么投票机不开源？

> ID：262182
> 
> 赞同：26
> 
> 时间：2008-11-04T15:29:44.713
> 
> 标签：open-source, voting

太好了……这只是某种编程相关的，但我想今天是选举日，对吧？是否有一个很好的理由为什么它们不是，不一定是任何人都可以贡献的开源，而是任何人都可以检查源代码的开源？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-11-04T16:01:04.730

投票机不是开源的，因为“电费”行业的说客成功地欺骗了没有资格做出技术选择的政客来购买他们的蛇油。这是通过结合反 FOSS FUD 和老式的~~贿赂~~活动捐款来实现的。

* * *

*更新：*我将尝试不时在此处发布链接，以显示供应商如何应对严格的检查。随意添加您自己的。（仅限 Pro-OSS：“人”可以自己发帖！）

*   [来自红杉的有趣电子邮件](http://freedom-to-tinker.com/blog/felten/interesting-email-sequoia "Ed Felten 的博客")

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-11-04T15:59:14.703

在比利时，投票机的源代码可以[免费下载](http://www.ibz.rrn.fgov.be/index.php?id=627&L=1)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-04T17:31:44.703

在此讨论的上下文中，您可能会发现这篇论文很有趣：

[无记名投票收据：真正的选民可核实的选举](http://courses.csail.mit.edu/6.897/spring04/Chaum-SecretBallotReceiptsTrueVoterVerifiableElections.pdf)

它由负责 DigiCash 的密码学家[David Chaum编写。](http://en.wikipedia.org/wiki/David_Chaum)从他在 Wikipedia 上的简历页面中，我还发现[了端到端可审计投票系统](http://en.wikipedia.org/wiki/End-to-end_auditable_voting_systems)。

*更新！*现在看来我们可以看看这是否真的有效：[First Test for Election Cryptography](http://www.technologyreview.com/web/23836/)。

现在回想起来，我已经阅读了几篇关于塔科马公园实验的文章，这个系统实际上似乎与原始论文中描述的不同。但是，它仍然是由 David Chaum 开发的，并且仍然支持端到端的审计属性。该系统称为 Scantegrity II。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-11-04T15:53:04.060

它们不是开源的原因是，正如 Kent 提到的那样，它无济于事。你可以开源代码。但是无法确保您使用的投票机实际上正在运行开源代码。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-04T16:12:34.440

在这种情况下，没有理由说开源代码优于封闭源代码。出于显而易见的原因，您的投票方式必须始终保密。唯一真正的保障是书面记录。

我在这些机器上工作过，如果愿意的话，我会编写恶意代码，在 10 次投票后以我想要的方式翻转选票，以击败在部署之前对机器进行的任何荒谬的逻辑和准确性测试（我们从未通过一次测试投票） .

随机选择一定比例的机器，并将纸质记录与电子计数进行比较。如果 Diebold 对其机器充满信心，那么他们会坚持认为这是任何选举的最后一步。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-04T19:56:31.010

[通过默默无闻的安全！](http://en.wikipedia.org/wiki/Security_through_obscurity)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-04T15:47:26.753

问题是开源软件将是无操作的。

他们没有任何像样的密码学，并且已经证明了并且相对简单的方法可以通过在投票亭中热交换 ROM 芯片或拥有一个增加唱片盒中记录的设备来违反它们。

*   [Youtube：红杉第 1 部分 有权访问的人可以使用已编程的 ROM 芯片进行黑客攻击](http://nz.youtube.com/watch?v=wzZRsXZ5Cz4&feature=related)
*   [Youtube：红杉第 2 部分逻辑和准确性测试与选举模式与投票窃取固件](http://nz.youtube.com/watch?v=aF3aRTXis2k&feature=related)
*   [Youtube：红杉第 5 部分从选区操纵红杉投票结果墨盒](http://nz.youtube.com/watch?v=3bZvqTKOtjI&feature=related)

* * *

> **@Mnementh**糟糕的密码学和交换 ROM 芯片的可能性与开源代码无关？那么有什么意义吗？

开源此代码只有 3 个合乎逻辑的原因：

1.  审查如何计算选票以确保其做对了。
2.  让某人能够根据自己的需要修改该代码。
3.  将软件放入公共领域，以便公共提交者可以改进它。

第 1 点和第 3 点在有用性和“证明你的投票数”方面被吹得一干二净，因为你无法保证你看到/改进的代码在这些设备上运行。

因此，只有条件 2 是有用的，因为您不会**拥有自己的投票机，并且除了邪恶的原因***或*简单地证明其脆弱性之外，不需要一台投票机。

在大多数情况下，这意味着将有更多关于*如何*违反这些机器的公开信息，因此您将不再需要物理访问以尝试对他们的软件进行逆向工程并开发受感染的 ROM 芯片以供使用在上述装置中，大大降低了投票系统妥协的准入门槛。

诚然，即使在非开源状态下，这些信息仍然可能泄漏，并且您只是有一种错误的安全感，因为您假设“没有泄漏，我很安全”，但相反，如果您将其开源，人们会假设“数百人看过源代码，我很安全”，这是一种同样糟糕的错误安全感。

人们正在寻找一种银弹安全的投票方式，可悲的是，没有。并非没有培养出一群纯洁的民族，他们由不置可否的僧侣在孤立主义的神殿中抚养长大，以拥有一群人，只是为了准确地见证和计算选票，他们被训练为不道德的，不能被贿赂切换投票。

（这有点像“黑暗天使”系列，除了投票代理人而不是刺客，我们都知道这个节目的结果，其中一个会变成胭脂，我们会相信他们，他们会搞砸我们全部 ）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-04T16:00:07.663

因为政客们购买它们。政客们得到的任何东西都会一团糟，因为 99% 的时间他们只有经验是在竞选公职，而不是做诸如充分审查硬件和软件之类的事情。

还有，回扣。

* * *

真相很伤人，不是吗？

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-04T16:03:12.807

没有特别的理由不开源投票机的软件（甚至开放硬件布局）。正如一些人试图声明的那样，它没有安全影响，因为如果关闭或开源，ROM 可以切换。机器需要某种验证器来检查加载的代码是否真的是经过认证的用于选举的代码。开源不会有任何区别。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-04T16:55:21.967

因为如果是这样，他们将无法将不准确的投票归咎于触摸屏上的[校准错误](http://blog.wired.com/27bstroke6/2008/10/video-recalibra.html)。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-04T17:28:55.520

*   负责的人有一个“默默无闻的安全”坏模因卡在某个地方
*   构建软件的人不想帮助竞争对手
*   构建软件的人害怕尴尬
*   立法过程中没有足够的人了解上述所有缺陷

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-10-10T00:30:54.603

到目前为止，大多数回复本质上都是技术性的，但**投票机很可能不是开源的，因为根据合同开发它们的公司没有动力将它们开源**。

如果一家公司开发了一个开源投票系统，那么后来任何人都会过来支持该系统。而且，老实说，我怀疑政府会接受相当于 SourceForge 项目的项目作为整个选举的基础。

也许应该有一个诚实的经纪人权威来监督开源投票系统的开发，并且该系统的贡献者应该在查看或提交源代码之前进行审查。

# networking - Sun Java Web 代理 - SSL 事务/秒？

> ID：262183
> 
> 赞同：0
> 
> 时间：2008-11-04T15:29:46.103
> 
> 标签：networking, monitoring, sun, webproxy

我希望这是“足够接近编程”以通过酒吧:)

有什么方法可以监控 Sun Webproxy 上的 SSL 事务/秒？最好使用 SNMP，但任何事情都会发生 :)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-20T18:38:39.377

SSL 交易是什么意思？代理除了连接请求外什么都看不到，其他一切都发生在加密隧道内。

连接请求记录在“访问”日志中，并显示为“CONNECTfully.qualified.domain.name:port”

# flash - 是否可以从命令行发布 FLA？

> ID：262192
> 
> 赞同：11
> 
> 时间：2008-11-04T15:31:06.270
> 
> 标签：flash, scripting, cs3, jsfl

在我们的项目中，我们有大量（数百个）由艺术家在 CS3 中创建的 FLA 文件，我们从中编译 SWF 以在我们的 Flex/AS3 应用程序中使用。

作为流线型构建/部署系统的一部分，能够自动发布所有这些 FLA 并在理想情况下部署 SWF 将非常方便。我找到了一些使用 JSFL 从 CS3 批量发布的方法，但惊讶地发现 CS3 显然没有任何命令行功能？

这是在 Linux 系统上物有所值的，我没有使用 JSFL 的经验，不知道您是否可以以某种方式从命令行运行脚本？

**注意**：我应该说“首选 Linux”...我不使用 Linux，但我们的服务器/构建 PC 是 Linux...我没有意识到 CS3 不兼容所以我想我们可以在 Windows 上完成这部分.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-28T16:27:14.167

从命令行执行 JSFL 脚本，如下所示：

在 Windows 上：`"c:\program files\macromedia\flash 8\flash.exe" myscript.jsfl`

在 Mac 上：`open myscript.jsfl`

我相信旧版本的 Flash 在 Wine 上运行没有问题，但对于 CS3 则不确定。

要遍历一批本地文件，请尝试以下操作（在 JSFL 中）：

```
var importFolder = fl.browseForFolderURL('Select a folder with existing FLA files');
var importFolderContents = FLfile.listFolder(importFolder);
for (i = 0; i <importFolderContents.length; i++) {
    file = importFolderContents[i];
    fl.openDocument(file); // and so on
} 
```

您可能想要调查的其他一些方法是..

[fl.getDocumentDOM()](http://livedocs.adobe.com/flash/8/main/00004635.html) [document.exportSWF()](http://livedocs.adobe.com/flash/9.0/main/00003933.html) [document.publish()](http://livedocs.adobe.com/flash/9.0/main/00003968.html) [fl.closeDocument()](http://livedocs.adobe.com/flash/9.0/main/00004130.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-04T16:01:04.933

你是如何在 Linux 上运行 Flash CS3 的？您不能从命令行运行 JSFL，但应该可以编译 FLA 文件

一些老例子 [http://www.mikechambers.com/blog/2003/11/01/flashcommand-flash-2004-command-line-compiler/](http://www.mikechambers.com/blog/2003/11/01/flashcommand-flash-2004-command-line-compiler/)

Mike Chambers 的更新内容 [http://code.google.com/p/flashcommand/](http://code.google.com/p/flashcommand/)用于 OSX

所以这绝对是可能的，似乎只能通过半自动化的 IDE 发布，

太糟糕了 Flex 编译器不具备这样的能力，再加上 ANT 任务，它是一个杀手……使用 FDT 编辑器，事情非常酷且自动化

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-09-07T20:02:02.623

就像已经说过的那样，可以使用 JSFL 脚本，尽管您仍然需要具有与 Adob​​e Flash Professional 通信的命令行工具，以将进程记录到标准输出并根据编译结果提供退出代码。

我最终自己编写了这个工具[https://www.npmjs.com/package/flc](https://www.npmjs.com/package/flc)。它基本上是一个将 Adob​​e Flash Professional 抽象出来的命令行界面。针对 Flash Pro 2014 和 2015 进行了测试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-07T21:12:59.477

是的，一点没错。事实上，我已经构建了一个端到端的解决方案，只需单击一个按钮，就会使用版本时间戳更新类文件，如果 Flash 尚未打开，则打开它，打开单个文件进行发布，发出信号当每个文件完成发布时，通过进程间通信实现自动化程序，这样您就不会遇到任何时间问题，并在完成后将特定文件部署到网络（在自动备份它们并为文件名加上时间戳之后），以及整个过程在 10 秒内完成。

在此处查看我的问答：[自动发布 FLA 文件；多次调用 Process.Start](https://stackoverflow.com/q/23525495/88409)

# c++ - 如果实数可以用双精度表示，我如何编写返回 true 的 C++ 函数？

> ID：262201
> 
> 赞同：5
> 
> 时间：2008-11-04T15:50:48.417
> 
> 标签：c++, floating-point

如果实数可以用双精度表示，我如何编写返回 true 的 C++ 函数？

```
bool isRepresentable( const char* realNumber )
{
   bool answer = false;
   // what goes here?
   return answer;
} 
```

简单测试：

```
assert( true==isRepresentable( "0.5" ) );
assert( false==isRepresentable( "0.1" ) ); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-04T16:17:42.263

神圣的功课，蝙蝠侠！:)

有趣的是，您不能简单地执行 (atof|strtod|sscanf) -> sprintf 循环并检查是否恢复了原始字符串。例如，许多平台上的 sprintf 检测到“尽可能接近 0.1”双精度并将其打印为 0.1，即使 0.1 不能精确表示。

```
#include <stdio.h>

int main() {
    printf("%llx = %f\n",0.1,0.1);
} 
```

打印：3fb999999999999a = 0.100000

在我的系统上。

真正的答案可能需要解析双精度以将其转换为精确的小数表示（0.1 = 1/10），然后确保 atof 转换乘以分母等于分子。

我认为。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-04T18:18:53.157

将数字解析为 a + N / (10^k) 的形式，其中 a 和 N 是整数，k 是小数位数。

示例：12.0345 -> 12 + 345 / 10^4，a = 12，N = 345，k = 4

现在，10^k = (2 * 5) ^ k = 2^k * 5^k

当且仅当您去掉分母中的 5^k 项时，您才能将您的数字表示为精确的二进制分数。

结果将检查 (N mod 5^k) == 0

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-04T16:11:32.273

这是我的版本。sprintf 将 0.5 转换为 0.50000，最后的零必须被删除。

编辑：必须重写以正确处理以 0 结尾的不带小数点的数字（如 12300）。

```
bool isRepresentable( const char* realNumber )
{
   布尔答案=假；

   双 dVar = atof(realNumber);
   字符检查[20]；
   sprintf（检查，“%f”，dVar）；

   // 删除末尾的零 - TODO：仅当字符串中有小数点时才执行
   for (int i = strlen(check) - 1; i >= 0; i--) {
     if (check[i] != '0') 中断；
     检查[i] = 0;
   }

   答案 = (strcmp(realNumber, check) == 0);

   返回答案；
}

```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T16:02:51.933

这应该可以解决问题：

```
bool isRepresentable(const char *realNumber)
{
    double value = strtod(realNumber, NULL);

    char test[20];
    sprintf(test, "%f", value);

    return strcmp(realNumber, test) == 0;
} 
```

可能最好使用 sprintf 的“安全”版本来防止潜在的缓冲区溢出（在这种情况下甚至可能吗？）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T16:03:32.103

我将字符串转换为其数字位表示（位数组或长整数），然后将字符串转换为双精度并查看它们是否匹配。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-11-04T16:01:48.270

将字符串转换为范围大于双精度的浮点数。将其转换为双倍，看看它们是否匹配。

# c++ - std::streams 已经可以移动了吗？

> ID：262211
> 
> 赞同：3
> 
> 时间：2008-11-04T15:55:26.830
> 
> 标签：c++, gcc, stream, c++11, rvalue

GNU gcc 4.3 部分支持即将到来的 c++0x 标准：在实现的功能中，右值引用。通过右值引用，应该可以移动不可复制的对象或从函数中返回它。

std::streams 是否已经**可以通过右值引用**移动，或者当前的库实现是否缺少某些东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T18:43:13.700

在当前的 g++ svn 中，还没有将右值引用支持添加到流中。我怀疑添加它不会太难，并且与开源软件一样，我敢肯定，补丁是受欢迎的！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T21:03:12.293

经过快速调查，发现**右值引用**支持尚未添加到流中。

要从函数中返回不可复制的对象，实际上只需实现*移动构造函数*，如下所示：

```
struct noncopyable
{
    noncopyable()
    {}

    // move constructor
    noncopyable(noncopyable &&)
    {}

private:
    noncopyable(const noncopyable &);
    noncopyable &operator=(const noncopyable &);
}; 
```

这样的构造函数应该将所有权转移给新对象，使传递的对象处于默认状态。

也就是说，可以通过以下方式从函数返回对象：

```
noncopyable factory()
{
    noncopyable abc;
    return std::move(abc);
} 
```

虽然 std::stream 不支持移动构造函数，但 gcc 4.3.2 附带的 STL 容器似乎已经支持它。

# apache - mod_rewrite 是使用 Apache 缓存动态页面的有效选项吗？

> ID：262215
> 
> 赞同：0
> 
> 时间：2008-11-04T15:56:49.107
> 
> 标签：apache, mod-rewrite, caching

我已经阅读了一种涉及将渲染的动态页面写入磁盘并在它存在时使用 mod_rewrite 的技术。我正在考虑使用 cron 作业每 X 分钟清除一次缓存版本。

我想知道这是否是一个可行的选择，或者是否有我不知道的更好的选择。

（请注意，我在共享机器上，并且 mod_cache 不是一个选项。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T16:23:34.043

您可以使用您的 cron 作业来运行脚本并将输出重定向到文件。

如果你有一个 php 文件 index.php，你所要做的就是运行

`php index.php > (location of static file)`

你只需要确保你的脚本在命令行上运行的和 apache 提供的一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T14:53:19.653

我会在应用程序级别使用缓存。因为应用程序最清楚缓存版本何时过期，并且在缓存协商方面更加灵活和强大。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-02T14:46:23.790

页面是否需要经常被垃圾，因为它只是不得不这样做？还是应该在页面更新后与静态版本并行？

如果是后者，您可以尝试编写一个脚本来复制刚刚编辑的页面并将其保存到其静态文件名版本。这应该会减轻写入负载，因为在这种情况下，您不需要拥有新的静态副本，除非进行了需要一些展示时间的更改。

# ruby-on-rails - 内容投票数据库和应用程序设计

> ID：262217
> 
> 赞同：2
> 
> 时间：2008-11-04T15:57:51.413
> 
> 标签：ruby-on-rails, ruby, database, vote

您将如何设计一种可以多态地应用于多个模型/类的内容投票机制。（最好在 ruby​​ on rails 上下文中，但其他都很好）

鉴于可以对这些类的实例进行投票： - 文章 - 问题 - 产品

不应要求选民登记。

应尽最大努力将选民限制为每个对象一票。（对特定文章投一票，对特定问题投一票，等等）。即使用ip检测、cookies等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T16:04:16.517

我建议从“可投票”接口的单表继承开始，并从那里派生任何可投票类。STI 的起始细节：[http ://wiki.rubyonrails.org/rails/pages/singletableinheritance](http://wiki.rubyonrails.org/rails/pages/singletableinheritance)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T14:26:02.923

你说的是多态——这是关键词。

看看 ActsAsTaggable 是如何工作的。您可以创建一个 ActsAsVotable “插件”，为特定模型提供投票行为。投票将存储在另一个模型（投票？）中，该模型将具有多态的 belongs_to。

```
create_table :orders do |t|
  t.string :votable_type
  t.integer :votable_id
  t.integer :vote
  t.timestamps
end 
```

您的`acts_as_votable`电话将在幕后将其与其投票相关联：

```
has_many :votes, :as => "votable" 
```

再次，请参阅 ActsAsTaggable。:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T14:26:19.913

谢谢你们的答案。是的，创建一个多态可投票模型是要走的路，但是我试图提取一个更完整的答案。

例如，这是我到目前为止的想法。在这种情况下，可以与多个类（文章、问题、产品）绑定的可投票类。

投票表：id:integer、vote:boolean、voteable_type:string（被投票的类的名称）、voteable_id:integer（被投票的类的id）、voter_id（用户投票的标识符）。

现在我们仍然需要尝试将投票限制为每个用户一个，而不需要某种注册。所以 voter_id 可以是一个包含用户 IP 地址和 user_agent 的组合。这是我对想法持开放态度的地方。如果捕获的 IP 地址来自公司代理等，则它们不一定是唯一的，因此结合用户代理应该有所帮助。但是，您仍然会遇到两个用户可以拥有相同 IP 和用户代理字符串的情况。此外，如果他们的浏览器未在请求标头中发送此信息，您可能并不总是能够获得此信息，这意味着某些用户根本无法投票……此外，IP 可能会被欺骗。

另一种可能性是使用 cookie，但我认为这会引起用户的滥用，他们希望通过清除 cookie 或脚本命中来提高对特定内容的投票率。在此处检查用户代理也应该有所帮助，但是您可以通过脚本轻松地伪造用户代理。

可能没有完美的解决方案，但我很好奇其他人是如何解决这个问题的。即黑客新闻甚至stackoverflow。

# windows-mobile - Windows Mobile 6 AT 命令

> ID：262219
> 
> 赞同：1
> 
> 时间：2008-11-04T15:59:13.937
> 
> 标签：windows-mobile, modem, at-command

我正在尝试使用 AT 命令获取 CellID，但我没有从调制解调器得到任何响应，我的代码如下所示，我发送 AT+CCED 命令，但从未得到任何响应。

```
HANDLE hCom;
char * xpos;
char rsltstr[5];
DWORD returnValue;
DWORD LAC;
DWORD CellId;
int bufpos;
DCB dcb;
COMMTIMEOUTS to;
DWORD nWritten;
DWORD event;
DWORD nRead;
char outbuf[20], buf[256];

hCom = CreateFile(L"\\\.\\COM9:",GENERIC_READ|GENERIC_WRITE,0,0,OPEN_EXISTING,0,0);
if (hCom==NULL || hCom==INVALID_HANDLE_VALUE)
{
    TCHAR szBuf[80];
    DWORD dw = GetLastError();

    // get the most uptodate cells
    _stprintf(szBuf, TEXT("CreateFile failed with error %d."), dw);

    MessageBox(0, szBuf, TEXT("Error"), MB_OK);

    hCom= NULL;
    return -1;
}

if (!GetCommState(hCom, &dcb))
{
    return -2;
}

dcb.BaudRate= CBR_115200;
dcb.ByteSize= 8;
dcb.fParity= false;
dcb.StopBits= ONESTOPBIT;

if (!SetCommState(hCom, &dcb))
{
    return -3;
}

if (!EscapeCommFunction(hCom, SETDTR))
{
    return -4;
}

if (!GetCommTimeouts(hCom, &to))
{
    return -6;
}
to.ReadIntervalTimeout= 0;
to.ReadTotalTimeoutConstant= 200;
to.ReadTotalTimeoutMultiplier= 0;
to.WriteTotalTimeoutConstant= 20000;
to.WriteTotalTimeoutMultiplier= 0;
if (!SetCommTimeouts(hCom, &to))
{
    return -7;
}

if (!SetCommMask(hCom, EV_RXCHAR))
{
    return -8;
}   

bufpos = 0;

strcpy(outbuf,"AT+CCED=0,5\r"); 

if (!WriteFile(hCom, outbuf, strlen(outbuf), &nWritten, NULL))
{
    return -10;
}

if (nWritten != strlen(outbuf))
{
    return -11;
}

if (!WaitCommEvent(hCom, &event, NULL))
{
    return -12;
}

while(1)
{
    if (!ReadFile(hCom, buf+bufpos, 256 - bufpos, &nRead, NULL))
    {
        return -13;
    }

    if (nRead == 0) // <---- it alweys break here
        break;

    bufpos += nRead;

    if (bufpos >= 256)
        break;

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-21T17:01:03.643

首先，尝试**L"COM9:"**作为 CreateFile 的第一个参数。

查看此页面：[设备文件名](http://msdn.microsoft.com/en-us/library/aa930218.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-08T01:31:47.153

我对使用 AT 命令获取单元 id 一无所知，但您可以使用 RIL 接口获取单元 id。它可能比使用 AT 命令更简单（除非您尝试远程获取它？）

[http://msdn.microsoft.com/en-us/library/ms890075.aspx](http://msdn.microsoft.com/en-us/library/ms890075.aspx)

您使用 RIL_GetCellTowerInfo 函数来获取当前的手机信号塔 ID。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-12T13:55:41.827

我的问题是，在某些设备上，RIL iterface 方法返回 E_NOTIMPL 并且没有任何作用，所以我坚持认为我可以使用 AT 命令直接与移动调制解调器通话。

有没有人有解决这个问题的方法，我已经和它打了一个多星期了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-18T17:19:29.937

显然我不允许发表评论.. 所以：@Sebastian：我在 HTC Diamond + HTC Touch Pro + ATT Fuze 的 2 个型号上运行 Ril_GetCellTowerInfo。它适用于所有 4 部手机。如果您需要更多帮助，我很乐意分享一些工作代码（在 VB.NET 中）。

# xml - 带有动态标题的网页

> ID：262231
> 
> 赞同：3
> 
> 时间：2008-11-04T16:02:26.020
> 
> 标签：xml, xslt, header

我有一个带有动态列表的网页。我希望标题是可配置的。首先，标题被命名为`column1`, `column2`, ... `columnnN`。单击这些标题中的任何一个，我会打开一个 DHTML 模式窗口，在该窗口中我从预定义的列表中选择标题名称，以便我可以将此标题名称分配给选定的列。所以我从我的模式窗口返回一个唯一的 ID 到我的父窗体。现在我想将标题更改为选定的标题。

我的 XML：

```
<ROOT>
    <Header><Item>Column 1</Item></Header>
    <Header><Item>Column 2</Item></Header>

    <ROW>
        <COlUMN>Zamora</COlUMN>
        <COlUMN> Ruby E.</COlUMN>
    </ROW>
    <ROW>
        <COlUMN>Hatfield</COlUMN>
        <COlUMN> Hanae B.</COlUMN>
    </ROW>
</ROOT> 
```

这是我在代码隐藏中生成 XML 的方式：

```
oXMLString.Append(Chr(13) & "<Header>")
oXMLString.Append(Chr(13) & "<Item>Column " & j + 1 & "</Item>")
oXMLString.Append(Chr(13) & "</Header>") 
```

这是我的标题的xslt：

```
<tr class="thead">
    <xsl:for-each select="Header/Item">        
        <td class="rowHead" style="vertical-align:bottom;">
            <a href="#">
                <xsl:attribute name="id">
                    <xsl:value-of select="@id"/>
                </xsl:attribute>
                <xsl:attribute name="onclick">
                    <xsl:text>showPopWin('UploadFile_Step4_Modal.aspx',500,500,returnFieldID);</xsl:text>
                </xsl:attribute>
                <xsl:value-of select="." />
            </a>
        </td>
    </xsl:for-each>
</tr> 
```

生成列表时，列标题是`column1`并且`column2`n=2

在 xslt`onclick`事件中打开一个模式窗口，它`fieldID`为列标题返回一个。

现在假设我点击`column1`并返回数据库中预定义的模式窗口`fieldid="1"`，我如何将列标题从更改 `column1`为`Firstname`（`Fieldid=1`是`Firstname`）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-28T07:25:20.510

您不需要 xslt 来解决您的问题。您只需要一些 JavaScript。这是 jQuery 中的示例代码：

```
$('td.rowHead a').click(function(){
    var fieldId, fieldName;
    fieldId = // get field id from the popup
    fieldName = // get field name (e.g. via AJAX)
    this.innerHTML = fieldName;
}); 
```

# c++ - 并发数据结构设计

> ID：262232
> 
> 赞同：14
> 
> 时间：2008-11-04T16:02:26.553
> 
> 标签：c++, data-structures, concurrency

我正在尝试提出用于高吞吐量 C++ 服务器的最佳数据结构。该数据结构将用于存储从几到几百万个对象的任何内容，并且不需要排序（尽管可以非常便宜地提供唯一的排序键）。

要求是它可以支持高效的插入，理想情况下为 O(1)，中等效率的移除和高效的遍历。它不需要支持查找操作（除了可能需要删除）。

扭曲是它必须是线程安全的，而其他线程正在枚举数据结构。这意味着简单的红黑树不起作用，因为一个线程无法插入元素（并执行必要的树旋转）而不会弄乱其他线程持有的任何游标。

使用读/写锁并将写操作推迟到所有读者都完成是**不可接受的，因为读操作可能会长期存在。**有读者时发生的插入是否对该读者可见并不重要。

内存占用也很重要，当然越小越好！

有什么建议？

**回复评论：**

感谢您的回答。

不，插入不能使现有的迭代器无效。迭代器可能会或可能不会看到新的插入，但他们必须看到如果插入没有发生，他们会看到的所有内容。

需要删除，但是由于更高级别的规则，我可以保证迭代器永远不会在可删除的项目上停止。

为游标锁定每个节点会对性能产生太大影响。可能有多个线程同时读取，并且多个线程在锁中使用的任何类型的内存热点都会杀死内存带宽（正如我们发现的那样困难！）。即使是具有多个调用 InterlockedIncrement 的线程的读取器的简单计数也无法干净地扩展。

我同意链接列表可能是最好的方法。删除很少见，因此为支持 O(1) 删除的反向指针支付内存代价是昂贵的，我们可以根据需要单独计算这些，因为删除往往是批处理操作。

幸运的是，插入到链表中不需要对读取器进行任何锁定，只要在更改头指针之前在插入的节点中更新指针即可。

锁定-复制-解锁的想法很有趣。所涉及的数据量太大，无法将其用作读取器的默认设置，但是当写入器与读取器发生冲突时，它可以用于写入器。读/写锁将保护整个结构，如果与读取器发生冲突，写入将克隆数据结构。写入比读取少得多。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-04T17:45:14.067

就个人而言，我非常喜欢在高度并发的情况下持久不变的数据结构。我不知道有什么专门针对 C++ 的，但是 Rich Hickey 在 Java 中为[Clojure](http://clojure.org)创建了一些出色的（而且速度极快）不可变数据结构。具体来说：vector、hashtable和hashset。它们并不难移植，因此您可能需要考虑其中之一。

更详细地说，持久的不可变数据结构确实解决了很多与并发相关的问题。因为数据结构本身是不可变的，所以多个线程同时读取/迭代没有问题（只要它是一个 const 迭代器）。“写入”也可以是异步的，因为它并不是真正写入现有结构，而是创建包含新元素的结构的新版本。由于您实际上并没有复制所有内容，因此该操作变得高效（在所有 Hickey 结构中为*O(1)） 。*每个新版本都与旧版本共享大部分结构。这使事情的内存效率更高，并且比简单的写时复制技术显着提高了性能。

对于不可变数据结构，您真正需要同步的唯一时间是实际写入参考单元格。由于内存访问是原子的，即使这样通常也可以是无锁的。唯一需要注意的是，您可能会在线程之间丢失数据（竞争条件）。数据结构永远不会因并发而损坏，但这并不意味着在两个线程基于单个旧线程创建结构的新版本并尝试写入其结果（其中一个线程将“赢”，其他人的更改将丢失）。要解决这个问题，你要么需要一个“写操作”的锁，要么使用某种[STM](http://en.wikipedia.org/wiki/Software_transactional_memory). 我喜欢在低冲突系统中实现易用性和吞吐量的第二种方法（理想情况下，写入是非阻塞的，读取*永远不会*阻塞），但任何一种都可以。

你问了一个棘手的问题，这个问题并没有很好的答案。并发安全的数据结构很难编写，尤其是当它们需要可变时。在存在共享状态的情况下，完全无锁的架构被证明是不可能的，因此您可能希望放弃该要求。您能做的最好的事情就是尽量减少所需的锁定，从而减少不可变的数据结构。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-04T17:16:21.490

链表绝对是这里的答案。O(1) 中的插入和删除，O(1) 中从一个节点到下一个节点的迭代以及跨操作的稳定性。`std::list`保证所有这些，包括所有迭代器都是有效的，除非从列表中删除元素（这包括指针和对元素的引用）。对于锁定，您可以将列表包装在锁定类中，或者您可以编写自己的列表类（您将无法使用`std::list`在这种情况下，它支持基于节点的锁定——例如，您可以锁定列表的某些区域以供使用，而其他线程在不同区域执行操作。您使用哪个在很大程度上取决于您期望的并发访问类型 - 如果列表不同部分的多个操作真的很常见，请编写您自己的，但请记住您将在每个节点中放置一个互斥对象，这不是节省空间。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-04T17:58:02.573

为双重答案道歉...

由于写入相当罕见，因此您*确实*应该考虑使用 STM 而不是锁定。STM 是一种乐观锁定形式，这意味着它在性能上严重偏向无冲突系统（也就是更少的写入）。相比之下，悲观锁定（lock-write-unlock）针对冲突严重的系统（也就是大量写入）进行了优化。STM 的唯一问题是它几乎要求您在 TVar 单元中使用不可变的数据结构，否则整个系统就会崩溃。就个人而言，我不认为这是一个问题，因为体面的不可变数据结构将与可变数据结构一样快（请参阅我的另一个答案），但值得考虑。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-04T16:18:49.560

我认为链表应该可以满足您的要求。请注意，您只能锁定正在更改（即删除/附加）的节点，因此大部分时间读者将能够与作者完全并行工作。这种方法需要每个链表节点锁定，但这不是必须的。您可以拥有有限数量的锁，然后几个节点将映射到同一个锁。即，拥有 N 个锁和编号为 0..M 的节点的数组，您可以使用锁 (NodeId % N) 来锁定该节点。这些可以是读写锁，通过控制锁的数量，您可以控制并行度。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-04T16:48:22.857

如果您不需要排序顺序，请不要使用红/黑树或其他任何固有排序的东西。

你的问题没有很好地说明读写之间的交互。如果通过锁定+复制+解锁实现“读取”然后使用新副本可以吗？

您可能想在[http://en.wikipedia.org/wiki/Seqlock](http://en.wikipedia.org/wiki/Seqlock)中阅读有关 seqlock 的信息，以及一般的“无锁”流程——不过，您可能希望尽可能放宽您的要求——锁-free 哈希表实现是一项重大任务。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-04T17:59:10.623

您有 3 种类型的任务：

1.  迭代（慢）
2.  插入（快速）
3.  删除（快速）

如果接近一致性足够好，则跟踪活动迭代任务的数量。

如果迭代任务处于活动状态并且新的插入或删除任务进入队列，这些任务供以后处理（但您可以立即将其返回给调用者）

如果完成进程排队插入和删除，则只要最后一次迭代。

如果在插入或删除待处理时出现迭代请求，则将其排队。

如果一个迭代请求进来，而只有迭代正在运行，那就让它去迭代。

您仍然应该通过制作您正在迭代的数据的副本来尽可能快地编写迭代，然后如果实际数据处理比迭代本身花费更多时间，则在客户端中处理该数据。

我会用哈希表或 stl:map 实现主集合，甚至可能足够快。插入/删除请求可以在列表中排队。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-03T10:38:46.750

我认为这是可以实现的唯一方法是通过类似于 oracle/postgresql 等数据库中使用的多版本并发协议的东西。这保证了读者不会阻塞读者，作家不会阻塞读者，但作家只会阻止那些作家更新同一条数据。写入者阻止更新相同数据的写入者的这种属性在并发编程世界中很重要，否则数据/系统不一致是可能的。对于数据结构的每一个写操作，在执行写操作之前，您都会对数据结构进行快照，或者至少将受写操作影响的部分数据结构节点复制到内存中的不同位置。因此，当写入正在进行时，读取器线程请求从写入器部分读取部分数据，您总是参考最新的快照并迭代该快照，从而为所有读者提供一致的数据视图。快照的成本很高，因为它们消耗更多内存，但是对于您的给定要求，这种技术是正确的选择。是的，使用锁（互斥锁/信号量/自旋锁）来保护写操作免受其他需要更新同一条数据的写入器线程/进程的影响。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-11-05T05:14:19.450

我不确定是否有人提到过这一点，但我会从 Java 的 ConcurrentHashMap 中获得灵感。它提供遍历、检索和插入，无需锁定或等待。一旦您找到与哈希键对应的数据桶并且您正在遍历该桶（即您只锁定桶而不是实际的哈希映射），就会发生唯一的锁定。“ConcurrentHashMap 不是使用单个集合锁，而是使用固定的锁池，在桶集合上形成分区。”

[您可以在此处](http://www.ibm.com/developerworks/java/library/j-jtp08223/)找到有关实际实施的更多详细信息。我相信实现中显示的所有内容都可以使用 C++ 轻松完成。

因此，让我们浏览一下您的要求列表：

```
1\. High throughput. CHECK
2\. Thread safe. CHECK
3\. Efficient inserts happen in O(1). CHECK
4\. Efficient removal (with no data races or locks). CHECK
5\. VERY efficient traversal. CHECK
6\. Does not lock or wait. CHECK
7\. Easy on the memory. CHECK
8\. It is scalable (just increase the lock pool). CHECK 
```

以下是地图条目的示例：

```
protected static class Entry implements Map.Entry {
    protected final Object key;
    protected volatile Object value;
    protected final int hash;
    protected final Entry next;
    ...
} 
```

请注意，该值是易变的，因此当我们删除一个条目时，我们将值设置为 NULL，这对任何其他尝试读取该值的线程都是自动可见的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-04T16:19:10.760

好吧，为了线程安全，您将不得不在某个时候锁定某些东西。一个关键的事情是确保您的存储库中的对象可以与存储库结构本身分开锁定：即在您存储的数据中没有_next 链接或任何类似的东西。这种方式读取操作可以锁定对象的内容，而不锁定存储库的结构。

高效的插入很容易：链表、未排序的数组、哈希表都可以正常工作。有效的删除更难，因为这涉及在存储库中查找已删除的内容。然而，为了原始的简单性和速度，链表是一个不错的选择。可以在非忙碌时间和仅标记为“非活动”的项目中推迟删除吗？那么查找/删除的成本就不那么有限了。

但是，您仍然会遇到遍历问题。您所能做的就是锁定并拍摄需要遍历的内容的快照，然后在查看快照后检查是否有任何更改。棘手的问题...

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-09-22T20:14:12.753

FWIW，如果您有垃圾收集器，这很容易解决。例如，在 F# 中，您可以只使用对链表或纯函数映射（平衡二叉树）的可变引用，而无需任何锁。这是有效的，因为数据结构是不可变的，并且写入引用（在写入后更新）是原子的，因此并发读者可以保证看到旧的或新的数据结构，但不会损坏。如果您有多个作家，那么您可以将它们序列化。

然而，这在 C++ 中更难解决......

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2014-08-22T18:13:16.160

我参加聚会有点晚了。但是，如果有人仍在寻找解决此问题的实用解决方案，并且他们还没有决定使用服务器，那么我建议使用[Google 的 App Engine](https://developers.google.com/appengine/)。他们的数据存储针对这些类型的要求进行了优化。

# ruby - 将电子邮件组织成线程的算法？

> ID：262234
> 
> 赞同：10
> 
> 时间：2008-11-04T16:02:41.403
> 
> 标签：ruby, email, email-threading

是否有任何命名/著名/特别好的算法可以将电子邮件消息组织成线程？

我希望在我的网站上添加类似于 Google 群组（和其他邮件列表）的功能，我只是想知道是否有任何已发布的算法用于此类组织。我知道推出自己的算法可能相当容易，但在用户体验上，可以通过的算法和好的算法之间可能存在很大差异。

已经在 ruby​​ 中实现的算法的奖励积分！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-04T16:19:46.470

[jwz_threading](http://github.com/fdietz/jwz_threading)看起来正是您所要求的。我没用过。

# mysql - 对所有基于文本的字段使用通用 varchar(255) 是否有缺点？

> ID：262238
> 
> 赞同：102
> 
> 时间：2008-11-04T16:03:14.693
> 
> 标签：mysql, sql

我有一个`contacts`表，其中包含诸如`postcode`, `first name`, `last name`, `town`,等字段`country`，`phone number`所有这些字段都被定义为`VARCHAR(255)`即使这些字段中没有一个字段接近 255 个字符。（如果您想知道，之所以这样，是因为 Ruby on Rails 迁移`VARCHAR(255)`默认将 String 字段映射到，而我从不费心去覆盖它）。

由于 VARCHAR 将仅存储字段的实际字符数（以及字段长度），因此使用 VARCHAR 是否有任何明显的优势（性能或其他方面`VARCHAR(16)`）`VARCHAR(255)`？

此外，这些字段中的大多数都有索引。字段上较大的 VARCHAR 大小是否会影响索引的大小或性能？

仅供参考，我正在使用 MySQL 5。

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2008-11-04T16:56:03.107

在存储中，`VARCHAR(255)`它足够聪明，可以只存储给定行所需的长度，而不像`CHAR(255)`总是存储 255 个字符。

但是由于您使用 MySQL 标记了这个问题，我将提到一个 MySQL 特定的提示：当行从存储引擎层复制到 SQL 层时，`VARCHAR`字段被转换为`CHAR`以获得使用固定宽度行的优势。因此，内存中的字符串被填充到声明列**的最大长度。**`VARCHAR`

当您的查询隐式生成临时表时，例如在排序时或`GROUP BY`时，这可能会使用大量内存。如果您将大量`VARCHAR(255)`字段用于不需要那么长的数据，这会使临时表变得非常大。

您可能还想知道，这种“填充”行为意味着使用 utf8 字符集声明的字符串每个字符填充三个字节，即使对于您使用单字节内容存储的字符串（例如 ascii 或 latin1 字符）也是如此。同样 utf8mb4 字符集会导致字符串在内存中每个字符填充四个字节。

因此，`VARCHAR(255)`在 utf8 中存储一个像“No opinion”这样的短字符串在磁盘上占用 11 个字节（十个低字符集字符，加上一个字节作为长度），但它在内存中占用 765 个字节，因此在临时表或排序结果中占用了 765 个字节。

我曾帮助 MySQL 用户在不知不觉中频繁创建 1.5GB 临时表并填满磁盘空间。他们有很多`VARCHAR(255)`列，实际上存储了非常短的字符串。

最好根据您要存储的数据类型来定义列。正如其他人所提到的，它具有强制执行与应用程序相关的约束的好处。但它有物理上的好处，可以避免我上面描述的内存浪费。

当然，很难知道最长的邮政地址是多少，这就是为什么许多人选择`VARCHAR`肯定比任何地址都长的长地址。并且 255 是习惯性的，因为它是 a 的最大长度，`VARCHAR`其长度可以用一个字节编码。它也是`VARCHAR`MySQL 5.0 之前的最大长度。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-08-11T19:46:15.903

除了设置 varchar 大小的大小和性能考虑（可能更重要，因为存储和处理每秒都变得更便宜），“仅仅因为”使用 varchar(255) 的缺点是降低了*数据完整性*。

为字符串定义最大限制是**一件好事，**可以防止比预期更长的字符串进入 RDBMS 并在稍后从数据库中检索和解析比预期更长（更多字节）的值时导致缓冲区溢出或异常/错误。

例如，如果您有一个接受两个字符串作为国家/地区缩写的字段，那么您没有任何理由期望您的用户（在这种情况下，程序员）输入完整的国家/地区名称。由于您不希望他们输入“安提瓜和巴布达”（AG）或“赫德岛和麦克唐纳群岛”（HM），因此您不允许在数据库层输入。此外，很可能一些程序员还没有 RTFMed 设计文档（*肯定存在*）知道不这样做。

将字段设置为接受两个字符并让 RDBMS 处理它（通过截断优雅地或通过错误拒绝其 SQL 来不优雅地处理）。

没有理由超过一定长度的真实数据示例：

*   [加拿大邮政编码](http://en.wikipedia.org/wiki/Canadian_postal_code)的格式为 A1A1A1，长度始终为 6 个字符，*即使对于圣诞老人也是如此*（6 个字符不包括为便于阅读而指定的空格）。
*   [电子邮件地址](https://www.rfc-editor.org/rfc/rfc5322)- @ 之前最多 64 个字节，之后最多 255 个字节。再也不要了，以免破坏互联网。
*   北美电话号码从不超过 10 位数字（不包括国家代码）。
*   运行 Windows（最新版本）的计算机的[计算机名称不能超过 63 字节](http://technet.microsoft.com/en-us/library/cc757496(WS.10).aspx)，但建议不要超过 15 个字节，这会破坏您的 Windows NT 服务器场。
*   州缩写是 2 个字符（如上面示例的国家代码）
*   [UPS 追踪号码](http://www.ups.com/content/us/en/tracking/help/tracking/tnh.html)的长度为 18、12、11 或 9 个字符。18个字符的数字以“1Z”开头，11个字符的数字以“T”开头，这让您想知道如果他们不知道字母和数字之间的区别，他们如何交付所有这些包裹。

等等...

花时间考虑您的数据及其限制。毕竟，如果您是架构师、开发人员或程序员，那是您的*工作。*

**通过使用 varchar(n) 而不是 varchar(255)，您消除了用户（最终用户、程序员、其他程序）输入意外长数据的问题，这些数据*将*在以后困扰您的代码。**

我并没有说你不应该在你的应用程序使用的业务逻辑代码中实现这个限制。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-11-04T16:27:09.467

我和你在一起。对细节的挑剔关注是一件令人头疼的事情，而且价值有限。

曾几何时，磁盘是一种珍贵的商品，我们曾经费尽心思优化它。存储价格下降了 1,000 倍，使得压缩每个字节所花费的时间变得不那么有价值。

如果仅使用 CHAR 字段，则可以获得固定长度的行。如果您为字段选择了准确的大小，这可以节省一些磁盘空间。您可能会获得更密集的数据（用于表扫描的 I/O 更少）和更快的更新（更容易找到块中的开放空间以进行更新和插入。）

但是，如果您高估了您的大小，或者您的实际数据大小是可变的，那么您最终会浪费 CHAR 字段的空间。数据最终会变得不那么密集（导致更多的 I/O 用于大检索）。

通常，尝试为变量字段设置大小的性能优势很小。您可以通过将 VARCHAR(255) 与 CHAR(x) 进行比较来轻松进行基准测试，以查看是否可以测量差异。

但是，有时，我需要提供“小”、“中”、“大”的提示。所以我使用 16、64 和 255 作为尺寸。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-11-04T16:50:11.823

如今，我无法想象它真的很重要了。

使用可变长度字段存在计算开销，但由于当今 CPU 过多，甚至不值得考虑。I/O 系统非常慢，以至于不存在有效处理 varchar 的任何计算成本。事实上，在计算上，varchar 的价格可能是通过使用可变长度字段而不是固定长度字段节省的磁盘空间量的净赢。你很可能有更大的行密度。

现在，varchar 字段的复杂性在于您无法通过记录号轻松找到记录。当您有固定长度的行大小（具有固定长度的字段）时，计算行 id 指向的磁盘块很简单。使用可变长度的行大小，这种情况就会消失。

因此，现在您需要维护某种记录编号索引，就像任何其他主键一样，或者您需要制作一个健壮的行标识符，将详细信息（例如块等）编码到标识符中。但是，如果您这样做，则如果将行移动到持久存储上，则必须重新计算 id。没什么大不了的，只需要重写所有索引条目并确保您要么 a) 永远不要将其暴露给消费者，要么 b) 永远不要断言该数字是可靠的。

但是由于我们今天有 varchar 字段，varchar(16) 优于 varchar(255) 的唯一值是 DB 将对 varchar(16) 强制执行 16 个字符的限制。如果数据库模型应该真正代表物理数据模型，那么具有字段长度可能是有价值的。但是，如果它只是“存储”而不是“模型和存储”，则没有任何必要。

然后，您只需区分可索引的文本字段（如 varchar）与不可索引的文本字段（如文本或 CLOB 字段）。可索引字段倾向于对大小进行限制以促进索引，而 CLOB 字段则没有（在合理范围内）。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-04T17:39:17.870

根据我的经验，如果您允许 255 个字符的数据类型，一些愚蠢的用户（或一些有经验的测试人员）实际上会填满它。

然后您会遇到各种各样的问题，包括您在报告中为这些字段和应用程序中的屏幕显示允许多少空间。更不用说超过数据库中数据的每行限制的可能性（如果您有多个这 255 个字符字段中的几个）。

在开始时选择一个合理的限制要容易得多，然后通过应用程序和数据库强制执行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-04T16:07:37.680

最好只分配一点你需要的东西。电话号码永远不会这么大。

一个原因是，除非您针对大型条目进行验证，否则毫无疑问有人会使用所有内容。然后你可能会用完你的行中的空间。我不确定 MySQL 的限制，但 8060 是 MS SQL 中的最大行大小。

更正常的默认值是 50 imho，然后在需要证明的地方增加。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-12-15T08:57:07.937

在 mysql 上下文中，在使用 varchar 列上的索引时，它会变得很重要，因为 mysql 有一个最大值。每个索引行的限制为 767 字节。

这意味着在跨多个 varchar 255 列添加索引时，您可以在 utf8 或 utf8mb4 列上相当快/甚至更快地达到此限制，如上面的答案中所指出的

# excel - 在 Excel 中换行

> ID：262247
> 
> 赞同：1
> 
> 时间：2008-11-04T16:05:23.457
> 
> 标签：excel, grouping, excel-2003

假设有一个报告将费用与输出到 Excel 的调整进行比较，这样每一行都有以下字段：

*   帐号
*   收费日期
*   原始项目编号
*   调整项目编号
*   原始数量
*   调整数量
*   原始金额
*   调整金额
*   原始发布日期
*   调整后的发布日期

我需要帮助用户在 Excel 中创建一个视图，以帮助他们发现每条记录中的更改。她希望它在两行中显示每条记录，如下所示：

```
帐户 | 日期 | O. 项目 | O. 数量 | O. 金额 | O.邮政
         | | A. 项目 | A. 数量 | A. 金额 | 一个帖子             

```

Excel 中是否有任何内置功能可以让您像这样对记录进行分组？在这种情况下，VBA 不是一个选项。

如果帐户和日期下的单元格与这些值重复，那没关系，如果这样更容易的话。如果您可以获得某种有助于分隔每条记录的交替行效果（如果必须的话，我可以稍后在 vba 中自行完成该部分）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T16:20:47.763

这有点棘手，但可行。我目前正在研究这个，待命。

好的，思路是这样的。

您有以下布局：

```
/| 一个 | 乙| C | D | F |
-+---------+---------+---------+---------+-------- -+
1| 户口号码 | 数据1 | 数据1' | 数据2 | 数据2' |
2| 1 | 10 | 11 | 一个 | 乙 |
3| 2 | 100 | 108 | 一个 | 一个 |
4| 3 | 50 | 55 | f | 克 |

```

制作第二张工作表：

```
/| 一个 | 乙| C | D |
-+-----+-----+------------------+------ ------------------------------------+
1| A/O | 参考 | 数据1 | 数据2 |
2| 一个 | 2 | =INDIRECT("Sheet1!B" & $B2) | =INDIRECT("Sheet1!D" & $B2) |
3| ○ | 2 | =INDIRECT("Sheet1!C" & $B3) | =INDIRECT("Sheet1!E" & $B3) |
4| 一个 | 3 | =INDIRECT("Sheet1!B" & $B4) | =INDIRECT("Sheet1!D" & $B4) |
5| ○ | 3 | =INDIRECT("Sheet1!C" & $B5) | =INDIRECT("Sheet1!E" & $B5) |

```

在我当前的模型中，“A/0”和“Ref”列是手动的。可能有一种方法可以使它们自动化，但我想保持简单。填写以覆盖 Sheet1 中任意长的输入表将起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T16:28:42.473

一个简单的解决方法可能是使用[条件格式](http://www.cpearson.com/excel/cformatting.htm)（说明适用于 Office 2007）：

1.  突出显示“已调整”列（假设它是 D 列，而原始是 C 列）
2.  点击“条件格式”
3.  点击“新规则...”
4.  单击最后一项“使用公式确定要格式化的单元格”
5.  输入 C1 <> D1
6.  选择一种格式样式。

应用规则，所有不匹配的条目将以您选择的样式突出显示。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-04T16:51:27.357

我也用间接做到了这一点。我在第二张纸上的公式看起来像：

=INDIRECT("source!A" & INT(ROW()/2)+1)

您将对字母进行硬编码以指示列源，然后计算将自动从正确的行中选择。应该尽可能地复制下来。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T16:23:50.893

我认为只有编程才有可能（嘿，这是一个与编程相关的网站）。

当 VBA 不是一个选项时，是否允许使用 VB.Net 或 C#？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T16:26:33.367

几年前我已经在 VBA 中做到了这一点，效果很好，我想你可以使用 C# 和 Interops 做同样的事情吗？

我可以说出添加、删除和更改的内容。它最终创建了一个易于整理和过滤的报告。

有没有理由不选择 VBA？还有哪些其他选择？

您还可以使用 Excel 函数交叉引用数据，但这对于不是 Excel 高级用户的人来说可能非常复杂**。**[excel公式的一般帮助](http://www.contextures.com/tiptech.html)

**编辑：**您将需要 Find Index Offset VLookup Match 之类的功能，这都可以通过组合它们来完成。唯一的缺点是公式长度有限制。当达到此限制时，将逻辑拆分为多列或多行。

**编辑：**您可以将 VBA 集成到一个工作簿中，并保存模板。每次他们希望比较时，他们都使用此模板来执行比较。这种方式不需要部署。他们只需要复制文件并使用它。

**编辑：** Tomalak 提出的解决方案可能不起作用，因为添加或删除记录时，我们无法控制这些记录的位置。您将需要找到具有键匹配的行并从那里开始工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-04T22:15:46.830

条件格式可以同时完成这两项工作，因为每个单元格最多可以有 3 个条件

1.  您可以（例如）使用红色粗体文本突出显示任何不同的单元格，使用这样的验证公式

    例如 =(DataA!C8 <> DataB!C8)

2.  您可以使用这样的公式对交替行进行着色（如单元格 C8 中所用）

    例如 =(MOD(CELL("Row",C8),2)=0)

这将遮蔽均匀的行。当然，要对奇数行进行着色，请在公式末尾使用 =1 而不是 =0

# python - 如何安全地解码 wxPython 应用程序中的度数符号？

> ID：262249
> 
> 赞同：0
> 
> 时间：2008-11-04T16:07:01.503
> 
> 标签：python, unicode, wxpython, decode, textctrl

我有一个我一直在编写的调试应用程序，它通过 UDP 从基于 C 的进程接收数据。发送给我的其中一个字符串包含一个`°`字符 - [Unicode U+00B0](http://en.wikipedia.org/wiki/Degree_symbol)（它顺便破坏了 StackOverflow 搜索功能！）。当我的 wxPython 应用程序尝试将该字符串附加到文本框时，我得到一个`UnicodeDecodeError`.

我第一次尝试解决这个问题只是发现了这个错误（因为该应用程序显然确实发送*了一些*错误消息。问题是该应用程序还使用该字符来报告设备周围的各种温度，这是我们真正需要记录的内容。更改源应用程序超出了我的控制范围，那么如何检测这些符号并将其解码为`wxTextCtrl`可以显示的内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T20:34:13.553

pdc 做对了，以下工作正常（但没有`decode`）：

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-
import wx

app = wx.PySimpleApp()
app.TopWindow = wx.Frame(None)
field = wx.TextCtrl(app.TopWindow)
field.Value += '°'.decode('ISO8859-1')
app.TopWindow.Show()
app.MainLoop() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T16:48:22.887

我不能对 wxPython 本身说 mych，但我猜它正在尝试在显示之前将文本转换为 Unicode，如果您有类似的字符串`'123\xB0'`并尝试使用默认编码（ASCII）将其转换为 Unicode，那么它会扔`UnicodeDecodeError`。您可以通过替换来解决此问题

```
s = message.get_string() 
```

和

```
s = message.get_string().decode('ISO8859-1') 
```

（我假设一个函数`get_string()`将消息作为字符串获取）。这里的不同之处在于，通过自己转换为 Unicode，您可以指定编码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T15:42:08.233

当被问到这个问题时，情况可能有所不同，但我对任何偶然发现这个问题的人的想法：

问题是 wxPython 正在尝试转换为 unicode，并且缺少字符集信息，它尝试使用无效的 ASCII。如果您知道您的数据是 utf-8，请告诉它，它会正常工作。

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-
import wx

app = wx.PySimpleApp()
app.TopWindow = wx.Frame(None)
field = wx.TextCtrl(app.TopWindow)

string_data = '°'
print type(string_data)
# this would error, as it tries to convert to unicode from ascii
# field.Value += string_data

unicode_data = unicode(string_data, 'utf-8')
print type(unicode_data)
field.Value += unicode_data
app.TopWindow.Show()
app.MainLoop() 
```

# visual-studio - Visual Studio&Source Control：如何共享代码？

> ID：262251
> 
> 赞同：2
> 
> 时间：2008-11-04T16:07:33.360
> 
> 标签：visual-studio, version-control, visual-sourcesafe

我想在 Visual Studio 中有一些共享代码（代码库、控件、实用程序、助手类等）。我不是指共享程序集，我指的是共享代码（即我想将一个程序集与我的应用程序一起发布，即可执行程序集）。

其他开发环境中的技术方法是在我的机器上的一个路径中拥有公共源代码，并为 IDE 提供一个路径列表来搜索代码文件。

Visual Studio 不支持代码搜索路径。

后备黑客解决方案是将源代码一遍又一遍地复制到每个项目中。但是为了将它们全部保留为一个版本，它们在源代码控制中共享。当您的源代码控制提供程序是支持共享文件的 Microsoft Visual SourceSafe 时，这很有效。

但其他源代码控制产品（CVS、Subversion、Microsoft Team Foundation Source Save Server、SVN）不支持共享文件。

那么其他人如何避免将 DLL 与他们的可执行文件一起发送呢？

* * *

**更新 1**

这是单个文件部署的问题。ClickOnce 在 3 个文件夹中生成 18 个文件（即多个文件）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-04T16:13:31.227

我可以提出两个解决方案：

1.  Visual Studio 允许您向文件添加链接。选择“添加现有项目”，选择您的文件，然后单击“添加”按钮旁边的箭头。将显示一个弹出窗口，您应该从那里选择“添加为链接”。现在您可以将常用代码存储在一个位置（文件夹）。

![在此处输入图像描述](https://i.stack.imgur.com/hnpEC.png)

2.  在可重用的程序集中编译您的通用代码并在您的项目中使用它们。部署时使用[ILMerge](http://www.microsoft.com/downloads/details.aspx?FamilyID=22914587-B4AD-4EAE-87CF-B14AE6A939B0&displaylang=en)将所有程序集合并为一个。我个人更喜欢这个选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T16:33:39.423

在我的工作中，我们开始使用[Subversion 的外部](http://svnbook.red-bean.com/en/1.4/svn.advanced.externals.html)文件夹来解决这个问题。您只需在您的根文件夹（或任何文件夹）上放置一个“外部”属性，例如：

```
ExternalLib https://yourrepo/SharedLibs/trunk

```

当您更新项目时，将创建文件夹 ExternalLib 并填充 repo 的内容。任何提交都将反映在各自的仓库中。

所以，你可以让你*的备份黑客解决方案*也适用于 SVN =)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T16:22:29.430

我们使用 ClickOnce 部署，它一直非常可靠。使用 ClickOnce，虽然下载了许多文件（包括 DLLS），但在*概念上*只有一个对象，即应用程序，尽管对用户是隐藏的。然后通过共享项目处理共享代码。

但是，如果您实际上只需要一个文件，ClickOnce 将不适合您...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T16:53:07.027

也许考虑共享程序集并在构建过程中使用像 ILMerge 这样的工具将它们全部合并到一个错误程序集中。

# c++ - CRTP 避免动态多态性

> ID：262254
> 
> 赞同：90
> 
> 时间：2008-11-04T16:07:46.883
> 
> 标签：c++, templates, virtual, crtp

如何在 C++ 中使用 CRTP 来避免虚拟成员函数的开销？

* * *

## 回答 #1

> 赞同：142
> 
> 时间：2008-11-04T19:02:56.813

有两种方法。

第一个是通过为类型结构静态指定接口：

```
template <class Derived>
struct base {
  void foo() {
    static_cast<Derived *>(this)->foo();
  };
};

struct my_type : base<my_type> {
  void foo(); // required to compile.
};

struct your_type : base<your_type> {
  void foo(); // required to compile.
}; 
```

第二个是避免使用对基址的引用或指向基址的指针，并在编译时进行布线。使用上面的定义，您可以拥有如下所示的模板函数：

```
template <class T> // T is deduced at compile-time
void bar(base<T> & obj) {
  obj.foo(); // will do static dispatch
}

struct not_derived_from_base { }; // notice, not derived from base

// ...
my_type my_instance;
your_type your_instance;
not_derived_from_base invalid_instance;
bar(my_instance); // will call my_instance.foo()
bar(your_instance); // will call your_instance.foo()
bar(invalid_instance); // compile error, cannot deduce correct overload 
```

因此，结合函数中的结构/接口定义和编译时类型推导，您可以进行静态分派而不是动态分派。这就是静态多态的本质。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-11-04T17:49:27.943

我自己一直在寻找关于 CRTP 的体面讨论。Todd Veldhuizen 的 Technicals [for Scientific C++](http://www.cs.indiana.edu/cgi-bin/techreports/TRNNN.cgi?trnum=TR542)是此 (1.3) 和许多其他高级技术（如表达式模板）的重要资源。

此外，我发现您可以在 Google 书籍中阅读 Coplien 的大部分原始 C++ Gems 文章。也许情况仍然如此。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-04T16:11:39.637

我不得不查找[CRTP](http://en.wikipedia.org/wiki/Curiously_Recurring_Template_Pattern)。然而，在这样做之后，我发现了一些关于[Static Polymorphism](http://en.wikipedia.org/wiki/Template_metaprogramming#Static_polymorphism)的东西。我怀疑这是您问题的答案。

事实证明，[ATL](http://en.wikipedia.org/wiki/Active_Template_Library)相当广泛地使用了这种模式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-01-29T20:12:10.420

**具有严格签名检查的 CRTP/SFINAE 静态调度**

这种静态调度的解决方案使用了 CRTP 和 SFINAE，这并不新鲜。这个解决方案的独特之处在于它还强制执行严格的签名检查，这允许我们以与动态分派对虚函数相同的方式静态分派重载方法。

首先，让我们先看看使用 SFINAE 的传统解决方案的局限性。以下内容摘自 Ben Deane 的 CppCon 2016 Lightning Talk “虚拟函数的静态替代方案，使用表达式 SFINAE”。

```
#define SFINAE_DETECT(name, expr)                                       \
  template <typename T>                                                 \
  using name##_t = decltype(expr);                                      \
  template <typename T, typename = void>                                \
  struct has_##name : public std::false_type {};                        \
  template <typename T>                                                 \
  struct has_##name<T, void_t<name##_t<T>>> : public std::true_type {};

// detect CommonPrefix(string)
SFINAE_DETECT(common_prefix,
              declval<T>().CommonPrefix(std::string())) 
```

使用上面的代码，模板实例化`has_complete<DerivedClass>` 通常会按照您的预期进行。如果`DerivedClass`有一个名为 `Complete`接受 a的方法`std::string`，则结果类型将为 `std::true_type`.

当你想重载一个函数时会发生什么？

```
template <class Derived>
struct Base {
    std::string foo(bool);
    std::string foo(int);
    ...
};

struct Derived : public Base<Derived>
{
    std::string foo(int);
}; 
```

在这种情况下，`Derived`确实有一个名为的方法`foo`，它接受 a `bool`因为`bool`可以隐式转换为`int`. 因此，即使我们只为接受 bool 的签名设置调度，`has_foo<Derived>`也会解析为`std::true_type`，并且调用将被调度到`Derived::foo(int)`。这是我们想要的吗？可能不会，因为这不是虚函数的工作方式。如果两个签名完全匹配，一个函数只能覆盖一个虚函数。我建议我们创建一个以相同方式运行的静态调度机制。

```
template <template <class...> class Op, class... Types>
struct dispatcher;

template <template <class...> class Op, class T>
struct dispatcher<Op, T> : std::experimental::detected_t<Op, T> {};

template <template <class...> class Op, class T, class... Types>
struct dispatcher<Op, T, Types...>
  : std::experimental::detected_or_t<
    typename dispatcher<Op, Types...>::type, Op, T> {};

template <template <class...> class Op, class... Types>
using dispatcher_t = typename dispatcher<Op, Types...>::type; 
```

这很好，但仅此一项并不能强制执行签名检查。要执行严格的签名检查，我们必须正确定义模板模板参数 `Op`。为此，我们将使用`std::integral_constant`一个成员函数指针。看起来是这样的：

```
template <class T>
using foo_op_b = std::integral_constant<std::string(T::*)(bool), &T::foo>;

template <class T>
using foo_op_i = std::integral_constant<std::string(T::*)(int), &T::foo> 
```

以这种方式定义我们`Op`的 s 允许我们仅调度具有完全签名匹配的方法。

```
// Resolves to std::integral_constant<std::string(T::*)(bool), &Derived::foo>
using foo_bool_ic = dispatcher_t<foo_op_b, Derived, Defaults>;

// Resolves to std::integral_constant<std::string(T::*)(int), &Defaults::foo>
using foo_int_ic = dispatcher_t<foo_op_i, Derived, Defaults>; 
```

现在让我们把它们放在一起。

```
#include <iostream>
#include <experimental/type_traits>
#include <string>

template <template <class...> class Op, class... Types>
struct dispatcher;

template <template <class...> class Op, class T>
struct dispatcher<Op, T> : std::experimental::detected_t<Op, T> {};

template <template <class...> class Op, class T, class... Types>
struct dispatcher<Op, T, Types...>
  : std::experimental::detected_or_t<
    typename dispatcher<Op, Types...>::type, Op, T> {};

template <template <class...> class Op, class... Types>
using dispatcher_t = typename dispatcher<Op, Types...>::type;

// Used to deduce class type from a member function pointer
template <class R, class T, class... Args>
auto method_cls(R(T::*)(Args...)) -> T;

struct Defaults {
    std::string foo(bool value) { return value ? "true" : "false"; }
    std::string foo(int  value) { return value ? "true" : "false"; }

    // Ensure that the class is polymorphic so we can use dynamic_cast
    virtual ~Defaults() {};
};

template <class Derived>
struct Base : Defaults {
    template <class T>
    using foo_op_b = std::integral_constant<std::string(T::*)(bool), &T::foo>;

    template <class T>
    using foo_op_i = std::integral_constant<std::string(T::*)(int), &T::foo>;

    std::string foo(bool value) {
        auto method = dispatcher_t<foo_op_b, Derived, Defaults>::value;
        auto *target = dynamic_cast<decltype(method_cls(method)) *>(this);
        return (target->*method)(value);
    }

    std::string foo(int value) {
        auto method = dispatcher_t<foo_op_i, Derived, Defaults>::value;
        auto *target = dynamic_cast<decltype(method_cls(method)) *>(this);
        return (target->*method)(value);
    }
};

struct Derived : Base<Derived> {
    std::string foo(bool value) { return value ? "TRUE" : "FALSE"; }
};

int main() {
    Derived d;
    std::cout << dynamic_cast<Base<Derived> *>(&d)->foo(true) << std::endl; // TRUE
    std::cout << dynamic_cast<Base<Derived> *>(&d)->foo(1) << std::endl;    // true
} 
```

编写一个为非重载成员函数创建分派器的宏很简单，但创建一个支持重载函数的宏会更具挑战性。如果有人愿意贡献，我会欢迎添加。

* * *

## 回答 #5

> 赞同：-5
> 
> 时间：2008-11-04T16:12:36.250

[这个](http://en.wikipedia.org/wiki/Curiously_Recurring_Template_Pattern)维基百科的答案有你需要的一切。即：

```
template <class Derived> struct Base
{
    void interface()
    {
        // ...
        static_cast<Derived*>(this)->implementation();
        // ...
    }

    static void static_func()
    {
        // ...
        Derived::static_sub_func();
        // ...
    }
};

struct Derived : Base<Derived>
{
    void implementation();
    static void static_sub_func();
}; 
```

虽然我不知道这实际上给你买了多少。虚函数调用的开销是（当然取决于编译器）：

*   内存：每个虚函数一个函数指针
*   运行时：一次函数指针调用

而 CRTP 静态多态的开销是：

*   内存：每个模板实例化的 Base 副本
*   运行时：一个函数指针调用 + static_cast 正在做的任何事情

# open-source - 为什么不是所有政府资助的软件都是开源的？

> ID：262255
> 
> 赞同：14
> 
> 时间：2008-11-04T16:07:54.683
> 
> 标签：open-source

让shs[的问题](https://stackoverflow.com/questions/262182/why-arent-voting-machines-open-source)更进一步……为什么不是所有政府资助的软件都是开源的？ **我可以看到出于安全目的排除了一些，但其余的呢？** 作为纳税人的我们不是已经为此付出了代价吗？政府没有权利，只有人民，政府怎么能许可？谁是被许可人？既然政府就是人民，那就是公众。

* * *

对于那些认为政府有权利的人，我敦促你们阅读[美国宪法](http://www.usconstitution.net/const.html)。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-04T16:34:23.087

我一厢情愿的想法是，如果软件是由政府雇员创建或由承包商为政府创建的定制软件，它应该自动在公共领域（就像所有政府发布的文件一样）。如果政府从一家公司购买软件，即使它包含一些定制，它也应该保持闭源。你遇到了一个灰色地带，它是由承包商为政府开发的，但可以作为商业产品出售（如果有人愚蠢到购买为政府创建的软件......请参阅 The Daily WTF 以获取参考资料)... 我不知道如何解决这个问题，但尽管我渴望 FOSS，但我认为在这种情况下最好还是站在企业一边。

我还认为，如果政府是封闭源代码解决方案的可行竞争对手，则应该要求政府使用现有的开源软件。它将节省一些税金并促进政府的开放（不是软件意义上的，尽管那也很好）。

我们如何实现它？:D

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-04T17:33:03.483

我为政府的一部分工作。

首先，让我告诉你，你不想看到管理你政府的垃圾。

我最终整天支持的代码中有很多“漏洞”。无需将它们宣传给那些会对它们造成严重破坏的人，也没有足够的时间或资源来修复它们。

政府机构担心钱。IT 部门通常不会得到足够的信息。政府机构很难与私营公司竞争优质人才。摆脱糟糕的程序员也更难。如果有一个完整的员工，有些人是沉重的，没有办法雇用更多或更好的人。

要求是政治家想出来的，从来都不是清晰、简洁或正确的。
截止日期更糟，因为现在您需要遵守或支持影响成千上万人的法律。因此，糟糕的代码，更差的标准，大量的创可贴。

对不起，没有开源。

是的，我通常会支持从外到内的倡议，但这只是乞求外部个人/团体/政府的恶意！

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-04T16:10:42.260

听起来不错。我 - 作为非美国公民 - 然后可以访问美国纳税人支付的开源软件 :)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-04T16:15:02.593

现在有很多政府赞助的开源，尤其是来自像[桑迪亚](https://software.sandia.gov/)这样的政府实验室的东西。不难找到。

政府反对开源软件的一个论点是，编写商业软件的人的税款被用于制造竞争产品。这与人们在自己的时间或自己的钱上做这件事完全不同。想象一下，如果你有一家酒店，然后城市买了附近的一块房产，在上面建了一家酒店，然后开始以较低的价格出售房间（哦，实际上这种事情确实[发生](http://www.reason.com/news/show/29576.html)了）。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-05T21:52:06.300

这里有很多好主意，但最好的答案是最简单明了的。

**选民对政府开源软件的需求不足。**

我认为一个好的开始是强制使用开放文档格式。拥有开放标准使开放软件更加可行。

然后也许有一天我们可以拥有我可以信任的电子投票机来计算我的选票。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-04T16:45:55.043

它是公共领域：

[http://en.wikipedia.org/wiki/Work_of_the_United_States_Government](http://en.wikipedia.org/wiki/Work_of_the_United_States_Government)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-04T16:15:26.963

您真的希望地狱火导弹的定位和跟踪软件出现在网络上吗？保密是你知道的等式的一部分......

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-04T16:37:38.977

这取决于您是在谈论联邦政府还是地方政府，但答案是相同的。

*   政府不是由利润驱动的，而是由创建公共服务驱动的，因此使用开源来降低软件许可成本的理由并不像在私营部门那样重要。

*   政府在适应新趋势方面进展缓慢。这是设计使然，您希望政府稳定。保持购买专有软件的现状是政府更安全的选择。

*   开源软件已经存在了很长时间，但在广义上支持它所需的临界质量（即，我所在地区是否有足够大的人才库来雇用人员来支持这项新技术）是相当新的。

*   政府最受知道如何运作该系统的人的影响。专有软件公司对获得政府合同有着浓厚的兴趣，并利用他们的影响力相应地游说政府。

对于后续问题：

*   政府的工作是为民众提供服务。如果专有软件提供比开源替代方案更好的服务，则不应强制政府选择劣质的解决方案。

*   政府确实有权利。它是签订具有法律约束力的合同的法人实体。这是政府与私营部门合作所必需的。政府将持有许可证（例如）。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-04T17:47:23.470

关于有多少商业软件不/不依赖政府项目的资金，这里似乎有一些非常幼稚的观点。很少有软件产品在某处不包含政府资助的代码，无论是增强功能、补丁还是错误修复，或者在许多情况下从第一个开发版本到第一个发布版本。

而且它在大多数情况下都根深蒂固——你永远无法分割政府部门。

如果这个提议被采纳，那么剩下的产品就很少了。至少来自美国公司。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-08-01T15:26:18.443

问题简要提到了安全性，但这可能是政府生产或政府赞助的软件不能开源的主要原因。总体而言，军方运行许多为特定目的定制和编写的软件，源代码的公开将暴露机密信息。当然，您可以提出并争论相关信息可以被编辑，但这并不总是可能的，就像您知道软件的用途一样，您可以在无需知道确切名称的情况下获得相关信息（即机身的实际操作包络） .

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-05T18:10:23.110

美国政府开发的软件不开源的主要原因是商业软件公司必须与使用公共资金开发的免费软件竞争。美国政府生产的少量开源产品不与同等的商业产品竞争。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-04T16:20:11.383

对于广泛适用的美国政府资助的项目，我通常会看到这样的许可证：

特此免费授予任何人获得本软件和相关文档文件（“软件”）的副本，以不受限制地处理本软件，包括但不限于使用、复制、修改、合并的权利、发布、分发和/或出售本软件的副本，并允许向其提供本软件的人这样做。

[（这是CLIPS](http://clipsrules.sourceforge.net/)的许可证）。

对于其他东西，我认为这是一个专业化、安全性等问题。例如，从事航天飞机计划，没有充分的理由将航天飞机的软件“开源”。该软件高度专业化（谁将建造自己的航天飞机？），并且由于飞行安全问题，他们可能不想滚动匿名社区更改。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-04T17:14:53.957

好吧，一方面，政府做的很多事情不是由私营部门的人做的。政府将税收征管系统开源有什么好处？

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-11-04T17:46:13.473

首先，并非所有软件都可以像“由某人在空闲时间完成”那样开源。例如，纳税软件每年都会发生相当大的变化，需要许多补丁，并且可能需要责任，受控版本/补丁跟踪等。您不想与那些因为使用了不稳定的纳税人而交错税的人打交道SVN 分支。除了纳税之外，你也找不到很多志愿者。当然你可以让一家公司做软件并强制它发布资源，但公司可能会为此要求更多的钱。

对于现成的软件（比如 MySQL、PostgreSQL 而不是 SQL Server、Oracle），您仍然需要考虑许多因素：

1）对于有限的安装，许可证成本是没有意义的（假设您有 50 台服务器，上面有 5000 美元的 db 许可证 - 那是 25 万美元，对于政府来说，这甚至可能不值得花时间谈论它）。

2）信任+文化。政府人员在很多方面都广泛表现出不了解互联网、计算机等。他们理解 OSS 的概率低于 0。他们甚至可能对此抱有善意。

3) 支持，TCO。OSS 是免费的，只有当你的时间是空闲的时候才是真实的。当您投入顾问、专家、雇主的时间等时，成本就会增加。是否超过专有软件是另一回事，但成本应该被视为一个变量。例如，Windows 的呼叫中心费用更便宜。

4）恐惧（合理与否）。我在某处读到“没有人因选择 Windows 而被解雇”。不管这句话是对是错，如果你想推 OSS，你最终可能会孤军奋战（比如你的上级不理解、不信任等）。许多有意识的人仍然没有能力做出这样的选择。如果出现问题，而当每个人都说 Windows 时，你是推动 Linux 的人……

5）企业压力。它存在，没有什么可添加的。

6) 慢环境。在一些政府机构中，周围仍然有 Windows 95 PC。不完全是您正在考虑的“明天我们将改变这一切”的环境。

7）已安装的底座/供应商锁定（这取决于您如何看待玻璃:)）。

8) 法律。每个政府都有关于如何选择产品等的法律。法律甚至可能不允许免费的，特别是如果他们没有法定代表（大多数主要的 OSS 都有法定代表，但不是全部）。

9) 大多数人不在乎。真的，对于我们这些极客来说，这场 OSS 专有战争是有其意义的……大多数人都关心它，就像关心苍蝇的分类学一样。

10) 你所在的公司是否在 100% OSS 上运行？为什么不 ？

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-11-05T21:34:01.327

建立在平台（.net、java 等）上的系统是解决方案。政府（自愿）为解决方案付费，但获得相同结果的投资回报率远高于其他方法。

政府购买了许多它在智力上并不拥有的东西，因为它需要产品/解决方案。数以百万计的例子在那里。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-01-01T07:09:09.073

按照您的建议，不一定符合公共利益。我看到的唯一兴趣是那些支持开源宣传的人。当然，这样的提议会产生额外的成本，而且我认为这些成本不会真正为公众增加太多价值。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-02-05T19:53:00.170

根据法律，政府不能对其完全制作的任何作品进行版权保护。（即公共领域）如果没有版权，您就不能强制执行像 GPL 甚至 BSDL 这样的软件许可。

但是，政府可以从私人实体制作的作品中获得版权所有权。而且，如果他们为它编写新代码，他们必须遵守许可限制。从技术上讲，他们编写的代码是公共领域的，但如果没有受版权保护和许可的代码，它通常是无用的。

这就是为什么，例如，SELinux 是 GPL 的。因为他们需要通过 Linux 内核许可 GPL 他们的工作。

这些天来，看到任何完全独立的开源项目变得非常罕见。通常它们链接到其他一些开源库。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-08-01T16:11:49.540

我认为这是一个政治问题，不适合 SO 的典型范围。

政府究竟是为人民服务，还是只是最强的恶霸，为统治阶级和企业服务，这是值得商榷的。当然，这种情况因国家而异，几乎一致认为斯堪的纳维亚半岛的政府对他们的人民很好，而且几乎一致认为朝鲜（例如）是一个压迫性的恶霸。

如果你想避免一些有争议的话题，我建议你把它框定为：一个仁慈的政府是否应该将其赞助的软件开源？

* * *

## 回答 #19

> 赞同：-2
> 
> 时间：2008-11-04T16:41:10.217

信任 - 简单明了。政府不能向任何修改其代码的人开放。

例如：编码人员可能故意将缓冲区溢出引入 linux 内核。他们知道它的位置，所需的有效载荷并立即妥协。这也提供了可否认性，因为它看起来“只是另一个”溢出错误。

**编辑**——我对评论的反驳： [http://www.debian.org/News/2006/20060713](http://www.debian.org/News/2006/20060713)

debian 内核通过被入侵的主机被入侵。是的，代码可能会被审查，但即使在知道缓冲区溢出是一个问题 20 年后，我们仍然会发现新的错误。

评论不是一个完美的包罗万象。

# linq - 在经典 ASP 站点中集成 Linq

> ID：262257
> 
> 赞同：1
> 
> 时间：2008-11-04T16:08:00.050
> 
> 标签：linq, linq-to-sql, asp-classic, migration

这个项目可能是将大型 CMS 从 Classic ASP 迁移到 .Net 的第一步。我想使用 LINQ 来查询数据库。

有没有人对实现这一目标的策略有任何想法？我知道此时这是一个模糊的问题，但我正在收集信息。

谢谢，

凯夫狗

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-04T16:16:50.423

将您的数据访问放在 ASP.NET/WCF Web 服务中，并在那里使用 Linq to SQL。然后，使用 SoapClient 在您的经典 ASP 中使用该服务。

相关文章：

*   [http://www.4guysfromrolla.com/webtech/070302-1.shtml](http://www.4guysfromrolla.com/webtech/070302-1.shtml)
*   [http://www.c-sharpcorner.com/UploadFile/ankithakur/WSIntegration02132006041221AM/WSIntegration.aspx](http://www.c-sharpcorner.com/UploadFile/ankithakur/WSIntegration02132006041221AM/WSIntegration.aspx)（参见经典 ASP 客户端）
*   [使用 SOAPClient 从 ASP 调用 ASP.NET Web 服务](https://stackoverflow.com/questions/19318/calling-aspnet-web-service-from-asp-using-soapclient)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T16:10:21.200

您可能必须全力以赴使用 ASP.NET。我认为您无法真正将两者分开。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T16:18:48.343

对于 LINQ，您需要编写一个 LINQ 解释器，而这很可能需要您很长时间才能准确完成。

我看到很多迁移计划，就像这样，试图将过时的技术与时尚的新解决方案联系起来，他们总是以痛苦、浪费大量时间和痛苦而告终，并伴有躁狂抑郁症的一面。

别再碰旧代码了。别管它。将所有精力集中在移植需要移植的内容上。在数据方面，再次离开旧数据库，重写您的数据库并编写一个迁移脚本，该脚本可以在时间准备好时以编程方式复制所有数据。

当你认为你已经完成时，复制当前数据库，测试它一周左右的铃声，然后再次刷新旧数据库以确保你不会丢失任何数据。

然后悄悄地把旧系统从后面拿出来拍。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T13:03:35.353

除非您为它编写自己的解释器，否则您无法真正将 LINQ 集成到经典 ASP 中，但那有什么意义呢。这样做就像编写自己的编程语言一样。正如 Corbin 建议的那样，尝试将数据访问层迁移到 .NET，然后您可以通过 Web 服务或其他方式从经典 ASP 中利用它。您不必一次全部重写所有内容，但如果您想利用 LINQ，则必须将您的数据库代码拉出并在 .NET 中重新编写。祝你好运。希望您的数据库代码足够分离以使这相对轻松。

# svn - 如何协调颠覆客户端配置？

> ID：262259
> 
> 赞同：0
> 
> 时间：2008-11-04T16:08:39.737
> 
> 标签：svn, configuration

作为 subversion 用户，您将在用户主目录中拥有一个本地配置文件夹*/<userhome>/.subversion/*。其中有一个*配置*文件，其中包含***auto-props***。

这些属性应用于您添加到存储库的文件，例如通过

```
svn add <file> 
```

现在这是我的问题（实际上是两个问题）：

1.  您如何协调您的开发团队，以便他们始终在您的项目中使用相同的*自动道具*？我知道在[tirgis.org](http://subversion.tigris.org)上注册了一个[功能请求](http://subversion.tigris.org/issues/show_bug.cgi?id=1974)。但这已针对 svn 2.0 进行了调整，那么您对此问题的中间解决方案是什么？
2.  如果您正在处理来自不同 svn 服务器的单独项目：您如何组织您的*auto-props*配置以处理每个服务器的不同设置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T16:33:08.393

我们这样做：

我们有一个 pre-commit-hookscript 根据文件类型监视每个文件的所有可能属性，我们将错误消息返回给客户端，其中包含获取配置文件当前版本的 URL。

也可以解析这个在线配置文件，所以你不必维护你的钩子脚本*和*标准配置文件。

# eclipse - Eclipse RCP 客户端并将控制台重定向到文件

> ID：262261
> 
> 赞同：2
> 
> 时间：2008-11-04T16:09:11.873
> 
> 标签：eclipse, logging, eclipse-rcp

我正在运行一个 Eclipse RCP 应用程序。我已经启用了标志*-console -consolelog -debug*，现在它正在嗡嗡作响地登录到它的控制台。

但是，我希望它记录到文件中。如果我从 Eclipse IDE 中启动应用程序，我可以为它选择一个文件以将控制台重定向到。必须有一些等效的标志 och 属性，我可以将其放入导出的 RCP 应用程序的 config.ini 文件中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T23:30:29.220

您使用的是 commons-logging 或 log4j 之类的日志框架吗？如果是这样，他们将可以选择登录到不同的位置，这可能是管理它的最佳方式。（它在所有环境中都一样）。

如果您需要帮助在 rcp/OSGi 应用程序中设置记录器，请查看以下问题：

[登录 Eclipse/OSGi 插件](https://stackoverflow.com/questions/223875/logging-in-eclipseosgi-plugins)

# timezone - 我需要一个城市到时区的映射列表 - 获得它的最佳方式？

> ID：262264
> 
> 赞同：56
> 
> 时间：2008-11-04T16:10:23.853
> 
> 标签：timezone

我有一个城市、州/省和国家/地区的列表，我需要轻松找到它们各自的时区。具体来说，我需要知道它们映射到哪个 Windows 时区。到目前为止，这是一个困难的过程，因为没有简单的方法可以将城市传递给某物并返回时区（时区是偏移量，并且时区是否支持夏令时）。

当前流程是使用[http://www.batchgeocode.com](http://www.batchgeocode.com)获取城市的纬度/经度（这实际上称为 Yahoo 服务），然后调用[http://www.EarthTools.org](http://www.EarthTools.org)获取时区字母，映射到偏移量。问题是 yahoo 服务有时会返回错误的经度/纬度，而 earthtools.org 对 DST 信息了解不多，因此映射到正确的时区 ID 是一个繁琐的手动过程。

我不能成为第一个这样做的人 - 有没有人知道更好的方法，或者那里有一些包含我需要的信息的列表？

谢谢。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-01-17T16:31:58.097

有趣的问题！其他三个 SO 帖子（41504、55901 和[237023](https://stackoverflow.com/questions/41504/timezone-lookup-from-latitude-longitude)）[提到](https://stackoverflow.com/questions/55901/web-service-current-time-zone-for-a-city)了一些线索[。](https://stackoverflow.com/questions/237023/is-there-a-central-repository-for-timezone-information)有[奥尔森数据库](https://www.iana.org/time-zones)（参见[维基百科条目](http://en.wikipedia.org/wiki/Zoneinfo)的描述），但它看起来更算法/程序化（例如，如果你知道一个县名，[印第安纳州](http://en.wikipedia.org/wiki/Time_in_Indiana)的某些县有一个规则）。

我尝试查看 EarthTools 但它[失败](http://www.earthtools.org/timezone/46.76667/-56.18333)了[St.Pierre/Miquelon](http://maps.google.com/maps?f=q&source=s_q&hl=en&geocode=&q=46.76667,+-56.18333&t=h&z=11&iwloc=addr)，这是一个很好的测试用例（-3:00 而不是附近的 Newfoundland 的 -3:30 这是 EarthTools 所说的）。

一些有希望的选择：[worldtimeengine.com](http://worldtimeengine.com/)有一个免费的交互式版本和一个似乎很便宜的 API（每英镑 5000 个查询），但该 API 仅涵盖作为输入的经纬度查询（而不是作为输入的位置，这是交互式的东西）版本有）。

**最佳线索：**我会看一下[geonames.org](http://www.geonames.org/export/ws-overview.html)，它看起来有一个非常丰富的 API，你可以使用它们，它们既有免费（慢速）版本，也有商业版本以获得更好的性能。

ps 这里有一些很好的测试用例（来自[worldtimezone.com](http://www.worldtimezone.com/faq.html)和[维基百科的时区列表，时区](http://en.wikipedia.org/wiki/List_of_time_zones)地图[也是](http://upload.wikimedia.org/wikipedia/commons/e/e7/Timezones2008.png)说明性的）：

*   委内瑞拉加拉加斯 (-4:30)
*   纽芬兰甘德 (-3:30)
*   伊朗德黑兰 (+3:30)
*   阿富汗喀布尔 (+4:30)
*   尼泊尔加德满都 (+5:45)
*   缅甸仰光 (+6:30)
*   新西兰查塔姆群岛 (+12:45)
*   复活节岛 (-6)
*   圣皮埃尔和密克隆 (-3)
*   福克兰群岛斯坦利 (-4)
*   印第安纳州埃文斯维尔（-6=中部）
*   安大略省，俄勒冈州（-7=山）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-10-20T17:06:20.083

我们使用**.NET C# MVC**，我们需要每个国家/地区的**Windows 时区列表。**

这样对于每个注册用户，我们都可以自动设置时区。

大多数在线数据库都提供**IANA**时区，很难映射到特定国家/地区。

使用[NodaTime](http://nodatime.org/)，我们设法创建了一个列出以下条目的 Json。

```
CountryName
2LetterIsoCountryCode
3LetterIsoCountryCode
IANATimezones
WindowsTimezones 
```

您可以在[此处下载生成的 JSON](https://s3.eu-central-1.amazonaws.com/atleu/countries_with_timeZones.json)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-03-06T16:28:03.870

[moment-timezone](https://github.com/moment/moment-timezone)是一个用于时区计算的 JavaScript 库。

他们所有连接国家、时区和偏移量的时区数据都[以 json 格式提供](https://github.com/moment/moment-timezone/tree/bf1de5d6a7cc6cb493d90b021fb2c0ac777c93eb/data)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-23T10:57:22.343

我可以帮助您完成当前工作流程的第二部分。我编写了一个 Java 库，它将纬度/经度映射到时区，其中数据库在源代码中编码。

源代码基本上是一个巨大的 if 语句树：if (lat >= -33.0) if (lng < -151.5) ... else ... 等等。这只是一个班级。因此，如果您使用 C#，移植它是微不足道的。

[http://www.edval.biz/mapping-lat-lng-s-to-timezones](http://www.edval.biz/mapping-lat-lng-s-to-timezones)

精确到22公里。

# excel - 如何在 XLA 文档中创建工具栏？

> ID：262267
> 
> 赞同：2
> 
> 时间：2008-11-04T16:11:06.613
> 
> 标签：excel, commandbar, xla, vba

如何使用 XLA 文档为 Excel 创建工具栏？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-04T16:18:36.143

要制作工具栏，在 onload 事件中，您将执行以下操作：

```
Dim myBar As CommandBar, myButt As CommandBarControl 

'Delete the toolbar if it already exists'
On Error Resume Next 
CommandBars("My Toolbar").Delete 
On Error Goto 0

Set myBar = CommandBars.Add(Name:="My Toolbar", _
      Position:=msoBarFloating, Temporary:=True) 
myBar.Visible = True 

 ' Create a button with text on the bar and set some properties.'
Set myButt = ComBar.Controls.Add(Type:=msoControlButton) 
With myButt
    .Caption = "Macro1" 
    .Style = msoButtonCaption 
    .TooltipText = "Run Macro1" 
    .OnAction = "Macro1" 
End With 

 ' Create a button with an image on the bar and set some properties.'
Set myButt = ComBar.Controls.Add(Type:=msoControlButton) 
With myButt  
     'the faceId line will let you choose an icon'
     ' If you choose to use the faceId then the caption is not displayed'
    .FaceId = 1000 
    .Caption = "Icon Button" 
    .TooltipText = "Run Macro2" 
    .OnAction = "Macro2" 
End With 
```

礼貌的做法是在退出时删除工具栏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T16:15:50.207

不确定这是否是您要查找的内容，但我认为这可能会对您有所帮助：

[Excel -- 宏工具栏](http://www.contextures.com/xlToolbar02.html)

由于您没有指定 Excel 的版本，我不确定这是否适合您，但也许它会为您提供一个良好的起点。

# javascript - 我可以使用 JavaScript 关闭 iPhone 浏览器吗

> ID：262273
> 
> 赞同：1
> 
> 时间：2008-11-04T16:12:21.743
> 
> 标签：javascript, iphone, safari

在 iPhone 中有没有一种方法可以使用 JavaScript 关闭浏览器并返回主屏幕？在最后一页向导之后，我正在调用另一个 iPhone 应用程序（例如：地图），我不会让用户在完成后返回浏览器屏幕。我的备份计划是有一个“完成”页面，但这对客户来说并不是最好的体验。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T17:43:31.963

我已经与苹果确认这在 iPhone OS 2.2 及之前版本中是不可能的。

我已经尝试了这些好的建议，但是它们不会关闭 iPhone 上的浏览​​器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T16:26:11.090

了解 Apple，这对于 JavaScript 来说可能是不可能的。你有没有尝试过什么？如果没有，请尝试以下其中一个：

```
javascript:self.close();
window.close(); 
```

编辑：我通过谷歌找到了这个，这可能会绕过确认框，但我认为它不再适用于现代浏览器：

```
window.opener='x';
window.close(); 
```

我刚查了一下，好像不行（弹出IE7框，FF3什么都不做，Opera 9.61根本没有提示框）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T16:31:01.003

扩展[安德斯](https://stackoverflow.com/questions/262273/can-i-close-the-iphone-browser-using-javascript#262356)：`window.close()`会做你想做的事。根据[Window](http://www.devguru.com/Technologies/ecmascript/quickref/window.html) doc page，如果您尝试关闭不是通过javascript打开的窗口，将提示用户确认。

# asp.net - 在 sql 代理作业期间暂时使应用程序脱机的最佳方法

> ID：262277
> 
> 赞同：1
> 
> 时间：2008-11-04T16:12:37.530
> 
> 标签：asp.net, sql-server-agent

我有一个针对 SQL Server 2005 数据库运行的 ASP.NET 应用程序。每天一次，我需要在 SQL 代理作业中运行一系列 procs 和 SSIS 包来更新表中的数据。SQL 代理作业将在无人参与的情况下按计划运行。

当 SQL 代理作业步骤运行时，Web 应用程序失败的机会很小，因此我想暂时完全禁用该应用程序，运行敏感步骤，然后再次启用该应用程序。

我看到我可以使用`app_offline.htm`Web 应用程序站点根目录中的文件。为此，我需要为 SQL 代理程序包提供跨服务器的权限，以便它可以`ren app_offline.tmp app_offline.htm`在 Web 服务器上执行类似操作，运行这些步骤，然后将 htm 文件返回到 .tmp。

我正在考虑的另一个选项是将“MAINTMODE”布尔值放入由 SQL 代理作业更新的表中，并让 Web 应用程序在每次调用数据库时检查它以确保它可用。如果不是，请重定向到指示该站点暂时离线的页面。

我应该考虑其他方法吗？对用户造成最小干扰的最佳方法是什么？

谢谢，

克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T16:17:57.613

我会使用您提出的“MAINTMODE”方法。这样，只有在请求到达您的 Web 服务器时才会触发它。为简单起见，您的数据库服务器不必与您的 Web 服务器通信。让您的 Web 服务器处理演示，让您的数据库服务器专注于数据库。

# oracle - Oracle Analytics - sql 查询的分区和排序

> ID：262278
> 
> 赞同：3
> 
> 时间：2008-11-04T16:13:02.007
> 
> 标签：oracle, analytic-functions

这在回答另一个用户的[问题](https://stackoverflow.com/questions/261924/how-do-i-compress-this-oracle-resultset-into-values-according-to-row-priority-i)（TheSoftwareJedi）时出现......

给定下表：

```
ROW_PRIORITY   COL1     COL2    COL3
0              0.1      100     <NULL>
12             <NULL>   <NULL>  3
24             0.2      <NULL>  <NULL> 
```

和以下查询：

```
select  'B' METRIC, ROW_PRIORITY,
        last_value(col1 ignore nulls) over (ORDER BY ROW_PRIORITY) col1,
        last_value(col2 ignore nulls) over (ORDER BY ROW_PRIORITY) col2,
        last_value(col3 ignore nulls) over (ORDER BY ROW_PRIORITY) col3
from    (SELECT * FROM ZTEST); 
```

我得到这些结果：

```
METRIC  ROW_PRIORITY    COL1    COL2    COL3
B            0          0.1     100     <NULL>
B           12          0.1     100     3
B           24          0.2     100     3 
```

预期的：

```
METRIC  ROW_PRIORITY    COL1    COL2    COL3
B            0          0.2     100     3
B           12          0.2     100     3
B           24          0.2     100     3 
```

问题当然是，为什么我不能为 col1 中的每一行优先级获得 0.2 等？LAST_VALUE 应该首先执行 ORDER BY，然后从分区中选择最后一个值。在上述查询的情况下，分区是整个记录集，所以我会在上面看到我的预期结果。

谁能解释一下？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-04T16:58:33.613

当您在 Partitioning 子句中包含 ORDER by 时，您可以包含一个显式的窗口子句。

如果您希望这些 LAST_VALUES 出现在所有行上，则应在 Order By 之后包含此内容：

前无界和后无界之间的行

那应该可以解决您的查询。

来自文档的更多详细信息：

如果不指定 ROW 或 RANGE 子句，则窗口大小按如下方式确定：

*   如果指定了 ORDER BY 子句，则窗口从分区中的第一行 (UNBOUNDED PRECEDING) 开始，并以当前行 (CURRENT ROW) 结束。
*   如果未指定 ORDER BY 子句，则窗口从分区中的第一行 (UNBOUNDED PRECEDING) 开始，并以分区中的最后一行 (UNBOUNDED FOLLOWING) 结束。

# dsl - 用于模型驱动开发的工具（最佳实践？）？

> ID：262279
> 
> 赞同：3
> 
> 时间：2008-11-04T16:13:04.033
> 
> 标签：dsl, model-driven-development, mdsd

模型驱动的软件开发。

据我了解，它提高了设计的抽象级别，以更好地反映软件将尝试运行的领域。一句话就可以说很多。

领域专家（客户）和开发人员之间的沟通对于使这种方法发挥作用至关重要。我想知道的是，是否有工具套件或一组最佳实践有助于 MDSD 的初始推进？一旦领域被充实，如何将该模型映射到 ORM（或其他）？

我只是潜入 MDSD 和 DSL 领域，因此任何建设性的想法或评论都会受到重视。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T16:45:36.823

如果您在 .net 中编程，您应该阅读 Jimmy Nielsson 的“应用领域驱动设计和模式”。他还有一个关于 ORM (NHibernate)、SOA 和依赖注入的部分。

无论如何，您应该看看 Eric Evans 的“领域驱动设计”。这是一本经典之作，您可以在其中找到有关领域驱动设计模式和最佳实践的宝贵信息

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-04T20:44:09.667

如果您在 Microsoft 平台上进行开发，您可能还想看看 Oslo。这里有一个很好的概述： [http ://www.pluralsight.com/community/blogs/aaron/archive/2008/11/03/introducing-quot-oslo-quot.aspx](http://www.pluralsight.com/community/blogs/aaron/archive/2008/11/03/introducing-quot-oslo-quot.aspx)

这是来自 Chris Sells 的大量链接： [http ://www.sellsbrothers.com/news/showTopic.aspx?ixTopic=2197](http://www.sellsbrothers.com/news/showTopic.aspx?ixTopic=2197)

我还没有准备好将领域驱动设计与模型驱动开发等同起来。

您可能还想查看模型驱动架构（OMG MDA）的观点，尽管您自己的滚动可能并不多。

模型驱动中的一个大问题与从模型中派生实现的专业知识的来源以及维护（和调试）发生的级别有关。我对可用书籍的测试将是它们如何使管道易于理解，以及人们如何理解从建模到部署再返回的路径。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-26T11:09:19.360

免责声明：我是业务应用程序的开发人员。以下观点肯定是由我在企业 IT 领域的经验所塑造的。我知道，还有其他软件开发领域。特别是在工业和/或嵌入式系统开发中，世界可能看起来不同。

**我认为 MDSD 仍然过于依赖代码生成。**

代码生成仅在您的代码包含大量噪音和/或非常重复时才有用。换句话说，当你的代码不能主要关注本质的复杂性，而是被偶然的复杂性污染了。

在我看来，当前平台和框架的趋势正是消除偶然的复杂性，让应用程序代码专注于本质的复杂性。

因此，这些新的平台/框架从 MDSD 运动的风帆中汲取了很多灵感。

DSL（文本的）是另一种趋势，它试图将重点放在本质的复杂性上。虽然 DSL 可以用作代码生成的源代码，但它们并不主要与代码生成相关联。DSL（尤其是内部 DSL）基本上让它在运行时被解释/执行。[运行时代码生成介于两者之间]。

因此，即使 DSL 经常与 MDSD 一起被提及，我认为它们确实是 MDSD 的替代品。鉴于目前的炒作，他们也消除了 MDSD 运动的势头。

如果您已经达到了最终消除代码中意外复杂性的目标（我知道这是虚构的），那么您已经获得了业务问题的文本模型。这不能再简化了！

漂亮的方框和图表不会提供抽象级别的另一种简化或提升！它们可能对可视化有好处，但即使这样也是值得怀疑的。图片并不总是掌握复杂性的最佳表示！

此外，MDSD 中涉及的工具的当前状态增加了另一个级别的意外复杂性（想想：同步、差异/合并、重构......）这基本上使简化的最终目标无效！

查看以下 ActiveRecord 模型，作为我的理论的说明：

```
class Firm < ActiveRecord::Base
   has_many   :clients
   has_one    :account
   belongs_to :conglomorate
end 
```

我认为这不能再简化了。此外，任何带有框和线的图形表示都不会简化，也不会提供更多便利（考虑布局、重构、搜索、差异......）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-26T12:07:28.010

MDD 可以非常复杂或相对简单。

如果您想将各种模型（例如在 UML 中）自动转换为代码并进行往返工程等等，您可以获得一些非常漂亮的工具。

或者

您可以使用单向（模型到代码）转换来或多或少地手动绘制模型和构建代码。

首先构建模型的想法是公认的最佳实践。它通常被称为“设计”。当人们将设计与规范混为一谈时，就会出现问题。将要构建的模型不是编程规范。它是一种抽象，可用于评估正确性、定义测试用例、编写规范等。

您不必对所有内容进行建模。您可以通过拥有一个独立于任何特定实现的数据模型来启动 MDD。

1.  您使用 UML 绘制模型。

2.  您将 UML 转换为类定义。

3.  您使用 ORM 层（或 ODBMS）将模型映射到某种存储。

你不需要更多。您需要做的是在解决太多其他问题之前专注于让模型正确。

这些问题通常来自软件开发过程中发生的各种过早优化。RDBMS 物理设计的早期飞跃。早期进入网页设计并使用它来驱动数据模型。早期飞跃到定义服务器架构和分配存储。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-04-20T14:05:45.347

您应该阅读 Markus Voelter 的这篇关于 MDSD 最佳实践的优秀论文：http: [//www.jot.fm/issues/issue_2009_09/column6.pdf](http://www.jot.fm/issues/issue_2009_09/column6.pdf)

关于 MDSD/DSL 选项，EMF 生态系统 ( [https://www.eclipse.org/modeling/emf/](https://www.eclipse.org/modeling/emf/) ) 提供了许多有用的构建块：

*   实现元模型和模型编辑器 (EMF)
*   实现模型编辑器（EMF、Sirius、Xtext...）
*   管理协作和可扩展性（EMF-Transaction，CDO）
*   实施模型验证规则（EMF-Validation）
*   实现代码生成器（Acceleo、Xtend/Xpand、Mwe...）
*   实现文档生成器（pxDoc、m2doc...）

减少工具投资的一个有趣的选择也可以是使用可扩展的 UML 建模器，并在重用的建模器之上定义您自己的 UML 配置文件和自定义工具（如果您的 UML 建模器基于 UML2，前面的列表仍然足够/EMF 实施）。

# c# - 我怎么知道一个进程是否正在运行？

> ID：262280
> 
> 赞同：180
> 
> 时间：2008-11-04T16:13:09.433
> 
> 标签：c#, .net, process

当我获得对 a 的引用时`System.Diagnostics.Process`，我如何知道进程当前是否正在运行？

* * *

## 回答 #1

> 赞同：285
> 
> 时间：2008-11-04T16:14:32.080

这是一种使用名称的方法：

```
Process[] pname = Process.GetProcessesByName("notepad");
if (pname.Length == 0)
  MessageBox.Show("nothing");
else
  MessageBox.Show("run"); 
```

您可以循环所有进程以获取 ID 以供以后操作：

```
Process[] processlist = Process.GetProcesses();
foreach(Process theprocess in processlist){
   Console.WriteLine("Process: {0} ID: {1}", theprocess.ProcessName, theprocess.Id);
} 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2008-11-06T11:47:28.717

这是我使用反射器后发现的最简单的方法。我为此创建了一个扩展方法：

```
public static class ProcessExtensions
{
    public static bool IsRunning(this Process process)
    {
        if (process == null) 
            throw new ArgumentNullException("process");

        try
        {
            Process.GetProcessById(process.Id);
        }
        catch (ArgumentException)
        {
            return false;
        }
        return true;
    }
} 
```

该`Process.GetProcessById(processId)`方法调用该方法并在进程不存在的情况下`ProcessManager.IsProcessRunning(processId)`抛出。`ArgumentException`由于某种原因，该`ProcessManager`课程是内部的...

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2008-11-04T16:57:33.897

同步解决方案：

```
void DisplayProcessStatus(Process process)
{
    process.Refresh();  // Important

    if(process.HasExited)
    {
        Console.WriteLine("Exited.");
    }
    else
    {
        Console.WriteLine("Running.");
    } 
} 
```

异步解决方案：

```
void RegisterProcessExit(Process process)
{
    // NOTE there will be a race condition with the caller here
    //   how to fix it is left as an exercise
    process.Exited += process_Exited;
}

static void process_Exited(object sender, EventArgs e)
{
   Console.WriteLine("Process has exited.");
} 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2016-07-06T22:05:46.780

这应该是一个单行：

```
public static class ProcessHelpers {
    public static bool IsRunning (string name) => Process.GetProcessesByName(name).Length > 0;
} 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2014-01-31T14:51:18.197

reshefm 有一个很好的答案；但是，它没有考虑到进程从未开始的情况。

这是他发布的内容的修改版本。

```
 public static bool IsRunning(this Process process)
    {
        try  {Process.GetProcessById(process.Id);}
        catch (InvalidOperationException) { return false; }
        catch (ArgumentException){return false;}
        return true;
    } 
```

我删除了他的 ArgumentNullException 因为它实际上假设是一个空引用异常，并且无论如何它都会被系统抛出，而且我还考虑了进程从未开始或使用 close() 方法关闭的情况过程。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-04T16:35:08.997

这取决于您希望此功能有多可靠。如果您想知道您拥有的特定流程实例是否仍在运行并以 100% 的准确率可用，那么您就不走运了。原因是从托管进程对象中只有两种方法可以识别进程。

第一个是进程 ID。不幸的是，进程 ID 不是唯一的，可以回收。在进程列表中搜索匹配的 Id 只会告诉您有一个具有相同 id 的进程正在运行，但不一定是您的进程。

第二项是进程句柄。虽然它与 Id 有相同的问题，但使用起来更尴尬。

如果您正在寻找中等级别的可靠性，那么检查当前进程列表以查找具有相同 ID 的进程就足够了。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-04T16:24:39.690

`Process.GetProcesses()`是要走的路。但是您可能需要使用一个或多个不同的标准来查找您的进程，具体取决于它的运行方式（即作为服务或普通应用程序，是否有标题栏）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-04T16:41:16.880

也许（可能）我读错了问题，但是您是否正在寻找 HasExited 属性，该属性会告诉您 Process 对象表示的进程已退出（正常或不退出）。

如果您引用的进程具有 UI，您可以使用 Responding 属性来确定 UI 当前是否正在响应用户输入。

您还可以设置 EnableRaisingEvents 并处理 Exited 事件（异步发送）或调用 WaitForExit() 如果您想阻止。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-09-24T19:48:10.787

您可以为您想要的进程实例化一次 Process 实例，并继续使用该 .NET Process 对象跟踪该进程（它将继续跟踪，直到您明确调用该 .NET 对象上的 Close，即使它正在跟踪的进程已经死亡[这是为了能够给你进程关闭的时间，也就是 ExitTime 等]）

引用[http://msdn.microsoft.com/en-us/library/fb4aw7b8.aspx](http://msdn.microsoft.com/en-us/library/fb4aw7b8.aspx)：

> 当关联的进程退出时（即，当它被操作系统通过正常或异常终止而关闭时），系统会存储有关该进程的管理信息并返回到调用 WaitForExit 的组件。然后，进程组件可以通过使用已退出进程的句柄来访问包括 ExitTime 在内的信息。
> 
> 因为关联的进程已经退出，组件的 Handle 属性不再指向现有的进程资源。相反，句柄只能用于访问操作系统有关进程资源的信息。系统知道进程组件尚未释放的已退出进程的句柄，因此它会将 ExitTime 和 Handle 信息保存在内存中，直到 Process 组件专门释放资源。出于这个原因，每当您为 Process 实例调用 Start 时，请在关联的流程终止并且您不再需要任何有关它的管理信息时调用 Close。Close 释放分配给已退出进程的内存。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-12-17T17:15:40.757

我尝试了 Coincoin 的解决方案：
在处理某些文件之前，我将其复制为临时文件并打开它。
完成后，如果应用程序仍处于打开状态，我将关闭它并删除临时文件：
我只使用一个 Process 变量，然后检查它：

```
private Process openApplication;  
private void btnOpenFile_Click(object sender, EventArgs e) {  
    ...
    // copy current file to fileCache  
    ...  
    // open fileCache with proper application
    openApplication = System.Diagnostics.Process.Start( fileCache );  
} 
```

后来我关闭了应用程序：

```
 ...   
openApplication.Refresh(); 

// close application if it is still open       
if ( !openApplication.HasExited() ) {
    openApplication.Kill();  
}

// delete temporary file  
System.IO.File.Delete( fileCache ); 
```

它有效（到目前为止）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-07-11T21:07:10.900

```
string process = "notepad";
if (Process.GetProcessesByName(process).Length > 0)
{
    MessageBox.Show("Working");
}
else
{
    MessageBox.Show("Not Working");
} 
```

您也可以使用计时器每次检查过程

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-08-09T03:09:40.813

尽管 .Net 框架支持通过进程 ID 检查现有进程的 API，但这些功能非常慢。运行 Process.GetProcesses() 或 Process.GetProcessById/Name() 会消耗大量 CPU 周期。

通过 ID 检查正在运行的进程的一种更快的方法是使用本机 API [OpenProcess()](https://msdn.microsoft.com/en-us/library/windows/desktop/ms684320(v=vs.85).aspx)。如果返回句柄为 0，则该进程不存在。如果句柄不为 0，则进程正在运行。由于获得许可，无法保证此方法始终 100% 有效。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-04-17T06:45:16.757

与此相关的问题有很多，其他问题似乎已部分解决：

*   不保证任何实例成员都是线程安全的。这意味着在尝试评估对象的属性时，快照的生命周期可能会出现竞争条件。
*   在不允许评估此属性和其他此类属性的权限的情况下，进程句柄将为 ACCESS DENIED 抛出 Win32Exception。
*   对于 ISN'T RUNNING 状态，在尝试评估其某些属性时也会引发 ArgumentException。

无论其他人提到的属性是否是内部的，如果允许，您仍然可以通过反射从它们那里获取信息。

```
var x = obj.GetType().GetProperty("Name", BindingFlags.NonPublic | BindingFlags.Instance); 
```

[您可以为快照](https://docs.microsoft.com/en-us/windows/desktop/ToolHelp/taking-a-snapshot-and-viewing-processes)调用 Win32 代码，也可以使用速度较慢的[WMI 。](https://stackoverflow.com/questions/15269677/how-to-get-all-the-users-processes-in-wmi)

```
HANDLE CreateToolhelp32Snapshot(
  DWORD dwFlags,
  DWORD th32ProcessID
); 
```

另一种选择是[OpenProcess](https://docs.microsoft.com/en-us/windows/desktop/api/processthreadsapi/nf-processthreadsapi-openprocess) / CloseProcess，但您仍然会遇到与以前一样抛出异常的相同问题。

对于 WMI - OnNewEvent.Properties["?"]：

*   “父进程 ID”
*   “进程 ID”
*   “进程名称”
*   “SECURITY_DESCRIPTOR”
*   “会话 ID”
*   “席德”
*   “TIME_CREATED”

# testing - 网络模拟器？

> ID：262282
> 
> 赞同：3
> 
> 时间：2008-11-04T16:13:29.743
> 
> 标签：testing, networking, simulation

您是否知道能够模拟网络条件（例如受限带宽、延迟、关闭端口、拥塞、冲突）的软件？

特定于平台的很好，但我希望能够在不同的网络条件下模拟成百上千个节点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-04T16:33:32.510

您可以查看[ns-2](http://www.isi.edu/nsnam/ns/)或[ns-3](http://www.nsnam.org/)。ns-2 是一个经过良好测试的网络模拟器。ns-3是同一群人的“替代品”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-04T16:15:03.797

Fiddler 可以进行受限带宽和延迟模拟。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T14:34:06.963

[NIST Net](http://snad.ncsl.nist.gov/nistnet/)可以做一些疯狂的网络仿真。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-08T22:58:33.013

这取决于您要模拟的确切内容。Honeyd 允许您为每个虚拟主机创建详细的虚拟网络拓扑，包括不对称路由、数据包丢失、各种 TCP 个性，并让您使用真实系统或进程支持这些虚拟主机或端口。

[http://www.honeyd.org/](http://www.honeyd.org/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-30T19:30:54.163

[这是](https://stackoverflow.com/questions/155329/bandwidth-and-traffic-simulator-for-web-apps#401200)我在回答类似问题时编译的免费和商业流量整形应用程序列表

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-08-19T18:21:17.607

OMNeT++ 你可以模拟你想要的任何类型的网络。也可以创建你的通信协议！ [http://www.omnetpp.org/](http://www.omnetpp.org/)

而且是免费的

# javascript - 使用异步调用时如何从 javascript 更新元刷新？

> ID：262305
> 
> 赞同：4
> 
> 时间：2008-11-04T16:16:08.177
> 
> 标签：javascript, ajax

我有一个使用元刷新到注销页面的系统，该系统在空闲用户后进行清理。（不用担心，服务器也会超时会话）

我开始通过 ajax 进行一些操作（不是真正的 xml，但那不是重点）。我可以运行从异步请求返回的 javascript，所以我想知道是否可以重置页面上的元刷新，以便它有更长的超时时间。通常的 setTimeout 调用只是添加一个新的超时，但它们会替换元超时吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-04T16:18:15.333

不会。当页面加载时，元标记会被解释为实际的 HTTP 标头，并且加载后的更改对其没有影响。

您最好放弃元刷新，并在适当的时候完全依赖 JavaScript 重新加载页面。如果您必须支持没有脚本的客户端，则默认为无脚本页面，该页面利用元刷新结合 JS 重定向到脚本启用（无元刷新）页面，供可以利用它的用户使用。

# java - 更好地理解 OC4J 堆栈跟踪

> ID：262325
> 
> 赞同：1
> 
> 时间：2008-11-04T16:19:58.967
> 
> 标签：java, oracle, jakarta-ee, oc4j

我的任务是在 Oracle 应用服务器版本 10.1.3.0 上部署由第三方构建的应用程序。我已经将它部署在 Oracle 应用服务器版本 10.1.2.0 上，没有什么困难。我收到以下错误：

```
javax.naming.NamingException: Lookup error: javax.naming.AuthenticationException: 
No such domain/application: "etrace"; nested exception is: 
        javax.naming.AuthenticationException: No such domain/application: "etrace" 
        [Root exception is javax.naming.AuthenticationException: No such domain/application: "etrace"]
        at com.evermind.server.rmi.RMIClientContext.lookup(RMIClientContext.java:64)
        at javax.naming.InitialContext.lookup(InitialContext.java:351) 
```

在此之前，应用程序代码实例化和初始化 InitialContext 对象并执行查找方法调用。它传递的值只是一个字符串，其值为被请求的类的完全限定名称 (com.ntc.tracing.app.security.EtraceAuthenticatorService)。查看 InitialContext 对象，我知道它在环境哈希表中设置了以下参数：

```
java.naming.factory.initial: com.evermind.server.rmi.RMIInitialContextFactory
java.naming.provider.url: ormi://ntcdevr310g22:12401/etrace
java.naming.factory.url.pkgs: oracle.oc4j.naming.url
java.naming.security.principal: admin
java.naming.security.credentials: admin1 
```

提供者 url、主体和凭据由我设置（通过命令行）。

我对错误的含义感到困惑。如果我给它一个“坏”的提供者 url 或没有主体并通过，我会得到一个不同的错误 (NullPointerException)。这告诉我它正在访问命名提供程序，但并不是说它找不到类。

任何建议将不胜感激。现在我被难住了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-19T23:10:11.750

冒着陈述一个已知事实的风险（但很有可能它被忽略了）：部署到 OC4J 实例中的ear 应用程序必须通过其描述符中的元素`etrace`显式授予`java.naming.security.principal`密钥中的用户名访问其 JNDI 树的权限。当我们从 WebSphere 迁移应用程序时，我们花了一些时间才弄清楚这一点。`<namespace-access>``orion-application.xml`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-11T09:53:17.763

也许尝试指定应用程序部署的 oc4j 实例？

有关ormi URL 可以采用的所有选项，请参见[http://download.oracle.com/docs/cd/B31017_01/web.1013/b28958/rmi.htm#i1084816 。](http://download.oracle.com/docs/cd/B31017_01/web.1013/b28958/rmi.htm#i1084816)看起来你没有指定它所期望的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T18:42:35.083

我以前见过这样的 JDNI 问题，不管你信不信，问题是 ClassLoader 在多个 JAR 文件中看到了它想要的类。它可以加载类信息，但是在实际实例化对象时，VM 因一个不太有用的 JNDI 错误而发出嘶哑并死亡。

确保您没有导出两个相同的罐子。您可能可以在 OC4J 的企业管理器中检查这一点。

祝你好运！

# networking - 在对等系统中协商公共“网络通道”

> ID：262330
> 
> 赞同：2
> 
> 时间：2008-11-04T16:20:38.653
> 
> 标签：networking, p2p, linden-scripting-language

网络中的对等节点是否有一个通用或已建立的算法来决定一个唯一的“网络通道”（或任何其他形式的半秘密标识符）？

我工作的环境是SecondLife。我试图弄清楚如何让许多相同的对等脚本对象就允许它们形成网络的“通道”编号达成一致，而不会干扰同类对象的其他现有网络。

所有对象大致在同一时间被实例化，并且可以访问（公共）系统时间。

我想到的方法：

1.  基于实例化时间。Channel 是从 unix 时间派生的（通过 md5）。问题是“**大致**相同的时间”部分。它们可能会在新的一秒前被实例化。

2.  随机等待。让对象等待一个随机量，并宣布一个（随机生成的）通道号，该通道号由第一个唤醒的对象决定。问题是，系统的时间粒度较低，在处理公告之前可以唤醒多个对象。

3.  结合 1 和 2。等待一个随机量后宣布一个高分辨率的时间戳，并从最低宣布的时间戳导出频道。

这一定是比我想象的更聪明的人。有更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-22T21:20:52.427

新对象如何知道要加入哪个网络（新的或现有的）？根据您的具体需要，有多种方法。

## 第一种方法

您可以使用比每秒更精确的计时器，例如：

```
integer time = llGetUnixTime();
integer channel = time - (time % 1000); 
```

根据上面的代码，几乎同时重新调整的所有对象都可能具有相同的通道，尽管您可能希望确保 time % 1000 不在 0 或 1000 附近，并且在这种情况下可能使用 time % 10000 。

## 第二种方法

除此之外，您可以创建某种发现协议。例如：

1.  新rezzed对象在硬编码控制通道上打招呼
2.  区域内每个网络的主服务器响应其网络的通道号
3.  对象选择他想加入的网络
4.  如果没有人响应，对象将成为其自己网络的服务器，通过将控制通道增加某个数字（例如 +1）
5.  如果对象无论如何都想创建自己的网络，它将使用的最高通道增加 +1 并创建自己的通道/网络

## 组合

当然，您可以结合使用这两种方法 - 使用 llGetUnixTime() 派生通道，打个招呼，如果服务器响应成为节点，否则成为服务器。此外，您可以检查适当的较高和较低通道，以避免由于对象 rezzing 的时间翻转差异而产生两个网络。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-22T22:34:17.050

您的对象是否被另一个对象重新定位？如果是这样，那么简单的解决方案是在 llRezObject 的整数参数中提供通道号。然后，rezzed（子）对象可以仅使用其 on_rez 事件中的参数作为通道。

例如，rezzer 父级会执行以下操作：

```
integer networkchannel = 3495293;
llRezObject("myobject", rezpos, rezvel, rezrot, networkchannel); 
```

和 rezzed 子对象会做这样的事情：

```
on_rez(integer networkchannel)
{
    llListen(networkchannel, "", NULL_KEY, "");
} 
```

# sql - oracle 过程返回整数

> ID：262338
> 
> 赞同：9
> 
> 时间：2008-11-04T16:21:54.843
> 
> 标签：sql, oracle

在 oracle 中，我想创建一个删除存储过程，它根据删除的结果返回一个整数。

这就是我到目前为止所拥有的。

```
create or replace
PROCEDURE Testing
( 
iKey IN VARCHAR2
)
 AS 

BEGIN
  delete from MyTable WHERE 
  TheKey = iKey;

END Testing; 
```

我试过把一个 RETURNS INTEGER 放进去，但是 sproc 不会编译。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-04T16:29:55.030

过程不返回值。一个函数返回一个值，但您不应该在函数中执行 DML（否则您不能做诸如在 SQL 语句中引用该函数之类的事情，您会混淆权限授予，因为通常 DBA 希望能够授予只读用户访问权限到所有功能，以便用户始终如一地进行计算等）。

您可以在过程中添加 OUT 参数以返回状态。如果“成功”表示更新了一行或多行，则可以使用 SQL%ROWCOUNT 获取之前 SQL 语句修改的行数的计数，并使用它来填充返回参数，即

```
CREATE OR REPLACE PROCEDURE test_proc (
  p_iKey    IN VARCHAR2,
  p_retVal OUT INTEGER
)
AS
BEGIN
  DELETE FROM myTable
   WHERE theKey = p_iKey;

  IF( SQL%ROWCOUNT >= 1 )
  THEN
    p_retVal := 1;
  ELSE
    p_retVal := 0;
  END IF;
END test_proc; 
```

当然，从一般代码清晰度的角度来看，我对似乎试图返回状态代码的 OUT 参数持怀疑态度。通过假设成功并在发生错误时抛出异常通常会更好地为您服务。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-06T22:08:53.020

您可以使用存储过程来返回结果。

```
CREATE OR REPLACE PROCEDURE testing (iKey IN VARCHAR2, oRes OUT NUMBER)
AS
BEGIN
   DELETE FROM MyTable
         WHERE TheKey = iKey;

   oRes := SQL%ROWCOUNT;
END; 
```

要调用该过程，请使用以下内容：

```
DECLARE
   pRes   NUMBER;
BEGIN
   testing ('myspecialkey', pRes);
   DBMS_OUTPUT.put_line (pRes);
END; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-04T17:02:19.630

使用函数和隐式 SQL 游标确定删除的行数

```
create or replace
FUNCTION Testing
( 
iKey IN VARCHAR2
) RETURN INTEGER
 AS 

BEGIN
  delete from MyTable WHERE 
  TheKey = iKey;

  RETURN SQL%ROWCOUNT;

END Testing; 
```

那应该工作

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T16:33:27.580

您可能正在寻找一个功能。

```
FUNCTION TESTING (iKEY IN VARCHAR2) RETURN NUMBER
IS
  v_count NUMBER;
  yourNumber NUMBER;
BEGIN

  SELECT COUNT(*) INTO v_count
  FROM MyTable
  WHERE TheKey = iKey;

  IF v_count > 0
    THEN
       DELETE FROM MyTable 
       WHERE TheKey = iKey;

       SELECT COUNT(*) INTO v_count
       FROM MyTable
       WHERE TheKey = iKey;

       IF (v_count = 0)
         THEN
           yourNumber :=  1; --means successful deletion
       END IF;
  ELSE
       yourNumber := 0; --means no items to delete
  END IF;
  return yourNumber;

  EXCEPTION
      WHEN OTHERS THEN
        RETURN -1; --means error was encountered
END TESTING; 
```

注意：在我工作的地方，我们通常将函数放在 sql 包中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-22T09:06:04.797

`SQL%ROWCOUNT`只会在 DML 之后立即返回一个值，如果执行另一个 DML，它的值将重置。

为了解决我在循环中执行删除的问题，我在 dml 之后发出了以下命令：

```
row_count := row_count + SQL%ROWCOUNT; 
```

请确保您声明并初始化`row_count := 0;`

# .net - 如何将业务逻辑放入我的 ADO.NET Entity Framework 类中？

> ID：262339
> 
> 赞同：4
> 
> 时间：2008-11-04T16:22:00.117
> 
> 标签：.net, linq, entity-framework, linq-to-entities

我想使用 ADO.NET Entity Framework 进行数据访问，为我的业务逻辑扩展它的对象，并将这些对象绑定到我的 UI 中的控件。

正如[另一个问题的答案中](https://stackoverflow.com/questions/260233/how-do-i-extend-adonet-entity-framework-objects-with-partial-classes)所解释的，我无法使用部分类扩展 ADO.NET 实体框架对象并在 LINQ 查询中使用我的自定义方法。

[ADO.NET 实体框架部分类 http://img221.imageshack.us/img221/7329/clientsq0.gif](http://img221.imageshack.us/img221/7329/clientsq0.gif)

我不希望 Intellisense 中出现会产生运行时错误的方法！我应该如何构建我的应用程序以避免这个问题？

[VB.NET LINQ 与自定义方法 http://img83.imageshack.us/img83/1580/iswashingtongn0.gif](http://img83.imageshack.us/img83/1580/iswashingtongn0.gif)

我需要一个数据访问客户端类和一个业务逻辑客户端类吗？这似乎会让人感到困惑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T16:31:04.543

您可以使用（普通旧 C# 对象）POCO 和管理器来构建您的解决方案。

这样您就可以将业务逻辑与值对象分开。

为了让它“看起来漂亮”，您可以在参数上使用 (this) 修饰符标记您的方法，以便您可以将这些方法用作扩展方法。

一个例子可以很清楚地说明这一点：

## 位置值对象：

```
public class Location
{
    public string City { get; set; }
    public string State { get; set; }
} 
```

## 位置经理：

```
public static class LocationManager
{
    public static bool IsWashington(this Location location)
    {
        return location.State == "WA";
    }
} 
```

现在，扩展方法的显示方式将不同于对象上的标准属性/方法。

“IsWashington”方法有两种调用方式

```
Location location = new Location { State = "WA" };
LocationManager.IsWashington(location); 
```

## 或者

```
Location location = new Location { State = "WA" };
location.IsWashington(); 
```

现在您已经分离了业务逻辑和值对象，但您仍然可以进行“漂亮”的方法调用。

如果您觉得您的开发人员（或您:)）会滥用扩展方法部分，那么就不要使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-10T15:31:43.647

我也使用实体框架并首先尝试扩展类，但我很快发现这不是一个好的解决方案，所以我最终创建了新的类（在一个新的类库中），并以 B 为前缀。我没有扩展实体类.

如果我有一个名为 NewsPost 的类，则该业务类名为 BNewsPost，并且与该类相关的所有业务逻辑都在这里收集。用于连接用于放置逻辑的返回元素。

不是一个非常令人兴奋的解决方案，但它成功了。

问候

# c# - 从上传的 Excel 文件中获取数据而不保存到文件系统

> ID：262341
> 
> 赞同：10
> 
> 时间：2008-11-04T16:22:15.450
> 
> 标签：c#, asp.net, excel, web-applications, file-upload

我需要允许此 ASP.NET Web 应用程序的用户上传特定格式的 Excel 电子表格，用电子表格中的数据填充数组，并将数组绑定到 Oracle 存储过程以进行验证并插入数据库。我必须能够从 Excel 电子表格中读取数据，但不能将其保存到 Web 服务器的硬盘上。这是我不知道该怎么做的部分。这是一个简单的代码示例。

```
<%--ASP.NET Declarative--%>
<asp:FileUpload ID="FileUpload1" runat="server" />
<asp:Button ID="Button1" runat="server" Text="Send File" OnClick="Button1_Click" />

// C# Code-Behind
protected void Button1_Click(object sender, EventArgs e) {
    var postedFile = FileUpload1.PostedFile;

    // ... Read file in memory and put in format to send to stored procedure ...

} 
```

谁能帮我这个？我感谢任何人的考虑。

谢谢，
加布

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-06T17:23:56.543

我在 Codeplex 上找到了一个很棒的轻量级开源 API，用于执行此操作，称为 ExcelDataReader。

它可以将 excel 文件的输入流转换为`System.Data.DataSet`对象（可能使用 BIFF 规范进行解析）。

这是链接：

> [http://www.codeplex.com/ExcelDataReader](http://www.codeplex.com/ExcelDataReader)

这是一个代码示例：

```
<%--ASP.NET Declarative--%>
<asp:FileUpload ID="FileUpload1" runat="server" />
<asp:Button ID="Button1" runat="server" Text="Send File" OnClick="Button1_Click" />
<asp:GridView ID="GridView1" runat="server" />

// C# Code-Behind
protected void Button1_Click(object sender, EventArgs e) {
    // the ExcelDataReader takes a System.IO.Stream object
    var excelReader = new ExcelDataReader(FileUpload1.FileContent);
    FileUpload1.FileContent.Close();

    DataSet wb = excelReader.WorkbookData;
    // get the first worksheet of the workbook
    DataTable dt = excelReader.WorkbookData.Tables[0];

    GridView1.DataSource = dt.AsDataView();
    GridView1.DataBind();
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-04T16:25:30.263

使用 FileUpload1。[文件内容](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.fileupload.filecontent.aspx)流。我猜你的 Excel 库可以直接处理流。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-04T23:38:43.743

也许看看 csvreader，它读取 csv、xls 和 xlsx：

[http://www.csvreader.com](http://www.csvreader.com)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-04T16:58:55.237

Excel 的 COM 库不支持从文件以外的其他源加载文件。但是存在很多第三方组件，可以让您读取/写入excel文件。

[否则，您可以在[MS-XLS]：Excel Binary File Format (.xls) Structure Specification](http://msdn.microsoft.com/en-us/library/cc313154.aspx)中查看有关 th XLS 文件格式的文档。

或者，您可以使用与 Sharepoint Server 中相同的办公文件处理方式。请参阅[Microsoft.Office.Excel.Server.WebServices 命名空间](http://msdn.microsoft.com/en-us/library/microsoft.office.excel.server.webservices.aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T17:39:54.140

这是我最近一直在玩的东西。

检查这篇文章：[Write an excel workbook to a memory stream .NET](https://stackoverflow.com/questions/156500/write-an-excel-workbook-to-a-memory-stream-net)

它指向 Carlos Aguilar Mares 的一个很棒的库，它允许您将 Excel 工作簿作为 XML 使用。

[ExcelXMLWriter](http://www.carlosag.net/Tools/ExcelXmlWriter/)

您不需要在服务器上安装 Excel（当您通过 Web 访问它时，这有点破坏 MS 许可）。

您可以使用将 Excel 工作簿作为流加载`Workbook.Load(stream)`

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-11-04T18:27:58.193

您可以让您的用户上传 CSV 文件吗？处理纯文本文件会容易得多。我之前遇到过类似的问题，我问过用户，他们都很好，为我节省了大量的工作。

祝你好运。

# c# - 绑定动态资源

> ID：262343
> 
> 赞同：3
> 
> 时间：2008-11-04T16:22:23.297
> 
> 标签：c#, wpf, data-binding

我正在尝试使用 MultiBinding 作为 ListBox 的 ItemsSource，并且我想将几个集合绑定到 MultiBinding。直到已经实例化宿主控件（Page 的派生）之后，才会填充集合。刚构建完成后，我调用了一个方法，为 Page 设置了一些数据，包括这些集合。

现在，我有这样的事情：

```
public void Setup()
{
    var items = MyObject.GetWithID(backingData.ID); // executes a db query to populate collection  
    var relatedItems = OtherObject.GetWithID(backingData.ID);
} 
```

我想在 XAML 中做这样的事情：

```
<Page ...

  ...

    <ListBox>
        <ListBox.ItemsSource>
            <MultiBinding Converter="{StaticResource converter}">
                <Binding Source="{somehow get items}"/>
                <Binding Source="{somehow get relatedItems}"/>
            </MultiBinding>
        </ListBox.ItemsSource>
    </ListBox>
  ...
</Page> 
```

我知道我不能在绑定中使用 DynamicResource，那我该怎么办？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-04T16:31:42.250

在我看来，您真正想要的是一个[CompositeCollection](http://msdn.microsoft.com/en-us/library/system.windows.data.compositecollection.aspx)并为您的页面设置一个 DataContext。

```
<Page x:Class="MyPage" DataContext="{Binding RelativeSource={RelativeSource Self}}">
    <Page.Resources>
        <CollectionViewSource Source="{Binding Items}" x:Key="items" />
        <CollectionViewSource Source="{Binding RelatedItems}" x:Key="relatedItems" />
    </Page.Resources>

    <ListBox>
       <ListBox.ItemsSource>
         <CompositeCollection>
           <CollectionContainer
             Collection="{StaticResource items}" />
           <CollectionContainer
             Collection="{StaticResource relatedItems}" />
         </CompositeCollection>
       </ListBox.ItemsSource>
    </ListBox>
</Page> 
```

后面的代码看起来像这样：

```
public class MyPage : Page
{
    private void Setup()
    {
        Items = ...;
        RelatedItems = ...;
    }

    public static readonly DependencyProperty ItemsProperty =
        DependencyProperty.Register("Items", typeof(ReadOnlyCollection<data>), typeof(MyPage),new PropertyMetadata(false));
    public ReadOnlyCollection<data> Items
    {
        get { return (ReadOnlyCollection<data>)this.GetValue(ItemsProperty ); }
        set { this.SetValue(ItemsProperty , value); } 
    }

    public static readonly DependencyProperty RelatedItemsProperty =
        DependencyProperty.Register("RelatedItems", typeof(ReadOnlyCollection<data>), typeof(MyPage),new PropertyMetadata(false));
    public ReadOnlyCollection<data> RelatedItems
    {
        get { return (ReadOnlyCollection<data>)this.GetValue(RelatedItemsProperty ); }
        set { this.SetValue(RelatedItemsProperty , value); } 
    }
} 
```

**编辑：**我记得 CollectionContainer 不参与逻辑树，因此您需要使用 CollectionViewSource 和 StaticResource。

# php - 在 SimpleXML for PHP 中删除具有特定属性的子项

> ID：262351
> 
> 赞同：55
> 
> 时间：2008-11-04T16:24:50.610
> 
> 标签：php, xml, dom, simplexml

我使用 SimpleXML 访问了几个具有不同属性的相同元素：

```
<data>
    <seg id="A1"/>
    <seg id="A5"/>
    <seg id="A12"/>
    <seg id="A29"/>
    <seg id="A30"/>
</data> 
```

我需要删除一个特定的**seg**元素，id 为“A12”，我该怎么做？我尝试遍历**seg**元素并*取消设置*特定的元素，但这不起作用，元素仍然存在。

```
foreach($doc->seg as $seg)
{
    if($seg['id'] == 'A12')
    {
        unset($seg);
    }
} 
```

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2013-04-17T14:23:23.217

与现有答案的普遍看法相反，每个 Simplexml 元素节点都可以单独从文档中删除，并且`unset()`. 以防万一，您需要了解 SimpleXML 的实际工作原理。

首先找到要删除的元素：

```
list($element) = $doc->xpath('/*/seg[@id="A12"]'); 
```

`$element`然后删除在您取消设置其*自引用*中表示的元素：

```
unset($element[0]); 
```

这是因为任何元素的第一个元素都是 Simplexml 中的元素本身（自引用）。这与它的神奇特性有关，数字索引表示任何列表中的元素（例如父->子），甚至单个子也是这样的列表。

非数字字符串索引表示属性（在数组访问中）或子元素（在属性访问中）。

因此，属性访问中的数字不合理，例如：

```
unset($element->{0}); 
```

也可以工作。

当然，对于那个 xpath 示例，它相当简单（在 PHP 5.4 中）：

```
unset($doc->xpath('/*/seg[@id="A12"]')[0][0]); 
```

完整的示例代码（[Demo](http://eval.in/16674)）：

```
<?php
/**
 * Remove a child with a specific attribute, in SimpleXML for PHP
 * @link http://stackoverflow.com/a/16062633/367456
 */

$data=<<<DATA
<data>
    <seg id="A1"/>
    <seg id="A5"/>
    <seg id="A12"/>
    <seg id="A29"/>
    <seg id="A30"/>
</data>
DATA;

$doc = new SimpleXMLElement($data);

unset($doc->xpath('seg[@id="A12"]')[0]->{0});

$doc->asXml('php://output'); 
```

输出：

```
<?xml version="1.0"?>
<data>
    <seg id="A1"/>
    <seg id="A5"/>

    <seg id="A29"/>
    <seg id="A30"/>
</data> 
```

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2008-11-04T17:14:48.653

虽然[SimpleXML](http://de.php.net/manual/en/book.simplexml.php)提供[了一种删除](https://stackoverflow.com/a/16062633/367456)XML 节点的方法，但它的修改能力有些有限。另一种解决方案是使用[DOM](http://de.php.net/manual/en/book.dom.php)扩展。[dom_import_simplexml()](http://de.php.net/manual/en/function.dom-import-simplexml.php)将帮助您将您的文件`SimpleXMLElement`转换为`DOMElement`.

只是一些示例代码（使用 PHP 5.2.5 测试）：

```
$data='<data>
    <seg id="A1"/>
    <seg id="A5"/>
    <seg id="A12"/>
    <seg id="A29"/>
    <seg id="A30"/>
</data>';
$doc=new SimpleXMLElement($data);
foreach($doc->seg as $seg)
{
    if($seg['id'] == 'A12') {
        $dom=dom_import_simplexml($seg);
        $dom->parentNode->removeChild($dom);
    }
}
echo $doc->asXml(); 
```

输出

```
<?xml version="1.0"?>
<data><seg id="A1"/><seg id="A5"/><seg id="A29"/><seg id="A30"/></data> 
```

[顺便说一句：当您使用 XPath ( SimpleXMLElement->xpath](http://de.php.net/manual/en/function.simplexml-element-xpath.php) )时，选择特定节点要简单得多：

```
$segs=$doc->xpath('//seq[@id="A12"]');
if (count($segs)>=1) {
    $seg=$segs[0];
}
// same deletion procedure as above 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2008-12-27T06:04:48.597

只需取消设置节点：

```
$str = <<<STR
<a>
  <b>
    <c>
    </c>
  </b>
</a>
STR;

$xml = simplexml_load_string($str);
unset($xml –&gt; a –&gt; b –&gt; c); // this would remove node c
echo $xml –&gt; asXML(); // xml document string without node c 
```

此代码取自[How to delete / remove nodes in SimpleXML](http://www.kavoir.com/2008/12/how-to-delete-remove-nodes-in-simplexml.html)。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-11-25T09:04:49.173

我相信 Stefan 的回答是正确的。如果您只想删除一个节点（而不是所有匹配的节点），这是另一个示例：

```
//Load XML from file (or it could come from a POST, etc.)
$xml = simplexml_load_file('fileName.xml');

//Use XPath to find target node for removal
$target = $xml->xpath("//seg[@id=$uniqueIdToDelete]");

//If target does not exist (already deleted by someone/thing else), halt
if(!$target)
return; //Returns null

//Import simpleXml reference into Dom & do removal (removal occurs in simpleXML object)
$domRef = dom_import_simplexml($target[0]); //Select position 0 in XPath array
$domRef->parentNode->removeChild($domRef);

//Format XML to save indented tree rather than one line and save
$dom = new DOMDocument('1.0');
$dom->preserveWhiteSpace = false;
$dom->formatOutput = true;
$dom->loadXML($xml->asXML());
$dom->save('fileName.xml'); 
```

请注意，加载 XML...（第一个）和 Format XML...（最后一个）部分可以替换为不同的代码，具体取决于您的 XML 数据来自哪里以及您想对输出做什么；它是找到一个节点并将其删除之间的部分。

此外，if 语句仅用于确保目标节点在尝试移动之前存在。您可以选择不同的方式来处理或忽略这种情况。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2010-08-26T17:57:40.383

这对我有用：

```
$data = '<data>
<seg id="A1"/>
<seg id="A5"/>
<seg id="A12"/>
<seg id="A29"/>
<seg id="A30"/></data>';

$doc = new SimpleXMLElement($data);

$segarr = $doc->seg;

$count = count($segarr);

$j = 0;

for ($i = 0; $i < $count; $i++) {

    if ($segarr[$j]['id'] == 'A12') {
        unset($segarr[$j]);
        $j = $j - 1;
    }
    $j = $j + 1;
}

echo $doc->asXml(); 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2010-09-10T19:13:23.877

如果您扩展基本 SimpleXMLElement 类，则可以使用此方法：

```
class MyXML extends SimpleXMLElement {

    public function find($xpath) {
        $tmp = $this->xpath($xpath);
        return isset($tmp[0])? $tmp[0]: null;
    }

    public function remove() {
        $dom = dom_import_simplexml($this);
        return $dom->parentNode->removeChild($dom);
    }

}

// Example: removing the <bar> element with id = 1
$foo = new MyXML('<foo><bar id="1"/><bar id="2"/></foo>');
$foo->find('//bar[@id="1"]')->remove();
print $foo->asXML(); // <foo><bar id="2"/></foo> 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-11-15T15:44:31.830

为了将来参考，使用 SimpleXML 删除节点有时会很痛苦，尤其是当您不知道文档的确切结构时。这就是我编写[SimpleDOM](http://code.google.com/p/simpledom/)的原因，这是一个扩展 SimpleXMLElement 以添加一些便利方法的类。

例如，deleteNodes() 将删除与 XPath 表达式匹配的所有节点。如果你想删除属性“id”等于“A5”的所有节点，你所要做的就是：

```
// don't forget to include SimpleDOM.php
include 'SimpleDOM.php';

// use simpledom_load_string() instead of simplexml_load_string()
$data = simpledom_load_string(
    '<data>
        <seg id="A1"/>
        <seg id="A5"/>
        <seg id="A12"/>
        <seg id="A29"/>
        <seg id="A30"/>
    </data>'
);

// and there the magic happens
$data->deleteNodes('//seg[@id="A5"]'); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-08-29T09:25:13.103

要删除/保留具有特定属性值或属于属性值数组的节点，您可以像这样扩展类（我的[GitHub Gist](https://gist.github.com/KrzysztofPrzygoda/e53223e4450ed35effb75f54826cc434)`SimpleXMLElement`中的最新版本）：

```
class SimpleXMLElementExtended extends SimpleXMLElement
{    
    /**
    * Removes or keeps nodes with given attributes
    *
    * @param string $attributeName
    * @param array $attributeValues
    * @param bool $keep TRUE keeps nodes and removes the rest, FALSE removes nodes and keeps the rest 
    * @return integer Number o affected nodes
    *
    * @example: $xml->o->filterAttribute('id', $products_ids); // Keeps only nodes with id attr in $products_ids
    * @see: http://stackoverflow.com/questions/17185959/simplexml-remove-nodes
    */
    public function filterAttribute($attributeName = '', $attributeValues = array(), $keepNodes = TRUE)
    {       
        $nodesToRemove = array();

        foreach($this as $node)
        {
            $attributeValue = (string)$node[$attributeName];

            if ($keepNodes)
            {
                if (!in_array($attributeValue, $attributeValues)) $nodesToRemove[] = $node;
            }
            else
            { 
                if (in_array($attributeValue, $attributeValues)) $nodesToRemove[] = $node;
            }
        }

        $result = count($nodesToRemove);

        foreach ($nodesToRemove as $node) {
            unset($node[0]);
        }

        return $result;
    }
} 
```

然后拥有您的`$doc`XML，您可以删除您的`<seg id="A12"/>`节点调用：

```
$data='<data>
    <seg id="A1"/>
    <seg id="A5"/>
    <seg id="A12"/>
    <seg id="A29"/>
    <seg id="A30"/>
</data>';

$doc=new SimpleXMLElementExtended($data);
$doc->seg->filterAttribute('id', ['A12'], FALSE); 
```

或删除多个`<seg />`节点：

```
$doc->seg->filterAttribute('id', ['A1', 'A12', 'A29'], FALSE); 
```

仅保留`<seg id="A5"/>`和`<seg id="A30"/>`节点并删除其余节点：

```
$doc->seg->filterAttribute('id', ['A5', 'A30'], TRUE); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-06T03:58:27.430

有一种方法可以通过 SimpleXml 删除子元素。该代码查找一个元素，但什么也不做。否则，它将元素添加到字符串中。然后它将字符串写出到文件中。另请注意，代码会在覆盖原始文件之前保存备份。

```
$username = $_GET['delete_account'];
echo "DELETING: ".$username;
$xml = simplexml_load_file("users.xml");

$str = "<?xml version=\"1.0\"?>
<users>";
foreach($xml->children() as $child){
  if($child->getName() == "user") {
      if($username == $child['name']) {
        continue;
    } else {
        $str = $str.$child->asXML();
    }
  }
}
$str = $str."
</users>";
echo $str;

$xml->asXML("users_backup.xml");
$myFile = "users.xml";
$fh = fopen($myFile, 'w') or die("can't open file");
fwrite($fh, $str);
fclose($fh); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-03-17T10:55:20.977

一个新想法：`simple_xml`作为一个数组工作。

我们可以搜索要删除的“数组”的索引，然后使用`unset()`函数删除这个数组索引。我的例子：

```
$pos=$this->xml->getXMLUser();
$i=0; $array_pos=array();
foreach($this->xml->doc->users->usr[$pos]->u_cfg_root->profiles->profile as $profile) {
    if($profile->p_timestamp=='0') { $array_pos[]=$i; }
    $i++;
}
//print_r($array_pos);
for($i=0;$i<count($array_pos);$i++) {
    unset($this->xml->doc->users->usr[$pos]->u_cfg_root->profiles->profile[$array_pos[$i]]);
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-08-21T13:50:55.470

[关于辅助函数的想法来自php.net](http://pl.php.net/manual/pl/domnode.removechild.php)上对 DOM 的评论之一，关于使用 unset 的想法来自[kavoir.com](http://www.kavoir.com/2008/12/how-to-delete-remove-nodes-in-simplexml.html)。对我来说，这个解决方案终于奏效了：

```
function Myunset($node)
{
 unsetChildren($node);
 $parent = $node->parentNode;
 unset($node);
}

function unsetChildren($node)
{
 while (isset($node->firstChild))
 {
 unsetChildren($node->firstChild);
 unset($node->firstChild);
 }
} 
```

使用它： $xml 是 SimpleXmlElement

```
Myunset($xml->channel->item[$i]); 
```

结果存储在 $xml 中，因此不必担心将其分配给任何变量。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-10-11T13:45:51.573

尽管 SimpleXML 没有删除元素的详细方法，但您*可以*使用 PHP 的`unset()`. 做到这一点的关键是设法定位所需的元素。至少一种进行定位的方法是使用元素的顺序。首先找出要删除的元素的订单号（例如使用循环），然后删除该元素：

```
$target = false;
$i = 0;
foreach ($xml->seg as $s) {
  if ($s['id']=='A12') { $target = $i; break; }
  $i++;
}
if ($target !== false) {
  unset($xml->seg[$target]);
} 
```

您甚至可以通过将目标项目的订单号存储在数组中来删除多个元素。请记住以相反的顺序进行移除 ( `array_reverse($targets)`)，因为移除一个项目自然会减少其后项目的订单号。

诚然，这有点像hackaround，但它似乎工作正常。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-05-22T12:29:01.663

我也在为这个问题而苦苦挣扎，答案比这里提供的要容易得多。您可以使用 xpath 查找它并使用以下方法取消设置它：

```
unset($XML->xpath("NODESNAME[@id='test']")[0]->{0}); 
```

此代码将查找一个名为“NODESNAME”的节点，其 id 属性为“test”，并删除第一个出现的节点。

记得使用 $XML->saveXML(...) 保存 xml；

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-07-02T13:15:01.567

由于我遇到了和 Gerry 一样的致命错误，而且我对 DOM 不熟悉，所以我决定这样做：

```
$item = $xml->xpath("//seg[@id='A12']");
$page = $xml->xpath("/data");
$id = "A12";

if (  count($item)  &&  count($page) ) {
    $item = $item[0];
    $page = $page[0];

     // find the numerical index within ->children().
    $ch = $page->children();
    $ch_as_array = (array) $ch;

    if (  count($ch_as_array)  &&  isset($ch_as_array['seg'])  ) {
        $ch_as_array = $ch_as_array['seg'];
        $index_in_array = array_search($item, $ch_as_array);
        if (  ($index_in_array !== false)
          &&  ($index_in_array !== null)
          &&  isset($ch[$index_in_array])
          &&  ($ch[$index_in_array]['id'] == $id)  ) {

             // delete it!
            unset($ch[$index_in_array]);

            echo "<pre>"; var_dump($xml); echo "</pre>";
        }
    }  // end of ( if xml object successfully converted to array )
}  // end of ( valid item  AND  section ) 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-01-23T23:33:03.310

使用[**FluidXML**](https://github.com/servo-php/fluidxml)，您可以使用 XPath 选择要删除的元素。

```
$doc = fluidify($doc);

$doc->remove('//*[@id="A12"]'); 
```

[https://github.com/servo-php/fluidxml](https://github.com/servo-php/fluidxml)

* * *

XPath`//*[@id="A12"]`意味着：

*   在文件的任何一点 ( `//`)
*   每个节点 ( `*`)
*   属性`id`等于`A12`( `[@id="A12"]`)。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-03-09T09:07:22.943

如果您想剪切相似（非唯一）子元素的列表，例如 RSS 提要的项目，您可以使用以下代码：

```
for ( $i = 9999; $i > 10; $i--) {
    unset($xml->xpath('/rss/channel/item['. $i .']')[0]->{0});
} 
```

它将RSS的尾部减少到10个元素。我试图删除

```
for ( $i = 10; $i < 9999; $i ++ ) {
    unset($xml->xpath('/rss/channel/item[' . $i . ']')[0]->{0});
} 
```

但它以某种方式随机工作并且只削减了一些元素。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-09-30T12:59:56.340

我有一个类似的任务 - 删除已经具有指定属性的子元素。换句话说，删除 xml 中的重复项。我有以下xml结构：

```
<rups>
    <rup id="1">
         <profiles> ... </profiles>
         <sections>
             <section id="1.1" num="Б1.В" parent_id=""/>
             <section id="1.1.1" num="Б1.В.1" parent_id="1.1"/>
             ...
             <section id="1.1" num="Б1.В" parent_id=""/>
             <section id="1.1.2" num="Б1.В.2" parent_id="1.1"/>
             ...
         </sections>
    </rup>
    <rup id="2">
         ...
    </rup>
    ...
 </rups> 
```

例如，`rups/rup[@id='1']/sections/section[@id='1.1']`元素是重复的，我只需要留下第一个。我正在使用对元素数组的引用，loop-for 和 unset()：

```
$xml = simplexml_load_file('rup.xml');
foreach ($xml->rup as $rup) {
    $r_s = [];
    $bads_r_s = 0;
    $sections = &$rup->sections->section;
    for ($i = count($sections)-1; $i >= 0; --$i) {
        if (in_array((string)$sections[$i]['id'], $r_s)) {
            $bads_r_s++;
            unset($sections[$i]);
            continue;
        }
        $r_s[] = (string)$sections[$i]['id'];
    }
}
$xml->saveXML('rup_checked.xml'); 
```

* * *

## 回答 #18

> 赞同：-2
> 
> 时间：2010-03-13T02:36:25.567

您最初的方法是正确的，但是您忘记了关于 foreach 的一点小事。它不适用于原始数组/对象，但会在迭代时创建每个元素的副本，因此您确实取消了副本。像这样使用参考：

```
foreach($doc->seg as &$seg) 
{
    if($seg['id'] == 'A12')
    {
        unset($seg);
    }
} 
```

# database - 关于动态条目的数据库设计 - 一行还是多行？

> ID：262361
> 
> 赞同：1
> 
> 时间：2008-11-04T16:27:49.137
> 
> 标签：database, schema, rows

我一直在尝试为一个副项目设计一个数据库模式，但我无法生成任何我喜欢的东西。我正在使用带有 LINQ 的 ASP.Net 进行数据访问：

我将允许用户指定最多 10 个“项目”，每个项目具有 2 个数字属性和 1 个引用属性，即项目名称。

如果我将此条目放入 1 行，它很容易等于大约 30+ 列（最少），例如 item_1_name (ref) item_1_weight item_1_volume item_2_name...等...

而且我不能简单地将这些列变成参考表，因为每个属性的范围基本上可以从 1 到 400+。

我还认为，如果用户只决定将 1 项放入他们的条目中，那么我为该数据创建对象的方法将是静态的，就像 LINQ 一样，我必须检查属性和诸如此类的东西是否为 NULL 并相应地工作. 此外，如果我想增加条目中允许的项目数量，使用起来会很头疼。

我想到的另一个选择是简单地为每个项目创建一行并将其与条目 ID 绑定。所以我基本上永远不会有空条目，但我的表会变得非常深，但不会很宽，因为只有大约 5 个奇数列。

我的设计中是否有一些我忽略的东西/是否有更好和有效的方法来做到这一点？

编辑：当我说它将以天文数字增长时，我的意思是：用户可以创建一个条目，每个条目很可能有一组项目。因此，假设他们每天访问该站点 1 个条目，他们可以拥有 3 组项目，最大项目数 (10)，这相当于该唯一条目的 30 个项目。以该速率每周输入一个条目，您可以为该单个用户提供 210 行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T16:43:12.290

我推荐你提到的后一种设计，创建一个包含五列的依赖表：

```
CREATE TABLE Items (
  user_id               INTEGER NOT NULL,
  item_id               INTEGER NOT NULL DEFAULT 1,
  numeric_property1     INTEGER,
  numeric_property2     INTEGER,
  referential_property  INTEGER,
  PRIMARY KEY (user_id, item_id),
  FOREIGN KEY (user_id) REFERENCES Users(user_id)
                        ON DELETE CASCADE,
  FOREIGN KEY (item_id) REFERENCES num_items(item_id),
  FOREIGN KEY (referential_property) REFERENCES some_other_table(some_column)
); 
```

我在上面显示了一个表格`num_items`，如果您想将用户最多限制为 10 个项目，则其中包含数字 1 到 10：

```
CREATE TABLE num_items (item_id INTEGER NOT NULL );
INSERT INTO num_items (item_id) 
  VALUES (1), (2), (3), (4), (5), (6), (7), (8), (9), (10); 
```

这种设计的优点是很`COUNT()`容易计算给定用户有多少项目，很容易计算诸如给定属性之类的东西`MIN()`，`MAX()`您可以为引用属性强制执行外键等。

某些数据库具有将复合主键的第二部分（`item_id`在这种情况下）声明为自动递增的功能，因此如果您指定值`entity_id`但省略`item_id`它会自动获取下一个未使用的值（但如果您删除则不会填补空白一）。您没有说明您使用的是哪个品牌的数据库，所以我会留给您来确定此功能。

**编辑：**正如托尼安德鲁斯在他的回答中所说，行数不是问题。您没有说明您打算使用哪个品牌的数据库，但除非您选择像 MS Access 这样特别弱的产品，否则您可以依靠数据库轻松处理数百万行。如果您选择好索引，并编写使用这些索引的查询，那么效率应该不是问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T16:38:45.993

使用单个项目表：

userId、itemIndex、isReference、numericValue、referenceValue

这样，用户 999 的 item_3_name 的值转换为

999,3,true,null,值

您必须自己强制执行某些约束，例如每个用户的最大项目数等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T16:43:19.417

正确的数据库设计是将每个用户/项目存储在单独的行中。这将更容易使用，并消除了 10 项的任意限制。我不会说它会增长“天文数字”，大约会有 10 x（用户数量）行。

# java - 如何让 Java 从 Gnome 的当前目录执行 jars？

> ID：262362
> 
> 赞同：4
> 
> 时间：2008-11-04T16:27:50.010
> 
> 标签：java, linux, path, gnome

在带有 Gnome 的 Ubuntu Linux 上，通过在 Gnomes 文件浏览器中双击 jar 文件来运行我的 Swing 应用程序会导致错误，因为找不到通过 Java 插件框架（位于子目录中）动态加载的所需库。

正如我的可执行 jar 的清单文件中所述，框架本身的基本库已正确解析。但是，一旦框架启动，就找不到插件（甚至没有指定我的平台的插件）。

通过从终端启动应用程序

```
java -jar myjar.jar

```

就像一个魅力，广告确实通过双击一个shell脚本来运行应用程序。

但是，我想避免使用终端窗口。（我是一个 Windows 人，也许它不会像它惹恼那些在 Windows 上的人一样惹恼 linux 人。）

这个问题可以在多个 Linux 系统中重现。我需要做些什么来让 Java 正确解析库吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T16:49:31.637

我相信如果您向 jar 添加一个 META-INF/MANIFEST.MF 文件，其中包含“Classpath:”属性，其值指定您需要的 jar 的相对路径（我不确定它们是空格还是逗号分隔)，这可能有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T18:37:21.420

您可能需要检查：[commons launcher](http://commons.apache.org/launcher/)。它会给你一个简单的可执行文件，可以用来做各种启动准备（包括设置类路径等）。很可能这对您的问题来说是多余的，但是您可以尝试一下（我会在您的情况下尝试它，只是因为我讨厌脚本）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T17:26:13.560

正如大卫建议的那样，您可以`Class-Path`在 jar 中添加 manifest 属性以获得更多[jar 清单，Class-Path](http://java.sun.com/docs/books/tutorial/deployment/jar/downman.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T16:36:09.307

Java 在其类路径中按顺序加载 jar，即 jar1:jar2:jar3... 大多数 Java 应用程序都附带某种脚本，通过指定类路径和应用程序需要的 jar 列表来设置所有这些。

您想要做的事情可能不是非常可取的，因为这意味着全局指定要随每个 java 应用程序加载的 jar 集合，并且您可能会与应用程序附带的任何库产生冲突。

这不是一个真正的问题，最简单的解决方案可能是组合一个小的 shell 脚本启动器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T17:00:48.400

您可以编写一个 shell 脚本来启动，这就是您调用或创建启动器的内容。这是有关如何在多个平台上执行此操作的快速“教程”。

[http://java.sys-con.com/node/37130](http://java.sys-con.com/node/37130)

下面是 Eclipse 的做法。可能会给你一些想法：

[http://help.eclipse.org/stable/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/misc/launcher.html](http://help.eclipse.org/stable/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/misc/launcher.html)

祝你好运！

# java - jQuery Ajax 错误解决

> ID：262363
> 
> 赞同：3
> 
> 时间：2008-11-04T16:28:04.130
> 
> 标签：java, jquery, ajax, error-handling, stripes

我正在开发一个条纹应用程序，它使用一点 jQuery 来使 UI 更加动态/可用。

我设置了错误解决方案，因此如果抛出错误，用户将被重定向到 error.jsp 页面。

但是，如果在 jQuery Ajax 调用期间抛出错误，而不是重定向到 error.jsp 页面，我会将 html 打印到应该是调用结果的页面上。

如果抛出异常而不是打印到页面，我如何告诉 jQuery 重定向？

有问题的 Ajax 示例：

```
$.post("SendStatusEmail.action",
            {status: newstatus, id : id },
            function(data) {
                column.text(data);
                column.addClass("redfont");
                column.parent().fadeOut(3000, function(){column.parent().remove()}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T13:51:54.113

使用 $.ajax() 而不是 $.post() 怎么样？更通用的 $.ajax() 提供了一个错误回调，您可以在发生错误时调用它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-04T16:52:21.863

```
$(document).ajaxError(function(event, XMLHttpRequest, ajaxOptions, thrownError) {
    // redirect here.
} 
```

我应该补充一点，当 Ajax 调用中出现异常时，我不会重定向。相反，我让服务器以 JSON 格式返回错误描述并将其显示在页面中。

# java - 如何为 URLStreamHandler 提供上下文？

> ID：262364
> 
> 赞同：0
> 
> 时间：2008-11-04T16:28:30.260
> 
> 标签：java, url

我们的应用程序定义了一个 URL 方案，其分辨率是上下文相关的： URL 的内容取决于正在进行的数据库事务的状态。因此，要检索内容，例如，我不能打开一个新的数据库连接。但是，我看不到从`URLStreamHandler`实例获取外部上下文的方法。

该文档也有点误导：我检查[了 java Protocol Handler](http://java.sun.com/developer/onlineTraining/protocolhandlers/)站点，它表明（在*实现 URLStreamHandlerFactory*部分中）该 URL 类将接受一个`URLStreamHandlerFactory`实例，但 1.5 JDK 表明 URL`URLStreamHandler`在构建 URL 时只接受.

所以，我的问题是，获得上下文相关 URL 解析的最佳方式是什么？有没有比在我的实现中设置一个`ThreadLocal`类变量更好的方法，即在调用之前设置？`URLStreamHandler`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T16:57:20.950

请参阅[URL.setURLStreamHandlerFactory](http://java.sun.com/j2se/1.5.0/docs/api/java/net/URL.html#setURLStreamHandlerFactory(java.net.URLStreamHandlerFactory))

这是一个静态方法，并且：

> 设置应用程序的 URLStreamHandlerFactory。此方法在给定的 Java 虚拟机中最多可以调用一次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-09T22:08:52.783

事实证明，至少就我们的目的而言，线程本地上下文对象效果最好。

# java - 类型安全：未经检查的演员表

> ID：262367
> 
> 赞同：307
> 
> 时间：2008-11-04T16:29:03.207
> 
> 标签：java, spring, type-safety, unchecked

在我的 spring 应用程序上下文文件中，我有类似的内容：

```
<util:map id="someMap" map-class="java.util.HashMap" key-type="java.lang.String" value-type="java.lang.String">
    <entry key="some_key" value="some value" />
    <entry key="some_key_2" value="some value" />   
</util:map> 
```

在 java 类中，实现如下所示：

```
private Map<String, String> someMap = new HashMap<String, String>();
someMap = (HashMap<String, String>)getApplicationContext().getBean("someMap"); 
```

在 Eclipse 中，我看到一条警告说：

**类型安全：从 Object 到 HashMap<String,String> 的未经检查的强制转换**

什么地方出了错？

* * *

## 回答 #1

> 赞同：358
> 
> 时间：2008-11-04T17:09:19.927

`HashMap<String,String>`问题是强制转换是运行时检查 - 但由于类型擦除，在运行时实际上 a和`HashMap<Foo,Bar>`对于任何其他的`Foo`和没有区别`Bar`。

使用`@SuppressWarnings("unchecked")`并握住你的鼻子。哦，还有 Java 中的物化泛型运动 :)

* * *

## 回答 #2

> 赞同：278
> 
> 时间：2008-11-04T16:44:07.763

嗯，首先，你在用 new `HashMap`creation 调用浪费内存。您的第二行完全忽略了对这个创建的 hashmap 的引用，使其可供垃圾收集器使用。所以，不要那样做，使用：

```
private Map<String, String> someMap = (HashMap<String, String>)getApplicationContext().getBean("someMap"); 
```

其次，编译器抱怨您将对象转换为 a`HashMap`而没有检查它是否是 a `HashMap`。但是，即使你要这样做：

```
if(getApplicationContext().getBean("someMap") instanceof HashMap) {
    private Map<String, String> someMap = (HashMap<String, String>)getApplicationContext().getBean("someMap");
} 
```

您可能仍会收到此警告。问题是，`getBean`返回`Object`，所以不知道类型是什么。将其`HashMap`直接转换为不会导致第二种情况出现问题（也许在第一种情况下不会出现警告，我不确定 Java 编译器对 Java 5 的警告有多迂腐）。但是，您将其转换为`HashMap<String, String>`.

HashMaps 实际上是将对象作为键并将对象作为值的映射，`HashMap<Object, Object>`如果您愿意的话。因此，不能保证当你得到你的 bean 时它可以表示为 a`HashMap<String, String>`因为你可以有`HashMap<Date, Calendar>`，因为返回的非泛型表示可以有任何对象。

如果代码编译，并且您可以在`String value = map.get("thisString");`没有任何错误的情况下执行，请不要担心此警告。但是，如果映射不完全是字符串值的字符串键，您将`ClassCastException`在运行时得到 a，因为在这种情况下泛型无法阻止这种情况发生。

* * *

## 回答 #3

> 赞同：109
> 
> 时间：2012-11-14T21:46:20.857

如上面的消息所示，列表无法区分 a`List<Object>`和 a`List<String>`或`List<Integer>`。

我已经解决了类似问题的此错误消息：

```
List<String> strList = (List<String>) someFunction();
String s = strList.get(0); 
```

具有以下内容：

```
List<?> strList = (List<?>) someFunction();
String s = (String) strList.get(0); 
```

说明：第一次类型转换验证对象是 List 而不关心其中包含的类型（因为我们无法在 List 级别验证内部类型）。现在需要进行第二次转换，因为编译器只知道 List 包含某种对象。这将在访问列表时验证列表中每个对象的类型。

* * *

## 回答 #4

> 赞同：35
> 
> 时间：2008-11-04T16:44:24.970

警告就是这样。一个警告。有时警告是无关紧要的，有时则不是。它们用于提醒您注意编译器认为可能是问题但可能不是问题的事情。

在强制转换的情况下，它总是会在这种情况下发出警告。如果您绝对确定特定演员表是安全的，那么您应该考虑在该行之前添加这样的注释（我不确定语法）：

```
@SuppressWarnings (value="unchecked") 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-11-04T16:44:59.460

您收到此消息是因为 getBean 返回一个 Object 引用，并且您正在将其转换为正确的类型。Java 1.5 给你一个警告。这就是使用 Java 1.5 或更好的代码来运行这样的代码的本质。Spring 有类型安全的版本

```
someMap=getApplicationContext().getBean<HashMap<String, String>>("someMap"); 
```

在它的待办事项清单上。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2016-04-13T15:55:31.927

如果您真的想摆脱警告，您可以做的一件事是创建一个从泛型类扩展的类。

例如，如果您尝试使用

```
private Map<String, String> someMap = new HashMap<String, String>(); 
```

您可以像这样创建一个新类

```
public class StringMap extends HashMap<String, String>()
{
    // Override constructors
} 
```

然后当你使用

```
someMap = (StringMap) getApplicationContext().getBean("someMap"); 
```

编译器确实知道（不再是通用的）类型是什么，并且不会发出警告。这可能并不总是完美的解决方案，有些人可能会认为这种方式违背了泛型类的目的，但是您仍然在重用泛型类中的所有相同代码，您只是在编译时声明什么类型你想用。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-12-16T14:23:25.227

**下面的代码导致类型安全警告**

`Map<String, Object> myInput = (Map<String, Object>) myRequest.get();`

> **解决方法**

创建一个新的地图对象而不提及参数，因为未验证列表中包含的对象类型。

***第 1 步：***创建一个新的临时地图

`Map<?, ?> tempMap = (Map<?, ?>) myRequest.get();`

***第二步：***实例化主地图

```
Map<String, Object> myInput=new HashMap<>(myInputObj.size()); 
```

***第 3 步：***迭代临时 Map 并将值设置到主 Map

```
 for(Map.Entry<?, ?> entry :myInputObj.entrySet()){
        myInput.put((String)entry.getKey(),entry.getValue()); 
    } 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2018-08-28T15:13:34.890

避免未经检查的警告的解决方案：

```
class MyMap extends HashMap<String, String> {};
someMap = (MyMap)getApplicationContext().getBean("someMap"); 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-10-20T19:25:17.597

另一种解决方案是，如果您发现自己经常投射相同的对象并且不想在代码中乱扔`@SupressWarnings("unchecked")`, 将创建一个带有注释的方法。这样你就可以集中演员表，并希望减少出错的可能性。

```
@SuppressWarnings("unchecked")
public static List<String> getFooStrings(Map<String, List<String>> ctx) {
    return (List<String>) ctx.get("foos");
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2019-08-12T14:02:22.150

> 我做错什么了？我该如何解决这个问题？

这里 ：

`Map<String,String> someMap = (Map<String,String>)getApplicationContext().getBean("someMap");`

您使用了我们通常不想使用的遗留方法，因为它返回`Object`：

```
Object getBean(String name) throws BeansException; 
```

有利于从 bean 工厂获取（对于单例）/创建（对于原型）bean 的方法是：

```
<T> T getBean(String name, Class<T> requiredType) throws BeansException; 
```

使用它，例如：

```
Map<String,String> someMap = app.getBean(Map.class,"someMap"); 
```

将编译但仍带有未经检查的转换警告，因为所有`Map`对象不一定都是`Map<String, String>`对象。

但是`<T> T getBean(String name, Class<T> requiredType) throws BeansException;`在 bean 泛型类（例如泛型集合）中还不够，因为这需要指定多个类作为参数：集合类型及其泛型类型。

在这种情况下，一般来说，更好的方法不是直接使用`BeanFactory`方法，而是让框架注入 bean。

bean声明：

```
@Configuration
public class MyConfiguration{

    @Bean
    public Map<String, String> someMap() {
        Map<String, String> someMap = new HashMap();
        someMap.put("some_key", "some value");
        someMap.put("some_key_2", "some value");
        return someMap;
    }
} 
```

豆子注入：

```
@Autowired
@Qualifier("someMap")
Map<String, String> someMap; 
```

# sharepoint - Word 2007 或 SharePoint 将我的“RevNum”字段设置为“2”

> ID：262376
> 
> 赞同：5
> 
> 时间：2008-11-04T16:31:39.863
> 
> 标签：sharepoint, ms-office

在将`.docx`文件“签入”`SharePoint`并对其进行编辑后，该`RevNum`属性设置为`2`.

这没有意义，有人可以解释这是为什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-06T17:26:57.487

您可以通过转到文档库设置->版本设置并选择以下选项之一来更改文档版本历史记录

*   无版本控制
*   创建主要版本
*   创建主要和次要（草稿）版本

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T21:40:28.710

据我了解，最初创建的修订版 1 和来自编辑的修订版 2。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-14T22:19:57.200

谢谢您的回答！看来我问的问题不够准确。

问题是，**RevNum**被设置**回 2，** *即使它之前更高*：

1.  **.docx**的**RevNum 为 31**
2.  查看文档
3.  更改文档（**RevNum 32**）
4.  再次更改（**RevNum 33**）...
5.  签入**SharePoint**
6.  **RevNum 2**

我的意思是**Word的****RevNum** “属性” ，*而不是***SharePoint**。修订号应该是唯一的，并在每次更改后递增。

 ******我假设会发生以下情况：*

当签入发生时，将重新创建文档（从本地草稿文件夹复制到服务器位置），因此 RevNum 以 1 开头，更改 (?) 和 RevNum 2 ...也许这是 SharePoint 中的一个错误。“RevNum back to 2”仅在使用签入/签出时发生。当“正常”编辑它时，它会正确增加 RevNum。

# dll - labview CIN 是老式的吗？

> ID：262378
> 
> 赞同：3
> 
> 时间：2008-11-04T16:31:48.863
> 
> 标签：dll, labview, cin

我正在使用 labview 编写应用程序，需要使用外部代码。我读过使用 CIN 是过时的并且使用“错误”。它是否正确？我应该改用共享 dll 吗？

这两种方法的优点/缺点是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-05T14:18:56.213

我没有编写 LabVIEW 调用的外部代码的个人经验，但来自[NI 知识库](http://digital.ni.com/public.nsf/allkb/292A50C1FEAB6B4D86256FB9001AE6D6)：“当有选择时，DLL 就是选择。”

他们列出的优势包括：

*   许多进程可以在内存中共享 DLL 的单个副本
*   许多应用程序可以共享磁盘上 DLL 的单个副本
*   修改 DLL 中的函数不需要重新编译调用应用程序
*   仅支持某些（过时的？）开发环境来创建 CIN。

DLL 的潜在缺点是：

*   上面列表中的前两项；-)
*   从 LabVIEW 构建应用程序时，您需要记住将 DLL 作为支持文件包含在内
*   CIN 代码可以独立于平台，而 DLL/共享库可能需要为每个平台重写。

我很确定，在我关注 LabVIEW 列表和论坛的几年中，每次看到这个讨论时，建议都是一样的：CIN 已过时，使用 DLL - 请注意它们可能导致的潜在问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T19:00:00.750

感谢 nekomatic 的回答。如果其他人对此感兴趣，我从互联网深处找到了[一篇文章](http://expressionflow.com/2007/05/19/external-code-in-labview-part2-comparison-between-shared-libraries-and-cins/)，解释了这两种方法的优缺点。原来 CINS 在 labview 8.20 之前比共享 dll 有优势，但现在它们已经过时了。

[FTA：](http://expressionflow.com/2007/05/19/external-code-in-labview-part2-comparison-between-shared-libraries-and-cins/)与使用调用库节点相比，CIN 基本上不再有一个单一的优势，而是有很多缺点

# c - 对于严格的指针别名，char* 何时安全？

> ID：262379
> 
> 赞同：27
> 
> 时间：2008-11-04T16:31:50.860
> 
> 标签：c, sockets, strict-aliasing

我一直在尝试理解严格的别名规则，因为它们适用于 char 指针。

[这里](http://cellperformance.beyond3d.com/articles/2006/06/understanding-strict-aliasing.html#cast_to_char_pointer)说明：

> 始终假定 char* 可以引用任何对象的别名。

好的，所以在套接字代码的上下文中，我可以这样做：

```
struct SocketMsg
{
   int a;
   int b;
};

int main(int argc, char** argv)
{
   // Some code...
   SocketMsg msgToSend;
   msgToSend.a = 0;
   msgToSend.b = 1;
   send(socket, (char*)(&msgToSend), sizeof(msgToSend);
}; 
```

但是有这样的声明

> 反之则不成立。将 char* 转换为除 char* 之外的任何类型的指针并取消引用它通常违反严格的别名规则。

这是否意味着当我接收一个 char 数组时，当我知道消息的结构时，我无法重新解释转换为结构：

```
struct SocketMsgToRecv
{
    int a;
    int b;
};

int main()
{
    SocketMsgToRecv* pointerToMsg;
    char msgBuff[100];
    ...
    recv(socket, msgBuff, 100);
    // Ommiting make sure we have a complete message from the stream
    // but lets assume msgBuff[0]  has a complete msg, and lets interpret the msg

    // SAFE!?!?!?
    pointerToMsg = &msgBuff[0];

    printf("Got Msg: a: %i, b: %i", pointerToMsg->a, pointerToMsg->b);
} 
```

由于基类型是 char 数组并且我将其转换为结构，因此第二个示例不起作用吗？在一个严格别名的世界里，你如何处理这种情况？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-04T20:19:04.710

回复@Adam Rosenfield：只要 char* 的供应商开始做类似的事情，工会就会实现对齐。

退后一步弄清楚这一切可能是有用的。

别名规则的基础是编译器可以将不同简单类型的值放在不同的内存边界上以改进访问，并且硬件在某些情况下可能需要这种对齐才能完全使用指针。这也可以出现在有各种不同大小元素的结构中。该结构可以在良好的边界上开始。此外，编译器可能仍会在结构内部引入松弛位，以完成需要它的结构元素的正确对齐。

考虑到编译器通常具有控制如何处理所有这些的选项，您可以看到有很多方式可能会发生意外。在将指向结构的指针（转换为 char* 或不转换为 char* 或不转换为）传递到编译为期望不同对齐约定的库时，这一点尤为重要。

char* 呢？

关于 char* 的假设是 sizeof(char) == 1 （相对于所有其他相当大的数据的大小）并且 char* 指针没有任何对齐要求。因此，真正的 char* 始终可以安全地传递并成功使用，而无需担心对齐，这适用于 char[] 数组的任何元素，在指针上执行 ++ 和 -- 等等。（奇怪的是， void* 并不完全相同。）

现在您应该能够看到，如果将某种结构数据传输到本身未正确对齐的 char[] 数组中，尝试强制转换回需要对齐的指针可能是一个严重的问题。

如果您将 char[] 数组和结构合并，编译器将遵循最苛刻的对齐方式（即结构的对齐方式）。如果供应商和消费者有效地使用匹配联合，这将起作用，以便将 struct* 转换为 char* 并返回工作正常。

在这种情况下，我希望数据在指向它的指针被强制转换为 char* 或以任何其他方式作为 sizeof(char) 字节数组传输之前在类似的联合中创建。确保任何编译器选项在所依赖的库和您自己的代码之间兼容也很重要。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-04T16:37:48.930

正确，第二个例子违反了严格的别名规则，所以如果你用这个`-fstrict-aliasing`标志编译，你可能会得到不正确的目标代码。完全正确的解决方案是在这里使用联合：

```
union
{
  SocketMsgToRecv msg;
  char msgBuff[100];
};

recv(socket, msgBuff, 100);

printf("Got Msg: a: %i, b: %i", msg.a, msg.b); 
```

# windows - Qt：如何为主窗口小部件制作阴影？

> ID：262380
> 
> 赞同：2
> 
> 时间：2008-11-04T16:32:07.367
> 
> 标签：windows, qt, shadow

如何在使用 Qt 的窗口上为主窗口小部件制作阴影？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T14:19:55.790

可以从 QT 中心找到相关问题的解决方案和许多其他 qt 问题： [http ://www.qtcentre.org](http://www.qtcentre.org)

至少看起来不错的一种解决方案的直接路径是： [http ://wiki.qtcentre.org/index.php?title=ARGB-Widgets](http://wiki.qtcentre.org/index.php?title=ARGB-Widgets)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-04T16:46:03.670

应用程序通常不会创建阴影，这取决于窗口管理器。您可以通过各种邪恶的技巧来伪造它，例如创建另一个作为阴影颜色的无边框窗口并将其放在主窗口下。

# ssh - 安全文件传输

> ID：262390
> 
> 赞同：0
> 
> 时间：2008-11-04T16:34:54.957
> 
> 标签：ssh, ftp, sftp

我们正在使用自定义 FTP 应用程序（加密文件）进行安全传输。我们将应用程序发送给最终用户，他们使用它向我们发送机密数据。我们还使用它将信息发送回最终用户。

该应用程序需要更新 - 有些事情不再持续工作。随着最终用户获得更多限制性的安全环境，发布操作系统更新等。

我们有几种选择：

1.  更新应用程序，使用 SFTP 等。
2.  编写一个新的自定义 Web 应用程序以添加到我们的 aspx 网站。
3.  购买或下载 SFTP 软件
4.  购买或下载网络软件
5.  设置外部共享点站点
6.  使用托管在其他地方的服务 - 最好在加拿大，以便我们的法律适用

一些不错的功能：

1.  我们不希望解密文件位于防火墙外的服务器上。
2.  可恢复传输。
3.  能够将文件自动移动到我们防火墙内的特定位置。尽管这可以在文件传输之外轻松完成。
4.  通过电子邮件通知发件人和收件人。

建议/意见？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T16:40:34.820

我在 Windows 机器上使用[Free SSHd取得了不错的效果；](http://www.freesshd.com/)它在标准 SSH 端口 (22) 上运行，支持 SFTP，并且端到端加密。它还允许您设置与 Windows 权限并行的授权系统，因此您可以对谁可以访问以及他们可以做什么进行非常细粒度的控制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-12T15:34:37.363

我不确定该产品是否具有您正在寻找的一切，但 GoAnywhere 服务是一个安全的文件服务器，允许贸易伙伴（内部和外部）安全地连接到您的系统并在完全托管和审计的解决方案中交换文件.

GoAnywhere 服务可以安装在 Windows、Linux、IBM i、IBM System p (AIX)、IBM System z（大型机）、UNIX、HP-UX、Mac OS 和 Solaris 平台上。IBM i 也称为 System i、iSeries、as400、as/400 和 i5。

[http://www.goanywheremft.com/products/services](http://www.goanywheremft.com/products/services)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T16:37:42.050

首先，FTP 是一个明文协议，所以它已经不安全了。您更新的描述对此计数很有帮助:)

运行 SFTP 非常简单 - 默认情况下，它在安装和运行 OpenSSH 时运行。（是的，他们需要登录，但这很容易处理——尤其是与 LDAP 绑定。）

通过 HTTPS 运行可能是值得的。我想到了 Sharpoint、Plone 和无数其他 CMS。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T16:46:53.967

绝对要编写一个文件上传 Web 应用程序并将其添加到您现有的网站。这使您可以灵活地创建您和您的客户需要的确切解决方案，但更重要的是，它消除了将来发生的这个问题。对于 Web 应用程序，没有需要更新、分发或支持的客户端应用程序。您控制整个过程。

可以在 Internet 上轻松找到适用于 ASP 的文件上传应用程序，选择最适合您需求的应用程序并对其进行自定义：

[http://www.google.com/search?q=aspx+file+upload&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a](http://www.google.com/search?q=aspx+file+upload&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a)

请务必将您的网络服务器配置为使用 HTTPS，并且不允许 HTTP 以确保文件在传输过程中被加密

# actionscript-2 - 有没有办法在 actionscript2 中找到调用函数的名称？

> ID：262392
> 
> 赞同：1
> 
> 时间：2008-11-04T16:35:17.187
> 
> 标签：actionscript-2

在 actionscript 函数（方法）中，我可以访问 arguments.caller，它返回一个 Function 对象，但我找不到此 Function 对象表示的函数的名称。它的 toString() 只返回 [Function] 并且我找不到任何其他有用的访问器给我...帮助：-/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-11T07:06:15.320

函数只是一个对象，就像任何其他对象一样——它本身没有“名称”；它只有一个名称，您可能会对其进行一次或多次引用。如果您要问的是如何获取调用函数的引用的名称，那么没有通用的方法可以做到这一点。（毕竟函数可以匿名声明，在这种情况下它根本没有名字。）

最好检查一下为什么您需要知道函数的名称，并找出其他方法来传递或访问您试图从该名称派生的信息。传入一个额外的参数可能是一种方法，但这取决于你在做什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-16T22:06:27.977

我找到了答案，我将其粘贴在下面。

@fenomas：是的，你当然是对的，函数只是对象，我正在寻找的是对它们的引用的名称（如果存在，即函数不是匿名的）。你也对，一般来说这看起来不是最好的编程方式；-) 但我的场景很特别：我想用 Check.checkTrue 和 Checks 等方法实现一个 Checks 类（类似于 C CHECK）。 checkRef 当检查失败时，我会得到一个很好的跟踪。跟踪只会出现在调试版本中，不会出现在发布版本中。

我正在使用 MTASC，下面的代码仅适用于 MTASC。它也应该仅用于调试目的而不是发布。该技术是迭代 _global 并找到一个与我的调用函数相等的函数。这是一个并不总是有效的技巧（匿名），但在大多数情况下它对我很有帮助。

```
39:   /**
40:    * Checks that cond is true. Use this method to validate that condition
41:    * cond holds.
42:    * If cond is false, traces a severe message and returns false to indicate
43:    * check failure.
44:    *
45:    * @param cond the contition expected to be true
46:    * @param msg the message to emit in case the condition is false.
47:    *
48:    * @return false is cond is false
49:    */
50:   public static function checkTrue(cond:Boolean, msg:String):Boolean {
51:     if (!cond) {
52:       trace("severe", "CHECK FAILED at " +
53:           **getFunctionName(arguments.caller)** + ":\n" + msg);
54:     }
55:     return cond;
56:   }

94:   /**
95:    * Gets the name of the function func.
96:    * Warning: Use this only in debug version, not in release
98:    *
99:    * @return The full package path to the function. null if the function
100:    *      isn't found.
101:    */
102:   private static function getFunctionName(func:Function):String {
103:     var name:String = getFunctionNameRecursive(func, _global);
108:     return name;
109:   }
110: 
111:   /**
112:    * Gets the name of the function func by recursively iterating over root.
113:    * Warning: Use this only in debug version, not in release
114:    */
115:   private static function getFunctionNameRecursive(func:Function,
116:       root:Object):String {
117:     if (!root) {
118:       return null;
119:     }
120: 
121:     // Iterate over classes in this package
122:     // A class is a function with a prototype object
123:     for (var i:String in root) {
124:       if (root[i] instanceof Function && root[i].prototype != null) {
125:         // Found a class.
126:         // Iterate over class static members to see if there's a match
127:         for (var f:String in root[i]) {
128:           if(root[i][f] == func) {
129:             return i + "." + f;
130:           }
131:         }
132:         // Loop over the class's prototype to look for instance methods
133:         var instance:Object = root[i].prototype;
134:         // Reveal prototype's methods.
135:         // Warning: Not to be used in production code!!!
136:         // The following line make all the instance attributes visible to the
137:         // for-in construct. The "n" value is 8 which means "unhide"
138:         // See http://osflash.org/flashcoders/undocumented/assetpropflags
139:         // This operation is later undone by setting the "n" to 1 which means
140:         // "hide"
141:         _global.ASSetPropFlags(instance, null, 8, 1);
142:         for (var f:String in instance) {
143:           if(instance[f] == func) {
144:             return i + "." + f;
145:           }
146:         }
147:         // And hide instance methods again
148:         // This line undoes the previous ASSetPropFlags
149:         _global.ASSetPropFlags(instance, null, 1, false);
150:       }
151:     }
152: 
153:     // Iterate over sub packages. Sub packages have type "object"
154:     for (var i:String in root) {
155:       if (typeof(root[i]) == "object") {
156:         var name:String = getFunctionNameRecursive(func, root[i]);
157:         if (name) {
158:           return i + "." + name;
159:         }
160:       }
161:     }
162:     return null;
163:   } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-12T21:31:23.983

据我所知，不只在AS2 AS3 中。

# delphi - 如何在 Delphi 7 中接收 http 请求？

> ID：262402
> 
> 赞同：5
> 
> 时间：2008-11-04T16:37:57.993
> 
> 标签：delphi, http, delphi-7

在 Delphi 应用程序中，哪个组件最适合用于接收 HTTP 请求？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-04T17:00:38.977

[印](http://www.indyproject.org)地是要走的路。但是您需要一个服务器组件，而不是客户端组件。[TIDHTTPServer](http://www.indyproject.org/docsite/html/frames.html?frmname=topic&frmfile=TIdHTTPServer.html)应该符合要求

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-04T18:18:17.807

让我们不要忘记[ICS](http://www.overbyte.be/frame_index.html?redirTo=/products/ics.html)。也许不像 Indy 那样简单易用，但功能非常强大。支持http和https。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-04T17:30:15.750

另一个非常容易使用的选项是[Synapse TCP/IP](http://synapse.ararat.cz/doku.php/download)库。有一些可用的示例显示了它作为 HTTP 服务器的用法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-20T06:21:18.227

我之前一直在玩 HTTP 组件，并且我还实现了 IInternetProtocol 以与 Internet Explorer 集成并构建 ISAPI 扩展以与 IIS 集成。我已经开始[http://xxm.sourceforge.net/](http://xxm.sourceforge.net/)来开源它，并将它与通用接口、预解析器和自动编译选项结合起来，这样我就可以将 HTML 和 Delphi 加入到同一个源中-文件和代码网站很像 PHP、Cold Fusion 和 oldskool ASP。

# objective-c - 从 NSProgressIndicator 获取 NSImage

> ID：262407
> 
> 赞同：5
> 
> 时间：2008-11-04T16:42:00.217
> 
> 标签：objective-c, cocoa

我需要将 NSProgressIndicator 中的图像放入 NSOutlineView 单元中。我已经编写了代码来为确定的指标执行此操作，并且效果很好：

```
NSProgressIndicator *progressIndicator = [[NSProgressIndicator alloc] initWithFrame:NSMakeRect(0, 0, 16, 16)];
[progressIndicator setStyle:NSProgressIndicatorSpinningStyle];          
[progressIndicator setIndeterminate:NO];
[progressIndicator setMaxValue:100.0];
[progressIndicator setDoubleValue:somePercentage];          

NSImage *updateImage = [[NSImage alloc] initWithData:[progressIndicator dataWithPDFInsideRect:[progressIndicator frame]]];
[progressIndicator release];

return [updateImage autorelease]; 
```

我试图修改代码以也给我不确定的指示图像。但是对于不确定的情况，我总是得到一个空白的 16x16 图像。（我已经通过在每种情况下将图像写入文件来确认这一点，确定的情况给了我进度指示器图像，不确定的情况总是 16x16 白色方块）。

修改后的代码是：

```
if(self.lengthUnknown)
{
    NSProgressIndicator *progressIndicator = [[NSProgressIndicator alloc] initWithFrame:NSMakeRect(0, 0, 16, 16)];
    [progressIndicator setStyle:NSProgressIndicatorSpinningStyle];          
    [progressIndicator setIndeterminate:YES];

    NSImage *updateImage = [[NSImage alloc] initWithData:[progressIndicator dataWithPDFInsideRect:[progressIndicator frame]]];
    [progressIndicator release];

    return [updateImage autorelease];
}
else
{
 // Same code as the first listing, this case works fine
} 
```

不确定的进度指示器是否使用某种类型的绘图导致 -dataWithPDFInsideRect: 无法捕获其图像？

* * *

更多信息：我尝试将进度指示器设置为不使用线程动画，并尝试通过 NSImage 的 lockFocus 方法获取内容，如下所示，但这些尝试都没有产生任何影响。

Dave 在下面提到的进度指示器单元格代码 ( [AMIndeterminateProgressIndicatorCell](http://www.harmless.de/cocoa-code.php) ) 是一个很好的解决方法，但我仍然想知道为什么我不能使用与确定模式相同的技术。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-04T20:02:33.430

我使用[AMIndeterminateProgressIndicatorCell](https://www.harmless.de/cocoa-code.php)来表示单元格中的不确定进度指示器。它不是真正的 NSProgressIndicator，因为它是自己的绘图，但它是一个非常好的复制品，IMO。

[![替代文字](https://i.stack.imgur.com/KcXmM.png)](https://i.stack.imgur.com/KcXmM.png)
[（来源：[harmless.de](http://www.harmless.de/images/progressindicator.png?harmless=e55652fb0a6b5e2d88a22e9b37c9bbc1)）]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-04T20:07:36.120

进度指示器确实使用后台线程来保持其动画绘制，即使主线程正忙于做其他事情，所以这可能是导致问题的原因。在进行绘图之前，您可以尝试在进度指示器上调用 setUsesThreadedAnimation:NO 以查看是否有区别。

另一种方法是创建一个空白的 NSImage，然后调用进度指示器的 drawRect: 方法将其内容渲染到图像缓冲区中。这看起来像：

```
NSProgressIndicator* 进度指示器；
NSImage* image = [[NSImage alloc] initWithSize:[progressIndicator bounds].size];
[图像锁定焦点]；
[progressIndicator drawRect:[progressIndicator bounds]];
[图像解锁焦点]；

```

# winforms - 来自组合的 AccessViolationException：尝试读取或写入受保护的内存

> ID：262408
> 
> 赞同：4
> 
> 时间：2008-11-04T16:42:11.713
> 
> 标签：winforms, combobox, access-violation

用户在使用我们的应用程序（VB.Net、Winforms、使用框架的 v2）时偶尔会遇到上述错误。我无法重现它。调用栈如下：

: System.AccessViolationException: 试图读取或写入受保护的内存。这通常表明其他内存已损坏。在 System.Windows.Forms.UnsafeNativeMethods.CallWindowProc(IntPtr wndProc, IntPtr hWnd, Int32 msg, IntPtr wParam, IntPtr lParam) 在 System.Windows.Forms.NativeWindow.DefWndProc(Message& m) 在 System.Windows.Forms.Control.DefWndProc (Message& m) 在 System.Windows.Forms.Control.WndProc(Message& m) 在 System.Windows.Forms.ComboBox.WndProc(Message& m) 在 ControlEx.AutoCompleteCombo.WndProc(Message& m) 在 System.Windows.Forms.Control .ControlNativeWindow.OnMessage(Message& m) 在 System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m) 在 System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)

ControlEx.AutoCompleteCombo.WndProc 的代码如下：

```
Protected Overrides Sub WndProc(ByRef m As System.Windows.Forms.Message)
    Try
        If Not m_fReadOnly Then
            MyBase.WndProc(m)
        Else
            Select Case m.Msg
                Case WM_LBUTTONDOWN, WM_LBUTTONDBLCLK
                    ' do nothing
                Case Else
                    MyBase.WndProc(m)
            End Select
        End If
    Catch ex As OutOfMemoryException
        Throw New OutOfMemoryException("Exception during WndProc for combo " & Me.Name, ex)
    End Try
End Sub 
```

添加了错误处理，因此我们可以在收到 OutOfMemoryException 时确定是哪个组合导致了问题。

任何关于导致这种情况的线索将不胜感激！:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T13:22:43.503

我对代码中的 OutOfMemoryException 有一种奇怪的不确定感。

你为什么需要那个？如果您需要它，这可能是您的问题的原因吗？OutOfMemoryExceptions 非常罕见。如果你有这些，我认为这是一个强烈的迹象，表明其他事情是错误的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-07T22:00:42.250

在黑暗中拍摄，但也许您正试图在 KeyDown、KeyUp 或 KeyPress 事件期间修改自动完成列表？

根据微软的说法，这可能[会导致访问冲突。](http://support.microsoft.com/kb/952544)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-02T14:21:58.813

我刚刚发现原始异常 (AccessViolationException) 也是由于 ComboBox 中有一个项目，其 ToString 返回 Nothing (null)。我不知道为什么有时会出现 OutOfMemory，有时会出现 Accessviolation，有时会出现 NullReference 异常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T16:49:08.157

看起来您正在使用一个名为 AutoCompleteCombo 的自定义组合框控件。我怀疑该类中的 WndProc 覆盖有一个错误 - 可能会更改消息参数的值。你能把那个方法的代码贴出来让我们看看吗？

* * *

您发布的代码中没有任何内容会导致问题。您可能应该查看 AutoCompleteCombo 的其余代码以了解潜在的错误。真的没有其他事情可以继续了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-11T14:37:33.443

感谢您的意见，GvS 和 Stu。我正在对 OutOfMemory 进行更多探索，并发现了一种可能发生这种情况的有趣方式（将两个项目添加到组合中，在其 ToString 覆盖中返回 Nothing - [http://forums.microsoft.com/MSDN/ShowPost.aspx? PostID=247053&SiteID=1](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=247053&SiteID=1) )

# sftp - 从 Unix 到 Windows 的 Sftp

> ID：262409
> 
> 赞同：1
> 
> 时间：2008-11-04T16:42:30.900
> 
> 标签：sftp

有人知道从 Unix 到 Windows 的 sftp 方式吗

谢谢达米安

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-04T16:46:54.277

您使用例如[freeSSHd](http://www.freesshd.com/)设置服务器。然后，您可以使用 OpenSSH 附带的常规 unix 客户端，这有点无功能，或者在许多其他支持 unix 客户端的 SFTP 中进行选择。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-04T17:50:53.603

如果您只想要一个 Windows 客户端，我建议您使用[WinSCP](http://winscp.net)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-04T16:45:58.710

从刚刚提出的类似[问题](https://stackoverflow.com/questions/262390/secure-file-transfers#262400)中，我看到了这个：[http](http://www.freesshd.com) ://www.freesshd.com 。这可以让你*从**nix sftp*到*Windows。

[PuTTY](http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html)团队的 PSFTP可以*在*Windows 上抓取文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-04T16:45:27.197

您可以为 Windows 安装 OpenSSH。这是一个cygwin的东西，在windows box上设置有点棘手，但它对我有用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-04T01:04:39.853

看看[CompleteFTP](http://www.enterprisedt.com/products/completeftp/overview.html)，它是适用于所有 Windows 平台的快速、紧凑的 SFTP 服务器。

您可以在 Unix 上使用 OpenSSH 到 SFTP 到在 Windows 上运行的[CompleteFTP 。](http://www.enterprisedt.com/products/completeftp/overview.html)

披露：我是 CompleteFTP 的开发人员之一。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-20T08:48:48.350

您是在 Windows 上寻找现成的 SSH 服务器还是要创建一个？如果您需要创建服务器，请查看SecureBlackbox （我们的产品）的[SSHBlackbox 包。](http://www.eldos.com/sbbdev/desc-ssh.php)它提供了强大的组件来构建一个全面的 SSH 和 SFTP 服务器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-20T09:26:50.597

维基百科有很多可以在 Windows 上运行的[sftp 服务器列表。](http://en.wikipedia.org/wiki/List_of_SFTP_servers)有些更难设置，有些不是免费的。我在cygwin和freesshd下使用过openssh。

*   Cygwin + openssh
*   Cygwin + dropbear
*   copssh [http://www.itefix.no/i2/node/27](http://www.itefix.no/i2/node/27)
*   [http://www.freesshd.com/](http://www.freesshd.com/)
*   [http://www.coreftp.com/server/](http://www.coreftp.com/server/)
*   WS_FTP 服务器
*   Globalscape 安全 FTP 服务器

如果您正在寻找适用于 Linux 的 GUI sftp 客户端，您可能正在寻找 FileZilla 或 gftp-gtk。

# asp.net - 发布后保存 DropDownList 的状态

> ID：262413
> 
> 赞同：1
> 
> 时间：2008-11-04T16:43:14.910
> 
> 标签：asp.net, asp.net-mvc, drop-down-menu

我有一个带有一个**文本框**和**下拉列表的表单**

```
<%=Html.TextBox("名称")%>
<%=Html.ValidationMessage("名称", "输入名称")%><%=Html.DropDownList("未选择", "DomainID", ViewData["DomainID"])%>
```

我从下拉**列表中**选择值但不填写名称，我正在验证**文本框**，然后我需要再次从**下拉列表**中选择值，当然使用**文本框**它可以工作，但我可以用**列表**做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T16:53:15.060

我假设 ViewData["DomainID"] 是一个 SelectList？SelectList 的构造函数接受一个 selectedValue 对象。使用它将选定的值传递到发布操作中的选择列表中。

# c# - 将 NETBIOS 域转换为 FQDN（完全限定域名）

> ID：262425
> 
> 赞同：6
> 
> 时间：2008-11-04T16:46:28.367
> 
> 标签：c#, active-directory, dns, netbios, fqdn

简而言之 - 如何将 NETBIOS 域转换为 FQDN？

详细信息：假设我在域 A 中，并且我有域 B 的用户凭据，它与域 A 有信任关系（我可以验证凭据）。当我只有来自该域的一些经过身份验证的用户的凭据（包括 netbios 域名）时，如何获取域 B 的 FQDN？

我正在使用 C# 进行编码，但也欢迎使用 COM/WMI/Win32 解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-04T18:23:23.413

这可能不是最佳的，但看起来您可以执行 NetBIOS 名称查询以获取 IP 地址，然后执行反向 DNS 查找以从中获取 FQDN...

[http://www.protocolbase.net/protocols/protocol_NBNS.php](http://www.protocolbase.net/protocols/protocol_NBNS.php)

（反向DNS步骤很容易查到）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-05T10:07:45.060

您对其他域有什么样的访问权限？您要针对其他域中的哪个服务器/服务进行身份验证？

您是否对另一个域中的域服务器具有 IP 访问权限？如果是这样，那么您可以进行如下调用：

```
DirectoryEntry rootDSE = new DirectoryEntry("LDAP://10.11.12.13/rootDSE", @"DOMAIN\Username", "Password");
Console.WriteLine(rootDSE.Properties["defaultNamingContext"].Value); 
```

（将 10.11.12.13 替换为域服务器地址）。

您将收到代表 FQDN 的“DC=company,DC=org”形式的回复（只需通过删除 DC 部分并插入点来重建它）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-08T19:03:22.413

使用 WinNT 提供程序绑定到域并过滤所有用户帐户。开始枚举用户帐户。

如果用户帐户 sAMAccount 名称不包含字符串“duplicate”，则退出循环并使用 NameTranslate 对象查找帐户的 LDAP 名称。

LDAP 名称的一部分是域 FQDN。

嘿，这是一种软糖，但它就像一种魅力。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-01T22:04:24.703

win32 库的[vanara 集合](https://github.com/dahall/Vanara)可用于此目的。[NetApi32.dll 中的DsGetDcName](https://docs.microsoft.com/en-us/windows/win32/api/dsgetdc/nf-dsgetdc-dsgetdcnamea) API提供了从 NetBIOS 域名到 dns 域名的转换（作为副作用） 。

进入VS进入nuget包管理器并获取`Vanara.PInvoke.NetApi32`包。

这两种方法将 NetBIOS 名称转换为 dns 名称，反之亦然。

```
public static string ResolveNetBIOSDomainNameToDnsName(string netBIOSName)
{
    Vanara.PInvoke.NetApi32.DOMAIN_CONTROLLER_INFO domainDcInfo = 
            Vanara.PInvoke.NetApi32.DsGetDcName(Vanara.PInvoke.NetApi32.DsGetDcNameFlags.DS_RETURN_DNS_NAME | Vanara.PInvoke.NetApi32.DsGetDcNameFlags.DS_IS_FLAT_NAME, null, netBIOSName);
    return domainDcInfo.DomainName;
}

public static string ResolveDNSDomainNameToNetBIOSName(string dnsName)
{
    Vanara.PInvoke.NetApi32.DOMAIN_CONTROLLER_INFO domainDcInfo = 
            Vanara.PInvoke.NetApi32.DsGetDcName(Vanara.PInvoke.NetApi32.DsGetDcNameFlags.DS_RETURN_FLAT_NAME | Vanara.PInvoke.NetApi32.DsGetDcNameFlags.DS_IS_DNS_NAME, null, dnsName);
    return domainDcInfo.DomainName;
} 
```

# .net - VB NET 列出驱动器和 VMWARE

> ID：262426
> 
> 赞同：1
> 
> 时间：2008-11-04T16:46:47.977
> 
> 标签：.net, vb.net, winforms, visual-studio-2005, vmware

这是一个奇怪的... 在 Windows 窗体应用程序 (VB.NET/VS 2005) 中，我需要偶尔检查是否插入了应用程序 DVD。
在我的生产机器（以及我们的大多数客户）中，这段代码的执行时间不到一秒。但在某些机器中，大约需要 8 到 10 秒。我在那些速度较慢的几台电脑上找不到任何共同点（不同的操作系统、不同的 RAM、不同的处理器、更多的驱动器、更少的驱动器等）。
它发生在我们大约 4% 的测试机器上（以及我们的一些朋友机器，到目前为止：））
由于这个函数它只被调用一次，我可以忍受它。但奇怪的是，我们偶然发现这一点纯属运气，如果 VMWare 虚拟机正在运行，代码（在主机操作系统中运行）将花费预期不到一秒！
有没有人遇到过类似的事情？任何人至少可以为此提供一些解释吗？

```
i_DrivesArray = GetLogicalDrives()
    i_DrivesCount = i_DrivesArray.Length

    For i_DriveNumber = 0 To i_DrivesCount - 1
        i_DriveInformation = New DriveInfo(i_DrivesArray(i_DriveNumber))

        If (i_DriveInformation.DriveType = i_DriveTargetType And i_DriveInformation.IsReady = True) Then

            If File.Exists(i_DriveInformation.Name.ToString & ci_CDIdentifiers(i_Counter).ToString) = True Then
                ci_IsCDInserted = True
                ci_PathCD = i_DriveInformation.Name.ToString
                Exit For
            End If

        End If
    Next 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-14T01:58:21.237

这段代码的成本在哪里？分析对*坏*机器真的很有帮助

我想成本在那些 DriveInfo 调用中的某个地方 - 在反射器中查看 DriveInfo 背后的代码：

.cctor 似乎很无害 - 只是验证字母约束。

.GetDriveType 直接调用等效的 Win32 API。怀疑这将尝试访问目录根目录，因为它的潜在返回结果之一是 DRIVE_NO_ROOT_DIR。

> > [http://msdn.microsoft.com/en-us/library/aa364939.aspx](http://msdn.microsoft.com/en-us/library/aa364939.aspx)

.IsReady - 似乎试图“打开”驱动器根目录填充 FILE_ATTRIBUTE 结构。再次看起来类似于 GetDriveType - 可能很昂贵。

后一个 API 都有可能尝试触摸驱动器文件系统。从那时起，您将依赖于设备的行为以及卷的驱动程序，以了解“未安装”、“准备好”、“未准备好”等的含义。例如，尝试启动磁盘。

由于延迟以秒为单位，我同样怀疑与其他媒体类型相比，慢速软盘/dvd/cd 卷的枚举花费的时间最多。软盘特别是曾经有很长的超时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T16:49:32.057

*   您是否考虑过网络映射驱动器？他们对某些事情的反应可能很慢。

*   您是否尝试过获取驱动器列表，然后并行而不是串行地检查每个驱动器？找到结果时取消任何待处理的请求并返回 true。由于真正的 dvd 驱动器可能会立即返回，这将防止任何缓慢的卷拖累其余进程。

# javascript - 为什么 parseInt 使用 Array#map 产生 NaN？

> ID：262427
> 
> 赞同：305
> 
> 时间：2008-11-04T16:46:52.937
> 
> 标签：javascript

来自[Mozilla 开发者网络](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map)：

```
[1,4,9].map(Math.sqrt) 
```

将产生：

```
[1,2,3] 
```

那为什么会这样：

```
['1','2','3'].map(parseInt) 
```

产生这个：

```
[1, NaN, NaN] 
```

我已经在 Firefox 3.0.1 和 Chrome 0.3 中进行了测试，作为免责声明，我知道这不是跨浏览器功能（没有 IE）。

我发现以下将达到预期的效果。但是，它仍然不能解释`parseInt`.

```
['1','2','3'].map(function(i){return +i;}) // returns [1,2,3] 
```

* * *

## 回答 #1

> 赞同：501
> 
> 时间：2008-11-04T17:02:14.653

中的回调函数`Array.map`有*三个*参数：

从您链接到的同一[Mozilla 页面](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Objects/Array/map)：

> callback 使用三个参数调用：元素的值、元素的索引和被遍历的 Array 对象。”

因此，如果您调用一个`parseInt`实际上需要*两个*参数的函数，则第二个参数将是元素的索引。

在这种情况下，您最终`parseInt`以基数 0、1 和 2 依次调用。第一个与不提供参数相同，因此它默认基于输入（在本例中以 10 为底）。基数 1 是不可能的数基数，而 3 不是基数 2 中的有效数：

```
parseInt('1', 0); // OK - gives 1
parseInt('2', 1); // FAIL - 1 isn't a legal radix
parseInt('3', 2); // FAIL - 3 isn't legal in base 2 
```

所以在这种情况下，你需要包装函数：

```
['1','2','3'].map(function(num) { return parseInt(num, 10); }); 
```

或者使用 ES2015+ 语法：

```
['1','2','3'].map(num => parseInt(num, 10)); 
```

（在这两种情况下，最好如图所示*显式*提供一个基数`parseInt`，否则它会根据输入猜测基数。在一些较旧的浏览器中，前导 0 导致它猜测八进制，这往往是有问题的。它仍然会如果字符串以 . 开头，则猜测十六进制`0x`。）

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2014-11-10T23:54:02.520

`map`正在传递第二个参数，它（在许多情况下）弄乱了`parseInt`radix 参数。

如果你使用下划线，你可以这样做：

`['10','1','100'].map(_.partial(parseInt, _, 10))`

或不带下划线：

`['10','1','100'].map(function(x) { return parseInt(x, 10); });`

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2016-11-12T13:45:54.043

[您可以使用Number](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number)作为 iteratee 函数来解决此问题：

```
var a = ['0', '1', '2', '10', '15', '57'].map(Number);

console.log(a);
```

如果没有 new 运算符，Number 可以用于执行类型转换。但是，它与 parseInt 不同：它不解析字符串，如果数字无法转换，则返回 NaN。例如：

```
console.log(parseInt("19asdf"));
console.log(Number("19asf"));
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-11-04T16:54:52.123

我敢打赌，parseInt 的第二个参数基数会很奇怪。我不知道为什么使用 Array.map 而不是直接调用它会破坏它。

```
//  Works fine
parseInt( 4 );
parseInt( 9 );

//  Breaks!  Why?
[1,4,9].map( parseInt );

//  Fixes the problem
[1,4,9].map( function( num ){ return parseInt( num, 10 ) } ); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-08-17T20:38:17.130

您可以使用箭头函数 ES2015/ES6 并将数字传递给 parseInt。基数的默认值为 10

```
[10, 20, 30].map(x => parseInt(x)) 
```

或者，您可以显式指定基数以提高代码的可读性。

```
[10, 20, 30].map(x => parseInt(x, 10)) 
```

在上面的示例中，基数明确设置为 10

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-08-12T09:11:39.633

另一个（工作）快速修复：

```
var parseInt10 = function(x){return parseInt(x, 10);}

['0', '1', '2', '10', '15', '57'].map(parseInt10);
//[0, 1, 2, 10, 15, 57] 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-07-14T14:49:30.203

你可以像这样解决这个问题：

`array.map(x => parseInt(x))`

例子：

```
var arr = ["3", "5", "7"];

console.log(
  arr.map(x => parseInt(x))
);
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2017-10-15T21:59:40.977

`parseInt`出于这个原因，应该避免恕我直言。您可以包装它以使其在这些上下文中更安全，如下所示：

```
const safe = {
  parseInt: (s, opt) => {
    const { radix = 10 } = opt ? opt : {};
    return parseInt(s, radix);
  }
}

console.log( ['1','2','3'].map(safe.parseInt) );
console.log(
  ['1', '10', '11'].map(e => safe.parseInt(e, { radix: 2 }))
);
```

lodash/fp 默认将 iteratee 参数设置为 1 以避免这些陷阱。就我个人而言，我发现这些解决方法可以创建尽可能多的错误，因为它们可以避免。`parseInt`我认为，为了更安全的实施而将其列入黑名单是一种更好的方法。

# c# - 不同场景下 C#/.NET 的最佳排序算法

> ID：262431
> 
> 赞同：36
> 
> 时间：2008-11-04T16:47:25.277
> 
> 标签：c#, .net, algorithm, sorting

在 C# 中排序数据的最佳算法是什么？

有没有一种排序算法可以很好地处理 80% 的排序？

如果适用，请给出代码示例。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-11-04T16:54:28.287

看看这个网站： [用动画排序比较](http://www.sorting-algorithms.com/)

简短回答：快速排序

更长的答案：上面的网站将通过一些漂亮的动画向您展示每种算法的优缺点。

简短的回答是没有最好的排序（但你知道，因为你说 80% 的时间 :)）但快速排序（或 3 路快速排序）可能是你可以使用的最佳通用算法。

这是 .Net 中列表默认使用的算法，因此`.Sort`如果您拥有的内容已经在列表中，则可以调用。

如果您想了解如何实现，我在上面指出的网站上有伪代码。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-04T17:27:08.207

你想排序什么？有什么理由不使用：

```
List<T>.Sort() ? 
```

我确信这使用了 QuickSort，您不必担心会出现任何编码错误。您可以实现 IComparable 来更改您想要排序的内容。

如果您的所有数据都不适合内存......那么您将使用合并排序或类似的东西参加比赛。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-10-30T16:30:25.040

冒泡排序和插入排序是 O(n^2)，合并排序和快速排序是 O(nlogn)。您可以使用 List 中实现 Quicksort 的 Sort() 方法，或者您也可以尝试实现它并使其适应您的需求。这是一个基本的实现：快速排序

```
//O(nlogn) 
public static void QuickSort(int[] array, int init, int end)
{
   if (init < end)
   {
       int pivot = Partition(array, init, end);
       QuickSort(array, init, pivot-1);
       QuickSort(array, pivot + 1, end);
   }   
}

//O(n)
private static int Partition(int[] array, int init, int end)
{
   int last = array[end];
   int i = init - 1;
   for (int j = init; j < end; j++)
   {
        if (array[j] <= last)
        {
            i++;
            Exchange(array, i, j);     
         }
    }
    Exchange(array, i + 1, end);
    return i + 1;
}

private static void Exchange(int[] array, int i, int j)
{
    int temp = array[i];
    array[i] = array[j];
    array[j] = temp;
} 
```

来自[http://yadiragarnicabonome.com/sorting-arrays/](http://yadiragarnicabonome.com/sorting-arrays/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T16:49:52.290

尝试快速排序：http: [//www.codeproject.com/KB/recipes/QuickSort_gen.aspx](http://www.codeproject.com/KB/recipes/QuickSort_gen.aspx)

# orm - 你如何决定使用哪个 ORM？

> ID：262435
> 
> 赞同：1
> 
> 时间：2008-11-04T16:49:15.240
> 
> 标签：orm, data-layers

城堡活动记录？普通的NHibernate？亚音速？实体？像Nettiers这样的东西？

我想用一个，但我知道的不够多，无法决定。Nhibernate 似乎过于杀戮和复杂，但被广泛使用。亚音速看起来整洁而容易。但它稳定吗？我有 CodeSmith，我被指向 Nettiers，它看起来也很简洁，但也很复杂。其他人如何评估和决定使用什么？您是否制作了每个简单的小项目以查看功能？Eeeny、Meenie、Miney、Moe？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T16:53:16.900

我喜欢NHibernate。它实际上并没有那么复杂，它出奇的灵活，它不会用属性和其他不应该存在的时髦东西污染你的对象模型。

我发现活动记录模式不像域模式那样适合像 C# 这样的静态类型语言，因为它会使模拟变得更加复杂。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T17:04:47.440

我也更喜欢 NHibernate，并且同意如果你花一点精力去学习它，你会发现它并不像最初看起来那么复杂。您可以走很长一段路，而无需了解其所有功能。

但是，您应该始终为手头的工作选择正确的工具。如果您正在构建一个具有接近真实领域模型的应用程序，那么 NHibernate 将是 IMO 的自动选择。您提到的其他人不是真正的对象关系映射器，而是代码生成器。这本身不一定是坏事，但您必须评估一种方法何时比另一种更合适

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-24T15:06:59.083

由于问题是“我该如何选择”而不是“我应该选择什么”......：

我会先选择一个似乎最容易使用的。然后我会在谷歌上研究一下，看看它是否稳定。然后我会自己对它进行压力测试，具有一些多线程优点和具有不同类型关系和继承的域结构。

[您还可以从http://polepos.sourceforge.net/](http://polepos.sourceforge.net/)获得灵感， 它是一个数据库性能基准，但主要针对 java 框架。如果您愿意，您可以将源代码改编为 .net，它并不是非常复杂。

也就是说，我目前最喜欢的是 ActiveRecord 和 LINQ。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-24T15:13:13.627

我想决定**哪一个**的最佳方法是尝试找到一个在您正在评估的 ORM 中具有解决方案的常见问题。你会得到关于编程范式、风格、代码量、复杂性和诸如此类的想法

# c - 在 C 中为 malloc 和 free 创建一个包装函数

> ID：262439
> 
> 赞同：43
> 
> 时间：2008-11-04T16:50:08.530
> 
> 标签：c, memory-management, memory-leaks, malloc

我正在尝试为C`free`和`malloc`在 C 中创建包装函数，以帮助通知我内存泄漏。有谁知道如何声明这些函数，所以当我调用它`malloc()`时`free()`它会调用我的自定义函数而不是标准库函数？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2008-11-04T16:56:56.177

你有几个选择：

1.  **GLIBC 特定的解决方案（主要是 Linux）。**如果你的编译环境是`glibc`with `gcc`，首选的方法是使用[malloc 钩子](http://www.gnu.org/software/libtool/manual/libc/Hooks-for-Malloc.html)。它不仅可以让您指定自定义`malloc`and `free`，而且还可以通过堆栈上的返回地址来识别调用者。

2.  **POSIX 特定的解决方案。**在可执行文件中定义`malloc`和`free`作为原始分配例程的包装器，这将“覆盖”来自 libc 的版本。在包装器内部，您可以调用原始实现，您可以使用句柄`malloc`进行查找。定义包装函数的应用程序或库需要与.[`dlsym`](http://pubs.opengroup.org/onlinepubs/009695399/functions/dlsym.html)`RTLD_NEXT``-ldl`

    ```
    #define _GNU_SOURCE
    #include <dlfcn.h>
    #include <stdio.h>

    void* malloc(size_t sz)
    {
        void *(*libc_malloc)(size_t) = dlsym(RTLD_NEXT, "malloc");
        printf("malloc\n");
        return libc_malloc(sz);
    }

    void free(void *p)
    {
        void (*libc_free)(void*) = dlsym(RTLD_NEXT, "free");
        printf("free\n");
        libc_free(p);
    }

    int main()
    {
        free(malloc(10));
        return 0;
    } 
    ```

3.  **Linux 特定的。**`LD_PRELOAD`您可以通过在环境变量中指定动态库中的函数来非侵入性地覆盖它们。

    ```
    LD_PRELOAD=mymalloc.so ./exe 
    ```

4.  **Mac OSX 特定的。**

    与 Linux 相同，但您将使用`DYLD_INSERT_LIBRARIES`环境变量。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2011-01-03T17:07:06.160

您可以使用 LD_PRELOAD 执行包装和“覆盖”功能 - 类似于前面显示的示例。

```
LD_PRELOAD=/path.../lib_fake_malloc.so ./app 
```

但我建议这样做“稍微”聪明一点，我的意思是**调用 dlsym 一次**。

```
#define _GNU_SOURCE
#include <stdio.h>
#include <stdint.h>
#include <dlfcn.h>

void* malloc(size_t size)
{
    static void* (*real_malloc)(size_t) = NULL;
    if (!real_malloc)
        real_malloc = dlsym(RTLD_NEXT, "malloc");

    void *p = real_malloc(size);
    fprintf(stderr, "malloc(%d) = %p\n", size, p);
    return p;
} 
```

我在这里找到的示例：[http](http://www.jayconrod.com/cgi/view_post.py?23) ://www.jayconrod.com/cgi/view_post.py? 23 Jay Conrod 的帖子。

但是我在这个页面上发现非常酷的是：**GNU 链接器提供**了一个有用的选项**--wrap**。当我检查“man ld”时，有以下示例：

```
void *
__wrap_malloc (size_t c)
{
    printf ("malloc called with %zu\n", c);
    return __real_malloc (c);
} 
```

我同意他们的观点，这是“微不足道的例子”:)。甚至不需要 dlsym。

让我再引用我的“man ld”页面的一部分：

```
--wrap=symbol
       Use a wrapper function for symbol.
       Any undefined reference to symbol will be resolved to "__wrap_symbol".
       Any undefined reference to "__real_symbol" will be resolved to symbol. 
```

我希望，描述是完整的，并展示了如何使用这些东西。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2015-11-20T06:07:38.110

就我而言，我需要将 memalign/aligned_malloc 包装在 malloc 下。在尝试了其他解决方案后，我最终实施了下面列出的解决方案。它似乎工作正常。

[mymalloc.c](https://www.cs.cmu.edu/afs/cs/academic/class/15213-s03/src/interposition/mymalloc.c)。

```
/* 
 * Link-time interposition of malloc and free using the static
 * linker's (ld) "--wrap symbol" flag.
 * 
 * Compile the executable using "-Wl,--wrap,malloc -Wl,--wrap,free".
 * This tells the linker to resolve references to malloc as
 * __wrap_malloc, free as __wrap_free, __real_malloc as malloc, and
 * __real_free as free.
 */
#include <stdio.h>

void *__real_malloc(size_t size);
void __real_free(void *ptr);

/* 
 * __wrap_malloc - malloc wrapper function 
 */
void *__wrap_malloc(size_t size)
{
    void *ptr = __real_malloc(size);
    printf("malloc(%d) = %p\n", size, ptr);
    return ptr;
}

/* 
 * __wrap_free - free wrapper function 
 */
void __wrap_free(void *ptr)
{
    __real_free(ptr);
    printf("free(%p)\n", ptr);
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-04T17:28:56.487

在 C 中，我使用的方法类似于：

```
#define malloc(x) _my_malloc(x, __FILE__, __LINE__)
#define free(x) _my_free(x) 
```

这使我能够毫不费力地检测到分配内存的行和文件。它应该是跨平台的，但是如果已经定义了宏就会遇到问题（只有在使用另一个内存泄漏检测器时才会出现这种情况。）

如果您想在 C++ 中实现相同的功能，该过程会稍微[复杂](http://wyw.dcweb.cn/leakage.htm)一些，但使用相同的技巧。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-06T02:19:28.973

这是我多年来使用的一组包装函数（当我进入 C 语言时仍然这样做）来检测未释放的内存、多次释放的内存、对已释放内存的引用、缓冲区溢出/下溢以及释放内存没有分配。

[ftp://ftp.digitalmars.com/ctools.zip](ftp://ftp.digitalmars.com/ctools.zip)

他们已经存在了 25 年，并且已经证明了自己。

您可以使用宏预处理器重新定义 malloc 并免费使用 mem 包，但我建议不要这样做，因为它不会像 strdup 那样将库调用重定向到 malloc。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-11-04T17:06:19.433

如果您的目标是消除内存泄漏，那么一种更简单、干扰更少的方法是使用[Valgrind](http://valgrind.org/)（免费）或[Purify](http://www-01.ibm.com/software/awdtools/purify/)（昂贵）之类的工具。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-04T16:56:48.453

如果您为 malloc() 和 free() 定义自己的函数并将其与您的应用程序显式链接，则应优先使用您的函数而不是库中的函数。

但是，您的名为“malloc”的函数不能调用库 malloc 函数，因为在“c”中没有单独命名空间的概念。换句话说，您必须实现 malloc 的内部结构并释放自己。

另一种方法是编写函数 my_malloc() 和 my_free()，它们调用标准库函数。这意味着任何调用 malloc 的代码都必须更改为调用您的 my_xxx 函数。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-07-23T18:54:44.157

如果您是自定义的唯一客户`malloc`并且`free`（即，您不是试图为其他库中的代码修补这些方法），那么您可以使用依赖注入。

```
#ifndef ALLOCATOR_H
#define ALLOCATOR_H

#include <stddef.h>

struct Allocator;

typedef struct {
    void *(*allocate)(struct Allocator *allocator, size_t size);

    void (*free)(struct Allocator *allocator, void *object);
} AllocatorVTable;

typedef struct Allocator {
    const AllocatorVTable *vptr;
} Allocator;

typedef struct {
    Allocator super;
    char *buffer;
    size_t offset;
    size_t capacity;
} BufferedAllocator;

void BufferedAllocator_init(BufferedAllocator *allocator, char *buffer, size_t capacity);

typedef Allocator MallocAllocator;

void MallocAllocator_init(MallocAllocator *allocator);

void *Allocator_allocate(Allocator *allocator, size_t size);

void Allocator_free(Allocator *allocator, void *object);

#endif 
```

```
#include "allocator.h"
#include "malloc.h"

void *Allocator_allocate(Allocator *allocator, size_t size) {
    return allocator->vptr->allocate(allocator, size);
}

void Allocator_free(Allocator *allocator, void *object) {
    allocator->vptr->free(allocator, object);
}

void *BufferedAllocator_allocate(Allocator *allocator, size_t size) {
    BufferedAllocator *bufferedAllocator = (BufferedAllocator *) allocator;
    if (bufferedAllocator->offset + size > bufferedAllocator->capacity) {
        fprintf(stderr, "buffer overflow: %ld + %ld > %ld\n",
                bufferedAllocator->offset, size, bufferedAllocator->capacity);
        return NULL;
    }
    bufferedAllocator->offset += size;
    return bufferedAllocator->buffer + bufferedAllocator->offset - size;
}

void BufferedAllocator_free(Allocator *allocator, void *object) {

}

const AllocatorVTable bufferedAllocatorVTable = {
        .allocate = BufferedAllocator_allocate,
        .free = BufferedAllocator_free,
};

void BufferedAllocator_init(BufferedAllocator *allocator, char *buffer,
                            size_t capacity) {
    allocator->super.vptr = &bufferedAllocatorVTable;
    allocator->buffer = buffer;
    allocator->offset = 0;
    allocator->capacity = capacity;
}

void *MallocAllocator_allocate(Allocator *allocator, size_t size) {
    return malloc(size);
}

void MallocAllocator_free(Allocator *allocator, void *object) {
    free(object);
}

const AllocatorVTable mallocAllocatorVTable = {
        .allocate = MallocAllocator_allocate,
        .free = MallocAllocator_free,
};

void MallocAllocator_init(MallocAllocator *allocator) {
    allocator->vptr = &mallocAllocatorVTable;
} 
```

```
#include <assert.h>
#include "allocator_test.h"
#include "allocator.h"

void testAllocator() {
    {
        BufferedAllocator bufferedAllocator;
        char buffer[4];
        size_t capacity = sizeof(buffer);
        BufferedAllocator_init(&bufferedAllocator, buffer, capacity);
        Allocator *allocator = &bufferedAllocator.super;

        void *chill = Allocator_allocate(allocator, capacity);
        assert(chill == buffer);
        void *oops = Allocator_allocate(allocator, 1);
        assert(oops == NULL);
    }

    {
        MallocAllocator allocator;
        MallocAllocator_init(&allocator);

        void *chill = Allocator_allocate(&allocator, 100);
        assert(chill != NULL);
        void *alsoChill = Allocator_allocate(&allocator, 100);
        assert(alsoChill != NULL);
    }
} 
```

因此，您可以将一个传递`Allocator *`给您编写的任何想要分配东西的代码（除了`char buf[n]`堆栈上的东西）。您可以使用 a`MallocAllocator`来使用系统`malloc`/ `free`，或者您可以`BufferedAllocator`在程序的最顶部使用 a 。A`BufferedAllocator`只是一个非常简单的 malloc/free 的示例。它在我的用例中运行良好，因为我非常清楚我的程序将提前使用多少内存，并且在整个程序完成之前我不会删除任何对象。使用此接口，您可以编写更复杂的算法，如[本讲座](https://www2.cs.arizona.edu/%7Ecollberg/Teaching/553/2011/Handouts/Handout-6.pdf)中描述的算法之一。有很多不同的策略可以防止碎片和许多权衡，所以滚动你自己的 malloc/free 可能真的很有用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-04T17:27:13.823

如果您使用的是 Linux，则可以使用 malloc_hook()（使用 GNU glibc）。此函数允许您在调用实际 malloc 之前让 malloc 调用您的函数。手册页有一个关于如何使用它的示例。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-04T19:16:29.187

如果您只谈论您可以控制的内存，即您自己 malloc 和 free，您可以查看[rmdebug](http://www.hexco.de/rmdebug/ "rmdebug")。无论如何，这可能就是您要写的内容，因此您可以节省一些时间。它有一个非常自由的许可证，如果这对你很重要的话。

我个人在一个项目中使用它来查找内存泄漏，好处是它比 valgrind 快得多，但是它不是那么强大，所以你没有得到完整的调用堆栈。

# .net - Sharepoint 2007 NTLM 问题与托管在 Sharepoint 服务器上的 ASP.NET Web 应用程序

> ID：262442
> 
> 赞同：3
> 
> 时间：2008-11-04T16:50:21.790
> 
> 标签：.net, sharepoint, ntlm

我在 Sharepoint 2007 机器上托管了一个 ASP.NET Web 应用程序，它对 Sharepoint 进行 Web 服务调用以检索文档位置（特别是 GetListItems 方法）。

使用具有适当权限的有效 Sharepoint 帐户的传递凭据使用该服务。

```
ListServiceWrapper listService = new ListServiceWrapper();

/*Pass credentials to service call object*/
listService.Credentials = new NetworkCredential(spUserName, spPassword, spDomain);

/*Set the Url property of the service for the path to a subsite.*/
listService.Url = ConfigurationManager.AppSettings.Get("rootSite") + "/_vti_bin/lists.asmx"; 
```

当 Web 应用程序在我的开发盒上本地运行时（我是同一域上的 Sharepoint 用户），服务调用效果很好。当部署到 Sharepoint 框时，应用程序返回：

> 请求失败，HTTP 状态为 401：未授权。

我们尝试将 Sharepoint 框上 Web 应用程序的 App Pool 用户更改为授权的 Sharepoint 用户，但仍然没有任何运气。我想如果我们将 Sharepoint 身份验证更改为 Kerberos 而不是 NTLM，它将解决问题。不幸的是，这不是一个选择。这可能与 NLTM 双跳问题有关吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-04T19:59:01.473

是的，这与双跳问题有关。
在 NTLM 中，不允许您对远程服务进行身份验证。正如您所说，您需要 Kerberos 将凭据委派给其他服务。

您可以尝试的选项：

*   切换到 Kerberos。这是唯一正确的解决方案，但这并不容易，因为您必须创建所有 SPN 并确保端口 88 已打开。
*   在 SharePoint 框中安装您的 ASP.Net 应用程序并激活[DisableLoopbackCheck](http://support.microsoft.com/kb/896861)
*   使用服务帐户登录 SharePoint。在这种情况下，SharePoint 不会在用户帐户下运行，因此您必须自己处理安全问题

# http - 我可以让 IEMobile 不从重定向的 URL 中去除 # 吗？

> ID：262443
> 
> 赞同：0
> 
> 时间：2008-11-04T16:50:47.610
> 
> 标签：http, http-headers, ie-mobile

我在 IEMobile 访问我的网站时遇到问题。我使用的某个重定向具有 302 响应代码和标头（是的，那是应用引擎）：

```
服务器开发/1.0 Python/2.5.2
日期 2008 年 11 月 4 日星期二 16:47:02 GMT
内容类型文本/html；字符集=utf-8
缓存控制无缓存
位置 http://localhost/games/edit-game.html?game=110&frame_to_edit=3#input-top
内容长度 0
```

这适用于大多数浏览器。输入 IEMobile（通过 Windows Mobile 6.1）。收到此回复后，IEMobile 前往

```
http://localhost/games/edit-game.html?game=110&frame_to_edit=3
```

注意缺少的`#input-top`. 我能做些什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-04T11:03:47.853

阅读它指定的 RFC2616

> 位置：绝对URI

其中绝对 URI 由[RFC2396定义](http://www.ietf.org/rfc/rfc2396.txt)

跟踪absoluteURI的定义，#字符不是URI定义的一部分，这一点在4.1节得到确认

> 4.1。片段标识符
> 
> 当使用 URI 引用对已识别的资源执行检索操作时，可选的片段标识符 （由交叉线（“#”）字符与 URI
> 分隔）包含 在检索后由用户代理解释的附加参考信息动作已成功完成。因此，它不是 URI 的一部分，但通常与 URI 结合使用。

简而言之，#fragment*不是*URI 的一部分，并且被浏览器剥离为不是 Location: 标头的一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T11:13:40.077

戴夫是对的，谷歌搜索会遇到同样的问题。

丑陋的解决方法：如果您想支持该浏览器，请使用元刷新标签而不是重定向。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-09T08:32:52.873

你无能为力；它似乎是您的浏览器中的一个错误（实施者显然错过了 RFC 2616 勘误表）。

# c# - 用空字符串替换非数字

> ID：262448
> 
> 赞同：129
> 
> 时间：2008-11-04T16:52:15.280
> 
> 标签：c#, regex, string, phone-number

在我们的项目中快速添加需求。我们数据库中用于保存电话号码的字段设置为仅允许 10 个字符。所以，如果我通过“（913）-444-5555”或其他任何东西，是否有一种快速的方法可以通过某种特殊的替换函数运行字符串，我可以将一组字符传递给它以允许？

正则表达式？

* * *

## 回答 #1

> 赞同：258
> 
> 时间：2008-11-04T16:54:36.227

绝对正则表达式：

```
string CleanPhone(string phone)
{
    Regex digitsOnly = new Regex(@"[^\d]");   
    return digitsOnly.Replace(phone, "");
} 
```

或在一个类中避免一直重新创建正则表达式：

```
private static Regex digitsOnly = new Regex(@"[^\d]");   

public static string CleanPhone(string phone)
{
    return digitsOnly.Replace(phone, "");
} 
```

根据您的实际输入，您可能需要一些额外的逻辑来执行诸如去除前导 1（用于长距离）或任何尾随 x 或 X（用于扩展）的事情。

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2008-11-04T17:00:19.587

您可以使用正则表达式轻松完成：

```
string subject = "(913)-444-5555";
string result = Regex.Replace(subject, "[^0-9]", ""); // result = "9134445555" 
```

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2014-01-09T06:32:13.863

您不需要使用正则表达式。

```
phone = new String(phone.Where(c => char.IsDigit(c)).ToArray()) 
```

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2011-10-21T18:07:33.033

这是执行此操作的扩展方法。

```
public static class Extensions
{
    public static string ToDigitsOnly(this string input)
    {
        Regex digitsOnly = new Regex(@"[^\d]");
        return digitsOnly.Replace(input, "");
    }
} 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-11-04T17:07:07.327

使用 .NET 中的 Regex 方法，您应该能够使用 \D 匹配任何非数字数字，如下所示：

```
phoneNumber  = Regex.Replace(phoneNumber, "\\D", String.Empty); 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2014-09-04T03:52:44.350

不使用正则表达式的扩展方法怎么样。

如果您确实坚持使用正则表达式选项之一，至少`RegexOptions.Compiled`在静态变量中使用。

```
public static string ToDigitsOnly(this string input)
{
    return new String(input.Where(char.IsDigit).ToArray());
} 
```

这建立在 Usman Zafar 的答案转换为方法组的基础上。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2016-01-19T18:58:21.940

为了获得最佳性能和更低的内存消耗，请尝试以下操作：

```
using System;
using System.Diagnostics;
using System.Text;
using System.Text.RegularExpressions;

public class Program
{
    private static Regex digitsOnly = new Regex(@"[^\d]");

    public static void Main()
    {
        Console.WriteLine("Init...");

        string phone = "001-12-34-56-78-90";

        var sw = new Stopwatch();
        sw.Start();
        for (int i = 0; i < 1000000; i++)
        {
            DigitsOnly(phone);
        }
        sw.Stop();
        Console.WriteLine("Time: " + sw.ElapsedMilliseconds);

        var sw2 = new Stopwatch();
        sw2.Start();
        for (int i = 0; i < 1000000; i++)
        {
            DigitsOnlyRegex(phone);
        }
        sw2.Stop();
        Console.WriteLine("Time: " + sw2.ElapsedMilliseconds);

        Console.ReadLine();
    }

    public static string DigitsOnly(string phone, string replace = null)
    {
        if (replace == null) replace = "";
        if (phone == null) return null;
        var result = new StringBuilder(phone.Length);
        foreach (char c in phone)
            if (c >= '0' && c <= '9')
                result.Append(c);
            else
            {
                result.Append(replace);
            }
        return result.ToString();
    }

    public static string DigitsOnlyRegex(string phone)
    {
        return digitsOnly.Replace(phone, "");
    }
} 
```

我电脑中的结果是：
Init...
Time: 307
Time: 2178

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-11-04T16:59:13.223

我确信有一种更有效的方法可以做到这一点，但我可能会这样做：

```
string getTenDigitNumber(string input)
{    
    StringBuilder sb = new StringBuilder();
    for(int i - 0; i < input.Length; i++)
    {
        int junk;
        if(int.TryParse(input[i], ref junk))
            sb.Append(input[i]);
    }
    return sb.ToString();
} 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-11-04T18:47:07.343

试试这个

```
public static string cleanPhone(string inVal)
        {
            char[] newPhon = new char[inVal.Length];
            int i = 0;
            foreach (char c in inVal)
                if (c.CompareTo('0') > 0 && c.CompareTo('9') < 0)
                    newPhon[i++] = c;
            return newPhon.ToString();
        } 
```

# sql - 为什么使用“*”构建视图不好？

> ID：262450
> 
> 赞同：24
> 
> 时间：2008-11-04T16:52:26.827
> 
> 标签：sql, view

为什么使用 '*' 构建视图不好？

假设您有一个复杂的连接，并且所有字段都可能在某处使用。

然后你只需要选择需要的字段。

```
SELECT field1, field2 FROM aview WHERE ... 
```

视图“aview”可能是`SELECT table1.*, table2.* ... FROM table1 INNER JOIN table2 ...`

如果 table1 和 table2 中的 2 个字段具有相同的名称，我们就会遇到问题。

这仅仅是在视图中使用'*'不好的原因吗？

使用“*”，您可以在不同的上下文中使用视图，因为信息就在那里。

我错过了什么？

问候

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-11-04T16:56:57.720

我认为软件中没有太多“糟糕”的东西，但是有很多东西被滥用了:-)

您给出的示例是 * 可能无法给您期望的原因的原因，我认为还有其他原因。例如，如果基础表发生更改，可能会添加或删除列，使用 * 的视图将继续有效，但可能会破坏任何使用它的应用程序。如果您的视图已明确命名列，那么在进行架构更改时有人会发现问题的可能性更大。

~~另一方面，您可能实际上*希望*您的视图愉快地接受对基础表的所有更改，在这种情况下，* 正是您想要的。~~

*更新：*我不知道 OP 是否考虑到特定的数据库供应商，但现在很明显，我的最后一句话并不适用于所有类型。我很感谢 user12861 和 Jonny Leeds 指出了这一点，很抱歉我花了 6 年时间来编辑我的答案。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-11-04T17:05:51.073

尽管这里的许多评论都非常好，并且提到了在查询中使用通配符的一个常见问题，例如如果基础表发生更改会导致错误或不同的结果，但另一个没有涉及的问题是优化。提取表的每一列的查询往往不如只提取您实际需要的那些列的查询那么有效。诚然，有时您需要每一列，而主要的 PIA 必须全部引用它们，尤其是在大表中，但如果您只需要一个子集，为什么要用比您需要的更多的列来阻止查询。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-11-04T17:01:30.287

`*`“ ”不仅在视图中而且在查询中都有风险的另一个原因是列可以更改名称或更改基础表中的位置。使用通配符意味着您的视图无需更改即可轻松适应此类更改。但是，如果您的应用程序在结果集中按位置引用列，或者如果您使用返回以列名作为键的结果集的动态语言，您可能会遇到难以调试的问题。

我一直避免使用通配符。这样，如果列更改名称，我会立即在视图或查询中收到错误，并且我知道在哪里修复它。如果列在基础表中的位置发生变化，则指定视图或查询中列的顺序可以弥补这一点。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-11-04T20:30:16.357

这些其他答案都有好点，但至少在 SQL Server 上它们也有一些错误点。试试这个：

```
create table temp (i int, j int)
go
create view vtemp as select * from temp
go
insert temp select 1, 1
go
alter table temp add k int
go
insert temp select 1, 1, 1
go
select * from vtemp 
```

SQL Server 在添加时不会了解“新”列。这取决于你想要什么，这可能是好事也可能是坏事，但无论哪种方式，依赖它可能都不好。所以避免它似乎是一个好主意。

对我来说，这种奇怪的行为是避免在视图中选择 * 的最令人信服的理由。

这些评论告诉我 MySQL 有类似的行为，而 Oracle 没有（它将了解表的更改）。这种不一致对我来说是不在视图中使用 select * 的更多理由。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2008-11-04T16:57:40.870

使用 '*' 进行任何生产都是不好的。它非常适合一次性查询，但在生产代码中，您应该始终尽可能明确。

特别是对于视图，如果基础表添加或删除了列，则在重新编译之前，视图要么是错误的，要么是损坏的。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-11-04T17:42:23.713

`SELECT *`如果列不在视图外使用，在视图内使用不会产生太多性能开销——优化器会优化它们；`SELECT * FROM TheView`可能会浪费带宽，就像您通过网络连接拉更多列时一样。

事实上，我发现链接我的数据仓库中的许多大表中的几乎所有列的视图根本没有引入任何性能问题，即使从视图外部请求的这些列相对较少。优化器处理得很好，并且能够很好地将外部过滤条件下推到视图中。

但是，由于上述所有原因，我很少使用`SELECT *`.

我有一些业务流程，其中许多 CTE 构建在彼此之上，有效地从派生列的派生列构建派生列（希望有一天随着业务合理化和简化这些计算而被重构），在这种情况下，我每次都需要通过所有列，并且我使用`SELECT *`- 但`SELECT *`不在基础层使用，仅在第一个 CTE 和最后一个 CTE 之间使用。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2015-10-16T18:51:11.243

SQL Server 上的情况实际上比@user12861 所暗示的答案更糟糕：如果您`SELECT *`对多个表使用，将列添加到查询中早期引用的表实际上会导致您的视图假装返回新列的值的旧列。请参见下面的示例：

```
-- create two tables
CREATE TABLE temp1 (ColumnA INT, ColumnB DATE, ColumnC DECIMAL(2,1))
CREATE TABLE temp2 (ColumnX INT, ColumnY DATE, ColumnZ DECIMAL(2,1))
GO

-- populate with dummy data
INSERT INTO temp1 (ColumnA, ColumnB, ColumnC) VALUES (1, '1/1/1900', 0.5)
INSERT INTO temp2 (ColumnX, ColumnY, ColumnZ) VALUES (1, '1/1/1900', 0.5)
GO

-- create a view with a pair of SELECT * statements
CREATE VIEW vwtemp AS 
SELECT *
FROM temp1 INNER JOIN temp2 ON 1=1
GO

-- SELECT showing the columns properly assigned
SELECT * FROM vwTemp 
GO

-- add a few columns to the first table referenced in the SELECT 
ALTER TABLE temp1 ADD ColumnD varchar(1)
ALTER TABLE temp1 ADD ColumnE varchar(1)
ALTER TABLE temp1 ADD ColumnF varchar(1)
GO

-- populate those columns with dummy data
UPDATE temp1 SET ColumnD = 'D', ColumnE = 'E', ColumnF = 'F'
GO

-- notice that the original columns have the wrong data in them now, causing any datatype-specific queries (e.g., arithmetic, dateadd, etc.) to fail
SELECT *
FROM vwtemp
GO

-- clean up
DROP VIEW vwTemp
DROP TABLE temp2
DROP TABLE temp1 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-11-04T16:55:42.373

这是因为您并不总是需要每个变量，并且还要确保您正在考虑您的具体需求。

例如，在您的站点上构建用户列表时，将所有散列密码从数据库中取出是没有意义的，因此选择 * 将是徒劳的。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-11-04T16:57:20.887

曾几何时，我针对另一个数据库（在同一台服务器上）中的表创建了一个视图

```
Select * From dbname..tablename 
```

然后有一天，将一列添加到目标表中。视图开始返回完全不正确的结果，直到重新部署。

* * *

完全不正确：没有行。

这是在 Sql Server 2000 上。

我推测这是因为视图已经捕获了 syscolumns 值，即使我使用了 *.

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-11-06T03:41:32.053

SQL 查询基本上是程序员设计的用于某些上下文的功能单元。为了长期稳定性和可支持性（可能由您以外的其他人），功能单元中的所有内容都应该是有目的的，并且应该合理地明显（或记录）为什么存在 - 特别是数据的每个元素。

如果两年后我需要或渴望改变你的查询，我希望在我确信我能搞砸之前彻底了解它。这意味着我需要了解为什么所有列都被调出。（如果您试图在多个上下文中重用查询，则这一点更明显。出于类似的原因，这通常是有问题的。）如果我要在输出中看到与某些目的无关的列，我很确定我不明白它做了什么，为什么，以及改变它的后果是什么。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-11-04T17:19:04.870

使用 *. 一些代码认证引擎将此标记为警告，并建议您仅明确引用必要的列。使用 * 可能会导致性能问题，因为您可能只需要一些列而不是全部。但是，另一方面，在某些情况下使用 * 是理想的。想象一下，无论如何，使用您提供的示例，对于此视图 (aview)，您将始终需要这些表中的所有列。将来，当添加列时，您无需更改视图。根据您处理的情况，这可能是好是坏。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-11-04T18:32:12.490

我认为这取决于您使用的语言。当语言或 DB 驱动程序返回结果的 dict（Python、Perl 等）或关联数组（PHP）时，我更喜欢使用 select *。如果您通过名称而不是数组中的索引来引用列，它会使您的代码更容易理解。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-11-05T23:44:03.203

似乎没有其他人提到它，但在 SQL Server 中，您还可以使用[schemabinding](http://msdn.microsoft.com/en-us/library/ms173846.aspx)属性设置您的视图。

这可以防止修改任何会影响视图定义的基表（包括删除它们）。

在某些情况下，这可能对您有用。我意识到我还没有完全回答你的问题，但我想我还是会强调它。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-12-07T15:41:28.667

如果您使用 select * 进行连接，则自动意味着您返回的数据比您需要的更多，因为连接字段中的数据会重复。这是对数据库和网络资源的浪费。

如果您天真地使用调用其他视图的视图，则使用 select * 会使它们的性能更差（这种技术本身不利于性能，调用不需要的多个列会使情况变得更糟）。

# c++ - 如何以与在 Windows 资源管理器中“发送给邮件收件人”相同的方式以编程方式发送电子邮件？

> ID：262451
> 
> 赞同：9
> 
> 时间：2008-11-04T16:52:28.777
> 
> 标签：c++, windows, email, shell

ShellExecute() 允许我执行简单的 shell 任务，让系统负责打开或打印文件。我想采用类似的方法以编程方式发送电子邮件附件。

我不想直接操作 Outlook，因为我不想假设用户默认使用哪个电子邮件客户端。我不想直接发送电子邮件，因为我希望用户有机会使用他们的首选客户端编写电子邮件正文。因此，当我右键单击一个文件并选择发送到 -> 邮件收件人时，我真的想要完全完成 Windows 资源管理器所做的事情。

我正在寻找 C++ 解决方案。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-05T09:56:06.027

这是我的 MAPI 解决方案：

```
#include <tchar.h>
#include <windows.h>
#include <mapi.h>
#include <mapix.h>

int _tmain( int argc, wchar_t *argv[] )
{
    HMODULE hMapiModule = LoadLibrary( _T( "mapi32.dll" ) );

    if ( hMapiModule != NULL )
    {
        LPMAPIINITIALIZE lpfnMAPIInitialize = NULL;
        LPMAPIUNINITIALIZE lpfnMAPIUninitialize = NULL;
        LPMAPILOGONEX lpfnMAPILogonEx = NULL;
        LPMAPISENDDOCUMENTS lpfnMAPISendDocuments = NULL;
        LPMAPISESSION lplhSession = NULL;

        lpfnMAPIInitialize = (LPMAPIINITIALIZE)GetProcAddress( hMapiModule, "MAPIInitialize" );
        lpfnMAPIUninitialize = (LPMAPIUNINITIALIZE)GetProcAddress( hMapiModule, "MAPIUninitialize" );
        lpfnMAPILogonEx = (LPMAPILOGONEX)GetProcAddress( hMapiModule, "MAPILogonEx" );
        lpfnMAPISendDocuments = (LPMAPISENDDOCUMENTS)GetProcAddress( hMapiModule, "MAPISendDocuments" );

        if ( lpfnMAPIInitialize && lpfnMAPIUninitialize && lpfnMAPILogonEx && lpfnMAPISendDocuments )
        {
            HRESULT hr = (*lpfnMAPIInitialize)( NULL );

            if ( SUCCEEDED( hr ) )
            {
                hr = (*lpfnMAPILogonEx)( 0, NULL, NULL, MAPI_EXTENDED | MAPI_USE_DEFAULT, &lplhSession );

                if ( SUCCEEDED( hr ) )
                {
                    // this opens the email client with "C:\attachment.txt" as an attachment
                    hr = (*lpfnMAPISendDocuments)( 0, ";", "C:\\attachment.txt", NULL, NULL );

                    if ( SUCCEEDED( hr ) )
                    {
                        hr = lplhSession->Logoff( 0, 0, 0 );
                        hr = lplhSession->Release();
                        lplhSession = NULL;
                    }
                }
            }

            (*lpfnMAPIUninitialize)();
        }

        FreeLibrary( hMapiModule );
    }

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-04T17:06:25.707

您可以在 Windows shell 中使用标准的“mailto:”命令。它将运行默认的邮件客户端。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-05T01:42:05.697

以下 C++ 示例显示了如何调用 Windows 资源管理器使用的 SendTo 邮件快捷方式：

[http://www.codeproject.com/KB/shell/sendtomail.aspx](http://www.codeproject.com/KB/shell/sendtomail.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T17:09:53.437

您需要实现[MAPI 客户端。](http://msdn.microsoft.com/en-us/library/ms527046.aspx) 这将让您在将消息呈现给用户发送之前预先填写文档、添加附件等。您可以使用默认消息存储来使用他们的默认邮件客户端。

# python - 使程序在python中无限期运行

> ID：262460
> 
> 赞同：1
> 
> 时间：2008-11-04T16:53:45.450
> 
> 标签：python, time, key, indefinite

有什么方法可以制作一个函数（我正在考虑的那些是我制作的简单函数的样式，它生成从 0 到一个点的斐波那契序列，以及两点之间的所有素数）无限期运行。例如，直到我按下某个键或直到某个时间过去，而不是直到某个数字达到某个点？

另外，如果它是基于时间的，那么有什么办法可以延长时间并再次从该点开始，而不必从 0 开始？我知道有一个时间模块，我只是不太了解它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T16:58:14.257

最简单的方法就是编写一个无限循环的程序，然后按 control-C 停止它。如果没有更多描述，很难知道这是否适合您。

如果您基于时间进行操作，则不需要生成器。你可以让它暂停用户输入，比如“继续？[y/n]”，从标准输入读取，取决于你得到什么退出循环。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-04T17:10:49.223

如果你真的希望你的函数运行并且仍然需要用户（或系统）输入，你有两种解决方案：

1.  多线程
2.  多进程

这将取决于交互的精细程度。如果你只是想中断函数而不关心退出，那么多进程就可以了。

在这两种情况下，您都可以依赖一些共享资源（多线程的文件或共享内存，多线程的具有关联互斥锁的变量）并在您的函数中定期检查该资源的状态。如果它被设置为告诉你退出，那就去做吧。

多线程示例：

```
from threading import Thread, Lock
from time import sleep

class MyFct(Thread):
    def __init__(self):
        Thread.__init__(self)
        self.mutex = Lock()
        self._quit = False

    def stopped(self):
        self.mutex.acquire()
        val = self._quit
        self.mutex.release()
        return val

    def stop(self):
        self.mutex.acquire()
        self._quit = True
        self.mutex.release()

    def run(self):
        i = 1
        j = 1
        print i
        print j
        while True:
            if self.stopped():
                return
            i,j = j,i+j
            print j

def main_fct():
    t = MyFct()
    t.start()
    sleep(1)
    t.stop()
    t.join()
    print "Exited"

if __name__ == "__main__":
    main_fct() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-05T08:33:49.017

您可以为此使用生成器：

```
def finished():
    "Define your exit condition here"
    return ...

def count(i=0):
    while not finished():
        yield i
        i += 1

for i in count():
    print i 
```

如果要更改退出条件，可以将一个值传回生成器函数并使用该值来确定何时退出。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-04T16:55:50.953

与几乎所有语言一样：

```
while True:
  # check what you want and eventually break
  print nextValue() 
```

你问题的第二部分更有趣：

> 另外，如果它是基于时间的，那么无论如何我都可以延长时间并再次从该点开始，而不必从 0 重新开始

您可以在函数中使用 a`yield`而不是`return``nextValue()`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-04T17:04:28.830

如果在主线程等待字符输入时使用子线程运行该函数，它应该可以工作。只要记住有一些东西可以停止子线程（在下面的全局运行线程示例中）

例如：

```
import threading, time
runthread = 1
def myfun():
   while runthread:
      print "A"
      time.sleep(.1)

t = threading.Thread(target=myfun)
t.start()
raw_input("")
runthread = 0
t.join() 
```

就是这样做的

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-04T18:29:31.373

如果要根据时间退出，可以使用信号模块的 alarm(time) 函数，并捕获 SIGALRM - 这是一个示例[http://docs.python.org/library/signal.html#example](http://docs.python.org/library/signal.html#example)

您可以通过捕获 KeyboardInterrupt 让用户以理智的方式中断程序。只需从主循环外部捕获 KeyboardInterrupt 异常，然后进行任何您想要的清理。

如果您想稍后从中断的地方继续，则必须添加某种持久性。我会将数据结构[腌制](http://docs.python.org/library/pickle.html#module-pickle)到磁盘，您可以读回以继续操作。

我没有尝试过这样的事情，但是您可以考虑使用诸如[memoizing](http://wiki.python.org/moin/PythonDecoratorLibrary#head-11870a08b0fa59a8622201abfac735ea47ffade5)之类的东西，并缓存到磁盘。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-04T23:27:14.750

你可以做这样的事情来生成斐波那契数 1 秒然后停止。

```
fibonnacci = [1,1]
stoptime = time.time() + 1 # set stop time to 1 second in the future
while time.time() < stoptime:
  fibonnacci.append(fibonnacci[-1]+fibonnacci[-2])

print "Generated %s numbers, the last one was %s." % (len(fibonnacci),fibonnacci[-1]) 
```

我不确定在每个循环中调用 time.time() 的效率如何——取决于你在循环中所做的事情，它最终可能会降低很多性能。

# c# - 命名空间冲突

> ID：262469
> 
> 赞同：5
> 
> 时间：2008-11-04T16:54:52.920
> 
> 标签：c#, .net, namespaces

在这种情况下，.NET 怎么可能找到错误的“MyType”？

我正在处理的项目中有一个 ABCDMyType 类型，并且我正在引用一个具有 ABMyType 类型的 DLL？我没有任何“使用 AB；” 在我的代码中的任何地方声明，我确实有'使用 ABCD;'。当我编译时，编译器认为任何对“MyType”的裸引用都意味着“ABMyType”。

我知道我可以重命名类或使用别名，但我想知道这怎么可能。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-04T18:20:17.087

您是否在 AB 命名空间下的命名空间中工作？（例如 ABX）如果是这样，C# 命名空间解析（[ECMA-334 C# 语言规范：10.8 10.8 命名空间和类型名称](http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-334.pdf)）说：

> ... 对于每个命名空间 N，从出现命名空间或类型名称的命名空间开始，继续每个封闭的命名空间（如果有），并以全局命名空间结束，评估以下步骤，直到找到一个实体。 ..

然后是：

> 如果 K 为零并且命名空间声明包含将名称 I 与导入的命名空间或类型相关联的 extern-alias-directive 或 using-aliasdirective，则命名空间或类型名称引用该命名空间或类型

这意味着名称解析从当前命名空间开始，搜索直到根目录的所有命名空间，并且只有在这种分层搜索结束后，才会搜索使用该`using`子句导入的命名空间。

以下示例打印“Ns1.Foo”

```
using Ns1.Foo.Foo2;

namespace Ns1.Foo
{
    class Foo
    {
        public void Print()
        {
            System.Console.WriteLine("Ns1.Foo");
        }
    }
}

namespace Ns1.Foo.Foo2
{
    class Foo
    {
        public void Print()
        {
            System.Console.WriteLine("Ns1.Foo.Foo2");
        }
    }
}

namespace Ns1.Foo.Bar
{
    class Bar
    {
        public void Print()
        {
            new Foo().Print();
        }

        static void Main()
        {
            new Bar().Print();
        }
    }
} 
```

**编辑：在命名空间内**添加 using 子句，将在完成当前命名空间的分层搜索之前搜索命名空间。将示例更改为：

```
namespace Ns1.Foo.Bar
{
    using Ns1.Foo.Foo2;
    class Bar
    {
        public void Print()
        {
            new Foo().Print();
        }

        static void Main()
        {
            new Bar().Print();
        }
    }
} 
```

并将`Ns1.Foo.Foo2`被打印。

编辑：更改示例

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-04T17:06:54.177

您的代码在命名空间中`A.B`还是`A.B.C`？如果是这样，那可能就是问题所在。使用这样的 using 指令：

```
using TheTypeIWant = A.B.C.D.MyType; 
```

然后只需`TheTypeIWant`在您的代码中引用即可。

编辑：我刚刚尝试了“ `using MyType=A.B.C.D.MyType`”选项，但这*不起作用*。不过上面还不错。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T16:59:38.760

只是猜测：在您的项目属性中，“默认命名空间”是否设置为 AB ？

# svn - 多学科网络代理的版本控制

> ID：262471
> 
> 赞同：1
> 
> 时间：2008-11-04T16:55:34.620
> 
> 标签：svn, version-control

好的，这是低调。我想为我的代理机构设置版本控制系统和相关流程，并希望在我投入之前从其他人的错误中吸取教训。

我正在考虑从远程托管服务部署颠覆（assembla - 这也将有助于离线代码备份！）。

我们是一个拥有 3 个主要团队的 ASP.net 网上商店。（大约 30 人分成 3 个团队）

前端团队 - Photoshop、XHTML。CSS，Javascript。主要使用 Photoshop 进行设计/创意，dreamweaver 进行标记，使用 topstyle 进行 css。

开发团队 - 主要是 ASP.net，但在需要时加入了一些 php。所以主要是VS2005和SQL Server工作。

目前，所有团队都通过一系列网络共享工作——所有团队都直接在一个站点的单个工作副本上工作。虽然我们正在引入版本控制，并且理想情况下我们会让每个设计人员/开发人员在他们的个人计算机上设置一个实时 Web 服务器的副本，但看起来这在一开始并不实用（即我们已经熟练的前端开发人员，他们只是没有能力在他们的个人工作站上设置完整的 ASP.net 应用程序。对于不习惯在 ASP.net 环境中工作的设计师来说，他们想要的时候也似乎有点过头了要做的是调整一些 CSS 或一些标记。

这意味着我们可能会保留我们目前使用的网络共享结构（我知道这并不理想，但必须从某个地方开始）但是我们要使网络上的站点副本成为主要的“工作副本”检查从人们在我们本地开发环境中工作的存储库中取出。

然后，这将被检查到我们的主存储库中，然后再部署到 Internet 上的测试服务器并最终上线。

人们对上述我提出的部署模型有何看法？

关于如何让具有不同技能的团队都使用相同的版本控制流程，有人有什么建议吗？

提前致谢。

埃德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T07:28:21.673

我在数字机构工作了很长时间，在这些地方使用版本控制有时会是一场相当激烈的战斗。我注意到视觉工作人员（photoshops）通常不习惯使用像版本控制这样的系统。这涉及到一些技术知识，当使用类似的系统时，您通常必须更加自律地处理您的文件。我和那些家伙在太多场合听到过“F@ck this sh*t”这句话，仅仅是因为人们没有耐心使用它或学习使用它。

此外，正如其中一条评论所述，数字机构经常处理大量二进制数据。拥有一个异地版本控制系统可能不是正确的选择——除非你从你的办公室有一个巨大的管道来处理容量。定期下载备份会变得更糟。

使用版本控制当然不是辩论。当然你应该使用它。你能做的是，这是我过去做过的，我将来会再做一次，让你的技术团队首先使用这个系统，这样他们就知道它的来龙去脉、怪癖等. 然后慢慢地让一些前端人员开始使用它（从技术人员开始，然后逐步向下）。一旦完成，请继续与设计师。再次，从老年人开始，沿着食物链往下走。让整个工作室在第一天使用它就是在自掘坟墓。

在技​​术网站上。一旦您让您的 photoshop 开始使用该系统，您可能需要考虑设置一个内部服务器。这将使您的生活更轻松，并使用 76 兆的 photoshop 文件更快地提交和更新的整个过程。它还将提高系统的采用率。让前端人员将用于项目的最终图像或视频放入异地版本控制系统中。

请记住，引入这样的系统可能需要一段时间。整个工作室的启动和运行可能需要长达一年的时间......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-04T17:17:16.480

虽然远非完美，但您可能会考虑使用[WebDAV](http://svnbook.red-bean.com/en/1.1/svn-book.html#svn-ch-8-sect-4)

请参阅[附录 C，WebDAV 和自动版本控制](http://svnbook.red-bean.com/en/1.1/svn-book.html#svn-ap-c)

您的前端团队可以使用[Win32 WebFolders](http://svnbook.red-bean.com/en/1.1/svn-book.html#svn-ap-c-sect-3.1)，并且看起来与他们熟悉的相似 - 一个简单的网络共享，但它实际上是 SVN 存储库。

您的开发人员可以使用他们自己的工作副本，使用 AnkhSVN 或其他客户端进行工作。

警告买家，YMMV

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T11:28:37.477

PhotoShop CS and above has Version Cue which is its own inbuilt system for Version Control. I've not tried it with PhotoShop itself but have used it with limited success with GoLive.

Perhaps your designers would be happier to use that as it's already built into a tool their familiar with?

Also, your front-end developers could use Version Cue with Dream Weaver or GoLive for their minor code changes although I don't know if this has any hooks into a "proper" CVS system.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-02T08:32:06.987

你可能想看看[Perforce](http://perforce.com)，它与 Visual Studio 配合得很好，但也有[用于 Photoshop](http://www.perforce.com/perforce/products/plugins-p4gt.html)的插件，可以更简单地使用版本控制的资产。

至于让团队购买，您可能还想看看[Streamed Lines 论文](http://www.cmcrossroads.com/bradapp/acme/branching/)- 详细介绍了一些要避免的最佳实践和反模式

# .net - 我可以在带有 .NET 的 System.Text.RegularExpressions 的命名捕获中使用破折号吗？

> ID：262475
> 
> 赞同：0
> 
> 时间：2008-11-04T16:55:59.597
> 
> 标签：.net, regex

是否可以做类似 (?'AB'\s*) 的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T17:29:14.380

从文档：

> (?<name1-name2>子表达式)
> 
> （平衡组定义。）删除先前定义的组name2的定义，并将先前定义的name2组和当前组之间的间隔存储在组name1中。如果未定义组 name2，则匹配回溯。因为删除 name2 的最后一个定义会显示 name2 的先前定义，所以此构造允许将组 name2 的捕获堆栈用作跟踪嵌套构造（例如括号）的计数器。在此构造中，name1 是可选的。您可以使用单引号代替尖括号；例如，(?'name1-name2')。

您的示例仅在存在已在正则表达式中定义的名为 B 的组并且您打算执行 AB 暗示的情况下才有效。

如果您要询问组名中是否可以包含破折号，则不能。破折号在命名组中具有特殊含义。

有关详细信息，请参阅[本主题中的示例。](http://msdn.microsoft.com/en-us/library/bs2twtah.aspx)

# c# - 从c#中的字符串中提取5位数字的最快方法是什么

> ID：262480
> 
> 赞同：2
> 
> 时间：2008-11-04T16:56:51.840
> 
> 标签：c#, regex, string

从 C# 中的字符串中提取 5 位数字的最快方法是什么。

我有

```
string.Join(null, System.Text.RegularExpressions.Regex.Split(expression, "[^\\d]")); 
```

还有其他人吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-04T18:00:07.890

正则表达式方法可能是最快的实现但不是最快的运行。我将一个简单的正则表达式解决方案与以下手动搜索代码进行了比较，发现手动搜索代码对于大输入字符串的速度要快约 2x-2.5 倍，对于小字符串则快 4 倍：

```
static string Search(string expression)
{
  int run = 0;
  for (int i = 0; i < expression.Length; i++)
  {
    char c = expression[i];
    if (Char.IsDigit(c))
      run++;
    else if (run == 5)
      return expression.Substring(i - run, run);
    else
      run = 0;
  }
  return null;
}
const string pattern = @"\d{5}";
static string NotCached(string expression)
{
  return Regex.Match(expression, pattern, RegexOptions.Compiled).Value;
}

static Regex regex = new Regex(pattern, RegexOptions.Compiled);
static string Cached(string expression)
{
  return regex.Match(expression).Value;
} 
```

中间有 5 位字符串的 ~50 字符字符串的结果，超过 10^6 次迭代，每次调用的延迟以微秒为单位（数字越小越快）：

简单搜索：0.648396us

缓存正则表达式：2.1414645us

非缓存正则表达式：3.070116us

在 10^4 次迭代中，中间有一个 5 位字符串的 ~40K 字符串的结果，每次调用的延迟以微秒为单位（数字越小越快）：

简单搜索：423.801us

缓存的正则表达式：1155.3948us

非缓存正则表达式：1220.625us

有点令人惊讶：我希望 Regex（编译为 IL）与手动搜索相当，至少对于非常大的字符串。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-04T17:00:02.690

使用正则表达式 (\d{5}) 查找字符串中 5 位数字的出现次数，并在匹配项上使用 int.Parse 或 decimal.Parse。

在只有一个数字的情况下`text`。

```
int? value = null;
string pat = @"\d{5}"
Regex r = new Regex(pat);
Match m = r.Match(text);
if (m.Success)
{
   value = int.Parse(m.Value);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-04T16:58:16.347

您的意思是将字符串转换为数字吗？还是找到前 5 位字符串，然后将其设为数字​​？无论哪种方式，您都可能会使用[decimal.Parse](http://msdn.microsoft.com/en-us/library/system.decimal.parse.aspx)或 int.Parse。

我认为正则表达式是错误的方法。一种更有效的方法是简单地遍历字符串寻找一个数字，然后推进 4 个字符并查看它们是否都是数字。如果是的话，你就有了你的子字符串。它没有那么健壮，不，但它也没有开销。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-04T17:02:14.963

根本不要使用正则表达式。它比你需要的更强大——而且这种能力可能会影响性能。

如果您可以详细说明您需要它做什么，我们可以编写适当的代码......（测试用例将是理想的。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-04T17:02:18.537

如果数字与其他字符存在正则表达式是一个很好的解决方案。

例如：（[0-9]{5}）

将匹配 - asdfkki12345afdkjsdl、12345adfaksk 或 akdkfa12345

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-04T17:06:06.190

如果您有像“12345”甚至“12345abcd”这样的简单测试用例，则根本不要使用正则表达式。他们不知道他们的速度。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-04T17:20:13.993

对于大多数字符串，蛮力方法将比 RegEx 更快。

一个相当点头的例子是：

```
string strIWantNumFrom = "qweqwe23qeeq3eqqew9qwer0q";

int num = int.Parse(
    string.Join( null, (
        from c in strIWantNumFrom.ToCharArray()
        where c == '1' || c == '2' || c == '3' || c == '4' || c == '5' ||
            c == '6' || c == '7' || c == '8' || c == '9' || c == '0'
        select c.ToString()
    ).ToArray() ) ); 
```

毫无疑问，有很多更快的方法，以及许多取决于字符串的确切格式的优化。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-04T18:33:50.240

这可能会更快...

```
public static string DigitsOnly(string inVal)
        {
            char[] newPhon = new char[inVal.Length];
            int i = 0;
            foreach (char c in inVal)
                if (c.CompareTo('0') > 0 && c.CompareTo('9') < 0)
                    newPhon[i++] = c;
            return newPhon.ToString();
        } 
```

如果您想将其限制为最多五位数，那么

```
public static string DigitsOnly(string inVal)
        {
            char[] newPhon = new char[inVal.Length];
            int i = 0;
            foreach (char c in inVal)
                if (c.CompareTo('0') > 0 && c.CompareTo('9') < 0 && i < 5)
                    newPhon[i++] = c;
            return newPhon.ToString();
        } 
```

# macos - 将功能注入二进制文件的最佳方法

> ID：262493
> 
> 赞同：21
> 
> 时间：2008-11-04T16:58:51.727
> 
> 标签：macos, reverse-engineering, code-injection

将功能插入二进制应用程序（3d 方，封闭源代码）的最佳方式是什么。

目标应用程序在 OSX 上，似乎是使用 gcc 3+ 编译的。我可以看到在二进制文件中实现的函数列表，并且已经调试和隔离了一个我想远程调用的特定函数。

`zoomByFactor(x,y)`具体来说，当我从复杂的 HIDevice 接收到某些数据时，我想调用这个函数——我们称之为 void 。

我可以轻松地修改或将指令注入二进制文件本身（即修补不需要只在 RAM 中进行）。

你会推荐什么作为“很好”这样做的方式？

**编辑：**

我确实需要整个应用程序。所以我不能放弃它并使用图书馆。（对于那些需要道德解释的人：这是一个专有的 CAD 软件，其公司网站自 2006 年以来就没有更新过。我已经为这个产品付了钱（真的花了很多钱）并且有项目我无法轻易从中迁移的数据。该产品非常适合我，但我想使用我最近获得的新 HID。我已经检查了应用程序的内部结构，我相当有信心我可以使用相关数据调用正确的函数并使其正常工作）。

到目前为止，这是我所做的，而且非常贫民窟。

我已经通过这个过程修改了部分应用程序：

```
xxd -g 0 二进制 > binary.hex
cat 二进制.hex | awk '替代工作' > modified.hex
xxd -r modified.hex > newbinary
chmod 777 新二进制

```

我正在做这种跳跃，因为二进制文件几乎有 100 兆大。

我在想的主要是我会在主应用程序循环中的某个地方跳转，启动一个线程，然后返回到主函数。

现在，问题是：我可以在哪里插入新代码？我需要修改符号表吗？或者，我怎样才能使 dylib 自动加载，以便我需要做的唯一“黑客”操作就是将对正常加载的 dylib 的调用插入到主函数中？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-08T21:17:15.963

对于那些对我最终所做的事情感兴趣的人，这里有一个摘要：

我已经研究了几种可能性。它们分为运行时补丁和静态二进制文件补丁。

就文件修补而言，我基本上尝试了两种方法：

1.  修改二进制代码段 (__TEXT) 中的程序集。

2.  修改 mach 标头中的加载命令。

第一种方法需要有可用空间，或者您可以覆盖的方法。它还具有极差的可维护性。任何新的二进制文件都需要再次手动修补它们，特别是如果它们的源代码发生了轻微的变化。

第二种方法是尝试将 LC_LOAD_DYLIB 条目添加到 mach 标头中。那里没有很多 mach-o 编辑器，所以很麻烦，但我实际上修改了结构，以便我的条目可以通过`otool -l`. 然而，这实际上并没有工作，因为`dyld: bad external relocation length`在运行时有一个。我假设我需要处理导入表等。如果没有编辑器，这太费力了。

第二条路径是在运行时注入代码。没有太多可以做到这一点。即使对于您可以控制的应用程序（即您启动的子应用程序）。也许有一种方法可以`fork()`启动初始化过程，但我从不这样做。

有 SIMBL，但这要求您的应用程序是 Cocoa，因为 SIMBL 将作为系统范围的 InputManager 并选择性地加载包。我驳回了这一点，因为我的应用程序不是 Cocoa，此外，我不喜欢系统范围的东西。

接下来是 mach_inject 和 mach_star 项目。还有一个名为 PlugSuit 的新项目托管在 google，它似乎只不过是 mach_inject 的一个薄包装器。

Mach_inject 提供了一个 API 来做顾名思义。我确实在代码中发现了一个问题。在 10.5.4 上，mach_inject.c 文件中的 mmap 方法要求存在 MAP_SHARED 或与 MAP_READ 一起使用，否则 mmap 将失败。

除此之外，整个事情实际上像宣传的那样工作。我最终使用 mach_inject_bundle 来完成我原本打算将 DYLIB 静态添加到 mach 标头中的操作：即在模块 init 上启动一个新线程来执行其肮脏的业务。

不管怎样，我已经把它变成了一个wiki。随意添加、更正或更新信息。在 OSX 上几乎没有关于此类工作的信息。信息越多越好。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-04T17:36:12.463

在 10.5 之前的 MacOS X 版本中，您可以使用输入管理器扩展来执行此操作。输入管理器旨在处理诸如非罗马语言的输入之类的事情，其中​​扩展程序可以弹出一个窗口来输入适当的字形，然后将完成的文本传递给应用程序。该应用程序只需要确保它是 Unicode 干净的，而不必担心每种语言和地区的确切细节。

输入管理器被广泛滥用以将各种不相关的功能修补到应用程序中，并且经常破坏应用程序的稳定性。它也正在成为特洛伊木马的攻击媒介，例如“Oompa-Loompa”。MacOS 10.5 收紧了对输入管理器的限制：它不会在 root 或 wheel 拥有的进程中运行它们，也不会在修改了其 uid 的进程中运行它们。最重要的是，10.5 不会将输入管理器加载到 64 位进程中，并且表明即使使用 32 位也是不支持的，并且将在未来的版本中删除。

因此，如果您可以忍受这些限制，那么输入管理器可以做您想做的事情。未来的 MacOS 版本几乎肯定会引入另一种（更安全、更有限）的方式来做到这一点，因为语言输入支持确实需要该功能。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-09-18T22:59:11.300

我相信您也可以使用[DYLD_INSERT_LIBRARIES 方法](http://tlrobinson.net/blog/2007/12/21/overriding-library-functions-in-mac-os-x-the-easy-way-dyld_insert_libraries/)。

[这篇文章](https://stackoverflow.com/questions/3270281/can-gdb-make-a-function-pointer-point-to-another-location)也与您尝试做的事情有关；

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-05-06T14:45:14.540

`mach_star`我最近尝试使用源代码进行注入/覆盖。我最终为它写了一个教程，因为这些东西的文档总是很粗略而且经常过时。

[http://soundly.me/osx-injection-override-tutorial-hello-world/](http://soundly.me/osx-injection-override-tutorial-hello-world/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T17:19:07.083

有趣的问题。如果我对您的理解正确，您希望添加在正在运行的可执行文件中远程调用函数的功能。

如果你真的不需要整个应用程序，你可以去掉 main 函数，把它变成你可以链接的库文件。由您决定如何确保所有必需的初始化都发生。

另一种方法可能是像病毒一样行事。注入一个处理远程调用的函数，可能在另一个线程中。您需要通过将一些代码注入主函数或其他任何合适的地方来启动此线程。您很可能会在初始化、线程安全和/或维护正确的程序状态方面遇到重大问题。

最好的选择（如果可用）是让您的应用程序供应商公开一个插件 API，让您以受支持的方式干净可靠地执行此操作。

如果您采用任何一种破解二进制路线，这将是耗时且脆弱的，但您会在此过程中学到很多东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-10-11T16:07:36.467

在 Windows 上，这很容易做到，实际上被广泛采用，被称为 DLL/代码注入。

有一个用于 OSX 的商业 SDK 允许这样做：[Application Enhancer](http://unsanity.com/haxies/ape)（非商业用途免费）。

# google-maps - 谷歌地图气泡模板

> ID：262504
> 
> 赞同：5
> 
> 时间：2008-11-04T17:00:24.110
> 
> 标签：google-maps

谷歌搜索一直很困难，因为我无法获得足够具体的结果 - 想知道我的 SO-ers 同伴是否有任何见解。是否有任何方便的 CSS/HTML 模板可以轻松地将内容插入到谷歌地图气泡中？我正在拼凑一个快速n-dirty mashup，如果可以避免的话，我想避免花时间手动设置样式。

作为参考，这篇文章有些相关，可能会有所帮助：

*   [google-maps-bubble-work 如何在 css 中格式化](https://stackoverflow.com/questions/203477/how-does-css-formatting-in-a-google-maps-bubble-work)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-07-03T17:20:21.330

我还没有看到任何 GInfoWindows 模板，但它们的样式并不难。只需将所有窗口内容放在一个带有类的 div 中，您可以在样式表中引用该类。

如果您正在寻找更多的自定义，这里有一些第三方扩展提供标准 GInfoWindows 的替代方案：[ExtInfoWindow](http://gmaps-utility-library.googlecode.com/svn/trunk/extinfowindow/)、[PopupMarker](http://gmaps-utility-library.googlecode.com/svn/trunk/popupmarker/)、[EWindow](http://econym.org.uk/gmap/ewindows.htm)和[EBubble](http://econym.org.uk/gmap/ebubble.htm)

# iphone - CATransition 在动画开始之前显示从过渡结束的单帧

> ID：262508
> 
> 赞同：3
> 
> 时间：2008-11-04T17:01:22.597
> 
> 标签：iphone, objective-c, cocoa-touch, core-animation

我正在使用一些最初取自 Apple 示例 ViewTransitions 的代码来交换两个视图。

```
CATransition *animation = [CATransition animation];
[animation setDelegate:self];
[animation setType:kCATransitionFade];
[animation setDuration:0.3f];
[animation setTimingFunction:[CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionLinear]];
[[container layer] addAnimation:animation forKey:@"swap"]; 
```

当我的过渡在设备上执行时，有时我会得到过渡动画最后一帧的单帧闪光，然后动画会流畅播放。这给第二个视图带来了非常不和谐的效果，在平滑动画执行之前它会闪烁然后再次闪烁。

我的示例和 Apple 示例之间的主要区别在于我的视图不是全屏的，我有一个包含两个子视图的容器 UIView，并且我将动画应用到容器层而不是根视图层。我看不出这应该有很大的不同。

此问题在模拟器中根本不会发生，并且在设备上是间歇性的（大约 60-70% 的时间）。是否有其他人看到这种行为，如果有，您是如何解决的？

**更新了更多信息：** 代码最初是多部分动画的一部分，但我将其移动为由按钮触发以隔离问题。在这两种情况下都会出现此问题。

动画代表已实现，但已被删除以尝试隔离问题。

在动画期间视图没有改变，实际上`[container setUserInteractionEnabled:NO]`正在被调用（但问题也发生在没有禁用用户交互的情况下）。

我尝试从过渡中间开始动画并在结束之前使用`setStartProgress`and结束`setEndProgress`，问题仍然存在。

我也尝试过减慢动画持续时间，但没有任何效果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-04T20:55:51.030

要开始回答您的问题，需要更多信息 - 例如，您如何调用该代码（例如，它是作为操作绑定到按钮还是以某种方式自动触发），您是否实现了委托方法来启动和停止动画（以及其中包含的内容），您的视图是否在动画期间的某个时间点发生变化？模拟器和设备之间的时间将关闭 - 你不应该依赖模拟器来测试动画，因为一切都会发生得更快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T12:13:30.523

解决了，我错过了一个我认为无关紧要的关键部分；）在上面的代码示例中设置动画后，我正在以相同的方法交换视图。

将其移至 animationDidStart 委托解决了该问题。

# visual-sourcesafe - SourceSafe 标签搜索

> ID：262510
> 
> 赞同：4
> 
> 时间：2008-11-04T17:01:47.180
> 
> 标签：visual-sourcesafe, label

有没有办法在 Microsoft Visual SourceSafe 6.0d 中搜索所有带有特定标签的文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-03T16:50:35.013

AJ 的想法是正确的，但您只需要使用“dir”命令而不是 get：

```
ss dir -v"LABEL" $\PROJECT -R 
```

这将输出具有该标签的版本的每个文件，格式为：

```
someFile.c;23
someOtherFile.h;3
<filename>;<version> 
```

对于那些感兴趣的人，如果您想快速了解文件的最新版本是什么，您可以执行以下操作：

```
ss dir -v. $\PROJECT -R 
```

玩得开心！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T17:41:21.330

我不认为你可以按标签搜索，但你可以按标签获取。

[来自 MSDN：](http://msdn.microsoft.com/en-us/library/kh8hd2cw(VS.80).aspx)

按标签获取版本：

1.  确保您已在 Visual SourceSafe 资源管理器中设置工作文件夹。请参见如何：设置工作文件夹。
2.  确保您已设置历史记录选项。请参阅如何：查看历史记录。
3.  选择包含要检索的文件的项目。
4.  在工具菜单上，单击显示历史记录。
5.  在“历史选项”对话框中，选择要检索的文件版本，然后单击“确定”。
6.  在“历史记录”对话框中，单击“获取”以检索您选择的文件的版本。
7.  在“获取”对话框中，添加所需的任何其他条目，然后单击“确定”以检索文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-25T08:59:18.997

微软没有在签入/签出的评论上添加简单的搜索功能似乎确实是一个失败。

我找到了这个 [http://www.codeproject.com/KB/cpp/Schiott_SourceReport.aspx](http://www.codeproject.com/KB/cpp/Schiott_SourceReport.aspx)

它将您想要的所有评论提取到文本文件中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-02T15:53:43.887

你可以通过标签获得。
这可能与按标签搜索不同。

Sourcesafe 接受一个标签作为一个有效的版本号，所以它的语法是一样的：

```
ss get -V"my label" $\myproject -R 
```

`my label`这将从项目中获得所有标签`myproject`。

# wpf - XDocument 之上的 ViewModel

> ID：262515
> 
> 赞同：3
> 
> 时间：2008-11-04T17:02:45.667
> 
> 标签：wpf, xaml, mvvm, linq-to-xml

我正在开发一个 WPF 应用程序，它有一个表示 XML 的树视图。我将 XML 加载到 XDocument，然后将 TreeView 绑定到该对象。

现在使用[MVVM 模式](http://blogs.msdn.com/johngossman/archive/2006/04/13/576163.aspx)，我想在**XDocument**之上提供一个**ViewModel**。我应该在 ViewModel 类中实现哪些内容。

 **我在想，

1.  RoutedCommands 绑定到 TreeView 上的 ContextMenu 命令以允许添加节点、删除节点、修改节点等
2.  实际修改视图上的属性和节点名的逻辑。

我是否朝着正确的方向前进？我还应该做些什么来使它更简洁、模块化，同时易于理解。

我应该使用 RoutedCommands 还是实现 ICommand 接口并创建我的命令？使用 CommandBindings 的附加属性怎么样？在我正在谈论的树视图应用程序中这样做有意义吗？我有点不知所措，因为有很多选项可以实现这一点。

有没有人有链接，做这种事情的示例代码？一个参考实现可能是？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-15T08:15:23.397

我和你在一起。我从

(ui) <-> (xml)

其中 xml 表示为 LINQy XElements，所以我收到了 PropertyChange 通知。

然后我添加了一些无状态助手类来帮助我处理 xml（公开属性、验证数据等）。我将 XElements 捆绑在 ObservableCollections 中，以便可以绑定到它们。

阅读有关 MV-VM 的信息，并决定将我的辅助类转换为 ViewModel。问题：Helper 类存在于对 UI 一无所知的数据模型命名空间中。Helper 类知道如何将数据库行转换为 XElement，ViewModel 永远不会看到这一点。帮助类处理 xml。ViewModel 不应该知道或关心。

所以我实际上正在考虑实施

(ui) <-> (viewmodel) <-> (helper) <-> (xml)

但我只是不愿在助手中引发 PropChange 事件，只是为了在视图模型中重新引发它们。

# sql-server - 如何以编程方式在 SQL Server 中启用 READ COMMITTED SNAPSHOT？

> ID：262527
> 
> 赞同：16
> 
> 时间：2008-11-04T17:06:18.297
> 
> 标签：sql-server, transactions, isolation-level, read-committed-snapshot

我需要在 SQL Server 中以编程方式启用 READ COMMITTED SNAPSHOT。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2010-05-06T23:11:09.563

我建议先切换到`single-user`模式。这样可以确保您是唯一的联系。否则，查询可能会暂停。

来自：http: [//msdn.microsoft.com/en-us/library/ms175095.aspx](http://msdn.microsoft.com/en-us/library/ms175095.aspx)

> 设置 READ_COMMITTED_SNAPSHOT 选项时，数据库中只允许执行 ALTER DATABASE 命令的连接。在 ALTER DATABASE 完成之前，数据库中必须没有其他打开的连接。

所以，使用这个 SQL：

```
ALTER DATABASE <dbname> SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
ALTER DATABASE <dbname> SET READ_COMMITTED_SNAPSHOT ON;
ALTER DATABASE <dbname> SET MULTI_USER; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-04T17:10:48.847

```
ALTER DATABASE [dbname] SET READ_COMMITTED_SNAPSHOT ON WITH ROLLBACK AFTER 20 SECONDS 
```

# security - IIS7 - 上传有 ASP 问题的文件

> ID：262531
> 
> 赞同：1
> 
> 时间：2008-11-04T17:06:32.147
> 
> 标签：security, iis-7, file-upload, asp-classic, windows-server-2008

我们刚刚将我们的网站从带有 IS5 的 win2000 移到了 win2008 和 IIS7，我遇到了一些问题。

我有一个文件夹，其中是一个将文件上传到上层文件夹的 ASP 页面，在旧的 IIS 中，我将管理员权限授予具有 ASP 页面的文件夹，它工作正常，文件可以上传到上层文件夹。但是在 IIS7 中我做不到，我给带有 asp 代码的文件夹所有的写入权限，但它不起作用。仅当我授予上层目标文件夹的写入权限时，它才有效。我不会给予目标文件夹完全权限，因为这些是主要的网站文件夹。

那么我该怎么做呢？我怎样才能给一个文件夹一个权限来写入一个没有这个权限的上层文件夹？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T10:11:49.923

一个可能的原因是您尝试使用 MapPath 访问父级，但由于尚未启用父级路径而失败。

由于 IIS6，默认情况下阻止代码访问父文件夹的能力。为此，必须启用父路径。在 IIS7 中，可以在服务器、站点、应用程序或文件夹级别启用父路径。在 IIS 管理器中，单击要为其启用此功能的站点、应用程序或文件夹，双击 ASP 图标，在“行为”部分将“启用父路径”设置为 True。

# c# - 如何手动滚动面板？

> ID：262534
> 
> 赞同：16
> 
> 时间：2008-11-04T17:07:35.670
> 
> 标签：c#, .net, winforms

我想使用 Panel.AutoScroll 为真时可用的相同功能，但滚动条不可见。

为此，我需要知道如何使用代码中的函数向左/向右向上/向下滚动。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-04T21:50:41.060

您应该能够使用组件的 VerticalScroll 和 Horizo​​ntalScroll 属性：

```
c.HorizontalScroll.Value += 100;
c.VerticalScroll.Value = c.VerticalScroll.Maximum; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-07T11:25:41.460

好吧，如果您不想使用 Autoscroll 属性，那么我很久以前就使用过一种方法。

*   在面板里面放一个面板。把滚动条控件放在父面板上，然后用滚动条改变里面面板的Top属性。

它很简单，而且效果很好。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-01-07T10:42:49.847

面板上可能有一个属性可以执行此操作，或者您可以遍历所有子面板并调整它们的位置。

例如。将所有控件移动 10 px：

```
int xoffset = 10;

foreach(Control c in panel1.Controls)
    c.Location.X += xoffset; 
```

控件可以移动到负位置以使它们移出面板，同样它们可以具有大于面板大小的位置值以使它们移出面板。

# c# - Visual Basic 自动导入命名空间

> ID：262535
> 
> 赞同：2
> 
> 时间：2008-11-04T17:07:45.280
> 
> 标签：c#, vb.net, visual-studio

在 C# 中，一些默认名称空间（例如 System.Collections）无需使用 blah 输入即可列出。在 Visual Basic 中，它们不是您的进口商品。有没有办法强制 vb 自动导入一些默认名称空间或 VB 的工作方式与 C# 不同？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-04T17:17:44.903

我认为 John Rudy 发布的第一个项目就是您要查找的内容 - 将它们添加到项目属性中。

但是，VB.Net 的工作方式也与 C# 不同，因为在 VB 中导入命名空间的含义与在 C# 中不同。当您在 VB 中导入命名空间时，它也会将子命名空间带入“范围内”，从某种意义上说。

以`System`默认导入的命名空间为例。因为 System 命名空间是导入的，所以您不必像在 C# 中那样首先键入`System.`来引用子命名空间（如 ）。`IO`因此，开箱即用，您可以在 VB 中这样说：

```
If IO.File.Exists(MyFile) Then .... 
```

现在这在 C# 中是不可能的。您要么还必须导入`System.IO`，然后只需说出`File.Exists()`或列出 System 命名空间：`System.IO.File.Exists()`.

它可能看起来不是很重要，但一段时间后你真的会习惯这个 VB 功能，而且它比你想象的更方便。我提出这一切是因为此功能的最终结果是您通常不想在 VB 中导入与在 C# 中一样多的命名空间。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-04T17:11:49.953

我不确定你在问什么。我可以在那里看到两个潜在的问题：

1.  你能改变VB自动导入吗？
2.  你能在 C# 中获得自动导入行为吗？

对于＃1，是的，您可以。假设 Visual Studio 2005 或更高版本，进入您的项目属性，然后选择 References 选项卡。自动导入在视图底部的“导入的命名空间”下列出。

对于＃2，我不知道。我从未在 Visual C# 中看到过这种行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T23:10:38.987

我不相信 Visual Studio 默认为 C# 或 VB 执行此操作。

但是，Jetbrains Resharper 插件会自动为您导入命名空间，就像 Eclipse 在您使用 CTRL+SHIFT+O 时所做的一样。

# excel - 识别基于文本的单元格中的无效字符

> ID：262537
> 
> 赞同：1
> 
> 时间：2008-11-04T17:09:00.020
> 
> 标签：excel, vba

我最近继承了一个需要添加验证逻辑的 VBA 宏。我需要能够确定基于文本的单元格中的任何字符是否是非 ASCII 字符（即二进制值 > 0x7F）。单元格可能包含一些需要保留的回车控制值（特别是换行符）（因此 CLEAN 函数不适用于此验证）。我尝试了 IsText 函数，但发现它将 UTF-8 字符序列解释为有效文本（我不想要）。

我不需要实际操作字符串，我只想向运行宏的用户显示一个错误，告诉他特定单元格中有无效（非 ASCII）字符。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-04T22:34:41.067

如果您想要一种技术纯正的方法，您可以尝试使用正则表达式。在 VBA 中添加对 Microsoft 脚本库的引用，然后尝试此代码。它看起来有点复杂，但是您会被正则表达式的功能所震撼，并且您将拥有一个有价值的工具以供将来使用。

```
Function IsTooHigh(c As String) As Boolean

Dim RegEx As Object
Set RegEx = CreateObject("vbscript.regexp")
With RegEx
 .Global = True
 .MultiLine = True
 .Pattern = "[^\x00-\x7F]"
End With

IsTooHigh = RegEx.Test(c)

End Function 
```

如果字符串 c 中的任何字符不是 (^) 在 0 (x00) 到 127 (x7F) 范围内，则此函数给出 TRUE。

你可以用谷歌搜索“正则表达式”和任何你需要做的事情，并从几乎任何语言中得到答案，因为像 SQL 一样，正则表达式模式似乎与语言无关。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-04T17:15:17.997

asc(character) 命令将字符转换为它的 ASCII 值。

hex(asc(character)) 将字符转换为它的 HEX 值。

完成后，您可以轻松地进行一些比较以确定数据是否错误，并在需要时抛出错误。

这是一些示例代码： [http ://www.freevbcode.com/ShowCode.asp?ID=4486](http://www.freevbcode.com/ShowCode.asp?ID=4486)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-09T12:29:38.977

```
Function IsGoodAscii(aString as String) as Boolean
Dim i as Long
Dim iLim as Long
i=1
iLim=Len(aString)

While i<=iLim
    If Asc(Mid(aString,i,1))>127 then
        IsGoodAscii=False
        Exit Function
    EndIf
    i=i+1   
Wend

IsGoodAscii=True
End Function 
```

# java - 如何找到 Java SE 6 update 10 的源代码？

> ID：262538
> 
> 赞同：1
> 
> 时间：2008-11-04T17:09:12.003
> 
> 标签：java

例如，在[Java SE 下载](http://java.sun.com/javase/downloads/index.jsp)中，我可以下载：

*   Java SE 运行时环境 (JRE) 6 更新 10
*   Java SE 开发工具包 (JDK) 6 更新 10

但我找不到更新 10 的任何源代码。如果我单击[Java SE 下载页面上的 Java SE 6 JDK 源代码](http://download.java.net/jdk6/6u3/promoted/b05/index.html)，似乎我只能下载“JDK 6u3 源”的源代码。我在哪里可以找到更新 10 的来源？如果没有，而我使用更新 10 进行开发，如果我选择调试并“步入”JDK 方法的源代码，会不会出现严重的同步问题？（似乎应该如此。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T17:12:19.000

我下载的 JDK 1.6.0_10 已经包含了 src.zip。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T17:19:16.677

库的 Java 源代码应包含在 JDK 安装中。

至于整个 JDK 的源代码，Sun 已经表示，除非社区从 OpenJDK7 版本向后移植它们（即 Sun 不是自己做这项工作），否则 6u10 的更改不会使其成为 OpenJDK6 版本。

# sql-server - 不使用自动递增数字作为主键的原因

> ID：262547
> 
> 赞同：19
> 
> 时间：2008-11-04T17:12:18.283
> 
> 标签：sql-server, primary-key

我目前正在研究其他人的数据库，其中主键是通过包含表名列表和最后使用的主键的查找表生成的。存储过程会增加该值并检查它的唯一性，然后再将其返回给调用“插入”SP。

使用这样的方法（或仅生成 GUID）而不是仅使用身份/自动编号有什么好处？

我不是在谈论实际上“意味着”诸如 ISBN 或产品代码之类的主键，只是唯一标识符。

谢谢。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-11-04T17:13:15.893

在您使用复制的情况下，自动生成的 ID 可能会导致问题（我相信您发现的技术可以！）。在这些情况下，我通常选择 GUID。

如果您不太可能使用复制，那么自动递增的 PK 很可能会正常工作。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-11-04T17:57:58.830

使用自动编号本身并没有错，但有一些理由不这样做。尽管如此，正如 dacracot 所说，推出自己的解决方案并不是最好的主意。让我解释。

不在每个表上使用自动编号的第一个原因是您最终可能会合并来自多个表的记录。假设您有一个 Sales Order 表和一些其他类型的 order 表，并且您决定提取一些公共数据并使用多表继承。拥有全局唯一的主键很好。这类似于 bobwienholt 所说的合并数据库，但它可以发生在数据库中。

其次，其他数据库不使用这种范例，而其他范例（例如 Oracle 的序列）要好得多。幸运的是，可以使用 SQL Server 模拟 Oracle 序列。一种方法是为整个数据库创建一个自动编号表，称为 MainSequence 或其他。数据库中没有其他表将使用自动编号，但任何需要自动生成主键的人都将使用 MainSequence 来获取它。这样，您无需自己构建即可获得 dacracot 所谈论的所有内置性能、锁定、线程安全等。

另一种选择是将 GUID 用于主键，但我不建议这样做，因为即使您确定人类（甚至是开发人员）永远不会阅读它们，也可能有人会阅读它们，而且这很难。更重要的是，在 T-SQL 中很容易隐式转换为整数，但隐式转换为 GUID 会遇到很多麻烦。基本上，它们是不方便的。

在构建新系统时，我建议使用专用表来生成主键（就像 Oracle 序列一样）。对于现有的数据库，我不会特意去改变它。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-11-04T18:15:42.587

来自[编码恐怖](https://blog.codinghorror.com/primary-keys-ids-versus-guids/ "编码恐怖")：

GUID 优点

*   每个表、每个数据库、每个服务器都是唯一的
*   允许轻松合并来自不同数据库的记录
*   允许跨多个服务器轻松分布数据库
*   您可以在任何地方生成 ID，而不必往返于数据库
*   大多数复制方案无论如何都需要 GUID 列

GUID 缺点

*   它比传统的 4 字节索引值大 4 倍；如果您不小心，这可能会对性能和存储产生严重影响
*   调试麻烦（其中 userid='{BAE7DF4-DDF-3RG-5TY3E3RF456AS10}'）
*   生成的 GUID 应该是部分顺序的，以获得最佳性能（例如，SQL 2005 上的 newsequentialid()）并启用聚集索引

这篇文章提供了很多关于决定 GUID 还是自动增量的良好外部链接。如果可以的话，我会选择 GUID。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-11-04T17:15:27.480

递增的过程方法必须是线程安全的。如果没有，您可能无法获得唯一编号。另外，速度一定要快，否则会成为应用瓶颈。内置函数已经考虑了这两个因素。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-11-04T17:15:57.807

客户端能够预先分配一大堆 ID 以进行批量插入，而不必随后使用插入的 ID 更新其本地对象，这很有用。然后是整个复制问题，正如 Galwegian 所提到的。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-30T04:05:55.950

这是自动递增整数作为键的事情：

您必须先发布记录，然后才能访问它。这意味着，在您发布记录之前，您不能，例如，准备将存储在另一个表中的相关记录，或者许多其他可能的原因中的任何一个，这些原因可能有助于访问新记录的唯一性id，在发布之前。

以上是我的决定因素，是采用一种方法还是另一种方法。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-04T17:17:40.627

使用唯一标识符将允许您合并来自两个不同数据库的数据。

也许您有一个应用程序在多个数据库中收集数据，然后在一天中的不同时间与主数据库“同步”。在这种情况下，您不必担心主键冲突。

或者，您可能想在实际创建记录之前知道它的 ID。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-30T03:51:38.693

> 我对自动递增键的主要问题是**它们没有任何意义**

在我看来，这是对主键的**要求**——除了识别记录之外没有其他理由存在。如果它没有现实世界的意义，那么它就没有现实世界的改变理由。一般来说，您不希望主键更改，因为您必须搜索替换整个数据库或更糟。我对那些我认为是独一无二的、不变的事情感到惊讶，但几年后并没有发生。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-04T17:15:45.467

一个好处是它可以让数据库/SQL 更加跨平台。SQL 可以在 SQL Server、Oracle 等上完全相同...

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-04T17:20:40.233

我能想到的唯一原因是代码是在`sequences`发明之前编写的，而代码忘记了；）

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-04T17:24:01.927

对于大多数帖子的当前方法对我有意义的场景（复制是可能的），我更愿意使用 GUID。如果复制是问题，那么这样的存储过程必须知道必须链接的其他服务器以确保密钥的唯一性，这将使其非常脆弱并且可能是一种糟糕的方法。
我使用不是自动递增标识的整数主键的一种情况是强制外键约束的很少更改的查找表的情况，它将在数据消耗应用程序中具有相应的枚举。在那种情况下，我想确保枚举映射在开发和部署之间是正确的，尤其是在有多个产品服务器的情况下。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-04T17:44:24.707

另一个潜在的原因是您故意想要随机密钥。例如，如果您不希望爱管闲事的浏览器浏览您在数据库中的每个项目，这可能是可取的，但它并不足以保证实际的身份验证安全措施。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-11-04T18:17:14.220

使用 GUID 主键而不是自动递增主键的一个有用的附带好处是，您可以为客户端的新行分配 PK 值（实际上您必须在复制场景中执行此操作），从而节省您的检索您刚刚在服务器上添加的行的 PK 的麻烦。

GUID PK 的缺点之一是 GUID 字段上的连接速度较慢（除非最近发生了变化）。使用 GUID 的另一个好处是尝试向非技术经理解释为什么 GUID 冲突不太可能发生是很有趣的。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-11-05T14:42:59.613

我对自动递增键的主要问题是它们没有任何意义。

**对于某些字段提供唯一性**（无论是单独还是与另一个字段组合）的表，我会选择使用它。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-30T04:04:13.740

Galwegian 的回答不一定正确。

使用 MySQL，您可以为每个数据库实例设置一个键偏移量。如果你将它与足够大的增量结合起来，它会很好。我确信其他供应商会有某种类似的设置。

假设我们有 2 个要复制的数据库。我们可以通过以下方式进行设置。

```
increment = 2
db1 - offset = 1
db2 - offset = 2 
```

这意味着

db1 将具有键 1、3、5、7....

db2 将具有键 2、4、6、8....

因此，我们不会在插入时发生键冲突。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2008-11-04T17:26:52.467

这样做的唯一真正原因是与数据库无关（如果不同的数据库版本使用不同的自动编号技术）。

这里提到的另一个问题是在多个地方创建记录的能力（比如在中心办公室以及在旅行用户的笔记本电脑上）。但是，在这种情况下，您可能需要类似“站点代码”之类的东西，该代码对于每个安装都唯一，并以每个 ID 为前缀。

# windows - Windows 2000 Server 的安全 FTP

> ID：262554
> 
> 赞同：1
> 
> 时间：2008-11-04T17:14:09.607
> 
> 标签：windows, ftp, security, windows-server-2000, ftps

有人可以推荐一个在 Windows Server 2000 上运行良好的安全 FTP 实现吗？我正在将文件上传到 IIS 下的虚拟目录和 Web 应用程序中，而现有的提供程序显然不安全或不加密。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T17:37:50.463

你试过filezilla服务器吗？[http://filezilla-project.org/](http://filezilla-project.org/)

它支持基于 SSL/TLS 的 FTP

签出 - [http://wiki.filezilla-project.org/FileZilla_FTP_Server](http://wiki.filezilla-project.org/FileZilla_FTP_Server)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T17:19:16.240

[http://www.serv-u.com/](http://www.serv-u.com/)

很好。它们同时支持 ftp/ssl 和 Sftp。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T17:19:36.427

这个解决方案需要花钱；尽管如此，我们之前已经向一些客户推荐过它，因为它的设置非常简单。[http://www.serv-u.com/](http://www.serv-u.com/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T17:20:17.207

[免费 SSHD](http://www.freesshd.com/)运行良好。它支持远程控制台以及文件传输，以及安全端口转发。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-21T01:24:18.697

[CrossFTP Server](http://www.crossftp.com/)，免费并作为安全的 FTP 服务器提供 FTP/TLS 支持。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-27T00:21:46.973

尝试[CompleteFTP](http://www.enterprisedt.com/products/completeftp/overview.html)。它是一款快速、紧凑、易于安装的 Windows 服务器，支持 SFTP 和 FTPS。

而且您无需购买最昂贵的版本即可获得 SFTP 支持 - 只需 199 美元即可获得 FTP、FTPS 和 SFTP。

# c# - 在 C# 中定义不同类型的数字

> ID：262555
> 
> 赞同：22
> 
> 时间：2008-11-04T17:14:10.870
> 
> 标签：c#, numbers

您可以在 C# 中以各种方式定义数字，

```
1F // a float with the value 1
1L // a long with the value 1
1D // a double with the value 1 
```

我个人正在寻找哪个 a `short`，但是为了使这个问题成为人们更好的参考，您可以应用的所有其他数字文字的后缀是什么？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-11-04T17:47:16.293

```
Type        Suffix    .NET Framework Type                  
-------------------------------------------------------------------------------------
decimal     M or m    System.Decimal
double      D or d    System.Double
float       F or f    System.Single
int         [1]       System.Int32
long        L or l    System.Int64 
```

[1] 当整数文字没有后缀时，它的类型是可以表示其值的类型中的第一个：int、uint、long、ulong。

当整数文字仅指定 U 或 u 后缀时，它的类型是这些类型中第一个可以表示其值的类型：uint、ulong。

当整数文字仅指定 L 或 l 后缀时，它的类型是这些类型中第一个可以表示其值的类型：long、ulong。

当整数文字同时指定 U 或 u 和 L 或 l 后缀时，它的类型是这些类型中第一个可以表示其值的类型：ulong。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-04T17:37:50.570

# 整数

后缀 - 说明

none - int、uint、long 和 ulong 中的第一个

U 或 u - uint、ulong 的第一个

L 或 l - long, ulong 的第一个

UL、Ul、uL、ul、LU、Lu、lU 或 lu - ulong

# 真实的

后缀 - 说明

无 - 双

F 或 f - 浮点数

D 或 d - 双

M 或 m - 十进制

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-04T17:20:55.707

为了钱：

```
decimal mon = 1m; 
```

输出：

```
string curr = String.Format("{0:C}", mon);  //output $1.00 
```

# .net - 从 .Net Windows 服务打印 tiff 文件

> ID：262561
> 
> 赞同：3
> 
> 时间：2008-11-04T17:15:42.223
> 
> 标签：.net, printing, service

我们已经构建了一个应用程序，可以接收多个不同格式的文件，pdf、tiff、jpeg、doc 等。接收后，使用安装在服务器本地的第三方打印驱动程序将它们转换为 tiff 文件并设置为默认打印机。为此，我们使用命令行和参数打开 System.Diagnostics.Process，以使用适当的应用程序打印文件。

现在新版本需要是 Windows 服务，到目前为止一切正常，除了打印部分。每当该过程开始时，它永远不会引发异常，并且一切似乎都工作正常，但文件永远不会打印出来。如果我打开任务管理器，我可以看到 MS Paint 已执行（如果是 jpeg 文件），但没有输出 tiff 文件。

作为旁注，最终文件需要是 tiff 文件，因为我们的客户使用了另一个第三方工具，这是它支持的唯一格式。

任何帮助将不胜感激。塞尔吉奥·罗梅罗

我们使用的代码如下：

```
private const string PROCESS_COMMAND = "mspaint.exe";  
private const string PROCESS_ARGUMENTS = @"""{0}""";  

Process proc = new Process();  
ProcessStartInfo startInfo = new ProcessStartInfo();  
string error = string.Empty;  

startInfo.FileName = PROCESS_COMMAND;  
startInfo.Arguments = string.Format(PROCESS_ARGUMENTS, fileFullPath);  
startInfo.UseShellExecute = false;  
startInfo.RedirectStandardError = true;  

proc.EnableRaisingEvents = false;  
proc.StartInfo = startInfo;  

proc.Start();  

using(StreamReader errorReader = proc.StandardError)  
{  
    string standardError = string.Empty;  
    while((standardError = errorReader.ReadLine()) != null)  
    {  
        error += standardError + " ";  
    }  
}  
proc.WaitForExit(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-04T17:45:08.730

我建议的第一件事是让**服务在特定用户的上下文中运行**。然后以该用户身份登录服务器并确保打印机已安装，设置为默认值等。

其次，**放弃 MS Paint 解决方案**以简化事情。您可以使用 System.Drawing.Image.FromFile(YourImageFilePath) 在 .NET 中加载图像，然后使用 PrintDocument 完成剩下的工作......

创建一个 PrintDocument 对象，定义您的设置（要使用的打印机、边距等），为文档的 PrintPage 事件添加一个处理程序，该处理程序按照 e.Graphics.DrawImage(YourTiffImageObject, New Rectangle(0, 0, e.MarginBounds.Width, e.MarginBounds.Height)) 将 TIFF 图像绘制到页面上。最后，您调用 PrintDocument 对象的 .Print 方法，然后它就消失了。

这样，.NET 正在处理打印——而不是一些随机的第三方应用程序。

当您一次处理多个页面时，会有一些小的代码更改（主要调用 SelectActiveFrom 以更改多页 TIFF 上的页面并在 PrintPage 事件中设置 e.HasMorePages = True 直到您阅读最后一页）但这一切都相当容易且有据可查。

*更新：* 为了完整起见，我想我应该添加其他人已经提到的内容......某些应用程序**可能需要桌面访问才能正常运行**。如果您坚持使用 MS Paint，您可能需要在服务属性中启用“允许服务与桌面交互”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T17:26:22.343

我不确定有关 MSPaint 的部分...但是如果您的应用程序作为控制台应用程序而不是作为服务工作，则服务器可能无权执行您的用户帐户所做的事情。

您可能希望尝试登录服务以排除权限问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T17:34:48.190

检查用于安装服务的用户是否具有正确的打印权限和/或对文件的访问权限，我还建议使用事件日志记录

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T17:40:15.247

从控制台应用程序运行时，MSPaint 是否打开？如果是这样，可能是因为您的服务正在无头运行；它无权显示 UI。因此，MSPaint 基本上可以保释，因为它无法在不出错的情况下打开其 UI。

为什么不直接从.NET 打印呢？您可以通过服务执行此操作。但是，有一些关于 System.Printing 的警告不是为服务使用而设计的。我不知道为什么，寿。我以前做过，没有问题...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T18:52:47.037

我们在尝试启动应用程序时遇到了各种问题。通常是使用安全/凭据，或者也可以是启用“允许服务与桌面交互”之类的东西，因为应用程序（在本例中为 mspaint）可能需要它。

话虽如此，我同意 Kevin 的观点，放弃 MSPaint 并在 .NET 中本地打印，或者如果只是转换问题，则使用 .NET 进行转换。另一种方法是使用诸如 LibTIFF 之类的库或什至诸如 Ghostscript 之类的库来研究比 MSPaint 更复杂的东西，以处理 .NET 内部可能不支持的格式，例如 PDF。

# javascript - 列出对象的内置属性

> ID：262573
> 
> 赞同：6
> 
> 时间：2008-11-04T17:18:09.597
> 
> 标签：javascript, reflection, properties

有没有办法让我遍历 Javascript 对象的内置属性？

for...in 让我接近我想去的地方，但是“for...in 循环不会迭代内置属性。”

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2011-08-01T01:43:25.130

我意识到这个问题已经存在三年了，但是现在，有了 ES5，就有可能：

`>>> Object.getOwnPropertyNames(Object)`

`["prototype", "getPrototypeOf", "getOwnPropertyDescriptor", "keys", "defineProperty", "defineProperties", "create", "getOwnPropertyNames", "isExtensible", "preventExtensions", "freeze", "isFrozen", "seal", "isSealed", "length", "arity", "name", "arguments", "caller"]`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-05T23:49:18.807

答案是不。您不能枚举不可枚举的属性。然而，至少有两种方法可以解决这个问题。

首先是生成所有可能的字符组合以用作测试属性名称（想想：a、b、c、... aa、ab、ac、ad、...）。鉴于标准社区以提出非常长的方法名称（getElementsByTagNames、propertyIsEnumerable）而闻名，这种方法需要一些耐心。:-)

另一种方法是从一些预定义的列表中测试已知的本地属性。

例如：对于一个，`array`您将测试所有已知的本机属性`Function.prototype`：

```
prototype caller constructor length name apply call toSource toString valueOf toLocaleString 
```

...以及继承自的东西`Object.prototype`：

```
__defineGetter__ __defineSetter__ hasOwnProperty isPrototypeOf __lookupGetter__
__lookupSetter__ __noSuchMethod__ propertyIsEnumerable unwatch watch 
```

...以及继承自的东西`Array`：

```
index input pop push reverse shift sort splice unshift concat join slice indexOf lastIndexOf 
filter forEach every map some reduce reduceRight 
```

..最后，可选地，您正在测试的对象的每个可枚举属性：

```
for (var property in myArrayObject) myPossibleProperties.push( property ); 
```

然后，您将能够测试其中的每一个，以查看它们是否存在于对象实例中。

这不会显示未知的不可枚举成员（未记录或由其他脚本设置），但允许您列出可用的本机属性。

[我在Mozilla Developer Center](https://developer.mozilla.org/En/Core_JavaScript_1.5_Reference/Global_Objects/Array)和[MSDN](http://msdn.microsoft.com/en-us/library/cc868fee(VS.71).aspx)上找到了有关本机`Array`属性的信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T19:01:45.893

当您说“内置属性”时，您指的是哪一组属性？

来自 Douglas Crockford 的[“JavaScript - The Good Parts”](http://oreilly.com/catalog/9780596517748/)：

> for in 语句可以遍历对象中的所有属性名称。枚举将包括所有属性——包括你可能不感兴趣的函数和原型属性——因此有必要过滤掉你不想要的值。最常见的过滤器是 hasOwnProperty 方法和使用 typeof 来排除函数：
> 
> ```
> var name; 
> for (name in another_stooge) 
> {
>     if (typeof another_stooge[name] !== 'function') {
>         document.writeln(name + ': ' + another_stooge[name]);
>     } 
> } 
> ```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-11-04T18:48:19.713

这将适用于 JSON。它没有经过太多测试：

```
<style>
.tree {
    margin-left:5px;
}
</style>
<div id='out'></div>
<script type="text/javascript">
data = {"feep":{"bar":{"baz":"37628","quux":{"a":"179","b":"7"}},"foo":"1025"},"Bleh":"1234"}
$('out').innerHTML = renderJSON(data)

function renderJSON(obj) {
    var keys = []
    var retValue = ""
    for (var key in obj) {
       //$('out').innerHTML = $('out').innerHTML +"<br />" + key + ", " + obj[key]      
        if(typeof obj[key] == 'object') {
            retValue += "<div class='tree'>" + key                      
            retValue += renderJSON(obj[key])
            retValue += "</div>"
        }
        else {
            retValue += "<div class='tree'>" + key + " = " + obj[key] + "</div>"
        }

       keys.push(key)
    }
    return retValue

}
</script> 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2010-08-12T15:14:56.043

不，您不能列出对象的内置属性。但是你可以参考实施者的参考。例如，要了解在 Firefox 上实现的 Math 对象的所有方法和属性，您将使用 Firefox 的 Javascript 数学参考：[https ://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Math](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Math)

# c++ - 从 ATL C++ 客户端调用 Axis2 Web 服务

> ID：262579
> 
> 赞同：0
> 
> 时间：2008-11-04T17:19:23.743
> 
> 标签：c++, soap, atl, axis2

我在 Tomcat5.5 上使用 Axis2 发布了一个简单的 POJO Web 服务，我尝试使用 ATL C++ 客户端使用它，但它失败了。对 C# 客户端执行相同的操作。问题是 ATL 客户端发送的肥皂体看起来像

```
<soap:Body>< xmlns="http://fa.test.com/xsd"></></soap:Body></soap:Envelope> 
```

注意中间的无效元素。我怀疑它与 UTF-8 有关，因为 C# 发送的标头

```
<?xml version='1.0' encoding='utf-8'?> 
```

而 ATL 客户端则没有。此外，当我查看一些 ATL SOAP 内部时，我注意到一个结构有两个成员：szName 和 szwName。第一个是空的并产生元素，第二个有一个有效的（？）名称 testResponse（我调用的方法称为“test”）。

需要关于从这里去哪里的建议？

更多详细信息：来自 ATL 客户端的完整消息：

```
POST /axis2/services/EnterpriseService.EnterpriseServiceHttpSoap11Endpoint/ HTTP/1.1
Content-Length: 304
Content-Type: text/xml; charset=utf-8
SOAPAction: "urn:test"
Accept: text/xml
Host: xxxxxxx
User-Agent: Microsoft-ATL-Native/8.00

<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/"><soap:Body>< xmlns="http://fa.test.com/xsd"></></soap:Body></soap:Envelope> 
```

来自 Axis2 的响应：

```
HTTP/1.1 500 Internal Server Error
Server: Apache-Coyote/1.1
Content-Type: text/xml;charset=utf-8
Transfer-Encoding: chunked
Date: Tue, 04 Nov 2008 15:31:57 GMT
Connection: close

<?xml version='1.0' encoding='utf-8'?><soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"><soapenv:Body><soapenv:Fault><faultcode>soapenv:Server</faultcode><faultstring>com.ctc.wstx.exc.WstxUnexpectedCharException: Unexpected character '>' (code 62); expected an element name.&#xd;
 at [row,col {unknown-source}]: [1,276]</faultstring><detail /></soapenv:Fault></soapenv:Body></soapenv:Envelope> 
```

哦，这是来自 C# 客户端的好请求：

```
POST /axis2/services/EnterpriseService.EnterpriseServiceHttpSoap11Endpoint/ HTTP/1.1
Via: 1.1 ANGEL-ISLAND
Content-Type: text/xml; charset=utf-8
User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; MS Web Services Client Protocol 2.0.50727.1433)
Host: xxxxxxx:8080
SOAPAction: "urn:test"
Connection: Keep-Alive
Content-Length: 236

<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"><soap:Body /></soap:Envelope> 
```

在 C# 的情况下，soap:body 是空白的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-08T15:32:41.900

ATL Server 完全能够正确生成请求。看起来 WSDL 有一些问题。我粗略的测试生成了请求：

```
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xmlns:xsd="http://www.w3.org/2001/XMLSchema" 
   xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/">
  <soap:Body></soap:Body></soap:Envelope> 
```

对于带有`SoapParameterStyle.Bare`. `<wsdl:part>`输入消息中有元素吗？您可以发布 WSDL 服务描述吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-08T02:20:37.617

我认为它与 UTF-8 没有任何关系。

来自 C# 的有效消息在 soap:Body 中没有任何内容，而无效消息有 . 看起来 ATL C++ 客户端试图在 SOAP 主体中强制执行某些内容，而根本不应该有任何内容。

另请注意，C# 客户端的消息中不包含 testResponse 元素。

我会在它使用 szName 的地方再看一下代码，看看它是否在哪里生成 . 它不应该那样做。

# sql-server - 为什么 SQL Server 的 GUI 会破坏我的视图？

> ID：262581
> 
> 赞同：2
> 
> 时间：2008-11-04T17:19:31.717
> 
> 标签：sql-server

当我在 SQL Server 2005 中创建一个视图并且后来有人在 GUI 修改模式下打开它时，它有时会完全重新排列我的连接。通常，它实际上不再可读。如果我在 GUI 中查看它，它也会与我最初编写的内容有所不同。有时，连接线甚至不再指向某个字段，并且连接符号具有“fx”。我认为它已经为我“优化”了它。有没有办法防止这种情况发生？“fx”是什么意思？

最初是这样的：

从 dbo.Stop 左外连接 dbo.StopType ON dbo.Stop.StopTypeID = dbo.StopType.StopTypeID 左外连接 dbo.CityState ON dbo.Stop.City = dbo.CityState.City AND dbo.Stop.State = dbo.CityState .State 左外连接 dbo.vwDrivers ON dbo.Stop.DriverID = dbo.vwDrivers.DriverID 左外连接 dbo.truck ON dbo.Truck.TruckID = dbo.Stop.TruckID 内连接 dbo.vwTicketIDFirstStopLastStop ON dbo.vwTicketIDFirstStopLastStop.TicketID = dbo.stop.ticketid 左外连接 dbo.Company ON dbo.Company.CompanyID = dbo.vwTicketIDFirstStopLastStop.BillToCompanyID

现在是这个。

从 dbo.Truck 右外连接 dbo.Stop 内连接 dbo.StopType ON dbo.Stop.StopTypeID = dbo.StopType.StopTypeID 左外连接 dbo.CityState ON dbo.Stop.City = dbo.CityState.City 和 dbo.Stop。 State = dbo.CityState.State 左外连接 dbo.vwDrivers ON dbo.Stop.DriverID = dbo.vwDrivers.DriverID ON dbo.Truck.TruckID = dbo.Stop.TruckID 左外连接 dbo.vwTicketIDFirstStopLastStop 左外连接 dbo.Company ON dbo.Company.CompanyID = dbo.vwTicketIDFirstStopLastStop.BillToCompanyID ON dbo.vwTicketIDFirstStopLastStop.TicketID = dbostop.ticketid

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-04T23:38:08.973

你不能。这就是为什么你永远不应该使用它的原因。

“Fx”表示连接不是简单的列到列的链接，而是涉及到一个函数（当然这也是它不能指向字段的原因）。但是，它不应该自己这样做，

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T12:50:13.023

我讨厌视图 GUI

我使用 RightClick->ScriptViewAs->Alter To->New Query Editor Window

好多了:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T23:39:31.433

这是视图 GUI 将 SQL 解析为它自己的内部 DOM 样式格式然后将其写回的结果 - 与 HTML 编辑器采用 XHTML 并以不同方式发出与您想要的方式不同的内容的方式非常相似 :(

# c# - 如何在 Word 共享加载项中挂钩按键事件？

> ID：262583
> 
> 赞同：2
> 
> 时间：2008-11-04T17:19:36.723
> 
> 标签：c#, ms-word, add-in

我需要能够在将所有按键事件传递给 Word 文档之前获取它们。我想对键进行特殊处理，根据插件所处的模式，这些键可能会或可能不会发送到 Word 文档。我只想要属于文档的按键事件，我不想为弹出窗口或其他对话框挂钩事件。

我读过一些关于智能标签的东西，但不知道它们是如何工作的。

如果我必须对文档窗口进行子类化，我怎样才能获得窗口句柄？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-14T16:16:02.303

使用 SetWindowsHookEx( WH_KEYBOARD_LL, ... 收听击键。

# javascript - 为什么这个事件监听器不起作用？

> ID：262593
> 
> 赞同：0
> 
> 时间：2008-11-04T17:23:47.620
> 
> 标签：javascript, jquery, events

```
 $('input[type=checkbox]').unbind().click(function(e){
        $(this).attr('checked', true)
        return false;
    }); 
```

我需要返回 false 因为我在其父级上有一个事件，我不想触发它。它只是不会选中该复选框。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-04T18:06:59.640

```
$('input[type=checkbox]').unbind().click(function(e){
    e.stopPropagation();
}); 
```

编辑：我不确定您需要什么`.unbind()`，但您应该注意，这会取消您在这些复选框上放置的任何其他事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T17:27:23.433

您在 jQuery 选择器的末尾缺少 ]

# visual-studio - 当控件从 Visual Studio 2008 工具箱中删除时添加对项目的引用

> ID：262596
> 
> 赞同：7
> 
> 时间：2008-11-04T17:25:18.927
> 
> 标签：visual-studio, visual-studio-2008

当我将第三方控件拖放到 Visual Studio 中的可视化设计图面上时，控件所需的任何库引用都会自动添加到我的项目中。我有一个已添加到工具箱的第三方控件的继承版本。但是，当我将它拖到表单上时，只添加了对底层第三方库的一些引用。如何指定要添加的其他参考？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-08-05T05:29:22.763

如果您知道包含控件的 DLL 的路径，请阅读[此](http://blogs.thesitedoctor.co.uk/tim/2007/02/13/ImportingReferencing+DLLs+In+Visual+Studio.aspx).

VS2008 和 VS2005 一样。

# linux - 如何通过 STIME 杀死 linux 进程（悬空 svnserve 进程）

> ID：262597
> 
> 赞同：2
> 
> 时间：2008-11-04T17:25:23.310
> 
> 标签：linux, svn, kill

我是 Linux 的新手，并且继承了我们的单个 linux 服务器运行。是我们的SVN服务器，所以比较重要。

原来在我之前维护它的人有一个 cron 任务，当有太多 svnserve 进程正在运行时给他发电子邮件，因为它们似乎悬空而不是正确终止。

问题的第一部分是，鉴于我跑

```
ps -fu cvsuser 
```

并获取进程列表，我怎样才能杀死那些不是今天有 STIME 的进程？例如，像

```
kill where STIME = Oct30 
```

另一个问题是，有谁知道如何避免这些悬空的 svnserve 进程？[（这是另一个问题。）](https://stackoverflow.com/questions/262767/dangling-svnserve-processes)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-04T17:45:27.203

冒着建议你重新设计你的基础设施的风险，我使用 Apache 和 mod dav svn 而不是 svnserve 取得了很好的效果——在过去十年左右的生产使用之后，Apache 的 httpd 是相当防弹的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-04T18:17:55.920

只是为了好玩（GNU bash，版本 3.2.39）

```
ps h -u cvsuser -o pid,start   # h - no header, only output pid and start
    | grep -v ':'              # exclude entries from the last 24 hours
    | egrep -o '^\ *[0-9]+'    # get the pid (handling possible leading space)
    | xargs -i echo kill "{}"  # pretend to kill - take out the echo if you're happy 
```

这依赖于“man ps”标准格式说明中的以下内容：

> 如果进程在 24 小时前开始，则输出格式为“HH:MM:SS”，否则为“mmm dd”（其中 mmm 是三个字母的月份名称）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-12-26T09:10:27.040

`ps`对于我们的 cvs/svn/git 服务器，我们使用了该程序，而不是使用依赖于输出来查找旧进程的 cronjob `timeout`。

```
$ grep server /etc/xinetd.d/svnserve
server          = /usr/bin/timeout
server_args     = 12h /usr/bin/svnserve -i -R -r /svnroot 
```

将“12h”替换为适合您网站的超时时间（尽管我无法想象大多数人需要超过 12 小时才能签出单个 repo）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T17:40:59.240

在我的脑海中，我会做这样的事情：

> ps -fu 用户名 | awk '$5 !~ /[0-9]:[0-9]/ { 打印 $2 }' | xargs 杀死

由于 ps 输出的第五个字段显示了包含月/日（例如 Oct31）和不包含时间（例如 12:32）的旧进程，因此带有 awk 的正则表达式会简单地排除那些第五个字段仍然是时间的进程。我假设（可能是错误的） ps 开始仅显示运行时间超过 24 小时的进程的日期。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T17:48:04.857

要识别和终止进程：

```
ps h -u csvuser -o pid,lstart | grep 'May 29' | sed 's/^ \+//' | 
cut -d ' ' -f 1 | xargs -n 1 kill 
```

ps 命令将查找 csvuser 拥有的所有进程并输出 pid 和开始时间：

```
16324 Thu May 29 04:02:06 2008
22144 Tue Jul 22 04:02:05 2008
11315 Wed Oct  8 04:02:00 2008 
```

grep 命令将找到您要查找的日期

```
16324 Thu May 29 04:02:06 2008 
```

sed 命令将删除用于剪切的前导空格，

cut 命令将仅输出第一个字段：

```
16324 
```

xargs 命令将为传递 pid 作为参数的每一行运行一次 kill 命令。根据需要替换 grep 语句以匹配您需要的任何内容。

至于为什么 svnserve 进程没有正确退出，我不知道，我没有在我的 subversion 服务器上看到这个，你可能应该为此打开一个单独的问题。

# java - 有没有办法将Java代码编译成DLL？

> ID：262603
> 
> 赞同：23
> 
> 时间：2008-11-04T17:27:08.003
> 
> 标签：java, dll

见上面的问题。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-11-04T17:33:19.490

是的，使用 IKVM。

[http://www.ikvm.net/](http://www.ikvm.net/)

而且使用起来非常简单：

```
ikvmc myjar.jar 
```

输出 myjar.dll

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-04T19:38:26.040

还有[gcj](http://gcc.gnu.org/java/)会将类编译为本机格式。

* * *

## 回答 #3

> 赞同：-5
> 
> 时间：2011-08-13T16:39:30.163

最好创建一个 c++ 加载器

1)隐藏控制台

2）运行您的应用程序

# project-management - 团队规模与流程开销的临界点是什么？

> ID：262612
> 
> 赞同：9
> 
> 时间：2008-11-04T17:29:38.967
> 
> 标签：project-management

在团队成长的哪个阶段，流程必须发生巨大变化？一个单独的编码人员可以摆脱源代码控制和大脑。试图将大型预打包软件运送到本地和国际市场的团队必须有更多的准备。

如果您在“流程”方面经历过大的转变：团队的流程是否与当前成员一起成功地改变了，或者团队本身在流程改变到来时大部分都被取代了？哪些重要方面发生了变化，有些是不必要的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-04T18:14:36.410

你会发现很难得到一个定量的答案。这实际上取决于项目的“广度”。如果有一个简单的子系统可以工作，任何超过 1 个人都会导致人们踩到其他人的脚趾。如果你有一个项目有 8 个独立的子系统，那么你可以有 8 个开发人员没有问题。更有可能的是，您将拥有多个不同程度地相互依赖的子系统。哦，无论您使用何种流程，所有这些都是正确的。

选择您想要使用的流程类型（螺旋式、Scrum、瀑布式、CMM 等）以及您想要实施的该流程的重量级版本是另一个问题，而且很困难。这主要是因为人们试图将建筑施工、工厂工作或其他与软件完全不同的行业的流程应用到软件开发中。

在我看来，McConnell 写了最好的软件过程书籍，尽管他的书本身都不是过程书籍。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-04T17:47:33.017

如果我没记错的话，超过五个人的任何事情都会变得很冒险。在那之后，团队之间的沟通路径数量变得非常大。

（2 人 = 1 条路径，3 = 3 条路径，4 = 6 条路径，5 = 10 条路径，依此类推）。

我作为 IT 团队的最后三个地方经历了巨大的流程变化。是的，你会失去一些人，可能也会失去一些更好的人。倒不是他们固执，固守老路，只是这样的改变会带来巨大的压力。有最后期限要达到，并且需要满足质量要求。人们会对他们应该做什么过程感到困惑，许多人会退回到“旧方式”。（我承认我也犯了这个罪。）

成功的关键是慢慢来，小步走。人们需要花时间来了解流程为什么会发生变化以及它如何使他们受益。这是巨大的，如果你不花时间去做这件事，它就不会成功，关键人物最终会辞职造成混乱。

绝对要记住的一件事是，最终一些营业额是好的。它带来了新的想法和具有不同（有时甚至更好）技能的人。你不应该试图强迫人们迅速改变，但他们也不应该成为障碍。如果他们不同意正在发生的事情，他们应该尝试与制定流程的人达成中间立场，或者离开。我在第一份工作中学到的一个真正令人大开眼界的是，实际上每个人都是可以替代的。最终会有人能够掌权。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-04T17:50:19.300

以我的经验，这种转变恰好发生在您也需要管理的时刻。如果没有一些总体协调功能到位，无论是团队领导、任务分离还是老式管理，很难让超过 8 个开发人员。我亲眼目睹的现实是，即使有最优秀、最有才华、最受支持的开发人员，当你同时工作超过 8 个时，你仍然需要协调。

当你越过那个边界时，过程中有一个不连续的步骤。然而，它不一定是灾难性的。最好的方法是让团队在还小的时候尽可能多地采用正式的流程，以便所有必要的行为和基础设施都到位。我认为这在任何情况下都是良好开发的代名词，所以即使是单独的开发人员也应该拥有它（源代码控制、单元测试和编码标准都是我所说的例子）。如果你采用这种方法，那么当它发生时，进程的升级与其说是一种颠簸，不如说是一种严格的协调。

您添加的每个开发人员都需要加入已经到位的流程。当你达到 8 个（或任何适合你的数字）时，你会发现你的团队会议变得有点过于松散和冗长，个性开始发挥作用，划分活动更有效。那时你的老板（或者如果你是老板的话，你）将需要任命一名或多名协调员来分配和控制工作。

如果你坚持你的过程，这个过程（应该）也会扩大。团队可以细分，或者您可以在必要时将团队分出以执行功能性任务。无论您为项目管理选择何种方法，无论是否敏捷，这种方法都有效。

一旦你组建了 4 或 5 个团队，即 30-50 人，那么你几乎肯定会需要那些对他们唯一的任务是协调感到高兴的人。

如果您现在还小，并且正在考虑或期待复杂性的转变，那么请确保您立即确定您的基本流程，并且肯定是在您开始增加更多员工之前。

HTH 祝你好运

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-04T16:58:01.620

很大程度上取决于从事项目的人员、集成点等。即使是单个编码人员也应该有代码管理工具，并且需要与客户或“老板”进行交互。根据经验，一旦人数超过 2 人，我就看到了变化，然后可能会增加 50%。如果团队由项目团队组织，专注于产品的解耦部分，则开销增加不会随着团队规模的增加（项目与矩阵组织）呈指数增长。

# asp.net - 用于 ASP.net 的 SCM

> ID：262614
> 
> 赞同：0
> 
> 时间：2008-11-04T17:29:51.163
> 
> 标签：asp.net, svn, version-control

作为我的整体开发实践审查的一部分，我正在研究如何最好地简化和自动化我们的 ASP.net Web 开发实践。

目前，我们的流程是这样的：

1.  Designer 将前端构建为网络共享上的静态 HTML/CSS。这会得到调整，直到签署。（例如`http://myserver/acmesite_design`）
2.  注销后，开发人员接管并将前端 HTML/CSS 复制到同一服务器上的新目录（例如`http://myserver/acmesite_development`）
3.  多个开发人员在本地副本上工作，直到项目完成。
4.  开发人员将代码发布到外部可公开访问的服务器，供客户审查/签字。
5.  根据反馈在本地进行的编辑。
6.  重新发布到外部服务器。
7.  登出
8.  开发人员发布到实时公共服务器

出了什么问题？许多事！

1.  版本控制——这显然是必须的，并且正在引入
2.  配置错误——很多时候，环境特定的路径和变量（例如数据库名称、图像上传目录、Web 服务器路径等）被错误地从本地复制到登台到实时等，结果非常尴尬.

我很有信心我已经控制住了第一名。配置管理呢？有没有人对如何最好地管理 asp.net 应用程序中的应用程序结构以尽量减少此类问题有任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-16T10:00:58.690

You got the most important part right. Use version control. Subversion is a good choice.

I usually store configuration along with the site; i.e. when coding a PHP-based site I have a file named config.php-dist. If you want the site to work at all you'll have to copy + edit in all the required parameters (this avoids storing passwords in version control). The -dist file should have reasonable defaults.

Upload directories should be relative if possible; actually **all** directories should be relative. I'm not experienced in ASP.net, but if it's anything like PHP the current directory is always the directory of the file being requested. If you channel all requests through a single file (i.e. index.asp), then this can even be found programmatically. Or you could find it programmatically by using the equivalent of `dirname(____FILE____)` in your configuration file.

I also recommend installing IIS (or whatever webserver you are using) on all development workstations (including the designers). Makes life easier as noone can step on each others toes. What one has to do is simply add test hosts to the hosts file (\windows\system32\drivers\etc\hosts iirc) in addition to adding a site to the local IIS. This plays well with version control (checkout, add site to IIS and hosts-file, edit edit edit commit).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-11T02:33:01.067

我发现将 SVN、NAnt 和 NUnit 与 Cruise Control.net 结合使用可以解决您描述的许多问题。我认为它适用于小团体，而且都是免费的。只需要学习如何使用它们。

CruiseControl.net 帮助您将构建和持续集成放在一起。

使用 NAnt 或 MSBuild 进行不同的环境构建（DEV、TEST、PROD 等）。

[http://confluence.public.thoughtworks.org/display/CCNET/Welcome+to+CruiseControl.NET](http://confluence.public.thoughtworks.org/display/CCNET/Welcome+to+CruiseControl.NET)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-10T06:33:02.970

确保您最终不会依赖于路径名的一种方法是让持续集成服务器针对您的应用程序执行您的测试套件。每次发生这种情况时，您都会创建一个**随机文件路径**。一旦有人引入了对文件路径的依赖，它就会失败。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T17:48:38.397

真正有帮助的一件事是确保您将路径保持在可以的地方，并将它们集中在您不能的地方，所以当我使用 ASP.Net 时，我倾向于使用[web.config](http://msdn.microsoft.com/en-us/library/aa719558.aspx)来存储任何配置和路径无法以编程方式找到的相关数据。很有可能通过 Request 对象以编程方式找到诸如当前应用程序路径之类的信息 - 值得详细了解环境为您提供的内容。

# html - 如何仅使用 CSS 来圆我的 div 标签区域的角？

> ID：262616
> 
> 赞同：9
> 
> 时间：2008-11-04T17:30:19.167
> 
> 标签：html, css

我使用 div 标签来定义网页中的区域。我设置了所有明显的东西，如背景、大小、填充等。但它都是非常方正的。

我怎样才能**只**使用CSS 来圆角？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-04T17:55:15.747

这是一个简单的 HTML 文档来演示如何仅通过 CSS 来实现它。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
    <head>
        <style>
        .b1f, .b2f, .b3f, .b4f{font-size:1px; overflow:hidden; display:block;}
.b1f {height:1px; background:#ddd; margin:0 5px;}
.b2f {height:1px; background:#ddd; margin:0 3px;}
.b3f {height:1px; background:#ddd; margin:0 2px;}
.b4f {height:2px; background:#ddd; margin:0 1px;}
.contentf {background: #ddd;}
.contentf div {margin-left: 5px;}
        </style>
    </head>
    <body>
            <b class="b1f"></b><b class="b2f"></b><b class="b3f"></b><b class="b4f"></b>
            <div class="contentf">
Content Area Content Area Content Area Content Area Content Area Content Area 
Content Area Content Area Content Area Content Area Content Area Content Area 
Content Area Content Area Content Area Content Area Content Area Content Area 
            </div>
            <b class="b4f"></b><b class="b3f"></b><b class="b2f"></b><b class="b1f"></b>
    </body>
</html> 
```

原文链接：http: [//blog.yosle.com/2007/09/20/css-round-corners/](http://blog.yosle.com/2007/09/20/css-round-corners/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-04T17:33:30.487

您将使用border-radius 属性。但是，这仅在 CSS3 中受支持，尚无浏览器实现。如果你只需要它在几个浏览器中工作，你可以使用 -webkit-border-radius 和 -moz-border-radius 让它分别在 Safari 和 Firefox 中工作。

如果您不反对使用图像。这是我想出的[制作圆形边框](http://www.kibbee.ca/Blog/viewComments.php?blogid=354)的方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-04T17:37:15.737

[-moz-border-radius](https://developer.mozilla.org/en/CSS/-moz-border-radius)将在所有版本的 Firefox 中为您提供圆角。[Sitepoint CSS 参考](http://reference.sitepoint.com/css/moz-border-radius)中的更多有用信息。

[border-radius](http://www.css3.info/preview/rounded-border/)将在 Safari 3 中为您提供圆角。[CSS 3 Spec](http://www.w3.org/TR/css3-background/#the-border-radius)中有关border-radius 的更多信息。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-04T17:51:11.230

如果“仅 CSS”是指“没有 JavaScript”，那么您当然可以在元素中添加带圆角的背景图像。在这种情况下，您可能需要额外的标记，具体取决于您需要多大的灵活性。

考虑到您还不能使用[多个背景图像](http://www.w3.org/TR/css3-background/#the-background-image)，我认为使用单个图像是最好的*唯一 CSS*选项。

如果您*可以*使用 JavaScript，那么您可能需要查看[Nifty Corners Cube](http://www.html.it/articoli/niftycube/index.html)。我提到这一点是因为它甚至可以在图像之上工作并支持透明度。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T18:30:45.800

向谷歌询问“css 圆角无图像”，你会发现很多很多关于如何做到这一点的例子。

就个人而言，我喜欢基于操纵边距来逐行绘制曲线的方法，尽管它们在页面源中产生大量噪音，因为它们是最灵活的并且可以绘制任何形状的边缘。如果您只对实际的圆角感兴趣（即，使用 90 度圆弧），那么有一个更紧凑的解决方案，它基于一些巧妙定位的子弹。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-04T18:52:45.007

[http://www.sitepoint.com/blogs/2005/08/19/dom-foolery-with-images/](http://www.sitepoint.com/blogs/2005/08/19/dom-foolery-with-images/)中有一个教程解释了如何在图像中设置圆角边框。Peharps 它可能对您有用，因为图像被设置为 div 的背景。尽管您将需要使用其他图像和 javascript。如果您使用 JQuery，javascript 代码可能会减少。o/

# java - Java BufferedReader 回到文本文件的顶部？

> ID：262618
> 
> 赞同：26
> 
> 时间：2008-11-04T17:31:43.110
> 
> 标签：java, file, file-io, text-files, bufferedinputstream

我目前`BufferedReader`在同一个文本文件上初始化了 2 秒。当我用第一个读完文本文件后`BufferedReader`，我使用第二个从顶部通过文件。需要多次通过同一个文件。

我知道`reset()`，但它需要在调用之前，`mark()`并且`mark()`需要知道文件的大小，我认为我不应该打扰。

想法？包裹？库？代码？

谢谢TJ

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-11-04T17:55:23.483

缓冲读取器旨在按顺序读取文件。您正在寻找的是[java.io.RandomAccessFile](http://docs.oracle.com/javase/8/docs/api/java/io/RandomAccessFile.html)，然后您可以使用它`seek()`来将您带到文件中您想要的位置。

随机访问阅读器的实现方式如下：

```
try{
     String fileName = "c:/myraffile.txt";
     File file = new File(fileName);
     RandomAccessFile raf = new RandomAccessFile(file, "rw");
     raf.readChar();
     raf.seek(0);
} catch (FileNotFoundException e) {
     // TODO Auto-generated catch block
     e.printStackTrace();
} catch (IOException e) {
     // TODO Auto-generated catch block
     e.printStackTrace();
} 
```

`"rw"`是一个模式字符，这里[详细介绍](http://docs.oracle.com/javase/8/docs/api/java/io/RandomAccessFile.html#RandomAccessFile-java.io.File-java.lang.String-)。

像这样设置顺序访问读取器的原因是，它们可以实现它们的缓冲区，并且不能在它们脚下改变事情。例如，提供给缓冲阅读器的文件阅读器只能由该缓冲阅读器操作。如果有另一个可能影响它的位置，您可能会出现不一致的操作，因为一个阅读器在文件阅读器中提升了它的位置，而另一个阅读器希望它保持不变，现在您使用另一个阅读器并且它位于未确定的位置。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2008-11-04T17:35:53.167

仅仅创建一个新`BufferedReader`的从顶部读取的缺点是什么？如果文件足够小，我希望操作系统缓存文件。

如果您担心性能，您是否证明它是一个瓶颈？我只会做最简单的事情，在你有具体理由之前不要担心。我的意思是，您可以将整个内容读入内存，然后对结果进行两次传递，但这再次比仅使用新阅读器从头开始阅读要复杂得多。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-04T17:56:15.323

最好的方法是改变你的算法，这样你就不需要第二遍了。当我不得不处理不适合可用内存的巨大（但并不可怕，即几 GB）文件时，我使用了这种方法几次。

这可能很难，但性能提升通常值得付出努力

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-05T12:48:52.730

关于标记/重置：

BufferedReader 中的 mark 方法采用 readAheadLimit 参数，该参数限制在标记之后您可以读取多远，然后重置变得不可能。重置实际上并不意味着文件系统 seek(0)，它只是在缓冲区内寻找。引用 Javadoc：

> readAheadLimit - Limit on the number of characters that may be read while still preserving the mark. After reading this many characters, attempting to reset the stream may fail. A limit value larger than the size of the input buffer will cause a new buffer to be allocated whose size is no smaller than limit. Therefore large values should be used with care.

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-11-04T20:05:27.747

“关于 BufferedReader 中的 mark() 和 reset() 的整个业务都带有糟糕的设计味道。”

你为什么不扩展这个类并让它在构造函数（）中做一个标记（），然后在topOfFile（）方法中做一个seek（0）。

BR，
~A

# winforms - .Net 2.0 Winform 标签工具提示

> ID：262620
> 
> 赞同：7
> 
> 时间：2008-11-04T17:32:48.210
> 
> 标签：winforms, .net-2.0

这一定是我刚刚错过的东西，但是如何向标签添加工具提示？

我在网上看到了一些关于处理鼠标悬停事件的内容，但是我什至如何在代码中处理它呢？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-04T17:37:07.063

在您的表单中添加工具箱中的工具提示，然后在您的标签中单击一次，您将在属性框中看到工具提示。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-04T17:38:04.673

难道你不只是在表单上放一个工具提示，然后选择标签并设置“工具提示1上的工具提示”属性吗？至少我记得那样做，或者非常接近它。

[从 MSDN 以](http://msdn.microsoft.com/en-us/library/aa288412(VS.71).aspx)编程方式：

```
System.Windows.Forms.ToolTip ToolTip1 = new System.Windows.Forms.ToolTip();
ToolTip1.SetToolTip(this.textBox1, "Hello"); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-04T17:37:39.387

将 TOOLTIP 控件拖放到您的表单上。此时，工具提示属性出现在设计器的标签属性中（并且可以在代码中访问）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T17:40:27.213

```
button = new Button(); 
button.Content = "Hover over me."; 
tt = new ToolTip(); 
tt.Content = "Created with C#"; 
button.ToolTip = tt; 
cv2.Children.Add(button); 
```

来自[http://msdn.microsoft.com/en-us/library/ms754034.aspx](http://msdn.microsoft.com/en-us/library/ms754034.aspx)

# lisp - 使用 Lisp（或 AutoLisp）的关联列表性能有多好？

> ID：262628
> 
> 赞同：3
> 
> 时间：2008-11-04T17:35:32.667
> 
> 标签：lisp, autocad, autolisp

我正在做一个 AutoLisp 项目，它使用长关联结构来进行繁重的几何处理——所以我对关联列表的密集使用时间结果很好奇。实现有多简单/复杂？它使用一些数据结构还是普通的点对列表？b-tree 有什么扩展名吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-05T10:39:24.253

在最近的 x86 硬件上，SBCL 在 alist 和基于身份的哈希表之间的转折点，假设访问分布均匀，大约是 30-40 个元素。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-04T17:48:05.607

在 Common Lisp 和 Emacs Lisp 中，关联列表是链表，因此它们具有线性搜索时间。假设 AutoLisp 是相同的（如果不是，那么他们对术语“关联列表”的使用具有误导性），您可以假设所有操作在列表长度上都是线性的。例如，具有 100 个元素的 alist 平均需要 50 次访问才能找到您想要的东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-04T17:50:44.180

当然，大多数 Scheme 实现（或者可能在规范中？）都有哈希表，它们使用的 API 大多相同。但这不是透明的，当你要求一个列表时，你会得到一个配对列表，如果你想要一个哈希表，就要求它。

也就是说，重要的是要记住线性算法并不慢；它们是“不可扩展的”。对于少数元素，它们将胜过更复杂的“聪明”算法。'n' 必须有多大，很大程度上取决于算法，以及具有大缓存但 RAM 慢的快速处理器，继续推动它。此外，重度优化编译器（如某些 Lisp 上可用的编译器）会生成*非常*紧凑的线性代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-04T17:54:42.753

我已经有大约 10 年没有使用过 AutoLisp 了，但我从未发现任何与关联列表操作有关的真正性能问题。而且我编写了可以进行大量关联列表操作的代码。

在 VBA 或 ObjectARX 中工作可能会带来一些性能优势，但您可能需要运行一些比较测试以查看它是否真的更好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-28T15:27:35.387

据我所知，b-tree 没有扩展，但如果您使用 Visual LISP，您可以使用 ActiveX 对象，从而访问大多数类型的数据库。

# wpf - WPF 应用程序中的可变不透明度

> ID：262630
> 
> 赞同：0
> 
> 时间：2008-11-04T17:35:44.397
> 
> 标签：wpf

我的问题是：

我有一个画布，它覆盖了我的窗口的一部分。canvas的Opacity设置为小于1，即可以查看Canvas下的控件。我想做的是在画布上放置一个控件，任何控件，比如一个按钮，而不是让那个按钮半透明。这可能使用WPF吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-04T17:38:11.757

尝试画布颜色中的 alpha。

# c# - 无法在无 cookie 模式下设置 FormsAuthenicationTicket.UserData

> ID：262636
> 
> 赞同：3
> 
> 时间：2008-11-04T17:37:27.873
> 
> 标签：c#, asp.net, forms-authentication

我正在尝试实现本文的“向 UserData 写入信息”部分[，](http://www.asp.net/LEARN/security/tutorial-03-cs.aspx)但是当 cookie 是 URI 的一部分时，它无法正常工作。

我的代码：

```
// Create the cookie that contains the forms authentication ticket
HttpCookie authCookie = FormsAuthentication.GetAuthCookie( userName, createPersistantCookie );

// Get the FormsAuthenticationTicket out of the encrypted cookie
FormsAuthenticationTicket ticket = FormsAuthentication.Decrypt( authCookie.Value );

// Create a new FormsAuthenticationTicket that includes our custom User Data
FormsAuthenticationTicket newTicket = new FormsAuthenticationTicket( ticket.Version, ticket.Name, ticket.IssueDate, ticket.Expiration, ticket.IsPersistent, "foo");

// Update the authCookie's Value to use the encrypted version of newTicket
authCookie.Value = FormsAuthentication.Encrypt( newTicket );

// Manually add the authCookie to the Cookies collection
HttpContext.Current.Response.Cookies.Add( authCookie );

// Determine redirect URL and send user there
string redirUrl = FormsAuthentication.GetRedirectUrl( userName, createPersistantCookie );

HttpContext.Current.Response.Redirect( redirUrl, false ); 
```

使用 cookieless 时，页面会重定向，但无法获得包含 cookie 信息的正确 URI，因此它会循环回到我的登录页面，其中 Request.IsAuthenticated 返回 false。一个无限循环随之而来。

如何重定向到正确的 URI？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-05T08:47:12.280

我发现这是一个有趣的问题，所以我开始对 .net 框架源进行一些挖掘、测试和一些调试。

基本上，您尝试做的事情是行不通的。如果浏览器不支持 cookie，您放入 Response.Cookies 集合的任何内容都将被忽略。您可以检查 Request.Browser.Cookies 以查看是否支持 cookie。

在 asp.net 中，会话状态和身份验证都支持无 cookie 模式，但这不会扩展到其他 cookie。事实上，似乎会话和身份验证本身可以设置为不同的操作模式。

身份验证系统可以将它自己的数据存储在 URI 中，但它是通过直接操作 URI 本身来实现的。遗憾的是，微软似乎没有将这些功能暴露给身份验证模块之外的代码。

基本上，如果您使用 FormsAuthentication.GetAuthCookie() 和 FormsAuthentication.SetAuthCookie() 等方法，那么身份验证系统会自动为您将该信息放入 URI 中……但它不允许您提供自定义的这些方法的身份验证票......所以你被默认的身份验证票困住了。在这些情况下，你自己来存储任何自定义数据。

反正...

如果身份验证系统已无 cookie，则将自定义数据直接存储在身份验证票证中确实没有太大优势……在无 cookie 模式下，诸如“持久性 cookie”之类的东西没有意义，因此您将至少重新生成数据一次无论如何，每个会话。

对于没有 cookie 但仍需要像这样的自定义数据的情况，最常见的建议是启用无 cookie 会话，并将自定义数据存储为会话变量。会话 ID 将被放入 URI，但自定义数据将保留在服务器的内存中。无论您的会话是否无 cookie，使用模式都是相同的。

如果你真的想要，你可以想出一个手动将自定义数据存储在 URI 中的系统。最简单的做法是将自定义数据放入查询字符串或使用路径数据。除非您只是不想使用服务器内存（向服务器添加一点内存是便宜的、丑陋的 URL 和手动编写代码来处理它们并不便宜），否则我看不出这比会话变量有任何真正的优势。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T14:41:30.443

谢谢你的精彩解释，斯蒂芬。如果用户不允许使用 cookie，我将不得不避开 UserData 并从数据库中加载数据。

在上面列出的代码之前，我会做：

```
if( !HttpContext.Current.Request.Browser.Cookies || !FormsAuthentication.CookiesSupported )
{
    FormsAuthentication.RedirectFromLoginPage( userName, false);
    return;
} 
```

# php - 为什么在 PHP 中为 HTML 标签创建动态类不更常见？

> ID：262652
> 
> 赞同：-4
> 
> 时间：2008-11-04T17:41:08.037
> 
> 标签：php, html

我无法忍受 HTML 与其他代码混合在一起。我正在开发一个必须保留在 PHP 中的代码库，并且我不想触及带有众所周知的极点的 HTML 模板。所以我目前正在做的事情是这样的：

```
<?php
$page = new html_page('My wonderful page');
$page->add_contents(new html_tag('p', 'It works', array('id' => 'helloworld', 'class' => 'somecssclass')));

echo $page->render();
?> 
```

一切都属于一个很好的对象层次结构，这是好的和花花公子。当然，我有很多较小的类，我正在考虑使用动态类（例如，'html_a' 将自动创建一个 'a' 类型的 html_tag 对象。）

似乎没有其他人在这样做。为什么不？我错过了什么？

（我清楚地记得一个开源库就是这样做的，但现在找不到了。所以除非我真的在想象事情，否则我不是唯一一个想到这种方法来呈现 HTML 的人）

你对此有什么想法吗？

以下是一些额外的细节：

1.  我是这个项目中唯一的开发者。
2.  我如何将代码与 HTML 混合：我的库中的“html_tag”对象与 DOM 中的节点非常相似。“render”方法是创建 HTML 的方法，但我不会在任何地方编写任何开始或结束标记。
3.  我为几个任务创建小对象。这些对象具有构建标签对象的方法；然后将这些生成的对象插入到表格或页面中。
4.  我的图书馆有一些原始的访问方法来查找对象。所以[26288](https://stackoverflow.com/questions/262652/php-tag-library#262881)中发布的迭代器示例可以相对容易地实现。
5.  我不担心性能（还）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-04T17:50:19.737

好吧，最重要的是，您仍在将 HTML 与代码混合在一起。如果您想将该“p”标签更改为“div”，则必须浏览代码才能做到这一点。想想你的方法提供了什么：

*   将代码与 HTML 混合
*   增加了解析所有请求的开销
*   在 HTML 上引入了一种新的“语言”

从本质上讲，虽然方法可能不同，但它与您试图摆脱的模板语言具有相同的问题。

如果您单独（或在一个小组中）工作，让 PHP 作为模板语言不是更容易吗？

```
$page = new Page('test.html');
$page->load($data);
$page->render(); 
```

并在您的 test.html “模板”中

```
<html>
<head>
  <title><?php echo $title ?></title>
</head>
<body>
  <p><?php echo $hello ?></p>
</body>
</html> 
```

其他模板引擎真正做的是将上述代码形式化。但是，如果您坚持基础知识（回显变量、基本条件、循环），您基本上拥有模板语言的所有功能，但使用的是熟悉的 PHP，并且没有性能开销。

另外，与您的示例不同，您可以更改 HTML（我知道您不想触摸它，但是在代码中将“p”更改为“div”实际上与更改为 没有什么不同`<p>`）`<div>`，而无需深入研究代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-04T18:01:20.947

我不确定你在说什么。您在寻找 php 的模板库吗？有很多，虽然讨厌 Smarty 很时髦（就像讨厌 php 本身很时髦），但它是一个很棒的库。

您是在问为什么“每个人”都在他们的 php 代码中混合 html？答案是只有初学者和白痴才会这样做。每个有实际 php 经验的人都使用模板引擎。

如果您问为什么没有人像在您的示例中那样在代码中添加每个 html 标记，那很明显：因为这是维护的噩梦。你打算把你的代码交给设计师并告诉他祝你好运吗？您是否要手动将每个 html 页面转换为页面和代码页面？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-04T18:22:30.247

所以，如果我理解正确，您是说您非常讨厌将代码混入您的 HTML 中，以至于您决定将 HTML 混入您的代码中？我看不出它如何改进任何东西——代码和 HTML 仍然混合在一起——而且它是接近 PHP 的不太自然/更复杂的方式，这似乎为为什么没有其他人这样做提供了一个明显的解释。

使用适当的模板系统，它实际上将代码与 HTML 分开，而不是仅仅玩弄哪个嵌入另一个。我建议使用 HTML::Template 或 Template::Toolkit，因为您和我一样喜欢 Perl，但您已经说过非 PHP 语言不是可行的选择。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-04T20:33:23.010

略有不同，但又相似。我写了[一篇关于使用 DOM 将变量绑定到模板](http://www.sitepoint.com/blogs/2008/09/25/dom-vs-template/)的文章。你可能会觉得很有趣。

基本用例：

```
$t = new Domling('<p class="hello"></p>'); 
$t->capture('hello')->bind("Hello World"); 
echo $t->render(); 
```

产生：

```
<p class="hello">Hello World</p> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-05T20:38:05.387

好吧，似乎人们对“讨厌 PHP”的引用感到不安。这不是问题的预期精神，对不起，如果我把你最喜欢的语言关掉了。

最后，有几个人提出的一些非常有效的观点；

1.  不幸的命名约定：将 HTML 元素的名称作为对象的名称敲响了警钟。
2.  我正在重新发明 Lisp，以及其中最糟糕的部分。
3.  这只是另一个模板系统，而​​且启动起来很糟糕。

对我来说，接受的答案是 troelskn 发布的好文章。我得出的结论是我需要自己的文档模型，并且我应该避免在其上使用 html 实体名称。正如我之前所说，这是一个小项目；那篇文章和我从它的评论中得到的一些建议给了我新的探索思路。

（关于重新发明 Lisp 部分：我是我认识的唯一一个喜欢编写 DOM 的人。所以就在那里。）

谢谢大家的意见。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-04T17:45:56.983

PHP*是*一种模板语言。因此，所有 PHP 爱好者都在使用类模板设计是很自然的。

有一些 LISP 库可以做你放在那里的事情。恕我直言，当我使用 LISP 语言时，这是一个很大的障碍。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-04T18:41:11.410

[问题 261338](https://stackoverflow.com/questions/261338/what-is-the-best-way-to-insert-html-via-php) 与此有一些共线性，但我的回答更针对对整个编程“关注点分离？那是什么？”不熟悉的 php 人。人们。（对不起 php 人，主要是这种情况）

你可能是一个优秀的 perl 播放器，并使用 perl 生成你的 html 模板废话，然后加载到 php 中，我还是 perl 的新手，但是 php 很臭，而且我使用它太久了，肯定有一个用 perl 编写一个在 php 上运行的站点的方法。

第三，我希望看到一些可以在变量之外进行增强替换的东西。

有点像 jQuery 风格的 dom 匹配，但没有臃肿、java(rhino) 或整个 web 浏览器的东西。

```
$page = new Page("FakePage.html"); 
$page->find("div#foobar")->text = "Hahah! I rock" ; 
/* Give All H1's a numeric lead in  */  
foreach( $page->find("h1")->iterator() as $index => $node )
{
        $node->text =  ($index + 1 ) . ". " $node.text;
};
$page->render(); 
```

我真的很喜欢那些做得很好并且不会太难的东西。请注意我使用的结构可能不会被 php 完全喜欢。

梦想是免费的。

（这是真正分离设计和逻辑的 /only/ 语法，所有其他模板化的东西只是递归地减少编程语言）

这里特别酷的部分是：

1.  无需清理 html，它的 DOM AWARE！
2.  不需要奇怪的特殊模板标记，这种标记很糟糕，在 90% 的编辑器中都不起作用，而且如果不让鸡流血，就无法自行验证。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-04T17:53:42.740

没有其他人这样做，因为它比仅仅为模板文件进出 PHP 模式需要更多的工作，更不用说它只是增加了开销，纯粹是为了满足您对代码美学的偏好。

这并不意味着您可以将逻辑与显示分开，例如像 Owen 建议的简单系统。但是仅仅因为你不喜欢它而回避 php 与 HTML 混合的约定有点愚蠢 - 这就是语言的使用方式。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-28T16:43:05.240

我正在使用 xml、xsl 方法来开发我的表单，使用单个 xls 模板来呈现我在门户中使用的任何表单。一开始很难找到正确的xls文件格式，但是完成后，渲染我的表单就很容易了。在 php 中，我只需要创建一个 XML 对象并渲染它。

显然，会有一些我不想用 xls 渲染的“特殊”事物，在这种情况下，我会以正常方式渲染它们。

我不喜欢与 php 代码混合太多东西，这就是我开发这个库的原因......

# visual-sourcesafe - 获取用户使用 Visual Source Safe 命令行应用程序 SS.exe 签出的所有文件

> ID：262675
> 
> 赞同：8
> 
> 时间：2008-11-04T17:46:17.280
> 
> 标签：visual-sourcesafe, visual-sourcesafe-2005

我们目前使用 VSS 6，恐怕这不会改变。

我正在尝试编写一个脚本，允许用户快速将他们签出的所有文件复制到另一个目录树。为此，我需要获取用户已签出的所有文件的列表，以及文件签出到的目录。在 GUI 中使用状态搜索很容易做到这一点。但我需要一种从命令行实用程序 ss.exe 执行此操作的方法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-04T18:07:32.087

两个可能有用的链接：

[VSS 命令行命令](http://msdn.microsoft.com/en-us/library/003ssz4z(VS.80).aspx)

[VSS 命令行选项](http://msdn.microsoft.com/en-us/library/hsxzf2az(VS.80).aspx)

扩展 Panos 回复

```
ss.exe Status $/ -R -U<Username> 
```

将为您提供特定用户的文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-03-04T18:31:40.753

**从命令行：**

1.  `cd C:\Program Files\Microsoft Visual SourceSafe`
2.  `SET SSDIR=<path to folder containing srcsafe.ini>`
3.  `ss Status $/ -R -U<username> > checked-out-by-username.txt`

然后检查 check-out-by-username.txt 的内容以进行结帐。

**例如：**

我`srcsafe.ini`在`C:\Program Files\Microsoft Visual SourceSafe\MasterDatabase`。我的用户名是`bpaetzke`.

所以，我的命令行看起来像这样：

1.  `cd C:\Program Files\Microsoft Visual SourceSafe`
2.  `SET SSDIR=MasterDatabase`
3.  `ss Status $/ -R -Ubpaetzke > checked-out-by-bpaetzke.txt`

如果您想获得所有用户的签出，请删除 -U 并为输出文件指定一个通用名称。

**其他命令行信息：**

*   [命令](http://msdn.microsoft.com/en-us/library/003ssz4z%28VS.80%29.aspx)
*   [选项](http://msdn.microsoft.com/en-us/library/hsxzf2az%28VS.80%29.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-09-30T14:15:22.160

我来这里是为了寻找同样的东西，但使用 Visual Source Safe 版本 >= 8.0，该命令似乎对我不起作用，相反，我找到了一种更简单的使用菜单搜索的方法：

> 查看 -> 搜索 -> 状态搜索

选择按用户搜索的选项并指定用户名

[![在此处输入图像描述](https://i.stack.imgur.com/8HG2h.png)](https://i.stack.imgur.com/8HG2h.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-04T18:03:21.830

有关 Status 命令的命令行用法，请参见[此处](http://msdn.microsoft.com/en-us/library/d6kac9fd(VS.80).aspx)。命令

```
ss.exe Status $/ -R -U 
```

显示系统中由当前用户签出的每个文件。

# java - 在更新模型值之前触发 JSF commandLink 操作

> ID：262677
> 
> 赞同：1
> 
> 时间：2008-11-04T17:46:27.340
> 
> 标签：java, jsf, jakarta-ee

我有一个由两个 JSP 组成的 JSF 应用程序：login.jsp 和 main.jsp。

我有以下 faces-config.xml：

```
<lifecycle>
  <phase-listener>package.programs.scorecard.beans.EventBean</phase-listener>
</lifecycle>
<managed-bean>
  <managed-bean-name>FormBean</managed-bean-name>
  <managed-bean-class>package.programs.scorecard.beans.FormBean</managed-bean-class>
  <managed-bean-scope>session</managed-bean-scope>
</managed-bean>
<managed-bean>
  <managed-bean-name>DataBean</managed-bean-name>
  <managed-bean-class>package.programs.scorecard.beans.DataBean</managed-bean-class>
  <managed-bean-scope>session</managed-bean-scope>
</managed-bean>
<managed-bean>
  <managed-bean-name>EventBean</managed-bean-name>
  <managed-bean-class>package.programs.scorecard.beans.EventBean</managed-bean-class>
  <managed-bean-scope>session</managed-bean-scope>
</managed-bean> 
```

以及以下 web.xml：

```
<welcome-file-list>
  <welcome-file>faces/login.jsp</welcome-file>
  <welcome-file>faces/index.jsp</welcome-file>
  <welcome-file>index.jsp</welcome-file>
</welcome-file-list>
<servlet>
  <servlet-name>Faces Servlet</servlet-name>
  <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
  <load-on-startup>1</load-on-startup>
</servlet>
<servlet-mapping>
  <servlet-name>Faces Servlet</servlet-name>
  <url-pattern>/faces/*</url-pattern>
</servlet-mapping> 
```

我在 login.jsp 上有几个组件，它们在单击 commandLink 时更新 DataBean 中的属性。成功完成后，用户将导航到 /main.jsp。

我注意到当我单击 commandLink 时，该方法在更新 bean 之前执行。这导致我的所有 bean 属性在方法执行时都为 null，因为我的表单中的值没有应用于 bean。

根据我对 JSF 生命周期的理解，“更新模型值”应始终在“调用应用程序”之前执行，除非指定了“立即=真”，这不适用于我的 commandLink。

今天早上我已经尝试调试了几个小时，我欢迎任何建议或见解。

**更新**：我已经彻底调查了这个问题并得出结论，我正在使用的下拉组件中有一个错误，应该在下一个版本中修复。我的解决方案是使用常规的 h:selectOneMenu 代替第三方组件，它就像一个魅力：

```
<h:selectOneMenu id="ddlManager" value="#{DataBean.managerId}">
    <f:selectItems value="#{DataBean.managerList}" />
</h:selectOneMenu> 
```

其中 managerList 是 SelectItem 对象的列表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T20:30:14.763

这不是一个解决方案 - 它是一个可以帮助您诊断问题的示例。当然，你可能已经这样做了——我看到你已经实现了一个阶段监听器。

豆：

```
public class LoginBean implements Serializable {

    private String user;
    private String password;

    public String getPassword() {
        return password;
    }

    public String getUser() {
        return user;
    }

    public void setPassword(String password) {
        System.out.println("Update Password: " + password);
        this.password = password;
    }

    public void setUser(String user) {
        System.out.println("Update User: " + user);
        this.user = user;
    }

    public String login() {
        if ("user".equals(user) && "password".equals(password)) {
            // ok
            System.out.println("Login OK");
            return "loggedIn";
        } else {
            System.out.println("Login Failed");
            FacesContext context = FacesContext.getCurrentInstance();
            FacesMessage message = new FacesMessage(
                    "Invalid user name or password");
            context.addMessage(null, message);
            return null;
        }
    }

} 
```

看法：

```
<f:view>
    <h:form>
        login:
        <h:inputText value="#{loginBean.user}" />
        <h:inputSecret value="#{loginBean.password}" />
        <h:commandButton value="login" action="#{loginBean.login}" />
        <h:messages />
    </h:form>
</f:view> 
```

面孔-config.xml：

```
<?xml version="1.0" encoding="UTF-8"?>

<faces-config xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-facesconfig_1_2.xsd"
    version="1.2">
    <managed-bean>
        <managed-bean-name>loginBean</managed-bean-name>
        <managed-bean-class>login.LoginBean</managed-bean-class>
        <managed-bean-scope>session</managed-bean-scope>
    </managed-bean>
    <navigation-rule>
        <display-name>login</display-name>
        <from-view-id>/login.jsp</from-view-id>
        <navigation-case>
            <from-outcome>loggedIn</from-outcome>
            <to-view-id>/label.jsp</to-view-id>
        </navigation-case>
    </navigation-rule>
    <lifecycle>
        <phase-listener>login.PhaseListenerImpl</phase-listener>
    </lifecycle>
</faces-config> 
```

阶段监听器：

```
public class PhaseListenerImpl implements PhaseListener {

    public void afterPhase(PhaseEvent event) {
        System.out.println("AFTER: " + event.getPhaseId());
    }

    public void beforePhase(PhaseEvent event) {
        System.out.println("BEFORE: " + event.getPhaseId());
    }

    public PhaseId getPhaseId() {
        return PhaseId.ANY_PHASE;
    }

} 
```

匹配的用户名和密码的预期日志输出将是：

```
BEFORE: RESTORE_VIEW(1)
AFTER: RESTORE_VIEW(1)
BEFORE: APPLY_REQUEST_VALUES(2)
AFTER: APPLY_REQUEST_VALUES(2)
BEFORE: PROCESS_VALIDATIONS(3)
AFTER: PROCESS_VALIDATIONS(3)
BEFORE: UPDATE_MODEL_VALUES(4)
Update User: user
Update Password: password
AFTER: UPDATE_MODEL_VALUES(4)
BEFORE: INVOKE_APPLICATION(5)
Login OK
AFTER: INVOKE_APPLICATION(5)
BEFORE: RENDER_RESPONSE(6)
AFTER: RENDER_RESPONSE(6) 
```

# .net - .NET PerformanceCounter for Hard Faults/sec

> ID：262689
> 
> 赞同：1
> 
> 时间：2008-11-04T17:48:36.073
> 
> 标签：.net, memory, performancecounter

Vista 的资源监视器包括“Hard Faults/sec”读数。我可以在 C# 中使用等效的性能计数器来获取此读数吗？我已经尝试过内存类别下的“页面错误/秒”，但这似乎有所不同。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-09-05T21:49:17.470

硬故障与页面故障相同。

来源：“ [Windows Vista 性能和可靠性监控分步指南](http://technet.microsoft.com/en-us/library/cc722173(WS.10,printer).aspx)”。

请参阅*资源视图详细信息*、标签内存部分（第 4 个表）：

> 当引用地址的页面不再在物理内存中并且已被换出或可从磁盘上的支持文件中获得时，就会发生硬故障（也称为页面故障）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-07-28T13:34:30.747

Page faults/sec 测量硬故障和软故障。名为 Transition Faults/sec 的计数器测量软故障。因此，要获得硬故障，您应该从 Page Faults/sec 中减去 Transition Faults/sec

# c# - 公开多个数据绑定源

> ID：262691
> 
> 赞同：4
> 
> 时间：2008-11-04T17:48:57.163
> 
> 标签：c#, wpf, data-binding

在数据绑定方面，我觉得我缺少 WPF 的一个相当基本的概念，但我似乎无法找到正确的 Google 关键字组合来定位我所追求的，所以也许 SO 社区可以提供帮助。:)

我有一个 WPF 用户控件，需要将数据绑定到两个单独的对象才能正确显示。这两个对象都必须从外部源动态设置。到目前为止，我只是将表单的 DataContext 属性用于动态对象绑定，但这仅允许引用一个对象。我觉得这是一个简单的问题，我必须遗漏一些明显的东西。

我之前的尝试看起来像这样：

```
<UserControl.Resources>
    <src:Person x:Key="personSource" />
    <src:Job x:Key="jobSource" />
</UserControl.Resources>
<TextBox Text="{Binding Source={StaticResource personSource}, Path=Name" />
<TextBox Text="{Binding Source={StaticResource jobSource}, Path=Address" /> 
```

这将绑定到我为类提供的任何默认值，但如果我尝试在代码中动态设置对象（如下所示），我看不到任何变化。

```
Person personSource = FindResource("personSource") as Person;
personSource = externalPerson;
Job jobSource= FindResource("jobSource") as Job;
jobSource = externalJob; 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-04T18:15:37.873

我可能会使用带有两个 DependencyProperties 的 CustomControl。然后使用您的自定义控件的外部站点可以将他们想要的数据绑定到该控件，也可以通过使用自定义控件来模板化控件在不同情况下的外观。

自定义控制代码如下所示：

```
public class CustomControl : Control
{
    public static readonly DependencyProperty PersonProperty =
        DependencyProperty.Register("Person", typeof(Person), typeof(CustomControl), new UIPropertyMetadata(null));
    public Person Person
    {
        get { return (Person) GetValue(PersonProperty); }
        set { SetValue(PersonProperty, value); }
    }

    public static readonly DependencyProperty JobProperty =
        DependencyProperty.Register("Job", typeof(Job), typeof(CustomControl), new UIPropertyMetadata(null));
    public Job Job
    {
        get { return (Job) GetValue(JobProperty); }
        set { SetValue(JobProperty, value); }
    }

    static CustomControl()
    {
        DefaultStyleKeyProperty.OverrideMetadata(typeof(CustomControl), new FrameworkPropertyMetadata(typeof(CustomControl)));
    }
} 
```

Generic.xaml 是一个应该为您创建的文件，它的样式可能如下所示：

```
<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:WpfApplication3">

    <Style TargetType="{x:Type local:CustomControl}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type local:CustomControl}">
                    <Border Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}">
                        <StackPanel>
                            <TextBox Text="{TemplateBinding Person.Name}" />
                            <TextBox Text="{TemplateBinding Job.Address}" />
                        </StackPanel>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</ResourceDictionary> 
```

最后，当你去使用你的控件时，你会做这样的事情。

```
<src:CustomControl Person="{Binding Person}" Job="{Binding Job}" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T20:26:21.980

您的文本框不更新的原因是您将它们绑定到静态资源。顾名思义，这些资源是静态的，不会发布更改通知。并且因为 Binding 是 MarkupExtension 并且不是从 DependencyObject 派生的，所以您不能使用 DynamicResource。

尝试在您的控件上创建依赖属性以引用 Person 和 Job 对象。

然后将 UserControl 的 DataContext 设置为引用自身。

```
DataContext="{Binding RelativeSource={RelativeSource Self}}" 
```

然后，您可以使用点表示法来引用所需的属性。

```
<TextBox Text="{Binding Path=Person.Name" />
<TextBox Text="{Binding Path=Job.Address" /> 
```

或者使用源参数

```
<TextBox Text="{Binding Source=Person, Path=Name" />
<TextBox Text="{Binding Source=Job, Path=Address" /> 
```

# asp.net - ASP.net AJAX 搜索

> ID：262707
> 
> 赞同：2
> 
> 时间：2008-11-04T17:51:47.907
> 
> 标签：asp.net, asp.net-ajax

我正在寻找一个使用 ASP.net AJAX 的示例，以根据输入到文本框中的内容来显示转发器控件的“实时”过滤。我见过使用 Web Client Software Factory 的东西，但对不需要额外库的东西更感兴趣。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T18:13:17.333

asp.net ajax 控制工具包在[这里](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/AutoComplete/AutoComplete.aspx)有一个。

如果你不喜欢那个，在谷歌上搜索“Ajax Autocomplete”会得到很多不错的结果，除非我弄错了你想要做什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T22:46:16.080

我认为您对 AJAX 的含义有些困惑。如果您希望过滤与服务器控件的数据源交互，那么根据定义它不会是 AJAX。

我认为，以您想要的方式实时过滤数据绑定控件是不明智的。对于每次迭代，您都必须重新绑定控件，这将产生巨大的开销。

您需要找到一种方法来使用 javascript 在客户端执行此操作。它可以简单地在转发器创建的标记中隐藏项目，因为它们被过滤掉，尽管这将如何完成完全取决于您使用转发器生成的 html。

# c++ - Anyone have a good shared memory container for C++?

> ID：262714
> 
> 赞同：8
> 
> 时间：2008-11-04T17:54:34.580
> 
> 标签：c++, stl, shared-memory

I've long had a desire for an STLish container that I could place into a shared memory segment or a memory mapped file.

I've considered the use of a custom allocator and placement new to place a regular STL container into a shared memory segment. (like this ddj [article](http://www.ddj.com/cpp/184401639;jsessionid=XH553SW4YIE42QSNDLPSKHSCJUNN2JVN?_requestid=537362)). The problem is that STL containers will internally have pointers to the memory they own. Therefore, if the shared memory segment or memory mapped file loads at a different base address (perhaps on a subsequent run, or in a second process), then the internal pointers are suddenly invalid. As far as I can figure out, the custom allocator approach only works if you can always map the memory segment into your process at the same address. At least with memory mapped files, I have lots of experience of that NOT being the case if you just let the system map it where ever it feels like.

I've had some thoughts on how to do this, but I'd like to avoid it if someone else has already done the work (that's me, being lazy).

I'm currently leaving locking out of the discussion, as the best locking strategy is highly application dependent.

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-04T18:48:06.950

The best starting point for this is probably the boost Interprocess libraries. They have a good example of a map in shared memory here: [interprocess map](http://www.boost.org/doc/libs/1_37_0/doc/html/interprocess/quick_guide.html#interprocess.quick_guide.qg_interprocess_map)

You will probably also want to read the section on offset smart pointers, which solves the internal pointer problem you were referring to. [Offset Pointer](http://www.boost.org/doc/libs/1_37_0/doc/html/interprocess/quick_guide.html#interprocess.quick_guide.qg_offset_ptr)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T19:05:57.257

You may also want to checkout the [Intel Threading Building Blocks (TBB) Containers](http://software.intel.com/en-us/blogs/2008/10/13/tbb-containers-vs-stl-functionality-rift/).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T22:40:06.810

I always had good experiences (years ago) with [ACE](http://www.cs.wustl.edu/~schmidt/ACE.html). Its a networking/communication framework, but has a section on shared memory.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-10T20:26:57.360

I only know of proprietary versions. [Bloomberg](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2005/n1850.pdf) and [EA](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2271.html) have both published about their STL versions, but havent released ( to my knowledge ) the fruits of their labor.

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-11-04T09:51:40.363

Try using Qt's QSharedMemory Implementation.

# java - Java 对象到 XML 模式

> ID：262723
> 
> 赞同：3
> 
> 时间：2008-11-04T17:57:00.377
> 
> 标签：java, xml, object

如果您有 Java 对象和 XML 模式 (XSD)，那么获取该对象并将其转换为符合模式的 xml 文件的最佳方法是什么。对象和模式彼此不了解（因为 Java 类不是从模式创建的）。

例如，在类中，可能有一个整数字段“totalCountValue”，它对应于 xsd 文件中名为“countTotal”的元素。有没有一种方法可以创建一个映射，它会说“如果对象包含一个 int totalCountValue，则创建一个名为 'countTotal' 的元素并将其放入 XML”。类似地，对象中可能有一个字段应该被忽略，或者对象中的一个列表应该对应于多个 XML 元素。

我查看了 XStream，但没有看到任何（明显的）方法。是否有其他 XML 库可以简化此任务？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-04T18:13:17.707

我相信这可以通过 JAXB 使用它的注释来实现。我通常发现使用 XJC 从 JAXB（在您的架构中定义）生成对象比映射现有 Java 对象以匹配我的架构要容易得多。YMMV。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-04T18:47:31.680

我正在用 XStream 做对象做 XML 序列化。对于这个序列化程序，您没有发现什么“明显”？一旦你掌握了它的窍门，它就非常简单。

在您提供的示例中，您可能会有以下内容：

```
...
XStream xstream = new XStream(new DomDriver());

xstream.alias("myclass", MyClass.class);
xstream.aliasField("countTotal", MyClass.class, "totalCountValue");

String xml = xstream.toXML(this);
... 
```

对于这个示例类：

```
class MyClass {
     private int totalCountValue;

     public MyClass() {
     }
} 
```

如果您发现一些比这更简单或更“酷”的序列化程序，请与我们分享。我也在寻求改变...

[在此处](http://xstream.codehaus.org/tutorial.html)查看 XStream 迷你教程

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-04T19:53:12.000

我使用一个名为[JiBx](http://jibx.sourceforge.net/)的 java 库来完成这项工作。您需要编写一个映射文件（在 XML 中）来描述您希望 XML Schema 元素如何映射到 java 对象。有几个生成器工具可以帮助自动化该过程。另外它真的很快。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-07T16:26:30.700

我尝试了大多数建议的库，以查看哪个最适合我的需求。我还尝试了一个这里没有提到但由同事建议的库，它是一个名为[Woodstox](http://woodstox.codehaus.org/)的 StAX 实现。

诚然，我对所有这些库的测试并不完整，但出于问题中提到的目的，我发现 Woodstox 是最好的。它是编组速度最快的（在我的测试中，它比 XStream 高出大约 30~40%）。它也相当容易使用和控制。

这种方法的缺点是创建的 XML（因为它是由我定义的）需要通过验证器运行，以确保它与架构正确。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-05T21:07:59.057

您可以使用来自 Apache Commons 的名为[Betwixt](http://commons.apache.org/betwixt/)的库。如果您需要往返，它可以将 bean 映射到 XML，然后再返回。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-05T21:16:13.453

看看[JDOM](http://jdom.org/)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-10T11:08:56.253

我会说 JAXB 或 Castor。我发现 Castor 更易于使用且更可靠，但 JAXB 是标准

# asp.net - 对多部分网站使用嵌套母版页或用户控件更好吗？

> ID：262724
> 
> 赞同：3
> 
> 时间：2008-11-04T17:57:07.850
> 
> 标签：asp.net, user-controls, master-pages

我正在创建一个网站，该网站有 5 个不同的子站点，每个子站点具有相同的整体外观，但每个站点都有不同的徽标和添加的导航。

你觉得更好的方法是什么：

*   使用新的嵌套母版页功能创建 5 个子母版页。
*   使用单个母版页并动态加载与每个子站点的特定徽标/导航相对应的用户控件。

我目前正在使用嵌套母版页路线。

**更新（2008 年 12 月 19 日）：**

我正在使用嵌套母版页，效果很好。您可以传递 ContentPlaceHolders，甚至可以为占位符设置默认内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T18:11:41.767

Nested Master 比动态加载用户控件要好得多。动态加载控件很慢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T18:28:03.870

MasterPage 是一个控件，也可以动态加载。但是，要回答您的问题，听起来不同的母版页是要走的路。它会给你更多的灵活性，特别是如果说，一个客户希望他们的标志在侧面运行，或者用户控件无法做到的事情。Master 将让您完全控制包装 html。

# unit-testing - 你如何衡量你的单元测试的质量？

> ID：262727
> 
> 赞同：40
> 
> 时间：2008-11-04T17:57:22.653
> 
> 标签：unit-testing, testing, tdd

如果您（或您的组织）渴望对您的代码进行彻底的单元测试，那么您如何衡量工作的成功或质量？

*   您是否使用代码覆盖率，您的目标是多少百分比？
*   您是否发现像 TDD 这样的哲学比指标有更好的影响？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-11-04T18:43:25.773

我的提示不是确定您是否拥有良好的单元测试本身的方法，而是随着时间的推移发展良好的测试套件的方法。

每当您遇到错误时，无论是在您的开发中还是由其他人报告，都要修复它两次。您首先创建一个重现问题的单元测试。当你有一个失败的测试，然后你去解决问题。

如果问题一开始就存在，那就是关于代码或域的微妙之处的暗示。为它添加一个测试可以确保它在未来永远不会被重新引入。

这种方法的另一个有趣的方面是，它可以帮助您在真正去查看代码的复杂性之前从更高的层次理解问题。

此外，对于其他人已经提到的测试覆盖率的价值和缺陷，+1。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-11-04T18:15:57.717

代码覆盖率是一个有用的指标，但应谨慎使用。有些人认为代码覆盖率，特别是覆盖率，有点过于认真，并将其视为良好单元测试的指标。

我的经验告诉我，比试图获得 100% 的覆盖率更重要，这并不容易，人们应该专注于检查关键部分是否被覆盖。但即便如此，您也可能会得到误报。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-11-04T19:01:13.117

我非常支持 TDD，但我不太重视覆盖率统计数据。对我来说，单元测试的成功和有用性是开发团队在一段时间内感受到的，因为测试 (a) 预先发现错误，(b) 无需回归即可进行重构和更改，(c) 帮助充实模块化，解耦设计，（d）等等。

或者，正如 Martin Fowler 所说，支持单元测试和 TDD 的轶事证据是压倒性的，但你无法衡量生产力。在此处阅读有关他的 bliki 的更多信息：http: [//www.martinfowler.com/bliki/CannotMeasureProductivity.html](http://www.martinfowler.com/bliki/CannotMeasureProductivity.html)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-11-04T18:53:07.020

要获得对代码的完全信心，您需要不同级别的测试：单元、集成和功能。我同意上面给出的建议，即测试应该是自动化的（持续集成），并且单元测试应该涵盖具有各种边缘案例数据集的所有分支。代码覆盖工具（例如 Cobertura、Clover、EMMA 等）可以识别分支中的漏洞，但不能识别测试数据集的质量。FindBugs、PMD、CPD 等静态代码分析可以在代码中的问题区域成为问题之前识别它们，并大大有助于促进更好的开发实践。

测试应尝试尽可能多地复制应用程序将在其中运行的整体环境。它应该从最简单的情况（单元）开始到最复杂的情​​况（功能）。对于 Web 应用程序，必须通过各种浏览器来运行网站的所有用例的自动化流程，因此像 SeleniumRC 这样的工具应该包含在您的工具包中。

但是，软件的存在是为了满足业务需求，因此也存在针对需求的测试。这往往是基于功能（网络）测试的手动过程。本质上，您需要针对规范中的每个要求和相应的功能测试构建一个可追溯性矩阵。在创建功能测试时，它们与一项或多项要求相匹配（例如，以 Fred 身份登录、更新帐户详细信息以获取密码、再次注销）。这解决了可交付成果是否符合业务需求的问题。

总的来说，我会提倡一种基于自动化单元测试（JUnit、nUnit 等）的测试驱动开发方法。对于集成测试，我建议在每次构建时使用一个已知数据集自动填充测试数据库，该数据集说明常见用例，但允许在其上构建其他测试。对于功能测试，您将需要某种用户界面机器人（用于 Web 的 SeleniumRC，用于 Swing 的 Abbot 等）。在构建过程中可以很容易地收集关于每个指标的指标，并显示在 CI 服务器（例如 Hudson）上，供所有开发人员查看。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-11-04T17:59:36.143

如果它可以打破，它应该被测试。如果它可以被测试，它应该是自动化的。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-11-04T19:12:37.633

如果您衡量测试质量的主要方法是一些自动化指标，那么您已经失败了。

指标可能会产生误导，并且可能会被玩弄。如果度量标准是判断质量的主要（或更糟糕的是，唯一的）手段，他们将被玩弄（也许是无意的）。

例如，代码覆盖率具有很大的误导性，因为 100% 的代码覆盖率远不及完整的测试覆盖率。此外，像“80% 代码覆盖率”这样的数字在没有上下文的情况下同样具有误导性。如果该覆盖位于最复杂的代码位中并且只是错过了如此简单的代码，很容易通过肉眼验证，那么这比如果该覆盖以相反的方式有偏差要好得多。

此外，区分测试的测试域（本质上是功能集）及其质量也很重要。测试质量不是由它测试的数量决定的，就像代码质量不是由功能清单决定的一样。测试质量取决于测试在测试中的工作表现。这实际上很难用自动化指标来总结。

下次去写单元测试的时候，试试这个实验。看看你可以用多少种不同的方式编写它，使其具有相同的代码覆盖率并测试相同的代码。看看是否有可能编写一个满足这些标准的非常差的测试以及一个非常好的测试。我想你可能会对结果感到惊讶。

最终，经验和判断是无可替代的。一个人的眼睛，希望是几只眼睛，需要查看测试代码并决定它是否好。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-11-04T17:59:57.203

代码覆盖率之于测试就像测试之于编程一样。它只能在出现问题时告诉你，它不能告诉你什么时候一切正常。你应该有 100% 的代码覆盖率甚至更高。代码逻辑的分支应该使用多个输入值进行测试，充分运用正常、边缘和极端情况。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-11-04T18:04:46.697

我通常做 TDD，所以我先编写测试，这有助于我了解我希望如何使用这些对象。

然后，当我编写类时，大部分情况下我可以发现常见的陷阱（即我所做的假设，例如变量是特定类型或值范围），当这些出现时，我会写一个针对该特定情况的特定测试。

除此之外，尽可能获得尽可能好的代码覆盖率（有时不可能达到 100%），您或多或少已经完成了。然后，如果将来确实出现任何错误，您只需确保为它编写一个测试用例，首先公开它，并在修复后通过。然后正常修复。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-11-05T17:01:08.353

监控代码覆盖率可能很有用，但不是专注于任意目标率（80%、90%、100%？），我发现随着时间的推移瞄准积极趋势很有用。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-11-04T19:12:59.240

我认为单元测试的一些最佳实践是：

*   它们必须是自包含的，即不需要太多的配置和外部依赖即可运行。让测试构建它们自己的依赖项，例如运行测试所需的文件和网站。
*   在修复它们之前使用单元测试来重现错误。这有助于防止错误在未来再次出现。
*   使用代码覆盖工具来发现任何单元测试都没有执行的关键代码。
*   将单元测试与夜间构建和发布构建集成。
*   将测试结果报告和代码覆盖率报告发布到团队中的每个人都可以浏览的网站。理想情况下，发布应该自动化并集成到构建系统中。

除非您开发任务关键型软件，否则不要期望达到 100% 的代码覆盖率。达到这个水平可能会非常昂贵，并且对于大多数项目来说不值得付出努力。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-12T11:25:30.650

我尝试使用的另一种技术是将您的代码分成两部分。我最近在[这里](http://wallguide.spaces.live.com/blog/cns!2147A0FA9C96ABA5!126.entry "关于报道的博客条目")写了一篇博客。简短的描述是在两组库中维护您的生产代码，其中一组（希望更大的集合）具有 100% 的行覆盖率（或者如果您可以测量它更好），另一组（希望是少量代码）具有0% 覆盖率，是的，**0%**覆盖率。

您的设计应该允许这种分区。这应该可以很容易地查看未涵盖的代码。随着时间的推移，您可能会对如何将代码从较小的集合移动到较大的集合有了想法。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-06-07T19:20:42.193

变异测试的概念似乎很有希望作为一种衡量（测试？）单元测试质量的方法。突变测试基本上意味着对您的生产代码进行小的“突变”，然后查看是否有任何单元测试失败。小突变通常意味着更改`and`为`or`或。如果一个或多个单元测试失败，则意味着“突变体”被捕获。如果突变体在您的单元测试套件中幸存下来，则意味着您错过了一次测试。当我对具有 100% 行和分支覆盖率的代码应用突变测试时，它通常会发现一些我错过了测试的地方。`<``<=`

有关概念的描述和工具链接，请参见[https://en.wikipedia.org/wiki/Mutation_testing](https://en.wikipedia.org/wiki/Mutation_testing)。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-10-26T14:11:35.380

*   除了 TDD，我发现自己在 BDD 之后编写了更多理智的测试（例如[http://rspec.info/](http://rspec.info/)）
*   永恒的讨论总是嘲笑或不嘲笑。一些模拟可能会变得比它正在测试的代码更复杂（这通常表明关注点分离不好）。
    *   因此，我喜欢有这样一个指标的想法：每个代码复杂度的测试复杂度。或简化：每行代码的测试行数。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-09-22T02:19:55.407

突变测试是万无一失的方法，了解更多[https://pitest.org/](https://pitest.org/)和[https://github.com/vmzakharov/mutate-test-kata/blob/master/MutationTestKata.pdf](https://github.com/vmzakharov/mutate-test-kata/blob/master/MutationTestKata.pdf)

# javascript - Javascript onHover 事件

> ID：262740
> 
> 赞同：43
> 
> 时间：2008-11-04T17:59:47.703
> 
> 标签：javascript, javascript-events

有没有一种规范的方法可以使用现有的 onmouseover、onmouseout 和某种计时器来设置 JS onHover 事件？或者当且仅当用户在元素上悬停一定时间时才触发任意函数的任何方法。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-11-04T19:50:39.727

这样的事情怎么样？

```
<html>
<head>
<script type="text/javascript">

var HoverListener = {
  addElem: function( elem, callback, delay )
  {
    if ( delay === undefined )
    {
      delay = 1000;
    }

    var hoverTimer;

    addEvent( elem, 'mouseover', function()
    {
      hoverTimer = setTimeout( callback, delay );
    } );

    addEvent( elem, 'mouseout', function()
    {
      clearTimeout( hoverTimer );
    } );
  }
}

function tester()
{
  alert( 'hi' );
}

//  Generic event abstractor
function addEvent( obj, evt, fn )
{
  if ( 'undefined' != typeof obj.addEventListener )
  {
    obj.addEventListener( evt, fn, false );
  }
  else if ( 'undefined' != typeof obj.attachEvent )
  {
    obj.attachEvent( "on" + evt, fn );
  }
}

addEvent( window, 'load', function()
{
  HoverListener.addElem(
      document.getElementById( 'test' )
    , tester 
  );
  HoverListener.addElem(
      document.getElementById( 'test2' )
    , function()
      {
        alert( 'Hello World!' );
      }
    , 2300
  );
} );

</script>
</head>
<body>
<div id="test">Will alert "hi" on hover after one second</div>
<div id="test2">Will alert "Hello World!" on hover 2.3 seconds</div>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-11-04T18:02:43.393

你能澄清你的问题吗？在这种情况下，什么是“ohHover”，它与悬停时间的延迟有何对应？

也就是说，我想你可能想要的是......

```
var timeout;
element.onmouseover = function(e) {
    timeout = setTimeout(function() {
        // ...
    }, delayTimeMs)
};
element.onmouseout = function(e) {
    if(timeout) {
        clearTimeout(timeout);
    }
}; 
```

或`addEventListener`/`attachEvent`或你最喜欢的库的事件抽象方法。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-06-04T16:29:57.540

如果您使用 JQuery 库，您可以使用 .hover() 事件，它合并了 mouseover 和 mouseout 事件并帮助您处理时间和子元素：

```
$(this).hover(function(){},function(){}); 
```

第一个函数是悬停的开始，下一个是结束。阅读更多： [http ://docs.jquery.com/Events/hover](http://docs.jquery.com/Events/hover)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-04T19:23:21.670

我认为您不需要/想要超时。

onhover（悬停）将被定义为“结束”某物的时间段。恕我直言

```
onmouseover = start...

onmouseout = ...end 
```

为了记录，我已经做了一些事情来“伪造”IE6中的悬停事件。它相当昂贵，最后我放弃了它以支持性能。

# .net - IIS 6/.Net 2：用户 A 如何获取处于不同会话和另一个框中的不相关用户 B 的用户 cookie？

> ID：262742
> 
> 赞同：0
> 
> 时间：2008-11-04T18:00:06.580
> 
> 标签：.net, asp.net, .net-2.0, iis-6

1) 用户 A 访问该站点，创建一个帐户并登录 2) 用户 b 访问该站点。用户 b 不必登录，而是像用户 b 是用户 a 一样输入。用户 b 可以访问用户 a 的所有数据，并且可以作为用户 a 浏览该站点。

注意：用户 b 没有登录。用户 b 只是点击站点，站点返回，就好像用户 b 已经以用户 a 的身份登录一样。

注 2：用户 a 和用户 b 位于不同的计算机上。此外，代码中不涉及静态变量。

设置：站点中页面的 IIS 6 .Net 2.0 OutputCache 关闭

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T18:25:14.393

检查您没有在静态 (c#) 或共享 (VB) 变量中存储任何数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T18:13:43.433

这个问题似乎与[Apache/Tomcat 错误 - 错误页面正在交付](https://stackoverflow.com/questions/246540/apachetomcat-error-wrong-pages-being-delivered)非常相似。正如[我](https://stackoverflow.com/questions/246540/apachetomcat-error-wrong-pages-being-delivered#248724)对该问题的回答所提到的，如果您使用会话 cookie，请检查您的`Vary`标题是否正确。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T22:29:36.787

来自其他团队成员的研究：

> 尽管身份验证 cookie 可能在来自门户的图像中，但绝不应该将带有 David 票证的身份验证 cookie 发送到 Todd 的浏览器。此外，如果图像以某种方式缓存在某个地方，以便不同的用户获得其他用户的身份验证 cookie，那么我认为这个问题会经常发生并且应该是可重复的。但是我想知道这是否是一个负载平衡系统，如果是，负载平衡器会缓存任何东西吗？

基于 ASP.NET、IIS 6.0 和 Windows 2003 Server 的输出缓存导致用户共享会话的已知问题，该问题可能仅在 100,000 个请求中重复出现（请参阅“会话和输出缓存”部分）本文）[http://msdn.microsoft.com/en-us/magazine/cc163577.aspx](http://msdn.microsoft.com/en-us/magazine/cc163577.aspx)

# iphone - 如何圆角 myapp 的图标

> ID：262748
> 
> 赞同：2
> 
> 时间：2008-11-04T18:01:43.847
> 
> 标签：iphone, icons, rounding

在模拟器模式下，我的应用程序有一个圆角图标，但在真正的 iPhone 上，这些角不是圆角的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-05T11:32:14.443

Corners get automatically rounded if you install via MobileInstallation (from iTunes, Xcode or App Store). If you're building the package and installing it into /Applications manually or with cydia/apt, you have to make a rounded icon yourself.

You can find the images used to round the corners and add reflection in /System/Library/Frameworks/UIKit.framework/Other.artwork, the first 3 images are the mask, reflection and shadow. You can extract the .artwork file with [this script here](http://davepeck.org/software/iphoneart/ "iPhone Artwork Tool")

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-04T18:06:38.033

默认情况下，iPhone 应该圆角并添加反射效果。确保您没有将 UIPrerenderedIcon 键添加到 Info.plist 文件中。希望这可以帮助！

亚当

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-28T14:50:43.417

我知道这篇文章很老了。除非您安装了 Cydia 并且将应用程序构建为 .deb，否则新版本的 iOS 不会遇到此问题

如果您想为 Cydia 转角，请执行以下操作：

1.  从 Cydia 下载 iFile 和 IconMaker
2.  使用 iFile 找到图标文件并单击它，然后选择 IconMaker
3.  启用保存到相机胶卷
4.  生成图标
5.  通过电子邮件将生成的图标（144 和 77 像素版本）发送给您自己

资料来源： [http ://www.ifans.com/forums/threads/how-to-make-apps-with-square-edges-into-smooth-round-edges.342846/](http://www.ifans.com/forums/threads/how-to-make-apps-with-square-edges-into-smooth-round-edges.342846/)

# c# - 使用 DSASignatureFormatter 而不是 DSACryptoServiceProvider 生成签名有什么好处？

> ID：262756
> 
> 赞同：1
> 
> 时间：2008-11-04T18:03:22.533
> 
> 标签：c#, dsa

我正在使用 DSA 为二进制 blob 创建签名，并且试图弄清楚使用 DSASignatureFormatter 的 CreateSignature(byte[]) 而不是仅使用 DSACryptoServiceProvider 的 CreateSignature(byte[]) 可以获得什么

据我所知，使用 DSASignatureFormatter 的唯一好处是我可以使用 SetHashAlgorithm() 指定散列算法，然后格式化程序会为我处理数据散列。在 DSACryptoServiceProvider 场景中，我必须先对数据进行预散列，然后再将其传递给 CreateSignature 方法。

使用格式化程序还有什么其他好处吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T05:39:18.640

DSASignatureFormatter 是一个更受限制的完整加密算法类。它只关心签名有效负载，它的逆 (DSASignatureDeformatter) 只关心验证签名。

我想如果有一天您想切换到 RSAPKCS1SignatureFormatter，您将能够针对基类完成所有工作并且相当容易地切换。

AsymmetricSignatureFormatter 和 AsymmetricSignatureDeformatter 是简单的类，无论如何都相当容易编码，并且代表了 SymmetricAlgorithm 类的不同抽象层。

# mysql - MySQL MyISAM 和 innoDB 内存使用情况

> ID：262798
> 
> 赞同：1
> 
> 时间：2008-11-04T18:16:03.460
> 
> 标签：mysql, memory, innodb, myisam

有谁知道 MyISAM 和 innoDB 使用了多少内存？处理小表与处理大表（最大 32 GB）时，它们的内存使用情况如何比较？

我知道 innoDB 比 MyISAM 更重，但还有多少呢？

任何帮助，将不胜感激。

谢谢，jb

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-04T19:33:22.693

你不能这样比较它们。或者至少，你不应该。每个人都以不同的方式使用内存。如果您正在调整数据库的性能，则尤其如此。

MyISAM 具有特定的索引缓冲区，它使用 OS 磁盘缓冲区来缓存其他数据。让你的缓冲区大于索引的总和是没有意义的，但是你给它的内存越多，它就会越快。

InnoDB 有一个用于所有数据的缓冲池。你可以根据你的可用内存和你想给它多少来配置它。InnoDB 将尽可能多的数据缓冲在内存中。如果您可以将整个 DB 放入内存中，InnoDB 将永远不会从磁盘读取。当数据大小大于缓冲池时，许多 InnoDB 数据库都会看到巨大的性能损失。

MySQL 是非常可配置的。它可以调整以满足您的需求。通常，应为数据库提供尽可能多的内存，因为它们几乎总是受磁盘限制。更多内存意味着可以缓冲更多。

# mysql - SQL Server 2005 是否具有与 MySql 的 ENUM 数据类型等效的数据类型？

> ID：262802
> 
> 赞同：28
> 
> 时间：2008-11-04T18:17:12.723
> 
> 标签：mysql, database, sql-server-2005, enums

我正在做一个项目，我想在表格中存储一些容易枚举的信息。MySql 的枚举数据类型正是我想要的： http: [//dev.mysql.com/doc/refman/5.0/en/enum.html](http://dev.mysql.com/doc/refman/5.0/en/enum.html)。SQL Server 2005 中是否有等价物？

我知道我可以使用键将可能的值存储在类型表中，但我宁愿不必链接回它进行描述。我们的数据库标准不允许我们链接非整数或唯一标识符字段，因此也将可能的键存储为字符。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-11-04T18:20:05.557

这对你有用吗？

来自[http://blechie.com/wtilton/archive/2007/08/24/303.aspx](http://blechie.com/wtilton/archive/2007/08/24/303.aspx)

创建表...

**MySQL：**

```
ColumnName ENUM('upload', 'open', 'close', 'delete', 'edit', 'add')
   DEFAULT 'open' 
```

**SQL 服务器：**

```
ColumnName varchar(10) 
   CHECK(ColumnName IN ('upload', 'open', 'close', 'delete', 'edit', 'add')) 
   DEFAULT 'open' 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-11-04T18:27:13.920

MySQL 的 ENUM 数据类型的一个特点是它在每一行的值列表中只存储一个数字索引，而不是字符串本身。因此，它通常更具存储效率。此外，当您按 ENUM 列排序时，默认行为是按数字索引排序，因此按 ENUM 中元素的顺序。

Nikki9696 建议使用带有 CHECK 约束的 VARCHAR 列。这满足了将值限制为某个允许值的短列表，但它不模拟存储效率或特殊的排序顺序。

获得这两种行为的一种方法是将列声明为查找表中的整数外键，您可以在其中存储每个允许的字符串。

# iphone - 解析 Unix/iPhone/Mac OS X 版本的 PE 标头

> ID：262805
> 
> 赞同：0
> 
> 时间：2008-11-04T18:18:08.227
> 
> 标签：iphone, lua

这有点令人费解，但让我们试试：

我正在将 LUA 脚本集成到我的游戏引擎中，过去我在 win32 上以一种优雅的方式完成了这项工作。在 win32 上，我所做的只是将我想向 LUA 公开的所有函数标记为导出函数。然后，为了将它们集成到 LUA 中，我会解析可执行文件的 PE 头，解开名称，解析参数等，然后将它们注册到我的 LUA 运行时。这让我可以避免单独手动注册每个函数，只是为了将它们暴露给 LUA。

现在，快进到今天我在 iPhone 上工作的地方。我浏览了一些 Unix 的东西，并且非常接近采用类似的方法，但是我不确定它是否真的有效。

我对 Unix 并不完全熟悉，但这是我目前在 iPhone 上所拥有的：

上述步骤实际上不会让我到达我想去的地方，但即使这样也行不通。有没有人有在 Unix 上做这种事情的经验？是否有任何标题或功能我可以谷歌让我走上正确的轨道？

谢谢;）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-04T19:19:05.780

iPhone 不支持初始应用程序启动后的动态链接。虽然您想要做的实际上不需要在任何新的应用程序 TEXT 中进行链接，但发现某些 dl* 函数的行为与预期不同，我不会感到震惊。

您也许可以编写一些特定于平台的代码，但我建议使用由各种 BSD 开发的称为链接器集的技术。基本上，您可以注释要使用的功能（就像您当前将它们标记为导出一样）。通过一些预处理器的魔法，他们存储注释，有时在二进制图像的一个额外段中，然后有代码来获取该数据并枚举它。因此，您只需将所需的所有函数添加到链接器集中，然后遍历链接器集并使用 lua 注册其中的所有函数。

我知道人们已经在 Windows 和 Linux 上启动并运行了这些东西，我已经在 Mac OS X 和各种 *BSD 上使用过它。我正在[链接](http://www.freebsd.org/cgi/cvsweb.cgi/src/sys/sys/linker_set.h?rev=1.17.16.1;content-type=text%2Fplain)FreeBSD 的 linker_set 实现，但我没有亲眼见过 Windows 的实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T18:39:19.527

您需要传递`--export-dynamic`给链接器（通过`-Wl,--export-dynamic`）。

注意：这适用于 Linux，但可能是您搜索的起点。

参考：

*   [http://sourceware.org/binutils/docs/ld/Options.html](http://sourceware.org/binutils/docs/ld/Options.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T19:35:49.337

如果静态链接是一个选项，请将其集成到链接描述文件中。在链接之前，对所有目标文件执行“nm”，提取全局符号，并生成一个 C 文件，其中包含所有符号名称到符号值的（最好是排序/散列的）映射：

```
 struct symbol{ char*  name; void * value } symbols = [
     {"foo", foo},
     {"bar", bar},
     ...
     {0,0}}; 
```

如果你想对你公开的内容有选择性，实现一个命名模式可能是最简单的，例如在所有函数/方法前加上 Lua_。

或者，您可以创建一个简单的宏，

```
 #define ForLua(X) X 
```

然后 grep ForLua 的源代码，以选择要合并的符号。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T21:04:42.637

您可以只生成一个映射文件并使用它，不是吗？

# project-management - 每周敏捷 40 小时

> ID：262810
> 
> 赞同：6
> 
> 时间：2008-11-04T18:19:16.493
> 
> 标签：project-management, agile

您是否曾经参与过一个（全职）项目，使用敏捷方法实际上可以让您完成每周 40 小时的工作？如果是这样，最有价值的敏捷实践是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-04T18:31:23.367

是的，我在一个从一开始就使用 SCRUM 运行的项目上花 40 小时（实际上是 37.5 小时左右，这是我的合同规定的）。那是大约 2 年前，也是我们第一次实施 SCRUM。这是我个人加班时间最少的项目，也是我们正在开发的PC游戏。即使我们在周五发布公开测试版，我现在什至还没有处于“紧缩”模式。

从那时起，我们学到了很多关于 SCRUM 和敏捷的知识。从我的角度来看，最有价值的一个教训是：pod 大小必须合理……我们从 12 到 20 名成员的 pod 开始，但效果并不好。最多不得超过 10 个。在“片状”和“模糊”任务上达成一致太容易了，否则站立和任务计划会议将花费太长时间。因此，请保持 pod 的大小和任务的具体化，并让产品负责人或签字人与那些将从事该任务的人一起。

此外，对于每两周一次的任务计划时间表，您必须让每个产品负责人就当前 sprint 的任务列表和优先级达成一致，并且应该在该计划会议之前发出新的任务请求，否则它将在当前 sprint 中被忽略。短跑。这迫使我们改进 Pod 间的通信。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-04T18:28:54.820

Scrum 和愿意接受它的管理层。

公平的冲刺计划。当你协商自己的 sprint 时，你可以选择你的团队可以完成的事情，而不是让任务从上面下来。锁定你的 sprint 承诺（管理层不能在 sprint 中期改变它）可以让你摆脱人们每一个不断变化的突发奇想。

由产品负责人和高层管理人员共同维护的维护良好、优先考虑的积压工作**非常**有用。它迫使他们坐下来思考他们想要的功能、他们想要的时间以及所涉及的成本。他们经常会说他们*现在*需要一个功能，但是当他们意识到他们必须放弃其他东西来获得他们想要的东西时，他们的期望变得更加现实。

时间拳击。如果您遇到重大问题，请开始从 sprint 中删除功能，而不是加班。

如果没有它，您的流程需要管理支持，敏捷只是一个词。

我有提到开明的管理吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-04T18:43:37.740

无法在每周 40 小时内完成任务可能是由于多种原因。

我看到这可能发生在 Scrum 项目的早期冲刺中，因为团队不确定：

1.  他们在冲刺中可以做的工作量，并且可能会咬得比咀嚼的更多，并且
2.  他们有能力准确估计奖励给工作块的分数，或
3.  完成“一个点的价值”工作所需的努力量。

他们也可能对在分配的时间内可以完成的事情过于乐观。

在那之后，我们进入了 Scrum 的几个不好的地方，具体来说：

1.  不允许团队拥有自己的工作量，也许
2.  管理层凌驾于 sprint 中应该包含什么的决策之上

如果其中任何一个切入，那么您是：

1.  只在名义上进行 Scrum，并且
2.  “在没有桨的情况下上溪。”

除了纠正第一个列表中的任何问题之外，您无能为力，但这只能通过经验来实现。

纠正第二个列表中的两点需要重新思考公司如何扼杀而不是采用 Scrum 最佳实践。

高温高压

问候，

抢

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-05T14:15:11.370

听起来可能很难，但让我们现实一点。使用敏捷或任何其他风格的软件过程与每周 40 小时无关。通常情况下，雇佣合同中规定了每周的工作时间，开发商可以自行决定是否进行任何额外的无偿工作。

请不要将神奇的治疗能力归因于您喜欢的任何软件过程。它可以提供不同的风险管理方法、不同的规划范围或更好的利益相关者参与；但是，除非奴隶制在您那里仍然合法，否则工作日从您进门时开始，到您回家时结束。

开发商有责任确保他们的管理不违反雇佣合同。无论使用何种方法，您的股份都受到您获得的工资金额和您同意作为回报的诚实工作时间的限制。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-04T18:54:44.253

当然。

对我来说，最重要的事情有帮助（按重要性排序）：

1.  跨职能团队——让程序员、测试人员、技术作家和销售/服务人员在同一个团队中并每天互相交谈（每日通话）非常棒。
2.  定期构建和持续集成
3.  对利益相关者和客户进行频繁的审查/演示。这仅在迭代（Sprint）期间减少了风险和时间损失。
4.  每日通话或站立会议

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-04T19:10:13.193

[除了以上所有（不准确的估计、糟糕的 Scrum 实施等）之外，问题可能是对团队的Velocity](http://www.scrumalliance.org/articles/39-glossary-of-scrum-terms#1110)缺乏了解，就像“团队可以完成多少工作”一样简单，但这不是看起来[很容易找到](http://jan-so.blogspot.com/2007/11/velocity-not-so-simple-value.html)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-04T19:51:38.150

作为 Scrum Master 和人事经理，我一直是每周工作 40 小时的坚定拥护者。我积极劝阻团队成员不要工作超过 40 小时，因为随着工作与生活平衡的转变，生产力会迅速下降。我发现从深夜工作中恢复过来的时间通常比加班时间要长。

当它运行良好时，Scrum 通过鼓励（要求？）始终保持一致的速度来帮助最大限度地减少迭代结束时经常出现的“填塞”，并且速度和燃尽图等工具可以很好地计划和跟踪进度。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-04T20:59:23.893

我曾在几家实践各种敏捷方法的商店工作过。最有趣的是全天有 4 个“会话”，大约一个半小时，中间有 20 分钟的休息时间。周五是个人开发日，所以最后两节课是针对你想做的任何事情。

对我们而言，关键是沟通，真正确定用户故事的概念，将完成定义为“生产中”，以及信任。我们还确保将故事分成不超过一天的小块，最好是 1-2 次开发会议。我们通常在每个会话中将配对交换到每个其他会话。

目前，我经营着一个 20 多人的开发团队，该团队部分分布。对我来说，关键的租户是可持续的节奏——这意味着我不希望我的团队每周工作超过 40 小时，即使是偶尔。显然，如果有人想迟到做事，这取决于他们，但总的来说，我努力确保我们在每周 40 小时给我们的速度内工作。

# biztalk - BizTalk 2006 教程 1：EDI 到 XML 文档的翻译

> ID：262811
> 
> 赞同：1
> 
> 时间：2008-11-04T18:20:01.923
> 
> 标签：biztalk, edi, biztalk-2006

运行 BizTalk 2006 教程第 3 课中的解决方案后，我找不到翻译的文件：运行 EDI 到 XML 解决方案。

它应该放在 c:\Program Files\Microsoft BizTalk Server 2006\EDI\Adapter\Getting Started with EDI\Northwind\In 文件夹中。

基本 EDI 适配器在 c:\Documents and Settings\All Users\Application Data\Microsoft\BizTalk Server 2006\EDI\Subsystem\Documents\PickupEDI 文件夹中提取文件，但我在 X-12 4010 中找不到翻译文件850 文件格式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T20:18:10.873

我对您提到的教程并不立即熟悉，但以下是查找任何文档在 BizTalk 中的位置的步骤。

前两个要检查的地方是事件查看器和 BizTalk Server 管理控制台。

检查事件查看器中没有错误。

在管理控制台中，单击左侧窗口中的 BizTalk Group，您应该会在右侧窗格中看到两列，*Work in Progress*和*Suspended Items*。单击*Running service instances*和*Suspended service instances*。检查您的消息是否因任何原因而延迟（可能是发送端口被关闭）。

接下来，从*开始*->*所有程序*-> *Microsoft BizTalk Server 2006*选择*健康和活动跟踪*(HAT) 工具。

在 HAT 中，选择查询 -> 最近的 100 个服务实例。找到将写出您的文件的管道，右键单击服务实例并选择消息流。在消息流视图中，您应该在 URL 中看到文件写入的磁盘位置。

（您也可以在管理控制台中查看发送端口指向的位置）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-04T22:35:54.917

感谢您就如何从一般角度解决 BizTalk Server 问题的建议。它确实有帮助。我通过阅读错误日志解决了这个问题。

这是错误：

拒绝访问。客户端用户必须是以下帐户之一的成员才能执行此功能。SSO 管理员：SSO 管理员 SSO 附属管理员：SSO 附属管理员 应用程序管理员：BizTalk Server 管理员 应用程序用户：BizTalk 应用程序用户

在将服务帐户添加到“SSO 管理员”并重新启动所有 BizTalk 相关服务后，它现在可以工作了。

# java - 什么时候调用 java 的 thread.run() 而不是 thread.start()？

> ID：262816
> 
> 赞同：109
> 
> 时间：2008-11-04T18:21:09.237
> 
> 标签：java, multithreading, concurrency

您什么时候会调用 Java`thread.run()`而不是`thread.start()`？

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2008-11-04T18:26:40.207

您可能希望在严格关注功能而非并发性的特定单元测试中调用 run()。

* * *

## 回答 #2

> 赞同：95
> 
> 时间：2008-11-04T18:23:09.387

绝不。直接调用 run() 只是同步执行代码（在同一个线程中），就像普通的方法调用一样。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2008-11-04T18:24:33.223

取自[Code Style Java 线程常见问题解答](http://www.codestyle.org/java/faq-Threads.shtml#threadstartrun)：

> 问：线程的 start() 和 run() 方法有什么区别？
> 
> A: Thread 类中单独的 start() 和 run() 方法提供了两种创建线程程序的方法。start() 方法开始执行新线程并调用 run() 方法。start() 方法立即返回，并且新线程通常会继续，直到 run() 方法返回。
> 
> Thread 类的 run() 方法什么都不做，因此子类应该用代码覆盖该方法以在第二个线程中执行。如果使用 Runnable 参数实例化 Thread，则该线程的 run() 方法将在新线程中执行 Runnable 对象的 run() 方法。
> 
> 根据线程程序的性质，直接调用 Thread run() 方法可以提供与通过 start() 方法调用相同的输出，但在后一种情况下，代码实际上是在新线程中执行的。

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2012-05-21T05:38:15.493

执行`thread.run()`不会创建一个新`Thread`的代码在其中执行。它只是在调用代码的当前线程中执行`thread.run()`代码。

执行`thread.start()`创建一个新的操作系统级线程，其中`run()`调用该方法。

在本质上：

> 单线程编程→直接调用`run()`方法

> 多线程编程→调用`start()`方法

此外，正如其他人所提到的，“测试”似乎是您可以`run()`直接从代码中调用的唯一可取的情况。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2008-11-04T19:10:49.637

这已经被提到过，但要明确一点：创建一个新的 Thread 对象只是为了调用它的 run() 方法是不必要的昂贵并且应该是一个主要的危险信号。*创建一个 Runnable impl 并（a）直接调用它的*run() 方法（如果这是所需的行为）或者 (b) 使用该 Runnable 构造一个新线程并启动线程，这将是一个更好、更解耦的设计。

更好的是，为了进一步解耦，请查看`Executor`JDK 5 和更新版本中的接口和框架。简而言之，这允许您将任务执行（Runnable 实例）与其执行*方式*（Executor 实现，它可能在当前线程中执行 Runnable，在新线程中，使用池中的现有线程，等等）。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2008-11-04T18:23:07.283

调用`thread.start()`，它会依次调用`thread.run()`。想不出你想绕过`thread.start()`直接去的情况`thread.run()`

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2011-08-25T08:46:01.410

Thread 类中的separate`start()`和`run()`方法提供了两种创建线程程序的方法。该`start()`方法开始执行新线程并调用该`run()`方法。该`start()`方法立即返回，并且新线程通常会继续，直到该`run()`方法返回。

Thread 类的`run()`方法什么都不做，所以子类应该用代码覆盖该方法以在第二个线程中执行。如果使用 Runnable 参数实例化 Thread，则该线程的`run()`方法将`run()`改为在新线程中执行 Runnable 对象的方法。

根据线程程序的性质，`run()`直接调用 Thread 方法可以提供与通过方法调用相同的输出`start()`，但在后一种情况下，代码实际上是在新线程中执行的。

[参考](http://www.edugoing.com/qna/index.php?qa=95&qa_1=what-the-difference-between-thread-start-thread-run-method)

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2011-10-16T15:45:04.687

如果问题是 - “为什么调用线程启动方法而不是直接调用运行方法”，那么我已经用下面的示例代码回答了。希望澄清。在下面的示例中：

```
/*
By calling t1.start(), 
we are getting the main calling thread returned immediately 
after the t1.start() called and is ready to proceed for other 
operations.And the thread t1 starts executing the run method of the object r. 
Hence the the output will be:

      I am the main thread , i created thread t1 and had it execute run method, which is currently looping from 0 to 1000000

      I am done executing run method of testThread

*/

/* If we call t1.run() instead of t1.start(), (just replace t1.start() with t1.run() in the code for testing)
 its like a regular method call and the main thread will not return until the run method completes, 
 hence the output will be:

         I am done executing run method of testThread

         I am the main thread , i created thread t1 and had it execute run method, which is currently looping for i to 1000000

*/

class testThread implements Runnable{

 public void run()
 {
     for(int i=0;i<1000000;i++){} //a simple delay block to clarify.

     System.out.println("I am done executing run method of testThread");

 }  
}

public class mainClass{

   public static void main(String [] args)
    {
          testThread r = new testThread();
          Thread t1 = new Thread(r);
          t1.start();  /* Question is: can we call instead t1.run() */  
          System.out.println("I am the main thread , i created thread t1 and had it execute run method, which is currently looping for i to 1000000");

    }
} 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-11-04T18:24:06.220

当您希望它同步运行时。调用 run 方法实际上不会为您提供多线程。start 方法创建一个调用 run 方法的新线程。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-11-04T18:25:02.643

如果您想像执行任何其他方法一样执行 run() 的内容。当然，不要启动线程。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-11-04T18:34:27.773

假设您知道启动和运行方法的用法，即同步与异步；run 方法可以用来测试功能。

另外，在某些情况下，可以在两个不同的地方使用同一个线程类，通过调用两个不同的对象来调用一个 run 方法和另一个 start 方法，从而满足同步和异步功能要求。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-11-04T18:35:19.770

至少在 JVM 1.6 中，有一些检查和 run 被本地调用：

```
 public synchronized void start() {
        /**
     * This method is not invoked for the main method thread or "system"
     * group threads created/set up by the VM. Any new functionality added 
     * to this method in the future may have to also be added to the VM.
     *
     * A zero status value corresponds to state "NEW".
         */
        if (threadStatus != 0)
            throw new IllegalThreadStateException();
        group.add(this);
        start0();
        if (stopBeforeStart) {
        stop0(throwableFromStop);
    }
    }

    private native void start0(); 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2012-09-10T14:02:21.203

只是对上述精彩评论的一个注释：有时你会编写一个多线程代码，它使用“start”方法来运行不同的线程。如果您使用“运行”（而不是“开始”）进行调试，您会发现它会更容易，因为它使代码同步运行并更容易调试。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2015-02-15T10:48:38.643

```
public class TestClass implements Runnable {
    public static void main(String[] args) {
        TestClass tc = new TestClass();

        Thread t1 = new Thread(tc);
        System.out.println("Before Starting Thread " + Thread.currentThread().hashCode());
        t1.start();
        System.out.println("After Starting Thread " + Thread.currentThread().hashCode());
    }

    @Override
    public void run() {
        System.out.println("TestClass Run method is  Running with thread " + Thread.currentThread().hashCode());        
    }
} 
```

# scheme - 在 Scheme 中生成项链的简单算法？

> ID：262826
> 
> 赞同：7
> 
> 时间：2008-11-04T18:23:40.387
> 
> 标签：scheme, combinatorics, necklaces

长度为 n 的 k-ary 项链是长度为 n 的有序列表，其项目来自长度为 k 的字母表，它是所有列表中共享旋转排序的排序中的字典第一个列表。

示例：(1 2 3) 和 (1 3 2) 是字母表 {1 2 3} 中长度为 3 的项链。

更多信息： [http://en.wikipedia.org/wiki/Necklace_(combinatorics)](http://en.wikipedia.org/wiki/Necklace_(combinatorics))

我想在 Scheme（或您选择的 Lisp）中生成这些。我找到了一些论文...
Savage - A New Algorithm for Generate Necklaces
Sawada - 在恒定摊销时间内生成手链
Sawada - 生成带有禁止子串的项链
...但是其中提供的代码对我来说是不透明的。主要是因为它们似乎没有传递所需的字母或长度（n）。我正在寻找的方案程序的形式是 (necklaces n '(ab c...))。

我可以通过首先生成 k^n 列表然后过滤掉旋转来轻松生成这些。但它的内存效率非常低......

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-04T20:25:43.713

用于生成项链的 FKM 算法。PLT 计划。表演上没有那么火爆。它将任何东西都当作字母表，并将内部数字映射到您提供的任何东西上。似乎是正确的；没有保证。我在翻译循环时很懒惰，所以你会得到这种奇怪的 for 循环和转义延续的组合。

```
(require srfi/43)

(define (gennecklaces n alphabet)
  (let* ([necklaces '()]
         [alphavec (list->vector alphabet)]
         [convert-necklace
          (lambda (vec)
            (map (lambda (x) (vector-ref alphavec x)) (cdr (vector->list vec))))]
         [helper
          (lambda (n k)
            (let ([a (make-vector (+ n 1) 0)]
                  [i n])
              (set! necklaces (cons (convert-necklace a) necklaces))
              (let/ec done
                (for ([X (in-naturals)])
                  (vector-set! a i (add1 (vector-ref a i)))
                  (for ([j (in-range 1 (add1 (- n i)))])
                    (vector-set! a (+ j i)
                                 (vector-ref a j)))
                  (when (= 0 (modulo n i))
                    (set! necklaces (cons (convert-necklace a) necklaces)))
                  (set! i n)
                  (let/ec done
                    (for ([X (in-naturals)])
                      (unless (= (vector-ref a i)
                                 (- k 1))
                        (done))
                      (set! i (- i 1))))
                  (when (= i 0)
                    (done))))))])
    (helper n (length alphabet))
    necklaces)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-05T12:47:40.297

作为第一个想法，您可以做显而易见但效率低下的事情：逐步检查所有组合并检查它们是否是项链，即它们是否是元素的词汇最小旋转（上述论文中第 5 页的正式定义）。这就像您提议的方式，但是您将在生成所有非项链后立即丢弃它们。

除此之外，我认为您必须了解这篇文章（[http://citeseer.ist.psu.edu/old/wang90new.html](http://citeseer.ist.psu.edu/old/wang90new.html)）：

T. Wang 和 C. Savage，“生成项链的新算法”，报告 TR-90-20，北卡罗来纳州立大学计算机科学系（1990 年）。

这不是太难，您可以通过实现描述的`tau`and`sigma`函数来分解它，然后按照文章中概述的顺序应用它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T19:12:33.877

我会做一个两步的过程。首先，从字母表中找到 n 个元素的每个组合。然后，对于每个组合，选择最低值，并生成剩余项目的所有排列。

编辑：这是一些代码。它假定输入列表已经排序并且不包含重复项。

```
(define (choose n l)
  (let ((len (length l)))
    (cond ((= n 0) '(()))
          ((> n len) '())
          ((= n len) (list l))
          (else (append (map (lambda (x) (cons (car l) x))
                             (choose (- n 1) (cdr l)))
                        (choose n (cdr l)))))))

(define (filter pred l)
  (cond ((null? l) '())
        ((pred (car l)) (cons (car l) (filter pred (cdr l))))
        (else (filter pred (cdr l)))))

(define (permute l)
  (cond ((null? l) '(()))
        (else (apply append 
                     (map (lambda (x)
                             (let ((rest (filter (lambda (y) (not (= x y))) l)))
                               (map (lambda (subperm) (cons x subperm))
                                    (permute rest))))
                      l)))))

(define (necklaces n l)
  (apply
   append
   (map
    (lambda (combination)
      (map (lambda (permutation)
              (cons (car combination) permutation))
           (permute (cdr combination))))
    (choose n l))))

(display (choose 1 '(1 2 3 4 5))) (newline)
(display (choose 2 '(1 2 3 4 5))) (newline)
(display (permute '(1 2))) (newline)
(display (permute '(1 2 3))) (newline)
(display (necklaces 3 '(1 2 3 4))) (newline)
(display (necklaces 2 '(1 2 3 4))) (newline) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T20:21:05.890

> 示例：(1 2 3) 和 (1 3 2) 是字母表 {1 2 3} 中长度为 3 的项链。

你忘了 (1 1 1) (1 1 2) (1 1 3) (1 2 2) (1 3 3) (2 2 2) (2 2 3) (2 3 3) (3 3 3)。项链可以包含重复项。

如果您只是在寻找长度为 N 的项链，从大小为 N 的字母中提取，并且*不*包含重复项，那么这很容易：会有 (N-1) 个！项链，每条项链的形式都是 {2 .. N}`(1 :: perm)`的`perm`任意排列。例如，{1 .. 4} 的项链将是 (1 2 3 4) (1 2 4 3) (1 3 2 4) (1 3 4 2) (1 4 2 3) (1 4 3 2) . 扩展此方法以处理长度为 K < N 的无重复项链作为练习留给读者。

但如果你想找到可能包含重复元素的真正项链，那就没那么简单了。

# c# - 绘制 DataGridView 行

> ID：262844
> 
> 赞同：1
> 
> 时间：2008-11-04T18:27:10.627
> 
> 标签：c#, datagridview

我正在尝试将 DataGridView 行的背景颜色设置为红色。我尝试了以下行：

dgvActiveCalls.Rows[1].DefaultCellStyle.BackColor = Color.Red;

但它不起作用。然后只是为了看看更新是否有问题，我尝试绘制列而不是行：

dgvActiveCalls.Columns[1].DefaultCellStyle.BackColor = Color.Red;

它工作得很好。如果有人能展示绘制 DataGridView 行的方法，我将非常感激。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T20:57:17.253

确保默认样式未被其他样式覆盖。2.0 中 DGV 的有趣怪癖：似乎继承链几乎与您的预期相反。如果您正在动态添加列，您的 DefaultCellStyle 可以被忽略并被 RowsDefaultCellStyle 覆盖。排序还可以覆盖您设置的样式。

您可能想检查设置这些样式的顺序，并在 Google 上查找有关样式继承的一些文章。

PS 有趣的是，我在谷歌上搜索了一个要提供的链接，并在这个博客上看到了几乎相同的解释：

[http://yakkowarner.blogspot.com/2008/06/datagridview-style-inheritance.html](http://yakkowarner.blogspot.com/2008/06/datagridview-style-inheritance.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T18:51:05.090

我在我的机器上测试了它，它工作正常。你确定那条线没有突出显示吗？如果它突出显示，您将看到突出显示的颜色，而不是红色。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-12-17T22:29:35.153

我建议您将该代码放在 DataGridView 的 RowPrePaint 事件中。例如：

```
private void dgv_RowPrePaint(object sender, DataGridViewRowPrePaintEventArgs e)
{
    /*Here you put your validation in order to paint only the row that you want*/
    if (e.RowIndex == 1)
    {
         DataGridViewRow row = ((DataGridView)sender).Rows[e.RowIndex];
         row.DefaultCellStyle.BackColor = Color.Red;
    }                
} 
```

# asp.net - 如何确定 ASP.NET 日历显示的整个日期范围？

> ID：262849
> 
> 赞同：5
> 
> 时间：2008-11-04T18:28:38.737
> 
> 标签：asp.net, calendar

ASP.NET 日历始终在 7x6 网格中显示 6 周的日期。我的问题是目标月份的第一天*不一定*出现在第一行……在某些情况下，整个第一行显示上个月的日期。在其他情况下，整个最后一行显示下一行的日期。是否有可靠的方法来查询日历对象以确定特定月份/年份的 42 天范围？

例如，考虑 2008 年 6 月和 2009 年 2 月：

[请注意，第一周仅包含上个月的日期 http://img371.imageshack.us/img371/2290/datesmq5.png](http://img371.imageshack.us/img371/2290/datesmq5.png)

我假设日历试图避免将所有“其他月份”日期集中在网格的顶部或底部，因此将目标月份的第一个月放在第二行。例如，我正在寻找一种简单的方法来确定 2008 年 6 月的显示范围是 5 月 25 日 - 7 月 5 日。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-04T19:38:43.510

查看由 ASP.NET 日历控件公开的公共成员，我不认为您可以从日历控件中获取这些信息。

不过，您有一些选择作为“解决方法”，虽然不是很好....但它们会起作用。

1.  您可以手动计算第一周的值
2.  您可以处理“day render”事件来处理各个日期的绑定，并记录最小值/最大值。

当然两者都不是优雅的，但 AFAIK 它是唯一真正的选择

**编辑**

在评论中讨论后，另一个选项是我上面第二个选项的修改版本。基本上第一次调用 Day Render 时，获取接下来 42 天的数据块，然后您可以简单地在列表中搜索正确的日期值，以便在未来调用 DayRender 时显示，避免每天的数据库命中。这样做是另一种“不优雅”的解决方案，但它可以工作，并减少了数据库上的一些负载，但在应用程序端引入了一些开销。

在这里定义结构良好的页面级属性以在绑定事件期间保存项目非常重要，但要确保如果一个月发生变化等，它不会被错误地加载等。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-27T20:14:34.517

我写了几个方法来帮助解决这个问题。只需传入 Calendar.VisibleDate：

```
public static DateTime GetFirstDateOfMonth(DateTime date)
{
    return new DateTime(date.Year, date.Month, 1);
}

public static DateTime GetFirstDisplayedDate(DateTime date)
{
    date = GetFirstDateOfMonth(date);
    return date.DayOfWeek == DayOfWeek.Sunday ? date.AddDays(-7) : date.AddDays((int)date.DayOfWeek * -1);
}

public static List<DateTime> GetDisplayedDates(DateTime date)
{
    date = GetFirstDisplayedDate(date);

    List<DateTime> dates = new List<DateTime>();
    for (int i = 0; i < 42; i++)
    {
        dates.Add(date.AddDays(i));
    }

    return dates;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-18T18:56:14.577

米切尔，工作完美，谢谢。以公共变量 bool m_FirstDay = false 开始

在 day_render 函数中

```
if(m_FirstDay == false)
{
    DateTime firstDate;
    DateTime lastDate;

    firstDate = e.Day.Date;
    lastDate = firstDate.AddDays(41);

    m_FirstDay = true;
} 
```

然后我有了 asp.net 日历控件的可见日期范围。再次感谢。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-10-22T16:37:23.087

我自己一直在研究这个，并被定向到这里。我个人很想选择选项二，因为替代方案很混乱。Ronnie 的版本很好，但遗憾的是没有考虑不同 FirstDayOfWeeks 的文化。

使用 Reflector，我们可以看到它是如何在内部完成的：

```
 ...
    DateTime visibleDate = this.EffectiveVisibleDate();
    DateTime firstDay = this.FirstCalendarDay(visibleDate);
    ...

private System.Globalization.Calendar threadCalendar = 
    DateTimeFormatInfo.CurrentInfo.Calendar;

private DateTime EffectiveVisibleDate()
{
    DateTime visibleDate = this.VisibleDate;
    if (visibleDate.Equals(DateTime.MinValue))
    {
        visibleDate = this.TodaysDate;
    }
    if (this.IsMinSupportedYearMonth(visibleDate))
    {
        return this.minSupportedDate;
    }
    return this.threadCalendar.AddDays(visibleDate, 
        -(this.threadCalendar.GetDayOfMonth(visibleDate) - 1));
}

private DateTime FirstCalendarDay(DateTime visibleDate)
{
    DateTime date = visibleDate;
    if (this.IsMinSupportedYearMonth(date))
    {
        return date;
    }
    int num = ((int) 
       this.threadCalendar.GetDayOfWeek(date)) - this.NumericFirstDayOfWeek();
    if (num <= 0)
    {
        num += 7;
    }
    return this.threadCalendar.AddDays(date, -num);
}

private int NumericFirstDayOfWeek()
{
    if (this.FirstDayOfWeek != FirstDayOfWeek.Default)
    {
        return (int) this.FirstDayOfWeek;
    }
    return (int) DateTimeFormatInfo.CurrentInfo.FirstDayOfWeek;
}

private bool IsMinSupportedYearMonth(DateTime date)
{
    return this.IsTheSameYearMonth(this.minSupportedDate, date);
}

private bool IsTheSameYearMonth(DateTime date1, DateTime date2)
{
    return (((this.threadCalendar.GetEra(date1) == 
                   this.threadCalendar.GetEra(date2)) &&
          (this.threadCalendar.GetYear(date1) == 
                   this.threadCalendar.GetYear(date2))) &&
          (this.threadCalendar.GetMonth(date1) ==
                   this.threadCalendar.GetMonth(date2)));
} 
```

可悲的是，该功能已经存在，我们只是无法获得它！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-05-27T20:41:00.697

看到这个。

[如何删除日历的最后一周](https://stackoverflow.com/questions/2514065/how-to-remove-the-last-week-of-a-calendar/6145946#6145946)

# c++ - C++ 映射访问丢弃限定符 (const)

> ID：262853
> 
> 赞同：127
> 
> 时间：2008-11-04T18:29:43.540
> 
> 标签：c++, stl, constants, maps

下面的代码表明，将 map as 传递给`const`方法`operator[]`会丢弃限定符：

```
#include <iostream>
#include <map>
#include <string>

using namespace std;

class MapWrapper {
public:
    const int &get_value(const int &key) const {
        return _map[key];
    }

private:
    map<int, int> _map;
};

int main() {
    MapWrapper mw;
    cout << mw.get_value(42) << endl;
    return 0;
} 
```

这是因为地图访问时可能发生的分配吗？不能将具有映射访问权限的函数声明为 const 吗？

```
MapWrapper.cpp:10: error: passing const std::map<int, int, std::less<int>,
std::allocator<std::pair<const int, int> > > as this argument of 
_Tp& std::map<_Key, _Tp, _Compare, _Alloc>::operator[](const _Key&) 
[with _Key = int, _Tp = int, _Compare = std::less<int>, 
_Alloc = std::allocator<std::pair<const int, int> >] discards qualifiers 
```

* * *

## 回答 #1

> 赞同：173
> 
> 时间：2008-11-04T18:37:03.777

[`std::map`'s`operator []`未声明为`const`，并且不能归因于其行为：](http://en.cppreference.com/w/cpp/container/map/operator_at)

> T& 运算符[] (const Key& 键)
> 
> 返回对映射到与 key 等效的 key 的 value 的引用，如果这样的 key 不存在，则执行插入。

结果，您的函数无法声明`const`，并使用地图的`operator[]`.

[`std::map`的`find()`](http://en.cppreference.com/w/cpp/container/map/find)功能允许您在不修改地图的情况下查找密钥。

[`find()`](http://en.cppreference.com/w/cpp/container/map/find)返回一个`iterator`, or`const_iterator`到一个[`std::pair`](http://en.cppreference.com/w/cpp/utility/pair)同时包含键 ( `.first`) 和值 ( `.second`) 的值。

在 C++11 中，您还可以使用[`at()`](http://en.cppreference.com/w/cpp/container/map/at)for `std::map`。如果 element 不存在，则该函数将引发`std::out_of_range`异常，与`operator []`.

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2014-01-23T22:28:02.950

由于[`operator[]`](http://www.cplusplus.com/reference/map/map/operator%5b%5d/)没有 const 限定的重载，它不能安全地用于 const 限定的函数。这可能是因为当前的重载是为了返回和设置键值而构建的。

相反，您可以使用：

```
VALUE = map.find(KEY)->second; 
```

或者，在 C++11 中，您可以使用[`at()`](http://www.cplusplus.com/reference/map/map/at/)运算符：

```
VALUE = map.at(KEY); 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-11-04T18:33:25.357

您不能`operator[]`在地图上使用，`const`因为该方法`const`不允许您修改地图（您可以分配给`_map[key]`）。尝试改用该`find`方法。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-11-04T19:00:44.273

一些较新版本的 GCC 标头（我的机器上的 4.1 和 4.2）具有非标准成员函数 map::at() ，它们被声明为 const 并在键不在映射中时抛出 std::out_of_range 。

```
const mapped_type& at(const key_type& __k) const 
```

从函数注释中的引用来看，这似乎已被建议为标准库中的新成员函数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-19T13:45:49.610

首先，您不应该使用以 _ 开头的符号，因为它们是保留给语言实现/编译器编写者的。_map 很容易成为某人编译器上的语法错误，除了你自己，你没有人可以责备。

如果要使用下划线，请将其放在末尾，而不是开头。您可能犯了这个错误，因为您看到一些 Microsoft 代码这样做。请记住，他们编写了自己的编译器，因此他们可能能够摆脱它。即便如此，这也是个坏主意。

运算符 [] 不仅返回一个引用，它实际上在映射中创建条目。所以你不只是得到一个映射，如果没有，你正在创建一个。那不是你想要的。

# nlp - 谁能给我指出一个很好的“英语”打印规则的例子

> ID：262862
> 
> 赞同：2
> 
> 时间：2008-11-04T18:33:04.657
> 
> 标签：nlp, pretty-print, rule-engine

我有一个用户使用规则引擎构建的等价物。但是在显示规则列表时，我希望能够将每个规则“漂亮地打印”成看起来不错的东西**。在内部，当表示为字符串时，它们看起来像 s 表达式，所以想象一下：

```
(and (contains "foo" "foobar") (equals 4 (plus 2 2 ))) 
```

任何人都可以指出一个以可读方式很好地显示规则的程序吗？

** 也需要本地化，但我想我们会把它留作额外的功劳。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T19:14:54.400

也许可以查看正在开发 Attempto Controlled English (ACE) 的[Attempto 项目](http://attempto.ifi.uzh.ch)。ACE 允许您用英语的子集编写规则。例如：

```
If "foo" contains "foobar" and "foobar" does not contain "foo" then 4 = 2 + 2. 
```

ACE 解析器将此类规则转换为称为话语表示结构 (DRS) 的逻辑形式。对于上面的示例，它看起来像这样：

```
[]
   [A]
   predicate(A, contain, string(foo), string(foobar))-1
      NOT
      [B]
      predicate(B, contain, string(foobar), string(foo))-1
   =>
   []
   formula(int(4), =, expr(+, int(2), int(2)))-1 
```

有一个称为 DRS 语言生成器的工具可以将 DRS 转换为 ACE。对于上述 DRS，您将获得：

```
If "foo" contains "foobar" and it is false that "foobar" contains "foo" then 4 = ( 2 + 2 ). 
```

在您的情况下，您必须将您的规则表示形式转换为 DRS（这应该非常简单），然后您可以直接使用 DRS 语言器。上述工具[在 LGPL 许可下可用](http://attempto.ifi.uzh.ch/site/downloads/)。

# java - 为什么 HttpServletRequest.getRemoteAddr() 在 Java servlet 中不起作用？

> ID：262887
> 
> 赞同：6
> 
> 时间：2008-11-04T18:43:25.090
> 
> 标签：java, html, servlets

我正在使用 java servlet 开发一个 web 应用程序，我希望通过`request.getRemoteAddr()`从内部调用来获取用户 ip 信息`processRequest(HttpServletRequest request,HttpServletResponse response)`。

但它返回一个错误的IP。由于我对这个领域不是很了解，我不知道它在显示什么，也许是代理，我得到了这个：

```
远程地址：127.0.0.1
远程主机：127.0.0.1
x-forwarded-for : null

```

127.0.0.1 不是我的 IP。

然而，当我去：`http://www.javascriptkit.com/script/script2/displayip.shtml`它会显示正确的，因为我使用的是 servlet，我没有动态生成的 html 页面的 .shtml，我该怎么办？以及为什么该站点上的脚本可以正确显示而`request.getRemoteAddr()`不能正确显示？

感谢所有答案，我现在有一个线索，将其部署到服务器后，它可以按预期工作。显示正确的地址。

但是即使我在本地机器上开发它，如何让它显示绝对 IP 就好像它在真实服务器上运行一样？或者可行吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-04T18:49:15.093

它显示的是什么 IP 地址？我的猜测是有一些代理或改变的东西。（例如，那个脚本页面显示了我的 ADSL 路由器的 IP 地址——而不是我局域网中的那个——原因很明显。）

编辑：现在您已经证明您看到的 IP 地址是 127.0.0.1，答案很清楚 - 您看到的是环回适配器（即同一台机器的快捷方式）大概是因为您正在测试您正在开发的同一台机器。答案是完全正确的。

在不同的机器上尝试它，你会得到一个更有用的 IP 地址。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-04T18:53:44.817

通过调用 request.getHeader("X-Forwarded-For") 检查 X-Forwarded-For 标头并查看它返回的 IP。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-04T19:08:50.060

您显示的返回 IP 是本地主机 IP。这就提出了一个问题——您在哪里进行测试，以及您如何访问 servlet 进行测试？

如果您在本地（开发）机器上运行 servlet，并且还从同一台机器上的浏览器调用它，那么这个输出是绝对正确的。

干杯，

-R

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-04T22:00:58.963

如果你使用[http://localhost:8080/servlet](http://localhost:8080/servlet)调用你的servlet ，你通常会得到“localhost”作为远程地址。如果您使用您的机器的名称，即[http://yourmachine/servlet](http://yourmachine/servlet)，您通常会得到“正确”的地址。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-04T19:09:32.057

您正在本地计算机上运行测试服务器并在[http://localhost/](http://localhost/)上连接到它。由于您在本地接口上进行连接，因此连接源也是 localhost，即 127.0.0.1。

# php - 有没有办法找出 PHP 数组的“深度”？

> ID：262891
> 
> 赞同：59
> 
> 时间：2008-11-04T18:44:37.363
> 
> 标签：php, arrays, associative-array

PHP 数组的元素可以有数组。这些数组可以有数组等等。有没有办法找出 PHP 数组中存在的最大嵌套？一个例子是一个函数，如果初始数组没有数组作为元素，则返回 1，如果至少一个元素是数组，则返回 2，依此类推。

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2008-11-04T21:58:21.637

这是避免 Kent Fredric 指出的问题的另一种选择。它赋予[print_r()](http://php.net/print_r)检查无限递归的任务（它做得很好）并使用输出中的缩进来查找数组的深度。

```
function array_depth($array) {
    $max_indentation = 1;

    $array_str = print_r($array, true);
    $lines = explode("\n", $array_str);

    foreach ($lines as $line) {
        $indentation = (strlen($line) - strlen(ltrim($line))) / 4;

        if ($indentation > $max_indentation) {
            $max_indentation = $indentation;
        }
    }

    return ceil(($max_indentation - 1) / 2) + 1;
} 
```

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2008-11-04T18:54:35.487

这应该这样做：

```
<?php

function array_depth(array $array) {
    $max_depth = 1;

    foreach ($array as $value) {
        if (is_array($value)) {
            $depth = array_depth($value) + 1;

            if ($depth > $max_depth) {
                $max_depth = $depth;
            }
        }
    }

    return $max_depth;
}

?> 
```

编辑：非常快速地对其进行了测试，并且似乎可以正常工作。

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2008-11-04T19:09:25.193

**请注意**仅以递归方式执行的示例。

Php 可以创建具有对该数组中其他位置的引用的数组，并且可以包含具有同样递归引用的对象，并且在这种情况下，任何纯递归算法都可以被认为是一种*危险*的幼稚算法，因为它会溢出堆栈深度递归，并且永远不会终止。

（好吧，当它超过堆栈深度时它将终止，此时您的程序将致命地终止，而不是我认为您想要的）

过去，我尝试过序列化 -> 用字符串替换引用标记 -> 根据我的需要反序列化，（通常调试带有大量递归引用的回溯），这似乎工作正常，你到处都有漏洞，但它适用于该任务.

对于您的任务，如果您发现您的数组/结构中出现了递归引用，您可能需要在此处查看用户提供的评论：http: [//php.net/manual/en/language.references.spot .php](http://php.net/manual/en/language.references.spot.php)

然后以某种方式找到一种方法来计算递归路径的深度。

你可能需要拿出你关于算法的 CS 书籍并找到这些婴儿：

*   [Wiki:深度限制搜索](http://en.wikipedia.org/wiki/Depth-limited_search)
*   [Wiki:深度优先搜索](http://en.wikipedia.org/wiki/Depth-first_search)

（抱歉这么简短，但深入研究图论有点不适合这种格式；））

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2013-09-26T19:17:03.527

嗨，这是另一种解决方案。

```
/*** IN mixed (any value),OUT (string)maxDepth ***/
/*** Retorna la profundidad maxima de un array ***/
function getArrayMaxDepth($input){
    if( ! canVarLoop($input) ) { return "0"; }
    $arrayiter = new RecursiveArrayIterator($input);
    $iteriter = new RecursiveIteratorIterator($arrayiter);
    foreach ($iteriter as $value) {
            //getDepth() start is 0, I use 0 for not iterable values
            $d = $iteriter->getDepth() + 1;
            $result[] = "$d";
    }
    return max( $result );
}
/*** IN mixed (any value),OUT (bool)true/false, CHECK if can be used by foreach ***/
/*** Revisa si puede ser iterado con foreach ***/
function canVarLoop($input) {
    return (is_array($input) || $input instanceof Traversable) ? true : false;
} 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2016-11-21T17:26:59.663

在这里获得一点灵感并在 PHP 文档中找到这个[***RecursiveIteratorIterator***](http://php.net/manual/en/class.recursiveiteratoriterator.php)之后，我来到了这个解决方案。

你应该使用这个，非常整洁：

```
function getArrayDepth($array) {
    $depth = 0;
    $iteIte = new RecursiveIteratorIterator(new RecursiveArrayIterator($array));

    foreach ($iteIte as $ite) {
        $d = $iteIte->getDepth();
        $depth = $d > $depth ? $d : $depth;
    }

    return $depth;
} 
```

适用于 PHP5 和 PHP7，希望这会有所帮助。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2010-10-10T08:13:25.923

当我注意到这篇文章时，我刚刚找到了这个问题的答案。这是我的解决方案。我还没有在大量不同的数组大小上尝试过这个，但它比 2008 年我使用的数据的答案要快，大约 30 件深度 > 4。

```
function deepness(array $arr){
    $exploded = explode(',', json_encode($arr, JSON_FORCE_OBJECT)."\n\n");
    $longest = 0;
    foreach($exploded as $row){
        $longest = (substr_count($row, ':')>$longest)?
            substr_count($row, ':'):$longest;
    }
    return $longest;
} 
```

**警告**：这不处理*任何*边缘情况。如果您需要一个强大的解决方案，请查看其他地方，但对于简单的情况，我发现这非常快。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-04-13T12:48:33.627

这是我对 jeremy Ruten 函数稍作修改的版本

```
// you never know if a future version of PHP will have this in core
if (!function_exists('array_depth')) {
function array_depth($array) {
    // some functions that usually return an array occasionally return false
    if (!is_array($array)) {
        return 0;
    }

    $max_indentation = 1;
    // PHP_EOL in case we're running on Windows
    $lines = explode(PHP_EOL, print_r($array, true));

    foreach ($lines as $line) {
        $indentation = (strlen($line) - strlen(ltrim($line))) / 4;
        $max_indentation = max($max_indentation, $indentation);
    }
    return ceil(($max_indentation - 1) / 2) + 1;
}
} 
```

诸如此类的事情`print array_depth($GLOBALS)`不会由于递归而出错，但您可能无法获得预期的结果。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-10-28T11:08:41.810

Jeremy Ruten 对函数的另一个（更好的）修改：

```
function array_depth($array, $childrenkey = "_no_children_")
{
    if (!empty($array[$childrenkey]))
    {
        $array = $array[$childrenkey];
    }

    $max_depth = 1;

    foreach ($array as $value)
    {
        if (is_array($value))
        {
            $depth = array_depth($value, $childrenkey) + 1;

            if ($depth > $max_depth)
            {
                $max_depth = $depth;
            }
        }
    }

    return $max_depth;
} 
```

为**$childrenkey**添加*一个默认值*允许该函数适用于没有子元素键的简单数组，即它适用于简单的多维数组。

 **现在可以使用以下方法调用此函数：

```
$my_array_depth = array_depth($my_array, 'the_key_name_storing_child_elements'); 
```

或者

```
$my_array_depth = array_depth($my_array); 
```

当**$my_array**没有任何特定的键来存储其子元素时。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-02-20T10:27:48.287

```
function createDeepArray(){
    static $depth;
    $depth++;
    $a = array();
    if($depth <= 10000){
        $a[] = createDeepArray();
    }
    return $a;
}
$deepArray = createDeepArray();

function deepness(array $arr){
    $exploded = explode(',', json_encode($arr, JSON_FORCE_OBJECT)."\n\n");
    $longest = 0;
    foreach($exploded as $row){
    $longest = (substr_count($row, ':')>$longest)?
        substr_count($row, ':'):$longest;
    }
    return $longest;
}

function array_depth($arr)
{
    if (!is_array($arr)) { return 0; }
    $arr = json_encode($arr);

    $varsum = 0; $depth  = 0;
    for ($i=0;$i<strlen($arr);$i++)
    {
    $varsum += intval($arr[$i] == '[') - intval($arr[$i] == ']');
    if ($varsum > $depth) { $depth = $varsum; }
    }

    return $depth;
}

echo 'deepness():', "\n";

$start_time = microtime(TRUE);
$start_memory = memory_get_usage();
var_dump(deepness($deepArray));
$end_time = microtime(TRUE);
$end_memory = memory_get_usage();
echo 'Memory: ', ($end_memory - $start_memory), "\n";
echo 'Time: ', ($end_time - $start_time), "\n";

echo "\n";
echo 'array_depth():', "\n";

$start_time = microtime(TRUE);
$start_memory = memory_get_usage();
var_dump(array_depth($deepArray));
$end_time = microtime(TRUE);
$end_memory = memory_get_usage();
echo 'Memory: ', ($end_memory - $start_memory), "\n";
echo 'Time: ', ($end_time - $start_time), "\n"; 
```

Josh 提出的功能肯定更快：

```
$ for i in `seq 1 10`; do php test.php; echo '-------------------------';done
deepness():
int(10000)
Memory: 164
Time: 0.0079939365386963

array_depth():
int(10001)
Memory: 0
Time: 0.043087005615234
-------------------------
deepness():
int(10000)
Memory: 164
Time: 0.0076408386230469

array_depth():
int(10001)
Memory: 0
Time: 0.042832851409912
-------------------------
deepness():
int(10000)
Memory: 164
Time: 0.0080249309539795

array_depth():
int(10001)
Memory: 0
Time: 0.042320966720581
-------------------------
deepness():
int(10000)
Memory: 164
Time: 0.0076301097869873

array_depth():
int(10001)
Memory: 0
Time: 0.041887998580933
-------------------------
deepness():
int(10000)
Memory: 164
Time: 0.0079131126403809

array_depth():
int(10001)
Memory: 0
Time: 0.04217004776001
-------------------------
deepness():
int(10000)
Memory: 164
Time: 0.0078539848327637

array_depth():
int(10001)
Memory: 0
Time: 0.04179310798645
-------------------------
deepness():
int(10000)
Memory: 164
Time: 0.0080208778381348

array_depth():
int(10001)
Memory: 0
Time: 0.04272198677063
-------------------------
deepness():
int(10000)
Memory: 164
Time: 0.0077919960021973

array_depth():
int(10001)
Memory: 0
Time: 0.041619062423706
-------------------------
deepness():
int(10000)
Memory: 164
Time: 0.0080950260162354

array_depth():
int(10001)
Memory: 0
Time: 0.042663097381592
-------------------------
deepness():
int(10000)
Memory: 164
Time: 0.0076849460601807

array_depth():
int(10001)
Memory: 0
Time: 0.042278051376343 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-10-28T08:39:50.997

一个古老的问题，但仍然与这个日期相关。:)

不妨对 Jeremy Ruten 的答案做一个小的修改。

```
function array_depth($array, $childrenkey)
{
    $max_depth = 1;

    if (!empty($array[$childrenkey]))
    {
        foreach ($array[$childrenkey] as $value)
        {
            if (is_array($value))
            {
                $depth = array_depth($value, $childrenkey) + 1;

                if ($depth > $max_depth)
                {
                    $max_depth = $depth;
                }
            }
        }
    }

    return $max_depth;
} 
```

我添加了第二个名为**$childrenkey**的参数，因为我将子元素存储在特定键中。

函数调用的一个例子是：

```
$my_array_depth = array_depth($my_array, 'the_key_name_storing_child_elements'); 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2016-10-03T21:37:20.147

这个对我来说似乎很好用

```
<?php
function array_depth(array $array)
{
    $depth = 1;
    foreach ($array as $value) {
        if (is_array($value)) {
            $depth += array_depth($value);
            break;
        }
    }

    return $depth;
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-04T18:48:18.760

我认为没有内置任何东西。一个简单的递归函数可以很容易地找到。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2010-09-09T01:16:16.843

```
// very simple and clean approach        
function array_depth($a) {
          static $depth = 0;
          if(!is_array($a)) {
            return $depth;
          }else{
            $depth++;
            array_map("array_depth", $a);
            return $depth;
          }
        }
print "depth:" . array_depth(array('k9' => 'dog')); // return 1 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-10-11T19:01:12.773

我相信 Kent Frederic 强调的问题是至关重要的。yjerem 和 Asim 提出的答案很容易受到这个问题的影响。

yjerem 再次建议的缩进方法和 dave1010 对我来说不够稳定，因为它依赖于 print_r 函数表示缩进的空格数。它可能随时间/服务器/平台而变化。

JoshN 建议的方法可能是正确的，但我认为我的方法更快：

```
function array_depth($arr)
{
    if (!is_array($arr)) { return 0; }
    $arr = json_encode($arr);

    $varsum = 0; $depth  = 0;
    for ($i=0;$i<strlen($arr);$i++)
    {
        $varsum += intval($arr[$i] == '[') - intval($arr[$i] == ']');
        if ($varsum > $depth) { $depth = $varsum; }
    }

    return $depth;
} 
```

如果您进行任何比较不同方法的测试，请发布消息。Ĵ

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2011-12-07T17:48:49.683

我相信您忘记过滤“[”和“]”或“，”和“：”以及数组键和值的数据类型。这是您的 array_depth 的更新以及额外的 array_sort_by_depth。

```
function array_depth($arr){
if (is_array($arr)) {
    array_walk($arr, 
        function($val, $key) use(&$arr) {
            if ((! is_string($val)) && (! is_array($val))) {
                $val = json_encode($val, JSON_FORCE_OBJECT);
            }

            if (is_string($val)) {
                $arr[$key] = preg_replace('/[:,]+/', '', $val);
            }
        }
    );

    $json_strings = explode(',', json_encode($arr, JSON_FORCE_OBJECT));

    $max_depth = 0;

    foreach ($json_strings as $json_string){
        var_dump($json_string); echo "<br/>";
        $json_string = preg_replace('/[^:]{1}/', '', $json_string);
        var_dump($json_string); echo "<br/><br/>";
        $depth = strlen($json_string);

        if ($depth > $max_depth) {
            $max_depth = $depth;
        }
    }

            return $max_depth;
    }

    return FALSE;
    }

    function array_sort_by_depth(&$arr_val, $reverse = FALSE) {

  if ( is_array($arr_val)) { 
    $temp_arr = array();
            $result_arr = array();

            foreach ($arr_val as $key => $val) {
                $temp_arr[$key] = array_depth($val);
            }

        if (is_bool($reverse) && $reverse == TRUE) {
                arsort($temp_arr);
            }
            else {
                asort($temp_arr);
            }

            foreach ($temp_arr as $key => $val) {
                $result_arr[$key] = $arr_val[$key];
            }

            $arr_val = $result_arr;

    return TRUE;
     }

     return FALSE;
  } 
```

随意改进代码：D！

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2012-06-01T23:46:33.597

我认为这将解决递归问题，并且还可以在不依赖其他 php 函数（如 serialize 或 print_r ）的情况下提供深度（这充其量是有风险的，并且可能导致棘手的错误）：

```
function array_depth(&$array) {
    $max_depth = 1;
    $array['__compute_array_depth_flag_ZXCNADJHHDKAQP'] = 1;

    foreach ($array as $value) {
        if (is_array($value) &&
                    !isset($value['__compute_array_depth_flag_ZXCNADJHHDKAQP']))  {
            $depth = array_depth($value) + 1;

            if ($depth > $max_depth) {
                $max_depth = $depth;
            }
        }
    }
    unset($array['__compute_array_depth_flag_ZXCNADJHHDKAQP']);

    return $max_depth;
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2018-07-14T10:45:13.777

我会使用以下代码：

```
function maxDepth($array) {
    $iterator = new \RecursiveIteratorIterator(new \RecursiveArrayIterator($array), \RecursiveIteratorIterator::CHILD_FIRST);
    $iterator->rewind();
    $maxDepth = 0;
    foreach ($iterator as $k => $v) {
        $depth = $iterator->getDepth();
        if ($depth > $maxDepth) {
            $maxDepth = $depth;
        }
    }
    return $maxDepth;
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2020-01-30T21:18:28.187

```
//Get the dimension or depth of an array
function array_depth($arr)
{
    if (!is_array($arr)) return 0;
    if (empty($arr))     return 1;
    return max(array_map(__FUNCTION__,$arr))+1;
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-07-30T17:49:28.650

在我的解决方案中，我评估 ARRAY() 的维度，而不是内容/值：

```
function Dim_Ar($A, $i){
    if(!is_array($A))return 0;
    $t[] = 1;
    foreach($A AS $e)if(is_array($e))$t[] = Dim_Ar($e, ++ $i) + 1;
    return max($t);
    }

$Q = ARRAY();                                                                               // dimension one
$Q = ARRAY(1);                                                                          // dimension one
$Q = ARRAY(ARRAY(ARRAY()), ARRAY(1, 1, 1));                 // dimension is two
$Q = ARRAY(ARRAY());                                                                // dimension is two
$Q = ARRAY(1, 1, 1, ARRAY(), ARRAY(), ARRAY(1));        // dimension is two
$Q = ARRAY(1, 2, 3, ARRAY(ARRAY(1, 1, 1)));                 // dimension is two
$Q = ARRAY(ARRAY(ARRAY()), ARRAY());                                // dimension is three
$Q = ARRAY(ARRAY(ARRAY()), ARRAY());                                // dimension three
$Q = ARRAY(ARRAY(ARRAY()), ARRAY(ARRAY()));                 // dimension is three
$Q = ARRAY('1', '2', '3', ARRAY('Q', 'W'), ARRAY('Q', 'W'), ARRAY('Q', 'W'), ARRAY('Q', 'W'), 'pol, y juan', 'sam, y som', '1', '2', 'OPTIONS1' => ARRAY('1', '2', '9'), 'OOO' => ARRAY('1', '2', '9'), 'OPTIONS3' => ARRAY('1', '2', '9', '1', '2', '9', '1', '2', '9', '1', '2', '9', '1', '2', '9'), '3', ARRAY('Q', 'W'), 'OPTIONS2' => ARRAY('1', '2'));
$Q = ARRAY('1', '2', '3', '', ARRAY('Q, sam', 'W', '', '0'), 'ppppppol, y juan', 'sam, y som', '1', '2', 'OPTIONS1' => ARRAY('1', '2', 'ss, zz'), '3', 'PP' => ARRAY('Q', 'WWW', 'Q', 'BMW'), ARRAY('Q', 'YYWW'), 'OPTIONS2' => ARRAY('1', '2', '9'), ARRAY('1', '2', '3'), '33', '33', '33', ARRAY('1', '2', '3', ARRAY(1, 2)));

echo Dim_Ar($Q, 0); 
```

对我来说是速度和低复杂度

* * *

## 回答 #20

> 赞同：-3
> 
> 时间：2012-06-22T20:57:05.900

更快的方法：

```
max(array_map('count', $array)); 
```

# delphi - 您遵循哪些 Delphi 编码标准文档？

> ID：262892
> 
> 赞同：21
> 
> 时间：2008-11-04T18:44:56.707
> 
> 标签：delphi, naming-conventions, coding-style

**您遵循哪些 Delphi 编码标准文档？**

我们公司正在考虑制定一些更好的编码标准，以提高我们代码的可读性、可审查性和可维护性。我们遇到了 CodeGear 的“Object Pascal 样式指南”，但很长一段时间都没有接触过它，我想很多人已经对本地进行了一些改进或添加。我遇到了一些已发布的变体和其他文档，我将在下面列出。

注意：我*不想*开始一场风格大战。我只是想知道你遵循什么标准，以及为什么。

谢谢。

* * *

**更新：** 嗯，“JCL Delphi 语言风格指南”似乎是明显的赢家！谢谢！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-11-04T18:47:05.097

**项目 JEDI Delphi 语言风格指南与 JCL 添加**

（CodeGear 的“Object Pascal Style Guide”的扩展）

[https://wiki.delphi-jedi.org/wiki/Project_JEDI_Delphi_Language_Style_Guide](https://wiki.delphi-jedi.org/wiki/Project_JEDI_Delphi_Language_Style_Guide)

（感谢 Jeroen Pluimers 和 AmigoJack 报告旧链接已经失效。如果这个最新链接也失效了，[这里是它的 Internet 存档链接](http://web.archive.org/web/*/https://wiki.delphi-jedi.org/wiki/Project_JEDI_Delphi_Language_Style_Guide)，很好。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-04T18:45:15.473

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-04T18:48:19.260

**Econos – 编码标准文档**

（副标题为“Delphi 4 开发人员指南编码标准文档”。）

[http://www.econos.de/delphi/cs.html](http://www.econos.de/delphi/cs.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-04T18:49:26.170

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-04T19:32:36.860

只要你选择一个并坚持下去，这真的没关系。编码标准就像方言，只要团队中的每个人都说同一种方言，就可以了。

也就是说，为什么不选择与您的运行时库 (VCL) 和文档使用相同的标准呢？然后你们都会说同一种方言，阅读运行时库代码会更容易。并且有大量的代码示例来说明编码约定。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-04T22:41:59.943

可能存在过度设计编码标准的趋势，以至于它们妨碍了编写代码。

我同意乔兹的评论。您可以查看所有推荐的标准，选择一个并将其强加给您的编码人员，或者您可以让您的团队参与该过程。

根据我的经验，让团队参与的最佳方式是让团队提出想法和采用的好处。你现有的才能是你最好的资源。同样，如果你强迫他们走他们不接受的道路，他们可能会成为你的终极敌人。

因此，请查看您现有的编码变体，并让团队一起就以下方面进行一些充满活力的讨论：

*   采用编码标准的原因。
*   标准化的基本考虑。
*   暴露团队中围绕此问题的任何不安全感。
*   找到一个共识点。什么重要，什么不重要。
*   建立一些公司目标，让每个人都觉得他们正在朝着一个共同的目标努力。
*   让团队将标准化的好处推销给自己。

最重要的目标必须是建立一个最适合您的团队和公司的“标准”。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-04T22:56:43.017

由于一些愚蠢的历史原因，我工作的编码标准是在 delphi 和 sql 中将所有关键字都设为大写。感谢上帝的大写锁定。

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2008-11-04T18:49:00.273

**CodeGear 的“匈牙利花生酱”，用于命名标识符**

[http://dn.codegear.com/article/27983](http://dn.codegear.com/article/27983)

# asp.net - 允许在 ASP.NET 中上传文件时如何显示预览图像？

> ID：262897
> 
> 赞同：0
> 
> 时间：2008-11-04T18:45:51.463
> 
> 标签：asp.net

这是我想要的功能：

用户从他们的机器中选择一张图片，点击一个上传按钮（或者更好的是下面的文件输入的 onchange 事件触发），并且能够看到他们即将上传的图片的预览。

这是我正在使用的当前工作流程，但它似乎不是最理想的：

我有一个图像控件、一个文件输入控件和一个提交按钮控件。单击提交按钮时，代码隐藏处理 OnClick 事件并从文件输入元素加载图像。然后它将它存储到 Web 服务器上的一个临时文件夹中，并将图像控件的 ImageUrl 设置为指向它。

这行得通，但导致我不得不做很多清洁工作来清理这些临时图像。是否有更清洁的工作流程来执行此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T19:26:26.063

如果你有内存要烧：

*   在内存中缓存图像字节
*   将您的 ImageUrl 设置为具有某种缓存标识符的图像处理程序 (.ashx)
*   从缓存中提供图像字节
*   如果用户取消或离开，丢弃缓存的字节
*   如果用户接受，则将缓存的字节写入其最终目的地

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T18:48:57.120

您应该上传并重命名图像以匹配您当前记录的某种 ID。然后，当您上传新文件时，首先删除所有旧文件，所有这些都在代码隐藏中。

如果您只显示缩略图，则应在保存前尝试使用图像库调整图像大小。这将节省带宽和存储空间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T19:00:43.667

我假设您要解决的问题是让您的应用程序能够在用户提交该图像之前预览该图像。您当前的方法有很多优点，但一个缺点是如果用户在提交或放弃操作之前预览多个图像，则临时目录中的孤立图像文件。

我注意到几个流行的社交网站使用不同的方法。基本上，Java 小程序用于在用户本地机器上进行预览操作。上传到服务器的唯一文件是用户提交的文件。这种方法解决了您遇到的问题；但是，它引入了需要在本地计算机上安装 Java 并与 Web 浏览器集成的新问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T19:16:36.800

您可以创建一个小型可执行文件来删除该临时文件夹上的文件，并将其附加到计划任务中，以便清理您的临时文件夹。文件夹偶尔。但我不知道您是在专用服务器上托管还是在共享主机上托管，因为对于共享主机，这不起作用

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T19:48:49.293

> 并且能够看到他们即将上传的图像的预览
> 
> ...
> 
> 单击提交按钮时，代码隐藏处理 OnClick 事件并从文件输入元素加载图像。然后它将它存储到 Web 服务器上的一个临时文件夹中，并将图像控件的 ImageUrl 设置为指向它。

想象一下这段对话：

*   吉姆：我不知道我今天能不能开车上班。
*   鲍勃：你为什么不开车去上班？当你付钱时，你会知道你是否负担得起！
*   吉姆：太棒了！

您刚刚*上传了文件，向他们展示了**他们*即将上传的文件的预览...

如果您的用户通过快速连接上传小图像，这无疑会正常工作，但当有人尝试通过慢速连接上传 3 meg JPEG 时，然后想知道为什么他们的网页因选择文件而被锁定（他们甚至没有按提交记住，所以你已经“随机”有效地锁定了它们），你可能希望重新评估这是一个解决方案。

*要在上传之前*实际显示图像，您需要使用某种 flash 或 silverlight 对象（或者可能是 java 小程序），它们可以在用户本地磁盘上生成本地文件的缩略图，然后再将其发送到服务器。尽管这听起来很丑陋，但如果没有一些客户端插件，实际上是无法做到的。

# c++ - 用于 C/C++ 的可移植 zip 库（不是应用程序）

> ID：262899
> 
> 赞同：29
> 
> 时间：2008-11-04T18:45:56.457
> 
> 标签：c++, zip

我希望能够在多个版本的 Windows、Linux/Unix 和 MacOS 上从我的非 gui C/C++ 应用程序中压缩文件。

用户将使用 Eclipse + makefile 或 VisualStudio 使用此应用程序进行编译和运行。我不希望用户必须单独安装某些东西，或者让我的 makefile 安装可执行文件。

更喜欢开源。我已经在看“Zip 3.0”了……

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-02-17T22:31:27.877

看看[图书馆档案](http://www.libarchive.org/)。我花了很多时间寻找一个跨平台和 LGPL 许可的、界面方便的库。这是我见过的最好的。非常简单而强大的工具。最初是为类 Unix 系统设计的，但也[有 Windows 版本](http://gnuwin32.sourceforge.net/packages/libarchive.htm)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-02-18T00:34:01.343

我用 miniz 取得了很好的效果：[https ://code.google.com/p/miniz/](https://code.google.com/p/miniz/)

对于 c++ 中字符串的简单压缩，我也非常喜欢[Timo Bingmann 的解决方案](http://panthema.net/2007/0328-ZLibString.html)。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-06-04T13:14:08.753

I'd recommend ZipLib [https://bitbucket.org/wbenny/ziplib/wiki/Home](https://bitbucket.org/wbenny/ziplib/wiki/Home)

Personal reasons why I love this project:

*   **built around c++11 stl streams** (ex. decompresses into stl streams!)
*   lightweight (no dependencies other than zlib)
*   can be used on both windows & liunx

It took me a long time to find this project - hope this helps someone.

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-11-04T18:47:50.570

我们在这里使用了几次[zlib 。](http://www.zlib.net/)这是一个相当标准的库，在大多数主要语言中都有实现。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-03-30T14:27:38.990

这个怎么样：

[http://zziplib.sourceforge.net/](http://zziplib.sourceforge.net/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-05T13:02:42.687

[http://www.info-zip.org/UnZip.html](http://www.info-zip.org/UnZip.html)

高温高压

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-04T03:43:35.077

其他人提到了 zlib，它很好而且相当简单。

7 [-Zip (LZMA) SDK](http://7-zip.org/sdk.html)更复杂，但也有很好的压缩率。

**编辑：**虽然仍在开发中，随着发布过程和历史的推移，我现在会犹豫是否推荐这个。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-04T03:28:16.450

ZLIB - 世界上最便携的图书馆。开源，非常成熟和可靠。黄金标准。为什么要使用其他东西？

# java - 声明式 XML -> POJO 转换

> ID：262912
> 
> 赞同：4
> 
> 时间：2008-11-04T18:48:28.277
> 
> 标签：java, xml

我必须编写一个进程（在 Java 中），它会定期访问 URL，读取返回的 XML 文档，并将该数据保存到数据库中。我的应用程序会进一步使用这些数据，因此我将它们建模为 Hibernate 映射的 POJO。

我可以解析 XML，然后创建适当的 POJO，但我一直在寻找一种更简单的声明性方法。哪些库可以接受输入配置并从 XML 文档创建 POJO？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-04T19:07:05.557

另一种选择可能是[JiBX](http://jibx.sourceforge.net/)

另外，虽然您说您不想解析 XML，但 [XPath](http://java.sun.com/j2se/1.5.0/docs/api/javax/xml/xpath/package-summary.html)可以是一种非常简洁的方式来提取您感兴趣的内容吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-03T13:12:04.760

[JAXB](http://jaxb.java.net/ "XML 绑定的 Java 体系结构")可以基于 XML 模式自动创建类（假设您有一个用于 XML 源的类）。在运行时，它可以将 XML 文档转换为代表 XML 的 POJO。它是声明性的，您可以稍微调整模式到类的映射。

如果我正确理解您的任务，这几乎就是 JAXB 的用例设计（尽管它也可以做其他事情）。它是 Java 1.6（也可能是 1.5？）的一部分，在包中：javax.xml.bind.*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-04T18:56:43.143

您可以使用[XStream](http://xstream.codehaus.org/)反序列化 XML 并将其直接映射到 Hibernate 映射的 POJO。

干杯。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-07T09:10:13.013

使用 Hibernate，您可以直接将 XML 映射到表。这是实验性功能。在这里查看 [http://www.hibernate.org/hib_docs/v3/reference/en-US/html/xml.html](http://www.hibernate.org/hib_docs/v3/reference/en-US/html/xml.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-07-07T16:35:39.760

EclipseLink JAXB (MOXy) 具有将 JPA 实体映射到 XML 的扩展（JPA 实体具有嵌入式 ID 类、延迟加载和需要特殊处理的复合键关系等内容），我不知道有任何其他 OXM 解决方案可以做到这一点。

有关更多信息，请参阅：

*   [http://wiki.eclipse.org/EclipseLink/Examples/MOXy/JPA](http://wiki.eclipse.org/EclipseLink/Examples/MOXy/JPA)

# webforms - 在 Web 表单上突出显示必填字段的最佳方式是什么？

> ID：262922
> 
> 赞同：15
> 
> 时间：2008-11-04T18:50:46.417
> 
> 标签：webforms

我不觉得经常使用的“*”看起来很好看——谁能建议一个更好看的方法或给我举个例子？

我尝试按照一个人的建议使该字段以红色突出显示，但我不喜欢这种外观。

大胆的标签可能会奏效。

但我真的很喜欢在添加文本之前在字段中以灰色显示“必填”的想法。有人有这方面的代码吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-04T19:27:23.003

一般来说，最好的 web 表单是最简单的，需要我思考的最少。已经演变的“标准”是必填字段旁边有一个星号 (*)。有时星号是红色的，以帮助它突出一点。

为什么要打标准？不要让你的用户想太多。遵循标准，为更重要的事情保持创造力。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-04T18:54:31.743

如果您要使用颜色来突出显示该字段，请记住有些人是色盲的（因此也可以提供另一个指标）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-04T19:05:57.803

如果您使用样式表来格式化您的 HTML，那么您可以为`.mandatory`. 例如，将强制输入设置为使用此样式，然后您可以更轻松地使用它，直到您拥有适合您的整体设计的颜色、边框和其他样式元素的正确组合。

**HTML**

```
<input id="username" type="text" class="mandatory" /> 
```

**CSS**

```
.mandatory {
    color: red;
    font-size: 12pt;
    font-weight: bold;
    font-style: italic;
} 
```

我还使用星号作为“备份”提到的 OP。

-R

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-04T19:55:23.773

有时将字段标记为必填项和可选项确实是合理的。但是，在您这样做之前，您应该质疑向用户询问任何非强制性信息是否合理。这尤其适用于注册表。

在注册表等中，最好只询问最少的信息*。*注册后，用户可以随意在单独的表格中填写可选信息​​。

从表单中删除所有不必要的杂物后，您可能会发现没有必要将字段标记为必填项；要么一切都是强制性的，要么对于用户来说哪些字段是可选的可能非常明显，以至于不需要提供视觉提示。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-04T18:52:43.073

添加样式=“边框：细红色实心；” 到元素

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-04T19:00:11.497

我发现[LukeW.com](http://www.lukew.com/resources/articles/web_forms.html)上的答案是最有用的。因为这里没有简单的解决方案。这取决于必填字段的百分比、表单中有多少字段以及标签的长度。对于绝大多数网络，人们理解粗体是必需的，而正常重量是可选的（如果有任何选项是粗体的）。只有在表单验证失败后，我才会向用户显示突出显示的必需但跳过的输入框。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-04T18:52:53.370

我通常不反对在字段名称正下方或输入字段附近以较小的字体查看（必需）。

我还可以看到使用“文本框水印”让该字段在其中显示“必填”，直到他们将焦点带到该字段并开始输入。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-04T19:22:53.153

我喜欢在 ASP.NET Ajax Control Toolkit 中为[ValidatorCallout 控件](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/ValidatorCallout/ValidatorCallout.aspx)完成的方式：

[![替代文字](https://i.stack.imgur.com/aP9z0.png)](https://i.stack.imgur.com/aP9z0.png)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-04T19:19:06.920

可能想查看[www.PeterBlum.com](http://www.PeterBlum.com) - 他的专业验证包用于验证和格式化控件。他有使用教程和大量示例以及详细的手册。

# mysql - 如何将 MySql 表导出/转储到包含字段名称（又名标题或列名称）的文本文件中

> ID：262924
> 
> 赞同：17
> 
> 时间：2008-11-04T18:51:33.810
> 
> 标签：mysql, export, header, field

在 MySql 的解释器中，很容易将表格连同其字段名一起转储到屏幕上。

似乎没有简单的方法可以将表导出到制表符分隔或 CSV 输出文件，*包括*其列标题。

我正在尝试仅使用 SQL 或 Linux 命令行来执行此操作，而不用另一种语言编写程序。

谢谢

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-11-04T19:07:14.977

将查询通过管道传输到命令行客户端会输出一个制表符分隔的列表，其中列名作为第一行

```
$ echo "select * from surveys limit 5" | mysql -uroot -pGandalf surveys
phone   param1  param2  param3  param4  p0      p1      p2      p3      audio4  code    time
XXXXXXXXX       2008-07-02      11:17:23        XXXXXXXX        SAT     -       -       -       -       -       ERROR   2008-07-02 12:18:32
XXXXXXXXX       2008-07-02      11:22:52        XXXXXXXX        SAT     -       -       -       -       -       COLGADO 2008-07-02 12:04:29
XXXXXXXXX       2008-07-02      11:41:29        XXXXXXXX        SAT     -       -       -       -       -       COLGADO 2008-07-02 12:07:22
XXXXXXXXX       2008-07-02      12:16:19        XXXXXXXX        SAT     1       1       1       9       XXXXXXXXX_4.wav     OK      2008-07-02 16:14:27
XXXXXXXXX       2008-07-02      08:21:25        XXXXXXXX        SAT     1       1       1       1       XXXXXXXXX_4.wav     OK      2008-07-02 12:29:40 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-02T12:29:28.637

这个小脚本应该这样做：

-- 1\. 在这里选择表和输出文件/这应该是唯一的输入

```
select 'mytable' into @tableName;
select 'c://temp/test.csv' into @outputFile; 
```

-- 2\. 以适合查询的格式获取列名

```
select group_concat(concat("'",column_name, "'")) into @columnNames from information_schema.columns
where table_name=@tableName; 
```

-- 3\. 构建查询

```
SET @query = CONCAT(
"select * from
((SELECT ",@columnNames,")
UNION
(SELECT * FROM `",@tableName,"`)) as a
INTO OUTFILE '", @outputFile, "'"); 
```

-- 4\. 执行查询

```
PREPARE stmt FROM @query;
EXECUTE stmt; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-22T17:08:01.957

我以这种方式实现了这一点：

```
echo "select * from table"| mysql database -B -udbuser -puser_passwd | sed s/\\t/,/g > query_output.csv 
```

mysql 的 -B 选项以制表符分隔列，使用 sed 将其转换为逗号。请注意，标题也会生成。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-04T19:07:50.173

您可以使用[mysqldump](http://dev.mysql.com/doc/refman/5.0/en/mysqldump.html)命令执行此操作。查看 --tab 和 --xml 选项。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-23T20:17:59.713

我创建了一个过程，使用 .csv 文件自动将大量表的内容导出到 .csv 文件`SELECT ... INTO OUTFILE`。如果您有类似的需求，请参考以下内容

[http://lifeboysays.wordpress.com/2012/06/23/mysql-how-to-export-data-to-csv-with-column-headers/](http://lifeboysays.wordpress.com/2012/06/23/mysql-how-to-export-data-to-csv-with-column-headers/)。

它使用cafe876 描述的方法，但适用于一个或一系列表，另外您可以设置要使用的分隔符和引号字符。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-01-22T11:06:03.490

**我使用了上面的命令并根据我的要求进行了修改。
我需要从文本文件中的 wordpress mysql 数据库中获取密码列，为此我使用了以下命令**

```
echo "select user_pass from wp_users"| mysql -uroot -proot wp_database > passwordList.txt 
```

# http - 使用 HTTP POST 时在 URL 中传递参数

> ID：262925
> 
> 赞同：9
> 
> 时间：2008-11-04T18:51:39.050
> 
> 标签：http, iis, url, soap, post

使用 POST 方法时，是否允许通过 URL（问号后）向网页传递参数？我知道它可以工作（大多数时候，无论如何），因为我公司的 webapp 经常这样做，但我不知道它是否在标准中得到实际支持，或者我是否可以依赖这种行为。我正在考虑实现一个 SOAP 请求处理程序，它在问号后使用一个参数来指示它是一个 SOAP 请求而不是一个普通的 HTTP 请求。这样做的原因是 webapp 是一个 IIS 扩展，所以一切都通过相同的 URL 访问（例如：example.com/myisapi.dll?command），所以要处理 SOAP 请求，我需要指定“命令”参数。SOAP 会有一个通用命令，

基本上，我试图将 Apache Axis2/C 库集成到我的 webapp 中，方法是让 webapp 处理 HTTP 请求，然后将传入的 SOAP XML 传递给 Axis2 以进行处理（如果它是 SOAP 请求）。直观地说，我看不出有任何原因为什么这不起作用，因为您发布的 URL 只是一个任意 URL，就所有各种组件而言......它是赋予特殊含义的服务器问号后面的部分。

感谢您提供的任何帮助/见解。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-04T19:10:09.370

让我们从简单的东西开始。HTTP GET 请求变量来自 URI。URI 是一个被请求的资源，因此任何网络服务器*都应该*（和 apache 一样）将整个 URI 存储在一些变量中，这些变量可用于在网络服务器中运行的模块或应用服务器组件。

与 http GET 不同的 http POST 是对网络服务器的单独逻辑调用，但它仍然定义了应该处理该帖子的 URI。一个好的网络服务器（apache 就是其中之一）将再次使 URI 可用于在其中运行的任何模块或应用服务器，然后还将另外提供在 POST 标头中发送的变量。

在您的应用程序在 POST 期间从 apache 获得控制权时，您应该可以访问 GET 和 POST 变量，并且能够执行您希望执行的任何控制逻辑，包括使用 SOAP 协议而不是 HTML 进行回复。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-04T19:02:55.937

如果您询问是否可以在单个 HTTP 请求中同时通过 GET 和 POST 发送参数，那么答案是“是”。这是可以可靠地使用 AFAIK 的标准功能。

一个这样的示例是分两部分发送身份验证凭据，一个通过 GET，另一个通过 POST，因此任何劫持会话的尝试都需要劫持 GET 和 POST 变量。

因此，在您的情况下，您可以使用 POST 来包含实际的 SOAP 请求，但根据 GET 中传递的参数（或者换句话说，通过 URL）测试它是否是 SOAP 请求。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-04T19:26:03.363

我相信没有标准真正定义“HTTP参数”或“请求变量”的概念。RFC 1738 定义了一个 URL 可能有一个“搜索部分”，它是问号后面的子字符串。HTML 在表单提交协议中指定了处理 FORM 元素的浏览器应该如何提交它。在任何一种情况下，服务器端如何处理搜索部分和 HTTP 正文完全取决于服务器 - 丢弃两者将符合这两个规范（但相当无用）。

为了确定您是否可以将搜索部分发布到特定服务，您需要研究该服务的协议规范。如果服务实际上是通过 HTML 表单定义的，那么您不能混合使用 - 如果 FORM 指定 GET，您甚至不能使用 POST（反之亦然）。如果您发布到 Web 服务，您需要查看 Web 服务的 WSDL——这通常要求 POST；SOAP 消息中的所有数据。等等。

特定的 Web 框架可能有“请求变量”的概念——它们是否会从搜索部分和请求正文中提取这些变量，您需要在产品文档中找到。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-04T19:02:59.870

我在英国部署了一个带有 3（移动网络运营商）的 Web 应用程序。它最初使用 POST 参数，但 3 网关剥离了它们（以及 X-headers ！）。所以要小心...

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-04T19:06:23.403

允许吗？当然，这是可行的，但我倾向于规范建议双重方法不一定应该发生或得到支持。[RFC2616](https://www.rfc-editor.org/rfc/rfc2616)定义了 HTTP/1.1，我认为每个请求只建议一种方法。如果您从客户端考虑典型的 HTTP 事务，您也可以看到限制：

```
$ telnet localhost 80
POST /page.html?id=5 HTTP/1.1
host: localhost 
```

如您所见，您只能使用一种方法（POST/GET 等），但是由于各种语言的运行方式，它们可能会提取查询字符串，并将其分配给 GET 变量。但最终，这是一个 POST 请求，而不是 GET。

所以基本上，**是**的，这个功能存在，是有意的吗？我会**说不**。

# c++ - (int) ch 与 int(ch)：它们是同一事物的不同语法吗？

> ID：262932
> 
> 赞同：6
> 
> 时间：2008-11-04T18:52:49.517
> 
> 标签：c++, casting

在 C++ 中， (int) ch 等价于 int(ch)。

如果不是，有什么区别？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-04T19:07:58.877

它们是一样的东西，也一样`(int)(ch)`。在 C++ 中，通常首选使用命名转换来阐明您的意图：

*   用于`static_cast`在不同大小或符号的原始类型之间进行转换，例如`static_cast<char>(anInteger)`.
*   用于`dynamic_cast`将基类向下转换为派生类（仅限多态类型），例如`dynamic_cast<Derived *>(aBasePtr)`.
*   用于`reinterpret_cast`在不同类型的指针之间或在指针和整数之间进行强制转换，例如`reinterpret_cast<uintptr_t>(somePtr)`.
*   用于从变量`const_cast`中删除`const`或限定符（**非常危险**），例如.`volatile`**`const_cast<char *>(aConstantPointer)`**

 *** * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-04T19:11:13.253

`int(x)`被标准称为函数样式转换，并且在各个方面都与 C 样式转换相同（对于 POD）[5.2.3]：

> 如果表达式列表是单个表达式，则类型转换表达式等效于（在定义上，并且如果在含义上定义）对应的强制转换表达式（5.4）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-04T19:01:41.697

他们是一样的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-04T19:34:48.057

康拉德鲁道夫是对的。但考虑到

*   (int) x <-- 是 C 和 C++ 中的有效语法
*   (int*) x <-- 在 C 和 C++ 中是有效的语法
*   int (x) <-- 在 C++ 中有效，但在 C 中给出语法错误
*   int* (x) <-- 在 C 和 C++ 中都给出语法错误

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-04T19:34:31.053

尽管这两种语法对于 int 具有相同的含义，但第二种构造函数风格的语法更通用，因为它可以与模板中的其他类型一起使用。也就是说，“T(x)”可以编译为基本类型之间的转换（例如，如果 T = int）或构造函数调用（如果 T 是类类型）。根据我自己的经验，这很有用的一个例子是，当我从使用本机类型作为计算的中间结果切换到任意精度整数时，它被实现为一个类。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-04T18:57:44.827

第一个是C风格，第二个是C++风格。

在 C++ 中，使用 C++ 样式。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-05T09:13:14.863

值得注意的是，这两种类型的转换在 C++ 中都已弃用，而是支持 Adam Rosenfield 的答案中列出的更长、更具体的转换方法。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-11-04T19:16:58.453

如果你想变得超级讨厌，那么如果你写这样的东西：

```
#define int(x) 1 
```

那么 (int)x 具有您期望的含义，而对于 x 的任何值，int(x) 将为 1。但是，如果有人这样做，您可能应该伤害他们。我也可以完全相信，在标准中的某个地方，您被禁止使用#defining 关键字，尽管我现在找不到它。

除此之外，非常愚蠢的特殊情况，然后如前所述，[5.3.2] 说它们对于 POD 是相同的

# c# - 在循环中执行 array.length 或 list.count 成本高吗

> ID：262934
> 
> 赞同：26
> 
> 时间：2008-11-04T18:52:56.147
> 
> 标签：c#, compiler-construction, performance, language-features

我知道在 JavaScript 中，创建这样的 for 循环：`for(int i = 0; i < arr.length; i++)`成本很高，因为它每次都会计算数组长度。对于列表和数组，这种行为在 c# 中是否也很昂贵。还是在编译时进行了优化？还有其他语言，比如Java，是怎么处理的？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-11-04T18:56:58.057

在 C# 中它*并不*昂贵。一方面，没有“计算”：由于内联，查询长度基本上是一个基本操作。其次，因为（[根据其开发人员](http://blogs.msdn.com/ericgu/archive/2004/04/18/115566.aspx)的说法），编译器可以识别这种访问模式，并且实际上会优化任何（冗余）边界检查以访问数组元素。

顺便说一句，我相信现代 JavaScript 虚拟机也有类似的情况，如果还没有，很快就会出现，因为这是一个微不足道的优化。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-04T18:59:51.920

1.  所有 .Net 数组都有一个包含数组长度的字段，因此长度不是在使用时计算，而是在创建时计算。

2.  .Net 虚拟机非常擅长尽可能消除边界检查，这是其中边界检查移到循环之外的情况之一（在大多数情况下，如果不是，则只有 2 条指令开销）。

编辑：

[数组边界检查消除](https://blogs.msdn.microsoft.com/clrcodegeneration/2009/08/13/array-bounds-check-elimination-in-the-clr/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-04T18:57:11.177

在几乎任何语言中，答案都是“视情况而定”。

大多数情况下，这取决于编译器是否足够聪明，能够判断您在循环中时列表或数组的长度是否会发生变化。

不过，这不太可能由语言规范定义。

因此，假设编译可能无法解决这个问题可能是安全的。如果您真的相信对象的长度不会改变，请随意计算长度并在循环控制结构中使用它。

但要注意其他线程...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-04T19:05:25.683

我相信如果您使用 Linq Count() 扩展方法，那么它可能会在每次调用时进行计算。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T18:58:46.540

如果它类似于 Java，它应该是 O(1) 操作。

我发现以下链接很有帮助： http: [//www.devguru.com/Technologies/Ecmascript/Quickref/array.html](http://www.devguru.com/Technologies/Ecmascript/Quickref/array.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-04T18:59:23.230

它还取决于该 getter 是在进行计算还是在访问已知值。

# date - openbd cfloop 在一个日期

> ID：262940
> 
> 赞同：0
> 
> 时间：2008-11-04T18:54:14.753
> 
> 标签：date, loops, coldfusion, openbd, cfloop

我正在尝试将我的网站从 CF8 转换为 openBD。我在一个在日期范围内循环的站点中有一个 cfloop。

本质上，我想在日期范围（从和到）的每 2 周（步骤）将新记录插入数据库

我的循环看起来像这样......

```
<cfloop 
  from  = "#form.startDate#" 
  to    = "#form.endDate#" 
  index = "i" 
  step  = "#theStep#"
> 
```

这在 CF8 中完美运行，在 openBD 中，我收到此错误...数据不支持：值 [11/05/09] 不是数字

有什么变通的想法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-05T21:47:47.807

您的问题在于没有从您的 FORM 中检查不明确的区域设置相关日期字符串。

一个更强大的版本是这样的：

```
<cfset SetLocale("English (US)")> <!--- set expected input locale here --->

<cfif LSIsDate(form.startDate) and LSIsDate(form.endDate)>
  <cfset theStep = 14>

  <cfloop 
    from  = "#LSParseDate(form.startDate)#" 
    to    = "#LSParseDate(form.endDate)#" 
    index = "i" 
    step  = "#theStep#"
  >
    <!--- do stuff --->
  </cfloop>
<cfelse>
  <!--- output some error message --->
</cfif> 
```

限制人们在 FORM 中输入明确的日期格式会很有帮助，例如“yyyy-mm-dd”。

“值不是数字”错误来自这样一个事实，即循环仍然会遍历数字，即使您输入日期也是如此。然后，它使用这些日期的数字表示，但它们必须*有效*且易于理解才能起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T23:03:13.300

正如 Ben 所说，您的代码不存在 - 您需要使用 101 010 图标为其创建代码块。

这是另一个应该有效的解决方案：

```
<cfloop index="Current" from="#parseDateTime(StartDate)#" to="#parseDateTime(EndDate)#" step="14">
    [do stuff]
</cfloop> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T20:07:21.893

我看不到您的代码，但这是我的第一个建议：

```
<cfset current = [your begin date]>
<cfloop condition = "datecompare(enddate, current)">
  [do stuff]
  <cfset current = dateadd('d', 14, current)>
</cfloop> 
```

HTH。

# regex - 为什么这个 RegEx 会按照我想要的方式工作？

> ID：262949
> 
> 赞同：6
> 
> 时间：2008-11-04T18:55:47.280
> 
> 标签：regex

我有一个对我有用的 RegEx，但我不知道为什么它对我有用。我会解释的。

```
RegEx: \s*<in.*="(<?.*?>)"\s*/>\s* 
```

它找到的文本（它找到输入标签前后的空白）：

```
<td class="style9">
      <input name="guarantor4" id="guarantor4" size="50" type="text" tabindex="10" value="<?php echo $data[guarantor4]; ?>"  />    </td>
</tr> 
```

我不明白的部分：

```
<in.*=" <--- As I understand it, this should only find up to the first =" as in it should only find <input name="

It actually finds: <input name="guarantor4" id="guarantor4" size="50" type="text" tabindex="10" value=" which happened to be what I was trying to do. 
```

我对这个 RegEx 有什么不了解的地方？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-04T18:58:28.117

`.*`是贪婪的。您`.*?`最多只能找到第一个`=`.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-04T18:59:51.640

您似乎正在使用“贪婪”匹配。

贪婪匹配说“尽可能多地吃，以使这项工作”

尝试

```
<in[^=]*= 
```

对于初学者来说，这将停止它匹配“=”作为“。*”的一部分

但在未来，你可能想阅读

```
.*? 
```

和

```
.+? 
```

表示法，它在匹配的第一个可能条件处停止，而不是最后一个。

如果您只想在看到**两个**字符时停止，使用“非贪婪”语法会更好，

IE：

```
<in.*?=id 
```

无论中间是否有 '='，它都会在第一个 '=id' 处停止。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-04T18:59:27.507

.* 是贪婪的，所以它会找到最后一个 =。如果您希望它不贪婪，请添加一个问号，如下所示：.*?

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-04T19:04:46.153

> 据我了解，这应该只找到第一个 =" 因为它应该只找到 <input name="

你没有说你在用什么语言编写，但几乎所有的正则表达式系统都是“贪婪匹配器”——也就是说，它们匹配输入的最长可能子字符串。在您的情况下，这意味着从输入标签的开头到最后一个等引号序列的所有内容。

大多数正则表达式系统都有一种方法来指定模式只匹配最短的子字符串，而不是最长的 - “非贪婪匹配”。

顺便说一句，除非您完全控制输入的构造，否则不要假设第一个参数是 name=。HTML 和 XML 都允许以任何顺序指定属性。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-03-24T15:25:10.883

你贪婪的做法正在引起混乱。你想`.*?` 考虑输入`101000000000100`。

使用`1.*1`,`*`是贪心的 - 它会一直匹配到最后，然后回溯直到它可以匹配`1`，留下`1010000000001`. `.*?`是非贪婪的。`*`将不匹配任何内容，但随后将尝试匹配额外字符，直到匹配`1`，最终匹配`101`.

# versioning - 实现版本控制系统的好策略

> ID：262953
> 
> 赞同：5
> 
> 时间：2008-11-04T18:56:45.937
> 
> 标签：versioning, build-system

我一直在为版本控制软件苦苦挣扎。我不是在谈论命名约定，而是在谈论如何在构建系统中实际应用一个版本，直到发布。

我一般使用major.minor.maintenance-[release type] ie 1.0.2-rc1

问题是管理版本号。我尝试了很多方法（将其粘贴在构建文件、属性文件、数据库等中），但我没有找到任何真正有效的方法。

我想出的最接近的方法是使用我在此处记录的 Jira：http: [//blog.sysbliss.com/uncategorized/release-management-with-atlassian-bamboo-and-jira.html](http://blog.sysbliss.com/uncategorized/release-management-with-atlassian-bamboo-and-jira.html)

我想知道是否有人对此有任何好主意。另外，想知道人们如何处理发布版本....即，如果我发布/部署版本 1.0.0-rc1 在此版本中发现错误然后登录到 1.0.0（下一个/生产版本）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-04T19:02:31.150

Microsoft 使用`<major>.<minor>.<patch>-<build number>`（或变体）。

我喜欢用`<major>.<minor>.<buildnumber>`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-18T22:26:02.013

现在这可能是一个死帖，但无论如何我都会加两分钱。我认为内部版本号应该对每个看到它的人都有意义。所以我个人认为这是给版本命名的好方法：

major.minor.patch.revision - 例如 1.1.4.2342

主要/次要数字是不言自明的。但从第三个数字的角度来看，它仍然需要对客户有意义。我已经向您发布了这个新版本，客户先生，但它不值得一个新的次要号码，因为我们只是修复了一些错误。所以我们增加了补丁号。

第 4 个数字通常对客户绝对没有任何意义，因此您不妨让它对您和您公司中看到它的任何其他人有用。所以对我们来说，这个数字就是 SVN 版本号。它准确地告诉我们哪个版本负责该版本，以便我们可以随时将其拉出以重新创建它。分支代码显然也实现了这一点，但不是 100% 确定的。

此外，全数字版本号的另一个优点是它可以轻松集成到几乎每个连续构建系统中。

无论如何，这是我的两分钱。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-04T19:40:10.030

在我工作的地方，我们使用 Maven 系统：artifact[-major-minor-revision][-SNAPSHOT]，它允许我们开发“进行中”的版本，这些版本会立即更改（SNAPSHOT）和那些已经正式发布的版本. 一些例子是：

email-services-1.0.0-SNAPSHOT.jar

*   email-web-2.3.11.war*   crm-2.5.0.ear

如果它有 SNAPSHOT，那么它还没有通过全套测试，或者只是一个开发者实验。如果它没有 SNAPSHOT，那么它就是一个候选版本。我们维护一个发布候选者的存储库，一旦测试人员对它感到满意，最新的将被发送以进行部署。

所有这些都可以通过 Maven 下的构建文件中的一些简单条目来管理。见[Maven2 教程](http://maven.apache.org/guides/getting-started/index.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-04T22:27:43.170

在 Jira/Bamboo 解决方案上 +1。关于构建的唯一附加信息（出于我的目的）是 Subversion 版本，尽管标记操作是我想要的 80%。

手动维护发布/版本信息是一件非常痛苦的事情。让 JIRA 驱动它是一个好主意。

关于最后一个问题，关于记录错误/缺陷`releasing`的位置和版本：

*   缺陷/问题会针对其出现的版本进行记录。针对 1.0.0-rc1 记录了 1.0.0-rc1 中的缺陷
*   JIRA 有（或者我们可能添加了）一个“Fix-For”字段，该字段将具有计划发布，在本例中为 1.0.0
*   如果缺陷/问题足够严重，则可能需要添加另一个“rc”版本。
*   当没有突出的关键缺陷/问题并且客户（或管理层）同意可以推迟任何剩余问题时发布

通过 JIRA 进行管理的美妙之处在于，添加版本、生成更改日志等自动化程度相当好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-04T19:13:33.420

我们还在`<major>.<minor>.<buildnumber>`构建服务器上使用 CruiseControl/(.Net) 并对其进行管理。并使用 Wix 和 CruiseControl Config 管理主要次要编号 - 仍然手动增加这些编号 - 但构建号在构建服务器上时会自动发生。我相信您也可以设置一个规则来自动增加主要/次要 - 我们只需要手动执行此操作，以便开发人员在需要命名特定发布级别时进行有意识的思考。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-11T15:48:43.207

Major.Minor.BuildDateNumber.DailyBuildNumber

Major 和 Minor 由我们设置，在我们认为合适的时候手动增加它们。

BuildDateNumber 是自项目开始以来的月数乘以 100，再加上当月的天数。

DailyBuildNumber 每天午夜后的每个构建都会递增，从零开始。

例如，7 月 10 日发布 5.2 的第 4 次构建，该项目于当年 1 月 1 日开始，将具有版本号

5.2.710.3

[这一切都是由Nant](http://nantcontrib.sourceforge.net/release/latest/help/tasks/version.html)中的 Version 任务为我们计算的。

这使版本号保持唯一，并且还允许我们快速计算构建安装的时间。

# asp.net - 从 Winforms 迁移到 ASP.NET 2.0 Webforms 时的 Gridview 排序挑战

> ID：262966
> 
> 赞同：1
> 
> 时间：2008-11-04T18:59:28.737
> 
> 标签：asp.net, vb.net, gridview

我对 Gridview 排序有一个问题，它与其他排序类似，但我绑定到集合对象而不是数据表。

应用程序的现有业务规则和数据访问层遵循拥有一个对象的模式，如果您需要该类型的对象的集合，则拥有另一个继承 CollectionBase 并实现 IBindingList 的类。

对于桌面应用程序，很容易将 gridview 数据绑定到这些对象之一，并且打开列排序没有任何问题。桌面应用程序的表示层中的一切都处于“状态”。

现在该代码正被移至新的 Web 应用程序（ASP.NET 2.0、VB 代码隐藏页面）。

我已经玩弄了我必须做的事情，只让集合的某些列显示在 gridview 中，并且 gridview 看起来相当不错。当我打开“允许排序”时，问题就出现了。

*我收到了关于没有 .Sorting 方法等的错误。在研究这个时，如果*我的源是数据表，我发现各种解决方案都可以通过数据视图轻松实现。但它不是——它是一个集合。我试图通过将集合转换为 XML 内存流来“廉价拍摄”数据源，然后他们尝试将 .ReadXML 重新转换为数据集，但这没有用 [就我在数据集中得到的根元素丢失错误而言。 ReadXml(ioTemp) 其中 ioTemp 是 xml 序列化程序中使用的 System.IO.MemoryStream]。

由于旧的桌面应用程序，我从不用担心对集合进行排序，因为 gridview 会在加载后处理它。事实上，集合的 .SortProperty、.SortDirection 和 .ApplySort 都是通过 NotSupportedExceptions 实现的“标准”（我从早已不复存在的程序员那里继承了这段代码）。

有没有一种简单的方法可以将集合转换为数据表或对集合进行排序而不必每次都返回数据库？对象数据源无法工作，因为对象构建方式的复杂规则 - VS2005 中的向导无法处理我们需要做的事情（有条件地从多个表中获取数据以创建对象）。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-05T19:55:54.313

您是否考虑过客户端排序？

我过去曾在 ASP Gridviews 中使用过 jquery tablesorter 插件。

[http://tablesorter.com/](http://tablesorter.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T19:23:55.537

我有一个类似的问题，我需要在对象上实现 IComparable。基本上要对一组对象进行排序，您需要一种方法来区分它们的顺序。IComparable 接口有一个名为 Compare 的方法，它允许 .Net 框架在您对对象进行排序时计算出对象的顺序。您需要自己实现此方法才能使排序方法起作用。

[谷歌搜索结果](http://www.google.ie/search?hl=en&q=vb.net+implement+icomparable&btnG=Google+Search&meta= "谷歌搜索结果")

您没有提及错误消息，所以我无法确定是否是这种情况，您可以发布错误吗？

编辑 ：

关于您的评论；您可以实现多列排序，它只需要更多的工作。您可以指定对集合进行排序的字段，然后在 CompareTo 方法中使用此信息。

[看看这个](http://codebetter.com/blogs/david.hayden/archive/2005/02/27/56099.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T23:21:44.620

鉴于您显然是在用自己的对象集合填充网格，这对于 Linq for Objects 来说是一项完美的工作。只需一点点麻烦，您就可以针对您的集合实现有效的 SQL Select 语句。很酷的东西。

[http://www.hookdonlinq.com/LINQtoObjects5MinuteOverview.ashx](http://www.hookedonlinq.com/LINQtoObjects5MinuteOverview.ashx)

另外，您真的只想对网格中的数据进行排序吗？如果是这样，那么肯定会追求对您的对象使用 Linq。然而，对网格内容进行排序很少能真正解决问题（“对网格进行排序”通常转化为更改用于填充网格的数据的访问路径。）浏览器应用程序不像 Windows 应用程序并且没有与底层数据源的全时连接，使事情像 Windows 中的 DataGridView 使事情看起来一样神奇。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-02T18:20:41.497

您可以将带有 On_Click 事件的链接按钮作为每列的标题。

触发事件时，确定单击了哪个标题（每个标题一个方法或一个 commandArgument 值）。一旦知道了，对对象集合执行 .orderBy 或 .OrderByDescending by，然后将结果放回作为 gridview 的数据源并对其进行数据绑定。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-04T12:28:00.100

在我最初提出这个问题的那一年里，我设法实现了一个新的“标准”，以便业务对象的集合现在是通用列表。

所以现在一个“集合类”只不过是一个“继承列表（MyBusinessObject）”，它的排序方法看起来像这样（性能不是问题）：

```
Public Overloads Sub Sort(ByVal strPropertyName As String, ByVal strDirection As String)
    Dim arSortedList As New ArrayList
    For Each item As MyBusinessObject In Me
        arSortedList.Add(item)
    Next
    arSortedList.Sort(New CaseInsensitiveComparer(Of MyBusinessObject)(strPropertyName, strDirection))
    For intI As Integer = 0 To arSortedList.Count - 1
        Item(intI) = arSortedList(intI)
    Next
End Sub 
```

这似乎与 GridView 用于触发事件的方法完美配合。

# git - Gitosis：设置存储库配置变量

> ID：262975
> 
> 赞同：4
> 
> 时间：2008-11-04T19:00:45.897
> 
> 标签：git, variables, gitolite, gitosis

有没有办法通过 gitosis conf 设置存储库配置变量，而不是进入每个存储库并直接编辑 conf 值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T06:42:50.330

我不认为这是可能的。另一方面，构建“瓷器”脚本非常简单，可以分析您的 gitosis.conf 以获得一些编码 conf 值的特殊注释。然后将这样的脚本放在提交后挂钩中应该可以解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-07-05T20:37:52.860

注意（10 年后，2018 年），gitosis 早已被**[gitolite](http://gitolite.com/gitolite/)**取代。

gitolite 提供了一种[通过 gitolite 配置指定配置变量](http://gitolite.com/gitolite/git-config/)的方法。

> 语法很简单：
> 
> ```
> config sectionname.keyname = value 
> ```
> 
> 例如：
> 
> ```
> repo gitolite
>     config hooks.mailinglist = gitolite-commits@example.tld
>     config hooks.emailprefix = "[gitolite] "
>     config foo.bar = "" 
> ```
> 
> 这要么是简单的“ `git config section.key value`”（对于上面的前两个示例），要么是“ `git config --unset-all section.key`”（对于最后一个示例）。
> 不支持其他形式的`git config`命令（`--add`、value_regex 等）。

# dns - 我的网络服务器可以在一家托管公司，而我的电子邮件由第三方托管吗？

> ID：262990
> 
> 赞同：12
> 
> 时间：2008-11-04T19:04:25.063
> 
> 标签：dns, mail-server

我有一个运行我的 Web 应用程序的 Web 服务器。

如果我想将我的电子邮件外包给其他提供商，如果他们在他们的网络/数据中心上，是否有可能？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-04T19:16:25.973

是的。为此，您需要访问您的域的 DNS 记录。MX 记录允许您设置独立于 Web 服务器的邮件服务器。

Google 提供了一项服务，该服务将通过 GMail 管理您的域的电子邮件，有关如何为该服务重新配置 DNS 的说明可在[此处](http://www.google.com/support/a/bin/answer.py?answer=33352&src=top5&lev=index)找到。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-05-31T13:27:26.430

是的，这是可能的。您需要使用“A”记录和“MX”记录的组合。

1.  “A”记录将指向托管应用程序的 Web 服务器。
2.  “MX”记录将指向您要托管电子邮件的服务器。

可以在此处找到有关如何执行此操作的完整分步参考[~~在不同的服务器上托管网站和电子邮件~~](http://codezag.com/hosting-website-and-email-on-different-servers/ "在不同的服务器上托管网站和电子邮件")

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-04T19:30:29.907

只要您可以控制您的 DNS 记录，无论它们位于何处都是可能的。我已经运行了许多站点，其中 Web 服务器位于我们的建筑物中，而邮件服务器位于客户自己的站点上，通过不相关的 ISP 连接。在一种情况下，Web 服务器在美国，而邮件服务器在英国。

DNS 记录可以再次位于不同的服务器上。一些注册商包括在其界面中编辑 DNS 记录，其他注册商只是让您将 DNS 设置到另一台服务器。

确定电子邮件服务器的记录称为 MX 记录。它们采用邮件服务器的名称（不是 IP 地址）。将名称转换为 IP 地址的记录称为 A 记录 - 您将这些记录用于“www”等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T19:18:44.440

Google Apps 就是这样做的。*************